# StackOverflow 问答 13616000-13616999

# php - PHP - 禁止 IP 使用 MySQL 中的数组？

> ID：13616004
> 
> 赞同：0
> 
> 时间：2012-11-28T23:04:02.773
> 
> 标签：php, arrays

我想要一个基本脚本，如果用户 IP 在被禁止 IP 的数据库中，它将在页面顶部消失。到目前为止，我有一个脚本将插入一个具有自动递增 ID 的 IP 和 IP。我正在使用 PDO 库，如何从数据库中获取返回的数组并检查 in_array 是否存在？

这是我返回数据库信息的方式。

```
$query = " 
    SELECT 
        id, 
        ip
    FROM banned 
"; 

try 
{ 

    $stmt = $db->prepare($query); 
    $stmt->execute(); 
} 
catch(PDOException $ex) 
{ 

    die("Failed to run query: " . $ex->getMessage()); 
} 

$rows = $stmt->fetchAll(); 
```

然后这只是我写的一个快速脚本，只是死在页面顶部并重定向。

```
if(in_array($_SERVER['REMOTE_ADDR'], $row["ip"])) 
{ 
header("Location: banned.php")
die("Banned!"); 
} 
```

我的总体问题是，如何获取获取的数据并将其放入数组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:10:48.987

使用该[`ip2long()`](http://php.net/manual/en/function.ip2long.php)函数将 IP 地址转换为整数。将这些整数存储在数据库中，并改用以下查询。正如 GolezTroll 在评论中指出的那样，确保整数字段是`UNSIGNED`.

```
$query = 'SELECT id, ip FROM banned WHERE ip = ';
$query .= ip2long($_SERVER['REMOTE_ADDR']);
$query .= ' LIMIT 1'; 
```

这样，您的`banned`表对索引非常友好，并且您最多只能从表*中*检索一个条目。您当前的代码每次都会获取每个条目，从而在您的 Web 和 mysql 服务器上施加相当大的负载。

此外，您可能可以`id`从禁止表中删除该列，因为该`ip`列本身应该用作主键就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:10:49.597

不。将所有这些地址查询到一个数组中是一种浪费。只需使用这样的查询：

```
SELECT 
  CASE WHEN EXISTS
    (SELECT 
      'x' 
    FROM 
      banned 
    WHERE 
      ip = :ip) THEN
    'Y'
  ELSE
    'N'
  END AS IsBanned 
```

当然，您必须为 :IP 填写正确的 IP 地址。此查询始终只返回 1 条记录。如果 IP 地址被禁止，则该记录始终包含“Y”，如果不是，则始终包含“N”。即使您不小心禁止了两次 IP，查询也会继续工作，尽管我会通过在该字段上添加唯一约束（唯一索引）来防止这种情况。

但是请注意，IP 禁止并不理想。许多人每天仍然拥有不同的 IP 地址。这意味着他们仍然可以访问您的网站，而无辜的其他人则不能。此外，整个家庭和公司都使用相同的 IP，因此阻止 1 个用户可以阻止整个公司的数千人。

IP 地址（即 IPv4）可以存储在整数字段中。但是请注意，如果您通过参数传递 IP 地址，则必须将其作为字符串传递，即使该字段本身是整数。MySQL 整数参数是有符号的 32 位。这意味着以 128 或更高开头的 IP 地址会遇到麻烦。它会打乱你的比较。

# google-app-engine - 从 Appengine (JAVA) 更改 Google Cloud Storage 的 ACL

> ID：13616007
> 
> 赞同：7
> 
> 时间：2012-11-28T23:04:21.540
> 
> 标签：google-app-engine, acl, google-cloud-storage

是否可以使用 appengine Api 更改 Google Cloud Storage 对象（或存储桶）的 ACL？我知道这可以使用 REST API 来完成，但是在 appengine 的 Files Api 中是否支持这一点？可以在使用 GSFileObject 创建新对象时设置它们，但是您可以更改现有对象吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T00:00:16.247

您可以使用[urlfetch.fetch](https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction)和[app_identity.get_access_token](https://developers.google.com/appengine/docs/python/appidentity/functions)轻松地将经过[身份验证的请求发送](https://developers.google.com/storage/docs/authentication#oauth)到 REST api。

## Python：

```
from google.appengine.api import app_identity
from google.appengine.api import urlfetch

acl_xml = """
<AccessControlList><Entries>
  <Entry>
    <Scope type="UserByEmail">foo@example.com</Scope>
    <Permission>READ</Permission>
  </Entry>
</Entries></AccessControlList>
"""
scope = 'https://www.googleapis.com/auth/devstorage.full_control'
token = app_identity.get_access_token(scope)
response = urlfetch.fetch(
    'http://storage.googleapis.com/bucket/obj?acl',
    method=urlfetch.PUT,
    payload=acl_xml,
    headers={'Authorization': 'OAuth %s' % token}) 
```

## 爪哇：

```
import com.google.appengine.api.appidentity.AppIdentityService;    
import com.google.appengine.api.appidentity.AppIdentityServiceFactory;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;

public String setAcl() throws Exception {
  // Change foo@example.com to a valid email.
  // Repeat <Entry/> as many times as necessary.
  String xmlString = "";
  xmlString += "<AccessControlList><Entries>";
  xmlString += "  <Entry>";
  xmlString += "    <Scope type=\"UserByEmail\">foo@example.com</Scope>";
  xmlString += "    <Permission>READ</Permission>";
  xmlString += "  </Entry>";
  xmlString += "</Entries></AccessControlList>";

  ArrayList scopes = new ArrayList();
  scopes.add("https://www.googleapis.com/auth/devstorage.full_control");

  AppIdentityService.GetAccessTokenResult accessToken =
      AppIdentityServiceFactory.getAppIdentityService().getAccessToken(scopes);

  // Change bucket and obj to the bucket and object of interest.
  URL url = new URL("https://storage.googleapis.com/bucket/obj?acl");
  HttpURLConnection connection = (HttpURLConnection) url.openConnection();
  connection.setDoOutput(true);
  connection.setRequestMethod("PUT");
  connection.addRequestProperty(
      "Authorization", "OAuth " + accessToken.getAccessToken());

  OutputStreamWriter writer = new OutputStreamWriter(connection.getOutputStream());
  writer.write(xmlString);
  writer.close();

  if (connection.getResponseCode() != HttpURLConnection.HTTP_OK) {
    throw new Exception();
  }
} 
```

## 更多信息：

*   Python：[https ://developers.google.com/appengine/docs/python/appidentity/overview](https://developers.google.com/appengine/docs/python/appidentity/overview)
*   Java：[https ://developers.google.com/appengine/docs/java/appidentity/overview](https://developers.google.com/appengine/docs/java/appidentity/overview)
*   相关 oauth 范围：[https ://developers.google.com/storage/docs/authentication#oauth](https://developers.google.com/storage/docs/authentication#oauth)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:58:45.627

App Engine Google Cloud Storage API 不支持修改现有对象的 ACL，但是，我刚刚编写了一个功能请求，要求添加该功能。

# wso2 - WSO2 ESB 4.5.0 无法从治理注册表创建代理服务

> ID：13616009
> 
> 赞同：0
> 
> 时间：2012-11-28T23:04:29.137
> 
> 标签：wso2, wso2esb, wso2greg

我有 WSO2 ESB 和 WSO2 GREG 运行，注册表安装到 ESB 实例。

在尝试创建日志代理服务时，我从注册表中获取了 WSDL。WSDL 具有它所依赖的模式导入。但是 ESB 无法解析模式位置，试图在本地 FS 上找到它。

屏幕[在这里](http://oi50.tinypic.com/23kf4gk.jpg)

日志[在这里](http://pastebin.com/vvUQJUnK)。

这可以克服吗？或者这是 WSO2 的另一个错误？

谢谢，弗拉基米尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T05:03:09.410

在“publishWSDL”选项的“resource”元素的“SchemaLocation”属性中使用与 WSDL 中使用的完全相同的“SchemaLocation”属性值。

例如，如果 WSDL 有一个导入为的模式，

```
<schema namespace="some_namespace" schemaLocation="./TestSchema.xsd"> 
```

那么“resource”标签的“schemaLocation”属性也应该和下面提到的一样。

```
<resource schemaLocation="./TestSchema.xsd" ...> 
```

# batch-file - 如何在 TeamCity 中运行构建之前验证配置文件的内容

> ID：13616011
> 
> 赞同：0
> 
> 时间：2012-11-28T23:04:34.473
> 
> 标签：batch-file, find, teamcity

我想在我们的`TeamCity`配置中添加一个检查`web.config`文件内容的步骤。

如果没有找到键值，这意味着有人用错误的值签入了它，我们不应该继续构建。（TeamCity 在 Windows 服务器上运行。）

我可以添加一个执行适当`FIND`命令的命令行运行器，但我无法捕获输出`FIND`并在后续`IF`语句中使用它。

尝试在 FOR 语句中嵌入 FIND 未成功。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T07:50:26.260

您可以使用 PowerShell 运行器：

```
$key = 'your-key'
[xml] $config = Get-Content path\to\web.config
$value = $config.SelectSingleNode("/configuration/appSettings/add[@key='$key']/@value")
if ($value.Value -ne 'your expected value') {
    exit 1
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:06:10.837

您可以使用 xmlPeek 创建一个简单的 nant 脚本来检查值

# sql-server - Sql Server Service Broker - 外部激活的控制台应用程序的完整、使用中的示例

> ID：13616014
> 
> 赞同：6
> 
> 时间：2012-11-28T23:04:52.233
> 
> 标签：sql-server, sample, service-broker, activation

我需要任何部署了使用 Sql Server Service Broker 外部激活机制（通过 Feature Pack 中的 Service Broker External Activator）的实际生产应用程序的人的指导。

## 目前的心态：

我的规格相当简单（或者至少我是这么认为的），所以我正在考虑以下基本流程：

1.  类似订单的实体被插入到状态为“已确认”的*Table_Orders*

2.  *SP_BeginOrder*被执行并执行以下操作：

    *   开始交易
    *   *启动一个从Service_HandleOrderState*到*Service_PreprocessOrder*的 DIALOG
    **   将对话句柄（从现在开始*PreprocessingHandle ）存储在**Orders*表 的特定列中*   *使用PreprocessingHandle*发送包含订单 ID的*Message_PreprocessOrder*类型的 MESSAGE**   结束交易** ***请注意，我不会结束对话，我不想[“一劳永逸”](http://rusanu.com/2006/04/06/fire-and-forget-good-for-the-military-but-not-for-service-broker-conversations/)*** 
***   *Queue_PreprocessOrder*上的事件通知激活*PreprocessOrder.exe*的一个实例（最大并发 1），它执行以下操作：

    *   开始一个 SqlTransaction
    *   从*Queue_PreprocessOrder接收前 1 个 MESSAGE*
    *   如果消息类型是*Message_PreprocessOrder*（格式 XML）：
        *   使用消息正文中的订单 ID 在*Table_Orders*中将订单状态设置为“预处理”
        *   加载计算[n 元 Carthesian 积](https://stackoverflow.com/a/3098381/720616%20n-ary%20Carthesian%20product)的 n 个数据集合（通过 Linq，AFAIK，这在 T-SQL 中是不可能的）以确定订单项集合
        *   将订单项行插入*Table_OrderItems*
        *   *使用PreprocessingHandle发送**Message_PreprocessingDone*类型的 MESSAGE ，包含相同的订单 ID
        **   结束与*PreprocessingHandle相关的对话**
    **   提交 SqlTransaction*   以 Environment.Exit(0) 退出***   *Queue_HandleOrderState*上的内部激活执行一个 SP（最大并发 1）：
    *   开始交易
    *   从*Queue_InitiatePreprocessOrder接收前 1 个 MESSAGE*
    *   如果消息类型是*Message_PreprocessingDone*：
        *   使用消息正文中的订单 ID 在*Table_Orders*中将订单状态设置为“处理中”
        *   启动从*Service_HandleOrderState*到*Service_ProcessOrderItem的 DIALOG*
        *   将对话句柄（从现在开始*ProcessOrderItemsHandle ）存储在**Table_Orders*的特定列中
        **   为当前订单 ID 和每一行 的*Table_OrderItems*中的行创建一个游标：
            *   *使用ProcessOrderItemsHandle发送**Message_ProcessOrderItem*类型的 MESSAGE ，其中包含订单项目 ID* 
    ***   如果消息类型是*Message_ProcessingDone*：
        *   使用消息正文中的订单 ID 在*Table_Orders*中将订单状态设置为“已处理”*   如果消息类型是`http://schemas.microsoft.com/SQL/ServiceBroker/EndDialog`（END DIALOG）：
        *   结束与消息的对话句柄有关的对话*   结束交易*****   *Queue_ProcessOrderItem*上的事件通知激活*ProcessOrderItem.exe*的一个实例（最大并发 1），它执行以下操作：
    *   开始一个 SqlTransaction
    *   从*Queue_ProcessOrderItem接收前 1 个 MESSAGE*
    *   如果消息类型是*Message_ProcessOrderItem*（格式 XML）：
        *   使用消息正文中的订单项目 ID 在 *Table_OrdersItems*中将订单项目状态设置为“处理中” ，然后：
            *   加载订单项目参数的集合
            *   使用参数向 URL 发出 HttpRequest
            *   将 HttpResponse 作为 PDF 存储在文件系统上
        *   如果上述子步骤中发生任何错误，则将订单项目状态设置为“错误”，否则设置为“正常”
        *   *在Table_OrdersItems*中执行查找以确定是否所有订单项目都已处理（状态为“ok”或“error”）
        *   如果处理了所有订单项目：
            *   *使用ProcessOrderItemsHandle发送**Message_ProcessingDone*类型的 MESSAGE ，包含订单 ID
            **   结束与*ProcessOrderItemsHandle相关的对话**

    **   提交 SqlTransaction*   以 Environment.Exit(0) 退出******

 **## 笔记：

*   规范指定 MSSQL 兼容性 2005 到 2012，因此：
    *   没有对话组
    *   没有对话优先级
    *   没有 POISON_MESSAGE_HANDLING ( STATUS = OFF )
*   我正在努力实现整体流程的完整性和连续性，而不是速度
*   鉴于表和 SP 驻留在*DB1*中，而 Service Broker 对象（消息、合同、队列、服务）驻留在*DB2*中，*DB2*是 SET TRUSTWORTHY

## 问题：

1.  所描述的架构中是否存在任何重大设计缺陷？
2.  订单完成状态跟踪似乎不正确。有没有更好的方法？也许使用 QUEUE RETENTION ？
3.  我的直觉告诉我，在任何情况下，激活的外部 exe 都不应该以 0 以外的退出代码终止，所以应该`try{..}catch(Exception e){..} finally{ Environment.Exit(0) }`在 Main.exe 中。这个假设正确吗？
4.  您将如何组织 DB 代码中的错误处理？错误日志表是否足够？
5.  您将如何组织外部 exe C# 代码中的错误处理？相同的错误记录表？
6.  我已经看过[SQL Server Service Broker Product Samples](http://msftsbprodsamples.codeplex.com/)，但对于我看似简单的案例，Service Broker 接口似乎有点过头了。更简单的 Service Broker 对象模型的任何替代方案？
7.  任何用于服务代理的跨版本“便携式”管理工具至少能够排出有害消息？
8.  对于上述任何一个，你有什么像样的代码示例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:17:38.020

**问：所描述的架构中是否存在任何重大设计缺陷？**
A: 几个小好处：
- 等待一个 HTTP 请求完成，同时保持一个事务打开是不好的。无论如何，您无法在数据库和 HTTP 之间实现事务一致性，因此当 HTTP 速度较慢时，不要冒险让事务延长几分钟。典型的模式是 {begin tran/receive/ [begin conversation timer](http://msdn.microsoft.com/en-us/library/ms187804.aspx) /commit} 然后发出没有任何 DB xact 的 HTTP 调用。如果 HTTP 调用成功，则 {begin xact/send response/end conversation/commit}。如果 HTTP 失败（或客户端崩溃），那么让会话时间再次激活您。您将收到一条计时器消息（无正文），您需要从表中获取与句柄关联的项目 ID。

**问：订单完成状态跟踪似乎不正确。有没有更好的方法？也许使用 QUEUE RETENTION ？**
答：我对您的状态跟踪的一个批评是依赖于扫描订单项目以确定当前处理的项目是最后一个（5.3.4）。例如，您可以在项目状态中添加这是要处理的“最后一个”项目的信息，以便在处理它时知道需要报告完成。RETENTION 仅在调试时有用，或者当您有需要运行“逻辑回滚”和补偿对话错误操作的逻辑时。

**问：我的直觉告诉我，在任何情况下，激活的外部 exe 都不应该以 0 以外的退出代码终止，所以应该有 try{..}catch(Exception e){..} finally{ Environment.Exit(0 ) } 在主要。这个假设正确吗？**
A：最重要的是被激活的进程在队列上发出RECEIVE语句。如果没有这样做，队列监视器[可能会永远进入通知状态](http://rusanu.com/2008/08/03/understanding-queue-monitors/)。如果我没记错的话，退出代码是无关紧要的。与任何后台进程一样，捕获和记录异常都很重要，否则当它开始失败时，您甚至永远不会知道它有问题。除了规范的 try/catch 块之外，Hookup[`Application.ThreadException`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)还适用于 UI 应用程序以及[`AppDomain.UnhandledException`](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)UI 和非 UI 应用程序。

**问：您将如何组织 DB 代码中的错误处理？错误日志表是否足够？**
答：我稍后会跟进。错误日志表就足够了。

**问：您将如何组织外部 exe C# 代码中的错误处理？相同的错误记录表？**
答：我创建[bugcollect.com](http://bugcollect.com)正是因为我必须用自己的应用程序处理此类问题。问题不仅仅是日志记录，您还需要*一些*聚合和分析（至少检测重复报告）并抑制来自“现场”某些部署配置事故的错误泛滥。说实话，现在有更多的选择，例如。[除了网站](https://www.exceptron.com/)。当然，我认为 FogBugs 也具有日志记录功能。

**问：我已经看过 SQL Server Service Broker 产品示例，但对于我看似简单的案例，Service Broker 接口似乎有点过头了。更简单的 Service Broker 对象模型的任何替代方案？**
最后，一个简单的问题：是的，这太过分了。没有简单的模型。

**问：是否有任何用于 Service Broker 的跨版本“便携式”管理工具至少能够排出有害消息？**
答：毒消息的问题在于毒消息的定义会随您的代码而变化：[毒消息是指破坏当前设置的用于检测它的保护措施的任何消息](http://philosophy.thecastsite.com/readings/geb/hofstadter1.html)。

**问：对于上述任何一个，你有什么像样的代码示例吗？**
答：没有

还有一点：尽量避免从 DB1 到 DB2 的任何引用（例如，在 DB1 中激活了 4.3.4 并从 DB2 读取项目表）。这会创建跨数据库依赖关系，当 a) 一个数据库脱机（例如，为了维护）或过载或 b) 您为 HA/DR 添加数据库镜像并且一个数据库故障转移时，这些依赖关系会中断。即使 DB1 和 DB2 在不同的机器上（并且没有链接的服务器），也要尝试让代码工作。如有必要，向消息有效负载添加更多信息。如果您以这样的方式构建它，DB2*可以*在不同的机器上，甚至可以存在多台 DB2 机器来扩展 HTTP/PDF 编写工作。

最后：这个设计会*很*慢。我说的是每秒慢十条消息，涉及很多对话/消息，所有内容都与 max_queue_readers 1 。这对你来说可能接受也可能不接受。**

# .net - 从 html POST 检索错误响应

> ID：13616018
> 
> 赞同：0
> 
> 时间：2012-11-28T23:05:11.760
> 
> 标签：.net, ios, xcode, soap

我正在使用此代码将 JSON 发送到 .NET 服务以注册用户：

```
NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                                deviceID, @"DeviceId",
                                model, @"DeviceModel",
                                user, @"Username",
                                pass, @"Password",
                                email, @"email",
                                nil];

    NSDictionary *consumer = [NSDictionary dictionaryWithObject:dictionary forKey:@"consumer"];
    NSLog(@"%@", consumer);

    NSError *error = nil;
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:consumer
                                                       options:kNilOptions
                                                         error:&error];
    NSLog(@"%@", error);

    NSString *urlString = @"http://aservice.co.uk/services/service.svc/RegisterConsumer";

    NSURL *url = [NSURL URLWithString:urlString];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json; charset=utf-8" forHTTPHeaderField:@"Content-Type"];

    [request setHTTPBody:jsonData];
    NSURLResponse *response = NULL;
    NSError *requestError = NULL;
    NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&requestError];
    NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding] ;
    NSLog(@"%@", responseString);
    NSLog(@"%@", requestError); 
```

这很好，因为我收到了 JSON 结果`{"RegisterConsumerResult":"True"}`

现在，当我尝试注册一个我知道已经存在的用户名时，我会返回以下 HTML 作为 responseString：

```
<?xml version="1.0" encoding="utf-8"?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml">   <head>
    <title>Request Error</title>
    <style>BODY { color: #000000; background-color: white; font-family: Verdana; margin-left: 0px; margin-top: 0px; } #content { margin-left: 30px; font-size: .70em; padding-bottom: 2em; } A:link { color: #336699; font-weight: bold; text-decoration: underline; } A:visited { color: #6699cc; font-weight: bold; text-decoration: underline; } A:active { color: #336699; font-weight: bold; text-decoration: underline; } .heading1 { background-color: #003366; border-bottom: #336699 6px solid; color: #ffffff; font-family: Tahoma; font-size: 26px; font-weight: normal;margin: 0em 0em 10px -20px; padding-bottom: 8px; padding-left: 30px;padding-top: 16px;} pre { font-size:small; background-color: #e5e5cc; padding: 5px; font-family: Courier New; margin-top: 0px; border: 1px #f0f0e0 solid; white-space: pre-wrap; white-space: -pre-wrap; word-wrap: break-word; } table { border-collapse: collapse; border-spacing: 0px; font-family: Verdana;} table th { border-right: 2px white solid; border-bottom: 2px white solid; font-weight: bold; background-color: #cecf9c;} table td { border-right: 2px white solid; border-bottom: 2px white solid; background-color: #e5e5cc;}</style>   </head>   <body>
    <div id="content">
      <p class="heading1">Request Error</p>
      <p>The server encountered an error processing the request. See server logs for more details.</p>
    </div>   </body> </html> 
```

显然这并没有返回一个实际的错误，只是一个告诉我有错误的网页。是否错过了从服务中检索实际错误代码的方法？服务是否有可能以某种方式将错误作为响应发送？

编辑——我忘了​​提，实际的 errorResponse 是 nil，我假设因为返回的 HTML 实际请求被归类为成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:59:05.503

首先，检查状态代码是什么，以便您可以处理 >400 错误，如下所示：

```
NSURLResponse *response = NULL;
NSError *requestError = NULL;
NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&requestError];
NSUInteger statusCode = [(NSHTTPURLResponse*)response statusCode];
//Then do your error checking. 
```

如果您想使用 AFNetworking，这样做非常简单，只需添加库（在此处找到它：http: [//afnetworking.com](http://afnetworking.com)），然后这样做：

```
//NOTHING CHANGED TIL NEXT COMMENT
NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                            deviceID, @"DeviceId",
                            model, @"DeviceModel",
                            user, @"Username",
                            pass, @"Password",
                            email, @"email",
                            nil];

NSDictionary *consumer = [NSDictionary dictionaryWithObject:dictionary forKey:@"consumer"];
NSLog(@"%@", consumer);

NSError *error = nil;
NSData *jsonData = [NSJSONSerialization dataWithJSONObject:consumer
                                                   options:kNilOptions
                                                     error:&error];
NSLog(@"%@", error);
//Start to use AFNetworking

    NSURL *baseUrl = [NSURL URLWithString:@"http://aservice.co.uk/services/service.svc/"];
AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:baseUrl];

NSMutableURLRequest *request = [client requestWithMethod:@"POST" path:@"RegisterConsumer" parameters:dictionary];
[request setHTTPBody:jsonData];

AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"SUCESS");
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    NSLog(@"FAILED WITH STATUS CODE %d - error description: %@", response.statusCode, error);
}];

[operation start]; 
```

这是使用异步连接（你应该！）然后你可以在成功块中调用你的下一步。

我没有对此进行测试，但它应该可以（或非常接近）您需要做的事情。

**更新** 也许您可以使用此代码（我从[HERE](http://mobileorchard.com/accessing-http-headers-from-an-nsurlrequest/)获取）来查看它们在标题中提供了哪些类型的数据（如果有）并查看它是否有用。

```
if ([response respondsToSelector:@selector(allHeaderFields)]) {
    NSDictionary *dictionary = [response allHeaderFields];
    NSLog([dictionary description]);
} 
```

# sql-server-2008 - 如何获取 SQL Server 数据库的最后访问日期？

> ID：13616024
> 
> 赞同：0
> 
> 时间：2012-11-28T23:06:15.503
> 
> 标签：sql-server-2008

我有一个越来越拥挤的开发服务器。

我想查看访问数据库的日期以确定可以删除哪些数据库。有没有办法做到这一点？

我在搜索时唯一发现的是 postgredb：

[如何获取 PostgreSQL 数据库的最后访问/修改日期？](https://stackoverflow.com/questions/3211769/how-to-get-last-access-modification-date-of-a-postgresql-database)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:08:37.423

如果您有一个始终插入值的表，则可以将触发器添加到更新/插入。在此触发器中，您可以在专用数据库中设置当前时间戳，包括发生插入的数据库的名称。

这样，您的数据库的唯一要求是它支持触发器。

# c++ - C++ concurrent_unordered_map C++11 Microsoft Using unsigned long as key / HASH Function

> ID：13616029
> 
> 赞同：0
> 
> 时间：2012-11-28T23:06:37.833
> 
> 标签：c++, winapi, c++11, thread-safety, concurrenthashmap

我在 Windows 7 64 位中使用 Visual Studio 2012。

我需要使用并发数据结构，因为我将使用线程。我发现微软有几个[http://msdn.microsoft.com/en-us/library/dd504906.aspx#unordered_map](http://msdn.microsoft.com/en-us/library/dd504906.aspx#unordered_map)

一般来说，我必须处理

将数据接收到队列中......准备就绪时处理......继续接收数据。

我将使用 microsoft 提供的 concurrent_unordered_map 类来拥有一个存储名为 TouchInfo 的类的 cuncurrent 映射。每个 TouchInfo 对象都有一个唯一的 ID（无符号长整数），这是我用来检索需要更新的对象的 ID。

同时，我需要将 TouchInfo 插入并发队列中......一旦队列达到一个数字，我就处理队列......（不同的线程）

1.我的第一个问题是我是否需要unsigned long的特殊哈希函数...... unsigned long是系统从Windows 7中的多点触控系统（WinUser.h）中给出的ID（dwID）因为我有无法控制 ID，我想确保我的哈希函数得到优化。

```
typedef struct tagTOUCHINPUT {
    LONG x;
    LONG y;
    HANDLE hSource;
    DWORD dwID;
    DWORD dwFlags;
    DWORD dwMask;
    DWORD dwTime;
    ULONG_PTR dwExtraInfo;
    DWORD cxContact;
    DWORD cyContact;
   } TOUCHINPUT, *PTOUCHINPUT; 
```

也许，我不必做任何事情，只需声明

我在网上看到有人使用 Boost 来创建 Hash...

完全欢迎对我的设计进行任何输入和更改...

非常欢迎我的问题的答案！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:17:22.357

`concurrent_unordered_map`使用`std::hash`，它具有`unsigned long`. 它开箱即用就可以正常工作。

默认哈希值试图在大多数用例中达到最佳状态，但无法保证，因为每个人的数据都不同。在疯狂查看哈希函数之前绝对要对其进行基准测试（有很多，你可能会浪费很多时间）。

# android - 无法让 jQuery mobile 正常工作

> ID：13616031
> 
> 赞同：0
> 
> 时间：2012-11-28T23:06:49.663
> 
> 标签：android, jquery

我是 android 编程新手，我正在尝试使用 Phonegap 和 jQuery Mobile。

我已经配置了 Eclipse、Android SDK 和 Phonegap，并且工作正常，但是我在使用 jQuery 时遇到了问题。

这是我的 jQuery 测试页面：

```
 <!DOCTYPE html>
     <html>
     <head>
        <title>TEST</title>
        <script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
        <script type="text/javascript" charset="utf-8" src="jquery.mobile-1.2.0.js"></script>
        <script type="text/javascript" charset="utf-8">

    var deviceReadyDeferred = $.Deferred();
    var jqmReadyDeferred = $.Deferred();

    document.addEventListener("deviceReady", deviceReady, false);

    function deviceReady() {
        $('#title2').html('THIS WORK');
      deviceReadyDeferred.resolve();
    }

    $(document).one("mobileinit", function () {
      jqmReadyDeferred.resolve();
    });

    $.when(deviceReadyDeferred,  jqmReadyDeferred).then(doWhenBothFrameworksLoaded);

    function doWhenBothFrameworksLoaded() {
        $('#title2').html('THIS WORK');
    }

    </script>
   </head>
   <body>

     <table width=100% height="50" border ="0">
     <tr>
        <td>
            <div id="title">TEST</div>
            <div id="title2">TEST2</div>
        </td>
    </tr>
     </table>
    </body>
    </html> 
```

我希望将“TEST2”替换为“THIS WORK”，但是当我启动 Android 模拟器时情况并非如此。

有人可以帮我找出我做错了什么吗？

非常感谢你的帮助

此致。

弗洛朗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:57:31.730

我确认我错过了包含 jQuery 库。添加它解决了我的问题：

```
 <script type="text/javascript" charset="utf-8" src="jquery-1.8.3.js"></script> 
```

# java - 在 Windows 上安装协议缓冲区

> ID：13616033
> 
> 赞同：45
> 
> 时间：2012-11-28T23:07:04.657
> 
> 标签：java, windows, cygwin, mingw, protocol-buffers

我找不到在 Windows x64 平台上安装 Google 协议缓冲区（包括编译器）的明确说明。

我浏览了编译器和源代码的说明 README 文件：

> 对于编译器：要安装，只需将此二进制文件放在 PATH 中的某个位置

我将系统变量添加到路径：

```
PROTOC 'C:\dev_tools\protoc-2.4.1-win32' 
```

我坚持使用 Cygwin 安装协议缓冲区源。我尝试按照自述文件中提供的 Unix 说明进行操作：

> 要构建和安装 C++ 协议缓冲区运行时和协议缓冲区编译器 (protoc)，请执行以下操作：
> 
> ```
> $ ./configure
> $ make
> $ make check
> $ make install 
> ```
> 
> 如果`make check`失败，您仍然可以安装，但该库的某些功能可能无法在您的系统上正常工作。继续需要您自担风险。
> 
> `make install`可能需要超级用户权限。
> 
> 有关 configure 和 make 的高级使用信息，请参阅 INSTALL.txt。
> 
> **安装位置提示**
> 
> 默认情况下，软件包将安装到 /usr/local。但是，在许多平台上，/usr/local/lib 不是 LD_LIBRARY_PATH 的一部分。您可以添加它，但安装到 /usr> 可能更容易。为此，请按如下方式调用配置：
> 
> ```
> ./configure --prefix=/usr 
> ```

我明白了

```
-bash: ./configure: No such file or directory' 
```

有人可以提供清晰而详细的步骤来完成这项工作吗？

# 更新

我改用 MSYS/MINGW32 并按照此[链接](https://stackoverflow.com/questions/9243816/how-to-build-google-protocol-buffers-in-windows-for-mingw)中给出的说明进行操作。现在我坚持以下几点：

当我运行“./configure”命令时，出现以下错误：
**检查如何运行 C++ 预处理器.../lib/cpp
配置：错误：C++ 预处理器“/lib/cpp”未通过完整性检查”**

结果，make、make install 命令都不起作用。例如：

```
make: No targets specified and no makefile found. Stop. 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2019-01-10T17:03:15.113

如果您只想编译 ProtoBuf 定义，您可以在 ProtoBuf GitHub 发布页面上[为所有平台下载预编译的protoc 二进制文件。](https://github.com/protocolbuffers/protobuf/releases/)

他们至少从 2015 年开始就已经预编译了二进制文件，但是在许多下载之间很容易忽略它们。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-01-07T14:34:40.463

有一个完整的文档文件用于在 Windows 上编译 protobuf：

*   [https://github.com/google/protobuf/blob/master/src/README.md#c-installation---windows](https://github.com/google/protobuf/blob/master/src/README.md#c-installation---windows)
*   [https://github.com/google/protobuf/blob/master/cmake/README.md](https://github.com/google/protobuf/blob/master/cmake/README.md)

你需要 7-zip、Cmake 和 Visual Studio。

无论如何，使用持续集成工具（如 Travis 或 Appveyor）的一个意想不到的副作用是总是有一个最新的和工作的构建脚本可用。我碰巧总是在文件存在时查看它们`appveyor.yml`。`travis_config.yml`

```
>>> git clone -b v3.1.0 https://github.com/google/protobuf.git 
>>> cd protobuf
>>> curl -L -o release-1.7.0.zip https://github.com/google/googlemock/archive/release-1.7.0.zip
>>> 7z x release-1.7.0.zip
>>> del /Q release-1.7.0.zip
>>> rename googlemock-release-1.7.0 gmock
>>> curl -L -o release-1.7.0.zip "https://github.com/google/googletest/archive/release-1.7.0.zip"
>>> 7z x release-1.7.0.zip
>>> del /Q release-1.7.0.zip
>>> rename googletest-release-1.7.0 gtest
>>> move gtest gmock
>>> set generator=Visual Studio 12 Win64
>>> set vcplatform=x64
>>> mkdir build_msvc
>>> cd build_msvc
>>> cmake -G "%generator%" -Dprotobuf_BUILD_SHARED_LIBS=%BUILD_DLL% -Dprotobuf_UNICODE=%UNICODE% ../cmake
>>> msbuild protobuf.sln /p:Platform=%vcplatform% || goto error 
```

您将需要`curl`（`Git Bash`拥有它）以及解析`7z.exe`和`Msbuild.exe`可执行文件的路径。

我成功地使用 Visual Studio 2015 在 Windows 10 x64 机器上构建了 protobuf 编译器。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2021-06-12T05:46:08.833

用于在 Windows 中安装 proto buff

转到[https://github.com/protocolbuffers/protobuf/releases](https://github.com/protocolbuffers/protobuf/releases)

向下滚动并下载与 Windows 兼容的 zip

[二进制文件](https://i.stack.imgur.com/7QR5d.png)

下载 zip 后，将其解压缩到 C:/

只需复制路径， `C:\protoc-3.17.3-win64\bin`并将其设置为环境变量的路径

[路径设置](https://i.stack.imgur.com/fOM5k.png)

希望这可以帮助！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-12-25T21:52:59.147

从下载 protoc-2.5.0-win32.zip

[https://github.com/protocolbuffers/protobuf/releases/tag/v2.5.0](https://github.com/protocolbuffers/protobuf/releases/tag/v2.5.0)

然后安装，只需将此二进制文件放在 PATH 中的某个位置

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-07-10T04:39:38.233

使用[巧克力](https://community.chocolatey.org/packages/protoc)

`choco install protoc`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-04-10T16:03:19.923

我在 Windows 10 上构建**了 protobuf v2.4.1，**如下所示：

*   git 克隆[https://github.com/protocolbuffers/protobuf.git](https://github.com/protocolbuffers/protobuf.git)；
*   cd protobuf；
*   混帐结帐 v2.4.1；
*   cd vsprojects
*   在 Visual Studio 2019 中打开 protobuf.sln
*   按构建解决方案并出现许多错误： min undefined 和 max undefined 添加文件 protobuf/stubs/common.h 下一个代码：

> ```
> #if defined(_WIN32) && !defined(min)
> #define min(a,b) __min(a,b)
> #define max(a,b) __max(a,b)
> #endif 
> ```

*   按构建解决方案并出现错误：*致命错误 C1189：“#error: hash_map 已弃用，将被删除……。*”</li>
*   添加编译定义**-D_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS**解决问题
*   接下来我遇到了错误“<em>error C2664: "std::pair std::make_pair(_Ty1 &&,_Ty2 &&) noexcept”...</em>”</li>
*   在文件 src\google\protobuf\compiler\command_line_interface.cc 我修改了字符串“<em>proto_path_.push_back(make_pair< string, string >(virtual_path, disk_path));” 到“<strong>proto_path_.push_back(make_pair(virtual_path, disk_path));”
*   按构建解决方案。所有构建都成功。（测试项目在没有测试框架的情况下不构建）

    安装：

*   运行 extract_includes.bat 将所有公共头文件复制到单独的“包含”目录（在顶级包目录下）。
*   将包含目录的内容复制到要放置标头的任何位置
*   将 protoc.exe 复制到您放置构建工具的任何位置
*   将 libprotobuf.lib、libprotobuf-lite.lib 和 libprotoc.lib 复制到您放置库的任何位置。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-09-23T00:18:52.790

我用巧克力安装了它，它工作得很好。

```
choco --install -y protoc 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-05T20:26:48.287

我建议在 Windows 上使用*vcpkg*工具。这是*一步一步的* [手册](https://vcpkg.readthedocs.io/en/latest/examples/installing-and-using-packages/)。

关于*protobuf*，首先检查您有哪些选项（在 cmd 中）：

*vcpkg 搜索 protobuf*

[![在此处输入图像描述](../Images/f30a478a6fd7f68cf82123c61b46af78.png)](https://i.stack.imgur.com/GZQpe.png)

接下来安装所需的包： *vcpkg install protobuf:x64-windows-static*

注意冒号后面的*x64-windows-static* - 这是*三元组*。检查所有这些的*vcpkg 帮助三元组*。

然后转到*your_path\vcpkg-master\packages\protobuf_x64-windows-static\*

[![在此处输入图像描述](../Images/1ff76e5af1b8944ba67a7fa53ba7a027.png)](https://i.stack.imgur.com/khiL6.png)

现在您可以设置环境变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-07T18:18:38.973

现在 protobuf 是 Visual Studio 中的 NuGet 包。去拿那个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-24T08:52:31.677

很容易[参考](https://chocolatey.org/packages/protoc)

```
choco install protoc --pre 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-08-15T02:21:09.293

choco install protoc --pre 工作，确保您处于提升状态。

这是我从 gitbash 运行 protoc 时的输出

$ protoc 用法：C:\ProgramData\chocolatey\lib\protoc\tools\bin\protoc.exe [OPTION] PROTO_FILES 解析 PROTO_FILES 并根据给定的选项生成输出： -IPATH, --proto_path=PATH 指定目录寻找

将它添加到我的 $path 环境变量中并没有按预期工作。

# json - 如何通过 Genson/Jersey 配置日期格式化程序？

> ID：13616034
> 
> 赞同：3
> 
> 时间：2012-11-28T23:07:06.543
> 
> 标签：json, jersey, date-formatting, genson

我将 Jersey 用于我的 RESTful 服务并使用 Genson 来执行我的 JSON/POJO 转换。Genson 没有设置，我只是将它放到类路径中，它就可以工作，除了它在日期解析时抛出错误，因为格式是意外的。

现在，如果我要使用 Gson 作为 servlet 执行此操作，我会在我维护的 Gson 实例上设置日期格式。这会强制 POJO 的解析使用正确的格式。我看到 Genson 有一个类似的接口，但我不知道如何从 Jersey servlet 服务或 Spring 上下文中获取实例，以便我设置格式。

所以，简短的问题是：当我从泽西岛开始时，如何为 Genson 设置日期格式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:42:55.123

要配置 Genson 实例，您可以使用 Genson.Builder 类（在这一点上类似于 Gson）。然后你必须用泽西岛注入它。

```
@Component
@Provider
public class GensonProvider implements ContextResolver<Genson> {
   private final Genson genson = new Genson.Builder().setDateFormat(yourDateFormat).create();

    @Override
   public Genson getContext(Class<?> type) {
     return genson;
   }
} 
```

您可能还想看看 Genson 是如何集成到 Jersey中[的](https://code.google.com/p/genson/source/browse/src/main/java/com/owlike/genson/ext/jaxrs/GensonJsonConverter.java)。

# css - 如何在左右两侧设置两种不同的颜色？

> ID：13616035
> 
> 赞同：1
> 
> 时间：2012-11-28T23:07:08.403
> 
> 标签：css

我想要这个布局：

```
+-----------+------------------------+--------------+
|                                                   |
|                     TOP                           |
|                                                   |
|                                                   |
+-----------+------------------------+--------------+
|           |                        |              |
|           |                        |              |
|           |                        |              |
|     B     |       CONTENT          |       B      |
|           |                        |              |
|           |                        |              |
+-----------+                        |--------------+
|           |                        |              |
|           |                        |              |
|           |                        |              |
|     C     |                        |       D      |
|           |                        |              |
|           |                        |              |
|           |                        |              |
+-----------+------------------------+--------------+ 
```

“TOP”和“B”有一个背景：图像（从顶部的蓝色渐变到白色 - 例如 - 在底部），“CONTENT”是主页（菜单，条目等），“C”是白色颜色。

如果“D”也是白色，那么就没有问题了。但是“D”是其他颜色，例如红色。

当“内容”固定为 900 像素并居中（边距：自动）时，我必须进行设置，并且必须考虑不同的显示器宽度。“C”颜色必须在内容的左侧，“D”在右侧。页面必须兼容IE7、8、9等浏览器。

怎么做？

更新：

好的，让一些示例代码：

```
<body>
    <div id="content">
        I don't know, maybe height is less maybe not...
        <div class="clear"></div>
    </div>
</body> 
```

或者：

```
<body>
    <div class="wrapper">
        <div id="content">
            I don't know, maybe height is less maybe not...
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
</body>

body {
    /* background image - height: 400px */
    backgroud: url('images/bg.jpg') repeat-x;
}

#content {
    backgorund: #0f0;
    margin: auto;
    width: 900px;
    margin-top: 150px;
}

.clear {
    clear: both;
}

.wrapper {
    width: 100%;
} 
```

我想在内容的左下角获得白色（例如），在右下角获得红色（例如）。底部的意思是，当背景正文结束时，到页面的末尾。如果我知道内容的高度，那么我可以插入一个绝对值（右：0px；宽度为 50%）的 div。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:49:45.167

这是您需要的结构，采用“只需添加代码”格式：

顶部：全宽单个 div。

Bleft 和 C 包含在一个 div 中（现在让我们给它一个“容器”类）。

内容为 900 像素宽度的单个 div。

Bright 和 D 将具有与 Bleft 和 C 相同的结构。

然后创建一个从 Bleft 到 D 的新包装器 div，并将其标识为“主容器”。

然后对于 CSS，将 #main-container 设置为`display:table`，对于 .container，设置为 #content set `display:table-cell`。

这应该让你开始。让我知道布局如何为您锻炼，以及一旦您设置了此结构，您是否需要任何东西。

# mysql - 如何在 MySQL 中计算小数年

> ID：13616036
> 
> 赞同：0
> 
> 时间：2012-11-28T23:07:09.343
> 
> 标签：mysql

计算小数年日期差异的最佳方法是什么？

```
year(date1) - year(date2) always gives a whole number 
```

使用 unix_timestamp 将为闰年和非闰年提供不同的值（即，20NN 年 3 月 1 日至 20NN+1 年 3 月 1 日应始终为 1.00 年）。我可以将日期分解为几个月和几天，实际上是手动完成。

但是我正在寻找最好的方法——意味着最简单并且需要最少的调试时间（如果我自己做，我会花一半的晚上测试边缘案例）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:29:37.817

我不认为你会找到一种简单的方法来做你想做的事情。为了转换为一些十进制值，您必须了解分子和分母将是什么。正如您自己指出的那样，分母从闰年到非闰年会有所不同。这将使您不得不定义一年中哪些确切天的分母为 365，哪些天的分母为 366（即闰年从 1 月 1 日到 12 月 31 日的所有天的分母为 366，或者分母为 366在闰年前一年的 3 月 1 日到闰年的 2 月 29 日之间运行？）。

您不必为您的范围内的每一天总结每一天的价值（1/365 或 1/366）。假设您将闰年的开始定义为 1 月 1 日 - 这仍然不会为您提供 3 月 1 日（闰年）- 3 月 1 日（非闰年）的精确值 1，因为有些日子的分母为365和一些366。

如果您在闰年之前的一年的 3 月 1 日开始定义 366 的分母，那么对于 3 月 1 日 - 3 月 1 日的情况，您应该正好得到一个，但是当您想做 2 月 1 日（闰年）- 8 月 1 日（非闰年）。对于这 6 个月的差异，您现在不会得到正好 0.5。

我的猜测是，您最好通过执行类似的操作来近似您的数学

```
ROUND(( DATEDIFF(date1, date2) / 365.25), 2) 
```

这将为 365 天的差异 (365/365.25 = 0.9993) 和 366 天的差异 (366/365.25 = 1.0021) 提供 1.00

当然这也意味着 3 月 2 日（非闰年）- 3 月 1 日（非闰年）也会给你一个 1.00 的值。但是，如果您的精度是小数点后两位，那么您将使用 365 作为分母获得的值 (366/365 = 1.0027)

我们的日历系统并不真正有利于对其进行数学运算，因此通常情况下，您只需要接受一个合理的近似值并了解它的局限性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:30:11.213

你的意思是：

```
select datediff(curdate(),'2000-01-01') / 365.25 
```

?

# c# - 除法不返回双倍

> ID：13616043
> 
> 赞同：1
> 
> 时间：2012-11-28T23:07:47.897
> 
> 标签：c#, double, rounding

下面的值`fhr_1`计算为 0.0 为什么`fhr_1`不是 0.3？

```
 double fhr_1; 
        int n_fhr_1 = 9;
        int n_fhr_0 = 15;
        int n_fhr_2 = 6;

        fhr_1 = n_fhr_1/(n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T23:10:02.087

您至少需要一个`double`类型的操作数。否则你会得到整数结果（会发生整数除法）

```
fhr_1 = (double)n_fhr_1/(n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

或者

```
fhr_1 = n_fhr_1/(double)(n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

或者

```
fhr_1 = n_fhr_1 / ((double)n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

[您可以在msdn](http://msdn.microsoft.com/en-us/library/aa691373%28v=vs.71%29.aspx)上阅读有关除法规则的更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T23:10:23.390

```
double fhr_1; 
        int n_fhr_1 = 9;
        int n_fhr_0 = 15;
        int n_fhr_2 = 6;

        fhr_1 = (double)n_fhr_1/(n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

您必须将其中一个操作数转换为加倍，这样它将计算为加倍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T23:10:39.590

你不能简单地除整数，因为四舍五入你会得到 0。请尝试：

```
fhr_1 = ((double)(n_fhr_1))/(n_fhr_1 + n_fhr_0 + n_fhr_2); 
```

# php - Jquery：.replace® 不起作用

> ID：13616055
> 
> 赞同：0
> 
> 时间：2012-11-28T23:08:43.363
> 
> 标签：php, javascript, jquery, wordpress, wordpress-theming

为什么这不起作用？

```
<script type="text/javascript" src="js/jquery-1.8.1.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
            $("body").html($("body").html().replace(/&reg;/g, '<sup>&reg;</sup>').replace(/®/g, '<sup>&reg;</sup>').replace("\u00AE" , '<sup>&reg;</sup>'));
        };
    );
</script> 
```

Firefox 中的 Firebug 在控制台中给出了这个：“SyntaxError: missing ) after argument list”

但是，这完全破坏了 Wordpress……

```
<script type="text/javascript">
    $(document).ready(function() {
            $("body").html($("body").html().replace(/&reg;/g, '<sup>&reg;</sup>').replace(/®/g, '<sup>&reg;</sup>').replace("\u00AE" , '<sup>&reg;</sup>'));
        }
    );
</script> 
```

该功能的基本原理是查找正文中的每一个注册标记，并将其替换为“ ^® ”，如果此功能在 PHP 中也有，那就更可取了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T23:15:24.030

似乎最好的办法是进入数据库并运行一个 sql 查询来替换所有注册标记并将其包装在“”标签中。

但是，这确实适用于单个元素。（就像 adeneo 说的那样，替换整个网站的 HTML 不是一个好主意……这对我来说破坏了网站）

```
<script type="text/javascript"  src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"> </script>
<script type="text/javascript">
    $(document).ready(function() {
        $("h1").html(
            $("h1").html()
                .replace("®", "<sup>&reg;</sup>")
                .replace(/&reg;/g, '<sup>&reg;</sup>')
                .replace(/®/g, '<sup>&reg;</sup>')
                .replace("\u00AE" , '<sup>&reg;</sup>')
        ); 
    });
</script> 
```

# php - 从服务器路径获取 URL

> ID：13616060
> 
> 赞同：0
> 
> 时间：2012-11-28T23:09:21.493
> 
> 标签：php, codeigniter

我正在使用 Codeigniter 的文件上传库上传文件并尝试将 URL 插入数据库。Codeigniter 仅在使用时提供 server_path `$this->upload->data()`，不能用于向用户显示图像。

我通常可以做类似的事情，`base_url('uploads) . '/' . $data['file_name']`但我将每个帖子的图像存储在一个文件夹中。

例如，我得到`C:/xampp/htdocs/site/uploads/32/image.jpg`了完整路径，如何将其转换为`http://mysite.com/uploads/32/image.jpg`

唯一想到的是使用正则表达式，但我觉得必须有 PHP 函数或 Codeigniter 函数来帮助解决这个问题？

如何将服务器路径转换为正确的 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:25:48.493

您可以使用 $_SERVER['HTTP_HOST']; 获取网址。使用帖子的 ID，您可以像这样构建路径：

```
$url = "http://" . $_SERVER['HTTP_HOST'] . "/" . $id . "/" . basename($data['file_name']); 
```

basename() 函数返回路径中最后一个 / 之后的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:28:12.250

在`CodeIgniter`你应该使用`$config['base_url']`

您可以使用`ENVIRONMENT`来设置不同`base_url`的，例如：

```
switch(ENVIRONMENT)
{
    case 'development':
        $config['base_url'] = 'http://localhost/';
        break;
    case 'testing':
        $config['base_url'] = 'http://testing.server.com/';
        break;
    default:
        $config['base_url'] = 'http://liveserver.com/';    
} 
```

看`config.php`

`base_url`现在只需用,替换您的本地路径即可`str_replace`完成工作（[此处](http://ca3.php.net/str_replace)的文档）

```
$newpath = str_replace("C:/xampp/htdocs/site/", $config['base_url'], $localpath); 
```

此外，如果您有兴趣获取部分路径，您可以使用`explode`（[在此处](http://ca1.php.net/explode)记录）`/`创建一个包含路径的每个“部分”的数组

```
$pathElements = explode('/', $localpath); 
```

在这种情况下，`$pathElements[0]`是`C:`，`$pathElements[1]`是`xampp`，等等......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:42:33.470

您只需要将文件名保存到数据库，只需使用帖子 ID 和文件名：

```
$url = "http://mysite.com/uploads/" . $postID . "/" . $fileName; 
```

获取文件名使用：[如何使用 PHP 从完整路径获取文件名？](https://stackoverflow.com/questions/1418193/how-to-get-file-name-from-full-path-with-php)

```
<?php
$path = "C:/xampp/htdocs/site/uploads/32/image.jpg";
$file = basename($path);         // $file is set to "image.jpg"
$file = basename($path, ".jpg"); // $file is set to "image"
?> 
```

# entity-framework - 在实体框架中，获取一个新创建的对象并使用它来更新现有记录

> ID：13616065
> 
> 赞同：2
> 
> 时间：2012-11-28T23:09:42.960
> 
> 标签：entity-framework

这是我想做的：

```
var myCustomer = new Customer();
myCustomer.Name = "Bob";
myCustomer.HasAJob = true;
myCustomer.LikesPonies = false; 
```

然后我想将它传递给一个更新方法：

```
public UpdateCustomer(Customer cust)
{
  using(var context = dbcontext())
  {
     var dbCust = context.Customers.FirstOrDefault(c => c.Name == cust.Name);
     if(dbCust != null)
     {
        // Apply values from cust here so I don't have to do this:
        dbCust.HasAJob = cust.HasAJob;
        dbCust.LikesPonies = cust.LikesPonies
     }
     context.SaveChanges();
  }
} 
```

这样做的原因是我在我的应用程序的多个不同部分和/或跨 DLL 工作。这可能吗？

编辑：发现这个问题非常有用： [Update Row if it Exists Else Insert Logic with Entity Framework](https://stackoverflow.com/questions/5557829/update-row-if-it-exists-else-insert-logic-with-entity-framework)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:29:46.877

如果您确定实体在数据库中并且您有密钥，您只需将您拥有的对象附加到上下文中。请注意，附加实体默认处于未更改状态，因为假设所有属性值都与数据库中的相同。如果不是这种情况（即值不同），您需要将实体的状态更改为已修改。看看这篇博文：http: [//blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach- and-entity-states.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx)它描述了几个场景，包括你要问的那个。

# ssas - 在 KPI（SSAS Cube）中使用非维度数据

> ID：13616071
> 
> 赞同：0
> 
> 时间：2012-11-28T23:10:01.380
> 
> 标签：ssas, kpi

我正在尝试为每个部门以及整个大学的学生的表现创建 KPI。

整个大学的平均通过率目标是在一个OLTP表中，每个部门在部门OLTP表中都有自己的平均通过率目标。

对于部门KPI，我可以在目标表达式中使用部门OLTP表中定义的平均通过率目标，因为部门表也是维度表；其中，对于大学 KPI，大学 OLTP 表中的平均通过率目标无法访问（通过维度表），因为大学表不是维度表。在大学KPI目标表达中如何获取大学平均通过率目标？

# python - Django：如何扩展 SessionBase 以访问请求对象？

> ID：13616072
> 
> 赞同：0
> 
> 时间：2012-11-28T23:10:11.277
> 
> 标签：python, django, session, request, middleware

我有一个自定义会话类，用于扩展 Django SessionBase。我这样做是为了重用遗留的 Session 表，以便会话可以在我们的 Django 页面和 PHP 页面之间传递，而无需用户登录和退出。

到目前为止，一切都运行良好，但只有一个巨大的 BUT。

为了让 SessionStore.start() 函数可以访问请求对象，我编写了一些自定义中间件。不幸的是，为了做到这一点，我使用了这个答案：[从 backend.get_user 访问 request.session](https://stackoverflow.com/questions/1091593/django-access-request-session-from-backend-get-user)以解决我的问题。

我了解到，使用上述答案（基本上将请求对象绑定到设置，因此您可以使用 import settings* 然后 settings.request 访问）是完全可怕的，也是最糟糕的方法。

我的核心问题是我不明白如何从我编写的自定义会话后端访问请求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:28:35.650

也许在中间件中，您可以像这样将请求传递给您的自定义`SessionStore`：

```
request.session = engine.SessionStore(session_key,request) 
```

在 SessionStore 中：

```
class SessionStore(SessionBase):
    def __init__(self, session_key=None, request):
        self.request = request
        super(SessionStore, self).__init__(session_key) 
```

稍后您可以访问`request`.`self.request`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:27:13.960

Django 的 SessionMiddleware 这样做：

```
class SessionMiddleware(object):
    def process_request(self, request):
        engine = import_module(settings.SESSION_ENGINE)
        session_key = request.COOKIES.get(settings.SESSION_COOKIE_NAME, None)
        request.session = engine.SessionStore(session_key) 
```

你不能这样做吗？

```
import mycustomsessionbackend as myengine

class MyCustomSessionMiddleware(object):
    def process_request(self, request):
        session_key = request.COOKIES.get(settings.SESSION_COOKIE_NAME, None)
        request.session = myengine.SessionStore(session_key, request)

...

# mycustomsessionbackend.py
class SessionStore(SessionBase):
    def __init__(self, session_key=None, request=None):
        super(SessionStore, self).__init__(session_key)
        self.request = request 
```

# java - 正确的循环方式避免创建双重对象

> ID：13616076
> 
> 赞同：0
> 
> 时间：2012-11-28T23:10:35.893
> 
> 标签：java, object, loops

我有一个从数据库收集信息的程序。

在我之前的问题中，我询问了一个执行，其中一个响应让我重新思考我的循环的想法链接到旧问题：[ConcurrentModificationExecption](https://stackoverflow.com/questions/13609323/concurrentmodificationexecption)

所以这里是我从数据库中收集的大量信息的背景，其中一个信息是存储在我的数据库中的呼叫类型的名称，例如：邮件、电话等。将是不同类型的联系信息（我们称之为 CallQueues）

由于我提取的信息超过了几天，因此许多呼叫类型都会重复。以下是数据库中行的示例：

ID 姓名 日期 NoC NoAC

1 邮件 2012-11-27 3 3

其中 NoC = 呼叫数，NoAC = 应答呼叫数。

现在我的问题。

我最初的想法是遍历队列列表并查看名称是否重新出现，但这不起作用，因为我无法在循环时更改列表。所以这是我从while循环开始的新想法，我想知道的是：这是在这种情况下避免重复的最佳方法吗？如果不是，请向我解释我应该怎么做？

** 代码 **

```
 ArrayList<CallQueue> queues = new ArrayList<>();
    while (query.next()) {

        boolean isNew = true;
        if (!queues.isEmpty()) {
            for (CallQueue callQueue : queues) {
                if (callQueue.getType().equals(query.getString("NAME"))) {
                    double decimalTime = query.getDouble("DATE");
                    int hourOfDay = (int)Math.round(24 * decimalTime);
                    int callAmount = query.getInteger("NoC");
                    if (hourOfDay > 19) {
                        hourOfDay = 19;
                    }

                    callQueue.addCallsByTime(hourOfDay, callAmount);
                    isNew = false;
                }else {
                    isNew = true;
                }
            } 

            /* Out side the foreach loop, checks if the boolean isNew is true if it is create a new object and insert into the list*/
            if (isNew) {
                String queueName = query.getString("NAME");
                if (!queueName.equalsIgnoreCase("PrivatOverflow")) {
                    CallQueue cq = new CallQueue(query.getString("NAME"));
                    double decimalTime = query.getDouble("DATE");
                    int hourOfDay = (int)Math.round(24 * decimalTime); 
                    int callAmount = query.getInteger("NoC");
                    if (hourOfDay > 19) {
                        hourOfDay = 19;
                    }
                    cq.addCallsByTime(hourOfDay, callAmount);
                    queues.add(cq);
                }
            }
            /* if queues is empty which it will be the first time*/
        }else {
            String queueName = query.getString("NAME");
            if (!queueName.equalsIgnoreCase("PrivatOverflow")) {
                CallQueue cq = new CallQueue(query.getString("NAME"));
                double decimalTime = query.getDouble("DATE");
                int hourOfDay = (int)Math.round(24 * decimalTime); 
                int callAmount = query.getInteger("NoC");
                if (hourOfDay > 19) {
                    hourOfDay = 19;
                }
                cq.addCallsByTime(hourOfDay, callAmount);
                queues.add(cq);

            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:14:19.790

## 解释

不要做`queues`一个`ArrayList`，做一个`HashSet`或其他类型的`Set`。*这将在O(1)*而不是*O(n)*时间内为您捕获重复项。完成加载查询后，您始终可以将数据从 中取出`HashSet`并将其放入以`ArrayList`供将来使用（这还有一个额外的好处是您将确切知道制作 . 的`ArrayList`时间。这将是一个*O(n )*复制，但您只需要执行一次，而不是像其他方式那样每次都执行。

要正确执行此操作，您可能必须覆盖`CallQueue.hashCode()`and `.equals()`，但这很容易，只需返回字段的`.hashCode()`and`.equals()`方法`String name`。

## 漏洞？？

顺便说一句，我认为那`query`是 a `java.sql.ResultSet`，但`ResultSet`没有`getInteger`，它有`getInt`。你的代码编译了吗？

## 编码

这是代码，看看我的意思：

```
HashMap<String, CallQueue> queues = new HashMap<String, CallQueue>(); 

while (query.next()) {
  if (!queues.isEmpty()) {
    if (queues.containsKey(query.getString("NAME"))) {
      CallQueue oldQueue = queues.get(query.getString("NAME"));
      double decimalTime = query.getDouble("DATE");
      int hourOfDay = (int)Math.round(24 * decimalTime);
      int callAmount = query.getInt("NoC");
      if (hourOfDay > 19) {
        hourOfDay = 19;
      }

      oldQueue.addCallsByTime(hourOfDay, callAmount);
    } else {
      String queueName = query.getString("NAME");
      if (!queueName.equalsIgnoreCase("PrivatOverflow")) {
        CallQueue cq = new CallQueue(query.getString("NAME"));
        double decimalTime = query.getDouble("DATE");
        int hourOfDay = (int)Math.round(24 * decimalTime); 
        int callAmount = query.getInt("NoC");
        if (hourOfDay > 19) {
          hourOfDay = 19;
        }
        cq.addCallsByTime(hourOfDay, callAmount);
        queues.put(query.getString("NAME"), cq);
      }
    }
  }
}

// you could return this if you just want a collection...
Collection<CallQueue> values = queues.values();

// Or this if you MUST have an ArrayList...
return new ArrayList(values); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:16:08.290

您也可以在 sql 中使用 group by name 或 select distinct 来执行此操作。

# c++ - 解决模板中的循环依赖

> ID：13616084
> 
> 赞同：2
> 
> 时间：2012-11-28T23:11:18.910
> 
> 标签：c++, boost, cyclic-dependency

我正在尝试使用Boost实现一个名为Node的类的斐波那契指针堆。

```
typedef boost::heap::fibonacci_heap<Node*> FibonacciHeap;
typedef FibonacciHeap::handle_type HeapHandle; 
```

到现在为止还挺好。但我也想在 Node 类中存储堆元素的句柄。Boost 特别提到“句柄可以存储在 value_type 中”。[Boost](http://www.boost.org/doc/libs/1_49_0/doc/html/heap/concepts.html) 但是，我不能在类中定义比较运算符，因为堆从不使用它，只比较指针值。

但是定义一个作为模板参数传递给 fibonacci_heap 的比较结构会引入循环依赖：

```
struct CompareNode : public std::binary_function<Node*, Node*, bool>
{
    bool operator()(Node* lhs, Node* rhs) const   {
        return lhs->getFScore() > rhs->getFScore(); 
    }
};

typedef boost::heap::fibonacci_heap<
        Node*,
        boost::heap::compare<CompareNode> > FibonacciHeap; 
```

Node 依赖于 HeapHandle，HeapHandle 依赖于 Node。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:26:11.467

尝试转发声明节点，然后定义非内联运算符

```
// In Node.h

class Node;
struct CompareNode : public std::binary_function<Node*, Node*, bool>
{
    bool operator()(Node* lhs, Node* rhs) const;
};

typedef boost::heap::fibonacci_heap<
        Node*,
        boost::heap::compare<CompareNode> > FibonacciHeap;

typedef FibonacciHeap::handle_type HeapHandle;

class Node{

    HeapHandle handle_;
    int getFScore(); 
};

// In Node.cpp
#include "Node.h"

bool CompareNode::operator()(Node* lhs, Node* rhs) const   {
    return lhs->getFScore() > rhs->getFScore(); 
} 
```

# c++ - 在 C++ 中扩展运算符重载

> ID：13616091
> 
> 赞同：1
> 
> 时间：2012-11-28T23:11:41.947
> 
> 标签：c++, integer, overloading, operator-keyword

我是 C++ 的新手（我一生都在 C 中度过，所以我认为是时候花一些时间学习一门新语言以丰富我的知识了 :)）。我有一个名为“Rational”的类，我有它的所有特定函数，用于 getter、setter、构造函数等（这里不相关）。有趣的部分是当我尝试重载 +,-, *,/ 运算符时。我能够在两个 Rational 对象之间成功地做到这一点，例如 Rational a(1,5),b(5,5),c; c = a + b; 所以这一切都很好。现在我正在尝试通过*在 Rational 和整数之间进行 +、-、 、/ 来升级我的类，例如 2 + a、10 - b 等。这是我在 Rational 之间重载的（一段）代码：

理性.cc

```
...
    Rational Rational::operator+(Rational B) {
            int Num;
            int Den;

            Num = p * B.q + q * B.p;
            Den = q * B.q;

            Rational C(Num, Den);
            C.simplifierFraction();
            return C;
    }

    Rational Rational::operator-(Rational B) {
            int Num;
            int Den;        

            Num = p * B.q - q * B.p;
            Den = q * B.q;

            Rational C(Num, Den);
            C.simplifierFraction();
            return C;
    }

    Rational Rational::operator*(Rational B) 
    {
            int Num;
            int Den;

            Num = p * B.p;
            Den = q * B.q;

            Rational C(Num, Den);
            C.simplifierFraction();
            return C;
    }

    Rational Rational::operator/(Rational B) 
    {
            int Num;
            int Den;
            Rational invB = inverse(B);

            Num = p * invB.p;
            Den = q * invB.q;

            Rational C(Num, Den);
            C.simplifierFraction();
            return C;
    }
... 
```

理性.h

```
 Rational operator+(Rational B);
    Rational operator-(Rational B);
    Rational operator*(Rational B);
    Rational operator/(Rational B);

private:
    int p;
    int q;
protected: 
```

测试鼠.cc

```
int main() {
...
    const Rational demi(1,2);      
    const Rational tiers(1,3);      
    const Rational quart(1,4);
    r0 = demi + tiers - quart;         
    r1 = 1 + demi;                     
    r2 = 2 - tiers;                    
    r3 = 3 * quart;                    
    r4 = 1 / r0;
... 
```

所以当我尝试运行 TestRat.cc 它说：

```
testrat.cc:31: error: no match for ‘operator+’ in ‘1 + r9’
testrat.cc:52: error: passing ‘const Rational’ as ‘this’ argument of ‘Rational Rational::operator+(Rational)’ discards qualifiers
testrat.cc:53: error: no match for ‘operator+’ in ‘1 + demi’
testrat.cc:54: error: no match for ‘operator-’ in ‘2 - tiers’
testrat.cc:55: error: no match for ‘operator*’ in ‘3 * quart’
testrat.cc:56: error: no match for ‘operator/’ in ‘1 / r0’ 
```

为了能够完成这项工作，我必须做什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:14:51.940

tl;博士：

您的运营商应声明为：

```
Rational operator+(const Rational& B) const; 
```

嗯……至少这些。`operator =`应该返回对 的引用`*this`，但这超出了这个问题的范围。此外，这些运算符被定义为在`Rational`对象上工作，而

```
r1 = 1 + demi; 
```

试图对一个`int`和一个`Rational`对象进行操作。您必须在类外部定义一个适当的运算符：

```
inline Rational operator+(int, const Rational& r)
{
    //...
} 
```

[我建议你从一本好书](https://stackoverflow.com/q/388242/673730)开始学习 C++ 。只是从这里捡东西，并没有真正的工作。

# c++ - Mac 是否有 FindWindow() 替代方案？

> ID：13616097
> 
> 赞同：3
> 
> 时间：2012-11-28T23:12:10.843
> 
> 标签：c++, windows, macos, function

我正在将一个应用程序移植到 Mac OS X。它使用 FindWindow()。具体功能如下：

> FindWindow(NULL, "MyApplication")

但是，这在 Mac 上是行不通的。Mac OS X 是否有类似的功能，或者更好的是通用功能？

我正在尝试通过[此](http://www.un4seen.com/doc/)功能在“应用程序的主窗口”中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:16:29.633

没有像这样简单的一次性功能

您可以通过文章中的 CGWindow API 来完成。[如何从所有正在运行的应用程序中获取所有打开的 NSWindow 的列表？](https://stackoverflow.com/questions/4036420/how-to-get-a-list-of-all-open-nswindow-from-all-running-application). 它可用于查找列表或仅查找一个窗口。

只需获取列出的示例代码并对其进行修改以为您过滤它，这样您就只有一个您想要的窗口:)

# node.js - node.js 中的 setTimeout 是如何实现的

> ID：13616102
> 
> 赞同：32
> 
> 时间：2012-11-28T23:12:50.010
> 
> 标签：node.js, settimeout

我想知道是否有人知道[setTimeout](http://nodejs.org/api/timers.html#timers_settimeout_callback_delay_arg)在 node.js 中是如何实现的。我相信我在某处读到这不是 V8 的一部分。我很快试图找到实现，但在源代码（BIG）中找不到它。例如，我找到了这个[timers.js](https://github.com/joyent/node/blob/master/lib/timers.js)文件，然后例如链接到[timer_wrap.cc](https://github.com/joyent/node/blob/master/src/timer_wrap.cc)。但是这些文件并不能完全回答我所有的问题。

*   V8 有`setTimeout`实现吗？我想也从源头上答案是否定的。
*   如何`setTimeout`实施？javascript或本机或两者的组合？从 timers.js 我假设两者都有：

    ```
    var Timer = process.binding('timer_wrap').Timer;` 
    ```

*   添加多个计时器（setTimeout）时，node.js 如何知道先执行哪个？它是否将所有计时器添加到集合中（已排序）？如果它是排序的，那么找到需要执行的超时是 O(1) 和 O(log n) 用于插入？但是在 timers.js 中我又看到他们使用链表？

*   但话又说回来，添加很多定时器根本就不是问题吗？
*   执行此脚本时：

    ```
    var x = new Array(1000),
        len = x.length;

    /**
     * Returns a random integer between min and max
     * Using Math.round() will give you a non-uniform distribution!
     */
    function getRandomInt (min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    var y = 0;

    for (var i = 0; i < len; i++) {
        var randomTimeout = getRandomInt(1000, 10000);

        console.log(i + ', ' + randomTimeout + ', ' + ++y);
        setTimeout(function () {
            console.log(arguments);
        }, randomTimeout, randomTimeout, y);
    } 
    ```

    你得到一点CPU使用率，但不是那么多？

*   我想知道如果我会获得更好的性能，是否在排序列表中一一实现所有这些回调？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-28T23:52:45.320

你已经完成了大部分工作。V8 没有提供实现，`setTimeout`因为它不是 ECMAScript 的一部分。您使用的函数在 timers.js 中实现，它创建一个`Timeout`对象实例，该对象是 C 类的包装器。

源中有一条评论，描述了他们如何管理计时器。

```
// Because often many sockets will have the same idle timeout we will not
// use one timeout watcher per item. It is too much overhead.  Instead
// we'll use a single watcher for all sockets with the same timeout value
// and a linked list. This technique is described in the libev manual:
// http://pod.tst.eu/http://cvs.schmorp.de/libev/ev.pod#Be_smart_about_timeouts 
```

这表明它使用的是链接文章中#4 的双链表。

> 如果不是一个请求，而是数千个（数百万个......），都使用具有相同超时值的某种超时，那么可以做得更好：
> 
> 开始超时时，计算超时值并将超时放在列表末尾。
> 
> 然后使用 ev_timer 在列表开头的超时预期触发时触发（例如，使用技术#3）。
> 
> 当有一些活动时，从列表中删除计时器，重新计算超时，再次将其附加到列表的末尾，如果它是从列表的开头获取的，请确保更新 ev_timer。
> 
> 这样，可以在 O(1) 时间内管理无限数量的超时，以启动、停止和更新计时器，但代价是主要的复杂性，并且必须使用恒定的超时。恒定超时确保列表保持排序。

Node.js 是围绕异步操作设计的，并且`setTimeout`是其中的重要组成部分。我不会试图变得棘手，只是使用他们提供的东西。相信它足够快，直到您证明在您的特定情况下它是一个瓶颈。不要陷入过早的优化。

**更新**

发生的情况是，您在顶层基本上有一个超时字典，因此所有 100 毫秒超时都被组合在一起。每当添加新的超时或触发最旧的超时时，都会将其附加到列表中。这意味着最早的超时，即最快触发的超时，位于列表的开头。此列表有一个计时器，它是根据直到列表中的第一个项目设置为过期的时间来设置的。

如果您`setTimeout`以相同的超时值调用 1000 次，它们将按照您调用的顺序附加到列表中，`setTimeout`并且不需要排序。这是一个非常有效的设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-20T04:23:49.567

许多计时器没问题！当 uv 循环调用 poll 时，它会将 timeout 参数传递给所有计时器中最接近的计时器。

**[所有计时器中最接近的计时器]**
[https://github.com/joyent/node/blob/master/deps/uv/src/unix/timer.c](https://github.com/joyent/node/blob/master/deps/uv/src/unix/timer.c) #120

```
RB_MIN(uv__timers, &loop->timer_handles) 
```

**[将超时参数传递给 poll api]**
[https://github.com/joyent/node/blob/master/deps/uv/src/unix/core.c](https://github.com/joyent/node/blob/master/deps/uv/src/unix/core.c) #276

```
timeout = 0;  
if ((mode & UV_RUN_NOWAIT) == 0)  
    timeout = uv_backend_timeout(loop);  

uv__io_poll(loop, timeout); 
```

注意：在 Windows 操作系统上，几乎是相同的逻辑

# objective-c - 从 NSString 中过滤掉子字符串。. .也许使用正则表达式

> ID：13616108
> 
> 赞同：0
> 
> 时间：2012-11-28T23:13:43.030
> 
> 标签：objective-c, ios, regex, nsstring

这是我的问题：

我正在尝试从 NSString 对象中过滤掉 html 标签。

对此的大多数修复只是删除了介于 < 和 > 之间的所有内容，以及这些字符本身。我试图找出一种方法来删除“< ... >”子字符串，前提是它不包含空格或换行符。

我想这样做的方式看起来像这样

```
while ([source rangeOfString@"someRegEx" options:NSRegularExpressionSearch].location != NSNotFound) {

//find the range of the substring
//check for newlines/whitespace characters
//replace occurrences of the string with "" if it doesn't have them

} 
```

首先，这似乎是一个好方法吗？其次，我在弄清楚该正则表达式的样子时遇到了很多问题……有人知道它可能是什么样子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:20:09.740

正如 m.buettner 指出的那样，这似乎是一种很好的方法，只要您要查找的标签**真的从不包含 whitespace 。**正则表达式看起来像这样：

`<[^\s]*?>`

这`[^\s]`是一个否定字符类，它匹配除空白字符以外的任何字符。`?`使人变得`*`懒惰而不是贪婪。所以这个正则表达式在英文中的意思是“匹配一个'<'，然后是尽可能少的非空白字符，然后是一个'>'”。

[这是一个有用的页面](http://www.regular-expressions.info/examples.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:20:58.420

也许您应该考虑使用`NSXMLParser`, 描述[here](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)。

您将获得一组相当丰富的[委托方法](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSXMLParserDelegate_Protocol/Reference/Reference.html)来从字符串中提取您喜欢的任何内容。

# jquery - 属性目标链接

> ID：13616111
> 
> 赞同：0
> 
> 时间：2012-11-28T23:13:56.717
> 
> 标签：jquery

我正在尝试为特定段落内的链接提供目标。但我不让这个工作..

```
$(document).ready(function(){            
  $('.link a[@href^=""]')
    .attr("target", "_blank");
}); 
```

链接如下所示：

```
<p class="link"><a href="http://www.link.com">link</a></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:16:40.960

选择`@attr`器在很多版本之前从 jQuery 中删除（我认为是 1.2）。

要查找具有属性的锚点`href`，请使用[Has Attribute Selector](http://api.jquery.com/has-attribute-selector/)：

```
$('.link a[href]') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:15:46.427

您不想使用`[@href]`（即 XPATH 语法）。只是`[href^=""]`会工作。然而，这是一种奇怪的选择器——基本上是一个以空字符串开头的`a`an ？`href`你的意思是`a[href]`或`a[href^="https"]`？

# windows-8 - SuspensionManager 中的 CreateFileAsync 引发难以理解的异常

> ID：13616114
> 
> 赞同：0
> 
> 时间：2012-11-28T23:14:10.280
> 
> 标签：windows-8, suspend

我使用 Grid App (XAML) 模板创建了一个新的 Windows 应用商店应用项目。我在不更改任何代码的情况下运行了项目（在调试模式下）。在它运行时，我切换回 Visual Studio 并单击工具栏中的`Suspend`按钮。

此时，应用程序抛出了一个 SuspensionManagerException。异常的详细信息并没有太大帮助。消息是`SuspensionManager failed`。它有（到目前为止）无用的 HResult `-2146233088`。它还有一个同样无用的 InnerException。它的消息是`Error HRESULT E_FAIL has been returned from a call to a COM component.`，它的 HResult 是`-2147467259`，甚至比外部异常的 HResult 还要糟糕。

引发异常的代码行在 中`SuspensionManager`，这也是项目模板的一部分。这是行：

```
StorageFile file = await ApplicationData.Current.LocalFolder.CreateFileAsync(sessionStateFilename, CreationCollisionOption.ReplaceExisting); 
```

触发异常的部分是`LocalFolder.CreateFileAsync(…)`. CreateFileAsync 方法的 MSDN 文档有一个“备注”部分，内容如下：`If you try to create a file in a virtual folder like a library or a file group, this method may fail.`

而已。没有解释为什么它可能会失败，也没有描述它可能失败的条件，或者你能做些什么。

碰巧的是，即使它失败了，文件实际上也被创建了。有问题的文件被调用`_sessionState.xml`并位于`C:\Users\<username>\AppData\Local\Packages\<package_id>\LocalState`. 如果我删除文件并重新挂起应用程序，则会再次引发异常并重新创建文件。

我搜索了高低，并没有找到任何结论。CreateFileAsync 方法是一个投影，所以我不能轻易地拆开它或弄清楚它“可能失败”的原因。

有谁知道可能导致此问题的原因，或者如何进行调试或解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:32:27.713

首先要检查的是它[`Frame.Navigate`应该只以原语作为它的`parameter`参数](http://msdn.microsoft.com/en-us/library/windows/apps/hh702394.aspx)。

另外，请确保您正在调用`GetDeferral`事件`async`处理程序。

# sql - SSIS - 在 OLE DB 目标中的表中填充未映射的列

> ID：13616115
> 
> 赞同：5
> 
> 时间：2012-11-28T23:14:14.320
> 
> 标签：sql, sql-server, ssis, etl, dataflow

如下图所示，我在 SQL Server 中有一个表，我通过平面文件源填充该表。我要根据下面列出的逻辑更新目标表中的两列：

*   SessionID - 来自第一个 CSV 导入的所有行的值都为 1；第二次导入的值为 2，依此类推。
*   TimeCreated - CSV 导入发生时的日期时间值。

我不需要关于如何编写 TSQL 代码来完成这项工作的帮助。相反，**我希望有人建议一种方法来将其实现为 SSIS 中的数据流任务。**

![在此处输入图像描述](../Images/12634ac2db475d97e89ef5e80dfba207.png)

预先感谢您的想法。

**编辑 2012 年 11 月 29 日**

由于到目前为止所有的答案都建议在 SQL Server 端解决这个问题，我想向您展示我最初尝试做的事情（见下图），但它不起作用。SSIS 将数据插入目标表后，触发器未在 SQL Server 中触发。

如果你们中的任何人都可以解释为什么触发器没有触发，那就太好了。

![在此处输入图像描述](../Images/2ba2fce47cec7ff58687b6b739bf8a06.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T23:46:31.393

如果您能够修改目标表，则可以使 SessionID 和 TimeCreated 的默认值为您完成所有工作。SessionID 将是一个自动增量整数，而 TimeCreated 的默认值将是 getdate() 或 gettime()，具体取决于数据类型。

现在，如果您确实需要将值创建为工作流程的一部分，您可以为每个值使用变量。

SessionID 将是由执行 SQL 任务设置的包变量。只需引用结果集中的变量并让 SQL 确定下一个要使用的数字。但是，这存在潜在的并发问题。

TimeCreated 很容易通过基于系统变量 StartTime 在数据流中创建派生列来完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-28T23:46:16.387

您可以使用派生列来填充`TimeCreated`列，如果您希望数据流发生的时间，您只需使用日期和时间函数来获取当前日期时间。如果您想要整个包（所有文件）的公共时间戳，您可以使用系统变量`@[System::StartTime]`（或 whatitwascall）。

对于 CSV 循环（我猜），您使用 foreach 循环容器，并将迭代值映射到您在派生列中映射的用户变量，`SessionID`如上所述。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-28T23:40:34.470

首先，我最好在 SQL Server 端进行 :)
但是如果你不想或不能在服务器端这样做，你可以使用这种方法：

很明显，您需要将 SessionID 存储在可以为此创建 txt 文件的某个位置，或者更好地在 SQL Server 中创建一些设置表，或者可以有其他方法。

要添加列`SessionID`和`TimeCreated`OLE 目标，您可以使用[派生列](http://www.dotnetfunda.com/articles/article1233-use-of-derived-column-in-ssis.aspx)

# jquery - Jquery - 加载后更新 Facebook 评论插件

> ID：13616117
> 
> 赞同：-2
> 
> 时间：2012-11-28T23:14:28.283
> 
> 标签：jquery, facebook, facebook-comments

我想填充 Facebook 评论插件的 TextArea，以便在加载后它将在 textArea 中显示我的文本。

评论的 HTML 代码是

```
 <div class="fb-comments facebook" data-href="https://www.facebook.com/RighToDignity"
     data-num-posts="30" data-width="650">
  </div> 
```

使用 JQuery 的最佳方法是什么？我试过标准

```
$(document).ready(function ()
{
    $('.uiTextareaNoResize').val("bla bla bla");
 }); 
```

但它不起作用。

我还注意到 Facebook 在 textarea 上放置了一个 TITLE “Add Comments...”。这是导致不更新该值的原因吗？

===========================
PS我喜欢那些标记问题的人。有时我真的想知道他们有什么问题？
-- 必须是他们感觉自己在帮助他人的方式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T03:48:46.470

无法将文本预填充到 Facebook 评论插件的输入中。

[从应用程序发布到 Facebook 时是否可以预先填充评论框](http://facebook.stackoverflow.com/questions/13765998/is-it-possible-to-prepoulate-the-comments-box-while-posting-to-facebook-from-an/13770286#13770286)？

# c# - 写回文件时出现不规则字符/文本编码问题

> ID：13616127
> 
> 赞同：0
> 
> 时间：2012-11-28T23:15:20.260
> 
> 标签：c#, text, encoding

我正在使用此函数从文件中读取文本行：

`string[] postFileLines = System.IO.File.ReadAllLines(pstPathTextBox.Text);`

在关键位置插入几行额外的行，然后将文本行写回文件：

```
TextWriter textW = new StreamWriter(filePath);
for (int i = 0; i < linesToWrite.Count; i++)
{
    textW.WriteLine(linesToWrite[i]);
}

textW.Close(); 
```

在我正在阅读的文本文件包含国际或特殊字符之前，这非常有效。写回文件时，我没有得到相同的字符 - 它是一个盒子。

前任：

之前 =`W:\Contrat à faire aujourd`辉\`

之后 =`W:\Contrat � faire aujourd`辉\`

该网页将其描绘为问号，但在文本文件中它是一个矩形白框。

有没有办法在我的应用程序中包含正确的编码以便能够处理这些字符？或者，如果没有，抛出一个警告说它不能正确地写给定的行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:25:49.900

像这样添加encondig：

```
File.ReadAllLines(path, Encoding.UTF8); 
```

和

```
new StreamWriter(filePath, Encoding.UTF8); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T10:53:03.313

使用这个，对我有用

```
string txt = System.IO.File.ReadAllText(inpPath, Encoding.GetEncoding("iso-8859-1")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T13:43:49.667

您也可以在写入文件时尝试 UTF 编码，

```
textW.WriteLine(linesToWrite[i],Encoding.UTF8); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-10T16:08:10.157

您可能需要编写[单字节字符集](https://msdn.microsoft.com/en-us/library/dd374056(v=vs.85).aspx)

使用`Encoding.GetEncodings()`您可以轻松获得所有可能的编码。（“DOS”编码是`System.Text.SBCSCodePageEncoding`）

![在此处输入图像描述](../Images/384dced4a41ac9a5e9e1f4115227c6fa.png)

在您的情况下，您可能需要使用

```
File.ReadAllLines(path, Encoding.GetEncoding("IBM850")); 
```

和

```
new StreamWriter(filePath, Encoding.GetEncoding("IBM850")); 
```

邦尼之旅！;)

# php - 使用图像预加载页面以获得最佳用户体验的最佳方式

> ID：13616129
> 
> 赞同：0
> 
> 时间：2012-11-28T23:15:29.293
> 
> 标签：php, jquery, caching, preloader

我正在创建一个网站，其中有许多页面可以使用 next 和 prev 按钮滚动浏览。我从创建一个 java 幻灯片开始，但是在为每个图像创建主题标签和随后的社交按钮时出现了许多问题。我放弃了这个框架，因为 1）关闭 JS 的用户根本无法欣赏这些图像，并且 2）这让我很头疼。

我现在拥有的是许多页面的集合，上面有一张图片，其中每个下一步按钮都有一个指向下一页的链接。

除了预加载的图像（页眉、旁白和页脚不会“闪烁”）之外，使页面转换看起来没有任何变化的最佳方法是什么？很像 funcatpix.com/_pics/Cat_Lookout.htm

请记住，我不想使用 iframe 或 ajax，我想将 jquery 保持在最低限度。我的服务器上也有 PHP 5。

我是否缓存下一页的图像？我是否缓存整个下一页？我是否将标头控件更改为延长缓存寿命？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:21:40.423

在没有看到任何代码的情况下，我无法提供很多具体的帮助。只需使用以下命令，您就可以非常轻松地缓存图像：

```
$("<img>").attr('src', imageSource); 
```

这可用于预加载图像，因此您可以做的是预加载页面加载时或每次单击“下一步”时将出现在“下一页”页面上的图像。

# cassandra - 使用自动增量 ID 将 Oracle 数据库迁移到 Cassandra

> ID：13616131
> 
> 赞同：1
> 
> 时间：2012-11-28T23:15:44.643
> 
> 标签：cassandra, database-migration

我需要使用 Cassandra 迁移 Oracle 数据库。所有 Oracle 表都有主键作为自增整数类型。

如果我们使用整数类型的 UUID，它可以提供与 Cassandra 中的自增和主键相同的机制，我们是否可以设置起始值，以便我们可以轻松地使用 Cassandra 无缝迁移 Oracle 数据？

如果还有其他更好的选择，请提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:33:44.800

通常只使用 timeuuid，因此即使在重新启动时也无需设置起始值。另一种选择是 PlayOrm 的唯一键，它只是非常短的主机名（如 b1、b2、b3）+ 该主机中的唯一 ID。这非常像 timeuuid，但更短且更易于阅读。PlayOrm 只是 cassandra（ORM 第一层）的众多客户端之一。

# c++ - 在 C++ 中创建多个动态分配的对象

> ID：13616136
> 
> 赞同：0
> 
> 时间：2012-11-28T23:16:02.160
> 
> 标签：c++, instantiation, dynamicobject

比我聪明得多的人的另一个问题：

我正在尝试创建 3 个 Player 类的实例，如下所示：

```
Player *player1 = new Player("Aaron",0.3333333);
Player *player2 = new Player("Bob",0.5);
Player *player3 = new Player("Charlie",1); 
```

你可以在下面看到他们的构造函数。这真的很简单：

```
Player::Player(string n, double hr)
{
    name = n;
    hitrate = hr;
} 
```

（假设名称和命中率定义正确）

现在我的问题是，当我尝试检查每个玩家的名字时，似乎他们都成为了 player3 的别名

```
//Directly after the player instantiations:
cout << player1->getName() << "\n";
cout << player2->getName() << "\n";
cout << player3->getName() << "\n";

//In the Player.cpp file:
string Player::getName(){
    return name;
}

Outputs: 
Charlie
Charlie
Charlie 
```

好吧，所以我真的很想知道解决这个问题的最佳解决方案，但更重要的是我只想了解它为什么会这样。这似乎是一件很简单的事情（像我一样被java宠坏了）。

另外需要注意的是：这是针对学校作业的，我被告知我必须使用动态分配的对象。

非常感谢，如果有什么需要澄清的，请告诉我。

**编辑：根据需要，这里是完整的文件：**

### 播放器测试.cpp

```
#include <iostream>
#include <player.h>
using namespace std;

int main(){
    Player *player1 = new Player("Aaron",0.3333333);
    Player *player2 = new Player("Bob",0.5);
    Player *player3 = new Player("Charlie",1);
    cout << player1->getName() << "\n";
    cout << player2->getName() << "\n";
    cout << player3->getName() << "\n";
    return 0;
} 
```

### 播放器.h

```
#ifndef PLAYER_H
#define PLAYER_H
#include <string>
using namespace std;

class Player
{
    public:
        Player(string, double);
        string getName();
};

//Player.cpp
#include "Player.h"

string name;
double hitrate;

Player::Player(string n, double hr)
{
    name = n;
    hr = hitrate;
}

string Player::getName(){
    return name;
}

#endif // PLAYER_H 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:23:56.833

name 和 hitrate 变量需要在 Player 类声明中，以便每个对象都有自己的单独副本。

```
class Player
{
    public:
        Player(string, double);
        string getName();

    private:
        string name;
        double hitrate;
}; 
```

# sitecore - 通过后面的代码显示图像

> ID：13616140
> 
> 赞同：2
> 
> 时间：2012-11-28T23:16:11.660
> 
> 标签：sitecore, sitecore6

我有一个这样的站点核心控件：`<sc:Image ID="imgLogo" runat="server" Field="Image"/>`

现在，当前项目没有 Image 字段。我正在像这样通过 CurrentItem 中的 droptree 拉项目（**GetFieldValue**与 GetField 相同。我正在覆盖 Sitecore 中的基类）：

```
 string countryGuid = CurrentItem.GetFieldValue("Country", null); 
 Item country = sitecoreDatabase.GetItem(countryGuid);
 BindCountryLogo(); 
```

现在在这里`Item`我有一个国家标志的图像。我想在 sc:Image 上显示的所有内容。

到目前为止，我得到了这个：

```
 private void BindCountryLogo(Item country)
    {
        Fields.ImageField logoField = country.Fields["Image"];
        if (logoField != null && logoField.MediaItem != null)
        {
            //Sitecore.Data.Items.MediaItem image = new MediaItem(logoField.MediaItem);
            //string src = Sitecore.Resources.Media.MediaManager.GetMediaUrl(image);
            //imgLogo.DataSource = src;
            //imgLogo.ImageUrl = logoField.MediaItem.Source.;
            //string src = Sitecore.StringUtil.EnsurePrefix('/', Sitecore.Resources.Media.MediaManager.GetMediaUrl(logoField));
            //Sitecore.Data.Items.MediaItem img = new MediaItem(ImageField.Medi)
        }
     } 
```

他们都没有工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T23:41:42.567

该控件有一个属性“Item”，您可以将其设置为包含 imageField 的项目。

您的 BindCountryLogo 应如下所示：

```
private void BindCountryLogo(Item country)
{
    imgLogo.Item = country;    
} 
```

（或删除 BindCountryLogo() 方法并在 main 方法中设置 Item ;) ）

# facebook-graph-api - OpenGraph 调试器报告错误的 HTTP 响应代码

> ID：13616141
> 
> 赞同：1
> 
> 时间：2012-11-28T23:16:15.847
> 
> 标签：facebook-graph-api, mediatemple

对于许多正常运行的站点，当我通过开发人员 facebook com/tools/debug 上的 OpenGraph 调试器运行它们时，Facebook 报告服务器返回了 502 或 503 响应代码。

这些站点显然在负载不重的服务器上运行良好。我尝试过的网址包括但不限于：

[http://ac.mediatemple.net](http://ac.mediatemple.net) http://freespeechforpeople.org

这些实际上都是由 MediaTemple 托管的所有网站。然而，在与 MediaTemple 的人交谈后，他们坚持认为这一定是 API 中的错误，而不是他们的问题。还有其他人从 Facebook 调试工具获得意外的 500/502/503 HTTP 响应代码，站点由 MediaTemple 或其他任何人托管吗？有解决办法吗？

请注意，我已经查看了其中一个上的 Apache 日志，并且找不到任何证据表明 Apache 收到了来自 Facebook 的请求或 502 响应等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T00:47:06.203

得到了他们的回应：

> 此时，似乎 (mt) Media Temple 服务器正在向来自 Facebook 的所有请求（包括调试器）返回 200 个响应代码。这可以通过在访问日志中搜索来自调试器的命中来确认。有关查看访问日志的更多信息，请查看以下知识库文章：
> 
> 我的服务器的 access_log 和 error_log 文件在哪里？ [http://kb.mediatemple.net/questions/732/Where+are+the+access_log+and+error_log+files+for+my+server%3F#gs](http://kb.mediatemple.net/questions/732/Where+are+the+access_log+and+error_log+files+for+my+server%3F#gs)
> 
> 您可以使用以下命令检查访问日志中是否有来自 Facebook 的点击：
> 
> ```
> cat <name of access log> | grep 'facebook' 
> ```
> 
> 这将返回来自 Facebook 的所有点击。通常，调试器将指定用户代理“facebookplatform/1.0 (+http://developers.facebook.com)”，而来自 Facebook 的一般点击将指定“facebookexternalhit/1.0 (+http://www.facebook.com)”。 com/externalhit_uatext.php）。
> 
> 使用此信息，您可以通过使用“curl”模拟来自 Facebook 的请求来执行进一步的测试，如下所示：
> 
> ```
> curl -Iv -A "facebookplatform/1.0 (+http://developers.facebook.com)" http://domain.com 
> ```
> 
> 这应该返回 200 或 206 响应代码。
> 
> 总之，所有迹象都表明我们的服务器正在返回 200 个响应代码，因此问题似乎在于调试器解释此响应代码的方式。已向 Facebook 提交错误报告，我们仍在努力获取有关此问题的更多信息。当更多信息可用时，我们将确保为您更新。

好消息是，他们正忙于解决它。坏消息，这是我们无法控制的。

这里有一个关于此事的论坛帖子：

[https://forum.mediatemple.net/topic/6759-facebook-503-502-same-html-different-servers-different-results/](https://forum.mediatemple.net/topic/6759-facebook-503-502-same-html-different-servers-different-results/)

拥有超过 800 次观看和最近的活动，表明他们正在努力工作。

我注意到 https MT 网站甚至没有给出返回码：

```
Error parsing input URL, no data was scraped. 
```

* * *

**解析度**

MT 承认这是他们的错并修复了它：

> 在我们调查 Facebook 调试器问题的过程中，我们发现该工具使用的多个 IP 由于请求格式错误而被我们的防火墙过滤。我们已将 Facebook 调试器工具目前使用的 IP 地址范围列入白名单，如其网站上所列，这应该可以防止这种情况再次发生。
> 
> 我们相信我们的自动封禁系统已经阻止了多个 Facebook IP 地址。在我们的初步调查中，这并没有立即明确，我们很抱歉没有更早发现这一点。
> 
> API 请求可能间歇性失败的原因是许多 Facebook IP 地址中只有少数被阻止。API 在多个 IP 范围内进行负载平衡。当我们的系统发现滥用模式（例如导致 404 响应或无效 PUT 请求的 HTTP 请求）时，会添加一个全局防火墙规则来缓解这种行为。通常，该系统运行良好，可以保护我们的客户免受持续威胁。
> 
> 因此，话虽如此，我们今天一直在将 Facebook API 范围列入白名单，并确认我们的系统不再阻止这些请求。我们仍然希望受影响的人确认问题是否仍然存在。如果出于任何原因您仍然遇到问题，请打开或回复您现有的支持请求

# excel - 是否有一个公式可以返回趋势线斜率的方程？

> ID：13616143
> 
> 赞同：3
> 
> 时间：2012-11-28T23:16:24.530
> 
> 标签：excel, excel-formula

> **可能重复：**
> [我可以使用一个函数来获取趋势线的方程吗？](https://stackoverflow.com/questions/13615847/is-there-a-function-i-can-use-to-get-the-equation-for-the-trendline)

我知道如果你做一个绘图并启用趋势线方程，你可以找到它，我想知道是否有一种方法可以使用公式来推导它。我有数以千计的数据集，而将其中的每一个都绘制成图表并不是一种选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T23:45:47.767

使用该`LINEST`函数，但是，您需要将其作为数组公式输入以获取斜率和 y 截距。[请参见示例 1 -此处的](http://office.microsoft.com/en-us/excel-help/linest-function-HP010342653.aspx)斜率和 y 截距

# sql - SELECT 未按预期工作

> ID：13616152
> 
> 赞同：0
> 
> 时间：2012-11-28T23:17:32.583
> 
> 标签：sql, sql-server, vb.net

如果我删除`LIMIT "&PageStart&" , "&PageEnd&"`下面的查询工作正常。我从数据库中获取所有数据。但它不适用于`LIMIT`这两个参数。我究竟做错了什么？

```
Dim Conn,strSQL,objRec
Set Conn = Server.Createobject("ADODB.Connection")
Conn.Open "Driver={SQL Server}; Server=Localhost; Database=book-it-fifa;"
strSQL = "select distinct buchung_id, von, bis, abteilung, veranstalter, THEMA, THEMA_ENABLED " & _
    "  from RESERVIERUNGRAUM r  " & _
    "      ,BUCHUNG b  " & _
    " where r.BUCHUNG_ID = b.ID " & _
    "   and von >= convert(date, getdate(), 4) " & _
    "   and von < convert(date, dateadd(day,1, GETDATE()), 4) " & _
    "   and BIS >= getdate() " & _
    "   and STORNO is null  " 
Set objRec = Server.CreateObject("ADODB.Recordset")
objRec.Open strSQL, Conn, 1,3

If objRec.EOF Then
    Response.write (" Not found record.")   
Else

'**** Paging/Pagination Calculator ***'
Dim PageLen,PageNo,TotalRecord,TotalPage,intID
Dim PageStart,PageEnd
PageLen = 2 
PageNo = Request.QueryString("Page")
if PageNo = "" Then PageNo = 1
TotalRecord = UBound(objRec.GetRows,2)+1
PageStart = ((PageLen*PageNo)-PageLen)
PageEnd = PageLen
If TotalRecord <= PageLen Then
    TotalPage =1
ElseIf (TotalRecord Mod PageLen = 0) Then
    TotalPage =(TotalRecord/PageLen)
Else
    TotalPage =(TotalRecord/PageLen)+1
    TotalPage = Cint(TotalPage)
End If

'*** Close Object and Open New RecordSet ***'
objRec.Close()
strSQL = strSQL & "ORDER BY von, bis ASC LIMIT "&PageStart&" , "&PageEnd&" "
objRec.Open strSQL, Conn, 1,3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:21:57.617

SQL Server 不支持 LIMIT。你可以在这里读更多关于它的内容：

[http://channel9.msdn.com/Forums/Coffeehouse/102407-SQL-Server-and-LIMIT-clauses-on-SELECT-statements](http://channel9.msdn.com/Forums/Coffeehouse/102407-SQL-Server-and-LIMIT-clauses-on-SELECT-statements)

# php - 如何在浏览器的同一页面中获取 HTML 表单结果？

> ID：13616153
> 
> 赞同：3
> 
> 时间：2012-11-28T23:17:47.553
> 
> 标签：php, html

我正在用 PHP 和 HTML 输入一个简单的代码。如何在浏览器的同一页面而不是另一个窗口选项卡或页面中显示结果？

以下是简单的 HTML 公式代码：

将两个数字相加并显示在同一页面上

```
<html>
<head>
    <title> Sum of two numbers </title>
<body>

    <form action="sum.php" method="POST">
    First Number:  <input type="Text" Name="Num1"><br>
    Second Number: <input type="Text" Name="Num2"><p>
    <input type="Submit" value="Calculate">
    </form>

</body>
</html> 
```

文件`sum.php`如下。

```
<?php
// add First and Second Numbers
$sum = $_POST["Num1"] + $_POST["Num2"];
// their sum is diplayed as
echo "The sum of  First Number (".$_POST["Num1"].") and
Second Number  (".$_POST["Num2"].") is $sum";
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T23:23:38.153

```
<html>
<head>
    <title> Sum of two numbers </title>
<body>

    <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">
    First Number:  <input type="Text" Name="Num1"><br>
    Second Number: <input type="Text" Name="Num2"><p>
    <input type="Submit" value="Calculate">
    </form>

<?php
if (count($_POST) > 0 && isset($_POST["Num1"]) && isset($_POST["Num2"])){
    // add First and Second Numbers
    $sum = $_POST["Num1"] + $_POST["Num2"];
    // their sum is diplayed as
    echo "The sum of  First Number (".$_POST["Num1"].") and
    Second Number  (".$_POST["Num2"].") is $sum";
}
?>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T23:19:39.547

您必须将 PHP 代码和 HTML 代码组合在同一个文件中。
然后，您只需将表单操作设置为同一页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T23:24:06.990

```
<html>
<head>
    <title> Sum of two numbers </title>
<body>
<?php 
if($_POST["Num1"]=='' And $_POST["Num2"]==''){
?>      
    <form action="sum.php" method="POST">
    First Number:  <input type="Text" Name="Num1"><br>
    Second Number: <input type="Text" Name="Num2"><p>
    <input type="Submit" value="Calculate">
    </form>
<?php }else{
// add First and Second Numbers
$sum = $_POST["Num1"] + $_POST["Num2"];
// their sum is diplayed as
echo "The sum of  First Number (".$_POST["Num1"].") and
Second Number  (".$_POST["Num2"].") is $sum";
} ?>
</body>
</html>

and sum.php file is as follows. 
```

# java - java web的外部模板

> ID：13616154
> 
> 赞同：0
> 
> 时间：2012-11-28T23:17:59.777
> 
> 标签：java, spring, model-view-controller, jsp, templates

似乎 JSP、Velocity、Freemarker 等可以提供所谓的“内部模板”：我可以描述一个外部模板，然后定义内部部分。像这样（简化）：

**主.jsp：**

```
<html>
<body>
    <div class="container">
        <%@ include file="menu.jsp"%>
        <%@ include file="content.jsp"%>
    </div>
</body>
</html> 
```

所以我可以定义 menu.jsp 和 content.jsp 并且一切正常。但是这里的**外部**块有对**内部的引用**。不太适合我。

我正在寻找 Java 的技术，它可以让我实现这样的东西：

**some_block.jsp：**

```
<template file="main_template.jsp">
<div>
    ... my content here
</div>
</template> 
```

**main_template.jsp：**

```
<html>
<body>
    <div class="container">
        <inner_content />
    </div>
</body>
</html> 
```

IE。反之亦然 -**内部**块引用**了外部**。JSP可以吗？如果没有 - 我应该在 Spring MVC 中使用什么？

**编辑**：为什么对我来说更舒服：当控制器收到请求时，它会检测应该呈现什么视图。所以我可以呈现，例如，反馈表：

**反馈.jsp：**

```
<template file="main_template.jsp">
    <form> ... feedback form content here ... </form>
</template> 
```

或产品页面**product.jsp**：

```
<template file="main_template.jsp">
    <div> ... product page content here ... </div>
</template> 
```

并且不需要为每种页面描述页面结构，也不需要向外部模板传递任何参数来正确呈现内容。甚至不需要动态编译——所有页面只是一组隐含的预编译 servlet。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:28:15.990

我创建了一个您可能感兴趣的 JSP 标签库：

[http://www.inamik.com/projects/webframes/](http://www.inamik.com/projects/webframes/)

以下是我将如何使用 WebFrames taglib 实现您的请求

**请注意**，这与您的示例具有精确的一对一相关性，但与您的示例不同，WebFrames 允许您创建无限的占位符，因此您可以拥有动态标题、css 包含、右频道内容、左-导航等

**反馈.jsp**

```
<%@ page language="java" %>
<%@ taglib prefix="wf" uri="/WEB-INF/tld/webframes.tld" %>
<wf:render file="main_template.jsp">
    <wf:section name="inner_content">
        <form> ... feedback form content here ... </form>
    </wf:section>
</wf:render> 
```

**产品.jsp**

```
<%@ page language="java" %>
<%@ taglib prefix="wf" uri="/WEB-INF/tld/webframes.tld" %>
<wf:render file="main_template.jsp">
    <wf:section name="inner_content">
        <div> ... product page content here ... </div>
    </wf:section>
</wf:render> 
```

**main_template.jsp**

```
<%@ page language="java" %>
<%@ taglib prefix="wf" uri="/WEB-INF/tld/webframes.tld" %>
<html>
<body>
    <div class="container">
        <wf:render section="inner_content" />
    </div>
</body>
</html> 
```

* * *

# 官方 WebFrames 示例

下面是网站上的完整示例集，展示了如何创建/填充多个占位符：

[http://www.inamik.com/projects/webframes/examples/simpleexample.jsp](http://www.inamik.com/projects/webframes/examples/simpleexample.jsp)

首先查看示例主页的源代码：

**主要** [http://www.inamik.com/projects/webframes/examples/simpleexample.jsp.txt](http://www.inamik.com/projects/webframes/examples/simpleexample.jsp.txt)

```
<%@ page language="java" %>
<%@ taglib prefix="wf" uri="/WEB-INF/tld/webframes.tld" %>
<wf:render file="frame.jsp">
    <wf:section name="title">WebFrames Simple Example Page</wf:section>
    <wf:section name="header" file="headersection.html" />
    <wf:section name="footer" file="footersection.html" />
    <wf:section name="body">
        This page is a composite of the following sub-pages.  Click the links below to see
        the jsp/html that makes up each sub-page.
        <UL>
            <LI><A href="simpleexample.jsp.txt">simpleexample.jsp</A></LI>
            <LI><A href="frame.jsp.txt">frame.jsp</A></LI>
            <LI><A href="headersection.html.txt">headersection.html</A></LI>
            <LI><A href="footersection.html.txt">footersection.html</A></LI>
        </UL>       
    </wf:section>
</wf:render> 
```

看看这如何在不定义布局的情况下定义内容部分。

如果您查看布局（'frame.jsp'），您会发现它不知道要显示什么内容，它只是为内容创建占位符：

**框架** [http://www.inamik.com/projects/webframes/examples/frame.jsp.txt](http://www.inamik.com/projects/webframes/examples/frame.jsp.txt)

```
<%@ page language="java" %>
<%@ taglib prefix="wf" uri="/WEB-INF/tld/webframes.tld" %>
<HTML>
<HEAD><TITLE><wf:render section="title" /></TITLE></HEAD>
<BODY>
    <TABLE width="100%">
        <!-- Header -->
        <TR>
            <TD>
                <TABLE width="100%">
                    <TR>
                        <TD>
                            <wf:render section="header" />
                        </TD>
                    </TR>
                </TABLE>
            </TD>
        </TR>
        <!-- Body -->
        <TR>
            <TD>
                <TABLE width="100%">
                    <TR>
                        <TD>
                            <wf:render section="body" />
                        </TD>
                    </TR>
                </TABLE>
            </TD>
        </TR>
        <!-- Footer -->
        <TR>
            <TD>
                <TABLE width="100%">
                    <TR>
                        <TD>
                            <wf:render section="footer" />
                        </TD>
                    </TR>
                </TABLE>
            </TD>
        </TR>
</BODY>
</HTML> 
```

**标题** [http://www.inamik.com/projects/webframes/examples/headersection.html.txt](http://www.inamik.com/projects/webframes/examples/headersection.html.txt)

```
<!--  BEGIN headersection.html -->
<TABLE bgcolor="#00C0C0" width="100%">
    <TR>
        <TD nowrap="nowrap" align="LEFT">
            <H1>WebFrames Sample Header</H1>
        </TD>
    </TR>
</TABLE>
<!-- END headersection.html --> 
```

**页脚** [http://www.inamik.com/projects/webframes/examples/footersection.html.txt](http://www.inamik.com/projects/webframes/examples/footersection.html.txt)

```
<!--  BEGIN footersection.html -->
<TABLE bgcolor="#00C0C0" width="100%">
    <TR>
        <TD nowrap="nowrap" align="CENTER">
            Copyleft (c) SampleFooter Inc.
        </TD>
    </TR>
</TABLE>
<!-- END footersection.html --> 
```

这种模式提供了一个更加灵活的解决方案，可以创建可重用且更易于维护的组件。

**笔记**

这是基于 David Geary 早期的工作：

[http://www.javaworld.com/javaworld/jw-12-2001/jw-1228-jsptemplate.html](http://www.javaworld.com/javaworld/jw-12-2001/jw-1228-jsptemplate.html)

另外，如果您愿意（或考虑）非 JSP 解决方案，我本着 PHP 的 Smarty 模板引擎的精神编写了一个基于 Java 的模板引擎

[https://github.com/iNamik/iNamik-Template-Engine](https://github.com/iNamik/iNamik-Template-Engine)

我还有一个用于这个引擎的“Frames”标签库，它还没有在 GitHub 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T16:02:43.097

我找到了两种解决方案——一种很复杂，一种非常简单可爱：

第一个是 SiteMesh： [http ://wiki.sitemesh.org/](http://wiki.sitemesh.org/)

第二个是来自 Claudius Hauptmann 的自定义标签： [http ://code.google.com/p/jsp-decorator](http://code.google.com/p/jsp-decorator)

两者都工作正常，所以我希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T00:03:18.417

使用 JSP TAG 文件很容易做到这一点。

首先创建您的模板标签：

**/WEB-INF/tags/template/maintemplate.tag**

```
<%@ tag body-content="scriptless" %>
<html>
<body>
    <div class="container">
        <jsp:doBody/>
    </div>
</body>
</html> 
```

然后创建使用模板标签的 JSP 页面：

**/some_page.jsp**

```
<%@ page %>
<%@ taglib prefix="template" tagdir="/WEB-INF/tags/template" %>
<template:maintemplate>
    <div>
        ... my content here
    </div>
</template:maintemplate> 
```

您的 JSP 页面使用 maintemplate.tag 并向其传递一个正文内容块。maintemplate.tag 选择在哪里呈现该正文内容。

# xcode - 计划和构建预操作脚本输出？

> ID：13616156
> 
> 赞同：3
> 
> 时间：2012-11-28T23:18:17.740
> 
> 标签：xcode, build

我在 Xcode 4 中有一个方案。我编辑了这个方案，以便*Build*有一个*Pre-Action*，并且那个 action 是一个*script*。

该脚本很简单 - 它转储预处理器定义：`cpp -dM < /dev/null`.

我在哪里可以找到脚本的输出？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-12T10:09:27.760

将此行添加到预操作脚本

```
pwd > ~/current_directory.txt 
```

然后检查你的主目录中的文件 current_directory.txt

# c# - 为什么我不能有对象的类型约束

> ID：13616161
> 
> 赞同：5
> 
> 时间：2012-11-28T23:18:34.473
> 
> 标签：c#, .net, generics

我正在尝试设置允许`Object`作为我的 TValue 的自定义 IDictionary。

这是它的样子：

```
public class NullTolerantDictionary<TKey, TValue> 
             : Dictionary<TKey, TValue> where TValue : class
{
    public TValue this[TKey key]
    {
        get
        {
            TValue value;
            if (TryGetValue(key, out value))
            {
                return value;
            }
            else
            {
                return DependencyProperty.UnsetValue;
            }
        }        
    }
} 
```

当它编译时它说：

> 无法将类型“object”隐式转换为“TValue”。

所以为了解决这个问题，我将我的类型约束更改为：

```
where TValue : object 
```

（`object`而不是类）

然后我收到这条消息：

> 约束不能是特殊类“对象”

**我该如何解决这个问题？**

解释为什么`object`不能成为约束的额外功劳。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T23:22:21.817

这里的问题不在于泛型类型参数约束，而在于索引器的签名。

索引器被记录为始终返回 a `TValue`，*无论发生什么*。然而`else`分支试图返回`DependencyProperty.UnsetValue`，它是 type `object`。由于并非所有`object`s 都是`TValue`s，因此编译器会抱怨（“没有隐式转换”）。

如果您在 上放置任意数量的约束`TValue`，即使您可以将其约束到 ，也没有什么区别`object`。类型参数仍然可以设置为比派生更多的任何东西`object`，并且`DependencyProperty.UnsetValue`仍然不能转换为该类型。

如果你想达到这样的效果，你可以使用`public static`只读属性，例如

```
public class NullTolerantDictionary<TKey, TValue> 
         : Dictionary<TKey, TValue> where TValue : class
{
    public static TValue MissingValue { get; private set; }
} 
```

并从索引器返回它，大概这样它就可以用于参考比较。

但这仍然会留下一个悬而未决的问题：实际上如何获得`TValue`使用 as 的值`MissingValue`？您可以将`new()`约束放在`TValue`静态构造函数上并在其中创建一个实例，但这会减少此类的可能应用程序。这导致设计开始使用起来有点笨拙，因为这正是你想要避免的，所以这样做没有多大意义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T23:22:06.240

> 为什么对象不能成为约束？我该如何解决这个问题？

你没有。你不需要。.NET 中的所有托管类型都可以转换为`object`. 有一些东西不能（非托管指针等），但无论如何它们与泛型不兼容。

我想，真正的问题`DependencyProperty.UnsetValue`是`object`。嗯……那不是`TValue`。想象一下`TValue`is `int`or `byte`：没有 or 的“未设置”`int`值`byte`。您不能`object`为这样的`TValue`.

坦率地说，我只是让你的调用者`TryGetValue`直接使用，而不是使用这个扩展方法。你*可以*做一些事情，比如用`TValue`, 或返回来返回一个虚拟类实例`null`- 但坦率地说，调用者可以更方便地*调用`TryGetValue`*来实现同样的事情。

# c# - 使用 xml 文件中的值分配对象数组的每个成员

> ID：13616162
> 
> 赞同：0
> 
> 时间：2012-11-28T23:18:34.923
> 
> 标签：c#, xml, arrays, object

我有一个程序，其中变量 week 由对象数组 [7] 天组成，而天由对象数组 [9] 小时组成。每个小时对象有 3 个数据成员。我想为特定日期和时间的每个成员分配 xml 文件中的特定值：

```
 <parent> 
        <day>wednesday
            <hour>18.00 
                <value1>5</value1>
                <value2>10</value2>
                <value3>15</value3>
            </hour>
        </day>
        <day>thursday
            <hour>18.00 
                <value1>2</value1>
                <value2>3</value2>
                <value3>9</value3>
            </hour> 
        </day>
   </parent>

        day[wedensday].hour[18.00].member1 = xml.day[wednesday].hour[18.00].value1
        day[wedensday].hour[18.00].member1 = xml.day[wednesday].hour[18.00].value2
        day[wedensday].hour[18.00].member1 = xml.day[wednesday].hour[18.00].value3 
```

我是使用 xml 的新手，并提出了以下伪代码，但很难实现它：

```
 member[i] = value[i] where day[i].name == xml.day && day[i].hour[i] == xml.hour 
```

如果有人可以指导我或指导我找到有助于解决此问题的资源，将不胜感激，谢谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:29:53.243

您可以使用 Linq to xml 解析您的 xml：

```
XDocument xdoc = XDocument.Load(path_to_xml_file);
var week = new
{
    Days = xdoc.Descendants("day")
                .Select(day => new {
                    Name = ((XText)day.FirstNode).Value.Trim(),
                    Hours = day.Descendants("hour")
                                .Select(hour => new {
                                    Time = ((XText)hour.FirstNode).Value.Trim(),
                                    Values = hour.Elements()
                                                .Select(node => (int)node)
                                                .ToList()
                                }).ToList()
                }).ToList()
}; 
```

week 将是强类型匿名对象。用法：

```
var daysCount = week.Days.Count; // 2 
var secondDayName = week.Days[1].Name; // thursday
var hoursInSecondDay = week.Days[1].Hours.Count; // 1
var timeOfFirstHour = week.Days[1].Hours[0].Time; // 18:00
var value3 = week.Days[1].Hours[0].Values[2]; // 9 
```

解释：

`xdoc.Descendants("day")`返回所有`<day>`节点。但是我们不需要 xml 节点，所以我们通过选择匿名对象来进行投影，这将代表一天。这个对象有两个属性 -`Name`和`Hours`。我们从`<day>`元素的第一个节点获得的名称，即文本节点（第一天的“星期三”）。我们通过选择`<hour>`元素`<day>`并投影到代表小时的匿名对象来获得小时。等等。

* * *

如果您将日期名称和小时值移动到如下属性：

```
<parent>
  <day name="wednesday">  
    <hour time="18.00">    
      <value1>5</value1>
      <value2>10</value2>
      <value3>15</value3>
    </hour>
  </day>
</parent> 
```

然后解析将如下所示：

```
XDocument xdoc = XDocument.Load(path_to_xml_file);
var week = new
{
    Days = xdoc.Descendants("day")
                .Select(day => new {
                    Name = (string)day.Attribute("name"),
                    Hours = day.Descendants("hour")
                                .Select(hour => new {
                                    Time = (string)hour.Attribute("time"),
                                    Values = hour.Elements()
                                                .Select(node => (int)node)
                                                .ToList()
                                }).ToList()
                }).ToList()
}; 
```

# c++ - 我需要调整指针数组的大小

> ID：13616163
> 
> 赞同：0
> 
> 时间：2012-11-28T23:18:53.027
> 
> 标签：c++

假设我想调整一个 int 指针数组的大小，我有一个看起来像这样的函数

```
 template<typename T>
static void Resize(T* arr, UINT oldsize, UINT newsize) {
    T* ret = new T [newsize];
    memcpy(ret, arr, sizeof(arr[0]) * oldsize);
    delete[] arr;   
    arr = ret;
}; 
```

当我尝试调整使用“new”关键字创建的元素数组（即使类内的数据本身是 POD）时，问题就开始了，因为 delete[] 触发了它们的解构函数，然后将新数组留下指向不再存在的对象。所以.. 即使对象是用“new”创建的，我不能只使用 free 命令来摆脱旧数组吗？或者以某种方式删除数组而不触发每个成员的解构器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T23:32:26.213

使用`std::vector`.

* * *

**编辑**：根据大众的需求，解释为什么 OP 的代码*不起作用*。

编码：

```
template<typename T>
static void Resize(T* arr, UINT oldsize, UINT newsize) {
    T* ret = new T [newsize];
    memcpy(ret, arr, sizeof(arr[0]) * oldsize);
    delete[] arr;   
    arr = ret;
}; 
```

这`arr`是一个按值传递的指针。最后分配给`arr`只会更新实际参数的本地副本。因此，在此之后，调用代码中的实际参数指向一个已为`delete`d 的数组，结果非常糟糕！

*可以通过引用*传递该指针来拯救它：

```
template<typename T>
static void Resize(T*& arr, UINT oldsize, UINT newsize) {
    T* ret = new T [newsize];
    memcpy(ret, arr, sizeof(arr[0]) * oldsize);
    delete[] arr;   
    arr = ret;
}; 
```

但这仍然是非常脆弱的代码。

例如，调用者需要跟踪数组大小。

使用`std::vector`被调用`a`，调整大小调用看起来像

```
a.resize( newSize ) 
```

与 DIY 解决方案相比，当`newSize`更大时，向量的那些额外元素将被归零（这比将它们保留为不确定值更安全一些）。

A`std::vector`可以像原始数组一样被索引。有关如何使用它的更多详细信息，请参阅您的**C++ 教科书。**如果您还没有 C++ 教科书，那就买一本吧：对于大多数人来说，从网络上的文章和问答中学习 C++ 只是一个不切实际的提议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:18:56.290

对于它的价值，您尝试做的事情并不是一件非常糟糕的事情，而且有时它是有道理的，但它根本不被`new`and `delete`（或`new[]`and `delete[]`）提供的接口所支持。正如其他人所说，它**由**`malloc`, `free`, 和支持`realloc`（警告`realloc`将在重新分配时复制指针值，但不能保证新区域中的指针被初始化为任何有用的东西，例如`NULL`）。

因此，事不宜迟，适用于几乎所有人的最简单答案是使用 a`std::vector<int>`而不是尝试自己管理内存。矢量具有调整大小的能力，当它调整大小时，它会复制需要复制的东西。 `std::vector`存在以提供“可调整大小的数组”并为您管理内存。实际上，如果你想要一个指针容器，你最好使用`std::vector<std::unique_ptr<T>>`/ `std::vector<std::shared_ptr<T>>`（在 C++11 中）或来自[Boost Pointer Container](http://www.boost.org/libs/ptr_container/doc/ptr_container.html)的东西。

值得一提的是，原来的 STL 没有使用`new[]`或`delete[]`实现`std::vector<T>`. 通常，操作系统提供的内存远远超过您的要求。例如，如果我尝试使用`malloc`16 个字节，我返回的块很可能是 1024 个字节。我可以用它来存储四个 32 位整数。当我用完空间时，我可能会要求 32 个字节，并得到一个不同的 1024 字节块，我可以将我的四个整数复制到其中。但是，当原始块实际上大到可以开始时，为什么还要麻烦要求一个新块来保存我的整数呢？不幸的是，`new[]`不要`delete[]`提供一种方式来说“给我一个至少有这么大的块，顺便说一下，这里有一个可能已经足够大的块”。 `realloc`有点像。 [Facebook Folly 包含一个`std::vector`](https://github.com/facebook/folly/blob/master/folly/FBVector.h)不使用`new[]`or的类似[容器](https://github.com/facebook/folly/blob/master/folly/FBVector.h)`delete[]`（请注意，它也不使用`realloc`任何一个，因为它通常不适用于对象容器；相反，它使用`malloc`and 非标准函数`malloc_usable_size`），并且[Firefox 通过](https://blog.mozilla.org/nnethercote/2011/08/05/clownshoes-available-in-sizes-2101-and-up/)以类似方式管理内存[的麻烦。](https://blog.mozilla.org/nnethercote/2011/08/05/clownshoes-available-in-sizes-2101-and-up/)

即便如此，我不鼓励试图变得棘手。 `std::vector`有很多满意的用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T23:55:09.900

我认为在删除之前使数组中的所有元素都指向 NULL 应该可以完成这项工作。但是，如果您可以使用 STL，那么 std::vector 会让您的生活更轻松（正如 Alf 建议的那样：P）。

# javascript - 缩短方法。语法更好的做法

> ID：13616164
> 
> 赞同：2
> 
> 时间：2012-11-28T23:19:03.187
> 
> 标签：javascript, jquery, syntax, coding-style

我一直在通过 jQuery 学习如何缩短时间。我想知道这个脚本是否可以用不那么冗长的方式表达？我不喜欢所有东西都排在一条大线上。

```
 items.push('<li id="' + key + '">' + ' (key: ' + key + ')(value: ' + val.value +         ')(type: ' + val.type + ') (range: ' + val.range + ') (clone: ' + val.clone + ') (archive: ' + val.archive + ') (access: ' + val.access + ')</li>') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:25:18.243

假设对象将始终具有正确的键/值：

```
str = '';
for (var item in val) {
   str += '(' + item + ': ' + val[item] + ')';
}
$("<li>").attr('id', key).text(' (key: ' + key + ')' + str); 
```

[http://jsfiddle.net/36Nyu/](http://jsfiddle.net/36Nyu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:26:46.117

如果`items`是另一个元素，你可以做这样的事情。

```
var str;

for(var i in val)
    str += '('+ i +': '+ val[i] +')';

$('<li>', {
    id: key,
    text: str
}).appendTo(items); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:21:46.747

您可以使用 jquery tmpl 或类似的：

```
var template = '(key: ' + key + ')(value: {{value}})(type: {{type}}) (range: {{range}}) (clone: {{clone}}) (archive: {{archive}}) (access: {{access}})';
$('<li />').attr('id', key).html($.tmpl(template, val)); 
```

或者，使用 string.Format 等效项：

```
String.prototype.format = function () {
    var args = arguments;
    return this.replace(/\{\{|\}\}|\{(\d+)\}/g, function (m, n) {
        /* Allow escaping of curly brackets with {{ or }} */
        if (m === '{{') { return '{'; } else if (m === '}}') { return '}'; }
        return typeof args[n] != 'undefined' ? args[n] : '{' + n + '}';
    });
};
var text = '(key: {0})(value: {1})(type: {2}) (range: {3}) (clone: {4}) (archive: {5}) (access: {6})'.format(key, val.type, val.range, val.clone, val.archive, val.access); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T23:30:23.817

假设您要在`val`对象中附加所有键/值对，则执行以下操作将非常易于维护：

```
var liPrefix = '<li id="' + key + '">(key: ' + key + ')',
    liSuffix = '</li>',
    liData = '';

$.each(val, function(k, v) {
    liData += ' (' + k + ': ' + v + ')';
});

items.push(liPrefix + liData + liSuffix); 
```

## [看演示](http://jsfiddle.net/cY9yu/1/)

# regex - 关于重写正则表达式的建议

> ID：13616167
> 
> 赞同：0
> 
> 时间：2012-11-28T23:19:24.813
> 
> 标签：regex, .htaccess, mod-rewrite, url-rewriting

对于在 .htaccess 文件中重写 URL 的帮助，我将不胜感激。

我有这个结构

```
http://foo.com/news/?start=24
http://foo.com/work/?start=24 
```

如果是“新闻”或“工作”，我希望能够重写 .com 之后的内容，并删除问号之后的任何内容。

例子

```
http://foo.com/news/?start=24 => http://foo.com/news
http://foo.com/work/?start=24 => http://foo.com/work 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:01:39.077

如果您还想重定向此类路径中的任何其他文件，例如`work/something?params`，请使用

```
RewriteEngine On
RewriteCond %{QUERY_STRING} [^?]
RewriteCond %{HTTP_HOST}:%{SERVER_PORT}s ^(.*):(443(s)|\d+s)$
RewriteRule ^/?(news|work)(/|$) http%3://%1/$1? [R=301,L] 
```

`news`或者，如果您不希望在or之后包含额外的可选文件`work`，请使用：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} [^?]
RewriteCond %{HTTP_HOST}:%{SERVER_PORT}s ^(.*):(443(s)|\d+s)$
RewriteRule ^/?(news|work)/?$ http%3://%1/$1? [R=301,L] 
```

# raphael - RaphaelJs 和 RequireJs 不能一起工作

> ID：13616168
> 
> 赞同：2
> 
> 时间：2012-11-28T23:19:24.860
> 
> 标签：raphael, requirejs

我正在尝试使用 Requirejs 加载 Raphaeljs。我在这里尝试了这个解决方案： [https ://github.com/DmitryBaranovskiy/raphael/pull/540](https://github.com/DmitryBaranovskiy/raphael/pull/540)

但是当我加载它时，我得到：

> 未捕获的类型错误：无法调用未定义的“on”方法

我更深入地研究它，我发现 eve 是未定义的。任何人都有任何想法让它与requirejs一起工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T15:32:14.710

您可以克隆 Raphael 并按照 Dmitry 在[此处](https://github.com/DmitryBaranovskiy/raphael/#quickstart-guide "这里")的描述更新子模块，然后对于 RequireJS，执行以下操作：

```
paths: {
  "eve": "libs/raphael/eve/eve",
  "raphael": "libs/raphael/raphael"
},
shim: {
  'eve': {
    exports: "eve"
  },
  'raphael': {
    deps: ["eve"],
    exports: "Raphael"
  }
} 
```

在需要时仅用`"raphael"`作依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T00:02:46.157

几周前我遇到了同样的问题，但我使用的是[JamJS](http://jamjs.org/)，它是一个前端包管理器，它**使用 Require.JS**并为你管理*require.config.js*。

自从我使用 JamJS 以来，这可能无法解决您的问题，但无论如何，这就是我解决它的方法：我为 RaphaelJS 创建了一个包 - 使用[pmcelhaney 的 fork](https://github.com/pmcelhaney/raphael/tree/pure-amd-2)和[Eve](https://github.com/DmitryBaranovskiy/eve)。你可以从

*   夏娃[http://jamjs.org/packages/#/details/eve](http://jamjs.org/packages/#/details/eve)
*   拉斐尔[http://jamjs.org/packages/#/details/raphael-amd](http://jamjs.org/packages/#/details/raphael-amd)

# saml - SAML 工件的用途是什么？

> ID：13616169
> 
> 赞同：40
> 
> 时间：2012-11-28T23:19:25.950
> 
> 标签：saml, saml-2.0, opensaml

我看过一堆关于它如何通过重定向在身份提供者 (IdP)、服务提供者 (SP) 和浏览器之间传递的流程图。但是现在对我来说似乎没有必要，所以我知道我错过了一些东西。

与不使用 SAML 工件相比，有人可以为我提供一个需要（或非常有用）的 SAML 工件的用例吗？

谢谢你。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-11-29T03:52:37.557

通常，工件绑定的目的是减少通过浏览器本身的 SAML 消息流。这可能是由于浏览器限制（对查询字符串/POST 有效负载大小有限制的浏览器）或不支持 JavaScript（对于自动提交的表单），甚至是为了改进 SAML 消息传输方式的安全模型。通过使用工件，通过 SAML 断言/属性语句携带的敏感数据不会通过浏览器传递，因此可以在您的站点和最终用户之间隐藏最终用户或攻击者。这些机密数据只能通过反向通道查找在站点之间直接解析。

[SAML 2.0 绑定规范](http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf)的第 3.6.2 节对其进行了最好的总结：

> HTTP Artifact 绑定适用于 SAML 请求者和响应者需要使用 HTTP 用户代理作为中介进行通信的情况，但中介的限制会阻止或阻止通过它传输整个消息（或消息交换）。这可能是出于技术原因，也可能是因为不愿将消息内容暴露给中介（如果使用加密不实用）。请注意，由于需要随后使用另一个同步绑定（例如 SOAP）解析工件，因此 SAML 消息发送方和接收方之间必须存在与工件传输相反的直接通信路径（消息的接收方和工件必须能够将请求发送回工件颁发者）。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-07-03T15:19:17.397

扩展 Scott T 的回答，SAML Artifact Profile 旨在提高安全性。为了防止用户在流量中修改其 SAML 断言（例如更改用户名、角色等），SAML 2.0 建议开发人员通过 XML 签名对断言进行签名。但是，由于现有 XML 解析器中每种语言的问题，XML 签名极易受到 XML 包装攻击。访问[https://www.usenix.org/conference/usenixsecurity12/break-saml-be-whoever-you-want-be](https://www.usenix.org/conference/usenixsecurity12/breaking-saml-be-whoever-you-want-be)查看针对 SAML 断言的 XML 包装攻击。

SAML 工件配置文件通过创建一次性使用“工件”来解决此问题，该“工件”由用户（通过重定向或邮寄）而不是 SAML 断言传递给服务提供者。当服务提供者收到一次性使用工件时，它会向身份提供者的工件解析服务 (ARS) 发送一个 SAML 工件解析请求（包含工件）。然后，ARS 以 SAML Artifact Response（包含用户的 SAML 断言）进行响应，从而防止用户修改 SAML 断言，因为它是由服务提供者通过反向通道直接接收的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-29T00:52:13.940

SAML 消息通过值或引用从一个实体传输到另一个实体。对 SAML 消息的**引用**称为**工件**。工件的接收者通过直接向工件的发布者发送请求来解析引用，然后发送者使用工件引用的实际消息进行响应。

参考[SAML 2.0](http://en.wikipedia.org/wiki/SAML_2.0) ,

没有工件，就无法获得实际消息。

请注意，这仅在使用 HTTP 工件绑定时才需要。（与简单发送 SAML 消息的更常见的 HTTP POST 绑定相反）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-09T13:29:11.597

使用 HTTP Artifact 绑定的另一个原因是您可以使用 SSL 来确保 SAML 消息的完整性和机密性。SAML 请求者和响应者不需要对 SAML 消息进行签名、验证、加密和解密。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-22T14:54:12.550

现在它可能被认为是不感兴趣的，但是如果您在用户代理和 sp & idp 服务器之间的带宽较低并且 sp & idp 之间的带宽更好，那么工件配置文件也很有用。（重）断言不会从 idp 到 ua 和从 ua 到 sp 循环，并且在某些情况下它可能会表现出更好的性能。

# notepad++ - notepad++ 中自定义语言的可折叠块

> ID：13616170
> 
> 赞同：1
> 
> 时间：2012-11-28T23:19:34.857
> 
> 标签：notepad++

我正在尝试为记事本++ 创建一个自定义荧光笔。我知道如何做大部分事情，但我不知道如何设置像循环这样的代码块，以便它们可以折叠。这可能吗？

编辑：进一步调查，我认为它可能是文件夹打开/关闭。这个对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-04T13:43:50.540

正确的。在**User-Defined**窗口中，转到选项卡**Folder&Default**，那里有三个部分，例如：

*   **打开**是可折叠部分的开始。

*   **Middle**对于 IF - **ELSE** - ENDIF 等情况很有用。

*   **关闭**是关闭可折叠部分。

三个部分之一用于评论，另外两个用于您的主要语言结构。

# c# - 如何将 2 个可枚举集合转移到 1 个 ObservableCollectionsList？

> ID：13616175
> 
> 赞同：0
> 
> 时间：2012-11-28T23:20:08.033
> 
> 标签：c#

这是一个完整的新手问题，我理解，但是如何将这两个不同的 Enumerable 集合转移到单个 ObservableCollections？

```
 var distinctLine1 = (from z in list
                            orderby z.ItemLine1
                            select z.ItemLine1).Distinct();
        var distinctLine2 = (from z in list
                            orderby z.ItemLine2
                            select z.ItemLine2).Distinct();
        foreach (var item in distinctLine1)
        {

        } 
```

抱歉确实将 ObservableCollectionsList 更改为 ObservableCollections

ItemLine1 和 ItemLine2 都是字符串

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:47:21.087

我想你也可以呼吁`Distinct`联合排除可能的重复。

```
var union = distinctLine1.Union(distinctLine2).Distinct(); 
```

要不就

```
var union = distinctLine1.Union(distinctLine2); 
```

然后只需使用[ObservableCollection Constructor (IEnumerable)](http://msdn.microsoft.com/en-us/library/cc679169.aspx)创建目标集合：

```
var result = new ObservableCollection<string>(union); 
```

# sql-server-2005 - 统计数据对表有什么影响

> ID：13616178
> 
> 赞同：0
> 
> 时间：2012-11-28T23:20:36.613
> 
> 标签：sql-server-2005, database-performance, database-tuning

当我向表中添加索引时，搜索有明显的好处，但是由于需要更新索引，因此插入/更新/删除语句也会产生成本。

如果我在表上创建一个新的统计数据，它会产生与索引类似的成本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T04:39:17.527

无论使用什么统计信息来查找查询数据，都将检查它们是否是最新的。如果它们不是最新的（基于随机样本），那么 SQL 将更新它们。如果它们不是最新的，那么您的查询在等待统计信息更新时将受到性能影响。

根据我的发现，统计信息可以设置为异步自动更新统计信息。这将导致它对当前查询使用旧的统计信息，但告诉 SQL 下次在后台更新统计信息。如果大量数据已更改，这可能会使当前查询性能不佳。

主要来源：[MSDN](http://msdn.microsoft.com/en-us/library/ms190397%28v=sql.90%29.aspx)

# ios6 - 如何使用 iOS 的 gcovr 生成 Cobertura 格式的 xml 文件？

> ID：13616179
> 
> 赞同：5
> 
> 时间：2012-11-28T23:20:36.520
> 
> 标签：ios6, code-coverage

我正在使用 Apple LLVM Compiler 4.1 在 Xcode 4.5 上运行的 iOS 项目上生成代码覆盖率数据文件（.gdca 和 .gcno）。

正在 Library/Developer/Xcode/DerivedData/viewer-evgaabclrjcouydwveuptwroeofm/Build/Intermediates/viewer.build/Coverage-iphonesimulator/viewer_generic/viewer_generic.build/Objects-normal/i386 下生成文件。

所有（.o、.d、.dia、.gcda、.gdno）文件都在这个目录下。没有子文件夹。

我可以使用封面故事打开单个 .gcda 文件。现在我想生成一个可以使用 cobertura 查看的报告。

我正在尝试为此使用 gcovr。在终端上我到了上面的文件夹

```
Command: gcovr -r `pwd` -x -v

Output:
(Several lines of similar output as below)
Running gcov: 'gcov /Users/abc/Library/Developer/Xcode/DerivedData/viewer-evgaabclrjcouydwveuptwroeofm/Build/Intermediates/viewer.build/Coverage-iphonesimulator/viewer_generic/viewer_generic.build/Objects-normal/i386/FILE_NAME.gcda --branch-counts --branch-probabilities --preserve-paths --object-directory /Users/abc/Library/Developer/Xcode/DerivedData/viewer-evgaabclrjcouydwveuptwroeofm/Build/Intermediates/viewer.build/Coverage-iphonesimulator/viewer_generic/viewer_generic.build/Objects-normal/i386' in '/Users/abc/Library/Developer/Xcode/DerivedData/viewer-evgaabclrjcouydwveuptwroeofm/Build/Intermediates/viewer.build/Coverage-iphonesimulator/viewer_generic/viewer_generic.build/Objects-normal/i386'
    Parsing coverage data for file /Users/abc/Documents/Perforce/DPS-MacBookPro/depot/sandbox/Viewer-Labatt/Blue/viewers/ipadviewer/iphone/apps/viewer/Classes/view/zooming/FILE_NAME.mm
    Filtering coverage data for file /Users/abc/Documents/Perforce/DPS-MacBookPro/depot/sandbox/Viewer-Labatt/Blue/viewers/ipadviewer/iphone/apps/viewer/Classes/view/zooming/FILE_NAME.mm
    Gathered coveraged data for 0 files
    <?xml version="1.0" ?>
    <!DOCTYPE coverage
      SYSTEM 'http://cobertura.sourceforge.net/xml/coverage-03.dtd'>
    <coverage branch-rate="0.0" line-rate="0.0" timestamp="1354144430" version="gcovr 2.4 (r2774)">
        <sources>
            <source>
                /Users/abc/Library/Developer/Xcode/DerivedData/viewer-evgaabclrjcouydwveuptwroeofm/Build/Intermediates/viewer.build/Coverage-iphonesimulator/viewer_generic/viewer_generic.build/Objects-normal/i386
            </source>
        </sources>
        <packages/>
    </coverage> 
```

我看到一个警告：gcno:version '404', prefer '402'

请帮我弄清楚为什么 gcovr 无法生成报告。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T17:58:30.333

**Tl;dr：LLVM 输出的代码覆盖率文件比 gcovr 预期的要新。如果您将 gcovr 版本替换为链接版本（2.4 版），那么它应该可以工作。也许。**

早在 LLVM 之前，Xcode 使用 GCC 作为其编译器。GCC 包含一个名为“gcov”的工具，它生成所有这些文件，.gcno、.gcda 及其类似文件。

那时，Mac 预装了（现在仍然这样）GCC 4.2 版。所以 Xcode 会用 gcc 4.2 编译你的项目，然后运行 ​​gcov 4.2 版本，这将生成 4.2 版本的测试覆盖文件。这适用于 gcovr，因为 2.0 之前的 alpha 版本似乎是在考虑 gcov 4.2 的情况下编写的。

但是当 Apple 转向 LLVM 时，事情就变得很奇怪。如果您在目标设置中设置了“生成测试覆盖率文件”标志，LLVM 还会输出 gcov 样式的测试覆盖率文件。但是，LLVM 默认输出 gcov 4.4 文件，而不是 4.2。

[这个人](https://stackoverflow.com/questions/10883412/how-to-change-the-gcno-version-compiled-by-xcode4-3s-apple-llvm-compiler)的想法是，如果我们可以告诉 LLVM 输出 4.2 版本的文件（我认为它在技术上可以做到），那么它就会解决问题。这可能是真的，但我不知道该怎么做。

但是，我确实为自己找到了解决方案。我打开终端，检查我的 gcovr 版本：

```
gcovr --version 
```

它告诉我我的 gcovr 版本实际上是 gcovr 2.0-prerelease。**此版本不支持测试覆盖文件的 gcov 4.4 版本。**

所以我找到了一个版本。

这是托管它的页面：[https ://software.sandia.gov/trac/fast/wiki/gcovr](https://software.sandia.gov/trac/fast/wiki/gcovr)

这是脚本本身的链接：[https ://software.sandia.gov/trac/fast/export/2800/gcovr/trunk/scripts/gcovr](https://software.sandia.gov/trac/fast/export/2800/gcovr/trunk/scripts/gcovr)

这个脚本是gcovr 2.4，最高支持gcc 4.8。从理论上讲，它应该对 LLVM 输出的 4.4 版本的测试覆盖率文件感到非常满意。这个警告现在对我来说完全消失了。试一试，告诉我进展如何！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-09T15:37:05.183

您是否正确指定了对象目录路径？根据 gcovr 文档

> --object-directory=OBJDIR：指定包含 gcov 数据文件的目录。gcovr 必须能够识别 *.gcda 文件和 gcc 最初运行的目录之间的路径。通常，gcovr 可以正确猜测。此选项覆盖 gcovr 的正常路径检测，并且可以指定从 gcc 到 gcda 文件的路径（即传递给 gcc 的 '-o' 选项的路径），或从 gcda 文件到 gcc 原始工作目录的路径。

在项目的根目录下运行时，以下命令对我有用。

> gcovr -r。--object-directory path_to_coverage_files -x > coverage.xml

path_to_coverage_files 是所有（.o、.d、.dia、.gcda、.gdno）文件所在的目录。

# iphone - 根据图像加载确定细胞类型

> ID：13616180
> 
> 赞同：0
> 
> 时间：2012-11-28T23:20:38.337
> 
> 标签：iphone, objective-c, ios, ipad, uitableview

我有两种不同的 UITableViewCell 类型，比如 A 和 B。如果基于我拥有的图像 URL 数据源，则使用 A，如果图像未加载，则使用 B。我怎样才能做到这一点？问题是在 cellForRowAtIndexPath 我不知道图像是否加载。那么我可能必须先加载所有图像。还有其他方法吗？

我正在使用一个具有 imageURL 的 Story 对象。tableview 的数据源是 Story 的数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:45:01.607

```
NSURLRequest *request = [NSURL URLWithString:@"http://a.com/image.png"];

UIImageView *imageview = [[UIImageView alloc]init];
[imageview setImageWithURLRequest:request placeholderImage:[UIImage imageNamed:@"image.png" ] success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
    NSLog(@"Handle SUCCESS");
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
    NSLog(@"Handle FAILURE");    }]; 
```

# python - 我上课的循环？丢失

> ID：13616181
> 
> 赞同：-1
> 
> 时间：2012-11-28T23:20:40.560
> 
> 标签：python

> 模拟收银机，因为它汇总了用户的购买。该程序应该为单个用户执行未指定数量的项目。程序应提示用户每个项目的数量和单位成本。用户应通过输入负数来指示购买结束。程序应该在一行上输出数量、单位成本、项目总计（数量乘以单位成本）和当前小计到文件`purchases.txt`中。这些值应该用空格分隔。程序应将最终总数输出到文件和屏幕。

我已经很好地关闭了文件 I/O。我在课堂上遇到的麻烦是创建我的循环并在输入某些内容时让它们停止。

```
import os.path
outFile = open("purchases","w")
quantity = raw_input("What is the quantity of the item")
cost = raw_input("How much is each item")
outFile.write()
while quantity <= ???? : 
```

我理解数学，但循环只是让我失去了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:27:19.940

这是一个提示：

> 用户应通过输入负数来指示购买结束。

循环应该循环直到用户输入一个负数。

因此，您的循环将如下所示：

```
while quantity > 0: 
```

# php - php mysql 将日期类型从 YYYY-mm-dd 更新为 mm-dd-YYYY

> ID：13616182
> 
> 赞同：0
> 
> 时间：2012-11-28T23:20:48.900
> 
> 标签：php

我有一个名为 dDate 的 mysql 日期字段，其格式如下：YYY-MM-DD 我想将此字段中的所有记录更新为不同的日期格式 MM-DD-YYYY 有人可以告诉我如何做到这一点通过 mySQL 查询？

我试过这个例子，但它不起作用

```
UPDATE address_email SET dDate = DATE_FORMAT(dDate, '%m-%d-%Y') 
```

还有这个：

```
 UPDATE address_email SET dDate = DATE(dDate, '%m-%d-%Y') 
```

非常感谢帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:32:14.507

根据[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)，看起来 MySQL 仅以 'YYYY-MM-DD' 格式检索和显示 DATE 值，我认为您无法更改它。

您真正想要做的是在将日期从数据库中拉出时格式化日期，而不是更改表的 DATE 字段的默认格式。当您选择时，请执行以下操作：

```
SELECT DATE_FORMAT(dDate, '%m-%d-%Y') FROM address_email; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:25:21.783

查看有关 date_format 的 mysql 文档：http: [//dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-12-22T11:05:55.850

```
UPDATE vechical
SET PDate = DATE_FORMAT('12-08-2012','%d-%m-%y')
WHERE Cust_ID='21'; 
```

请为此更正查询

# c++ - 在 Windows 应用商店应用程序中映射 Direct3D11 中的动态缓冲区

> ID：13616194
> 
> 赞同：0
> 
> 时间：2012-11-28T23:22:01.050
> 
> 标签：c++, windows-runtime, direct3d11

我正在尝试在 Direct3D11 中创建实例化几何图形，`ID3D11DeviceContext1->Map()`当我尝试更新实例缓冲区时，调用失败并出现非常有用的“无效参数”错误。

缓冲区被声明为成员变量：

`Microsoft::WRL::ComPtr<ID3D11Buffer> m_instanceBuffer;`

然后我创建它（成功）：

```
D3D11_BUFFER_DESC instanceDesc;
ZeroMemory(&instanceDesc, sizeof(D3D11_BUFFER_DESC));
instanceDesc.Usage = D3D11_USAGE_DYNAMIC;
instanceDesc.ByteWidth = sizeof(InstanceData) * MAX_INSTANCE_COUNT;
instanceDesc.BindFlags = D3D11_BIND_VERTEX_BUFFER;
instanceDesc.CPUAccessFlags = D3D11_CPU_ACCESS_WRITE;
instanceDesc.MiscFlags = 0;
instanceDesc.StructureByteStride = 0;

DX::ThrowIfFailed(d3dDevice->CreateBuffer(&instanceDesc, NULL, &m_instanceBuffer)); 
```

但是，当我尝试映射它时：

```
D3D11_MAPPED_SUBRESOURCE inst;
DX::ThrowIfFailed(d3dContext->Map(m_instanceBuffer.Get(), 0, D3D11_MAP_WRITE, 0, &inst)); 
```

地图调用失败并显示`E_INVALIDARG`. 没有什么是`NULL`不正确的，这是我的第一个 D3D 应用程序之一，我目前不知道下一步该做什么来追踪它。我想我一定是错误地创建了缓冲区，但我不知道怎么做。任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T06:58:58.257

因为缓冲区是用 创建的`D3D11_USAGE_DYNAMIC`，所以它必须用`D3D_MAP_WRITE_DISCARD`（或`D3D_MAP_WRITE_NO_OVERWRITE`，但这不适合我的应用程序）进行映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:46:14.950

当我尝试为着色器创建缓冲区时，我遇到了同样的问题。在`createBuffer`它总是给我`E_INVALIDARG`。我项目的问题是，我忘记将所有属性对齐到 16 字节。这是一个例子：

```
struct TessellationBufferType
{
    float tessellationAmount; //4bytes
    D3DXVECTOR3 cameraPosition; //12bytes
}; 
```

如果你没有得到 16，添加一个额外的变量（例如填充）只是为了对齐到 16：

```
struct LightBufferType
{
    D3DXVECTOR4 ambientColor; //16
    D3DXVECTOR4 diffuseColor; //16
    D3DXVECTOR3 lightDirection; //12
    float padding; //4
}; 
```

# macos - 如何在 finder 中查看 User/Library/LaunchDaemons 文件夹？

> ID：13616195
> 
> 赞同：2
> 
> 时间：2012-11-28T23:22:01.643
> 
> 标签：macos

在查找器中，我可以查看用户/库的内容，并且可以在那里看到许多文件夹，但是我看不到名为 LaunchDaemons 的文件夹。

但是，如果我从终端命令行导航到 Library 文件夹，则 LaunchDaemons 是可见的。

如何让它出现在 Finder 中？

我试过这个命令，但没有任何效果

```
defaults write com.apple.Finder AppleShowAllFiles YES 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:50:56.417

用户库中没有（至少默认情况下）没有 LaunchDaemons 文件夹。您可能正在导航到终端中的其他库文件夹之一。您可以使用命令`pwd`（打印当前文件夹的完整路径 - 如果它不以 /Users/youraccountname/Library 开头，则您不在您的用户库中）和`open .`（打开当前文件夹Finder - 再说一次，我很确定它不会在您的用户库中）。

# node.js - 用于动态 Opengraph 标签的 Node.js 和 Parse.com

> ID：13616197
> 
> 赞同：0
> 
> 时间：2012-11-28T23:22:08.780
> 
> 标签：node.js, facebook-opengraph, parse-platform

我有一个 JS wep 应用程序和 Parse.com 后端，我想使用 Opengraph 操作连接到 Facebook。问题是作为一个网络应用程序，不可能以这样的方式操纵元标签，以便 Facebook 抓取工具使用它。

大多数解决方案都指向与您的 Web 应用程序一起运行的服务器端实现。阅读了一些关于 Node.js 的内容......我认为可能还有另一种方法，我想知道 Node.js 专家是否可以提供一些启示。

是否可以使用 Node.js 根据 URL 参数查询我的 Parse.com 数据库，以便提供正确的元标记？解决方案是否足够快？

就像是

```
- Request comes in - 'xxx.com/user/1234'
- Node queries Parse.com DB with user=1234
- Parse returns the information for meta tags
- Node serves up HTML page with the correct meta tags
- Web app runs as normal 
```

提前感谢您考虑这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T07:32:54.093

你绝对可以做到这一点。要使用 node.js 设置一个简单的网络服务器，您可以按照他们主页上的简单示例进行操作。

[http://nodejs.org/](http://nodejs.org/)

要从 node.js 与 Parse 通信，您可以使用 Parse JavaScript SDK，可通过 npm 获得。

[http://blog.parse.com/2012/10/11/the-javascript-sdk-in-node-js/](http://blog.parse.com/2012/10/11/the-javascript-sdk-in-node-js/)

[https://parse.com/docs/js_guide](https://parse.com/docs/js_guide)

# java - Java：main中的奇怪运行时行为

> ID：13616200
> 
> 赞同：2
> 
> 时间：2012-11-28T23:22:12.350
> 
> 标签：java, runtime, behavior

我在以下代码中遇到了（对我而言）奇怪的运行时行为：

```
public class Main{

    private final static long ROUNDS = 1000000;
    private final static double INITIAL_NUMBER = 0.45781929d;
    private final static double DIFFERENCE = 0.1250120303d;

    public static void main(String[] args){

        doSomething();
        doSomething();
        doSomething();
    }

    private static void doSomething(){

        long begin, end;
        double numberToConvert, difference;

        numberToConvert = INITIAL_NUMBER;
        difference = DIFFERENCE;

        begin = System.currentTimeMillis();

        for(long i=0; i<ROUNDS; i++){

            String s = "" + numberToConvert;

            if(i % 2 == 0){
                numberToConvert += difference;
            }
            else{
                numberToConvert -= difference;
            }
        }

        end = System.currentTimeMillis();

        System.out.println("String appending conversion took " + (end - begin) + "ms.");
    }
} 
```

我希望程序每次都能打印出类似的运行时。但是，我得到的输出总是这样的：

```
String appending conversion took 473ms.
String appending conversion took 362ms.
String appending conversion took 341ms. 
```

第一次调用比之后的调用慢约 30%。大多数时候，第二次调用也比第三次调用稍慢。

java/javac 版本：

```
javac 1.7.0_09 java version "1.7.0_09" OpenJDK Runtime Environment (IcedTea7 2.3.3) (7u9-2.3.3-0ubuntu1~12.04.1) OpenJDK 64-Bit Server VM (build 23.2-b09, mixed mode) 
```

**所以，我的问题是：为什么会发生这种情况？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T23:24:33.423

即时 (JIT) 编译器正在动态分析您的代码并优化执行。一段代码执行得越频繁，它的优化就越好。

例如，请参阅此问题以获取更多信息：（[如何）Java JIT 编译器优化我的代码？](https://stackoverflow.com/questions/8256202/how-does-the-java-jit-compiler-optimize-my-code)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:32:50.280

您正在运行的其他应用程序可能会影响您分配给机器上 JVM 的内存量。尝试在运行 java 命令时为 JVM 设置相同的最小和最大内存：

```
java -Xms512M -Xmx512M ... 
```

尝试运行它时，我得到了相当一致的间隔：

```
String appending conversion took 1153ms.
String appending conversion took 1095ms.
String appending conversion took 1081ms. 
```

# ios - 将对象从 plist 文件复制到另一个 plist 文件

> ID：13616206
> 
> 赞同：1
> 
> 时间：2012-11-28T23:22:28.973
> 
> 标签：ios, plist

所以在我的最后一个问题中，我试图弄清楚我应该使用什么，Plist 或 Core data 或 sqlight，我决定我会尝试所有这些来提高我的技能。因此，我开始阅读有关 plist 及其工作方式的信息，但我不太确定一些事情。我正在编写的应用程序目的是为用户提供一些来自 plist 文件的不同流派的不同歌曲列表，如下所示：

![图片](../Images/841ca2e9519fdac34dc9fce6d4c95a40.png)

用户可以选择他喜欢的歌曲，并将这些歌曲添加到新列表中。我可以复制歌曲（在我的情况下是一个 plist 文件中的简单字典）并从中创建一个新的 plist。或者我应该使用堆栈或数组将歌曲推入并使用表格视图作为出口？最终，我希望用户保存他创建的播放列表。

我很想知道我建议的东西是否行不通，以及这样做的更优雅的方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:26:31.283

试试这样

```
NSString *plistFileName = [[self documentPath] stringByAppendingPathComponent: @"Original.plist"];

if ([[NSFileManager defaultManager] fileExistsAtPath:plistFileName]) {
    NSDictionary *dict = [[NSDictionary alloc] initWithContentsOfFile:plistFileName];
} 
```

在表格视图中显示此数据并要求用户选择歌曲。将选定的另一个字典保存为，

```
 NSDictionary *savedPlayListDict = //saved songs

    NSString *fileName = [[self documentPath] stringByAppendingPathComponent: @"SavedList.plist"];
    [savedPlayListDict writeToFile: fileName atomically:YES]; 
```

或者您可以创建自己的模型类以将键值对保存在字典中，并使用它来表示表的每一行。

例如：-`Song`可以是一个模型对象，其属性为`UIImage *pic`、`NSInteger number`和`NSString *name`。您可以将这些 Song 对象添加到一个数组中，并使用该数组填充您的表格视图。用户选择列表后，您可以将保存的列表转换为字典并保存到 plist，如上所示。

这些只是几个选项。你可以通过很多不同的方式来做到这一点。

# c++ - 使用 c++ 套接字 - 使用 accept() 和文件描述符时出现严重错误

> ID：13616207
> 
> 赞同：0
> 
> 时间：2012-11-28T23:22:31.163
> 
> 标签：c++, sockets, client-server

我已经使用该网站一段时间了，（本学期之后）期待回馈！但是，我最后一次希望您的帮助，并且似乎没有其他答案可以提供任何帮助。

背景：使用 C++、套接字和客户端/服务器架构设计一个基本的聊天室，最多有十个客户端与服务器交谈。一个客户端所说的任何内容都会在所有客户端和服务器之间回显（发送客户端除外）。

问题：错误发生在 recv 调用中，作为 clientTalk 函数中的 while 循环条件。我得到一个“接收失败：错误的文件描述符”，但服务器和客户端都没有完全“崩溃”，并且没有发生明显的行为变化，尽管接收完全被炸毁了。

尝试解决：

*   谷歌和 SOf。持续2个小时...

*   移动变量，玩弄套接字设置和打开/关闭

-瓦尔格林：

```
==773== Warning: invalid file descriptor 96600128 in syscall read()

Recieve failed: Bad file descriptor
==773== Thread 2:
==773== Conditional jump or move depends on uninitialised value(s)
==773==    at 0x4015A0: ??? (in /nethome/users/ghm455/CS284/ChatServer/server)
==773==    by 0x4E39E99: start_thread (pthread_create.c:308)
==773==    by 0x5442CBC: clone (clone.S:112)
==773==
==773== Conditional jump or move depends on uninitialised value(s)
==773==    at 0x401614: ??? (in /nethome/users/ghm455/CS284/ChatServer/server)
==773==    by 0x4E39E99: start_thread (pthread_create.c:308)
==773==    by 0x5442CBC: clone (clone.S:112)
==773==
==773== Warning: invalid file descriptor 96600128 in syscall close() 
```

第一个警告出现在我的接受声明中。接收失败发生在 recv 并且最后一个警告发生在尝试关闭时。这是由散布在整个代码中的 cout 语句决定的。

代码：下面。如果您认为错误存在，我会发布客户端，但一切都表明这是服务器端问题。

```
`#define SERVER_PORT 9999        /* define a server port number */

using std::cout;
using std::endl;
using std::string;

//Globals - descriptorArray holds client FDs.  arraySize is its size.
//soc holds the information on the server's socket.
//m is the global mutex shared among the server and all clients
const int MAX_CLIENT = 10;
int descriptorArray[MAX_CLIENT];
int arraySize = 0;
int soc;
pthread_mutex_t m;

struct thread_info
{
pthread_t threadID; //Stores the ID number returned by pthread_create
int threadNumber;   //We have to number incoming threads correctly
char *messageSent;  //Message taken in from command line
};

int main()
{
void exitHandler(int sig); // Function that handles the control-C
void* clientTalk(void *arg); // Reads and writes with clients
struct sockaddr_in server_addr, client_addr;
int option = 1;
unsigned int clientCount;
uint8_t *new_socket;

//Initialize the socket
soc = socket(AF_INET, SOCK_STREAM, 0);
if (soc < 0)
{
    cout << "ERROR : problem opening socket" <<endl;
    return 1;
}

//Create socket structure
bzero((char *) &server_addr, sizeof(server_addr));
server_addr.sin_family = AF_INET;
server_addr.sin_addr.s_addr = INADDR_ANY;
server_addr.sin_port = htons(SERVER_PORT);

//Binding host address
if (bind(soc, (struct sockaddr *) &server_addr, sizeof(server_addr)) < 0)
{
    cout << "ERROR : problem occured while binding" <<endl;
    close(soc);
    exit(1);
}
if(setsockopt(soc, SOL_SOCKET, SO_REUSEADDR, (char*) &option, sizeof(option)) < 0)
{
    printf("setsockopt failed\n");
    close(soc);
    exit(1);
} 

signal(SIGINT, exitHandler);
listen(soc, MAX_CLIENT);

clientCount = sizeof(struct sockaddr_in);
int clientID;
//cout << "Z " <<endl;
while(clientID = accept(soc, (struct sockaddr *) &client_addr, (socklen_t*)&clientCount))
{
    //printf( "A");
    if (clientID < 0 )  
    {   
        perror("ERROR ON ACCEPT");
        exit(1);
    }
    else
    {
        pthread_t newClient;
        new_socket = (uint8_t*)malloc(1);
        *new_socket = clientID;
        pthread_mutex_lock(&m);
        if (arraySize < 10)
        {
            descriptorArray[arraySize++] = newClient;
        }
        else
        {
            cout << "There are already 10 clients connected!" << endl;
        }
        pthread_mutex_unlock(&m);
        if( pthread_create(&newClient, NULL, clientTalk, &new_socket) < 0)
        {
            perror("ERROR Creating thread");
            return 1;
        }
        cout << "Assigned!" <<endl;
        pthread_join(newClient, NULL);
    }
}
close(soc);
return 0;
}

void exitHandler(int sig)
{
sig = sig + 0; //Removing the warning. A clean compile looks a lot nicer.
for (int i = 0; i < arraySize; i++)
{
    write(descriptorArray[i], "WARNING: Server exiting in ten seconds. End your conversation!", 1000);
}
cout << "WARNING: Server exiting in ten seconds.  ";
cout << "End your conversation!" << endl;
sleep(10f); 
for (int i = 0; i < arraySize; i++)
{
    close(descriptorArray[i]);
}
close(soc);
exit(1);
}

void* clientTalk(void* arg)
{
int* myFD = (int*) arg;
char buffer[2000];
read(*myFD, buffer, 20);
char username[20];
//strcpy(username, buffer); // Takes in the username and stores it
char movableString[2000];
int amount_read;

// for (int i = 0; i < arraySize; i++)
// {
    //strcpy(movableString, username);
//  strcat(movableString, " has joined the room!");
    //if (descriptorArray[0] != *myFD)
    //{
    //  write(descriptorArray[0], movableString, 2000);
    //}
//}
cout << "x" << endl;
int arrayLocation;  
while ( (amount_read = recv(*myFD, buffer, 2000, MSG_WAITALL)) > 0)
{
    cout << " Um" << endl;
    pthread_mutex_lock(&m);
    for (int i = 0; i < arraySize; i++)
    {
        if (descriptorArray[i] == *myFD)
        {
            arrayLocation = i;
            break;
        }
    }
    strcpy(movableString, username);
    strcat(movableString, ": ");
    strcat(movableString, buffer);
    for (int i = 0; i < arraySize; i++)
    {
        //if (i != arrayLocation)
        //{
            write(*myFD, movableString, 2000); 
        //}
    }
    pthread_mutex_unlock(&m);
}
if (amount_read == 0)
{
    cout << username << "disconnected unexpectedly" <<endl;
    fflush(stdout);
}
if (amount_read == -1)
{
    perror("Recieve failed");
}

pthread_mutex_lock(&m);
for (int i = 0; i < arraySize; i++)
{
    if (descriptorArray[i] == *myFD)
    {
        arrayLocation = i;
        break;
    }
}

for (int i = arrayLocation; i < arraySize - 1; i++)
{
    descriptorArray[i] = descriptorArray[i + 1];
}
arraySize--;

pthread_mutex_unlock(&m);
close(*myFD);
pthread_exit(NULL);
free(arg);
} 
```

`

我将监视该站点以回答您可能遇到的任何问题。对于在提问时犯了任何新手错误，我提前道歉。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:05:40.710

该错误表示传递给 read 函数的文件描述符不是有效的文件描述符，因此调试时首先要确保 ClientTalk 函数中的文件描述符的值与 main 中的相同。

@JN 就在评论中。它们不会相同，因为 FD 是一个 int 并且您只是将第一个字节传递给函数（并将其转换为 int* 指针。）

您可能想用 C 编写这个程序，因为它看起来不像 C++ 代码。

1.  将 ClientID 和 new_socket 更改为 int / int*。使用一致的类型，并使用函数定义中的类型 accept 返回一个 int ，因此对所有内容都使用 int / int* 。
2.  调用 malloc 时，尽可能使用 sizeof 而不是字节数。

可能还有其他问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:24:33.113

这里至少有两个问题。首先，您永远不会调用`pthread_mutex_init`，因此您的互斥锁从未被创建为正常状态（尽管如果它在全局范围内它将被归零）。

其次，您将`&new_socket`作为传递`void*`给您的线程。这是类型`uint8_t**`，而在您的`clientTalk`函数内部，您 C 样式强制转换`int*`为完全不同的指针类型，并且肯定不会提供您想要的结果。

# javascript - 根据字符错误修复字符串

> ID：13616208
> 
> 赞同：0
> 
> 时间：2012-11-28T23:22:36.540
> 
> 标签：javascript, jquery, html

我有要在 HTML 中显示的文本，例如： `var htmlStr = "1.first thing %10-15%. 2.second thing %25-44%. 3.third`"

我在 div 中显示它：

```
 $('#div1').html(htmlStr); 
```

但是当我在手机上显示它时，`DIV1`我`HTML5`得到了下一件事：

```
1.first thing %10-15.2%.second thing %25-44.3%.third 
```

**（错误是：15% - 15.2%）**

它发生在`iOS`系统中，我如何`JavaScrip/jQuery`根据这个规则使用修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:13:31.617

尝试使用`&#37;`而不是`%`.

# git - 在单个存储库中使用许多自治插件文件夹构建 git 和工作流

> ID：13616211
> 
> 赞同：1
> 
> 时间：2012-11-28T23:22:49.860
> 
> 标签：git, github, workflow

我意识到这是一个非常模糊的问题，但我的团队很难想出一个好的计划来解决我们的问题。无论如何，我们都不是 git 或工作流专家，过去我们已经遇到过这方面的问题。

具体来说，我们有这种情况：

插件代码位于同一个私有存储库的不同文件夹中（出于各种原因，我们不希望每个项目都有单独的存储库。）

所以存储库结构如下所示：

*   <REPO>/Plugin001/pom.xml
*   <REPO>/Plugin001/src/main/java/...
*   <REPO>/Plugin002/pom.xml
*   <REPO>/Plugin002/src/main/java/...
*   ...
*   <REPO>/Plugin050/...
    ...

通常需要客户特定的补丁或增强功能，此外，我们通常必须支持给定客户的特定插件版本。

也就是说，我们需要一个有组织的结构和工作流程，它允许以下内容：

*   能够顺利地在单个插件上工作，而不会与人们对其他插件的提交发生冲突（例如，不需要在单独的插件中拉取更改以将更改推送到当前插件。）理想情况下，这将更加严格，以便 PluginA 的开发人员*不能*破坏 PluginB 中的任何内容。
    *   **最佳方法猜测：** ???
*   能够使用客户特定的代码修补基本/核心插件代码；
    *   **最佳方法猜测：**为每个客户创建一个新分支并从那里开始工作。
*   能够轻松获取最新的客户特定插件并对其进行修补（使用上游或其他方式）；
    *   **最佳方法猜测：**检查客户分支并将其与 master 的发布标签合并。标签必须非常容易识别，例如 $plugin_name.$build_number
*   通过将二进制文件发布到中心位置（例如 Box）来自动发布构建的方式。
    *   **最佳方法猜测：**以某种方式通过 post-commit 钩子实现这一点。
*   构建应自动增加其构建编号。我猜这对于 Maven 大师来说是一个单独的问题，但只是把它扔在那里。
    *   **最佳方法猜测：** ???

我一直在研究子模块、gitslaves、标签、分支等，试图提出解决所有这些问题的结构和开发过程的建议。

请记住，这些开发人员中没有一个对 git 或版本控制非常有经验，而且我们没有系统管理员来处理此类工作……所以越简单越好。

对以上任何一个有意见吗？我想最重要的项目是第一个子弹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:32:49.563

首先：如果插件是真正独立的项目（从某种意义上说，它们是独立版本、分支和发布的），那么您*真的*希望将它们放入单独的存储库中。例如，分支始终是每个 repo 的。

如果您觉得必须使用单个 repo：

> 能够在单个插件上顺利工作，而不会与人们对其他插件的提交发生冲突（例如，不需要在单独的插件中拉取更改以将更改推送到当前插件。）理想情况下，这将更加严格，这样 PluginA 的开发人员不能破坏 PluginB 中的任何内容。

我不认为会有问题。是的，你需要在推送之前拉取（这就是使用一个 repo 的结果），但是提交到其他项目不会引起冲突，所以没有害处。

> 能够使用客户特定的代码修补基本/核心插件代码；最佳方法猜测：为每个客户创建一个新分支并从那里开始工作。

是的，这里没有变化。只有分支将适用于所有项目的轻微烦恼；但是您可以对分支采用一些命名约定。

> 能够轻松获取最新的客户特定插件并对其进行修补（使用上游或其他方式）；最佳方法猜测：检查客户分支并将其与 master 的发布标签合并。标签必须非常容易识别，例如 $plugin_name.$build_number

是的。

> 通过将二进制文件发布到中心位置（例如 Box）来自动发布构建的方式。最佳方法猜测：以某种方式通过 post-commit 钩子实现这一点。

“最佳”取决于许多因素，但您很可能需要一个[CI](http://en.wikipedia.org/wiki/Continuous_integration)服务器，即构建守护程序。提交后挂钩也应该可以工作，但是您将需要相当多的基础设施来运行构建、存储日志等。如果您可以使用 CI 服务器，您真的不想自己这样做。

> 构建应自动增加其构建编号。我猜这对于 Maven 大师来说是一个单独的问题，但只是把它扔在那里。

这确实是一个单独的问题。问它作为一个。

# mysql - 如何找到另一个表中不存在的东西？

> ID：13616212
> 
> 赞同：2
> 
> 时间：2012-11-28T23:22:50.487
> 
> 标签：mysql, sql, database, phpmyadmin, primary-key

我在这里迫切需要一些帮助。

我的问题是：我的数据库中有两个表，`tblSubmission`并且`tblStudent`. 由键`tblStudent`链接。中的某些行已被删除，因此与它们在 中的行取消链接。`tblSubmission``student_id``tblStudent``tblSubmission`

我需要做的是比较这两个表，并找到`student_id`存在于`tblSubmission`中但不存在于 中的 ' `tblStudent`，但结果`tblSubmission`必须有一个`app_id`等于 358 的列。

手动检查这些行不是一种选择，因为它们有数千个。我已经尝试了很多查询，使用我知道的最多的 SQL 和诸如 NOT EXISTS 和 NOT IN 之类的子句，但无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:24:29.077

这将显示 tblSubmission 中所有在 tblStudent 中没有相关记录的记录：

```
SELECT tblSubmission.*
FROM tblSubmission left join tblStudent on tblSubmission.student_id = tblStudent.student_id
WHERE tblStudent.student_id is null
      AND app_id = 358 
```

或者也：

```
SELECT tblSubmission.*
FROM tblSubmission
WHERE student_id not in (select student_id from tblStudent)
      AND app_id = 358 
```

# python - Tkinter 标签更新问题

> ID：13616216
> 
> 赞同：3
> 
> 时间：2012-11-28T23:23:12.627
> 
> 标签：python, string, tkinter, label, tk

[Python 2.7] 你好。我正在开发一个简单的 Tkinter 计算器程序，但在按下其中一个按钮后似乎无法让标签显示任何文本。这是我正在使用的代码，一些按钮功能尚未完成，直到我可以让标签本身工作：

```
 from Tkinter import *
    import ttk
    """Calculator"""
    #Variables
    Entered = ""

    #Button Functions
    def Natural_Log():
        pass
    def Exp():
        Entered = "^"
    def Sin():
        pass
    def Cos():
        pass
    def Tan():
        pass
    def LeftParentheses():
        Entered = Entered + "("
    def RightParentheses():
        Entered = Entered + ")"
    def Log():
        pass
    def XSquared():
        Entered = Entered + "**2"
    def InvX():
        Entered = Entered + "**-1"
    def Seven():
        Entered = Entered + "7"
    def Eight():
        Entered = Entered + "8"
    def Nine():
        Entered = Entered + "9"
    def DEL():
        Entered = Entered[:1]
    def AC():
        Entered = ""
    def Four():
        Entered = Entered + "4"
    def Five():
        Entered = Entered + "5"
    def Six():
        Entered = Entered + "6"
    def Mult():
        Entered = Entered + "*"
    def Div():
        Entered = Entered + "/"
    def One():
        Entered = Entered + "1"
    def Two():
        Entered = Entered + "2"
    def Three():
        Entered = Entered + "3"
    def Plus():
        Entered = Entered + "+"
    def Minus():
        Entered = Entered + "-"
    def Zero():
        Entered = Entered + "0"
    def Decimal():
        Entered = Entered + "."
    def Ex():
        pass
    def neg():
        pass
    def EXE():
        pass

    #Main Window Setup:
    #Root setup
    root = Tk()
    root.title("Generic Calculator")

    #Parent frame setup
    mainframe = ttk.Frame(root,padding="8")
    mainframe.grid(column=0,row=0,sticky=(N,S,E,W))
    mainframe.columnconfigure(0,weight=1)
    mainframe.rowconfigure(0,weight=1)

    #Button setup
    ttk.Button(mainframe,text="ln",command=Natural_Log).grid(column=1,row=2,sticky=W)
    ttk.Button(mainframe,text="^",command=Exp).grid(column=2,row=2,sticky=W)
    ttk.Button(mainframe,text="sin",command=Sin).grid(column=3,row=2,sticky=W)
    ttk.Button(mainframe,text="cos",command=Cos).grid(column=4,row=2,sticky=W)
    ttk.Button(mainframe,text="tan",command=Tan).grid(column=5,row=2,sticky=W)
    ttk.Button(mainframe,text="(",command=LeftParentheses).grid(column=1,row=3,sticky=W)
    ttk.Button(mainframe,text=")",command=RightParentheses).grid(column=2,row=3,sticky=W)
    ttk.Button(mainframe,text="log",command=Log).grid(column=3,row=3,sticky=W)
    ttk.Button(mainframe,text="x^2",command=XSquared).grid(column=4,row=3,sticky=W)
    ttk.Button(mainframe,text="x^-1",command=InvX).grid(column=5,row=3,sticky=W)
    ttk.Button(mainframe,text="7",command=Seven).grid(column=1,row=4,sticky=W)
    ttk.Button(mainframe,text="8",command=Eight).grid(column=2,row=4,sticky=W)
    ttk.Button(mainframe,text="9",command=Nine).grid(column=3,row=4,sticky=W)
    ttk.Button(mainframe,text="DEL",command=DEL).grid(column=4,row=4,sticky=W)
    ttk.Button(mainframe,text="AC",command=AC).grid(column=5,row=4,sticky=W)
    ttk.Button(mainframe,text="4",command=Four).grid(column=1,row=5,sticky=W)
    ttk.Button(mainframe,text="5",command=Five).grid(column=2,row=5,sticky=W)
    ttk.Button(mainframe,text="6",command=Six).grid(column=3,row=5,sticky=W)
    ttk.Button(mainframe,text="*",command=Mult).grid(column=4,row=5,sticky=W)
    ttk.Button(mainframe,text="/",command=Div).grid(column=5,row=5,sticky=W)
    ttk.Button(mainframe,text="1",command=One).grid(column=1,row=6,sticky=W)
    ttk.Button(mainframe,text="2",command=Two).grid(column=2,row=6,sticky=W)
    ttk.Button(mainframe,text="3",command=Three).grid(column=3,row=6,sticky=W)
    ttk.Button(mainframe,text="+",command=Plus).grid(column=4,row=6,sticky=W)
    ttk.Button(mainframe,text="-",command=Minus).grid(column=5,row=6,sticky=W)
    ttk.Button(mainframe,text="0",command=Zero).grid(column=1,row=7,sticky=W)
    ttk.Button(mainframe,text=".",command=Decimal).grid(column=2,row=7,sticky=W)
    ttk.Button(mainframe,text="EXP",command=Ex).grid(column=3,row=7,sticky=W)
    ttk.Button(mainframe,text="(-)",command=neg).grid(column=4,row=7,sticky=W)
    ttk.Button(mainframe,text="EXE",command=EXE).grid(column=5,row=7,sticky=W)

    #Label Setup:
    EnteredSetup = StringVar()
    ttk.Label(mainframe,textvariable=EnteredSetup).grid(column=1,row=1,columnspan=5)
    EnteredSetup.set(Entered)

    root.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:02:27.980

我相信对 StringVar 的工作方式存在误解。线

```
EnteredSetup.set(Entered) 
```

不会在 EnteredSetup 和 Entered 之间创建某种形式的链接，修改 Entered 不会在 EnteredSetup 中发布更新。你的代码也可以改进很多，你应该发布一些足够长的东西来描述问题。就是说，考虑这个简化的版本已经修复（注意它可能要小得多）：

```
from Tkinter import Tk, StringVar
import ttk

class Calculator:
    def __init__(self, state):
        self.state = state

    def ac(self):
        self.state.set('')

    def state_num(self, num):
        self.state.set('%s%d' % (self.state.get(), num))

#Main Window Setup:
#Root setup
root = Tk()
root.title("Generic Calculator")

EnteredSetup = StringVar('')
calc = Calculator(EnteredSetup)

#Parent frame setup
mainframe = ttk.Frame(root, padding="8")
mainframe.grid(column=0, row=0)
mainframe.columnconfigure(0, weight=1)
mainframe.rowconfigure(0, weight=1)

#Button setup
ttk.Button(mainframe, text="AC", command=calc.ac).grid(
        column=5, row=4)
ttk.Button(mainframe, text="1", command=lambda: calc.state_num(1)).grid(
        column=1, row=6)
ttk.Button(mainframe, text="0", command=lambda: calc.state_num(0)).grid(
        column=1, row=7)

#Label Setup:
ttk.Label(mainframe, textvariable=EnteredSetup).grid(
        column=1,row=1,columnspan=5)

root.mainloop() 
```

我希望这能引导您朝着正确的方向进一步调整您的计算器。

# magento - Magento：通过 phtml 检索产品

> ID：13616217
> 
> 赞同：-2
> 
> 时间：2012-11-28T23:23:19.553
> 
> 标签：magento, php

我正在尝试使用 php 从模板中的特定类别中调用具有名称、图像等的产品列表。

看起来这应该很容易做到，但我已经为此工作了几个小时，但没有取得任何进展。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:44:18.133

在您的 magento phtml 文件中添加

```
<?php 
     $category_id = xx;
     echo $this->getLayout()
                ->createBlock('catalog/product_list')
                ->setTemplate('catalog/product/list.phtml')
                ->setCategoryId($category_id)
                ->toHtml();
 ?> 
```

# javascript - Javascript 中的 Onchange 事件；如何输入不同的项目

> ID：13616221
> 
> 赞同：1
> 
> 时间：2012-11-28T23:23:53.807
> 
> 标签：javascript, html

我对 javascript 相当陌生，我 13 岁。所以我对 javascript 中的事件很陌生。我需要有关此代码的帮助：

```
<head>
<script>
function myFunction()
{
var x=document.getElementById("fname");
if (x=="Kyle")
{
document.write("Correct!");
}
else
{
document.write("Incorrect!")
}
}
</script>
</head>
<body>
Enter your name: <input type="text" id="fname" onchange="myFunction()">
</body> 
```

当我输入我的名字时，我希望它说正确。请帮忙。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:26:52.390

线

```
if (x=="Kyle") 
```

应该读

```
if (x.value=="Kyle") 
```

x 代表元素，而不是元素的值。

我希望这有帮助。随意询问您是否还有其他问题。

* * *

首先在您的表单下方创建一个 div 标签，并给它一个类似“messageBox”的 id

所以：

```
<div id="messageBox"></div> 
```

然后替换

```
document.write("Correct!"); 
```

和

```
document.getElementById('messageBox').innerHTML = "Correct!"; 
```

和不正确的一样。

所有这一切都是创建一个 div 标签，以便 javascript 可以在某个地方输出成功/失败消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:27:03.607

你是如此接近。您获得了 DOM 元素 (getElementById)，但您需要获得元素的实际值。利用`x.value == "Kyle"`

# android - Android-在两个视图之间画线

> ID：13616223
> 
> 赞同：0
> 
> 时间：2012-11-28T23:23:56.250
> 
> 标签：android, android-layout, view, frame, android-canvas

下面是我在一个框架中创建了三个新视图的程序。单击两个不同的视图时，我想在视图之间画一条线。我试图弄清楚如何做到这一点......

```
 Ball ball1=new Ball(this,100,100,45);
    Ball ball2=new Ball(this,400,100,45);
    Ball ball3=new Ball(this,250,350,45);
    FrameLayout frame1=(FrameLayout) findViewById(R.id.main_view);
    frame1.addView(ball1);
    frame1.addView(ball2);
    frame1.addView(ball3);

      frame1.setOnTouchListener(new View.OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            switch(event.getAction()){
            case MotionEvent.ACTION_DOWN: {
                float x = event.getX();
                float y = event.getY();
                System.out.println("x:"+x+"y:"+y);
                if (x>55 && x<142 && y>55 && y<142) 
                    {
                    System.out.println("working1 "+count);
                    Toast toast = Toast.makeText(getBaseContext(), "Works fine", Toast.LENGTH_SHORT);
                    toast.show();
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T11:59:43.177

只需在某些条件下在 onDraw() 中画线，然后在 onTouch() 方法中的活动中设置此条件。然后在您更改其条件的视图上调用无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T05:39:22.653

在你的两个视图之间画一条线。

为绘制一条线的视图创建类。

```
public class DrawView extends View {
    Paint paint = new Paint();

    public DrawView(Context context) {
        super(context);
        paint.setColor(Color.BLACK);
    }

    @Override
    public void onDraw(Canvas canvas) {
            canvas.drawLine(0, 50, 350, 50, paint);
    }

} 
```

现在从您要在布局中添加此行的活动中。创建此类的对象并将此视图添加到您的布局中。

根据您的要求尝试这样。

绘图视图绘图视图；drawView = new DrawView(this);

```
frame1.addView(ball1);
                            // add that view here
frame1.addView(drawView);
frame1.addView(ball2);
                            // same way here
frame1.addView(ball3); 
```

有关更多详细信息，[请参见示例](http://glorious-arvind.blogspot.in/2012/11/draw-line-in-android.html)

# html - html图像的最大支持高度是多少？

> ID：13616225
> 
> 赞同：2
> 
> 时间：2012-11-28T23:24:03.993
> 
> 标签：html

我有一张图像被拉伸到`75069px`，只是注意到`65536px`图像的某个地方停止出现。很难说，因为它在哪里结束似乎有未定义的行为。

`<img>`标签的高度是否有最大值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:47:50.080

JPEG 格式支持的最大图像尺寸为 65535×65535。

来源：[http ://en.m.wikipedia.org/wiki/JPEG#section_13](http://en.m.wikipedia.org/wiki/JPEG#section_13)

# java - 用不同的 jar 运行？

> ID：13616226
> 
> 赞同：0
> 
> 时间：2012-11-28T23:24:04.477
> 
> 标签：java, jar, dependencies

我来自.net 世界。我记得如果您使用一个 dll 构建但在运行时提供不同的 dll，.net 会立即抱怨。

我现在正在向我的项目添加一些 hadoop 引用并找到以下文章。

[http://answers.mapr.com/questions/364/maven-repository-for-mapr-jar-files](http://answers.mapr.com/questions/364/maven-repository-for-mapr-jar-files)

我只是不明白这是怎么发生的。

Java 可以使用一个 jar 构建但使用不同的 jar 运行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:26:56.213

是的。这通常是 API 的情况（您编译 API，但在运行时您可能会使用可能包含在实现中的更新版本的 API 运行）。只要您编译的代码中引用的类/方法原型与您编译的 jar 相比没有变化，一切都会正常进行。

有关兼容性的具体定义，请参阅[二进制兼容性](http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html)（感谢 @MiserableVariable 的链接）。

# ruby-on-rails - 尝试安装 Rails，无法构建 Gem 原生扩展

> ID：13616228
> 
> 赞同：0
> 
> 时间：2012-11-28T23:24:18.903
> 
> 标签：ruby-on-rails

我正在尝试使用 Ruby 版本管理器在 Ubuntu 12.10 上安装 Rails。我相信 Ruby 和 RubyGems 安装正确，这些是我的版本：

```
ruby -v: ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]
gem -v: 1.8.23 
```

我正在尝试安装导轨，使用

```
sudo gem install rails -v 3.2.9 
```

这获取了很多宝石，但在构建本机扩展时存在问题：

```
Building native extensions.  This could take a while...
ERROR:  Error installing rails:
    ERROR: Failed to build gem native extension.

    /usr/bin/ruby1.9.1 extconf.rb
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:1:in `<main>'

Gem files will remain installed in /var/lib/gems/1.9.1/gems/json-1.7.5 for inspection.
Results logged to /var/lib/gems/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out 
```

知道我做错了什么吗？如果有帮助，我正在尝试按照[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-install_rails](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-install_rails)上的教程进行操作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:32:52.373

你有安装 C 编译器吗？如果没有，您应该运行`sudo apt-get install build-essential`以设置编译器工具链

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-03T10:01:16.137

以普通用户身份安装 gem，而不是 sudo：

> 宝石安装导轨

或者安装 ruby​​ 开发包。SO中有很多类似的答案：

[无法构建 gem 原生扩展 - Rails 安装](https://stackoverflow.com/questions/12552929/failed-to-build-gem-native-extension-rails-install#12552948)

[无法安装 gem - 无法构建 gem 本机扩展 - 无法加载此类文件 - mkmf (LoadError)](https://stackoverflow.com/questions/13767725/unable-to-install-gem-failed-to-build-gem-native-extension-cannot-load-such)

# python - 双鱼键扩展

> ID：13616234
> 
> 赞同：4
> 
> 时间：2012-11-28T23:24:42.360
> 
> 标签：python, python-3.x, cryptography, twofish

[我正在尝试按照Bruce Schneider 1998 年的论文中](http://www.schneier.com/paper-twofish-paper.html)所述逐步实施 Twofish 密码。尽管如此，我已经在关键扩展上失败了。

我尝试将论文的细节1对1复制到python中，结果如下：

```
#! /usr/bin/python3.2

def expandKey256 (key):
    m = [0] * (32)
    for i in range (32):
        m [i] = (key >> (i * 8) ) & 0xff
        #m [31 - i] = (key >> (i * 8) ) & 0xff
    print ('m = {}\n'.format ( [hex (b) for b in m] ) )

    M = [0] * 8
    for i in range (8):
        for j in range (4):
            M [i] += m [4 * i + j] * 2 ** (8 * j)
    print ('M = {}\n'.format ( [hex (b) for b in M] ) )

    Me = [M [0], M [2], M [4], M [6] ]
    Mo = [M [1], M [3], M [5], M [7] ]
    print ('Me = {}\n'.format ( [hex (b) for b in Me] ) )
    print ('Mo = {}\n'.format ( [hex (b) for b in Mo] ) )

    RS = [ [0x01, 0xA4, 0x55, 0x87, 0x5A, 0x58, 0xDB, 0x9E],
        [0xA4, 0x56, 0x82, 0xF3, 0x1E, 0xC6, 0x68, 0xE5],
        [0x02, 0xA1, 0xFC, 0xC1, 0x47, 0xAE, 0x3D, 0x19],
        [0xA4, 0x55, 0x87, 0x5A, 0x58, 0xDB, 0x9E, 0x03] ]

    s = [ [0] * 4] * 4
    S = [0] * 4
    for i in range (4):
        for j in range (4):
            for k in range (8):
                s [i] [j] += m [8 * i + k] * RS [j] [k]
                s [i] [j] &= 0xff
            S [i] += s [i] [j] * 2 ** (8 * j)
    for i in range (4):
        print ('S{} = {}'.format (i, hex (S [i] ) ) )

expandKey256 (0x0123456789ABCDEFFEDCBA987654321000112233445566778899AABBCCDDEEFF) 
```

但是，我的输出与[测试向量](http://www.schneier.com/code/ecb_ival.txt)中指定的不同。我已经尝试以相反的方式读取字节（注释行），但无济于事。

这些是测试向量的结果：

```
B89FF6F2
B255BC4B
45661061
8E4447F7 
```

这些是我的：

```
S0 = 0x612a646d
S1 = 0x527cc87a
S2 = 0x1482c008
S3 = 0xa4d128ce 
```

谁能看到我的错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T00:22:55.620

至少这条线

```
s = [ [0] * 4] * 4 
```

可能没有做你认为它正在做的事情。它没有做同样的事情

```
s = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]] 
```

但是，我没有浏览所有代码。

编辑

显然，OP需要更多证据。这里来自 IDLE 的一些输出显示了差异

```
>>> s = [ [0] * 4] * 4
>>> s
[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]
>>> s[0][0] += 1
>>> s
[[1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0], [1, 0, 0, 0]]
>>> s = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]
>>> s
[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]
>>> s[0][0] += 1
>>> s
[[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]
>>> 
```

该表达式`s = [ [0] * 4] * 4`创建一个包含另一个零列表的列表，然后再制作 3 个对该列表的引用的副本。它相当于`v = [0]*4; s=[v,v,v,v]`

# mvvm-light - 类库中的 MVVM 灯...当我释放所有关联的视图时，某些东西会保留在 ViewModelLocator 上

> ID：13616235
> 
> 赞同：1
> 
> 时间：2012-11-28T23:24:47.763
> 
> 标签：mvvm-light

在类库 DLL 中使用 Ninject 和 MVVM-Light。当我释放所有调用 DataContext 的视图时

```
<UserControl.Resources>
  <vm:ViewModelLocator x:Key="ViewModelLocator"/>
</UserControl.Resources>   

<UserControl.DataContext>
  <Binding Path="DataViewsViewModel" Source="{StaticResource ViewModelLocator}" />
</UserControl.DataContext> 
```

...它似乎没有释放 ViewModelLocator。

使用 ANTS Memory Profiler，剩下的唯一引用是 ViewModelLocator。

我想更多的细节是有序的，并且欢迎任何关于哪些信息最有利于解决这个问题的指导。我在这里即时学习:)。

我想要完成的是对类对象实例的完整清理，以便在实例化一个新对象时，它将开始全新的。

ps 这个类库是我们将 WPF 添加到 MFC C++ 应用程序的方式。我们根据需要调用“控件”，并希望在不再需要时完全清理或处置。

# javascript - 将嵌入的 JavaScript 转换为 ajax 调用

> ID：13616237
> 
> 赞同：0
> 
> 时间：2012-11-28T23:25:11.553
> 
> 标签：javascript, ajax, jquery

我目前正在我的页面上直接嵌入第三方 javascript 文件。

但是，我从中嵌入它的网站需要一段时间才能响应，因此它会停止渲染我的网站几秒钟。

我目前将它嵌入到我的页面上，它会在其中写入一些值：

```
<script language="javascript" type="text/javascript" src="[third-party site/file.js]"></script> 
```

嵌入脚本的响应只是一些 JavaScript：

```
document.write('<div class="value">Value 1</div><div class="value">Value 2</div>'); 
```

我在想，在页面加载后使用 jQuery 发出 AJAX 请求并以某种方式解析响应，这样我就可以获得我需要的值。

有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:31:26.367

您可以将此脚本放在正文末尾的隐藏元素中（就在 之前`</body>`），并在页面加载后，使用 jQuery 将其移动到所需位置。

```
 <div id="hiddenElement">
        <script type="text/javascript" src="[third-party site/file.js]"></script>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#hiddenElement").appendTo("#someOtherElement");
        });
    </script>
</body> 
```

另一种解决方案是使用 jQuery[`.getScript()`](http://api.jquery.com/jQuery.getScript/)将脚本加载到您所说的所需位置，@James McDonnell 说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:45:14.247

也许这可能是您解决方案的一部分。这是一个独立的 jQuery 示例，其中一个按钮用于触发 DIV 上的更改事件。此示例仅向您展示如何访问 div 的 html 内容并了解如何操作/更改它。这对您来说不是一个解决方案，但当与 rcdmk 和 James 的想法结合使用时，它的一部分可能会很有用。

```
<html>
    <head>
        <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>-->
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('#button_test').click(function() {
                    $('.value').html('New stuff').change();
                });
                $('.value').change(function(){
                    $('div').each(function() {
                        alert($(this).html());
                    });
                });
            });
        </script>
    </head>
<body>

<div class="value">Value 1</div>
<div class="value">Value 2</div>
<button id="button_test">Click me</button> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:30:31.203

```
$(document).read(function()
{
  $.getScript(/* src */)
}); 
```

这将在页面加载后运行。

[$.getScript()](http://api.jquery.com/jQuery.getScript/)

# php - Codeigniter 2.1，PHP - 二维数组中请求值的计数数组

> ID：13616243
> 
> 赞同：0
> 
> 时间：2012-11-28T23:25:32.843
> 
> 标签：php, codeigniter, codeigniter-2

我有这个代码：

```
<?php foreach ($galerije as $gal): ?>
<h1><?php echo str_replace('_', ' ', $gal['naziv']) ?></h1>
<p><?php echo word_limiter($gal['opis'], 30) ?></p>
<?php echo count($slike) ?>
<hr>
<?php endforeach ?> 
```

**$galerija**代表数据库中的所有画廊，并以**id_galerija**作为主键。

**$slike**代表数据库中的所有图像，它们与**galerija**有一对多的关系（一个画廊可以有很多图像）。它与**galerija_id** ( **slike.galerija_id = galerija.id_galerija** ) 相连。如何计算每个画廊的图像数量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T11:07:28.527

你可以这样做：

```
$galleries = array(array(
    'Galleryname' => 'Picasso',
    'Galleryimages' => array(
        '1.jpg',
        '2.jpg',
        '3.jpg',
        '4.jpg'
        ),
    array(
        '1.jpg',
        '2.jpg'
        ),
    array(
        '1.jpg',
        '2.jpg',
        '3.jpg',
        '4.jpg',
        '5.jpg',
        '6.jpg'
        ),
    ),
array(
    'Galleryname' => 'Matisse',
    'Galleryimages' => array(
        '1.jpg',
        '2.jpg'
        ),
    array(
        '1.jpg',
        '2.jpg',
        '3.jpg'
        ),
    array(
        '1.jpg',
        '2.jpg',
        '3.jpg',
        '4.jpg',
        '5.jpg',
        '6.jpg',
        '7.jpg',
        '8.jpg'
        ),
    )
);

$counts = array();
foreach ($galleries as $key => $value) {
    $counts[$value['Galleryname']] = (count($value, COUNT_RECURSIVE)-count($value)); 
}

echo '<pre>';
print_r($counts);
echo '</pre>'; 
```

最终会是：

```
Array
(
    [Picasso] => 12
    [Matisse] => 13
) 
```

那是你想要的吗？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-29T00:58:01.903

把它包起来

我是计数

```
$i = 0;
foreach ($Contents as $item) {
    $i++;
    $item[number];
} 
```

# javascript - 如何在 KISSMetrics 中设置返回属性？

> ID：13616250
> 
> 赞同：0
> 
> 时间：2012-11-28T23:25:54.510
> 
> 标签：javascript, ruby-on-rails-3, kissmetrics

我正在通过 Javascript 和 Rails 本身（取决于事件类型）将 KISSMetrics 集成到我的 rails 应用程序中。

如何在 KISSMetrics 中为访客设置返回属性？

该文档暗示它是由 KISS 自动设置的，只要我的应用程序始终如一地识别用户。我已经确认 KISS 能够通过实时仪表板一致地识别用户，这表明 KISS 已经记录了访问的匿名用户 ID 号、URL 和引用者属性。

然而，尽管用同一个用户重复访问我的测试站点，我没有看到任何 Returning 属性被设置。它未显示在实时仪表板中。它也不能作为报告或指标中的属性使用。

我在这里错过了一步吗？还是我需要等一天？我已经给了它大约 8 小时，而关于 KISS 延迟的指导似乎从几分钟到 6 小时不等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:32:47.277

返回参数由系统自动设置 - 无需配置。令人困惑的是，在事件首次发生（回访者）和系统报告事件之间存在显着延迟。这与 Rails 触发的事件（几乎立即可见）形成鲜明对比。

# java - Maven pom.xml 更改清单主类

> ID：13616252
> 
> 赞同：0
> 
> 时间：2012-11-28T23:26:19.090
> 
> 标签：java, maven, maven-assembly-plugin

我正在做一个项目，在该项目中我获得了一个使用 Maven 构建的示例代码。在 pom.xml 中有

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.3</version>
    <configuration>
        <archive>
            <manifest>
                <mainClass>com.xxx.research.control.ControlClass</mainClass>
                <addClasspath>true</addClasspath>
                <classpathPrefix>lib/</classpathPrefix>
            </manifest>
        </archive>
        <descriptorRefs>
            <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
    </configuration>
    <executions>
        <execution>
            <id>make-assembly</id>
            <phase>package</phase>
            <goals>
                <goal>single</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

现在我已经编写了自己的代码，并且我正在尝试重用这个 pom，因为我是 maven 的新手。我试图更改`<mainClass>com.xxx.research.control.Main</mainClass>`为，`<mainClass>project.Main</mainClass>`因为那是我的代码所在的位置。在 Eclipse 中，我将它放在 sam 源文件夹中，但在包“项目”中。

当我使用原始 pom 进行 maven clean install 时，我可以运行它生成的 jar，但是当我修改它以构建我的代码时，我得到了`Exception in thread "main" java.lang.NoClassDefFoundError: project/Main`.

我在这里想念什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:32:00.483

默认情况下，maven 在 src/main/java 文件夹下查找您的源代码，因此您必须将主类放在 src/main/java/project/Main.java

阅读 maven 手册，它还有一些用于资源和单元测试的文件夹结构，它们将包含在类路径中：

*   源/主/资源
*   源/测试/java
*   源/测试/资源

# javascript - Twitter 引导菜单 - 响应问题

> ID：13616253
> 
> 赞同：3
> 
> 时间：2012-11-28T23:26:19.610
> 
> 标签：javascript, html, css, twitter-bootstrap, responsive-design

有没有办法让导航缩小时，所有或任何下拉菜单都会展开？因此，当用户触摸导航并下拉所有下拉导航项时已经完全展开？

我认为这是一种默认行为，但对我来说似乎并非如此。

相反，我的导航看起来像这样：

![图像示例](../Images/83878b60e55dbfcdd978ea17c0e3692c.png)

我必须将鼠标悬停在菜单项上才能获得该二级菜单。有没有办法让这个和所有其他下拉菜单已经展开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:39:18.443

解决此问题的正确答案是执行以下操作：[这里可以看到。](https://github.com/twitter/bootstrap/issues/4550#issuecomment-10398831)

```
@media (max-width: 980px) {
  .dropdown ul.dropdown-menu {
    display: block;
  }
} 
```

这是针对版本**2.2.2**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:09:43.597

仅从 2.2 版开始，您想要的行为被当前在可折叠导航栏中折叠/可折叠下拉菜单的行为所取代。

我将以下解决方法放在一起，这似乎可以解决问题：

```
$('.nav-collapse').on('show', function (e) {
  var $dropdowns = $(this).find('.dropdown');
  setTimeout(function () {
    $dropdowns.addClass('open')
  });
}); 
```

的原因`setTimeout`是因为否则触发打开导航栏的原始**点击**`<html>`事件将在它传播到元素时再次关闭下拉菜单。

# javascript - Ajax 返回变量问题

> ID：13616254
> 
> 赞同：0
> 
> 时间：2012-11-28T23:26:25.327
> 
> 标签：javascript

我正在尝试将 ajax 回调函数变量值分配给现有变量。

我有

```
function test(){

}

test.prototype.click=function(){

  this.count;

  //call ajax codes.....

  //ajax callback function
  ajax.callback=function(var1){
    //I want to assign returned data to this.count property. 
    this.count=var1.length
  }

}

test.prototype.show=function(){
   //wont work, it will show undefined...
   alert(this.count);
}

var t=new test();
    t.click();
    t.show(); 
```

我认为这是范围问题，但我不知道如何解决。任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:30:42.653

是的，在另一个范围内使用它会导致各种问题，所以你需要解决这个问题。一种方法是通过不同地定义函数来完全避免使用它。例如，您可以像这样定义计数：

```
function test() {

    function count() {
    }
    ... 
```

并且只使用 count() 而不使用 this。字首。

您还可以为此设置一个变量，并使用它来引用其他范围内的计数。例如：

```
var self = this; 
```

与此有关的范围问题可能会令人头疼，并且可能会在您使用回调执行更多 OO 时发生。很高兴你很早就被介绍了，所以现在你知道要保持警惕。

# objective-c - 如何使用 Kiwi 异步测试委托

> ID：13616255
> 
> 赞同：6
> 
> 时间：2012-11-28T23:26:26.313
> 
> 标签：objective-c, unit-testing, ios6, kiwi

伙计们，我多年来一直在努力寻找一些关于如何使用 Kiwi 测试异步测试委托方法的好例子。

我有一个管理器类，它定义了测试协议，在委托中返回了一个通过和失败的方法。谁能提供有关如何执行此操作的示例代码？我可以让测试类本身实现调用管理器上的方法吗？

多谢你们

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T09:02:33.347

你可以像例子中那样做

```
 SPEC_BEGIN(IFStackOverflowRequestSpec)

describe(@"IFStackOverflowRequestSpec", ^
{
    context(@"question request", ^
    {
        __block IFViewController *controller = nil;

         beforeEach(^
         {
             controller = [IFViewController mock];
         });

        it(@"should conform StackOverflowRequestDelegate protocol", ^
        {
             [[controller should] conformToProtocol:@protocol(StackOverflowRequestDelegate)];
        });

         it(@"should recieve receivedJSON", ^
         {
             NSString *questionsUrlString = @"http://api.stackoverflow.com/1.1/search?tagged=iphone&pagesize=20";

             IFStackOverflowRequest *request = [[IFStackOverflowRequest alloc] initWithDelegate:controller urlString:questionsUrlString];
             [[request fetchQestions] start];
             [[[controller shouldEventuallyBeforeTimingOutAfter(3)] receive] receivedJSON:any()];
         });

         it(@"should recieve fetchFailedWithError", ^
         {
             NSString *fakeUrl = @"asda";
             IFStackOverflowRequest *request = [[IFStackOverflowRequest alloc] initWithDelegate:controller urlString:fakeUrl];
             [[request fetchQestions] start];
             [[[controller shouldEventuallyBeforeTimingOutAfter(1)] receive] fetchFailedWithError:any()];
         });
    });
}); 
```

完整的例子可以建立在[这个链接上。](https://github.com/IgorFedorchuk/use-bdd)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T06:08:49.870

您可以通过创建一个代表委托的模拟对象来完成我*认为*您想要实现的目标，然后检查模拟对象是否接收到您期望的委托回调。所以这个过程看起来像：

*   创建一个符合委托协议的模拟对象：

`id delegateMock = [KWMock mockForProtocol:@protocol(YourProtocol)];`

*   将模拟设置为您的经理类的代表：

`[manager setDelegate:delegateMock];`

*   创建一个包含将由管理器类返回的数据的对象：

`NSString *response = @"foo";`

*   *设置最终*应该使用方法和响应对象调用模拟的断言（在这种情况下，我期望接收`managerRepliedWithResponse`and `foo`）

`[[[delegateMock shouldEventually] receive] managerRepliedWithResponse:response];`

*   调用被测方法：

`[manager performMyMethod];`

*关键是在调用方法之前*设置期望，并使用`shouldEventually`它延迟检查断言并给`manager`对象时间来执行方法。

您还可以使用 Kiwi wiki 上列出的一系列期望 - [https://github.com/allending/Kiwi/wiki/Expectations](https://github.com/allending/Kiwi/wiki/Expectations)

我已经[在我网站上的帖子中更详细地](http://www.adoptioncurve.net/archives/2012/11/testing-asynchronous-network-code-with-kiwi.php)编写了该过程，尽管它更具体地适应了我正在处理的情况。

# jquery - jQuery Load() 没有形成 DIV

> ID：13616256
> 
> 赞同：1
> 
> 时间：2012-11-28T23:26:27.657
> 
> 标签：jquery, jquery-animate, jquery-load

嘿，我在我的 div 中使用 jQuery 的 load() 函数加载 HTML 页面时遇到了一些问题。如果我的 HTML 页面中的内容比它最初进入的 DIV**更大（更高的高度） ，那么它只会在潜水时流血。**

这是我在 DIV 上使用 jQuery load() 后页面的样子：

![jQuery加载](../Images/a41b9df6ce70b17eb914f2818ab04aef.png)

加载时应该是这样的：

![jQuery 加载 2](../Images/b2d7ba89261285fff86b3a47527692a0.png)

这是我的 HTML DIV 代码的样子：

```
 <div class="container_1" id="mainHTML">  
  <div class="pageinner" id="innerHTML">
    <p style="font-size: 24px;" class="MMHeader">The CMS System<p>
    <p style="color: #F90;" class="mmBelowHeader">Please provide your email and password below in order to log into the CMS system.<p>
        <section class="main" id="mainContent">
            <div class="form-4">
                <p>
                    <input type="text" name="username" id="username" placeholder="Email Address">
                </p>
                <p>
                    <input type="password" name='password' id="password" placeholder="Password"> 
                </p>

                <p>
                    <button class="orange" name="forgotLoginButton" id="forgotLoginButton" onclick="shrinkBox();" style="margin-right: 5px;">Forgot Password</button>
                    <button class="blue" name="LoginButton" id="LoginButton" onclick="mainMenu();" >Log in</button>
            </div>​
        </section>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function() {
    $("#mainHTML").animate({width:500, height: 300, overflow: 'auto'});
    $("#innerHTML").animate({width:470, overflow: 'auto'});
    $(".form-4").animate({margin: '10px auto 10px', overflow: 'auto'});
    $('#mainContent').load('test.html');
});
</script> 
```

我确定这是因为我正在为框的宽度/高度设置动画，但是有一种方法可以将加载的内容保持在 DIV 中并根据加载的内容调整其高度？

**更新**

```
$('#mainContent').fadeOut(0).load('test.html', function() {
    $('#mainHTML').animate({width:940, height: 'auto'});
    $("#innerHTML").animate({width:940, overflow: 'auto'});
}).fadeIn(2000); 
```

但它不会**将**div 的大小调整为加载的 html 内容的高度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:50:39.973

`#mainHTML`检索数据后尝试重置高度：

```
$('#mainContent').load('test.html', function() {
  $("#mainHTML").stop().css({height: 'auto'});
}) 
```

[http://jsfiddle.net/KzEpL/](http://jsfiddle.net/KzEpL/)
[http://jsfiddle.net/KzEpL/1/](http://jsfiddle.net/KzEpL/1/)

# javascript - 简单的 JQuery 在某些领域工作，而不是在其他领域

> ID：13616264
> 
> 赞同：-1
> 
> 时间：2012-11-28T23:27:00.293
> 
> 标签：javascript, jquery

在我正在处理的网站上添加幻灯片后，一些使用 Jquery 的 Web 组件停止工作。然而，新添加的也使用 JQuery 的幻灯片按预期工作。

经过一些调试，我从下面的代码中确切地发现了 JQuery 的工作原理和不工作的地方。我在我的代码中添加了一条注释来表明这一点。

我在标题中导入我的 jquery 库，下面的代码是结束标记之前的最后一个代码`<body>`。

```
<!--SLIDESHOW-->    
    $(document).ready(function() {
        var options = {};

        if (document.location.search) {
            var array = document.location.search.split('=');
            var param = array[0].replace('?', '');
            var value = array[1];

            if (param == 'animation') {
                options.animation = value;
            }
            else if (param == 'type_navigation') {
                if (value == 'dots_preview') {
                    $('.border_box').css({'marginBottom': '40px'});
                    options['dots'] = true;
                    options['preview'] = true;
                }
                else {
                    options[value] = true;
                    if (value == 'dots') $('.border_box').css({'marginBottom': '40px'});
                }
            }
        }

        $('.box_skitter_large').skitter(options);

        // Highlight
        $('pre.code').highlight({source:1, zebra:1, indent:'space', list:'ol'});

           //**** everything above works, everything below this point does not! ****/
        $(".expandButton").click(function(ev){
            $(ev.target).closest(".company-container").find(".expand").css("height", "140px");
            $(ev.target).closest(".company-container").find(".expand").toggle("fast");
        });         
        $(".emailLink, .email-popup").click(function(e){
            e.stopPropagation();
            $(e.target).closest(".company-container").find(".expand").css("height", "140px");
            $(e.target).closest(".company-container").find(".email-popup").show("fast");
            $(e.target).closest(".company-container").find(".phone-popup").hide();
            $(e.target).closest(".company-container").find(".address-popup").hide();
        });
        $(".addressLink, .address-popup").click(function(e){
            e.stopPropagation();
            $(e.target).closest(".company-container").find(".expand").css("height", "550px");
            $(e.target).closest(".company-container").find(".address-popup").show("fast");
            var address = $(e.target).closest(".company-container").find(".address").html(); //get address text
            if(!($(e.target).closest(".company-container").find(".map").length)){ //check if it was loaded
                $(e.target).closest(".company-container").find(".address-popup").html('<iframe class="map" style="margin-top:45px;" width="575" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q='+ address +' &amp;aq=&amp;ie=UTF8&amp;hq=&amp;hnear='+address+'&amp;t=m&amp;z=14&amp;iwloc=A&amp;output=embed"></iframe>'); 
            }
            $(e.target).closest(".company-container").find(".email-popup").hide();
            $(e.target).closest(".company-container").find(".phone-popup").hide();
        });
        $(".phoneLink, .phone-popup").click(function(e){
            e.stopPropagation();
            $(e.target).closest(".company-container").find(".expand").css("height", "140px");
            $(e.target).closest(".company-container").find(".phone-popup").show("fast");
            $(e.target).closest(".company-container").find(".email-popup").hide();
            $(e.target).closest(".company-container").find(".address-popup").hide();
        });
        $(document).click(function(e) {
             if (!(e.target.class === "email-popup" || e.target.class === "phone-popup")) {
                $(".email-popup, .phone-popup, .address-popup").hide("fast");                
             }
             $(".expand").css("height","140px");
        });     
        $(".tagKeyword").hover(function(){
            $(this).css("background-color","#fff");
            $(this).css("color","blue");
            $(this).css("box-shadow","none");
        });
        $(".tagKeyword").mouseleave(function(){
            $(this).css("background-color","#eee");
            $(this).css("color","#556");
            $(this).css("box-shadow","1px 1px 2px #ccc");
        });
        $(".search-container").hover(function(){
            $(".search-container").css("background","url(./images/menu/menu-middle.png)");
        });
        $(".searchfield").Watermark("search");
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:33:07.417

你能试试这个吗？

```
$(".expandButton").click(function() {
    $(this).closest(".company-container").find(".expand").css("height", "140px");
    $(this).closest(".company-container").find(".expand").toggle("fast");
}); 
```

这可能根本没有帮助，但我没有看到`ev`这里需要，而是使用`this`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T01:54:11.463

可能您需要仔细检查 ev 变量：

```
ev = ev || window.event 
```

# openid - OpenID 连接的当前状态

> ID：13616267
> 
> 赞同：2
> 
> 时间：2012-11-28T23:27:07.007
> 
> 标签：openid

OpenID 连接的当前状态是什么？我想将它用于新的 SSO 系统。是否有可用于实施的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-18T16:50:47.720

[根据http://openid.net/2014/02/26/the-openid-foundation-launches-the-openid-connect-standard/](http://openid.net/2014/02/26/the-openid-foundation-launches-the-openid-connect-standard/)，最终 OpenID Connect 规范于 2014 年 2 月 26 日发布

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:50:10.150

他们目前处于“对实施者草案的反馈”状态。接下来的状态是：“最终审查期”→“最终投票”→“OIDF 标准”。请参阅 OIDF 的网站[状态页面](http://openid.net/wg/connect/status/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-19T16:42:47.847

可在此处找到各种语言/环境的 OpenID Connect 开发人员库列表：http: [//openid.net/developers/libraries/](http://openid.net/developers/libraries/)

# javascript - 我如何进行 javascript 字符串操作？

> ID：13616277
> 
> 赞同：-8
> 
> 时间：2012-11-28T23:28:00.687
> 
> 标签：javascript, jquery

我有一个这样的变量：

```
var data= [{"Timestamp":1349816400000,"TaskEffortLeft":123},{"Timestamp":1352498400000,"TaskEffortLeft":-123}] 
```

现在我想去掉那些 "Timestamp": 和 "TaskEffortLeft": 并且把大括号变成大括号，让它像这样：

```
var data= [[1349816400000,123],[1352498400000,-123]] 
```

我怎么做？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:31:05.010

尝试

```
var result = data.map(function(item) {
   return [item.Timestamp, item.TaskEffortLeft];
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:31:39.330

尝试这个

```
var arr = [];
​$.each(data, function(){
    var temp = [];
    temp.push(data["Timestamp"] );
    temp.push(data["TaskEffortLeft"] );
    arr.push(temp)
});
console.log(arr) 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/7sBcA/)** </p>

# c# - 创建继承类的实例时出现 NullReferenceException

> ID：13616278
> 
> 赞同：4
> 
> 时间：2012-11-28T23:28:05.633
> 
> 标签：c#, mono, monogame

我正在 XNA 中编写自己的游戏引擎，并开始将其移植到 MonoGame 中，以便可以将其放在 Android/iOS/Windows 8 上。由于某种原因，当主创建新游戏对象时，我得到一个空引用异常。所以分配对象的代码是：

```
 static void Main(string[] args)
    {
        //game g = new game();
        using (game game = new game())
        {
            game.Run();
        }
    } 
```

错误是

```
 public lesaEngine() 
```

这是游戏对象的基本构造函数。

继承一如既往

```
 class lesaEngine : Microsoft.Xna.Framework.Game
    class game : lesaEngine 
```

不知道这里发生了什么。在普通 XNA 下可以正常工作。我正在使用 Visual Studio 2012 作为端口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T15:00:31.373

您是否创建了一个新的 Win8 单游戏项目？如果是这样，入口点应该看起来更像这样

```
#if !NETFX_CORE 
  using (MyGame game = new MyGame()) 
  { 
      game.Run();
  } 
#endif 
#if NETFX_CORE 
  var factory = newMonoGame.Framework.GameFrameworkViewSource<MyGame>();
  Windows.ApplicationModel.Core.CoreApplication.Run(factory); 
#endif } 
```

# macos - Mountain Lion /etc/hosts 离线时解析很慢

> ID：13616279
> 
> 赞同：0
> 
> 时间：2012-11-28T23:28:06.803
> 
> 标签：macos, dns, localhost, osx-mountain-lion

有[许多](https://stackoverflow.com/questions/10064581/how-can-i-eliminate-slow-resolving-loading-of-localhost-virtualhost-a-2-3-secon)[线程在](https://stackoverflow.com/questions/6841421/mac-osx-lion-dns-lookup-order) [讨论](https://serverfault.com/questions/321386/resolving-to-virtual-host-very-slow-on-mac-os-x-lion)Mountain Lion 上 /etc/hosts 的缓慢解析。连接到 Internet 时，我的自定义主机 (someserver.dev) 的分辨率很快。我下线的那​​一刻，分辨率可能需要长达 30 秒。似乎无法在不在线或不安装 DNS 服务器的情况下快速解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T17:42:48.883

我发现 /etc/hosts 中的条目需要位于单独的行上。例如，我也遇到了这个配置的问题：

```
 192.168.0.13 my1stmachine.local my2ndmachine.local my3rdmachine.local 
```

但是在我将每个条目放在自己的行之后，不再缓慢：

```
 192.168.0.13 my1stmachine.local
 192.168.0.13 my2ndmachine.local
 192.168.0.13 my3rdmachine.local 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:31:58.697

您最好的选择可能是安装本地 DNS 服务器，如Justin Carmony在[这篇博客文章中看到的 dnsmasq。](http://www.justincarmony.com/blog/2011/07/27/mac-os-x-lion-etc-hosts-bugs-and-dns-resolution/)这有点烦人，但是对于您的本地开发服务器来说，解决方案来得非常快。您还可以在 dnsmasq.conf 文件中执行这样的通配符条目：

```
address=/.dev/127.0.0.1 
```

这样anything.dev 就会解析为您的本地主机。希望有帮助！

# javascript - 莫里斯图表问题

> ID：13616285
> 
> 赞同：2
> 
> 时间：2012-11-28T23:28:26.507
> 
> 标签：javascript, ruby-on-rails-3, morris.js

我正在尝试使用莫里斯图表正确绘制一些数据。

数据和图表如下所示：[http ://cl.ly/LDZC](http://cl.ly/LDZC) ![在此处输入图像描述](../Images/92e8bc7769433ef6e155e5b8a6d18d33.png)

返回的数据似乎是正确的，但是看起来该系列的映射不正确。不知道为什么会有那些未定义的系列..

继承人的Javascript

```
 var getChartData = function() {
$.get('/dashboard/chart_data', 'json')
  .done(function(data) {
            alert(JSON.stringify(data))
            Morris.Line({
              element: 'orders_chart',
              data: data,
              xkey: 'purchased_at',
              ykeys: 'price',
              labels: ['Revenue']
            });
  }); 
```

};

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-21T05:49:28.487

尝试使用 $.parseJSON(your_json_data); 更改编码行

```
Morris.Line({
          element: 'orders_chart',
          data: $.parseJSON(data),
          xkey: 'purchased_at',
          ykeys: 'price',
          labels: ['Revenue']
        }); 
```

使用此图表我有类似的问题。您只需要从回调中解析 JSON 对象。

# oop - 如何命名业务层中仅起作用的对象？

> ID：13616287
> 
> 赞同：2
> 
> 时间：2012-11-28T23:28:27.487
> 
> 标签：oop, design-patterns, business-logic

我环顾四周，没有发现任何特定于我的问题的东西，但这部分是因为我不确定如何表达它。

我管理着大约 20 个不同的 C# .NET 应用程序，它们都做着相对相似的事情。

我正在努力将通用代码整合到数据、业务逻辑和演示文稿中。

我的问题与业务逻辑层有关。

我收集到一个业务/域对象是一个持有状态的对象，有时可能会执行相关的操作（如果你采用这种方法）。

但是你会怎么称呼一个只通过例程工作的对象呢？

例如：

1.  在表示层中会触发一个按钮事件。
2.  表示层指向这个类并调用“RunJob()”方法。
3.  RunJob() 完成它需要做的所有工作，然后完成。例如，它可能会读取一个表格并将其输出为 CSV（其中很多应用程序都是数据推送器）。它可能使用也可能不使用内部字段/属性。这些属性可用于在界面中显示数据或创建输出。

有这个名字吗，还是在实践中它只是一个糟糕的模式/糟糕的 OO？我不认为这有资格作为业务对象或助手。我已经看到[其他一些](https://stackoverflow.com/questions/2928325/what-is-the-definition-of-a-service-object)暗示它可能是“服务”对象的主题。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:34:52.017

暂时称它为 WorkerThread 并查看鲍勃叔叔关于命名的文章“ [http://www.objectmentor.com/resources/articles/Naming.pdf](http://www.objectmentor.com/resources/articles/Naming.pdf)。然后将名称更改为合理的名称。

你的课不一定是坏课。大多数实体通常没有太多的行为，otoh 一些辅助类没有太多的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:51:36.520

对象的名称具体取决于它们所做的工作。TableImporter 和 CsvExporter 是您描述的任务的好名称。这些方法也应该适当命名。您可能希望抽象一个接口`Runner`并拥有一个通用`RunJob`方法来解耦您的表示层和模型层，但是如果您使用控制器来代替它可能会更清晰和解耦。

# jquery - 如何使用 .find() 获取添加到 DOM 的 div 的 ID 和类

> ID：13616294
> 
> 赞同：0
> 
> 时间：2012-11-28T23:29:18.303
> 
> 标签：jquery

当我尝试查找已添加到 DOM 的类时，以下工作

```
$('#myDIV').find('div[class="myClass"]').click(function(){
   $('.myClass').removeClass('active');
   $(this).addClass('active');
}); 
```

除了 div 的 ID 和类，我将如何完成同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:32:07.657

如果要查找同时具有这两个条件的元素：

```
.find('#myId .myClass') 
```

只需 id：

```
.find('#myId') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:32:31.893

我不确定我是否理解您的要求，但您可以更改选择器：

```
$("#myDIV div.myClass, #myDIV #myID").click(function () { ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:33:02.390

尝试这个

```
find('div.myClass#myId'); 
```

但由于Id在**HTML页面上****是唯一**的......

 **这个就够了。。

```
$('#myId').on('click', function(){
    $('.myClass').removeClass('active');
   $(this).addClass('active');
}); 
```**

# iphone - 有没有办法以编程方式在 iPhone 上的 iOS 中设置 UIBackgroundModes？

> ID：13616298
> 
> 赞同：1
> 
> 时间：2012-11-28T23:29:47.177
> 
> 标签：iphone, ios, dynamic, background, location

我希望能够设置 UIBackgroundModes 设置以从我的 gui 动态更新我的位置（使用 UISwitch 设置）。我可以很好地处理 UISwitch 的东西，但是，即使应用程序在后台，我也希望能够让用户能够“打开”位置更新。我想，如果我能够做到这一点，那么，我需要更新内存中的一些数据结构，以及更新我的 Info.plist 文件......

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T03:08:11.600

您不能使用代码来更改它。您只能在编译**之前**通过编辑`xx-info.plist`文件来更改它。`UIBackgroundModes`是您可以在`info.plist`文件中使用的 iOS 密钥之一。查看 Apple 对该`info.plist`文件的评价

这是[info.plist 的描述](http://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Introduction/Introduction.html)。

> 关于 Info.plist Keys
> 
> 为了给用户提供更好的体验，iOS 和 OS X 依赖于每个应用程序或捆绑包中存在的特殊元信息。此元信息以许多不同的方式使用。其中一些显示给用户，一些在系统内部用于识别您的应用程序及其支持的文档类型，还有一些被系统框架用于促进应用程序的启动。**应用程序向系统提供元信息的方式是通过使用称为信息属性列表文件的特殊文件**。

这是[iOS 键的描述](http://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW1)。

> iOS 键
> 
> iOS 框架提供了创建 iOS 应用程序所需的基础设施。您可以使用与此框架关联的键来配置应用程序在启动时的外观以及应用程序运行后的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T02:47:11.963

不可以，只能在 Info.plist 中设置，应用构建后无法修改。

# java - 多类java小程序到jar到html

> ID：13616300
> 
> 赞同：1
> 
> 时间：2012-11-28T23:29:50.610
> 
> 标签：java, html, compilation, applet

我已经把头撞在墙上几个小时了，试图找到一个关于如何将具有多个类文件的小程序编译为 html 文件的“好”教程。

我可能会以错误的方式解决这个问题。那或者我弄错了该怎么做。

我有 3 个类：Particles(main) ParticleO 和 Handler

在 cmd 我输入命令：

```
jar cvfm Particle.jar manifest.txt *.* 
```

显现：

```
Main-Class: Particles
(anextralinehere) 
```

（我在 src 目录中）

它编译得很好（我想，我没有得到任何错误）

我制作了一个 index.html

```
<html>
<head>
<title> Particle </title>
</head>

<body>
<applet code='Particles.class' 
archive='Particle.jar',
 width="1200", height="600"/>
</applet>
</body>
</html> 
```

当我打开文件并且小程序说有错误时，我的浏览器崩溃了

**编辑/更新** 错误是：“ClassNotFoundException”“Particles.class”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:21:41.650

您的“code”属性不正确，您需要做的是code="jarName.className"。您不需要 .class 扩展名。

在您的情况下，您需要将代码属性更改为 code="Particle.Particle"

希望有帮助:)

# c# - 使用 WPF 在 Canvas 上绘制线条

> ID：13616301
> 
> 赞同：0
> 
> 时间：2012-11-28T23:29:54.660
> 
> 标签：c#, wpf, graphic

在我的 WPF 程序中，我使用画布作为渲染绘图的地方，因此当它处于画线模式时，任何未完成的线都会跟随鼠标光标并等待再次单击以找到线的终点。

一个视觉问题是大多数时间线并没有以超快的速度跟随光标......即使有时我可以看到有延迟。无论如何它都能找到它，但它不会像在其他绘图应用程序中那样移动光标，例如 autocad 或 soildworks ...

我在这里想念什么？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T19:34:46.500

正如@PeteBaughman 所说，这将有助于更多地了解您的代码，尝试发布如何添加和编辑该行的示例。但是，一种可能的解决方案是，如果您还没有这样做，请尝试捕获鼠标：

XAML：

```
<Canvas OnMouseDown="MyCanvas_MouseDown" ... /> 
```

代码隐藏：

```
public void MyCanvas_MouseDown(object sender, MouseButtonEventArgs e){
    MyCanvas.CaptureMouse();
} 
```

这应该确保您获得所有鼠标事件，并且是我最近遇到的一个非常相似的问题的解决方案。

问候，

理查德

# python - 在列表中查找列的总和获取“TypeError：无法使用灵活类型执行减少”

> ID：13616303
> 
> 赞同：5
> 
> 时间：2012-11-28T23:29:58.923
> 
> 标签：python, numpy, sum, typeerror, flexible-type

所以我是 python 新手，已经搜索过这个答案，但大多数回复都在我头上。我有一个这样的列表：

```
right point point 1.76999998093
right fear fear 1.62700009346
right sit sit 1.46899986267
right chord chord 1.47900009155
right speed speeed 1.71300005913
right system system 1.69799995422
right hard hard 1.4470000267
right excite excite 2.93799996376
right govern govern 1.85800004005
right record record 1.62400007248 
```

我正在尝试将列表拆分为列并找到数字的均值/总和/标准差。所以基本上我只是想把最后一个变成一个数组形式，我可以使用 np.mean、np.sum 等。数据在一个名为“正确”的文件中，这是我目前所拥有的：

```
right=open('right.txt').readlines()
for line in right: 
    l=line.split()
    righttime=l[3]
    print righttime

rightsum=np.sum(righttime)
rightmean=np.mean(righttime) 
```

然后我得到这个错误：“TypeError：不能使用灵活类型执行减少”我已经尝试了很多方法并且不断收到错误。这是我尝试过的另一种看起来很有希望的方法：

```
def TimeSum(data):
    for line in data: 
        l=line.split()
        righttime=l[3]
        print righttime
    return righttime

rightsum=np.sum(TimeSum(right)) 
```

但我有同样的错误。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T00:17:28.893

生成一个列表并对元素求和：

```
import numpy as np

right = open('right.txt').readlines()
mylist = []

for line in right:
    l = line.split()  
    mylist.append(float(l[3])) # add to list "mylist"   

rightsum = np.sum(mylist)
print rightsum 
```

或者，或者，

```
mylist = [float(line.split()[3]) for line in right] # generate numbers list
print np.sum(mylist) # sum numbers 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T23:49:53.423

您应该指定（是的，明确地）数据类型，在这种情况下，float（或 int，无论如何！）：

```
rightsum  = np.sum(float(righttime))
rightmean = np.mean(float(righttime)) 
```

请记住，您必须为 numpy.sum() 提供一个“类似数组”的结构：

```
>>>import numpy as np
>>>
>>> mylist = [1, 5, 2]
>>> a = np.asarray(mylist)
>>> a.sum()
8 
```

或者：

```
>>> np.sum([1,5,2])
8 
```

# thrift - TSimpleServer .serve() 究竟是如何工作的？

> ID：13616304
> 
> 赞同：1
> 
> 时间：2012-11-28T23:30:01.230
> 
> 标签：thrift

我正在努力提高我对使用 TSimpleServer 设置节俭服务器的基本理解。主要是关于启动/停止。

我正在使用 TSimpleServer，我理解它是简单的单线程服务器，主要用于调试。我的直接问题是这里的单线程是否意味着：

a.) 调用 TSimpleServer 会生成一个线程，该线程一次只能处理 1 个客户端连接，但同时将执行返回给调用 .serve 的主程序以继续？
或 b.) 调用 TSimpleServer.serve() 阻塞，直到服务器停止。

如果 b.)，停止服务器的机制是什么？我研究过的大部分内容都建议从不同的线程停止服务器，然后启动它的线程会导致崩溃。（请参阅：[停止 Thrift 服务器（TSimpleServer）](https://stackoverflow.com/questions/8191488/stopping-a-thrift-servertsimpleserver)）。这对我来说意味着a。）是上面的正确答案，否则某处有循环逻辑？

编辑：我设法说服自己实际上是b。但是问题仍然存在于上面引用的帖子中，即使我产生一个新线程来启动它，并且该线程阻塞，我该如何停止它？使用不同的线程似乎不是上述引用帖子的答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T16:28:50.033

在[thrift API 文档](http://people.apache.org/~jfarrell/thrift/0.7.0/javadoc/org/apache/thrift/server/TServer.html#stop%28%29 "文件")(Java) 上，您可以阅读：

> 停止服务器。这在每个实现的基础上是可选的。并非所有服务器都必须完全可停止。

TSimpleServer 用于测试。那么，有没有可能没有干净的方法呢？

# oracle - 为 Oracle VPD 连接配置 Spring 数据源

> ID：13616315
> 
> 赞同：3
> 
> 时间：2012-11-28T23:30:59.570
> 
> 标签：oracle, spring, jdbc, jdbctemplate

如果我所有的 Spring JDBCTemplate 查询都必须通过 Oracle VPD（虚拟专用数据库）连接，我将如何在 Application Context 文件中设置我的数据源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T18:48:32.797

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="oracle.jdbc.OracleDriver" />
    <property name="url" value="jdbc:oracle:thin:@xxx.xxx.com" />
    <property name="username" value="user***" />
    <property name="password" value="pass***" />
    <property name="connectionInitSqls">
        <util:list>
              <value>call PKG_RLS.SET_CONTEXT ('admin', '0', 'SET_VALUE')</value>
        </util:list>
    </property>
</bean> 
```

# java - 在java中复制多维数组

> ID：13616317
> 
> 赞同：-1
> 
> 时间：2012-11-28T23:31:03.560
> 
> 标签：java, multidimensional-array, copy, erase

在 Java 中，我们如何制作 3-D 数组的副本？问题是，当我们使用`new_array.clone()`或类似的东西时，我们将条目的地址放入另一个数组，而不是实际值。因此，当我 clear() 时`old_array`，`new_array`也是空的

```
private List<List<List<String>>> moves = new ArrayList<List<List<String>>>();
private List<List<List<String>>> moves1 = new ArrayList<List<List<String>>>();

.blah
.blah 
.blah

mid_array = new ArrayList<List<String>>();//will use this array to insert inot moves1

for(int f = 0; f < moves.size(); f++)//make a copy of original array.
{

    List<String> row_st = moves.get(f).get(0);
    List<String> deck_st = moves.get(f).get(1);

    mid_array.add(row_st);//current array of the Rows
    mid_array.add(deck_st);//current array of the Deck

    moves1.add(mid_array);

    System.out.println("Moves1 "+moves1);//displays the new array correctly

    mid_array.clear();//clear mid_array, NOT moves1 or moves arrays

    System.out.println("Moves1 "+moves1);//new array is now empty

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:40:39.097

在 Java 中，对象总是被引用，所以当你这样做时：

```
 moves1.add(mid_array); 
```

这意味着`mid_array`被添加到`moves1` 但仍被引用`mid_array`。这样，当你打电话时`mid_array.clear()`，它从两个地方都清楚。

如果您想在内部维护列表，那么最好在循环内部`moves1`创建一个新实例，例如：`mid_array``for`

```
 for(int f = 0; f < moves.size(); f++)//make a copy of original array.
 {
    List<List<String>> mid_array = new ArrayList<List<String>>();
    List<String> row_st = moves.get(f).get(0);
    List<String> deck_st = moves.get(f).get(1);

    mid_array.add(row_st);//current array of the Rows
    mid_array.add(deck_st);//current array of the Deck

    moves1.add(mid_array);

    System.out.println("Moves1 "+moves1);//displays the new array correctly

    //No need to clear as in each iteration, it will instantiate a new mid_array
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:04:03.390

这会产生一个真实的副本，包括复制所有元素。

```
public static <T> List<List<List<T>>> list3DCopy(List<List<List<T>>> source) {
    List<List<List<T>>> result = new ArrayList<>(source.size());
    Cloner cloner = new Cloner();   
    for(List<List<T>> innerList : source) {
        List<List<T>> copy = new ArrayList<>(innerList.size());
        for (List<T> innerInnerList : innerList) {
            List<T> innerCopy = new ArrayList<>(innerInnerList.size());
            for (T item : innerInnerList) {
                T clone = cloner.deepClone(item);
                innerCopy.add(clone);
            }
            copy.add(innerCopy);
        }
        result.add(copy);
    }
    return result;
} 
```

它使用[这个克隆库](http://code.google.com/p/cloning/)来复制元素。

按如下方式使用它：

```
List<List<List<YourClass>>> original = ...
List<List<List<YourClass>>> copy = list3DCopy(original); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:39:44.157

通常，您必须手动进行深层复制（除非对象支持您，否则文档会告诉您）。在这种情况下，您需要使用两个嵌套循环并克隆最底部的`ArrayList`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-28T23:47:03.420

您可以创建 ArrayList 的子类并覆盖 clone() 方法以执行深拷贝而不是浅拷贝。例如：

```
public class DeepCopyArrayList extends ArrayList
{
  public Object clone()
  {
     // implement deep copy clone here
  }
} 
```

一旦你有了这个，你只需要做

```
myArray.clone() 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-11-28T23:41:19.883

好吧，如果你愿意，你可以用丑陋的方式来做。我忘记了是否有功能可以执行此操作，但是如果您想手动执行此操作，则可以这样做。

```
 int array[10][10][10] = ...// just assume they are all filled.
    int newArray[10][10][10];
        for(int i = 0; i< 10; i++)
        {
           for(int j = 0; j< 10; j++)
           {
               for(int k = 0; k< 10; k++)
               {
                  newArray[i][j][k] = array[i][j][k];
               }
           }
        }

    array = NULL; 
```

这只是一个示例，可能不是正确的语法，但这种方式应该可行。i< 10 或其他任何一个实际上应该是 i< 数组维度的长度。

# c# - 您如何使用 c# 打开请求管理权限的对话框

> ID：13616318
> 
> 赞同：0
> 
> 时间：2012-11-28T23:31:07.843
> 
> 标签：c#

> **可能重复：**
> [如何仅在需要时提升权限？](https://stackoverflow.com/questions/573086/how-to-elevate-privileges-only-when-required)

经过大量调试，结果发现我在另一台计算机上的应用程序无法运行，因为它需要以管理权限运行（我的计算机上的所有内容都以管理员身份运行）。它没有提示他们，而是抛出了一个异常。我在我的应用程序中直接对磁盘进行扇区访问。

如何让它在需要时自动显示“以管理员身份运行”？

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:39:05.197

考虑添加应用程序清单以将所需的权限设置为管理员。请参阅此处：[如何强制我的 .NET 应用程序以管理员身份运行？](https://stackoverflow.com/questions/2818179/how-to-force-my-net-app-to-run-as-administrator-on-windows-7)

# asp.net-mvc - 剑道网格层次结构的问题

> ID：13616320
> 
> 赞同：8
> 
> 时间：2012-11-28T23:31:37.490
> 
> 标签：asp.net-mvc, kendo-ui

任何人都可以编写简单的步骤来在 kendo ui 网格（mvc）中实现层次结构。我一直在尝试他们的演示，但无法使其正常工作。非常感谢您的帮助！

我想我错过了一些东西，但这就是我正在做的事情（如[http://demos.kendoui.c​​om](http://demos.kendoui.com/web/grid/hierarchy.html) /web/grid/hierarchy.html ）

我正在将 .ClientDetailTemplateId("Grid2Template") 添加到我现有的网格中。然后我正在为上面的 Grid2Template 编写代码。

我正在做演示中显示的 100%，但无法让它与这两个步骤一起工作。有什么额外的参与吗？

这是一个非常简单的演示项目... [http://www.mediafire.com/?5qjyp40qfef7dkb](http://www.mediafire.com/?5qjyp40qfef7dkb)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T21:17:13.590

你的问题有点棘手，很难找到。转到 webconfig 并删除以下行：

```
<httpRuntime requestValidationMode="4.5" targetFramework="4.5" encoderType="System.Web.Security.AntiXss.AntiXssEncoder, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

此编码器 AntiXSS 破坏了客户端模板，并且 Grid 无法显示详细模板。

进行此更改后，该项目应该可以正常运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T03:26:40.640

很抱歉迟到了。无需移除 AntiXss 编码器。只需解码 Kendo 吐出的字符串并将其原始显示在您的视图中。

所以而不是：

```
@(Html.Kendo().TabStrip().Items(…).ToClientTemplate()) 
```

做这个：

```
@Html.Raw(HttpUtility.HtmlDecode(Html.Kendo().TabStrip().Items(…).ToClientTemplate().ToString())) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-06T20:53:50.477

**更新：**仅供参考 Telerik 已将我的解决方案包含在 2014 年第一季度的 Kendo UI MVC 中，因此如果您使用较新的位，则不再需要这些“解决方案”。

* * *

取出 AntiXssEncoder 绝对是个坏消息，你不应该这样做。我尝试使用 Jportelas 和 Marcelo 的答案，但他们仍然没有完全解决问题。在处理必填字段时，Kendo 和 MVC 将必填字段验证器注入到 javascript 中，其中的空格以完全不同的方式编码（它使用转义的 UTF-8 字符串表示＆符号，然后是 html 字符代码磅符号。它们一起代表一个空间。很糟糕，对吧？！？）

[我创建了一个 Gist](https://gist.github.com/advancedrei/5724537)，展示了如何解决任何控件的问题，而不仅仅是 Kendo UI。我还要求 Telerik 在下一个版本中包含该解决方案……请随时这样做。

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-31T19:57:48.900

我的一位聪明的同事发现了类似的东西，他发现在客户端模板生成的字符串中被“”替换的空格，所以他正在这样做并且它有效：

```
@Html.Raw((Html.Kendo().Grid<..>...ToClientTemplate()..ToHtmlString().Replace("&#32;", " "))) 
```

我们不想禁用 AntiXSS，因为这就像放下防御一样。

# c# - 如何在 PartitionKey 中使用单引号查询 Azure 表存储

> ID：13616323
> 
> 赞同：8
> 
> 时间：2012-11-28T23:31:50.890
> 
> 标签：c#, azure, urlencode, azure-table-storage

我正在将一些代码从较旧的 azure 表存储客户端迁移到最新版本，并遇到了一个让我很难过的问题：如果没有收到 400 错误请求，我似乎无法在分区键中发送带有单引号的查询。例如：

```
public class TestEntity : TableEntity
{
    public string TestProperty { get; set; }
}

public class StorageTester
{
    public static void TestInsert()
    {
        CloudStorageAccount acct = CloudStorageAccount.DevelopmentStorageAccount;
        CloudTableClient client = acct.CreateCloudTableClient();
        CloudTable table = client.GetTableReference("testtable");
        table.CreateIfNotExists();

        // insert a test entity -- this works fine
        TestEntity entity = new TestEntity();
        entity.PartitionKey = "what's up";
        entity.RowKey = "blah";
        entity.TestProperty = "some dataz";

        TableOperation op = TableOperation.Insert(entity);
        table.Execute(op);

        // now query the entity -- explicit query constructed for clarity
        string partitionFilter = TableQuery.GenerateFilterCondition("PartitionKey", QueryComparisons.Equal, "what's up");
        string rowFilter = TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.Equal, "blah");
        string finalFilter = TableQuery.CombineFilters(partitionFilter, TableOperators.And, rowFilter);

        TableQuery<TestEntity> query = new TableQuery<TestEntity>().Where(finalFilter);

        // THIS THROWS 400 ERROR, does not properly encode partition key
        var entities = table.ExecuteQuery(query, new TableRequestOptions { RetryPolicy = new NoRetry() });
        entity = entities.FirstOrDefault();

    }
} 
```

我已经尝试了一切......我尝试显式设置 TableQuery 的 FilterString 属性，但它在设置该属性后执行 URL 编码，所以如果我用 %27 替换单引号，% 会被双重转义。

有没有人有一种解决方法可以让我使用新的表存储库而不回退到旧的 StorageClient 库？请注意，我在现有数据库中已经有很多数据，因此像“不要在查询中使用单引号”这样的解决方案绝对是最后的手段，因为它需要扫描和更新每个现有表中的每条记录-- 我想避免的维护任务。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T00:06:12.660

您需要转义单引号，但仅在过滤时（通过在原始单引号前添加单引号）：

```
string partitionFilter = TableQuery.GenerateFilterCondition("PartitionKey", 
          QueryComparisons.Equal, "what''s up"); 
```

这是因为`GenerateFilterCondition`并将`CombineFilters`过滤器转换为简单的字符串（OData 格式）：

```
(PartitionKey eq 'what''s up') and (RowKey eq 'blah') 
```

使用过滤器的更安全的方法是这样的：

```
string partitionFilter = TableQuery.GenerateFilterCondition("PartitionKey", 
          QueryComparisons.Equal, partitionKey.Replace("'", "''")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-10T23:20:18.310

我使用的是[Windows Azure Storage 7.0.0](https://www.nuget.org/packages/WindowsAzure.Storage/)，您可以使用 Linq 查询，这样您就不必转义单引号：

```
// Get the cloudtable ...
var table = GetCloudTable();

// Create a query: in this example I use the DynamicTableEntity class
var query = cloudTable.CreateQuery<TestEntity>()
    .Where(d => d.PartitionKey == "what's up" && d.RowKey == "blah");

var entities = query.ToList(); 
```

如果您检查该`query.FilterString`属性，您可以看到单引号已被转义：

> “（PartitionKey eq 'what's up'）和（RowKey eq 'blah'）”

# php - FILTER_SANITIZE_URL，保留空格？

> ID：13616328
> 
> 赞同：4
> 
> 时间：2012-11-28T23:32:09.633
> 
> 标签：php

据我了解，在获取 ( `$_GET`) url 后，%20 已经转换为空格。因此，如果我随后使用该`filter_var($url, FILTER_SANITIZE_URL)`函数，它将删除已转换的空格。

我该如何解决这个问题，并且仍然使用上述功能？

还是我应该只使用`str_replace()`？尽管这似乎与`filter_var($url, FILTER_SANITIZE_URL)`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:44:05.067

您可以在调用 filter_var 之前使用 urlencode($url)。

你为什么要过滤 $url？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:45:58.053

所以我假设在这种情况下，它`$url`是直接从`$_GET['url']`（或一些或查询字符串参数）派生的，在使用 in 之前没有任何其他修改`filter_var`？

如果这些 URL 中包含空格，您可能希望直接使用`$_SERVER['QUERY_STRING']`. 当然，这意味着您需要手动解析出您正在寻找的参数（也许使用`explode('&')`- 不要使用`parse_str()`，因为它会执行相同的转换`$_GET()`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-15T00:43:39.017

继续使用 FILTER_SANITIZE_URL 保留空格的一种方法是，首先用两个不太可能相邻出现的允许字符替换空格，然后将它们替换回空格。

例如

```
str_replace('\/', ' ', filter_var(str_replace(' ', '\/', $url), FILTER_SANITIZE_URL)); 
```

注意：不完全确定`\/`是最佳人选。但我已经在安全的环境中使用了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-06T07:19:45.923

`%20`URL 中的s***不应***转换为空格，因为它们是原始值的一部分。如果它们正在被解码，则意味着您在 URL 中的传输过程中未能正确*编码该值。*

您要在 URL 中传输的值：

```
My string with spaces & special characters 
```

在 URL 中，必须将其编码为：

```
My%20string%20with%20spaces%20%26%20special%20characters 
```

最终网址：

```
http://example.com?foo=My%20string%20with%20spaces%20%26%20special%20characters 
```

这是您要作为 URL 中的查询参数传输的值。这意味着您需要将*其*正确编码为：

```
http%3A%2F%2Fexample.com%3Ffoo%3DMy%2520string%2520with%2520spaces%2520%2526%2520special%2520characters 
```

最终到达网址：

```
http://my-service.example.com?url=http%3A%2F%2Fexample.com%3Ffoo%3DMy%2520string%2520with%2520spaces%2520%2526%2520special%2520characters 
```

PHP 将对其进行*一次*解码，然后`$_GET['url']`您会发现：

```
http://example.com?foo=My%20string%20with%20spaces%20%26%20special%20characters 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-06T07:11:58.500

这相当于`FILTER_SANITIZE_URL`加一个空格：

```
$value = preg_replace("/[^\x20-\x7E]/", "", $value); 
```

# qt - 如何在 PyQt 中的自定义 Qt.ItemFlags 实例中找到特定的 Qt.ItemFlag 出现？

> ID：13616329
> 
> 赞同：11
> 
> 时间：2012-11-28T23:32:08.923
> 
> 标签：qt, pyqt, pyqt4

我有一个[QTreeWidget](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/qtreewidget.html)和[QTreeWidgetItems](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/qtreewidgetitem.html)。方法[QTreeWidgetItem.flags()](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qtreewidgetitem.html#flags)返回[Qt.ItemFlags](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt-itemflags.html)实例。

> Qt.ItemFlags类型是 QFlags 的 typedef [。](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt-itemflags.html)[它存储ItemFlag](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt.html#ItemFlag-enum)值的 OR 组合。

好吧，假设现在我有我的[QTreeWidgetItems](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/qtreewidgetitem.html)之一，我需要找出 - 它是否可以检查？换句话说，我需要在[Qt.ItemFlags实例中找到出现的](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt-itemflags.html)[ItemFlag](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt.html#ItemFlag-enum)（就我而言，它是[Qt.ItemIsUserCheckable](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qt.html#ItemFlag-enum)）。

怎么做？

这是一个简单而整洁的示例，您可以对其进行修改（感兴趣的部分由注释行标记）：

```
import sys
from PyQt4 import QtCore, QtGui

class Window(QtGui.QWidget):

    def __init__(self):
        QtGui.QWidget.__init__(self)
        self.treeWidget = QtGui.QTreeWidget()
        self.treeWidget.setHeaderHidden(True)
        self.addItems(self.treeWidget.invisibleRootItem())
        self.treeWidget.itemClicked.connect (self.handleClicked)
        layout = QtGui.QVBoxLayout()
        layout.addWidget(self.treeWidget)
        self.setLayout(layout)

    def addItems(self, parent):
        column = 0

        clients_item = QtGui.QTreeWidgetItem(parent, ['Clients'])
        clients_item.setData(column, QtCore.Qt.UserRole, 'data Clients')
        clients_item.setExpanded(True)

        item_1 = QtGui.QTreeWidgetItem(clients_item, ['Item 1'])
        item_1.setData(column, QtCore.Qt.UserRole, 'data Item 1')
        item_1.setCheckState(column, QtCore.Qt.Unchecked)

        item_2 = QtGui.QTreeWidgetItem(clients_item, ['Item 2'])
        item_2.setData(column, QtCore.Qt.UserRole, 'data Item 2')
        item_2.setCheckState(column, QtCore.Qt.Unchecked)

    def handleClicked(self, item, column):
        if item.checkState(column) == QtCore.Qt.Checked:
            print "checked", item, item.text(column)
        if item.checkState(column) == QtCore.Qt.Unchecked:
            print "NOT checked", item, item.text(column)

        # this part doesn't work ===============================
        # begin of part
        flags = item.flags()
        if QtCore.Qt.ItemIsUserCheckable in flags:
            print "is checkable", item, item.text(column)
        else:
            print "is NOT checkable", item, item.text(column)
        # end of part ==========================================    

if __name__ == "__main__":

    app = QtGui.QApplication(sys.argv)
    window = Window()
    window.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-28T23:44:47.100

像 Qt 中的许多“标志”和“属性”一样，`ItemFlags`使用位掩码将多个选项组合成一个值。这可以使用按位运算符进行测试。

以下是检查项目是否可检查的方法：

```
flags = item.flags()
if flags & QtCore.Qt.ItemIsUserCheckable:
    print "is checkable", item, item.text(column) 
```

[位掩码](http://en.wikipedia.org/wiki/Mask_%28computing%29)

它是这样工作的：

```
Qt.NoItemFlags          0   It does not have any properties set.
Qt.ItemIsSelectable     1   It can be selected.
Qt.ItemIsEditable       2   It can be edited.
Qt.ItemIsDragEnabled    4   It can be dragged.
Qt.ItemIsDropEnabled    8   It can be used as a drop target.
Qt.ItemIsUserCheckable  16  It can be checked or unchecked by the user.
Qt.ItemIsEnabled        32  The user can interact with the item.
Qt.ItemIsTristate       64  The item is checkable with three separate states. 
```

因此，该值将是这些值的某种组合。可以说它是可选的、可编辑的和启用的。为简单起见，我将只使用数值而不是标志。我们将它们与逻辑 OR 结合起来：

```
flags = 1 | 2 | 32
# 35 
```

为了测试值的存在，我们使用逻辑 AND：

```
# is it editable?
flags & 2
# 2 # would evaluate to True

# is it checkable?
flags & 16
# 0 # would evaluate to False 
```

您还可以使用 XOR 操作来切换 mak 中的标志状态。

```
# toggle off the editable flag
flags ^= 2
# toggle on the editable flag
flags ^= 2 
```

# c# - C# - AdjustTokenPrivileges 不适用于 32 位

> ID：13616330
> 
> 赞同：6
> 
> 时间：2012-11-28T23:32:11.417
> 
> 标签：c#, .net, pinvoke, 32bit-64bit, privileges

我正在尝试在我的 .NET 4 C# 应用程序中获得特权。此代码有效并成功获得特权，但仅限于 64 位系统。当相同的代码在 32 位系统上运行时，代码在 AdjustTokenPrivileges 处失败，并出现以下异常：

对内存位置的无效访问。（来自 HRESULT 的异常：0x800703E6）

我试过修改代码来解决这个问题，但没有任何效果，我很困惑。

关于为什么在 32 位系统上失败的任何想法？它在 Windows Vista 和 7 32 位上都失败了，所以这是一个 32 位特定的问题。

方法：

```
 public static void EnableDisablePrivilege(string PrivilegeName, bool EnableDisable)
    {
        var htok = IntPtr.Zero;
        if (!OpenProcessToken(Process.GetCurrentProcess().Handle, TokenAccessLevels.AdjustPrivileges | TokenAccessLevels.Query, out htok))
        {
            Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());
            return;
        }
        var tkp = new TOKEN_PRIVILEGES { PrivilegeCount = 1, Privileges = new LUID_AND_ATTRIBUTES[1] };
        LUID luid;
        if (!LookupPrivilegeValue(null, PrivilegeName, out luid))
        {
            Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());
            return;
        }
        tkp.Privileges[0].LUID = luid;
        tkp.Privileges[0].Attributes = (uint)(EnableDisable ? 2 : 0);
        TOKEN_PRIVILEGES prv;
        uint rb;
        if (!AdjustTokenPrivileges(htok, false, tkp, 256, out prv, out rb))
        {
            Marshal.ThrowExceptionForHR(Marshal.GetHRForLastWin32Error());
            return;
        }
    } 
```

执行：

```
EnableDisablePrivilege("SeManageVolumePrivilege", true); 
```

PInvoke 声明：

```
 [StructLayout(LayoutKind.Sequential)]
    public struct LUID
    {
        private uint lp;
        private int hp;

        public uint LowPart
        {
            get { return lp; }
            set { lp = value; }
        }

        public int HighPart
        {
            get { return hp; }
            set { hp = value; }
        }
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct LUID_AND_ATTRIBUTES
    {
        private LUID luid;
        private uint attributes;

        public LUID LUID
        {
            get { return luid; }
            set { luid = value; }
        }

        public uint Attributes
        {
            get { return attributes; }
            set { attributes = value; }
        }
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct TOKEN_PRIVILEGES
    {
        private uint prvct;
        [MarshalAs(UnmanagedType.SafeArray, SizeConst = 1)]
        private LUID_AND_ATTRIBUTES[] privileges;

        public uint PrivilegeCount
        {
            get { return prvct; }
            set { prvct = value; }
        }

        public LUID_AND_ATTRIBUTES[] Privileges
        {
            get { return privileges; }
            set { privileges = value; }
        }
    }

    [DllImport("advapi32", SetLastError = true)]
    public static extern bool OpenProcessToken(IntPtr ProcessHandle, TokenAccessLevels DesiredAccess, out IntPtr TokenHandle);

    [DllImport("advapi32.dll", SetLastError = true)]
    public static extern bool AdjustTokenPrivileges(IntPtr TokenHandle, bool DisableAllPrivileges, TOKEN_PRIVILEGES NewState, uint BufferLength, out TOKEN_PRIVILEGES PreviousState, out uint ReturnLength);

    [DllImport("advapi32.dll", SetLastError = true)]
    public static extern bool LookupPrivilegeValue(string lpSystemName, string lpName, out LUID lpLuid); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T03:55:07.127

已修复，只需在 NewState 之前添加一个 ref：

```
 [DllImport("advapi32.dll", SetLastError = true)]
    public static extern bool AdjustTokenPrivileges(IntPtr TokenHandle, bool DisableAllPrivileges, ref TOKEN_PRIVILEGES NewState, uint Bufferlength, IntPtr PreviousState, IntPtr ReturnLength); 
```

# python - 获取当前版本的网页

> ID：13616340
> 
> 赞同：1
> 
> 时间：2012-11-28T23:33:26.433
> 
> 标签：python, linux, caching, wget

如何在 Wget 或 Python 中获取网页的当前版本？我需要完全关闭缓存。

我正在尝试编写代码以每秒下载[http://robocademy.com/courses/arduino/get_code/ 。](http://robocademy.com/courses/arduino/get_code/)使用 Python 的 urllib 和 Wget，我无法像在 Chrome 中那样获取当前文件。我试过了

```
wget --cache=off --user-agent="Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)" http://robocademy.com/courses/arduino/get_code/ 
```

和 urllib 与 urllib.urlcleanup

chrome中的响应标头：

```
Accept-Ranges:bytes
Age:0
Connection:keep-alive
Content-Encoding:gzip
Content-Length:449
Content-Type:text/plain
Date:Wed, 28 Nov 2012 23:20:24 GMT
Server:nginx
Vary:Accept-Encoding
Via:1.1 varnish
X-Varnish:400211059 
```

Wget 中的响应标头

```
HTTP/1.1 200 OK
Server: nginx
Content-Type: text/plain
Keep-Alive: timeout=20
Vary: Accept-Encoding
Transfer-Encoding: chunked
Date: Wed, 28 Nov 2012 23:22:20 GMT
X-Varnish: 400216320 400212892
Age: 76
Via: 1.1 varnish
Connection: keep-alive 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-28T23:48:11.030

您可以尝试添加`--no-cache`到 wget。根据手册：

> 禁用服务器端缓存。在这种情况下，Wget 将向远程服务器发送一个适当的指令（'Pragma: no-cache'）以从远程服务获取文件，而不是返回缓存的版本。这对于检索和刷新代理服务器上的过期文档特别有用。
> 
> 默认情况下允许缓存。

`cache=off`应该进入`wgetrc`文件。

对于 Python，您可以考虑这个[答案](https://stackoverflow.com/a/6757251/1247955)。

# internet-explorer - 列表项垂直对齐不适用于 IE 7 8 或 9

> ID：13616344
> 
> 赞同：2
> 
> 时间：2012-11-28T23:33:43.213
> 
> 标签：internet-explorer, alignment, html-lists, vertical-alignment, css

我做了一些研究并尝试了一些方法，但似乎对 IE 没有任何效果。

我有一个垂直列表样式菜单。例子是

```
<ul class="menuleft">
<li><a href="index.php" >Home</a></li>
<li><a href="maritime-marinas.php" >Maritime Marinas</a></li>
</ul> 
```

我的 CSS 是

```
ul.menuleft {list-style-type: none; margin:0; padding:0;}
.menuleft li {
    width:248px;
    height:47px;
    background-image:url(images/left-menu-bg-off.png);
    background-repeat: no-repeat;
    margin: 0px;
    padding: 0px;
   line-height:47px;
    text-align: left;
    text-indent: 60px;

   }

.menuleft {text-decoration: none; font-family:Arial Narrow, Arial; color:#FFFFFF; text-shadow: 1px 1px 1px #052f5b; font-size:18px;}
.menuleft a:link {text-decoration: none; font-family:Arial Narrow, Arial; color:#FFFFFF; text-shadow: 1px 1px 1px #052f5b; font-size:18px;}
.menuleft a:visited {text-decoration: none; font-family:Arial Narrow, Arial; color:#FFFFFF; text-shadow: 1px 1px 1px #052f5b; font-size:18px;}
.menuleft a:hover {text-decoration: underline; font-family:Arial Narrow, Arial; color:#FFFFFF; text-shadow: 1px 1px 1px #052f5b; font-size:18px;}
.menuleft a:active {text-decoration: none; font-family:Arial Narrow, Arial; color:#FFFFFF; text-shadow: 1px 1px 1px #052f5b; font-size:18px;} 
```

文本垂直居中非常适合 Firefox、Safari 和 Chrome。但不是 IE 7 8 或 9（也不是 Opera）

请帮忙。谢谢

# jdbc - 从结果集中获取信息同时

> ID：13616345
> 
> 赞同：0
> 
> 时间：2012-11-28T23:33:45.913
> 
> 标签：jdbc

我为我的班级创建了一个名为 amazon 的项目数据库。在这份报告中，我想展示从最畅销的产品到最后售出的产品。我想获得销量最高的产品，并展示所有购买和展示它们的客户，以及他们的电子邮件和他们购买该产品的数量。好的，我可以完全展示最畅销的产品。而且我知道如何获得第一行（如果两个或更多产品的销售数量相同，我会遇到问题），但我不能只从结果集中的第一个表中获取标题，同时制作另一个查询：/谁能帮我解决这个问题？

```
void report2 (Connection conn) 
        throws SQLException, IOException {

String query0 = "select title, SUM (quantityb) AS total from product,buy where id = idb group by title order by total DESC";

String title,title2,name,email,t;
int quan,quanp;

Statement stmt = conn.createStatement (); 
ResultSet rset0;

System.out.print("\n\n************************************MOST POPULAR PRODUCTS************************************\n");

System.out.print("         TITLE OF THE PRODUCT                                                TOTAL PURCHASED\n"+
         "--------------------------------------------                            -------------------------\n");

try {
rset0 = stmt.executeQuery(query0);
   } catch (SQLException e) {
    System.out.println("Problem reading purchases");
    while (e != null) {
    System.out.println("Message     : " + e.getMessage());
    e = e.getNextException();
    }
    return;
}
while (rset0.next())
{

    title = rset0.getString(1);
    quan = rset0.getInt(2);

    System.out.printf("%-108s   %-3d \n ",title,quan);
}

PreparedStatement statement = conn.prepareStatement(query0);
statement.setMaxRows(1);
ResultSet rset1 = statement.executeQuery();
while (rset0.next())
{

  title2= rset1.getString(1);

}

   String query2 = "select  
   String query1 = "Select fname,email,quantityb"+
                  "from custumer,product,buy"+
                  "where email = emailb"+
                  "and id = idb"+
                  "and title ='"+title2+"'";

System.out.print("..............................Who Purchased the most popular product.............................\n");

System.out.print("PRODUCT:"+title2+"\n\n");
System.out.print("     FIRST NAME                      EMAIL                 QUANTITY\n"+
         "---------------------    -----------------------------  ------------------\n");

ResultSet rset2;

try {
rset2= stmt.executeQuery(query1);

} catch (SQLException e) {
    System.out.println("Problem reading people");
    while (e != null) {
    System.out.println("Message     : " + e.getMessage());
    e = e.getNextException();
    }
    return;
}

while (rset2.next())
{

   name=rset2.getString(1);
   email=rset2.getString(2);
   quanp=rset2.getInt(3);

    System.out.printf("%-8s \t\t\t%-25s\t\t\t %3d \n ",name,email,quanp);
}

stmt.close();
} 
```

结果

commerce.java:405: 变量 title2 可能没有被初始化 "and title ='"+title2+"'"; ^ 1 个错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:09:24.903

这似乎是一个家庭作业或练习。

```
variable title2 might not have been initialized 
```

是因为您还没有初始化任何字符串变量，包括`title2`

改变

`String title,title2,name,email,t;` 至

`String title="", title2="", name="", email="", t="";`.

第二，

```
String query2 = "select 
```

这是不完整的，它应该是带有结束引号和分号的有意义的值。

喜欢`String query2 = "select * from tblName";`

在旁注中，
始终提供问题的完整错误堆栈。

# facebook - Facebook 有时不会通过签名请求

> ID：13616347
> 
> 赞同：0
> 
> 时间：2012-11-28T23:33:59.917
> 
> 标签：facebook, node.js, express, facebook-javascript-sdk, facebook-node-sdk

我有一个使用 Node JS 和 Express 开发的 Facebook Pagetab 应用程序。它似乎在大多数情况下都可以正常工作，但有时却不行。我在复制问题时遇到问题，因此很难调试，但我认为我已经找到了问题所在。

当主页加载时，我利用 Thuzi 的 Facebook 模块 ( [https://github.com/Thuzi/facebook-node-sdk](https://github.com/Thuzi/facebook-node-sdk) ) 筛选 Facebook 传递给我的签名请求，以确定用户是否喜欢该页面：

```
var fb = require('fb');
var signedRequest  = fb.parseSignedRequest(req.body.signed_request, process.env.FACEBOOK_APP_SECRET);   

if(signedRequest ){
    if( signedRequest.page.liked){
        res.redirect('/authorise');                         
    }
    else {
        res.redirect('/gate');
    }
}
else {
    console.log('No signed request');
} 
```

但是，有时会向控制台发送“未签名请求”，因此基本上 Facebook 有时不会传递已签名请求。因此，用户只是被显示为一个空白屏幕。如果我使用代码重定向到主页，它只会陷入无限循环。我需要签名的请求才能相应地重定向用户。Facebook 有时不会向我发送签名请求是否有任何原因？

如果我检查 req.body.signed_request 的内容，它有时是空的，所以好像 fb 模块没有正常工作。

# xml - 如何使用 xslt 删除最外层的包装？

> ID：13616348
> 
> 赞同：2
> 
> 时间：2012-11-28T23:33:59.123
> 
> 标签：xml, xslt

示例 xml 是：

```
<a amp="a"><b><c>this is the text</c></b></a> 
```

需要转化为：

```
<a amp="a"><c>this is the text</c></a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T01:02:22.307

**解决方案#1：对****smaccoun**的解决方案进行轻微改进，该解决方案将保留`c`元素上的任何属性（例如 XML 不是必需的）：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="c">
        <xsl:copy-of select="." />
    </xsl:template>
</xsl:stylesheet> 
```

**解决方案#2**另一种利用**[内置模板规则](http://www.w3.org/TR/xslt#built-in-rule)**的替代方案，它为所有元素应用模板并复制所有`text()`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <!--identity template for the c element, it's decendant nodes, 
        and attributes (which will only get applied from c or 
        descendant elements)-->
    <xsl:template match="@*|c//node()|c">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

**解决方案#3：**修改后的**[身份转换：](http://en.wikipedia.org/wiki/Identity_transform)**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <!--identity template, copies all content by default-->
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <!--don't generate content for these matched elements, 
        just apply-templates to it's children-->
    <xsl:template match="a|b">
        <xsl:apply-templates/>
    </xsl:template>     
</xsl:stylesheet> 
```

**解决方案 #4**如果您知道自己想要什么，只需从根节点上的匹配项中复制它

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <xsl:copy-of select="a/b/c" />
    </xsl:template>
</xsl:stylesheet> 
```

* * *

如果您只想`<b>`从输入中删除元素，则应使用修改后的身份转换与模板匹配的`<b>`元素，该元素仅将模板应用于其子元素。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <!--identity template, copies all content by default-->
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <!--don't generate content for the <b>, just apply-templates to it's children-->
    <xsl:template match="b">
        <xsl:apply-templates/>
    </xsl:template>     
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:09:17.733

应用模板`<c>`，然后使用复制设计模式。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match='c'>
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

# parse-platform - parse.com 类中的关系数据

> ID：13616349
> 
> 赞同：0
> 
> 时间：2012-11-28T23:34:03.250
> 
> 标签：parse-platform

我有两个表（类）：

1.  StudentInformation：包含 METNumber、地址、年级、姓名、学校等列
2.  Behaviour15Min：包含 METNumber、onTaskMinutes、percentOnTask、percentOffTask 列

这两个表显然也包含自动生成的 objectId、createdAt 和 updatedAt 列

不知道如何弄清楚这其中的关系。我想做的是让我的上一个活动从上一个活动中接收 METNumber，并查询给定 METNumber 的类。问题是，METNumber 仅在 StudentInformation 类中是唯一的。

我尝试按创建日期排序查询，但我总是以第二个最新对象而不是最新对象结束......所以这不起作用。无法找到获取自动生成的 objectId 的方法，因为我没有提供它，它是在服务器端生成的。

然后我尝试使用他们的关系模型，但是当我这样做时（比如说我得到了我的测试分数，它完全填充了 Behaviour15Min 中的每一列，并使用他们的模型将 METNum 添加到学生信息类中），我最终得到了一个条目我的 SI 类具有除 METNumber 之外的所有空列。然后这不是唯一的。

底线：我到底如何从两个表/类中查询信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T11:46:29.120

您是否尝试过在两个 PFQuery 之间使用 MatcheQuery 方法？试试看这个例子......通过这个你可以创建两个查询并将它们合并到 PFObject 胖饭可能会延迟来自不同的数据（因此来自不同的类......）试试看，让我知道

[https://parse.com/docs/ios_guide#queries-relational/iOS](https://parse.com/docs/ios_guide#queries-relational/iOS)

# javascript - javascript中的3级引号

> ID：13616350
> 
> 赞同：0
> 
> 时间：2012-11-28T23:34:30.873
> 
> 标签：javascript, jquery, asp.net-mvc, razor

在我的 MVC 应用程序中，我有一段 javscript 将一行附加到表中。该行是使用 javascript (jquery) 附加的。添加的字符串也包含一些特定于 mvc 的代码。我无法正确获取引号和转义符。我尝试了几种不同的组合，这就是我所拥有的：

```
var row = $("<tr><td><input type='hidden' name='LocationArray' value='"
 + CellValue + "'>" + CellText +
 "</td><td class='delete' >" +
 "<img src='@Url.Content(\"~/Content/images/delete_x.png\")' /></td></tr>"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T23:38:06.797

我认为您不想转义 Razor 字符串：

```
@Url.Content("~/Content/images/delete_x.png") 
```

请记住，首先解析 Razor 语法。这使得发生了什么更清楚：

```
@{ var url = Url.Content("~/Content/images/delete_x.png"); }

var row = $("<tr><td><input type='hidden' name='LocationArray' value='"
    + CellValue + "'>" + CellText +
    "</td><td class='delete' >" +
    "<img src='@url' /></td></tr>"); 
```

* * *

脚注：一旦你达到了这种动态 HTML 构造水平，可能是时候考虑使用客户端模板库（Underscore、Mustache、$.tmpl 等）了。使用[下划线](http://underscorejs.org/)：

```
<script type='text/template' id='the-template'>
    <tr>
        <td>
            <input type='hidden' name='LocationArray' value='<%= val %>' />
            <%= text %>
        </td>
        <td class='delete' >
           <img src='@Url.Content("~/Content/images/delete_x.png");' />
        </td>
   </tr>
</script>

<script>
    var tmpl = _.template($("#the-template").html());
    var data = { val: "hello", text: "world" };
    var html = tmpl(data);
    $("#target").html(html);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:45:03.240

这就是为什么您应该使用 jquery 构建元素的原因。

```
var el = $("<tr>")
  .append($("<td>")
    .append($("<input>")
    .attr({type: "hidden", name: "LocationArray"})
    .val(CellValue)
    .text(CellText)
  )
) 
```

等等等等。你想要完成的工作更加清晰，你将能够捕捉错误并使更改变得更加容易。

# foursquare - Foursquare Venue Api：生成“8/10 人喜欢这个地方”的信息

> ID：13616351
> 
> 赞同：1
> 
> 时间：2012-11-28T23:34:33.650
> 
> 标签：foursquare

在查看 FourSquare 页面（例如：[Place Vendome, Paris](https://foursquare.com/v/place-vend%C3%B4me/4adcda09f964a5200e3421e3)）时，会显示文本：“9.4/10 人喜欢这个地方”。我想通过 Foursquare api 获取这些信息。我猜这是计算：`likes/(likes + dislikes)`. 一切都很好，但虽然`nr of likes`可用`nr of dislikes`似乎并不可用。（顺便看看场地 Api，这似乎是合乎逻辑的）

我在看什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T03:34:22.477

9.4/10 评级是根据一种算法计算得出的，该算法包括喜欢/不喜欢之外的各种信号。您可以使用场所/详细信息端点来获取评分的数值。

# iphone - 如何在 iOS 中获取信号条

> ID：13616361
> 
> 赞同：1
> 
> 时间：2012-11-28T23:35:49.757
> 
> 标签：iphone, objective-c, ios, ios4

如何在 iOS 上获取信号条？我读过这是不可能的，但应用商店中有一个名为 Signals 的应用，它完全符合我的要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:14:24.310

你不能（至少不能使用公共 API）。该应用程序 Signals 已超过 2 年没有更新。我刚刚尝试了该应用程序，它似乎无法获取我的信号数据。也许曾经有一个 API 可以抓取后来 SDK 中不再可用的信号。不管怎样，据我所知，没有办法可靠地获取信号数据。

我猜想伪造它的一种方法是 ping 一个可靠的服务器（例如谷歌）并计算出当你有各自的酒吧时的往返时间。

# c# - 来自另一个类的列表框计数项目始终返回 0

> ID：13616363
> 
> 赞同：4
> 
> 时间：2012-11-28T23:35:56.523
> 
> 标签：c#, winforms, c#-4.0, listbox

```
 Frm Form1 = new Frm();
                //here I always get the count =0
            if (Form1 .listBox2 .SelectedItems .Count  > 0)
            {
                string item;
                foreach (int i in Form1.listBox2.SelectedIndices)
                {
                    item = Form1.listBox2.Items[i].ToString(); 
```

当我在 Frm 中做同样的事情时，我得到了所选项目的真实数量，这是 Frm 中的代码

```
 public  void btnPostText_Click(object sender, EventArgs e)
    {
        listBox2.ClearSelected();
        if (listBox1.SelectedItems.Count > 0)
        {
            foreach (int index in listBox1.SelectedIndices)
                listBox2.SetSelected(index, true);
        } 
```

从我的程序中，我尝试在登录过程后同时在 facebook 上发布多个群组，用户在 listBox2 的 litBox1 选择他/她想要发布到的群组名称，其中有群组 ID相同的顺序，所以当用户单击 btnPostText 时，我将选择从 listBox1 移动到 listBox2' ，，，现在在 Class2` 我想知道是否在 listBox2 中选择了任何项目，第一个代码在 Class2 中。PostImg public static bool PostImg( , , ,)

Class2 包含 post 过程，就像 Postimg 一样，如果已发布，则返回 true，否则返回 false

在这里我用 Frm 调用它

```
 if (Class2.PostImage(AppSettings.Default.AccessToken, textbox1.Text, textboxpic.Text) == true)
                MessageBox.Show("Post Done"); 
```

Class2 中的代码是

```
 public static bool PostImage(string AccessToken, string Status, string ImagePath) 
    {
        try
        {
            Frm Frm = new Frm();

            if (Frm .listBox2 .SelectedItems .Count  > 0)
            {
                string item;
                foreach (int i in Frm.listBox2.SelectedIndices)
                {
                    item = Frm.listBox2.Items[i].ToString();
                    groupid = item;

                    FacebookClient fbpost = new FacebookClient(AccessToken);
                    var imgstream = File.OpenRead(ImagePath);
                    dynamic res = fbpost.Post("/" + groupid + "/photos", new
                   {
                       message = Status,
                       File = new FacebookMediaStream
                       {

                           ContentType = "image/jpg",
                           FileName = Path.GetFileName(ImagePath)
                       }.SetValue(imgstream)

                   });

                    result = true;

                }
            }
            return result;
        }
        catch (Exception ex)
        {
            System.Windows.Forms.MessageBox.Show(ex.Message);
            return false;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:36:01.813

First things first, some basics. `Class2` and `Frm` are two distinct classes. *Normally* they cannot see each other unless you pass a reference between them.

`Frm` can see the `PostImage` method inside Class2 because it was marked as `static`. But it doesn't go the other way. So you need to pass a reference to `Frm` when you call `PostImage`. Easiest way of doing this is including it in the method signature:

```
public static bool PostImage(string AccessToken, string Status, string ImagePath, Frm MyForm) 
```

Now you call it:

```
if (Class2.PostImage(AppSettings.Default.AccessToken, textbox1.Text, textboxpic.Text, this) == true) 
```

Notice how we passed `this` as a parameter in the function. This is the reference we are going to use inside `PostImage`:

```
if (MyForm.listBox2.SelectedItems .Count  > 0) 
```

And so on and so forth. The variable `MyForm` is now a reference to the form that called `Class2.PostImage`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:32:30.140

Then you should pass reference to your form (or listBox) as a parameter of the `PostImg` method.

```
public static bool PostImg(Frm form, string AccessToken, string Status, string ImagePath )
{
    try
    {
        if (form.listBox2.SelectedItems.Count  > 0)
        {
            string item;
            foreach (int i in form.listBox2.SelectedIndices)
            {
                item = form.listBox2.Items[i].ToString();
                groupid = item;

                FacebookClient fbpost = new FacebookClient(AccessToken);
                var imgstream = File.OpenRead(ImagePath);
                dynamic res = fbpost.Post("/" + groupid + "/photos", new
               {
                   message = Status,
                   File = new FacebookMediaStream
                   {

                       ContentType = "image/jpg",
                       FileName = Path.GetFileName(ImagePath)
                   }.SetValue(imgstream)

               });

                result = true;

            }
        }
        return result;
    }
    catch (Exception ex)
    {
        System.Windows.Forms.MessageBox.Show(ex.Message);
        return false;
    }
} 
```

And call it from the method in your form like this:

```
if (Class2.PostImage(this, AppSettings.Default.AccessToken, textbox1.Text, textboxpic.Text) == true)
                MessageBox.Show("Post Done"); 
```

# websocket - 使用 comet / websockets 的聊天服务器

> ID：13616365
> 
> 赞同：1
> 
> 时间：2012-11-28T23:36:17.317
> 
> 标签：websocket, chat, comet, tornado

我正在尝试编写聊天服务器，但希望它能够应对相对较高的负载并在所有浏览器中兼容。（硬件问题不大）

所以我在看 websockets/comet/python/tornado。

Websocket 似乎有很多跨浏览器的兼容性问题。如果 websockets 不起作用，它会退回到 flash 并且在下载 .swf 文件时会有延迟。我们的用户会认为该网站因延迟而崩溃。

我的问题是，我是否缺少 websockets 的东西？我应该看别的吗？网上写了这么多，我开始不知道什么是好什么坏了。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T07:53:22.130

> Websocket 似乎有很多跨浏览器的兼容性问题。

浏览器兼容性非常好，并且一直在改进。请参阅：caniuse.com/#feat=websockets

也就是说，您应该有备用选项。

> 如果 websockets 不起作用，它会退回到 flash 并且在下载 .swf 文件时会有延迟。我们的用户会认为该网站因延迟而崩溃。

仅当延迟显着时。即使是这样，您也可以通过向用户提供建设性的反馈来解决这个问题，让他们知道应用程序正在连接并且一切都按预期工作。

除非您可以保证您的所有用户都具有原生 WebSocket 支持或安装了 Flash，否则您还应该有一个基于 HTTP 的回退；HTTP-Long Polling、HTTP-Streaming、遗留 AJAX 轮询。

有很多[优秀的实时网络技术解决方案](http://www.leggetter.co.uk/real-time-web-technologies-guide)可用于实现聊天应用程序。他们中的大多数将为您处理回退，并为您提供让用户了解连接进度的机制。有些还为您处理水平缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:14:23.293

[socket.io](http://socket.io/)在 javascript 客户端中非常流行，而[tornado](https://github.com/MrJoes/tornadio2)提供了 tornado 集成。检查 Leggetters 参考列表以获取更多选项（顺便说一句，干得好！）。

# delphi - 获取 WinXP/Vista/7/8 启动文件夹

> ID：13616366
> 
> 赞同：1
> 
> 时间：2012-11-28T23:36:24.523
> 
> 标签：delphi, delphi-xe3

这适用于Win7 / 8，但不适用于XP，为什么？

```
// uses shlobj;

function GetSpecialFolderPath(Folder: Integer; CanCreate: Boolean): string;

// Gets path of special system folders
//
// Call this routine as follows:
// GetSpecialFolderPath (CSIDL_PERSONAL, false)
//        returns folder as result
//
var
   FilePath: array [0..255] of char;

begin
 SHGetSpecialFolderPath(0, @FilePath[0], FOLDER, CanCreate);
 Result := FilePath;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
   memo1.Lines.Add('path:|'+GetSpecialFolderPath(CSIDL_ALTSTARTUP, false)+'|')
end; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:00:45.490

将此 CSIDL_ALTSTARTUP 更改为此 CSIDL_STARTUP

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:40:08.243

0..255 太小了。使用`MAX_PATH`常数。

在 Vista 中，此文件夹不再存在。我不知道它返回什么（向后兼容的值），但显然它比 Vista 中的 255 个字符要短。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T11:18:33.347

我尽量避免对这种常见的需求进行编码。

我使用 JCL 的这个函数：[JclSysInfo.GetPersonalFolder](http://wiki.delphi-jedi.org/wiki/JCL_Help%3aGetPersonalFolder)；

# javascript - JQuery 的 width() 不排除隐藏范围内元素的填充

> ID：13616367
> 
> 赞同：4
> 
> 时间：2012-11-28T23:36:24.990
> 
> 标签：javascript, jquery, css, knockout.js

我正在尝试获取许多隐藏的选择元素的宽度。在 JQuery 对象上使用 width() 返回的宽度是 CSS 定义的宽度，但包括填充。但是，一旦我切换要显示的元素，调用 width() 就会返回正确的值（即不包括填充/边框/边距的宽度）。

示例 HTML：

```
<span id="test" style="visibility:hidden">
    <select id="one">
        <option>1</option><option>2</option><option>3</option>
    </select>
</span> 
```

CSS：

```
 select {
        width: 80px;
        padding: 0 0 0 15px;
    } 
```

预期宽度：65，报告宽度：80

这是一个展示我的问题的 JSFiddle：http: [//jsfiddle.net/2RH7C/4/](http://jsfiddle.net/2RH7C/4/)

除了设置“可见性：隐藏”（而不是显示：无）或克隆/将对象移出屏幕之外，还有其他解决方法吗？我正在使用 KnockoutJS 数据绑定来控制可见性，并且该绑定设置 display: none (http://knockoutjs.com/documentation/visible-binding.html)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:41:14.157

它是每边1px的边框。带边框：无；结果是 65。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:52:38.660

这似乎是 jQuery 1.7 中的一个错误，而 jQuery 1.8 中没有：

[http://jsfiddle.net/2RH7C/5/](http://jsfiddle.net/2RH7C/5/)

如果您没有更新 jQuery 的选项，那么恐怕“使用屏幕外元素计算”或`visibility: hidden`方法似乎是您唯一的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:43:22.740

javascript是正确的。使用 width() 已经消除了填充。渲染的宽度实际上是 110px (80+15+15)。

# c# - 使用抽象工厂或部分类之间的二元选择

> ID：13616368
> 
> 赞同：0
> 
> 时间：2012-11-28T23:36:32.533
> 
> 标签：c#, .net, entity-framework, architecture, domain-driven-design

我正在使用实体框架模型优先方法构建一个 CRUD 应用程序。我的应用程序的结构方式是 UI 层和 DAL 都依赖于域层，而域层不依赖于任何东西。域层仅公开存储库和域对象接口。存储库在 DAL 中实现，并通过依赖注入提供给域层。与所有存储库一样，我的存储库公开了 getCustomer、deleteCustomer 等函数，但由于这些函数是在 DAL 中实现的，因此 DAL 必须能够创建遵守域层接口的对象。现在我的二元选择是我应该如何让它这样做：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:53:04.893

> 域层仅公开存储库和域对象接口。

在这种类型或架构（[六边形架构](http://alistair.cockburn.us/Hexagonal+architecture)）中，域对象不应该有接口，只有存储库。相反，让 DAL 直接创建（重构）域对象。将领域对象抽象为接口并没有任何好处，只有不必要的复杂性，例如工厂。

此外，正如 Heather 所指出的，抽象存储库通常也是一种不必要的复杂性。制作一个真正可跨实现移植的存储库抽象几乎总是徒劳的。在我看来，存储库抽象的主要好处是可以在没有接口的情况下实现封装——只需直接引用实现类即可。

# c++ - 在套接字和标准输入上选择

> ID：13616375
> 
> 赞同：0
> 
> 时间：2012-11-28T23:37:38.580
> 
> 标签：c++, sockets

我正在试验 select 并有一个简单的应用程序，无论用户在命令行中输入什么，它都可以写入服务器。然后服务器将其回显。我正在使用 select 函数来监听连接的套接字和标准输入。

客户端代码：

```
const int BUFFER_SIZE = 1024;
char *readArr = new char[BUFFER_SIZE];
fd_set rset;
ssize_t n;
string input;
FD_ZERO(&rset);
while(true){
  FD_SET(socketFD[0], &rset);
  FD_SET(0, &rset);

  maxfpd1 = max(socketFD[0], 0) + 1;
  select(maxfpd1, &rset, NULL, NULL, NULL);
  if(FD_ISSET(0, &rset)){
    cin>>input;
    write(socketFD[0], input.c_str(), input.size());
    cout<<"\nSocket write!\n";
  }
  if(FD_ISSET(socketFD[0], &rset)){
    n = read(socketFD[0], readArr, BUFFER_SIZE-1);
    readArr[n] = '\0';
    cout<<"\nSocket read!\n";
    cout<<readArr;
  }
} 
```

现在，如果我输入“你好！” 在命令行中按回车，我得到这个输出：

```
Hello! //User input

Socket write!//Client output

Socket read!//Client output 
```

如果我再次按 Enter 键，“你好！” 被打印。为什么我需要按两次回车？

我可以从服务器输出中看到，第一次输入后，消息被正确发送到服务器，然后返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:19:00.763

`cin>>input`不从行尾读取换行符，`cout<<readArr`也不写入换行符。如果使用`cout<<readArr<<endl`它将在字符串后写一个换行符并刷新输出缓冲区。如果你不想在你的字符串后面换行，你可以使用`flush`而不是`endl`只刷新输出缓冲区。`cout`如果您根本不希望它缓冲您的输出，您也可以更改为无缓冲。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T02:15:26.693

你`cin>>input`没有读一整行，只有一个字。它不会读取换行符，如果您键入两个单词，它将不会读取第二个单词。您可能应该`getline(cin,input)`改用它，它读取整行并放入`input`（没有换行，它被丢弃）。

# ruby-on-rails - 如何在保存之前获取对象的值

> ID：13616376
> 
> 赞同：1
> 
> 时间：2012-11-28T23:37:39.467
> 
> 标签：ruby-on-rails, oop, model-view-controller, model

您能否告诉我如何获取已更改对象的数据。

例如，我有一个对象`@student = {:name => 'xxx', :class => 'yyy'}`，用户在网站上玩这个对象。保存对象后，我通知用户已更改的内容，例如`Student #{@student.name} has changed #{@student.class}`.

那么基本上如何从保存之前的模型中获取以前的数据？

*注意：* `before_save`回调不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:44:05.450

查看[`paper_trail`](https://github.com/airblade/paper_trail)允许对模型进行版本控制和跟踪更改的 gem。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T23:41:18.090

您可以使用 ActiveRecord 的[`changed`](http://apidock.com/rails/ActiveRecord/Dirty/changed)方法，并在完成保存之前将结果保存在闪存中。

```
flash[:changed_attrs] = @student.changed.join(', ') 
```

# jquery - 文本不下拉一行，溢出：隐藏，jScrollpane

> ID：13616377
> 
> 赞同：0
> 
> 时间：2012-11-28T23:37:49.967
> 
> 标签：jquery, css, jscrollpane

我正在尝试使用 jScrollPane （ jScrollPane （ jscrollpane.kelvinluck.com ）显示一系列图像，以及水平的 div 。我设法使这一系列图像工作，但是当我创建 div 时，其中的内容要么（a）在 div 之外，要么（b）当我将其标记为溢出：隐藏时，它继承了滚动效果，因此不会下线。

我想做的是让我的 div 中的文本像普通文本一样，并在它接近容器的宽度时下拉一行。

这是我的代码，

```
<div class="scroll-pane">                                                                           
    <ul>
        <li ><img src="img/portfolio1.gif" /> <span></span></li>
        <li ><img src="img/portfolio2.gif"/> <span></span></li>
        <li ><img src="img/portfolio3.gif"/> <span></span></li>
        <li>
            <div class="info">
                <h2>Modern Palace Resident</h2>
                <p>This is going to describe the apartment a little bit, including design philosophy, themes for the apartments, and why you chose to do it this way. This can excite them about the apartment, which will lead them to buy. You can leave a link <a href="apt.php">here</a> as well.</p>
            </div>
        </li>
    </ul>
</div> 
```

这是相关的 SCSS

```
.scroll-pane{
    width: 100%;
    height: 450px;
    overflow: scroll;
    white-space:nowrap;

    ul {
        float:left;
        list-style-type:none;
        li{
            float:left;
            .info{
                float:left;
                width:300px;
                height:420px;
                background-color:gray;
                overflow:hidden;
            }
            img{
                height:420px;
            }
        }
    }
} 
```

相关部分是

```
.info{
    float:left;
    width:300px;
    height:420px;
    background-color:gray;
    overflow:hidden;
} 
```

我需要在这里编辑什么，以便`h2`, 和`p`尊重`.info`容器？

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:41:25.530

我不确定 CSS 在上述语法中是如何工作的。我不得不改变它，让它首先像这样在小提琴中工作：

```
.scroll-pane{
    width: 100%;
    height: 450px;
    overflow: scroll;
    white-space:nowrap;
}

.scroll-pane ul{
    float:left;
    list-style-type:none;
}

.scroll-pane ul li{
    float:left;
}

.scroll-pane ul li img{
    height:420px;
}

.info{
    display: block;
    clear: left;
    width:300px;
    height:420px;
    background-color:gray;
    overflow:hidden;
} 
```

无论如何，您的文本不换行的原因是因为在您的`.scroll-pane`样式中您已经设置`white-space:nowrap;`了，它是由您的容器继承的。

要使信息文本换行添加`white-space:normal;`到`.info`.

### [演示](http://jsfiddle.net/ts4uw/)

因为我必须手动修复 CSS 才能在小提琴中首先工作，如果有什么看起来不正确，请随时告诉我，或者添加您自己的小提琴并发布链接，我会查看它。

无论如何，包装应该是您添加`white-space:normal;`到`.info`样式中的有效包装

# c++ - 返回类型后的静态关键字

> ID：13616379
> 
> 赞同：1
> 
> 时间：2012-11-28T23:37:59.483
> 
> 标签：c++

当我将关键字`static`与类成员一起使用时，我通常以这种方式将其放在返回类型之前：

```
class Problem {
public:
    static void solve() {}
} 
```

我刚刚注意到在 VS2010 上它与返回类型反转它的工作原理相同：

```
class Problem {
public:
    void static solve() {}
} 
```

标准对此有何评论？这是否有我应该注意的任何其他含义，还是完全相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:58:37.410

*decl-specifier-seq [opt]* (ISO/IEC 14882:2011, §7 Declarations)的各个组件的顺序在很大程度上是任意的。特别是，存储类（例如“静态”）可以与类型信息混合在一起，尽管在 C 标准中将存储类不是第一个标记为过时的（但据我所知，在 C++ 中不是标准）。

# string - 如何在 Irvine 汇编语言中搜索字符串并将其替换为子字符串？

> ID：13616384
> 
> 赞同：0
> 
> 时间：2012-11-28T23:38:59.820
> 
> 标签：string, assembly, x86, substring

我正在编写一个程序，它读取一个字符串，然后搜索某些关键字，如“cat”，并将其替换为“dog”。我只是不确定如何开始。我必须使用什么代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T19:20:28.840

对于 8 位字符，大致是这样的，有很多方法可以实现它：

1.  设置`si`为指向字符串的第一个字符。

2.  `mov al,[si]`

3.  `repnz scasb`找到第一个字符的第一个匹配项。

4.  将地址存储在某处。

5.  设置`di`为指向替换字符串的第一个字符（`'dog'`在本例中）。

6.  设置`cx/ecx/rcx`为字符串长度。

7.  `repz cmpsb`

8.  检查`cx/ecx/rcx`是否为零和最后一个字符匹配。

9.  如果是，则匹配，因此复制到与（设置指针和首先）`'dog'`一起存储的地址。请注意，此方法仅在替换字符串不长于原始字符串时才有效。如果它更长，您可能需要保留一个新的内存块以避免缓冲区溢出。如果不匹配，则回溯到存储的地址，递增1（对于 16 位字符，递增 2），然后跳转到 2。（）。当您到达字符串的末尾时，您还需要在此处检查。`rep movsb``si``di``si``si``mov al,[si]`

10.  准备好。或者，如果您想全部替换，如 sed `s/cat/dog/g`，从 1 开始循环，首先设置指针 ( `si`)（取决于您希望正则表达式引擎如何工作）。

对于 UTF-8（16 位字符），请替换以下内容：`scasb`-> `scasw`、`cmpsb`-> `cmpsw`、`movsb`-> `movsw`、`al`-> `ax`。

对于 32 位代码，替换所有对 with 的引用和对with`si`的`esi`所有引用。`di``edi`

对于 64 位代码，替换所有对 with 的引用和对with`si`的`rsi`所有引用。`di``rdi`

# android - 如何从 Android 中的 SD 卡中获取多个对象？

> ID：13616386
> 
> 赞同：1
> 
> 时间：2012-11-28T23:39:08.040
> 
> 标签：android, object, load, sd-card

如何从 SD 卡加载 Android 中的多个对象？

我懂了：

```
 ObjectInput in;
    Dog dog = null;
    try
    {
        in = new ObjectInputStream(new FileInputStream("/mnt/sdcard/somelocation/save.data"));
        dog = (Dog) in.readObject();
        in.close();
    } catch (Exception e)
    {
        e.printStackTrace();
    } 
```

但这只会从 SD 卡加载一个对象。

我在想类似的东西`ArrayList<Dog> dogs = in.readAllObjects()`，但这段代码只会在我的梦想中实现。

代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:51:16.807

从[`readObjects()`](http://developer.android.com/reference/java/io/ObjectInputStream.html#readObject%28%29)文档：

> 从源流中读取*下一个对象。*

所以我建议使用循环来读取每只狗：

```
List<Dog> dogs = new ArrayList<Dog>();
Dog dog;
try {
    in = new ObjectInputStream(new FileInputStream("/mnt/sdcard/somelocation/save.data"));
    while((dog = (Dog) in.readObject()) != null)
        dogs.add(dog);
    in.close();
}
// catch the exceptions 
```

我不知道是否`dog`会出现在我的脑海中，但如果尝试读取文件末尾，`null`它肯定会抛出异常。`in`

# selenium - 什么会导致 UnhandledAlertException 错误？

> ID：13616387
> 
> 赞同：2
> 
> 时间：2012-11-28T23:39:16.247
> 
> 标签：selenium, selenium-rc, selenium-firefoxdriver

我是 selenium 的新手，我不得不在不同的浏览器和版本上运行我的测试。在必须在 Firefox 15 中运行它之后，我卸载了 Firefox15 并安装了 Firefox17，这就是错误出现的时候。

调用了 firefoxdriver，但它给出了这个错误：

```
Failure: OpenQA.Selenium.UnhandledAlertException : Modal dialog present
Build info: version: '2.26.0', revision: '18041', time: '2012-11-01 19:33:38'
System info: os.name: 'Windows 7', os.arch: 'amd64', os.version: '6.1', java.version: '1.7.0_09'
Driver info: driver.version: EventFiringWebDriver
Session ID: e1417203-a392-4f74-948e-2108fb2bbe34 
```

它实际上会打开页面，但随后会刷新它，然后会出现一些警报。

我已尝试卸载它并再次安装 Firefox 15，但没有任何效果。Internet Explorer 工作正常，所以我知道它不是 Selenium，而是 Firefox 驱动程序。

我正在使用 Selenium 2.26.0 并通过 seleniumRC 运行它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T05:22:56.173

您可以尝试使用此代码来抑制警报：

```
DesiredCapabilities dc=new DesiredCapabilities();
dc.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR,UnexpectedAlertBehaviour.ACCEPT);
driver =new FirefoxDriver(dc); 
```

# hibernate - JPA Hibernate 强制转换为非实体类

> ID：13616388
> 
> 赞同：1
> 
> 时间：2012-11-28T23:39:31.990
> 
> 标签：hibernate, jpa

我有一个大数据库，我需要进行一个查询，至少要加入 3 个表。问题是此查询的结果集不是实体类。

查询：

```
SELECT avg(g.grade) avgGrade, max(g.grade) maxGrade, min(g.grade) minGrade FROM... 
```

新班级：

```
class Stat {
  float avgGrade;
  float maxGrade;
  float minGrade;

  // constructor + getters and setters
} 
```

现在我需要从查询中获取这三个值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T05:21:34.470

您可以使用构造函数表达式尝试以下查询，并进行相应修改。

> SELECT NEW package_name.Stat(avg(g.grade), max(g.grade), min(g.grade)) FROM ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T17:33:15.457

我发现了问题，avg(g.grade) 返回一个双精度，我的类 Stat 的构造函数接受一个浮点数，所以我有一个与未找到构造函数异常相关的错误。

谢谢大家 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T06:04:58.143

你有两个选择（我认为还有更多，但这两个应该是最常见的一个），首先使用 Nayan Wadekar 建议的方式，通过构造函数构造数据对象。

第二个是选择你想要的字段，Hibernate 会返回一个元组列表。列表的每个元素都是一个 Object[]，它表示结果的一个“行”。您可以自行实现从 tuple 到 Stat 类的转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T06:02:42.343

假设类 Stat 有一个适当的构造函数

```
select new your_pkg_name.Stat(avg(g.grade) as avgGrade, max(g.grade)  as maxGrade, min(g.grade) as minGrade) FROM ... 
```

# javascript - 单击子div时如何取消绑定父div的点击事件

> ID：13616390
> 
> 赞同：5
> 
> 时间：2012-11-28T23:39:41.803
> 
> 标签：javascript, jquery

```
<div id="addCompaniesModal">
    <div id="addCompany_map"></div>
    <div class="addMarkerBtn"></div>
</div> 
```

嗨，当我单击子 **addCompany_map**时，不应调用父 **addCompaniesModal** ...我已经做了类似的事情..但由于某种原因它不起作用..并且在单击子时选择了父 div 可以有人请向我解释解决方案

```
$(document).on('click','#addCompany_map', function (e) {
    e.stopPropagation();
});

$('#addCompaniesModal').click(function(){
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T23:53:59.250

事件传播是从子元素到父元素发生的。

看起来您的第一行正在处理对子 div 的点击，但您指定的方式实际上是处理文档级别的点击（因为您的选择器是`$(document)`），并且它仅在子 div 上发生时才调用该方法（`on('click','#addCompany_map'`部分）。由于文档是`addCompaniesModal`div 的父文档，因此它的单击处理程序将在`addCompaniesModal`div 上使用的处理程序之后触发。

为了使其工作，您需要将代码更改为：

```
$('#addCompany_map').click(function (e) {
  e.stopPropagation();
});

$('#addCompaniesModal').click(function(){

}); 
```

* * *

编辑：

我在您的一些评论中看到您使用`$(document).on('click', ...`方法的主要原因是因为您正在动态添加子 div。

在这种情况下，有两种可行的方法来处理您的问题。

第一种方法是让您也动态添加子 div 处理程序，并在删除时取消绑定。您可以使用这种方法：

```
function dynamicallyAddChildren(){
  var oldChildDiv = $('#addCompany_map');
  if (oldChildDiv.length > 0)
    oldChildDiv.off('click', handleChildDiv);
  // remove old child if needed and add new child divs
  newChildDiv.on('click', handleChildDiv);
}

function handleChildDiv(e){
  //do something
  e.stopPropagation();
}

$('#addCompaniesModal').click(function(){
}); 
```

`$(document).on('click', ...`第二种方法是对子 div 和父 div使用方法，如下所示：

```
$(document).on('click','#addCompany_map', function (e) {
    e.stopPropagation();
});

$(document).on('click','#addCompaniesModal', function(){
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:53:09.537

使用**委托**并检查**目标元素**。那应该可以解决您的问题..

这样您就可以在一个处理程序中处理所有三个 div 单击事件。

```
$('body').on('click','#addCompaniesModal',function(e) {

    if (e.target.id === 'addCompany_map') {
        alert('Clicked Map Div !!')
    }
    else if (e.target.className === 'addMarkerBtn') {
        alert('Clicked Marker Div !!')
    }
    else {
        alert('Parent Div !!')
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/7sBcA/1/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:22:46.647

使用此表达式作为您的问题的最简单解决方案：

```
$('#addCompaniesModal').on('click','div', function (e) {
    console.log(e.target.id || e.target.className);
    e.stopPropagation();
}); 
```

这也提高了性能，正如[参考资料](http://api.jquery.com/on/)所说：*尽量避免在大型文档上的委托事件中过度使用 document 或 document.body*。因此，您用一块石头杀死了 2 只鸟。

第二个表达式可以保持原样：

```
$('#addCompaniesModal').click(function(){
}); 
```

[顺便说一句](http://api.jquery.com/click/)：`.click(handler)`是的捷径`.on("click", handler)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T23:48:09.490

我认为：

```
$("#addCompany_map").click(function(){
  return false;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T23:50:30.100

您有一个点击事件`#addCompaniesModal`，其中包括`#addCompany_map`。因此，通过点击孩子，您也将点击父母。

看来你需要问问自己你想在这里完成什么。如果您希望父级中的子级发生特定的事情，我会删除父级上的单击事件。如果您想在不是 的父对象中的另一个对象上发生单击事件`#addCompany_map`，例如`.addMarkerBtn`，请执行此操作。但是你上面的方式是行不通的。

# javascript - django javascript代码没有运行，但它正在运行

> ID：13616393
> 
> 赞同：0
> 
> 时间：2012-11-28T23:39:51.903
> 
> 标签：javascript, html, django, django-templates

我正在尝试在 django 中实现代码。我的代码正常工作。但是，当我尝试在 django 中使用时。似乎javascript无法正常工作。为什么它在 django 中不起作用？如何运行使用 javascript 的 html 页面？

* html 页面位于我的模板文件夹中，在此文件夹中，我还有一个类似`scripts/`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:03:28.293

> * html 页面位于我的模板文件夹中，在此文件夹中，我还有 scripts/spryMap-2.js 之类的文件夹

您的模板文件夹中不应包含静态文件（例如 spryMap-2.js）。它应该放在您的静态文件文件夹中。然后你用这样的东西加载你的脚本

```
<script type="text/javascript" src="{{ STATIC_URL }}scripts/spryMap-2.js"></script> 
```

**更新：**我不确定为什么我的回答被否决了。我已经扩展了我的答案，以提供更详细的说明来修复您的静态文件。

问题是您的静态文件未正确提供 - 因此当您尝试直接访问 js 文件时出现 404。正如我上面提到的，模板文件夹不是静态文件的正确位置。您应该配置您的`STATIC_ROOT`和`STATIC_URL`设置。例如

```
#Make this the path to the folder where you will keep your static files
STATIC_ROOT = '/path/to/your/project/static'
#The absolute or relative URL which will serve your static files
STATIC_URL = '/static/' #translates to http://localhost:8000/static/, for example 
```

为了让 django 开发服务器为您的静态文件提供服务，您需要在 urls.py 中添加以下内容

```
from django.contrib.staticfiles.urls import staticfiles_urlpatterns

# ... the rest of your URLconf goes here ...

urlpatterns += staticfiles_urlpatterns() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:05:13.927

我刚刚检查了这段代码，它似乎工作正常，也许尝试检查脚本源路径标记。我用了

```
<script src="{{ STATIC_URL }}assets/js/spryMap-2.js"></script> 
```

代替

```
<script type="text/javascript" src="scripts/spryMap-2.js"></script> 
```

我得到了可拖动的附加输出： ![上述问题的附加输出](../Images/6ca8174c1ca73ce6e74165cfcbe71a35.png)

如果您使用的是 Django，请确保您在设置文件中提及静态路径的正确路径，并将您的 sprymap.js 文件放到该位置，我想这将解决问题。

# jquery - 单个 Json 中的多个对象类型尝试使用 jQuery 读取它

> ID：13616397
> 
> 赞同：0
> 
> 时间：2012-11-28T23:40:24.667
> 
> 标签：jquery, jquery-mobile

我有一个 MVC 控制器，它像这样在单个 json 中返回 3 种对象类型

```
[[objectType1_1][objectType1_2]] 
[[objectType2_1][objectType2_2][objectType2_3]]
[[objectType3_1]] 
```

我有一个 jScript (jQUery) 我正在尝试阅读它。

```
function cargarListaItems(tcLink , tcPanel) {
 $.post(tcLink, function (datosItems) {
     var Lineas = $(datosItems)[0];
     var Grupos = $(datosItems)[1];
     var Items = $(datosItems)[2];
     for (Linea in Lineas) {
         alert(Linea.Title);
     }
  });
 } 
```

警报总是为我的对象返回 undefined，但属性 Title 已完全定义。

读取该json数组中所有对象的正确方法是什么？

编辑：通常我在json只返回一种对象类型时使用这样的东西

```
$(data).each(function (object) {
    var Item = $(this)[0];
    alert(Item.Property);
}); 
```

并且工作正常。但它不适用于许多对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:43:20.930

去掉变量前的**$ 符号**

```
$(datosItems)[0] // you are wrapping it as a jQuery object 
```

应该是

```
datosItems[0] 
```

其他2项也是一样。。

# html - 对齐一系列 div

> ID：13616401
> 
> 赞同：-1
> 
> 时间：2012-11-28T23:40:43.683
> 
> 标签：html, css

我正在建立我的网站，但遇到了一些困难。这是它目前的样子：

[http://i1134.photobucket.com/albums/m618/eshellborn/ScreenShot2012-11-28at43250PM.png](http://i1134.photobucket.com/albums/m618/eshellborn/ScreenShot2012-11-28at43250PM.png)

而且，当然这就是我希望它看起来的样子：

[http://i1134.photobucket.com/albums/m618/eshellborn/ScreenShot2012-11-28at43306PM.png](http://i1134.photobucket.com/albums/m618/eshellborn/ScreenShot2012-11-28at43306PM.png)

我已经尝试了很多 div align this 和类似的东西，但似乎没有任何效果。有任何想法吗？下面的代码：

HTML：

```
<div class="realtor"> 
    <img src="bronson.png" align="left" />
    <div class="innerrealtor">
        <h3>Bronson Carmichael</h3>
        <p class="realtorinfo"> Bronson has been in the industry for thousands of years, with over 12 client expiriences. Join him on your journey to find a home in the Cranbrook area. </p>
    </div>
    <div class="viewlistings">
        <div>View Bronson's Listings</div>
        <img src="viewarrow.png" />
    </div>
</div> 
```

CSS：

```
.innerrealtor {
    width: 450px;
    margin-left: 90px;
    margin-top: -3px;
}
.realtor {
    padding: 15px;
    margin-top: 25px;
    background-color: #F9F8E7;
    width: 750px;
    height: 70px;
    border-radius: 5px;
}
.viewlistings {
    width: 180px;
    height: 50px;
    background-color: #018D0E;
    border-radius: 4px;
    float: right;
    text-align: right;
}
.viewlistings div {
    padding-top: 3px;
    margin-right: 50px;
    font-family: 'Sanchez', serif;
    color: #ffffff;
    font-size: 16px;
    font-weight: 100;
}
.viewlistings img {
    position: relative;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:21:55.467

我编辑了你的 CSS，它现在可以工作了：

给出`.viewlistings div`你的首选`width`和`margin-right`

```
.innerrealtor {
width: 450px;
margin-left: 90px;
margin-top: -3px;
float:left;
}

.realtor {
padding: 15px;
margin-top: 25px;
background-color: #F9F8E7;
width: 750px;
height: 70px;
border-radius: 5px;
}

.viewlistings {
width: 180px;
height: 50px;
background-color: #018D0E;
border-radius: 4px;
float: right;
text-align: right;
}

.viewlistings div {
padding-top: 3px;
margin-right: 0px;
font-family: 'Sanchez', serif;
color: #ffffff;
font-size: 16px;
font-weight: 100;
width:100px;
background:red;
float:left;
}

.viewlistings img {
position: relative;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:57:10.793

看看这个，我试图重新创造你的情况：

```
jsFiddle: 
```

[http://jsfiddle.net/6rCgc/](http://jsfiddle.net/6rCgc/)

我想我已经使用更简单的标记和 css 实现了您正在尝试的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:49:17.167

`.viewlistings`通过将其标记移到`.innerrealator`. 只有这样，它才会飘到正确的地方。此外，如果您从 中删除`height: 70px;`，`.realtor`则该框将展开以包含其子项。

我看不到您的图像，但您可能需要对`viewarrow.png`.

# php - 计算多维数组中的重复值并基于该值填充值

> ID：13616404
> 
> 赞同：0
> 
> 时间：2012-11-28T23:40:58.573
> 
> 标签：php, multidimensional-array, count, duplicates

我有以下数组：

```
Array
(
[0] => Array
    (
        [event_id] => 90
        [event_date] => 2012-11-29
        [multi] => 1
    )

[1] => Array
    (
        [event_id] => 86
        [event_date] => 2012-11-29
        [multi] => 1
    )

[2] => Array
    (
        [event_id] => 52
        [event_date] => 2012-11-30
        [multi] => 0
    )

) 
```

我正在使用以下代码即时生成：

```
 $dates = array();
    $curr_date = array();
    $iteration_date = null;

    foreach ( $query as $q ) {
        $event_id = $q->ID;

        $curr_date['event_id'] = $event_id;
        $curr_date['event_date'] = date('Y-m-d', get_post_meta($event_id, 'event_unix_date', true));

        if ( empty($iteration_date) ) {
            $iteration_date = $curr_date['event_date'];
            $curr_date['multi'] = 1;
        } elseif ( $iteration_date == $curr_date['event_date'] ) {
            $curr_date['multi'] = 1;
        } else {
            $iteration_date = $curr_date['event_date'];
            $curr_date['multi'] = 0;
        }

        array_push($dates, $curr_date);
    } 
```

这是基于 MySQL 数据库的结果。

我正在尝试做的是：检查是否有相同的数组`[event_date]`，如果有，计算有多少，执行一段特殊的代码（一个函数很好），并根据输出的内容设置`[multi]`值1、2 或 3，具体取决于该条件。

基本逻辑是：

检查是否有多个`[event_date]`'。如果有，请检查所有匹配的重复日期的类别。如果所有日期都是 X，则填充`[multi]`1，如果所有日期都是 Y，则填充 2，如果日期混合 X 和 Y，则填充 3。如果只有一个日期，则填充 1 或 2，具体取决于它的类别在。

我认为我只是循环查询（它是 event_date 的 DESC），我走在正确的轨道上，但这不会让我检查单个条目类别并根据它进行填充。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:55:55.657

您可以跟踪数组中的日期。然后，当您循环浏览您的事件时，将该日期加一。在循环结束时，您将知道每个日期有多少事件。然后，您需要循环并添加您的多记录。您也可以只使用日期数组作为循环。

```
$dates = new array();

foreach ( $query as $q ) {
  if(array_key_exists($q['event_date'], $dates)
    $dates[$q['event_date']]++;
  else
    $dates[$q['event_date']] = 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:58:18.113

我们是否每次都假设一个排序的多维数组（通过升序 [event_date]）？如果是这样，您可以：

```
function multi_counter($big_array, $sorted, $storage){
$multi_count=0; // since by default there are no multiples
$multi_items=array(0); // starting at the beginning of the array
$length = count($big_array); // counting before loop
for($i=0;$i<$length-1;$i++){ // the -1 is so we don't get undefined index on last run
    if($big_array[$i][$sorted]===$big_array[$i+1][$sorted]){ //testing for similarity
        $multi_items[]=$i+1;        // adding the multi found to temp storage
        $multi_count++;             // adding to # of multis
// CALL A FUNCTION HERE SINCE THEY MATCH???
    }else{  
        foreach($multi_items as $key=>$multi){  // if not similar, go back and assign stored multis
            $big_array[$multi][$storage]=$multi_count;  // assigning stored vals
        }
        $multi_count=0; // resetting counter
        $multi_items=array($i+1); // resetting to next item
    }
}
foreach($multi_items as $key=>$multi){  // forcing assign at end of loop
    $big_array[$multi][$storage]=$multi_count; 
}
return $big_array; // returning the newly modified array 
```

}

你说的是这个吗？您可以插入对我评论过的另一个函数的调用。问题不清楚，但这听起来像您想要的。

该函数解析作为第一个参数给出的数组，检查每个子数组中的第二个参数是否相似，并将它们存储在子数组中的一个键中，该键命名为您为第三个参数放置的任何内容。

# fortran - 多次调用子程序，每次使用不同的函数作为参数

> ID：13616416
> 
> 赞同：0
> 
> 时间：2012-11-28T23:42:11.427
> 
> 标签：fortran, fortran90, fortran95

我是一个新手，不知道这些术语，所以我无法在网上搜索这个问题的答案。

不止一次，在编程中，我想做这样的事情。

A 和 B 是子程序，c 和 d 是函数。A 和 B 各自在其中多次调用一个函数。

```
call A(c(x))
call A(d(x))
call B(c(x))
call B(d(x)) 
```

这种结构不起作用。有人告诉我，Fortran 不支持函数的别名，至少在这种情况下是这样。（大多数涉及“别名”的搜索结果是指别名变量而不是函数，这就是我没有找到答案的原因。）

那么我可以使用什么结构来做到这一点而不必编写多个版本的 A 和 B？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T05:50:40.410

不完全确定我理解你想要什么，但它是否类似于以下内容？

```
Program f

  Implicit None

  Interface
     Integer Function c( x )
       Implicit None
       Integer, Intent( In ) :: x
     End Function c
     Integer Function d( x )
       Implicit None
       Integer, Intent( In ) :: x
     End Function d
  End Interface

  Call a( 3, c )
  Call a( 4, d )

  Call b( 5, c )
  Call b( 6, d )

Contains

  Subroutine a( x, func )

    Integer, Intent( In ) :: x
    Interface
       Integer Function func( x )
         Implicit None
         Integer, Intent( In ) :: x
       End Function func
    End Interface

    Write( *, * ) 'In a. Func = ', func( x )

  End Subroutine a

  Subroutine b( x, func )

    Integer, Intent( In ) :: x
    Interface
       Integer Function func( x )
         Implicit None
         Integer, Intent( In ) :: x
       End Function func
    End Interface

    Write( *, * ) 'In b. Func = ', func( x )

  End Subroutine b

End Program f

Integer Function c( x )
  Implicit None
  Integer, Intent( In ) :: x
  c = 2 * x
End Function c

Integer Function d( x )
  Implicit None
  Integer, Intent( In ) :: x
  d = 10 * x
End Function d
Wot now? gfortran -std=f95 f.f90 
Wot now? ./a.out
 In a. Func =            6
 In a. Func =           40
 In b. Func =           10
 In b. Func =           60
Wot now? 
```

另一种方法是过程指针，但您需要一个 f2003 编译器，而且这些编译器还不是很常见 - 上面可以回到 f90 甚至比 External 更早地执行您想要的操作，但错误检查功能较少

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T08:28:48.977

正如 IanH 在他的评论中所说，调用 A(c(x)) 看起来像评估 c(x) 并将其传递给子例程 A。

如果您想将一个函数“C”传递给子例程 A，该函数接受一个类型为 X 的参数，有几种方法可以做到这一点。

如前所述，过程指针是一种新方法。虽然支持所有 Fortran 2003 标准的编译器极少，但这部分却得到了广泛的支持。

这是一个改编自[Fortran 中的函数指针数组的示例](https://stackoverflow.com/questions/2521072/function-pointer-arrays-in-fortran)

```
module ProcsMod

  implicit none

contains

function f1 (x)
  real :: f1
  real, intent (in) :: x

  f1 = 2.0 * x

  return
end function f1

function f2 (x)
   real :: f2
   real, intent (in) :: x

   f2 = 3.0 * x**2

   return
end function f2

subroutine fancy (func, x, answer)

   real, intent (in) :: x
   real, intent (out) :: answer

   interface AFunc
      function func (y)
         real :: func
         real, intent (in) ::y
      end function func
   end interface AFunc

   answer = func (x)

end subroutine fancy

end module  ProcsMod

program test_proc_ptr

  use ProcsMod

  implicit none

  interface
     function func (z)
        real :: func
        real, intent (in) :: z
     end function func
  end interface

  procedure (func), pointer :: f_ptr => null ()

  real :: answer

  f_ptr => f1
  call fancy (f_ptr, 2.0, answer)
  write (*, *) answer

  f_ptr => f2
  call fancy (f_ptr, 2.0, answer)
  write (*, *) answer

  stop

end program test_proc_ptr 
```

调用“call fancy (f_ptr, 2.0, answer)”看起来是一样的，但是通过改变函数指针 f_ptr 指向的函数，一个不同的函数被传递给子程序 fancy。

这与 gfortran（版本 4.4 到 4.7）和 ifort 一起编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:46:31.640

我认为 MSB 的回答描述了函数别名的含义；Fortran 术语是“过程指针”。作为对此和 Ian 的回答的替代方法，您还可以使用过程虚拟参数（不一定是指针）。请注意，`procedure`仅自 F2003 起才支持任何声明，但 gfortran 4.7 和 ifort 13 都支持这一点。它可以在有或没有（抽象）接口块的情况下完成：

```
module dummy_procedure
  implicit none

  abstract interface
    real function myfunc(x)
      real, intent(in) :: x
    end function
  end interface

contains      
  subroutine a(func)
    ! Using the interface block:
    procedure(myfunc) :: func         
    print*, 'a:', func(.5)
  end subroutine

  subroutine b(func)
    ! Using the explicit interface of a known procedure:
    procedure(f1) :: func  
    print*, 'b:', func(.5)
  end subroutine

  real function f1(x)
    real, intent(in) :: x
    f1 = 2.0 * x
  end function

  real function f2(x)
    real, intent(in) :: x
    f2 = 3.0 * x**2
  end function
end module 
```

现在可以直接将 and 传入and `f1`，输出如预期：`f2``a``b`

```
program main
  use dummy_procedure
  call a(f1)  ! a: 1.0
  call a(f2)  ! a: 0.75
  call b(f1)  ! b: 1.0
  call b(f2)  ! b: 0.75
end program 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T00:17:02.060

如果我了解您要执行的操作：

1）在模块中定义您的功能。

2) 使用模块。

3) 将函数和输入数据作为单独的参数提供给子程序。

这是一个对我有用的代码：

```
module iterfuncs
contains

! two example functions:
function approach_golden_ratio(a) result(agr)
  agr=1./a+1.
end function approach_golden_ratio

function approach_other_ratio(a) result(aor)
  aor=1./(a-1)
end function approach_other_ratio

end module

program use_some_functions

use iterfuncs

real :: final_res

final_res=2.3
! call subroutine with 1st function
call iterate(final_res,approach_golden_ratio)
print *,final_res

final_res=2.3
! call subroutine with 2nd function
call iterate(final_res,approach_other_ratio)
print *,final_res

end program

subroutine iterate(res,func)

use iterfuncs

do n=1,100
  res=func(res)
enddo

return

end subroutine 
```

# facebook - Copious 应用程序如何在没有 publish_stream 许可的情况下在墙上发布？

> ID：13616418
> 
> 赞同：0
> 
> 时间：2012-11-28T23:42:16.483
> 
> 标签：facebook, facebook-graph-api

这个网站 copious.com 很奇怪，当你通过 Facebook 在这个网站上注册时**，FB Copious 应用程序不会要求扩展权限“publish_stream”**，在接下来的页面上你完成了在 copious.com 上的注册，你可以选择“发布到我加入 Copious 的 Facebook 墙”。所以为了测试我选择了这个选项（**提醒：应用程序没有 publish_stream 权限**）。不真实的几秒钟后，您会在墙上看到一条帖子，上面写着“我现在在 Copious 上发现了很棒的发现。”，所有朋友都可以看到的消息！这怎么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:28:25.910

此活动不需要 publish_stream。从 4 月 12 日起，publish_actions 可以发布到用户的供稿。

# sql - GPO WMI 用户名过滤器无法通过 RDP 工作

> ID：13616419
> 
> 赞同：0
> 
> 时间：2012-11-28T23:42:21.080
> 
> 标签：sql, active-directory, windows-server-2008, wmi, group-policy

我正在尝试编写 WMI 过滤器以防止 GPO 应用于某些用户

```
SELECT * from Win32_ComputerSystem WHERE NOT UserName LIKE 'domain\\user1_%' AND NOT UserName LIKE 'domain\\user2_%' 
```

如果用户登录到控制台，这将正常工作，但如果用户通过 RDP 登录，则始终返回 false。

标记

编辑：

似乎确实有一种方法可以实现这一点，在本文的方法二中进行了[描述](http://learn-powershell.net/2010/11/01/quick-hit-find-currently-logged-on-users/)。不过，我不确定如何使用 Win32_Process 构造查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:14:45.637

您可以尝试从 Win32_LogonSession 查询吗？[http://msdn.microsoft.com/en-us/library/windows/desktop/aa394189(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394189(v=vs.85).aspx) 似乎`LogonType`告诉用户是否通过 RDP 登录。

# java - 自定义 JAXB 生成以包含 ObjectFactory 类的 @XmlElementDecl 注释

> ID：13616423
> 
> 赞同：1
> 
> 时间：2012-11-28T23:42:41.283
> 
> 标签：java, binding, jaxb, code-generation

与主题一样，您能否自定义 xjc 如何生成 java 类，以便每个 ObjectFactory 类都使用 @XmlElementDecl 注释或使用 @XmlRootElement 注释每个元素？有没有办法使用 bindigns.xml 文件或某种命令行开关来做到这一点？我正在使用 cxf maven 插件（所以基本上是 wsdl2java）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T15:08:04.770

似乎 @XmlElementDecl 或 @XmlRootElement 仅针对 XSD 中的全局定义元素生成。[使用哪个注解的规则在下面的博客](http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html)中有很好的描述

# mysql - 为什么即使使用 LIMIT 子句，在 mysql 中查询也需要很长时间？

> ID：13616424
> 
> 赞同：2
> 
> 时间：2012-11-28T23:42:50.223
> 
> 标签：mysql

假设我有一个包含 100 多列和 100 万行的 Order 表。它在 OrderID 和 FK 约束 StoreID --> Store.StoreID 上有一个 PK。

1)`select * from 'Order' order by OrderID desc limit 10;`

以上需要几毫秒。

2)`select * from 'Order' o join 'Store' s on s.StoreID = o.StoreID order by OrderID desc limit 10;`

不知何故，这可能需要几秒钟。我添加的内部连接越多，速度就越慢。

3)`select OrderID, column1 from 'Order' o join 'Store' s on s.StoreID = o.StoreID order by OrderID desc limit 10;`

通过限制我们选择的列，这似乎加快了执行速度。

这里有几点我不明白，如果任何更了解mysql（或一般的rmdb查询执行）的人能启发我，我将不胜感激。

查询 1 很快，因为它只是 PK 的反向查找，而 DB 只需要返回它遇到的前 10 行。

我不明白为什么 Query 2 应该永远使用。操作不应该一样吗？即通过 PK 获取前 10 行，*然后*与其他表连接。由于存在 FK 约束，因此可以保证满足该关系。所以 DB 不需要加入比需要更多的行然后修剪结果，对吗？除非，FK 约束允许空 FK？在这种情况下，我猜左连接会比内连接快得多？

最后，我猜查询 3 更快，因为在那些不必要的连接中使用了更少的列？但是为什么在加入时查询执行需要其他列呢？它不应该先使用 PK 加入，然后只获取 10 行的列吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:49:19.837

我的理解是 mysql 引擎`limit`在任何`join`' 发生后都适用。

从[http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)，`The HAVING clause is applied nearly last, just before items are sent to the client, with no optimization. (LIMIT is applied after HAVING.)`

编辑：您可以尝试使用此查询来利用 PK 速度。

`select * from (select * from 'Order' order by OrderID desc limit 10) o join 'Store' s on s.StoreID = o.StoreID;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T23:51:50.380

您的所有示例都要求对现有表进行表扫描，因此它们的性能都不会超过 mysql 可以缓存数据或结果的程度。您的某些查询具有 order by 或 join 条件，这可以纯粹利用索引来提高连接过程的效率，但是，这仍然与拥有一组将触发使用索引的条件不同。

限制不是标准——一旦确定了结果集，就可以将其视为过滤。一旦准备好结果集，您就可以在客户端节省时间，而不是在服务器上。

确实，获得您正在寻找的答案的唯一方法是熟悉：EXPLAIN EXTENDED your_sql_statement

EXPLAIN 的输出将显示 mysql 正在查看多少行，以及是否正在使用任何索引。

# c++ - 为什么我的复制构造函数没有被调用？

> ID：13616425
> 
> 赞同：3
> 
> 时间：2012-11-28T23:42:57.437
> 
> 标签：c++, operator-overloading, copy-constructor

> **可能重复：**
> [什么是复制省略和返回值优化？](https://stackoverflow.com/questions/12953127/what-are-copy-elision-and-return-value-optimization)

我有以下程序：

```
#include <iostream>

using namespace std;

class Pointt {
public:
    int x;
    int y;

    Pointt() {
        x = 0;
        y = 0;
        cout << "def constructor called" << endl;
    }

    Pointt(int x, int y) {
        this->x = x;
        this->y = y;
        cout << "constructor called" << endl;
    }

    Pointt(const Pointt& p) {
        this->x = p.x;
        this->y = p.y;
        cout << "copy const called" << endl;
    }

    Pointt& operator=(const Pointt& p) {
        this->x = p.x;
        this->y = p.y;
        cout << "op= called" << endl;
        return *this;
    }
};

Pointt func() {
    cout << "func: 1" << endl;
    Pointt p(1,2);
    cout << "func: 2" << endl;
    return p;
}

int main() {
    cout << "main:1" << endl;
    Pointt k = func();
    cout << "main:2" << endl;
    cout << k.x << " " << k.y << endl;
    return 0;
} 
```

我期望的输出如下：

```
main:1
func: 1
constructor called
func: 2
copy const called
op= called
main:2
1 2 
```

但我得到以下信息：

```
main:1
func: 1
constructor called
func: 2
main:2
1 2 
```

问题是：为什么不将对象从 func 返回到 main 调用我的复制构造函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T23:44:46.150

这是由于[返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)。这是允许 C++ 更改程序行为以进行优化的少数实例之一。

# django - 通过 apache 的 django 正在工作，现在不是

> ID：13616427
> 
> 赞同：0
> 
> 时间：2012-11-28T23:43:17.273
> 
> 标签：django

我不确定发生了什么变化。对此相当陌生。

apache conf文件说：

> WSGIScriptAlias / /var/www/django/projects/django.wsgi

错误日志说：

> 文件不存在：/var/www/django/projects/django.wsgi/

不知道为什么它把斜杠放在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:31:21.933

我通过反复试验弄明白了。

我已经输入了这一行：

> SetHandler python 程序

但是当我把它拿出来时，它又可以工作了。我想我不明白这个命令。

# javascript - 获取 textarea 的值后克隆一次

> ID：13616428
> 
> 赞同：0
> 
> 时间：2012-11-28T23:43:19.707
> 
> 标签：javascript, jquery, html, jquery-ui

我有这个[http://jsfiddle.net/NgEpS/1/](http://jsfiddle.net/NgEpS/1/)基本上，我在每个表单上获取 textarea 的值并将值附加到子 div，第一次提交后一切正常，但如果你多次提交同一个表单，我的脚本正在克隆所有以前的回复，想知道​​是否有任何方法可以避免这种情况。

**HTML：**

```
 <div class="post-container">
            <form class="reply-form">
                <div class="reply-box">
                    <textarea placeholder="Reply box 1..." columns="10" rows="1" name="comment-input"></textarea>
                    <input type="submit" value="Send">
                </div>
                <div class="post-dropdown"></div>
                <div class="post-dropdown-content">
                    <div class="post-dropdown-reply">1</div>
                </div>
            </form>
        </div>

        <div class="post-container">
            <form class="reply-form">
                <div class="reply-box">
                    <textarea placeholder="Reply box 2..." columns="10" rows="1" name="comment-input"></textarea>
                    <input type="submit" value="Send">
                </div>
                <div class="post-dropdown"></div>
                <div class="post-dropdown-content">
                    <div class="post-dropdown-reply hidden"></div>
                </div>
            </form>
        </div>

        <div class="post-container">
            <form class="reply-form">
                <div class="reply-box">
                    <textarea placeholder="Reply box 3..." columns="10" rows="1" name="comment-input"></textarea>
                    <input type="submit" value="Send">
                </div>
                <div class="post-dropdown"></div>
                <div class="post-dropdown-content">
                    <div class="post-dropdown-reply">1</div>
                    <div class="post-dropdown-reply">2</div>
                    <div class="post-dropdown-reply">3</div>
                    <div class="post-dropdown-reply">4</div>
                </div>
            </form>
        </div>
        p​ 
```

**JavaScript：**

```
 function gettingReplyVal() {

            $('.reply-form').submit(function(e) {
                var post_clone =    $('.post-dropdown-content').first().clone();

                var textAreaValue = $(this).find('textarea').val();

                 $(post_clone).insertBefore($(this).f ind(".post-dropdown-content")).find('.post-dropdown-reply').html(textAreaValue); 

                e.preventDefault();

            });
        }

        gettingReplyVal(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:56:51.467

在这条线上

```
$(post_clone).insertBefore($(this).find(".post-dropdown-content")).find('.post-dropdown-reply').html(textAreaValue); 
```

`$(this).find(".post-dropdown-content")`返回里面的所有 post-dropdown-content 元素`this`。第一次点击发送，只有一个，所以它表现正常，但第二次找到两个，第三次找到三个，等等......

`$(this).find(".post-dropdown-content").first()`改为使用

```
$(post_clone).insertBefore($(this).find(".post-dropdown-content").first()).find('.post-dropdown-reply').html(textAreaValue); 
```

# python - Django-adaptors：如何正确使用更新元选项

> ID：13616431
> 
> 赞同：2
> 
> 时间：2012-11-28T23:43:28.303
> 
> 标签：python, django, csv

感谢您在这里阅读我的问题。

我正在为一家摄影公司开设网上商店，我需要读取一个 csv 文件来更新数据库中的产品。我正在使用[django-adaptors](http://django-adaptors.readthedocs.org/en/latest/)来迭代文件并保存信息，现在第一次运行良好，但如果再次运行该命令，应用程序会创建新对象而不是覆盖现有对象。

问题是我不知道使用更新元选项的正确方法是什么。[（您可以在文档](http://django-adaptors.readthedocs.org/en/latest/#meta-options)中看到它）

这是我现在拥有的代码：

```
from models import Type, Vendor, Product
from adaptor.model import CsvModel
from adaptor import fields as adaptor_fields

# Prepare functions here, but are not relevant information

class csv(CsvModel):
    mfr_code = adaptor_fields.CharField()
    main_photo_url = adaptor_fields.CharField()
    name = adaptor_fields.CharField()
    product_url = adaptor_fields.CharField()
    vendor = adaptor_fields.CharField(prepare=get_or_create_vendor)
    type = adaptor_fields.CharField(prepare=get_or_create_type)
    subtype = adaptor_fields.IgnoredField()
    description = adaptor_fields.CharField()
    specs = adaptor_fields.CharField()
    tags = adaptor_fields.CharField()
    stock = adaptor_fields.IntegerField(prepare=get_stock_value)
    price = adaptor_fields.IntegerField(prepare=format_usd)

    class Meta:
        delimiter = ','
        dbModel = Product
        update = {
            'keys': ['D1 Basic Kit 250/500', 'D1 Studio Kit 250/250']
        } 
```

正如您在上面看到的，我有带有“键”值的字典，但我不知道如何定义“自然键”列表，并且在尝试运行命令时出现 KeyError 异常。

有人可以解释一下正确的方法是什么吗？

谢谢回答。

克里斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T06:13:25.680

'keys' 应该指向一个字段名，而不是一个字段值。我猜“D1 Basic Kit 250/500”或“D1 Studio Kit 250/250”是名字，那么你应该有类似的东西：

```
class csv(CsvModel):
    mfr_code = adaptor_fields.CharField()
    main_photo_url = adaptor_fields.CharField()
    name = adaptor_fields.CharField()
    product_url = adaptor_fields.CharField()
    vendor = adaptor_fields.CharField(prepare=get_or_create_vendor)
    type = adaptor_fields.CharField(prepare=get_or_create_type)
    subtype = adaptor_fields.IgnoredField()
    description = adaptor_fields.CharField()
    specs = adaptor_fields.CharField()
    tags = adaptor_fields.CharField()
    stock = adaptor_fields.IntegerField(prepare=get_stock_value)
    price = adaptor_fields.IntegerField(prepare=format_usd)

    class Meta:
        delimiter = ','
        dbModel = Product
        update = {
            'keys': ['name']   # or mfr_code, main_photo_url, etc..., price
        } 
```

# - QFileDialog

> ID：13616435
> 
> 赞同：0
> 
> 时间：2012-11-28T23:44:01.550
> 
> 标签：

QFileDialog 是 Qt 工具包中的一个类，它提供了一个允许用户选择文件或目录的对话框。

# ajax - 在 Breeze 中设置 AJAX 标头

> ID：13616445
> 
> 赞同：5
> 
> 时间：2012-11-28T23:44:59.580
> 
> 标签：ajax, breeze

> 在让微风发出请求之前如何设置标头？
> 
> 示例：我的服务期望某个键成为标头名称“x-service-key”中请求的一部分。到目前为止，我一直在使用 jquery ajax 和 amplify，所以很容易设置标题。由于我无法控制微风发出的请求，我如何传递标头之类的额外内容？

这个问题是由 sujesharukil 在我们的 IdeaBlade 论坛上发布的。我在这里重新发布问题和答案，因为我认为它对 Breeze Stack Overflow 社区很有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T23:44:59.580

从 Breeze 0.70.1 开始，我们现在支持完全自定义或替换微风客户端和服务器上的 Web 服务之间的任何 Ajax 通信的能力。

关于我们的 Ajax 支持的 Breeze 文档仍在进行中，但希望以下内容可以帮助您入门。

要控制 Breeze 发出的每个 Ajax 请求的标头，您可以在应用程序首次启动时执行以下代码。

```
 var ajaxImpl = breeze.config.getAdapterInstance("ajax");
 ajaxImpl.defaultSettings = {
       headers: { 
           // any CORS or other headers that you want to specify.
           "X-Test-Header": "foo2" 
       },
}; 
```

或者，您可以拦截各个 Ajax 调用并根据请求有选择地添加标头。

```
 var ajaxImpl = breeze.config.getAdapterInstance("ajax");
 ajaxImpl.defaultSettings = {
       beforeSend: function(jqXHR, settings) {
              // examine the jqXHR or settings and customize the headers accordingly.
              jqXHR.setRequestHeader("X-Test-Before-Send-Header", "foo2");
       }
 }; 
```

# webrtc - 与 WebRTC 共享屏幕？

> ID：13616449
> 
> 赞同：32
> 
> 时间：2012-11-28T23:45:07.367
> 
> 标签：webrtc, screensharing

我们正在探索 WebRTC，但看到了关于目前可能和支持的信息的相互矛盾的信息。

使用 WebRTC，是否可以重新创建类似于 join.me 或 WebEx 的屏幕共享服务，其中：

*   您可以共享屏幕的一部分
*   你可以把控制权交给对方
*   无需下载

今天使用任何 WebRTC 浏览器都可以做到这一点吗？iOS 上的 Chrome 怎么样？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-29T23:05:26.873

[chrome.tabCapture API](https://developer.chrome.com/trunk/extensions/tabCapture.html)可用于 Chrome 应用程序和扩展程序。

这使得可以将选项卡的可见区域捕获为可以在本地使用或通过 RTCPeerConnection 的 addStream() 共享的流。

有关更多信息，请参阅[WebRTC 选项卡内容捕获提案](http://www.chromium.org/developers/design-documents/extensions/proposed-changes/apis-under-development/webrtc-tab-content-capture)。

屏幕共享最初支持使用带有 chromeMediaSource 约束的 getUserMedia 的“普通”网页——但这已被禁止。

编辑 2015 年 4 月 1 日：现已编辑，仅 Chrome 应用程序和扩展程序中的 Chrome 支持屏幕共享。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-20T09:42:27.673

你们可能知道屏幕捕获（不是 tabCapture ）在 Chrome Canary (26+) 中可用，我们最近刚刚发布了一个演示；[https://screensharing.azurewebsites.net](https://screensharing.azurewebsites.net)

请注意，您需要在 https:// 下运行它，

```
video: {
  mandatory: {
    chromeMediaSource: 'screen'   
  } 
```

你也可以在这里找到一个例子； [https://html5-demos.appspot.com/static/getusermedia/screenshare.html](https://html5-demos.appspot.com/static/getusermedia/screenshare.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-26T01:56:30.683

我知道我回答得有点晚了，但希望它可以帮助那些偶然发现该页面的人，如果不是 OP。

目前，Firefox 和 Chrome 都支持通过 WebRTC 与对等方共享整个屏幕或部分屏幕（您可以选择的某些应用程序窗口）作为媒体流，就像您的相机/麦克风提要一样，因此无法让其他方控制你的桌面呢。除此之外，还有另一个问题，您的网站必须在`https`模式下运行，并且在 firefox 和 chrome 中，用户都必须安装扩展程序。

您可以在这个 Muaz Khan 的[屏幕共享演示](https://www.webrtc-experiment.com/screen-sharing/)中尝试一下，该页面也包含所需的扩展。

P.S：如果你不想安装扩展来运行demo，在firefox中（chrome中没有办法转义扩展），你只需要修改两个标志，

*   去`about:config`
*   设置`media.getusermedia.screensharing.enabled`为`true`。
*   添加`*.webrtc-experiment.com`到`media.getusermedia.screensharing.allowed_domains`标志。
*   刷新演示页面并单击共享屏幕按钮。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-29T00:24:38.720

据我所知，目前任何浏览器都不可能，尽管 Google Chrome 团队表示他们最终打算支持这种情况（请参阅他们[路线图上的“屏幕共享”要点）](http://blog.chromium.org/2012/04/chromes-webrtc-roadmap.html)); 而且我怀疑这意味着最终其他浏览器会跟进，大概是 IE 和 Safari 会出现尾随。但所有这些可能都在 2 月之后的某个地方发布，届时他们应该最终确定当前的 WebRTC 标准并交付生产位。（希望微软在最后一分钟的工作不会搞砸。）我可能错过了最近的一些事情，但我一直在非常仔细地关注这个项目，我认为屏幕共享甚至没有成功还没有进入 Chrome Canary，更不用说 dev/beta/prod。Opera 是唯一在其 WebRTC 实施上与 Chrome 保持同步的浏览器（FireFox 似乎落后了大约六个月），我也没有看到该团队关于屏幕共享的任何信息。

有人告诉我，现在有*一种*方法可以做到这一点，那就是编写您自己的网络摄像头驱动程序，以便您的本地屏幕显示为 WebRTC getUserMedia() API 只是另一个视频源。我不知道有人这样做过——当然，这需要在有问题的机器上安装驱动程序。到所有的事情都说完了，使用 VNC 或类似的东西可能会更容易。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-14T05:21:09.240

有一个开源的 chrome 扩展可以做到这一点。请查看 [https://github.com/ant-media/Chrome-Screen-Capture-Extension](https://github.com/ant-media/Chrome-Screen-Capture-Extension)

Github Wiki 上还有一个使用扩展的文档

[https://github.com/ant-media/Ant-Media-Server/wiki/WebRTC-Screen-Sharing](https://github.com/ant-media/Ant-Media-Server/wiki/WebRTC-Screen-Sharing)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-07T09:06:43.077

```
navigator.mediaDevices.getDisplayMedia(constraint).then((stream)=>{
// todo...
}) 
```

现在你可以做到了，但 Safari 在音频方面与 Chrome 不同。

# java - 奇怪的无法访问但可编译的代码

> ID：13616450
> 
> 赞同：0
> 
> 时间：2012-11-28T23:45:08.913
> 
> 标签：java, arrays, multidimensional-array

好吧，我在我的类 Object2D 中使用了这个方法 Resize，它应该调整 Object2D 的二维颜色数组 PointInformation 的大小，它被调用到某个百分比。（我发现将 2D 阵列转换为 1D 阵列时更容易做到）

```
public class Object2D

{
int width;
int height;
int ResizePercentage = 100;
Color PointInformation[][];

public void Resize(int Percentage)
{
    Color[]temp = Standart_Methods.Reduce2DArray(this.PointInformation);
    int temp_width = this.width;
    int temp_height = this.height;
    double Faktor = (Percentage+100)/100;
    this.width = (int) (this.width*Faktor);
    this.height = (int) (this.height*Faktor);
    this.ResetPointInformation();
    Color[]temp2 = Standart_Methods.Reduce2DArray(this.PointInformation);

    int SamePixelCount = 0;
    Color LastColor = temp[0];
    for (int i = 0; i < temp.length; i++)
    {
        if (temp[i] == LastColor )
        {
            SamePixelCount += 1;
        }
        else
        {
            for (int i2 = (int) (i*Faktor); i == 1; i-- )
            //Method Resize will only be called when i*Faktor is going to be 100% = X.0 (An Integer)
            {
            temp2[i*2-i] = LastColor;      
            }
            SamePixelCount = 0;
        }
    }
    Standart_Methods.PrintArray(temp2);
    int a = 10;
    int b = 0;
    System.out.print(a/b); //No Exeption, Code unreachable!?       
}
} 
```

它基本上从 temp[0] 开始，只要找到相同的颜色，就将 int SamePixelCount 加 1。当找到不同的颜色时，该方法将先前像素的颜色写入 temp2 数组中的正确位置。

```
for (int i = 0; i < temp.length; i++)
{
    if (temp[i] == LastColor )
    {
        SamePixelCount += 1;
    }
    else
    {
        for (int i2 = (int) (i*Faktor); i == 1; i-- )
        //Method Resize will only be called when i*Faktor is going to be 100% = X.0 (An Integer)
        {
        temp2[i*2-i] = LastColor;      
        }
        SamePixelCount = 0;
    }
} 
```

操作数组 temp2 到对象的 PointInformation 的正确转换仍然缺失，因为我想测试 temp2 是否正确调整了 temp 的大小，所以我做了

```
Standart_Methods.PrintArray(temp2); //the Method works btw 
```

但它什么也没做！甚至更糟！我放在那个命令的地方的所有东西，也没有！

```
 int a = 10;
    int b = 0;
    System.out.print(a/b); //No Exeption! 
```

更奇怪的是，一旦我调用 Method **Resize**，在某个地方，调用之后的所有内容都变成了同样奇怪的无法访问的代码！？

我对可能导致此问题的原因完全一无所知。

**你能帮忙的话，我会很高兴！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:56:21.387

除以零肯定会给你 ArithmeticException：

```
public class Test {
    public static void main(String[] args) {
        int a = 10;
        int b = 0;
        System.out.println(a/b);
    }
}   

Exception in thread "main" java.lang.ArithmeticException: / by zero
at Test.main(Test.java:14) 
```

我建议使用 eclipse 并使用调试器跟踪您的代码。检查每个代码行的变量，我相信您可以找出我们的问题所在

# ruby-on-rails - Rails 自定义嵌套更新未更新

> ID：13616452
> 
> 赞同：0
> 
> 时间：2012-11-28T23:45:22.703
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, controller, nested-attributes

我的应用程序有一个 Animal 模型，它有许多（并接受嵌套属性）包。在我的 Animals Controller 中，我创建了以下操作，以允许在单独的页面（以及单独的用户角色）中编辑某些 Animal（和嵌套的包）属性，而不是用于正常动物编辑的页面。（澄清一下，我有一个animals#edit 动作和页面，以及一个单独的animals#log 动作和页面，理想情况下允许不同的用户角色编辑关于动物的不同内容）：

```
def log
    @animal = Animal.find(params[:animal_id])

    if params[:animal]
      if @animal.update_attributes(params[:animal])
        # I want a basic reload (with flash) in cases of both success and failure.
        redirect_to log_path(@animal), notice: "Animal update successful!"
      else
        redirect_to log_path(@animal), notice: "Update unsuccessful. Contact admin"
      end
    end
end 
```

我单独的编辑/更新操作：

```
 def update
    @animal = Animal.find(params[:id])

    if @animal.update_attributes(params[:animal])
        redirect_to @animal, notice: "Animal was successfully updated."
    else
        render action: "edit"
    end
  end

def edit
    @animal = Animal.find(params[:id])
end 
```

问题是，当我在日志页面（下面的代码）中点击提交按钮时，它会刷新页面，但是 a）没有任何通知（小问题），并且 b）更重要的是，没有实际更新包信息. 重要的是，如果我更新了 animal.weight 属性（这里唯一可修改的 ANIMAL 属性），那就可以了。只是不是嵌套的包属性。

帮助？我真的很难过。我一直在摆弄这个，试图让它发挥作用。下面一些可能相关的代码：

在我的 routes.rb 文件中（动物资源之上）：

```
match '/animals/:animal_id/log' => "animals#log", as: :log 
```

这是我的日志视图：

```
<%= form_for(@animal, :url => { :action => "log" }, :method => :put) do |f| %>  

    <div style="width: 200px">
        <% if @animal.weight %>
            <%= "Weight: #{@animal.weight}lbs" %>
        <% else %>
            <%= f.label "Weight (in lbs)" %>
            <%= f.text_field :weight %>
        <% end %>
    </div>

    # I'm cycling through each bundle to group "identical" packages in a table (one per bundle).

    <% @animal.sold_bundles.each do |bundle| %> <!-- Packages are bundled by cut and prep notes -->
      <%= render partial: 'package_bundle', locals: {:bundle => bundle, :f => f} %><br>
    <% end %>

  <%= f.submit "Submit Animal Log", :class => "btn image-button right" %>

<% end %> 
```

这是为每个捆绑包调用的“package_bundle”部分。它会生成一个包表，有些是可编辑的（因为 true_weight 值为空白），有些则不是：

```
<table class="table">
    <thead>
        <tr>
            <th>Cut Name</th>
            <th>Prep Notes</th>
            <th>Label</th>              
            <th>Actual Lbs</th>
            <th>Actual Oz</th>
        </tr>
    </thead>
    <tbody>
        <!-- list of specified packages -->
            <%= f.fields_for :packages, bundle do |p| %>
                    <tr>
                        <td><%= p.object.name %></td>
                        <td><%= "#{p.object.user.name.first(3).upcase}-#{p.object.id}" %></td>
                        <% if p.object.true_weight == nil || p.object.true_weight == 0 %>
                            <td colspan=1><%= p.text_field :actual_lbs %></td>
                            <td colspan=1><%= p.text_field :actual_oz %></td>
                        <% else %>
                            <td><%= p.object.true_weight.round(0) %> lb</td>
                            <td><%= ((p.object.true_weight % 1) * 16).round(2)%> oz </td>
                        <% end %>  
                    </tr>   
            <% end %>  

    </tbody>
</table> 
```

编辑——应要求提供更多代码

package.rb （只是相关的）——我避开了下面的问题（这次；我以前肯定犯过这个错误）。我将 lbs/oz 转换为 lbs with percent 的方法有可能在这里受到责备，但它看起来对我来说是正确的：

```
class Package < ActiveRecord::Base
  attr_accessible :animal_id, :cut_id, :price, :line_id, :sold, :savings, :actual_lbs, :actual_oz, :true_weight
  attr_accessor :actual_lbs, :actual_oz
  belongs_to :animal
  belongs_to :cut
  belongs_to :line
  before_update :to_true

def to_true
    if self.sold
      if self.order.status > 1 # This is the case for any package loaded on the log page
        if self.actual_lbs && self.actual_oz
          unless self.true_weight && self.true_weight > 0 # Don't overwrite legit true weights
            percent = self.actual_oz / 16
            self.update_attribute(:true_weight, self.actual_lbs + percent)
          end
        end
      end
    end
  end 
```

animal.rb（仅相关）：

```
class Animal < ActiveRecord::Base
  attr_accessible :breed, :name, :photo, :animal_type, :hanging_weight, :meat_weight,  
                  :weight, :ranch_id, :butcher_id, :cow_mult, :pig_mult, :packages_attributes,
                  :lamb_mult, :goat_mult, :host_id, :final_sale, :opening_sale, :open, :no_sales
  has_many :orders
  has_many :packages
  belongs_to :butcher
  belongs_to :ranch
  belongs_to :host
  after_create :create_packages

  accepts_nested_attributes_for :packages 
```

查看我的服务器日志（我比开发日志更容易理解），深入了解这一点，并注意到两件奇怪的事情。根本没有错误，但是 1）它似乎在我加载页面时执行了 GET，但在我点击提交时没有执行请求的 PUT，并且 2）可能因此，唯一的参数传递了（传递为GET 请求的一部分）是动物 ID；没有传递包属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:59:38.833

你能发布你的模型代码吗？在您的情况下，一个常见的“陷阱”不是添加`package_attributes`到`attr_accessible`动物模型中。它不会引发错误，但会隐藏在开发日志中，在 SQL 条目之前，您将看到批量分配警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T16:40:39.043

`attr_accessor`不会触发回调。您必须使变量“脏”。更多信息[在这里](http://tamersalama.com/2011/11/10/rails-nested-attributes-and-before_save-callbacks/)。

在你的`package.rb`：

```
def actual_lbs=(val)
  true_weight_will_change!
  @actual_lbs=val
end 
```

这将使得当它设置actual_lbs 变量时，它会“弄脏”数据库中的一个变量，从而触发回调。

# matlab - 如何在 Matlab 中为轴上的值分配单个标签？

> ID：13616453
> 
> 赞同：0
> 
> 时间：2012-11-28T23:45:39.890
> 
> 标签：matlab, plot, octave, matlab-figure

我在matlab中有一个矩阵。每行/列都有一个唯一的标签。这些标签在一个行矩阵中。如何在该行/列号旁边的图形上打印这些标签？没关系显示的笨拙，我想查看行的标签而不是行号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:57:05.513

如果我正确理解你的问题，你有一个像

```
pcolor(magic(4)); 
```

和类似的标签

```
lbl = ['a'; 'b'; 'c'; 'd']; 
```

按照我的示例，您有 X 和/或 Y 的四个标签。从这里您需要做的就是将轴的 XTicks 设置为您拥有的标签数量，然后像这样设置 XTickLabels：

```
set(gca,'XTick',1:length(lbl),'XTickLabel',lbl) 
```

# python - 当提供的默认值不是元组时，为什么 python 中的链式字典 .get() 返回一个元组？

> ID：13616455
> 
> 赞同：12
> 
> 时间：2012-11-28T23:45:43.577
> 
> 标签：python, dictionary, get, tuples, chained

Python 2.6.6 当我在 .get 的结果上调用 .get 时，结果是一个元组。这对我来说毫无意义。例子：

```
box = {}.get('test1',{}).get('test2','hrmm'),
print type(box) 
```

打印出来

```
<type 'tuple'> 
```

这对我来说毫无意义。显然，第二次获取的默认值是一个简单的字符串。那么什么给了？感谢您的任何见解。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-28T23:48:16.813

你在行尾有一个逗号，所以你得到了`{}.get('test1',{}).get('test2','hrmm')`一个单元素元组的结果。

这是一个如何使用简单文字的示例：

```
>>> box = 1,
>>> box
(1,)
>>> type(box)
<type 'tuple'> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T23:47:59.147

您的方框作业中有一个尾随逗号

# python - Python 不会取消缓冲打印语句

> ID：13616458
> 
> 赞同：3
> 
> 时间：2012-11-28T23:45:58.500
> 
> 标签：python, output-buffering

我有以下程序：

```
def main():
    print "Running"
    primes = sieve(100000)
    print "Sieve is done"

def sieve(n):
    print "starting sieve"
    primes = []
    times = 0

    numbers = range(2, n):
    print "sieve array filled"

    while len(numbers) > 0:
        current = numbers[0]
        primes.append(current)
        numbers.remove(current)

        times = times + 1
        if (times % 10 == 0):
            print str(times) + "th prime is " + str(current)

        # Remove every multiple
        for i in numbers:
            if (i % current == 0):
                numbers.remove(i) 
```

当找到一个大数的所有素数（比如说一万个）时，我希望能够通过查看输出来了解程序有多远。所以我决定每十个素数打印一次。但是，当打印出来时，它会等到程序的最后才打印它。我在`sys.stdout.flush()`打印语句之后立即添加，但没有任何区别。然后我尝试运行脚本，`python -u <file name>`但仍然没有任何区别。

这就是我得到的输出：

```
Running
starting sieve
sieve array filled 
```

然后大约一分钟后，立即显示其余的输出。

为什么我不能关闭缓冲区？我正在尝试尽可能少地修改代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:23:30.630

测试了一些东西后，我不确定您的问题实际上是输出缓冲，这只是您的算法的行为。尝试在循环`current`顶部附近打印`while`，您会发现早期的数字需要很长时间才能完成，然后随着`numbers`越来越短，每个新值的`current`处理速度都会更快，您会开始看到素数弹出。

尝试：

```
while len(numbers) > 0:
    current = numbers[0]
    print current
    primes.append(current)
    numbers.remove(current) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:38:28.493

这么慢的原因是您从数字中删除元素的循环：

```
 # Remove every multiple
    for i in numbers:
        if (i % current == 0):
            numbers.remove(i) 
```

每次删除一个数字时，Python 都必须将删除的那个数字后面的所有元素移回一个位置。每次删除都是 O(n)*，并且您执行 O(n) 次删除，因此此步骤的每次迭代都需要 O(n^2) 时间。

如果你用列表推导替换它，那么 Python 从旧列表构建一个新列表——不涉及移动——这是一个 O(n) 操作。这是我执行该步骤的方式：

```
 # Remove every multiple
    numbers = [i for i in numbers if (i % current) != 0] 
```

通过此更改，您的代码对我来说运行*得*更快。它在 5 秒内完成，并且没有输出缓冲问题。

[*这里](http://wiki.python.org/moin/TimeComplexity#list)有一个很好的 Python 列表操作的时间复杂度表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:10:17.840

尝试使用`sys.stdout.write`而不是`print`. 这应该更好地与`sys.stdout.flush`.

# ruby - Ruby 中一种高效的数字键控数据结构

> ID：13616460
> 
> 赞同：0
> 
> 时间：2012-11-28T23:46:19.890
> 
> 标签：ruby

人们想要存储对象，允许通过数字键检索它们。这些键的范围可以从 0 到任意大小（例如，~100K），但不是范围内的每个自然数都有对应的对象。

一个人可能有以下几点：

```
structure[0] => some_obj_a
structure[3] => some_obj_b
structure[7] => some_obj_c
...
structure[100103] => some_obj_z 
```

但是所有其他键（1、2、4、5、6、...）都没有关联的对象。数字键用于检索，因此提供“ID”以返回与该 ID 关联的对象：

```
ID = get_input_id
my_obj = structure[ID] 
```

Ruby 中这种场景最有效的数据结构是什么？出于什么原因？（到目前为止，我可以看到它是一个散列或一个数组。）

我将“高效”定义为：

*   使用最少的内存
*   最快的查找时间
*   最快的条目创建/更新（任意键）

此结构的初始化可能是

```
hsh = Hash.new # or Array.new
hsh[0] = {:id => 0, :var => "a", :count => 45}
hsh[3] = {:id => 3, :var => "k", :count => 32}
hsh[7] = {:id => 7, :var => "e", :count => 2} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T23:56:52.093

您基本上已经描述了稀疏数组或散列。

散列很快，只使用他们必须使用的内存。它们还具有内存效率。没有“神奇”的数据结构可以更快。使用哈希。

# silverlight - Caliburn Micro 从后面的代码中订阅 onpropertychanged 事件

> ID：13616463
> 
> 赞同：0
> 
> 时间：2012-11-28T23:46:32.157
> 
> 标签：silverlight, mvvm, caliburn.micro

我正在开发一个带有文件查看器的 silverlight 项目。此文件查看器没有 Source 属性或其他接受流的属性。它确实有一个 LoadDocument(Stream file) 方法。由于文件将被异步加载，我需要“通知”视图缓冲区可用，然后让视图调用 LoadDocument 方法。

在 MVVMLight 中，我可以使用“Messenger”功能来做到这一点。我看到了 EventAggregator，但我看到的一切都让通信走向了另一个方向。我觉得这应该很容易做到，但我只是不明白。

Views 构造函数中是否可以将方法绑定到 ViewModel 的属性？这似乎与在 xaml 中完成的功能相同，我只想在后面的代码中完成。

谢谢

dbl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:09:43.547

不确定帖子，但听起来您想将控件中的事件绑定到视图上的方法

在这种情况下：

```
<SomeControl cal:Message.Attach="[Event SomeEvent] = [Action SomeMethod($eventArgs)]" /> 
```

如果反过来，您可以使用事件聚合器（视图可以订阅事件......为什么不呢，它仍然是解耦的......）

虚拟机：

```
SomeEventAggregator.Publish(new SomeMessageInstanceThatTheViewWillSubscribeTo()); 
```

看法：

```
class SomeView : UserControl, IHandle<SomeMessageInstanceThatTheViewWillSubscribeTo>

// dont forget to...
SomeEventAggregator.Subscribe(this); 
```

或者 - 在视图上实现一个接口

```
class SomeView : UserControl, IAcceptSomeNotificationMessage
{
    public void Notify() { // blah
    }
} 
```

虚拟机：

```
class SomeViewModel : Screen // whatever 
{
    void SomeMethod() 
    {
        // The VM should be IViewAware so will implement GetView()
        var view = GetView();

        if(view is IAcceptSomeNotificationMessage)
            (view as IAcceptSomeNotificationMessage).Notify();
    }
} 
```

选择上述之一 - 我相信还有更多方法。我通常使用事件聚合器——当然这取决于你使用了多少 IoC 以及一切的解耦程度。

# java - 任何允许类似于 STL map::insert 的条件插入的 Java Map 实现？

> ID：13616468
> 
> 赞同：3
> 
> 时间：2012-11-28T23:47:17.163
> 
> 标签：java

我只想在键不存在的情况下将键值对插入到 Map 中，否则我想检索现有值而不替换它。我可以使用 get() 来完成此操作，然后是条件 put()。但是，这需要两次解析 Map 中键的位置（2 个哈希、2 个树遍历等，具体取决于 map 实现），这似乎是不必要的。是否有任何标准 Map 实现允许压缩此操作，类似于 map::insert 在 C++ STL 中的工作方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T23:48:00.377

`ConcurrentMap`有`putIfAbsent`方法。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)

# android - 有没有办法使用 Intents 向新日历事件添加提醒？

> ID：13616470
> 
> 赞同：11
> 
> 时间：2012-11-28T23:47:35.497
> 
> 标签：android, android-calendar, android-2.1-eclair

我需要支持 Android 2.1 及更高版本。我知道 CalendarContract 在 Android 2.1 中不可用，所以我完成了以下解决方法。

```
Intent intent = new Intent(Intent.ACTION_EDIT)
                        .setType("vnd.android.cursor.item/event")
                        .putExtra("beginTime", beginTime.getTimeInMillis())
                        .putExtra("title", title)
                        .putExtra("description", description)
                        .putExtra("eventLocation", location)
                        .putExtra("allDay", allDay)
                        .putExtra(Intent.EXTRA_EMAIL, email );
                if(!allDay) {
                    intent.putExtra("endTime", endTime.getTimeInMillis());
                }

               startActivity(intent); 
```

到目前为止，这非常有效。我已经在 2.1 到 4.1 上进行了测试。

我也想添加提醒，但我找不到任何有关如何使用 Intents 进行提醒的文档。有人有例子吗？我想避免向我的清单添加更多权限以写入日历，因此如果您有需要这样做的建议，我将无法使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T06:02:34.377

如果你查看stock android Calendar source [code](http://androidxref.com/4.1.1/xref/packages/apps/Calendar/src/com/android/calendar/event/EditEventActivity.java)，无法使用intent添加提醒。

而不是这个`calendar`有一个设置来设置默认提醒。但是一些原始设备制造商可能已经实施了这一点。因此，即使您找到它，它也不适用于所有手机。

# clojure - Clojure 可以不用 let 吗？

> ID：13616471
> 
> 赞同：6
> 
> 时间：2012-11-28T23:47:41.543
> 
> 标签：clojure

我发现我很少`let`在 Clojure 中使用。出于某种原因，当我开始学习时，我不喜欢它，并且从那以后一直避免使用它。来的时候，感觉就像流动停止了一样`let`。我想知道，你认为我们可以完全没有它吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-28T23:49:56.187

让我们提供一些好处。首先，它允许在函数上下文中进行值绑定。其次，它具有可读性优势。因此，虽然从技术上讲，人们可以取消它（从某种意义上说，你仍然可以在没有它的情况下进行编程），但如果没有有价值的工具，这种语言就会变得贫乏。

let 的好处之一是它有助于形式化一种指定计算的通用（数学）方式，在这种方式中，您引入了方便的绑定，然后是一个简化的公式。很明显，绑定仅适用于该“范围”，并且与更数学的公式相关联是有用的，尤其是对于更多功能的程序员。

让块出现在 Haskell 等其他语言中并非巧合。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-28T23:50:02.737

您可以替换任何出现的`(let [a1 b1 a2 b2...] ...)`by`((fn [a1 a2 ...] ...) b1 b2 ...)`所以是的，我们可以。虽然我经常使用 let ，但我宁愿不要没有它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-29T00:13:27.540

在防止宏中多次执行方面，Let 对我来说是必不可少的：

```
(defmacro print-and-run [s-exp]
   `(do (println "running " (quote ~s-exp) "produced " ~s-exp)
        s-exp)) 
```

会运行 s-exp 两次，这不是我们想要的：

```
(defmacro print-and-run [s-exp]
  `(let [result# s-exp]
    (do (println "running " (quote ~s-exp) "produced " result#)
        result#)) 
```

通过将表达式的结果绑定到名称并引用该结果两次来解决此问题。

因为宏返回的表达式将成为另一个表达式的一部分（宏是生成 s 表达式的函数），所以它们需要生成**本地绑定以防止多次执行并避免符号捕获**。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-29T03:22:45.177

我想我理解你的问题。如果有错请纠正我。有时“let”用于命令式编程风格。例如，

```
... (let [x (...)
          y (...x...)
          z (...x...y...)
          ....x...y...z...] ... 
```

这种模式来自命令式语言：

```
... { x = ...;
      y = ...x...;
      ...x...y...;} ... 
```

你避免这种风格，这就是为什么你也避免“让”，不是吗？

在某些问题中，命令式风格会减少代码量。此外，有时用 java 或 c 编写效率更高。同样在某些情况下，“let”只保存子表达式的值，而不管评估顺序如何。例如，

```
(... (let [a (...)
           b (...)...]
        (...a...b...a...b...) ;; still fp style 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-14T16:07:03.017

-bindings至少有两个重要的用例`let`：

首先，`let`正确使用可以让你的代码更清晰、更短。如果你有一个多次使用的表达式，将它绑定在 a`let`中是非常好的。`map`这是使用的标准函数的一部分`let`：

```
...
(let [s1 (seq c1) s2 (seq c2)]
  (when (and s1 s2)
    (cons (f (first s1) (first s2))
          (map f (rest s1) (rest s2)))))))
... 
```

即使您只使用一次表达式，给它一个语义上有意义的名称仍然是有帮助的（对代码的未来读者）。

其次，正如 Arthur 所提到的，如果您想多次使用表达式的值，但只想对其进行一次评估，则不能简单地将整个表达式输入两次：您需要某种绑定。如果您有一个纯表达式，这将只是浪费：

```
user=> (* (+ 3 2) (+ 3 2))
25 
```

但如果表达式有副作用，实际上会改变程序的含义：

```
user=> (* (+ 3 (do (println "hi") 2)) 
          (+ 3 (do (println "hi") 2)))
hi
hi
25

user=> (let [x (+ 3 (do (println "hi") 2))] 
         (* x x))                      
hi
25 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-26T23:31:18.170

最近偶然发现了这个，所以运行了一些时间：

```
(testing "Repeat vs Let vs Fn"
  (let [start (System/currentTimeMillis)]
    (dotimes [x 1000000]
      (* (+ 3 2) (+ 3 2)))
    (prn (- (System/currentTimeMillis) start)))

  (let [start (System/currentTimeMillis)
        n (+ 3 2)]
    (dotimes [x 1000000]
      (* n n))
    (prn (- (System/currentTimeMillis) start)))

  (let [start (System/currentTimeMillis)]
    (dotimes [x 1000000]
      ((fn [x] (* x x)) (+ 3 2)))

    (prn (- (System/currentTimeMillis) start)))))

Output
Testing Repeat vs Let vs Fn
116
18
60 
```

“让”胜过“纯”功能。

# c++ - 如何在 Windows 上安装 protobuf？(Win7x64/MinGW)

> ID：13616477
> 
> 赞同：3
> 
> 时间：2012-11-28T23:48:00.243
> 
> 标签：c++, mingw, protocol-buffers, autotools

C++-Protobuf 不能在 VS2012 中编译。现在我想用MinGW在windows上编译它。有人可以给我一些关于如何在 Win7 x64 上编译 protobuf 的简短标题。我已经使用 GUI 安装程序安装了 MinGW。谷歌在 MinGW 设置通知中写道，我应该参考 Unix 安装说明。但我不知道如何在 Windows 上使用自动工具。

**编辑**

好的，这就是我到目前为止所做的：

```
$ mount C:/ WinDir
$ cd ./[...]/protobuf.2.4.1
$ ./configure
$ minGW32-make.exe
$ minGW32-make.exe check 
```

minGW32-make.exe 运行没有错误，但没有运行测试，我找不到 libprotobuf.lib。有一些 libprotobuf.dll 但我需要 lib，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T10:32:52.703

你应该有一个 MSys 控制台和你的 MinGW 安装。这个控制台提供了一个类似 linux 的环境，您应该能够在其中正常使用 autotools。

如果未安装 MSys，您也可以从 MinGW 站点获取它。

`cd`到您的目录与源代码并尝试通常：

```
$ ./configure
$ make 
```

一些库在 Windows 上会导致问题，但大多数都可以很好地与 MinGW 和 MSys 一起编译。如果您遇到特定问题，请返回并为您的问题添加更多信息。

* * *

编辑：

> minGW32-make.exe 运行没有错误，但没有运行测试，我找不到 libprotobuf.lib。有一些 libprotobuf.dll 但我需要 lib，不是吗？

通常对于动态库，您会得到`protobuf.dll`（动态库）和`libprotobuf.a`（静态包装库）。

链接时，只需传递`-lprotobuf`给链接器 - 它会同时查找`libprotobuf.a`和`protobuf.lib`。

（`.lib`是另一种静态库格式，由 MinGW 部分处理，但这里不是原生的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T11:36:36.240

`.lib`使用 MinGW 工具链时，您不会使用文件。相反，您可以直接链接到 dll。[MinGW Wiki 对此进行了解释](http://www.mingw.org/wiki/sampleDLL)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-03-24T15:24:41.567

我可以同时获得 dll 和 lib 。这是当您不想要静态 lib 文件并想要使用 dll 和 lib 文件时。您需要在 Protobuf 代码中进行以下更改：

1.  在 VS 中打开项目。或任何其他编辑器。我使用VS2015。
2.  在 libProtoBuf 项目设置中，在 C/C++ 预处理器中添加以下标志。PROTOBUF_USE_DLLS；LIBPROTOBUF_EXPORTS；这些标志将使用 dllexport 从 profobuf 导出信息

3.  在您使用 Protobuf 的客户端代码中，定义：PROTOBUF_USE_DLLS。这将使 protobuf 包含使用 dllimport。

完成第 2 步后，您将在输出文件夹中看到 dll 和 lib。否则，您将始终只看到 dll 而不是 lib 文件。

希望这可以帮助。如果没有，请在此处留言，我可以帮助您解决此问题。

# javascript - 为什么将生成的代码复制到不同目录中的 html 文件后，Adobe Edge 动画不起作用？

> ID：13616478
> 
> 赞同：7
> 
> 时间：2012-11-28T23:48:07.633
> 
> 标签：javascript, animation, directory, adobe-edge

我试图将 Edge 生成的所有文件与我的主文件分开。

这是它发布的文件中的 html：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<title>Untitled</title>
<!--Adobe Edge Runtime-->
<script type="text/javascript" charset="utf-8" src="anim_edgePreload.js"></script>
<style>
    .edgeLoad-EDGE-20819118 { visibility:hidden; }
</style>
<!--Adobe Edge Runtime End-->

</head>
<body style="margin:0;padding:0;">
<div id="Stage" class="EDGE-20819118">
</div>
</body>
</html> 
```

我将代码复制到包含所有生成文件的动画文件夹之外的 html 文件中，并更改了它所引用的 JS 文件的目录。

anim_edgePreload.js --> edgeAnimation/anim_edgePreload.js

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<title>Untitled</title>
<!--Adobe Edge Runtime-->
<script type="text/javascript" charset="utf-8" src="edgeAnimation/anim_edgePreload.js"></script>
<style>
    .edgeLoad-EDGE-20819118 { visibility:hidden; }
</style>
<!--Adobe Edge Runtime End-->

</head>
<body style="margin:0;padding:0;">
<div id="Stage" class="EDGE-20819118">
</div>
</body>
</html> 
```

动画不再出现在页面上，知道为什么吗？

几秒钟后，我在 Firebug 中收到此错误：

TypeError：AdobeEdge.okToLaunchComposition 不是函数

函数 edgeCallback(a){htFallbacks[a]&&(a=htFallbacks[a]);AdobeEdge.preload.got[a]=!0;if(a==AdobeEdge.preload.last)AdobeEdge.okToLaunchComposition(compId), AdobeEdge.preload.busy=!1,AdobeEdge.preload.q.length>0&&(a=AdobeEdge.preload.q.pop(),AdobeEdge.requestResources(a.files,a.callback))}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T22:53:18.163

确实没有必要投反对票，这是一个有效的问题，几天来我一直遇到类似的问题。考虑到新的 Edge Animate 有多新以及每个构建有多么不同，缺乏信息。无论如何：

我的问题是在另一个页面上的**div**中显示动画。任何加载动画的尝试都明确失败。我通过使用 HTML**对象**标记成功解决了这个问题：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Banner</title>

</head>

<body style="margin:0;padding:0;">

<object data="animations/liferay/liferay-00.html" style="height:175px; width:100%"></object>

</body>
</html> 
```

请注意，我没有更改任何 URL 路径。我所做的只是指向发布文件夹。

因此，如果您仍然遇到问题，请尝试重新发布。

希望能帮助到你。

**更新：****Wayne Barron** 提供的附加解决方案：http: [//youtu.be/RQKqlpCkrjs](http://youtu.be/RQKqlpCkrjs)

# c++ - 静态初始化器的上下文是什么，我如何向它声明友谊？

> ID：13616479
> 
> 赞同：1
> 
> 时间：2012-11-28T23:48:07.367
> 
> 标签：c++, c++11, visibility, compile-time, static-initialization

```
class test{
    static const int veryprivate=3;
};

const int anarray[]={test::veryprivate}; 
```

`g++`巧妙地指出，`anarray`它既不是函数也不是成员函数。是否可以修复此代码保留`veryprivate` `private`？接受 C++11。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T10:03:59.110

做`anarray`一个数组引用：

```
class test {
    static const int veryprivate = 3;
    friend class animpl;
};
class animpl {
public:
    static const int anarray[] = { test::veryprivate };
};
auto &anarray = animpl::anarray; 
```

# model-view-controller - Zend setBaseUrl() 的区别？

> ID：13616480
> 
> 赞同：0
> 
> 时间：2012-11-28T23:48:09.243
> 
> 标签：model-view-controller, zend-framework, controller

简单的问题，只是在谷歌上没有运气。我想知道使用有什么不同

`Zend_Controller_Request_Http::setBaseUrl();`和`Zend_Controller_Request_Http::setBaseUrl('');`

在我看来，使用`Zend_Controller_Request_Http::setBaseUrl('')`以后可能会被视为容易发生事故，如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:22:27.190

最终结果是一样的。无需担心使用哪一个，如果您没有基本 URL，请不要设置基本 URL。

# ruby - 重新打开 IO 流与仅使用新流

> ID：13616482
> 
> 赞同：4
> 
> 时间：2012-11-28T23:48:10.277
> 
> 标签：ruby, io

在 Ruby-Docs 中，它给出了以下示例：

```
f1 = File.new("testfile")
f2 = File.new("testfile")
f2.readlines[0]   #=> "This is line one\n"
f2.reopen(f1)     #=> #<File:testfile>
f2.readlines[0]   #=> "This is line one\n" 
```

我的问题是为什么要`f2`在可以的时候`f2.close`重新打开`f1.readlines[0]`？使用新流重新打开与仅使用新流相比有什么优势吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T21:57:29.913

不久前，我与 IRB 上的一些开发人员进行了交谈，我得到的回应是，它主要用于更改`$std`变量以修改 where 方法，例如`puts`和`print`输出到...

```
$stdout.reopen(File.open('log'))
puts 'hello world' 
```

使用这个而不是...的原因

```
$stdout = File.open('log') 
```

......虽然有点悬而未决。我有一位开发人员说直接赋值不能很好地与 ruby​​ 的某些 C 函数配合使用。我对 C 知之甚少，对此不能说太多，但他向我指出了一些[minitest 源](https://github.com/ruby/ruby/blob/trunk/lib/minitest/unit.rb#L477-L495)，以查看它的使用示例。然而，显然，自从开发人员上次查看它以来，甚至源已经切换到直接分配与重新打开。

总之......从外观上看它`IO#reopen`可能没用，但我很想听到反对这一点的论点。

**更新**

好的，所以我重新阅读了文档，发现有第二组 opts `reopen`：

```
reopen(path, mode_str) → ios 
```

`reopen(other_IO) → ios`与选项相反，这实际上似乎有点有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-17T04:14:40.853

我怀疑主要区别在于`reopen`，新流不仅适用于该`$std...`变量的后续使用，还适用于*先前*分配给该变量值的 `$std...`变量。这可能是好是坏，取决于您的情况。

此 irb 会话表明，`reopen`在流更改之前分配的变量将获取新更改的流。请注意，任何一个变量的`fileno`都不会改变，并且两个变量都不会产生输出：

```
> $stderr.fileno
 => 2
> stderr_copy = $stderr
 => #<IO:<STDERR>>
> stderr_copy.fileno
 => 2
> $stderr.reopen(File.open('/dev/null', 'w'))
 => #<File:/dev/null>
> stderr_copy.fileno
 => 2
> $stderr.fileno
 => 2
> $stderr.puts 'foo'
 => nil
> stderr_copy.puts 'foo'
 => nil 
```

相反，当`reopen`新打开的`/dev/null`File 对象不使用 ，而是*分配给 时* `$stderr`，`stderr_copy`将保留其原始输出流。只`$stderr`得到新的`fileno`，`stderr_copy`仍然产生输出：

```
> $stderr.fileno
 => 2
> stderr_copy = $stderr
 => #<IO:<STDERR>>
> stderr_copy.fileno
 => 2
> $stderr = File.open('/dev/null', 'w')
 => #<File:/dev/null>
> $stderr.fileno
 => 10
> stderr_copy.fileno
 => 2
> $stderr.puts 'foo'
 => nil
> stderr_copy.puts 'foo'
foo
 => nil 
```

如果你想使用`reopen`，但想保存原始输出流的副本，你可以使用`dup`：

```
> stderr_dup = $stderr.dup
 => #<IO:<STDERR>>
> stderr_dup.fileno
 => 10
> $stderr.reopen(File.open('/dev/null', 'w'))
 => #<File:/dev/null>
> $stderr.fileno
 => 2
> stderr_dup.puts 'foo'
foo
 => nil
> $stderr.puts 'foo'
 => nil 
```

# java - 使用 java 的 getClasses() 方法

> ID：13616486
> 
> 赞同：0
> 
> 时间：2012-11-28T23:48:39.167
> 
> 标签：java, reflection

我正在寻找有关 getClasses() 工作原理的一些说明。我正在尝试编写代码，给定一个字符串类名，查找所有扩展类名指定的类的类。我有一个名为 getChildren() 的方法可以做到这一点。不幸的是，每次我调用它时，该方法都会返回一个空集合。这是我的代码。

```
import java.util.ArrayList;
import java.util.Collection;

public class ClassFinder {

private Class<?> myClass;

public ClassFinder(Class<?> clazz) {
    myClass = clazz;
}

public ClassFinder (String className) throws ClassNotFoundException {
    myClass = Class.forName(className);
}

public Collection<Class<?>> getChildren() {
    Collection<Class<?>> children = new ArrayList<Class<?>>();
    Class<?>[] relatedClasses = myClass.getClasses();
    for (Class<?> potentialChild : relatedClasses) {
        if (potentialChild.isAssignableFrom(myClass)) {
            children.add(potentialChild);
        }
    }
    return children;
} 

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T23:53:42.050

[getClasses](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getClasses%28%29)返回当前类中包含的类。您想查找从当前类继承的类。不幸的是，Java API 中没有允许您执行此操作的方法。

但是，您可以查看加载的类：[如何列出在特定类加载器中加载的所有类](https://stackoverflow.com/questions/2681459/how-can-i-list-all-classes-loaded-in-a-specific-class-loader)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:55:11.703

如果您阅读文档[`getClasses()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getClasses%28%29)...

> 返回一个数组，其中包含表示所有公共类和接口的 Class 对象，这些公共类和接口是此 Class 对象表示的类的成员。

关键字：“即成员”——不是扩展此类的类。此方法将为您提供[内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)，而不是[子类](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)。

运行此示例：

```
public class Example {

    public static void main(String[] argv) {
        for(Class c:Example.class.getClasses()) {
            System.out.println(c.getName());
        }
    }

    public class InnerClass {

    }

} 
```

你会得到这个输出：

```
Example$InnerClass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:08:16.567

您可以做的是创建**自己的类加载器**并使用它来加载类，在该类加载器中，您可以保留已加载的所有类的**列表**。

然后每当你需要查找有多少类扩展了一个给定的类时，你可以遍历列表中的所有类，并使用 Class 的这个方法`getSuperclass()`来找出这个方法返回的值是否与你要查找的类相同的孩子。

但是此代码有一个限制，它可能不会返回您期望的所有类。这是因为在您执行代码时，所有扩展给定类的类可能都没有加载。

# jquery - CSS3 分栏符

> ID：13616487
> 
> 赞同：1
> 
> 时间：2012-11-28T23:48:43.817
> 
> 标签：jquery, html, css, break

我刚刚实现了使用 css3 列的布局，现在我想知道如何在所有浏览器中强制分列。刚刚搜索了（至少）漏洞互联网并找不到解决方案，因为*column-break-before*似乎对非 webkit 浏览器中的布局没有影响。Firefox 中似乎没有实现。

基本上，我想要的是，每个标签都有一个特定的类（小提琴中的.break-column-before），分成一个新列。似乎是一项不可能完成的任务。有什么建议么？

基本 HTML

```
<div class="content">
    <div id="main">
        <h1>Headline 1</h1>
        <p>Text...</p>
        <h2 class="break-column-before">Bastards.</h2>
        <p>More Text...</p>
    </div>
</div> 
```

列生成如下：

```
-moz-column-width: 280px;
-moz-column-gap: 20px;
-moz-column-rule: 1px dashed #eee;
-webkit-column-width: 280px;
-webkit-column-gap: 20px;
-webkit-column-rule: 1px dashed #eee;
column-width: 280px;
column-gap: 20px;
column-rule: 1px dashed #eee; 
```

在评论中提到的另一个问题（[CSS3 Column Break](https://stackoverflow.com/questions/6424088/css-column-breaks)）中找到的解决方案确实打破了之前的列，但抑制了 div 内的进一步列中断。这对我的布局来说是不可能的，因为它是负责任的并且只有一个水平滚动条。

该网站可以在这里找到：[有问题](http://www.wirbrennen.at) 的网站小提琴（如评论中所建议的）可以在这里找到：[jsFiddle](http://jsfiddle.net/e3xdc/)

如果纯 css3 是不可能的，我也愿意使用 jQuery 回答。

# java - 来自java的dokuwiki认证

> ID：13616488
> 
> 赞同：2
> 
> 时间：2012-11-28T23:48:47.063
> 
> 标签：java, sql-server, authentication, dokuwiki

这是场景：

我想使用**docuwiki**向用户显示帮助和其他内容。用户按组织分组。每个组织都有自己的内容，这些内容应该是他们私有的。输入 ACL。我知道如何创建用户并将他限制在 wiki 的某个子部分。

现在有趣的部分开始了。如何从我的服务器验证这些用户？我正在运行 Tomcat/Java/MSSQL 堆栈。我完全控制了两台服务器。

我想如果可能的话，我想我可以将用户名/密码从 servlet 发布到 wiki，并获得一些用户可以访问该站点的令牌。但我在文档中没有看到任何关于此的内容。如果有人有任何想法、指示或替代方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T06:06:48.947

我认为您需要的东西被命名为 Single Sign On ( [SSO](http://en.wikipedia.org/wiki/Single_sign-on) )。作为一种可能的解决方案，您可以设置一个 SSO 提供程序（它们种类繁多，还支持 Tomcat 和 dokuwiki）并配置您的 dokuwiki 和 tomcat 以使用它。这是此类[提供程序](http://lemonldap-ng.org/start)的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T01:14:14.810

对于追随我的谷歌用户：

我最终编写了自己的身份验证器。要使用验证器，请将其放在 * *\inc\auth**中，名称为 sqlsrv.class.php（sqlsrv 将是您用于指定此验证器的代码。）

基本上发生的情况是我在我的服务器上生成一个唯一标识登录用户的令牌。然后我使用令牌 POST 或 GET 到 wiki。身份验证器然后查询服务器以查看是否应该对用户进行身份验证，以及获取用户名、电子邮件和用户应该属于哪些 ACL 组。

注意：确保更改 php 文件中的配置选项。你需要为你的 apache/php 安装和启用[sqlsrv 。](http://php.net/manual/en/book.sqlsrv.php)

```
<?php
/**
 * sqlsrv authentication backend
 *
 * @license    GPL 2 (http://www.gnu.org/licenses/gpl.html)
 * @author     Yuriy Shikhanovich <yuriys@gmail.com>
 */

class auth_sqlsrv extends auth_basic {
    /**
     * Constructor
     *
     * Carry out sanity checks to ensure the object is
     * able to operate. Set capabilities.
     *
     * @author  Yuriy Shikhanovich <yuriys@gmail.com>
     */
    function __construct() {

            global $config_cascade;
            global $connection;

      $this->cando['external']       = true;
    }

    function trustExternal()
    {
        //$msgTxt = $_SESSION[DOKU_COOKIE]['auth']['info']['user']."x";
        //msg($msgTxt);
        //return true;

        global $USERINFO;
            global $conf;
            global $connection;

        //already logged in, no need to hit server
        if (!empty($_SESSION[DOKU_COOKIE]['auth']['info'])) 
        {
                $USERINFO['name'] = $_SESSION[DOKU_COOKIE]['auth']['info']['user'];
                $USERINFO['mail'] = $_SESSION[DOKU_COOKIE]['auth']['info']['mail'];
                $USERINFO['grps'] = $_SESSION[DOKU_COOKIE]['auth']['info']['grps'];
                $_SERVER['REMOTE_USER'] = $_SESSION[DOKU_COOKIE]['auth']['user'];
                return true;
            }

        //check server based on token

        try
        {
            $token = $_GET["token"];
            if($token==null)
                $token = $_POST["token"];
            if($token==null)    
                $token = $_SESSION[DOKU_COOKIE]['auth']['token'];

            if($token==null)    
            {
                msg("Could not authenticate. Please contact your admin.");
                return false;
            }

            //config //NOTE: replace with the appropriate values
                $myServer = "1.1.1.1,1433";
                $myUser = "sqlaccount";
                $myPass = "sqlpassword";
                $myDB = "dbName";
                //end config

                //get connection
                $connectionInfo = array('UID' => $myUser, 'PWD' => $myPass, "Database"=>$myDB);
                $link = sqlsrv_connect($myServer, $connectionInfo);

                //check connection
                if($link === FALSE) 
                {
                        msg("Could not get connection, contact your admin.");
                    return false;
                }

                //run token against proc
                //NOTE: this needs to be implemented on your server, returns :
                //"user" - Name of the user //this does not have to be setup in the wiki
                //"email" - user's email //this does not have to be setup in the wiki
                //"groups" - Which groups //this *does* have to be setup in the wiki to be used with ACL
                $sql = "exec WikiLogin '".$token."'"; 
                $stmt = sqlsrv_query( $link, $sql);

                //check statement
                if( $stmt === false) 
                {
                        msg("Could not get connection statement, contact your admin.");
                    return false;
                }

                //if returned results, set user and groups
                while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC) ) 
                {
                    // set the globals if authed
                    $USERINFO['name'] = $row['user'];
                    $USERINFO['mail'] = $row['email'];
                    $USERINFO['grps'] = split(" ",$row['groups']);

                    //msg(implode($row," "));
                    //msg(implode($USERINFO," "));

                    $_SERVER['REMOTE_USER'] = $row['user'];

                    //uncomment after testing
                    $_SESSION[DOKU_COOKIE]['auth']['user'] = $row['user'];
                    $_SESSION[DOKU_COOKIE]['auth']['mail'] = $row['email'];
                    $_SESSION[DOKU_COOKIE]['auth']['token'] = $token;
                    $_SESSION[DOKU_COOKIE]['auth']['info'] = $USERINFO;

                    sqlsrv_free_stmt( $stmt);
                    sqlsrv_close($link);
                    return true;
                }

                return false;

                if(isset($link))
                    sqlsrv_close($link);
                else
                    msg("Could not get connection, contact your admin.");

                if(isset($stmt))
                    sqlsrv_free_stmt($stmt);
                else
                    msg("Could not get connection, contact your admin.");
            }
            catch (Exception $e)
      {
        if(isset($link))
                    sqlsrv_close($link);
                else
                    msg("Could not get connection, contact your admin.");

                if(isset($stmt))
                    sqlsrv_free_stmt($stmt);
                else
                    msg("Could not get connection, contact your admin.");
      }
        }
} 
```

# jquery - jquery扩展和简单复制变量之间的区别

> ID：13616490
> 
> 赞同：1
> 
> 时间：2012-11-28T23:49:01.550
> 
> 标签：jquery

我了解使用 jquery 扩展的优点，但是遵循两种完全相似的情况，或者一种比另一种更好，为什么？

```
obj1 = $.extend(true, {}, elements); 
```

..

```
obj1 = elements; 
```

**更新：** 答案说明：以下应该可以消除混淆

```
​obj = {"value":4};
obj_test = obj;
obj.value = 5
alert(obj_test.value); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:51:20.860

在第二种情况下，您不会“复制”对象，而是创建对它的第二个引用。

所以在第一种情况下，它是一个副本 - 2 个对象存储在 2 个变量中。

在第二个 - 由 2 个变量（不是副本）引用的单个对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:55:11.397

第一种方法用于`deep copy an Object`。

```
var elements = {
   name : 'John',
   age : 23
}

var obj1 = $.extend(true, {}, elements);
obj1.name = 'Bill';

console.log('Original : '+ elements.name);
console.log('Deep Copy : ' + obj1.name); 
```

其次是`copying over the reference`对象。

```
var obj2 = elements;
console.log('Original : '+ elements.name);
console.log('Reference Copy : ' + obj2.name); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/Bw4dj/)**

在第一种情况下，两个对象都指向不同的内存位置。因此更改属性只会影响已更改的对象。

在第二种情况下，两者都指向相同的内存位置。因此，对 1 的影响将对另一个产生间歇性影响。

# c++ - 如何在 C++ 中使用 BS_SPLITBUTTON

> ID：13616491
> 
> 赞同：-1
> 
> 时间：2012-11-28T23:49:05.187
> 
> 标签：c++, winapi, button

我正在尝试创建一个下拉菜单，但在 MSDN 上也找不到任何文档。

```
edit = CreateWindow("Button", "1h2f3d4", WS_BORDER |WS_CHILD | WS_VISIBLE | BS_SPLITBUTTON, 5, 30, 23, 20, hWnd, (HMENU) ID_EDIT, NULL, NULL); 
```

它有效，但它没有在按钮中显示任何内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:52:06.527

看起来您需要将[BCM_SETSPLITINFO](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775981%28v=vs.85%29.aspx)消息发送到新创建的按钮，并带有指向[BUTTON_SPLITINFO](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775955%28v=vs.85%29.aspx)结构的指针。那应该填补缺少的东西。

一些伪代码：

```
BUTTON_SPLITINFO MyInfo;
MyInfo.mask = BCSIF_STYLE | BCSIF_GLYPH;
MyInfo.uSplitStyle = BCSS_STRETCH;
MyInfo.himlGlyph = [A Glyph from an Image List]
Button_SetSplitInfo(edit, &MyInfo); // Send the BCM_SETSPLITINFO message to the control. 
```

您仍然必须提供要显示的图像列表和字形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-12T09:10:31.427

您必须让编译器在 VC++ 中使用 Common Controls 6.0 版（我认为最好在项目的一开始，在 .h 文件中：）

```
#pragma comment(linker,"\"/manifestdependency:type='win32' \
name='Microsoft.Windows.Common-Controls' version='6.0.0.0' \
processorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\"") 
```

我真的不知道如何在 GCC 等其他编译器上执行此操作，但是在 .exe 文件旁边放置一个具有相同信息的 .manifest 文件也可以解决问题。

# asp.net - 用户在asp.net中发送消息后如何添加接受消息

> ID：13616495
> 
> 赞同：0
> 
> 时间：2012-11-28T23:49:24.060
> 
> 标签：asp.net

用户在“联系我们”页面发送消息后，我想写接受消息（不是消息框）。消息需要让他接受消息已发送给网站管理员......类似于：“您的请求已收到，我们将尽快与您联系”。但是我希望消息会写在网页上的好位置，或者清除表格并且消息会出现在页面的头部......我知道我可以重定向到新页面并在上面写这个消息但是我寻找一个优雅的解决方案...

asp.net 代码是：

```
@{
    var db = Database.Open("MyProjectSite");

    var name="";
    var email="";
    var message="";
    var answer="";

    Validation.RequireField("name","please insert your name");
    Validation.RequireField("email","please insert your email");
    Validation.RequireField("message","please insert your message");
    Validation.RequireField("answer","please insert your answer");
     if(IsPost)
    {
        name=Request.Form["your_name"];
        email=Request.Form["your_email"];
        message=Request.Form["your_message"];
       var insertMessege="INSERT INTO messegesFromCustomers(name,email,content,isCustomer)"+"VALUES (@0,@1,@2,@3)";
       db.Execute(insertMessege,name,email,message,"not customer yet");
       db.Close();
    }

} 
```

我需要在我的代码中添加哪个代码才能出现接受消息？

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:57:09.677

我建议使用两个 asp:Panel 控件。一个包含成功消息，该消息最初是隐藏的；其他表单字段：

```
<asp:Panel ID="pnlSuccess" Visible="false" runat="server">Success message here</asp:Panel>
<asp:Panel ID="pnlContact" runat="server">Input fields here</asp:Panel> 
```

当联系请求成功保存到数据库时，将 的`Visible`属性设置`pnlSuccess`为 true 和`pnlContact.Visible`false。这将显示相​​同的页面，但消息可见且表单隐藏。

# ruby-on-rails - 在 Rspec 中，如何测试没有路由的控制器动作？

> ID：13616504
> 
> 赞同：4
> 
> 时间：2012-11-28T23:50:05.723
> 
> 标签：ruby-on-rails, rspec, controller

在我的一些控制器中，我有一个没有相应路由的操作，因为它只能通过`render ... and return`其他控制器操作中的 a 访问。

例如，我有一个动作

```
def no_such_page
 # displays a generic error screen
end 
```

在我的 RSpec 控制器测试中，我如何“获取”该方法并查看响应正文？

如果我尝试：

```
 get :no_such_page
  response.status.should be(200) 
```

它当然给出了错误

```
No route matches {:controller=>"foo", :action=>"{:action=>:no_such_page}"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:54:38.403

**更新**

回顾您的问题，现在对我来说没有意义，因为您说您只是通过 访问此操作`render ... and return`，但`render`呈现的是视图，而不是操作。你确定你甚至需要这个动作吗？我认为视图规范是这个测试的地方。

**原始答案**

测试永远不会通过 HTTP 请求调用的操作的响应代码是没有意义的。同样`get :no_such_page`没有意义，因为您无法“获取”该操作（没有通往它的路线），您只能调用该方法。

从这个意义上说，测试它的最好方法是像对待类上的任何其他方法一样对待它，在这种情况下，类是你的控制器，例如`PostsController`. 所以你可以做这样的事情：

```
describe PostsController do

  ... other actions ...

  describe "no_such_page" do
    it "displays a generic error screen" do
      p = PostsController.new
      p.should_receive(:some_method).with(...)
      p.no_such_page
    end
  end

end 
```

但实际上，从您写的内容来看，在我看来，您的操作中没有任何内容，您只是在测试相应视图生成的 HTML 输出。如果是这种情况，那么您根本不应该在控制器规范中进行测试，只需使用[视图规范](https://www.relishapp.com/rspec/rspec-rails/v/2-1/docs/view-specs/view-spec)进行测试，这更适合测试响应正文的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-09T19:01:27.250

```
before :all do
  Rails.application.routes.draw do
    get '/no_such_page', to: "foo#no_such_page"
  end
end

after :all do
 Rails.application.reload_routes!
end 
```

# r - 仅显示多个 t.tests 的 p 值

> ID：13616505
> 
> 赞同：6
> 
> 时间：2012-11-28T23:50:14.153
> 
> 标签：r, sample

我有

`replicate(1000, t.test(rnorm(10)))`

它的作用是从正态分布中抽取一个大小为 10 的样本，对其执行 a`t.test`并执行 1000 次。但是对于我的任务，我只对 p 值感兴趣（问题是：原假设被拒绝了多少次）。我如何只获得 p 值，或者我可以添加一些已经说明原假设被拒绝多少次的内容（p 值小于 0.05 的次数）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T23:53:27.370

`t.test`返回一个类的对象，`htest`它是一个包含许多组件的列表，包括`p.value`（这是你想要的）。

你有几个选择。

您可以将`t.test`结果保存在列表中，然后提取`p.value`组件

```
# simplify = FALSE to avoid coercion to array
ttestlist <- replicate(1000, t.test(rnorm(10)), simplify = FALSE)
ttest.pval <- sapply(ttestlist, '[[', 'p.value') 
```

`t.test`或者你可以简单地只保存对象的那个组件

```
pvals <- replicate(1000, t.test(rnorm(10))$p.value) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T23:57:15.797

这是我用来解决您的问题的步骤。请注意我是如何将其分解为最小的组件并逐步构建的：

```
#Let's look at the structure of one t.test to see where the p-value is stored
str(t.test(rnorm(10)))
#It is named "p.value, so let's see if we can extract it
t.test(rnorm(10))[["p.value"]]
#Now let's test if its less than your 0.05 value
ifelse(t.test(rnorm(10))[["p.value"]]< 0.05,1,0)
#That worked. Now let's replace the code above in your replicate function:
replicate(1000, ifelse(t.test(rnorm(10))[["p.value"]]< 0.05,1,0))
#That worked too, now we can just take the sum of that:
#Make it reproducible this time
set.seed(42)
sum(replicate(1000, ifelse(t.test(rnorm(10))[["p.value"]]< 0.05,1,0))) 
```

应该产生这个：

```
[1] 54 
```

# android - Android 服务必须是静态的，并且不能引用我实现 findViewById 的文本输入

> ID：13616511
> 
> 赞同：1
> 
> 时间：2012-11-28T23:51:03.403
> 
> 标签：android, service, findviewbyid

基本上我已经创建了一个应用程序，用户可以在其中输入一个数字（以秒为单位）。然后他们单击一个按钮并创建一个服务，该服务从输入的秒数开始运行倒计时。但是在我的服务中，我引用了以下变量：

```
public EditText text = (EditText)findViewById(R.id.editText1);
int Time = Integer.parseInt(text.getText().toString()); 
```

这会“破坏”服务，因为它是静态的并且无法引用 findViewById。我已经尝试了几个小时来解决这个问题，但我不知道，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:14:23.640

为什么`Service`必须是`static`？A`Service`应该是启动/停止或绑定/未绑定（或两者的组合）。您不必创建`static`Android `Service`。

将此代码放入您的`Activity`而不是`Service`...

```
public EditText text = (EditText)findViewById(R.id.editText1);
int time = Integer.parseInt(text.getText().toString()); 
```

...然后只需将时间传递给`Service`您`Intent`用来启动它的...

```
Intent i = new Intent(this, MyService.class);
i.putExtra("the_time", time);
startService(i); 
```

然后在`Service` `onStartCommand(...)`方法中使用...

```
int time = intent.getIntExtra("the_time", 0); 
```

# r - 推荐 13 个或更多类别的刻度颜色

> ID：13616515
> 
> 赞同：10
> 
> 时间：2012-11-28T23:51:20.440
> 
> 标签：r, colors, ggplot2

13 种或更多颜色的 ggplot2 的默认比例不提供高度的视觉区分。此外，最长的啤酒秤以 12 个类别结束（Set3）。

你能推荐一个对 1​​3 个或更多类别在视觉上有用的色标吗？

可重现的例子：

```
dat <- data.frame(value=rnorm(100),
category=sample(letters[1:13],100,replace=T),
other=sample(letters[1:5],100,replace=T))

# Default Scale
ggplot(dat, aes(other,value,color=category)) + 
geom_point(size=6) + 
coord_flip()

# Brewer Scale // notice the blank at the end!
ggplot(dat, aes(other,value,color=category)) + 
geom_point(size=6) + 
coord_flip() + 
scale_color_brewer(palette="Set3") 
```

注意：在我的情况下，刻面不是一个选项（客户不喜欢它，去图）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T00:00:32.023

您可以使用`colorRampPalette`and`scale_colour_manual`来伪造第 13 个类别。

```
set3 <- colorRampPalette(brewer.pal('Set3',n=12))

ggplot(dat, aes(other,value,color=category)) + 
     geom_point(size=6) + 
     coord_flip() + 
     scale_color_manual(values = setNames(set3(13), levels(dat$category))) 
```

这将失败，因为如果您将所需的数字设置得太高，颜色将无法很好地区分。

# android - 添加了 ProGuard，现在我无法构建发布版本

> ID：13616526
> 
> 赞同：0
> 
> 时间：2012-11-28T23:52:07.427
> 
> 标签：android

我构建了我的应用程序的发布版本，然后决定使用 ProGuard。我将以下内容添加到我的 project.properties 文件中：

```
proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt 
```

当我尝试构建发布版本时，出现以下错误：

```
[2012-11-28 17:47:37 - MyApp] Proguard returned with error code 1\. See console
[2012-11-28 17:47:37 - MyApp] Warning: oauth.signpost.signature.OAuthMessageSigner: can't find referenced class org.apache.commons.codec.binary.Base64
[2012-11-28 17:47:37 - MyApp] Warning: oauth.signpost.signature.OAuthMessageSigner: can't find referenced class org.apache.commons.codec.binary.Base64
[2012-11-28 17:47:37 - MyApp] Warning: oauth.signpost.signature.OAuthMessageSigner: can't find referenced class org.apache.commons.codec.binary.Base64
[2012-11-28 17:47:37 - MyApp] Warning: oauth.signpost.signature.OAuthMessageSigner: can't find referenced class org.apache.commons.codec.binary.Base64
[2012-11-28 17:47:37 - MyApp] Warning: oauth.signpost.signature.OAuthMessageSigner: can't find referenced class org.apache.commons.codec.binary.Base64
[2012-11-28 17:47:37 - MyApp] Warning: there were 5 unresolved references to classes or interfaces.
[2012-11-28 17:47:37 - MyApp]          You may need to specify additional library jars (using '-libraryjars').
[2012-11-28 17:47:37 - MyApp] java.io.IOException: Please correct the above warnings first.
[2012-11-28 17:47:37 - MyApp]   at proguard.Initializer.execute(Initializer.java:321)
[2012-11-28 17:47:37 - MyApp]   at proguard.ProGuard.initialize(ProGuard.java:211)
[2012-11-28 17:47:37 - MyApp]   at proguard.ProGuard.execute(ProGuard.java:86)
[2012-11-28 17:47:37 - MyApp]   at proguard.ProGuard.main(ProGuard.java:492) 
```

这显然是在引用我正在使用的路标库。我相信我已经正确添加了所需的罐子和库，但我猜不是？

![在此处输入图像描述](../Images/3b06b3a1d964fc22ae4e5c6c984dd5eb.png)

我通过“添加外部 JAR...”按钮添加了路标 jar，并通过“添加外部类文件夹...”按钮添加了 commons-codec 库。

我在这里做错了什么？

更新：

我在项目的根目录中添加了一个名为 proguard-project.txt 的文件。

```
proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt 
```

在 proguard-project.txt 文件中，我添加了以下内容：

```
-keep class org.apache.** { *; }
-keep class oauth.signpost.** { *; } 
```

我仍然收到相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:32:01.353

我不知道解释，但我对番石榴库有同样的问题，有完全相同的警告信息。我通过这样做来修复它：

```
-dontwarn com.google.common.collect.MinMaxPriorityQueue 
```

还有 AdMob 类。一样。所以，也许你也可以这样做：

```
-dontwarn org.apache.commons.codec.binary.Base64 
```

由于您已经在代码中成功使用了这些类。

*警告*：因为我不知道这是做什么的，请谨慎行事，并可能尝试阅读它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:54:49.360

可能需要告诉 proguard 不要弄乱你的 proguard.cfg 中的那些类

```
-keep class org.apache.** { *; }
-keep class oauth.signpost.** { *; } 
```

# iphone - UILabel 中的不同 UIFonts

> ID：13616527
> 
> 赞同：0
> 
> 时间：2012-11-28T23:52:11.563
> 
> 标签：iphone, ios, xcode, ipad

我正在尝试制作一个应用程序，让用户可以选择不同的字体并根据需要旋转它们。

*   我需要知道的是这个应用程序使用了什么技术（见下面的截图）？
*   是 UIKit、CATextLayer 吗？
*   这些文本/字体在苹果 UIKit 模块中是否可用？
*   如何让用户调整或旋转文本字体。

![在此处输入图像描述](../Images/de49b9938621b5cc74b18f518320222e.png)

![在此处输入图像描述](../Images/f447382fa6b9f8d98b7dce9bc332b8f5.png)

github中是否有任何示例苹果项目或示例代码可供我查看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:00:33.420

所有看起来都可以使用自定义字体来完成，在 UIKit 中找不到它们。您需要购买或查找您有权分发的字体。[这是为您的项目添加自定义字体的一个很好的参考](http://mobiledevelopertips.com/user-interface/load-and-access-custom-fonts.html)。

一旦你安装了字体。UILabel 和其他文本保存控件可以查询和设置它们的 .font 属性。您想对视图执行的任何其他操作（例如设置旋转变换）也适用于这些控件。

# javascript - 与屏幕分辨率链接

> ID：13616528
> 
> 赞同：-3
> 
> 时间：2012-11-28T23:52:15.493
> 
> 标签：javascript, jquery, html, css

我正在制作一个包含动画的网站，分辨率为 1024x768。该网站的链接将作为节日问候通过电子邮件发送出去。有没有办法阻止网站以不同于 1024x768 的分辨率加载，无论其屏幕分辨率如何？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:55:12.317

如果您只想隐藏内容，我会使用媒体查询：
[http ://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

但是，如果您有不想下载的跟踪像素，如果屏幕分辨率符合您的要求，我会插入一个 iframe：

```
if ( ($(window).height() === 768) && ($(window).width() === 1024) ) {
  $('body').append('<iframe src="http://your.url.com"></iframe>');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:57:02.960

只需将您的内容嵌入到您想要的值的`div`设置中`width`即可。`height`

但更强大的解决方案是使用媒体查询。[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)

# c# - C#中N个数组中项目的所有组合

> ID：13616545
> 
> 赞同：3
> 
> 时间：2012-11-28T23:54:02.763
> 
> 标签：c#, linq, combinatorics

我可以有 N 个不同长度的数组。
重要的是我不知道我可以拥有多少个数组。
让我们有3个数组：

```
arr1: { obj11, obj12, obj13, ...., obj1J }  
arr2: { obj21, obj22, obj23, .........., obj2K }  
arr3: { obj31, obj32, obj33, ................, obj3L } 
```

我怎样才能像这样产生每个项目的组合：

```
1\.  [obj11, obj21, obj31]  
2\.  [obj11, obj21, obj32]  
..  
L.  [obj11, obj21, obj 3L]  
L+1.[obj11, obj22, obj 31]  
.... 
```

谈论 C# 实现（也许是 Linq？）

# android - 在 Nexus 7 (Android 4.2) 上捕获软键盘事件

> ID：13616546
> 
> 赞同：1
> 
> 时间：2012-11-28T23:54:20.367
> 
> 标签：android, keyboard, nexus-7

我想抓住软键盘的任何键的按下。至少 Enter & Backspace 键。

我试过了：

1.  `OnKeyListener`对于 EditText
2.  `onKeyDown`活动
3.  `dispatchKeyEvent`活动
4.  `onEditorAction`对于我的自定义 EditText

没有任何效果。是的，我知道所有这些方法都只能保证硬件按键事件，但是在这种情况下我必须做什么才能知道 Enter（例如）被按下？

# java - 使用 Mockito 调用回调

> ID：13616547
> 
> 赞同：74
> 
> 时间：2012-11-28T23:54:46.347
> 
> 标签：java, testing, mockito

我有一些代码

```
service.doAction(request, Callback<Response> callback); 
```

如何使用 Mockito 获取回调对象，并调用 callback.reply(x)

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-11-28T23:56:35.483

您想设置一个执行此操作的`Answer`对象。查看 Mockito 文档，位于 [https://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#answer_stubs](https://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#answer_stubs)

你可能会写类似

```
when(mockService.doAction(any(Request.class), any(Callback.class))).thenAnswer(
    new Answer<Object>() {
        Object answer(InvocationOnMock invocation) {
            ((Callback<Response>) invocation.getArguments()[1]).reply(x);
            return null;
        }
}); 
```

（当然，替换`x`为应有的内容）

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-11-29T04:04:52.970

考虑使用[ArgumentCaptor](http://static.javadoc.io/org.mockito/mockito-core/2.18.3/org/mockito/Mockito.html#21)，它在任何情况下都更接近于“grab[bing] 回调对象”。

```
/**
 * Captor for Response callbacks. Populated by MockitoAnnotations.initMocks().
 * You can also use ArgumentCaptor.forClass(Callback.class) but you'd have to
 * cast it due to the type parameter.
 */
@Captor ArgumentCaptor<Callback<Response>> callbackCaptor;

@Test public void testDoAction() {
  // Cause service.doAction to be called

  // Now call callback. ArgumentCaptor.capture() works like a matcher.
  verify(service).doAction(eq(request), callbackCaptor.capture());

  assertTrue(/* some assertion about the state before the callback is called */);

  // Once you're satisfied, trigger the reply on callbackCaptor.getValue().
  callbackCaptor.getValue().reply(x);

  assertTrue(/* some assertion about the state after the callback is called */);
} 
```

虽然`Answer`当回调需要立即返回（阅读：同步）时是一个好主意，但它也引入了创建匿名内部类的开销，并且不安全地将元素从`invocation.getArguments()[n]`您想要的数据类型转换为。它还要求您在答案内对系统的回调前状态做出任何断言，这意味着您的答案可能会扩大规模和范围。

相反，异步处理您的回调：使用 ArgumentCaptor 捕获传递给您的服务的回调对象。现在您可以在测试方法级别做出所有断言，并`reply`在您选择时调用。如果您的服务同时负责多个回调，这将特别有用，因为您可以更好地控制回调返回的顺序。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-08-06T18:11:37.340

如果你有这样的方法：

```
public void registerListener(final IListener listener) {
    container.registerListener(new IListener() {
        @Override
        public void beforeCompletion() {
        }

        @Override
        public void afterCompletion(boolean succeeded) {
            listener.afterCompletion(succeeded);
        }
    });
} 
```

然后按照以下方式，您可以轻松地模拟上述方法：

```
@Mock private IListener listener;

@Test
public void test_registerListener() {
    target.registerListener(listener);

    ArgumentCaptor<IListener> listenerCaptor =
            ArgumentCaptor.forClass(IListener.class);

    verify(container).registerListener(listenerCaptor.capture());

    listenerCaptor.getValue().afterCompletion(true);

    verify(listener).afterCompletion(true);
} 
```

我希望这可能对某人有所帮助，因为我花了很多时间来找出这个解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-29T00:00:21.977

```
when(service.doAction(any(Request.class), any(Callback.class))).thenAnswer(
    new Answer() {
    Object answer(InvocationOnMock invocation) {
        Callback<Response> callback =
                     (Callback<Response>) invocation.getArguments()[1];
        callback.reply(/*response*/);
    }
}); 
```

# azure - 基于队列长度的 Azure 自动缩放

> ID：13616553
> 
> 赞同：4
> 
> 时间：2012-11-28T23:55:23.293
> 
> 标签：azure, autoscaling

我想根据 azure 队列的长度自动缩放我的 azure worker 角色。根据我看到的所有[文档](http://msdn.microsoft.com/en-us/library/hh680897%28v=pandp.50%29.aspx)，这应该非常简单，使用 queueLength 操作数。

我已经实现了自动缩放器，将其上传到我的服务并在我的队列中添加了一堆元素，但是实例的数量并没有增加。

故障排除的最佳方法是什么？我已远程桌面化到该角色，事件日志中没有任何内容。是否有我可以检查的自动缩放事件/错误日志？

编辑：当我在开发环境中运行应用程序时，我看到 autscaler 已成功加载 ServiceInfo.xml。有一个队列条目和一个角色条目。但是，规则似乎并未从 rules.xml 文件中加载。

更多编辑：当我从 rules.xml 文件中删除反应规则和操作数节点时，约束规则加载成功。所以问题出在其中一个节点上。

我的服务信息 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<serviceModel xmlns="http://schemas.microsoft.com/practices/2011/entlib/autoscaling/serviceModel">
  <subscriptions>
<subscription name="MySubscription" subscriptionId="blah" certificateThumbprint="‎blah" certificateStoreName="My" certificateStoreLocation="CurrentUser">
      <storageAccounts>
        <storageAccount alias="targetstorage" connectionString="DefaultEndpointsProtocol=https;AccountName=blah; AccountKey="blah">
          <queues>
            <queue alias="auditqueue" queueName="auditqueue"/>
          </queues>
        </storageAccount>
      </storageAccounts>
      <services>
        <service dnsPrefix="blah" slot="Production" scalingMode="Scale">
          <roles>
            <role alias="ScalingWebRole" roleName="ScalingWebRole" wadStorageAccountName="targetstorage" />
          </roles>
        </service>
      </services>
    </subscription>
  </subscriptions>
</serviceModel> 
```

我的规则 xml 文件：

```
 <constraintRules>

    <rule name="Default" enabled="true" rank="1">
      <actions>
        <range target="ScalingWebRole" min="1" max="10" />
      </actions>
    </rule>

  </constraintRules>

  <reactiveRules>

    <rule name="Scale up when queue is long" enabled="true">
      <actions>
        <scale target="ScalingWebRole" by="1" />
      </actions>
      <when>
        <greaterOrEqual operand="QueueLength_Avg" than="5" />
      </when>
    </rule>

    <rule name="Scale down when queue is short" enabled="true">
      <actions>
        <scale target="ScalingWebRole" by="-1" />
      </actions>
      <when>
        <less operand="QueueLength_Avg" than="5" />
      </when>
    </rule>

  </reactiveRules>

  <operands>
    <queueLength alias="QueueLength_Avg" aggregate="Average" queue="auditqueue" timespan="00:01:00" />
  </operands>

</rules> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:14:26.250

Wasabi 会发布很多诊断信息，但您必须启用它。在您托管自动缩放​​器的角色中，更新 app.config 以包含以下内容：

```
 <system.diagnostics>
    <sources>
      <source name="Autoscaling General" switchValue="All">
        <listeners>
          <add name="AzureDiag" />
        </listeners>
      </source>
      <source name="Autoscaling Updates" switchValue="All">
        <listeners>
         <add name="AzureDiag" />
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
          name="AzureDiag"/>
    </sharedListeners>
    <trace>
      <listeners>
        <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
            name="AzureDiagnostics">
          <filter type="" />
        </add>
      </listeners>
    </trace>
  </system.diagnostics> 
```

然后，如果您的角色配置为将日志条目上传到 WADs 表（Windows Azure 诊断表），您将在那里看到这些条目。

[有关 Wasabi在此处](http://msdn.microsoft.com/en-us/library/hh680883%28v=pandp.50%29.aspx)生成的日志条目的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T05:22:48.143

在诊断提供的帮助下（感谢@Julian Dominguez），很明显，自动缩放块第一次尝试访问服务（检查队列长度）时失败了。这是因为系统在 CurrentUser 存储而不是 LocalMachine 存储中查找证书。

一旦我在配置中更改了该设置，它就开始工作了。

# ruby-on-rails - 如何在rails中检查check_box？

> ID：13616554
> 
> 赞同：34
> 
> 时间：2012-11-28T23:55:24.057
> 
> 标签：ruby-on-rails, ruby-on-rails-3, checkbox, ruby-on-rails-3.2, form-helpers

我使用以下 rails form helper 制作了复选框：

```
<%= check_box("tag", tag.id) %> 
```

但是，我需要默认检查其中一些。rails 文档没有指定如何执行此操作。有办法吗？如何？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-02-15T01:34:53.007

这是从 rails 4 开始的方法，我没有检查旧文档。

```
<%= check_box("tag", tag.id, {checked: true}) %> 
```

这将使复选框被选中。当然，代替`true`您将输入一些逻辑来确定是否检查了每个逻辑。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-05-16T00:43:44.130

如果您需要检查复选框`new`并正确填写，`edit`您可以执行以下操作：

`<%= f.check_box :subscribe, checked: @event.new_record? || f.object.subscribe? %>`

正如我在[这里提到的](https://stackoverflow.com/a/37245190/3002847)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-29T01:09:48.583

rails 文档确实说明了如何检查它，这取决于对象。如果您没有与 check_box 一起使用的实例对象，那么您最好的选择是使用前面提到的 check_box_tag。如果你这样做，请继续阅读。

[这是](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-check_box)check_box 帮助器上文档的链接。基本上这是如何工作的，您必须定义一个实例变量。该实例变量必须具有返回整数或布尔值的方法。从文档：

> 此对象必须是实例对象 (@object) 而不是本地对象。该方法旨在返回一个整数，如果该整数大于零，则选中该复选框。

例如，假设您的视图中有一个 @tag 实例，该实例具有启用的方法。以下代码段将导致复选框在 @tag 对象上启用为 true 时被选中，而当它为 false 时取消选中。要使其默认启用，请在控制器中将 enabled 属性设置为 true。最后两个变量是您希望在选中和取消选中复选框时与表单一起提交的值。

```
<%= check_box "tag", "enabled", {}, "1", "0" %> 
```

很多时候，您会看到与表单构建器一起使用的 check_box 助手。因此，如果将 form_for 用于 @tag 实例，您很可能会使用以下代码段：

```
<%= f.check_box :enabled %> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-16T12:15:39.540

无需编写检查：对于 rails >= 4.0 为 true 只需编写

```
<%= check_box_tag "name", value, true %> # true or false 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-29T00:11:32.173

而`check_box_tag`不是`check_box`有一种方法可以设置它已被检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-01T20:23:52.557

*这个答案只与`f.check_box`*

`f.check_box`最多可以有 4 个参数：

1.  输入名称
2.  包含 html 类、id 等选项的哈希
3.  哪个值代表“已检查”（默认为“1”）
4.  哪个值表示“未选中”（默认为“0”）

因此，如果您的布尔字段存储为 1 或 0（Rails 的默认值），那么一切都很好。Rails 将识别该字段是否被选中。

但是，如果您使用不同的数据存储或以另一种格式存储布尔值的框架，则需要指定哪些值对应于选中和未选中。

这是一个例子：

`<%= f.check_box :accept_privacy_policy, { class: 'my-class' }, "true", "false" %>`

* * *

参考

*   [https://api.rubyonrails.org/v6.0.0/classes/ActionView/Helpers/FormHelper.html#method-i-check_box](https://api.rubyonrails.org/v6.0.0/classes/ActionView/Helpers/FormHelper.html#method-i-check_box)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-29T00:50:35.577

使用`check_box_tag`您可以将其设置为`true`已选中。更多信息在这里：[http ://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-check_box_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-check_box_tag)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-03T17:47:39.777

所有这些解决方案的问题是它不能很好地处理`params`重新提交的哈希，所以目前我正在使用这样的东西，

```
# ApplicationHelper
def resolve_boolean_parameter resource, attribute, options = {}
  default = options.delete(:default)
  return default unless params[:utf8]

  return params[resource][attribute] == "1"
end 
```

然后在视图中：

```
<div><%= f.label :accepts_newsletter, "Receive Newsletters" %>
  <%= f.check_box :accepts_newsletter, :checked => resolve_boolean_parameter(:user, :accepts_newsletter, default: true)  %>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-01T17:14:35.650

## 放置在 Helper 中的新功能

```
def check_if_true(item)
  ActiveModel::Type::Boolean.new.cast(item)
end 
```

## 在你看来

```
<%= check_box("test", "active", {checked: check_if_true(@test.active) , :multiple => true, :style => "margin-left: 16px;"}, "true", "false") %> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-21T11:31:40.797

这就是我在 2020 年现在的做法。

```
<%= form.check_box :with_cost, checked: true, class: '', type: 'checkbox', id: 'cost' %> 
```

带`checked: true`属性。

希望这可以帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-02T22:28:48.417

如果您在*Rails 5.1 +*中使用表单助手来构建您的复选框，则必须以特定顺序传入哈希值。

```
= form.check_box :open_after, { class: 'form-control mt-1', data: {}, checked: true }, true, false 
```

如您所见，在哈希内部， first 是`class`， next`data`和 last `checked`。这适用于 Rails 6.0

# yui - YUI 从下拉列表中获取选定的值

> ID：13616556
> 
> 赞同：-4
> 
> 时间：2012-11-28T23:55:42.583
> 
> 标签：yui

如何使用 YUI 从下拉列表中获取选定值。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:06:49.483

如果您正在谈论类似于此处找到的组合框：http: [//developer.yahoo.com/yui/examples/autocomplete/ac_combobox.html](http://developer.yahoo.com/yui/examples/autocomplete/ac_combobox.html)

您可以从元素的 value 属性中获取值。例如

```
document.getElementById("text_box_id").value 
```

要查看实际情况，请转到上面的链接，为第一个输入框选择一个值，然后将以下代码粘贴到浏览器的地址栏中：

```
javascript:alert(document.getElementById("bInput").value); 
```

# python - 在 Python 中抽象线程和多处理？

> ID：13616559
> 
> 赞同：0
> 
> 时间：2012-11-28T23:56:00.197
> 
> 标签：python

是否有一个模块可以在 Python 中抽象线程和多处理？我希望将来可以选择在它们之间切换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:00:09.980

`threading`and模块已经为此使用了类似的`multiprocessing`接口。`threading`如果不支持，多处理实际上会退回到模块。

您可以使用`import multiprocessing as something`and`import threading as something`在两个看不见的之间切换。

**请注意，两者之间的数据共享是不同的，这可能会造成潜在的陷阱。**正如jdi所指出的

# c - 无法调试 lex.yy.cc 文件

> ID：13616561
> 
> 赞同：3
> 
> 时间：2012-11-28T23:56:28.487
> 
> 标签：c, lex

我创建了一个 lex 文件 test.l 并从中创建了 lex.yy.c，然后我使用 gcc -g 标志对其进行编译

我正在链接它，编译其余的代码调用 yylex() 没有问题，但是，在 GDB 中，我似乎无法深入调用 yylex()。

我究竟做错了什么？我在 yylex() 方法本身中设置了断点，这导致 gdb 在我对 yylex() 的调用中停止，但从不在函数内部。

我需要用调试符号或其他东西编译 -l 库吗？

我知道它正在运行，因为我使用 -d 创建了我的 lex.yy.c 文件，所以我看到了接受令牌等的输出。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T00:12:11.510

我认为您违反了 lex 或至少 flex 使用该`#line`指令将用于错误和符号调试`.l`的文件设置为创建文件的文件这一事实`.c`。您需要在`.l`文件中设置断点或使用`-L`选项来指示 flex 不要使用该`#line`指令。

`#line`GDB 需要设置断点时出现在指令中的文件名。如果您手动将`.l`文件转换为文件，`.c`那么这可能是您在命令行上使用的。如果转换是由 make 隐式完成的，那么它只是`.l`文件的基本名称（没有文件夹）。

# java - 编写将由 System.in、java 读取的输出

> ID：13616563
> 
> 赞同：1
> 
> 时间：2012-11-28T23:56:35.937
> 
> 标签：java, unit-testing

有没有办法写入将由 System.in 输入流读取的输出流？例如：

```
BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(System.in)); 
```

除非那不起作用，因为 System.in 是输入流，而 OutputStreamWriter 需要输出流。

我想输出一些将被读取的内容：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); 
```

我想做的是为控制台应用程序编写单元测试。我想以编程方式测试我的输入。任何方法都可以回答我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:00:45.630

你应该看看对象的`setIn()`方法`System`。 [http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setIn%28java.io.InputStream%29](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setIn%28java.io.InputStream%29)

它会让您重新分配系统输入流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:00:28.127

我的建议是您使用 method(String/int var) 创建方法并使用单独的解析器。然后，您无需输入即可测试所有方法。这是单元测试的标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T00:04:14.673

您可以对 stdin/stdout 进行读写操作，但我会重构您的代码，以将您 *如何**获取*输入与使用它的操作分开。

 *这样你就可以直接从你的单元测试中调用“做”代码。

它还允许将其他输入源插入到您的代码中，例如文件内容、网页内容等。*

# php - 下拉菜单的 isset 方法与文本输入不同吗？

> ID：13616567
> 
> 赞同：-3
> 
> 时间：2012-11-28T23:56:52.403
> 
> 标签：php, html

如果我`isset()`用于文本输入，那么我会这样写：

`$newpass = (isset($_POST['newpass'])) ? $_POST['newpass'] : '';`

现在，如果我有如下下拉菜单：

```
<select name="students">
<option value="">Please Select</option>
<option value="john">John Doe</option>
<option value="Mike">Mike Smith</option>
</select> 
```

然后我可以使用与文本输入相同类型的 isset：

`$studentsdrop = (isset($_POST['students'])) ? $_POST['students'] : '';`

还是 isset 与下拉菜单不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:01:43.190

这一行：

```
$newpass = (isset($_POST['newpass'])) ? $_POST['newpass'] : ''; 
```

检查是否将调用的变量`newpass`发布到脚本中。

选项选择值可以通过 javascript/jQuery 获取并发布到 php 脚本（服务器端），以便通过 AJAX 或 GET/POST 执行操作。这是一个例子：

```
<html>
    <head>
        <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>-->
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('#mySelect').change(function() {
                    var sel = $(this).val();
                    //alert(sel);
                    $.ajax({
                        type: "POST",
                        url: "another_php_file.php",
                        data: 'theOption=' + sel,
                        success: function(data) {
                        }
                    });
                });
            });
        </script>
    </head>
<body>

<select name="students" id="mySelect">
    <option value="">Please Select</option>
    <option value="john">John Doe</option>
    <option value="Mike">Mike Smith</option>
</select> 
```

* * *

文件：ANOTHER_PHP_FILE.php

```
$theVar = $_POST['theOption'];
echo 'I received [' . $theVar . ']'; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T23:59:46.673

[isset()](http://php.net/manual/en/function.isset.php)检查变量是否存在以及它是否未设置为 NULL。它根本与 HTML 无关。

在你的情况下：

```
$studentsdrop = (isset($_POST['students'])) ? $_POST['students'] : ''; 
```

只要你知道它`students`会出现，你就不需要这个。提交表单时最常用的 isset() 是确定一个复选框。例如，如果您提交了一个带有复选框的表单，并且该复选框没有被选中，它就不会被传递到`$_POST`变量中。这对于使用至关重要：

`$checkbox_name = isset($_POST['checkbox_name']) ? $_POST['checkbox_name'] : '';`

在 a 的情况下，`select`变量`$_POST`将始终返回，即使它是空的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-28T23:58:13.820

你根本不需要使用`isset`。在任一情况下

# arduino - 为什么 Launchpad msp430 (g2553) 中的 Arduino 库 dht11 不起作用？

> ID：13616573
> 
> 赞同：2
> 
> 时间：2012-11-28T23:57:25.243
> 
> 标签：arduino, msp430

如果 Launchpad 与 Arduino 兼容，为什么库不能工作？传感器数据足以导出到串口。

dht11 和 dht22 库有什么区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:09:38.543

有一个名为[Energia](http://energia.nu)的项目，它说它是 MSP430 的 Arduino 的一个分支。

[或者，这里](http://forum.43oh.com/topic/1825-interfacing-with-dht11-humidty-temp-sensor/#entry17355)有一篇文章，其中包含读取 MSP430 上 DHT11 的代码（据我所知，本机代码，不使用 Energia），还有一篇文章，其中包含读取 MSP430/Energia 上类似 DHT22 的代码[。](http://forum.43oh.com/topic/2239-solved-dht22-temp-rh-one-wire-sensor-on-energia/)

我从 Picaxe 论坛上关于这些传感器的讨论中了解到，它们对时间有点挑剔，所以你可能需要一些修补才能让这些东西正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-01T11:26:35.227

如果问题仍然有效，我在搜索 DHT11 和 MSP430 时遇到了这个问题：

请检查我为连接 DHT11 传感器和 MSP430 编写的以下代码，这些代码不需要任何库，您可以将其粘贴到代码编写器工作室的 main.c 文件中并调试+恢复。下面的第一个文件（dht11_MSP430G2553）进行一次读取，您可以在表达式窗口中看到值，第二个文件（MSP430_DHT11_Sensor）更成熟，它通过使用看门狗定时器复位微控制器循环读取值并输出串行监视器的值以 19200 波特 [https://github.com/selimg76/microcontroller/blob/master/dht11_MSP430G2553](https://github.com/selimg76/microcontroller/blob/master/dht11_MSP430G2553) [https://github.com/selimg76/microcontroller/blob/master/MSP430_DHT11_Sensor](https://github.com/selimg76/microcontroller/blob/master/MSP430_DHT11_Sensor)

详细解释在以下视频中：

[https://youtu.be/Hid_jB_Dy-A](https://youtu.be/Hid_jB_Dy-A) [https://youtu.be/Fzf8q6fgxfQ](https://youtu.be/Fzf8q6fgxfQ)

# css - 跨页面的 CSS 标头

> ID：13616574
> 
> 赞同：1
> 
> 时间：2012-11-28T23:57:33.053
> 
> 标签：css, header

所以我尝试了填充更改和宽度 100%。我一直在寻找一周左右的时间来解决这个问题。我希望页眉图像穿过页面和页脚。我的页脚有效，但页眉无效..这是我的 CSS 代码：

```
@charset "utf-8";
/* CSS Document */
body{

    margin:0px;
    padding:0px;

}

h1,h2,h3,h4,h5,h6,span
{
    margin:0px;
    padding:0px;
}

#headerbg
{

width:100%;
height:360px;
float: left;
margin:0px;
padding:0px;
background-image:url(images/headerbg.jpg);
background-repeat:repeat-x;

 }

 #headerblank
{
    width:1004px;
    height:309px;
    float: none;
    margin:0 auto;
    padding:0px;
}
 #header
{

width:100%;
height:360px;
float: left;
margin:0px;
padding:0px;
background-image:url(images/header.jpg);
background-repeat:no-repeat;

} 
```

感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:17:31.920

尝试这个：

```
 #header
{    
   width:1004px;
   height:360px;
   /*float: left;  remove this */
   margin-left: auto;
   margin-right: auto;
   padding:0px;
   background-image:url(images/header.jpg);
   background-repeat:no-repeat;

}

#headerBlank
{
   width:100%;
   /* the rest of your css... */
} 
```

在您在 Chrome 上提供的网站链接上对此进行了测试。

# gwt - 调用 JSNI 方法时发生 ClassCastException

> ID：13616575
> 
> 赞同：1
> 
> 时间：2012-11-28T23:57:39.297
> 
> 标签：gwt, classcastexception, jsni

我有以下`GWT`代码：

```
package my.package.name;

public class MyImpl {

    public void scan(AsyncCallback<String> callBack) {
        this.callBack = callBack;
        scanJNSI();
    }

    private native void scanJNSI()/*-{
        var instance = this;
        instance.@my.package.name.MyImpl::onError(Ljava/lang/String;)("BROWSER");
    }-*/;

    private void onError(String obj) {
        callBack.onFailure(new Exception(obj));
    }
} 
```

当我打电话时：

```
instance.scan(new AsyncCallback<String>() {
    @Override
    public void onSuccess(String result) {
        Window.alert(result);
    }

    @Override
    public void onFailure(Throwable caught) {
        Window.alert(caught.getMessage());
    }
}); 
```

我得到一个`Caused by: java.lang.ClassCastException: null`：

```
Caused by: java.lang.ClassCastException: null
    at java.lang.Class.cast(Class.java:2990)
    at com.google.gwt.dev.shell.JsValueGlue.get(JsValueGlue.java:163)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:57)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeVoid(ModuleSpace.java:289)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeVoid(JavaScriptHost.java:107)
    at my.package.name.MyImpl.scanJNSI(MyImpl.java)
    at my.package.name.MyImpl.scan(MyImpl.java:12) 
```

什么可能是它无法投射的类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:15:39.177

我找到了解决方法：

我更换了：

```
instance.@my.package.name.MyImpl::onError(Ljava/lang/String;)("BROWSER"); 
```

和：

```
instance.@my.package.name.MyImpl::onError(Lcom/google/gwt/core/client/JavaScriptObject;)({name:"BROWSER"}); 
```

和

```
private void onError(String obj) {
    callBack.onFailure(new Exception(obj));
} 
```

和：

```
private void onError(JavaScriptObject obj) {
    JSOModel jso = obj.cast();
    callBack.onFailure(new Exception(jso.get("name")));
} 
```

它奏效了..

我不知道使用`String`类是否有问题。

# coldfusion - Coldfusion QoQ 和条件

> ID：13616576
> 
> 赞同：1
> 
> 时间：2012-11-28T23:58:11.370
> 
> 标签：coldfusion, qoq

不久前，我问了一个问题（[按列（SQL Server）](https://stackoverflow.com/questions/10239057/query-with-grouped-results-by-column-sql-server)对结果进行分组查询）。并得到了一些适用于 SQL 服务器的答案，但我无法让它们作为 QoQ 的一部分工作。原来 CF 有一些小的限制，比如不能使用`INNER JOIN`

我想要实现的是获取一个查询，该查询可以为同一个项目有多个项目名称，但是当我调用我的 QoQ 时，我希望它过滤（保留）与语言 ID 匹配的项目，如果有的话是一个，如果缺少，则默认为另一个。

我正在为几个查询执行此操作，因此我试图将代码放在一个函数中，在其中插入查询，uniqueColumn 名称为 languageId。

因为我不能使用内部连接并且我遇到了一些条件问题，所以我正在考虑创建第二个表，它只有匹配的 languageId，然后添加另一个表中缺少的条目。

有没有办法在一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:35:33.343

您可以使用 Q of Q 进行内部联接。您不能使用关键字“join”。您必须在 where 子句中加入您的查询。像这样的东西：

```
select whatever
from query1, query2
where query1.field1 = query2.field2
etc 
```

Q of Q union 查询的完成方式与对数据库查询的处理方式相同。要执行这样的操作，“我希望它过滤（保留）与语言 ID 匹配的项目（如果有的话），如果缺少则默认为另一个。”，代码将类似于

```
select query2.actual_value
from query1, query2
where query1.field1 = query2.field2
etc
union
select default_value
from query1
where field1 not in( ValueList(query2.field2) ) 
```

但当然有正确的语法和查询参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:43:49.767

最终做了很多事情：与原始解决方案相比，这加快了很多:)

```
<cffunction name="getUniqueName" output="true" returntype="Query">
    <cfargument name="q" Type="query" required="true">
    <cfargument name="uniqueColumn" Type="string" required="false" default="ID">
    <cfargument name="languageId" Type="string" required="false" default="">

    <cfif languageID EQ ''><cfset languageID = #session.langID#></cfif> <!--- default language id to user language id --->

    <!--- Get all items that match language ID --->
    <cfquery dbtype="query" name="qwLangId">
        SELECT *
        FROM 
          q
        WHERE 
          languageid = #languageId#  
    </cfquery>

    <!--- Get list of IDs for items found --->
    <cfset usedIDs = ArrayToList(qwLangId[uniqueColumn])>

    <cfif usedIDs NEQ ''>
        <!--- get all items that were not found in matched query --->
        <cfquery dbtype="query" name="qMissing">
            SELECT *
            FROM 
              q
            WHERE #uniqueColumn# NOT IN(#usedIDs#)
        </cfquery>

        <!--- combine items in a new query --->
        <cfquery dbtype="query" name="langQ">
            SELECT * FROM qwLangId
            UNION
            SELECT * FROM qMissing
            ORDER BY #uniqueColumn#
        </cfquery>
        <cfreturn langQ>
    <cfelse>
        <cfreturn q>
    </cfif>

</cffunction> 
```

# java - 错误 - jar 未被识别为内部或外部命令、可运行程序或批处理文件

> ID：13616586
> 
> 赞同：16
> 
> 时间：2012-11-28T23:59:32.137
> 
> 标签：java, jar

在 cmd 中执行 jar 命令时出现上述错误。我试图通过将 jar.exe 文件的路径放在“我的电脑”>>“设置”>“高级系统设置”>“环境变量”中的“路径”变量中来解决这个问题。

我就是这样做的-

```
(old path variables here);C:\Program Files (x86)\Java\jdk1.7\bin\jar.exe 
```

我保存了更改并尝试再次在 cmd 中运行 jar 并得到相同的错误。请告诉我我的错误以及如何解决它。我需要完成这项工作，以便我可以通过命令行创建 jar 文件。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-29T00:01:57.207

该路径应仅包含操作系统将在其中查找可执行文件的目录。剥离尾随`"\jar.exe"`以将您的路径设置为：

```
(old path variables here);C:\Program Files (x86)\Java\jdk1.7\bin 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T00:20:07.307

你有一个空间：C:\Program Files (x86)\Java\jdk1.7\bin\jar.exe

尝试使用引号：“C:\Program Files (x86)\Java\jdk1.7\bin\jar.exe”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-02-27T17:39:55.853

解决这个问题的三个步骤：

1.  检查您的 bin 文件夹`jar.exe`中是否可用
2.  检查您的环境设置
3.  [从这里](http://originaldll.com/file/jar.exe/29248.html)下载 jar 文件 并将其保存在 bin 文件夹中
4.  现在检查 jar 它将 100% 工作
5.  在桌面上保留任何 jar 并在 cmd 提示符下转到桌面路径并运行命令 `jar xf filename.jar`
6.  现在看到它正在工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-21T16:46:50.767

我需要做其他解决方案：

1.  创建快捷方式`C:\Program Files (x86)\Java\jdk1.7\bin\java.exe`
2.  打开`C:\ProgramData\Oracle\Java\javapath`. 您可以将地址复制到文件资源管理器，或者您应该将其设置为显示隐藏文件。
3.  将之前创建的快捷方式复制到 javapath 文件夹，替换现有的快捷方式。确保它的名称准确`java.exe`

完毕！你去吧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-10T09:32:14.983

假设您安装了有效的 Java JDK，并且您已经检查了该`java --version`命令是否正常工作。您可以按照以下步骤解决此问题：

1.  搜索“高级系统设置”
2.  打开“系统变量”
3.  `Path`从该`System Variables`部分单击
4.  按`Edit`
5.  在打开的列表中搜索`%JAVA_HOME%\bin`并将其替换为`%JAVA_HOME%\bin\`
6.  点击`Ok`
7.  关闭并重新打开终端，它现在应该可以工作了。

您必须在添加到 main`\`的现有路径的末尾添加 a 。`%JAVA_HOME%\bin``Path`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-15T10:50:34.477

*   您必须在创建 jar 文件之前设置 JDK 文件的路径。
*   另一种方法是在您的系统中设置环境变量。

# scala - 如何在scala中获得每个单词的第一个字母？

> ID：13616589
> 
> 赞同：8
> 
> 时间：2012-11-28T23:59:48.867
> 
> 标签：scala

如果我有短语“纽约市”，我如何获得每个单词的第一个字母？我的谷歌搜索只向我展示了如何将每个单词的第一个字母大写，这似乎与我想要做的不同。

鉴于我对 Scala 的了解有限，我可能可以通过程序来执行此操作，但我希望有人可以向我介绍一些 Scala 知识，并向我展示一个描述此问题的函数式方法的示例。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-29T00:17:01.453

所有其他版本都可以正常工作，但为了避免格式错误的字符串（连续两个空格，空字符串）失败，请使用

```
"New York City".split(" ").flatMap(_.headOption).mkString 
```

这也适用于

```
"New  York  City".split(" ").flatMap(_.headOption).mkString 
```

甚至

```
"".split(" ").flatMap(_.headOption).mkString 
```

正如[dhg](https://stackoverflow.com/questions/13616589/how-do-i-get-the-first-letter-in-each-word-in-scala#comment18674162_13616757)所建议的那样，人们可能还想使用更合适的正则表达式`"\\s+"`。但是，人们不妨使用更合适的东西：

```
"""\w+""".r.findAllIn("New  York  City").map(_.head).mkString 
```

（在这里`/\w+/`应该希望我们能免于病理病例，这样我们就可以使用这个`.head`版本。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-29T00:01:42.067

```
scala> "New York City".split(" ").map(_.head).mkString
res5: String = NYC 
```

这被“”分割成一个单词数组。然后我们映射该数组并调用 String.head 来获取第一个字符。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-29T00:02:32.880

```
"New York City".split(" ").toList.map(_(0)) 
```

给出字符：

```
List[Char] = List(N, Y, C) 
```

如果你想要一个字符串`mkString`使用`List[Char]`：

```
"New York City".split(" ").toList.map(_(0)) mkString 
```

要得到：

```
String = NYC 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-29T00:02:41.110

```
"New York City".split(" ").map(_.charAt(0)) 
```

会给你一个char数组

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-29T11:12:28.597

这是使用拆分（正则表达式）的替代方法。

这里的技巧是使用 zip 允许在遍历字符串的同一迭代中测试当前和前一个字符，单词边界由前面有一个非字母的任何字母组成。

两种特殊情况，第一个和最后一个字母，通过 1) 在字符串的副本前添加一个空格来处理，这也设置了 zip 所需的 1 个字符倾斜和 2) zip 截断部分对。

```
val s = "\n1New\n\t \t \tYork --City\n\t"

def firstLetters(s: String) = {
  " "+s zip s collect {case (w, c) if ! w.isLetter && c.isLetter => c}
}

firstLetters(s) 
```

返回

```
Vector(N, Y, C) 
```

# c# - 整数修剪起始零

> ID：13616591
> 
> 赞同：1
> 
> 时间：2012-11-28T23:59:59.280
> 
> 标签：c#, integer

简单地，

```
class Program
{
    static void Main( string [ ] args )
    {
        int i = 010;

        Console.WriteLine( i );

        Console.ReadKey( );
    }
} 
```

输出：

> 10

**如何**停止修剪前导零？
小数具有相同的输出，字符串也不是最佳解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:03:36.813

数字类型只跟踪数字的二进制表示，而不是用于初始化它们的字符串表示。

如果您想要恒定的位数，可以在输出时对其进行格式化：

```
Console.WriteLine(i.ToString("D8")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:01:30.367

您需要将其存储在字符串中。然后，您可以在需要计算时将其转换回整数，然后在使用所需格式完成后将其转换回字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:49:55.290

```
Console.WriteLine("{0:D8}", i); 
```

将打印包含至少 8 位数字的“i”。任何缺失的数字都将变成前导零。

# windows-installer - 如何将文件导入 MSI 文件？

> ID：13616594
> 
> 赞同：1
> 
> 时间：2012-11-29T00:00:09.803
> 
> 标签：windows-installer, installshield, setup-deployment

当我将`Compression`设置设置`Installshield Express`为 时`Uncompressed`，构建输出是一个文件以及许多将用于安装`MSI`的文件和文件夹。`MSI`

如何将所有这些文件和文件夹放入`MSI`文件中，使其成为一个独立的`MSI`包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T08:01:57.747

只需将 设置`Compression`为`Compressed`，您将收到一个 MSI。
您也可以`Release Configuration Panel`用于`Release Wizard`此目的。有 3 个选项：

*   压缩所有文件
*   保持文件未压缩并与安装包分开
*   自定义（您可以选择应压缩哪些功能，哪些不压缩）

# c++ - 是否可以在 wxFrame 中捕获鼠标事件

> ID：13616599
> 
> 赞同：1
> 
> 时间：2012-11-29T00:00:21.683
> 
> 标签：c++, c, ubuntu, wxwidgets

我一直在网上搜索并试图找出是否可以在 wxWidgets 中的实际 wxFrame 元素中捕获鼠标事件。各种消息来源说这是不可能的，应该使用 wxPanels 来捕获事件，这是真的吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:09:51.213

鼠标事件**不会**向上传播窗口层次结构，因此如果您的框架完全被其他窗口覆盖，那么它首先不会获得任何鼠标事件，因此您无法在那里捕获它们。

当然，您始终可以`wxFrame`使用`Bind()`. 例如：

```
MyFrame::MyFrame(...)
    : wxFrame(...)
{
    wxPanel* p = new wxPanel(this);
    p->Bind(wxEVT_MOTION, &MyFrame::OnMouseMotion, this);
} 
```

将允许您以帧方法处理面板上发生的鼠标运动事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T12:01:46.320

大部分是真的。

一些鼠标事件会进入框架，例如 wxEVT_ENTER（或其他任何名称）。其他人进入面板，例如 wxEVT_RIGHT_UP。您可以将这些事件转发到框架。

绑定到面板和框架中的事件。

```
Bind(wxEVT_RIGHT_UP, &MyFrame::OnMouse, ptr_to_myframe);
Bind(wxEVT_RIGHT_UP, &MyPanel::OnMouse, ptr_to_panel); 
```

然后（假设框架是面板的父级），

```
void MyPanel::OnMouse(wxMouseEvent &event) {
    wxPostEvent(GetParent(), event);
} 
```

如果面板是滚动的，您可能希望转发带有未滚动坐标的事件。

```
void MyScrolledPanel::OnMouse(wxMouseEvent &event) {
    wxMouseEvent pevent(event);
    CalcUnscrolledPosition(event.GetX(), event.GetY(), &pevent.m_x, &pevent.m_y);
    wxPostEvent(GetParent(), pevent); 
} 
```

# python - 在 Python 中使用字典代替动态变量名

> ID：13616608
> 
> 赞同：2
> 
> 时间：2012-11-29T00:01:22.623
> 
> 标签：python, list, variables, dictionary, dynamic-variables

我有一个包含卡车配置的长文本文件。在每一行中，卡车的一些属性被列为字符串。每个属性在字符串中都有自己的固定宽度空间，例如：

```
2 chracters = number of axles
2 characters = weight of the first axle
2 characters = weight of the second axle
...
2 characters = weight of the last axle
2 characters = length of the first axle spacing (spacing means distance between axles)
2 characters = length of the second axle spacing
...
2 characters = length of the last axle spacing 
```

举个例子：

```
031028331004 
```

指：

```
number of axles = 3
first axle weight = 10
second axle weight = 28
third axle weight = 33
first spacing = 10
second spacing = 4 
```

现在，您对我的文件结构有所了解，这是我的问题：我想将这些卡车分组到单独的列表中，并根据轴距命名列表。假设我正在使用布尔类型的方法，如果间距小于 6，则布尔值为 1，如果大于 6，则布尔值为 0。为了澄清，三轴卡车的可能结果变为：

```
00 #Both spacings > 6
10 #First spacing < 6, second > 6
01 #First spacing > 6, second < 6
11 #Both spacings < 6 
```

现在，正如您所见，对于 3 轴卡车来说，结果并不多。但是，如果我有一辆 12 轴卡车，“可能”组合的数量就会变得混乱。问题是，实际上您不会在 12 轴卡车中看到所有“可能”的轴距组合。有某些组合（我不知道是哪些，但弄清楚是我的目标）的数量远少于“可能的”组合数量。

**如果仅**存在这样的组合，我希望代码创建列表并用定义我上面提到的属性的字符串填充它们。我想也许我应该创建带有变量名的列表，例如：

```
truck_0300[]
truck_0301[]
truck_0310[]
truck_0311[] 
```

在飞行中。但是，根据我在 SF 和其他来源中阅读的内容，强烈建议不要这样做。您将如何使用字典概念来做到这一点？我知道字典就像二维数组，有一个键（在我的情况下，键可能是 truck_0300、truck_0301 等）和值对（在我的情况下，值可能是包含实际字符串的列表属于相应的卡车类型），但是我不知道如何创建该字典，并用变量键和值填充它。

欢迎任何见解！非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T00:10:34.517

您绝对正确，尝试在范围内创建“动态变量”几乎总是一个坏主意。字典通常是随着时间的推移建立对象集合并引用它们的答案......

我不完全理解您的应用程序和格式，但通常定义和使用您的字典看起来像这样：

```
trucks = {}
trucks['0300'] = ['a']
trucks['0300'].append('c')
trucks['0300'].extend(['c','d'])

aTruck = trucks['0300'] 
```

现在因为每一个都应该是你的字符串列表，你可能只想使用一个 defaultdict，并告诉它使用一个列表作为不存在键的默认值：

```
from collections import defaultdict

trucks = defaultdict(list)
trucks['0300']
# [] 
```

请注意，即使它是一个不包含任何条目的全新字典，“truck_0300”键仍会返回一个新列表。这意味着您不必检查密钥。只需附加：

```
trucks = defaultdict(list)
trucks['0300'].append('a') 
```

A`defaultdict`可能是您想要的，因为您根本不必预先定义键。当您准备好时，它就在那里。

**获取最大值的键**

根据您的评论，这是一个如何获取具有字典最大值的键的示例。这很容易，因为您只需使用`max`并定义它应该如何确定用于比较的密钥：

```
d = {'a':10, 'b':5, 'c':50}
print max(d.iteritems(), key=lambda (k,v): v)
# ('c', 50)
d['c'] = 1
print max(d.iteritems(), key=lambda (k,v): v)
# ('a', 10) 
```

您所要做的就是定义如何生成比较键。在这种情况下，我只是告诉它以值作为键。对于像这样非常简单的关键函数，您只是告诉它从对象中提取索引或属性，您可以通过使用`operator`模块来提高效率，以便关键函数在 C 中而不是在 python 中作为 lambda：

```
from operator import itemgetter
...
print max(d.iteritems(), key=itemgetter(1))
#('c', 50) 
```

`itemgetter`创建一个新的可调用对象，它将从循环传入的元组中提取第二项。

现在假设每个值实际上是一个列表（类似于您的结构）。我们将使它成为一个数字列表，并且您想要找到具有最大总数的列表的键：

```
d = {'a': range(1,5), 'b': range(2,4), 'c': range(5,7)}
print max(d.iteritems(), key=lambda (k,v): sum(v))
# ('c', [5, 6]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:13:21.870

如果密钥的数量超过 10,000，那么这种方法是不可行的。否则定义一个字典 d = {} 并在你的行上循环：

```
key = line[:4]
if not key in d.keys():
    d[key] = []
d[key] += [somevalue] 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:19:58.893

这是从字符串到输出的完整解决方案：

```
from collections import namedtuple, defaultdict

# lightweight class
Truck = namedtuple('Truck', 'weights spacings')

def parse_truck(s):
    # convert to array of numbers
    numbers = [int(''.join(t)) for t in zip(s[::2], s[1::2])]

    # check length
    n = numbers[0]
    assert n * 2 == len(numbers)
    numbers = numbers[1:]

    return Truck(numbers[:n], numbers[n:])

trucks = [
    parse_truck("031028331004"),
    ...
]

# dictionary where every key contains a list by default
trucks_by_spacing = defaultdict(list)

for truck in trucks:
    # (True, False) instead of '10'
    key = tuple(space > 6 for space in truck.spacings)
    trucks_by_spacing[key].append(truck)

print trucks_by_spacing

print trucks_by_spacing[True, False] 
```

# tabs - 使用包含获取数据（数字）的文本框的布局创建一个选项卡（称为 MNOP）。

> ID：13616616
> 
> 赞同：0
> 
> 时间：2012-11-29T00:02:06.730
> 
> 标签：tabs, textbox, pyqt, qwidget, qlabel

如何在 PyQT UI 中创建一个选项卡，其布局包含以下示例。

选项卡名称-MNOP

布局有。

*   a1：可以输入数据（数字）的文本框
*   a2: textbox hat 可以输入数据
*   a3：可以输入数据的文本框
*   a4：可以输入数据的文本框

数据输入将存储在数据库中并用于创建条形图。现在我需要创建选项卡和文本框。

现在，我正在处理以下不完整但不知道如何继续。

```
class RPBDlg(QDialog):
def __init__(self, parent=None):
    super(RPBDlg, self).__init__(parent) 
    self.newcounter =0 

    grid = QGridLayout()  
    label = QLabel() 
    label.setText("<B>Plan Title:</B>") 
    self.titleEdit = QLineEdit() 

    grid.addWidget(label,0,0,1,1) 
    grid.addWidget(self.titleEdit,0,1,1,1)
    label2 = QLabel("<B>Type of Plan</B>") 
    self.typeEdit = QComboBox() 
    self.typeEdit.addItems(["STI","LTI","STI and LTI"])  

    grid.addWidget(label2,1,0,1,1) 
    grid.addWidget(self.typeEdit,1,1,1,1)
    self.bonusPool = QCheckBox("Bonus Pool") 
    grid.addWidget(self.bonusPool,1,4,1,1) 
    label3 = QLabel("<B>Sub-Type of Plan<B>") 
    self.subTypeEdit = QComboBox() 
    self.subTypeEdit.addItems(["Regular","Profit Sharing","Multiplier Based"]) 
    grid.addWidget(label3,1,2,1,1)
    grid.addWidget(self.subTypeEdit,1,3,1,1)
    self.label4 = QLabel("<B>Are individual awards determined <br>through a performance formula?")
    self.bonusPoolAdditional = QComboBox() 
    self.bonusPoolAdditional.addItems(["Yes - separate formula for individual awards","Yes - individual awards are proportional to bonus pool", "No - individual awards are discretionary","No - individual awards determined through negative discretion"])
    grid.addWidget(self.label4,3,0,1,1) 
    grid.addWidget(self.bonusPoolAdditional,3,1,1,2) 
```

存在进口。此代码是更大代码的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T18:04:00.753

如果你想在你的 UI 中使用标签，你应该创建一个`QTabWidget`. 使用它的基本步骤是：

*   创建一个`QTabWidget`.
*   为选项卡对话框中的每个页面创建一个没有父级的 QWidget。为他们。
*   将子小部件插入页面小部件，使用布局将它们正常定位。
*   调用 addTab() 或 insertTab() 将页面小部件放入选项卡小部件中，为每个选项卡提供合适的标签和可选的键盘快捷键。

[您可以在小部件的文档页面](http://doc.qt.digia.com/qt/qtabwidget.html)中找到详细信息。

# javascript - 点击事件循环丢失数组范围

> ID：13616617
> 
> 赞同：1
> 
> 时间：2012-11-29T00:02:09.453
> 
> 标签：javascript, jquery, arrays, for-loop, dom-events

> **可能重复：**
> [循环内的 Javascript 闭包 - 简单的实际示例](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

我有一个包含 4 个对象 () 的数组`that.pairs`，每个对象都有`.t`一个 jQuery 对象/元素的属性。我正在尝试在每个`t`被点击时设置一个事件。

问题是，当其中一个被点击时，总是最后一对（索引 3）被传递到我的`doToggle()`函数中。

为什么会这样？我该如何解决？

```
for (var i = 0; i < that.pairs.length; i++) {
    var p = that.pairs[i];
    p.t.click(function() {
        that.doToggle(p);
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:03:58.413

这是因为该`p`变量由您的闭包共享，因此只有一个 p 变量。当你的处理程序被调用时，p 已经改变了。

你必须使用我称之为冻结你的闭包的技术

```
for (var i = 0; i < that.pairs.length; i++) {
    // The extra function call creates a separate closure for each
    // iteration of the loop
    (function(p){
        p.t.click(function() {
            that.doToggle(p);
        });
    })(that.pairs[i]); //passing the variable to freeze, creating a new closure
} 
```

实现此目的的一种更易于理解的方法如下

```
function createHandler(that, p) {
    return function() {
       that.doToggle(p);
    }
}

for (var i = 0; i < that.pairs.length; i++) {
    var p = that.pairs[i];
    // Because we're calling a function that returns the handler
    // a new closure is created that keeps the current value of that and p
    p.t.click(createHandler(that, p));
} 
```

**闭包优化**

由于在评论中有很多关于闭包的讨论，我决定放这两个屏幕截图，显示闭包得到了优化，并且只包含了所需的变量

此示例[http://jsfiddle.net/TnGxJ/2/](http://jsfiddle.net/TnGxJ/2/)显示了如何仅`a`包含 ![没有评估的闭包](../Images/cf7ac42250f038fb2ea467468f4ebfe3.png)

在这个例子中[http://jsfiddle.net/TnGxJ/1/](http://jsfiddle.net/TnGxJ/1/)，因为有一个`eval`，所以所有的变量都被括起来了。 ![用 eval 闭包](../Images/32f6121de0ca06036ff4a9feae0d500b.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T00:04:34.567

使用`$.each`而不是`for`循环，以便每次迭代都获得一个新的变量范围。

```
$.each(that.pairs, function(i, p) {
    p.t.click(function() {
        that.doToggle(p);
    });
}); 
```

这样，每个`click`处理程序都会关闭一个唯一的变量范围，而不是共享的外部变量范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T00:03:47.450

```
for (var i = 0; i < that.pairs.length; i++) {
    var p = that.pairs[i];
    (function(p){
        p.t.click(function() {
            that.doToggle(p);
        });
    }(p));
} 
```

IIFE 的这个技巧将解决您现在遇到的关闭“问题”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T00:03:55.197

```
for (var i = 0; i < that.pairs.length; i++) {
    (function(num){
       var p = that.pairs[num];
       p.t.click(function() {
          that.doToggle(p);
       });
    })(i)
} 
```

**经典关闭问题**

将它们包含在一个匿名函数中，并在上下文中分配当前迭代。那应该可以解决问题..

# php - 如何将新的 php 对象添加到对象数组中

> ID：13616618
> 
> 赞同：2
> 
> 时间：2012-11-29T00:02:12.420
> 
> 标签：php, ajax, arrays, object

我有一个具有添加用户功能的用户类。

我还有一个表单可以触发提交时的 ajax 调用，它将用户名的查询字符串和可能的其他信息传递给控制器​​。

每次通过 ajax 调用控制器时，它都会创建我的用户类的新实例，并通过将查询字符串作为参数传递来调用 add user 函数。

有没有一种方法可以输出已提交的用户名数组而不将其存储在会话中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:34:17.560

我使用一个全局变量来表示我当前处于 AjAX 模式。因此，当您调用 AJAX 控制器时，请设置一个全局变量。

然后通过检查是否定义了全局变量来跳过添加用户功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:05:51.440

您的选择是存储它：

1.  在一个会话中。
2.  在一个文件中。
3.  在数据库中。

PHP 不是一个持久服务，并且不会记住请求之间的任何内容，除了存储在会话中或外部存储中的内容。

# c# - 通过代码构建 XML 文档

> ID：13616620
> 
> 赞同：0
> 
> 时间：2012-11-29T00:02:27.063
> 
> 标签：c#, xml

我尝试为 Visual Studio 编写一个用于 XML 代码文档的小插件。但是我创建 XML 的代码无法正常工作：

```
XElement rootElement = new XElement("doc");
XElement summaryElement = new XElement("summary");

var refElement = new XElement("see");
refElement.Add(new XAttribute("cref", codeFunction.Name));
summaryElement.Value = string.Format("Initializes a new instance of the {0} class.", seeRefElement);
rootElement.Add(summaryElement);
comment = rootElement.ToString(); 
```

这是输出。

> ```
> <doc>\r\n  <summary>Initializes a new instance of the &lt;see cref="Form1" /&gt; class.</summary>\r\n</doc> 
> ```

它应该是：

> ```
> <doc>\r\n  <summary>Initializes a new instance of the <see cref="Form1" />class.</summary>\r\n</doc> 
> ```

我应该使用另一种方式来创建我的 XML 吗？任何提示和改进都值得赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:14:09.267

替换以下行

```
summaryElement.Value = string.Format("Initializes a new instance of the {0} class.", refElement); 
```

和

```
summaryElement.Add(new XText("Initializes a new instance of the "));
summaryElement.Add(refElement);
summaryElement.Add(new XText(" class.")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:05:24.190

是的，它理所当然地逃避了 < 。其他地方有一个关于此的线程，并提供了一些建议的解决方法：

[http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/413654f3-dc2d-4b96-8a7e-bde69da05866](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/413654f3-dc2d-4b96-8a7e-bde69da05866)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:26:25.443

最简单的方法是使用 Sandcastle 从摘要 XML 生成 API 文档。请参阅此线程以获取链接：[是否有任何好的自动化工具来记录 REST API](https://stackoverflow.com/questions/12535410/are-there-any-good-automated-tools-to-document-rest-apis)

# knockout.js - Breeze 和 Knockout 中的验证

> ID：13616621
> 
> 赞同：7
> 
> 时间：2012-11-29T00:02:28.233
> 
> 标签：knockout.js, asp.net-mvc-4, breeze

> 我最近将 Breeze 添加到使用 Knockout 和 ASP.NET MVC4 的项目中。我真的很喜欢 Breeze，它节省了很多编码。
> 
> 我使用了 Knockout 验证，并且喜欢它如何验证数据输入上的属性字段文本框以及错误消息的显示方式。
> 
> 我想使用一种组合，其中验证要求在后端与对象属性上的 C# 属性一起定义，验证要求在元数据中接收，然后可以使用 Knockout 验证。
> 
> 我想我可以通过在前端定义属性并应用 Knockout 验证来解决它，例如
> 
> ```
> classProperty.extend({ required: true })
>              .extend({ minLength: 3 }); 
> ```
> 
> 有没有办法使用 Knockout 验证而无需在前端应用验证要求？如果没有，您是否正在考虑这样做？

此问题由 johnvarney 在我们的 IdeaBlade 论坛上发布。我在这里重新发布问题和答案，因为我认为它对 Breeze Stack Overflow 社区很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T00:02:28.233

您可能已经注意到，Breeze 已经基于元数据执行了验证。基本的“验证”规则，例如是否需要一个属性、它的数据类型以及它的长度（如果在服务器上自动生成一个字符串并发送到客户端）。这些验证规则也可以通过直接修改客户端上的“验证”元数据来扩展。

API 文档中提供了有关此主题的更多信息：[http](http://www.breezejs.com/sites/all/apidocs/classes/Validator.html) ://www.breezejs.com/sites/all/apidocs/classes/Validator.html 以及 Breeze 示例下载中的“DocCode”示例目录。

我们还计划提供如何将微风验证“连接”到各种第三方库的示例，例如 jQuery 和 Knockout。不幸的是，这些示例目前不是一个高优先级，因为它正在处理其他高要求的功能。您可能想在我们的 Breeze 用户语音[https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions)上为这些示例的工作投票。在决定下一步该做什么时，我们会认真对待该场所。

# css - 删除 Twitter Bootstrap 表中单个单元格的表悬停效果

> ID：13616625
> 
> 赞同：7
> 
> 时间：2012-11-29T00:02:49.803
> 
> 标签：css, twitter-bootstrap

我正在使用 Twitter Bootstrap 开发一个网络应用程序。在我们的一个视图中，有一个使用`.table-hover`该类的表。不过，表格中有一些特定的单元格，当它们的其余行突出显示时，我不想突出显示它们。我应该使用什么样式规则来达到这种效果？

这大致是我的视图表的组织方式：

```
<table class="table table-hover">
    <thead>
        <tr>
            <th />
            <th>Header 1</th>
            <th>Header 2</th>
            <th>Header 3</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="2">Row Group "Heading" 1</td>
            <td>Content</td>
            <td>Content</td>
            <td>Content</td>
        </tr>
        <tr>
            <td>Content</td>
            <td>Content</td>
            <td>Content</td>
        </tr>
        <tr>
            <td rowspan="2">Row Group "Heading" 2</td>
            <td>Content</td>
            <td>Content</td>
            <td>Content</td>
        </tr>
        <tr>
            <td>Content</td>
            <td>Content</td>
            <td>Content</td>
        </tr>
    </tbody>
</table> 
```

我想让跨越 2 行的单元格在悬停时不突出显示。

编辑：

我试过这个CSS：

```
td.rowTitle:hover { background-color: transparent; } 
```

不幸的是，它不起作用。我认为这可能是因为整行被突出显示，而不仅仅是单元格......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-29T00:22:47.487

这是引导 CSS 的样子：

```
.table-hover { 
             tbody { tr:hover td, tr:hover th 
                             { background-color: @tableBackgroundHover; } 
                        }
           } 
```

使用一点 JQuery：

```
 $('td[rowspan]').addClass('hasRowSpan'); 
```

然后，您可以使用以下 CSS 覆盖它：

```
tbody tr:hover td.hasRowSpan { 
          background-color: none;   /* or whatever color you want */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:14:14.380

我不确定使用什么方法来创建这些“悬停”，但是如果您分隔这些单元格，您可以添加特定的悬停规则。所以给这些单元格一个类名，然后你可以为它们设置你的特定样式/悬停。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-06T10:49:09.607

我会向您不希望悬停的元素添加一个类，例如：

```
<tr>
  <td rowspan="2" class="no-hover">Row Group "Heading" 2</td>
  <td>Content</td>
  <td>Content</td>
  <td>Content</td>
</tr> 
```

在您的 CSS/SCSS 中：

```
.table-hover {
  .no-hover {
    background-color: transparent !important;
  }
} 
```

在 Bootstrap 4 中工作。

# android - 在 Android 中绘制路线会折叠设备

> ID：13616626
> 
> 赞同：0
> 
> 时间：2012-11-29T00:03:18.013
> 
> 标签：android, android-mapview

我正在开发一个必须在地图视图上显示一些“感兴趣的地方”以及设备当前位置的 Android 应用程序。这很好用。此外，在我的应用程序中，用户可以“点击”“感兴趣的地方”标记，并且应用程序必须绘制到该标记的路线。

我使用 Google Directions api 来获取路线，并使用折线解码器来获取用户和地点之间的 GeoPoints。对于我的测试路线，谷歌给了我大约 200 个不同的 GeoPoints。

所以，我有一个这样的类来添加这些 GeoPoints：

```
public class RouteOverlay extends Overlay {
    private GeoPoint gp1;
    private GeoPoint gp2;
    private int color;

    public RouteOverlay(GeoPoint gp1, GeoPoint gp2, int color) {
        this.gp1 = gp1;
        this.gp2 = gp2;
        this.color = color;
    }

    @Override
    public void draw(Canvas canvas, MapView mapView, boolean shadow) {
        Projection projection = mapView.getProjection();
        Paint paint = new Paint();
        Point point = new Point();
        projection.toPixels(gp1, point);
        paint.setColor(color);
        Point point2 = new Point();
        projection.toPixels(gp2, point2);
        paint.setStrokeWidth(5);
        paint.setAlpha(120);
        canvas.drawLine(point.x, point.y, point2.x, point2.y, paint);
        super.draw(canvas, mapView, shadow);
    }

} 
```

我绘制路线的方法如下： 1) 将 onClick 事件检测到地图中的标记。2) 从那个事件中，我创建了一个新线程，在那里我调用了 Google API。3) 一旦我得到结果，我在 GeoPoint 列表中解析/转换它。4）然后我调用我的drawPath方法：

```
private void drawPath(List<GeoPoint> geoPoints, int color) {    
    mapOverlays.clear();
    mapOverlays.add(myLocationOverlay);
    mapOverlays.add(itemizedoverlay);
    for (int i = 1; i < geoPoints.size(); i++) {            
    mapOverlays.add(new RouteOverlay(geoPoints.get(i - 1), geoPoints.get(i), color));
    }
    mapView.postInvalidate(); 
```

5) 最后，我回到 UI 线程。

此方法清除地图覆盖列表（mapOverlays）。然后，将当前位置和“感兴趣的地方”叠加到列表中。最后，添加路线覆盖。

问题是，突然之间，工作非常缓慢，最后崩溃了。但是 LogCat 中没有消息。所以，我认为 30 个叠加层 + 1 个 + 超过 200 个的路线对于手机来说太多了。但是我见过的教程是这样做的，所以......

如果我做错了什么，有人可以告诉我吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:02:46.393

我弄清楚我做错了什么。

当我调用drawPath函数时，得到GeoPoints列表后，我做了一个循环来检查每个点的坐标。就像是

```
for (int i = 0; i < geoList.size(); i++){
    Log.i("GEOPOINT " + i, geoList.get(i).toString());
    drawpath(geoList, Color.BLUE);
} 
```

drawPath 函数被调用了 N 次。所以设备崩溃了。我的错。凌晨 2:00 编程对代码不好！

# c++ - 扩展一个简单的 makefile 以支持不同的隐式编译器标志

> ID：13616628
> 
> 赞同：1
> 
> 时间：2012-11-29T00:03:31.350
> 
> 标签：c++, makefile, gnu-make

我一直在使用一个相当简单的makefile。我用 .cc 文件列表定义了 OBJS。我设置了依赖项并包含标志并将所有这些附加到 $CXXFLAGS。它看起来像这样：

```
SRCS = file1.cc file2.cc file3.cc
OBJS = $(SRCS:.cc=.o)
CXXFLAGS=some flags
CXXFLAGS+=some include dirs
$(mylib.so): $OBJS
    $CXX -shared -o $@ $^ 
```

mylib.so （隐式）使用 CXXFLAGS 并且一切都构建得很好。

除了 mylib.so 之外，我最近还需要 mylib_1.so 和 mylib_2.so。每个 .so 都依赖于所有相同的 .cc 文件，但编译器标志都不同（包括包含目录）。

如何获取它，以便我可以根据目标 .so 设置编译器标志？我遇到的问题是，如果我多次设置 CXXFLAGS ，它就会被覆盖。这几乎就像我需要一个 if/else 情况。

我尝试设置三个不同的标志，$CXXFLAGS1、$CXXFLAGS2、$CXXFLAGS3，并使用这些标志

```
$(mylib1.so): $OBJS
    $CXX $(CXXFLAGS1) -shared -o $@ $^ 
```

但这不起作用。

我如何完成我想做的事情？有 3 个单独的 makefile 会更好吗？我确实找到了让它工作的方法。我可以停止使用 $OBJS 并为每个源文件明确地拼出标志，但这在缩放到大小方面似乎是一个可怕的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:17:29.860

您的示例中的 CXXFLAGS1 仅在创建 .so 文件的阶段使用，*而不是*用于编译实际的 C++ 源代码（我假设这是您正在尝试做的事情）。

要实现上述目的，请考虑让 Makefile 为 3 个不同的目标调用自身 3 次，并将 CXXFLAGS（具有不同的值）作为 MAKEFLAGS 的一部分或在命令行中传递。

**更新：**这是一个例子

```
全部：构建-lib1 构建-lib2 构建-lib3

构建-lib1：
    $(MAKE) $(MAKEFLAGS) CXXFLAGS="$(CXXFLAGS1)" lib1.so

构建-lib2：
    $(MAKE) $(MAKEFLAGS) CXXFLAGS="$(CXXFLAGS2)" lib2.so

构建-lib3：
    $(MAKE) $(MAKEFLAGS) CXXFLAGS="$(CXXFLAGS3)" lib3.so

$(lib1.so): $OBJS
    $(CXX) -共享 -o $@ $^

ETC...

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:11:33.440

Makefile 可以有[特定于目标的变量值](http://www.gnu.org/software/make/manual/html_node/Target_002dspecific.html)。就像是：

```
$(mylib1.so): CXXFLAGS += -lib1flags
$(mylib2.so): CXXFLAGS += -lib2flags
$(mylib3.so): CXXFLAGS += -lib3flags 
```

根据文档，标志将传播到先决条件目标。

> 特定于目标的变量还有一个特殊功能：当您定义特定于目标的变量时，该变量值也对该目标的所有先决条件及其所有先决条件等都有效（除非这些先决条件用它们的自己的目标特定变量值）。因此，例如，这样的语句：
> 
> ```
>  prog : CFLAGS = -g
>  prog : prog.o foo.o bar.o 
> ```
> 
> 将在 prog 的配方中将 CFLAGS 设置为“-g”，但它也会在创建 prog.o、foo.o 和 bar.o 的配方中以及创建其先决条件的任何配方中将 CFLAGS 设置为“-g” .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T00:21:19.243

我会通过递归调用来做到这一点。我会使用两个makefile：

在`Makefile`：

```
全部：mylib1.so mylib2.so

SRCS := file1.cc file2.cc file3.cc

mylib1.so: $(SRCS)
    测试-d mylib1 || mkdir mylib1
    $(MAKE) -f ../lib.mak -C mylib1 目标=mylib1.so CXXFLAGS=-DMYLIB=1
    cp mylib1/mylib1.so mylib1.so

mylib2.so: $(SRCS)
    测试-d mylib2 || mkdir mylib2
    $(MAKE) -f ../lib.mak -C mylib2 TARGET=mylib2.so CXXFLAGS=-DMYLIB=2
    cp mylib2/mylib2.so mylib2.so

```

在`lib.mak`，在同一目录中：

```
VPATH = ..

SRCS := file1.cc file2.cc file3.cc
OBJS := $(SRCS:.cc=.o)

$(目标): $(OBJS)
    $(CXX) -共享 -o $@ $^

```

第二个 makefile 实际构建库，但只使用一组`CXXFLAGS`. 主 makefile 调用每个版本的第一个 makefile，`CXXFLAGS`并在单独的目录中使用单独的目录。这`VPATH`使得编译不在同一目录中的源文件变得更加容易。

我用空运行测试了这个设置，

```
测试-d mylib1 || mkdir mylib1
make -f ../lib.mak -C mylib1 TARGET=mylib1.so CXXFLAGS=-DMYLIB=1
make[1]: 进入目录`/home/depp/Maketest2/mylib1'
g++ -DMYLIB=1 -c -o file1.o ../file1.cc
g++ -DMYLIB=1 -c -o file2.o ../file2.cc
g++ -DMYLIB=1 -c -o file3.o ../file3.cc
g++ -shared -o mylib1.so file1.o file2.o file3.o
make[1]: 离开目录`/home/depp/Maketest2/mylib1'
cp mylib1/mylib1.so mylib1.so
测试-d mylib2 || mkdir mylib2
make -f ../lib.mak -C mylib2 TARGET=mylib2.so CXXFLAGS=-DMYLIB=2
make[1]: 进入目录`/home/depp/Maketest2/mylib2'
g++ -DMYLIB=2 -c -o file1.o ../file1.cc
g++ -DMYLIB=2 -c -o file2.o ../file2.cc
g++ -DMYLIB=2 -c -o file3.o ../file3.cc
g++ -shared -o mylib2.so file1.o file2.o file3.o
make[1]: 离开目录`/home/depp/Maketest2/mylib2'
cp mylib2/mylib2.so mylib2.so

```

# ruby - RSpec 是否有可能期望在两个表中发生变化？

> ID：13616631
> 
> 赞同：41
> 
> 时间：2012-11-29T00:03:48.607
> 
> 标签：ruby, rspec

RSpec 期望变化：

```
it "should increment the count" do
  expect{Foo.bar}.to change{Counter.count}.by 1
end 
```

有没有办法期望两个表的变化？

```
expect{Foo.bar}.to change{Counter.count}.by 1 
and change{AnotherCounter.count}.by 1 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-05-10T15:33:27.377

我更喜欢这种语法（rspec 3 或更高版本）：

```
it "should increment the counters" do
  expect { Foo.bar }.to change { Counter,        :count }.by(1).and \
                        change { AnotherCounter, :count }.by(1)
end 
```

是的，这是一个地方的两个断言，但是因为该块只执行一次，它可以加快测试速度。

`.and`编辑：在避免语法错误之后添加反斜杠

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-07-24T23:31:56.717

我在尝试使用[@MichaelJohnston 的解决方案](https://stackoverflow.com/a/23582945/2865270)时遇到语法错误；这是最终对我有用的形式：

```
it "should increment the counters" do
  expect { Foo.bar }.to change { Counter.count }.by(1)
    .and change { AnotherCounter.count }.by(1)
end 
```

我应该提到我正在使用 ruby​​ 2.2.2p95 - 我不知道这个版本是否在解析中有一些细微的变化会导致我出错，看起来这个线程中的其他任何人都没有遇到这个问题。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-11-29T00:09:40.680

这应该是两个测试。[RSpec 最佳实践要求每个测试一个断言](http://betterspecs.org/#single)。

```
describe "#bar" do
  subject { lambda { Foo.bar } }

  it { should change { Counter.count }.by 1 }
  it { should change { AnotherCounter.count }.by 1 }
end 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-01-06T18:45:10.277

如果您不想使用前面建议的基于速记/上下文的方法，您也可以执行类似的操作，但请注意它将运行预期两次，因此它可能不适用于所有测试。

```
it "should increment the count" do
  expectation = expect { Foo.bar }
  expectation.to change { Counter.count }.by 1
  expectation.to change { AnotherCounter.count }.by 1
end 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-30T15:27:53.433

Georg Ladermann 的语法更好，但它不起作用。测试多个值更改的方法是组合数组中的值。否则，只有最后一个更改断言将决定测试。

这是我的做法：

```
it "should increment the counters" do
  expect { Foo.bar }.to change { [Counter.count, AnotherCounter.count] }.by([1,1])
end 
```

这与“.to”功能完美结合。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-02-22T17:49:29.167

我发现最好的方法是“手动”做：

```
counters_before         = Counter.count
another_counters_before = AnotherCounter.count
Foo.bar
expect(Counter.count).to eq (counters_before + 1)
expect(AnotherCounter.count).to eq (another_counters_before + 1) 
```

不是最优雅的解决方案，但它有效

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-06T00:59:26.450

在提出的解决方案都没有被证明确实有效之后，我通过添加一个`change_multiple`匹配器来实现这一点。这仅适用于 RSpec 3，不适用于 2.*

```
module RSpec
  module Matchers
    def change_multiple(receiver=nil, message=nil, &block)
      BuiltIn::ChangeMultiple.new(receiver, message, &block)
    end
    alias_matcher :a_block_changing_multiple,  :change_multiple
    alias_matcher :changing_multiple,          :change_multiple

    module BuiltIn
      class ChangeMultiple < Change
        private

          def initialize(receiver=nil, message=nil, &block)
            @change_details = ChangeMultipleDetails.new(receiver, message, &block)
          end
      end
      class ChangeMultipleDetails < ChangeDetails
        def actual_delta
          @actual_after = [@actual_after].flatten
          @actual_before = [@actual_before].flatten
          @actual_after.map.with_index{|v, i| v - @actual_before[i]}
        end
      end
    end
  end
end 
```

用法示例：

```
it "expects multiple changes despite hordes of cargo cultists chanting aphorisms" do
  a = "." * 4
  b = "." * 10
  times_called = 0
  expect {
    times_called += 1
    a += ".."
    b += "-----"
  }.to change_multiple{[a.length, b.length]}.by([2,5])
  expect(times_called).to eq(1)
end 
```

为 change_multiple制作`by_at_least`和`by_at_most`工作需要一些额外的工作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-11-01T22:04:32.993

我忽略了最佳实践有两个原因：

1.  我的一组测试是回归测试，我希望它们运行得快，而且它们很少中断。清楚地知道发生了什么问题的好处并不大，重构代码以使其多次运行相同事件的速度对我来说很重要。
2.  有时候我有点懒，不做那个重构更容易

我这样做的方式（当我需要这样做时）是依靠我的数据库开始为空的事实，所以我可以写：

```
foo.bar
expect(Counter.count).to eq(1)
expect(Anothercounter.count).to eq(1) 
```

在某些情况下，我的数据库不是空的，但我要么知道之前的计数，要么我可以显式地测试之前的计数：

```
counter_before = Counter.count
another_counter_before = Anothercounter.count

foo.bar

expect(Counter.count - counter_before).to eq(1)
expect(Anothercounter.count - another_counter_before).to eq(1) 
```

最后，如果你有很多对象要检查（我有时会这样做），你可以这样做：

```
before_counts = {}
[Counter, Anothercounter].each do |classname|
  before_counts[classname.name] = classname.count
end

foo.bar

[Counter, Anothercounter].each do |classname|
  expect(classname.count - before_counts[classname.name]).to be > 0
end 
```

如果您有与我类似的需求，这将起作用，我唯一的建议是睁大眼睛这样做 - 提出的其他解决方案更优雅，但在某些情况下只有几个缺点。

# google-app-engine - Google AppEngine 教程，代码片段之间的区别

> ID：13616637
> 
> 赞同：0
> 
> 时间：2012-11-29T00:04:00.540
> 
> 标签：google-app-engine

谁能告诉我这两个代码片段之间的区别：

**1.**

```
import webapp2

from google.appengine.api import users

class MainPage(webapp2.RequestHandler):
  def get(self):
    user = users.get_current_user()

    if user:
      self.response.headers['Content-Type'] = 'text/plain'
      self.response.out.write('Hello, ' + user.nickname())
    else:
      self.redirect(users.create_login_url(self.request.uri))

app = webapp2.WSGIApplication([('/', MainPage)],
                              debug=True) 
```

**2.**

```
import webapp2

from google.appengine.api import users

class MainPage(webapp2.RequestHandler):
  def get(self):
    user = users.get_current_user()

    if user:
      self.response.headers['Content-Type'] = 'text/plain'
      self.response.out.write('Hello, ' + user.nickname())
    else:
      self.redirect(users.create_login_url(self.request.uri))

app = webapp2.WSGIApplication([('/', MainPage)],
                              debug=True) 
```

问题是我正在尝试阅读 Google AppEngine 介绍材料，每当我尝试自己输入代码时，有些东西会有所不同，而且它不起作用。每当我从他们的网站上复制它时，它就可以工作，尽管它看起来相同。检查视图面板中的编码，它是相同的，ANSI（我使用的是 Notepad++）。也尝试使用缩进，但没有任何区别。

任何意见将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:08:01.607

您应该始终从以下 3 行开始您的 Pyhton 代码：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
from __future__ import unicode_literals 
```

你的编辑器应该用 utf-8 编码。不要使用 ANSI。

最后一行是可选的，但我推荐它，以避免编码问题。有几个例外。因此，如果您使用 unicode 文字，则必须更改带有标题的行：

```
import webapp2
from google.appengine.api import users

class MainPage(webapp2.RequestHandler):
    def get(self):
        user = users.get_current_user()

        if user:
            self.response.headers['Content-Type'.encode()] = 'text/plain'.encode()
            self.response.out.write('Hello, ' + user.nickname())
        else:
            self.redirect(users.create_login_url(self.request.uri))

app = webapp2.WSGIApplication([('/', MainPage)],
                          debug=True) 
```

你的 app.yaml 应该是这样的：

```
application: helloworld
version: 1
runtime: python27
api_version: 1
threadsafe: false

handlers:
- url: /.*
  script: helloworld.app

libraries:
- name: webapp2
  version: latest 
```

但是 Notepad++ 并不是一个很好的应用引擎开发环境。你需要一个好的 Python IDE。我推荐 Eclipse 和 PyDev。要进行设置，请使用此教程查看此问题：[Debug google app engine project line by line](https://stackoverflow.com/questions/13614527/debug-google-app-engine-project-line-by-line)

如果你是一个完全的新手？使用谷歌应用引擎去这个伟大的网络开发课程：[http ://www.udacity.com/overview/Course/cs253/CourseRev/apr2012](http://www.udacity.com/overview/Course/cs253/CourseRev/apr2012)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T07:30:54.113

发现一个问题，是缩进的事情。[您可以在此处](http://www.secnetix.de/olli/Python/block_indentation.hawk)和[此处](https://stackoverflow.com/questions/1024435/howto-fix-python-indentation)阅读有关此内容 的信息，无论您是使用“空格”还是“制表符”来缩进，都可能会导致问题，程序中的设置也可能会出现问题（在我的情况下，在 Sublime Text 的“制表符”设置中）缩进，可设置为 4 或 8 等）

# java - 如何获取 JTextPane 行数

> ID：13616642
> 
> 赞同：1
> 
> 时间：2012-11-29T00:04:18.817
> 
> 标签：java, swing, count, line, jtextpane

所以`JTextArea`里面`getLineCount()`有一个类似的东西`JTextPane`，因为我可以找到任何东西。也许有不同的方法来获得它？我想获取当前存在的行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:19:02.250

（如您所述）没有内置方法来查找 a 中的行数`JTextPane`- 这可能是（尽管我没有看到官方参考支持这一点）因为`JTextPane`' 能够在单个区域中保存许多不同的文本样式，这会在查找总行数时导致一些复杂性。

您可以通过跟踪显示在您内部的文本（及其样式）自行计算行数`JTextPane`- 然后您可以使用其他方法（也许`LineBreakMeasurer`（[此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/font/LineBreakMeasurer.html)的文档））来计算行数每段文字的行数，然后总结总和。

# html - 我使用哪个属性来使我的徽标与我的导航对齐？

> ID：13616643
> 
> 赞同：0
> 
> 时间：2012-11-29T00:04:26.907
> 
> 标签：html, css, header

几分钟前我问了一个相关问题，通过该问题我得到了这个更新的代码，但我不知道如何让我的徽标出现在左侧。

HTML：

```
 <header>
 <img src="/images/logo.png" height="50px" id="front" />
 <nav>
 <ul>
 <li><a href="#">Home</a></li>
 <li><a href="#">About</a></li>
 <li class="last"><a href="#">Contact</a></li>
 </ul>
 </nav>
 <div id="second_line"></div>
 </header> 
```

CSS：

```
 body {
 margin: 0;
 }
 header {
 background-color: #009000;
 height: 85px;
 position: relative;
 }
 #front {
 margin-left: 20px;
 margin-top: 20px;
 }
 nav {
 float: left;
 margin-top: 30px;
 }
 ul {
 margin: 0;
 padding: 0;
 float: left;
 }
 ul li {
 list-style-type: none;
 float: left;
 border-right: 2px solid black;
 padding-right: 5px;
 padding-left: 5px;
 }
 ul li.last {
 border-right: 0px;
 }
 #second_line {
 margin-top:10px;
 height:3px;
 background-color: #FECE2C;
 } 
```

如何解决此问题，使徽标位于左侧而不是右侧？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:08:35.737

尝试将其添加到您的样式表中：

```
header > img {float:left;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:26:29.667

您可以尝试将其调整`<nav>`为[`inline-block`](https://developer.mozilla.org/en-US/docs/CSS/display#Values)：

```
nav {
    display: inline-block;
} 
```

[例子](http://jsfiddle.net/petFT/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:10:54.907

[演示](http://jsfiddle.net/56ycJ/1/)

你只是想念添加这种风格。

```
header img{float:left;} 
```

# javascript - 将 javascript 函数应用于 html 元素

> ID：13616646
> 
> 赞同：2
> 
> 时间：2012-11-29T00:04:38.590
> 
> 标签：javascript, number-formatting

抱歉这个菜鸟问题，但我正在尝试将此 javascript 函数应用于 html 表中的数据。该函数来自[这个 Stack Overflow 帖子](https://stackoverflow.com/questions/2901102/how-to-print-number-with-commas-as-thousands-separators-in-javascript)。

```
function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
} 
```

我希望将此功能应用于以下内容：

```
<table>
    <tr>
        <td>5000</td>
        <td>5600</td>
    </tr>
</table> 
```

希望在 5,600 之后返回 5,000。我想不通这个简单的事情。我知道我需要在其中一个标签上使用 id 或类，并且这需要与函数中的某些内容相匹配，所以我尝试了

```
<table>
    <tr class="numberWithCommas">
        <td>5000</td>
        <td>5600</td>
    </tr>
</table> 
```

无济于事。鉴于赞成票的数量，我确信该功能有效。

一个善良的灵魂可以引导我完成这项工作吗？我已经用谷歌搜索了一个基本教程，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:18:46.493

您首先需要获取所有`td`s，在内容上调用函数并将结果插入到单元格中。

**HTML**

```
<table>
    <tr class="numberWithCommas">
        <td>5000</td>
        <td>5600</td>
    </tr>
</table> 
```

**Javascript**

```
function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

var elements = document.querySelectorAll('.numberWithCommas td'),
    i;

for (i in elements) {
    if (elements[i].innerHTML !== undefined) {
        elements[i].innerHTML = numberWithCommas(elements[i].innerHTML);
    }
} 
```

**[演示](http://jsfiddle.net/mvweD/4/)**

解释所有这些代码：

这是你的功能：

```
function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
} 
```

这使我们可以将`td`所有`tr`s中的所有内容`numberWithCommas`作为一个类获取，并将它们全部设置为 javascript 变量中的数组`elements`：

```
var elements = document.querySelectorAll('.numberWithCommas td'),
    i; 
```

然后我们遍历数组`td`，一次访问一个：

```
for (i in elements) {
    ...
} 
```

在 for 循环中，我们检查单元格的值是否为空：

```
if (elements[i].innerHTML !== undefined) {
    ...
} 
```

在`if`语句中，我们调用函数`numberWithCommas()`并将 的值传递给它`elements[i].innerHTML`。然后我们取回结果字符串并将其应用于`elements[i].innerHTML`：

```
elements[i].innerHTML = numberWithCommas(elements[i].innerHTML); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:14:48.217

您需要迭代`each td`并应用此功能..

```
var tr = document.getElementsByClassName('numberWithCommas');

for (var i = 0, len = tr.length; i < len; i++) {
    for(var j=0,len1 = tr[i].children.length;j<len1; j++){
        var td = tr[i].children[j];
        td.innerHTML= numberWithCommas(td.innerHTML)
    }
}​

function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}; 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/Npac8/1/)**

使用 jQuery

```
$('table tr.numberWithCommas').each(function(){
    var $tr = $(this);
    $tr.find('td').each(function(){
        var $td = $(this);
        $td.html(function(){
            return  numberWithCommas(this.innerHTML);
        });
    });        
}); 
```

**[jQuery小提琴](http://jsfiddle.net/sushanth009/uNwea/)**

# android - [UIScreen mainScreen].bounds.size.width 的 Android 等价物是什么？

> ID：13616649
> 
> 赞同：1
> 
> 时间：2012-11-29T00:04:58.353
> 
> 标签：android, ios

当我们在这里时，Android 相当于`[UIScreen mainScreen].scale`什么？

以下等式是否正确？

```
[UIScreen mainScreen].bounds.size.width = displayMetrics.widthPixels
[UIScreen mainScreen].scale = displayMetrics.density 
```

你在哪里得到`displayMetrics`这样的：

```
DisplayMetrics displayMetrics = new DisplayMetrics();
Display display = ((WindowManager) someContext.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
display.getMetrics(displayMetrics); 
```

问题是我对 iOS 与 Android 的措辞感到困惑。

这些 UIScreen 值的定义如下：

> **界限**
> 
> 包含屏幕的边界矩形，以点为单位。（只读）
> 
> **规模**
> 
> 与屏幕相关的自然比例因子。（只读）
> 
> @property(nonatomic, readonly) CGFloat scale
> 
> 讨论
> 
> 该值反映了从默认逻辑坐标空间转换到该屏幕的设备坐标空间所需的比例因子。默认逻辑坐标空间使用点进行测量，其中一个点大约等于 1/160 英寸。如果设备的屏幕具有相当相似的像素密度，则比例因子通常设置为 1.0，以便一个点映射到一个像素。但是，具有显着不同像素密度的屏幕可能会将此属性设置为更高的值。

我想知道边界的宽度是否等同于 DisplayMetrics 的 widthPixels 以及比例值是否等同于 Android 上的密度值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T00:52:06.597

```
[UIScreen mainScreen].bounds.size.width = displayMetrics.widthPixels
```

正确，屏幕（显示）的宽度（以像素为单位），这里没什么复杂的。

```
[UIScreen mainScreen].scale = displayMetrics.density
```

并不真地。它们是相似的值，但绝对不相等。

我将尝试解释是什么`scale`。我们有屏幕分辨率为 1024x768 的 iPad 1，我们有双分辨率的 iPad 3（苹果营销部门称之为 Retina），我们希望应用程序可以在这两种设备上运行。因此，应用程序在分辨率 1024x768（逻辑点）上工作，但操作系统使用比例转换为每个设备上的物理像素（iPad 1 上的比例=1.0，iPad 3 上的比例=2.0）。例如，当您在逻辑坐标 (1, 1, 20, 40) 上绘制一个矩形时，在 iPad 3 上它将绘制在像素 (2, 2, 40, 80) 上。

目前只定义了两个值：`1.0`和`2.0`。

密度是一个类似的比例因子，但计算方式不同

> 这是密度独立像素单元的比例因子，其中一个 DIP 是大约 160 dpi 屏幕上的一个像素 请注意，它再次将逻辑点（在 Android 上称为 DIP）转换为屏幕像素。

iOS规模和Android密度的区别在于逻辑单元的定义不同。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-29T00:12:27.900

我用这个：

```
 private void SetScreenSizes() {
        DisplayMetrics displaymetrics = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);
        intScreenWidth = displaymetrics.widthPixels;
} 
```

# javascript - 浏览器不断丢失javascript文件

> ID：13616653
> 
> 赞同：1
> 
> 时间：2012-11-29T00:05:24.800
> 
> 标签：javascript, jquery, browser-cache

我有一个非常奇怪的问题。我刚买了一台运行 Windows 8 的新电脑，下载了 xampp，安装了 apache 服务器，一切都很好，等等。我制作了一个链接到 JavaScript 文件和 jQuery 的基本 HTML 页面。一切都会正常工作一段时间，然后我将刷新页面，我的浏览器无法再找到 jQuery 文件（如果有帮助，我正在使用 Firefox v.17）。我将查看源代码，单击链接查看 jQuery 文件，我会收到错误消息“找不到文件”。如果我删除浏览器缓存并刷新页面一切正常，我的浏览器可以找到 jQuery。

jQuery 和我的 JS 文件都位于同一个文件夹中。我的浏览器总能找到我的 JS 文件，只是 jQuery 一直“丢失”。

我不知道为什么会发生这种情况或如何解决它。这很令人沮丧。：/

**更新** 这是我的 HTML 页面上的内容。只是基本代码。：/

```
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/scripts.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:12:53.710

互联网是否始终可用？尝试：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

# php - 如果我只使用 MySQL 数据库，PDO 真的比 MySQLi 更好吗？

> ID：13616657
> 
> 赞同：2
> 
> 时间：2012-11-29T00:06:02.677
> 
> 标签：php, pdo, mysqli

> **可能重复：**
> [mysqli 或 PDO - 优缺点是什么？](https://stackoverflow.com/questions/13569/mysqli-or-pdo-what-are-the-pros-and-cons)

我使用 MySQLi 得到了一些工作，但我到处都在阅读 PDO 是优越的，然而，到目前为止，最重要的是可以连接到其他类型的数据库，而不仅仅是 MySQL。

您知道使用 PDO 优于 MySQLi 的任何其他优势吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:09:37.400

就 mySQL 而言，它们或多或少是等价的。它主要归结为您最熟悉的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:14:17.143

本页比较了两者：

[http://net.tutsplus.com/tutorials/php/pdo-vs-mysqli-which-should-you-use/](http://net.tutsplus.com/tutorials/php/pdo-vs-mysqli-which-should-you-use/)

查看优缺点，并根据您的要求自行决定。

# php - PHP - 试图从已存储在数组中的参考号打印表格？

> ID：13616659
> 
> 赞同：0
> 
> 时间：2012-11-29T00:06:14.030
> 
> 标签：php, postgresql

嗨，我想知道你是否可以帮助我？我正在尝试通过使用存储在名为 items 的数组中的参考号并在表中显示行来从数据库中获取行，但我只能获取要在页面上显示的参考号.. .任何帮助真的很感激吗？

```
</head>
<h1>Shopping Cart</h1>

<body>

<?php $con = pg_connect("blah blah");
if (!$con){
    die('Could not connect: ' . pg_error());
}

if (isset($_POST['items'])) {
    $n = count($_POST['items']);
    for($i=0; $i < $n; $i++)
        echo $_POST['items'][$i]; 
    }

    if(!$_SESSION["selectingrows"]== 0){
        $result = pg_query ($con, "SELECT title, platform, description, price FROM CSGames     WHERE 'refnumber' = 'items[]'");

    echo "<table>
            <tr>
            <th>Title</th>
            <th>Platform</th>
            <th>Description</th>
            <th>Price</th>
            </tr>";

    while($rows = pg_fetch_result($result));{
        echo"<tr>"; echo "<td>" . $rows['title'] . "</td>"; echo "<td>" . $rows['platform'] . "</td>"; echo "<td>" . $rows['description'] . "</td>"; echo "<td>" . $rows['price'] . "</td>";
        echo"</tr>";      
    }
    echo"</table>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:14:12.837

您正在阻止您的 while 语句：

```
while($rows = pg_fetch_result($result));{ 
```

应该是：

```
while($rows = pg_fetch_result($result)){ 
```

注意分号不见了。

编辑：似乎有更多的语法错误（这是完整的）：

```
$con = pg_connect("blah blah");
if (!$con){
    die('Could not connect: ' . pg_error());
}

if (isset($_POST['items'])) {
    $n = count($_POST['items']);
    for($i=0; $i < $n; $i++){
        echo $_POST['items'][$i]; 
    }

    if(!$_SESSION["selectingrows"]== 0){
        $result = pg_query ($con, "SELECT title, platform, description, price FROM CSGames     WHERE 'refnumber' = 'items[]'");

    echo "<table>
            <tr>
            <th>Title</th>
            <th>Platform</th>
            <th>Description</th>
            <th>Price</th>
            </tr>";

    while($rows = pg_fetch_result($result));{
            echo"<tr>"; echo "<td>" . $rows['title'] . "</td>"; echo "<td>" . $rows['platform'] . "</td>"; echo "<td>" . $rows['description'] . "</td>"; echo "<td>" . $rows['price'] . "</td>";
            echo"</tr>";      
        }
        echo"</table>";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:19:40.717

我想你的问题在这里：

```
$result = pg_query ($con, "SELECT title, platform, description, price FROM CSGames     WHERE 'refnumber' = 'items[]'"); 
```

`items[]`不是任何类型的有效变量引用。您可能需要执行以下操作：

```
$items = array();
foreach ($_POST['items'] as $item) {
    $items[] = pg_escape_string($con, $item);
}

$item_string = "'" . implode("','", $items) . "'";

$result = pg_query ($con, "SELECT title, platform, description, price FROM CSGames     WHERE 'refnumber' IN ($item_string)"); 
```

注意我已经转义了发布的数据以用于查询，我已经构建了一个包含所有值的字符串，然后在 SQL`WHERE 'refnumber' IN`子句中使用了该字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:23:20.813

```
</head>
<h1>Shopping Cart</h1>

<body>

<?php $con = pg_connect("blah blah");
if (!$con){
    die('Could not connect: ' . pg_error());
}

if (isset($_POST['items'])) {
    $n = count($_POST['items']);
    $items = array();
    for($i=0; $i < $n; $i++)
        array_push($items,$_POST['items'][$i]; // stored referrral_no in array
    }
    $items = implode("','",$items); // implode to query use
    if(!$_SESSION["selectingrows"]== 0){
        $result = pg_query ($con, "SELECT title, platform, description, price FROM CSGames     WHERE 'refnumber' IN ('$items')"); // revise query to IN

    echo "<table>
            <tr>
            <th>Title</th>
            <th>Platform</th>
            <th>Description</th>
            <th>Price</th>
            </tr>";

    while($rows = pg_fetch_result($result)){
        echo"<tr>"; echo "<td>" . $rows['title'] . "</td>"; echo "<td>" . $rows['platform'] . "</td>"; echo "<td>" . $rows['description'] . "</td>"; echo "<td>" . $rows['price'] . "</td>";
        echo"</tr>";      
    }
    echo"</table>";
} 
```

试试这个我首先将你的项目再次存储在数组中，然后将其内爆以用于查询

# android - 我可以控制 Android 手机的 CPU 节流吗？

> ID：13616660
> 
> 赞同：5
> 
> 时间：2012-11-29T00:06:22.840
> 
> 标签：android, cpu-usage

我正在制作一个播放音频并执行大量 DSP 的 Android 应用程序。使用 BetterBatteryStats，我在 HTC One X 上发现，当屏幕关闭时，CPU 会降低到 384 MHz。这个速度对于我想要做的 DSP 处理来说太慢了。

有没有办法在不保持屏幕开启的情况下让 HTC One X 移动到如此慢的速度？部分唤醒锁似乎没有切断它。

# sql - 获取 2 个表之间的排除变量

> ID：13616665
> 
> 赞同：0
> 
> 时间：2012-11-29T00:07:21.083
> 
> 标签：sql, sql-server-2005, union

我有两个 sql server 2005 表，如下所示：

```
Table A
varName  varStatus
AGE      Text
AGENDA   Text
TEACH    Text

Table B
varName   varDesc
ACT       Text
AGE       Text
SAT       Text
GPA       Text 
```

我需要一两个查询来获取两个表之间不存在于两个表中的所有 varName。例如，上面的示例将使用：

```
Table A:  AGENDA, TEACH
Table B: ACT, SAT, GPA 
```

这是正确的，因为 AGE 是出现在两个表中的唯一 varname。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:06:08.450

此查询将为您提供 A 中的所有记录，但 B 中没有

```
SELECT A.* FROM 
A LEFT JOIN B ON A.varName = B.varName
WHERE B.varName IS NULL 
```

同样，此查询将为您提供 B 中的记录，而不是 A 中的记录

```
SELECT B.* FROM 
A RIGHT JOIN B ON A.varName = B.varName
WHERE A.varName IS NULL 
```

最后，您需要做的就是将两个查询联合起来

```
SELECT A.* FROM 
A LEFT JOIN B ON A.varName = B.varName
WHERE B.varName IS NULL
UNION
SELECT B.* FROM 
A RIGHT JOIN B ON A.varName = B.varName
WHERE A.varName IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T01:06:21.273

如果变量可以在单个列表中，请使用带有 NOT IN 的 UNION

```
SELECT 'A' AS sourceTable, varName
FROM   tableA
WHERE  varName NOT IN (SELECT varName FROM tableB)
UNION ALL
SELECT 'B' AS sourceTable, varName
FROM   tableB
WHERE  varName NOT IN (SELECT varName FROM tableA) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T01:19:09.200

```
(SELECT varName FROM tableA EXCEPT SELECT varName FROM tableB)
UNION
(SELECT varName FROM tableB EXCEPT SELECT varName FROM tableA) 
```

# ipad - 控制从 ipad 故事板中的视图控制器拖动到工具栏而不是自动滚动故事板

> ID：13616666
> 
> 赞同：0
> 
> 时间：2012-11-29T00:07:30.083
> 
> 标签：ipad, storyboard, drag, toolbar, viewcontroller

我刚刚看到了一个视频演示，演示了从视图控制器底部的 ipad 故事板的视图控制器图标拖动到该视图控制器内的工具栏。虽然视图控制器图标和工具栏不在屏幕上，但拖动实际上会滚动情节提要，从而使两者之间建立联系。

但是，在我的 ipad 故事板中，我无法实现自动滚动，因此无法完成控制拖动。

有没有办法在控制拖动时使情节提要滚动发生？我想暂时将工具栏移到屏幕底部以建立连接，然后将其移回。但是故事板也不会自动滚动让我这样做。我使用的是 13" macbook pro。似乎没有缩放设置可以同时在屏幕上显示。

或者，有人可以告诉我是否有其他方法可以做到这一点？我将控制拖动到代码的哪一部分？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:59:42.890

根据这一点，可以通过控制拖动到位于项目导航器和（故事板）画布之间的“文档大纲窗格”中的相应元素（在我的情况下为工具栏）的图标来完成相同的操作。

[http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/GettingStarted/GettingStarted.html](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/GettingStarted/GettingStarted.html)

这样做会绕过无法在情节提要中自动滚动的问题。

# .htaccess - URL/子域重写（htaccess）

> ID：13616669
> 
> 赞同：1
> 
> 时间：2012-11-29T00:07:38.087
> 
> 标签：.htaccess

我的应用程序动态创建子域。

如果只使用子域（没有其他路径）：`mydomain.mysite.com`

我需要子域重新映射/重写（保持相同的 URL，以便对用户隐藏）到以下 url`mydomain.mysite.com/event/mydomain`

在传递了其他参数的情况下，我想忽略重写规则。( `mydomain.mysite.com/something/else`)

我在重定向循环中遇到以下问题

```
RewriteEngine on RewriteCond %{HTTP_HOST} ^(.*)\.mysite\.com
RewriteRule ^(.*)$ http:// %1.mysite.com/events/%1 [L,NC,QSA] 
```

当我通过其他参数时，它也会重写！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T08:11:44.520

如果您有`http://`作为规则目标的一部分，那么它将自动重定向。您希望它在内部重写，因此删除`http://`和主机名。您还希望与 URI 匹配，`/`因为您希望忽略规则：

```
RewriteEngine on
# you may want this condition, to ignore "www"
RewriteCond %{HTTP_HOST} !^www\.

RewriteCond %{HTTP_HOST} ^(.*)\.mysite\.com
RewriteRule ^/?$ /events/%1 [L] 
```

添加了第一个条件以忽略以 开头的主机`www`，因此`http://www.mysite.com/`不会被重写。如果您不在乎，那么只需删除条件即可。您也不需要该`QSA`标志，因为当您的目标中没有 a 时，这是隐含的`?`。

# ruby-on-rails - 设计自定义策略需要新用户首次登录两次才能使用该应用程序

> ID：13616671
> 
> 赞同：0
> 
> 时间：2012-11-29T00:07:51.310
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authentication, login, devise

我基本上遵循[https://github.com/mattconnolly/devise-custom-strategy-demo/blob/master/lib/my_authentication.rb](https://github.com/mattconnolly/devise-custom-strategy-demo/blob/master/lib/my_authentication.rb)

一切正常，但是有一个错误，如果我是我的应用程序的新用户（当然我的用户信息已经在我们的中央身份验证服务器中），我必须第一次登录两次才能使用该应用程序

我的`authenticate!`：

```
def authenticate!

  # mapping comes from devise base class, "mapping.to" is the class of the model
  # being used for authentication, typically the class "User". This is set by using
  # the `devise` class method in that model
  klass = mapping.to

  # login credentials
  username  = params[:user][:email] # The username is the email field
  password  = params[:user][:password]

  begin
    # Here is the code to authenticate
    # Basically, we are sending the credentials to another central authentication server
    # If the authentication fails, it will throw an exception, which will be caught below to fail!

    user = klass.find_or_initialize_by_email(username)

    puts "user: #{user.inspect}"

    success! user
  rescue Exception => e
    failureMessage = "Auth error: #{e.inspect}"
    puts "#{failureMessage}"

    fail! failureMessage
  end

  # if we wanted to stop other strategies from authenticating the user
end 
```

在我的`User`模型中：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :my_authentication,
         :rememberable, :trackable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :username, :first_name, :last_name, :remember_me, :email

end 
```

如您所见，我根本没有使用`database_authenticatable`，但我们需要将一些用户信息从中央服务器保存到我们的应用程序服务器。

我猜是因为：

```
 user = klass.find_or_initialize_by_email(username)

    puts "user: #{user.inspect}"

    success! user 
```

但我不知道如何修改它，以便新用户不必登录两次即可使用该应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T00:46:47.743

我只是自己想通了。在 之前`success! user`，添加：

```
 if (user.new_record?)
      user.save
      puts "new user saved ******"
    end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-02T17:01:36.163

我最近遇到了这个问题，并通过`find_or_initialize_by_email`替换`find_or_create_by_email`.

# sql - 如何使用整数在 SQL 中将时间转换为小数

> ID：13616672
> 
> 赞同：0
> 
> 时间：2012-11-29T00:07:52.460
> 
> 标签：sql, sql-server, time, decimal

我在将时间转换为十进制时遇到了几个问题...

本质上，我使用 DATEDIFF 来识别两个日期和时间之间的小时和分钟。这会产生 5.45 的结果，但是我想得到 5.75 的结果。

```
select RTRIM(DATEDIFF(second, startdate, enddate)/3600)+'.'
+ RIGHT('0'+RTRIM((DATEDIFF(second, startdate, enddate) % 3600)/60),2)
from time 
```

我尝试了一些事情，但我认为问题在于这不是整数，这就是我无法转换分钟的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:23:05.133

以分钟为单位获取时差，然后除以 60，这将把小时放在小数点分隔符之前和分钟之后：

```
datediff(minute, startdate, enddate) / 60.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:21:53.080

```
Select DATEDIFF(second,  startdate, enddate)/3600.0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T00:17:02.060

如[this answer](https://stackoverflow.com/a/9524175/104223)中所述，“以秒为单位取DateDiff，然后除以86400.0。需要小数点。”

# input - 从 jtextfield 扫描文本以获取数组

> ID：13616674
> 
> 赞同：1
> 
> 时间：2012-11-29T00:07:58.793
> 
> 标签：input, jtextfield

我正在尝试从 jtextfield 获取输入到数组中。我正在使用这一行从字段中获取文本，但我不知道如何扫描它以查找数组。

```
double minutesIn = Double.parseDouble(minutesField.getText()); 
```

# sql - 通过 CSV 数据导入/摄取批量创建用户帐户

> ID：13616677
> 
> 赞同：4
> 
> 时间：2012-11-29T00:08:55.187
> 
> 标签：sql, web-applications, azure, ssis, bulkinsert

嗨，所有聪明的头脑，

我目前正在研究一个相当复杂的问题，我很想进行一些头脑风暴。我有一个在 Windows Azure 中运行的 C# .NET Web 应用程序，使用 SQL Azure 作为主数据存储。

每次新用户创建帐户时，他们只需要提供姓名、电子邮件和密码即可。创建帐户后，我们将核心成员数据存储到 SQL 数据库中，所有辅助操作（例如发送电子邮件、建立社交关系、创建个人资料资产等）都被推送到 Azure Queue 并在以后被提取/处理。

现在我有几个 CSV 文件，其中包含需要在系统上创建的数百个新用户（姓名和电子邮件）。我正在考虑通过分成两部分来实现自动化：

**第 1 部分：编写一个服务，获取 CSV 文件，解析姓名和电子邮件，并将此数据保存在存储 A 中**

*   该服务应该足够灵活以获取不同格式的文件
*   该服务实际上并不创建用户帐户，因此这与我们应用程序的业务逻辑层解耦
*   存储的选择不必是 SQL，也可以是非关系数据存储（例如 Azure Tables）
*   该服务可能是我们应用程序平台之外的第三方解决方案 - 因此它对所有建议开放

**第 2 部分：编写一个定期通过存储 A 并从那里创建用户帐户的进程**

*   这是在我们应用程序的“业务逻辑层”
*   每当成功创建帐户时，将存储 A 中的特定记录标记为已处理
*   如果用户帐户创建失败，这需要重试

我想知道是否有人有从文件导入批量“用户”的经验，以及我的建议是否听起来像一个不错的解决方案。

请注意，第 1 部分可能是我们应用程序平台之外的第三方解决方案，因此它必须运行的语言/平台没有限制。我们正在考虑使用[BULK INSERT](http://msdn.microsoft.com/en-us/library/ms188365.aspx)或[Microsoft SQL Server Integration Services 2008 ( SSIS）](http://msdn.microsoft.com/en-us/library/ms141026.aspx)，它将数据从 CSV 提取并加载到 SQL 数据存储中。如果有人使用过这些并且可以提供一些将不胜感激的指针.. 提前非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T05:17:18.570

如果我理解正确，您已经有一个从队列中提取消息并执行其核心逻辑来创建用户资产/等的过程。那么，听起来您应该只自动解析 CSV 文件并将内容转储到队列消息中？这听起来像是一项微不足道的任务。

您也可以通过队列消息（到不同的队列）启动处理 CSV 文件的过程。该消息将包含 CSV 文件的位置，并且在 Azure 中运行的 Worker 角色将获取它（如果通常的负载不高，它可能与处理新用户的角色相同）。

由于您正在使用队列，因此该过程是可重试的

高温高压

# c++ - 使用字符串大小来声明数组大小？

> ID：13616679
> 
> 赞同：0
> 
> 时间：2012-11-29T00:09:01.297
> 
> 标签：c++, arrays, string, size

在这里对不起初学者。我试图从 cin 函数中获取字符串大小，然后用它来声明数组大小。但它说：

> 第 17 行：请求 'x' 中的成员 'size'，它是非类类型 'std::string long int'。

不过，没有数组它也能正常工作。

```
#include <iostream>
#include <string>
using namespace std;

int main()
{
    int y;
    string x[y];
    cout << "Enter sequence" << endl;
    cin >> x[y];
    y = x.size;

    for (int i = 0; i > y; i++)
        cout x[i];

    cout << "The size of the sequence is " << x.size() << " characters." << endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:24:47.223

首先，不允许像您那样声明数组。我们来看看这两行代码

```
int y;
string x[y]; 
```

在第二行代码中， 的值是`y`多少？它可以是任何东西。当然编译器不知道，数组大小*必须*在编译时确定。

您的问题有两种解决方案：

1.  使用指针并动态分配数组。

2.  使用 std::vector 并让标准库处理动态分配。

IMO，两者都是你应该在你的程序员工具带中拥有的工具，所以你应该学习如何做到这两点。您还应该了解这两种方法的优缺点，以便选择正确的方法来解决问题。

最后，您收到的错误消息意味着数组没有名为 的成员`size()`。如果您使用上述解决方案 1\. 解决此问题，您将需要自己跟踪大小。

# html - Joomla 在我的 html 代码上添加“e”

> ID：13616680
> 
> 赞同：1
> 
> 时间：2012-11-29T00:09:04.770
> 
> 标签：html, joomla

这是我第一次使用 Joomla。我正在编辑一个网站，如果我更改模块中的代码并保存它，Joomla 会将 \" 添加到所有属性。

这是我的代码

```
<div class="container-fluid"> 
<h1 id="consumers">Per chi compra</h1> 
<div class="row-fluid"> 
<div class="span3 gk-demo-content"><img src="templates/meet_gavern/images/content/icon_tick.png" alt="Affidabile, come PayPal" title="TrustBack.me è affidabile" width="109" height="109" /> 
<h2>Affidabile. Come PayPal.</h2> 
<p>Misuriamo l'affidabilità del commercio elettronico. E quando è vero, ci permettiamo anche di dire che un merchant non è affidabile.</p> 
</div> 
```

这是 Joomla 编辑的代码：D

```
<div class="\&quot;container-fluid\&quot;">
<h1 id="\&quot;consumers\&quot;">Per chi compra</h1>
<div class="\&quot;row-fluid\&quot;">
<div class="\&quot;span3"><img src="\&quot;templates/meet_gavern/images/content/icon_tick.png\&quot;" alt="\&quot;Affidabile," title="\&quot;TrustBack.me" width="\&quot;109\&quot;" height="\&quot;109\&quot;" />
<h2>Affidabile. Come PayPal.</h2>
<p>Misuriamo l\'affidabilità del commercio elettronico. E quando è vero, ci permettiamo anche di dire che un merchant non è affidabile.</p>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:27:16.827

检查您的 php.ini 以查看您是否禁用了 Magic Quotes。如果您无权访问此文件，请通过以下方式检查 Joomla 后端：`[System] -> [System Information] -> [PHP Setting]`

如果它设置为**"on"**，请询问您的主机是否可以为您关闭它。

此外，再次在 Joomla 后端，转到：`[System] -> [Global Configuration] -> [Text Filter Settings]`并确保为超级用户将其设置为**“无过滤”**。

还请确保您运行的是最新版本的 Joomla 3.0 系列 (3.0.3)。

# java - 在 GAE 上坚持后将子实体添加到父实体

> ID：13616685
> 
> 赞同：1
> 
> 时间：2012-11-29T00:09:27.917
> 
> 标签：java, google-app-engine, jpa

我有一个父实体客户。该客户可以访问网站并创建约会。这意味着约会是在另一个时间创建的，然后是客户端对象。

我的问题是：如何将子对象添加到已经持久化的父对象中？如果调用下面示例中的函数 addData1()，则会创建一个约会表并添加一个条目。当函数 addData2() 被调用时，这不会发生。

不是这样当您在关闭实体管理器后更新持久对象时，这也会在表中更新吗？

```
@Entity
public class Client{
    @Id
    private String name;
    @OneToMany(cascade = CascadeType.ALL)
    private Set<Appointment> appointments;
}

@Entity
public class Appointment{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key id;
}

// This works
public function addData1(){
    EntityManager em = EMF.get().createEntityManager();
    Client client = new Client(name);
    for(Appointment a  : newAppointments)
        client.addAppointment(a);
    em.persist(client);
    em.close();
}

// This doesn't work.
public function addData2(){
    EntityManager em = EMF.get().createEntityManager();
    Client client = new Client(name);
    em.persist(client);
    em.close();
    for(Appointment a  : newAppointments)
        client.addAppointment(a);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T02:23:47.043

```
public function addData1(){
    EntityManager em = EMF.get().createEntityManager();
    Client client = new Client(name);
    for(Appointment a  : newAppointments)
        client.addAppointment(a);
    em.persist(client);
    em.close();
} 
```

此功能有效，因为您保留了所有对象。

```
// This doesn't work.
public function addData2(){
    EntityManager em = EMF.get().createEntityManager();
    Client client = new Client(name);
    em.persist(client);
    em.close();    <--- You persist client with no appointment
    for(Appointment a  : newAppointments)
        client.addAppointment(a);   <-- those entitys are detached entity ( not persisted)
} 
```

此功能不是因为您尝试使用分离实体来持久化对象

你应该得到这样的异常：

```
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: com.test.Appointment 
```

如果你想避免这个异常，你可以试试这个方法：

```
public void addData2(List<Appointment> newAppointments){
    Client client = new Client();
    client.setName("name1");
    entityManager.persist(client);
    for(Appointment a  : newAppointments)
        client.addAppointment(a);
    entityManager.merge(client);
    entityManager.close();
} 
```

顺便说一句，尝试使用名称作为 Id 无效

# python - python-mode 6.0.12 返回或通过后缩进

> ID：13616691
> 
> 赞同：1
> 
> 时间：2012-11-29T00:09:51.197
> 
> 标签：python, emacs, mode

我在 emacs 中使用 python 模式。我已经使用了 1 个月，没有任何问题。

现在我有一个问题，每当我在类中“返回”或“传递”一个函数时，缩进就会返回到下一行的开头

例如

```
class test(object):
    def method1(self):
        return 1
|cursor returns here, cant press tab to indent
    |cursor should be here, tab should allow free indentation 
```

如果我不返回或“通过”，我没有问题。我不知道这是什么原因造成的。

我的 .emacs：

```
(add-to-list 'load-path "~/.emacs.d/")
(require 'lambda-mode)
(add-hook 'python-mode-hook #'lambda-mode 1)
(setq lambda-symbol (string (make-char 'greek-iso8859-7 107)))

(add-to-list 'load-path "~/.emacs.d/python-mode.el-6.0.12") 
(setq py-install-directory "~/.emacs.d/python-mode.el-6.0.12")
(require 'python-mode)
(custom-set-variables
  ;; custom-set-variables was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 '(inhibit-startup-screen t))
(custom-set-faces
  ;; custom-set-faces was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 ) 
```

我的 .emacs.d 包含： lambda-mode.el python-mode.el-6.0.12 auto-save-list

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T04:15:07.573

`python-mode`在来自 Emacs的默认设置中（即`python.el`相对于`python-mode.el`），我无法重现您的问题。所以也许你正在使用`python-mode.el`并且可以简单地切换到内置`python-mode`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T07:26:58.697

无法用主干重现。如果可能，请检查一下。

bzr 分支 lp:python 模式

在 github 上也存在一个镜像。

错误最好提交在

[https://bugs.launchpad.net/python-mode](https://bugs.launchpad.net/python-mode)

# android - 用异步任务“安排”我的程序？

> ID：13616693
> 
> 赞同：0
> 
> 时间：2012-11-29T00:10:08.967
> 
> 标签：android

我正在尝试在 gridView 中显示图像。这些图像来自对 ElasticSearch 服务器的研究。用户在文本字段中输入关键字，在 ElasticSearch 上的查询结果是字符串列表（图像的 url），图像显示在 gridView 中。

当我按下按钮进行研究时的动作：

```
public void sendMessage(View view){

    imgAdapter.clearmThumbIds();  //mThumbs is a list of string (urls image)

    gridView = (GridView) findViewById(R.id.grid_view);
    EditText editText = (EditText) findViewById(R.id.searchBar);
    String message = editText.getText().toString();          
    try {
        eSearchElastic.ESE(imgAdapter,message);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    System.out.println("Etape 2");
    gridView.setAdapter(imgAdapter);

} 
```

eSearchElastic.java

```
public static void ESE (final ImageAdapter imgAdapter,final String keyword)throws ClientProtocolException, IOException {

AsyncTask<Void, Void, Void> task = new AsyncTask<Void, Void, Void>(){
    @Override
    protected Void doInBackground(Void... params) {

        //Build the query, connect to ElasticServer and receive a list or urls of image as answer
         System.out.println("Etape 1");
        return null;
    }

};
task.execute();} 
```

在 Etape1 之前打印 Etape2 的结果，我希望这一行“gridView.setAdapter(imgAdapter)”仅在 eSearchElastic 的后台进程/线程完成后执行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:14:38.080

Just call `gridView.setAdapter(imgAdapter);` in the [onPostExecute()](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29) method inside your `AsyncTask` instead of calling it from `sendMessage()`. That is guaranteed to be called only after the `doInBackground()` method finishes, and will be called on the main thread, so it's safe to touch the UI.

eg:

```
public static void ESE (final GridView gridView, final ImageAdapter imgAdapter, final String keyword) throws ClientProtocolException, IOException {

    AsyncTask<Void, Void, Void> task = new AsyncTask<Void, Void, Void>(){
        @Override
        protected Void doInBackground(Void... params) {
            // Build the query, connect to ElasticServer and receive a list or urls of image as answer
            System.out.println("Etape 1");
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);
            gridView.setAdapter(imgAdapter);
        }
    };
    task.execute();
} 
```

# .net - 响应客户端请求时，在 Mono 下运行的 WCF 服务器间歇性崩溃

> ID：13616701
> 
> 赞同：2
> 
> 时间：2012-11-29T00:11:22.643
> 
> 标签：.net, wcf, mono

在 Mono 3.0 下的 Gentoo Linux (2.6.32-gentoo-r7) 和 Windows 7 上的 WCF 客户端上运行 WCF 服务器时，我遇到了相当间歇性的错误。

**在客户端，我得到以下异常：**

```
System.ServiceModel.CommunicationException: An error occurred while receiving the HTTP response to {myendpoint}. 
This could be due to the service endpoint binding not using the HTTP protocol. 
This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). 
See server logs for more details. 
---> System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a receive. 
---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.
---> System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host     
  at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
  at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
--- End of inner exception stack trace ---
  at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
  at System.Net.PooledStream.Read(Byte[] buffer, Int32 offset, Int32 size)
  at System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead)
--- End of inner exception stack trace ---
  at System.Net.HttpWebRequest.GetResponse()
  at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
--- End of inner exception stack trace ---
Server stack trace:
  at System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
  at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
  at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
  at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
  at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
  at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
  at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
  at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
Exception rethrown at [0]:
  at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
  at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
  at {the WCF method call}.... 
```

**在服务器端，我得到以下信息：**

```
OnUnhandledException:Fatal Error: Read failure 
  InnerException:  interrupted
  at System.Net.Sockets.NetworkStream.Read (System.Byte[] buffer, Int32 offset, Int32 size) [0x00000] in <filename unknown>:0
  at System.Net.RequestStream.Read (System.Byte[] buffer, Int32 offset, Int32 count) [0x00000] in <filename unknown>:0
  at System.IO.StreamReader.ReadBuffer () [0x00000] in <filename unknown>:0
  at System.IO.StreamReader.Read (System.Char[] buffer, Int32 index, Int32 count) [0x00000] in <filename unknown>:0
  at Mono.Xml2.XmlTextReader.ReadTextReader (Int32 remained) [0x00000] in <filename unknown>:0
  at Mono.Xml2.XmlTextReader.PeekChar () [0x00000] in <filename unknown>:0
  at Mono.Xml2.XmlTextReader.ReadContent () [0x00000] in <filename unknown>:0
  at Mono.Xml2.XmlTextReader.Read () [0x00000] in <filename unknown>:0
  at System.Xml.XmlTextReader.Read () [0x00000] in <filename unknown>:0
  at System.Xml.XmlSimpleDictionaryReader.Read () [0x00000] in <filename unknown>:0
  at System.Xml.XmlReader.MoveToContent () [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.XmlReaderMessage.ReadEnvelopeStart () [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.XmlReaderMessage..ctor (System.ServiceModel.Channels.MessageVersion version, System.Xml.XmlDictionaryReader reader, Int32 maxSizeOfHeaders) [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.Message.CreateMessage (System.Xml.XmlDictionaryReader envelopeReader, Int32 maxSizeOfHeaders, System.ServiceModel.Channels.MessageVersion version) [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.TextMessageEncoder.ReadMessage (System.IO.Stream stream, Int32 maxSizeOfHeaders, System.String contentType) [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.Http.HttpReplyChannel.CreatePostMessage (System.ServiceModel.Channels.Http.HttpContextInfo ctxi) [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.Http.HttpReplyChannel.TryReceiveRequest (TimeSpan timeout, System.ServiceModel.Channels.RequestContext& context) [0x00000] in <filename unknown>:0
  at System.ServiceModel.Channels.ReplyChannelBase.<BeginTryReceiveRequest>m__10 (TimeSpan tout, System.ServiceModel.Channels.RequestContext& ctx) [0x00000] in <filename unknown>:0 
```

在我看来，客户端尝试进行 WCF 方法调用，但服务器在读取请求的过程中出现了致命的读取错误。正如我猜想在这种情况下所期望的那样，客户端使用*CommunicationExpection*断言。但我不知道是什么导致了服务端的问题，如果有什么我可以做的，因为它发生在一个线程上，我不相信我有任何控制权。任何有关我如何分类此问题的线索将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:18:03.780

我要做的第一件事是在你的服务器上抛出wireshark，这样你就可以捕获导致它失败的原始请求。

收到请求后，您应该能够在调试时使用 SoapUi 或 Fiddler 重播它。

仅仅能够看到错误的请求可能会很明显问题是什么。

注意无效的 XML、过多的数据、超时等。

# android - 建议在 Android 项目中的哪个位置放置启动代码？

> ID：13616708
> 
> 赞同：0
> 
> 时间：2012-11-29T00:11:45.280
> 
> 标签：android

我想设置一些系统属性，比如这个问题：[Java 级 DNS 缓存的目的是什么？](https://stackoverflow.com/questions/6488587/what-is-the-purpose-of-java-level-dns-caching)

你会把`System.setProperty`代码放在哪里？

# visual-studio - 如何使用 Visual Studio 2012 制作和部署自签名 ClickOnce 清单

> ID：13616709
> 
> 赞同：9
> 
> 时间：2012-11-29T00:12:09.873
> 
> 标签：visual-studio, certificate, clickonce, self-signed

让我们解决这个问题......我：

*   使用 Visual Studio 2012

*   开发[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)应用程序 - 主要是 .NET 框架 3.5，一些是 2.0。

*   使用 Windows 7 进行开发（用户也在使用 Windows 7。内部用户数量很少（少于 40）。

我还要声明我是新手，并不完全理解这个过程。我**确实**了解加密/散列/密钥等的基本概念，但我无法告诉您为什么您可能需要`.cer`文件而不是`.pfx`文件。

接着...

我们有一个应用程序使用证书来签署它的清单，该清单已经工作了三年（左右）。我们最近从 Visual Studio 2008 升级到 Visual Studio 2012，基本上跳过了 Visual Studio 2010。在该过程中的某个地方，证书现在无效或损坏。

`makecert.exe`建议的解决方案：用“就像我们上次一样”制作一个新的。当我们只需要我们自己的一小部分用户和看不到“你信任这个发布者吗？”的小便利时，为证书付费是没有意义的。消息（我认为？）。

尝试发布时，确切的错误是：

> 无法发布，因为项目未能构建。
> 
> 签名时出错：无法签署 bin\Release\app.publish\setup.exe。SignTool 错误：签名者的证书对签名无效。SignTool 错误：尝试签名时出错：bin\Release\app.publish\setup.exe

现在，*[使用 .NET Framework 2.0 在您的应用程序中支持证书一](http://msdn.microsoft.com/en-us/magazine/cc163454.aspx?ppud=4#S1)*文说：

> 对于桌面应用程序，您通常在用户存储中安装证书。

因此，当我查看用户存储（通过带有证书管理单元的[MMC](http://en.wikipedia.org/wiki/Microsoft_Management_Console)）时，我看到：

![在此处输入图像描述](../Images/5bd4db0e5de63278d91c3845270957ce.png)

红线所在的地方是 OLD/INVALID 证书。另外一个还没有过期，上面有我的用户名（2013-06-20）。

当我从商店中选择时，我看到了这个：

![在此处输入图像描述](../Images/fc5f67f5b6937a84e7c99422cab66d3f.png)

![在此处输入图像描述](../Images/1dfd3f5b54ebb4f648c71ae816ce44f8.png)

如果您好奇，另一个直观的放置其中之一的位置如下所示：

![在此处输入图像描述](../Images/020ff7836277e49684367b64c5e820c4.png)

那么如何在旧/坏的地方添加另一个呢？

这是我尝试过的：

按照[这些说明](http://msdn.microsoft.com/en-us/library/ms733813.aspx)，我执行了

```
makecert -n "CN=TempCA" -r -sv TempCA.pvk TempCA.cer 
```

现在我有一个`.pvk`文件和一个`.cer`文件。然后我按照*[Pvk2Pfx (Windows Drivers)](http://msdn.microsoft.com/en-us/library/windows/hardware/ff550672%28v=vs.85%29.aspx)*中的说明运行

```
pvk2pfx.exe -pvk TempCA.pvk -spc TempCA.cer -pfx TempCA.pfx 
```

现在我有一个`.pfx`文件...（这是我需要的吗？），但是当尝试使用 MMC 导入证书存储时，我使用的密码无论如何都应该是错误的 - 即使我复制并粘贴它。（这听起来像是导入程序中的一个错误......我可以重现这个。）

尝试另一种方法，导入`.cer`文件后，它不会出现在Visual Studio的“从商店中选择”窗口中，所以没用。

我为此花了一天时间，准备放弃，但我不能。我需要做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T19:38:30.257

文章*[Using Makecert to Create Certificates for Development](http://www.digitallycreated.net/Blog/38/using-makecert-to-create-certificates-for-development)*帮助了大约 90% 的工作...

剩下的就是理解我可以做两件事之一（这两个选项都要求证书必须位于“受信任的根”区域，如“受信任的根证书颁发机构”，或者必须由那里的一个签名）：

1.  在 Visual Studio 中，在“签名”选项卡下，我可以使用“从文件中选择”并使用该`.cer`文件。
2.  如果我只是将我的`.cer`文件放在“个人”文件夹中，它将作为“从商店选择”按钮中的一个选项出现（我可能需要重新启动计算机或 Visual Studio）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-12T13:06:11.890

Watki02 的回答很有帮助，但缺少一些细节。此外，该博客文章中的关键信息也应在此处发布。所以...

1.  创建您自己的根授权证书：

    CD \path\to\whereyouwant

    makecert -n "CN=Make Up A Name" -a sha1 -r -sv MakeUpANameCertificateAuthority.pvk MakeUpANameCertificateAuthority.cer -ss MakeUpANameCertificateAuthority -sr localMachine

2.  密码提示 系统将提示您创建密码，然后提交密码。我对两个提示都使用了相同的密码

3.  用户证书

    makecert -pe -n "CN=CN=Make Up A Name User" -ss MY -a sha1 -iv MakeUpANameCertificateAuthority.pvk -ic MakeUpANameCertificateAuthority.cer -sv MakeUpAName.pvk MakeUpAName.cer

4.  再次提示密码 我再次使用了与上面相同的密码

制作可移植文件以供交换

```
pvk2pfx -pvk "MakeUpAName.pvk" -spc "MakeUpAName.cer" -pfx "MakeUpAName.pfx" -pi SamePasswordAgain 
```

5.  将文件发送给您的私人客户

    “MakeUpAName.pfx”

6.  安装证书

c:>MMC.EXE

菜单文件 -> 添加/删除管理单元

证书 -> 添加 -> 计算机帐户 -> 完成 -> 确定

菜单操作->所有任务->导入

通过向导

选择 *.pfx 格式

选择文件

继续使用默认选项

# c# - 从应用配置文件中获取 EntityConnection 字符串

> ID：13616711
> 
> 赞同：0
> 
> 时间：2012-11-29T00:12:19.820
> 
> 标签：c#, .net, sql-server, entity-framework, connection-string

一些快速的问题：

所以我有这个`LogInWindow`对话框，用于收集所有 SQL 登录信息，然后将构造的连接字符串传递给`ServiceManager.InitializeContext()`方法，该方法使用特定的提供程序连接初始化我的实体上下文。

一切正常。但我想`LogInWindow`用 App.config 配置文件中定义的值初始化对话框。

是否有进行此初始设置的首选方法？即，我是否应该`EntityContext`仅出于获取默认提供程序连接的纯粹目的而使用默认构造函数来实例化一个虚拟对象？有没有“更清洁”的方式？

顺便说一句，您认为在事件`Form.Close()`处理程序中执行这种类型的调用是一种“安全”的做法吗？`Form.Shown`我在 MSDN 上读到，不建议`Form.Close()`在处理程序内部调用`Form.Load`事件。

```
public partial class MainWindow : Form {

    private void MainWindow_Shown(object sender, EventArgs e) {
        using (var logInWindow = new LogInWindow()) {
            if (logInWindow.ShowDialog(this) == DialogResult.OK) {
                this.serviceManager.InitializeContext(logInWindow.ConnectionString);
            } else {
                this.Close();
            }
        }
    }
}

public sealed class ServiceManager : IDisposable {

    public void InitializeContext(string connectionString) {
        if (this.EntityContext != null)
            throw new InvalidOperationException("EntityContext cannot be initialized multiple times.");

        var entityConnectionString = new EntityConnectionStringBuilder();
        entityConnectionString.ProviderConnectionString = connectionString;
        entityConnectionString.Provider = "System.Data.SqlClient";
        entityConnectionString.Metadata = "res://*/EntityModel.EntityModel.csdl|res://*/EntityModel.EntityModel.ssdl|res://*/EntityModel.EntityModel.msl";

        this.EntityContext = new EntityContext(entityConnectionString.ConnectionString);
        this.EntityContext.ObjectMaterialized += EntityContext_ObjectMaterialized;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:36:15.033

您可以使用 System.Configuration 类访问 App.config 的所有部分

例子：

```
var connectString = ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;

var stringBuilder = new SqlConnectionStringBuilder(connectString);

string UserID = stringBuilder.UserID;
string Password = stringBuilder.Password;
string catalog = stringBuilder.InitialCatalog; 
```

应用程序配置

```
<configuration>
   <connectionStrings>
     <add name="MyConnectionString" connectionString="metadata=res://*/...........
   </connectionStrings>
</configuration> 
```

# objective-c - 打算在视图之间共享 ios 中的信息

> ID：13616714
> 
> 赞同：2
> 
> 时间：2012-11-29T00:12:52.507
> 
> 标签：objective-c, ios, ios5

我只是一个一般的理论问题，我希望能产生一些回应。我一直在学习 ios，并且有一个我正在修补的视图的项目。它有一个运行循环来管理一个连接到服务器的套接字并在它进入时获取聊天。一个文本视图会更新为新的聊天。现在这个文本视图附加到故事板一。我现在要问，当我添加它时，他们是否会去故事板二（我现在正在阅读这个多页方面），视图中的聊天是否会继续更新，尽管用户当然不会看到它直到他们返回视野。第二个问题是我可以在第一个视图控制器中同时更新故事板 2 和一个。我看到你可以在我的 segue 书中将变量传递给故事板 2，但是我的位于视图控制器一中的套接字运行循环可以访问视图控制器的两个变量吗？如果不是，听起来我需要调查某种队列来将更新从 telnet 传送到故事板 2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:28:01.133

你从一个相当复杂的项目开始——印象深刻。这里有一些关于故事板和 segues 的快速说明。

*   如果您使用视图控制器设置情节提要，然后将 segue 设置到另一个视图控制器 - 当您创建新的视图控制器时，原始视图控制器仍在内存中，如果您以这种方式编程，仍然可以响应通知或回调。

    *   当您“弹出”或“关闭”您继续使用的视图控制器时，它会从内存中消失。

    *   当你进行 segue 时，你会自动在一个名为`prepareForSeque`. 您可以将此引用存储在一个属性中，并根据需要使用该属性对其进行更新。

所以这是一个伪示例：

*   视图控制器 a 有一些网络代码，我猜当缓冲区被填满时，它会调用视图控制器 a 中的方法。我们称它为 networkMethod 作为参考。在网络方法的一侧，假设您最终得到一个字符串，并且您想将该字符串传递给您的视图控制器 b，以便您可以在那里做一些事情。因此，我们将把它传递给一个方法，而不是仅仅设置一个变量，这样你就可以用它做一些事情了。希望该场景符合您的需求，否则我的示例的其余部分将脱离基础。

任务 - 为视图控制器 b 设置参考。在视图控制器的导入部分中有一个 .h 文件

```
#import "ViewControllerB.h"  //this is the name of your view controller b class 
```

在界面部分（.h 文件）中的视图控制器 a 中添加：

```
@property (nonatomic, strong) ViewControllerB *viewB; 
```

在你的 .m 文件中，你会触发你 segue - 也许在一个按钮或一些动作上。听起来你已经有了这个：

```
[self performSegueWithIdentifier:@"viewB" sender:self]; 
```

现在创建一个如下所示的新方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    self.viewB = segue.destinationViewController;  //this stores a reference for later 
```

}

现在在您的回调方法中，您可以像这样引用视图控制器 b：

```
-(void)networkCallbackMethod:(NSString*)stringData {

    if (self.viewB) {

     [self.viewB myCustomMethodUsingPassedData:stringData];

    }

} 
```

然后最后在视图控制器 b 中，您将拥有如下匹配方法：

```
-(void)myCustomeMethodUsingPassedData:(NSString*)stringData {
     //update the view here
} 
```

这应该大致为您提供一个框架，您可以在其中设置两个视图控制器，segue 并获取引用，然后根据需要更新新的视图控制器。

希望有帮助。祝你好运。

# android - 将 json 发送到 web 服务，接收 null。- 安卓

> ID：13616716
> 
> 赞同：3
> 
> 时间：2012-11-29T00:12:53.593
> 
> 标签：android, json, web-services

我是新手。从服务器读取 json 的 Web 服务可以工作，但是当我在 Android 中通过 json 创建新记录时，它会发送，但我收到 null。

**代码**：

```
HttpPost post = new HttpPost("http://192.168.42.194/app/web/app.php/android/buscar");
post.setHeader("content-type", "application/json;charset=UTF-8");
try {
    JSONStringer dato = new JSONStringer().object().key("cadena").value("valor").endObject();
    StringEntity entidad = new StringEntity(dato.toString());
    post.setEntity(entidad);
    HttpClient cliente = new DefaultHttpClient();
    HttpResponse respuesta = cliente.execute(post);
    String obtiene = EntityUtils.toString(respuesta.getEntity());
    JSONObject object2 = new JSONObject(obtiene);
    String mensaje = object2.getString("cod");
    Log.e("LOG", mensaje.toString());
    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context);
    alertDialogBuilder.setTitle("Your Title");
    alertDialogBuilder.setMessage("Enviado "+ mensaje);
    AlertDialog alertDialog = alertDialogBuilder.create();
    alertDialog.show();
} catch (Exception ex) {
    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context);
    alertDialogBuilder.setTitle("Error");
    alertDialogBuilder.setMessage("Enviar " + query.getText());
    AlertDialog alertDialog = alertDialogBuilder.create();
    alertDialog.show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T15:22:47.990

尝试在 StringEntity 上设置标题而不是帖子本身，JSON 默认为 UTF-8，因此不需要

```
HttpClient cliente = new DefaultHttpClient();
JSONObject dato = new JSONObject();
try {
    HttpPost post = new HttpPost("http://192.168.42.194/app/web/app.php/android/buscar");
    dato.put("cadena", "valor");
    StringEntity entidad = new StringEntity(dato.toString());  
    entidad.setContentType(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
    post.setEntity(entidad);
    HttpResponse respuesta = cliente.execute(post);
} catch (Exception ex) {
    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context);
    alertDialogBuilder.setTitle("Error");
    alertDialogBuilder.setMessage("Enviar " + query.getText());
    AlertDialog alertDialog = alertDialogBuilder.create();
    alertDialog.show();
} 
```

# javascript - 为什么这些文件的文件名有随机字符串？

> ID：13616718
> 
> 赞同：1
> 
> 时间：2012-11-29T00:12:57.260
> 
> 标签：javascript, css, filenames

我遇到过这样的 CSS 和 JS 文件名的网站：

```
css_pbm0lsQQJ7A7WCCIMgxLho6mI_kBNgznNUWmTWcnfoE.css 
```

是什么原因造成的，或者你为什么要这样做？

编辑：下面的每个答案中的一些可能适用于这种情况，但鉴于我发现的网站，服务/缓存方法似乎是最准确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T00:16:33.137

版本控制并确保提供正确版本的静态资源。如果您有一个高流量的网站并且为大量用户提供服务，那么您将拥有几层缓存：CDN、缓存文件头等。

有时很难使具有相同文件名的缓存无效。服务器可能会传递正确的标头，但客户端可能会忽略它们并仍然加载缓存版本。提供不同的文件名可以防止这种情况发生，并确保您拥有正确版本的 css/js 和其他静态资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:19:09.680

正如你可能知道的那样，没有人想出这个名字。

通常它是将多个 CSS 文件合并到一个文件中的结果。这样做是出于性能原因（请求一个文件比请求两个文件快。）

该名称很可能是输入（即[哈希](http://en.wikipedia.org/wiki/Cryptographic_hash_function)）的确定性算法的结果，因此如果您再次执行组合但没有更改 CSS，则输出将被赋予相同的名称。

当内容（CSS）改变时，输出文件的名称也会改变。这很有用，因为它使浏览器无法缓存旧版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T00:15:48.537

看起来文件是在服务器端生成的，用于缩小。

您正在访问的网站可能有多个 CSS 文件（可能与`@import`语句组合）和 JS 文件（jQuery、jQuery UI、jQuery 插件、一些自定义代码等） - 而不是让开发人员手动压缩和组合服务器文件可能会为他们做这件事（例如，ASP.NET 4.5 就是这样做的）。在这种情况下，它使用任意（随机？基于 GUID？）文件名来确保它不会与任何内容冲突。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T00:15:16.167

它可能是网站使用的技术。

即，如果您使用 gwt（它是在 javscript 中编译的一些 java）或其他预处理某些代码并输出 javascript 的东西，您可能会得到奇怪的文件名。

# asp.net-mvc - MVC DoddleReports 404 未找到

> ID：13616720
> 
> 赞同：2
> 
> 时间：2012-11-29T00:13:18.813
> 
> 标签：asp.net-mvc

我最近和大约一个小时前一样，尝试在我的 MVC 应用程序中实现 DoddleReports 功能。

非常肯定我按照文档到了 T。但是，当我输入我的 URL 时，它给了我一个 404 未找到。我通过 NuGet 安装了这些包，我只需要 Excel，所以我添加了 OpenXML（以及依赖项）。

我的控制器：

```
using System;
using System.Data;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using VAGTC.Models;
using VAGTC.ViewModels;
using VAGTC.Helpers;
using DoddleReport.Web;
using DoddleReport;

namespace VAGTC.Controllers
{

    public class reportsController : Controller
    {
        //
        // GET: /Excel/
        VAGTCEntities db = new VAGTCEntities();
        public ActionResult Index()
        {
            return View();
        }

        public ReportResult OrganizationReport()
        {
            var matrix = from d in db.Organizations
                         select d;
            var report = new Report(matrix.ToReportSource());

            return new ReportResult(report);
        }
    }
} 
```

路由器配置：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Routing;
using DoddleReport.Web;

    namespace VAGTC
    {
    public class RouteConfig
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.MapReportingRoute();
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Account", action = "Login", id = UrlParameter.Optional }
            );
        }
    }
} 
```

当我使用 NuGet 安装 Doddle 时，它​​还会自动输入 web.config 中所需的内容（而不是 View 文件夹中的 web.config！）。[我在使用 MVC 配置Doddle](http://doddlereport.codeplex.com/wikipage?title=Configuration)的文档中阅读了一条评论，并替换了代码。（但它也不适用于自动生成的代码）。我还没有喜欢定制任何东西，因为我只是想让它首先工作！

那么，404 页面是怎么出现的呢？这让我觉得它与路由有关，但我不确定具体是什么。

任何帮助是极大的赞赏！

我在调试模式下使用它 - 所以也许这可能是一个原因？这是我正在使用的链接：

编辑* 上传到我的网站，仍然给出 404。

```
http://localhost:2530/reports/OrganizationReport.xls 
```

编辑 2* 在搞砸之后，根据@fiorebat 给出的论坛帖子改变了几件事。我在它生成报告后立即对其进行了调试，`var report = new Report(matrix.ToReportSource());`一旦它返回报告就会给出这个错误。

```
No Source Available
There is no source code available for the current location.

Call stack location:
DoddleReport.dll!DoddleReport.ReportBuilder.ToReportSource(System.Collections.IEnumerable source) Line 12

Source file information:
Locating source for 'c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs'. Checksum: MD5 {61 dc e5 8e 25 79 c2 94 c4 27 5b d0 d7 92 56 ae}
The file 'c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs' does not exist.
Looking in script documents for 'c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs'...
Looking in the projects for 'c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs'.
The file was not found in a project.
Looking in directory 'C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\crt\src\'...
Looking in directory 'C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\crt\src\vccorlib\'...
Looking in directory 'C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\atlmfc\src\mfc\'...
Looking in directory 'C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\atlmfc\src\atl\'...
Looking in directory 'C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\atlmfc\include'...
Looking in directory 'C:\'...
The debug source files settings for the active solution indicate that the debugger will not ask the user to find the file: c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs.
The debugger could not locate the source file 'c:\Users\Matt\Development\Projects\DoddleReport\src\DoddleReport\ReportBuilder.cs'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:52:04.587

您需要在 web config 中的 system.webServer 下添加此配置：

```
<modules runAllManagedModulesForAllRequests="true" ></modules> 
```

我有同样的问题，报告没有扩展工作，我用“RouteDebuggin”调试路由并且它正在工作。似乎 DoodleReport 插件没有调用正确的操作。

[http://doddlereport.codeplex.com/discussions/348486](http://doddlereport.codeplex.com/discussions/348486)

# html - 在 100% div 中居中列表

> ID：13616737
> 
> 赞同：0
> 
> 时间：2012-11-29T00:14:36.283
> 
> 标签：html, css

我现在正在处理响应式代码，由于某种原因，我无法在 div 的中心显示 2 个列表，移动视图的宽度为 100%。下面的css代码中是否有一些我遗漏的东西可能导致它不能居中显示？

两个列表都有 .social-media 和 .top-nav 类

***********HTML******* *** ** **********

 *****```
 <div id="gezzamondo">

 <div class="header">

 <img class="logo" src="images/gezzamondo-logo.jpg" alt="Web designer Glasgow | Gezzamondo" title="Web designer Glasgow | Gezzamondo"  />

 <ul class="top-nav">
 <li><a href="#">About</a></li>
 <li><a href="#">Work</a></li>
 <li><a href="#">Contact</a></li>
 </ul>

 <ul class="social-media">
 <li><img src="images/twitter-social.jpg" alt="Gezzamondo on Twitter" title-"Gezzamondo on Twitter"/></li>
 <li><img src="images/behance-social.jpg" alt="Gezzamondo on Behance" title="Gezzamondo on Behance"/></li>
 <li class="last"><img src="images/dribbble-social.jpg" alt="Gezzamondo on Dribbble" title="Gezzamondo on Dribbble"/></li>
 </ul>

 </div><!-- close header -->
 </div><!-- close gezzamondo --> 
```

**********CSS****************

 *****```
 body {
background-color:#C09;
font-family: 'Ubuntu', sans-serif;
margin:0;
padding:0;
 }

 img{
max-width:100%:
 }

 #gezzamondo{
width:100%;
margin:0 auto;
 }

 .header{
background-color:#FFF;
height:215px;
width:100%;
text-align:center;
 }

 #gezzamondo .logo{
width:183px;
height:83px;
margin:0 auto;
margin-top:20px;
 }

 #gezzamondo .top-nav{
list-style: none;
font-size:20px;
font-weight:300;
margin:0 auto;

 }

 #gezzamondo ul.top-nav li{
float:left;
margin-right:30px;
 }

 #gezzamondo ul.top-nav li a{
text-decoration:none;
color:#333333;
 }

 #gezzamondo .social-media{
position: absolute;
list-style: none;
width:162px;
margin:0 auto;
background-color:#06F;
 }

 #gezzamondo .social-media li img{
height:44px;
width:44px;
 }

 #gezzamondo .social-media li{
float:left;
margin-right:15px;
 }

 #gezzamondo .social-media li.last{
float:left;
margin-right:0px;
 }

 #gezzamondo ul.top-nav li a:hover{
border-bottom:7px #FF0099 solid;
color:#333333;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:40:36.920

您在#gezzamondo .social-media 中将位置设置为绝对，只需删除该位置，它应该居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:36:33.147

我使用了您提供的代码，在 jsfiddle 中看起来很乱（示例代码不完整等）。我认为这应该为你做，或者至少让你[更接近](http://jsfiddle.net/aWmss/3/)。我所做的基本上是将社交 ul 包装在两个 div 中。center-social 跨越整个宽度，而 center-s 尝试提供宽度的概念，以便 uls 可以居中。在您的实际页面上尝试一下，它应该可以正确显示。示例中仅应用于社交 ul。

```
<div id="center-social">
   <div id="center-s"> 
 <ul class="social-media">
 <li><img src="images/twitter-social.jpg" alt="Gezzamondo on Twitter" title-"Gezzamondo on Twitter"/></li>
 <li><img src="images/behance-social.jpg" alt="Gezzamondo on Behance" title="Gezzamondo on Behance"/></li>
 <li class="last"><img src="images/dribbble-social.jpg" alt="Gezzamondo on Dribbble" title="Gezzamondo on Dribbble"/></li>
 </ul>
     </div>
    </div> 
```**********

# html - CSS 调整大小：两种纵横比

> ID：13616739
> 
> 赞同：2
> 
> 时间：2012-11-29T00:14:39.443
> 
> 标签：html, css, resize, aspect-ratio

我正在尝试`div`使用 CSS`resize`属性在标签上保持 1:1 的纵横比。有可能这样做吗？

[这个例子](http://jsfiddle.net/kFmY8/106/)没有纵横比。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:45:56.717

您可以将其设为“resize:horizo​​ntal”，然后使用 javascript 以另一种方式调整大小：

标记：

```
<div id="elementID" style="width:200px;height:200px;background:#000;resize:horizontal;overflow:hidden;"></div> 
```

​ js：

```
jQuery('#elementID').mousemove(
    function(e){
        var elem = jQuery(e.target);
        elem.height(elem.width());        
    }
)​ 
```

[http://jsfiddle.net/valentinas/kFmY8/121/](http://jsfiddle.net/valentinas/kFmY8/121/)

问题是您需要以某种方式检查元素何时更改。AFAIK 调整元素大小时不会触发任何事件，因此您必须检查间隔以获得可靠的结果。我的示例观察到 mousemove，但这并不可靠，因为您实际上可以在调整大小时将鼠标移出元素。

# odata - 将 Breeze 与 OData 结合使用

> ID：13616741
> 
> 赞同：3
> 
> 时间：2012-11-29T00:14:53.397
> 
> 标签：odata, breeze

> 我将如何对仅使用服务器的元数据来定义模型的 odata 服务使用微风？上下文是否仍然能够处理对非 Web api 服务的 crud 操作？
> 
> 我见过
> 
> ```
> // service name is route to the Web API controller
> var serviceName = 'api/CarBones';
> 
> /*** dataservice proper ***/
> 
> // manager (aka context) is the service gateway and cache holder
> var manager = new entityModel.EntityManager(serviceName); 
> ```
> 
> 我可以做一些事情，比如用 oData uri 替换 serviceName，然后像往常一样继续使用微风吗？
> 
> ```
> var serviceName = "http://localhost:1234/Northwind.svc" 
> ```
> 
> 谢谢你的帮助！

这个问题由 jpirok 在我们的 IdeaBlade 论坛上发布。我在这里重新发布问题和答案，因为我认为它对 Breeze Stack Overflow 社区很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:14:53.397

当然，要切换到使用 OData 服务，只需使用正确的适配器初始化 Breeze。对于 OData，这看起来像：

```
breeze.config.initializeAdapterInstance("dataService", "OData"); 
```

确保在创建第一个 EntityManager 之前进行此调用，并记住使用 OData uri 作为服务名称。

这提供了完整的 OData 查询支持。尽管 OData 保存在近期路线图中，但尚未实施。如果您确实需要 OData 保存功能，您可能需要在我们的 Breeze 用户语音[https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions)上投票。在决定下一步该做什么时，我们会认真对待该场所。

# java - 如何为 Android 应用创建/使用在线用户数据库？

> ID：13616744
> 
> 赞同：0
> 
> 时间：2012-11-29T00:14:58.227
> 
> 标签：java, android, database, eclipse

我想在线创建一个用户数据库，以便人们可以通过 android 应用程序创建帐户并登录。这怎么可能实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:19:48.050

您的 android 应用程序无法直接连接到数据库。您需要创建一个服务器端服务层，作为 Android 应用程序和数据库之间的 API。例如，如果您想获取所有用户的列表，您的应用将发出 HTTP GET 请求

`http://example.com/api/users`

此脚本将查询数据库以获取所有用户的列表，并使用编码为 XML、JSON 或任何其他可消费格式的数据响应应用程序。

# ruby-on-rails - Rails form_tag帖子不起作用

> ID：13616747
> 
> 赞同：0
> 
> 时间：2012-11-29T00:15:30.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3, post

我的 users_controller 有这些方法

```
 def follow_code
    @user = current_user
  end

  def followsubmit
    redirect_to root_path
  end 
```

我的路线文件有

```
 match "follow_code" => "users#follow_code", :as => "follow_code"
  match "follow_code" => 'users#followsubmit', :as => "follow_code", :via => 'post' 
```

我的 follow_code.html.erb 视图有

```
<%= form_tag(follow_code_path, :method => 'post') do %>
    <%= submit_tag("Submit") %>
<% end %> 
```

然而由于某种原因，当我在我的视图上单击提交时，我从未被重定向到我的 root_path，而是重新渲染了 follow_code 视图。

我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:35:39.520

我也很好奇这个。我今天遇到了它，也使用了 match，我的解决方案是重命名 post 操作：

```
 match "follow_code" => "users#follow_code", :as => "follow_code"
 match "save_follow_code" => 'users#followsubmit', :as => "save_follow_code", :via => 'post' 
```

但是，我使用条件属性来指定方法。在您的情况下，您可能只需要将第一个指定为获取。

```
match "follow_code" => "users#follow_code", :as => "follow_code", :via => 'get'
match "follow_code" => 'users#followsubmit', :as => "follow_code", :via => 'post' 
```

# php - PHP：使用环境变量作为对局部常量的引用

> ID：13616753
> 
> 赞同：5
> 
> 时间：2012-11-29T00:16:43.263
> 
> 标签：php

我的代码：

```
const T = 'test';
const B = 'boat';

$const_var = getenv('FOO'); 
```

在我的 VirtualHost 部分，我有：

```
SetEnv FOO T 
```

显然 $const_var 评估为 character `T`。

我想要做的是能够通过使用环境变量的值作为参考来使用本地 const T 的值。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T00:18:15.367

您可以使用该[`constant()`](http://php.net/constant)函数间接解析该值。

```
 print constant($_ENV["FOO"]); 
```

或者在你的情况下`$const_var`作为参数。

# boost - 在 CentOS 上安装 Thrift：找不到 Boost 1.40 或更高版本

> ID：13616762
> 
> 赞同：3
> 
> 时间：2012-11-29T00:17:40.767
> 
> 标签：boost, centos, thrift

尝试安装 Thrift 时，我无法摆脱此错误：

```
 ./configure
    ...
    checking for boostlib >= 1.40.0... configure: WARNING: We could not detect the boost libraries (version 1.40 or higher). If you have a staged boost library (still not installed) please specify $BOOST_ROOT in your environment and do not give a PATH to --with-boost option.  If you are sure you have boost installed, then check your version number looking in <boost/version.hpp>. See http://randspringer.de/boost for more documentation. 
```

我正在使用 CentOS。[根据CentOS 上](http://thrift.apache.org/docs/install/centos/)的 Thrift文档，我已经完成了

```
sudo yum install automake libtool flex bison pkgconfig gcc-c++ boost-devel libevent-devel zlib-devel python-devel ruby-devel 
```

我试过用`--with-boost`没用。

我也做过：

```
[]# yum install boost141
Setting up Install Process
Package boost141-1.41.0-2.el5.x86_64 already installed and latest version
Nothing to do
[]# yum install boost141-devel
Setting up Install Process
Package boost141-devel-1.41.0-2.el5.x86_64 already installed and latest version
Package boost141-devel-1.41.0-2.el5.i386 already installed and latest version
Nothing to do 
```

所以现在我有：

```
[root@domU-12-31-39-18-3D-20 include]# find / -name boost
/usr/local/bin/boost
/usr/include/boost141/boost
/usr/include/boost 
```

通过各种谷歌搜索，我发现有这个错误的人说，“哦，这是 gcc-c++，我没有安装那个，”但据我所知，我已经安装了 gcc-c++：

```
[root@domU-12-31-39-18-3D-20 boost]# yum install gcc-c++
rightscale-epel                                                                                                                                                                                                   |  951 B     00:00     
Setting up Install Process
Package gcc-c++-4.1.2-46.el5_4.2.x86_64 already installed and latest version
Nothing to do 
```

有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-18T14:51:31.407

这是一个老问题，但我最近在使用 Cent 5.10 机器和构建 Thrift 时遇到了同样的问题

修复 boost141 的包含文件，构建将起作用。

```
ln -s /usr/include/boost141/boost /usr/include/boost 
```

# html - 如何修复 Internet Explorer 中背景图像故障的上边距。在其他方面很好

> ID：13616763
> 
> 赞同：0
> 
> 时间：2012-11-29T00:17:58.790
> 
> 标签：html, iframe, formatting

背景图像垂直关闭。

它在其他浏览器中看起来完全没问题。

顺便说一下，这是一个 iframe 显示。

这是我在表格正文中使用的代码：

```
<table width="647" height="875" border="0" cellpadding="0" table style="background-image:url(images/main_window.png); background-repeat:no-repeat; background-position:center; position:relative; top:0px; left:0px" align=center> 
```

有趣的是我的“商店”部分的代码完全相同，但它在 IE 中显示得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:31:17.390

我用 IE 看​​不到它，但我用 chrome 看到它，这很奇怪。但是我认为您的主机服务器已关闭，因为我开始找不到 404 页面..（或者您将 iframe src 关闭了..）

你为什么不尝试不同的方法？对所有浏览器都统一的东西，否则你会一直误解源代码，除非你花足够的时间为不同的浏览器编写条件 css。可能是一些 JS 和一些包装 div 会更容易处理，或者至少更好看。只是提议:)

干杯!

# django - 带有索引 False 的 django haystack SearchField

> ID：13616766
> 
> 赞同：6
> 
> 时间：2012-11-29T00:18:06.773
> 
> 标签：django, indexing, search-engine, django-haystack

是否有任何理由使用`indexed=False`into设置其他字段`SearchIndex`？

文档提到应该为过滤或排序结果定义额外的字段。默认情况下`SearchIndex`有`indexed=True`，那么如果我设置会发生什么`indexed=False`？

数据是否仍会存储在索引中但不会被索引？如果我设置会发生什么`stored=False`？

它是如何工作的？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T02:56:56.053

默认情况下，Haystack 中的所有字段都被索引（可由引擎搜索）和存储（由引擎保留并显示在结果中）。通过使用存储字段，您可以存储常用数据，这样您在处理搜索结果时就无需访问数据库以获取更多信息。如果您指定`indexed=True`and ，您将获得此优势`stored=True`。

如果您仅指定`indexed=True`，则在处理搜索结果以获取索引中不可用的其他信息时，您将访问数据库。

的目的`indexed=False`是满足您希望渲染字段在索引过程中遵循预渲染模板的情况。这里说明了一个很好的例子 - [https://django-haystack.readthedocs.org/en/latest/searchindex_api.html#stored-indexed-fields](https://django-haystack.readthedocs.org/en/latest/searchindex_api.html#stored-indexed-fields)

# linux - 我如何将多个目录展平并覆盖到一个目录中？

> ID：13616769
> 
> 赞同：2
> 
> 时间：2012-11-29T00:18:23.923
> 
> 标签：linux, bash, shell, unix, directory

我想获取目录层次结构列表并将它们展平到一个目录中。列表后面的任何重复文件都将替换较早的文件。例如...

```
foo/This/That.pm
bar/This/That.pm
bar/Some/Module.pm
wiff/This/That.pm
wiff/A/Thing/Here.pm 
```

这将结束

```
This/That.pm      # from wiff/
Some/Module.pm    # from bar/
A/Thing/Here.pm   # from wiff/ 
```

我有一个可能过于复杂的 Perl 程序来执行此操作。我对 SO 用户可能解决它的聪明方法很感兴趣。最大的障碍是“在必要时创建中间目录”，可能会使用基本名称和目录名称的某种组合。

我要解决的真正问题是检查两个已安装的 Perl 库之间的差异。我首先将每个 Perl 的多个库目录扁平化为一个目录，模拟 Perl 如何搜索模块。我可以然后`diff -r`他们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T11:58:57.600

如果您不介意条目的最终顺序，我想这可以完成这项工作：

```
#!/bin/bash

declare -A directory;

while read line; do
    directory["${line#*/}"]=${line%%/*}
done < $1

for entry in ${!directory[@]}; do
    printf "%s\t# from %s/\n" $entry ${directory[$entry]}
done 
```

输出：

```
$ ./script.sh files.txt
A/Thing/Here.pm # from wiff/
This/That.pm    # from wiff/
Some/Module.pm  # from bar/ 
```

如果您需要移动文件，那么您可以简单地将打印步骤替换为`mv`-- 或`cp`-- ，如下所示：

```
for entry in ${!directory[@]}; do
    mv "${directory[$entry]}/$entry" "your_dir_path/$entry"
done 
```

# node.js - Node.js “致命错误：JS 分配失败 - 进程内存不足” - 可以获得堆栈跟踪吗？

> ID：13616770
> 
> 赞同：62
> 
> 时间：2012-11-29T00:18:26.993
> 
> 标签：node.js

嗯...我回到第一方。我这辈子都想不通。

我收到以下错误：

```
FATAL ERROR: JS Allocation failed - process out of memory 
```

我可以列举几十个（是的，几十个）我试图找到这个问题的根源的事情，但真的太多了。所以这里是关键点：

*   我只能在我的生产服务器上让它发生，而且我的应用程序又大又复杂，所以很难隔离
*   即使堆大小和 RSS 大小都 < 200 Mb，也会发生这种情况，考虑到机器（Amazon Cloud、CentOS、m1.large）具有 8Gb RAM，这应该不是问题

**我的假设是**（由于第二点）泄漏可能不是原因；相反，似乎可能有一个非常大的 SINGLE 对象。以下线程支持这一理论：：[在 Node.js 中使用 JSON.stringify 会导致“进程内存不足”错误](https://stackoverflow.com/questions/11189940/in-node-js-using-json-stringify-results-in-process-out-of-memory-error)

我真正需要的是某种方法来找出应用程序崩溃时内存的状态，或者可能是导致致命错误的堆栈跟踪。

根据我上面的假设，10 分钟前的堆转储是不够的（因为对象不会驻留在内存中）。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-30T05:39:56.090

仅仅因为这是目前谷歌上的最佳答案，我想我会为我刚刚遇到的一个案例添加一个解决方案：

我在使用带有 ejs 模板的 express 时遇到了这个问题 - 问题是我未能关闭 ejs 块，并且文件是 js 代码 - 如下所示：

```
var url = '<%=getUrl("/some/url")'
/* lots more javascript that ejs tries to parse in memory apparently */ 
```

这显然是一个超级具体的案例，大部分时间都应该使用 OP 的解决方案。但是，OP 的解决方案对此不起作用（ejs 堆栈跟踪不会由 浮出水面`ofe`）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-03T18:26:47.360

我必须在这个问题上向[Trevor Norris 提供巨大的支持，以帮助修改 node.js 本身](https://github.com/trevnorris)，以便在发生此错误时自动生成堆转储。

不过，最终为我解决了这个问题的方法要平凡得多。我编写了一些简单的代码，将每个传入 API 请求的端点附加到日志文件中。我等待收集约 10 个数据点（崩溃）并比较崩溃前 60 秒运行的端点。我发现在 9/10 案例中，只有一个端点在崩溃前被击中。

从那里开始，只需深入挖掘代码即可。我削减了所有内容——从我的 mongoDB 查询中返回更少的数据，只将必要的数据从对象传递回回调等等。现在我们已经比平均时间长了 6 倍，没有任何服务器上发生过一次崩溃，这让我*希望*它得到解决......现在。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-06-05T08:15:33.853

**这个问题没有单一的解决方案。**
我阅读了不同的案例，其中大多数与 JS 相关，但在我的案例中，例如，只是一个损坏的玉模板循环，由于代码错误而无限。

我猜这只是节点管理不善的语法错误。
检查您的代码或发布它以查找问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-07-14T09:09:52.707

就我而言，我通过 cap production deploy (capistrano) 部署 Rails 4.2.1，并且在收到的资产预编译期间：

rake 标准输出：rake 中止！ExecJS::RuntimeError: FATAL ERROR: Evacuation Allocation failed - process out of memory (execjs):1

我之前通过 active_admin 运行了十几个数据导入，它似乎已经用完了所有 RAM

**解决方案：** 服务器重新启动并首次运行部署......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-29T19:15:25.707

这可能是您正在序列化的对象的递归问题，它刚开始就很大，并且在递归成为问题之前内存不足？

出于这个原因，我创建了[安全克隆深度](https://www.npmjs.org/package/safe-clone-deep)npm 模块......基本上你会想要执行以下操作。

```
var clone = require('safe-clone-deep');
...
   return JSON.stringify(clone(originalObject)); 
```

这将允许您克隆几乎任何将安全序列化的对象。此外，如果其中一个对象继承自`Error`它将序列化继承`name`的`message`和`stack`属性，因为这些通常不会序列化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-25T19:59:52.653

在我们的例子中，我们不小心分配了一个巨大的（稀疏）数组，导致 util.format 崩溃：

[http://grahamrhay.wordpress.com/2014/02/24/fatal-error-js-allocation-failed-process-out-of-memory/](http://grahamrhay.wordpress.com/2014/02/24/fatal-error-js-allocation-failed-process-out-of-memory/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-12T11:11:12.423

在我的例子中，我使用 [] 初始化了一个关联数组（对象）。一旦我将其初始化为 {}，问题就消失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-07T12:42:26.020

就我而言，我在开发过程中用来播种数据库的文件导致了泄漏。由于某种原因，节点不喜欢我在文件末尾的多行注释。我看不出它有什么问题，但消除过程意味着我知道这是该文件的这一部分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-09-07T03:00:19.060

分析多个案例，最常见的问题是死循环。这在复杂的应用程序中很难解决，这就是测试驱动开发派上用场的地方！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-19T11:03:48.803

分享这里发生的事情：

我因这个问题失去了几天，直到我发现在某个文件中我从一个静态文件导入一个类，一个构建的文件。它使构建过程永无止境。就像是：

```
import PropTypes from "../static/build/prop-types"; 
```

修复到真实来源解决了所有问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-29T17:03:22.657

在 AWS 实例上使用 npm 5.0.3，我们在 npm 全局文件夹本身上遇到了权限问题，这可能导致我们发生这种情况。我们跑了：`sudo chown -R $(whoami) $(npm config get prefix)/{lib/node_modules,bin,share}` 现在它工作正常

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-08-31T03:18:30.237

我花了几天时间才找到问题的根本原因。仅在 AWS EC2 实例中的 webpack 构建期间开始出现“JS - 进程内存不足”错误。不过，在我的本地系统中构建是成功的。
原因是以下代码：
上一个：
`import { ShoppingCartOutlined } from "@material-ui/icons/ShoppingCartOutlined";`
它被修复：
`import ShoppingCartOutlined from "@material-ui/icons/ShoppingCartOutlined";`

它可能会帮助使用 material-ui/icons 的人并最终出现此错误。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-06-13T08:18:36.493

我有同样的问题。所以我尝试了这个： node --max-old-space-size=4096 index.js 这行得通。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-01T06:38:34.033

在使用`npm i`.

```
FATAL ERROR: Committing semi space failed. Allocation failed - process out of memory
 1: node::Abort() [npm]
 2: 0x556f73a6e011 [npm]
 3: v8::Utils::ReportOOMFailure(char const*, bool) [npm]
 4: v8::internal::V8::FatalProcessOutOfMemory(char const*, bool) [npm]
 5: v8::internal::Heap::PerformGarbageCollection(v8::internal::GarbageCollector, v8::GCCallbackFlags) [npm]
 6: v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [npm]
 7: v8::internal::Heap::CollectAllGarbage(int, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [npm]
 8: v8::internal::StackGuard::HandleInterrupts() [npm]
 9: v8::internal::Runtime_StackGuard(int, v8::internal::Object**, v8::internal::Isolate*) [npm]
10: 0x159539b040bd
Aborted 
```

我的解决方案是添加额外的标志

```
node --max-old-space-size=250 `which npm` i 
```

希望它可以为某人节省时间

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-02T09:57:02.873

可能是节点版本的问题。在运行反应应用程序时，我经常遇到同样的问题。我在使用节点版本 14.7.2 时遇到了这个问题。尝试了很多解决方案，例如增加堆内存、清除缓存、重新安装节点模块。它都没有解决问题。最后，将 Node 版本降级到 10.24.1，这停止了错误消息。

# pdo - PDO 登录脚本不起作用

> ID：13616771
> 
> 赞同：-1
> 
> 时间：2012-11-29T00:18:29.770
> 
> 标签：pdo

我将此登录脚本更改为 PDO。现在它通过了用户名，但卡住了 fetchAll 行。我需要帮助。谢谢

```
<?php 
session_start();
include_once"includes/config.php";

if (isset($_POST['admin_login'])) {
  $admin_user = trim($_POST['admin_user']);
  $admin_pw = trim($_POST['admin_pw']);

  if ($admin_user == NULL OR $admin_pw == NULL) {
    $final_report.="Please complete all the fields below..";
  } else {
    $check_user_data = $db->prepare("SELECT * FROM `admin` 
      WHERE `admin_user`='$admin_user'");
    $check_user_data->execute();

    if ($check_user_data->fetchColumn() == 0) {
      $final_report.="This admin username does not exist..";
    } else {
      $get_user_data = $check_user_data->fetchAll($check_user_data);

      if ($get_user_data['admin_pw'] == $admin_pw) {
        $start_idsess = $_SESSION['admin_user'] = "".$get_user_data['admin_user']."";
        $start_passsess = $_SESSION['admin_pw'] = "".$get_user_data['admin_pw']."";
        $final_report.="You are about to be logged in, please wait a few moments...";
        header('Location: admin.php');
      }
    }
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:25:43.870

*   不检查返回值 prepare() 或 execute() `false`。您需要检查 SQL 错误并处理它们，停止代码而不是继续愉快地继续。

*   未在准备好的语句中使用查询参数，仍然不安全地将 $_POST 内容插入到查询中。您错过了切换到 PDO 的好处，并使自己容易受到 SQL 注入攻击。

*   您以明文形式存储密码，这是不安全的。请参阅[您可能错误地存储了密码](http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html)。

*   `SELECT *`如果您只使用 admin_pw 列，您真的需要吗？提示：没有。

*   [PDOStatement::fetchAll()](http://php.net/manual/en/pdostatement.fetchall.php)返回一个数组数组，而不仅仅是一行的一个数组。阅读 fetchAll() 文档中的示例。

# neo4j - 如何获取 Neo4J 中某个节点下游的所有节点/边缘的计数

> ID：13616772
> 
> 赞同：1
> 
> 时间：2012-11-29T00:18:34.980
> 
> 标签：neo4j, cypher

我想知道，在 Cypher 中是否有办法计算某个节点 x 下游的所有节点。

对于我的特定用例，我有许多图表，它们是单独的实体，但存储在同一个实例中。我想知道，对于每个图，节点和关系计数是多少。

我已经有了这个关系 start r=rel( *) return count(* )

这对于节点 start n=node( *) return count(* )

对于数据库中的所有内容。

非常感谢，

埃蒙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T07:52:29.157

如果每个子图有一些“参考”或根节点，则可以使用路径表达式来查找所有节点：

```
start root=node:roots(id="xx")
match root-[*..5]->end
return count(distinct end) 
```

限制搜索的深度是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:15:40.227

您必须索引节点/rels 中的所有属性。然后，您必须从这些索引开始获取计数，如果有必要，将每个图形的它们加在一起。假设我们有 2 个图表，书籍作者类型和汽车颜色类型。然后得到 cypher 中每个图的节点总和：

```
start g1=node:node_auto_index('bookName:*'), g11=node:node_auto_index('authorName:*'),
      g2=node:node_auto_index('carName:*'), g22=node:node_auto_index('carColor:*')
return count(g1)+count(g11) as graph1, count(g2)+count(g22) as graph2 
```

所有关系都相似。我不知道任何可以简单地按未定义属性分组的密码解决方案 - 可以轻松解决问题。

# git - 如何使用 git 在 codeigniter 中处理 index.php 的不同实例

> ID：13616776
> 
> 赞同：0
> 
> 时间：2012-11-29T00:18:48.597
> 
> 标签：git, codeigniter

我有一个使用 codeigniter 作为框架的 git 存储库。主要的 index.php 与开发不同，因为它设置了一个环境变量（“生产”或“开发”。

告诉 git 忽略这两种不同环境中的变化的最佳方法是什么？我不一定要将它添加到 .gitignore 因为它是一个重要文件。有没有办法简单地抑制变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:34:21.807

你可以只修改文件而不提交它，但这很烦人。还有一些复杂的方法可以利用多个分支和变基。但这也变得非常混乱。

我找到的最简单的解决方案是在您的生产环境中使用污迹过滤器。有关详细信息，请参阅[git book](http://git-scm.com/book/ch7-2.html#Keyword-Expansion)。您可以在结帐时使用涂抹过滤器将某个单词替换为其他单词。

在我的设置中，我使用此过滤器（您可以将其添加到服务器上的 .git/config 文件中）：

```
[filter "htproduction"]
    smudge = sed 's/\\$site-mode\\$/$site-mode:production$/'
    clean = sed 's/\\$site-mode.*\\$/$site-mode$/' 
```

要激活此过滤器，请将此行添加到 .git/info/attributes （如果该文件不存在，则创建该文件）：

```
index.php filter=htproduction 
```

这样做的效果是，所有出现的都在您的服务器上`$site-mode$`替换为。`$site-mode:production$`现在在你的 index.php 文件中做这样的事情：

```
if (strpos("$site-mode$", "production") !== false)){
    do_only_on_server();
} 
```

强烈建议您阅读[smudge filters](http://git-scm.com/book/ch7-2.html#Keyword-Expansion)，了解发生了什么以及我为什么不这样做`if ("$site-mode$" == "$site-mode:production$")`（这不起作用）。

*注意：*此答案假设您在服务器上运行 linux。此方法也适用于 Windows，但`sed`可能不可用。

# c# - C# 中 KeyDown() 的简单但棘手的问题

> ID：13616783
> 
> 赞同：5
> 
> 时间：2012-11-29T00:19:11.983
> 
> 标签：c#, events

我正在用精灵做一个小游戏，角色根据按下的键（箭头）移动。我注意到该`.KeyDown()`方法一直被调用，直到释放*任何*键。

例如，当用户按下向上箭头时，方法`.KeyDown()`不断被调用。如果按下向下箭头，仍然按下向上箭头，则`KeyEventArgs`现在接收来自向下箭头的输入。最后，当释放向上箭头时，*即使*仍然按下向下箭头，`.KeyDown()`事件也会停止调用。

 *如何“重置”输入并告诉编译器继续调用`.KeyDown()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:26:22.027

一个很好的问题-我不相信有任何方法可以覆盖此默认行为，但是通过自己跟踪按键肯定可以避免这种影响-即，当`.KeyDown()`被调用时，将键添加到某种类型跟踪它的结构，然后，当`.KeyUp()`被调用时，从该结构中删除密钥。

然后，只需反复检查当前按下的键的结构，并以此为基础移动*，*而不是`.KeyDown()`告诉你什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:26:15.647

您可以尝试使用`KeyUp`以检测密钥何时释放。然后您可以假设该键仍然被按下，直到`KeyUp`被调用。*

# .htaccess - 创建一个简单的重定向规则到 Joomla 站点

> ID：13616784
> 
> 赞同：0
> 
> 时间：2012-11-29T00:19:30.720
> 
> 标签：.htaccess, redirect, joomla

我如何为joomla的“重定向管理器”或.htaccess文件创建一个新的重定向规则，它可以将客人从“something/item/13269248”之类的东西重定向到“somethingelse/item/13269248”但那里有任何ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:43:09.427

htaccess

```
Redirect something/item/13269248 somethingelse/item/13269248 
```

如果您遇到任何问题，请告诉我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:57:14.367

我找到了答案，你可以这样做：

```
RewriteRule ^something/item/(.*) /somethingelse/item/$1 [R=301,L,QSA] 
```

# wordpress - URL 重定向无法正常工作：生成 url http://domain.com/domain.com/

> ID：13616785
> 
> 赞同：1
> 
> 时间：2012-11-29T00:19:34.547
> 
> 标签：wordpress, redirect, multilingual

我有一个使用两种语言（希伯来语和英语）的 WordPress 网站，我需要它根据浏览器语言进行重定向。我正在使用 qTranslate 插件来创建两种语言的内容。这个插件也有一个重定向功能，但它只为主页创建一个重定向，我需要对内部页面和主页进行重定向。

另一位开发人员为我编写了这段代码来创建重定向，但由于某种原因，它创建了一个有趣的重定向。它仅在将语言切换为希伯来语时发生，然后离开站点并尝试直接进入`http://domain.com/en/`并将您重定向到`http://domain.com/domain.com/`（切换到英语时不会发生）。

我尝试使用为希伯来语创建重定向的“标题（位置：）”，但无法弄清楚如何使其工作 - 我尝试使用完整路径而不是相对路径，或删除和之间的“/ `$_SERVER['SERVER_NAME']`”`$_SERVER['REQUEST_URI']`但得到递归 url 或带有双“/”的 url（`http://domain.com//`也适用于内部页面`http://domain.com//page`）。

网址结构为：

*   domain.com/ 用于希伯来语
*   domain.com/en/ 英文版

并且在切换语言时，将添加参数 $lang=en 或 $lang=he。

希望这是有道理的，非常感谢！

这是负责重定向的代码：

```
<?php
if (!isset($_COOKIE["uln"])) : 
$lang = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'], 0, 2);
setcookie('uln', $lang, time()+86400*365, '/', '.domain.com'); // cookie stored for a year
$_COOKIE['uln'] = $lang;
endif;

//if lang=(value) is not empty 

if(isset($_GET['lang'])) {
$lang = $_GET['lang'];

 setcookie('uln', $lang, time()-1, '/', '.domain.com');  //this unsets the cookie for random language selection

 //set the cookie "uln" again with the selected language.
 setcookie('uln', $lang, time()+86400*365, '/', '.domain.com'); // cookie stored for a year 
 $_COOKIE['uln'] = $lang;
}

        if(($_COOKIE["uln"]) == "en") {
        $matched = strncmp("/en/", $_SERVER['REDIRECT_URL'], 3);                               
        if ($matched !== 0) :       
        header('Location: /en'.$_SERVER['REQUEST_URI']);        
        endif;
   } elseif(($_COOKIE["uln"]) == "he") {
        $matched = strncmp("/en/", $_SERVER['REDIRECT_URL'], 3);                               
        if ($matched === 0) :       
        header('Location: '.$_SERVER['SERVER_NAME'].'/'.$_SERVER['REQUEST_URI']);       
        endif;
   } 

 ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:24:38.497

代替

```
 header('Location: '.$_SERVER['SERVER_NAME'].'/'.$_SERVER['REQUEST_URI']); 
```

尝试

```
 header("Location: http://{$_SERVER['SERVER_NAME']}{$_SERVER['REQUEST_URI']}"); 
```

URL，尤其是 Location 标头中的 URL，应包含协议和域名。我相信 Location 标头中的相对 URL 违反了 HTTP RFC。

通过省略协议，您无意中指定了相对 URL 而不是绝对 URL。

编辑： REQUEST_URI 已经以 a 为前缀，`/`因此在 concat 中包含一个是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:29:13.050

您错过了`http://`某个地方，可能是在英语 -> 希伯来语重定向代码中。

改变

```
header('Location: '.$_SERVER['SERVER_NAME'].'/'.$_SERVER['REQUEST_URI']); 
```

至

```
header('Location: http://'.$_SERVER['SERVER_NAME'].'/'.$_SERVER['REQUEST_URI']); 
```

# c++ - 为什么 free() 没有释放我的 Arduino Uno 上的 RAM

> ID：13616790
> 
> 赞同：4
> 
> 时间：2012-11-29T00:20:08.980
> 
> 标签：c++, memory, memory-management, arduino

我试图通过在与 free() 函数一起使用后删除一个变量来释放 RAM，但我的 RAM 没有清理。我想没有垃圾清理发生？在我退出代码段（作用域 if 语句、while 循环或函数）后，空间会被清理，但 free() 语句本身不会。

我正在执行以下操作来检查 RAM：

```
int freeRam () {
  extern int __heap_start, *__brkval; 
  int v; 
  return (int) &v - (__brkval == 0 ? (int) &__heap_start : (int) __brkval); 
} 
```

此外，如何“释放”这样的内存？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T00:23:24.140

您不能仅仅因为调用了单个内存块而期望`__brkval`减少。`free()`内存块将被*标记*为空闲并可供重用，但通常`__brkval`只会根据程序在任何时候使用的*最大内存量向一个方向移动。*

# asp.net-mvc-4 - MVC 4 EF5 数据库首先在部分类中设置默认值

> ID：13616791
> 
> 赞同：1
> 
> 时间：2012-11-29T00:20:11.530
> 
> 标签：asp.net-mvc-4, entity-framework-5, ef-database-first

我是 MVC 的新手，并试图弄清楚如何为部分类设置默认值。我已经搜索了 2 天，但什么也没有工作。[这](https://stackoverflow.com/questions/12691854/setting-default-value-in-entity-framework-database-first)是一个假定的解决方案，但它对我不起作用。我还尝试了 [DefaultValue(10)] 数据注释。

这是从 edmx 文件创建的自动生成的部分类

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace OTIS.Models.Admin
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;

    public partial class Company
    {
        public Company()
        {
            this.Facilities = new HashSet<Facility>();
        }

        public int CompanyID { get; set; }

        [Required]
        [Display(Name = "Company Name")]
        public string CompanyName { get; set; }

        public string Address1 { get; set; }
        public string Address2 { get; set; }
        public string City { get; set; }
        public string State { get; set; }
        public string PostalCode { get; set; }
        public decimal ItemMargin { get; set; }
        public decimal ServicesMargin { get; set; }
        public decimal InvoiceTimeIncrement { get; set; }
        public decimal CashDiscountPct { get; set; }
        public decimal BaseServiceHourlyRate { get; set; }
        public decimal HourlyPremiumRush { get; set; }
        public decimal HourlyPremiumLate { get; set; }
        public decimal HourlyPremiumCustomerMaterial { get; set; }
        public int CreatedByID { get; set; }
        public System.DateTime CreatedOn { get; set; }
        public int ModifiedBy { get; set; }
        public System.DateTime ModifiedOn { get; set; }

        public virtual UserProfile UserProfile { get; set; }
        public virtual UserProfile UserProfile1 { get; set; }
        public virtual ICollection<Facility> Facilities { get; set; }
    }
} 
```

这是我为添加注释而创建的部分类。

```
namespace OTIS.Models.Admin
{
    [MetadataType(typeof(CompanyMD))]
    public partial class Company
    {

        //public Company()
        //{
        //    //private System.DateTime _currentDateTime = DateTime.Now;
        //    ////Set Default Values
        //    //CreatedByID = (int)Membership.GetUser().ProviderUserKey;
        //    //CreatedOn = _currentDateTime;
        //    //ModifiedBy = (int)Membership.GetUser().ProviderUserKey;
        //    //ModifiedOn = _currentDateTime;
        //}

        public string FullAddress
        {
            get
            {
                return this.City + ", " + this.State + " " + this.PostalCode;
            }
        }

        public class CompanyMD
        {
            private System.DateTime _currentDateTime = DateTime.Now;
            private int _currentUser = (int)Membership.GetUser().ProviderUserKey;

            [Display(Name = "Company ID")]
            public int CompanyID { get; set; }

            [Required]
            [Display(Name = "Company Name")]
            public string CompanyName { get; set; }

            [Display(Name = "Address")]
            public string Address1 { get; set; }

            [Display(Name = "Address 2")]
            public string Address2 { get; set; }

            public string City { get; set; }
            public string State { get; set; }

            [Display(Name = "Zip")]
            public string PostalCode { get; set; }

            [Display(Name = "Address")]
            public string FullAddress { get; set; }

            [Display(Name = "Material Margin")]
            public decimal ItemMargin { get; set; }

            [Display(Name = "Overtime Margin")]
            public decimal ServicesMargin { get; set; }

            [Display(Name = "Invoice Hour Increment")]
            public decimal InvoiceTimeIncrement { get; set; }

            private decimal _cashDiscountPct;

            [Display(Name = "Cash Discount %")]
            [DisplayFormat(DataFormatString = "{0:P2}")]
            public decimal CashDiscountPct
            {
                get { return _cashDiscountPct; }
                set { _cashDiscountPct = value/100; }
            }

            [Display(Name = "Base Hourly Rate ($/Hr)")]
            [DataType(DataType.Currency), DisplayFormat(DataFormatString = "{0:C2}", ApplyFormatInEditMode = true)]
            public decimal BaseServiceHourlyRate { get; set; }

            [Display(Name = "Rush Premium ($/Hr)")]
            [DataType(DataType.Currency), DisplayFormat(DataFormatString = "{0:C2}", ApplyFormatInEditMode = true)]
            public decimal HourlyPremiumRush { get; set; }

            [Display(Name = "Late Premium ($/Hr)")]
            [DataType(DataType.Currency), DisplayFormat(DataFormatString = "{0:C2}", ApplyFormatInEditMode = true)]
            [DefaultValue(75)]
            public decimal HourlyPremiumLate { get; set; }

            [Display(Name = "Cust Material Premium ($/Hr)")]
            [DataType(DataType.Currency), DisplayFormat(DataFormatString = "{0:C2}", ApplyFormatInEditMode = true)]
            public decimal HourlyPremiumCustomerMaterial { get; set; }

            [Display(Name = "Created By")]
            public int CreatedByID { get; set; }
            //{
            //    get { return _currentUser; }
            //    set { _currentUser = value; }
            //}

            [Display(Name = "Created On")]
            [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
            //[DataType(DataType.Date), DisplayFormat(DataFormatString = "{0:dd/MM/yyyy}", ApplyFormatInEditMode = true)]
            public System.DateTime CreatedOn 
            {
                get { return _currentDateTime; }
                set { _currentDateTime = value; }
            }

            [Display(Name = "Modified By")]
            public int ModifiedBy { get; set; }
            //{
            //    get { return _currentUser; }
            //    set { _currentUser = value; }
            //}

            [Display(Name = "Modified On")]
            public System.DateTime ModifiedOn
            {
                get { return _currentDateTime; }
                set { _currentDateTime = value; }
            }

        }

    }
} 
```

然后在我的控制器中，我实例化了一个新的类实例来初始化它，但是我设置的值没有被设置。

```
//
        // GET: /Company/Create

        public ActionResult Create()
        {
            ViewBag.CreatedByID = new SelectList(db.UserProfiles, "UserId", "UserName");
            ViewBag.ModifiedBy = new SelectList(db.UserProfiles, "UserId", "UserName");
            Company newCompany = new Company();
            return View(newCompany);
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:11:42.753

对不起，这太晚了，但我自己解决了一个类似的场景。

我认为问题在于您如何引用部分类。它应该是对没有代码的部分类的空引用。EF 使用此“声明”将您的部分类链接到您的元数据类。因此，您的元数据类应如下所示：

```
namespace OTIS.Models.Admin
{
    [MetadataType(typeof(CompanyMD))]
    public partial class Company
    {}  // <-- note the close bracket!

    public class CompanyMD
    {
        private System.DateTime _currentDateTime = DateTime.Now;
        private int _currentUser = (int)Membership.GetUser().ProviderUserKey;

        public string FullAddress
        {
            get
            {
                return this.City + ", " + this.State + " " + this.PostalCode;
            }
        }

        [Display(Name = "Company ID")]
        public int CompanyID { get; set; }
        [Required]
        [Display(Name = "Company Name")]
        public string CompanyName { get; set; }

        // ....etc.... removed for brevity

    } // close metadata class
} // close namespace 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T21:56:20.137

我发现我需要在我的存储库类中的 GetNew() 方法中处理这个问题，该方法将填充类的新实例的默认值。

# maven - Maven：在程序集中包含 POM 和使用的依赖项

> ID：13616792
> 
> 赞同：0
> 
> 时间：2012-11-29T00:20:14.173
> 
> 标签：maven, dependencies, pom.xml, maven-assembly-plugin

我们向客户提供具有许多外部依赖项的软件包。现在客户可以使用你的库在上面开发东西。对于那些也在使用 Maven 的人，我们希望在包含所有依赖项的程序集中包含一个*pom.xml文件，这样他们就可以在他们的 Maven 构建中简单地使用它：*

它应该包含我们使用的所有依赖项，如下所示：

```
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-math</artifactId>
    <version>2.1</version>
    <scope>compile</scope>
</dependency> 
```

有没有办法在 Maven 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T04:50:11.400

默认情况下，您的 jar/war 的 pom.xml 位于您的 jar/war 中的位置`META-INF\maven\<groupId>\<artifacdId>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T06:27:51.893

你有两个选择：

第一种是最常见和首选的方式是依赖 Maven 的传递依赖解析。

在您的项目中有一个POM（假设称为`foo-api:1.0`）来声明依赖项（例如`A:1.0:jar`，`B:1.0:jar`）。

开发者自己的项目 ( `bar:2.0`) 应该简单地依赖于`foo-api:1.0`. Maven 将通过传递依赖解析简单地包含`A:1.0:jar`和`B:1.0:jar`作为 的依赖。`bar:2.0`

另一种方法与上述方法类似，但`foo-api:1.0`用作`bar:2.0`.

无论哪种方式都应该有效，但哪种方式合适取决于您的设计。

# unit-testing - 即使未使用 TextWriter，Assert 也会抛出 ObjectDisposedException

> ID：13616799
> 
> 赞同：0
> 
> 时间：2012-11-29T00:20:54.710
> 
> 标签：unit-testing, visual-studio-2012, mbunit

我有一个单元测试，它为曾经使用 TextWriter 但不再使用的方法抛出 ObjectDisposedException。我已经尝试清理解决方案并重建，但似乎无法弄清楚为什么我仍然会遇到异常。细节：

```
Test method KissMyKindle.Test.Paperwhite520PlusClippingsParserTest.ClipToXmlTest threw exception: 
System.ObjectDisposedException: Cannot write to a closed TextWriter.
Result StackTrace:  
at System.IO.__Error.WriterClosed()
   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)
   at Microsoft.VisualStudio.TestPlatform.MSTestFramework.ThreadSafeStringWriter.Write(Char[] buffer, Int32 index, Int32 count)
   at System.IO.TextWriter.WriteLine(String value)
   at System.IO.TextWriter.SyncTextWriter.WriteLine(String value)
   at Gallio.Common.Markup.TextualMarkupDocumentWriter.StreamBeginSectionImpl(String streamName, String sectionName) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Common\Markup\TextualMarkupDocumentWriter.cs:line 107
   at Gallio.Common.Markup.MarkupDocumentWriter.StreamBeginSection(String streamName, String sectionName) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Common\Markup\MarkupDocumentWriter.cs:line 492
   at Gallio.Common.Markup.MarkupStreamWriter.BeginSection(String sectionName) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Common\Markup\MarkupStreamWriter.cs:line 285
   at Gallio.Framework.Assertions.AssertionFailure.WriteTo(MarkupStreamWriter writer) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Framework\Assertions\AssertionFailure.cs:line 136
   at Gallio.Framework.Assertions.AssertionContext.Scope.LogFailure(AssertionFailure failure) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Framework\Assertions\AssertionContext.cs:line 269
   at Gallio.Framework.Assertions.AssertionContext.SubmitFailure(AssertionFailure failure) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Framework\Assertions\AssertionContext.cs:line 108
   at Gallio.Framework.Assertions.AssertionHelper.Fail(AssertionFailure failure) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Framework\Assertions\AssertionHelper.cs:line 107
   at Gallio.Framework.Assertions.AssertionHelper.Verify(Func`1 assertionFunc) in c:\Server\Projects\MbUnit v3\Work\src\Gallio\Gallio\Framework\Assertions\AssertionHelper.cs:line 93
   at MbUnit.Framework.Assert.AreEqual[T](T expectedValue, T actualValue, EqualityComparison`1 comparer, String messageFormat, Object[] messageArgs) in c:\Server\Projects\MbUnit v3\Work\src\MbUnit\MbUnit\Framework\Assert.Comparisons.cs:line 108
   at MbUnit.Framework.Assert.AreEqual[T](T expectedValue, T actualValue, String messageFormat, Object[] messageArgs) in c:\Server\Projects\MbUnit v3\Work\src\MbUnit\MbUnit\Framework\Assert.Comparisons.cs:line 52
   at MbUnit.Framework.Assert.AreEqual[T](T expectedValue, T actualValue) in c:\Server\Projects\MbUnit v3\Work\src\MbUnit\MbUnit\Framework\Assert.Comparisons.cs:line 38
   at KissMyKindle.Test.Paperwhite520PlusClippingsParserTest.ClipToXmlTest() in d:\projects\Kindle\KissMyKindle\KissMyKindle.Test\Paperwhite520PlusClippingsParserTest.cs:line 78 
```

测试代码：

```
[TestMethod]
public void ClipToXmlTest()
{
    const string EXPECTED = "";
    const string TEST_FILE_NAME = "MyTestFile";
    var mockFile = MockRepository.GenerateMock<IFile>();
    var mockIoFactory = MockRepository.GenerateMock<IIoFactory>();
    mockFile.Expect(x => x.Exists).Return(true);
    mockIoFactory.Expect(x => x.GetFile(TEST_FILE_NAME)).Return(mockFile);
    using (var stream = new MemoryStream(Encoding.Default.GetBytes(CLIPPINGS_DATA_SAMPLE)))
    {
        mockFile.Expect(x => x.OpenRead()).Return(stream);

        var actual = new KindleClippingsParser(mockIoFactory).ClipToXml(TEST_FILE_NAME).ToString();
        Assert.AreEqual(EXPECTED, actual); // fails here

        mockFile.VerifyAllExpectations();
        mockIoFactory.VerifyAllExpectations();
    }
} 
```

被测代码：

public class KindleClippingsParser { // ... public IEnumerable Clippings(string path) { if (string.IsNullOrEmpty(path)) throw new ArgumentNullException("path");

```
 var file = _ioFactory.GetFile(path);
    if (!file.Exists) throw new FileNotFoundException("Failed to open the clippings file.", path);

    _lineNumber = 0;
    using (var reader = new StreamReader(file.OpenRead()))
    {
        var data = new List<string>();
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            if (line.StartsWith(HighlightSeparator))
            {
                yield return ParseHighlight(data);
                data.Clear();
            }
            else
            {
                data.Add(line);
            }
        }
    }
}

public XElement ClipToXml(string inputPath)
{
    var rootEl = new XElement("MyClippings");
    foreach (var clippingGroup in Clippings(inputPath).GroupBy(c => c.Title))
    {
        var bookEl = new XElement("Book", new XElement("Title", clippingGroup.Key));
        var isFirst = true;
        foreach (var highlight in clippingGroup)
        {
            if (isFirst)
            {
                bookEl.Add(new XElement("Author", highlight.Author));
                isFirst = false;
            }
            var highlightEl = new XElement("KindleHighlight", new XAttribute("location", highlight.Location),
                                                              new XAttribute("added", highlight.Added.ToShortDateString()));
            highlightEl.Value = highlight.Text;
            bookEl.Add(highlightEl);
        }
        rootEl.Add(bookEl);
    }

    return rootEl;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T01:05:45.997

呵呵……修好了。结果是它试图将 Mbunit Assert 与 MSTest 框架一起使用；我最初创建测试类时考虑了 MbUnit，但当我意识到我当时无法在 Visual Studio 2012 中运行 MbUnit 测试时才切换到 MSTest。

为了使事情正常进行，我所要做的就是删除以下行：

```
using Assert = MbUnit.Framework.Assert; 
```

# android - 三星 Galaxy S2 和 S3 - MediaStore 的 ContentResolver 查询从不返回图像

> ID：13616800
> 
> 赞同：0
> 
> 时间：2012-11-29T00:20:56.587
> 
> 标签：android, image, android-gallery, galaxy

目前正在开发一个从 SD 卡加载图像的应用程序。在模拟器中，以下工作正常并找到要显示的图像。但是，在 Galaxy S2 和 S3 上 - 从未显示任何图像。有任何想法吗？

```
Cursor cursor = getContentResolver().query(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI, 
    { MediaStore.Images.Thumbnails._ID }, 
    null, 
    null, 
    MediaStore.Images.Media._ID
);

int columnIndex = cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID);
int size        = cursor.getCount();
int imageId     = 0;

for (int i = 0; i < size; i++) {
     if(cursor.isClosed()) {
         continue;
     }
     cursor.moveToPosition(i);
     imageId = cursor.getInt(columnIndex);
     uri     = Uri.withAppendedPath(
         MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, 
         Integer.toString(imageId)
     );

try {
    bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri));

        if (bitmap != null) {
            newBitmap = Bitmap.createScaledBitmap(bitmap, 70, 70,true);
            bitmap.recycle();

            if (newBitmap != null) {
                publishProgress(newBitmap);
            }
        }
} catch (IOException e) {}
}
cursor.close();
return null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:21:50.750

在设备上测试后发现以下问题解决了：

```
 BitmapFactory.Options options = new BitmapFactory.Options();
    options.outHeight = 70;
    options.outWidth = 70;
    Bitmap bitmap = null;

    Cursor cursor = getContentResolver().query(
        MediaStore.Images.Media.EXTERNAL_CONTENT_URI, 
        PROJECTION, 
        null, 
        null, 
        MediaStore.Images.Media._ID
    );
    int columnIndex = cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID);
    int size        = cursor.getCount();

    for (int i = 0; i < size; i++) {
        if(cursor.isClosed()) {
            break;
        }
        cursor.moveToPosition(i);

        bitmap = MediaStore.Images.Thumbnails.getThumbnail(
            getContentResolver(), 
            cursor.getInt(columnIndex), 
            MediaStore.Images.Thumbnails.MICRO_KIND,  
            options
        );
        publishProgress(new LoadedImage(bitmap));
    }
    cursor.close(); 
```

# tfs - Visual Studio 2012 中与最新版本比较/与工作区版本比较的键盘快捷键

> ID：13616802
> 
> 赞同：7
> 
> 时间：2012-11-29T00:21:12.840
> 
> 标签：tfs, visual-studio-2012

这在 VS 2010 中很容易，但我在 VS 2012 中找不到合适的项目。

我想在 TFS Pending Changes 视图中为 Compare With Latest/Workspace Version 上下文菜单项设置键盘快捷键。我应该在“工具”对话框的“键盘”部分选择什么项目？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T01:17:27.513

（*这是用[Visual Studio 2012 Update 1](http://www.microsoft.com/visualstudio/eng/downloads#d-visual-studio-2012-update)*测试的）

`Tools`> `Options`> `Environment`> `Keyboard`>

在`Show commands containing`搜索下并将组合键分配给：

**`TeamFoundationContextMenus.PendingChangesPageChangestoInclude.TfsContextPendingChangesPageCompareWithPreviousVersion`**- 将上下文中的待处理项目与以前的版本进行比较。

**`TeamFoundationContextMenus.PendingChangesPageChangestoInclude.TfsContextPendingChangesPageCompareWithLatestVersion`**- 将上下文中的待处理项目与最新版本进行比较。

**`TeamFoundationContextMenus.PendingChangesPageChangestoInclude.TfsContextPendingChangesPageCompareWithWorkspaceVersion`**- 将上下文中的待处理项目与工作区版本进行比较。

**`File.TfsCompare`**- 打开比较对话框。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-07-05T11:19:05.407

对我来说，这有效：

```
VS > Tools > Options > Environment > Keyboard > Show Commands Containing: Team.Git.CompareWithUnmodified 
```

`Ctrl+\, Ctrl+\`通过为此命令（*Team.Git.CompareWithUnmodified* ）分配快捷键，我现在可以通过按快捷键将当前文件（在编辑器中打开的文件）与文件的先前版本进行比较`Ctrl+\, Ctrl+\`；无需在解决方案资源管理器中查找文件，然后右键单击该文件，然后选择比较。

（当然你可以选择自己的快捷键）

*只是关于不同行为的说明：*

*   `Team.Git.CompareWithUnmodified`对我有用，因为我在 VisualStudio 中使用 TeamExplorer，但我使用 GIT 作为底层源代码存储库。

*   `Tfs.FileCompare`也可以在其他情况下工作（即，如果您不使用 Git，但使用 VSTS 或 TFS 作为源代码控制提供程序）。

*   `Other`：如果您使用其他源代码控制提供程序，该命令会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-02T16:58:26.243

当您打开文件时，请使用此组合与 Workspace 版本进行比较：

```
Menu, O, C, Enter 
```

（这执行`Right Click > Source Control > Compare > Workspace Version`）

如果您的键盘没有[Menu 键](https://en.wikipedia.org/wiki/Menu_key)，请执行以下操作：

1.  将热键设置`File.TfsCompare`为`Ctrl+\` `Ctrl+\`
2.  使用组合：`Ctrl+[` `Ctrl+S` `Ctrl+\` `Ctrl+\` `Enter`

# np-complete - 当 NP Complete 变成 NP hard

> ID：13616806
> 
> 赞同：0
> 
> 时间：2012-11-29T00:21:39.707
> 
> 标签：np-complete, np, np-hard

一般来说，假设我们有一个NPC问题。给它增加更多的约束（让它更困难），这个问题有可能变成 NPH 吗？我知道 NPC 和 NPH 之间的区别，但我不知道如何证明向现有 NPC 问题添加新约束会使其成为 NPH 还是仍然是 NPC？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:27:05.940

当然，额外的约束可以将 NPC 转换为 NPH 问题。此外，世界上没有人能够证明这一点。

# javascript - jQuery 的部分回调处理撤销了我的声明

> ID：13616813
> 
> 赞同：5
> 
> 时间：2012-11-29T00:22:35.757
> 
> 标签：javascript, jquery, ajax

我正在通过 jQuery 使用 AJAX 来发出获取请求。成功后，我将结果放入 div：

```
$.get("content.php", function(result) {
  $('#content').html(result); 
```

我请求的内容本身是 HTML 并且有两个 div`#article_name`和`#article_content`. 加载后，我检查是否`#article_content`有孩子。如果没有，我添加一个`<p>`块：

```
 if (!$('#article_content').children().length) {
    $('#article_content').html('<p>(Click here to enter text)</p>');
  }
} 
```

这有效，直到 JavaScript 离开回调函数。也就是说，在我的条件之后，`<p>`添加了块；但是当我进入 Chrome 的检查器时，它会潜入 jQuery 的回调部分，当它通过`<p>`块时消失了。

我已经在控制台中运行了我的条件以确保它不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:54:41.197

我的排序错误 - 我将条件放在更新内容区域的代码之前。

我应该删除这个问题吗？

# php - 我无法使用 php opendir 打开目录

> ID：13616814
> 
> 赞同：0
> 
> 时间：2012-11-29T00:22:36.970
> 
> 标签：php, opendir

我有如下代码：

```
$dir = opendir("D:/Marcin");
if ($dir) {
echo "OK";
}
else {
echo "not ok";
} 
```

我不正常，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:35:18.140

我相信您正在尝试打开目录服务器端。如果您在本地执行此操作，它将起作用 - 正如我所见，您正在从 PC 获取目录，但相反，您正试图在客户端执行脚本，并获得服务器端结果。

这意味着如果该目录在您的服务器上不存在，则服务器将无法找到该文件 - 并且将返回 false。

在某个时刻，您必须检查该目录是否存在于您的服务器上。

```
localserver === local directory = true;
webserver === web directory = true; 
```

如果两者都被交叉引用，它将返回false。

```
$dir = opendir("D:/Marcin"); // Check whether the directory exists on your server.
if ($dir) {
    echo "OK";
} else {
    echo "Not OK";
} 
```

希望这会有所帮助。

# ios - 错误：“NSObject”没有可见的@interface 声明选择器“copyWithZone：”

> ID：13616816
> 
> 赞同：4
> 
> 时间：2012-11-29T00:22:53.087
> 
> 标签：ios, copywithzone

我想允许对我的类对象进行深层复制并尝试实现 copyWithZone 但调用会`[super copyWithZone:zone]`产生错误：

```
error: no visible @interface for 'NSObject' declares the selector 'copyWithZone:'

@interface MyCustomClass : NSObject

@end

@implementation MyCustomClass

- (id)copyWithZone:(NSZone *)zone
{
    // The following produces an error
    MyCustomClass *result = [super copyWithZone:zone];

    // copying data
    return result;
}
@end 
```

我应该如何创建此类的深层副本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T00:27:39.263

您应该将`NSCopying`协议添加到类的接口中。

```
@interface MyCustomClass : NSObject <NSCopying> 
```

那么方法应该是：

```
- (id)copyWithZone:(NSZone *)zone {
    MyCustomClass *result = [[[self class] allocWithZone:zone] init];

    // If your class has any properties then do
    result.someProperty = self.someProperty;

    return result;
} 
```

`NSObject`不符合`NSCopying`协议。这就是你不能打电话的原因`super copyWithZone:`。

编辑：根据 Roger 的评论，我更新了`copyWithZone:`方法中的第一行代码。但根据其他评论，可以放心地忽略该区域。

# php - Paypal IPN 后如何添加 GA 交易

> ID：13616819
> 
> 赞同：0
> 
> 时间：2012-11-29T00:23:12.800
> 
> 标签：php, javascript, paypal, google-analytics, paypal-ipn

从侦听器 PHP 文件中，是否可以通过 JavaScript 向 GA 添加事务？做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:33:07.537

如果您只使用侦听器文件进行响应，或者计划使用重定向，那么这是不可能的。`hash`然而，将贝宝返回的数据另存为一个是非常可行的`$_SESSION`，然后在 GA/转换跟踪中的“收据”页面上放置。

我希望这有帮助！

# spring-mvc - 使.html默认视图spring mvc

> ID：13616821
> 
> 赞同：2
> 
> 时间：2012-11-29T00:23:20.543
> 
> 标签：spring-mvc

有一个示例应用程序并创建了一个

```
view/HelloWorld.html 
```

页。从我的控制器，我返回以下

```
public String home(Locale locale, Model model) {
    return "HelloWorld";
} 
```

在调试模式下，我收到此警告/错误：

```
WARN : org.springframework.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/HelloWorld/WEB-INF/views/HelloWorld.html] in DispatcherServlet with name 'appServlet' 
```

我的 src/main/webapp/WEB-INF/spring/appServlet/servlet-context.xml 的内容

```
<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
<beans:bean    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".html" />
</beans:bean> 
```

如果我将 .html 重命名为 .jsp 并将上面的更改为 .jsp ，那么一切正常。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T01:03:31.957

servlet 容器为此请求所经历的流程如下：

1.  首先 DispatcherServlet 由 Servlet 容器调用。
2.  DispatcherServlet 找到映射到 Controller 的 home 方法的映射，并且 home 方法返回视图名称“HelloWorld”
3.  现在 DispatcherServlet 使用 View Resolver（您的`InternalResourceViewResolver`）来查找要渲染模型的视图，因为名称是“HelloWorld”，所以它映射到`/WEB-INF/view/HelloWorld.html`视图。
4.  现在基本上是调用`RequestDispatcher.forward("/WEB-INF/views/HelloWorld.html",....`
5.  此时的 Servlet 容器试图找到可以处理`/WEB-INF/views/HellowWorld.html`uri 的 servlet - 如果它是 a `.jsp`，则有一个`JSPServlet`注册的可以处理呈现 jsp，但是因为`*.html`没有注册 servlet，所以调用以 结束`"default servlet"`，即向`/`您的 DispatcherServlet注册的 servlet-mapping 注册。
6.  现在 Dispatcher servlet 找不到控制器来处理请求`/WEB-INF/views/HelloWorld.html`，因此找不到您看到的消息

如果您希望这种扩展由 servlet 容器处理，比如 tomcat，您可以注册`*.html`扩展以由 JSPServlet 处理，然后它应该可以干净地工作。或者返回`forward:/resources/HelloWorld.html`将被视为相对于您的`resources`文件夹的静态文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:48:02.877

html和jsp之间有很多区别。Java 服务器页面被编译成 Java 'servlet'。它可以调用bean和企业bean，例如Java Beans组件和Enterprise Java Beans组件，在服务器上执行处理。因此，拥有这样的 JSP 技术可能是基于 Web 的应用程序的高级架构中的关键组件。

# c# - 必须有更好的方法来使用 LINQ 添加这些，对吗？

> ID：13616826
> 
> 赞同：0
> 
> 时间：2012-11-29T00:23:46.860
> 
> 标签：c#, linq, entity-framework-5, asp.net-4.5

我是 LINQ 的新手，并想出了下面的方法来使用 LINQ 和 EF5 向我的数据库添加新信息，但我确信有一种更有效、更好的方法来做到这一点，我只是不知道。我希望得到一些关于我可以做些什么来接受相同但使用更少/更有效的代码的输入。

```
 using (var db = new FullContext())
            {
                if (ddlItemType.SelectedValue == "Other")
                {
                    var NewItemType = new ItemType { Name = tbNewType.Text };
                    db.ItemTypes.Add(NewItemType);
                    db.SaveChanges();
                }

                if (ddlRegion.SelectedValue == "Other")
                {
                    var NewRegion = new ReleaseRegion { Name = tbNewRegion.Text };
                    db.Regions.Add(NewRegion);
                    db.SaveChanges();

                }

                var NewItemTypeID = byte.Parse((from i in db.ItemTypes
                                                where i.Name == tbNewType.Text
                                                select new { i.ID }).ToString());

                var NewRegionID = byte.Parse((from r in db.Regions
                                              where r.Name == tbNewRegion.Text
                                              select new { r.ID }).ToString());

                var NewItem = new Item
                {
                    Name = tbItemName.Text,
                    TypeID = NewItemTypeID,
                    RegionID = NewRegionID,
                    Condition = ddlCondition.SelectedValue.ToString(),
                    UPC = tbUPC.Text,
                    ISBN = tbISBN.Text,
                    IsColleciton = cbIsCollection.Checked,
                    CollectionID = Convert.ToInt16(ddlCollection.SelectedValue),
                    Notes = tbNotes.Text
                };

                db.Items.Add(NewItem);
                db.SaveChanges();
            } 
```

项目.cs：

```
using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace FFCollection.DAL
{
    [Table("Items")]
    public class Item
    {
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public Int16 ID { get; set; }

        [Required]
        public string Name { get; set; }

        public byte TypeID { get; set; }

        [ForeignKey("TypeID")]
        public virtual ItemType Type { get; set; }

        public byte RegionID { get; set; }

        [ForeignKey("RegionID")]
        public virtual ReleaseRegion Region { get; set; }

        [Required]
        public string Condition { get; set; }

        public string UPC { get; set; }

        public string ISBN { get; set; }

        public string Notes { get; set; }

        [Required]
        public Boolean IsColleciton { get; set; }

        public Int16 CollectionID { get; set; }

        [ForeignKey("CollectionID")]
        public virtual Item InCollectionID { get; set; }
    }
} 
```

项目类型.cs：

```
using System.ComponentModel.DataAnnotations.Schema;

namespace FFCollection.DAL
{
    public class ItemType
    {
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public byte ID { get; set; }

        public string Name { get; set; }
    }
} 
```

DDL 的数据绑定：

```
using (var db = new FullContext())
            {
                ddlItemType.DataSource = (from t in db.ItemTypes
                                          select new { t.ID, t.Name }).ToList();
                ddlItemType.DataTextField = "Name";
                ddlItemType.DataValueField = "ID";
                ddlItemType.DataBind();
                ddlItemType.Items.Insert(0, new ListItem("Other", "Other"));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:45:41.257

部分问题不是 Linq，而是您使用 EF 的方式。基于该示例代码，您将其用作数据层包装器而不是 ORM。在构建对象图时，您应该尽可能处理对象，而不是外键 ID。ORM 的强大之处在于您可以专门处理映射到数据的对象图，因此当您告诉 ORM 保存对象（及其相关的亲属）时，ORM 会执行插入/更新新对象的所有工作记录和接线键。你在代码中做所有额外的工作，像 EF 这样的 ORM 应该允许你用几行代码完成你想要的。

首先，在处理组合框时，将它们绑定到包含查找值 ID 的数据结构，您可以解析现有 ItemTypes 或 Regions 的实例以与新 Item 关联。（或在选择“其他”的情况下。

我要查看的是将组合框绑定到 ItemType/Regions，其中“Other”是一个特定的占位符，如果根据文本字段中的条目进行选择，代码将用新对象替换该占位符。然后，无需在附加到“项目”之前保存新对象，您只需设置引用并保存项目，该项目应为新查找对象级联插入操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:46:21.817

执行此代码后，EF 会自动将 ID 放入您的`NewItemType`实体中。你不需要再去找它，你可以说`NewItemType.ID`。这仅在您已经调用后才有效`db.SaveChanges()`。

```
if (ddlItemType.SelectedValue == "Other")
{
    var NewItemType = new ItemType { Name = tbNewType.Text };
    db.ItemTypes.Add(NewItemType);
    db.SaveChanges();
} 
```

# string - 在python中将列表转换为字符串

> ID：13616828
> 
> 赞同：3
> 
> 时间：2012-11-29T00:24:13.137
> 
> 标签：string, list, python-3.x

我对python语言相当陌生，我一直在寻找这个问题的答案。

我需要一个看起来像这样的列表：

```
['Kevin', 'went', 'to', 'his', 'computer.', 'He', 'sat', 'down.', 'He', 'fell', 'asleep.'] 
```

转换为如下所示的字符串：

```
Kevin went to his computer.

He sat down.

He fell asleep. 
```

我需要它的字符串格式，所以我可以将它写入一个文本文件。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:27:25.103

简短的解决方案：

```
>>> l
['Kevin', 'went', 'to', 'his', 'computer.', 'He', 'sat', 'down.', 'He', 'fell', 'asleep.']

>>> print ' '.join(l)
Kevin went to his computer. He sat down. He fell asleep.

>>> print ' '.join(l).replace('. ', '.\n')
Kevin went to his computer.
He sat down.
He fell asleep. 
```

长解决方案，如果您想确保只有单词末尾的句点触发换行符：

```
>>> l
['Mr. Smith', 'went', 'to', 'his', 'computer.', 'He', 'sat', 'down.', 'He', 'fell', 'asleep.'] 
>>> def sentences(words):
...     sentence = []
... 
...     for word in words:
...         sentence.append(word)
... 
...         if word.endswith('.'):
...             yield sentence
...             sentence = []
... 
...     if sentence:
...         yield sentence
... 
>>> print '\n'.join(' '.join(s) for s in sentences(l))
Mr. Smith went to his computer.
He sat down.
He fell asleep. 
```

# module - Yii - 在 Yii 用户模块中使用备用视图文件

> ID：13616829
> 
> 赞同：3
> 
> 时间：2012-11-29T00:24:22.333
> 
> 标签：module, yii, yii-extensions

[是否可以在模块（例如user](http://www.yiiframework.com/extension/yii-user "http://www.yiiframework.com/extension/yii-user") ）中使用自定义视图文件以保持模块（第 3 方）完好无损？以某种方式扩展模块，使用包含我的自定义视图的视图文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-16T13:58:55.690

将**用户**模块视图文件复制到`<app>/themes/<current_theme>/views/user/`. 更一般地说，使用以下“公式”自定义模块视图：`<app>/themes/<current_tehem>/views/<modules_name>/<controller_name>/<view_file_to_customize>.php`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T10:41:19.403

模块主题视图的路径应该是

> /{{your_app_name}}/themes/{{theme_name}}/views/user/

从文件夹中复制所有模块视图

> /{{your_app_name}}/protected/modules/user/views

到上面提到的文件夹，这将完成这项工作。之后，您可以根据需要自定义视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T03:56:24.243

**使用主题**。对于名为“user”的模块和“profile/edit”的视图路径，创建“/themes/flashy/user/views/profile/edit.php”。您还可以在“/themes/flashy/layouts/column2.php”中定义新布局。然后在“protected/config”中添加到你的配置文件：

```
return array(
    // many settings...
    'theme' => 'flashy', 
```

对于您指出的模块“用户”，不幸的是，它的控制器对其布局使用绝对路径（例如“//layouts/columns2”），因此AFAIK您无法为应用程序和此模块定义不同的布局。

另请参阅有关[Yii 主题](http://www.yiiframework.com/doc/guide/1.1/en/topics.theming)化的官方指南章节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-14T15:45:46.470

我不同意在 Internet 的许多帮助论坛中，当有人要求为模块设置主题时，每个人都会建议主题文件夹的路径别名。我认为这是错误的，因为它意味着要拆分模块，并且模块应该是可以跨项目使用的黑盒。只有在多个模块之间共享一个主题时，此类论坛中给出的建议才有效。如果有人想在模块中“打包”一个主题，她可以： - 将一个 init 函数添加到模块的控制器 - 在该 init 中，使用类属性布局和路径别名，像这样，假设一个模块的 id是“样本”：然后添加到 SampleCONtroller.php：

```
public function init() {
    //BELOW: it will use the layouts/main.php inside the module.
    $this->layouts = "sample.views.layouts.main"; 
} 
```

# sparql - Fuseki 错误 500：DatasetGraph.delete(Quad)

> ID：13616830
> 
> 赞同：4
> 
> 时间：2012-11-29T00:24:29.373
> 
> 标签：sparql, jena, fuseki

我已经设置了一个 Fuseki 端点，希望能够使用一些 SPARQL 访问 Jena SDB 数据库（后端中的真正 MySQL 数据库），包括选择和更新/删除查询。SPARQL 选择查询工作得很好，但是每当我尝试运行更新查询（例如插入或删除）时，我都会从 Fuseki 获得以下信息：

```
Error 500: DatasetGraph.delete(Quad)

Fuseki - version 0.2.6-SNAPSHOT (Build date: 2012-12-06T08:26:37-0500) 
```

我通过运行以下脚本启动了我的端点：

```
#!/bin/bash

 export FusekiInstallDir=/data/jena-fuseki-0.2.6-SNAPSHOT
 export FusekiPort=3030
 export FusekiJVMArgs="-cp ./fuseki-server.jar:lib/ReconnectingSDB-0.1-SNAPSHOT.jar:lib/jena-sdb-1.3.6-SNAPSHOT.jar:lib/mysql-connector-java-5.1.16-bin.jar:lib/jena-arq-2.9.5-SNAPSHOT.jar  -Xmx768M"
 export Date=`date +%Y-%m-%d`
 export FusekiLogFile=$FusekiInstallDir/FusekiLog-$Date.log
 export FusekiConfigFile=$FusekiInstallDir/fuseki.ttl
 export FusekiServiceName=/VIVO

 # Check to see if logfile exists
 if [ ! -f $FusekiLogFile ]; then
    touch $FusekiLogFile
 fi

 # Check to see if config file exists
 if [ ! -f $FusekiConfigFile ]; then
    echo “ERROR – Fuseki failed to start – no configuration file - $FusekiConfigFile” >> $FusekiLogFile
    exit 1
 fi

 # Execute Java calling the package for Fuseki
 java $FusekiJVMArgs org.apache.jena.fuseki.FusekiCmd --desc $FusekiConfigFile --update --port=$FusekiPort $FusekiServiceName >> $FusekiLogFile 2>&1 & 
```

它访问以下配置文件（fuseki.ttl）：

```
@prefix fuseki:  <http://jena.apache.org/fuseki#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix tdb:     <http://jena.hpl.hp.com/2008/tdb#> .
@prefix sdb:      <http://jena.hpl.hp.com/2007/sdb#> .
@prefix ja:      <http://jena.hpl.hp.com/2005/11/Assembler#> .
@prefix jumble:   <http://rootdev.net/vocab/jumble#> .
@prefix :        <#> .

[] rdf:type fuseki:Server ;
   # Services available.  Only explicitly listed services are configured.
   #  If there is a service description not linked from this list, it is ignored.
   fuseki:services (
     <#service1>
   ) .
# Declaration additional assembler items.
# [] ja:loadClass "com.hp.hpl.jena.tdb.TDB" .
[] ja:loadClass "net.rootdev.fusekisdbconnect.SDBConnect" .

jumble:SDBConnect rdfs:subClassOf ja:RDFDataset .

<#dataset> rdf:type jumble:SDBConnect  ;
   rdfs:label "SDB" ;
   sdb:layout "layout2" ;
   jumble:defaultUnionGraph "true" ; # will switch option on globally, in fact
   sdb:connection [
     rdf:type sdb:SDBConnection ;
     # Using MySQL
     sdb:sdbHost        "LASP-DB-DEV" ;
     sdb:sdbType        "MySQL" ;
     sdb:sdbName        "db" ;
     sdb:sdbUser        "user" ;
     sdb:sdbPassword    "pass" ;
     sdb:driver "com.mysql.jdbc.Driver" ;
     #sdb:jdbcUrl       "jdbc:mysql://localhost/vivodb?autoReconnect=true"
    ] ;
  .
## ---------------------------------------------------------------
## Vivo dataset in sdb

<#service1> rdf:type fuseki:Service ;
    fuseki:name                       "VIVO" ;       # http://host:port/ds
    fuseki:serviceQuery               "query" ;    # SPARQL query service
    fuseki:serviceQuery               "sparql" ;    # SPARQL query service
        fuseki:serviceUpdate                      "update" ;
    # A separate ead-only graph store endpoint:
    fuseki:serviceReadGraphStore      "get" ;      # SPARQL Graph store protocol (read only)
    fuseki:dataset                   <#dataset> ;
    . 
```

有没有人对可能导致这种情况的原因有任何想法？如果有帮助，下面是生成的 FusekiLog 文件。提前致谢！

```
12:32:40 INFO  Server               :: Dataset from assembler
12:32:40 WARN  SDBConnect           :: Hooking in to update and query engines
12:32:40 WARN  SDBConnect           :: Hooking in to assemblers
12:32:40 WARN  SDBConnect           :: Hooking in to assemblers
12:32:41 INFO  Server               :: Dataset path = /VIVO
12:32:41 INFO  Server               :: Fuseki 0.2.6-SNAPSHOT 2012-12-06T08:26:37-0500
12:32:41 INFO  Server               :: Started 2013/03/20 12:32:41 MDT on port 3030
12:32:52 INFO  Fuseki               :: [1] GET http://sorce-dp2:3030/VIVO/query?query=PREFIX+rdf%3A+++%3Chttp%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%3E%0D%0APREFIX+rdfs%3A++%3Chttp%3A%2F%2Fwww.w3.org%2F2000%2F01%2Frdf-schema%23%3E%0D%0APREFIX+xsd%3A+++%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23%3E%0D%0APREFIX+owl%3A+++%3Chttp%3A%2F%2Fwww.w3.org%2F2002%2F07%2Fowl%23%3E%0D%0APREFIX+swrl%3A++%3Chttp%3A%2F%2Fwww.w3.org%2F2003%2F11%2Fswrl%23%3E%0D%0APREFIX+swrlb%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2003%2F11%2Fswrlb%23%3E%0D%0APREFIX+vitro%3A+%3Chttp%3A%2F%2Fvitro.mannlib.cornell.edu%2Fns%2Fvitro%2F0.7%23%3E%0D%0APREFIX+bibo%3A+%3Chttp%3A%2F%2Fpurl.org%2Fontology%2Fbibo%2F%3E%0D%0APREFIX+dcelem%3A+%3Chttp%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%3E%0D%0APREFIX+dcterms%3A+%3Chttp%3A%2F%2Fpurl.org%2Fdc%2Fterms%2F%3E%0D%0APREFIX+event%3A+%3Chttp%3A%2F%2Fpurl.org%2FNET%2Fc4dm%2Fevent.owl%23%3E%0D%0APREFIX+foaf%3A+%3Chttp%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2F%3E%0D%0APREFIX+geo%3A+%3Chttp%3A%2F%2Faims.fao.org%2Faos%2Fgeopolitical.owl%23%3E%0D%0APREFIX+pvs%3A+%3Chttp%3A%2F%2Fvivoweb.org%2Fontology%2Fprovenance-support%23%3E%0D%0APREFIX+ero%3A+%3Chttp%3A%2F%2Fpurl.obolibrary.org%2Fobo%2F%3E%0D%0APREFIX+scires%3A+%3Chttp%3A%2F%2Fvivoweb.org%2Fontology%2Fscientific-research%23%3E%0D%0APREFIX+skos%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23%3E%0D%0APREFIX+vitro-public%3A+%3Chttp%3A%2F%2Fvitro.mannlib.cornell.edu%2Fns%2Fvitro%2Fpublic%23%3E%0D%0APREFIX+vivo%3A+%3Chttp%3A%2F%2Fvivoweb.org%2Fontology%2Fcore%23%3E%0D%0APREFIX+laspcms%3A+%3Chttp%3A%2F%2Fsorce-dp2%3A8080%2Flaspcms%2F%3E%0D%0APREFIX+vsto%3A+%3Chttp%3A%2F%2Fescience.rpi.edu%2Fontology%2Fvsto%2F2%2F0%2Fvsto.owl%23%3E%0D%0A%0D%0ASELECT+%3Fname%0D%0AWHERE%0D%0A%7B%0D%0A%3Fthing+a+vsto%3ADataset+.%0D%0A%3Fthing+rdfs%3Alabel+%3Fname%0D%0A%7D%0D%0A&output=text&stylesheet=%2Fxml-to-html.xsl
12:32:52 INFO  Fuseki               :: [1] Query = PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX xsd:   <http://www.w3.org/2001/XMLSchema#>  PREFIX owl:   <http://www.w3.org/2002/07/owl#>  PREFIX swrl:  <http://www.w3.org/2003/11/swrl#>  PREFIX swrlb: <http://www.w3.org/2003/11/swrlb#>  PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>  PREFIX bibo: <http://purl.org/ontology/bibo/>  PREFIX dcelem: <http://purl.org/dc/elements/1.1/>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX event: <http://purl.org/NET/c4dm/event.owl#>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX geo: <http://aims.fao.org/aos/geopolitical.owl#>  PREFIX pvs: <http://vivoweb.org/ontology/provenance-support#>  PREFIX ero: <http://purl.obolibrary.org/obo/>  PREFIX scires: <http://vivoweb.org/ontology/scientific-research#>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX vitro-public: <http://vitro.mannlib.cornell.edu/ns/vitro/public#>  PREFIX vivo: <http://vivoweb.org/ontology/core#>  PREFIX laspcms: <http://sorce-dp2:8080/laspcms/>  PREFIX vsto: <http://escience.rpi.edu/ontology/vsto/2/0/vsto.owl#>    SELECT ?name  WHERE  {  ?thing a vsto:Dataset .  ?thing rdfs:label ?name  }
12:32:52 INFO  Fuseki               :: [1] OK/select
12:32:52 INFO  Fuseki               :: [1] 200 OK
12:35:06 INFO  Fuseki               :: [2] POST http://sorce-dp2:3030/VIVO/update
12:35:06 WARN  SPARQL_Update$HttpActionUpdate :: Transaction still active in endWriter - no commit or abort seen (forced abort)
12:35:06 WARN  SPARQL_Update$HttpActionUpdate :: Exception in forced abort (trying to continue)
com.hp.hpl.jena.sparql.core.DatasetGraphWithLock$JenaLockException: Can't abort a locked update
        at com.hp.hpl.jena.sparql.core.DatasetGraphWithLock._abort(DatasetGraphWithLock.java:97)
        at com.hp.hpl.jena.sparql.core.DatasetGraphTrackActive.abort(DatasetGraphTrackActive.java:63)
        at org.apache.jena.fuseki.servlets.HttpAction.endWrite(HttpAction.java:121)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.execute(SPARQL_Update.java:246)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.executeForm(SPARQL_Update.java:232)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.perform(SPARQL_Update.java:118)
        at org.apache.jena.fuseki.servlets.SPARQL_ServletBase.doCommonWorker(SPARQL_ServletBase.java:117)
        at org.apache.jena.fuseki.servlets.SPARQL_ServletBase.doCommon(SPARQL_ServletBase.java:67)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.doPost(SPARQL_Update.java:84)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:598)
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:442)
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1033)
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:369)
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:967)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
        at org.eclipse.jetty.server.Server.handle(Server.java:358)
        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:452)
        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)
        at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:894)
        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:948)
        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:851)
        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)
        at org.eclipse.jetty.server.nio.BlockingChannelConnector$BlockingChannelEndPoint.run(BlockingChannelConnector.java:293)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)
        at java.lang.Thread.run(Thread.java:662)
12:35:06 WARN  Fuseki               :: [2] RC = 500 : DatasetGraph.delete(Quad)
java.lang.UnsupportedOperationException: DatasetGraph.delete(Quad)
        at com.hp.hpl.jena.sparql.core.DatasetGraphBase.delete(DatasetGraphBase.java:81)
        at com.hp.hpl.jena.sparql.core.DatasetGraphTrackActive.delete(DatasetGraphTrackActive.java:131)
        at com.hp.hpl.jena.sparql.core.DatasetGraphWrapper.delete(DatasetGraphWrapper.java:76)
        at com.hp.hpl.jena.sparql.modify.UpdateEngineWorker.execDelete(UpdateEngineWorker.java:438)
        at com.hp.hpl.jena.sparql.modify.UpdateEngineWorker.visit(UpdateEngineWorker.java:357)
        at com.hp.hpl.jena.sparql.modify.request.UpdateModify.visit(UpdateModify.java:97)
        at com.hp.hpl.jena.sparql.modify.UpdateEngineMain.execute(UpdateEngineMain.java:57)
        at com.hp.hpl.jena.sparql.modify.UpdateProcessorBase.execute(UpdateProcessorBase.java:56)
        at com.hp.hpl.jena.update.UpdateAction.execute$(UpdateAction.java:334)
        at com.hp.hpl.jena.update.UpdateAction.execute(UpdateAction.java:327)
        at com.hp.hpl.jena.update.UpdateAction.execute(UpdateAction.java:307)
        at com.hp.hpl.jena.update.UpdateAction.execute(UpdateAction.java:257)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.execute(SPARQL_Update.java:242)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.executeForm(SPARQL_Update.java:232)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.perform(SPARQL_Update.java:118)
        at org.apache.jena.fuseki.servlets.SPARQL_ServletBase.doCommonWorker(SPARQL_ServletBase.java:117)
        at org.apache.jena.fuseki.servlets.SPARQL_ServletBase.doCommon(SPARQL_ServletBase.java:67)
        at org.apache.jena.fuseki.servlets.SPARQL_Update.doPost(SPARQL_Update.java:84)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:598)
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:442)
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1033)
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:369)
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:967)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
        at org.eclipse.jetty.server.Server.handle(Server.java:358)
        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:452)
        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)
        at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:894)
        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:948)
        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:851)
        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)
        at org.eclipse.jetty.server.nio.BlockingChannelConnector$BlockingChannelEndPoint.run(BlockingChannelConnector.java:293)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)
        at java.lang.Thread.run(Thread.java:662)
12:35:06 INFO  Fuseki               :: [2] 500 DatasetGraph.delete(Quad) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:23:46.040

你似乎在奔跑

```
Fuseki - version 0.2.2-incubating-SNAPSHOT 
```

尽管

```
export FusekiInstallDir=/data/jena-fuseki-0.2.4 
```

它可能是一个已知的错误，现在已修复。你能升级到0.2.5吗？

配置说：

```
jumble:SDBConnect rdfs:subClassOf ja:RDFDataset . 
```

但

```
<#ufvivo_dataset_read> rdf:type      sdb:DatasetStore ;
    sdb:store <#VIVOStore>
   .
<#VIVOStore> rdf:type jumble:SDBConnect; 
```

所以`jumble:SDBConnect`不是数据集（可能没关系 - 代码跟随`<#VIVOStore>`链接

没有

```
sdb:DatasetStore  rdfs:subClassOf  ja:RDFDataset . 
```

但是您本地的初始化类可能会在这里做一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-24T21:33:11.060

有 tdb.lock 存在，你需要删除这个文件使用以下命令删除那个文件

```
rm -f run/system/tdb.lock 
```

# moq - 起订量和类中的设置属性

> ID：13616831
> 
> 赞同：2
> 
> 时间：2012-11-29T00:24:29.580
> 
> 标签：moq

我有一个类，其中包含通过加载器类填充的属性。快速示例：

```
class Employee : IEmployee
{
   public string EmpFirstName {get; set}
   public string EmpLastName {get; set}
}

public class EmpLoader(int employeeID)
{
   public void Load(IEmployee emp)
   {
     emp.EmpFirstName = //lookup the employee using the EmployeeID 
     //...
   }
} 
```

我想知道如何安排事情，以便模拟`EmpLoader`的`Load()`方法填充`Employee`. 就像是：

```
Employee myEmp = new Employee();
_empLoader = new Mock<EmpLoader>();
_empLoader.Setup(empL => empL.Load(myEmp)).Sets_myEmp_Properties_Somehow(); 
```

在决定返回哪种返回值时，我之前使用过 Moq 的`Setup()`方法，但不确定我是否可以使用它或其他方法通过第三方类在一个类中设置属性。可能是我离这里很远；我不是起订量方面的专家，我愿意接受建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:31:24.037

您可以使用 Setup() 上的 Callback() 方法来加载数据：

```
Employee myEmp = new Employee();
Mock<EmpLoader> _empLoader = new Mock<EmpLoader>();
_empLoader.Setup(empL => empL.Load(myEmp)).Callback<IEmployee>((emp) => {
    emp.EmpFirstName = "Steve";
    // ... Load all properties
} 
```

# entity-framework - 将动态连接字符串与 Breeze EFContextProvider 一起使用

> ID：13616832
> 
> 赞同：3
> 
> 时间：2012-11-29T00:24:30.547
> 
> 标签：entity-framework, breeze

> 目前我有一个应用程序（web/silverlight），其中我的 ObjectContext 的连接字符串是动态的。它基于用户的登录方式，因为我的每个客户都有自己的数据库。即..用户名@域。我正在尝试找到一种使用 EFContextProvider 的方法，即通过构造函数传递 ObjectContext 或覆盖 GetConnectionString，遗憾的是两者都不支持。
> 
> 有没有办法做到这一点，或者我可以在某处下载 EFContextProvider 的源代码，以便我自己实现它？
> 
> 提前致谢。

这个问题由 Marcel 在我们的 IdeaBlade 论坛上发布。我在这里重新发布问题和答案，因为我认为它对 Breeze Stack Overflow 社区很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T01:22:29.017

您不必为了这么简单的事情下载源代码并对其进行修改。现在你**不必这样做了**。

我们已经向 GitHub 推送了对`EFContextProvider`. 此更改将出现在下一个 Breeze Runtime 版本 (> 0.81.2) 中。

用于创建“T”（您的 ObjectContext/ DbContext `EFContextProvider`）的位置如下：

```
_context = 新 T();

```

它现在调用一个虚拟方法，`T CreateContext()`它的默认实现是：

```
受保护的虚拟 T CreateContext() {
    返回新的 T();
}

```

在您的子类中覆盖并替换它，`EFContextProvider`您将能够按照您喜欢的方式创建类型为“T”的上下文。

**注意：基础`EFContextProvider`仍然会做一些创建后的配置**，以确保它的行为符合我们的预期；我们不希望上下文进行任何延迟加载或创建代理。

因此，如果 'T' 是`ObjectContext`，则提供者将执行以下操作：

```
objCtx.ContextOptions.LazyLoadingEnabled = false;

```

如果 'T' 是 a`DbContext`它会这样做：

```
dbCtx.Configuration.ProxyCreationEnabled = 假；
dbCtx.Configuration.LazyLoadingEnabled = 假；

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:24:30.547

> 我下载了源代码并向 EFContextProvider 添加了一个构造函数，该构造函数接受一个 T 的实例，以便能够使用现有的 ObjectContext/DbContext，它的工作原理就像一个魅力。

Marcel 自己想通了，并在我们的论坛上回答了他自己的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T07:45:37.580

Ward 提到的 CreateContext 虚拟方法现在在 v 0.83.2 中可用

# yui - YUI 根据列表选择更改数据表

> ID：13616840
> 
> 赞同：0
> 
> 时间：2012-11-29T00:24:56.640
> 
> 标签：yui

请告知，我想制作一个可以过滤数据表的下拉列表，例如，如果您有发票数据表，并且用户可以从具有发票类型“借方贷方..等”的下拉列表中进行选择，因此取决于这个选择应该使用 YUI 过滤数据表。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:16:25.267

这个例子比你描述的更复杂，但它的基本思想是一样的：http: [//jafl.github.com/yui3-gallery/querybuilder/](http://jafl.github.com/yui3-gallery/querybuilder/)

# css - 如何在流体网站中固定菜单？

> ID：13616841
> 
> 赞同：0
> 
> 时间：2012-11-29T00:25:06.073
> 
> 标签：css

[http://www.eco1furniture.ca/](http://www.eco1furniture.ca/)

向下调整页面大小时，主菜单转到第二行。我知道这应该发生在网站流动的情况下。但是有没有办法让它固定（在一条线上）？

![主菜单](../Images/a107b1dbe8f894de2fa1d8b7137deac4.png)

谢谢，肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:16:54.463

您可以进行一些更改以确保菜单在“正常”条件下不会换行成两行，但我认为您无法确定它不会发生。例如，菜单宽度将取决于浏览器缩放级别、字体和字体大小。

使用我的浏览器默认设置，你的菜单是 865px 宽。考虑到排水沟，小屏幕样式表的最大宽度应该是 972px，所以下拉菜单出现在菜单进入两行之前。975px 是考虑不同浏览器的一些特性的合理值，但它仍然假设用户处于 100% 缩放，并使用您指定的字体和字体大小。

responsive.css - 第 51 行

```
@media only screen and (max-width: 975px) { 
```

在菜单本身上设置最小宽度也会遇到同样的问题，并且正如您所发现的那样，会导致菜单超出主包装。

# matlab - 获取矩阵子集的边界单元的索引。MATLAB

> ID：13616842
> 
> 赞同：3
> 
> 时间：2012-11-29T00:25:16.610
> 
> 标签：matlab, matrix, octave, subset, boundary

给定一个矩阵，其中 1 是当前子集

```
test =

     0     0     0     0     0     0
     0     0     0     0     0     0
     0     0     1     1     0     0
     0     0     1     1     0     0
     0     0     0     0     0     0
     0     0     0     0     0     0 
```

是否有函数或快速方法可以将子集更改为当前子集的边界？

例如。从上面的“测试”中获取这个子集

```
test =

     0     0     0     0     0     0
     0     1     1     1     1     0
     0     1     0     0     1     0
     0     1     0     0     1     0
     0     1     1     1     1     0
     0     0     0     0     0     0 
```

最后，我只想获得围绕矩阵子集的最小单元格。当然，我可以循环并获得边界的最小值（逐个单元格），但必须有一种方法可以使用我上面显示的方法来做到这一点。

请注意，子集将被连接，但可能不是矩形。这可能是一个大问题。

这是一个可能的子集......（会用 NaN 边框填充它）

```
test =

     0     0     0     0     0     0
     0     0     0     0     0     0
     0     0     1     1     0     0
     0     0     1     1     0     0
     0     0     1     1     1     1
     0     0     1     1     1     1 
```

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T01:40:36.920

我将使用的基本步骤是：

1.  对形状执行膨胀以获得一个新区域，即形状加上其边界
2.  从扩张的形状中减去原始形状，只留下边界
3.  使用边界来索引您的数据矩阵，然后取最小值。

## 扩张

我在这里要做的是在每个单元格上传递一个 3x3 窗口并在该窗口中取最大值：

```
[m, n] = size(A); % assuming A is your original shape matrix
APadded = zeros(m + 2, n + 2);
APadded(2:end-1, 2:end-1) = A; % pad A with zeroes on each side
ADilated = zeros(m + 2, n + 2); % this will hold the dilated shape.

for i = 1:m
    for j = 1:n
        mask = zeros(size(APadded));
        mask(i:i+2, j:j+2) = 1; % this places a 3x3 square of 1's around (i, j)
        ADilated(i + 1, j + 1) = max(APadded(mask));
    end
end 
```

## 形状减法

这基本上是一个逻辑 AND 和一个逻辑 NOT 来删除交集：

```
ABoundary = ADilated & (~APadded); 
```

在这个阶段，您可能想要删除我们添加的用于膨胀的边框，因为我们不再需要它了。

```
ABoundary = ABoundary(2:end-1, 2:end-1); 
```

## 找到沿边界的最小数据点

我们可以使用我们的逻辑边界将原始数据索引到一个向量中，然后只取该向量的最小值。

```
dataMinimum = min(data(ABoundary)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T01:39:35.547

您应该将此视为形态学问题，而不是集合论。这可以很容易地解决`imdilate()`（需要图像包）。您基本上只需要使用 1 的 3x3 矩阵将图像减去其[膨胀。](http://en.wikipedia.org/wiki/Dilation_%28morphology%29)

```
octave> test = logical ([0  0  0  0  0  0
                         0  0  0  0  0  0
                         0  0  1  1  0  0
                         0  0  1  1  0  0
                         0  0  1  1  1  1
                         0  0  1  1  1  1]);
octave> imdilate (test, true (3)) - test
ans =

   0   0   0   0   0   0
   0   1   1   1   1   0
   0   1   0   0   1   0
   0   1   0   0   1   1
   0   1   0   0   0   0
   0   1   0   0   0   0 
```

但是，它不使用 NaN 填充。如果你真的想要，你可以用 false 填充原始矩阵，执行操作，然后检查边框中是否有任何真值。

请注意，您不必使用`logical()`，在这种情况下您必须使用`ones()`而不是`true()`. 但这需要更多的内存并且性能更差。

**编辑：**由于您尝试在不使用任何 matlab 工具箱的情况下执行此操作，因此请查看[Octave的](https://sourceforge.net/p/octave/code/11324/tree/trunk/octave-forge/main/image/inst/imdilate.m)[来源`imdilate()`](https://sourceforge.net/p/octave/code/11324/tree/trunk/octave-forge/main/image/inst/imdilate.m)。对于逻辑矩阵（这是您的情况），这是`filter2()`属于matlab核心的简单用法。也就是说，以下一行应该可以正常工作并且要快得多

```
octave> (filter2 (true (3), test) > 0) - test
ans =

   0   0   0   0   0   0
   0   1   1   1   1   0
   0   1   0   0   1   0
   0   1   0   0   1   1
   0   1   0   0   0   0
   0   1   0   0   0   0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T01:40:09.677

一种可能的解决方案是获取子集并将其添加到原始矩阵，但确保每次添加它时，将其位置偏移 +1 行、-1 行和 +1 列、-1 列。然后，结果将在原始子集周围扩展一行和一列。然后，您使用原始矩阵将原始子集掩码为零。

像这样：

```
test_new = test + ...
[[test(2:end,2:end);zeros(1,size(test,1)-1)],zeros(size(test,1),1)] + ... %move subset up-left
[[zeros(1,size(test,1)-1);test(1:end-1,2:end)],zeros(size(test,1),1)] + ... %move down-left
[zeros(size(test,1),1),[test(2:end,1:end-1);zeros(1,size(test,1)-1)]] + ... %move subset up-right
[zeros(size(test,1),1),[zeros(1,size(test,1)-1);test(1:end-1,1:end-1)]];  %move subset down-right

test_masked = test_new.*~test; %mask with original matrix
result = test_masked;
result(result>1)=1; % ensure that there is only 1's, not 2, 3, etc. 
```

您的`test`矩阵上的结果是：

```
result =

 0     0     0     0     0     0
 0     1     1     1     1     0
 0     1     0     0     1     0
 0     1     0     0     1     1
 0     1     0     0     0     0
 0     1     0     0     0     0 
```

已编辑 - 它现在也可以通过将子集向上和向左、向上和向右、向下然后向左和向下然后向右移动来抓取角落。

我希望这将是实现这一目标的一种非常快速的方法——它没有任何循环，也没有函数——只有矩阵运算。

# c++ - 如何在 SFML C++ 中传递图像

> ID：13616847
> 
> 赞同：0
> 
> 时间：2012-11-29T00:25:46.073
> 
> 标签：c++, image, sfml

我正在尝试制作一个简单的函数或类来选择图像并将其返回或以某种方式将其传递给不同的类。是否像知道图像被认为是什么类型一样简单？还是我需要做其他事情？我在 Windows 8 计算机上使用 GNU GCC 编译器运行 Code::Blocks 10.05。任何帮助表示赞赏。

感谢 Aesthete，我取得了一些进展。现在我有这个：

```
class Background{
    sf::Image BGI;
    sf::Sprite BG;
    Image& img;

    public:
    void rimage(std::string name){
        sf::Image extra;
        extra.LoadFromFile(name);
        img = extra;
    }
    void init(std::string name){
    BGI = img
    BG.SetPosition(0.f,0.f);
    BG.SetImage(BGI);

    }
}; 
```

但是当我运行它时，我得到了这个：

```
 ...4 error: ISO C++ forbids declaration of 'Image" with no type 
```

还，

```
...10 error: 'img' is defined in this scope 
```

我已经包含了运行 SFML 所需的库，我只是将其省略以保持干净，我调整了上面发生的错误的行以使其更易于理解。

img 现在不是背景中的全局变量吗？我认为`Image&`是`img`......这里需要改变什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:32:37.013

您不需要`load`方法，也不需要任何额外的`Image`对象。您可以在构造函数中完成所有这些处理。

```
class Background{
  private:
    // You only need an image and a background, if that.
    sf::Image BGI;
    sf::Sprite BG;

  public:
    // Use a constructor.
    Background(std::string name)
    {
      SetBackground(name, Vector2f(0.f, 0.f));
    }
    void SetBackground(std::string name, sf::Vector2f pos)
    {
      BGI.LoadFromFile(name);
      BG.SetImage(BGI);
      BG.SetPosition(pos);
    }
};

// Constructor loads image, sets image to sprite, and set sprite position.
Background bg("MyBackground.png");

// You can change the background image an position like so.
bg.SetBackgrond("newImage.png", Vector2f(10.f, 20.f)); 
```

# html - jQuery从单独的特定复选框中取消选中div中的复选框

> ID：13616856
> 
> 赞同：1
> 
> 时间：2012-11-29T00:26:44.257
> 
> 标签：html, jquery, checkbox

有两个单独的 div：check_one 和 check_two。check_one 有 4 个盒子，check_two 有 1 个。

如果选中 check_two div 中的复选框，则应取消选中第一个 div check_one 中的所有已选中框。这有点令人困惑，但这就是我想要做的。

HTML ::

```
<div id="check_one">
    <label>Stuff 1</label> <input name="" type="checkbox" value="" id="group1" checked="checked"><br>
    <label>Stuff 2</label> <input name="" type="checkbox" value="" id="group1" checked="checked"><br>
    <label>Stuff 3</label> <input name="" type="checkbox" value="" id="group1" checked="checked"><br>
    <label>Stuff 4</label> <input name="" type="checkbox" value="" id="group1" checked="checked">
</div>
<br>
<div id="check_two">
    <label>Undo</label> <input name="uncheckMe" type="checkbox" value="" id="group2">
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

jQuery ::

```
$('input[name=uncheckMe]').change(
{
    var checked = $("#group1").attr("checked");

    if(checked)
    {
        $("#check_two").attr("disabled", true);
    }

});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:33:40.603

试试这个：

```
$("input[name='uncheckMe']").change(function(){
    if ($(this).is(":checked")){       
        $("#check_one input").removeAttr("checked");
    }
}); 
```

还有一个 jsFiddle：http: [//jsfiddle.net/PgHbu/3/](http://jsfiddle.net/PgHbu/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:43:03.307

我为此[http://jsfiddle.net/Twisty/ta2qT/创建了一个 jsFiddle](http://jsfiddle.net/Twisty/ta2qT/)

您在 Change() 中缺少一个函数：

```
 $('input[name=uncheckMe]').change(function(){
        $("#check_one > input").each(function(i) {
            if ($(this).is(":checked")) {
                $(this).removeAttr("checked");
            }
        });
    }); 
```

# jquery - 如何使用 jQuery 验证插件作为更大的 javascript 处理流程的一部分？

> ID：13616857
> 
> 赞同：0
> 
> 时间：2012-11-29T00:26:55.210
> 
> 标签：jquery, jquery-validate

在我的客户端代码中，我：

1.  填充表单中的隐藏字段。
2.  等待用户填写姓名、电子邮件等字段。
3.  用户单击[提交]或[取消]。
4.  假设单击 [Submit]，我组装数据，发出 jQuery.ajax POST 请求，并用结果重新填充页面。

各种形式已经达到了足够的复杂性，jQuery 验证插件[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)将提供很大的帮助。我已经在其他各种项目中使用过它。

但是，我从未将它用作更大的 javascript/jQuery 工作流程的一部分。当用户单击提交时，我想针对该 html 表单运行验证（并且只有该表单，页面上有几个）。如果验证失败，则显示错误消息（正常的验证行为）。如果验证通过，继续我现有的 AJAX 处理代码。

我怎样才能做到这一点，即在上面的第 3 步和第 4 步之间插入 jQuery 表单验证？

我很抱歉没有发布代码。它是保密的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T12:55:45.947

使用[submitHandler](http://docs.jquery.com/Plugins/Validation/validate#toptions)回调

> “表单有效时处理实际提交的回调。获取表单作为唯一参数。替换默认提交。在验证后通过 Ajax 提交表单的正确位置。”

```
$(".selector").validate({
   submitHandler: function(form) {
      // or put your code here
      $(form).ajaxSubmit();
   }
}) 
```

# iphone - PhoneGap：返回 index.html

> ID：13616859
> 
> 赞同：1
> 
> 时间：2012-11-29T00:27:08.443
> 
> 标签：iphone, url, cordova, back

我想在 iPhone 的 PhoneGap 应用程序中使用外部服务。
当该过程完成时，该服务将使用成功 url 将用户重定向到原始页面。
我应该将什么 url 传递给服务以返回到我的 PhoneGap 应用程序？
我曾尝试使用 file://www/index.html，但出现权限错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:55:22.913

您不能在 PhoneGap html 页面中可靠地使用绝对 URL。在安卓上你有

```
file:///android_asset/www/index.html 
```

但在 iOS 上，您的网址类似于

```
file:////var/mobile/Applications/[uuid]/[app name].app/www/index.html 
```

您事先不知道该 url，因此要获得指向 index.html 的绝对链接，您需要从 document.location 获取该 url，并将其设置为基本 url 或将其保存以在链接中使用。

# java - 如何使用 Java 浏览和显示 XML 内容

> ID：13616864
> 
> 赞同：1
> 
> 时间：2012-11-29T00:28:00.237
> 
> 标签：java, html, xml, dom, sax

我在使用 DOM 的 Java 中遇到问题......这是 XML 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<bib>
<domain>
    <title>Specifications</title>
    <bib_ref>
        <year>March 2000</year>
        <title>MOF  1.3</title>
        <author>OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\MOF1_3.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>August 2002</year>
        <title>IDLto Java LanguageMapping Specification</title>
        <author>OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\IDL2Java.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>1999</year>
        <title>XML Metadata Interchange (XMI) Version 1.1</title>
        <author>OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\xmi-1.1.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>2002</year>
        <title>XML Metadata Interchange (XMI) Version 2</title>
        <author>"OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\XMI2.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>2002</year>
        <title>XMI Version 1Production of XML Schema Specification</title>
        <author>OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\XMI1XSD.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>2002</year>
        <title>EDOC</title>
        <author>OMG</author>
        <weblink>D:\SALIM\Docs\Specifications\EDOC02-02-05.pdf</weblink>
    </bib_ref>
</domain>
<domain>
    <title>Theses</title>
    <bib_ref>
        <year>Octobre 2001</year>
        <title>Echanges de Spécifications Hétérogènes et Réparties</title>
        <author>Xavier Blanc</author>
        <weblink>D:\SALIM\Docs\Theses\TheseXavier.pdf</weblink>
    </bib_ref>
    <bib_ref>
        <year>Janvier 2001</year>
        <title>Composition of Object-Oriented Software Design Models</title>
        <author>Siobhan Clarke</author>
        <weblink>D:\SALIM\Docs\Theses\SClarkeThesis.pdf</weblink>
    </bib_ref>
 ......
 ...... 
```

之后，在 Java 主函数中，我调用了刚刚存在的 dispContent 函数：

```
public void dispContent (Node n) 
{

    String domainName = null;

    // we are in an element node
    if (n instanceof Element) {
        Element e = ((Element) n);

        // domain title
        if (e.getTagName().equals("title") && e.getParentNode().getNodeName().equals("domain")) {
            domainName = e.getTextContent();
            DomaineTemplate(domainName);
        }

        else if (e.getTagName().equals("bib_ref")) {
            NodeList ref = e.getChildNodes();

            for (int i = 0; i < ref.getLength(); i++) {
                Node temp = (Node) ref.item(i);

                if (temp.getNodeType() == Node.ELEMENT_NODE) {
                    if (temp.getNodeType() == org.w3c.dom.Node.TEXT_NODE)
                        continue;

                    out.println(temp.getNodeName() + " : " + temp.getTextContent() + "\n");
                }
            }
        }

        else {
            NodeList sub = n.getChildNodes();
            for(int i=0; (i < sub.getLength()); i++)
                dispContent(sub.item(i));

        }
    }
        /*else if (n instanceof Document) {
        NodeList fils = n.getChildNodes();
        for(int i=0; (i < fils.getLength()); i++) {
            dispContent(fils.item(i));

        }
    }*/
} 
```

“domaineTemplate”函数只显示它的参数！当我在 Java 中浏览“bib_ref”标签时，就会出现我的问题。对于每个“bib_ref”循环，它会在一行中显示所有“bib_ref”标签的所有内容！我想每个“bib_ref”只显示一个内容（年份、标题、作者和网络链接标签）。

这是我浏览 bib_ref 时显示的内容：

> 规格
> 
> 年份：2000 年 3 月标题：MOF 1.3 作者：OMG 链接：D:\SALIM\Docs\Specifications\MOF1_3.pdf 年份：2002 年 8 月标题：IDLto Java LanguageMapping 规范作者：OMG 链接：D:\SALIM\Docs\Specifications\IDL2Java .pdf 年份：1999 标题：XML 元数据交换 (XMI) 版本 1.1 作者：OMG 网络链接：D:\SALIM\Docs\Specifications\xmi-1.1.pdf 年份：2002 标题：XML 元数据交换 (XMI) 版本 2 作者：OMG链接：D:\SALIM\Docs\Specifications\XMI2.pdf 年份：2002 标题：XMI 版本 1 XML 模式规范的制作作者：OMG 链接：D:\SALIM\Docs\Specifications\XMI1XSD.pdf 年份：2002 标题：EDOC 作者: OMG 网络链接 : D:\SALIM\Docs\Specifications\EDOC02-02-05.pdf
> 
> 论文
> 
> 年份：2001 年 10 月 标题：Echanges de Spec�cifications H�t�rog�nes et R�parties 作者：Xavier Blanc 网站链接：D:\SALIM\Docs\Theses\TheseXavier.pdf 年份：2001 年 1 月标题：对象的组成-面向软件设计模型作者：Siobhan Clarke 链接：D:\SALIM\Docs\Theses\SClarkeThesis.pdf 年份：2002 年 6 月标题：贡献 - la repr�sentation de processu par des technologies de m�ta mod�lisation 作者：Erwan Breton网站链接：D:\SALIM\Docs\Thes\ErwanBretonThesis.pdf 年份：2000 年 10 月 标题：技术改造和改造技术作者：Richard Lemesle 网站链接：D:\SALIM\Docs\Thes\RichardLemesle。 pdf 年份：Juillet 2002 标题：Utilsation d'agents mobiles pour la construction des services 发行作者：Siegfried Rouvrais 网站链接：D:\SALIM\Docs\Thes\theserouvrais.pdf ... ...

你能帮助我吗 ？我只是一个使用java的xml初学者，我正在寻找一些解决方案大约3个小时......非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T01:50:42.587

我调用`dispContent(doc.getFirstChild());`where doc 是具有给定 xml 文件内容的文档。

假设：`out.println()`是`System.out.println()`并`DomaineTemplate(domainName);`添加一个换行符（基于您提供的输出）

我在控制台中打印出以下内容：

```
规格

年份：2000 年 3 月

标题：MOF 1.3

作者：天啊

网址：D:\SALIM\Docs\Specifications\MOF1_3.pdf

年份：2002 年 8 月

标题：IDLto Java 语言映射规范

作者：天啊

网络链接：D:\SALIM\Docs\Specifications\IDL2Java.pdf

年份：1999

标题：XML 元数据交换 (XMI) 版本 1.1

作者：天啊

网址：D:\SALIM\Docs\Specifications\xmi-1.1.pdf

年份 : 2002

标题：XML 元数据交换 (XMI) 版本 2

作者：“天啊

网页链接：D:\SALIM\Docs\Specifications\XMI2.pdf

年份 : 2002

title : XMI Version 1 XML Schema Specification的产生

作者：天啊

网址：D:\SALIM\Docs\Specifications\XMI1XSD.pdf

年份 : 2002

标题： EDOC

作者：天啊

网址：D:\SALIM\Docs\Specifications\EDOC02-02-05.pdf

论文

年份：2001 年 10 月

标题 : Echanges de Specifications Hétérogènes et Réparties

作者：泽维尔布兰克

网络链接：D:\SALIM\Docs\Thes\TheseXavier.pdf

年份 : 一月 2001

标题：面向对象软件设计模型的组成

作者：西沃恩·克拉克

网页链接：D:\SALIM\Docs\Thes\SClarkeThesis.pdf

```

如果您在`"\n"`创建新行时遇到问题，可以尝试使用系统使用的内容：

```
public static final String NEW_LINE = System.getProperty("line.separator"); 
```

如果您不希望“bib_ref”节点的子节点的每一行之间的新行打印出来，请更改：

```
else if (e.getTagName().equals("bib_ref")) {
    NodeList ref = e.getChildNodes();

        for (int i = 0; i < ref.getLength(); i++) {
            Node temp = (Node) ref.item(i);

            if (temp.getNodeType() == Node.ELEMENT_NODE) {
                if (temp.getNodeType() == org.w3c.dom.Node.TEXT_NODE)
                    continue;

                 out.println(temp.getNodeName() + " : " + temp.getTextContent() + "\n");
            }
        }
} 
```

至：

```
else if (e.getTagName().equals("bib_ref")) {
    NodeList ref = e.getChildNodes();

        for (int i = 0; i < ref.getLength(); i++) {
            Node temp = (Node) ref.item(i);

            if (temp.getNodeType() == Node.ELEMENT_NODE) {
                if (temp.getNodeType() == org.w3c.dom.Node.TEXT_NODE)
                    continue;

                 // Removed "\n":
                 out.println(temp.getNodeName() + " : " + temp.getTextContent());
            }
        }

        // Added out.println();
        out.println();
} 
```

结果：

```
规格

年份：2000 年 3 月
标题：MOF 1.3
作者：天啊
网址：D:\SALIM\Docs\Specifications\MOF1_3.pdf

年份：2002 年 8 月
标题：IDLto Java 语言映射规范
作者：天啊
网络链接：D:\SALIM\Docs\Specifications\IDL2Java.pdf

年份：1999
标题：XML 元数据交换 (XMI) 版本 1.1
作者：天啊
网址：D:\SALIM\Docs\Specifications\xmi-1.1.pdf

年份 : 2002
标题：XML 元数据交换 (XMI) 版本 2
作者：“天啊
网页链接：D:\SALIM\Docs\Specifications\XMI2.pdf

年份 : 2002
title : XMI Version 1 XML Schema Specification的产生
作者：天啊
网址：D:\SALIM\Docs\Specifications\XMI1XSD.pdf

年份 : 2002
标题： EDOC
作者：天啊
网址：D:\SALIM\Docs\Specifications\EDOC02-02-05.pdf

论文

年份：2001 年 10 月
标题 : Echanges de Specifications Hétérogènes et Réparties
作者：泽维尔布兰克
网络链接：D:\SALIM\Docs\Thes\TheseXavier.pdf

年份 : 一月 2001
标题：面向对象软件设计模型的组成
作者：西沃恩·克拉克
网页链接：D:\SALIM\Docs\Thes\SClarkeThesis.pdf

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T08:00:58.883

当然，现在我看到您已经用 html 标记了您的问题，并且到目前为止您的代码与 html 无关。所以我假设 out.println 是 Servlet 的一些 OutputStream 并且您正在尝试输出 html。

所以 println 换行符和 "\n" 换行符仅在 html 源代码中可用。浏览器会跳过这个。

更改此行

> out.println(temp.getNodeName() + " : " + temp.getTextContent() + "\n");

至

> out.println(temp.getNodeName() + " : " + temp.getTextContent() + "< br />");

并且 servlet 应该与换行符一起输出。

# javascript - jQuery旋转功能不起作用

> ID：13616867
> 
> 赞同：0
> 
> 时间：2012-11-29T00:28:39.083
> 
> 标签：javascript, jquery, rotation

大家好，目前我正在尝试弄清楚如何旋转 div 并使其停在某个位置。我在这方面得到了一些帮助，但是我不确定我做错了什么。对代码的任何帮助都会很棒。

```
<script type="text/javascript">
var $elie = $("#super");
rotate(1);

function rotate(degree) {
$elie.css({
    WebkitTransform: 'rotate(' + degree + 'deg)'
});
$elie.css({
    '-moz-transform': 'rotate(' + degree + 'deg)'
});

if (degree < 1196) {
    timer = setTimeout(function() {
        rotate(++degree);
    }, 1);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T02:45:52.157

这是我开始工作的可重用版本。希望它可以帮助你。

```
$(function () {

    var rotateAnimation = function (props) {
        // init animation props
        var rotateEl = props.el,
            curAngle = props.startAngle,
            endAngle = props.endAngle;
        // scope angle to parent function
        var angleValue = 'rotate(' + curAngle + 'deg)';

        // define worker function
        var rotate = function () {
            // increment the angle
            curAngle += props.increment;

            // see if we are done animating
            if (curAngle >= endAngle) {
                curAngle = endAngle;
                clearInterval(timer);//stop looping

            }
            // create css value 
            angleValue = 'rotate(' + curAngle + 'deg)';
            rotateEl.css({
                '-moz-transform': angleValue,
                '-webkit-transform': angleValue,
                '-o-transform': angleValue,
                '-ms-transform':angleValue
            });
        };

        var timer = setInterval(rotate, props.delay);//let the fun begin
    };

    $('#super').on('click', function () {
        rotateAnimation({
            el: $(this),
            startAngle: 0,
            endAngle: 1234,
            delay: 1,
            increment: 3
        });
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:43:25.800

看起来它正在旋转和停止，但 1196 的值需要一段时间才能到达。这是一个关于正在发生的事情的jsfiddle。 [http://jsfiddle.net/2x3Us/](http://jsfiddle.net/2x3Us/)

html:

```
<div id="super" style="background-color: red">hello</div>​ 
```

Javascript：

```
var $elie = $("#super");
rotate(1);

function rotate(degree) {
    $elie.css({
        '-ms-transform': 'rotate(' + degree + 'deg)',
        '-webkit-transform': 'rotate(' + degree + 'deg)',
        '-o-transform': 'rotate(' + degree + 'deg)',
        '-moz-transform': 'rotate(' + degree + 'deg)'
    });

    console.log(degree);
    if (degree < 360) {
        timer = setTimeout(function() {
            rotate(++degree);
        }, 1);
    }
}​ 
```

# asp.net - 防止匿名访问 .Net Framework 4.5 中文件夹的内容

> ID：13616870
> 
> 赞同：1
> 
> 时间：2012-11-29T00:29:02.947
> 
> 标签：asp.net, asp.net-mvc, authorization, .net-framework-version

我在 ASP.Net 4.5 项目的 web.config 文件中有以下部分。

我在该文件夹中添加了几个 .doc 文件。每当我通过 VS 2012 运行项目（登录或注销）时，它允许我直接访问该文件夹中的文件。我需要保护匿名用户访问文件。

```
HTTP://localhost/Test/Test1.doc 
```

但是当 URL 是`HTTP://localhost/Test`它时，它会将我重定向到登录页面。

```
<location path="Test">
    <system.web>
      <authorization>
        <deny users="?" />
     </authorization>
    </system.web>
</location> 
```

我想知道它以前在 VS 2010 上的 .Net Framework 4 中是如何工作的。它阻止匿名用户访问文件夹的内容。

我是否错过了使用 . 网络框架 4.5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T20:17:20.047

问题在于 ASP.net 没有为 .doc 文件提供服务。

.net 不处理对这些文件的 Web 请求，因此 IIS 允许直接访问。

乔尔在类似的帖子上回答了这个问题：[这里](https://stackoverflow.com/questions/2903292/how-do-i-protect-static-files-with-asp-net-form-auhentication-on-iis-7-5)

非常感谢乔尔！

# javascript - 几个触发器没有完全工作并且代码很长

> ID：13616871
> 
> 赞同：1
> 
> 时间：2012-11-29T00:29:11.580
> 
> 标签：javascript, jquery, hide, toggle, show

我有一个包含 7 个图像框的页面，这些框是我们的客户代理的警报框，用于发送任何类型的警报。我将它们全部设置为链接，当单击该框时，该框会从橙色变​​为蓝色，并且旁边会打开一个信息框，每个图像都有自己的信息框。我让它部分工作，但它不是我想要的功能。我需要它，所以如果 box1 被打开并且用户单击 box2，box1 应该恢复为橙色并且它的信息框需要关闭，以便 box2 的信息框可以填充空间。现在，当您单击其他框时，图像框保持蓝色，如果您单击另一个图像框，我必须关闭信息框的代码就会出错。这是我的代码和 HTML 的一部分：（更新）这是我的示例的 jsbin 链接，因为它应该可以工作。但是，单击事件在我的系统上不起作用，它甚至没有尝试滚动到页面顶部，这通常在触发器中断但 href=# 存在时发生。这是我的新代码:)[JSBin](http://jsbin.com/ecelil/2/edit)

```
 //JS
  $(document).ready(function () {

        function assignClickHandlerFor(boxNum) {

            $('#a' + boxNum).click(function (evt) {

                // returning false at the end implictly does these two lines. 
                evt.preventDefault();
                evt.stopPropagation();

                var $aBox = $(evt.currentTarget); // points to the  element 
              (ie, the link) clicked. 

                // locate the div that has both the `.active` class and the `.alertBox2` class
                var $prevAlert = $('.alertBox2.active');
                $prevAlert.find('.blue').hide();
                $prevAlert.find('.orange').show();
                $prevAlert.removeClass('active');

                $('.alertDetails').hide();

                $abox.find('.blue').show();
                $abox.find('.orange').hide();
                $abox.addClass('active');

                // show the required alert.
                $('#d' + boxNum).show();
            });

        }

        var i;

        for (i = 1; i <= 7; i++) {
            assignClickHandlerFor('Box' + i);
        }

    });
  //CSS
      .alertBox2
  {
      float:left; display:block; 
   }
   .alertDetails
   {
     display:none; background-color:#fff; width:250px; height:585px; float:left;                             position:relative; left:5px; top:8px; 
      }

    //HTML 
               <div><a href="#" id="aBox1" class="alertBox2" >
                    <span class="infoBox orange">
                        <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
                    </span>
                    <span class="infoBox blue" style="display: none;">
                        <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
                    </span>
                </a>
            </div> 
            <div><a href="#" id="aBox2" class="alertBox2">
                    <span class="infoBox orange">
                        <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
                    </span>
                    <span class="infoBox blue" style="display: none;">
                        <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
                    </span>
                </a></div>                
            <div><a href="#" id="aBox3" class="alertBox2">
                    <span class="infoBox orange">
                        <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
                    </span>
                    <span class="infoBox blue" style="display: none;">
                        <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
                    </span>
                </a></div>                     
        </div>
        <p id="alertDP">Click on any Alert to the left to see details</p>

        <div class="alertDetails" id="dBox1">
                Box1
        </div>
         <div class="alertDetails" id="dBox2">
                Box2
        </div>
         <div class="alertDetails" id="dBox3">
                Box3
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:46:36.157

**编辑：**显示我对您的问题的理解的链接。[http://jsbin.com/ecelil/1/edit](http://jsbin.com/ecelil/1/edit)

一些观察，点击任何一个`aBox`只会切换它自己的`infoBox`。在单击处理程序中，`aBox2`您似乎已经注意到了这一点，并尝试通过将三个信息框选择器传递给 jQuery 来修复它。然而 jQuery 不是这样工作的。它只接受一个选择器。但是，该选择器可以匹配这三个元素。

将三个`aBox`点击处理程序的第一行替换为`$('.infoBox1, .infoBox2, .infoBox3').toggle();`

至于代码太长，好吧，`for`循环，`variables`是`css class selectors`你的朋友:)

```
$(document).ready(function () {

    function assignClickHandlerFor(boxNum) {

        $('#a' + boxNum).click(function (evt) {

            // returning false at the end implictly does these two lines. 
            evt.preventDefault();
            evt.stopPropagation(); 

            var $aBox = $(evt.currentTarget); // points to the  element (ie, the link) clicked. 

            // locate the div that has both the `.active` class and the `.alertBox2` class
            var $prevAlert = $('.alertBox2.active'); 
            $prevAlert.find('.blue').hide();
            $prevAlert.find('.orange').show();
            $prevAlert.removeClass('active');

            $('.alertDetails').hide();

            $aBox.find('.blue').show();
            $aBox.find('.orange').hide();
            $aBox.addClass('active');

            // show the required alert.
            $('#d' + boxNum).show();
        });

    };

    var i;

    for (i = 1; i <= 7; i++) {
        assignClickHandlerFor('Box'+i);
    }

});

// css

.blue-info-box {
    background-image: url('Images/blue_alert_box.jpg');
}

.orange-info-box {
    background-image: url('Images/orange_alert_box.jpg');
}

// html

<div>
    <a href="#" id="aBox1" class="alertBox2" >
        <span class="infoBox orange">
            <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
        </span>
        <span class="infoBox blue" style="display: none;">
            <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
        </span>
    </a>
</div> 
<div>
    <a href="#" id="aBox2" class="alertBox2">
        <span class="infoBox orange">
            <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
        </span>
        <span class="infoBox blue" style="display: none;">
            <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
        </span>
    </a>
</div>
<div>
    <a href="#" id="aBox3" class="alertBox2">
        <span class="infoBox orange">
            <img src="Images/orange_alert_box.jpg" alt="Orange Info Box" />
        </span>
        <span class="infoBox blue" style="display: none;">
            <img src="Images/blue_alert_box.jpg" alt="Blue Info Box" />
        </span>
    </a>
</div>

<div class="alertDetails" id="dBox1">
        Box1
</div>
 <div class="alertDetails" id="dBox2">
        Box2
</div>
 <div class="alertDetails" id="dBox3">
        Box3
</div> 
```

# java - 获取本地 Android 项目文件的文件路径

> ID：13616876
> 
> 赞同：7
> 
> 时间：2012-11-29T00:29:33.330
> 
> 标签：java, android, file

我想以编程方式访问将包含在我的项目文件夹中的特定文件。有没有办法做到这一点？如果是这样，我将文件放在我的项目文件夹中的哪个位置，以及获取其文件路径的一些简单代码是什么？

```
private void saveFileToDrive() {
        Thread t = new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    java.io.File spreadsheet = new java.io.File("Untitled spreadsheet.xlsx");
                    String filePath = spreadsheet.getAbsolutePath();
                    System.out.println("file path is"+filePath);

                    URL fileURL = getClass().getClassLoader().getResource("Untitled spreadsheet.xlsx");
                    String filePath2 = fileURL.getPath();
                    System.out.println("file path2 is"+filePath2);

                    java.io.File fileContent = new java.io.File(filePath);
                    FileContent mediaContent = new FileContent("application/vnd.ms-excel", fileContent);

                    File body = new File();
                    body.setTitle(fileContent.getName());
                    body.setMimeType("application/vnd.ms-excel");

                    File file = service.files().insert(body, mediaContent).setConvert(true).execute();

                    if (file != null) {
                        showToast("File uploaded: " + file.getTitle());
                    }
                    else
                             ;
                } catch (UserRecoverableAuthIOException e) {

                    startActivityForResult(e.getIntent(), REQUEST_AUTHORIZATION);
                } catch (IOException e) {

                    e.printStackTrace();
                }
            }
        });
        t.start();
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T00:32:48.770

将文件放在项目的根文件夹中。然后获取文件 URL、路径和其他详细信息：

```
 File file = new File("test.txt");
   String filePath = file.getAbsolutePath(); 
```

**编辑：** 替代方式（如果文件在您的类路径中，例如将文件放在“src”文件夹中，并确保在编译后将其移动到“bin”或“classes”文件夹中）：

```
 URL fileURL = getClass().getClassLoader().getResource(fileName);
  String fileName = fileURL.getFile();
  String filePath = fileURL.getPath(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:32:22.223

这在很大程度上取决于您要访问的文件类型。您可以将文件放在其中一个`assets`或适当的子目录中`res`（请参阅[/res 和 /assets 目录之间的区别](https://stackoverflow.com/questions/5583608/android-difference-between-res-and-assets-directory)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-11T01:46:53.153

因此，您想访问应用程序内部的文件；并且您想直接这样做，即从 Android 上下文（然后使用`[android.|<package_name>.]R.<resource_type>.<resource_name>`）。

对于位置，您有两种选择：`res/raw`文件夹或`assets/`文件夹（在`res`父文件夹之外）。

从[https://developer.android.com/guide/topics/resources/providing-resources.html在两个注释之间进行选择](https://developer.android.com/guide/topics/resources/providing-resources.html)

> 以原始形式保存的任意文件。要使用 raw 打开这些资源`InputStream`，请使用资源 ID 调用`Resources.openRawResource()`，即`R.raw.filename`.
> 
> 但是，如果您需要访问原始文件名和文件层次结构，您可能会考虑在`assets/`目录中保存一些资源（而不是`res/raw/`）。中的文件`assets/`没有资源 ID，因此您只能使用`AssetManager`.

要直接访问文件`res/raw/`，即从 Android 上下文（然后使用 a `[android.|<package_name>.]R.<resource_type>.<resource_name>`），您可以执行以下操作：

```
File file = new File("app/src/main/res/raw/country_data_from_world_bank.xml");
BufferedReader bufferedReader = new BufferedReader(new FileReader(file)); 
```

# google-app-engine - 在 Google App Engine 中将 HTML 文件移动到它们自己的目录（使用 Jinja2 模板）- 错误 13

> ID：13616880
> 
> 赞同：0
> 
> 时间：2012-11-29T00:30:56.443
> 
> 标签：google-app-engine, python-2.7, yaml

这看起来可能很简单，但我不能将我的 .html 文件移动到他们自己的目录中，否则网站会停止尖叫。如果留在根文件夹中，它们将工作文件。

这是我试图做的

```
<root>
|_ app.yaml
|_ main.py
|_ ...etc
|_<layout>
  |_ base.html
  |_ home.html
  |_ ...etc 
```

我在 app.yaml 文件中添加了以下内容：

```
- url: /layout
  static_dir: layout 
```

我认为这样做可以，因为没有其他东西使用该目录，我假设 HANDLERS 中的顺序无关紧要。这是我完整的处理程序部分，以防有人发现我遗漏了一些明显的东西（我承认对此没有很好的理解，尽管在这里浏览了与静态文件和目录相关的文档和其他问题）：

```
handlers:
- url: /favicon.ico
  static_files: favicon.ico
  upload: favicon.ico

- url: /layout
  static_dir: layout

- url: /stylesheets
  static_dir: stylesheets

- url: .*
  script: main.app 
```

我试过混合处理程序的顺序，但错误总是一样的：

```
IOError: [Errno 13] file not accessible: 'E:\\Users\\Steve\\Documents\\test_gae\\test\\layout\\home.html' 
```

任何建议将不胜感激，干杯

***回答，根据 voscausa 的回答：这些 HTML 文件是模板，而不是静态页面。删除“布局”的静态处理程序完全解决了这个问题。***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:27:12.117

如果您使用 Jinja2，则不需要将 /layout 文件夹放在 app.yaml 中，因为您不提供静态模板，而是使用 jinja 渲染模板并编写响应 HTML。

所以问题一定出在你的代码中。查看模板路径。

处理程序的顺序很重要。url 模式从上到下匹配。这表示

```
- url: /.*
  script: main.app 
```

永远是最后一个处理程序！！

# apache - 阻止对 root 中的 php.ini 和 phpinfo.php 的访问

> ID：13616881
> 
> 赞同：0
> 
> 时间：2012-11-29T00:31:02.737
> 
> 标签：apache, .htaccess, php, phpinfo

我读了另一个关于如何做到这一点的问题，最突出的解决方案如下：

```
<Files php.ini>
order allow,deny
deny from all
</Files> 
```

在不确定的情况下，我无法真正摆弄这个，因为我没有任何测试环境或任何东西。

我的问题是，我可以将多个文件添加到同一规则以拒绝访问吗？将其他文件添加到上述相同拒绝规则的格式是什么？

帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T12:04:46.490

[您可以根据手动输入的`<Files>`](http://httpd.apache.org/docs/2.2/mod/core.html#files), 或使用正则表达式[`<FilesMatch>`](http://httpd.apache.org/docs/2.2/mod/core.html#filesmatch)：

```
<FilesMatch "/(phpinfo\.php|php\.ini)">
    order allow,deny
    deny from all
</FilesMatch> 
```

# sql - 我想在不使用 ID 的情况下转到访问数据库的最后一条记录

> ID：13616889
> 
> 赞同：1
> 
> 时间：2012-11-29T00:32:04.367
> 
> 标签：sql, ms-access, vba, ms-access-2010

我一直在努力寻找这个。我正在使用 access 2010，我在几个表中有一些数据，我想从每个表中选择最后一行并将它们添加到新数据库中。所有数据库都有随机 ID，所以我不能使用按 ID 排序功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:46:17.537

如果表很小，您可以将其传递给前端的数据表并使用类似的东西，

```
lastRow = datatable.rows(datatable.rows.count-1) 
```

否则，您可以在数据库中添加一个“created_datetime”字段，该字段保存插入的日期时间并检索其最大日期，因为您的 ID 字段具有随机数...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:50:02.607

打开 vba (alt + F11)

```
dim rst as recordset
set rst = docmd.runsql (sql statement here) e.g. (select * from tablename)
rst.movelast 
```

你已经完成了你在 vba 中的最后一条记录

您可以使用插入语句将其添加到新的表数据库中。

# kml - Fusion Tables：多边形不显示为某些缩放级别

> ID：13616890
> 
> 赞同：3
> 
> 时间：2012-11-29T00:32:04.317
> 
> 标签：kml, google-fusion-tables, polygons

我正在制作一张地图，显示柏林（447 个街道）的不同人口统计数据。

[https://www.google.com/fusiontables/data?docid=1tIAPGaYK1iEWWLANQOupkAqCcPhVauMjdPS1qOs#map:id=3](https://www.google.com/fusiontables/data?docid=1tIAPGaYK1iEWWLANQOupkAqCcPhVauMjdPS1qOs#map:id=3)

出于某种原因，当您放大地图（12 或更高）时，不会立即显示少量多边形 (3)。

由于多边形在之前的关卡中显示，它们应该具有正确的坐标。我首先认为 shapefile（由当地统计机构提供的 kmls）可能有问题，但似乎并非如此。

谁能向我解释为什么会这样？

非常感谢！

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T03:27:39.990

我能想到的有两种可能：

1.  这是多边形的复杂性问题或缠绕方向问题。[Fusion Tables 用户组上讨论此问题的线程](https://groups.google.com/group/fusion-tables-users-group/browse_frm/thread/9e37c4238fd7346/9857a1ac5fc7b426?lnk=gst&q=polygon++complexity#9857a1ac5fc7b426)。
2.  这是瓷砖上“功能”数量的复杂性问题。[请参阅文档中的限制，它曾经被更明确地定义](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)。

反转两个问题多边形的缠绕方向似乎可以解决问题：

[https://www.google.com/fusiontables/DataSource?snapid=S787935DQC4](https://www.google.com/fusiontables/DataSource?snapid=S787935DQC4)

# sql-server - 如何使此 Access sql 语句与 Sql Server 一起使用？

> ID：13616891
> 
> 赞同：0
> 
> 时间：2012-11-29T00:32:19.370
> 
> 标签：sql-server, ms-access, join

我几乎已经用 Sql Server 替换了我们的应用程序后端，但遇到了一个问题。以下 Access 查询不适用于 Sql Server。

```
SELECT table1.*
FROM   table1
       INNER JOIN (table2
                   INNER JOIN table3
                           ON ( table2.custkey = table3.custkey )
                              AND ( table2.sequence = table3.sequence ))
               ON table1.account = table2.account
WHERE  (( LEFT(table2.keyid, 1) = 'B' ))
ORDER  BY table3.lastname & table3.firstname,
          table1.account; 
```

我已经尝试了该语句的多种变体，但未能使其发挥作用。此声明的一些帮助将帮助我修改其他一些。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:38:17.000

唯一突出的是SQL Server 中的“ `&`” 。`+`但是，在访问中也将 NULL 值视为空字符串，这需要在 SQL Server 中`&`进一步处理：`ISNULL`

```
SELECT table1.*
FROM   table1
       INNER JOIN (table2
                   INNER JOIN table3
                           ON ( table2.custkey = table3.custkey )
                              AND ( table2.sequence = table3.sequence ))
               ON table1.account = table2.account
WHERE  (( LEFT(table2.keyid, 1) = 'B' ))
ORDER  BY isnull(table3.lastname,'') + isnull(table3.firstname,''),
          table1.account; 
```

如果我要从头开始在 SQL Server 中编写查询，我可能会顺序执行连接，而不是在连接回 t1 之前在括号中执行 t2-t3。第一个字符的测试也将表示为 LIKE（个人偏好）。

```
 SELECT table1.*
    FROM table1
    JOIN table2 ON table1.account = table2.account
    JOIN table3 ON table2.custkey = table3.custkey AND table2.sequence = table3.sequence
   WHERE table2.keyid LIKE 'B%'
ORDER BY isnull(table3.lastname,'') + isnull(table3.firstname,''), table1.account; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:37:32.563

```
SELECT table1.*
FROM   table1
INNER JOIN table2  ON table1.account = table2.account
INNER JOIN table3  ON ( table2.custkey = table3.custkey ) 
                      AND ( table2.sequence = table3.sequence )
WHERE  LEFT(table2.keyid, 1) = 'B' 
ORDER  BY table3.lastname, table3.firstname, table1.account; 
```

如果您希望 where 子句适用于索引，请使用 LIKE 重写：

```
SELECT table1.*
FROM   table1
INNER JOIN table2  ON table1.account = table2.account
INNER JOIN table3  ON ( table2.custkey = table3.custkey ) 
                      AND ( table2.sequence = table3.sequence )
WHERE  table2.keyid LIKE 'B%' 
ORDER  BY table3.lastname, table3.firstname, table1.account; 
```

# d3.js - d3js 附加文本 - 过渡

> ID：13616896
> 
> 赞同：1
> 
> 时间：2012-11-29T00:32:37.207
> 
> 标签：d3.js, label, transition

我有一个简单的“有效日期标签”，我希望文本在转换时发生变化：

sorted_effective_date 是一个简单的数组：[2012 年 6 月 10 日、2012 年 6 月 25 日、2012 年 6 月 30 日等]

```
for (i = 0; i < sorted_effective_date.length; i++) {

    l.selectAll("text")
        .data(sorted_effective_date)
       .enter()
        .append("text")
        .text(sorted_effective_date[0])
        .attr('text-anchor', 'end')
        .attr('y', 15)
        .attr('x', 150)
        .attr('font-size', '25px')
        .attr('fill', '#1c3062');

    l.selectAll("text")
        .data(sorted_effective_date)
        .transition()
        .duration(1000)
        .text(sorted_effective_date[i]);

} 
```

标签的值只是保持在值 i=0，它不会改变。我错过了什么或做错了什么吗？

请注意，当我调试代码时，我确实发生了变化并且循环正常工作。

# windows - 在不安装 VS2008 的情况下下载 VC++ 2008 合并模块？

> ID：13616902
> 
> 赞同：4
> 
> 时间：2012-11-29T00:33:19.233
> 
> 标签：windows, visual-c++, deployment, dll, msvcrt

是否可以在没有 Visual Studio 的情况下下载 VC++ 2008 (CRT) 的合并模块？

我有一个旧的 Visual Studio 6 项目和一个旧的 Install Shield 安装程序。我正在使用一些依赖于 MSVCR90.DLL 的第三方 dll（在我的程序文件夹中安装 dll 不起作用，尽管我可能缺少其他一些。）

使它起作用的是在客户端计算机上手动安装 Microsoft Visual C++ 2008 Redistributable SP1 (vcredist_x86.exe)。

[我在这里](http://blogs.msdn.com/b/vcblog/archive/2007/10/12/how-to-redistribute-the-visual-c-libraries-with-your-application.aspx)读到，分发这些片段的首选方式是通过相关的合并模块。但是如果我还没有安装 VS 2008，我就找不到获取合并模块的方法！

顺便说一句，第三方 dll 确实带有他们自己的 OEM 安装程序，但它是 80 MB，我希望避免也必须分发它。vcredist_x86.exe 只有 4 MB。

# java - 谁能解决我的java代码？我无法输入第二个名字的输入。我该怎么办？

> ID：13616903
> 
> 赞同：-5
> 
> 时间：2012-11-29T00:33:23.007
> 
> 标签：java

这是代码：

```
import java.util.Scanner;
public class Array2 
{
  static Scanner input = new Scanner ( System.in );

  public static void main ( String [] args )
  {
    String [] studentNames = new String [5];
    student_Names ( studentNames );
  }

  public static void student_Names ( String [] studentNames )
  { 
    for ( int x = 0; x < studentNames.length; x++ )
    {
      System.out.printf( "\nStudent %d name : ", x+1);
      studentNames[x] = input.nextLine();
      student_Scores();
    }
  }

  public static void student_Scores ()
  {
    double [] studentScores = new double [4];
    int x;
    for ( x = 0; x < studentScores.length; x++ )
    {
      System.out.printf( "\nEnter marks for test %d: ",x+1 );
      studentScores[x] = input.nextDouble();
    }
    average_Scores( studentScores );
  }

  public static void average_Scores( double [] a )
  {
    int i;
    double sum, average;
    for ( i = 0, sum = 0; i < a.length; i++ )
    {
      System.out.printf("Marks Test %d : %.2f\n", i+1, a[i]);
    }

    for ( i = 0, sum = 0; i < a.length; i++ )
    {
      sum = sum + a[i];
    }
    average = sum / a.length;
    student_Grades ( average );
    System.out.printf("\nAverage Score : %.2f", average);
  }

  public static void student_Grades ( double b )
  {
    String c = "";
    if ( b > 0 && b < 60)
      c = "F";
    if ( b >= 60 && b < 70)
      c = "D";
    if ( b >= 70 && b < 80)
      c = "C";
    if ( b >= 80 && b < 90)
      c = "B";
    if ( b >= 90 && b <= 100)
      c = "A";
    System.out.printf("\nGrade         : %s", c);
  }
} 
```

这是执行时的输出：

```
Student 1 name : sss

Enter marks for test 1: 12

Enter marks for test 2: 23

Enter marks for test 3: 34

Enter marks for test 4: 45
Marks Test 1 : 12.00
Marks Test 2 : 23.00
Marks Test 3 : 34.00
Marks Test 4 : 45.00

Grade         : F
Average Score : 28.50
Student 2 name : 
Enter marks for test 1: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:37:43.333

您的问题可以在方法中找到`student_Names`；代替：

```
studentNames[x] = input.nextLine(); 
```

采用

```
if(x>0) input.nextLine();
studentNames[x] = input.nextLine(); 
```

您的问题来自 Java 错误地认为用户已经输入了下一个名称；`input.nextLine();`基本上把这个输入扔掉，让事物恢复到它们的自然状态。

但是，由于姓名输入对第一个学生工作正常，因此`if(x>0)`有必要使用该语句以使其仅适用于其余学生姓名。

# windows - Sencha Cmd 使用 Compass.app for Windows，PATH 是什么？

> ID：13616907
> 
> 赞同：0
> 
> 时间：2012-11-29T00:33:50.003
> 
> 标签：windows, extjs, path

Sencha Cmd 使用 Compass.app for Windows，环境变量 PATH 是什么 - 在 compass.app 中使用指南针？

背景：我们的开发团队之前通过 compass.app（windows 版本）为 PC 运行 sass。它运行良好，我们现在开始使用 ExtJS 和 Sencha Cmd 构建实用程序。

当我运行**sencha app build**时，我得到“找不到指南针”，这是因为它无法识别 PATH 中 compass.app 中存在的指南针。

问题： *有没有人有一个示例 PATH 到指南针（在 Windows 上）以供参考 - 所以我可以在 compass.app 中搜索目标？*换句话说，我知道如何设置环境变量，但是我**很难找到在 compass.app 中合理存在的 compass 等效目标**。

由于我有 compass.app 单独工作，我尝试了 sencha.cfg 设置*skip.sass=1*，但我注意到这导致没有任何 CSS 被移动到构建中。

*是否有跳过指南针但仍将 css 文件移动的设置？*

*总的来说，是否可以通过这种方式将 Sencha Cmd 与 Compass.app 一起使用？*

提前感谢您的任何提示。

纳什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:04:02.280

github 上的管理员表示，这不是 CompassApp 的现有功能，但他们正在考虑。

[https://github.com/handlino/CompassApp/issues/117](https://github.com/handlino/CompassApp/issues/117)

目前，解决方案似乎仍在为 Windows 安装 ruby​​ 和 gems。

[http://compass-style.org/install/](http://compass-style.org/install/)

# php - 将 Html + CSS 页面呈现为 PDF 而不使用 API 和库，但使用标题类型

> ID：13616908
> 
> 赞同：2
> 
> 时间：2012-11-29T00:34:01.860
> 
> 标签：php, html, css, pdf, header

我想将使用 PHP 和 CSS 生成的 Html 页面直接显示为 pdf。

我为此搜索了很多，但最终有很多库来完成这些任务。但我不想使用任何库，只想通过定义标题标签将其呈现为 PDF。

我不确定，但是内存很少，可能不使用任何 API，库可能是错误的，所以在继续另一个解决方案之前要确认。

希望可能有简单的方法来做到这一点，因为这是大多数产品最需要的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:54:58.127

首先，我建议为此使用库，因为尽管它“可能是错误的”，但它可能比您或我想出的更正确。其次，（大部分）这不是使用标题完成的；）

如果你真的想自己做，可以在[这里找到 PHP 中的原生 PDF 函数，像](http://php.net/manual/en/ref.pdf.php)[FPDF](http://www.fpdf.org/)（我个人最喜欢的）这样的库直接在它们的实现中使用。

要将页面打印为 PDF，您必须首先呈现它（创建 HTML DOM 并应用 CSS），而 PHP 不这样做。您必须首先使用 WebKit 等 HTML 引擎呈现页面，然后返回 PHP 进行打印操作。

同样，这可能应该使用库来完成，从而节省您的麻烦和调试。当然，这个问题之前已经被[问过，](https://stackoverflow.com/questions/5142080/print-a-webpage-to-pdf-document-using-php)所以有很多可用的信息。

但是如果你想自己去，那就是你必须走（或爬）的路。我，我会坐公共汽车。

* * *

**更新**

要在评论中回答您的问题：

> `<?php header("Content-type: application/pdf;charset=UTF-8"); ?>` 将其放在页面顶部会呈现 pdf，但无法以这种方式生成。那么，你能为此提出任何建议吗？

该标头用于 HTTP 请求。当请求从服务器返回时，它会发送一个标头，提示返回的内容类型（JSON、图像、pdf 等等）。

换句话说，该标题实际上并没有*生成*PDF，它只是告诉浏览器*期待*PDF。在标头之后，服务器然后发送一些东西（希望是 PDF）。

这就是为什么我说您的原始问题没有使用标题完成。

# java - 尝试从文件读取到 ArrayList 时出现索引越界异常

> ID：13616909
> 
> 赞同：0
> 
> 时间：2012-11-29T00:34:15.223
> 
> 标签：java, arraylist

我正在尝试将文件中的一系列整数读取到 ArrayList 中，但是在访问 numbers.get(0) 时，我得到了 Out of Bounds 异常，大概是因为没有任何内容写入列表。

```
ArrayList<Integer> numbers = new ArrayList<Integer>();

public void Numbers() throws IOException{

  File file = new File("Numbers.txt");
  Scanner inputFile = new Scanner(file);

  while (inputFile.hasNext()){

    numbers.add(inputFile.nextInt());
  }

    inputFile.close();
} 
```

任何帮助将不胜感激。如果需要，我可以提供更多代码片段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:39:12.663

一个可能的问题是您已将该方法声明为

```
public void Numbers() throws IOException 
```

这是一个`Numbers`返回`void`和抛出的方法`IOException`。请注意，这**不是**您可能想要的构造函数，因为您已经声明了返回类型。如果您正在调用`numbers.get(0)`同一类的另一个方法。`Numbers()`如果您希望它作为构造函数自动调用，则可能不会显式调用此方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:40:09.413

我认为它试图读取令牌`int`并出现异常。试试这个：

```
try{
   File file = new File("Numbers.txt");
   Scanner inputFile = new Scanner(file);
   while (inputFile.hasNext()){
    String next = inputFile.next();
    try{
        numbers.add(Integer.valueOf(next));
     }catch(NumberFormatException nfe){
       //not a number, ignore it
     }
   }
 }catch(IOException ioe){
      ioe.printStackTrace();
 } 
```

# python - 将 os.system 的输出发送到 Web 应用程序

> ID：13616914
> 
> 赞同：1
> 
> 时间：2012-11-29T00:34:53.317
> 
> 标签：python

我正在为机器人开发一个基于网络的控制器。当我运行类似的命令时`os.system('cd /home/tim/tmprcc/; ino build; ino upload')`，我需要能够将输出发送到 Web 应用程序。如何在 Python 中执行期间捕获输出？用户需要能够实时查看输出，因为它在我的终端上显示。

您的答案应该有每次出现一行输出时调用的 Python 代码`do_something_function(new_output)`，其中 new_output 是到目前为止生成的整个输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:07:42.433

您将要查看[子流程](http://docs.python.org/2/library/subprocess.html#subprocess.Popen)模块。

```
import subprocess

cmd = subprocess.Popen(['cd', '/home/time/tmprcc;', 'ino', 'build;',
                        'ino', 'upload;'], stdout=subprocess.PIPE)

while cmd.poll() is None:
    new_output = cmd.stdout.readline()
    do_something_function(new_output) 
```

请记住，此方法有一些注意事项。直接来自[子流程的文档](http://docs.python.org/2/library/subprocess.html#popen-objects)：

> **警告**使用communicate() 而不是.stdin.write、.stdout.read 或.stderr.read 以避免由于任何其他操作系统管道缓冲区填满并阻塞子进程而导致的死锁。

有关更多信息，请参阅[此答案](https://stackoverflow.com/a/1945380/317076)。

# jquery - (jQuery) - 单击以拖动图像但不删除原始图像

> ID：13616925
> 
> 赞同：1
> 
> 时间：2012-11-29T00:37:02.707
> 
> 标签：jquery

我正在创建某种地图编辑器，我希望能够从侧边栏中单击可用的图像，它会出现在光标下方并跟随鼠标图标，所以基本上是拖动图像，但我想要原图留在原地。

我将如何在 jQuery 中实现这一点（最好）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:55:43.933

使用 jQuery UI 试试这个：

HTML：

```
<ul>
    <li id="draggable" class="ui-state-highlight">Your Image</li>
</ul>

<ul id="sortable">
    <li class="ui-state-default">Item 1</li>
    <li class="ui-state-default">Item 2</li>
    <li class="ui-state-default">Item 3</li>
    <li class="ui-state-default">Item 4</li>
    <li class="ui-state-default">Item 5</li>
</ul>​ 
```

脚本：

```
$(function() {
    $( "#sortable" ).sortable({
        revert: true
    });
    $( "#draggable" ).draggable({
        connectToSortable: "#sortable",
        helper: "clone",
        revert: "invalid"
    });
    $( "ul, li" ).disableSelection();
});​ 
```

在这里，我还创建了小提琴[http://jsfiddle.net/aanred/b3QFN/](http://jsfiddle.net/aanred/b3QFN/)。您还可以在此处阅读文档[http://jqueryui.com/draggable/](http://jqueryui.com/draggable/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:42:51.020

我认为，jquery ui[可拖动](http://jqueryui.com/draggable/#visual-feedback)对象会帮助你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-28T22:43:07.227

这是我的解决方案，在此示例中，我正在拖动一个 div，但您可以轻松检查 img 子项，此代码可防止放入多个项目（通过取出条件轻松修改），具有可选回调参数，以便您可以对刚刚删除的对象执行某些操作（例如从 rel 属性中读取等）

```
refreshDragDrop = function(dragClassName,dropDivId, callback) {
  $( "." + dragClassName ).draggable({
    connectToSortable: "#" + dropDivId,
    helper: "clone",
    revert: "invalid"
  });
  $("#" + dropDivId).droppable({
    accept: '.' + dragClassName,
    drop: function (event, ui) {
      var $this = $(this),
        maxItemsCount = 1;
      if ($this.children('div').length == maxItemsCount ){
        //too many items,just replace
        $(this).html($(ui.draggable).clone());
      } else {
        $(this).append($(ui.draggable).clone());
      }
      if (typeof callback == "function") callback($this.children('div'));
    }
  });
} 
```

# objective-c - 为什么在启用 ARC 的情况下会出现此自动释放错误？

> ID：13616926
> 
> 赞同：1
> 
> 时间：2012-11-29T00:37:19.010
> 
> 标签：objective-c, automatic-ref-counting, autorelease

我编写了一个小型 CLI 程序来为我删除特定的 Safari cookie。在功能上它很好，但它会抛出关于对象“自动释放而没有到位池”的警告。我的项目启用了 ARC，因此我没有任何自动释放池。

这是我的代码：

```
// NSLog replacement from http://stackoverflow.com/a/3487392/1376063
void IFPrint (NSString *format, ...) {
    va_list args;
    va_start(args, format);

    fputs([[[NSString alloc] initWithFormat:format arguments:args] UTF8String], stdout);
    fputs("\n", stdout);

    va_end(args);
}

int main(int argc, const char * argv[])
{
    NSString *urlSearchString;
    if (argc > 1) {
        urlSearchString = [[NSString alloc] initWithUTF8String:argv[1]];
    }
    else {
        IFPrint(@"No URL provided, quitting.");
        return 1;
    }

    NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];

    NSString *filterString = [[NSString alloc] initWithFormat:@"domain ENDSWITH '%@'", urlSearchString];
    NSPredicate *filter = [NSPredicate predicateWithFormat:filterString];

    NSArray *matchedCookies = [cookieStorage.cookies filteredArrayUsingPredicate:filter];

    for (int i = 0; i < matchedCookies.count; i++) {
        [cookieStorage deleteCookie:[matchedCookies objectAtIndex:i]];
    }

    IFPrint(@"Removed %li cookies", matchedCookies.count);
    return 0;

} 
```

我得到的信息是：

```
objc[15502]: Object 0x107b2bf00 of class NSThread autoreleased with no pool in place - just leaking - break on objc_autoreleaseNoPool() to debug 
```

哪个出现在 Xcode 调试器中或直接运行发布二进制文件时（稍微题外话：这些消息不应该从“发布”构建中剥离吗？）。导致它的行似乎是：

```
NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage]; 
```

同样，如果我在不传递参数的情况下运行它，我会收到类似的消息：

```
objc[15630]: Object 0x100114ed0 of class __NSCFString autoreleased with no pool in place - just leaking - break on objc_autoreleaseNoPool() to debug
objc[15630]: Object 0x100114f80 of class __NSCFData autoreleased with no pool in place - just leaking - break on objc_autoreleaseNoPool() to debug 
```

这似乎来自`IFPrint`我正在使用的函数（但是`IFPrint`当我提供正确的参数时，这并没有出现）。

我在这里有点超出我的深度，谁能告诉我我在哪里（以及如何）出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:43:54.633

ARC 仍然需要一个自动释放池。诸如`[NSPredicate predicateWithFormat:filterString]`继续释放自动释放对象之类的方法（尽管由于 ARC 处理了它，您不再需要过多关注自己）。此外，您调用的任何库方法的内部实现都可能在运行时创建任意多个自动释放的对象。

您应该通过该`@autoreleasepool`机制将代码包装在自动释放池中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:40:34.347

`main`像`@autoreleasepool`这样包裹整个身体：

```
int main(int argc, const char * argv[])
{
  @autoreleasepool 
  {
    // your code
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T00:40:58.307

您需要做的就是在您的主目录中添加一个自动释放池。

```
int main(int argc, const char * argv[])
{ 
     @autoreleasepool
     {
         //Your code
     }
} 
```

# python - json.dumps 向变量添加额外 \\ 的问题

> ID：13616927
> 
> 赞同：0
> 
> 时间：2012-11-29T00:37:28.513
> 
> 标签：python, json, openstack

我目前正在开发一个 python 客户端来与我正在开发的 web 服务交谈。目前我遇到了一个问题，我的网络服务期待一个非常具体的格式化请求，但是当我通过 json.dumps 发送我的请求时，它添加了额外的 \ 导致我的网络服务失败。

这是一个问题的例子，只是在 python 中输入了一些代码：

```
>>> import json
>>> body = {}
>>> body['hosts'] = '["cso22"]'
>>> print json.dumps(body)
{"hosts": "[\"CSO22\"]"} 
```

所以现在不是 body['hosts'] 等于 '["CSO22"]' 它等于 '[\\"CSO22\\"]' 这不是我的网络服务所期望的，所以它返回 http 错误 400。有吗一种改变这种行为的方法，以便 json.dumps 将返回我需要的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:40:26.230

删除周围的单引号`'["CSO22"]'`以创建一个数组：

```
body = {'hosts': ["CSO22"]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T00:40:51.060

如果这应该是一个包含 1 个元素的列表，即 string `"CSO22"`，则删除单引号。

```
>>> body = {'hosts': ["CSO22"]}
>>> print json.dumps(body)
{"hosts": ["CSO22"]} 
```

# indexing - 如何从 sphinx.yml 文件中声明所有 Sphinx 增量索引？

> ID：13616933
> 
> 赞同：1
> 
> 时间：2012-11-29T00:37:42.223
> 
> 标签：indexing, thinking-sphinx, delta

而不是在每个模型文件中重复这一行：

```
set_property :delta => true 
```

...我想从 /config/sphinx.yml 文件中声明所有增量索引，如下所示：

```
delta:
  model1: true
  model2: true
  model3: true 
```

这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:52:31.293

对不起，突然，但不，那是不可能的。设置增量索引的唯一位置是在每个索引定义中。

# google-maps-api-3 - Google Maps API V3：将标记坐标传递给谷歌方向服务请求

> ID：13616934
> 
> 赞同：0
> 
> 时间：2012-11-29T00:37:46.173
> 
> 标签：google-maps-api-3, driving-directions

用户使用向我的地图添加标记的 Google 地点 API 搜索我的地图。我在每个标记信息窗口内都有一个单击事件，以获取到该标记的方向。 **如何将所选标记的坐标传递给我的 google 路线服务请求？**

到目前为止，我声明`var placeLoc = null;`为一个全局变量。我`placeLoc=place.geometry.location;`在我的创建标记函数中定义。然后我有：

```
function calcRoute() {
 var start = myLatLng;
 var end = placeLoc;
 var request = {
    origin: start,
    destination: end,
    travelMode: google.maps.DirectionsTravelMode.BICYCLING
 };
 directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);
    }
 });
} 
```

该函数将方向呈现到错误的标记。我猜它只是为搜索后返回的数组中的第一个标记提供方向，而不是我选择的实际标记。我如何提供路线请求选定标记的坐标？

下面是将搜索结果放入 place 变量的代码：

```
 google.maps.event.addListener(searchBox, 'places_changed', function() {
     var places = searchBox.getPlaces();
     // alert("getPlaces returns "+places.length+" places");

    for (var i = 0; i < gmarkers.length; i++) {
         gmarkers[i].setMap(null);
    }

    gmarkers = [];
    var bounds = new google.maps.LatLngBounds();

    for (var i = 0, place; place = places[i]; i++) {
       var place = places[i];
       createMarker(place);
       bounds.extend(place.geometry.location);
    }
    map.fitBounds(bounds);
    // if (markers.length == 1) map.setZoom(17);
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:16:30.980

像这样的东西？

```
function createMarker(options) {
  var marker = new google.maps.Marker(options);

  google.maps.event.addListener(marker, 'click', function() {
    placeLoc = marker.getPosition();
    calcRoute();
  });

  return marker;
} 
```

# jquery - 在 iOS 中打开 HTML 选择元素时是否会触发 DOM 事件？

> ID：13616936
> 
> 赞同：1
> 
> 时间：2012-11-29T00:37:51.037
> 
> 标签：jquery, ios, html-select

我希望在 iOS 设备上打开选择菜单后立即启动一些 jQuery（你知道，当漂亮的“鼓”从屏幕底部向上滑动时）。

我已经搜索了该站点，但在此找不到任何内容。如果有人知道上述事件，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T00:49:06.410

试试[`.focus`](http://api.jquery.com/focus/)。我设置了[一个基本的小提琴示例](http://jsfiddle.net/8sSUm/)，它适用于装有 iOS 6 的 iPhone 4S。

# r - 基于向量子集索引数据帧

> ID：13616938
> 
> 赞同：6
> 
> 时间：2012-11-29T00:37:59.230
> 
> 标签：r, dataframe, subset

我有一个非常大的数据框，我想根据向量的某个子集保存一个子集。简而言之，我有这样的事情：

```
> id<-c("ID1","ID2","ID2","ID3","ID4","ID4","ID4","ID4","ID4")
> status<-c("flag","flag","none","none","flag","flag","flag","none","flag")
> misc1ofmany<-c("etc1","etc2","etc3","etc4","etc5","etc6","etc7","etc8","etc9")
> df = data.frame(id, status, misc1ofmany) ; df
   id status misc1ofmany
1 ID1   flag        etc1
2 ID2   flag        etc2
3 ID2   none        etc3
4 ID3   none        etc4
5 ID4   flag        etc5
6 ID4   flag        etc6
7 ID4   flag        etc7
8 ID4   none        etc8
9 ID4   flag        etc9 
```

我想要所有已标记的 ID 行，包括它们的未标记会话。现在我正在尝试通过 grep 获取其他 ID 的索引并将其插入新的 df 中。实际上，当我写这篇文章时，我发现 grepl 可能更容易使用：

```
> flaggedIDs <- unique(as.vector(df$id[grep("flag",df$status)]))
> flaggedIDs.allStats.Index <- mapply(grepl,df$id,MoreArgs=list(x=flaggedIDs)) 
> flaggedIDs.allStats.Index
      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
[1,]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[2,] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
[3,] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE 
```

但是我只想到这里：

```
> flaggedIDsdf <- df[flaggedIDs.allStats.Index] ; flaggedIDsdf
   id status misc1ofmany
1 ID1   flag        etc1
2 ID2   flag        etc2
3 ID2   none        etc3
4 ID4   flag        etc5
5 ID4   flag        etc6
6 ID4   flag        etc7
7 ID4   none        etc8
8 ID4   flag        etc9 
```

我觉得这应该比我想象的要简单，但是我尝试了多种可能性来解决这个问题，但无济于事。写出这个问题有助于这在我脑海中成为一个更清晰/更简单的问题（看起来我现在只是错过了一步），但现在我也想知道是否有更有效的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T00:50:26.177

`data.table`在这里非常有用，因为它优雅的语法和内存效率

```
library(data.table)

DT <- data.table(df)

setkey(DT, 'id')

DT[DT[status=='flag', list(id = unique(id))]]

    id status misc1ofmany
1: ID1   flag        etc1
2: ID2   flag        etc2
3: ID2   none        etc3
4: ID4   flag        etc5
5: ID4   flag        etc6
6: ID4   flag        etc7
7: ID4   none        etc8
8: ID4   flag        etc9 
```

或者更紧凑

```
DT[J(unique(id[status=='flag']))] 
```

`i`上面这两种方法使用了组件首先由 评估的事实`data.table`。通过键控，我们可以进行`id`自连接以仅提取.`ids``status=='flag`

* * *

或者，使用`by`

```
DT[,if(any(status=='flag')){.SD} ,by=id] 
```

这通过`DT`by的子集`id`，并返回`.SD`（子集的 data.table） if `any(status=='flag')`（在该子集中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:50:03.900

这似乎有效：

```
df[df$id %in% df$id[df$status == "flag"],] 
```

普通英语：从数据框中，选择 id 元素在任何行中标记状态的 id 元素向量中的每一行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T00:43:06.217

我相信您正在尝试做的事情可能会在一行中处理

```
df[which(df$id %in% df$id[df$status=="flag"]), ] 
```

结果：

```
 id status misc1ofmany
1 ID1   flag        etc1
2 ID2   flag        etc2
3 ID2   none        etc3
5 ID4   flag        etc5
6 ID4   flag        etc6
7 ID4   flag        etc7
8 ID4   none        etc8
9 ID4   flag        etc9 
```

# java - 如何存储 Android 应用数据？

> ID：13616944
> 
> 赞同：1
> 
> 时间：2012-11-29T00:39:18.770
> 
> 标签：java, android, csv, export-to-csv

我开发了一个 android 应用程序，其中我使用了**意图类**并合并了四个应用程序：

1.  '与 xy 取得坐标' 此应用程序是 ontouchactivity 应用程序
2.  'Wi-Fi 扫描仪'
3.  二维码扫描仪
4.  '相机'

我想以一种**.CSV**格式存储所有四个应用程序的结果。我在编写 Java 代码时遇到了一些问题。

我可以在主 Java 文件中编写代码还是必须为此创建另一个类？

请给我一个建议。

# facebook - 访问 Facebook 上的用户页面以只读方式

> ID：13616948
> 
> 赞同：1
> 
> 时间：2012-11-29T00:39:52.697
> 
> 标签：facebook, api, permissions

在 Facebook 上，除了 manage_pages 之外，是否还有其他权限允许访问用户的页面但无法管理或修改它们？

我所需要的只是获取用户页面及其属性的列表，如果可能的话，我不希望请求比我真正需要的更多的权限。

# python - 是否有更短的语法可以使用 psycopg2 将值插入到 postgres 表中？

> ID：13616952
> 
> 赞同：3
> 
> 时间：2012-11-29T00:40:25.957
> 
> 标签：python, postgresql, psycopg2

我正在尝试使用 psycopg2 和 Python 2.7 将许多列插入到表行中。有没有办法缩短 INSERT 语法？我目前必须一遍又一遍地输入占位符 (%s)，例如 VALUES(%s,%s,%s,...%s)

编辑：目前我有

```
tableCursor.execute('INSERT INTO "table" ("x1","x2","x3","x4")' +
            'VALUES (%s,%s,%s,%s)', (val1,val2,val3,val4)) 
```

我想使用的不仅仅是占位符，但继续输入 %s 有点重复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T05:07:57.487

没有。

如果您有足够的列这是一个问题，那么 (a) 您可能需要重新考虑您的架构设计，并且 (b) 您始终可以使用`', '.join(['%s']*n)`where`n`是参数的数量来生成字符串。

```
>>> ', '.join(['%s']*7)
'%s, %s, %s, %s, %s, %s, %s'

>>> 'INSERT INTO tablename(col1,col2,col3,col4,col5,col6,col7) VALUES (' + ', '.join(['%s']*7) + ');'
'INSERT INTO tablename(col1,col2,col3,col4,col5,col6,col7) VALUES (%s, %s, %s, %s, %s, %s, %s);' 
```

我同意如果您没有明确给出它，那么根据命名的列数`psycopg`自动推断列表会很好。`VALUES`但是，它没有，而且很容易DIY。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T11:00:46.980

这也有效：

```
tableCursor.execute('INSERT INTO "table" ("x1","x2","x3","x4")' +
            'VALUES %s', [(val1,val2,val3,val4)]) 
```

元组通过递归调整其参数并放在括号中进行调整，因此它们很适合表示 IN 的记录、复合类型或值列表。

# audio - A-Law波形文件转换源码

> ID：13616957
> 
> 赞同：0
> 
> 时间：2012-11-29T00:40:36.957
> 
> 标签：audio, file-conversion

我需要将 A-Law 压缩文件转换为常规的非压缩 PCM。有没有我可以看的源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:16:37.467

查看[AlawCodec.java](http://www.docjar.com/html/api/com/sun/media/sound/AlawCodec.java.html "AlawCodec.java")。有趣的事情是在初始化解码表的类的静态块和`read`方法中。

# tomcat - Tomcat 作为 Windows 服务：使用 JRE 重新分发 Tomcat

> ID：13616958
> 
> 赞同：0
> 
> 时间：2012-11-29T00:40:42.987
> 
> 标签：tomcat, tomcat7

我需要使用 JRE 在 Tomcat 7 上分发我的 webapp，并在他们自己的机器上覆盖（如果客户有）JAVA_HOME 设置。我需要能够将 tomcat 安装为 Windows 服务并启动/停止它。我无法使用 service.bat 将 tomcat 安装为 Windows 服务。它需要 JDK，JRE 不起作用。我将 JAVA_HOME 设置为指向 JRE，但它不起作用。有没有办法在不使用 JDK 的情况下安装服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:54:18.663

*   设置 JRE_HOME 指向 JRE。
*   取消设置 JAVA_HOME
*   调用service.bat

# javascript - 如何捕获 WebSocket 连接中断？

> ID：13616960
> 
> 赞同：11
> 
> 时间：2012-11-29T00:40:46.627
> 
> 标签：javascript, websocket

在 Firefox 中（至少），如果您按 ESC，它将关闭所有打开的 WebSockets 连接。我需要捕获该断开连接并在它再次可用时尝试重新连接。

这是我尝试实现的代码示例，但我想不出的任何东西都无法捕捉到错误并允许我优雅地处理它。

看看代码：http: [//jsfiddle.net/w5aAK/](http://jsfiddle.net/w5aAK/)

```
var url = "ws://echo.websocket.org";
    try {
        socket = window['MozWebSocket'] ? new MozWebSocket(url) : new WebSocket(url);
        socket.onopen = function(){
            console.log('Socket is now open.');
        };
        socket.onerror = function (error) {
            console.error('There was an un-identified Web Socket error');
        };
        socket.onmessage = function (message) {
            console.info("Message: %o", message.data);
        };
    } catch (e) {
        console.error('Sorry, the web socket at "%s" is un-available', url);
    }

setTimeout(function(){
    socket.send("Hello World");
}, 1000); 
```

打开控制台并观察输出。

我在这里做错了什么，还是因为连接超出了 JS 脚本的范围而无法运行？

任何输入都会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T07:46:50.997

您可以将处理程序附加到`socket.onclose`事件。当您按下 ESC 并中断连接时，它将被调用。

见：http: [//jsfiddle.net/w5aAK/1/](http://jsfiddle.net/w5aAK/1/)

您目前无法解决的一个问题是输出到控制台的中断错误。恐怕目前无法捕捉到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-18T09:08:12.657

你不能抓住它，这不是你的错。这是火狐的错误。在这里投票：

[https://bugzilla.mozilla.org/show_bug.cgi?id=712329](https://bugzilla.mozilla.org/show_bug.cgi?id=712329)

**我个人尝试了各种解决方案：**

事件处理程序 onunload onbeforeunload onclose try..catch 一些 js 错误处理 3rd 方服务等。

您可以登录控制台以控制您的套接字，它在卸载之前已关闭，但 FF 认为不同.. :(

**解决方案（不直接回答答案*，*但它有效）：**

这是一个错误，因此您无法捕获，但此信息不是*解决方案*。经过各种疯狂的解决方法并试图抓住那个错误，我终于发现这个工作正常。如果您使用 socket.io 与 WebScotets 一起工作，它可以与不同的传输技术一起工作。xhr-polling 适用于 Firefox。

```
if (/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)) { //test for Firefox/x.x     or Firefox x.x (ignoring remaining digits);
    socket = io.connect('//' + node_server + '/', {
        transports: ['polling']
    });
} else {
    socket = io.connect('//' + node_server + '/');
} 
```

什么帮助了我 - 也可能帮助你：

[Node.js/Socket.io 对旧版浏览器的 Web Socket 支持](https://stackoverflow.com/questions/19903646/web-socket-support-in-node-js-socket-io-for-older-browser)

[在客户端定义传输类型](https://stackoverflow.com/questions/7016144/define-transport-types-on-the-client-side)

[socket.io 不适用于传输：['xhr-polling']](https://stackoverflow.com/questions/28837558/socket-io-doenst-work-with-transports-xhr-polling)

# java - 如何访问 HTTP Basic 用户名？

> ID：13616963
> 
> 赞同：3
> 
> 时间：2012-11-29T00:40:54.797
> 
> 标签：java, jersey, jax-rs

我正在使用这个 ContainerRequestFilter 来检查 HTTP 基本凭据。

```
private class Filter implements ResourceFilter, ContainerRequestFilter {

    @Override
    public ContainerRequest filter(ContainerRequest request) {
        String auth = request.getHeaderValue("Authorization");

        if (auth == null || !auth.startsWith("Basic ")) {
            throw new NotAuthorizedException("FAILED\n");
        }

        auth = Base64.base64Decode(auth.substring("Basic ".length()));
        String[] vals = auth.split(":");
        String username = vals[0];
        String password = vals[1];

        boolean validUser = database.Users.validate(username, password);

        if (!validUser) {
            throw new NotAuthorizedException("FAILED\n");
        }

        return request;
    }

    ...

} 
```

因此，当我到达这一点时，我已经对用户进行了身份验证。现在我怎样才能得到用户名？

```
@GET
@Path("some_kind_of_report_or_something")
@Produces(MediaType.TEXT_PLAIN)
public String fetchAReportOrSomething() {
    // At this point, I know that the user has provided good credentials,
    // now I need get the user's username as a String
    String username = ???;
} 
```

我想我可以使用 HttpContext.getRequest() 并做与 AuthFilter 中相同的事情（我会将用户名/密码提取逻辑移到它自己的方法中）。在过滤器中，我能否以某种方式将提取的用户名存储在请求对象中的某个位置，以便将其传递给该处理程序？

（顺便说一句，有没有比我在过滤器中所做的更好的方法来提取用户名和密码？如果有，请在评论中告诉我。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T01:02:11.340

这篇博文应该能启发你： http: [//plaincode.blogspot.pt/2011/07/openid-authentication-example-in-jersey.html](http://plaincode.blogspot.pt/2011/07/openid-authentication-example-in-jersey.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T07:31:48.057

看看它是如何在工作应用程序中完成的：[www.s3auth.com](http://www.s3auth.com)。源代码可在[github](https://github.com/yegor256/s3auth/tree/master/s3auth-rest)获得。正如您在网站上看到的，使用了 facebook 和 google 身份验证机制。该应用程序正在使用 JAX-RS/Jersey。

# r - 如何通过数据框中的因素用 LOCF 填充 NA，按国家/地区划分

> ID：13616965
> 
> 赞同：20
> 
> 时间：2012-11-29T00:41:08.127
> 
> 标签：r, dataframe, missing-data, r-factor

我有以下数据框（简化），其中国家变量作为一个因素，值变量有缺失值：

```
country value
AUT     NA
AUT     5
AUT     NA
AUT     NA
GER     NA
GER     NA
GER     7
GER     NA
GER     NA 
```

下面生成上述数据框：

```
data <- data.frame(country=c("AUT", "AUT", "AUT", "AUT", "GER", "GER", "GER", "GER", "GER"), value=c(NA, 5, NA, NA, NA, NA, 7, NA, NA)) 
```

现在，我想使用最后一次观察结转方法 (LOCF) 替换每个国家/地区子集中的 NA 值。我知道**zoo**包`na.locf`中的命令。会给我以下数据框：**`data <- na.locf(data)`**

 **```
country value
AUT     NA
AUT     5
AUT     5
AUT     5
GER     5
GER     5
GER     7
GER     7
GER     7 
```

但是，***该函数只能用于由 country 拆分的各个子集***。以下是我需要的输出：

```
country value
AUT     NA
AUT     5
AUT     5
AUT     5
GER     NA
GER     NA
GER     7
GER     7
GER     7 
```

我想不出一个简单的方法来实现它。在开始使用 for 循环之前，我想知道是否有人知道如何解决这个问题。

非常感谢！！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-09-19T22:51:12.823

解决方案的现代版本`ddply`是使用包`dplyr`：

```
library(dplyr)
DF %>%
  group_by(county) %>% 
  mutate(value = na.locf(value, na.rm = F)) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-29T01:07:15.110

这是一个`ddply`解决方案。尝试这个

```
library(plyr)
ddply(DF, .(country), na.locf)
  country value
1     AUT  <NA>
2     AUT     5
3     AUT     5
4     AUT     5
5     GER  <NA>
6     GER  <NA>
7     GER     7
8     GER     7
9     GER     7 
```

**编辑** 从`ddply`帮助您可以找到

```
.variables:  variables to split data frame by, 
as quoted variables, a formula or character vector. 
```

所以获得你想要的另一种选择是：

```
ddply(DF, "country", na.locf)
ddply(DF, ~country, na.locf) 
```

请注意，不允许替换为，这就是您在执行此操作时出错的原因`.variables`。`DF$variable`

`DF`是你的data.frame

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-01-13T02:54:53.637

tidyverse 方式，尽管不使用 locf，是：

```
library(tidyverse)

data %>% 
    group_by(country) %>% 
    fill(value)

Source: local data frame [9 x 2]
Groups: country [2]

country value
(fctr) (dbl)
1     AUT    NA
2     AUT     5
3     AUT     5
4     AUT     5
5     GER    NA
6     GER    NA
7     GER     7
8     GER     7
9     GER     7 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-29T01:03:15.223

在子集上拆分`data.frame`with`by`和 use `na.locf`：

```
do.call(rbind,by(data,data$country,na.locf)) 
```

如果您想删除行名：

```
do.call(rbind,unname(by(data,data$country,na.locf))) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-29T10:07:08.937

如果考虑速度，那么这个`unstack`/`stack`解决方案比我系统上的其他解决方案快 4 到 6 倍，尽管它确实需要稍长的代码行：

```
stack(lapply(unstack(data, value ~ country), na.locf, na.rm = FALSE)) 
```

另一种方法是：

```
transform(data, value = ave(value, country, FUN = na.locf0)) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-19T22:19:18.557

您只需按国家/地区拆分，然后执行[zoo::na.locf()](http://www.inside-r.org/packages/cran/zoo/docs/na.locf)或 na.fill，向右填充。这是一个明确显示 na.fill 的三分量 arg 语法的示例：

```
library(plyr)
library(zoo)

data <- data.frame(country=c("AUT", "AUT", "AUT", "AUT", "GER", "GER", "GER", "GER", "GER"), value=c(NA, 5, NA, NA, NA, NA, 7, NA, NA))

# The following is equivalent to na.locf
na.fill.right <- function(...) { na.fill(..., list(left=NA,interior=NA,right="extend")) }

ddply(data, .(country), na.fill.right)

  country value
1     AUT  <NA>
2     AUT     5
3     AUT     5
4     AUT     5
5     GER  <NA>
6     GER  <NA>
7     GER     7
8     GER     7
9     GER     7 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-27T16:01:42.287

我对这次谈话有点晚了，但这里有一种`data.table`方法，对于更大的数据集会更快：

```
library(zoo)
library(data.table)

# Convert to data table
setDT(data)

data[, value := na.locf(value, na.rm = FALSE), by = country]

data
   country  value
1:     AUT     NA
2:     AUT      5
3:     AUT      5
4:     AUT      5
5:     GER     NA
6:     GER     NA
7:     GER      7
8:     GER      7
9:     GER      7

# And if you want to convert "data" back to a data frame...
setDF(data) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-08T03:37:59.380

**dplyr**和**imputeTS**包的组合可以完成这项工作。

```
library(dplyr)
library(imputeTS)
data %>% group_by(country) %>% 
mutate(value = na.locf(value, na.remaining="keep")) 
```

使用 imputeTS 的 na.locf 函数的 na.remaining 参数，**您**还可以选择如何处理尾随的 NA。

这些是选项：

*   "keep" - 返回带有 NA 的系列
*   "rm" - 删除剩余的 NA
*   "mean" - 用整体平均值替换剩余的 NA
*   "rev" - 从相反方向执行 nocb / locf

例如，通过选择“平均值”，您将在特定示例中为每个 GER 获得 7 的结果。**

# ruby - MongoMapper 中 push_uniq 的奇怪行为

> ID：13616966
> 
> 赞同：0
> 
> 时间：2012-11-29T00:41:18.033
> 
> 标签：ruby, mongodb, mongomapper

在 Ruby 中，我使用 MongoMapper 进行了以下测试：

```
test = (push_uniq @a.id, title: 'test')
puts test.class
puts test.to_s 
```

结果我得到：

```
Fixnum
136 
```

为什么是 136？

任何人？

# android - 如何处理 HTMLCleaner 中的标签？

> ID：13616976
> 
> 赞同：0
> 
> 时间：2012-11-29T00:42:47.387
> 
> 标签：android, htmlcleaner

使用 HTMLCleaner 解析时，所有“br”标签都将被忽略。我想知道如何处理“br”标签。

这是一个例子：

```
<p>El tenista suizo <b>Roger Federer</b>, número dos del mundo.<br><br>
"Quiero todavía seguir ganando títulos, por eso deseo mantenerme al tope de mi capacidad
física porque quiero seguir jugando varios años más. Aspiro a seguir en el centro
de las canchas jugando Grand Slams", aseguró el suizo en entrevista con Caracol radio.<br><br></p> 
```

输出是被清理的 br 标签。

有任何想法吗？请我需要帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T02:00:46.937

通常在 XHTML 语法中，“br”标签是写的`<br/>`，而不是`<br>`

也许清洁工无法识别写成的标签`<br>`并清理它们。

希望能帮助到你

# encryption - 除了md5还有哪些php密码加密功能？

> ID：13616981
> 
> 赞同：0
> 
> 时间：2012-11-29T00:43:07.523
> 
> 标签：encryption, passwords

我一直在互联网上寻找有关如何为网站制作登录页面的信息，并且遇到了用于密码加密的 md5 功能，以及用于密码的盐。我查了md5，发现有不少页面说md5不安全，黑客可以破解它。php中的其他加密功能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:56:21.800

这是 PHP 内置的哈希函数列表

[http://www.php.net/manual/en/function.hash-algos.php](http://www.php.net/manual/en/function.hash-algos.php)

# r - 在不知道有多少列的情况下跳过 read.table 中的列

> ID：13616985
> 
> 赞同：1
> 
> 时间：2012-11-29T00:43:25.383
> 
> 标签：r

所以我知道你可以通过为 colClasses 向量提供一个 NULL 来跳过带有 read.table 的列，但这通常只有在你知道表中有多少列时才有用。

如果我想跳过表的前 2 列但阅读所有其余列（我知道是数字）怎么办。就像是：

```
colClasses = c(NULL,NULL,rep("numeric", k)) 
```

除了我不知道 k 是什么。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:51:45.553

如果您在名为“fil.txt”的文件上使用默认的空格分隔，则使用此

```
 colClasses = c(NULL,NULL,rep("numeric", count.fields("fil.txt")[1] -2 )) 
```

如果您使用不同的分隔符，那么类似

```
 colClasses = c(NULL,NULL,rep("numeric", count.fields("fil.txt", sep=",")[1] -2 )) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-22T14:12:41.380

跳过前两列的简单方法：

```
data <- read.table("dataname.csv", header = TRUE, sep = ",")[,-c(1,2)] 
```

# java - 带有 javascript 的 HttpClient

> ID：13616986
> 
> 赞同：0
> 
> 时间：2012-11-29T00:43:32.183
> 
> 标签：java, apache-httpclient-4.x

我想做一个请求并从动态网站获得响应，如果我使用普通浏览器（如 chrome）执行此操作并查看源代码，这将显示所有文本（无 javascripts），但如果我尝试执行 wget 或 HttpClient 我得到用 javascripts 响应，没有文本。

文本是动态的，那么我如何才能收到最终的源代码（带有文本）？

请，如果不清楚，请按照以下步骤操作：

1 - 转到[http://www.stj.jus.br/webstj/processo/Justica/detalhe.asp?numreg=201201911000&pv=010000000000&tp=51](http://www.stj.jus.br/webstj/processo/Justica/detalhe.asp?numreg=201201911000&pv=010000000000&tp=51)

2 - 检查元素并查看 detalhe.asp 的源代码

3 - 打开终端并使用 wget 获取此页面

现在你能看出区别了吗？

---- 编辑 ---- 如果有帮助，我尝试使用 HttpClient 执行此操作：

```
private static InputStream getPageSource(String url)  {
    InputStream inputStream = null;
    try {
            HttpClient httpclient = new DefaultHttpClient();
            HttpResponse response = httpclient.execute(new HttpGet(url));
            StatusLine statusLine = response.getStatusLine();
            if(statusLine.getStatusCode() == HttpStatus.SC_OK){
                ByteArrayOutputStream out = new ByteArrayOutputStream();
                response.getEntity().writeTo(out);
                out.close();
                String responseString = out.toString();
                //..more logic
                System.out.println(responseString);

                inputStream = response.getEntity().getContent();
            } else{
                //Closes the connection.
                response.getEntity().getContent().close();
                throw new IOException(statusLine.getReasonPhrase());
            }
    } catch (Exception e) {
        e.printStackTrace();
    }

    return inputStream;
} 
```

---- EDIT 2 ---- 我完成了这项工作，将一个字段放在标题中：Referer

如果我在执行 httpclient 之前输入此行： get.setHeader("Referer", "http://www.stj.jus.br/webstj/processo/Justica/pagina_lista.asp"); 一切正常..所以，现在的问题是：

如何自动从 HttpClient 获取此参数（Referer）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T21:23:31.803

我正在研究一个类似的问题，我不断遇到的答案是尝试[http://htmlunit.sourceforge.net/](http://htmlunit.sourceforge.net/) 它嵌入了一个 javascript 引擎。根据您的环境，[Selenium](https://code.google.com/p/selenium/)的缺点是它需要安装浏览器才能与之交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:12:19.750

抱歉，我的问题是安全性，出于安全原因，REFERER 必须设置为“http://www.stj.jus.br/webstj/processo/Justica/pagina_lista.asp”，所以重定向或像这样的任何东西，只是安全。

在我看不到这个之前，我发布了这个问题。

谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T02:01:02.663

Wget 不执行浏览器的角色，因为它不解释和执行 javascript。它只是请求特定 URL 的资源并将其保存到文件中。如果您还想加载内容，那么您将需要访问 javascript 引擎。您可能想查看使用具有接口的[Selenium 。](https://code.google.com/p/selenium/)`JavascriptExecutor`

# java - 如何使用 Java 发送 HTTP GET 并使用 C++ 编写的 CGI 应用程序打印 QUERY_STRING 环境变量？

> ID：13616992
> 
> 赞同：0
> 
> 时间：2012-11-29T00:44:09.490
> 
> 标签：java, c++, http, cgi, environment-variables

我有一个使用 GET 方法启动 HTTP 连接的 Java 程序。它看起来像这样：

```
String urlString = "http://10.205.110.250/cgiApp?envVariable";
URL url = new URL(urlString);
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setRequestMethod("GET"); 
```

我知道这段代码确实有效，但这就是它变得棘手的地方......我有一个用 C++ 编写的 CGI 应用程序，看起来像这样：

```
int main() {
    char* url = getenv("QUERY_STRING");
    int pipe = open(PATH_TO_FIFO, O_WRONLY);
    write(pipe,url,256);
    close(pipe);
    return 0;
} 
```

还有一个运行以接收 QUERY_STRING 并将其打印出来的程序：

```
int main () {
    char url[256];
    int pipe;
    pipe = open(PATH_TO_FIFO, O_RDONLY);
    read(pipe,url,256);
    close(pipe);
    cout << url << endl;
    return 0;
} 
```

当我在浏览器中键入 HTTP 请求时，我已经确认 C++ 应用程序可以正常工作。例如，如果我输入

```
http://10.205.110.250/cgiApp?envVariable 
```

进入浏览器，并且接收程序正在运行，它将打印出“envVariable”

但是，当我运行 Java 程序时，它要么打印出乱码，要么什么都不打印（但仍然返回）。从我所做的初步研究来看，Java String 变量可能与 C++ 不兼容，或者它的编码方式不同。所以我的问题是，为什么我的 C++ 程序在从 Java 程序发送时不能打印出“envVariable”，但从浏览器发送时可以，我该如何修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:11:34.777

您的 CGI 脚本对于它是从 Java 调用、被浏览器访问还是以其他方式访问一无所知——它应该只知道“嘿，我收到了一个 HTTP GET 请求”。它与Java类型的*编码*无关。`String`

阅读[URLConnection](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html)的文档，需要`connect()`在打开连接并设置请求类型后调用该方法。运行 CGI 脚本时很可能会出现乱码，因为它指向一些未初始化的内存块。您可以使用 Wireshark 或 Charles Proxy 之类的工具来查看实际的 HTTP 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T01:11:37.130

您的网络浏览器可能正在发送额外的标头和/或接受/解码来自 CGI 应用程序的输出。如果您在 java 程序（和您的浏览器）和 CGI​​ 应用程序之间插入一个调试代理，您可以看到每个程序发送的内容以及来自 CGI 应用程序的响应。

# objective-c - 在幕后发送电子邮件

> ID：13616993
> 
> 赞同：2
> 
> 时间：2012-11-29T00:44:21.087
> 
> 标签：objective-c, ios, xcode, mfmailcomposer

我目前正在尝试弄清楚如何在幕后发送电子邮件。基本上，我不希望 MFMailComposeViewController 弹出让我按下发送按钮。所有字段均已预先填充，因此无需输入任何内容。这可能吗？我必须使用另一个框架吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T00:55:35.940

您必须使用自己的邮件服务器（或要求用户提供他们自己的凭据，您可能不想这样做）。iOS SDK 故意不允许您在没有用户界面的情况下代表用户发送电子邮件；让用户按下“发送”是整个想法，这样他们就不会感到惊讶。

自动推送电子邮件的应用程序要么从它们自己的服务器执行此操作，要么与提供此功能的服务器框架（如 Mailgun、Parse 等）集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-27T20:23:46.187

我已经在我的一个使用 Mailgun 的应用程序中做到了这一点，Mailgun 是一个托管的电子邮件网络服务。

# java - NetBeans 或 Eclipse 等效于 jGrasp 的调试对象查看器？

> ID：13616996
> 
> 赞同：3
> 
> 时间：2012-11-29T00:44:52.940
> 
> 标签：java, eclipse, netbeans, ide, jgrasp

Jgrasp 有一个非常酷的调试查看器：[http ://www.jgrasp.org/viewers.html](http://www.jgrasp.org/viewers.html)

无需任何设置，您就可以看到您的对象在视觉上是如何交互的。使用链表非常方便。

但是，总的来说，我讨厌 jGrasp。Netbeans 或 Eclipse 有类似的东西吗？我进行了多次搜索，结果一无所获。这太糟糕了....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T02:20:31.837

我认为，你会得到最接近的东西是 Jive：[http ://www.cse.buffalo.edu/jive/](http://www.cse.buffalo.edu/jive/)

它是 Eclipse 的插件。有关安装说明，请参见那里：[http ://www.cse.buffalo.edu/jive/download.html](http://www.cse.buffalo.edu/jive/download.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-09T20:16:34.187

如果有人最终在这里寻找答案，Eclipse 和 IntelliJ 的 jGRASP 查看器/画布插件已经可用了几年。