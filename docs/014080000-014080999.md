# StackOverflow 问答 14080000-14080999

# java - Java 游戏中的界限，“专业人士”是如何做到的？

> ID：14080005
> 
> 赞同：3
> 
> 时间：2012-12-29T08:28:56.000
> 
> 标签：java, boundary, 2d-games

专业人士如何在 2D 游戏中划清界限？我的做法是说我不希望精灵移动到某个区域：

```
//Example
if ((playerPosX >= 825) && (playerPosX  <= 910)&& (playerPosY >= 170) && (playerPosY <= 255)) {
    //do nothing
}else{
    //move
} 
```

但是有些游戏有很多界限，所以我想知道，有没有更简单的方法。我不认为有人会在整个游戏中使用上述方法，只是为了阻止移动。

**编辑：** 我的问题主要是关于一个你可以四处走动的游戏，类似于口袋妖怪或最终幻想

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T08:45:27.203

这取决于游戏。

*   在基于网格的游戏中，您通常会在精灵移动时*查找网格*以检查它是否已移动到“阻塞”区域。如果是这样，检测碰撞和/或执行精灵的一些校正运动。这既简单又高效，唯一的问题是它限制了您围绕网格结构设计关卡/场景。
*   在具有非常动态环境（例如大量移动的小行星）的游戏中，您通常会有一个基于空间分区（例如*四叉树*）的碰撞检测系统，用于检测任意对象之间的碰撞。每个对象通常都有一个*边界框*。
*   在具有由向量定义的复杂但固定几何图形的游戏中，您可以预先计算 BSP 树并将其用于快速检测与场景的碰撞。这种技术在 3D FPS 游戏中很常见，但它也适用于 2D。

许多游戏实际上会使用上述的组合：例如，用于固定场景的 BSP 树和用于由物理子系统管理的动态对象的四叉树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:41:11.933

我想到了两种可能，

*   第一次用多边形描述被阻挡的区域，并在多边形测试中做一个点，以确定精灵是否可以移动到这个位置。

*   第二个像在图像处理程序中创建某种掩码（层），其中零位表示您可以移动的位置，而位表示被阻挡的区域。这可以扩展到指定的深度，另请参阅[z-buffer](http://en.wikipedia.org/wiki/Z-buffering)以部分隐藏精灵，

编辑：

```
if ( mask[ nextY ][ nextX ] == 0 ) {
   currX = nextX;
   currY = nextY;
} 
```

假设所有变量都是 int 并且 mask 是 2d int 数组。

# php - codeigniter 中配置文件名称的 url 别名

> ID：14080006
> 
> 赞同：0
> 
> 时间：2012-12-29T08:29:26.760
> 
> 标签：php, codeigniter, url-routing

我想写个人资料名称`www.example.com/profilename`

为此，我考虑将所有不属于我的名称重定向`controller`到我的个人资料`controller`。我使用了以下代码

```
$route['(![abc])'] = "profile/$1"; 
```

但这似乎没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:47:06.750

在这种情况下，您必须显式创建一个规则来为您的控制器路由并将其他所有内容重定向到配置文件。

```
$controllers = array('profile','signup','...');

foreach($controllers as $controller) {
    $route[$controller] = $controller."/index";
    $route[$controller."/(:any)"] = $controller."/$1";
}

$route['(:any)'] = "profile/$1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T11:21:58.543

好，

您必须了解，通过这种路由，几乎所有内容都将转到您的配置文件控制器。您可以做的是以下步骤。您要做的第一件事是将所有内容路由到配置文件控制器，然后将一些路由重置到其他控制器。像这样：

```
*/
Route to profile if there only characters in the request. 
When it has special characters in it will be passed.
*/
$route['([a-z]+)/(:any)'] = 'profile/?profile=$1';

// Now make sure other controllers can be called too
$route['other/(:any)'] = 'other/$1';

// And another controller.. etc.
$route['etc/(:any)'] = 'etc/$1'; 
```

我不完全知道你在做什么，但使用路线有点糟糕。仅当您正在制作以社区为中心或社交媒体平台时。我当然明白。

# spring - spring如何查找当前的操作

> ID：14080008
> 
> 赞同：0
> 
> 时间：2012-12-29T08:29:28.087
> 
> 标签：spring, jsp, struts2

我在spring+sturts+hibernate中有一个项目。在jsp页面（我显示数据列表的地方）我有三个按钮视图，修改和添加。我想知道我按下了哪个按钮以便向用户显示流程. 现在我使用一个名为 type 的变量，并在单击此按钮时将此变量更新为某个值。然后我在相应页面中检查此变量以显示它是添加、修改还是查看。我知道这不是一个好方法。任何人都可以建议我一个好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:46:05.017

只需对您拥有的每个按钮使用不同的操作。通过不同的操作，您将能够确定按下了哪个按钮并显示适当的页面/数据。

例如在`struts.xml`文件中定义您的操作。

```
<action name="add" ...>
  <result>add_page</result>
</action>
<action name="modify" ...>
  <result>modify_page</result>
</action>
<action name="view" ...>
  <result>view_page</result>
</action> 
```

并在 JSP 页面中使用带有此操作的按钮。

# django - imageField 中的 upload_to 属性无法将图像保存在磁盘上

> ID：14080009
> 
> 赞同：-2
> 
> 时间：2012-12-29T08:29:28.383
> 
> 标签：django, save, modelform, imagefield

我是 django 的初学者。我想要一个 imageField 我的 ModelForm 可以保存上传到我磁盘中的 upload_to 路径的图像，但是当我通过管理站点时，我看到该图像保存在一个 url 而不是我磁盘上的目录中。

```
user_image = models.ImageField( upload_to= '/images/', null=True , blank=True ) 
```

设置.py

```
MEDIA_ROOT = 'C:\...\static' 
```

当我单击管理站点中的图像链接时，它将转到如下网址：

```
http://127.0.0.1:8000/admin/time_save/userprofile/6/16.png/ 
```

我搜索了很多问题，但我没有找到明确的解决方案。提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:34:00.243

您可以执行以下操作：

```
UPLOAD_ROOT = 'C:\...\static'

upload_storage = FileSystemStorage(location=UPLOAD_ROOT, base_url='/uploads')

image = models.ImageField(upload_to='/images', storage=upload_storage) 
```

PS：您可以在设置文件中定义 UPLOAD_ROOT。

还要通读设置您自己的[自定义存储](https://docs.djangoproject.com/en/dev/howto/custom-file-storage/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-14T12:15:08.303

更新`urls.py`

`from django.conf.urls.static import static urlpatterns = [ url(....),
] if settings.DEBUG: urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)`

# php - 如何使用 Hybridauth 获取 Twitter 用户的电子邮件？

> ID：14080011
> 
> 赞同：7
> 
> 时间：2012-12-29T08:29:34.687
> 
> 标签：php, twitter, hybridauth, hybridauthprovider

任何人都可以帮助如何获取 Twitter 电子邮件我在 php codeigniter 中使用此[链接](http://hybridauth.sourceforge.net/userguide/Integrating_HybridAuth_SignIn.html)在这里我正在获取我的信息，除了电子邮件。那么如何获取邮件呢？我们应该在配置文件中指定任何范围吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T08:31:17.223

## 你不能。

Twitter API 不提供对用户电子邮件地址的访问权限

* * *

这是 Twitter 员工[对同样问题的回答](https://dev.twitter.com/discussions/4019)

> API 不会向您返回电子邮件地址。如果您对用户的电子邮件地址感兴趣，则必须在您自己的应用程序中向用户询问它，这是一种完全不同的行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-30T19:25:54.207

我迟到了几年才回答这个问题，但无论如何我都会回答。

**你可以！！！**

检查已解决和回答此问题的[链接。](https://github.com/hybridauth/hybridauth/issues/587)

*   基本上，您首先需要通过提供您的隐私政策 url 和条件条款 url 从 twitter 开发者帐户获得提升的权限。

*   在从 twitter 开发支持获得电子邮件访问权限后应用此步骤。

    `/public_html/application/config/hybridauthlib.php`

并将 : 添加`"includeEmail" => true`到 Twitter 提供程序。

```
"Twitter" => array (
"enabled" => true,
"keys" => array ( "key" => "Your_Twitter_App_Key", "secret" => "Your_Twitter_Secret_Key" ),
"includeEmail" => true,
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-15T23:41:28.380

现在应该可以了。首先，将您的应用列入白名单。

[https://support.twitter.com/forms/platform70](https://support.twitter.com/forms/platform70) [我已经为 DEMO LINK 添加了一个 youtube 链接，并在 github 中为 APPLICATION URL 添加了我的应用程序 url] 并点击了“提交”按钮。

接下来，您将收到来自 twitter 的第一封电子邮件（如果您没有收到来自 twitter 的电子邮件，请重新填写表格并再次发送）说“感谢您与我们联系”。几个小时后，您会收到第二封电子邮件，上面写着该 url 应用程序被列入白名单。

一旦他们说您的应用已列入白名单，请在 Twitter 开发者门户中更新您的应用设置。登录到 apps.twitter.com 并：

在“设置”选项卡上，在“权限”选项卡上添加服务条款和隐私政策 URL，更改令牌的范围以请求电子邮件。只有在您的应用被列入白名单后，才能看到此选项。

接下来，您可能需要在[https://apps.twitter.com](https://apps.twitter.com)中重新生成您的访问令牌。并且还需要使用[https://api.twitter.com/1.1/account/verify_credentials.json?include_email=true](https://api.twitter.com/1.1/account/verify_credentials.json?include_email=true)来获取用户的电子邮件地址

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-03-22T08:00:44.137

我使用的是 HybridAuth 库的 CodeIgniter 版本，并且在这个文件中

> 应用程序/应用程序/third_party/hybridauth/Hybrid/Providers/Twitter.php

修改了这一行

```
$response = $this->api->get( 'account/verify_credentials.json' ); 
```

到下面一个

```
$response = $this->api->get( 'account/verify_credentials.json',['include_entities' => 'true', 'skip_status' => 'true', 'include_email' => 'true'] ); 
```

另外，在返回用户个人资料之前添加了以下行

```
$this->user->profile->email      = (property_exists($response,'email'))?$response->email:""; 
```

并开始接收电子邮件 ID

# android - 不能使用 for 循环为按钮或文本视图设置 OnClickListener？

> ID：14080012
> 
> 赞同：0
> 
> 时间：2012-12-29T08:29:35.030
> 
> 标签：android, textview

我有很多可点击的文本视图/按钮。如果我必须输入以下内容，只会使开发过程变得乏味：

```
OnCreate... etc, etc.
    tvOutput0.setOnClickListener(this);
    tvOutput1....
    tvOutput2.....
    ...
    tvOutput100.setOnClickListener(this) 
```

我试图实现一个for循环

```
 tvOutputArray[] = {tvOutput0, tvOutput1,....TvOutput100}
   for(int i=0; i< tvOutputArray.length-1;i++){
         tvOutputArray[i].setOnClickListener(this);
   } 
```

唉，每次都崩溃。我尝试这个。除了手动之外，还有其他方法可以做到这一点（即每一个都输入？

```
 12-29 08:42:58.120: ERROR/StrictMode(597): null
    android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService        has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40cd0fb0 that was originally       bound here
    at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
    at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
    at android.app.ContextImpl.bindService(ContextImpl.java:1418)
    at android.app.ContextImpl.bindService(ContextImpl.java:1407)
    at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
    at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
    at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
    at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
    at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
    at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
    at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
    at android.os.AsyncTask$2.call(AsyncTask.java:287)
    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
    at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:55:39.127

我认为您必须以编程方式使用创建按钮/文本视图

```
public class ActivityName extends Activity implements OnClickListener

{

 private static final int MY_BUTTON = 9000;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

        LinearLayout ll = (LinearLayout)findViewById(R.id.linearLayout2);

        // add text view
        TextView tv = new TextView(this);
        tv.setText("Dynamic Text!");
        ll.addView(tv);

        // add edit text
        EditText et = new EditText(this);
        et.setText("Dynamic EditText!");
        et.setMinLines(1);
        et.setMaxLines(3);
        ll.addView(et);

        // add button
        Button b = new Button(this);
        b.setText("Button added dynamically!");
        b.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        b.setId(MY_BUTTON);
        b.setOnClickListener(this);
        ll.addView(b);

        //add checkboxes
        for(int i = 0; i < 10; i++) {
            CheckBox cb = new CheckBox(this);
            cb.setText("Dynamic Checkbox " + i);
            cb.setId(i+10);
            ll.addView(cb);
        }

        //add radio buttons
        final RadioButton[] rb = new RadioButton[5];
        RadioGroup rg = new RadioGroup(this); //create the RadioGroup
        rg.setOrientation(RadioGroup.HORIZONTAL);//or RadioGroup.VERTICAL
        for(int i=0; i<5; i++){
            rb[i]  = new RadioButton(this);
            rb[i].setText("Dynamic Radio Button " + i);
            rb[i].setId(i);
            rg.addView(rb[i]); //the RadioButtons are added to the radioGroup instead of the layout

        }
        ll.addView(rg);//you add the whole RadioGroup to the layout

        // add Toggle button
        ToggleButton tb = new ToggleButton(this);
        tb.setTextOn("Dynamic Toggle Button - ON");
        tb.setTextOff("Dynamic Toggle Button - OFF");
        tb.setChecked(true);
        tb.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        ll.addView(tb);

    }

    public void onClick(View v) {
        Toast toast;
        Log.w("ANDROID DYNAMIC VIEWS:", "View Id: " + v.getId());
        switch (v.getId()) {
        case MY_BUTTON:
            toast = Toast.makeText(this, "Clicked on my dynamically added button!", Toast.LENGTH_LONG);
            toast.setGravity(Gravity.TOP, 25, 400);
            toast.show();
            saveAnswers();
            break;
            // More buttons go here (if any) ...

        }

  }
} 
```

& 你只使用一次 b.setOnClickListener(this) & 访问 Button/ToggleButton/textviews 和 Id 或标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:38:48.723

```
 for(int i=0; i< tvOutputArray.length-1;++) 
```

你忘了我++；

```
 for(int i=0; i< tvOutputArray.length-1;i++) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T08:53:59.607

我认为您正在尝试这样做：

```
// we need array of view's id
int [] viewIds = new int [] {R.id.tv1, R.id.tv2, R.id.bt1...};

// loop through ids, find view, set listener
for (int i = 0; i < viewIds.lenght; i++){
     View v = findViewById(viewIds[i]);
     if (v != null) {
         v.setOnClickListener(this);
     }
} 
```

# c# - 将列表字典转换为字典列表

> ID：14080014
> 
> 赞同：1
> 
> 时间：2012-12-29T08:29:58.663
> 
> 标签：c#

我有一个类型的字典，`Dictionary<string, List<string>>`我想把它转换成一个类型的列表`List<Dictionary<string, string>>`。例如

输入：

```
 Key              List
{ id,   { "1",     "2",    "3"   }},
{ mkt,  { "in",    "uk",   "us"  }},
{ dept, { "sales", "test", "var" }}, 
```

输出：

```
{ 
  { (id, "1"), (mkt , "in"), (dept, "sales") },  //1st Node as Dictionary
  { (id, "1"), (mkt , "in"), (dept, "test")  },  //2nd Node
  { (id, "1"), (mkt , "in"), (dept, "var")   },
  .
  . //All possible combinations id, mkt and dept
  .
 } 
```

我可以使用 for 循环来做到这一点，但我正在寻找一种更干净的方式，可能使用一些 C# 特定功能，如 LINQ 等。

```
int a = 0;
int NoOfTimesToRepeatAnElement = 1, NoOfTimesToRepeatList = count;
int prevListSize = 1, currListSize = 1;
foreach (var arg in dictionary)
{
    a = 0;
    prevListSize = currListSize;
    currListSize = arg.Value.Count();

    NoOfTimesToRepeatAnElement = NoOfTimesToRepeatAnElement * prevListSize;
    NoOfTimesToRepeatList = NoOfTimesToRepeatList / currListSize;

    var list = arg.Value;

    for (int x = 0; x < NoOfTimesToRepeatList; x++)
    {
        for (int y = 0; y < currListSize; y++)
        {
            for (int z = 0; z < NoOfTimesToRepeatAnElement; z++)
            {
                finalList[a++].Add(arg.Key, list[y]);
            }
        }
    }
} 
```

PS：我来自 C 背景，是 C# 的新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:49:02.953

```
var list = dict.Select(kv => kv.Value.Select(v => new { kv.Key, Value = v }))
                .CartesianProduct()
                .Select(x => x.ToDictionary(y=>y.Key,y=>y.Value))
                .ToList(); 
```

* * *

```
public static partial class MyExtensions
{
    //http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx
    public static IEnumerable<IEnumerable<T>> CartesianProduct<T>(this IEnumerable<IEnumerable<T>> sequences)
    {
        // base case: 
        IEnumerable<IEnumerable<T>> result = new[] { Enumerable.Empty<T>() };
        foreach (var sequence in sequences)
        {
            var s = sequence; // don't close over the loop variable 
            // recursive case: use SelectMany to build the new product out of the old one 
            result =
                from seq in result
                from item in s
                select seq.Concat(new[] { item });
        }
        return result;
    }
} 
```

# android - 关于 android 中的 TabWidget

> ID：14080020
> 
> 赞同：0
> 
> 时间：2012-12-29T08:31:12.063
> 
> 标签：android, tabwidget

我在 TabWidget 中设置了 setcontent（intent）。但我想在切换之前进行检查。如果条件成立，它将切换。如果不是，它不会切换。如何实现这一点？

切换后将返回上次活动默认值并保存相关信息。如何让它每次都重新加载？

# windows - windows下特定unicode字符的emacs set-fontset-font

> ID：14080021
> 
> 赞同：1
> 
> 时间：2012-12-29T08:31:13.233
> 
> 标签：windows, emacs, font-face

我在windows系统下使用下面的设置来配置emacs的字体

```
(create-fontset-from-fontset-spec
 "-outline-Cousine-normal-normal-normal-*-*-*-*-*-*-*-fontset-Consolas")
(set-fontset-font "fontset-Consolas" 
                  '(#x6d4b . #x6d4c) 
                  "Microsoft YaHei" nil 'prepend)
(set-face-attribute 'default nil :font "fontset-Consolas") 
```

emacs启动后，我将那个char输入`#x6d4b`到emacs缓冲区中，结果却是一个正方形，这意味着字体设置不起作用。我还`describe-char`用来显示详细信息，并得到以下结果：

```
 position: 2888 of 4342 (66%), column: 13
            character: 测 (displayed as 测) (codepoint 27979, #o66513, #x6d4b)
    preferred charset: unicode-bmp (Unicode Basic Multilingual Plane (U+0000..U+FFFF))
code point in charset: 0x6D4B
               syntax: w    which means: word
             category: .:Base, C:2-byte han, L:Left-to-right (strong), c:Chinese, |:line breakable
          buffer code: #xE6 #xB5 #x8B
            file code: #xE6 #xB5 #x8B (encoded by coding system utf-8-dos)
              display: no font available 
```

我们可以发现该`display`属性显示它没有可用的字体，但我确实在字体配置中给出了它。

你能指出问题出在哪里吗？我想 set-fontset-font 即使在 Windows 系统下也应该可以工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:07:53.240

只要您只想为两个特定字符设置默认字体和不同的字体，以下对我有用：

```
(set-face-attribute 'default nil :family "Consolas")
(set-fontset-font "fontset-default" '(#x6d4b . #x6d4c)
                  "Microsoft YaHei" nil 'prepend) 
```

（`prepend`对于 Consolas 来说是不必要的，但可能对您的字体有所帮助）。

# go - golang:net.Conn 读得很慢？

> ID：14080024
> 
> 赞同：4
> 
> 时间：2012-12-29T08:31:25.447
> 
> 标签：go

我正在将 net.Listen("tcp", addr) 用于一个小型服务器程序，该程序将接受数据并将其存储在服务器上。在客户端，我有一个 c++ 程序，我只是将 4096000 BYTES 写入套接字（连接到我的服务器程序）客户端的写入在不到一秒的时间内完成。使用连接 net.Conn 的 Read() 函数时，读取速度非常慢。

以下是 Read() for 循环：

```
 // Handle the reads
  var tbuf [81920]byte

  for {

    n, err := c.rwc.Read(tbuf[0:])

    // Was there an error in reading ?
    if err != nil {
        log.Printf("Could not read packet : %s", err.Error())
        break
    }

    log.Println(n)

}

return 
```

c.rwc 的类型为 net.Conn

上述代码的输出如下：

```
2012/12/29 13:45:12 16384
2012/12/29 13:45:12 16018
2012/12/29 13:45:12 16384
2012/12/29 13:45:12 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:13 16016
2012/12/29 13:45:13 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:14 16384
2012/12/29 13:45:14 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:15 16016
2012/12/29 13:45:15 16384
2012/12/29 13:45:16 16016
2012/12/29 13:45:16 16384
2012/12/29 13:45:16 16016
2012/12/29 13:45:16 16384
2012/12/29 13:45:16 16016
2012/12/29 13:45:16 16384
2012/12/29 13:45:16 16016
2012/12/29 13:45:16 16384
2012/12/29 13:45:16 16016
2012/12/29 13:45:18 16384
2012/12/29 13:45:18 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:19 16016
2012/12/29 13:45:19 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:20 16384
2012/12/29 13:45:20 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:21 16016
2012/12/29 13:45:21 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:22 16384
2012/12/29 13:45:22 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:23 16384
2012/12/29 13:45:23 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:24 16016
2012/12/29 13:45:24 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:25 16016
2012/12/29 13:45:25 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:26 16384
2012/12/29 13:45:26 16016
2012/12/29 13:45:27 16384
2012/12/29 13:45:27 16016
2012/12/29 13:45:27 16384
2012/12/29 13:45:27 16016
2012/12/29 13:45:27 16384
2012/12/29 13:45:27 16016
2012/12/29 13:45:27 16384
2012/12/29 13:45:27 16016
2012/12/29 13:45:27 16384
2012/12/29 13:45:28 16016
2012/12/29 13:45:28 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:29 16016
2012/12/29 13:45:29 16384
2012/12/29 13:45:30 16016
2012/12/29 13:45:30 16384
2012/12/29 13:45:30 16016
2012/12/29 13:45:30 16384
2012/12/29 13:45:30 16016
2012/12/29 13:45:30 16384
2012/12/29 13:45:30 16016
2012/12/29 13:45:30 16384
2012/12/29 13:45:30 16016
2012/12/29 13:45:31 16384
2012/12/29 13:45:31 16016
2012/12/29 13:45:31 16384
2012/12/29 13:45:31 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:32 16016
2012/12/29 13:45:32 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:33 16016
2012/12/29 13:45:33 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:34 16016
2012/12/29 13:45:34 16384
2012/12/29 13:45:35 16016
2012/12/29 13:45:35 16384
2012/12/29 13:45:35 16016
2012/12/29 13:45:35 16384
2012/12/29 13:45:35 16016
2012/12/29 13:45:35 16384
2012/12/29 13:45:35 16016
2012/12/29 13:45:36 16384
2012/12/29 13:45:36 16016
2012/12/29 13:45:36 16384
2012/12/29 13:45:36 16016
2012/12/29 13:45:37 16384
2012/12/29 13:45:37 16016
2012/12/29 13:45:37 16384
2012/12/29 13:45:37 16016
2012/12/29 13:45:37 16384
2012/12/29 13:45:37 16016
2012/12/29 13:45:37 16384
2012/12/29 13:45:37 16016
2012/12/29 13:45:37 16384
2012/12/29 13:45:37 16016
2012/12/29 13:45:37 4048 
```

如您所见，读取操作需要将近 21-25 秒才能读取 4096000 个字节，这非常慢，因为服务器和客户端在同一台计算机上。读操作错了吗？我无法理解为什么这么慢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T19:43:27.867

我把你的例子做成了一个完整的客户端和服务器示例。在 Linux 上对其进行测试，它会在 20 毫秒左右传输数据，并且不会出现意外暂停。

如果您在计算机上尝试，您会得到相同的结果吗？如果是这样，那么怀疑您系统的 C++ 部分。如果出现与原始帖子相同的停顿，则怀疑您的设置。

**服务器代码**

```
package main

import (
    "io"
    "log"
    "net"
    "time"
)

func handle(c net.Conn) {
    // Handle the reads
    start := time.Now()
    tbuf := make([]byte, 81920)
    totalBytes := 0

    for {
        n, err := c.Read(tbuf)
        totalBytes += n
        // Was there an error in reading ?
        if err != nil {
            if err != io.EOF {
                log.Printf("Read error: %s", err)
            }
            break
        }
        log.Println(n)
    }
    log.Printf("%d bytes read in %s", totalBytes, time.Now().Sub(start))
    c.Close()
}

func main() {
    srv, err := net.Listen("tcp", ":2000")
    if err != nil {
        log.Fatal(err)
    }
    log.Println("Listening on localhost:2000")
    for {
        conn, err := srv.Accept()
        if err != nil {
            log.Fatal(err)
        }
        go handle(conn)
    }
} 
```

**客户代码**

```
package main

import (
    "log"
    "net"
    "time"
)

func handle(c net.Conn) {
    start := time.Now()
    tbuf := make([]byte, 4096)
    totalBytes := 0
    for i := 0; i < 1000; i++ {
        n, err := c.Write(tbuf)
        totalBytes += n
        // Was there an error in writing?
        if err != nil {
            log.Printf("Write error: %s", err)
            break
        }
        log.Println(n)
    }
    log.Printf("%d bytes written in %s", totalBytes, time.Now().Sub(start))
    c.Close()
}

func main() {
    conn, err := net.Dial("tcp", ":2000")
    if err != nil {
        log.Fatal(err)
    }
    log.Println("Sending to localhost:2000")
    handle(conn)
} 
```

# iphone - 免费和商业应用程序的 Xcode 捆绑包 ID 无法正确编译

> ID：14080025
> 
> 赞同：0
> 
> 时间：2012-12-29T08:31:38.613
> 
> 标签：iphone, objective-c, xcode

我有一个带广告的免费版本和一个商业无广告版本。

现在，我编译了我的免费应用程序并毫无问题地提交了它。

接下来，我复制了我的 app 文件夹，删除了广告代码并更改了 bundle id 以匹配商业版本。

当我更改捆绑 ID 时，应用程序无法编译，它开始运行，但立即显示“已完成运行应用程序...”

只要我返回我的 prev bundle id，它就可以正常运行。

这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:42:47.253

听起来你的计划可能很糟糕。尝试这个：

1）更改您的捆绑标识符

2) 通过单击项目名称（在项目导航器顶部）按回车键，输入新名称，并允许 Xcode 继续其自动重命名过程来重命名项目（这可能是可选的，不确定 Xcode 是否真的关心如果两个项目具有相同的名称并且构建在相同的设备/模拟器上......但只是为了安全......）

2）点击项目的下拉菜单（“停止”按钮旁边），然后点击“管理方案”

3）选择所有方案，按删除，然后在弹出窗口中按“删除”

4) 点击“Autocreate Schemes Now”创建新的scheme

5) 进行清理（产品菜单 -> 清理），构建，然后再次尝试运行项目

祝你好运。

# generics - 带有通用超类的 EclipseLink 2.0 中的错误

> ID：14080026
> 
> 赞同：0
> 
> 时间：2012-12-29T08:31:43.417
> 
> 标签：generics, eclipselink

这个问题只是为了让其他人找到对 EclipseLink 2.0 中的错误的引用，可以通过在此处升级到 2.4.1 来解决：

在为 EclipseLink 的持久实体引入通用超类后，出现以下错误：

```
Local Exception Stack: 
Exception [EclipseLink-30005] (Eclipse Persistence Services - 2.0.0.v20091127-r5931): org.eclipse.persistence.exceptions.PersistenceUnitLoadingException
Exception Description: An exception was thrown while searching for persistence archives with ClassLoader: sun.misc.Launcher$AppClassLoader@40affc70
Internal Exception: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.0.0.v20091127-r5931): 
...

Caused by: java.lang.IndexOutOfBoundsException: Index: 12, Size: 12
    at java.util.ArrayList.RangeCheck(ArrayList.java:547)
    at java.util.ArrayList.get(ArrayList.java:322)
    at org.eclipse.persistence.internal.jpa.metadata.accessors.objects.MetadataAsmFactory.resolveGenericTypes(MetadataAsmFactory.java:145)
    at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.resolveGenericTypes(EntityAccessor.java:1332)
    at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.discoverMappedSuperclassesAndInheritanceParents(EntityAccessor.java:316)
    at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.preProcess(EntityAccessor.java:610)
    at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.preProcess(EntityAccessor.java:593)
    at org.eclipse.persistence.internal.jpa.metadata.MetadataProject.processStage1(MetadataProject.java:1296)
    at org.eclipse.persistence.internal.jpa.metadata.MetadataProcessor.processORMMetadata(MetadataProcessor.java:460)
    at org.eclipse.persistence.internal.jpa.deployment.PersistenceUnitProcessor.processORMetadata(PersistenceUnitProcessor.java:390)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:940)
    ... 22 more 
```

这些链接指向错误：

*   [http://www.eclipse.org/forums/index.php/t/367702/](http://www.eclipse.org/forums/index.php/t/367702/)
*   [https://bugs.eclipse.org/bugs/show_bug.cgi?id=372092](https://bugs.eclipse.org/bugs/show_bug.cgi?id=372092)

所以问题是：升级到 2.4.1 能解决这个问题吗？

我的回答是：升级到 EclipseLink 2.4.1 对我有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:05:44.960

以下是确保使用 Eclipselink 2.4.1 的 maven pom.xml 的摘录：

```
<repositories>
    <repository>
        <id>eclipselink</id>
        <url>http://www.eclipse.org/downloads/download.php?r=1&amp;nf=1&amp;file=/rt/eclipselink/maven.repo/
        </url>
    </repository>
</repositories> 
```

与依赖：

```
 <!--  Eclipse Link persistence -->
    <dependency>
        <groupId>org.eclipse.persistence</groupId>
        <artifactId>eclipselink</artifactId>
        <version>2.4.1</version>
        <!-- <scope>provided</scope> uncomment if running inside a Java EE container -->
    </dependency> 
```

# c# - 将json字符串作为参数传递给用C#编写的webmethod[SOAP web service]？

> ID：14080028
> 
> 赞同：1
> 
> 时间：2012-12-29T08:32:12.100
> 
> 标签：c#, json, web-services, soap, nusoap

我在 asp.net Web 应用程序中编写了一个 Soap Web 服务。在那个 C# Web 服务中，我有一个将 json 字符串作为参数的 Web 方法。现在我想从基于 php 的客户端调用这个肥皂 Web 服务。

我的问题是“基本上 Soap Web 服务是基于 xml 的。所以，在 C#(Server) 环境中将 json 字符串作为参数传递给我的 Soap Web 服务是否合法。

还是在 C# 环境中使用 json Web 服务而不是在上面一个更好？

请引导我获得明确的方法？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:39:52.190

Soap 使用 Xml 作为传输格式，但这对您来说不是问题，因为我可以看到您正在使用 NuSoap。

您可以将 json 作为参数传递。您可以将 web 服务的参数类型设置为字符串，在 c# 端，您可以使用 JSON.NET 或任何类似的解析器解析 json。

我通常会创建一个类型来表示 json 字段并将 json 反序列化为该类型以方便使用。

# mysql - 寻找优化的 MySQL 查询

> ID：14080030
> 
> 赞同：1
> 
> 时间：2012-12-29T08:32:40.423
> 
> 标签：mysql

我想构建一个查询，在执行时应该优化性能。下面是我的表结构： -

表名：- 库存

表结构：-

```
item_id int(50) Primary key,
item_name varchar(50),
matchingItemID int(50). 
```

从上表中，我想找到匹配的item对，即如果A和B是item_id分别为1和2的两个item，那么matchingItemID字段中的值必须分别为2和1。

matchingItemID 是添加的项目的 item_id。

例如

```
item_id     item_name      matchingItemID
   1            A                2
   2            B                1 
```

因此，构建的查询应返回如下输出：-

A - B。

我尝试了一个查询，但是执行需要时间，因此我认为它没有优化性能。

以下是我建立的查询： -

```
SELECT a.item_id, b.item_id
FROM inventory a, inventory b
WHERE a.matchingItemID = b.item_id
AND b.matchingItemID = a.item_id
AND a.item_id != b.item_id; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:54:11.037

如果您不需要有两条记录，`A=B`然后`B=A`只使用此查询，它只会输出不同的一对`A=B`而不是两个：

```
SELECT a.item_id id1, b.item_id id2
FROM inventory a
join inventory b on 
    (a.matchingItemID = b.item_id)
    AND 
    (b.matchingItemID = a.item_id)
    AND 
    (a.item_id < b.item_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:38:18.000

如果项目总是相互匹配，你可以这样做：

```
SELECT a.item_id, b.item_id
FROM inventory a
JOIN inventory b ON a.matchingItemID = b.item_id 
```

此外，您可以向`matchingItemID`列添加索引。

编辑

似乎多余，但这是您要求的：

```
SELECT a.item_id, b.item_id
FROM inventory a
JOIN inventory b ON a.matchingItemID = b.item_id AND b.matchingItemID = a.item_id 
```

# android - 我们可以将 mysql 表数据提取到 phonegap android 中吗？还是必须为 json 结果创建 web 服务？

> ID：14080036
> 
> 赞同：1
> 
> 时间：2012-12-29T08:33:34.547
> 
> 标签：android, mysql, cordova

我们可以将 MySql 表数据提取到 Phonegap Android 中吗？还是必须为 JSON 结果制作 Web 服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:40:19.017

您应该编写一个 Web 服务，它将作为您的数据库的 API，并使用返回 JSON（或 XML）的方法。

然后可以从您的 PhoneGap 项目中调用 Web 服务方法（我建议您查看 jquery ajax api [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)）。

**更新**

我不确定 mySQL 但你可以用 SQLite 做到这一点。这里是[例子](http://gauravstomar.blogspot.ca/2011/08/prepopulate-sqlite-in-phonegap.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20GauravSTomarBootstrappingIntelligence%20%28Gaurav%20S%20Tomar%20%3a%20Bootstrapping%20Intelligence)

# python - 在 Sublime Text 2 中以交互方式运行 Python

> ID：14080041
> 
> 赞同：14
> 
> 时间：2012-12-29T08:34:04.573
> 
> 标签：python, sublimetext2, sublimerepl

我已经查看了这个论坛上的所有答案，但我错过了一些东西。我希望能够在 Sublime Text 2 中编辑 Python 文件“myfile.py”时点击`Cmd`+ 。`B`

这应该会打开一个 Python shell，它会加载我的文件并将我返回到交互式提示，以便我的 Python 脚本中的命名空间可用。

在构建设置中设置`-i`选项仍然会关闭解释器（见下文）

```
> 81
> >>>  [Finished in 0.1s] 
```

我下载**了 sublimeREPL**，但我不确定如何设置该`-i`选项。
任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T14:58:23.930

好的，感谢 sneawo 的提示！这是我第一次这样做。

步骤 1\. 创建一个插件 pydev，（从 Tools->New Plugin）创建一个命令 'pydev'

```
import sublime, sublime_plugin

class PydevCommand(sublime_plugin.WindowCommand):
    def run(self):
        self.window.run_command('set_layout', {"cols":[0.0, 1.0], "rows":[0.0, 0.5, 1.0], "cells":[[0, 0, 1, 1], [0, 1, 1, 2]]})
        self.window.run_command('repl_open',{"type": "subprocess",
                                             "encoding": "utf8",
                                             "cmd": ["python2.7", "-i", "-u", "$file"],
                                             "cwd": "$file_path",
                                             "syntax": "Packages/Python/Python.tmLanguage",
                                             "external_id": "python2.7"
                                             })
        self.window.run_command('move_to_group', { "group": 1 }) 
```

步骤 2\. 在 Preferences->Key-Bindings-user 中创建一个新的键绑定

> `{"keys": ["f5"], "command": "pydev"}`

现在按下`f5`（在 Mac 上默认为`fn`+ `f5`）就可以了——它将在 repl 选项卡中启动 python 解释器，将布局设置为水平两个窗口并将 repl 选项卡移动到下部窗口。

这是非常基本的，因为它不会检查当前布局是什么，而只是将布局设置为 2-horizo​​ntal。可能会修饰代码以进行一些检查，并简单地在现有布局中添加一个水平窗口。在关闭 repl 选项卡时删除水平缓冲区也很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-29T09:59:49.413

尝试更新您的用户键绑定：

```
[
    { "keys": ["super+shift+r"], "command": "repl_open", 
                 "caption": "Python",
                 "mnemonic": "p",
                 "args": {
                    "type": "subprocess",
                    "encoding": "utf8",
                    "cmd": ["python", "-i", "-u", "$file"],
                    "cwd": "$file_path",
                    "syntax": "Packages/Python/Python.tmLanguage",
                    "external_id": "python"
                    } 
    }
] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-19T10:49:09.693

我想对@user1936097 的答案进行快速编辑。

我复制了这个想法，但想改为加载 IPython（代码原样可以很好地加载标准 Python）。我换了...

```
self.window.run_command('repl_open',{"type": "subprocess",
                                             "encoding": "utf8",
                                             "cmd": ["python2.7", "-i", "-u", "$file"],
                                             "cwd": "$file_path",
                                             "syntax": "Packages/Python/Python.tmLanguage",
                                             "external_id": "python2.7"
                                             }) 
```

和...

```
self.window.run_command('repl_open', {
                    "type": "subprocess",
                    "encoding": "utf8",
                    "autocomplete_server": true,
                    "cmd": ["python","-u","${packages}/SublimeREPL/config/Python/ipy_repl.py"],
                    "cwd": "$file_path",
                    "syntax": "Packages/Python/Python.tmLanguage",
                    "external_id": "python",
                    "extend_env": {
                        "PYTHONIOENCODING": "utf-8",
                        "SUBLIMEREPL_EDITOR": "$editor"}
                    }) 
```

但它没有用。

这条线`"autocomplete_server": true`似乎是问题所在。如果我删除它，代码会运行，但 IPython 会打开关闭的。如果我离开它，什么都不会发生。

我终于借用了一个在文件中找到的命令`/SublimeREPL/config/Python/Default.sublime-commands`并想出了...

```
self.window.run_command('run_existing_window_command', {
                        "id": "repl_python_ipython",
                        "file": "config/Python/Main.sublime-menu"
                    }) 
```

这使得最终的插件代码：

```
import sublime, sublime_plugin

class PydevCommand(sublime_plugin.WindowCommand):
    def run(self):
        self.window.run_command('set_layout', {"cols":[0.0, 1.0], "rows":[0.0, 0.5, 1.0], "cells":[[0, 0, 1, 1], [0, 1, 1, 2]]})
        self.window.run_command('run_existing_window_command', {
                        "id": "repl_python_ipython",
                        "file": "config/Python/Main.sublime-menu"
                    })
        self.window.run_command('move_to_group', { "group": 1 }) 
```

将其分配给原始帖子中所示的键绑定，您现在将加载 IPython 而不是标准 Python！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-18T21:06:33.970

答案比你的方法简单得多。只需定义一个新的构建“配置文件”（构建系统），您可以在其中准确捕获默认的 Python 构建，除了将选项更改`-u`为`-ui`

> `{ "cmd": ["C:\\python33\\python.exe", "-ui", "$file"], "file_regex": "^[ ]*File \"(...*?)\", line ([0-9]*)", "selector": "source.python" }`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-06-26T18:56:37.787

这是创建新构建系统的简单方法。

```
{
    "cmd": ["C:\\python33\\python.exe", "-u", "$file"],
    "file_regex": "^[ ]*File \"(...*?)\", line ([0-9]*)",
    "selector": "source.python"
} 
```

然后将构建系统保存为 Python3 或 Python27 并选择它作为默认值。

# c++ - 如何在另一个函数中使用这些变量？

> ID：14080045
> 
> 赞同：1
> 
> 时间：2012-12-29T08:34:46.280
> 
> 标签：c++, variables, undeclared-identifier

我正在疯狂地尝试在同一文件中的另一个函数中使用变量：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)

{

    QLineEdit * street1BetSize = new QLineEdit("0"); // want to use these QLineEdit's
    QLineEdit * street2BetSize = new QLineEdit("0");
    QLineEdit * street3BetSize = new QLineEdit("0");
    QLineEdit * street4BetSize = new QLineEdit("0");
    QLineEdit * street5BetSize = new QLineEdit("0"); 
```

}

想在这里使用这些变量：

```
void MainWindow::runButtonClicked()
{
    QVector<card> vDealt = cardDeck.deal_rand_cards(vDeck,3);
    //qDebug()<<vStreetBets[0];

    streetBetsList << street1BetSize << street2BetSize << street3BetSize << street4BetSize << street5BetSize;
    QVector<int> vStreetBets;
    for(int i=0;i<5;i++)
    {
         vStreetBets.append(streetBetsList[i]->text().toInt());
         qDebug()<<"street bet: "<<vStreetBets[i];
    }
} 
```

因为它在这里，我得到

> 警告：C4189：'street5BetSize'：局部变量已初始化但未引用

和

```
error: C2065: 'street5BetSize' : undeclared identifier 
```

每一个人。

我尝试添加`extern QLineEdit * street1BetSize;`到 mainwindow.h，但这给了我一个“未解决的外部”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:44:44.573

from`street1BetSize to street5BetSize`的变量是 MainWindow 构造函数中的局部变量，它们对其他函数不可见。要使其他类成员函数能够访问它们，您可以将它们提升为 MainWindow 类成员，以便在类之间共享变量状态。而不是很多变量指针，使用`std::vector`QLineEdit 对象应该是一个更好的解决方案？

```
class MainWindow
{
public:
   MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow),
    streetBetSizes(5,QLineEdit("0"))
private:
   // other member
   std::vector<QLineEdit> streetBetSizes;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:43:10.703

将变量声明为 MainWindow 的成员，然后在构造函数中初始化它们：

```
class MainWindow : public QMainWindow
{
    ...

private:
    QLineEdit* m_street1BetSize;
    QLineEdit* m_street2BetSize;
    QLineEdit* m_street3BetSize;
    QLineEdit* m_street4BetSize;
    QLineEdit* m_street5BetSize;
};

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    m_street1BetSize = new QLineEdit("0"); // want to use these QLineEdit's
    m_street2BetSize = new QLineEdit("0");
    m_street3BetSize = new QLineEdit("0");
    m_street4BetSize = new QLineEdit("0");
    m_street5BetSize = new QLineEdit("0");
} 
```

然后你可以在 MainWindow 的任何方法中使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T08:45:36.083

如果您要`QLineEdit`为每个 s 设置 5 个 s `MainWindow`，那么您希望他们成为您班级的成员。只需将它们添加到您的类定义中：

```
class MainWindow
{
  // ...
 private:
  // ...
  QLineEdit* street1BetSize;
  QLineEdit* street2BetSize;
  QLineEdit* street3BetSize;
  QLineEdit* street4BetSize;
  QLineEdit* street5BetSize;
} 
```

现在，每个`MainWindow`对象将有 5 个指向`QLineEdit`. 这些构成了该对象*状态*的一部分，并且可以被它的任何成员函数访问。现在将您的构造函数更改为以下内容，这样您就不会重新定义名称：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    street1BetSize = new QLineEdit("0");
    street2BetSize = new QLineEdit("0");
    street3BetSize = new QLineEdit("0");
    street4BetSize = new QLineEdit("0");
    street5BetSize = new QLineEdit("0");
} 
```

事实上，你最好使用成员初始化列表，就像你对`QMainWindow`and所做的那样`ui`：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent), ui(new Ui::MainWindow),
    street1BetSize(new QLineEdit("0")), street2BetSize(new QLineEdit("0")),
    street3BetSize(new QLineEdit("0")), street4BetSize(new QLineEdit("0")),
    street5BetSize(new QLineEdit("0"))
{ } 
```

现在你的构造函数不需要做任何工作。

`street1BetSize`现在您可以在其他成员函数中参考和朋友`MainWindow`。但是，当您有编号的变量时，总是很可疑，例如`streetXBetSize`. 这似乎是一个数组或容器的好地方。为什么不尝试一个`std::vector<QLineEdit>`，然后你可以根据需要添加和删除`QLineEdit`s 。您的类定义现在将具有：

```
class MainWindow
{
  // ...
 private:
  // ...
  std::vector<QLineEdit> streetBetSizes;
} 
```

您的构造函数现在可以简单地执行以下操作：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent), ui(new Ui::MainWindow)
{
  for (int i = 0; i < 5; i++) {
    streetBetSizes.push_back(new QLineEdit("0"));
  }
} 
```

# jquery - 我怎样才能解决jQuery菜单和滑动

> ID：14080046
> 
> 赞同：0
> 
> 时间：2012-12-29T08:35:18.233
> 
> 标签：jquery, codeigniter

我想为我的软件支持主流流行浏览器，我需要支持谷歌浏览器，我的代码如下

```
$(document).ready(function(){ 
    $('#Menu').sweetMenu({
        top: 120,
        padding: 8,
        iconSize: 48,
        easing: 'easeOutBounce',
        duration: 500,
        icons: [
            '<?php echo base_url()?>img/template/home.png',
            '<?php echo base_url()?>img/template/logout.png',
        ]
    });
}); 
```

当我使用上面的代码并且使用在下面时

```
 <script type="text/javascript" src="<?php echo base_url()?>js/jquery-1.4.2.min.js"></script> 
```

然后 Sliding Manu 在所有主流浏览器中都可以使用，但 Autocomplete 在这里不起作用

当我使用下面的代码而不是 jquery-1.4.2.min.js

```
<script type="text/javascript" src="<?php echo base_url()?>js/jquery-1.8.3.js"></script> 
```

然后它可以在没有谷歌浏览器的所有主要浏览器中使用，如果我同时使用这两个代码，那么这是同样的问题

我怎样才能完美解决它，请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T14:52:26.967

I dont think you will solve this easily. The menu plugin you are using is no longer in development (not built with latest jquery in mind), I cant find any info about what browsers it is supposed to work on, and quite frankly it doesn't look that hard to replicate

Your options look like this to me.

1) Spend time trying to work out what the bug is in chrome and fix it (I'm sorry I can't be more help with this).

2) Put together a similar effect in a few lines of your own jquery.

3) Use one of the thousands of similar plugins that do work in all major browsers

4) Look for autocomplete that works with jquery 1.4.2

5) Load both versions of jquery as suggested in comments (I hate this approach - jquery is enough of an overhead without loading it twice)

# asp.net - 无法添加对 asp.net C# Web 应用程序的引用

> ID：14080048
> 
> 赞同：0
> 
> 时间：2012-12-29T08:35:29.073
> 
> 标签：asp.net, dll

无法添加对 asp.net c# web 应用程序的引用

1.  我正在使用 Visual Studio 2010 和 .net ver 2
2.  我添加了一个普通的 dll，例如 ajaxcontroltoolkit 或 sqlserversmo 和...

当我添加对我的项目的引用时得到这个提示

无法添加。请确保该文件是可访问的，并且它是一个有效的程序集或 COM 组件。

经过多次搜索后，我尝试了 TLIMB.exe 和 STrongname 但收到此错误 my.dll is not a valid type of library

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:21:32.297

包装在您尝试添加的 NET 程序集中的底层 COM 组件（即：SQL Server SMO）似乎没有注册。尝试先重新安装它。

其他更简单的想法：您是否以管理员身份运行 VS？

# php - jQuery更改值，使用ajax Mysql在数据库中绑定

> ID：14080049
> 
> 赞同：0
> 
> 时间：2012-12-29T08:35:42.523
> 
> 标签：php, jquery, ajax

我的情况是：当我点击我的 StatusCheck（它有 0 值）链接图像时，当我点击我需要该值为 1 ant 时，它会在我的数据库表中从 0 变为 1 ...，我知道这件事与 ajax 一样，我该怎么做？

这是我的代码

```
 $(function() {
          $('.imageCheck').click(function(e){
           e.preventDefault();
          $(this).find("#bg").attr('src',"/application/admin/img/tick.png");  

         var image_id = $('#bg').attr('image_id');

           $.ajax({
         type: "GET",
         url: "content_users_blog.php",
         data: {image_id: image_id},
         success:
             function(data){
                data();
                 $('#bg').attr('value', '1');
            }
     });
   });
});    

</script>  
<th>Status</th>

            </tr>
        </thead>
        <tbody>
            <?php 
            foreach ($users as $user):

            ?>
            <tr>
                <td><?=$user['id']?></td>
                <td>                                                      
<div class="imageCheck"><img id="bg" src="<?php echo $img_path;?>publish_x.png"  
 name="statusCheck" value="0" />

    </div>                                                     
                                        </td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:43:57.613

您首先需要创建一个 PHP 页面来增加数据库中的值。你可以这样做：

```
<?php
$con = mysql_connect('localhost', 'user', 'pass');
$db = mysql_select_db('mydatabase');
$id = (int) $_GET['id'];
$update = mysql_query("UPDATE mytable SET statuscheck=1 WHERE id=".$id." LIMIT 1");
mysql_close($con);
?> 
```

然后您需要加载此页面以进行更改。您可以将此功能绑定到按钮或类似的东西：

```
function updateStatus(eID) {
$.ajax({
       url: 'updatestatus.php?id='+eID,
       cache: false,
       success: function(data) {
            // page loaded successfully, do any additionally coding here
       }
    });
} // end function 
```

然后只需将此功能绑定到这样的按钮：

```
<input type="button" value="Update Status" onclick="updateStatus(1);" /> 
```

单击按钮时，ID 为 1 的条目将在数据库中更新。

# vba - Excel/VBA：转置和“刷新”表

> ID：14080059
> 
> 赞同：4
> 
> 时间：2012-12-29T08:38:19.293
> 
> 标签：vba, excel

我想自动化以下过程：

1.  有一个我想要转置的数据表。
2.  然后“向左冲洗”。

随着时间的推移，行数和列数会增加。下面的屏幕截图应该更好地解释（使用 SkyDrive）：[http ://sdrv.ms/UdDu1o](http://sdrv.ms/UdDu1o)

![在此处输入图像描述](../Images/9986fcb442ca72ccf4e26fc4114b4d2c.png)

我能想到的唯一方法是在复制之前使用`VBA`、 via`pastespecial-transpose`和许多`do-while`语句来查找行的开头和结尾。我了解复制和粘贴往往会减慢 VBA 程序的速度 - 有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:41:01.747

表格布局如下图所示。
电子表格示例：[http ://www.bumpclub.ee/~jyri_r/Excel/Transpose_and_flush_data.xls](http://www.bumpclub.ee/~jyri_r/Excel/Transpose_and_flush_data.xls)

输出列标题：`=OFFSET($B$2;C15;$A16)`，从 复制到右侧`C16`。
输出行标题：`=OFFSET($B$2;0;$A17)`，从辅助单元格中复制下来`B17`
：在 A 列中输出表格数据行号，在第 15 行中输出数据列号。

表格的数字部分可以用 中的单个公式构建`C17`，向下和向右复制：

```
 =IF(B18="";"";OFFSET($B2;C$15;$A17)) 
```

Weeks 列以“x”结尾，以获得第一个数据列的空白单元格。

![截屏：](../Images/ed4dcb3fda25153fe476ff3cedd69367.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:01:45.023

您可以使用以下方法非常简单地实现此目的`Variant Array`：

```
Sub Demo()
    Dim sh As Worksheet
    Dim rSource As Range
    Dim vSource As Variant

    Set sh = ActiveSheet
    ' set range to top left cell of table
    Set rSource = sh.Cells(1, 1) '<-- adjust to suit
    ' extend range
    '  this assumes there are no gaps in the top row or left column
    Set rSource = sh.Range(rSource.End(xlDown), rSource.End(xlToRight))
    With rSource
        ' remove Totals
        .Columns(.Columns.Count).Clear
        .Rows(.Rows.Count).Clear

        ' capture source data
        vSource = rSource
        ' clear old data
        rSource.Clear
        ' transpose and place data back
        sh.Range(.Cells(1, 1), .Cells(.Columns.Count, .Rows.Count)) = _
            Application.Transpose(vSource)
    End With
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:44:11.160

好的 - 已经使用 Chris 的代码作为模板，并且在进行转置之前有效地添加了两行额外的代码以消除空白：

```
Sub ThisWorks()

Dim sh As Worksheet
Dim rSource As Range
Dim vSource As Variant

Set sh = ActiveSheet
' set range to top left cell of table
Set rSource = sh.Cells(5, 3) '<-- adjust to suit
' extend range
'  this assumes there are no gaps in the top row or left column
Set rSource = sh.Range(rSource.End(xlDown), rSource.End(xlToRight))
With rSource
    ' remove Totals
    .Columns(.Columns.Count).Clear
    .Rows(.Rows.Count).Clear
End With
'reset rSource
Set rSource = sh.Range(rSource.End(xlDown), rSource.End(xlToRight))

With rSource
    ' delete the blanks - not as tricky as you mentioned in OP!!
    .SpecialCells(Excel.xlCellTypeBlanks).Delete Excel.xlUp
    ' capture source data
    vSource = rSource
    ' clear old data
    rSource.Clear
    ' transpose and place data back
    sh.Range(.Cells(1, 1), .Cells(.Columns.Count, .Rows.Count)) = Application.Transpose(vSource)
End With

End Sub 
```

在执行上述操作之前，我花了 90 分钟将头撞在砖墙上——我尝试将所有值添加到一个数组中，然后以正确的顺序将它们清空。如果你能看到如何让以下工作，请让我知道，因为我相信这是可能的！......

```
Option Explicit
Option Base 1

Sub ThisDoesNOTwork()

Dim sh As Worksheet
Dim rSource As Range
Dim vSource As Variant

Set sh = ActiveSheet
' set range to top left cell of table
Set rSource = sh.Cells(5, 3) '<-- adjust to suit
' extend range
'  this assumes there are no gaps in the top row or left column
Set rSource = sh.Range(rSource.End(xlDown), rSource.End(xlToRight))
With rSource
    ' remove Totals
    .Columns(.Columns.Count).Clear
    .Rows(.Rows.Count).Clear
End With
'reset rSource
Set rSource = sh.Range(rSource.End(xlDown), rSource.End(xlToRight))

Dim tableWidth As Integer
tableWidth = rSource.Rows.Count

Dim numbers() As Variant
ReDim numbers(rSource.Cells.Count)

'add numbers into the array
Dim x, y, z As Integer
z = 1
For y = 1 To rSource.Columns.Count
    For x = 1 To rSource.Rows.Count
            numbers(z) = rSource(x, y)
            z = z + 1
    Next
 Next

' clear old data
rSource.Clear

'empty the array
Dim myValue
Dim i As Integer
Dim blanks As Integer
i = 0
blanks = 0

Dim c As Integer
For c = 1 To UBound(numbers)

        i = i + 1
        If numbers(i) = "" Then
            blanks = blanks + 1
        Else
            rSource.Cells(i) = numbers(c)
        End If

Next c
Debug.Print blanks

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:39:31.627

我试图坚持使用数组（通常我喜欢反过来;-) 只有数值被转置，用户进行选择。`"Vba_output"`应在工作表上预先定义命名范围。

```
Sub Transpose_and_flush_table()

Dim source_array As Variant
Dim target_array As Variant
Dim source_column_counter As Long
Dim source_row_counter As Long
Dim blanks As Long

Const row_index = 1
Const col_index = 2

source_array = Selection.Value
' source_array(row,column)

ReDim target_array(UBound(source_array, col_index), UBound(source_array, row_index))

For source_column_counter = _
    LBound(source_array, col_index) To UBound(source_array, col_index)
       blanks = 0

      'Count blank cells
      For source_row_counter = _
         LBound(source_array, row_index) To UBound(source_array, row_index)
           If source_array(source_row_counter, source_column_counter) = "" Then
              blanks = blanks + 1
           End If
       Next

      'Replace blanks, shift array elements to the left
      For source_row_counter = _
         LBound(source_array, row_index) To UBound(source_array, row_index) - blanks
           source_array(source_row_counter, source_column_counter) = _
             source_array(source_row_counter + blanks, source_column_counter)
      Next

      'Add blanks to the end
      For source_row_counter = _
        UBound(source_array, row_index) - blanks + 1 To UBound(source_array, row_index)
           source_array(source_row_counter, source_column_counter) = ""
      Next

      'Transpose source and target arrays
      For source_row_counter = _
         LBound(source_array, row_index) To UBound(source_array, row_index)
             target_array(source_column_counter, source_row_counter) = _
            source_array(source_row_counter, source_column_counter)
      Next

Next

Range("Vba_output").Offset(-1, -1).Resize(UBound(target_array, row_index) + 1, _
  UBound(target_array, col_index) + 1) = target_array

End Sub 
```

# mysql - SELECT FROM view1, view2 当数据可用时（JOIN？）

> ID：14080060
> 
> 赞同：0
> 
> 时间：2012-12-29T08:38:23.833
> 
> 标签：mysql, select, join, multiple-tables

我不是 SQL 专家，我只是尝试了所有`JOIN`MySQL 提供的服务。

1.  我主要需要来自 view1 的数据，使用`WHERE`, `ORDER BY`,`LIMIT`带有偏移量（如果没有这些条件，数据是不正确的。）
2.  view1 不受 view2 限制
3.  数据也需要从 view2 中提取，但 view2 有它自己的`WHERE`（或任何最好的）条件
4.  view2 可能没有对应的数据，但不链接到 view1 就不能被抓取（`NULL`s 就好了！）

我只会给你两个`SELECT`对我有用的，而不是我想出的哈希值。

对于视图1：

```
SELECT * FROM view1 
WHERE column1 IS NULL OR column1 = 1 
ORDER BY dateColumn DESC LIMIT index1, count1; 
```

（index1 和 count1`IN`用于存储过程）

对于视图2：

```
SELECT * FROM table2 
WHERE column1 = ? AND table1_id IN (
  SELECT id FROM view1 
  WHERE column1 IS NULL OR column1 = 1 
  ORDER BY dateColumn DESC LIMIT index1, count1
) 
GROUP BY table1_id 
```

（？是我输入的任意值）

我无计可施。我不知道如何融合这两个。

**细节**

请注意，`IN`for`view2`几乎与`view1`查询相同。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:43:12.200

您可以编写子查询`table2`并在那里添加 WHERE 子句，也可以在查询的条目处添加 WHERE 子句 -

```
SELECT * FROM table2 t2
  JOIN (
       SELECT id FROM table1
       WHERE column1 IS NULL OR column1 = 1
       ORDER BY dateColumn DESC
       LIMIT index1, count1
       ) t1
    ON t1.id = t2.table1_id
WHERE
  t2.column1 = ?
GROUP BY
  t2.table1_id 
```

在这个例子中，我使用了 JOIN 而不是`WHERE IN`条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:46:39.523

这个查询怎么样：

```
Select t1.id 
FROM table1 t1
JOIN table2 t2 ON t1.id = t2.table1_id
WHERE t1.column1 IS NULL OR t1.column1 = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:00:32.480

我认为它应该对你有帮助

```
Select TableName1.id 
FROM TableName1 
JOIN TableName2 ON TableName1.id = TableName2.id
WHERE TableName1.column1 IS NULL OR TableName1.column1 = 1 
```

# delphi - 无法将公钥加载到内存

> ID：14080061
> 
> 赞同：2
> 
> 时间：2012-12-29T08:38:30.933
> 
> 标签：delphi, openssl

我已经生成了一对私钥/公钥，并且我设法加载了私钥来签署一些字节。当我尝试从内存中加载公钥以验证签名时，就会出现问题。

这是一些代码：

```
 privateKey := BIO_new(BIO_s_mem);
  PEM_write_bio_RSAPrivateKey(privateKey,rsa,enc,nil,0,nil,PChar('1234567890'));
  publicKey := BIO_new(BIO_s_mem);
  PEM_write_bio_RSAPublicKey(publicKey,rsa);
  WriteLn(GetErrorMessage);
  //No error so far
  Writeln('Keys generated!');
  pKey := nil;
  PEM_read_bio_PrivateKey(privateKey,pKey,nil,PChar('1234567890'));
  // pKey is ok
  mKey := nil;
  PEM_read_bio_PUBKEY(publicKey,mKey,nil,nil);
  WriteLn(GetErrorMessage); 
```

最后一行输出的错误信息是

```
PEM routines : PEM_read_bio : no start line 
```

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T09:11:35.443

问题是你正在混合`PEM_write_bio_RSAPublicKey()`和`PEM_read_bio_PUBKEY()`. 前者写入一个 PKCS#1 RSAPublicKey 结构，而后者需要一个 SubjectPublicKeyInfo 结构。这两种结构不可互换，因此您在阅读时会出错。

要解决此错误，`PEM_write_bio_RSA_PUBKEY()`请在将您的公钥写入 BIO 时使用。

# jquery - 打开 jquery.min.js 后 Eclipse 变得非常慢

> ID：14080068
> 
> 赞同：3
> 
> 时间：2012-12-29T08:39:14.880
> 
> 标签：jquery, eclipse

正如标题所说，每当我打开一个长的缩小版本的任何 javascript 库（如 jquery 或 Foundation.min.js）时，我的 Eclipse 安装都会变得非常缓慢。有时在重新启动后，事情又恢复正常，直到我打开这些文件。有什么问题吗？或者我可以做一些调整来改善这种情况吗？Eclipse 版本是

```
Eclipse IDE for Java Developers
Version: Kepler Release
Build id: 20121114-2344 
```

我正在使用 Ubuntu linux

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T16:11:41.413

您需要从所有验证器中排除此文件。

项目属性 -> 验证 -> 单击设置按钮 -> 创建或编辑排除组。

此外，执行属性 -> JavaScript -> 包含路径 -> 源 -> 编辑排除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T09:01:59.687

不要在开发中使用缩小文件。使用构建脚本来缩小/丑化/连接生产环境中的 js 资产，但出于开发目的，请使用非缩小版本。

如果您真的认为必须使用 Eclipse 等成熟的 IDE 打开缩小的 javascript 文件，请尝试关闭您拥有的任何代码分析、语法突出显示选项。IDE 引擎在分析其内容时解析长的单行文件可能真的很难，而且我认为突出显示的语法对缩小 js 的帮助不大

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:40:58.567

我做了一些挖掘并决定尝试不同的插件，特别是 [Amateras Javascript Editor] 来打开/编辑 javascript 文件。然后我将默认的 javascript 编辑器更改为这个插件，它的东西好多了。

现在 Eclipse 在打开和/或编辑缩小的 javascript 文件后表现正常。

谢谢所有帮助过的人！

# python - Python 描述符可以是持久的可迭代对象吗？

> ID：14080069
> 
> 赞同：1
> 
> 时间：2012-12-29T08:39:34.130
> 
> 标签：python, xml-serialization, descriptor

我正在按照[http://packages.python.org/dexml/api/dexml.fields.html](http://packages.python.org/dexml/api/dexml.fields.html)或[https://gist.github.com/485977](https://gist.github.com/485977)的方式为 XML 数据开发一个轻量级的类包装器。这些类包含一个 elementTree 元素并具有提供属性访问的描述符（对包含的代码量表示歉意，我认为保留大部分注释会更容易理解）

```
class XPropBase(object):

    DEFAULT_TO = (lambda s, x: str(x))
    DEFAULT_FROM = (lambda s, p: p)

    def __init__(self, path, convert_from=None, convert_to = None, read_only = False, allow_missing=False):
        '''
        important bits here are convert_to and convert_from, which do the translation in and out of XML strings in derived classes...
        '''
        self.path = path
        self.convert_from = convert_from or self.DEFAULT_FROM
        self.convert_to = convert_to or self.DEFAULT_TO
        self.read_only = read_only
        self.allow_missing = allow_missing

    def _get_xml(self, instance):
        #only a an instance method for convenience...
            #intended to be overridden for different target instances
        return instance.get_element()

class XElement(XPropBase):
    '''
    Wraps an xml item whose content is contained in the text  of
    an XML tag, ie:  <tag>Content</tag>. The convert_to and convert_from methods
    will be applied to the text property of the corresponding Element 

    @note this will use the first instance of a given node path that it finds,
    so it is not guaranteed if the supplied path leads to more than one xml tag.
    '''

    def __get__(self, instance, owner=None):

        the_xml = self._get_xml(instance)

        if not self.path: 
            return self.convert_from(the_xml.text)        

        try:
            underlying = the_xml.find(self.path)            
            return self.convert_from(underlying.text)
        except AttributeError:
            if self.allow_missing:
                return None
            else:
                raise XMLWrapperError, "%s has no element named %s" % (instance, self.path)

    def __set__(self, instance, value, owner =None):

        if self.read_only: 
            raise XMLWrapperError('%s is a read-only property' % self.path)        

        the_xml= self._get_xml(instance)
        if not self.path:
            the_xml.text = self.convert_to(value)
            return

        try:
            underlying = self._get_xml(instance).find(self.path)
            underlying.text = self.convert_to(value)
        except AttributeError:
            if self.allow_missing:
                SubElement(self._get_xml(instance), self.path, text=self.convert_to(value))
            else:                
                raise XMLWrapperError, "%s has no element named %s" % (instance, self.path)

class XAttrib(XPropBase):
    '''
    Wraps a property in an attribute on the containing xml tag specified by path

    if the supplied attribute is not present, will raise an XMLWrapperError unless the allow_missing flag is set to True
    '''

    def __get__(self, instance, owner=None):
        try:
            res = self._get_xml(instance).attrib[self.path]      
            return self.convert_from(res)
        except KeyError:
            if self.allow_missing:
                return None
            raise XMLWrapperError, "%s has no attribute named %s" % (instance, self.path)

    def __set__(self, instance, value, owner =None):
        xml = self._get_xml(instance)
        has_element = xml.get(self.path, 'NOT_FOUND')
        if has_element == 'NOT_FOUND' and not self.allow_missing:
            raise XMLWrapperError, "%s has no attribute named %s" % (instance, self.path)
        xml.set(self.path, self.convert_to(value))

    def _get_element(self):
        return None

    def _get_attribute(self):
        return self.path

class XInstance(XPropBase):
    '''
    Represents an attribute which is mapped onto a class. The supplied class is specified in the constructor

    @note: As with XElement, this works on the first appropriately named tag it
    finds. If there are multiple path values with the same tag, it will cause
    errors.
    '''

    def __init__(self, path, cls, convert_from=None, convert_to = None, read_only = False, allow_missing=False):        
        self.cls = cls        
        XPropBase.__init__(self, path, convert_from = convert_from , convert_to = convert_to , read_only = read_only, allow_missing=allow_missing)

    def __get__(self, instance, owner=None):
        sub_elem = self._get_xml(instance).find(self.path)
        if not sub_elem and not self.allow_missing:
            XMLWrapperError, "%s has no child named %s" % (instance, self.path) 
        return self.cls(sub_elem)

    def __set__(self, instance, value):
        my_element  = self._get_xml(instance)
        original_child = my_element.find(self.path)
        if original_child:
            my_element.remove(original_child)
        my_element.append(self._get_xml(value))

class XInstanceGroup(XInstance):
    '''
    Represents a collection of XInstances contained below a particular tag

    '''

    def __get__(self, instance, owner=None):
        return [self.cls(item) for item in self._get_xml(instance).findall(self.path)]

    def __set__(self, instance, value):
        my_element  = self._get_xml(instance)
        for item in my_element.findall(self.path):
            my_element.remove(item)
        for each_element in map(self._get_xml, value):
            my_element.append(each_element) 
```

似乎有效（尽管要进行彻底的测试），但有一点令人讨厌。XInstanceGroup 描述符处理如下情况：

```
<Object name="dummy">
    <Child name="kid2" blah="dee blah"/>
    <Child name="kid2" blah="zey"/>
</Object>

class Kid(XMLData):
    Name = XAttribute("name")
    Blah = XAttribute("blah")

class DummyWrapper(XMLData):
    Name = XAttribute("name")
    Kids = XInstanceGroup('Child', Kid) 
```

因此，如果您将 DummyWrapper 用于它的孩子，您将获得 Kid 对象的列表。但是我对更新该列表的过程不满意：

```
 #this works
 kids = Dummy_example.Kids
 kids.append(Kid (name = 'marky mark', blah='funky_fresh'))
 Dummy_example.Kids = kids

 #this doesn't
 Dummy_example.Kids.append(Kid(name = 'joey fatone', blah = 'indeed!')) 
```

这是因为 Dummy.Kids 实际上是一个返回组的函数，而不是存储为成员字段的持久列表对象。

现在的问题是：有没有办法使用描述符来做到这一点？似乎障碍在于描述符实例无法持久化数据 - 它只在调用实例时才知道实例。我不喜欢以某种方式将存储从描述符注入实例的想法（如果没有别的，它会增加令人不快的耦合）。到目前为止，明显的谷歌搜索没有帮助。

# node.js - 使用 npm 安装包

> ID：14080077
> 
> 赞同：0
> 
> 时间：2012-12-29T08:40:38.967
> 
> 标签：node.js, express

我正在尝试使用以下方式安装 npm：

```
sudo npm install azure@0.6.9
npm http GET https://registry.npmjs.org/azure/0.6.9
npm http 304 https://registry.npmjs.org/azure/0.6.9

npm ERR! Unsupported
npm ERR! Not compatible with your version of node/npm: azure@0.6.9
npm ERR! Required: {"node":">= 0.6.15"}
npm ERR! Actual:   {"npm":"1.1.4","node":"0.6.12"}
npm ERR!
npm ERR! System Linux 3.2.0-31-virtual
npm ERR! command "node" "/usr/bin/npm" "install" "azure@0.6.9"
npm ERR! cwd /home/azureuser/nvm/bin
npm ERR! node -v v0.6.12
npm ERR! npm -v 1.1.4
npm ERR! code ENOTSUP
npm ERR! message Unsupported
npm ERR! errno {}
npm ERR!
npm ERR! Additional logging details can be found in:
npm ERR!     /home/azureuser/nvm/bin/npm-debug.log
npm not ok
$ node --version
v0.8.16 
```

不确定它从哪里获取版本号（或）为什么在 nvm 中的使用也没有生效。你能告诉我我错过了什么吗

# jquery - jQuery XML 解析

> ID：14080083
> 
> 赞同：0
> 
> 时间：2012-12-29T08:42:01.323
> 
> 标签：jquery, xml

可以说我有一个 xml ..“xml2.xml”

```
<aurora>
<event> abc </event>
<event> abc </event>
<event> abc </event>
<event> 
<subeve> def </subeve>
<subeve> def </subeve>
<subeve> def </subeve>
</event>
<event> 
<subeve> def </subeve>
<subeve> def </subeve>
<subeve> def </subeve>
</event>
</aurora> 
```

还有一个jquery代码..

```
<script>
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "xml2.xml",
        dataType: "xml",
        success: xmlParser
    });
});
function xmlParser(xml) {
    $(xml).find("event").each(function () {

        $(".slides").append('<b>1');

        $(this).find("subeve").each(function () {
        $(".slides").append('<i>2</i>');
        });
        $(".slides").append('</b>');

    });
}
</script> 
```

输出是：`<b>1111</b><i>222</i><b>1</b><i>222</i>`

但我希望输出是..：`<b>1111<i>222</i>1<i>222</i></b>`

我怎样才能做到这一点..？？

我的第二个问题.. 我的第一个问题真的很傻吗？:-<

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T08:47:16.460

您正在考虑标记（`<b>`然后是稍后`</b>`），但是一旦您处理 DOM 元素，您就是在处理对象，而不是标记。具体来说，当你这样做时`$(".slides").append("<b>");`，它*会创建*一个`b`元素并将其附加到`slides`. 它不会“打开”`<b>`标签。然后，当您稍后执行此操作时`$(".slides").append("<i>2</i>");`，它会创建一个`i`元素并将其附加到幻灯片，*在*元素之后，`b`而不是在其中。我不知道 jQuery 做什么`.append("</b>")`，不要那样做。:-)

您可以构建元素并随时附加它们（将`i`元素附加到 each `b`，然后附加`b`到`.slides`），或者构建一个标记字符串并`.slides`在完成后将其附加到。

第一个选项，构建元素，可能如下所示：

```
function xmlParser(xml) {
  var slides = $(".slides");

  $(xml).find("event").each(function () {

    var b = $("<b>").text("1");

    $(this).find("subeve").each(function () {
      b.append('<i>2</i>');
    });

    slides.append(b);
  });
} 
```

[实例](http://jsbin.com/uhexaj/2)| [来源](http://jsbin.com/uhexaj/2/edit)

第二个选项，建立标记，可能如下所示：

```
function xmlParser(xml) {
  var markup = [];

  $(xml).find("event").each(function () {

    markup.push('<b>1');

    $(this).find("subeve").each(function () {
      markup.push('<i>2</i>');
    });

    markup.push('</b>');
  });

  $(".slides").append(markup.join(""));
} 
```

[实例](http://jsbin.com/uhexaj/1)| [来源](http://jsbin.com/uhexaj/1/edit)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T08:48:10.180

如果您只想让所有内容都以粗体显示，请使用 CSS：

```
.slides{

    font-weight:bold;

} 
```

如果您想将 HTML 标记用于某些不同的目的，我强烈建议您使用某种形式的模板，而不是使用 jQuery 创建原始 HTML。

# c++ - new 什么时候分配内存？

> ID：14080084
> 
> 赞同：0
> 
> 时间：2012-12-29T08:42:11.327
> 
> 标签：c++, memory-management, map, new-operator

我有以下程序：

```
#include<iostream>
#include<map>

using namespace std;

int  *ar;

int main(int argc, const char *argv[])
{
    int N,i;
    map <int , int> W;
    ar = new int[N+1];
    cin >> N;
    for (i = 1; i <= N; i++) {
        cin >> ar[i];
    }
    W[ar[N]]= -1;   
    return 0;
} 
```

我给程序以下输入：

```
6

1 1 2 2 3 4 
```

如果我使用 g++ -O 选项（没有优化）编译上面的代码，我会在该行得到 segabrt

```
W[ar[N]]= -1; 
```

两个问题：

1.  是不是 ar[] 没有被 new 分配内存？如果我用某个常数值替换该行，我会得到同样的错误。

    ```
    W[4] = -1; 
    ```

2.  地图是否需要某种初始化？它通常无需初始化即可为我工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T08:45:43.323

你有这两行向后：

```
ar = new int[N+1];   // Here the value of 'N' is undefined (random)
                     // So the number of values you get is also random (+1)
cin >> N; 
```

使用前需要先加载`N`：

```
cin >> N;
ar = new int[N+1];  // Now N is defined and you get the requested number of values. 
```

# javascript - Chrome 用户代理不会改变

> ID：14080086
> 
> 赞同：0
> 
> 时间：2012-12-29T08:42:32.307
> 
> 标签：javascript, google-chrome, google-chrome-extension, user-agent

我有一个 chrome 扩展，可以更轻松地向用户展示 Google 翻译。如果用户想在新窗口中查看翻译，则有一个选项。为了在新窗口中显示翻译页面，我想向用户显示一个紧凑的翻译页面。我想更改 USER-AGENT 以向用户显示 Google 翻译的移动版本。

我试过[这个](https://stackoverflow.com/questions/10334909/associate-a-custom-user-agent-to-a-specific-google-chrome-page-tab)，这是我打开新窗口的功能，但窗口的用户代理没有改变，我不知道如何解决这个问题：

```
function OpenURL(url, tab)
{

    if(config.tab=="true")
    {
        var id = tab.index +1;
        chrome.tabs.create({'url': url, 'index': id});
    }
    else
    {
        chrome.webRequest.onBeforeSendHeaders.addListener(
        function(info) {
            // Replace the User-Agent header
            var headers = info.requestHeaders;
            headers.forEach(function(header, i) {
                if (header.name.toLowerCase() == 'user-agent') { 
                    header.value = 'Mozilla/5.0(iPad; U; CPU iPhone OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B314 Safari/531.21.10';
                }
            });  
            return {requestHeaders: headers};
        },
        // Request filter
        {
            // Modify the headers for these pages
            urls: [
                "*translate.google.com*",
            ],
            // In the main window and frames
            types: ["main_frame", "sub_frame"]
        },
        ["blocking", "requestHeaders"]
        );
        newwindow = window.open(url, "_blank", "resizable=yes, scrollbars=yes, titlebar=yes");
    }
} 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:58:47.600

`"*translate.google.com*",`是无效的[匹配模式](https://developer.chrome.com/extensions/match_patterns.html)，请尝试
`"*://translate.google.com/*"`。

# c# - 列表视图中的子项未显示

> ID：14080093
> 
> 赞同：1
> 
> 时间：2012-12-29T08:44:07.820
> 
> 标签：c#, listview

我创建了一个程序，您可以在其中使用按钮将文本放入富文本框中。单击按钮时，此文本框中的文本将放入列表视图中，每行都有一个复选框。此列表视图只有 1 列。

现在，我想将一些行作为子项放入，并从父项中删除复选框，就像一棵树一样。但是，我现在只看到父母，子项目没有显示。我也不知道如何从父母那里删除复选框。

我看到了树视图类，但我不希望每行之前的那些点，我不知道你是否可以在那里添加复选框。

这是我的代码

```
 private void ParseButton_Clicked(object sender, EventArgs e)
    {
       string[] entries = rawLogBox.Text.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.None);

       ListViewItem parent = null;
       foreach (string entry in entries)
       {
           if (Regex.IsMatch(entry, "^={10} .* ={10}$"))
           {
               parent = new ListViewItem(entry);
               parsedLogBox.Items.Add(parent);
           }
           else
           {
               if (parent == null)
               {
                   parsedLogBox.Items.Add(new ListViewItem(entry));
               }
               else
               {
                   new ListViewItem.ListViewSubItem(parent, entry);
               }
           }                 
       }
       parsedLogBox.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent);
    } 
```

列表视图设置为详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:06:26.750

您必须像这样添加子项：

```
parent.SubItems.Add(entry) 
```

另见[这个问题](https://stackoverflow.com/questions/729090/c-how-to-add-subitems-in-listview)

编辑：用于控制树视图中的复选框：[TreeView Remove CheckBox by some Nodes](https://stackoverflow.com/questions/4826556/treeview-remove-checkbox-by-some-nodes)

# angularjs - AngularJS 承诺

> ID：14080095
> 
> 赞同：10
> 
> 时间：2012-12-29T08:44:27.067
> 
> 标签：angularjs, angular-promise

AngularJS 文档[说](http://docs.angularjs.org/api/ng.$q)：

> $q promises 被 Angular 模板引擎识别，这意味着在模板中，您可以将附加到范围的 Promise 视为结果值。

那么有人可以解释一下这个[小提琴](http://jsfiddle.net/RamanChodzka/Rbg8C/)不起作用的原因吗？无法更改文本字段值。但是，将 $http 服务返回到范围字段的承诺分配起来就像一个魅力。

**控制器：**

```
function MyController($scope, $q, $timeout) {
    this.getItem = function () {
        var deferred = $q.defer();
        deferred.resolve({
            title: 'Some title'
        });
        return deferred.promise;
    };

    $scope.item = this.getItem();
} 
```

**html:**

```
<input type="text" ng-model="item.title"> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-29T10:31:53.057

您需要在 promise 对象上使用 then() 函数：

```
this.getItem().then(function(result) {
   $scope.item = result;
}); 
```

在你的情况下，我认为你不需要承诺。Angular 的 $watch 系统会处理这些事情。[只需在函数中返回一个对象，而不是原始类型](https://stackoverflow.com/a/10447955/1916258)：

```
this.getItem = function () {
    var item = {};

    // do some async stuff
    $http.get(...).success(function(result) {
       item.title = result;
    });
    return item;
};

$scope.item = this.getItem(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:07:46.020

我相信你的第一个小提琴不起作用的原因是因为你本质上是将范围属性绑定`item`到一个承诺。当您尝试通过在文本字段中键入来更改值时，角度会注意到活动，然后将值重新分配/重置为`item`承诺的结果（未更改）。

`item`当 promise 被解决时，@asgoth 提供的解决方案设置/分配一次的值。这里没有绑定（即`item`不绑定到承诺），因此通过文本框更改值确实会更改值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-29T19:36:03.933

就像@Mark 说的，在这里你可以找到你的代码片段的[工作示例](http://jsfiddle.net/IvoReis/Rbg8C/33/)。

基本上你是在返回一个对象而不是绑定模型本身。

```
$timeout(function(){
   $scope.item = {
      title: 'Some title'
   }; // Apply the binding
   deferred.resolve(); // Resolve promise
},2000); // wait 2 secs 
```

# android - 为什么 adb 不能在脚本文件中工作

> ID：14080097
> 
> 赞同：-1
> 
> 时间：2012-12-29T08:44:38.363
> 
> 标签：android, shell, android-ndk

我已经导出了`adb`'s 路径。但是，当我使用`adb shell`它时，它会提示我已经连接到电脑的设备。而且，每个 adb pull 都可以工作，比如，

```
 adb pull /system/bin/akmd2 ../../../vendor/huawei/$DEVICE/proprietary/bin/akmd2
    477 KB/s (132364 bytes in 0.270s) 
```

但是当`adb pull`sript 文件中使用的命令时，它会失败。

并提示错误：

```
./extract-files.sh: 31: adb: not found
./extract-files.sh: 32: adb: not found
./extract-files.sh: 33: adb: not found
./extract-files.sh: 34: adb: not found
./extract-files.sh: 36: adb: not found
./extract-files.sh: 37: adb: not found
./extract-files.sh: 38: adb: not found
./extract-files.sh: 39: adb: not found
./extract-files.sh: 41: adb: not found
./extract-files.sh: 42: adb: not found
./extract-files.sh: 44: adb: not found
./extract-files.sh: 45: adb: not found
./extract-files.sh: 46: adb: not found
./extract-files.sh: 47: adb: not found
./extract-files.sh: 48: adb: not found
./extract-files.sh: 49: adb: not found
./extract-files.sh: 50: adb: not found
./extract-files.sh: 51: adb: not found
./extract-files.sh: 52: adb: not found
./extract-files.sh: 53: adb: not found
./extract-files.sh: 54: adb: not found
./extract-files.sh: 55: adb: not found
./extract-files.sh: 56: adb: not found
./extract-files.sh: 57: adb: not found
./extract-files.sh: 58: adb: not found
./extract-files.sh: 59: adb: not found
./extract-files.sh: 60: adb: not found
./extract-files.sh: 61: adb: not found
./extract-files.sh: 62: adb: not found
./extract-files.sh: 63: adb: not found
./extract-files.sh: 64: adb: not found
./extract-files.sh: 65: adb: not found
./extract-files.sh: 66: adb: not found
./extract-files.sh: 67: adb: not found
./extract-files.sh: 68: adb: not found
./extract-files.sh: 69: adb: not found
./extract-files.sh: 70: adb: not found
./extract-files.sh: 71: adb: not found
./extract-files.sh: 72: adb: not found
./extract-files.sh: 73: adb: not found
chmod: cannot access `../../../vendor/huawei/c8500/proprietary/bin/*': No such file or directory 
```

这是我的脚本文件：

```
#!/bin/sh

# Copyright (C) 2010 The Android Open Source Project
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Extract prebuilt libraries (from a CM7 running device) needed for the C8500

DEVICE=c8500

DIRS="
bin
lib/hw
etc
"

for DIR in $DIRS; do
    mkdir -p ../../../vendor/huawei/$DEVICE/proprietary/$DIR
done

adb pull /system/bin/akmd2 ../../../vendor/huawei/$DEVICE/proprietary/bin/akmd2
adb pull /system/bin/hci_qcomm_init ../../../vendor/huawei/$DEVICE/proprietary/bin/hci_qcomm_init
adb pull /system/bin/qmuxd ../../../vendor/huawei/$DEVICE/proprietary/bin/qmuxd
adb pull /system/bin/rild ../../../vendor/huawei/$DEVICE/proprietary/bin/rild

adb pull /system/etc/01_qc.cfg ../../../vendor/huawei/$DEVICE/proprietary/etc/01_qc.cfg
adb pull /system/etc/AudioFilterC8500.csv ../../../vendor/huawei/$DEVICE/proprietary/etc/AudioFilterC8500.csv
adb pull /system/etc/init.qcom.bt.sh ../../../vendor/huawei/$DEVICE/proprietary/etc/init.qcom.bt.sh
adb pull /system/etc/pvplayer.cfg ../../../vendor/huawei/$DEVICE/proprietary/etc/pvplayer.cfg

adb pull /system/lib/hw/gralloc.msm7k.so ../../../vendor/huawei/$DEVICE/proprietary/lib/hw/gralloc.msm7k.so
adb pull /system/lib/hw/sensors.default.so ../../../vendor/huawei/$DEVICE/proprietary/lib/hw/sensors.default.so

adb pull /system/lib/libaudioeq.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libaudioeq.so
adb pull /system/lib/libcamera.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libcamera.so
adb pull /system/lib/libcm.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libcm.so
adb pull /system/lib/libdiag.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libdiag.so
adb pull /system/lib/libdll.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libdll.so
adb pull /system/lib/libdsm.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libdsm.so
adb pull /system/lib/libdss.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libdss.so
adb pull /system/lib/libgsdi_exp.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libgsdi_exp.so
adb pull /system/lib/libgstk_exp.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libgstk_exp.so
adb pull /system/lib/libmm-adspsvc.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmm-adspsvc.so
adb pull /system/lib/libmm-omxcore.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmm-omxcore.so
adb pull /system/lib/libmmgsdilib.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmmgsdilib.so
adb pull /system/lib/libmmipl.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmmipl.so
adb pull /system/lib/libmmjpeg.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmmjpeg.so
adb pull /system/lib/libmmprocess.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libmmprocess.so
adb pull /system/lib/libnv.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libnv.so
adb pull /system/lib/libOmxCore.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libOmxCore.so
adb pull /system/lib/libOmxH264Dec.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libOmxH264Dec.so
adb pull /system/lib/libOmxMpeg4Dec.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libOmxMpeg4Dec.so
adb pull /system/lib/libOmxVidEnc.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libOmxVidEnc.so
adb pull /system/lib/libOmxWmvDec.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libOmxWmvDec.so
adb pull /system/lib/liboncrpc.so ../../../vendor/huawei/$DEVICE/proprietary/lib/liboncrpc.so
adb pull /system/lib/libpbmlib.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libpbmlib.so
adb pull /system/lib/libqcamera.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libqcamera.so
adb pull /system/lib/libqmi.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libqmi.so
adb pull /system/lib/libqueue.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libqueue.so
adb pull /system/lib/libril-qc-1.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libril-qc-1.so
adb pull /system/lib/libril-qcril-hook-oem.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libril-qcril-hook-oem.so
adb pull /system/lib/libwms.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libwms.so
adb pull /system/lib/libwmsts.so ../../../vendor/huawei/$DEVICE/proprietary/lib/libwmsts.so

chmod 755 ../../../vendor/huawei/c8500/proprietary/bin/* 

(cat << EOF) | sed s/__DEVICE__/$DEVICE/g > ../../../vendor/huawei/$DEVICE/$DEVICE-vendor-blobs.mk
# Copyright (C) 2010 The AndroidOpen Source Project
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# This file is generated by device/huawei/__DEVICE__/extract-files.sh - DO NOT EDIT

# All the blobs necessary for C8500
PRODUCT_COPY_FILES += \\
    vendor/huawei/__DEVICE__/proprietary/bin/akmd2:system/bin/akmd2 \\
    vendor/huawei/__DEVICE__/proprietary/bin/hci_qcomm_init:system/bin/hci_qcomm_init \\
    vendor/huawei/__DEVICE__/proprietary/bin/qmuxd:system/bin/qmuxd \\
    vendor/huawei/__DEVICE__/proprietary/bin/rild:system/bin/rild

PRODUCT_COPY_FILES += \\
    vendor/huawei/__DEVICE__/proprietary/etc/01_qc.cfg:system/etc/01_qc.cfg \\
    vendor/huawei/__DEVICE__/proprietary/etc/AudioFilterC8500.csv:system/etc/AudioFilterC8500.csv \\
    vendor/huawei/__DEVICE__/proprietary/etc/init.qcom.bt.sh:system/etc/init.qcom.bt.sh \\
    vendor/huawei/__DEVICE__/proprietary/etc/pvplayer.cfg:system/etc/pvplayer.cfg

PRODUCT_COPY_FILES += \\
    vendor/huawei/__DEVICE__/proprietary/lib/hw/gralloc.msm7k.so:system/lib/hw/gralloc.msm7k.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/hw/sensors.default.so:system/lib/hw/sensors.default.so

PRODUCT_COPY_FILES += \\
    vendor/huawei/__DEVICE__/proprietary/lib/libaudioeq.so:system/lib/libaudioeq.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libcamera.so:system/lib/libcamera.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libcamera.so:obj/lib/libcamera.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libcm.so:system/lib/libcm.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libdiag.so:system/lib/libdiag.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libdll.so:system/lib/libdll.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libdsm.so:system/lib/libdsm.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libdss.so:system/lib/libdss.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libgsdi_exp.so:system/lib/libgsdi_exp.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libgstk_exp.so:system/lib/libgstk_exp.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmm-adspsvc.so:system/lib/libmm-adspsvc.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmm-omxcore.so:system/lib/libmm-omxcore.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmmgsdilib.so:system/lib/libmmgsdilib.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmmipl.so:system/lib/libmmipl.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmmjpeg.so:system/lib/libmmjpeg.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libmmprocess.so:system/lib/libmmprocess.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libnv.so:system/lib/libnv.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libOmxCore.so:system/lib/libOmxCore.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libOmxH264Dec.so:system/lib/libOmxH264Dec.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libOmxMpeg4Dec.so:system/lib/libOmxMpeg4Dec.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libOmxVidEnc.so:system/lib/libOmxVidEnc.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libOmxWmvDec.so:system/lib/libOmxWmvDec.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/liboncrpc.so:system/lib/liboncrpc.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libpbmlib.so:system/lib/libpbmlib.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libqcamera.so:system/lib/libqcamera.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libqmi.so:system/lib/libqmi.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libqueue.so:system/lib/libqueue.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libril-qc-1.so:system/lib/libril-qc-1.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libril-qcril-hook-oem.so:system/lib/libril-qcril-hook-oem.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libwms.so:system/lib/libwms.so \\
    vendor/huawei/__DEVICE__/proprietary/lib/libwmsts.so:system/lib/libwmsts.so

EOF

./setup-makefiles.sh 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:49:59.660

adb 应该在这里以超级用户身份运行。如果我切换到#su，则 ~ 表示 /root 而不是我的主目录。所以，你必须使用 linux-sdk-platform 的绝对路径而不是 ~ 的相对路径。

# c# - 将 Object[] 数组转换为整数数组

> ID：14080103
> 
> 赞同：2
> 
> 时间：2012-12-29T08:45:25.527
> 
> 标签：c#

将对象数组转换为整数数组的最简单方法是什么？

```
ArrayList al = new ArrayList();
 object arrayObject = al.ToArray(); 
int[]arrayInteger = ? 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T08:47:30.070

如果你导入`System.Linq`命名空间，你可以这样做：

```
int[] arrayInteger = a1.Cast<int>().ToArray(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T08:48:21.717

采用`int[]arrayInteger = (int[])al.ToArray(typeof(int));`

但除非您使用的是 .Net 1.1，否则请使用 a `List<int>`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-26T20:47:03.147

(object[] eventTypes) 假设 eventTypes 都是具有整数值的对象，这样可以做到：

```
 int[] eventTypeIDs = eventTypes.Select( Convert.ToInt32).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T08:59:02.297

你可以使用`Array.ConvertAll`

```
int[] intArray = Array.ConvertAll<object, int>(al.ToArray(), (o) => (int)o); 
```

需要考虑的一件事是，由于这是一个`object`数组，所有值可能都不是`int` 。这是很方便的事情，`ConvertAll`因为您可以添加简单的转换逻辑来捕获错误。

设想：

```
ArrayList al = new ArrayList() { 1,"hello",3,4,5,6 };
int[] intArray = Array.ConvertAll<object, int>(al.ToArray(), (o) => { int val = -1; return int.TryParse(o.ToString(), out val) ? val : -1;}); 
```

通过这种方式，我们可以`TryParse`对对象执行 a 以避免`InvalidCastException`由于数据错误而导致的任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-16T05:53:39.063

或者 `int[] intArray = object as int[];`

# c# - 显示 SwitchUser 屏幕

> ID：14080110
> 
> 赞同：0
> 
> 时间：2012-12-29T08:45:57.400
> 
> 标签：c#, windows, winforms, customization, user-customization

我正在开发一个应用程序来定制 Windows 7 的切换用户和登录屏幕。

我的应用程序是作为向导构建的，在最后一步中，我希望用户能够通过按下按钮来查看切换用户屏幕，就像他/她在开始菜单中所做的那样：

![在此处输入图像描述](../Images/e1289f4626cc0bbefadd93ab33ced5da.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:56:48.153

在 Windows Vista 中从[**快捷方式提升到切换用户**](http://blog.dotsmart.net/2008/01/17/shortcut-to-switch-user-in-windows-vista/)：

```
using System;
using System.Runtime.InteropServices;
using System.ComponentModel;

class Program
{
  [DllImport("wtsapi32.dll", SetLastError = true)]
  static extern bool WTSDisconnectSession(IntPtr hServer, int sessionId, bool bWait);

  const int WTS_CURRENT_SESSION = -1;
  static readonly IntPtr WTS_CURRENT_SERVER_HANDLE = IntPtr.Zero;

  static void Main(string[] args)
  {
    if (!WTSDisconnectSession(WTS_CURRENT_SERVER_HANDLE,
         WTS_CURRENT_SESSION, false))
      throw new Win32Exception();
  }
} 
```

# php - PHP输出导出excel表

> ID：14080115
> 
> 赞同：-1
> 
> 时间：2012-12-29T08:46:36.860
> 
> 标签：php, arrays, excel

我的代码输出是这样的，它最多可以打印 100 个表行。

我也想用excel导出

```
<h2>Results</h2>
<table width=80%><tr><th width="40%">Head1</th><th nowrap width="20%">Head2</th><th nowrap width="20%">Head3</th></tr>
    <?php $count = count($abc);

    for ($i = 0; $i < $count; $i++)
    {
         $cont=round($abc[$i]->a);
         $pa = $p->get($abc[$i]->u);     
        echo "<tr><td><a href='" . $abc[$i]->u . "' target='_blank'>" . $abc[$i]->u . "</a></td><td align='center'>" . $cont . "</td><td align='center'>" . $pa . "</td></tr>";
    }
    ?>
    </table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T08:49:36.357

尝试 PHPOffice\PHPExcel 库

[https://github.com/PHPOffice](https://github.com/PHPOffice)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T08:52:12.327

有一个鲜为人知的技巧，您可以将 HTML 表格直接导出到 Excel 中。

生成 HTML 表格后，只需通过设置以下标题将其作为下载提供：

```
header("Content-type: application/vnd.ms-excel");
header("Content-Disposition: attachment; filename=test.xls"); 
```

请注意，我建议您`<h2>`在执行此操作之前删除您的 HTML 和您拥有的任何其他 HTML，因此它只留下一个表格。这个小技巧的一个优点是它也会保存您的格式，因此任何粗体文本、背景颜色或其他任何内容都将被保留。如果用户想要一个“真正的”Excel 文件，他们可以简单地保存它。

另一种选择是将其输出为 CSV，或者使用 PHPExcel 等第三方库来实现您所需要的。不过，对于这样简单的输出，我建议在 Excel 中打开 HTML 表，或者 CSV 作为最快的路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T08:49:46.383

这将创建一个名为 output 的 csv 文件

```
if($fh = fopen("output.csv","w")){
    for ($i = 0; $i < $count; $i++){
        $cont=round($abc[$i]->a);
        $pa = $p->get($abc[$i]->u);     
        fputcsv($fh,array($abc[$i]->u,$cont,$pa));
    }
    fclose($fh);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T08:50:55.213

您可以使用下面的代码在 excel 上获取输出

```
$csv_output.='\n';
$csv_output.='<h2>Results</h2>';

    $csv_output.='\n';

 for ($i = 0; $i < $count; $i++)
    {
         $cont=round($abc[$i]->a);
         $pa = $p->get($abc[$i]->u);     
         $csv_output.= $abc[$i]->u . "," . $cont . "," . $pa . "\n";
    }

         header("Content-type: application/vnd.ms-excel");
         header("Content-disposition: csv" . date("Y-m-d") . ".csv");
         header( "Content-disposition: filename=".$filename.".csv");
         print $csv_output; 
```

所以你需要创建一个逗号分隔的字符串，每个 \n 表示 excel 中的新行

# java - Universal-Image-Loader：错误的位图附加到 ImageView

> ID：14080117
> 
> 赞同：11
> 
> 时间：2012-12-29T08:46:40.363
> 
> 标签：java, android, universal-image-loader

我一直在评估[NOSTRA](https://stackoverflow.com/users/913762/nostra)的[Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)库以异步下载图像并在 ListView 中显示它们。到目前为止，它工作正常，除了一个问题。

`ImageViews`有时，当列表滚动时，内存缓存中的位图会附加到错误的位置。滚动停止后，将附加正确的图像。这种情况非常罕见，我找不到 100% 的方法来重现它。上次发生这种情况时，我拍了一个[视频。](http://youtu.be/oS4_-cXSL58)

这是`ArticleAdapter`代码，UIL 配置和`bindView()`方法都可以在那里找到。

```
public class ArticleAdapter extends CursorAdapter {
    private LayoutInflater inflater;
    private ViewHolder holder;

    public ArticleAdapter(Context context, Cursor cursor, boolean autoRequery) {
        super(context, cursor, autoRequery);
        imageLoader = ImageLoader.getInstance();
        DisplayImageOptions options = new DisplayImageOptions.Builder()
                .showStubImage(R.drawable.download_progress_thumb)
                .cacheInMemory()
                .cacheOnDisc()
                .imageScaleType(ImageScaleType.IN_SAMPLE_POWER_OF_2)
                .build();
        ImageLoaderConfiguration configuration = new ImageLoaderConfiguration.Builder(context)
                .threadPriority(Thread.NORM_PRIORITY - 2)
                .threadPoolSize(4)
                .discCache(new UnlimitedDiscCache(Utils.getCacheDirectory(context)))
                .defaultDisplayImageOptions(options)
                .build();
        imageLoader.init(configuration);

        titleIndex = cursor.getColumnIndex(Articles.TITLE);
        descriptionIndex = cursor.getColumnIndex(Articles.DESCRIPTION);
        isUnreadIndex = cursor.getColumnIndex(Articles.IS_UNREAD);
        isNewIndex = cursor.getColumnIndex(Articles.IS_NEW);
        urlIndex = cursor.getColumnIndex(Articles.URL);
        hostIndex = cursor.getColumnIndex(Articles.HOST);
        timeIndex = cursor.getColumnIndex(Articles.PUBLISH_TIME);

        bkgUnreadArticle = context.getResources().getColor(R.color.list_bkg_unread_article);
        bkgReadArticle = context.getResources().getColor(R.color.list_bkg_read_article);
        textUnreadTitle = context.getResources().getColor(R.color.list_text_unread_title);
        textReadTitle = context.getResources().getColor(R.color.list_text_read_title);

        inflater = LayoutInflater.from(context);
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
        String date = Utils.format(cursor.getLong(timeIndex), Utils.DATE);
        holder = (ViewHolder) view.getTag();

        holder.titleView.setText(cursor.getString(titleIndex));
        holder.descriptionView.setText(date);

        int isNew = cursor.getInt(isNewIndex);
        if (isNew == 1)
            holder.isNewView.setVisibility(View.VISIBLE);
        else
            holder.isNewView.setVisibility(View.INVISIBLE);

        int isUnread = cursor.getInt(isUnreadIndex);
        if (isUnread == 1){
            holder.titleView.setTextColor(textUnreadTitle);
            holder.rowLayout.setBackgroundColor(bkgUnreadArticle);
        } else {
            holder.titleView.setTextColor(textReadTitle);
            holder.rowLayout.setBackgroundColor(bkgReadArticle);
        }

        String url = cursor.getString(urlIndex);
        String host = cursor.getString(hostIndex);
        if (host.equalsIgnoreCase(Consts.HOST_LENTA) || host.equalsIgnoreCase(Consts.HOST_REALTY)) {
            holder.thumbView.setVisibility(View.VISIBLE);
            imageLoader.displayImage(Utils.makeImageUrl(url, Utils.THUMBNAIL), holder.thumbView);
        } else 
            holder.thumbView.setVisibility(View.GONE);
    }

    @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        View v = inflater.inflate(R.layout.articlelist_item, null);
        ViewHolder holder = new ViewHolder();
        holder.titleView = (TextView) v.findViewById(R.id.list_title);
        holder.descriptionView = (TextView) v.findViewById(R.id.list_description);
        holder.thumbView = (ImageView) v.findViewById(R.id.list_thumb);
        holder.isNewView = (TextView) v.findViewById(R.id.list_read_unread);
        holder.rowLayout = (LinearLayout) v.findViewById(R.id.list_row);

        v.setTag(holder);
        return v;
    }
} 
```

我真的很感激在这件事上的任何帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-29T10:51:02.540

对于 ListViews、GridViews 和其他在其适配器中使用视图重用的列表，**您应该调用`.resetViewBeforeLoading()`DisplayImageOptions**来防止这种影响。

文档还说：

> 仅使用一次配置初始化 ImageLoader

你只做一次吗？适配器的构造函数不适合它。

**UPD：**对不起，我的回答没有用。`.resetViewBeforeLoading()`没有帮助，因为您使用`.showStubImage(...)`. 所以你应该有正确的 UIL 工作，但你没有。这很奇怪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-04T07:43:39.023

我经常遇到这个问题，即使我只启动了一次 ImageLoader，我并没有只在我需要它时（在适配器中）才这样做，在我更改 Application 类中的 init() 部分之后它工作得很好. 我什至不必使用restartViewOnLoading() 或setStubImage()。如有必要，这是代码。

```
import android.content.Context;

import com.nostra13.universalimageloader.core.DisplayImageOptions;
import com.nostra13.universalimageloader.core.ImageLoader;
import com.nostra13.universalimageloader.core.ImageLoaderConfiguration;

public class Application extends android.app.Application {

    private static Context mContext;

    @Override
    public void onCreate() {
        super.onCreate();
        mContext = getApplicationContext();

        DisplayImageOptions imgOptions = new DisplayImageOptions.Builder()
            .cacheInMemory(true)
            .showImageOnLoading(R.drawable.default_picture)
            .build();
        ImageLoaderConfiguration imgConfig = new ImageLoaderConfiguration.Builder(mContext)
            .defaultDisplayImageOptions(imgOptions)
            .build();
        ImageLoader.getInstance().init(imgConfig);
    }

    public static Context getAppContext(){
        return mContext;
    }
} 
```

[编辑：您可以在此处](https://github.com/nostra13/Android-Universal-Image-Loader/issues/376)查看此对话，以更深入地了解该问题。基本上有3个解决方案

1) 在 dips 中为 ImageViews 设置 android:layout_width 和 android:layout_height 参数（'wrap_content' 和 'match_parent' 是不可接受的）

2）在ImageView被绘制后调用ImageLoader（在imageView.post(...)中：

```
imageView.post(new Runnable() {
        @Override
        public void run() {
            imageLoader.displayImage(imageUri, imageView);
        }
     }); 
```

3）传递不考虑实际视图大小的ImageViewAware（而不是ImageView）：

代替：

```
imageLoader.displayImage(imageUri, imageView); 
```

执行以下操作：

```
ImageAware imageAware = new ImageViewAware(imageView, false)
imageLoader.displayImage(imageUri, imageAware); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T08:52:11.393

看看如何设置[持有人](http://www.vogella.com/articles/AndroidListView/article.html#adapterperformance_hoder)，因为我认为你在你的内部写了错误的逻辑，`Adapter`这就是它重复视图的原因。

还有[带有 Holder 的 Custom Cursor Adapter](https://stackoverflow.com/questions/4567969/viewholder-pattern-correctly-implemented-in-custom-cursoradapter)和[Get View & BindView](https://stackoverflow.com/questions/3535074/getview-vs-bindview-in-a-custom-cursoradapter)讨论。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-05T18:17:27.330

我有同样的问题并修复了它。这不是因为 Universal-Image-Loader 库。这是因为您在错误的逻辑中使用了 holder 来加载图像。

尝试更换

```
 @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        View v = inflater.inflate(R.layout.articlelist_item, null);
        ViewHolder holder = new ViewHolder();
        holder.titleView = (TextView) v.findViewById(R.id.list_title);
        holder.descriptionView = (TextView) v.findViewById(R.id.list_description);
        holder.thumbView = (ImageView) v.findViewById(R.id.list_thumb);
        holder.isNewView = (TextView) v.findViewById(R.id.list_read_unread);
        holder.rowLayout = (LinearLayout) v.findViewById(R.id.list_row);

        v.setTag(holder);
        return v;
    } 
```

和

```
@Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        View v = inflater.inflate(R.layout.articlelist_item, null);
        ViewHolder holder = new ViewHolder();
        holder.titleView = (TextView) v.findViewById(R.id.list_title);
        holder.descriptionView = (TextView) v.findViewById(R.id.list_description);
        ImageView thumbView = (ImageView) v.findViewById(R.id.list_thumb);
        imageLoader.displayImage("Your image URL", thumbView);
        holder.isNewView = (TextView) v.findViewById(R.id.list_read_unread);
        holder.rowLayout = (LinearLayout) v.findViewById(R.id.list_row);

        v.setTag(holder);
        return v;
    } 
```

并记得在你的 bindView 函数中删除 imageloader

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-29T08:57:36.537

在您的代码中添加这一行::

```
holder.thumbView.setTag(Utils.makeImageUrl(url, Utils.THUMBNAIL).get(position));
imageLoader.displayImage(Utils.makeImageUrl(url, Utils.THUMBNAIL), view_holder.image); 
```

# php - 使用 Facebook php sdk 时跟踪用户是否在新的浏览器选项卡中从 facebook 注销

> ID：14080118
> 
> 赞同：1
> 
> 时间：2012-12-29T08:46:54.540
> 
> 标签：php, session, facebook-php-sdk

我正在使用 php sdk 开发 facebook 应用程序。我的应用程序有一个小问题，在用户登录我的应用程序后，如果用户从新的浏览器选项卡注销 facebook，之后我的应用程序上的任何操作都应重定向回登录页面，说明用户已注销. 但就我而言，我的应用程序仍在运行，即使他已注销。所以任何人都可以帮助我解决这个问题。

**注意：**
我没有在我的应用页面中使用任何注销 URL。我可以通过调用直接销毁会话`$facebook->destroySession()`，但我不知道如何有条件地这样做，因为我不知道用户何时注销 facebook（在新的浏览器选项卡中打开）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:47:22.840

如果我从 Facebook 注销，而我的应用程序在 iframe 中运行，在另一个选项卡中，我会从 Facebook 获得一个模式对话框“登录以继续”。（使用铬）

如果同一应用程序在另一个选项卡中的 Facebook 外部（无 iframe）运行，并且我从 Facebook 注销，我的应用程序检测到 Facebook 会话已结束。

那是因为如果有有效的 Facebook 用户，我会检查每个页面加载；-)

我的猜测是，如果用户登录，您不会检查每个页面加载.....

（或者你有一个有趣的浏览器，它不会在标签或其他东西之间共享 cookie）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T05:14:29.357

我有完全一样的问题。我找不到检测用户是否使用 PHP SDK 登录的方法。但是，当我结合 JS SDK 时，它可以检测到会话并正确设置 cookie。然后我使用 PHP SDK 选择 cookie/会话。

如果您使用我的解决方案，请小心。使用组合的 JS 和 PHP SDK，AccessToken 似乎失去了它的持久性。我遇到的问题是出现以下错误： **OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。**

阅读后，我发现这是一个但在 SDK 的 pull 48 上得到了修复： [https ://github.com/facebook/facebook-php-sdk/pull/48](https://github.com/facebook/facebook-php-sdk/pull/48)

这部分有帮助，但现在我收到此错误： **OAuthException：验证访问令牌时出错：会话已在 unix 时间过期**

摘要：组合 SDK 似乎可以解决您的问题，但 API 显然有问题。我正在继续我的研究，并会在我得到解决方案时发布。

期待听到其他人为解决此问题所做的工作

# linux - “sed -i”和“sed ... > 文件”之间的区别

> ID：14080120
> 
> 赞同：0
> 
> 时间：2012-12-29T08:47:09.477
> 
> 标签：linux, sed

我想知道这两行之间的区别：

```
sudo sed 's/GRUB_TIMEOUT=10/GRUB_TIMEOUT=3/' /etc/default/grub >/etc/default/grub 
```

和

```
sudo sed -i 's/GRUB_TIMEOUT=10/GRUB_TIMEOUT=3/' /etc/default/grub 
```

似乎存在差异，因为第一个返回 Permission denied 错误，而另一个则没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T08:52:05.270

正如@sarathi 所说，该`-i`标志会就地修改文件。您收到权限被拒绝错误的原因是因为`/etc/default/grub`可能只能由 root 修改。

你的第一个命令：

```
sudo sed 's/GRUB_TIMEOUT=10/GRUB_TIMEOUT=3/' /etc/default/grub >/etc/default/grub 
```

以超级用户身份运行，在写入其标准输出时`sed`不会做任何有用的事情。`sed`然后它尝试以`/etc/default/grub`当前用户身份覆盖，这是不允许的。

在第二个命令中：

```
sudo sed -i 's/GRUB_TIMEOUT=10/GRUB_TIMEOUT=3/' /etc/default/grub 
```

该文件是由`sed`自己修改的，它以 root 身份运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T08:49:13.840

`-i`sed 的标志表示就地替换。

# c++ - 如何正确编写尾随返回类型？

> ID：14080135
> 
> 赞同：7
> 
> 时间：2012-12-29T08:49:46.843
> 
> 标签：c++, c++11, trailing-return-type

假设我有这个函数模板：

```
template<typename T1, typename T2>
auto DoSomething(const T1& arg); 
```

当然，这个函数需要一个尾随返回类型，考虑到函数的目的，我真的做错了。

这个函数应该做的是使用，对一个对象`arg`进行一些操作，并将该操作的结果用作函数的返回值。显然，的返回类型必须（兼容地）与为和对象完成的操作的返回类型匹配。`arg``T2``DoSomething()``arg``T2`

再次假设我们`DoSomething()`做一些真正的操作，比如乘法。然后我们将编写`DoSomething()`如下代码：

```
template<typename T1, typename T2>
auto DoSomething(const T1& arg) -> /* trailing return-type */ {
    T2 t2Obj;   // Or have it obtained in some other way
    return arg * t2Obj;
} 
```

**然后我应该如何为此形成尾随返回类型？**

* * *

PS：我已经尝试使用`decltype(arg * T2)`,`decltype(T1 * T2)`和`decltype(T1::operator * (T2))`其他一些看起来很奇怪`decltype`的尾随返回类型。他们都没有工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T09:01:12.577

你应该使用`decltype`和`std::declval<>`作为：

```
template<typename T1, typename T2>
auto DoSomething(const T1& arg) -> decltype(arg * std::declval<T2>())
{
    T2 t2Obj;   // Or have it obtained in some other way
    return arg * t2Obj;
} 
```

因为`T2`可能没有默认构造函数，所以`decltype(arg *T2())`可能不起作用。

但后来我也注意到，如果`T2`没有默认构造函数，那么你也**无法**编写`T2 t2Obj`。因此**，如果**您*需要* `T2`具有默认构造函数，那么您可以简单地编写以下代码：

```
-> decltype(arg *T2()) //requirement : T2 must have default constructor 
```

**如果您*****需要*****默认构造函数**，这也应该有效！ ***`T2`***

# android - putExtras 中的空指针

> ID：14080136
> 
> 赞同：0
> 
> 时间：2012-12-29T08:49:51.427
> 
> 标签：android, android-intent, nullpointerexception

我对 putExtras 有一些麻烦。你能检查我的代码吗？

```
 public void onSelectCategory(View v) {
    int category = Integer.parseInt((String) v.getTag());
    Intent intent = new Intent(HomeActivity.this, ListActivity.class);
    intent.putExtra("EXT_CATEGORY", category);
    startActivity(intent);
} 
```

在 ListActivity 中，我正在执行以下操作..

```
public static final String EXT_CATEGORY = "category";
int category = getIntent().getExtras().getInt(EXT_CATEGORY); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T08:52:51.993

从这条线

```
 intent.putExtra("EXT_CATEGORY", category); 
```

在您的另一个活动中，字符串名称应该是相同的意思：--

```
 public static final String EXT_CATEGORY = "EXT_CATEGORY"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:55:08.110

您犯了几个错误，这是您的代码的过度工作版本。

```
 public void onSelectCategory(View v) {
    int category = Integer.parseInt((String) v.getTag());
    Intent intent = new Intent(HomeActivity.this, ListActivity.class);
    intent.putExtra(EXT_CATEGORY, category);
    startActivity(intent);
}

int defaultCat = -1;
public static final String EXT_CATEGORY = "category";
int category = getIntent().getIntExtra(EXT_CATEGORY,defaultCat); // Use default int if there is no extra 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T08:53:36.183

您应该使用它来获取信息，而不是`getExtras()`：

```
int category = getIntent().getIntExtra("EXT_CATEGORY"); 
```

`getExtras()`返回额外`Bundle`的数据。你只需要一个整数。

# android - 致命异常：android中的main

> ID：14080137
> 
> 赞同：0
> 
> 时间：2012-12-29T08:50:01.730
> 
> 标签：android

我已经阅读了许多关于致命异常的先前帖子，但没有帮助我

所以我对android很陌生，我正在构建一个非常简单的应用程序，它允许你单击一个按钮并将你带到另一个页面，你可以在其中单击其他按钮但是一旦我在模拟器上运行它，我就会得到一个“应用程序进程意外停止”并且logcat给了我一个致命的异常代码是

```
package my.first.pro;

import android.app.Activity;
import android.content.Intent;
 import android.os.Bundle;
  import android.view.*;
  import android.view.View.OnClickListener;

  public class MyfirstproActivity extends Activity  {
  /** Called when the activity is first created. */
  @Override
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    View button = this.findViewById(R.layout.main); 
    button.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent i = new Intent ( MyfirstproActivity.this, Second.class );
        }
    });
} 
```

}

XML 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:orientation="vertical" >

  <Button
    android:id="@+id/button"
    android:layout_width="233dp"
    android:layout_height="wrap_content"
    android:text="view health care services " />

   </LinearLayout> 
```

第二个活动

```
 package my.first.pro;

   import android.app.Activity;
   import android.os.Bundle;

    public class Second extends Activity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // TODO Auto-generated method stub
} 
```

}

第二个活动xml文件

```
 <?xml version="1.0" encoding="UTF-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  android:baselineAligned="false"
  android:orientation="vertical" >

  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="vertical" 
   >

   <TextView
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
       android:text="The following the health care services provided :" /> <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

         </TextView>

    <Button

    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" 
    android:text="General"/>
   </LinearLayout>

  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
   android:orientation="vertical" 
    >

    <Button

      android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     android:orientation="vertical" 
     android:text="physciatric"/>
     </LinearLayout>

  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
   android:layout_height="wrap_content"
    android:orientation="vertical" 
       >

    <Button

      android:layout_width="wrap_content"
    android:layout_height="wrap_content"
      android:orientation="vertical" 
      android:text="pediatric"/>
     </LinearLayout>
       <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
       android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" 
         >

       <Button

      android:layout_width="wrap_content"
    android:layout_height="wrap_content"
       android:orientation="vertical" 
      android:text="dental"/>
      </LinearLayout>
       </LinearLayout> 
```

日志猫是

```
 12-29 11:15:10.508: E/AndroidRuntime(438): FATAL EXCEPTION: main
    12-29 11:15:10.508: E/AndroidRuntime(438): java.lang.RuntimeException: Unable to start activityComponentInfo{my.first.pro/my.first.pro.MyfirstproActivity}: java.lang.NullPointerException
    12-29 11:15:10.508: E/AndroidRuntime(438):  at    android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
     12-29 11:15:10.508: E/AndroidRuntime(438):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
     12-29 11:15:10.508: E/AndroidRuntime(438):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at android.os.Handler.dispatchMessage(Handler.java:99)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at android.os.Looper.loop(Looper.java:123)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at android.app.ActivityThread.main(ActivityThread.java:3683)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at java.lang.reflect.Method.invokeNative(Native Method)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at java.lang.reflect.Method.invoke(Method.java:507)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at dalvik.system.NativeStart.main(Native Method)
    12-29 11:15:10.508: E/AndroidRuntime(438): Caused by: java.lang.NullPointerException
    12-29 11:15:10.508: E/AndroidRuntime(438):  at my.first.pro.MyfirstproActivity.onCreate(MyfirstproActivity.java:16)
     12-29 11:15:10.508: E/AndroidRuntime(438):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    12-29 11:15:10.508: E/AndroidRuntime(438):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
    12-29 11:15:10.508: E/AndroidRuntime(438):  ... 11 more
    12-29 11:15:24.829: E/AndroidRuntime(448): FATAL EXCEPTION: main
    12-29 11:15:24.829: E/AndroidRuntime(448): java.lang.RuntimeException: Unable to start activity ComponentInfo{my.first.pro/my.first.pro.MyfirstproActivity}: java.lang.NullPointerException
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
   12-29 11:15:24.829: E/AndroidRuntime(448):   at android.app.ActivityThread.access$1500(ActivityThread.java:117)
   12-29 11:15:24.829: E/AndroidRuntime(448):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.os.Handler.dispatchMessage(Handler.java:99)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.os.Looper.loop(Looper.java:123)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.app.ActivityThread.main(ActivityThread.java:3683)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at java.lang.reflect.Method.invokeNative(Native Method)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at java.lang.reflect.Method.invoke(Method.java:507)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at dalvik.system.NativeStart.main(Native Method)
    12-29 11:15:24.829: E/AndroidRuntime(448): Caused by: java.lang.NullPointerException
    12-29 11:15:24.829: E/AndroidRuntime(448):  at my.first.pro.MyfirstproActivity.onCreate(MyfirstproActivity.java:16)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at andr  oid.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    12-29 11:15:24.829: E/AndroidRuntime(448):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
    12-29 11:15:24.829: E/AndroidRuntime(448):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T08:51:19.143

这里

```
View button = this.findViewById(R.layout.main); 
```

您试图以错误的方式在 Activity 布局中查找视图。在布局 xml 中查找视图的正确方法是：

```
 Button button = (Button)findViewById(R.id.button); 
```

并且始终将所有 UI 控件声明为类级别字段而不是内部方法，因为如果您在类级别声明所有元素，那么您可以在整个 Activity 中访问它。

**编辑：**

始终使用此 Activity 模板来声明或初始化 Ui 元素，以便在整个 Activity 中更好地访问 UI 元素：

```
 public class MyfirstproActivity extends Activity  {
  /** Called when the activity is first created. */

  //******* ALWAYS DECLARE UI ELEMENTS HERE ********** //

Button button ; //<<< for example 

  @Override
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

   //** ALWAYS SET  layout FOR ACTIVITY BEFORE INITIALIZING UI ELEMENTS **
    setContentView(R.layout.main);

   //**** ALWAYS  INITILIZING UI ELEMENTS IN SIDE onCreate of Activity *** //
     button = (Button)findViewById(R.id.button); 

   }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-06T16:30:22.773

您以错误的方式声明按钮，更改此行，

```
View button = this.findViewById(R.layout.main); 
```

像这样，

```
Button button = this.findViewById(R.id.button); 
```

您还必须为第二个 Acitvity 添加此行，

```
setContentView(int layoutid); 
```

像这样，

```
setContentView(R.layout.main) //First page layout 
```

此方法帮助我们显示活动的布局，此方法确定向用户显示哪个布局或视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T08:57:41.053

您必须在此之后添加以下语句

```
 Intent i = new Intent ( MyfirstproActivity.this, Second.class );

 startActivity(i);  //this will start the new activity. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-29T09:04:40.887

换行

```
View button = this.findViewById(R.layout.main); 
```

对此：

```
View button = this.findViewById(R.id.button); 
```

# android - 如何从蓝牙接收字节数组并将字节数组作为图像文件保存到 SD 卡

> ID：14080142
> 
> 赞同：1
> 
> 时间：2012-12-29T08:51:11.850
> 
> 标签：android, bluetooth

我正在开发一个需要实现该`Bluetooth`功能的 Android 应用程序。它需要从外部硬件设备接收图像，然后将该字节数组作为图像文件保存到 SD 卡。

这是我的代码：

```
public void run(){
                Log.i(TAG, "BEGIN mConnectedThread");
                byte[] buffer = new byte[4096];

            //CREATE IMAGE FILE
            File test=new File(Environment.getExternalStorageDirectory(), "test.jpg");

            if (test.exists()) {
                test.delete();
            }

            try {
                fos = new FileOutputStream(test.getPath());
            } catch (FileNotFoundException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }

            // Keep listening to the InputStream while connected
            while (true) {
                try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);

                    /*mEmulatorView.write(buffer, bytes);
                    // Send the obtained bytes to the UI Activity
                    mHandler.obtainMessage(BlueTerm.MESSAGE_READ, bytes, -1, buffer).sendToTarget();*/
                    //receivedData = new String(buffer);

                    receivedData=new String(buffer)

                        //WRITE BYTES TO FILE
                        try {

                            fos.write(buffer);

                        }
                        catch (java.io.IOException e) {
                            Log.e("PictureDemo", "Exception in photoCallback", e);
                        }

                        /*
                        Bitmap bitmap = null;
                        try {
                            bitmap = BitmapFactory.decodeByteArray(buffer , 0, buffer.length);
                        } catch (OutOfMemoryError e) {
                            e.printStackTrace();
                        }catch (Exception e) {
                            e.printStackTrace();
                        }
                        if(bitmap != null)

                                testModeOnScreen.saveBitmapToSdcardAndEmail(bytes, bitmap);
                         */}

                } catch (IOException e) {
                    Log.e(TAG, "disconnected", e);
                    connectionLost();
                    break;
                }
            }
            try {
                fos.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            } 
```

我的问题是我没有得到任何异常或崩溃，但我得到了一个损坏的图像文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:11:19.993

这里似乎有多个问题。对于初学者来说，缓冲区尾部的垃圾，“设 k 为实际读取的字节数；这些字节将存储在元素 b[0] 到 b[k-1] 中，留下元素 b[k] 到 b[b]。长度-1] 不受影响”：

[http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read()](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read%28%29)

此外，您可能碰巧需要使用 Android 的位图功能。

看看他们如何在这里交换位图：

[http://kamrana.wordpress.com/2012/05/12/sending-images-over-bluetooth-in-android/](http://kamrana.wordpress.com/2012/05/12/sending-images-over-bluetooth-in-android/)

以及它们如何保存到文件中：

[将位图保存到文件功能](https://stackoverflow.com/questions/11274715/save-bitmap-to-file-function)

[http://developer.android.com/reference/android/graphics/Bitmap.html#compress(android.graphics.Bitmap.CompressFormat, int, java.io.OutputStream)](http://developer.android.com/reference/android/graphics/Bitmap.html#compress%28android.graphics.Bitmap.CompressFormat,%20int,%20java.io.OutputStream%29)

您会发现将这些构建块组合在一起比重新发明它们更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-22T12:04:15.010

检查此解决方案；）

```
String TAG="IMG";
        File path = Environment.getExternalStoragePublicDirectory(("/mnt/exSdCard/RecievedIMAGE"));
        File file = new File(path, "test.jpg");
        BufferedInputStream bufferedInputStream = null;

        try {
            // Make sure that this path existe if it is not so create it
            path.mkdirs();

            bufferedInputStream = new BufferedInputStream(inputStream);
            OutputStream os = new FileOutputStream(file);

            final byte[] buffer = new byte[2048];
            int available = 0;

            while ((available = bufferedInputStream.read(buffer)) >= 0) {
                os.write(buffer, 0, available);
            }
            bufferedInputStream.read(buffer);

            bufferedInputStream.close();
            os.close();
            Log.d(TAG, "success" + buffer);

        } catch (IOException e) {
            // Unable to create file, likely because external storage is
            // not currently mounted.
            Log.w("ExternalStorage", "Error writing " + file, e);
        } 
```

# html - HTML - 在选择标签选项中添加 html 内容

> ID：14080145
> 
> 赞同：0
> 
> 时间：2012-12-29T08:52:05.327
> 
> 标签：html

> **可能重复：**
> [将带有选项的图像放在下拉列表中](https://stackoverflow.com/questions/4941004/putting-images-with-options-in-a-dropdown-list)

是否可以有一个`<select>`带有 html 选项的下拉列表，例如一个国家选择器，每个选项中都有标志图像。（请注意：没有 jquery UI）

# android - 除了RAW文件夹，我可以创建用于存储文件的文件夹吗？

> ID：14080146
> 
> 赞同：0
> 
> 时间：2012-12-29T08:52:09.250
> 
> 标签：android

除了原始文件夹之外，我可以创建文件夹来存储不同类型的文件吗？

例如，我的应用程序需要计算放入文件夹中的所有图像。

所以，我需要一个特定的文件夹来存放图像，而其他文件夹用于存放声音、.txt 等！

但是当我尝试创建一个新文件夹时，我无法访问它:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T08:58:47.790

这只是一种预感，但您可能会更幸运地使用资产文件夹。您当然可以使用它来存储具有子文件夹的嵌入式网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:04:01.427

通常，您无法创建自定义资源文件夹。但是您可以使用 assets 目录并将您的资源放在那里。您可以根据需要在资产目录中创建尽可能多的子文​​件夹。但是android不会帮助您管理资产目录中的文件。读[这个](https://stackoverflow.com/questions/5583608/android-difference-between-res-and-assets-directory)。

# ios - AVAudioPlayer audioPlayerDidFinishPlaying 在文件第二次播放时调用

> ID：14080149
> 
> 赞同：1
> 
> 时间：2012-12-29T08:52:13.343
> 
> 标签：ios, audio, avaudioplayer

我正在使用 AVAudioPlayer 类播放音频，但问题是当我播放音频时，当文件完成播放并且文件再次启动时，即使循环数设置为 1，我也没有收到 audioPlayerDidFinishPlaying 中的回调

这是代码。

***。H***

```
@interface AudioController : NSObject <AVAudioPlayerDelegate>

-(void) playBigGameTheme{
-(void) playMusic:(NSString*) fileName isLooping: (BOOL) isLooping;
@end 
```

***.m***

```
@implementation AudioController{

    AVAudioPlayer *audioPlayer;
}

-(void) playMusic:(NSString*) fileName isLooping: (BOOL) isLooping{

    int loop = 1;
    if(isLooping){
        loop = -1;
    }

    [audioPlayer stop];
    NSURL* soundUrl = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:fileName  ofType:@"mp3"]];
    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:soundUrl error:nil];
    audioPlayer.numberOfLoops = loop;
    [audioPlayer setDelegate:self];
    NSLog(@"===Number of loops : %d", audioPlayer.numberOfLoops);    
    [audioPlayer play];
}

- (void) audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    NSLog(@"HERE");
}

-(void) playBigGameTheme{
    [self playMusic:BGAME_MAIN_MUSIC_FILE_NAME isLooping:NO];
}
@end 
```

当我调用 playBigGameTheme 时，音频开始正确播放。但它会在声音完成时重新启动，并且当音频第二次完成时，只会调用 audioPlayerDidFinishPlaying 方法。

我被卡住了，不知道出了什么问题..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T08:57:20.577

> 即使循环数设置为 1

这正是为什么。此属性的名称和行为有点违反直觉，但如果您阅读过文档，就会清楚它设置的是**重复次数，**而不是**播放次数。**从[文档](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)中引用：

> 默认值 0 表示播放声音一次。

所以将它设置为 0 （或者不设置它，零是默认值），它只会播放一次音频文件：

```
audioPlayer.numberOfLoops = 0; 
```

# c++ - rdstate 和 rdbuf 中的 rd 代表什么？

> ID：14080153
> 
> 赞同：4
> 
> 时间：2012-12-29T08:53:16.020
> 
> 标签：c++, std

C++ 标准 I/O 库中有两个名称：`rdstate`和`rdbuf`. 我知道“state”和“buf”，但什么是“rd”？

（PS：我相信我知道如何使用`rdstate`and `rdbuf`，不要教我）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:55:40.323

我认为它们代表“阅读”，类似于大多数人使用“getXXX”的方式。

# javascript - 如何在 Rails 的 erb 代码中使用 JavaScript 变量？

> ID：14080154
> 
> 赞同：1
> 
> 时间：2012-12-29T08:53:28.590
> 
> 标签：javascript, ruby-on-rails

我有一个 JavaScript 变量：

```
var selectValUser = $('.select_user :selected').val(); 
```

我需要在同一页面的erb代码中使用这个变量，即

```
<%= get_free_hours_for_user(selectValUser) %> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T09:11:20.243

你不能这样做，因为 javascript 在客户端运行，而 ERB 文件中的代码在服务器端运行，你可以使用 ajax 请求发送值，另外这里是一个可怕的[rails cast](http://railscasts.com/episodes/324-passing-data-to-javascript?autoplay=true)

这是从 javascript 向控制器发送消息的示例；当用户单击应用时，我们在控制器中有一个操作“set_id”，它获得电源，进行验证等，在视图中的“id_message”div 中显示消息。

```
 $('#apply').live('click', function(event, data, status, xhr) {
    event.preventDefault();
    return $.ajax({
      url: '/users/registrations/set_id',
      type: 'GET',
      data: {
        code: $('#user_id').val()
      },
      success: function(data, event, status, xhr) {
        $('#id_message').html(response);
        return $("#id_message").show();
      },
      error: function(event, data, status, xhr) {
        $('#id_message').html(response);
        return $("#id_message").show();
      }
    });
  }); 
```

希望它能回答你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:05:25.880

没有办法直接做到这一点。原因是，html 在您的服务器端运行，而 javascript 在您的本地浏览器中运行。

可以在此处找到其他讨论。

[如何在 js 视图中将 javascript 变量传递给 erb 代码？](https://stackoverflow.com/questions/4959770/how-to-pass-a-javascript-variable-into-a-erb-code-in-a-js-view)

关于不同的尝试方式，你可以从这个开始。

[http://jing.io/t/pass-javascript-variables-to-rails-controller.html](http://jing.io/t/pass-javascript-variables-to-rails-controller.html)

和

[http://www.ruby-forum.com/topic/3818171](http://www.ruby-forum.com/topic/3818171)

# c# - 使用 linq 下拉两列绑定

> ID：14080158
> 
> 赞同：1
> 
> 时间：2012-12-29T08:53:42.770
> 
> 标签：c#, sql, linq

我使用这样的 SQL 将两列绑定到下拉列表中

```
string query = "Select Id,Name+':'+Distribution_name+' 'as Name1 from BR_supervisor where( (id not in (select SupId from tbluser where active='true')) and active='true' ) ";

    DropDownList3.DataTextField = "Name1";
    DropDownList3.DataValueField = "Id";
    DropDownList3.DataBind(); 
```

现在我想将我的查询转换为 linq 表达式并绑定下拉列表。这个怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:30:40.470

```
var query = from s in db.BR_supervisor
            join u in db.tbluser.Where(x => x.active)
                 on s.id equals u.SupId into g
            where s.active && !g.Any()
            select new { 
                 s.Id, 
                 Name1 = s.Name + ":" + s.Distribution_name
            };

DropDownList3.DataTextField = "Name1";
DropDownList3.DataValueField = "Id";
DropDownList3.DataSource = query;
DropDownList3.DataBind(); 
```

这会生成如下 SQL：

```
SELECT [t0].[Id], ([t0].[Name] + @p0) + [t0].[Distribution_name] AS [Name1]
FROM [BR_supervisor] AS [t0]
WHERE ([t0].[active] = 1) AND (NOT (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [tbluser] AS [t1]
    WHERE ([t0].[id] = [t1].[SupId]) AND ([t1].[active] = 1)
    ))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:19:30.850

```
var query2 = (from a in this._projectDataContx.BR_Supervisors
                      where ((!(from x in this._projectDataContx.tblUsers
                              where (x.Active == true)
                              select x.SupId).Contains(a.Id))&&(a.Active==true))
                      select new { Name1 = a.Name + ":" + a.Distribution_Name, a.Id });
        DropDownList3.DataSource = query2;
        DropDownList3.DataTextField = "Name1";
        DropDownList3.DataValueField = "Id";
        DropDownList3.DataBind(); 
```

# android - 将数据作为附件发送到电子邮件而不将其保存在 sd 卡上

> ID：14080160
> 
> 赞同：0
> 
> 时间：2012-12-29T08:54:04.180
> 
> 标签：android, file, email, vcf-vcard

我正在开发一个应用程序，我通过我的应用程序将`.vcf`文件作为附件发送到电子邮件，

我使用以下代码来实现这一点，

```
try {
path = Environment.getExternalStorageDirectory().toString()+ File.separator +vfile;
FileOutputStream mFileOutputStream = new FileOutputStream(path, true);
     mFileOutputStream.write(vCardString.toString().getBytes());
File filevcf = new File(path);
Log.d("file", "file" + filevcf);
} catch (Exception e4) {
Log.d("File", "File Error-->>" + e4);} 
```

我正在使用以下代码`.vcf`使用默认电子邮件应用程序将此文件发送到电子邮件。

```
Intent sharingIntent = new Intent(Intent.ACTION_SEND);
sharingIntent.setType("vnd.android.cursor.dir/email");
String to[] = "asd@gmail.com";
sharingIntent.putExtra(Intent.EXTRA_EMAIL, to);
sharingIntent.putExtra(Intent.EXTRA_STREAM,  Uri.parse(path));
sharingIntent.putExtra(Intent.EXTRA_SUBJECT, "subject");
startActivity(Intent.createChooser(sharingIntent, "Send email")); 
```

在这种情况下，我必须将联系人作为`.vcf`文件存储在 sd 卡上，然后才能将其发送到电子邮件。如果设备中没有 sd 卡，则会抛出异常。

`.vcf`即使设备中没有 sd 卡，我也希望应用程序能够发送文件。有什么方法可以做到这一点，或者是否有任何方法可以将此`.vcf`文件存储在其他地方然后发送。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T09:00:06.743

您可以使用内部存储来存储您的 .vcf 文件，并且可以在服务器响应正常后删除。

# java - 如何在java中替换包含点的字符串？

> ID：14080164
> 
> 赞同：10
> 
> 时间：2012-12-29T08:54:52.743
> 
> 标签：java, string

我需要替换一个包含空格和句点的字符串。我尝试过使用以下代码：

```
String customerName = "Mr. Raj Kumar";

customerName = customerName.replaceAll(" ", "");
System.out.println("customerName"+customerName);

customerName = customerName.replaceAll(".", "");
System.out.println("customerName"+customerName); 
```

但这会导致：

> 客户姓名 Mr.RajKumar

和

> 顾客姓名

我从第一个 SOP 中获得了正确的客户名称，但从第二个 SOP 中我没有得到任何价值。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-29T08:59:34.437

转义点，否则它将匹配任何字符。这种转义是必要的，因为[replaceAll()](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)将第一个参数视为正则表达式。

```
customerName = customerName.replaceAll("\\.", ""); 
```

你可以用一个语句完成整个事情：

```
customerName = customerName.replaceAll("[\\s.]", ""); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-29T10:12:36.533

在您的代码中使用它只是为了删除句点

```
customerName = customerName.replaceAll("[.]",""); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-22T16:42:52.447

您可以简单地使用**str.replace(".", "")**它将替换所有出现的点，请记住，replace 和 replaceAll 之间只有一个区别，即稍后使用正则表达式作为输入字符串，而第一个使用简单字符序列。

# php - 引用数组的php大小

> ID：14080171
> 
> 赞同：1
> 
> 时间：2012-12-29T08:55:46.810
> 
> 标签：php, multidimensional-array, size

我有一个多维数组，它多次引用自己。像：

```
$foo = array(
  0 => array(
    & $foo[1],
    & $foo[2],
    'bar',
  ),
  1 => array(
    & $foo[0],
    & $foo[2],
    'bar',
  ),
  2 => array(
    & $foo[0],
    & $foo[1],
    'bar',
  ),
) 
```

有没有办法获得这个数组的大小（以字节为单位或元素的数量）？

亲切的问候，

暴风雨鲁迪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:03:39.720

您可以序列化数组，然后使用以下方法确定字节：[mb_strlen()](http://php.net/manual/en/function.mb-strlen.php)

```
$serialized = serialize($foo);
echo mb_strlen($serialized,'8bit'); 
```

# ruby-on-rails - 即时更改 ActiveRecord 关系

> ID：14080173
> 
> 赞同：0
> 
> 时间：2012-12-29T08:56:17.160
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

假设，我有一个模型

```
class Model < ActiveRecord::Base
  has_many :other_models
end 
```

当加载一些其他代码时，例如一些插件或扩展，我想修改这个关系。我通过重新打开课程来尝试这个：

```
class Model
  has_many :other_models, on_add: :method_on_add
end 
```

但这不起作用。它仅使用第一个关系的选项。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T09:04:17.417

你可以做元编程；当你的一些代码被加载时；你可以做如下。

```
Model.class_eval do
  has_many :other_models
  # whatever you want to code
end 
```

[这](http://www.jimmycuadra.com/posts/metaprogramming-ruby-class-eval-and-instance-eval)是一个关于元编程的好教程

# java - 为什么不可变类需要 final 关键字？

> ID：14080174
> 
> 赞同：21
> 
> 时间：2012-12-29T08:56:43.597
> 
> 标签：java, immutability, final

您能否澄清一下， 当我们将其设为不可变关键字时，为什么在课前需要**final关键字。**我的意思是，如果我们将它的所有属性声明为 private 和 final，那么它也是一个不可变类，不是吗？

对不起，如果这个问题看起来很简单，但我真的很困惑。帮帮我。

编辑：我知道一个声明为 final 的类不能被子类化。但是如果每个属性都是私有的和 final 的，那有什么区别呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-29T09:05:43.753

正如 stacker 所说，`final`确保该类没有被子类化。这很重要，因此任何*依赖*其不变性的代码都可以安全地执行此操作。

例如，不可变类型（其中每个字段也是不可变类型）可以在线程之间自由使用，而不必担心数据竞争等。现在考虑：

```
public class Person {
    private final String name;

    public Person(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
} 
```

*看起来*您可以`Person`毫无问题地跨线程自由共享实例。但是当你共享的对象*实际上是*一个可变子类时呢？

```
public class Employee extends Person {
    private String company;

    public Employee(String name, String company) {
        super(name);
        this.company = company;
    }

    public void setCompany(String company) {
        this.company = company;
    }

    public String getCompany() {
        return company; 
    }
} 
```

现在实例在线程之间共享`Employee` *是*不安全的，因为它们不是不可变的。但是进行共享的代码*可能*只知道它们是`Person`……导致它们产生虚假的安全感的实例。

缓存也是如此——缓存和重用不可变类型应该是安全的，对吧？好吧，缓存真正属于不可变类型的实例*是*安全的——但如果你正在处理一个本身不允许突变但允许子类的类型*，*它突然就不再安全了。

想想`java.lang.Object`。它没有任何可变字段，但将每个`Object`引用视为对不可变类型的引用显然是个坏主意。基本上，这取决于您是否将不变性视为类型或对象的属性。一个真正不可变的类型声明“任何时候你看到这个类型的引用，你都可以把它当作不可变的”——而允许任意子类化的类型不能做出这样的声明。

顺便说一句，有一个折衷方案：如果您可以将子类化限制在“受信任”的地方，您可以确保一切都是不可变的，但仍然允许子类化。Java 中的访问使这变得棘手，但在 C# 中，例如，您可以拥有一个公共类，它只允许在同一程序集中进行子类化 - 提供一个在不变性方面很好且强大的公共 API，同时仍然允许多态性的好处.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T08:59:21.267

声明为 final 的类不能被子类化。另请参阅[http://docs.oracle.com/javase/tutorial/java/IandI/final.html](http://docs.oracle.com/javase/tutorial/java/IandI/final.html)

[The Java Language Specification](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)中描述了 final 关键字所有用法的不同语义

*   4.12.4 最终变量第 80 页
*   8.1.1.2 最终类第 184 页
*   8.3.1.2 最终字段第 209 页
*   8.4.3.3 最终方法第 223 页

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T09:07:14.957

你*不需要*final 来创建一个不可变的类。即你可以创建一个不可变的类而不是最终的。

但是，如果您*不*使其成为最终的，那么某人可以扩展一个类并创建一个可变的子类（通过添加新的可变字段或以一种使您能够改变受保护的字段的方式覆盖方法原始的不可变类）。这是一个潜在的问题 - 它违反了[Liskov Substitution Principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，从某种意义上说，您会期望所有子类型都保留不变性的属性。

因此，最好将不可变类设为 final 以避免这种风险。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T09:09:11.567

关键字名称所暗示的“最终”意味着最终关键字所附加的属性不能更改（就值而言），换句话说，它的行为就像一个常量。

根据您的问题，如果该类的所有成员都设为私有和最终但该类不是最终的，那么可以继承同一个类但超类成员是不可变的，因为它们附加了 final 关键字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T09:08:08.647

不可变对象是一种状态保证在其整个生命周期内保持不变的对象。虽然没有 final 实现不变性是完全可能的，但它的使用使人类（软件开发人员）和机器（编译器）明确了这一目的。

不可变对象具有一些非常理想的特性：

```
they are simple to understand and easy to use
they are inherently thread-safe: they require no synchronization
they make great building blocks for other objects 
```

显然 final 将帮助我们定义不可变对象。首先将我们的对象标记为不可变，这使得其他程序员易于使用和理解。其次是保证对象的状态永远不会改变，这启用了线程安全属性：当一个线程可以更改数据而另一个线程正在读取相同的数据时，线程并发问题是相关的。因为不可变对象从不更改其数据，所以不需要同步访问它。

通过满足以下所有条件来创建不可变类：

```
Declare all fields private final.
Set all fields in the constructor.
Don't provide any methods that modify the state of the object; provide only getter methods (no setters).
Declare the class final, so that no methods may be overridden.
Ensure exclusive access to any mutable components, e.g. by returning copies. 
```

声明为 final 的类不能被子类化。其他类不能扩展最终类。它为安全性和线程安全提供了一些好处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-29T09:37:30.987

如果所有公共和受保护的方法都是最终的，并且它们都不允许修改私有字段，并且所有公共和受保护的字段都是最终的和不可变的，那么我想它可以说类是半不可变的，或者某种常量。

但是当你创建一个子类并且需要覆盖 equals 和 hashcode 时，事情就会崩溃。不能因为你把它们做成final...所以整个事情都坏了，所以把整个类做成final，以防止程序员不小心成为傻瓜。

作为执行这种混蛋版本不变性的替代方法，您有多种选择。

如果要将额外数据附加到不可变实例，请使用`Map`. 就像如果您想在姓名中添加年龄一样，您不会这样做`class NameAge extends String`... :-)

如果要添加方法，请创建一个静态实用函数类。这有点笨拙，但它是当前的 Java 方式，例如 Apache commons 充满了这样的类。

如果要添加额外的方法和数据，请创建一个包装类，将方法委托给不可变类的方法。无论如何，任何需要使用额外方法的人都需要了解它们，并且在转换为派生的非不可变类或`new MyWrapper(myImmutableObj)`为许多用例执行类似操作时没有太大的实际区别。

当您确实必须引用原始不可变对象（例如将其存储在现有类中您无法更改），但需要在某处额外数据时，您需要使用该`Map`方法来保留额外数据或类似的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-02T17:25:44.507

如果不可变类`Foo`是密封的（“final”），那么任何接收到 a 引用的人`Foo`都可以确信，如果`Foo`正确实现，则引用的实例实际上是不可变的。如果不可变类不是密封的，那么接收到 a 引用的人`Foo`可以确信，如果被引用对象的实际类（可能是*某个任意未知人员实现的*`Foo`某个派生类型）被正确实现，则该实例将是不可变的。不密封意味着任何依赖于不可变的人都必须相信每个编写派生类的人都会正确地实现它。如果一个人想确定每一个对*`Foo``Foo``Foo``Foo`实际上将针对不可变实例，而不必依赖派生类的作者来遵守合同，使`Foo`final 有助于这种保证。*

 *另一方面，一个类可能派生于`Foo`但违反其不变性的可能性与派生自*任何其他类的类*可能违反其父类的契约的可能性并没有太大区别。任何接受可以被外部代码子类化的*任何*类型的引用的代码都可能被赋予一个违反其父合同的子类的实例。

决定一个不可变类是否应该被密封时的基本问题与任何其他类相同：保持类型不密封的好处是否超过这样做可能带来的任何危险。在某些情况下，拥有一个可扩展的不可变类，甚至是一个抽象类或接口，其具体实现在合同上都有义务是不可变的，这可能是有意义的；例如，一个绘图包可能有一个`ImmutableShape`具有一些具体字段、属性和方法的类来定义 2D 转换，但它是一个抽象`Draw`方法，允许定义派生类型`ImmutablePolygon`, `ImmutableTextObject`,`ImmutableBezierCurve`等。如果有人实现了一个`ImmutableGradientFilledEllipse`类但没有该类型制作自己的可变副本`GradientColorSelector`，渐变填充多边形的颜色可能会意外改变，但这将是`ImmutableGradientFilledEllipse`类的错误，而不是消耗代码。尽管一个被破坏的实现有可能无法维护“不变性”契约，一个可扩展的`ImmutableShape`类将比一个密封的类更通用。*

# ruby-on-rails - 在多个模型中充当可标记计数

> ID：14080175
> 
> 赞同：1
> 
> 时间：2012-12-29T08:56:46.080
> 
> 标签：ruby-on-rails, acts-as-taggable-on

我正在尝试查找多个模型中的标签总数。

在一个模型中，它工作得很好：

```
Post.tag_counts_on(:hashtags).order('count desc') 
```

但是，我有另一个模型，也称为组织，它也采用主题标签。这让我有两个独立的计数：

```
Post.tag_counts_on(:hashtags).order('count desc')
Organization.tag_counts_on(:hashtags).order('count desc') 
```

但是，我希望能够获得两者的总数。当我尝试添加它们时，它们不会合并，而是只是将表格堆叠在一起：

```
Post.tag_counts_on(:hashtags).order('count desc') +
Organization.tag_counts_on(:hashtags).order('count desc') 
```

所有关联模型都应该有一种方法，允许等效于以下内容：

```
Hashtag.tag_counts.order('count desc') 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T09:19:20.070

我认为您可以使用自定义选择

```
SELECT tags.name, count(*) as tag_count 
FROM tags JOIN taggings on taggings.tag_id = tags.id 
where taggings.taggable_type = 'Post' or taggings.taggable_type='Organization' 
GROUP BY tags.name 
ORDER BY tag_count DESC 
```

如果需要，使用 arel 构建此查询

# java - 使用 Java 比较目录：如何识别已删除的文件？

> ID：14080177
> 
> 赞同：4
> 
> 时间：2012-12-29T08:56:49.870
> 
> 标签：java, algorithm, filesystems

我使用 Java 7 比较了 2 个目录。如果 somefile.txt 存在于目录 A 中，但不存在于目录 B 中，我想区分两种情况：

1.  somefile.txt 之前在两个目录中，然后从目录 B 中删除。
2.  somefile.txt 刚刚添加到目录 A（从未在目录 B 中）

我不能使用任何监控，管理日志\历史。我也想找到独立于操作系统的解决方案。

我可以通过以某种方式比较两个文件夹的 lastModified 和 lastModified 来猜测 somefile.txt 是新的还是删除的？我觉得有一些简单的算法解决方案，但我找不到它......

帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T09:41:20.940

您不能说该文件是 B 中的新文件还是刚从 A 中删除的文件。除非您有该文件夹及其内容的一些日志或历史记录，否则您可以将历史记录与当前状态进行比较。

在您的情况下，您只有目录的当前状态，无法猜测之前发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:03:52.480

为此，您需要确定哪个目录（A 或 B）是较新的副本，哪个是较旧的副本。也许您可以从 A 中的所有文件中获取最新的文件修改时间，将其与 B 的相同计算进行比较，然后判断哪棵树较新？然后区分 1 和 2 很容易 - 如果文件在较新的目录中但不在较旧的目录中，则创建它，否则删除。

根据您的问题，您可能希望使用文件创建时间而不是修改时间

# matlab - 绘制不同颜色的图像

> ID：14080184
> 
> 赞同：0
> 
> 时间：2012-12-29T08:58:23.173
> 
> 标签：matlab, colors

我有一个灰度图像，我在其中标记了 1 到 16 的像素。

我想以不同的颜色显示不同强度的像素。什么是最简单的方法可以使这些数字 1-16 可以是任何东西（例如 5,10,20 ）。

我看过颜色图，但无法以这种方式使用它。

# zope - 初学者使用 Zope 2 开发的资源

> ID：14080187
> 
> 赞同：0
> 
> 时间：2012-12-29T08:58:32.260
> 
> 标签：zope

我打算使用 Zope2 编写一个应用程序；它不会是一个类似于 CMS 的应用程序，但可以说它是一个初级的“会计和财务”应用程序。根据我目前所能理解的（主要是通过阅读[Zope 2 Book](http://docs.zope.org/zope2/zope2book/)），这不是一个“实例空间”应用程序，应该以“Python 包”的形式编写。

我已经在网上搜索了好几个小时，以找到有关如何在没有运气的情况下启动这样一个项目的教程或指南。基本上，我需要的是：

1.  如何创建项目的初始结构？我正在寻找一些与 Zope2 的 grokproject 等效的[工具](http://pypi.python.org/pypi/grokproject)。

2.  一个非常简单的示例应用程序，因此我可以理解事物是如何组合在一起的。[我对此一无所知，并且在Zope 2 Book](http://docs.zope.org/zope2/zope2book/)中找不到任何关于该主题的参考。

我已经检查了[Zope 2 Wiki](http://wiki.zope.org/zope2/Zope2Wiki)，它看起来几乎不像 wiki BTW :-)，但找不到任何对我的案例有用的东西。

因此，如果您能在这方面与我分享任何有用的信息，我将不胜感激。

TIA,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T12:29:23.533

以下，虽然颠簸，让我开始：

*   [Zope 2 开发者指南](http://docs.zope.org/zope2/zdgbook/)
*   [Zope 2 书](http://docs.zope.org/zope2/zope2book/)
*   [ZopeSkel](http://pypi.python.org/pypi/ZopeSkel)用于项目创建和做初始样板
*   Zope-ers 对 StackOverflow 的无价帮助 :-)
*   不确定我是否应该推荐它，但阅读其他产品的代码（特别是 SilvaForum 和 OFS.Folder）确实帮助我理清了思路。

# matlab - 在MATLAB中查找多个数组的集合交集

> ID：14080190
> 
> 赞同：2
> 
> 时间：2012-12-29T08:59:00.793
> 
> 标签：matlab, rows, intersection

我试图解决这个问题，但我无法实现。你能帮我什么吗？

**问题**

```
Mat1 | Mat2 | Mat3

 1 2 | 1 3  | 2 6

 1 3 | 2 6  | 2 5

 2 4 | 3 1  | 3 1

 3 1 | 3 5  | 5 2

 4 5 | 
```

当有 3 个矩阵时（例如上面），我想为`[column1 column2 matrixnumber]`表单中的交集行获取此结果。

上述示例的结果将是

```
1 3 1

1 3 2

2 6 2

2 6 3

3 1 1

3 1 2

3 1 3 
```

如果结果是形式就可以了`[column1 column2 firstmatrix secondmatrix, ...]`

```
1 3 1 2

2 6 2 3

3 1 1 2 3 
```

对于这个问题，我想最多使用一个 for 循环。

你对此有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T11:59:01.837

这是使用 MATLAB 的替代解决方案（似乎比 Gunther 的运行速度更快）[`intersect`](http://www.mathworks.com/help/matlab/ref/intersect.html)：

```
Mat = {[1 2; 1 3; 2 4; 3 1; 4 5],
       [1 3; 2 6; 3 1; 3 5],
       [2 6; 2 5; 3 1; 5 2]};

result = zeros(sum(cellfun(@(x)size(x, 1), Mat)), 3); % # Preallocate memory
k = 1;
for cc = transpose(nchoosek(1:numel(Mat), 2))
    x = intersect(Mat{cc}, 'rows');                   % # Find intersection
    y = ones(size(x, 1), 2) * diag(cc);               % # Generate matrix indices
    result(k:k + numel(y) - 1, :) = [[x; x], y(:)];
    k = k + numel(y);
end

result(all(~result, 2), :) = [];                      % # Discard zero rows
result = unique(result, 'rows');                      % # Discard repeated rows 
```

矩阵`result`现在应该包含唯一的交集行及其相应的矩阵索引，就像您想要的那样：

```
result =   
     1     3     1
     1     3     2
     2     6     2
     2     6     3
     3     1     1
     3     1     2
     3     1     3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T11:30:41.387

如果我理解正确，您有许多对：`Mat1`, `Mat2`, `Mat3`, ... `MatN`。现在您要查找唯一对，然后找出每个唯一对出现在哪个集合中。

如果你有大量的集合，我建议你开始使用一个[单元格数组](http://www.mathworks.nl/help/matlab/cell-arrays.html)来保存它们，这会让事情变得更容易：

```
N = 3; % total number of data sets
Mat = cell(N,1);
Mat{1} = [1 2;
          1 3;
          2 4;
          3 1;
          4 5];
Mat{2} = [1 3;
          2 6;
          3 1;
          3 5];
Mat{3} = [2 6;
          2 5;
          3 1;
          5 2];
% etc. 
```

首先让我们找到唯一的对：

```
uniq_pairs = unique(cat(1,Mat{:}),'rows');
M = size(uniq_pairs ,1); 
```

然后使用[ismember](http://www.mathworks.nl/help/matlab/ref/ismember.html)检查哪些集合包含哪些对：

```
matcontpair = false(M,N); %preallocate
for ii=1:N % unavoidable loop
    matcontpair(:,ii) = ismember(uniq_pairs,Mat{ii},'rows');
end 
```

要将此交集矩阵转换为每对的一组矩阵数，请再次循环遍历它并将最终结果存储在单元数组中（您不能使用数组，因为它们的大小可能不同（仅找到某些对一次，另外两次，另外三次......）

```
pair_occurence= cell(M,1);
d=1:N;
for jj=1:M
    pair_occurence{jj} = d(matcontpair(jj,:));
end 
```

现在您有一个包含唯一对`uniq_pairs`的大小矩阵和一个大小`Mx2`为的出现单元格数组：每个单元格对应于一对并包含存在该对的矩阵列表。`pair_occurence``Mx1`

如果要从列表中删除仅存在于一个矩阵中的对，请使用以下命令：

```
% find them
lonely_pairs = cellfun(@numel,pair_occurence)<2;
% and destroy them
uniq_pairs(lonely_pairs,:) = [];
pair_occurence(lonely_pairs) = []; 
```

# sql - SQL：如何针对参数选择具有相同 ID 的多行

> ID：14080196
> 
> 赞同：-3
> 
> 时间：2012-12-29T08:59:38.583
> 
> 标签：sql

我有一个`Invoice`包含这些列的表：

```
InvoiceID, ProductID, Qty, Sum, Location, etc 
```

主键是`InvoiceID + ProductID`

一个单一的`Invoice`可以有多个行，因此一个发票将如下所示：

```
InvoiceID | ProductID | Qty | Sum   | Location
----------------------------------------------
1000      | 123       | 2   | 20.00 | Loc1
1000      | 321       | 4   | 12.00 | Loc1
1000      | 145       | 1   | 03.50 | Loc1
1000      | 134       | 1   | 10.00 | Loc1
1001      | 123       | 1   | 20.00 | Loc1
1002      | 321       | 1   | 03.50 | Loc1
1002      | 145       | 1   | 10.00 | Loc1
1002      | 134       | 1   | 20.00 | Loc1 
```

所以我想做的是写一条 SQL 语句来排除所有不同的`InvoiceID`

所以结果会是

```
1000,1001,1002 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:07:01.690

```
SELECT 
  DISTINCT InvoiceID 
FROM 
  Invoice 
WHERE ProductID=123 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T09:03:48.260

如果您想排除所有不同的 InvoiceID，请尝试以下操作，

```
select InvoiceID from Invoice 
where ProductID=123
group by InvoiceID having count(InvoiceID) > 1 
```

# mysql - 如何选择除前 3 条记录之外的所有记录？

> ID：14080198
> 
> 赞同：2
> 
> 时间：2012-12-29T08:59:43.140
> 
> 标签：mysql

我有一个专栏

```
id
-----
1
32
3
6
5
22
54
21 
```

问题1：如何从列中选择除前3条记录之外的所有记录？
问题2：如何选择最后3条记录？

-谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:33:02.257

[由于LIMIT](http://dev.mysql.com/doc/refman/5.5/en/select.html)的一些限制，您基本上需要将此类查询放入[存储过程](https://dev.mysql.com/doc/refman/5.5/en/stored-routines.html)中。您不能在纯 sql 中使用子选择或变量。在存储过程中，您可以使用变量。

这行得通，不幸的是我无法在[sqlfiddle](http://sqlfiddle.com)中显示它，因为它们似乎对存储过程的支持有限。

```
drop procedure if exists all_but_3;

delimiter //
create procedure all_but_3()
begin
   declare v_max bigint unsigned default ~0;
   select * from your_table limit 3, v_max;
end//

delimiter ;

drop procedure if exists last_3;
delimiter //
create procedure last_3()
begin
   declare v_max bigint;
   declare v_mid bigint;
   select count(*) from your_table into v_max;
   set v_mid := v_max - 3;
   select * from your_table limit v_mid, v_max;
end//

delimiter ;

call all_but_3();
call last_3(); 
```

## InnoDB 聚集索引详解

在与@fthiella 讨论了其他答案之一后，我决定详细说明它是如何工作的。

使用 InnoDB 作为引擎的表将始终具有聚集索引。总是。这是他们将数据存储在 InnoDB 中的方式，并且在任何情况下都无法创建没有聚集索引的表。

如果有一个或第一个唯一索引且所有列都设置为非空，InnoDB 将选择主键。如果不存在这样的索引，InnoDB 将创建一个带有行 id 的隐藏列。此行 ID 的工作方式类似于自动增量，如果它有助于将其视为具有自动增量的不可见列，我认为这很好。

InnoDB 将进一步根据使用的索引返回行。它将始终使用一些索引（检索数据的唯一方法是使用二级索引、聚集索引或组合），因此在没有显式创建的索引的情况下，隐藏聚集索引会返回行。

这意味着针对没有主键和唯一索引且所有列都设置为非空且没有 ORDER BY 的表的查询将按照插入的顺序返回行。

这就是这个问题的情况，也是我和许多其他答案的基础。

我并不是说这是处理数据的好方法。在使用此解决方案之前，您应该考虑以下几点：

*   如果曾经创建过可用作聚集索引的索引，则该表将被重写以使用该索引，并通过这样做对磁盘上的数据进行排序。如果稍后删除索引，则原始插入顺序将丢失并且无法检索。
*   如果创建了一个索引，即使它不是唯一的，它也可以由优化器选择使用，并且行将按该索引排序。

[所有这些都记录在案，对于 5.5，这是此页面](http://dev.mysql.com/doc/refman/5.5/en/innodb-index-types.html)上的第三个要点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T09:33:43.773

1.  选择除前 3 条记录之外的所有记录：

    从 table1 限制 3 中选择 id，18446744073709551615；

2.  选择最后 3 条记录：

    select a.id from (select @row_num:=@row_num+1 as RowNumber,id from table1, (select @row_num:=0) x order by RowNumber desc) 作为限制 3；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T09:03:02.843

使用[限制](http://dev.mysql.com/doc/refman/5.6/en/select.html)

* * *

对于＃1，您理论上需要知道行数，但您可以只输入一个巨大的数字：

```
SELECT bleh FROM blah LIMIT 3, 18446744073709551615 
```

（18446744073709551615 是可能的最大数量——感谢亚历克斯瓦西向我指出[这一点](https://stackoverflow.com/questions/255517/mysql-offset-infinite-rows/271650#271650)）

* * *

对于#2，您确实需要知道记录数：

```
SELECT bleh FROM blah LIMIT NUM-3, 3 
```

您必须从单独的查询中获取行数（这应该是 NUM 所在的位置）。

* * *

如果有可以排序的条件，则实际上可以在不进行完整计数的情况下执行第二个查询：

```
SELECT bleh FROM blah ORDER BY field DESC LIMIT 3 
```

我假设情况并非如此。

* * *

（如果您不想对表进行计数，另一种选择是只提取所有数据并忽略代码域 [PHP、C 等] 中的前 3 行或最后 3 行。）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-29T09:13:05.190

试试这个：

```
totalCounts = SELECT COUNT(*) FROM tbl;

SELECT * FROM tbl LIMIT 3,totalCounts
# Retrieve rows 4 to number of table rows 
```

# javascript - 计算距离并从谷歌地图中的原点移动标记

> ID：14080203
> 
> 赞同：0
> 
> 时间：2012-12-29T09:00:33.560
> 
> 标签：javascript, asp.net, google-maps

嗨，我创建了一个 Web 应用程序，在其中我可以使用 google V3 api 在地图上显示两个地方之间的距离，在其他 Web 应用程序中，我创建了动画放置标记，我可以在地图上移动我如何将这两者结合起来。这是我的代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Direction2.aspx.cs" Inherits="Direction2" %>  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  

<html xmlns="http://www.w3.org/1999/xhtml">  
<head runat="server">  
     <title></title>  
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
     <script type="text/javascript">
        var directionDisplay;
        var directionsService = new google.maps.DirectionsService();
        function initialize() {
             var latlng = new google.maps.LatLng(51.764696, 5.526042);
             directionsDisplay = new google.maps.DirectionsRenderer();
             var myOptions = {
                 zoom: 14,
                 center: latlng,
                 mapTypeId: google.maps.MapTypeId.ROADMAP,
                 mapTypeControl: false
            };
             var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
            directionsDisplay.setMap(map);
            directionsDisplay.setPanel(document.getElementById("directionsPanel"));
            var marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: "My location"
             });
        }
        function calcRoute() {
            var start = document.getElementById("routeStart").value;
            var end = "51.764696,5.526042";
            var request = {
                origin: start,
                destination: end,
                travelMode: google.maps.DirectionsTravelMode.DRIVING
            };
             directionsService.route(request, function (response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                }
            });
        }
</script>
</head>
<body onload="initialize()">

    <div id="map_canvas" style="width:710px; height:300px"></div>  
    <form action="" onsubmit="calcRoute();return false;" id="routeForm">
        <input type="text" id="routeStart" value=""/>
        <input type="submit" value="Route plannen"/>

<div id="directionsPanel"></div>
    </form>
 </body>
</html> 
```

对于动画，我使用以下代码： <%@ Page Language="C#" AutoEventWireup="true" CodeFile="Drop.aspx.cs" Inherits="Drop" %>

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Drop</title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

        <script type="text/javascript">
            var stockholm = new google.maps.LatLng(59.32522, 18.07002);
            var parliament = new google.maps.LatLng(59.327383, 18.06747);
            var marker;
            var map;

             function initialize() {
                var mapOptions = {
                    zoom: 13,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    center: stockholm
                };

                 map = new google.maps.Map(document.getElementById("map_canvas"),
      mapOptions);

                marker = new google.maps.Marker({
                    map: map,
                    draggable: true,
                    animation: google.maps.Animation.DROP,
                    position: parliament
                });
                 google.maps.event.addListener(marker, 'click', toggleBounce);
        }

             function toggleBounce() {

                 if (marker.getAnimation() != null) {
                     marker.setAnimation(null);
                 } else {
                     marker.setAnimation(google.maps.Animation.BOUNCE);
                }
            }
</script>

</head>
<body onload="initialize()" onunload="Gunload()">
    <form id="form1" runat="server">
     <div id="map_canvas" style="width:525px; height:237px;">
   </div>
 </form> 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T15:04:04.253

要在移动标记时更改开始或目的地城市的名称，您需要找到路线的开始和结束坐标，并使用谷歌地理编码器来查找位置的名称。

您需要监听“directions_changed”事件并找到开始和结束纬度。

```
google.maps.event.addListener(directionsDisplay, 'directions_changed', function() {
    var directions = this.getDirections();
    var overview_path = directions.routes[0].overview_path;
    var startingPoint = overview_path[0];
    var destination = overview_path[overview_path.length - 1];
    if (typeof startLatlng === 'undefined' || !startingPoint.equals(startLatlng)) {
        startLatlng = startingPoint;
        getLocationName(startingPoint, function(name) {
            routeStart.value = name;
        });
    }
    if (typeof endLatlng === 'undefined' || !destination.equals(endLatlng)) {
        endLatlng = destination;
        getLocationName(destination, function(name) {
            routeEnd.value = name;
        });
    }
}); 
```

要获取标记位置的名称，请使用以下函数（我快速将其放在一起，需要更多测试）

```
function getLocationName(latlng, callback) {
    geocoder.geocode({location: latlng}, function(result, status) {
        if (status === google.maps.GeocoderStatus.OK) {
            var i = -1;
            // find the array index of the last object with the locality type
            for (var c = 0; c < result.length; c++) {
                for (var t = 0; t < result[c].types.length; t++) {
                    if (result[c].types[t].search('locality') > -1) {
                        i = c;
                    }
                }
            }
            var locationName = result[i].address_components[0].long_name;
            callback(locationName);
        }
    });
} 
```

通过这种方式，您不能为应用于地图的地图标记设置点击事件，这意味着您不能让标记弹跳动画。如果您需要标记动画，则必须在路线服务中隐藏标记并显示您自己的标记。拖动标记时，您必须重新计算方向，然后将 getLocationName 函数与标记位置一起使用。

[这是一个工作演示。](http://jsfiddle.net/SMEAD/)

应该足以让你更接近你想要的。

**编辑** 我更新了代码以在拖动时更改开始或结束输入框的值。

标记拖动事件在只拖动一小段距离时会触发数百次，因此我们需要设置一个计时器以不请求许多地理编码。

我在这里整理了一个工作演示：http: [//jsfiddle.net/SMEAD/6/](http://jsfiddle.net/SMEAD/6/)

我们需要使用自己的标记，因此在初始化 DirectionsRenderer 时，我们需要传入 suppressMarkers 选项

```
directionsDisplay = new google.maps.DirectionsRenderer({
    suppressMarkers: true
}); 
```

我们只需要监听一次改变的方向并设置标记。

```
google.maps.event.addListenerOnce(directionsDisplay, 'directions_changed', function() {
    var directions = this.getDirections();
    var overview_path = directions.routes[0].overview_path;
    var startingPoint = overview_path[0];
    var destination = overview_path[overview_path.length - 1];
    addMarker(startingPoint, 'start');
    addMarker(destination, 'end');
}); 
```

工作马函数是addMarker。这设置了我们需要更新输入框并重新计算方向的事件。

```
function addMarker(position, type) {
    var marker = new google.maps.Marker({
        position: position,
        draggable: true,
        animation: google.maps.Animation.DROP,
        map: map
    });

    marker.type = type; // probably not a good idea to do this.

    google.maps.event.addListener(marker, 'drag', function() {
        var marker = this;
        clearTimeout(dragTimer);
        dragTimer = setTimeout(function() {
            getLocationName(marker.getPosition(), function(name) {
                if (marker.type === 'start') {
                    routeStart.value = name;
                } else {
                    endStart.value = name;
                }
            });
        }, 250);
    });

    google.maps.event.addListener(marker, 'dragend', function() {
        calcRoute(startMarker.getPosition(), endMarker.getPosition());
    });

    if (type === 'start') {
        startMarker = marker;
    } else {
        endMarker = marker;
    }
} 
```

# backbone.js - 保存在主干中后丢失模型实例

> ID：14080204
> 
> 赞同：0
> 
> 时间：2012-12-29T09:00:47.100
> 
> 标签：backbone.js, tastypie

我正在使用带有[tastepie](http://github.com/PaulUithol/backbone-tastypie)适配器和jquery 的[主干与DOM 交互。](http://backbonejs.org)我在骨干中发现了一些我无法理解的东西。我试图简化这个问题的代码。

这是我的 app.js：

```
$(document).ready(function() {
    Point = Backbone.Model.extend({
        defaults:{
            lat:0,
            lng:0
        },
        urlRoot: '/api/v1/point' ,
        initialize: function(attributes){
            var that = this;
            $('#b1').bind('click',function() {
                that.set('lat',that.get('lat')+1);
            });
            $('#b2').bind('click',function() {
                that.save();
            });
            $('#b3').bind('click',function() {
                console.log(that.get('lat'));
            });
        }
    });

    point = new  Point ();

    //****

    $('#b1').click();
    $('#b2').click();
    $('#b3').click(); // >> 1

    $('#b1').click();
    $('#b2').click();
    $('#b3').click(); // >> 2

    //****
}); 
```

还有我的html：

```
<script src="/static/js/jquery.js"></script>
<script src="/static/js/backbone.js"></script>
<script src="/static/js/backbone-tastypie.js"></script>
<script src="/static/js/app.js"></script>

<button id="b1">b1</button>
<button id="b2">b2</button>
<button id="b3">b3</button> 
```

如您所见，我正在调用单击代码中的按钮，并且控制台正在按预期记录“1”然后是“2”。

当我删除星号 (// *** ) 之间的代码并在浏览器中手动按下这些按钮 'b1'、'b2'、'b3'、'b1'、'b2'、'b3' 并得到 '1' 时，会出现问题和控制台中的“1”。

我等待来自服务器的响应 1 秒并在控制台中检查它，但应用程序的行为仍然相同：'1'、'2' 带有带星号的代码和 '1'、'1'，按下按钮.

你知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:06:57.443

> 我等待服务器的响应 1 秒钟并在控制台中检查它，但是 [...]

手动更改模型（使用鼠标单击按钮）而不是以编程方式 ( `click()`) 是这里的关键部分。

我假设**您不会从您的服务器返回最终模型**，因为 Backbone 使用该数据更新您的模型。

见[第 53 节](http://backbonejs.org/docs/backbone.html#section-53)和

```
if (options.wait) {
  if (attrs && !this._validate(attrs, options)) return false;
  current = _.clone(this.attributes);
} 
```

[第 55 条](http://backbonejs.org/docs/backbone.html#section-55)

```
options.success = function(resp, status, xhr) {
  done = true;
  var serverAttrs = model.parse(resp);
  if (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);
  if (!model.set(serverAttrs, options)) return false;
  if (success) success(model, resp, options);
}; 
```

[Backbone.js 文档](http://backbonejs.org/docs/backbone.html)的。特别是这些行：

`var serverAttrs = model.parse(resp);`（从响应中解析模型数据）

`if (!model.set(serverAttrs, options)) return false;`（更新模型的属性）

当您的第一个代码（`click()`按钮所在的代码）运行时，它会增加您的模型属性并在服务器返回之前记录它。那是

**注意：**在您的第一个代码中第二次按下按钮 3 时使用`wait`选项或 a将等同于行为。`setTimeout()`

但是你想要的是从你的服务器返回一个*有效*的模型（在持久化它之后）。

**题外话提示：**`initialize`你不应该在模型r中绑定你的模型和你的视图，否则`constructor`它们会耦合得太紧并且它们不能互换。（对于这个问题，当然可以接受。；）

# c# - 如何从 StorageFile 读取直到在 Windows Store 应用程序中找到一个字符？

> ID：14080206
> 
> 赞同：0
> 
> 时间：2012-12-29T09:01:10.903
> 
> 标签：c#, .net, windows-runtime, windows-store-apps

我有一个适用于 Windows Store 的应用程序，我想做的是从文件中读取文本。我有两个文本字段。descriptionTextField 接受新行。

```
 // Read from file
    public async Task ReadFile()
    {
        try
        {
            // get the file
            StorageFile notesStorageFile = await localFolder.GetFileAsync("NotesData.txt");
            var readThis = await FileIO.ReadLinesAsync(notesStorageFile);
            foreach (var line in readThis)
            {
                notesRepository.Add(new Note(line.Split(';')[0], line.Split(';')[1]));
            }
            Debug.WriteLine("File read successfully.");
        }
        catch (FileNotFoundException ex)
        {
            Debug.WriteLine("Error1: " + ex);
        }
    } 
```

现在如果*NotesData.txt*有：

**鸡蛋;描述鸡蛋;**

它的工作文件。

但是如果*NotesData.txt*有：

**杂货；买10个鸡蛋**

**买1公斤肉；**

我得到索引超出范围的错误。我只是不知道如何修复 ReadFile() 代码。

当我调用该方法时出现异常。我认为问题在于可以接受新行的descriptionTextBox。

NotesData.txt

苹果;说明苹果; // 工作正常

梨; 描述行 1

描述第 2 行

描述第 3 行；// 问题

梨; 描述行 1；// 工作正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:14:23.273

这一行：

```
notesRepository.Add(new Note(line.Split(';')[0], line.Split(';')[1])); 
```

假设您总是在一行中至少有一个分号。如果您的文件中有一行*没有*该行（例如空行），那么它将失败。

目前尚不清楚您的问题出在哪里，因为您还没有说异常来自哪里，但这是我的第一个猜测。

我也只会拆分一次：

```
string[] bits = line.Split(';');
if (bits.Length >= 2)
{
    // What do you want to do with lines with more than one semi-colon?
    notesRepository.Add(bits[0], bits[1]);
}
else
{
    // Handle lines without a semi-colon at all.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T07:48:22.773

在我看来，您正在尝试回读您之前保存的文件的内容，而您遇到的问题只是您选择用于保存数据的格式的结果。看着它，新的线路并不是你将要遇到的唯一困难。如果用户决定在其中一个文本框中输入分号怎么办？你在阻止吗？

我建议您放弃自己的序列化格式，而使用现有的一种。如果您`notesRespository`是`List<Note>`这可能是您的 XML （反）序列化代码：

```
private async Task Save(List<Note> notesRepository)
{
    var xmlSerializer = new XmlSerializer(typeof (List<Note>));
    using (var stream = await ApplicationData.Current.LocalFolder.OpenStreamForWriteAsync("notes.xml", CreationCollisionOption.ReplaceExisting))
    {
        xmlSerializer.Serialize(stream, notesRepository);
    }
}

private async Task<List<Note>> Load()
{
    var xmlSerializer = new XmlSerializer(typeof(List<Note>));
    using (var stream = await ApplicationData.Current.LocalFolder.OpenStreamForReadAsync("notes.xml"))
    {
        return (List<Note>) xmlSerializer.Deserialize(stream);
    }
} 
```

这对于 JSON：

```
private async Task Save(List<Note> notesRepository)
{
    var jsonSerializer = new DataContractJsonSerializer(typeof (List<Note>));
    using (var stream = await ApplicationData.Current.LocalFolder.OpenStreamForWriteAsync("notes.json", CreationCollisionOption.ReplaceExisting))
    {
        jsonSerializer.WriteObject(stream, notesRepository);
    }
}

private async Task<List<Note>> Load()
{
    var jsonSerializer = new DataContractJsonSerializer(typeof(List<Note>));
    using (var stream = await ApplicationData.Current.LocalFolder.OpenStreamForReadAsync("notes.json"))
    {
        return (List<Note>)jsonSerializer.ReadObject(stream);
    }
} 
```

当存储库变得太大而无法始终加载并作为一个整体保存时，您甚至可以考虑像[SQLite](http://visualstudiogallery.msdn.microsoft.com/23f6c55a-4909-4b1f-80b1-25792b11639e)这样的结构化存储。

# android - 如何在android中使用gridview显示动态生成的字符串？

> ID：14080212
> 
> 赞同：0
> 
> 时间：2012-12-29T09:01:45.013
> 
> 标签：android, string, gridview, dynamic

我有一个数字数组，我想从最近添加的数字中显示它们，格式如下：数组索引后跟一个冒号，数字以及取决于它是哪个数字，也是这样的感叹号：

`10:35, 09:41!, 08:17, 07:5!...`

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:09:56.497

它就像一个 ListView...

您需要 SDK 中的 Hello Gridview 示例：http: [//developer.android.com/guide/topics/ui/layout/gridview.html](http://developer.android.com/guide/topics/ui/layout/gridview.html)

只需将 ImageAdapter 替换为 TextAdapter 即可！

公共类 TextAdapter 扩展 BaseAdapter { 私有上下文 mContext;

```
public TextAdapter(Context c) {
    mContext = c;
}

public int getCount() {
    return mThumbIds.length;
}

public Object getItem(int position) {
    return null;
}

public long getItemId(int position) {
    return 0;
}

// create a new TextView for each item referenced by the Adapter
public View getView(int position, View convertView, ViewGroup parent) {
    TextView textView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        textView = new TextView(mContext);
        textView.setLayoutParams(new GridView.LayoutParams(85, 85));
        textView.setPadding(8, 8, 8, 8);
    } else {
        textView = (TextView) convertView;
    }

    textView.setText(strings[position]);
    return textView;
}

// references to our texts
private String[] strings = {
        "10:35","09:41!","08:17","07:5!",...
}; 
```

}

# android - 在android中启动程序时如何调用C程序？

> ID：14080215
> 
> 赞同：0
> 
> 时间：2012-12-29T09:02:17.787
> 
> 标签：android

我想在启动过程中自动执行一个 C 程序。我的 C 程序名为 smackload。

我尝试添加`service smackload /data/local/smackload`. `init.rc`这没有用。

我还在一个操作中添加了一个命令： `exec /data/local/smackload`

谁能给我一些想法？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:08:10.557

您必须为此使用 NDK。有关更多详细信息，请参见：-http://developer.android.com/tools/sdk/ndk/index.html

# android - 滚动列表时如何停止自动检查自定义列表视图中的复选框？

> ID：14080219
> 
> 赞同：1
> 
> 时间：2012-12-29T09:02:58.587
> 
> 标签：android, listview, checkbox

我正在制作一个带有复选框的自定义列表视图。问题是，当我滚动列表视图时，未选中的项目会自动选中。这是我正在使用的代码：

```
public class ContactAdapterSetRule extends ArrayAdapter<String> {

public static ArrayList<String> s_itemsOfAdapterArrayList;
Context m_context;
public static ArrayList<String> s_checkedIds = new ArrayList<String>();

public ContactAdapterSetRule(Context context, int textViewResourceId, ArrayList<String> s_contactNameArrayListSplash) {
    super(context, textViewResourceId, s_contactNameArrayListSplash);
    this.s_itemsOfAdapterArrayList = s_contactNameArrayListSplash;
    this.m_context = context;
    s_checkedIds.clear();  //Clearing the list of Checked Ids
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View l_view = convertView;
    if (l_view == null) 
    {
        LayoutInflater l_vi = (LayoutInflater)m_context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        l_view = l_vi.inflate(R.layout.showthecontacts, null);

        ViewHolder viewHolder = new ViewHolder();
        viewHolder.l_nameCheckBox = (CheckBox) l_view.findViewById(R.id.checkBox);;

        l_view.setTag(viewHolder);
    }

    String l_nameOfContact = s_itemsOfAdapterArrayList.get(position);
    ViewHolder holder = (ViewHolder) l_view.getTag();

    if (l_nameOfContact != null)
    {
        if (holder.l_nameCheckBox != null) 
        {
            holder.l_nameCheckBox.setText(l_nameOfContact);
        }

        holder.l_nameCheckBox.setOnClickListener(new OnItemClickListener(position,holder.l_nameCheckBox.getText(),holder.l_nameCheckBox));          
    }
    return l_view;
}

private class ViewHolder
{
    CheckBox l_nameCheckBox;
}

private class OnItemClickListener implements OnClickListener
{           
    private int l_positionOfItemClicked;
    private CharSequence l_text;
    private CheckBox l_checkBox;
    OnItemClickListener(int position, CharSequence text,CheckBox checkBox)
    {
        this.l_positionOfItemClicked = position;
        this.l_text = text;
        this.l_checkBox = checkBox;
    }
    @Override
    public void onClick(View arg0) 
    {
        if(l_checkBox.isChecked())
        {
            Log.v("","Checkbox is checked");
            for(int i = 0;i < s_checkedIds.size();i++)
                Log.v("",s_checkedIds.get(i));

            if(!s_checkedIds.contains(l_text.toString()))
            {
                s_checkedIds.add( l_text.toString());
                Log.e("",l_text.toString()+" is added to s_checkedIds");
            }
        }
        else
        {
            Log.v("","Checkbox is Unchecked");

            for(int i = 0;i < s_checkedIds.size();i++)
                Log.v("",s_checkedIds.get(i));
            if(s_checkedIds.contains(l_text.toString()))
            {
                s_checkedIds.remove( l_text.toString());
                Log.e("",l_text.toString()+" is removed from s_checkedIds");
            }
        }  
    } 
```

请帮助我。我不知道该怎么做。在此先感谢。

# arrays - 如何在 Python 中拥有具有动态名称的变量

> ID：14080229
> 
> 赞同：-1
> 
> 时间：2012-12-29T09:04:09.757
> 
> 标签：arrays, dynamic, python-2.7, filenames

我是 Python 新手，我希望为变量和数组实现动态名称的功能。例如，我想有 10 个这样的数组，具有不同的名称 `Array=[0 for i in range(10)]`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:56:31.837

我同意以前的帖子，这不是一个好主意。不过，这是一种方法

```
N = 3
code = ','.join(["Array"+str(n) for n in range(N)]) + " = " + ','.join(["[]" for n in range(N)])
exec code 
```

# visual-studio-2010 - 无法为 Visual Web 部件 Sharepoint 2010 Foundation 上的文档设置权限

> ID：14080231
> 
> 赞同：0
> 
> 时间：2012-12-29T09:04:20.437
> 
> 标签：visual-studio-2010, sharepoint-2010, permissions, web-parts

再会！我有一个事件处理程序，当您将文档添加到库时，它会将用户重定向到带有文档参数的 Web 表单。在 web 表单中，它以 Checkboxlist 的形式显示当前用户。用户选择适当的组，然后按下保存按钮。以下是根据所选组分配给文档的权限。问题是文档的分辨率没有根据选定的组分配。这是处理程序代码：

```
using System;
using System.Security.Permissions;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Utilities;
using Microsoft.SharePoint.Workflow;
using System.Web;
using System.IO;
namespace SharePointProject3.EventReceiver2
{
    /// <summary>
    /// События элемента списка
    /// </summary>
    public class EventReceiver2 : SPItemEventReceiver
    {
    private HttpContext _context;
    public EventReceiver2()
    {
        _context = HttpContext.Current;
    }
    public override void ItemAdding(SPItemEventProperties properties)
    {
        //Временно отключаем срабатывание обработчика
        EventFiringEnabled = false;
        //Получаем файл из HttpContext
            HttpPostedFile file = _context.Request.Files[0];
            Stream fileStream = file.InputStream;
            byte[] fileByte = new byte[file.ContentLength];
            fileStream.Read(fileByte, 0, file.ContentLength);
            //Загружаем файл в библиотеку документов
            SPFile fileUploded = properties.Web.Files.Add(properties.AfterUrl, fileByte);
            //Включаем обработчик обратно
            EventFiringEnabled = true;
            //Отменяем добавление файла, которое делал пользователь
            properties.Cancel = true;
            properties.Status = SPEventReceiverStatus.CancelWithRedirectUrl;
            //Деламе редирект
            properties.RedirectUrl = properties.Web.Url + "/test_perm/default.aspx?ID=" + fileUploded.UniqueId;
        }
    }

    } 
```

这是 Web 部件的代码：

```
using System;
using System.ComponentModel;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using Microsoft.SharePoint;
using Microsoft.SharePoint.WebControls;
using System.Text;
using Microsoft.SharePoint.Utilities;
namespace CustomGroupAssignment.VisualWebPart1
{
    public partial class VisualWebPart1UserControl : UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            using (SPSite site = new SPSite("http://kviten:83/"))
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPUser currentUser = web.CurrentUser;
                    SPDocumentLibrary docLib = (SPDocumentLibrary)web.Lists["Test_Doc_Lib"];
                    SPGroupCollection webGroups = currentUser.Groups;
                    CheckBoxList1.DataSource = webGroups;
                    CheckBoxList1.DataValueField = "ID";
                    CheckBoxList1.DataTextField = "Name";
                    CheckBoxList1.DataBind();
                    foreach (ListItem li in CheckBoxList1.Items)
                    {
                        li.Selected = true;
                    }
                    try
                    {
                        string itemID = Page.Request.Params["ID"];
                        SPDocumentLibrary doclib = (SPDocumentLibrary)web.GetList(SPUrlUtility.CombineUrl(web.Url, "/DocLib2/Forms/AllItems.aspx"));
                        SPListItem item = doclib.GetItemByUniqueId(new Guid(itemID));
                     }
                   catch (Exception ex)
                    {
                        //Выводим ошибку
                    }

                }
            }
        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            using (SPSite site = new SPSite("http://kviten:83/"))
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPUser currentUser = web.CurrentUser;
                    SPDocumentLibrary docLib = (SPDocumentLibrary)web.Lists["Test_Doc_Lib"];
                      try
                    {
                        string itemID = Page.Request.Params["ID"];
                        SPDocumentLibrary doclib = (SPDocumentLibrary)web.GetList(SPUrlUtility.CombineUrl(web.Url, "/Test_Doc_Lib/"));
                        SPListItem item = doclib.GetItemByUniqueId(new Guid(itemID));
                        //Break the role inheritance from List and remove any RoleAssignments
                        //item.BreakRoleInheritance(false);
                        //while (item.RoleAssignments.Count > 0)
                        //{
                        //    item.RoleAssignments.Remove(0);
                        //}
                        if (!item.HasUniqueRoleAssignments)
                        {
                            item.ResetRoleInheritance();
                            item.Update();
                            item.BreakRoleInheritance(false);
                            item.Update();
                        }
                            foreach (ListItem li in CheckBoxList1.Items)
                        {
                            if (li.Selected) //Response.Write("- " + li.Text + "<br/>");
                            {
                                // Give permissions to a specific group
                                SPGroup group = web.Groups.GetByID(Convert.ToInt32(li.Value));
                                SPPrincipal principalGroup = group;
                                SPRoleAssignment roleassignment_group = new SPRoleAssignment(group);
                                SPRoleAssignment roleAssignment = item.RoleAssignments.GetAssignmentByPrincipal(principalGroup);
                                item.RoleAssignments.Add(roleAssignment);
                                item.Update();
                            }
                        }
                   }

                   catch (Exception ex)
                  {
                        //Выводим ошибку
                   }
                    Context.Response.Write("<script type='text/javascript'>window.frameElement.commitPopup();</script>");
                    Context.Response.Flush();
                    Context.Response.End();
                }
            }
        }
            protected void btnCancel_Click(object sender, EventArgs e)
        {
            Context.Response.Write("<script type='text/javascript'>window.frameElement.commitPopup();</script>");
            Context.Response.Flush();
            Context.Response.End();
         }
    }
} 
```

我不明白为什么我不能为文档分配权限！请帮忙！如果您使用`/ / Response.Write ("-" + li.Text + "<br/>");`注释掉的 which，我们可以看到复选框未选中且未显示。item.ResetRoleInheritance(); 执行并仅将权限分配给没有组的当前用户。可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T09:43:59.627

Web 部件的正确解决方案：

```
using System;
using System.ComponentModel;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using Microsoft.SharePoint;
using Microsoft.SharePoint.WebControls;
using System.Text;
using Microsoft.SharePoint.Utilities;
namespace CustomGroupAssignment.VisualWebPart1
{
    public partial class VisualWebPart1UserControl : UserControl
    {
           protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack) { 
            using (SPSite site = new SPSite("http://kviten:83/"))
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPUser currentUser = web.CurrentUser;
                    SPDocumentLibrary docLib = (SPDocumentLibrary)web.Lists["Test_Doc_Lib"];
                    SPGroupCollection webGroups = currentUser.Groups;
                    CheckBoxList1.DataSource = webGroups;
                    CheckBoxList1.DataValueField = "ID";
                    CheckBoxList1.DataTextField = "Name";
                    CheckBoxList1.DataBind();
                    foreach (ListItem li in CheckBoxList1.Items)
                    {
                        li.Selected = true;
                    }
                    try
                    {
                        string itemID = Page.Request.Params["ID"];
                        SPDocumentLibrary doclib = (SPDocumentLibrary)web.GetList(SPUrlUtility.CombineUrl(web.Url, "/DocLib2/Forms/AllItems.aspx"));
                        SPListItem item = doclib.GetItemByUniqueId(new Guid(itemID));
                    }
                    catch (Exception ex)
                    {
                        //Выводим ошибку
                    }
                }
                }
            }
        }

           protected void Button1_Click(object sender, EventArgs e)
           {
               using (SPSite site = new SPSite("http://kviten:83/"))
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPUser currentUser = web.CurrentUser;
                    SPDocumentLibrary docLib = (SPDocumentLibrary)web.Lists["Test_Doc_Lib"];
                        string itemID = Page.Request.Params["ID"];
                        SPDocumentLibrary doclib = (SPDocumentLibrary)web.GetList(SPUrlUtility.CombineUrl(web.Url, "/Test_Doc_Lib/"));
                        SPListItem item = doclib.GetItemByUniqueId(new Guid(itemID));
               foreach (ListItem li in CheckBoxList1.Items)
               {
                   if (li.Selected) //Response.Write("- " + li.Text + "<br/>");
                   {
                                if (!item.HasUniqueRoleAssignments)
                                {
                                    item.ResetRoleInheritance();
                                    item.Update();
                                }
                                item.BreakRoleInheritance(false);
                                item.Update();
                                SPGroup group = web.Groups.GetByID(Convert.ToInt32(li.Value));
                                SPPrincipal principalGroup = (SPPrincipal)group;
                                //SPRoleAssignment roleassignment_group = new SPRoleAssignment(principalGroup);
                                SPRoleAssignment roleAssignment = item.Web.RoleAssignments.GetAssignmentByPrincipal(principalGroup);
                                item.RoleAssignments.Add(roleAssignment);
                                item.Update();
                               // var roleAssignment = new SPRoleAssignment(principalGroup);
                              //  item.RoleAssignments.Add(roleAssignment);
                               // item.Update();
                                }
                        }
               Context.Response.Write("<script type='text/javascript'>window.frameElement.commitPopup();</script>");
               Context.Response.Flush();
               Context.Response.End();
                   }
               }
           }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Context.Response.Write("<script type='text/javascript'>window.frameElement.commitPopup();</script>");
            Context.Response.Flush();
            Context.Response.End();
        }
    }
} 
```

# php - PHP随机全局排序

> ID：14080234
> 
> 赞同：0
> 
> 时间：2012-12-29T09:05:09.950
> 
> 标签：php, list, glob

我有这个简单的行：

```
 $images = glob($directory . "*.html"); 
```

它返回一个像这样的文件列表：
**例如 1**

```
17001400300120110004600.html
17001400300120110004700.html
17001400300120110004800.html
17001400300120110004900.html
17001400300120110005000.html 
```

问题是我不需要有序列表。我需要一个随机列表，如下所示：

**例如 2**

```
17001400300120110004700.html
17001400300120110005000.html
17001400300120110004900.html
17001400300120110004600.html
17001400300120110005800.html 
```

我尝试过使用`NOSORT ( $images = glob($directory . "*.html", GLOB_NOSORT); )`标志，但返回一个有序列表，就像第一个示例一样。

如何获得随机列表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T09:07:42.667

对从 glob 返回的数组使用[shuffle](http://php.net/manual/en/function.shuffle.php)。

使用 nosort 不会使您的数组随机化，它只会按照它们出现在目录中的顺序读取它们，而不是按名称对它们进行排序，如文档所述：

> GLOB_NOSORT - 返回出现在目录中的文件（不排序）

请记住，`shuffle`将数组作为参考，因此您需要这样做：

```
$images = glob($directory . "*.html");
shuffle($images); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T09:08:37.413

```
$images = shuffle(glob($directory . "*.html")); 
```

# javascript - email validation in javascript

> ID：14080243
> 
> 赞同：1
> 
> 时间：2012-12-29T09:06:33.130
> 
> 标签：javascript, asp.net

I am using razor view in my application. I am trying to validate my mailID. I got email pattern format like,

```
 function validateEmail(mail) {
  var emailPattern =  var emailPattern = /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
     if (emailPattern.test(mail) == false) {
           $("#emailvalidation").text("Email is not in correct format");
       }
       else if (emailPattern.test(mail) == true) {
        }
     } 
```

but If I give this in my function,It is displaying error at the "@" symbol. can any one help me,how to fix this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:13:06.080

because Razor code blocks are enclosed in @{ ... }, Inline expressions (variables and functions) start with @, Code statements end with semicolon.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:21:35.387

Change this line.

```
var emailPattern =  var emailPattern = /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/; 
```

To this

```
var emailPattern = /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/; 
```

See the associated [jsfiddle](http://jsfiddle.net/kjv9k/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:00:10.113

I gave like, var emailPattern = /^[a-zA-Z0-9_.-]+@@[a-zA-Z0-9]+[a-zA-Z0-9.-]+[a-zA-Z0-9]+.[a-z]{0,4}$/; I used "@" twice. it is working fine in my case.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-01T18:36:03.840

```
I am trying to restrict the user not to insert more than two domain after the '@'. 

/^[\w-_$\.]+@[\w]+((\.)((\w){2,4})){1,2}$/ 
```

# pointers - 指针在 stm32 上使用 freeRTOS 随机分配神秘值（A5A5A5A5 和 FFFFFFFF）导致硬故障

> ID：14080244
> 
> 赞同：5
> 
> 时间：2012-12-29T09:06:39.153
> 
> 标签：pointers, operating-system, embedded, hardware, stm32

我遇到了一个硬故障问题，它出现在看似随机的时间，其中一个指针指向地址 A5 或 FF（我允许的内存空间远低于 80000000 及以上的内存空间）。这两个值似乎总是同一个指针。

我正在使用运行 STM32F205RE 处理器的嵌入式系统，该处理器与发生此错误的名为 cg2900 的 fm/蓝牙/gps 芯片通信。

使用调试器，我可以看到在几次测试运行期间指针分别指向地址 A5 和 FF。然而，它似乎是随机发生的，有时我可以运行测试一个小时而不会失败，而其他时候它会崩溃 20 秒。

我正在运行 freeRTOS 作为调度程序，以在可能会以某种方式干扰的不同任务（一个用于无线电，一个用于蓝牙，一个用于其他定期维护）之间切换。

这可能是什么原因？由于它正在运行自定义硬件，因此不能排除这是硬件问题（可能）。关于如何解决问题的任何指示（没有双关语）？

编辑：

经过进一步调查，它崩溃的地方似乎是非常随机的，而不仅仅是那个特定的指针。我使用硬故障处理程序来获取这些寄存器的以下值（所有值均为十六进制）：

崩溃前的半长跑（分钟）：

```
R0 = 1
R1 = fffffffd
R2 = 20000400
R3 = 20007f7c
R12 = 7
LR [R14] = 200000c8  subroutine call return address
PC [R15] = 1010101  program counter
PSR = 8013d0f
BFAR = e000ed38
CFSR = 10000
HFSR = 40000000
DFSR = 0
AFSR = 0
SCB_SHCSR = 0 
```

崩溃前很短的运行时间（秒）：

```
R0 = 40026088
R1 = fffffff1
R2 = cb3
R3 = 1
R12 = 34d
LR [R14] = 40026088  subroutine call return address
PC [R15] = a5a5a5a5  program counter
PSR = fffffffd
BFAR = e000ed38
CFSR = 100
HFSR = 40000000
DFSR = 0
AFSR = 0
SCB_SHCSR = 0 
```

另一个短的（秒）：

```
R0 = 0
R1 = fffffffd
R2 = 20000400
R3 = 20007f7c
R12 = 7
LR [R14] = 200000c8  subroutine call return address
PC [R15] = 1010101  program counter
PSR = 8013d0f
BFAR = e000ed38
CFSR = 1
HFSR = 40000000
DFSR = 0
AFSR = 0
SCB_SHCSR = 0 
```

经过很长时间（1小时+）：

```
R0 = e80000d0
R1 = fffffffd
R2 = 20000400
R3 = 2000877c
R12 = 7
LR [R14] = 200000c8  subroutine call return address
PC [R15] = 1010101  program counter
PSR = 8013d0f
BFAR = 200400d4
CFSR = 8200
HFSR = 40000000
DFSR = 0
AFSR = 0
SCB_SHCSR = 0 
```

似乎大部分时间都在同一点崩溃。我根据之前的建议调整了内存，但我似乎仍然有同样的问题。

谢谢你的时间！

亲切的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T11:27:39.293

在您的评论中，您提到该指针被显式分配一次，然后从未被写入。在这种情况下，您至少应该声明它`const`并使用初始化而不是赋值，例如

```
arraytype* const ptr = array ; 
```

这将允许编译器检测任何显式写入。然而，指针更有可能被一些不相关的编码错误破坏。

Coretx-M3 片上调试支持数据访问断点；您应该在有问题的指针上设置这样的断点，以便捕获对它的所有写访问。您将在初始化时休息一下，然后在修改后休息 - 有意或无意。

可能的原因是相邻数组或线程堆栈溢出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T21:38:41.517

如果您尝试重新定位阵列并继续遇到同样的问题，

**然后有些任务溢出了。**

正如您所提到的，您使用的是 FreeRTOS，并且由于行为是随机的，因此您在调用[***xTaskCreate***](http://www.freertos.org/a00125.html#Parameters)**时的设置STACK_SIZE**可能有问题 这通常发生在分配的大小小于您真正需要的大小时。[](http://www.freertos.org/a00125.html#Parameters)

 *如果您阅读有关*usStackDepth*的文档，您会注意到它**表示乘数而不是字节数。**

> *我个人会排除您的嵌入式主板中的硬件问题，我会专注于 FreeRTOS 的配置问题*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T12:16:03.247

原来问题是由内存存储引起的。当我以最高速度（120 Mhz）运行处理器并使用 1.8 伏电源（它主要设计用于 3 伏）时，我的内存出现了一些竞争状况。通过使用更高的等待状态来解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-19T16:06:43.263

我还没有准备好完整的问题，但听起来 0xa5a5a5a5a5 值是位解压缩的症状，类似于位腐烂。基本上，0xffffffff = 0b11111111111111111111111111111111 的叠层结构开始剥离，1 的相互偏离。他们甚至可以开始侵入相邻的单词。*

# objective-c - 如何向现有方法添加另一个参数

> ID：14080247
> 
> 赞同：1
> 
> 时间：2012-12-29T09:07:02.280
> 
> 标签：objective-c, methods, parameters, add

我有一个类别`NSObject+Utilities`，其中包含我在项目中使用的各种工具方法。不幸的是，我必须在返回的方法中再添加一个参数`NSColor`。

这里有一个例子：

```
- (NSColor*) ccBlueLight   { 
   return  [self libMakeAColor    :0.000f :0.535f :1.0f :1.000f];
} 
```

最后一个参数 ( `1.000f`) 负责透明度。当我创建这个方法时，我没有想到透明度，我将它固定为`1.000f`. 由于我`cc`在不同的项目中使用这些颜色，我不能简单地添加另一个参数而不会在使用它们时在其他项目中出错。

有没有办法毫无问题地添加透明度参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T09:16:06.660

编写一个带有透明度参数的新方法：

```
- (NSColor*) ccBlueLight:(CGFloat)transparency { 
   return  [self libMakeAColor    :0.000f :0.535f :1.0f :transparency];
} 
```

并更改现有方法的实现以使用默认值。

```
- (NSColor*) ccBlueLight {
    return [self ccBlueLight:1.000f];
} 
```

请注意，这两种是不同的方法。旧的签名没有改变，也没有必要改变旧的调用者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:18:49.887

有什么反对简单地添加第二种方法的吗？这样一个项目可以使用原始方法，而另一个项目可以使用新方法。

```
- (NSColor *) ccBlueLightWithAlpha:(NSNumber *)alpha
{
    return  [self libMakeAColor    :0.000f :0.535f :1.0f :[alpha floatValue];    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:15:02.507

像这样？

```
- (NSColor*) ccBlueLight   { 
  return  [self libMakeAColorRed:0.000f green:0.535f blue:1.0f];
}

- (NSColor*) ccBlueLightWithAlpha:(CGFloat)alpha   { 
  return  [self libMakeAColorRed:0.000f green:0.535f blue:1.0f alpha:alpha];
} 
```

# php - 如何在 node.js 中加载谷歌图表？

> ID：14080262
> 
> 赞同：4
> 
> 时间：2012-12-29T09:09:37.060
> 
> 标签：php, node.js, google-visualization, phantomjs

当我尝试在 node.js 中加载 Google Chart 时，没有任何反应。

我尝试从zombie.js 和jsdom 中的折线图文档中加载第[一个示例](https://developers.google.com/chart/interactive/docs/gallery/linechart#Example)，但无论哪种情况，图表都不会加载。

最终目标是检索生成图表的 SVG 数据以导出为图像或 PDF。因此，如果可以使用替代方法（使用 node.js 或 PHP 的服务器端）来实现这一点，我愿意接受建议。

**注意**：我已经使用 gChartPhp 成功生成了一些图表的图像，但该项目的要求规定嵌入式版本是当前 API 提供的交互式版本，并且导出版本在视觉上与嵌入式版本相同（没有交互， 明显地）。

**编辑**：我标记了[PhantomJS](http://phantomjs.org/)，因为这是我最终采用的解决方案。

*抱歉缺少链接，但垃圾邮件预防机制只允许我发布 2。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-06-24T20:43:02.797

我迟到了 8 年，但我刚刚发布了一个开源项目[Google Charts Node](https://github.com/typpo/google-charts-node)，它在 Puppeteer 中呈现图表图像（有点像原始 PhantomJS 解决方案的继承者）。

[google-charts-node](https://www.npmjs.com/package/google-charts-node)可作为 NPM 库使用，可以像这样使用：

```
const GoogleChartsNode = require('google-charts-node');

function drawChart() {
  // Set up your chart here, just like in the browser
  // ...

  const chart = new google.visualization.BarChart(container);
  chart.draw(data, options);
}

// Render the chart to image
const image = await GoogleChartsNode.render(drawChart, {
  width: 400,
  height: 300,
}); 
```

现在您可以将此`image`缓冲区保存为文件或将其作为 HTTP 响应返回，等等。

创建它非常简单。主要的警告是：

1.  并非所有图表都支持 getImageURI，所以当发生这种情况时，我会求助于 puppeteer 来截取屏幕截图。
2.  很慢！但是，如果您必须使用 Google 图表作为要求，那么您真的没有其他选择。这个问题可以通过足够的云计算资源来缓解。

你可以在[Github 项目](https://github.com/typpo/google-charts-node)中查看完整的源代码，但是如果你想自己做的话，这里是原始的 puppeteer 流程​​：

```
async function render() {
  // Puppeteer setup
  const browser = await puppeteer.launch();
  const page = await browser.newPage();

  // Add the chart
  await page.setContent(`...Insert your Google Charts code here...`);

  // Use getImageURI if available (not all charts support)
  const imageBase64 = await page.evaluate(() => {
    if (!window.chart || typeof window.chart.getImageURI === 'undefined') {
      return null;
    }
    return window.chart.getImageURI();
  });

  let buf;
  if (imageBase64) {
    buf = Buffer.from(imageBase64.slice('data:image/png;base64,'.length), 'base64');
  } else {
    // getImageURI was not available - take a screenshot using puppeteer
    const elt = await page.$('#chart_div');
    buf = await elt.screenshot();
  }

  await browser.close();
  return buf;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T00:33:06.273

这不是理想的解决方案，但我找到了 node.js 的替代方案，用于在[PhantomJS](http://phantomjs.org/)中实现相同的最终目标。只需创建一个包含图表 (test.html) 的 HTML 文件，并且像 node.js 一样，创建一个包含您的代码 (test.js) 的 JS 文件。然后用 PhantomJS 运行你的 JS 文件。

在您的 JS 文件中，将您的 HTML 文件作为网页打开，然后将其渲染，或者将图像缓冲区保存到文件中：

```
var page = require('webpage').create();
page.open('test.html', function () {
    page.render('test.png');
    phantom.exit();
}); 
```

然后运行它：

```
phantomjs test.js 
```

要动态创建图表，请创建以下 JS 文件 (test2.js)：

```
var system = require('system');
var page = require('webpage').create();
page.onCallback = function(data)
{
    page.clipRect = data.clipRect;
    page.render('test.png');
    phantom.exit();
};
page.includeJs('http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js', function()
{
    page.includeJs('https://www.google.com/jsapi', function()
    {
        page.evaluate(function(chartType, data_json, options_json)
        {
            var div = $('<div />').attr('id', 'chart').width(900).height(500).appendTo($('body'));
            google.load("visualization", "1",
            {
                packages:[chartType == 'GeoChart' ? 'geochart' : 'corechart'],
                callback: function()
                {
                    data_arr = $.parseJSON(data_json);
                    data = google.visualization.arrayToDataTable(data_arr);
                    options = $.parseJSON(options_json);
                    chart = new google.visualization[chartType]($(div).get(0));
                    google.visualization.events.addListener(chart, 'ready', function()
                    {
                        window.callPhantom(
                        {
                            clipRect: $(div).get(0).getBoundingClientRect()
                        });
                    });
                    chart.draw(data, options);
                }
            });
        }, system.args[1], system.args[2], system.args[3]);
    });
}); 
```

然后运行它：

```
phantomjs test2.js LineChart '[["Date","Steve","David","Other"],["Dec 31",8,5,3],["Jan 1",7,10,4],["Jan 2",9,4,3],["Jan 3",7,5,3]]' '{"hAxis.slantedText":true}'

phantomjs test2.js PieChart '[["Employee","Calls"],["Steve",31],["David",24],["Other",13]]' '{"is3D":true}'

phantomjs test2.js GeoChart '[["State","Calls"],["US-CA",7],["US-TX",5],["US-FL",4],["US-NY",8]]' '{"region":"US","resolution":"provinces"}' 
```

要从外部脚本获取图像数据，请复制 test2.js (test3.js) 并更改

```
page.render('test.png'); 
```

到

```
console.log(page.renderBase64('png')); 
```

然后调用它（例如来自 PHP）：

```
<?php

    $data = array(
        array("Employee", "Calls"),
        array("Steve", 31),
        array("David", 24),
        array("Other", 13)
    );
    $options = array(
        "is3D" => true
    );
    $command = "phantomjs test3.js PieChart '" . json_encode($data) . "' '" . json_encode($options) . "'";
    unset($output);
    $result = exec($command, $output);
    $base64_image = implode("\n", $output);
    $image = base64_decode($base64_image);

?> 
```

**注意**：回顾整个过程，我在使用 node.js 时遇到的问题可能是我没有设置回调或超时来等到图表“准备好”。

# excel - Excel VBA 打印自动调整问题

> ID：14080264
> 
> 赞同：0
> 
> 时间：2012-12-29T09:09:49.260
> 
> 标签：excel, vba

我有一个 excel VBA 打印函数，对于我想在工作簿中打印的每张工作表调用一次

我循环浏览 VBA 中的工作表并调用此函数。

```
Sub PrintSheet
  With ActiveSheet

    'lastRow is worked out here....

    'Autofit YTD and SLY
    .Columns("J:J").AutoFit
    .Columns("K:K").AutoFit

    'Autofit email column
    .Columns("F:F").AutoFit

    With .PageSetup
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .Orientation = xlLandscape
        .LeftMargin = Application.InchesToPoints(0.4)
        .RightMargin = Application.InchesToPoints(1)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.5)
        .RightFooter = "&P of &N"

        .PrintArea = "$A$1:$O$" & CStr(lastRow)
    End With

    .PrintOut
 End With
End Sub 
```

我遇到的问题是，有时（随机行为，并不总是相同的工作表）我正在自动调整的列会拉伸得非常宽，从而迫使其他列离开页面。这与数据无关，因为您可以再次运行打印例程，它会打印以前很好地拉伸列的同一张表。我正在修剪工作表中的所有列值，因为它们首先使用 VBA 代码输入

除了我所说的拉伸列是自动调整的列之外，我无法找到任何具有这种行为的模式。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T12:31:51.447

我在使用时经历过很多次`autofit`；所以我现在尽量少用它。

你可以做的事情：

1.使用设定的宽度，例如，如果您知道 J 列在 47 宽度时总是可以的，则使用`Columns("D:D").ColumnWidth = 47`
2。您可以在子例程的末尾添加一些测试，如下所示：

```
Sub PrintSheet()

With Excel.ActiveSheet

    'lastRow is worked out here....
    lastRow = .Cells(.Rows.Count, 1).End(Excel.xlUp).Row

    'Autofit YTD / SLY / email
    .Columns("J:J").AutoFit
    .Columns("K:K").AutoFit
    .Columns("F:F").AutoFit

    With .PageSetup
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .Orientation = Excel.xlLandscape
        .LeftMargin = Application.InchesToPoints(0.4)
        .RightMargin = Application.InchesToPoints(1)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.5)
        .RightFooter = "&P of &N"
        .PrintArea = "$A$1:$O$" & lastRow 'CStr(lastRow) <=== & does an implicit conversion
    End With

    'add three checks here <====
    '<==I've picked 100 out of thin air but you need to change this to a value which indicates that it has behaved badly
    If .Columns("J:J").ColumnWidth > 100 Then
        .Columns("J:J").ColumnWidth = 30  '<== you might want to amend 30
    End If
    If .Columns("k:k").ColumnWidth > 100 Then
        .Columns("k:k").ColumnWidth = 30
    End If
    If .Columns("f:f").ColumnWidth > 100 Then
        .Columns("f:f").ColumnWidth = 30
    End If

    .PrintOut

End With
End Sub 
```

# c# - 无法完全清除会话

> ID：14080265
> 
> 赞同：1
> 
> 时间：2012-12-29T09:09:50.350
> 
> 标签：c#, asp.net, session-variables

我正在使用 c# 和 MSSQL DB 在 ASP.NET 中开发一个应用程序。我正在使用一个简单的逻辑，如果会话变量包含适当的值，那么应该打开一个页面，否则它应该重定向到登录页面。这是工作的代码。

```
protected void Page_Load(object sender, EventArgs e)
        {
            if(Session["loggedinloginid"]==null || Session["loggedinpassword"]==null)
                Response.Redirect("login.aspx");

            con.ConnectionString = ConfigurationManager.ConnectionStrings["familyConnectionString"].ConnectionString;
            con.Open();
            adp = new SqlDataAdapter("select * from admins where loginid=N'" + Session["loggedinloginid"].ToString() + "' AND password=N'" + Session["loggedinpassword"].ToString() + "'", con);
            dt = new DataTable();
            adp.Fill(dt);

            if (dt.Rows.Count == 0)
                Response.Redirect("login.aspx");

            LinkButton lb=(LinkButton)(Master.FindControl("LinkButton1"));
            lb.Text = "Welcome " + Session["loggedinloginid"].ToString()+"| Log Out |";
            lb.Click += new EventHandler(lb_Click);
        }

        void lb_Click(object sender, EventArgs e)
        {
            Session.Clear();
            Response.RedirectPermanent("WebForm2.aspx");
            //throw new NotImplementedException();
        } 
```

问题是，当我注销并清除会话并在浏览器中输入要保护的页面的 URL（带有此代码的页面）时，它会打开！为什么以及如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:33:33.747

```
 Session.Abandon(); 
```

删除存储在 Session 中的所有对象。如果您不显式调用 Abandon 方法，则服务器会在会话超时时删除这些对象并销毁会话。

查看此链接以了解清除，放弃之间的区别

[Session.Abandon() 和 Session.Clear() 有什么区别](https://stackoverflow.com/questions/1470445/what-is-the-difference-between-session-abandon-and-session-clear)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:24:03.547

您可以使用 Session.Remove() 方法；

Session.Remove("会话名称");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:45:07.930

您在该页面重定向完成到“WebForm2.aspx”后删除会话。您在“Webform3.aspx”页面中编写会话删除功能。并重定向到登录页面后。并且您还检查了 webconfig 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T09:58:54.030

您的问题出在这一行：

```
 lb.Click += new EventHandler(lb_Click); 
```

Click-EventHandler 的代码永远不会被调用，因为您在 OnLoad-Event 中订阅了 EventHandler，但这在生命周期中为时已晚。将该行移动到 OnInit-Event 中，您的代码应该可以按预期工作。

您还应该考虑清理您的 SQL 查询以防止 SQL 注入（我不知道您的登录名是什么样的，但根据您上面发布的代码，它可能容易受到 SQL 注入的攻击）。

如果您可以选择 .net 3.5 或更高版本，我建议您查看简单的 ORM-Mapper，例如 Linq2SQl 或 EntityFramework（首先查看 Linq2SQL），它们允许您使用 LINQ 进行查询和（afaik）sanatize你的输入。

# android - 设置操作栏项目的下拉菜单

> ID：14080269
> 
> 赞同：4
> 
> 时间：2012-12-29T09:10:36.713
> 
> 标签：android, android-actionbar, actionbarsherlock, dropdownbox

我正在通过以下代码设置操作栏和项目，并显示相应的**image1**。当用户单击显示书签屏幕操作项时，它会转到其他活动。**在该活动中，我希望在SHOW BOOKMARK SCREEN**的位置显示另一个项目（**SELECT BOOKMARK TYPE**）。因此，我正在考虑通过将相应的事物设置为 true 或 false 来使用抽象类来管理它，如下所示。但现在我无法得到两件事。

 **`1)`如何区分两个操作项的情况 0？因为我正在用另一个替换操作项。

`2)`如何获得该**SELECT BOOKMARK TYPE**的下拉菜单，如图**2**所示。

看过很少的帖子，但由于我对 android 有点陌生，我无法理解并通过将额外的代码添加到我现在的代码来完成它。你能帮我解决这个问题吗？代码片段表示赞赏。提前致谢。

```
public abstract class ActionActivity extends SherlockActivity {
    protected boolean mIsShowBookmarkScreen = true;

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {

         if(mIsShowBookmarkScreen)
         {
             menu.add("SHOW BOOKMARK SCREEN")
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
         }

         else 
         {
             menu.add(SELECT BOOKMARK TYPE);
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
         }

        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        //This uses the imported MenuItem from ActionBarSherlock
        switch(item.getItemId())
        {

        case 0:
            Intent intent = new Intent(ActionActivity.this,BookmarkScreen.class);
            startActivity(intent);
            return true;
        }
        return false;
    }

     @Override
        protected void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);
            getSupportActionBar().setHomeButtonEnabled(true);
        }

} 
```

**图片1：**

![在此处输入图像描述](../Images/fb5dfd92978683f7646d2bdd41382587.png)

**图 2：**

![在此处输入图像描述](../Images/532e18fa84f29ca6d9f6c32aa8218de2.png)

至少有人可以帮助实现第二个。我对第一个问题有了一个想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:21:05.833

**1）**通过使用区分`instanceof`。

```
if (this instanceof ActivityA) {
    // start Intent A
} else if (this instanceof ActivityB) {
    // start Intent B
} 
```

**2）**添加一个`Spinner`作为自定义`ActionView`。

```
<string-array name="items">
    <item>SELECT BOOKMARK TYPE</item>
    <item>TYPE-1</item>
    <item>TYPE-2</item>
    <item>TYPE-3</item>
</string-array> 
```

```
MenuItem spinnerItem = menu.add(null);
spinnerItem.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
IcsSpinner spinner = new IcsSpinner(this, null);
ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
        this, R.array.items, R.layout.sherlock_spinner_item);
adapter.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
spinner.setAdapter(adapter);
spinner.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,
        LayoutParams.MATCH_PARENT));
spinnerItem.setActionView(spinner); 
```

请注意，我在`IcsSpinner`这里使用私有类型在 SDK 版本 < 4.0 上创建相同的外观。有关详细信息，请参阅此[答案](https://stackoverflow.com/a/13630278/1018177)。

如果您想进一步自定义`Spinner`，您可能需要创建自己的`Adapter`.**

# php - 这是使用 CakePHP 2.4 添加 META TAGS 的正确方法吗？

> ID：14080272
> 
> 赞同：2
> 
> 时间：2012-12-29T09:11:18.997
> 
> 标签：php, cakephp, cakephp-2.0

我有默认模板和名为 home.ctp 的视图

当用户调用首页**/**首页**视图时**在 default.ctp 中呈现。

在我*看来*，我有：

```
<?php

$this->set('title', 'This is the title');

$this->set('description', 'This is the description');

...
?> 
```

在我的*default.ctp*我有：

```
<title><?php echo $title; ?></title>
....

<meta name="description" content="<?php echo $description; ?>">
.... 
```

它工作正常，但是，这是在 CakePHP 中添加标题和元标记的正确方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:50:37.117

## 不

这不是输出标题和描述变量的安全方式。

Cake 确实有一个辅助函数，用于[输出](http://book.cakephp.org/2.0/en/core-libraries/helpers/html.html#inserting-well-formatted-elements)从文档中提取的元标记：

```
<?php
echo $this->Html->meta(
    'description',
    'enter any meta description here'
);
?>
// Output
<meta name="description" content="enter any meta description here" /> 
```

## 或者

你不必使用上面的函数——但如果你不这样做，你必须小心转义你的变量。考虑一下会发生什么：

```
$description = 'something with a "quote in it'; 
```

如果您只是盲目地回显变量 - 您将创建格式错误的 html 和/或允许注入攻击。因此，如果您逃避`$title`并`$description`适当地使用问题中的代码是完全可以的：

```
<title><?php echo htmlspecialchars($title); ?></title>
....
<meta name="description" content="<?php echo htmlspecialchars($description); ?>"> 
```

# c# - 支持转换为布尔值，但仍使用 ToString 显示 WriteLine

> ID：14080279
> 
> 赞同：5
> 
> 时间：2012-12-29T09:12:53.523
> 
> 标签：c#

当我运行这段代码时，`Equation(10, 20)`输​​出到控制台：

```
public class Equation
{
    public int a;
    public int b;

    public override string ToString()
    { return "Equation(" + a + ", " + b + ")"; }
}

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(new Equation() { a = 10, b = 20 });

        Console.ReadLine();
    }
} 
```

我想支持`Equation`在测试中使用的实例，`if`所以我允许隐式转换为`Boolean`：

```
public class Equation
{
    public int a;
    public int b;

    public override string ToString()
    { return "Equation(" + a + ", " + b + ")"; }

    public static implicit operator Boolean(Equation eq)
    { return eq.a == eq.b; }
}

class Program
{
    static void Main(string[] args)
    {
        if (new Equation() { a = 10, b = 10 })
            Console.WriteLine("equal");

        Console.WriteLine(new Equation() { a = 10, b = 20 });

        Console.ReadLine();
    }
} 
```

但是，问题是，现在当我`WriteLine`在 an 上使用时`Equation`，它会转换为 a`Boolean`而不是使用打印`ToString`。

如何允许隐式转换`Boolean`并仍然使用`WriteLine`显示`ToString`？

* * *

**更新**

这个问题的灵感来自[SymbolicC++](http://issc.uj.ac.za/symbolic/symbolic.html)`Equation`中的类。下面的代码说明了 an可以通过显示以及在 an 的测试中使用：`Equation``cout``if`

```
auto eq = x == y;

cout << eq << endl;

if (eq)
    cout << "equal" << endl;
else
    cout << "not equal" << endl; 
```

所以这在 C++ 中是可能的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T09:17:13.727

你不能，据我所知。您*还可以*提供到字符串的转换......但这会使调用在`WriteLine(string)`和bool 之间`WriteLine(`产生歧义）。

我个人*强烈*建议您放弃隐式转换为`Boolean`. 隐式转换几乎*总是*一个坏主意。它们使代码更加混乱，并导致您发现的意外重载更改。

（我也会改变你的支撑风格，但那是另一回事。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-29T09:20:35.493

这是因为 Console.WriteLine(bool) 重载被调用而不是 Console.WriteLine(object)。您可以显式转换为对象，并且将调用所需的重载：

```
Console.WriteLine((object)(new Equation() { a = 10, b = 20 })); 
```

或者明确地调用 .ToString()：

```
Console.WriteLine((new Equation() { a = 10, b = 20 }).ToString()); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-29T09:22:12.517

你不能通过转换来做到这一点，但`bool`你可以为. 当然不会再隐式转换为，但您仍然可以在、、和语句和条件表达式（即运算符）中使用它。`true``false``Equation``Equation``bool``if``while``do``for``?:`

```
public class Equation
{
    public int a;
    public int b;

    public override string ToString()
    { return "Equation(" + a + ", " + b + ")"; }

    public static bool operator true(Equation eq)
    {
        return eq.a == eq.b;
    }

    public static bool operator false(Equation eq)
    {
        return eq.a != eq.b;
    }       
} 
```

从你的例子：

```
if (new Equation() { a = 10, b = 10 })
    Console.WriteLine("equal"); // prints "equal"

Console.WriteLine(new Equation() { a = 10, b = 20 }); // prints Equation(10, 20) 
```

# jquery - 如何将 JavaScript 库包含到 Spring MVC 项目中（例如 jQuery 或 Dojo）

> ID：14080287
> 
> 赞同：3
> 
> 时间：2012-12-29T09:14:31.293
> 
> 标签：jquery, jsp, spring-mvc, dojo

我在这里阅读了超过 5 个相关主题，但无法回答：分步说明。到目前为止，我拥有 STS Spring MVC 模板结构并尝试`jquery.js`在我的项目中放置某个位置（不幸的是，没有人说它应该在哪里）。所以，请说：

1.  将 jquery.js 放在项目结构中的什么位置？
2.  如何从.jsp 中引用这个位置？
3.  还需要采取什么其他措施吗？像 maven，应用程序配置更改？

我的 jsp 与 .js 完美配合`http://code.jquery.com/jquery-1.8.3.js`，但拒绝与本地文件配合使用`/js/jquery-1.8.3.js`。还有一件奇怪的事情——当 jsp 找不到脚本时，应用服务器会抱怨它，但是当它（已经找到？）库时，没有警告，但 jquery 也不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T09:34:43.193

JavaScript 文件只是浏览器必须下载的资源。所以你把它们放在 webapp 根目录下你想要的地方。

假设您将文件放在`/js/jquery.js`（在您的 Web 项目的 WebContent 目录中）。并假设您的 webapp 具有`/myFirstWebApp`上下文路径。这意味着一旦部署应用程序，webapp 的根目录将位于

```
http://localhost:8080/myFirstWebApp/ 
```

并且您的 JS 文件将因此位于

```
http://localhost:8080/myFirstWebApp/js/jquery.js 
```

要在 webapp 中生成 URL，您通常使用以下`<c:url>`标记：

```
<script src="<c:url value='/js/jquery.js'/>></script> 
```

c:url 标签负责上下文路径：它将它添加到您提供给它的绝对 URL 之前，以便稍后更改上下文路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:31:21.707

对于包含，最好写

```
<script type="text/javascript" src="<c:url value='/js/jquery-1.8.3.min.js'/>"></script> 
```

js 文件夹应放在 WebContent 文件夹下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T19:08:41.067

1.  复制 WebContent 下的 JQuery 库（如 WebContent\jquery\js\jquery-1.9.1.js 有效）

2.  在 JSP 中：

    ```
     <%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
          ...
        <head>
    <spring:url value="/jquery/js/jquery-1.9.1.js" var="jqueryUrl" />
    <script src="${jqueryUrl}"></script>

    <spring:url value="/jquery/js/jquery-ui-1.10.3.custom.js" var="jqueryJsUrl" />
    <script src="${jqueryJsUrl}"></script>
     </head> 
    ```

3.  在 spring-context.xml 添加：

    ```
     <mvc:resources location="/jquery/" mapping="/jquery/**" /></beans> 
    ```

# java - 在 Java EE 应用程序客户端中登录不能正常工作

> ID：14080288
> 
> 赞同：1
> 
> 时间：2012-12-29T09:14:55.647
> 
> 标签：java, swing, jakarta-ee

我正在尝试开发 GlassFish 服务器的 Swing 应用程序客户端。当我尝试获取受容器保护的 EJB 的第一个实例时，我的自定义`CallbackHandler`被调用，我在自定义中引入了我`JDialog`的凭据，如果凭据良好，一切都会正常工作。

问题是，如果我引入了错误的凭据，则不会提示我再次引入它们，每次调用受保护的方法时都会出现安全异常。

我究竟做错了什么？

编辑：代码如下：

```
 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    InitialContext ctx = new InitialContext();
    bean=(JndiEJBRemote)ctx.lookup("java:global/JndiPrueba1/JndiPrueba1-ejb/JndiEJB");
    jTextField1.setText(bean.getUser());

} 
```

简单地说，当按下 JButton 时，会查找 EJB 以返回“业务”值，然后将其分配给 JTextField。我第一次单击该按钮时，会显示自定义 CallbackHandler 以检索用户/密码，但在接下来的单击中，无论凭据是对还是错，都不会调用 CallbackHandler！

# osx-lion - Mac OS 加载 XAMPP 提示密码

> ID：14080291
> 
> 赞同：1
> 
> 时间：2012-12-29T09:15:03.943
> 
> 标签：osx-lion, xampp

我使用的是 Lion 10.8.2，在 sudoers 中我是这样制作的：用户名 ALL=(ALL) NOPASSWD，用户名是我的计算机用户......但现在仍然提示密码.. 怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:16:31.207

如果您在启动服务器时谈论弹出窗口，那么您将无法摆脱它。一个 API（不知道究竟是哪个）用于启动需要管理员权限的 Apache 服务器。终端中的 sudo 和这个 API 调用不同，编辑任何文件都无济于事。

端口 80，Apache 的默认端口是[众所周知的](http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers#Well-known_ports)端口，需要链接中所写的管理员权限。所以他们一定是强行添加了启动服务器的 API 调用。

# r - 如何识别使用 splom 制作的散点图矩阵中的异常值？

> ID：14080296
> 
> 赞同：2
> 
> 时间：2012-12-29T09:16:03.383
> 
> 标签：r, lattice

我有 2001-2009 年印度不同地点的天气变量数据，例如温度、降雨量等。

为了查看这些变量之间的关系，我使用 splom 和以下代码创建了一个散点图矩阵。

```
 library(lattice)
   library(RColorBrewer)
   splom(~aod_corr[c(5,8,11,14)], lower.panel = panel.splom,
  upper.panel = function(x, y, ...) {
      panel.fill(col = brewer.pal(9, "RdBu")[ round(cor(x, y) * 4 + 5)])
      panel.text(mean(x), mean(y), round(cor(x, y),2), font=2)
  },

 scales = list(x = list( draw = TRUE, cex=0.1)), type = c("g", "p", "smooth"),layout =     c(1, 1)) 
```

我现在希望确定每个面板中可以追溯到数据的异常值。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T11:54:36.630

似乎这是该功能的工作`panel.link.splom`。见这里 [http://procomun.wordpress.com/2011/03/18/splomr/](http://procomun.wordpress.com/2011/03/18/splomr/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T16:18:50.790

根据@Karsten 给出的链接，我给你一个与`splom`对象交互的场景：

1.  我的阴谋
2.  我识别面板
3.  我使用链接 splom 选择了一些点
4.  我逃跑以获得结果

细节：

1.  我使用 lattice splom 创建了一个 splom
2.  相互作用：

    ```
    ## I get the focus on the major panel (red color)
    trellis.focus('panel', 1, 1)
    ## I link my panel to the splom
    idx <- panel.link.splom(pch=13, cex=0.6, col='green') 
    ```

3.  我用鼠标选择了一些点。它们将涂成绿色

4.  逃跑以获得焦点

5.  检查结果

    ```
    str(idx)   num [1:5] 111 95 132 96 15 
    ```

# iphone - 网络连接失败时停止下一个进程

> ID：14080300
> 
> 赞同：0
> 
> 时间：2012-12-29T09:16:22.710
> 
> 标签：iphone, xcode, uialertview

我正在从服务 url 获取 xml 响应，并且我想在网络连接失败时显示错误。所以我显示了 UIAlertView，但是在其余过程完成后，这个 alertView 会显示出来。我希望它立即显示。

在android中，如果网络连接失败，它会显示“不幸的是应用程序名称已终止”的错误警报。iPhone有这样的东西吗？如果不是，我想显示 alertview 并停止其余的过程。

这是我正在处理的代码：

```
if (responseData!= NULL)
        {
            response = [[NSString alloc] initWithData:responseData 
                                             encoding:NSUTF8StringEncoding ];
            NSLog(@"Response Code:%d",[urlResponse statusCode]);
            if([urlResponse statusCode ]>=200 && [urlResponse statusCode]<300)
            {
                NSLog(@"Response:%@",response);
            } 
        }
        else
        {
            NSLog(@"Failed to send request: %@", [error localizedDescription]);

              UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Unfornately  stopped.Try Again " message:@"" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
               [alert show];
               [alert release];
        }  

        parser =[[NSXMLParser alloc]initWithData:responseData];
        [parser setDelegate:self];
        [parser setShouldProcessNamespaces:NO];
        [parser setShouldReportNamespacePrefixes:NO];
        [parser setShouldResolveExternalEntities:NO];
        currentHtmlElement=@"1";
        [parser parse];
        [parser release]; 
```

在我的代码中，如果发送请求失败，则打印 NSLog 并执行 alertView 代码。同时我想停止剩下的过程，即初始化解析器并完成剩下的操作。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:33:18.833

非常简单...将您的解析代码移动到`if`块内。

```
 if (responseData!= NULL)
    {
        response = [[NSString alloc] initWithData:responseData 
                                         encoding:NSUTF8StringEncoding ];
        NSLog(@"Response Code:%d",[urlResponse statusCode]);
        if([urlResponse statusCode ]>=200 && [urlResponse statusCode]<300)
        {
            NSLog(@"Response:%@",response);
        }

        parser =[[NSXMLParser alloc]initWithData:responseData];
        [parser setDelegate:self];
        [parser setShouldProcessNamespaces:NO];
        [parser setShouldReportNamespacePrefixes:NO];
        [parser setShouldResolveExternalEntities:NO];
        currentHtmlElement=@"1";
        [parser parse];
        [parser release];
    }
    else
    {
        NSLog(@"Failed to send request: %@", [error localizedDescription]);

          UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Unfornately iCloudBiz has stopped.Try Again " message:@"" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];

           [alert show];
           [alert release];
    } 
```

顺便说一句...您提到您的 Android 应用行为如下

> 在 android 中，如果网络连接失败，它将显示一个错误警报，即不幸的是应用程序名称已终止。

请理解这种行为是一种异常行为。这称为 CRASH，您应该适当地处理它。如果网络断开，应用程序应显示一条消息而不会终止/崩溃:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:44:54.457

您应该使用 Reachability 类来检查互联网连接是否可用这是示例代码，以了解它是如何工作的

```
Reachability *reachability = [Reachability reachabilityForInternetConnection];    
NetworkStatus internetStatus = [reachability currentReachabilityStatus];
if (internetStatus != NotReachable) {
//my web-dependent code
}
else {
//there-is-no-connection warning
} 
```

# hibernate - SEAM + HIBERNATE + jBPM - 您不能在托管事务期间设置自动提交

> ID：14080304
> 
> 赞同：1
> 
> 时间：2012-12-29T09:17:08.750
> 
> 标签：hibernate, seam, jbpm, autocommit

我正在使用hibernate SEAM，现在我开始学习jbpm。但我有这个错误：

```
12:11:47,222 ERROR [SchemaExport] schema export unsuccessful
java.sql.SQLException: You cannot set autocommit during a managed transaction!
            at org.jboss.resource.adapter.jdbc.BaseWrapperManagedConnection.setJdbcAutoCommit(BaseWrapperManagedConnection.java:598)
            at org.jboss.resource.adapter.jdbc.WrappedConnection.setAutoCommit(WrappedConnection.java:458)
            at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:60)
            at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:252) 
```

应该创建一个名为 JBPM_PROCESSDEFINITION 的表，但不创建。

**我的配置文件是：** hibernate.cfg.xml

```
<?xml version='1.0' encoding='utf-8'?>

<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
  <session-factory>

    <property name="show_sql">true</property>
    <property name="connection.datasource">java:/aerisDatasource</property>
    <property name="transaction.factory_class">org.hibernate.transaction.JTATransactionFactory</property>
    <property name="transaction.manager_lookup_class">org.hibernate.transaction.JBossTransactionManagerLookup</property>
    <property name="cache.provider_class">org.hibernate.cache.HashtableCacheProvider</property>
    <property name="hbm2ddl.auto">create-drop</property>
    <!--property name="transaction.flush_before_completion">true</property-->

    <!-- ############################################ -->
    <!-- # mapping files with external dependencies # -->
    <!-- ############################################ -->

    <!-- following mapping file has a dependendy on   -->
    <!-- 'bsh-{version}.jar'.                         -->
    <!-- uncomment this if you don't have bsh on your -->
    <!-- classpath.  you won't be able to use the     -->
    <!-- script element in process definition files   -->
    <mapping resource="org/jbpm/graph/action/Script.hbm.xml"/>

    <!-- following mapping files have a dependendy on  -->
    <!-- 'jbpm-identity.jar', mapping files            -->
    <!-- of the pluggable jbpm identity component.     -->
    <!-- Uncomment the following 3 lines if you        -->
    <!-- want to use the jBPM identity mgmgt           -->
    <!-- component.                                    -->
    <!-- identity mappings (begin) ===
    <mapping resource="org/jbpm/identity/User.hbm.xml"/>
    <mapping resource="org/jbpm/identity/Group.hbm.xml"/>
    <mapping resource="org/jbpm/identity/Membership.hbm.xml"/>
    ==== identity mappings (end) -->

    <!-- following mapping files have a dependendy on  -->
    <!-- the JCR API                                   -->
    <!-- jcr mappings (begin) ===
    <mapping resource="org/jbpm/context/exe/variableinstance/JcrNodeInstance.hbm.xml"/>
    ==== jcr mappings (end) -->

    <!-- ###################### -->
    <!-- # jbpm mapping files # -->
    <!-- ###################### -->

    <!-- hql queries and type defs -->
    <mapping resource="org/jbpm/db/hibernate.queries.hbm.xml" />

    <!-- graph.action mapping files -->
    <mapping resource="org/jbpm/graph/action/MailAction.hbm.xml"/>

    <!-- graph.def mapping files -->
    <mapping resource="org/jbpm/graph/def/ProcessDefinition.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/Node.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/Transition.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/Event.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/Action.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/SuperState.hbm.xml"/>
    <mapping resource="org/jbpm/graph/def/ExceptionHandler.hbm.xml"/>
    <mapping resource="org/jbpm/instantiation/Delegation.hbm.xml"/>

    <!-- graph.node mapping files -->
    <mapping resource="org/jbpm/graph/node/StartState.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/EndState.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/ProcessState.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/Decision.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/Fork.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/Join.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/MailNode.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/State.hbm.xml"/>
    <mapping resource="org/jbpm/graph/node/TaskNode.hbm.xml"/>

    <!-- context.def mapping files -->
    <mapping resource="org/jbpm/context/def/ContextDefinition.hbm.xml"/>
    <mapping resource="org/jbpm/context/def/VariableAccess.hbm.xml"/>

    <!-- taskmgmt.def mapping files -->
    <mapping resource="org/jbpm/taskmgmt/def/TaskMgmtDefinition.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/def/Swimlane.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/def/Task.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/def/TaskController.hbm.xml"/>

    <!-- module.def mapping files -->
    <mapping resource="org/jbpm/module/def/ModuleDefinition.hbm.xml"/>

    <!-- bytes mapping files -->
    <mapping resource="org/jbpm/bytes/ByteArray.hbm.xml"/>

    <!-- file.def mapping files -->
    <mapping resource="org/jbpm/file/def/FileDefinition.hbm.xml"/>

    <!-- scheduler.def mapping files -->
    <mapping resource="org/jbpm/scheduler/def/CreateTimerAction.hbm.xml"/>
    <mapping resource="org/jbpm/scheduler/def/CancelTimerAction.hbm.xml"/>

    <!-- graph.exe mapping files -->
    <mapping resource="org/jbpm/graph/exe/Comment.hbm.xml"/>
    <mapping resource="org/jbpm/graph/exe/ProcessInstance.hbm.xml"/>
    <mapping resource="org/jbpm/graph/exe/Token.hbm.xml"/>
    <mapping resource="org/jbpm/graph/exe/RuntimeAction.hbm.xml"/>

    <!-- module.exe mapping files -->
    <mapping resource="org/jbpm/module/exe/ModuleInstance.hbm.xml"/>

    <!-- context.exe mapping files -->
    <mapping resource="org/jbpm/context/exe/ContextInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/TokenVariableMap.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/VariableInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/ByteArrayInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/DateInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/DoubleInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/HibernateLongInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/HibernateStringInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/LongInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/NullInstance.hbm.xml"/>
    <mapping resource="org/jbpm/context/exe/variableinstance/StringInstance.hbm.xml"/>

    <!-- job mapping files -->
    <mapping resource="org/jbpm/job/Job.hbm.xml"/>
    <mapping resource="org/jbpm/job/Timer.hbm.xml"/>
    <mapping resource="org/jbpm/job/ExecuteNodeJob.hbm.xml"/>
    <mapping resource="org/jbpm/job/ExecuteActionJob.hbm.xml"/>

    <!-- taskmgmt.exe mapping files -->
    <mapping resource="org/jbpm/taskmgmt/exe/TaskMgmtInstance.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/exe/TaskInstance.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/exe/PooledActor.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/exe/SwimlaneInstance.hbm.xml"/>

    <!-- logging mapping files -->
    <mapping resource="org/jbpm/logging/log/ProcessLog.hbm.xml"/>
    <mapping resource="org/jbpm/logging/log/MessageLog.hbm.xml"/>
    <mapping resource="org/jbpm/logging/log/CompositeLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/ActionLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/NodeLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/ProcessInstanceCreateLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/ProcessInstanceEndLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/ProcessStateLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/SignalLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/TokenCreateLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/TokenEndLog.hbm.xml"/>
    <mapping resource="org/jbpm/graph/log/TransitionLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/VariableLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/VariableCreateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/VariableDeleteLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/VariableUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/ByteArrayUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/DateUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/DoubleUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/HibernateLongUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/HibernateStringUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/LongUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/context/log/variableinstance/StringUpdateLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/TaskLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/TaskCreateLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/TaskAssignLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/TaskEndLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/SwimlaneLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/SwimlaneCreateLog.hbm.xml"/>
    <mapping resource="org/jbpm/taskmgmt/log/SwimlaneAssignLog.hbm.xml"/>

  </session-factory>
</hibernate-configuration> 
```

jbpm.cfg.xml

```
<jbpm-configuration>
  <jbpm-context>
    <service name="persistence">
       <factory>
          <bean class="org.jbpm.persistence.db.DbPersistenceServiceFactory">
             <field name="isTransactionEnabled"><false/></field>
          </bean>
       </factory>
    </service>
    <service name="tx" factory="org.jbpm.tx.TxServiceFactory" />
    <service name="message" factory="org.jbpm.msg.db.DbMessageServiceFactory" />
    <service name="scheduler" factory="org.jbpm.scheduler.db.DbSchedulerServiceFactory" />
    <service name="logging" factory="org.jbpm.logging.db.DbLoggingServiceFactory" />
    <service name="authentication" factory="org.jbpm.security.authentication.DefaultAuthenticationServiceFactory" />
  </jbpm-context>
</jbpm-configuration> 
```

谢谢

# shell - 删除 CR 线路终结器

> ID：14080306
> 
> 赞同：6
> 
> 时间：2012-12-29T09:17:19.380
> 
> 标签：shell, unix, newline, dos

首先我会说我已经阅读[了这篇文章](https://stackoverflow.com/questions/313178/whats-the-best-way-of-doing-dos2unix-on-a-500k-line-file-in-windows)，但是我仍然对`CR line terminators`.

有一个名为 的文件`build_test.sh`，我在其中进行了编辑，`leafpad`它可以直接显示在`Vim`：

```
cp ~/moonbox/llvm-2.9/lib/Transforms/MY_TOOL/$1 test.cpp 
cd ~/moonbox/llvm-obj/tools/TEST_TOOL/
make
make install
cd - 
```

然而：

1.  使用它*什么也没*`cat build_test.sh`输出。
**   使用`more build_test.sh`它输出：`cd - install/llvm-obj/tools/TEST_TOOL/Y_TOOL/$1 test.cpp`*   使用`less build_test.sh`它输出：`cp ~/moonbox/llvm-2.9/lib/Transforms/MY_TOOL/$1 test.cpp^Mcd ~/moonbox/llvm-obj/tools/TEST_TOOL/^Mmake^Mmake install^Mcd -`*

 *结果`file build_test.sh`是：

```
build_test.sh: ASCII text, with CR line terminators 
```

在[这篇文章之后](https://stackoverflow.com/questions/313178/whats-the-best-way-of-doing-dos2unix-on-a-500k-line-file-in-windows/313196#313196)，`^M`不再存在但是没有更多的换行符:-(现在
的结果`file build_test_no_cr.sh`是：

```
build_test_nocr.sh: ASCII text, with no line terminators 
```

解决方案可以在[这里](https://stackoverflow.com/questions/14080306/remove-cr-line-terminators/14080764#14080764)看到。

**但是我仍然想知道为什么`cat`什么都不显示并且`more`显示如此奇怪的结果。此外，为什么`dos2unix`和`set fileformat=unix`在 Vim 中失败**了这种情况。

ps：我想也许我的编辑器（*Vim*或*Leafpad*？）只生成换行符。怎么会这样？`\r``\n`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T09:19:27.340

换行符的简单`\r`终止符是“旧 Mac”行终止符，奇怪的是 2012+ 中的编辑器甚至生成带有这种行终止符的文件......无论如何，您可以使用该`mac2unix`命令，它是`dos2unix`分发的一部分：

```
# Edits thefile inline
mac2unix thefile
# Takes origfile as an input, outputs to dstfile
mac2unix -n origfile dstfile 
```

此命令不会删除已经预期行终止符的文件，这是一个奖励。反之（`unix2mac`）也存在。

请注意，`mac2unix`与 相同`dos2unix -c mac`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-29T09:38:10.940

此外，如果您使用 vim，您可以通过执行

```
:set fileformat=unix
:w 
```

或者只是添加

```
set fileformat=unix 
```

到你的 .vimrc 文件

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-29T10:26:05.207

我终于想通了，我可以使用这个命令：

```
tr '^M' '\n' <build_test.sh >build_test_nocr.sh 
```

where`^M`是通过按`Ctrl+v`和`Enter`键添加的。或者，这具有相同的效果：

```
tr '\r' '\n' <build_test.sh >build_test_nocr.sh 
```*

# php - 将带有其他文件的图像上传到数据库

> ID：14080307
> 
> 赞同：-2
> 
> 时间：2012-12-29T09:17:25.490
> 
> 标签：php, field, image-uploading

我想将我的值存储到 db。我也想上传一张图片。我的插入查询如下。它不工作。

```
$query = mysql_query("insert into designingoption set name='$name1',positionCode='$pos',assetType='$ass',price='$price',createdOn='$createdon',lastModifiedOn='$laston',lastModifiedBy='$lastby')",$con); 
```

这里 name=$name 是我的图片上传字段..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:19:23.007

您混合了`UPDATE`and`INSERT`语句的语法。

正确的语法：

```
INSERT INTO designingoption ('name', 'positionCode', 'assetType', 'price', 'createdOn', 'lastModifiedOn', 'lastModifiedBy') VALUES ($pos, $ass, $price, $createdon, $laston, $lastby) 
```

当您使用它时，您可能还想考虑切换到 mysqli 函数。不推荐使用 mysql 函数。

还要小心 SQL 注入。可以在[此处](https://stackoverflow.com/questions/5414731/are-mysql-real-escape-string-and-mysql-escape-string-sufficient-for-app-secu)找到有关该主题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:21:29.927

更新您的查询结构。

```
INSERT INTO designingoption (name,positionCode,assetType,price,createdOn,lastModifiedOn,lastModifiedBy) VALUES ('$name1','$pos','$ass','$price','$createdon','$laston','$lastby') 
```

此外，请确保所有变量都已填充，否则您会收到 PHP 通知。用 ` 将表行括起来不会有什么坏处，如下所示：

```
INSERT INTO `designingoption` (`name`,`positionCode`,`assetType`,`price`,`createdOn`,`lastModifiedOn`,`lastModifiedBy`) VALUES ('$name1','$pos','$ass','$price','$createdon','$laston','$lastby') 
```

有些字是系统保留的，必须正确使用，否则只会报错。

一项小研究表明（甚至令我惊讶）您的语法是正确的。 [http://dev.mysql.com/doc/refman/5.5/en/insert.html](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

你能用你得到的确切错误编辑你的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:22:21.853

不知道什么不起作用，但是，我有一个很好的主意，因为您在 $variables 周围使用了 ' （单引号），所以没有插入这些值。

像这样试试。

```
 $query=mysql_query("insert into designingoption set name='".$name1."',positionCode='".$pos."',assetType='".$ass."',price='".$price."',createdOn='".$createdon."',lastModifiedOn='".$laston."',lastModifiedBy='".$lastby."')",$con); 
```

# xml - 我正在使用 Jena 导入 skos 词库，但它不起作用

> ID：14080308
> 
> 赞同：0
> 
> 时间：2012-12-29T09:17:38.967
> 
> 标签：xml, rdf, jena

> **可能重复：**
> [org.xml.sax.SAXParseException：prolog 中不允许内容](https://stackoverflow.com/questions/5138696/org-xml-sax-saxparseexception-content-is-not-allowed-in-prolog)

我想在 Jena 模型中导入一个 skos (rdf/xml) 词库。skos 词库可在[http://www.culturaitalia.it/pico/thesaurus/4.2/thesaurus_4.2.0.skos.xml](http://www.culturaitalia.it/pico/thesaurus/4.2/thesaurus_4.2.0.skos.xml)中找到。我将其复制到本地文件（在 picoFileName 中），并使用此代码将其导入模型中：

```
 ...
    pico = ModelFactory.createDefaultModel();
    InputStream in = FileManager.get().open(picoFileName);
    if (in == null) {
        throw new IllegalArgumentException( "File: " + picoFileName + " not found");
    }
    pico.read(new InputStreamReader(in), "");
    ... 
```

我收到此错误：

```
Exception in thread "main" com.hp.hpl.jena.shared.JenaException:   org.xml.sax.SAXParseException: Content is not allowed in prolog.
at com.hp.hpl.jena.rdf.model.impl.RDFDefaultErrorHandler.fatalError(RDFDefaultErrorHandler.java:60)
at com.hp.hpl.jena.rdf.arp.impl.ARPSaxErrorHandler.fatalError(ARPSaxErrorHandler.java:51)
at com.hp.hpl.jena.rdf.arp.impl.XMLHandler.warning(XMLHandler.java:211)
at com.hp.hpl.jena.rdf.arp.impl.XMLHandler.fatalError(XMLHandler.java:241)
at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)
at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
at org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)
at org.apache.xerces.impl.XMLDocumentScannerImpl$PrologDispatcher.dispatch(Unknown Source)
at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)
at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)
at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
at com.hp.hpl.jena.rdf.arp.impl.RDFXMLParser.parse(RDFXMLParser.java:155)
at com.hp.hpl.jena.rdf.arp.JenaReader.read(JenaReader.java:173)
at com.hp.hpl.jena.rdf.arp.JenaReader.read(JenaReader.java:160)
at com.hp.hpl.jena.rdf.arp.JenaReader.read(JenaReader.java:199)
at com.hp.hpl.jena.rdf.model.impl.ModelCom.read(ModelCom.java:229)
at it.etc.rdf.LodWithPico.<init>(LodWithPico.java:24)
at it.etc.rdf.TestLodWithPico.main(TestLodWithPico.java:6)
    Caused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.
at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
... 18 more 
```

skos 词库在 w3c rdf/xml 验证器和 skos 验证器中进行验证。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:47:41.597

“picoFileName”到底是什么？如果我对下载的内容调用解析器，对我有用。这是哪个版本的耶拿？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:45:32.250

抱歉，输入文件有问题。我将文件内容复制到另一个文件中，它可以工作。

# php - 无法在 PHP 页面之间传递正确的值

> ID：14080320
> 
> 赞同：1
> 
> 时间：2012-12-29T09:19:34.430
> 
> 标签：php

如果我的问题看起来很愚蠢，但我没有解释。我正在尝试建立一个包含一些新闻的页面。我有具有诸如 News_id、news_header、新闻正文等属性的数据库。

我有 2 页第一页给出了新闻的简要描述列表，按钮允许用户阅读更多特定新闻。如果点击它会将相应的 news_id 值传递给获取 News_Id 值的页面 2，从数据库值中查询相应的值并输出内容。

问题是，无论我点击page 1列表中的哪个按钮看新闻，page 2总是收到新闻的news_id值，即**在** e中排在*前。这是代码

**第一页（列表）**

```
<form name='NewsLineSelection' method='post' action='news.php'>
<?php
 $News_Query = "Select * from news order by Date_Posted Desc;";
 $GetNews = mysql_query( $News_Query, $IVE_Connection ) or die("ERROR: ".mysql_error());

while ( $News_Database = mysql_fetch_array( $GetNews ) ){                   
?>
<tr><td ><?php echo $News_Database[1]; ?></td>//header
<tr><td ><?php echo $News_Database[2]; ?></td>//news body
...etc

<tr><td class="maintext">
<input type='hidden' name='NewsToRead' value='<?php echo $News_Database[0]; ?>'>//News_ID is here
<input type='submit' name='AddNews' value='Read More...' >
</td></tr>
 }//end of the loop 
```

**第 2 页（含信息详情）**

```
$News_id = addslashes($_POST['NewsToRead']);

$News_Query = "Select * from news where news_id = ".$News_id.";";
$GetNews = mysql_query( $News_Query, $Connection ) or die("ERROR: ".mysql_error());
$News_Database = mysql_fetch_row( $GetNews );

//Then output the query's content 
```

它在纸上看起来很完美。但是我真的不明白为什么例如第1页的列表中有10条新闻，无论我点击哪个按钮，第2页中$News_id的值总是列表中第一个新闻的id第 1 页。

可能我什么都没看到。它应该可以正常工作，但事实并非如此。

感谢您提供任何帮助或建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T09:29:41.150

那是因为您有多个具有相同名称的输入。你看错了问题。

您正在获取（获取）数据，您应该使用 GET 请求，而不是 POST 请求。

我的建议是，每个新闻标题都将包含在这样的链接中：

```
<h1>
    <a href="news.php?id=<?php //Code to output the correct ID here ?>"><?php //Code to output the correct headline here ?>
    </a>
</h1> 
```

## 一些额外的东西

*   不要使用表格来布置页面！表格用于表格数据。使用正确的语义元素：（`<h1>`对于重要的标题、`<h2>`不太重要的标题、`<p>`段落等）。
*   [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](http://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# ado.net - SqlBulkCopy 处理 ado.net 中的批量大小

> ID：14080321
> 
> 赞同：0
> 
> 时间：2012-12-29T09:19:46.403
> 
> 标签：ado.net, sqlbulkcopy

我有以下代码使用 ADO.NET 中的 SqlBulkCopy 类在数据库中输入一些数据

```
using (SqlBulkCopy bulkCopy = new SqlBulkCopy(DCISParameters.ConnectionString))
        {
            bulkCopy.DestinationTableName = "tbzErgoAnalytical";
            bulkCopy.BatchSize = 250;
            bulkCopy.ColumnMappings.Add("Column1", "fldESPA");
            bulkCopy.ColumnMappings.Add("Column2", "fldEP");
            bulkCopy.ColumnMappings.Add("Column13", "fldMISCode");
            bulkCopy.WriteToServer(dbTable);
            bulkCopy.SqlRowsCopied += bulkCopy_SqlRowsCopied;
        } 
```

dbTable 是一个 DataTable 对象，它作为方法的参数传递，它包含我从 excel 文件中获取的 7691 行。我已将批处理大小设置为 250。问题是 7500 (250 * 30) 行已正确传输到数据库，但随后我收到以下错误：“列‘fldMISCode’不允许 DBNull.Value。” 我 100% 确定 fldMISCode 中没有空值，我想在最后一次插入中我只剩下 191 行，这小于批量大小（不确定我的假设是否正确）。知道如何处理这个错误吗？提前致谢...

# c++ - C++，基于值输入从二维数组中选择

> ID：14080323
> 
> 赞同：3
> 
> 时间：2012-12-29T09:20:49.140
> 
> 标签：c++, arrays, select, netflow

我`softflowd+nfdump`用来创建 netflow 数据并将这些数据存储在二维（字符串）数组中

```
flows = new string *[flows_len];
for (int i=0;i<flows_len;i++)
{
    flows[i] = new string[47];
} 
```

我正在用 C++ 编写。数组中的每一“行”代表一个流记录，47 是 nfdump 显示的 netflow 数据不同字段的数量。

我想在每个 IP 的基础上创建一些统计信息（例如，每个 IP 有多少连接流），但我不知道如何获得具有相同 IP 的那些行流（存储 srcip 的值在流[j][4] 中，我是 C++ 新手）。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:50:47.513

这是一个非常非常非常简单的例子

```
#include <vector>
#include <string>
#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include <algorithm>
#include <iterator>

using namespace std;

typedef vector< string > StatInfo; // 47 enries

void print_stat_by_ip( const vector< StatInfo > & infos, const string & ip ) {
    for ( int i = 0, count = infos.size(); i < count; i++ ) {
        const StatInfo & info = infos[ i ];
        if ( info[ 4 ] == ip ) {
            copy( info.begin(), info.end(), ostream_iterator< string >( cout, ", " ) );
            cout << endl;
        }
    }
}

int main()
{
    vector< StatInfo > infos;

    for ( int i = 0; i < 10; i++ ) {
        StatInfo info;
        for ( int j = 0; j < 47; j++ ) { // just filling them "0", "1", "2", ... , "46"
            char c_str[ 42 ];
            sprintf( c_str, "%d", j ); 
            info.push_back( c_str );
        }
        char c_str[ 42 ];
        sprintf( c_str, "%d", rand() % 10 );
        info[ 4 ] = c_str;          // this will be an IP-address
        infos.push_back( info );

        copy( info.begin(), info.end(), ostream_iterator< string >( cout, ", " ) );
        cout << endl;
    }

    string ip_to_find = "5";
    cout << "----------------------------------------" << endl;
    cout << "stat for " << ip_to_find << endl;
    cout << "----------------------------------------" << endl;
    print_stat_by_ip( infos, ip_to_find );
} 
```

你可以在这里找到它 [http://liveworkspace.org/code/3AAye8](http://liveworkspace.org/code/3AAye8)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:40:35.013

老实说，我会考虑重新考虑您的容器。以下使用标准库数组、向量和多图来完成我认为您正在寻找的内容。示例代码仅使用字符串“A”、“B”或“C”以及三个 IP 地址之一填充表行。您应该特别注意的部分是使用 multimap 根据 IP 地址索引您的表（尽管它可以很容易地改装为对任意列执行相同的操作）。

注意：有*很多*人比我更精通 std lib 算法、函数和容器的使用。这只是为了让您了解多映射如何帮助您解决可能的解决方案。

**编辑**OP 想查看表中 IP 地址的计数，此代码已修改到`main()`函数的尾部。还更新为不使用 C++11 功能。希望更接近 OP 可以使用的东西。

```
#include <iostream>
#include <iterator>
#include <algorithm>
#include <functional>
#include <map>
#include <vector>
#include <string>
using namespace std;

// some simple decls for our info, table, and IP mapping.
typedef std::vector<std::string> FlowInfo;
typedef std::vector<FlowInfo> FlowTable;

// a multi-map will likely work for what you want.
typedef std::multimap<std::string, const FlowInfo* > MapIPToTableIndex;

// a map of IP string-to-unsigned int for counting occurrences.
typedef std::map<std::string, unsigned int> MapStringToCount;

int main(int argc, char *argv[])
{
    // populate your flow table using whatever method you choose.
    //  I'm just going to push 10 rows of three ip addresses each.
    FlowTable ft;
    for (size_t i=0;i<10;++i)
    {
        FlowInfo fi(47); // note: always fixed at 47.

        for (size_t j=0;j<fi.size();++j)
            fi[j] = "A";
        fi[0][0]+=i;
        fi[4] = "192.168.1.1";
        ft.push_back(fi);

        for (size_t j=0;j<fi.size();++j)
            fi[j] = "B";
        fi[0][0]+=i;
        fi[4] = "192.168.1.2";
        ft.push_back(fi);

        for (size_t j=0;j<fi.size();++j)
            fi[j] = "C";
        fi[0][0]+=i;
        fi[4] = "192.168.1.3";
        ft.push_back(fi);
    }

    // map by IP address into something usefull.
    MapIPToTableIndex infomap;
    for (FlowTable::const_iterator it = ft.begin(); it != ft.end(); ++it)
        infomap.insert(MapIPToTableIndex::value_type((*it)[4], &*it));

    // prove the map is setup properly. ask for all items in the map
    //  that honor the 192.168.1.2 address.
    for (MapIPToTableIndex::const_iterator it = infomap.lower_bound("192.168.1.2");
         it != infomap.upper_bound("192.168.1.2"); ++it)
    {
        std::copy(it->second->begin(), it->second->end(),
                  ostream_iterator<std::string>(cout, " "));
        cout << endl;
    }

    // mine the IP occurance rate from the table:
    MapStringToCount ip_counts;
    for (FlowTable::const_iterator it= ft.begin(); it!=ft.end(); ++it)
        ++ip_counts[ (*it)[4] ];

    // dump IPs by occurrence counts.
    for (MapStringToCount::const_iterator it = ip_counts.begin();
         it != ip_counts.end(); ++it)
    {
        cout << it->first << " : " << it->second << endl;
    }

    return 0;
} 
```

**输出**

```
B B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
C B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
D B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
E B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
F B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
G B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
H B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
I B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
J B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
K B B B 192.168.1.2 B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B B 
192.168.1.1 : 10
192.168.1.2 : 10
192.168.1.3 : 10 
```

# jquery - 在 ASP.NET MVC 4 网站的客户端读取 XML

> ID：14080324
> 
> 赞同：0
> 
> 时间：2012-12-29T09:20:54.603
> 
> 标签：jquery, xml, asp.net-mvc, client-side

我在一个 ASP.NET 网站上工作，我需要从**外部**url 获取 XML。它使用 ASP.NET MVC 效果很好，`XmlDocument`但现在我需要解析 XML 而无需再次访问服务器，因此是客户端。我想做的一个例子：

假设我们有 3 个`<select>`下拉列表，第一个包含所有汽车制造商，第二个包含所有汽车型号，第三个包含所有类型。因此，当页面加载时，我们有第一个包含所有汽车制造商的下拉菜单，而其他两个被禁用。当我选择一个品牌时，我想加载**所选品牌**的所有模型（下拉菜单 3 仍然禁用）。然后当我选择汽车模型时，我想加载**所选模型的**所有类型。

所有品牌都可以由 ASP.NET 加载，`XmlDocument`它已经可以正常工作，但其他数据需要在客户端解析。我用jQuery试过这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR...nsitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                $.ajax({
                    type: "GET",
                    url: "-- hidden --",
                    dataType: "xml",
                    success: parseXml
                });

                function parseXml(xml){
                    $(xml).find("Make").each(function(){
                        $("#output").append($(this).find("carmake").text() + "<br />");
                    });
                }
            });
        </script>
    </head>
    <body>
        <div id="output"></div>
    </body>
</html> 
```

但这不起作用。我读了很多关于使用 sulution 的问题，`crossDomain: true`但这`dataType: jsonp`也不起作用。我还阅读了我从需要支持中获取 XML 的服务器`jsonp`，但是我无法对此做些什么，因为它不是我的服务器，而是一个 Web 服务。

您可能已经看到，获取所有品牌的示例网址是`-- hidden --/make.alx`. 然后当用户选择一个品牌时，我可以通过在 url 中发送 carcode 来获取该品牌的型号，例如：`-- hidden --/model.alx?carcode=2`

所以简而言之，问题是：如果可能的话，我怎样才能让这个工作与 jQuery 一起工作，如果没有，我怎样才能让这个工作以另一种方式工作？我有一个很好的方法可以使用 ASP.NET MVC 做到这一点，但无需重新加载整个页面？

[这个](http://www.autoweek.nl/)网站是我想要的一个很好的例子。正如您在标题下方看到的那样，您可以选择汽车品牌、型号和类型。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:30:07.933

不能通过 jQuery，但您可以在您的网站中为此创建一个代理页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T12:51:11.133

好的，对于那些也在为此苦苦挣扎的人，这就是我解决这个问题的方法，感谢@GovindKamalaPrakashMalviya。他把我推向了正确的方向，我搜索了一段时间，最后发现它必须通过`JSON`搜索如何去做，最后通过[这个](http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx)网站让它工作。效果很好！谢谢戈文德！

# android - ListFragment onItemClickListener 不起作用

> ID：14080332
> 
> 赞同：15
> 
> 时间：2012-12-29T09:22:09.203
> 
> 标签：android, android-listfragment

我正在使用选项卡式布局（带滑动）。在这里，我有 3 个由 SectionsPagerAdapter 控制的选项卡。每个选项卡都是一个 ListFragment。

现在我想在单击列表中的一项时触发一个事件。我想为每个选项卡设置一个监听器。

这是现在的代码（不工作，没有触发事件）。

```
public class NyhederFragment extends ListFragment {
     public static final String ARG_SECTION_NUMBER = "section_number";
     private static final String TAG="NyhederFragment";
     private List<Item> newsItems;
     private ArrayList newsHeadlines;
     private ArrayAdapter adapter;
     private BroadcastReceiver updateReciever;

public NyhederFragment() {
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    ListView newsList = new ListView(getActivity());
    newsList.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT));
    newsList.setId(R.id.list);
    DatabaseHelper dbConn = new DatabaseHelper(getActivity());

    newsItems = dbConn.getAllItemsFromNews();
    newsHeadlines = new ArrayList();
    for(Item i : newsItems){
        newsHeadlines.add(i.getTitle());
    }

    adapter = new ArrayAdapter(getActivity(), android.R.layout.simple_list_item_1, newsHeadlines);

    setListAdapter(adapter);

    newsList.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                  int position, long id) {
            Log.i("debug", "single click");
        }
    });

    dbConn.close();

    getActivity().registerReceiver(updateReciever, new IntentFilter("ArticlesUpdated"));
    return newsList;
}
} 
```

怎么回事，我做错了吗？

提前非常感谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-29T09:34:28.730

如果您正在使用，`ListFragment`那么您可以简单地使用它的覆盖方法`onListItemClick()`

```
@Override
    public void onListItemClick(ListView l, View v, int position, long id) {
        // TODO Auto-generated method stub
        super.onListItemClick(l, v, position, id);
    } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-27T06:53:52.407

这是由于自定义列表项。默认焦点是自定义列表项（按钮/文本视图）。它导致了这个问题。

请添加`android:descendantFocusability="blocksDescendants"`列表元素的根布局。希望这会对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:25:08.190

更改`setListAdapter(adapter);`为`newsList.setAdapter(adapter);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-24T12:52:13.463

If you wanted to create or re-use or an existing handler that implements `AdapterView.OnItemClickListener`, rather than implementing `onListItemClick()` within the `ListFragment`, you can do so by getting a reference to the `ListView` of the `ListFragment` and setting its listener. In your `ListFragment.onResume()` you could do:

```
@Override
public void onResume() {
    super.onResume();
    ListView listView = getListView();
    listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            Log.d("TAG", "Stop touching me");
        }
    });
} 
```

In my case, I can use the same listener from an `Activity` with a `ListView`, a `ListActivity` or a `ListFragment`, e.g.

`listView.setOnItemClickListener(new MyListViewOnClickListener(getActivity()));`

# android - 为什么网络服务不能手动工作？

> ID：14080334
> 
> 赞同：0
> 
> 时间：2012-12-29T09:22:16.557
> 
> 标签：android, web-services, soap

我有不止一种方法的网络服务。我使用 firefox soaclient 插件来测试它们。所有方法都可以正常工作。直到现在这些都是正常的。我在 android 上编写了用于调用这些 .net 网络服务的库。我有方法，第一个准备信封，另一个调用方法。除一种方法外，所有方法都适用于这些方法。我从我的库中为不起作用的方法准备了信封，并在 Firefox 肥皂客户端上使用了这个信封，它以正确的方式返回我的响应。我自己调用网络服务的方法没有错，只是返回空结果。可能是什么错误？

![在此处输入图像描述](../Images/0c78fd5b7ed07e690a73af20e4d05825.png)

```
private void createEnvelope() {
    // Her bir parametrenin kalıbı
    String params = "<%s>%s</%s>";
    // Her parametre kalıbına değer atandığında geçici olarak tutulan string
    String paramsTemp = "";
    // Hazırlanan tüm parametrelerin tutulduğu değişken
    String paramsAll = "";

    // Parametreler ekleniyor
    for (int i = 0; i < parameterKeys.size(); i++) {
        paramsTemp = String.format(params, parameterKeys.get(i),
                parameterValues.get(i), parameterKeys.get(i));
        paramsAll += paramsTemp;
    }

    // soap mesajını hazılıyoruz
    String soapTemplate = "<?xml version=\"%s\" encoding=\"%s\"?>"
            + "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">"
            + "<soap:Body>" + "<%s xmlns=\"%s\">" + "%s" + "</%s>"
            + "</soap:Body>" + "</soap:Envelope>";
    envelope = String.format(soapTemplate, version, charEncoding,
            methodName, namespace, paramsAll, methodName);
    Logger.log("request:" + envelope);
}

public String callWebService() {

    createEnvelope();
    // request parameters
    HttpParams params = httpClient.getParams();
    HttpConnectionParams.setConnectionTimeout(params, connectionTimeOut);
    HttpConnectionParams.setSoTimeout(params, soTimeOut);

    // set parameter
    HttpProtocolParams.setUseExpectContinue(httpClient.getParams(), true);

    // POST the envelope
    HttpPost httppost = new HttpPost(url);

    // add headers
    httppost.setHeader("SOAPAction", soapAction);
    httppost.setHeader("Content-Type", contentType);

    try {

        // the entity holds the request
        HttpEntity entity = new StringEntity(envelope);
        httppost.setEntity(entity);

        // Response handler
        ResponseHandler<String> rh = new ResponseHandler<String>() {
            // invoked when client receives response
            public String handleResponse(HttpResponse responseTemp)
                    throws ClientProtocolException, IOException {

                // get response entity
                HttpEntity entity = responseTemp.getEntity();
                StatusLine statusLine = responseTemp.getStatusLine();

                // read the response as byte array
                StringBuffer out = new StringBuffer();
                byte[] b = EntityUtils.toByteArray(entity);

                // write the response byte array to a string buffer
                out.append(new String(b, 0, b.length));
                return out.toString();
            }
        };

        response = httpClient.execute(httppost, rh);

    } catch (Exception e) {
        Log.v("Soap Service Exception:", e.toString());
    }

    // close the connection
    httpClient.getConnectionManager().shutdown();
    return response;
} 
```

编辑

logcat 上的请求模板：

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <soap:Body>
      <Method_Name xmlns="url">
         <param1>12345</param1>
         <param2>ügıtç</param2>
         <param3>qwert</param3>
      </Method_Name>
   </soap:Body>
</soap:Envelope> 
```

logcat 上的响应模板

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <soap:Body>
      <Method_Name_Response xmlns="url">
         <Method_Name_Result>
            <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" id="NewDataSet">
               <xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:UseCurrentLocale="true">
                  <xs:complexType>
                     <xs:choice minOccurs="0" maxOccurs="unbounded">
                        <xs:element name="Temp">
                           <xs:complexType>
                              <xs:sequence>
                                 <xs:element name="response1" type="xs:long" minOccurs="0" />
                                 <xs:element name="response2" type="xs:string" minOccurs="0" />
                              </xs:sequence>
                           </xs:complexType>
                        </xs:element>
                     </xs:choice>
                  </xs:complexType>
               </xs:element>
            </xs:schema>
            <diffgr:diffgram xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" />
         </Method_Name_Result>
      </Method_Name_Response>
   </soap:Body>
</soap:Envelope> 
```

具有相同信封的Firefox插件上的响应模板

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <soap:Body>
      <Method_Name_Response xmlns="url">
         <Method_Name_Result>
            <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" id="NewDataSet">
               <xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:UseCurrentLocale="true">
                  <xs:complexType>
                     <xs:choice minOccurs="0" maxOccurs="unbounded">
                        <xs:element name="Temp">
                           <xs:complexType>
                              <xs:sequence>
                                 <xs:element name="response1" type="xs:long" minOccurs="0" />
                                 <xs:element name="response2" type="xs:string" minOccurs="0" />
                              </xs:sequence>
                           </xs:complexType>
                        </xs:element>
                     </xs:choice>
                  </xs:complexType>
               </xs:element>
            </xs:schema>
            <diffgr:diffgram xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
               <NewDataSet xmlns="">
                  <Temp diffgr:id="Temp1" msdata:rowOrder="0">
                     <response1>123456789</response1>
                     <response2>Android</response2>
                  </Temp>
               </NewDataSet>
            </diffgr:diffgram>
          </Method_Name_Result>
      </Method_Name_Response>
   </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T11:21:14.710

我发现了我的问题，土耳其字符导致错误。当我使用“ü”时会导致错误，当我不使用它时，它会完美运行。

# unobtrusive-validation - MVC 4 应用程序中的 Jquery 令牌输入和不显眼的验证

> ID：14080340
> 
> 赞同：0
> 
> 时间：2012-12-29T09:23:09.280
> 
> 标签：unobtrusive-validation, jquery-tokeninput

我被困在这里，非常感谢帮助。我在剃刀视图中有一个表单，其中包含当前城市的输入字段，如下所示：

```
@Html.LabelFor(x => x.UserModel.CurrentCity)
@Html.TextBoxFor(x => x.UserModel.CurrentCity, new { @data_bind = "value: UserModel.CurrentCity ", @class = "city", @data_val = "true", @data_val_required="City is required" })
@Html.ValidationMessageFor(x => x.UserModel.CurrentCity) 
```

我想要此字段的自动完成功能，并为此使用 jquery 令牌输入插件，例如：

```
$(".city").tokenInput('@Url.Action("AutocompleteCity", "Settings")',{ minChars: 2, tokenLimit: 1, hintText: "Type in a city" });
$(".city").tokenInput("add", {name: viewModel.UserModel.CurrentCity()}); 
```

除了客户端不显眼的验证外，一切正常。即使 CurrentCity 为空，也会发布表单。

我还尝试将 MVC 助手更改为纯 html：

```
<input data-val="true" data-val-required="City is required" type="text" class="city" data-bind = "value: UserModel.CurrentCity, attr: { name: 'UserModel.CurrentCity', id: 'UserModel.CurrentCity'}" />
<span class="field-validation-valid" data-valmsg-for="UserModel.CurrentCity" data-valmsg-replace="true"></span> 
```

这种方法可以防止提交表单，但不会将验证错误类注入到 span 中，并且不会显示错误消息。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:49:59.483

您创建的原始输入元素被隐藏。您可能需要启用隐藏元素的验证：[jquery.validate v. 1.9 忽略一些隐藏输入](https://stackoverflow.com/q/8565135/173225)或[https://stackoverflow.com/a/13295938/173225](https://stackoverflow.com/a/13295938/173225)。

# matlab - 在 MATLAB 中不使用 perms 命令的置换

> ID：14080342
> 
> 赞同：3
> 
> 时间：2012-12-29T09:23:23.230
> 
> 标签：matlab, permutation

当我有3个矩阵时

```
Matrix1  
A B  
A C  
B D  

Matrix2  
A B  
B C  

Matrix3  
A B  
B C 
```

[BC] 行在 Matrix2 和 Matrix3 上通用，[AB] 行在所有矩阵上通用。对于 [BC]，我可以说 [BC 2] 和 [BC 3]。我可以创建像 [B 2 C 3] 和 [B 3 C 2] 这样的行的混合（排列）。
对于 [AB]，我可以说 [AB 1]、[AB 2]、[AB 3]。我还可以创建一个排列，如 [A 1 B 2]、[A 1 B 3]、[A 2 B 1]、[A 2 B 3]、[A 3 B 1] 和 [A 3 B 2]。

因此结果将是

```
A 1 B 2
A 1 B 3  
A 2 B 1
A 2 B 3  
A 3 B 1  
A 3 B 2
B 2 C 3
B 3 C 2 
```

我可以在没有循环或只有一个循环的情况下获得结果吗？perm 命令或使用多个“ismember”命令需要很长时间，因为我需要处理非常大的矩阵。

# r - gvisScatterChart 动态定义系列

> ID：14080344
> 
> 赞同：3
> 
> 时间：2012-12-29T09:24:14.613
> 
> 标签：r, google-visualization, series, googlevis

我正在动态创建几个`gvisScatterChart`s. 我想定义每条线的颜色，我可以使用系列和颜色属性来完成。没有什么比订单或固定号码更能让我预定义颜色了。所以我想创建一个与我的颜色平行的属性数组，并将其放置在`series=myColors`.

问题是 gVis 需要这样的字符串：

```
 series="[{color: 'black', visibleInLegend: false}]", 
```

一旦我使用`paste`函数 gVis 创建了一个字符串，就不再接受它们，只是将一个空白页显示为图表。（即使标记“使用\”）

这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:38:04.810

这不是一个错误，正如帮助中所说，它需要一个 JSON 字符串，因此您需要构建 JSON 字符串。

使用`RJSONIO`您可以使用构建 JSON 选项`toJSON`

```
library(googleVis)
library(RJSONIO)
myColor <- 'grey'   ## my dynamic color, here I fix but you can read it ,e.g
                    ## from a chart config file or whatever you want
isLegend <- TRUE    ## a boolean value 

myseriesOptions <- toJSON(list(list(color=myColor),list(visibleInLegend=isLegend))) 
```

例如

```
Scatter2 <- gvisScatterChart(women, 
                             options=list(legend="none",
                                          lineWidth=2, pointSize=0,
                                          title="Women", vAxis="{title:'weight (lbs)'}",
                                          hAxis="{title:'height (in)'}", 
                                          width=300, height=300,
                                          series = myseriesOptions    ))

 plot(Scatter2) 
```

PS：我们可以`fromJSON`用来获取要构造的字符串的R形式，例如

```
fromJSON("{title:'mytitle'}")        ## the ouptut is a list 
$itl
NULL

cat(toJSON(list(title='mytitle')))   ## I construct my list and I use toJSON
                                     ## I get my origin json form

{
 "title": "mytitle" 
} 
```

# ruby-on-rails - 使用 Ajax 的 Rails。从模型中获取数据以显示

> ID：14080346
> 
> 赞同：1
> 
> 时间：2012-12-29T09:24:56.050
> 
> 标签：ruby-on-rails, ruby, ajax, ruby-on-rails-3, jquery

我刚开始使用 Rails 和 Ajax，但在集成 Ajax 和 Jquery 时遇到了一些问题。

我有要使用 jQuery 在我的 div 中显示和更新的数据。我在 Jquery 中写了一个表格，我可以在其中拖动和拖动项目。现在我正在使用默认项目。我想用后端导轨检索这些物品，但我不太确定我该怎么做。

这是模型。我想在表格中显示这些。

```
class SlotAllocation < ActiveRecord::Base
  attr_accessible :group_index, :lesson_type, :timeslot_id

  def as_json(options={}) 
  {
     :group_index =>self.group_index
     :lesson_type =>self.lesson_type
     :timeslot_id =>self.timeslot_id
  }
end 
```

这是控制器动作。我已将 format.js 添加到索引和更新函数中。

```
 def index
    @slot_allocations = SlotAllocation.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @slot_allocations }
      format.js{ render :json => @slot_allocations }
    end
  end

    def update
    @slot_allocation = SlotAllocation.find(params[:id])

    respond_to do |format|
      if @slot_allocation.update_attributes(params[:slot_allocation])
        format.html { redirect_to @slot_allocation, notice: 'Slot allocation was successfully updated.' }
        format.json { head :no_content }
        format.js { head :ok}
      else
        format.html { render action: "edit" }
        format.json { render json: @slot_allocation.errors, status: :unprocessable_entity }
        format.js  { render :js => @slot_allocation.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

在视图中，我有一张桌子。它根据我放置的一些默认值工作。

```
<table id='subjects' border="1">
    <tbody></tbody>
</table> 
```

现在我想将这些默认值更改为我在 rails 中的值。

通过尝试拼凑我从 github 的代码中获得的某些信息。我试过这个。

```
slots= {
    url: '/slot_allocations'
} 
```

为了帮助我理解，我在 JQuery 中做了类似的事情，只是为了看看我可以检索到哪些信息，结果我得到了 [object Object]。

```
TryDiv(slots);

 function TryDiv(slots){
        var div = document.getElementById('tryout');
        div.innerHTML = div.innerHTML + slots;
 } 
```

我不太确定该对象中包含什么，如果有人可以帮助我了解如何从模型中检索我需要的信息，我将不胜感激。我可以参考的任何文章或代码示例也将不胜感激。

# html - 如何在其默认程序而不是浏览器中打开指向本地文件的 html 链接？

> ID：14080348
> 
> 赞同：3
> 
> 时间：2012-12-29T09:25:23.687
> 
> 标签：html, file, hyperlink, local

基本上，我正在创建一个网页，其中包含链接到视频文件的电影海报图像，作为一种使我的本地视频库更具视觉吸引力的形式。

我正在使用

```
<a href="C:\blah\movie.mkv"><img src="poster.jpg"> 
```

它完全按照我的意愿工作，但是，它在浏览器中打开文件，而不是像我想要的那样在其默认程序中打开它。我希望每个链接在名为“VLC 媒体播放器”的程序中打开文件，正如 Windows 中为它们的每个文件类型指定的那样。

让我知道我该怎么做（以最简单的形式——我不太聪明：P）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:39:00.757

如果您在本地系统上创建网页供您自己使用，那么您可能需要考虑查看 WAMP 服务器设置。这使用 php 并且应该允许您使用 exec 命令调用 VLC。但是需要一些学习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:54:08.287

您几乎无法控制客户端如何处理资源。

您可以使用[`Content-Disposition`HTTP 响应标头来](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html)声明资源是附件（因此建议下载而不是打开它）。

```
Content-Disposition: attachment;filename="movie.mkv" 
```

但是，您不能阻止浏览器本机支持或插件处理某些内容，而不是让它在单独的应用程序中打开（更不用说在特定应用程序中打开它了）。

如果浏览器被配置为在内部打开视频文件，那么网站的作者无法做任何事情来改用应用程序。

# login - Joomla 2.5 - 用户登录时添加自动系统消息

> ID：14080349
> 
> 赞同：1
> 
> 时间：2012-12-29T09:25:53.833
> 
> 标签：login, system, message, joomla2.5

Joomla 2.5 确实已经生成了“您现在登录”消息，但仅在用户刚刚注册后一次（如果启用了“自动登录”）。

但是，我想在用户每次登录时显示类似（不完全相同）的消息（作为“问候”）。

来自任何人的任何粗略指示（例如，在 Joomla 代码中查看“注册后自动登录”案例中它是如何完成的）？

谢谢伙计们（n'女孩;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T16:49:29.043

正确的方法是编写一个挂钩到“onUserLogin”的插件来引发警告。更多关于插件开发的信息可以在 JDocs [http://docs.joomla.org/Plugin](http://docs.joomla.org/Plugin)上找到。

# java - 将 ByteArray 转换为固定长度的字符串时出现异常

> ID：14080350
> 
> 赞同：0
> 
> 时间：2012-12-29T09:25:54.427
> 
> 标签：java, android, bytearray

我想将字节转换为字符串。

我有一个 android 应用程序，我正在使用它`flatfile`来存储数据。

假设我的`flatfile`.

在平面文件数据库中，我的记录大小和它的`10`字符是固定的，在这里我存储了很多字符串记录序列。

但是当我从平面文件中读取一条记录时，每条记录的字节数是固定的。因为我为每条记录写了 10 个字节。

如果我的字符串是，`S="abc123";` 那么它将存储在平面文件中，如`abc123 ASCII values for each character and rest would be 0`. 表示字节数组应该是`[97 ,98 ,99 ,49 ,50 ,51,0,0,0,0]`. 因此，当我想从字节数组中获取我的实际字符串时，当时我正在使用下面的代码并且它工作正常。

但是当我给我的`inputString = "1234567890"`时候它会产生问题。

```
public class MainActivity extends Activity {
    public static short messageNumb = 0;
    public static short appID = 16;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        // record with size 10 and its in bytes.
        byte[] recordBytes = new byte[10];
        // fill record by 0's
        Arrays.fill(recordBytes, (byte) 0);

        // input string
        String inputString = "abc123";
        int length = 0;
        int SECTOR_LENGTH = 10;
        // convert in bytes
        byte[] inputBytes = inputString.getBytes();
        // set how many bytes we have to write.
        length = SECTOR_LENGTH < inputBytes.length ? SECTOR_LENGTH
                : inputBytes.length;

        // copy bytes in record size.
        System.arraycopy(inputBytes, 0, recordBytes, 0, length);

        // Here i write this record in the file.
        // Now time to read record from the file.
        // Suppose i read one record from the file successfully.

        // convert this read bytes to string which we wrote.
        Log.d("TAG", "String is  = " + getStringFromBytes(recordBytes));

    }

    public String getStringFromBytes(byte[] inputBytes) {
        String s;
        s = new String(inputBytes);
        return s = s.substring(0, s.indexOf(0));
    }
} 
```

但是当我的字符串包含完整的 10 个字符时，我遇到了问题。那时我的字节数组中有两个 0，所以在这一行 `s = s.substring(0, s.indexOf(0));`

我收到以下异常：

```
java.lang.StringIndexOutOfBoundsException: length=10; regionStart=0; regionLength=-1
at java.lang.String.startEndAndLength(String.java:593)
at java.lang.String.substring(String.java:1474) 
```

那么当我的字符串长度为 10 时我该怎么办。

我有两个解决方案 - 我可以检查我的`inputBytes.length == 10`then 使其不做 subString 条件，否则`check contains 0 in byte array`。

但我不想使用这个解决方案，因为我在我的应用程序的很多地方都使用了这个东西。那么，有没有其他方法可以实现这件事呢？

请建议我一些适用于各种条件的好的解决方案。我认为最后第二个解决方案会很棒。（检查字节数组中是否包含 0，然后应用子字符串函数）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:35:16.037

```
public String getStringFromBytes(byte[] inputBytes) {
    String s;
    s = new String(inputBytes);
    int zeroIndex = s.indexOf(0);
    return zeroIndex < 0 ? s : s.substring(0, zeroIndex);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:34:00.277

我认为这条线会导致错误

```
s = s.substring(0, s.indexOf(0));

s.indexOf(0) 
```

返回 -1 ，也许您应该将 ASCII 代码指定为零，即`48`

所以这会起作用 `s = s.substring(0, s.indexOf(48));`

检查 indexOf(int) 的文档

> public int indexOf (int c) 自：API 级别 1 在此字符串中搜索指定字符的第一个索引。对字符的搜索从开头开始并移向该字符串的末尾。
> 
> 参数 c 要查找的字符。返回此字符串中指定字符的索引，如果未找到该字符，则返回 -1。

# mysql - 从多个表中获取数据的查询

> ID：14080352
> 
> 赞同：0
> 
> 时间：2012-12-29T09:26:46.927
> 
> 标签：mysql

我有以下表格

```
 spam (element_id, spam_table,spam_by,add_date) 
```

这里 (element_id,spam_by) 是主键，spam_by 是外键取决于用户的 id

```
user(id,fname,lname) 
```

id 是主键

```
profile_pic(pic_id,profile_p,userid) 
```

userid 是外键，取决于用户的 id

```
comments( comment_id, comment_on, commented_by, comment_date, comment) 
```

comments_id 是主键，comment_on 是外键取决于元素的 id commented_by 外键取决于用户的 id

```
 elements(id,name) 
```

id 是主键

从上表。我想从上面的表格中获取以下详细信息

```
 commented userid, name,pic,comment,commemt on element,spam userid, name,pic 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:32:25.303

开始查看用户 ID 上的连接和连接表。

```
 SELECT data you want
 FROM first table to join
 INNER JOIN secondtable
 ON first table userid = secondtable userid JOIN third table
 ON first table userid = thirdtable userid
 JOIN fourth table
 ON first table userid = fourth table userid 
```

依此类推，直到包含您需要的所有内容。不要忘记给每个表一个别名

它像firsttable alias一样完成然后您像这样查询您的表 alias.userid

# ios - 如何定义嵌入 ViewController 的 NavigationController？

> ID：14080353
> 
> 赞同：0
> 
> 时间：2012-12-29T09:26:59.450
> 
> 标签：ios, uinavigationcontroller

我看过一个带有以下情节提要的项目：

[http://www.disclafani.org/vc.png](http://www.disclafani.org/vc.png)

我想知道如何将 CustomerPagesViewController 构建为 NavigationController，我没有看到它的 RootNavigationController。

简而言之......我如何定义嵌入 ViewController 的 UINavigationController？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:25:55.687

当您在情节提要中拖放导航控制器时，它将创建两个控制器（更准确地说是两个场景）： a`navigationbar controller`和 a`tableview controller`将被定义为您的`rootview controller`. 您所要做的就是用您的自定义控制器替换您的 tableview 控制器：它将嵌入到您的导航控制器中。

**编辑** 对不起，我想我在第一个回答中误导了你：看起来你不能简单地用另一个控制器替换一个控制器。如果您想要在导航控制器中嵌入自定义视图控制器，更好的方法是：

1.  **`view controller`**在情节提要上拖放一个
2.  **`custom view controller`**通过编辑身份检查器中的自定义类字段来引用您的
3.  在情节提要上拖放导航控制器
4.  选择您的自定义视图控制器并**`embed in`**通过选择导航控制器从编辑器中选择选项：您的导航控制器现在应该包含您的视图控制器。您可以删除拖放导航栏控制器时创建的 tableview 控制器。

# asp.net - IIS上的301重定向？

> ID：14080354
> 
> 赞同：1
> 
> 时间：2012-12-29T09:27:16.720
> 
> 标签：asp.net, .net, iis, redirect, web

我有两个网站，例如“testsite.ir”和“testsite.com”。据我所知，我的网站位于 Windows Server 2008、Microsoft-IIS/7.5 上。如何使用 301 重定向将用户从 .ir 重定向到 .com？我可以使用 .htaccess 文件还是应该使用 webconfig？

我在我的 webconfig 中使用下面的代码，但没有任何反应：

```
 <rule name="Redirect from ir to com" stopProcessing="true">
    <match url=".*" />
    <conditions>
    <add input="{HTTP_HOST}" pattern="^www\.testsite\.ir$" />
    </conditions>
    <action type="Redirect" url="http://www.testsite.com/{R:0}" />
    </rule> 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:41:31.907

如果您可以远程访问服务器，则可以在 IIS 中执行此操作。您需要在 IIS 中启用 HTTP 重定向（添加/删除 Windows 功能），然后才能添加规则。启用后，您可以将 .ir 站点重定向到 .com 站点。见这里：[http ://www.iis.net/configreference/system.webserver/httpredirect](http://www.iis.net/configreference/system.webserver/httpredirect)

# asp.net - 如何编写以下详细信息的正则表达式？

> ID：14080356
> 
> 赞同：-2
> 
> 时间：2012-12-29T09:27:28.750
> 
> 标签：asp.net, regex

如何编写只允许`[]`, `'`, `/`, `\`, `space`, `+`, `-`, `*`, `()`, `{}`,`&`和`^`的正则表达式`@`？

我想要在 dotnet 中工作的正则表达式。请帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T09:35:26.440

这应该这样做

```
/[[\]'/\\@ ]+/ 
```

* * *

[解释](http://rick.measham.id.au/paste/explain.pl?regex=%2F%5B%5B%5C%5D%27%2F%5C%5C%40+%5D%2B%2F)

```
 NODE                     EXPLANATION
--------------------------------------------------------------------------------
  [[\]'/\\@ ]+             any character of: '[', '\]', ''', '/',
                           '\\', '@', ' ' (1 or more times (matching
                           the most amount possible)) 
```

**笔记：**

*   `\]`被转义，因为它出现在括号 ( `[]`) 对内
*   `\\`被转义，因为`\`是转义字符

* * *

根据您的评论更新

```
/[[\]'/\\@ &(){}+$%#=~"-]+/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:35:03.083

要匹配 1 个或多个字符：

```
[[\]'/\\@ ]+ 
```

要也匹配空字符串，请将 + 更改为 *，即

```
[[\]'/\\@ ]* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:42:24.847

在 C#.NET 上试试这个：

```
using System;
using System.Text.RegularExpressions;

namespace ConsoleApplication1
{
class Program
{
static void Main(string[] args)
{
  string txt=",'/\\ @";

  string re1=".*?"; // Non-greedy match on filler
  string re2="(@)"; // Any Single Character 1

  Regex r = new Regex(re1+re2,RegexOptions.IgnoreCase|RegexOptions.Singleline);
  Match m = r.Match(txt);
  if (m.Success)
  {
        String c1=m.Groups[1].ToString();
        Console.Write("("+c1.ToString()+")"+"\n");
  }
  Console.ReadLine();
    }
  }
} 
```

希望能帮助到你 ：）

# qt4 - 这段代码有什么问题吗？

> ID：14080358
> 
> 赞同：-1
> 
> 时间：2012-12-29T09:27:42.253
> 
> 标签：qt4

这是代码片段来自我为我的项目修改的财富客户端示例。我创建了一个财富客户端对话框，当我在我的一个项目中使用此代码时，它输出的是，Windows 调试窗口打开并说 exe 遇到问题需要关闭。谁能告诉我是什么问题？？

```
 QString ipAddress;
    QList<QHostAddress> ipAddressesList = QNetworkInterface::allAddresses();
    // use the first non-localhost IPv4 address
    for (int i = 0; i < ipAddressesList.size(); ++i) {
        if (ipAddressesList.at(i) != QHostAddress::LocalHost &&
            ipAddressesList.at(i).toIPv4Address()) {
            ipAddress = ipAddressesList.at(i).toString();
            break;
        }
    }
    // if we did not find one, use IPv4 localhost
    if (ipAddress.isEmpty())
        ipAddress = QHostAddress(QHostAddress::LocalHost).toString();

    Ui_client.hostLineEdit->setText(ipAddress);
    Ui_client.portLineEdit->setValidator(new QIntValidator(1, 65535, this));

    Ui_client.okButton->setDefault(true);
    Ui_client.okButton->setEnabled(false);

    //! [1]
    tcpSocket = new QTcpSocket(this);
    //! [1]
    ;
    connect(Ui_client.hostLineEdit, SIGNAL(textChanged(QString)),
            this, SLOT(enableokButton()));
    connect(Ui_client.portLineEdit, SIGNAL(textChanged(QString)),
            this, SLOT(enableokButton()));

    connect(Ui_client.okButton, SIGNAL(clicked()),this, SLOT(requestNewFortune()));//connectclose()));
    connect(tcpSocket, SIGNAL(readyRead()), this, SLOT(readFortune()));

    //! [2] //! [4]
    connect(tcpSocket, SIGNAL(error(QAbstractSocket::SocketError)),
            //! [3]
            this, SLOT(displayError(QAbstractSocket::SocketError)));
    Ui_client.portLineEdit->setFocus();

    QNetworkConfigurationManager manager;
    if (manager.capabilities() & QNetworkConfigurationManager::NetworkSessionRequired) {
        // Get saved network configuration
        QSettings settings(QSettings::UserScope, QLatin1String("Trolltech"));
        settings.beginGroup(QLatin1String("QtNetwork"));
        const QString id = settings.value(QLatin1String("DefaultNetworkConfiguration")).toString();
        settings.endGroup();

        // If the saved network configuration is not currently discovered use the system default
        QNetworkConfiguration config = manager.configurationFromIdentifier(id);
        if ((config.state() & QNetworkConfiguration::Discovered) !=
            QNetworkConfiguration::Discovered) {
            config = manager.defaultConfiguration();
        }

        networkSession = new QNetworkSession(config, this);
        connect(networkSession, SIGNAL(opened()), this, SLOT(sessionOpened()));
        Ui_client.okButton->setEnabled(false);
        //ui->statusLabel->setText(tr("Opening network session."));
        networkSession->open();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:17:57.707

我修复了这个错误。实际上，当我按下菜单操作时，我正在显示对话框。所以在显示之前我无法在 LineEdit 中设置文本。这就是问题。当我将设置文本的部分转移到对话框后的行编辑时 - >显示（），它对我来说很好。

# r - 停止打印大量零（不是科学计数法）

> ID：14080359
> 
> 赞同：11
> 
> 时间：2012-12-29T09:27:56.707
> 
> 标签：r, printing, numbers, digits, scientific-notation

我想要实现的是让所有打印的数字以最大`7`位数显示。以下是我想要打印的示例：

> 0.000000（相对于实际数字 0.000000000029481 .....）
> 
> 0.299180（相对于实际数字 0.299180291884922 .....）

`options(scipen=99999)`通过使用和，我在后一种类型的数字上取得了成功`options(digits=6)`。但是，前一个示例总是会打印大量的零，后跟五个非零数字。**如何阻止这种情况发生并达到我想要的结果**？*我也不要科学记数法*。

*我希望这适用于每个上下文中的所有打印数字。例如，如果我有一些矩阵，调用它`A`，然后打印这个矩阵，我希望每个元素只有 6-7 位。我希望这对于每个上下文中的每个打印都是自动的；就像使用`options(digits=6)`并`options(scipen=99999)`使其在每个上下文中自动运行一样。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-05T14:09:50.003

您可以为要打印的类型定义新的打印方法。例如，如果你所有的数字都是双倍的，你可以创建

```
print.double=function(x){sprintf("%.6f", x)} 
```

现在，当您打印双精度（或双精度向量）时，`print.double()`将调用该函数而不是`print.default()`.

根据您需要打印的类型，您可能需要创建类似的功能`print.integer()`、等。`print.complex()`

要返回默认打印方法，只需删除该函数`print.double()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T11:23:03.597

你所有的数字都<1吗？你可以尝试一个简单的`sprintf( "%.6f", x )`. 否则，您可以尝试`sprintf`根据位数包装东西；检查`?sprintf`其他细节。

# java - 如何检查是否在使用 java 的客户端 Windows 系统中安装了 Windows 数字证书？

> ID：14080361
> 
> 赞同：0
> 
> 时间：2012-12-29T09:28:41.350
> 
> 标签：java, certificate

> **可能重复：**
> [我可以通过 java 在我的系统上安装证书吗](https://stackoverflow.com/questions/3325535/can-i-get-installed-certificate-on-my-system-through-java)

我们的网站允许用户在他们的 Windows 客户端中安装客户端 x.509 数字证书。我们需要检查登录我们网站的用户是否成功安装了我们的数字认证。我们决定使用 java 小程序检查这个数字证书，但谷歌没有提供可用的方法。如何使用 java 小程序检查他们的 Windows 客户端中是否安装了数字证书？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:44:13.970

以下是从 Windows 证书存储中读取证书的方法：

```
KeyStore ks = KeyStore.getInstance("Windows-MY", "SunMSCAPI");
ks.load(null, null);

Enumeration<String> aliases = ks.aliases();

while (aliases.hasMoreElements()) {
    String alias = (String) aliases.nextElement();
    X509CertImpl certificate = (X509CertImpl)ks.getCertificate(alias);

    System.out.println("Alias: " + alias);
    System.out.println("  Subject: " + certificate.getSubjectDN());
    System.out.println("  Issued By: " + certificate.getIssuerDN());

    if (ks.isKeyEntry(alias)) {
        System.out.println("  Has private key");
    }
} 
```

[http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html#SunMSCAPI](http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html#SunMSCAPI)

# javascript - CSS中的不透明度影响其他项目？

> ID：14080362
> 
> 赞同：0
> 
> 时间：2012-12-29T09:28:50.867
> 
> 标签：javascript, css

我有一段 javascript 在启动页面时启动整个页面封面，以及在封面顶部打开的两个 div 'dialog' 和 'dialog2'。所以这就像一个带有通知的黑色背景。

我遇到的问题是我希望“封面”背景是透明的/具有不透明度，并且确实如此，但由于某种原因，这也导致“对话”和“对话2”的 div 背景是透明的，我不希望这种情况发生，我不确定为什么会这样？

有人可以告诉我我做错了什么吗？

```
<script type="text/javascript">
    window.onload = function showPopUp(el) {
    var cvr = document.getElementById("cover")
    var dlg = document.getElementById("dialog")
    cvr.style.display = "block"
    dlg.style.display = "block"
    if (document.body.style.overflow = "hidden") {
        cvr.style.width = "1024"
        cvr.style.height = "100&#37;"
        }
    }

    </script>
    <style type="text/css">

    #cover {
    display:none;
    position:absolute;
    z-index:98;
    left:0px;
    top:0px;
    width:100%;
    height:2648px;
    background-color:#fff;
    filter:alpha(Opacity=50);
    opacity:0.7;
    -moz-opacity:0.7;
    -khtml-opacity:0.7;
    overflow:hidden;
    }

    #dialog {
     background-image: url(http://www.playtimeboys.com/img/packages/account1.png);
        background-repeat: no-repeat;
        background-size:311px 187px;
        height:187px;
        width:311px;
        margin-top:300px;
        margin-left:650px;
    z-index: 99; 
    position:fixed;

    }

    #dialog2 {
     background-image: url(http://www.playtimeboys.com/img/packages/account1.png);
        background-repeat: no-repeat;
        background-size:311px 187px;
        height:187px;
        width:311px;
        margin-top:300px;
        margin-left:230px;
    z-index: 99; 
    position:fixed;

    }

    </style>

    </head>
    <div id="cover">
    <div id="dialog">
    </div>
    <div id="dialog2">
    </div>
    <div class="foo"></div>
    </div>

                    <script type="text/javascript">
                $(document).ready(function(){
                    //To switch directions up/down and left/right just place a "-" in front of the top/left attribute
                    //Vertical Sliding

                    //Caption Sliding (Partially Hidden to Visible)
                    $('.boxgrid.caption').hover(function(){
                        $(".cover", this).stop().animate({top:'-38px'},{queue:false,duration:200});
                    }, function() {
                        $(".cover", this).stop().animate({top:'0px'},{queue:false,duration:200});
                    });
                });
                    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T09:33:08.637

CSS 不透明度会影响其中的所有内容和所有标签。您必须将封面与对话框分开。像这样：

```
 <div id="cover"></div>

    <div id="dialog">
    </div>
    <div id="dialog2">
    </div>
    <div class="foo"></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:25:35.033

`opacity`您可以使用`rgba`颜色格式，而不是使用：

```
#cover {
    ....
    background: rgba(255, 255, 255, 0.7);
    ....
} 
```

这应该可以解决您的问题而不会弄乱 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:34:04.613

放

```
<div id="dialog">
</div>
<div id="dialog2">
</div> 
```

在外面

```
<div id="cover"> 
```

或者，放入 css #dialog1 和 #dialog2：

```
filter:alpha(Opacity=100);
opacity:1;
-moz-opacity:1;
-khtml-opacity:1; 
```

希望能帮助到你 ：）

# html - 如何创建着色的 CSS 主体

> ID：14080364
> 
> 赞同：0
> 
> 时间：2012-12-29T09:29:05.730
> 
> 标签：html, css

我怎样才能创建下面的框？有人可以指出我正确的方向吗？我没有太多的CSS经验。

![在此处输入图像描述](../Images/c0ad6c31e28d97ba405b55eb4e8b783a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:32:15.597

你所问的可以用[`border-radius:`](https://developer.mozilla.org/en-US/docs/CSS/border-radius)和[`box-shadow:`](https://developer.mozilla.org/en-US/docs/CSS/box-shadow)CSS 属性来完成。

此外，不要将这些直接应用于`<body>`但有一个通用包装器`<div>`或`<section>`接收这些属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T09:32:36.700

```
#box{
    background:#FFFFFF;
    box-shadow:3px 3px 5px #333333;
    -moz-box-shadow:3px 3px 5px #333333;
    -webkit-box-shadow:3px 3px 5px #333333;
    -o-box-shadow:3px 3px 5px #333333;
    -ms-box-shadow:3px 3px 5px #333333;
    border-radius:4px;
    -webkit-border-radius:4px;
    -moz-border-radius:4px;
    -o-border-radius:4px;
    -ms-border-radius:4px;
} 
```

我已经添加了在所有浏览器平台上工作`webkits`所需的内容。`box-shadow`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T09:33:10.527

您可以利用 CSS3。使用[border-radius](http://www.w3schools.com/css3/css3_borders.asp)和[box-shadow](http://www.w3schools.com/css3/tryit.asp?filename=trycss3_box-shadow)属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T12:02:40.457

你可以使用这个网站：[CSS3 Generator](http://css3generator.com/)

# javascript - 使用 documentFragment 的 IE 性能不佳

> ID：14080365
> 
> 赞同：3
> 
> 时间：2012-12-29T09:29:09.543
> 
> 标签：javascript, internet-explorer, dom-manipulation

为了测试 DOM 操作与 innerHTML 的对比，我使用`documentFragment`（[网页](http://ejohn.org/blog/dom-documentfragments/)）将 10000 个元素附加`href`到一个`div`元素中，使用了这个小测试方法。Chrome 或 Firefox 的性能还可以，但在 IE (10, 9, 8) 中性能非常糟糕，大约需要***10-12 秒***。谁能解释这种差异和/或详细说明提高 IE 性能的解决方案？

这是一个演示它的[**jsfiddle 。**](http://jsfiddle.net/KooiInc/kW5dd/)

方法：

```
function useFragment(){
    var frag = document.createDocumentFragment(),
        i = 10000,
        rval = document.createElement('span');
    frag.appendChild(rval);
    do {
     var optText = 'option '+i
        ,ref = document.createElement('a') 
        ,zebra = i%2 ? 'zebra' : ''
        ,islist = true
        ,isSel = i === 5
     ;
     rval.insertBefore(ref,rval.firstChild);
     ref.appendChild(document.createTextNode(optText));
     ref.id = 'opt' + i;
     ref.className = zebra + (islist && isSel ? ' scrollSelect' : '');
     ref.href = '#' + i;
     ref.title = optText;
   } while (i-->0);
   return rval;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T10:00:50.117

想我已经找到了：它看起来像，虽然 a`documentFragment`应该是一个“离线”元素（一个不属于实时 DOM 的元素），但*IE 并不这样对待它*。强制片段*真正*脱机的方法是将一些元素附加到它，将其`display`属性设置为`none`并将其余元素附加到该元素。完成后，删除`display:none`属性，然后`documentFragment`可以将其附加到 DOM。

它仍然慢了三倍（在我的 PC 上它仍然需要大约 1-1.5 秒，而在 Chrome/Firefox 中对于 10000 个元素大约需要 2-300 毫秒）。因此，对于 IE（甚至是 10 版），使用`innerHTML`向 DOM 添加一堆元素是更快的方法。我想说，IE 仍然是开发人员的噩梦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T09:17:18.747

就我的经验而言，最大的好处是将许多孤立的元素附加到片段中，并且在所有子元素和属性都固定（附加后）之前不附加该元素。如果我理解你的代码（我真的懒得解码它），你会在片段中附加一个跨度。这不是documentFragment的意义。顺便说一句：你不应该在循环中声明你的变量。

```
var node=document.getElementById("whatever")
   ,frag=document.createDocumentFragment()
   ,i=0,len=50,a={},img={};
for(i;i<len;i++){
   a=document.createElement("a");
   img=document.createElement("img");
   a.href="image"+i;
   img.className=J[i][1];
   img.src="image/img"+i+".png";
   img.alt="image:"+i;
   a.appendChild(img);
   frag.appendChild(a);
   }                     
node.appendChild(frag); 
```

这样 IE8 Opera12 花费的时间与 innerHTML 差不多。真正的好处是铬。FF 使用 innerHTML 的速度令人难以置信。在旧的 XP 机器上测试。

要考虑的另一件事是创建一个未连接到具有所有子项和属性的 DOM 的节点，对其进行多次克隆，对其进行操作并将其附加到 documentFragment。

```
var frag=document.createDocumentFragment()
   ,toFill=document.getElementById("imageCollection")
   ,i=0,a={},img={}
   ,dummy=document.createElement("a")
   ;
dummy.innerHTML="<img src='img/image_' />";   
for(i;i<50;i++){
   a=dummy.cloneNode(true);
   img=a.getElementsByTagName("img")[0];
   a.href="description_"+i+".html";
   img.src+=i+".png";
   frag.appendChild(a);
   }            
toFill.appendChild(frag); 
```

如果您不需要对克隆节点进行大量操作，这很有用。

# titanium - MAC 中 Titanium IDE 的键盘快捷键

> ID：14080374
> 
> 赞同：0
> 
> 时间：2012-12-29T09:30:24.623
> 
> 标签：titanium, keyboard-shortcuts, appcelerator

我是 appcelerator Titan IDE 的新手，之前我在 Xcode 上工作。

在 xcode 中，我依靠键盘快捷键来节省编码时间。

现在我正在努力使用钛，因为我不知道钛 IDE 中的任何键盘快捷键。在 Xcode 中注释代码块 ( `cmd+\`) 时，将它们移到 left( `cmd+}`) 或 right( `cmd+{`) 非常容易。现在在钛中，我正在为每一行代码手动执行它！

谁能帮我在 MAC 中找到钛 IDE 的快捷方式？

如果这不是问这个问题的正确地方。请原谅我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:36:08.560

Midhun，Titanium IDE 和 Eclipse IDE 一样简单。我在下面给出了一些重要的快捷方式

*   `cmd`+`/`用于注释代码块
*   `tab`用于将语句块向右移动
*   `shift`+`tab`向左移动一段代码
*   `cmd`+ `shift`+`F11`运行你的项目
*   `cmd`+`F11`用于调试您的项目
*   `cmd`+ `shift`+`B`用于切换断点
*   `cmd`+`F`查找和替换

您可以使用[此](https://wiki.appcelerator.org/display/tis/Modifying+your+shortcut+keys)链接在 Windows 和编辑器窗口中修改 Titanium Studio 的键盘快捷键，您可以按`Shift` + `Cmd` +`L`查看所有可用的快捷键。评论，取消评论和切换评论都在那里。它告诉了钛工作室的所有捷径

快乐编程：）

# z3 - Z3py：如何从公式中获取变量列表？

> ID：14080398
> 
> 赞同：7
> 
> 时间：2012-12-29T09:34:17.123
> 
> 标签：z3, z3py

在 Z3Py 中，我有一个公式。如何检索公式中使用的变量列表？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T10:16:39.577

Vu Nguyen 为 Z3Py 贡献了几个有用的程序。他实施了一个程序`get_vars`来收集使用的变量列表。可以在[此处](http://z3.codeplex.com/SourceControl/changeset/view/fbce8160252d#src/api/python/z3util.py)找到此过程和许多其他过程。他的贡献将在下一个正式版本中提供。这是`get_vars`可以在[rise4fun](http://rise4fun.com/Z3Py/bRhVN)在线执行的版本。

```
# Wrapper for allowing Z3 ASTs to be stored into Python Hashtables. 
class AstRefKey:
    def __init__(self, n):
        self.n = n
    def __hash__(self):
        return self.n.hash()
    def __eq__(self, other):
        return self.n.eq(other.n)
    def __repr__(self):
        return str(self.n)

def askey(n):
    assert isinstance(n, AstRef)
    return AstRefKey(n)

def get_vars(f):
    r = set()
    def collect(f):
      if is_const(f): 
          if f.decl().kind() == Z3_OP_UNINTERPRETED and not askey(f) in r:
              r.add(askey(f))
      else:
          for c in f.children():
              collect(c)
    collect(f)
    return r

x,y = Ints('x y') 
a,b = Bools('a b') 
print get_vars(Implies(And(x + y == 0, x*2 == 10),Or(a, Implies(a, b == False)))) 
```

# sencha-touch-2 - Sencha Architect 生成代码选项卡面板和列表 - 列表不显示在选项卡中...？

> ID：14080399
> 
> 赞同：0
> 
> 时间：2012-12-29T09:34:18.030
> 
> 标签：sencha-touch-2, sencha-architect

我错过了什么吗？生成的代码如下图。

列表独立于选项卡可以正常工作...您可以不将列表放在选项卡容器中还是我还需要一个选项？谢谢格雷格

```
Ext.define('MyApp.view.MyTabPanel', {
    extend: 'Ext.tab.Panel',

    config: {
        items: [
            {
                xtype: 'container',
                title: 'Home',
                iconCls: 'info',
                html: 'Welcome',
                itemId: 'home'
            },
            {
                xtype: 'container',
                title: 'About',
                iconCls: 'info',
                html: 'Awsome',
                itemId: 'about'
            },
            {
                xtype: 'container',
                title: 'Stylists',
                iconCls: 'info',
                html: '',
                itemId: 'contact',
                scrollable: true,
                items: [
                    {
                        xtype: 'list',
                        docked: 'top',
                        styleHtmlContent: true,
                        itemTpl: [
                            '<div>{fname} {lname} {title}</div>'
                        ],
                        store: 'LSstylistStore'
                    }
                ]
            }
        ],
        tabBar: {
            docked: 'bottom'
        }
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T13:42:13.197

需要添加布局：类型：Fit，这使得列表显示在选项卡容器内。在 Architect 中选择包含列表的选项卡，在 Ext.Container 布局选项中选择“fit”

```
 xtype: 'container',
            title: 'Stylists',
            iconCls: 'info',
            html: '',
            itemId: 'Stylists',
            layout: {
                type: 'fit'
            },
            scrollable: true, 
```

# javascript - 未捕获的 SyntaxError：意外的令牌 =

> ID：14080401
> 
> 赞同：29
> 
> 时间：2012-12-29T09:34:30.890
> 
> 标签：javascript, d3.js

我刚刚从使用 d3.v3 缩小版本的本地副本切换到开发版本。使用缩小版本时它工作正常，但使用我的本地副本[http://d3js.org/d3.v3.js](http://d3js.org/d3.v3.js)给了我标题中的错误，引用这一行：

```
var € = Math.PI, µ = 1e-6, d3_radians = € / 180, d3_degrees = 180 / €; 
```

当我包含托管文件时，它工作正常。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-01-13T06:33:10.867

问题是您使用 ISO-8859-1 字符编码（通常是浏览器默认值）为 D3 提供服务，而 D3 必须使用 UTF-8 编码提供服务。通常发生这种情况是因为您在加载 HTML 页面的顶部缺少一个元标记：

```
<!DOCTYPE html>
<meta charset="utf-8"> 
```

需要元指定字符集，因为[d3js.org](http://d3js.org)由[GitHub Pages](http://pages.github.com/)提供，并且未在 Content-Type 响应标头中指定字符集。因此，字符集是从加载的 HTML 文档中推断出来的。

如果您愿意，可以在脚本标签上指定一个字符集属性。确保在测试之前清除浏览器缓存，因为缓存的副本将保留最初访问时的字符编码：

```
<script src="http://d3js.org/d3.v3.js" charset="utf-8"></script> 
```

缩小版本不会发生该错误，因为变量名称已替换为 ASCII 等效项。（我不记得如果格式字符串中的 UTF-8 字符同样被转义序列替换，但我仍然建议在所有情况下将 D3 用作 UTF-8。）

如果您通过在浏览器中查看源代码然后使用复制粘贴来下载 D3，也可能会出现编码问题，这就是我建议下载[d3.v3.zip](http://d3js.org/d3.v3.zip)的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T15:04:04.167

这绝对是一个编码问题，请尝试关注这一点。

使用 Chrome 打开您发布的链接（[http://d3js.org/d3.v3.js](http://d3js.org/d3.v3.js)），我也看到了双字节字符：

```
 var Ï€ = Math.PI, Îµ = 1e-6, d3_radians = Ï€ / 180, d3_degrees = 180 / Ï€; 
```

如果您几乎不使用“将页面另存为...”来保存文件并使用 Sublime Text （[http://www.sublimetext.com/](http://www.sublimetext.com/)）之类的编辑器打开它，它可以正常工作并显示：

```
var π = Math.PI, ε = 1e-6, d3_radians = π / 180, d3_degrees = 180 / π; 
```

我尝试将此下载的文件与我的项目一起使用，没关系。

# c++ - 在 C++ 库中具有错误代码选项以提高性能

> ID：14080404
> 
> 赞同：1
> 
> 时间：2012-12-29T09:34:56.017
> 
> 标签：c++, exception, error-code

我编写了一个包含异常和错误代码的 C++ 文件库。程序运行时可以禁用异常。在这种情况下，用户必须检查错误代码。当然，当启用异常抛出时，不会返回错误代码，因为异常是在被调用函数返回之前抛出的。目前，禁用时仍然可能引发异常（错误）。我会尽快解决的。有人对我评论说，同时具有异常和错误代码被认为是糟糕的设计。我同意他的观点，我即将删除错误代码，并让库抛出带有更多错误信息的自定义派生异常。但我犹豫了。出于性能原因，我喜欢采用这种混合方法。这就是我想做的事情：

如果用户在通用配置文件中定义以下内容

```
#define ELMAX_EXCEPTION 1 
```

以下代码

```
int Write(std::wstring str) ELMAX_THROW_OR_NOT; 
```

将扩展到 2 中的任何一个。

```
// under C++11 compiler
int Write(std::wstring str) noexcept;

// under C++98 compiler
int Write(std::wstring str) throw(); 
```

如果`ELMAX_EXCEPTION`未定义或为零，则宏将扩展为空。

```
int Write(std::wstring) ; 
```

我想这样做的原因是，库用户希望不让编译器生成堆栈展开代码（用于异常）而获得性能增益，并且编译器可以更好地优化此类函数。我的 C++ 文件库正在使用 C 文件 API，唯一可能引发异常的是 new 关键字，我打算添加`nothrow`. UTF-8 代码也可以抛出异常（也需要更改）

```
char *parr = new (nothrow) char[num];

if(parr==NULL)
    // handle it either through error code or throw exception (if enabled) 
```

对于我的库错误，请告知我是否应该采用纯异常方法或混合方法（如前所述）。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T09:42:23.247

这取决于你想对图书馆做什么。显然，从设计的角度来看，例外情况更好，但它们确实经常被某些类型的应用程序禁用（例如沉浸式 3D 游戏）。

# c++ - std::make_shared() 是否使用自定义分配器？

> ID：14080408
> 
> 赞同：19
> 
> 时间：2012-12-29T09:35:43.887
> 
> 标签：c++, c++11, shared-ptr, make-shared

考虑[这段代码](http://ideone.com/8wO6Hc)：

```
#include <memory>
#include <iostream>

class SomeClass {
public:
    SomeClass() {
        std::cout << "SomeClass()" << std::endl;
    }

    ~SomeClass() {
        std::cout << "~SomeClass()" << std::endl;
    }

    void* operator new(std::size_t size) {
        std::cout << "Custom new" << std::endl;
        return ::operator new(size);
    }

    void operator delete(void* ptr, std::size_t size) {
        std::cout << "Custom delete" << std::endl;
        ::operator delete(ptr);
    }
};

int main() {
    std::shared_ptr<SomeClass> ptr1(new SomeClass);
    std::cout << std::endl << "Another one..." << std::endl << std::endl;
    std::shared_ptr<SomeClass> ptr2(std::make_shared<SomeClass>());
    std::cout << std::endl << "Done!" << std::endl << std::endl;
} 
```

这是它的输出：

```
Custom new
SomeClass()

Another one...

SomeClass()

Done!

~SomeClass()
~SomeClass()
Custom delete 
```

显然，`std::make_shared()`没有调用`new`操作员——它使用的是自定义分配器。这是标准行为`std::make_shared()`吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-29T09:42:50.877

是的，这是标准行为。从标准（§20.7.2.2.6 *shared_ptr 创建*）：

> 效果：分配适合类型 T 对象的内存，并通过放置 new 表达式在该内存中构造一个对象`::new (pv) T(std::forward<Args>(args)...).`

出于效率原因，这允许`make_shared`在单个分配中为共享指针本身（“控制块”）分配对象和数据结构的存储空间。

[`std::allocate_shared`](http://en.cppreference.com/w/cpp/memory/shared_ptr/allocate_shared)如果您想控制该存储分配，您可以使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T19:07:05.463

为了扩展 Mat 的正确答案，`make_shared`通常通过分配一个包含`shared_ptr`引用计数和未初始化字节缓冲区的对象来实现：

```
template<typename T>
  struct shared_count_inplace
  {
    long m_count;
    long weak_count;
    typename std::aligned_storage<sizeof(T)>::type m_storage;
    // ...
  }; 
```

这是将在堆上分配的类型，而不是您的类型，因此`new`不会调用您的类型。然后您的类型将使用位置`new`处的位置构造`(void*)&m_storage`。

# php - 反向 SPLObjectStorage

> ID：14080409
> 
> 赞同：2
> 
> 时间：2012-12-29T09:35:49.580
> 
> 标签：php, spl

我有一个 SPLObjectStorage 对象，其中一个 Player 对象作为键，分数作为与之关联的信息。播放器对象按从最高到最低的顺序添加到存储中，但我现在到了需要以相反顺序遍历它们的地步。

我还需要能够从指定的偏移量开始一直循环。我已经在下面找到了这部分，我只是想不出一个好的方法来扭转它。

```
// $players_group = new SPLObjectStorage()
// code to add Player and Score would go here
// above lines just for example

# NEED TO REVERSE ORDER PLAYERS GROUP HERE

$infinite_it = new InfiniteIterator($players_group);
$limit_it = new LimitIterator($infinite_it, $current_offset, $players_group->count());
foreach($limit_it as $p){
    // properly outputting from offset all the way around
    // but I need it in reverse order
} 
```

我想避免遍历存储对象并将它们全部推送到一个数组中，然后执行 array_reverse，然后最后继续我的 foreach 循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:18:47.783

`SplObjectStorage`是 a`key->value store` 和 中一个元素的“key”`SplObjectStorage`实际上是对象的哈希值。排序和还原需要您扩展和编写自己的实现，但我认为您应该考虑使用`SplStack`

想象一下你的玩家等级

```
class Player {
    private $name;
    function __construct($name) {
        $this->name = $name;
    }
    function __toString() {
        return $this->name;
    }
} 
```

**使用`SplStack`**

```
$group = new SplStack();
$group->push(new Player("Z"));
$group->push(new Player("A"));
$group->push(new Player("B"));
$group->push(new Player("C"));

echo "<pre>";
$infinite_it = new InfiniteIterator($group);
$limit_it = new LimitIterator($infinite_it, 0, 3); // get frist 3
foreach ( $limit_it as $p ) {
    echo ("$p");
} 
```

**如果你坚持，`SplObjectStorage`那么你可以考虑定制`ReverseArrayIterator`**

```
class ReverseArrayIterator extends ArrayIterator {
    public function __construct(Iterator $it) {
        parent::__construct(array_reverse(iterator_to_array($it)));
    }
} 
```

用法

```
$group = new SplObjectStorage();
$group->attach(new Player("Z"));
$group->attach(new Player("A"));
$group->attach(new Player("B"));
$group->attach(new Player("C"));

echo "<pre>";
$infinite_it = new InfiniteIterator(new ReverseArrayIterator($group));
$limit_it = new LimitIterator($infinite_it, 0, 3); // get frist 3
foreach ( $limit_it as $p ) {
    echo ("$p");
} 
```

**两者都会输出**

```
CBA //reversed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T10:10:48.130

> 我想避免遍历存储对象并将它们全部推送到一个数组中，然后执行 array_reverse，然后最后继续我的 foreach 循环。

不知道这是否是最有效的方法，但作为 SplObjectStorage 实现 Iterator 您可以使用 iterator_to_array 然后反转数组：

```
array_reverse(iterator_to_array($players_group)); 
```

# entity-framework - 在断开连接的场景中使用实体的合适实体类型是什么？

> ID：14080410
> 
> 赞同：1
> 
> 时间：2012-12-29T09:35:55.097
> 
> 标签：entity-framework, entity-framework-4.1

在我的应用程序中，我需要检索实体的部分图。
这些实体由用户处理，稍后应保存。
因此返回和保存上下文不同，但我需要对整个图表进行更改跟踪。
据我所知，现在不推荐使用 STE
但我不知道为这种情况选择什么类型的实体。谁能给出解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:22:18.633

您可以尝试以下一种。

**插入断开连接的实体**

`Insert<>`这是可以插入任何断开连接的实体的通用版本。

```
public TEntity Insert<TEntity>(TEntity entity) 
            where TEntity : EntityObject 
{ 
    AddTo<TEntity>(entity); 
    this.SaveChanges(true); 
    // Without this, attaching new entity of same type in same context fails. 
    this.Detach(entity); 
    return entity; 
} 
```

**插入断开连接的子实体**

插入子实体的共同原则是：

1.  首先，您必须在上下文中附加父实体，

2.  那么你将不得不设置父子之间的映射（你不能已经有了映射！），

3.  然后你将不得不调用 SaveChanges。

这是代码：

```
public TEntity Insert<TParent, TEntity>(
    TParent parent,
    Action<TParent, TEntity> addChildToParent,
    TEntity entity)
    where TEntity : EntityObject
    where TParent : EntityObject
{
    AddTo<TParent, TEntity>(parent, addChildToParent, entity);
    this.SaveChanges();
    this.AcceptAllChanges();
    // Without this, consequtive insert using same parent in same context fails.
    this.Detach(parent); 
    // Without this, attaching new entity of same type in same context fails.
    this.Detach(entity);
    return entity;
}

private void AddTo<TParent, TEntity>(TParent parent, 
    Action<TParent, TEntity> addChildToParent, 
    TEntity entity) 
    where TEntity : EntityObject
    where TParent : EntityObject
{
    Attach<TParent>(parent);            
    addChildToParent(parent, entity);            
} 
```

您可以[**在完全断开连接的情况下从 Entity Framework获取更多详细信息**](http://www.codeproject.com/Articles/81543/Finally-Entity-Framework-working-in-fully-disconne)

我希望这对你有帮助。

# scala - Scala 包对象构造函数

> ID：14080411
> 
> 赞同：3
> 
> 时间：2012-12-29T09:36:21.077
> 
> 标签：scala

何时以及如何调用 Scala 包对象构造函数？

我有两节课：

包.scala

```
package my;
package object entities {
   //Some initialization code in constructor
} 
```

经典的.scala

```
package my.entities;
case class Classy {
} 
```

我试图让实体构造函数在创建 Classy 对象时已经执行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T10:54:56.193

包对象被翻译成一个普通的 java 类文件，称为*package.class* IIRC。从那时起，我假设它的行为类似于任何普通的 Java 类，因此它在第一次被引用时被加载和实例化。在 Scala 中，这意味着您需要定义一些方法或`val`在包对象中，然后从外部访问它。在您的情况下，您可以尝试从 的构造函数`Classy`或实例化的代码中调用它`Classy`。

### 更新

好的，这是我运行的一些代码来测试我上面描述的内容：

```
// package.scala
package some

package object pkg {
  println("package created!")

  def func() { println("func called") }
}

// C.scala
package some.pkg

class C {
  println("created C")
}

// G.scala
package some.pkg

object G {
  println("creating G")
  func()
  println("created G")
}

// PackageTester.scala
package some.pkg

object PackageTester extends App {
  val c = new C
  val g = G
} 
```

输出是：

```
created C
creating G
package created!
func called
created G 
```

这证明了 Scala 包对象是延迟创建的，只有在实际引用它们时才创建。事实上，如上所示，“普通”Scala 对象也是如此`G`。

# angularjs - 在自定义指令中绑定 ng 指令

> ID：14080412
> 
> 赞同：0
> 
> 时间：2012-12-29T09:36:26.003
> 
> 标签：angularjs, javascript-framework

我有以下带有自定义指令“my-repeater”的代码：

```
<div ng-controller="AngularCtrl">
  <div my-repeater='{{items}}'>Click here</div>
</div>​ 
```

这是我的自定义指令：

```
myApp.directive('myRepeater', function($compile) {
  return {
    restrict: 'A',
    link: function(scope, element, attrs) {
        var myTemplate = "<div ng-click='updateRating({{item}});' ng-class='getRatingClass({{rating}});'>{{rating}}</div>";
            var items = scope.items;
            console.log('length: ' + items.length);
            for (var i = 0; i < items.length; i++) {
                var child = scope.$new(true);
                console.log(items[i].ratings);
                child.item = items[i];
                child.rating = items[i].ratings;                    
                var text = $compile(myTemplate)(child);
                element.append(text);
            }
   }
}; 
```

});

**ng-click**和**ng-class**绑定在我的自定义指令中没有正确发生。谁能帮我解决我在这里做错的事情？

这是 JS 小提琴。 [http://jsfiddle.net/JSWorld/4Yrth/5/](http://jsfiddle.net/JSWorld/4Yrth/5/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T11:27:53.090

嗨，我已将您的示例更新为我认为您想要做的。

[http://jsfiddle.net/46Get/2/](http://jsfiddle.net/46Get/2/)

*   首先，在这样的指令`ng-click='updateRating({{item}});'`中接收一个表达式，您不需要使用'{{}}'，因为它已经在范围内执行。

*   其次，当您需要在指令中添加兄弟姐妹时，您需要在编译阶段而不是链接阶段进行，或者只使用 ng-repeat

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T19:18:30.630

我添加`.ng-scope { border: 1px solid red; margin: 2px}`到@rseidi 的答案/小提琴中，我发现 $compile 服务正在为模板中的每个项目创建一个范围 - 即每个`<div>`. 由于您要显示的项目太多，我认为更少的范围会更好。在尝试了一堆不同的东西之后，我发现 Angular 似乎为每个“顶级”元素创建了一个新的范围。所以一个解决方案是创建一个外部 div - 即确保只有一个“顶级”元素：

```
var mainTpl = '<div>';  // add this line
...
for(...) { }
mainTpl += '</div>';    // add this line 
```

[小提琴](http://jsfiddle.net/mrajcok/4YtLu/)

现在，只有外部 div 创建了一个范围，因为现在只有一个“顶级”元素，而不是每个项目一个。

# java - 在java中的国际象棋中使用JPanel

> ID：14080415
> 
> 赞同：-4
> 
> 时间：2012-12-29T09:36:51.157
> 
> 标签：java, swing, jpanel, jcomponent, chess

在使用 JPanel 在 Java 中制作国际象棋游戏时，是否有一种方法可以返回容器是否包含任何内容？例如，通过定义一个这样的数组：JPanel [8][8] 我们要检查广场[i][j] 中是否有人，这样我们就可以检查玩家的移动是否合法。有没有办法检查？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:01:07.617

我建议不要检查 JPanel，而是将当前棋盘位置存储在单独的数据结构中。您通常会定义一个类来存储具有访​​问器功能的板，以访问这些部件，例如：

```
public class Board {
    private Piece[][] squares;
    ....
    code to set up board etc.
    ....
    public Piece getPiece(int x, int y) {
        return squares[x][y]; 
    }
} 
```

这种方法为您提供了几个优点：

*   您可以将棋盘位置的表示与 GUI 显示分离。这很重要——您通常希望在不受屏幕显示约束的情况下对棋盘位置进行处理（例如评估它们、搜索可能的移动等）。
*   您可以以任何您喜欢的方式构建板的内部表示，同时向使用板的其他代码呈现一个很好的封装视图
*   性能会更好：与查询/修改 GUI 组件树相比，电路板的简单内存表示更轻量级且访问速度更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:37:33.777

给我发消息，我的电脑出了问题，目前似乎无法发表评论，但我前段时间做了一个跳棋游戏，我会把源代码发给你。它不完整，但它确实绘制了棋盘和棋子。它还检查鼠标点击和可玩方块。它可能有用作为参考。对您的问题的快速回答是我不会使用 a `JPanel`，而是创建一个扩展的 Space 类`Rectangle`或`Rectangle2D`，这些类具有执行您想要的操作的方法，而据我所知`JPanel`该类没有。

# jquery - 有 jQuery 知识的人可以帮我解决这个问题吗？

> ID：14080416
> 
> 赞同：0
> 
> 时间：2012-12-29T09:37:03.137
> 
> 标签：jquery

我无法对这里发生的事情做出一些合乎逻辑的理解，有人可以帮我吗？

```
// heynow.js
$(document).ready(function() {

  // on the checkbox disable it right away
  $('#agree').attr('disabled', 'disabled');

  //on the terms box add a scroll function
  $('#terms').scroll(function() {  

    // textareheight equals scrollheight   not accurate
    var textareaheight = $(this).[0].scrollHeight;

    // scrollheight equals scrollheight – the innerheight  which is more accurate and dynamic
    var scrollheight = textareaheight - $(this).innerHeight();

    // scrolltop equals  scrolltop returning where are you
    var scrolltop = $(this).scrollTop();

    // if where you at equals the total height
    if (scrolltop == scrollheight) {

      // then enable the checkbox
      $('#agree').removeAttr('disabled');
    }
  });
}); 
```

* * *

```
<!-- html file -->
<p><textarea id="terms">lots of text for a scroll avail</textarea></p>
<p><input id="agree" type="checkbox" /> I Agree</p> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T09:46:29.117

这很简单。它会禁用复选框并保持这种状态，直到您向下滚动到内容的末尾。没什么特别的 :) 您可以在您必须在接受许可证之前阅读许可证的页面上看到它。

# android - 将日期转换为年和月

> ID：14080417
> 
> 赞同：0
> 
> 时间：2012-12-29T09:37:15.957
> 
> 标签：android, date

我正在编写一个必须显示日期的应用程序。现在我想将该日期从当前日期转换为年和月。

**我的日期就像 - 2017 年 3 月 29 日。**

我想将此日期转换为年和月。

抱歉，我认为您无法理解我的问题。我想要年份和月份中当前日期和以上日期的差异。

对不起我的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:40:47.990

您可以使用[Joda](http://joda-time.sf.net/) Time 并使用月和年作为单位计算两个 LocalDate 值（这是您在此处得到的）之间的 Period 。

例子

```
LocalDate dob = new LocalDate(1992, 12, 30);
        LocalDate date = new LocalDate(2010, 12, 29);

        Period period = new Period(dob, date, PeriodType.yearMonthDay());
        System.out.println(period.getYears() + " years and " +
                           period.getMonths() + " months"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:00:05.410

我使用 Calender class 找到了答案。

首先，我找到了两天之间的差异，并使用那几天我找到了年份和月份。

在这里我发布我的代码，我认为这对其他人有帮助。

```
int days = Integer.parseInt(Utility.getDateDiffString("29/03/2017"));
int years = days/365;
int remainingDays = days - (365*years);
int months = remainingDays/30; 
```

**getDateDiffString() 方法。在这种方法中，我们需要传递结束日期**

```
public static String getDateDiffString(String endDate)
    {
        try
        {
            Calendar cal = Calendar.getInstance();

            SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
            Date dateTwo = dateFormat.parse(endDate); 

            long timeOne = cal.getTimeInMillis();
            long timeTwo = dateTwo.getTime();
            long oneDay = 1000 * 60 * 60 * 24;
            long delta = (timeTwo - timeOne) / oneDay;

            if (delta > 0) {
                return "" + delta + "";
            }
            else {
                delta *= -1;
                return "" + delta + "";
            }
        }
        catch (Exception e) 
        {
            e.printStackTrace();
        }
        return "";
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:38:28.753

使用 Java [Calendar](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html)类从日期获取年份

```
Calendar c=Calendar.getInstance();
SimpleDateFormat simpleDateformat=new SimpleDateFormat("yyyy MMM");
System.out.println(simpleDateformat.format(c.getTime()));

To get difference between two date

int diffInDays = (int)( (newerDate.getTime() - olderDate.getTime()) 
                 / (1000 * 60 * 60 * 24) ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T09:40:38.143

long timeDiff = (d1.getTime() - d2.getTime());

```
 String diff=String.format("%d year(s) %d day(s) %d hour(s) %d min(s) %d sec(s)",(TimeUnit.MILLISECONDS.toDays(timeDiff)/365),TimeUnit.MILLISECONDS.toDays(timeDiff)%365,
            TimeUnit.MILLISECONDS.toHours(timeDiff)
            - TimeUnit.DAYS.toHours(TimeUnit.MILLISECONDS
            .toDays(timeDiff)),
            TimeUnit.MILLISECONDS.toMinutes(timeDiff)
            - TimeUnit.HOURS.toMinutes(TimeUnit.MILLISECONDS
            .toHours(timeDiff)),
            TimeUnit.MILLISECONDS.toSeconds(timeDiff)
            - TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS
            .toMinutes(timeDiff)));
    System.out.println(diff); 
```

在 d1 & d2 在这里指定正确的日期。然后你会得到正确的答案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T09:43:32.750

如果您的日期格式是固定的，您可以这样做：

字符串 myDate = "29/03/2017";

字符串 newDate = myDate.subString(6, 10) + "-" + myDate.subString(3, 5)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T09:45:15.197

此方法将普通字符串转换为日期格式

```
String currentDateString = "02/27/2012 17:00:00";
SimpleDateFormat sd = new SimpleDateFormat("mm/dd/yyyy HH:mm:ss");
Date currentDate = sd.parse(currentDateString); 
```

之后你得到正式的方法

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-29T09:46:19.083

你应该使用[SimpleDateFormate](http://developer.android.com/reference/java/text/SimpleDateFormat.html)！

例如：---您可以根据需要获取时间和日期：-

```
 Date email_date = m.getSentDate();// this is date which you are getting
            DateFormat date = new SimpleDateFormat("EEE MMM yyyy");
            DateFormat time = new SimpleDateFormat("hh:mm aa");
            String date_str=date.format(email_date);
            String time_str=time.format(email_date); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-04T15:46:40.500

首先将您的日期放入一个字符串变量中：

```
String dateToConvert = "29/03/2017"; 
```

将日历实例化为：

```
Calendar convertedDate = Calendar.getInstance(); 
```

将该日期设置为日历

```
convertedDate.set(dateToConvert);<br/> 
```

然后使用这一行：

```
String datePicked = DateFormat.getDateInstance().format(convertedDate.getTime()); 
```

输出：2017 年 3 月 29 日

# cakephp - 翻译网络应用程序的简单方法。[蛋糕_php]

> ID：14080418
> 
> 赞同：-3
> 
> 时间：2012-12-29T09:37:16.630
> 
> 标签：cakephp, localization

我正在编写一个基于网络的电脑游戏（主要是 cakephp，一些 js 仅用于 ui）。我需要用其他语言设置另一个实例，为此我需要翻译。我逐行翻译了整个项目，但这会在错误修复期间产生问题，而且两个版本都需要单独的 svn repo。我不想使用 gettext，因为我的服务器资源非常有限，而且我不想在执行期间实时执行此操作。无论如何，它们都是单独的实例，所以我需要一个解析器，它可以根据文件的翻译生成模板项目的副本。否则我将不得不自己写。有人知道这样的程序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T12:01:55.137

看起来您没有阅读 cakephp 手册上的[国际化和本地化](http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html)章节。

# c++ - 用于 lambda 和函数的通用类型转换，以供稍后引用

> ID：14080423
> 
> 赞同：2
> 
> 时间：2012-12-29T09:37:48.860
> 
> 标签：c++, c++11, lambda

为什么第二个例子不起作用？有没有办法让第二个示例工作，同时仍然将 lambda 或函数类型转换为介质以供以后参考？

```
// Types I'm using
typedef void (*ANY_FUNC)(...);
typedef void (*VOID_FUNC)(); 
```

**这有效**

```
void call_void( VOID_FUNC func) {
    ((ANY_FUNC)func)();
};

// ...

call_void([]() { /* do something */ }); 
```

**这不**

```
template <typename fn>
void call_any( fn func ) {
    ((ANY_FUNC)func)();
};

// ...

call_any([]() { /* do something */ }); 
```

请忽略这样一个事实，即您永远不需要使用第二个示例。它仅用于演示（相对代码）。

*这两个示例都使用函数指针而不是 lambda。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:22:27.957

[只要您声明一个模板，您就可以直接使用传入的函数对象](http://www.google.com/webhp?q=sfinae)。此外，您应该将函数参数声明为引用而不是按值：

```
template <typename fn>
void call_any(fn&& func) {
    func();
}; 
```

如果你想用参数调用一个函数，你可以这样做：

```
template <typename fn, typename... Args>
void call_any_many(fn&& func, Args&&... args) {
    func(std::forward<Args>(args)...);
}; 
```

使用示例：

```
int main ()
{
    call_void([]() { std::cout << "Hello, void World!" << std::endl; });
    call_any([]() { std::cout << "Hello, any World!" << std::endl; });
    call_any_many([](int x) { std::cout << "Hello, any many World-" << x << "!" << std::endl; }, 1234);

    return 0;
} 
```

但是如果你的意图是存储一些函数指针而不是直接调用它们，我建议使用`std::function`from `<functional>`header。您可以从这里查看一些信息和示例：http: [//en.cppreference.com/w/cpp/utility/functional/function](http://en.cppreference.com/w/cpp/utility/functional/function)

例如：

```
#include <iostream>
#include <functional>

int main ()
{
    std::function<void()> anyf = []() { std::cout << "Hello, any World!" << std::endl; };
    std::function<void(int)> intf = [](int x) { std::cout << "Hello, any many World-" << x << "!" << std::endl; };

    anyf();
    intf(1234);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:51:03.127

我认为它们中的任何一个都不能*真正*起作用，除非在某些编译器上是偶然的。

与 lambda 的区别在于它可以转换为函数指针，但它不是一个。模板版本会注意到这种差异，并且`fn`不会被推断为`VOID_FUNC`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:59:52.720

Lambda 可以隐式转换为函数指针（但前提是它们不捕获任何内容），因此只需将 call_any 的参数更改为函数指针：

```
void call_any(ANY_FUNC func)
{
    (*func)();
} 
```

您需要使用适当类型的 lambda 调用它：

```
call_any([](...) { /* ... */ }); 
```

但是可变长度参数列表（又名 varargs）很糟糕，因为它们是非类型安全的。与函数指针相同：它们是非面向对象的。您应该考虑一种替代机制，可能涉及可变参数模板和多态性（虚拟方法）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T10:03:13.347

第一个是将 lambda 转换为具有相应参数和返回类型的函数指针，然后将其转换为 vararg 函数，而第二个是尝试将 lambda 直接转换为 vararg 函数（即，没有相应参数类型的函数）。

第一个示例中的两次转换是允许的*，但第二个示例中的一次转换是不允许的。

***请注意，用于在函数指针类型之间转换的强制转换符号最终会像`reinterpret_cast`以下状态一样工作：“函数指针可以显式转换为不同类型的函数指针。通过指向函数的指针调用函数的效果与函数定义中使用的类型不同的类型（8.3.5）未定义。” 因此，第一个示例代码具有未定义的行为。

# ruby-on-rails - 关联访问列值栏

> ID：14080425
> 
> 赞同：0
> 
> 时间：2012-12-29T09:38:20.173
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, model-associations

我有一个客户和发票模型。一个客户有很多发票，一张发票属于一个客户。一张发票有很多发票项目，发票项目属于一个发票

```
class Customer < ActiveRecord::Base
 attr_accessible :billing_address, :customer_currency, :email, :first_name, :last_name,    :mobile, :name, :payment_terms, :phase_type, :pays_vat
 validates_presence_of :first_name, :last_name, :mobile, :billing_address, :payment_terms,    :phase_type, :customer_currency

has_many :invoices

validates :email, 
    :presence => true,
    :uniqueness => true, 
    :email_format => true
validates :name, :mobile, :presence => true, :uniqueness => true
end 
```

发票型号

```
class Invoice < ActiveRecord::Base
 belongs_to :customer
 attr_accessible :approved_by, :due_date, :invoice_date, :terms, :customer_id, :customer

 validates :invoice_date, presence: true
 validates :due_date, presence: true
 validates :customer, presence: true
 has_many :invoice_items
 accepts_nested_attributes_for :invoice_items
end 
```

发票项目模型

```
class InvoiceItem < ActiveRecord::Base
 belongs_to :invoice
 attr_accessible :amount, :description, :rate, :tax_amount
end 
```

我为发票创建了一个索引页面，我想在其中列出所有发票及其相应的项目，但是我面临的挑战是如何访问发票项目中的金额并将其显示在索引页面中

应用程序/视图/index.html.erb

```
<div class="row">
<div class="span12">
<table class="table table-striped">
<thead>
<tr>
  <th>Invoice ID </th>
  <th>Customer Name </th>
  <th>Invoice Date </th>
  <th>Amount</th>
</tr>
</thead>
<tbody>
<% @invoices.each do |invoice| %>
  <tr>
    <td><%= link_to invoice.id, invoice_path(invoice) %></td>
    <td><%= invoice.customer.name %></td>
    <td><%= invoice.invoice_date %></td>
    <td><%= invoice.invoice_items.amount %></td>
  </tr>
<% end %>
</tbody>
</table>
<div class="form actions">
<p>
    <%= link_to t('.new', :default => t("helpers.links.new")),
                new_invoice_path, :class => 'btn btn-primary' %>
</p>
</div>  
 </div>
</div> 
```

invoice.invoice_items.amount 不会从该发票的 Invoice_items 返回该金额。有任何想法吗？

下面是我的 Invoices_controller 索引方法

```
class InvoicesController < ApplicationController
before_filter :authenticate_user!

 def index
  @invoices = Invoice.includes(:customer, :invoice_items).all
 end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:08:31.393

您可以使用
`invoice.invoice_items.count`
或获取任何元素的数量
`invoice.invoice_items.size`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:48:19.333

也迭代`invoice_items`，在`@invoices`迭代器内部

```
<% @invoices.each do |invoice| %>
  <tr>
    <td><%= link_to invoice.id, invoice_path(invoice) %></td>
    <td><%= invoice.customer.name %></td>
    <td><%= invoice.invoice_date %></td>

    <% invoice.invoice_items.each do |invoice_item| %>
      <td><%= invoice_item.rate %></td>
      <td><%= invoice_item.amount %></td>
  </tr>
<% end %> 
```

调整表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:39:26.790

```
invoice.invoice_items.first.amount 
```

# sql-server - SQL: Msg 116, Level 16, State 1, Line 1 不带EXISTS引入子查询时，选择列表中只能指定一个表达式

> ID：14080428
> 
> 赞同：0
> 
> 时间：2012-12-29T09:38:44.153
> 
> 标签：sql-server, tsql, select

请帮助我如何解决此问题

> *Msg 116, Level 16, State 1, Line 1
> 当子查询没有用 EXISTS 引入时，只能在选择列表中指定一个表达式。*

这是我的查询

```
SELECT  a.RegId,
        a.PropertyThumbnail
FROM    tblPropertyDetail a
WHERE   a.RegId NOT IN 
        (
            SELECT  RegId,
                    COUNT(RegId) AS NumOccurrences
            FROM tblPropertyDetail
            GROUP BY RegId
            HAVING (COUNT(RegId) > 1)
        ) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T09:39:29.580

在子查询中删除此列`COUNT(RegId) AS NumOccurrences`

```
SELECT a.RegId,
        a.PropertyThumbnail
FROM tblPropertyDetail a
WHERE a.RegId NOT IN (
                SELECT RegId
                FROM tblPropertyDetail
                GROUP BY RegId
                HAVING (COUNT(RegId) > 1)
                ) 
```

使用时`NOT IN`，预计子查询返回的列数只有一。

或者，您也可以使用`JOIN`

```
SELECT  a.RegId,
        a.PropertyThumbnail
FROM    tblPropertyDetail a
        LEFT JOIN
        (
            SELECT RegId, COUNT(RegId) AS NumOccurrences
            FROM tblPropertyDetail
            GROUP BY RegId
            HAVING (COUNT(RegId) > 1)
        ) b ON a.RegId = b.RegId
WHERE   b.RegId IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:16:22.357

在 SQLServer2005+ 中使用 CTE 和聚合窗口函数

```
;WITH cte AS
 (
  SELECT RegId, PropertyThumbnail, COUNT(*) OVER (PARTITION BY RegId) AS cnt
  FROM tblPropertyDetail
  )
  SELECT RegId, PropertyThumbnail
  FROM cte
  WHERE cnt <= 1 
```

# javascript - 将 div 元素添加到我的页面时，所有其他可拖动项目都会移动吗？

> ID：14080429
> 
> 赞同：1
> 
> 时间：2012-12-29T09:38:49.607
> 
> 标签：javascript, jquery

为什么这种情况不断发生？

我添加了一个可拖动元素，将其移动到位，然后将所有内容预先放置并向下移动或使页面变大？有没有办法让 div 出现在同一个地方而不移动页面上的其他元素？这真让我抓狂！

* * *

**HTML：**

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>draggable demo</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
<link rel="stylesheet" href="stylesheet.css">

<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script src="script.js"></script>
</head>
<body>

<h2></h2>
    <form name="checkListForm">
        <input type="text" name="checkListItem"/>
    </form>
    <div id="button">Add!</div>
    <br/>
<table><tr><td id="place"></td></tr></table>

 </body>
</html> 
```

* * *

**JavaScript：**

```
$(document).ready(function()
{
 //$( '#draggable' ).draggable();
 $('#button').click(function()
 {
     var toAdd = $('input[name=checkListItem]').val();
     var $newdiv = "<div id='draggable'>" + toAdd + "</div>";
     //$("#place").html($($newdiv).draggable());

     $("#place").prepend($($newdiv).draggable());
 });

}); 
```

* * *

**CSS：**

```
#draggable {
 z-index:1;
 width: 100px;
 height: 100px;
 background: #ccc;
}

h2 {
 font-family:arial;
}

form {
 display: inline-block;
}

#button{
 display:inline-block;
 height:20px;
 width:70px;
 background-color:#cc0000;
 font-family:arial;
 font-weight:bold;
 color:#ffffff;
 border-radius: 5px;
 text-align:center;
 margin-top:2px;
}

#item {
 font-family:garamond;
 color:#000000;
 width:90%;
 height:800px;
 background-color:#cc0000;
}

#place {
 z-index:1;
 font-family:garamond;
 color:#000;
 width:800px;
 height:800px;
 background-color:#f00;
} 
```

提前加油！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:01:52.153

这是完整的工作代码：jsFiddle：http: [//jsfiddle.net/ycgmt/](http://jsfiddle.net/ycgmt/)

**变化：**

1: <div> 而不是 <table>

2: append() 而不是 prepend()

3：类而不是id

4：位置：绝对

* * *

**HTML**

```
<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>draggable demo</title>

<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
</head>

<body>
    <h2></h2>
    <form name="checkListForm">
        <input type="text" name="checkListItem"/>
    </form>
    <div id="button">Add!</div>
    <br/>

    <div id="place"></div>

</body>
</html> 
```

**CSS**

```
.draggable {
     width: 100px;
     height: 100px;
     background: #ccc;
     position:absolute;
}

h2 {
    font-family:arial;
}

form {
    display: inline-block;
}

#button{
     display:inline-block;
     height:20px;
     width:70px;
     background-color:#cc0000;
     font-family:arial;
     font-weight:bold;
     color:#ffffff;
     border-radius: 5px;
     text-align:center;
     margin-top:2px;
}

#item {
     font-family:garamond;
     color:#000000;
     width:90%;
     height:800px;
     background-color:#cc0000;
}

#place {
     z-index:1;
     font-family:garamond;
     color:#000;
     width:800px;
     height:800px;
     background-color:#f00;
} 
```

**JS**

```
$(document).ready(function()
{
     $('#button').click(function()
     {
         var toAdd = $('input[name=checkListItem]').val();
         var newdiv = $("<div class='draggable'>" + toAdd + "</div>");

         $("#place").append(newdiv);

         $(newdiv).draggable();
     });
}); 
```

# django - GAE上的Django 1.4：sqlite“ImportError：无法导入名称工具”

> ID：14080430
> 
> 赞同：3
> 
> 时间：2012-12-29T09:38:58.397
> 
> 标签：django, google-app-engine, sqlite, django-1.4

我正在尝试在 Python 2.7 上的 Google App Engine 1.7.4 上的 Django 1.4 上获得 sqlite3 支持。

我摆弄了“Google Cloud SQL”数据库后端，一切都运行良好（syncdb、插入/更新/删除，...）。

但是后来我启用了 sqlite（因为在本地主机上 Google Cloud SQL 很慢）：

```
import os
if (os.getenv('SERVER_SOFTWARE', '').startswith('Google App Engine') or
    os.getenv('SETTINGS_MODE') == 'pushtolive'):
    # Running on production App Engine, so use a Google Cloud SQL database.
    DATABASES = {
        'default': {
            'ENGINE': 'google.appengine.ext.django.backends.rdbms',
            'INSTANCE': 'xyz:xyz',
            'NAME': 'my_database',
        }
    }
else:
    # Running in development, so use a local SQLite database
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': '/tmp/mysite.db',
        }
    } 
```

当我打开任何 url（例如 127.0.0.1:8080）时，我就会遇到[这个可怕的堆栈跟踪](https://gist.github.com/raw/4405464/76f6a6c31fb56d54bc8e9668ddea40d508ea714c/sqlite.traceback)。我剥离了堆栈跟踪，使其更具可读性：

```
ERROR    2012-12-29 09:07:06,223 base.py:215] Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "/Users/philipp/python/mysite/urls.py", line 4, in <module>
    from django.contrib import admin
  File ".../google_appengine/lib/django_1_4/django/contrib/admin/__init__.py", line 3, in <module>
    from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
  File ".../google_appengine/lib/django_1_4/django/contrib/admin/helpers.py", line 2, in <module>
    from django.contrib.admin.util import (flatten_fieldsets, lookup_field,
  File ".../google_appengine/lib/django_1_4/django/contrib/admin/util.py", line 1, in <module>
    from django.db import models
  File ".../google_appengine/lib/django_1_4/django/db/__init__.py", line 40, in <module>
    backend = load_backend(connection.settings_dict['ENGINE'])
  File ".../google_appengine/lib/django_1_4/django/db/__init__.py", line 34, in __getattr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)
  File ".../google_appengine/lib/django_1_4/django/db/utils.py", line 92, in __getitem__
    backend = load_backend(db['ENGINE'])
  File ".../google_appengine/lib/django_1_4/django/db/utils.py", line 24, in load_backend
    return import_module('.base', backend_name)
  File ".../google_appengine/lib/django_1_4/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File ".../google_appengine/lib/django_1_4/django/db/backends/sqlite3/base.py", line 14, in <module>
    from django.db import utils
ImportError: cannot import name utils 
```

从堆栈跟踪中我读到执行运行到`django.db.utils`模块，然后进入`django.db.backends.sqlite3.base`，然后它尝试`django.db.utils`再次跳转，但随后奇怪地失败了。

问题似乎出在 GAE 环境中，因为它有效：

```
python mysite/manage.py syncdb 
```

这也是：

```
python mysite/manage.py shell
>>> from django.contrib.auth.models import User
>>> u = User(username="hans")
>>> u.save()
>>> User.objects.all()
[<User: hans>] 
```

**到目前为止我尝试了什么：**

*   从/到 Django 1.3/1.4 切换
*   [卸载GAE](https://stackoverflow.com/questions/9189054/how-do-i-uninstall-google-app-engine-sdk#answer-14081488)，重新安装
*   我尝试了谷歌为“django.db import utils 中的 ImportError”揭示的所有解决方案
*   有[这个类似的问题](https://stackoverflow.com/questions/7866256)。我尝试执行问题中的语句，但没有遇到问题。

我在 OS X 10.8.2 我的 PYTHONPATH 是`:/usr/local/google_appengine:/usr/local/google_appengine/lib/django_1_4`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T09:56:06.420

由于[在 dev 中使用 sqlite 和在生产中使用 mysql（Cloud SQL 使用）不是一个好习惯，](https://stackoverflow.com/questions/2306048/django-sqlite-for-dev-mysql-for-prod)我不向任何人推荐这种设置。

然后，有一个选项：这用于在使用 Google 数据*存储*`--use_sqlite`时加快开发速度。Cloud SQL 没有类似的选项。

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T13:05:31.467

这可以通过附加`_sqlite3`到`_WHITE_LIST_C_MODULES`in将 sqlite3 模块列入白名单来解决`/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py`。

请注意，您需要在应用引擎启动器中选择“制作符号链接...”才能从`/usr/local`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:30:15.703

在最新版本的 SDK 中，您可以通过添加在沙箱中启用 sqlite3 模块

```
'sqlite3' in name.lower() 
```

在 google-app-engine/google/appengine/tools/devappserver2/python/sandbox.py 的 _should_keep_module 函数中（第 195 行左右）*

# android - requestLocationUpdates 在位置更改实际上增加了一次时调用了很多次

> ID：14080431
> 
> 赞同：1
> 
> 时间：2012-12-29T09:39:07.710
> 
> 标签：android

我正在发送纬度，经度和位置名称以保存在服务器上....问题是当我第一次运行我的应用程序时它可以并保存一次以上数据...当我关闭我的应用程序并且模拟器正在运行并且日食也并再次启动我的应用程序，然后将上述数据保存 2 次.....同样，当我关闭并重新启动我的应用程序时，它增加 1...我不知道为什么它会`requestLocationUpdates()`多次调用...没有发送到服务器它工作正常..有关此的任何想法请帮助我...

向服务器发送数据.. 这个函数在 send.java 类中实现

```
public String postData(List<? extends NameValuePair> nameValuePairs, String wurl){

     // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(wurl); 
    try {

        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        InputStream is = response.getEntity().getContent();
        BufferedInputStream bis = new BufferedInputStream(is);
        ByteArrayBuffer baf = new ByteArrayBuffer(20);
        int current = 0;
        while((current = bis.read()) != -1){
            baf.append((byte)current);
        } 
        /* Convert the Bytes read to a String. */
        text = new String(baf.toByteArray());

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
    return text;

} 
```

onlocationchaned 函数位于实现 LocationListener 并在 onlocationchanged 中调用上述函数的 location.java 类中

```
public void onLocationChanged(android.location.Location loc) {

    String response;
    latitude = loc.getLatitude();
    longitude = loc.getLongitude();

    // Changing type double to string for sending 
    lati = Double.toString(latitude);
    logi = Double.toString(longitude);

        String Text = "My current location is: " + 
                  " Latitude = " + Location.lati + 
                  " Longitude = "+ Location.logi;
        Toast.makeText(c,  Text , Toast.LENGTH_LONG).show();
        Log.d("lat", "Changed");

        locationName = getAddress(latitude, longitude);

        // Add location related data
        List<BasicNameValuePair> locationNameValuePair = new ArrayList<BasicNameValuePair>(4);
        locationNameValuePair.add(new BasicNameValuePair("latitude", lati));
        locationNameValuePair.add(new BasicNameValuePair("longitude", logi));
        locationNameValuePair.add(new BasicNameValuePair("locName", locationName));

        response = con.postData(locationNameValuePair, wurl);
        Toast.makeText(c, response, Toast.LENGTH_LONG).show();

        Log.v("IGA", "Address " + locationName);
        Toast.makeText(c, locationName, Toast.LENGTH_LONG).show();
}

 public String getAddress(double lat, double lng) {
    Geocoder geocoder = new Geocoder(c, Locale.getDefault());
    try {
        List<Address> addresses = geocoder.getFromLocation(lat, lng, 1);
        Address obj = addresses.get(0);
        //String add = obj.getAddressLine(0);
        String add = obj.getThoroughfare();
        add = add + ", " + obj.getSubLocality();
        add = add + ", " + obj.getLocality();
        add = add + ", " + obj.getCountryName();

         return add;

    } catch (IOException e) {
        e.printStackTrace();
        Toast.makeText(c, e.getMessage(), Toast.LENGTH_LONG).show();
    } catch (IndexOutOfBoundsException e) {
        e.printStackTrace();
        Toast.makeText(c, e.getMessage(), Toast.LENGTH_LONG).show();
    }
    return "";
} 
```

和扩展 MapActivity 的 mainavtivity 中的 locationManager

```
 protected void onCreate(Bundle savedInstanceState) {

        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
        StrictMode.setThreadPolicy(policy);

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        MapView view = (MapView) findViewById(R.id.themap);
        view.setBuiltInZoomControls(true);

        LocationManager mlocManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        Location mylocation = new Location(MainActivity.this);
        mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mylocation);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:18:24.010

```
mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mylocation); 
```

如果您想确保 1000 毫秒已经过去并且客户端在位置更新之间移动了 5 米，则应该如下所示

```
LocationListener customLocationListener = new CustomLocationListener();
mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 5, customLocationListener); 
```

此外，在您的活动中 onPause() 方法调用

```
mlocManager .removeUpdates(customLocationListener); 
```

您必须像下面那样实现 CustomLocationListener：

```
private class CustomeLocationListener implements LocationListener
{
    @Override
    public void onLocationChanged(Location loc)
    {
        // when location changes, add the record in the database, send to server etc...
        double lat = loc.getLatitude();
        double lon = loc.getLongitude();
    }

    @Override
    public void onProviderDisabled(String provider)
    {}

    @Override
    public void onProviderEnabled(String provider)
    {}

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras)
    {}
} 
```

# ruby-on-rails - 如何使第 0 列的最小值（或防止 decrement_counter 设置负值）？

> ID：14080437
> 
> 赞同：0
> 
> 时间：2012-12-29T09:40:14.287
> 
> 标签：ruby-on-rails

我有一个标签模型，`posts_count`其中有一列用作标签具有的帖子数量的计数器缓存：

**架构.rb：**

```
 t.integer  "posts_count", :default => 0, :null => false 
```

**标记.rb：**

```
 def decrement_tag_counter_cache
    Tag.decrement_counter(:posts_count, self.tag.id) if !post.published? || post.decrement_tag_counters? 
  end 
```

**post.rb:**

```
 after_save :increment_decrement_tag_counters # covers :save, :create, :update methods

  def increment_tag_counters? # if status changes and the previous status wasn't "Published"
    status_changed? && changed_attributes["status"] != "Published"
  end

  def decrement_tag_counters? # if status changes and the previous status was "Published"
    status_changed? && changed_attributes["status"] == "Published"
  end

  def increment_decrement_tag_counters
    if published? && increment_tag_counters?
      taggings.each { |tagging| tagging.increment_tag_counter_cache }
    elsif decrement_tag_counters?
      taggings.each { |tagging| tagging.decrement_tag_counter_cache }
    end
  end 
```

现在的问题是，有时该`decrement_tag_counter_cache`方法会`posts_count`变为负数（例如-1）。

有没有办法告诉 Rails：使最小值为`posts_count`0？因此，如果当前值为 0 并且计数器递减，`posts_count`仍将保持为 0？我可以做的另一件事是防止`decrement_counter`设置负值。那可能吗？

（这不应该作为验证，而是作为默认行为，因为我不希望出现错误。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:49:29.133

您可以对 posts_count 进行验证，如下所示

```
validates :posts_count, :numericality => { :greater_than_or_equal_to => 0 } 
```

或者你可以做这样的事情

```
before_save :set_posts_count

def set_posts_count
  posts_count = 0 if posts_count < 0
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-11T04:05:27.920

问题可能会出现，因为据我所知，这种方法没有初始化模型实例，所以它发送一个像这样的直接 sql 查询：

```
UPDATE "Tags" SET "posts_counter" = COALESCE("posts_counter", 0) - 1 WHERE "Tags"."id" = 5 
```

如果是这样，我不知道如何解决这个问题，可能你可以用锁初始化模型实例然后递减计数器，但是锁有它的缺点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-25T21:45:20.070

你可以做这样的事情

```
[posts_count, 0].max 
```

# c - gcc 应该能够找到它安装的头文件吗？

> ID：14080446
> 
> 赞同：5
> 
> 时间：2012-12-29T09:40:59.223
> 
> 标签：c, gcc

我遇到了一个问题，似乎是由于 gcc 没有找到它附带的标头引起的。对 C/GCC 不太了解，我想我会检查编译器应该始终能够找到这些头文件是否是一个安全的假设。也许设置 -I 参数会覆盖这个？还是其他时髦的东西？

最初的问题是在github 上的[鞋子上的这个问题。](https://github.com/shoes/shoes/issues/216#issuecomment-11750784)

## 原始问题

> 你好 ！我尝试在 10.8 上构建，如另一个问题中所述，使用非 llvm gcc，并通过稍微调整 rakefile 以在正确的位置获取正确的 sdk。
> 
> 但
> 
> 它仍然无法编译。
> 
> 这是错误报告的开头（真的很长）
> 
> ```
>  new-host-2:shoes benjamingattet$ rake
>  gcc -I. -c -o shoes/app.o -Wall -I/usr/local/include -I/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/x86_64-darwin12.0.0 -I/usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1 -I/usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/x86_64-darwin12.0.0 -O -DRUBY_1_9 -DSHOES_QUARTZ -Wall -Wstrict-prototypes -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -fpascal-strings -Os -w -pipe -march=core2 -msse4.1 -mmacosx-version-min=10.8 -fno-common -x objective-c -fobjc-exceptions -isysroot /Developer/SDKs/MacOSX10.8.sdk -arch x86_64 shoes/app.c
>  shoes/app.c:5:18: error: glib.h: No such file or directory
>  In file included from shoes/app.c:6:
>  ./shoes/app.h:13:19: error: cairo.h: No such file or directory
>  In file included from /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby.h:32,
>  from ./shoes/app.h:14,
>  from shoes/app.c:6:
>  /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:48:21:
>  error: string.h: No such file or directory
>  /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:58:21:
>  error: stdint.h: No such file or directory
>  /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:61:23:
>  error: inttypes.h: No such file or directory
>  /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:64:20:
>  error: stdarg.h: No such file or directory
>  /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:65:19:
>  error: stdio.h: No such file or directory
>  In file included from /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:67,
>  from /usr/local/Cellar/ruby/1.9.3-p194/include/ruby-1.9.1/ruby.h:32,
>  from ./shoes/app.h:14, 
> ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T10:21:29.413

gcc 有一个它搜索的内置目录列表。像这样的文件`stddef.h`应该在这些目录之一中。获得该列表的一种方法是使用 --verbose 编译一个文件（甚至是一个空文件）。例如这里给出：

```
$ touch foo.c
$ gcc --verbose -c foo.c
Using built-in specs.
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.4.3-4ubuntu5.1' --with-bugurl=file:///usr/share/doc/gcc-4.4/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --enable-shared --enable-multiarch --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.4 --program-suffix=-4.4 --enable-nls --enable-clocale=gnu --enable-libstdcxx-debug --enable-plugin --enable-objc-gc --disable-werror --with-arch-32=i486 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5.1) 
COLLECT_GCC_OPTIONS='-v' '-c' '-mtune=generic'
 /usr/lib/gcc/x86_64-linux-gnu/4.4.3/cc1 -quiet -v foo.c -D_FORTIFY_SOURCE=2 -quiet -dumpbase foo.c -mtune=generic -auxbase foo -version -fstack-protector -o /tmp/cc2QEK5o.s
GNU C (Ubuntu 4.4.3-4ubuntu5.1) version 4.4.3 (x86_64-linux-gnu)
    compiled by GNU C version 4.4.3, GMP version 4.3.2, MPFR version 2.4.2-p1.
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
ignoring nonexistent directory "/usr/local/include/x86_64-linux-gnu"
ignoring nonexistent directory "/usr/lib/gcc/x86_64-linux-gnu/4.4.3/../../../../x86_64-linux-gnu/include"
ignoring nonexistent directory "/usr/include/x86_64-linux-gnu"
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/lib/gcc/x86_64-linux-gnu/4.4.3/include
 /usr/lib/gcc/x86_64-linux-gnu/4.4.3/include-fixed
 /usr/include
End of search list.
GNU C (Ubuntu 4.4.3-4ubuntu5.1) version 4.4.3 (x86_64-linux-gnu)
    compiled by GNU C version 4.4.3, GMP version 4.3.2, MPFR version 2.4.2-p1.
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
Compiler executable checksum: 462394bb0ac77cba16b6fb6b32589358
COLLECT_GCC_OPTIONS='-v' '-c' '-mtune=generic'
 as -V -Qy -o foo.o /tmp/cc2QEK5o.s
GNU assembler version 2.20.1 (x86_64-linux-gnu) using BFD version (GNU Binutils for Ubuntu) 2.20.1-system.20100303
COMPILER_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/
LIBRARY_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/../../../../lib/:/lib/../lib/:/usr/lib/../lib/:/usr/lib/gcc/x86_64-linux-gnu/4.4.3/../../../:/lib/:/usr/lib/:/usr/lib/x86_64-linux-gnu/
COLLECT_GCC_OPTIONS='-v' '-c' '-mtune=generic' 
```

你感兴趣的部分是

```
ignoring nonexistent directory "/usr/local/include/x86_64-linux-gnu"
ignoring nonexistent directory "/usr/lib/gcc/x86_64-linux-gnu/4.4.3/../../../../x86_64-linux-gnu/include"
ignoring nonexistent directory "/usr/include/x86_64-linux-gnu"
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/lib/gcc/x86_64-linux-gnu/4.4.3/include
 /usr/lib/gcc/x86_64-linux-gnu/4.4.3/include-fixed
 /usr/include
End of search list. 
```

您可以在其中看到内置路径有一些不存在的目录，然后是两种包含指令的现有目录列表。

如果 gcc 已安装在编译它的位置以外的其他位置，则它曾经有问题。但是 ISTR 认为最近的 gcc 在这些情况下更加健壮，并且从可执行路径开始。

至少您知道 gcc 在哪里寻找文件，并且您可能会尝试了解它们为什么不在那里。

请注意，gcc 没有附带完整的 C 库，仅提供了一些与实现紧密相关的头文件，例如`stddef.h`和`stdarg.h`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:50:07.197

这些文件不随 GCC 一起提供。

您似乎缺少提供这些标头的相关包，例如 glib2-devel 和 glibc-devel（或 Max OS X 使用的任何包命名约定），或者您没有将标头放在您`/Developer/SDKs/MacOSX10.8.sdk`指定的目录下和`-isysroot`

该`-isysroot`标志将阻止编译器`/usr/include`像往常一样查看，因此不会找到下面的标题。你确定你应该使用`-isysroot`吗？如果您确实需要，那么您需要采取额外的步骤来允许找到该目录之外的标头，例如`-I /usr/include`

# android - Android：注册用户时，在 JSON 解析期间 Asyctask 不起作用

> ID：14080447
> 
> 赞同：1
> 
> 时间：2012-12-29T09:40:58.927
> 
> 标签：android, json, android-asynctask

> **可能重复：**
> [android - 引起：android.view.ViewRootImpl$CalledFromWrongThreadException](https://stackoverflow.com/questions/11204079/android-caused-by-android-view-viewrootimplcalledfromwrongthreadexception)

我正在使用此示例[http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)当我在注册表中注册我的详细信息时，它将数据保存在数据库但应用程序崩溃它给出以下错误

```
Caused by: android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

我的注册码如下

注册.java

```
import org.json.JSONException;
import org.json.JSONObject;

import com.example.petencare.library.JSONParser;
import com.example.petencare.library.DatabaseHandler;
import com.example.petencare.library.UserFunctions;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;

import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.util.Log;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

/**
 * Handles the user registration activity.
 * 
 */
public class Register extends Activity {

    JSONParser jsonParser = new JSONParser();
    private EditText newUsername;
    private EditText newPassword;
    private EditText newConfiPass;
    private EditText newName;
    private EditText newPhone;
    private TextView Alreadyuser;
    private Button registerButton;
    private TextView registerErrorMsg;
    private ProgressDialog pDialog;

    // JSON Response node names
    private static String KEY_SUCCESS = "success";
    private static String KEY_ERROR = "error";
    private static String KEY_ERROR_MSG = "error_msg";
    private static String KEY_UID = "uid";
    private static String KEY_EMAIL = "email";
    private static String KEY_NAME = "name";
    private static String KEY_MOBILE = "mobile";
    private static String KEY_CREATED_AT = "created_at";

     @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.registration);

            newUsername = (EditText) findViewById(R.id.reg_email);
            newPassword = (EditText) findViewById(R.id.reg_pass);
            newConfiPass = (EditText) findViewById(R.id.reg_passre);
            newName      =(EditText)findViewById(R.id.reg_name);
            newPhone      =(EditText)findViewById(R.id.reg_mobile);
            registerButton = (Button) findViewById(R.id.btnRegister);
            Alreadyuser =    (TextView)findViewById(R.id.link_to_login);
            registerErrorMsg= (TextView)findViewById(R.id.register_error);

            Alreadyuser.setOnClickListener(new TextView.OnClickListener(){ 
                public void onClick (View v){ 
                    Intent i = new Intent(v.getContext(), Login.class);
                    startActivity(i);
                    // Close Registration View

                    finish();
                }
            });

            registerButton.setOnClickListener(new View.OnClickListener() { 
                public void onClick (View view){ 

                new Registeruser().execute();

                }

            });

     }

            class Registeruser extends AsyncTask<String, String, String> {

                @Override
                protected void onPreExecute() {
                    super.onPreExecute();
                    pDialog = new ProgressDialog(Register.this);
                    pDialog.setMessage("Registering. Please wait...");
                    pDialog.setIndeterminate(false);
                    pDialog.setCancelable(false);
                    pDialog.show();

                }

            protected  String doInBackground(String... args) {
                    //Get user details. 
            String email = newUsername.getText().toString();
            String password = newPassword.getText().toString();
            String confirmpassword = newConfiPass.getText().toString();
            String name=           newName.getText().toString();
            String mobile =   newPhone.getText().toString();

            //Check if all fields have been completed.
            if (email.equals("") || password.equals("") || name.equals("") || mobile.equals("")){
                Toast.makeText(getApplicationContext(), 
                        "Please ensure all fields have been completed.",
                          Toast.LENGTH_SHORT).show();
            return null;
            }

            //Check password match. 
            if (!password.equals(confirmpassword)) {
                Toast.makeText(getApplicationContext(), 
                        "The password does not match.",
                            Toast.LENGTH_SHORT).show();
                            newPassword.setText("");
                            newConfiPass.setText("");
                return null;
            }
             UserFunctions userFunction = new UserFunctions();
             JSONObject json = userFunction.registerUser(email, password, name, mobile);

             // check for login response
             try {
                 if (json.getString(KEY_SUCCESS) != null) {
                     registerErrorMsg.setText("");
                     String res = json.getString(KEY_SUCCESS);
                     if(Integer.parseInt(res) == 1){
                         // user successfully registred
                         // Store user details in SQLite Database
                         DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                         JSONObject json_user = json.getJSONObject("user");

                         // Clear all previous data in database
                         userFunction.logoutUser(getApplicationContext());
                         db.addUser(json_user.getString(KEY_EMAIL), json_user.getString(KEY_NAME), json.getString(KEY_UID), json_user.getString(KEY_MOBILE), json_user.getString(KEY_CREATED_AT));
                         // Launch Dashboard Screen
                         Intent dashboard1 = new Intent(getApplicationContext(), MainActivity.class);
                         // Close all views before launching Dashboard
                         dashboard1.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                         startActivity(dashboard1);
                         // Close Registration Screen
                         finish();
                     }else{
                         // Error in registration
                         registerErrorMsg.setText("User already existed");
                     }
                 }
             } catch (JSONException e) {
                 e.printStackTrace();
             }  
             return null;
            }

            @Override
    protected void onPostExecute(String file_url){
        // dismiss the dialog once done
        pDialog.dismiss();

            }

     }

} 
```

我正在使用 JSON 解析来发送数据，并且我有一个 userfunction.java 类，其代码如下

```
import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;

import android.content.Context;

public class UserFunctions {

    private JSONParser jsonParser;

    // Testing in localhost using wamp or xampp
    // use http://10.0.2.2/ to connect to your localhost ie http://localhost/
    private static String loginURL = "http://www.mywebsite.com/android_login_api/";
    private static String registerURL = "http://www.mywebsite.com/android_login_api/";

    private static String login_tag = "login";
    private static String register_tag = "register";

    // constructor
    public UserFunctions(){
        jsonParser = new JSONParser();
    }

    /**
     * function make Login Request
     * @param email
     * @param password
     * */
    public JSONObject loginUser(String email, String password){
        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair("tag", login_tag));
        params.add(new BasicNameValuePair("email", email));
        params.add(new BasicNameValuePair("password", password));
        JSONObject json = jsonParser.getJSONFromUrl(loginURL, params);
        // return json
        // Log.e("JSON", json.toString());
        return json;
    }

    /**
     * function make Login Request
     * @param name
     * @param email
     * @param password
     * */
    public JSONObject registerUser(String email, String password, String name, String mobile){
        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair("tag", register_tag));
        params.add(new BasicNameValuePair("email", email));
        params.add(new BasicNameValuePair("password", password));
        params.add(new BasicNameValuePair("name", name));
        params.add(new BasicNameValuePair("mobile", mobile));

        // getting JSON Object
        JSONObject json = jsonParser.getJSONFromUrl(registerURL, params);
        // return json
        return json;
    }

    /**
     * Function get Login status
     * */
    public boolean isUserLoggedIn(Context context){
        DatabaseHandler db = new DatabaseHandler(context);
        int count = db.getRowCount();
        if(count > 0){
            // user logged in
            return true;
        }
        return false;
    }

    /**
     * Function to logout user
     * Reset Database
     * */
    public boolean logoutUser(Context context){
        DatabaseHandler db = new DatabaseHandler(context);
        db.resetTables();
        return true;
    }

} 
```

请帮助我提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:47:03.260

我收到错误

> 引起：android.view.ViewRootImpl$CalledFromWrongThreadException：只有创建视图层次结构的原始线程才能触摸其视图。

表示您正在尝试从 AsyncTask 访问`doInBackground`UI[元素](http://developer.android.com/reference/android/os/AsyncTask.html)。无法`Toast`从非 UI 线程访问 Ui 元素或 Make。

解决方案是在启动 AsyncTask 之前移动所有 EditText 验证（如代码）并使用`onPreExecute`AsyncTask 获取`EditText`值`doInBackground`，用于在执行完成`onPostExecute`时更新 Ui`doInBackground`

**编辑 ：**

如在 OP 请求中将所有验证移动到按钮内单击：

```
 registerButton.setOnClickListener(new View.OnClickListener() { 
        public void onClick (View view){ 

        //  PUT YOUR ALL VALIDATION HERE

        if(/* if validation success  */){

            // start AsyncTask here
            new Registeruser().execute();
         }
         else{
                // show validation error here
          }
        }

    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T09:46:08.710

尝试`Toasts`在 doInBackground() 方法中删除。当您访问 UI`doInBackground()`以显示祝酒词时，甚至为什么在启动异步任务之前不能移动验证部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:53:10.867

我认为您应该使用`RunOnuithread`方法或使用方法中 的`Handler`While 。`doInBackground()``Asynctask`

这种方式使用

```
 @Override
    protected Long doInBackground(String... urls) {
        // Already suggested by Dixit Patel:
        // Use the runOnUiThread method.
        // See his explanation.
        runOnUiThread(new Runnable() {

     @Override
         public void run() {
         if (!password.equals(confirmpassword)) {
            Toast.makeText(getApplicationContext(), 
                    "The password does not match.",
                        Toast.LENGTH_SHORT).show();
                        newPassword.setText("");
                        newConfiPass.setText("");

        }

     }
    }); 
```

# javascript - Class()、new Class和new Class()的区别

> ID：14080448
> 
> 赞同：4
> 
> 时间：2012-12-29T09:41:04.840
> 
> 标签：javascript, javascript-objects

`Class()`和`new Class`,有什么区别`new Class()`？我做了一个测试，后者似乎更快。

[http://jsperf.com/object-initilzation](http://jsperf.com/object-initilzation)

我读到没有区别，但似乎有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:47:44.443

> `Class()`

调用一个函数。不要在构造函数上使用它。

> `new Class`和`new Class()`

这些之间没有区别，都实例化了一个类的新实例。如果没有传递参数并且`new`使用了关键字，则括号是可选的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:11:43.303

如果你有这样的课程：

```
function Test(propVal){
    this.prop = propVal;
} 
```

你会得到下一个结果：

**调用 Test()** 这将返回“未定义”，因为 Test 作为构造函数工作

**调用 new Test(5)** 您将获得一个新的 Test 实例，并且该实例的“prop”设置为 5

**调用新测试** 您将获得一个新的测试实例，并且该实例的“prop”设置为未定义

我希望这会有所帮助。

谢谢，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:41:04.297

`Class()`是对构造函数的误用。当您这样调用它时，它具有作为上下文对象的全局范围，并且它不会创建 Class 的新实例。`new Class`我想，和之间的主要区别在于`new Class()`某些 javascript engined 使用的一些参数优化

# ruby - Ruby 扩展，将大数据流传输到 Ruby

> ID：14080451
> 
> 赞同：3
> 
> 时间：2012-12-29T09:41:34.170
> 
> 标签：ruby, ruby-c-extension

我的 C 库生成了一个非常大的 POD 结构数组。将它传递给 Ruby 端的最有效方法是什么？在 Ruby 方面，原始值数组对我来说很好。

我当前的解决方案通过分别存储每个元素和字段来工作，而且速度非常慢。分析表明，这个函数在平均数据上占用大约 15% 的程序时间，它甚至不是计算部分。

我已经阅读过`Data_Wrap_Struct`，但不确定我是否需要它。如果我将一个 raw 传递`void*`给字符串，然后在 Ruby 端解压它，它会更快吗？

```
struct SPacket
{
    uint32_t field1;
    uint32_t field2;
    uint16_t field3;
    uint8_t field4;
};

VALUE rb_GetAllData(VALUE self) // SLOOOW
{
    size_t count = 0;

    struct SPacket* packets = GetAllData(&count);

    VALUE arr = rb_ary_new2(count);

    for(size_t i = 0; i < count; i++)
    {
        VALUE sub_arr = rb_ary_new2(4);

        rb_ary_store(sub_arr, 0, UINT2NUM(packets[i].field1));
        rb_ary_store(sub_arr, 1, UINT2NUM(packets[i].field2));
        rb_ary_store(sub_arr, 2, UINT2NUM(packets[i].field3));
        rb_ary_store(sub_arr, 3, UINT2NUM(packets[i].field4));

        rb_ary_store(arr, i, sub_arr);
    }

    return arr;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:51:16.340

您的方法将 C 数组复制到 Ruby 数组中。您可以通过创建一个 Ruby 集合类来避免这种情况，该集合类使用`Data_Wrap_Struct`并直接作用于 C 数组。

`Data_Wrap_Struct`是一个宏，它接受一个 Ruby 类和一个 C `struct`（以及可选的几个指向我故意省略的内存管理函数的指针）并创建一个具有`struct`“附加”的类的实例。在提供此类方法实现的函数中，您可以使用`Data_Get_Struct`“解包”这些方法，然后`struct`您可以在函数中访问这些方法。

在这种情况下，是这样的：

```
// declare a variable for the new class
VALUE rb_cSPacketCollection;

// a struct that will be wrapped by the class
struct SPacketDataStruct {
    struct SPacket * data;
    int count;
};

VALUE rb_GetAllData() {
    struct SPacketDataStruct* wrapper = malloc(sizeof (struct SPacketCollectionWrapper));
    wrapper->data = GetAllData(&wrapper->count);
    return Data_Wrap_Struct(rb_cSPacketCollection, 0, 0, wrapper);
} 
```

在您的`Init_whatever()`方法中，您需要创建类：

```
rb_cSPacketCollection = rb_define_class("SPacketCollection", rb_cObject); 
```

仅此一点用处不大，您需要在这个新类上定义一些方法。例如，您可以创建一个`[]`方法来允许访问单个`SPacket`s：

```
VALUE SPacketCollection_get(VALUE self, VALUE index) {
    // unwrap the struct
    struct SPacketDataStruct* wrapper;
    Data_Get_Struct(self, struct SPacketDataStruct, wrapper);

    int i = NUM2INT(index);

    // bounds check
    if (i >= wrapper->count) {
        rb_raise(rb_eIndexError, "Index out of bounds");
    }

    // just return an array in this example
    VALUE arr = rb_ary_new2(4);

    rb_ary_store(arr, 0, UINT2NUM(wrapper->data[i].field1));
    rb_ary_store(arr, 1, UINT2NUM(wrapper->data[i].field2));
    rb_ary_store(arr, 2, UINT2NUM(wrapper->data[i].field3));
    rb_ary_store(arr, 3, UINT2NUM(wrapper->data[i].field4));

    return arr;
} 
```

然后在您的`Init_`方法中，在创建类之后定义方法：

```
rb_define_method(rb_cSPacketCollection, "[]", SPacketCollection_get, 1); 
```

Note`Data_Get_Struct`是一个宏，用法有点奇怪，因为它不返回 unwrapped `struct`。

由于您已经在`Data_Wrap_Struct`这个阶段开始使用，您可以更进一步并创建一个新类，该类包装一个单独的`SPacket`结构并直接对其进行操作：

```
// declare a variable for the new class
VALUE rb_cSPacket;

//and a function to get a field value
// you'll need to create more methods to access the other fields
// (and possibly to set them)
VALUE SPacket_field1(VALUE self) {
    struct SPacket* packet;
    Data_Get_Struct(self, struct SPacket, packet);

    return UINT2NUM(packet->field1);
} 
```

在您的`Init_`函数中，创建它并定义方法：

```
rb_cSPacket = rb_define_class("SPacket", rb_cObject);
rb_define_method(rb_cSPacket, "field1", SPacket_field1, 0); 
```

这可能需要一些工作来为字段创建所有 getter 和 setter，这取决于您如何使用它。ffi 之类的东西在这里可以提供帮助，但我不知道 ffi 将如何处理集合类——它可能值得研究。

现在更改您的`[]`函数以返回一个实例，如果这个新类：

```
VALUE SPacketCollection_get(VALUE self, VALUE index) {
    //unwrap the struct
    struct SPacketDataStruct* wrapper;
    Data_Get_Struct(self, struct SPacketDataStruct, wrapper);

    int i = NUM2INT(index);

    //bounds check
    if (i >= wrapper->count) {
        rb_raise(rb_eIndexError, "Index out of bounds");
    }

    //create an instance of the new class, and wrap it around the 
    //struct in the array
    struct SPacket* packet = &wrapper->data[i];
    return Data_Wrap_Struct(rb_cSPacket, 0, 0, packet);
} 
```

有了这个，你现在可以在 Ruby 中做这样的事情：

```
c = get_all_data # in my testing I just made this a global method
c[2].field1 # returns the value of field1 of the third SPacket in the array 
```

在集合类上创建一个方法可能是值得的`each`，然后您可以包含该[`Enumerable`模块](http://ruby-doc.org/core-1.9.3/Enumerable.html)并提供一系列方法：

```
VALUE SPacketCollection_each(VALUE self) {
    //unwrap the struct as before
    struct SPacketDataStruct* wrapper;
    Data_Get_Struct(self, struct SPacketDataStruct, wrapper);
    int i;

    for(i = 0; i < wrapper->count; i++) {
        //create a new instance if the SPacket class
        // wrapping this entry
        struct SPacket* packet = &wrapper->data[i];
        rb_yield(Data_Wrap_Struct(rb_cSPacket, 0, 0, packet));
    }
    return self;
} 
```

在`Init_whatever`：

```
rb_define_method(rb_cSPacketCollection, "each", SPacketCollection_each, 0);
rb_include_module(rb_cSPacketCollection, rb_mEnumerable); 
```

在这个例子中，我没有关心对象标识和内存管理之类的事情。使用同一个数组支持的所有内容，您可以拥有多个共享相同数据的对象，您必须考虑这是否适合您的使用。此外，您可能已经注意到我已经`malloc`ed 但不是`free`d。您需要确定谁“拥有”数据数组，并确保不会引入任何内存泄漏。您可以传递一个函数`Data_Wrap_Struct`，当对象被垃圾收集以释放内存时将调用该函数。

如果您还没有看过，Pickaxe 书中有一章很好地介绍了 C 扩展，现在[可以在线获得](http://media.pragprog.com/titles/ruby3/ext_ruby.pdf)。

# python - 如何从网页更改正在运行的 Python 脚本/服务中的变量？

> ID：14080453
> 
> 赞同：1
> 
> 时间：2012-12-29T09:41:49.473
> 
> 标签：python, html, linux, cgi, raspbian

我在树莓派上使用 Raspbian。我有一个 Python 脚本 (LCD.py)，它使用 supervisord 控制作为服务运行的 LCD。

我希望能够在我的网页上输入一条消息并将其显示在 LCD 上。我认为这意味着我必须更改 LCD.py 脚本读取的一些变量，可能是更改模式的标志，然后使用服务器执行的另一个 Python 脚本 (CGI.py) 更改消息本身。

最好的方法是什么？还是我应该做一些完全不同的事情？我认为它与普通 CGI 类型的东西不同，因为我不能在每个页面加载时执行脚本，它需要在后台运行（用于滚动、闪烁等）

编辑：到目前为止，感谢您的帮助，今晚我回家后将发布我的 LCD 守护程序代码。

我对此有了更进一步的了解，我尝试使用 SimpleXMLRPCServer 和线程，目前这不起作用。我认为这是因为线程实际上并不同时运行。这是我正在测试的服务器代码：

```
 from SimpleXMLRPCServer import SimpleXMLRPCServer
    from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler
    import threading
    import time

    globalMessage = "Hi, I havnt been changed!"

    # Restrict to a particular path.
    class RequestHandler(SimpleXMLRPCRequestHandler):
        rpc_paths = ('/RPC2',)

    # Create server
    server = SimpleXMLRPCServer(("localhost", 8000),
                                requestHandler=RequestHandler)
    server.register_introspection_functions()

    # Register an instance; all the methods of the instance are
    # published as XML-RPC methods (in this case, just 'div').
    class serverFunctions:
        def setMessage(self, message):
                global globalMessage
                globalMessage = message
                print(globalMessage)

    class serverThread(threading.Thread):
            def run(self):
                    server.register_instance(serverFunctions())

                    # Run the server's main loop
                    server.serve_forever()
                    print("test");

    class lcdThread(threading.Thread):
            def run(self):
                    global globalMessage
                    while(1):
                            oldMessage = globalMessage
                            if(oldMessage != globalMessage): print("Message has changed")
                            else: print ("Message has not changed")
                            print(globalMessage)
                            time.sleep(1)

    serverThread().start()
    #lcdThread().start() 
```

和我的客户代码：

```
import xmlrpclib

s = xmlrpclib.ServerProxy('http://localhost:8000')

print s.setMessage("hello world") 
```

如果我取消注释我的 lcdThread().start() 行，我认为它卡在 lcd while 循环中并且服务器没有响应。多处理会有什么不同吗？请您详细说明 exec() 函数，我将如何使用 exec() 更改不同脚本中的全局变量？

编辑：这是我的 LCD.py 代码，它是一个守护进程，我试图设置的消息变量大约是一半。

```
#!/usr/bin/python
from Adafruit_CharLCD import Adafruit_CharLCD
from subprocess import * 
from time import sleep, strftime
from datetime import datetime
from datetime import timedelta
from os import system
from os import getloadavg
from glob import glob
import RPi.GPIO as GPIO

#Variables
lcd = Adafruit_CharLCD() #Stores LCD object
cmdIP = "ip addr show eth0 | grep inet | awk '{print $2}' | cut -d/ -f1" #Current IP
cmdHD = "df -h /dev/sda1 | awk '{print $5}'" # Available hd space
cmdSD = "df -h / | awk '{print $5}'" # Available sd space
cmdRam = "free -h"
temp = 0

#Run shell command
def run_cmd(cmd):
    p = Popen(cmd, shell=True, stdout=PIPE)
    output = p.communicate()[0]
    return output

#Initalises temp device     
def initialise_temp():
    #Initialise
    system("sudo modprobe w1-gpio")
    system("sudo modprobe w1-therm")
    #Find device
    devicedir = glob("/sys/bus/w1/devices/28-*")
    device = devicedir[0]+"/w1_slave"
    return device

#Gets temp  
def get_temp(device):
    f = open (device, 'r')
    sensor = f.readlines()
    f.close()

    #parse results from the file
    crc=sensor[0].split()[-1]
    temp=float(sensor[1].split()[-1].strip('t='))
    temp_C=(temp/1000.000)
    temp_F = ( temp_C * 9.0 / 5.0 ) + 32

    #output
    return temp_C

#Gets time
def get_time():
    return datetime.now().strftime('%b %d  %H:%M:%S\n')

#Gets uptime
def get_uptime():
    with open('/proc/uptime', 'r') as f:
        seconds = float(f.readline().split()[0])
        array = str(timedelta(seconds = seconds)).split('.')
        string = array[0]
    return string

#Gets average load
def get_load():
    array = getloadavg()
    average = 0
    for i in array:
        average += i
    average = average / 3
    average = average * 100
    average = "%.f" % average
    return str(average + "%")

#def get_ram():
def get_ram():
    ram = run_cmd(cmdRam)
    strippedRam = ram.replace("\n"," ");
    splitRam = strippedRam.split(' ')
    totalRam = int(splitRam[52].rstrip("M"))
    usedRam = int(splitRam[59].rstrip("M"))
    percentage = "%.f" % ((float(usedRam) / float(totalRam)) * 100)
    return percentage + "%"

#Gets the SD usage
def get_sd():
    sd = run_cmd(cmdSD)
    strippedSD = sd.lstrip("Use%\n")
    return strippedSD

#Gets the HD usage
def get_hd():
    hd = run_cmd(cmdHD)
    strippedHD = hd.lstrip("Use%\n")
    return strippedHD

#This is the variable im trying to set  
#def get_message():
#   message = "hello"
#   return message

def scroll():
    while(1):
        lcd.scrollDisplayLeft()
        sleep(0.5)

#Message and IP - PERFECT
def screen1():
    ipaddr = run_cmd(cmdIP)
    lcd.message('Raspberry Pi\n')
    lcd.message('IP: %s' % (ipaddr))

#Uptime - tick
def screen2():
    uptime = get_uptime()
    lcd.message('Total Uptime\n') 
    lcd.message('%s' % (uptime))

#Ram and load - PERFECT
def screen3():
    ram = get_ram()
    lcd.message('Ram Used: %s\n' % (ram))
    load = get_load()
    lcd.message('Avg Load: %s' % (load))

#Temp and time - tick time
def screen4():
    time = get_time();
    lcd.message('Temp %s\n' % (temp))
    lcd.message('%s' % (time))

#HD and SD usage - PERFECT
def screen5():
    sd = get_sd()
    lcd.message('SD Used: %s\n' % (sd))
    hd = get_hd()
    lcd.message('HD Used: %s' % (hd))

#Web message    
#def screen6():
#   message = get_message()
#   lcd.message(message)

#Pause and clear
def screenPause(time):
    sleep(time)
    #In here to reduce lag
    global temp
    temp = str(get_temp(device));
    lcd.clear()
###########################################################################################################

try:
    #Initialise
    lcd.begin(16,2)
    device = initialise_temp()
    lcd.clear()

    #Main loop
    while(1):
        screen1()
        screenPause(5)
        screen2()
        screenPause(5)
        screen3()
        screenPause(5)
        screen5()
        screenPause(5)
        screen4()
        screenPause(5)

except KeyboardInterrupt:
    GPIO.cleanup() 
```

谢谢乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:38:21.593

如果您正在寻找一种在脚本运行时更改全局变量的方法，

```
exec("<varname> = <newvar> in globals()") 
```

如果您不在评论中发布它。

编辑：也许包括任何现有代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:48:40.283

如果需要向 LCD.py 守护进程发送命令；你也可以使用http协议来做到这一点。你可以尝试像[瓶子](http://bottlepy.org/docs/dev/)这样的东西来实现网络应用程序部分。

您可以将 Web 应用程序作为单独的守护程序运行，但无论如何您都需要在 LCD.py中实现某种形式的[IPC 。](http://en.wikipedia.org/wiki/Inter-process_communication)

# android - android textview singleLine="true" 方括号

> ID：14080462
> 
> 赞同：2
> 
> 时间：2012-12-29T09:43:08.660
> 
> 标签：android, textview

`single_line="true"`有人可以告诉我，如果 TextView 具有属性并且设置了西里尔文文本，为什么最后一行会有一个方括号，显示在红色圆圈中？

![应用](../Images/af0602091245464c308308351e910dc9.png)

# objective-c - NSMutableArray 只初始化一次

> ID：14080463
> 
> 赞同：1
> 
> 时间：2012-12-29T09:43:18.387
> 
> 标签：objective-c, ios, uitableview, nsmutablearray, nsscrollview

我有一个程序通过将项目存储在 NSMutableArray 中来解析来自 Web 服务的 xml，该 NSMutableArray 初始化如下：

```
- (id)init {

    self = [super init];
    if (self)
    {
        items = [[NSMutableArray alloc] init];
    }
    return self;
} 
```

我已经使用 ScrollView 委托来检查用户何时点击 tableview 的底部，其中我正在调用 Web 服务的另一个页面以在已获取项目的底部加载更多项目。

但是当重新加载 tableview 时，它不会在已获取的底部添加新项目，而是只出现新项目。

在我可以使用动画设置 insertrowsatindexpaths 之前，我相信 NSMutableArray 正在再次初始化，这使得旧条目消失并仅显示新条目。我怎样才能让 NSMutableArray 只初始化一次，所以当它获取新条目时，它会在可变数组中已经获取的条目之后加载它们。

**编辑**

根据评论，看起来我对 MutableArray 做得很好，并且它只被初始化一次。那么数据源肯定有问题。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [[channelFeed items] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    ItemsViewCell *cell = (ItemsViewCell *)[tableView dequeueReusableCellWithIdentifier:@"UITableViewCell"];

    if (cell == nil) {
        cell = [[ItemsViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"UITableViewCell"];
    }

    FeedItem *item = [[channelFeed items] objectAtIndex:[indexPath row]];

    cell.titleLabel.text = [item title];
    cell.pubDateLabel.text = [item pubDate];
    cell.creatorLabel.text = [item creator];
    [[cell thumbImage] setImage:[item thumbnail]];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:04:22.050

我会在更方便的地方初始化数组。显然，您的代码调用了 init，它将重新初始化数组并删除其内容。

# sql-server - SQL Server 文件附加问题

> ID：14080466
> 
> 赞同：0
> 
> 时间：2012-12-29T09:44:11.190
> 
> 标签：sql-server, sql-server-2005-express

我正在使用 SQL Server 2005 Express 附加数据库。有些文件附有路径，有些则没有（见下文）

![在此处输入图像描述](../Images/cd683b19344f9bfd4ddca616df9b543e.png)

我将它们全部从同一个文件夹中附加。请指教有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:12:25.367

我认为除了在恢复/附加数据库时如何命名文件之外，没有任何区别。我认为这是`Attach As`附加时需要更改的字段和`Destination > Database`恢复时需要更改的字段。

# .htaccess - .htaccess mod_rewrite 带有文件扩展名条件的子目录

> ID：14080469
> 
> 赞同：1
> 
> 时间：2012-12-29T09:44:27.507
> 
> 标签：.htaccess, mod-rewrite

我正在尝试将链接从 to 重写 `domain.com/user/upload/12345.jpg`，`domain.com/12345.jpg`但仅当文件扩展名为`jpg`,`gif`或`png`. 我想，应该是这样的：

```
 RewriteRule ^user/upload/$ /$1 [L, QSA] 
```

但我的版本不起作用。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:48:26.043

我假设您的真实路径是用户/上传，并且您希望它就像在根目录中一样（对我来说很有意义）。否则，只需更改路径。

我认为这可以解决问题。

```
RewriteRule ^([^\.]+)\.(jpg|gif|png)$ http://domain.com/user/upload/$1.$2 [NC,L] 
```

或者，还有这个：

```
RewriteRule ^(.+?)\.(jpg|gif|png)$ http://domain.com/user/upload/$1.$2 [NC,L] 
```

您没有要传递 QSA 的查询字符串（例如：`?id=5&name=myname`，在 ? 之后是查询字符串）。

**编辑：**

如果您想保留远程重定向的重写 url，最好将所有匹配项重定向到本地文件，例如：remoteimage.php：

RewriteRule ^(.+?).(jpg|gif|png)$ remoteimage.php?filename=$1&extension=$2 [NC,L]

该文件将读取图像并将其重新发送到浏览器...

就像是：

```
<?php
    // Remote image
    $filename = $_GET['filename'];
    $ext = $_GET['extension']; // Of course you will need some validations, etc.

    header('Content-type: image/' . ($ext != 'jpg' ? $ext : 'jpeg'));

    // This is the idea, you could use cURL, fopen, etc. and you probably need to validate response status code and received data
    $image = file_get_contens("http://domain.com/user/upload/{$filename}.{$extension}");

    echo $image;
?> 
```

如果您使用一些框架，如 codeigniter、kohana 等，您可能需要尝试捕捉读数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:19:59.280

你可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI}  /([^/]+)\.(jpg|jpeg|gif|png)$
RewriteRule .* http://domain.com/user/upload/%1.%2 [L] 
```

将映射此：

`http://domain.com/any_name.any_extension`

对此：

`http://domain.com/user/upload/any_name.any_extension`

**选项**

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  (/m)?/([^/]+)\.(jpg|jpeg|gif|png)$
RewriteRule .* http://domain.com/user/upload%1/%2.%3 
```

将映射此：

`http://domain.com/any_name.any_extension`或这个

`http://domain.com/m/any_name.any_extension`

对此：

`http://domain.com/user/upload/any_name.any_extension`或这个

`http://domain.com/user/upload/m/any_name.any_extension`

取决于`/m`子目录的存在。

# xml - 自动生成列数据网格 xml

> ID：14080472
> 
> 赞同：0
> 
> 时间：2012-12-29T09:44:54.243
> 
> 标签：xml, wpf, datagrid

如何将此 XML 样式转换为自动生成的列数据网格？似乎无法让它工作......（我得到带有“Child”和“innertext”的列标题并且......非常磨损）

xml:

```
 <response>
    <sms>
      <recipient></recipient>
      <message></message>
      <status></status>
    </sms>
  </response> 
```

xml:

```
 <XmlDataProvider x:Key="LogData" XPath="/response/sms">

        </XmlDataProvider>

        ...

       <DataGrid ItemsSource="{Binding Source={StaticResource LogData}}" DataContext="  {StaticResource LogData}" AutoGenerateColumns="True" >
        ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:55:49.427

自动生成特别不支持 XML

[DataGrid.AutoGenerateColumns 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.autogeneratecolumns.aspx)

> 当源是 XML 数据时，DataGrid 无法自动生成列。

# performance - 如何加快 node.js 文件操作？

> ID：14080474
> 
> 赞同：1
> 
> 时间：2012-12-29T09:45:41.410
> 
> 标签：performance, node.js, express, download, mongoose

在我的项目中，客户端将请求从具有 id 的服务器下载文件。我必须执行以下操作：

*   验证来自 mongoDb 的 id
*   检查扩展
*   检查文件是否存在
*   读取文件并将内容写入响应

我正在使用以下代码检查文件并发送响应。

```
fs.exists(filename, function(exists) {
  if (!exists) {
    res.writeHead(404, '', {
      "Content-Type" : "text/plain"
    })
    res.write("404 Not Found\n");
    res.end();
    return;
  }
  fs.readFile(filename, "binary", function(err, file) {
    if (err) {
      res.writeHead(500, '', {
        "Content-Type" : "text/plain"
      })
      res.write(err + "\n");
      res.end();
      return;
    }
    res.setHeader("Pragma", "public");
    res.setHeader("Cache-Control: private, max-age=3600");
    res.setHeader("Transfer-Encoding:  chunked");
    res.setHeader("Range:  chunked");
    res.writeHead(200, '', {
      "Content-Type" : contentType
    });
    res.write(file, "binary");
    res.end(file, "binary");
  });
}); 
```

在几毫秒内，客户端将请求数百个文件。支持的文件类型是图像、音频或视频。

当文件夹中有很多文件时，node.js 会花费太多时间来下载文件。我怎样才能提高性能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T15:52:47.797

我会推荐一些东西。

1.  You should not be using `'binary'`. Don't give an encoding at all. By adding the encoding, you are making node do a ton of extra work to convert the file's `Buffer` object into a binary-encoded `string`. When you call `write` again with `'binary'` that means node has to then do that same operation in reverse. Also you are passing the file to both `end` and `write`, meaning every file you download will contain the file data twice.

2.  I'd recommend against using `readFile`. Since `readFile` passes the whole file contents back to you in your `file` variable, you are requiring node to load the whole contents of the file into RAM, meaning it needs to allocate a ton of buffers and then concatenate them, which is unneeded work.

3.  There is no reason to use `exists` separately, because if you try to open a file that does not exist, the error will tell you, so checking first is just extra work.

Also, the `Transfer-encoding` header will be set all by itself, you don't need to do it.

Something like this should be faster:

```
fs.createReadStream(filename)
    .on('error', function(err){
        if (err.code === 'ENOENT'){
            res.writeHead(404, {
                'Content-type': 'text/plain'
            });
            res.end('404 Not Found\n');
        } else {
            res.writeHead(500, {
                'Content-type': 'text/plain'
            });
            res.end(err + '\n');
        }
    })
    .on('open', function(){
        res.writeHead(200, {
            'Pragma': 'public',
            'Cache-Control': 'private, max-age=3600',
            'Content-type': contentType
        });
    })
    .pipe(res); 
```

# c++ - Qt 信号和槽线程安全

> ID：14080484
> 
> 赞同：26
> 
> 时间：2012-12-29T09:47:19.420
> 
> 标签：c++, qt, thread-safety

假设我有一个连接到插槽通知的信号更改。如果发出更改*信号*，则*通知槽*将开始执行。

现在如果发出第二个更改信号并且第一个通知槽没有完成执行会发生什么？

第二个插槽是否与第一个插槽同时启动？如果是这样，是 Qt 处理线程安全还是由程序员来处理它？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-29T10:06:22.457

这取决于您通过调用`connect`函数指定的连接类型。插槽将同时启动的唯一方法是，如果您`Qt::DirectConnection`在与插槽线程不同的线程中指定 AND 发射信号。如果您省略连接类型，它将是`Qt::AutoConnection`. 在这种情况下，如果您从一个线程发出信号，并在另一个线程中捕获它（例如，在主 GUI 线程中） - Qt 会将插槽的调用放入消息队列，并将按顺序进行所有调用。阅读此内容以获取更多信息 - [http://qt-project.org/doc/qt-4.8/threads-qobject.html#signals-and-slots-across-threads](http://qt-project.org/doc/qt-4.8/threads-qobject.html#signals-and-slots-across-threads)

# javascript - 如何在代码中更改网站的默认分辨率？

> ID：14080491
> 
> 赞同：-1
> 
> 时间：2012-12-29T09:49:04.200
> 
> 标签：javascript, html, css, web, resolution

我想更改我的网站默认分辨率（您可以按 ctrl+0 键查看）。这是我的网站[http://student.atilim.edu.tr/~tuncel.manil/](http://student.atilim.edu.tr/~tuncel.manil/)它的默认分辨率太小。缩放方法不适用于所有浏览器，默认分辨率必须更改。如果你可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:12:14.680

您可以为您的网站文本编写一个 CSS，例如

字体大小：1.3em；

这将使您的文本大小增加 realsize + 0.3%

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:02:32.833

在 style.css 中更改字体大小。还可以更改组件的边距、填充、高度、宽度。

# wordpress - 滑块在我的模板中不起作用，但在其他模板上起作用

> ID：14080496
> 
> 赞同：0
> 
> 时间：2012-12-29T09:49:49.587
> 
> 标签：wordpress, slider

我正在向已经建立的 WordPress 网站添加开发，需要一些帮助。

就像帖子滑块一样，我尝试了超过 4 个滑块插件，但它们不适用于我的模板。现在我正在使用[WordPress 主题滑块](http://wordpress.org/extend/plugins/theme-slider/)。我在其他 WordPress 模板上对其进行了测试，并且可以正常工作。

你能帮我解决这个问题吗？我不是 WordPress 的专业人士。

我有这个错误：

```
JS Uncaught TypeError: Object #<Object> has no method 'coinslider' 
```

以下是雪橇的名称：

`$(document).ready(jQuery(function ($) { $('#coin-slider').coinslider({width: 565,height: 290, spw: 7, sph: 5, delay: 5000, navigation: true, effect: '', repeatBg: 'no-repeat', navigationShow: 'hover'}); Uncaught TypeError: Object # has no method 'coinslider' }));`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:18:54.430

首先，
错误`Uncaught TypeError: Object # has no method 'coinslider'`提示`coinslider`未知且页面中不包含 JavaScript。检查您的页面源代码并确保包含“Wordpress 主题滑块”JavaScript 或 Coin Slider JavaScript...

从[Coin Slider 网页](http://workshop.rs/2010/04/coin-slider-image-slider-with-unique-effects/)，如果使用 Coin Slider 插件，这些是必需的（不确定使用 Wordpress 主题滑块会发生什么变化：

```
<script type="text/javascript" src="jquery-1.4.2.js"></script>
<script type="text/javascript" src="coin-slider.min.js"></script>
<link rel="stylesheet" href="coin-slider-styles.css" type="text/css" /> 
```

其次，
尝试以下内容而不是您的 JavaScript：

```
$(document).ready(function() {
        $('#coin-slider').coinslider(
        {
            width: 565,
            height: 290,
            spw: 7,
            sph: 5,
            delay: 5000,
            navigation: true,
            effect: ''
        });
    }); 
```

我不确定为什么`Uncaught TypeError: Object # has no method 'coinslider' }));`你发布的 JavaScript 里面有，也许它是错误粘贴的。

此外，选项`repeatBg`和未在其[网页](http://workshop.rs/2010/04/coin-slider-image-slider-with-unique-effects/)`navigationShow`的硬币滑块中列为选项。首先尝试将它们排除在外（如上例所示），看看是否有任何改变。我还从您的代码中删除了，因为它不在 Coin Slider 页面上给出的示例中。`jQuery``document).ready(jQuery(function.`

# javascript - 如果跨域，如何在 iframe 内的文本字段中获取文本？

> ID：14080501
> 
> 赞同：0
> 
> 时间：2012-12-29T09:50:49.730
> 
> 标签：javascript, jquery

我有一个表单，我在其中获取了一个文本字段，并且在其中也称为 iframe，并且在该 iframe 中有一个用于`Name`. 我想使用 JavaScript/jQuery 将其显示`Name`到我的表单文本字段中。我的意思是，我在文本字段中输入了一些`Name`内容，它将显示在我的输入字段中。
![请参阅附件图像我想在表单中的 <code>Name</code> 输入字段中显示 iframe 中的名称](../Images/c9dbabb55492fac370cbba14339f7f3a.png)

我正在从另一个域调用 iframe。我使用了以下代码

```
<script> 
var iframe = document.getElementById('progressive');
var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
var usernameTextBox = innerDoc.getElementById('ApplicantInfo1_FirstName');
usernameTextBox.focus();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:57:13.980

在您的父页面中，您是否控制域名？如果是这样，请创建一个子域。假设您的父页面名为 example.com，然后创建一个子域 iframe.example.com

在您的父页面中，您只需设置

```
document.domain = "example.com"; 
```

然后将子域视为安全域，您将被允许在 2 个页面之间进行交谈。

这里有更广泛的描述： [绕过同源策略的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:05:03.443

这应该有效：

```
var windowjQuery = $('#progressive')[0].contentWindow.$;
var f = $('#progressive').contents().find('#ApplicantInfo1_FirstName'); 
```

**更新：**

[您可以在相关问题](https://stackoverflow.com/questions/4101457/access-jquery-data-from-iframe-element)中阅读有关此主题的更多信息，bec。我现在无法设置环境来测试这种特殊情况。

关键是，你应该调用`<iframe>` *jQuery*对象 ( `$`)，而不是你的父页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T10:17:21.977

我不确定这是否适用于跨域，但您可能想查看[jQuery .bind()](http://api.jquery.com/bind/)。

这是 .bind() 的示例

```
$('#progressive').load(function() {
  $(this)
    .contents()
    .find('#ApplicantInfo1_FirstName')
    .bind('keydown', function() {
        //  do stuff
    });
}); 
```

更多/更好的细节[在这里 W3schools](http://www.w3schools.com/jquery/event_bind.asp)和现场演示[在这里](http://www.w3schools.com/jquery/tryit.asp?filename=tryjquery_event_bind_map)。但那些不是跨域的。[这里](http://www.jquery4u.com/function-demos/bind/)还有更多示例。

否则，这是一个关于如何从父级访问子 iframe 中的 javascript 的示例：

```
document.getElementById('ApplicantInfo1_FirstName').contentWindow.yourfunction() 
```

# image - 使用 sencha touch 上传图片

> ID：14080509
> 
> 赞同：1
> 
> 时间：2012-12-29T09:52:06.203
> 
> 标签：image, extjs, upload, amazon

我在煎茶触摸中醒来。我必须使用 sencha touch 上传图像。我可以完全访问相机，但我想使用亚马逊服务在服务器上上传包含图片的图片桶。我被困住了如何做到这一点。任何人都知道它。任何帮助将不胜感激。提前致谢

# javascript - 如何在分页 JS 脚本中包含参数？

> ID：14080513
> 
> 赞同：0
> 
> 时间：2012-12-29T09:52:27.000
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, ajax

我有以下 JS 脚本来加载更多用户并过滤它们：

```
 <script>
    var USERS_PER_PAGE = <%= @users_per_page %>;
    var user_count = USERS_PER_PAGE;

    function checkScroll() {
      if (nearBottomOfPage()) {
        $('#loading_more_'+(user_count-USERS_PER_PAGE)).fadeTo(200, 1);
        $.ajax({
           type: "GET",
           url: "/u?start=" + user_count + "&t="<%= params[:t] %> + "&f="<%= params[:f] %>,
           dataType: "script"
         });
        user_count += USERS_PER_PAGE;
      } else {
        setTimeout(checkScroll, 250);
      }
    }
    ... 
```

另外参数也可以`empty`。现在我收到错误：`Uncaught SyntaxError: Unexpected identifier`

![在此处输入图像描述](../Images/f4eaa5bc789f2c70f09a605e43304bd8.png)

那我应该如何合并参数`url`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T09:56:00.680

首先添加一个路由，将这个路由连接到一个控制器和动作

```
# routes.rb
match "/u" => "foo#bar" 
```

然后你可以做这样的事情

```
$.ajax({
  type: 'GET',
  url: '<%=j u_path(start: USERS_PER_PAGE, t: ceo, f: h) %>',
  // ...
}); 
```

* * *

**注意：**确保在使用`<%=j ... %>`ERb 输出到 JavaScript 时使用。这将正确地转义 javascript 值。

# asp.net-mvc - 从一个视图重定向到另一个视图

> ID：14080515
> 
> 赞同：32
> 
> 时间：2012-12-29T09:52:46.093
> 
> 标签：asp.net-mvc, asp.net-mvc-3

嗨，我正在尝试从一个视图重定向到另一个视图，但在 Visual Studio 中出现红色波浪。如何从视图内部重定向到另一个视图。这是我尝试过的，但它不起作用：

```
@Response.Redirect("~/Account/LogIn?returnUrl=Products"); 
```

如何从当前视图重定向到另一个视图？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-29T10:00:10.933

这是因为您的语句不会产生输出。

除了达林和懒惰的所有警告（他们是对的）；这个问题仍然提供了一些要学习的东西。

如果要执行不直接产生输出的方法，请执行以下操作：

```
@{ Response.Redirect("~/Account/LogIn?returnUrl=Products");} 
```

这也适用于渲染局部，例如：

```
@{ Html.RenderPartial("_MyPartial"); } 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-29T09:57:04.953

这不是应该使用 ASP.NET MVC 的方式。您不会从视图重定向。您从相应的控制器操作重定向：

```
public ActionResult SomeAction()
{
    ...
    return RedirectToAction("SomeAction", "SomeController");
} 
```

现在，由于我在您的示例中看到您正在尝试重定向到`LogOn`操作，因此您实际上并不需要手动执行此重定向，而只需使用`[Authorize]`属性装饰需要身份验证的控制器操作：

```
[Authorize]
public ActionResult SomeProtectedAction()
{
    ...
} 
```

现在，当某些匿名用户尝试访问此控制器操作时，表单身份验证模块将在请求触发该操作之前自动拦截该请求，并将用户重定向到您在 web.config ( `loginUrl`) 中指定的 LogOn 操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T09:56:49.547

视图的目的是显示模型。在创建模型并将其传递给视图之前，您应该使用控制器重定向请求。为此使用[Controller.RedirectToAction](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.redirecttoaction%28v=vs.108%29.aspx)方法。

# android - 为谷歌电视使用软键盘

> ID：14080519
> 
> 赞同：0
> 
> 时间：2012-12-29T09:53:10.400
> 
> 标签：android, navigation, focus, android-softkeyboard, google-tv

尽管可以在 google tv 中嵌入键盘视图，但似乎无法使用 dpad 浏览单个键。有什么办法可以让按键聚焦吗？

我知道没有必要在谷歌电视中使用软键盘，因为遥控器已经有一个，但客户明确希望它。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T03:01:28.780

您可能想尝试子类化和覆盖 onKeyUp 事件处理程序。

# c# - 使用基类和私有 setter 时，关键组件“Id”不是类型“TypeName”的声明属性

> ID：14080521
> 
> 赞同：4
> 
> 时间：2012-12-29T09:53:30.987
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-5

我想为实体使用一个抽象基类，它没有映射到任何表上：

```
public abstract class Entity
{
    public virtual int Id { get; private set; }
} 
```

由于`Id`将自动递增，因此我不想允许从外部更改此属性。因此，它的 setter 是`private`.

这是一个示例实体类型：

```
public class Order : Entity
{
    public virtual string Customer { get; set; }
} 
```

...配置类型：

```
public class EntityConfiguration<TEntity> : EntityTypeConfiguration<TEntity>
    where TEntity : Entity
{
    public EntityConfiguration()
    {
        HasKey(o => o.Id);
        Property(o => o.Id).HasColumnName("id").HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
    }
}

public class OrderConfiguration : EntityConfiguration<Order>
{
    public OrderConfiguration()
    {
        Property(o => o.Customer).HasColumnName("customer");
        ToTable("Customers");
    }
} 
```

...和上下文：

```
public class Context : DbContext
{
    public Context()
        : base()
    {
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Configurations.Add(new OrderConfiguration());
    }

    public DbSet<Order> Orders { get; set; }
} 
```

现在，当我尝试像这样查询订单时：

```
 using (var context = new Context())
        {
            foreach (var order in context.Orders)
            {
                Console.WriteLine(order.Customer);
            }
        } 
```

我遇到了一个例外：

> 关键组件“Id”不是“Order”类型的声明属性。验证它没有被明确地从模型中排除，并且它是一个有效的原始属性。

我在 SO 上阅读了几个问题，发现我的方法看起来是正确的。然后，我稍微修改了基类并`Id`使用*公共*设置器制作：

```
public abstract class Entity
{
    public virtual int Id { get; set; }
} 
```

而且（这是一个奇迹！）示例代码运行良好。此外，它在没有基`Entity`类（当在`Id`中定义时`Order`）和私有设置器的情况下也能正常工作。

逻辑告诉我，这是 EF 的错误行为。
但是，可能是，我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:06:47.923

EF 喜欢访问所有密钥。尝试使用**受保护**的，以便程序集可以访问 ID，但外部不能。对我来说，对于 EF 团队来说，这似乎是一个合理的问题。

请参阅相关帖子[实体框架代码是否首先支持只读导航属性](https://stackoverflow.com/questions/10268062/does-the-entity-framework-code-first-support-readonly-navigation-property)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:11:23.437

使实体类中的 id 设置器受保护：

```
public abstract class Entity
{
    public virtual int Id { get; protected set; }
} 
```

我试过这个。这将是工作

# objective-c - Objective-c：我怎样才能得到真正的手机国家（E164）代码（不是移动国家代码 - MCC）？

> ID：14080522
> 
> 赞同：3
> 
> 时间：2012-12-29T09:53:33.943
> 
> 标签：objective-c, country-codes

我正在尝试在 obj-c 中获取真实的国家代码 E164（例如：US = 1 或 Israel = 972）？

例如，用户输入他的电话号码：0523333333，如果用户来自以色列，我需要它带回：97252333333 以通过 nexmo.com 发送短信

现在我可以获得 MCC（移动国家代码），但它与真实国家代码不同（以色列 MCC 是 425，真实代码是 972）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T07:32:50.430

我认为这就是您想要的，从用户所在国家/地区获取呼叫代码，而不是从 iPhone 设置中获取。（没有头文件）

你需要`CoreLocation.framework`跑。

```
CLLocationManager *locationManager = [[CLLocationManager alloc] init];
locationManager.distanceFilter = kCLDistanceFilterNone;
locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;
[locationManager startUpdatingLocation];
[locationManager stopUpdatingLocation];

CLGeocoder *reverseGeocoder = [[CLGeocoder alloc] init];
[reverseGeocoder reverseGeocodeLocation:locationManager.location completionHandler:^(NSArray *placemarks, NSError *error)
{
    if(error){
        return;
    }

    CLPlacemark *pm = [placemarks objectAtIndex:0];
    NSString *countryCode = pm.ISOcountryCode;

    NSDictionary *dictCodes = [NSDictionary dictionaryWithObjectsAndKeys:@"972", @"IL",
                                            @"93", @"AF", @"355", @"AL", @"213", @"DZ", @"1", @"AS",
                                            @"376", @"AD", @"244", @"AO", @"1", @"AI", @"1", @"AG",
                                            @"54", @"AR", @"374", @"AM", @"297", @"AW", @"61", @"AU",
                                            @"43", @"AT", @"994", @"AZ", @"1", @"BS", @"973", @"BH",
                                            @"880", @"BD", @"1", @"BB", @"375", @"BY", @"32", @"BE",
                                            @"501", @"BZ", @"229", @"BJ", @"1", @"BM", @"975", @"BT",
                                            @"387", @"BA", @"267", @"BW", @"55", @"BR", @"246", @"IO",
                                            @"359", @"BG", @"226", @"BF", @"257", @"BI", @"855", @"KH",
                                            @"237", @"CM", @"1", @"CA", @"238", @"CV", @"345", @"KY",
                                            @"236", @"CF", @"235", @"TD", @"56", @"CL", @"86", @"CN",
                                            @"61", @"CX", @"57", @"CO", @"269", @"KM", @"242", @"CG",
                                            @"682", @"CK", @"506", @"CR", @"385", @"HR", @"53", @"CU",
                                            @"537", @"CY", @"420", @"CZ", @"45", @"DK", @"253", @"DJ",
                                            @"1", @"DM", @"1", @"DO", @"593", @"EC", @"20", @"EG",
                                            @"503", @"SV", @"240", @"GQ", @"291", @"ER", @"372", @"EE",
                                            @"251", @"ET", @"298", @"FO", @"679", @"FJ", @"358", @"FI",
                                            @"33", @"FR", @"594", @"GF", @"689", @"PF", @"241", @"GA",
                                            @"220", @"GM", @"995", @"GE", @"49", @"DE", @"233", @"GH",
                                            @"350", @"GI", @"30", @"GR", @"299", @"GL", @"1", @"GD",
                                            @"590", @"GP", @"1", @"GU", @"502", @"GT", @"224", @"GN",
                                            @"245", @"GW", @"595", @"GY", @"509", @"HT", @"504", @"HN",
                                            @"36", @"HU", @"354", @"IS", @"91", @"IN", @"62", @"ID",
                                            @"964", @"IQ", @"353", @"IE", @"972", @"IL", @"39", @"IT",
                                            @"1", @"JM", @"81", @"JP", @"962", @"JO", @"77", @"KZ",
                                            @"254", @"KE", @"686", @"KI", @"965", @"KW", @"996", @"KG",
                                            @"371", @"LV", @"961", @"LB", @"266", @"LS", @"231", @"LR",
                                            @"423", @"LI", @"370", @"LT", @"352", @"LU", @"261", @"MG",
                                            @"265", @"MW", @"60", @"MY", @"960", @"MV", @"223", @"ML",
                                            @"356", @"MT", @"692", @"MH", @"596", @"MQ", @"222", @"MR",
                                            @"230", @"MU", @"262", @"YT", @"52", @"MX", @"377", @"MC",
                                            @"976", @"MN", @"382", @"ME", @"1", @"MS", @"212", @"MA",
                                            @"95", @"MM", @"264", @"NA", @"674", @"NR", @"977", @"NP",
                                            @"31", @"NL", @"599", @"AN", @"687", @"NC", @"64", @"NZ",
                                            @"505", @"NI", @"227", @"NE", @"234", @"NG", @"683", @"NU",
                                            @"672", @"NF", @"1", @"MP", @"47", @"NO", @"968", @"OM",
                                            @"92", @"PK", @"680", @"PW", @"507", @"PA", @"675", @"PG",
                                            @"595", @"PY", @"51", @"PE", @"63", @"PH", @"48", @"PL",
                                            @"351", @"PT", @"1", @"PR", @"974", @"QA", @"40", @"RO",
                                            @"250", @"RW", @"685", @"WS", @"378", @"SM", @"966", @"SA",
                                            @"221", @"SN", @"381", @"RS", @"248", @"SC", @"232", @"SL",
                                            @"65", @"SG", @"421", @"SK", @"386", @"SI", @"677", @"SB",
                                            @"27", @"ZA", @"500", @"GS", @"34", @"ES", @"94", @"LK",
                                            @"249", @"SD", @"597", @"SR", @"268", @"SZ", @"46", @"SE",
                                            @"41", @"CH", @"992", @"TJ", @"66", @"TH", @"228", @"TG",
                                            @"690", @"TK", @"676", @"TO", @"1", @"TT", @"216", @"TN",
                                            @"90", @"TR", @"993", @"TM", @"1", @"TC", @"688", @"TV",
                                            @"256", @"UG", @"380", @"UA", @"971", @"AE", @"44", @"GB",
                                            @"1", @"US", @"598", @"UY", @"998", @"UZ", @"678", @"VU",
                                            @"681", @"WF", @"967", @"YE", @"260", @"ZM", @"263", @"ZW",
                                            @"591", @"BO", @"673", @"BN", @"61", @"CC", @"243", @"CD",
                                            @"225", @"CI", @"500", @"FK", @"44", @"GG", @"379", @"VA",
                                            @"852", @"HK", @"98", @"IR", @"44", @"IM", @"44", @"JE",
                                            @"850", @"KP", @"82", @"KR", @"856", @"LA", @"218", @"LY",
                                            @"853", @"MO", @"389", @"MK", @"691", @"FM", @"373", @"MD",
                                            @"258", @"MZ", @"970", @"PS", @"872", @"PN", @"262", @"RE",
                                            @"7", @"RU", @"590", @"BL", @"290", @"SH", @"1", @"KN",
                                            @"1", @"LC", @"590", @"MF", @"508", @"PM", @"1", @"VC",
                                            @"239", @"ST", @"252", @"SO", @"47", @"SJ", @"963", @"SY",
                                            @"886", @"TW", @"255", @"TZ", @"670", @"TL", @"58", @"VE",
                                            @"84", @"VN", @"1", @"VG", @"1", @"VI", nil];
    NSString *callingCode = [dictCodes objectForKey:countryCode];
    NSLog(@"%@", callingCode);
}]; 
```

# smartgwt - 最佳方法：使用 ValuesManager 或其他方法？

> ID：14080531
> 
> 赞同：1
> 
> 时间：2012-12-29T09:55:36.233
> 
> 标签：smartgwt

需要明确的是，这不是与缺陷相关的问题。我对特定业务需求的首选方法更感兴趣。

此外，我们目前正在使用 SmartGWT 3.1 版的 LGPL 版。

我们的要求是能够编辑客户信息记录（姓名、电话号码等），并且该信息表单还需要支持围绕客户地址的基本 CRUD；都在同一张表格上。到目前为止，我们已经使用了以下对象：

客户信息 - 画布

..SubscriptionForm - DynamicForm - 订阅数据源

....AddressCanvasItem - 在表单中托管 AddressGrid

......AddressGrid - ListGrid - 地址数据源

........AddressForm - 在 AddressGrid 中作为 RecordComponent 调用 - 用于只读和读写模式

现在的工作方式是用户为客户打开页面，显示他们的订阅表单，在该订阅表单上是一个网格，显示每个地址的记录组件，每个地址都有一个编辑按钮。用户单击编辑或添加地址，我们会弹出一个智能窗口，用户可以在其中进行更改，单击保存或取消。

然后将编辑中的更改直接提交到服务器，并使用服务层持久保存更改。用户还可以编辑包含地址的表单上的 CustomerInfo 字段并单独保存/取消这些更改。

现在一切正常。

现在用户真正想要的，我只是不知道如何让它在第一次工作，是让 RecordComponents 为每个地址显示一个 DynamicForm。然后，当他们单击“添加”时，它将弹出一个新行，DynamicForm 已准备好进行编辑。他们将能够编辑每个地址，而无需先单击编辑。简而言之，他们不希望编辑需要弹出窗口。

理想情况下，当用户在 CustomerInfo 表单上单击 Save 或 Cancel 时，它将应用于所有地址以及客户信息表单字段。

所以，我的问题是：实现这一目标的最佳方法是什么？ValuesManager 似乎可能是答案，但我不清楚它是否可以支持这种使用。或者，这种用法是否需要 LGPL 版本以外的产品？

最后，是否有示例显示如何执行此类操作？我确实在某一时刻非常接近工作，但我没有看到如何让不同数据源支持的多个表单同时提交。这个问题是促使我首先在弹出窗口中以读写模式使用 AddressForm 的原因。它使 CRUD 流量保持原子性，暂时让我解决了这个问题。

谢谢！

# ruby-on-rails - 使用多个可选参数在 Rails 中搜索数据库

> ID：14080536
> 
> 赞同：1
> 
> 时间：2012-12-29T09:56:20.023
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3

我有一个具有以下架构的 Rails 应用程序：

用户 (id, username, user_type, master_id) 项目 (id,itemname,is_master,master_id) 维修 (id, in_date, out_date, user_id, item_id)

该应用程序很小，因此我尝试使 db 尽可能简单。用户可以是管理员、经销商或经理。一个经理可以有许多经销商在他下面（都存储在同一个用户表中）。

一个项目可以是像计算机这样的主项目（具有许多子项目，如键盘、鼠标），也可以只是一个小的子项目。一个主条目下可以有许多子条目。

修复是项目的修复历史记录。维修具有关联的项目和用户。

我使用以下参数进行搜索（ ALL 可选）

*   经理姓名
*   经销商名称
*   主项目
*   子项
*   在日期
*   过期日期

如果未指定经销商名称，我希望结果中指定经理中的所有经销商，如果未指定子项目，我希望主项目下的所有项目都在结果中。

应该如何定义搜索控制器以保持代码简单和可维护？我真的不想为每个条件做一个“如果”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:35:07.647

`Item.joins :repairs => :user`

将为您完成从物品到维修到用户的连接。之后，只需在各个字段上按相等进行过滤（如果提供的话）。幸运的是，您可以在 Rails 中非常惯用地做到这一点，方法是构造您的搜索表单，使字段名称与它们在`.where`.

您需要过滤掉所有空白（空或 nil）的参数，具体取决于您的视图的结构。 `params.reject {|k,v| v.blank?}`应该为你做。

把它们放在一起，然后

`Item.joins(:repairs => :user).where(params.reject {|k,v| v.blank?})`

如果您已经设置了关联助手（您绝对应该这样做），或者类似的东西可能会起作用。

# c++ - 奇怪的语法 - 参数包扩展中的两个省略号运算符

> ID：14080539
> 
> 赞同：6
> 
> 时间：2012-12-29T09:56:43.177
> 
> 标签：c++, c++11, variadic-templates

> **可能重复：**
> [“……”令牌的含义是什么？](https://stackoverflow.com/questions/5625600/what-is-the-meaning-of-token)

在查看 libc++ 的 header`<type_traits>`时，我偶然发现了这些类模板特化：

```
template<typename>
    struct is_function
    : public false_type { };

template<typename _Res, typename... _ArgTypes>
    struct is_function<_Res(_ArgTypes...)>
    : public true_type { };

template<typename _Res, typename... _ArgTypes>
    struct is_function<_Res(_ArgTypes......)>    // <-- Huh?
    : public true_type { }; 
```

还有三对专业化（`const`和`volatile`变`const volatile`体），都采用相同的方式。

看起来像两个省略号运算符组合在一起。我能找到的唯一提及是在[cplusplus.com](http://www.cplusplus.com/articles/EhvU7k9E/)上，它说它也可以用空格 ( `_ArgTypes... ...`) 或逗号 ( `_ArgTypes..., ...`) 编写，但没有解释它的含义。

那么，这个语法是什么意思呢？这种专业化的目的是什么？

# rdp - 扩展 MS RDP 客户端

> ID：14080547
> 
> 赞同：0
> 
> 时间：2012-12-29T09:57:32.223
> 
> 标签：rdp

我需要为 Windows 远程桌面实现自定义压缩算法。

本质上，我将拥有一个动态虚拟通道插件，通过它我将发送自定义数据。这个例子很简单，这部分是可行的。

我的问题是如何在客户端自定义渲染部分？

我可以在主 RDP 客户端窗口上创建一个子窗口并在其中渲染内容吗？

# php - 使用 javascript 单击链接时更改链接的文本

> ID：14080551
> 
> 赞同：0
> 
> 时间：2012-12-29T09:58:21.167
> 
> 标签：php, javascript

我正在用 php 开发一个像 facebook 这样的社交网站。我有一个页面用于显示带有两个链接的用户消息，即`reply`在`delete`收件箱中每条消息的右下角。我的问题是，当我单击`reply`链接时，两个链接的文本都应更改为`post`和。`back`我的 html 代码是这样的：

```
<div class="msgutil">
  <a href="" id="reply" >reply</a> 
  <a href="delete_message.php?msg_id=<?php echo $row_msg_id;?>" id="delete">delete</a>//dont check this
</div><!--end msgutil--> 
```

我的javascript代码是这样的：

```
$(document).ready(function() 
{

    //action to be done if link name is reply which is present below the message box
    $("#reply").click(function(e) 
    {
        //action to be done if link name has changed from "reply" to "post" which is present below the message box
        if(document.getElementById('reply').innerHTML=="reply")
        {
            document.getElementById('reply').innerHTML="Post";
            document.getElementById('delete').innerHTML="Back";
            var idstr = document.getElementById('sender_id').value;
            $('<br/><form id="msgreply" name="msgreply" action="post_messages.php" method="post"> <label for="txt_subject"><strong>Subject:</strong></label><br/><input type="text" id="txt_subject" name="txt_subject"/><br/><label for="txt_message"><strong>Message:</strong></label><br/><input type="hidden" id="to_id" name="to_id" value="'+idstr+'"/><textarea name="txt_message" id="replyfield"></textarea></form>').insertAfter("#temp");
            e.stopPropagation();
            e.preventDefault();
        }
        else if(document.getElementById('reply').innerHTML=="Post")
        {
            var message = document.getElementById('msgreply');
            message.submit();
            e.stopPropagation();
            e.preventDefault();
        }
    });
    //action to be done if link name is delete which is present below the message box
    $("#delete").click(function(e) 
    {
        //action to be done if link name has changed from "reply" to "post" which is present below the message box
        if(document.getElementById('delete').innerHTML=="Back")
        {
            $("#msgreply").remove();
            document.getElementById('reply').innerHTML="reply";
            document.getElementById('delete').innerHTML="delete";
            e.stopPropagation();
            e.preventDefault();
        }
    });
}); 
```

它适用于第一条消息。如果收件箱中有多条消息，单击除第一条以外的任何消息的回复按钮时，不会发生任何操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:12:34.730

尝试这个...

```
<script>
$(document).ready(function() {

      $('#id_of_reply').click(function(){
          $('#id_of_reply').html("POST");
          $('#id_of_delete').html("BACK");
      });

}
</script>
<a href="#" id="id_of_reply" >REPLY</a> <br><br>
<a href="" id="id_of_delete">DELETE</a> 
```

在href中，输入href="#"。这将起作用。这会将链接的错误文本设置为 REPLY n DELETE，并在单击“REPLY”时将其更改为 POST n BACK。在 $('#id_of_reply').click(function(){ 中单击“REPLY”时为您想要执行的任何其他操作添加代码
并将任何内容放在此函数之外具有默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:09:50.640

问题是，当你这样做时，你`document.getElementById('reply')`会得到**第一个**带有`id='reply'`.

你可以这样做：

```
<div class="msgutil">
  <a href="" class="reply" >reply</a> 
  <a href="delete_message.php?msg_id=<?php echo $row_msg_id;?>" class="delete">delete</a><!-- dont check this -->
</div><!--end msgutil--> 
```

您的代码将类似于：

```
$(document).ready(function() 
{

    //action to be done if link name is reply which is present below the message box
    $(".reply").click(function(e) 
    {
        var el = $(this);
        //action to be done if link name has changed from "reply" to "post" which is present below the message box
        if(el.text() == "reply") // Changed from innerHtml to the text() method
        {
            var deleteEl = $(this).parent().find('> .delete'); // Gets the delete element relatively to this one
            el.text("Post");
            deleteEl.text("Back");

            var idstr = $('#sender_id').value;
            $('<br/><form id="msgreply" name="msgreply" action="post_messages.php" method="post"> <label for="txt_subject"><strong>Subject:</strong></label><br/><input type="text" id="txt_subject" name="txt_subject"/><br/><label for="txt_message"><strong>Message:</strong></label><br/><input type="hidden" id="to_id" name="to_id" value="'+idstr+'"/><textarea name="txt_message" id="replyfield"></textarea></form>').insertAfter("#temp");
            e.stopPropagation();
            e.preventDefault();
        }
        else if(el.html() == "Post")
        {
            var message = $('#msgreply');
            message.submit();
            e.stopPropagation();
            e.preventDefault();
        }
    });
    //action to be done if link name is delete which is present below the message box
    $(".delete").click(function(e) 
    {
        var el = $(this);
        //action to be done if link name has changed from "reply" to "post" which is present below the message box
        if(el.text() == "Back")
        {
            var replyEl = $(this).parent().find('> .reply'); // Gets the reply element relatively to this one

            $("#msgreply").remove();
            replyEl.text("reply");

            el.text("delete");
            e.stopPropagation();
            e.preventDefault();
        }
    });
}); 
```

* * *

由于 id 应该是唯一的，而不是 get `$('#reply')`and `$('#delete')`which 只获取具有该 id 的第一个元素，我们使用：

```
$(this).parent().find('> .delete'); 
```

它这样做：

*   获取当前元素 -`<a href="" class="reply">reply</a>`
*   找到它的父母——`<div class="msgutil"></div>`
*   查找具有`.delete`类的元素 -`<a href="" class="delete">delete</a>`

您应该对具有相同 ID 的所有其他元素执行相同的操作。

**PS1：**正如你所看到的，我用 替换了所有的`getElementById('something')`，`$('#something')`如果你使用像 jQuery 这样的很棒的库，请一直使用它。

**PS2：**你不能在 html 中做评论，`//dont check this`而不是使用`<!-- dont check this -->`:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T11:22:31.497

```
<div class="msgutil" id="msglinks_<?php echo $row_msg_id;?>">
<a href="">reply</a> 
<a href="delete_message.php?msg_id=<?php echo $row_msg_id;?>" class="delete">delete</a><!-- dont check this -->
</div><!--end msgutil--> 
```

并在回复点击事件中获取row_msg_id并替换两个链接，因为单独更改文本并不好，它仍然可以作为回复和删除事件......所以更改两个网址，

```
$("#msglinks_"+row_msg_id).html("url links"); 
```

# c# - 添加数百万个定点数

> ID：14080556
> 
> 赞同：2
> 
> 时间：2012-12-29T09:58:47.883
> 
> 标签：c#, double, decimal

我已经给出了数百万个小数点后精确到 4 位的数字。

必须以复杂的方式（在优化问题中）对它们进行大量添加和减去。之后（以及介于两者之间）我必须确定*确切的*值。

在 C# 中，我想到了三种不同的可能性：

1.  使用双精度并定义舍入误差进行比较。
2.  使用小数类型
3.  创建一个使用整数算术的类型

你有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T10:00:42.080

绝对不要用`double`。它不代表您所获得的信息。

我个人会从使用`decimal`. 对于您所获得的信息，这是最合适的类型，您可以依赖结果。

*如果*这证明太慢，您可以将所有值转换为整数，执行所有算术运算，然后再转换回来 - 但我只会在您看到版本的执行情况*后才会这样做。*`decimal`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T10:33:29.487

`double`仅提供小数部分的近似表示（例如，十进制中没有精确的二进制表示 0.2）。`decimal`type 可以在整个算术中产生一个精确的值，但`decimal`可以比任何 base2 类型慢一个顺序，例如 float 和 double，如果不是更多的话。

也许您可以在算术之前将所有数字缩放到 10,000 的顺序并对整数进行运算，然后再将基数放回去；检查十进制它是如何执行的。

# php - Opencart - 尝试创建博客

> ID：14080560
> 
> 赞同：1
> 
> 时间：2012-12-29T09:59:15.637
> 
> 标签：php, opencart

我正在尝试在我的 opencart 网站上创建一个具有几乎标准布局的博客，其中左栏有一个博客文章列表，顶部是最新的，右栏分为 2 - 存档（下拉到的月份列表显示该月的帖子），以及显示评论最多的 5 个帖子的热门故事。

我很欣赏那里有扩展，但最好看的都是商业的，我想复制它，所以我（和其他人）可以按照我们想要的方式自定义它。

# c# - 转换 Lambda 表达式 C# 2.0

> ID：14080561
> 
> 赞同：2
> 
> 时间：2012-12-29T09:59:29.150
> 
> 标签：c#

如何转换表达式

```
v => names.Add(v); // Consider names as List<string> and v as string 
```

进入 c# 2.0？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T10:01:38.430

您可以改用[匿名方法](http://msdn.microsoft.com/en-us/library/0yw3tz5k.aspx)：

```
Action<String> action = delegate (string v) { names.add(v); }; 
```

如果将现有的 lambda 表达式转换为委托，这将起作用。*将*现有的 lambda 表达式转换为表达式树时，它将不起作用。

（你*真的*需要使用 C# 2 吗？哎呀。别忘了你可以使用 C# 3 或更高版本，但仍以 .NET 2 为目标，如果那是*真正的*要求的话。使用 C# 3 和更高版本在生产力方面的好处确实使它可以升级您的 Visual Studio 版本...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:25:22.083

在这个特定示例中，lambda 箭头实际上只是调用具有未更改参数列表的现有方法，您也可以只使用**“方法组”**。

所以

```
v => names.Add(v) 
```

可以替换为

```
names.Add    /*  OK in C# 2.0, method group conversion  */ 
```

但在 lambda 不仅等同于现有命名方法的一般情况下，请使用匿名方法，如其他答案所示：

```
delegate (string v) { names.Add(v); } 
```

所有这些表达式都可以分配给一个委托类型，例如`Action<string>`有一个`string`参数（值参数）并返回`void`。

# android - 在Android wifi热点中获取wifi广播地址

> ID：14080573
> 
> 赞同：10
> 
> 时间：2012-12-29T10:01:24.670
> 
> 标签：android, udp, wifi, broadcast

我正在开发一个应用程序，它使用 wifi 在具有我的应用程序的同一网络中的所有手机之间广播 UDP 消息。

我设法从许多具有外部 AP 的手机发送/接收数据包，那是我的路由器。

但是考虑到没有 AP 的情况，我希望用户能够使用他们手机的 Wifi Hotspot 功能，这样他们仍然可以使用我的应用程序。因此，其中一部手机将成为 wifi 热点，而其他所有手机都将连接到该热点。

我要求用户自己连接到 wifi。到外部 AP 或到所述热点。然后当我的应用程序启动时，它会检查手机是否连接到 wifi 网络，调用 WifiManager.isWifiEnabled() 和 NetworkInfo.isConnected()。

问题是，如果我在使用热点的手机中调用这些函数，函数 isConnected() 将返回 false。而且我无法使用 WifiManager.getDhcpInfo() 获取广播地址。连接到热点的其他手机可以正常工作。但热点手机无法发送任何广播，因为 WifiManager 已禁用。

所以，我的问题是“有没有办法检查手机当前是否是 wifi 热点？如果是，有什么办法可以得到它的广播地址？”

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-29T12:32:55.967

首先，您可以检查您的 IP 地址是什么：

```
public InetAddress getIpAddress() {
  InetAddress inetAddress = null;
  InetAddress myAddr = null;

  try {
    for (Enumeration<NetworkInterface> networkInterface = NetworkInterface
      .getNetworkInterfaces(); networkInterface.hasMoreElements();) {

      NetworkInterface singleInterface = networkInterface.nextElement();

      for (Enumeration<InetAddress> IpAddresses = singleInterface.getInetAddresses(); IpAddresses
        .hasMoreElements();) {
        inetAddress = IpAddresses.nextElement();

        if (!inetAddress.isLoopbackAddress() && (singleInterface.getDisplayName()
            .contains("wlan0") ||
            singleInterface.getDisplayName().contains("eth0") ||
            singleInterface.getDisplayName().contains("ap0"))) {

          myAddr = inetAddress;
        }
      }
    }

  } catch (SocketException ex) {
    Log.e(TAG, ex.toString());
  }
  return myAddr;
} 
```

我用这个IP以这种方式获得广播：

```
public InetAddress getBroadcast(InetAddress inetAddr) {

    NetworkInterface temp;
    InetAddress iAddr = null;
    try {
        temp = NetworkInterface.getByInetAddress(inetAddr);
        List<InterfaceAddress> addresses = temp.getInterfaceAddresses();

        for (InterfaceAddress inetAddress: addresses)

            iAddr = inetAddress.getBroadcast();
        Log.d(TAG, "iAddr=" + iAddr);
        return iAddr;

    } catch (SocketException e) {

        e.printStackTrace();
        Log.d(TAG, "getBroadcast" + e.getMessage());
    }
    return null;
} 
```

它当然可以用一种方法完成，但在我的实现中将它分成两种方法很有用。

要确定 Wifi Tether 是否开启，您可以使用以下代码：

```
WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE);
Method[] wmMethods = wifi.getClass().getDeclaredMethods();
for (Method method: wmMethods) {
    if (method.getName().equals("isWifiApEnabled")) {

        try {
            if ((Boolean) method.invoke(wifi)) {
                isInetConnOn = true;
                iNetMode = 2;

            } else {
                Log.d(TAG, "WifiTether off");
            }
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }

    }
} 
```

如果客户端设备需要知道服务器设备是否是移动热点，可以使用特定的 IP 地址。据我所知，所有网络共享设备都有相同的地址 192.168.43.1 它在 Android 2.3 和 4.+ 上是相同的，在许多手机和平板电脑上都检查过。当然这不是最好的解决方案，但它很快。在我的应用程序客户端设备检查（将数据包发送到此地址）和我的服务器设备以预定义的方式响应，例如“yesIamInTheterModeIamYourServer”。

# java - 无法从服务器 android 播放视频

> ID：14080579
> 
> 赞同：1
> 
> 时间：2012-12-29T10:02:16.223
> 
> 标签：java, android

我想在流媒体模式下从服务器播放 .mp4 和 .3gp 视频，但视频没有播放，只会得到抱歉，这个视频无法播放消息我已经搜索过但没有得到任何解决方案，如果有人有任何解决方案请帮忙我。提前谢谢。我的代码

```
 getWindow().setFormat(PixelFormat.TRANSLUCENT);
    String path = "http://commonsware.com/misc/test2.3gp";
    mVideoView.setVideoPath(path);
    holder=mVideoView.getHolder();
    mp=new MediaPlayer(); 
    mp.setDataSource(path);
    mp.setScreenOnWhilePlaying(true);
    mp.setDisplay(holder);
    mp.prepare();
    mp.start();
    mVideoView.setOnCompletionListener(new OnCompletionListener() {

        public void onCompletion(MediaPlayer mp) {
            // TODO Auto-generated method stub
        finish();   
        }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:38:37.940

对您的活动实施 OnPreparedListener ，尝试将 mp.start() 放入 onPrepared 方法，

```
public class VideoPlayerActivity extends Activity implements
        OnBufferingUpdateListener, OnCompletionListener,
        OnPreparedListener, OnVideoSizeChangedListener, SurfaceHolder.Callback {

    private static final String TAG = "MediaPlayerDemo";
    private int mVideoWidth;
    private int mVideoHeight;
    private MediaPlayer mMediaPlayer;
    private SurfaceView mPreview;
    private SurfaceHolder holder;
    private String path;
    private static final int STREAM_VIDEO = 5;
    private boolean mIsVideoSizeKnown = false;
    private boolean mIsVideoReadyToBePlayed = false;

    /**
     * 
     * Called when the activity is first created.
     */
    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);
        mPreview = (SurfaceView) findViewById(R.id.VideoView);
        holder = mPreview.getHolder();
        holder.addCallback(this);
        holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    private void playVideo(Integer Media) {
        doCleanUp();
        try {           
            path = "http://commonsware.com/misc/test2.3gp";            
            // Create a new media player and set the listeners
            mMediaPlayer = new MediaPlayer();
            mMediaPlayer.setDataSource(path);
            mMediaPlayer.setDisplay(holder);
            mMediaPlayer.prepare();
            mMediaPlayer.setOnBufferingUpdateListener(this);
            mMediaPlayer.setOnCompletionListener(this);
            mMediaPlayer.setOnPreparedListener(this);
            mMediaPlayer.setOnVideoSizeChangedListener(this);

        } catch (Exception e) {
            Log.e(TAG, "error: " + e.getMessage(), e);
        }
    }

    public void onBufferingUpdate(MediaPlayer arg0, int percent) {
        Log.d(TAG, "onBufferingUpdate percent:" + percent);

    }

    public void onCompletion(MediaPlayer arg0) {
        Log.d(TAG, "onCompletion called");
    }

    public void onVideoSizeChanged(MediaPlayer mp, int width, int height) {
        Log.v(TAG, "onVideoSizeChanged called");
        if (width == 0 || height == 0) {
            Log.e(TAG, "invalid video width(" + width + ") or height(" + height + ")");
            return;
        }
        mIsVideoSizeKnown = true;
        mVideoWidth = width;
        mVideoHeight = height;
        if (mIsVideoReadyToBePlayed && mIsVideoSizeKnown) {
            startVideoPlayback();
        }
    }

    public void onPrepared(MediaPlayer mediaplayer) {
        Log.d(TAG, "onPrepared called");
        mIsVideoReadyToBePlayed = true;
        if (mIsVideoReadyToBePlayed && mIsVideoSizeKnown) {
            startVideoPlayback();
        }
    }

    public void surfaceChanged(SurfaceHolder surfaceholder, int i, int j, int k) {
        Log.d(TAG, "surfaceChanged called");

    }

    public void surfaceDestroyed(SurfaceHolder surfaceholder) {
        Log.d(TAG, "surfaceDestroyed called");
    }

    public void surfaceCreated(SurfaceHolder holder) {
        Log.d(TAG, "surfaceCreated called");
        playVideo(STREAM_VIDEO);

    }

    @Override
    protected void onPause() {
        super.onPause();
        releaseMediaPlayer();
        doCleanUp();
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        releaseMediaPlayer();
        doCleanUp();
    }

    private void releaseMediaPlayer() {
        if (mMediaPlayer != null) {
            mMediaPlayer.release();
            mMediaPlayer = null;
        }
    }

    private void doCleanUp() {
        mVideoWidth = 0;
        mVideoHeight = 0;
        mIsVideoReadyToBePlayed = false;
        mIsVideoSizeKnown = false;
    }

    private void startVideoPlayback() {
        Log.v(TAG, "startVideoPlayback");
        holder.setFixedSize(mVideoWidth, mVideoHeight);
        mMediaPlayer.start();
    }
} 
```

# wpf - ScrollViewer 在 WPF WindowsFormHost 中不起作用

> ID：14080580
> 
> 赞同：12
> 
> 时间：2012-12-29T10:02:21.367
> 
> 标签：wpf, scrollviewer, windowsformshost

![在此处输入图像描述](../Images/d7a46c1d2087503f0cc8db1d1b6b570a.png)我的 WPF 表单中有带有 RichTextBox 的 WindowsFormHost，我为该 WindowsFormHost 提供了 ScrollViewer，但它不起作用，WindowsFormHost 超出了 ScrollViewer ...

我的 XAML 是..

```
<ScrollViewer Background="DarkOrange" VerticalScrollBarVisibility="Auto" Height="80" MaxHeight="85" Margin="11,243,12,218" Width="756">
        <Canvas Height="100" Name="canvas1" Width="auto" >
            <WindowsFormsHost ClipToBounds="True" Height="120" Width="715" Margin="10,5,0,0" Name="winHostTEst" Background="Gray">
                <wf:RichTextBox BackColor="Cornsilk" Text="RichTextBox" x:Name="richTbTest" BorderStyle="None" Enabled="True" ForeColor="Black" Width="550" Multiline="True" ReadOnly="True" />
            </WindowsFormsHost>
        </Canvas>
    </ScrollViewer> 
```

这是解决此问题的两个链接，但我无法实现..请查看这些链接并解决我的问题..

链接是：

[http://blogs.msdn.com/b/ryanvog/archive/2009/01/20/clipping-legacy-content-hosted-inside-a-wpf-scrolling-region.aspx](http://blogs.msdn.com/b/ryanvog/archive/2009/01/20/clipping-legacy-content-hosted-inside-a-wpf-scrolling-region.aspx)

[http://www.mycsharp.de/wbb2/thread.php?threadid=76625](http://www.mycsharp.de/wbb2/thread.php?threadid=76625)

提前致谢..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-31T09:40:33.617

终于得到了解决方案

在您的解决方案中针对上述问题创建此类，并采用新的类控件 (ScrollViewerWindowsFormsHost) 而不是 WindowsFormsHost

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Windows.Forms.Integration;
using System.Windows.Media;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Controls;

namespace WPFRichTextBox
{
class ScrollViewerWindowsFormsHost: WindowsFormsHost
{

    protected override void OnWindowPositionChanged(Rect rcBoundingBox)
    {
        base.OnWindowPositionChanged(rcBoundingBox);

        if (ParentScrollViewer == null)
            return;

        GeneralTransform tr = ParentScrollViewer.TransformToAncestor(MainWindow);
        var scrollRect = new Rect(new Size(ParentScrollViewer.ViewportWidth, ParentScrollViewer.ViewportHeight));
        scrollRect = tr.TransformBounds(scrollRect);

        var intersect = Rect.Intersect(scrollRect, rcBoundingBox);
        if (!intersect.IsEmpty)
        {
            tr = MainWindow.TransformToDescendant(this);
            intersect = tr.TransformBounds(intersect);
        }

        SetRegion(intersect);
    }

    protected override void OnVisualParentChanged(DependencyObject oldParent)
    {
        base.OnVisualParentChanged(oldParent);
        ParentScrollViewer = null;

        var p = Parent as FrameworkElement;
        while (p != null)
        {
            if (p is ScrollViewer)
            {
                ParentScrollViewer = (ScrollViewer)p;
                break;
            }

            p = p.Parent as FrameworkElement;
        }
    }

    private void SetRegion(Rect intersect)
    {
        using (var graphics = System.Drawing.Graphics.FromHwnd(Handle))
            SetWindowRgn(Handle, (new System.Drawing.Region(ConvertRect(intersect))).GetHrgn(graphics), true);
    }

    static System.Drawing.RectangleF ConvertRect(Rect r)
    {
        return new System.Drawing.RectangleF((float)r.X, (float)r.Y, (float)r.Width, (float)r.Height);
    }

    private Window _mainWindow;
    Window MainWindow
    {
        get
        {
            if (_mainWindow == null)
                _mainWindow = Window.GetWindow(this);

            return _mainWindow;
        }
    }

    ScrollViewer ParentScrollViewer { get; set; }

    [DllImport("User32.dll", SetLastError = true)]
    public static extern int SetWindowRgn(IntPtr hWnd, IntPtr hRgn, bool bRedraw);
} 
```

}

XAML 代码：

```
<Window x:Class="WPFRichTextBox.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
    xmlns:swfh="clr-namespace:WPFRichTextBox"
    Title="MainWindow" Height="600" Width="800" Background="LightBlue">
<Grid Loaded="Grid_Loaded">

    <ScrollViewer  Background="DarkOrange" VerticalScrollBarVisibility="Auto" Height="100"  Margin="11,160,12,301" Width="756" Name="scrollViewer1">
        <Canvas Height="200" Name="canvas1" Width="auto" >
      <swfh:ScrollableWindowsFormsHost ClipToBounds="True" Height="194" Width="715" Margin="10,5,0,0" Background="Gray">
                <wf:RichTextBox BackColor="Cornsilk" Text="RichTextBox" x:Name="richTbTest" BorderStyle="None" Enabled="True" ForeColor="Black" Width="550" Multiline="True" ReadOnly="True" />
      </swfh:ScrollableWindowsFormsHost>
        </Canvas>
    </ScrollViewer>
</Grid> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-06T15:33:17.207

以防万一其他人有我的边缘情况，我在 WPF UserControl 内托管了一个 WinForms UserControl，它本身托管在一个 WinForms 表单内（不要问......） - Avinash 提供的类没有修复我的剪辑问题。

但是在某个地方的论坛线程上有一个修改版本，它起到了作用 - 所以我想我会在这里发布它以方便起见。

```
class WindowsFormsHostEx : WindowsFormsHost
{
    private PresentationSource _presentationSource;

    public WindowsFormsHostEx()
    {
        PresentationSource.AddSourceChangedHandler(this, SourceChangedEventHandler);
    }

    protected override void OnWindowPositionChanged(Rect rcBoundingBox)
    {
        base.OnWindowPositionChanged(rcBoundingBox);

        if (ParentScrollViewer == null)
            return;

        GeneralTransform tr = RootVisual.TransformToDescendant(ParentScrollViewer);
        var scrollRect = new Rect(new Size(ParentScrollViewer.ViewportWidth, ParentScrollViewer.ViewportHeight));

        var intersect = Rect.Intersect(scrollRect, tr.TransformBounds(rcBoundingBox));
        if (!intersect.IsEmpty)
        {
            tr = ParentScrollViewer.TransformToDescendant(this);
            intersect = tr.TransformBounds(intersect);
        }
        else
            intersect = new Rect();

        int x1 = (int)Math.Round(intersect.Left);
        int y1 = (int)Math.Round(intersect.Top);
        int x2 = (int)Math.Round(intersect.Right);
        int y2 = (int)Math.Round(intersect.Bottom);

        SetRegion(x1, y1, x2, y2);
    }

    protected override void Dispose(bool disposing)
    {
        base.Dispose(disposing);

        if (disposing)
            PresentationSource.RemoveSourceChangedHandler(this, SourceChangedEventHandler);
    }

    private void SourceChangedEventHandler(Object sender, SourceChangedEventArgs e)
    {
        ParentScrollViewer = FindParentScrollViewer();
    }

    private ScrollViewer FindParentScrollViewer()
    {
        DependencyObject vParent = this;
        ScrollViewer parentScroll = null;
        while (vParent != null)
        {
            parentScroll = vParent as ScrollViewer;
            if (parentScroll != null)
                break;

            vParent = LogicalTreeHelper.GetParent(vParent);
        }
        return parentScroll;
    }

    private void SetRegion(int x1, int y1, int x2, int y2)
    {
        SetWindowRgn(Handle, CreateRectRgn(x1, y1, x2, y2), true);
    }

    private Visual RootVisual
    {
        get
        {
            if (_presentationSource == null)
                _presentationSource = PresentationSource.FromVisual(this);

            return _presentationSource.RootVisual;
        }
    }

    private ScrollViewer ParentScrollViewer { get; set; }

    [DllImport("User32.dll", SetLastError = true)]
    static extern int SetWindowRgn(IntPtr hWnd, IntPtr hRgn, bool bRedraw);

    [DllImport("gdi32.dll")]
    static extern IntPtr CreateRectRgn(int nLeftRect, int nTopRect, int nRightRect, int nBottomRect);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-21T00:13:32.513

我发现 Marlon 的答案是最好的，但是如果用户有不同的 DPI 设置，它根本不起作用。这是 Marlon 的答案，但解决了 DPI 的缩放问题。我还添加了一个位置更改事件，因为我需要在滚动查看器中与 WindowsFormsHost 一起移动位于 WindowsFormsHost 内容顶部的弹出窗口。

```
#region Using Declarations

using System;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Forms.Integration;
using System.Windows.Media;

#endregion

public class WindowsFormsHostEx : WindowsFormsHost
{
    #region DllImports
    [DllImport("User32.dll", SetLastError = true)]
    static extern int SetWindowRgn(IntPtr hWnd, IntPtr hRgn, bool bRedraw);

    [DllImport("gdi32.dll")]
    static extern IntPtr CreateRectRgn(int nLeftRect, int nTopRect, int nRightRect, int nBottomRect);

    #endregion

    #region Events
    public event EventHandler LocationChanged;
    #endregion

    #region Members
    private PresentationSource _presentationSource;
    #endregion

    #region Properties
    private ScrollViewer ParentScrollViewer { get; set; }
    private bool Scrolling { get; set; }
    public bool Resizing { get; set; }
    private Visual RootVisual
    {
        get
        {
            _presentationSource = PresentationSource.FromVisual(this);
            return _presentationSource.RootVisual;
        }
    }
    #endregion

    #region Constructors
    public WindowsFormsHostEx()
    {
        PresentationSource.AddSourceChangedHandler(this, SourceChangedEventHandler);
    }
    #endregion

    #region Methods

    protected override void OnWindowPositionChanged(Rect rcBoundingBox)
    {
        DpiScale dpiScale = VisualTreeHelper.GetDpi(this);

        base.OnWindowPositionChanged(rcBoundingBox);

        Rect newRect = ScaleRectDownFromDPI(rcBoundingBox, dpiScale);
        Rect finalRect;
        if (ParentScrollViewer != null)
        {
            ParentScrollViewer.ScrollChanged += ParentScrollViewer_ScrollChanged;
            ParentScrollViewer.SizeChanged += ParentScrollViewer_SizeChanged;
            ParentScrollViewer.Loaded += ParentScrollViewer_Loaded;
        }

        if (Scrolling || Resizing)
        {
            if (ParentScrollViewer == null)
                return;
            MatrixTransform tr = RootVisual.TransformToDescendant(ParentScrollViewer) as MatrixTransform;

            var scrollRect = new Rect(new Size(ParentScrollViewer.ViewportWidth, ParentScrollViewer.ViewportHeight));
            var c = tr.TransformBounds(newRect);

            var intersect = Rect.Intersect(scrollRect, c);
            if (!intersect.IsEmpty)
            {
                tr = ParentScrollViewer.TransformToDescendant(this) as MatrixTransform;
                intersect = tr.TransformBounds(intersect);
                finalRect = ScaleRectUpToDPI(intersect, dpiScale);
            }
            else
                finalRect = intersect = new Rect();

            int x1 = (int)Math.Round(finalRect.X);
            int y1 = (int)Math.Round(finalRect.Y);
            int x2 = (int)Math.Round(finalRect.Right);
            int y2 = (int)Math.Round(finalRect.Bottom);

            SetRegion(x1, y1, x2, y2);
            this.Scrolling = false;
            this.Resizing = false;

        }
        LocationChanged?.Invoke(this, new EventArgs());
    }

    private void ParentScrollViewer_Loaded(object sender, RoutedEventArgs e)
    {
        this.Resizing = true;
    }

    private void ParentScrollViewer_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        this.Resizing = true;
    }

    private void ParentScrollViewer_ScrollChanged(object sender, ScrollChangedEventArgs e)
    {
        if (e.VerticalChange != 0 || e.HorizontalChange != 0 || e.ExtentHeightChange != 0 || e.ExtentWidthChange != 0)
            Scrolling = true;
    }

    protected override void Dispose(bool disposing)
    {
        base.Dispose(disposing);

        if (disposing)
        {
            PresentationSource.RemoveSourceChangedHandler(this, SourceChangedEventHandler);
            _presentationSource = null;
        }
    }

    private void SourceChangedEventHandler(Object sender, SourceChangedEventArgs e)
    {
        if (ParentScrollViewer != null)
        {
            ParentScrollViewer.ScrollChanged -= ParentScrollViewer_ScrollChanged;
            ParentScrollViewer.SizeChanged -= ParentScrollViewer_SizeChanged;
            ParentScrollViewer.Loaded -= ParentScrollViewer_Loaded;
        }
        ParentScrollViewer = FindParentScrollViewer();
    }

    private ScrollViewer FindParentScrollViewer()
    {
        DependencyObject vParent = this;
        ScrollViewer parentScroll = null;
        while (vParent != null)
        {
            parentScroll = vParent as ScrollViewer;
            if (parentScroll != null)
                break;

            vParent = LogicalTreeHelper.GetParent(vParent);
        }
        return parentScroll;
    }

    private void SetRegion(int x1, int y1, int x2, int y2)
    {
        SetWindowRgn(Handle, CreateRectRgn(x1, y1, x2, y2), true);
    }

    public static  Rect ScaleRectDownFromDPI(Rect _sourceRect, DpiScale dpiScale)
    {
        double dpiX = dpiScale.DpiScaleX;
        double dpiY = dpiScale.DpiScaleY;
        return new Rect(new Point(_sourceRect.X / dpiX, _sourceRect.Y / dpiY), new System.Windows.Size(_sourceRect.Width / dpiX, _sourceRect.Height / dpiY));
    }

    public static Rect ScaleRectUpToDPI(Rect _toScaleUp, DpiScale dpiScale)
    {
        double dpiX = dpiScale.DpiScaleX;
        double dpiY = dpiScale.DpiScaleY;
        return new Rect(new Point(_toScaleUp.X * dpiX, _toScaleUp.Y * dpiY), new System.Windows.Size(_toScaleUp.Width * dpiX, _toScaleUp.Height * dpiY));
    }
    #endregion
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-20T13:55:20.653

我们正在使用多个`ScrollViewers`，`ViewBox`所以没有一个提到的解决方案对我们有用。所以这是我们的解决方案，它也可以处理不同的 DPI 设置。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Forms.Integration;
using System.Windows.Media;
using System.Windows.Threading;

namespace XYZ
{

    public class ClippingWindowsFormsHost : WindowsFormsHost
    {
        private readonly DispatcherTimer _updateTimer;

        private Rect _bounds;

        private PresentationSource _source;

        public ClippingWindowsFormsHost()
        {
            PresentationSource.AddSourceChangedHandler(this, _sourceChangedEventHandler);

            _updateTimer = new DispatcherTimer(DispatcherPriority.Render);
            _updateTimer.Tick += _updateTick;
            _updateTimer.Interval = TimeSpan.FromMilliseconds(100);
        }

        private void _updateTick(object sender, EventArgs e)
        {
            _updateTimer.Stop();

            if (_source == null)
                return;

            // Get the Rect of the scrollviewer on screen.
            Rect scrollRect = _getScrollRect();

            // apply dpi settings
            scrollRect = _scaleDpi(scrollRect);

            if (scrollRect.Width > 0 && scrollRect.Height > 0) // if the rect is valid...
            {
                int x1 = (int) Math.Ceiling(scrollRect.X);
                int y1 = (int) Math.Ceiling(scrollRect.Y);
                int x2 = (int) Math.Ceiling(scrollRect.Right);
                int y2 = (int) Math.Ceiling(scrollRect.Bottom);

                SetWindowRgn(Handle, CreateRectRgn(x1, y1, x2, y2), true);
            }
            else
                SetWindowRgn(Handle, CreateRectRgn(0, 0, 0, 0), true);

        }

        private Rect _scaleDpi(Rect rect)
        {
            if (_source.CompositionTarget != null)
            {
                Matrix transformToDevice = _source.CompositionTarget.TransformToDevice;
                if (!transformToDevice.IsIdentity)
                {
                    Point scaledSize = transformToDevice.Transform(new Point(rect.Width, rect.Height));
                    rect = new Rect(rect.X, rect.Y, scaledSize.X, scaledSize.Y);
                }
            }

            return rect;
        }

        [DllImport("User32.dll", SetLastError = true)]
        private static extern int SetWindowRgn(IntPtr hWnd, IntPtr hRgn, bool bRedraw);

        [DllImport("gdi32.dll")]
        private static extern IntPtr CreateRectRgn(int nLeftRect, int nTopRect, int nRightRect, int nBottomRect);

        protected override void OnWindowPositionChanged(Rect rcBoundingBox)
        {
            base.OnWindowPositionChanged(rcBoundingBox);
            _updateClipping(rcBoundingBox);
        }

        private void _updateClipping(Rect bounds)
        {
            if (_source == null || _bounds == bounds)
                return;

            _bounds = bounds;

            // Only update clipping in certain intervals, otherwise splitpanels can create huge cpu load
            _updateTimer.Stop();
            _updateTimer.Start();
        }

        private Rect _getScrollRect()
        {
            ScrollViewer scrollViewer = _getTopScrollViewer();

            // Get the screenposition of the scrollviewer
            Point topLeft = scrollViewer.PointToScreen(new Point(0, 0));
            Point bottomRight = scrollViewer.PointToScreen(new Point(scrollViewer.ViewportWidth, scrollViewer.ViewportHeight));

            Rect scrollRect = new Rect(topLeft, bottomRight);

            // Get "this" position and use it to offset the scrollrect
            // because that is basically the scrolled distance
            Point myPosition = PointToScreen(new Point());
            scrollRect.Offset(-myPosition.X, -myPosition.Y);

            return scrollRect;
        }

        private ScrollViewer _getTopScrollViewer()
        {
            DependencyObject parent = this;
            ScrollViewer lastViewer = null;
            while ((parent = VisualTreeHelper.GetParent(parent)) != null)
            {
                ScrollViewer viewer = parent as ScrollViewer;
                if (viewer != null)
                    lastViewer = viewer;
            }

            return lastViewer;
        }

        protected override void Dispose(bool disposing)
        {
            base.Dispose(disposing);

            if (disposing)
            {
                _updateTimer.Stop();
                PresentationSource.RemoveSourceChangedHandler(this, _sourceChangedEventHandler);
            }
        }

        private void _sourceChangedEventHandler(object sender, SourceChangedEventArgs e)
        {
            _updateTimer.Stop();
            _source = e.NewSource;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-14T12:50:45.317

如果要将您的 WindowsFormsHost 放置在 UserControl 中，那么[Avinash 提供的答案](https://stackoverflow.com/a/14099937/1977871)可能不起作用。所以我不得不如下调整**ScrollViewerWindowsFormsHost类。**

```
 public class ScrollViewerWindowsFormsHost : WindowsFormsHost
    {
        protected override void OnWindowPositionChanged(Rect rcBoundingBox)
        {
            base.OnWindowPositionChanged(rcBoundingBox);

            if (ParentScrollViewer == null)
                //return; // Instead, you set the ParentScrollViewr by calling the following method.
                SetParentScrollViewer();

            GeneralTransform tr = ParentScrollViewer.TransformToAncestor(MainWindow);

            var scrollRect = new Rect(new Size(ParentScrollViewer.ViewportWidth, ParentScrollViewer.ViewportHeight));
            scrollRect = tr.TransformBounds(scrollRect);

            var intersect = Rect.Intersect(scrollRect, rcBoundingBox);
            if (!intersect.IsEmpty)
            {
                tr = MainWindow.TransformToDescendant(this);
                intersect = tr.TransformBounds(intersect);
            }

            SetRegion(intersect);
        }

        // This is new a new method. This is called from the above method.
        private void SetParentScrollViewer()
        {
            if (ParentScrollViewer is ScrollViewer)
                return; // that means its already set;

            var p = Parent as FrameworkElement;
            while (p != null)
            {
                if (p is ScrollViewer)
                {
                    ParentScrollViewer = (ScrollViewer)p;
                    break;
                }

                p = p.Parent as FrameworkElement;
            }
        }
        // Just comment out this method, you dont need this any more. You set the parent Scroll Viewer by calling SetParentScrollViewer Method.
        //protected override void OnVisualParentChanged(DependencyObject oldParent)
        //{
        //    base.OnVisualParentChanged(oldParent);
        //    ParentScrollViewer = null;

        //    var p = Parent as FrameworkElement;
        //    while (p != null)
        //    {
        //        if (p is ScrollViewer)
        //        {
        //            ParentScrollViewer = (ScrollViewer)p;
        //            break;
        //        }

        //        p = p.Parent as FrameworkElement;

        //    }
        //}

        private void SetRegion(Rect intersect)
        {
            using (var graphics = System.Drawing.Graphics.FromHwnd(Handle))
                SetWindowRgn(Handle, (new System.Drawing.Region(ConvertRect(intersect))).GetHrgn(graphics), true);
        }

        static System.Drawing.RectangleF ConvertRect(Rect r)
        {
            return new System.Drawing.RectangleF((float)r.X, (float)r.Y, (float)r.Width, (float)r.Height);
        }

        private Window _mainWindow;
        Window MainWindow
        {
            get
            {
                if (_mainWindow == null)
                    _mainWindow = Window.GetWindow(this);

                return _mainWindow;
            }
        }

        ScrollViewer ParentScrollViewer { get; set; }

        [DllImport("User32.dll", SetLastError = true)]
        public static extern int SetWindowRgn(IntPtr hWnd, IntPtr hRgn, bool bRedraw);
    } 
```

就是这样。每件事都保持不变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T10:09:01.047

那是因为 ScrollViewer 不知道它必须滚动。如果您的鼠标在 RichTextBox 上，它将拦截所有键。您可以继承 RichTextBox（即 WndProc）并侦听鼠标滚轮事件，然后使用 RaiseEvent 将它们发送到 scrollViewer。不要忘记 WndProc 在与 WPF 不同的线程上运行，因此您需要执行以下操作：

case WM_MOUSEWHEEL: Dispatcher.BeginInvoke(new Action(() => VisualHelper.FindParent(richTextBox).RaiseEvent(..具有正确参数的鼠标滚轮事件..));

# javascript - 从网站 url 调用 jQuery 对话框

> ID：14080585
> 
> 赞同：0
> 
> 时间：2012-12-29T10:03:34.350
> 
> 标签：javascript, jquery, html, css

我正在尝试做这样的事情： [https ://www.easybring.com/#registration](https://www.easybring.com/#registration)

如您所见，“注册”位于 jquery 对话框中，可以通过单击网站内的注册按钮打开该对话框。直到现在我很好：

```
<a onClick="showDialog({$product['id']});">More Info </a> 
```

我的头包含：

```
function showDialog(productID){
    $( "#dialog-modal_"+productID ).dialog({
        width: 770,
        height: 590,
        modal: true,
        open: function(event, ui){
        }
    });
} 
```

当然，我有 div：

```
<div id="dialog-modal_{$product['id']}" style="display: none;">
<iframe src="index.php?act=showProduct&id={$product['id']}" width="100%" height="100%" frameborder="0" scrolling="no"></iframe> 
</div> 
```

但我想做的是通过网站 url 调用该 jquery 特定对话框：#registration。

我该怎么做？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:16:07.380

这个应该工作：

```
$(document).ready(function() {
if( window.location.href.indexOf( '#registration' ) != -1 ) {
    showDialog({$product['id']});
}
}); 
```

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:11:15.663

您可以在文档加载事件中处理您的网址：

```
$(function() {
    if (window.location.toString().indexOf('#registration') > -1) {
        showDialog({$product['id']});
    }
}); 
```

代码可能不起作用，但我认为这个想法很明确。

这可能会帮助您在 JS 中使用 url 字符串：[如何使用 jQuery 从 URL 中获取锚点？](https://stackoverflow.com/questions/3552944/how-to-get-the-anchor-from-the-url-using-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:11:51.437

为什么不在 $(document).ready() 中调用showDialog **(** **)**

 **像这样的东西

```
 $(document).ready(function(){
    $("#dialog-modal").dialog({modal: true});
}); 
```**

# android - 打开 GL Es1.0 纹理参数？

> ID：14080590
> 
> 赞同：0
> 
> 时间：2012-12-29T10:03:57.907
> 
> 标签：android, opengl-es

这些行是什么意思，我用谷歌搜索但找不到可以理解的答案，因为他们假设了一些我没有的先验知识。我在 OpenGL-ES 方面没有经验，但我在 Android 应用程序开发方面有很好的经验：

```
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER,GL10.GL_NEAREST);
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER,GL10.GL_LINEAR);
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S,GL10.GL_REPEAT);
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T,GL10.GL_REPEAT); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:18:44.030

这是相当简单的。

前两行告诉 GL 在调整大小时如何处理纹理。在您的情况下，纹理在缩小（GL_TEXTURE_MIN_FILTER）时不应该使用过滤（GL_NEAREST），在放大（GL_TEXTURE_MAX_FILTER）时应该使用线性过滤（GL_LINEAR）。那里可以使用其他几个选项，例如三线过滤等。

后两行告诉 GL 如果遇到超出 (0..1) 范围的纹理坐标该怎么办。在您的情况下，这将导致 X(S) 和 Y(T) 轴上的纹理重复 (GL_REPEAT)，因此如果纹理坐标超出正常范围，您将在图元上获得平铺纹理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T10:16:11.240

前两行告诉 GL 在缩小或放大纹理时如何处理纹理。

在这种情况下，当纹理被缩小（渲染到一个非常小的多边形上，使用的像素少于纹理包含的像素）时，它将为每个屏幕像素从纹理中选择最近的像素，而不进行过滤。这将保持图像清晰，但可能会产生一些视觉噪音。

第二行表示当纹理被放大（渲染到一个大的多边形上，纹理中的每个像素被拉伸到许多屏幕像素上）时，应该线性插值纹理。这将模糊纹理中的​​像素，创建平滑的图像，而不是能够看到单个纹理像素。

另外两行告诉 GL，如果纹理坐标超出 0 到 1 的范围，则应该重复纹理。另一个常见的选择是“夹住”纹理，使边缘在 tex 坐标超出范围的区域上延伸。

# excel - ADODB - 为什么我的记录集是只读的？

> ID：14080591
> 
> 赞同：2
> 
> 时间：2012-12-29T10:04:22.957
> 
> 标签：excel, vba, adodb, recordset

在 Excel 中，我使用 ADODB 连接来构建记录集，从其自己的工作簿中的工作表中获取数据，如下所示：

```
Public Sub test()
    Dim cnn As New ADODB.Connection
    Dim rst As New ADODB.Recordset
    Dim strSQL As String
    Dim k As Variant

    cnn.Open "Provider=Microsoft.ACE.OLEDB.12.0;" & _
       "Data Source=" & ThisWorkbook.Path & "\" & ThisWorkbook.Name & ";" & _
        "Extended Properties=""Excel 12.0;HDR=No;IMEX=1;Readonly=False"";"

    strSQL = "SELECT F1 FROM [Workbench$];"

    rst.Open strSQL, cnn, adOpenStatic, adLockOptimistic
    rst.MoveFirst

    While Not rst.EOF
        rst("F1") = "NewValue"
        rst.Update
        rst.MoveNext
    Wend

End Sub 
```

但是，当我运行代码时发生错误：

> 运行时错误“-2147217911 (80040e09)”：
> 无法更新。数据库或对象是只读的。

我已经检查了我打开的工作簿的权限并且没问题（每个人都可以完全控制访问）。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-24T07:29:18.830

我通过 Use IMEX=0 解决了我的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T02:06:26.130

```
rst.Open strSQL, cnn, adOpenStatic, adLockOptimistic 
```

替换为

```
rst.Open strSQL, cnn, 1, 3 
```

# javascript - 鼠标悬停图像效果

> ID：14080593
> 
> 赞同：0
> 
> 时间：2012-12-29T10:04:54.097
> 
> 标签：javascript, jquery, html, css

我是 Javascript 和 JQuery 的新手。

我试着用谷歌搜索，但无法准确描述正确的现象，所以谷歌给了我我不想要的结果。

在 Pinterest 等网站中，他们如何创建鼠标悬停图像效果 - 即图像中的 Repin/Like/Comment 菜单。

这很容易做到吗？我只需要在图像内放一个盒子吗？

你能指出我正确的方向吗，或者如果它真的很简单为我解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:30:02.047

我为 Pinterest 做了相当多的挖掘，看看他们是如何做到的，这非常困难，因为他们缩小了所有的 css 文件，但这实际上都是用简单的 CSS3 完成的`hover`。这是我发现的：

这是 Pinterest 上的一个典型图钉（特别是一个 repin）

```
<a class="Button Button11 WhiteButton ContrastButton repin_link" data-componenttype="MODAL_REPIN" data-id="176555247863760400" href="/pin/176555247863760400/repin/" wotsearchprocessed="true">
    <em></em><span>Repin</span>
</a> 
```

这是repin、like和comment按钮的CSS

```
.actions.likebutton,
.actions.comment,
.actions.repin_link,
.actions.editbutton,
.actions.unlikebutton {
   display: none
}.pin: hover.actions.likebutton,
 .pin: hover.actions.comment,
 .pin: hover.actions.repin_link,
 .pin: hover.actions.editbutton,
 .pin: hover.actions.unlikebutton {
   display: block
 } 
```

基本上，当一个引脚没有悬停时，他们将显示设置为无，然后当用户悬停在它上面时，css 将其显示为块。实际上，如果您检查元素，您可以看到所有按钮，但在您悬停之前它们不会显示在屏幕上。当然，链接到其他站点只是通过`a href`将用户发送到另一个链接来完成。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:10:43.067

相当容易实现：

* * *

**HTML**

```
<div class="gallery-item">

    <a href="#">
      <img alt="" src="image.jpg" />
    </a>

    <div class="gallery-item-like"> <!-- class `gallery-item-like` is `display:none;` by default -->
      <a href="#" class="button-like">
        <img src="icon.png" width="20" height="20" title="iLike" />
      </a>
    </div>

</div> 
```

* * *

**JS**

```
$('.gallery-item').hover(
       function(){
           $(this).find(".gallery-item-like")
            .fadeIn("fast");
       },
       function(){
           $(this).find(".gallery-item-like")
            .fadeOut("fast");
     }
); 
```

* * *

**CSS**

```
.gallery-item-like {
    display: none;
    font-size: 10pt;
    position: relative;

    top: 15px;
    left: 15px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:11:07.480

[小提琴](http://jsfiddle.net/kLWRY/1/)

```
<div class="box"> <img src="myimage"> <div class="options"> <div class="button"> Like </div> <div class="button"> Repin </div> </div> </div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T10:12:01.950

您可以使用按钮代替图像，并将实际的 img 标签放在按钮内。然后在按钮内添加其他元素，如 div。现在，您可以使用 javascript/jquery 选择性地隐藏和显示鼠标悬停的 div。

# javascript - Perpetuum Reports 中的报告编辑器

> ID：14080594
> 
> 赞同：0
> 
> 时间：2012-12-29T10:04:54.250
> 
> 标签：javascript, asp.net-mvc, reporting

我正在使用[Perpetuum Reports](http://www.perpetuumsoft.com/SharpShooter-Reports-Web.aspx)在我的应用程序中打印发票。现在我需要允许我的用户打印发票。我应该如何使用hiperlink？

我使用以下代码，但它不起作用：

```
<script src="@Url.Content("~/Scripts/jquery.treeview.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/mscorlib.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/PerpetuumSoft.Reporting.WebViewer.Client.Model.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/PerpetuumSoft.Reporting.WebViewer.Client.js")" type="text/javascript"></script>

<script type="text/javascript"> 
var reportViewer = null;
$(document).ready(function () 
{ 
    var reportViewer = new PerpetuumSoft.Reporting.WebViewer.Client.ReportViewer("#ReportViewerElement"); 
    reportViewer.setServiceUrl("http://jmanlocal/ReportServiceController"); 
    reportViewer.reportName = "InvoicesRep"; 
    reportViewer.renderDocument(); 
    reportViewer.setThumbnailsControl("#ssr_thumbnailContentPanel"); 
    reportViewer.setDocumentMapControl("#documentMapView"); 
}); 

function PrintRep()
{
    reportViewer.exportToPdf();
}

</script>

<div id="ReportViewerElement"></div>
<button onclick="PrintRep()">Print</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T03:30:05.120

看起来您的 document.ready 处理程序中有额外的 var 关键字。它为您的处理函数声明局部变量，因此全局 reportViewer 变量不会引用您的报表查看器。所以，这是更正的代码：

```
<script src="@Url.Content("~/Scripts/jquery.treeview.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/mscorlib.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/PerpetuumSoft.Reporting.WebViewer.Client.Model.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/PerpetuumSoft.Reporting.WebViewer.Client.js")" type="text/javascript"></script>

<script type="text/javascript"> 
var reportViewer = null;
$(document).ready(function () 
{ 
    reportViewer = new PerpetuumSoft.Reporting.WebViewer.Client.ReportViewer("#ReportViewerElement"); 
    reportViewer.setServiceUrl("http://jmanlocal/ReportServiceController"); 
    reportViewer.reportName = "InvoicesRep"; 
    reportViewer.renderDocument(); 
    reportViewer.setThumbnailsControl("#ssr_thumbnailContentPanel"); 
    reportViewer.setDocumentMapControl("#documentMapView"); 
}); 

function PrintRep()
{
    reportViewer.exportToPdf();
}

</script>

<div id="ReportViewerElement"></div>
<button onclick="PrintRep()">Print</button> 
```

# java - 在 jsf 中读取 UI 组件的 X、Y 坐标

> ID：14080597
> 
> 赞同：0
> 
> 时间：2012-12-29T10:05:21.027
> 
> 标签：java, jsf

如何使用 JSF 在面板中读取 UI 组件（文本框、标签、按钮等）和位置？。此位置（X 和 Y 坐标）将保存到 xml 文件中？

更新：-

在我的屏幕上，用户可以在运行时将 UI 组件拖放到面板中的不同位置，然后单击保存按钮。那些带有位置的组件到 xml 文件中。这些是我的要求。请向我建议最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T12:20:53.783

JSF 组件的设计并不是为了支持这样的事情（固定的 X&Y 坐标）。

它们主要生成[HTML](https://stackoverflow.com/tags/html/info)输出，通常使用用户提供的[CSS](https://stackoverflow.com/tags/css/info)进行样式和定位，并由某些浏览器解释结果。不同的浏览器并不总是以相同的方式解释事物，也不能保证风格化的 HTML 元素无论如何都会以相同的方式工作，因为屏幕分辨率、屏幕和窗口大小等多种多样。

如果你解释一下你到底想要达到什么目标，也许你会有更好的运气。

话虽如此，在客户端，您确实有办法获取 JSF 生成的 HTML 元素的位置，请查看以下问题答案中的示例：[获取组件的坐标](https://stackoverflow.com/questions/6561621/getting-the-co-ordinates-of-a-component)。

**更新：**在问题更新之后，您想要的是使用仪表板组件。查看 PrimeFaces 中的一个（带有代码示例）：[https://www.primefaces.org/showcase/ui/panel/dashboard.xhtml](https://www.primefaces.org/showcase/ui/panel/dashboard.xhtml)您需要为每个 widgetId 存储项目索引和列索引（可能是您将存储在 XML 中的位置）。

# php - PDO 声称未捕获的异常，即使它在 try/catch 块内？

> ID：14080603
> 
> 赞同：5
> 
> 时间：2012-12-29T10:06:00.557
> 
> 标签：php, sql, pdo, namespaces

嗯嗯，不知道自己做错了什么......

这段代码：

```
 try {
            $this->CONN = new \PDO('mysql:dbname='.PASTEAES_DBNAME.';host='.PASTEAES_SERVER, PASTEAES_USERNAME, PASTEAES_PASSWORD);
            $this->CONN->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
        } catch(PDOException $e) {
            $this->raiseError('Fatal MySQL error', $e->getMessage());
        } 
```

向我报告：

`Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[42000] [1049] Unknown database 'pasteaes'' in /var/www/pasteaes/common/class.pasteaes.php on line 25`

但是，正如您所看到的，它显然位于 try and catch 块中。

这段特定代码所在的类是命名空间的，这就是我在上面共享的代码的第二行使用“\PDO”而不是“PDO”的原因。

哦，是的，我知道数据库不存在，但我仍然不希望将来发生这种情况（不是那样）。我想正确处理错误:(

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-29T10:07:43.633

```
catch(\PDOException $e)
      ^ 
```

# java - 用于为 Java 应用程序构建交互式 shell 的库

> ID：14080604
> 
> 赞同：19
> 
> 时间：2012-12-29T10:06:01.930
> 
> 标签：java, libraries

我正在寻找允许我创建交互式 shell 的 Java 库。我做了一些搜索，并没有出现很多。我发现的大部分是用于向我的应用程序添加命令参数解析的库，这对我没有多大帮助。

我找到的最好的线索是一个名为[Cliche](https://code.google.com/p/cliche/)的库，它完全符合我的需要。问题是它太简单了。我正在寻找具有更多自定义功能的东西。

有没有人遇到过更高级的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T10:14:42.383

要考虑的选项：

*   [javacurses / JCurses](http://sourceforge.net/projects/javacurses/) - 一个基于控制台的窗口工具包，类似于 UNIX 的 curses 设计
*   [如果您想在 Swing GUI 窗口中使用控制台样式的视图/输出，则swing-console](https://github.com/mikera/swing-console)可能是合适的。您可以使用它来构建交互式外壳。
*   [JLine](https://github.com/jline/jline2/#readme) - 类似于 GNU readline 的控制台输入库
*   几种 JVM 语言提供交互式[REPL 环境](http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop)，可用作交互式 shell，例如 Clojure

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-22T19:21:23.250

我们正在使用[Spring shell](https://github.com/spring-projects/spring-shell#readme)，它对我们来说非常有效。它的一些特点：

*   一个简单的、注释驱动的、用于贡献自定义命令的编程模型

*   使用 Spring 的类路径扫描功能作为
    命令插件策略和命令开发的基础

*   Roo Shell 功能的继承，最显着的是制表符补全、着色和脚本执行。

*   自定义命令提示符、横幅、shell 历史文件名。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-29T10:10:41.173

根据[这个问题](https://stackoverflow.com/questions/435740/are-there-good-java-libraries-that-facilitate-building-command-line-applications) [JLine](https://github.com/jline/jline2/)可以是一个很好的尝试。

[JLine的特点](https://github.com/jline/jline2/wiki)

> *   命令历史 - 以前输入的行可以被调用和编辑，并且可以被保留，以便它们
>     在您的程序的会话中可用。
> *   行编辑 - JLine 允许对当前命令行进行完全编辑，并尝试尽可能多地模仿 GNU Readline 的行为，包括对 emacs 和 vi 键映射的支持。
> *   完成 - JLine 提供了一种可插入的机制来实现命令行选项卡完成（当然完成可以绑定到您希望的任何键）。
> *   自定义键绑定 - 可以任意重新映射键以执行特定操作，并且 JLine 尝试遵守在现有 readline .inputrc 文件中设置的任何映射。
> *   字符屏蔽 - 可以从用户那里收集输入，而无需任何视觉反馈。这对于提示输入密码很有用。
> *   99.99% Java - JLine 的大部分都是 Java，只使用 Jansi 项目提供的一小部分本机代码来
>     支持 Windows。

# android - 如何设置 2 个文本视图和一个图标？

> ID：14080610
> 
> 赞同：0
> 
> 时间：2012-12-29T10:07:07.940
> 
> 标签：android, user-interface, textview

我无法得到我想要做的正确观点。我想在左侧设置一个图标，在右侧设置 2 个文本视图。我的问题是我看不到第二个文本视图，而第一个似乎太大了。

这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">
    <ImageView 
      android:id="@+id/image"
      android:layout_width="50dip"
      android:layout_height="50dip"
      android:scaleType="centerCrop"
      android:src="@drawable/rss" />
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
      android:id="@+id/linear"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content" android:layout_gravity="left|center_vertical">
      <TextView
        android:id="@+id/text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dip"
        android:textSize="20dip" />
      <TextView
        android:id="@+id/pubdate"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dip"
        android:textSize="10dip" />
    </LinearLayout>
  </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:19:54.857

试试这个：这是因为您正在设置文本视图以填充父级的宽度（这是第二个线性布局）。但它们需要用内容来包装。如果您仍然希望它们在宽度上占据相等的空间，您可以在第二个线性布局中再次保持文本视图的权重，就像我在第一个线性布局中所做的那样，它是子级。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:weightSum="30" >

    <ImageView
        android:id="@+id/image"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:scaleType="centerCrop"
        android:src="@drawable/ic_launcher"
        android:layout_weight="10" />

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linear"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="20" >

    <TextView
        android:id="@+id/text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text = "textview1"
        android:layout_marginLeft="10dip"
        android:textSize="20dip" />

    <TextView
        android:id="@+id/pubdate"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text = "textview2blahblahblahblahblah"
        android:layout_marginLeft="10dip"
       />
</LinearLayout>
</LinearLayout> 
```

![在此处输入图像描述](../Images/48dd4026e862589f398afdb96b496256.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:15:05.020

在 TextViews 上，将两者的宽度更改为`android:layout_width="wrap_content"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:17:39.210

试试这个代码

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/image"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:scaleType="centerCrop"
        android:src="@drawable/ic_launcher" />

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/linear"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left|center_vertical"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dip"
            android:layout_weight="1"
            android:text="TextView"
            android:textSize="20dip" />

        <TextView
            android:id="@+id/pubdate"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dip"
            android:layout_weight="1"
            android:text="TextView"
            android:textSize="20dip" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T10:21:58.393

用以下代码替换您的 XML

```
<?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

   <ImageView 
      android:id="@+id/image"
      android:layout_width="50dip"
      android:layout_height="50dip"
      android:scaleType="centerCrop"
      android:src="@drawable/rss" />

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/linear"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left|center_vertical"
        android:orientation="vertical" >

      <TextView
          android:id="@+id/text"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:layout_marginLeft="10dip"
          android:layout_weight="1"
          android:textSize="20dip" />

      <TextView
          android:id="@+id/pubdate"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:layout_marginLeft="10dip"
          android:layout_weight="1"
          android:textSize="20sp" />

    </LinearLayout>
  </LinearLayout> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-29T10:18:45.390

使用这个 XML 而不是上面的代码这对你来说是完美的。

我也用这个

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/linearLa"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/accident" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Medium Text"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:id="@+id/textView2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Medium Text"
                android:textAppearance="?android:attr/textAppearanceMedium" />

        </LinearLayout>

    </LinearLayout>

</LinearLayout> 
```

# asp.net-mvc-3 - MVC3 路由在使用 UrlParameter.Optional 时会记住最后一个参数值

> ID：14080611
> 
> 赞同：0
> 
> 时间：2012-12-29T10:07:17.170
> 
> 标签：asp.net-mvc-3, routing

我对其中一条路线的可选参数有疑问。路线看起来像这样：

```
 routes.MapRoute(
            "VideoList", // Route name
            "VideoList/{page}", // URL with parameters
            new { controller = "Video", action = "VideoList" , page = UrlParameter.Optional}
        ); 
```

第一次使用时效果很好：

```
@Html.RouteLink("Video", "VideoList", null, new { id = "idVideo", @class = "menu-item" }) 
```

控制器操作获取 NULL 代替页面参数，我在操作中处理休息。

然后，我使用网页并再次尝试相同的路由，这次指定“页面”参数，假设它的值为 7。

```
@Html.RouteLink("Video", "VideoList", new { page = 7 }, new { id = "idVideo", @class = "menu-item" }) 
```

它也可以按预期工作，但是当我再次尝试使用未指定“页面”的路由时，由于某种原因，它再次携带上次用于此参数的值，即 7

不知道为什么。我希望它通过将 null 传递给该参数的控制器来作为第一次工作

如果需要，我会提供更多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:38:06.450

这就是路由的工作原理。如果您不希望 RouteLink 从当前请求路由值中获取该参数，则需要显式设置该参数：

```
@Html.RouteLink("Video", "VideoList", new { page = "" }, new { id = "idVideo" }) 
```

这将始终生成`/VideoList`url。如果您没有将`page`参数显式设置为空字符串（如第一个示例中所示），则帮助程序将在生成链接时分析当前请求路由值。如果当前 url 是`/VideoList/7`，那么助手将保留所有路由值并生成`/VideoList/7`.

# mysql - MySQL 中的条件语句

> ID：14080613
> 
> 赞同：1
> 
> 时间：2012-12-29T10:07:34.150
> 
> 标签：mysql

已经很晚了，我可能完全错了，但我正在尝试执行一个非常具体的查询。

我有一张桌子叫`content`. 每条内容都有一个类型（即`news`、`events`等）。我还有一个`event_featured`仅适用于`event`项目的布尔列。我想提取所有内容，除了没有特色的活动。

`event_featured`因此，如果类型不是，查询将完全忽略`events`，但它只会选择已`event_featured`设置为 1 的事件。

在我看来，简单的英语查询听起来像这样：“选择所有内容，但如果等于 1则`content`排除”`type event``event_featured`

如果这是基本的（再次，为时已晚）或者我的问题没有意义，我深表歉意。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:10:25.617

只需将您的英文语句转换为 SQL：

```
select * from content where not (type='event' and event_featured=1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:11:57.490

试试这个查询

```
SELECT * FROM content WHERE type != 'event' AND event_featured = 1; 
```

# regex - 如何计算不重复java的word中的标记

> ID：14080624
> 
> 赞同：-2
> 
> 时间：2012-12-29T10:09:22.900
> 
> 标签：regex, string, stringtokenizer

我想计算 word 中不重复的标记。

```
Example:
aabbcc
abc

Result:
0
3 
```

我必须使用 StrTokazizer 或类似的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:34:43.617

这将起作用：

```
public int getUniqueTokensCount(String input)
{
    Set<Character> set = new HashSet<Character>();
    Set<Character> dups = new HashSet<Character>();

    for (char c: input.toCharArray())
        if (!set.add(c))
            dups.add(c);

    set.removeAll(dups);
    return set.size();
} 
```

我们从 in 的字符串中收集所有字符`set`，如果是重复的，则将字符添加到`dups`. 解析完所有字符串后，我们从`set`（包含所有单个字符）中删除所有找到的重复项。唯一令牌的数量就是这个集合的大小。

这取决于如果要添加的元素已经存在，则 a`Set`的`.add()`操作将返回这一事实。`false`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:49:36.673

如果您使用的是 Java，则以下内容应该可以工作：

```
public class UniqueTokenCounter{
  public static void main(String[] args) 
  {
    Arraylist<String> tokens = new ArrayList<String>();

    int uniqueCount=0;

    StringTokenizer stringTokenizer = new StringTokenizer("a b c b d");

    while(stringTokenizer.hasMoreTokens())
    {
       tokens.add(stringTokenizer.nextToken())
    }

    boolean unique=true;
    for(String uniqueToken : tokens) 
    {
       for(String token : tokens) 
       {
          if(uniqueToken.equals(token))
            unique=false;
       }
       if(unique)
          uniqueCount++;
       else
          unique=true;
    }
    //print uniqueCount
  }
} 
```

# python - 使用 SQL 查询填充 pytable

> ID：14080625
> 
> 赞同：1
> 
> 时间：2012-12-29T10:09:28.753
> 
> 标签：python, postgresql, cursor, psycopg2, pytables

我想在 Python 中使用等效的数据集。我想用 psycopg2 的数据填充数据集，`cursor.fetchall()`然后从这个数据集中进行所有未来的查询。

我了解到 pytables 可以以类似的方式使用。`cursor.fetchall()`我的问题是如何使用没有逐行循环的输出来填充 pytable 对象？另外如何在 pytables 中执行类似 SQL 的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:13:25.760

```
table.append(cursor.fetchall()) 
```

# python - Python 3 imaplib.fetch TypeError：无法将字节连接到int

> ID：14080629
> 
> 赞同：5
> 
> 时间：2012-12-29T10:10:17.133
> 
> 标签：python, imap

我有一些代码可以获取 IMAP 电子邮件，并且在 Python 2 中运行良好。在 Python3 中，我收到以下错误：

> Traceback（最近一次调用最后）：
> 文件“./mail.py”，第 295 行，在
> item=return_message(x)
> 文件“./mail.py”，第 122 行，return_message
> 结果中，data = mail.fetch(message_id , "(RFC822)")
> 文件 "/Library/Frameworks/Python.framework/Versions/3.3/lib/python3.3/imaplib.py", 第 460 行, 在 fetch
> typ, dat = self._simple_command(name, message_set, message_parts)
> 文件“/Library/Frameworks/Python.framework/Versions/3.3/lib/python3.3/imaplib.py”，第 1113 行，_simple_command
> return self._command_complete(name, self._command(name, *args))
> 文件“/Library/Frameworks/Python.framework/Versions/3.3/lib/python3.3/imaplib.py”，第 883 行，在 _command
> data = data + b' ' + arg
> TypeError: can't concat bytes to int

return_message 函数的代码：

```
result, data = mail.fetch(message_id, "(RFC822)")
raw_email = data[0][1]
email_message = email.message_from_string(raw_email) 
```

运行时信息：

> 3.3.0 (v3.3.0:bd8afb90ebf2, Sep 29 2012, 01:25:11)
> [GCC 4.2.1 (Apple Inc. build 5666) (dot 3)]

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T10:23:30.500

`message_set`是一个字符串，而不是一个 int。从[文档](http://docs.python.org/3/library/imaplib.html)中：

> 以下命令的`message_set`选项是一个字符串，指定要处理的一条或多条消息。它可以是一个简单的消息编号 ( `'1'`)、一个消息编号范围 ( `'2:4'`) 或一组用逗号 ( ) 分隔的不连续范围`'1:3,6:9'`。范围可以包含一个星号来指示无限的上限 ( `'3:*'`)。

直接将其转换为字符串就足够了：

```
result, data = mail.fetch(str(message_id), "(RFC822)") 
```

# jquery - 需要帮助使用 jQuery 和 CSS 自定义选项卡滑出插件

> ID：14080632
> 
> 赞同：0
> 
> 时间：2012-12-29T10:10:34.733
> 
> 标签：jquery, html, css

我不确定这是否是正确的询问地点，但我找到了这篇文章（http://stackoverflow.com/questions/7645702/tab-slide-out-using-jquery-need-more-than-one ）与我正在玩的一个插件有关，我想看看是否有人知道如何制作这个，以便您可以将此插件添加到菜单中。

例如，我希望菜单上有四个按钮，它们在页面顶部彼此相邻。当您单击“搜索”按钮或“时事通讯”按钮时，它会向下滑动一个表单，您可以在其中输入搜索词并单击“开始”或输入您的电子邮件地址并单击“订阅”。对于其他两个按钮，我只希望它们链接到其他网页。我以前没有使用过 jQuery，但我熟悉 java、javascript、HTML 和 CSS。

在网页右上角的[http://visittheoregoncoast.com/](http://visittheoregoncoast.com/)可以看到我想做的一个例子。当您单击搜索或电子邮件通讯时，整个菜单会向下滑动并显示一个小表格。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T12:37:17.833

这可以通过 JQuery 和 mootools 来实现，这里有一些可能对您有所帮助的链接：

*   [使用 Mootools 1.2 滑动登录面板](http://web-kreation.com/tutorials/nice-login-and-signup-panel-using-mootools-12/)

*   [使用 JQuery 的上下滑块](http://www.thatagency.com/design-studio-blog/2009/02/up-and-down-slider-using-jquery/)

*   [使用 mootools 滑动顶部面板](http://woork.blogspot.in/2008/03/sliding-top-panel-using-mootools_05.html)

# android - 为盲人构建 Android 无障碍模式的应用程序

> ID：14080636
> 
> 赞同：2
> 
> 时间：2012-12-29T10:10:46.523
> 
> 标签：android, accessibility, voice, blind

我想知道Android为盲人提供的TalkBack无障碍服务有多好。对他们真的有用吗？这样的用户社区有多大？

我打算构建一个应用程序来为这类用户提供服务，但我不确定如何将它与可访问性模式集成。我看到的是 TalkBack 服务不是很好。所以，我想让我的应用程序语音启用。这会与 Android 的辅助功能模式相矛盾吗？我将不胜感激构建此类应用程序的任何提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T01:27:31.330

我是一个完全盲人的软件开发人员，使用 iPhone 作为他们的主要手机。我在 Novo 7 Paladin 平板电脑上玩过 Android 4.0。体验不是很好，几乎无法使用。从我读过的内容来看，Android 设备的可访问性取决于制造商，因为他们能够对其进行自定义。我听说过从几乎可以像 iPhone 一样访问的 Android 设备到完全无法使用的一切，这取决于人和设备。有关更多信息，您可能需要阅读并发布到可以在 [https://groups.google.com/forum/?fromgroups#!forum/eyes-free找到的免眼 android 组](https://groups.google.com/forum/?fromgroups#!forum/eyes-free) 虽然我没有数字来支持这一点，而且如果你想专门针对盲人用户，它可能会因市场而异，但我会选择 iOS。iPhone 和 iPod touch 似乎都是盲人中流行的设备。除了这些设备很受欢迎，因为 Apple 是唯一一个销售 iOS 设备的设备，您几乎可以保证所有设备的可访问性都相同。如上所述，Android 设备并非如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:26:02.653

我来自中国，上个月我参加了一个展会，很多公司都展示了他们的产品。有一家公司致力于帮助中国盲人使用智能手机（Android 和 Symbian）。

他们说有 500 万盲人，只有 2 万人在使用他们的产品。但他们并不期望有多少盲人使用他们的产品，因为很少有盲人拥有自己的智能手机。所以他们将其视为公益而非商业。

我观看了演示，它是安装在您的智能手机上的应用程序。在应用程序的帮助下，盲人可以使用许多应用程序。非常令人印象深刻。

如果您需要，我可以发布更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T13:12:06.547

我在这件事上没有任何经验，但你看过那些视频吗：

[http://www.google.com/events/io/2011/sessions/leveraging-android-accessibility-apis-to-create-an-accessible-experience.html](http://www.google.com/events/io/2011/sessions/leveraging-android-accessibility-apis-to-create-an-accessible-experience.html)

[https://developers.google.com/events/io/sessions/gooio2012/127/](https://developers.google.com/events/io/sessions/gooio2012/127/)

?

我很确定他们谈论这些话题。

# socialengine - 社交引擎4.2安装步骤

> ID：14080643
> 
> 赞同：0
> 
> 时间：2012-12-29T10:11:41.310
> 
> 标签：socialengine

我试图安装社交引擎并面临问题。我无法找到有关如何正确执行此操作的任何好的文档。我已经用谷歌搜索和你的管...请任何人都可以指出一些关于如何正确执行此操作的良好分步说明。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T09:37:39.150

官方 SocialEngine 安装教程 - YouTube： [http ://www.youtube.com/watch?v=P-gUEzsesjU](http://www.youtube.com/watch?v=P-gUEzsesjU)

您可以在 SocialEngine 上找到升级教程和更多内容： [http ://www.youtube.com/user/socialenginetv](http://www.youtube.com/user/socialenginetv)

# php - 我应该得到 xml 格式的输出

> ID：14080645
> 
> 赞同：0
> 
> 时间：2012-12-29T10:11:46.233
> 
> 标签：php, mysql, xml

```
<?php

$sql    = "SELECT xxxx FROM xxxx";
$result = mysql_query($sql, $con);
if ($result) {
    while ($row = mysql_fetch_array($result)) {
        $jobtitle = $row["xxxx"];
        echo $jobtitle . "<br/>"; //output should be in xml format as given below
    }

} 
```

在上面的示例代码中，我使用`echo`.

但我想要 XML 格式的输出；那就是我应该得到类似于：

```
<all>
   <jobtitle>job1</jobtitle>
   <jobtitle>job2</jobtitle>
</all> 
```

目前我得到的输出为：

```
job1
job2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:15:07.700

它不会自动插入您想要的 xml 标签，您需要在作业之前和之后回显它们，以下就是这样做的：

```
 echo header('Content-Type: application/xml');
    $sql = "select jobtitle from jobslist";
    $result = mysql_query($sql,$con);
     if($result)
     {
       echo "<all>\n";
       while($row=mysql_fetch_array($result))
       {
         $jobtitle = $row["jobtitle"];
     echo "<jobtitle>$jobtitle</jobtitle>\n"; //output should be in xml format as given below
       }
       echo "</all>\n";
     } 
```

特别是回显 $jobtitle 的行，只需要修改（以及开始/结束 <all> 和 </all>

```
echo "<jobtitle>$jobtitle</jobtitle>\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:16:14.813

您必须添加 xml 标记来包装数据库结果，并为 xml 发送正确的标头。我还添加了这样您在解析输出时不必担心 xml 错误

```
 if($result){
        header ("Content-Type:text/xml"); 
        $xmlstring='<?xml version="1.0"?>\n';
        $xmlstring='<all>\n';
        while($row=mysql_fetch_array($result)){
              $xmlstring.='<jobtitle><![CDATA['. $row["jobtitle"].']]></jobtitle>\n';

          }
       $xmlstring.='</all>';

       echo  $xmlstring;
       } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:17:08.607

问题似乎是一个简单的事实，即您没有将`XML`标签附加到输出中。使其按预期工作的简单方法如下：

```
<?php header('Content-Type: application/xml'); ?>
<?php
    $sql = "select jobtitle from jobslist";
    $result = mysql_query($sql,$con);
    if($result) {
        echo '<?xml version="1.0"?>', "\n";
        echo '<all>', "\n";
        while( $row = mysql_fetch_array($result) ) {
            echo '    <jobtitle>' , $row["jobtitle"] , '</jobtitle>' , "\n";
        }
        echo '</all>', "\n";
    }
?> 
```

另外，[这是我在 Codepad.org 上进行的测试，](http://codepad.org/sKUJjZx7)它显示了更改的作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T18:32:57.400

[`SimpleXMLElement`^(*对于您非常简单的 XML 输出，您可以在Docs*)](http://php.net/SimpleXMLElement)的帮助下轻松完成：

```
$all = new SimpleXMLElement('<all />');

$sql    = "SELECT xxxx FROM xxxx";
$result = mysql_query($sql, $con);
while ($result && $row = mysql_fetch_array($result)) {
    $all->addChild('jobtitle', $row["xxxx"]);
}

echo $all->asXML(); 
```

示例输出（美化）：

```
<?xml version="1.0"?>
<all>
    <jobtitle>job1</jobtitle>
    <jobtitle>job2</jobtitle>
</all> 
```

我还建议您查看 PHP 手册，该手册有更多资源来提供如何创建、操作和输出 XML：[Basic SimpleXML usage](http://php.net/simplexml.examples-basic)。

# haskell - 为什么图书馆设计者在 Text 似乎合适的地方使用 ByteString？

> ID：14080659
> 
> 赞同：20
> 
> 时间：2012-12-29T10:13:01.167
> 
> 标签：haskell, attoparsec, aeson

在我的应用程序上工作时，我偶然发现了[Aeson 无法解码 UTF8 input](https://github.com/bos/aeson/issues/105)的问题。深入挖掘我发现它依赖于[`Parser ByteString`](http://hackage.haskell.org/packages/archive/attoparsec/0.10.1.1/doc/html/Data-Attoparsec-ByteString.html#t%3aParser)Attoparsec，这对我来说似乎是问题的根源。但这实际上不是我在这里要问的。

问题是它不是我见过人们使用的唯一地方`ByteString`，这对我来说似乎很明显，只有`Text`合适的地方，因为 JSON 不是一些二进制文件，它是可读的文本，它很可能包含 UTF8 字符。

所以我想知道我是否遗漏了一些东西并且有正当的理由可以选择`ByteString`，`Text`或者这只是由于大多数人不太关心拉丁文以外的任何其他字符集而导致的糟糕库设计的普遍现象。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-29T17:21:54.497

我认为[你的问题](https://github.com/bos/aeson/issues/105)只是一个误解。

```
Prelude> print "Ёжик лижет мёд."
"\1025\1078\1080\1082 \1083\1080\1078\1077\1090 \1084\1105\1076."
Prelude> putStrLn "\1025\1078\1080\1082 \1083\1080\1078\1077\1090 \1084\1105\1076."
Ёжик лижет мёд.
Prelude> "{\"a\": \"Ёжик лижет мёд.\"}"
"{\"a\": \"\1025\1078\1080\1082 \1083\1080\1078\1077\1090 \1084\1105\1076.\"}" 
```

当您`print`的值包含 a`String`时，将使用`Show`for 的实例，并转义所有代码点高于 127 的字符。要获得所需的`Char`字形，您需要.`putStr[Ln]``String`

如此`aeson`正确地解码了 utf8 编码的输入，正如预期的那样，因为它对值本身进行了 utf8 编码：

```
encode = {-# SCC "encode" #-} encodeUtf8 . toLazyText . fromValue .
         {-# SCC "toJSON" #-} toJSON 
```

那么对于为什么`aeson`使用`ByteString`而不是`Text`用于编码的最终目标和解码的起点的问题。

因为那是合适的类型。编码值旨在在机器之间可移植地传输。这以字节流的形式发生（八位字节，如果我们处于迂腐的心情）。这正是 a 所`ByteString`提供的，然后必须以特定于应用程序的方式处理的字节序列。出于 的目的`aeson`，字节流应以 utf-8 编码，并`aeson`假设`decode`函数的输入是有效的 utf-8，并将其输出编码为有效的 utf-8。

传输 eg`Text`会遇到可移植性问题，因为 16 位编码取决于字节顺序，因此`Text`不是机器之间数据交换的合适格式。请注意，在编码时（可能也在解码时）`aeson`用作`Text`中间类型，因为这是在中间阶段使用的合适类型。

# java - 通过 SOAP Web 服务访问数据库对象

> ID：14080660
> 
> 赞同：0
> 
> 时间：2012-12-29T10:13:07.860
> 
> 标签：java, web-services, soap

我是 Web 服务开发的新手。我需要在 java 中开发一个访问数据库对象的 SOAP Web 服务。
是否可以访问类型为 TYPE 的数据库对象。我创建了一个类型，如下所示：

```
create or replace 
TYPE XXXX_IN_O_TYPE
AS
OBJECT (USER_NAME  VARCHAR2(100), 
       USER_PASSWORD  VARCHAR2(50)) 
```

我需要从 Web 服务访问 USER_NAME 和 USER_PASSWORD 并为其赋值。这些值由用户输入。
是否可以通过 Web 服务访问和操作自定义对象及其值。

尽快回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:15:34.947

是的，有可能。

我建议使用 JAX-WS 创建您的 Web 服务，然后您将需要该 Web 服务与数据库交互，可能与 Hibernate 交互。

# c# - 甲骨文。查询中的参数。变量名称/编号错误

> ID：14080662
> 
> 赞同：0
> 
> 时间：2012-12-29T10:14:13.057
> 
> 标签：c#, asp.net, oracle, ado.net, plsql

我的代码：

```
oracleCom.CommandText = @"declare P_ID tbl_objects.i_id%TYPE;
                          BEGIN
                            UPDATE tbl_objects
                            SET i_status_id = 234
                            WHERE s_code = '" + objectsChanged[j] + 
                            @"' RETURNING i_id INTO P_ID;
                                :param_id := P_ID;
                          END;";
oracleCom.Parameters.Add("param_id", OracleType.Number).Direction = ParameterDirection.Output;
try
{
    oracleCom.ExecuteNonQuery();
}
catch
{----------} 
```

编译器生成错误：变量的名称/编号错误。但是当我在 pl/sql developer 中使用这个 sql 时，一切正常。

此代码正常工作：

```
OracleCommand oracleCom = new OracleCommand
{
   Connection = oraConnect,
   CommandText = @"declare P_ID tbl_objects.i_id%TYPE;
                   BEGIN insert into tbl_objects
                                (s_code, i_status_id)
                                values
                                (:s_code, 234)
                      RETURNING I_ID INTO :p_id;
                   END;"
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:32:42.540

`OracleCommand`无法处理多行的存储过程。你必须改变你`CommandText`的排成一行。（只需删除所有新行）。

我个人有一种用空格替换新行的方法，因此我可以存储格式化的命令，但在将它们放入`OracleCommand`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T12:27:07.280

这可能只是一个小错误。代替：

```
:param_id = P_ID; 
```

它应该是：

```
:param_id := P_ID; 
```

（赋值而不是相等运算符）。

# php - 通过 jquery 和 PHP 发布和获取多个数据

> ID：14080663
> 
> 赞同：0
> 
> 时间：2012-12-29T10:14:18.747
> 
> 标签：php, jquery, post, methods, get

我通过 jquery 将一个数据发布到 php，但我想获取多个数据并回显每个数据

jQuery代码：

```
$.post('form.php', {id:id_prc}, function(data){
    $('.content').html(data);
}); 
```

我的PHP代码：

```
if(isset($_POST['id'])){
$basket='basket';
$dvd='dvd';
} 
```

$basket 和 $dvd 是不同的数据，我想得到这些数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:24:34.253

```
$.post('form.php', {id:id_prc}, function(data){
    var response = jQuery.parseJSON(data);
    $('.content').html('basket: '+response.basket+'dvd: '+response.dvd);
}); 

if(isset($_POST['id'])){
$x['basket']='basket value';
$x['dvd']='dvd value';
echo json_encode($x);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:26:41.233

你的 jQuery

```
var formData = {
    'id' : $("#someID").text(),
    'basket': $("#basketID").text(),
    'dvd': $("#dvdID").text()
};

$.post('form.php', formData, function(data){
    $('.content').html(data);
}); 
```

你的PHP代码，

```
if(!empty($_POST['id'])){
    $basket=$_POST['basket'];
    $dvd=$_POST['dvd'];
} 
```

# opengl - 在 glviewport 上设置 left 和 bottom

> ID：14080670
> 
> 赞同：0
> 
> 时间：2012-12-29T10:15:14.270
> 
> 标签：opengl, opengl-es, opengl-es-2.0

如果`glviewport`将 left 和 bottom 都设置为零，那么为什么会显示负顶点？

例如`glviewport(0,0, width,height)`

这对我来说意味着您仅将视图设置为在 X 和 Y 为零或更大时查看事物。但当然这实际上并不是发生了什么，所以我不清楚这个调用到底是什么坐标系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:22:09.280

`glViewport()`通过定义从归一化坐标（即剪辑空间）（即视锥在 x/y 中为 -1 到 1）到屏幕（像素）坐标的变换，定义将被绘制到的窗口区域。它只是一个 2D 变换、缩放和偏移 3D 管道的结果，使其成为可以光栅化的东西。改变它不会改变可见的东西，而只会改变它最终的位置。

投影矩阵（与之前应用的任何其他变换相结合）首先定义了点如何变换到裁剪空间，从而确定世界的哪个部分实际上是可见的。

因此，如果您的投影矩阵将具有负坐标的点转换为位于视锥体内，则在应用视口时它们仍然可见。

# sql - 多级分组如何工作？

> ID：14080671
> 
> 赞同：-2
> 
> 时间：2012-12-29T10:15:18.143
> 
> 标签：sql, sql-server-express, sql-server-2008-express

我不确定如何处理以下查询。我读了这个查询，我知道它会给我什么输出。但是，我想知道它是如何在概念上处理的。

```
select FirstName, LastName, COUNT(CertificateId) as CertificatesAcheived
from Employee left join [Achivements]
on Employee.EmpID = [Achivements].EmpID
group by FirstName, LastName 
```

好的，这就是我认为它的工作原理（如果我错了，请告诉我）-

首先，生成 (First Name, LastName) 类型的对，即 (f1,n1)(f1,n2)(f2,n5)(f3,n5) 等。许多人可以有相同的名字和/或姓氏姓名。

然后，对于每个这样的对，Count(---) 将计算获得的证书数量。

（......是的，我知道同名的员工将被视为一名员工，但这对我来说并不重要）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:23:47.300

不确定 sql express 2008，但它通常是这样工作的：

首先创建一个连接

```
from Employee left join [Achivements] on Employee.EmpID = [Achivements].EmpID 
```

然后创建组：

```
group by FirstName, LastName 
```

所有具有相同名字和姓氏的行都将属于同一组

每个组的输出将是一行：名字、姓氏和组中的行数

```
select FirstName, LastName, COUNT(CertificateId) as CertificatesAcheived 
```

# jquery - JQuery捏缩放问题

> ID：14080675
> 
> 赞同：0
> 
> 时间：2012-12-29T10:15:34.557
> 
> 标签：jquery, image, zooming, pinch

我正在使用 JQuery，我想捏缩放图像。
我的代码是：

```
$(document).bind('mobileinit', function(){
      $.mobile.metaViewportContent = 'width=device-width';
}); 
```

# java - 碧玉报告打印

> ID：14080677
> 
> 赞同：1
> 
> 时间：2012-12-29T10:15:53.517
> 
> 标签：java, printing, jasper-reports

我创建了一个大小为 64X24 MM 大小的 Jasper 报告。我还编写了用于打印碧玉报告的代码。但是当我运行这段代码时，jasper 报告无法以正确的格式打印。

当我可以使用 JasperReportViewer 的打印菜单进行打印时，它将正确打印。但我不想使用 JasperReportViewer。我必须将碧玉报告直接设置为打印机。

我的代码是：

```
 JasperReport jasper_rep = JasperCompileManager.compileReport("c:\\report1.jrxml");
   JasperPrint jasper_print = JasperFillManager.fillReport(jasper_rep, parametersMap, con);
   JasperViewer.viewReport(jasper_print);
   PrinterJob job = PrinterJob.getPrinterJob();
   int selectedService = 0;
   selectedService = 0;
   PrintRequestAttributeSet printRequestAttributeSet = new HashPrintRequestAttributeSet();
   printRequestAttributeSet.add(OrientationRequested.PORTRAIT);
   printRequestAttributeSet.add(MediaSizeName.ISO_A0); 
   MediaSizeName mediaSizeName = MediaSize.findMedia(64,25,MediaPrintableArea.MM);
   printRequestAttributeSet.add(mediaSizeName);
   printRequestAttributeSet.add(new Copies(1));
   JRPrintServiceExporter exporter;
   exporter = new JRPrintServiceExporter();
   exporter.setParameter(JRExporterParameter.JASPER_PRINT, jasper_print);
   exporter.setParameter(JRPrintServiceExporterParameter.PRINT_REQUEST_ATTRIBUTE_SET, printRequestAttributeSet);
   exporter.setParameter(JRPrintServiceExporterParameter.DISPLAY_PAGE_DIALOG, Boolean.FALSE);
   exporter.setParameter(JRPrintServiceExporterParameter.DISPLAY_PRINT_DIALOG, Boolean.TRUE);
   exporter.exportReport();
   job.print(printRequestAttributeSet); 
```

但它没有以正确的格式打印。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-09T05:30:30.883

尝试删除

> MediaSizeName mediaSizeName = MediaSize.findMedia(64,25,MediaPrintableArea.MM); printRequestAttributeSet.add(mediaSizeName);

# .net - WCF Rest 服务发布方法给出未找到端点

> ID：14080678
> 
> 赞同：2
> 
> 时间：2012-12-29T10:15:55.947
> 
> 标签：.net, wcf, rest, iis, wcf-binding

我无法使用 post 方法调用休息服务并不断收到未找到端点的错误。代码如下：

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    [WebInvoke(
    Method = "POST",
    UriTemplate = "GetData",
    BodyStyle = WebMessageBodyStyle.WrappedRequest, ResponseFormat = WebMessageFormat.Json
    )]
    string GetData(string value);
}

[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall)]
public class Service1 : IService1
{
    public string GetData(string value)
    {
        return value;
    }
} 
```

web.config

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <httpRuntime maxUrlLength="1048576" relaxedUrlToFileSystemMapping="true" />
  </system.web>
  <system.serviceModel>

    <protocolMapping>
      <add scheme="http" binding="webHttpBinding" />
    </protocolMapping>

    <services>
      <service name="RestPost.Service1" behaviorConfiguration="default">
        <endpoint address="" behaviorConfiguration="web" binding="webHttpBinding"  contract="RestPost.IService1" />
      </service>
    </services>
    <behaviors>
      <endpointBehaviors>
        <behavior name="web"  >
          <webHttp />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="default">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

    <bindings>
      <!-- default binding configration used for all REST services -->
      <webHttpBinding>
        <!-- max allowed message size incresed to 500 000 Bytes -->
        <binding maxBufferSize="95000000" maxReceivedMessageSize="95000000" />
      </webHttpBinding>
    </bindings>

    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>

   <security>
     <requestFiltering>
       <requestLimits maxUrl="40960000" maxQueryString="20480000" maxAllowedContentLength="20480000" />
     </requestFiltering>
   </security>
  </system.webServer>

</configuration> 
```

这就是我在浏览器中调用 url 的方式

```
http://localhost:57395/Service1.svc/getdata/large base64encoded string here 
```

这就是我在提琴手中的称呼 ![在此处输入图像描述](../Images/bd75649d02db6c0f836082639570c7d7.png)

我现在正试图在 Casini 下运行它。最终它将部署在 IIS 7.5 上。

如果您想知道为什么我要传递一个大的 base64 编码字符串，我这样做是因为我需要以 JSON 格式发布请求。现在由于 JSON 具有 IIS 立即拒绝的特殊字符，我尝试使用 URLencode。问题是你不能超过 1000 个字符左右。长度是有限的。Base64 编码和使用 post 是唯一的方法，这就是我使用此代码的原因。

此 Rest 服务的最初目标是能够为基于 javascript 的客户端提供服务，该客户端将向该服务发送 JSON 帖子并获得 JSON 响应作为回报。没有 xml 字符串填充的纯 JSON 响应。

需要帮助才能使该职位到其余服务部门工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:17:25.377

为什么通过浏览器调用它会失败：浏览器正在发出`GET`请求，而不是`POST`请求。

为什么当您通过 Fiddler 调用它时它会失败：您的内容类型是“application/x-www-form-urlencoded”，但内容不是（它是一个 base64 blob）。即使您有格式良好的 form-urlencoded 数据（`a=foo&b=bar`例如支持，但需要更多的工作）。

您需要做的：您的操作需要一个`string`参数。在 Fiddler 中，您可以将数据的 base64 编码作为 JSON 字符串传递（即，将其包装在`"`. 另外，设置正确的内容类型：

```
POST http://localhost:57395/Service1.svc/getdata
Content-Type: application/json
Host: localhost:57395
Content-Length: <the appropriate length; fiddler will set it for you>

"large base64 string here" 
```

# php - PHP 图像数组将五个图像包装在一个 div 中

> ID：14080679
> 
> 赞同：-3
> 
> 时间：2012-12-29T10:16:03.253
> 
> 标签：php, loops, foreach

我的 mysql 数据库输出一组图像名我被困在这个循环中，请他

```
 <?php foreach ($newarrivaldata as $row){ ?>
       <?php echo $row['imgfile'].'<br/>';?>
  <?php }?> 
```

$newarrivaldata 有 18 个图像文件如何显示它们？

```
<div id='page1'>    img1    img2    img3    img4    img5    </div>

<div id='page2'>    img6    img7    img8    img9    img10    </div>

<div id='page3'>    img11    img12    img13    img14    img15    </div>

<div id='page4'>    img16    img17    img18                    </div> 
```

**更新：var_dump($newarrivaldata)**

```
array
  0 => 
    array
      'idvehicle' => string '970' (length=3)
      'name' => string 'Toyota RX400' (length=12)
      'imgfile' => string '12122809355412.jpg' (length=18)
      'imgtype' => string 'coverimg' (length=8)
  1 => 
    array
      'idvehicle' => string '972' (length=3)
      'name' => string 'asd' (length=3)
      'imgfile' => string '12122815555612.jpg' (length=18)
      'imgtype' => string 'coverimg' (length=8)

  ....upto 17=> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:28:54.577

您能否更新您的问题以包含

```
print_r($newarrivaldata); 
```

如果您只是想逐字输出表格（让我建议您将所有内容重置为以 i=0、行和列开头，我们不以 1 开头，我们总是以 0 开头，所以 page0、img0 等）：

```
$numColumns = 5;
for($row=0; $row<ceil(count($newarrivaldata)/$numColumns); $row++){
   echo "\n<div id='page$row'>";
   for($c=0; $c<$numColumns; $c++){
      if(isset($newarrivaldata[$row+$col])){
         echo '<img src="'.$newarrivaldata[$row+$col]['imgfile'].'" />';
      }
   }
   echo "</div>"
} 
```

我所做的是获取您的数组，并将其拆分为 5 行，但将 $numColumns 更改为另一个值会将其拆分为 $numColumns 列的行。我必须采用 count($newarrivaldata)/$numColumns) 的原因是，如果您的数组不是 $numColumns 的精确倍数，您将收到 PHP 的警告，所以我只是想避免这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:29:07.090

试试这个方法，这将是一个起点

```
<?php
$newarrivaldata = array("one", "two", "three", "four","five","six","seven","eight","nine","ten","elevn","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighten"); 
 $key=1;
foreach ($newarrivaldata as $row){ 
      echo $row."&nbsp;&nbsp;";
     if($key%5 == 0) echo "<br/>";
    $key++;
  }?> 
```

[工作演示](http://phpfiddle.org/main/code/317-t3g)

# java - Spring 3.2 MVC 中的 API 版本控制

> ID：14080684
> 
> 赞同：1
> 
> 时间：2012-12-29T10:16:37.737
> 
> 标签：java, spring-mvc

我正在将现有的 Web 服务移植到 Spring 3.2。我需要版本化的 API，并且每个新版本都有一个控制器。我不想在较新的控制器中重新定义方法，而是希望在最新版本中找不到旧控制器时自动将请求映射到旧控制器。

例如，如果`ControllerV1`has`/home`和has `/login`，那么我希望请求像这样路由。`ControllerV2``/login`

```
/home -> ControllerV1
/v1/home -> ControllerV1
/v2/home -> ControllerV1

/login -> ControllerV1
/v1/login -> ControllerV1
/v2/login -> ControllerV2 
```

一种选择是在`@RequestMapping`. 但是，这意味着每当在新版本中添加 API 时，都会从所有旧控制器中删除路径。实现这一目标的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T13:14:44.723

我建议简单地使用继承：

**版本 1Controller.java**

```
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequestMapping("v1/")
public class Version1Controller {

    @ResponseBody
    @RequestMapping("foo")
    public String foo() {
        return "Foo 1";
    }

    @ResponseBody
    @RequestMapping("bar")
    public String bar() {
        return "bar 1";
    }
} 
```

**版本2控制器.java**

```
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequestMapping({ "v2/", "latest/" })
public class Version2Controller extends Version1Controller {

    @Override
    @ResponseBody
    @RequestMapping("bar")
    public String bar() {
        return "bar 2";
    }

} 
```

在这里，您将映射以下网址：

*   `v1/foo`- 返回“Foo 1”
*   `v2/foo`- 返回 "Foo 1" - 从版本 1 继承
*   `v1/bar`- 返回“酒吧 1”
*   `v2/bar`- 返回“Bar 2” - 覆盖版本 1 的行为。
*   `latest/foo`- 如同`v2/foo`
*   `latest/bar`- 如同`v2/bar`

# jquery - 我需要帮助选择 jQuery Zoom Image Map

> ID：14080687
> 
> 赞同：1
> 
> 时间：2012-12-29T10:16:46.967
> 
> 标签：jquery, plugins, maps, zooming

我需要帮助选择尊重此要求的 Jquery 插件，它是一张城市地图：

1.  **设计**：不想使用谷歌地图或类似的，我想使用自定义背景图片
2.  **区域**：我需要设计城市的区域，例如：市中心等。
3.  **缩放**：通过滚动或单击放大此区域的可能性
4.  **标记**：我需要在这张地图上加上收费提示

我知道谷歌地图通过自定义编程来做到这一点，我想知道是否有其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:23:12.550

您可以尝试使用**`SVG`**，但区域设计可能会成为问题，但结果您可以*平移*/*缩放*/*滚动*地图并使用它做任何您想做的事情，而无需任何*API* \ *Plugins*。

# java - 如何在 JUnit4 中使用休眠测试 DAO

> ID：14080688
> 
> 赞同：3
> 
> 时间：2012-12-29T10:16:47.960
> 
> 标签：java, hibernate, junit4

这似乎是一个类似的问题（[Test DAO in java using Junit4 and Hibernate](https://stackoverflow.com/questions/12916014/test-dao-in-java-using-junit4-and-hibernate)），但他成功创建了会话。我无法创建会话。

请注意，我没有使用 Spring。我只需要测试使用 HibernateUtil.java 创建会话的 DAO

我的示例测试代码（在测试包中）

```
public void testGetBean() {
    System.out.println("getBean");
    int idaccount = 0;
    Account expResult = null;
    Account result = DAOAccount.getBean(idaccount);
    assertEquals(expResult, result);
    // TODO review the generated test code and remove the default call to fail.
    //fail("The test case is a prototype.");
} 
```

这是 DAOAccount getBean() （在源包中）

```
public static Account getBean(int idaccount) {
    Account ac = null;
    Session sess = NewHibernateUtil.getSessionFactory().openSession();
    Transaction tx = sess.beginTransaction();
    Query q = sess.createQuery("from Account where idaccount=:id");
    q.setInteger("id", idaccount);
    ac = (Account) q.uniqueResult();
    tx.commit();
    sess.close();
    return ac;
} 
```

NewHibernateUtil.java（在源包中）

```
public class NewHibernateUtil {
private static final SessionFactory sessionFactory;

static {
    try {
        // Create the SessionFactory from standard (hibernate.cfg.xml) 
        // config file.
//            sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
        sessionFactory = new Configuration().configure().buildSessionFactory();
    } catch (Throwable ex) {
        // Log the exception. 
        System.err.println("Initial SessionFactory creation failed." + ex);
        throw new ExceptionInInitializerError(ex);
    }
}

public static SessionFactory getSessionFactory() {
    return sessionFactory;
}
} 
```

这是堆栈跟踪![在此处输入图像描述](../Images/757bff6610537a29816880012d334322.png)

以下是项目结构：

![在此处输入图像描述](../Images/a88829bf8acf598aea6288dc42247b41.png)

@Subin 询问的实际异常堆栈跟踪

```
[2012-12-29 16:36:24.347] [ INFO] Configuration.applyHibernateValidatorLegacyConstraintsOnDDL:1646 - Hibernate Validator not found: ignoring
Initial SessionFactory creation failed.java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/validation/Validation
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/validation/Validation
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:247)
    at org.hibernate.util.ReflectHelper.classForName(ReflectHelper.java:170)
    at org.hibernate.cfg.beanvalidation.BeanValidationActivator.applyDDL(BeanValidationActivator.java:103)
    at org.hibernate.cfg.Configuration.applyBeanValidationConstraintsOnDDL(Configuration.java:1674)
    at org.hibernate.cfg.Configuration.applyConstraintsToDDL(Configuration.java:1624)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1415)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1826)
    at dao.NewHibernateUtil.<clinit>(NewHibernateUtil.java:25)
    at dao.DAOAccount.getAccounts(DAOAccount.java:77)
    at dao.DAOAccountTest.testGetAccounts_User(DAOAccountTest.java:78)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at junit.framework.TestCase.runTest(TestCase.java:176)
    at junit.framework.TestCase.runBare(TestCase.java:141)
    at junit.framework.TestResult$1.protect(TestResult.java:122)
    at junit.framework.TestResult.runProtected(TestResult.java:142)
    at junit.framework.TestResult.run(TestResult.java:125)
    at junit.framework.TestCase.run(TestCase.java:129)
    at junit.framework.TestSuite.runTest(TestSuite.java:255)
    at junit.framework.TestSuite.run(TestSuite.java:250)
    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:84)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:62)
    at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:140)
    at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:127)
    at org.apache.maven.surefire.Surefire.run(Surefire.java:177)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:338)
    at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:997) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:53:30.553

> public Configuration configure() throws HibernateException 使用名为 hibernate.cfg.xml 的应用程序资源中指定的映射和属性。抛出：休眠异常

`Configuration.configure()`仅当`hibernate.cfg.xml`可用作应用程序资源时才能正常工作。或类路径。

如果您使用 eclipse 来调用您的 Junit 测试，请将 hibernate.cfg.xml 添加到类路径中，因为您使用的是 maven，您是否在 src/main/resources 中有它

请查看此链接以了解为什么会发生 java.lang.ClassFormatError: 发生。 [Maven：hibernate-entitymanager 和 javaee-api 一起破坏了我的单元测试](https://stackoverflow.com/questions/5638479/maven-hibernate-entitymanager-together-with-javaee-api-break-my-unit-tests)

# yii - 在 Yii 中渲染视图时发送 2 个参数

> ID：14080693
> 
> 赞同：-1
> 
> 时间：2012-12-29T10:17:26.430
> 
> 标签：yii

我在 testController 中有一个带有**视图**名称的操作。在这个视图中，我呈现另一个控制器的视图：

```
$this->render('/page/view', array('model' => 'Page')); 
```

我需要在渲染时发送 2 个参数

像这样：`http://localhsot/test/controller/view/1/age/25`或任何东西......

当我使用`$this->render('/page/view', array('model' => 'Page', 'age' => '25'));` 我得到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:26:20.650

我找到了：

```
$this->render('/page/view', array('model' => 'Page', 'age' => '25')); 
```

并认为：

```
echo $age; 
```

# c++ - 我可以在表单应用程序的 while 循环中查询用户交互事件吗？

> ID：14080694
> 
> 赞同：1
> 
> 时间：2012-12-29T10:17:30.117
> 
> 标签：c++, winforms, user-interface, c++-cli, while-loop

在我的 windows 窗体应用程序中，我有一个 while 循环，它不断地轮询操纵杆设备的值，并用这些值不断更新 GUI，然后刷新 GUI。但是，只要我处于 while 循环中，UI 就不会对任何交互做出响应。

有没有办法在我的 while 循环中查询**任何GUI 事件或交互，例如按钮单击或按键？**

如果发生某些事件或交互，我希望能够退出循环。我至少希望关闭和最小化按钮起作用。

因为我只需要每秒轮询操纵杆和更新 GUI 20 次，所以大部分循环时间只是睡眠时间。但我想在这段时间等待事件和互动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:41:32.713

你在使用游戏控制器吗？如果是这样，您如何从中获得输入？

使用普通的 Windows 输入（鼠标和键盘），您将调用重写的 OnXxx 方法（或调用相应的事件）。

显然，在不停止 UI 的情况下执行阻塞或长时间运行的操作的常用方法是在单独的线程中运行该操作。但是，这实际上取决于您如何从设备获取输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:44:17.087

我解决了这个问题比我预期的要简单得多。基本上，GUI 应用程序中的 while 循环似乎是个坏主意。尝试**使用 while 循环**从单独的线程更新 GUI是行不通的，或者只是不好的编程习惯。

我没有使用 while 循环无限期地连续调用一个函数，而是使用一个定时器来触发一个函数，该函数每 50 毫秒轮询一次操纵杆。这意味着 GUI 在其余时间可以自由更新自己。我不需要强制它刷新或查询任何用户交互。因为这些功能只运行非常短暂，所以 GUI 有足够的时间来呼吸，不会错过任何交互或事件。

总而言之，计时器驱动的函数调用可以替代 while 循环，并且可以使您免于 GUI 应用程序中的多线程噩梦。

# objective-c - Facebook sdk3.1 中的注销功能崩溃

> ID：14080695
> 
> 赞同：1
> 
> 时间：2012-12-29T10:17:31.537
> 
> 标签：objective-c, ios, cocoa-touch, facebook-ios-sdk

```
I am using facebook sdk 3.1 & FBloginview.So i want to perform logout functionality 
from other view controller..
 Here is my code,

-(void)logout
{
    AppDelegate *appdelegate = [[UIApplication sharedApplication] delegate];

    if (FBSession.activeSession.isOpen) 
    {
        [appdelegate closeSession];       
    }
    [appdelegate openSessionWithAllowLoginUI:NO];
 } 
```

在应用程序委托方法中，

```
- (void) closeSession
{
    [FBSession.activeSession closeAndClearTokenInformation];
} 
```

所以在`closeSession`我得到的方法中`EXC_BAD_ACCESS`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:32:42.560

在注销按钮上单击删除存储在 facebook 的 userdefault 中的所有密钥

```
- (void)fbDidLogout
{
  NSHTTPCookie *cookie;
  NSHTTPCookieStorage *storage = [NSHTTPCookieStorage sharedHTTPCookieStorage];

  for (cookie in [storage cookies])
  {
      NSString* domainName = [cookie domain];
      NSRange domainRange = [domainName rangeOfString:@"facebook"];
      if(domainRange.length > 0)
      {
          [storage deleteCookie:cookie];
      }
   }
} 
```

或者

Facebook 类已经在其 invalidateSession 函数中包含了 cookie 删除，

这被称为`[facebook logout];`

# c# - 图钉标注 bing maps sdk metro app xaml c#

> ID：14080698
> 
> 赞同：1
> 
> 时间：2012-12-29T10:18:09.657
> 
> 标签：c#, winrt-xaml, store, bing-maps

我正在为 Windows 商店应用程序使用 bing maps sdk。我试图在单击图钉后立即显示标注。我该怎么做？我知道我需要一个自定义控件，但最好有代码来做。我在哪里可以找到一个例子？

![](../Images/492a8e4a2625e5ded28dae4c0de52cad.png)

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-15T10:36:13.443

将弹出窗口包含为地图控件的子项。

```
 <!-- Map Control -->
    <map:Map x:Name="map" Credentials="{StaticResource BingCredentials}" 
             ShowScaleBar="True" 
             ShowNavigationBar="False" 
             ShowBreadcrumb="False" 
             LogoPosition="TopRight"
             ViewRestriction="OneWorldOnly"
             Loaded="Map_Loaded"
             PreloadArea="Medium">

             <!-- pins -->
        <map:MapLayer x:Name="mapPinLayer" Visibility="Visible">
            <map:MapItemsControl x:Name="mapPins" ItemsSource="{Binding}">
                <map:MapItemsControl.ItemTemplate>
                    <DataTemplate>
                        <map:Pushpin IsTapEnabled="True" Style="{StaticResource PushPinStyle}" map:MapLayer.Position="{Binding Location}" Tag="{Binding}" Tapped="Pushpin_Tapped" />
                    </DataTemplate>
                </map:MapItemsControl.ItemTemplate>
            </map:MapItemsControl>
        </map:MapLayer>

        <!-- pin popup -->
        <Popup x:Name="PushpinPopup" IsLightDismissEnabled="True" DataContext="{Binding}" Tag="{Binding}">
            <Border BorderBrush="#F08D45" BorderThickness="1">
                <Grid Background="White" Width="300"  >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Row="0" Background="#F08D45">
                        <TextBlock Grid.Row="0" Foreground="White" FontSize="16" FontWeight="Bold" Text="{Binding Name}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10" />
                    </StackPanel>
                    <StackPanel Grid.Row="1" Orientation="Vertical" Margin="15">
                        <StackPanel Orientation="Horizontal" Visibility="{Binding Telephone, Mode=OneWay, Converter={StaticResource StringToVisibility}}">
                            <TextBlock Text="Tel" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5" FontSize="12" />
                            <TextBlock Text="{Binding Telephone}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5" FontSize="12"  />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Visibility="{Binding Fax, Mode=OneWay, Converter={StaticResource StringToVisibility}}">
                            <TextBlock Text="Fax" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5" FontSize="12"  />
                            <TextBlock Text="{Binding Fax}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5" FontSize="12"  />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Visibility="{Binding Email, Mode=OneWay, Converter={StaticResource StringToVisibility}}">
                            <TextBlock Text="Email" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5" FontSize="12"  />
                            <HyperlinkButton Content="{Binding Email}" NavigateUri="{Binding EmailMailTo}" HorizontalAlignment="Left" ClickMode="Press" 
                                             VerticalAlignment="Center" Margin="5" FontSize="12" Foreground="#F08D45" />
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="buttonGetDirections" Click="buttonGetDirections_Click">Get Directions</Button>
                            <Button x:Name="buttonShowServices" Click="buttonShowServices_Click" Tag="{Binding}">Services</Button>
                        </StackPanel>

                    </StackPanel>
                </Grid>
            </Border>
        </Popup>

    </map:Map> 
```

然后处理图钉点击事件：

```
 private void Pushpin_Tapped(object sender, Windows.UI.Xaml.Input.TappedRoutedEventArgs e)
    {
        Pushpin p = sender as Pushpin;
        if (p != null && p.Tag != null)
        {
            PushpinModel model = p.Tag as PushpinModel;
            if (model != null) ShowPushpinContent(model);
        }
    }

    private void ShowPushpinContent(PushpinModel model)
    {
        PushpinPopup.IsOpen = false;
        PushpinPopup.DataContext = model;
        PushpinPopup.IsOpen = true;
        MapLayer.SetPosition(PushpinPopup, model.Location);
        currentmodel = model;
    } 
```

# google-maps - 地图页面加载未完成

> ID：14080702
> 
> 赞同：0
> 
> 时间：2012-12-29T10:18:45.633
> 
> 标签：google-maps, firefox, google-maps-api-3

我们的网站按设计工作，但有一个小问题但令人恼火。该问题似乎仅在页面加载到 Firefox 时才会出现。我正在使用 Firefox 17.0.1。在所有其他经过测试的浏览器上，加载完成。

加载后，该站点会显示地图、自定义标记和其他所有内容，但通常加载没有完成，会显示一条消息“等待 maps.googleapis.com”。唯一的效果是持久的“等待”消息。要刷新页面，您必须先取消原始加载，然后重新加载。看着 Firebug，它似乎没有完成它的加载。等待完成的文件总是

```
https://maps.googleapis.com/maps/api/js/StaticMapService.GetMapImage?1m2&1i15626&2i7568&2e2&3u6&4m2&1u1507&2u792&5m3&1e4&2b1&5sen-US&token=49261 
```

就像我说的，轻微但令人恼火 - 一些用户报告该站点已损坏，因为即使一切都按设计工作，他们仍看到持续的“等待”消息。

尽管这可能是 Firefox 问题，但我在此处发布以查看是否有其他人遇到此问题以及是否存在任何解决方案。

我能做些什么来进一步探索（或解决）这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:20:24.327

在 v3 地图页面上使用 Firefox 18.0 时遇到了同样的问题。在其他浏览器中完美运行。只是做了其中之一：

```
google.maps.event.addListener(map, 'tilesloaded', function() {  
    window.stop();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T12:00:14.953

如果您在继续之前等待地图完成加载，请确保您注册到地图空闲事件而不是瓦片加载事件。

# java - Struts2 要求用户上传文件验证

> ID：14080706
> 
> 赞同：0
> 
> 时间：2012-12-29T10:19:21.383
> 
> 标签：java, forms, file, struts2

我正在使用 Struts2 文件上传将文件上传到我的服务器，我的问题是我如何具体说明上传文件是必需的？这是我的拦截器。

```
<action name="audioupload" class="actions.AudioUploadAction"
        method="execute">
        <interceptor-ref name="basicStack" />
        <interceptor-ref name="fileUpload">
            <param name="allowedTypes">text/html</param>
        </interceptor-ref>
        <interceptor-ref name="validation" />
        <interceptor-ref name="workflow" />
        <result name="input">/UploadAudio.jsp</result>
        <result name="success">/UploadSuccess.jsp</result>
    </action> 
```

我如何明确告知用户需要上传文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:33:33.257

您可以做的是创建一个 ActionClass-validation.xml 并在其中声明它。

```
<validators>
    <field name="theNameOfTheFileTag">
        <field-validator type="required">
            <message>File is required.</message>
        </field-validator>
    </field>
</validators> 
```

# php - 如果没有列更改，如何从 MySQL 获取结果集

> ID：14080710
> 
> 赞同：0
> 
> 时间：2012-12-29T10:19:31.680
> 
> 标签：php, phpmyadmin, mysqli

我有一个如下表

```
CREATE TABLE Statistics(Stat_Id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
                        Period  VARCHAR(55),
                        Location VARCHAR(255),
                        Rate_per_SqFt INT)

INSERT INTO Statistics(Period, Location, Rate_per_SqFt)
                VALUES('June', 'Location A', 2500),
                      ('June', 'Location B', 2740),
                      ('June', 'Location C', 3200),
                      ('July', 'Location A', 2650),
                      ('July', 'Location B', 2800),
                      ('July', 'Location C', 3250),
                      ('August', 'Location A', 2750),
                      ('August', 'Location B', 2950),
                      ('August', 'Location C', 3230),
                      ('October', 'Location A', 2950),
                      ('October', 'Location B', 3950),
                      ('October', 'Location C', 3530); 
```

我使用了以下过程

```
DROP PROCEDURE IF EXISTS test.stats_report;
CREATE PROCEDURE test.`stats_report`()
BEGIN
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(CASE WHEN Location = ''',
      Location,
      ''' then Rate_per_SqFt ELSE 0 end) AS ',
      CONCAT('`',Location,'`')
    )
  ) INTO @sql
FROM statistics;

SET @sql = CONCAT('SELECT Period, ', @sql, ' 
                   FROM Statistics 
                   GROUP BY Period');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
END; 
```

它带来如下输出

```
 Period   Location A     Location B     Location C 
 June        2500          2740           3200
 July        2650          2800           3250
 August      2750          2950           3230
 October     2950          3950           3530 
```

由于我在 MySQL 过程中动态生成列，因此我不知道如何使用 MySQLi 绑定方法或其他任何方法从 PHP 中的结果集中获取行。

如何从结果集中获取列数未知的行。

请注意，我想要位置 A、位置 B 和位置 C，我在结果集中指定为列。

现在，当我添加新位置 D 时，它将作为新列出现。

您可以在[这里查看 MySQL 表](http://sqlfiddle.com/#!2/bdf9c/1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:08:42.927

您始终可以将结果集中的行作为数组处理，并使用 foreach 循环遍历它们。您没有包含您的 PHP 代码，所以我们不知道这是 via`PDO`还是`MySQLi`.. 所以这可能有点离题..*但是*..

有关结果集的信息可从[元数据](http://php.net/manual/en/mysqli-stmt.result-metadata.php)中获得。`MySQLi`首先：

```
/* get resultset for metadata */   
$result = $stmt->result_metadata(); 
```

[然后使用](http://php.net/manual/en/mysqli-result.fetch-fields.php)`fetch_fields`它这样调用：

```
/* Get field information for all columns */
$fields = $result->fetch_fields();

foreach ($fields as $field) {} 
```

[PDO](http://php.net/manual/en/pdostatement.getcolumnmeta.php)也有类似的功能。

# jquery - jQuery 加载（）函数

> ID：14080713
> 
> 赞同：0
> 
> 时间：2012-12-29T10:19:46.570
> 
> 标签：jquery

```
$(document).ready(function(){
    $("#btnLoad").click(function(){
        $('#div1').load('test.txt', {}, fnLoad());
    });
});

function fnLoad()
{
    // How can I load the content of <div id="div1" /> into a variable here?
} 
```

事实上，我想使用变量而不是 div1.innerHTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:24:36.303

将 $.get 用于 xhr 请求，如下所示：

```
$(document).ready(function(){
    $("#btnLoad").click(function(){
        $.get('test.txt', fnLoad);
    });
});

function fnLoad(data)
{
    // Contents of test.txt should be in data argument here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:24:52.167

```
$(document).ready(function(){
    $("#btnLoad").click(function(){
        $('#div1').load('test.txt', {}, fnLoad));
    });
});

function fnLoad(result)
{
    // The variable `result` contains the response of the AJAX call.
} 
```

这很像`result`在调用本身中传入一个匿名函数`.load()`，但是您已经将该函数拆分为它自己的，命名为 one。您需要传递对`fnLoad()`. `result`将包含响应数据。[函数原型`.load()`接受 3 个参数](http://api.jquery.com/load/#example-1)：

> `response, status, xhr`

您可以将这些映射到您喜欢的任何变量名称`fnLoad()`。

# ajax - Jersey，使用 JSON 数组

> ID：14080717
> 
> 赞同：0
> 
> 时间：2012-12-29T10:20:06.473
> 
> 标签：ajax, rest

嗨，谁能告诉我如何在休息消耗方法中处理这个 json

在我的客户端我有这个代码：

```
var search_form_data_array = new Object();

search_form_data_array[0] = JSON.stringify({name: "dept",
    type:"equal",
    value: "233"});

search_form_data_array[1] = JSON.stringify({ name: "deptDesc", 
    type:"equal", 
    value:"depts" });

$.ajax({
    url: globalvars.otherDiscoveredSearchFormUri,
    type:'POST',
    data:{"SearchFormInput":search_form_data_array},
    contentType:'application/json',
    success: function(){}
}); 
```

我的服务器端代码：

```
@POST
@Path("/SearchForm")
@Consumes(MediaType.APPLICATION_JSON)
public String getOtherChargesSerachData(SearchFormInput data)

    return data.name;
}

public static class SearchFormInput {
    public String name;
    public String type;
    public String value; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:40:21.297

您可以使用 XStream 进行阅读：

```
protected Object loadFromJSONRequest(String strJSON, Map<String, Class> aliasMap) {
    String aliasValue = "";
    try {
        XStream xStream = new XStream(new JettisonMappedXmlDriver());
        aliasValue = includeAliasesForRequest(xStream, aliasMap);
        return xStream.fromXML(strJSON);
    } catch (XStreamException e) {
        logExceptions(BaseResource.class, e.getStackTrace().toString());
        throw new PubGUIErrorResponse("error." + aliasValue + ".conversion");
    } catch (Exception e) {
        logExceptions(BaseResource.class, e.getMessage().toString());
        throw new PubGUIErrorResponse("error.conversion");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T12:15:31.853

您可以使用Google 的[Gson](http://code.google.com/p/google-gson/)将 json 序列化/反序列化到 Java 对象。

要解析数组，您可以使用类似这样的东西。请注意，参数不能是 SearchFormInput，因为当您发送一个包含列表的虚拟 json 对象时。

```
@POST
@Path("/SearchForm")
@Consumes(MediaType.APPLICATION_JSON)
public String getOtherChargesSerachData(String data){

    // You will need to parse data if you want to send something more than the array

    Gson gson = new Gson();
    Type listType = new TypeToken<List<SearchFormInput>>() {}.getType();
    List<SearchFormInput> searchFormInputList = gson.fromJson(data, listType);

    // iterate searchFormInputList to do whatever you want

    return "Whatever string you want to return";
} 
```

如果你这样发送，

```
$.ajax({
    url: globalvars.otherDiscoveredSearchFormUri,
    type:'POST',
    data:{"SearchFormInput":search_form_data_array},
    contentType:'application/json',
    success: function(){}
}); 
```

您将需要从值“SearchFormInput”中获取数组，然后对其进行解析。如果你不需要这个，你可以只发送数组。就像是：

```
var stringArray = JSON.stringify(search_form_data_array);

...,
data: stringArray,
..., 
```

# mysql - Doctrine2 不会在方案更新时转义表名

> ID：14080720
> 
> 赞同：3
> 
> 时间：2012-12-29T10:20:33.790
> 
> 标签：mysql, doctrine-orm

我建立了一个doctrine2实体类`Group`并引用了表名：

```
/**
 * models\Entity\Group
 *
 * @ORM\Entity(repositoryClass="models\Repository\GroupRepository")
 * @ORM\Table(name="`group`", indexes={@ORM\Index(name="admin", columns={"`admin`"})})
 */
class Group
{ 
```

但是教义似乎没有在每个查询中引用表名。当我运行`doctrine orm:schema-tool:update --dump-sql`最后两个查询时没有转义：

```
ALTER TABLE group DROP FOREIGN KEY FK_6DC044C5814666E9;
ALTER TABLE group ADD CONSTRAINT FK_6DC044C5814666E9 FOREIGN KEY (`admin`) REFERENCES `user` (`id`) 
```

这里做错了吗？

**编辑**

现在我更换了

```
 if ($table instanceof Table) {
        $table = $table->getQuotedName($this);
    } 
```

这样

```
 if ($table instanceof Table) {
        $table = $table->getQuotedName($this);
    } /* Start hack */ else if (0 !== strpos($table, '`'))
        $table = "`$table`"; /* End hack */ 
```

在`\Doctrine\DBAL\Platforms\AbstractPlatform::getCreateForeignKeySQL()`和`getDropForeignKeySQL()`。但这当然不是……嗯……一个很好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-26T17:00:57.653

我也有类似的情况。不过，似乎原始错误已得到修复。

跑步：

```
./vendor/bin/doctrine-module orm:schema:create --dump-sql 
```

给出这个 SQL，这是正确的。

```
ALTER TABLE groups_user ADD CONSTRAINT FK_F0F44878A76ED395 FOREIGN KEY (user_id) REFERENCES User (id);
ALTER TABLE groups_user ADD CONSTRAINT FK_F0F44878FE54D947 FOREIGN KEY (group_id) REFERENCES `group` (id); 
```

上面的表名已正确转义。

**然而**

稍后尝试从该表中进行*SELECT*时，出现错误。

```
function getGroupByName($name)
{
    $em = $this->getEntityManager();
    $criteria = array('name' => $name);
    return $em->getRepository('Module\Entity\Group')
        ->findOneBy($criteria);
} 
```

抛出：

```
An exception occurred while executing 'SELECT t0.id AS id1, t0.name AS name2 FROM group t0 WHERE t0.name = ? LIMIT 1' with params ["The Group Name"]:

SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'group t0 WHERE t0.name = 'The Group Name' LIMIT 1' at line 1 
```

正如你在上面看到的，`FROM group t0 WHERE`表名应该被转义，但不是。

我愚蠢的解决方案是保持所有实体名称相同，并简单地更新 ORM 注释以使用复数“组”。

在模块\实体\组中

```
/**
 * @ORM\Table(name="groups")
 */ 
```

在模块\实体\用户

```
/**
 * @ORM\ManyToMany(targetEntity="Module\Entity\Group", inversedBy="users")
 * @ORM\JoinTable(
 *     name="groups_user",
 *     joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id", nullable=false)},
 *     inverseJoinColumns={@ORM\JoinColumn(name="group_id", referencedColumnName="id", nullable=false)}
 * )
 */
private $groups; 
```

这不是纯粹主义者，但它意味着不破解Doctrine，并且实体名称可以保持不变。

# c - Chudnovsky 算法产生 -nan

> ID：14080721
> 
> 赞同：1
> 
> 时间：2012-12-29T10:20:39.860
> 
> 标签：c, math, precision, pi, floating-point-precision

我正在尝试实现用于计算 pi的[Chudnovsky 算法。](http://en.wikipedia.org/wiki/Chudnovsky_algorithm)

这是我的实现：

```
int fact(int n)
{
    if(n<=1)
        return 1;
    else
        return fact(n-1)*n;
}

double calcPi(long n)
{
    double z=0;
    for(int k=0; k<n; k++)
    {
        z+=(pow(-1, k)*fact(6*k)*(13591409 + 545140134.0*k))/(fact(3*k)*pow(fact(k), 3)*pow(640320.0, 3.0*k+3.0/2));
    }
    z*=12;
    return 1/z;
} 
```

我遇到了一个小错误。当我插入大于 12 的 N 值时，我得到 -nan。我猜这与有限的精度、某种整数溢出或我绝对糟糕的阶乘实现有关（是的，我很懒惰并使用了递归。现在是凌晨 2 点）。

无论如何，如果您以前经历过这种情况并且可以提出快速修复的建议，那就太好了。

也许我应该只使用 Python，而不必担心溢出。

（几乎）新年快乐！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:32:35.283

浮点算术这不是微不足道的，考虑到你的问题，我更喜欢用一些技巧来回答你的问题。

您可以使用诸如[GMP](http://gmplib.org/)或[MPFR](http://www.mpfr.org/)之类的库来解决此问题，这对两者来说都是[一个很好的常见问题解答](http://www.mpfr.org/faq.html#mpfr_vs_mpf)。

如果你真的想掌握这一点，在几乎所有主要的编程语言上，你绝对应该从阅读 IEEE 754 开始。

# unicode - 如何在 VB6 中显示 Unicode 字符？

> ID：14080723
> 
> 赞同：5
> 
> 时间：2012-12-29T10:21:08.223
> 
> 标签：unicode, vb6, chr

> **可能重复：**
> [在 VB6 中显示 Unicode 文本（希伯来语等）的最佳选择是什么](https://stackoverflow.com/questions/540361/whats-the-best-option-to-display-unicode-text-hebrew-etc-in-vb6)

`9646`在 VB6 中显示 unicode 字符（BLACK VERTICAL RECTANGLE）的正确方法是什么？

当我尝试`ChrW(9646)`它时显​​示`?`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T11:35:33.547

这是一个探索的[教程。](http://cyberactivex.com/UnicodeTutorialVb.htm)看看这篇文章的[黑色垂直矩形](http://www.fileformat.info/info/unicode/char/25ae/index.htm)。

假设 Unicode 已打开，请将以下字符串发送到窗口以显示：

`Wchar_t mStr[] = {9646,0,0};`

[参考](http://www.codeproject.com/Questions/454574/How-to-show-special-characters-in-an-Edit-Control)。此代码片段和参考更内嵌于 C++。您可以使用以下步骤在 Visual C++ 中关闭/打开 UNICODE：

1.  在VS2008/2010中打开你的项目；

2.  右键单击解决方案资源管理器中的项目，然后单击属性；

3.  选择`Configuration Properties-> General`，选择`Character Set`并更改`current value`为`Use Multi-Byte Character Set`。（关闭）

* * *

**[关于在 VB 中显示 UNICODE 的](http://www.example-code.com/vb/vbUnicode1.asp)****好文章**。

当您在 a中使用`textbox`控件时`Form`，将其添加`Microsoft Forms 2.0 Object Library`为参考库。该组件**提供支持Unicode的控件**，例如：文本框、标签、命令按钮、列表框、组合框、复选框、单选按钮、切换按钮、图像、标签条和多页控件。

使用 VB6 并显示非美国 ANSI 字符，您需要了解 3 个主要内容：

*   在内部，VB6 将字符串存储为 Unicode。
*   显示字符串时，**标准的 VB6 文本框和标签控件**执行从 Unicode 到 ANSI 的隐式（和内部）转换。
*   **标准 VB6 文本框和标签控件**根据您可以指定的字符编码显示 ANSI 字节。

转换后`Unicode-to-ANSI`，VB6 会尝试根据控件的`Font.Charset`属性显示字符数据，如果保持不变，则等于 ANSI 字符集。更改控件会`Font.Charset`更改 VB6 解释“ANSI”字节的方式。换句话说，您告诉 VB6 将字节视为其他字符编码而不是“ANSI”。

例如，考虑尝试`Unicode Japanese`在计算机上显示字符串`English`：您设置`Font.Charset = 128`（用于日语），但您的 Unicode 字符串显示为所有问号字符。这是因为 VB6 首先尝试将您的日文 Unicode 字符串转换为 ANSI，即适用于英文计算机的[Windows-1252](https://msdn.microsoft.com/en-us/library/cc195054.aspx)。日文字符在 Windows-1252 中不可表示。每个字符都无法转换并替换为问号。**例如，在 TextBox 控件的属性设置中选择日文脚本与在运行时设置 Font.Charset 相同。**

正如**Jukka 所说** `Font`，鉴于字体中字符的可用性，显示 UNICODE 起着至关重要的作用。正如汉斯所说，`glyph`不受支持的字体会产生一个矩形。所以你需要确保`Font`你选择的能够**渲染字形**。例如`MS Sans Serif`，字体不呈现`ƒ`（LATIN SMALL LETTER F WITH HOOK，2 字节 Unicode 值为 0x0192），因此您会在其位置看到一个**细长的实心矩形框**。但是在 Windows 上，很少有字体具有足够广泛的字符库来代表中文。

**在以下代码中，字体名称 () 在运行时沿字体字符集设置**

字符集属性：

```
134     Simplified Chinese, gb2312 - Mainland China(PRC) and Singapore
136     Traditional Chinese, big5 - Taiwan and Hong Kong 
```

代码：

```
Sub changeToUniCodes()
Dim strTxt2 As String    

UserForm1.TextBox2.Font.Charset = 134    '--CHINESESIMPLIFIED_CHARSET
UserForm1.TextBox2.Font.Name = ChrW(&H5B8B) + ChrW(&H4F53) '-- 宋体 SimSun font

UserForm1.TextBox2.Text = ChrW(37446)
strTxt2 = UserForm1.TextBox2.Text
'notice that ChrW(9246) produces a different character in Chinese
UserForm1.TextBox2.Text = strTxt2 & " " & ChrW(9246)
End Sub 
```

VBE IDE 中的输出：您也可以尝试使用 VB6 形式。

![在此处输入图像描述](../Images/4297ad942dd5ecf6d504e280709dbe67.png)

经过以上所有的写作，我注意到了这篇[MSDN](https://docs.microsoft.com/en-us/globalization/encoding/transformations-of-unicode-code-points)文章。好吧，至少这是 VB 确认 :D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T10:04:22.367

您需要的是使用“Unicode 感知”控件。VB6 只附带了其中的一些，但在 Vista 和更高版本或 XP（仅限平板电脑版，除非您使用此库的非 Ink redist 版本）中，InkEdit 控件可以做到这一点。

```
InkEdit1.Text = ChrW$(9646) 
```

注意`$`which 表示一个函数返回一个字符串而不是一个嵌入其中的变体。

InkEdit 控件实际上是一个增强的 RichTextBox，它支持墨迹输入以及在启用墨迹的系统上打字。它也是一个 Unicode 控件，并且支持 Unicode 属性，例如`.Text`.

标准的 MSHFlexGrid、DataGrid 和一些其他控件也支持 Unicode。

有关问题中的字符，请参见[http://www.alanwood.net/unicode/geometric_shapes.html](http://www.alanwood.net/unicode/geometric_shapes.html)。你基本上可以忽略关于 ANSI、Charset 等的 jibber-jabber。它是相关的，但在这里不适用。

`▮ 9646 ▮ 25AE BLACK VERTICAL RECTANGLE`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:52:25.463

它显示问号的原因是该字符不存在于所使用的字体中。您需要将字体设置为[支持 BLACK VERTICAL RECTANGLE](http://www.fileformat.info/info/unicode/char/25ae/fontsupport.htm)的字体，例如 Arial Unicode MS 或 Lucida Sans Unicode。

# javascript - 提交时形成无线电重定向

> ID：14080730
> 
> 赞同：0
> 
> 时间：2012-12-29T10:22:10.597
> 
> 标签：javascript

我想为网站做一个小测验。当检查问题（1）和问题（2）中的每个收音机时，它应该重定向。

```
<form action="" method="post">

<p>Question (1)</p>
    <span>500</span>
        <input type="radio" value="a1"/>
        <span>1000</span>
        <input type="radio" value="b2"/>
        <span>2000</span>
        <input type="radio" value="c3"/>

<p>Question (2)</p>
    <span>1000</span>
        <input type="radio" value="a4"/>
        <span>2000</span>
        <input type="radio" value="b5"/>

<input type="button" value="Go" />

</form>

a1 + a4 redirect to a.html
a1 + b5 redirect to b.html
b2 + a4 redirect to c.html
b2 + b5 redirect to d.html
c3 + a4 redirect to e.html
c3 + b5 redirect to f.html 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:35:33.263

为此，您必须使用 javascript 在使用 javascript 提交和提交页面之前检查收音机

# jquery - 动画背景位置在浏览器上的工作方式不同

> ID：14080731
> 
> 赞同：1
> 
> 时间：2012-12-29T10:22:10.640
> 
> 标签：jquery, css, cross-browser

[fiddle here](http://jsfiddle.net/z5HQV/5/) - 目标是在背景上滚动时产生一些透视效果。

它在 Chrome、IE7、IE8 上运行良好，但是：

它在 IE9 上奇怪地工作（背景重置其位置之前`animation`）它在 Mozilla 和 Opera 上不起作用（滚动工作但背景位置不工作）

它在触发鼠标滚轮事件时动画页面滚动，并且动画背景位置移动比正文滚动多一点，这是什么给透视感觉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T01:37:01.960

要解决 IE9（和 Mozilla 等）的问题，请从“background-position-x”中删除“-x”。现代浏览器不再使用它，因为它不是任何标准规范的一部分。如果你想用 jQuery 的 animate 方法改变背景位置，你必须同时包含 X 和 Y 属性。

```
$('div').animate({'background-position':'0px 50px'});
-OR-
$('div').animate({'background-position':'50px 0px'}); 
```

*background-position-x*和*background-position-y*是微软在旧版 IE 中实现的 css 元素。谷歌的人喜欢这个想法，所以采纳了它。我相信 Chrome 仍然允许您拆分属性，但我不会指望它:) 最后，这与“不要指望它”的情况相一致，您不必包含“px”尺寸。有些元素不需要它为零值，但有些浏览器似乎在 javascript 中需要它。

# python - 使用 open() Python 3 进行文件编码

> ID：14080733
> 
> 赞同：0
> 
> 时间：2012-12-29T10:22:59.970
> 
> 标签：python, encoding, utf-8

我有一个使用 open() 创建多个文件的脚本。所有文件都已成功创建，似乎没有问题，但是在尝试运行 res.py 时，它崩溃并显示以下错误：

```
 File "C:\Users\Mirac\Python\res.py", line 38
SyntaxError: Non-UTF-8 code starting with '\xd7' in file C:\Users\Mirac\Python\res.py on line 38, but no encoding declared; 
```

通过 IDLE 打开文件时，出现“指定文件编码”窗口：

```
The file's encoding is invalid for Python 3.x. 
IDLE will convert it to UTF-8.
What is current encoding of the file? 
```

这是 res.py 的第 38 行：

```
print("Configuration file updated.") 
```

那么，我可以在创建过程中将编码设置为文件吗，如下所示：

```
open("res.py", "w").encoding("UTF-8")
with open("res.py", "a") as file:
    file.write("File contents here") 
```

如果没有，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:29:10.403

这不是您如何在 Python 中打开和写入文件的问题。这是 Python 试图读取你的 python*源*文件的问题。您需要为*源*文件指定编码，以便 Python 可以`.py`正确读取文件。

你需要弄清楚你的编辑器在编写这个文件时使用了什么编码。将其作为注释添加到文件顶部（第一行或第二行）：

```
# coding: latin-1 
```

请参阅Python Unicode HOWTO 的[Python 源代码中的 Unicode Literals](http://docs.python.org/3/howto/unicode.html#unicode-literals-in-python-source-code)部分。

请注意，您提供的错误消息不完整，以下文本是其中的一部分：

```
see http://www.python.org/peps/pep-0263.html for details 
```

链接的[PEP 263](http://www.python.org/peps/pep-0263.html)更详细地解释了源代码编码。

# hibernate - Hibernate Collection 缓存：如何使用？

> ID：14080735
> 
> 赞同：5
> 
> 时间：2012-12-29T10:23:07.003
> 
> 标签：hibernate, collections, second-level-cache, infinispan

我有两个实体书和作者。这本书有作者的集合。我正在使用二级缓存来保存 Book 实体及其作者。调试时，我可以看到`putForExternalRead`Book 实例和集合中的每个作者都在发生。但是当我`find(Book.class, ISBN)`再次调用方法时，它只为书使用缓存，而每次从数据库中检索作者的集合。每次将作者集合放入二级缓存中。如果有一些地方我需要更改收集的缓存访问策略，请告诉我。我正在使用 Jboss 6.0 Infinispan 5\. 和 postgres 9 DBMS。

这是我的代码

```
package bookentity.ejb; 
```

/* * 要更改此模板，请选择工具 | 模板 * 并在编辑器中打开模板。*/

```
import java.io.Serializable;
import java.util.ArrayList;
import javax.persistence.Cacheable;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;
import javax.persistence.ManyToMany;
import javax.persistence.JoinTable;
//import javax.persistence.JoinColumns;
import javax.persistence.JoinColumn;
import java.util.Collection;
import java.util.List;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
//import javax.persistence.inv
import javax.persistence.OneToMany;

@Entity
@Cacheable
@Table(name = "BOOK")
@NamedQueries({@NamedQuery(name="findBookByAuthorName",query="SELECT b FROM Book b,            Author a  WHERE  a.authorName=:authorName AND b = SOME(SELECT x FROM a.books x)"),
@NamedQuery(name="findBookByTitle",query="SELECT b FROM Book b WHERE   b.title=:bTitle")}) 

public class Book implements Serializable {
private static final long serialVersionUID = 1L;
@Id
private int ISBN;
private String title;
private String description;
private Author author;
// @ManyToMany(fetch=FetchType.LAZY)
@ManyToMany(fetch=FetchType.EAGER)
@JoinTable(name="BOOK_AUTHOR", joinColumns=@JoinColumn(name="BOOK_ID"),
inverseJoinColumns=@JoinColumn(name="AUTHOR_ID"))
private Collection<Author> authors;

 //@OneToMany(fetch=FetchType.EAGER, mappedBy="bookEntity")
  @OneToMany(fetch=FetchType.LAZY, mappedBy="bookEntity")
 public Collection<Review> reviews; 

   public Book() {
    authors = new ArrayList<Author>();
    reviews = new ArrayList<Review>();
}

public int getISBN() {
    return ISBN;
}

public void setISBN(int ISBN) {
    this.ISBN = ISBN;
}
public String getTitle(){
    return title;
}

 public void  setTitle(String title){
    this.title =  title;
}

  public String getDescription(){
    return description;
}

 public void  setDescription(String description){
    this.description =  description;
}
 public void addReview(Review review){
     if(!getReviews().contains(review)){
         getReviews().add(review);

     if(review.getBookEntity()!=null){
         review.getBookEntity().getReviews().remove(this);
     }
         review.setBookEntity(this);
     }
 }
 public void addAuthor(Author author){
     if  (!getAuthors().contains(author)){
             getAuthors().add(author);
       }
     if(!author.getBooks().contains(this)){
         author.getBooks().add(this);
     }
 }

 public Collection<Review> getReviews(){
     return reviews;
 }

 public Collection<Author> getAuthors(){

     return authors;
   }

     void setAuhorId(int authorID) {

    }

} 
```

这是作者实体的代码

```
 package bookentity.ejb;

import java.io.Serializable;
import java.util.ArrayList;
import javax.persistence.Cacheable;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.ManyToMany;
import java.util.Collection;
import java.util.Hashtable;
import java.util.List;
import javax.naming.Context;
import javax.naming.InitialContext;

@Entity
@Cacheable
public class Author implements Serializable {
private static final long serialVersionUID = 1L;
@Id 
private int author_id;
String authorName;
 String authAddress;
@ManyToMany(mappedBy = "authors")
private Collection<Book> books;

public Author() { 
    books = new ArrayList<Book>();
}

public void setAuthor_id(int author_id) {
    this.author_id = author_id;

}

public int getAuthorId() {
    return this.author_id;
}

 public void setAuthorName(String  authorName) {
    this.authorName = authorName;
}

public String getAuthorName() {
    return authorName;
}
public String getAuthorAddress(){
    return this.authAddress;
}
 public void setAuthorAddress(String authAddress){
    this.authAddress = authAddress;
}

public Collection<Book> getBooks() {
   return books;

}

public void addBook(Book book){
    if(!getBooks().contains(book)) {
    getBooks().add(book);
    //book.getAuthors().add(this);
   }
if (!book.getAuthors().contains(this)){
    book.getAuthors().add(this);
  }
}

} 
```

这是persistence.xml文件

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
version="1.0">
<persistence-unit name="BookAuthorApp3-ejbPU" transaction-type="JTA">
<provider>org.hibernate.ejb.HibernatePersistence</provider> 
<jta-data-source>java:/PostgresDS</jta-data-source>
<properties>
<property name="hibernate.hbm2ddl.auto" value="update"/>
<property name="hibernate.transaction.manager_lookup_class" value="org.hibernate.transaction.JBossTransactionManagerLookup"/>   
<property name="hibernate.session_factory_name" value="SessionFactories/infinispan1" />
<property name="javax.persistence.sharedCache.mode" value="ALL" /> 
<property name="hibernate.cache.use_second_level_cache" value="true" />
<property name="hibernate.cache.use_query_cache" value="true" />  
<property name="hibernate.cacheable" value="true" /> 
<property name="hibernate.cache.use_structured_entries" value="true" />
<property name="hibernate.cache.infinispan.collection.cfg" value="entity" />
<property name="hibernate.cache.infinispan.bookentity.ej.Book.cfg" value="Books"/>
<property name="hibernate.cache.infinispan.bookentity.ej.Book.authors.cfg" value="Authors"/>
<property name="hibernate.cache.infinispan.statistics" value="true"/>
<property name="hibernate.generate_statistics" value="true" />   
<property name="hibernate.cache.region_prefix" value="infinispan" />
<property name="hibernate.cache.infinispan.entity.cfg" value="entity" />
<property name="hibernate.cache.region.factory_class" value="org.hibernate.cache.infinispan.JndiInfinispanRegionFactory" />
<property name="hibernate.cache.infinispan.cachemanager" value="java:CacheManager/entity" />
 </properties> 
```

这是 infinispan-configs.xml 文件

```
<infinispan-config name="hibernate" jndi-name="java:CacheManager/entity">
<infinispan xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="urn:infinispan:config:5.0    http://www.infinispan.org/schemas/infinispan-config-5.0.xsd" 
xmlns="urn:infinispan:config:5.0">  
<global>
<transport clusterName="${jboss.partition.name:DefaultPartition}-Hibernate" distributedSyncTimeout="17500">
<properties>
    <property name="stack" value="${jboss.default.jgroups.stack:udp}"/>
</properties>
</transport>
<globalJmxStatistics enabled="true"/>
<shutdown hookBehavior="DONT_REGISTER"/>
</global>
<default>
    <jmxStatistics enabled="false"/>
    <!--transaction transactionManagerLookupClass="org.infinispan.transaction.lookup.JBossTransactionManagerLookup"/-->
</default>
<namedCache name="entity">
    <clustering mode="invalidation">
    <stateRetrieval fetchInMemoryState="false" timeout="20000"/>
    <sync replTimeout="20000"/>
    </clustering>
    <locking isolationLevel="READ_COMMITTED" concurrencyLevel="1000"
             lockAcquisitionTimeout="15000" useLockStriping="false" />
    <eviction wakeUpInterval="5000" maxEntries="10000" strategy="LRU"/>
    <expiration lifespan = "-1" maxIdle="-1"/>   
    <lazyDeserialization enabled="true"/>
</namedCache> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T12:12:43.447

集合本身必须被缓存，使用`@Cache`注解。请参阅[文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#performance-cache-mapping)：

> 如果集合包含其他实体，Hibernate 还允许您缓存集合的内容或标识符。在集合属性上使用 @Cache 注释。
> 
> 例 21.6。使用注解缓存集合

```
@OneToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)
@JoinColumn(name="CUST_ID")
@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)
public SortedSet<Ticket> getTickets() {
    return tickets;
} 
```

# javascript - Javascript设置最小滚动能力

> ID：14080737
> 
> 赞同：0
> 
> 时间：2012-12-29T10:23:22.480
> 
> 标签：javascript, scroll, scrollbar

我有一个网站，我希望用户可以上下滚动多少。这意味着无论页面的内容是什么，滚动能力都不应低于这个给定的数量。

如何在 Javascript 中设置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:47:21.417

你可以这样做：

CSS：

```
HTML {
    height: 100%;
    padding-bottom: 200px;
    padding-top: 200px;
} 
```

JS：

```
window.onload = function () {
    document.body.scrollIntoView(true);
    return;
} 
```

# visual-studio-2010 - Visual Studio 2010 上的智能手机项目

> ID：14080742
> 
> 赞同：0
> 
> 时间：2012-12-29T10:23:40.640
> 
> 标签：visual-studio-2010, visual-studio-2008, smartphone

我的雇主最近要求我为运行 Windows CE 6.5 的设备启动一个智能手机项目。

我知道 Visual Studio 2008 有智能手机模板，而 vs 2010 没有，我目前有 vs 2010，我被告知要为这个项目安装 vs 2008。

我想知道是否有办法在 vs 2010 或 vs 2008 中实现这一点，这是编写智能手机应用程序的唯一方法。如果可以在 vs 2010 中这样做，那么如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:34:49.543

VS2010不能做智能设备开发。坚持使用微软网站上提到的VS2008

[http://msdn.microsoft.com/en-us/library/sa69he4t.aspx](http://msdn.microsoft.com/en-us/library/sa69he4t.aspx)

> Visual Studio 2010 不支持为 Windows Phone OS 7.0 之前的 Windows Phone 版本开发移动应用程序。”在此页面上。

VS2010 你可以从Phone 7 之前下载一个专门的Windows Phone 7 开发版本，仅适用于Windows Mobile，你需要VS2008。

# ios - StoreKit 未收到产品数组

> ID：14080744
> 
> 赞同：0
> 
> 时间：2012-12-29T10:23:46.440
> 
> 标签：ios, in-app-purchase, storekit

我的 iOS 应用程序中有一个应用程序内购买，允许用户升级到应用程序的完整版本。我做了一个应该处理商店的类。问题是我在测试商店时收到无效的 ProductID 错误。我已经确定问题是无法从应用商店获取产品...

我该如何解决？

这是代码：

```
#import <Foundation/Foundation.h>
#import <StoreKit/StoreKit.h>

@interface PSStoreKitManager : NSObject <SKProductsRequestDelegate,SKPaymentTransactionObserver>

@property (strong, nonatomic) NSArray *products;

-(void)initStore;
-(void)upgradeToFull;

@end

@implementation PSStoreKitManager
@synthesize products = _products;

-(void)initStore {

    if ([SKPaymentQueue canMakePayments]) {
        [self requestProductData];
    }else {
        NSLog(@"payments disabbled");
    }
     NSLog(@"prod id %@",kFullVersionProductId);
}

-(void)upgradeToFull {
    SKProduct *fullVersion;
    NSLog(@"no items in array products %d",[self.products count]);
    for (SKProduct *crt in self.products) {
        if ([crt.productIdentifier isEqualToString:kFullVersionProductId]) {
            fullVersion = crt;
        }
    }
    SKPayment *payment = [SKPayment paymentWithProduct:fullVersion];
    [[SKPaymentQueue defaultQueue] addPayment:payment];

}

-(void)requestProductData {
    SKProductsRequest *request = [[SKProductsRequest alloc] initWithProductIdentifiers:[NSSet setWithObject:kFullVersionProductId]];
    [request setDelegate:self];
    [request start];
}

-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response {
    self.products = response.products;
    NSLog(@"data in response: %d",[response.products count]);
}

#pragma  mark -- Transaction observer

-(void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
    for (SKPaymentTransaction *transaction in transactions)

    {

        switch (transaction.transactionState)

        {

            case SKPaymentTransactionStatePurchased:

                [self completeTransaction:transaction];

                break;

            case SKPaymentTransactionStateFailed:

                [self failedTransaction:transaction];

                break;

            case SKPaymentTransactionStateRestored:

                [self restoreTransaction:transaction];

            default:

                break;

        }

    }
}

- (void) completeTransaction: (SKPaymentTransaction *)transaction

{

    // Your application should implement these two methods.

    [self recordTransaction:transaction];

    [self provideContent:transaction.payment.productIdentifier];

    // Remove the transaction from the payment queue.

    [[SKPaymentQueue defaultQueue] finishTransaction: transaction];

}

- (void) restoreTransaction: (SKPaymentTransaction *)transaction

{

    [self recordTransaction: transaction];

    [self provideContent: transaction.originalTransaction.payment.productIdentifier];

    [[SKPaymentQueue defaultQueue] finishTransaction: transaction];

}

- (void) failedTransaction: (SKPaymentTransaction *)transaction

{

    if (transaction.error.code != SKErrorPaymentCancelled) {

        // Optionally, display an error here.

    }

    [[SKPaymentQueue defaultQueue] finishTransaction: transaction];

}

-(void)recordTransaction:(SKPaymentTransaction *)transaction {
    if ([transaction.payment.productIdentifier isEqualToString:kFullVersionProductId]) {
        [[NSUserDefaults standardUserDefaults] setValue:transaction.transactionReceipt forKey:kUpgradeToFullReceipt];
        [[NSUserDefaults standardUserDefaults] synchronize];
    }

}

-(void)provideContent:(NSString *)productId {
    if ([productId isEqualToString:kFullVersionProductId]) {
        NSUserDefaults *def = [NSUserDefaults standardUserDefaults];
        [def setBool:YES forKey:kIsUpgradedToFull];
        [def synchronize];
    }
}

@end 
```

这是在应用程序委托中：

```
 //set up store observer
    PSStoreKitManager *observer = [[PSStoreKitManager alloc] init];
    [[SKPaymentQueue defaultQueue] addTransactionObserver:observer]; 
```

这被设置`applicationDidFinishLaunching`为商店观察者。它是这样使用的：

```
 PSStoreKitManager *store = [[PSStoreKitManager alloc] init];
            [store initStore];
            [store upgradeToFull]; 
```

另一个问题：当我在 itunnes 中注册一个测试用户时，连接它通过电子邮件发送该地址并要求通过使用我的 Apple Id 登录来确认它......我试过了，但它说“未知的 Apple id”......如果这封电子邮件未经确认有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:33:58.653

您需要在`sandbox`环境中测试您的应用内购买。如果您在 iTunes 连接中设置了测试用户，则需要在设备设置中明确退出 Apple 商店。然后在提示您是否要登录以允许应用内购买时启动您的应用程序后，使用您的测试用户帐户登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T19:58:31.610

好的，想通了...这是由ARC引起的...解决方案是在我使用它的地方保留存储工具包管理对象，否则它会更快地释放以使响应可以到达...

# objective-c - Objective-C 枚举，NS_ENUM & NS_OPTIONS

> ID：14080750
> 
> 赞同：22
> 
> 时间：2012-12-29T10:24:24.733
> 
> 标签：objective-c, cocoa, enums

在 Objective-C 中创建具有特定类型的枚举的正确方法是什么？NS_ENUM 和 NS_OPTIONS 是如何工作的？NS_OPTIONS 用于掩码，例如 NSAutoresizing? 谢谢。

```
Code from NSObjCRuntime.h
    #define NS_ENUM(_type, _name) enum _name : _type _name; enum _name : _type
    #define NS_OPTIONS(_type, _name) _type _name; enum : _type 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-29T12:08:02.803

来自[NSHipster](http://nshipster.com/ns_enum-ns_options/)的示例。NS_OPTIONS 以类似的方式使用，但用于通常是位掩码的枚举

代替

```
typedef enum {
    UITableViewCellStyleDefault,
    UITableViewCellStyleValue1,
    UITableViewCellStyleValue2,
    UITableViewCellStyleSubtitle
} UITableViewCellStyle; 
```

或者

```
typedef enum {
    UITableViewCellStyleDefault,
    UITableViewCellStyleValue1,
    UITableViewCellStyleValue2,
    UITableViewCellStyleSubtitle
};

typedef NSInteger UITableViewCellStyle; 
```

做这个：

```
typedef NS_ENUM(NSInteger, UITableViewCellStyle) {
    UITableViewCellStyleDefault,
    UITableViewCellStyleValue1,
    UITableViewCellStyleValue2,
    UITableViewCellStyleSubtitle
}; 
```

一个示例 NS_OPTIONS 枚举：

```
typedef NS_OPTIONS(NSUInteger, UIViewAutoresizing) {
    UIViewAutoresizingNone                 = 0,
    UIViewAutoresizingFlexibleLeftMargin   = 1 << 0,
    UIViewAutoresizingFlexibleWidth        = 1 << 1,
    UIViewAutoresizingFlexibleRightMargin  = 1 << 2,
    UIViewAutoresizingFlexibleTopMargin    = 1 << 3,
    UIViewAutoresizingFlexibleHeight       = 1 << 4,
    UIViewAutoresizingFlexibleBottomMargin = 1 << 5
}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-12-08T02:03:06.770

两者之间存在差异，只是它们推断出不同类型的枚举。

在 Objective-C++ 模式下编译时，它们会生成不同的代码：

这是原始代码：

```
typedef NS_OPTIONS(NSUInteger, MyOptionType) {
    MyOptionType1 = 1 << 0,
    MyOptionType2 = 1 << 1,
};

typedef NS_ENUM(NSUInteger, MyEnumType) {
    MyEnumType1 = 1 << 0,
    MyEnumType2 = 1 << 1,
}; 
```

这是在`Objective-C`编译中扩展宏时的代码：

```
typedef enum MyOptionType : NSUInteger MyOptionType; enum MyOptionType : NSUInteger {
    MyOptionType1 = 1 << 0,
    MyOptionType2 = 1 << 1,
};

typedef enum MyEnumType : NSUInteger MyEnumType; enum MyEnumType : NSUInteger {
    MyEnumType1 = 1 << 0,
    MyEnumType2 = 1 << 1,
}; 
```

这是在`Objective-C++`编译中扩展宏时的代码：

```
typedef NSUInteger MyOptionType; enum : NSUInteger {
    MyOptionType1 = 1 << 0,
    MyOptionType2 = 1 << 1,
};

typedef enum MyEnumType : NSUInteger MyEnumType; enum MyEnumType : NSUInteger {
    MyEnumType1 = 1 << 0,
    MyEnumType2 = 1 << 1,
}; 
```

看到两种模式之间 NS_OPTIONS 的区别了吗？

`HERE IS THE REASON`：

C++ 11 中有一个新特性，可以为枚举声明一个类型，在此之前，由编译器根据枚举的最大值决定持有枚举的类型。

因此，在 C++ 11 中，由于您可以自己决定枚举的大小，因此您可以在不实际定义枚举的情况下转发声明枚举，如下所示：

```
//forward declare MyEnumType
enum MyEnumType: NSInteger

//use myEnumType
enum MyEnumType aVar;

//actually define MyEnumType somewhere else
enum MyEnumType: NSInteger {
    MyEnumType1 = 1 << 1,
    MyEnumType2 = 1 << 2,
} 
```

这个特性很方便，Objective-C 引入了这个特性，但是在做按位计算的时候带来了一个问题，像这样：

```
enum MyEnumType aVar = MyEnumType1 | MyEnumType2; 
```

此代码无法在 C++/Objective-C++ 编译中编译，因为 aVar 被认为是 type`NSInteger`但`MyEnumType1 | MyEnumType2`属于 type ，如果没有类型转换`MyEnumType`，此赋值无法执行，**C++ 禁止隐式类型转换**。

这时候，我们需要NS_OPTIONS，NS_OPTIONS回退到C++ 11之前的enum，这样`MyEnumType`确实没有，`MyEnumType`只是另外一个名字`NSInteger`，这样代码就好了

```
enum MyEnumType aVar = MyEnumType1 | MyEnumType2; 
```

将编译，因为它分配`NSInteger`给`NSInteger`.

# php - PHP 比较 DateTime 和当前时间

> ID：14080757
> 
> 赞同：0
> 
> 时间：2012-12-29T10:25:31.403
> 
> 标签：php, mysql, sql, time

我在将字段与当前时间进行比较时遇到了一些麻烦。

我在 MySQL 中有两个字段，分别记录讲座的开始时间和结束时间。

我要做的是检查当前时间是否在开始时间和结束时间之间。

$starttime 和 $endtime 是 DateTime 的形式。

代码在这里：

```
$now = time();
$compare = mysql_query("SELECT * FROM lecture WHERE strtotime(starttime) < '$now' AND '$now' < strtotime(endtime)"); 
```

但它不起作用。

我也试过这个：

```
$now = new DateTime;
$compare = mysql_query("SELECT * FROM lecture WHERE starttime < '$now' AND '$now' < endtime"); 
```

但它也坏了。

谁能告诉我如何实现它？非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T10:35:24.113

采用`BETWEEN`

```
SELECT * 
FROM   lecture 
WHERE  NOW() BETWEEN starttime AND endtime 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:36:03.870

$compare = mysql_query("SELECT * FROM Lecture WHERE starttime < **mysql_function** AND **mysql_function** < endtime");

用以下函数之一替换 mysql_function

1) SYSDATE()：示例输出为 2012-12-29 16:03:20

2) CURDATE()：示例输出为 2012-12-29

3) UNIX_TIMESTAMP()：示例输出为 1356777278

根据“开始时间和结束时间”格式替换查询中的上述函数之一。

# c - 在c中递归地反转链表

> ID：14080758
> 
> 赞同：20
> 
> 时间：2012-12-29T10:25:34.877
> 
> 标签：c, recursion, linked-list, singly-linked-list

当 head 作为参数发送给它时，以下代码可以正常工作。由于我是 C 新手，所以我无法理解它是如何工作的。请帮帮我。

```
struct node *recursiveReverseLL(struct node *list)
{
    struct node *revHead;
    if (list == NULL || list->link == NULL)
    {
        return list;
    }

    revHead = recursiveReverseLL(list->link);
    list->link->link = list;
    list->link = NULL; 

    return revHead;
} 
```

我不知道如何使用这些递归调用提供链接。即）如果链接是，

```
1 -> 2 -> 3 -> 4 
```

那么它是如何改变的，

```
4 -> 3 -> 2 -> 1 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-12-29T10:35:48.160

通用的递归算法是：

1.  `Divide`部分列表`2`- 第一个节点和列表的其余部分。
2.  递归调用`rest`链表的反向。
3.  链接`rest`到`first`。
4.  修复`head`指针

这是带有内联注释的代码：

```
struct node* recursiveReverseLL(struct node* first){

   if(first == NULL) return NULL; // list does not exist.

   if(first->link == NULL) return first; // list with only one node.

   struct node* rest = recursiveReverseLL(first->link); // recursive call on rest.

   first->link->link = first; // make first; link to the last node in the reversed rest.

   first->link = NULL; // since first is the new last, make its link NULL.

   return rest; // rest now points to the head of the reversed list.
} 
```

我希望这张图片能让事情更清楚：

[![图片](../Images/7e55249cee65dbd12d8b88892c14bcd6.png)](https://i.stack.imgur.com/prOq0.gif)
[（来源：[geeksforgeeks.org](http://geeksforgeeks.org/wp-content/uploads/2009/07/Linked-List-Rverse.gif)）]
。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-08T05:56:38.093

替代解决方案：

```
struct node *head;
void reverse(struct node *prev, struct node *cur)
{
   if(cur){
      reverse(cur,cur->link);
      cur->link = prev;
    }
    else{
      head = prev;
    }
} 
```

在 main 中，调用 reverse(NULL,head);

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-11T18:11:28.337

```
/* Reverses a linked list, returns head of reversed list
*/
NodePtr reverseList(NodePtr curr) {
    if (curr == NULL || curr->next == NULL) return curr; // empty or single element case

    NodePtr nextElement = curr->next;
    curr->next = NULL;
    NodePtr head = reverseList(nextElement);
    nextElement->next = curr;
    return head;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-19T04:44:37.837

另一种解决方案：

```
struct node *reverse_recur(struct node *temp)
{
    if(temp->link==NULL)
    {
        return temp;
    }

    struct node *temp1=temp->link;

    temp->link=NULL;

    return (reverse_recur(temp1)->link=temp);

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-21T03:14:59.443

让链表为 1-> 2 -> 3 ->4

c中的函数是--

```
struct linked_node * reverse_recursive(struct linked_node * head)
{
struct linked_node * first;/*stores the address of first node of the linked
list passed to function*/
struct linked_node * second;/* stores the address of second node of the
linked list passed to function*/
struct linked_node * rev_head;/*stores the address of last node of initial 
linked list. It also becomes the head of the reversed linked list.*/
//initalizing first and second
first=head;
second=head->next;
//if the linked list is empty then returns null
if(first=NULL)
   return(NULL);
/* if the linked list passed to function contains just 1 element, then pass
address of that element*/
if(second==NULL)
   return(first);
/*In the linked list passed to function, make the next of first element 
 NULL. It will eventually (after all the recursive calls ) make the
 next of first element of the initial linked list NULL.*/
first->next=NULL;
/* storing the address of the reverse head which will be passed to it by the
 condition if(second==NULL) hence it will store the address of last element
 when this statement is executed for the last time. Also here we assume that 
the reverse function will yield the reverse of the rest of the linked 
list.*/
rev_head=reverse(second);
/*making the rest of the linked list point to the first element. i.e. 
 reversing the list.*/
second->next=first;

/*returning the reverse head (address of last element of initial linked 
list) . This condition executes only if the initial list is 1- not empty 
2- contains more than one element. So it just relays the value of last 
element to higher recursive calls.  */
return(rev_head);
} 
```

现在运行链表 1-> 2-> 3 -> 4 的函数

*   在 reverse(&1) 中，代码一直运行到 rev_head=reverse(&2); // 这里&1是1的地址。

函数列表是
1(first)->2(second) -> 3 -> 4

*   内部 reverse(&2) 代码运行直到 rev_head=reverse(&3); 功能列表
    2(first)->3 (second)-> 4

*   内部 reverse(&3) 代码运行直到 rev_head=reverse (&4); 列出函数
    3(first)-> 4(second)

*   内部 reverse(&4) 终止条件 second==NULL 为真，因此执行 return 并返回 4 的地址。

功能列表

4（第一）-> NULL（第二）

*   返回 reverse(&3) 函数列表为
    NULL<-3(first) 4 (second)
    并且返回的 rev_head=&4 的值

执行第二个->下一个=第一个后；列表变成

NULL<- 3（第一）<-4（第二）

返回（rev_head）；执行通过 &4 因为 rev_head=&4

*   返回 rev(&2)

函数中的列表是

NULL<-2（第一）3（第二）<-4

rev_head 是 &4 由 rev(&3) 返回

执行 second->next=first 后，列表变为

NULL<-2（第一）<-3（第二）<-4

返回（rev_head）；执行返回 &4 到 rev(&1);

*   回到 rev(&1)

函数中的列表是

NULL<-1（第一）2（第二）<-3<-4

rev_head 的值为 &4，由 reverse(&3) 传递

现在执行 second->next =first 并且列表变为

NULL<-1（第一）<- 2（第二）<-3<-4

返回（rev_head）；执行 // rev_head=&4 由 reverse(&2) 返回，并将 rev_head 的值传递给主函数。

希望这可以帮助。我花了很多时间来理解这一点并写下这个答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-16T13:45:14.663

```
 To fix head also:

void reverse_list_recursive_internal (struct list **head, struct list *node)
{
    /* last node, fix the head */
    if (node->next == NULL) {
        *head = node;
        return; 
    }
    reverse_list_recursive_internal(head, node->next);
    node->next->next = node;
    node->next = NULL;
}

void reverse_list_recursive (struct list **head)
{
    if (*head == NULL) {
        return;
    }
    reverse_list_recursive_internal(head, *head);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-30T17:47:55.520

这是一种可以递归地反转 SLL 的漂亮方法：

```
1\.    struct node* head; // global head
2\.    void rec_reverse(struct node* prev, struct node* cur)
3\.    {
4\.        if (cur)
5\.        {
6\.            rec_reverse(cur, cur->next);
7\.            cur->next = prev;
8\.        }
9\.        else
10\.            head = prev;
11\.    } 
```

以这种方式调用函数：

```
rec_reverse(NULL, head); 
```

方法：

*   递归调用函数（第 6 行），我们转到链表的最后一个节点。
*   然后我们用最后一个节点的地址更新 head（第 10 行）。
*   最后，我们将每个节点的链接指向它的前一个节点（第 7 行）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-23T14:03:32.290

在我看来，没有人提出过*尾递归*算法。原则上，尾递归算法可以在没有堆栈的情况下编译（前提是编译器足够聪明），从而生成消耗更少内存的代码。

假设`TList`是单链表的自定义数据类型，它是一个指向结构的指针，作为`link`访问列表中下一个元素的字段。

算法如下：

```

```
TList reverse_aux(TList l, TList solution) {
    if (l == NULL) {
        return solution;
    } else {
        TList tmp = l->link;
        l->link = solution;
        return reverse_aux(tmp, l);
    }
}

TList reverse(TList l) {
    return reverse_aux(l, NULL);
} 
```

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-07T07:01:54.673

```
ll *rev_list(ll *prev, ll *cur)
{
    if (!cur) {
        return prev;
    }

    ll *tmp = cur;
    cur = cur->next;
    tmp->next = prev;
    prev = tmp;
    return rev_list(prev, cur);
} 
```

查找完整代码：[https ://github.com/vijaythreadtemp/Data-Structures-And-Algorithms/blob/master/rev_link_list_rec.cxx](https://github.com/vijaythreadtemp/Data-Structures-And-Algorithms/blob/master/rev_link_list_rec.cxx)

# javascript - 使用jQuery关闭很多div

> ID：14080760
> 
> 赞同：1
> 
> 时间：2012-12-29T10:25:53.690
> 
> 标签：javascript, jquery, html, css

我有以下 div ：

> 制造商[1]、制造商[2]、制造商[3]、...等...

我试图创建一个关闭许多 div 的 javascritp for 循环，但经过一番搜索后，我发现这是不可能的。

关闭 = 隐藏（显示：无）

所以我需要帮助编写一个 jquery 简单代码来做到这一点：

```
 function hideAllManufacturers(manufacturersID)
{
    var manufacturer = [1,2,3,];

    $.each(manufacturer, function(index, val) {
        $('.manufacturer['+val+']').hide();
    });

} 
```

它确实有效 - 但是没有显示之后的下一个代码。所以这可能是我写的一个问题..

结尾我有一个逗号是不是很糟糕？

需要你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:28:18.393

您可以像这样使用通配符

```
$('[class^="manufacturer"]').hide(); 
```

这将隐藏所有以制造商开头的类的元素，因此将隐藏 .manufacturer[1]、.manufacturer[2] 等。

这也使前进变得更容易，因为如果您以后添加新制造商，则无需在 jQuery 中更新制造商数组。它将立即使用通配符节省时间和不必要的代码来捕获新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T10:30:48.347

好吧，因为它`[]`是 JQuery 使用的 CSS 选择器中的一个元字符，所以你必须用两个反斜杠转义它，`\\`所以它会是这样的

```
$(".manufacturer\\[" + val + "\\]").hide(); 
```

参考：

[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

[http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier](http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier)

另一件不能让它工作的事情是因为你的数组中有额外的逗号

```
var manufacturer = [1,2,3,]; //remove the last comma 
```

它必须是这样的

```
var manufacturer = [1,2,3]; 
```

# android - 将 3D 对象固定在一个地方

> ID：14080767
> 
> 赞同：0
> 
> 时间：2012-12-29T10:26:12.773
> 
> 标签：android, augmented-reality, 3d-modelling

我正在使用[AndAR](http://code.google.com/p/andar/)库，要在那里投影 3d 模型，您将使用标记。我的问题是，如何使用这个库来做到这一点。

1.  标记上的项目模型
2.  然后我将有按钮将其固定/标记在一个地方。
3.  之后，我将移除标记，并且 3D 对象应保留在标记所在的位置。

# actionscript-3 - AS3 获取播放器的宽度

> ID：14080771
> 
> 赞同：0
> 
> 时间：2012-12-29T10:26:37.487
> 
> 标签：actionscript-3, class, object, actionscript, width

这位于公共类中以找到播放器宽度的一半：

```
 public class Player extends MovieClip
{    
   private var playerHalfWidth:int = this.width/2; 
```

我收到此错误：

```
1119:Access of possibly undefined property width through a 
reference with static type class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:43:18.580

`this`您甚至在创建**Player**对象之前尝试引用。

将它移动到构造函数中，将是正确的方法：

```
public class Player extends MovieClip {

   private var playerHalfWidth:int;

   public function Player() {

     playerHalfWidth = this.width/2;
   } 
```

# javascript - JavaScript 包装器对象创建是轻量级的吗？

> ID：14080777
> 
> 赞同：0
> 
> 时间：2012-12-29T10:27:42.907
> 
> 标签：javascript, jquery, performance, jquery-selectors

![JQuery Wrapper 性能测试](../Images/4d79e6a5bff4359c9a4edff42a72b605.png)

该性能测试表明，创建 jquery 包装器对象的代码和没有创建 jquery 包装器对象的代码之间几乎没有区别（在第二种情况下，包装器对象存储在名为 d 的变量中，并且不会一次又一次地创建）。

你认为这些结果正确吗？JQuery-Wrapper 真的是非常轻量级的吗？

这是 JSPerf 的链接。[http://jsperf.com/jquery-wrapper-performance](http://jsperf.com/jquery-wrapper-performance)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:32:56.347

您忘记`updateFunctions`在这些测试中运行该函数，因此这些测试只不过是函数定义。

您可以开始在实际代码运行的这个[固定测试套件](http://jsperf.com/jquery-wrapper-performance/2)中看到差异。

![jquery 包装器性能](../Images/b3c0dcb77629653fb1c6fc8d44ec5bff.png)

# android - Android 视频在缓冲完成后一分钟开始播放

> ID：14080778
> 
> 赞同：1
> 
> 时间：2012-12-29T10:27:43.267
> 
> 标签：android, video-streaming, android-videoview

我使用 vitamio 库来播放 rtsp。虽然我有`videoView.start();`我的代码，但视频在缓冲完成后一分钟开始播放！

但是如果我在缓冲完成后改变方向，视频会立即开始播放！我有以下代码，并且我知道更改方向会调用此方法：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    if (videoView != null)
        videoView.setVideoLayout(VideoView.VIDEO_LAYOUT_SCALE, 0);
    super.onConfigurationChanged(newConfig);
} 
```

但我不知道究竟是什么让视频开始播放，除了改变方向之外，我无法强制它开始播放（缓冲完成后立即）。请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T10:14:48.460

我经历过当 VideoView 的维度为 0 时，视频不会播放。确保设置初始尺寸。

此外，我会尝试从一开始就设置布局： `videoView.setVideoLayout(VideoView.VIDEO_LAYOUT_SCALE, 0);`

我会在收到 oncVideoSizeChanged 回调后设置尺寸，例如，

```
public void onVideoSizeChanged(MediaPlayer mp, int width, int height) {

            FrameLayout.LayoutParams vLayout = (FrameLayout.LayoutParams) mSurfaceView.getLayoutParams();
            vLayout.width = getWindowManager().getDefaultDisplay().getWidth();
            vLayout.height = getWindowManager().getDefaultDisplay().getHeight();

            float aspectRatio = (float) width / height;
            float screenRatio = (float) vLayout.width / vLayout.height;
            float topMargin = 0, leftMargin = 0;

            if (screenRatio < aspectRatio)
                topMargin = (float) vLayout.height
                        - ((float) vLayout.width / aspectRatio);
            else if (screenRatio > aspectRatio)
                leftMargin = (float) vLayout.width - (vLayout.height * aspectRatio);

            vLayout.setMargins((int) leftMargin, (int) topMargin, 0, 0);
            mSurfaceView.setLayoutParams(vLayout);
        } 
```

# windows - 包含所有动态库的独立可执行文件

> ID：14080782
> 
> 赞同：0
> 
> 时间：2012-12-29T10:28:46.757
> 
> 标签：windows, dll, shared-libraries, static-linking

我正在编写一个应该在 Windows 上运行的工具。它链接到如此多的共享库 (DLL) Qt 库和如此多的 MSYS/MinGW 库。

有没有办法执行以下步骤：

*   递归查找最终可执行链接的所有库
*   收集它们（可能在可执行文件旁边）
*   制作一个嵌入所有 DLL 的 [huge?] 独立可执行文件。

我熟悉[静态链接](http://en.wikipedia.org/wiki/Static_library)概念和[依赖walker](http://www.dependencywalker.com)工具。不幸的是，没有办法重新编译整个员工。一些库是购买的，封闭源代码工具和其他一些在重新编译时存在法律问题。

# java - 在 Android 上将位图保存为 1bpp PNG

> ID：14080783
> 
> 赞同：3
> 
> 时间：2012-12-29T10:28:50.897
> 
> 标签：java, android, bitmap, png, monochrome

我正在寻找一种将小型单色位图保存到 1bpp PNG 文件的方法。默认情况下，`bitmap.compress(CompressFormat.PNG, 100, os)`生成一个只有 2 种颜色的 32bpp PNG 文件，并且大约是使用 1bpp 的相同 PNG 的两倍。

我看到了一个使用 BufferedImage 和颜色表的方法，但是 BufferedImage 在 Android 中不可用。

在最坏的情况下，我可以使用 DeflatorOutputStream（它也是 32bpp PNG 的一半大小），但如果可能的话，我宁愿使用 PNG。

我也快速尝试了使用 PNGJ 库，但我无法实例化 ImageInfo（导致 java.lang.NoClassDefFoundError: ar.com.hjg.pngj.ImageInfo，所以我相信我必须整理一下我的类路径）。

有小费吗？第一个选择是不使用 PNGJ，第二个是使用 PNGJ。这是我第一次使用 Java 和 Eclipse，所以请原谅我的无知。

谢谢！-詹姆士

# python - 更新 libzmq 后 pyzmq 中的导入错误

> ID：14080790
> 
> 赞同：1
> 
> 时间：2012-12-29T10:29:43.463
> 
> 标签：python, zeromq, pyzmq

当我尝试将我的 ZeroMQ 更新到新版本 3.2 时出现错误。这是我的输出：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/zmq/__init__.py", line 51, in <module>
    from zmq import core, devices
  File "/usr/local/lib/python2.7/dist-packages/zmq/core/__init__.py", line 26, in <module>
    from zmq.core import (constants, error, message, context,
ImportError: /usr/local/lib/python2.7/dist-packages/zmq/core/socket.so: undefined symbol: zmq_sendmsg 
```

我真的不知道发生了什么事。我正在使用 Ubuntu 12.04 并使用 Python 进行开发。我已经检查过 Stack Overflow，但我什么也没看到。它以前运行良好，但在安装 pyzmq 2.2.0.1 后我开始出现此错误。

谁能帮我解决这个问题？

谢谢 MAXA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T21:08:41.367

正如我在 zeromq-dev 列表上[回复你](http://lists.zeromq.org/pipermail/zeromq-dev/2012-December/019868.html)的那样，每次你对 libzmq 进行重大升级时都必须重建 pyzmq。

# ios - iOS - 在应用内购买后从 Apple 服务器下载

> ID：14080791
> 
> 赞同：6
> 
> 时间：2012-12-29T10:29:46.577
> 
> 标签：ios, download, in-app

在 iOS6 中，我们新增了将内容放置在 Apple Server 上的功能，以便在购买成功后，可以下载并正确使用内容。
我能够成功购买，下载内容时，它停止在 75%。
我尝试在苹果服务器上放置不同的购买和不同的内容。但它停止在 75%... 不知道为什么。我正在使用以下委托方法来跟踪下载进度：

```
-(void)paymentQueue:(SKPaymentQueue *)queue updatedDownloads:(NSArray *)downloads
{
    for (SKDownload *download in downloads)
    {
        switch (download.downloadState) {
            case SKDownloadStateActive:
                NSLog(@"Download progress = %f and Download time: %f", download.progress, download.timeRemaining);
                break;
            case SKDownloadStateFinished:
                NSLog(@"%@",download.contentURL);
                break;
            default:
                break;
        }
    }
} 
```

它从未达到“SKDownloadStateFinished”
有没有人面临类似的问题。如果是，解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T03:40:58.347

它不会在模拟器上工作。相同的代码在设备上完美运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T12:46:07.013

好吧，看起来它毕竟不受支持：

[http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/](http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/)

"

**模拟器**

对于此版本，iOS 模拟器不支持测试应用内购买。请使用设备测试使用此功能的应用。

"

6.1 仍然不支持它：

[http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_1/](http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_1/)

# android - 我的背景循环音乐不“循环”好

> ID：14080793
> 
> 赞同：0
> 
> 时间：2012-12-29T10:29:52.183
> 
> 标签：android

我有一个背景音乐循环。但它循环不好，每次循环结束时都会有半秒没有音乐。mp3 文件是完美的，没有音乐就没有一秒钟。是 MediaPlayer 的错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:06:43.273

从 Jellybean (Android 4.1) 开始，您可以对 MediaPlayers 进行“链接”。在当前播放的 MediaPlayer 完成之前，调用[setNextMediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html#setNextMediaPlayer%28android.media.MediaPlayer%29)，下一个 MediaPlayer 会在当前播放完成后尽快自动启动，以避免出现间隙。

请注意，您不能将当前播放的 MediaPlayer 实例设置为下一个。因此，为了使用它来循环播放歌曲，您必须创建 2 个具有相同数据源的 MediaPlayer 实例并在它们之间交替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:08:45.197

[SoundPool](http://developer.android.com/reference/android/media/SoundPool.html)在这方面做得更好。

> SoundPool 是一组样本，可以从 APK 内的资源或文件系统中的文件加载到内存中。SoundPool 库使用 MediaPlayer 服务将音频解码为原始的 16 位 PCM 单声道或立体声流。这允许应用程序发送压缩流，而不必在播放期间承受 CPU 负载和解压缩延迟。

请记住，这可能会占用大量内存，具体取决于您的音乐文件的长度。

# asp.net - 如何爬取搜索引擎结果

> ID：14080796
> 
> 赞同：0
> 
> 时间：2012-12-29T10:30:07.667
> 
> 标签：asp.net, search, search-engine, web-crawler

建立一个页面（asp.net）来抓取搜索引擎结果然后显示在我自己的页面中是否可行？

我的同事想开发一个包含搜索框的页面，当用户输入关键字并点击搜索时，它会传递给搜索引擎（例如google）并抓取结果。然后将结果插入数据库并在我的页面中显示结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:36:46.643

您可以使用谷歌搜索 API，但现在已弃用。还有其他方法，但搜索引擎可以很容易地检测到非人类进行搜索。所以它是不可取的。

# c++ - 步进调试工作正常，但使用 _tprintf 时不步进调试会导致奇怪的错误

> ID：14080801
> 
> 赞同：0
> 
> 时间：2012-12-29T10:30:51.867
> 
> 标签：c++, visual-studio-2008, printf, msvcrt, crt

好的，如果我不需要，我将保持这个简单并且不包括所有代码（还）。我的内在感觉告诉我，这可能有一个简单的答案，而我像往常一样忽略了它。更有经验的人可能会说编译器是问题所在，但我从来不知道在 99.999% 的情况下，它在某种程度上一直是我的错误，所以......这就是问题所在。我有一个程序，这个程序应该输出两个字符串，没什么花哨的

```
TCHAR* firststring = _T("FirstValue");
TCHAR* secondstring = _T("SecondValue");

_tprintf(_T("%s\n"),firststring);
_tprintf(_T("%s\n"),secondstring); 
```

哪个输出..

```
firststring 
```

在我的代码的特定部分，这不起作用（它在其他地方工作）除非我正在逐步调试......然后没关系......

```
firststring
secondstring 
```

我什至尝试通过这样做将操作合并为一个：

```
_tprintf(_T("%s\n[%s]\n"),firststring,secondstring); 
```

我的结果是，第一个字符串，大括号在那里试图指出字符串正试图被打印出来，如果它是空的，等等。我得到这个输出：

```
firststring
] 
```

就是这样..再次，除非跨步调试，然后一切都很好而且花花公子：

```
firststring
[secondstring] 
```

有没有人听说过这样的问题？我最后一次遇到像这样的奇怪问题是在 ASM 时代的段对齐，但我怀疑这里的情况，虽然我不确定 _tprintf 的内部工作原理......如果没有人，我会再试一次知道，我会假设它是因为前面的代码引起的错误。主要问题是，这是否出于任何简单的原因发生，或者这是否只是指出程序早期的问题，仅此而已。感谢您的回复。

PS：我意识到我没有提供足够的代码来完全回答这个问题，但问题是调试器中的这种行为是否存在已知的简单原因（运行与步进）。断点设置在函数级别，我使用的是 Visual Studio 2008。编译器版本如下：

```
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 80x86
Microsoft (R) Macro Assembler Version 9.00.21022.08
Microsoft (R) Incremental Linker Version 9.00.21022.08
Microsoft (R) Windows (R) Resource Compiler Version 6.0.5724.0
Microsoft Browse Information Maintenance Utility Version 9.00.21022
Microsoft (R) Manifest Tool version 5.2.3790.2075 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T14:47:32.037

我后来通过将这些字符串从 TCHAR* 更改为 const TCHAR* 解决了这个问题，当使用只读字符串时，使用字符串文字编写字符串数组被认为是未定义的行为。我不确定是不是因为文档本身被存储为 unicode，或者这是否有作用，但我学会了不这样分配的艰难方法。如果我需要写入这些位置，我应该使用单独的常量字符串，并在我需要它在读/写缓冲区中时使用 strcpy 复制它的内容。显然不这样做会导致代码中出现安全漏洞和其他陷阱，即使它很简单。

（以下是我对部分代码的推理——如果有兴趣，请鼠标悬停）

> 至于代码示例不完整，这是一个非常大的项目，包含成千上万行代码，我几乎没想到这里有人会花这么多时间来完成所有工作。毕竟，这里的任何人都没有报酬这样做，我真的只需要找出是我还是这是否是常见的事情，如果是常见的事情，如何解决它。当我们在这里提出问题时，我们不仅是在提出问题，而且还在就我们期望答案的范围提供指导，而且我们绝不会期望任何人像某些人那样清楚建议。如果您不想回答问题或者没有足够的信息让您这样做，那么就不要那么简单（这是因为我们没有一开始就要求的所有信息） .

# nosql - 在 ElasticSearch 中获取一致性（和仲裁）

> ID：14080808
> 
> 赞同：7
> 
> 时间：2012-12-29T10:32:06.753
> 
> 标签：nosql, elasticsearch

我是 ElasticSearch 的新手，我正在为一个项目评估它。

在 ES 中，复制可以是同步的，也可以是异步的。在异步的情况下，一旦将文档写入主分片，客户端就会成功返回。然后将文档异步推送到其他副本。

当异步写入时，我们如何确保当 GET 完成时，即使数据没有传播到所有副本也会返回数据。因为当我们在 ES 中执行 GET 时，查询被转发到相应分片的副本之一。假设我们是异步写入的，主分片可能有文档，但执行 GET 的选定副本可能尚未接收/写入文档。在 Cassandra 中，我们可以在写入和读取时指定一致性级别（ONE、QUORUM、ALL）。在 ES 中读取类似的东西是可能的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-15T13:00:34.453

是的，您可以将[复制](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-index_.html#index-replication)设置为异步（默认为同步）以不等待副本，尽管实际上这不会给您带来太多收益。

每当您读取数据时，您都可以指定[首选项](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-get.html#preference)参数来控制将从何处获取文档。如果您使用`preference:_primary`，请确保始终从主分片获取文档，否则，如果在文档在所有副本上可用之前完成获取，则可能会遇到尚未拥有它的分片。鉴于 get api 是实时工作的，保持复制同步通常是有意义的，这样在索引操作返回后，您总是可以通过 id 从任何应该包含它的分片中取回文档。尽管如此，如果您在第一次索引文档时尝试取回文档，那么您可能会找不到它。

elasticsearch 中也有写一致性参数，但与其他数据存储的工作方式不同，与复制是同步还是异步无关。具有[一致性](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/docs-index_.html#index-consistency)参数您可以控制需要多少数据副本才能允许写入操作。如果没有足够的数据副本可用，则写入操作将失败（等待最多 1 分钟后，您可以通过 timeout 参数更改间隔）。这只是决定是否接受操作的初步检查。这并不意味着如果副本上的操作失败，它将被回滚。实际上，如果在副本上的写入操作失败但在主节点上成功，则假设副本（或它正在运行的硬件）有问题，因此分片将被标记为失败并在另一个节点上重新创建. 一致性的默认值为`quorum`，也可以设置为`one`或`all`。

也就是说，当涉及到 get api 时，elasticsearch 并不是最终一致的，而是一致的，因为一旦文档被索引，您就可以检索它。

新添加的文档在下一次刷新操作之前不可用于搜索，默认情况下每秒自动发生一次，这与最终的一致性无关（因为文档在那里并且可以通过 id 检索），而是更多关于如何搜索和 lucene 工作以及如何通过 lucene 使文档可见。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-29T11:05:14.947

这是我在邮件列表中给出的答案：

据我了解，当您索引文档时，它会写入事务日志中，然后您会从 ES 获得成功的答案。之后，以异步方式，将其复制到其他节点并由 Lucene 索引。

也就是说，您不能立即*搜索*文档，但可以*获取*它。如果需要，ES 会在您获取文档时读取 tlog。

我认为（不确定）如果副本不是最新的，则 GET 将在主 tlog 上发送。

如我错了请纠正我。

# visual-studio-2010 - 如果vs2010安装在系统中已经包含vs2005会有什么影响？

> ID：14080813
> 
> 赞同：0
> 
> 时间：2012-12-29T10:33:03.713
> 
> 标签：visual-studio-2010, visual-studio-2005, conflict, windows-xp-sp3

我有一个问题，我在以 Windows XP SP1 作为操作系统的系统上使用 Visual Studio 2005。现在我想在不卸载 VS2005 的情况下安装带有 SP3 的 Visual Studio 2010。

我的问题是，我在 VS2005 中的项目还能正常工作吗？我可以在两个版本中工作而没有任何冲突的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:38:35.777

这应该是可能的。根据 MSDN 文档（[并排安装 Visual Studio 版本](http://msdn.microsoft.com/en-us/library/ms246609%28v=vs.100%29.aspx)），您可以并排安装它们。

但是，您不能在 VS2005 中打开 VS2010 项目。因此，如果您希望能够在 VS2005 中打开您的项目，您需要将您的工作在这些版本之间严格分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T10:12:16.197

我有 VS2005、2008 和 2010 都在同一个 Vista 机器上运行，没有冲突。只要您不升级您的 2005 项目（通过选择在 VS2010 中打开它们并接受升级提示）就可以了。

这里最大的问题是：*VS2010 真的可以在 XP SP1 上运行吗？*

# javascript - 重新加载 jquery 和 js 库

> ID：14080816
> 
> 赞同：2
> 
> 时间：2012-12-29T10:33:37.733
> 
> 标签：javascript, jquery, asp.net, ajax, updatepanel

我使用更新面板重新加载我的页面。在我的母版页中，我执行以下操作。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>  
<script src="App_Themes/Project/js/core.js"></script>
<script src="App_Themes/Project/js/libs/modernizr-1.6.min.js"></script> 
```

当我使用 ajax (updatepanels) 部分重新加载页面时，会加载这些文件。所以滑块是不可能使用的。

当我进行 Ajax 调用时，有没有办法加载这些文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:42:52.747

您可以使用此功能：

```
function ReloadScripts() {

    var scriptTag = document.getElementsByTagName('script');
    var src;

    for (var i = 0; i < scriptTag.length; i++) {
        src = scriptTag[i].src;
        scriptTag[i].parentNode.removeChild(scriptTag[i]);

        try {
            var x = document.createElement('script');
            x.type = 'text/javascript';
            x.src = src;
            //console.log(x)
            document.getElementsByTagName('head')[0].appendChild(x);
        }
        catch (e) {}
    }
};​ 
```

在ajax调用成功方法上，调用这个函数即可

```
$.ajax({
    type:"POST",
    dataType: 'json',
    error: function(data) {
        //do error stuff
    },
    success: function(data) {
        //do success stuff

        // at last call this
        ReloadScripts();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T13:25:18.520

我认为您需要的不是重新加载 js 库，您需要调用将某些属性应用于 ajax 调用加载的某些元素的确切函数。

例如：

您的 ajax 将一些链接附加到页面，例如

```
<a id="someLink">link</a> 
```

并且有一个代码在 js 库中的一个方法中将此元素着色为蓝色，例如：

```
function colorBlue() {
    $("a").css("color", "blue");
} 
```

所以在这里你不需要重新加载整个库，只需在你的 ajax 调用之后调用这个函数：

```
function makeAjax() {
    //here some ajax method is executed
    colorBlue();
} 
```

就是这样，您需要的更改在库方法中完成。PS：您可以通过在 js 库中搜索目标元素的类、标签名称或 id 来找到将特定工作应用于您的元素的方法。你在那里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T14:11:16.237

将所有初始化/重新初始化代码放在 js 函数调用`pageLoad()`中，它会在所有异步回发中被调用：

```
function pageLoad()
{
    //do work 
} 
```

[$(document).ready() 和 pageLoad() 不一样！](http://encosia.com/document-ready-and-pageload-are-not-the-same/)

# php - 设置数组值时自动分配键

> ID：14080818
> 
> 赞同：0
> 
> 时间：2012-12-29T10:33:46.770
> 
> 标签：php

> **可能重复：**
> [PHP 获取数组中最后插入项的索引](https://stackoverflow.com/questions/3275082/php-get-index-of-last-inserted-item-in-array)

我的数组是通过以下方式生成的：

```
$_SESSION['add_fail_urls'][] = $_REQUEST['url']; 
```

如何获得自动分配键的数值`[]`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:36:59.707

```
<?php $numberOfFailedUrls = count($_SESSION['add_fail_urls']); ?> 
```

应该做的伎俩。如果您想确保不会收到有关`add_fail_urls`不存在的任何通知，请改用以下内容：

```
<?php 
    $numberOfFailedUrls = isset($_SESSION['add_fail_urls']) ? 
        count($_SESSION['add_fail_urls']) : 
        0; 
?> 
```

编辑：我可能误解了您的帖子（截至@des 评论），因为您可能想要添加元素的实际索引而不是元素的数量。如果是这样，[这是@romaninsh 在链接问题中为您提供的解决方案](https://stackoverflow.com/a/10044716/860212)：

```
<?php 
    end($a);
    $last_id=key($a);
?> 
```

# html - 如何强制缓存 10mb+ 图像，使它们永远不会重新加载？

> ID：14080820
> 
> 赞同：2
> 
> 时间：2012-12-29T10:33:58.727
> 
> 标签：html, http, web

我有一个网站，它有 10mb+ 的图像（1000+ png），必须在它开始之前加载。我目前的方法是将每个图像加载到隐藏标签中。例如，我如何确保每月访问该站点一次的客户端永远不必再次下载它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:37:13.297

没门。客户端可能禁用了缓存，或者他每分钟清除一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:39:53.637

压缩纹理/生成的纹理/重用的纹理是你应该做的。您无法可靠地缓存 10mb 的图像一个月。如果您在游戏中需要它，那么只需事先有一个加载栏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T10:42:34.333

听起来您想使用应用程序缓存。这意味着将页面及其图像作为应用程序处理，并使用缓存清单（.appcache 文件）列出它们以及包含`<html manifest="...">`标签的 HTML 文档。参见例如[使用应用程序缓存的初学者指南](http://www.html5rocks.com/en/tutorials/appcache/beginner/)。

# symfony-2.1 - 事件监听器中的 Symfony 密码加密

> ID：14080832
> 
> 赞同：2
> 
> 时间：2012-12-29T10:36:06.460
> 
> 标签：symfony-2.1, password-encryption

我正在使用 Symfony 2.1 和内置的安全功能。

我已经建立了一个实体来存储我的用户：

```
IGA\UserBundle\Entity\SfGuardUser:
  type: entity
  table: sf_guard_user
  id:
    id:
      type: string
      generator: { strategy: UUID }
  fields:
    username:
      type: string
      length: 255
      unique: true
    algorithm:
      type: string
      length: 255
      nullable: true
    salt:
      type: string
      length: 255
      nullable: true
    password:
      type: string
      length: 255
    created_at:
      type: datetime
    last_login:
      type: datetime
      nullable: true
    is_active:
      type: boolean
      default: 1
    is_super_admin:
      type: boolean
      default: 0
  lifecycleCallbacks:
    prePersist: [ setCreatedAtValue ] 
```

您可能会从 Symfony 1.x 中的旧 sfGuard 插件中识别出表结构。我有遗留数据库，所以我想保持相同的表结构。

我知道我可以在控制器中加密密码，但我希望在 prePersist 和 preUpdate 学说事件中对密码进行加密，这样我就可以将加密逻辑限制为一个函数。

我的事件触发得很好，但我需要从教义监听器中获取密码加密服务。这是我迄今为止的尝试：

```
<?php

namespace IGA\UserBundle\EventListener;

use Doctrine\ORM\Event\LifecycleEventArgs;
use Symfony\Component\DependencyInjection\ContainerAwareInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;
use IGA\UserBundle\Entity\SfGuardUser;

class PasswordEncryptor implements ContainerAwareInterface
{
    /**
     * @var ContainerInterface
     */
    private $container;

    /**
     * {@inheritDoc}
     */
    public function setContainer(ContainerInterface $container = null)
    {
        $this->container = $container;
    }

    public function preUpdate(LifecycleEventArgs $args)
    {
        $entity = $args->getEntity();
        $entityManager = $args->getEntityManager();

        if ( ($entity instanceof SfGuardUser) && ($entity->needs_encoding) ) {

            $factory = $this->container->get('security.encoder_factory');
            $encoder = $factory->getEncoder($entity);
            $entity->setSalt(microtime());
            $encodedPassword = $encoder->encodePassword($password, $entity->getSalt());
            $entity->setPassword($password);

        }
    }

    public function prePersist(LifecycleEventArgs $args)
    {
        $this->preUpdate($args);
    }

} 
```

谁能帮我解决这个问题？这是做事的好方法吗？

这对我来说似乎是最好的方法，因为无论实体在哪里更新和存储，密码都是加密的。

如果我只能访问该服务！帮助！！

这也将使我能够使用 Sonata Admin Bundle 或任何其他类似的管理生成器来管理我的用户，而无需额外的麻烦。

# android - 删除和添加多个接近警报

> ID：14080833
> 
> 赞同：2
> 
> 时间：2012-12-29T10:36:06.937
> 
> 标签：android, location, locationmanager, proximity

我的用例：

-我的应用程序有例如 3 个我从服务器获取的 lon/lat 位置。这些可能会在提取之间发生变化。-我想为所有三个添加邻近警报，但是当我重新获取位置时，我希望重新创建邻近警报，以防经度/纬度发生变化。

我已经看到了 locationmanager 中的方法并找到了一些示例，但是我在任何地方都看不到“removeAll”方法，也没有找到方法。所有这些我都必须为每个位置创建待处理的意图、警报和注册接收器，每次都有一个唯一的 ID...

我曾希望对我的所有接近警报基本上使用相同的意图/待定意图，这样当我稍后调用删除时，我只需要调用一次该方法，并且我的所有接近警报都会被删除，如下面的代码。

有小费吗？这完全不可能吗？

```
//CREATE (i would use the same way to create intent for all my proximity alerts, and have one broadcastreciever that receives all for the intent with that ID):
Intent intent = new Intent(PROX_ALERT_INTENT_ID);
    PendingIntent proximityIntent = PendingIntent.getBroadcast(activity.getApplicationContext(), 0, intent, 0);
    lm.addProximityAlert(
        latitude,
        longitude,
        POINT_RADIUS,
        PROX_ALERT_EXPIRATION,
        proximityIntent
    );

//REMOVE:
Intent intent = new Intent(PROX_ALERT_INTENT_ID);
    PendingIntent proximityIntent = PendingIntent.getBroadcast(activity.getApplicationContext(), 0, intent, PendingIntent.FLAG_NO_CREATE);

//i had hoped that this call would remove all alerts at once?
lm.removeProximityAlert(proximityIntent); 
```

# c# - 从其他线程调用主线程中的方法

> ID：14080835
> 
> 赞同：2
> 
> 时间：2012-12-29T10:36:19.310
> 
> 标签：c#, multithreading, unity3d

我在 unity3d 控制台中收到这样的错误：

> INTERNAL_CALL_Internal_InstantiateSingle 只能从主线程调用。加载场景时，构造函数和字段初始化程序将从加载线程中执行。不要在构造函数或字段初始化程序中使用此函数，而是将初始化代码移至 Awake 或 Start 函数。

我正在尝试的是执行方法，它似乎在主线程中定义，如“Instantiate()”

如何调用此方法或调用主线程来执行它？

**编辑**

```
protected static void processCommand(String data) {
    ...
    } else if(data.StartsWith("LOGGEDIN")) {
        ...
        Vector3 pos = new Vector3(0, 1.2F, 0);
        Quaternion rot = Quaternion.identity;
        myModel = (GameObject)Instantiate(player, pos, rot);
... 
```

线程是：

```
Thread tidListen = new Thread(new ThreadStart(ListenThread));
tidListen.Start();

private static void ListenThread() {
        while(connected) {
            int lData = myStream.Read(myBuffer, 0, client.ReceiveBufferSize);
            String myString = Encoding.ASCII.GetString(myBuffer);
            myString = myString.Substring(0, lData);
            processCommand(myString);
        }
    } 
```

当我调用 processCommand 时，我有方法： Instantiate()

**编辑 2**

我也试过这个[Link](http://forums.asp.net/t/1777525.aspx/1)，当我从 currentThread 获得 ManagedThreadId 时，我得到 1 （这似乎是主线程），但我再次得到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T17:19:21.950

为了跳过这个，我为来自服务器的消息实现了一个队列系统。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-08T00:57:18.720

`Instantiate()`, 像`StartCoroutine()`, 只能从 Unity 托管内存中的对象调用 - 即场景内 GameObjects 上的 MonoBehaviours。

我相信您`protected static void processCommand(String data)`无法调用`GameObject.Instantiate()`，因为`processCommand()`不在场景中存在的对象上（因此继承自 MonoBehaviour）。我认为这是因为静态方法（对象）不能作为场景中的实例存在。

尝试制作一个挂在场景中并`Instantiate()`为您调用的“实例化器”对象。

# tcp - 通过 HTTP/s 隧道传输任何类型的 TCP 流量

> ID：14080845
> 
> 赞同：24
> 
> 时间：2012-12-29T10:38:04.903
> 
> 标签：tcp, applet, portforwarding, http-tunneling, big-ip

我正在寻找一种通过 HTTPS 隧道传输 RDP 或其他二进制 TCP 流量的软件。因为很多客户端只允许 HTTP/S（防火墙中只开放了 80 和 443 端口）。

但是需要将 RDP（和其他协议）从 DMZ 中的机器转发到客户端。

![功能说明](../Images/efb0aa1affe4f3eae6bf34f24602018d.png)7 [查看大功能说明](http://i46.tinypic.com/ebajix.png)

是否有任何类型的开源或企业软件可以解决这个问题？

## 糟糕的解决方案

[F5 big ip](http://www.f5.com/products/big-ip/)之类的解决方案存在我必须使用此软件创建连接配置的问题。如果可以通过使用 api 来做到这一点，那将是一个很好的解决方案。但我宁愿只获得隧道组件而不使用整个网关软件。因为我需要用我自己的软件创建隧道（1000ds），并且需要限制对允许用户的隧道访问（由会话 cookie 标识）

## 好的解决方案

[http://http-tunnel.sourceforge.net/](http://http-tunnel.sourceforge.net/)

如果隧道客户端可能不是专用服务器，而是在客户端浏览器中运行的 java 闪存小程序，它将 100% 满足我的需求。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-02T00:24:39.253

有大量项目通过 HTTP(S) 建立 TCP 隧道。您将不得不做一些工作来选择最适合您需要的那个（并且可能会稍微修改它）。

*   [超级隧道](http://code.google.com/p/supertunnel/)（Java）。看起来不错，他们似乎已经考虑过如何处理行为不端的代理。

*   [JHttpTunnel](http://www.jcraft.com/jhttptunnel/) (Java)。gnu httptunnel 的一个端口，我认为使用相同的网络协议。

*   [Netty](https://netty.io/) HTTP Tunnel（Java，Netty 的一部分，一个非常好的网络库；[示例代码](http://static.netty.io/3.5/xref/org/jboss/netty/example/http/tunnel/HttpTunnelingClientExample.html)）。我认为这需要客户端和服务器都使用 Netty，但除此之外，它还可以替代 Netty 中的常规套接字。

*   [ProxyChains](http://proxychains.sourceforge.net/) (C, Unix, 非常流行)

*   [GNU httptunnel](http://www.nocrew.org/software/httptunnel.html)（C，不支持 HTTPS，这可能是所有 http 隧道的鼻祖）

*   [node-http-tunnel](https://github.com/johncant/node-http-tunnel) (Node.js), [Net::HTTPTunnel](http://search.cpan.org/~rwahby/Net-HTTPTunnel-0.51/HTTPTunnel.pm) (Perl), [nRedir](http://nredir.tigris.fr/) (Python), Corkscrew, htunnel, ...

我认为 SuperTunnel 和 JHttpTunnel 都可以包含在客户端自己的小程序或 Java 应用程序中，它们不需要作为独立代理运行。

Netty 也会这样做，但是（我认为）它要求您的服务器也使用 Netty：换句话说，它允许您`connect()`使用带有 TCP-over-HTTP 的 Netty将常规 TCP 替换为服务器`connect()`，但不代理任意连接到其他服务器（除非您编写自己的简单代理）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-04T15:06:13.973

如果您在 Windows 世界，我强烈建议您查看 Windows 2008/2008R2/2012 SSTP VPN 服务。它使用 443 端口，并且可以与 IIS 共同托管（在 443 上）。它在 Windows Vista / 7 / 8 上就像一个魅力。我听说过 mac OSX 解决方案，但还没有。

然而，SSH 有一个很好的旧解决方案。

如果在 linux 上，只需安装一个 openssh-server。如果在 Windows 上，获取并安装 OpenSSH 服务器（例如，来自 itefix [https://www.itefix.no/](https://www.itefix.no/)的 copSSH ）。将端口修改为使用 443 而不是默认的 22。

[然后在客户端](http://kitty.9bis.net/)可以在[windows](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)或任何任何操作系统中的一种 SSH 客户端，通过端口 443（您的 SSH 服务器正在侦听的端口）连接到您的服务器。

例如，可以在多个站点上找到有关通过 putty 进行隧道的说明：

*   [http://oldsite.precedence.co.uk/nc/putty.html](http://oldsite.precedence.co.uk/nc/putty.html)
*   [http://www.damtp.cam.ac.uk/user/jp107/xp-remote/web-tunnel/](http://www.damtp.cam.ac.uk/user/jp107/xp-remote/web-tunnel/)

永远记住，您必须指向本地主机才能执行此操作。

在 Windows 上还有 MyEnTunnel ( [http://nemesis2.qx.net/pages/MyEnTunnel](http://nemesis2.qx.net/pages/MyEnTunnel) ) 来简化隧道配置和维护的过程。

在浏览器上利用此隧道非常容易：只需告诉您的浏览器您在客户端（putty、kitty、myentunnel 或其他任何东西）中配置的本地端口（eh localhost 8080）上有一个 socks 代理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-28T03:14:47.187

我写了一个叫 sshh。 [http://sourceforge.net/projects/sshh/](http://sourceforge.net/projects/sshh/)

我有点发疯了，它实际上可以让你通过它向后建立连接。

# iphone - 如何在 Facebook 上发布带有 url 的消息？

> ID：14080851
> 
> 赞同：0
> 
> 时间：2012-12-29T10:39:14.227
> 
> 标签：iphone, objective-c, ios, facebook, facebook-graph-api

我在脸书上发帖。我可以发布一个 URL，但我也想用那个 URL 发布一些描述。我正在使用它-

```
NSString *shareUrlString = [NSString stringWithFormat:@"http://www.facebook.com/sharer.php?u=%@&t=%@", urlString , description];
    NSURL *url = [ [ NSURL alloc ] initWithString:urlString ];
    [[UIApplication sharedApplication] openURL:url]; 
```

但我无法发布描述。所以你能给出任何想法来做到这一点。我不想使用任何 sdk 或任何 api 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:18:12.793

使用[iPhone-Facebook-Graph-API](https://github.com/reallylongaddress/iPhone-Facebook-Graph-API/tree/59e639922c4bf6953162ea81998f2ff951cd1769)作为易用性。

```
NSMutableDictionary *variables = [NSMutableDictionary dictionaryWithCapacity:4];

[variables setObject:@"MESSAGE HERE" forKey:@"message"];
[variables setObject:@"URL HERE" forKey:@"link"];
[variables setObject:@"URL NAME HERE" forKey:@"name"];
[variables setObject:@"URL DESC HERE." forKey:@"description"];

FbGraphResponse *fb_graph_response = [fbGraph doGraphPost:@"me/feed" withPostVars:variables]; 
```

# php - 解析错误：语法错误，意外的 T_PRINT

> ID：14080852
> 
> 赞同：-1
> 
> 时间：2012-12-29T10:39:19.673
> 
> 标签：php, syntax-error

我已经搜索并找不到关于 T_PRINT 语法错误的任何内容。所以就这样吧，我不明白这是“意外”。它指的是打印“您的员工申请已发布”等行。

```
<?php
session_start();
include "globals.php";
if($_POST['app']) 
{ 
$db->query("INSERT INTO staffapps VALUES('',$userid,'{$_POST['pos']}','{$_POST['app']}')", $c)
or die
("Your staff application could not be processed. Make sure you have filled out the form completely!"); 

print "Your Staff Application has been posted for our staff to review, your results will be decided within 14 days! Good Luck!"; 

} 
else

print "<h3>Staff Application</h3>

<center><h8><b>Please read the <a href='stafftoc.php'><font color='yellow'>Terms & Conditions</font></a>before sending an application!</b>

<form action='staffapps.php' method='post'>
Position <select name='pos'><option value='3'>Admin</option><option value='5'>Secretary</option><option value='6'>Assistant</option></select>

Why do you deserve the position?

Please bare in mind that staff look for professional members so be sure to spell correctly with the right grammar and punctuation!

If your staff application appears un-professional, it will be dismissed! 

<textarea rows='7' cols='40' name='app'>{$_GET['app']}</textarea>

<input type='submit' value='Submit Application' /></form>";

$h->endpage;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:58:11.060

您的某些代码行似乎有一些不应该存在的有趣的尾随字符；这是它们的十六进制表示：

```
0xc2 0xa0 
```

我被告知这是一个[不间断的空间](http://www.fileformat.info/info/unicode/char/a0/index.htm)。从代码中清除这些字符应该可以解决问题。

# android - 本机库未在 ICS 中加载

> ID：14080853
> 
> 赞同：0
> 
> 时间：2012-12-29T10:39:26.633
> 
> 标签：android, opencv, android-ndk

我正在尝试加载一个本机库（与 opencv 相关），并且在我测试过的每部手机上，它都能完美运行。我已经在 ICS (nexus 4) 上进行了测试，并且库加载有问题。我收到以下错误消息：

```
12-29 10:33:31.279: I/cameraController(11868): OpenCV loaded successfully
12-29 10:33:31.279: D/dalvikvm(11868): Trying to load lib /data/app-lib/com.skinanalytics.skinuploader-1/libnative_sample.so 0x4223e240
12-29 10:33:31.279: D/dalvikvm(11868): Added shared lib /data/app-lib/com.skinanalytics.skinuploader-1/libnative_sample.so 0x4223e240
12-29 10:33:31.279: D/dalvikvm(11868): No JNI_OnLoad found in /data/app-lib/com.skinanalytics.skinuploader-1/libnative_sample.so 0x4223e240, skipping init 
```

所以主要的 OpenCV 库加载正常，但我使用的库没有。ICS 上是否有我没有注意到的差异？

# c#-4.0 - 模式/架构/匿名方法

> ID：14080855
> 
> 赞同：1
> 
> 时间：2012-12-29T10:39:28.380
> 
> 标签：c#-4.0, design-patterns

我对 C# 比较陌生，也许你可以帮助我。

我有几个`callServiceXY(param1, param2, ...)`调用某个服务的方法。由于许多原因，这些服务调用可能会出错（我并不真正关心最终的原因）。所以基本上我需要总是用这样的东西包装它们 - 如果出现问题，让它们再次执行：

```
var i = 3;
while(i>0)
  try{
   call...()
  } catch{
   i--;
  }
  i=0;
} 
```

我宁愿只写一次这段代码。我能以某种方式`tryXtimes(int x, callService())`让我执行未定义或匿名的方法吗？（我在脑海中想到了 Javascript……）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:50:31.087

是的，这是可能的。C# 3.5 添加了对`Action`和`Func<T>`类型的支持。Action 不会返回任何值，Func 将始终返回一个值。

您有几个不同的版本，它们也接受许多参数。以下控制台应用程序描述了如何执行此操作：

```
using System;

namespace Stackoverflow
{
    class Service
    {
        public int MyMethod() { return 42; }
        public void MyMethod(string param1, bool param2) { }

        public int MyMethod(object paramY) { return 42; }
    }

    class Program
    {
        static void ExecuteWithRetry(Action action)
        {
            try
            {
                action();
            }
            catch
            {
                action();
            }

        }

        static T ExecuteWithRetry<T>(Func<T> function)
        {
            try
            {
                return function();
            }
            catch
            {
                return function();
            }

        }

        static void Main(string[] args)
        { 
            Service s = new Service();
            ExecuteWithRetry(() => s.MyMethod("a", true));

            int a = ExecuteWithRetry(() => s.MyMethod(1));
            int b = ExecuteWithRetry(() => s.MyMethod(true));

        }
    }
} 
```

如您所见， 有两个重载`ExecuteWithRetry`。一个返回 void，一个返回类型。您可以`ExecuteWithRetry`通过传递一个`Action`或一个来调用`Func`。

--> 编辑：太棒了！只需一些额外的代码即可完成示例：

使用匿名函数/方法：

```
ExecuteWithRetry(() =>
{
   logger.Debug("test");
}); 
```

并带有更多参数（action，int）

方法头：

```
public static void ExecuteWithRetryX(Action a, int x) 
```

方法调用：

```
ExecuteWithRetryX(() => { logger.Debug("test"); }, 2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:51:08.807

我会为此使用策略/工厂模式。这个答案[https://stackoverflow.com/a/13641801/626442](https://stackoverflow.com/a/13641801/626442)给出了使用带有链接的策略/工厂模式的示例。上述链接中的问题将为您提供另一种可以采用这种模式的示例。

[这里](http://www.dofactory.com/Patterns/Patterns.aspx)有这些设计模式的很好的例子，下面是对[策略模式](http://www.codeproject.com/Articles/52807/Design-Patterns-Part-1-The-Strategy-Pattern)和[工厂模式](http://www.codeproject.com/Articles/57421/Design-Patterns-Part-2-The-Factory-Pattern)的详细介绍。最后两个链接中的前者还向您展示了如何将两者结合起来以执行您需要的操作。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T11:15:05.467

尝试关注

```
 void CallServiceXY(params object []objects)
    {
        Console.WriteLine("a");
        throw new Exception("");
    }

    void Retry(int maxRetryCount, Action<object[]> action, params object[] obj)
    {
        int retryCount = 1;
        while ( retryCount <= maxRetryCount)
        {
            try
            {

            action(obj);
            return;
            }
            catch
            {
                retryCount++;
            }
        }
    }

    void Main()
    {
        Retry(2,CallServiceXY);
        Retry(2,CallServiceXY,"");
        Retry(2,CallServiceXY,"","");

    } 
```

演示[在这里](http://ideone.com/IqxbsY)

诀窍是`Action<object[]>`接受对象数组并在 Retry 方法中返回 void 和[params关键字。](http://msdn.microsoft.com/en-us/library/w5zay9db%28v=vs.80%29.aspx)
要返回非 void 值，请更改`Action<object[]>`为`Func<T, object[]>`.

# jquery - 选择 tr 的输入

> ID：14080857
> 
> 赞同：0
> 
> 时间：2012-12-29T10:39:35.387
> 
> 标签：jquery, html-table

如何仅选择表格行的输入？我的意思是被点击的每一行的所有输入。

HTML：

```
<table>
<tr>
    <th><input type="text" name="num" value="num"/></th>   
    <th><input type="text" name="a" value="a"/></th>
</tr>

<tr>
    <td> <input type="text" name="num" value=""/> </td>
    <td><input type="text" name="a" value=""/></td>
</tr>
</table>​ 
```

CSS：

```
.highlight { background-color: blue; } 
```

查询：

```
$(function(){
    $("tr input").click(function(){     
        $("tr input").toggleClass("highlight").siblings().removeClass("highlight"); 
    })      
}) 
```

*   我这里有这个要测试：http://jsfiddle.net/yg4n6/
*   我在这里有一个我正在寻找的效果的例子。这很好用，但这只是一张桌子。我正在尝试对表格内的输入做同样的事情：http: [//jsfiddle.net/yg4n6/5/](http://jsfiddle.net/yg4n6/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:43:40.797

首先找到`this`父并搜索 .highlight 以删除存在。
比将 .highlight 应用于`this`-> TR -> 输入

[http://jsfiddle.net/yg4n6/2/](http://jsfiddle.net/yg4n6/2/)

```
$("tr input").click(function(){      
     $(this).closest('table').find('.highlight').removeClass("highlight");
     $(this).closest('tr').find('input').toggleClass("highlight");
}); 
```

你也可以这样做：

```
$("tr").click(function( e ){          
    if(e.target.tagName=='INPUT'){
       var $this = $(e.target);
       $this.closest('table').find('.highlight').removeClass("highlight");
       $this.closest('tr').find('input').toggleClass("highlight");
    }
}); 
```

# javascript - 可拖动的 HTML 输入

> ID：14080862
> 
> 赞同：0
> 
> 时间：2012-12-29T10:39:56.600
> 
> 标签：javascript, jquery, forms

虽然有很多关于使用 jQuery 的可拖动 HTML 元素的答案，但我希望用户能够专门**重新排序列表中的项目，然后将每个对象的排名（即 1 表示顶部，3 表示底部）保存为一个正常的形式`<input>`**。

我开始修改一些 Javascript 并查看[大量不同的资源](https://www.google.com/webhp?sourceid=chrome-instant&ion=1&ie=UTF-8#hl=en&tbo=d&output=search&sclient=psy-ab&q=draggable%20form%20elements&oq=&gs_l=&pbx=1&fp=a1c6f9eb6d5a9b1b&bpcl=40096503&ion=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.1355534169,d.eWU&biw=1386&bih=779)（包括[这个好的](http://tool-man.org/ToolManDHTML/sorting.html)资源）。但是，它们只详细说明了如何*移动物体*，而不是如何将实际位置存储到`<input>`对象中。任何帮助将非常感激！

```
IDEALLY:
<input name="item-a-ranking" type="text">
-- the javascript then determines what text is "typed in" (i.e. 1, 2, or 3) for each. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T10:45:59.717

您可以使用 JQueryUI 项目，小部件 Sortable：http: [//jqueryui.com/sortable/](http://jqueryui.com/sortable/)

有一种称为[serialize](http://api.jqueryui.com/sortable/#method-serialize)的方法来检索元素顺序。

**编辑**

您还可以使用该`toArray`方法检索元素的数组。如果需要，然后循环遍历您的数组以格式化为特定格式。

**编辑 2**

这是一个例子：http: [//jsfiddle.net/yg4n6/7/](http://jsfiddle.net/yg4n6/7/)

```
$('#btn').click(function() {
    var dataItem = $("#sortable").sortable("serialize");
    alert(dataItem);

    $.ajax({
        url: 'save-sorting-position.php',
        data : dataItem,
        success: function(data) {                
            alert('Positions saved');
        }
    });
}); 
```

这个想法是调用一个 php 页面将项目位置存储到您的数据库中。

通过`$_GET`(`$_POST`或`$_REQUEST`) 数组检索您的数据：

保存排序位置.php：

```
<?php 
    $arr = unserialize($_REQUEST["item"]); 
    foreach($arr as $index => $position)
    {
        //store the position here
    }
?> 
```

# c++ - 如何使用两个独立的语法实现计算机语言翻译器

> ID：14080871
> 
> 赞同：3
> 
> 时间：2012-12-29T10:41:37.960
> 
> 标签：c++, compiler-construction, antlr, antlr3, translate

我想在两种语言 LANG1 和 LANG2 之间创建一个计算机语言翻译器。更具体地说，我想将用 LANG1 编写的代码翻译成 LANG2 中的源代码。

我有 LANG1 和 LANG2 的 BNF 语法。

LANG1 是我自己编写的一个小型 DSL，本质上是 LANG2 的“更简单”版本。

我希望能够从用 LANG1 编写的输入语句生成 LANG2 语句。

我正在为 LANG1 编译编译器，但我不知道下一步该做什么（以便将 LANG1 语句转换为 LANG2 语句）。

我对所涉及的步骤的理解如下：

```
1\. BNF for my DSL (LANG1)                                  DONE
2\. Reverse engineered the BNF for LANG2                    DONE
3\. Learning how to generate a compiler for LANG1           TODO
4\. Translate LANG1 statements to LANG2 statements          ??? 
```

从 LANG1 语句生成 LANG2 语句涉及哪些步骤？

我的代码库是 C++，所以我可以使用在 C 或 C++ 中生成的 Parser。

PS：我将使用 ANTLR3 为 LANG1 生成编译器

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T11:26:39.500

在最一般的情况下，您必须将语法的每个可能部分从 LANG1 翻译成适合 LANG2 的内容，或者您​​必须简化为两种语言的最简单可能的原语，例如汇编或组合子。这有点费时而且不是很有趣。

但是，如果语法是等效的或有很多共同点，您可能只需将两种语法都解析到同一棵树中，并拥有可以获取标准化树并将其转换回 LANG1 或LANG2 源（与一般情况基本相同，但需要更多捷径）。

编辑：由于我刚刚重读了您的问题，意识到您只想翻译一种方式，您只需要担心使树形适合 LANG1 的形式，只需为 LANG2 提供翻译功能。但我希望我的例子还是有帮助的。

## 示例树构造：

以下是两种不同的 ANTLR 语法，它们产生相同的极其简单的 AST：

**语法 1**

第一个是表示加法的标准方式：

```
grammar simpleAdd;

options {output=AST;}

tokens {
    PLUS = '+';
}

expression : addition EOF!;
addition   : NUMBER (PLUS NUMBER)+ -> ^(PLUS NUMBER*);

NUMBER     :'0'..'9'+;
WHITESPACE : ( '\t' | ' ' | '\r' | '\n')+    { $channel = HIDDEN; } ; 
```

这将接受两个或多个整数并生成一棵带有 PLUS 节点的树，并将列表中的所有数字加在一起。例如，

```
1 + 1 + 2 + 3 + 5 
```

**语法 2**

第二种语法采用一种不太优雅的形式：

```
grammar horribleAdd;

options {output=AST;}

tokens {
    PLUS = '+';
    PLUS_FUNC = 'plus';
    COMMA = ',';
    LEFT_PARENS ='(';
    RIGHT_PARENS=')';
} 

expression : addition EOF!;
addition   : PLUS_FUNC LEFT_PARENS NUMBER (COMMA NUMBER)+ RIGHT_PARENS -> ^(PLUS NUMBER*);

NUMBER     :'0'..'9'+;
WHITESPACE : ( '\t' | ' ' | '\r' | '\n')+    { $channel = HIDDEN; } ; 
```

该语法期望给函数提供数字（是的，我知道函数并不是这样工作的，我只是想让示例尽可能清晰）。例如，

```
plus(1, 1, 2, 3, 5) 
```

它产生与第一个语法完全相同的树（一个以数字作为子节点的 PLUS 节点）。

现在您不必担心您的指令来自什么语言，您可以以您喜欢的任何形式输出它。您需要做的就是编写一个可以将此 AST 转换回您选择的语言的函数。

# joomla - 隐藏“切换到桌面版”

> ID：14080873
> 
> 赞同：1
> 
> 时间：2012-12-29T10:42:15.187
> 
> 标签：joomla, joomla2.5

我使用 Joomla 2.5 创建了一个网站。当我在移动设备上打开网站时，我在底部看到选项**Switch to desktop version**。如何隐藏此通知？

我不想使用此选项，因为我不希望用户在移动设备上切换到桌面版本。

[这是链接](http://smart-kw.com/testingSite)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:44:33.067

当然，你是在唱模板吗？可以通过更改 PHP 或通过 CSS 来完成。通常在模板文件夹中你会找到一个 mobile.php 或类似的东西。在底部，您应该会找到此功能，只需对其进行评论即可。让我知道您使用什么框架来指定更多内容。

CSS 解决方案：

```
#m-desktop {display:none;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:10:02.260

平板电脑上的许多用户更喜欢台式机而不是移动设备，所以我会三思而后行。仍然要找到文件，在模板语言文件中找到语言键，然后用 grep 查找它。然后注释掉。

# php - 是哈希（密码+盐）罚款

> ID：14080874
> 
> 赞同：2
> 
> 时间：2012-12-29T10:42:31.393
> 
> 标签：php, hash, passwords, salt, bcrypt

> **可能重复：**
> [PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

假设 salt 是随机的，高熵，长字符串，hash 是or `sha512`，`bcrypt`为什么 **认为**`hash(password + perUserSalt)`不够？

这个问题起源于阅读 PHP 的新[密码哈希 API RFC](https://wiki.php.net/rfc/password_hash)之后，作者在其中指出

> 哈希（密码+盐）=这不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:49:29.323

许多年前，通常使用这样的哈希密码来保存在数据库中，例如：

```
$hashedPassword = MD5($password . $salt); 
```

硬件变得更快，已知的快速哈希函数（如 MD5、SHA-1 以及 SHA-512）可能会被暴力破解太快。如今 [2012] 可以使用通用硬件计算大约[8 Giga MD5 值](http://hashcat.net/oclhashcat-lite/#performance)，以暴力破解包含 500'000 个单词的整个英语词典，您只需要几分之一毫秒！

这就是为什么发明了 BCrypt 和 PBKDF2 等密钥派生函数的原因。它们有一个成本参数并多次重复散列（成本因素决定了迭代次数）。**每次迭代都将使用原始盐**来计算新的哈希值，这就是为什么您必须将盐单独传递给函数并且之前不能将其连接起来：

```
$hashedPassword = Bcrypt($password, $salt); 
```

链接的文章要么想解释现在单个哈希计算是不够的，要么是想表明在将盐传递给哈希函数之前不能将盐与密码连接起来。

# rfc - RFC1071 中的“C”代码算法在大端机器上运行良好吗？

> ID：14080875
> 
> 赞同：3
> 
> 时间：2012-12-29T10:42:32.443
> 
> 标签：rfc

如[RFC1071](http://www.rfc-editor.org/rfc/rfc1071.txt)中所述，在奇数字节的情况下计算校验和时，应在最后一个字节中添加一个额外的 0 字节：

![在此处输入图像描述](../Images/00c205eb106aba21e2bd5a9ae81d77d1.png)

但在“C”代码算法中，只添加了最后一个字节：

![在此处输入图像描述](../Images/d5b370f0702b23209f7f48b24fe335af.png)

上面的代码确实适用于 [Z,0] 等于 Z 的小端机器，但我认为在 [Z,0] 等于 Z*256 的大端机器上存在一些问题。

所以我想知道 RFC1071 中的示例“C”代码是否仅适用于小端机器？

-------------新添加-------------

RFC1071 中描述了另一个“将总和分成两组”的示例：

![在此处输入图像描述](../Images/d5d6de55ff112819f59b2c1cac42e81a.png)

我们可以在这里取数据 (addr[]={0x00, 0x01, 0xf2}) 例如：

![在此处输入图像描述](../Images/593b6a718b465627a5ef71a1a03f713a.png)

这里，“标准”表示公式[ [2](https://i.stack.imgur.com/y50ta.png) ]中描述的情况，而“C-code”表示C代码算法的情况。

正如我们所看到的，在“标准”情况下，最终总和为 f201，而不管字节序差异如何，因为“交换”之后的 [Z,0] 的抽象形式没有字节序问题。但它在“C 代码”情况下很重要，因为无论是大端还是小端，f2 始终是低字节。

因此，校验和是可变的，具有不同字节序的相同数据（地址和计数）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:03:30.937

I think you're right. The code in the RFC adds the last byte in as low-order, regardless of whether it is on a litte-endian or big-endian machine.

In these examples of code on the web we see they have taken special care with the last byte:

[https://github.com/sjaeckel/wireshark/blob/master/epan/in_cksum.c](https://github.com/sjaeckel/wireshark/blob/master/epan/in_cksum.c)

and in

[http://www.opensource.apple.com/source/tcpdump/tcpdump-23/tcpdump/print-ip.c](http://www.opensource.apple.com/source/tcpdump/tcpdump-23/tcpdump/print-ip.c)

it does this:

```
if (nleft == 1)
    sum += htons(*(u_char *)w<<8); 
```

Which means that this text in the RFC is incorrect:

> Therefore, the sum may be calculated in exactly the same way regardless of the byte order ("big-endian" or "little-endian") of the underlaying hardware. For example, assume a "little- endian" machine summing data that is stored in memory in network ("big-endian") order. Fetching each 16-bit word will swap bytes, resulting in the sum; however, storing the result back into memory will swap the sum back into network byte order.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-13T00:42:46.097

以下代替原始奇字节处理的代码是可移植的（即可以在大端和小端机器上工作），并且不依赖于外部函数：

```
if (count > 0)
{
    char buf2[2] = {*addr, 0};
    sum += *(unsigned short *)buf2;
} 
```

（假设 addr 是 char * 或 const char *）。

# ios - 选定的行数据显示在标签或文本字段中，如果取消选择则删除数据

> ID：14080877
> 
> 赞同：0
> 
> 时间：2012-12-29T10:42:38.027
> 
> 标签：ios

我正在文本字段中显示选定的 tableview 行数据并连接所有选定的字符串。我想从该连接字符串中删除未选择的数据。任何机构都可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:46:08.293

尝试这个：

```
yourString = [yourString stringByReplacingOccurrencesOfString:unselectedRowData withString:@""];

yourTextField.text = yourString; 
```

# silverlight - Silverlight：将 UIElement 转换为 SVG

> ID：14080881
> 
> 赞同：1
> 
> 时间：2012-12-29T10:43:15.750
> 
> 标签：silverlight, svg, converter, uielement

我正在寻找将`UIElement`( `FrameworkElement`) 转换为矢量格式（用于 的矢量模拟`WritableBitmap`）的最佳方法。想到的最简单的方法是为某些`UIElement`实现手动创建特殊的 SVG 转换器并尝试获取完整的矢量图像。

通常它将用于转换带有形状的画布。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:23:55.453

查看[http://sanpaku72.blogspot.com/2007/09/have-fun-with-xaml-silverlight-and.html](http://sanpaku72.blogspot.com/2007/09/having-fun-with-xaml-silverlight-and.html)

它有一个指向[http://members.chello.nl/~a.degreef/xaml/xaml2svg.xsl](http://members.chello.nl/~a.degreef/xaml/xaml2svg.xsl)的链接，并按照包含的内容下载其他 xsl 文件，例如[http://members.chello.nl/~a。度f/xaml/xaml2svg/animation.xsl](http://members.chello.nl/~a.degreef/xaml/xaml2svg/animation.xsl)

# node.js - 在基于 express.js 的应用程序中集中错误处理

> ID：14080887
> 
> 赞同：7
> 
> 时间：2012-12-29T10:43:47.297
> 
> 标签：node.js, error-handling, express

我最近才开始研究基于 express.js 的应用程序，该应用程序也使用 pg 模块（https://github.com/brianc/node-postgres）

我还花费了大量时间，阅读有关节点和 express 方法错误处理、正确设计中间件的好处等内容。然而，一个反复出现的问题仍然困扰着我，但没有解决方案。

说，我有以下路由器方法：

```
app.get("/:someThing/:someId", function(req, res, next) {
  pgClient.query("some SQL query", function(err, data) {
    if (err) { return next(err); } // some 500 handler will take it
    if (data.rows.length == 0) {
      next(); // send it over to a 404 handler
    }

    //finally, here we get the chance to do something with the data.
    //and send it over via res.json or something else
  });
}); 
```

如果我没看错，这应该是正确的方法。然而，我敢打赌，你也可以承认，如果我们有多个嵌套回调，那么一遍又一遍地重写是太多的样板......一遍又一遍，即使在同一个路由器方法中也是如此。

我一直在问自己，集中处理这种情况的最佳方法是什么。我所有的想法都涉及拦截 pgClient.query 方法。一方面，查询方法将简单地抛出错误而不是将其传递给回调。在另一种情况下，对 pgClient.query 的调用会将路由器方法的 next 发送到 pgClient。然后被拦截的查询方法将知道如何处理下一个被传递给它的方法。

据我所知，抛出错误并不是将其传递给 500 个处理程序的正确方法。另一方面，passin next 作为 pgClient 的一个选项，在如此低的层次上提供了很多关于上面层的知识，根据我的知识和经验，这会导致耦合，也不是很好。

你有什么建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T14:47:49.093

您可以使用[连接域](https://github.com/baryshev/connect-domain)中间件。它使用`connect`并`express`基于[Doman](http://nodejs.org/api/domain.html) API。

您需要添加`connect-domain`中间件作为堆栈中的第一个中间件。就这样。现在，您可以在异步代码中的任何地方抛出错误，它们将由域中间件处理并传递给 express 错误处理程序。

简单的例子：

```
// Some async function that can throw error
var asyncFunction = function(callback) {
    process.nextTick(function() {
        if (Math.random() > 0.5) {
            throw new Error('Some error');
        }
        callback();
    });
};

var express = require('express');
var connectDomain = require('connect-domain');

var app = express();
app.use(connectDomain());
// We need to add router middleware before custom error handler
app.use(app.router);

// Common error handler (all errors will be passed here)
app.use(function(err, req, res, next){
    console.error(err.stack);
    res.send(500, 'Something broke!');
});

app.listen(3131);

// Simple route
app.get('/', function(req, res, next) {
    asyncFunction(function() {
        res.send(200, 'OK');
    });
}); 
```

# mysql - curdate() 导致触发器出错

> ID：14080888
> 
> 赞同：0
> 
> 时间：2012-12-29T10:43:53.350
> 
> 标签：mysql, sql, navicat

我正在使用 Navicat8 for MySQL 编写触发器，下面是我的触发器语句。

```
insert into two(name,curdate()) 
select name from one 
```

但保存触发器时会显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:44:52.423

您应该指定**列的名称**而不是传递`CURDATE()`.

使用以下语法，

```
insert into two (name, colName) 
select name, CURDATE() 
from one 
```

**更新 1**

所以这就是你要做的。

*   您需要在 table`UNIQUE`上的列上添加约束。`Name``two`

要更改表格，

```
ALTER TABLE tableNamehere ADD CONSTRAINT two_uq UNIQUE(name); 
```

*   [SQLFiddle 演示链接](http://sqlfiddle.com/#!2/9dc4c/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T10:45:08.290

```
insert into two(name, date_col) 
select name, curdate()
from one 
```

首先，您必须命名要插入的列，然后是值。如果要填充表中的所有列，可以保留列名部分并执行

```
insert into two 
select name, curdate()
from one 
```

# java - @PreAuthorize 无法正常工作

> ID：14080893
> 
> 赞同：1
> 
> 时间：2012-12-29T10:44:55.453
> 
> 标签：java, spring, spring-mvc, spring-security, pre-authentication

我的控制器：

```
@RequestMapping("/createchar")
@PreAuthorize("hasRole('ROLE_USER')")
public String createCharacter(Map<String, Object> map, Principal principal) { 
```

弹簧安全.xml

```
<global-method-security pre-post-annotations="enabled"
    proxy-target-class="true" />
...
<intercept-url pattern="/game*" access="ROLE_USER" />
    <form-login login-page="/account/login" ... 
```

页面总是被加载，即使在重新部署应用程序之后也是如此。我什至没有登录。**为什么它不将其重定向到登录页面？**

如果您需要更多信息，请随时询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-02T16:11:32.767

在实习期间，我遇到了同样的问题。我和我的队友花了 2 天时间研究 Spring Security 源代码。但是，今天我们被告知，甚至没有看到任何异常的原因是前面提到的“OP机制”。原因是必须创建代理类。

[Spring 代理机制](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch08s06.html) 所以我们在特定情况下需要做的就是添加

`<aop:config proxy-target-class="true" />`

到 app-servlet.xml

如果您尝试调试代码并查找 Spring 调用的方法，您甚至可以解决类似的问题（因为真正的原因可能不同），但这对您的耐心来说是一个巨大的挑战。

希望这会对您和其他人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T11:07:09.857

控制器 bean 通常驻留在 servlet 上下文中，因此它们既不受 AOP 声明的影响，也不受根应用程序上下文中的 bean 后处理器的影响。

[Spring Framework中applicationContext.xml和spring-servlet.xml的区别](https://stackoverflow.com/questions/3652090/difference-between-applicationcontext-and-spring-servlet-xml-in-spring?lq=1)

我认为代理控制器类不是一个好主意，请参阅[Spring-MVC Problem using @Controller on controller implementation an interface](https://stackoverflow.com/questions/154042/spring-mvc-problem-using-controller-on-controller-implementing-an-interface/3683558) - 所以我更愿意避免在控制器类上使用 AOP 以避免意外 - 并且仅在服务/DAO bean 上使用它即根应用程序上下文中的bean。

在这种情况下，您应该对网页使用拦截 URL 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-01T22:45:22.650

我面临着同样的问题。当我将以下元素从 applicationContext.xml 移动到 *-servlet.xml（我的调度程序的配置 xml）时，我的问题解决了。

```
<security:global-method-security secured-annotations="enabled"/> 
```

您必须在**调度程序的 xml 中包含此元素，而不是在应用程序的 xml**中。
[春季常见问题](http://docs.spring.io/spring-security/site/faq/faq.html#faq-method-security-in-web-context)

# ruby - 有趣的错误？在 OSX 预装 Ruby (1.8.7)

> ID：14080897
> 
> 赞同：5
> 
> 时间：2012-12-29T10:45:46.467
> 
> 标签：ruby

```
2**2
=> 4

2**63
=> -9223372036854775808

2**63 + 2**63
=> -18446744073709551616 
```

`64`以及它返回后的一切`0`

```
2**64
=> 0

2**65
=> 0

2**100
=> 0

2**1000
=> 0 
```

相同的版本在 Linux 上运行良好。

有什么线索吗？

在 64 位模式下运行 OSX 10.8.2。

没有 RVM/Rbenv。

Ruby 1.9.3 运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:28:58.427

这是Ruby 实现中[的一个错误](https://github.com/ruby/ruby/commit/4e4649e13cd4175aab75a0edc2fc5b082cf735d1)，已由补丁 358 修复。

这是因为声明了乘法的返回值，[`volatile`](http://en.wikipedia.org/wiki/Volatile_variable#C.2B.2B11)这意味着*无法优化*。默认的 C 优化不会导致[溢出](http://en.wikipedia.org/wiki/Arithmetic_overflow)，因此`volatile`删除了关键字。

在 Ruby 1.9.3 上可以[正常](http://ideone.com/SQupWI)工作。

# php - 在对其进行某些操作后将变量分配给自身或另一个变量有什么区别吗？

> ID：14080902
> 
> 赞同：2
> 
> 时间：2012-12-29T10:46:32.597
> 
> 标签：php, memory, memory-management

不久前，在对它们进行了一些操作之后，我就赋值变量本身进行了辩论。

将变量分配给自身 [ **AI** ]：

```
echo memory_get_usage() . "\n"; // 645680
$repeatedString = str_repeat('Hello,', 10000);
echo memory_get_usage() . "\n"; // 705944, AI_delta1 = 60264
$repeatedString = explode(',', $repeatedString);
echo memory_get_usage() . "\n"; // 3337888, AI_delta2 = 2631944
echo memory_get_peak_usage() . "\n"; // AI_peak = 3401024 
```

将变量分配给另一个变量 [ **AAV** ]：

```
echo memory_get_usage() . "\n"; // 645752
$repeatedString = str_repeat('Hello,', 10000);
echo memory_get_usage() . "\n"; // 706024, AAV_delta1 = 60272
$explodedString = explode(',', $repeatedString);
echo memory_get_usage() . "\n"; // 3398256, AAV_delta2 = 2692232
echo memory_get_peak_usage() . "\n"; // AAV_peak = 3400984 
```

我在这两种情况下都创建了内存使用测试并减去值：

```
AAV_delta1 - AI_delta = 8
AAV_delta2 - AI_delta2 = 60288
AAV_peak - AI_peak = -40 
```

根据这个结果，使用哪种方法并不重要，内存使用 - 相同。`$repeatedString` 我是否应该在下面的代码中使用变量只是一个问题。

我的结论是正确的还是我的测试不正确？

为什么会这样？

还有一个问题：`AAV_delta1 - AI_delta = 8`，我希望它应该等于 0。为什么等于 8？

注意：内存使用量可能因您的系统而异。

PHP 版本：5.3.5-1ubuntu7.11。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T07:17:38.190

在 AAV 中，有两个数据副本，因为每个变量都必须保留其数据。它们都必须持续存在，直到它们各自的变量被重新分配或超出范围。

在 AI 中，数据*暂时*有两个副本。一旦分配发生，就不再需要原始值。但是，在垃圾回收发生之前，它使用的内存不会被回收。

如果您在分配后立即检查内存使用情况，您不会注意到差异，因为可能还没有 GC。如果你强制 GC，你应该会看到 AI 使用的内存比 AAV 少。

您还可以通过在分配后取消设置原始变量（称为**AAVU**）在 AAV 中获得相同的内存使用改进：

```
$explodedString = explode(",", $repeatedString);
unset($repeatedString); // or $repeatedString = false; 
```

与 AI 一样，您必须强制 GC 立即注意到内存使用量的减少。

更新：

因为 PHP 使用引用计数进行正常的内存管理，AI 应该立即回收字符串使用的内存。字符串以引用计数 1 开始。当它被传递给`explode()`时，引用计数增加到 2（对于爆炸的参数变量的引用）。返回时`explode()`，参数变量的作用域结束，引用计数返回 1。然后，当赋值`$repeatedString`发生时，引用计数下降到 0，字符串的内存被回收。

`gc_collect_cycles()`只需要回收作为循环一部分的数组和对象使用的内存。要查看其影响，请尝试以下代码：

```
gc_enable();
echo "Begin: " .  memory_get_usage() . "\n";
$array = array(str_repeat('Hello,', 10000));
$array[] =& $array; // Create circular reference
echo "After allocate: " . memory_get_usage() . "\n";
unset($array);
echo "After unset: " . memory_get_usage() . "\n";
gc_collect_cycles();
echo "After GC: " . memory_get_usage() . "\n"; 
```

结果：

```
Begin: 226088
After allocate: 286640
After unset: 286552
After GC: 226088 
```

有关详细信息，请参阅[PHP 垃圾收集文档](http://php.net/manual/en/features.gc.php)

# yii - 如何在 extjs 中绑定 yii 动作

> ID：14080911
> 
> 赞同：1
> 
> 时间：2012-12-29T10:48:37.467
> 
> 标签：yii, extjs4

我在 extjs+Yii 工作。我的 yii 行动是：

```
public function actionCreateNew()
{
    $record=Qbquestionset::model()->findAllByAttributes(array("questionPaperId"=>1));

    foreach($record as $rec)
    {
        if($rec==NULL)
        {
            echo"Paper does not exists";
        }
        else
        {
            echo $rec->questionId;
            $record1=Qbquestion::model()->findByAttributes(array("questionId"=>$rec->questionId));
            echo "</br>". $record1->question;
            echo "</br>".CJSON::encode(array("Question"=>$record1->question));
        }

    }
} 
```

此功能正在检索问题并以 json 格式发送。现在在 extjs 中，我创建了模型、视图、控制器和视图 = Model= Question.js

```
Ext.define('Balaee.controller.Question',
          {
    extend:'Ext.app.Controller',
    stores:['Question'],
    models:['Question','QuestionOption'],
    views:['question.Question','question.QuestionView'],
    init:function()
    {
        console.log("inside Question controller");

    },

             }); 
```

Store.js===

```
Ext.define('Balaee.store.Question', {
extend: 'Ext.data.Store',
model: 'Balaee.model.Question',
autoLoad: true,
proxy:{
    type: 'ajax',
    //url:'data/poll.json',
    api: {
        //read: 'data/question.json',
        read: 'http://localhost/NewQuestion/index.php?r=QuestionBank/qbpaper/CreateNew',
    },
    reader: {
        type: 'json',
        //root: 'questions',
    }
}
}); 
```

查看=== questionView.js

```
Ext.define('Balaee.view.question.QuestionView',
{
    extend:'Ext.view.View',
    id:'QuestionViewId',
    alias:'widget.questionView',
    store:'Question',
    config:
    {
        tpl:'<tpl for=".">'+
            '<div id="main">'+
            '</br>'+
            '<b>Question :-</b> {Question}</br>'+
            //'<p>-------------------------------------------</p>'+

            //'<tpl for="options">'+     // interrogate the kids property within the data
                //'<p>&nbsp&nbsp<input type="radio" name="opt" >&nbsp{option}</p>'+
            //'</tpl></p>'+

            '</div>'+
            '</tpl>',
        itemSelector:'div.main',    
    }
});// 
```

所以我通过提及它的 url 来绑定 yii 动作来存储。但是商店没有检索任何价值。那么在 extjs 存储中检索 yii optput 需要进行哪些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:46:42.887

我可以看到的一个问题是您的 Yii 操作。您应该返回 JSON 结果，同时返回一些奇怪的东西。

尝试这个：

```
public function actionCreateNew()
{
    $record = Qbquestionset::model()->findAllByAttributes(array("questionPaperId" => 1));
    $result = array();
    foreach($record as $rec) {
        if ($rec != NULL) {
            $result[] = $record1->question;
        }
    }

    echo CJSON::encode(array(
        'success' => true,
        'root' => $result,
        'total' => count($result)
    ));
} 
```

您还应该定义`root: 'root'`阅读器的属性。

# c++ - 调用 CefBrowserHost::CreateBrowser 时的 Visual Studio C++ 奇怪异常

> ID：14080914
> 
> 赞同：0
> 
> 时间：2012-12-29T10:49:03.007
> 
> 标签：c++, visual-studio, debugging, visual-studio-debugging, chromium

我在我的 win32 应用程序中使用 CEF3（chrome 嵌入式框架），当我运行应用程序时，我收到一条奇怪的错误消息 -

![在此处输入图像描述](../Images/55b925b43018e3989dacea06a4bfb6fb.png)

我来自 C# 开发背景，在 C++ 中，我看不到如何检查我的错误并弄清楚它为什么抱怨我的代码。如何检查错误消息？如果不是 - 您如何在 Visual Studio 中调试此类错误？

这是触发错误的代码 -

```
case WM_CREATE:
    {
        CefRefPtr<CefClient> clientHandler = new ClientHandler();

        RECT rect;
        GetClientRect(hWnd, &rect);

        CefWindowInfo info;
        info.SetAsChild(hWnd, rect);

        // Browser initialization settings.
        CefBrowserSettings settings;

        // Create the new browser window object asynchronously.
        std::string startupUrl = "http://www.google.com/";
        CefBrowserHost::CreateBrowser(info, clientHandler, startupUrl, settings);
    }
    break; 
```

我不需要 CEF3 的帮助（但我会很感激）我只想知道如何在 Visual Studio 中调试这种错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:11:10.040

调试器的输出窗口告诉您抛出了什么异常。

此外，您可以在出现的对话框中单击“Break”，VS 会将您带到引发异常的行。您会在该行的左侧看到一个黄色箭头。

最后，如果异常不是致命的，你可以捕获它并忽略它：

```
try
{
    ...
}
catch (const SomeException&)
{
    // do nothing
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:23:26.447

我在 Release 中构建时遇到了问题。问题是我根本没有调用 CefInitialize。

# php - 来自数组的 PHP IP 限制

> ID：14080916
> 
> 赞同：0
> 
> 时间：2012-12-29T10:49:10.353
> 
> 标签：php

**(1.)**我希望允许访问者仅从某个 IP 地址范围访问页面*（第 2 段）*。轻松地将更多 IP 地址的正则表达式添加到 IP 地址列表。

**我的正则表达式数组是：**

```
$IP_LIST_ACCESS = array(  
"/^188\.133\.11\.([1-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-4]))$/"  
,"/^188\.133\.14\.([1-9]|[1-9][0-9]|1([0-1][0-9]|2[0-8]))$/"  
,"/^127\.0\.0\.1$/"                                                         
); 
```

**(2.)**上述数组的 IP 范围是`188.133.11.1-188.133.11.254`and `188.136.14.1-188.136.14.128`and`127.0.0.1`

下面是**我检测错误 IP 地址并死掉的代码：**

```
$USER_IP_ADDR = $_SERVER['REMOTE_ADDR'];
foreach ($IP_LIST_ACCESS as $IP_ACC_ARRAY)
{
  if (!preg_match($IP_ACC_ARRAY, $USER_IP_ADDR))
  {
    echo '#INVALID IP'; #DEBUG
    die;
  }
} 
```

**(3.)**使用我上面的代码，总是给出`INVALID IP`错误（总是检测为错误的 IP 地址）。
**哪里有问题 ？**

**编辑**
**（4。）**我只是想这样做，如果有更好的方法，与 preg_match 不完全一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T10:57:11.063

更好地使用正则表达式的 ip2long insted，它更易于阅读并且具有更好的性能。

```
$ip_ranges = array(
    array(
        'from' => ip2long('188.133.11.1'),
        'to' => ip2long('188.133.11.254')
    ),
    array(
        'from' => ip2long('188.136.14.1'),
        'to' => ip2long('188.136.14.128')
    ),
    array(
        'from' => ip2long('127.0.0.0'),
        'to' => ip2long('127.255.255.255')
    ),
);

$USER_IP_ADDR = $_SERVER['REMOTE_ADDR'];
$USER_IP_ADDR_LONG = ip2long($USER_IP_ADDR);

$USER_IS_PERMITTED = false;
foreach ($ip_ranges as $ip_range) {
    if ($ip_range['from'] <= $USER_IP_ADDR_LONG && $ip_range['to'] >= $USER_IP_ADDR_LONG) {
        $USER_IS_PERMITTED = true;
    }
}

if (!$USER_IS_PERMITTED) {
    echo '#INVALID IP: ' . $USER_IP_ADDR; #DEBUG
    die;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T10:54:53.100

看一下[`ip2long()`](http://php.net/manual/en/function.ip2long.php)，它会从其 Internet 标准格式（点分字符串）表示中生成 IPv4 Internet 网络地址。

稍后，您可以对其执行范围操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:59:39.130

我相当肯定你想要`if (preg_match($IP_ACC_ARRAY, $USER_IP_ADDR) === 1)`。现在，如果*不*匹配，您将显示错误。这是最快的解决方案，但也许`ip2long`其他答案中提出的基于 - 的解决方案是最正确的。

# objective-c - 一个过滤器正在重置另一个。不能同时申请

> ID：14080922
> 
> 赞同：0
> 
> 时间：2012-12-29T10:49:46.440
> 
> 标签：objective-c, ios

我在一张图片上使用了 2 个滤镜。问题很容易理解，如果我移动一个滑块，过滤器将正常应用，但当我移动另一个滑块时，图片将重置为原始`_tempImage`. 我尝试过替换 `_justNowImage.image = quickFilteredImage;`，`_tempImage = quickFilteredImage;`但结果是过滤器变得疯狂。

谢谢

```
 - (IBAction)sharpenSliderChanged:(id)sender
    {   
        GPUImageSharpenFilter *sharpenFilter = [[GPUImageSharpenFilter alloc] init];
        [sharpenFilter setSharpness:sharpenSlider.value];
        UIImage *quickFilteredImage = [sharpenFilter imageByFilteringImage: _tempImage];
        _justNowImage.image = quickFilteredImage;
    }

    - (IBAction)exposureSliderChanged:(id)sender
    {
        GPUImageExposureFilter *exposureFilter = [[GPUImageExposureFilter alloc] init];
        [exposureFilter setExposure:exposureSlider.value];
        UIImage *quickFilteredImage = [exposureFilter imageByFilteringImage: _tempImage];
        _justNowImage.image = quickFilteredImage;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:27:36.723

```
 UIImage *quickFilteredImage = [exposureFilter imageByFilteringImage: _tempImage]; 
```

**您仅对原始图像应用不同的过滤器..即** `_tempImage`

将这些行添加到两种方法的末尾

```
_tempImage = quickFilteredImage 
```

# ruby - echoe 需要 RubyGems 版本 >= 1.8.4

> ID：14080923
> 
> 赞同：-1
> 
> 时间：2012-12-29T10:50:00.443
> 
> 标签：ruby, ubuntu, gem, rvm

我在 Ubuntu 上。并想安装 echoe gem。对于这个运行`sudo gem install echoe`命令。

并得到

```
ERROR:  Error installing echoe:
    echoe requires RubyGems version >= 1.8.4\. Try 'gem update --system' to update RubyGems itself. 
```

我的`RubyGems version is 1.8.17`，得到这个使用

`gem -v`给我`1.8.17`

为什么我收到此错误消息，我已经有了`RubyGems version >= 1.8.4`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T12:08:34.270

可能是您使用 rvm 来安装您的 ruby​​。如果您现在使用`sudo gem install ...`，您将激活已过时的系统 ruby​​ 安装。尝试使用`gem install ...`，或者如果这不起作用`ruby -S gem install ...`。

# c++ - 实现opengl sphere示例代码

> ID：14080932
> 
> 赞同：1
> 
> 时间：2012-12-29T10:50:55.743
> 
> 标签：c++, opengl

尝试实现我[在 stackoverflow 上找到](https://stackoverflow.com/questions/5988686/how-do-i-create-a-3d-sphere-in-opengl-using-visual-c?lq=1)的球体示例代码时遇到了问题。请注意，我没有使用绘图代码，而是使用`void SolidSphere`此示例中的函数来创建我的顶点数据。

这是我的代码，对我引用的示例进行了一些细微的更改：

```
std::vector<GLfloat> vertices;
std::vector<GLfloat> normals;
std::vector<GLfloat> texcoords;
std::vector<GLushort> indices;

    Sphere(shared_ptr<GL::Shader> _shader, shared_ptr<Material> _material, float radius, unsigned int rings, unsigned int sectors)
{
    this->attachShader(_shader);
    this->attachMaterial(_material);

    /** Implementation from:
    https://stackoverflow.com/questions/5988686/how-do-i-create-a-3d-sphere-in-opengl-using-visual-c?lq=1
    **/

    float const R = 1./(float)(rings-1);
    float const S = 1./(float)(sectors-1);
    int r, s;

    vertices.resize(rings * sectors * 3);
    //normals.resize(rings * sectors * 3);
    texcoords.resize(rings * sectors * 2);
    std::vector<GLfloat>::iterator v = vertices.begin();
    //std::vector<GLfloat>::iterator n = sphere_normals.begin();
    std::vector<GLfloat>::iterator t = texcoords.begin();
    for(r = 0; r < rings; r++) {
        for(s = 0; s < sectors; s++) {
            float const y = sin( -M_PI/2 + M_PI * r * R );
            float const x = cos(2*M_PI * s * S) * sin( M_PI * r * R );
            float const z = sin(2*M_PI * s * S) * sin( M_PI * r * R );

            *t++ = s*S;
            *t++ = r*R;

            *v++ = x * radius;
            *v++ = y * radius;
            *v++ = z * radius;

            //*n++ = x;
            //*n++ = y;
            //*n++ = z;
        }
    }

    indices.resize(rings * sectors * 4);
    std::vector<GLushort>::iterator i = indices.begin();
    for(r = 0; r < rings; r++) {
        for(s = 0; s < sectors; s++) {
            *i++ = r * sectors + s;
            *i++ = r * sectors + (s+1);
            *i++ = (r+1) * sectors + (s+1);
            *i++ = (r+1) * sectors + s;
        }
    }

           /************* THIS IS THE ADDED PART ********/
    for (unsigned int i = 0; i < vertices.size(); i += 3) {
        vertexCoords.push_back(glm::vec4(vertices[i], vertices[i+1], vertices[i+2], 1));
    }

    for (unsigned int i = 0; i < texcoords.size(); i += 2) {
        textureCoords.push_back(glm::vec2(texcoords[i], texcoords[i+1]));
    }
    indexElements = indices;

    cout << "Vertex vector size: " << vertexCoords.size() << endl;
    cout << "Texture vector size: " << textureCoords.size() << endl;
    cout << "Element index vector size: " << indexElements.size() << endl;
} 
```

这里唯一的大变化是使用`M_PI / 2`而不是`M_PI_2`和两个循环将值推入我的代码使用的格式，即：

```
vector <glm::vec4> vertexCoords;
vector <glm::vec2> textureCoords;
vector <GLushort> indexElements; 
```

这是我正在渲染的图片：

![在此处输入图像描述](../Images/ff9edf4692e4a93e86b7f469dd02838a.png)

所以我看到球体顶部的最后一行..

有什么明显的我在这段代码中做错了可能导致这种情况的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T12:29:24.800

在这个循环中：

```
for(r = 0; r < rings; r++) {
    for(s = 0; s < sectors; s++) {
        *i++ = r * sectors + s;
        *i++ = r * sectors + (s+1);
        *i++ = (r+1) * sectors + (s+1);
        *i++ = (r+1) * sectors + s;
    }
} 
```

您正在访问哪个时间`r+1`和（即循环的最后一次迭代）将比您可用的数据高一个。`s+1``r = rings - 1``s = sectors - 1`

这将指向一个未初始化的内存区域。这可以包含任何内容，但在这种情况下，它似乎包含零，这将解释线走向原点。

当您绘制“下一个”四边形时，您只需提前一次迭代停止这些循环：

```
for(r = 0; r < rings-1; r++) {
    for(s = 0; s < sectors-1; s++) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T12:05:26.047

您只有`rings*sectors`顶点，但您的索引上升到`(rings-1+1)*sectors+(sectors-1+1)`=rings*sectors+sectors。这正是`sectors`顶点的数量太多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T12:23:13.890

问题是边界的输出索引。尝试修复这部分代码，以便

```
indices.resize(rings * sectors * 4);
std::vector<GLushort>::iterator i = indices.begin();
for(r = 0; r < rings-1; r++) {
    for(s = 0; s < sectors-1; s++) {
        *i++ = r * sectors + s;
        *i++ = r * sectors + (s+1);
        *i++ = (r+1) * sectors + (s+1);
        *i++ = (r+1) * sectors + s;
    }
} 
```

# java - Java，认为我的变量是包错误（尝试制作哈希图）

> ID：14080934
> 
> 赞同：-3
> 
> 时间：2012-12-29T10:51:03.610
> 
> 标签：java, hashmap

我什至复制了其他人哈希图的粘贴示例，他们给出了同样的错误。有什么我在这里没见过的明显愚蠢的东西吗？

```
package hangman;
import java.util.*;
public class Dictionary 
{
    Map<String,String> myDictionary = new HashMap<String,String>();
    myDictionary.put("czxc","asdsad");
} 
```

netbeans 说包 myDictionary 不存在，预期的，非法类型的开始。

非常感谢任何可以提供帮助的人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:14:55.683

您缺少构造函数，我为您更改了代码：

```
package hangman;
import java.util.*;
public class Dictionary {
     private Map<String,String> myDictionary = new HashMap<String,String>();

     public Dictionary(){
         myDictionary.put("czxc","asdsad");
     }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:40:42.950

您可以通过较小的更改来实现可执行代码：

```
public class Dictionary {
    Map<String,String> myDictionary = new HashMap<String,String>() {{
        put("czxc","asdsad");
    }};
} 
```

如果您以前没有见过这种语法，它可能会显得“奇怪”：它是一个带有初始化程序块的匿名类。

# android - 确定一个电话号码在android中是否有短信

> ID：14080936
> 
> 赞同：0
> 
> 时间：2012-12-29T10:51:10.603
> 
> 标签：android, sms

有没有办法判断一个电话号码在android中是否有短信？

我想知道是否有办法告诉使用 sms content porvider 我知道它没有记录并且不推荐使用但是有没有办法告诉？

我尝试过的。

此语句将获取所有收件箱短信

```
cursor = getContentResolver().query(
                            Uri.parse("content://sms/inbox"), null, null, null,
                            null); 
```

我不能像这样使用 where 子句

```
cursor = getContentResolver().query(
                            Uri.parse("content://sms/inbox"), "address =?", new String[]{"001435436654747"}, null,
                            null); 
```

因为该号码可能在没有全局代码“001”等的情况下存储。有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:28:04.150

嗨，您可以使用下面的代码来执行此操作，我在我的应用程序中使用它来收听传入的短信以自动回复。

```
Uri myMessage = Uri.parse("content://sms/");
    ContentResolver cr = getContentResolver();
    Cursor c = cr.query(myMessage, new String[] {
            "_id", "address", "date", "body",
            "read" }, null, null, null);   

    System.out.println(Number);

    while (c.moveToNext()) {
       Number = c.getString(c.getColumnIndexOrThrow("address")).toString();

        if (Number.equals("001435436654747")) {

            // DO YOUR STUFF

        }

    } 
```

# ef-code-first - 如何从 0 开始实体框架标识

> ID：14080937
> 
> 赞同：1
> 
> 时间：2012-12-29T10:51:12.787
> 
> 标签：ef-code-first, entity-framework-5

这是我的主键列所在的配置，`NetworkId`它`DatabaseGeneratedOption`是`Identity`.

```
public NetworkConfiguration() : base()
{
   this.HasKey(e => e.NetworkId);
   Property(e => e.NetworkId).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
} 
```

这个值从 1 开始我总是可以让它从 0 开始吗​​？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T10:04:30.607

在 MVC 3 和 EF 4.1 中，你可以尝试这样的事情：

```
context.Database.ExecuteSqlCommand("DBCC CHECKIDENT ('NetworkConfiguration', RESEED, 0)"); 
```

然后是用其余值填充表的方法

```
SeedNetworkConfiguration(); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-12-29T10:55:35.380

数据库 id 将始终从 1 开始。出于兴趣，您为什么希望 id 为 0？

# c - Cortex m3：致命错误：inc/hw_ints.h：没有这样的文件或目录

> ID：14080938
> 
> 赞同：0
> 
> 时间：2012-12-29T10:51:17.070
> 
> 标签：c, cortex-m3, gpio

我正在使用 Cortex M3、Stellaris® LM3S6965 评估板。如果我按下一个按钮，我正在尝试打开一个 LED。但是在构建时它总是给我一个错误。

在程序中，我基本上检查按钮的状态，然后启用 LED。我是新手，我尝试搜索，但我真的找不到有用的东西。

非常感谢

我现在的程序

```
#include "inc/hw_types.h"
#include "inc/hw_memmap.h"
#include "driverlib/sysctl.h"
#include "driverlib/gpio.h"

char rawInputActive(void);

int main(void)
{
    volatile unsigned long ulLoop;

    /* Enable all the GPIO ports that I use*/
    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);
    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOE);

    /* Config the pins (input, output,..)*/
    GPIOPinTypeGPIOInput(GPIO_PORTF_BASE, GPIO_PIN_1);  // select
    GPIOPinTypeGPIOInput(GPIO_PORTE_BASE, GPIO_PIN_0);  // up
    GPIOPinTypeGPIOInput(GPIO_PORTE_BASE, GPIO_PIN_1);  // down
    GPIOPinTypeGPIOInput(GPIO_PORTE_BASE, GPIO_PIN_2);  // left
    GPIOPinTypeGPIOInput(GPIO_PORTE_BASE, GPIO_PIN_3);  // right

    GPIOPinTypeGPIOOutput(GPIO_PORTF_BASE, GPIO_PIN_0); // led
    GPIOPadConfigSet(GPIO_PORTF_BASE,GPIO_PIN_1,GPIO_STRENGTH_2MA,GPIO_PIN_TYPE_STD_WPU);

    /* Enable the clock for the GPIO ports.*/
    SysCtlClockSet(SYSCTL_SYSDIV_1 | SYSCTL_USE_OSC | SYSCTL_OSC_MAIN |
                       SYSCTL_XTAL_8MHZ);

    while(1)
    {
        volatile int iDelay;
        volatile int read;

        if(GPIOPinRead(GPIO_PORTF_BASE,GPIO_PIN_1) == 0){
            GPIOPinWrite(GPIO_PORTF_BASE, GPIO_PIN_0, GPIO_PIN_0); // Led select
            //ret |= 1;
            for(iDelay = 0; iDelay < 3000; iDelay++);
            GPIOPinWrite(GPIO_PORTF_BASE, GPIO_PIN_0, ~GPIO_PIN_0);
            while(GPIOPinRead(GPIO_PORTF_BASE,GPIO_PIN_1) == 0){}
            for(iDelay = 0; iDelay < 3000; iDelay++);
        }

    }
} 
```

我在构建时遇到的错误。

```
GCC HOME: C:\Program Files (x86)\GNU Tools ARM Embedded\4.6 2012q2\bin
    compile:
        [mkdir] Skipping C:\projects\new\PushButton\Debug\bin because it already exists.
        [mkdir] Skipping C:\projects\new\PushButton\Debug\obj because it already exists.
           [cc] Starting dependency analysis for 2 files.
           [cc] Parsing ..\..\cmsis\core_cm3.c
           [cc] Parsing ..\..\startup\startup_lm3s.c
           [cc] 2 files are up to date.
           [cc] 0 files to be recompiled from dependency analysis.
           [cc] 5 total files to be compiled.
           [cc] arm-none-eabi-gcc -mcpu=cortex-m3 -mthumb -Wall -ffunction-sections -O0 -g -c -DLM3S6965 -IC:\projects\new\PushButton C:\projects\new\PushButton\main.c C:\projects\new\PushButton\lm3slib\driverlib\sysctl.c C:\projects\new\PushButton\lm3slib\driverlib\gpio.c C:\projects\new\PushButton\lm3slib\driverlib\interrupt.c C:\projects\new\PushButton\lm3slib\driverlib\cpu.c
           [cc] C:\projects\new\PushButton\main.c:21:26: fatal error: inc/hw_types.h: No such file or directory
           [cc] compilation terminated.
           [cc] C:\projects\new\PushButton\lm3slib\driverlib\sysctl.c:32:25: fatal error: inc/hw_ints.h: No such file or directory
           [cc] compilation terminated.
           [cc] C:\projects\new\PushButton\lm3slib\driverlib\gpio.c:32:25: fatal error: inc/hw_gpio.h: No such file or directory
           [cc] compilation terminated.
           [cc] C:\projects\new\PushButton\lm3slib\driverlib\interrupt.c:32:25: fatal error: inc/hw_ints.h: No such file or directory
           [cc] compilation terminated.
           [cc] C:\projects\new\PushButton\lm3slib\driverlib\cpu.c:26:27: fatal error: driverlib/cpu.h: No such file or directory
           [cc] compilation terminated.

    BUILD FAILED
    Total time: 0 seconds 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:28:27.797

您需要添加`-I lm3slib`到您的编译器标志。这告诉编译器查看该目录，该目录似乎是文件所在的位置。

# javascript - 如何在 ruby 代码中添加 JS 变量？

> ID：14080940
> 
> 赞同：-1
> 
> 时间：2012-12-29T10:51:22.817
> 
> 标签：javascript, ruby-on-rails, ruby, ajax, jquery

我有带有 ajax 的 JS 函数，下面是 url：

```
var company_count = COMPANIES_PER_PAGE;

....

url: '<%=j companies_path(start: ' + company_count + ', f: params[:f]) %>',
....
company_count += COMPANIES_PER_PAGE; 
```

但这给了我脚本：

```
url: '/companies?f=k&amp;start=company_count', 
```

我想得到前任：

```
url: '/companies?f=k&start=30', 
```

整个脚本

```
 <script>
    var COMPANIES_PER_PAGE = <%= @companies_per_page %>;
    var company_count = COMPANIES_PER_PAGE;

    $(document).ready( function(){
      checkScroll();
    });

    function checkScroll() {
      if (nearBottomOfPage()) {
        $('#loading_more_'+(company_count-COMPANIES_PER_PAGE)).fadeTo(200, 1);
        $.ajax({
           type: "GET",
           url: '<%=j companies_path(start: company_count, f: params[:f]) %>',
           dataType: "script"
         });
        company_count += COMPANIES_PER_PAGE;
      } else {
        setTimeout(checkScroll, 250);
      }
    }
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T11:32:44.843

为什么不使用 $.ajax() 的 data 属性呢？它允许您附加所有 JS 变量，以及 Ruby 生成的变量...

```
$.ajax({
       type: "GET",
       url: '<%=j companies_path %>',
       data: { start: "<%= params[:f] %>", start: company_count },
       dataType: "script"
}); 
```

# vim - 具有新键盘布局的 vim 键绑定

> ID：14080942
> 
> 赞同：7
> 
> 时间：2012-12-29T10:51:53.787
> 
> 标签：vim, keyboard-shortcuts

[这个问题与这个](https://stackoverflow.com/questions/165231/vim-dvorak-keybindings-rebindings)问题相同，只是关于（鲜为人知的）[新键盘布局](http://neo-layout.org/)而不是 dvorak。

我想开始编程，我知道如果使用得当，vi 和 vim 被认为是高效的编码编辑器。现在我正在使用 neo 键盘布局，我想知道 vim 的哪些键绑定可能最适合这种布局。我不想学习使用 vim，发现我的键绑定不能很好地工作，然后我不得不重新调整我的习惯。

所以对于所有使用 vim + neo 的人：你如何*重新*映射 vim 的键绑定以最好地使用*neo*？

（更一般地说：更改 vim 键绑定时我应该记住哪些事情？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T01:10:35.223

通常，我不会更改键绑定。Vim 命令之所以有效，是因为它们大体上是助记符。让他们独自一人，并在他们站立的地方使用它们。我看到 hjkl 在该布局上的布局不太好，但您似乎确实在“Ebene 4”后面有光标键，所以如果这不是太麻烦，也许没关系。（反正我发现自己使用hjkl的不多，我通常使用其他更直接的跳跃移动命令。）

我是 Dvorak 布局用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:51:52.150

更一般地说，作为**VIM 用户**而**不是****Neo 用户**，我通常会在键盘上模仿 VIM 键布局。注意 VIM 中的哪些键位于每个手指的静止位置下方，并将其翻译到 Neo 上。

保留覆盖在新键盘布局上的传统布局将使常用键保持在您的**静止手指位置**之下。当您需要在非 Neo 键盘上工作时，它还将建立可以转移到 QWERTY 的**肌肉记忆。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-18T19:58:55.623

我自己是 VIM 和 Neo2 用户。两者都相当一段时间。我可以告诉你：大约 90% 的命令比 qwertz 上的命令更好用（至少恕我直言）。一些 '`' 命令的类型很奇怪，但你习惯了。但是您可以考虑更改 vim 的 LEADER-Key（我已将其移至 'j'）。

# segmentation-fault - 由于链接问题，程序无法运行

> ID：14080943
> 
> 赞同：1
> 
> 时间：2012-12-29T10:51:55.457
> 
> 标签：segmentation-fault, undefined-symbol, nm

我在执行二进制文件时遇到了麻烦。程序收到分段错误。过滤是 gdb 的输出

```
gdb a.out

(gdb) run
Starting program: a.out

Program received signal SIGSEGV, Segmentation fault.
0x00000001 in ?? ()
(gdb) 
```

然后我使用了 nm 实用程序

```
nm -u a.out
      U Allocatememory 
```

我发现许多符号未定义。这个 a.out 二进制文件实际上是通过链接许多其他 .so 获得的。我在其中一个 .so 上做了 nm

```
nm libmylib.so
00000000000de6f  T Allocate memory 
```

该程序与上面的 libmylib.so 链接。在链接过程中我没有收到任何错误。

```
g++ -m32  -shared -Wl -o a.out -lmylib 
```

但是，如果没有 -shared 选项，我会收到以下错误

```
/usr/bin/ld: <path_to_bin>/a.out: hidden symbol `__dso_handle' in 
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/32/crtbegin.o is referenced by DSO
/usr/bin/ld: final link failed: Nonrepresentable section on output
collect2: ld returned 1 exit status
*** Error code 1 
```

可能是什么问题呢？有人可以建议我如何解决这个问题吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:55:00.113

> g++ -m32 -shared -Wl -o a.out -lmylib

这将构建一个*共享库*，名为`a.out`. 不要那样做：共享库不能直接执行。

你会想要这样做：

```
g++ -m32 main.cc -o a.out -lmylib 
```

其中`main.cc`包含实际`main`功能。

# c++ - 带顶点数组的 OpenGL 光照

> ID：14080945
> 
> 赞同：2
> 
> 时间：2012-12-29T10:52:03.030
> 
> 标签：c++, opengl, lighting

我只是在编写一个简单的程序来使用顶点数组对象绘制体素。当我运行程序时，我无法让照明正常工作，它看起来与未启用灯光时相同。这是代码片段。显示功能

```
void GraphicVoxel::display()
{
   glColor3fv(&color[0]);
   glEnableClientState(GL_NORMAL_ARRAY);
   glEnableClientState(GL_VERTEX_ARRAY);  
   glNormalPointer(GL_FLOAT, 0, &norms[0]);
   glVertexPointer(3, GL_FLOAT, 0, &verts[0]);

   glPushMatrix();

   glTranslatef(x, y, -z);

   glDrawArrays(GL_QUADS, 0, verts.size()/3);

   glPopMatrix();

   glDisableClientState(GL_NORMAL_ARRAY);
   glDisableClientState(GL_VERTEX_ARRAY);
} 
```

opengl 初始化

```
void initGL(sf::Window & window)
{
   gluPerspective(40., float(window.getSize().x)/
      float(window.getSize().y), 1., 10000.);

   glEnable(GL_DEPTH_TEST);

   glEnable(GL_LIGHTING);

   glColorMaterial( GL_FRONT_AND_BACK, GL_AMBIENT_AND_DIFFUSE);
   glEnable( GL_COLOR_MATERIAL );

   GLfloat lightKa[] = {.1f, .1f, .1f, 1.0f};
   GLfloat lightKd[] = {1.f, 1.f, 1.f, 1.0f}; 
   GLfloat lightKs[] = {0.5, 0.5, 0.5, 0.5};
   glLightfv(GL_LIGHT0, GL_AMBIENT, lightKa);
   glLightfv(GL_LIGHT0, GL_DIFFUSE, lightKd);
   glLightfv(GL_LIGHT0, GL_SPECULAR, lightKs);

   float lightPos[4] = {100, 1, 0, 0};
   glLightfv(GL_LIGHT0, GL_POSITION, lightPos);

   glEnable(GL_LIGHT0);
} 
```

以及用于创建顶点和法线数组的代码

```
// create vertex array
   verts.resize(72);
   // left
   verts[0] = -width/2.f; verts[1] = -height/2.f; verts[2] = -depth/2.f;
   verts[3] = -width/2.f; verts[4] = -height/2.f; verts[5] =  depth/2.f;
   verts[6] = -width/2.f; verts[7] =  height/2.f; verts[8] =  depth/2.f;
   verts[9] = -width/2.f; verts[10]=  height/2.f; verts[11]= -depth/2.f;
   // right
   verts[12]=  width/2.f; verts[13]= -height/2.f; verts[14]= -depth/2.f;
   verts[15]=  width/2.f; verts[16]= -height/2.f; verts[17]=  depth/2.f;
   verts[18]=  width/2.f; verts[19]=  height/2.f; verts[20]=  depth/2.f;
   verts[21]=  width/2.f; verts[22]=  height/2.f; verts[23]= -depth/2.f;
   // back
   verts[24]= -width/2.f; verts[25]=  height/2.f; verts[26]=  depth/2.f;
   verts[27]= -width/2.f; verts[28]= -height/2.f; verts[29]=  depth/2.f;
   verts[30]=  width/2.f; verts[31]= -height/2.f; verts[32]=  depth/2.f;
   verts[33]=  width/2.f; verts[34]=  height/2.f; verts[35]=  depth/2.f;
   // front
   verts[36]= -width/2.f; verts[37]=  height/2.f; verts[38]= -depth/2.f;
   verts[39]= -width/2.f; verts[40]= -height/2.f; verts[41]= -depth/2.f;
   verts[42]=  width/2.f; verts[43]= -height/2.f; verts[44]= -depth/2.f;
   verts[45]=  width/2.f; verts[46]=  height/2.f; verts[47]= -depth/2.f;
   // top
   verts[48]= -width/2.f; verts[49]=  height/2.f; verts[50]=  depth/2.f;
   verts[51]= -width/2.f; verts[52]=  height/2.f; verts[53]= -depth/2.f;
   verts[54]=  width/2.f; verts[55]=  height/2.f; verts[56]= -depth/2.f;
   verts[57]=  width/2.f; verts[58]=  height/2.f; verts[59]=  depth/2.f;
   // bottom
   verts[60]= -width/2.f; verts[61]= -height/2.f; verts[62]=  depth/2.f;
   verts[63]= -width/2.f; verts[64]= -height/2.f; verts[65]= -depth/2.f;
   verts[66]=  width/2.f; verts[67]= -height/2.f; verts[68]= -depth/2.f;
   verts[69]=  width/2.f; verts[70]= -height/2.f; verts[71]=  depth/2.f;

   norms.resize(72);
   // left
   norms[0] = -1.f; norms[1] =  0.f; norms[2] =  0.f;
   norms[3] = -1.f; norms[4] =  0.f; norms[5] =  0.f;
   norms[6] = -1.f; norms[7] =  0.f; norms[8] =  0.f;
   norms[9] = -1.f; norms[10]=  0.f; norms[11]=  0.f;
   // right
   norms[12]=  1.f; norms[13]=  0.f; norms[14]=  0.f;
   norms[15]=  1.f; norms[16]=  0.f; norms[17]=  0.f;
   norms[18]=  1.f; norms[19]=  0.f; norms[20]=  0.f;
   norms[21]=  1.f; norms[22]=  0.f; norms[23]=  0.f;
   // back
   norms[24]= -0.f; norms[25]=  0.f; norms[26]=  1.f;
   norms[27]= -0.f; norms[28]= -0.f; norms[29]=  1.f;
   norms[30]=  0.f; norms[31]= -0.f; norms[32]=  1.f;
   norms[33]=  0.f; norms[34]=  0.f; norms[35]=  1.f;
   // front
   norms[36]= -0.f; norms[37]=  0.f; norms[38]= -1.f;
   norms[39]= -0.f; norms[40]= -0.f; norms[41]= -1.f;
   norms[42]=  0.f; norms[43]= -0.f; norms[44]= -1.f;
   norms[45]=  0.f; norms[46]=  0.f; norms[47]= -1.f;
   // top
   norms[48]= -0.f; norms[49]=  1.f; norms[50]=  0.f;
   norms[51]= -0.f; norms[52]=  1.f; norms[53]= -0.f;
   norms[54]=  0.f; norms[55]=  1.f; norms[56]= -0.f;
   norms[57]=  0.f; norms[58]=  1.f; norms[59]=  0.f;
   // bottom
   norms[60]= -0.f; norms[61]= -1.f; norms[62]=  0.f;
   norms[63]= -0.f; norms[64]= -1.f; norms[65]= -0.f;
   norms[66]=  0.f; norms[67]= -1.f; norms[68]= -0.f;
   norms[69]=  0.f; norms[70]= -1.f; norms[71]=  0.f; 
```

体素显示得非常好，但阴影两侧的颜色没有差异。如果有人想知道，我正在使用 sfml 进行窗口化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T14:44:35.323

好吧，在接受了几个月的照明错误之后，我意识到我将颜色作为浮点数从 0-255 而不是 0.f 传递到 1.f。将范围更改为 0.f-1.f 修复了照明。

# android - 删除android中的项目后如何保持数组列表的排序？

> ID：14080948
> 
> 赞同：1
> 
> 时间：2012-12-29T10:52:34.507
> 
> 标签：android, sorting, arraylist

我正在制作一个项目的数组列表并偶尔更改其内容。问题是从数组列表中删除一个项目后，项目序列被破坏并且数组列表失去了排序。我搜索了很多但没有得到关于在从中删除项目后如何保持数组列表排序的任何想法。这是我正在使用的代码：

```
ArrayList<String> m_namesOfContactsArrayList = new ArrayList<String>();

for(int i = 0;i < 100;i++)
m_namesOfContactsArrayList.add(i); 
```

这是我要删除项目的地方：

```
m_namesOfContactsArrayList.remove(3);
m_namesOfContactsArrayList.remove(4);
m_namesOfContactsArrayList.remove(5); 
```

请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:07:47.210

删除元素不会影响元素的顺序。

只是为了在您的代码上演示它：

ArrayList m_namesOfContactsArrayList = new ArrayList();

```
for(int i = 0;i < 10;i++)
    m_namesOfContactsArrayList.add(""+i);

System.out.println(m_namesOfContactsArrayList);

m_namesOfContactsArrayList.remove(3);
m_namesOfContactsArrayList.remove(4);
m_namesOfContactsArrayList.remove(5);

System.out.println(m_namesOfContactsArrayList); 
```

移除前：[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

移除后：[0, 1, 2, 4, 6, 8, 9]

这三个元素都消失了，但列表仍然排序。顺便说一句，java`List`旨在按插入顺序排序。如果您想按某些特定标准对元素进行排序，您可以使用例如 a `SortedSet`，例如`TreeSet`

# asp.net-mvc-3 - 在 mvc3 中使用 javascript 进行自定义验证

> ID：14080951
> 
> 赞同：2
> 
> 时间：2012-12-29T10:53:32.380
> 
> 标签：asp.net-mvc-3, validation

我是 MVC3 的新手。例如，我在自定义验证中遇到问题

在我的 BasicInfoViewModel.cs 中，

```
[Required]
    [Display(Name = "State", ResourceType = typeof(Resources.Global))]
    public string State { get; set; }

    [Display(Name = "City", ResourceType = typeof(Resources.Global))]
    public string City { get; set; } 
```

在我的 BasicDetailsView.cshtml 中，

```
<label>
<span class="td">@Application.Resources.Global.State</span>
 @Html.DropDownListFor(m => m.State, (List<SelectListItem>)ViewData["State"])
</label>
<label>
<span class="td">@Application.Resources.Global.City</span>
@Html.DropDownListFor(m => m.City, (List<SelectListItem>)ViewData["City"])
</label> 
```

如果**state**属性返回**true**，则只需要**“City”**。如果不是，则不需要**城市**，则应禁用文本框。我没有使用*EditorFor*，而是使用*DropDownListFor*因为我使用的是纯 html。谁能帮我解决这个问题？谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T11:04:29.587

[`MVC Foolproof`](http://foolproof.codeplex.com/)是一组验证数据注释，可扩展现有注释并提供附加功能。例如`[RequiredIfNotEmpty]`，这个包中的属性非常适合您的场景，因为它允许条件验证。

```
[Display(Name = "State", ResourceType = typeof(Resources.Global))]
public string State { get; set; }

[RequiredIfNotEmpty("State")]
[Display(Name = "City", ResourceType = typeof(Resources.Global))]
public string City { get; set; } 
```

现在 State 属性是可选的。但如果它有一些价值，则需要 City 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:07:52.573

您可能想查看[RequiredIfAttribute](https://gist.github.com/1547191)。要禁用您的城市下拉列表 - 使用 jquery。为了检查数据是否有效，你有 js 方法 $("selector") *.valid()*它返回 0 或 1 并且还显示指定字段的验证消息

# php - 为什么这段 SQL 代码不起作用？

> ID：14080952
> 
> 赞同：8
> 
> 时间：2012-12-29T10:53:58.377
> 
> 标签：php, mysql, sql, database

我创建了 3 个不同的表，它的编码是

```
CREATE TABLE `shirt` (
   `id` int(11) not null,
   `name` varchar(32),
   PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `shirt` (`id`, `name`) VALUES 
('1', 'vneck'),
('2', 'scoop neck');

CREATE TABLE `shirt_size` (
   `shirtId` int(11) not null,
   `sizeId` int(11) not null,
   PRIMARY KEY (`shirtId`,`sizeId`),
   KEY `sizeId` (`sizeId`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `shirt_size` (`shirtId`, `sizeId`) VALUES 
('1', '2'),
('1', '3'),
('1', '4'),
('1', '5'),
('2', '1'),
('2', '2'),
('2', '3'),
('2', '4'),
('2', '5'),
('2', '6'),
('2', '7');

CREATE TABLE `size` (
   `id` int(11) not null,
   `name` varchar(4),
   PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `size` (`id`, `name`) VALUES 
('1', 'xs'),
('2', 's'),
('3', 'm'),
('4', 'l'),
('5', '1x'),
('6', '2x'),
('7', '3x'); 
```

我用这个查询它

```
SELECT shirt.name, size.name 
FROM   shirt
       INNER JOIN
          shirt_size ON shirt_size.shirtId = shirt.id
        INNER JOIN
          size ON size.id = shirt_size.sizeId 
```

但是结果表只显示了衬衫的名称，我也需要尺寸列显示在屏幕上。在我输入的 FROM 部分中，`shirt, size`但出现了错误。深入研究后，我看到很多人只将第一个表名放在 FROM 部分中。我不明白它应该如何代表该`size.name`列。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T10:55:34.243

它们具有相同的列名（*尽管来自不同的表*）。您需要`ALIAS`在其中一列（*或两者*）上提供一个，例如

```
SELECT shirt.name as ShirtName, 
       size.name as SizeName
FROM   shirt
       INNER JOIN
            shirt_size ON shirt_size.shirtId = shirt.id
       INNER JOIN
             size ON size.id = shirt_size.sizeId 
```

*   [SQLFiddle 演示链接](http://sqlfiddle.com/#!2/f92a7/1)

# css - 如何让我的标题在移动设备上看起来更好

> ID：14080955
> 
> 赞同：1
> 
> 时间：2012-12-29T10:54:18.783
> 
> 标签：css, mobile, web

![在此处输入图像描述](../Images/d25990df9b3f3aab4d4472b1c2397bd4.png)

这是我的问题我怎样才能让我的标题看起来更好

以下是编码...！

1 索引.php

```
<div class="header">
<div class="headerFont"><a href="index.php">Yo! Yo! Honey Singh..!!</a>
</div>
<div class="Login">
<form>
Email :<input type="text">
Password :<input type="password">
<input type="submit" value="Login" >
<input type="button" value="register">
</form>
</div>
</div> 
```

2 网页样式.css

```
.header{
 top:0;
left:0;
padding:10px;
background:#00688B;
width:100%;
height:footer-<length>;
box-shadow:2px 2x 5px #08298A;
border:1px solid black;
text-shadow:2px 2px black;
}

.header a{
 color:white;
}

.headerFont{
font-family:MATURA MT  ;
font-size:22px;
display:table-cell;
}

.Login{
display:block;
position:absolute;
top:15px;
right:50px;
} 
```

3 移动风格.css

```
.header {
 width: auto;
} 
```

现在我需要知道如何获得像网站[PIC] -> [http://i.stack.imgur.com/vlx09.png](https://i.stack.imgur.com/vlx09.png)这样的 按钮我如何使按钮在移动设备上可见但在 PC borwsers 上不可见 ..？ ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:43:52.260

1.  在网站的移动版本上创建您想要的按钮。
2.  添加使按钮不可见的 CSS（例如，显示：无）。
3.  使用带有媒体查询的 CSS 在移动设备上显示按钮。

更多细节在这里：

[http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T11:05:14.633

you can do this using javascript and checking the requesting browser's type.

You can detect mobile broswer's request using javascript like following.

```
if ((screen.width < 480) || (screen.height < 480)) {
    location.replace('/mobile/');
   /*Get buggon element by id and show it else hide it*/
  } 
```

or may be you can use following javascript to detent mobile browser and then hide the button.

[https://github.com/miohtama/detectmobile.js](https://github.com/miohtama/detectmobile.js)

# c++ - 轮廓字体出现倒置 - glOrtho() 设置不正确

> ID：14080962
> 
> 赞同：1
> 
> 时间：2012-12-29T10:55:42.490
> 
> 标签：c++, opengl, fonts, coordinates

我正在 OpenGL 中创建一个应用程序，我`glOrtho()`在左上角使用 origin：

```
glOrtho(0.0, width, height, 0.0, 0.0, 1.0); 
```

直到我尝试渲染颠倒的轮廓字体，我才发现它是错误的。在搜索了有关它的信息后，我遇到了我读到我的起源应该从左下角开始的网站。

我知道 OpenGL 使用的是左下角原点，但我发现使用左上角原点更容易。我只需要水平翻转所有纹理，一切都很好。但是，是的，问题出现在那些颠倒的轮廓字体上。

现在要更改原点，我必须更改一堆代码，所以如果没有必要，我真的很想避免这种情况。

所以我的问题是：我的左上角原点的方法非常错误吗？如果没有，有没有办法让这些轮廓字体正确显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:00:59.243

您正在某处渲染该字体，对吗？*你*是如何渲染它的，是什么阻止你在那个时候应用垂直镜像变换​​矩阵？

即，如果您以老式的过时方式执行此操作：

```
glScalef( 1, -1, 1 );
glCallList(font); // Or whatever you are doing to render the outline font 
```

或者，如果您正在使用着色器，请让您的顶点着色器执行以下操作：

```
 Vec4 position = aPosition;
  position.y = -1 * position.y;
  gl_Position = aMVPMatrix * position 
```

当然，这一切都是伪代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:51:14.970

> 现在要更改原点，我必须更改一堆代码，所以如果没有必要，我真的很想避免这种情况。

您可以随时更改投影仪。为您的文本使用左下角的原点，为其他所有内容使用左上角的原点。但是，您必须调整被翻转的文本初始位置，但这并不是很难考虑。

或者，您可以简单地应用局部比例（1，-1,1）；将文本倒置（取决于您的文本库，这可能会干扰其内部转换设置）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T13:22:17.940

您通常可以通过使用适当的纹理矩阵来解决此问题，而无需更改数据。

# orchardcms - 为什么要呈现 Parts_Autoroute_Edit 模板以重新生成 url？

> ID：14080965
> 
> 赞同：0
> 
> 时间：2012-12-29T10:55:54.087
> 
> 标签：orchardcms

如果我写：

```
<Place Parts_Autoroute_Edit="-"/> 
```

然后在 AutoroutePartDriver 中编码

```
 // reset the alias if we need to force regeneration, and the user didn't provide a custom one
 if(settings.AutomaticAdjustmentOnEdit && previous == part.DisplayAlias) {
        part.DisplayAlias = string.Empty;
 } 
```

不执行，路径不重新生成。

可以解决吗？我不想显示“永久链接”和“设为主页”功能。

# php - 获取 zip 文件的内容并将其回显给用户

> ID：14080966
> 
> 赞同：0
> 
> 时间：2012-12-29T10:56:01.560
> 
> 标签：php

我想创建一个下载链接，我的所有文件都是 zip，但我不想让我的用户知道我的下载链接在哪里

所以我想获取 zip 文件的内容并将其与 zip 标头回显给用户可以下载它我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:06:17.800

您应该使用“download.php?get=”。base64_encode($filename) 当用户点击“下载 zip”时，你用 header("Location: download.php?get=".base64_encode($url) 将他重定向到那个页面。标题，我们开始

```
$filename = base64_decode($_GET[get]);
$filepath = "/var/www/domain/httpdocs/download/path/";

header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: public");
header("Content-Description: File Transfer");
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=\"".$filename."\"");
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($filepath.$filename));
ob_end_flush();
@readfile($filepath.$filename); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T12:04:05.077

您可以尝试下载一些“准备使用”的[php 类](http://sourceforge.net/projects/phpeasydownload/)，而不是尝试使用标头。然后你可以做类似的事情：

```
$fileDown = new PHPFileDownload(null, null, 'myFileName', null, 'mypath/myfile.txt');
$fileDown->exportData(); 
```

# c# - 在带有 ID 的表单之后，没有为此对象定义无参数构造函数

> ID：14080968
> 
> 赞同：-4
> 
> 时间：2012-12-29T10:56:43.367
> 
> 标签：c#, asp.net-mvc, razor

我正在做一个项目，但我不习惯 C#。我试图在我的旧工作代码之后工作。我找不到任何区别。

我的html表单：

```
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    @Html.HiddenFor(model => model.TicketID)
    <fieldset>
        <legend>Ticketdetail</legend>

          <div class="editor-label">
            @Html.LabelFor(model => model.Anmerkung)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Anmerkung)
            @Html.ValidationMessageFor(model => model.Anmerkung)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
} 
```

行动：

```
public ActionResult CreateDetail(int id)
{
    if (id == -1) return Index(-1);
    return View(new cTicketDetail(id, User.Identity.Name));
}

[HttpPost]
public ActionResult CreateDetail(cTicketDetail collection)
{

    //int TicketID = collection.TicketID;
    try
    {
        if (ModelState.IsValid)
        {
            collection.Write();
        }
        return RedirectToAction("Details", collection.TicketID);
    }
    catch
    {
        return this.CreateDetail(collection.TicketID);
    }
} 
```

[提交我的表单后的错误](https://docs.google.com/open?id=0B58uToSxhRvtSlZfdl8xX2V2RlU)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:59:09.477

看起来`cTicketDetail`您在`CreateDetail`操作中使用的类型没有无参数构造函数。控制器操作不能将此类类型作为参数，因为默认模型绑定器不知道如何实例化它们。

这里的最佳实践是定义一个视图模型，然后让您的控制器操作将此视图模型作为参数，而不是使用您的域实体。

如果您不想使用视图模型，则必须修改您的`cTicketDetail`类型，使其具有默认构造函数：

```
public class cTicketDetail
{
    // The default parameterless constructor is required if you want
    // to use this type as an action argument
    public cTicketDetail()
    {
    }

    public cTicketDetail(int id, string username)
    {
        this.Id = id;
        this.UserName = username;
    }

    public int Id { get; set; }
    public string UserName { get; set; }
} 
```

# python - 在 Python 中按引用与值比较列表

> ID：14080970
> 
> 赞同：6
> 
> 时间：2012-12-29T10:56:58.067
> 
> 标签：python, python-3.x

我目前正在学习 Python 3.2 版本。

给定两个列表变量，如何区分变量引用的是**同一个列表**还是两个具有**相同值**的单独列表。

例如：

```
>>> foo = [1,2,3,4]
>>> bar = foo
>>> foo.append(5)
>>> foo
[1, 2, 3, 4, 5]
>>> bar
[1, 2, 3, 4, 5]
>>> foo == bar
True 
```

在上面，“foo”和“bar”显然引用了同一个列表。（通过将“5”附加到 foo 并看到该更改也反映在 bar 中来证明）。

现在，让我们定义第三个列表，称为“其他”，具有相同的值：

```
>>> other = [1,2,3,4,5]
>>> other == foo
True 
```

考虑到这里的比较运算符也返回 True，它们肯定看起来像同一个列表。但是如果我们修改“其他”，我们可以看到它是一个不同的列表，其中一个变量的变化不会影响另一个。

```
>>> other.append(6)
>>> other == foo
False
>>> other
[1, 2, 3, 4, 5, 6]
>>> foo
[1, 2, 3, 4, 5] 
```

我认为了解两个变量何时是彼此的别名与结构相同是很有用的。但我怀疑我可能误解了该语言的其他基本内容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T10:58:09.727

您可以使用[`is`运算符](http://docs.python.org/3/reference/expressions.html#not-in)来确定对象身份：

```
>>> foo is bar
True
>>> foo is other
False 
```

引用文档：

> 对象身份的运算符`is`和测试：当且仅当和是同一个对象时为真。产生逆真值。`is not``x is y``x``y``x is not y`

检测两个变量是否引用同一个对象（例如列表）的另一种方法是检查[`id()`函数](http://docs.python.org/3/library/functions.html#id)的返回值：

```
>>> id(foo)
4432316608
>>> id(bar)
4432316608
>>> id(other)
4432420232 
```

# javascript - 小时到分钟 00:00 到 00 javascript

> ID：14080974
> 
> 赞同：2
> 
> 时间：2012-12-29T10:57:13.143
> 
> 标签：javascript

我需要在Javascript中将小时：分钟（00:00）转换为分钟00。

我考虑过使用 substr 分别获取小时和分钟，然后将小时部分乘以 60，然后添加分钟部分。

有没有其他简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T11:05:46.337

It's pretty easy with `split`:

```
var str = "04:17";
var parts = str.split(":");
var minutes = parseInt(parts[0], 10) * 60 + parseInt(parts[1], 10);
console.log(minutes); // 257 (four hours and seventeen minutes) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:01:12.880

To split in hour and minute, you can use the [split()](http://www.w3schools.com/jsref/jsref_split.asp) function on the String object:

```
"12:05".split(':');

--> ["12", "05"] 
```

Then you need to convert the Strings in the array to integers with [parseInt](http://www.w3schools.com/jsref/jsref_parseint.asp):

```
var hours = parseInt("12", 10);
var minutes = parseInt("05", 10); 
```

Then rest is simple calculation:

```
var total = hours * 60 + minutes; 
```

# objective-c - Objective-C - 将类属性与 json 字典数据对齐

> ID：14080976
> 
> 赞同：1
> 
> 时间：2012-12-29T10:57:23.903
> 
> 标签：objective-c, json, cocoa

我对 Objective-C 比较陌生（主要使用 cocoa/apple 基础框架），但我是一名长期的 C++ 程序员，所以我将首先解释我想要完成的工作；我的方法很可能不是最好的，所以我很想听听任何关于不同方法的建议。

我有一个 json 格式的文本文件，只是做了这个简单的例子：

```
"section1" : {
    "director" : "Sample Name 1",
    "writers" : {
        "name" : "Example Name 1",
        "name" : "Example Name 2",
    },
}, 
```

我有一个类的属性，我想与这个文件中的数据匹配，因为我打算解析这个文件并将一些值存储在这个类的一个实例中。我的类标题大致如下所示：

```
@interface SongData : NSObject
@property (nonatomic, copy) NSString *director;
@property (nonatomic, copy) NSArray *writers;
@end 
```

所以我试图找到最干净、有点“数据驱动”的方式来将此 json 数据存储到正确的属性中。基本上我想要一种方法来循环遍历数据的 json“字典”，并以某种方式使用“键”与我的类中的正确属性匹配并将值分配给该属性。我第一次破解它，我创建了一个字典，其中“键”是在 json 数据中查找正确数据的实际键，“值”是指向正确类属性的指针。有点像这样：

```
NSDictionary *descriptionDictionary = [[NSDictionary alloc] initWithObjectsAndKeys:
                                       director, @"name",
                                       writers, @"writers",
                                       nil]; 
```

然后想法是遍历json数据（存储在另一个NSDictionary中），使用我的“descriptionDictionary”中的每个键在json数据中查找适当的值，然后使用匹配的描述字典的“值”基于相同的键（我希望它是指向实际类属性的指针？）并将该属性值设置为 json 数据中的值。也许一个例子会让它更清楚:-)。让我们假设“jsonDictionary”是解析我的 json 数据的结果，并且我已经在 section1 中，因此构成 jsonData NSDictionary 的键和构成我的 descriptionDictionary NSDictionary 的键之间应该存在 1-1 匹配：

```
[descriptionDictionary enumerateKeysAndObjectsUsingBlock:^(id key, id value, BOOL *stop) {
    value = [jsonDictionary objectForKey:propertyName];
}]; 
```

现在“值”在技术上将指向我的类属性之一，我想为它分配相关的 json 数据（即 director = @“Sample Name 1”）。我知道我正在做的事情有问题（我意识到我可能不能只是取消引用指向随机类属性的指针并为其分配一个未知类型的任意对象，希望它们都匹配:-) 但希望我的示例至少说明了我正在尝试做的事情，以便有人可以告诉我更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T11:19:04.860

看看 KVC（来源：http: [//developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/BasicPrinciples.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/BasicPrinciples.html)）

> 使用键值编码设置属性值
> 
> 方法 setValue:forKey: 将相对于接收者的指定键的值设置为提供的值。setValue:forKey: 的默认实现自动解包表示标量和结构的 NSValue 对象，并将它们分配给属性。有关包装和展开语义的详细信息，请参阅“标量和结构支持”。
> 
> 如果指定的键不存在，则向接收者发送一个 setValue:forUndefinedKey: 消息。setValue:forUndefinedKey: 的默认实现会引发 NSUndefinedKeyException；但是，子类可以覆盖此方法以自定义方式处理请求。
> 
> setValue:forKeyPath: 方法的行为方式类似，但它能够处理键路径以及单个键。
> 
> 最后，setValuesForKeysWithDictionary：用指定字典中的值设置接收者的属性，使用字典键标识属性。默认实现为每个键值对调用 setValue:forKey:，根据需要用 nil 替换 NSNull 对象。
> 
> 您应该考虑的另一个问题是当尝试将非对象属性设置为 nil 值时会发生什么。在这种情况下，接收者向自己发送一个 setNilValueForKey: 消息。setNilValueForKey 的默认实现：引发 NSInvalidArgumentException。您的应用程序可以覆盖此方法以替换默认值或标记值，然后使用新值调用 setValue:forKey:。

只要您的类属性与 JSON 字段具有相同的名称，您就可以使用`setValuesForKeysWithDictionary:`并传入 JSON 根字典。

对于名称不同的键/属性，您可以简单地覆盖`setValue:forUndefinedKey:`并自己设置适当的属性。

最后，还有一个值在 JSON 中由与属性中不同的类型表示的情况。例如 NSURL 将是一个 NSString 代替。在这里您可以简单地检查传递参数的类，如果它与 IVAR 不匹配，则进行转换。

# javascript - 使用 XRegExp 在 JavaScript (Node.js) 中验证 UTF-8 名称

> ID：14080977
> 
> 赞同：1
> 
> 时间：2012-12-29T10:57:31.297
> 
> 标签：javascript, node.js, xregexp

我正在尝试检查给定的 UTF-8 字符串是否仅包含字母。
我尝试了在这里找到的解决方案：[Validating user's UTF-8 name in Javascript](https://stackoverflow.com/questions/6381752/validating-users-utf-8-name-in-javascript)

给定字符串：`Ciesiołkiewicz`
用`var XRegExp = require('xregexp').XRegExp('^\\p{L}+$');`

它不起作用，因为
我尝试了“ł”字母，`XRegExp('^[\\p{Latin}\\p{Common}]+$');`
但它太多了，它接受波兰字母但也接受像“$”等字符

如何仅针对字母进行验证？我不想手动将它们输入正则表达式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:25:11.603

```
var XRegExp = require('xregexp').XRegExp;
var re = new XRegExp('^\\p{L}+$');

console.log(re.test('Ciesiołkiewicz'));
console.log(re.test('1Ciesiołkiewicz2'));
console.log(re.test('привет'));
console.log(re.test('пр1вет'));

> true
> false
> true
> false 
```

完美运行。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-29T11:01:17.650

how about a character range like [a-Z]? thats what i usually use if im looking only for letters

# c - Visual Studio C/C++ 数组大小未处理的异常堆栈溢出

> ID：14080982
> 
> 赞同：6
> 
> 时间：2012-12-29T10:58:36.227
> 
> 标签：c, visual-studio-2010

> **可能重复：**
> [什么是堆栈溢出错误？](https://stackoverflow.com/questions/214741/what-is-a-stack-overflow-error)

它只是在我声明大小为 4096*1024 的大型数组时发生

```
First-chance exception at 0x01382e97 in nsfclient.exe: 0xC00000FD: Stack overflow.
Unhandled exception at 0x01382e97 in nsfclient.exe: 0xC00000FD: Stack overflow. 
```

我应该怎么做才能在 Visual Studio 中声明大数组？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T11:02:24.877

您应该显式增加堆栈大小，以便能够在堆栈上存储更大的数组。据我记得这是使用`/F`选项完成的。

另一种选择是使用动态数组（使用`malloc`or分配`new`）。

编辑（感谢 Jefrrey Theobald）：您还必须增加链接器中的堆栈大小，这是使用`/stack`选项完成的。也可以通过右键单击项目->属性->链接器->系统和`setting stack commit`和来设置此选项`stack reserve size`。 [![在此处输入图像描述](../Images/78b2cbafe0ccf8630d4349f3de71225c.png)](https://i.stack.imgur.com/tD8dw.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T11:02:09.490

您没有显示任何代码，但我认为您正在堆栈上声明您的数组。尝试在堆上声明它（使用`malloc`）。确保`free`稍后再做。

```
char* bigArray = malloc(LARGE_SIZE);
/* use bigArray */
free(bigArray); 
```

# mysql - 匹配多个单词 AND OR

> ID：14080984
> 
> 赞同：0
> 
> 时间：2012-12-29T10:58:44.323
> 
> 标签：mysql, full-text-search, match, against

我在一个项目中使用全文搜索。我想搜索多个单词，但我遇到了问题。所以我的查询是；

```
SELECT MAX(id)
FROM table
WHERE MATCH (col1,col2) AGAINST ('+(word1) +(word2) +(word3 word4)')
GROUP BY col1
ORDER BY 1 desc limit 12 
```

这个查询是搜索包括 word1 OR word2 OR **word3 OR word4** 但我想搜索包括 word1 OR word2 OR **word3 word4**

那么解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:05:21.393

You can try something like this one...

```
SELECT MAX(id) FROM table WHERE MATCH(colname1,colname2) AGAINST("keyword to search")  GROUP BY colname ORDER BY colname desc limit 12 
```

[Reference](https://kb.askmonty.org/en/match-against/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-07-05T09:18:18.113

```
SELECT * FROM `user_profiles` 
WHERE MATCH (`first_name`,`last_name`) 
      AGAINST ('(+bruce+wayne)(+clark+kent)' IN BOOLEAN MODE) 
```

# java - 以 mdb 或 accdb 数据库格式将 SQLite 数据库从 android 手机导出到我的系统

> ID：14080985
> 
> 赞同：0
> 
> 时间：2012-12-29T10:58:48.917
> 
> 标签：java, android

我想导出由简单的 android 代码创建的 SQLite 数据库文件。我想在 microsoft access（.mdb 或 .accdb）中使用该数据库。可能吗？如果可能，请告诉我步骤

**注意**：这里，我没有放任何代码..我只是想知道将sqlite数据库文件导出为mdb或accdb格式文件的步骤..

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T11:08:54.430

从安卓设备获取数据库

1）只是去`android-sdk-folder/platform-tools`

2) 输入`adb shell`并按回车

3)`run-as com.yourapp cat /data/data/com.yourapp/databases/FILENAME > /sdcard/FILENAME.db`

＆这个 FILENAME.db 你将在`mnt/sdcard/FILENAME.db` Location 中获得。

导出到 SDCard 后，请点击[此链接](https://stackoverflow.com/questions/7657115/how-to-convert-mdb-to-sqlite-in-android)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T11:07:30.467

您可以从设备下载数据库。

这就是诀窍：（Linux/MacOSX）

```
./PATH_TO_ANDROID_SDK/platform-tools/adb -d shell 'run-as PACKAGE /data/data/package/databases/DATABASE_NAME > /sdcard/DATABASE_NAME 
```

然后你从 /sdcard/ 下载到计算机整个数据库。（您有权在 sdcard 目录中写入/读取权限）

bash 中的脚本：

```
#!/bin/bash

PATHTOSDK="/some_path/"
PACKAGE="com.my.app"
DATABASENAME="mydb.db"
COMMAND=$(${PATHTOSDK}adb -d shell "run-as $PACKAGE cat /data/data/$PACKAGE/databases/$DATABASENAME > /sdcard/$DATABASENAME") 
```

在此步骤的结果中，您拥有 SQLite DB。另一个问题是如何将 SQLite DB 移植到 MS Access DB？一些提示：[https ://superuser.com/questions/264510/open-sqlite-db-in-microsoft-access](https://superuser.com/questions/264510/open-sqlite-db-in-microsoft-access)

# php - 从每个 tr 中的第一个 td 检索数据

> ID：14080986
> 
> 赞同：1
> 
> 时间：2012-12-29T10:58:52.500
> 
> 标签：php, screen-scraping, simple-html-dom

我正在抓取一个页面，其中包含一个包含多个 tr 的表格。每个 tr 里面有四个 td，我想从这些 td 中的第一个获取数据。下面是我到目前为止尝试过的代码，但它抓住了所有的 td。我怎样才能完成我想要的？

```
...
$html = new simple_html_dom();
$html = file_get_html($url);

foreach($html->find('table tr') as $row) {
    foreach($row->find('td', 0) as $cell) {
        echo $cell;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:06:14.753

想想你为什么要使用第二个`foreach`，而实际上你只是想对每个元素中的一个元素采取行动`row`。

```
$html = new simple_html_dom();
$html = file_get_html($url);

foreach($html->find('table tr') as $row) {
    $cell = $row->find('td', 0);
    echo $cell;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T12:39:18.673

简单的 html dom 是个垃圾。使用内置的 dom 函数和 xpath 更简单：

```
$dom = new DOMDocument();
@$dom->loadHTMLFile($url);
$xpath = new DOMXPath($dom);

foreach($xpath->query('//td[1]') as $td){
  echo $td->nodeValue;
} 
```

也就是说，[我可能仍然更喜欢使用 phpquery](http://scraperblog.blogspot.com/2012/11/choosing-php-html-parser.html)

# android - SlidingDrawer 打开时重新排列主布局

> ID：14080990
> 
> 赞同：0
> 
> 时间：2012-12-29T10:59:42.787
> 
> 标签：android, animation, layout, slidingdrawer

我的应用程序中有一个小动画，最后它改变了 ListView 的位置参数，即它比它开始时低一点（它以全屏开始，按下按钮后，它向下滑动一点到在屏幕顶部显示其下方的某些内容）。通过按下列表，我可以看到它的参数确实发生了变化，它的位置也确实发生了变化。现在，如果此时 SlidingDrawer 正在打开，则布局将重新排列，列表将返回全屏。这是为什么？

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:app="http://schemas.android.com/apk/res/com.softtechnics.mobuynet"
android:id="@+id/coupon_list_layout"
style="@style/FillParent"
android:orientation="vertical" >

<include
    android:id="@+id/filter_tab"
    android:layout_width="match_parent"
    android:layout_height="34dp"
    android:layout_below="@+id/action_bar"
    layout="@layout/filter" />

<com.softtechnics.mobuynet.gui.components.ListArr
    android:id="@+id/list"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_above="@id/footer"
    android:layout_below="@+id/action_bar">

</com.softtechnics.mobuynet.gui.components.ListArr>

<com.softtechnics.mobuynet.gui.components.ActionBar
    android:id="@+id/action_bar"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true" />

<ProgressBar
    android:id="@+id/progress"
    style="@style/WrapContent"
    android:layout_centerInParent="true"
    android:visibility="gone" />

<com.softtechnics.mobuynet.gui.components.Footer
    android:id="@+id/drawer"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignTop="@+id/textView1" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="113dp"
    android:layout_alignParentBottom="true"
    android:visibility="invisible" /> 
```

`Footer`是我的滑动抽屉。谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-29T11:27:30.400

您必须在动画结束时更改列表视图属性。此外，您应该记住此视图的实际状态并在 onResume 方法中对其进行更新。

# windows-7 - 在 Windows 7 上启动时，会打开一个标题为 communicator.exe 的框，并显示：应用程序无法正确启动 (0xc0150002)

> ID：14080997
> 
> 赞同：-1
> 
> 时间：2012-12-29T11:01:22.123
> 
> 标签：windows-7, startup, office-communicator

每次我打开笔记本电脑时它都会打开。有谁知道它是什么以及如何阻止它在启动时出现？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:07:02.700

尝试使用“msconfig”命令查找 communicator.exe，然后取消选中它。

# java - Java bitSet starts setting bits from right to left or left to right?

> ID：14080998
> 
> 赞同：2
> 
> 时间：2012-12-29T11:01:28.600
> 
> 标签：java

if I set two different bits in a Bitset

```
 BitSet x= new BitSet(8);
  x.set(0);//.........Case1

  x.set(7);//.........Case2 
```

In which case I m setting the most significant bit?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T11:15:42.210

一个位集合并不是一个巨大的数字。它是一组（技术上是向量/列表/无限数组）位。甚至没有`BitSet`将其转换为数字的方法。

关于内部表示 - 这取决于实现。虽然实现可以选择将位 0 ​​存储为其内部数组中第一个整数的最低有效位，但这并不是一成不变的。我*认为*Sun 实现会这样做（除了它使用一个 long 数组，而不是 int 数组）。

然而，在 bitSet 和整数之间存在一个自然的双射。一个位集从 0 向上插入，并且任何非负整数都可以以自然的方式唯一地表示为一个位集，作为二进制数，最低有效位存储为位 0。*在这种双射下*，位 7 更重要比位 0，但对于位集中的每一位，下一位更重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-18T11:20:03.893

**LSB 是索引 0。**

*示例：* 让我们创建字符`'a'`（二进制`0110 0001`）。

*请注意*：从左到右添加位，意味着从索引 7 向下运行到 0。

```
BitSet bitSet = new BitSet(8);

bitSet.set(7, false);
bitSet.set(6, true);
bitSet.set(5, true);
bitSet.set(4, false);

bitSet.set(3, false);
bitSet.set(2, false);
bitSet.set(1, false);
bitSet.set(0, true);

// let's convert it to a byte[]
byte[] array = bitSet.toByteArray();

// and let's convert that byte[] to text now.
String someText = new String(array, Charsets.US_ASCII);

// this will print an 'a'
System.out.println(someText); 
```

与（JDK7+）相同：

```
System.out.println((char)0b01100001); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T11:08:49.690

虽然最重要的位对于 BitSet 来说纯粹是主观的，但是设置两端你可以说其中一个可能是最重要的，但你可以说它是哪一个。;)

如果你想设置一个字节的最高（和最低）有效位，你可以做

```
byte b = (byte) ((1 << 7) | (1 << 0)); 
```

或者

```
byte b = 0;
b |= 1 << 0;
b |= 1 << 7; 
```