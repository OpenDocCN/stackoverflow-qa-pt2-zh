# StackOverflow 问答 12573000-12573999

# mysql - 带有通配符匹配的 IN Clause 中的 MYSQL 元组

> ID：12573002
> 
> 赞同：0
> 
> 时间：2012-09-24T21:12:24.703
> 
> 标签：mysql, sql, database

我有以下问题。假设我有一张包含汽车库存的表格：

```
VIN, MAKE, MODEL, PRICE 
```

而且我有另一个包含各种汽车类别的表（例如，紧凑型、中型、suv 等）

```
MAKE, MODEL, CLASS
JEEP, NULL , SUV
FORD, EXPLORER, SUV
TOYOTA, YARIS, COMPACT
NULL, CUBE, COMPACT
... 
```

我想知道如何选择某个类别的数据库中的所有汽车？也许，我想知道每个级别有多少辆车？

我可以写一个这样的查询。

```
SELECT COUNT(*) FROM CARS WHERE (MAKE, MODEL) IN (SELECT MAKE, MODEL FROM CLASSES WHERE CLASS = 'SUV') 
```

这里的问题是，我实际上无法处理数据中的 NULL。我想说JEEP的所有车型都是SUV，或者任何称为CUBE的MAKE汽车都是紧凑型汽车。

假设没有冲突，可以这样做吗？我可以通过执行以下操作设置优先级，例如所有门廊都是汽车，除了 Cayenne 是 SUV 之外：

```
MAKE, MODEL, CLASS
PORCHE, NULL , CAR
PORCHE, CAYENNE, SUV 
```

如果 MySQL 无法做到这一点，那么是否有更好的数据库技术可以胜任这一点。让我们假设 CLASSES 表将包含 50K+ 行，而 CARS 表将包含 5M+ 行。我正在寻找一种在数据库中执行此类查询的快速方法，并且不需要在脚本中获取数百万行来处理？另外，如果它不仅是品牌和型号，还有子型号、引擎等。

此外，我对数据进行了相当多的简化，有 4 个层次结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:40:53.610

您可以这样编写查询：

```
SELECT COUNT(*)
FROM CARS c join
     classes cl
     on (c.make = cl.make or cl.make is null) and
        (c.model = cl.model or cl.model is null) and
        cl.class = 'SUV' 
```

问题是你可能会得到重复。所以更好的计数开始于：

```
select count(distinct c.vin)
. . . 
```

这应该适用于您提供的两种情况，即 JEEP 和 CUBE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:50:58.750

假设品牌和型号不能同时`null`用于给定的类。您可以`ifnull()`在 MySQL 中使用该函数：

```
select cl.class, count(*)
from cars c inner join class cl
   on c.make = ifnull(cl.make,c.make)
   and c.model=ifnull(cl.model,c.model)
group by cl.class 
```

您可能希望在列上添加索引`makes`并`model`加快访问速度。由于`classes`使用内部连接（如上）的行数较少，将限制返回的行数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T21:58:50.023

SELECT s.class, COUNT(*) FROM car c, car_class s WHERE c.make = s.make AND c.model = s.model GROUP BY s.class

应该给你类似的东西

SUV 14 紧凑型 32 卡车 11 等

# java - 生成实现 JSR 308“instanceof @MyAnotations”运行时检查的代码

> ID：12573003
> 
> 赞同：4
> 
> 时间：2012-09-24T21:12:31.040
> 
> 标签：java, annotations, code-generation, bytecode-manipulation, annotation-processing

[JSR 308](http://jcp.org/en/jsr/detail?id=308)建议向 Java 添加类型注释。批准后，程序员将能够在当前允许 Java 类型的任何地方添加注释。这不仅包括方法/字段/本地/参数装饰，还包括构造函数调用、类型转换和最奇怪的 instanceof 检查。[Checker 框架](https://checkerframework.org/)使用JSR 308 来实现类型限定符`@NonNull`，例如对象类型或`@Regex`字符串。

现在，Checkers 所做的就是静态分析您的代码。这就是所有编译时检查。没关系。但我想要的是一种可以在运行时进行检查的机制。您可以声明：

```
@Regex String p1 = "[a-z]+";
@Regex String p1 = "[a-z)+";    // compile time error from annotation processor 
```

我也可以写：

```
if (x instanceof @Regex String) ... 
```

但这与 没有区别`x instanceof String`，不执行运行时检查。我需要一个编译时注释处理器*或*运行时字节码操纵器，它可以让我在`instanceof`检查时运行任意代码并返回一个布尔值。Java可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T07:39:54.957

是的你可以。但它不是微不足道的，并且不受注释处理器可访问 API 的支持。可访问的注释处理器 API 仅限于生成新类，并且不允许修改现有字节码（即使在 JDK 8 中）。您可以在注释处理器级别强制转换为编译器特定的类，从而启用更多选项。但是您必须使用编译器内部 API 并为每个可用的编译器（JDT 和 JavaC）重写它。您可以查看 Lombok 项目（[http://projectlombok.org/](http://projectlombok.org/)），它做了非常相似的事情。遗憾的是，Lombok 还不兼容 JDK8 的新类型注释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-30T08:03:36.433

对于您的正则表达式示例，解决方案非常简单。我还提供了一些关于解决方案不那么简单的案例的信息。

如何实现运行时测试取决于类型系统是计算数据本身的属性，还是计算出处（数据源）的属性。[以下是Checker Framework 手册的“](https://checkerframework.org/manual/)[运行时测试和类型改进](https://checkerframework.org/manual/#type-refinement-runtime-tests)”部分的文本：

> 某些类型系统支持运行时测试，Checker 框架可以使用该测试来细化条件范围内的类型，例如 if、assert 语句之后等。
> 
> 类型系统是否支持这样的运行时测试取决于类型系统是计算数据本身的属性，还是计算出处（数据源）的属性。一个关于数据的属性的例子是一个字符串是否是一个正则表达式。有关出处的属性的一个示例是计量单位：无法查看数字的表示并确定它是打算表示公里还是英里。

1) 对于**data**的属性，您最简单的选择是避免使用 instanceof 测试，而是使用 Checker Framework 附带的[测试](https://checkerframework.org/manual/#regexutil-methods)，例如[`isRegex`](https://checkerframework.org/api/org/checkerframework/checker/regex/RegexUtil.html#isRegex-java.lang.String-).

例如，而不是

```
 if (x instanceof @Regex String) ... 
```

写

```
 if (RegexUtil.isRegex(x)) ... 
```

你就完成了。

如果您真的想使用`instanceof`而不是`isRegex`，那么您将需要破解编译器以将每个源代码出现`x instanceof @Regex String`转换为`RegexUtil.isRegex(x)`. 你也可以通过字节码重写来做到这一点。

2) 对于有关**出处**的属性，实施工作量要大得多。您必须在程序（包括对象和原语）中的每个数据的表示中添加一个出处位并更改每个操作（在您自己的程序和库中），以便除了对数据进行操作之外，它还可以适当地维护出处位。[DynComp](http://plse.cs.washington.edu/daikon/download/doc/daikon.html#DynComp-for-Java)已经可以做到这一点，您可以在此基础上进行构建，它是作为[Daikon 不变检测器](http://plse.cs.washington.edu/daikon/)的一部分分发的。

# php - 使用 PHP 向数组添加数据

> ID：12573005
> 
> 赞同：0
> 
> 时间：2012-09-24T21:12:31.990
> 
> 标签：php

如果我在这样的数组中有大量数据，

1 => A 2 => B .... 等等

如何使用 PHP 将一组数据添加到数组的末尾？例如，如果有 26 个元素

26 => Z

如何使用 PHP 在数组末尾添加 27 =>AA？我们可以使用count来获取元素的个数，但是因为数据量大，不能使用arrary_push最后添加新数据。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:14:22.940

非常简单：

```
$myArray = array('A','B', 'C');

$myArray[] = 'D'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:22:26.030

利用 PHP 的 Perl 风格的字符增量器

```
$data = range('A','Z');
$last = end($data);
$last++;
$data[] = $last;

var_dump($data); 
```

# backbone.js - Backbone.js — url :id 没有被传递到 where 循环

> ID：12573013
> 
> 赞同：0
> 
> 时间：2012-09-24T21:12:46.513
> 
> 标签：backbone.js, coffeescript

我的路由器中有这段代码：

```
category: (id) ->
    alert id
    filteredProducts = new App.Collections.Products(@productsCollection.where({category_id: id}))
    @productsView.renderResults(filteredProducts) 
```

该`alert id`调用正常工作（例如 app.com/categories/6 > alerts "6"），当我`id`将`where`函数中的 更改为实际数字时，产品集合过滤器正确如下：

```
filteredProducts = new App.Collections.Products(@productsCollection.where({designer_id: 6})) 
```

但是当我设置`designer_id: id`where 循环时返回一个空集合。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T17:13:35.010

我的外键 category_id 是一个数字而不是一个字符串。答案是：

```
filteredProducts = new App.Collections.Products(@productsCollection.where({category_id: parseInt(id)})) 
```

# ssh - ssh 到 qemu 虚拟机来宾，无需输入密码

> ID：12573015
> 
> 赞同：2
> 
> 时间：2012-09-24T21:12:54.683
> 
> 标签：ssh, passwords, qemu

现在我想从客户端机器上运行一个脚本，该脚本将 ssh 到主机上的虚拟机来宾并开始运行 shell 命令。我不想被提示输入密码。

所以首先我尝试这样做以连接到主机。我将 .ssh 文件夹中的文件 id_rsa.pub 从客户端复制到主机的 .ssh 文件夹中名为 authorized_keys 的文件中。然后当我“ssh root@hostname”它工作正常，我不需要输入密码（注意我客户的帐户不是root）。

然后我对主机中的虚拟机来宾尝试同样的事情。我将相同的文件复制给客人。我使用带有选项“-net user,vlan=0,hostfwd=tcp::5555-:22”的 qemu 启动来宾，这会将请求转发到主机 5555 端口到来宾的 22 端口。然后在客户端，我执行“ ssh -p 5555 root@hostname ”失败了。它显示主机的 RSA 密钥已更改或其他...请注意，我的客人的帐户也是 root，我可以使用 Putty 通过连接到主机的 5555 端口来 ssh 到客人。而且我相信文件权限也得到了妥善处理。

有没有人有线索：>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:07:44.097

是的，这是正确的行为。

当您第一次连接到主机系统时，客户端机器上的 ssh 会询问您是否真的是您想要连接的带有指纹 bla-bla-bla 的机器。你回答“是”，你的客户端机器上的 ssh 记住了文件 ~/.ssh/known_hosts 中的主机名、IP 和指纹。然后在所有后续连接期间，它会验证指纹是否未更改，因为更改表明身份验证过程需要您注意。不匹配可能有几个正当的原因：

*   您在远程主机上重新安装了 sshd；
*   您的主机使用 DHCP 获取其 IP 并且 IP 已更改。

当您确切地知道指纹不应该改变时，这表明您试图让您进入另一个系统。

此机制旨在确保您已登录到您希望登录的系统。

在您的情况下，您首先在端口 22 的 IP abcd 登录系统。然后您尝试在端口 5555 使用相同的 IP abcd 登录。此端口后面的虚拟机具有不同的指纹。所以 ssh 抱怨。

您的问题的解决方案是登录到主机系统，然后从这个远程 shell 会话进入 VM。另外，我建议您为此“远程”连接生成另一对公钥/私钥。因此，当您保存在主机上的私钥被泄露时，您保存在工作站上的私钥仍然有效。

# jquery - CakePHP 2.1 中 ajax 调用的空响应

> ID：12573016
> 
> 赞同：0
> 
> 时间：2012-09-24T21:13:00.650
> 
> 标签：jquery, ajax, json, cakephp, cakephp-2.1

在 CakePHP 2.1 上，我有一个 ajax 请求，它得到一个空响应（用 firebug 检查）并且还触发了错误回调。

从我的 .js 中，我从 cake -same server- 外部调用一个 php，以提供我需要的一些数据库记录：

```
function updateDiv() {
    $.ajax({                                      
        url: 'http://myserver/phpGenesi/api.php',
        data: "",
        dataType: 'json',
        success: function(data)
        {   
            alert(data);
        },
        error: function(data)
        {   
            alert('error')
        } 
    });        
} 
```

这是服务器上的 PHP 代码（它运行良好，不是 CakePHP，只是 PHP db 数据）：

```
$result = mysql_query("SELECT * FROM $tableName where project_id = 101"); 
$array = mysql_fetch_row($result);      

if (mysql_num_rows($result) > 0)  
{  
$responses = array();
while($row = mysql_fetch_assoc($result)) {
    $responses[] = array(  
        'id' => $row['id'],  
        'name' => $row['name'],  
        'dir_description' => $row['dir_description'],
        'project_id' => $row['project_id'],
        'dir_notes' => $row['dir_notes'],
        'dir_dataname' => $row['dir_dataname']
    );  
}
echo '{"dirs": ' . json_encode($responses) . '}';
} 
```

当我从蛋糕外部访问相同的 php 时，我得到的结果很好，例如：

```
http://myserver/phpGenesi/api.php 
```

返回我需要的东西：

```
{"dirs": [{"id":"240","name":"c","dir_description":"Carlos Test c","project_id":"101","dir_notes":"c","dir_dataname":"c"},{"id":"241","name":"d","dir_description":"Carlos Test d","project_id":"101","dir_notes":"d","dir_dataname":"d"}]} 
```

如果从任何客户端文档调用也可以使用。

问题是当我从我的蛋糕文件中调用它时。Firebug 显示空响应并触发了我的 ajax 错误函数。

知道它缺少什么吗？我怎么知道发生了什么错误触发了我的错误功能？

# java - 将 StringBuilder 写入 Writer，无需 toString()

> ID：12573023
> 
> 赞同：6
> 
> 时间：2012-09-24T21:13:53.693
> 
> 标签：java, servlets, stringbuilder, printwriter

在 Servlet 中，我在 StringBuilder 中构建大量 HTML 内容，最后需要将其写入响应的 PrintWriter。为了使用 PrintWriter，它必须首先调用 StringBuilder 的 toString() 方法来获取 String 形式的内容。但这不必要地复制了内容。有什么方法可以直接从 StringBuilder 写入，因为它已经保存了内容？

PrintWriter 可以接受 CharSequence，但文档说明它调用 CharSequence 的 toString()，所以它并没有真正的帮助。

我能看到的唯一明确的方法是使用 StringBuilder 的 charAt(i) 方法一次获取和写入一个字符，但这会是一种改进吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T21:20:10.400

作为替代方案，您可以删除 StringBuilder 并使用[StringWriter](http://docs.oracle.com/javase/6/docs/api/java/io/StringWriter.html)和[PrintWriter](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:20:13.253

您可以首先写入 PrintWriter 而不是 StringBuilder ...

使用`charAt`绝对不会帮助你。这样做会产生非常糟糕的性能。如果您*真的*想朝那个方向前进，您*可以*使用该`StringBuilder.subString(start,end)`方法。此方法将允许您一次读取例如 1000 个字符并将其打印到 PrintWriter...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T13:08:59.133

该类`StringBuilder`将字符串存储在内部 char 数组中。问题是这个 char 数组不可访问。

建议的解决方案：

1）您可以创建一个新类扩展`ObjectOutputStream`，您可以在其中覆盖该`writeObjectOverride(Object obj)`方法。然后简单地序列化`StringBuilder`您构建 HTML 文档的实例。`writeObjectOverride(Object obj)`将使用作为序列化过程的一部分的内部 char 数组调用您覆盖的方法`Stringbuilder`，瞧：您拥有对 String 构建器的内部 char 数组的引用，您可以将其写入 Servlet 的 PrintWriter 输出。 .*注意：*您的`writeObjectOverride()`方法将被多次调用，显然您可以忽略那些传递给您所需字符数组以外的东西的方法。

2）您可以使用`CharBuffer`类而不是`StringBuilder`具有`array()`返回内部数组的方法。`CharBuffer`没有与 一样多的附加（或放置）操作`StringBuilder`，因此需要稍微扩展这些操作（取决于您确切需要什么）...

3）您可以编写自己的实现`StringBuilder`，或者更确切地说，您可以从中使用什么。这样您就可以访问存储组合文本的对象（例如 char 数组）...

# android - Netbeans 和 Android 上的 LibGDX

> ID：12573031
> 
> 赞同：1
> 
> 时间：2012-09-24T21:14:53.847
> 
> 标签：android, netbeans, libgdx

我正在尝试使用 NetBeans IDE 在 Andriod 上运行使用 LibGDX 的应用程序。但是游戏由于某种原因崩溃了，当我尝试运行该应用程序时，我刚刚收到“此应用程序已停止工作”的消息。一切都在 PC 上运行良好，所以显然我在安卓设置中错过了一些东西。在 NetBeans 上设置一个 andriod 项目不是一个文档化的领域，而且在 Eclipse 上似乎有所不同。

如果有人通过在 Netbeans 中设置项目设法在 Andriod 上运行 LibGDX，请分享您所做的步骤。

一些代码，我怀疑这将有助于：

```
public class Game extends AndroidApplication {
    public void onCreate (android.os.Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            initialize((ApplicationListener) new game.GameSystem(new Size2i(100, 100)), false);
    }
} 
```

我得到的调试输出如下：

```
D/dalvikvm(  478): Trying to load lib /data/data/com.RPGGame/lib/libgdx.so 0x40515708
D/dalvikvm(  478): Added shared lib /data/data/com.RPGGame/lib/libgdx.so 0x40515708
D/dalvikvm(  478): No JNI_OnLoad found in /data/data/com.RPGGame/lib/libgdx.so 0x40515708, skipping init
D/AndroidRuntime(  478): Shutting down VM
W/dalvikvm(  478): threadid=1: thread exiting with uncaught exception (group=0x40015560)
E/AndroidRuntime(  478): FATAL EXCEPTION: main
E/AndroidRuntime(  478): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.RPGGame/com.RPGGame.MainActivity}: java.lang.ClassCastException: game.GameSystem
E/AndroidRuntime(  478):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
E/AndroidRuntime(  478):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
E/AndroidRuntime(  478):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
E/AndroidRuntime(  478):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
E/AndroidRuntime(  478):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(  478):    at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime(  478):    at android.app.ActivityThread.main(ActivityThread.java:3683)
E/AndroidRuntime(  478):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(  478):    at java.lang.reflect.Method.invoke(Method.java:507)
E/AndroidRuntime(  478):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
E/AndroidRuntime(  478):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
E/AndroidRuntime(  478):    at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(  478): Caused by: java.lang.ClassCastException: game.GameSystem
E/AndroidRuntime(  478):    at com.RPGGame.MainActivity.onCreate(MainActivity.java:11)
E/AndroidRuntime(  478):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
E/AndroidRuntime(  478):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
E/AndroidRuntime(  478):    ... 11 more
W/ActivityManager(  104):   Force finishing activity com.RPGGame/.MainActivity
W/ActivityManager(  104): Activity pause timeout for HistoryRecord{40512238 com.RPGGame/.MainActivity}
D/dalvikvm(  408): GC_EXPLICIT freed 8K, 54% free 2537K/5511K, external 1625K/2137K, paused 102ms
W/ActivityManager(  104): Activity destroy timeout for HistoryRecord{40512238 com.RPGGame/.MainActivity}
D/dalvikvm(  420): GC_EXPLICIT freed 324K, 55% free 2532K/5511K, external 1625K/2137K, paused 183ms
D/dalvikvm(  322): GC_EXPLICIT freed 9K, 55% free 2589K/5703K, external 1625K/2137K, paused 72ms 
```

所以基本上我不能将 game.GameSystem 转换为 ApplicationListener。即使 GameSystem 实现了 ApplicationListener。

GameSystem 在 PC 上按预期工作，我为 Andriod 项目所做的只是将该代码放在主文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:51:20.193

好的，我现在解决了，原来我使用了错误版本的game.GameSystem。

# filesystems - 来自 inode 的文件的最大大小

> ID：12573035
> 
> 赞同：3
> 
> 时间：2012-09-24T21:15:12.430
> 
> 标签：filesystems, inode

有人可以向我解释这个问题的答案。我在测验中得到了这个，无法回答。

假使，假设

*   磁盘中的所有块大小为 4KB（4096 字节）。
*   inode 的顶层存储在大小为 4KB 的磁盘块中。
*   除数据块位置外，所有文件属性一共占用 128 个字节（在上述 4KB 之外）。
*   每个直接块地址占用 8 个字节的空间，并给出大小为 4KB 的磁盘块的地址。
*   inode 第一级的最后三个条目分别指向单、双和三间接块。

问题：通过 inode 的直接块条目可以访问的文件的最大大小是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:34:08.617

计算非常简单：

```
(( 4096 − 128 ) / 8 − 3) × 4096 = 2019328 
```

# android - 如何将两个查询合二为一？

> ID：12573036
> 
> 赞同：1
> 
> 时间：2012-09-24T21:15:26.423
> 
> 标签：android, sql, sqlite, select

这适用于 Android SQLite。我有两个这样的查询：

```
select * from table where name='name'; 
```

和

```
select * from table where name!='name' order by name; 
```

我想创建一个结合这两个查询的语句。我尝试了 union all 但我不能通过一个语句进行排序然后合并。我试过这个：

```
select * from table where name='name'
union all
select * from table where name!='name' order by name; 
```

它所做的只是组合查询，然后按名称排序。我不想要那个。我想先对第二条语句进行排序，然后将它们组合起来。

换一种说法，这是我的数据：

```
Name

a
b
c
d
e
f
g
h
i
j 
```

但我希望输出为：

```
Name

g
a
b
c
d
e
f
h
i
j 
```

我想将一排排到顶部，然后对其余的行进行排序。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T21:23:50.380

无需使用临时表，您需要添加额外的列进行排序。像这样的东西：

```
select 1, * from table where name='name'
union all
select 2, * from table where name!='name' 
order by 1, name; 
```

我现在没有安装 sqlite，但是这个技巧应该可以工作。（您可能必须为第一列添加别名）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:22:04.233

除非您可以使用表的其他一些属性来提供允许在两个选择之间连接的排序，如[如何组合两个 sql 查询？](https://stackoverflow.com/questions/2666129/how-to-combine-two-sql-queries?rq=1)那么我认为您必须将应该浮动到顶部的查询结果存储在临时表中，然后在存储之前将排序结果添加到该表中。

我从未在 Android 中使用过临时表，因此无法提供示例，但据我所知，这是可能的。

我建议分别运行这两个查询，然后在您的情况下将结果合并到代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:24:32.800

根据 SQLLite 文档，这不能使用`UNION`or来完成，`UNION ALL`因为这些操作必须在简单的选择上执行（没有 的操作`Order by`）。

[http://www.sqlite.org/lang_select.html](http://www.sqlite.org/lang_select.html)

可能有一种我不知道的非常聪明的方法来做到这一点，这通常会导致我只做两个查询并在 java 中组合结果。

[编辑] Jhovanny 有一个非常聪明的方法来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-24T21:29:14.607

现在无法测试它，但是这样的东西应该可以工作：

```
select t.*, case when name = 'name' then 0 else 1 as o from table t order by o, name; 
```

那么你没有两个选择也没有联合。假设您可以在 android 上的 sqlite 中使用 case 语句。

# ajax - 黑莓网络工程应用程序超时

> ID：12573038
> 
> 赞同：0
> 
> 时间：2012-09-24T21:15:29.537
> 
> 标签：ajax, jquery-mobile, blackberry, timeout, blackberry-webworks

```
 $.ajax({
        type: 'POST',
        url: "http://myurl:port/projectpath.action",
        data: formInput,
        dataType: "TEXT",
        timeout:600000,
        async: true,
        success:function(jqXHR, textStatus, errorThrown){

            alert("error :" + textStatus);
            alert("incoming Text :" + jqXHR.responseText);
            alert("What ErrorThrown :" + errorThrown);
            $('#loader').hide();
            window.location.replace("paymentResult.html");
        },
        error:function(jqXHR, textStatus, errorThrown){

            alert("error " + textStatus);
            alert("incoming Text " + jqXHR.responseText);
            alert("What ErrorThrown" +errorThrown);
            $('#loader').hide();
            //alert(xhr.status+"  Server Unavailable! Please try again later");
        }
    });
    return false;

}); 
```

尽管我正在设置 ajax 超时，但我却超时了。在配置文件中，我还提到了超时...仍然超时...

```
alert("What ErrorThrown" +errorThrown); 
```

上面的警报消息显示，在我的配置文件中，我传递的参数是：

```
"rim:connection timeout="600000""
"id"TCP_WIFI"/id"
"id"MDS"/id"
"id"BIS-B"/id"
"id"TCP_CELLULAR"/id"
"id"WAP2"/id"
"id"WAP"/id"
"/rim:connection" 
```

请帮我。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T12:56:02.053

在您的 config.xml 中，您还应该设置一个访问元素。

```
<access uri="*" subdomains="true" /> 
```

你能确认你是否已经这样做了吗？如果是这样，它仍然没有得到响应，你能告诉我你的目标是什么操作系统/设备吗？如果它运行的是 BlackBerry OS 7 或更高版本（或 PlayBook/BB10），您可以使用 Remote Web Inspector 实时查看您的 ajax 请求发生的情况，并以这种方式进行调试。

有关[远程 Web 检查器的更多信息...](https://developer.blackberry.com/html5/documentation/getting_started_webinsp_microsite_1987477_11.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T17:44:35.650

仅使用 WiFi 时，您是否看到相同的结果？关闭移动网络，连接WiFi，看看是否得到相同的结果。

# wpf - “拆分” XAML 文件时的用户控制事件

> ID：12573041
> 
> 赞同：1
> 
> 时间：2012-09-24T21:15:43.173
> 
> 标签：wpf

有几个人问过如何将大型 XAML 文件拆分成更小的更易于管理或可读的块。就我而言，我有一个包含 10 个选项卡的 XAML 文件，每个选项卡都有很多复杂的控件。因此，用于此的 XAML 文件很大且难以阅读。

对此的“标准”答案似乎是用户控件。

我确定这是一个真正的菜鸟问题，但是如果您要做的只是拆分 XAML 文件，那么在不拆分 C# 的情况下如何做到这一点呢？当您创建 WPF 用户控件时，Visual Studio 会创建一个新的 XAML 文件**和**新的代码隐藏文件，以使用它并处理事件。

我真正想要的是相当于 XAML 的“C# 部分”指令，因此我可以将它拆分到多个文件中，但将事件处理在一个地方。我能离那有多近？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:42:54.120

没有办法按照您的描述进行（允许多个 xaml 文件共享相同的 c# 代码）。此外，根据您的描述，没有一种*简单*的方法可以快速抽象该代码而无需进行一些更改。由于 wpf 事件通常由命令驱动，因此最好的解决方案可能是将事件更改为触发命令，而不是将逻辑放在实际事件处理程序本身中，然后从用户控件调用它是微不足道的。

但是在更改所有代码之前，您可以使用样式抽象出很多冗长的东西，这些样式更容易抽象出来并且不应该与您的事件混淆。因此，如果您注意到在许多控件中重复设置的方式，只需将其全部声明为样式，您就可以将其移动到其他地方的资源字典中以消除一些混乱。

详细说明一下，您不仅可以使用样式来停止重复，还可以抽象出您定义控件的方式（就像您尝试使用用户控件一样，您也可以在那里定义事件）。例如...

```
<Style TargetType="TabItem" x:Key="Tab1Style">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate>
                <StackPanel>
                    <!--Note even if this style is defined in a resource file the 
                        events will still be tied to the class of the control
                        using the style-->
                    <Button Click="Button_Click"/>
                    <Button Click="Button_Click_1" />
                    <Button Click="Button_Click_2" />
                </StackPanel>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后将您的一个 tabitems 简化为...

```
<TabControl>
    <TabItem Style="{StaticResource Tab1Style}" />
</TabControl> 
```

如果您真的对用户控件有信心，您也可以将所有事件路由出去。像这样的东西...

```
<UserControl ...>
    <Button Click="OnClick"/>
</UserControl> 
```

```
public partial class UserControl1 : UserControl
{
    public static readonly RoutedEvent ButtonClick = EventManager.RegisterRoutedEvent(
        "ButtonClick", RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(UserControl1));

    public event RoutedEventHandler ButtonClickHandler
    {
        add { AddHandler(ButtonClick, value); }
        remove { RemoveHandler(ButtonClick, value); }
    }

    private void OnClick(object sender, RoutedEventArgs e)
    {
        RoutedEventArgs newEventArgs = new RoutedEventArgs(UserControl1.ButtonClick);
        RaiseEvent(newEventArgs);
    }

    public UserControl1()
    {
        InitializeComponent();
    }
} 
```

```
<Window>
    <local:UserControl1 ButtonClickHandler="Button_Click" />
</Window> 
```

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    MessageBox.Show("Click");
} 
```

（就像我说的很多管道代码）

# ruby - 没有路线匹配 [GET] "/"...有时

> ID：12573047
> 
> 赞同：0
> 
> 时间：2012-09-24T21:16:16.493
> 
> 标签：ruby, ruby-on-rails-3.2

所以我有点像Rails n00b，所以如果这真的很简单，我会道歉。当我从另一台计算机访问我的服务器时，我收到以下消息：

> 没有路线匹配 [GET] "/"

如果我尝试访问我的子页面（嗯，目前我只有一个），我会得到以下信息：

> # 未知动作
> 
> 找不到 AwebpageController 的操作“索引”

但这里有一个问题：这只有时会发生。其余时间，标准的 RoR 主页会加载，然后转到 wwww.mydomain.com/awebpage 会很好地提供页面。

我的 Routes.rb 看起来像这样：

```
Wobsite::Application.routes.draw do
  resources :awebpage
end 
```

awebpage_controller.rb 看起来像这样：

```
class AwebpageController < ApplicationController
end 
```

是的，Awebpage 的 index.html.erb 确实存在。这一切都如此简单，以至于我不明白出了什么问题。哦，我的网络服务器很薄（不确定这是否重要）。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:21:13.377

您可能希望将其添加到您的路由文件的顶部以设置您的站点的默认控制器和页面（即[http://www.mysite.com/](http://www.mysite.com/)）：

`root :to => "AwebpageController#index"`

要删除默认的 Ruby on Rails 网页，您还需要删除目录`index.html`中的文件`/public/`。

此外，虽然不是必需的，但在您的控制器中，您缺少 index 的函数定义。

```
class AwebpageController < ApplicationController
  def index
  end
end 
```

通常你会做应用程序逻辑并在这个函数中提供一个视图；但是，如果您什么都不做，RoR 会自动加载与页面关联的视图 (index.html.erb)。

如果在这一切之后您仍然遇到问题，可能会明确添加`index`到`AwebpageController`您的路线文件中；也许 rails 只是映射`www.mysite.com/Awebpage/`到`Awebpage/index`而不是`www.mysite.com/Awebpage/index`。

# python - 在couchdb python中查询复合键

> ID：12573052
> 
> 赞同：0
> 
> 时间：2012-09-24T21:16:32.180
> 
> 标签：python, couchdb

我有一个复合键`["a", "b", "c", "d", "e"]`，正在尝试使用 python couchdb 视图查询它。我通常一次只使用一个键，不包括其他键。

例如，要查询`key='a'`，我发现唯一有效的是：

```
results=db.view(docname, startkey=['a'], endkey=['azz']). 
```

我认为`{}`与或一起使用`key`，但它们似乎没有效果。`startkey``endkey`

实际上，我通常追求的是：“查找所有具有`"a"`and `"b"`，或具有`"a"`, `"c"`and`"e"`等的文档。我尝试为`"a"`, `"b"`,`"c"`等创建单独的视图并进行单独的查询，但有些查询是基于键不是 a-->e、like`"x"`或。`"y"`因此，对于那些，`"z"`我尝试使用如下所示的键创建视图：永远需要输出, , , & 。`["a", "b", "c", "d", "e", "z"]``'include_docs'``a``b``c``d``e`

我试图找到复合键的最佳组合和每个查询的最小文档传输。我认为如果我能弄清楚`"a"`只取，那么它会起作用`"b"`，等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T08:22:32.433

我希望我对您的理解正确：您正在尝试获取包含两个或多个值的文档。例如，这可能是标签。

你有两种可能：

1.  使用像 couchdb-lucene 或 elasticsearch 这样的全文搜索引擎
2.  为每个键组合发出一个键。对于带有标签 ["a", "b", "x"] 的文档，您将发出：

查看结果：

```
[{key: ["a"], id: 1, value: null}
{key: ["a", "b"], id: 1, value: null}
{key: ["a", "x"], id: 1, value: null}
{key: ["a", "b", "x"], id: 1, value: null}
{key: ["b"], id: 1, value: null}
{key: ["b", "x"], id: 1, value: null}
{key: ["x"], id: 1, value: null}] 
```

使用 include_docs，您可以在查询时获得相应的文档。请记住，这种方法会占用大量磁盘空间。您可以仅使用此视图创建一个设计文档，以查看视图结果需要多少磁盘空间。

希望这可以帮助！如果您提供了一个真实的示例，我可能会给出更好的答案；-)

你的，伯恩哈德

# c# - 执行 SQL 命令最适合 DRY 的方式是什么？

> ID：12573054
> 
> 赞同：2
> 
> 时间：2012-09-24T21:16:34.333
> 
> 标签：c#, sql-server, ado.net

我正在寻找使用最少的样板代码执行数据库查询的最佳方法。[SqlCommand 文档](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)中建议的方法：

```
private static void ReadOrderData(string connectionString)
{
    string queryString = "SELECT OrderID, CustomerID FROM dbo.Orders;";
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        SqlCommand command = new SqlCommand(queryString, connection);
        connection.Open();
        SqlDataReader reader = command.ExecuteReader();
        try
        {
            while (reader.Read())
            {
                Console.WriteLine(String.Format("{0}, {1}",     reader[0], reader[1]));
            }
        }
        finally
        {
            reader.Close();
        }
    }
} 
```

主要由必须在与数据库交互的每个方法中重复的代码组成。

我已经习惯于排除连接的建立，这将产生更像下面的代码。（我也在修改它以使其返回数据，以使示例不那么琐碎。）

```
private SQLConnection CreateConnection()
{
    var connection = new SqlConnection(_connectionString);
    connection.Open();
    return connection;
}

private List<int> ReadOrderData()
{
    using(var connection = CreateConnection())
    using(var command = connection.CreateCommand())
    {
        command.CommandText = "SELECT OrderID FROM dbo.Orders;";

        using(var reader = command.ExecuteReader())
        {
            var results = new List<int>();
            while(reader.Read()) results.Add(reader.GetInt32(0));
            return results;
        }
    }
} 
```

这是一个进步，但仍然有足够的样板来唠叨我。可以进一步减少吗？特别是，我想对程序的前两行做一些事情。我不觉得该方法应该负责创建`SqlCommand`. 就像在示例中一样，这是一个很小的重复，但是如果手动管理事务或更改超时或类似的事情，它似乎会增长。

*编辑*：假设，至少假设，必须返回一堆不同类型的数据。因此，解决方案不能只是一种千篇一律的方法，必须有几种不同的方法，至少取决于是否调用`ExecuteNonQuery`, `ExecuteScalar`, `ExecuteReader`,`ExecuteReaderAsync`或其他任何方法。我想减少其中的重复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:47:42.553

试过[小巧玲珑](http://code.google.com/p/dapper-dot-net/)？

当然，这不会让您获得 DataReader，但一旦您尝试过，您可能会更喜欢这种方式。

它是一个 ORM 最轻的重量，同时仍然被称为 ORM。对我来说，没有更多方法可以在 DataReader 和强类型之间进行映射。

在所有 StackExchange 站点上都在此处使用。

```
using (var conn = new SqlConnection(cs))
{
    var dogs = connection.Query("select name, age from dogs");

    foreach (dynamic dog in dogs)
    {
        Console.WriteLine("{0} age {1}", dog.name, dog.age);
    }
} 
```

或者

```
using (var conn = new SqlConnection(cs))
{
    var dogs = connection.Query<Dog>("select Name, Age from dogs");

    foreach (Dog dog in dogs)
    {
        Console.WriteLine("{0} age {1}", dog.Name, dog.Age);
    }
}

class Dog
{
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:33:26.687

如果您想自己滚动数据访问，这种帮助方法模式可能是消除重复的一种方法：

```
private List<int> ReadOrderData()
{
    return ExecuteList<int>("SELECT OrderID FROM dbo.Orders;", 
        x => x.GetInt32("orderId")).ToList();
}

private IEnumerable<T> ExecuteList(string query, 
    Func<IDataRecord, T> entityCreator)
{
    using(var connection = CreateConnection())
    using(var command = connection.CreateCommand())
    {
        command.CommandText = query;
        connection.Open();
        using(var reader = command.ExecuteReader())
        {
            while(reader.Read()) 
               yield return entityCreator(reader);
        }
    }
} 
```

您必须添加对参数的支持，这可能无法编译，但模式正是我想要说明的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:25:06.210

我通常做的是使用我不久前写的一个自定义类，它接受一个 SQL 字符串，以及可选的参数列表，它返回一个 DataTable。

因为在调用之间发生变化的东西通常只是最佳恕我直言的 SQL。

如果您确实需要使用 DataReader，您可以执行以下操作：

```
public void ExecuteWithDataReader(string sql, Action<DataReader> stuffToDo) {
    using (SqlConnection connection = new SqlConnection(connectionString)) {
        using (SqlCommand command = new SqlCommand(sql, connection)) {
            connection.Open();

            using (SqlDataReader reader = command.ExecuteReader()) {
                try {
                    while (reader.Read()) {
                        stuffToDo(reader);
                    }
                }
                finally {
                    reader.Close();
                }
            }
        }
    }
}

private static void ReadOrderData(string connectionString) {
    string sql = "SELECT OrderID, CustomerID FROM dbo.Orders;";

    ExecuteWithDataReader(sql, r => Console.WriteLine(String.Format("{0}, {1}", r[0], r[1])));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T21:35:41.493

前两行是你需要的最重要的东西......

但是如果你仍然想这样做，你可以把它们变成一个数据库处理程序类，是的，它会变成更多的代码，但是在重构概念中，每件事都会转移到相关的话题上......

尝试编写一个接收命令并执行操作的单例类，因此返回 SqlDataReader 读取器类型的结果...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-24T22:11:27.787

在评论中这样做太多了。

我建议周围的样板代码

```
 using(conn = new sqlconnection)
    using(cmd = new sqlcommand) {
          // blah blah blah
    } 
```

不是可以轻易删除的东西，而是鼓励您将其准确地保留在原处。资源，尤其是非托管资源，应尽可能在最接近执行的点打开和释放恕我直言。

在很大程度上是因为其他开发人员很容易无法遵循适当的清理约定。

如果你做类似的事情

```
private SQLConnection CreateConnection()   
{   
    var connection = new SqlConnection(_connectionString);   
    connection.Open();   
    return connection;   
} 
```

然后您正在邀请另一个程序员调用此方法，并且在执行查询时完全无法释放资源。我不知道您正在构建什么样的应用程序，但在 Web 应用程序中，这样的事情会导致难以调试的类型的内存/连接/资源错误，除非您以前经历过。

相反，我建议你研究一个轻量级的 ORM，例如[Dapper.net](http://code.google.com/p/dapper-dot-net/)或类似的，看看他们是如何处理它的。我不使用 dapper，但我听说它非常好。我不使用它的原因仅仅是我们不允许对我们的数据库执行内联 sql（但这是一个非常不同的对话）。

* * *

这是我们的标准：

```
public static DataTable StatisticsGet( Guid tenantId ) {
    DataTable result = new DataTable();
    result.Locale = CultureInfo.CurrentCulture;

    Database db = DatabaseFactory.CreateDatabase(DatabaseType.Clients.ToString());

    using (DbCommand dbCommand = db.GetStoredProcCommand("reg.StatsGet")) {
        db.AddInParameter(dbCommand, "TenantId", DbType.Guid, tenantId);

        result.Load(db.ExecuteReader(dbCommand));
    } // using dbCommand

    return result;
} // method::StatisticsGet 
```

我们大量使用企业库。它简短、简单、中肯，并且经过了很好的测试。这个方法只返回一个数据表，但你可以很容易地让它返回一个对象集合......或者什么都不返回。

# javascript - Javascript隐藏选定的选项

> ID：12573057
> 
> 赞同：1
> 
> 时间：2012-09-24T21:16:37.110
> 
> 标签：javascript, jquery

我有这个代码来隐藏选定的选项：

```
function connect()
{
    $(".selectbox option").show();
    $(".selectbox").each(function(i) { 
        var obj = $(".selectbox option[value='" + $(this).val() + "']");
        if($(this).val() != "") obj.hide();     
    }); 
}

function to()
{
    $(".selectboxes option").show();
    $(".selectboxes").each(function(i) { 
        var obj = $(".selectboxes option[value='" + $(this).val() + "']");
        if($(this).val() != "") obj.hide();     
    }); 
} 
```

但我现在的问题是，我使用 PHP 来生成 select 标签，并且在那个 php 代码中我有一个条件，一旦它看到这个值，它将自动添加 selected=selected。但是我的 JS 仍然会在下拉列表中显示该变量，即使它已经被选中。我尝试添加：

```
$('.selectboxes option:selected').find("option").hide(); 
```

但它没有用。关于我应该如何解决这个问题的任何想法？

顺便说一句：我忘了提，php代码将生成多个选择标签，这些标签具有相同的值，将使用该函数，因此当我有3个选择标签时，1个将具有预选值，另外2个将为空，现在当我单击其中两个没有选择值但我仍然可以在下拉列表中看到已经在选择 1 中预先选择的选项，我想要做的是它应该自动隐藏，使用该功能它将在我从下拉列表中选择其他选项之前不要隐藏它。从这一行开始：

```
$(".selectbox option").show(); 
```

会在下拉列表中显示所有选项，是否有条件豁免“this”值？

选择部分：

```
for($z=0;$z<$rows_updatedrow;$z++)
{
?>
<select id = "sc" name = "connect_array[]" class="input-select selectbox" onchange = "connect()">
<option value = "">--Select--</option>
<?php
for($zz=0;$zz<$rows_getconnect;$zz++)
{
    $data_getconnect = mysql_fetch_assoc($query_getconnect);
    $field_name_getconnect[] = $data_getconnect['field_name'];
    $field_display_getconnect[] = $data_getconnect['field_display'];
    $field_type_getconnect[] = $data_getconnect['field_type'];
    if((($field_name_getconnect[$zz] == "friends_name" && $connect == 2) || $field_type_getconnect[$zz] == "email") && $z == 0){
    $selected = "selected=selected";
    }else{
    $selected = "";
    }
?>
<option value = "<?php echo $field_name_getconnect[$zz]; ?>" <?php echo $selected; ?>><?php echo $field_display_getconnect[$zz]; ?></option>
<?php
}
?>
</select>
 connect to 
<br/>
<?php
}
?>
</div>
<div class = "right">
<?php
for($a=0;$a<$rows_updatedrow;$a++)
{
?> 
<select name = "to_array[]" class="input-select selectboxes" onchange = "to()">
<option class = "option" value = "">--Select--</option>
<?php
for($aa=0;$aa<$rows_getto;$aa++)
{
    $data_getto = mysql_fetch_assoc($query_getto);
    $field_name_getto[] = $data_getto['field_name'];
    $field_display_getto[] = $data_getto['field_display'];
    $field_type_getto[] = $data_getto['field_type'];
    if((($field_name_getto[$aa] == "friends_name" && $to == 2) || $field_type_getto[$aa] == "email") && $a == 0){
    $selected = "selected=selected";
    }else{
    $selected = "";
    }
?>
<option class = "option" value = "<?php echo $field_name_getto[$aa]; ?>" <?php echo $selected; ?>><?php echo $field_display_getto[$aa]; ?></option>
<?php
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:19:14.903

您已经在选择器中选择了选项 - 无需查找选项 - 因为这将返回一个空数组

```
$('.selectboxes option:selected').hide();
// get rid of .find('option') 
```

免除`this`价值..我猜你指的是选定的价值..你可以使用 :not as undefined 声明

```
$(".selectbox option:not(:selected)").show(); 
```

您可以取出内联 onChange，因为您使用的是 jQuery.. 并将更改事件处理程序绑定到 dom 就绪上的选择元素

```
$(function(){
    $('select').change(function(){   
       var $sel = $('option:selected'); // get all selected options
       $('option').show(); // show all options
       $sel.each(function(i,v){ // loop through selected options
           var $index = $(v).index(); // get index of selected option
           $('select').not($(this).parent()).each(function(){  // loop through other select - not current one       
               if($index != 0){ // not default index
                   $(this).find('option').eq($index).hide(); // hide selected option in other dropdowns
               }
           });
       });    
    }).change(); // <-- trigger change right away
}); 
```

[http://jsfiddle.net/VE7jA/](http://jsfiddle.net/VE7jA/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:34:01.100

```
$('.selectboxes option:selected').find("option").hide(); 
```

您正在尝试在选项中查找（'option'）..试试这个

```
$('.selectboxes option:selected').hide(); 
```

如果您再次使用它，您也可以一劳永逸地删除它。

```
$('.selectboxes option:selected').remove(); 
```

要删除基于值的选项，您可以尝试

```
$('.selectboxes option[value="0"]').remove() ; // Removes option with value 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T21:28:17.617

正如人们所说，你试图在一个选项中找到一个选项，所以你必须摆脱这个`.find`电话。

除此之外，隐藏`<option>`元素不能跨浏览器工作，因此您必须删除选项，并在必要时将它们添加回来。有几种方法可以管理它，所有方法都涉及将完整的选项列表存储在一个变量中（作为一个数组、一个对象，甚至是 HTML 字符串）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T21:29:57.843

`option`并不总是支持隐藏元素。更惯用的方法是禁用它。

```
obj.prop("disabled", true); 
```

或者像这样简化它。

```
$(".selectbox option:selected").prop("disabled", true); 
```

或这个。

```
$(".selectbox").each(function() { 
     this.options[this.selectedIndex].disabled = true; 
}); 
```

# java - 如何使用 App 引擎创建朋友和状态更新

> ID：12573058
> 
> 赞同：0
> 
> 时间：2012-09-24T21:16:43.093
> 
> 标签：java, android

大家好，我之前发布了一个与该主题相关的问题，但我相信这个问题很广泛。所以这次我会尝试更具体。

我想使用 Google 的 AppEngine 为我的应用程序创建一个社交网络环境。

例如，它将允许用户登录，查看好友状态，他们将是一个用户可以查看好友列表并单击好友以加载用户个人资料的活动。

所以基本上我想知道这个实现应该是什么样子？

如使用 App Engine、Amazon S3 服务等

**所以这是我的两个主要问题：** 当他们点击“朋友”活动时，我将如何加载用户朋友列表？

我将如何加载用户当前朋友的最新状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:48:44.357

在 App Engine 上为您的网站创建 API。

然后，您可以在您的 Android 应用程序中使用该 API。

对于登录，请询问用户他们的电子邮件/用户名或密码。您将其发送到您的 API 并让它返回与用户关联的令牌。使用该令牌向 API 查询用户的好友状态、列表等。

将令牌保存在 Android 应用的 SharedPreferences 中。您检查 SharedPreferences 以了解用户是否已登录。

# java - 强制休眠以保存特定的 POJO

> ID：12573059
> 
> 赞同：2
> 
> 时间：2012-09-24T21:16:46.793
> 
> 标签：java, hibernate, transactions

我有一些调用 web 服务的代码，它返回一个 ID。我正在使用休眠将此 ID 保存在数据库中。我有一个过滤器，可以打开会话并提交它，当包含的代码中发生任何异常时回滚。由于无法取回 Web 服务返回的 ID，我想将其保存在数据库中，即使稍后在代码中发生异常也是如此。反正有没有使用相同的会话来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:35:45.423

这取决于谁抛出异常。如果它是由休眠会话对象抛出的，则您不能再重用会话，如休眠[会话](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html)文档中所述：

> 如果 Session 抛出异常，则必须回滚事务并丢弃会话。异常发生后，Session的内部状态可能与数据库不一致。

如果异常是由其他代码引发的，那么是的，您可以执行以下操作：

```
Long yourIdFromWebservice = ...

try {
   // do some processing that might result in an exception
}
catch(//the interesting exception, but not HibernateException) {
     //maybe log it, rethrow it
}
finally {
   session.save() //save what needed to be saved
} 
```

或根据您的用例：

```
try {
   // do some processing that might result in an exception
   session.save() //save all stuff if no exception
}
catch(//the interesting exception, but not HibernateException) {
     session.save() //save only the id from the webservice
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:59:57.047

正确的做法是使用两个事务：一个保存 ID，另一个保存您的其余工作。

如果您使用的是 EJB，您可以将 ID 保存在它自己的 bean 中，并使用[`TransactionAttribute`](http://docs.oracle.com/javaee/6/api/javax/ejb/TransactionAttributeType.html#REQUIRES_NEW)of注释它[`REQUIRES_NEW`](http://docs.oracle.com/javaee/6/api/javax/ejb/TransactionAttributeType.html#REQUIRES_NEW)。

否则，您可以查看您的环境为您提供的对事务的控制，并找出一种方法来拥有其中的两个。

# python - 将函数内部的值添加到函数外部的空字符串

> ID：12573066
> 
> 赞同：0
> 
> 时间：2012-09-24T21:17:14.200
> 
> 标签：python, string, function, concatenation

```
empty_string = ''
string_1 = 'beta'

def sample(x):
    empty_string = empty_string + 'alpha'
    return x 
```

为什么不：

```
empty_string = 'alpha' 
```

我很困惑为什么`empty_string`我在函数中添加它之后仍然是空的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:18:21.467

使用`global empty_string`inside 函数，那么只有你可以修改一个全局变量：

```
def sample(x):
    global empty_string
    empty_string = empty_string + 'alpha'
    return x 
```

# c# - 如何处理循环引用 - 或 - 在暴露实体框架数据模型的 WCF 服务中返回的第一级子项下的中断引用？

> ID：12573070
> 
> 赞同：2
> 
> 时间：2012-09-24T21:17:30.863
> 
> 标签：c#, wcf, entity-framework-4, ef-code-first, circular-reference

我正在尝试通过 JSON 上的 WCF Web 服务公开我的数据模型（代码优先实体框架）。该模型具有多个多对多关系并启用了延迟加载。我们的 Web 服务应该能够只返回多个子对象的第一级。我继续收到以下错误：

“无法评估表达式，因为当前线程处于堆栈溢出状态。”

我意识到在序列化具有循环引用的数据时会发生此错误。

在阅读了另一个线程后，我尝试了以下补救措施来处理循环引用：

*   WCF 和 DataContractSerializer：使用 DataContract[IsReference=true] 显式标记您的实体，并使用 [DataMember] 属性显式标记所有属性。这将允许您使用循环引用。如果您使用 T4 模板生成实体，则必须对其进行修改以添加这些属性。
*   WCF 和 DataContractSerializer：隐式序列化。使用 [IgnoreDataMember] 属性标记相关导航属性之一，以便不序列化属性。
*   XmlSerializer：用 [XmlIgnore] 属性标记一个相关的导航属性
*   其他序列化：用 [NonSerialized] 标记一个相关的导航属性（Haz 他是第一个提到这一点的 +1）用于常见的序列化或 [ScriptIgnore] 用于一些 JSON 相关的序列化。

这些不同的方法都没有奏效。我真正需要的只是子对象的第一级。我不需要孩子的孩子这么说。我添加了以下代码来手动中断对第一级子对象的子对象的引用，这有效但不是有效的解决方案：

```
 [WebInvoke(Method = "POST", ResponseFormat = WebMessageFormat.Json, UriTemplate = "GetReportTypes")]
    public List<ReportType> GetReportTypes()
    {
        List<ReportType> result = BusinessLogic.GetReportTypes(_context).ToList();
        foreach (var x in result)
        {
            foreach (var y in x.Sections)
            {
                y.ReportType = null;
            }

        };
        return result;
    } 
```

我正在寻找一种可靠的方法来处理通过 WCF 公开的 EF 中具有多对多关系的对象的序列化 - 或者 - 只是为了打破第一级子级以下的引用。我愿意以某种方式更改数据模型或重新配置 Web 服务。

为了完整起见，下面列出了我的所有相关代码：

```
[DataContract(IsReference = true)]
[Table("ReportType", Schema = "Reporting")]
public class ReportType
{
    [Key]
    [Column("ID")]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    [DataMember]
    public int Id { get; set; }

    [DataMember]
    public virtual ICollection<ReportTypeSection> Sections { get; set; }
}

[Table("Section", Schema = "Reporting")]
[DataContract(IsReference = true)]
public class Section
{
    [Key]
    [Column("ID")]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    [DataMember]
    public int Id { get; set; }

    [DataMember]
    public virtual ICollection<ReportTypeSection> ReportTypes { get; set; }
}

[Table("ReportTypeSection", Schema = "Reporting")]
[DataContract(IsReference=true)]
public class ReportTypeSection
{
    [Column("ID")]
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    [DataMember]
    public int Id { get; set; }

    [Column("ReportTypeID")]
    [Required(ErrorMessage = "Report Type Section Foreign Key Report Type ID is Required")]
    [DataMember]
    public int ReportTypeId { get; set; }

    [Column("SectionID")]
    [Required(ErrorMessage = "Report Type Section Foreign Key Section ID is Required")]
    [DataMember]
    public int SectionId { get; set; }

    [DataMember]
    public virtual ReportType ReportType { get; set; }

    [DataMember]
    public virtual Section Section { get; set; }

}

public class BusinessLogic
{
    public static IEnumerable<ReportType> GetReportTypes(IDatabaseContext context)
    {
        IEnumerable<ReportType> result = context.ReportTypes
            .Include(a => a.Sections)
            .AsEnumerable();
        return result;
    }
}

public class ReportConfigurationService : IReportConfigurationService
{
    private IEmspeedDatabaseContext _context;
    public ReportConfigurationService(IEmspeedDatabaseContext context)
    {
        _context = context;
    }

    [WebInvoke(Method = "POST", ResponseFormat = WebMessageFormat.Json, UriTemplate = "GetReportTypes")]
    public List<ReportType> GetReportTypes()
    {
        List<ReportType> result = BusinessLogic.GetReportTypes(_context).ToList();
        return result;
    }
}

[ServiceContract]
public interface IReportConfigurationService
{

    [OperationContract]
    [ApplyDataContractResolver]
    List<ReportType> GetReportTypes();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:18:14.260

如果您只需要单层，则必须关闭延迟加载并使用急切加载来仅加载第一级子实体。如果存在此类导航属性，这仍可能导致从子级到父级的一些反向序列化。要完全避免所有序列化问题，您必须使用 DTO（数据传输对象），它只对您想要使用的数据和单向关系进行建模。您将在服务操作中填写 DTO 并将其返回 => 您将通过构建独立于实体模型的 DTO 来完全控制序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T23:37:11.353

只是避免将 [DataMember] 属性放在具有 ciclic 引用的属性上（在这种情况下，我使用热切加载）：

```
[DataContract]
public class Persona
{
    [DataMember]
    [Key]
    public int IdPersona { get; set; }
    [DataMember]
    public string Nombre { get; set; }
    [DataMember]
    public List<Domicilio> Domicilios { get; set; }
}

[DataContract]
public class Domicilio
{
    [DataMember]
    [Key]
    public int IdDomicilio { get; set; }
    [DataMember]

    public Persona persona { get; set; }
} 
```

# cmake - CMake：将变量与自身匹配的目的是什么？

> ID：12573071
> 
> 赞同：4
> 
> 时间：2012-09-24T21:17:38.373
> 
> 标签：cmake

[我在CHECK_C_SOURCE_COMPILES 宏](http://sewm.pku.edu.cn/src/paradise/thirdparty/installed/share/cmake-2.6/Modules/CheckCSourceCompiles.cmake)的定义中看到了以下一段 CMake 代码：

```
IF("${VAR}" MATCHES "^${VAR}$")
... 
```

这段代码的目的是什么，它不会总是成功吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T11:22:14.853

来自[CMake 邮件列表](http://www.cmake.org/pipermail/cmake/2009-July/030544.html)

> 这绝对不是真的。您正在测试的变量可能包含“未评估”的 var 或一些特殊的正则表达式字符（*、?、...）

# sql - Active Record：基于关联中另一个查询的查询

> ID：12573076
> 
> 赞同：2
> 
> 时间：2012-09-24T21:18:06.530
> 
> 标签：sql, ruby-on-rails, activerecord

我正在尝试根据关联中的查询进行复杂的搜索。

事件 belongs_to :user / 用户 has_many :events

* * *

从字面上看：

```
query = User.where(:name => 'Bob')
query = query.joins(:events).where('COUNT(events.start_at > #{Time.now}) = 0') 
```

* * *

我尝试了几种方法，但似乎都没有奏效。非常感谢帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:29:18.070

您需要使用[范围](http://guides.rubyonrails.org/active_record_querying.html#scopes)来允许这种链接：

在用户模型中：

```
scope :with_name, lambda { |name| where(:name => name) } 
```

在代码中：

```
query = User.with_name('Bob')
query = query.joins(:events).where('COUNT(events.start_at > #{Time.now}) = 0') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:07:37.460

我注意到您的查询编写方式存在一些问题，但我认为修复它们不会解决您的问题。尽管如此，希望知道这些东西会让你更接近！

首先，您需要双引号以使 Ruby 尊重您的 #{} 插值：

打开 IRB 并尝试：

```
1.9.3p194 :001 > 'COUNT(events.start_at > #{Time.now}) = 0' 
```

这将输出：

```
"COUNT(events.start_at > \#{Time.now}) = 0" 
```

请注意，没有任何变化，因为我们有单引号。

现在让我们尝试使用双引号，我们更接近一点：

```
1.9.3p194 :002 > "COUNT(events.start_at > #{Time.now}) = 0" 
```

这次我们看到：

```
"COUNT(events.start_at > 2012-09-24 14:47:52 -0700) = 0" 
```

但这仍然行不通，因为 SQL 需要在您的时间戳周围加上引号以进行比较。

我们可以手动处理，如下所示：

```
1.9.3p194 :003 > "COUNT(events.start_at > '#{Time.now}') = 0" 
```

生成：

```
"COUNT(events.start_at > '2012-09-24 14:49:31 -0700') = 0" 
```

但这可能不适用于所有 SQL - 我知道 Postgres 需要单引号包围文字，但 MySQL 可能更喜欢双引号，或者可能无关紧要。

处理这个问题的最好方法是让 Rails 解决这个问题。我们这样做的方式是使用 ? 我们的 SQL 查询字符串中的运算符：

```
where('COUNT(events.start_at > ?) = 0', Time.now) 
```

Rails 将生成并发送到您的 SQL 数据库的输出，如下所示：

```
"WHERE COUNT(events.start_at > '2012-09-24 14:49:31 -0700') = 0" 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T23:54:08.513

我认为这就是您要在一行中寻找的所有内容：

```
Event.joins(:user).where(:users => {:name => 'Bob'}, :events => {:start_at => Time.at(0)..Time.now }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T00:13:23.880

您不能在 WHERE 子句 afiak 中使用 COUNT。您需要对结果进行分组并使用条件仅返回您想要的结果。

```
query = User.where(:name => 'Bob')
query = query.joins("LEFT JOIN (SELECT events.id FROM events WHERE events.start_at > '#{Time.now.to_s(:db)}') AS events ON events.user_id=users.id").group("users.id").where("events.id IS NULL") 
```

# php - 阻止直接访问子文件夹中的文件，但允许使用 htacess 索引页面

> ID：12573079
> 
> 赞同：1
> 
> 时间：2012-09-24T21:18:25.090
> 
> 标签：php, .htaccess, blocking, http-referer

我的域中有很多文件夹和子文件夹。我想避免直接访问特定子文件夹中的文件类型 html/ jpg/ gif/ 等，但我希望它可以通过 index.php 页面访问。

结构类似于：

*   www.domain.com/folder1
*   www.domain.com/folder2
*   www.domain.com/folder2/subfolder1
*   **www.domain.com/folder2/subfolder2**
*   **www.domain.com/folder2/subfolder2/index.php**
*   **www.domain.com/folder2/subfolder2/page1.html**
*   **www.domain.com/folder2/subfolder2/page2.html**
*   **www.domain.com/folder2/subfolder2/images/1.jpg**
*   **www.domain.com/folder2/subfolder2/images/2.jpg**

我尝试将 page1.html、page2.html 和 images 文件夹放入名为 blocks_content 的新文件夹**中**：

*   www.domain.com/folder2/subfolder2/index.php
*   www.domain.com/folder2/subfolder2/blocked_content **/page1.html** _

`deny from all`并`Order Deny,Allow Deny from all`在**blocked_content**文件夹中添加了一个.htaccess 。它阻止了所有，甚至 index.php 也无法访问其中的文件。Index.php 只有简单的链接`<a href="blocked_content/page1.html">`

在 .htaccess 上尝试了这个配置：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?domain\.com [NC] 
RewriteRule \.(swf|pdf|css|gif|png|jpg|html|htm)$ - [F] 
```

并将其放在 subfolder2 中并没有效果。

在 .htaccess 上尝试了这个配置：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?domain\.com/folder2/subfolder2 [NC] 
RewriteRule \.(swf|pdf|css|gif|png|jpg|html|htm)$ - [F] 
```

我把它放在 subfolder2 里面：没有效果。我把它放在根目录它会阻止所有其他文件夹。

我搜索了很多。我被困住了。我究竟做错了什么？把 htacess 放在错误的地方或忘记添加一些东西？如果可能的话，我想通过 .htacess 来做到这一点。将 php 会话包含到所有 html 文件将不起作用，因为我无法更改文件名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:57:26.520

找到了按照我尝试的方式执行此操作的方法。

使用 Web 工具在此网站中生成此 .htaccess[防止图像热链接 – 如何保护热链接](http://www.htaccesstools.com/hotlink-protection/)

将 .htaccess 放入我的**blocked_content/**文件夹。

我域中的 index.php 可以访问此文件夹中的所有内容，但用户无法在浏览器上键入 url 作为热链接。例如：**www.domain.com/folder2/subfolder2/blocked_content/images/1.jpg**

新的 .htaccess 之间的区别

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?domain.com [NC]
RewriteRule \.(swf|pdf|css|gif|png|jpg|html|htm)$ - [NC,F,L] 
```

对旧的：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?domain\.com [NC] 
RewriteRule \.(swf|pdf|css|gif|png|jpg|html|htm)$ - [F] 
```

PS：@Mikulas Dite 告诉我它可能没有我希望的那么安全。

# java - Android：测试 proguarded 应用程序是否正常工作

> ID：12573084
> 
> 赞同：2
> 
> 时间：2012-09-24T21:19:12.270
> 
> 标签：java, android, eclipse, proguard

我想使用 ProGuard 来混淆我的应用程序（使用 Eclipse）。不幸的是，只有在导出发布版本时才会启用 ProGuard。由于我没有android设备，有什么方法可以在开发机器上测试proguarded build？我使用了很多本机代码等，所以我想确保没有任何必要的东西被优化掉。

谢谢

# networking - 无法从不同的计算机访问网站

> ID：12573090
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:19:34.580
> 
> 标签：networking

我有一个非常奇怪的问题。我一直在这个网站[http://fxicube.com](http://fxicube.com)上开发，到目前为止一切都很好，从今天开始出现问题，奇怪的是我可以从我的电脑和其他一些电脑访问这个网站，例如今天我试图从不同计算机上的同一网络访问该站点，有些可以访问，有些则不能。

我想知道问题可能是什么，是服务器端还是客户端？以前有人遇到过同样的问题吗？

如果有人能给我一些提示或帮助如何解决它，我将非常感激，如果您还可以查看您是否可以访问该站点？

顺便说一句，今天我安装了一个论坛PHPBB，可能会导致任何问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:41:49.547

问：所以你是说所有工作的客户都在现场，而所有失败的客户都在场外？并且所有客户端（现场和非现场）都返回相同的 IP 地址？

如果是这样，那就是问题所在。

您*无法*从防火墙*内部*访问服务器的*外部*IP 地址。您必须在防火墙内使用其*内部*IP 地址访问它。

 **该问题的一般解决方案是 DNS。例如，您可以使用“拆分 DNS”：

*   [http://wiki.zimbra.com/wiki/Split_DNS](http://wiki.zimbra.com/wiki/Split_DNS)

*   [http://www.linuxjournal.com/article/4198](http://www.linuxjournal.com/article/4198)

*   [http://www.mattgibson.ca/2008/07/13/setting-up-split-split-dns-with-windows-sbs-2003-dns-services-easy/](http://www.mattgibson.ca/2008/07/13/setting-up-split-split-dns-with-windows-sbs-2003-dns-services-easily/)**

# css - 嵌套 div 隐藏父 div 中的文本

> ID：12573096
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:20:18.590
> 
> 标签：css, html

我面临嵌套 div 的问题。父 div 上的文本将从前面的 div 中隐藏。嵌套 div "numReview" 设置为父 div Bodyboxleft 的左下角。我希望 numReview 位于左下角的原因是因为某些页面的内容较少，某些页面的内容更多。当页面上有更多内容时， div:numReview 将隐藏 bodyboxleft div 中底部 80px 的内容。

小提琴链接页面如下：

[http://jsfiddle.net/CANu4/1/](http://jsfiddle.net/CANu4/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:35:33.033

你有一个`position: absolute;`............`float:left;`

删除`position:absolute;`以便#numReview 不会覆盖文本

```
#numReview {
    width: 820px;
    height: 80px;
    float:left;
    background-color: #C0BFBF; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:53:20.797

如果您使用绝对位置，请使用 top 属性将其放置在所需位置，但由于页面上不需要绝对位置，您可以不使用它。

# ios - ios音频单元remoteIO在录制时播放

> ID：12573097
> 
> 赞同：5
> 
> 时间：2012-09-24T21:20:29.753
> 
> 标签：ios, voip, audiounit

我被指控将 VOIP 添加到游戏中（跨平台，所以不能使用 Apple gamekit 来做）。

现在有 3 或 4 天，我正试图让我的头围绕音频单元和 remoteIO ......我忽略了几十个例子等等，但每次它只是对输入 PCM 应用一个简单的算法并播放它回到扬声器上。根据 Apple 的文档，为了进行 VOIP，我们应该使用 kAudioSessionCategory_PlayAndRecord。

```
UInt32 audioCategory = kAudioSessionCategory_PlayAndRecord;

        status = AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, 
                                         sizeof(audioCategory), 
                                         &audioCategory);
        XThrowIfError(status, "couldn't set audio category"); 
```

1）但是（在我看来） playAndRecord 似乎总是会播放来自麦克风的内容（或者更确切地说是 PerformThru 回调 // **aurioTouch**），我错了吗？

我有最简单的回调，除了 AURender 什么都不做

```
static OSStatus PerformThru(
                            void                        *inRefCon, 
                            AudioUnitRenderActionFlags  *ioActionFlags, 
                            const AudioTimeStamp        *inTimeStamp, 
                            UInt32                      inBusNumber, 
                            UInt32                      inNumberFrames, 
                            AudioBufferList             *ioData)
{
OSStatus err = AudioUnitRender(THIS->rioUnit, ioActionFlags, inTimeStamp, 1, inNumberFrames, ioData);
    if (err) 
       printf("PerformThru: error %d\n", (int)err);
    return err
} 
```

从那个回调中，我打算向对等方发送数据（当然不是直接发送，但数据会来自它）......

我看不出如何播放与输入不同的输出，除了可能使用 2 个单元、一个录音、一个播放，但这似乎不是 Apple 的意图（仍然根据文档）。

当然，我找不到任何关于它的文档，音频单元仍然几乎没有文档......

任何人都会知道最好的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-25T01:21:42.780

我没有使用过 VOIP 或 kAudioSessionCategory_PlayAndRecord。但是，如果您想记录/传输从麦克风拾取的语音并播放来自网络包的传入数据：[这](http://code.google.com/p/ios-coreaudio-example/downloads/detail?name=Aruts.zip&can=2&q=)是一个很好的示例，其中包括麦克风和播放。此外，如果您尚未阅读 Apple 的此文档，我强烈推荐[此](http://developer.apple.com/library/ios/#documentation/MusicAudio/Conceptual/AudioUnitHostingGuide_iOS/ConstructingAudioUnitApps/ConstructingAudioUnitApps.html)文档。

简而言之：您需要创建一个 AudioUnits 实例。在其中配置两个回调：一个用于麦克风，一个用于播放。回调麦克风函数将为您提供从麦克风拾取的数据。然后，您可以使用任何选择的网络协议转换并传输到其他设备。播放回调函数是您提供来自其他网络设备的传入数据以进行播放的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-22T07:24:44.220

你可以看到[这个](http://atastypixel.com/blog/using-remoteio-audio-unit/)简单的例子。它描述了如何使用远程 IO 单元。理解了这个例子之后，你应该看看[PJSIP 的音频驱动程序](https://code.google.com/p/pjsip-iphone-audio-driver/downloads/list)。这些应该可以帮助您实施自己的解决方案。祝你好运。

# sql - 具有来自不同表的多个列的外键

> ID：12573099
> 
> 赞同：7
> 
> 时间：2012-09-24T21:20:37.683
> 
> 标签：sql, database, database-design, foreign-keys, multiple-tables

举个愚蠢的例子：我有很多家畜，每一个都有一个名字作为id和一个类型（是CAT或DOG），让我们这样写（**伪代码**）：

```
TABLE ANIMALS (
  NAME char,
  ANIMAL_TYPE char {'DOG', 'CAT'}
  PRIMARY KEY(NAME)
) 
```

（例如，我有一只名叫 Felix 的猫和一只名叫 Pluto 的狗）

在另一张桌子上，我想为我的每只动物存储喜欢的食物：

```
TABLE PREFERED_FOOD (
  ANIMAL_NAME char,
  PREF_FOOD char
  FOREIGN KEY (ANIMAL_NAME) REFERENCES ANIMALS(NAME)
) 
```

（例如，菲利克斯喜欢牛奶，冥王星喜欢骨头）

由于我想定义一组可能的首选食物，我将每种动物的食物类型存储在第三个表中：

```
TABLE FOOD (
  ANIMAL_TYPE char {'DOG', 'CAT'},
  FOOD_TYPE char
) 
```

（例如，狗吃骨头和肉，猫吃鱼和牛奶）

我的问题来了：我想在 PREFERED_FOOD 中添加一个外部约束，因为 PREF_FOOD 是来自 FOOD 的 FOOD_TYPE，其中 FOOD.ANIMAL_TYPE=ANIMALS.TYPE。如何在不复制 PREFERED_FOOD 上的 ANIMAL_TYPE 的情况下定义这个外键？

我不是 SQL 专家，所以如果它真的很容易，你可以称我为愚蠢 ;-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T00:37:47.950

你不能在 SQL 中。如果 SQL 支持断言，我认为你*可以。*（SQL-92 标准定义的断言。据我所知，还没有人支持它们。）

要解决该问题，请使用重叠约束。

```
-- Nothing special here.
create table animal_types (
  animal_type varchar(15) primary key
);

create table animals (
  name varchar(15) primary key,
  animal_type varchar(15) not null references animal_types (animal_type),
  -- This constraint lets us work around SQL's lack of assertions in this case.
  unique (name, animal_type)
);

-- Nothing special here.
create table animal_food_types (
  animal_type varchar(15) not null references animal_types (animal_type),
  food_type varchar(15) not null,
  primary key (animal_type, food_type)
);

-- Overlapping foreign key constraints.
create table animals_preferred_food (
  animal_name varchar(15) not null,
  -- This column is necessary to implement your requirement. 
  animal_type varchar(15) not null,
  pref_food varchar(10) not null,
  primary key (animal_name, pref_food),
  -- This foreign key constraint requires a unique constraint on these
  -- two columns in "animals".
  foreign key (animal_name, animal_type) 
    references animals (animal_name, animal_type),
  -- Since the animal_type column is now in this table, this constraint
  -- is simple.
  foreign key (animal_type, pref_food) 
    references animal_food_types (animal_type, food_type)
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:25:17.863

```
FOREIGN KEY (PREF_FOOD) REFERENCES FOOD (FOOD_TYPE) 
```

在 PREFERRED_FOOD 表中，这将确保 PREFERRED_FOOD 表中的每个 PREFFOOD 都已经存在于 FOOD 表的 FOOD_TYPE 中。

并且在 FOOD 表的使用中，它现在非常不言自明。

```
FOREIGN KEY (ANIMAL_TYPE) REFERENCES ANIMALS (ANIMAL_TYPE) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T21:27:25.467

根据您使用的 DBMS（请编辑您的问题以包含此内容），您可能希望在`ANIMAL_TYPE`and`PREFERED_FOOD`列上创建唯一约束。

像这样的东西：

```
ALTER TABLE PREFERED_FOOD
ADD CONSTRAINT uc_FoodAnimal UNIQUE (ANIMAL_TYPE,PREFERED_FOOD) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T01:20:03.680

坦率地说，我在满足您的要求时遇到了一些麻烦，但是代表动物及其食物的简单模型可能如下所示：

![在此处输入图像描述](../Images/ab70c446babe78cfa833351aa1da8da4.png)

SPECIES_FOOD 列出了给定物种可以吃的所有食物，然后 INDIVIDUAL 通过 PREFERRED_FOOD_NAME 字段选择其中一种。

由于 INDIVIDUAL.SPECIES_NAME 是针对 SPECIES 和 SPECIES_FOOD 的 FK，**因此**个人永远不会偏爱不能被其物种食用的食物。

这当然是假设个体动物不能有超过一种偏好的食物。¹它还假设它可以没有 - 如果不是这种情况，只需将 INDIVIDUAL.PREFERRED_FOOD_NAME 设为 NOT NULL。

INDIVIDUAL_NAME 是故意*不*作为密钥的，因此您可以拥有两只名为“Felix”的猫。如果这不是可取的，您可以轻松添加适当的密钥。

如果您只需要了解食物的名称，并且不需要独立于任何物种来表示食物，则可以完全省略 FOOD 表。

* * *

¹如果每只动物可能有多种首选食物，您需要在“个体”和 SPECIES_FOOD 之间再增加一张表，并注意继续使用识别关系，因此 SPECIES_NAME 一直向下迁移（以防止首选食物该物种不能食用）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T13:19:49.200

如果您采用 ANIMALS 和 PREFERRED_FOOD 的（自然）JOIN，那么您会得到一个表格，其中列出了每种动物的类型和首选食物。

您希望该组合对于每个单独的动物都是“有效的”，其中“有效”的意思是“出现在 FOOD 中列出的有效动物类型/食物类型组合的枚举中。

所以你有一个有点类似于 FK 的约束，但是这次“外键”不是出现在基表中，而是出现在两个表的连接中。对于这种类型的约束，SQL 语言有 CHECK 约束和 ASSERTIONS。

ASSERTION 版本是最简单的。这是一个类似的约束（我对属性名称有点自由，以避免仅仅因为属性重命名而混淆了这一点）

```
CREATE ASSERTION <name for your constraint here>
 CHECK NOT EXISTS (SELECT ANIMAL_TYPE, FOOD_TYPE
                     FROM ANIMALS NATURAL JOIN PREF_FOOD
                    WHERE (ANIMAL_TYPE, FOOD_TYPE) NOT IN
                          SELECT ANIMAL_TYPE, FOOD_TYPE FROM FOOD_TYPE); 
```

但是您的普通 SQL 引擎不支持断言。所以你必须使用 CHECK 约束。例如，对于 PREF_FOOD 表，您需要的 CHECK 约束可能类似于

```
CHECK EXISTS (SELECT 1
                FROM FOOD NATURAL JOIN ANIMAL
               WHERE ANIMAL_TYPE = <animal type of inserted row> AND
                     FOOD_TYPE = <food type of inserted row>); 
```

理论上，这应该足以强制执行您的约束，但是您的普通 SQL 引擎将再次不支持这种 CHECK 约束，因为对表的引用不是定义约束的表。

因此，您可以选择使用诸如 catcall 之类的相当复杂的 (*) 设置，或者使用触发器强制执行约束（并且您必须编写很多触发器（至少三个或六个，还没有考虑到这一点）详细），并且您的下一个最佳选择是在应用程序代码中强制执行此操作，并且再次将有三个或六个（或多或少）不同的地方需要实施相同数量的不同检查。

在所有这三个场景中，您最好在其他地方记录约束的存在以及它的确切含义。这三者中的任何一个都不会让阅读此设计的第三方非常清楚这到底是怎么回事。

(*) “复杂”可能并不完全是正确的词，但请注意，此类解决方案依赖于**故意冗余**，因此**在设计时故意低于 3NF**。这意味着您的设计会面临更新异常，这意味着用户将更难更新数据库并使其保持一致（正是因为故意冗余）。

# ruby-on-rails - rails reject_if 用于时间字段

> ID：12573100
> 
> 赞同：2
> 
> 时间：2012-09-24T21:20:45.823
> 
> 标签：ruby-on-rails, ruby-on-rails-3, time, time-select

对不起我的英语，我的问题是：如何检查reject_if 块上的空时间字段。这是我的一些代码。

```
accepts_nested_attributes_for :working_times, :allow_destroy => true, :reject_if => proc { |attributes| attributes[:start_time].blank? } 
```

但这不起作用，因为当我没有在选择字段上选择时间时， attributes[:start_time] 不是空白，而是......

```
{"start_time(1i)"=>"1", "start_time(2i)"=>"1", "start_time(3i)"=>"1", "start_time(4i)"=>"", "start_time(5i)"=>"", "stop_time(1i)"=>"1", "stop_time(2i)"=>"1", "stop_time(3i)"=>"1", "stop_time(4i)"=>"", "stop_time(5i)"=>""} 
```

验证时间字段的最佳方法是什么

预先感谢，问候。

# android - Android r8b c++ 共享库问题

> ID：12573108
> 
> 赞同：1
> 
> 时间：2012-09-24T21:21:16.803
> 
> 标签：android, c++, shared, gcc4.7

这是一个奇怪的设置。我用 GCC 4.7 编译了一个自定义 NDK（用于 Debian armhf chroot 主机）。在测试中，它可以完美地在 Android 上编译和运行常规的 c 和 c++ 二进制文件。尝试使用 C++ 编译测试共享库时：

```
arm-linux-androideabi-g++ -fPIC -shared test.cpp -lstdc++ -o test.so 
```

我收到许多链接器错误`_staticinitialization_destruction`并且`_dso_handle`未被引用。

我在目录下的 lib 文件夹中都有`libstdc++.a`并且可用。到底是怎么回事？几乎没有任何关于 Android C++ 独立编译的信息。`libstdc++.so``arm-linux-androideabi`

*编辑* GNU STL 的 iostream 部分似乎未定义 __dso_handle。我从 2005 年的 Linux 帖子中找到了答案。似乎在 2012 年仍然是一个问题：O 大声笑。

# qt - QTableView“ResizeToContents”列太宽，启用排序

> ID：12573109
> 
> 赞同：3
> 
> 时间：2012-09-24T21:21:23.620
> 
> 标签：qt, qtableview

我有两个相同的 QTableView，其中一个是可排序的。这两个表都有最后四列，它们的调整大小模式设置为 QHeaderView::ResizeToContents。

不可排序的表格列宽似乎是正确的，列标题的左右边缘只有几个像素的填充。但是可排序表的列宽在列标题的左右边缘增加了大约 30 个像素，使它们比需要的宽得多。

除了单行 setSortingEnabled(bool) 之外，这些表及其模型的构造是相同的。

这是设计使然，还是有办法从可排序表中删除所有这些额外的填充？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:49:18.220

额外填充的原因是由于需要`QHeaderView`绘制排序指示符。因此，如果您希望有一个关于表格当前排序状态的可见指示符，那么我建议您将额外的填充留在那里。否则，您可以执行以下操作：

```
table->setSortingEnabled( true );
table->horizontalHeader()->setSortIndicatorShown( false ); 
```

请注意，这些函数调用的顺序很重要。

也可以对`QHeaderView`虚`sectionSizeFromContents()`函数进行子类化和覆盖，并对其进行自定义以满足您的特定需求。

# php - PHP、PDO绑定动态数量值到语句中

> ID：12573110
> 
> 赞同：0
> 
> 时间：2012-09-24T21:21:36.503
> 
> 标签：php, arrays, dynamic, pdo, bind

对于以下问题，我需要一些有效的解决方案：由于某种原因，正确解释会很耗时，我需要一个 PDO 准备语句，看起来是这样的：

```
'SELECT field, another field, blabla FROM table WHERE some_foreign_id = first_val AND the_same_foreign_id = second_val AND again_the_same_id = third val ......' 
```

并且我希望用未知大小的数组填充值，这取决于该外部表中有多少字段适合另一个表中的某个类别。所以问题是：它甚至可能还是我应该放弃它并找到一些天真的解决方法？

提前致谢！苹果电脑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:06:03.780

您可以将一组值传递给 stmt ->execute($array); 唯一棘手的部分是输入要输入的问号数量。

```
 $foreign_ids = array(foreign_id_1, foreign_id_2, foreign_id_3); //etc
    $input_list = substr(str_repeat(',?', count($foreign_ids)), 1);  //this gets you the correct number of ? to use for your query
    // if you need add another value to the parameters you can use array_push($foreign_ids,$your_other_param);

    $stmt= $dbh->prepare("
        SELECT field, another_field
        WHERE some_foreign_id = ($input_list)");
    $stmt->execute($foreign_ids); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-24T21:25:15.933

这应该是可能的。您需要使用参数的问号动态生成查询，然后在执行时与数组绑定。

请参阅PHP 文档的[PDO::execute](http://php.net/manual/en/pdostatement.execute.php)页面上的*示例 3 。*

# econnect - 在 Great Plains 创建 SOP 发票：eConnect 还是 Web 服务 API？

> ID：12573121
> 
> 赞同：0
> 
> 时间：2012-09-24T21:22:30.480
> 
> 标签：econnect

我们正在使用集成管理器创建一批月度发票。我想构建一个替代品，在 GP 中创建一个批次并将发票导入该批次。审核后，该批次将发布给 GP。这对这些 API 中的任何一个都可行吗？您会选择哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:33:01.860

集成管理器可以使用 econnect 作为其插入引擎。如果您正在处理大量事务，您会注意到集成管理器的 UI 引擎和 econnect 之间的巨大差异。创建新集成时，只需选择 econnect 选项和您设置的任何数据源。

关于非 IM API，两者都可以使用，并且它们是情境化的。Web 服务位于 econnect 之上，它的集成速度要慢得多，因为您要在多个层之间传递信息。它确实在您的 SQL 服务器和任何外部集成源之间提供了安全链接，如果您需要设置一些东西以允许通过诸如计费网关之类的中间件进行集成，它是理想的选择。如果您有权构建一个连接到 GP 的 SQL 服务器的 econnect 进程/应用程序，这是集成 SOP 和应收交易的最快方法。它维护所有业务规则，以帮助确保 GP 不会因补丁而闯入，并且速度足够快，无需定制集成解决方案即可推送数千条记录。

如果您想快速完成工作，并且不介意从集成管理器界面工作，只需使用 econnect 构建您的集成。如果您有时间开发自定义集成例程，请选择 econnect。如果您想在 econnect 之上利用 WCF 技术，请选择 Web 服务。

每个都列出了您从快速实施发展到较慢实施所需的时间。

# .htaccess - 将根目录转发到文件夹，然后删除文件夹的名称，使其看起来像带有 .htacess 的根目录并且在 ie 中兼容

> ID：12573124
> 
> 赞同：0
> 
> 时间：2012-09-24T21:22:38.083
> 
> 标签：.htaccess, redirect

我想将我的根目录“mydomain.com”转发到我的根目录“/oro/”中的文件夹，但页面没有列出文件夹名称“mydomain.com/oro/gold.html”，而是：“ mydomain.com/gold.html" 这可能吗？我有转发部分，但想删除文件夹的名称以使其显示为根。

```
 RewriteEngine on
 RewriteCond %{HTTP_HOST} ^(www.)?mydomain.com$

 RewriteCond %{REQUEST_URI} !^/oro/

 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d

 RewriteRule ^(.*)$ /oro/$1

 RewriteCond %{HTTP_HOST} ^(www.)?mydomain.com$
 RewriteRule ^(/)?$ /oro/index.php [L] 
```

先谢谢了！！

**编辑：**

Jon Lin 的回答是正确的，但在 IE 中中断。任何解决方案都会很棒！

```
 RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /oro/
 RewriteCond %{HTTP_HOST} ^(www.)?mydomain.com$ [NC]
 RewriteRule ^/?oro/(.*)$ /$1 [L,R=301] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:26:35.280

您需要将内容中的所有链接从 URL 更改`/oro/gold.html`为`/gold.html`. 然后对于那些你无法控制的，添加这个：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /oro/
RewriteCond %{HTTP_HOST} ^(www.)?mydomain.com$ [NC]
RewriteRule ^/?oro/(.*)$ /$1 [L,R=301] 
```

# .net-4.0 - K32EnumProcessModules 导致“无法加载由 {dll} 导入的过程”

> ID：12573125
> 
> 赞同：1
> 
> 时间：2012-09-24T21:22:41.147
> 
> 标签：.net-4.0, dll, dependency-walker, windows-kernel

我有一个应用程序依赖于我组织中其他人构建的几个库，其中一个已停止工作。我在命令行中收到此错误：

```
Unhandled Exception: System.IO.FileLoadException: A procedure imported by 'XXX.dll' could not be loaded. 
```

我打开 Dependency Walker 试图找出问题的根源，尽管我应该说我是 Dependency Walker 的新手，我真的不知道自己在做什么。这是我在日志窗口中看到的内容：

```
Error: At least one module has an unresolved import due to a missing export function in an implicitly dependent module. 
```

这似乎很简单，除了：

*   由于我对 DW 不熟悉，我似乎无法找到这个错误实际上指的是*哪个模块*
*   旧版本应用程序附带的同一个 DLL，仍然有效，在 Dependency Walker 中显示相同的内容

我发现新旧 DLL 之间的唯一区别是 KERNEL32.DLL 在较新的 DLL 中显示为红色，而函数 K32EnumProcessModules 显示为红色（未导出）。对于旧 DLL，这个相同的函数根本不会出现（绿色或其他）。

到目前为止总结一下：一个 DLL 有效，另一个无效；在 Dependency Walker 中两者都显示为“坏”，但只有一个函数 K32EnumProcessModules 显示为不好。我不知道这个函数是否是导致“未解决的导入”错误的原因，并想了解一下。

我认为可能导致此问题的唯一更改是将运行时从 .NET 2.5 升级到 .NET 4。此升级是出于与此 DLL 无关的原因进行的，不应影响它：DLL 确实不要对高于 2.5 的 .NET 组件进行任何调用，并且我组织中使用同一库的其他人报告说它在 .NET 4 上运行良好。

我意识到我提供的信息很少，主要是因为我不确定哪些信息可以帮助解决这个问题。如果您希望我进行测试以了解更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-23T09:43:04.617

可能与此有关[https://blogs.msdn.microsoft.com/vcblog/2009/08/27/windows-sdk-v7-0v7-0a-incompatibility-workaround/](https://blogs.msdn.microsoft.com/vcblog/2009/08/27/windows-sdk-v7-0v7-0a-incompatibility-workaround/) 定义 PSAPI_VERSION=1 可能会有所帮助。

# c# - 从单独的 NUnit 测试库中引用主项目

> ID：12573127
> 
> 赞同：4
> 
> 时间：2012-09-24T21:23:03.103
> 
> 标签：c#, unit-testing, nunit, projects-and-solutions

我是单元测试的新手，刚从大学毕业，突然负责自己开发和维护一个相当大的应用程序。之前的开发人员（刚刚离开公司）在项目引用中包含 NUnit，在几个类的底部编写了一些空的测试装置，并且从未用它做任何其他事情。

我担心如果我现在不开始编写单元测试，而我正在重构和学习系统，我将永远无法完成它们，但我无法理解如何正确设置我的测试项目。

有人告诉我，我应该将我的测试项目作为一个单独的解决方案保留`Class Library`在同一个解决方案中，所以我制作了一个 OurApplication.Test 库项目。不过，我不知道如何引用我将在其中测试的项目。

在线指南说将其指向我**的主要项目的 .DLL** ...但**没有**。我们的项目是一个不生成 dll 的独立应用程序，我不确定在这种情况下我应该做什么。

任何关于这里有什么问题的建议，或者指向更全面的指南的指针将不胜感激。我想以正确的方式完成这项工作，并且尽快完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:41:58.803

如果您使用的是 Visual Studio，则可以在解决方案中添加对项目的引用，因为此处引用来自测试项目的控制台应用程序

![在此处输入图像描述](../Images/79b29a879dd9ba8dfbfa3cea72e86bba.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T21:31:47.603

理想情况下，最好将您的应用程序分成基于功能的单独 dll，即将解决方案分成由类型类库项目表示的模块。这将使单独测试这些 dll 变得更简单。我通常为每个模块（项目）设置单独的测试项目。

话虽如此，您可以添加一个 .exe 项目作为对您的 nun it 项目的引用，并获得对所有命名空间和类的访问权限以进行测试，但这不是可维护代码的最佳实践。

# javascript - fullcalendar 记住用户选项，例如。cookie 中的月/周/日

> ID：12573134
> 
> 赞同：11
> 
> 时间：2012-09-24T21:23:54.530
> 
> 标签：javascript, jquery, fullcalendar

如何修改[fullcalendar](http://arshaw.com/fullcalendar/docs/)插件，以便将不同的点击方法`dayClick`等保存在 cookie 中？下次打开此日历时将默认为用户首选项。

已经在使用 cookie 插件：[https ://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js](https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js)

在回答之后更新工作 cookie 代码：

```
var calendarView = (!$.cookie('calendarDefaultView')) ? 'month' : $.cookie('calendarDefaultView');  
$calendar.fullCalendar({
    defaultView: calendarView,
    viewDisplay: function(view){
        $.cookie('calendarDefaultView', view.name, {expires:7, path: '/'});
    }, 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-24T21:52:12.190

您需要的两种全日历方法是：

```
//pull viewName from the cookie or set as default
var viewName='month'; //or basicWeek, basicDay, agendaWeek, agendaDay
$("#fullcalendar").fullCalendar( 'changeView', viewName ); 
```

和

```
$('#fullcalendar').fullCalendar({
        viewDisplay: function( view )
        {
           //save your cookie here, it's triggered each time the view changes
        }
}); 
```

这应该使您走上正确的道路。我没有考虑保存 cookie b/c 我认为你已经控制住了。

# iphone - TestFlight：应用程序可执行文件包含不受支持的架构：armv7s

> ID：12573136
> 
> 赞同：2
> 
> 时间：2012-09-24T21:24:10.010
> 
> 标签：iphone, objective-c, ios, xcode, testflight

我正在尝试通过试飞构建一个临时构建。

我选择了 OS 设备并正在尝试创建存档。

但是我收到以下警告。

```
(null):  iPhone/iPod Touch: application executable contains unsupported 
 architecture(s): armv7s (-19031) 
```

我的试飞目标有以下设置。

![在此处输入图像描述](../Images/6a61ec95d4575697aa25f9979e8a42c1.png)

我可以很好地发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:15:15.790

看起来您正在使用旧版本的 TestFlight 库。

iPhone 5 使用新的处理器 (A6)，并带有修改后的指令集 (AMRv7s)。
由于您也在使用该架构构建应用程序，因此所有链接库也需要支持它。

TestFlight 提供了其库的新版本 (1.1)，支持该特定架构。
因此，只需下载新版本的库，链接到它，就可以了。

您的“发布”目标正在编译和链接正常，因为实际上没有使用 TestFlight 库中的符号。但如果您需要 iPhone 5 的 TestFlight 支持，只需更新到最新版本的库即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T05:37:29.500

当您使用 armv7 设备归档应用程序时，此警告是完全正常的。

想一想，您制作了一个包含 armv7s 架构（这是我们想要的）的存档，并且警告告诉您您的 armv7 设备不支持该架构（这完全有道理）。

为了进一步证明这一点，只需连接 iPhone 5 并尝试存档，您就会看到警告消失了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T20:53:48.103

据我所知，Xcode 4.5 目前不允许您创建包含 armv7s 的存档构建。

我的项目使用了两个 3rd 方库（Dropbox 和 Flurry），并且我再次确认我包含了最新的 iOS 6 版本。我验证了我所有的其他框架（和 libsqlite3.0.dylib）都位于 iOS 6.0 区域。这些都没有帮助。

然后我从头开始创建了一个全新的空项目并尝试了存档构建并收到完全相同的错误。因此，在浪费了 6 个小时试图解决这个问题之后，我暂时得出结论，无法摆脱警告。

根据其他评论，显然没有必要为 armv7s 构建以在 iPhone 5 上运行。

任何与我在此处发布的内容相反的信息将不胜感激。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T21:38:13.800

您需要做的就是从有效架构中删除 armv7s。

我认为同样的问题已经被问了几个关系。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-26T14:56:34.443

当我存档以准备 Ad-Hoc 测试时，我收到了相同的警告消息。

```
(null):  iPhone/iPod Touch: application executable contains unsupported 
 architecture(s): armv7s (-19031) 
```

我已经按照上面的建议删除了 armv7s，警告消失了。这样做有什么影响？armv7s 支持什么？

从昨天开始几乎没有对任何设置或代码进行任何更改，是什么原因导致此警告弹出？

# sql - 如何在 oracle 中对单个搜索结果使用 ORDER BY？

> ID：12573139
> 
> 赞同：0
> 
> 时间：2012-09-24T21:24:31.333
> 
> 标签：sql, oracle

我在 oracle 中做了一个小查询，以首先匹配开头的 WHEN 子句结果和最后匹配的 WHEN 子句结果的方式显示搜索结果。现在我想按 DESC 顺序对第一个匹配的结果进行排序，其余结果按升序排列。

以下是使用的示例数据。

```
CREATE table test(id int, title varchar(50), place varchar(20), 
postcode varchar(20));
insert into test values(1,'gatla51','hyd','31382');
insert into test values(2,'sekhar91','kanigiri','91982');
insert into test values(3,'ravi32','ongole','41482');
insert into test values(4,'reddy42','guntur','31281'); 
```

这是我所做的查询（当然有人帮助，因为我对 oracle 很陌生）：

```
select title, place, postcode
from (select title, place, postcode,
             (case when postcode like '%9%' then 1
                   when place LIKE '%9%' then 2
                   when title LIKE '%9%' then 3
                   else 0
              end) as matchresult
      from test
     ) d
where matchresult > 0
order by CASE WHEN postcode LIKE %9% THEN ZIP END DESC 
```

但是这个查询正在对所有结果进行排序。我如何对个人结果进行排序，建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:34:14.473

```
select title, place, postcode
from (select title, place, postcode,
             (case when postcode like '%9%' then 1
                   when place LIKE '%9%' then 2
                   when title LIKE '%9%' then 3
                   else 0
              end) as matchresult
      from test
     ) d
where matchresult > 0
order by CASE WHEN MATCHRESULT = 1 THEN ZIP END DESC NULLS LAST,
         CASE WHEN MATCHRESULT = 2 THEN PLACE END,
         CASE WHEN MATCHRESULT = 3 THEN TITLE END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:35:14.940

这是一种方法。注意 ORDER BY 子句：

```
select title, place, postcode
from (select title, place, postcode,
             (case when postcode like '%9%' then 1
                   when place LIKE '%9%' then 2
                   when title LIKE '%9%' then 3
                   else 0
              end) as matchresult                 
      from test
     ) d
where matchresult > 0
order by matchresult,
         (case when matchresult = 1 then postcode end) desc,
         (case when matchresult = 2 then place
               when matchresult = 3 then title
          end) asc 
```

# ios - 如何永久显示 UIScrollView 滚动条而不仅仅是闪烁？

> ID：12573142
> 
> 赞同：3
> 
> 时间：2012-09-24T21:24:32.980
> 
> 标签：ios, cocoa-touch, uiscrollview, interface-builder

我为 iPad 构建的应用程序有多个文本字段。所以我不得不使用滚动视图。我想永久显示滚动条，以便用户知道底部还有更多字段。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:28:54.867

据我所知，不可能永久显示滚动条。

Apple 建议使用以下方式闪烁滚动条：

```
[theScrollView flashScrollIndicators]; 
```

# virtualbox - Xen 映像到 VirtualBox - 无法从引导介质中读取

> ID：12573148
> 
> 赞同：0
> 
> 时间：2012-09-24T21:25:14.517
> 
> 标签：virtualbox, xen

我在将 xen img 移动到虚拟盒子时遇到问题。执行以下命令后，我将新创建的 vdi 文件设置为我的虚拟机的 Primary Master。

> VBoxManage convertdd disk.img vb.vdi

但它一直在抱怨标题中的错误。下面的命令也发生了同样的事情：

> VBoxManage convertfromraw disk.img vb.vdi

我该如何解决这个问题？

任何帮助表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:15:29.980

XEN 不使用“真正的”引导扇区，因此在 VirtualBox 中没有可供您引导的扇区。

您需要在您的 VB 上启动一个 live linux 并尝试自己修复您的引导扇区。这在很大程度上取决于您使用的发行版，但它可以完成并且应该非常简单。

# visual-studio-2010 - 发布 MVC4 WebAPI 应用程序的正确方法是什么？

> ID：12573157
> 
> 赞同：0
> 
> 时间：2012-09-24T21:25:55.583
> 
> 标签：visual-studio-2010, asp.net-mvc-4, asp.net-web-api

我已经在本地机器上完成了一个 WebAPI 应用程序。但是当我将它发布到测试服务器上时，站点根文件夹中没有`~\Api`文件夹。

然后我选择该文件夹下的每个文件，所有这些都是 ApiControllers 并且在属性中，我设置`Build Action`为 be`Compile`和`Copy to Output Directory`into `Copy if newer`，认为这一定是正确的方法。

但是，我发现所有的 ApiControllers 都被上传到`~/bin/Api`. 因此，每个 Api 调用都会返回一个`404 Not Found`.

设置发布设置的正确方法是什么？

# c# - 如何使用返回父类的函数初始化子类？

> ID：12573158
> 
> 赞同：0
> 
> 时间：2012-09-24T21:25:56.037
> 
> 标签：c#, xml, inheritance

我已将`DataTable`课程扩展如下：

```
class DataTableExtended:DataTable
    {
        public void specialMethod()
        {}
    } 
```

我想将一个 XML 节点解析到这个子类中，我尝试使用以下方法：

```
public DataTableExtended parseNodeToDataTable()
        {
            DataSet ds = new DataSet();
            XmlNodeReader reader = new XmlNodeReader(this.resultNodes);
            ds.ReadXml(reader);
            DataTable dt = ds.Tables[1];
            DataTableExtended dte=(DataTableExtended) dt;
            return dt;
        } 
```

它正在抛出一个`InvalidCastException`. 从我到目前为止所读到的，这是因为不可能将父类转换为子类。那准确吗？如果是这样，我知道我可以重写`DataTableExtended`构造函数，以便它接受一个`DataTable`参数并复制该表的信息，但我希望有一种更直接的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:38:05.033

我会为 DataTable 编写一个扩展方法而不是对其进行子类化

```
public static class DataTableExtensions
{
    public static void SpecialMethod(this DataTable dt)
    {
        //do something
    }
} 
```

--

```
DataTable dt = .........
dt.SpecialMethod(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:37:04.417

我喜欢将运算符读`:`为`is a`. 所以 a`DataTableExtended`是 a `DataTable`。请注意，这并不*意味着*a`DataTable`是 a `DataTableExtended`，因此无法强制转换。

我认为按照您的建议，在这个方向上“强制转换”的最佳方法是在构造函数中获取基类的实例。

另请参阅[此答案](https://stackoverflow.com/a/9885823/1344760)。

# c++ - 是否有更好的方法来处理将身份分配给层次结构中的类以供运行时使用？

> ID：12573163
> 
> 赞同：3
> 
> 时间：2012-09-24T21:26:17.167
> 
> 标签：c++, oop, polymorphism, typeid

我正在尝试对我的事件系统进行合理可用的实现。为了识别事件类型，我有我所谓的“类型路径”，它通过层次结构识别事件类型的路径。这样，例如，我可以在一个地方处理所有 InputEvents，无论它们是否是关键按下，鼠标输入或其他任何东西。但是，一个棘手的问题是为事件类型赋予其身份。我最近所做的是通过让每个实例从 Event 类的静态成员函数中检索叶身份来做到这一点, 它只是作为一个接口而不是执行这个功能. 但是, 确保每个*类型的最简单方法*在这个结构中只有一个身份似乎是使用基于类型路径（直到但不包括叶身份/标识符）和 typeid().hash_code() 的映射。

具体来说，我想要的是一个可以轻松添加事件的系统，而无需查找大量信息或执行大量愚蠢的样板废话。考虑到这一点（可能还有我没有意识到我应该想要的东西？），

1.  这种设计是否有任何明显的缺陷？
2.  有没有比使用 typeid() 更好的方法？我已经阅读了一些关于它的内容，它似乎被认为是某种东西，取决于被询问意见的人，要么永远不要使用，要么*几乎*永远不要使用。因为我可能只是生疏或愚蠢，我想知道是否有人知道一个解决方案，如果没有别的，那么不确定性（显然 typeid() 的一些实现非常糟糕，虽然我不知道'不知道是哪个，或者它是否足以严重影响）。

我现在拥有的相当简单的例子：

```
#include <iostream>
#include <vector>
#include <typeinfo>
#include <map>

void spew(std::vector<unsigned int> vect) { for (unsigned int i=0;i<vect.size();++i) std::cout << vect.at(i) << ","; std::cout << std::endl; }

class Foo
{
public:
    Foo() {}
    virtual ~Foo() {}
    static unsigned int getSubtype(std::vector<unsigned int> typePath, Foo *evt)
    {
        static std::map<std::vector<unsigned int>, std::map<std::size_t, unsigned int> > typeMap;
        std::size_t typehash = typeid(*evt).hash_code();
        if (typeMap.find(typePath) == typeMap.end())
        {
            unsigned int val = typeMap[typePath].size();
            typeMap[typePath][typehash] = val;
            return val;
        }
        else
        {
            if (typeMap[typePath].find(typehash) == typeMap[typePath].end())
            {
                unsigned int val = typeMap[typePath].size();
                typeMap[typePath][typehash] = val;
                return val;
            }
            return typeMap[typePath][typehash];
        }
    }
    virtual void test() { std::cout << "Foo" << std::endl; }
protected:
    std::vector<unsigned int> m_typePath;
};

class Bar : public Foo
{
public:
    Bar()
    {
        m_typePath.push_back(Foo::getSubtype(m_typePath, this));
        test();
    }
    virtual ~Bar() {}
    virtual void test() { std::cout << "Bar: "; spew(m_typePath);}
};

class Baz : public Foo
{
public:
    Baz()
    {
        m_typePath.push_back(Foo::getSubtype(m_typePath, this));
        test();
    }
    virtual ~Baz() {}
    virtual void test() { std::cout << "Baz: "; spew(m_typePath);}
};

class Qux : public Baz
{
public:
    Qux()
    {
        m_typePath.push_back(Foo::getSubtype(m_typePath, this));
        test();
    }
    virtual ~Qux() {}
    virtual void test() { std::cout << "Qux: "; spew(m_typePath);}
};

int main()
{
    Foo foo0;
std::cout << "----" << std::endl;
    Bar bar0;
std::cout << "----" << std::endl;
    Baz baz0;
std::cout << "----" << std::endl;
    Qux qux0;
} 
```

输出：

```
----
Bar: 0,
----
Baz: 1,
----
Baz: 1,
Qux: 1,0, 
```

要清楚，这个和其他测试表现出所需的行为。
编辑：以前的标题与我的意思不符。可能相关的注释：这适用于库的一部分，并且是高度并行的。为了表示设计的简单性，我省略了与并发相关的代码，但这些信息可能对设计目的也很有用。另请注意，我仍然只是在创建/分配类型标识符方面寻求帮助；我之所以提到这些，是因为考虑到它们的隐含约束，某些设计可能不适用。

Win 编辑：嗯，我有一个非常快的实现，并且完全符合我的需要。使用一些派生类，我可以在派生类中为每个线程实例化一千万个（我在 TBB 中添加了一些其他测试；它可能会或可能不会使用八个线程，但它可以随意）分布在派生类中，每个线程都有两个或多个元素它的路径，通常在 0.02 秒以下。最初的实现根据容器等管理大约四到五秒，这很愚蠢。结果（无论如何，足以得到这个想法）：

```
template<typename T> class EventID
{
public:
    static const std::size_t typeID;
};

template<typename T> const std::size_t EventID<T>::typeID = typeid(T).hash_code();

class Foo
{
public:
    Foo()
    {
        m_typePath.push_back(EventID<Foo>::typeID);
    }
protected:
    neolib::vecarray<std::size_t, 100, neolib::nocheck> m_typePath;
};

class Bar : public Foo
{
public:
    Bar()
    {
        m_typePath.push_back(EventID<Bar>::typeID);
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T20:02:50.813

我将依赖编译器维护的类层次结构，以及类型代码列表：

```
typedef enum { EVENT, INPUT, MOUSE, MOUSEDOWN, MOUSEUP, MOUSEMOVE, KEYBOARD, KEYDOWN, KEYUP } EventType;

typedef std::vector<EventType> ETVector;

class Event
{
public:
    virtual void appendType(ETVector& v) { v.push_back(EVENT); }
};

class InputEvent : public Event
{
public:
    virtual void appendType(ETVector& v) { v.push_back(INPUT); Event::appendType(v); }
};

class MouseEvent : public InputEvent
{
public:
    virtual void appendType(ETVector& v) { v.push_back(MOUSE); InputEvent::appendType(v); }
};

class MouseDownEvent : public MouseEvent
{
public:
    virtual void appendType(ETVector& v) { v.push_back(MOUSEDOWN); MouseEvent::appendType(v); }
};

class MouseUpEvent : public MouseEvent
{
public:
    virtual void appendType(ETVector& v) { v.push_back(MOUSEUP); MouseEvent::appendType(v); }
};

class MouseMoveEvent : public MouseEvent
// . . .

class KeyboardEvent : public InputEvent
// . . .

class KeyDownEvent : public KeyboardEvent
// . . .

class KeyUpEvent : public KeyboardEvent
// . . . 
```

然后做你的测试，你会有这样的事情：

```
KeyUpEvent kue;

EventTypeVector type_path;

kue.appendType(type_path);

for (EventTypeVector::const_iterator i = type_path.begin(); i != type_path.end(); i++)
{
    cout << *i << endl;
} 
```

向量存储您的类型路径。没有运行时存储成本，也没有`static`变量。可以使用`typeid`而不是手动维护的枚举，但是使用枚举，一切都在您的控制之下，并且您可以轻松避免与程序中的其他类型发生冲突。或者，可以`appendType()`通过模板为类注入方法，以进一步减少代码。

必须在 中显式命名父类有点乏味`appendType()`，但由于多重继承，我知道 C++ 中没有其他方法。在 Java 中我可以使用`super`，尽管反射可能是更好的方法。

这比你所拥有的更简单，还是我错过了什么？祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T02:43:01.603

请参阅对原始帖子的最终编辑以获取解决方案。

# mysql - mysql UNION 结果的行数少于表行数的总和

> ID：12573164
> 
> 赞同：12
> 
> 时间：2012-09-24T21:26:18.243
> 
> 标签：mysql, union, rowcount

我`UNION`用来获取不同表中的所有名称。
我的表总共有大约 10000 行。
但查询返回 468 行！！
我的查询是：

```
SELECT name FROM `shopping` 
UNION 
SELECT name FROM stores 
UNION 
SELECT name FROM concert 
UNION 
SELECT val AS name FROM event 
UNION 
SELECT name FROM fastfood 
```

哪里有问题？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-24T21:27:59.983

UNION 删除重复值。您可能想要 UNION ALL 代替。

# java - 为什么 RAD (Eclipse) 不能正确检测 WAS 服务器启动？

> ID：12573166
> 
> 赞同：2
> 
> 时间：2012-09-24T21:26:36.357
> 
> 标签：java, websphere, rad

如果我在 RAD 8.0.4.1 下启动 WAS 6.1，我会在控制台中看到服务器启动：

```
[9/24/12 17:21:18:671 EDT] 0000000a WsServerImpl  A   WSVR0001I: Server server1 open for e-business 
```

RAD 继续在进度窗格中指示它正在等待服务器启动：“在 localhost 上启动 WebSphere Application Server v6.1”。这很痛苦，因为它最终超时并告诉我服务器从未启动，即使它正在运行并响应请求，并且似乎这种状态意味着在我更改代码时发布更新无法正常工作。

在服务器启动期间，我在控制台中看不到任何错误 - WebSphere 6.1 Launcher 的控制台也是如此。

有没有简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T00:22:01.660

我相信这个问题已经被问过几次了。

阅读此技术说明，看看这些建议是否有帮助

[http://www-01.ibm.com/support/docview.wss?uid=swg21207553](http://www-01.ibm.com/support/docview.wss?uid=swg21207553)

高温高压

# user-interface - Google Maps V3 - 在标签中，点击标签时触发调整大小，getBounds 对地图边界感到困惑

> ID：12573168
> 
> 赞同：1
> 
> 时间：2012-09-24T21:26:37.120
> 
> 标签：user-interface, tabs, maps

我在 jQuery UI 选项卡中发现了 Maps V3 的一些奇怪之处。一个常见的问题是，当地图在隐藏选项卡中初始化时，它会感到困惑并且不知道要制作多大的地图。解决方案是：

```
$('#tabs').tabs({show: function(e, ui) {if (ui.index == 5) {google.maps.event.trigger(map, "resize");   }     }}); 
```

这很好用。该映射在选项卡中直观地调整大小。

下一个问题（可能不太常见）是我想根据网站用户的 latLng 加载标记。当我尝试通过 init 函数加载它们时，getBounds 似乎是相同的......我认为这是同一个问题。地图对负载大小感到困惑。

像调整大小的触发器一样，有没有办法在初始化后触发函数并传递地图 DOM 信息？我对此很陌生！

# api - 通过 URL 从 LinkedIn API 检索个人资料

> ID：12573169
> 
> 赞同：1
> 
> 时间：2012-09-24T21:26:38.557
> 
> 标签：api, linkedin

正如[API 所建议](https://developer.linkedin.com/documents/profile-api)的那样，我应该能够使用公共个人资料 URL 访问我（或任何其他人的）个人资料信息。但是，使用[Rest 控制台](https://developer.linkedin.com/rest-console)我无法获得正确的结果。

这两个我都试过了： `http://api.linkedin.com/v1/people/url=http%3a%2f%2fwww.linkedin.com%2fpub%2falireza-noori%2f51%2fa99%2fba9`

`http://api.linkedin.com/v1/people/url=http%3a%2f%2fwww.linkedin.com%2fpub%2falireza-noori%2f51%2fa99%2fba9:public`

他们都没有工作。结果是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<error>
  <status>401</status>
  <timestamp>1348521763449</timestamp>
  <request-id>6MGM1IK1U7</request-id>
  <error-code>0</error-code>
  <message>[unauthorized]. OAU:w_vW1JF73R-J97_wH3_Iut3i7kL9netWMe90_OMcAkI9mVWggQzip-ssCmwKWyJU|*01|*01|*01:1348521763:ZN/JXOqHRNm4wKsDX+vzlbSC3yY=</message>
</error> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T00:09:39.133

这看起来像是 REST 控制台的问题：

[https://developer.linkedin.com/comment/16197#comment-16197](https://developer.linkedin.com/comment/16197#comment-16197)

# qt - Qt DBus registerService 函数调用在嵌入式 Linux 设备上返回 false

> ID：12573175
> 
> 赞同：1
> 
> 时间：2012-09-24T21:27:11.130
> 
> 标签：qt, embedded-linux, dbus

我是 DBus 的新手，但我试图在嵌入式设备上的两个 Qt 应用程序中使用它。我有一个非常简单的界面，由一个插槽组成：

```
QString SendMessage(const QString &cmd); 
```

然后，服务器应用程序使用以下代码启动连接：

```
 DbusService* dBus = new DbusService;
    new interfaceIfAdaptor(dBus);

    QDBusConnection connection = QDBusConnection::sessionBus();
    bool ret = connection.registerService("com.domain.project.interface");
    qDebug() << "returns" << ret;
    ret = connection.registerObject("/", dBus);
    qDebug() << "returns" << ret; 
```

**这在桌面上运行良好**。在嵌入式系统中，connection.registerService 函数返回 false。因此，发送到服务器的任何消息都会失败。我不确定为什么。运行 'ps' 告诉我 [dbus-daemon —system] 和 [dbus-daemon —sesson] 都在运行。

最后，我注意到当我调试应用程序时 Qt Creator 会抱怨。我看到以下警告消息：

> 无法为 10 个库加载共享库符号，例如 /opt/arm/lib/libQtDBus.so.4。
> 
> 使用“info sharedlibrary”命令查看完整列表。
> 
> 你需要“set solib-search-path”还是“set sysroot”？
> 
> 无法为 /usr/lib/libdbus-1.so.3 加载共享库符号。
> 
> 你需要“set solib-search-path”还是“set sysroot”？

如果需要其他信息来调试此问题，请告诉我。或者，如果有有用的 dbus 命令我可以运行来帮助解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T15:54:59.540

事实证明会话总线没有在设备上启动。我启用了它，但后来我遇到了地址没有传播到环境变量的问题。我可以在终端中手动设置它，但我不确定如何在 Qt Creator 中做同样的事情。

无论如何，我没有花更多时间解决会话总线的问题，而是转而使用系统总线。我只需要更改 /etc/dbus-1/system.conf 文件以允许任何人与系统总线通信，并且我的应用程序可以在嵌入式设备上运行。我知道这可能不是长期解决方案，但它现在有效。

# .net - 部署到远程服务器时出现实体框架架构错误

> ID：12573176
> 
> 赞同：0
> 
> 时间：2012-09-24T21:27:13.290
> 
> 标签：.net, entity-framework, .net-4.0, ef-code-first

我首先使用 EF 代码来创建数据库。在开发中效果很好。我将它复制到 Windows Server 2003 框中，我收到这些错误（如下所列）

EF 5，.NET 4.0。

我已经卸载并重新安装了 .net 4 框架。以及在其他机器上测试。

在我的 Windows Server 2008 机器上，它运行良好。在另一个 2003 年的盒子上它没有。

为了将 MVC 排除在外，我构建了一个简单的控制台应用程序，列出了数据库中的一些数据。- 那里同样的错误。

我在 VS 2012 中编写了所有内容，并在机器上安装了 .net 4.5。我读到这可能会导致问题，因此我在 VS 2010 中针对 .net 4 重新编写了所有内容，并手动添加了对 EF 5/.net4 dll 的引用。同样的事情，在我的 2 台开发机器和 2008 服务器上运行良好，但不是 2003。

**错误：**

```
Schema specified is not valid. Errors: 
(0,0) : warning 0005: Could not find schema information for the attribute 'Namespace'. 
(0,0) : warning 0005: Could not find schema information for the attribute 'Provider'. 
(0,0) : warning 0005: Could not find schema information for the attribute 'ProviderManifestToken'.
(0,0) : warning 0005: Could not find schema information for the attribute 'Alias'.
(0,0) : error 0010: The element Schema in namespace http://schemas.microsoft.com/ado/2009/11/edm/ssdl was unexpected for the root element.  The expected Schema in one of the following namespaces:  http://schemas.microsoft.com/ado/2006/04/edm/ssdl, http://schemas.microsoft.com/ado/2009/02/edm/ssdl. 
```

这是堆栈跟踪（这是一个 MVC 应用程序）

```
[MetadataException：指定的架构无效。错误：
(0,0)：警告 0005：找不到属性“命名空间”的架构信息。
(0,0)：警告 0005：找不到属性“提供者”的架构信息。
(0,0)：警告 0005：找不到属性“ProviderManifestToken”的架构信息。
(0,0)：警告 0005：找不到属性“别名”的架构信息。
(0,0)：错误 0010：命名空间 http://schemas.microsoft.com/ado/2009/11/edm/ssdl 中的元素架构对于根元素来说是意外的。以下命名空间之一中的预期架构：http://schemas.microsoft.com/ado/2006/04/edm/ssdl、http://schemas.microsoft.com/ado/2009/02/edm/ssdl。 ]
   System.Data.Metadata.Edm.Loader.ThrowOnNonWarningErrors() +8508793
   System.Data.Metadata.Edm.Loader.LoadItems（IEnumerable`1 xmlReaders，IEnumerable`1 sourceFilePaths）+181
   System.Data.Metadata.Edm.StoreItemCollection.Init(IEnumerable`1 xmlReaders, IEnumerable`1 filePaths, Boolean throwOnError, DbProviderManifest& providerManifest, DbProviderFactory& providerFactory, String& providerManifestToken, Memoizer`2& cachedCTypeFunction) +211
   System.Data.Metadata.Edm.StoreItemCollection..ctor（IEnumerable`1 xmlReaders）+295
   System.Data.Entity.Migrations.Extensions.XDocumentExtensions.GetStoreItemCollection（XDocument 模型，DbProviderInfo&providerInfo）+180
   System.Data.Entity.Migrations.Infrastructure.EdmModelDiffer.Diff(XDocument sourceModel, XDocument targetModel, String connectionString) +48
   System.Data.Entity.Internal.InternalContext.ModelMatches（XDocument 模型）+45
   System.Data.Entity.Internal.ModelCompatibilityChecker.CompatibleWithModel(InternalContext internalContext, ModelHashCalculator modelHashCalculator, Boolean throwIfNoMetadata) +65
   System.Data.Entity.Internal.InternalContext.CompatibleWithModel（布尔 throwIfNoMetadata）+52
   System.Data.Entity.CreateDatabaseIfNotExists`1.InitializeDatabase（TContext 上下文）+239
   System.Data.Entity.Internal.c__DisplayClass8.b__6() +19
   System.Data.Entity.Internal.InternalContext.PerformInitializationAction（动作动作）+72

[DataException：初始化数据库时发生异常。有关详细信息，请参阅 InnerException。]
   System.Data.Entity.Internal.InternalContext.PerformInitializationAction（动作动作）+117
   System.Data.Entity.Internal.InternalContext.PerformDatabaseInitialization() +186
   System.Data.Entity.Internal.LazyInternalContext.b__4(InternalContext c) +7
   System.Data.Entity.Internal.RetryAction`1.PerformAction(TInput 输入) +118
   System.Data.Entity.Internal.LazyInternalContext.InitializeDatabaseAction(Action`1 action) +190
   System.Data.Entity.Internal.LazyInternalContext.InitializeDatabase() +73
   System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +28
   System.Data.Entity.Internal.Linq.InternalSet`1.Initialize() +56
   System.Data.Entity.Internal.Linq.InternalSet`1.GetEnumerator() +15
   System.Data.Entity.Infrastructure.DbQuery`1.System.Collections.Generic.IEnumerable.GetEnumerator() +40
   System.Collections.Generic.List`1..ctor（IEnumerable`1 集合）+315
   System.Linq.Enumerable.ToList(IEnumerable`1 源) +58
   C:\Dev\hbkiosk\Kiosk\Controllers\KioskEventController.cs:23 中的 Kiosk.Controllers.KioskEventController.Index()
   lambda_method（闭包，ControllerBase，对象[]）+62
   System.Web.Mvc.ActionMethodDispatcher.Execute（ControllerBase 控制器，Object[] 参数）+17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 参数) +188
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 参数) +27
   System.Web.Mvc.Async.c__DisplayClass42.b__41() +28
   System.Web.Mvc.Async.c__DisplayClass8`1.b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult) +29
   System.Web.Mvc.Async.c__DisplayClass39.b__33() +59
   System.Web.Mvc.Async.c__DisplayClass4f.b__49() +240
   System.Web.Mvc.Async.c__DisplayClass37.b__36(IAsyncResult asyncResult) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +31
   System.Web.Mvc.Async.c__DisplayClass2a.b__20() +23
   System.Web.Mvc.Async.c__DisplayClass25.b__22(IAsyncResult asyncResult) +128
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +26
   System.Web.Mvc.c__DisplayClass1d.b__18(IAsyncResult asyncResult) +14
   System.Web.Mvc.Async.c__DisplayClass4.b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +41
   System.Web.Mvc.Async.c__DisplayClass4.b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +28
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +10
   System.Web.Mvc.c__DisplayClass8.b__3(IAsyncResult asyncResult) +28
   System.Web.Mvc.Async.c__DisplayClass4.b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +30
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8836913
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T18:07:21.500

我可以通过更改我的连接字符串来解决这个问题，让 ef 使用项目上安装的正确 dll 创建新的数据库。然后我将数据从旧数据库迁移到新数据库。

我的假设是 EF 5 代码在数据库中存储了一些元数据（尽管我无法验证这一点）。由于如果数据库不存在，EF 代码首先会创建 db/schema，所以我只是将连接字符串更改为不存在的数据库，运行项目并让 EF 构建数据库，然后从创建的数据库中迁移现有数据由 V.5 到由 v.4 创建的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T22:35:34.737

我将 .NET Framework 更新到 4.5 并且它工作正常。

# c# - 如何消除此错误 GDI+ 中发生一般错误。？

> ID：12573177
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:27:13.750
> 
> 标签：c#, asp.net

```
private void Form2_Load(object sender, EventArgs e)
    {
        con1.Open();

        Form1 home = new Form1();
        home.MdiParent = this.MdiParent ;

        System.Timers.Timer timer1 = new System.Timers.Timer();
        Directory.CreateDirectory(Environment.GetFolderPath(Environment.SpecialFolder.MyComputer)  + @"\\server1\KamalSingh\ScreenCaptures");
        t.Interval  = 500;
        t.Tick += new EventHandler(StartThread);
        t.Start();
     }

   System.Windows.Forms.Timer t = new  System.Windows.Forms.Timer();
   //Thread tt;   

   private static Bitmap bmpscreenshot;
   private static Graphics gfxscreenshot;

    void TakeScreenShot()
    {

        bmpscreenshot = new Bitmap(Screen.PrimaryScreen.Bounds.Width,Screen.PrimaryScreen.Bounds.Height,PixelFormat.Format32bppArgb);
        gfxscreenshot = Graphics.FromImage(bmpscreenshot );
        gfxscreenshot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X,Screen.PrimaryScreen.Bounds.Y,0,0,Screen.PrimaryScreen.Bounds.Size,CopyPixelOperation.SourceCopy );
        bmpscreenshot.Save(Environment.GetFolderPath(Environment.SpecialFolder.MyComputer) +@"\\server1\KamalSingh\ScreenCaptures\.bmp", ImageFormat.Png);
      //  tt.Abort();
    }

     protected  void StartThread(object sender, EventArgs e)
     {
         Thread th  = new Thread(new ThreadStart(TakeScreenShot));
         th.SetApartmentState(ApartmentState.STA );
         th.Start();
         Thread.Sleep(100);
         th.Join();

     } 
```

我想修复在执行程序时发生的这个错误。错误会在一段时间后出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:32:28.677

尝试这个：

```
void TakeScreenShot()
{

    using(Bitmap bmpscreenshot = new Bitmap(Screen.PrimaryScreen.Bounds.Width,Screen.PrimaryScreen.Bounds.Height,PixelFormat.Format32bppArgb))
    {
        using(Graphics gfxscreenshot = Graphics.FromImage(bmpscreenshot))
        {
            gfxscreenshot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X,Screen.PrimaryScreen.Bounds.Y,0,0,Screen.PrimaryScreen.Bounds.Size,CopyPixelOperation.SourceCopy );
            bmpscreenshot.Save(Environment.GetFolderPath(Environment.SpecialFolder.MyComputer) +@"\\server1\KamalSingh\ScreenCaptures\.bmp", ImageFormat.Png);
        }
    }
} 
```

希望这可以帮助！

# c# - 使用 WebBrowser 控件从磁盘加载多个 HTML 文件

> ID：12573182
> 
> 赞同：0
> 
> 时间：2012-09-24T21:27:34.890
> 
> 标签：c#, .net, winforms, webbrowser-control

我正在尝试在`WebBrowser`控件中显示 HTML 文件（包含本地图像）。用户可以使用 选择文件`OpenFileDialog`，然后将其显示在控件中。

但我有这些我正在努力解决的问题：

1.  自从我将控件添加到 my`Form`后，它的加载速度非常缓慢。表单实例化大约需要 10 秒。

2.  `WebBrowser.Navigate`只在第一次工作。当我尝试加载第二个文件时，没有任何反应。我曾尝试调用`Refresh`, `Update`, `OpenNew`, 在两个文件之间打开`about:blank`，但我只是不知道如何正确执行此操作。仅显示最初打开的文件，当我尝试导航到其他页面时，不会弹出任何异常或警告。

难道我做错了什么？例如，[Lutz Roeder 的 Writer](http://www.lutzroeder.com/dotnet/#writer)立即启动并毫无问题地加载后续文件，但它使用大量互操作（并且是可编辑的），所以我试图避免所有这些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:42:57.613

我将本地`.html`文件加载到 a中的`WebBrowser`方式是这样的：

```
OpenFileDialog ofd = new OpenFileDialog();
// Do filtering here
if (ofd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
{
    webBrowser1.DocumentText = System.IO.File.ReadAllText(ofd.FileName);
} 
```

它可以毫无问题地一个接一个地加载文件。如果您在表单初始化或打开时尝试加载一个大的 html 文件，这可以解释 10 秒的加载时间。`WebBrowser`当我的表单上有控件时，它几乎立即加载。

希望这可以帮助！

**编辑：**尝试设置流`WebBrowser`：

```
System.IO.Stream s = System.IO.File.OpenRead(ofd.FileName);
webBrowser1.DocumentStream = s; 
```

# java - java.lang.NullPointerException Spring Mvc

> ID：12573183
> 
> 赞同：1
> 
> 时间：2012-09-24T21:27:40.600
> 
> 标签：java, xml, spring, spring-mvc, nullpointerexception

我得到一个 java.lang.NullPointerException：

我为 validateUserNameManager 设置了 getter 和 setter。我正在使用基于 xml 的配置，而不是使用 @Autowire。当处理到达 validateUserNameManager 时，它会得到 NP 异常，我不确定我的配置和接线是否准确。

```
if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true){

                    errors.rejectValue("userName", "userName.exist");
                } 
```

**OfficeRegistrationValidation.java**

```
public class OfficerRegistrationValidation implements Validator{

    private final Logger logger = Logger.getLogger(getClass());

    private ValidateUserNameManager validateUserNameManager;

    public boolean supports(Class<?> clazz) {

        return Officers.class.equals(clazz);
    }

    public void validate(Object target, Errors errors) {

        Officers officer = (Officers) target;

        if (officer.getUserName() == null){

            errors.rejectValue("userName", "userName.required");

        }else{

            String userName = officer.getUserName();                    

            logger.info("OfficerRegistrationValidation - UserName is not null so going to check if its valid for :" + userName);

            try {

                logger.info("OfficerRegistrationValidation - Just before try.....catch block...userName is :" + userName);  

                logger.info("OfficerRegistrationValidation - about to evaluate if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true)" );

                if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true){

                    errors.rejectValue("userName", "userName.exist");
                }
            } catch (Exception e) {

                logger.info("OfficerRegistrationValidation - Error Occured When validating UserName");
                logger.error("Message", e);
                errors.rejectValue("userName", "userName.error");
            }

        }

/**
     * @return the validateUserNameManager
     */
    public ValidateUserNameManager getValidateUserNameManager() {
        logger.info("Getting - ValidateUserNameManager");
        return validateUserNameManager;
    }

    /**
     * @param validateUserNameManager the validateUserNameManager to set
     */
    public void setValidateUserNameManager(
            ValidateUserNameManager validateUserNameManager) {

        logger.info("Setting - ValidateUserNameManager");
        this.validateUserNameManager = validateUserNameManager;
    }       

} 
```

**应用程序上下文.xml**

```
<bean id="officerRegistrationValidation" class="com.crimetrack.service.OfficerRegistrationValidation">

        <property name="validateUserNameManager" ref="validateUserNameManager"/>
</bean>

<bean id="validateUserNameManager" class="com.crimetrack.service.ValidateUserNameManager">
        <property name="officerDao" ref="officerDao"/>
</bean>

<bean id="officerDao" class="com.crimetrack.jdbc.JdbcOfficersDAO" >
        <property name="dataSource" ref="dataSource" />
</bean> 
```

小服务程序.xml

```
 <bean name="/officer_registration.htm" class="com.crimetrack.web.OfficerRegistrationController">
        <property name="divisionManager" ref="divisionManager" />
        <property name="positionManager" ref="positionManager" />
        <property name="genderManager" ref="genderManager"/>  
    </bean>

<!-- __________________________________________________________________________________________________ -->    

    <bean name="/validateUserName.htm" class="com.crimetrack.web.OfficerRegistrationController">

        <property name="validateUserNameManager" ref="validateUserNameManager"/>    

    </bean>    

<!-- __________________________________________________________________________________________________ --> 
```

**堆栈跟踪：**

```
47840 [http-8084-1] DEBUG org.springframework.beans.TypeConverterDelegate  - Converting String to [class java.lang.String] using property editor [org.springframework.beans.propertyeditors.StringTrimmerEditor@7079b2]
47840 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - UserName is not null so going to check if its valid for :adminzz
47840 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - Just before try.....catch block...userName is :adminzz
47840 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - about to evaluate if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true)
47840 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - Error Occured When validating UserName
47840 [http-8084-1] ERROR com.crimetrack.service.OfficerRegistrationValidation  - Message
java.lang.NullPointerException
    at com.crimetrack.service.OfficerRegistrationValidation.validate(OfficerRegistrationValidation.java:51)
    at org.springframework.validation.DataBinder.validate(DataBinder.java:725)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.doBind(HandlerMethodInvoker.java:815)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.resolveHandlerArguments(HandlerMethodInvoker.java:367)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:171)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:10:37.113

问题是您通过新调用实例化了 OfficerRegistrationValidaton。这意味着 Spring 对对象一无所知，因此不会将任何东西连接到其中。

您需要通过 Spring 机制加载对象，通过 @Autowire / @Inject 或通过创建 BeanFactory，如下所示：

```
public final class BeanFactory() {

    private static ClassPathXmlApplicationContext context;

    private static ClassPathXmlApplicationContext getContext() {
        if (context== null) {
            context = new ClassPathXmlApplicationContext("applicationContext.xml");
        }
        return context;
    }

    public static OfficerRegistrationValidation getOfficerRegistrationValidation() {
        return (OfficerRegistrationValidation) getContext().getBean("officerRegistrationValidation");
    }
} 
```

然后，在您的控制器中：

```
 BeanFactory.getOfficerRegistrationValidation().validate(....) 
```

注意：更新 ClassPathXmlApplicationContext 时要小心，如果操作不当，可能会导致内存泄漏。创建一个静态工厂，该工厂将新建一次，并在任何后续调用中返回相同的实例。

# java - 带有 BouncyCastle 的 AES 256（而不是 128）

> ID：12573186
> 
> 赞同：4
> 
> 时间：2012-09-24T21:28:06.730
> 
> 标签：java, cryptography, aes, bouncycastle

我关注了[这篇文章](https://stackoverflow.com/questions/5641326/256bit-aes-cbc-pkcs5padding-with-bouncy-castle)的大部分内容，目的是在我的软件中实现 aes 256 加密，它工作得很好

这里的关键点是上面链接中描述的整个实现都使用了**AESEngine 类**。查看类代码和[javadoc 参考](http://www.bouncycastle.org/docs/docs1.5on/org/bouncycastle/crypto/engines/AESEngine.html)，AESEngine 是 128 位而不是 256 位块密码

通过代码和文档搜索，我找不到 192 位或 256 位的实现。他们在哪里？

为了完整起见，这是我实际加密类的核心：

```
 private void init(String passphrase) {
        try {
            String algorithm = "PBEWithSHA256And256BitAES-CBC-BC"; 

            encryptCipher = createCipher();
            decryptCipher = createCipher();    

            randomGenerator = new RandomGenerator();

            PBEKeySpec keySpec = new PBEKeySpec(passphrase.toCharArray(), KEY_SALT, ITERATIONS);    

            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(algorithm);
            key = keyFactory.generateSecret(keySpec);    

        } catch (NoSuchAlgorithmException e) {
            throw new RuntimeException("NoSuchAlgorithmException occured while trying to generate the crypto key. This error should never occur, check the application code", e);
        } catch (InvalidKeySpecException e) {
            throw new RuntimeException("InvalidKeySpecException occured while trying to generate the crypto key. This error should never occur, check the application code", e);
        }
    }    

    private BufferedBlockCipher createCipher() {
        return new PaddedBufferedBlockCipher(new CBCBlockCipher(new AESFastEngine()), new PKCS7Padding());
    }    

    public byte[] encrypt(byte[] data) {
        if (data == null)
            throw new NullPointerException("Cannot encrypt null data");    

        byte[] iv = randomGenerator.generateRandom(IV_SIZE);    

        byte[] encrypted;

        synchronized (encryptCipher) {
            encrypted = runCipher(encryptCipher, true, data, iv);
        }    

        return DataUtil.append(iv, encrypted);
    }    

    public byte[] decrypt(byte[] data) {
        if (data == null)
            throw new NullPointerException("Cannot decrypt null data");    

        byte[] iv = DataUtil.extract(data, 0, IV_SIZE);
        byte[] cipherText = DataUtil.extract(data, IV_SIZE, data.length - IV_SIZE);

        byte[] decrypted;    

        synchronized (decryptCipher) {
            decrypted = runCipher(decryptCipher, false, cipherText, iv);
        }

        return decrypted;
    }

    private byte[] runCipher(BufferedBlockCipher cipher, boolean forEncryption, byte[] data, byte[] iv) {
        String operation = forEncryption ? "encrypt" : "decrypt";

        try {
            KeyParameter keyParam = new KeyParameter(key.getEncoded());
            ParametersWithIV cipherParams = new ParametersWithIV(keyParam, iv);

            cipher.init(forEncryption, cipherParams);

            byte[] result = new byte[cipher.getOutputSize(data.length)];
            int len = cipher.processBytes(data, 0, data.length, result, 0);
            len += cipher.doFinal(result, len);

            //Remove padding se estiver decriptografando
            if(!forEncryption)
                result = DataUtil.extract(result, 0, len);

            return result;
        } catch (DataLengthException e) {
            throw new RuntimeException("DataLengthException occured while trying to " + operation + " data with length " + data.length + ". This error should never occur, check the application code", e);
        } catch (IllegalStateException e) {
            throw new RuntimeException("IllegalStateException occured while trying to " + operation + " data with length " + data.length + ". This error should never occur, check the application code", e);
        } catch (InvalidCipherTextException e) {
            throw new IllegalArgumentException("InvalidCipherTextException occured while trying to " + operation + " data with length " + data.length, e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T22:40:56.240

如果您想使用 256 位的块大小进行类似 AES 的加密，您应该使用：

[http://www.docjar.org/docs/api/org/bouncycastle/crypto/engines/RijndaelEngine.html](http://www.docjar.org/docs/api/org/bouncycastle/crypto/engines/RijndaelEngine.html)

但这可能不是您想要的。AES-256 中的 256 大约是密钥大小。然后，底层 128 位 AES 分组密码将使用此密钥大小。AES 是 Rijndael 的标准化 128 位块版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-22T14:39:14.237

AES 支持 3 种密钥大小 - [Wikipedia](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)、[NIST](http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf)。

您可能指的是固定为 128 位的块大小。

另外，我尝试通过代码，它是假设不同的密钥大小 - 128、192和256编写的。复制 - 从代码粘贴 - “AES指定了128位的固定块大小和128/192/256位的密钥大小。这个假设这些是唯一可能的值，则编写代码”

# php - 当我不知道有多少元素时拆分一个php字符串

> ID：12573188
> 
> 赞同：1
> 
> 时间：2012-09-24T21:28:38.733
> 
> 标签：php

我必须将用户名拆分为名字和姓氏，但我不知道名称中可能包含多少元素。我有一些工作代码，但似乎可以优化。

有没有人有任何建议可以使它更优雅？

```
function createMoodleUserNames($fullname){

    $names = explode(' ',$fullname);

    $prefixes = array('Dr.','Ms.','Mr.','Mrs.');

    $names = explode(' ',$name);

    $i = 0;

    if(in_array($names[0],$prefixes)){

        $firstname = $names[0].' '.$names[1];
        unset($names[0]);
        unset($names[1]);

    }else{

        $firstname = $names[0];
        unset($names[0]);

    }

    $lastname = '';

    while($i < count($names)){

        $lastname .= ' '.$names[$i];

        $i++;

    }

    $output = array();
    $output[0] = $firstname;
    $output[1] = $lastname;

    return $output;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:34:56.663

我认为第 7 行`$names = explode(' ',$name);`需要删除。

至于**优化**，代码非常简单，所以如果它正在做你需要的（即你的测试用例返回你满意的结果）那么我建议的唯一优化是

```
$lastname = implode(' ', $names); 
```

而不是你的while循环。由于您`unset`用于删除已处理的项目，`$names`因此将仅是剩余的项目（姓氏）。虽然这是微优化，但它会让你的代码更干净一些，并消除一些杂乱无章的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:38:57.787

我不确定您解析的数据有多复杂，但这个简单的解决方案可能适合您：

```
<?php
function parseName($fullName) {
    $parts = preg_split('~\s+~', $fullName);

    $result = array();
    if (!preg_match('~(dr|mr|ms|mrs)\.?~', strToLower($parts[0]))) {
        $result[] = $parts[0];
    } else {
        $result[] = $parts[1];
    }

    $result[] = end($parts);
    return $result;
} 
```

如果它是可识别的前缀，则忽略第一部分，并从最后一部分获取姓氏。

# google-apps-script - 在调用 doPost() 之前验证表单？

> ID：12573192
> 
> 赞同：1
> 
> 时间：2012-09-24T21:29:11.333
> 
> 标签：google-apps-script

我有一个 Google Apps 脚本应用程序，其中包含一个带有提交按钮的表单，我正在尝试在单击提交按钮时对表单中的数据进行一些验证。

问题是表单在`doPost()`被调用时已经消失了，并且在验证失败的情况下重新创建它是很痛苦的。

在调用**之前** 有什么方法可以进行服务器端验证吗？`doPost()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:46:26.797

您可以使用[验证器](https://developers.google.com/apps-script/uiapp#Validators)进行一些基本检查。另一种可能性是使用“正常”`doGet()`功能和“正常”按钮，它们可以作为*多步*确认，在真正处理数据之前进行完整的数据验证。唯一的限制是您不能在 doPost 结构之外使用文件上传功能，但这完全取决于您是否需要。

这是表单中多步骤确认的[一个小示例。](https://script.google.com/macros/s/AKfycbxSg_IulNQmGrukomzJ2BxUhKYaNtJLKbe7tt4V1kA0WrxQouc/exec)以及带有脚本和数据[的工作表。](https://docs.google.com/spreadsheet/ccc?key=0AshxSsxZv3fndF9iTThCbUFyczd2M3hyY2pKZUZtZGc#gid=0)

# javascript - 防止函数在 iframe 中的 javascript 中运行

> ID：12573195
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:29:21.183
> 
> 标签：javascript, html, internet-explorer

我正在尝试在 iframe 中加载一个我无法完全控制的 url。它加载具有 Document.CreateElement 的 Javascript，并且它对窗口对象有一些引用，该对象由于不允许 iframe 访问窗口而失败。所以我想覆盖函数的实现，所以我写的函数将运行而不是另一个网站写的函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:32:34.310

如果其他网站不在您的域中，则无法完成

# python - 使用类更改嵌套字典python中的值

> ID：12573198
> 
> 赞同：0
> 
> 时间：2012-09-24T21:30:03.987
> 
> 标签：python, object, dictionary, hashmap, associative-array

```
class warehouse:

    def __init__(self):
        self.A={}
        self.B={}   
        self.racks={'A':self.initialize(self.A),'B':self.initialize(self.B)}        

    def initialize(self,rack):
        shelf = dict([  (items,0) for items in range(1,6)  ])
        for x in range(3):
            rack[x+1]=shelf 
        return rack 

    def store(self,_id,owner_id,colour,weigth):
        import pdb;pdb.set_trace()          
        empty_position=self.empty_positions(self.store.__name__)[0]     
        self.racks[empty_position[0]][empty_position[1]][empty_position[2]]=   {'id':_id,'owner':owner_id,'colour':colour,'weigth':weigth}          
        print self.racks
    def empty_positions(self,name):

        store_list=[]
        for rack,shelfs in self.racks.iteritems():
            for shelf_number,shelf_objects in shelfs.iteritems():
                    store_list.append([rack,shelf_number])
                    for position,value in shelf_objects.iteritems():
                        if 0==value:
                            store_list.append([rack,shelf_number,position])

        return store_list

obj=warehouse()
val=obj.store(2,34,4,44) 
```

这是一个类仓库我想通过调用类的**init**方法来创建一个字典。现在我想使用类仓库的相同实例将一些值存储到嵌套字典中。当我调用obj.store（ 2,34,4,44)。它会更新字典并给出结果。

```
{'A': {1: {1: {'colour': 4, 'id': 2, 'owner': 34, 'weigth': 44},
           2: 0,
           3: 0,
           4: 0,
           5: 0},
       2: {1: {'colour': 4, 'id': 2, 'owner': 34, 'weigth': 44},
           2: 0,
           3: 0,
           4: 0,
           5: 0},
       3: {1: {'colour': 4, 'id': 2, 'owner': 34, 'weigth': 44},
           2: 0,
           3: 0,
           4: 0,
           5: 0}},
'B': {1: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0},
      2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0},
      3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}
     }
 } 
```

但我期待：

```
{'A': {1: {1: {'colour': 4, 'id': 2, 'owner': 34, 'weigth': 44},
           2: 0,
           3: 0,
           4: 0,
           5: 0},
       2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0},
       3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}},
 'B': {1: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0},
       2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0},
       3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}
      }
 } 
```

它在键'A'和1的所有其他嵌套字典中设置值我尝试放置PDB并对其进行调试，但它显示相同的结果。但是，如果我在终端中执行此操作，那么我会得到我所期望的结果。

```
Python 2.6.6 (r266:84292, Sep 15 2010, 15:52:39) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> d={'A': {1: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}}, 'B': {1: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}}}
>>> d['A'][1][1]={"some_key":"some_value",}
>>> d
{'A': {1: {1: {'some_key': 'some_value'}, 2: 0, 3: 0, 4: 0, 5: 0}, 2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}}, 'B': {1: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, 3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0}}} 
```

我不知道我可能遗漏了什么，或者有什么我无法赶上的错误。我正在使用 python 2.6.6 并尝试过这也是 2.7.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T21:37:38.643

当你这样做时：

```
shelf = dict([  (items,0) for items in range(1,6)  ])
for x in range(3):
    rack[x+1]=shelf 
```

您正在创建一个架子，然后将相同的架子放入架子 3 次。书架不是复制品，它们是*一模一样的*。

每次都需要创建一个新的架子：

```
def initialize(self, rack):
    for x in range(3):
        rack[x+1] = dict((items,0) for items in range(1,6))
    return rack 
```

在 python 2.7 中，使用字典推导，这可以变成：

```
def initialize(self, rack):
    rack.update({
        x + 1 : { item : 0 for item in range(1, 6) } for x in range(3)
    })
    return rack 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:39:05.580

你的问题出在`initialize()`方法上，特别是`rack[x+1]=shelf`：

```
def initialize(self,rack):
    shelf = dict([  (items,0) for items in range(1,6)  ])
    for x in range(3):
        rack[x+1]=shelf 
    return rack 
```

`rack[x+1]=shelf`可能看起来无害，但事实并非如此。`rack`将包含对同一`shelf`对象的多个引用，这会产生奇怪的结果：

```
>>> a = {1: 2}
>>> b = [a for i in range(3)]
>>> b
[{1: 2}, {1: 2}, {1: 2}]
>>> b[0][1] = 3
>>> b
[{1: 3}, {1: 3}, {1: 3}] 
```

请注意，当我更改一个实例时，对单个实例的*所有*引用都受到了影响。`a`它们都指向同一个对象。

要解决此问题，请更改`rack[x+1]=shelf`为`rack[x+1]=dict(shelf)`. 现在，您正在强制 Python 创建一个单独的`shelf`.

# r - RPostgreSQL 访问数据库，错误：无法找到函数“show”的继承方法，用于签名“PostgreSQLConnection”

> ID：12573202
> 
> 赞同：4
> 
> 时间：2012-09-24T21:30:26.860
> 
> 标签：r, postgresql, rpostgresql

这是一个新的，我在其他 stackoverflow 网站上没有发现任何提及。

所以我在 R 中编程并使用 RPostgreSQL 包来访问 Postgres 9.1.5 数据库。所以我像往常一样创建了与数据库的连接，现在我遇到了一个奇怪的错误。

```
db.conn = function(){

  ## This function creates a connection to the database. Subsequent
  ## functions that access the db will go through this function.
  drv = dbDriver("PostgreSQL")
  con = dbConnect(drv, user = "user", password = "password", dbname = "dbname", host = "localhost", port = 5432)
  return(con)
} 
```

所以当我创建一个对象时：

```
testdb = db.conn() 
```

该对象似乎已创建，但是当我键入

```
testdb

Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "show", for signature "PostgreSQLConnection" 
```

我以前从未见过这个错误。关于它可能来自哪里的任何建议？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:00:24.897

请不要交叉发布。我也刚刚在 RPostgreSQL 列表上回复，说这对我来说很好用：

```
R> library(RPostgreSQL)
Loading required package: DBI
R> drv <- dbDriver("PostgreSQL") 
R> con <- dbConnect(drv, user = "edd", password = ".....", dbname = "......",
+                   host = "localhost", port = 5432)
R> con
<PostgreSQLConnection:(21267,0)> 
R> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-26T22:53:13.923

如果这对其他人有帮助，我会收到类似的错误：

> “无法找到`dbIsValid`签名“PostgreSQLConnection”的函数的继承方法

当我无意中忘记将*dbConnect*调用的结果分配给连接对象时，就会发生这种情况。

所以这不起作用：

> 数据库连接（...）

但这确实：

> con <- dbConnect(...)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-19T19:17:28.297

我遇到了和你一样的问题。我的解决方案是删除“DBI”包并重新安装它。这个对我有用。但它可能不适合你。你可以试试：

```
remove.packages("DBI")
install.packages("DBI") 
```

# html - HTML 排序 - 不同表格上的标题

> ID：12573203
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:30:30.060
> 
> 标签：html

我有下面的 html 表，其中单独的表上的标题和另一个表上的内容。当我单击另一个表中的标题时，我必须对表进行排序。

我发现了很多 JavaScript 示例，这些示例只有在标题位于同一个表中时才有效。你们可以给我一些与我的任务相关的示例吗？

```
<html> 
    <table > 
        <tr>
            <th>Name</th>
            <th>Salary</th>
        </tr> 
    </table> 
    <table>
        <tr>
            <td>Fred</td>
            <td>$12000.00</td>
        </tr> 
        <tr>
            <td>Kevin</td>
            <td>$191200.00</td>
        </tr> 
    </table>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:11:40.490

如果您将一些类添加到列中，以便列单元格和关联的标题具有相同的类名，那么利用其他现有的 JavaScript 解决方案并不难。

例如，我使用了这个[简单的 JQuery 排序函数](http://james.padolsey.com/javascript/sorting-elements-with-jquery/)并创建了[这个 JSFiddle 演示](http://jsfiddle.net/EumEe/2/)。

我像这样修改了HTML：

```
<html> 
    <table id="heading"> 
        <tr>
            <th class="name-col">Name</th>
            <th class="salary-col">Salary</th>
        </tr> 
    </table> 
    <table id="data">
        <tr>
            <td class="name-col">Fred</td>
            <td class="salary-col">$12000.00</td>
        </tr> 
        <tr>
            <td class="name-col">Kevin</td>
            <td class="salary-col">$191200.00</td>
        </tr> 
    </table>
</html>​ 
```

请注意，我将标题 Name 和该列中的所有单元格与类`name-col`进行了比较，并且我对 Salary 标题和包含该类的单元格做了相同的操作`salary-col`。

`name-col` *然后我使用 JQuery 在标题*中添加了一个点击侦听器，然后触发了`name-col` *单元格*上的排序功能：

```
$('th.name-col').click(function() {
    $('td.name-col').sortElements(function(a, b){
        return $(a).text() > $(b).text() ? 1 : -1;
    }, function(){ return this.parentNode; });
});

$('th.salary-col').click(function() {
    $('td.salary-col').sortElements(function(a, b){
        return $(a).text() > $(b).text() ? 1 : -1;
    }, function(){ return this.parentNode; });
}); 
```

在这个例子中，`sortElements`是我上面链接的简单 JQuery 排序函数中提供的函数。我不是它的作者。

但是，您会注意到此脚本只会排序一次，因为比较器 ( `>`) 的方向是硬编码的。一种实现逻辑来反转这种排序的快速n-dirty方法是这样的：

```
var nameAsc = false;
var salaryAsc = false;

$('th.name-col').click(function() {
    $('td.name-col').sortElements(function(a, b){
        if (nameAsc) {
            nameAsc = false;
            return $(a).text() > $(b).text() ? 1 : -1;
        } else {
            nameAsc = true;
            return $(a).text() < $(b).text() ? 1 : -1;
        }
    }, function(){ return this.parentNode; });
});

$('th.salary-col').click(function() {
    $('td.salary-col').sortElements(function(a, b){
        if(salaryAsc) {
            salaryAsc = false;
            return $(a).text() > $(b).text() ? 1 : -1;
        } else {
            salaryAsc = true;
            return $(a).text() < $(b).text() ? 1 : -1;
        }
    }, function(){ return this.parentNode; });
}); 
```

这里的`nameAsc`和`salaryAsc`布尔变量只是一种允许您反转排序顺序的骇人听闻的方式。`>`如果它是上升的，它会翻转比较器函数中的布尔值和方向。可能有一种更有效的方法可以做到这一点，但我只是想举一个简单粗暴的例子。

您的两表模型会遇到很多问题，尤其是在调整列大小时。如果数据表中的单元格中有更长的数据，您的数据列将不再与标题列对齐。*我强烈建议您只为标题和*数据使用一个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-01T07:18:36.747

使用 sorttable.js 进行排序，在单击列标题进行排序时可能会出现列对齐问题....

```
<script type="text/javascript" src="http://community.wikidot.com/local--files/howto:sortable-tables-js/sorttable.js"></script>

<style>
        th, td{
            padding: 3px;//important
        }
</style>
<table class="sortable">
<tr><th>...</th></tr><tr><td>...</td</tr>
</table> 
```

# entity-framework - 让实体框架原始查询尊重属性

> ID：12573206
> 
> 赞同：8
> 
> 时间：2012-09-24T21:30:40.880
> 
> 标签：entity-framework

我正在使用 EF4，代码优先。因此，我的模型类混合了公共属性、一些虚拟属性（用于从其他表延迟加载的数据）和一些附加属性的`[NotMapped]`属性，以便 EF 跳过它们。

有时我喜欢使用原始查询：`c.Database.SqlQuery<T>("select ...")`使用 EF 作为行映射器。

我在 Intellitrace 中注意到，这些查询为“IndexOutOfRange”生成了很多抛出和捕获的异常。经过一番查看，例外都是模型对象上的虚拟和 [NotMapped] 属性。我不想构建一个只有表属性的新数据模型类或父类；是否有一些配置步骤我错过了告诉原始查询运行器中的行映射器注意其余 EF 使用的相同注释？也许他们在 EF5 中解决了这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T22:04:56.330

如果执行`dbContext.Database.SqlQuery`EF 将永远不会使用映射。它将仅使用结果集中的属性名称和列的简单匹配。尝试`dbSet.SqlQuery`改用。它应该反映映射，因为它可以将数据作为附加实体加载。

# ios - 使用 iOS FacebookSDK 对用户进行身份验证将用户注销

> ID：12573207
> 
> 赞同：1
> 
> 时间：2012-09-24T21:30:44.403
> 
> 标签：ios, facebook, authentication, facebook-ios-sdk

我正在使用 FB iOS SDK 来获取用户的凭据和访问令牌并保存它们。使用以前的版本，我设法正确地做到了这一点，但是我的解决方案在升级到 iOS 6 时中断了，所以我从 Github 下载了新版本，并根据说明编译并将框架添加到我的项目中。

我使用 FB 正确验证了我的用户，但是当浏览器（为 auth 呈现的模式视图控制器）被关闭时，我的用户恢复到我的应用程序的初始视图，而不是启动进程的视图。

现在我的应用程序委托中有代码，我`SocialNetworksViewController`可以这样做。

在`AppDelegate`：

```
-(BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
  return [FBSession.activeSession handleOpenURL:url];
} 

- (void)sessionStateChanged:(FBSession *)session
   presentingViewController:(UIViewController *)presentingViewController
                      state:(FBSessionState) state
                      error:(NSError *)error
{
  switch (state) {
    case FBSessionStateOpen: {
      [presentingViewController dismissModalViewControllerAnimated:YES];
    }
      break;
    case FBSessionStateClosed:
    case FBSessionStateClosedLoginFailed:
      // Once the user has logged in, we want them to
      // be looking at the root view.

      [FBSession.activeSession closeAndClearTokenInformation];

      break;
    default:
      break;
  }

  [[NSNotificationCenter defaultCenter] postNotificationName:FBSessionStateChangedNotification
                                                      object:session];

  if (error) {
    UIAlertView *alertView = [[UIAlertView alloc]
                              initWithTitle:@"Error"
                              message:error.localizedDescription
                              delegate:nil
                              cancelButtonTitle:@"OK"
                              otherButtonTitles:nil];
    [alertView show];
  }
}

- (void)openSessionFromViewController:(UIViewController *)viewController
{
  NSArray *permissions = [NSArray arrayWithObjects:@"publish_stream", @"email", @"user_birthday", nil];
  [FBSession openActiveSessionWithPermissions:permissions
                                 allowLoginUI:YES
                            completionHandler:
   ^(FBSession *session,
     FBSessionState state, NSError *error) {
     [self sessionStateChanged:session presentingViewController:viewController state:state error:error];
   }];
} 
```

在`SocialNetworksViewController`：

```
- (IBAction)connectToFacebook:(UIButton *)sender {
  if (!self.facebookConnected) {
    AppDelegate <UIApplicationDelegate> *appDelegate = (AppDelegate *)[UIApplication sharedApplication].delegate;
    [appDelegate openSessionFromViewController:self];
  }
}

- (void)sessionStateChanged:(NSNotification*)notification {

  NSLog(@"%@", FBSession.activeSession.accessToken);
}

- (void)facebookLoginFailed {
} 
```

这`viewDidLoad`也在：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                           selector:@selector(sessionStateChanged:)
                                               name:FBSessionStateChangedNotification
                                             object:nil]; 
```

在该`sessionStateChanged`方法中，`NSLog`输出然后我被发送到我的初始视图。

# chef-infra - 如何使用通用用户厨师食谱创建用户？

> ID：12573208
> 
> 赞同：4
> 
> 时间：2012-09-24T21:30:53.730
> 
> 标签：chef-infra

我正在尝试使用带有厨师服务器的“通用用户”配方将“部署”用户添加到我的 web_app 角色。我创建了一个 deploy.json 数据包，其中包含：

```
{
  "id": "deploy",
  "group": "deploy",
  "shell": true
} 
```

我已将数据包上传到我的服务器。

我还上传了我所有的食谱和角色。

最后，这是我的应用角色：

```
name "app_server"
description "application"
run_list(
  "recipe[generic-users]",
)
default_attributes "users" => { "active_groups" => "deploy" } 
```

当我尝试使用此角色配置我的服务器时，我看到以下内容：

```
[2012-09-24T22:17:53+01:00] INFO: Active groups: deploy, sysadmin 
```

但它实际上并没有创建我的部署用户。

我需要做什么才能让它创建我的用户？

另外，我想指定不同的用户，并且只能根据需要在特定角色上创建特定帐户。我怎么能那样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T06:01:53.360

您是否查看过[User Resource](https://docs.chef.io/resource_user.html)和[Group Resource](https://docs.chef.io/resource_group.html)？

您可以以声明方式创建组和用户：

```
group "magrathean" do
  gid 42
end

user "slartibartfast" do
  home "/home/slartibartfast"
  gid 42
  shell "/bin/bash"
  password "hashed password" 
end 
```

查看有关散列密码的部分。

我们运行一个自定义用户手册，它允许我们设置特定的配置文件，如`.alias`、`.bashrc`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T14:18:17.017

您可能会想到由 Chef（前身为 Opscode）维护的“用户”食谱，它按照您所说的做。给定一个数据包“用户”和项目“部署”（使用您声明的 json），它将创建用户。它还可以删除用户，或从 Tilman 提到的“用户”资源中调用任何操作。 [https://github.com/opscode-cookbooks/users](https://github.com/opscode-cookbooks/users)

# c# - NHibernate 3.3 查询缓存抛出异常

> ID：12573212
> 
> 赞同：1
> 
> 时间：2012-09-24T21:31:20.193
> 
> 标签：c#, nhibernate, caching

我最近升级了我们的应用程序以使用 NHibernate 3.3 并希望启用缓存。

我们处于多租户环境中，因此我希望每个会话工厂为每个客户端保留一个区域。

这是我的 NHibernate 配置：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSql2005Dialect</property>
    <property name="cache.use_query_cache">true</property>
    <property name="cache.use_second_level_cache">true</property>
    <property name="cache.provider_class">NHibernate.Caches.SysCache.SysCacheProvider,NHibernate.Caches.SysCache</property>
    <property name="connection.connection_string">Data Source=localhost; database=test;user=test; password=test;</property>
    <property name="show_sql">false</property>
    <property name="command_timeout">1000</property>
  </session-factory>
</hibernate-configuration> 
```

在我们的会话工厂生成器中......

```
 private static ISessionFactory GetSessionFactory(string connectionString, string driverClass = NormDriverClass, string prefix = null)
    {
        Configuration configuration = new Configuration();
        configuration.Configure().SetProperty(ConnectionStringProperty, connectionString);
        configuration.Properties.Add(ConnectionDriverProperty, driverClass);
        configuration.Properties.Add("regionPrefix", prefix ?? "default");
        configuration.AddAssembly(typeof(Foo).Assembly);

        return configuration.BuildSessionFactory();
    } 
```

我已将查询设置为可缓存：

```
query.SetCacheable(true).SetCacheMode(CacheMode.Normal); 
```

我每次都收到以下错误

```
System.IndexOutOfRangeException : Index was outside the bounds of the array.
at NHibernate.Type.TypeHelper.Disassemble(Object[] row, ICacheAssembler[] types, Boolean[] nonCacheable, ISessionImplementor session, Object owner)
at NHibernate.Cache.StandardQueryCache.Put(QueryKey key, ICacheAssembler[] returnTypes, IList result, Boolean isNaturalKeyLookup, ISessionImplementor session)
at NHibernate.Loader.Loader.PutResultInQueryCache(ISessionImplementor session, QueryParameters queryParameters, IType[] resultTypes, IQueryCache queryCache, QueryKey key, IList result)
at NHibernate.Loader.Loader.ListUsingQueryCache(ISessionImplementor session, QueryParameters queryParameters, ISet`1 querySpaces, IType[] resultTypes)
at NHibernate.Impl.SessionImpl.ListCustomQuery(ICustomQuery customQuery, QueryParameters queryParameters, IList results)
at NHibernate.Impl.SessionImpl.List(NativeSQLQuerySpecification spec, QueryParameters queryParameters, IList results)
at NHibernate.Impl.SessionImpl.List(NativeSQLQuerySpecification spec, QueryParameters queryParameters)
at NHibernate.Impl.SqlQueryImpl.List() 
```

认为缓存提供者是罪魁祸首，我切换回

```
<property name="cache.provider_class">NHibernate.Cache.HashtableCacheProvider,NHibernate</property> 
```

没变。

我删除了区域前缀代码，没有变化。

将“Use_query_cache”设置为 false 可修复运行时异常，但随后不使用缓存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T10:03:44.603

这里同样的问题。我已经下载了源代码并进行了一些调试，问题似乎出在核心模块中。

我在 Jira 上创建了一个[问题](https://nhibernate.jira.com/browse/NH-3311)，并且刚刚意识到几个月前其他人也做了[同样的事情。](https://nhibernate.jira.com/browse/NH-2961)

# c# - ObjectDataSource -> 采用两个参数的方法，一个是连接字符串

> ID：12573215
> 
> 赞同：2
> 
> 时间：2012-09-24T21:31:31.993
> 
> 标签：c#, asp.net

我正在将旧网站更新为更现代的外观。他们希望能够使用`CRUD`他们的数据表，这样用户就可以轻松地编辑/更新/删除内容，而无需访问特殊页面。

为此，我为他们的旧方法设置了一个 ObjectDataSource。

他们的方法采用连接字符串的参数

```
GetCustStaff(string cstGID, string ConnString); 
```

如何告诉 ObjectDataSource ConnString 值来自 web.config？

```
ConfigurationManager.AppSettings.Get("Connection").ToString() 
```

它给我填充参数的唯一选择是`(None, Cookie, Control, Form, Profile, QueryString, Session, RouteData).`

任何人都知道我该如何规避这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:42:56.723

将其设置为“无”，并将其添加到您的对象数据源代码 (.ASPX)：

```
 <SelectParameters>
           <asp:Parameter Name="connString" Type="String" />
 </SelectParameters> 
```

和

```
onselecting="ObjectDataSource_Selecting" 
```

完整代码：

```
<asp:ObjectDataSource ID="ObjectDataSource1" runat="server" onselecting="ObjectDataSource1_Selecting">
    <SelectParameters>
        <asp:Parameter Name="connString" Type="String" />
    </SelectParameters>
</asp:ObjectDataSource> 
```

然后，在你后面的代码中：

```
protected void ObjectDataSource1_Selecting(object sender, ObjectDataSourceSelectingEventArgs e)
{
    e.InputParameters["connString"] = ConfigurationManager.AppSettings.Get("Connection").ToString();

} 
```

[有用的链接](http://msdn.microsoft.com/en-us/library/aa581787.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:47:54.633

您可以创建一个类并从中调用方法。您将在类中的方法中添加带有变量/常量的 ConnectionString。这可能是包装现有代码的更好方法。您可能还需要一个 selectcount 方法 - 但我不完全确定要将对象数据源绑定到什么。

```
<asp:ObjectDataSource ID="objStaff" runat="server" SelectCountMethod="GetStaffDataCount" SelectMethod="GetStaffData" TypeName="yourNameSpace.ClassName">
<SelectParameters>
<asp:Parameter Name="StaffID" Type="Int32" DefaultValue="0" />
</SelectParameters>
</asp:ObjectDataSource> 
```

你班上的新人

```
public class ClassName(){

protected void getStaffData(int staffID)
{
 GetCustStaff(staffID, ConfigurationManager.AppSettings.Get("Connection").ToString())

...//fill method 

} 
```

}

# c++ - 将 PNG 加载代码转为使用 FILE 而不是本地资源

> ID：12573218
> 
> 赞同：2
> 
> 时间：2012-09-24T21:31:44.393
> 
> 标签：c++, windows, file, png, hbitmap

我正在开发一个小软件，旨在直接在桌面上显示 png 文件。我找到了一种使用 HBITMAP 结构来完成后面部分的方法。然而，到现在为止，我已经花了几天时间寻找一种将 .PNG 文件加载到这样的 HBITMAP 的方法。

我最终找到的代码（我也可以编译）是此页面中的代码：

[http://logiklabs.tumblr.com/post/22946728048/how-to-load-an-image-resource-into-a-hbitmap](http://logiklabs.tumblr.com/post/22946728048/how-to-load-an-image-resource-into-a-hbitmap)

认为它会完美地工作。我的问题是虽然这个是为了使用已经附加的 .png 文件。

**然而，我需要能够在运行时使用来自（在编译时）未知位置的文件。**

那么我怎样才能改变那个脚本来实现呢？不幸的是，我的 C++ 知识不是最好的，这些相关函数的 MS 文档也没有真正的帮助：/

我会非常非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:42:13.077

看起来您可以将 PNG 文件加载到 RAM 中并将其地址和长度传递给`stbi_load_from_memory()`. 您基本上更改了链接页面上代码的第一部分以将文件加载到 RAM 中，然后继续进行相同的操作。下面的例子：

```
static HBITMAP LoadImageResource(LPCTSTR filename)
{
    unsigned char *res_data, *splash_image;
    DWORD res_size;
    int width, height, components;
    BITMAPV5HEADER bmh;
    HBITMAP hBitmapRet;
    FILE* f = _tfopen(filename, "rb");

    if (!f)
        return NULL;

    fseek(f, 0, SEEK_END);
    res_size = ftell(f);
    rewind(f);

    res_data = new unsigned char[res_size];
    fread(res_data, sizeof(unsigned char), res_size, f);
    fclose(f);

    splash_image = stbi_load_from_memory(res_data, res_size, &width, &height, &components, 0);

    ZeroMemory(&bmh, sizeof(BITMAPV5HEADER));
    bmh.bV5Size = sizeof(BITMAPV5HEADER);
    bmh.bV5Width = width;
    bmh.bV5Height = -height;
    bmh.bV5Planes = 1;
    bmh.bV5BitCount = 32;
    bmh.bV5Compression = BI_BITFIELDS;
    bmh.bV5RedMask = 0x00FF0000;
    bmh.bV5GreenMask = 0x0000FF00;
    bmh.bV5BlueMask = 0x000000FF;
    bmh.bV5AlphaMask = 0xFF000000;

    hBitmapRet = CreateDIBitmap(GetDC(NULL), (BITMAPINFOHEADER *) &bmh, CBM_INIT,
                    splash_image, (BITMAPINFO *) &bmh, DIB_RGB_COLORS);

    stbi_image_free(splash_image);
    delete[] res_data;
    return hBitmapRet;
} 
```

# java - Java 数组 - 不断收到 NullPointerExcpetion

> ID：12573220
> 
> 赞同：0
> 
> 时间：2012-09-24T21:31:46.077
> 
> 标签：java, arrays, slick2d

所以我正在尝试制作一个可以生成 20 个敌人的游戏。敌人应该被加载到一系列敌人中，然后游戏打算在 for 循环中将它们绘制出来，唯一的问题是`NullPointerException`当我尝试运行 for 循环时我不断得到一个。

下面代码中的行：

```
enemy[i] = new Enemy(enemyX, enemyY, enemySize, vx, vy); 
```

是抛出异常的那个。我也在下面列出了完整的来源，这样你就可以看到我正在尝试做什么，我只是卡住了，我需要一些帮助，有没有其他方法可以创建敌人并将它们放置在屏幕上?

主类：

```
//define package
package auctus;

//imports
import org.newdawn.slick.AppGameContainer;
import org.newdawn.slick.BasicGame;
import org.newdawn.slick.Color;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.SlickException;

//create class
public class Auctus extends BasicGame{
    //Window dimensions and title
    public static final int WIDTH = 800;
    public static final int HEIGHT = 600;
    public static final String TITLE = "Auctus 0.1";

    //Defining the player variables, obviously only one player to create so no need for
    //automation in this area
    public float playerX, playerY, playerSize;
    //Creating the enemy array
    public Enemy enemy[];
    //declaring a global variable for the number of enemies
    public int numberOfEnemies;

    //slick2D API stuff
    public Auctus(String title) {       
            super(TITLE);       
    }

    //initialisation method
    public void init(GameContainer gc) throws SlickException {          
        //setting the number of enemies
        numberOfEnemies = 20; 

        //setting the player variables dynamically each time the game is started
        playerX = (float)Math.random() * WIDTH;
        playerY = (float)Math.random() * HEIGHT;
        playerSize = (float)Math.random() * 50;

        //creating the enemies
        for(int i = 0; i < numberOfEnemies; i++){           
            float enemyX = (float)Math.random() * WIDTH;
            float enemyY = (float)Math.random() * HEIGHT;
            float enemySize = (float)Math.random() * 50;
            float vx = (float)Math.random() * 2;
            float vy = (float)Math.random() * 2;

            //this is the line that's giving me trouble
            enemy[i] = new Enemy(enemyX, enemyY, enemySize, vx, vy);        
        }       
    }

    //from here it doesn't matter, this is error free both syntactically and logically
    public void render(GameContainer gc, Graphics g) throws SlickException    {     
            drawPlayer(g, playerX, playerY, playerSize);
            for(int i = 0; i < numberOfEnemies; i++){       
                enemy[i].drawEnemies(g);        
            }               
        }

    public void update(GameContainer gc, int delta) throws SlickException {     
        updatePlayer(gc, delta, playerX, playerY, playerSize);
        for(int i = 0;i < numberOfEnemies; i++){            
            enemy[i].updateEnemies(delta);      
        }       
    }

    public void drawPlayer(Graphics g, float playerX, float playerY, float playerSize){                 
    }

    public void updatePlayer(GameContainer gc, int delta, float playerX, float playerY, float playerSize){
    }

    public void updateEnemies(GameContainer gc, int delta, float enemyX, float enemyY, float enemySize, float vx, float vy){        
        for(int i = 0; i < numberOfEnemies; i++){           
            enemyX += vx;
            enemyY += vy;
        }       
    }

    public static void main(String[] args){     
        try{    
            AppGameContainer app = new AppGameContainer(new Auctus(TITLE));
            app.start();            
        } catch(SlickException e){          
            e.printStackTrace();            
    }
  }     
} 
```

敌人等级：

```
package auctus;

//imports
import org.newdawn.slick.Color;
import org.newdawn.slick.Graphics;

//class declaration
public class Enemy {
    //declaring variables
    public float enemyX, enemyY, enemySize, vx, vy;

    public Enemy(float x, float y, float size, float dx, float dy){     
        enemyX = x;
        enemyY = y;
        enemySize = size;    
        vx = dx;
        vy = dy;        
    }

    public float enemyX(){      
        return enemyY;      
    }

    public float enemyY(){
        return enemyY;      
    }

    public float enemySize(){       
        return enemySize;       
    }

    public float vx(){      
        return vx;      
    }

    public float vy(){      
        return vy;      
    }

    public void setX(float x){      
        enemyX = x;     
    }

    public void setY(float y){      
        enemyY = y;     
    }

    public void setSize(float size){    
        enemySize = size;       
    }

    public void setVX(float dx){        
        vx = dx;        
    }

    public void setVY(float dy){        
        vy = dy;        
    }

    public void drawEnemies(Graphics g){        
        g.setColor(Color.red);
        g.fillRect(enemyX, enemyY, enemySize, enemySize);       
    }

    public void updateEnemies(int delta){       
        if(enemyX < 800 || enemyX > 0){         
            enemyX += vx * delta;           
        }

        if(enemyX > 800 || enemyX < 0){         
            vx = -vx;           
        }

        if(enemyY < 600 || enemyY > 0){         
            enemyY += vy * delta;           
        }

        if(enemyY > 600 || enemyY < 0){         
            vy = - vy;          
        }       
    }   
} 
```

敌人等级非常简单。我不明白为什么它会变成 a `NullPointerException`，但也许其他人可以发现它。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-24T21:33:28.620

你永远不会实例化你的数组`enemy`。

在某些时候，在你*使用* `enemy`之前，你需要一些类似的东西：`enemy = new Enemy[numEnemies];`. 您可以在声明中执行此操作：

```
// use a constant for the number of enemies:
public static final int NUM_ENEMIES = 20; 
Enemy enemy[] = new Enemy[NUM_ENEMIES]; 
```

否则，因为`enemy`是`null`- 因为你没有实例化它 -`NullPointerException`当你尝试索引它时你会得到一个。

# c# - nHibernate GeneratedBy.Assigned 不起作用

> ID：12573224
> 
> 赞同：0
> 
> 时间：2012-09-24T21:32:00.030
> 
> 标签：c#, fluent-nhibernate, insert

我正在尝试使用复合键插入记录（不是我的数据库设计，而且我被迫使用企业模式，因此在这里更改数据库不是一个选项）。

我有以下 POCO 课程

```
public class RulesEngineHeader
{
    public virtual string CompanyCode { get; set; }
    public virtual string RuleID { get; set; }
    public virtual string RuleGroup { get; set; }
    public virtual string RuleDescription { get; set; }
    public virtual string Expression { get; set; }
} 
```

以及以下映射（使用 Fluent）

```
internal class RulesEngineHeaderMap : ClassMap<RulesEngineHeader>
{
    internal RulesEngineHeaderMap()
    {
        Table("LIOEP023");

        Id(x => x.CompanyCode, "CONO23")
            .GeneratedBy.Assigned()
            .Length(2)
            .Not.Nullable();
        Id(x => x.RuleID, "RLID23")
            .GeneratedBy.Assigned()
            .Length(30)
            .Not.Nullable();
        Map(x => x.RuleGroup, "RGRP23")
            .Length(30)
            .Not.Nullable();
        Map(x => x.RuleDescription, "RLDS23")
            .Length(50)
            .Not.Nullable();
        Map(x => x.Expression, "EXPR23")
            .Length(2500)
            .Not.Nullable();
    }
} 
```

使用以下代码：

```
using (iSeriesUOW uow = new iSeriesUOW())
{
    GenericRepository<RulesEngineHeader> rep = new GenericRepository<RulesEngineHeader>(uow);

    RulesEngineHeader header = new RulesEngineHeader();
    header.CompanyCode = "LI";
    header.RuleID = "TEST";
    header.RuleGroup = "AC";
    header.RuleDescription = "Description";
    header.Expression = "This is my rule expression";

    rep.Add(header);

    uow.Commit();
} 
```

rep.Add 只是做了一个

```
_uow.Session.Save(entityObject); 
```

和 uow.Commit(); 做一个 _session.Flush();

```
if (_tx != null)
    _tx.Commit(); 
```

当我执行此操作时，我会尝试执行以下查询：

```
INSERT INTO LIOEP023
    (RGRP23,
    RLDS23,
    EXPR23,
    RLID23)
VALUES      ('AC' /* @p0_0 */,
    'Description' /* @p1_0 */,
    'This is my rule expression' /* @p2_0 */,
    'TEST' /* @p3_0 */) 
```

如您所见，我的 CompanyCode/CONO23 无处可寻，这导致了错误。

任何想法为什么我的插入中没有使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:15:54.117

我发现我应该使用 CompositeId，而不是使用 2 个 ID。

所以我的代码应该是这样的：

```
internal RulesEngineHeaderMap()
{
    Table("LIOEP023");

    CompositeId()
        .KeyProperty(x => x.CompanyCode, "CONO23")
        .KeyProperty(x => x.RuleID, "RLID23");
    Map(x => x.RuleGroup, "RGRP23")
        .Length(30)
        .Not.Nullable();
    Map(x => x.RuleDescription, "RLDS23")
        .Length(50)
        .Not.Nullable();
    Map(x => x.Expression, "EXPR23")
        .Length(2500)
        .Not.Nullable();
} 
```

# javascript - 谷歌地图对 Sencha Touch 2 中的事件不敏感

> ID：12573225
> 
> 赞同：1
> 
> 时间：2012-09-24T21:32:02.847
> 
> 标签：javascript, extjs, sencha-touch-2

我在 Sencha touch 2 中定义了一个谷歌地图。它正在显示地图，但它没有响应触摸事件。我不能移动或捏它。

```
Ext.define('AddressBook.view.contact.Show', {
    extend: 'Ext.Panel',
    xtype: 'contact-show',
    requires: [
        'Ext.Map'
    ],
    config: {
        title: 'Information',
        layout: 'card',
        items: [
            {
                xtype: 'map',
                mapOptions : {
                    zoom : 15,
                    mapTypeId : google.maps.MapTypeId.ROADMAP,
                    navigationControl: true,
                    navigationControlOptions: {
                        style: google.maps.NavigationControlStyle.DEFAULT
                    }
                }
            }
        ]
    },

    centerMap: function(newRecord) {
        ...
    },

    setMarkers: function(markers) {
        ...
    }
}); 
```

我在 app.js 中创建了它：

```
Ext.Loader.setConfig({ enabled: true });

Ext.application({
    ...

    launch: function() {
        Ext.Viewport.add({
            xclass: 'AddressBook.view.contact.Show'
        });
    }
}); 
```

我包括谷歌脚本：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"</script> 
```

问题是 Sencha 提供的[“地图”示例](http://docs.sencha.com/touch/2-0/#!/example/maps)似乎运行良好。但它使用 Ext.setup() 和 Ext.create() 在 app.js 中显示地图。我无法弄清楚为什么它以这种方式工作正常。但我也不能使用这种方式来创建地图。有谁知道有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T08:49:16.473

发现了问题。来自 Sencha 的“地图”示例包含一个脚本，该脚本在示例中不存在，但存在于我用作项目模板的另一个示例中。

`<link rel="stylesheet" href="css/example.css" type="text/css"/>`

由于这个不存在的脚本包括谷歌地图在示例“地图”中工作。

换句话说，如果您将其与 Google 地图一起包含在您的项目中，它将变得毫无反应！我不得不剥离“地图”示例以最终找到问题，这花费了我很多时间，这要感谢有人在成为示例之前没有清理他的代码！

顺便说一句，这就是“navigationview”示例还冻结了 Google Map 的原因，因为它需要这个损坏的脚本来显示它的样式。

我要求 Sencha 团队从他们的示例中删除这个令人困惑的代码。

# php - 逐个标签逐个浏览 DOMDocument

> ID：12573226
> 
> 赞同：0
> 
> 时间：2012-09-24T21:32:04.360
> 
> 标签：php, dom, html-parsing

奇怪的是，我找不到这个答案，尽管它似乎以前一定被问过。我在 PHP 中有一个 DOMDocument，我想逐步浏览每个 html 标签，就好像它基本上是一个平面文档一样。我需要检查每个元素以查找标签名称和特定属性值。我不认为在这种情况下我不能使用 xpath，因为尽管 html 的结构保持不变，但属性可能会有所不同，具体取决于解析文档的时间。我的文件像这样有点不寻常

```
 <tr class='THIS COULD BE ONE OF THREE DIFFERENT CLASSES' id='UNIQUE ID'>
        <td class='statistics show' >
            <button class="js-hide">Show</button>
        </td>

        <td class='details'>
            <p>
                <span class='home'>
                    <a href='LINK'>TEAM 1</a>                </span>
                  <span class='COULD BE ONE OF TWO DIFFERENT CLASSES'> VARIABLE CONTENT </span>                  <span class='away'>
                    <a href='LINK'>TEAM 2</a>                </span>
                                            </p>
        </td>

    <td class='COULD BE ONE OF THREE CLASS TYPES'>
        VARIABLE CONTENT</td>

        <td class='status'>
                    </td>
    </tr> 
```

文档周围还有其他标签，但有许多重复的部分，比如我想删除的部分。我看不出 xpath 将如何让我明智地解析这个，所以逐个标签是我唯一的选择，但我找不到正确的方法来做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:45:11.967

您可以使用[getElementsByTagName(*)](http://www.php.net/manual/en/domdocument.getelementsbytagname.php)来获取所有元素并遍历这些元素。

# asp.net-mvc - ASP.NET MVC - base64String 到 html 图像

> ID：12573228
> 
> 赞同：0
> 
> 时间：2012-09-24T21:32:19.550
> 
> 标签：asp.net-mvc

我有一个 base64Strings 集合，它们需要在视图中被视为图像。

有谁知道我该怎么做？我完全被难住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T11:50:39.163

ASP.NET MVC 为这些任务提供了非常好的解决方案。我们将创建一个动作，它将以 Web 浏览器知道的形式返回表示图像的流。对于包含 base64 图像的大字符串，我很抱歉，但这将确保您可以开箱即用地使用它：

```
static string ImageSource = "iVBORw0KGgoAAAANSUhEUgAAABgAAAASCAIAAADOjonJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcklEQVR42pVUy05UQRSs07fvvc5lGEadIQgEDD6IEDUmosQYt8pC/R39Gvf+grhzTcJ+CD7CJMDwknnc269yMfIaRKV2nfSprlOnTksgrfORAggRBEIEAsFloJTSNvgPn3/cGUtnxrKrV3SSRBBeikhE0jTVNGplbWd51b58WFucrY5WklKiI+Eg1ekjz7AAIKlDxP3DotHs7Oz3vm91lh7VJ2vZcCnSkRzfGyg+DZJKKQBaAp31nXbe68inTtHcbL9evDE3XakOxUmshOGEa5Dj90MkAWiQsI7G5S60crPSNdt7vVePx57NX69X0yzVIuFiywgISZIaALynNXCwFvvGmtx8POhubLaXno5P1EvlUhzrC50m+26KJgBrYT18ABEEbWttbpY7prl5+Ob5xNz0SLUca61Ot0hC+nJEBBqgBgkfxDr4cGxpYWSnsKvdvN3ae7tQe3K7nGmofinIE+9FIhUqwzJU0QTgHKyBC6c1B9DlJm/3dje+bKV7WUyICHnGHoGoOJ2aHHn3XhOEc7TuiIgAEvoy8+mw88I3ptgqWATx54IlFEqUUEf9qQU6L9bCs686pa2iO++bi75RD+0UJiCYC7wWjcRZEhoEnIfzsF6RJRQ1HC749Tm/UUUvpg2A/VOEjoLtrPcENAXinRgXuyJjMcnWAtduht0hFIre/SXU/XUVGB9AahBiXGI7Jde+G5oP+LUWDhMxgSz+tWsCQKkskKRmYMZ8NBzcc41bbFaQx7CeCANCzsmSfmugA0hopTE7ntw/+FmzkrEWoT8d/ucXEiVJOj4hUSTG2r31b8V2C/C4HARgQDRUv1a5OfMLsQpx+LS8fvQAAAAASUVORK5CYII=";

    public ActionResult Image()
    {
        var arr = Convert.FromBase64String(ImageSource);
        return this.File(arr, "image/png", "image.png");
    } 
```

然后从你的角度调用它

```
<img src="@Url.Action("Image")"/> 
```

PS：期待您使用家庭控制器

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-24T21:52:00.150

你可以做这样的事情（这是一个图像，但你可以很容易地扩展它以获得它们的列表）。

（*参见base64字符串*“ ***data:image/png;base64,*** ”前面的标题）

```
//Model
public class ImgModel
{
 public string Src { get; set; }
}

//Action
public ActionResult Index(int id = 0)
{
 var img =@"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==";
 return View(new ImgModel{Src = img});
}

//View
<div id="kk1">
 <img id="myimg1" src="@Model.Src" alt="Red dot">
</div> 
```

我使用的示例 img 数据来自[Wikipedia](http://en.wikipedia.org/wiki/Data_URI_scheme#HTML)

# javascript - 谷歌地图多边形/叠加 - 删除

> ID：12573229
> 
> 赞同：0
> 
> 时间：2012-09-24T21:32:23.983
> 
> 标签：javascript, google-maps, overlay

作为上一个问题的后续......我没有运气删除我在地图上绘制的覆盖物，以便我可以重新开始。

我的顺序：

1) 绘制地图
2) 用户选择一个城市
3) 我进行 ajax 调用以获取所选城市的边界坐标，在 ajax 成功块内，我在该城市周围绘制边界 - 完成，我绘制地图上的一个多边形，它完全覆盖视口，除了一个“洞”打孔暴露了城市。

太好了，到目前为止

4) 用户选择了一个新城市
5) 相同的 ajax 调用，但它首先尝试通过将“地图”设置为空来消除覆盖。

那是行不通的。新城周围有边界，但覆盖层变暗了，原来的“洞”还被戳穿了。

我正在使用：negativeSpacePolygon.setMap(null);

尝试清除覆盖。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:20:54.630

请参阅上一个问题中此示例的“隐藏”/“显示”按钮： [http ://www.geocodezip.com/v3_polygon_example_complex_hole.html](http://www.geocodezip.com/v3_polygon_example_complex_hole.html)

# c++ - Q_ASSERT 发布构建语义

> ID：12573230
> 
> 赞同：11
> 
> 时间：2012-09-24T21:32:24.903
> 
> 标签：c++, qt, assertions

我在发布版本下找不到关于 Q_ASSERT 语义的明确声明。如果没有断言检查，那么断言表达式是否被评估？

考虑以下代码

```
Q_ASSERT(do_something_report_false_if_failed()); 
```

会`do_something_report_false_if_failed()`在所有潜在的 Qt 构建配置下运行吗？这样做会更安全（即使更冗长且可读性更低）：

```
bool is_ok = do_something_report_false_if_failed();
Q_ASSERT(is_ok) 
```

后一种方法的缺点是 ASSERT 失败不那么冗长，但也许它更清楚地表明该语句已执行？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-24T21:52:12.250

内部的表达式`Q_ASSERT`将**不会**在非调试构建配置中进行评估。

考虑下面来自[Qt repo](http://code.qt.io/cgit/qt/qtbase.git/tree/src/corelib/global/qglobal.h?h=5.4)的源代码。

```
#if !defined(Q_ASSERT)
#  ifndef QT_NO_DEBUG
#    define Q_ASSERT(cond) ((!(cond)) ? qt_assert(#cond,__FILE__,__LINE__) : qt_noop())
#  else
#    define Q_ASSERT(cond) qt_noop()    
#  endif    
#endif 
```

如果`QT_NO_DEBUG`已定义，则将整个`Q_ASSERT`语句替换为 a `qt_noop()`，从而删除它先前包含的任何表达式。

永远不要依赖语句中的表达式产生的任何副作用`Q_ASSERT`。从技术上讲，仍然可以确保它`QT_NO_DEBUG`没有在特定的构建配置中定义，但这不是一个好主意™。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-09-10T06:51:41.687

[这在Qt5.5](http://code.qt.io/cgit/qt/qtbase.git/tree/src/corelib/global/qglobal.h?h=5.5)中似乎有所不同（但不是更早 - 请参阅[Qt5.4](http://code.qt.io/cgit/qt/qtbase.git/tree/src/corelib/global/qglobal.h?h=5.4)）：

```
#if !defined(Q_ASSERT)
#  if defined(QT_NO_DEBUG) && !defined(QT_FORCE_ASSERTS)
#    define Q_ASSERT(cond) do { } while ((false) && (cond))
#  else
#    define Q_ASSERT(cond) ((!(cond)) ? qt_assert(#cond,__FILE__,__LINE__) : qt_noop())
#  endif
#endif 
```

我现在在 Visual Studio 2013 中收到很多“警告 C4127：条件表达式是常量”。

更新： [Qt5.5 发行说明](http://code.qt.io/cgit/qt/qtbase.git/tree/dist/changes-5.5.0)说：

> Q_ASSERT 现在即使在释放模式下，当断言被禁用时也会扩展条件，尽管在无法访问的代码路径中。这解决了关于在发布模式下未使用的变量和函数的编译器警告，因为它们仅在断言中使用。不幸的是，通过#ifndef 隐藏这些函数和变量的代码库需要删除条件才能使用 Qt 5.5 进行编译。

# c - 新数组和指针

> ID：12573232
> 
> 赞同：1
> 
> 时间：2012-09-24T21:32:31.347
> 
> 标签：c

我遇到了一些麻烦，因为我是 C 新手，甚至不确定我想做的事情是否可行。

我将一个名为**args**的数组传递给一个函数。在函数中，我还创建了一个名为**arrayOfArgs**的二维数组。我想要做的是将 args 中的某些值放入名为 arrayOfArgs 的二维数组中的特定位置。

到目前为止，这是我的代码：

```
int do_command(char **args){
        //this is usually a changing variable depending on the situation, but I've hard coded it to make sense
        int commands = 3;
        char **arrayOfArgs[commands][10];
        //counts which column in arrayOfArgs we are on
        int commandNum = 0;

//Counts which part of a command we are on
        int count = 0;

    //Array Counters
    int i = 0;
    int j;

    //Go through args until we reach the end
    while (args[i] != NULL){
        if(!strcmp(args[i], "|")){
            arrayOfArgs[commandNum][count] = args[i];
            count++;
        }
        else if (strcmp(args[i], "|")) {
            count = 0;
            commandNum++;
        }
        //Looking at the next value in args
        i++;
    } 
```

我遇到了问题，因为放入 arrayOfArgs 的唯一内容是胡言乱语。我确定我在数组指向的方式、arrayOfArgs 的创建方式或两者上都做错了。

或者是否有可能像我正在尝试的那样从一维数组变为二维数组？

我很确定那里有一个 NULL 因为之前我调用了这个循环并且它有效：

```
for(i = 0; args[i] != NULL; i++) {
    printf("Argument %d: %s\n", i, args[i]);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:10:22.967

首先，您如何验证的内容`arrayOfArgs`是乱码？你用 打印出内容`printf`吗？你在使用调试器吗？

其次，每个*元素*`arrayOfArgs`应该存储什么？它应该是一个由 9 个字符或更少字符组成的 3 元素数组吗？它应该是一个 3x10 元素的指针数组`char`吗？它应该是指向指针的 3x10 元素数组`char`吗？

在行

```
 arrayOfArgs[commandNum][count] = args[i]; 
```

表达式`args[i]`有类型`char *`；这强烈暗示您打算为 的每个元素`arrayOfArgs`存储一个`char *`. 在这种情况下，将声明更改`arrayOfArgs`为

```
char *arrayOfArgs[commands][10]; 
```

（我读到这个是因为每个命令最多可以有 9 个参数）。

IOW，*看起来*你正在尝试存储类似的东西

```
    列 0 1 2 3 4 5 6 7 8 9
排
  0 "cmd" "a1" "a2" NULL NULL NULL ...
  1 "cmd" "a1" 空
...

```

通过存储指向二维数组中每个字符串的指针。

如果是这种情况，那么您需要更改`arrayOfArgs`我上面所说的声明。如果*不是*这样，那么你需要给我们一个*应该*`arrayOfArgs`是什么样子的例子。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:00:22.953

问题在这里：

```
char **arrayOfArgs[commands][10]; 
```

这声明了一个双字符指针的二维数组，这不是您想要的。

请尝试以下操作：

```
char *arrayOfArgs[commands][10]; 
```

编辑：更改为`char*`因为在检查代码后我发现 OP 将指向字符数组的指针分配给`arrayOfArgs`. 感谢@wildplasser 的通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:11:29.533

所以我看到了一些问题......

首先我相信你的意思`char arrayOfArgs[commands][10];`是你想要一个 10 个字符串的二维数组（我假设这是你想要的）......否则它将是一个字符串指针数组的二维数组（就像一个 4D 字符数组:P)

`|`接下来，如果参数本身是，您创建的代码只会将字符复制到每个命令缓冲区中`|`

如果您正在查找管道符号之间的内容，请查看函数`strchr`，并且`strncpy`使用这些函数，我将遍历每个 arg，如果和参数是管道符号`|`，找到带有管道符号的下一个参数，循环遍历中的参数之间，然后将中间的字符复制到动态分配的字符数组中

此外，在您的评论中，您说命令数组将是动态的......您的程序结构化数据的方式是静态分配在堆栈上的。要使这种动态化，您需要动态分配到堆上，即`malloc`/`calloc`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:57:23.070

我想到了。我决定采用 1D 阵列路线而不是 2D 方式。代码现在采用 args，之前被拆分为 "ls" "-l" "|" “wc”并根据是否有管道将它们分隔到一个名为“arrayOfCommands”的新数组中。一旦完成，arrayOfCommands 的内容就是“ls -l”和“wc”。这是代码：

```
int do_command(char **args,) {
    const int commands = 2;
    int i = 0;

    int commandNum = 0;
    int firstCommand = 1;

    char *arrayOfCommands[commands];

    //Go through args until we reach the end
    while (args[i] != NULL){
        //First case            
        if(firstCommand){
            arrayOfCommands[commandNum] = args[i];
            firstCommand = 0;
        }
        //Rest of the cases
        else{
            //if we find something that's not a pipe...
            if(strcmp(args[i], "|")){
                //Add a space to what was a previous part of the same command
                arrayOfCommands[commandNum] = strcat(arrayOfCommands[commandNum]," ");
                arrayOfCommands[commandNum] = strcat(arrayOfCommands[commandNum],args[i]);
            }
            //But if we do find a pipe...
            else if (!strcmp(args[i], "|")) {
                //We know it's time for a new command
                commandNum++;
                firstCommand = 1;
            }               
        }
        //Looking at the next value in args
        i++;
    }

    for(i = 0; i < commands; i++)
        printf("Command #[%d]: %s\n", i, arrayOfCommands[i]);
} 
```*

# variables - 覆盖变量名是不好的编码风格吗？

> ID：12573235
> 
> 赞同：1
> 
> 时间：2012-09-24T21:33:03.877
> 
> 标签：variables, coding-style, styles

在编写快速、完成的脚本时，一旦不再需要变量名，我经常会覆盖它们。这很糟糕吗？它可以节省内存，就像回收苏打水可以拯救地球一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:37:28.617

它如何节省内存以覆盖变量，而不是正确处理它并声明一个新变量。你有组装机械方面的经验吗？我相信通过按自己的方式进行操作可以节省的唯一一件事就是打字。当您在脚本中进一步深入时不选择唯一变量时，代码可读性会受到影响。

以一本书为例，它一直重复使用第 1 页到 300 页的书的页面。回忆你的位置有多容易？

参考您对重用变量和回收的比较。变量是内存的相对空间，它们完全消散，就好像它们在破坏时不存在一样，因为塑料和纸总是会留下某种足迹，即使它是物理变化的形式，例如从固体到气体。

我建议只声明完成工作所需的变量数量，但尽可能多地声明以提高代码可读性。除非有其他的动机。

**我会在自助餐中查看诸如盘子之类的变量，一旦您完成...换一个新的。**

# c - 使用库实现完全获取预处理的 C 代码

> ID：12573237
> 
> 赞同：0
> 
> 时间：2012-09-24T21:33:06.500
> 
> 标签：c, c-preprocessor

我使用 *nix/gcc。我是 C 的初学者，所以这可能是一个简单的问题。假设我有一个包含以下内容的文件 main.c：

```
#include<stdio.h>

int main(int argc, char *argv[])
{
    printf("Hello World.\n");

    return 0;
} 
```

现在我想要的是一个文件，其中包含预处理后的所有代码和所有库实现代码（用于检查目的）。现在，如果我跑

```
gcc -E main.c >> full.c 
```

我确实得到了一堆代码，但只有数据类型和函数原型。是否有可能以某种方式实现所有功能，以便我可以在一个地方看到整个代码。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:44:15.613

C 预处理器只进行文本操作。在这种情况下，它将生成一个输出文件，该文件将包含包含文件 stdio.h 的内容以及主程序的几行。

它不包含 stdio.h 函数实现，因为该源位于其他一些文件中，而这些文件未以 gcc 的源代码格式提供。

因此，如果您想要实现，您需要找到我希望在网络上某个地方的 gcc 标准 C 库源代码。

但是，如果您想了解标准 C 库，您应该从关于标准 C 库的 Plaughers 书籍或类似的书籍开始，这些书籍提供了实现以及关于所做工作和原因的注释和注释。

# c++ - 更改声明顺序时输出不正确

> ID：12573238
> 
> 赞同：-1
> 
> 时间：2012-09-24T21:33:13.023
> 
> 标签：c++, opengl, global-variables

Sutherland-Hodgeman 多边形裁剪的实现。这两个语句的声明顺序给出了正确的输出，反向没有。

```
int numberOfVertices = 5;
Point pointList[] = { {50,50}, {200,300}, {310,110}, {130,90}, {70,40} }; 
```

颠倒声明时出现的确切错误是底部剪裁器产生一组空的顶点，因此剪裁后不显示多边形。

这个错误的原因是什么？

代码：

```
#include <iostream>
#include <GL/glut.h>
#define MAXVERTICES 10
#define LEFT 0
#define RIGHT 1
#define TOP 2
#define BOTTOM 3
using namespace std;

/* Clipping window */
struct Window {
    double xmin;
    double xmax;
    double ymin;
    double ymax;
};

struct Point {
    double x;
    double y;
};

/* If I interchange these two lines, the code doesn't work. */
/**************/
int numberOfVertices = 5;
Point pointList[] = { {50,50}, {200,300}, {310,110}, {130,90}, {70,40} };
/**************/
const Window w = { 100, 400, 60, 200 };

/* Checks whether a point is inside or outside a window side */
int isInside(Point p, int side) {
    switch(side) {
        case LEFT:
            return p.x >= w.xmin;
        case RIGHT:
            return p.x <= w.xmax;
        case TOP:
            return p.y <= w.ymax;
        case BOTTOM:
            return p.y >= w.ymin;
    }
}

/* Calculates intersection of a segment and a window side */
Point intersection(Point p1, Point p2, int side) {
    Point temp;
    double slope, intercept;
    bool infinite;

    /* Find slope and intercept of segment, taking care of inf slope */
    if(p2.x - p1.x != 0) {
       slope = (p2.y - p1.y) / (p2.x - p1.x);
       infinite = false;
    } else {
        infinite = true;
    }

    intercept = p1.y - p1.x * slope;

    /* Calculate intersections */
    switch(side) {
        case LEFT:
            temp.x = w.xmin;
            temp.y = temp.x * slope + intercept;
            break;
        case RIGHT:
            temp.x = w.xmax;
            temp.y = temp.x * slope + intercept;
            break;
        case TOP:
            temp.y = w.ymax;
            temp.x = infinite ? p1.x : (temp.y - intercept) / slope;
            break;
        case BOTTOM:
            temp.y = w.ymin;
            temp.x = infinite ? p1.x : (temp.y - intercept) / slope;
            break;
    }

    return temp;
}

/* Clips polygon against a side, updating the point list
(called once for each side) */
void clipAgainstSide(int sideToClip) {
    int i, j=0;
    Point s,p;
    Point outputList[MAXVERTICES];

    /* Main algorithm */
    s = pointList[numberOfVertices-1];
    for(i=0 ; i<numberOfVertices ; i++) {
        p = pointList[i];

        if(isInside(p, sideToClip)) {
            /* p inside */
            if(!isInside(s, sideToClip)) {
                /* p inside, s outside */
                outputList[j] = intersection(p, s, sideToClip);
                j++;
            }
            outputList[j] = p;
            j++;
        }
        else if(isInside(s, sideToClip)) {
            /* s inside, p outside */
            outputList[j] = intersection(s, p, sideToClip);
            j++;
        }

        s = p;
    }

    /* Updating number of points and point list */
    numberOfVertices = j;

    /* ERROR: In last call with BOTTOM argument, numberOfVertices becomes 0 */
/* all earlier 3 calls have correct output */
    cout<<numberOfVertices<<endl;

    for(i=0 ; i<numberOfVertices ; i++) {
        pointList[i] = outputList[i];
    }
}

void SutherlandHodgemanPolygonClip() {    
    clipAgainstSide(LEFT);
    clipAgainstSide(RIGHT);
    clipAgainstSide(TOP);
    clipAgainstSide(BOTTOM);
}

void init() {
    glClearColor(1,1,1,0);
    glMatrixMode(GL_PROJECTION);
    gluOrtho2D(0,1000,0,500);
}

void display() {
    glClear(GL_COLOR_BUFFER_BIT);

    /* Displaying ORIGINAL box and polygon */
    glColor3f(0,0,1);
    glBegin(GL_LINE_LOOP);
        glVertex2i(w.xmin, w.ymin);
        glVertex2i(w.xmin, w.ymax);
        glVertex2i(w.xmax, w.ymax);
        glVertex2i(w.xmax, w.ymin);
    glEnd();

    glColor3f(1,0,0);
    glBegin(GL_LINE_LOOP);
        for(int i=0 ; i<numberOfVertices ; i++) {
            glVertex2i(pointList[i].x, pointList[i].y);
        }
    glEnd();

    /* Clipping */
    SutherlandHodgemanPolygonClip();

    /* Displaying CLIPPED box and polygon, 500px right */
    glColor3f(0,0,1);
    glBegin(GL_LINE_LOOP);
        glVertex2i(w.xmin+500, w.ymin);
        glVertex2i(w.xmin+500, w.ymax);
        glVertex2i(w.xmax+500, w.ymax);
        glVertex2i(w.xmax+500, w.ymin);
    glEnd();

    glColor3f(1,0,0);
    glBegin(GL_LINE_LOOP);
        for(int i=0 ; i<numberOfVertices ; i++) {
            glVertex2i(pointList[i].x+500, pointList[i].y);
        }
    glEnd();

    glFlush();
}

int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(1000,500);
    glutCreateWindow("Sutherland-Hodgeman polygon clipping");

    init();
    glutDisplayFunc(display);
    glutMainLoop();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:57:29.360

在

```
 if(isInside(p, sideToClip)) {
        /* p inside */
        if(!isInside(s, sideToClip)) {
            /* p inside, s outside */
            outputList[j] = intersection(p, s, sideToClip);
            j++;
        }
        outputList[j] = p;
        j++;
    }
    else if(isInside(s, sideToClip)) {
    }

    s = p;
}

/* Updating number of points and point list */
numberOfVertices = j;

for(i=0 ; i<numberOfVertices ; i++) {
    pointList[i] = outputList[i];
} 
```

您可以增加`numberOfVertices`，但`pointList`只有初始点的空间。声明它

```
Point pointList[MAXVERTICES] = { ... }; 
```

有足够的空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:47:27.313

您有一个内存踩踏错误 - 您正在`pointList`使用无效索引写入数组，随后会立即覆盖内存。您的原始代码恰好可以工作，因为它之后的内存没有被使用，但是当您切换声明的顺序时，内存踩踏会覆盖变量`numberOfVertices`。

我建议使用 Valgrind 运行您的程序，以查找发生内存踩踏的位置。

# java - 命令行参数未发生java正则表达式非法转义字符错误

> ID：12573240
> 
> 赞同：1
> 
> 时间：2012-09-24T21:33:24.833
> 
> 标签：java, regex

这个简单的正则表达式程序

```
import java.util.regex.*;
class Regex {
    public static void main(String [] args) {
        System.out.println(args[0]); // #1
        Pattern p = Pattern.compile(args[0]); // #2
        Matcher m = p.matcher(args[1]);
        boolean b = false;
        while(b = m.find()) {
            System.out.println(m.start()+" "+m.group());
        }
    }
} 
```

`java regex "\d" "sfdd1"`由编译调用并运行良好。

但是如果 #1 被 替换`Pattern p = Pattern.compile("\d");`，它会给出编译器错误，说非法转义字符。在#1 中，我还尝试打印命令行参数中指定的模式。它打印`\d`，这意味着它只是`\d`在 #2 中被替换。

那么为什么它不会抛出任何异常呢？最后是字符串参数，`Pattern.compile()`那么它不会检测到非法转义字符吗？有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:36:12.403

*字符串文字*中的反斜杠字符需要转义（前面有反斜杠）。从命令行传入时，字符串不是字符串文字。编译器抱怨`"\d"`不是一个有效的转义序列（请参阅[字符和字符串文字的转义序列](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.6)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:44:20.443

该`\`字符用作 Java 字符串文字和正则表达式的转义字符。这让很多程序员感到困惑。当您想在 Java 中创建一个字符串来表示具有转义字符的正则表达式时，您需要对 Java 转义字符进行转义。

在命令行中传递字符串时，JVM 会为您处理并简单地创建字符串。

你想要的是这个

```
Pattern p = Pattern.compile("\\d"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:47:58.793

Java 中的反斜杠`\`导致字符串中的转义。例如，该字符串`"\t"`在 java 中会产生一个制表符。这也是`"\n"`产生换行符的原因。

在正则表达式中，是*相对于正则表达式****而不是****Java*`\d`的转义。这意味着为了输入字符串文字，您必须输入字符串。基本上，您必须转义以获得字面值，然后在编译正则表达式时，它会进一步转义要解析为数字。**`\d``"\\d"``\``\d``Pattern``\d`**

 **这可能会令人困惑，但长话短说，您永远不应该`\`在正则表达式的字符串文字中使用一个，因为即使字符串文字也`"\\n"`被正确解析。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T21:36:35.700

我不完全确定我是否理解这个问题，但您的问题似乎是您将“\d”视为 Java 转义字符，它不存在。要将其视为正则表达式转义字符，请使用“\d”转义 Java 转义。**

# c# - DevExpress DropDownButton 问题

> ID：12573244
> 
> 赞同：1
> 
> 时间：2012-09-24T21:33:33.580
> 
> 标签：c#, winforms, devexpress

我正在尝试创建一个 DevEx 下拉按钮。不幸的是，我遇到了两个我无法弄清楚的问题：

1) 我无法正确设置弹出菜单的外观，即它的外观不是“Office 2010 Blue”。我正在使用的代码如下所示：

```
 private void InitializeSendToPricingSheetButton()
        {
            var barManager = new BarManager();
            if (barManager.Controller == null) barManager.Controller = new BarAndDockingController();
            barManager.Controller.PaintStyleName = "Skin";
            barManager.Controller.LookAndFeel.UseDefaultLookAndFeel = false;
            barManager.Controller.LookAndFeel.SkinName = "Office 2010 Blue";

            barManager.ItemClick += HandleSendToPricingSheetClick;
            barManager.Items.AddRange(new[] { new BarButtonItem(barManager, "Foo"), new BarButtonItem(barManager, "Bar"), new BarButtonItem(barManager, "Baz") });

            var popupMenu = new PopupMenu { Manager = barManager };
            foreach (var barItem in barManager.Items) popupMenu.ItemLinks.Add((BarItem)barItem);
            popupMenu.ItemLinks[1].BeginGroup = true;

            dropDownButtonSendToPricingSheet.DropDownControl = popupMenu;
        } 
```

2) 此按钮位于表单上。如果表单失去焦点（例如，我单击 Firefox），弹出菜单仍然保持在顶部。在点击之前它不会消失。

任何建议将***不胜***感激。感谢您帮助我处理 DevEx 的疯狂问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:49:56.017

我有你的第二个问题的解决方案。

您应该添加下拉按钮事件处理程序，如下所示：

```
dropDownButton1.LostFocus += new EventHandler(HidePopUp); 
```

处理程序方法应如下所示：

```
private void HidePopUp(object sender,object e)
        {
            dropDownButton1.HideDropDown();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T15:49:49.160

对于第二个问题，您应该将值分配给 bar manager 属性，如下所示：

```
BarManager manager = new BarManager();
manager.Form = this; // refers to current form 
```

查找以下链接以供参考 [https://www.devexpress.com/Support/Center/Question/Details/Q274641](https://www.devexpress.com/Support/Center/Question/Details/Q274641)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T10:52:11.000

It is probably simpler to use DefaultLookAndFeel

Add this comp to your form and set the theme you'd like to use. There is no need to set the theme for individual components.

```
defaultLookAndFeel1.LookAndFeel.SetSkinStyle("Office 2010 Blue"); 
```

# javascript - 无法获取 JavaScript 对象的属性

> ID：12573245
> 
> 赞同：0
> 
> 时间：2012-09-24T21:33:36.430
> 
> 标签：javascript, object, properties

我将 JSON 从 php 文件返回到 jQuery 函数，并且正在获取`output`具有属性`agt_id`和`agt_type`. 使用 webkit 开发工具，我可以打印查看对象、展开它并查看属性。但是，当我尝试时，我变得不确定：

```
console.log(output.agt_id); 
```

这是我在控制台中看到的内容`console.log(output)`：

![来自控制台的图像](../Images/a09d805a683c53df5659c3d2c2afac26.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:38:33.067

从您的屏幕截图中，您的对象看起来像是在一个数组中。您可以访问`0`数组索引处的对象。

```
console.log(output[0].agt_id); 
```

# jquery - jQuery ui-autocomplete 没有价值

> ID：12573246
> 
> 赞同：0
> 
> 时间：2012-09-24T21:33:54.593
> 
> 标签：jquery, jquery-ui, autocomplete, combobox, return-value

我一直在寻找解决这个问题的方法。我想根据 jquery 组合框中的选择隐藏/显示 div。如果我显示底层选择框并以这种方式进行选择，但我无法让它与我的组合框一起使用。

你可以在这里看到一个例子：

[http://jsfiddle.net/RDd3A/71/](http://jsfiddle.net/RDd3A/71/)

如果您选择除第一个选项之外的任何选项，则应该隐藏 div。如果您使基础选择框显示 #combobox 并选择这种方式它可以工作。

如何仅使用组合框使其工作？

# uiviewcontroller - 如何有条件地从单个 UITabBar 项目中选择 UIViewController 并保持 TabBar 可见

> ID：12573250
> 
> 赞同：1
> 
> 时间：2012-09-24T21:34:11.730
> 
> 标签：uiviewcontroller, storyboard, uitabbar

关于 S/O 的第一个问题，如果我没有遵循任何协议，请道歉。我一直在尝试使用来自同一个 UITabBar 项目的 4 个 UIViewController 有条件地显示 4 种不同类型的场景。它必须是 TabBar 上的相同项目，因为使用的 UIViewController 取决于数据而不是用户选择。

我知道不建议子类化 UITabBarController，所以我设置了一个 UIViewController 来处理所需场景的条件选择（参见下面的代码）。这很好用，但尽管尝试了我能想到的一切，但无法在新选择的视图底部显示 TabBar。我也尝试过使用 UINavigation 控制器，但这不太成功。在 Storyboard 中，我尝试了设置视图大小和演示样式的所有不同排列，在模拟指标中将底部栏更改为选项卡栏，并尝试使用 Segues。没有人产生必要的结果。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    int m = 1;

    UIViewController *viewController;
    if (m == 1 || m == 3 || m == 5 || m == 7 || m == 8 || m == 10 || m == 12 ) {
        viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M31TVC"];
    }else if (m == 4 || m == 6 || m == 9 || m == 11 ){
        viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M30TVC"];
    }else if (m == 13 ){
        viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M29TVC"];
    }else if (m == 2 ){
        viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M28TVC"];
    }else {
        // error code here
    }
    viewController.hidesBottomBarWhenPushed = NO;
    [self presentViewController:viewController animated:NO completion:nil];

} 
```

提前感谢任何知道如何做这件事的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T13:54:51.050

与其尝试替换将显示给用户的控制器，不如只替换其视图。这意味着您应该实现一个容器视图控制器：

*   创建您的 UITabBarController 并将其中一项设置为 UIViewController
*   把它变成一个自定义控制器并向它添加以下属性。

    ```
    @property (nonatomic, strong) IBOutlet UIView *currentView
    @property (nonatomic, strong) UIViewController *currentViewController 
    ```

*   将 UIView 添加到情节提要中的控制器并将其连接到 *currentView 插座。

现在，每当用户在您的应用程序中到达这一点时，您将执行以下操作：

```
UIViewController *viewController;
if (month == 1 || 3 || 5 || 7 || 8 || 10 || 12 ) {
    viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M31TVC"];
}else if (month == 4 || 6 || 9 || 11 ){
    viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M30TVC"];
}else if (month == 13 ){
    viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M29TVC"];
}else if (month == 2 ){
    viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"M28TVC"];
}else {
    // error code here
}

[self addChildViewController:viewController];
[viewController didMoveToParentViewController:self];

if (self.currentViewController){
    [self.currentViewController willMoveToParentViewController:nil];

    [self transitionFromViewController:self.currentViewController toViewController:viewController duration:0 options:UIViewAnimationOptionTransitionNone animations:^{
        [self.currentViewController.view removeFromSuperview];
        [self.currentView addSubview:viewController.view];
    } completion:^(BOOL finished) {
        [self.currentViewController removeFromParentViewController];
        self.currentViewController = viewController;
    }];
} else {
    [self.currentView addSubview:viewController.view];
    self.currentViewController = viewController;
} 
```

这就是我在我的应用程序上创建自定义选项卡式控制器的方法，而不是使用默认的 UITabBarController。

# html - iOS6 CSS3 3D 变换非常慢

> ID：12573252
> 
> 赞同：2
> 
> 时间：2012-09-24T21:34:16.640
> 
> 标签：html, css, transform, ios6, hardware-acceleration

**编辑：**这个问题将在我被允许这样做的两天内获得 500 声望的赏金。如果在此期间得到答复，第一个发布修复的作者将尽快获得声誉。

与 iOS5.1 相比，iOS6 似乎非常糟糕地破坏了 CSS3 转换的性能。如果您可以提供一个修复程序，使以下示例在 iOS6 上的性能恢复到与 iOS5.1 相当的水平，而不失一般性，您可以拥有一堆我来之不易的声誉。该示例在 iOS5.1 上运行良好（在 iPhone 4 和 4S 上）。iOS Chrome 应用程序是运行此测试的好地方，因为它嵌入了 UIWebView。

现在，这些元素似乎正在被硬件加速，但苹果的低级管道中存在一个会降低性能的错误。我已经尝试了许多硬件加速的解决方法，似乎在 iOS5.1 上调用 GPU 的任何东西都会导致 iOS6 上的大幅减速。

即使您如下修改 animate 函数，该错误仍然存​​在。

```
function animate(node) {
    node.style.webkitAnimation = 'sample 5s infinite';
    node.style.webkitPerspective = 1000;
    node.style.webkitBackfaceVisibility = 'hidden';
} 
```

请帮助我对抗 iOS6 的暴政并发布我现在严重损坏的应用程序。

```
<!DOCTYPE html>
<html>
    <head>
        <title>Animation Playground</title>
        <style>
            @-webkit-keyframes sample {
                0% { -webkit-transform: translate3d(0px, 0px, 0px); }
                10% { -webkit-transform: translate3d(0px, 0px, 0px); }
                20% { -webkit-transform: translate3d(10px, 0px, 0px); }
                40% { -webkit-transform: translate3d(10px, 10px, 0px); }
                50% { -webkit-transform: translate3d(10px, 20px, 0px); }
                80% { -webkit-transform: translate3d(20px, 20px, 0px); }
                100% { -webkit-transform: translate3d(0px, 0px, 0px); }
            }
        </style>
        <script type="text/javascript">
            function fib(node, a, b) {
                node.innerHTML = a;
                setTimeout(function() {
                    fib(node, a + b, b);
                }, 0);
            }

            function animate(node) {
                node.style.webkitAnimation = 'sample 5s infinite';
            }

            function createNode(row, column) {
                var node = document.createElement('div');
                node.style.width = '7px';
                node.style.height = '7px';
                node.style.position = 'absolute';
                node.style.top = 30 + (row * 9) + 'px';
                node.style.left = (column * 9) + 'px';
                node.style.background = 'green';
                return node;
            }

            function run() {
                for (var row = 0; row < 20; ++row) {
                    for (var column = 0; column < 20; ++column) {
                        var node = createNode(row, column);
                        document.body.appendChild(node);
                        animate(node);
                    }
                }

                var output = document.getElementById('output');
                fib(output, 0, 1);
            }
        </script>
    </head>
    <body onload="run()">
        <div id="output" style="font-size: 40px; position: absolute; left: 220px;"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T04:27:10.777

发出 translate3d 魔术调用时，iOS6 不再自动 GPU 加速内容。一些请求者建议 requestAnimationFrame 将调用必要的调解者并安抚强大且不可知的 iOS 恶魔 - 可能在牺牲一只小山羊（必须没有瑕疵）之后。其他人建议为透视和背面可见性添加内联样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T15:30:36.993

iOS 6 需要一组不同的 CSS 规则来触发硬件加速。

试试这个：

```
-webkit-transform: translate(0,0) translateZ(0); 
```

**编辑：** 我实际上发现它`translate3d()`仍然有效，只要值作为过渡的一部分发生变化。所以，这*不起作用*：

```
.element.position   {-webkit-transition: left 1s ease; 
                     -webkit-transform: translate3d(0,0,0)}    
.element.position-a {left: 0}
.element.position-b {left:500px} 
```

但这*确实*有效：

```
.element.position   {-webkit-transition: all 1s ease}    
.element.position-a {-webkit-transform: translate3d(0,0,0)}
.element.position-b {-webkit-transform: translate3d(500px,0,0)} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T07:28:56.220

切勿将左/上定位与 translate() 或 translate3d() 混合 - 即使在台式计算机上，这也会非常慢，可能会导致速度变慢

# ruby-on-rails - 如何删除视图中的链接？

> ID：12573254
> 
> 赞同：0
> 
> 时间：2012-09-24T21:34:27.880
> 
> 标签：ruby-on-rails, ruby

我有一个 Rails 网站，下面的脚本用于在页面上显示图像。图像有一个链接到图像路径的链接：

```
<%= if property.images[0] then link_to image_tag (property.images[0].image.url('550x412', :jpg)), user_property_image_path(user, :id => property.images[0], roperty_id => property) end -%> 
```

我想删除图片的链接；我只想让它显示没有链接的照片。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T21:46:54.060

`<%= if property.images[0] then image_tag (property.images[0].image.url('550x412', :jpg)) end %>`

阅读`link_to`帮助方法。

# php - onchange F(x) 到 php 到同一页面上的 Highchart

> ID：12573255
> 
> 赞同：0
> 
> 时间：2012-09-24T21:34:30.683
> 
> 标签：php, javascript, ajax, json, highcharts

我正在继续上一个问题，即[onclick -> mysql query -> javascript; 同一页](https://stackoverflow.com/questions/12304900/onclick-mysql-query-javascript-same-page)

这是我用于下拉名称的 onchange 函数。它在每个下拉列表更改时调用。这个想法是将每个跑步者的名字发送到 php 页面以运行 mysql 查询，然后返回 3 个要输入到 javascript 的数组。

```
function sendCharts() {
var awayTeam = document.getElementById('awayRunner').value;
var homeTeam = document.getElementById('homeRunner').value;        

if(window.XMLHttpRequest) {
    xmlhttp14 = new XMLHttpRequest();

}
else {
    xmlhttp14 = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp14.onreadystatechange = function() {
    if(xmlhttp14.readyState == 4 && xmlhttp14.status == 200) {

   var parts = xmlhttp14.responseText.split(','); //THIS IS WHAT IS RETURNED FROM THE MYSQL QUERY. WHEN I ALERT IT, IT OUTPUTS IN THE FORM 14,15,18,16,17,12,13 

          ... code that generates the chart 
        series: [   {
                        name: document.getElementById('awayRunner').value,
                        data: [parts,','], //THIS IS WHERE AN ARRAY MUST BE ENTERED. THIS OUPUTS ONLY ONE NUMBER 
                        type: 'column',
                        pointStart: 0
                        //pointInterval
                    },

                    {

                        name: document.getElementById('homeRunner').value,
                        data: parts, // TRIED THIS
                        type: 'column',
                        pointStart: 0
                        //pointInterval
                    },

                    {
                        name: 'League Avg',
                        data: [], //THIS IS WHERE 3rd ARRAY MUST BE ENTERED
                        type:'spline',
                        pointStart: 0
                        //pointInterval
                    },
                ]
    });

    }
}
xmlhttp14.open("GET", "getCharts.php?awayRunner="+awayRunner+"&homeRunner="+homeRunner, true);
xmlhttp14.send(); 
```

}

我的 php 代码看起来像这样。如您所见，必须返回 3 个数组才能输入到 javascript 中的不同位置以生成代码。

```
$away=$_GET['awayRunner'];
$home=$_GET['homeRunner'];

$db=mydb;

$homeRunner=array();
$awayRunner = array();
$totalOverall= array();

$getHome="select column from $db where tmName = '$home'";
$result2 = mysql_query($getHome);
while($row = mysql_fetch_array($result2)){
$homeRunner[]= $row['column'];
}

$getAway="select column from $db where tmName ='$away'";
$result22 = mysql_query($getAway);
while($row2 = mysql_fetch_array($result22)){
$awayRunner[]= $row2['column'];

}

$week = 0;
while($week<20){
$week++;
$teamCount = "select count(column) from $db where week = $week";
$resultTeam =  mysql_query($teamCount);
$rowTeam = mysql_fetch_array($resultTeam);
$t = $rowTeam['count(column)'];

$getLeague = "select sum(column) from $db where week = $week";
$resultLeague = mysql_query($getLeague);
while($row3 = mysql_fetch_array($resultLeague)){
    $totalOverall[]=$row3['sum(column)']/$t;
    }
}
echo join(',',$awayRunner); 
```

目前，通过这种方式，图表仅输出数组中的第二个值。例如，如果 var 部分等于 23,25,26,24,23...仅显示 25。

上一个问题得到以下答案 -

1.  加载页面。
2.  用户选择一个选项。
3.  onChange 侦听器触发 AJAX 请求
4.  服务器接收并处理请求
5.  服务器为相关选择发回一个 JSON 数组选项
6.  客户端 AJAX 发送方得到响应
7.  客户端更新选择以获取 JSON 数组中的值。

我在#'s 5 - 7 上迷路了。有人可以提供完成此操作的代码示例吗？通常，我只会询问方向，但我已经被这个问题困扰了好几天。我准备放弃在我的网站上放置图表的想法。提前致谢

```
EDIT 
```

这是我为发送和接收一个请求所做的第一个更改

```
<script>
$(function(){
    $("#awayRunner").change(function(){ 
        $.ajax({
        type: "POST",    
        data: "data=" + $("#awayRunner").val(),
        dataType: "json",
        url: "/my.php",
        success: function(response){
            alert(response);  
        }
        });
    });
}); 
```

提示框中显示的数据格式为 12、15、16、15。现在，当我输入 data: response 时，图表中只显示了每个数字中的第二个数字。有任何想法吗？

```
EDIT 
```

好的，所以我发现响应的信息是一个字符串。必须使用 parseInt 将其转换为 INT 才能在图表中使用。目前，我有

```
$("#awayTeam").change(function(){ 
        $.ajax({
        type: "POST",    
        data: "away=" + $("#awayTeam").val(),
        dataType: "json",
        url: "/getCharts.php",
        success: function(response){
              var asdf = [];
              asdf[0] = parseInt(response[0]);
              asdf[1] = parseInt(response[1]);
              asdf[2] = parseInt(response[2]);
              asdf[3] = parseInt(response[3]); 
              alert(asdf); 
```

将不得不编写一个函数来使这个更干净。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T04:31:08.917

我不敢相信，但我终于明白了。这是我如何使用 onchange 方法来刺激 MYSQL 查询并让 Highchart 显示结果。主要问题是返回的 JSON 数组是一个需要转换为 INT 的字符串。然后在数据中使用 resultArray 变量：highChart 的部分。

```
$(function(){
    $("#awayTeam").change(function(){ 
        $.ajax({
        type: "POST",    
        data: "away=" + $("#awayRunner").val(),
        dataType: "json",
        url: "/getCharts.php",
        success: function(response){
              var arrayLength = response.length;
              var resultArray = [];
              var i = 0;
              while(i<arrayLength){
                  resultArray[i] = parseInt(response[i]);
                  i++;
              } 
```

在 PHP 代码中，数组必须像这样返回为 JSON

```
echo json_encode($awayRunner); 
```

# php - 搜索后执行 PHP 页面 + 替换 HTML 中语言翻译的关键字

> ID：12573260
> 
> 赞同：2
> 
> 时间：2012-09-24T21:35:21.880
> 
> 标签：php, localization

我正在将我的网站翻译成不同的语言，并且我有超过 130 个页面，所以我想通过一个将替换关键字
IE 的函数传递我的 .php 文件：附件 = อุปกรณ์<br /> 这是英语到泰语。

但是我可以使用我的方法让它工作......我在这些页面中有php（显然），输出只显示html而不执行php

是否有标题方法或我必须在我的 php 页面开头传递的东西..

这是我用来查找文本结果然后从我的 php 文件中替换它们的函数。

```
 <?php

    // lang.php
    function get_lang($file)
    {

    // Include a language file
        include 'lang_thai.php';

    // Get the data from the HTML
        $html = file_get_contents($file);

    // Create an empty array for the language variables

        $vars = array();

    // Scroll through each variable

        foreach($lang as $key => $value)

        {

            // Finds the array results in my lang_thai.php file (listed below)

            $vars[$key] = $value;
        }

    // Finally convert the strings

        $html = strtr($html, $vars);

    // Return the data

        echo $html;

    }

    ?> 
```

//这是lang_thai.php文件

```
 <?php

    $lang = array(
    'Hot Items' => 'รายการสินค้า', 
    'Accessories' => 'อุปกรณ์'

    );

    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T21:34:41.337

许多框架使用一个函数来进行翻译，而不是使用 .pot 文件进行替换。该函数如下所示：

```
<h1><?php echo _('Hello, World') ?>!</h1> 
```

因此，如果它是英语且未翻译，则该函数只会返回未翻译的字符串。如果要翻译它，那么它将返回翻译后的字符串。

如果您想继续执行绝对更快的路线，请尝试以下操作：

```
<?php
    function translate($buffer) {
        $translation = include ('lang_tai.php');

        $keys = array_keys($translation);
        $vals = array_values($translation);

        return str_replace($keys, $vals, $buffer);
    }

    ob_start('translate');

    // ... all of your html stuff 
```

您的语言文件是：

```
<?php
    return array(
        'Hot Items' => 'รายการสินค้า', 
        'Accessories' => 'อุปกรณ์'
    ); 
```

一件很酷的事情是`include`可以返回值！所以这是从文件传递值的好方法。ob_start 也是一个带有回调的输出缓冲区。因此，在您将所有 html 回显到屏幕之后，就在它实际显示到屏幕之前，它会将所有数据传递给`translate`函数，然后我们翻译所有数据！

# c - perror() 给出段。过错

> ID：12573266
> 
> 赞同：1
> 
> 时间：2012-09-24T21:35:36.127
> 
> 标签：c, linux, gcc, posix, errno

发生错误后，我`perror()`自然会调用 。但是当我这样做时，我遇到了分段错误，或者 `printf("error: %s\n", strerror(errno));`我不知道发生了什么。

```
 int fd;
  if((fd = open(FILENAME, O_RDONLY)) == -1) {
    perror("fbi");
    exit(1);
  }

  for(;;) {

    readed = read(fd, buffer, BUFSIZE);

    if(readed == 0)
      break;

    if(readed == -1) {
      perror("fbi"); // <- here's the error
      exit(1);
    } 
```

如何解决这个问题？

**更新：**

```
printf("%d\n", errno); // given 9 
```

**更新2：**

看起来与`recv()`函数中传递的缓冲区大小有关系。如果`BUFSIZE`是`1`，给出上述错误。但是如果`BUFSIZE`是例如，`128` **没有错误**。有人可以解释这种行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T18:22:33.900

不可能从这个片段中确切地知道什么是错误的。但总的来说，“为什么我在调用 [rock solid c library func here] 时会出现段错误”这个问题的答案？通常是：你的堆栈是油炸的。阅读，当然是一个主要的嫌疑人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-16T21:21:38.903

一定要`#include <string.h>`等。

* * *

我`#include <errno.h>[...]printf("%s\n",strerror(errno));[...]`在宏内使用了几天没有问题。然后有一天我添加了另一个调用`strerror(errno)`，结果包括奇怪的行为、分段错误、不正确的返回类型、意外的程序终止（退出状态为 0），这一切都取决于我如何调用第二次`strerror`调用。

一些简单的事情`strerror(errno)==NULL`会导致`warning: comparison between pointer and integer`.

原来是因为我`strerror`没有使用`#include <string.h>`. 由于该函数作为标准 c 库的一部分被正确链接，因此编译器会创建一个（标准强制）该函数的“隐式声明”，该函数假定定义*为*`int strerror(int)`. 不兼容的返回类型会导致问题，因为在我的系统`char*`上是 64 位但是`int`32 位。因此，取决于编译器如何安排内存空间，有时指针将适合 32 位，有时它们不会，有时不正确的地址恰好匹配其他分配的内存页面（未定义/空白输出），有时它们不匹配（分段过错）。我碰巧遇到了一种情况，它不适合 32 位，编译器将返回值“强制转换”为 32 位`int`然后将它（for `printf`）转换回 64 位`char*`（没有丢失的 64 位的上半部分现在为零），当处理器尝试从未分配的内存页面读取时，会出现未定义的行为。

诊断您的特定情况将需要一个[简短的、自包含的、可编译的示例 (SSCCE)](http://www.sscce.org/)，例如您引用了一个`recv`函数调用（我假设您的意思是阅读？）。

您还需要包含用于编译代码的命令，例如，链接命令的顺序可能会显着改变生成代码的行为。

# salesforce - Salesforce 从联系人获取 MailingAddress

> ID：12573267
> 
> 赞同：3
> 
> 时间：2012-09-24T21:35:40.120
> 
> 标签：salesforce

我正在编写一个 Apex 程序来遍历联系人列表并在另一个数据库中查找地址。联系人有一个内置的 MailingAddress 字段，但访问数据成员会给我一个编译错误：

错误：编译错误：第 65 行第 55 列的 SObject 联系人的字段 MailingAddress 无效

获取邮寄地址的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-24T21:41:16.493

这些字段被称为`MailingStreet, MailingCity, MailingState, MailingPostalCode, MailingCountry`

我建议你找到一个模式浏览器工具并熟悉它（例如[SoqlX](http://www.pocketsoap.com/osx/soqlx/)、[apexExplorer](http://wiki.developerforce.com/page/Tools)、[Schema Surfer](http://appexchange.salesforce.com/listingDetail?listingId=a0N30000009wZM3EAM)有很多），它们将帮助你快速了解组织中模式的所有 API 名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T12:45:59.573

Salesforce 中标准对象中存在的所有标准（内置）字段都可以从顶点代码[Salesforce 对象字段中访问](http://www.salesforce.com/us/developer/docs/api/index.htm)

此链接将提供对所有标准构建字段的访问。转到参考>>标准对象。

# c++ - 带有提升“语义问题 - 未声明的标识符 va_start”的 XCode

> ID：12573271
> 
> 赞同：11
> 
> 时间：2012-09-24T21:35:52.740
> 
> 标签：c++, xcode, macos, boost

```
C++locale.h
->Semantic Issue
-->Use of undeclared identifier 'va_start'
->Semantic Issue
-->Use of undeclared identifier 'va_end' 
```

第一次使用 boost，使用端口下载它并在 XCode 中创建了一个命令行项目。标头搜索路径：/usr/include/**

代码中还没有任何内容，只有默认 proj 附带的 main 函数。

只是不知道该怎么办，没想到会发生这种事。

编辑1：

第一次出现：

```
#ifndef _GLIBCXX_CSTDARG
#define _GLIBCXX_CSTDARG 1

#pragma GCC system_header

#include <bits/c++config.h>
#include <stdarg.h>

// Adhere to section 17.4.1.2 clause 5 of ISO 14882:1998
#ifndef va_end
#define va_end(ap) va_end (ap)
#endif

_GLIBCXX_BEGIN_NAMESPACE(std)

  using ::va_list;

_GLIBCXX_END_NAMESPACE

#endif 
```

这是一个在 \usr\include\c++\4.2.1 中没有扩展名的文件，我刚刚意识到这个文件与 boost 无关，这里发生了一些令人讨厌的事情。

EDIT2：将包含目录修复为 /opt/local/include/** 后出现新错误：

```
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/c++/v1/type_traits:214:46:
Use of undeclared identifier 'nullptr_t'; did you mean 'nullptr'? 
```

还有其他的错误，都和sr/lib/c++/v1/文件夹下的这些文件有关，这是为什么呢？这些文件似乎是一些核心功能，它们不能被破坏。

这是错误的图片，也许你们看到了什么 ![错误](../Images/d137c32d242264fa6a9e46f0fc418c2e.png)

EDIT3：将编译器从 Apple LLVM 更改为 GCC LLVM 将错误减少到只有一个：“vspintf 不是 'std' 的成员”在 c++locale.h 中。好吧，现在我完全迷路了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-17T13:45:52.467

我有同样的问题，我已经用自制软件安装了 Boost，当我在 XCode 中添加“标题搜索路径”（/usr/local/Cellar/boost/1.54.0/include 和递归选项）时，构建会抛出这些错误.

为了解决这个问题，我将“标题搜索路径”上的递归选项更改为非递归，并且它起作用了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T23:48:02.207

首先，您可能没有使用`#include`正确的标题。

例如，如果你不这样做`#include <cstddef>`，你就不能使用`std::nullptr_t`; 尝试这样做会给你：

```
Semantic issue: Use of undeclared identifier 'nullptr_t'. Did you mean 'nullptr'? 
```

通常，拉入一个标头会隐式拉入各种其他标头，因此即使在不应该的情况下也能正常工作。libstdc++ 比 libc++ 做的更多，前者是 llvm-g++（“GCC LLVM”）的默认库，后者是 clang（“Apple LLVM”）的默认库，这意味着很多错误似乎会消失你切换到“GCC LLVM”（或者只是坚持使用“Apple LLVM”并切换你的库），但你的代码仍然是错误的。

另一种可能性是您尝试在 C++03 模式下编译 C++11。例如，当您`#include <cstddef>`处于 C++03 模式时，它不应该定义`nullptr_t`. 无论如何，它可能会这样做——它可能会使用 llvm-g++ 和/或 libstdc++，但不会使用 clang 和/或 libc++。但是你的代码（或者，在这种情况下，你的项目）仍然是错误的，应该修复。

如果您可以向我们展示生成这些错误的实际（精简）代码，并准确告诉我们您在 Xcode 中创建的默认“命令行工具，C++”项目更改了哪些设置（假设这是您创建的），它应该可以更具体。

要获得一个使用 boost 的最小程序，假设你已经正确安装了 Xcode、MacPorts 和 MacPorts boost，你所要做的就是：

*   创建一个新的命令行工具 C++。
*   单击项目，然后在搜索路径下，转到标题搜索路径，然后对其进行编辑以添加`/opt/local/include`.
*   修改`main.cpp`为如下所示：

主文件

```
#include <iostream>
#include <boost/uuid/uuid.hpp>

int main(int argc, const char * argv[])
{
    boost::uuids::uuid u1 = {
        0x12, 0x34, 0x56, 0x78,
        0x90, 0xab, 0xcd, 0xef,
        0x12, 0x34, 0x56, 0x78,
        0x90, 0xab, 0xcd, 0xef };
    boost::uuids::uuid u2 = {
        0x12, 0x34, 0x56, 0x78,
        0x90, 0xab, 0xcd, 0xef,
        0x12, 0x34, 0x56, 0x78,
        0x90, 0xab, 0xcd, 0xef };
    std::cout << (u1 == u2) << "\n";
    return 0;
} 
```

我选择 boost::uuid 是因为它是一个非常简单的库，但同样适用于编译 boost 的任何部分。

boost 的某些部分还要求您在库中链接。为此，您还需要添加`/opt/local/lib`到库搜索路径，然后才能使用大多数常用技术将库添加到项目中。

请注意，如果您是最新的，则可以将其缩短，因为在 Xcode 4.5 中，默认值为 Apple LLVM 编译器 4.1、GNU++11 方言和带有 C++11 支持库的 libc++。但是我确保我的代码与 C++03 兼容，因此它几乎可以在任何 Xcode 版本中使用默认值（我使用 3.2 进行了测试），因为您从未告诉我们您使用的是什么版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-22T21:27:48.140

我遇到了这个问题并解决了。在 osx mavericks 上的 XCode 中，必须将 /opt/local/libs/ 添加到库搜索路径（非递归）。然后我将 /opt/local/include/ 添加到标题搜索路径（也是非递归的）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-24T21:40:17.347

你需要`#include <stdarg.h>`为了使用`va_start`宏等。如果这些错误发生在头文件中，则该头文件应包括`<stdarg.h>`; 如果没有，您可以在包含有问题的标头*之前*通过自己包含它来解决它（但如果可能，您还应该向库开发人员报告该问题）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-24T22:50:09.193

从最新的评论中，我想我知道问题所在。

> 标头搜索路径：/usr/include/**
> 
> 刚刚创建了另一个全新的 XCode 命令行工具应用程序。构建 Hello World 时完全没有错误，但只是添加了 Header Search Path 会破坏编译并出现上述错误，我的代码中还没有提到 boost，只是添加了搜索路径。

你从哪里得到的搜索路径`/usr/include/**`？

MacPorts 将所有内容安装到`/opt/local`, not `/usr`, 所以你想要`/opt/local/include`(or `/opt/local/include/**`or `/opt/local/include/boost`); 添加`/usr/include/**`对Boost根本没有帮助。

但是，它甚至*可能*在您使用 Boost 之前破坏您的代码。

里面有`/usr/include`Xcode 的命令行工具。如果你没有这些，你就会得到一组不完整且无法使用的标题；如果你这样做了，你就会得到一组与基于 SDK 的构建冲突的头文件。

答案是不要添加`/usr/include/**`到您的搜索路径中。

或者，如果您确实需要添加它（但实际上，您不需要），请将 Base SDK 更改为“Current OS X”而不是“Latest OS X”，这意味着您将获得默认标`/usr/include`头的，例如 ，`/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/usr/include`当然添加已经存在的路径不会导致任何冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-11T23:42:08.493

我似乎已经修复了它。在尝试使用 homebrew、macports 和手动安装之后，很难在 Xcode 的后端找到需要更改的所有内容，我承认有时仍然会感到有些困惑。所以标题搜索路径仍然包含自制地窖作为长路径名的一部分，所以我根据我在寻找解决方案时发现的一些说明更改了我作为 /usr/local/lib 的这个位 /usr/include 用户标题路径。我现在已将其更改为 /usr/local/lib

经过这些更改，我的错误终于消失了！手指交叉 我现在就知道了

# iphone - 我可以在 iOS 应用程序中将 UIRequiredDeviceCapabilities 从 opengles-1 升级到 opengles-2

> ID：12573272
> 
> 赞同：0
> 
> 时间：2012-09-24T21:35:52.763
> 
> 标签：iphone, opengl-es, xcode4, permissions, cocos2d-iphone

嗨，我正在将我的应用程序从 cocos2d-x 1.x 升级到 2.x，这意味着从 OpenGLES 1.0 更改为 2.0，

我已更新 Info.plist 设置以反映更改

```
<key>UIRequiredDeviceCapabilities</key>
<dict>
    <key>accelerometer</key>
    <true/>
    <key>opengles-2</key>
    <true/>
</dict> 
```

从 opengles-1 更改为 opengles-2

但是在从 XCode 4.5 GM 安装应用程序时（旧版本是用 prevoius XCode 编译的）我收到错误：

**无法更改应用程序的可执行权限**

# mysql - 需要帮助使用 SELECT DISTINCT 结果搜索 MySQL 数据库

> ID：12573277
> 
> 赞同：0
> 
> 时间：2012-09-24T21:36:26.993
> 
> 标签：mysql

所以我是 MySQL 新手，遇到了一些麻烦。我有一张名为 book_genres 的桌子和另一张名为 books 的桌子。

```
book_genres
+-------+---------+
|book_id|  genre  |
+-------+---------+
| 1     | Horror  |
| 1     | Comedy  |
| 2     | Romance |
| 2     | Comedy  |
+-------+---------+

books
+-------+---------+
|book_id|  title  |
+-------+---------+
| 1     | A Book  |
| 2     | B Book  |
| 3     | C Book  |
+-------+---------+ 
```

我正在使用以下命令来提取所有具有 3 个选定流派的 book_id：

```
SELECT DISTINCT a.book_id, b.genre AS genre1, c.genre AS genre2, d.genre AS genre3 
FROM book_genres a 
JOIN book_genres b ON a.book_id = b.book_id AND b.genre LIKE 'Romance' 
JOIN book_genres c ON a.book_id = c.book_id AND c.genre LIKE 'Action' 
JOIN book_genres d ON a.book_id = d.book_id AND d.genre LIKE 'Comedy' 
GROUP BY book_id 
```

我现在要做的是使用在此搜索中找到的 book_ids 从 books 表中提取所有书名。我不确定是否有更简单的方法可以做到这一点，但这就是我能想到的全部。

感谢任何可以提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:44:23.017

我认为这可能是一个更好的方法：

```
select b.*
from books b join
     book_genres bg
     on b.bookid = bg.bookid
where bg.genre in ('Romance', 'Action', 'Comedy')
group by b.book_id 
```

这将选择所有具有三种类型之一的书籍。您的查询不清楚您是否想要在流派之间使用“或”或“和”，所以我假设“或”。

group by 使用了 MySQL 的一项功能，称为“隐藏列”。在这种情况下，它就像一个 distinct。

如果您需要所有三种类型的书籍，您可以这样做：

```
select b.*
from books b join
     (select book_id
      from book_genre
      group by book_id
      having max(case when genre = 'Romance' then 1 else 0 end) > 0 and
             max(case when genre = 'Action' then 1 else 0 end) > 0 and
             max(case when genre = 'Comedy' then 1 else 0 end) > 0
     ) allg
     on b.book_id = allg.book_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:44:49.000

你可以做一个子查询，像这样：

```
SELECT books.title

FROM books

WHERE books.book_id 
IN (
SELECT 
    a.book_id

FROM 
    book_genres a 
    JOIN book_genres b ON a.book_id = b.book_id AND b.genre LIKE 'Romance' 
    JOIN book_genres c ON a.book_id = c.book_id AND c.genre LIKE 'Action' 
    JOIN book_genres d ON a.book_id = d.book_id AND d.genre LIKE 'Comedy' 

GROUP BY book_id
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:03:54.973

好吧，你会踢自己，因为快速而肮脏的答案是

```
SELECT DISTINCT a.book_id, a.book_title,
b.genre AS genre1, c.genre AS genre2, d.genre AS genre3 
FROM book_genres a 
JOIN book_genres b ON a.book_id = b.book_id AND b.genre = 'Romance' 
JOIN book_genres c ON a.book_id = c.book_id AND c.genre = 'Action' 
JOIN book_genres d ON a.book_id = d.book_id AND d.genre = 'Comedy' 
GROUP BY book_id 
```

像 for = 一样交换，因为您没有使用通配符

我认为还有其他几种方法可以做到这一点，但没有一种方法能像你的努力那样容易理解，而且我不确定它们会表现得更好，所以除非表现很糟糕并且无法解决book_genres 的流派列上的索引，我个人会坚持这一点。

# android - 正常 sql 插入或更新时通知内容解析器

> ID：12573278
> 
> 赞同：2
> 
> 时间：2012-09-24T21:36:28.347
> 
> 标签：android

我创建了一个小型内容提供程序（我只用它来查询数据库表并获取一些值）。我已经确认提供商工作正常。

表值通过正常的 sql 插入（而不是通过任何内容提供程序）定期更新

每当通过上述正常的 sqlite 操作发生插入/更新或删除时，我需要通知内容解析器，这些解析器是为了与内容提供者通信而编写的，只是为了查询数据库并获取一些值。

这可能吗？如果是，需要做什么？

任何帮助表示赞赏。

编辑以包括我的数据库插入方法：

```
public void insert(ArrayList<Integer> profileValues, String tableName){
    String duplicationCheck = " WHERE NOT EXISTS (SELECT 1 FROM profiles WHERE devID = "+"'"+profileValues.get(0)+"'"+");";
    if(tableName.equals(PROFILES_TABLE)){
        profilesDB.execSQL("INSERT INTO " +
                PROFILES_TABLE +
                "(devID,alert,findme,proximity,timep,conn_status) SELECT "+"'"+profileValues.get(0)+"'"+","+profileValues.get(1)+","+profileValues.get(2)+","+profileValues.get(3)+","+profileValues.get(4)+","+profileValues.get(5)+duplicationCheck);
    }
    getContentResolver().notifyChange(MY_CONTENT_URI, null);

 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:42:47.003

每当您手动更新底层数据库并需要通知已注册的`ContentObserver`实例时，请立即调用`notifyChange()`.`ContentResolver``Context`

因此，例如，假设您`ContentObserver`使用常量 value注册了 a `MY_CONTENT_URI`：

```
//Insert, update, or delete data in the database

//If you are within a Context, like Activity or Service
getContentResolver().notifyChange(MY_CONTENT_URI, null);

//Otherwise pass in a Context you can call on
context.getContentResolver().notifyChange(MY_CONTENT_URI, null); 
```

`Uri`将通知您通过的特定的所有注册观察员。

# iphone - 加载 ViewController 时显示活动指示器

> ID：12573279
> 
> 赞同：4
> 
> 时间：2012-09-24T21:36:34.113
> 
> 标签：iphone

我有一个 ViewController 需要时间来加载它的视图。当我运行 Instruments 时，我从主屏幕看到，如果我点击将视图控制器推送到堆栈上的图标，它的一半是布局视图，一半是获取视图的数据。当按下按钮将 LongRunningViewController 推入堆栈时，我尝试添加一个活动指示器以显示在按钮上方的主屏幕上。所以我基本上是这样做的：

```
- (IBAction)puzzleView:(id)sender {
    dispatch_async(dispatch_get_main_queue(), ^{
        [self.activityIndicator startAnimating];
    });

    PuzzleViewController *detailViewController = [[[PuzzleViewController alloc] init] autorelease];
    [self.navigationController pushViewController:detailViewController animated:YES];
    [self.activityIndicator stopAnimating];
} 
```

按下按钮时主屏幕滞后，然后加载视图。我试图在另一个屏幕准备被推送时显示活动指示器（或者至少我认为它是这样工作的）。但是，活动指示器不显示。我想知道这是否可以做到？还是其他应用程序推送他们的 ViewController，然后在那个屏幕上，他们有显示不同资源加载的活动指示器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-24T21:47:03.163

当您说获取视图数据需要时间时，我假设您的意思是在`PuzzleViewController`某处做一些不平凡的事情，例如`viewDidLoad`.

所以假设它在`viewDidLoad`. 然后你可以这样做：

```
-(void)viewDidLoad
{
  [self.activityIndicator startAnimating];
  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^
    {
         //do something expensive
         [self doSomethingExpensive];

         //dispatch back to the main (UI) thread to stop the activity indicator
         dispatch_async(dispatch_get_main_queue(), ^
         {
            [self.activityIndicator stopAnimating];
         });
    });
} 
```

这意味着昂贵的操作将被放在后台线程上，并且不会阻塞视图控制器的加载/显示。

这种方法在用户按下按钮时立即显示请求的视图，并在该屏幕上显示进度。我认为这种方式比在呈现视图之前加载内容时显示活动视图更常见。这也为您赢得了更多时间；您的长时间操作可以在过渡动画期间在后台运行！

你的活动视图没有显示你正在做的方式的原因是你在 UI 线程上做这一切；从主队列使用`dispatch_async`主队列不会完成任何事情，因为在运行循环完成之前，您的块将没有机会运行。

# jgit - s3cmd setacl 授予“经过身份验证的用户”

> ID：12573280
> 
> 赞同：2
> 
> 时间：2012-09-24T21:36:34.643
> 
> 标签：jgit, s3cmd

我正在使用[jgit 在 s3 中创建一个遥控器](http://gabrito.com/post/storing-git-repositories-in-amazon-s3-for-high-availability)。当我执行 a`jgit push s3 master`时，它会在 s3 中创建由我的 aws 用户（进行推送的用户）拥有的文件。

我希望这些文件也具有“经过身份验证的用户”权限。

我尝试了以下方法：

*   在 ~/.jgit 文件中设置`acl: authenticated-read`（这会引发错误，因为据我所知，仅支持“公共”或“私人”。
*   `s3cmd`通过:修改推送后的 acl `s3cmd --add-header=x-amz-acl:authenticated-read setacl --acl-private s3://my.bucket/repo/*`。这似乎对文件的 ACL 没有影响（它就像没有运行，但没有错误）

如何执行以下操作之一：

1.  配置 jgit 以在推送到 s3 时设置“经过身份验证的用户”acl（我更喜欢这个）
2.  使用 s3cmd（或其他现有命令行工具）将现有文件的 acl 设置为“经过身份验证的用户”

# git - 大型 Git -repo 与 Rsync、wget 和 Git 同步——还是一些现成的工具？

> ID：12573282
> 
> 赞同：0
> 
> 时间：2012-09-24T21:36:48.637
> 
> 标签：git, wget, rsync

我的朋友想以电子方式存储她的学校笔记并快速处理它们，并带有备份。她已经拥有超过 2GB 大小的 repo，并且一直在增长（主要是附加材料，即更多的学校笔记、不同格式、pdf、图片和扫描件、一些文本文件等）。我朋友的目标是快速处理笔记。我[在这里](http://www.commandlinefu.com/commands/view/901/download-an-entire-website)建议了这样的命令，即`"# crontab -e @weekly wget --random-wait -e robots=off -U mozilla -mirror http://VeryLong.com"`。但我认为在某个地方插入 Rsync 可以使 Git 变得更好，而不是每周受到欺骗，即试图保持合理的大小。

**帮助问题**

> 1.  我应该如何在这里使用 Rsync 和 Git？我需要 wget 吗？
>     
>     
> 2.  像`"ssh port:herWebSite.com:port"-and-then-directing-to-localhost/etc 这样的命令可能意味着隐私-和平但使事情复杂化，同时以某种方式轻松解决这个问题？我正在考虑建议她存储只能通过 SSH-priv-key 访问的笔记，但我仍然在想我应该如何帮助她不要让事情变得过于复杂。
>     
>     
> 3.  您将如何帮助我的朋友在 Git 版本控制下处理和存储学校材料并保持合理的大小？

**也许相关**

> 1.  [rsync .git 目录](https://stackoverflow.com/questions/1398018/rsync-git-directory)
>     
>     
> 2.  [rsync git 大仓库](https://stackoverflow.com/questions/7167442/rsync-git-big-repository)
>     
>     
> 
> **不同的范围**
> 
> 3.  [Git/rsync 混合用于具有大型二进制文件和文本文件的项目](https://stackoverflow.com/questions/11281678/git-rsync-mix-for-projects-with-large-binaries-and-text-files)
>     
>     
> 4.  [使用 git 组织大量个人脚本的好方法是什么？](https://stackoverflow.com/questions/2657899/whats-a-good-way-to-organize-a-large-collection-of-personal-scripts-using-git)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T05:26:37.627

您可能想研究`git-annex assistant`：

*   [http://git-annex.branchable.com/assistant/](http://git-annex.branchable.com/assistant/)
*   [http://www.kickstarter.com/projects/joeyh/git-annex-assistant-like-dropbox-but-with-your-own](http://www.kickstarter.com/projects/joeyh/git-annex-assistant-like-dropbox-but-with-your-own)

可能还没有为 Windows/Mac 做好准备，但看起来它今天刚刚进入 Linux 测试版。

# java - 如何正确使用传递给android线程的参数？

> ID：12573296
> 
> 赞同：0
> 
> 时间：2012-09-24T21:38:27.650
> 
> 标签：java, android, multithreading, android-asynctask, inputstream

我有一个外部 .hash 文件，我厌倦了将其作为一个简单的远程文本文件阅读：

```
private class getHash extends AsyncTask<String, Void, String>{
    @Override
    protected String doInBackground(String... params) {
        String str = null;
        try {
            // Create a URL for the desired page
            URL url = new URL(params[0]);

            // Read all the text returned by the server
            InputStream is =  url.openStream();//The line it crashes on
            InputStreamReader isr = new InputStreamReader(is);
            BufferedReader in = new BufferedReader(isr);
            str = in.readLine();
            in.close();
        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return str;
    }
    @Override
    protected void onPostExecute(String result) {
        hash = result;
    }
} 
```

然后我调用线程：

```
getHash hashThread =  new getHash();
hashThread.execute(new String[]{"http://www......................hash"}); 
```

在执行课堂上提到的行期间，所有停止都被拉动，我被优雅的`Source not found`撞车扇了耳光。

LogCat 给出了这个错误：

```
W/dalvikvm(724): threadid=1: thread exiting with uncaught exception (group=0x40a13300) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:07:49.933

您是在调试模式还是常规模式下运行它？该`source not found`消息似乎表明您正在尝试进入没有附加源的代码。

你也添加 `<uses-permission android:name="android.permission.INTERNET" />` 到你的`AndroidManifest.xml`?

# alloy - Alloy 内置整数数学函数在导入的文件中不起作用

> ID：12573298
> 
> 赞同：5
> 
> 时间：2012-09-24T21:38:34.270
> 
> 标签：alloy

我在 avlTree.als 中有一个合金模型。该模型使用整数运算，特别是加号和减号函数。这个模型中有一些断言，我可以使用 Alloy Analyzer GUI 很好地运行这些断言。

我在 test.als 中有另一个合金模型。该模型导入 avlTree（使用“open avlTree”），然后对 avlTree 模型中的关系进行一些断言。但是当我尝试在 Alloy Analyzer GUI 中运行这些断言时，我收到以下消息：

> 发生语法错误：
> 
> 找不到名称“加号”。

语法错误的链接将我带到我的 avlTree 模型。因此，当我自己运行该模型时，似乎 avlTree 模型对整数数学的使用效果很好，但是当我尝试将其导入另一个模型时它会中断。有解决办法吗？

我正在运行合金 4.2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:38:11.307

是的，这是一个错误，但有一个快速的解决方法，即显式打开整数模块，通过编写

```
open util/integer 
```

在 avlTree.als 文件的开头。之后，您将能够打开 avlTree 并从其他模块检查其断言。

# java - eclipse生成可执行jar文件背后的魔力

> ID：12573302
> 
> 赞同：6
> 
> 时间：2012-09-24T21:38:41.430
> 
> 标签：java, jar, executable-jar

我可以用 Eclipse 制作一个可执行的 jar 文件。假设它被称为`ast.jar`，并且 Main 类是 ASTExplorer。我可以验证这是否适用于`java -jar ast.jar`.

然后，我将 jar 文件解压缩到一个单独的目录中，并验证 ASTExplorer 是否在 astexplorer 目录中。但是当我执行这个命令时，`java -cp . astexplorer.ASTExplorer`我得到了这个错误。

```
java -cp . astexplorer/ASTExplorer
Exception in thread "main" java.lang.NoClassDefFoundError: org/eclipse/swt/widgets/Composite
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615) 
```

问题是 jar 文件中没有 org/eclipse/swt 目录。

![目录截图](../Images/d867b3889a9f10f5f4e0f24ace9c26e0.png)

可执行 jar 文件背后的魔力是什么？为什么解压后不运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:07:02.570

当 Eclipse 打包一个可运行的 jar 时，它会将依赖项包含为嵌套的 jar 文件，还包括一个特殊的类加载器，该类加载器了解如何在嵌套的 jar 中查找类。它仅适用于嵌套的罐子，当您提取所有内容时，您会阻止它工作。

我查看了 Eclipse 生成的可运行 jar，这就是我认为您需要做的：

1.  将所有内容提取到目录中。依赖 jar 在顶层目录中提取
2.  ~~删除org/eclipse/jdt/internal目录~~
3.  从顶层目录运行你的主类

    `java -cp .;dep-jar;dep-jar;... your.main.class`

我用一个碰巧躺在身边的可运行罐子尝试了这个，它可以工作。第 2 步并不是绝对必要的。

# sap-ase - 删除 Sybase ASE 中的所有表，包括那些有约束的表

> ID：12573303
> 
> 赞同：1
> 
> 时间：2012-09-24T21:38:43.080
> 
> 标签：sap-ase

在不删除数据库的情况下，在 Sybase ASE 中完全删除数据库中的所有表的最佳方法是什么？我一直在使用脚本：[从这个问题](https://stackoverflow.com/questions/4799673/sybase-how-do-i-drop-all-tables-and-stored-procs-if-possible)，但由于参照完整性，我在尝试删除数据库中的所有表时遇到错误。

在 MySQL 中我可以使用`SET FOREIGN_KEY_CHECKS = 0`

有没有办法在 Sybase ASE 中执行此操作，或者可以扩展上面的脚本以循环通过约束？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:45:47.510

首先你必须放弃约束：

```
declare cur cursor 
for 
  select SOR.Name as constraint, SOT.Name as table
  from sysreferences SR
  join sysobjects SOR on SOR.id = SR.constrid 
  join sysconstraints SC on SC.constrid = SR.constrid
  join sysobjects SOT on SOT.id = SC.tableid
go
declare @constraint varchar(500)
declare @table varchar(500)
declare @SQL varchar(500)

open cur
fetch cur into @constraint,@table 
  while (@@sqlstatus = 0)
  begin

    select @SQL = 'alter table '+@table+' drop '+@constraint
    exec( @SQL)
    fetch cur into @constraint,@table 

  end
close cur
deallocate cursor cur 
```

接下来你可以删除表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-22T16:00:53.150

在接受的答案中删除所有约束的过程对我不起作用。这是在我的 ASE16 中工作的修改版本。

```
BEGIN
declare cur cursor 
for 
  select o.name, t.name from sysreferences r
  join sysobjects o on o.id = r.constrid 
  join sysconstraints c on c.constrid = r.constrid
  join sysobjects t on t.id = c.tableid
END
GO
--
declare @constraint varchar(500)
declare @table varchar(500)
declare @SQL varchar(500)
--
open cur
fetch cur into @constraint,@table 
  while (@@sqlstatus = 0)
  begin
    --
    select @SQL = 'alter table '+@table+' drop constraint '+@constraint
    exec( @SQL)
    fetch cur into @constraint,@table 
    --
  end
close cur
deallocate cursor cur 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-18T10:35:44.913

上述逻辑是正确的，但查询是错误的，您可能会遇到“约束”和“表”关键字的问题。

1.  在第 3 行使用类似 constriantName 和 tableName 的东西
2.  查询缺少“约束”，正确查询：'alter table' + @table + ' drop constraint' +@constraint

# clojure - 如何编写一个打印自己后缀的嵌套宏？

> ID：12573308
> 
> 赞同：2
> 
> 时间：2012-09-24T21:39:04.420
> 
> 标签：clojure, macros

我试图更好地理解[Clojure 中的清单 13.3](https://github.com/joyofclojure/book-source/blob/master/src/joy/measures.clj#L16)。它是一个生成其他宏的宏（很像 Clojure 1.4 中原始数组函数的实现方式）。

我想编写一个宏，在运行时只打印生成的宏的后缀。IE

```
user=> (nested-macro joe)
user=> (nested-macro-named-joe)
hello from joe
nil 
```

我无法完成这项工作。

这是我尝试过的：

**尝试 1**

```
(defmacro nested-macro [name]
  `(defmacro ~(symbol (str "nested-macro-named-" name))
     []
     `(println "hello from " ~name))) 
```

*输出：*

`hello from #<core$name clojure.core$name@502c06b2>`

**尝试 2**

```
(defmacro nested-macro [name]
  (let [local-name name]
    `(defmacro ~(symbol (str "my-custom-macro-named-" ~local-name))
       []
       `(println "hello from " ~local-name)))) 
```

*错误*

`IllegalStateException Attempting to call unbound fn: #'clojure.core/unquote clojure.lang.Var$Unbound.throwArity (Var.java:43)`

**尝试 3：**

```
(defmacro nested-macro [name]
  (let [local-name name]
    `(defmacro ~(symbol (str "nested-macro-named-" name))
       []
       `(println "hello from " ~(symbol local-name))))) 
```

*编译器错误：*

`CompilerException java.lang.RuntimeException: No such var: joy.dsl/local-name`

只是为了它，我还尝试添加`#`到局部变量，结果与上述类似，但使用“自动”名称，例如`local-name__1127__auto__`我不认为这是解决方案的一部分。

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:10:14.023

要知道宏出了什么问题，我总是使用`macroexpand-1`.

从你的第一个例子：

```
(macroexpand-1 '(nested-macro joe)) 
```

结果是：

```
(clojure.core/defmacro nested-macro-named-joe [] 
  (clojure.core/seq 
    (clojure.core/concat 
      (clojure.core/list (quote clojure.core/println)) 
      (clojure.core/list "hello from ") 
      (clojure.core/list clojure.core/name)))) 
```

如果您查看最后一个参数，它表明您正在使用 clojure.core/name，这可能不是您想要的，因为您实际上想要名为“name”的参数。

要修复它，只需在`name`参数中添加另一个取消引号，但由于名称参数实际上是一个符号，您真正想要的是获取它的名称，如下所示：

```
(defmacro nested-macro [the-name]
  `(defmacro ~(symbol (str "nested-macro-named-" the-name))
     []
     `(println "hello from " ~~(name the-name)))) 
```

# java - JList 中的拖放不起作用

> ID：12573312
> 
> 赞同：2
> 
> 时间：2012-09-24T21:39:15.030
> 
> 标签：java, swing, jlist, drag-and-drop

因此，我为我的应用程序编写了一个 TransferHandler（沿着 Oracle 站点的示例），但是当我尝试移动数据时它并没有移动。它所做的只是将索引处的数据（n-1 即如果我正在移动并将项目移动到 n 位置）到索引 n。您能否检查一下出了什么问题，尽管我尝试了很多选择，但没有一个对我有用。

```
import javax.swing.TransferHandler;
import javax.swing.*;
import java.awt.datatransfer.*;

    public class ListTransferHandler extends TransferHandler {
        private int[] indices = null;
        private int addIndex = -1; //Location where items were added
        private int addCount = 0;  //Number of items added.

        public boolean canImport(TransferHandler.TransferSupport info) {
            // Check for String flavor
            if (!info.isDataFlavorSupported(DataFlavor.stringFlavor)) {
                return false;
            }
            return true;
        }

        protected Transferable createTransferable(JComponent c) {
            return new StringSelection(exportString(c));
        }

        public int getSourceActions(JComponent c) {
            return TransferHandler.MOVE;
        }

        public boolean importData(TransferHandler.TransferSupport info) {
            if (!info.isDrop()) {
                return false;
            }

            JList list = (JList)info.getComponent();
            DefaultListModel listModel = (DefaultListModel)list.getModel();
            JList.DropLocation dl = (JList.DropLocation)info.getDropLocation();
            int index = dl.getIndex();
            boolean insert = dl.isInsert();

            // Get the string that is being dropped.
            Transferable t = info.getTransferable();
            String data;
            try {
                data = (String)t.getTransferData(DataFlavor.stringFlavor);
            } 
            catch (Exception e) { return false; }

            // Perform the actual import.  
            if (insert) {
                listModel.add(index, data);
            } else {
                listModel.set(index, data);
            }
            return true;
        }

        protected void exportDone(JComponent c, Transferable data, int action) {
            cleanup(c, action == TransferHandler.MOVE);
        }

        //Bundle up the selected items in the list
        //as a single string, for export.
        protected String exportString(JComponent c) {
            JList list = (JList)c;
            indices = list.getSelectedIndices();
            Object[] values = list.getSelectedValues();

            StringBuffer buff = new StringBuffer();

            for (int i = 0; i < values.length; i++) {
                Object val = values[i];
                buff.append(val == null ? "" : val.toString());
                if (i != values.length - 1) {
                    buff.append("\n");
                }
            }

            return buff.toString();
        }

        //Take the incoming string and wherever there is a
        //newline, break it into a separate item in the list.
        protected void importString(JComponent c, String str) {
            JList target = (JList)c;
            DefaultListModel listModel = (DefaultListModel)target.getModel();
            int index = target.getSelectedIndex();

            //Prevent the user from dropping data back on itself.
            //For example, if the user is moving items #4,#5,#6 and #7 and
            //attempts to insert the items after item #5, this would
            //be problematic when removing the original items.
            //So this is not allowed.
            if (indices != null && index >= indices[0] - 1 &&
                  index <= indices[indices.length - 1]) {
                indices = null;
                return;
            }

            int max = listModel.getSize();
            if (index < 0) {
                index = max;
            } else {
                index++;
                if (index > max) {
                    index = max;
                }
            }
            addIndex = index;
            String[] values = str.split("\n");
            addCount = values.length;
            for (int i = 0; i < values.length; i++) {
                listModel.add(index++, values[i]);
            }
        }

        //If the remove argument is true, the drop has been
        //successful and it's time to remove the selected items 
        //from the list. If the remove argument is false, it
        //was a Copy operation and the original list is left
        //intact.
        protected void cleanup(JComponent c, boolean remove) {
            if (remove && indices != null) {
                JList source = (JList)c;
                DefaultListModel model  = (DefaultListModel)source.getModel();
                //If we are moving items around in the same list, we
                //need to adjust the indices accordingly, since those
                //after the insertion point have moved.
                if (addCount > 0) {
                    for (int i = 0; i < indices.length; i++) {
                        if (indices[i] > addIndex) {
                            indices[i] += addCount;
                        }
                    }
                }
                for (int i = indices.length - 1; i >= 0; i--) {
                    model.remove(indices[i]);
                }
            }
            indices = null;
            addCount = 0;
            addIndex = -1;
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:22:35.017

成功完成导出后，您需要从源中“删除”数据。

为此，您需要重写该[`TransferHandler.exportDone`](http://docs.oracle.com/javase/7/docs/api/javax/swing/TransferHandler.html#exportDone%28javax.swing.JComponent,%20java.awt.datatransfer.Transferable,%20int%29)方法。

> protected void exportDone(JComponent source, Transferable data, int action)
> 
> 数据导出后调用。如果操作是 MOVE，则此方法应删除传输的数据。
> 
> 由于 MOVE 不是此实现的受支持操作（getSourceActions 不包括 MOVE），因此此方法被实现为不执行任何操作。

基本上，您需要从那里检查`action`类型并确保目标组件已接受`MOVE`而不是简单地`COPY`'ed 它并从源列表中删除元素。

# php - PHP - 从文件夹中随机抓取一个文件并回显

> ID：12573313
> 
> 赞同：0
> 
> 时间：2012-09-24T21:39:16.093
> 
> 标签：php

我的服务器上有一个文件夹，`/assets/includes/updates/`其中`.php`包含具有静态 html 内容的文件。

我想从这个文件夹中随机抓取一个文件并将`echo`其放入一个 div 中。这是我所拥有的：

```
<?php
 function random_update($dir = $_SERVER['DOCUMENT_ROOT'].'/assets/includes/updates/')
{
    $files = glob($dir . '/*.*');
    $file = array_rand($files);
    return $files[$file];
}
?>

<div class="my-div">
 <?php echo random_update(); ?>
</div><!--end my-div--> 
```

我收到 500 个错误？另外，我的意图是`echo`一次只处理一个文件。提供的代码会实现这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:41:33.493

Php 无法识别您使用的语法。你必须像这样绕过它：

```
<?php
function random_update($dir = NULL)
{
    if ($dir === NULL) {
        $dir = $_SERVER['DOCUMENT_ROOT'] . '/assets/includes/updates/';
    }

    $files = glob($dir . '/*.*');
    $file = array_rand($files);
    return $files[$file];
} 
```

此外，您可能希望在您的开发环境中启用错误转储，以便您知道下次出了什么问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:44:35.030

除了发现问题的另一个答案之外，为了让您的代码执行您想要的操作，您必须替换以下代码：

```
<?php echo random_update(); ?> 
```

对于这个：

```
<?php echo file_get_contents (random_update()); ?> 
```

因为您当前的代码将在 div 中打印文件名，而我认为您希望将文件的实际内容插入到 div 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:41:40.087

您不能使用任何表达式作为“默认”函数的参数值。

# android - android sqlite 下一条记录不正确

> ID：12573314
> 
> 赞同：0
> 
> 时间：2012-09-24T21:39:19.503
> 
> 标签：android, sqlite

这是 getContact 方法，在这种情况下采用 rowID 计数器

```
public Cursor getContact(long rowId) throws SQLException 
    {
        Cursor mCursor =
                db.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
                        question, possibleAnsOne,possibleAnsTwo, possibleAnsThree,realQuestion,userR}, KEY_ROWID + "=" + rowId, null,
                        null, null, null, null);
        if (mCursor != null) {
            // moves to the the first record
            mCursor.moveToFirst();
        }
        return mCursor;
    } 
```

这是我的问题。我从记录一开始。所以计数器设置为1。

在公共 oncreate 方法中。当我出于某种原因单击下一步时，它没有使用 db.updateUserResult(counter,8); 设置第一条记录的值；我认为它缺少第一条记录。我知道这一点的原因是，如果我选择了前面的答案。假设问题 1 的正确答案是选项 2，问题 2 的正确答案是选项 3。如果您为问题 1 选择选项 3，那么您将得到正确答案。如果我继续选择正确的答案，我会得到所有正确的结果。

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            Bundle b = getIntent().getExtras(); 
            boolean TimerStarted = b.getBoolean("timerlogic");
            System.out.println("what is the logic of the timer" + TimerStarted);
            Log.e(LOGS, "Whatis the first value for the timer inside the timer_btn" + TimerStarted);

            setContentView(R.layout.basic);
            // this method is better then a try and catch block as it actually prevents the occurence occuring instead of just patching it.
            // the purpose of t
            db.open();

            Cursor c = db.getContact(1); 

            if(c.isFirst())
            {
                TextView question = (TextView)findViewById(R.id.question);
                RadioButton radio1 = (RadioButton)findViewById(R.id.radio1);
                RadioButton radio2 = (RadioButton)findViewById(R.id.radio2);
                RadioButton radio3 = (RadioButton)findViewById(R.id.radio3);

                answerCounterText = (TextView)findViewById(R.id.answerCounterText);
                answerCounterText.setText(String.valueOf("0")); 
                // for the first record set the counter to zero
                // question.setText(String.valueOf("0"));
                TextView QuestionNumber = (TextView)findViewById(R.id.QuestionNumber);
                Complete = (Button)findViewById(R.id.Continue);
                Complete.setBackgroundResource(R.drawable.complete);
                Complete.setVisibility(View.INVISIBLE);
                QuestionNumber.setText(String.valueOf("Question Number  :" + counter));

                  System.out.println("what is the setup counter after loop" + counter);

                //DisplayContact(c,radio1);
                DisplayRadioButton(c,radio1,radio2,radio3,question);

            }

          // }
          //  }
         // Previous = (Button)findViewById(R.id.Previous);
           Next = (Button)findViewById(R.id.Next);

           Next.setBackgroundResource(R.drawable.next);
           // get the results from the checked box

           Next.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                // Cursor c = db.getContact(1);

                /*
                if (firstrecordchosen)
                {
                    Cursor c = db.getContact(1);
                      System.out.println("what is the current value of the counter 0" + counter);
                    firstrecordchosen = false;
                }
                counter++;

                  */   
                counter++;
                 Cursor c = db.getContact(counter);

                    if (c.moveToFirst() && !c.isNull(0))        
                    {    
                         TextView question = (TextView)findViewById(R.id.question);
                        RadioButton radio1 = (RadioButton)findViewById(R.id.radio1);
                         RadioButton radio2 = (RadioButton)findViewById(R.id.radio2);
                         RadioButton radio3 = (RadioButton)findViewById(R.id.radio3);

                      TextView answerCounterText = (TextView)findViewById(R.id.answerCounterText);
                         TextView QuestionNumber = (TextView)findViewById(R.id.QuestionNumber);
                         RadioGroup radioGroup1 = (RadioGroup)findViewById(R.id.radioGroup1);

                         QuestionNumber.setText(String.valueOf("Question Number  :" + counter));
                         Log.e(LOGS, "default user set variable " + c.getString(5));
                         Log.e(LOGS, "real value" + c.getString(6));
                         System.out.println("what is the current value of the counter" + counter);

                    //  DisplayContact(c,radio1);
                   DisplayRadioButton(c,radio1,radio2,radio3,question);
                  final String questionOneDb = c.getString(5);
                  String radioOneIndex = "1";
                  String radioTwoIndex = "2";
                  String radioThreeIndex = "3";

                  // set the first question to have the right value

                  if(radio1.isChecked() )
                    {     
                        db.updateUserResult(counter,8);
                        if (questionOneDb.equals(radioOneIndex))
                        {

                            Log.e(LOGS, "correct" );    

                        rightAnswer(c,radio1,answerCounterText);
                        //  DisplayContact(c,radio1);
                        }
                        else
                        {

                            Log.e(LOGS, "wrong" );  
                        }

                    }

                    if(radio2.isChecked()  )
                    {

                        db.updateUserResult(counter,9);

                        if (questionOneDb.equals(radioTwoIndex))
                        {
                          System.out.println("is this counter being reached"); 
                        //  db.updateUserResult(1, 2);
                        //  db.updateUserResult(counter, 2);
                        // db.updateUserResult(recordval, 6);

                            Log.e(LOGS, "correct" );    

                        rightAnswer(c,radio1,answerCounterText);
                        }
                        else
                        {
                            Log.e(LOGS, "wrong" );      
                        }

                    }

                    if(radio3.isChecked()   )
                    { 
                        db.updateUserResult(counter,10);

                        if (questionOneDb.equals(radioThreeIndex))
                        {
                            Log.e(LOGS, "correct" );    
                        System.out.println("you have the right answer");
                        rightAnswer(c,radio1,answerCounterText);
                        }
                        else
                        {
                            Log.e(LOGS, "wrong" );      
                        }

                    }

                    }

                  /* when you get ot the last record you want to be able to close the db */
                    if (c.isAfterLast())

                    { 

                    // this halts the timer when there are no questiosn left
                   Next.setVisibility(View.GONE);
               //    Previous.setVisibility(View.GONE);
                   Toast.makeText(getBaseContext(), "More questions available in the full version PHPExpert " , Toast.LENGTH_LONG).show();
                   Complete.setVisibility(View.VISIBLE);
                    handler.removeCallbacks(timedTask);
                    db.close();

                  intentcalls();

                    }

            }
        });

           Home = (Button)findViewById(R.id.home_btn);
           Home.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub

                Intent i = new Intent(Basic_database_questionsActivity.this,AndroidGUIActivity.class);
                startActivity(i);

            }

           }); 

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:37:15.147

如果我没有完全错，你有一个时间问题。

首先你得到你的第一个问题并显示 UI（你的单选按钮和东西）。

您单击“下一步”按钮进行检查，如果选择的答案是正确的，对吗？

如果是这样，你就犯了一个错误，你首先增加了计数器，然后根据计数器查询问题（这将是下一个）。之后，您检查选择的单选按钮是否正确。由于您已经从数据库中读取了下一个问题，因此您可以将第一个问题的所选答案与第二个问题的存储答案进行核对。

希望这很清楚。

简短提示：尝试清理一些代码。不要将任何东西放在`onCreate()`更小的块中，这样您就可以更轻松地查看和遵循代码流......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-11T18:34:35.090

尝试这个

```
Cursor c1 = mDbHelper.fetAll(); \\ or whatever your method is to get data from database.
if(c1.moveToFirst()){
     do{
        \\ Do what you want to do with it.

       }while(c1.moveToNext()); \\ this will move the cursor to next line.
    }
 c1.close(); \\ make sure you close it, else errors will pop up in LOGCAT. 
```

# asp.net-mvc-4 - MVC4 最低参考

> ID：12573315
> 
> 赞同：8
> 
> 时间：2012-09-24T21:39:30.800
> 
> 标签：asp.net-mvc-4

由于一个新的 MVC 4 Internet 项目有不少于 47 个引用和 29 个 nuget 包。我想知道我能逃脱的最少引用数量是多少。我想选择我的 Javascript 和 ORM 解决方案。我基本上只想要准系统 MVC 框架。我能摆脱什么？对于奖励积分，我必须添加多少才能让 WebApi 正常工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-07T20:47:23.053

只是为了完整起见，这里是我发现部署到 IIS 的工作 ASP MVC 应用程序（在我的例子中是 7.5 版）所需的最少参考资料。也就是说，如果你只有这些引用，你的 MVC 应用程序就会运行，如果你没有它们，它就不会运行。另外，请记住，我是从部署的角度说的，而不是本地开发 Web 服务器的角度。在没有所有这些引用的情况下在本地运行可能会起作用，但在部署到 IIS 时最终会失败。

**最低参考**

```
REFERENCE                        COPY LOCAL*
---------                        -----------
Microsoft.Web.Infrastructure     true
System                           false
System.Web                       false
System.Web.Http                  false
System.Web.Mvc                   true
System.Web.WebPages              true
System.Web.WebPages.Deployment   true
System.Web.WebPages.Razor        true 
```

*将这些引用添加到您的解决方案时，复制本地设置为*false 。*相应地为上面的引用设置 Copy Local 属性，以确保在构建项目时将 DLL 放入 bin 目录中。这样，它们将被拾取进行部署。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-22T14:38:29.043

So its been a while, On update 2 there seems to be a empty template which still has a load of unused references, Once you have created the solution you can safely remove the following references:

*   Microsoft.CSharp
*   Microsoft.Web.Infrastructure
*   Microsoft.Web.Mvc.FixedDisplayModes
*   Newtonsoft.Json
*   System.ComponentModel.DataAnnotations
*   System.Data
*   System.Data.DataSetExtensions
*   System.Drawing
*   System.EnterpriseServices
*   System.Net.Http.Formatting
*   System.Net.Http.WebRequest
*   System.Web.ApplicationServices
*   System.Web.DynamicData
*   System.Web.Entity
*   System.Web.Extensions
*   System.Web.Helpers
*   System.Web.Razor
*   System.Web.Services
*   System.Web.WebPages.Deployment
*   System.Xml
*   System.Xml.Linq

and from a Nuget point of view you can remove all of the packages except (and their dependencies) :

*   Microsoft.AspNet.WebApi
*   Microsoft.AspNet.Mvc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:49:23.270

然后不要选择互联网模板。相反，请选择空模板或基本模板。这就是他们的目的。

Internet 模板需要它拥有的所有引用。如果要删除其中一些引用，则必须从模板中删除代码。

但是，所有模板似乎都包含一些您可能不需要的包，例如 json.net 或 WebApi，但如果您不需要它们，可以将其删除。

# graphics - 如何在 Latex 或 Graphviz 中可视化 Viterbi 路径

> ID：12573316
> 
> 赞同：1
> 
> 时间：2012-09-24T21:39:45.277
> 
> 标签：graphics, latex, graphviz, viterbi

我正在寻找一种在 LaTeX 或 Graphviz 中可视化 Viterbi 路径的方法，就像在这个例子中一样：

![](../Images/db182b51540ed4c52aa9dc0d7aa057e5.png)

它不一定是点，但也可以是线之间的实际值。很像一个在单元格之间有线条的表格。

我尝试寻找方法来做到这一点，但很可能我没有使用正确的关键字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T08:13:15.660

这是使用带有不可见边缘的graphviz实现此目的的一种方法：

```
graph {
  splines=false;
  nodesep=0.5;
  ranksep=0.5;
  node[shape=point, height=0.08];
  { rank=same; a1 -- b1 -- c1 -- d1 -- e1;}
  { rank=same; a2 -- b2; b2 -- c2[style=invis]; c2 -- d2; d2 -- e2[style=invis];}
  { rank=same; a3 -- b3[style=invis]; b3 -- c3; c3 -- d3[style=invis]; d3 -- e3;}
  edge[style=invis];
  a1 -- a2 -- a3;
  b1 -- b2 -- b3;
  c1 -- c2 -- c3;
  d1 -- d2 -- d3;
  e1 -- e2 -- e3;
  edge[style=solid, constraint=false];
  a2 -- b3 -- c2 -- d3 -- e2;
} 
```

![图形输出](../Images/474bc047cadec935f336c000a8e48d70.png)

# iphone - IOS6轮换问题

> ID：12573317
> 
> 赞同：5
> 
> 时间：2012-09-24T21:39:46.697
> 
> 标签：iphone, ios, uinavigationcontroller, rotation, ios6

我知道你必须使用 IOS6 的新轮换方法，但我写的方法似乎不起作用。

我将我的 plist 文件设置为允许所有旋转，但**不允许 PortraitUpsideDown**

然后，我的**appDelegate**中有以下内容：

```
self.navController = [[UINavigationController alloc] initWithRootViewController:self.viewController];
[self.window setRootViewController:navController];  //add nav controller to be the root view 
```

然后在我的 rootView 中，要推送到另一个控制器，我有：

```
WebViewViewController *webController = [[JBWebViewViewController alloc] init];
webController.urlString =   urlName;
[self.navigationController pushViewController:webController animated:YES]; 
```

在网络控制器中，我有：

```
#pragma mark - System Rotation Methods
//for any version before 6.0
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
//only allow landscape
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

/for 6.0+
- (BOOL)shouldAutorotate{
return NO;
}

- (NSUInteger)supportedInterfaceOrientations{
return UIInterfaceOrientationMaskPortrait;
} 
```

我想要做的是在根视图中允许 3 次旋转，但是当切换到 Web 视图时（注意我是推送导航，而不是添加子视图），我只想允许纵向视图。

请有人帮助我

- - - -更新 - - - - -

我创建了自己的 UINavigationController 的 navController 子类，我有一个 BOOL LandscapeModeOn，我可以设置它来告诉自动旋转规范

```
#pragma mark - System Rotation Methods
//for any version before 6.0
- (BOOL)shouldAutorotateToInterfaceOrientation (UIInterfaceOrientation)interfaceOrientation
{
  if (landscapeModeOn) {
    return interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown;
  } else {
    return interfaceOrientation == UIInterfaceOrientationPortrait;
  }
}

//for 6.0+
- (NSUInteger)supportedInterfaceOrientations{
  if (landscapeModeOn) {
    return UIInterfaceOrientationMaskAllButUpsideDown;
  } else {
    return UIInterfaceOrientationMaskPortrait;
  }
}

- (BOOL)shouldAutorotate{
  UIInterfaceOrientation ori = [UIDevice currentDevice].orientation;
  if (landscapeModeOn) {
    return ori != UIInterfaceOrientationPortraitUpsideDown;
  } else {
    return  ori == UIInterfaceOrientationPortrait;
  }
} 
```

在子视图加载中，我这样做：

```
- (void)viewWillAppear:(BOOL)animated{
  //get nav controller and turn off landscape mode
  JBNavController *navController = (JBNavController*)self.navigationController;
  [navController setLandscapeModeOn:NO];
  [navController shouldAutorotate];
} 
```

--------------------参考最佳答案引用 对于IOS6，苹果现在专注于使用Storyboard的AutoLayout以及新的旋转定义，难以修复一些基于 ios 4.3 和 ios 5 编码结构的 IOS6 小错误

从applefreak，他的建议暗示：

> 在您的情况下，一个主要挑战是不处理方向。实际上它将不同的视图控制器锁定到特定的方向

虽然手动旋转视图似乎真的很难没有任何错误，但它似乎是我现在正在尝试的唯一解决方案，一旦解决就会发布更多

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T21:47:30.037

对于您的情况，您必须将 NavigationController 子类化并向其添加 shouldAutorotate 和 supportedInterfaceOrientations 方法。iOS6现在以与iOS5相反的顺序询问您的导航堆栈，因此它将首先询问您的NavigationController，如果返回YES，它甚至不会咨询它的子视图控制器。要解决这个问题，您必须自己添加逻辑来执行此操作

因此，在您的子类导航控制器中，您手动询问当前的视图控制器它的自动旋转能力：

```
- (BOOL)shouldAutorotate
{
    return self.topViewController.shouldAutorotate;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return self.topViewController.supportedInterfaceOrientations;
} 
```

并且在您的个人视图控制器中，您现在可以实现这些功能并让它们返回您在问题中定义的所需值。

我希望这是有道理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:01:02.667

以下代码错误！

```
- (BOOL)shouldAutorotate{
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskPortrait;
} 
```

请记住，仅当 shouldAutoRotate 返回 YES 时才会调用supportedInterfaceOrientations。现在根视图控制器决定它的孩子是否旋转。

在您的情况下，我建议为您的 self.viewController 设置一个基类控制器并将 self.viewController 设置为根视图控制器而不是 navigationController 否则将不会调用旋转方法！我遇到了同样的问题。您应该与基本视图控制器及其子级具有 HAS-A 关系。根据活动的孩子从 ShouldAutoRotate 返回是/否，对于支持的方向也是如此。如果您遵循此架构，那么对于复杂的 App 将是一致的。

例如，在您的情况下，当 webviewController 处于活动状态时，BaseviewController 应该从 shouldAutoRotate 返回 YES 并从支持的方向委托返回 UIInterfaceOrientationPortrait。我希望这是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T13:38:21.120

iOS5和iOS6通用代码

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation duration:(NSTimeInterval)duration
{
    if (UIInterfaceOrientationIsLandscape(interfaceOrientation))  
    { 
        // here to  implement landscope code
    }

    else
    {  
        // here to  implement setframePortrait
    }
} 
```

# php - 如何从MYSQL中读取swf文件的路径，然后在网上查看

> ID：12573323
> 
> 赞同：0
> 
> 时间：2012-09-24T21:40:12.203
> 
> 标签：php, mysql, html

我下面的代码不起作用。

`nisreen`是 DB 的名称，表名是`ana`。

我想要的是从数据库中读取 SWF 文件的路径，然后在网页上查看。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <title>Untitled 1</title>

        <?php

            $con =mysql_connect("localhost","root","");

            mysql_select_db("nisreen", $con);
            $result = mysql_query("SELECT * FROM ana LIMIT 1");
            while($row = mysql_fetch_array($result))
            {
                $row['title'];
            }

            echo '</head>';

            echo '<body>';
            echo $row; 
            echo '<object data="'.$row . "'";
            echo "type='application/x-shockwave-flash' width='600'  height='600'>";

            echo '</object>';
            echo '
    </body>    
</html>';
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:49:14.433

您没有将获取的数据分配给变量， $row 仅存在于该 while 循环的范围内。尝试类似的东西

```
<?php

    $con =mysql_connect("localhost","root","");

    mysql_select_db("nisreen", $con);
        $result = mysql_query("SELECT * FROM ana LIMIT 1");
         while($row = mysql_fetch_array($result))
         {
            $title = $row['title'];
            $path = $row['path'];   
         }

echo '</head>';

echo '<body>';
echo $title; 
echo '<object data="'.$path. "'";
echo "type='application/x-shockwave-flash' width='600'  height='600'>";

echo '</object>';
echo '
</body>

</html>';
?> 
```

# javascript - 页面完成后的元素高度

> ID：12573325
> 
> 赞同：3
> 
> 时间：2012-09-24T21:40:23.327
> 
> 标签：javascript, jquery, html

我有一个绝对的`div`，和一个父母`div`。我如何根据绝对 div 定义父级的高度，知道我有需要一些时间加载的图像？

CSS：

```
#parent {
    overflow:hidden;
    width:100%;
}
.absolute {
    overflow:hidden;
    width:100%;
    height:100%;
} 
```

HTML：

```
<div id="parent" style="height:[HEIGHT OF CHILDREN]">
    <div id="absolute1" class="absolute">
        [LOTS OF CONTENT WHICH MAKE A VARIABLE HEIGHT, INCLUDING IMAGES WHICH TAKE SOME TIMES TO LOAD HERE]
    </div>
    <div id="absolute2" class="absolute">
        [LOTS OF CONTENT WHICH MAKE A VARIABLE HEIGHT, INCLUDING IMAGES WHICH TAKE SOME TIMES TO LOAD HERE]
    </div>
</div>
<a href="#absolute1">SAMPLE LINK 1</a>
<a href="#absolute2">SAMPLE LINK 2</a> 
```

JS：

```
jQuery(document).ready(function($) {
    $('a').bind('click', function(e) {
        var target = $(this).attr('href');

        if($(target).html() !== undefined ) {
            $('#parent').css({
                'height': $('#parent').find(target ).height(),
            })
        }

        e.preventDefault();
    });

    // The problem: height is not correct until image is loaded/in cache
    $('a[href="#absolute1"]').trigger('click');
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:43:33.470

而不是在使用中运行您的代码`$(document).ready(...)`：

```
$(window).load(function(){
  // Your code here
}); 
```

这将确保页面的资产已加载，包括图像。

# java - 为什么 QuickSort 使用 O(log(n)) 额外空间？

> ID：12573330
> 
> 赞同：50
> 
> 时间：2012-09-24T21:41:00.737
> 
> 标签：java, algorithm, sorting, quicksort, space-complexity

我已经实现了以下快速排序算法。网上我读到它有 O(log(n)) 的空间要求。为什么会这样？我没有创建任何额外的数据结构。

是因为我的递归会在堆栈上使用一些额外的空间吗？如果是这种情况，是否可以通过不递归（而不是使其迭代）来减少内存？

```
private static void quickSort (int[] array, int left, int right) {
    int index = partition(array, left, right);

    //Sort left half
    if (left < index - 1)
        quickSort(array, left, index - 1);

    //Sort right half
    if (index < right)
        quickSort(array, index , right);
}

private static int partition (int array[], int left, int right) {
    int pivot = array[(left + right) / 2]; //Pick pivot point
    while (left <= right) {
        //Find element on left that should be on right
        while (array[left] < pivot)
            left++;

        //Find element on right that should be on left
        while (array[right] > pivot)
            right--;

        //Swap elements and move left and right indices
        if (left <= right) {
            int temp = array[left];
            array[left] = array[right];
            array[right] = temp;
            left++;
            right--;
        }
    }
    return left;
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-24T21:47:13.297

正确，额外的空间是 log(n) 堆栈帧。来自[Quicksort 的维基百科文章](http://en.wikipedia.org/wiki/Quicksort#In-place_version)：

> 有一个更复杂的版本，[...] 可以平均使用 O(log n) 空间（不计算输入）**（对于调用堆栈）**实现完整排序。

虽然您*可以*迭代地实现快速排序（即，使用循环而不是递归），但您需要维护一个辅助堆栈，因为快速排序有*两个*递归调用，而不仅仅是一个。

最后，正如其他答案所指出的那样，O(log(n)) 对于几乎所有实际应用来说都是非常*非常*小的。每个常量因素，比如数据结构的开销，都会对内存使用产生更大的影响。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-24T21:54:57.747

要摆脱递归调用，您必须在代码中使用堆栈数据结构，它仍然会占用`log(n)`空间。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-24T22:00:59.690

如果您进一步阅读 Wikipedia 文章，您会发现对空间复杂度的更[彻底的讨论](http://en.wikipedia.org/wiki/Quicksort#Space_complexity)。特别是，他们写道：

> 在进行任何递归调用之前，具有就地和不稳定分区的快速排序仅使用恒定的额外空间。快速排序必须为每个嵌套递归调用存储恒定数量的信息。由于最好的情况最多进行 O(log n) 嵌套递归调用，因此它使用 O(log n) 空间。然而，如果没有 Sedgewick 限制递归调用的技巧，在最坏的情况下，快速排序可能会进行 O(n) 嵌套递归调用并需要 O(n) 辅助空间。

实际上，O(log n) 内存什么都不是。例如，如果要对 10 亿个整数进行排序，存储它们需要 4 GB，但堆栈只需要大约 30 个堆栈帧，大约 40 个字节，因此总共大约 1200 个字节。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-24T21:55:16.697

是的，这是因为堆栈帧，是的，可以通过做一些非常聪明的事情将其转换为迭代算法（尽管我没有立即得到任何东西）。但为什么？O(log(n)) 空间几乎没有。作为参考，即使你有一个 Java 允许的最大大小的数组，也就是 2^31 个元素，大约是 8 GB。快速排序需要 31 个堆栈帧。Ballpark，也许每帧 100 字节？所以总共 3 KB，与实际数组的内存相比，这不算什么。

实际上，几乎任何时候都有 O(log(n))，它几乎与常数相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-16T15:52:37.647

很抱歉重新提出这个老问题，但我刚刚在[planetmath.org](http://planetmath.org/inplacesortingalgorithm)上找到了一个完全不同（但有点愚蠢）的答案：

> **任何**在连续数组上操作的排序算法都需要*O* ⁢ (log *⁡n* ) 额外空间，因为这是表示数组索引所需的比特数 [ *sic ]。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-13T20:27:55.177

每次连续递归调用时，子列表的大小减半，当子列表为 1 时，递归终止。因此，对元素进行操作的次数等于在达到 1 之前可以将 n 除以 2 的次数；日志（n）。

# jquery - jQuery 滚动结束和最后一个子元素选择器

> ID：12573331
> 
> 赞同：1
> 
> 时间：2012-09-24T21:41:08.320
> 
> 标签：jquery, jquery-selectors, scroll, mousewheel

我使用 jQuery 鼠标滚轮插件来帮助我确定用户是向上还是向下滚动。如果用户向上滚动，我希望父元素的最后一个子元素显示为无。这有效，但只有一次。父级中的其他元素无法转到`display:none`。

我想到的一个选择是使用，`.empty()`但是当我使用它时，没有一个元素会消失。

我创建了一个工作示例，我将在下面发布我认为导致问题的代码。[http://jsbin.com/orocat/1/edit](http://jsbin.com/orocat/1/edit)

仅 Javascript 代码：

```
$(document).on('mousewheel', function(event, delta) {

if (delta > 0) {  
    clearTimeout($.data(this, 'timer'));
    $.data(this, 'timer', setTimeout(function() {

    //here is the code that is causing trouble. I realize that it is
    //only selecting the last child but if I used .empty() nothing happens?
    $('.body div:last-child').css('display','none');

}, 80));} 

    else {  clearTimeout($.data(this, 'timer'));
    $.data(this, 'timer', setTimeout(function() {

    //have div elements display themselves again. need to work on this
    }, 80));}

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:59:30.723

您继续将最后一个设置`DIV`为`display:none`;

每当您使用此选择器`$('.body div:last-child').css('display','none');`时，您每次都选择相同的 DIV。似乎您每次都想选择下一个 DIV ？尝试使用`div:visible`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:00:45.257

替换您的以下行：

```
$('.body div:last-child').css('display','none'); 
```

对于这个：

```
$('.body div:visible').eq(-1).css('display','none'); 
```

因为你一次又一次地选择同一个 div，因为让它隐藏它不像删除它，所以你的选择器一直选择它。

# xslt - 如何编写 Umbraco XSLT 以从不相关的树中检索节点

> ID：12573332
> 
> 赞同：2
> 
> 时间：2012-09-24T21:41:07.940
> 
> 标签：xslt, umbraco

我有一个供个人使用的 Umbraco 网站，我也想将其用作博客。

我试图将 XSLT 放在一起以从博客树中的节点（节点 id = 1063）中获取前三个帖子，并将它们显示在合并到首页的标签页上。

下图说明了节点层次结构：

![Umbraco 站点节点](../Images/6a369697cbd5795892964f6b86571776.png)

由于我对 XSLT 的了解极其有限，我无法获取“博客”ID 的节点 ID 并在其下方的 3 页显示在我网站的“热门帖子”部分，该部分位于“首页选项卡”下“节点。我发现的所有示例都适用于“当前页面”，它通常是顶级节点“个人网站”。

我应该如何做到这一点？

**编辑**

已发布页面上呈现的输出实际上是空白的（即使在重新发布整个站点之后），但在后台富文本编辑器中显示的“热门帖子”选项卡内容的预览显示正确。

我正在使用的 XSLT 如下所示：

```
<xsl:template match="/">
  <ul>
    <xsl:for-each select="umbraco.library:GetXmlNodeById(1063)/umbBlogPost [@isDoc]">
      <li><a href="{umbraco.library:NiceUrl(@id)}"><xsl:value-of select="@nodeName"/></a></li>
    </xsl:for-each>
  </ul>
</xsl:template> 
```

选项卡的富文本编辑器中显示的 HTML 如下所示：

```
<div umb_macroalias="Dn.BlogListTopThreePosts" ismacro="true" onresizestart="return false;" umbversionid="cb1efb8d-f58c-424b-9c12-df14ac5652d9" umbpageid="1115" title="This is rendered content from macro" class="umbMacroHolder"><!-- startUmbMacro -->
<ul>
<li><a href="/blog/test-post.aspx">Test Post</a></li>
</ul>
<!-- endUmbMacro --></div> 
```

从数据库中检索 XML 后，我将再次更新这篇文章（如果有帮助的话）。问题不在于实际数据，因为它是已发布页面和后端之间的断开连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T10:29:52.577

我没有对此进行测试（我没有你的数据），但使用 position() 方法在一定数量的迭代后停止处理（[这里有一些很好的 xslt 示例](http://en.wikibooks.org/wiki/Umbraco/Various_useful_XSLT_methods_in_Umbraco)）。

```
<xsl:variable name="blogRoot" select="1063"/>
<xsl:for-each select="umbraco.library:GetXmlNodeById($blogRoot)/umbBlogPost [@isDoc]">
  <xsl:if test="position() &lt;= 3">
    <li><a href="{umbraco.library:NiceUrl(@id)}"><xsl:value-of select="@nodeName"/></a>
    </li>
  </xsl:if>
</xsl:for-each> 
```

如果您使用的是剃须刀，您可以执行以下操作：

```
@using uComponents.Core;
@using uComponents.Core.uQueryExtensions;
@{
  var topThreeBlogPosts = @uQuery.GetNodesByType(<blog post doc type>).Take(3);

  foreach(blogItem in topThreeBlogPosts)
  {
    <li><a href="@blogItem.NiceUrl">@blogItem.nodeName</a></li>
  }
} 
```

# blogengine.net - 向 blogengine.net 添加额外的数据库字段

> ID：12573333
> 
> 赞同：0
> 
> 时间：2012-09-24T21:41:10.147
> 
> 标签：blogengine.net

我在 Pages 表中添加了一个额外的字段，我称之为 VirtualPath。这样我就可以拥有到我的页面的虚拟路径。

在代码中，我将“VirtualPath”作为额外参数添加到 CommandText，这意味着将从数据库中选择 14 个元素。我复制例程以 grep 实际值：

如果（！rdr.isDbNull（14））{

page.VirtualPath = rdr.GetString(14);

}

问题是它永远不会进入 if 语句。当我单步执行代码并到达 !rdr.isDbNull(14)-row 并执行 step-in 时，我看到 DBHelper 以某种方式进行了处置……

我的问题是：在其他地方我必须做一些改变来添加这样的额外参数吗？或者，有没有人知道我做错了什么。是的，我已经在数据库中的 VirtualPath 字段中输入了值，所以它不应该为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T20:06:35.297

如果要从表中选择 14 个元素，则第 14 个元素应由索引 13（从零开始的索引）引用。

# jquery - jquery点击标签+复选框检测哪个？

> ID：12573337
> 
> 赞同：4
> 
> 时间：2012-09-24T21:41:25.533
> 
> 标签：jquery

我正在尝试检查 event.target.nodeName 如下：

```
$("input").click(function(e){
    if(e.target.nodeName == "LABEL") {
       alert('label click');
        e.preventDefault();
    } else {
       alert($(this).attr('checked') ? 'checked': 'unchecked');
    }
}); 
```

但名字永远不等于标签？我究竟做错了什么？

快速[jsfiddle](http://jsfiddle.net/TDvcV/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:43:07.673

您应该选择`label`( *parent* ) 元素。目前，您的点击处理程序的唯一目标是输入元素：

```
$("label").click(function(e){
  // ...
}) 
```

[http://jsfiddle.net/j7nSq/](http://jsfiddle.net/j7nSq/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:47:01.893

我认为这不起作用的原因是因为它只会在您单击输入时运行：

```
 if(e.target.nodeName == "LABEL") { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:45:27.297

您根本没有选择标签。先选择标签，然后重试：

你在这里打错了元素..

```
$('label').on('click', function(e) {
    // Your logic here

}); 
```

而不是点击输入。

确保您使用`.on()`.

# c++ - 二维数组，*(pointerArray[i] + j) 是什么？

> ID：12573339
> 
> 赞同：4
> 
> 时间：2012-09-24T21:41:33.087
> 
> 标签：c++, pointers, multidimensional-array

我刚刚得到了找出这段代码是如何工作的任务。

```
int array[rows][coloums]; 
int *pointerArray[rows]; 
for (int i = 0; i < rows; i++) { 
  pointerArray[i] = array[i]; 
  for (int j = 0; j < coloums; j++) { 
   *(pointerArray[i] + j) = 0; 
  } 
} 
```

我很感兴趣的是 *(pointerArray[i] + j)，我认为它与 pointerArray[i][j] 相同，因为您可以通过两种方式访问​​元素，但是谁能告诉我什么是实际发生在 *() 上？就像编译器如何知道我要求与 pointerArray[i][j] 相同的内容？

感谢您的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:43:13.760

当你这样做时`pointerArray[i] + j`，你请求元素`pointerArray[i]`，它是 a `int*`，并增加该指针`j`（也返回一个`int*`）。`*(...)`简单地取消引用指针并返回该位置`int`的。`*`被称为解引用运算符（在这种情况下）。所以是的，它相当于`pointerArray[i][j]`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:50:04.007

在这种情况下，`*`操作符是*解引用操作符*。它前面的值将是内存中返回值的位置。

括号将加法运算分组，以便编译器知道此加法的结果将用于取消引用。这只是一个操作顺序的例子。

请记住，该`[]`运算符与取消引用运算符的作用相同，因为数组本质上是一种指针变量。如果您将二维数组想象为具有行和列的二维值网格，那么在内存中数据的布局使得每一行按顺序依次排列。数组中的第一个索引 ( `i`) 以及数组的类型 ( `int`) 告诉编译器在哪个偏移量处查找行中的第一个位置。数组中的第二个索引 ( `j`) 告诉它要查看该行内的偏移量。

`*(pointerArray[i] + j)``i`基本意思是：“在 中找到第 th 行数据的开头`pointerArray`，然后选择该`j`行的第 th 元素，并给我那个值。

# ruby-on-rails-3 - 将 Rails 3.2.x 应用程序部署到 Heroku 的最佳实践？

> ID：12573341
> 
> 赞同：1
> 
> 时间：2012-09-24T21:41:44.667
> 
> 标签：ruby-on-rails-3, configuration, heroku

在将大多数应用程序部署到 Heroku 上的生产环境之前，是否对通常用于提高性能的 rails 配置文件进行了更改？阅读 Nerian 对[这个问题](https://stackoverflow.com/questions/7840768/were-sorry-but-something-went-wrong-after-deployment-to-heroku)的回答后感到好奇（总结：Heroku 部署问题通过在 config/environments/production 中设置“config.assets.compile = true”解决）。

希望这不是太笼统——我也是一个堆栈溢出新手。谢谢！

# sql - Foxpro 哪里表达无效？

> ID：12573346
> 
> 赞同：2
> 
> 时间：2012-09-24T21:41:57.900
> 
> 标签：sql, where, foxpro, visual-foxpro

```
lcVillkor1 = "table.numbers > 1"

SELECT * FROM table WHERE lcVillkor1 ORDER BY table.numbers 
```

我得到了错误 - `SQL: WHERE clause is invalid`。

我已经尝试了几乎所有可能的组合

`"table.numbers > 1", (table.numbers > 1), "(table.numbers > '1')"`ETC..

我试图从表格中获取一些帖子（其中数字大于 1）以打印出来。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-24T23:36:51.857

在变量之前使用`&`来扩展它：

```
lcVillkor1 = "table.numbers > 1"

SELECT * FROM table WHERE &lcVillkor1 ORDER BY table.numbers 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T21:56:38.783

您不能只是将变量名放在一行代码中并让它执行。相反，将您的 SQL 命令构建为文本变量，然后使用宏替换之类的东西来执行它：

```
lcVillkor1 = "table.numbers > 1" 
lcSql = "SELECT * FROM table WHERE " + lcVillkor1 + " ORDER BY table.numbers"
&lcSql 
```

此外，为了将来的参考，可能靠近保留字的表和字段名称——例如“表”和“数字”——可能并不理想。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T00:37:12.733

宏替换工作正常（在前面给出的两个示例中）。如果您使用 VFP9，您还可以在构建查询字符串后使用函数 EXECSCRIPT()：

```
lcVillkor1 = "table.numbers > 1" 
lcSql = "SELECT * FROM table WHERE " + lcVillkor1 + " ORDER BY table.numbers"
EXECSCRIPT(lcsql) 
```

# c# - 使用 Catch 中的锁用于异常以写入物理日志文件

> ID：12573352
> 
> 赞同：1
> 
> 时间：2012-09-24T21:42:22.863
> 
> 标签：c#, asp.net, exception, file-io, thread-safety

我的团队正在开发一个 C# ASP.NET Web 应用程序。我决定通过写入错误日志文件来处理错误。

我编写的 log.Error 方法将记录到错误目录中的物理日志文件中。

我认为在执行 log.Error 方法时使用锁来控制线程是合适的，因为我想在每次发生错误时记录错误。

因此，这是我的大多数异常处理的格式：

```
protected void blahblahCsharpMethodBlahBlah()
{
try
{
    blah blah C# code blah blah
}
catch(Exception ex  ){
    lock (_objectblahblahCsharpMethodBlahBlah)
    {
        // The following log.Error method that I wrote would log to a physical log file in an error directory.
        log.Error(ex.ToString(),
                  PerlsPivotErrorDirectory,
                  System.Reflection.MethodBase.GetCurrentMethod().Name,
                  this.GetType().Name,    System.IO.Path.GetFileName(System.Reflection.Assembly.GetExecutingAssembly().Location));
}
}
} // protected void blahblahCsharpMethodBlahBlah() 
```

使用锁来控制线程以便它们以正确的序列化方式执行 log.Error 方法是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T21:50:36.203

如果要确保线程安全，则需要使用锁。但为了让它更简单、更防弹，我会锁定在 Error 方法中。通常，您在应用程序的不同类之间共享相同的日志对象（或至少相同的日志文件），因此直接登录您的日志记录（此处为错误）函数更有意义。

但你不想或不需要重新发明轮子。使用默认线程安全的[NLog 。](http://nlog-project.org/)

# wcf - SSRS 可以向 WCF 服务传递参数对象吗？

> ID：12573354
> 
> 赞同：1
> 
> 时间：2012-09-24T21:42:33.480
> 
> 标签：wcf, reporting-services

我试图让我的 SSRS 报告调用我的 WCF 服务，但是当我这样做时，该参数始终为空。似乎我一直在关注的大多数示例都没有使用参数对象，在我的情况下它们只会使用 int PONumber 和 int itemNumber 参数。有没有办法使用对象参数？

我的服务合同：

```
[ServiceContract(Namespace = "http://schemas.XXX.com/WMS/WMSCustom/ReportingService")]
public interface IQAReportingServiceContract
{
    [OperationContract]        
    List<QAItemDetailResponse> GetQAItemDetail(QAItemDetailRequest request);
} 
```

请求对象：

```
[DataContract]
public class QAItemDetailRequest
{
    [DataMember]
    public int PONumber { get; set; }

    [DataMember]
    public int itemNumber { get; set; }
} 
```

我的 SSRS 数据集查询：

```
<Query>
<Method Name="GetQAItemDetail" Namespace="http://schemas.wegmans.com/WMS/WMSCustom/ReportingService">
<Parameters>
<Parameter Name="PONumber"></Parameter>
<Parameter Name="itemNumber"></Parameter>
</Parameters>
</Method>
<SoapAction>http://schemas.XXX.com/WMS/WMSCustom/ReportingService/IQAReportingServiceContract/GetQAItemDetail
</SoapAction>
</Query> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T19:09:24.273

是的。您应该将 [DataContract] 和 [DataMember] 属性分别更改为 [MessageContract] 和 [MessageBodyMember]。此外，它有助于设置 MessageBodyMember "Order" 参数。

# knockout.js - 淘汰错误？applyBindings 不起作用（Asp.net mvc4 移动版）

> ID：12573355
> 
> 赞同：0
> 
> 时间：2012-09-24T21:42:39.430
> 
> 标签：knockout.js, asp.net-mvc-4

我有一个包含三个视图模型的视图：Grower、Branch 和 GrowerList。

有两个按钮，Grower 和 Branch。GrowerList 取决于所选的分支。

场景如下： 1\. 当用户来到那个页面时，会显示一个分支列表（BranchList）。（使用 jQuery mobile 的 listview 来显示列表）。

1.  用户从 BranchList 中选择一个分支

2.  用户可以单击“种植者”按钮显示种植者列表，然后可以选择种植者。

3.  单击“种植者”按钮时，将显示种植者列表 (GrowerList)。GrowerList 取决于所选的分支 ID。

Grower、Branch 和 GrowerList，每个都有一个 ViewModel。我正在执行以下操作来显示更新后的 GrowerList：

```
 $("#btnGrower").click(function () {
     ko.applyBindings(new GrowerListModel(), document.getElementById("divGrowerList"));
     }); 
```

我的 GrowerList 的 ViewModel 如下所示：

```
 function MyGrower(data) {
     this.Id = ko.observable(data.GrowerId);
     this.name = ko.observable(data.GrowerName);
    }

    function MyGrowerListModel() {
     // Data
     var self = this;
     self.growers = ko.observableArray([]);

     //Load initial state from server and populate viewmodel
     $.getJSON("Grower/GetGrowers", function (allData) {
     var mappedUsers = $.map(allData, function (item) { return new MyGrower(item) });
     self.growers(mappedUsers);
     });
    } 
```

而且，我绑定值的地方：

```
 <div id="divGrowerList">
           <ul data-bind="foreach: growers" data-role="listview" id="ulGrowerList">
              <li><a data-bind="attr: {id: Id}"><span data-bind="text: name" /></a></li>
          </ul>

    </div> 
```

问题是，虽然我通过 Firebug 看到正确的数据来自 GetGrowers 方法，但除了第一次单击 Grower 按钮时，没有任何内容显示为 GrowerList。我究竟做错了什么？没有javascript错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T00:46:01.737

您应该只`applyBindings`为视图模型和视图一次。通过再次调用它，事情将不会像您在这里看到的那样工作。

您应该做的是在初始加载时应用*一次*绑定并调用将 设置`growers`为新值数组的方法。使用敲除的绑定来处理点击事件比在这里混合 jquery 更容易。

```
<button data-bind="click: updateGrowers"></button> 
```

```
function MyGrowerListModel() {
    // Data
    var self = this;
    self.growers = ko.observableArray([]);

    self.updateGrowers = function () {
        $.getJSON("Grower/GetGrowers", function (allData) {
            var mappedUsers = $.map(allData, function (item) { return new MyGrower(item) });
            self.growers(mappedUsers);
        });
    };

    //Load initial state from server and populate viewmodel
    self.updateGrowers();
} 
```

然后，每次单击按钮都会调用`updateGrowers`视图模型上的函数，该函数又会更新该数组。

# c++ - 不使用额外库的 C++ 基本序列化

> ID：12573356
> 
> 赞同：1
> 
> 时间：2012-09-24T21:42:41.730
> 
> 标签：c++, serialization

有人可以给我一个很好的提示，告诉我如何在不使用标准库以外的额外库的情况下执行序列化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:48:43.800

您的选择是：不要序列化，或者，编写您自己的序列化程序代码。它没有内置在语言或标准库中。

此外，您可能想看看一些类似的问题：

[将字符串、整数和浮点数序列化为字符数组，以便在没有库的情况下联网](https://stackoverflow.com/questions/1703322/serialize-strings-ints-and-floats-to-character-arrays-for-networking-without-li?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:53:41.407

您可以使用流使用称为二进制序列化的东西，如

[http://www.functionx.com/cpp/articles/serialization.htm](http://www.functionx.com/cpp/articles/serialization.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T21:58:07.973

我会质疑您是否有充分的理由不使用库。有很多数据表明，你自己编写的代码最有可能在你的脸上炸毁，原因是它背后的测试最少。

如果您确实有充分的理由并且仍然需要序列化，那么您必须自己编写。基本上，您正在考虑重载通常的 ostream 和 istream 运算符，以便它们支持您需要的类型。

同样，您冒着[重新发明方轮](http://en.wikipedia.org/wiki/Reinventing_the_wheel)的风险。请记住，最好的库（如 boost）本身是使用标准 C++ 编写的，并且对 bost 的许可要求不要求您发布源代码或任何类似的东西。换句话说，即使您使用了 IP，您的 IP 也是安全的。

# c# - 扩展 MVC 必需属性

> ID：12573362
> 
> 赞同：9
> 
> 时间：2012-09-24T21:42:58.640
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-2, data-annotations

我有一个不发回错误消息的RequiredAttribute 扩展类。如果我在调试器中检查它，文本就在那里。

```
public class VierRequired : RequiredAttribute
{
    public VierRequired(string controlName)
    {
        //...
    }

    public string VierErrorMessage
    {
        get { return ErrorMessage; }
        set { ErrorMessage = value; }
    }

    // validate true if there is any data at all in the object
    public override bool IsValid(object value)
    {
        if (value != null && !string.IsNullOrEmpty(value.ToString()))
            return true;

        return false; // base.IsValid(value);
    }
} 
```

我这样称呼它

```
[VierRequired("FirstName", VierErrorMessage = "Please enter your first name")]
public string FirstName { get; set; } 
```

和 mvc 视图

```
<%: Html.TextBoxFor(model => model.FirstName, new { @class = "formField textBox" })%>
<%: Html.ValidationMessageFor(model => model.FirstName)%> 
```

如果我使用正常的必需注释，它会起作用

```
[Required(ErrorMessage = "Please enter your name")]
public string FirstName { get; set; } 
```

但是自定义不会发回任何错误消息

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-24T22:01:08.543

当我创建自己的`RequiredAttribute`. 要修复它，您需要像这样注册数据注释：

```
DataAnnotationsModelValidatorProvider.RegisterAdapter(
            typeof(VierRequired),
            typeof(RequiredAttributeAdapter)); 
```

只需在您的`Application_Start()`方法中调用它，客户端验证就可以正常工作。

如果您在发布表单时属性不起作用，那么这将向我表明您的属性中的逻辑有问题（检查您的`IsValid`方法）。我也不确定你想用你的派生数据注释来实现什么；您的逻辑看起来像是在尝试做几乎默认属性所做的事情：

取自 MSDN 文档：

> 如果属性为 null、包含空字符串 ("") 或仅包含空白字符，则会引发验证异常。

# loops - 网站中的无限循环 - mod_rewrite

> ID：12573369
> 
> 赞同：0
> 
> 时间：2012-09-24T21:43:25.700
> 
> 标签：loops, infinite-loop, concrete5

我正在与一个今天刚刚上线的具体5 网站陷入无休止的循环......使用临时 URL 进行开发很好，但现在只有主页工作......想知道这是否与漂亮的 URLS 有关。错误：由于可能的配置错误，请求超出了 10 个内部重定向的限制。如有必要，使用“LimitInternalRecursion”增加限制。使用“LogLevel debug”获取回溯。网站是[http://redletterdaysforbusiness.co.uk](http://redletterdaysforbusiness.co.uk)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T06:42:34.350

重写规则似乎一切正常，而错误实际上是在 C5 本身内......在开发测试站点时，我启用了漂亮的 URL，一旦我上线并更改了 URL，它就不再起作用了。通过禁用漂亮的 URL，所有链接都有效。然后重新启用漂亮的 URL，一切仍然有效。感谢 jcem 的输入。

# javascript - 在 d3.js 中分割特征/路径

> ID：12573370
> 
> 赞同：1
> 
> 时间：2012-09-24T21:43:29.007
> 
> 标签：javascript, svg, d3.js

我有几个 SVG 路径，它们会根据某些参数改变填充颜色和不透明度。

当两个参数在同一个 SVG 特性上时，我想清楚地表明在这个特性中有这两个不同的“事物”（或对象）。

我一开始想混合两种不同的颜色（如果只有一个参数，那就只有一种颜色），但现在我发现它不是很直观。

也许将正方形（或圆形）除以一半（如果只有 2 个参数）或除以 3、4、5 会更具表现力...每个部分都有相应的颜色（用户还将有每个参数的图例=> 对应的颜色）。

但我目前不知道如何开始实施这一点。

任何想法，链接或建议表示赞赏......谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:53:45.887

不要`<path>`为每个单独的特征创建一个组（`<g>`），而是为每个单独的特征创建一个组（），它可以包含任意数量的`<path>`元素，或者您需要做的任何事情来帮助区分参数。请注意，绑定到`<g>`元素的任何数据都会自动可用/绑定到其子元素。

# xcode - 如何修复 Fortran 模块变量被列为 在苹果 GDB 中

> ID：12573374
> 
> 赞同：0
> 
> 时间：2012-09-24T21:43:53.150
> 
> 标签：xcode, xcode4, gdb, fortran, ddd-debugger

Apple Xcode 无法显示任何 Fortran 模块变量。模块变量可以通过运行菜单 -> 显示 -> 全局变量查看

模块变量及其变量名的修饰很清楚。

但是当在断点处列出全局变量的值时，显示的内容很简单：

`<unknown type>`

我在 XCode 和 DDD（也使用苹果的 GDB）中遇到了这个错误。这适用于像整数一样简单的模块变量 - 这些不是派生数据类型。

我在 10.6.8 上使用 Apple 的 GDB`GNU gdb 6.3.50-20050815`和 XCode 3.2.6。

至少，任何人都可以看到更高版本的 XCode 是否可以访问 Fortan 模块变量？

（尽管我看到 Apple 甚至在 XCode 4 中仍然保持 GDB 6.3）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:20:55.910

[Fink](http://pdb.finkproject.org/pdb/browse.php?sec=devel)提供 gdb 7.4，它应该可以很好地支持 Fortran，但可能你必须使用 dd。我不知道你是否可以在 Xcode 中使用它。由于许可证更改为 GPLv3，Apple 可能不会在未来提供更新的版本。

# c# - 如何注册 Microsoft.SharePoint.DLL 文件？

> ID：12573375
> 
> 赞同：0
> 
> 时间：2012-09-24T21:43:57.783
> 
> 标签：c#, sharepoint, dll, ssis, regsvr32

我正在 SSIS 任务 (SQL Server 2008 R2) 脚本中开发 C# (VS 2008) 代码，该脚本将在将新创建的 Excel 文件复制到适当的 UNC 路径后自动签入（使用 SPFile 方法）到 SharePoint 站点。由于我在没有安装 SharePoint 的计算机上进行开发，因此我需要复制到我的计算机并注册 Microsoft.SharePoint.DLL 文件（版本 2010），以便引用和应用其相关方法。

我遇到的问题是我无法使用 Windows 7 在我的计算机上注册 Micrsooft.SharePoint.DLL 文件，并希望有人能提供帮助。

这是我到目前为止所做的事情，结果如下：

1.  将 Microsoft.SharePoint.DLL 复制到文件夹 C:\Windows\System32 并验证该文件是否存在。
2.  验证 regsvr32.exe 位于文件夹 C:\Windows\System32 中。
3.  在 C:\Windows\System32 中运行以下命令，结果如下： regsvr32 Microsoft.SharePoint.DLL

    框弹出以下消息：“模块“microsoft.sharepoint.dll”已加载，但未找到入口点 DllRegisterServer。确保“microsoft.sharepoint.dll”是有效的 DLL 或 OCX 文件，然后重试。

DLL 文件由 SharePoint 管理员提供。

我还按照其他一些 IT 网站的建议重新启动了计算机，但这并没有什么不同。

在我可以注册 Microsoft.SharePoint.DLL 文件之前，我不能将它用作我的代码中的引用。有人可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:51:20.180

这在设计上是不可能的。不支持在未安装 SharePoint 的计算机上开发和/或运行与 SharePoint 相关的代码，并且没有解决方法。

如果您*必须*这样做并且您的目标是 SharePoint 2010，请考虑使用[客户端对象模型](http://msdn.microsoft.com/en-us/library/ee535231.aspx)。

# windows - 可在 Windows 和 linux 上本地查看的格式化文档

> ID：12573376
> 
> 赞同：0
> 
> 时间：2012-09-24T21:44:01.090
> 
> 标签：windows, linux, ms-office, openoffice.org

如果我希望它们都丰富、易读并且可以由 linux 和 windows 本机打开，我应该用什么来编写我的文档？我想编写文档并将它们放入可以驻留在其中的任何一个的 git 存储库中。我应该使用 OpenOffice 还是有更轻量级的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:13:51.190

轻量级的选项可能是富文本格式 (RTF)，它可以由 Linux（OpenOffice、AbiWord、KOffice）和 Windows（Microsoft Office 和 WordPad！）打开。我建议查看[Wikipedia 文章](http://en.wikipedia.org/wiki/Rich_text_format)。

缺点是它不像新格式（OpenDocument 和 Microsoft 的 Docx 格式）那样通用。您可能希望使用 OpenDocument 格式，因为它是一种标准化的开放格式，并且受到大多数办公套件的支持。Microsoft Word 的格式 IIRC 也标准化了，但我认为对 Microsoft Word 以外的编辑器中的边缘情况的支持不是很好。我也不知道 Microsoft Word 对 OpenDocument 格式的支持有多好，尤其是在保存文档方面。

如果您不需要任何高级功能，您可以选择 RTF =)

# c++ - 为什么 std::count(_if) 返回 iterator::difference_type 而不是 size_t？

> ID：12573377
> 
> 赞同：15
> 
> 时间：2012-09-24T21:44:06.533
> 
> 标签：c++, c++11, stl-algorithm, library-design

> **可能重复：**
> [为什么 C++ 标准算法“count”返回 ptrdiff_t 而不是 size_t？](https://stackoverflow.com/questions/7505083/why-does-the-c-standard-algorithm-count-return-a-ptrdiff-t-instead-of-size-t)

标准 C++ 中有算法`std::count`/ `std::count_if`。

```
template<class InputIterator, class T>
typename iterator_traits<InputIterator>::difference_type
count(InputIterator first, InputIterator last, const T& value);

template<class InputIterator, class Predicate>
typename iterator_traits<InputIterator>::difference_type
count_if(InputIterator first, InputIterator last, Predicate pred); 
```

> 效果：返回 [first,last) 范围内满足以下相应条件的迭代器 i 的数量：*i == value, pred(*i) != false。

`difference_type`is `iterator's difference_type`，它可以是负数，但`count`只能返回值 >= 0。为什么`difference_type`而不是`size_t`例如？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-24T21:51:47.353

理论上，您可能有一个巨大的序列，其元素数量只能用 128 位表示。假设实现支持相应的整数类型，则很有可能`size_t`使用 64 位类型。但是，这个巨大序列的迭代器可以使用 128 位整数。请注意，序列不必在任何单个计算机的内存中表示。它可能被拆分到多个大型数据库中。

您可能还有一台相对较小的计算机，仅支持具有合理性能的 32 位类型。为了完全符合标准，它可能必须支持 64 位类型，但更希望使用平台本机支持的表示来支持更快的计算。也就是说，`size_t`可能不是最佳选择。创建迭代器时，您通常知道需要支持什么大小。

# javascript - Mongo DB 在 Rockmongo 中查找查询

> ID：12573382
> 
> 赞同：0
> 
> 时间：2012-09-24T21:44:30.753
> 
> 标签：javascript, mongodb

非常简单的问题，尝试在rock mongo的“执行”部分运行一些简单的查询我有这个功能

```
function () {
var bla = db.login.find({userData: {userId:'12339'}}).count();
return bla;
} 
```

响应正确 { "retval": 2, "ok": 1 }

如果我最后删除 .count() 并制作这样的功能

```
function () {
var bla = db.login.find({userData: {userId:'12339'}});
return bla;} 
```

回应是

```
{
   "retval": {
     "value": "DBQuery: bet.login -> undefined" 
  },
   "ok": 1 
} 
```

谁能帮我做一个简单的查找...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T01:25:44.897

试试下面的代码，应该可以正常工作：

```
function () {
 var bla = db.login.find({userData: {userId:'12339'}}).next();
 return bla;
} 
```

# php - 用逗号分隔，不在 ( 和 ) 之间

> ID：12573385
> 
> 赞同：2
> 
> 时间：2012-09-24T21:44:50.783
> 
> 标签：php, regex

我使用 preg_split 方法有问题。我想用逗号分隔，但前提是逗号不在**(**和**)**之间。

例如：

```
id,user(id,firstname),image(id) 
```

应该返回：

```
0 => id
1 => user(id,firstname)
2 => image(id) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:53:26.730

快速且易读的解决方案可能是这样的：

```
<?php
function parse($str) {
    $str = preg_replace('~(\(.*?),(.*?\))~', '$1_#_PLACEHOLDER_#_$2', $str);

    $items = array();
    foreach (explode(',', $str) as $item) {
        $items[] = str_replace('_#_PLACEHOLDER_#_', ',', $item);
    };
    return $items;
}

var_dump(parse('id,user(id,firstname),image(id)')); 
```

绝对可以用一个正则表达式来完成，但可读性会受到严重损害。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:50:45.387

您可能想尝试使用解析器生成器而不是正则表达式。我不熟悉 PHP 中的替代方案，但[这个答案](https://stackoverflow.com/a/3720377/5950)表明有几个替代方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T21:53:03.013

我建议尝试找到一个解析器，但可以使用正则表达式来完成。

使用以下正则表达式：`/\G(?> *)(?|([^,]*\((?>\\.|[^()])+\)[^,]*)|(?![()])([^,]+?)) *(?:,|$)/g`

更多细节在这里：[http ://regex101.com/r/nA7dW5](http://regex101.com/r/nA7dW5)

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-25T09:42:48.263

我已经使用`preg_split`with解决了这个问题`PREG_SPLIT_DELIM_CAPTURE`。

```
$tokens = preg_split('#(\,|\(|\))#', 'id,user(id,firstname),image(id)', PREG_SPLIT_DELIM_CAPTURE); 
```

回报：

```
["id", ",", "user", "(", "id", "firstname", ")", "image", "(", "id", ")"] 
```

之后，您可以使用简单的 switch case 解析该数组。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-24T21:53:12.917

正则表达式`/(\([^()]+\))|([^,]+)/`将匹配所有内容，括号外的逗号除外。它有帮助吗？

# database - 内部排序，使用两个堆解释的锦标赛排序算法

> ID：12573390
> 
> 赞同：2
> 
> 时间：2012-09-24T21:45:51.127
> 
> 标签：database, algorithm, sorting, heap, memorystream

我试图理解以下[锦标赛排序](http://en.wikipedia.org/wiki/Tournament_sort)（替换选择），它是一种用于在主存储器中进行排序的排序算法。

任何解释这是如何工作的？

```
Keep two heaps in memory, H1 and H2
read B-2 pages of records, inserting into H1;  #B is buffer size

while (records left) {
  m = H1.removemin();  
  put m in output buffer;
  if (H1 NOT empty)
       read in a new record r (use 1 buffer for input pages);
       if (r < m)  
           H2.insert(r);
       else        
           H1.insert(r);
 else
      H1 = H2;  
      H2.reset();  
      start new output run; 
}
H1.output();  
start new run;  
H2.output(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-24T13:12:29.150

替换选择技术特别有趣，因为产生的运行的预期长度是可用主存储器大小的两倍。这种估计首先由 EH Friend 在 EF Moore 中提出，后来由 EF Moore 描述。在现实世界的应用中，输入数据通常不是随机的（即，它经常表现出某种程度的预排序）。在这种情况下，由替换选择生成的运行往往包含超过 2m 条记录。事实上，对于最好的情况，即当输入数据已经排序时，替换选择只产生一次运行。

给定一组元组记录 status ，其中 record 是从未排序的输入读取的记录， status 是一个布尔标志，指示该记录是活动的还是非活动的。活动记录是当前运行的候选记录，而非活动记录则保存以供下次运行。该算法背后的思想如下：假设主存储器大小为 m，我们从未排序的输入数据中读取 m 条记录，将其状态设置为活动。然后，选择具有最小键和活动状态的元组并将其移动到输出文件。当一个元组被移动到输出（选择）时，它的位置被输入数据中的另一个元组占据（替换）。如果最近读取的记录小于刚刚写入的记录，则其状态设置为非活动，这意味着它将被写入到下一次运行。一旦所有元组都处于非活动状态，

[您可以在此处](http://wwwlgis.informatik.uni-kl.de/cms/fileadmin/publications/2014/MScThesisDusso2014.pdf)阅读有关替换选择的更多信息。

# c - 转换为 unsigned char 不起作用

> ID：12573391
> 
> 赞同：0
> 
> 时间：2012-09-24T21:46:02.283
> 
> 标签：c, types

我有一个非常恼人的问题。这是我正在使用的缓冲区结构

```
typedef struct BufferDescriptor {
   char * ca_head ;    /* pointer to the beginning of character array (character buffer) */
   int capacity ;      /* current dynamic memory size (in bytes) allocated to character buffer */       
   char inc_factor;    /* character array increment factor */
   int addc_offset ;    /* the offset (in char elements) to the app-character location */
   int mark_offset ;   /* the offset (in chars elements) to the mark location */
   char r_flag;        /* reallocation flag */
   char mode;          /* operational mode indicator*/

} Buffer ; 
```

我无法对上述代码进行任何更改。inc_factor 应该能够取 0 到 255 之间的值。

因此在创建缓冲区的函数中，我执行以下操作以确保 inc_factor 不是负数：

```
Buffer* b_create(int init_capacity, char inc_factor,char o_mode){
    Buffer* buffer = (Buffer*)malloc(sizeof(Buffer));
    buffer->ca_head=(char*)malloc(sizeof(char)*init_capacity);

    buffer->inc_factor=(unsigned char)(inc_factor); 
```

但是以下行给出了一个负数：

```
printf("inc factor = %d",buffer->inc_factor); 
```

我在这里做错了什么？请帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:49:31.477

您需要将*值*转换为`unsigned`.

```
char value = 255;
printf("%d\n", value);
printf("%d\n", (unsigned char) value); 
```

应该输出：

```
-1
255 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T21:53:26.287

您正在将`signed`变量格式化为一个`signed`值，因此如果变量超过 127，它当然会输出一个负值。当您将一个`unsigned`值存储到`signed`变量中时会发生这种情况 - 它会环绕为负数。如果您不能更改变量类型本身，那么您必须更改它的格式化方式（将`signed`值类型转换为`unsigned`类型然后分配给`signed`变量是没有意义的）：

```
printf("inc factor = %u", (unsigned char) buffer->inc_factor); 
```

或者：

```
printf("inc factor = %d", (unsigned char) buffer->inc_factor); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:03:10.343

当你定义一个变量的类型时，你实际上是在告诉编译器它应该如何解释内存中的位。因此，将 char 转换为 unsigned char 不会更改内存中的位，但实际上会影响数据如何影响使用它的操作。

在您的情况下，您将其投射，但将其存储回已签名的字符中。当编译器读取数据时（请记住，没有修改任何位），它被解释为有符号字符，因为那是 BufferDescriptor.inc_factor 的类型。

最简单的解决方案是在使用时强制转换：

```
printf("inc factor = %d",(unsigned char)buffer->inc_factor); 
```

但是这里有严重和危险的错误。编译器将在参数键入时将其推入堆栈（在本例中为单字节无符号字符）。问题是 printf 函数在键入时从堆栈中删除参数，您告诉它要解释（在这种情况下， %d 通常表示 4 字节整数）。如您所见，缺少 3 个字节。printf 将强制读取这些额外的三个字节，因此它实际上会从内存中获取无效数据。

要解决此问题，请将其作为 4 字节整数压入堆栈：

```
printf("inc factor = %d",(int)((unsigned char)buffer->inc_factor)); 
```

请注意，在将其转换为 4 字节整数之前，我们将其转换为无符号字符。这是为了强制编译器首先将这些位解释为无符号位，然后对剩余的 3 个字节进行零扩展（而不是符号扩展）。

希望这会有所帮助=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T22:04:54.183

在 char 的 8 位值中，-1 = 1111 1111 二进制和 255 = 1111 1111 二进制。所以它是相同的表示，这一切都取决于你如何投射它。

如果你不投 printf("inc factor = %d",buffer->inc_factor); 您将打印 -1，因为 %d 正在尝试打印带符号的小数。如果您将打印值转换为：

```
printf("inc factor = %d", (unsigned char) buffer->inc_factor); 
```

您将打印 255。您应该将局部变量存储为：

```
unsigned char unsigned_char_inc_factor = (unsigned char) buffer->inc_factor; 
```

之后就使用了 unsigned_char_inc_factor 。

# nuget - 如果可能，对 nuget 进行修改

> ID：12573392
> 
> 赞同：0
> 
> 时间：2012-09-24T21:46:16.993
> 
> 标签：nuget, nuget-package

我最近一直在使用 Nuget 包管理器，发现它很棒。但是我对此有几个问题，它们是痛点，因此我希望有人可以帮助我改进：

*   首先，有什么方法可以将“packages”文件夹的名称更改为其他名称？
*   其次，有人可以解释是否有可能将包文件夹置于解决方案级别而不是项目级别？因此，当我添加一个包时，它可以用于解决方案中的所有项目，而不仅仅是一个。我希望这样做的原因是没有遇到不同项目可能引用不同版本的 dll 的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T04:07:22.787

是的，您可以重命名“packages”文件夹并在**nuget.config中定义它的位置**

例子：

```
<settings> 
    <repositoryPath>..\Build\NuGetPackages\</repositoryPath> 
</settings> 
```

# caching - clojure 向量缓存

> ID：12573395
> 
> 赞同：4
> 
> 时间：2012-09-24T21:46:30.043
> 
> 标签：caching, clojure, fifo

我正在寻找一个表现得像向量的缓存。我一直在使用[core.cache](https://github.com/clojure/core.cache)但那些是地图。我只需要一个简单的 fifo 驱逐方法。我意识到我可以使用该`CacheProtocol`协议简单地创建自己的，但我想知道这样的东西是否已经存在，或者是否有原因这是一个坏主意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:10:39.847

如果您只需要一个类似于向量的接口到缓存，那么值的索引缓存很可能会满足您的需求。我对您的具体问题有所猜测，尽管使用**数字作为缓存的键似乎可能会填充许多用例**，因为向量在概念上与数字到值的映射非常相似：

```
user> (def C (cache/fifo-cache-factory {0 1 1 0}))
user> (get C 0)
1 
```

如果这还不够，那么您可以像这样以向量的形式查看缓存的当前内容：

```
user> (vec (map #(get C % nil) (range 11)))
[1 0 nil nil nil nil nil nil nil nil nil] 
```

在大多数情况下，使用数字作为索引可能会为许多人完成这项工作

# android - 在android上读取文件

> ID：12573397
> 
> 赞同：2
> 
> 时间：2012-09-24T21:46:47.320
> 
> 标签：android, file-io

我正在尝试读取文件，但一直收到错误提示 ENOENT（没有这样的文件或目录）。

我在我的电脑上制作了 .txt 文件，然后我想使用它。我尝试将文件放在许多不同的地方，资产文件夹，数据/数据/文件中，但我不断收到错误消息。有人能帮我吗？

这是我写的代码。

```
 try {
        FileInputStream fis = openFileInput("permissions.txt");
        DataInputStream dataIO = new DataInputStream(fis);
        String strLine = null;
        int i =0;
        while((strLine = dataIO.readUTF()) != null){
            i++;
            String[] temp = strLine.split(":");
            if(temp[0].contains("String")){
                PermissionNames.names[i] = remove(temp[0]);
            }
            PermissionNames.descriptions[i] = temp[1];

        }
        dataIO.close();
        fis.close();

    }catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T00:04:25.793

是的，它应该给您例外，因为您正在尝试访问一个不存在的文件，如果您的资产文件夹中有该文件，那么首先运行将其复制到您的应用程序路径`getFilesDir()`，然后您可以按照您的方式读取它是做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:05:50.527

您想从 SDCard 中读取还是从项目中的资源中读取？

如果您尝试将此文件保存在 SDCard 上，请查看[此链接](https://stackoverflow.com/questions/2902689/how-can-i-read-a-text-file-from-the-sd-card-in-android)。

否则，如果您尝试读取**不在**SDCard 中的文件，那么您将需要查看[此链接](http://www.java-samples.com/showtutorial.php?tutorialid=1522)。

# asp.net-mvc-4 - MVC4 中的 Request.AcceptTypes.Contains 在哪里

> ID：12573402
> 
> 赞同：2
> 
> 时间：2012-09-24T21:47:05.573
> 
> 标签：asp.net-mvc-4

我在互联网上看到很多对这段代码的引用：

```
if (Request.AcceptTypes.Contains ... 
```

但是对于我的生活，我找不到此方法所在的名称空间。

我们正在使用 MVC4 WebApi，这是 MVC3 特有的吗？拜托，在我拔掉剩下的头发之前。

编辑：

与@Styxxyless 一起回答，这就是我得到的（没有AcceptTypes）。我知道我遗漏了一些明显的东西，但它是什么？

![在此处输入图像描述](../Images/6831ed137974e849139d8a864cc96ebe.png)

另外，我在我的项目中引用了 System.Web。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T21:53:57.347

[System.Web.HttpRequest.AcceptTypes](http://msdn.microsoft.com/en-us/library/system.web.httprequest.accepttypes.aspx)

```
public string[] AcceptTypes { get; } 
```

> 获取客户端支持的 MIME 接受类型的字符串数组。

而`Contains()`方法只是基本[`IEnumerable.Contains`](http://msdn.microsoft.com/en-us/library/bb352880.aspx)方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T20:58:45.787

对于**MVC**，代码如下：

```
Request.AcceptTypes.Contains([MIME type]); 
```

对于**Web API**，该功能是使用以下代码实现的：

```
this.Request.Headers.Accept.Contains(new MediaTypeWithQualityHeaderValue([MIME type])) 
```

***或者***

```
this.Request.Headers.GetValues("Accept").Contains([MIME type]) 
```

MIME 类型的一个示例是：`"image/jpeg"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T21:52:58.427

它是 ( `.Contains`) 的一个方法`IEnumerable`，它`Array`实现了。

[http://msdn.microsoft.com/en-us/library/bb352880(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/bb352880(v=vs.100).aspx)

编辑：

如果您查看`Controller`（您的控制器类派生自）的定义，我们有：

```
//
// Summary:
//     Gets the System.Web.HttpRequestBase object for the current HTTP request.
//
// Returns:
//     The request object.
public HttpRequestBase Request { get; } 
```

这就是为什么您在网上看到的代码使用的是`Request.AcceptTypes`，而不是`System.Web.HttpRequest`. 该属性的名称是`Request`，但它返回一个`HttpRequestBase`。现在，如果`System.Web.HttpRequest`该类有一个名为 的静态属性`AcceptTypes`，您将能够通过 访问它`System.Web.HttpRequest.AcceptTypes`。

对不起所有的混乱！

执行：

```
public ActionResult Index()
{
    if (Request.AcceptTypes.Contains("image/jpeg"))
    {
        // Do something.
    }

    return View();
} 
```

# webview - 如何在 DesktopApp 中将 JavaFX WebView 与本地文件一起使用？

> ID：12573406
> 
> 赞同：6
> 
> 时间：2012-09-24T21:47:28.857
> 
> 标签：webview, desktop-application, executable-jar

当我在 eclipse 中使用它时，我的 webview 就像魅力一样工作，但是一旦我将应用程序打包到一个 jar 文件中，它就会引发以下错误：

```
This page contains the following errors:
error on line 33 at column 26: StartTag: invalid element name
Below is a rendering of the page up to the first error. 
```

这是 HTML 文件

```
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="EN">
    <head>
    <style>
        html,body {
            height: 99%;
            width: 99%;
        }
        #map {
            width: 100%;
            height: 100%;
            border: 1px solid black;
        }   
    </style>
    <script src='http://openlayers.org/api/OpenLayers.js'></script>
    </head>
    <body>
        <div id='map'></div>
        <script type="text/javascript">
            var map = new OpenLayers.Map("map",{projection:"EPSG:3857"});
            var toMercator = OpenLayers.Projection.transforms['EPSG:4326']['EPSG:3857'];
            var center = toMercator({x:-0.05,y:51.5});
            var osm = new OpenLayers.Layer.OSM();
            map.addLayer(osm);

            map.zoomToMaxExtent();  

            function addPoints(lon,lat,merkm){
                var features = [];

                for(var i = 0; i < lon.length; i++) {
                    var center = toMercator({x:lon[i],y:lat[i]});
                    features[i] = new OpenLayers.Feature.Vector(
                            toMercator(new OpenLayers.Geometry.Point(
                                lon[i],
                                lat[i])), 
                            {
                                infoitems : merkm[i]
                            }, {
                                fillColor : '#008040',
                                fillOpacity : 0.8,                    
                                strokeColor : "#ee9900",
                                strokeOpacity : 1,
                                strokeWidth : 1,
                                pointRadius : 8
                            });
                }

                // create the layer with listeners to create and destroy popups
                var vector = new OpenLayers.Layer.Vector("Points",{
                    eventListeners:{
                        'featureselected':function(evt){
                            var feature = evt.feature;
                            var popup = new OpenLayers.Popup.FramedCloud("popup",
                                OpenLayers.LonLat.fromString(feature.geometry.toShortString()),
                                null,
                                "<div style='font-size:.8em'>"+feature.attributes.infoitems+"</div>",
                                null,
                                true
                            );
                            feature.popup = popup;
                            map.addPopup(popup);
                        },
                        'featureunselected':function(evt){
                            var feature = evt.feature;
                            map.removePopup(feature.popup);
                            feature.popup.destroy();
                            feature.popup = null;
                        }
                    }
                });
                vector.addFeatures(features);

                var line = new OpenLayers.Control.DrawFeature(vector,
                        OpenLayers.Handler.Path);

                // create the select feature control
                var selector = new OpenLayers.Control.SelectFeature(vector,{
                    hover:true,
                    autoActivate:true
                }); 
               // map.destroy();
               // map = new OpenLayers.Map("map",{projection:"EPSG:3857"});

              //  var osm = new OpenLayers.Layer.OSM();
                map.addLayer(vector);
                map.addControl(selector);
                map.addControl(line);
                map.setCenter(new OpenLayers.LonLat(center.x,center.y), 13);

            }
            function pageOnLoad(){
                alert();
            }
        </script>
    </body>
</html> 
```

这就是我加载 WebView 的方式：

```
WebView browser = new WebView(); 
        final WebEngine webEngine = browser.getEngine();

        String mapfolder = "mapview";
        File map = new File(new File("."), "/mapview/mapview.html");

        final URL mapUrl = MapTab.class.getResource("mapview.html");

        webEngine.getLoadWorker().stateProperty().addListener(
                new ChangeListener<State>() {
                    public void changed(ObservableValue ov, State oldState, State newState) {
                        if (newState == State.SUCCEEDED) {
                            webEngine.executeScript("addPoints("+arg0+","+arg1+","+arg2+")");
                        }
                    }
                });
        webEngine.javaScriptEnabledProperty().set(true);
        webEngine.load(mapUrl.toExternalForm());
        this.setContent(browser); 
```

我现在不知道问题出在哪里，尝试了许多不同的东西，比如不同的文件位置、脚本位置等等。

有人有想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T23:15:43.990

当您从 jar 中加载某些内容时，我认为您不能将 File 协议与 getResource 协议结合使用。我也不认为 jar 协议会理解文件类型说明符，比如`.`and `..`。

如果地图 html 位于 jar 之外的本地文件系统上，则使用`file://`协议从文件系统中加载地图 html。

如果按照我的预期将地图 html 打包在您的 jar 中，请使用以下`/mapview/mapview.html`命令将其从 jar 中加载出来：

```
webEngine.load(MapTab.class.getResource("/mapview/mapview.html").toExternalForm()); 
```

我认为您遇到的错误是因为您正在设置一个 xhtml doctype，这意味着与更宽松的直接 html doctype 相比，它通过了非常严格的类型检查。您的示例文档不是兼容的 xhtml 文档。

我放宽了 html 文档的 doctype，对其进行了一些重构，以便我可以理解它创建了一个简单的加载器应用程序并能够加载地图。

*/mapview/mapview.html*

```
<!doctype html>  
<html lang="en">  
  <head>
  <style>
    html,body {
      height: 99%;
      width: 99%;
    }
    #map {
      width: 100%;
      height: 100%;
      border: 1px solid black;
    }   
  </style>
  <script language="javascript" src="http://openlayers.org/api/OpenLayers.js"></script>   
  <script language="javascript" type="text/javascript">
    function doload() {
      var map = new OpenLayers.Map("map",{projection:"EPSG:3857"});
      var toMercator = OpenLayers.Projection.transforms['EPSG:4326']['EPSG:3857'];
      var center = toMercator({x:-0.05,y:51.5});
      var osm = new OpenLayers.Layer.OSM();
      map.addLayer(osm);

      map.zoomToMaxExtent();  
    }  
    function addPoints(lon,lat,merkm){
      var features = [];

      for(var i = 0; i < lon.length; i++) {
          var center = toMercator({x:lon[i],y:lat[i]});
          features[i] = new OpenLayers.Feature.Vector(
                  toMercator(new OpenLayers.Geometry.Point(
                      lon[i],
                      lat[i])), 
                  {
                      infoitems : merkm[i]
                  }, {
                      fillColor : '#008040',
                      fillOpacity : 0.8,                    
                      strokeColor : "#ee9900",
                      strokeOpacity : 1,
                      strokeWidth : 1,
                      pointRadius : 8
                  });
      }

      // create the layer with listeners to create and destroy popups
      var vector = new OpenLayers.Layer.Vector("Points",{
          eventListeners:{
              'featureselected':function(evt){
                  var feature = evt.feature;
                  var popup = new OpenLayers.Popup.FramedCloud("popup",
                      OpenLayers.LonLat.fromString(feature.geometry.toShortString()),
                      null,
                      "<div style='font-size:.8em'>"+feature.attributes.infoitems+"</div>",
                      null,
                      true
                  );
                  feature.popup = popup;
                  map.addPopup(popup);
              },
              'featureunselected':function(evt){
                  var feature = evt.feature;
                  map.removePopup(feature.popup);
                  feature.popup.destroy();
                  feature.popup = null;
              }
          }
      });
      vector.addFeatures(features);

      var line = new OpenLayers.Control.DrawFeature(vector,
              OpenLayers.Handler.Path);

      // create the select feature control
      var selector = new OpenLayers.Control.SelectFeature(vector,{
          hover:true,
          autoActivate:true
      }); 
     // map.destroy();
     // map = new OpenLayers.Map("map",{projection:"EPSG:3857"});

    //  var osm = new OpenLayers.Layer.OSM();
      map.addLayer(vector);
      map.addControl(selector);
      map.addControl(line);
      map.setCenter(new OpenLayers.LonLat(center.x,center.y), 13);
    }
    function pageOnLoad(){
      alert();
    }
  </script>    
  </head>
  <body onload="doload()">
    <div id="map"></div>
  </body>
</html> 
```

*/javafxsamples/MapViewer.java*

```
package javafxsamples;

import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.web.WebView;
import javafx.stage.Stage;

public class MapViewer extends Application {
  public static void main(String[] args) { launch(args); }
  @Override public void start(Stage stage) {
    WebView webview = new WebView();
    webview.getEngine().load(
      MapViewer.class.getResource("/mapview/mapview.html").toExternalForm()            
    );
    stage.setScene(new Scene(webview));
    stage.show();
  }
} 
```

![示例程序输出](../Images/936c75a5c8d4932e92a8b6e05dd6eb98.png)

# iphone - 是否可以使用 '?' 调用项目？以它的名义？

> ID：12573422
> 
> 赞同：0
> 
> 时间：2012-09-24T21:49:29.400
> 
> 标签：iphone, xcode

当我尝试在 iphone 上测试我的项目时，我收到“已添加已签名资源已修改或删除”消息。我将项目名称更改为不包含“？” 在其中，然后它起作用了。

是否允许有'？在 XCode 中的项目名称中？

编辑：找到这个回答我的问题的链接： http: [//code-ninja.org/blog/2012/04/17/signed-resource-has-been-added-modified-or-deleted/](http://code-ninja.org/blog/2012/04/17/signed-resource-has-been-added-modified-or-deleted/)

简而言之，它告诉您我的预期：您不能输入“？” 在您的项目名称中。请参阅下面的答案如何允许“？” 在您的应用名称中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:02:26.003

由于捆绑显示名称（用户将在图标下看到的名称）在 Info.plist 中单独设置为您喜欢的任何内容，因此没有理由在产品名称中保留特殊字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T23:06:50.507

好的，找到了解决方案。

正如我在问题中所写，我发现了这个链接： [http ://code-ninja.org/blog/2012/04/17/signed-resource-has-been-added-modified-or-deleted/](http://code-ninja.org/blog/2012/04/17/signed-resource-has-been-added-modified-or-deleted/)

简而言之，如果你想拥有'？显示在您的应用名称中，您需要：

1.  在 xcode 的项目属性中更改“捆绑显示名称”。点击项目名称->目标->信息->捆绑显示名称。

2.  确保您的项目名称不包含“？” 在里面。

3.  在 iphone 上测试应用程序。

请注意，如果您尝试使用模拟器运行应用程序，它将允许项目名称允许“？”。

享受。

# grails - GRAILS：HQL - 使用 IF (ISNULL) 排序

> ID：12573428
> 
> 赞同：1
> 
> 时间：2012-09-24T21:50:38.210
> 
> 标签：grails, hql, grails-orm

我想知道如何格式化这个查询。我有一个包含三个日期的表格，其中一些日期可以为空。这三个字段是createdDate、downDate 和fixDate。我需要根据日期查询并获取最新条目。例如，如果 fixDate 不为 null，则按 fixDate 排序，如果为 null，则我需要按 downDate 排序。如果downDate 为空，那么我按createdDate 排序。

通过 mySQL，我得到了正确的结果：

```
SELECT * FROM history WHERE equipment_id=88 ORDER BY IF(ISNULL(fix_date), IF(ISNULL(down_date), created_date, down_date), fix_date) DESC; 
```

我正在尝试将其放入我的 grails 项目并使用 HQL 并尝试过（也尝试过其他变体）：

```
History.executeQuery("SELECT FROM History WHERE equipment=:eqpt ORDER BY " +
"IF(ISNULL(fixDate), IF(ISNULL(downDate), createdDate, downDate), fixDate) DESC", [eqpt:equipment]) 
```

也试过：

```
 History.executeQuery("SELECT FROM History WHERE equipment=:eqpt ORDER BY " +
    "IF(COALESCE(fixDate,downDate,createdDate) DESC", [eqpt:equipment]) 
```

我得到的错误是：

```
nexpected token: FROM near line 1, column 8 [SELECT FROM com...History WHERE equipment=:eqpt ORDER BY IF(COALESCE(fixDate, downDate, createdDate) DESC] 
```

我很感激任何帮助，如果有一个 createCriteria 解决方案也很好。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:05:17.970

我从未尝试过，但[Hibernate 文档](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/queryhql.html#queryhql-expressions)说，“where”子句支持 coalesce()。如果它在“选择”子句中也可用，您可以选择合并日期，然后按它排序，因为文档还指出

> “查询返回的列表可以按返回的类或组件的任何属性排序”

所以，也许是这样的：

```
 select h.prop1, h.prop2, coalesce(h.fixDate, h.downDate, h.createdDate) as orderDate from history h where ..... order by orderDate 
```

# css - Internet Explorer 间距问题将内容向下推，CSS

> ID：12573429
> 
> 赞同：0
> 
> 时间：2012-09-24T21:50:38.850
> 
> 标签：css, internet-explorer, browser

我对使用 Java 插件和 CSS 构建网站相当陌生。我已经完成了我的网站，在 safari、firefox、chrome 和 opera 上看起来很棒，但如果我在 Internet Explorer 上查看它，就会出现巨大的间距问题。这是该网站的网址：http: [//melisachamorro.com/](http://melisachamorro.com/)“我的工作”部分顶部的内容被分成两行，然后将其余内容向下推。我曾经通过在我的 css 中的值之前键入“*”或“_”来修复 IE 中的间距问题。例如 (_padding-left: 240px;)。这似乎不再起作用（我上次使用该技巧是在两年前，所以我确信它现在已经完全过时了）。任何人都可以提供的任何帮助或建议将不胜感激。如果我需要提供更多信息来澄清某些事情，请告诉我。（另外请不要太苛刻地判断我的“编码”，我有时不知道我在做什么）提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:05:45.420

[根据 W3C Validator](http://validator.w3.org/check?uri=http://melisachamorro.com/&charset=%28detect%20automatically%29&doctype=Inline&group=0)，您有一堆无效的 HTML 。

Internet Explorer 讨厌无效的 HTML，并且在遇到它时可能会进入[怪癖模式。](http://www.quirksmode.org/css/quirksmode.html)如果您想要更一致的跨浏览器体验，请始终验证您的代码。

另见：[https ://stackoverflow.com/a/1695790/594235](https://stackoverflow.com/a/1695790/594235)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-24T22:01:26.190

下面是如何创建仅 IE 样式表的详细说明。听起来您的网站面向非 IE 浏览器。如果 IE 是您客户的主要浏览器，我会使用不同的方法。

[http://css-tricks.com/how-to-create-an-ie-only-stylesheet/](http://css-tricks.com/how-to-create-an-ie-only-stylesheet/)

# javascript - 有没有一种简单的方法可以在点击事件的两个状态之间切换背景位置？

> ID：12573432
> 
> 赞同：-3
> 
> 时间：2012-09-24T21:50:45.467
> 
> 标签：javascript, jquery, css

我有一个下拉价目表，细分为小块以便于查看，提供多种服务，一些服务细分为子类别，用户可以单击带有向下箭头的按钮，单击按钮的另一级子类别是slideToggle 显示。箭头按钮保留在底部，以便他们可以在准备好时隐藏子类别。

我希望将箭头从隐藏子类别时的向下更改为显示它们时的向上。我已经准备好了一个包含两个箭头状态的图像`png`，我只需要一个命令/一组命令，这些命令将在隐藏/显示子类别时在状态之间切换箭头。

箭头位于此 HTML 中，作为`.arrows`div 的背景图像。

```
<div class="morebutton" id="firstarrow">

    <div class="arrows">

    </div>

</div> 
```

这是CSS：

```
.morebutton{
width:220px;
height:8px;
border:outset 1px #ddd;
/*margin-bottom:5px;*/
margin-left:auto;
margin-right:auto;
margin-top:0px;
background:#ddd;
border-radius:25px;
cursor:pointer;
overflow:hidden;
}

.morebutton:hover{
background:#eee;
height:15px;        
}

.arrows{
width:20px;
height:15px;
margin:0px auto;
background:url(images/morearrows.png) no-repeat 0px 0px;
} 
```

这是元素上的当前 jQuery：

```
$("#firstarrow").click(function(){
    $("#londonmore").slideToggle(100);
});
//this reveals the sub-categories in a table called #londonmore 
```

这是我尝试过的（在上面的函数中）：

```
$(this).toggle( 
    function(){ 
        $(".arrows").css({"background-position":"0px"}); 
    },  
    function(){ 
        $(".arrows").css({"background-position":"10px"}); 
}); 
```

我尝试过处理背景位置变化的数量，但它所做的只是稍微移动箭头，它不会在第一次点击时移动它，也不会移动到我想要的位置，它也没有继续隐藏子类别。

![子类别隐藏。 箭头朝下。](../Images/3d1f7f71af21b0e9a1f065ab26934fb8.png)

![子类别显示。 箭头应该朝上。](../Images/fc9d0e626a757055df04e001f3370fdd.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:21:27.647

这个答案必须有点笼统，因为您还没有发布任何代码，但是您在[.slideToggle()](http://api.jquery.com/slideToggle/)上有一个回调。用它来做[.css()](http://api.jquery.com/css/)

您只需要检查您所处的状态，然后设置右箭头即可。

例如：

```
 $('#button1').slideToggle('slow',function() {
        if ( ... ) {
            $('#arrow1').css('background-position','?px ?px');
        } else {
            $('#arrow1').css('background-position','?px ?px');
        }
    }); 
```

您必须填写空白 - 或者您可以以另一种方式实现回调，但是如果您想在 slideToggle 触发时更改 css，无论您做什么，使用回调都是可行的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T19:33:29.743

我不会直接通过`jQuery.css`. 我只是切换一个 CSS 类。我不确定你的标记是什么样的，但为了一个例子，让我们这样做：

```
<div class="expandable">
  <a href="#" class="expandable-expander">
    <span class="arrows">This is our arrow element</span>
  </a>
  <div class="expandable-content">
      <p>This is the content to expand!</p>
      <p>This is the content to expand!</p>
      <p>This is the content to expand!</p>
      <p>This is the content to expand!</p>
      <p>This is the content to expand!</p>
      <p>This is the content to expand!</p>
  </div>
</div> 
```

然后我们可以做这个css：

```
.arrows {
  /* this is the default state and as the default we want the arrow closed
     so the bg position 0 0 is for the closed state */
  width:20px;
  height:15px;
  margin:0px auto;
  display: inline-block;
  background: #f00 url(images/morearrows.png) no-repeat 0 0;
  text-indent: -999em;
}
.expandable {
  width:220px;
}
.expandable .expandable-expander {
   display: block;
   background: #ccc;
   width:220px;
   height:8px;
   border:outset 1px #ddd;
   margin-left:auto;
   margin-right:auto;
   margin-top:0px;
   background:#ddd;
   border-radius:25px;
   cursor:pointer;
   overflow:hidden;
}

.expandable .expandable-content {

   /* content is hidden at first unles .expandable is also .open */
    display: none;
}

.expandable.open .expandable-content {
   display: block;
}

.expandable .expandable-expander:hover {
   background:#eee;
   height:15px;
}

.expandable.open .expandable-expander .arrows {
   background-position: 0 -10px;
   /* only change the background position because everything else is set up */
    background-color: #0f0;
} 
```

最后是我们基于 jQuery 的 js：

```
$(function(){
   $('.expandable .expandable-expander').click(function (e) {
       var $this = $(this),
           $container = $this.closest('.expandable'),
           $content = $container.find('.expandable-content');
       e.preventDefault();

       $content.slideToggle(100, function () {
           $container.toggleClass('open');
       });
   });
}); 
```

通过这样做并基于自包含结构配置事物，您只需在任何给定页面上运行此代码一次，只要您使用符合标准的类结构就可以了。您可以在许多地方重复使用它，而无需更改任何内容。

[工作小提琴](http://jsfiddle.net/tNwss/)

请注意...除非您可以确保 DOM 的状态，否则您可能希望避免切换功能并使用长手版本。如果某些东西不同步，您可能会在打开其他东西的同时关闭其他东西。我不认为在这种情况下这将是一个问题。

# fortran - OPEN语句中FORM="FORMATTED"是什么意思？

> ID：12573436
> 
> 赞同：1
> 
> 时间：2012-09-24T21:51:15.433
> 
> 标签：fortran, fortran90

我在 FORTRAN 中有 2 个问题（我是这种语言的新手）。

我有以下代码行：

```
 OPEN(UNIT=79, FILE='sampling.txt', FORM='FORMATTED')
  READ(79,*) NP1,NP2,IW 
```

NP1,NP2,IW 被声明为整数。

打开的“格式化”是什么？我在读什么数据？READ 行是否读取单行并将数据放在 NP1、NP2、IW 中？数据是逗号分隔的吗？空间分隔？

我的下一个问题是：

```
D_IN = (RD/1000000)**(2./3.)/9.81**(1./3.) 
```

这条线是做什么的？？（D_IN 和 RD 是 REAL*8）有人可以把它翻译成 C 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:58:36.210

"Formatted" basically means text output - i.e. human readable. The alternative is "unformatted", which allows the processor to write the file using bits and bytes (or whatever its equivalent is) rather than text. In C, the distinction is made at the library call level - fprintf (~formatted) versus fwrite (~unformatted).

Your read statement uses what is known as list directed formatting (nominated by the `*` in the second position of the parenthesised list) - the format of the input is determined based on the list of items in the input, rather than being explicitly specified by the programmer. The language has a set of rules around how input is translated under list directed formatting - rules that made a lot of sense back in the day of punched cards, but may surprise users of today. As a brutally incomplete summary - records (which may be multiple lines) will be read from the file until three values have been read Those values will be interpreted as integers. Values within a record may be separated by commas or blanks.

Assuming the bold formatting was inadvertent (if not, the line is a syntax error, the Fortran 90 processor will give you a diagnostic, the number of ways in which to get a syntax error in the C language is rather large) the line starting with `D_IN` is an assignment statement. The value of the expression on the right of the `=` will be assigned to the variable on the left. The equivalent C is almost a literal transcription (you would typically need to append `f` after the floating point constants to use the analogous numeric type, but this depends on the specifics of your Fortran processor and C implementation).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:57:46.680

A formatted file is more or less a text file. Formatted means that numbers and other variables are stored as characters. Otherwise the actual formatting of the file is up to you. In your example the * in the read statement means a so called "list directed format" which lets a lot of freedom for the processor when writing and reading. If you need more, the formatted I/O is one of the more difficult Fortran aspects and you should study on of the numerous resources on the [web](http://www.cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap05/format.html).

* * *

The other question: The operator `**` is the power operator. If the second operand is not a small integer use the function `pow()` in C when translating.

# c++ - 字符串流未按预期工作

> ID：12573437
> 
> 赞同：0
> 
> 时间：2012-09-24T21:51:17.860
> 
> 标签：c++, vector, stringstream

我正在尝试编写用于解析和处理文本文件的程序。在没有成功实施**sscanf**后，我决定尝试**stringstream**。

我有包含用空格分隔的数据的字符串向量，例如：

> some_string another_string yet_another_string VARIABLE_STRING_NO_1 next_string

我写了代码，预期的结果是：

```
Counter: 4
Variable number 1 : VARIABLE_STRING_NO_1
Variable number 2 : VARIABLE_STRING_NO_2
Variable number 3 : VARIABLE_STRING_NO_3
Variable number 4 : VARIABLE_STRING_NO_4 
```

但相反我得到：

```
Counter: 4
Variable number 1 : VARIABLE_STRING_NO_1
Variable number 2 : VARIABLE_STRING_NO_1
Variable number 3 : VARIABLE_STRING_NO_1
Variable number 4 : VARIABLE_STRING_NO_1 
```

谁能把我推向正确的方向？（例如，使用其他容器代替矢量，将方法更改为...等）

另外，如果**VARIABLE_STRING**包含 2 个中间有空格的子字符串怎么办？这在我的数据中是可能的。

示例代码：

```
#include <iostream>
#include <sstream>
#include <vector>
using namespace std;

int main()
{
    vector<string> vectorOfLines, vectorOfData;

    vectorOfLines.push_back("some_string another_string yet_another_string VARIABLE_STRING_NO_1 next_string");
    vectorOfLines.push_back("some_string another_string yet_another_string VARIABLE_STRING_NO_2 next_string");
    vectorOfLines.push_back("some_string another_string yet_another_string VARIABLE_STRING_NO_3 next_string");
    vectorOfLines.push_back("some_string another_string yet_another_string VARIABLE_STRING_NO_4 next_string");

    string data = "", trash = "";
    stringstream token;

    int counter = 0;

    for( int i = 0; i < (int)vectorOfLines.size(); i++ )
    {
        token << vectorOfLines.at(i);
        token >> trash >> trash >> trash >> data >> trash;
        vectorOfData.push_back(data);                       //  wrong method here?
        counter++;                                          //  counter to test if for iterates expected times
    }

    cout << "Counter: " << counter << endl;

    for( int i = 0; i < (int)vectorOfData.size(); i++ )
    {
        cout << "Variable number " << i + 1 << " : " << vectorOfData.at(i) << endl;
    }

    return 0;
} 
```

请原谅我的新手问题，但在过去 5 天尝试了不同的方法之后，我到了发誓并气馁继续学习的地步。
是的，我对 C++ 很陌生。
我已经在 PHP 中成功地完成了相同的程序（这也是完全的新手），看起来 C++ 做起来要困难得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:03:30.597

您想在阅读个人后重置您的字符串流。从外观上看，您正在使用的字符串流进入失败状态。在这一点上，它不会除了任何进一步的输入，直到状态得到`clear()`。此外，您应该**始终**验证您的阅读是否成功。也就是说，我会像这样开始你的循环体：

```
token.clear();
token.str(vectorOfLines[i]);
if (token >> trash >> trash >> trash >> data >> trash) {
    process(data);
}
else {
    std::cerr << "failed to read '" << vectorOfLines[i] << "\n";
} 
```

我也只会使用`std::istringstream`.

# php - 如何在数组中使用多个变量

> ID：12573441
> 
> 赞同：3
> 
> 时间：2012-09-24T21:51:40.893
> 
> 标签：php, html, arrays, variables

我正在制作一份食谱清单。用户可以输入多种成分，其中每种成分都有***名称***（西红柿、洋葱、牛奶）、***数量***（5 个西红柿、1 个洋葱）、***测量值***（盎司、汤匙、杯）和***分数***（如果需要）（1/4 杯、1 /2 汤匙，3/4 茶匙）。我想将每个变量保留为一个单独的变量，以便以后可以使用它来创建购物清单。

我可以使用 foreach 函数来完成这项工作吗？我如何能够为我可以使用的每种成分将四个变量设置为一个数组？

还是有另一种方法可以做到这一点？一个变量可能有多个值？

```
<?php
$recipe = $_POST["recipe"];
$ingredient_amount_01 = $_POST["ingredient_amount_01"];
$fractions_01 = $_POST["fractions_01"];
$measurement_01 = $_POST["measurement_01"];
$ingredient_01 = $_POST["ingredient_01"];
if (!isset($_POST['submit'])) { // if page is not submitted to itself echo the form
?>

<html>
<head>
<title>Recipes</title>
</head>
<body>

<form method="post" action="<?php echo $PHP_SELF;?>">

Recipe Name:<input type="text" size="12" maxlength="12" name="recipe"><br />
Ingredients<br />

1:<select name="ingredient_amount_01">
<option value="">Amount...</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option></select>

<select name="fractions_01">
<option value="">---</option>
<option value="one_quarter">¼</option>
<option value="one_half">½</option>
<option value="three_quarters">¾</option></select>

<select name="measurement_01">
<option value="">Measurement...</option>
<option value="cup">Cup</option>
<option value="oz">Oz</option>
<option value="scoop">Scoop</option>
<option value="slice">Slice</option>
<option value="tablespoon">Tbsp</option>
<option value="teaspoon">Tsp</option></select>

<input type="text" size="12" maxlength="100" name="ingredient_01" placeholder="Ingredient"><br />

<input type="submit" value="submit" name="submit">
</form>

<?
} else {
echo "Hello. Here is the recipe for <b>" .$recipe. "</b> that you've submitted.<br />";

echo "Ingredients:<br />";
foreach ($ingredient as $g) {
echo $g <-- This would show something like, 2 1/2 cup milk -->. "<br />";
}
echo "Recipe:".$recipe."<br />";
echo "Item Amount:".$ingredient_amount_01."<br />";
echo "Fractions:".$fractions."<br />";
echo "Measurement:".$measurement."<br />";
echo "Ingredient:".$ingredient."<br />";
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:02:38.473

您可能希望这样命名您的字段：

```
<select name='ingredient[]'> <!--options here --> </select>
<select name='fraction[]'><!-- fraction options here --></select> 
etc. 
```

这将在您发布数据时将值加载到数组中，然后您可以使用 for 循环遍历所有提交的字段。例如，

```
<?php 
$ingredients = $_POST['ingredients']; //creates an array of all posted ingredients
$fractions = $_POST['fractions']; //creates an array of all posted fractions

for ($i = 0; $i < count($ingredients); $i++)
{
     $all_ingredients[] = $ingredient[$i] . ' ' . $fractions[$i]; 
}

?> 
```

假设第一种成分是西红柿，分数是 1/4，回显 $all_ingredients[0] 将显示：tomato 1/4 您可以对此进行扩展以包含所有表单字段并根据需要输出字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:02:28.053

改变这个：

```
$recipe = $_POST["recipe"];
$ingredient_amount_01 = $_POST["ingredient_amount_01"];
$fractions_01 = $_POST["fractions_01"];
$measurement_01 = $_POST["measurement_01"];
$ingredient_01 = $_POST["ingredient_01"]; 
```

有了这个：

```
$ingredient['recipe'] = $_POST["recipe"];
$ingredient['amount_01'] = $_POST["ingredient_amount_01"];
... 
```

在您的 foreach 中，您可以使用：

```
foreach($ingredient as $key=>$value)
   echo $key.":".$value; 
```

# android - Google Play 音乐是否占用了所有 ACTION_MEDIA_BUTTON 意图？

> ID：12573442
> 
> 赞同：7
> 
> 时间：2012-09-24T21:51:46.017
> 
> 标签：android, android-intent

当发送带有 ACTION_MEDIA_BUTTON 意图的 sendOrderedBroadcast 时（我在模仿用户正在单击蓝牙耳机上的播放按钮），Google Play 音乐打开并播放最后播放的专辑，而不是前台音乐播放应用程序。

如果我将其更改为 sendBroadcast，Google Play 音乐和当前的音乐播放应用程序（在我的例子中是 Pandora）都会启动播放按钮。

**这仅发生在 Android 4.0 及更高版本**中。Play Music 是否有这种意图（一个错误）？您是否怀疑 Pandora 没有按照以下建议将自己注册为当前的媒体按钮处理程序： [http ://android-developers.blogspot.com/2010/06/allowing-applications-to-play-nicer.html](http://android-developers.blogspot.com/2010/06/allowing-applications-to-play-nicer.html)

有没有办法可以将这种意图仅指向当前的音乐播放应用程序？

这是我的代码：

```
public void broadcastMediaIntent(MediaIntent intentType){

      long eventtime = SystemClock.uptimeMillis(); 

      Intent downIntent = new Intent(Intent.ACTION_MEDIA_BUTTON, null); 
      Intent upIntent = new Intent(Intent.ACTION_MEDIA_BUTTON, null); 

      KeyEvent downEvent = null;
      KeyEvent upEvent = null;

    switch(intentType){
    case NEXT:

          downEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_MEDIA_NEXT, 0);

          upEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_UP, KeyEvent.KEYCODE_MEDIA_NEXT, 0); 

        break;
    case PLAY_PAUSE:

          downEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE, 0); 

          upEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_UP, KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE, 0); 

        break;
    case PREVIOUS:

          downEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_MEDIA_PREVIOUS, 0); 

          upEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_UP, KeyEvent.KEYCODE_MEDIA_PREVIOUS, 0);  
        break;
    case FAST_FORWARD:

          downEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_MEDIA_FAST_FORWARD, 0); 

          upEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_UP, KeyEvent.KEYCODE_MEDIA_FAST_FORWARD, 0);  
        break;
    case REWIND:

          downEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_MEDIA_REWIND, 0); 

          upEvent = new KeyEvent(eventtime, eventtime, 
          KeyEvent.ACTION_UP, KeyEvent.KEYCODE_MEDIA_REWIND, 0);
        break;

    default:
        break;
    }

      downIntent.putExtra(Intent.EXTRA_KEY_EVENT, downEvent); 
      sendOrderedBroadcast(downIntent, null); 

      upIntent.putExtra(Intent.EXTRA_KEY_EVENT, upEvent); 
      sendOrderedBroadcast(upIntent, null); 

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T23:18:48.200

以下应该可以解决问题。BTW，你在哪里找到锁屏的源代码？

```
 public void handleMediaKeyEvent(KeyEvent keyEvent) {

    /*
     * Attempt to execute the following with reflection. 
     * 
     * [Code]
     * IAudioService audioService = IAudioService.Stub.asInterface(b);
     * audioService.dispatchMediaKeyEvent(keyEvent);
     */
    try {

        // Get binder from ServiceManager.checkService(String)
        IBinder iBinder  = (IBinder) Class.forName("android.os.ServiceManager")
        .getDeclaredMethod("checkService",String.class)
        .invoke(null, Context.AUDIO_SERVICE);

        // get audioService from IAudioService.Stub.asInterface(IBinder)
        Object audioService  = Class.forName("android.media.IAudioService$Stub")
                .getDeclaredMethod("asInterface",IBinder.class)
                .invoke(null,iBinder);

        // Dispatch keyEvent using IAudioService.dispatchMediaKeyEvent(KeyEvent)
        Class.forName("android.media.IAudioService")
        .getDeclaredMethod("dispatchMediaKeyEvent",KeyEvent.class)
        .invoke(audioService, keyEvent);            

    }  catch (Exception e1) {
        e1.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-05T19:18:04.637

您必须使用一个 API 作为这些意图的首选接收者，但这当然可以由系统密钥的发送者处理。看看[这篇文章](http://android-developers.blogspot.se/2010/06/allowing-applications-to-play-nicer.html)和[文档](http://developer.android.com/reference/android/media/AudioManager.html#registerMediaButtonEventReceiver%28android.content.ComponentName%29)。但在这种情况下，这取决于潘多拉和谷歌音乐，所以这可能不取决于你。你当然也可以将你的广播发送到一个特定的包（通过在意图中指定组件名称），然后你决定哪个应用程序得到它。我在 AudioManager 中快速搜索了一个隐藏的 API，但这看起来并不乐观。

你试过用配件吗？如果可行，那么我将研究如何发送该意图。如果没有，我会查看安装了哪些应用程序，然后进行“智能”猜测或询问用户要将意图发送到哪个应用程序。也许最后一个是两种情况下最好的方法，因为它使用公共 API 并且不会因为猜错而惹恼用户:)

**编辑：** 这可以工作，但它也可能受到权限和证书的保护。在锁屏中，媒体键的处理方式如下：

```
void handleMediaKeyEvent(KeyEvent keyEvent) {
    IAudioService audioService = IAudioService.Stub.asInterface(
            ServiceManager.checkService(Context.AUDIO_SERVICE));
    if (audioService != null) {
        try {
            audioService.dispatchMediaKeyEvent(keyEvent);
        } catch (RemoteException e) {
            Log.e("KeyguardViewBase", "dispatchMediaKeyEvent threw exception " + e);
        }
    } else {
        Slog.w("KeyguardViewBase", "Unable to find IAudioService for media key event");
    }
} 
```

但是，API 是隐藏的，因此您必须解决这个问题。这可能是我能帮助你的最好的了。另一种方法是注入事件。做到这一点的一种方法是成为一种输入法，但这不太可能是一种前进的方式。有几种方法可以将事件注入到您自己的活动中，但我不知道任何注入系统的方法。也许你可以看看仪器测试是如何做到的。

# facebook - 洞察数据检索

> ID：12573448
> 
> 赞同：1
> 
> 时间：2012-09-24T21:52:14.490
> 
> 标签：facebook

我们用于社交括号游戏的 Facebook 开发者应用程序 ID（我们用来测量游戏中的洞察数据）被开放图形页面级别 Facebook 应用程序 ID（用于 Facebook 点赞）覆盖，因为括号游戏的开发者应用程序 ID 是被页面级应用程序 ID 覆盖，指标不会显示在 Facebook Insights 中。

如果洞察未显示在 Facebook 指标中，Facebook 是否可以根据页面 URL/开发者应用 ID 为开发者应用流发布、喜欢和评论的数量提供流发布数据？例如，如果我提供了用于此游戏的开发者应用程序 ID，如果这些指标未记录在 Insights 中，我们还能提取这些指标吗？

# c# - C# Winforms APP-同步两个轨迹栏

> ID：12573449
> 
> 赞同：1
> 
> 时间：2012-09-24T21:52:35.433
> 
> 标签：c#, winforms

我有两个做同样事情的轨迹条，除了一个用于左侧执行器，一个用于右侧执行器。我想在我的 GUI 中添加同步轨迹栏的选项，以便用户可以选择以相同的方式控制两个执行器。现在，问题是轨迹栏会在我第一次尝试时同步，但随后两个手柄都冻结了。这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO.Ports;

namespace GUI1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            this.slider1.Minimum = 0;
            this.slider1.Maximum = 9;
            this.slider2.Minimum = 0;
            this.slider2.Maximum = 9;

        }
        //ends public form1

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        //starts first slider
        private void slider1_Scroll(object sender, EventArgs e)
        {
            System.Windows.Forms.TrackBar slider1;
            slider1 = (System.Windows.Forms.TrackBar)sender;
            textBox1.Text = "" + slider1.Value.ToString();
            if (syncOption.Checked == true)
            {
                slider1.Value = Convert.ToInt32(slider2.Value);
                textBox1.Text = slider1.Value.ToString();
            }

        }//ends first slider

        //starts second slider
        private void slider2_Scroll(object sender, EventArgs e)
        {
            System.Windows.Forms.TrackBar slider2;
            slider2 = (System.Windows.Forms.TrackBar)sender;
            textBox2.Text = "" + slider2.Value.ToString();
            if (syncOption.Checked == true)
            {
                slider2.Value = Convert.ToInt32(slider1.Value);
                textBox2.Text = slider2.Value.ToString();
            }

        }//ends second slider

    }

} 
```

我感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:03:28.613

您的问题很简单，当您移动slider1 时，您将其值设置为代码中slider2 的值；相反，您应该移动slider1，**然后**设置slider2的值；

```
 private void slider1_Scroll(object sender, EventArgs e) 
    { 
        System.Windows.Forms.TrackBar slider1; 
        slider1 = (System.Windows.Forms.TrackBar)sender; 
        textBox1.Text = "" + slider1.Value.ToString(); 
        if (syncOption.Checked == true) 
        { 
            slider2.Value = Convert.ToInt32(slider1.Value); 
            textBox2.Text = slider2.Value.ToString(); 
        } 

    }// 
```

Slider2 相同：

```
 private void slider2_Scroll(object sender, EventArgs e)    
    {    
        System.Windows.Forms.TrackBar slider2;    
        slider2 = (System.Windows.Forms.TrackBar)sender;    
        textBox2.Text = "" + slider2.Value.ToString();    
        if (syncOption.Checked == true)    
        {    
            slider1.Value = Convert.ToInt32(slider2.Value);    
            textBox1.Text = slider1.Value.ToString();    
        }    

    } 
```

你只是把你的同步逻辑弄错了！

使用 Winforms、VS2010 测试。

**编辑：**

请注意，您实际上可以为两个滑块使用单个事件处理程序，例如：

```
 private void Slider_Scroll(object sender, EventArgs e)
    {
        TrackBar sourceSlider;
        TextBox sourceText;
        TrackBar targetSlider;
        TextBox targetText;

        sourceSlider = sender == trackBar1 ? trackBar1 : trackBar2;
        targetSlider = sender == trackBar1 ? trackBar2 : trackBar1;
        sourceText = sender == trackBar1 ? textBox1 : textBox2;
        targetText = sender == trackBar1 ? textBox2 : textBox1;

        sourceText.Text = Convert.ToString(sourceSlider.Value);

        if (syncOption.Checked)
        {
            targetSlider.Value = sourceSlider.Value;
            targetText.Text = Convert.ToString(targetSlider.Value);

        }

    } 
```

您可以在设计器中或在代码（在构造函数或 Load 事件中）中连接它，例如：

```
trackBar1.Scroll += Slider_Scroll;
trackBar2.Scroll += Slider_Scroll; 
```

# c# - ASP.NET - 母版页禁用验证器错误消息

> ID：12573450
> 
> 赞同：0
> 
> 时间：2012-09-24T21:52:35.347
> 
> 标签：c#, asp.net, master-pages, validation

好的 简单：TextBox、RequiredFieldValidator、没有母版页的按钮 - 如果 TextBox 为空 - 单击按钮时会收到错误消息。使用母版页 - 如果 TextBox 为空 - 单击按钮时我不会收到错误消息。

这发生在最近没有更改代码。简单地创建一个默认母版页并将这三个控件放入其中将导致没有错误消息。

我不知道如何解决这个问题。似乎与代码无关，因为默认母版页会阻止错误消息显示。

我应该重新安装 Visual Studio 2010 Ultimate 吗？独立于浏览器，最近，与代码无关的 AFAIK，最近才开始发生。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">
                <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:RequiredFieldValidator
            ID="RequiredFieldValidator1" runat="server" ErrorMessage="RequiredFieldValidator" ControlToValidate="TextBox1"></asp:RequiredFieldValidator>
        <asp:Button ID="Button1"
            runat="server" Text="Button" onclick="Button1_Click" 
            ValidationGroup="RequiredFieldValidator1" />
        </asp:ContentPlaceHolder>
    </div>
    </form>
</body> 
```

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class MasterPage : System.Web.UI.MasterPage
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T03:32:30.230

我认为您遇到了问题，因为您为按钮设置了验证组，但是，它没有为 TextBox 和 Validator 控件本身设置。

尝试为参与验证方案的所有控件分配相同的 ValidationGroup。看来你误用了

```
ValidationGroup="RequiredFieldValidator1" 
```

财产。您不必将 RequiredFieldValidator 的 Id 用作按钮的 ValidationGroup（可以，但不必这样做）。请参阅以下文章了解更多详细信息：

[http://msdn.microsoft.com/en-us/library/ms227424%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms227424%28v=vs.100%29.aspx)

无论如何，

> 验证组

属于您的验证方案的所有控件的属性必须相同。在您的情况下，这是 TextBox、Button 和 Validator 控件。

# java - android中的android os networkonmainthread异常错误

> ID：12573452
> 
> 赞同：1
> 
> 时间：2012-09-24T21:52:40.240
> 
> 标签：java, android

我在尝试从 url 中提取 json 数据时收到错误“android.os.networkonmainthreadexception”。有人会告诉我为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:00:42.413

这是由于 StrictMode.ThreadPolicy。它是从 API 级别 9 开始引入的，并且从 API 级别 11 开始更改了默认线程策略，简而言之，不允许在 UI 线程上执行网络操作（例如：HttpClient 和 HttpUrlConnection）。如果你这样做，你会得到 NetworkOnMainThreadException。

解决此问题的推荐方法是使用**AsyncTask**，这样网络请求就不会阻塞 UI 线程。

您可以通过将以下代码添加到主要活动的 onCreate() 方法中来覆盖此线程策略。

```
if (android.os.Build.VERSION.SDK_INT > 9) {
    StrictMode.ThreadPolicy policy = 
        new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
} 
```

# jquery - mediaelement.js：让视频在 Firefox 中运行

> ID：12573453
> 
> 赞同：0
> 
> 时间：2012-09-24T21:52:50.820
> 
> 标签：jquery, html, expressionengine, mediaelement.js

这似乎是一个常见问题，但我没有找到任何标记答案的问题，所以我想我会创建一个以希望找到解决方案的问题。

我的视频在 Chrome 和 Safari 中运行良好，但在 Firefox 中它根本不显示。如果有帮助的话，我的 CMS 是 ExpressionEngine。这个事情谁有经验？

页面上视频的插入代码：

```
<video width="640" height="360" preload="none" controls="controls" poster="http://site.com/img.jpeg" id="player1" type="video/mp4" src="http://site.com/content/videos/videotest(360p_H.264-AAC).mp4" tabindex="0"></video> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T03:08:40.373

出于测试目的，将您的视频标签替换为这些视频（来自 mediaelement 的网站）

```
<video id="player1" width="540" height="303" controls="controls" preload="none">
    <source src="
http://mediaelementjs.com/media/echo-hereweare.mp4" type="video/mp4" />
    <source src="
http://mediaelementjs.com/media/echo-hereweare.webm" type="video/webm" />
    <source src="
http://mediaelementjs.com/media/echo-hereweare.ogv" type="video/ogg" />
</video> 
```

如果上述代码在 FF 中有效，则问题与 FF 的视频压缩有关。和你一样，我在使用 mediaelement.js 时遇到了一些问题，但事实证明是我的视频压缩得不好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T08:23:47.693

要检查的另一件事是您的服务器上设置了正确的 MIME 类型。

您可以将这些添加到 .htaccess 文件中，

```
AddType video/ogg .ogv
AddType video/mp4 .mp4
AddType video/webm .webm 
```

有关更多信息，请参阅[http://mediaelementjs.com/#installation](http://mediaelementjs.com/#installation)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T15:16:10.707

我的问题是使用 MIRO 转换器从 mp4 转换错误。如果我使用“其他 -> mp4”，它就不起作用。如果我使用“Apple -> iPad”，我得到了正确的 mp4 文件并且它运行了！

# r - 从合并中返回不匹配的记录

> ID：12573456
> 
> 赞同：2
> 
> 时间：2012-09-24T21:52:56.633
> 
> 标签：r, merge

我正在合并两个数据框，一个主数据集和一个查找表，基于多个因素（关键）变量，我想快速查看主数据中这些关键变量的哪些组合没有在查找表中匹配。合并功能中是否有允许我这样做的选项？目前我能想到的最好的方法是使用 all.x=T 选项，然后查看我合并的其中一个变量为 NA 的行。肯定有更好的方法...

这是我的代码，值得：

```
a.lighting.all.2 <- merge(a.lighting.all.2, a.lookup.by.meas.2,
                          by = c("measure.category", "measure.subcategory",
                                 "measure", "fund.category")) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:44:44.350

据我所见，合并没有这个选项，但是通过 NA 进行子集化非常快速和容易。

```
df      <- data.frame(cat=c("a","a","b","b"),num=(1:4))
df2     <- data.frame(cat=c("a","a","b","c"),num=(1:4))
mergedf <- merge(df,df2,by="cat",all=TRUE)
mergedf
mergedf [rowSums(is.na(mergedf))>0 ,] # not if you have NAs already before merge 
```

你也可以这样做：

```
df2 [ !df2$cat %in% df$cat ,] 
```

对于未合并的特定行：

```
df$ID   <- 1:length(df[,1])
df2$ID  <- (length(df[,1])+1):(length(df[,1])+length(df2[,1]))
mergedf <- merge(df,df2,by="cat", all=FALSE)

df2 [!df2$ID %in% mergedf$ID.y ,] 
```

举一个数据示例，也许有人可以提供更好的帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-22T14:43:35.643

数据表版本：

```
library(data.table)
df1      <- data.table(cat=c("a","a","b","b"),num=(1:4))
   cat num
1:   a   1
2:   a   2
3:   b   3
4:   b   4

df2     <- data.table(cat=c("a","a","b","c"),num=(1:4))
   cat num
1:   a   1
2:   a   2
3:   b   3
4:   c   4

df1[!df2, on=.(cat,num)]
   cat num
1:   b   4

df2[!df1, on=.(cat,num)]
   cat num
1:   c   4 
```

或者，设置键，然后删除括号中的 on。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T00:52:09.067

这是一个用于区分具有相同标题的两个 data.frame 的函数：

```
df.diff <- function(df1, df2) {
   is.dup <- duplicated(rbind(df2, df1))
   is.dup <- tail(is.dup, nrow(df1))
   df1[!is.dup, ]
} 
```

所以你可以运行：

```
df.diff(main[by.cols], lookup[by.cols]) 
```

# set - Guava 的 ImmutableSet.contains 的性能

> ID：12573463
> 
> 赞同：15
> 
> 时间：2012-09-24T21:53:17.180
> 
> 标签：set, guava, immutability, caliper

Guava`ImmutableSet`在我关于`contains`. 对于某些尺寸，它甚至比`List`：

```
 size            benchmark         ns linear runtime
100000         ListContains  110279.54 ==
100000          SetContains       7.15 =
100000 ImmutableSetContains   76716.47 =
200000         ListContains  275367.66 =====
200000          SetContains       7.34 =
200000 ImmutableSetContains  322185.50 ======
500000         ListContains  935210.10 ====================
500000          SetContains       7.79 =
500000 ImmutableSetContains 1382765.76 ============================== 
```

基本上，我用几千个负整数填充一个集合，并用非负整数测试包含。代码很简单，但是对于粘贴在一个小的文本区域来说有点太长了，所以请看[这里](https://dl.dropbox.com/u/4971686/published/maaartin/guava/ImmutableSetBenchmark.java)。

我想知道这里发生了什么。可能，我遇到了一些退化的情况，尽管我显然没有尝试这样做。或者，也许我刚刚打破了基准。否则，我想知道它是否可以并且应该被修复。

* * *

[解决方案是通过替换](https://code.google.com/p/guava-libraries/source/detail?r=69ad96b719d7cd3d872a948d7454f17b816a21c2)来改变拖尾功能

```
hashCode ^= (hashCode >>> 20) ^ (hashCode >>> 12);
return hashCode ^ (hashCode >>> 7) ^ (hashCode >>> 4); 
```

经过

```
return C2 * Integer.rotateLeft(hashCode * C1, 15); 
```

这需要大约相同的时间并且可能有一些缺点，但通过很好地散布散列解决了当前的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-25T18:14:18.780

解释其实很简单。想象一下整数位于`M = {0, 1, ..., N-1}`一些 的集合中`N`，这是 2 的幂。哈希也是如此，因为它是如何`Integer.hashCode`定义的。哈希通过与[此](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/HashMap.java#HashMap.hash%28int%29)`smear`相同的函数进行处理，以便在某些常见情况下最小化最低位的冲突。

`2*N`分配了一个大小的表，并将其成员`M`放入其中。由于`smear`只涉及右移，它映射`M`到自身，这意味着表格的连续范围被填充。因此，假设表左半部分中的所有插槽都已使用，而另一半未使用。

当`contains(o)`被调用时，搜索从位置由 确定的位置开始`o.hashCode()`。如果`o`找到，结果是`true`，如果空槽被命中，结果是`false`。否则，搜索继续到另一个槽。为了最大限度地减少缓存未命中，使用了[线性探测](http://en.wikipedia.org/wiki/Linear_probing)。

当我们很不幸地从第一个使用的槽开始搜索时，它们都必须被遍历，这意味着`N`步骤。从随机位置开始意味着`N/4`平均步数。

在我的基准测试中发生的事情与上面不完全一样，但其表现不佳的原因是相同的。将大小设为 2 的幂会使问题变得更糟。

# jquery - IE8 中的 $.each 似乎被计算了太多次

> ID：12573470
> 
> 赞同：0
> 
> 时间：2012-09-24T21:53:39.537
> 
> 标签：jquery, internet-explorer-8, each

使用 $.each ...

```
 $.each(this.validationRules, function(){
        if ( !self.validateField($('#' + this.fieldID), silent) ) ... 
```

在调用最后一个元素后给我一个未定义的错误..但仅在 IE8 中。

有没有人可以解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T21:57:08.787

确保数组声明中没有多余的逗号，不会在最后一个元素处给出错误。

即，如果数组如下所示，您通常会在 IE 中遇到问题

```
validationRules = ["", "",]; 
```

或者

```
validationRules = {"key1" : "v", "key2": "v", } 
```

*注意结尾的逗号*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-24T21:58:14.460

IE8常见错误：

```
var array = [1,2,3,4,]; 
```

或者

```
var object = { a:1, b:2, c:3, }; 
```

# android - 将数据从片段传递到活动

> ID：12573477
> 
> 赞同：1
> 
> 时间：2012-09-24T21:54:29.360
> 
> 标签：android

我有一个包含片段的活动。单击操作栏时，它应该从第一个活动中创建一个带有 sting[] 的新片段。

当我从 Activity 启动数据时，我使用 setArguments() 和一个包将数据传递给新片段。问题是，我无法将 String[] 从第一个 Fragment 传递给 Activity 分别访问它。我尝试使用返回字符串 [] 的方法来执行此操作。并在 Activity 中访问它：

FirstFragment ff = 新的 FirstFragment(); ff.getstring();

但它是空的（空）

那么还有其他/更好的可能性吗？

谢谢

**编辑：**

Activity 包含 firstFragment actionbarButton（在活动中）启动 newFragment（替换 firstFragment）并且 String[] 被传递给 Activity，然后使用 setArguments 传递给 newFragment

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:59:24.263

在您的片段中，您可以使用以下方式访问其父活动：

```
FirstActivity fActivity= (FirstActivity)getActivity();
String[] data = fActivity.getMyArray(); 
```

现在你有了数据，你可以将它们传递给新的`Activity\Fragment`

# winforms - windows 窗体 - 调用 Control.Invoke 给出错误提示控件尚未加载

> ID：12573478
> 
> 赞同：0
> 
> 时间：2012-09-24T21:54:42.983
> 
> 标签：winforms, multithreading, events, controls

> **可能重复：**
> [如何在窗体的关闭事件中停止 BackgroundWorker？](https://stackoverflow.com/questions/1731384/how-to-stop-backgroundworker-on-forms-closing-event)

我在 Windows 窗体中有一些代码，有点像这样：

```
button1_Click(object sender, EventArgs e)
{
  Widget myWidget = new Widget(...bunch of constructor parameters...);
  myWidget.Property1 = "blah"; // other properties get set here too...
  myWidget.InterestingThingHappened += InterestingThingHappened;

  Parallel.Invoke(myWidget.RunInterestingLongRunningProcess());
}

private void InterestingThingHappened(object sender, EventArgs e)
{
  myLabel.Invoke(new Action(() => myLabel.Text = "An interesting thing happened!"))
} 
```

当我运行它时，应用程序会冻结，直到我在任务管理器中将其杀死。然后我看到一个异常说“在创建窗口句柄之前不能在控件上调用 Invoke 或 BeginInvoke。” `button1_Click`显然是一个控制事件处理程序，因此在此代码运行之前完全创建了表单。我完全不知道这意味着什么。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:21:31.073

使用`BeginInvoke()`而不是`Invoke()`完全解决问题。UI 实时更新。为什么？谁知道？

# android - 如果 View 不能共享，那么 View Id 应该如何分配？

> ID：12573479
> 
> 赞同：-5
> 
> 时间：2012-09-24T21:54:49.627
> 
> 标签：android, android-layout

仅供参考 Android 中的视图不能共享，这是一个值得商榷的 sdk 设计决定，但事实就是如此。每个视图最多可以有一个父视图。然而，为了将布局用作视图模板，可以重复使用通用的 view_layout.xml 文件（即多次膨胀）。viewid 和视图中元素的 id 有什么影响，例如按钮。

*   这些不应该在 view_layout.xml 中定义吗？（例如，尽管在不同的视图实例中，但没有两个按钮具有相同的 id）。
*   视图本身的实例 ID 呢？
*   给定常见的 view_layout.xml 文件，如何对这些视图进行唯一定义？
*   当然，您可以对膨胀的视图有单独的引用，但是视图本身的 id 和其中的小部件呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:11:39.953

我不确定您*究竟*想在这里解决什么问题，但是如果您正确设计布局，布局中的视图永远不会发生冲突。View Id 仅适用于直接父 ViewGroup。假设您有 ViewGroup **A**，它是您的顶级 ViewGroup。**然后膨胀 ViewGroup B**的两个实例，然后添加到**A**，它们各自的 Id 不会发生冲突，因为它们没有相互引用。它们的作用域完全不同。

# parsing - Smalltalk 解析器

> ID：12573480
> 
> 赞同：0
> 
> 时间：2012-09-24T21:54:57.457
> 
> 标签：parsing, smalltalk

我是 SmallTalk 的新手，我正在使用 VisualWorks。我需要解析一个字符串并将每个字符插入一个不包括空格和所有标点符号的数组中。这不是家庭作业，而是一个大项目的一部分，我似乎无法弄清楚。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T09:09:01.783

对于更大的任务/更复杂的问题，请查看 PetitParser 和/或 SmaCC（都在公共商店中）。PetitParser 文档位于 Lukas Renggli 的网站上。

您可能会遇到的一些问题：

*   你确定你需要一个数组，而不是一个字符串吗？
*   您拥有和需要什么编码：8 位字符（哪个代码页）/UTF-8/UTF-16？
*   如果你需要做很多，有更好的算法，例如使用表查找。随着被拒绝字符数的增加，接受的答案会变慢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T14:45:17.363

可以这么简单（我用的是 VSE，但 VW 应该不会有太大的不同）：

```
toThrowAway := #($  $. $, $: $; $! $?). "this contains all the characters that you want to throw away. Simply add anything else you don't want in the result"
(anArray := unparsed reject:[:c| toThrowAway includes: c]) asArray. 
```

编辑（在您发表评论后）：

正如我所写，我没有使用 Visual Works，也许它只是 asString 的不同实现。当您检查生成的数组或将其显示在工作区时，您会看到这种情况吗？结果数组的大小是多少？无论如何，您可以以更明确的方式尝试它：

```
toThrowAway := #($  $. $, $: $; $! $?). "this contains all the characters that you want to throw away. Simply add anything else you don't want in the result"
parsedString := unparsed reject:[:c| toThrowAway includes: c]).
anArray := Array new: parsedString size.
1 to: parsedString size do: [:i| anArray at: i put: (parsedString at:i)]. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-12T19:06:35.813

解析通常使用 Streams 来获取输入。从您的字符串中创建一个流并使用枚举

```
[stream atEnd] whileFalse: [
   char := stream next.
   ...
]. 
```

通过这种方式，您可以对大型输入集（例如从文件或套接字）进行操作，并保持您的内存消耗固定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-20T07:24:32.643

不考虑编码的因素，这里是一个简单的代码段。关键是您使用 OrderedCollection 收集所有字母字符，然后将其转换为数组（或您需要的其他集合）。

```
|aString aCol|
aString := 'abc def  $%^    g()h!'.
aCol := OrderedCollection new.
aString do:[:c|
    c isAlphabetic ifTrue:[
        aCol add:c
    ]

].
^aCol asArray 
```

# c# - 如何检查远程驱动器的可用驱动器空间？

> ID：12573483
> 
> 赞同：0
> 
> 时间：2012-09-24T21:55:11.257
> 
> 标签：c#, remote-server, driveinfo

> **可能重复：**
> [如何在 C# 中检测从一台服务器到另一台服务器的可用空间和磁盘信息](https://stackoverflow.com/questions/5337958/how-to-detect-freespace-and-disk-information-from-one-server-to-other-in-c-sharp)

应用程序正在服务器 Y 上运行。

我有这个：

```
DriveInfo di = new DriveInfo(@"C\"); 
```

其中检查服务器 Y 的 C 驱动器很好。

如果我想检查服务器 X 的 D 盘怎么办？

# html - 可点击区域没有与 div 的显示对齐？

> ID：12573487
> 
> 赞同：0
> 
> 时间：2012-09-24T21:55:24.417
> 
> 标签：html, css, webkit, mobile-safari, android-browser

我正在尝试制作无需使用闪光灯即可点击的动画精灵。单击（或触摸）时，它们应显示一个弹出气泡。当再次单击屏幕时（任何地方，无论是在图标上、气泡上还是在两者之外），它都应该关闭。问题是可点击区域不与其精灵对齐。

这是网页（它只出现在使用 Webkit 的浏览器上，例如 Safari、Chrome 或 iOS 或 Android 的默认浏览器。）

[https://dl.dropbox.com/u/60354330/site/index.html](https://dl.dropbox.com/u/60354330/site/index.html)

这些管道中的每一个的可点击区域都是与精灵大小相同的区域，但以蒸汽流出一侧的外边缘的角为中心。

我已经在 Safari 6 (Mac)、iOS 6、Android 4.0 的浏览器和 Chrome（Windows 7 上的版本 21？）上对此进行了测试，并且所有这些浏览器的行为都是相同的。

关于它为什么不对齐或如何修复它的任何建议？

所有相关代码都在 index.html 中。以下是我认为相关的摘录：

```
<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>CSS sprite demo</title>

        <style type="text/css">
            .spipe {
                position: absolute;

                width: 1px;
                height: 1px;

                background: url(spipe.png) no-repeat 0 0;
                background-size: 1px 20px;

                -webkit-animation-name: spipe;
                -webkit-animation-duration: 1.0s;
                -webkit-animation-iteration-count: infinite;
                -webkit-animation-timing-function: linear;
                -webkit-transform-origin: top left;
            }

            .left {
                -webkit-transform: scale(100, 60);
            }
        </style>
    </head>
    <body>
        <div id="toppipe" class="popup spipe left" style="top:120px;left:200px;" popupHTML="Hello, Top"></div>
    </body>
</html> 
```

它会按比例缩小和备份，否则它会从一个帧滚动到另一个帧。

似乎问题在于可点击区域从与 div 的其余部分不同的原点放大，但如果我将变换原点更改为其他东西，比如 50% 50%，它仍然会偏移相同的数量。翻译 div 以相同的方式应用于可点击区域和 div，因此也不能用于解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T19:26:53.327

这并不像我想要的那样整洁，但是我发现我可以通过添加一些 jQuery 代码来实现我想要的结果，如下所示：

```
$(function() {
    $(".target").each(function(index) {
        var original = $(this);
        var clone = original.clone();
        clone.insertAfter(original);
        original.removeAttr("id"); /* Ensure each id is only used once. */
        original.css("width","1px");
        original.css("height","1px");
        clone.attr("class","popup");
    });
}); 
```

现在，对于我使用类目标制作的每个 div，就好像我正在创建两个 div。第一个 div 将包含 webkit CSS3 动画，而第二个 div 将透明地放置在它上面并响应点击。

朦胧？也许。但这使得任何想要编辑我的页面的人只需要查看 HTML 文件，而根本不需要接触 CSS 或脚本（这正是我想要的。）

编辑：我发现了一个小问题，即图像放错位置的 div 有时会阻止对可点击 div 的点击。通过添加“pointer-events:none;”解决了这个问题。到我的 CSS。

# qt - 当我展开主窗口时，为什么我的中央 QGLWidget 不会增长？

> ID：12573489
> 
> 赞同：2
> 
> 时间：2012-09-24T21:56:09.547
> 
> 标签：qt, qt4, qglwidget, minimum-size

我有一个带有 QGridLayout 的 QMainWindow，其中第一行是工具栏（跨所有列），第二行在左侧（第一列）有一个文本显示区域，在右侧（第二列）有一个 QGLWidget。[附加说明......不确定是否相关：为了让所有内容都按照我想要的方式排列，我不得不在其中的大多数上使用 setMinimumSize。]

无论如何，当我最大化或以其他方式尝试使主窗口更大时，QGLWidget 会变宽一点，但不会垂直增长。我怎样才能强迫它与窗口一起成长呢？这可能与小部件本身或网格布局有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:46:36.723

我一直在寻找试图找出 QGLWidget 和调整大小政策的交易。与其他小部件相比，它的行为似乎不正确。您可以通过实现 QSize minimumSizeHint() const; 来更接近它。和 QSize sizeHint() 常量；在您的 QGLWidget 中使用类，并在其上执行 QWidget::setSizePolicy。至于让它与其他小部件的行为相同，我真的很想找到答案..

# c# - 锁定属性

> ID：12573490
> 
> 赞同：1
> 
> 时间：2012-09-24T21:56:10.297
> 
> 标签：c#, .net, multithreading, concurrency, clr

我想知道在属性中正确使用锁。我正在编写一个多线程服务器应用程序，其中吞吐量非常重要。如果我有这样声明的属性：

```
 private DataPoint a;
    private object aLock = new object(); 
```

最保守的锁似乎如下（称之为方法1）。但是，在这种情况下，在初始调用之后的每次调用中，都会产生锁开销：

```
 public DataPoint A
    {
        get
        {
            lock (aLock)
            {
                if (a == null)
                {
                    a = new DataPoint();
                }

                return a;
            }
        }
    } 
```

或者，我应该将锁移动到设置“a”的行（称为方法 2）。在这种情况下，“a”可能会被设置多次（这没关系），但是一旦设置，就没有锁的开销。

```
 public DataPoint A
    {
        get
        {
            if (a == null)
            {
                lock(aLock)
                {
                    a = new DataPoint();
                }
            }

            return a;
        }
    } 
```

锁定对属性的并发访问的推荐方法是什么？是方法1，方法2还是以上都不是？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T22:14:07.103

在 .NET 4 中，您拥有`System.Lazy<T>`为您处理这些问题的类型：

```
class MyClass
{
    private readonly Lazy<DataPoint> lazy =
        new Lazy<Singleton>(() => new DataPoint());

    public DataPoint Instance { get { return lazy.Value; } }
} 
```

由[乔恩斯基特提供](http://csharpindepth.com/Articles/General/Singleton.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:06:57.333

在您的锁定示例中，您这样做是为了初始化一个值。假设 null 条件意味着需要初始化该值，您应该在获取锁之前*和之后检查它：*

```
if(a == null)
{
  lock(aLock)
  {
    if(a == null)
      a = new DataPoint();
  }
} 
```

这样做的原因是，当一个线程正在等待锁时，一旦它获得锁，它所要做的工作就有可能已经由另一个线程完成了。所以当线程获得锁时，它应该检查是否还需要完成工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T22:07:38.943

您应该在锁定之前检查 null 。如果为空，则锁定，并再次检查是否为空。如果它仍然为空，请启动您的 DataPoint 并首先将其分配给一个临时变量。完成后，将其分配给您的成员并返回。

```
private DataPoint _dataPoint;

public DataPoint A
{
    get
    {
        if(_dataPoint != null)
            return _dataPoint;

        lock (aLock)
        {
            if (_dataPoint == null)
            {
                var dataPoint = new DataPoint();
                // do more stuff with dataPoint
                _dataPoint = dataPoint;
            }

            return _dataPoint;
        }
    }
} 
```

# google-apps-script - 在库中使用 UiApp 和 SpreadSheetApp 的 webApp

> ID：12573494
> 
> 赞同：0
> 
> 时间：2012-09-24T21:56:58.260
> 
> 标签：google-apps-script

我有一个包含 webApp 的库（将 UiApp 与 doGet 一起使用），旨在处理来自该库的每个用户的特定电子表格。

该图书馆的用户如何将他自己的电子表格的 ID 传递给图书馆？

谢谢

关于库 (myLib) 上的当前代码的注释

```
var mainDoc = SpreadsheetApp.openById("abc123"); // should be user's spreadsheet Id 
function mainUiApp() {   
  // something here using handler1 below 
  return app; 
}
function handler1() {
  // using mainDoc spreadsheet 
} 
```

关于当前代码的注释，关于 myLib 的用户

```
var mainDocClient = SpreadsheetApp.openById("xyz789");
function doGet() {
  return myLib.mainUiApp();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T08:54:44.203

您可以将电子表格 ID 作为`mainUiApp`函数的参数传递。这是一个例子

`myLib`代码是

```
var mainDoc = null;

function mainUiApp(ssID) {   
  mainDoc = SpreadsheetApp.openById(ssID);
  // ...
  return app; 
} 
```

用户代码是

```
function doGet() {
  return myLib.mainUiApp("xyz789");
} 
```

# javascript - 如何在向下滚动后淡入 DIV，然后在底部淡出

> ID：12573495
> 
> 赞同：1
> 
> 时间：2012-09-24T21:57:00.203
> 
> 标签：javascript, scroll, fadein, fadeout

我有一个 div，我想在用户向下滚动 600px 页面后淡入。我已经使用下面的代码很容易地实现了这一点：

```
<script>
$(window).scroll(function(){
if($(window).scrollTop()>600){
$("#fade-in-area").fadeIn();
}else{
$("#fade-in-area").fadeOut();
}
});
</script> 
```

我希望同一个 div 从页面底部淡出大约 600 像素。我见过其他几个人试图这样做，但不知道如何让它同时淡入和淡出。

对于我认为的普通 Javascript 程序员来说，这应该很容易。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:09:22.670

试试这个代码：

```
<script>
   $(window).scroll(function(){
       var leftToBottom = $(document).height() - $(window).height() - $(window).scrollTop();
       var distanceFromTop = $(window).scrollTop();
       if( distanceFromTop > 600 && !$("#fade-in-area").is(":visible") 
          && leftToBottom > 600) {
            $("#fade-in-area").fadeIn();
       }else if($("#fade-in-area").is(":visible") && (distanceFromTop < 600 || leftToBottom < 600)){
            $("#fade-in-area").fadeOut();
      }
   });
</script> 
```

如果滚动底部的距离小于 600 像素，它应该淡出一个 div。

# ubuntu - ubuntu 上的 php.ini 在哪里

> ID：12573502
> 
> 赞同：25
> 
> 时间：2012-09-24T21:57:37.570
> 
> 标签：ubuntu, php

我不是指我发现的 etc/php5/apache 或 cli 中的那个。

我将它们都重命名为 .old 并加载了 php_info() 虽然加载的配置文件说（无）我仍然不知道正在使用的 php.ini 的位置 - 试图将 upload_max_filesize 从 2M 更改为 5M 但是无论我找到并更改了哪个 php.ini（是的，我还重新启动了 apache2），但它仍然显示 2M

# css - 如何将 SVG 嵌入到单个 hta/htm 文档中？

> ID：12573504
> 
> 赞同：1
> 
> 时间：2012-09-24T21:57:40.593
> 
> 标签：css, svg, embed, hta

我的最终目标是使用 svg 图像作为 css 背景，如下所示：

```
#somelement {
  background: transparent url(#embededSvg) repeat-x;
} 
```

我需要（想要*）两件事才能工作，1\. svg 嵌入到文档中（但不是像块一样呈现）女巫我可以实现：

```
 Skip<svg ... style="display:none;">...</svg> 
```

1.  svg 在其 x 轴上循环作为 css 背景（不使用 hta/htm 文档打包多余的文件）。

我尝试将 svg 创建为 Javascript Image 对象并将对象 innerHtml 设置为 svg，但我不确定如何在 css 中引用 Image 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:16:34.047

您有正确的想法，您将链接 SVG，就像链接图像文件一样：

```
<style>
  #somelement {background: transparent url('someimage.svg') repeat-x;}
</style> 
```

甚至像这样：

```
<style>
  #somelement {background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D') repeat-x;}
</style> 
```

并非所有浏览器都支持 CSS 背景中的 SVG。浏览器对此的支持如下所示：

[http://caniuse.com/#feat=svg-css](http://caniuse.com/#feat=svg-css)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-13T02:02:44.930

**SVG 可以通过 6 种方式添加到页面中，**

它们是：

### **1) 对象标签**

### **3) 框架**

### **4) 内联 SVG**

### **5) IMG 标签**

## **6）** CSS

看到这个：[https ://www.sitepoint.com/add-svg-to-web-page/](https://www.sitepoint.com/add-svg-to-web-page/)

### 带背景重复的 SVG

看到这个：-[为什么 background-repeat: no-repeat 不适用于 Opera 12 中的 .svg 图像？](https://stackoverflow.com/questions/20819153/why-background-repeat-no-repeat-doesnt-work-with-svg-images-in-opera-12)

会是这样
`{background:url('image.svg ') repeat-x;}`

# android - 在Android中按键解析输入法？

> ID：12573511
> 
> 赞同：0
> 
> 时间：2012-09-24T21:58:21.903
> 
> 标签：android, input, textview, android-edittext, ime

所以听说按键事件是多余的，输入法一般不会触发。但是我刚刚开始开发一个类似终端的应用程序，我想逐个解析输入键，而不是在单击“完成”/“输入”之后（例如，用于检测何时插入硬换行符，就像在命令行中）。我使用 EditText 但从 TextView 追加和删除也是一种选择（我更喜欢，较少与样式和输入类型的组合）。

所以实际的问题是：如何逐键听输入法输入？甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:02:46.293

```
editText.setOnKeyListener(new OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {

    }
}); 
```

或者

```
editText.addTextChangedListener(new TextWatcher() {
            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {

            }

            @Override
            public void afterTextChanged(Editable s) {

            }
        }); 
```

# java - 从给定的日期范围列表中查找所有重叠的日期范围

> ID：12573512
> 
> 赞同：8
> 
> 时间：2012-09-24T21:58:40.250
> 
> 标签：java, date

我有一个 BookingDateRange 列表，其中 BookingDateRange 是：

```
 public class BookingDateRange {
        private Date fromDate;
        private Date toDate;

        //getters & setters of properties
   } 
```

**要求：**

1.  我需要查找 BookingDate 列表中是否有任何日期重叠，例如 dateRangeList
2.  如果是，请找到所有重叠的日期范围对，比如字符串列表，比如重叠日期对

**示例 1**：

输入1：

dateRangeList[0] = 2012 年 12 月 23 日- 2012 年 12 月 27 日

dateRangeList[1] = 2012 年 12 月 14 日 - 2012 年 12 月 25 日

dateRangeList[2] = 2012 年 1 月 1 日 - 2012 年 1 月 23 日

输出1：

isOverlappingDates = true

重叠日期对 = [0_1]

**示例 2：**

输入2：

dateRangeList[0] = 2012 年 12 月 23 日- 2012 年 12 月 27 日

dateRangeList[1] = 2012 年 1 月 1 日 - 2012 年 1 月 23 日

输出2：

isOverlappingDates = false

重叠日期对 = []

**我的解决方案：**

```
/**
 * Checks if any of the dates overlap.
 *
 * @param dateRangeList the date range list
 * @param overlappingDatePairs the overlapping date pairs where overlappingDatePair is stored in the format dateRange1_dateRange2
 * @return true, if any of the dates overlap.
 */

public static boolean isOverlappingDates(
            List<BookingDateRange> dateRangeList,
            List<String> overlappingDatePairs) {

    boolean isOverlap = false;

    for (int index1 = 0; index1 < dateRangeList.size(); index1++) {
        for (int index2 = index1 + 1; index2 < dateRangeList.size(); index2++) {

            // Overlap exists if (StartA <= EndB) and (EndA >= StartB)

            Date startA = dateRangeList.get(index1).getFromDate();
            Date endA = dateRangeList.get(index1).getToDate();
            Date startB = dateRangeList.get(index2).getFromDate();
            Date endB = dateRangeList.get(index2).getToDate();

            boolean isStartABeforeEndB = (startA.compareTo(endB)) < 0;
            boolean isEndAAfterStartB = (endA.compareTo(startB)) > 0;

            boolean isCurrentPairOverlap = false;

            isCurrentPairOverlap = isStartABeforeEndB && isEndAAfterStartB;

            if (isCurrentPairOverlap) {
                overlappingDatePairs.add(index1 + "_" + index2);
                isOverlap = true;
            }
        }

    }
    return isOverlap;

    } 
```

这种方法的复杂度是 O(n ^2)。是否可能有更好的复杂性？无法得出具有更好复杂性的算法。

确实在 SO 遇到了一些解决方案。但没有一个能完全满足要求。

谢谢， 希哈

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:41:00.887

这是 O(nlog(n))，或者显然如果有很多碰撞，它是 O(碰撞次数)。我曾经工作过的一家公司用类似的东西作为面试问题。

```
private static class BookingTuple implements Comparable<BookingTuple> {
    public final Date date;
    public final boolean isStart;
    public final int id;
    public BookingTuple(Date date, boolean isStart, int id) {
        this.date = date;
        this.isStart = isStart;
        this.id = id;
    }

    @Override
    public int compareTo(BookingTuple other) {
        int dateCompare = date.compareTo(other.date);
        if (dateCompare != 0) {
            return dateCompare;
        } else {
            if (!isStart && other.isStart) {
                return -1;
            } else if (isStart && !other.isStart) {
                return 1;
            } else {
                return 0;
            }
        }
    }
}

public static boolean isOverlappingDates(List<BookingDateRange> dateRangeList, List<String> overlappingDatePairs) {
    List<BookingTuple> list = new ArrayList<BookingTuple>();
    for (int i = 0; i < dateRangeList.size(); i++) {
        Date from = dateRangeList.get(i).getFromDate();
        Date to = dateRangeList.get(i).getToDate();
        list.add(new BookingTuple(from, true, i));
        list.add(new BookingTuple(to, false, i));
    }

    Collections.sort(list);

    boolean overlap = false;

    HashSet<Integer> active = new HashSet<Integer>();
    for (BookingTuple tuple : list) {
        if (!tuple.isStart) {
            active.remove(tuple.id);
        } else {
            for (Integer n : active) {
                overlappingDatePairs.add(n + "_" + tuple.id);
                overlap = true;
            }
            active.add(tuple.id);
        }
    }

    return overlap;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:03:58.050

我认为你不能做得更好，因为你必须将每个 BookingDateRange 与其他人进行比较......

所以它需要`O(n) comparisons per element` ，你有`n elements`

所以 `n * n = O(n^2)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:06:07.430

我的解决方案将以复杂性换取内存。它假定日期范围相对有限（您没有混合 5000BC 和 6000AD 的日期）。

1 创建一个`Map<String, List<Range>>`.

2 对于每个范围，选择第一个日期并将其转换为`GregorianCalendar`. 以“yyyy/MM/dd”（或类似）格式获取日期。

2a 如果“yyyy/MM/dd”字符串已经在地图中，则将新范围添加到列表中。

2b 如果不是，则使用包含范围的新列表添加条目。

2c 增加一天的 GregorianCalendar。重复直到到达范围中的最后一个日期。

3 对所有范围重复此操作。

4 列出 Map 的键（如果您使用“yyyy/MM/dd”格式排序是微不足道的）。检查关联列表的大小。

# android - 当我尝试显示 toast 消息时崩溃，但在调试器中没有崩溃

> ID：12573514
> 
> 赞同：0
> 
> 时间：2012-09-24T21:58:57.723
> 
> 标签：android

我的应用程序一直存在很多内存问题。我正在尝试捕获内存异常，然后使用 toast 显示内存不足的消息。

当我使用口味代码运行应用程序时，它会崩溃。当我在调试器中运行它时，不会崩溃，但不会出现任何消​​息。

我试图在 Activty 类的 onCreate 方法内的捕获内存异常中显示消息。

代码块：

```
public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            // set size of card image
            ImageView CardImage = ( ImageView)findViewById(R.id.viewcard);
            int ScreenWidth=getWindowManager().getDefaultDisplay().getWidth();
            int ScreenHeight=getWindowManager().getDefaultDisplay().getHeight();

            // fix for tblets
            if (ScreenHeight<ScreenWidth)
               ScreenWidth=ScreenHeight;

            int CardWidth=ScreenWidth/2;
            CardWidth+=CardWidth/10;

            // set bitmap
        //    Bitmap bmp=BitmapFactory.decodeResource(getResources(), R.drawable.card2);
            String FileName=new String("card");
            FileName+=Integer.toString( CardId+1);
            FileName+=".jpg";

            // put in text that matches card
            TextView mCardText = (TextView)findViewById(R.id.cardtext);
            mCardText.setText( "Card Meaning \n"+ cCardText.mCardMeaning[ CardId]);

            // put in text that matches card
            TextView mHouseText = (TextView)findViewById(R.id.housetext);
            mHouseText.setText( "House Meaning \n"+ cCardText.mHouseMeaning[ HouseId-1]);

        try {
       AssetManager assetManager= getAssets();
       InputStream inputStream;
       inputStream=assetManager.open(FileName);  
       Bitmap icon=BitmapFactory.decodeStream(inputStream);
       CardImage.setImageBitmap(icon);
        } catch( OutOfMemoryError e)
        {
    /////////////////////////////////////////////////////////////////////
    // crashes heare
            Context context = getApplicationContext();
            CharSequence text = "Out of Memory  ";
            int duration = Toast.LENGTH_SHORT;

            Toast toast = Toast.makeText(context, text, duration);
            toast.show();  

            gi++;
              return;
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            return;
        } 

        //scale it
        // note: only code here that pertains to card image, becouse if card image cannot be loaded
        // the above exceptions will go off and we will never get here
        CardImage.getLayoutParams().width=CardWidth;
        CardImage.getLayoutParams().height = (int)( (float) CardWidth *1.7);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:03:57.063

当您处于 OutOfMemory 时，所有的赌注都几乎没有，因为此时 JVM 无法真正分配任何新内存。所以它很可能因为这个原因而崩溃。

您可能想在显示消息之前尝试清除一些指针...但我从未见过有人真正尝试捕获 OutOfMemory 错误。

这篇文章中的第 3 个答案[是否有可能在 java 中捕获内存不足异常？](https://stackoverflow.com/questions/1692230/is-it-possible-to-catch-out-of-memory-exception-in-java)解释了为什么尝试捕获内存不足异常是一个非常糟糕的主意。

# ruby - 如何测试水豚中是否存在提交按钮？

> ID：12573518
> 
> 赞同：17
> 
> 时间：2012-09-24T21:59:17.063
> 
> 标签：ruby, rspec, capybara

我想在 rspec 中测试是否存在提交按钮。我也在使用水豚。

我试过了：

```
should have_tag("input","Submit button") 
```

和

```
should have_content("Submit, button") 
```

但它要么引发异常，要么给出误报。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-17T17:11:03.483

这些都是很好的建议，但是如果你想确认它是一个按钮并且它具有正确的值（用于显示），你必须更详细一点：

```
page.should have_selector("input[type=submit][value='Press Me']") 
```

我不知道现有的匹配器可以做到这一点。这是我编写的自定义 RSpec2 匹配器：

```
RSpec::Matchers.define :have_submit_button do |value|
  match do |actual|
    actual.should have_selector("input[type=submit][value='#{value}']")
  end
end 
```

这是 RSpec3 版本（@zwippie 提供）：

```
RSpec::Matchers.define :have_submit_button do |value|
  match do |actual|
    expect(actual).to have_selector("input[type=submit][value='#{value}']")
  end
end 
```

我把它`spec/support/matchers/request_matchers.rb`和我的其他自定义匹配器放在一起。RSpec 会自动拾取它。由于这是一个 RSpec 匹配器（而不是 Capybara 查找器），它可以在功能规范（Capybara）和视图规范（没有 Capybara 的 RSpec）中工作。

功能规格用法：

```
page.should have_submit_button("Save Me") 
```

查看规范使用情况（调用后`render`）：

```
rendered.should have_submit_button("Save Me") 
```

请注意，如果您在 Capybara 请求规范中，并且想与提交按钮进行交互，那会容易得多：

```
click_button "Save Me" 
```

不能保证它实际上是一个提交按钮，但您的功能规范应该只是测试行为，而不是担心细节级别。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-02-17T09:29:11.473

有一个内置的匹配器[has_button？](http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Matchers#has_button%3F-instance_method).

使用 RSpec 你可以有一个断言

```
page.should have_button('Submit button') 
```

或者使用新的 RSpec 3 语法：

```
expect(page).to have_button('Submit button') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-30T20:57:17.257

我有一个（用于黄瓜）：

```
Then /^I should see "([^"]*)" button/ do |name|
  should have_button name
end 
```

负面使用：have_no_button

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T20:52:13.553

如果您的 HTML 标记类似于：

```
<input type="submit"></input> 
```

然后你可以在 capybara 中执行以下操作：

```
page.should have_selector('input[type=submit]') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-24T22:14:25.633

我有类似的东西：

```
page.find("#submitButton").visible? 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-03T13:17:19.597

**试试这个**

```
it { should have_xpath("//input[@value='Sign up']") } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-24T22:43:05.153

尝试：

```
it { should have_selector('input', value: "Submit") } 
```

更新：我怀疑这个答案在某些情况下可能无法正常工作。当我使用它来测试其他输入标签中的值时，无论该值是什么，它似乎都通过了。

# iphone - 我们如何根据 textview 内容设置滚动视图的内容大小？

> ID：12573519
> 
> 赞同：0
> 
> 时间：2012-09-24T21:59:24.903
> 
> 标签：iphone, ios

在我的应用程序中，我采用了 textview 和 imageview。基于 textview 中的内容，我们如何管理滚动视图的内容大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:10:55.390

假设您希望内容大小至少足够大以滚动整个内容，您可以通过添加来`textview`确定正确的大小，然后将 设置为类似`textView``scrollview``contentSize`

```
scrollPanel.contentSize = CGSizeMake( txtView.frame.origin.x + txtView.frame.size.width, txtView.frame.origin.y + txtView.frame.size.height) 
```

这会将内容宽度设置为与 一样宽`txtView`，加上左侧定位偏移量，并且高度与`txtView`的高度加上它与 . 顶部的距离相同`scrollPanel`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T04:38:18.857

```
 // scrollPanel fit to the text view

    scrollPanel.frame=self.view.frame (or) view.frame;
    scrollPanel.contentSize = CGSizeMake(textview.frame.width,textview.frame.height); 
```

# php - 如何将特定节点分配为变量值而不输出它？

> ID：12573526
> 
> 赞同：0
> 
> 时间：2012-09-24T22:00:22.777
> 
> 标签：php, mysql, database

我只有 5 天的 MySQL 经验，所以还没有对这种语言的功能有一个自然的理解。

我创建了一个数据库，在该数据库中执行查询并将输出生成为链接，单击该链接时，会在数据库中对单击的节点的所有子类别执行另一个查询。

到目前为止，我一直在将查询的名称 onclick 作为变量传递，以便进行下一次搜索。

即，如果用户点击“健康和健身”，字符串“健康和健身”就会通过变量传递并插入到下一个查询中。

但是我已经意识到我需要一种更强大的方法来将有关每个节点的适当数据从搜索传输到搜索。

即，如果有人点击“健康和健身”，我不仅希望通过 url 将该字符串作为变量传递，还希望传递与该类别相关的其他信息，即其 ID 号和 parent_id。

所以本质上，无论用户点击几个查询中的哪一个，我都希望能够将该查询作为字符串发送，并将其父 id 发送到 php 页面，该页面将相应地查询和显示数据。

我在想我应该创建一个变量来保存我想要的数据，这些数据在查询结果循环的每次重复时都放在 onclick url 中。

但是我仍然不确定如何导航数据库或将特定的行/列值分配给变量。

# windows-phone - Windows Phone 应用程序中的 httpcontext

> ID：12573528
> 
> 赞同：1
> 
> 时间：2012-09-24T22:00:29.890
> 
> 标签：windows-phone, httpcontext, system.web

我是 Windows 手机开发的新手，我正面临编写第一个应用程序的第一个问题。

我无法添加对 system.Web 的引用，我想使用 httpcontext，我不知道是否可能。

我需要使用其他功能，例如 httputility 并且我已经设法使用[this](http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/src/core/HttpUtility.cs?r=961)进行排序。

我已经将该代码改编为 Windows 应用程序，但对于 httpcontext 我找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T21:07:20.810

自动应答：

最后，我使用 HttpWebRequest 和 HttpWebResponse 完成了它

# iphone - NSFetchRequest 内存问题

> ID：12573529
> 
> 赞同：0
> 
> 时间：2012-09-24T22:00:31.030
> 
> 标签：iphone, objective-c, ios, core-data, memory-management

我已经发布了关于与此相关的不同事情的类似问题，但已经为此苦苦挣扎了大约一周，但无济于事。这一切都归结为这段代码：

```
NSFetchRequest *oldFetchRequest = [[NSFetchRequest alloc] init];
        NSEntityDescription *oldEntryEntity = [NSEntityDescription entityForName:@"Media"
                                                          inManagedObjectContext:oldContext];
        [oldFetchRequest setEntity:oldEntryEntity];
        [oldFetchRequest setFetchBatchSize:10];
        NSArray *medias = [oldContext executeFetchRequest:oldFetchRequest error:&error];

    int i = 0;

    int count = [oldContext countForFetchRequest:oldFetchRequest error:nil];

    NSLog(@"count: %i", count);

    while (i < count) {
        @autoreleasepool {
        NSManagedObject *media = [medias objectAtIndex:i];

            [oldContext refreshObject:media mergeChanges:NO];

        NSLog(@"i: %i", i);
        i++;
        }
    } 
```

计数应该达到 250 左右，项目的数量`media`。在应用程序耗尽内存并崩溃之前，它实际上达到了大约 100。每次运行此代码时，它都会建立越来越多的内存，大概是因为每个都`media`包含许多 NSData 属性，其中包括一个大属性。Instruments 显示每次运行代码时内存都会增加。

`@autoreleasepool`我添加了尝试解决这个问题，`refreshObject:mergeChanges:`但他们没有奏效。

我想要做的是将所有项目从这个商店手动移动到一个新的，因为标准迁移不适用于大数据。这是起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T16:09:17.703

为每个`media`你分配一个新的`NSManagedObject`. 相反，您可以定义一个实例`media`并重用它。

另外，我相信您实际上可以使用`NSFetchedResultsController`为迭代一组获取结果而优化的 a，并具有各种幕后内存优化。

然后，您可以像这样简单地迭代：

```
for (id object in _fetchedResultsController.fetchedObjects) 
```

我认为这两个建议都应该显着减少内存占用。

# jquery - 移动浏览器上的置顶标题

> ID：12573532
> 
> 赞同：1
> 
> 时间：2012-09-24T22:00:47.133
> 
> 标签：jquery, css, sticky

我需要移动浏览器上的粘性标题。我目前正在使用这个 jquery 脚本：

```
<script>
  $(function(){
    var stickyHeader = $('#persist-wrap').offset().top;
    $(window).scroll(function(){
      if( $(window).scrollTop() > stickyHeader ) {
        $('#persist-wrap').addClass("sticky");
      } else {
        $('#persist-wrap').removeClass("sticky");
      }
    });
  });
</script> 
```

使用此 CSS 代码：

```
.sticky {
  position: fixed;
  top: 0;
} 
```

标头的 id 为persist-wrap。这在桌面浏览器上运行良好，但在移动浏览器上根本不行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T11:41:17.243

我对您的示例进行了一些调整，它适用于运行 ICS 的三星 Galaxy S2 和运行 iOS 6.01 的 iPad 3：（没有其他人可以测试它）。

**变更清单**

*   我缓存了所有多次使用的对象。
*   对其进行了更改，使其成为接受对象参数的可重用函数，因此可以多次应用（可以对其进行调整以一次接受多个对象）。

这是示例：

```
$(function(){

	createSticky(jQuery("#header"));

});

function createSticky(sticky) {

	if (typeof sticky !== "undefined") {

		var	pos = sticky.offset().top,
				win = jQuery(window);

		win.on("scroll", function() {
    		win.scrollTop() >= pos ? sticky.addClass("fixed") : sticky.removeClass("fixed");      
		});			
	}
}
```

```
#header {
	background: #666;
	padding: 3px;
  padding: 10px 20px;
  color: #fff;
}
#header.fixed {
	position: fixed;
	top: 0;
	width: 100%;
}

/* For aesthetics only */

body {
	margin: 0;
    height: 10000px;
	font-family: Segoe, "Segoe UI", "DejaVu Sans", "Trebuchet MS", Verdana, sans-serif;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Some Text before the header</p>
<div id="header">
  Home
</div>
```

# android - 自定义视图和放置 ImageView

> ID：12573534
> 
> 赞同：0
> 
> 时间：2012-09-24T22:00:49.140
> 
> 标签：android, android-imageview

我创建了一个自定义的“视图”类，并且在该类中我覆盖了 onDraw 方法，因此我可以绘制我的游戏板。现在我需要画出我的作品，这些作品需要是 ImageView 的，所以我可以做动画等。我不确定如何将图像绘制到自定义视图上的特定位置。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T14:59:50.513

所以事实证明我的概念是错误的。我无法将 ImageView 添加到扩展 View 的自定义类中。我最终要做的是将我的自定义视图添加到RelativeLayout，然后将我的每个ImageViews 添加到相同的布局中，只要首先添加自定义视图，我的imageviews 就在顶部。

# model-view-controller - 使用依赖注入创建昂贵的对象

> ID：12573538
> 
> 赞同：1
> 
> 时间：2012-09-24T22:01:04.583
> 
> 标签：model-view-controller, dependency-injection, unit-of-work

我是 DI 的新手，我正在开发一个 MVC 项目，其中一个控制器被注入了一个[UnitOfWork](http://www.martinfowler.com/eaaCatalog/unitOfWork.html)，这个 UnitOfWork 包含我域中每个实体类型的存储库。使用[MSDN](http://msdn.microsoft.com/en-us/library/ff714955.aspx)作为指南，我最初有类似的东西

```
public IRepository<Employee> Employees {
    get {
        if (_employees == null) {
            _employees = new SqlRepository<Employee>(_context);
        }
        return _employees;
    }
} 
```

但是，我认为注入存储库会很好，例如：

```
public SqlUnitOfWork(IRepository<Employee> employees)
{
    this.Employees = employees;
} 
```

但是，如果创建 SqlRepository 非常昂贵怎么办。并非每个控制器操作都使用每个存储库。在我更改为 DI 之前，只有在访问它们时才会创建每个存储库。但是，现在所有存储库都是使用 UnitOfWork 创建的。我正在尝试确定当我已经在 SqlUnitOfWork 中时注入 SqlRepositories 是否值得？或者，我应该遵循 MSDN 示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:20:16.543

> [我不是 ASP.NET MVC 用户，但[依赖注入](http://martinfowler.com/articles/injection.html)方法背后的想法并没有改变。所以，*把这个和一粒盐一起吃*。]

根据您的描述，您在工作单元中使用了多个存储库，您无法决定是注入它们还是在其中创建它们。最好的做法是：**两者都不是**。

当您处理未知数量的相同类型的依赖项时，注入工厂实例会更聪明。然后，您的`UnitOfWork`实施可以向所述工厂请求服务。

在这种情况下，工厂将检查此类服务是否已经初始化。如果此类服务已初始化，您可以将其返回。如果没有，则初始化该服务，将其缓存*（很可能在工厂中的某些类似数组的结构中）*并返回该实例。

* * *

**其他一些注意事项**

*   存储库和工作单元都不应该暴露给控制器。它们是负责处理存储的结构。您最终会将模型层的内部细节暴露给表示层。基本上，*您的抽象正在泄漏*。

*   我会小心阅读该教程。看来这篇文章的作者并没有完全掌握 DI 的概念。如果你看一下这段代码：

    ```
    public class SqlUnitOfWork : IUnitOfWork {
        public SqlUnitOfWork() {
            var connectionString =
                ConfigurationManager
                    .ConnectionStrings[ConnectionStringName]
                    .ConnectionString;
            _context = new ObjectContext(connectionString);
        }

        /* --- SNIP --- */

        readonly ObjectContext _context;
        const string ConnectionStringName = "EmployeeDataModelContainer";
    } 
    ```

    您可以看到 DB 连接在构造函数中基于常量进行初始化，该常量已在`SqlUnitOfWork`类的定义中硬连线。*这是一个非常糟糕的做法。*

*   如果您想了解更多关于 OOP 实践的依赖注入的一般信息，我建议您[观看本讲座](http://www.youtube.com/watch?v=RlfLCWKxHJ0)和同一系列的讲座。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T23:09:17.797

您担心注入昂贵的创建对象是正确的。

依赖注入依赖于能够廉价地创建和注入对象（其中一些可能永远不会使用）。这就是为什么在构造函数中或在构建对象图时执行“实际工作”是一个坏主意的原因。

这里的问题是`IRepository`创建成本很高。如果它在构造函数中做“真正的工作”，你可以稍后将这项工作移到需要它之前吗？这有点像懒惰的评估。这解决了问题的根本原因。

有时，这是不可能的。有解决方法：

*   注入一些东西，会给你一个 IRepository 的实例（一个工厂）
*   将 IRepository 接口实现为 LazyRepository。LazyRepository 有一个真实的、昂贵的创建存储库的成员变量。在每种方法中，您检查此变量是否为空。如果是，则创建真正的存储库。然后，每个方法都委托给真正的存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T07:04:57.647

为昂贵的依赖注入工厂意味着该依赖的使用者知道依赖的接口有一个昂贵的实现。如果消费者相应地改变了它的实现，那就是一个泄漏的抽象。

看看[这篇博文](http://outlawtrail.wordpress.com/2012/07/26/unity-generate-lazy-proxies-on-the-fly/)。它展示了如何使用 Unity 生成一个实时实现存储库接口的惰性代理。

[根据这个线程，](https://stackoverflow.com/questions/9757953/can-any-of-existing-ioc-containers-create-the-lazy-proxy-classes-dynamically)温莎城堡可以做同样的事情。

# android - 我希望我的应用程序仅支持具有 mdpi 密度的 xlarge 屏幕

> ID：12573543
> 
> 赞同：0
> 
> 时间：2012-09-24T22:02:00.793
> 
> 标签：android, screen, android-manifest, resolution, mdpi

我正在开发一个目前只支持平板电脑的应用程序。但是我没有更高密度的平板电脑的高分辨率照片（比如最新的华硕平板电脑，~230 dpi，1920X1200，我认为它被称为 TF700T 或类似的东西），我不想开始测试这个 ui屏幕。我现在只有大多数普通平板电脑（1280x720 和 10.1'）的 mdpi 照片，我在平板电脑上开发了这个应用程序，这个屏幕是当今平板电脑的常见尺寸。

我知道如何将应用程序设置为仅支持 xlarge 屏幕，但我也希望它仅支持 mdpi 屏幕。我无法从 Android 开发人员指南中找到一种方法。

我现在的清单：

```
<supports-screens 
    android:xlargeScreens="true"
      android:largeScreens="false"
      android:normalScreens="false"
      android:smallScreens="false"/> 
```

谢谢， 埃拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:20:21.930

使用`<compatible-screens>`：

```
<compatible-screens>
    <screen android:screenSize="xlarge" android:screenDensity="mdpi" />
</compatible-screens> 
```

请参阅：http: [//developer.android.com/guide/topics/manifest/compatible-screens-element.html](http://developer.android.com/guide/topics/manifest/compatible-screens-element.html)

尽管像这样创建一个高度依赖分辨率的应用程序并不是一个特别好的策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:22:09.817

您不能阻止**mdpi**密度平板电脑安装您的应用程序，但您可以强制它们在[**屏幕兼容模式下**](http://developer.android.com/guide/practices/screen-compat-mode.html)运行它，这是通过`android:largestWidthLimitDp`属性完成的`<support-screens>`

还有一个属性`android:compatibleWidthLimitDp`可以让用户选择是否要在屏幕兼容模式下运行应用程序。

有关这两个属性的描述和使用，请阅读[**此处**](http://developer.android.com/guide/topics/manifest/supports-screens-element.html#compatibleWidth)

# javascript - 使用 Mootools/Javascript 解析简码

> ID：12573544
> 
> 赞同：0
> 
> 时间：2012-09-24T22:02:02.970
> 
> 标签：javascript, mootools

我需要在 CMS 文本区域中使用字符串/简码来定义按钮......对于非技术用户来说很简单，例如：

[button text="点击这里" href="http://www.google.com"]

基于该字符串，我需要在前端使用 mootools（或一般的 javascript）动态创建一个按钮（jquery 在我们的环境中不可用）。到目前为止，我还无法解析以括号开头的代码，然后获取这些属性以在代码中使用。然后我需要销毁原始简码。如果有更好的方法，它不必完全按照我上面的方式进行设置......任何建议都值得赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T14:40:48.567

这是我想出的解决方案......这有点像黑客，但它有效。我正在使用的 CMS 是基于 Coldfusion 的，但该方法应该是可转移的......

另一个复杂性：在我们的例子中，我们需要可编辑按钮出现在与模板的可编辑区域分开的位置。基本上，我们在侧边栏中有一个不可编辑的按钮，我们希望它可以从主要内容区域轻松编辑。因此，如果用户定义了一个按钮，我们将用用户定义的按钮替换侧边栏按钮。所以我有一个额外的步骤，我使用 mootools 来抓取创建的按钮，替换页面侧边栏中的按钮，然后销毁原始按钮。

目标是让用户在 CMS 的文本区域中的某处输入短代码，例如：

```
[button id="override-button" title="XXX" href="YYY"][/button] 
```

后端会将其转换为 DOM 元素，而在前端，我们将使用 mootools 将按钮定位在需要的位置，然后销毁原始标记。

首先，我在数据库输出中搜索了代码......

```
<cfset find1='\[button'>    <!-- open-->
<cfset find2='\]\[/button]'>    <!-- close --> 
```

接下来，在coldfusion中使用正则表达式替换，我将按钮的第一个实例替换为标记...（rs.body是指从数据库返回的正文数据）...

```
<cfset replace1 = "<button">
<cfset replace2 = "></button>">
<cfset rs.body=#REReplace(rs.body,find1,replace1,"ONE")#>
<cfset rs.body=#REReplace(rs.body,find2,replace2,"ONE")#> 
```

因此，生成的标记将是：

```
<button id="override-button" title="XXX" href="YYY"></button> 
```

接下来，我使用 mootools 来操作该 DOM 元素。如前所述，侧边栏中已经有一个 ID 为“open-form-b​​utton”的按钮，因此它会抓取该按钮并将文本和链接替换为上面定义的属性，然后销毁上面定义的元素。

```
var overrideBtn = $('override-button');
var overrideBtn_title,overrideBtn_href = null;

if (overrideBtn) {
overrideBtn_title = overrideBtn.getProperty('title');
overrideBtn_href = overrideBtn.getProperty('href');

if (overrideBtn_title && overrideBtn_href)
{
    $('open-form-button').set('text', overrideBtn_title);
    $('open-form-button').setProperty('href',overrideBtn_href);
    overrideBtn.dispose();
}
} 
```

就是这样。我不知道这对其他人有多大帮助，但由于朱利安建议我发布我的解决方案，我希望它可以帮助别人！祝你好运！

# c++ - 无法在 CWinAppEx 中访问 CChildView

> ID：12573548
> 
> 赞同：0
> 
> 时间：2012-09-24T22:02:28.850
> 
> 标签：c++, mfc

我有一个 C++ 中的单文档 MFC 应用程序，我想知道是否可以从我的 CWinAppEx 类调用在 CChildView 中声明的函数。

CChildView 是 CWnd 类型。

到目前为止，我尝试过：

```
CChildView* view = (CChildView*)m_pActiveWnd; 
```

和

```
CWnd* pWndMain = AfxGetMainWnd();
CChildView* view = (CChildView*) pWndMain; 
```

我在这种类型的架构中相对较新，所以我希望有人能给我一些建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T01:02:29.237

强制转换没有帮助，因为主窗口不是 CChildView 类，也不是从其中继承的。它是一个 CFrameWnd，它是管理 Doc/View Architecture 中的视图的类。

您可以像这样获得指向视图窗口的指针。

```
 CView* pActiveView = ((CFrameWnd*) AfxGetMainWnd())->GetActiveView(); 
```

# python - Django 上 Heroku 转储数据不完整的输出

> ID：12573550
> 
> 赞同：7
> 
> 时间：2012-09-24T22:02:33.200
> 
> 标签：python, django, heroku, django-cms

我一直在尝试通过 Heroku 工具带远程转储相对少量的数据（80 行左右`django-cms text plugin`^(1 ）：)

```
heroku run python manage.py dumpdata text 
```

但我得到随机不完整的输出~~每次运行都更接近 EOF~~（大概是缓存的？）。

```
11:09 PM $> heroku run python manage.py dumpdata text | wc -c
108351
11:09 PM $> !!
120629
11:09 PM $> !!
122693
11:10 PM $> !!
122949
11:10 PM $> !!
153419
11:13 PM $> !!
120877 
```

有人遇到类似的事情吗？我将*Django 1.4*与*postgresql*一起使用。

*¹虽然，它是 HTML o_0 的 blob*：[请参阅 docs](http://docs.django-cms.org/en/2.2/getting_started/plugin_reference.html#text)。

**编辑：**假设这只是一个限制？pg_dump's/restore 是我的“备份”计划。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-26T15:00:20.557

另一种解决方法是添加一个 sleep 命令来停止会话超时。

heroku 运行“python manage.py dumpdata; sleep 10”

大概这个数字会随着您的数据库而增长......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T06:40:56.473

看起来由于某种原因脚本超时。这是 Heroku 的错误或“功能”。这是一种解决方法：

[https://devcenter.heroku.com/articles/heroku-postgres-import-export](https://devcenter.heroku.com/articles/heroku-postgres-import-export)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T17:30:54.473

另一个更简单的解决方法是从 heroku bash 提示符中运行 dumpdata：

```
heroku run bash

python manage.py dumpdata ... 
```

然后从终端捕获输出。复制和粘贴对我有用。我敢肯定有一种更好的方法可以做到这一点。

# c# - 访问具有 CodeBehind 的命名资源字典

> ID：12573552
> 
> 赞同：0
> 
> 时间：2012-09-24T22:02:45.603
> 
> 标签：c#, .net, wpf, xaml, .net-4.0

我有一个 ResourceDictionary ，我已经[设置了 codebehind](https://stackoverflow.com/a/98422/16241)。

该代码隐藏还具有我需要初始化的数据库中的组合框下拉列表。由于这是一个“视图”级别对象，我不想将它直接连接到我的“模型”级别对象。

所以，我需要找到一种方法来访问这个对象。问题是这个“类”是由视图调用创建的`InitializeComponent()`。所以我不能只传递我需要的东西作为参数。

我试图获取资源并将其转换为我的“类”，但这不起作用。（无效演员表）

```
ResourceDictionary resource = new ResourceDictionary
{
  Source=new Uri("/MyProject;component/MyClass.xaml", UriKind.RelativeOrAbsolute)
};

var myClass = resource as MyClass;
myClass.ListOfItems = listOfItems; 
```

我最后的手段是创建静态方法并以这种方式传递我需要的引用。但这将这两个类紧密结合在一起。所以我想我会看看是否有更好的方法，任何人都知道......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T01:52:03.267

您是否在转换之前继承了您的类 ( `MyClass`) `ResourceDictionary`？

你也可以试试

```
List<MyClass> listOfItem = new List<MyClass>(ResourceDisctionaryCollection); 
```

# cloudbees - 当我是管理员时，为什么詹金斯认为我是客人？

> ID：12573556
> 
> 赞同：2
> 
> 时间：2012-09-24T22:02:56.940
> 
> 标签：cloudbees

就在今天早上，我能够登录到[我的 Cloudbees Jenkins 仪表板](https://gedcom.ci.cloudbees.com/)并配置构建、开始构建等。但现在我登录并认为我是“访客用户”，我无法启动构建。这是怎么回事？

![仪表盘](../Images/52f41ad3d50e6371c3b712e21b62bbc3.png) ![在 / 配置](../Images/e462926539f815b5b59b0aef75dc2c1e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T01:21:31.977

问题是您的 Jenkins 会话已过期，但工具栏未显示“登录”链接。作为一种解决方法，您可以导航到 /manage 或 /configure，系统将提示您登录。我们正在努力解决这个问题。

# sql - OUTER JOIN 结果缺少行，没有 WHERE 子句（找到解决方法）

> ID：12573561
> 
> 赞同：6
> 
> 时间：2012-09-24T22:03:30.310
> 
> 标签：sql, ms-access-2007

在底部更新。

我正在尝试做一个自我外连接，对于每条记录，返回它和所有其他在它之后发生的记录，或者如果它本身是最新的记录，则返回 NULL。这是我的 sql 代码：

```
SELECT A.[CR#], A.REGIS_STATUSDATE, B.REGIS_STATUSDATE
FROM CR_ADMIN_REGIS_STATUS A LEFT OUTER JOIN CR_ADMIN_REGIS_STATUS B
ON A.[CR#]=B.[CR#] AND A.REGIS_STATUSDATE < B.REGIS_STATUSDATE 
```

我的问题是，对于给定的 [CR#]，当 A.REGIS_STATUSDATE 是最大值（因此 B.REGIS_STATUSDATE 不能大于它）时，该行不包含在我的结果中。

例如，如果 CR_ADMIN_REGIS_STATUS 看起来像这样：

```
CR#   REGIS_STATUSDATE
1     5/1/12
1     5/2/12
1     5/3/12
2     5/1/12
2     5/2/12 
```

我希望我的查询结果是

```
CR#   A.REGIS_STATUSDATE B.REGIS_STATUSDATE
1     5/1/12             5/2/12
1     5/1/12             5/3/12
1     5/2/12             5/3/12
1     5/3/12             NULL
2     5/1/12             5/2/12
2     5/2/12             NULL 
```

相反，我得到了这个：

```
CR#   A.REGIS_STATUSDATE B.REGIS_STATUSDATE
1     5/1/12             5/2/12
1     5/1/12             5/3/12
1     5/2/12             5/3/12
2     5/1/12             5/2/12 
```

鉴于我的查询是 LEFT OUTER JOIN，并且我没有 WHERE 子句，我希望原始表中的所有行都在结果中，但事实并非如此。我在这里想念什么？

编辑：这是在 Access 2007 中

更新：我决定看看如果我将表 CR_ADMIN_REGIS_STATUS 的部分复制到一个单独的表中并针对它运行我的查询会发生什么。即使我刚刚直接将整个表复制到新表中（手动），查询仍然有效！不过，只有在实际复制和粘贴时才会出现这种情况，当我 SELECT * INTO 另一个表时，问题仍然存在。
最终我发现如果我对

```
SELECT *
FROM CR_ADMIN_REGIS_STATUS
UNION ALL SELECT TOP 1 * 
FROM CR_ADMIN_REGIS_STATUS; 
```

而不是 CR_ADMIN_REGIS_STATUS 本身，我的查询返回了所需的结果。奇怪的。我也对一个从一开始就有效的类似表进行了类似的查询，所以这似乎是一个仅限于这个表的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:12:26.870

你没有错过任何东西。**如果发生这种情况，这是一个错误。**

MS-Access 使用的引擎有几个错误。我在具有“复杂”`ON`条件的连接中看到了类似的、无效的行为。请参阅 Access 给出错误结果的另一个 SO 问题：[为什么我在 Access 中的左联接的行数少于左表？](https://stackoverflow.com/questions/10302675/why-does-my-left-join-in-access-have-fewer-rows-than-the-left-table)

您可以在 SQL-Server、Oracle、Postgres 甚至 MySQL 中尝试使用相同数据的查询，您将获得正确的预期结果。

* * *

作为一种解决方法，您可以尝试使用 重写查询`UNION`，但永远无法确定其正确性：

```
SELECT A.[CR#], A.REGIS_STATUSDATE, B.REGIS_STATUSDATE
FROM CR_ADMIN_REGIS_STATUS A 
  INNER JOIN CR_ADMIN_REGIS_STATUS B
    ON  A.[CR#]=B.[CR#] 
    AND A.REGIS_STATUSDATE < B.REGIS_STATUSDATE

UNION ALL

SELECT A.[CR#], A.REGIS_STATUSDATE, NULL
FROM CR_ADMIN_REGIS_STATUS A 
WHERE NOT EXISTS
      ( SELECT *
        FROM CR_ADMIN_REGIS_STATUS B
        WHERE A.[CR#]=B.[CR#] 
          AND A.REGIS_STATUSDATE < B.REGIS_STATUSDATE
      ) ; 
```

# c# - Entity Framework 5 使用 SaveChanges 添加审计日志

> ID：12573568
> 
> 赞同：6
> 
> 时间：2012-09-24T22:04:05.580
> 
> 标签：c#, asp.net-mvc, entity-framework, savechanges

似乎直接覆盖 EF 中的 SaveChanges 以添加审核记录器。请参阅下面的 ApplyAuditLogging 方法来设置审计属性（created、createdby、updated、updatedby）。

```
 public override int SaveChanges()
    {
        var autoDetectChanges = Configuration.AutoDetectChangesEnabled;

        try
        {
            Configuration.AutoDetectChangesEnabled = false;
            ChangeTracker.DetectChanges();
            var errors = GetValidationErrors().ToList();
            if(errors.Any())
            {
                throw new DbEntityValidationException("Validation errors were found during save: " + errors);
            }

            foreach (var entry in ChangeTracker.Entries().Where(e => e.State == EntityState.Added || e.State == EntityState.Modified))
            {
                ApplyAuditLogging(entry);
            }

            ChangeTracker.DetectChanges();

            Configuration.ValidateOnSaveEnabled = false;

            return base.SaveChanges();
        }
        finally
        {
            Configuration.AutoDetectChangesEnabled = autoDetectChanges;
        }
    }

    private static void ApplyAuditLogging(DbEntityEntry entityEntry)
    {

        var logger = entityEntry.Entity as IAuditLogger;
        if (logger == null) return;

        var currentValue = entityEntry.Cast<IAuditLogger>().Property(p => p.Audit).CurrentValue;
        if (currentValue == null) currentValue = new Audit();
        currentValue.Updated = DateTime.Now;
        currentValue.UpdatedBy = "???????????????????????";
        if(entityEntry.State == EntityState.Added)
        {
            currentValue.Created = DateTime.Now;
            currentValue.CreatedBy = "????????????????????????";
        }
    } 
```

问题是如何让 windows 用户登录/用户名设置对象的 UpdatedBy 和 CreatedBy 属性？因此我不能使用它！

另外，在另一种情况下，我想自动将新的 CallHistory 记录添加到我的联系人中；每当修改联系人时，都需要在子表 CallHistory 中添加一条新记录。所以我在 Repository 的 InsertOrUpdate 中做到了，但感觉很脏，如果我能在更高的级别上做到这一点会很好，因为现在我必须从数据库中设置当前用户。同样这里的问题是我需要从数据库中获取用户以创建 CallHistory 记录（SalesRep = User）。

我的存储库中的代码现在做了 2 件事，1，它在创建或更新对象时创建了一个审计条目，2，它还在更新联系人时创建了一个 CallHistory 条目：

```
ContactRepository.SetCurrentUser(User).InsertOrUpdate(contact) 
```

为了让用户在存储库上下文中：

```
 var prop = typeof(T).GetProperty("Id", BindingFlags.Public | BindingFlags.Instance | BindingFlags.IgnoreCase);

    if (prop.GetValue(entity, null).ToString() == "0")
    {
        // New entity
        _context.Set<T>().Add(entity);
        var auditLogger = entity as IAuditLogger;
        if (auditLogger != null)
            auditLogger.Audit = new Audit(true, _principal.Identity.Name);
    }
    else
    {
        // Existing entity
        _context.Entry(entity).State = EntityState.Modified;
        var auditLogger = entity as IAuditLogger;
        if (auditLogger != null && auditLogger.Audit != null)
        {
            (entity as IAuditLogger).Audit.Updated = DateTime.Now;
            (entity as IAuditLogger).Audit.UpdatedBy = _principal.Identity.Name;
        }

        var contact = entity as Contact;
        if (_currentUser != null)
            contact.CallHistories.Add(new CallHistory
                {
                    CallTime = DateTime.Now,
                    Contact = contact,
                    Created = DateTime.Now,
                    CreatedBy = _currentUser.Logon,
                    SalesRep = _currentUser
                });
    }
} 
```

有没有办法以某种方式将 Windows 用户注入 DbContext 中的 SaveChanges 覆盖，还有一种方法可以根据 Windows 登录 ID 从数据库中获取用户，以便我可以在 CallHistory 上设置 SalesRep（参见上面的代码）？

这是我在 MVC 应用程序上对控制器的操作：

```
[HttpPost]
public ActionResult Create([Bind(Prefix = "Contact")]Contact contact, FormCollection collection)
{
    SetupVOs(collection, contact, true);
    SetupBuyingProcesses(collection, contact, true);

    var result = ContactRepository.Validate(contact);

    Validate(result);

    if (ModelState.IsValid)
    {
        ContactRepository.SetCurrentUser(User).InsertOrUpdate(contact);
        ContactRepository.Save();
        return RedirectToAction("Edit", "Contact", new {id = contact.Id});
    }

    var viewData = LoadContactControllerCreateViewModel(contact);

    SetupPrefixDropdown(viewData, contact);

    return View(viewData);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:51:11.290

好吧，简单而懒惰的方法是从您的审计代码中简单地访问 HttpContext.Current.User.Identity.Name 。但是，这将创建对 System.Web.* 的依赖关系，如果您有一个分层良好的应用程序，这可能不是您想要的（如果您使用实际的单独层，它将无法工作）。

一种选择是，而不是覆盖 SaveChanges，只需创建一个使用您的用户名的重载。然后你做你的工作，然后调用真正的 SaveChanges。缺点是有人可能会错误地（或故意地）调用 SaveChanges() （真实的）并绕过审计。

更好的方法是简单地将 _currentUser 属性添加到您的 DbContext 并使用构造函数将其传入。然后，当您创建上下文时，您只需在那时将用户传入。不幸的是，您不能真正从构造函数中查找数据库中的用户。

但是您可以简单地保存 ContactID 并添加它而不是整个联系人。您的联系人应该已经存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T07:50:06.483

我知道这是一个迟到的答案，但我只是偶然发现了这个问题。我有一个非常相似的用例。我们是这样做的：

```
var auditUsername = Current.User.Identity.Name;
var auditDate = DateTime.Now; 
```

现在的班级：

```
public class Current
    {
        public static IPrincipal User
        {
            get
            {
                return System.Threading.Thread.CurrentPrincipal;
            }
            set
            {
                System.Threading.Thread.CurrentPrincipal = value;
            }

        }
    } 
```

这将返回进程的 windows 用户，或在 ASP.NET 应用程序中登录的用户。阅读更多：[http ://www.hanselman.com/blog/SystemThreadingThreadCurrentPrincipalVsSystemWebHttpContextCurrentUserOrWhyFormsAuthenticationCanBeSubtle.aspx](http://www.hanselman.com/blog/SystemThreadingThreadCurrentPrincipalVsSystemWebHttpContextCurrentUserOrWhyFormsAuthenticationCanBeSubtle.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T11:57:18.923

我认为您可能正在跨越一些关注边界的分离。存储库模式用于分离您的业务逻辑、数据库映射和数据库 crud 操作。应用程序应该关注登录的用户，存储库应该只关注保存数据。我建议不要在您的存储库中引用 HttpContext，因为如果这样做，那么您的存储库只能由 Web 应用程序使用。如果您试图抽象出这种元数据的数量，请在您的应用程序中进行...例如在基本控制器或其他东西中。

# python - Python - 以一种奇怪的方式替换字符串；

> ID：12573571
> 
> 赞同：1
> 
> 时间：2012-09-24T22:04:17.203
> 
> 标签：python, string, replace

任何人都可以帮助解决这个问题吗？想象一下：

```
def example(s):
    s = s.replace('foo', 'foo bar')
    return s 
```

现在这将用 'foo bar' 替换 'foo'；但我想做一些不同的事情：*想象我有'foo something'；我希望最终结果是：'foo something bar'

进行此类检查的最佳方法是什么（如果有“东西”，我想保留它）。

任何人都可以帮忙吗？

纳米

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-24T22:10:56.250

使用`re`模块。

```
import re
def replace(s):
     return re.sub('foo(.*)', 'foo\1 bar', s)
replace('foo something') #'foo something bar' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T22:12:34.197

```
import re
mystring = "foo something blah"
re.sub(r"foo\s+(\w+)", r"foo \1 bar", mystring) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:43:57.700

对于您上面提到的具体示例：

```
import re

text = """Line 1 %find_lang %{name} has two %find_lang %{name}
occurences.

Line 4 has one %find_lang %{name}.

%find_lang %{name}

Line 6 is just the search pattern and a new line."""

print re.sub(
        '%find_lang %{name}',
        '%find_lang %{name} %{?no_lang_C}',
        text
    ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T22:57:44.663

对于练习，一种不使用正则表达式的笨拙方式：

```
def replace_foo(arg):
   content = arg.split()
   idx_foo = content.index("foo")
   content.insert(idx_foo+2, "bar")
   return ' '.join(content) 
```

（但你真的应该使用`re`......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-24T23:28:30.360

我刚刚用以下方法修复了它：

```
def replace_lang_macros(s):
    return re.sub(r'%find_lang(.*)', r'%find_lang\1 %{?no_lang_C}', s) 
```

谢谢大家；无论 %find_lang 之后是什么，它都会保留在那里......如果没有原始字符串表示法，我会得到奇怪的符号，但这并不是什么大挑战。

# php - 如何列出所有实例变量？

> ID：12573573
> 
> 赞同：0
> 
> 时间：2012-09-24T22:04:50.200
> 
> 标签：php

有没有办法列出所有实例的变量，最好是在数组或关联数组中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:06:47.913

你的意思是

```
var_dump($obj); 
```

这将输出对象或对象实例使用的所有变量。

你也可以使用

```
debug_backtrace(); 
```

这将输出与 a 相同的信息，`var_dump`但还会为您提供有关调用了哪些文件、类和方法的额外信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:07:37.247

内置的[get_defined_vars](http://php.net/manual/en/function.get-defined-vars.php)可能是您想要的。适用于全局范围和功能。方法和类稍微不那么直接，需要[Reflections](http://php.net/manual/en/book.reflection.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:13:58.683

有2种方式：

*   get_object_vars 给出调用范围可见的所有实例变量
*   反射类可以提供和过滤一个类中的所有实例变量

# c# - 将命令提示符输出重定向到 GUI 并保持颜色？

> ID：12573574
> 
> 赞同：10
> 
> 时间：2012-09-24T22:04:52.117
> 
> 标签：c#, redirect, colors, console

基本上我正在制作一个命令提示符 GUI。用户在富文本框中看到命令提示符输出，并在下面的纯文本框中输入命令。我已经成功地完成了这项工作，除了对我来说似乎不可能获得颜色信息。例如，如果我运行一个输出红色错误文本的程序，我没有得到颜色代码字节，它们根本不在流中！

这就是我现在正在做的事情。要启动该过程：

```
ProcessStartInfo startInfo = new ProcessStartInfo(@"C:\Windows\System32\cmd.exe");
startInfo.UseShellExecute = false;
startInfo.CreateNoWindow = true;
startInfo.RedirectStandardOutput = true;
startInfo.RedirectStandardInput = true;
startInfo.RedirectStandardError = true;

this.promptProcess = Process.Start(startInfo); 
```

然后我创建一个线程，它从输出流中读取并将其发送到我的文本框：

```
while (true)
{
    while (this.stream.EndOfStream) ;

    //read until there's nothing left in the stream, writing to the (locked) output box                    
    byte [] buffer = new byte[1000];
    int numberRead;
    StringBuilder builder = new StringBuilder();
    do
    {
        numberRead = this.stream.BaseStream.Read(buffer, 0, buffer.Length);
        char[] characters = UTF8Decoder.GetChars(buffer, 0, numberRead);
        builder.Append(characters);
    }
    while (numberRead == buffer.Length);

    this.writeToOutput(builder.ToString());
} 
```

即使我使用花哨的命令提示符来启动将输出彩色文本的应用程序，我也没有得到任何额外的颜色信息（甚至没有与文本混合的 ANSI 颜色代码）。正如您在上面看到的，我将前往 BaseStream 并读取字节，然后将它们解码为 UTF8。不幸的是，似乎即使是原始字节也不包括原始颜色信息。

**如何从我运行的应用程序中获取原始流，而无需任何过滤？我想要原始字节，以便我可以进行自己的颜色解析并呈现颜色正​​确的控制台输出。**

为了澄清，我不是在问如何解释颜色代码。我只想让它们在流中可用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-24T23:16:58.297

输出流的重定向永远不会包含“颜色信息”。除特殊情况外，当控制台程序显式输出带有 ANSI 转义序列的文本时。但！Windows 控制台不支持 ANSI 代码，因此此类程序的数量**非常**少。

WinAPI 中的颜色只能直接写入控制台（而不是流），带有一系列**控制台**函数，如`WriteConsoleOutput`. 自然地，可以从带有相应功能的控制台读取彩色输出，例如`ReadConsoleOutput`. 当然，控制台窗口必须存在，而不是必须隐含重定向。

与 unicode 相同的问题。Stream 不支持 UTF-8，除非您要求程序在该代码页中写入输出。但是，当您使用`ReadConsoleOutputW`- 从控制台（而不是流）读取文本时，您将“从盒子中”获得 unicode。

PS。我自己的控制台模拟器 ConEmu（[阅读 SO 上的答案](https://stackoverflow.com/a/10904494/1405560)）通过`ReadConsoleOutputW`.

# java - CLAHE算法解释

> ID：12573577
> 
> 赞同：1
> 
> 时间：2012-09-24T22:04:57.087
> 
> 标签：java, image, algorithm, contrast

是否有任何网站对 CLAHE 算法有完整的解释，也许还有一些示例代码。到目前为止，我只找到了 matlab 的代码，没有任何解释，我需要自己实现（最好在 java 中）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T19:02:30.357

一些基本解释：

[http://en.wikipedia.org/wiki/Adaptive_histogram_equalization](http://en.wikipedia.org/wiki/Adaptive_histogram_equalization)

和一个代码示例：

[http://rsb.info.nih.gov/ij/plugins/clahe/index.html](http://rsb.info.nih.gov/ij/plugins/clahe/index.html)

单击“CLAHE_.java”获取代码。

# java - 通过 SL4A 在 Android 中支持 NFC

> ID：12573578
> 
> 赞同：1
> 
> 时间：2012-09-24T22:05:28.987
> 
> 标签：java, android, python, jruby, nfc

我希望使用我的 Galaxy Nexus 来处理我的 NFC 卡。我已经能够通过 3rd 方应用程序阅读它们，并且我非常流利地使用外部 API 和 Python，并且非常想知道是否有办法从 SL4A 访问 android.NFC（所以我可以使用 python 并获取原始数据）信息）。基本上，如果有人知道如何轻松访问 android.NFC 库（希望有 jython 支持：/），将不胜感激

谢谢！

**我发现你可以** [在这里通过 JRuby 直接调用 API。](http://code.google.com/p/android-scripting/wiki/FAQ#Is_this_a_complete_API_bridge,_or_are_there_restrictions?)

**我相信这将允许一个人直接访问 android.nfc 吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:28:58.530

我在日常工作中使用 NFC，抱歉，SL4A 根本*不*支持 NFC。我很想有人来装这个，但我只是没有时间。

# mod-rewrite - 使用 ISAPI_Rewrite 更改子目录，同时保留域

> ID：12573579
> 
> 赞同：0
> 
> 时间：2012-09-24T22:05:34.520
> 
> 标签：mod-rewrite, isapi-rewrite

我们有两个域，www.aaa.com 和 www.bbb.com。两者都指向服务器上的同一个根目录。

服务器在根目录中有两个子目录：/abc/ 和 /xyz/。

如果有人输入 www.aaa.com/abc/ 他们应该去 /abc/ （正常）
如果有人输入 www.aaa.com/xyz/ 他们应该去 /xyz/ （正常）
** 如果有人输入 www.bbb.com/abc/ 他们应该去**/xyz/**（使用重写）
如果有人输入 www.bbb.com/xyz/ 他们应该去 /xyz/ （像往常一样）

我们如何为上面的第三种情况编写重写，它只影响域 www.bbb.com 而不是 www.aaa.com？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T04:49:34.810

您需要使用条件和规则：

```
RewriteCond %{HTTP:Host} ^www\.bbb\.com$ [NC]
RewriteRule ^abc$ /xyz [NC,L] 
```

# delphi - Delphi 2010 中的密钥推导函数

> ID：12573582
> 
> 赞同：0
> 
> 时间：2012-09-24T22:05:43.037
> 
> 标签：delphi, encryption, cryptography, delphi-2010

任何人都知道如何从纯文本密码生成密钥？我的意思是一个带盐的安全密钥派生函数。

IE。

```
function KeyDerivationProc(APassword : String) : String;
begin
     // ...
end; 
```

我正在使用德尔福（2010）。我想到了 DCPcrypt2 和 OpenPGPBlackbox，但我真的迷路了。

**任何帮助**将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:37:16.583

对于或多或少是标准的 PBKDF2，您似乎只能获得 Chilkat 库：

[http://www.example-code.com/delphi/crypt2_pbkdf2.asp](http://www.example-code.com/delphi/crypt2_pbkdf2.asp)

因此，您最好查看 bcrypt，[在这个壮观的网站上](https://stackoverflow.com/a/10441765/589259)有一个实现，如果您搜索它，也可以搜索其他一些。

# c# - xaml telerik 无法解析 RadGridView

> ID：12573586
> 
> 赞同：1
> 
> 时间：2012-09-24T22:05:52.320
> 
> 标签：c#, visual-studio, telerik, visual-studio-2012

出于某种原因，Visual Studio 中的 Intellisense 没有使用 Telerik RadGridView。

我的项目针对 .NET 3.5 并具有以下参考：

`Telerik.Windows.Controls`

`Telerik.Windows.Controls.GridView`

`Telerik.Windows.Controls.Input`

`Telerik.Windows.Data`

所有这些都适用于 .NET 3.5，运行时版本为 2.0.X

我的代码：

```
<Window x:Class="Project.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
    Title="MainWindow" Height="350" Width="525">

<Grid Loaded="Grid_Loaded">
    <StackPanel>
        <telerik:RadGridView></telerik:RadGridView> <-- this won't resolve 
```

Telerik 上的论坛帖子没有我在这里没有的任何内容。

任何想法为什么会发生这种情况以及如何解决它？

# c# - Windows 服务中的 ODP.NET 数据库更改通知

> ID：12573587
> 
> 赞同：2
> 
> 时间：2012-09-24T22:06:00.253
> 
> 标签：c#, windows-services, odp.net

我用 C# 编写了一个控制台应用程序，它使用 ODP.NET 来监听来自 Oracle 数据库的数据库更改通知。控制台应用程序完美运行。我用相同的代码编写了一个 Windows 服务，但在 Windows 服务`OracleDependency.OnChange`中永远不会触发。

这是我用来注册数据库更改通知的代码：

```
string sql = GenerateQuery();
using (OracleConnection conn = new OracleConnection(connectionString))
using (OracleCommand cmd = new OracleCommand(sql, conn))
{
    conn.Open();

    // Register a listener for the database change notification event
    OracleDependency dep = new OracleDependency(cmd);
    dep.OnChange += (sender, args) =>
        {
            // Do stuff..
        };
    cmd.ExecuteNonQuery();
} 
```

我可以通过查询表在数据库中看到通知`user_change_notification_regs`，但客户端从未收到回调。同样，在控制台应用程序版本中（使用相同的代码），客户端完美地接收到回调。

Windows 服务作为网络服务运行。我也尝试过本地系统，但似乎都没有工作。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:45:24.753

该服务需要 Windows 防火墙中的异常。添加异常后，它完美无缺。

# c# - WebImage Resize 这种行为是否正确？

> ID：12573589
> 
> 赞同：0
> 
> 时间：2012-09-24T22:06:05.980
> 
> 标签：c#, asp.net, .net, asp.net-mvc

所以，我上传大图像（2000x3000）并想调整它的大小，然后裁剪并确定。

你可以在这里看到：http: [//i.stack.imgur.com/IWwpg.png](http://i.stack.imgur.com/IWwpg.png)

我有 3000 高、2000 宽的 WebImage。因此，请将大小调整为 402x602，然后裁剪回 400x600。

结果：http: [//i.stack.imgur.com/dB5KX.png](http://i.stack.imgur.com/dB5KX.png)

**但到底是什么？**

为什么我真的得到 401x602？！

ps 没有足够的声誉直接在帖子中插入图片，请原谅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:15:47.247

如果您检查数字，如果没有 +2 像素，则您对图像大小的变化有一个完美的比例，因为`3000/600 == 2000/400 -> 5 ratio`

但是，如果用 +2 像素更改它，则将宽度/高度的比率更改为

```
3000/602->4.98, 2000/402 ->4.97, 
```

那是两个不同的数字，然后是试图保持图像比例的图像代码，就是吃掉 1 个像素。

正确的方法是在调整大小后添加 2 个像素，或者根据比例实际添加相同数量的像素。

# c# - 我可以从 DGV 的 DefaultValuesNeeded 事件中推断出上一行吗？

> ID：12573592
> 
> 赞同：0
> 
> 时间：2012-09-24T22:06:13.543
> 
> 标签：c#, winforms, datagridview

我希望能够通过在我的 DGV 的 DefaultValuesNeeded() 事件中执行以下操作来将前一行中的值复制到新行中：

```
private void dataGridViewPlatypi_DefaultValuesNeeded(object sender, DataGridViewRowEventArgs args)
{
    dataGridViewRow dgvr = args.PreviousRow;
    args.Row.Cells[1].Value = dgvr.Cells[1].Value;
    args.Row.Cells[2].Value = dgvr.Cells[2].Value;
    args.Row.Cells[3].Value = dgvr.Cells[3].Value;
    args.Row.Cells[4].Value = dgvr.Cells[4].Value;;
    args.Row.Cells[5].Value = dgvr.Cells[5].Value;
} 
```

...但是，我不知道是否可以以编程方式推断前一行（我一厢情愿地认为上面没有 args 的“PreviousRow”属性）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:44:17.673

这并不能完全回答我提出的问题，因为它一次只复制一个单元格，而不是整个行，但它确实适合我的目的（从单元格复制到第一行的左侧，然后从单元格此后）：

这有效：

```
private void dataGridViewPlatypi_CellEnter(object sender,   DataGridViewCellEventArgs args)
{
    string prevVal = string.Empty;
    if (args.RowIndex > 0)
    {
        prevVal = dataGridViewPlatypi.Rows[args.RowIndex - 1].Cells[args.ColumnIndex].Value.ToString();
    } else if (args.ColumnIndex > 1)
    {
        prevVal = dataGridViewPlatypi.Rows[args.RowIndex].Cells[args.ColumnIndex-1].Value.ToString();
    }
    dataGridViewPlatypi.Rows[args.RowIndex].Cells[args.ColumnIndex].Value = prevVal;
} 
```

# javascript - Javascript函数用锚href替换数组

> ID：12573593
> 
> 赞同：2
> 
> 时间：2012-09-24T22:06:18.373
> 
> 标签：javascript, php, html

我实际上是在尝试复制 Facebook 的“@”标签风格。大部分已经做了。我现在唯一的问题是标记多个用户时。它不分配`<a href>`. 假设我写了一篇只有 1 个标签用户的帖子，它的放置`<a href>`是可以的。当谈论标记超过 1 个人时，最后一个标记用户只得到`<a href>`，而没有其他人。我不得不承认我是 Web 开发的新手，而且我对 JS 和 jQuery 还不是很擅长。我真的需要在 JavaScript 部分解决这个问题的帮助。

**索引.html**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FB TAG</title>
<style>
.namesearch {
    cursor: pointer;
}
textarea {
    margin-top: 10px;
    margin-left: 10px;
    width: 650px;
    resize: none;
    font-family: Arial, Helvetica, sans-serif;
    padding-left: 10px;
    padding-top: 10px;
    min-height: 30px;
    font-size: 14px;
    word-wrap: break-word;
}
#wallpost {
    height: 600px;
    width: 600px;
    margin-top: 22px;
    border-top-style: dotted;
    border-right-style: dotted;
    border-bottom-style: dotted;
    border-left-style: dotted;
    border-top-width: thin;
    border-right-width: thin;
    border-bottom-width: thin;
    border-left-width: thin;
}
</style>
<script type="text/javascript" src="js/jquery-latest.js"></script>
<script type="text/javascript" src="http://api.jquery.com/scripts/events.js"></script>
</head>

<body>
<form >
  <textarea name="data[UserDiscussionComment][comment]" class="textarea" id="searchbar" style="color: black; height: 18px; "></textarea>
  <input name="" type="button" value="Submit" onclick="submitwallpost()" />
  <div id="livesearch"></div>
</form>
<div id="wallpost"> </div>
<script type="text/javascript">

function showResult(str)
{
    if (str.length==0)
    {
        document.getElementById("livesearch").innerHTML="";
        document.getElementById("livesearch").style.border="0px";
        return;
    } 
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("livesearch").innerHTML=xmlhttp.responseText;
            document.getElementById("livesearch").style.border="1px solid #A5ACB2";

        }
    }
    xmlhttp.open("GET","getuser.php?q="+str,true);
    xmlhttp.send();
}

var start=/@/ig; // @ Match
var word=/@(\w+)/ig; //@abc Match
var odo = "odo";

var lobot;
var fullnamewp =new Array();
var userlink =new Array();
var arraycontroller = 0; 

$("#searchbar").on("keyup",function() 
{
    var content=$(this).val(); //Content Box Data
    var go= content.match(start); //Content Matching @
    var name= content.match(word); //Content Matching @abc

    var searchname = name.toString().substr(1);

    if(name.length>0)
    {

        //alert(odo);

        $("#livesearch").show();

        showResult(searchname);

        odo = "burugudoy";

    }

    return false();
});

function putin_livesearch(fname, lname) 
{
    //alert(arraycontroller);

    userlink.push(fname+"."+lname); //adds an entry in userlink array

    fullnamewp.push(fname+ " " +lname); // adds an entry fullnamewp in array

    var old=$("#searchbar").val(); //gets  value of searchbar

    var content=old.replace(word,""); // replaces the @ in old to ""

    $("#searchbar").val(content); //replaces value of searchbar to value of content

    var fullname = $('#searchbar').val()+ fullnamewp[arraycontroller]; //adds the full name to the searchbar

    $('#searchbar').val(fullname); //adds fullname to search bar 

    $("#livesearch").hide(); //hides the live search div

    lobot= $("#searchbar").val().replace(fullnamewp[arraycontroller],"<a href = 'http://classoncloud.org/" + userlink[arraycontroller] + "'>" + fullnamewp[arraycontroller] +"</a>");

    //alert(userlink);
    //alert(fullnamewp);

    arraycontroller = arraycontroller + 1;

    //alert(lobot);

}

function submitwallpost()
{   
    $("#searchbar").val(lobot);

    alert(lobot);

    $('#wallpost').append("<div>"+ $("#searchbar").val() + "</div>");

    $("#searchbar").val("");

}

</script>
</body>
</html> 
```

**php 文件 getuser.php**

```
<?php
$q=$_GET["q"];

$con = mysql_connect('localhost', 'root', '');
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("asd", $con);

$sql=" SELECT * FROM profiles WHERE firstname like '".$q."%' ";

$result = mysql_query($sql);

while($row = mysql_fetch_array($result))
  {
  $fname = $row['firstname'];
  $lname = $row['lastname'];

  echo '<span class ="namesearch" onclick="putin_livesearch(\''.$fname.'\',\''.$lname.'\'  )"> '. $fname ." ". $lname .' </span><br />';

  //echo "<span class ='namesearch' onclick='putin_livesearch(" .$fname. ", " .$lname. " )'> " . $fname . " " . $lname . "</span><br />";
  }

mysql_close($con);
?> 
```

# ruby-on-rails - 供应商/捆绑包的目的是什么？Heroku 告诉我删除它

> ID：12573596
> 
> 赞同：29
> 
> 时间：2012-09-24T22:06:44.870
> 
> 标签：ruby-on-rails, heroku, ruby-on-rails-3.2, bundler

在向 Heroku 推送一些更改后，我注意到一个警告`vendor/bundle`（请参阅下面的**警告**）。

如果根据警告，该目录应该从 Git 跟踪中“删除”，那么该目录的目的是什么？

为什么Rails 默认不`vendor/bundle`自动'd ？`.gitignore`

我应该跑`bundle pack`吗？（真的`bundle package`吗？？）

`bundle pack`（相对于`development`和）的优缺点是什么`production`？

更令人困惑的是，有一篇由 Ryan McGeary 撰写的热门博客文章，标题为[“Vendor Everything”Still](http://ryan.mcgeary.org/2011/02/09/vendor-everything-still-applies/) Applys，强烈主张通过running 运行`bundle install --path vendor`和`echo 'vendor/ruby' >> .gitignore`打包 gems 。与我的其他问题相关的任何有关此问题的信息将不胜感激。`vendor/cache``bundle package`

谢谢你。

```
-bash> git push production master
...

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> WARNING:  Removing `vendor/bundle`.
       Checking in `vendor/bundle` is not supported. Please remove this directory
       and add it to your .gitignore. To vendor your gems with Bundler, use
       `bundle pack` instead.
-----> Installing dependencies using Bundler version 1.2.1
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Using rake (0.9.2.2)
       Using i18n (0.6.0)
       ... 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-26T12:40:42.230

如果您`vendor/bundle`的项目中有目录，那么在某些时候[您必须运行`bundle`带有`--path vendor/bundle`参数](https://bundler.io/v2.1/man/bundle-install.1.html)的命令。这会将所有项目 gem 的文件（列在 中`Gemfile`）加载到`vendor/bundle`本地项目的目录中，而不是加载到系统 gem 位置。您将这样做是为了将项目的 gem 与任何其他项目完全隔离开来。

Bundler 擅长解决所有依赖项，因此没有必要使用 Bundler，`--path`但有些人选择这样做是因为他们希望将他们的 gem 与他们的项目分开并组织起来。这也意味着本地机器上的 bundler 的设置方式与 Heroku 使用 bundler 的方式相同。

使用此选项，您[`rubygems`](https://rubygems.org/)每次运行`bundle`命令时仍会从服务器下载所有 gem。

[`bundle package`](http://gembundler.com/bundle_package.html)更进一步，实际上从下载原始 gem 文件`rubygems`并将它们缓存到`vendor/cache`目录中。这意味着您不再需要连接`rubygems`来运行 bundle 命令，因为它将使用打包文件作为源。如果您需要更新 gem 版本，那么它需要`rubygems`在第一次请求时连接以收集新版本。使用`bundle package`当然需要额外的磁盘空间，这取决于情况可能会或可能不会成为问题。每次推送到 Heroku 时，它还会增加部署时间和带宽需求。

Heroku`bundle`每次都会运行命令`git push`，读取`Gemfile.lock`并安装应用程序运行所需的 gem。默认情况下`--path vendor/bundle`使用该选项。这样每个应用程序都有一组与 Heroku 上的所有其他应用程序分开的 gem 文件。如果您`vendor/bundle`在源代码管理中拥有该目录并将其推送到 Heroku，那么您可以看到存在重大冲突的可能性，因为它会尝试将 gem 加载到`vendor/bundle`已经存在的目录中。如果它被推送，那么 Heroku 会在`vendor/bundle`运行之前删除目录`bundle install`以消除这些潜在的冲突。如果是这种情况，那么您将通过保留`vendor/bundle`版本控制来浪费部署时间和带宽，最好将其添加到您的`.gitignore`.

如果您想完全控制 Heroku 上的 gem，请使用该`bundle package`命令并确保该`vendor/cache`目录处于源代码控制之下。当 Heroku 运行`bundle install`时，它将使用 的内容`vendor/cache`作为 gem 源，而不是使用`rubygems`. 这是否有用取决于个人喜好、您正在构建的应用程序类型以及您更新 gem 的频率。Ryan McGeary 的帖子表明，`bundle package`如果旧的 gem 在未来某个时候变得不可用，使用很有用。对于不定期更新的项目/应用程序来说，这似乎是一个更大的问题。

从我的角度来看，我通常会使用`--path vendor/bundle`尽可能接近 Heroku 的本地设置。我放入`vendor/bundle`我的项目`.gitignore`文件中，并且我不*打包*gem，因为我的项目相对定期更新。

Rails 的文件非常有限`.gitignore`。实际上，您应该自己建立自己需要的东西，这就是`vendor/bundle`默认情况下不包括在内的原因。

我认为 Heroku 的意思是`bundle package`当他们说`bundle pack`.

# asp.net-mvc-3 - 从下拉列表中选择语言 - MVC3

> ID：12573599
> 
> 赞同：3
> 
> 时间：2012-09-24T22:06:59.333
> 
> 标签：asp.net-mvc-3, razor, localization

几天来，我一直在努力实现一个组合框来让用户选择语言。我正在使用 MVC 3 并从[这篇文章](http://www.codeproject.com/Articles/207602/Creating-a-Bilingual-ASP-NET-MVC3-Application-Part)开始，它在 URL 中嵌入了语言。我喜欢这种方法，但我不想为每种语言提供链接，而是让用户从下拉列表中选择一种语言。当用户选择一种语言时，我还没有弄清楚如何将 URL 重定向到当前位置 + 新语言。我天真地尝试了这个：

在 _Layout.cshtml

```
<li>
    @using (Html.BeginForm("SelectLanguage", "Home", new { url = @Request.RawUrl })) 
    { 
    <select name="lang" id="lang" size="1" onchange="changeLanguage(this)">
        <option value="en">English </option>
        <option value="it">Italian (Italian)</option>
        <option value="es">Español (Spanish)</option>
    </select>
    }
</li> 
```

在 HomeController.cs

```
static void AddOtherValues(RouteData routeData, RouteValueDictionary destinationRoute)
{
    foreach (var routeInformation in routeData.Values)
    {
        if (routeInformation.Key == GlobalizedRoute.CultureKey)
            continue; //Do not re-add, it will throw, this is the old value anyway.
        destinationRoute.Add(routeInformation.Key, routeInformation.Value);
    }
}

public ActionResult SelectLanguage(string url, string language, RouteData route)
{
    RouteValueDictionary globalizedRouteData = new RouteValueDictionary();
    globalizedRouteData.Add(GlobalizedRoute.CultureKey, language);
    AddOtherValues(RouteData, globalizedRouteData);

    return RedirectToRoute(globalizedRouteData);

} 
```

但是，愚蠢的我，`RouteData`在`SelectLanguage`contains`HomeController`和`SelectLanguage`中，而不是我选择新语言时的路线数据。所以`SelectLanguage`是无限递归的。我想做的是每当用户选择另一种语言时将电流传递`RouteData`给`SelectLanguage`动作，但我还没有弄清楚如何。传入`route = ViewContext.RouteData`to`BeginForm`不起作用，因为它只是一个字符串。（表单的渲染 html`route=System.Web.Routing.RouteData`是无用的。）我刚刚发现[这篇文章](http://www.wiredprairie.us/blog/index.php/archives/1171)展示了如何将路由数据导入 JavaScript，我认为我可以（以某种方式）将它注入到我的表单中，但这有必要吗？感觉就像路线数据不必要的往返。对于这种方法，我是否缺少一些简单的东西，甚至是更简单的解决方案？

编辑——刚刚注意到缺少超链接，这使得任何人都很难知道我在说什么。添加了，所以希望人们会开始提供输入:)

# ruby - watir 找不到带有在弹出窗口中给出的类名的链接（div 弹出窗口 - 不是新窗口）

> ID：12573602
> 
> 赞同：0
> 
> 时间：2012-09-24T22:07:13.403
> 
> 标签：ruby, watir, watir-webdriver

```
 $browser.links.each do |link|
          puts link.attribute_value("class")
          if link.attribute_value("class")=='btn btn-success nextStep'
            link.click
          end
        end 
```

上面的代码打印了链接的所有类名（耶......）但是当它触发 btn btn-success nextStep 的点击事件时 - 它说元素不可见。如果我添加`when_present.click`...超时。

```
Error:
btn btn-success nextStep
[remote server] file:///var/folders/3w/b7rcpqfj7kl3wtv56jt99yx00000gn/T/webdriver-profile20120924-3889-1erbmdf/extensions/fxdriver@googlecode.com/components/command_processor.js:5908:in `unknown': Element is not currently visible and so may not be interacted with (Selenium::WebDriver::Error::ElementNotVisibleError) 
```

我试过了

> $browser.link(:class,'nextStep').when_present.click
> 
> $browser.link(:class,'nextStep').click

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T08:38:49.007

好吧，错误消息说该元素不可见。您可以从不可见的元素中获取类属性的值，但不能单击它。

# ffmpeg - 使用 ffmpeg 从电影文件创建的 GIF 非常大

> ID：12573604
> 
> 赞同：8
> 
> 时间：2012-09-24T22:07:23.763
> 
> 标签：ffmpeg, gif, mp4

`ffmpeg`我使用以下命令创建了一个 GIF ：

`ffmpeg -i foo.mp4 -ss 00:00:18 -t 00:00:06 -pix_fmt rgb24 bar.gif`

但是，生成`bar.gif`的文件大小超过 300 MB，而电影文件`foo.mp4`约为 15 MB！

是什么赋予了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T22:23:31.743

很难全面回答这个问题：-p 简而言之，归结为每种格式的压缩是如何完成的。

在 GIF 动画中，每一帧在概念上都是一个单独的 GIF 图像。然后，所有 GIF 图像都存储在一个大的 GIF 文件中，并带有播放帧的指令，帧之间有一定的延迟。要优化帧，您可以通过一个程序运行 GIF，该程序可以删除从一帧到下一帧的重复信息（GIMP“动画优化”过滤器是一个很好的方法：[GIMP - 简单动画](http://www.gimp.org/tutorials/Simple_Animations/)）。

另一方面，像 MP4 这样的视频格式有不同的方法。他们假设帧将是相似的，并且只存储两个帧之间的差异。此外，每帧的数据量仅限于开始压缩时给定的指定视频比特率。执行有损压缩以将视频文件降低到所需的比特率。为了进一步优化视频文件，大多数视频转码器都包含“二次编码”选项。这会在视频中运行两次：第一次它只是收集有关文件中哪些部分更复杂的信息，然后第二次它更积极地压缩视频中每个不复杂的部分。

作为视频编码过程的一部分，还有许多其他优化在 GIF 文件格式中完全缺失。此外，值得指出的是，GIF 动画将被限制为 256 色调色板，这可能会导致图像抖动。MP4 对视频帧使用更类似于 JPEG 压缩的东西（尽管有专门针对视频的额外优化……旧的 MJPEG 格式基本上只是一堆 JPEG 图像，就像 GIF 动画是一堆 GIF 图像一样）。

如果您可以提供有关您的特定用例的更多信息，我们或许可以帮助您找到更好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-01T10:12:24.893

我同意你的看法，使用这个命令不是最优的：

```
avconv -i input.mp4 -pix_fmt rgb24 output.gif 
```

在此转换后使用 Gimp 如下：

![在此处输入图像描述](../Images/719dc8f7c0bfeaf207fdc54eee092cfa.png)

# android - 通过 MainActivity 添加 webview

> ID：12573612
> 
> 赞同：1
> 
> 时间：2012-09-24T22:08:07.553
> 
> 标签：android, webview

如果可能，如何仅使用 MainActivity.java 类文件中的代码将 webview 添加到我的布局中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:39:39.300

```
WebView webView = new WebView(this);
*setting up webview* 
setContentView(webview); 
```

或者

```
ViewGroup yourLayout = (ViewGroup) LayoutInflater.from(this).inflate(R.layout.your_layout, null); 
setContentView(yourLayout);

WebView webView = new WebView(this);
*setting up webview*    
yourLayout.addView(webView); 
```

# php - Wordpress + .ajaxForm 无法读取 POST 或 SESSION

> ID：12573613
> 
> 赞同：0
> 
> 时间：2012-09-24T22:08:20.393
> 
> 标签：php, ajax, wordpress

我在 Wordpress 中的 functions.php 文件中设置了会话。我正在使用[ajaxForm](http://www.malsup.com/jquery/form/)将 Wordpress 页面上的表单提交给自身。Firebug 告诉我我正在正确提交我的 $_POST，但我无法在页面本身上访问它。我正在尝试将在该页面上设置的会话值与发布回页面的 POST 值进行比较。我可以看到将会话值输出到页面，但尽管 Firebug 告诉我，我无法输出 POST。

想法？

这是一些代码：

AJAX

```
 jQuery('#contactform').ajaxForm({
  url: 'http://www.someURLhere.com/wp-content/themes/bahrmanlaw/loop-page.php',
  type: 'POST',
  beforeSubmit: function() {
    jQuery('#contactform').validate();
    return jQuery('#contactform').valid();
  },
  success: function() {
    jQuery('#lookpage').hide();
    jQuery('#message').fadeIn(1500, function() {});
  }
  }); 
```

HTML

```
<form name="contact" action="" id="contactform" method="post">
    <fieldset>
      <label for="fullname" id="fullname_label">Name:</label>
      <input type="text" name="fullname" id="fullname" title="Please enter a valid name." class="required" />
      <input type="image" class="button" id="button" src="<?php echo get_stylesheet_directory_uri().'/images/send.png'; ?>" />
    </fieldset>
</form> 
```

PHP

```
<?php echo $_POST['fullname']; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-11T12:50:00.843

我可以用这个来阅读它：

```
<?php 
    $request_body = file_get_contents('php://input'); 
    var_dump($request_body); 
?> 
```

有必要解析它，但二进制数据在那里

# data-binding - Windows 8 Metro 应用程序集合视图源数据绑定问题

> ID：12573614
> 
> 赞同：4
> 
> 时间：2012-09-24T22:08:22.810
> 
> 标签：data-binding, gridview, windows-8, windows-runtime, winrt-xaml

我有一个collectionviewsource

```
<CollectionViewSource x:Name="groupedItemsViewSource" 
                          ItemsPath="Items" /> 
```

并将其作为 itemssource 提供给 gridview

```
ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}" 
```

源代码在文件后面的代码中设置：

```
groupedItemsViewSource.Source = AllGroups; 
```

和 AllGroups 是

```
public ObservableCollection<DataGroup> AllGroups 
```

其中 DataGroup 包含一个 Observable 项目集合

```
 public ObservableCollection<DataItem> Items 
```

问题是它不显示带有项目的组，而是我只得到 3 个 gridviewitems，它们对应于 AllGroups 中的 3 个数据组

我尝试添加 IsSourceGroupped = "true"，但是当我这样做时，应用程序崩溃，出现一个窗口，显示“myapp.exe [3192] 中发生未处理的 win32 异常”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T09:20:28.037

看起来您所缺少的只是 CollectionViewSource 上的 IsSourceGrouped="true" 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T08:20:01.600

CollectionViewSource 中的 Source 属性应该实现 IGrouping 接口，否则这些组将无法在 GridView 或 ListView 中工作。
使用 Linq 表达式 GroupBy 将您的结果分组到具有指定键的组中，或者您可以像这样扩展 ObservableCollection 类：

```
public class GroupedObservableCollection<T> : ObservableCollection<T>, IGrouping<string, T>
{
    /// <summary>
    /// Key as the Group identificator.
    /// </summary>
    public string Key { get; set; }
} 
```

并在您的课程中使用它（我在 ViewModel 中有 CollectionViewSource，而不是在 XAML 中）：

```
public GroupedObservableCollection<DataItem> Items

groupedItemsViewSource = new CollectionViewSource { Source = AllGroups, ItemsPath = new PropertyPath("Items"), IsSourceGrouped = true }; 
```

这样绑定就可以工作了。还要确保在 ListView 和 GridView 中使用正确的绑定：

```
<!-- zoomed in view -->
<GridView ItemsSource="{Binding groupedItemsViewSource.View}" ... />

<!-- zoomed out view -->
<GridView ItemsSource="{Binding groupedItemsViewSource.View.CollectionGroups}" ... /> 
```

# c++ - ARB_occlusion_query 使用导致 OpenGL 出现“无效枚举”错误

> ID：12573618
> 
> 赞同：1
> 
> 时间：2012-09-24T22:08:51.880
> 
> 标签：c++, opengl

我目前正在开发一个使用 ARB_occlusion_query 扩展的项目。我已经正确注册了扩展，我可以生成查询，然后我启动一个并在渲染后调用 EndQuery 函数，但这似乎给了我“无效枚举”的错误。我在这里检查了 speq： [http ://www.opengl.org/registry/specs/ARB/occlusion_query.txt](http://www.opengl.org/registry/specs/ARB/occlusion_query.txt)

我按如下方式调用 EndQueries：

```
glEndQuery( GL_SAMPLES_PASSED_ARB ); 
```

所有这些似乎都是有效的，但它一直给我一个错误代码，指出“无效枚举数”，错误代码 1280。

我一直在为我所做的每个 OpenGL 调用添加错误检查，以确保错误不是来自其他任何地方，并且我已将其隔离到本节。我生成查询如下：

```
glGenQueries( size, (GLuint*)m_QueryID); 
```

其中 size 是（目前）硬编码值 10，m_QueryID 是一个无符号整数数组，大小再次为 10。

唯一似乎出错的地方是 glEndQuery 调用。作为回报，它给了我“无效的枚举数”。所有其他调用，例如获取结果、开始查询并最终删除它们都很好。

我的循环如下：

```
glBeginQuery( GL_SAMPLES_PASSED_ARB, m_QueryID[0] ); 
*render some models here*
glEndQuery( GL_SAMPLES_PASSED_ARB ); 
```

在那之后我会得到结果，因为我在 glEndQuery 调用中遇到错误，所以我现在什么都不做。

根据 speq 中的错误代码，它说：

> 如果目标不是 GL_SAMPLES_PASSED，则生成 GL_INVALID_ENUM。

这意味着我没有在那里传递 GL_SAMPLES_PASSED ，我就是这样。我什至尝试不使用 ARB，但当然没有改变，同样的事情仍然抱怨无效的枚举数。

# objective-c - UIPickerView 的组件宽度是否手动调整？

> ID：12573620
> 
> 赞同：1
> 
> 时间：2012-09-24T22:09:05.530
> 
> 标签：objective-c

我制作了 UIPickerView 并添加到 viewcontroller'view 中。

我手动调整了pickerview的宽度。

当您查看图片时，组件的内容宽度和组件宽度之间不匹配，并且

pickerview 的宽度和组件宽度。

有没有像 UILabel 的 sizeToFit 这样的方法？

```
expected code is :
    - (CGFloat)pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component {
        switch(component) {
            [pickerView.label sizeToFit];
        }
    }

================= Following is mycode ====================================================
- (void)viewDidLoad {

    self.view.backgroundColor = [UIColor scrollViewTexturedBackgroundColor];

    [super viewDidLoad];

    UIPickerView *pickerView = [[[UIPickerView alloc] initWithFrame:CGRectMake(0, 0, 200, 200)] autorelease];
    pickerView.dataSource = self;
    pickerView.delegate = self;
    pickerView.showsSelectionIndicator = YES;

    [self.view addSubview:pickerView];

    activities = [[NSArray alloc] initWithObjects:@"sleeping", @"eating", @"working", @"studying", @"walking", @"thinking", @"considering", @"testing", @"talking", nil];
    feelings = [[NSArray alloc] initWithObjects:@"awesome", @"sad", @"happy", nil];

}

- (CGFloat)pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component {
    switch(component) {
        case 0: return 100;
        case 1: return 200;
    }
} 
```

![在此处输入图像描述](../Images/12605af69b4630933f1a93e165ef5938.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T05:41:22.863

试试我的解决方案..我从来没有设置过每个组件的宽度和高度......UIPickerview 自己维护......所以我不必担心这个......试试这个只是评论名为“widthForComponent”的整个方法并确保您已正确使用所有这些 Picker 方法。“numberOfComponentsInPickerView”、“numberOfRowsInComponent”和“titleForRow”然后再次运行项目...让我知道它是否会解决您的问题

好的，现在看到 uipickerview 需要以下方法......你想要一些代码，那么这里就是

```
- (void)pickerView:(UIPickerView *)pV didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    // you're code for when user select any item from picker
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 2;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{ 
    if(component == 0)
        return [activities count];
    else if(component == 1)
        return [feelings count];

}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
    if(component == 0)
        return [activities objectAtIndex:row];
    else if(component == 1)
        return [feelings objectAtIndex:row];
    else
           return @"";
} 
```

# php - unicode 支持的单元测试

> ID：12573621
> 
> 赞同：1
> 
> 时间：2012-09-24T22:09:12.230
> 
> 标签：php, unicode, encoding, utf-8

我正在尝试转换为 unicode 并创建一些单元测试以确保 unicode 正常工作。

这是我当前的代码，它在 mb_detect_encoding() 行上失败，我也不确定它是否是对 unicode 支持的有效测试：

```
 function testMultiLingualEncodings(){
        // Create this string via a heredoc.
        $original = '
        A good day, World!
Schönen Tag, Welt!
Une bonne journée, tout le monde!
يوم جيد، العالم
좋은 일, 세계!
Một ngày tốt lành, thế giới!
こんにちは、世界！
'; // Contains international characters from utf-8
        $this->assertTrue(mb_detect_encoding($original, 'UTF-8', true) === true); // Fails regardless of whether strict is true or not.
        $returned = query_item("select :multi limit 10", array(':multi'=>$original)); // Select this exact string, parameterized, from the database
        //debug($returned, string_diff($returned, $original));
        $this->assertTrue((bool)$original); // test original isn't null.
        $this->assertTrue((bool)$returned); // Test returned string isn't null.
        $this->assertTrue($original === $returned); // Test original exactly matches returned string
    } 
```

所以 mb_detect_encoding() 表示上面的初始字符串不是 UTF-8。我也在尝试将该字符串传递到数据库中并将其取出，然后与原始字符串进行比较。但是，我不确定这是否是对数据库连接编码的有效测试。

所以总的来说，我怎样才能为 utf-8 支持创建一个单元测试，上面的方法是否可以修改来解决这个目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:50:54.853

对不起，但这没有意义。您的测试文件以一种格式编码。您放入测试字符串的任何内容都将以与文件相同的方式进行编码。我也不会依赖 mb_detect_encoding 函数。让我们采用以下字符串：“abcde”。它可以是 ASCII 或 UTF-8。你无法判断，因为没有特殊字符。编码是一种节制数据的方式。

//编辑

使您的测试工作完成`$this->assertTrue(mb_detect_encoding($original, 'UTF-8') === 'UTF-8')`

# html - 模糊文本直到鼠标悬停？

> ID：12573624
> 
> 赞同：0
> 
> 时间：2012-09-24T22:09:16.663
> 
> 标签：html, css, css-transitions

基本上这发生在我的主题中：[单击此处查看示例](http://i48.tinypic.com/2iv1wjs.png)。

当我将鼠标悬停在它上面时，它很快就会变得清晰明了。当我将类元素添加到我的 html 时，我注意到这个问题开始出现，如下所示：

```
a.navigation{
    color: {color:text};
    font-family: 'Georgia', sans-serif;
    font-size:15px;
    text-transform:lowercase;
    letter-spacing:2px;
}
a.navigation:hover:{
    color: {color:hover} !important;
    cursor: crosshair;
    text-decoration:none;
}
<a href="/" class="navigation">Entries</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/ask" class="navigation">Message</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/archive" class="navigation">Records<a/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/rss" class="navigation">Feed</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/theme" class="navigation">Theme</a> 
```

任何想法为什么此链接可能会影响我主题中的其他链接？非常感谢。对不起，如果这是一个初学者问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:21:23.897

我不确定，但你的 css 有一些错误：

```
a.navigation{
color: {color:text};
font-family: 'Georgia', sans-serif;
font-size:15px;
text-transform:lowercase;
letter-spacing:2px;
}
a.navigation:hover:{
color: {color:hover} !important;
cursor: crosshair;
text-decoration:none; 
```

这是什么`color: {color:text};`和`color: {color:hover} !important;`？？？应该是`color: blue;`例如。

这里还有另一个“：” `a.navigation:hover:{`。它应该是`a.navigation:hover{` 你忘了关闭`a.navigation:hover{ }`

如果有帮助请回复

```
a.navigation{
    color: blue;
    font-family: 'Georgia', sans-serif;
    font-size:15px;
    text-transform:lowercase;
    letter-spacing:2px;
}

a.navigation:hover{
    color: red !important;
    cursor: crosshair;
    text-decoration:none;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:21:58.017

我不相信`color: {color:hover}`是有效的CSS。你可能想从那里开始。

# javascript - 用jquery改变div的高度

> ID：12573628
> 
> 赞同：1
> 
> 时间：2012-09-24T22:09:38.710
> 
> 标签：javascript, jquery, html

出于某种原因，当我尝试使用 jquery 更改 div 的高度时，它不起作用。我使用的代码是这样的：

```
<div id="wrapdiv" style="height:2000px">
    ....
</div>

console.log(total);  // yields 1500
changediv = "wrapdiv";
$("#" + changediv).css('height', total); 
```

无论我做什么，它都不会将高度更改为 1500px。console.log 显示变量设置正确。即使我在 Chrome 的控制台中输入赋值语句，它也会改变高度。如果重要的话，div 里面有一个 iframe。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:12:17.513

你不能简单地只为高度输入一个数值。你必须这样做：

```
<div id="wrapdiv" style="height:2000px">
    ....
</div>

console.log(total);  // yields 1500
changediv = "wrapdiv";
$("#" + changediv).css('height', total + 'px'); 
```

或者你可以这样做：

```
<div id="wrapdiv" style="height:2000px">
    ....
</div>

console.log(total);  // yields 1500
changediv = "wrapdiv";
$("#" + changediv).height(total); 
```

[JSFiddle链接1](http://jsfiddle.net/s652Z/2/)

[JSFiddle链接2](http://jsfiddle.net/s652Z/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:24:14.090

```
var total = 1500;
var changediv = "wrapdiv";

$("#" + changediv).height(total);
alert($("#" + changediv).height()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-10T05:33:17.450

[jquery-textfill](https://jquery-textfill.github.io/)可能会解决您的问题。通过使用此文本大小将以这种方式调整，它将填充最大的整个容器 div。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-24T22:11:33.810

你应该寻找谷歌... ^^ 这是它： [http ://api.jquery.com/height/](http://api.jquery.com/height/)

`$('#yourDiv').height(100);`

# ios - 在 iOS 上使用 SHA256 散列

> ID：12573630
> 
> 赞同：3
> 
> 时间：2012-09-24T22:09:54.900
> 
> 标签：ios, iphone, encryption, hash, sha256

我已经看过至少 6 页关于 iOS 和 SHA256 的 SO，但我仍然无法弄清楚发生了什么。

通常，我习惯于在 PHP 中使用该`hash()`函数执行 SHA256，它返回一个字符串值，例如：`db1204372d8d9f14acc608b497227047d63ad868987883d0a29198be8e6ce853`

我正在尝试在我的 iOS 应用程序中实现 SHA256，以加强应用程序和服务器之间的安全性，但编码部分让我头疼......

我正在使用 NSData 类别：

```
+ (NSData *)sha256:(NSData *)data {

NSMutableData *out = [NSMutableData dataWithLength:CC_SHA256_DIGEST_LENGTH];

CC_SHA256(data.bytes, data.length,  out.mutableBytes);

if ( CC_SHA256(data.bytes, data.length, out.mutableBytes) ) return out;

return nil;
} 
```

但是，无论我如何尝试将生成的 NSData 对象编码为 NSString （发送到服务器），我最终都会得到这样的字符串`ã°ÄBüûôÈo¹$'®AädL¤xR¸U`

我的问题 - 如何实现与 行为相同的类别，`hash`以便将相同的值传递给任一方法应该产生相同的值？

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-20T03:35:07.700

对不起，我参加聚会很晚了。

从 php 得到的结果是每个字节的十六进制值的串联。您从 ios 获得的值是实际的字节字符串。

我怀疑你正在使用类似的东西`[[NSString alloc] initWithData:theData encoding:NSUTF8StringEncoding]`来获取字符串。

但是您应该转换`NSData`为您需要使用的形式`[data description]`，如[如何将 NSdata 转换为十六进制字符串？](https://stackoverflow.com/questions/16521164/how-can-i-convert-nsdata-to-hex-string).

# authorization - 如何从 GoogleCredential 获取访问令牌？

> ID：12573635
> 
> 赞同：27
> 
> 时间：2012-09-24T22:10:15.603
> 
> 标签：authorization, google-api, oauth-2.0, credentials, access-token

我正在尝试获取访问令牌以使用 Google Play Android Developer API，而我使用[Google API Java Client 文档示例](https://code.google.com/p/google-api-java-client/wiki/OAuth2#Service_Accounts)已经做到了这一点：

```
HttpTransport HTTP_TRANSPORT = new NetHttpTransport();
JsonFactory JSON_FACTORY = new JacksonFactory();

GoogleCredential credential = new GoogleCredential.Builder()
    .setTransport(HTTP_TRANSPORT)
    .setJsonFactory(JSON_FACTORY)
    .setServiceAccountId("...gserviceaccount.com")
    .setServiceAccountScopes("https://www.googleapis.com/auth/androidpublisher")
    .setServiceAccountPrivateKeyFromP12File(keyFile)
    .build(); 
```

但是如何从这个凭证中获取访问令牌？`credential.getAccessToken()`返回`null`。我做错了什么，还是错过了一些步骤？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-25T14:49:10.907

知道了。您必须在 credential.getAccessToken() 之前调用 credential.refreshToken()。它没有在文档中的任何地方说明这一点，但这就是它的作用。

```
credential.refreshToken();
accessToken = credential.getAccessToken(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-08-08T00:32:23.967

如果您使用`ServiceAccountCredentials.fromStream()`创建凭证对象，您可能也必须调用该`createScoped()`方法。

```
 FileInputStream fileInputStream = new FileInputStream(KEY_FILE_PATH);
    GoogleCredentials credentials = ServiceAccountCredentials.fromStream(fileInputStream);
    credentials = credentials.createScoped(SCOPES);
    AccessToken accessToken = credentials.refreshAccessToken(); 
```

否则你会得到错误

> java.io.IOException：未为服务帐户配置范围。范围应通过调用 createScoped 或将范围传递给构造函数来指定。

# java - 我在 ListView 中有一个自定义单元格。我怎样才能让它在触摸时突出显示？

> ID：12573648
> 
> 赞同：0
> 
> 时间：2012-09-24T22:11:04.467
> 
> 标签：java, android, android-listview

我希望我的 ListView 中的单元格在触摸时突出显示（就像它们通常使用未修改的 ListView 一样）。我如何使用我修改过的单元格来做到这一点？

这是我的单元格的样子：

![在此处输入图像描述](../Images/2bbace42eedf80f93ddcdcb594471869.png)

这是我的单元格的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content">

  <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="fill_parent"
        android:layout_height="34dip"
        android:stretchColumns="0"
        android:divider="@null"       
         >

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/plaincell"
            android:divider="@null"  >

            <TextView
                android:id="@+id/txtKey"
                android:text="Some text"
                android:textSize="16dip"
                android:textStyle="bold"
                android:layout_marginLeft="8dip"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="left|center_vertical"
                android:layout_weight="1.0"
                android:layout_marginTop="6dp"
                android:layout_marginBottom="6dp"
                android:textColor="@color/black"
            />

            <TextView
                android:id="@+id/txtValue"
                android:text="Some text"
                android:textSize="16dip"
                android:layout_marginRight="8dip"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="right|center_vertical"
                android:layout_weight="1.0"
                android:layout_marginTop="6dp"
                android:layout_marginBottom="6dp"
                android:textColor="@color/darkblue"
            />

        </TableRow>

  </TableLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:18:21.603

使您的 LinearLayout 的背景成为可绘制的选择器

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:drawable="@drawable/myClickedStateDrawable" android:state_pressed="true" />
   <item android:drawable="@drawable/myNonClickedStateDrawable" />
</selector> 
```

其中 myClickedStateDrawable、myNonClickedStateDrawable 是定义布局背景的可绘制对象

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:21:05.523

您的背景可绘制对象应该是一个[状态列表](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)，对于不同的状态（例如，按下、聚焦，两者都没有）具有不同的图形。

编辑：要使用纯色，您可以这样做：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:drawable="@color/pressedcolor" android:state_pressed="true" />
   <item android:drawable="@color/unpressedcolor" />
</selector> 
```

然后，您可以在资源文件中定义自己的颜色：

```
<resources>
    <color name="pressedcolor">#ff0000</color>
    <color name="unpressedcolor">#0000ff</color>
</resources> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T22:34:31.903

我看到发生了什么，**但首先**：

*   大多数只有一个孩子的布局可以被删除，
*   TableLayout 和 TableRow 也都基于 LinearLayout 类。

所以实际上你有*三个*LinearLayouts 你只需要*一个*。

**问题：**
我假设这条线设置了一个覆盖整个布局的新背景颜色：

```
android:background="@drawable/plaincell" 
```

这也覆盖或覆盖了默认的 ListView 颜色选择器。如果您要更改屏幕上每个 UI 元素的背景和文本颜色属性，
您可能需要查看[样式和主题。](http://developer.android.com/guide/topics/ui/themes.html)如果您在主题中设置这些属性，那么您不需要创建新的颜色选择器来执行旧颜色选择器已经完成的操作。

# mysql - Django - '字段列表'中的'未知列'foo.bar'的行为是否改变了？

> ID：12573649
> 
> 赞同：0
> 
> 时间：2012-09-24T22:11:16.997
> 
> 标签：mysql, django, django-models

我有一个查询，我希望引发异常，`Unknown column 'foo.bar' in 'field list'`; 但是，现在在 1.4 Django 上，异常似乎被吞没了，并返回了一个空的查询集。

```
In [1]: Foo.objects.all()
Out[1]: []

In [2]: from django.db import connection

In [3]: connection.queries
Out[3]: 
[{'sql': 'SELECT ..`foo`.`bar` ...',
  'time': '0.001'}] 
```

同时，数据库中的相同查询：

```
mysql> SELECT ..`foo`.`bar` ...;
ERROR 1054 (42S22): Unknown column 'foo.bar' in 'field list' 
```

我可以恢复（我认为的）旧行为吗？

我在哪里错过了发行说明中的​​这个变化？

请注意，这不是查询集的延迟执行的问题，而是`connection.queries`有一个查询。打印查询集执行查询。

```
In [1]: from django.db import connection

In [2]: connection.queries
Out[2]: []

In [3]: q = Foo.objects.all()

In [4]: connection.queries
Out[4]: []

In [5]: print q
Out[5]: []

In [6]: connection.queries
Out[6]:
[{'sql': 'SELECT ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:46:04.077

正如我在评论中提到的，QuerySet 在 Django 中是惰性的。因此，在您尝试使用它之前，您不会收到错误消息（例如，遍历查询集）。这是文档的[链接](https://docs.djangoproject.com/en/1.4/topics/db/queries/#querysets-are-lazy)。

这不是 Django 中的新行为。您可以找到 1.1、1.2 和 1.3 的相同文档

希望这可以帮助。

# javascript - 如何在javascript中获取动态创建的标签元素的id

> ID：12573655
> 
> 赞同：3
> 
> 时间：2012-09-24T22:11:55.453
> 
> 标签：javascript, jquery, html, pug

我想在 javascript 中获取动态创建的标签的文本，该标签是用玉创建的。这是玉：

```
- for( var i = 0; i < groupsName.length; i++ ) {
  li
    a(href='JavaScript:validation(this)')
        img(src='/images/edit.png', width='60', height='60', style='margin:8px 10px 10px 20px;')  
         h3 #{groupsName[0]}
          label(for='groupsId' , id='labelid'+i ) #{groupsId[i]}
      a(href='/groupdetails') Edit  
  - } 
```

这是我的 javascript 代码：

```
 function validation(val){
   var valid=val.id;
   alert(document.getElementById(valid).innerHTML);
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:33:00.693

不确定我是否正确解释了您的模板，但只要动态标签是触发验证的锚标记的后代，这应该可以工作：

首先将 替换为`href`，`onclick`否则`this`传递的将引用`window`。生成的锚标记应如下所示：

```
<a href="javascript:void(0);" onclick="validation(this);"> 
```

然后稍微调整你的功能：

```
function validation(anchor) {
    var lbl = anchor.getElementsByTagName('label')[0];
    alert(lbl.innerHTML);
    alert(lbl.id);
}​ 
```

[**小提琴**](http://jsfiddle.net/ult_combo/6VnBr/1/)

# c# - 在多对多 .add 和 .saveChanges (System.NullReferenceException) 之后实体对象不刷新

> ID：12573657
> 
> 赞同：1
> 
> 时间：2012-09-24T22:11:59.143
> 
> 标签：c#, repository, entity

我有一个名为 VendorReader 的多对多实体，它看起来像这样：

```
public partial class VendorReader
{
    public int ID { get; set; }
    public int VendorID { get; set; }
    public string AssetValue { get; set; }

    public virtual Vendor Vendor { get; set; }
    public virtual AssetReader AssetReader { get; set; }
} 
```

我有一个 VendorReader 的存储库，它看起来像这样：

```
public class VendorReaderRepository : Repository<VendorReader>
{
    public VendorReaderRepository() { }
    public VendorReaderRepository(EventBadgesEntities ctx) : base(ctx) { }
    public List<VendorReader> GetVendorReadersByEventID(int eventID)
    {
        return ctx.VendorReaders
                   .Where(e => e.Vendor.EventID == eventID)
                   .ToList();
    }

    public int GetVendorIDByReaderSN(string readerSN) {
        VendorReader thisList = ctx.VendorReaders
            .Where(e => e.AssetReader.ReaderSN == readerSN)
            .SingleOrDefault();
        return thisList.VendorID;
    }
} 
```

在我的代码中，我这样做：

```
thisVendorReader.VendorID = model.AddEditVendorReader.VendorID;
thisVendorReader.AssetValue = model.AddEditVendorReader.AssetValue;
vrr.Add(thisVendorReader); 
```

在基本存储库中执行此操作：

```
public T Add(T entity)
{
    ctx.Set<T>().Add(entity);
    ctx.SaveChanges();
    return entity;
} 
```

然后我尝试这样做：

```
model = new MapVendorModel(model.EventID); 
```

这样做：

```
public MapVendorModel(int eventID) 
{
    // steps to create a selectlist
    VendorRepository vr = new VendorRepository();
    listVendor = vr.GetVendorsByEventID(eventID)
        .ToList()
        .OrderBy(x => x.VendorName)
        .ToSelectList(x => x.VendorName, x => x.ID.ToString(), null)
        .ToList();

    EventID = eventID;

    // now let's get the vendor reader list
    VendorReaderRepository mvmVrr = new VendorReaderRepository();
    VendorReaderList = mvmVrr.GetVendorReadersByEventID(eventID)
        .ToList()
        .OrderBy(x => x.Vendor.VendorName)
        .ToList();
} 
```

但是当我这样做时，我在 x.Vendor.VendorName b/c 上收到 Null Reference Exception 错误，似乎在对象中找不到添加的新供应商。我已经研究过，我想出的只是 SaveChanges 应该修复它。这在我添加 AssetReader 之前没有发生，它存储了 Reader 的实际 SN（出于各种原因我需要它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T00:56:03.920

尝试将 AssetReaderID 属性添加到您的 VendorReader 类以使用导航属性。

```
public partial class VendorReader
{
    public int ID { get; set; }

    public string AssetValue { get; set; }

    public int VendorID { get; set; }

    public virtual Vendor Vendor { get; set; } 

    public int AssetReaderID { get; set; }

    public virtual AssetReader AssetReader { get; set; }
} 
```

如果您不想依赖默认的 EF Code First 约定，那么还可以考虑使用[DataAnnotations](http://msdn.microsoft.com/en-us/library/gg197525%28v=vs.103%29.aspx)或[Fluent API](http://msdn.microsoft.com/en-us/library/hh295844%28v=vs.103%29.aspx)来显式配置关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T16:47:17.523

因此，在使用 Entity 模型和 Diagram 定义了一个我不需要的 id 并在 AssetValue 上创建了一个唯一约束并且没有映射和表更改以及各种墙之后，我最终得到了一个简单的解决方案。

```
 thisVendorReader.vendorID = model.AddEditVendorReader.vendorID;
                thisVendorReader.AssetValue = model.AddEditVendorReader.AssetValue;
                // need to add vendor too (even though we add the vendorID 
                // b/c entity doesn't automatically give you the vendor in a single call)
                vendor newVendor = new vendor();
                vendorRepository vRepo = new vendorRepository();
                newVendor = vRepo.GetById(thisVendorReader.vendorID);
                thisVendorReader.vendor = newVendor;
                vrr.Add(thisVendorReader); 
```

# sql - 很多外键 - Django Admin

> ID：12573659
> 
> 赞同：4
> 
> 时间：2012-09-24T22:12:01.177
> 
> 标签：sql, django, query-optimization, admin, models

有一个SQL问题，添加这个模型一切正常，问题出在ADMIN。

当我将数据添加到每个表中时，通过单击页面中的`TYPE`&加载速度非常慢，安装和 SQL 需要 17 秒。当我尝试它给了我超时时，我的问题是我的模型有什么问题？是不是构造不好？`PAGE``ADMIN``debug_toolbar``TYPE``PAGE`

我的目标是让我们举个例子：

[http://www.example.com/audi/4doors/s4/sport/red/audi-url](http://www.example.com/audi/4doors/s4/sport/red/audi-url)

基本上所有 6 个 url 都是动态的，我将在每个表中指定，并且在其他表中也将在`PAGE`as 下拉列表中。执行此操作或优化模型的最佳方法是什么？

这是 TYPE 页面加载的截图：

截图：[http ://cl.ly/image/2931040E0t35](http://cl.ly/image/2931040E0t35)

请帮忙谢谢

```
from django.db import models

class Client(models.Model):
    title = models.CharField(max_length=100, unique=True)
    def __unicode__(self):
        return self.title

class Category(models.Model):
    client = models.ForeignKey(Client, to_field='title')
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Subcategory(models.Model):
    client = models.ForeignKey(Client, to_field='title')
    category = models.ForeignKey(Category, to_field='title')
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Project(models.Model):
    client = models.ForeignKey(Client, to_field='title')
    category = models.ForeignKey(Category, to_field='title')
    subcategory = models.ForeignKey(Subcategory, to_field='title')
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Type(models.Model):
    client = models.ForeignKey(Client, to_field='title')
    category = models.ForeignKey(Category, to_field='title')
    subcategory = models.ForeignKey(Subcategory, to_field='title')
    project = models.ForeignKey(Project, to_field='title')
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Page(models.Model):
    client = models.ForeignKey(Client, to_field='title')
    category = models.ForeignKey(Category, to_field='title')
    subcategory = models.ForeignKey(Subcategory, to_field='title')
    project = models.ForeignKey(Project, to_field='title')
    type = models.ForeignKey(Type, to_field='title')
    pageurl = models.CharField(max_length=200) 
```

`admin.py`当我从中删除外键时也刚刚发现`list_display`，它的工作速度非常快：

```
class ClientAdmin(admin.ModelAdmin):
    list_display = ('title',)
    admin.site.register(Client, ClientAdmin)

class CategoryAdmin(admin.ModelAdmin):
    list_display = ('client', 'title',)
    admin.site.register(Category, CategoryAdmin)

class SubcategoryAdmin(admin.ModelAdmin):
    list_display = ('client', 'category', 'title', )
    admin.site.register(Subcategory, SubcategoryAdmin)

class ProjectAdmin(admin.ModelAdmin):
    list_display = ('client', 'category', 'subcategory', 'title', )
    admin.site.register(Project, ProjectAdmin)

class TypeAdmin(admin.ModelAdmin):
    list_display = ('client', 'title', )
    admin.site.register(Type, TypeAdmin)

class PageAdmin(admin.ModelAdmin):
    list_display = ('client', )
    admin.site.register(Page, PageAdmin) 
```

**外键不能在 list_display 中？如何优化它们？**

更新：

```
class Client(models.Model):
    title = models.CharField(max_length=100, unique=True, db_index=True)
    def __unicode__(self):
        return self.title

class Category(models.Model):
    client = models.ForeignKey(Client)
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Subcategory(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Project(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Type(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    project = models.ForeignKey(Project)
    title = models.CharField(max_length=200, unique=True)
    def __unicode__(self):
        return self.title

class Page(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    project = models.ForeignKey(Project)
    type = models.ForeignKey(Type)
    pageurl = models.CharField(max_length=200) 
```

更新 2

```
from django.db import models

class Client(models.Model):
    title = models.CharField(max_length=100, primary_key=True)
    def __unicode__(self):
        return self.title

class Category(models.Model):
    client = models.ForeignKey(Client)
    title = models.CharField(max_length=200, primary_key=True)
    def __unicode__(self):
        return self.title

class Subcategory(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    title = models.CharField(max_length=200, primary_key=True)
    def __unicode__(self):
        return self.title

class Project(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    title = models.CharField(max_length=200, primary_key=True)
    def __unicode__(self):
        return self.title

class Type(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    project = models.ForeignKey(Project)
    title = models.CharField(max_length=200, primary_key=True)
    def __unicode__(self):
        return self.title

class Page(models.Model):
    client = models.ForeignKey(Client)
    category = models.ForeignKey(Category)
    subcategory = models.ForeignKey(Subcategory)
    project = models.ForeignKey(Project)
    type = models.ForeignKey(Type)
    pageurl = models.CharField(max_length=200) 
```

更新 3 - ADMIN.PY

```
class ClientAdmin(admin.ModelAdmin):

    list_display = ('title',)

admin.site.register(Client, ClientAdmin)

class CategoryAdmin(admin.ModelAdmin):

    list_display = ('client', 'title',)

admin.site.register(Category, CategoryAdmin)

class SubcategoryAdmin(admin.ModelAdmin):

    list_display = ('client', 'category', 'title', )

admin.site.register(Subcategory, SubcategoryAdmin)

class ProjectAdmin(admin.ModelAdmin):

        list_display = ('client', 'category', 'subcategory', 'title', )

admin.site.register(Project, ProjectAdmin)

class TypeAdmin(admin.ModelAdmin):

    list_display = ('client', 'category', 'subcategory', 'project', 'title', )

admin.site.register(Type, TypeAdmin)

class PageAdmin(admin.ModelAdmin):

   list_display = ('client', 'category', 'subcategory', 'project', 'type', 'pageurl', )

admin.site.register(Page, PageAdmin) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T13:37:29.200

而不是你可以使用django admin 的[raw_id_fields](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)选项。

```
admin.site.register(Client)

class CategoryAdmin(admin.ModelAdmin):

    raw_id_fields = ('client',)

admin.site.register(Category, CategoryAdmin)

class SubcategoryAdmin(admin.ModelAdmin):

    raw_id_fields = ('client', 'category')

admin.site.register(Subcategory, SubcategoryAdmin)

class ProjectAdmin(admin.ModelAdmin):

    raw_id_fields = ('client', 'category', 'subcategory')

admin.site.register(Project, ProjectAdmin)

class TypeAdmin(admin.ModelAdmin):

    raw_id_fields = ('client', 'category', 'subcategory', 'project')

admin.site.register(Type, TypeAdmin)

class PageAdmin(admin.ModelAdmin):

    raw_id_fields = ('client', 'category', 'subcategory', 'project', 'type')

admin.site.register(Page, PageAdmin) 
```

![这是旧的](../Images/00e10aa6b8c7f513cf28a3a23f9d1ce8.png) ![这是新的 sql 查询](../Images/ac8bf228e401663a08c766bb627e45c3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T22:42:11.370

嗯，我不确定这是否 100% 相关（因为我在 list_display*和*list_editable 中使用了 FK）。我使用这里描述的技巧来加快速度：http: [//blog.ionelmc.ro/2012/01/19/tweaks-for-making-django-admin-faster/](http://blog.ionelmc.ro/2012/01/19/tweaks-for-making-django-admin-faster/)

似乎对每一行的选择都进行了评估（尤其是在对 FK 使用 list_editable 时），因此使用 formfield_for_dbfield 您可以按照链接中的建议缓存选择。这节省了去数据库渲染foreign_keys的每个下拉/选择框。

如果您打开 mysql 常规日志（如果您使用的是 MySQL），您可以看到正在视图上执行的查询。

# r - 错误后如何防止执行进一步的代码步骤？

> ID：12573660
> 
> 赞同：6
> 
> 时间：2012-09-24T22:12:03.387
> 
> 标签：r

如何确保在“捕获”错误并记录它之后不再执行代码步骤（我不想使用 q()）？

我的使用场景是这样的： - 做一些计算 - 如果发生错误，记录它 - 停止执行代码中的任何进一步步骤

我尝试使用下面的代码示例来解决这个问题（使用打印而不是真正的日志记录功能）：

```
handleMySimpleError<-function(e, text) {
    # Let's log the error
    print(paste0(text, ": ", e))
    # This should stop execution of any further steps but it doesn't
    stop("Now, stop. For real.")
}

print("Starting execution...")
tryCatch(
    stop("My simple error."),
    error=function(e) {handleMySimpleError(e, "could not finish due to")}, finnaly=NULL
)
print("Successfully ended execution...") 
```

我以某种方式希望 print("Successfully end execution...") 永远不会被执行...但是，这是我得到的输出：

```
> handleMySimpleError<-function(e, text) {
+   # Let's log the error
+   print(paste0(text, ": ", e))
+   # This should stop execution of any further steps but it doesn't
+   stop("Now, stop. For real.")
+ }
>  
> print("Starting execution...")
[1] "Starting execution..."
> tryCatch(
+   stop("My simple error."),
+   error=function(e) {handleMySimpleError(e, "could not finish due to")}, finnaly=NULL
+ )
[1] "could not finish due to: Error in doTryCatch(return(expr), name, parentenv, handler): My simple error.\n"
Error in handleMySimpleError(e, "could not finish due to") : 
Now, stop. For real.
> print("Successfully ended execution...")
[1] "Successfully ended execution..." 
```

如何防止 print("Successfully end execution...") 被执行？在错误处理函数中记录错误后停止代码处理的正确策略是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T23:44:11.857

只需将花括号包裹在它周围

```
>     {
+       handleMySimpleError<-function(e, text) {
+           # Let's log the error
+           print(paste0(text, ": ", e))
+           # This should stop execution of any further steps but it doesn't
+           stop("Now, stop. For real.")
+       }
+       print("Starting execution...")
+       tryCatch(
+           stop("My simple error."),
+           error=function(e) {handleMySimpleError(e, "could not finish due to")}, finally=NULL
+       )
+       print("Successfully ended execution...") 
+     }
[1] "Starting execution..."
[1] "could not finish due to: Error in doTryCatch(return(expr), name, parentenv, handler): My simple error.\n"
Error in handleMySimpleError(e, "could not finish due to") : 
  Now, stop. For real. 
```

# c# - 更新数据库列后发送电子邮件

> ID：12573663
> 
> 赞同：0
> 
> 时间：2012-09-24T22:12:20.233
> 
> 标签：c#, asp.net, .net, sql-server-2005, email

我有一个使用 C# .Net 3.5 构建的客户端的 Web 应用程序。Web 应用程序做了很多事情，其中​​一部分是我通过异步 Web 请求发送一些数据以对数据库进行一些处理。这可能需要 5 到 60 分钟。

然后我创建了一个 SQL 触发器，当数据库中的列使用数据库邮件发送邮件时（通过 msdb.dbo.sp_send_dbmail）。

这很好用，但是我们的客户端禁止我们从数据库服务器发送邮件。

有人可以替代吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:19:03.470

您可以创建一个包含电子邮件所需的所有字段的电子邮件表。为您在处理过程中需要发送的每封电子邮件添加一条记录。

接下来，编写一个 Windows 服务，定期 ping 该数据库以获取新的电子邮件记录。如果找到，请生成您的电子邮件并从您的应用程序层发送它们。不要忘记有一个布尔值或类似的机制来指示电子邮件已发送，这样它就不会被多次接收。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:17:47.063

我的编码器感觉有些可疑，但是是什么阻止您更新您在应用程序服务器的定时间隔检查的另一个表？并让应用程序服务器发送警报？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:23:37.593

即使是电子邮件表中的“SendStatus”列，可以是“ReadyForSend”、“Sent”、“Error”或其他内容，也比触发计划更好。然后是某种计划任务，它会查找处于适当状态的项目以进行发送。

请记住，这个可怜的家伙必须在 6 个月到一年的时间里弄清楚这一切是如何运作的，而您可能不再参与该项目，也可能不再参与该项目。

# android - WebView 文本大小

> ID：12573666
> 
> 赞同：2
> 
> 时间：2012-09-24T22:12:31.607
> 
> 标签：android, webview, android-webview

有时，当我加载我的页面（没有静态内容，动态构建）时，我看到字体太小[1](http://s8.postimage.org/7akrcd8wl/webview1.png "小文字")。如果我重新加载，我会正确看到[2](http://s7.postimage.org/cp6imu1dn/webview2.png "普通文本")。我来回走动，正确地看到它。然后……小。不是特定页面，不是特定时间。甚至没有特定版本：我在 ICS 设备上部署，没问题，然后改变一些东西（比如字体大小），这就是问题所在。在 8 和 10 模拟器上部署相同。

我的观点很简单：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="1"
    android:orientation="vertical" >
    <WebView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/webviewArticle"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:padding="12dp" >
    </WebView>
</LinearLayout> 
```

HTML构造（内容参数为格式化html）

```
String toShow = new StringBuffer()
    .append("<html>")
    .append("<head>")
    .append("<style type='text/css'>body{ font-size: large; color: #FFFFFF; background-color: #000000;}</style>")
    .append("</head>")
    .append(String.format(
        "<body><h1>%s</h1><div><img src='%s' alt='%s' style='width:100%%; height:auto' /></div><div style='background-color:#000000;'>%s</div><div><h3>%s</h3></div></body>",
        article.getTitle(),
        article.getImageLink().toString(),
        article.getTitle(),
        article.getContent().replace("%", "%25"), //html
        article.getAuthor()))
    .append("</html>")
    .toString();

mBrowser.getSettings().setBuiltInZoomControls(true);
mBrowser.setInitialScale(1);
CompatibilityUtils.setLoadWithOverviewMode(mBrowser, true); //set based on android version
mBrowser.getSettings().setUseWideViewPort(true);
mBrowser.loadDataWithBaseURL("fake://in/order/to/refresh", toShow, "text/html", "utf-8",null); 
```

有什么提示吗？

附加说明 25 年 9 月 12 日：如图所示，WebView 认为可用空间是屏幕的一半，并相应地放置文本。这很奇怪。最奇怪的是，它对文本（图像上方的标题和下方的 div）而不是图像这么认为！！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-25T00:01:09.910

```
WebSettings settings= webView.getSettings(); 
```

这

```
settings.setTextSize(WebSettings.TextSize.SMALLEST); 
```

或者

```
settings.setDefaultFontSize(10);//Larger number means larger font size 
```

# firefox - 如何为多个网络浏览器制作一个简单的插件？

> ID：12573667
> 
> 赞同：0
> 
> 时间：2012-09-24T22:12:32.487
> 
> 标签：firefox, google-chrome, plugins, web, browser-plugin

> **可能重复：**
> [如何编写浏览器插件？](https://stackoverflow.com/questions/2649056/how-to-write-a-browser-plugin)

现代网络浏览器（如 firefox 或 chrome）中的插件，允许执行文件（使用网络摄像头和其他）并更好地控制 pc（插件，而不是扩展）。

如何制作一个用于教育目的的简单插件？

编辑 1： chrome 扩展的信息很广泛，但这个问题不是关于扩展（firefox 上的 .xpi），否则是插件（.so 或 .dll）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:15:12.157

查看[FireBreath](http://firebreath.org/display/documentation/FireBreath+Home)框架

# haskell - 如何在 Haskell 中为 GADT 派生数据实例？

> ID：12573669
> 
> 赞同：6
> 
> 时间：2012-09-24T22:12:40.533
> 
> 标签：haskell, gadt, deriving

我有一个 GADT，它只与两个不同的参数 ForwardPossible 和 () 一起使用：

```
-- | Used when a forward definition is possible.
data ForwardPossible = ForwardPossible deriving (Eq, Ord, Typeable, Data, Show)

-- | GADT which accepts forward definitions if parameter is ForwardPossible.
data OrForward t forward where
  OFKnown :: t -> OrForward t forward
  OFForward :: NamespaceID -> SrcSpan -> BS.ByteString -> OrForward t ForwardPossible

deriving instance Eq t => Eq (OrForward t forward)
deriving instance Ord t => Ord (OrForward t forward)
deriving instance Typeable2 OrForward
deriving instance Show t => Show (OrForward t forward) 
```

我想派生足够的 Data.Data 实例来涵盖 OrForward t () 和 OrForward t ForwardPossible。我认为一般 (Data t, Data forward) => OrForward t forward 实例是不可能的，除非它普遍忽略 OFForward，但是 Data t => OrForward t ForwardPossible 和 (Data t, Data forward) => 的重叠实例如果有办法让 ghc 派生这些实例，OrForward t 前向实例可能是一个解决方案。

我试过定义：

```
deriving instance Data t => Data (OrForward t ())
deriving instance Data t => Data (OrForward t ForwardPossible) 
```

但随后 ghc 给了我一个这样的错误：

```
Duplicate type signature:
  Structure.hs:53:1-70: $tOrForward :: DataType
  Structure.hs:52:1-49: $tOrForward :: DataType 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T23:53:44.797

我找到了一种相当不干净的方法来解决这个问题，所以我会把它放在这里以防其他人找到更好的答案：

1.  我在主结构模块之上创建了两个新模块，专门用于派生实例。我使用了一个派生实例，使用 ForwardPossible 的 GADT 专业化，以及一个使用 StandaloneDeriving 和 FlexibleInstances 的实例获取 ()。这避免了 ghc 添加的代码中的内部符号冲突问题，通过将它们放在不同的模块中来实现 Data.Data。

2.  我不得不手动编写实例 Data t => Data (OrForward t ()) 以排除 OFForward 情况：

    ```
    instance Data t => Data (OrForward t ()) where
      gfoldl k z (OFKnown a1) = (z OFKnown `k` a1)
      gunfold k z c = case constrIndex c of
      _ -> k (z OFKnown)
      toConstr _ = cOFKnown
      dataTypeOf _ = tOrForward
      dataCast2 f = gcast2 f

    tOrForward :: Data.Data.DataType
    tOrForward =
      mkDataType
        "Data.FieldML.Structure.OrForward"
        [cOFKnown]

    cOFKnown :: Data.Data.Constr
    cOFKnown = mkConstr tOrForward
                 "OFKnown" [] Prefix 
    ```

3.  可以导出 Data t => Data (OrForward t ForwardPossible) 的实例：

    ```
    deriving instance Data t => Data (OrForward t ForwardPossible) 
    ```

# java - 任务队列任务遇到“进程因后端关闭时间过长而终止”过于频繁

> ID：12573674
> 
> 赞同：3
> 
> 时间：2012-09-24T22:13:21.033
> 
> 标签：java, google-app-engine

我有处理 GAE 数据库中的记录并上传到谷歌云的工作。由于需要很长时间，所以我使用任务队列一次处理一小批。但是我在日志中看到了非常一致的“进程终止，因为后端关闭时间太长”的问题。我知道我只有 30 秒的时间来清理，而且我已经超过了这个时间限制。虽然我知道实例可能会变得不可用并且有时需要关闭，但它发生得如此频繁，例如每次执行任务的 3 或 4 分钟（有时是 10 分钟，这是任务队列时间限制），并且没有做太多工作每个任务。

我想知道后端关闭的原因可能是什么。它是纯粹的服务器端问题还是代码中的一些错误也可能导致这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-14T12:19:12.127

正如谷歌在 IO 后端所说，将在没有太多警告的情况下关闭。开发人员将编写代码来处理任务失败的失败情况。就我而言，我注册了一个每次都有效的关闭挂钩（仅适用于任务队列）。除此之外，您还可以使用任务名称在恢复期间从失败的任务中筛选出已完成的任务。GAE 自行退休。所以不用担心后端为什么会失败。只要我们使用带有任务队列的恢复代码，它就会在某个时候执行。

正如您所提到的，这可能是应用程序之外的错误或服务器负载问题。在不同的应用程序/代码中追逐这个错误之后，我觉得 GAE 范式似乎是围绕 urlhandler 的代码，用于小任务块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-25T10:57:40.627

`Process terminated because the backend took too long to shutdown`部署新版本的后端时通常会出现错误。`<dynamic>true</dynamic>`如果您启用了该选项，Google 也会经常关闭后端实例。即使他们向您收取整整 15 分钟的费用，它也会在几分钟后执行此操作，因此请考虑使用永久实例而不是动态实例。

另一个问题可能是实例内存不足。在这种情况下，实例会自行重新启动，从而导致上述错误。您可以尝试使用具有更多内存的实例类型，例如 B2 或 B4。

# scala - 如何在hadoop中实现或加入（烫伤/级联）

> ID：12573675
> 
> 赞同：2
> 
> 时间：2012-09-24T22:13:25.440
> 
> 标签：scala, join, hadoop, cascading, scalding

只需将连接字段作为 reducer 键发送即可通过单个键轻松连接数据集。但是通过几个键连接记录，其中至少一个应该是相同的，对我来说并不容易。

示例 我有日志，我想按用户参数对它们进行分组，我想通过 (ipAddress, sessionId,visitorCockies) 加入它们

因此，如果 log1.ip == log2.ip OR log1.session = log2.session OR log1.cockie = log2.coockie，则 log1 应与 log2 分组。也许可以创建复合键或诸如 minHash 之类的概率方法...

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:53:01.797

The issue is that MapReduce joins are typically implemented by giving records that match on some field the same reduce key so that they get sent to the same reducer. So anything to get around this is going to be a bit of a hack, but it is possible...

Here's what I would recommend: for each input record, generate three copies, each with a new "key" field that is prefixed by the field it's coming from. So for example, say you had the following input:

```
(ip=1.2.3.4, session=ABC, cookie=123)
(ip=3.4.5.6, session=DEF, cookie=456) 
```

Then you would generate

```
(ip=1.2.3.4, session=ABC, cookie=123, key=ip_1.2.3.4)
(ip=1.2.3.4, session=ABC, cookie=123, key=session_ABC)
(ip=1.2.3.4, session=ABC, cookie=123, key=cookie_123)
(ip=3.4.5.6, session=DEF, cookie=456, key=ip_3.4.5.6)
(ip=3.4.5.6, session=DEF, cookie=456, key=session_DEF)
(ip=3.4.5.6, session=DEF, cookie=456, key=cookie_456) 
```

And then you could simply group on this new field.

I'm not too familiar with scalding/cascading (although I've been meaning to learn more about it) but this would definitely conform to how joins are generally done in Hadoop.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T11:47:00.423

**提示**：使用类型别名使您的 Scalding 代码易于阅读

**注意 0**：这个解决方案特别好，因为它总是只有 1 个映射作业，即使有更多的键可以加入。

**注意 1**：假设每个管道没有重复的键，否则您必须使 'key 也具有它来自哪个日志的索引，并且 mapTo 将是一个 flatMapTo 并且更复杂一些。

**注意 2**：为简单起见，这将丢弃连接字段，为了保留它们，您需要一个丑陋的大元组（ip1、ip2、session1、session2、...等）。如果您真的想要，我可以写一个保留它们的示例。

**注意 3**：如果你真的想合并重复的值，你可以用 groupBy 每个 logEntry1 和 logEntry2，产生一个 logEntryList，然后是 cat（如评论中所述，这对于连接是不正常的）。这将创建另外 2 个映射作业。

```
type String2 = (String, String)
type String3 = (String, String, String)

def addKey(log: Pipe): Pipe = log.flatMap[String3, String](('ip, 'session, 'cookie) -> 'key)(
  _.productIterator.toList.zipWithIndex.map {
    case (key: String, index: Int) => index.toString + key
  }
)

(addKey(log1) ++ addKey(log2)).groupBy('key)(_.toList[String]('logEntry -> 'group))
.mapTo[Iterable[String], String2]('group -> ('logEntry1, 'logEntry2))(list => (list.head, list.last)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T04:21:54.617

按照上面 Joe 的描述创建单独的连接后，您需要删除重复项。如果您在“OR-join”中使用的所有字段中它们都相等，则数据中的两个元组是重复的。因此，如果您之后对代表所有相关字段的键进行自然连接，您会将所有重复项组合在一起。因此，您可以通过单个出现的相应元组来替换它们。

让我们看一个示例：假设您有包含字段 (A,B,C,D) 的元组，并且您感兴趣的字段是 A、B 和 C。您将首先对 A、B 进行等值连接, 和 C 分开。对于每一个，您都将加入初始元组流。用 (A0, B0, C0, D0) 表示第一个流，用 (A1, B1, C1, D1) 表示第二个流。结果将是元组（A0、B0、C0、D0、A1、B1、C1、D1）。对于这些元组中的每一个，您将创建一个元组 (A0A1B0B1C0C1, A0, B0, C0, D0, A1, B1, C1, D1)，因此所有重复项将在随后的 reducer 中组合在一起。对于每个组，只返回一个包含的元组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T19:41:05.443

对于级联，我最终创建了一个过滤器，它检查 OR 中任何条件的输出是否为真。级联过滤器输出可以选择使用的真/假值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T17:35:50.377

你能描述更多关于“通过几个键加入记录”的信息吗？

如果您知道工作流程中可以连接特定键的点，那么最好的方法可能是定义一个具有多个连接的流，而不是尝试操作一个复杂的数据结构，以便一步解决 N 个键。

这是一个示例应用程序，它展示了如何在 Cascading 中处理不同类型的连接：[https ://github.com/Cascading/CoPA](https://github.com/Cascading/CoPA)

# ios6 - 升级到 Xcode4.5 iOS6 Base SDK 后运行时异常

> ID：12573685
> 
> 赞同：11
> 
> 时间：2012-09-24T22:14:16.893
> 
> 标签：ios6, xcode4.5

我最近升级了我的代码库以使用 iOS6 Base SDK - 我使用的是 XCode 4.5。我只需要将 dylibxml2.2.3.7 更改为 dylibxml2.2。它在 6.0 模拟器上运行良好。我正在使用 GoogleAnalytics、Three20 等库。

但是当我在 iOS 5 (iPhone4) 上运行代码时，它在启动时崩溃并出现以下错误：

我不知道它到底在哪里崩溃，因为我看到的只是崩溃时的机器代码

**dyld：惰性符号绑定失败：找不到符号：_objc_setProperty_nonatomic**

> 引用自：/Users//Library/Application Support/iPhone Simulator/5.0/Applications//
> 
> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk/System/Library/Frameworks/Foundation.framework/Foundation

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-25T08:16:45.067

在构建我自己的库并在我的示例代码中运行它时，我也遇到了同样的错误。仔细阅读构建日志后，我现在弄清楚了原因。

我将部署目标设置为 iOS 3.0，但最新的 Xcode 仅支持 iOS 4.3 及更高版本。因此编译器会自动将部署目标设置为 iOS 6.0，每当项目在 iOS 6.0 下运行时都会产生错误。我通过在我的 lib 项目中将部署目标设置为 iOS 4.3 来修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T12:17:15.667

单独changng SDK部署目标有问题。我刚刚创建了一个基于选项卡的应用程序。没有对任何文件进行任何更改。在 ios 6 模拟器上运行良好，但如果我将
部署目标更改为 5 并在创建异常（信号 SIGABRT）的 ios 5 模拟器上运行。Xcode 版本 4.5 和默认部署目标 SDK 6.0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-04T11:45:59.143

Or it could be that you are using a library that was compiled with a higher base SDK than your project base SDK.

# c# - 如何在使用 NHibernate JoinQueryOver 时指定要进行连接的键

> ID：12573687
> 
> 赞同：1
> 
> 时间：2012-09-24T22:14:23.113
> 
> 标签：c#, sql, nhibernate, fluent

```
public class Store
{
public virtual prop1 { get; set;}
public virtual int RegionID { get; set;}
public virtual Region Region { get; set;
}

public class Region
{
  public virtual int RegionID { get; set;}
} 
```

最后我的 sql 应该看起来像

```
select * from store inner join region on store.regionid = region.regionid 
```

我怎样才能让下面的工作来实现上面的内部连接。

```
Session.QueryOver<Store>()
                .JoinQueryOver<Region>(s => s.Region) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:38:21.913

要获得内部连接，您必须在 NHibernate 映射中设置 Store 实体和 Region 实体之间的关系。

您不能使用 QueryOver API 指定要加入的密钥。

你的类应该看起来像这样：

```
public class Region
{
  public virtual int RegionID { get; set;}
  public virtual IList<Store> Stores { get; set; }
}

public class Store
{
    public virtual int StoreId { get; set;}
    public virtual Region Region { get; set; }
} 
```

您的映射应该与此类似：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class xmlns="urn:nhibernate-mapping-2.2" name="YourNameSpace.Region, YourNameSpace" table="Region">
    <id name="RegionID">
      <column name="RegionID" />
      <generator class="identity" />
    </id>
    <bag cascade="all" inverse="true" name="Stores">
      <key>
        <column name="RegionID" />
      </key>
      <one-to-many class="YourNameSpace.Store, YourNameSpace" />
    </bag>
  </class>
</hibernate-mapping>

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class xmlns="urn:nhibernate-mapping-2.2" name="YourNameSpace.Store, YourNameSpace" table="Store">
    <id name="StoreID">
      <column name="StoreID" />
      <generator class="identity" />
    </id>

    <many-to-one class="YourNameSpace.Region, YourNameSpace" name="Region">
      <column name="RegionId" />
    </many-to-one>
  </class>
</hibernate-mapping> 
```

# macos - 从 GAWK 和 Bash 脚本调用 Gnuplot，仅绘制第一个图

> ID：12573690
> 
> 赞同：2
> 
> 时间：2012-09-24T22:14:27.617
> 
> 标签：macos, bash, gnuplot, gawk

好的，这就是交易。我正在开始我的计算材料科学本科论文，我正在尝试将一些脚本放在一起以帮助准备数据分析。

我一直在准备一个 GAWK 脚本，它基本上会获取一些数据（排列在 4 列中）并抓取其中的两个并在 GNUPLOT 中绘制它们。为此，我读入了包含多个时间步长及其关联数据的数据文件，将文件拆分为每个时间步长的单独 .dat 文件。

从那里我只是为 GNUPLOT 生成一个基本的输入脚本，并绘制每个时间步，因为它们出现在数据文件中。

问题是由于某种原因，所有生成的图都是完全相同的图（在这种情况下总是第一个时间步），但它们被保存为正确的时间步。

我已经浏览并跟踪了整个脚本中的每个变量/文件名，最后确定问题出在某种程度上是从脚本调用 GNUPLOT。我拿出我的系统命令并编写了一个简短的 bash 脚本，它从 for 循环中调用 gnuplot：

```
#!/bin/bash
for file in ./*gnu
do
   gnuplot $file
done 
```

这仍然会导致所有情节都相同的相同问题。然后，我只是从包含 .gnu 文件的目录中的命令行中运行命令 gnuplot *gnu 并且它起作用了。

我想我只是想知道是否有一些我需要刷新的缓冲区，或者我只是错过了什么？

GAWK 脚本如下所示。我还是新手，所以如果你想用一些建设性的批评来评论剧本，我也将不胜感激。

```
#!/opt/local/bin/gawk -v inputf=$1 -f                                                   

# Write gnuplot files and plot RDF data                                                 
function plot_rdf(timestep, Load_RDF_dat)
{
# Set number of digits in filenames to 6 so data is organized                           
    if (timestep < 10){
        pad_timestep="00000"timestep;
    }
    else if (timestep < 100){
        pad_timestep="0000"timestep;
    }
    else if (timestep < 1000){
        pad_timestep="000"timestep;
    }
    else if (timestep < 10000){
        pad_timestep="00"timestep;
    }
    else if (timestep < 100000){
        pad_timestep="0"timestep;
    }
    else{
        pad_timestep=timestep;
    }

# Give output filenames                                                                 
       gnu_file="plot_RDF_"pad_timestep".gnu";
       png_file="RDF_"pad_timestep".png";

# Create input files for gnuplot                                                        
       print "set output \""png_file"\"" >> gnu_file;
       print "set terminal png" >> gnu_file;
       print "plot './"Load_RDF_dat"' u 1:2" >> gnu_file;
       close(gnu_file);
       system("gnuplot "gnu_file);
}

# Main part of script                                                                   
{
# Parse the RDF data and save it to GNUPLOT readable files                              
    while(getline < inputf){
       if ($1 == "#"){
           # skips the three commented header lines                                     
           next;
       }
       else if (NF == 2){
           timestep=$1;
           bin_num=$2;
           print "Reading timestep "timestep;
           RDF_dat="RDF_"timestep".dat";
           next;
       }
       else if (NF == 4){
           print $2" "$3 >> RDF_dat;
           if ($1 == bin_num){
               plot_rdf(timestep, RDF_dat);
               close(RDF_dat);
           }
           next;
       }
    }
    close(inputf);
    close(RDF_dat);
 } 
```

我正在读取的数据文件片段是：

```
# Time-averaged data for fix rdf
# TimeStep Number-of-rows
# Row c_allrdf[1] c_allrdf[2] c_allrdf[3]
500 100
1 0.005 0 0
2 0.015 0 0
3 0.025 0 0
4 0.035 0 0
5 0.045 0 0
6 0.055 1.16597 0.00133333
7 0.065 2.08865 0.00466667
8 0.075 1.56958 0.008
9 0.085 0.733433 0.01
10 0.095 0.587288 0.012
600 100
1 0.005 0 0
2 0.015 0 0
3 0.025 2.79219 0.000666667
4 0.035 2.86766 0.002
5 0.045 0 0.002
6 0.055 0.582985 0.00266667
7 0.065 2.08865 0.006
8 0.075 0.62783 0.00733333
9 0.085 0.488955 0.00866667
10 0.095 1.17458 0.0126667 
```

每个时间步长部分通常有 100 组数据，但我想我会在这里缩短，这样你就会明白了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:57:47.647

我不确定我能否回答你的问题——但是，我会说，当我稍微修改你的数据文件时，它（似乎）对我来说工作得很好。

这是我修改后的数据文件版本：

```
# Time-averaged data for fix rdf
# TimeStep Number-of-rows
# Row c_allrdf[1] c_allrdf[2] c_allrdf[3]
500 100
1 0.005 0 0
2 0.015 0 0
3 0.025 0 0
4 0.035 0 0
5 0.045 0 0
6 0.055 1.16597 0.00133333
7 0.065 2.08865 0.00466667
8 0.075 1.56958 0.008
9 0.085 0.733433 0.01
10 0.095 0.587288 0.012
100 0.095 0.56 0.014     #<-added this line
600 100
1 0.005 0 0
2 0.015 0 0
3 0.025 2.79219 0.000666667
4 0.035 2.86766 0.002
5 0.045 0 0.002
6 0.055 0.582985 0.00266667
7 0.065 2.08865 0.006
8 0.075 0.62783 0.00733333
9 0.085 0.488955 0.00866667
10 0.095 1.17458 0.0126667
100 0.095 1.179 0.12      #<-added this line 
```

* * *

由于以下线条，这些线条对于“触发”gnuplot 绘图功能是必要的：

```
 if ($1 == bin_num){
       plot_rdf(timestep, RDF_dat);
       close(RDF_dat);
   } 
```

由于`bin_num`取自“标题”中的第二个字段。（例如`600 100`）。

我不确定您是否在完整的数据文件中正确设置了该设置。另外，我将脚本称为：

```
gawk -f test.awk -v inputf=test.dat test.dat 
```

一开始它完全忽略了你的shebang，但我读过很多系统都无法正确拆分它们。

最后，你有什么版本的gnuplot？如果您有 4.6，则可以放弃很多这种痛苦，几乎`gawk`完全跳过脚本并用更简单的脚本替换它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T00:54:56.480

正如 mgilson 指出的那样，您可能因为没有`$1 == bin_num`. 请注意，在命令行上使用数据文件名调用 awk 可以轻松使用 awk 的内置文件读取循环。这在以下对 awk 程序的重写中得到了说明。另请注意：
•在两个地方使用`>`而不是 • 在运行 gnuplot 之前关闭 RDF_dat，而不是之后 • 使用而不是笨拙的一系列语句`>>`

`pad_timestep = sprintf("%06d", timestep);``if`

对于以下内容，我将程序放入 file `so-gnuplot-awk`，将数据按原样放入 file `data-so-gnuplot`，并通过调用程序

```
awk -f so-gnuplot-awk data-so-gnuplot 
```

程序：

```
# Parse the RDF data and save it to GNUPLOT readable files
BEGIN { dopen=0 }

NF==2 {
    if (dopen) plot_rdf(timestep, RDF_dat);
    timestep = $1;
    print "Reading timestep "timestep;
    RDF_dat="RDF_"timestep".dat";
    printf "" > RDF_dat     # Init empty file
    dopen = 1;
}

NF == 4 {  if (dopen) print $2" "$3 >> RDF_dat; }

# Write gnuplot files and plot RDF data
function plot_rdf(timestep, Load_RDF_dat) {
# Set output filenames & create gnuplot command file
    pad_timestep = sprintf("%06d", timestep);
    gnu_file="plot_RDF_"pad_timestep".gnu";
    png_file="RDF_"pad_timestep".png";
    print "set output \""png_file"\"" > gnu_file; # Use > first
    print "set terminal png" >> gnu_file;
    print "plot './"Load_RDF_dat"' u 1:2" >> gnu_file;
    close(gnu_file);
    close(RDF_dat);
    print "Plotting with "RDF_dat" into "png_file
    system("gnuplot "gnu_file);
    dopen=0
}

END { if (dopen) plot_rdf(timestep, RDF_dat); } 
```

# java - 昆德拉休息用法

> ID：12573691
> 
> 赞同：0
> 
> 时间：2012-09-24T22:14:30.150
> 
> 标签：java, rest, kundera

我正在使用 JPA2 实体注释和 Kundera 进行持久性。我想将实体公开给 RESTful 接口。

我知道我可以使用 kundera-rest 来做到这一点。我还从[github](https://github.com/xamry/Kundera-Web-Examples)找到了一个示例“Kundera-Web-Examples” 。

我的问题是，无论我尝试什么，当我尝试使用 RESTful 接口时，我总是以“404 - Not Found”告终......而且日志看起来很安静......

有没有人有这方面的经验？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:52:39.420

没关系...我没有正确使用它。

来自 github 的示例“Kundera-Web-Examples”是错误的，或者 kundera-rest 在较新版本中已更改。

# php - 此 if 语句不返回任何输入

> ID：12573692
> 
> 赞同：0
> 
> 时间：2012-09-24T22:14:42.037
> 
> 标签：php

我有一个数组。

在我的数组中是我脚本的最后一部分。我的脚本扫描所有链接并将其放入数组 $link 中。然后它扫描 $link 中的所有标题，然后获取 $link 的所有元标题。但是有些人没有元描述，所以我决定创建一个函数，它返回扫描的 20 个字符的 ap 标签。

尽管在我的数组中，我的 if 语句似乎不起作用。它应该检测变量中的“描述”键中是否有任何输入，然后使用 if 语句中的指令。

但是，它似乎并没有这样做，我一直在想我错过了一些东西。

```
function getMetas($link) {
    $str1 = file_get_contents($link);    

    if (strlen($str1)>0) {
        preg_match_all( '/<meta.*?name=("|\')description("|\').*?content=("|\')(.*?)("|\')/i', $str1, $description);
        if (count($description) > 1) {
            return $description[4];   
        }

    }

}

function get_custom_excerpt($return, $option = 30, $sentance = false) {
    $marks = Array(".","!","?");

    $return = strip_tags($return);

    if($sentance == true) {
        $start = implode(" ", array_slice(preg_split("/\s+/", $return), 0, $option ));
        $start .= ' ';
        $end = implode(" ", array_slice(preg_split("/\s+/", $return), $option));

        $cut = Array();
        foreach($marks AS $m => $mark){
            $mark = strpos($end, $mark);
            if($mark != false) $cut[$m] = $mark;
        }

        if($cut[0] != "")
            $chop = min($cut);
        else
            $chop = $option;
        $rest = substr($end, 0, $chop);

        $key = array_search($chop, $cut);

        $return = $start.$rest;

    }else{
        $return = implode(" ", array_slice(preg_split("/\s+/", $return), 0, $option));
    }
    $return .= $marks[$key];

    return $return; 
}     

$html = file_get_contents($link);    
preg_match('%(<p[^>]*>.*?</p>)%i', $html, $re);
$res = get_custom_excerpt($re[1]);

$out = Array();

foreach ($links as $thisLink) {
    $out = array("link" => $thisLink, "title" => Titles($thisLink), "description" => getMetas($thisLink));

    if (empty($out['description'])) {
        $out['description'] = $res;
    }

    $output[] = $out;

} 
```

顺便说一句，除了 if 语句，代码运行良好。该函数已在一个较小的数组上执行，而不是我正在使用的数组，并且它已将结果返回到我的标准。但它似乎创建了另一个键（'description'）而不是添加 p 标签。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:18:54.670

问题是您正在向 $output 数组添加数组，因此当您尝试访问刚刚添加的数组时，您实际上是在访问整个 $output 数组。尝试这个：

```
foreach ($links as $thisLink) {
    $out = array("link" => $thisLink, "title" => Titles($thisLink), "description" => getMetas($thisLink));

    if (empty($out['description'])) {
        $out['description'] = $res;
    }

    $output[] = $out;
} 
```

# web-services - 移动策略：如何处理这种服务器-客户端版本排列？

> ID：12573693
> 
> 赞同：5
> 
> 时间：2012-09-24T22:14:41.770
> 
> 标签：web-services, mobile, strategy-pattern

我们正在为客户托管一个 SAAS 应用程序。主应用程序是一个网络应用程序，不同的客户端可以使用不同的版本。例如：

```
Company A  version 1.0
Company B  version 1.1 
```

我们在 App Store 中也有 Android/iOS 应用程序。由于应用程序并不总是最新的，我们也可以在市场上有多个应用程序版本。例如 2.0 和 2.1 。因此，出于兼容性原因，我们必须确保每个客户端版本都适用于每个服务器版本：

```
server 1.0 must work with client 2.0,
server 1.0 must work with client 2.1,
server 1.1 must work with client 2.0, 
and server 1.1 must work with client 2.2. 
```

当只有 2 个服务器版本和 2 个客户端版本时，它是易于管理的。然而，随着时间的推移，列表变得疯狂。我们确实有一种机制可以强制移动应用程序更新到最新版本，但这有点烦人，所以管理人员不想经常这样做。

我的问题是，处理这个问题的最佳策略是什么？Android 和 iOS 是否有内置功能，用户可以下载多个应用程序版本，只在需要时启动一个？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T03:41:56.897

对于可能部署了不同服务器版本的多个客户，我们遇到了类似的问题。

我们目前正在考虑几个选项：

*   管理我们客户在云中的部署（由我们管理），以确保他们始终运行最新版本。对于想要内部部署的客户来说是个问题，例如出于合规性或安全原因。
*   将应用程序本身中的旧版本捆绑为一个库，并在运行时执行与服务器版本匹配的版本。不幸的是，会导致混乱的构建和臃肿的应用程序包。
*   告诉用户手动安装应用，不要发布到应用商店。对于不太懂技术的用户来说不方便和有问题。
*   通过客户的服务器部署分发应用程序。需要权限才能在 Android 上从未知来源安装。要求客户拥有适用于 iOS 的 iOS 企业帐户（299 美元/年，每位客户必须单独注册）。
*   模块化应用程序代码以根据服务器版本启用/禁用组件或行为。如果服务器更新很少，可能会起作用，但会变得混乱且难以维护，这种情况经常发生。

在每种情况下，只要他们的公司升级服务器版本，用户仍然必须更新他们的应用程序。

对我们来说，使用[PhoneGap](http://phonegap.com)，还有另一种选择：

*   从服务器下载应用程序代码并执行它。[应用商店指南](https://developer.apple.com/appstore/resources/approval/guidelines.html)2.7 和 2.8 似乎禁止这样做，但开发者协议第 3.3.2 条规定允许下载在 Web 视图中运行的脚本。这意味着该应用程序基本上只是一个启动器，它连接并从服务器获取脚本，然后运行它。缺点是每次运行应用程序时都需要下载和/或应用程序存储中的缓存机制。

您找到适合您的解决方案了吗？你是如何选择处理这个问题的？

# php - PHP在简单的选择查询上抛出错误？

> ID：12573698
> 
> 赞同：-1
> 
> 时间：2012-09-24T22:15:15.793
> 
> 标签：php, forms, oracle11g, oracle-call-interface

不知道发生了什么，我不断收到错误。我已将问题简化为一个很小的测试用例，见下文：

* * *

**登录.html**

```
<form action="login.php" method="post">
    <input type="email" name="email" required />
    <input type="password" name="password" required />

    <input type="submit" value="Login"/>
</form> 
```

**登录.php**

```
$email    = $_POST["email"];
$password = sha1($_POST["password"]);

$stid2 = oci_parse($conn, 'SELECT EMAIL, PASSWORD FROM TUSERS where EMAIL =: email AND PASSWORD =: password');
oci_execute($stid2);

$nrows = oci_fetch($stid2);

print var_dump($nrows); 
```

**错误**

> 警告：oci_execute(): ORA-01008: 并非所有变量都绑定在第 5 行的 login.php 中
> 
> 警告：oci_fetch(): ORA-24374: 在第 7 行的 login.php 中获取或执行和获取之前定义未完成 bool(false)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:25:48.077

您需要将变量 $email 和 $password 绑定到 oracle 占位符。见[oci_bind_by_name](http://www.php.net/oci_bind_by_name)。此外，占位符应该是`:email`and `:password`。`:`冒号 ( ) 和占位符名称 ( `email`and )之间有一个空格`password`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:26:02.223

您将变量占位符添加到查询中，但没有将任何内容绑定到它们

```
$stid2 = oci_parse($conn, 'SELECT EMAIL, PASSWORD FROM TUSERS where EMAIL =:email AND PASSWORD =:password');
oci_bind_by_name($stid2, ':email', $email);
oci_bind_by_name($stid2, ':password', $password);
oci_execute($stid2); 
```

请参见[oci_bind_by_name](http://www.php.net/oci_bind_by_name)

# iphone - sigsegv 在 iPhone 上因 crittercism 崩溃

> ID：12573699
> 
> 赞同：7
> 
> 时间：2012-09-24T22:15:27.023
> 
> 标签：iphone, crash, segmentation-fault

我有几个来自 crittercism 的 sigsegv 崩溃，但我不太确定如何开始调试。我唯一的代码行是从崩溃线程开始的主调用。

从 crittercism 复制崩溃线程的堆栈跟踪：

原因：

2012 年 9 月 24 日下午 2:38:14 SIGSEGV 主要 (main.m:11)

堆：

```
0   
0 libobjc.A.dylib 0x356265b0 objc_msgSend + 15
1   
1 UIKit 0x3861c313 + 1310
2   
2 UIKit 0x386337cf + 206
3   
3 UIKit 0x385ef80b + 258
4   
4 石英核心 0x34f56d63 + 214
5   
5 石英核心 0x34f56901 + 460
6   
6 石英核心 0x34f57835 + 16
7   
7 石英核心 0x34f5721b + 238
8   
8 石英核心 0x34f57029 + 316
9   
9 UIKit 0x386786e5 + 572
10  
10 UIKit 0x386784a3 + 66
11  
11 UIKit 0x38677391 + 1464
12  
12 UIKit 0x385ed1ef + 2458
13  
13 UIKit 0x385ec6d5 + 72
14  
14 UIKit 0x385ec123 + 6154
15  
15 图形服务 0x3779f5a3 + 590
16  
16 核心基础 0x372f0683 + 14
17  
17 核心基础 0x372efe9 + 212
18  
18 核心基础 0x372eecb7 + 646
19  
19 核心基础 0x37261ebd CFRunLoopRunSpecific + 356
20  
20 核心基础 0x37261d49 CFRunLoopRunInMode + 104
21  
21 图形服务 0x3779e2eb GSEventRunModal + 74
22  
22 UIKit 0x38640301 UIApplicationMain + 1120
23  
23 MyApp 0x35bf 主 (main.m:11)

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T08:15:42.527

首先，您需要“符号化”崩溃日志。有很多网页可以指导您。

由于此堆栈以 objc_msgSend 结束，因此最可能的原因是悬空指针。

要调试这些，我建议使用 NSZombies。如果您在模拟器上进行测试，您可以尝试“Guard malloc”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T06:34:13.773

此崩溃是由于在指向已释放对象的指针上调用方法引起的。这是您代码中某个非常常见的引用计数错误，它包含在 UIKit 元素上。但是，在实践中您应该做的是将您的 .DSYM 文件上传到 crittercism。作为自动构建过程的一部分，它可以通过网站或通过[Web API 调用手动完成。](http://support.crittercism.com/customer/portal/articles/699971-uploading-dsym-files-via-api)

# android - Android HomeScreen 上的 OnTouchListener

> ID：12573700
> 
> 赞同：0
> 
> 时间：2012-09-24T22:15:30.347
> 
> 标签：android, ontouchlistener, homescreen

经过几天的挫折——我想问一下——是否有可能`OnTouch Listener`在 Android 主屏幕上添加一个？（不是任何其他自定义主屏幕）。首先我得到一个`WindowsManager`and `WindowsManager Layout Parameters`。然后我创建一个新的`LinearLayout`. 我`AddView`与`LinearLayout`和`Layout Parameters`。我`setOnTouchListener`对`LinearLayout`. 不工作。

是否对 Manifest 文件、布局 xml 文件和代码进行了更改以使 Android 主屏幕`OnTouchListener`正常工作？

我需要`OnInterceptTouchEvent`在非 UI 线程上执行并运行它吗？你推荐什么是做我想做的最好的方法？

# iphone - 新应用程序中的 ASIHTTPRequest 包

> ID：12573701
> 
> 赞同：-1
> 
> 时间：2012-09-24T22:15:42.577
> 
> 标签：iphone, web-services, ios5, ios5.1

我在我的一个新应用程序中使用 ASIHTTRequest 进行所有 Web 服务调用。我知道对它的支持已停止。我想知道如果我还在使用 ASIHTTPRequest，应用提交会顺利吗？（我想知道是否有人最近使用 ASIHTTP 提交了新的应用程序，并且它通过了 Apple 审核流程..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:19:24.840

使用 ASIHTTPRequest 没有问题。今年我至少有 20 个应用程序获批使用它，一个最近在 2012 年 9 月 21 日星期五晚上获批。

# iphone - GLKViewController (GLKView) glReadPixels 在 iO6 之后返回黑色像素

> ID：12573713
> 
> 赞同：1
> 
> 时间：2012-09-24T22:16:19.987
> 
> 标签：iphone, ios, graphics, eaglview, eaglcontext

我将 GLKViewController 与 GLKView 一起使用，在 ios5 上工作正常，在 io6 更新 glReadPixels 停止工作后，只返回黑色像素。

我读了一些关于preserveBackBuffer的东西，但是还没有成功

我的 GLKView 设置：

```
_context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];

if (!_context) {
    DLog(@"Failed to create ES context");
}

GLKView *view = (GLKView *)self.view;
view.context = _context; 
```

可能的解决途径？（我在这里尝试但仍然无法正常工作）

```
CAEAGLLayer * eaglLayer = (CAEAGLLayer*) view.layer;
eaglLayer.drawableProperties = @{kEAGLDrawablePropertyRetainedBacking : @(YES)}; 
```

我在着色器处理后使用 glReadPixels 记录相机

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput 
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer 
   fromConnection:(AVCaptureConnection *)connection 
```

接受所有帮助，谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T19:29:17.403

根据文档，如果您需要读取像素而不是 glReadPixels，则应该使用 GLKView 的“快照”方法。从有关“快照”的文档中：

> 讨论：调用此方法时，视图会设置绘图环境并调用您的绘图方法。但是，不是在屏幕上显示视图的内容，而是将它们作为图像返回到您的应用程序。只要您的应用程序明确需要视图的内容，就应该调用此方法；永远不要尝试使用 OpenGL ES 函数直接读取底层帧缓冲区的内容。

# jquery - 而在 jquery click 事件第一次获得值但第二次为空

> ID：12573714
> 
> 赞同：3
> 
> 时间：2012-09-24T22:16:19.413
> 
> 标签：jquery, jquery-selectors

虽然在 jquery click 事件上第一次获得了价值，但第二次它变空了

**JS：**

```
$(".topPanel").live('click', (function(e) {

    form = $(e.target).attr("name");
    content = $("." + form);    
    $(".show_panel1").html("");
    $(".show_panel1").html(content);
    $(".show_panel1").show();

})); 
```

**HTML：**

```
 <div class="topPanel"  >
   <span id="5" name="panther" style="background: #990000;" class="span_1">  
                   Panther</span>
   <span id="6" name="lion" style="background: #009900;" class="span_1">
                   Lion</span>         
 </div>

 <div class="show_panel1" >
     <label class="label">welcome</label>
 </div>
 <div class="tiger" >
     <label  class="label">i am panther</label>
 </div>
 <div class="lion" >
     <label  class="label">i am lion</label>
 </div>​ 
```

**CSS**

```
.label
{
    font-family: Verdana; 
    font-size: medium;
    font-weight:lighter; 
    color: #FF990000;
    float:inherit;
    margin:10mm;
}

.topPanel
{
    float: left; 
    color:#000000;
    background: none repeat scroll 0% 0% orange; 
    width: 1280px;
    margin: 10px 5px 5px 10px;
}

.span_1
{
   float: left; 
    height: 40px; 
    width:5%; 
    padding:20px;
    margin: 0px 5px 0px 0px;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:50:59.950

**[jsBin 演示](http://jsbin.com/azeyeb/2/edit)**

```
$(".topPanel").on('click', 'span', function(){

    var form = $(this).attr("name");
    var content = $("." + form).html();    
    $(".show_panel1").html(content).show();

}); 
```

PS：不知道你为什么需要`.show()`，但它就在这里！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:44:27.903

这两行没有意义：

```
content = $("." + form);    
$(".show_panel1").html(content); 
```

`content`是一个 jQuery 对象。您不能将 jQuery 对象放入另一个对象的 html 中。也许你的意思是：

```
var content = $("." + form);    
$(".show_panel1").html(content.html()); 
```

这将从内容对象中获取 HTML 并将其放入`.show_panel1`. 请注意，我还将变量声明为`content`局部变量，而不是允许它成为一个不好的隐式全局变量。

* * *

请向我们展示包含的 HTML，`class="form"`以便我们可以看到您在此处实际尝试执行的操作。

此外，`.live()`已弃用（您不应再使用它）。将其替换为`.on()`（对于最新版本的 jQuery）或`.delegate()`（对于旧版本的 jQuery）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:46:11.287

看来这是罪魁祸首

```
$(".show_panel1").html(content); 
```

您正在将选择器传递给 HTML

它应该是

```
$(".show_panel1").html(content.html()); 
```

还`<div class="tiger" >`

应该是 `<div class="panther" >`

您正在尝试调用不存在的**老虎类**

使用所有更新的更改[检查此 FIDDLE](http://jsfiddle.net/sushanth009/ppV7Z/)

# c# - 如何延迟加载具有多行的标准 html 表？

> ID：12573722
> 
> 赞同：5
> 
> 时间：2012-09-24T22:17:18.080
> 
> 标签：c#, javascript, asp.net, html, lazy-loading

我没有使用其他人的表格插件，而是选择使用标准的 HTML 方式来制作表格和行等。我将从数据库中获取数据来填充行。但是当行数超过 10,000 时，我意识到我需要延迟加载行，否则网站会非常慢。我一直在寻找延迟加载表行的方法，但我似乎无法在任何地方找到它，所以我的问题只是延迟加载**插件****或**行**是否**存在？

 **希望有高手能解答一下。提前致谢！

> 关于我正在尝试做的事情的背景：我正在 html 代码中创建表格的粗略草图，然后在运行时，当用户搜索特定内容时，我将通过 DOM 向表格添加行。当他们搜索它时，会有数千个结果，我想将结果延迟加载到表中。

jQuery 为图像和图像容器提供延迟加载。

其他一些插件允许延迟加载 div。

然而，表行的延迟加载似乎不存在。

***上下文的一些示例代码：***

HTML：

```
 <fieldset>
        <legend>PhotoViewer v1.6</legend>
        <h4 id = "albumName"><i>Photos</i></h4>
        <table cellspacing="1" border="2" id = "photoTable" class = "lazyProgressiveLoad">
            <tr style="font-style: italic; font-size: small; font-family: Segoe UI Light; color: Red">
                <th>--Photo--</th>
                <th>--Label--</th>
                <th>--Path--</th>
                <th><input type="button" value="Add Photo" onclick="addPhoto()" id = "addPhoto"/></th>
            </tr>
        </table>
    </fieldset> 
```

> 寻找一些代码，这些代码将允许与下面的表行代码相同的功能。

Javascript：

```
$(function() {
      $("img").lazyload({
          effect : "fadeIn"
          /*
          ,appear : function(elements_left, settings) {
              console.log("appear");
              console.log(elements_left);
              //console.log(this, elements_left, settings);
          },
          load : function(elements_left, settings) {
              console.log("load");
              console.log(elements_left);
              //console.log(this, elements_left, settings);
          }
          */
      });
  }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T22:49:51.980

在 DOM 中拥有数千行数据是一个糟糕的想法，原因很简单：**DOM 很慢**。

相反，只呈现*需要*可见的行。当一行消失时，*将其*从 DOM 中移除。

我最喜欢的用于显示数据网格的库是[SlickGrid](https://github.com/mleibman/SlickGrid/wiki)。通过只为视口中的数据渲染 DOM 元素，它可以以惊人的性能[有效地显示无限量的数据。](http://mleibman.github.com/SlickGrid/examples/example-optimizing-dataview.html)（该示例显示了*50 万*行！）

还有更多展示 SlickGrid 功能的[示例，但您会对](https://github.com/mleibman/SlickGrid/wiki/Examples)[AJAX 加载示例](https://github.com/mleibman/SlickGrid/blob/master/examples/example6-ajax-loading.html)特别感兴趣，其中在您滚动时从服务器流式传输小块行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:26:30.757

我还没有听说过可以做这样的事情的插件，但我大多避免花哨的 JS“库”。从概念上讲，您可以使用 AJAX 请求来选择例如 m>id>n 的图像，然后在您的 javascript 中，当您想要加载更多图像时，执行另一个 ajax 请求，但例如将 m 和 n 增加 100。

存在许多基于此原理运行的开源图库框架，但通常它们使用 php 生成页面，而不是使用 AJAX 动态更改内部 html。

以下是如何从 AJAX 中获取数据库数据并进入 JS。 [http://www.w3schools.com/ajax/ajax_database.asp](http://www.w3schools.com/ajax/ajax_database.asp)**

# javascript - Javascript垃圾邮件脚本代码过滤器

> ID：12573732
> 
> 赞同：0
> 
> 时间：2012-09-24T22:18:51.470
> 
> 标签：javascript, spam, spam-prevention, chatroom

我正在托管一个聊天网站，并在其中放置了一个 java 脚本来阻止垃圾邮件。如果有人发布相同的句子或单词，它不会发布第二个。我最近注意到有人使用不同的垃圾邮件技术，说同一个词，但在词尾加上数字会增加。例如像这样：Spam、Spam1、Spam2、Spam3 等等。因此，如果你们中的任何人知道代码是什么或他如何编写脚本，我将不胜感激，因为我不确定脚本是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:30:01.340

我认为您最好的选择是在提交的帖子/单词之间进行更一般的比较。这很可能是一个自定义脚本，并且尝试专门针对个别技术将允许他们不断进行细微调整以绕过您的对策。这可以使用两个字符串的[Levenshtein 距离来完成。](http://en.wikipedia.org/wiki/Levenshtein_distance)仅添加一个数字会导致帖子与原始帖子之间的 Levenshtein 距离非常短，因此您可以忽略与以前的提交内容过于相似的提交内容。您可以使用许多服务器端库来完成这项工作，但如果不知道您是如何运行网站的，我真的不能推荐任何东西。

# android - 如何从命令行设置 adb - 模拟器超时

> ID：12573736
> 
> 赞同：7
> 
> 时间：2012-09-24T22:19:04.150
> 
> 标签：android

我希望通过命令行在android的模拟器上安装一个apk。这很简单。

现在有几次，我在安装应用程序时看到超时。为了克服这种情况，人们建议我们增加 eclipse 中的 adb 超时。它是如何通过命令行进行的。我正在尝试将部署集成到我们的 CI 系统中。

一个想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-23T11:14:37.107

[Android 问题列表中](https://code.google.com/p/android/issues/detail?id=104305)的帖子建议使用`ADB_INSTALL_TIMEOUT=10`将限制设置为 10 分钟。

# python - 为 Python/Pydev 编写自定义代码分析工具？

> ID：12573737
> 
> 赞同：2
> 
> 时间：2012-09-24T22:19:14.373
> 
> 标签：python, code-analysis

编写代码分析工具的最简单方法是什么，我可以对程序中的一些自定义可能设计缺陷发出警告？我想到的大多数警告都与 OOP 相关。

理想情况下，我会为一些已经存在的解析器编写一个插件并将其集成到 Eclipse/Pydev 中。我可以方便地扩展 pylint 吗？或者 Pydev 有什么帮助吗？

最不费力的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T18:09:20.370

您可以扩展 PyDev 本身：获取它的代码并对其进行一些分析。在代码级别：com.python.pydev.analysis.OccurrencesAnalyzer 是起点（获取代码：[http](http://www.pydev.org/developers.html) ://www.pydev.org/developers.html ）。

它已经有了解析代码的方法，以获取带有访问者结构的 AST，您可以将其用于分析。

对于更简单的检查，您可以改进分布在 PyDev 本身 (/org.python.pydev/pysrc/third_party/pep8/pep8.py) 中的 pep8.py。

# python - Pyodbc 的 Python-Oracle 连接问题

> ID：12573741
> 
> 赞同：0
> 
> 时间：2012-09-24T22:19:41.650
> 
> 标签：python, oracle, odbc, pyodbc

尝试使用 Pyodbc 连接到 Oracle 数据库：

```
try:
    db_connection = pyodbc.connect('DSN=OraDev; PWD=%s' % Key.dbKeys['password'])
except pyodbc.Error, err:
        print >> debug_file, "Database connection failed: %s" %err 
        sys.exit() 
```

它不断给我这个错误信息：

> '[IM014] [Microsoft][ODBC Driver Manager] 指定的 DSN 包含驱动程序和应用程序之间的体系结构不匹配 (0) (SQLDriverConnect)

所以我想知道罪魁祸首是否是我没有“匹配”的组件。目前，我有：

> 1.  Python 2.7 32 位
> 2.  pyodbc 3.0.6 win32-py2.7
> 3.  Oracle ODBC 驱动程序：32 位
> 4.  Windows 服务器 2008 64 位
> 5.  甲骨文 11.2.0 64 位

这里的版本有什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T02:24:31.570

您遇到的问题是 64 位 Windows 不能很好地与 32 位 ODBC 配合使用。你可以在这里读更多关于它的内容：

[32 位版本的 ODBC 管理器工具和 64 位版本的 ODBC 管理器工具在 64 位版本的 Windows 操作系统中显示 32 位用户 DSN 和 64 位用户 DSN](http://support.microsoft.com/kb/942976)。

解决方法是专门针对您要实现的体系结构的 ODBC 驱动程序。

附带说明一下，尝试在混合架构平台上为 oracle 实现 ODBC 让我们很头疼。所以，我们通过[CX_Oracle实现了对oracle的访问](http://cx-oracle.sourceforge.net/)

# c++ - 运行失败（原因不明）

> ID：12573742
> 
> 赞同：0
> 
> 时间：2012-09-24T22:19:45.740
> 
> 标签：c++, stack, binary-tree, runtime-error

我不知道是什么导致程序失败，除了它与尝试为左右孩子分配一些指针有关。没有错误消息，程序只是无法运行。我只是假设这是因为我错误地分配了指针。

这是结构：

```
struct TreeNode
    {
            Type nodeinfo;
            BinaryTree<Type> *left;
            BinaryTree<Type> *right;
    }; 
```

该类的名称是使用模板的 BinaryTree。这是有问题的方法：

```
template <typename Type>
void BinaryTree<Type>::setSubtree(Type a){
  root = new TreeNode;
  BinaryTree<Type> *b,*c;
  root->nodeinfo=a;

  b->root = s.top();
  root->right = b;
  s.pop();

  c->root = s.top();
  root->left = c;
  s.pop();
  s.push(root);
} 
```

s 是 TreeNode* 类型的堆栈并保存节点。root 是单个节点。

改过很多次了，都忘了我是从什么开始的。这是测试代码（setInfo 工作得很好）：

```
tree.setInfo('b');
tree.setInfo('c');
tree.setSubtree('-'); 
```

任何关于我应该如何分配指针的见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:35:01.617

```
BinaryTree<Type> *b,*c;
...
b->root = s.top();
...
c->root = s.top(); 
```

您永远不会初始化指针`b`和`c`.

您应该自己发现了这些错误。将这个站点作为您防止错误的第一道防线是一个非常糟糕的主意。你不会学习如何调试。没有我们的帮助，您怎么会发现这些问题？使用您的编译器、使用分析工具（如 valgrind）、使用调试器，甚至手动执行代码。

通过启用编译器警告，了解如何使用您的编译器。当编译优化并启用足够的警告时，GNU 和 clang 将捕获此类错误。了解如何使用调试器。学习如何手动执行代码。

# twitter - 是否有社交插件可以直接在墙上/推特上发布给某人？

> ID：12573744
> 
> 赞同：0
> 
> 时间：2012-09-24T22:20:10.153
> 
> 标签：twitter, facebook-social-plugins

目前是否有社交插件或直接发布到某人的墙上或直接向某人发推文的方式？

例如，假设我的页面上有一个人员列表：

1.  尼古拉斯凯奇
2.  罗宾·威廉姆斯
3.  吻
4.  粉色的

有没有办法在不离开我的页面的情况下发布到他们的墙上/推文？我目前已将其设置为在新窗口中打开他们的页面，但是能够以这种方式进行操作会更有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T06:20:16.773

您可以在服务器后台执行此操作，但如果社交网站要求确认，您将不得不再次返回给用户。由于所有顶级社交网站都要求确认，您只会捕获之前确认的用户......如果这是值得的努力取决于您。

# java - 使用 Java、Eclipse 创建 RESTful Web 服务教程。Apache Tomcat，不工作

> ID：12573745
> 
> 赞同：16
> 
> 时间：2012-09-24T22:20:12.670
> 
> 标签：java, eclipse, rest, tomcat, web-applications

我想在我的电脑上创建并运行一个简单的 RESTful 应用程序。我在 Eclipse Helios IDE 上使用 Java 编程语言，在 Microsoft Windows Xp 操作系统上使用 Apache Tomcat 7 服务器。

我一直在尝试在我的电脑上复制[本教程的相同过程（从 3 到 3.4 步骤）](http://www.vogella.com/articles/REST/article.html#first)，但它不起作用。

这是我所做的：

*   使用 Apache Tomcat 7 设置在 Eclipse 上创建了一个动态项目

*   将我的 Jersey 和 jsr311-api-1.0 jar 文件放入项目`\WEB-INF\lib\`目录

*   将网页中的代码部分复制到我的项目中

*   右键单击项目，单击“运行方式->在服务器上运行”

*   试图到达`http://localhost:8080/de.vogella.jersey.first/rest/hello`

但我看到的是：

![休息截图](../Images/147a40d299bd6892c08897d12455c1ce.png)

为什么它不起作用？我做错了什么？为什么？

非常感谢！

**编辑：**

这是控制台所说的：

```
25-set-2012 9.35.07 org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Programmi\Java\jdk1.6.0_21\bin;.;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:/Programmi/Java/jre6/bin/client;C:/Programmi/Java/jre6/bin;C:/Programmi/Java/jre6/lib/i386;C:\WINDOWS\;C:\WINDOWS\System32;"C:\ApacheMaven\apache-maven-3.0.4\bin";C:\WINDOWS\;C:\WINDOWS\System32;"C:\ApacheMaven\apache-maven-3.0.4\bin";C:\WINDOWS\;C:\WINDOWS\System32;"C:\ApacheMaven\apache-maven-3.0.4\bin";C:\WINDOWS\System32;C:\WINDOWS\;C:\WINDOWS\System32; C:\Programmi\R-Language\R-2.13.1\bin\;C:\Programmi\OpenVPN\bin\; C:\Programmi\Java\jdk1.6.0_21\bin\; "C:\ApacheMaven\apache-maven-3.0.4\bin";;C:\Programmi\eclipseEC;
25-set-2012 9.35.08 org.apache.tomcat.util.digester.SetPropertiesRule begin
AVVERTENZA: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:de.vogella.jersey.first' did not find a matching property.
25-set-2012 9.35.10 org.apache.coyote.AbstractProtocolHandler init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
25-set-2012 9.35.10 org.apache.coyote.AbstractProtocolHandler init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
25-set-2012 9.35.10 org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 3459 ms
25-set-2012 9.35.10 org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
25-set-2012 9.35.10 org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.6
25-set-2012 9.35.11 org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: urn:com:sun:jersey:api:view is already defined
25-set-2012 9.35.12 org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: urn:com:sun:jersey:api:view is already defined
25-set-2012 9.35.12 org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: urn:com:sun:jersey:api:view is already defined
25-set-2012 9.35.12 org.apache.catalina.core.ApplicationContext log
INFO: Marking servlet Jersey REST Service as unavailable
25-set-2012 9.35.12 org.apache.catalina.core.StandardContext loadOnStartup
GRAVE: Servlet /de.vogella.jersey.first threw load() exception
java.lang.ClassNotFoundException: javax.servlet.Filter
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:616)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1488)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:415)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:397)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:118)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1048)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:996)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4741)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5062)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5057)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:619)
25-set-2012 9.35.12 org.apache.coyote.AbstractProtocolHandler start
INFO: Starting ProtocolHandler ["http-bio-8080"]
25-set-2012 9.35.12 org.apache.coyote.AbstractProtocolHandler start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
25-set-2012 9.35.12 org.apache.catalina.startup.Catalina start
INFO: Server startup in 1790 ms 
```

也许缺少一些课程？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-04T02:35:39.507

要解决您的问题，在不使用 Maven 的情况下，您需要将 JAX-RS facet 添加到您的项目中。这里发生的是 Eclipse 没有将正确的库部署**到服务器**。可以通过项目的 Properties | 访问此配置。项目的方面。

老实说，我不知道要添加哪些特定的 jar 来使 Jersey 工作，因为我使用 Maven 来管理依赖项。因此，我下载了[Jersey bundle](http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-bundle&v=1.14&e=jar)而不是 zip 文件，并使用它配置了 JAX-RS 方面。可以在项目的 Properties | 上看到这个效果。部署程序集，其中 Jersey 的库已配置为部署。顺便说一句，您可以手动将部署的库设置到服务器。

但后来我想起了我为什么使用 Maven 来管理依赖项。该捆绑包不包含运行 Jersey 所需的一切。它缺少 asm jar（存在于 zip 文件中）。所以我不得不将它添加到项目构建路径中，并手动重新配置部署程序集......

所以，这里有一个关于 Maven、Jersey 和 Eclipse的[教程。](http://www.mkyong.com/webservices/jax-rs/jersey-hello-world-example/)试试看，得出你的结论：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T05:50:07.907

我通过相同的教程开发了我的第一个 RESTFUL 服务。一开始我也遇到了几次 404 错误，所以我一直在改变一些东西，最后它对我有用。这就是我所做的-

1) 从 URL-Pattern 选项卡中删除了其余部分；我认为那是错误的。2) 在 URL 中使用上下文根而不是包名。

我的 url 是`"http://mylocalhost:8080/contextroot/classname`在 @path 注释中定义的。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T18:22:18.020

**servlet.jar 不应**位于生成的war 文件中（或 WEB-INF/lib 中）。它应该由应用程序服务器本身提供。（参见 Tomcat 的[常见问题解答](http://wiki.apache.org/tomcat/FAQ/Class_Not_Found#Q2)） 如果您使用 Maven 构建项目，您可以将 servlet api 的范围设置为`provided`（[链接](https://stackoverflow.com/questions/1370414/how-to-add-the-servlet-api-to-my-pom-xml)）。

[StackOverflow](https://stackoverflow.com/questions/8856308/java-lang-noclassdeffounderror-javax-servlet-filter)上的另一个类似问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-04T08:36:20.623

我重复了你的例子，它在我的机器上开箱即用。我下载[了 jersey-archive-1.14.zip](http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-archive&v=1.14&e=zip)并将包含的 lib 目录的全部内容放入 WEB-INF/lib 中，而不是`Jersey`像`jsr311-api-1.0 jar`您所做的那样。

罐子是：

*   asm-3.1.jar
*   杰克逊核心asl-1.9.2.jar
*   杰克逊-jaxrs-1.9.2.jar
*   jackson-mapper-asl-1.9.2.jar
*   杰克逊-xc-1.9.2.jar
*   jersey-client-1.14.jar
*   jersey-core-1.14.jar
*   jersey-json-1.14.jar
*   jersey-server-1.14.jar
*   jersey-servlet-1.14.jar
*   抛弃-1.1.jar
*   jsr311-api-1.1.1.jar

其中一些可能是不必要的，您可以尝试减少它们。但从所有这些开始。

但是，错误消息很奇怪。它说`javax.servlet.Filter`缺少，应该住在 `<your tomcat dir>/lib/servlet-api.jar`. 当您运行 tomcat 时，此文件始终位于类路径中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-29T17:39:01.053

您需要从您的 WEB-INF/lib 目录中删除 servlet.jar 或任何其他包含 javax.servlet.Filter 的 jar。

虽然您需要在您的编译类路径中使用 javax.servlet.Filter 类才能编译示例代码，但您需要确保您的 webapp 中不包含此类。从 Tomcat 类加载器 HOWTO：

> 当Tomcat启动时，它会创建一组类加载器，这些类加载器被组织成以下父子关系，其中父类加载器在子类加载器之上：
> 
> ```
>  Bootstrap
>       |
>    System
>       |
>    Common
>    /     \ 
> ```
> 
> 网络应用 1 网络应用 2 ...

基本上，在 Tomcat 容器中配置的安全性可能无法正确找到 webapp 中的（可能）servlet.jar。

您可以通过打开详细类加载来查看是否正在从奇怪的位置加载 javax.servlet.Filter `verbose:class`。搜索类，如果它不是来自 Tomcat 库，那可能是你的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T20:01:55.363

似乎在类路径中找不到 servlet jersey jar。确保包括它们。我假设您在测试此权利之前将其打包成战争并进行部署。因此，只需检查战争是否包括在编译时可用于您的应用程序的所有 jar。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T16:31:15.187

May be you are missing servlet-api.jar. Add latest jar in your /WEB-INF/lib or classpath and see of it works or not.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-04T01:12:26.890

据我所知，您是在 Eclipse 中运行 Tomcat。有可能您没有使用计算机中的安装目录（即您将 JAR 复制到的目录），但实际上使用的是 Eclipse 在本地创建的临时副本（对不起，我不在我的开发计算机 atm 上，所以无法查看详细信息）？

根据记忆，您有两个选择：

1.  您需要将 Eclipse 用于 Tomcat 的（工作）目录更改为您实际拥有 Tomcat 文件的目录。

2.  您需要使用 Eclipse 中的 GUI 界面将 JAR 添加到 Eclipse 中的 Tomcat。

或者，我在这里可能完全错了;-)

**编辑：**包括我正在谈论的位的屏幕截图。

对于我上面的选项：

1.  请参阅中间的“服务器位置”需要在“控制 tomcat 安装”的位置。
2.  当您单击下图中“常规信息”框中的“打开启动配置”链接时，将它们添加到类路径选项卡中

![在此处输入图像描述](../Images/08f69541eb466e736906239419d9112c.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-29T14:45:33.447

按照相同的教程，我也遇到了 HTTP 状态 404 问题。

首先，我尝试使用 Jersey 库 1.18 和 2.15 在 Eclipse 中设置 JAX-RS Project Facet，但没有成功。

最后我通过用上下文根（即eclipse项目名称）替换URL中的包名（de.vogella.jersey.first）解决了这个问题。

[mkyong.com 的本教程](http://www.mkyong.com/webservices/jax-rs/jersey-hello-world-example/)给了我寻找解决方案的提示。无论如何，我不知道 URL 中的包名称是否肯定是错误的，或者是否有一些配置细节可以使其正常工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-12T17:03:33.753

我有这个错误超过一天！事实证明，问题来自于不同版本的 Jersey 的使用。如果你用我在下面展示的内容替换你的 web.xml 内容，那就没问题了！

```
 <servlet>
    <servlet-name>Jersey REST Service</servlet-name>
    <servlet-class>org.glassfish.jersey.servlet.ServletContainer</servlet-class>    
    <init-param>
      <param-name>jersey.config.server.provider.packages</param-name>
      <param-value>de.vogella.jersey.first</param-value>
    </init-param>
    <init-param>
     <param-name>unit:WidgetPU</param-name>
     <param-value>persistence/widget</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Jersey REST Service</servlet-name>
    <url-pattern>/rest/*</url-pattern>
  </servlet-mapping> 
```

希望我的回答能为也决定遵循相同教程的其他人节省大量时间！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-28T21:17:06.450

从 WEB-INF/lib 文件夹中删除 servlet.jar。Servlet.jar 不应该在那里，这为我解决了这个问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-17T06:49:11.283

您应该添加在 jersey 1.6 存档中找到的所有 jar，下载[此](http://download.java.net/maven/2/com/sun/jersey/jersey-archive/1.6/)存档并将所有 jar 添加到项目的**WebContent/WEB-INF/lib**文件夹中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-09-29T00:03:53.533

就像之前提到的答案一样。你缺少一些罐子。您可以将这些 jar 文件添加到**Project>WebContent>WEB-INF>lib>**文件夹或网络服务器的 lib 文件夹中（例如，**\apache-tomcat\lib**）

如果您希望我们告诉您您缺少的确切 jar，请尝试粘贴两个 lib 文件夹的列表或屏幕截图。

希望这可以帮助

# javascript - 主干：ID 未设置为模型

> ID：12573750
> 
> 赞同：6
> 
> 时间：2012-09-24T22:20:49.943
> 
> 标签：javascript, backbone.js

我尝试了以下方法来为我的模型设置一个 ID：

```
var globalCounter = 1;

var Model = Backbone.Model.extend({
    initialize: function () {
        this.id = globalCounter;
        globalCounter += 1;
    }
});

myModel = new Model();
console.log(myMode.get('id')); // prints undefined 
```

如何为我的模型设置 ID？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-24T22:26:31.537

您需要改用该[`set()`](http://backbonejs.org/#Model-set)功能（[http://jsbin.com/agosub/1/](http://jsbin.com/agosub/1/)）；

```
var globalCounter = 1;

var Model = Backbone.Model.extend({
    initialize: function () {
        this.set('id', globalCounter);
        globalCounter += 1;
    }
});

myModel = new Model();
console.log(myModel.get('id')); // prints 1 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-24T22:52:13.837

您必须使用：

```
this.set('id', globalCounter); 
```

代替`this.id = globalCounter;`

您正在将 id 值添加到 Model 对象，但您想将其添加到**Model.attributes**对象。这就是 Model.set() 方法在做什么。

`model.set("key", value)`将值放入`model.attributes.key;`

`model.get("key")`将返回里面的值`model.attributes.key`

对于 Backbone 的新手来说，这有点奇怪，但它是一个主要的（并且很容易）获得的点。它的设计目的是使用`model.set(...)`将触发更改事件，您可以轻松捕获以更新您的视图。

## 骨干网和 ES6 更新：

Backbone 属性对象被 ES6 getter 和 setter 过时了。这些函数可以覆盖标准访问。

警告：这是一个伪代码，有一天可能会与 ES6 一起使用！

```
class MyModel extends Backbone.Model{

    get id(){ return this.attributes.id; }
    set id(id){ this.attributes.id = id; }

} 
```

这将允许写：

```
let myModel = new Model();
myModel.id = 13; // will use myModel.id(13)
console.log (myModel.id); // will show myModel.id() 
```

到今天为止，这只是 Backbone 2 的梦想。经过基本搜索，我没有看到任何关于它的到来。

# mongodb - 在 Mongoose / MongoDB 中创建多字段索引

> ID：12573753
> 
> 赞同：105
> 
> 时间：2012-09-24T22:20:55.357
> 
> 标签：mongodb, mongoose

我正在尝试查找有关如何在 Mongoosejs 中创建多字段索引的文档，但无济于事。特别是我有两个需要索引和唯一的字段。将两个字段索引在一起的示例猫鼬模式是什么？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2012-09-24T22:53:13.060

您调用对象`index`上的方法来执行[此](http://mongoosejs.com/docs/guide.html#indexes)`Schema`操作，如此处所示。对于您的情况，它将类似于：

```
mySchema.index({field1: 1, field2: 1}, {unique: true}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-09T23:18:47.390

创建复合索引时，必须在模式级别定义索引。

```
animalSchema.index({ name: 1, type: -1 }); 
```

参考： http: [//mongoosejs.com/docs/guide.html#indexes](http://mongoosejs.com/docs/guide.html#indexes)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2018-04-23T05:47:17.920

```
 Following command can be used to create compound index for nested json:
    db.ACCOUNT_collection.createIndex({"account.id":1,"account.customerId":1},{unique:1}) 
Mongo json structure is like :
{"_id":"648738"
 "account": { 
    "id": "123",
    "customerId": 7879,
    "name": "test"
   ..
   ..

  }
} 
```

我已经用样本数据进行了测试，它完全可以按预期工作。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2020-03-19T00:48:26.093

顺便说一句，接受的答案是错误的，根据[https://stackoverflow.com/a/52553550/129300](https://stackoverflow.com/a/52553550/129300)您应该将字段名称用单引号括起来，即：

```
mySchema.index({'field1': 1, 'field2': 1}, {unique: true}); 
```

愉快的一天！

# box-api - 如果我的身份验证令牌过期，Box 会返回什么？

> ID：12573754
> 
> 赞同：0
> 
> 时间：2012-09-24T22:20:56.300
> 
> 标签：box-api

当我使用过期的 auth_token 向 Box API 发出请求时，Box 会返回什么 HTTP 状态代码和错误？有没有简单的方法来模拟这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:13:50.680

API 应返回`401 Unauthorized`一条指示“未经授权”的消息。

# android - AdMob 不会在 Jelly Bean、ReferenceError、AMFA_getSdkConstants 未定义上加载横幅

> ID：12573756
> 
> 赞同：1
> 
> 时间：2012-09-24T22:21:04.667
> 
> 标签：android, admob, referenceerror

我正在使用 admob sdk (6.1.0) 在我的自定义 ListFragments 顶部显示两个横幅，并在 onActivityCreated() 的每个片段中使用此代码：

```
LinearLayout adLayout = new LinearLayout(getActivity());
adView = new AdView(getActivity(), AdSize.SMART_BANNER, "xxxxxxxxxxxxx");
adView.loadAd(new AdRequest());
adLayout.addView(adView);
getListView().addHeaderView(adLayout); 
```

在姜饼上的旧 LG Optimus 2X 上一切正常，但现在我在 Jelly Bean 上安装了三星 Galaxy S3，我的广告将不再显示！我收到此错误：

```
09-24 23:07:35.661: I/Ads(24043): Refreshing ad.
09-24 23:07:35.691: I/webclipboard(24043): clipservice: android.sec.clipboard.ClipboardExManager@42a88b90
09-24 23:07:35.696: V/webkit(24043): BrowserFrame constructor: this=Handler (android.webkit.BrowserFrame) {42cc0c00}
09-24 23:07:35.726: I/Ads(24043): adRequestUrlHtml: <html><head><script src="http://media.admob.com/sdk-core-v40.js"></script><script>AFMA_getSdkConstants();AFMA_buildAdURL({"kw":[],"preqs":2,"session_id":"16934128083720156505","u_sd":2,"seq_num":"3","slotname":"xxxxxxxxxxxx","u_w":360,"msid":"com.thiost.android.twire","js":"afma-sdk-a-v6.1.0","toar":2,"mv":"8014017.com.android.vending","isu":"605557A27D3A2A6A54663D68CFF48311","cipa":0,"format":"320x50_mb","net":"wi","app_name":"903.android.com.thiost.android.twire","hl":"nl","u_h":640,"carrier":"20404","ptime":120187,"u_audio":3});</script></head><body></body></html>
09-24 23:07:35.916: E/Ads(24043): JS: Uncaught ReferenceError: AFMA_getSdkConstants is not defined (about:blank:1)
09-24 23:07:35.916: E/Web Console(24043): Uncaught ReferenceError: AFMA_getSdkConstants is not defined:1
09-24 23:08:35.716: I/Ads(24043): AdLoader timed out after 60000ms while getting the URL.
09-24 23:08:35.721: D/webviewglue(24043): nativeDestroy view: 0x531a3420
09-24 23:08:35.726: I/Ads(24043): onFailedToReceiveAd(A network error occurred.)
09-24 23:09:35.786: I/Ads(24043): Refreshing ad.
09-24 23:09:35.811: I/webclipboard(24043): clipservice: android.sec.clipboard.ClipboardExManager@42a88b90
09-24 23:09:35.821: V/webkit(24043): BrowserFrame constructor: this=Handler (android.webkit.BrowserFrame) {42d893c0}
09-24 23:09:35.851: I/Ads(24043): adRequestUrlHtml: <html><head><script src="http://media.admob.com/sdk-core-v40.js"></script><script>AFMA_getSdkConstants();AFMA_buildAdURL({"kw":[],"preqs":3,"session_id":"16934128083720156505","u_sd":2,"seq_num":"4","slotname":"xxxxxxxxxxxx","u_w":360,"msid":"com.thiost.android.twire","js":"afma-sdk-a-v6.1.0","toar":3,"mv":"8014017.com.android.vending","isu":"605557A27D3A2A6A54663D68CFF48311","cipa":0,"format":"320x50_mb","net":"wi","app_name":"903.android.com.thiost.android.twire","hl":"nl","u_h":640,"carrier":"20404","ptime":240317,"u_audio":3});</script></head><body></body></html>
09-24 23:09:35.881: D/dalvikvm(24043): GC_CONCURRENT freed 1150K, 26% free 14863K/20039K, paused 6ms+5ms, total 50ms
09-24 23:09:35.996: E/Ads(24043): JS: Uncaught ReferenceError: AFMA_getSdkConstants is not defined (about:blank:1)
09-24 23:09:35.996: E/Web Console(24043): Uncaught ReferenceError: AFMA_getSdkConstants is not defined:1 
```

只有当应用程序在 WiFi 连接上首次加载添加时，我才会收到此错误。在 WiFi 上的所有其他时间它给了我这个错误：

```
09-25 17:29:37.600: W/Ads(23165): IOException connecting to ad url.
09-25 17:29:37.600: W/Ads(23165): java.net.ConnectException: failed to connect to googleads.g.doubleclick.net/127.0.0.1 (port 80): connect failed: ECONNREFUSED (Connection refused)
09-25 17:29:37.600: W/Ads(23165):   at libcore.io.IoBridge.connect(IoBridge.java:114)
09-25 17:29:37.600: W/Ads(23165):   at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
09-25 17:29:37.600: W/Ads(23165):   at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
09-25 17:29:37.600: W/Ads(23165):   at java.net.Socket.connect(Socket.java:842)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpConnection.<init>(HttpConnection.java:76)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:341)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpEngine.connect(HttpEngine.java:310)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
09-25 17:29:37.600: W/Ads(23165):   at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
09-25 17:29:37.600: W/Ads(23165):   at com.google.ads.internal.f.b(SourceFile:459)
09-25 17:29:37.600: W/Ads(23165):   at com.google.ads.internal.f.run(SourceFile:430)
09-25 17:29:37.600: W/Ads(23165):   at java.lang.Thread.run(Thread.java:856)
09-25 17:29:37.600: W/Ads(23165): Caused by: libcore.io.ErrnoException: connect failed: ECONNREFUSED (Connection refused)
09-25 17:29:37.600: W/Ads(23165):   at libcore.io.Posix.connect(Native Method)
09-25 17:29:37.600: W/Ads(23165):   at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
09-25 17:29:37.600: W/Ads(23165):   at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
09-25 17:29:37.600: W/Ads(23165):   at libcore.io.IoBridge.connect(IoBridge.java:112)
09-25 17:29:37.600: W/Ads(23165):   ... 16 more 
```

它不会在移动互联网连接上出错...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T16:41:03.973

我弄清楚了问题所在。我已经刷了一个新的 rom，它安装了一个新的 hosts 文件，它阻止了我的广告...删除 hosts 文件后，显示了广告

# php - 在 codeigniter 中，我如何按名称获取 uri 段？

> ID：12573758
> 
> 赞同：1
> 
> 时间：2012-09-24T22:21:06.073
> 
> 标签：php, codeigniter, url, parameters, uri

我有最新的 codeigniter 版本，想知道如何通过参数名称获取 url 中的段。例如，这是一个示例 url：

```
www.somewebsitedomain.com/param1=something/param2=somethingelse/ 
```

现在假设我想获得'param1'的值，即'something'，我将如何使用uri类来做到这一点？

因为默认情况下，uri 类仅按数字或它们出现的顺序获取段，但我想通过该段中的参数名称获取段。或者一般只获取参数值。希望这是有道理的...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:40:13.367

你可以这样做`$this->uri->uri_to_assoc(n)`，这将给出如下内容

```
[array]
 (
'name' => 'joe'
'location'  => 'UK'
'gender'    => 'male'
) 
```

然后只是你想要的参数名称。

来源：[http ://codeigniter.com/user_guide/libraries/uri.html](http://codeigniter.com/user_guide/libraries/uri.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T13:49:48.910

您实际上可以将它们作为 GET 变量并使用[Input Class](http://codeigniter.com/user_guide/libraries/input.html)：

```
$param = $this->input->get('param1'); // something 
```

或者你可以这样做：

```
$params = $this->input->get(); // array('param1' => 'something', 'param2' => 'somethingelse') 
```

获取所有参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T04:17:50.440

我不确定这是您要问的，但在许多应用程序中，URL 遵循 www.domain.com/controller/method/key1/value1/key2/value2 的形式。所以我决定扩展 CI_URI 类以返回任何“键”的值。

如果你把它放在你的应用程序/核心文件夹中，在一个名为 MY_URI.php 的文件中，它会扩展内置的 URI 类：

```
class MY_URI extends CI_URI {

    /* call parent constructor */
    function __construct() {
        parent::__construct();
    }

    /* return value of the URI segment
       which immediately follows the named segment */
    function getNamed($str=NULL) {

        $key = array_search($str, $this->segments);

        if ($key && isset($this->segments[$key+1])) {
            return $this->segments[$key+1];
        }

        return false;

    }

} 
```

然后，如果您的 URL 采用以下形式

```
www.somewebsitedomain.com/param1/something/param2/somethingelse/ 
```

您可以按如下方式调用此函数：

`$this->uri->getNamed('param1)`- 返回“某物”

`$this->uri->getNamed('param2)`- 返回“其他东西”

# python - 从 numpy 数组在 paraview 中创建等高线图

> ID：12573759
> 
> 赞同：3
> 
> 时间：2012-09-24T22:21:14.570
> 
> 标签：python, numpy, paraview, mayavi

我有一个大的二进制文件，其中包含我想要绘制的所有信息。数据的排序方式使其最容易读入 3D numpy 数组，当我使用 Mayavi 使用[contour3d()](http://docs.enthought.com/mayavi/mayavi/auto/mlab_helper_functions.html)函数对其进行绘图时，这工作得很好。现在我正在使用 Paraview，但我找不到任何关于如何完成同样事情的示例。似乎获取数据的唯一方法是直接从多种格式之一的文件中读取数据，而不是 numpy 数组。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:42:29.183

据我了解，`mayavi`它是基于的，旨在支持和更轻松地处理 NumPy[`tvtk`](https://svn.enthought.com/enthought/wiki/TVTK)的包装器。`vtk``Traits`

`ParaView`另一方面，它基于 pure `vtk`，这使得直接操作变得不那么简单`ndarrays`。但是，一些支持功能是现成的：

```
>>> from vtk.util import numpy_support as npvtk
>>> vtkarray = npvtk.numpy_to_vtk(numpy_array)
>>> numpy_array = npvtk.vtk_to_numpy(vtkarray) 
```

更多阅读：

*   wiki中的[示例](http://www.vtk.org/Wiki/VTK/Examples/Python/vtkWithNumpy)`vtk`总是一个好的开始。
*   [vtk 邮件列表存档](http://vtk.1045678.n5.nabble.com/Python-numpy-array-gt-vtkImage-gt-paraview-td5551250.html)也可以帮助您。

# ios - 如何为我的 iOS 应用构建启动器？

> ID：12573761
> 
> 赞同：0
> 
> 时间：2012-09-24T22:21:29.830
> 
> 标签：ios, ios5, launcher

我正在尝试为我的应用程序构建一个主页启动器...类似于[Three20](http://three20.info/showcase/launcher)中的那个。

![在此处输入图像描述](../Images/98fbd9e2ef17a5689faa9f7284562e72.png)

**我不想重新发明轮子**，但是像 Three20 这样的解决方案不是我要寻找的：它们没有更新到最新的 iOS 系统或设备（视网膜、ARC、iOS5/6），而且它们做的远比什么我需要（我基本上需要一组带有在设备旋转时旋转的标签的按钮）。

现在我正在尝试构建一个在设备旋转时旋转的 2x3 按钮网格，但代码看起来很糟糕，我需要添加 iPhone5 支持......

```
- (void) updateLayoutForNewOrientation: (UIInterfaceOrientation) orientation {

    if (UIInterfaceOrientationIsPortrait(orientation)) {
        button1.frame = CGRectMake(20, 59, 130, 80);
        button2.frame = CGRectMake(170, 59, 130, 80);
        button3.frame = CGRectMake(20, 176, 130, 80);
        button4.frame = CGRectMake(170, 176, 130, 80);
        button5.frame = CGRectMake(20, 293, 130, 80);
        button6.frame = CGRectMake(170, 293, 130, 80);

        label1.frame  = CGRectMake(20, 147, 130, 21);
        label2.frame  = CGRectMake(170, 147, 130, 21);
        label3.frame  = CGRectMake(20, 264, 130, 21);
        label4.frame  = CGRectMake(170, 264, 130, 21);
        label5.frame  = CGRectMake(20, 381, 130, 21);
        label6.frame  = CGRectMake(170, 381, 130, 21);
    } else {
        button1.frame = CGRectMake(20, 59, 130, 60);
        button2.frame = CGRectMake(177, 59, 130, 60);
        button3.frame = CGRectMake(328, 59, 130, 60);
        button4.frame = CGRectMake(20, 155, 130, 60);
        button5.frame = CGRectMake(177, 155, 130, 60);
        button6.frame = CGRectMake(328, 155, 130, 60);

        label1.frame  = CGRectMake(20, 127, 130, 21);
        label2.frame  = CGRectMake(177, 127, 130, 21);
        label3.frame  = CGRectMake(328, 127, 130, 21);
        label4.frame  = CGRectMake(20, 223, 130, 21);
        label5.frame  = CGRectMake(177, 223, 130, 21);
        label6.frame  = CGRectMake(328, 223, 130, 21);
    }
} 
```

“放置东西，旋转它”方法是构建这种组件的唯一方法吗？有没有其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T20:50:15.507

您可能想自己编写代码，但这里有一个很棒的开源启动器：

[https://github.com/fieldforceapp/openspringboard](https://github.com/fieldforceapp/openspringboard)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T20:54:05.013

将按钮和标签放在视图中。然后，在旋转时，您必须重新排列视图。

此外，您可以使用 a`for`重新排列它们，这样您就可以通过一些代码来获得这种效果。

```
-(void)setScreenIconsToInterfaceRotation:(UIInterfaceOrientation)toInterfaceOrientation {
    NSArray * viewsArray = [NSArray arrayWithObjects:view1,view2,view3,view4,view5,view6, nil];  

    int currentIndex = 0;

    for (UIView * currentView in ViewsArray) {

        int x;
        int y;
        int xseparation = 20;
        int yseparation;
        int height;
        int width = 130;
        if (toInterfaceOrientation==UIDeviceOrientationPortrait || toInterfaceOrientation==UIDeviceOrientationPortraitUpsideDown)
        { 

            x = currentIndex %2;
            y = currentIndex /2;
            height = 101;
            if (currentIndex < 2) {
                yseparation = 59;
            } else {
                yseparation = 16;
            }

        } else {
            x = currentIndex %3;
            y = currentIndex /3;
            height = 81;
            if (currentIndex < 3) {
                yseparation = 59;
            } else {
                yseparation = 15;
            }

        }

        [currentView setFrame:CGRectMake(x*width+((x+1)*xseparation), y*height+((y+1)*yseparation), width, height)];

        currentIndex++;
        }

} 
```

这是您的示例的代码

那么对于ios6

```
-(void)viewWillLayoutSubviews {
        [self setScreenIconsToInterfaceRotation:[[UIApplication sharedApplication] statusBarOrientation]];
    } 
```

和ios5

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
    {

    [self setScreenIconsToInterfaceRotation:toInterfaceOrientation]; 

} 
```

# html - 如何使元素成为页面的全高？

> ID：12573766
> 
> 赞同：7
> 
> 时间：2012-09-24T22:21:57.650
> 
> 标签：html

有没有办法可以设置一个 DIV 元素来占据页面上的所有高度。就像是：

```
div.left {
  height: 100%;
  width: 50%;
  background-color: blue;
  position: absolute;
  top: 0;
  left: 0;
} 
```

我已经用谷歌搜索了几次，但对于一个简单的解决方案可能是一个非常简单的问题，它们似乎都是非常复杂的解决方法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-24T22:33:54.047

如果`div`是 的直接子级`body`，则有效：

```
body, html {height: 100%; }
div { height: 100%; } 
```

否则，您必须不断添加`height: 100%`它的每个父母，祖父母，......直到您达到`body`.

这很简单。要使百分比高度起作用，父级必须具有指定的高度（px，％...无论哪个）。如果没有，那么就好像你已经设置了`height: auto`;

另一种方法是你在你的答案中：它是给它一个绝对位置值，相对于定义页面高度的元素。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-12-26T21:23:46.750

这是让 div 占据整个页面高度的最简单方法。

```
height: 100vh; 
```

`vh`是**视口高度**，`1vh`等于视口高度的 1%。有关 CSS 中此度量单位和其他度量单位的更多详细信息，请参见[此处](https://www.sitepoint.com/css-viewport-units-quick-start/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T22:29:26.870

确保您设置`height: 100%`为`html`and`body`以便 div 具有高度的上下文！希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-24T22:30:48.713

很确定您需要将`html`and设置`body`为 100%：

```
html {
  height: 100%;
}

body {
  height: 100%;
}

div.left {
  height: 100%;
} 
```

[在这里](http://jsfiddle.net/ultranaut/yMPkv/)拉小提琴。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-25T12:50:36.690

这个问题可以使用`CSS`flexbox 来解决。[在此处](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)浏览 flexbox 的 w3schools 文档，并[在此处查看](https://www.w3schools.com/css/css3_flexbox.asp)另一个有用的链接 css-tricks

在这种情况下。

放显示：弹性；在父 div 容器中

```
div.container{
  height: 100%;
  display: flex;
} 
```

然后在子 div 中放置 display: 1;

```
div.left{
  height: 100%;
  display: 1;
} 
```

请注意，如果父 div 容器的高度是动态设置的，则子 div 将始终与父 div 具有相同的高度。

# heroku - 如何重置/恢复 Heroku 配置？

> ID：12573768
> 
> 赞同：3
> 
> 时间：2012-09-24T22:22:05.243
> 
> 标签：heroku

由于每次使用`heroku config:add`它添加键/值都会返回一个版本，是否可以恢复到旧版本？

如果没有，是否可以清除所有`heroku config`，因为我有一个`.env`我想推送的本地变量，但它不会清除其他变量。

我不能使用的原因`heroku config:unset`是因为一些错误，我可以在那里放一个空键。

`: true`

不是我无法摆脱它，而且构建不断失败-_-'

** 更新 **

刚刚发现`heroku releases`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T06:45:58.680

运行`heroku rollback`会回滚到以前的版本，你也可以用它指定一个旧版本。完整的 heroku 文档对此有更多信息 - [https://devcenter.heroku.com/articles/releases#rollback](https://devcenter.heroku.com/articles/releases#rollback)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-14T16:36:49.597

[https://devcenter.heroku.com/articles/releases#rollback](https://devcenter.heroku.com/articles/releases#rollback)

它将提供更多的发布细节。$ heroku 发布：信息 v24

v24 是您的版本名称，可能会有所不同。

# excel - 无法让 LibXL xlSheetGetNamedRange 工作

> ID：12573771
> 
> 赞同：1
> 
> 时间：2012-09-24T22:22:09.433
> 
> 标签：excel, libxl

我正在尝试使用 LibXL。我可以从工作表中提取数据，但需要一个函数将带有 Excel 行和列索引的字符串转换为 startRow、endRow、startCol、endCol 即

"A1:B3" 进入 startRow = 0, endRow = 2, startCol = 0, endCol = 1（LibXL 使用基于 0 的索引）

我已经尝试了我能想到的一切。该库没有附带任何使用此函数的示例，并且文档非常稀少。我究竟做错了什么？

这是我的代码：

```
int main()
{
    const char range[] = "B2:C3";
    int i, ret, rowFirst=0, rowLast=0, colFirst=0, colLast=0;
    BookHandle book;
    SheetHandle sheet;

    book = xlCreateBook();

    ret = xlBookLoad(book, "/home/jason/Downloads/panel.xls");

    sheet = xlBookGetSheet(book, 0);

    ret = xlSheetGetNamedRange(sheet, &range[0], &rowFirst, &rowLast, &colFirst, &colLast);

    printf("ret from xlSheet...Range = %d\n", ret);

    printf("%s\n", xlBookErrorMessage(book));
    printf("rowLast = %d\n", rowLast);
    printf("rowLast = %d\n", rowLast);
    printf("colFirst = %d\n", colFirst);
    printf("colLast = %d\n", colLast);

    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:43:44.747

为此目的使用 xlSheetAddrToRowCol() 函数：

```
int rowStart, colStart, rowEnd, colEnd;
int rowRelativeStart, colRelativeStart, rowRelativeEnd, colRelativeEnd;

xlSheetAddrToRowCol(sheet, "B2", &rowStart, &colStart, &rowRelativeStart, &colRelativeStart);
xlSheetAddrToRowCol(sheet, "C3", &rowEnd, &colEnd, &rowRelativeEnd, &colRelativeEnd); 
```

# .net - DDay.iCal Outlook 与时区和重复模式的兼容性

> ID：12573772
> 
> 赞同：3
> 
> 时间：2012-09-24T22:22:18.177
> 
> 标签：.net, outlook-2007, rfc2445, rfc5545, dday

我有一些运气让 Outlook 通过电子邮件接受我的 .ics 文件并将它们解释为日历邀请，但我遇到了时区问题。

最初，我发现如果我的所有日​​期都以 UTC 提供，Outlook 会做正确的事情（正确的事情是在显示事件时将时间转换为系统的时区设置）。这是 iCalendar 文件：

```
BEGIN:VCALENDAR
VERSION:2.0
METHOD:REQUEST
PRODID:-//ddaysoftware.com//NONSGML DDay.iCal 1.0//EN
BEGIN:VEVENT
ATTENDEE;CN=MIke;ROLE=REQ-PARTICIPANT;PARTSTAT=TENTATIVE;CUTYPE=IND
 IVIDUAL;RSVP=TRUE:MAILTO:mike@host.com
DESCRIPTION:df
DTEND:20120924T230000Z
DTSTAMP:20120924T221102Z
DTSTART:20120924T223000Z
LAST-MODIFIED:20120924T221102Z
ORGANIZER;CN=Buddy Boy:MAILTO:buddyboy@host.com
SEQUENCE:0
SUMMARY:dasdfasdf
UID:cfa64be5-e731-4209-bef9-bf178432ae57
END:VEVENT
END:VCALENDAR 
```

不幸的是，当我添加重复事件时，由于某种原因，Outlook 不会这样做。因此，我尝试使用以下方法将时区添加到我的 iCalendar 文件中：

```
_calendar.AddTimeZone(myTimeZone); 
```

奇怪的是附件显示为“不支持的日历 event.ics”，但是当我打开附件时，Outlook 可以很好地解释文件（大部分情况下）。

这是 iCalendar 文件：

```
BEGIN:VCALENDAR
VERSION:2.0
METHOD:REQUEST
PRODID:-//ddaysoftware.com//NONSGML DDay.iCal 1.0//EN
BEGIN:VTIMEZONE
TZID:Eastern Standard Time
BEGIN:STANDARD
DTSTART;VALUE=DATE:18000101
RRULE:FREQ=YEARLY;BYDAY=SU;BYHOUR=2;BYMINUTE=0;BYMONTH=10;BYMONTHDAY=25,26,
 27,28,29,30,31
TZOFFSETFROM:-0400
TZOFFSETTO:-0500
END:STANDARD
BEGIN:DAYLIGHT
DTSTART;VALUE=DATE:18000101
RRULE:FREQ=YEARLY;BYDAY=SU;BYHOUR=2;BYMINUTE=0;BYMONTH=4;BYMONTHDAY=1,2,3,4
 ,5,6,7
TZOFFSETFROM:-0500
TZOFFSETTO:-0400
END:DAYLIGHT
BEGIN:STANDARD
DTSTART;VALUE=DATE:20070101
RRULE:FREQ=YEARLY;BYDAY=SU;BYHOUR=2;BYMINUTE=0;BYMONTH=11;BYMONTHDAY=1,2,3,
 4,5,6,7
TZOFFSETFROM:-0400
TZOFFSETTO:-0500
END:STANDARD
BEGIN:DAYLIGHT
DTSTART;VALUE=DATE:20070101
RRULE:FREQ=YEARLY;BYDAY=SU;BYHOUR=2;BYMINUTE=0;BYMONTH=3;BYMONTHDAY=8,9,10,
 11,12,13,14
TZOFFSETFROM:-0500
TZOFFSETTO:-0400
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VEVENT
ATTENDEE;CN=MIke;ROLE=REQ-PARTICIPANT;PARTSTAT=TENTATIVE;CUTYPE=IND
 IVIDUAL;RSVP=TRUE:MAILTO:mike@host.com
DESCRIPTION:sadf
DTEND:20120924T190000
DTSTAMP:20120924T221645Z
DTSTART:20120924T183000
LAST-MODIFIED:20120924T221645Z
ORGANIZER;CN=Buddy Boy:MAILTO:buddyboy@host.com
SEQUENCE:0
SUMMARY:sdfadsfadsf
UID:61a57e06-7b6c-41fa-a640-1b217715e905
END:VEVENT
END:VCALENDAR 
```

有谁知道这个文件前景的哪个部分有问题？或者，也许更重要的是，有没有人知道我可以在 dday.iCal 中做什么来让前景快乐？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T18:39:57.793

首先，您必须使用 TZID 标识符，以便日历知道*事件*是哪个时区而不是日历

[https://www.rfc-editor.org/rfc/rfc5545#section-3.2.19](https://www.rfc-editor.org/rfc/rfc5545#section-3.2.19)

这将导致更改您的 DTSTART

从：

```
DTSTART:20120924T183000 
```

到：

```
DTSTART;TZID=Eastern Standard Time:19980119T020000 
```

然后，您还应该从以下位置更改您的时区定义（尤其是 RRULE、DTSTART）：

```
DTSTART;VALUE=DATE:18000101
RULE:FREQ=YEARLY;BYDAY=SU;BYHOUR=2;BYMINUTE=0;BYMONTH=10;BYMONTHDAY=25,26,27,28,29,30,31 
```

到：

```
BEGIN:VTIMEZONE
TZID:Eastern Standard Time
LAST-MODIFIED:19870101T000000Z
BEGIN:STANDARD
DTSTART:19671029T020000
RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=10
TZOFFSETFROM:-0400
TZOFFSETTO:-0500
TZNAME:EST
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:19870405T020000
RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=4
TZOFFSETFROM:-0500
TZOFFSETTO:-0400
TZNAME:EDT
END:DAYLIGHT
END:VTIMEZONE 
```

`

# php - Htaccess 将 php 文件重命名为友好的 url

> ID：12573774
> 
> 赞同：0
> 
> 时间：2012-09-24T22:22:33.183
> 
> 标签：php, .htaccess, mod-rewrite, rewrite, rename

我的问题是我想用 htaccess 重命名这 2 个 url，但我不知道

想转换

```
mydomain.com/info.php?act=statistics
mydomain.com/info.php?act=about_us 
```

进入

```
mydomain.com/statistics
mydomain.com/about_us 
```

我将非常感激，因为我对 htaccess 一无所知。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:25:13.620

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /info.php?act=$1 [L] 
```

这会将 /whatever 传递给 /info.php?act=whatever ！-f 和！-d RewriteCond 首先检查以确保文件不存在。

# android - 缩放九切片图像android

> ID：12573777
> 
> 赞同：0
> 
> 时间：2012-09-24T22:23:08.233
> 
> 标签：android, nine-patch, image-scaling

我有一个文本字段的图像，我想将其作为文本字段的背景。我制作了一个九层图像，这样我可以改变图像的大小，但保留角落的完整性。我的可绘制 xhdpi 中有这个图像，我想在我的 hdpi 和 mdpi 中使用相同的图像。我需要为我的应用程序中的多个图像执行此操作，因此我不想为每个像素密度制作一个九切片图像。当我将我的九个切片拖入照片商店以更改图像的大小时，文本框上方和侧面的黑线现在位于图像中，而不是图像上方/左侧的像素。有什么方法可以缩放我的九个切片吗？还是我必须为每个像素密度制作九个切片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:26:57.513

经验法则：当您为每个密度缩放图像时，即使高度和宽度是整数倍，也要注意混叠问题。

也就是说：为每个像素密度制作九个切片以确保安全，因为您的黑点/线条可能会被切掉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:30:17.537

如果您想对所有这些图像使用相同的图像，只需在`res`called中创建一个新文件夹`drawable-nodpi`，它就会对所有密度使用相同的图像而不进行缩放。如果边框很薄，这就是我对大部分 9 补丁所做的。如果您打算在 xhdpi 设备上加粗边框，请记住，如果您使用相同的设备，它们在 mdpi 设备上会显得更粗。`nodpi`在我看来，如果这不是问题，请采用这种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T20:19:52.433

使用 Photoshop 缩放图像将删除或添加图像到图像中的像素。当它这样做时，它将改变缩放/填充参考线，使它们不再是 1 像素宽和纯黑色。为避免这种情况，请在缩放图像之前裁剪图像以删除参考线，然后将它们重新添加。

或者，您可以 使用此 Google 9-patch 工具[将 9-patch图像转换为其他分辨率。](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/nine-patches.html)

# java - Scala Lift - 从“/resources/toserve”读取文件

> ID：12573783
> 
> 赞同：2
> 
> 时间：2012-09-24T22:24:10.027
> 
> 标签：java, file, scala, lift

我正在尝试为`StreamingResponse`存储在 Lifts resources/toserve 目录下的文件提供一个文件，以便授权不同用户的访问。

例如，我可以通过以下方式访问图像：

本地主机：8080/classpath/images/test.jpg

但是，当我尝试使用 scala 实际读取文件时，我不断收到未找到文件的异常：

```
val file = new java.io.FileInputStream("/classpath/images/test.jpg") 
```

是否有特定的方法来读取位于类路径上的文件？

在此先感谢，非常感谢:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T14:56:17.307

要从 toserve-directory 读取资源，您需要执行如下调用

```
LiftRules.getResource("/toserve/images/test.jpg") 
```

如果您尝试使用“classpath”而不是“toserve”，您将收到一个空框。

默认情况下，Lift 使用两种不同的路径前缀在服务器中以编程方式或通过 HTML 中的链接元素来定位资源。对于前者，您将使用“toserve”前缀，对于后者，您将使用“classpath”前缀。

此行为在对象 net.liftweb.http.LiftRules 和 net.liftweb.http.ResourceServer 中指定。特别是，您可以在那里指定（即替换）资源的路径。相关代码为：

```
/** (from net.liftweb.http.ResourceServer)
 * The base package for serving resources.  This way, resource names can't be spoofed
 */
var baseResourceLocation = "toserve" 
```

您可能还想查看 LiftRules 中的以下方法，它允许您重新定义用于通过服务器提供资源的名称：

```
/** (from net.liftweb.http.LiftRules)
 * The path to handle served resources
 */
@volatile var resourceServerPath = "classpath" 
```

如果您希望使用相同的前缀来引用这两个资源，您可以使用这些设置中的一个（或两个）来实现您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T03:05:55.527

你有没有尝试过：

```
LiftRules.getResource("/classpath/images/test.jpg") 
```

这应该将 java.net.URL 返回到您要查找的项目。

这也可能包含有关您要执行的操作的更多信息：[http ://exploring.liftweb.net/master/index-9.html#lst:streaming-download](http://exploring.liftweb.net/master/index-9.html#lst:streaming-download)

# c# - Linq 问题中的分组和计数

> ID：12573785
> 
> 赞同：0
> 
> 时间：2012-09-24T22:24:16.867
> 
> 标签：c#, linq, linq-to-sql

我正在使用 LINQToSQL 处理 C# 项目，但现在我遇到了以下查询的问题：

```
var groupByQuery =  (from c in db.Customers
                            join o in db.Orders on c.CustomerID equals o.CustomerID into lf1
                            from or in lf1.DefaultIfEmpty()
                            group c by c.CustomerID into g
                            select new
                            {
                                CustomerID = g.Key,
                                Count = g.Count()
                            }
                            ).OrderBy(x => x.Count); 
```

如您所见，我正在按 进行 a`LEFT OUTER JOIN`和分组，`CustomerID`到目前为止一切顺利。但是当我看到结果时，我意识到那`Customers`没有任何，在他们的领域`Order`有一个“1” 。`Count`

这是为什么？在这些情况下，该`Count`字段应该有一个“0”，我做错了什么？

我在这里发现了这个问题：

[linq-count-query-returns-a-1-instead-of-a-0](https://stackoverflow.com/questions/2791614/linq-count-query-returns-a-1-instead-of-a-0)

[linq-to-sql-joining-query-returning-1-instead-of-0](https://stackoverflow.com/questions/8652906/linq-to-sql-joining-query-returning-1-instead-of-0)

但他们都没有对我有帮助，我希望有人能提供帮助，提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:35:23.140

仍然会有一条记录，即使它为空 - 包含“NULL”的集合仍然是一行 - 这就是为什么它说有 1 条记录。如果您为该`Count`方法提供要计算哪些记录的参数，它应该会更好地工作。

```
Count = g.Count(a => a.SomeNullableField != null) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T01:19:40.087

你把事情弄得太复杂了。 `join...into`执行[group join](http://msdn.microsoft.com/en-us/library/bb311040.aspx)`CustomerId` ，因此 Orders在您的前两行代码中分组。这应该有效：

```
var groupByQuery =  (from c in db.Customers
                     join o in db.Orders on c.CustomerID equals o.CustomerID into lf1
                     select new
                     {
                         CustomerID = c.Id,
                         Count = lf1.Count()
                     }
                     ).OrderBy(x => x.Count); 
```

# svg - 如何根据包含或位置更改 SVG 对象的样式？

> ID：12573786
> 
> 赞同：0
> 
> 时间：2012-09-24T22:24:20.780
> 
> 标签：svg

根据 SVG 对象的父 html 标记，我希望改变它的路径颜色。这可以用 SVG 完成吗？例如，如果一个标志在页眉中，我希望它是红色的，如果它在页脚中，我希望它是蓝色的。这是一个例子：

```
<style type="text/css">
   #header-img {
       fill:blue;
   }

   #footer-img {
       fill:black;
   }

</style>
...
<header>
   <object id="header-img" type="image/svg+xml" data="myimg.svg" />
</header>
...
<footer>
   <object id="footer-img" type="image/svg+xml" data="myimg.svg" />
</footer> 
```

当然，这是无法做到的，但有没有不使用 JavaScript 的替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:38:40.793

是的你可以。

SVG 元素的操作方式与任何其他 HTML/DOM 元素几乎相同。例如，使用 Raphael JS (http://raphaeljs.com/)，您至少可以在浏览器窗口中找到矢量/SVG 元素的绝对位置，并将其与页眉/页脚的绝对位置进行比较并且，使用 JQuery，触发一个事件来改变 SVG 的颜色。

Raphael 还为旧版本的 IE 呈现 VML 图形。所以非常值得研究。

也就是说，如果您不打算使用 JavaScript，那么请改用 CSS。更新了一个工作示例，可在此处找到；

[http://jsfiddle.net/Zp6HS/4/](http://jsfiddle.net/Zp6HS/4/)

用您的自定义路径和要更改的 css 属性替换 'circle' 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T19:54:01.740

重新开始，这是我能找到的对您的问题的最佳问题/答案：

[如何将样式应用于嵌入式 SVG？](https://stackoverflow.com/questions/4906148/how-to-apply-a-style-to-an-embedded-svg)

您可以手动将链接样式表添加到您希望嵌入的文件中……从而避免使用 JavaScript。

我认为你应该尽量不要问多余的问题。我们都做得很好，早点采购。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-10-10T21:48:25.140

你不能在css中使用'parent of'运算符吗？像这样：

```
<style>
  header > svg {
   fill:blue;
  }
  body > svg {
    fill:black;   
  }
</style> 
```

# python - 为什么我在构建 python 时构建 sqlite3 失败？

> ID：12573787
> 
> 赞同：5
> 
> 时间：2012-09-24T22:24:38.543
> 
> 标签：python, sqlite, python-2.7, python-extensions

为什么我只是未能构建 sqlite？

它与 readline 或 _tkinter 或其他什么有关吗？

```
pes/libffi/src/prep_cif.o build/temp.linux-i686-2.7/home/mirror/build/tmp/Python-2.7.3/Modules/_ctypes/libffi/src/closures.o build/temp.linux-i686-2.7/home/mirror/build/tmp/Python-2.7.3/Modules/_ctypes/libffi/src/dlmalloc.o build/temp.linux-i686-2.7/home/mirror/build/tmp/Python-2.7.3/Modules/_ctypes/libffi/src/x86/ffi.o build/temp.linux-i686-2.7/home/mirror/build/tmp/Python-2.7.3/Modules/_ctypes/libffi/src/x86/sysv.o -L/usr/local/lib -o build/lib.linux-i686-2.7/_ctypes.so

Python build finished, but the necessary bits to build these modules were not found:
_bsddb             _tkinter           bsddb185        
bz2                dbm                gdbm            
readline           sunaudiodev                        
To find the necessary bits, look in setup.py in detect_modules() for the module's name. 
```

> **未能构建这些模块：**
> 
> **_sqlite3**

```
running build_scripts
creating build/scripts-2.7
copying and adjusting /home/mirror/build/tmp/Python-2.7.3/Tools/scripts/pydoc -> build/scripts-2.7
copying and adjusting /home/mirror/build/tmp/Python-2.7.3/Tools/scripts/idle -> build/scripts-2.7
copying and adjusting /home/mirror/build/tmp/Python-2.7.3/Tools/scripts/2to3 -> build/scripts-2.7
copying and adjusting /home/mirror/build/tmp/Python-2.7.3/Lib/smtpd.py -> build/scripts-2.7
changing mode of build/scripts-2.7/pydoc from 664 to 775
changing mode of build/scripts-2.7/idle from 664 to 775
changing mode of build/scripts-2.7/2to3 from 664 to 775
changing mode of build/scripts-2.7/smtpd.py from 664 to 775
/usr/bin/install -c -m 644 ./Tools/gdb/libpython.py python-gdb.py 
```

更多细节：

```
Python build finished, but the necessary bits to build these modules were not found:
_bsddb             _tkinter           bsddb185
bz2                dbm                gdbm
sunaudiodev
To find the necessary bits, look in setup.py in detect_modules() for the module's name
Failed to build these modules:
_sqlite3 
```

我的系统是centos 5.3

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-09T23:10:46.583

可以在以下地址找到（并讨论）一个补丁：http: [//bugs.python.org/issue14572](http://bugs.python.org/issue14572)

我遇到了与原始海报完全相同的问题，补丁解决了它。

要应用[补丁](https://gist.github.com/msabramo/2727063/)，请从 python 2.7.3 目录中的终端：

```
curl -sk https://gist.github.com/msabramo/2727063/raw/59ea097a1f4c6f114c32f7743308a061698b17fd/gistfile1.diff | patch -p1 
```

# css - 非粗斜体文本

> ID：12573793
> 
> 赞同：-1
> 
> 时间：2012-09-24T22:25:12.973
> 
> 标签：css, less

我有一些文本要显示为非粗斜体。但是，在 CSS 树的更上方，我已指定所有 H2（此元素类型）文本都应加粗。我知道使用

```
font-style: italic; 
```

适用于斜体，但它使我的文字保持粗体。我如何告诉它“撤消”它的粗体然后斜体？

我试过了

```
font-style: normal;
font-style: italic; 
```

但这没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:28:03.597

尝试：

```
font-weight: normal !important; 
```

# windows - Windows Perl --> 移植后 Unix 不工作，可能是编码问题

> ID：12573798
> 
> 赞同：1
> 
> 时间：2012-09-24T22:25:54.167
> 
> 标签：windows, linux, perl, encoding, port

我有一个在 Windows 上编写的 Perl 程序。它开始于：

```
$unused_header = <STDIN>;
my @header_fields = split('\|\^\|', $unused_header, -1); 
```

哪个应该拆分包含一个非常大的文件的输入：

```
The|^|Quick|^|Brown|^|Fox|!| 
```

进入：

```
{The, Quick, Brown, Fox|!|} 
```

注意：这条线只是单独做headre，还有另一条类似的做重复的数据线。

它在 Windows 上运行良好，但在 linux 上却失败了。但是，如果我在 Perl 中定义一个具有相同内容的字符串，并在其上运行拆分，它就可以正常工作。

我认为这是一个 UTF-16 编码处理问题，但我不确定如何处理它。有谁知道我如何让 perl 理解 UTF-16 被输送到 STDIN 中？

我发现：[http](http://www.haboogo.com/matching_patterns/2009/01/utf-16-processing-issue-in-perl.html) ://www.haboogo.com/matching_patterns/2009/01/utf-16-processing-issue-in-perl.html但我不知道该怎么办。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T22:40:26.883

如果 STDIN 是 UTF-16，请使用以下之一

```
binmode(STDIN, ':encoding(UTF-16le)');   # Byte order used by Windows.
binmode(STDIN, ':encoding(UTF-16be)');   # The other byte order.
binmode(STDIN, ':encoding(UTF-16)');     # Use BOM to determine byte order. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T22:47:37.667

Tom就 perl 和 unicode写了一个[冗长的答案。](https://stackoverflow.com/a/6163129/23118)它包含一些正确且完全支持 UTF-8 的样板代码，但您可以根据需要替换为 UTF-16。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T23:05:48.860

我怀疑这是一个 UTF-xx 编码问题，因为 Windows Perl 和 Unix Perl 都不会尝试使用这些编码读取数据，除非你告诉它。

如果 Unix 脚本正在读取与 Windows 脚本完全相同的文件，但行为不同，则可能是行尾问题。大多数 Unix-y 系统上的`dos2unix`命令可以更改文件的行尾，或者您可以在 Perl 脚本中自己删除行尾

```
$unused_header = <STDIN>;
$unused_header =~ s/\r?\n$//;   # chop \r\n (Windows) or \n (Unix) 
```

# algorithm - 2人游戏的最佳策略

> ID：12573800
> 
> 赞同：6
> 
> 时间：2012-09-24T22:26:16.310
> 
> 标签：algorithm

*   2 个玩家 A 和 B 正在玩一个涉及数字*n的游戏*
*   玩家 A 迈出第一步，两名玩家交替下棋。
*   在每一步中，玩家选择数字 n，选择一个数字*i*，使得*2^i < n*并将*n*替换为*k = n - 2^i如果**k*的二进制表示中 1 的数量大于或等于*n*的二进制表示中 1 的数量
**   当没有玩家可以移动时，游戏结束，即不存在这样的*i**

 *例如：

```
n = 13 = b1101 
```

只可能 i=1

```
k = n - 2^i = 11 = b1011 
```

同样，只有可能 i = 2

```
k = n - 2^i = 7 = b111 
```

由于玩家 A 不能再移动，玩家 B 获胜

我已经推断出，在任何一步，我们只能选择一个i，使得在n的二进制表示中对应的位置有一个0。

例如：如果 n=1010010，那么 i 只能是 {0,2,3,5}。

但我不能再进一步了。极小极大算法并没有让我感到震惊。我将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T00:07:02.910

假设n不太大，我们可以使用动态规划来解决这个问题。定义一个数组 A[1:n]，其中 A[i] 表示玩家 i 是否会在输入 i 上获胜。让我们使用解释：

```
 A[i] = 1, if A wins on input i,
   A[i] = 0, if A loses on input i. 
```

现在 A 可以自下而上计算如下：

```
A[1] = 0, A[2] = 1.
For j=3:n { 
      Assign A[j] = 1 if there exists a number i such that (A[j-2^i] = 0) AND 
                              (number of 1's in i >=  number of 1's in j)
      Otherwise  Assign A[j] = 0 
} 
```*

# c++ - ISO/IE 10646 中的“字符短名称”是什么？

> ID：12573805
> 
> 赞同：4
> 
> 时间：2012-09-24T22:26:31.793
> 
> 标签：c++, unicode, c++11

C++11 2.3/2 说：

> 通用字符名 \UNNNNNNNN 指定的字符是 ISO/IEC 10646 中字符短名称为 NNNNNNNN 的字符

所以我下载了[ISO/IEC 10646](http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=56921)，但我找不到“字符短名称”的定义。有人可以澄清一下这应该指的是什么吗？

我最初的目标是找出为什么在使用 \U 指定代码点时需要 8 个十六进制数字，因为 6 位数字总是足够的。所以我也很想知道为什么 C++11 指定我们使用 \UNNNNNNNN 而不是 \UNNNNNN。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:45:01.827

在[Unicode 字符代码表](http://www.unicode.org/charts/)中，每个字符都有一个全名和一个短名。例如字符`/`有全名`SOLIDUS`和短名`002F`。并非巧合的是，所有字符短名称都可以用十六进制表示。

至于为什么必须指定 8 位数字，我怀疑这是为了与可能使用更大/更多字符块的 Unicode 标准的未来版本向前兼容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:42:45.683

我冒昧地猜测我们上次被 Unicode 家伙咬了：C++ 最初是`wchar_t`这样设计的，它可以容纳所有可能的 Unicode 字符。为此，它至少需要保存 16 位，因为 Unicode 最多只能使用 16 位。在一个流行的实现决定实际使用 16 位`wchar_t`类型后不久，人们发现 16 位实际上是不够的。上次我看 Unicode 使用 20 位，但为什么又赌太短了？不太可能广泛使用 24 位类型，如果您需要使用特定的代码点，最喜欢只使用 16 位，即您可以使用`\uNNNN`.

2.3 [lex.charset] 第 2 段中的描述似乎表明通用字符名称是指代码点。同时，universal-character-name 用于指代字符短名称。我不是 Unicode 专家，但我认为代码点是有意义的。

# ruby-on-rails - wicked_pdf，wkhtmltopdf 不能在 Heroku 上使用 SVG

> ID：12573806
> 
> 赞同：4
> 
> 时间：2012-09-24T22:26:32.840
> 
> 标签：ruby-on-rails, heroku, svg, wkhtmltopdf, wicked-pdf

我有一个 Ruby on Rails 3.2 应用程序，它使用**wicked_pdf** gem 和**wkhtmltopdf 0.9.9**库在我的本地机器上生成 PDF，这是一个**MAC OSX 10.7.5 Lion**。该应用程序成功地将 HTML 页面（包括 SVG 图像）呈现为 PDF 文件，这正是我们希望应用程序完成的行为。

*在本地，由于 OSX 的 11.0.0 版本存在错误，我们不得不使用 wkhtmltopdf 0.9.9。*

问题是，当应用程序在 Heroku 上投入生产时，它必须使用不同的二进制文件：**wkhtmltopdf-0.9.9 Linux 静态二进制文件 (amd64)**，并且 SVG 渲染似乎崩溃了。生成了 PDF，但 SVG 图像未正确呈现。它们只是图像应该存在的空白或方形“外壳”。

我们尝试使用**wkhtmltopdf-heroku** gem，但不断收到“Broken Pipe”错误。

没有与此问题相关的错误消息，我们不知道问题出在 Linux 版本上。有什么想法吗？

这是我们在`config/initializers/wicked_pdf.rb`文件中的代码：

```
if Rails.env.staging? || Rails.env.production?  
  exe_path = Rails.root.join('bin', 'wkhtmltopdf-amd64').to_s  
else  
  exe_path = Rails.root.join('bin', 'wkhtmltopdf').to_s  
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-14T21:01:05.107

有一种简单的方法无需进行繁重的修补和配置即可工作 - **Base64 编码 SVG 文件**并将其包含在 HTML 中：

```
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGF...> 
```

我使用这种方法在 CSS 中嵌入字体，但它也适用于 SVG 和其他图像格式。

# iphone - 如何在 iPhone 解锁上打开应用程序

> ID：12573807
> 
> 赞同：1
> 
> 时间：2012-09-24T22:26:39.673
> 
> 标签：iphone, ios, xcode, ios5, ios6

我正在尝试创建一个应用程序，每次用户解锁手机时都会弹出第二个密码屏幕。

用户解锁手机 -> 自定义安全应用程序打开 -> 自定义安全应用程序关闭并将用户推送到主屏幕

这是否可以捕获手机解锁事件并打开您的应用程序？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-24T22:33:29.580

当然不。第三方应用程序无法对系统进行如此多的控制。

# php - PHP命名空间不起作用

> ID：12573808
> 
> 赞同：5
> 
> 时间：2012-09-24T22:26:43.880
> 
> 标签：php, namespaces

我第一次尝试使用 PHP 命名空间，甚至无法获得使用 2 个文件的非常基本的示例。这是我的目录设置：

> /Framework/
> /Framework/index.php
> /Framework/Models/TestModel.php

这是两个文件背后的代码。

索引.php：

```
    命名空间框架；

    使用 \Framework\Models\TestModel;

    $model = new TestModel();
    $模型->测试（）；

```

测试模型.php：

```
    命名空间框架\模型；

    类测试模型
    {
        公共功能测试（）
        {
            打印（“测试”）；
        }
    }

```

错误只是它找不到 TestModel 类：

> 致命错误：第 7 行的 C:\xampp\htdocs\Framework\index.php 中找不到类“Framework\Models\TestModel”

我正在通过 localhost/Framework/index.php 的 Web 浏览器运行 PHP。这一定是我没有看到的非常简单的东西，有人可以为我指出吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2020-11-22T03:01:44.513

文件本身的命名空间与其他类和函数“区分开来”，但是 PHP/Server 不知道物理文件仅基于命名空间的位置。

因此，正如人们所提到的，直接包含文件可以让 PHP 确切地知道您的意思。

当 PHP 找不到文件时，它会调用函数 spl_autoload_register() ，在这个方法中人们通常会放一个小函数来匹配命名空间到目录结构，然后加载文件。

另一种选择是在您的项目中包含 Composer 并使用 PSR-4 自动加载

```
{
    "require": {
    },
    "autoload": {
        "psr-4": {
            "App\\": "app_directoy/",
            "Framework\\": "framework_directory/",
        }
    }
} 
```

当包括作曲家自动加载时，它将按照您的定义在您的 framework_directory 中查找所有 Framework/*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-16T15:02:13.767

您应该**删除“命名空间框架”**并在 index.php 中**包含 TestModel.php** - 像这样：

```
require_once('Models/TestModel.php');

use \Framework\Models\TestModel;

$model = new TestModel();
$model->test(); 
```

# apache-camel - 骆驼路线和MyBatis

> ID：12573810
> 
> 赞同：1
> 
> 时间：2012-09-24T22:26:56.857
> 
> 标签：apache-camel, dsl, mybatis

我对 Camel 比较陌生，我一直在努力解决使用 MyBatis 来“提供”ActiveMQ 队列的简单路由的问题。

我的路线如下：

```
public class SearchItemProductionRouteRoute extends SpringRouteBuilder {
    @Override
    public void configure() throws Exception {
        from("timer://pollTheDatabase?delay=5000")
        .to("mybatis:selectSearchItem?statementType=SelectList&consumer.useIterator=true&consumer.onConsume=updateProcessingSearchItem")
        .to("bean:searchItemProcesser?method=process")
        .to("activemq:searchitemqueue");
    }
} 
```

mybatis 查询工作正常。查询本身从数据库中带来 4 条记录。我的需要是每一行都应该成为队列中的一条消息，但是相反，我得到了一条包含所有 4 行的消息。

searchItemProcessor 只打印消息的正文（这就是我知道消息包含所有 4 条记录的方式）。

这些是上述路线使用的查询：

```
<select id="selectSearchItem" resultMap="result" parameterType="java.util.HashMap">
    SELECT * FROM SEARCH_REQUEST_ITEM SRI WHERE SRI.STATUS = '1' 
</select>

<update id="updateProcessingSearchItem">
    UPDATE SEARCH_REQUEST_ITEM SET STATUS = 2,   
    UPDATEDIN=SYSDATE, UPDATEDBY='XDRBATCH' 
    WHERE ID = #{ID}
</update> 
```

如果有人能对此有所了解，我将不胜感激！

编辑：

刚刚找到了一种使用 Splitter EIP 的解决方法。首先我创建了这个类：

```
public class XdrMessageSplitterBean {
    @SuppressWarnings({ "rawtypes", "unchecked" })
    public List<HashMap> splitBody(Object body) {
        return (List<HashMap>) body;
    }
} 
```

然后将其添加到路由中：

```
 public void configure() throws Exception {
        from("timer://pollTheDatabase?delay=5000")
        .to("mybatis:selectSearchItem?statementType=SelectList&consumer.useIterator=true&consumer.onConsume=updateProcessingSearchItem")
        .split().method("xdrMessageSplitterBean", "splitBody")
        .to("bean:searchItemProcesser?method=process")
        .to("activemq:searchitemqueue");
    } 
```

bean 必须在 camel-context.xml 文件中声明：

```
 <bean id="xdrMessageSplitterBean" name="xdrMessageSplitterBean"
    class="package.of.bean.XdrMessageSplitterBean" /> 
```

它有效，但感觉不对。如果有人有任何建议，将非常欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T12:24:49.593

可以直接从mybatis消费，指定轮询频率。你不需要计时器。有一个延迟选项可用于将 = 5000 设置为 5 秒频率。

```
public void configure() throws Exception {
        from("mybatis:selectSearchItem?statementType=SelectList&consumer.useIterator=true&consumer.onConsume=updateProcessingSearchItem&delay=5000")
        .split().method("xdrMessageSplitterBean", "splitBody")
        .to("bean:searchItemProcesser?method=process")
        .to("activemq:searchitemqueue");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T05:07:34.720

我会说你找到了正确的方法。您不应该将其视为一种解决方法。

实际上，由于 mybatis 返回一个列表，我什至不确定您是否需要“XdrMessageSplitterBean”。

# c++ - 从 C++ 应用程序为 Mac OS X 创建安装程序

> ID：12573812
> 
> 赞同：1
> 
> 时间：2012-09-24T22:26:59.267
> 
> 标签：c++, macos, installation

我使用 Eclipse IDE 在 Mac OS X 上为 C/C++ 开发人员创建了一个 C++应用程序。
我的应用程序包括外部库，例如：`PortAudio`和`Aubio`（`wxWidgets`动态链接）。

如何创建安装程序，以便可以将应用程序安装在 Mac OS X 计算机上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:29:40.133

你不是第一个遇到这个问题的人（不足为奇）： [https ://developer.apple.com/library/mac/#documentation/porting/conceptual/portingunix/intro/intro.html](https://developer.apple.com/library/mac/#documentation/porting/conceptual/portingunix/intro/intro.html)

具体安装程序： [https ://developer.apple.com/library/mac/#documentation/porting/conceptual/portingunix/distributing/distibuting.html#//apple_ref/doc/uid/TP40002855-TPXREF101](https://developer.apple.com/library/mac/#documentation/porting/conceptual/portingunix/distributing/distibuting.html#//apple_ref/doc/uid/TP40002855-TPXREF101)

[http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/PackageMakerUserGuide/Overview/Overview.html#//apple_ref/doc/uid/TP40005371-CH3-SW2](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/PackageMakerUserGuide/Overview/Overview.html#//apple_ref/doc/uid/TP40005371-CH3-SW2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T23:07:18.810

我假设您正在开发将存在于 /Applications/MyApp.app 中的东西。

除非你真的*想*用随机分类的库来弄乱用户的系统，否则你**不会**. OSX 没有像您在其他 *nixes 上习惯的那样进行包管理；安装动态库/框架的唯一原因是如果您是该框架的官方分销商（并且可以保证合理的版本控制、向后兼容性，并且希望不会与其他人的包发生冲突），或者如果您有一套应用程序并且想要减少安装膨胀（例如 StuffIt）。但是这些东西永远卸载不了！

更常见的做法是在 .app 包中嵌入库，例如在 Contents/MacOS、Contents/usr/lib、Contents/Frameworks 或其他任何地方。确切的路径并不重要（为了简单起见，我很想使用 Contents/MacOS）。然后，您可以使用相对路径（[@executable_path、@load_path 或 @rpath](https://wincent.com/wiki/@executable_path,_@load_path_and_@rpath) ）访问库，这通常涉及调整您使用[install-name-tool](https://stackoverflow.com/questions/tagged/install-name-tool)构建的库。IIRC、Adium、Audacity 和 Firefox 都这样做，以及（可能）更多。

我不记得我脑海中的教程。

# jquery - 同位素自定义布局，基于项目大小 - 可以使用 jQuery 同位素吗？

> ID：12573815
> 
> 赞同：4
> 
> 时间：2012-09-24T22:27:25.780
> 
> 标签：jquery, jquery-isotope

我们正在准备建立一个相当不错的网站，我想问是否有人有任何经验或建议；或者如果它甚至可能使用同位素。我过去使用过很多 Isotope，并没有深入研究扩展可用的类，但我认为这可能是可能的，而不是从头开始构建一些东西。

这是我们正在考虑做的截图： http: [//cloud.believelabs.com/image/2f0I093o3Y3Q](http://cloud.believelabs.com/image/2f0I093o3Y3Q)

本质上，我们有两个固定的 withs；“更宽”和“更窄”的尺寸。

因此，这个想法和可能具有挑战性的是，我们不希望任何“更宽”元素直接出现在任何其他“更宽”元素的上方（或下方）。其他元素无关紧要。这是否可行，是否有人对如何定位这些更宽的元素有任何建议，以便它们在网格中的分布避免将“宽”堆叠在“宽”之上？

如果这看起来相对不清楚，请道歉。只是想想想我们的解决方案可能是什么，如果有人对插件有任何其他想法，我会全力以赴。这将使用backbone.js 构建，我们对元素的顺序有很多控制权。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:07:05.907

Masonry js 正在变得流行，并且完全符合您的要求。由于您有 2 个固定宽度，您可以在这两列上调用 masonry，这里是该站点的链接：http: [//masonry.desandro.com/demos/basic-multi -column.html](http://masonry.desandro.com/demos/basic-multi-column.html)

# c++ - 什么是未定义的引用/未解决的外部符号错误，我该如何解决？

> ID：12573816
> 
> 赞同：1686
> 
> 时间：2012-09-24T22:27:40.680
> 
> 标签：c++, linker-errors, undefined-reference, c++-faq, unresolved-external

什么是未定义的引用/未解决的外部符号错误？什么是常见原因以及如何修复/预防它们？

* * *

## 回答 #1

> 赞同：940
> 
> 时间：2012-09-24T22:27:40.680

**按照2.2** 的规定，编译 C++ 程序需要几个步骤[（参考 Keith Thompson）](https://stackoverflow.com/a/8834196)：

> 翻译的语法规则之间的优先级由以下阶段指定*[见脚注]*。
> 
> 1.  如有必要，物理源文件字符以实现定义的方式映射到基本源字符集（为行尾指示符引入换行符）。*[剪辑]*
> 2.  每个反斜杠字符 (\) 的实例后面紧跟一个换行符被删除，拼接物理源代码行以形成逻辑源代码行。*[剪辑]*
> 3.  源文件被分解为预处理标记（2.5）和空白字符序列（包括注释）。*[剪辑]*
> 4.  执行预处理指令，扩展宏调用，并执行 _Pragma 一元运算符表达式。*[剪辑]*
> 5.  字符文字或字符串文字中的每个源字符集成员，以及字符文字或非原始字符串文字中的每个转义序列和通用字符名称，都将转换为执行字符集的相应成员；*[剪辑]*
> 6.  相邻的字符串文字标记被连接起来。
> 7.  分隔标记的空白字符不再重要。每个预处理令牌都被转换为一个令牌。(2.7)。生成的标记在句法和语义上进行分析，并作为翻译单元进行翻译。*[剪辑]*
> 8.  翻译后的翻译单元和实例化单元组合如下：*[SNIP]*
> 9.  **所有外部实体引用均已解析。链接库组件以满足对当前翻译中未定义的实体的外部引用。所有此类翻译器输出都被收集到程序映像中，该程序映像包含在其执行环境中执行所需的信息。**（强调我的）
> 
> *[脚注]*实现必须表现得好像这些单独的阶段发生了一样，尽管在实践中不同的阶段可能被折叠在一起。

指定的错误发生在编译的最后阶段，通常称为链接。这基本上意味着您将一堆实现文件编译成目标文件或库，现在您想让它们一起工作。

假设您`a`在`a.cpp`. 现在，`b.cpp` *声明*该符号并使用它。在链接之前，它只是假设该符号是在*某个地方*定义的，但它并不关心在哪里。链接阶段负责找到符号并将其正确链接到`b.cpp`（实际上，链接到使用它的对象或库）。

如果您使用的是 Microsoft Visual Studio，您将看到项目生成`.lib`文件。其中包含导出符号表和导入符号表。导入的符号将根据您链接的库进行解析，并为使用它的库`.lib`（如果有）提供导出的符号。

其他编译器/平台也存在类似的机制。

常见的错误消息是Microsoft **Visual Studio**的`error LNK2001`,和**GCC**的*symbolName*。`error LNK1120``error LNK2019`**`undefined reference to`**

 *****编码：

```
struct X
{
   virtual void foo();
};
struct Y : X
{
   void foo() {}
};
struct A
{
   virtual ~A() = 0;
};
struct B: A
{
   virtual ~B(){}
};
extern int x;
void foo();
int main()
{
   x = 0;
   foo();
   Y y;
   B b;
} 
```

**将使用GCC**生成以下错误：

```
/home/AbiSfw/ccvvuHoX.o: In function `main':
prog.cpp:(.text+0x10): undefined reference to `x'
prog.cpp:(.text+0x19): undefined reference to `foo()'
prog.cpp:(.text+0x2d): undefined reference to `A::~A()'
/home/AbiSfw/ccvvuHoX.o: In function `B::~B()':
prog.cpp:(.text._ZN1BD1Ev[B::~B()]+0xb): undefined reference to `A::~A()'
/home/AbiSfw/ccvvuHoX.o: In function `B::~B()':
prog.cpp:(.text._ZN1BD0Ev[B::~B()]+0x12): undefined reference to `A::~A()'
/home/AbiSfw/ccvvuHoX.o:(.rodata._ZTI1Y[typeinfo for Y]+0x8): undefined reference to `typeinfo for X'
/home/AbiSfw/ccvvuHoX.o:(.rodata._ZTI1B[typeinfo for B]+0x8): undefined reference to `typeinfo for A'
collect2: ld returned 1 exit status 
```

以及**Microsoft Visual Studio**的类似错误：

```
1>test2.obj : error LNK2001: unresolved external symbol "void __cdecl foo(void)" (?foo@@YAXXZ)
1>test2.obj : error LNK2001: unresolved external symbol "int x" (?x@@3HA)
1>test2.obj : error LNK2001: unresolved external symbol "public: virtual __thiscall A::~A(void)" (??1A@@UAE@XZ)
1>test2.obj : error LNK2001: unresolved external symbol "public: virtual void __thiscall X::foo(void)" (?foo@X@@UAEXXZ)
1>...\test2.exe : fatal error LNK1120: 4 unresolved externals 
```

常见原因包括：

*   [未能链接到适当的库/目标文件或编译实现文件](https://stackoverflow.com/a/12574400)
*   [已声明且未定义的变量或函数。](https://stackoverflow.com/a/12574403)
*   [类类型成员的常见问题](https://stackoverflow.com/a/12574407)
*   [模板实现不可见。](https://stackoverflow.com/a/12574417)
*   [符号在 C 程序中定义并在 C++ 代码中使用。](https://stackoverflow.com/a/12574420)
*   [跨模块/dll 错误地导入/导出方法/类。（特定于 MSVS）](https://stackoverflow.com/a/12574423)
*   [循环库依赖](https://stackoverflow.com/a/20358542)
*   [未定义对“WinMain@16”的引用](https://stackoverflow.com/questions/5259714/undefined-reference-to-winmain16/5260237#5260237)
*   [相互依赖的图书馆秩序](https://stackoverflow.com/a/24675715)
*   [多个同名源文件](https://stackoverflow.com/questions/14364362/visualstudio-project-with-multiple-sourcefiles-of-the-same-name)
*   [`#pragma`使用(Microsoft Visual Studio)时输入错误或不包括 .lib 扩展名](https://stackoverflow.com/a/25744263)
*   [模板朋友的问题](https://stackoverflow.com/a/35891188)
*   [不一致的`UNICODE`定义](https://stackoverflow.com/a/36475406)
*   [const 变量声明/定义中缺少“extern”（仅限 C++）](https://stackoverflow.com/a/45478255)

* * *

## 回答 #2

> 赞同：190
> 
> 时间：2012-09-24T23:38:20.420

## Class members:

### A pure `virtual` destructor needs an implementation.

Declaring a destructor pure still requires you to define it (unlike a regular function):

```
struct X
{
    virtual ~X() = 0;
};
struct Y : X
{
    ~Y() {}
};
int main()
{
    Y y;
}
//X::~X(){} //uncomment this line for successful definition 
```

This happens because base class destructors are called when the object is destroyed implicitly, so a definition is required.

### `virtual` methods must either be implemented or defined as pure.

This is similar to non-`virtual` methods with no definition, with the added reasoning that the pure declaration generates a dummy vtable and you might get the linker error without using the function:

```
struct X
{
    virtual void foo();
};
struct Y : X
{
   void foo() {}
};
int main()
{
   Y y; //linker error although there was no call to X::foo
} 
```

For this to work, declare `X::foo()` as pure:

```
struct X
{
    virtual void foo() = 0;
}; 
```

### Non-`virtual` class members

Some members need to be defined even if not used explicitly:

```
struct A
{ 
    ~A();
}; 
```

The following would yield the error:

```
A a;      //destructor undefined 
```

The implementation can be inline, in the class definition itself:

```
struct A
{ 
    ~A() {}
}; 
```

or outside:

```
A::~A() {} 
```

If the implementation is outside the class definition, but in a header, the methods have to be marked as `inline` to prevent a multiple definition.

All used member methods need to be defined if used.

### A common mistake is forgetting to qualify the name:

```
struct A
{
   void foo();
};

void foo() {}

int main()
{
   A a;
   a.foo();
} 
```

The definition should be

```
void A::foo() {} 
```

### `static` data members must be defined outside the class in a **single translation unit**:

```
struct X
{
    static int x;
};
int main()
{
    int x = X::x;
}
//int X::x; //uncomment this line to define X::x 
```

An initializer can be provided for a `static` `const` data member of integral or enumeration type within the class definition; however, odr-use of this member will still require a namespace scope definition as described above. C++11 allows initialization inside the class for all `static const` data members.

* * *

## 回答 #3

> 赞同：129
> 
> 时间：2012-09-24T23:37:30.810

* * *

## 回答 #4

> 赞同：110
> 
> 时间：2012-09-24T23:38:00.483

### Declared but did not define a variable or function.

A typical variable declaration is

```
extern int x; 
```

As this is only a declaration, a **single definition** is needed. A corresponding definition would be:

```
int x; 
```

For example, the following would generate an error:

```
extern int x;
int main()
{
    x = 0;
}
//int x; // uncomment this line for successful definition 
```

Similar remarks apply to functions. Declaring a function without defining it leads to the error:

```
void foo(); // declaration only
int main()
{
   foo();
}
//void foo() {} //uncomment this line for successful definition 
```

Be careful that the function you implement exactly matches the one you declared. For example, you may have mismatched cv-qualifiers:

```
void foo(int& x);
int main()
{
   int x;
   foo(x);
}
void foo(const int& x) {} //different function, doesn't provide a definition
                          //for void foo(int& x) 
```

Other examples of mismatches include

*   Function/variable declared in one namespace, defined in another.
*   Function/variable declared as class member, defined as global (or vice versa).
*   Function return type, parameter number and types, and calling convention do not all exactly agree.

The error message from the compiler will often give you the full declaration of the variable or function that was declared but never defined. Compare it closely to the definition you provided. *Make sure every detail matches.*

* * *

## 回答 #5

> 赞同：92
> 
> 时间：2014-07-10T11:46:08.707

### 指定相互依赖的链接库的顺序是错误的。

如果库相互依赖，则链接库的顺序很重要。一般来说，如果 library`A`依赖于 library `B`，则`libA` **必须**出现`libB`在链接器标志之前。

例如：

```
// B.h
#ifndef B_H
#define B_H

struct B {
    B(int);
    int x;
};

#endif

// B.cpp
#include "B.h"
B::B(int xx) : x(xx) {}

// A.h
#include "B.h"

struct A {
    A(int x);
    B b;
};

// A.cpp
#include "A.h"

A::A(int x) : b(x) {}

// main.cpp
#include "A.h"

int main() {
    A a(5);
    return 0;
}; 
```

创建库：

```
$ g++ -c A.cpp
$ g++ -c B.cpp
$ ar rvs libA.a A.o 
ar: creating libA.a
a - A.o
$ ar rvs libB.a B.o 
ar: creating libB.a
a - B.o 
```

编译：

```
$ g++ main.cpp -L. -lB -lA
./libA.a(A.o): In function `A::A(int)':
A.cpp:(.text+0x1c): undefined reference to `B::B(int)'
collect2: error: ld returned 1 exit status
$ g++ main.cpp -L. -lA -lB
$ ./a.out 
```

所以再重复一遍，顺序**很**重要！

* * *

## 回答 #6

> 赞同：78
> 
> 时间：2014-10-07T10:09:10.750

**什么是“未定义的引用/未解析的外部符号”**

我将尝试解释什么是“未定义的引用/未解析的外部符号”。

> 注意：我使用 g++ 和 Linux，所有示例都是针对它的

例如我们有一些代码

```
// src1.cpp
void print();

static int local_var_name; // 'static' makes variable not visible for other modules
int global_var_name = 123;

int main()
{
    print();
    return 0;
} 
```

和

```
// src2.cpp
extern "C" int printf (const char*, ...);

extern int global_var_name;
//extern int local_var_name;

void print ()
{
    // printf("%d%d\n", global_var_name, local_var_name);
    printf("%d\n", global_var_name);
} 
```

制作目标文件

```
$ g++ -c src1.cpp -o src1.o
$ g++ -c src2.cpp -o src2.o 
```

在汇编器阶段之后，我们有一个目标文件，其中包含要导出的任何符号。看符号

```
$ readelf --symbols src1.o
  Num:    Value          Size Type    Bind   Vis      Ndx Name
     5: 0000000000000000     4 OBJECT  LOCAL  DEFAULT    4 _ZL14local_var_name # [1]
     9: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    3 global_var_name     # [2] 
```

我拒绝了输出中的一些行，因为它们无关紧要

因此，我们看到要导出的符号。

```
[1] - this is our static (local) variable (important - Bind has a type "LOCAL")
[2] - this is our global variable 
```

src2.cpp 什么都不导出，我们也没有看到它的符号

链接我们的目标文件

```
$ g++ src1.o src2.o -o prog 
```

并运行它

```
$ ./prog
123 
```

链接器看到导出的符号并链接它。现在我们尝试像这里一样取消注释 src2.cpp 中的行

```
// src2.cpp
extern "C" int printf (const char*, ...);

extern int global_var_name;
extern int local_var_name;

void print ()
{
    printf("%d%d\n", global_var_name, local_var_name);
} 
```

并重建一个目标文件

```
$ g++ -c src2.cpp -o src2.o 
```

好的（没有错误），因为我们只构建目标文件，链接还没有完成。尝试链接

```
$ g++ src1.o src2.o -o prog
src2.o: In function `print()':
src2.cpp:(.text+0x6): undefined reference to `local_var_name'
collect2: error: ld returned 1 exit status 
```

发生这种情况是因为我们的 local_var_name 是静态的，即它对其他模块不可见。现在更深入。获取翻译阶段输出

```
$ g++ -S src1.cpp -o src1.s

// src1.s
look src1.s

    .file   "src1.cpp"
    .local  _ZL14local_var_name
    .comm   _ZL14local_var_name,4,4
    .globl  global_var_name
    .data
    .align 4
    .type   global_var_name, @object
    .size   global_var_name, 4
global_var_name:
    .long   123
    .text
    .globl  main
    .type   main, @function
main:
; assembler code, not interesting for us
.LFE0:
    .size   main, .-main
    .ident  "GCC: (Ubuntu 4.8.2-19ubuntu1) 4.8.2"
    .section    .note.GNU-stack,"",@progbits 
```

所以，我们已经看到 local_var_name 没有标签，这就是链接器没有找到它的原因。但我们是黑客 :) 我们可以修复它。在文本编辑器中打开 src1.s 并更改

```
.local  _ZL14local_var_name
.comm   _ZL14local_var_name,4,4 
```

至

```
 .globl  local_var_name
    .data
    .align 4
    .type   local_var_name, @object
    .size   local_var_name, 4
local_var_name:
    .long   456789 
```

即你应该像下面这样

```
 .file   "src1.cpp"
    .globl  local_var_name
    .data
    .align 4
    .type   local_var_name, @object
    .size   local_var_name, 4
local_var_name:
    .long   456789
    .globl  global_var_name
    .align 4
    .type   global_var_name, @object
    .size   global_var_name, 4
global_var_name:
    .long   123
    .text
    .globl  main
    .type   main, @function
main:
; ... 
```

我们更改了 local_var_name 的可见性并将其值设置为 456789。尝试从中构建一个目标文件

```
$ g++ -c src1.s -o src2.o 
```

好的，请参阅 readelf 输出（符号）

```
$ readelf --symbols src1.o
8: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    3 local_var_name 
```

现在 local_var_name 有 Bind GLOBAL (是 LOCAL)

关联

```
$ g++ src1.o src2.o -o prog 
```

并运行它

```
$ ./prog 
123456789 
```

好的，我们破解它:)

因此，当链接器在目标文件中找不到全局符号时，会发生“未定义的引用/未解决的外部符号错误”。

* * *

## 回答 #7

> 赞同：76
> 
> 时间：2012-09-24T23:39:15.303

### 符号在 C 程序中定义并在 C++ 代码中使用。

函数（或变量）`void foo()`是在 C 程序中定义的，您尝试在 C++ 程序中使用它：

```
void foo();
int main()
{
    foo();
} 
```

C++ 链接器期望名称被破坏，因此您必须将函数声明为：

```
extern "C" void foo();
int main()
{
    foo();
} 
```

等效地，函数（或变量）不是在 C 程序`void foo()`中定义，而是在 C++ 中定义但具有 C 链接：

```
extern "C" void foo(); 
```

并且您尝试在具有 C++ 链接的 C++ 程序中使用它。

如果整个库包含在头文件中（并且被编译为 C 代码）；包含将需要如下所示；

```
extern "C" {
    #include "cheader.h"
} 
```

* * *

## 回答 #8

> 赞同：72
> 
> 时间：2013-12-03T18:11:27.867

**如果一切都失败了，请重新编译。**

我最近能够通过重新编译有问题的文件来摆脱 Visual Studio 2012 中未解决的外部错误。当我重新构建时，错误消失了。

这通常发生在两个（或更多）库具有循环依赖关系时。库 A 尝试使用 B.lib 中的符号，库 B 尝试使用 A.lib 中的符号。两者都不存在。当您尝试编译 A 时，链接步骤将失败，因为它找不到 B.lib。将生成 A.lib，但没有 dll。然后编译 B，这将成功并生成 B.lib。重新编译 A 现在可以工作了，因为现在找到了 B.lib。

* * *

## 回答 #9

> 赞同：63
> 
> 时间：2012-09-24T23:38:55.287

### Template implementations not visible.

Unspecialized templates must have their definitions visible to all translation units that use them. That means you can't separate the definition of a template to an implementation file. If you must separate the implementation, the usual workaround is to have an `impl` file which you include at the end of the header that declares the template. A common situation is:

```
template<class T>
struct X
{
    void foo();
};

int main()
{
    X<int> x;
    x.foo();
}

//differentImplementationFile.cpp
template<class T>
void X<T>::foo()
{
} 
```

To fix this, you must move the definition of `X::foo` to the header file or some place visible to the translation unit that uses it.

Specialized templates can be implemented in an implementation file and the implementation doesn't have to be visible, but the specialization must be previously declared.

For further explanation and another possible solution (explicit instantiation) see [this question and answer](https://stackoverflow.com/questions/495021).

* * *

## 回答 #10

> 赞同：63
> 
> 时间：2015-04-13T16:42:19.767

这是每个 VC++ 程序员一次又一次看到的最令人困惑的错误消息之一。让我们先把事情弄清楚。

**A. 什么是象征？** 简而言之，符号就是名称。它可以是变量名、函数名、类名、typedef 名，或者除了那些属于 C++ 语言的名称和符号之外的任何东西。它是用户定义或由依赖库（另一个用户定义）引入的。

**B. 什么是外在的？** 在VC++中，每个源文件（.cpp、.c等）都被视为一个翻译单元，编译器一次编译一个单元，并为当前翻译单元生成一个目标文件（.obj）。（请注意，此源文件包含的每个头文件都将被预处理并被视为此翻译单元的一部分）翻译单元内的所有内容都被视为内部内容，其他所有内容都被视为外部内容。`extern`在 C++ 中，您可以使用诸如等关键字来引用外部符号`__declspec (dllimport)`。

**C. 什么是“决心”？** Resolve 是一个链接时间术语。在链接时，链接器尝试为目标文件中无法在内部找到其定义的每个符号查找外部定义。此搜索过程的范围包括：

*   编译时生成的所有目标文件
*   显式或隐式指定为此构建应用程序的附加依赖项的所有库 (.lib)。

这个搜索过程称为resolve。

**D. 最后，为什么是 Unresolved External Symbol？** 如果链接器找不到内部没有定义的符号的外部定义，则会报告未解析的外部符号错误。

**E. LNK2019 的可能原因**：未解决的外部符号错误。我们已经知道这个错误是由于链接器未能找到外部符号的定义，可能的原因可以排序为：

1.  定义存在

例如，如果我们在 a.cpp 中定义了一个名为 foo 的函数：

```
int foo()
{
    return 0;
} 
```

在 b.cpp 中我们要调用函数 foo，所以我们添加

```
void foo(); 
```

声明函数 foo()，并在另一个函数体中调用它，比如`bar()`：

```
void bar()
{
    foo();
} 
```

现在，当您构建此代码时，您将收到一个 LNK2019 错误，抱怨 foo 是一个未解析的符号。在这种情况下，我们知道 foo() 在 a.cpp 中有它的定义，但与我们调用的不同（不同的返回值）。这是定义存在的情况。

2.  定义不存在

如果我们要调用库中的某些函数，但导入库没有添加到`Project | Properties | Configuration Properties | Linker | Input | Additional Dependency`您的项目设置的附加依赖项列表（set from: ）中。现在链接器将报告 LNK2019，因为当前搜索范围内不存在该定义。

* * *

## 回答 #11

> 赞同：61
> 
> 时间：2012-09-24T23:39:29.873

### 跨模块/dll（特定于编译器）错误地导入/导出方法/类。

`__declspec(dllexport)`MSVS 要求您使用和指定要导出和导入的符号`__declspec(dllimport)`。

这种双重功能通常是通过使用宏来获得的：

```
#ifdef THIS_MODULE
#define DLLIMPEXP __declspec(dllexport)
#else
#define DLLIMPEXP __declspec(dllimport)
#endif 
```

宏`THIS_MODULE`只能在导出函数的模块中定义。这样，声明：

```
DLLIMPEXP void foo(); 
```

扩展到

```
__declspec(dllexport) void foo(); 
```

并告诉编译器导出函数，因为当前模块包含它的定义。当在不同的模块中包含声明时，它会扩展为

```
__declspec(dllimport) void foo(); 
```

并告诉编译器该定义在您链接的库之一中（另见**1）**）。

您可以类似地导入/导出类：

```
class DLLIMPEXP X
{
}; 
```

* * *

## 回答 #12

> 赞同：44
> 
> 时间：2014-03-03T23:52:27.623

**未定义的引用`WinMain@16`或类似*的“不寻常”* `main()`入口点引用**（尤其是对于[visual-studio](/questions/tagged/visual-studio "显示标记为“视觉工作室”的问题")）。

您可能错过了使用实际 IDE 选择正确的项目类型。IDE 可能希望将例如 Windows 应用程序项目绑定到此类入口点函数（如上面缺少的参考中所指定），而不是常用的`int main(int argc, char** argv);`签名。

如果您的 IDE 支持*普通控制台项目*，您可能希望选择此项目类型，而不是 Windows 应用程序项目。

* * *

以下是从*现实世界*问题中更详细地处理的[case1](https://stackoverflow.com/questions/24715864/problems-importing-libraries-to-my-c-project-how-to-fix-this/24715865#24715865)和[case2 。](https://stackoverflow.com/questions/5259714/undefined-reference-to-winmain16)

 ** * *

## 回答 #13

> 赞同：38
> 
> 时间：2014-06-18T17:06:24.813

此外，如果您使用的是 3rd 方库，请确保您拥有正确的 32/64 位二进制文​​件

* * *

## 回答 #14

> 赞同：35
> 
> 时间：2015-01-17T02:24:04.753

**需要为新的工具集版本更新 Visual Studio NuGet 包**

我只是在尝试将 libpng 与 Visual Studio 2013 链接时遇到了这个问题。问题是包文件只有 Visual Studio 2010 和 2012 的库。

正确的解决方案是希望开发人员发布一个更新的包然后升级，但它通过入侵 VS2013 的额外设置对我有用，指向 VS2012 库文件。

我通过在该文件中找到并复制所有部分来编辑包（在`packages`解决方案目录内的文件夹中）。我将**条件字段**中的 更改为只是非常小心地将文件名路径全部保留为. 这只是允许 Visual Studio 2013 链接到 2012 年的库，在这种情况下，它起作用了。`packagename\build\native\packagename.targets``v110``v110``v120`**`v110`**

 *** * *

## 回答 #15

> 赞同：35
> 
> 时间：2014-09-09T12:09:01.367

Microsoft 提供了一个`#pragma`在链接时引用正确的库；

```
#pragma comment(lib, "libname.lib") 
```

除了包含库目录的库路径外，这应该是库的全名。

* * *

## 回答 #16

> 赞同：35
> 
> 时间：2015-08-11T15:33:42.163

假设您有一个用 c++ 编写的大项目，其中包含一千个 .cpp 文件和一千个 .h 文件。假设该项目还依赖于十个静态库。假设我们在 Windows 上，我们在 Visual Studio 20xx 中构建我们的项目。当您按 Ctrl + F7 Visual Studio 开始编译整个解决方案时（假设我们在解决方案中只有一个项目）

**编译是什么意思？**

*   Visual Studio 搜索文件**.vcxproj**并开始编译每个扩展名为 .cpp 的文件。编译顺序是未定义的。所以你不能假设文件 main.cpp 是先编译的
*   如果 .cpp 文件依赖于其他 .h 文件以查找可能在文件 .cpp 中定义或未定义的符号
*   如果存在一个编译器在其中找不到一个符号的 .cpp 文件，则编译**器时错误**会引发消息*Symbol x could not be found*
*   为每个扩展名为 .cpp 的文件生成一个目标文件 .o，Visual Studio 还将输出写入名为*ProjectName.Cpp.Clean.txt*的文件中，该文件包含必须由链接器处理的所有目标文件。

编译的第二步由 Linker 完成。Linker 应该合并所有目标文件并最终构建输出（可能是可执行文件或库）

**链接项目的步骤**

*   解析所有目标文件并找到仅在标头中声明的定义（例如：前面的答案中提到的类的一种方法的代码，或事件初始化一个类内部成员的静态变量）
*   如果在目标文件中找不到一个符号，他也会在 Additional Libraries 中进行搜索。为了将新库添加到项目**配置属性**-> **VC++ 目录** ->**库目录**，您在此处指定了用于搜索库和**配置属性**的附加文件夹->**链接器**->用于指定库名称的**输入。**- 如果链接器找不到您在一个 .cpp 中写入的符号，他会引发**链接器时间错误**，这听起来可能像 `error LNK2001: unresolved external symbol "void __cdecl foo(void)" (?foo@@YAXXZ)`

**观察**

1.  一旦链接器找到一个符号，他就不会在其他库中搜索它
2.  链接库的顺序**很重要**。
3.  如果链接器在一个静态库中找到一个外部符号，他会将符号包含在项目的输出中。但是，如果库是共享的（动态），他不会在输出中包含代码（符号），但 *运行时*崩溃可能发生

**如何解决此类错误**

编译器时间错误：

*   确保您编写的 c++ 项目语法正确。

链接器时间错误

*   定义您在头文件中声明的所有符号
*   用于`#pragma once`允许编译器不包含一个头文件，如果它已经包含在当前编译的 .cpp 中
*   确保您的外部库不包含可能与您在头文件中定义的其他符号发生冲突的符号
*   当您使用模板时，请确保在头文件中包含每个模板函数的定义，以允许编译器为任何实例化生成适当的代码。

* * *

## 回答 #17

> 赞同：30
> 
> 时间：2015-01-02T22:06:08.993

## 编译器/IDE 中的错误

我最近遇到了这个问题，结果发现[这是 Visual Studio Express 2013 中的一个错误](https://stackoverflow.com/questions/27748699/unresolved-reference-to-constructor-which-is-defined/27748920#27748920)。我不得不从项目中删除一个源文件并重新添加它来克服这个错误。

如果您认为这可能是编译器/IDE 中的错误，请尝试以下步骤：

*   清理项目（某些 IDE 可以选择执行此操作，您也可以通过删除目标文件手动执行此操作）
*   尝试开始一个新项目，从原始项目中复制所有源代码。

* * *

## 回答 #18

> 赞同：30
> 
> 时间：2015-07-27T10:20:40.337

## 使用链接器帮助诊断错误

大多数现代链接器都包含一个详细的选项，可以在不同程度上打印出来。

*   链接调用（命令行），
*   关于链接阶段包含哪些库的数据，
*   图书馆的位置，
*   使用的搜索路径。

对于 gcc 和 clang；您通常会将`-v -Wl,--verbose`或添加`-v -Wl,-v`到命令行。更多详情可在这找到;

*   Linux [ld 手册页](http://linux.die.net/man/1/ld)。
*   LLVM[链接器页面](http://llvm.org/releases/3.6.2/docs/CommandGuide/llvm-link.html#cmdoption-v)。
*   “GCC 简介”[第 9 章](http://www.network-theory.co.uk/docs/gccintro/gccintro_75.html)。

对于 MSVC，`/VERBOSE`（特别是`/VERBOSE:LIB`）被添加到链接命令行。

*   MSDN 页面上的[`/VERBOSE`链接器选项](https://msdn.microsoft.com/en-us/library/wdsk6as6.aspx)。

* * *

## 回答 #19

> 赞同：26
> 
> 时间：2014-04-04T15:02:33.350

**链接的 .lib 文件与 .dll 相关联**

我遇到过同样的问题。假设我有项目 MyProject 和 TestProject。我已经有效地将 MyProject 的 lib 文件链接到了 TestProject。但是，这个 lib 文件是在构建 MyProject 的 DLL 时生成的。此外，我没有包含 MyProject 中所有方法的源代码，而只包含对 DLL 入口点的访问。

为了解决这个问题，我将 MyProject 构建为 LIB，并将 TestProject 链接到这个 .lib 文件（我将生成的 .lib 文件复制粘贴到 TestProject 文件夹中）。然后我可以再次将 MyProject 构建为 DLL。它正在编译，因为与 TestProject 链接的库确实包含 MyProject 中类中所有方法的代码。

* * *

## 回答 #20

> 赞同：25
> 
> 时间：2015-09-10T11:03:35.357

由于人们似乎在谈到链接器错误时被引导到这个问题，所以我将在此处添加此问题。

GCC 5.2.0 出现链接器错误的一个可能原因是现在默认选择了新的 libstdc++ 库 ABI。

> 如果您收到有关对涉及 std::__cxx11 命名空间或标记 [abi:cxx11] 中的类型的符号的未定义引用的链接器错误，则可能表明您正在尝试将使用不同值编译的目标文件链接在一起 _GLIBCXX_USE_CXX11_ABI宏。当链接到使用旧版本 GCC 编译的第三方库时，通常会发生这种情况。如果第三方库不能用新的 ABI 重建，那么你需要用旧的 ABI 重新编译你的代码。

因此，如果在 5.1.0 之后切换到 GCC 时突然出现链接器错误，这将是一件需要检查的事情。

* * *

## 回答 #21

> 赞同：23
> 
> 时间：2017-04-09T10:34:09.087

## 您的链接在引用它们的目标文件之前使用库

*   您正在尝试使用 GCC 工具链编译和链接您的程序。
*   您的链接指定了所有必要的库和库搜索路径
*   如果`libfoo`依赖`libbar`，那么你的链接正确放在`libfoo`前面`libbar`。
*   `undefined reference to` *您的链接因某些*错误而失败。
*   但是所有未定义的*something*都在您拥有的头文件中声明， `#include`实际上是在您链接的库中定义的。

示例在 C 中。它们同样可以是 C++

### 一个涉及您自己构建的静态库的最小示例

**my_lib.c**

```
#include "my_lib.h"
#include <stdio.h>

void hw(void)
{
    puts("Hello World");
} 
```

**my_lib.h**

```
#ifndef MY_LIB_H
#define MT_LIB_H

extern void hw(void);

#endif 
```

**eg1.c**

```
#include <my_lib.h>

int main()
{
    hw();
    return 0;
} 
```

你建立你的静态库：

```
$ gcc -c -o my_lib.o my_lib.c
$ ar rcs libmy_lib.a my_lib.o 
```

你编译你的程序：

```
$ gcc -I. -c -o eg1.o eg1.c 
```

您尝试将其链接`libmy_lib.a`并失败：

```
$ gcc -o eg1 -L. -lmy_lib eg1.o 
eg1.o: In function `main':
eg1.c:(.text+0x5): undefined reference to `hw'
collect2: error: ld returned 1 exit status 
```

如果您一步编译和链接，结果相同，例如：

```
$ gcc -o eg1 -I. -L. -lmy_lib eg1.c
/tmp/ccQk1tvs.o: In function `main':
eg1.c:(.text+0x5): undefined reference to `hw'
collect2: error: ld returned 1 exit status 
```

### 一个涉及共享系统库的最小示例，压缩库`libz`

**eg2.c**

```
#include <zlib.h>
#include <stdio.h>

int main()
{
    printf("%s\n",zlibVersion());
    return 0;
} 
```

编译你的程序：

```
$ gcc -c -o eg2.o eg2.c 
```

尝试链接您的程序`libz`并失败：

```
$ gcc -o eg2 -lz eg2.o 
eg2.o: In function `main':
eg2.c:(.text+0x5): undefined reference to `zlibVersion'
collect2: error: ld returned 1 exit status 
```

如果您一次性编译和链接，则相同：

```
$ gcc -o eg2 -I. -lz eg2.c
/tmp/ccxCiGn7.o: In function `main':
eg2.c:(.text+0x5): undefined reference to `zlibVersion'
collect2: error: ld returned 1 exit status 
```

示例 2 的变体包括`pkg-config`：

```
$ gcc -o eg2 $(pkg-config --libs zlib) eg2.o 
eg2.o: In function `main':
eg2.c:(.text+0x5): undefined reference to `zlibVersion' 
```

### 你在做什么错？

在您要链接以制作程序的目标文件和库的序列中，您将库放在引用它们的目标文件之前。您需要将库放在引用它们的目标文件*之后。*

正确链接示例 1：

```
$ gcc -o eg1 eg1.o -L. -lmy_lib 
```

成功：

```
$ ./eg1 
Hello World 
```

正确链接示例 2：

```
$ gcc -o eg2 eg2.o -lz 
```

成功：

```
$ ./eg2 
1.2.8 
```

正确链接示例 2`pkg-config`变体：

```
$ gcc -o eg2 eg2.o $(pkg-config --libs zlib) 
$ ./eg2
1.2.8 
```

### 说明

*从这里开始阅读是可选的*。

默认情况下，由 GCC 生成的链接命令在您的发行版上按命令行顺序从左到右使用链接中的文件。当它发现一个文件引用了*某个东西* 并且不包含它的定义时，它将在更右边的文件中搜索一个定义。如果它最终找到定义，则解析该引用。如果最后有任何引用仍未解决，则链接失败：链接器不会向后搜索。

首先，**示例 1**，带有静态库`my_lib.a`

静态库是目标文件的索引存档。当链接器`-lmy_lib`在链接序列中找到并发现 this 指的是静态库`./libmy_lib.a`时，它想知道您的程序是否需要`libmy_lib.a`.

里面只有目标文件`libmy_lib.a`，也就是`my_lib.o`，里面只定义了一个东西`my_lib.o`，就是函数`hw`。

当且仅当链接器`my_lib.o`已经知道您的程序`hw`在它已经添加到程序中的一个或多个目标文件中引用了 ，并且它已经添加的所有目标文件都不包含的定义`hw`。

如果这是真的，那么链接器将从`my_lib.o`库中提取副本并将其添加到您的程序中。然后，您的程序包含 的定义`hw`，因此其对 的引用`hw`被*解析*。

当您尝试像这样链接程序时：

```
$ gcc -o eg1 -L. -lmy_lib eg1.o 
```

链接器在看到 时还 *没有添加* `eg1.o` *到程序*`-lmy_lib`中。因为那个时候，它还没有看到`eg1.o`。*你的*程序还没有`hw`对.*`eg1.o`*

 *所以链接器不会添加`my_lib.o`到程序中，也没有进一步使用`libmy_lib.a`.

接下来，它找到`eg1.o`，并将其添加到程序中。链接序列中的目标文件总是添加到程序中。现在，程序引用了`hw`，并且不包含 ; 的定义`hw`。但是链接序列中没有任何东西可以提供缺失的定义。`hw`对最终的引用*unresolved*，并且链接失败。

二、**示例2**，带共享库`libz`

共享库不是目标文件或类似文件的存档。它更像是一个没有函数的*程序*`main`，而是公开了它定义的多个其他符号，以便其他程序可以在运行时使用它们。

如今，许多 Linux 发行版配置其 GCC 工具链，以便其语言驱动程序（`gcc`、`g++`等`gfortran`）指示系统链接器（ ）根据*需要*`ld`链接共享库。您拥有其中一个发行版。

 *这意味着当链接器`-lz`在链接序列中找到并发现 this 指的是共享库 (say)`/usr/lib/x86_64-linux-gnu/libz.so`时，它想知道它添加到程序中但尚未定义的任何引用是否具有以下定义由出口`libz`

如果这是真的，那么链接器将*不会*复制任何块`libz`并将它们添加到您的程序中；相反，它只会修改您的程序代码，以便：-

*   在运行时，系统程序加载器将在加载程序副本时将副本加载`libz`到与程序相同的进程中，以运行它。

*   在运行时，每当您的程序引用 中定义的内容时 ，该引用将使用同一进程中`libz`的副本导出的定义。`libz`

您的程序只想引用具有由 导出的定义的事物`libz`，即在`zlibVersion`中仅引用一次的函数`eg2.c`。如果链接器将该引用添加到您的程序，然后找到由 导出的定义`libz`，则*解析该引用*

但是当您尝试像这样链接程序时：

```
gcc -o eg2 -lz eg2.o 
```

事件的顺序是错误的，与示例 1 相同。当链接器找到 时`-lz`，程序中*没有任何*引用：它们都在 中`eg2.o`，这还没有被看到。所以链接器决定它对`libz`. 当它到达 时`eg2.o`，将其添加到程序中，然后对 有未定义的引用`zlibVersion`，则链接序列完成；该引用未解决，并且链接失败。

最后，`pkg-config`示例 2 的变体现在有了明显的解释。外壳扩展后：

```
gcc -o eg2 $(pkg-config --libs zlib) eg2.o 
```

变成：

```
gcc -o eg2 -lz eg2.o 
```

这只是示例 2。

### 我可以重现示例 1 中的问题，但不能重现示例 2

联动：

```
gcc -o eg2 -lz eg2.o 
```

很适合你！

（或者：这种链接在 Fedora 23 上对你来说很好，但在 Ubuntu 16.04 上失败了）

那是因为链接工作的发行版是不配置其 GCC 工具链以*根据需要*链接共享库的发行版之一。

过去，类 Unix 系统通过不同的规则链接静态库和共享库是很正常的。链接序列中的静态库是在示例 1 中解释*的按需*链接的，但共享库是无条件链接的。

这种行为在链接时是经济的，因为链接器不必考虑程序是否需要共享库：如果它是共享库，则链接它。大多数链接中的大多数库都是共享库。但也有缺点：-

*   *这在运行时*是不经济的，因为即使不需要共享库，它也会导致与程序一起加载共享库。

*   静态库和共享库的不同链接规则可能会让不熟练的程序员感到困惑，他们可能不知道`-lfoo`在他们的链接中是否会解析为`/some/where/libfoo.a`或 to `/some/where/libfoo.so`，并且可能无论如何也不理解共享库和静态库之间的区别。

这种权衡导致了今天的分裂局面。一些发行版更改了共享库的 GCC 链接规则，以便*按需* 原则适用于所有库。一些发行版坚持使用旧方式。

### 为什么即使我同时编译和链接，我仍然会遇到这个问题？

如果我这样做：

```
$ gcc -o eg1 -I. -L. -lmy_lib eg1.c 
```

当然 gcc 必须先编译`eg1.c`，然后将生成的目标文件与`libmy_lib.a`. 那么它在进行链接时如何不知道需要目标文件呢？

因为使用单个命令编译和链接不会改变链接顺序的顺序。

当你运行上面的命令`gcc`时，确定你想要编译+链接。所以在幕后，它会生成一个编译命令并运行它，然后生成一个链接命令并运行它，就像*你*运行了两个命令一样：

```
$ gcc -I. -c -o eg1.o eg1.c
$ gcc -o eg1 -L. -lmy_lib eg1.o 
```

所以链接会失败，就像你*运行*这两个命令一样。您在失败中注意到的唯一区别是 gcc 在 compile + link 情况下生成了一个临时目标文件，因为您没有告诉它使用`eg1.o`. 我们看：

```
/tmp/ccQk1tvs.o: In function `main' 
```

代替：

```
eg1.o: In function `main': 
```

### 也可以看看

[指定相互依赖的链接库的顺序错误](https://stackoverflow.com/a/24675715/1362568)

将相互依赖的库以错误的顺序放置只是一种方式，您可以通过这种方式获取*需要*在链接中稍后出现的事物定义的文件，而不是*提供*定义的文件。将库放在引用它们的目标文件之前是犯同样错误的另一种方法。

* * *

## 回答 #22

> 赞同：20
> 
> 时间：2015-03-30T16:03:16.230

**不支持链接器脚本的 GNU ld 包装器**

一些 .so 文件实际上是[GNU ld 链接器脚本](https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/4/html/Using_ld_the_GNU_Linker/simple-commands.html)，例如[libtbb.so](https://www.threadingbuildingblocks.org/download)文件是具有以下内容的 ASCII 文本文件：

```
INPUT (libtbb.so.2) 
```

一些更复杂的构建可能不支持这一点。例如，如果您在编译器选项中包含 -v，您可以看到[mainwin gcc 包装器 mwdip](http://www.mainsoft.com/content/mainsoft-unix-and-linux-overview)在要链接的库的详细输出列表中丢弃链接器脚本命令文件。一个简单的解决方法是替换链接器脚本输入命令用文件的副本代替文件（或符号链接），例如

```
cp libtbb.so.2 libtbb.so 
```

或者您可以将 -l 参数替换为 .so 的完整路径，例如，而不是`-ltbb`do`/home/foo/tbb-4.3/linux/lib/intel64/gcc4.4/libtbb.so.2`

* * *

## 回答 #23

> 赞同：18
> 
> 时间：2016-03-09T12:08:26.797

## 与模板成为朋友...

给定带有友元运算符（或函数）的模板类型的代码片段；

```
template <typename T>
class Foo {
    friend std::ostream& operator<< (std::ostream& os, const Foo<T>& a);
}; 
```

被`operator<<`声明为非模板函数。`T`对于与 一起使用的每种类型`Foo`，都需要有一个非模板化的`operator<<`. 例如，如果`Foo<int>`声明了一个类型，那么必须有一个操作符实现，如下所示；

```
std::ostream& operator<< (std::ostream& os, const Foo<int>& a) {/*...*/} 
```

由于它没有实现，链接器找不到它并导致错误。

为了纠正这个问题，您可以在类型之前声明一个模板运算符`Foo`，然后将适当的实例化声明为友元。语法有点尴尬，但看起来如下；

```
// forward declare the Foo
template <typename>
class Foo;

// forward declare the operator <<
template <typename T>
std::ostream& operator<<(std::ostream&, const Foo<T>&);

template <typename T>
class Foo {
    friend std::ostream& operator<< <>(std::ostream& os, const Foo<T>& a);
    // note the required <>        ^^^^
    // ...
};

template <typename T>
std::ostream& operator<<(std::ostream&, const Foo<T>&)
{
  // ... implement the operator
} 
```

上述代码将操作符的友谊限制在对应的实例化中`Foo`，即`operator<< <int>`实例化仅限于访问实例化的私有成员`Foo<int>`。

替代方案包括；

*   允许友谊扩展到模板的所有实例化，如下所示；

    ```
    template <typename T>
    class Foo {
        template <typename T1>
        friend std::ostream& operator<<(std::ostream& os, const Foo<T1>& a);
        // ...
    }; 
    ```

*   或者，`operator<<`可以在类定义中内联地实现 ；

    ```
    template <typename T>
    class Foo {
        friend std::ostream& operator<<(std::ostream& os, const Foo& a)
        { /*...*/ }
        // ...
    }; 
    ```

*请注意*，当运算符（或函数）的声明仅出现在类中时，该名称不可用于“正常”查找，仅用于参数相关查找，来自[cppreference](http://en.cppreference.com/w/cpp/language/friend)；

> 在类或类模板 X 中的友元声明中首先声明的名称成为 X 的最内层封闭命名空间的成员，但不能用于查找（除了考虑 X 的参数相关查找），除非命名空间范围内的匹配声明是假如...

[在cppreference](http://en.cppreference.com/w/cpp/language/friend#Template_friends)和[C++ FAQ](https://isocpp.org/wiki/faq/templates#template-friends)上有关于模板朋友的进一步阅读。

[显示上述技术的代码清单](http://coliru.stacked-crooked.com/a/e9221c4bb23f9cd0)。

* * *

*作为失败代码示例的旁注；g++ 对此发出警告如下*

> `warning: friend declaration 'std::ostream& operator<<(...)' declares a non-template function [-Wnon-template-friend]`
> 
> `note: (if this is not what you intended, make sure the function template has already been declared and add <> after the function name here)`

* * *

## 回答 #24

> 赞同：16
> 
> 时间：2017-03-03T06:57:30.017

# 当您的包含路径不同时

当头文件及其关联的共享库（.lib 文件）不同步时，可能会发生链接器错误。让我解释。

链接器如何工作？链接器通过比较函数声明（在头文件中声明）与其定义（在共享库中）匹配它们的签名。如果链接器找不到完全匹配的函数定义，您可能会收到链接器错误。

即使声明和定义似乎匹配，是否仍然可能出现链接器错误？是的！它们在源代码中可能看起来相同，但这实际上取决于编译器看到的内容。基本上你可能会遇到这样的情况：

```
// header1.h
typedef int Number;
void foo(Number);

// header2.h
typedef float Number;
void foo(Number); // this only looks the same lexically 
```

请注意，即使两个函数声明在源代码中看起来相同，但根据编译器的不同，它们确实不同。

你可能会问，一个人是怎么落到这样的境地的？**当然包括路径**！如果在编译共享库时，包含路径导致`header1.h`您最终`header2.h`在自己的程序中使用，您将不得不抓挠头，想知道发生了什么（双关语）。

下面解释了如何在现实世界中发生这种情况的示例。

## 进一步举例说明

我有两个项目：`graphics.lib`和`main.exe`. 这两个项目都依赖于`common_math.h`. 假设库导出以下函数：

```
// graphics.lib    
#include "common_math.h" 

void draw(vec3 p) { ... } // vec3 comes from common_math.h 
```

然后你继续在你自己的项目中包含这个库。

```
// main.exe
#include "other/common_math.h"
#include "graphics.h"

int main() {
    draw(...);
} 
```

繁荣！你得到一个链接器错误，你不知道它为什么会失败。原因是公共库使用相同包含的不同版本`common_math.h`（我在示例中通过包含不同的路径使其很明显，但它可能并不总是那么明显。可能编译器设置中的包含路径不同） .

请注意，在此示例中，链接器会告诉您它无法找到`draw()`，而实际上您知道它显然是由库导出的。你可能会花几个小时挠头，想知道出了什么问题。问题是，链接器看到不同的签名，因为参数类型略有不同。在示例中，`vec3`就编译器而言，两个项目中的类型不同。这可能是因为它们来自两个略有不同的包含文件（可能包含文件来自两个不同版本的库）。

## 调试链接器

DUMPBIN 是您的朋友，如果您使用的是 Visual Studio。我确信其他编译器也有其他类似的工具。

过程是这样的：

1.  请注意链接器错误中给出的奇怪的错位名称。（例如，draw@graphics@XYZ）。
2.  将库中导出的符号转储到文本文件中。
3.  搜索导出的感兴趣的符号，并注意重命名的名称不同。
4.  注意为什么损坏的名称最终会有所不同。您将能够看到参数类型是不同的，即使它们在源代码中看起来相同。
5.  他们不同的原因。在上面给出的示例中，它们是不同的，因为包含文件不同。

[1] 项目是指一组源文件，它们链接在一起以生成库或可执行文件。

编辑 1：重写第一部分以便于理解。请在下面发表评论，让我知道是否需要修复其他问题。谢谢！

* * *

## 回答 #25

> 赞同：15
> 
> 时间：2016-04-07T11:53:38.320

## 不一致的`UNICODE`定义

Windows UNICODE 构建是使用`TCHAR`etc. 定义为`wchar_t`etc 构建的。当不构建`UNICODE`定义为构建时`TCHAR`定义为`char`etc。这些`UNICODE`和`_UNICODE`定义影响所有[“ `T`”字符串类型](https://msdn.microsoft.com/en-us/library/windows/desktop/dd374131(v=vs.85).aspx)；`LPTSTR`，`LPCTSTR`还有他们的麋鹿。

构建一个`UNICODE`已定义的库并尝试将其链接到未定义的项目`UNICODE`中将导致链接器错误，因为`TCHAR`;的定义将不匹配。`char`与`wchar_t`..

错误通常包括具有`char`或`wchar_t`派生类型的值的函数，这些也可能包括`std::basic_string<>`等。浏览代码中受影响的函数时，通常会引用`TCHAR`or`std::basic_string<TCHAR>`等​​。这表明代码最初是为 UNICODE 和多字节字符（或“窄”）构建而设计的.

`UNICODE`要更正此问题，请使用(and `_UNICODE`)的一致定义构建所有必需的库和项目。

1.  这可以通过任何一个来完成；

    ```
    #define UNICODE
    #define _UNICODE 
    ```

2.  或者在项目设置中；

    > 项目属性 > 常规 > 项目默认值 > 字符集

3.  或者在命令行上；

    ```
    /DUNICODE /D_UNICODE 
    ```

替代方法也适用，如果不打算使用 UNICODE，请确保未设置定义，和/或在项目中使用多字符设置并一致应用。

不要忘记在“发布”和“调试”版本之间保持一致。

* * *

## 回答 #26

> 赞同：14
> 
> 时间：2016-02-24T10:40:51.590

## 清理和重建

构建的“清理”可以去除之前构建、失败构建、不完整构建和其他构建系统相关构建问题留下的“死木”。

通常，IDE 或构建将包含某种形式的“清理”功能，但这可能没有正确配置（例如在手动 makefile 中）或可能失败（例如中间或生成的二进制文件是只读的）。

一旦“清理”完成，验证“清理”是否成功并且所有生成的中间文件（例如自动生成文件）都已成功删除。

这个*过程可以看作是最后的手段，但通常是一个好的第一步*；特别是如果最近添加了与错误相关的代码（本地或来自源存储库）。

* * *

## 回答 #27

> 赞同：11
> 
> 时间：2017-08-03T08:01:49.237

## 变量声明/定义中缺少“extern” `const`（仅限 C++）

对于来自 C 的人来说，在 C++ 中全局`const`变量具有内部（或静态）链接可能会令人惊讶。在 C 中情况并非如此，因为所有全局变量都是隐式`extern`的（即当`static`关键字丢失时）。

例子：

```
// file1.cpp
const int test = 5;    // in C++ same as "static const int test = 5"
int test2 = 5;

// file2.cpp
extern const int test;
extern int test2;

void foo()
{
 int x = test;   // linker error in C++ , no error in C
 int y = test2;  // no problem
} 
```

正确的是使用头文件并将其包含在 file2.cpp*和*file1.cpp

```
extern const int test;
extern int test2; 
```

或者，可以`const`使用显式声明 file1.cpp 中的变量`extern`

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2018-08-27T16:43:54.680

尽管这是一个很老的问题，有多个已接受的答案，但我想分享如何解决一个**晦涩的**“未定义引用”错误。

# 不同版本的库

我使用别名来引用`std::filesystem::path`：文件系统自 C++17 以来就在标准库中，但我的程序**也需要在 C++14 中编译，**所以我决定使用变量别名：

```
#if (defined _GLIBCXX_EXPERIMENTAL_FILESYSTEM) //is the included filesystem library experimental? (C++14 and newer: <experimental/filesystem>)
using path_t = std::experimental::filesystem::path;
#elif (defined _GLIBCXX_FILESYSTEM) //not experimental (C++17 and newer: <filesystem>)
using path_t = std::filesystem::path;
#endif 
```

假设我有三个文件：main.cpp、file.h、file.cpp：

*   **file.h #include**的 < **experimental::filesystem** > 并包含上面的代码
*   **file.cpp**，file.h的实现，#include的“ **file.h** ”
*   **main.cpp** #include的<**文件系统**>和“ **file.h** ”

请注意main.cpp 和 file.h 中使用的**不同库。**由于 main.cpp # **include'd** "file.h " 在 < **filesystem** > 之后，因此使用的文件系统版本是**C++17**版本。我曾经使用以下命令编译程序：

$ `g++ -g -std=c++17 -c main.cpp`-> 将 main.cpp 编译为 main.o
$ `g++ -g -std=c++17 -c file.cpp`-> 将 file.cpp 和 file.h 编译为 file.o
$ `g++ -g -std=c++17 -o executable main.o file.o -lstdc++fs`-> 链接 main.o 和 file.o

这样，file.o 中包含并在 main.o 中使用的任何**需要的****函数**都会给出“未定义的引用”错误，因为**main.o**引用但**file.o**指向. **`path_t`******`std::filesystem::path`******`std::experimental::filesystem::path`******

 ****# 解析度

为了解决这个问题，我只需要将**file.h 中的 <experimental::filesystem> 更改为 <filesystem>**。

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2018-09-07T06:22:40.167

## 链接共享库时，请确保未隐藏使用的符号。

gcc 的默认行为是所有符号都是可见的。但是，当使用 option 构建翻译单元时`-fvisibility=hidden`，只有标有 的函数/符号`__attribute__ ((visibility ("default")))`在生成的共享对象中是外部的。

您可以通过调用来检查您正在寻找的符号是否是外部的：

```
# -D shows (global) dynamic symbols that can be used from the outside of XXX.so
nm -D XXX.so | grep MY_SYMBOL 
```

隐藏/局部符号`nm`以小写符号类型显示，例如，`t`而不是 `T 用于代码段：

```
nm XXX.so
00000000000005a7 t HIDDEN_SYMBOL
00000000000005f8 T VISIBLE_SYMBOL 
```

您还可以使用`nm`选项`-C`来对名称进行解密（如果使用了 C++）。

与 Windows-dll 类似，可以使用定义标记公共函数，例如`DLL_PUBLIC`定义为：

```
#define DLL_PUBLIC __attribute__ ((visibility ("default")))

DLL_PUBLIC int my_public_function(){
  ...
} 
```

大致对应于 Windows 的/MSVC 版本：

```
#ifdef BUILDING_DLL
    #define DLL_PUBLIC __declspec(dllexport) 
#else
    #define DLL_PUBLIC __declspec(dllimport) 
#endif 
```

[有关可见性](https://gcc.gnu.org/wiki/Visibility)的更多信息可以在 gcc wiki 上找到。

* * *

当使用生成的符号编译翻译单元时，`-fvisibility=hidden`仍然具有外部链接（以大写符号类型显示`nm`），并且如果目标文件成为静态库的一部分，则可以毫无问题地用于外部链接。仅当目标文件链接到共享库时，链接才成为本地链接。

要查找目标文件中的哪些符号是隐藏的，请运行：

```
>>> objdump -t XXXX.o | grep hidden
0000000000000000 g     F .text  000000000000000b .hidden HIDDEN_SYMBOL1
000000000000000b g     F .text  000000000000000b .hidden HIDDEN_SYMBOL2 
```

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2020-10-22T09:16:56.423

当我们在程序中引用对象名称（类、函数、变量等）并且链接器尝试在所有链接对象中搜索它时找不到它的定义时，会发生“<strong>未定义引用”错误文件和库。

因此，当链接器找不到链接对象的定义时，它会发出“未定义引用”错误。从定义中可以清楚地看出，此错误发生在链接过程的后期阶段。导致“未定义引用”错误的原因有多种。

**一些可能的原因（更频繁）：**

**#1) 没有为对象提供定义**

这是导致“未定义引用”错误的最简单原因。程序员只是忘记定义对象。

考虑以下 C++ 程序。这里我们只指定了函数的原型，然后在主函数中使用。

```
#include <iostream>
int func1();
int main()
{

    func1();
} 
```

输出：

```
main.cpp:(.text+0x5): undefined reference to 'func1()'
collect2: error ld returned 1 exit status 
```

因此，当我们编译该程序时，会发出链接器错误“未定义对 'func1()' 的引用”。

为了摆脱这个错误，我们通过提供函数 func1 的定义来更正程序如下。现在程序给出了适当的输出。

```
#include <iostream>
using namespace std;
int func1();

int main()
{

    func1();
}
int func1(){
    cout<<"hello, world!!";
} 
```

输出：

```
hello, world!! 
```

**#2) 使用对象的错误定义（签名不匹配）**

“未定义引用”错误的另一个原因是我们指定了错误的定义。我们在程序中使用任何对象，它的定义是不同的。

考虑以下 C++ 程序。这里我们调用了func1()。它的原型是int func1()。但其定义与其原型不符。如我们所见，函数的定义包含函数的参数。

这样程序在编译时，由于原型和函数调用匹配，所以编译成功。但是当链接器试图将函数调用与其定义链接时，它会发现问题并将错误作为“未定义的引用”发出。

```
#include <iostream>
using namespace std;
int func1();
int main()
{

    func1();
}
int func1(int n){
    cout<<"hello, world!!";
} 
```

输出：

```
main.cpp:(.text+0x5): undefined reference to 'func1()'
collect2: error ld returned 1 exit status 
```

因此，为了防止此类错误，我们只需交叉检查所有对象的定义和用法在我们的程序中是否匹配。

**#3) 目标文件未正确链接**

此问题还可能导致“未定义引用”错误。在这里，我们可能有多个源文件，我们可能会独立编译它们。完成此操作后，对象未正确链接，并导致“未定义引用”。

考虑以下两个 C++ 程序。在第一个文件中，我们使用了在第二个文件中定义的“print()”函数。当我们分别编译这些文件时，第一个文件为 print 函数提供了“未定义的引用”，而第二个文件为 main 函数提供了“未定义的引用”。

```
int print();
int main()
{
    print();
} 
```

输出：

```
main.cpp:(.text+0x5): undefined reference to 'print()'
collect2: error ld returned 1 exit status

int print() {
    return 42;
} 
```

输出：

```
(.text+0x20): undefined reference to 'main'
collect2: error ld returned 1 exit status 
```

解决此错误的方法是同时编译这两个文件（例如，使用 g++）。

除了已经讨论过的原因之外，“未定义的引用”也可能由于以下原因而发生。

**#4) 错误的项目类型**

当我们在 Visual Studio 等 C++ IDE 中指定错误的项目类型并尝试做项目不期望的事情时，我们会得到“未定义的引用”。

**#5) 没有图书馆**

如果程序员没有正确指定库路径或完全忘记指定它，那么我们会从库中获得程序使用的所有引用的“未定义引用”。

**#6) 相关文件未编译**

程序员必须确保我们事先编译好项目的所有依赖项，以便在编译项目时，编译器找到所有依赖项并编译成功。如果缺少任何依赖项，则编译器会给出“未定义的引用”。

*除了上面讨论的原因之外，“未定义的引用”错误可能发生在许多其他情况下。但底线是程序员做错了，为了防止这个错误，他们应该被纠正。*

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2019-01-21T19:44:00.697

## 函数或类方法在源文件中使用说明`inline`符定义。

一个例子：-

**主文件**

```
#include "gum.h"
#include "foo.h"

int main()
{
    gum();
    foo f;
    f.bar();
    return 0;
} 
```

**富.h (1)**

```
#pragma once

struct foo {
    void bar() const;
}; 
```

**口香糖.h (1)**

```
#pragma once

extern void gum(); 
```

**foo.cpp (1)**

```
#include "foo.h"
#include <iostream>

inline /* <- wrong! */ void foo::bar() const {
    std::cout << __PRETTY_FUNCTION__ << std::endl;
} 
```

**口香糖.cpp (1)**

```
#include "gum.h"
#include <iostream>

inline /* <- wrong! */ void gum()
{
    std::cout << __PRETTY_FUNCTION__ << std::endl;
} 
```

如果您指定`gum`（类似地，`foo::bar`）`inline`在其定义中，则编译器将内联`gum`（如果它选择），通过：-

*   不发出 的任何唯一定义`gum`，因此
*   不发出链接器可以引用的任何符号`gum`，而是
*   将所有调用替换`gum`为`gum`.

因此，如果您`gum`在源文件中定义 inline `gum.cpp`，它将被编译为一个目标文件`gum.o`，在该目标文件中，所有对 的调用`gum`都是内联的，并且没有定义链接器可以引用的符号`gum`。当您`gum.o`与另一个目标文件一起链接到程序时，例如`main.o` 引用外部符号`gum`，链接器无法解析这些引用。所以链接失败：

编译：

```
g++ -c  main.cpp foo.cpp gum.cpp 
```

关联：

```
$ g++ -o prog main.o foo.o gum.o
main.o: In function `main':
main.cpp:(.text+0x18): undefined reference to `gum()'
main.cpp:(.text+0x24): undefined reference to `foo::bar() const'
collect2: error: ld returned 1 exit status 
```

您只能定义`gum`好像编译器可以在每个可能被调用`inline`的源文件中看到它的定义。`gum`这意味着它的内联定义需要存在于您编译*的*每个可能被调用的源文件中的*头*文件中。做以下两件事之一：*`gum`*

 ***要么不内联定义**

`inline`从源文件定义中删除说明符：

**foo.cpp (2)**

```
#include "foo.h"
#include <iostream>

void foo::bar() const {
    std::cout << __PRETTY_FUNCTION__ << std::endl;
} 
```

**口香糖.cpp (2)**

```
#include "gum.h"
#include <iostream>

void gum()
{
    std::cout << __PRETTY_FUNCTION__ << std::endl;
} 
```

重建：

```
$ g++ -c  main.cpp foo.cpp gum.cpp
imk@imk-Inspiron-7559:~/develop/so/scrap1$ g++ -o prog main.o foo.o gum.o
imk@imk-Inspiron-7559:~/develop/so/scrap1$ ./prog
void gum()
void foo::bar() const 
```

成功。

**或正确内联**

头文件中的内联定义：

**富.h (2)**

```
#pragma once
#include <iostream>

struct foo {
    void bar() const  { // In-class definition is implicitly inline
        std::cout << __PRETTY_FUNCTION__ << std::endl;
    }
};
// Alternatively...
#if 0
struct foo {
    void bar() const;
};
inline void foo::bar() const  {
    std::cout << __PRETTY_FUNCTION__ << std::endl;
}
#endif 
```

**口香糖.h (2)**

```
#pragma once
#include <iostream>

inline void gum() {
    std::cout << __PRETTY_FUNCTION__ << std::endl;
} 
```

现在我们不需要`foo.cpp`or `gum.cpp`：

```
$ g++ -c main.cpp
$ g++ -o prog main.o
$ ./prog
void gum()
void foo::bar() const 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2021-10-18T14:50:21.403

**需要考虑的一些拼写错误：（**作为初学者经常发生在我身上）

*   如果您正在使用一个类：检查您是否在定义函数的 cpp 文件中的函数名之前忘记了“classname::”。
*   如果您使用前向声明：请务必声明正确的类型。例如：如果你想转发声明一个“结构”使用“结构”而不是“类”。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2018-12-10T16:40:04.397

**不同的架构**

您可能会看到如下消息：

```
library machine type 'x64' conflicts with target machine type 'X86' 
```

在这种情况下，这意味着可用符号用于与您正在编译的架构不同的架构。

在 Visual Studio 上，这是由于错误的“平台”造成的，您需要选择正确的平台或安装正确版本的库。

在 Linux 上，这可能是由于错误的库文件夹（例如使用`lib`而不是`lib64`）。

在 MacOS 上，可以选择将两种架构放在同一个文件中。可能是该链接希望两个版本都存在，但只有一个版本存在。拾取库的错误`lib`/文件夹也可能是一个问题。`lib64`

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2021-04-23T20:49:52.563

## 当您使用错误的编译器来构建程序时

如果您使用`gcc`的是`clang`编译器套件，则应根据您使用的语言使用正确的编译器驱动程序。`g++`使用或编译和链接 C++ 程序`clang++`。使用`gcc`or`clang`将导致对 C++ 标准库符号的引用未定义。例子：

```
$ gcc -o test test.cpp    
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: /tmp/ccPv7MvI.o: warning: relocation against `_ZSt4cout' in read-only section `.text' 
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: /tmp/ccPv7MvI.o: in function `main': test.cpp:(.text+0xe): undefined reference to `std::cout' 
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: test.cpp:(.text+0x13): undefined reference to `std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*)' 
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: /tmp/ccPv7MvI.o: in function `__static_initialization_and_destruction_0(int, int)': 
test.cpp:(.text+0x43): undefined reference to `std::ios_base::Init::Init()' 
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: test.cpp:(.text+0x58): undefined reference to `std::ios_base::Init::~Init()' 
/usr/lib/gcc/x86_64-pc-linux-gnu/10.2.0/../../../../x86_64-pc-linux-gnu/bin/ld: warning: creating DT_TEXTREL in a PIE 
collect2: error: ld returned 1 exit status 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2021-02-12T08:42:47.000

就我而言，语法是正确的，但是当一个类在同一个 DLL 中调用第二个类时，我遇到了这个错误。第二类的 CPP 文件`Properties->Item Type`在 Visual Studio 内部有错误，在我的情况下，它被设置为`C/C++ Header`而不是正确的，`C/C++ compiler`因此编译器在构建 CPP 文件时没有编译它并导致错误 LNK2019

这是一个示例，假设语法正确，您应该通过更改属性中的项目类型来获取错误

```
//class A header file 
class ClassB; // FORWARD DECLERATION
class ClassA
{
public:
ClassB* bObj;
ClassA(HINSTANCE hDLL) ;
//  member functions
}
--------------------------------
//class A cpp file   
ClassA::ClassA(HINSTANCE hDLL) 
{
    bObj = new ClassB();// LNK2019 occures here 
    bObj ->somefunction();// LNK2019 occures here
}
/*************************/

//classB Header file
struct mystruct{}
class ClassB{
public:
ClassB();
mystruct somefunction();
}

------------------------------
//classB cpp file  
/* This is the file with the wrong property item type in visual studio --C/C++ Header-*/
ClassB::somefunction(){}
ClassB::ClassB(){} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2020-02-28T16:46:49.970

通过在头文件中声明函数的原型，我发生了这个问题：

`int createBackground(VertexArray rVA, IntRect arena);`

但是然后使用带有第一个参数的引用在其他地方定义函数：

`int createBackground(VertexArray& rVA, IntRect arena) {}`

原型没有在第一个参数中使用引用，而定义是，这一事实导致了这个问题。当我将两者都更改为正确匹配包含引用或不包含引用时，问题已解决。

干杯。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2020-05-31T06:03:33.197

我的例子：

**头文件**

```
const string GMCHARACTER("character");
class GameCharacter : public GamePart
{
    private:
        string name;
        static vector<GameCharacter*> characterList;
    public:
        GameCharacter(cstring nm, cstring id) :
            GamePart(GMCHARACTER, id, TRUE, TRUE, TRUE),
            name(nm)
            { }
...
} 
```

**.cpp 文件：**

```
vector<GameCharacter*> characterList;
... 
```

这会产生“未定义”加载程序错误，因为“characterList”被声明为静态成员变量，但被定义为全局变量。

我添加这个是因为——虽然其他人将这个案例列在一长串需要注意的事项中——但该列表没有给出示例。这是一个需要寻找更多东西的例子，尤其是在 C++ 中。***************

# macos - 在 libmemcached 中配置 SASL 支持

> ID：12573817
> 
> 赞同：0
> 
> 时间：2012-09-24T22:27:44.140
> 
> 标签：macos, memcached, osx-mountain-lion, sasl, libmemcached

我正在尝试`libmemcached`在 OS X Mountain Lion 上构建 SASL 支持。

我`memcached`用 SASL 支持构建了（1.4.15）：

```
 $ memcached -S -vv
    Initialized SASL.
    slab class   1: chunk size        96 perslab   10922
    ...
    slab class  42: chunk size   1048576 perslab       1
    <17 server listening (binary)
    <18 server listening (binary)
    <19 send buffer was 9216, now 3728270
    <20 send buffer was 9216, now 3728270
    <19 server listening (udp)
    <20 server listening (udp)
    ... 
```

我`libmemcached`也在尝试使用 SASL 支持进行构建。我尝试了以下方法：

```
 $ ./configure --prefix=/usr/local \
      --with-memcached-sasl=/usr/local/bin/memcached
    ...
    $ ./configure --prefix=/usr/local \
      --with-memcached-sasl="/usr/local/bin/memcached -S"
    ... 
```

但是生成的配置摘要对于两者都是相同的：

```
Configuration summary for libmemcached version 1.0.11
       * Installation prefix:       /usr/local
       * System type:               apple-darwin12.2.0
       * Host CPU:                  x86_64
       * C Compiler:                i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)
       * C Flags:                    -O2 -Werror -Wall -Wextra -std=c99 -Wbad-function-cast -Wmissing-prototypes -Wnested-externs -Woverride-init
       * C++ Compiler:              i686-apple-darwin11-llvm-g++-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)
       * C++ Flags:                  -O2 -Werror -Wall -Wextra -Wpragmas -D_FORTIFY_SOURCE=2 -Waddress -Wchar-subscripts -Wcomment -Wctor-dtor-privacy -Wfloat-equal -Wformat=2 -Wmissing-field-initializers -Wmissing-noreturn -Wnon-virtual-dtor -Wnormalized=id -Woverloaded-virtual -Wpointer-arith -Wredundant-decls -Wshadow -Wshorten-64-to-32 -Wsign-compare -Wstrict-overflow=1 -Wswitch-enum -Wundef -Wunused-variable -Wwrite-strings -fwrapv -ggdb
       * CPP Flags:                 -I/usr/local/include
       * Assertions enabled:        no
       * Debug enabled:             no
       * Warnings as failure:       no
       * SASL support: 
```

我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T10:41:14.773

这在 OS X Mountain Lion（可能还有其他版本的 OS X）上是不可能的。我将向`libmemcached`团队提出这个问题。

# c - 遇到第一个返回语句时函数执行不退出

> ID：12573822
> 
> 赞同：0
> 
> 时间：2012-09-24T22:28:26.803
> 
> 标签：c, return, return-value

```
Buffer* b_create(int init_capacity, char inc_factor,char o_mode){

Buffer* buffer=NULL;    /*local pointer to the buffer structure on heap*/ 

if (o_mode=='f' || inc_factor==0){
    o_mode=0;
    inc_factor=0;
}else if (o_mode=='f' && inc_factor!=0){
    o_mode=0;
    inc_factor=0;
}else if (o_mode=='a' && 1<=inc_factor<=255){
    o_mode=1;
    inc_factor=inc_factor;
}else if (o_mode=='m' && 1<=inc_factor<=100){
    o_mode=-1;
    inc_factor=inc_factor;
}
else{
    buffer=NULL;
    return buffer;
}

    //throw a more meaningful error??

    //cleanup :: how about i just call the ca_destroy() ??
    /*
    free(buffer->ca_head);
    buffer->ca_head=NULL;
    free(buffer);
    buffer=NULL;
*/

buffer = (Buffer*)malloc(sizeof(Buffer));
buffer->ca_head=(char*)malloc(sizeof(char)*init_capacity);
buffer->mode=o_mode;
buffer->inc_factor=inc_factor;

buffer->capacity=init_capacity;
buffer->addc_offset=0;
buffer->mark_offset=0;
buffer->r_flag=0;

return buffer;

} 
```

我有上述方法。我正在努力让它工作。首先，我检查并设置了几个变量。如果没有任何情况适用，那么我将缓冲区设置为 NULL 并尝试将值返回给调用函数。

```
else{
    buffer=NULL;
    return buffer;
} 
```

然而，在返回之后，函数继续并继续创建缓冲区结构。我希望该函数一旦看到返回语句就会退出。为什么它继续执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T22:31:36.727

这个条件

```
1<=inc_factor<=255 
```

总是正确的。它被解析为`(1 <= inc_factor) <= 255`，并`1 <= inc_factor`评估为 0 或 1。因此，如果`o_mode`是`'a'`或`'m'`之一，则早期条件之一成立，即使`inc_factor`是 0 或负数。

查看条件链，我们发现：

```
if (o_mode=='f' || inc_factor==0){
    o_mode=0;
    inc_factor=0;
}else if (o_mode=='f' && inc_factor!=0){ // This is never true, because if o_mode == 'f',
    o_mode=0;                            // the first one already was true
    inc_factor=0;
}else if (o_mode=='a' && 1<=inc_factor<=255){ // This is just o_mode == 'a'
    o_mode=1;
    inc_factor=inc_factor;
}else if (o_mode=='m' && 1<=inc_factor<=100){ // This is just o_mode == 'm'
    o_mode=-1;
    inc_factor=inc_factor;
}
else{ // This is only reached if o_mode is none of 'f', 'a', 'm' and inc_factor is != 0
    buffer=NULL;
    return buffer;
} 
```

但如果`o_mode`不是`'f', 'a', 'm'`and ，则达到并返回`inc_factor != 0`最终结果。没有任何实现被破坏到足以忽略一条语句。`else``NULL``return`

# asp.net-mvc - 如何让 OAuth 在 MVC4 移动设备上运行

> ID：12573824
> 
> 赞同：1
> 
> 时间：2012-09-24T22:28:55.570
> 
> 标签：asp.net-mvc, facebook, jquery-mobile, oauth, mobile-website

我一直在努力让 OAuth 在我的 MVC4 移动应用程序上工作。

我基本上

1.  创建了一个 MVC4 移动应用程序
2.  创建了一个 MVC4 Web 应用程序
3.  将 AccountController、AccountModel、InitializeSimpleMembershipAttribute 和所有帐户视图复制到我的 MVC4 移动应用程序中
4.  启用 Google 和 Facebook OAuth 提供程序
5.  我还确保 RoleManager 是根据[simplemembershipprovider-not-working](https://stackoverflow.com/questions/12254701/simplemembershipprovider-not-working "simplemembershipprovider-not-working")初始化的，尽管我认为这并不重要。（我需要它来测试一些基于角色的安全性）
6.  通过设置 data-ajax="false" 禁用 ajax（我认为）：（ `using (Html.BeginForm("ExternalLogin", "Account",new RouteValueDictionary { { "ReturnUrl", ViewBag.ReturnUrl } }, FormMethod.Post, new Dictionary<string, object> { { "data-ajax", false } }))`这似乎对页面没有任何影响 - 所以我可能在这里做错了什么......）

我可以进入 LogIn 视图 /Account/Login，当我单击 google 按钮时，调试器会进入`public ActionResult ExternalLogin(string provider, string returnUrl)`

但是 -`public ActionResult ExternalLoginCallback(string returnUrl)`永远不会被击中。在视觉上，我得到了 jquery 移动“页面加载”动画 - 然后我得到“错误加载页面”

我有两个问题：

1.  当我试图弄清楚发生了什么时，如何获得更多信息？
2.  如何让 OAuth 在我的 MVC4 移动网站上运行？

顺便说一句：两个站点都针对 .Net4.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T07:48:34.643

好的——所以我找到了答案——cuplrit 确实是 jQuery mobile 中的 ajax。

我修改了我的 _layout.cshtml 以便它可以在加载 jQuery 之后，但在加载 jQuery 移动之前呈现自定义脚本：

```
 @Scripts.Render("~/bundles/jquery","~/scripts/RemoveHashFromWindowLocation")
    @RenderSection("beforeJqueryMobile", required: false);
    @Scripts.Render( "~/bundles/jquerymobile")
    @RenderSection("scripts", required: false) 
```

然后我修改了我的 Login.cshtml，使其包含以下部分：

```
@section BeforeJqueryMobile {
    @Scripts.Render("~/scripts/disable-ajax.js")
} 
```

最后，我将以下内容添加到我的脚本文件夹中：

禁用 ajax.js：

```
$(document).bind("mobileinit", function () {
    $.mobile.ajaxEnabled = false;
}); 
```

RemoveHashFromWindowLocation.js：（感谢[Facebook Oauth Login With Jquery Mobile #_=_](https://stackoverflow.com/questions/8069704/facebook-oauth-login-with-jquery-mobile)）

```
if (window.location.hash == "#_=_")
    window.location.hash = ""; 
```

Voila - 使用 jQuery 移动的 OAuth。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T19:21:43.893

如果您的网站直接加载到登录页面，espenalb 的上述答案确实有效，但是如果您先说主页，然后有一个指向登录页面的链接（使用相同的布局），您将在加载页面时收到错误消息您单击其中一个社交登录按钮。

要修复此添加

```
<script>

    $('#login-link').live("click", function () {
        $.mobile.ajaxEnabled = false;
    });

</script> 
```

在您的移动布局页面的底部，这将附加一个事件处理程序，该处理程序将禁用 ajax 到登录链接。

# r - 循环遍历 svy 包中的数据集变量

> ID：12573826
> 
> 赞同：0
> 
> 时间：2012-09-24T22:29:13.230
> 
> 标签：r

我已经构建了一个 R 函数，它在一系列列上使用相同的解释变量。我已经使用了该`glm`功能，但现在我需要`svyglm`从调查包中执行相同的操作。我遇到的主要问题是我无法像`svyglm(Data[,i]~explanatoryVariables)`在 中那样使用来构建循环`glm`，因为它不喜欢列名（但在循环中非常实用）。

例如，如果您尝试

```
library(survey)
data(api)
dstrat<-svydesign(id=~1,strata=~stype, weights=~pw, data=apistrat, fpc=~fpc)
summary(svyglm(api00~ell+meals+mobility, design=dstrat)) 
```

一切都很好，但是如果您想使用列号（此处为 13）遍历多个因变量，则会出现错误

```
summary(svyglm(apistrat[,13]~ell+meals+mobility,data=apistrat, design=dstrat)) 
```

有谁知道如何解决这个问题？举一个简单的例子（不要介意统计准确性或链接功能），我需要在正常情况下实现等效，`glm`但`svyglm`使用

```
for(i in (12:15)){
print(glm(apistrat[,i]~ ell+meals,data=apistrat)$aic)
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T22:59:36.890

You need to use `as.formula` to paste the appropriate columns for evaluation. I created a custom function for your case:

```
mysvy <- function(data, columns, ...) {
    model <- lapply(as.list(columns), function(x) {
          summary(svyglm(as.formula(paste0(names(data)[x], "~ell+meals+mobility")), 
            data = data, ...))
        })
    return(model)
} 
```

Then you can run your your desired columns through the function.

```
# To run columns 13 - 15 and get the results into a list
results <- mysvy(apistrat, 13:15, design = dstrat)
# should return a list of 3\. results[[1]] to see the first 
```

# css - 为什么将图像放在背景中而不是使用本机元素？

> ID：12573839
> 
> 赞同：1
> 
> 时间：2012-09-24T22:30:38.820
> 
> 标签：css, image

我是一个新手，现在正在研究使用背景而不是前景图像，这是一种常见的做法。

我查看了使用的技术，并看到：

*   您通常需要明确说明图像的尺寸（并将前景元素设置为这些尺寸）
*   您需要使用 css 技巧使前景元素以某种方式消失。这一切看起来真的很骇人听闻。所以，我想知道，到底为什么要做这一切而不是仅仅使用原生元素呢？我相信有一个很好的答案

（我确实经历了这个[When to use IMG vs. CSS background-image?，](https://stackoverflow.com/questions/492809/when-to-use-img-vs-css-background-image)但无法找到明确的答案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:44:28.277

将 CSS 用于图像的一个好处是，您可以使用一个 http 请求加载所有设计图像（用于 UI 元素的图像等），而不是使用 sprite 对每个单独的图像进行 http 请求。一张包含所有图像网格的大图像。

如前所述，内容图像应使用 img 标签，这也有助于人们在访问您的网站/应用程序时使用各种可访问性选项。例如，如果他们正在使用屏幕阅读器，屏幕阅读器知道它是一个图像，并且可以读取 img alt 名称或标题，但如果它只是一个带有背景图像的 div，他们什么也得不到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:39:12.973

主要区别在于`img`标签中的图像是*硬编码*的。

使用 CSS，您可以创建不同的设计、在它们之间切换、重新设计页面，而无需更改源代码。要查看 CSS 的强大功能，请查看[http://www.csszengarden.com/](http://www.csszengarden.com/)，所有页面都使用相同的 HTML 源代码，但 CSS 布局不同。

正如@Shmiddty 所说，if`img`用于嵌入图像（实际内容，例如画廊或文章的图片），而 CSS 用于设计。

此外，您提到的问题有很好的所有用例列表：`When to use CSS background-image`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T22:42:53.247

目标是将内容与演示分开。HTML 应该只包含内容，所有的展示都应该移到 CSS 中。一旦你实现了这一点，你就会获得一些有用的副作用：

*   CSS（展示代码）由用户的浏览器缓存，请求的每个 HTML 文件更小。这也有一些 SEO 好处（减少代码绒毛）。
*   在为视障用户解释您的页面时，屏幕阅读器必须少费些功夫。确保您的 HTML*仅包含内容*意味着视障用户可以更快地找到他们正在寻找的内容。
*   CSS 使得以不同的视觉配置显示相同的内容成为可能，这是[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_Web_Design)运动的基石。正确描述您的内容和演示意味着能够跨多个平台（台式机、平板电脑、智能手机）使用相同的 HTML 文件。

但是，有时图像是特定页面上的内容。在这些情况下，您想使用`IMG`标签，而将图像移动到 CSS 实际上是错误的举动。关于何时何地使用文本到图像替换的一个很好的讨论是[何时使用 IMG 与 CSS 背景图像？](https://stackoverflow.com/questions/492809/when-to-use-img-vs-css-background-image)基本上，我的个人试金石是这样的：这张图片会在网站上多次使用吗？如果是，它可能是设计的一部分。一次性图像通常是内容。

如果您希望将您的设计图像移至 CSS，那么恭喜 :-p 您已经完成了大量的工作，但开始为您的网站作为 Web 生态系统的一部分的长期健康做一些有价值的事情。我强烈建议研究使用[SASS/Compass](http://compass-style.org/)系统将您的设计图像作为 sprite 进行管理（参见[A List Apart:CSS Sprites](http://www.alistapart.com/articles/sprites/)和 [Spriting with Compass](http://compass-style.org/help/tutorials/spriting/)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T22:41:30.977

*图像替换*的要点之一是在标签中使用您的网站标题以`h1`获得良好的 SEO，然后隐藏文本并用自定义徽标替换它。

这也使您的网站更易于访问。例如，您的用户出于某种原因禁用了 CSS（可能是屏幕阅读器）。他们仍然会看到您网站标题的文本表示，而普通用户会看到自定义图形。

# java - 红黑树是否必须按排序顺序排列？

> ID：12573841
> 
> 赞同：2
> 
> 时间：2012-09-24T22:30:49.610
> 
> 标签：java, tree, red-black-tree

我在这里有一个非常简单的问题：红黑树是否必须按排序顺序排列？我问这个是因为维基百科页面右侧的小方框 (http://en.wikipedia.org/wiki/Red–black_tree) 说搜索时间是 O(log(n)); 但是，这不仅是对树进行排序的情况。但另一方面，属性 s

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:40:52.793

红黑树是排序树（所有RB树都是排序二叉树，但并非所有排序二叉树都是红黑树）。普通二叉树和红黑树的区别在于，RB 树*保证*搜索时间为*log [2] (n)*，因为它们是平衡的。从本质上讲，它保证了*n 个*节点的层数永远不会超过*log [2] (n)*，从而检查二进制搜索。

没有平衡的普通二叉树不会总是产生*log [2] (n)*的时间复杂度。例如，如果我有一棵这样的树：

```
 4
 / \
3   6
     \
      7
       \
       10
         \
         12 
```

对于这种不平衡的树，实际搜索时间几乎是线性的`12`（最坏情况下的时间复杂度，5 次比较）。对于最多具有*log [2] (n)*层的平衡树，上面的树可以是：

```
 7
   /   \
  4    10
 / \     \
3   6    12 
```

因此，找到任何最低层节点最多需要 3 次比较（适合*log [2] (n)*，因为它实际上是四舍五入的，*ceil[log [2] (6)] = 3*）

这里的关键是要记住，层数在功能上等于从根开始时必须进行的比较次数。红黑树通过平衡将层数限制在最低限度，而普通的不平衡二叉树则没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:37:38.810

红黑树是二叉搜索树。根据二叉搜索树的定义，左孩子（和所有后代）必须小于父节点，右孩子（和所有后代）必须大于父节点。因此有一个排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T22:56:59.013

The whole point of a red-black tree is to keep the tree balanced to some degree. If you relax the sorting constraint, then keeping a tree balanced is trivial since you can put nodes wherever you want.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-24T22:37:37.127

红黑树的搜索时间为 O(log n)，因为它以自然顺序设置节点的方式。

当您进行节点比较时，理论上您在选择分支时会丢弃一半的选项。

由于您只能`log n times`在获得一个元素之前“减半”，因此您的搜索复杂性是`O(log n)`

# ruby - Ruby：在类之间使用变量

> ID：12573843
> 
> 赞同：1
> 
> 时间：2012-09-24T22:31:07.150
> 
> 标签：ruby

我正在制作一个简短的基于文本的游戏，作为基于我到目前为止所学的 Ruby 的额外学分练习，我无法让类在彼此之间读取和写入变量。我已经广泛阅读并寻找有关如何执行此操作的说明，但我没有太多运气。我尝试过使用`@`实例变量，`attr_accessible`但我无法弄清楚。到目前为止，这是我的代码：

```
class Game
  attr_accessor :room_count

  def initialize
    @room_count = 0
  end

  def play
    while true
      puts "\n--------------------------------------------------"

      if @room_count == 0
        go_to = Entrance.new()
        go_to.start
      elsif @room_count == 1
        go_to = FirstRoom.new()
        go_to.start
      elsif @room_count == 2
        go_to = SecondRoom.new()
        go_to.start
      elsif @room_count == 3
        go_to = ThirdRoom.new()
        go_to.start
      end
    end
  end

end

class Entrance

  def start
    puts "You are at the entrance."
    @room_count += 1
  end

end

class FirstRoom

  def start
    puts "You are at the first room."
    @room_count += 1
  end

end

class SecondRoom

  def start
    puts "You are at the second room."
    @room_count += 1
  end

end

class ThirdRoom

  def start
    puts "You are at the third room. You have reached the end of the game."
    Process.exit()
  end

end

game = Game.new()
game.play 
```

我想让不同的`Room`班级更改`@room_count`变量，以便`Game`班级知道接下来要去哪个房间。我也试图在不实现类继承的情况下做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:51:01.447

```
class Room
  def initialize(game)
    @game = game
    @game.room_count += 1
  end

  def close
    @game.room_count -= 1
  end
end

class Game
  attr_accessor :room_count

  def initialize
    @room_count = 0
  end

  def new_room
    Room.new self
  end
end

game = Game.new
game.room_count # => 0
room = game.new_room
game.room_count # => 1
room.close
game.room_count # => 0 
```

# wpf - MVVM 架构中的 App.Config

> ID：12573846
> 
> 赞同：4
> 
> 时间：2012-09-24T22:31:45.693
> 
> 标签：wpf, mvvm

每个应用程序都包含一些可配置的设置。这些设置或多或少可以分为两类：

1.  应用程序的外观：示例可以是窗口位置、窗口大小、视图的默认选项等。
2.  业务规则：这些设置将被业务逻辑使用。

在我实现的架构中，View 有自己的项目（WPF），ViewModel 有自己的项目（类库）。从逻辑上讲，View 应该负责加载/保存视图相关设置，ViewModel 应该负责加载/保存业务设置。

视图设置很容易处理。在设置（app.config）中创建所需的属性，您可以轻松加载并保存它们。

但是，ViewModel 无法通过 View 项目中可用的内置机制访问 app.config 设置。

我的第一个想法是创建一些辅助方法，允许我从 ViewModel 读取/写入 app.config 中的设置。你有什么意见？我是否在这里使事情复杂化，或者这是处理应用程序设置的可接受方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:44:33.187

您可以通过三种方式来这里。

1.  添加对 System.Configuration.dll 的引用，让您的 ViewModel 项目正常使用[ConfigurationManager](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)。

2.  让 ViewModel 项目通过构造函数或其他依赖反转的方法请求它需要的配置信息，并让 View 项目将其传入。

3.  将 ViewModels 和 Views 放在主应用程序项目中。

就个人而言，我会选择选项 3，除非出于某种原因他们需要在单独的程序集中。如果它们需要分开，那么我会支持选项 1，因为它更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-24T00:58:19.230

如果您想将程序集分开并保持 ViewModel 可测试，这是一个更简洁的选项：

在您的 ViewModel 项目中，添加一个接口，该接口提供用于检索和保存业务设置的方法或属性。让您的 ViewModel 接受此接口作为其构造函数中的依赖项。

在您的 View 项目中，添加一个实现此接口并与 Settings 对话的类，例如，

```
namespace ViewModel
{
    public interface IBusinessSettingsStore
    {
        public string SomeSetting { get; set; }
        public int AnotherSetting { get; set; }
    }

    public class SomeViewModel
    {
        private IBusinessSettingsStore _businessSettings;

        public SomeViewModel(IBusinessSettingsStore businessSettings)
        {
            _businessSettings = businessSettings;
        }

        private void DoSomething()
        {
            Console.WriteLine(_businessSettings.SomeSetting);
            _businessSettings.AnotherSetting = 10;
        }
    }
}

namespace View
{
    public class BusinessSettingsStore : IBusinessSettingsStore
    {
        public string SomeSetting
        {
            get => Settings.Default.SomeSetting;
            set => Settings.Default.SomeSetting = value;
        }

        public int AnotherSetting
        {
            get => Settings.Default.AnotherSetting;
            set => Settings.Default.AnotherSetting = value;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-24T01:52:17.080

这个库给我留下了深刻的印象：[https](https://www.nuget.org/packages/UserSettingsApplied/) ://www.nuget.org/packages/UserSettingsApplied/ 。它基本上允许您毫不费力地将您想要的任何内容序列化到用户的漫游应用程序配置中。它似乎经过深思熟虑并经过良好测试。这允许视图模型轻松地将设置保存在 app.config 中。

仅供参考，View 项目引用 View Model 是完全可以的。不仅如此，它几乎是强制性的，因此您的视图可以通过视图模型层完成所有持久性。

# components - Apache Wicket 中的可重用编辑表单

> ID：12573847
> 
> 赞同：0
> 
> 时间：2012-09-24T22:31:55.843
> 
> 标签：components, wicket, panel, form-submit, onsubmit

我有一个简单的 ContactEditPanel，其中包含一个表单和许多文本字段。到目前为止，我在这个面板中包含了一个 AjaxSubmitLink，如果表单内容有效，它会保存/更新 Panel 模型中包含的 Contact 实例。到目前为止这么简单。但是现在我想删除链接，以便我可以根据我使用 ContactEditPanel 的上下文将提交链接放置在我的整个组件层次结构的不同级别。例如，在一个上下文中，我想在 ContactEditPanel 和 ContactViewPanel 之间切换，并在当前视图上方有一个操作栏（编辑|保存，取消）。另一种情况是以独立方式使用 ContactEditPanel（可能是多步骤过程的一部分），下面只有一个保存链接。

[我正在考虑重构我的 ContactEditPanel 以扩展 FormComponentPanel 而不是此处](https://cwiki.apache.org/confluence/x/GIaAAQ)描述的 Panel但我不确定这是否是正确的方法，我无法解决这个问题。

非常感激任何的帮助！

非常感谢，

一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T08:28:24.550

您像 FormComponent 一样使用面板，因此扩展 FormComponentPanel，它将允许您将编写的所有验证包含在组件中，并允许您根据需要重用它。

想象一下，您已经创建了一个新的 FormComponent，例如 TextField 或 DropDownChoice。

# jquery-ui - 在 jquery 可拖动期间显示底部边框的正文

> ID：12573848
> 
> 赞同：0
> 
> 时间：2012-09-24T22:32:12.747
> 
> 标签：jquery-ui, jquery-ui-draggable

我正在使用 jquery-ui 可拖动。当我将框拖到屏幕底部之外时，身体会向下移动。我怎样才能防止这种情况发生？

**试过...**

我已经尝试使可拖动成为`containment: "*tag*"`标记为 html 或正文的位置。

仍在尝试`containment`，我尝试用 div 包围布局，但是，这破坏了 LHS、RHS 和中心的布局滚动能力。

通过制作`body`-来解决问题`position: static !important`。这会破坏布局。

作为参考，这里是[jquery-ui 可拖动页面](http://jqueryui.com/demos/draggable/)。

**CSS 布局**

我有一个布局，它是页眉、固定高度页脚、左右固定宽度可滚动、流体中心可滚动。页眉和页脚可以使用大的主体边框 hack 来实现。有关布局的信息，请参阅此问题。[如何拥有固定左/右、流畅中间和固定页脚的 3 列布局？](https://stackoverflow.com/questions/12489909/how-to-have-a-3-column-layout-with-fixed-left-right-fluid-middle-and-fixed-foot)

**重现问题。**

这是我的小提琴：http: [//jsfiddle.net/valamas/LrXCA/](http://jsfiddle.net/valamas/LrXCA/)

请单击并拖动页脚下方的蓝色框以查看黑色带或进一步的粉红色带。

![在此处输入图像描述](../Images/41a0b9779e3eb14a2b930aff9c75d0f9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:35:47.063

传递`scroll: false`给您的可拖动构造函数。

默认情况下，**自动滚动**选项设置为 true，如果您不想要它，则必须`scroll: false`在创建可拖动对象时指定。请参阅[jQuery 可拖动页面上的](http://jqueryui.com/demos/draggable/)**滚动**选项。

工作[**的jsFiddle**](http://jsfiddle.net/LrXCA/13/)

# mysql - 带有 INNER JOIN 的 MySQL SQL 语句

> ID：12573850
> 
> 赞同：1
> 
> 时间：2012-09-24T22:32:15.417
> 
> 标签：mysql, sql, inner-join

我有以下 SQL 语句

```
SELECT be.*, it.order_number
FROM songs AS be

INNER JOIN
(
    SELECT song_id, order_number
    FROM items
    WHERE order_status = 1
) it
ON be.id = it.song_id

INNER JOIN orders AS or
ON it.order_number = or.order_number

WHERE be.active = 0 
```

我似乎无法理解为什么这个语句没有产生任何结果。当我删除以下行时；

```
INNER JOIN orders AS or
ON it.order_number = or.order_number 
```

它似乎产生了结果，我知道表中`order_number`确实存在`orders`- 所以它显然是不正确的语法，但我不知道从哪里开始？感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:47:28.220

这个特定实例中的问题是`or`查询中的 是保留字。如果你愿意，你可以使用它，但你必须引用它，就像这样

```
SELECT be.*, it.order_number
FROM songs AS be

INNER JOIN
(
    SELECT song_id, order_number
    FROM items
    WHERE order_status = 1
) it
ON be.id = it.song_id

INNER JOIN orders AS "or"
ON it.order_number = "or".order_number

WHERE be.active = 0 
```

不过，一般来说，为了可读性，我会避免使用这样的名称。如果你必须引用它或转义它，它可能是一个坏名字。

# ios - 子类 UIImage imageNamed:?

> ID：12573853
> 
> 赞同：1
> 
> 时间：2012-09-24T22:32:43.253
> 
> 标签：ios, image, cocos2d-iphone, iphone-5

我正在支持 iPhone 5 的旅途中。我很清楚 Interface Builder 中有 iOS 6 的自动布局功能。这很好，但有时我想加载我自己的图像，如果它是 iPhone 5。

因此，我的 iPhone 游戏中的一些图像正好是屏幕尺寸（320x480）或（640 x 960）。因此，如果我使用的是 iPhone 5，这些图像将不会覆盖整个屏幕。所以我将为这些全屏图像制作（640 x 1136）图像。

现在我知道，如果我只是将图像命名为： MyImage-568h@2x.png 它不会加载。那么，我将如何子类 UIImage 以便它加载不是默认图像的 -568h@2x 图像？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:45:49.000

1.  懒惰的方式：

    ```
    UIImage * img = [UIScreen mainScreen].bounds.size.height > 500 ? [UIImage imageNamed:@"Default-568h.png"] : [UIImage imageNamed:@"Default.png"]; 
    ```

    我在一个应用程序中完成了这项工作，其中没有摄像头的设备上的主屏幕是`Default.png`；它似乎并*不太*老套，因为无论如何我们都需要更改 Default.png 以支持新设备。

2.  不那么懒惰的方法：以您需要填充的空间为条件，*而不是*屏幕大小。

3.  您要求的解决方案并不足以保证课程的通用性，但无论如何都是这样：

    ```
    @implementation MyImage
    +(UIImage)imageNamed:(NSString*)name {
      if ([UIScreen mainScreen].bounds.size.height > 500) {
        UIImage * img = [UIImage imageNamed:[name stringByAppendingString:@"-iPhone5"];
        if (img) { return img; }
      }
      return [UIImage imageNamed:name];
    }
    @end 
    ```

    真的没有必要继承 UIImage。如果你觉得*很*hacky，你可以patch/swizzle/otherwise`+[UIImage imageNamed:]`指向自定义方法，但我真的不建议这样做，除了调试。

# r - 分析 R 中的相关数据：线性、岭回归、PCR

> ID：12573859
> 
> 赞同：2
> 
> 时间：2012-09-24T22:33:34.353
> 
> 标签：r, statistics, regression, linear-regression

我有 5 个变量的时间序列观察结果，`y, x_1, x_2, x_3, x_4`任务是找出哪些`x`es 对`y`. 现在的问题是它们都具有很强的互相关性并表现出共线性。`x_1, x_2, x_3, x_4`内部没有隐藏的组件，它们对它们是成对的或以任何其他方式共有的——它们只是自然相关的。

可以预见的是，线性回归会给出不合理的结果，在去除其中一个变量后系数会发生剧烈变化，这是高度共线性数据的正常情况。

正如[wiki](http://en.wikipedia.org/wiki/Multicollinearity#Remedies_for_multicollinearity)上所建议的，多重共线性的一些补救措施是使用岭回归和主成分回归。但是，当我使用`lm.ridge`方法时，它给我的系数与`lm`.

在这种情况下 PCR 可以提供帮助吗？如果可以，R 中有什么简单的方法可以从中检索系数和 p 值？类似于功能汇总表的东西`lm`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T23:23:42.397

看一下

> 多尔曼等人。（2012）。共线性：回顾处理它的方法和评估其性能的模拟研究。 [付费专区](http://onlinelibrary.wiley.com/doi/10.1111/j.1600-0587.2012.07348.x/abstract)，[替代链接](http://www.biom.uni-freiburg.de/Dateien/PDF/Dormann2012Ecographyearlyonline)

审查可用的方法。

R 代码和数据可[在此处](http://www.biom.uni-freiburg.de/Dateien/PDF/CollinearityRcodeData)获得:)

# c# - 如何在 ASP.NET 中以声明方式使用附属程序集

> ID：12573862
> 
> 赞同：0
> 
> 时间：2012-09-24T22:33:41.607
> 
> 标签：c#, asp.net, satellite-assembly

就是这样，我一直在学习附属程序集，并且我想我已经了解如何创建它们以及如何**在代码中使用它们与 ResourceManager**

问题是我想通过页面的标记（以声明方式）使用卫星组件，但我还没有找到一种方法来做到这一点。

有什么想法吗？

我的目标是能够像这样使用它们：

```
<asp:Localize runat="server" Text="<%$ Resources:[external assembly][resources file name], [resource key] %>">

</asp:Localize> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:40:06.523

您需要实现自己的自定义[ResourceProvider](http://msdn.microsoft.com/en-us/library/aa905797.aspx)，您将在其中构建使用这些程序集的方法。

# sql-server - 从“登录历史表”中获取“登录用户”（会话模拟）

> ID：12573867
> 
> 赞同：2
> 
> 时间：2012-09-24T22:34:41.107
> 
> 标签：sql-server

我有一张这样的桌子：

```
ID | username | domain | operation| datetime 
---+----------+--------+----------+--------------------
1  | john     | depA   | 'login'  | 2012-09-22 13:00:00
2  | mary     | depA   | 'login'  | 2012-09-22 13:10:00
3  | john     | depA   | 'login'  | 2012-09-24 13:25:00
4  | john     | depA   | 'logout' | 2012-09-24 13:55:00 
```

我想`(SELECT DISTINCT)`在过去 20 小时（日期时间）内获取其最后一次操作是登录（最后没有注销）的所有“用户名，域”。

这个想法是让“当前在会话中的所有用户”。

我希望只在一个查询中处理结果。

请问有什么想法吗？我找不到仅使用 T-SQL 获得结果的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:31:11.463

您可以使用公用表表达式过滤掉日期，然后在查询中使用它两次以获取每个用户的最新活动：

```
;WITH RecentLogins AS
(SELECT username, operation, logdate
FROM logins
WHERE logdate >= DATEADD(hh, -20, GETDATE()))

SELECT r1.* 
FROM RecentLogins r1
WHERE logdate = (
    SELECT MAX(logdate) 
    FROM RecentLogins r2
    WHERE r1.username = r2.username AND r1.domain = r2.domain)
AND operation = 'login' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:49:23.570

您可以使用该[`DATEADD`](http://sqltutorials.blogspot.com/2007/06/sql-dateadd-function.html)功能，只需使用负数。

```
SELECT DISTINCT username, domain FROM table_name
WHERE operation = 'login' AND datetime >= DATEADD(Hour, -20, CURRENT_TIMESTAMP) 
```

# icons - 如何设置 AutoHotkey MsgBox 任务栏图标？

> ID：12573868
> 
> 赞同：0
> 
> 时间：2012-09-24T22:34:56.463
> 
> 标签：icons, taskbar, autohotkey

[我在带有自定义托盘图标](http://www.autohotkey.com/docs/commands/Menu.htm)的脚本中有一些热键。

```
Menu Tray, Icon, my_hotkeys.ico 
```

其中一个显示带有确定按钮和问号图标的[消息框。](http://www.autohotkey.com/docs/commands/MsgBox.htm)

```
MsgBox, 32, My Hotkeys, Hey, here's some info... 
```

但是，它在 Windows 任务栏中具有默认的绿色 H AutoHotkey 图像。我浏览了所有的菜单选项。并且 GUI 命令声称它使用菜单图标（如果已设置）。但我找不到任何特定于 MsgBox 的内容。有什么方法可以将 MsgBox 图标更改为我在系统托盘中使用的相同自定义图标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T01:12:36.590

有几种可能的解决方案：

*   `+OwnDialogs`在调用 MsgBox 之前创建并显示一个 Gui 。
*   使用 Gui 命令编写您自己的类似 MsgBox 的代码。
*   使用自定义图标编译您的脚本（转换为 exe）。
*   替换 AutoHotkey.exe 中的图标资源（影响所有脚本）。
*   在显示 MsgBox 之前设置一个计时器，然后在它出现后发送 WM_SETICON。
*   在显示窗口之前挂钩创建 MsgBox 窗口以设置图标 - [C++ 中的示例](https://stackoverflow.com/a/10628981/894589)。

+OwnDialogs 示例：

```
Menu Tray, Icon, shell32.dll, 5  ; Folder icon
Gui +OwnDialogs
Gui Show           ; Since it has zero dimensions, it should be invisible.
MsgBox Testing...
ExitApp 
```

# jquery - 优化 SWF 加载时间

> ID：12573869
> 
> 赞同：0
> 
> 时间：2012-09-24T22:34:58.893
> 
> 标签：jquery, html

所以我的网页上有一个 swf 文件，按下按钮就会显示。我目前正在使用 jquery hide 函数来隐藏包含 swf 的 html 代码块。问题是，按下按钮后加载需要几秒钟。有没有办法可以优化加载时间？也许在页面实际加载时以某种方式“加载” swf，然后在单击按钮时显示它？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T17:28:40.237

[Tuts+ 预加载器](http://active.tutsplus.com/tutorials/workflow/the-comprehensive-guide-to-preloading-a-single-swf-file/)

建议在 Flash 中使用预加载器。swf 文件并没有像图像那样真正得到预加载。请参阅上面的链接。

另一种选择是在打开页面时加载 swf，然后在您的预加载器有效播放后立即停止播放，然后一旦用户单击按钮，它就会跳转到下一帧以继续播放您的 swf 的其余部分。

# javascript - 无法在 Javascript 中分配元素

> ID：12573876
> 
> 赞同：0
> 
> 时间：2012-09-24T22:35:56.270
> 
> 标签：javascript, html

这段代码有什么问题吗，比如没有分配权利之类的？所有引用的 ID 都存在，控制台记录它，但只`topbar.cw`分配。我认为它也可能被分配到其他地方，不确定。另外，我什至不确定这是什么。它是一个数组、一个类、一个构造还是什么？

```
var topbar = {};
if(document.readyState == 'complete'){
topbar.cw=document.getElementById('contentWrapper');
topbar.tb=document.getElementById('topbar');
topbar.hd=document.getElementById('header');
topbar.sm=document.getElementById('storyMenu');
topbar.dd=document.getElementById('dropdown');
topbar.bc=document.getElementById('bodyContent');
topbar.sb=document.getElementById('sidebar');
topbar.mm=document.getElementById('mainMenu');
topbar.da=document.getElementById('displayArea');
console.log("fired when done loading");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:05:19.607

在代码中：

```
> var topbar = {}; 
```

将新对象分配给`topbar`

```
> if(document.readyState == 'complete') { 
```

如果 的值`document.readyState`等于字符串 'complete'，则：

```
>     topbar.cw = document.getElementById('contentWrapper'); 
```

将 RHS 上的调用结果分配给 的`cw`属性`topbar`。如果这样的属性不存在，则创建它。

如果存在 id 为*contentWrapper*的元素，则分配对该`cw`属性的引用。如果不存在 id 为*contentWrapper*`null`的元素，则将分配一个值，因为这就是[document.getElementById](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-getElBId)指定在找不到匹配元素时返回的值。

```
>   topbar.tb = document.getElementById('topbar');
>   ...
>   console.log("fired when done loading"); 
```

上面的消息是否曾经显示在控制台中？你有没有尝试过：

```
 console.log(topbar); 
```

如果没有，请尝试一下。报告你看到的。

# objective-c - ECSlidingViewController UITabBarController setTopViewController:]：无法识别的选择器发送到实例

> ID：12573877
> 
> 赞同：0
> 
> 时间：2012-09-24T22:36:02.557
> 
> 标签：objective-c, ios, xcode, cocoa

我正在使用开源来处理 Facebook 风格的滑动菜单。我在下面遇到异常。

```
UITabBarController setTopViewController:]: unrecognized selector sent to instance 
```

我正在使用 ARC、Storyboard、XCode 4.5 和`UITabController`. 它试图做的是设置一个 viewController。Vc 不为空。

它正在尝试将视图控制器设置为下方并引发错误。ExploreViewController 嵌入在 Navigation Controller 中，而且`UITabBarController`.

```
@property (nonatomic, strong) UIViewController *topViewController; 
```

这是我的代码。

```
ECSlidingViewController *slidingViewController = (ECSlidingViewController *)self.window.rootViewController;
UIStoryboard *storyboard;
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
    storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
} else if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
    storyboard = [UIStoryboard storyboardWithName:@"iPad" bundle:nil];
}
UIViewController *vc= [storyboard instantiateViewControllerWithIdentifier:@"ExploreViewController"];
slidingViewController.topViewController = vc; //exception thrown here. 
```

# java - MappedByteBuffer 内存使用情况

> ID：12573882
> 
> 赞同：1
> 
> 时间：2012-09-24T22:36:57.363
> 
> 标签：java, minecraft, bukkit

我有一个程序在重新启动之前运行了 12 个多小时。该程序是一个我的世界服务器，所以它不能经常重新启动。

无论如何，大约每 25-35 分钟读取一个大小为 42-67mb 的文件。我使用 RandomAccessFile 和 MappedByteBuffer 将文件读入 ObjectInputStream。

问题是每次读取文件时，内存使用量都会增加 100-300mb，这最终会导致 OOM，因为它永远不会被垃圾收集。我目前正在使用 VisualVM 对其进行调试，并且仅在读取文件时看到内存使用量增加。

我已经添加了

```
((DirectBuffer) buffer).cleaner().clean(); 
```

但它似乎并没有让虚拟机进行垃圾收集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:46:25.187

当我在 2003 年左右测量时，映射缓冲区相对于随机访问文件的速度优势约为 20%。如果它从那以后有所增加，我会感到惊讶，如果它对于顺序访问同样高，我也会感到惊讶。考虑到 OOME 的风险，这是不值得的。在 FileInputStream 周围的 BufferedInputStream 周围使用 ObjectInputStream。

# git - 如何使用 git 和 git 钩子同步数据库以及如果它不起作用如何调试

> ID：12573883
> 
> 赞同：2
> 
> 时间：2012-09-24T22:36:59.137
> 
> 标签：git, bash, sync, mysqldump, githooks

在操作系统上：Ubuntu 12.04

我的服务器上有一个 drupal 部署（实时网站）和一个登台环境（测试网站）。每次我从暂存网站中提取更改时，我都想自动同步数据库，如下所示：http: [//ben.kulbertis.org/2011/10/synchronizing-a-mysql-database-with-git-and-git -钩子/](http://ben.kulbertis.org/2011/10/synchronizing-a-mysql-database-with-git-and-git-hooks/)

我使用的设置完全相同（当然，设置和路径根据我的设置）。

**引自网站：**

> 让我们从预提交开始。预提交挂钩将在执行提交之前直接运行脚本。要编辑您的预提交挂钩：
> 
> ```
> [your editor] /path/to/your/repo/.git/hooks/pre-commit 
> ```
> 
> 现在，让我们编写预提交脚本。我们将告诉系统将我们的 MySQL 数据库转储到我们的 git 存储库并添加它以提交。
> 
> ```
> #!/bin/sh
> mysqldump -u [mysql user] -p[mysql password] --skip-extended-insert [database] > /path/to> /your/repo/[database].sql
> cd /path/to/your/repo
> git add [database].sql 
> ```
> 
> 现在，让我们编写合并后脚本。我们将告诉系统将 MySQL 转储恢复到本地数据库以获取最新更改。使用以下命令编辑合并后挂钩：
> 
> ```
> [your editor] /path/to/your/repo/.git/hooks/post-merge 
> ```
> 
> 和写：
> 
> ```
> #!/bin/sh
> mysql -u [mysql user] -p[mysql password] [database] < /path/to/your/repo/[database].sql 
> ```

但是当我先提交然后再拉时，似乎什么都没有发生。post-merge 和 pre-commit 挂钩位于部署存储库的 hooks 目录中，我从中执行提交和拉取。两者都有执行权：`chmod +x /path/to/hook`

我已经测试了我放在钩子中的命令。他们应该正常工作。

有什么办法可以调试出什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T18:27:41.330

对于“ **post-merge** ”，如果您运行“ **git pull** ”并且已经是最新的，那么“ **post-merge** ”钩子将不会运行。

如果您的存储库中没有文件发生更改，似乎“**预提交”挂钩将运行。**只需确保脚本中的任何命令后都没有空格。

这真的很令人失望，我很想看到一个 ' **pre-pull** ' 钩子和一个 ' **pre-commit** ' 钩子，无论对存储库的更改如何，它们都会运行。

再说一次，我不是开发人员，所以我可能在这里遗漏了一些东西。. .

编辑：只是测试这个以确保我得到了正确的。

# c# - 使用 C# 桌面应用程序控制对 SQL Server 数据库文件的访问

> ID：12573894
> 
> 赞同：0
> 
> 时间：2012-09-24T22:37:59.403
> 
> 标签：c#, sql-server, sql-server-2008, desktop-application

我正在使用带有 SQL Server Express 2008 的 C# 开发一个会计应用程序，该应用程序仅在本地访问数据库。我希望客户在安装应用程序时输入用户名和密码，这样他是唯一可以运行应用程序的人，我的问题是：
1.我应该将登录凭据存储在本地文件中，还是使用这些凭据创建一个 sql server 用户帐户并依靠数据库对其保密？
2.如果第二个选项可行，如何从安装程序包中执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:43:48.120

您可以执行类似的操作，将数据库设置（例如 IP、端口、用户名和密码登录尝试凭据）存储在本地（可能在 XML 文件中），然后将程序的登录凭据存储在数据库中。

注意：显然我不知道您对安全性了解多少，但这里有一些提示：

1）不要将密码直接存储在数据库中。使用哈希和某种加密方法。2）检查用户尝试登录的给定密码的哈希值，以及您为程序创建的数据库存储变量，该变量也应该是哈希值。

基本上，数据库在任何时候都不应该知道实际密码是什么，只知道您传递给它的给定哈希值，并且可以在程序本身中进行比较。

关于数据库访问，我将创建一个用户，该用户只能访问您想要的模式。从那里，让您的应用程序/程序中的登录用户使用例如 XML 文件中的凭据登录数据库。在 XML 文件中加密这些细节也是一个想法，因此它们不能在本地被篡改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T23:10:48.560

这还有很多。如果安装 sql server 的人选择了 sql server security，则该用户 (sa) 将被定义并且可以访问所有内容。

如果只有 windows，那么它将是安装 sql server 的 windows 用户，他们将可以访问所有内容

如果混合，两者都可以访问所有内容

然后哪个用户在服务器上创建了数据库，默认情况下他们将是 dbo 并且可以完全访问他们的数据库。

所以这一切都取决于谁在做什么。

您的应用程序安装程序是否调用 sql server 安装？它会创建数据库吗？

管理员和 dbo 都可以向他们喜欢的任何人授予对所述数据库的访问权限。

添加安装应用程序的 Windows 用户只需让安装程序执行一两个 sql 命令即可。此时您已启用单点登录。无需密码即可添加 Windows 用户并将其映射到数据库角色/用户。

如果您想要任何用户知道的用户名和密码，那么也许只有 sql/混合模式是可行的方法。再次从您选择的安装程序执行几个 sql 命令来获取用户 fred 密码？，工作完成。

要记住的一点是，为了执行添加登录名和用户、角色等的指令，您需要以其他人的身份进行连接，例如 windows admin 或 sa。

此外，托管网络上的大多数应用程序用户都没有管理员权限，因此您也可以从中获得一些乐趣。

我建议您阅读有关 sql server 安全性的内容，有几种方法可以剥去这只猫的皮，只有您有足够的信息来选择最佳选项。

您甚至可能想考虑基于应用程序的安全性，如果您的应用程序的每次安装都会创建它自己的数据库和角色......

# node.js - 节点应用程序变量传递到手写笔文件

> ID：12573897
> 
> 赞同：5
> 
> 时间：2012-09-24T22:38:12.367
> 
> 标签：node.js, express, stylus

我正在构建一个小节点应用程序，并使用 Express with Jade 和 Stylus 来呈现一些基本的 HTMl 页面。

我很好奇是否有办法将一些变量传递到从 Node 生成的 .styl 文件中？我很清楚我可以在 .styl 文件中定义变量，但我需要更加动态。具体来说，我正在寻找一种简单的方法来在数据库中存储一些颜色，让节点获取这些值，然后将它们插入到 .styl 文件中，以便在呈现页面时传递这些变量。看起来应该这样做-可以，但我缺乏细节。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T17:38:46.517

感谢@ebohlman，因为他的建议与我最终实施的很接近。

基本上我试图弄清楚如何在连接中间件之上做到这一点，这就是我想出的：

在执行 app.configure 时，我使用了自定义编译功能（键“编译”），如下所示：

```
app.use(require('stylus')
  .middleware({
    src: app.root + '/app/public',
    compile: compile
  })
); 
```

然后我创建了几个函数：

```
var stylus = require('stylus');
var mylib = function(style){
  style.define('themeColor1', function(){
    //call to the db that returns a color
    color = 'blue';
    color = color ? color : 'orange';
    return new stylus.nodes.Literal(color);
  });
};

var compile = function(str, path) {    
  return stylus(str)
    .use(mylib);
}; 
```

然后在 .styl 文件中我做：

```
background-color themeColor1(); 
```

themeColor1 函数中的三元运算符允许简单的默认值和覆盖。我花了一些时间才根据示例弄清楚 API，但似乎这可能是其他人想知道如何做的解决方案。如果有人对这种方法有任何不满，请告诉我。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-25T01:15:42.553

您可以使用 Stylus API 的[define()](http://learnboost.github.io/stylus/docs/js.html#definename-node)函数来设置 Stylus 变量并使 JS 函数对其可用。

# xml - 将 Kryonet 库从 jar 移植到 GWT 格式时出现问题

> ID：12573900
> 
> 赞同：2
> 
> 时间：2012-09-24T22:38:44.303
> 
> 标签：xml, gwt, transform, kryonet

我正在尝试将 Kryonet 移植到 GWT 格式。我正在构建 GWT.XML 但是当我启动我的 GWT 应用程序时，我报告了 2 个错误（我不知道在哪里）。

我把代码放在这里。你能帮我把这个很棒的库移植到 GWT 编译器吗？

kryonet.gwt.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE module PUBLIC "-//Google Inc.//DTD Google Web Toolkit trunk//EN" "http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd">
<module rename-to="com.esotericsoftware.kryonet">
    <source path="kryonet">
        <include name="Client.java"/>
        <include name="Connection.java"/>
        <include name="EndPoint.java"/>
        <include name="FrameworkMessage.java"/>
        <include name="JsonSerialization.java"/>
        <include name="KryoNetException.java"/>
        <include name="KryoSerialization.java"/>
        <include name="Listener.java"/>
        <include name="Serialization.java"/>
        <include name="Server.java"/>
        <include name="TcpConnection.java"/>
        <include name="UdpConnection.java"/>
        <include name="rmi/ObjectSpace.java"/>
        <include name="rmi/RemoteObject.java"/>
        <include name="rmi/TimeoutException.java"/>
        <include name="util/InputStreamSender.java"/>
        <include name="util/TcpIdleSender.java"/>
    </source>   
</module> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:45:27.773

我认为这只有在您手动重写大部分 kryonet 库时才有可能。它大量使用在 GWT 环境中不可用的 Java I/O（例如 InputStreams、Sockets...）。

GWT 中还有许多其他的 RPC 解决方案。例如，您可以使用本机 GWT RequestBuilder 和许多 REST 连接器。

# position - 无法使用 Html 服务为 DOM 元素设置固定位置

> ID：12573904
> 
> 赞同：0
> 
> 时间：2012-09-24T22:38:59.113
> 
> 标签：position, google-apps-script, fixed

我创建了一个脚本来使用 Html 服务发布以下 html 页面：

```
<html>
  <div id="fixeddiv"></div>
  <script>
    var div=document.getElementById("fixeddiv");
    div.style.position="fixed";
    alert(div.style.position);
  </script>
</html> 
```

警报窗口显示一个空字符串。不能为`div`元素设置固定位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T02:04:05.027

我刚遇到同样的事情，答案似乎是否定的。显然他们担心固定的 div 是安全漏洞。

接下来他们也会想要从我们的键盘上移除按键 ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-30T22:07:35.637

我为此找到了另一个“解决方案”：

我创建了 2 个 div，fixedHeader 和内容

```
<div id="fixedHeader"></div>
<div id="content"></div> 
```

css 代码，我们将#fixedHeader 设置为始终在顶部，对于#content，我们设置了一个与#fixedHeader 高度匹配的填充顶部，这样元素就不会位于#fixedHeader 之下：

```
#fixedHeader {position:absolute; top:0;}
#content {padding-top:50px; overflow:auto;} 
```

最后 javascript 在文档加载时使 #contet 与视口的高度匹配：

```
$(function(){ $("#content").css('height',window.innerHeight); } 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T07:31:38.650

我用它来获得顶部全局导航栏的“固定”效果。它可能对您或其他人有用。

```
$(document).ready(function() {
    $( window ).scroll(function() {
        $( '.fixed' ).css('top', $( this ).scrollTop());
    });
}); 
```

注意：在 GAS 中 $( window ).scroll() 对我不起作用，所以我创建了一个带有滚动条溢出的视口大小的 div 块并改用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T11:51:27.107

出于安全考虑，这似乎`position:fixed`是不允许的：[http ://code.google.com/p/google-apps-script-issues/issues/detail?id=1840](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1840)

# selenium - 计算有分数的元素个数

> ID：12573905
> 
> 赞同：0
> 
> 时间：2012-09-24T22:39:12.537
> 
> 标签：selenium, phpunit, selenium-ide

有没有办法计算不等于 0.00 的元素数量？

例如，代码是

```
<div id="average_2123" style="font-size:20px; ">0.00</div>
<div id="average_2124" style="font-size:20px; ">23.53</div>
<div id="average_2125" style="font-size:20px; ">0.00</div> 
```

我如何计算元素，所以它只有 1，因为其中只有一个有分数？

我想在 PHPUnit 上执行此操作。我也可以在 Selenium IDE 上执行此操作，因为我可以将其转换为 PHPUnit

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T08:36:36.997

更好的方法可以如下所述。我用Java编写代码：

```
List<WebElement> elemList = driver.findElements(By.cssSelector("div[id^='average']"));
List<WebElement> filteredElements = new ArrayList<WebElement>();
    for (WebElement element : elemList) {
        if (Long.parseLong(element.getText()) > 0.00)
            filteredElements.add(element);
    } 
```

这将找到所有“id”属性以“average”开头的元素。

同样在这里我将文本转换为长文本，然后比较它是否大于 0.00

过滤的元素是值大于 0.00 的元素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T00:52:23.173

您将不得不编写自定义代码。我正在编写java伪代码。希望你能理解并转化

```
List<WebElements> ElemList = Webdriver.FindElements(By.Xpath("//div")

for (i = 0; i < ElemList.size();i++)
{

          WebElement Current =List.getElementAt(i);
          String ElemName = current.getAttribute("id");
          String text =""
          int Count = 0;  
          if( id.Contains("average"))
          {

              if( !id.getAttribute("value").equals("0.00")
              {
                  count++;
              }

          } 

} 
```

# java - 如何测试计时器？

> ID：12573910
> 
> 赞同：11
> 
> 时间：2012-09-24T22:39:46.600
> 
> 标签：java, junit, timer

我想为一个方法编写一个测试，以特定的时间间隔调用观察者，以便他们执行一个方法。计时器对象在其自己的线程中运行。

**待测定时器方法**

```
private long waitTime;

public Metronome(int bpm) {
    this.bpm = bpm;
    this.waitTime = calculateWaitTime();
    this.running = false;
}

public void run() {
    long startTime = 0, estimatedTime = 0, threadSleepTime = 0;

    running = true;

    while (running) {
        startTime = System.nanoTime();

        tick();// notify observers here

        estimatedTime = System.nanoTime() - startTime;
        threadSleepTime = waitTime -estimatedTime;
        threadSleepTime = threadSleepTime < 0 ? 0 : threadSleepTime;

        try {
            Thread.sleep(threadSleepTime / 1000000l);

        } catch (InterruptedException e) {
                // sth went wrong
        }
    }
} 
```

**我的测试课的片段**

```
private int ticks;
private long startTime;
private long stopTime;

@Test
public void tickTest(){
    metronome.setBpm(600);
    startTime = System.nanoTime();
    metronome.run();
    long duration = stopTime - startTime;
    long lowThreshold  =  800000000;
    long highThreshold =  900000000;
    System.out.println(duration);
    assertTrue(lowThreshold < duration); 
    assertTrue(duration <= highThreshold);      
}

@Override
public void update(Observable o, Object arg) {
    ticks ++;       
    if(ticks == 10){
        metronome.stop();
        stopTime = System.nanoTime();
    }
} 
```

现在，我的测试类注册为相关对象的观察者，这样我就可以计算执行 tick() 的次数。测试测量执行前后的时间，但我感觉很尴尬，以这种方式测试行为。

有什么改进测试的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:03:18.023

有时解决方案是使用标准库中足够简单的东西，以至于不需要对其进行测试。我认为`SchedulerExecuterService`可以替换这里正在测试的自制计时器。请注意，很少会被库代码中的错误所困扰，但它们确实存在。

不过总的来说，我认为创建一个辅助类或使用一个模拟框架（Mockito）来做一些简单的事情，比如计算“滴答声”是可以的。

PS您可以替换`Thread.sleep(threadSleepTime / 1000000l)`为`TimeUnit.NANOSECONDS.sleep(threadSleepTime)`... ，它将一些逻辑从您的代码移动到标准库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T10:15:14.660

根据您的评论，我更改了代码。我现在没有在我的测试类中实现观察者接口，而是创建了一个私有类，它实现了在我的计时器上注册的接口。

感谢您的时间和想法。

下面是代码现在的样子：

**修改后的测试代码**

```
@Test(timeout = 2000)
public void tickTest(){     
    long lowThreshold  = 400000000;
    long highThreshold = 600000000;

    TickCounter counter = new TickCounter();
    metronome.addObserver(counter);
    metronome.setBpm(600);

    startTime = System.nanoTime();
    metronome.run();
    long duration = System.nanoTime() - startTime;

    assertTrue(lowThreshold <= duration);
    assertTrue(duration <= highThreshold);      
}

private class TickCounter implements Observer{
    private int ticks;

    public TickCounter(){
        ticks = 0;
    }

    @Override
    public void update(Observable o, Object arg) {
        ticks++;        
        if(ticks == 5){
            metronome.stop();
        }
    }       
} 
```

**我修改后的计时器的片段**

```
private long expectedTime; // calculated when bpm of timer is set

@Override
public void run() {
    long startTime = 0, elapsedTime = 0, threadSleepTime = 0;

    running = true;

    while (running) {
        startTime = System.nanoTime();

        tick();

        elapsedTime     = System.nanoTime() - startTime;

        threadSleepTime = expectedTime - elapsedTime;
        threadSleepTime = threadSleepTime < 0 ? 0 : threadSleepTime;

        try { TimeUnit.NANOSECONDS.sleep(threadSleepTime); } catch (Exception e) { }
    }
} 
```

我最大的问题可能是，我在我的 JUnit 测试用例中实现了观察者接口。所以我创建了一个私人观察者，专门计算滴答被执行的次数。然后计数器停止我的计时器。

测试方法测量时间并断言所需时间在我定义的限制之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T22:48:13.143

这取决于您需要多准确地测量时间。

如果您觉得它“尴尬”是因为您不确定测量是否足够准确？您是否担心操作系统会阻碍开销？

如果是这样，您可能需要一个与准确源（GPS、原子标准等）同步的外部计时板来测试您的代码，或者可能为您的触发事件提供触发器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-25T00:36:26.310

试试这个。你还需要你期待的时间。预期时间将是`1000000000/n`您的计时器每秒`n`需要的次数。`tick()`

```
public void run(){
    long time = System.nanotime();
    long elapsedTime = 0;
    // Hope you need to tick 30 times per second
    long expectedTime = 1000000000/30;
    long waitTime = 0;
    while (running){
        tick();
        elapsedTime = System.nanotime()-time;
        waitTime = expectedTime-elapsedTime();
        if (waitTime>0){
            try { Thread.sleep(waitTime) } catch (Exception e){}
        }
        time = System.nanotime();
    }
} 
```

# android - Android 检查对 wifi 热点的支持

> ID：12573911
> 
> 赞同：0
> 
> 时间：2012-09-24T22:40:01.650
> 
> 标签：android, wifi, tethering, personal-hotspot

有谁知道应用程序如何检查设备是否支持 wifi 移动热点/wifi 网络共享？例如，我的 Android 手机具有此功能，您可以绑定 3G 连接，而我较新的 android 平板电脑不支持它。更复杂的是，我实际上还有另一台平板电脑，只有wifi，没有3G，支持便携式热点模式。

请注意，我不是在问如何启用热点，只是设备是否支持它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-16T08:38:13.480

没有office api，但您可以查看我发布的一个

[https://github.com/mady4ever/android-testhotspot](https://github.com/mady4ever/android-testhotspot)

对于文档

[http://mady4ever.github.io/TestHotspotdoc](http://mady4ever.github.io/TestHotspotdoc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:40:54.687

谷歌的官方回答是没有用于检查的 API。

# c++ - 如何着手创建 Windows 应用程序

> ID：12573914
> 
> 赞同：0
> 
> 时间：2012-09-24T22:40:14.957
> 
> 标签：c++, windows, forms, user-interface, mfc

我一直在研究用于创建 GUI Windows 应用程序的许多不同选项。Win32、Windows 窗体、MFC 等等。我很了解我的 C++，我只需要一些关于我应该从哪里开始学习 Windows 的 GUI 的建议。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T22:42:59.907

Qt 有有用的[教程](http://doc.qt.digia.com/4.7/tutorials.html)。简单易学。开源。网上很多资源！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:52:03.620

MFC 现在是一项相当过时的技术。可供它使用的书籍/教程的种类也同样老化。QT 的应用越来越广泛，从学习的角度来看，它可能是一个更好的起点。

除了 C++，当然还有很多其他的选择。如果您对 Windows 上的开发特别感兴趣，C# 和 .NET 是不错的选择。C++ 程序员往往很快就能在 C# 中找到立足点，尽管任何新的语言/环境当然都有额外的学习曲线

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:44:46.260

我会研究[Qt](http://qt.digia.com/product/)、[OpenGL](http://www.opengl.org/)和[SDL](http://www.libsdl.org/)（简单直接媒体层）。

Qt 提供了一种构建 GUI 的简单方法，我会（粗略地）将它与 Java 的 Swing 进行比较。

OpenGL 和 SDL 更多的是关于纯图形，两者都用于各种游戏和应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T22:52:37.570

我在商业上使用 MFC，我不得不说对于严格的 GUI/Windows 应用程序，您可能想查看 C#（Winforms 和/或 WPF）。MFC 已经过时了。使用 C#，您可以在相同的时间内完成更多工作。当然它的运行速度可能会慢一点，但对于 UI 应用程序，我认为程序员时间比执行时间更重要。

如果你想在 UI 中使用 C++，也许可以看看 Qt。它不断更新/增强，并且不限于像 MFC 这样的单一平台。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-30T08:59:00.933

开发基于 Windows 的应用程序同样有帮助！他们有许多用于开发 Windows 应用程序的开源和 Ides。

其中之一是 Visual Studios，它是一个 IDE，即*Microsoft 开发的用于 Windows 和基于 Web 的应用程序开发的 IDE 即（**集成开发环境*） 。因为它具有个人应该精通他/她的任何编程语言的优势这个IDE集成了.net框架，可以在运行时借助*Microsoft中间语言*（*MSIL*）和*CLR公共语言*来管理代码和编译。类型检查由*Common type Specification*处理适用于所有编程语言。*JIT 编译器是一个编译器，用于执行半成品代码并将代码转换为字节*******.这些IDE处理的主要语言是C++,VC++,C#,Visual Basic,F#,J#..etc******

# python - 图像缓存选项

> ID：12573915
> 
> 赞同：0
> 
> 时间：2012-09-24T22:40:17.763
> 
> 标签：python, google-app-engine, caching, distributed-caching, image-caching

我正在用 jinja2 用 python 编写的谷歌应用引擎上运行一个网站。我已经使用 memcached 处理数据库中的大部分内容，但我不清楚如何提高从 blobstore 提供的图像的效率。我认为 GAE 与任何其他框架都没有太大不同，但我想提一下以防万一。

无论如何，有没有推荐的方法来缓存图像或防止它们耗尽我的读写配额？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T14:23:59.783

Blobstore 很好。

只需确保在 url 处理程序中设置 HTTP 缓存标头即可。这允许您的文件被浏览器缓存（在这种情况下您无需支付任何费用）或 App Engine 的边缘缓存，您将在其中支付带宽而不是 blobstore 访问。

不过要非常小心边缘缓存。如果您设置的过期时间过长，用户将永远不会看到更新的版本。通常，解决方案是在更改版本时更改 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T09:53:18.197

我的建议是使用[Google Cloud Storage](https://developers.google.com/appengine/docs/python/googlestorage)来存储您的图像。它更适合并推荐用于提供静态文件。好消息是，现在您可以为此使用相同的 Images api：

> 注意：您还可以提供存储在[Google Cloud Storage](https://developers.google.com/appengine/docs/python/googlestorage)中的图像。为此，您需要使用 Blobstore API [create_gs_key()](https://developers.google.com/appengine/docs/python/blobstore/functions#create_gs_key)函数生成 Blob 密钥。您还需要在正在使用的存储桶上设置默认对象[ACL](https://developers.google.com/storage/docs/accesscontrol#defaultobjects)`FULL_CONTROL` ，以授予您的应用程序权限，以便图像服务可以将自己的 ACL 添加到对象。有关 ACL 和权限的信息，请参阅 Google Cloud Storage 的文档。

PS。我喜欢这里的另一个很棒的功能是，如果您需要以不同尺寸提供图像，则不必存储图像的不同分辨率。您只需将参数添加到返回的 url 中即可`get_serving_url`。此外，您只需调用`get_serving_url`一次，将此 url 存储在某处，并在需要提供图像时使用它。另外，您可以重复使用相同的 url 来提供所有不同尺寸的相同图像。

> 网址修改：
> 
> =sXX 要调整图像大小，请将 =sXX 添加到图像 URL 的末尾，其中 XX 是从 0 到 1600 的整数，表示新图像大小（以像素为单位）。最大大小在 IMG_SERVING_SIZES_LIMIT 中定义。API 将图像大小调整为提供的值，将指定大小应用于图像的最长尺寸并保留原始纵横比。例如，如果您使用 =s32 调整 1200x1600 图像的大小，则生成的图像是 24x32。如果该图像为 1600x1200，则调整大小的图像将为 32x24 像素。
> 
> =sXX-c 要裁剪和调整图像大小，请将 =sXX-c 附加到图像 URL 的末尾，其中 XX 是从 0 到 1600 的整数，表示新图像大小（以像素为单位）。最大大小在 IMG_SERVING_SIZES_LIMIT 中定义。API 将图像大小调整为提供的值，将指定大小应用于图像的最长尺寸并保留原始纵横比。如果图像是纵向的，API 会从顶部和底部均匀地切出一个正方形。如果图像是横向的，API 会从左右均匀地切出一个正方形。裁剪后，API 将图像调整为指定大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T01:11:24.943

您可以使用谷歌图片 API [https://developers.google.com/appengine/docs/python/images/functions](https://developers.google.com/appengine/docs/python/images/functions)

我通常做的是在上传时，我存储由 images.get_serving_url(blob_key) 创建的 url。不确定它是否更便宜，但在我的开发服务器上，每次调用 get_serving_url 都会创建一个数据存储写入。

# php - 将自定义数据库页面迁移到 Wordpress

> ID：12573917
> 
> 赞同：0
> 
> 时间：2012-09-24T22:40:24.097
> 
> 标签：php, database, wordpress

我一直在玩弄使用 Wordpress 作为 CMS 来替换我多年来拼凑在一起的各种数据库驱动页面的想法。我想知道是否有一种基于 URL 从数据库中获取信息的无缝方式。

例如，我有提供奖励信息的页面

```
/academy-awards grabs the intro info from the database
/academy-awards/32 grabs the intro info about the 32nd edition
/academy-awards/32/winners grabs the results and commentary for that ceremony 
```

现在，academy-awards 实际上是一个无扩展名的 php 文件，并且根据它后面的内容（无、数字、数字和单词），它会提供各种页面。

我将/如何将这项工作翻译成 Wordpress？我是一个完整的 WP 菜鸟，所以我希望你的初步答案可以帮助我进一步挖掘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T22:56:38.357

除非已经有导入过滤器或插件，否则没有简单的方法将帖子/页面数据导入 Wordpress 帖子/页面，而无需制作和使用自定义数据库查询，该查询会将您想要的内容插入 WP 数据库架构中的正确位置。

也就是说，您可以将表格从 phpmyadmin 导出为 CSV 或纯文本，然后将该数据操作到一个文件中，该文件在导入时将生成 WordPress 帖子/页面。请参阅[http://codex.wordpress.org/Database_Description](http://codex.wordpress.org/Database_Description)

还可以考虑设置一个演示 WordPress 站点，输入一些帖子/页面，然后从仪表板导出>>工具>导出，然后查看如何构建 WordPress WXR 文件。这是安排数据以进行导入的好格式。请参阅[http://codex.wordpress.org/Tools_Export_Screen](http://codex.wordpress.org/Tools_Export_Screen)

如果您只想*显示*来自另一个数据库的数据，请使用`wpdb Class`. 见[https://codex.wordpress.org/Class_Reference/wpdb](https://codex.wordpress.org/Class_Reference/wpdb)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T00:08:03.470

在挖掘了更多之后，我似乎可以通过使用自定义查询（[http://codex.wordpress.org/Custom_Queries](http://codex.wordpress.org/Custom_Queries)）并将它们与页面模板组合来访问来自其他数据库的信息。

# security - 什么是用于安全创建临时目录的 POSIX 函数？

> ID：12573920
> 
> 赞同：4
> 
> 时间：2012-09-24T18:54:48.513
> 
> 标签：security, unix, directory, posix, mkdir

对于在 中创建临时目录的任务，对于可移植代码`/tmp`，如何在 、 等之间进行选择`mkdtemp`？`mkstemp`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-24T20:45:43.087

我认为您需要在其他用户可能具有写权限的目录中创建一个临时目录。

作为管理员，您应该进行设置，以便每个用户都有自己的`TMPDIR`（例如使用[pam-tmpdir — 或者使用](http://packages.ubuntu.com/libpam-tmpdir)[每个进程命名空间](http://glandium.org/blog/?p=217)更好，但这需要更多设置）。但是，作为应用程序编写者，您不能假设这一点，因此您需要处理一个全局可写的`/tmp`.

这里的正确函数是[`mkdtemp`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/mkdtemp.html), 因为[`mkstemp`](http://pubs.opengroup.org/onlinepubs/009695399/functions/mkstemp.html)只能创建常规文件。`mkdtemp`仅在 POSIX.1 2008 中引入，因此原则上它可能尚未在所有 POSIX 平台上可用。但是，它已经在各大平台上架了很长时间：

*   [从2.2](http://www.freebsd.org/cgi/man.cgi?query=mkdtemp&sektion=3&manpath=OpenBSD+2.2) (1997)开始在 OpenBSD 上
*   [自2.2.7](http://www.freebsd.org/cgi/man.cgi?query=mkdtemp&sektion=3&manpath=FreeBSD+2.2.7-RELEASE) (1998)以来在 FreeBSD 上
*   [从1.4](http://www.freebsd.org/cgi/man.cgi?query=mkdtemp&sektion=3&manpath=NetBSD+1.4) (1998)开始在 NetBSD 上
*   在[OSX](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/mkdtemp.3.html)上，因为... 10.0？
*   自 Glibc 2.2 (1999) 起在 Linux（使用 Glibc）上
*   至少从 2001 年开始在dietlibc
*   从一开始就在uClibc中，我认为
*   在[MINIX 3](http://www.minix3.org/manpages/html3/mkdtemp.html)
*   自[Solaris 10起仅在 Solaris 上](http://docs.oracle.com/cd/E19082-01/819-2243/6n4i0997q/index.html)

所以在实践中，你可以安全地使用`mkdtemp`. 如果您需要后备，请在您的源代码中包含 OpenBSD 实现。

# scala - 为什么 Akka Actor 收不到子频道？

> ID：12573922
> 
> 赞同：1
> 
> 时间：2012-09-24T22:40:45.753
> 
> 标签：scala, akka

我有一个 Akka `ActorEventBus`（参考[https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/event/EventBus.scala#L70](https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/event/EventBus.scala#L70)）可以处理很多正在传递的消息围绕不同的演员。

我已经设置了一个 Actor 来订阅这个总线：

```
/**
   * special actor that transports messages to the hive
   */
  val hiveTalk = {
    val subscriber = actorSystem.actorOf(Props(new HiveTransport))

    Bus.subscribe( subscriber, "/app/browser/" )
    Bus.subscribe( subscriber, "/app/mobile/" )
  } 
```

`MessageBus`作为实现的类`ActorEventBus`如下所示：

```
/**
 * message bus to route messages to their appropriate contexts
 */
class MessageBus extends ActorEventBus with LookupClassification {

    type Event = MessageEvent
  type Classifier = String

  protected def mapSize(): Int = {
    10
  }

  protected def classify(event: Event): Classifier = {
    event.channel
  }

  protected def publish(event: Event, subscriber: Subscriber): Unit = {
    subscriber ! event
  }

} 
```

## 问题

由于某种原因，发送到看起来像子频道的消息`/app/browser/26`没有被参与者`hiveTalk`订阅者接收。

任何想法为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T23:48:04.480

解决了。显然`Lookup Classification`实际上只是一个简单的单通道实现。

`Subchannel Classification`是用于实际实现子通道的 Akka 特征。

[http://doc.akka.io/docs/akka/2.0/scala/event-bus.html#Subchannel_Classification](http://doc.akka.io/docs/akka/2.0/scala/event-bus.html#Subchannel_Classification)

# javascript - 自动完成搜索后在 Google Analytics 中跟踪目标页面

> ID：12573926
> 
> 赞同：2
> 
> 时间：2012-09-24T22:41:04.533
> 
> 标签：javascript, jquery-ui, google-analytics, analytics

我们正在构建的站点的主要界面是一个 jQuery UI 自动完成搜索框。用户输入一些关键字，选择结果并被重定向`location.href`到他们选择的页面。

在重定向之前，所有搜索都被正确跟踪（`_gaq.push(['_trackPageview','/?s=' + current_term']`），但从未记录目标页面。所有目标页面都设置为`/`GA。

我已经看过但找不到在重定向之前明确设置目的地的方法。你有什么想法？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T00:05:10.083

这可能是因为

```
_gaq.push(...) 
```

是异步的。然后你通过`window.location`停止代码执行来调用重定向。

一个解决方案可能是在调用时附加一个回调函数`_gaq.push`：

```
_gaq.push(['_trackPageview','/?s=' + current_term], function() {
    // redirect user here...
    // window.location = ...
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T21:29:01.690

您是否在 GA 中配置了内部搜索？

您的搜索可能已被记录，但参数已从首页报告的 url 中删除。

在这种情况下，您应该能够在内部搜索关键字报告中看到数据。

如果是这种情况，并且如果您仍然希望参数显示在首页报告中，那么您需要取消选中配置文件配置上定义是否从 url 中删除搜索参数的复选框。

# asp.net-mvc - EF 5 + MVC 3 中未调用数据库初始化程序

> ID：12573927
> 
> 赞同：1
> 
> 时间：2012-09-24T22:41:18.563
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, entity-framework-migrations

我知道这个问题可能会重复，但我还没有找到任何解决我的问题的方法。

我有：

```
protected void Application_Start()
        {
            Database.SetInitializer(new DatabaseSeeder());
            DatabaseContext c = new DatabaseContext();
            c.Database.Initialize(true);

            AreaRegistration.RegisterAllAreas();

            RegisterGlobalFilters(GlobalFilters.Filters);
            RegisterRoutes(RouteTable.Routes);

        } 
```

我的数据库播种机是：

```
public class DatabaseSeeder : DropCreateDatabaseAlways<DatabaseContextBase>
    {
        protected override void Seed(DatabaseContextBase context)
        {
            base.Seed(context);

            var roles = new[] {"Admin", "User"};
            foreach (var role in roles)
            {
                context.Roles.Add(new UserRole {FullName = role});
            }

            context.SaveChanges();
        }
    } 
```

我的背景是：

```
public abstract class DatabaseContextBase : DbContext
    {
        public DbSet<UserRole> Roles { get; set; }
        public DbSet<UserAndPermissionInGroup> UserAndPermissions { get; set; }
        public DbSet<GeneralUser> Users { get; set; }
        public DbSet<Group> Groups { get; set; }
        public DbSet<Forum> Forums { get; set; } 

        public DatabaseContextBase() :base("ForumDb")
        {

        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);
            modelBuilder.Entity<Comment>()
                .HasRequired(e => e.Owner)
                .WithMany(t => t.Comments)
                .HasForeignKey(e => e.OwnerId)
                .WillCascadeOnDelete(false);
        }
    } 
```

最后：

```
public class DatabaseContext : DatabaseContextBase

{

} 
```

问题是，即使使用此初始化程序，我也会收到以下错误：

> 自创建数据库以来，支持“DatabaseContext”上下文的模型已更改。考虑使用 Code First 迁移来更新数据库

我首先在 ASP.NET MVC 3 项目中使用 EF 5 代码。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T17:19:51.660

看起来 Database.SetInitializer 不适用于派生类型。我将初始化程序从

```
public class DatabaseSeeder : DropCreateDatabaseAlways<DatabaseContextBase> 
```

到

```
public class DatabaseSeeder : DropCreateDatabaseAlways<DatabaseContext> 
```

现在是代码：

```
Database.SetInitializer(new DatabaseSeeder());
DatabaseContext c = new DatabaseContext();
c.Database.Initialize(true); 
```

效果很好。感谢所有的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:53:09.433

如果您擅长丢失数据，当您对模型进行更改时，请尝试以下操作。

```
DatabaseSeeder : DropCreateDatabaseIfModelChanges<DatabaseContextBase> 
```

代替

```
DatabaseSeeder : DropCreateDatabaseAlways<DatabaseContextBase> 
```

这样，当您对模型进行更改时，您的数据库将使用您的最新模型重新创建，并且将调用种子方法。

如果你想保留你的数据，你应该开始阅读迁移。

1.  [代码优先迁移](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)
2.  [自动迁移](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T22:55:49.033

像下面这样的东西？

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
        modelBuilder.Conventions
            .Remove<System.Data.Entity.Database.IncludeMetadataConvention>()
            .Entity<Comment>()
            .HasRequired(e => e.Owner)
            .WithMany(t => t.Comments)
            .HasForeignKey(e => e.OwnerId)
            .WillCascadeOnDelete(false);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T20:57:06.663

我不确定这是否可行，但你能做这样的事情吗？

```
DatabaseSeeder<TContextType> : DropCreateDatabaseAlways<TContextType> where TContextType : DatabaseContextBase 
```

# php - 内置 php linter 不报告错误

> ID：12573928
> 
> 赞同：1
> 
> 时间：2012-09-24T22:41:27.183
> 
> 标签：php, macos

我无法让 php -l（内置 linter）真正识别出它正在检查的文件有问题。我在 Mac OS X Lion 上，运行 php 5.3.8。我通过命令行 (php -i) 验证 display_errors 设置为 On 并且 error_reporting 设置为 E_ALL | E_STRICT。

这是我的测试文件，我已经尝试过其他结果相同的文件：

```
<?php
abcde
for {
?> 
```

通过 php -l 运行它会得到响应：

> 在 test.php 中未检测到语法错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:43:28.247

你确定你编辑了正确的 php.ini 吗？确认它`phpinfo()`

# sql-server - 将 ipad 上的 sqlite 与远程 sql server 同步

> ID：12573930
> 
> 赞同：0
> 
> 时间：2012-09-24T22:41:32.307
> 
> 标签：sql-server, ipad, sqlite, sync

我是 ipad 开发的新手。我必须为员工使用 ipad 的客户开发一个应用程序。我将开发这个应用程序，它将获取他们拥有的数据并将其存储到他们服务器上的主 sql 服务器。在研究中，我发现人们一旦将数据放在 ipad 上，然后将其与服务器同步，就会这样做。我以前用过sqlite for android。但这就像一个学校项目。基本上是 CRUD 操作。所以由于我对sqlite知之甚少，我想以这种方式追求这个应用程序。我的问题是我可以编写一个应用程序，一旦它们同步就会将临时 sqlite 数据与服务器同步？我还有更多问题.. 谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T07:15:06.443

当然可以在多个数据库之间同步数据。

一般来说，您必须记录自上次同步以来所做的所有更改（通常使用序列号或时间戳完成），并将这些更改应用到其他数据库。

如果多个用户修改了相同的数据，则必须以某种方式解决此冲突。

如果多个用户可以添加数据，则必须防止主键重复。

有关一些相关概念的解释，请参阅这些 Wikipedia 文章：
[数据同步](http://en.wikipedia.org/wiki/Data_synchronization)
[复制](http://en.wikipedia.org/wiki/Replication_%28computing%29)
[更改数据捕获](http://en.wikipedia.org/wiki/Change_data_capture)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T15:05:24.870

这家伙可能会解决问题，但它只支持 Xamarin（iOS 或 Android）。

[http://forums.xamarin.com/discussion/5719/sync-sqlite-with-sql-server-merge-replication](http://forums.xamarin.com/discussion/5719/sync-sqlite-with-sql-server-merge-replication)

# javascript - 为什么模型 ID 不保留在集合中？

> ID：12573931
> 
> 赞同：1
> 
> 时间：2012-09-24T22:41:34.163
> 
> 标签：javascript, backbone.js

我将 ID 设置为我的模型，如下所示：

```
var globalCounter = 0;
var MyModel = Backbone.Model.extend({
    initialize: function () {
        this.set('id', globalCounter);
        globalCounter += 1;
    }
}); 
```

现在我将一堆实例添加`MyModel`到集合中：

```
var i, model;
MyCollection = Backbone.Collection.extend({});
myCollection = new MyCollection();

for(i = 0; i < 3; i += 1) {
    model = new MyModel();
    myCollection.add(model);
} 
```

问题是 ID 似乎没有被传递：

```
console.log(myCollection.pluck('id')); // gives [undefined, undefined, undefined] 
```

为什么我添加到收藏中的模型的 ID 会消失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T14:56:53.177

您在定义 MyModel 的地方定义 globalCounter，但可能在哪里创建 MyModel globalCounter 的实例不在您的脚本范围内。

这就像在前端实现的“自动增量”，你可以这样做，我写给你以防止范围问题（自动增量键将像某种静态变量一样成为“模型定义”的一部分）：

```
var MyModel = Backbone.Model.extend({
    globalCounter : 0,
    initialize: function () {
        this.set('id', MyModel.prototype.globalCounter++);
    }
}); 
```

# mysql - store const "YYYYMMDD" 格式应该使用哪个时间 mysql 类型？

> ID：12573933
> 
> 赞同：0
> 
> 时间：2012-09-24T22:41:46.867
> 
> 标签：mysql

案子：

需要以“YYYYMMDD”格式存储未更改的日期常量格式吗？

在文本文件中获取 const 数据，例如：20120201 20110101 等...应该放在表字段中

（我想像日期一样存储它以进行快速查询）

我认为mysql直接支持“日期”类型

桌子：

```
id|   mydate   |
-------------------
1 |  20120201  |
2 |  20110101  | 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:09:50.363

Store it as a MySQL date type. When you need to query the info without dashes, use the MySQL replace function like:

```
REPLACE(date_column,'-','') as 'const_date' 
```

to convert const_date into mysql date format upon insert/update, use MySQL CONCAT with SUBSTR like:

```
CONCAT(
      SUBSTR(const_date, 1, 4)
    , ','    
    , SUBSTR(const_date, 5, 2)
    , ','
    , SUBSTR(const_date, 7, 2)
) as 'mysql_date' 
```

(Unlike PHP, MySQL does not use zero index for first char position)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T22:48:41.690

要转换成可以存储在 DATE 类型字段中的 MySQL 日期：

```
$original = 20120924;
$mysql_format = substr($original, 0, 4) . '-' . substr($original), 4, 2) . '-' . substr($original, 6, 2); 
```

希望有帮助。

（或者，您可以将其存储为时间戳格式的 INT 以获得快速结果，只需使用 strtotime() 将 $mysql_format 转换为时间戳；）

# java - Arrays.fill() 方法导致异常

> ID：12573938
> 
> 赞同：7
> 
> 时间：2012-09-24T22:42:28.300
> 
> 标签：java

现在我无法用空格填充数组。每当我使用数组填充方法时，我都会遇到异常。现在我排除了其余的代码，只包括了导致问题的代码。这里是。注意我是java的初学者，所以如果这个问题太简单了，不要生气。我在这里搜索过，找不到任何东西。

```
public class board 
{       
    public static void main(String args[])
    {
        char board [][] = new char  [6][7]; 
        int column=0; 
        int row=0;

        java.util.Arrays.fill(board,' ');
    }
} 
```

例外说

> java.util.Arrays.fill(Arrays.java:2685) 上的 java.util.Arrays.fill(Arrays.java:2710)处的线程“main”中的异常 java.lang.ArrayStoreException:
> java.lang.Character 。主要（board.java:26）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-24T22:44:42.503

`Arrays.fill`需要一个一维数组，你传入一个锯齿状数组。

相反，请执行以下操作：

```
for(int x=0;x<board.length;x++)
    for(int y=0;y<board[x].length;y++)
        board[x][y] = ' '; 
```

或这个：

```
for(int x=0;x<board.length;x++)
    Arrays.fill( board[x], ' ' ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T22:46:51.473

**FROM JAVA API ArrayStoreException：** 抛出该异常以指示已尝试将错误类型的对象存储到数组中。

```
Arrays.fill(); 
```

方法将单维数组作为参数，您传递的是二维数组，因此异常

# iphone - 允许独立于父视图的 QLPreviewController 旋转

> ID：12573940
> 
> 赞同：3
> 
> 时间：2012-09-24T22:42:44.883
> 
> 标签：iphone, ios, rotation, qlpreviewcontroller

我的应用不支持旋转。但我想介绍一个`QLPreviewController`支持旋转的。我提出`QLPreviewController`这样的：

```
[self presentModalViewController:thePrevController animated:NO]; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:23:09.730

在您的应用程序 plist 文件中启用所有旋转。这将使所有视图旋转，而与视图控制器中的设置无关。

然后将您的根 UINavigationController 子类化如下，根据您的要求添加 iOS5 和 6 的旋转控制代码：

我正在使用 MainWindow.xib 更新旧应用程序，因此我将 xib 文件中的导航控制器类更改为 CustomNavigationController。但是在一个更现代的应用程序中，比如一个主菜单，你会像这样实例化导航控制器：

```
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
// Override point for customization after application launch.

MainMenuVC *masterViewController = [[MainMenuVC alloc] initWithNibName:@"MainMenuVC" bundle:nil];
self.navigationController = [[CustomNavigationController alloc] initWithRootViewController:masterViewController];
self.window.rootViewController = self.navigationController;
[self.window makeKeyAndVisible]; 
```

子类 UINavigationController

```
#import <UIKit/UIKit.h>

@interface CustomNavigationController : UINavigationController

@end

#import "CustomNavigationController.h"

@interface CustomNavigationController ()

@end

@implementation CustomNavigationController

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

-(BOOL)shouldAutorotate
{
    return NO;
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
}

@end 
```

然后子类化 QLPreview 控制器，以便您可以覆盖旋转代码，这将只为 QLPreviewController 启用旋转。当 CustomNavigationController 被锁定时，从您的 CustomNavContoller 推送视图的应用程序的其余部分将不会旋转。

我在想要展示 QLPreviewController 的视图控制器顶部添加了这个接口和实现。

```
@interface RotatingQLPreviewController : QLPreviewController

@end

@implementation RotatingQLPreviewController

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAllButUpsideDown;
}

-(BOOL)shouldAutorotate
{
    return YES;
}

@end 
```

然后使用您的子类展示您的 QLPreviewController。

```
RotatingQLPreviewController *preview = [[RotatingQLPreviewController alloc] init];
        preview.dataSource = self;
        [self presentViewController:preview
                           animated:YES
                         completion:^(){
                             // do more stuff here
                         }]; 
```

此方法应该适用于您要旋转的其他模态视图，但我没有尝试过。

我在我正在开发的最新应用程序中实现了这个方法，并且在 iOS5 和 6 中都可以使用。

希望能帮助到你。

# javascript - jQuery 解构 | 这是指什么？

> ID：12573946
> 
> 赞同：2
> 
> 时间：2012-09-24T22:43:25.380
> 
> 标签：javascript, jquery

这在下面来自[jQuery latest的 init 函数中指的是什么](http://code.jquery.com/jquery-latest.js)

当从对象调用方法时，通常指的是持有该方法的对象。

但是在这种情况下，该方法是使用 new 关键字调用的。

这会改变 this 指向的内容还是仍然指向持有该方法的对象，在这种情况下，这将是 -`jQuery.fn.init()`

**jQuery解构**

**jQuery 是这样全球化的：（第 9422 行）**

```
window.jQuery = window.$ = jQuery; 
```

**jQuery 在这里定义：（第 42 行）**

```
jQuery = function( selector, context ) {
    // The jQuery object is actually just the init constructor 'enhanced'
    return new jQuery.fn.init( selector, context, rootjQuery );
}, 
```

**jQuery.fn.init 在这里定义：（第 95 行）**

```
jQuery.fn = jQuery.prototype = {
    constructor: jQuery,
    init: function( selector, context, rootjQuery ) {
        var match, elem, ret, doc;

        // Handle $(""), $(null), $(undefined), $(false)
        if ( !selector ) {
            return this;
        }

        // Handle $(DOMElement)
        if ( selector.nodeType ) {
            this.context = this[0] = selector;
            this.length = 1;
            return this;
        }

        // Handle HTML strings
        if ( typeof selector === "string" ) {
            if ( selector.charAt(0) === "<" && selector.charAt( selector.length - 1 ) === ">" && selector.length >= 3 ) {
                // Assume that strings that start and end with <> are HTML and skip the regex check
                match = [ null, selector, null ];

            } else {
                match = rquickExpr.exec( selector );
            }

            // Match html or make sure no context is specified for #id
            if ( match && (match[1] || !context) ) {

                // HANDLE: $(html) -> $(array)
                if ( match[1] ) {
                    context = context instanceof jQuery ? context[0] : context;
                    doc = ( context && context.nodeType ? context.ownerDocument || context : document );

                    // scripts is true for back-compat
                    selector = jQuery.parseHTML( match[1], doc, true );
                    if ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {
                        this.attr.call( selector, context, true );
                    }

                    return jQuery.merge( this, selector );

                // HANDLE: $(#id)
                } else {
                    elem = document.getElementById( match[2] );

                    // Check parentNode to catch when Blackberry 4.6 returns
                    // nodes that are no longer in the document #6963
                    if ( elem && elem.parentNode ) {
                        // Handle the case where IE and Opera return items
                        // by name instead of ID
                        if ( elem.id !== match[2] ) {
                            return rootjQuery.find( selector );
                        }

                        // Otherwise, we inject the element directly into the jQuery object
                        this.length = 1;
                        this[0] = elem;
                    }

                    this.context = document;
                    this.selector = selector;
                    return this;
                }

            // HANDLE: $(expr, $(...))
            } else if ( !context || context.jquery ) {
                return ( context || rootjQuery ).find( selector );

            // HANDLE: $(expr, context)
            // (which is just equivalent to: $(context).find(expr)
            } else {
                return this.constructor( context ).find( selector );
            }

        // HANDLE: $(function)
        // Shortcut for document ready
        } else if ( jQuery.isFunction( selector ) ) {
            return rootjQuery.ready( selector );
        }

        if ( selector.selector !== undefined ) {
            this.selector = selector.selector;
            this.context = selector.context;
        }

        return jQuery.makeArray( selector, this );
    }, 
```

**makeArray 在这里定义：（第 637 行）** // 不用于 id 的基本选择

```
makeArray: function( arr, results ) {
    var type,
        ret = results || [];

    if ( arr != null ) {
        // The window, strings (and functions) also have 'length'
        // Tweaked logic slightly to handle Blackberry 4.7 RegExp issues #6930
        type = jQuery.type( arr );

        if ( arr.length == null || type === "string" || type === "function" || type === "regexp" || jQuery.isWindow( arr ) ) {
            core_push.call( ret, arr );
        } else {
            jQuery.merge( ret, arr );
        }
    }

    return ret;
}, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T22:46:31.177

当使用 调用函数时`new`，`this`总是引用新创建的对象实例。在这种情况下，函数恰好是表达式中的对象属性值并不重要`.`。

# android - 如何在 PdfPCell 中居中对齐模板元素

> ID：12573962
> 
> 赞同：6
> 
> 时间：2012-09-24T22:45:00.233
> 
> 标签：android, itext

我正在构建一个垂直的月份列表，其中包含每个月的水平天数列表。每天我都在添加一个大小和颜色的矩形；大小和颜色取决于数据库查询中的值。

我正在使用`PdfPTable`，`PdfPCell`并`cbCreateTemplate`在[此答案中提供](https://stackoverflow.com/questions/4429038/is-there-a-way-to-draw-a-rectangle-into-a-pdfpcell-in-itext-the-java-version)

除了矩形的位置之外，其他一切都很好（矩形的大小，矩形的颜色）：它总是定位在 0,0 即使我（认为）我已经设置了 V & H 定位。代码摘录如下；请指教。

```
int Severity = args.getPLR().get(i).getItems().get(j).getItems().get(itemIndex).getSeverity();
Severity = Severity + 5; //plump up, so that max (10) should fill the cell
PdfPCell cell = new PdfPCell();
cell.setPadding(0);
template = cb.createTemplate(Severity, Severity);
template.setLineWidth(0.5f);
template.rectangle(0, 0, Severity, Severity);
//we should switch the color
//based on the Severity
switch ((Severity-5)) {
    case 0:
        template.setColorFill(Color.GREEN);
        break;
    case 1:
        template.setColorFill(Color.GREEN);
        break;
    case 2:
        template.setColorFill(Color.YELLOW);
        break;
    case 3:
        template.setColorFill(Color.YELLOW);
        break;
    case 4:
        template.setColorFill(Color.YELLOW);
        break;
    case 5:
        template.setColorFill(Color.ORANGE);
        break;
    case 6:
        template.setColorFill(Color.ORANGE);
        break;
    case 7:
        template.setColorFill(Color.ORANGE);
        break;
    case 8:
        template.setColorFill(Color.RED);
        break;
    case 9:
        template.setColorFill(Color.RED);
        break;
    case 10:
        template.setColorFill(Color.RED);
        break;
}
template.fill();
img = Image.getInstance(template);        
chunk = new Chunk(img, 0f, 0f);
cell.addElement(chunk);
cell.setHorizontalAlignment(Element.ALIGN_CENTER);
cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
painTable.addCell(cell); 
```

这是显示的图形： ![应该对齐中心/中心](../Images/12187599487b47cd4d85d6c498119cf7.png)

它应该是中心/中心。我哪里出错了？

这是使用公认解决方案的更新代码部分：

```
img = Image.getInstance(template);        
chunk = new Chunk(img, 0f, 0f);
Phrase severityChunk = new Phrase(chunk);
PdfPCell cell = new PdfPCell(severityChunk);
cell.setPadding(0);
cell.setHorizontalAlignment(Element.ALIGN_CENTER);
cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
painTable.addCell(cell); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-25T09:56:27.580

你正在混合`text mode`和`composite mode`。

对齐属性设置的水平`PdfPCell`仅在文本模式下起作用。一旦您切换到复合模式（您通过使用该`addElement()`方法执行此操作），iText 就会忽略为单元格定义的对齐方式，而支持为单元格内容定义的对齐方式。

在文本模式下，所有内容都具有相同的对齐方式。在复合模式下，您可以拥有具有不同对齐方式的不同元素。

您有不同的选择：您可以将`Chunk`a放入`Paragraph`并定义段落而不是单元格的对齐方式。`Phrase`您可以使用包含块的文本模式创建单元格。甚至可以在`Image`不使用 Chunk 等的情况下创建一个带有 an 的单元格……

这在我写的“iText in Action”一书中都有解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-07T21:58:28.303

cell1.setHorizo​​ntalAlignment(PdfPCell.ALIGN_CENTER) 将单元格的文本居中对齐。你可以看一个例子。

```
PdfPTable tablaTotal = new PdfPTable(2);
PdfPCell cell1 = new PdfPCell(new Phrase("TOTAL"));     
cell1.setHorizontalAlignment(PdfPCell.ALIGN_CENTER);
cell1.setPadding(5);
tablaTotal.addCell(cell1);
PdfPCell cell2 = new PdfPCell(new Phrase(contrato.getPrecioInmueble() + " €&quot;));
cell2.setHorizontalAlignment(PdfPCell.ALIGN_CENTER);
cell2.setPadding(5);
tablaTotal.addCell(cell2); 
```

我们创建包含两列的 tablaTotal，cell1 与文本 Total，我们对齐 cell1 的文本并向 cell1 添加和填充。我们对 cell2 执行相同的操作，并将这两个单元格添加到 tablaTotal。

# c++ - 如何将 GCC 的 printf 格式属性与 C++11 可变参数模板一起使用？

> ID：12573968
> 
> 赞同：20
> 
> 时间：2012-09-24T22:45:39.507
> 
> 标签：c++, gcc, c++11, variadic-templates, function-attributes

我有一个 C++ 类，它是日志系统的前端。它的日志功能是使用 C++11 的可变参数模板实现的：

```
template <typename... Args>
void Frontend::log(const char *fmt, Args&&... args) {
  backend->true_log(fmt, std::forward<Args>(args)...);
} 
```

每个日志记录后端都实现了自己的版本`true_log`，除其他外，它使用转发的参数来调用`vsnprintf`。例如：

```
void Backend::true_log(const char *fmt, ...) {
  // other stuff..
  va_list ap;
  va_start(ap, fmt);
  vsnprintf(buffer, buffer_length, fmt, ap);
  va_end(ap);
  // other stuff..
} 
```

一切都很好，我很高兴。

现在，我想对`log()`参数添加一个静态检查：具体来说，我想使用 GCC 的 printf 格式属性。

我首先使用标记`log()`函数`__attribute__ ((format (printf, 2, 3)))`（与`this`第一个“隐藏”参数一样，我需要将参数索引移动一个）。这不起作用，因为如果失败并出现编译错误：

```
error: args to be formatted is not ‘...’ 
```

然后，我尝试将相同的属性添加到`true_log()`函数中。它编译，但实际上没有执行错误检查：我试图传递给`log()`一些无效的格式/变量组合，并且没有发出警告。也许这种检查“为时已晚”，或者换句话说，关于变量的信息已经在调用链中丢失了？

作为最后的手段，如果我`log()`用注释`__attribute__ ((format (printf, 2, 0)))`，我会收到有关错误格式字符串的警告，但不会针对无效的格式/变量组合发出诊断。

总结问题：**如果我使用 C++11 的可变参数模板，如何从 GCC 进行完整的格式检查？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:22:26.157

我不相信你可以。我敢打赌，GCC 只验证格式字符串是否是*文字*。这就是为什么放置`format`属性`true_log`不起作用的原因 - 该函数被调用时看起来（在语法上）类似于运行时确定的字符串。直接戴上它`log`会规避这一点，但需要`format`属性来支持可变参数模板，而您证明它不支持。

我建议你看看更多的 C++ 方式来进行格式化输出。例如，`boost::format`它的工作方式类似于 printf，但会动态验证参数类型的数量和类型是否与格式字符串匹配。但是，它不使用可变参数模板，而是一个接一个地使用（通过运算符 %）提供给它的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-01T22:10:41.000

作为记录，我最终完全删除了 C++11 可变参数模板，并使用了传统的`va_list`.

```
__attribute__((format(printf, 2, 3)))
void Frontend::log(const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  backend->true_log(fmt, ap);
  va_end(ap);
}

void Backend::true_log(const char *fmt, va_list ap) {
  // log the message somehow
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-03T20:54:58.683

如果您愿意使用宏，则有一种解决方法。

有些结构会导致编译器为您进行检查，但不会生成任何被调用的代码。一种这样的构造是`sizeof`。因此，您可以为您的记录器使用宏来`printf`直接将参数传递给但在`sizeof`计算的上下文中，然后调用记录器本身。

使用宏的原因是确保格式字符串的处理方式与处理字符串文字的方式相同。

在下图中，我将`sizeof`计算视为一次性参数，但应该有其他方法可以应用相同的技术。

```
template <typename... Ts>
void Frontend::log(size_t, const char *fmt, Ts&&... args) {
  backend->true_log(fmt, std::forward<Ts>(args)...);
}

#define log(...) log(sizeof(printf(__VA_ARGS__)), __VA_ARGS__) 
```

[在线尝试！](https://tio.run/##dVFNT4MwGL7zK95scaGGkXiFhWQe9K6LXkyaWlrWDNradjNz2V8XS0FQ4zgA78fz0adU62VFaTsXktb7ksGqYY0yxyKaOtaVQqXbPy1iKt9rrTN76uCW0B2TJZwi8M9BiRL8gOFaVTFV0jqgW2LgOoE0TVEenfMoGqB3Rkk3YR1rdE2cF3FHzSRpmEfAxhYTc0dqxQfDLoHf5Bu7WPQC3bJ3mWV7Kd68Ee3MajBZwGv/02@N@jGC7HsUB2xDdgz3BCM4RghO53CAy1aDzW/iLLtkmDdu9Aw@UItCCIOHZTFGGBaDJa7MOzHlyqvEATHkGUXzknEhWUina44xKR5rI6TjMcZPa7x@uH/EGKEEfpZR73k4ZZb9e3vBRuDubB4IroWfEZ33lXXEuJjoBPxiuIPDIByARKNhsQs4VOfWj6EhQnbpn6a74DnwtJOfXdkXOUvgBuVwbj8pr0ll2@UzM0YZ/yV17d9f "C++ (gcc) – 在线试用")

当然，这是一种解决方法。不使用宏的原因有很多。在这种情况下，`log`宏会干扰任何其他同名的函数或方法。

# ruby-on-rails - 具有嵌套创建的 Rails 种子

> ID：12573970
> 
> 赞同：3
> 
> 时间：2012-09-24T22:45:48.627
> 
> 标签：ruby-on-rails, ruby-on-rails-3, seed

我为我正在使用的应用程序创建了一堆模型，我想使用 seed.rb 文件为它们播种。问题是，我将一个模型的创建嵌套在另一个模型中（不知道怎么说），这样当创建“动物”时，它应该自动创建一组“包”。

为了说明，这是在我的 animal.rb 文件中（细节不重要——它只是根据输入的动物数据构建一组包）：

```
after_create :create_packages

  def create_packages
    @cut_list = Cut.where(:animal_type => self.animal_type)
    @cut_list.each do |c|
        Package.create!(:animal_id => self.id, :cut_id => c.id, 
            :original => (self.weight * (c.percent)/100) / c.package_weight, 
            :left => (self.weight * (c.percent)/100) / c.package_weight)
    end
  end 
```

换句话说，属于动物的包是在创建动物时自动创建的——如果动物是在我的应用程序上创建的。但是，使用种子，只需这样做：

```
Animal.create(
        :name => 'Donald Trump',
        :animal_type => "Pig",
        :breed => "Hungarian",
        :weight => 800,
        :farm => "The Piggie Farm",
        :photo => "NA"
    ) 
```

没有构建相关的包，并且由于我已经在我的动物展示页面中构建了包的显示，如果我重置数据库并运行动物/#页面，我会收到一个错误，提示它们的属性不存在包被显示。

有什么方法可以让种子数据自动生成其关联数据（也就是说，从字面上调用我的 create 方法并遵循 after_create 命令），这样我就不必为所有应该是的包制造种子数据自动生成？

谢谢。

# ruby-on-rails - 使用 Rails 通过代理发送 SMTP GMail

> ID：12573973
> 
> 赞同：2
> 
> 时间：2012-09-24T22:45:59.190
> 
> 标签：ruby-on-rails, ruby-on-rails-3, proxy, actionmailer

我正在运行一个 nginx 网络服务器，unicorn_rails 目前在生产中运行良好，但是当我尝试通过代理使用我的 gmail 帐户时，Actionmailer 无法发送。

我的 gmail 设置如下链接所示：http: [//guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration-for-gmail](http://guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration-for-gmail)

SSH、webmin、https 和我打开的所有其他东西都可以正常工作，只是在 actionmailer 中没有 smtp。接口可能有些奇怪，因为 ping 默认使用 lo 并且尝试 telnet smtp.gmail.com 587 什么也没做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T23:24:23.837

我通过更改*/etc/network/interfaces*中读取的行`auto lo`来修复它，`auto eth0`然后使用`ifconfig lo down`and`shutdown -r now`和`ifconfig lo up`. 由于某种原因，这使得`ping 8.8.8.8`无需设置接口即可实际工作并`telnet smtp.gmail.com 587`返回正确的代码。

仍然不确定我的网络接口如何默认为 lo，但邮件服务器现在正在工作。它最终与我的代理无关，我正确地认为它设置正确。

# ios - Timer vs ASIHTTPRequest - 找到最佳解决方案

> ID：12573980
> 
> 赞同：0
> 
> 时间：2012-09-24T22:46:35.560
> 
> 标签：ios, asihttprequest, nstimer

代码如下所示，我有一个按钮，一旦你点击它，每 4 秒激活一次定时器和定时器调用方法。但是，有时 4 秒不足以让服务器返回数据。但是，如果服务器在 1 秒内返回数据并且不利于用户等待更长时间，则增加计时器值也不是很好的解决方案。在这种情况下，我不知道什么是最佳/最佳解决方案。

```
-(IBAction)play:(id)sender{
    timer=[NSTimer scheculedWith TimerInterval(4.0) target:(self)selector:@selector(httpRequest) userinfo:nil repeats:YES]
    }
    -(void)httpRequest{

    _weak ASIHTTPRequest *request1 = [ASIHTTPRequest requestWithURL:url1];
    [request1 setCompletionBlock:^{
        NSString *responseString1 = [request1 responseString];
    //dispatch_async(backgroundProcess1,^(void){
        [self plotOverlay1:responseString1];
     //});
    }];
    [request1 setFailedBlock:^{
        NSError *error=[request1 error];
        NSLog(@"Error: %@", error.localizedDescription);
    }]; 

    [request1 startAsynchronous];
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:02:16.537

如果您只是希望数据不断更新，请考虑`-httpRequest`从第一个请求的完成块内再次调用（并删除计时器）。这样，您可以确保请求将再次执行，但仅*在*第一个请求完成后 - 您可以在那里引入延迟，因此您会得到类似“第一次检查完成后两秒再检查一次”的信息。

这可能看起来像：

```
- (void)httpRequest {
    __weak ASIHTTPRequest *req = [ASIHTTPRequest requestWithURL:url1];
    [req setCompletionBlock:^{
        NSString *resp = [req responseString];
        [self plotOverlay1:resp];

        [self httpRequest];
        // or...
        [self performSelector:@selector(httpRequest) withObject:nil afterDelay:2.0];
    }];
    /* snip fail block */
    [req startAsynchronous];
} 
```

# jquery - jQuery-ui 进度条使用每个显示所有值

> ID：12573985
> 
> 赞同：1
> 
> 时间：2012-09-24T22:47:12.387
> 
> 标签：jquery, jquery-ui

所以基本上我使用的是 jQuery ui prgoressbar，我想打印所有的值。这是代码：

```
 $(function() {

        var a = $('.progressbar.item1').progressbar({value: 37});
        var b = $('.progressbar.item2').progressbar({value: 55});
        var c = $('.progressbar.item3').progressbar({value: 99});
        ...
        var x = $('.progressbar.itemx').progressbar({value: 29});

        $(a).find('.ui-progressbar-value').append('<span>' + a.progressbar('option','value') + '%</span>');
        $(b).find('.ui-progressbar-value').append('<span>' + b.progressbar('option','value') + '%</span>');
        $(c).find('.ui-progressbar-value').append('<span>' + c.progressbar('option','value') + '%</span>');
        ...
        $(x).find('.ui-progressbar-value').append('<span>' + x.progressbar('option','value') + '%</span>');

    }); 
```

我怎样才能使它更短，比如使用“每个”的“for”？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:55:51.487

尝试构建一个填充有进度条的对象：

```
$(function() {

    var classes_values = {
        '.item1' : 37,
        '.item2' : 55,
        '.item3' : 99,
        '.itemx' : 29
    };

    var progress_bars = {};

    $.each(classes_values, function(class, value){          
        progress_bars[class] = 
            $('.progressbar'+class).progressbar({'value' : value});                     
    });

    $.each(progress_bars, function(class, progress_bar){                        
        $('.ui-progressbar-value', progress_bar).append(
            '<span>' + progress_bar.progressbar('option','value') + '%</span>');        
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T23:03:35.847

这个怎么样？

```
$(document).ready(function(){
// create some progressbars,random values
$(".progressbar").each(function(){
$(this).progressbar({value: Math.floor(Math.random()*5)});
});
//extract the values:
var vals="";
$(".progressbar").each(function(){
vals += $(this).progressbar( "option", "value" );
});
$("#vals").text(vals); 
```

});

# xml - UPS ShipConfirm 请求标签打印

> ID：12573990
> 
> 赞同：1
> 
> 时间：2012-09-24T22:48:04.547
> 
> 标签：xml, ups

谁能告诉我我需要在 UPS xml 请求文档的 LabelSpecification 部分中指定什么才能打印 EPL 运输标签？以下是我所拥有的：

```
 <LabelSpecification>
    <LabelPrintMethod>
      <Code>EPL</Code>
    </LabelPrintMethod>
    <HTTPUserAgent>Mozilla/5.0</HTTPUserAgent>
    <LabelImageFormat>
      <Code>GIF</Code>
    </LabelImageFormat>
  </LabelSpecification> 
```

但我在响应中不断收到以下错误：

```
Missing/Invalid Combination of LabelSpecification/LabelStockSize 
```

我也尝试过使用“EPL2”但无济于事。而且我不知道在哪里指定 LabelStockSize。UPS 网站在这方面不是很有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T03:29:38.743

[雅虎](http://search.yahoo.com/search;_ylt=A0oG7tlYI2FQODEAk2xXNyoA?p=UPS%20xml%20request%20document%20epl%20shipping%20label%20LabelSpecification&fr2=sb-top&fr=moz35)，我发现了这样的[例子](http://www.experts-exchange.com/Web_Development/Web_Languages-Standards/ASP/Q_20950969.html)：

```
<LabelSpecification>
  <LabelPrintMethod>
    <Code>EPL</Code>
  </LabelPrintMethod>
  <LabelStockSize>
    <Height>4</Height>
    <Width>6</Width>
  </LabelStockSize>
</LabelSpecification> 
```

[这](https://stackoverflow.com/questions/11535698/ups-epl-label-show-on-web-page)：_

```
<LabelSpecification>
  <LabelStockSize>
    <Height>4</Height>
    <Width>6</Width>
  </LabelStockSize>
  <LabelPrintMethod>
    <Code>EPL</Code>
    <Description>epl file</Description>
  </LabelPrintMethod>... 
```

换句话说，它看起来`<LabelStockSize>`需要是 的孩子`<LabelSpecification>`，但可以在 之前或之后`<LabelPrintMethod>`。

# python - CreateView 中的多个表单和表单集

> ID：12573992
> 
> 赞同：19
> 
> 时间：2012-09-24T22:48:11.357
> 
> 标签：python, django, django-forms, django-class-based-views

我有 2 个模型，`Father`并且`Son`.

我有一个页面要注册`Father`。在同一页面上，我有一个要注册的表单集`Son`。

在页面上有一个“更多”按钮可以在同一页面上添加另一个`Father`和它们各自的。`Son`

有没有人有任何使用的例子`CreateView`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-25T06:05:32.303

基于类的视图仍然是新的，所以我会写出来。过程很简单：

首先，为您的对象创建表单。将重复其中一种形式。在这里没有什么特别可做的。

```
class SonInline(ModelForm):
    model = Son

class FatherForm(ModelForm):
    model = Father 
```

然后，创建您的[`formset`](https://docs.djangoproject.com/en/1.4/topics/forms/formsets/)：

```
FatherInlineFormSet = inlineformset_factory(Father,
    Son,
    form=SonInline,
    extra=1,
    can_delete=False,
    can_order=False
) 
```

现在，将其与您的`CreateView`：

```
class CreateFatherView(CreateView):
    template_name = 'father_create.html'
    model = Father
    form_class = FatherForm # the parent object's form

    # On successful form submission
    def get_success_url(self):
        return reverse('father-created')

    # Validate forms
    def form_valid(self, form):
        ctx = self.get_context_data()
        inlines = ctx['inlines']
        if inlines.is_valid() and form.is_valid():
            self.object = form.save() # saves Father and Children
            return redirect(self.get_success_url())
        else:
            return self.render_to_response(self.get_context_data(form=form))

    def form_invalid(self, form):
        return self.render_to_response(self.get_context_data(form=form))

    # We populate the context with the forms. Here I'm sending
    # the inline forms in `inlines`
    def get_context_data(self, **kwargs):
        ctx = super(CreateFatherView, self).get_context_data(**kwargs)
        if self.request.POST:
            ctx['form'] = FatherForm(self.request.POST)
            ctx['inlines'] = FatherInlineFormSet(self.request.POST)
        else:
            ctx['form'] = Father()
            ctx['inlines'] = FatherInlineFormSet()
        return ctx 
```

最后，这是模板：

关键部分是 jquery [django-dynamic-formset](http://code.google.com/p/django-dynamic-formset/source/browse/trunk/src/jquery.formset.js?r=14)插件，它不断添加新的内联表单：

```
<form id="father-form" method="POST" enctype="multipart/form-data" action=".">
{% csrf_token %}
<div class="row">
  {% for f in form %}
    <div class="span3">{{ f.label }}<br />{{ f }}
      {% if f.errors %}
          {% for v in f.errors %}
            <br /><span style="color:red;">{{ v }}</span>
          {% endfor %}
      {% endif %}
    </div>
 {% endfor %}
</div>
<hr />
<h2>Sons:</h2>
<table class="table-striped">
 <table>
 {%  for f2 in inlines %}
   <tr id="{{ f2.prefix }}-row">
      {% for i in f2 %}
        <td>
           {{ i }}{% if i.errors %}<span style="color:red;">{{ i.errors }}</span>{% endif %}
        </td>
      {% endfor %}
   </tr>
 {% endfor %}
</table>
{{ inlines.management_form }}
<input type="submit" class="btn btn-primary" value="Go Go Gadget &rarr;">
</form>
<script type="text/javascript">
    $(function() {
        $('#father-form tr').formset({
            prefix: '{{ inlines.prefix }}'
        });
    })
</script> 
```

# jquery - 替换空值 用 0 标记并在 jQuery中用标记 + 类名包装它

> ID：12573993
> 
> 赞同：0
> 
> 时间：2012-09-24T22:48:11.050
> 
> 标签：jquery

> **可能重复：**
> [在 jQuery 的空 <div> 标记中插入带有内容的 <span> 标记](https://stackoverflow.com/questions/12572661/insert-a-span-tag-with-content-in-an-empty-div-tag-in-jquery)

我今天早些时候发布了同样的问题，有 4 个答案似乎都在 jsFiddle 中工作，但在我的真实网站上却没有。我想以不同的方式解决这个问题，以便有人可以在这里帮助我，因为我无法弄清楚我的代码有什么问题。

这是我无法控制的原始 HTML：

```
<div class="a">
   <span class="b">4</span>
</div> 
```

在原始代码中，只要 span 标签之间没有值，整个 span 行就消失了。它留下这样的代码：

```
<div class="a"> </div> 
```

我想实现以下结果，即使没有价值，跨度线也会出现。

```
<div class="a">
   <span class="b">0</span>
</div> 
```

在我看来， div 标签之间有一个空格，所以我使用了 trim 方法。我得到的 4 个答案与我的非常相似，但在我的真实网站上没有任何效果。会不会是我没有弄清楚的其他事情？

这是我尝试过的：

```
<script>
    jQuery(function ($) {

        if ($.trim($('.a').text()).length==0){
            $(".a").html('<span class="b">0</span>');

        };
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T22:55:12.437

You can try this:

```
jQuery(function ($) {

        if ($('.a').children('span').length == 0){
            $(".a").html('<span class="b">&nbsp;</span>');
        };
}); 
```

It's a small variation from your code to check if `.a` has a children `span` tag and also I fill the tag with an empty space as I think that would be in more consonance with the original code.

Also take care if you have more tha one `div` with `class=a` then you have to adapt the above `if` statement within an `.each` loop to iterate every element.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:56:14.507

Why don't you use children.length in this case if you have nested elements

```
jQuery(function ($) {
        if ($('.a').children().length == 0){
            $(".a").html('<span class="b">0</span>');
        };
}); 
```

But this will only work if you have elements Inside.. if you are looking to check for the just text of div this approach will not work..

# javascript - 如何让我的控制器知道加载数据的状态？

> ID：12573996
> 
> 赞同：1
> 
> 时间：2012-09-24T22:48:19.763
> 
> 标签：javascript, ajax, angularjs

我正在开发一个大型 AngularJS 应用程序，在该应用程序中，我试图将所有 Ajax 代码封装到控制器从中获取数据的各种服务中。问题围绕需要了解任何 ajax 调用的状态并向用户显示正确的信息。可能没有找到数据、当前正在加载数据，或者发生了阻止数据加载的错误。需要向用户显示加载消息、“未找到数据”消息或错误消息。

假设我有一个`ProjectService`. 理想情况下，如果有一个方法被调用`getAllProjects`，它将返回一个项目数组。但是那样我不知道服务器通信发生了什么。

那么如何让控制器知道数据是否已加载、正在加载或发生错误？我能想到的最好方法是使用如下伪代码中的回调。有没有更好的方法来完成这样的事情或我可能忽略的任何事情？

谢谢。

```
app.controller( "ProjectController", function( $scope, ProjectService ){

  // Set the initial / default status
  $scope.loadStatus = "loading";

  // Return an empty array initially that will be filled with
  // any data that is returned from the server
  // The callback function will be executed when the ajax call is finished
  $scope.projects = ProjectService.getProjects(function( status ){

    // Alert the controller of a status change
    setStatus( status );

  });

  function setStatus( ){
    $scope.loadStatus = status;

    // ... update the view or whatever is needed when the status changes....
  }

});

app.service( "ProjectService", function( $resource ){

  return {
    getAllProjects: function(){

      // ... load and return the data from the server ...

    }
  };

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T00:40:00.670

在我们的代码库中，我们一直在做

```
$scope.flags.loading = true;
$http(...).success(function(){
  $scope.flags.loading = false;
}); 
```

是的，这有点简单，但并非所有查询都需要加载覆盖（例如在分页或刷新期间）。这就是我们选择不简单地使用装饰器的原因。

但是，假设您想这样做，我可以想到几种方法。假设您和我们一样，将您的旗帜放在一个对象中。然后，您可以利用关联来发挥自己的优势：

```
MyService.flags = $scope.flags
... (inside the service) ...
this.flags.loading = true/false; 
```

通过将引用建立为服务的属性，您可以在服务内进行所有状态切换，并避免弄乱您的控制器。尽管如此，这可能会产生两个或多个靠近在一起的查询冲突的可能缺点（第一个查询完成并在第二个查询完成之前删除加载状态）。

出于这个原因，我们已经找到了设置标志。我们并没有真正检查“加载”，我们只是检查数据或使用成功回调。

# automation - 如何使用 C# 访问 Visio 2010 的多个实例的 VSTO 应用程序对象？

> ID：12573999
> 
> 赞同：4
> 
> 时间：2012-09-24T22:48:50.397
> 
> 标签：automation, vsto, visio

有谁知道如何`Application`使用 C# 访问 Visio 2010 的多个实例的 VSTO 对象？`Marshal.GetActiveObject()`只返回活动实例。

论坛上有[关于如何`Application`为所有 Excel 实例获取多个对象的](http://blogs.officezealot.com/whitechapel/archive/2005/04/10/4514.aspx)帖子——作者使用该技术按进程遍历每个 Excel 实例，从 Excel 实例的子窗口获取本机对象模型，最后获取`Application`对象。

此技术适用于 Excel，但我无法从对允许我引用父对象的 Visio 窗口句柄的调用中获取有效的本机 OM（`IDispatch`或）。`IAccessible``AccessibleObjectFromWindow()``Application`

这是我的代码片段：

```
using VISIO = Microsoft.Office.Interop.Visio;

Process[] processes = Process.GetProcessesByName(Visio.APP_PROCESS_NAME);
foreach (Process process in processes)
{
    int hwnd = (int)process.MainWindowHandle;

    // We need to enumerate the child windows to find one that
    // supports accessibility. To do this, instantiate the
    // delegate and wrap the callback method in it, then call
    // EnumChildWindows, passing the delegate as the 2nd arg.
    if (hwnd != 0)
    {
        int hwndChild = 0;
        cb = new EnumChildCallback(EnumChildProc);
        EnumChildWindows(hwnd, cb, ref hwndChild);

        // If we found an accessible child window, call
        // AccessibleObjectFromWindow, passing the constant
        // OBJID_NATIVEOM (defined in winuser.h) and
        // IID_IDispatch - we want an IDispatch pointer
        // into the native object model.
        if (hwndChild != 0)
        {
            const uint OBJID_NATIVEOM = 0xFFFFFFF0;
            Guid IID_IDispatch = new Guid("{00020400-0000-0000-C000-000000000046}");
            EXL.Window ptr = null;

            int hr = AccessibleObjectFromWindow(
                hwndChild, OBJID_NATIVEOM,
                IID_IDispatch.ToByteArray(), ref ptr);
            if (hr >= 0)
            {
                // If we successfully got a native OM
                // IDispatch pointer, we can QI this for
                // an Viso Application (using the implicit
                // cast operator supplied in the PIA).
                VISIO.Application app = (VISIO.Application)ptr.Application;
                allInstances.Add(app);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T02:17:57.397

我找到了一个解决方案，它遍历运行时对象表 (ROT) 以获取与 Visio 文档 (".vdx") 对应的所有名字对象并获取它们对应的 VSO.Document 对象（使用 VSO=Microsoft.Office.Interop.Visio）；使用 VSO.Document 对象，我可以从 Document.Application 属性中获取 VSO.Application 对象。

从 Andrew Baker 的这篇文章：[http](http://www.vbusers.com/codecsharp/codeget.asp?ThreadID=69&PostID=1) ://www.vbusers.com/codecsharp/codeget.asp?ThreadID=69&PostID= 1，我创建了一个 ROTUtil 实用程序/帮助类：

```
/// <summary>
/// The COM running object table utility class.
/// </summary>
public class ROTUtil
{
    #region APIs

    [DllImport("ole32.dll")]
    private static extern int GetRunningObjectTable(int reserved,
        out UCOMIRunningObjectTable prot);

    [DllImport("ole32.dll")]
    private static extern int CreateBindCtx(int reserved,
        out UCOMIBindCtx ppbc);

    [DllImport("ole32.dll", PreserveSig = false)]
    private static extern void CLSIDFromProgIDEx([MarshalAs(UnmanagedType.LPWStr)] string progId, out Guid clsid);

    [DllImport("ole32.dll", PreserveSig = false)]
    private static extern void CLSIDFromProgID([MarshalAs(UnmanagedType.LPWStr)] string progId, out Guid clsid);

    [DllImport("ole32.dll")]
    private static extern int ProgIDFromCLSID([In()]ref Guid clsid, [MarshalAs(UnmanagedType.LPWStr)]out string lplpszProgID);

    #endregion

    #region Public Methods

    /// <summary>
    /// Converts a COM class ID into a prog id.
    /// </summary>
    /// <param name="progID">The prog id to convert to a class id.</param>
    /// <returns>Returns the matching class id or the prog id if it wasn't found.</returns>
    public static string ConvertProgIdToClassId(string progID)
    {
        Guid testGuid;
        try
        {
            CLSIDFromProgIDEx(progID, out testGuid);
        }
        catch
        {
            try
            {
                CLSIDFromProgID(progID, out testGuid);
            }
            catch
            {
                return progID;
            }
        }
        return testGuid.ToString().ToUpper();
    }

    /// <summary>
    /// Converts a COM class ID into a prog id.
    /// </summary>
    /// <param name="classID">The class id to convert to a prog id.</param>
    /// <returns>Returns the matching class id or null if it wasn't found.</returns>
    public static string ConvertClassIdToProgId(string classID)
    {
        Guid testGuid = new Guid(classID.Replace("!", ""));
        string progId = null;
        try
        {
            ProgIDFromCLSID(ref testGuid, out progId);
        }
        catch (Exception)
        {
            return null;
        }
        return progId;
    }

    /// <summary>
    /// Get a snapshot of the running object table (ROT).
    /// </summary>
    /// <returns>A hashtable mapping the name of the object in the ROT to the corresponding object
    /// <param name="filter">The filter to apply to the list (nullable).</param>
    /// <returns>A hashtable of the matching entries in the ROT</returns>
    public static Hashtable GetActiveObjectList(string filter)
    {
        Hashtable result = new Hashtable();

        int numFetched;
        UCOMIRunningObjectTable runningObjectTable;
        UCOMIEnumMoniker monikerEnumerator;
        UCOMIMoniker[] monikers = new UCOMIMoniker[1];

        GetRunningObjectTable(0, out runningObjectTable);
        runningObjectTable.EnumRunning(out monikerEnumerator);
        monikerEnumerator.Reset();

        while (monikerEnumerator.Next(1, monikers, out numFetched) == 0)
        {
            UCOMIBindCtx ctx;
            CreateBindCtx(0, out ctx);

            string runningObjectName;
            monikers[0].GetDisplayName(ctx, null, out runningObjectName);

            if (filter == null || filter.Length == 0 || runningObjectName.IndexOf(filter) != -1)
            {
                object runningObjectVal;
                runningObjectTable.GetObject(monikers[0], out runningObjectVal);
                result[runningObjectName] = runningObjectVal;
            }
        }

        return result;
    }

    /// <summary>
    /// Returns an object from the ROT, given a prog Id.
    /// </summary>
    /// <param name="progId">The prog id of the object to return.</param>
    /// <returns>The requested object, or null if the object is not found.</returns>
    public static object GetActiveObject(string progId)
    {
        // Convert the prog id into a class id
        string classId = ConvertProgIdToClassId(progId);

        UCOMIRunningObjectTable prot = null;
        UCOMIEnumMoniker pMonkEnum = null;
        try
        {
            int Fetched = 0;
            // Open the running objects table.
            GetRunningObjectTable(0, out prot);
            prot.EnumRunning(out pMonkEnum);
            pMonkEnum.Reset();
            UCOMIMoniker[] pmon = new UCOMIMoniker[1];

            // Iterate through the results
            while (pMonkEnum.Next(1, pmon, out Fetched) == 0)
            {
                UCOMIBindCtx pCtx;

                CreateBindCtx(0, out pCtx);

                string displayName;
                pmon[0].GetDisplayName(pCtx, null, out displayName);
                Marshal.ReleaseComObject(pCtx);
                if (displayName.IndexOf(classId) != -1)
                {
                    // Return the matching object
                    object objReturnObject;
                    prot.GetObject(pmon[0], out objReturnObject);
                    return objReturnObject;
                }
            }
            return null;
        }
        finally
        {
            // Free resources
            if (prot != null)
                Marshal.ReleaseComObject(prot);
            if (pMonkEnum != null)
                Marshal.ReleaseComObject(pMonkEnum);
        }
    } 
```

然后这是我的类中获取实例的方法：

```
 /// <summary>
    /// This strategy of getting the VSO.Application instances uses the appropriate file monikers
    /// from the Runtime Object Table to get the VSO.Document object and hence the VSO.Document.Application
    /// property.
    /// </summary>
    /// <param name="allInstances"></param>
    protected void GetInstancesROTStrategy(IList<VSO.Application> allInstances)
    {
        // Iterate through all the objects in the ROT
        string filter = ".vdx";
        Hashtable runningObjects = ROTUtil.GetActiveObjectList(filter);
        Hashtable appInstances = new Hashtable();

        // Display the object ids
        foreach (DictionaryEntry de in runningObjects)
        {
            // get visio document file monikers
            string progId = de.Key.ToString();
            object getObj = ROTUtil.GetActiveObject(progId);
            if (getObj != null)
            {
                // try to cast the object to a VSO.Document
                VSO.Document doc = getObj as VSO.Document;
                if (doc != null)
                {
                    VSO.Application app = doc.Application;
                    // only add to results IList if not duplicate
                    if (!appInstances.ContainsKey(app.WindowHandle32))
                    {
                        appInstances.Add(app.WindowHandle32, app);
                        allInstances.Add(app);
                    }
                }
            }
        }
    } 
```