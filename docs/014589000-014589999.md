# StackOverflow 问答 14589000-14589999

# c# - 如何绑定到组合框控件而不在 Winforms 后面的代码中添加代码？

> ID：14589003
> 
> 赞同：0
> 
> 时间：2013-01-29T17:45:44.770
> 
> 标签：c#, winforms, c#-4.0, data-binding, combobox

我正在尝试找到最优雅的方式来绑定到 Windows 窗体上的组合框，而无需使用后面的代码。在表单上，​​我有一个带有两个绑定源的组合框。一个绑定到一个控制器，该控制器包含一个国家列表，并在调用时填充此列表。另一个绑定源绑定到绑定到控制器的另一个绑定源，我已将数据成员设置为“国家/地区”的集合。我正在使用 EF5 在控制器中获取我的数据。但是，根据我所做的，当我运行我的应用程序时，我无法填充组合框。请协助我在数据绑定方面缺少什么？请在下面找到我的代码：

```
 static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            IUnityContainer container = new UnityContainer();
            Modules.RegisterModules(container);

            var controller = container.Resolve<IController>();
            Application.Run(new TestForm(controller));
        }
    }

    internal static class Modules
    {
        public static void RegisterModules(IUnityContainer container)
        {
            container.RegisterType<IController, GeoController>();
            container.RegisterType<IModelContainer, GeoModelContainer>();
        }
    }

    public class GeoController : IController, INotifyPropertyChanged
    {
        private List<Continent> _continents;
        private List<Country> _countries;
        private List<City> _cities;
        IModelContainer Container { get; set; }

        public GeoController(IModelContainer container)
        {
            Container = container;

            Countries = Container.Countries.ToList();
        }

        #region Properties    

        public List<Country> Countries
        {
            get { return _countries; }
            set
            {
                _countries = value;
                OnPropertyChanged();
            }
        }

        #endregion

        public event PropertyChangedEventHandler PropertyChanged;

        [NotifyPropertyChangedInvocator]
        protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    public interface IController
    {
        List<Country> Countries { get; set; }
    }

    public partial class TestForm : Form
    {
        IController Controller { get; set; }
        public TestForm(IController controller)
        {
            InitializeComponent();

            Controller = controller;
        }
    } 
```

# java - 如何向 \p{S} 添加否定

> ID：14589007
> 
> 赞同：0
> 
> 时间：2013-01-29T17:46:00.717
> 
> 标签：java, regex, regex-negation

嗨，有人为我提供了一个很好的解决方案，其中包括`\p{S}`匹配正则表达式中的任何符号。问题是我需要从`\p{S}`. 我不想也不想`&`成为`'`对手。

我想也许`\p{S^&^'}`会奏效，但事实并非如此。我在网上看过，但我不确定要搜索什么。

请帮忙。

`\b\p{L}*[\p{S}\p{P}]((\p{L}[\p{P}\p{S}])|([\p{P}\p{S}]\p{L})|(\p{L}))+\b`

另一种解决方案是`\b([a-zA-Z]+(?:[^\w\s^'&]|_)[a-zA-Z]*)|[a-zA-Z]*(?:[^\w\s^'&]|_)[a-zA-Z]+\b`，但它会捕获以标点符号结尾的单词。如果它不这样做，它也会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:00:14.357

使用[字符类减法](http://www.regular-expressions.info/xmlcharclass.html)（如果可用）：

```
[\p{S}-[&']] 
```

如果不可用，请使用[前瞻](http://www.regular-expressions.info/lookaround.html)：

```
(?!.?[&'])\p{S} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:05:36.160

您可以使用负面的前瞻`(?!.*[&'])`，即

```
\b(?!.*[&'])\p{L}*[\p{S}\p{P}]((\p{L}[\p{P}\p{S}])|([\p{P}\p{S}]\p{L})|(\p{L}))+\b 
```

# sql - 与第 1 和第 2 高薪相关的 Sql 查询

> ID：14589009
> 
> 赞同：2
> 
> 时间：2013-01-29T17:46:09.917
> 
> 标签：sql, sql-server

有人可以告诉我这个 sql 查询是如何计算的：

```
SELECT e.sal 
FROM employees e 
WHERE 1 >= (
    SELECT count(*) 
    FROM employess s 
    WHERE s.sal>e.sal
) 
```

我知道这个查询返回第一和第二高薪水。但我想了解这个查询的工作原理。我想知道它如何返回第一和第二高的薪水。请详细说明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T17:55:37.443

子选择

```
 (SELECT count(*) FROM employess s WHERE s.sal>e.sal) 
```

返回薪水大于您在顶层查看的当前员工的员工人数`select`。

所以查询基本上说*给我所有员工，使其他员工的收入比他们多 1 人或更少*

非常直截了当，尽管效率极低。更简单的方法就是这样：

```
select top 2 * from employees order by sal desc 
```

**编辑：**这将返回薪水最高的前 2 名员工，正如 Gordon 指出的那样，这与前 2 名不同的薪水值不同，因为人们可能有完全相同的薪水。如果这是一个问题，您必须首先像这样对其进行重复数据删除：

```
select top 2 sal from employees group by sal order by sal desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T17:51:31.050

为了获得你的第一和第二高薪，我会使用`ROW_NUMBER()`. 这应该很容易理解薪水的排名。或者，如果您需要考虑关系，请考虑使用`RANK()`.

像这样的东西应该工作：

```
SELECT sal, Row 
FROM (
   SELECT sal, ROW_NUMBER() OVER(ORDER BY sal DESC) AS Row
   FROM employees e ) t
WHERE Row IN (1,2); 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!3/6c9cd/7)。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T17:49:23.690

## 编辑：我错过了 e 和 s。所以我的回答是不正确的。

该查询应该返回所有内容。

```
(SELECT count(*) FROM employess s WHERE s.sal>e.sal) 
```

由于 e.sal 永远不会 > e.sal（1 永远不会 > 1），因此 count(*) 将始终为 0。并且`SELECT e.sal FROM employees e WHERE 1 >= (0)` 永远是一切

如果你想返回前 2 名的薪水，你可能想试试这个：

```
SELECT TOP 2 * FROM employess AS e ORDER BY e.sal DESC 
```

# php - 输入类型文件验证作为 id 属性是数组而不是单值

> ID：14589010
> 
> 赞同：0
> 
> 时间：2013-01-29T17:46:15.233
> 
> 标签：php, javascript, jquery, html

我想验证我的表格有

```
<input type="file" id="file[]"> 
```

我只想在文件上传时提交表单，否则会弹出错误消息。问题是我已经制作了上传多个文件的代码。所以 ID 属性`<input type="file">`是`array(file[])`。

我试过了

1.  `document.getElementById('file').value`
2.  `document.getElementById('file[]').value`
3.  `document.getElementById('file[3]').value`

但每次它都不起作用。我已经通过firebug检查了它，它给出了错误

```
 document.getElementById(...) // is null. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T17:51:46.057

您的问题很可能是您的 ID 中不能有方括号 ( `[]`)。

请参阅[HTML 中 id 属性的有效值是什么？](https://stackoverflow.com/questions/70579/what-are-valid-values-for-the-id-attribute-in-html)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T17:54:21.553

您不能创建具有相同 ID 的多个元素。而不是 id 使用 class='fileInput' 和使用

var fileArr = document.getElementByClassName("fileInput") ;

然后循环遍历数组并检查所有文件输入是否有效..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:05:56.030

您必须确保 ID 有效且唯一。这似乎是您当前的问题。

但是，应该使用 ID 属性来区分元素与其当前组之外的元素。尝试处理 ID 值中的某种模式来构建组可能是不可读的，并且更有可能导致意外错误（即：多个元素的相同 ID 或计算错误的元素 ID）。

相反，如果你想创建一组多个 DOM 元素，你可以考虑使用`class`jQuery 容易获取/迭代的属性。

```
<input name="fname" type="text" class="grp-1" />
<input name="lname" type="text" class="grp-1" />
<input name="file" type="file" class="grp-1" /> 
```

使用这种方法，您可以：

```
var myGroup = $('.grp-1');
var firstInput = myGroup.eq(0);
var secondInput = myGroup.eq(1); 
```

或者

```
myGroup.foreach(function(index){
    var element = $(this);
    // whatever needs to be validated with the current element
}); 
```

# reporting-services - 无法在 SSRS 中创建与数据源错误 (rsErrorOpeningConnection) 的连接

> ID：14589011
> 
> 赞同：22
> 
> 时间：2013-01-29T17:46:16.150
> 
> 标签：reporting-services, ssrs-2008, database-connection

我正在将报告集成到浏览器中，但出现此错误：

```
An error has occurred during report processing. (rsProcessingAborted)
Cannot create a connection to data source 'dsFederatedSample_SurveyLevel_STG'. (rsErrorOpeningConnection)
For more information about this error navigate to the report server on the local server machine, or enable remote errors 
```

![在此处输入图像描述](../Images/205c012d20992ca488b15cdfa2c20d26.png)

这与 SQL 与 Windows 身份验证有关吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-29T18:41:51.107

我会尝试的第一件事是获取有关错误的更多信息 - 这是一个非常通用的消息。

您可以根据错误消息启用远程错误并复制错误以获取更多信息：

[启用远程错误](http://technet.microsoft.com/en-us/library/aa337165.aspx)。

或者检查报告服务器错误日志以查看记录的错误。

```
%programfiles%\Microsoft SQL Server\<SQL Server Instance>\Reporting Services\LogFiles\ 
```

下一步是以数据源用户身份连接到数据库，使用运行报表时使用的相同参数运行报表正在使用的任何代码/存储过程，并查看是否发生任何错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-30T12:19:34.560

在 SQL Server 2008 中，除了上述两个选项之外，您还有第三个选项可以通过 SQL Server Management Studio 进行此设置。

1.启动 Management Studio 并连接到报表服务器实例（确保选择“报表服务”服务器类型）。

2.右键单击ReportServer并选择属性

3.点击高级

4.在 EnableRemoteErrors 中，选择 True。

5.单击确定。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-20T07:50:41.867

我在 Windows 8.1、SQL Server 2014 开发人员版和 Visual Studio 2013 Pro 上遇到了同样的问题“无法创建与数据源的连接......用户登录失败......”。上面其他 Stackoverflow 社区成员提供的所有解决方案都不适合我。

所以，我做了接下来的步骤（以管理员身份运行所有 Windows 应用程序）：

1.  VS2013 SSRS：我在右窗格“解决方案资源管理器”中使用 Windows 身份验证（集成安全）将我的数据源转换为共享数据源 (.rds)。

2.  原始（非共享）数据源（在左侧窗格“报告数据”中）获得“不使用凭据”。

3.  在项目属性上，我将“部署”“覆盖数据源”设置为“真”并重新部署项目。

[![在此处输入图像描述](../Images/6d0f025a5917f9f1fcb941a268b9b9d9.png)](https://i.stack.imgur.com/uQ9F8.png)

之后，我可以运行我的报告，而无需进一步要求输入凭据。所有共享数据源都部署在单独的目录“数据源”中。

[![在此处输入图像描述](../Images/5f1e12dc398937abcd44e7b228a1c006.png)](https://i.stack.imgur.com/yCC5j.png)

[![在此处输入图像描述](../Images/b140f681e9279ff26e2fa727e1c988e7.png)](https://i.stack.imgur.com/Uadjf.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-01-19T20:11:07.680

在我的情况下，这是由于在本地开发报告时在我的数据源中使用了*集成 Windows 身份验证*，但是一旦他们将其提交给报告管理器，身份验证就被破坏了，因为该站点没有正确传递我的凭据。

*   简单的解决方法是将用户名/密码硬编码到您的数据源中。
*   更难的解决方法是通过报表管理器正确模拟/委托您的 Windows 凭据到底层数据源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-12T20:58:55.410

问题是因为您的数据源设置不正确，为此请验证您的数据源连接，为此首先导航到报表服务配置管理器

点击开始 -> 全部开始 -> Microsoft SQL Server -> 配置工具 -> “报表服务配置管理器”</p>

打开报表管理器 URL，然后导航到数据源文件夹，如下图所示

然后创建一个数据源或通过右键单击您的数据库源并选择“管理”来配置已经存在的数据源，如下所示

现在在属性选项卡的左侧菜单中，使用您的连接字符串以及用户名和密码填写数据源，然后单击测试连接，如果连接成功，则单击“应用”

在这种情况下，导航到包含您的报告的文件夹“SurveyLevelReport”

最后将您的报告设置为您之前设置的数据源，然后单击应用

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-01T11:20:15.253

如果在存储过程中使用空值，则需要将参数设置为接受空值。这对我有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-07-20T11:32:28.043

在我的情况下，我在一份报告中向 DB 和 Analysis Services Cube 提供了许多不同的数据集。看起来数据集相互阻塞并产生了这样的错误。对我来说，CUBE 数据源属性中的选项“在处理查询时使用单个事务”

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-05-24T13:05:39.830

我遇到了类似的问题，作为新手，我花了一段时间才弄清楚，但我了解到用户必须在 SSMS 中登录。我使用以下参数创建了登录：

*   在服务器角色下 - 检查系统管理员
*   在用户映射下 - 我选择了数据库和报表服务器。对于我检查的每个数据读取器和数据写入器
*   在 Securables 下 - 我检查了任何允许用户连接到数据库并查看任何内容的内容
*   我还发现现有登录之一已检查了denydatareader 和denydatawriter。一旦我删除了这些，它就起作用了。

我并不是说这是最好的方法，只是对我有用。希望这可以帮助

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-05-13T00:57:58.213

更多信息将很有用。

当我遇到相同的错误消息时，我所要做的就是正确配置 DataSource 的凭据页面（我使用的是 Report Builder 3）。如果您选择默认值，报表将在报表生成器中正常工作，但在报表服务器上会失败。

您可以在此处查看此修复程序的更多详细信息： [https ://hodentekmsss.blogspot.com/2017/05/fix-for-rserroropeningconnection-in.html](https://hodentekmsss.blogspot.com/2017/05/fix-for-rserroropeningconnection-in.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-29T13:02:23.987

我有完全相同的问题。原因可能不同，但在我的情况下，在尝试了几种不同的方法（例如更改数据源设置上的连接字符串）后，我发现这是臭名昭著的“双跳”问题（更多信息[在这里](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/6d1604e5-e739-41e4-89a5-c6681bff2e61/windows-authentication-double-hop-problem?forum=sqlreportingservices)）。

为了解决这个问题，可以使用以下两个选项（根据超链接的响应之一）：

1.  ```
     Change the Report Server service to run under a domain user account, and register a SPN for the account. 
    ```

2.  ```
     Map Built-in accounts HTTP SPN to a Host SPN. 
    ```

使用选项 1，您需要选择“Windows”凭据而不是数据库凭据，以克服身份验证时发生的双跳。

[![Windows 凭据](../Images/4912b1b72e4f7c9d2a177faf43f9d6b7.png)](https://i.stack.imgur.com/RvcHJ.png)

# linq - 无法将类型“System.Collections.Generic.IEnumerable>>”隐式转换为“System.Collections.Generic.IEnumerable”。存在显式转换

> ID：14589016
> 
> 赞同：4
> 
> 时间：2013-01-29T17:46:29.867
> 
> 标签：linq, c#-4.0, linq-to-xml

我正在使用以下查询返回所有子元素，然后基于子节点我想获取结果。

```
XElement rootElement = XElement.Load(@"E:\Samples\TestConsole\TestConsoleApp\TestConsoleApp\XMLFile1.xml");
        IEnumerable<XElement> lv1s = from lv1 in rootElement.Descendants("A")
                   where lv1.Attribute("Code").Value.Equals("A001") && lv1.Attribute("Lable").Value.Equals("A001")
                   select (from ltd in lv1.Descendants("A1")
                           where ltd.Attribute("Code").Value.Equals("001")
                           select ltd.Elements()).ToList(); 
```

但我仍然有以下错误。

`Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<System.Collections.Generic.List<System.Collections.Generic.IEnumerable<System.Xml.Linq.XElement>>>' to 'System.Collections.Generic.IEnumerable<System.Xml.Linq.XElement>'. An explicit conversion exists (are you missing a cast?)`

请告诉我。

我想要我的 lv1s["A11"], lv1s["A22"] 的值

下面是我的xml

```
 <?xml version="1.0" encoding="utf-8" ?>
<Document>
  <A Code="A001" Lable="A001">
    <A1 Code="001">
      <A11>A1</A11>
      <A22>A2</A22>
      <A33>A3</A33>
    </A1>
  </A>
  <A Code="A002" Label="A002">
    <A1 Code="002">
      <A44>A44</A44>
      <A55>A55</A55>
    </A1>
  </A>
</Document> 
```

请告诉我。

另外，我如何在返回列表中将“枚举未产生结果”作为计数 0 处理，因为如果发生此错误，它会给出计数 > 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:57:37.687

查询结果的类型为`IEnumerable<List<IEnumerable<XElement>>>`。但是您正试图将其分配给`IEnumerable<XElement>`. 为什么？因为对于每个`A`元素，您都在选择`A1`子元素列表。这给了你列表的集合。

您可以使用显式结果类型来解决此问题。即代替`IEnumerable<XElement> lv1s`使用`var lvls`。或者使用实际的 lvls 类型：`IEnumerable<List<IEnumerable<XElement>>> lvls`.

或者如果你想得到`IEnumerable<XElement>`然后使用`SelectMany`：

```
IEnumerable<XElement> lv1s = 
    rootElement.Descendants("A")
               .Where(lv1 => (string)lv1.Attribute("Code") == "A001" &&
                             (string)lv1.Attribute("Lable") == "A001")
               .SelectMany(lv1 => lv1.Descendants("A1")
                            .Where(ltd => (string)ltd.Attribute("Code") == "001")
                            .Select(ltd => ltd.Elements()); 
```

或者以这种方式重写您的查询：

```
 IEnumerable<XElement> lv1s =  
         from lv1 in rootElement.Descendants("A")
         where (string)lv1.Attribute("Code") == "A001" &&
               (string)lv1.Attribute("Lable") == "A001"
         from ltd in lv1.Descendants("A1")
         where (string)ltd.Attribute("Code") == "001"
         from e in ltd.Elements()
         select e; 
```

返回以下元素：

```
 <A11>A1</A11>
  <A22>A2</A22>
  <A33>A3</A33> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:48:29.000

一个建议：不要使用`.Value`, 转换为`string`. 另外，如果您的变量在任何情况下都是 an`IEnumerable<XElement>`而不是 a `List<XElement>`，您为什么需要`ToList`？

```
XElement rootElement = XElement.Load(@"E:\Samples\TestConsole\TestConsoleApp\TestConsoleApp\XMLFile1.xml");
IEnumerable<XElement> lv1s = 
    from lv1 in rootElement.Descendants("A")
    where (string)lv1.Attribute("Code") == "A001" && (string)lv1.Attribute("Lable") == "A001"
    select (
        from ltd in lv1.Descendants("A1")
        where (string)ltd.Attribute("Code") == "001"
        select ltd.Elements()
    ); 
```

您有一个嵌套的 LINQ 查询，并且您的查询也返回一个`IEnumerable<XElement>`. 尝试删除嵌套查询，并返回单个元素作为查询的结果（括号只是为了清楚起见而添加）：

```
IEnumerable<XElement> lv1s = (
    from lv1 in rootElement.Descendants("A")
    where (string)lv1.Attribute("Code") == "A001" && (string)lv1.Attribute("Lable") == "A001"
    from ltd in lv1.Descendants("A1")
    where (string)ltd.Attribute("Code") == "001"
    from e in ltd.Elements()
    select e
); 
```

此外，如果您只搜索一层深度，您可以使用`Elements`代替`Descendants`：

```
IEnumerable<XElement> lv1s = (
    from lv1 in rootElement.Elements("A")
    where (string)lv1.Attribute("Code") == "A001" && (string)lv1.Attribute("Lable") == "A001"
    from ltd in lv1.Elements("A1")
    where (string)ltd.Attribute("Code") == "001"
    from e in ltd.Elements()
    select e
); 
```

如果您想要的只是这些元素的**值**`A1`--和-- 而不是`A2`对象：`A3``XElement`

```
IEnumerable<string> lv1s = (
    from lv1 in rootElement.Elements("A")
    where (string)lv1.Attribute("Code") == "A001" && (string)lv1.Attribute("Lable") == "A001"
    from ltd in lv1.Elements("A1")
    where (string)ltd.Attribute("Code") == "001"
    from e in ltd.Elements()
    select (string)e
); 
```

# ruby-on-rails - 在rails中使用每个代码块

> ID：14589019
> 
> 赞同：0
> 
> 时间：2013-01-29T17:46:45.223
> 
> 标签：ruby-on-rails, block, each

我有这样的动作来添加一个 ContestEntry 记录来展示。

```
@entry = ContestEntry.find(params[:content_id])
if @entry.view_in_showcase == true
  @entry.view_in_showcase = false
  @entry.save
  redirect_to :back, :notice => "Drop design to showcase"
else
  @entry.view_in_showcase = true
  @entry.save
  redirect_to :back, :notice => "Add design to showcase"
end 
```

但是现在我必须为多条记录实现它，并且我有一个包含 ContestEntry 记录的数组。如何将这个数组与这些代码一起使用？

例如 ：

```
arr_showcase = [ContestEntry.first,ContestEntry.last,..] 
```

如何在文本上方以相同目的更新此数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T17:53:48.163

假设您的数组是`@entries`：

```
@entries.each {|e| e.update_attribute('view_in_showcase', false) if e.view_in_showcase } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T17:55:52.590

重用此代码的第一步是在方法中重构它。

```
class ContestEntry
  def toggle_view_on_showcase!
    view_on_showcase.toggle!
    save
    view_on_showcase
  end
end

# Refactor controller
if @entry.toggle_view_on_showcase!
  redirect_to :back, :notice => "Add design to showcase"
else
  redirect_to :back, :notice => "Drop design to showcase"
end

# reuse!
arr_showcase.each { |e| e.toggle_view_on_showcase! } 
```

# c - C 程序不再在 Ubuntu 中编译

> ID：14589022
> 
> 赞同：4
> 
> 时间：2013-01-29T17:46:54.813
> 
> 标签：c, gcc, ubuntu-12.04

我用 C 语言编写了一个程序，当我使用 gcc 编译时出现这些错误。我直到最近才使用它们，而且我的程序没有改变。

```
In function `_fini':
(.fini+0x0): multiple definition of `_fini'
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crti.o:(.fini+0x0): first   defined here
slots: In function `__data_start':
(.data+0x0): multiple definition of `__data_start'
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o:(.data+0x0): first   defined here
slots: In function `__data_start':
(.data+0x8): multiple definition of `__dso_handle'
/usr/lib/gcc/x86_64-linux-gnu/4.6/crtbegin.o:(.data+0x0): first defined here
slots:(.rodata+0x0): multiple definition of `_IO_stdin_used'
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o:(.rodata.cst4+0x0):   first defined here
slots: In function `_start':
(.text+0x0): multiple definition of `_start'
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o:(.text+0x0): first   defined here
slots: In function `_init':
(.init+0x0): multiple definition of `_init'
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crti.o:(.init+0x0): first   defined here
/tmp/ccIlRWIn.o: In function `main':
slots.c:(.text+0x0): multiple definition of `main'
slots:(.text+0xe4): first defined here
/usr/lib/gcc/x86_64-linux-gnu/4.6/crtend.o:(.dtors+0x0): multiple definition of  `__DTOR_END__'
slots:(.dtors+0x8): first defined here
/usr/bin/ld: error in slots(.eh_frame); no .eh_frame_hdr table will be created.
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:07:04.660

您在输出文件名之前忘记了 -o，因此链接器正在尝试使用您的旧可执行文件作为输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T17:58:56.460

似乎您的代码中有不止一个`main`和其他一些功能。确保您没有在 makefile 中多次包含 main 的多个定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:03:54.507

您可能已经在头文件中定义了一个**外部**变量并将其包含在另一个文件中。

例如，

```
extern int _fini = 1;  // declared in a.h 
```

在 a1.c 或 a2.c 中说

```
#include "a.h"   // _fini again defined in a1.c or a2.c 
```

# php - CSV 数据作为 PHP 表单选项引入

> ID：14589025
> 
> 赞同：1
> 
> 时间：2013-01-29T17:47:09.323
> 
> 标签：php, forms, csv, import, option

我有一个 CSV 文件（比如“../datarange.csv”，由 8 列和可变数量的行组成：

```
HEADER1,HEADER2,HEADER3...HEADER8
DATA001,DATA122,DATA355...DATA888
DATA002,DATA102,DATA322...DATA876
DATA003,DATA176,DATA344...DATA811
                DATA435...DATA222
                DATA311 
```

我想只提取“HEADER8”下的数据，并让它使用 PHP 在表单中填充下拉“选项选择”菜单。像“HEADER8”下的每个人都将是它自己的个人选择。

这个想法是，用户在另一个表单上提交数据以使用建议的名称填充“HEADER8”，例如为新功能的名称集思广益。此表单允许用户对最终选择进行投票，并且该表单将写入新的 CSV（虽然这工作正常 - 我只需要从以前的 CSV 中提取 CSV 数据并使其成为此表单中的选项菜单） .

我不需要从数据库中提取它，甚至不需要触摸 MySql - 我遇到的问题中只有一部分是从旧 CSV 中提取以创建下拉选择菜单。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:02:31.920

[fgetcsv](http://www.php.net/manual/en/function.fgetcsv.php) 应该在这里为您提供帮助。

```
$header8 = array();
if (($handle = fopen("../datarange.csv", "r")) !== FALSE) {
    while (($data = fgetcsv($handle)) !== FALSE) {
        //input logic to skip first row
        $header8[$data[7]] = $data[7];
    }
} 
```

# spring-mvc - 异步消费者 RabbitMQ：如何从队列中按顺序接收消息

> ID：14589027
> 
> 赞同：1
> 
> 时间：2013-01-29T17:47:19.983
> 
> 标签：spring-mvc, rabbitmq

我在 Micro CloudFoundry 中部署了两个 Spring MVC 应用程序，一个是读取文件并将近 3325 条消息发送到 RabbitMQ 中的一个带有主题 Exchange 的队列，另一个是在异步 MessageListener 的帮助下使用这些消息。问题是，侦听器收到的消息没有任何顺序。我认为一次至少有两个侦听器线程在运行。我尝试在 OnMessage() 方法中打印消息序列，如下所示。消息不是按顺序接收的，例如 12、13、12、13 的接收与模式的其余部分不同，这个计数实际上是与消息一起接收的传递标签。

```
Raw Message number: 1 contains: 1340099549587,BMA150 3-axis
Raw Message number: 1 contains: 1340099549626,BMA150 3-axis
Raw Message number: 2 contains: 1340099549666,BMA150 3-axis
Raw Message number: 2 contains: 1340099549705,BMA150 3-axis
Raw Message number: 3 contains: 1340099549746,BMA150 3-axis
Raw Message number: 3 contains: 1340099549810,BMA150 3-axis
Raw Message number: 4 contains: 1340099549866,BMA150 3-axis
Raw Message number: 4 contains: 1340099549906,BMA150 3-axis
Raw Message number: 5 contains: 1340099549951,BMA150 3-axis
Raw Message number: 5 contains: 1340099549999,BMA150 3-axis
Raw Message number: 6 contains: 1340099550063,BMA150 3-axis
Raw Message number: 6 contains: 1340099550063,BMA150 3-axis 
Raw Message number: 7 contains: 1340099550112,BMA150 3-axis 
Raw Message number: 7 contains: 1340099550169,BMA150 3-axis
Raw Message number: 8 contains: 1340099550258,BMA150 3-axis
Raw Message number: 8 contains: 1340099550210,BMA150 3-axis
Raw Message number: 9 contains: 1340099550324,BMA150 3-axis
Raw Message number: 9 contains: 1340099550362,BMA150 3-axis
Raw Message number: 10 contains: 1340099550380,BMA150 3-axis
Raw Message number: 10 contains: 1340099550417,BMA150 3-axis
Raw Message number: 11 contains: 1340099550456,BMA150 3-axis
Raw Message number: 11 contains: 1340099550496,BMA150 3-axis
Raw Message number: 12 contains: 1340099550535,BMA150 3-axis
Raw Message number: 13 contains: 1340099550575,BMA150 3-axis
Raw Message number: 12 contains: 1340099550616,BMA150 3-axis
Raw Message number: 13 contains: 1340099550714,BMA150 3-axis
Raw Message number: 14 contains: 1340099550682,BMA150 3-axis
Raw Message number: 14 contains: 1340099550748,BMA150 3-axis
Raw Message number: 15 contains: 1340099550795,BMA150 3-axis
Raw Message number: 15 contains: 1340099550850,BMA150 3-axis 
```

这是我的 SimpleMessageListenerContainer 的代码：

```
 @Bean
public SimpleMessageListenerContainer listenerContainer() {
        SimpleMessageListenerContainer container = new   SimpleMessageListenerContainer();      
        container.setConnectionFactory(connectionFactory());
        container.setQueues(super.workQueue());
        container.setConcurrentConsumers(1);
        MessageListenerAdapter messageListenerAdapter = new MessageListenerAdapter(new MessageHandler());
        container.setMessageListener(messageListenerAdapter);
        return container;
    } 
```

我将非常感谢您的快速回复。

此致，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-11-17T06:34:19.477

似乎 OP 正在使用 2 个线程从 1 个队列中消耗。然后将输出记录到一个文件中。

由于 2 个线程是独立运行的，我们不应该对一个线程比另一个线程快而感到惊讶。

谁知道当时底层操作系统在管理什么？

OP 只使用一个侦听器实例可能不是坏建议。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-29T23:14:12.837

您的问题可能与多个消费者有关，我的建议是尝试以这样一种方式构建您的解决方案，即消息乱序不会给您带来问题。（尽管这可能不切实际）。

以下来自[http://www.rabbitmq.com/semantics.html](http://www.rabbitmq.com/semantics.html)

> **消息排序保证**
> 
> AMQP 0-9-1 核心规范的第 4.7 节解释了保证排序的条件：在一个通道中发布的消息，通过一个交换和一个队列以及一个传出通道将按照它们发送的顺序被接收。自 2.7.0 版以来，RabbitMQ 提供了更强的保证。
> 
> 消息可以使用具有 requeue 参数（basic.recover、basic.reject 和 basic.nack）的 AMQP 方法返回到队列，或者由于通道关闭而持有未确认的消息。对于 2.7.0 之前的 RabbitMQ 版本，任何这些情况都会导致消息在队列后面重新排队。从 RabbitMQ 2.7.0 版开始，消息始终按发布顺序保存在队列中，即使存在重新排队或通道关闭。
> 
> 在 2.7.0 及更高版本中，如果队列有多个订阅者，单个消费者仍然可以观察到乱序的消​​息。这是由于可能重新排队消息的其他订阅者的行为造成的。从队列的角度来看，消息始终按发布顺序保存。

所以看起来建议是只有一个消费者。

# php - php preg_replace 不接受外部引用

> ID：14589028
> 
> 赞同：0
> 
> 时间：2013-01-29T17:47:21.943
> 
> 标签：php, preg-replace

如您所见，我有以下函数，它用模式替换字符串中的某些字符，但它仅在我将模式作为字符串输入时才有效，就像在第一个注释掉的行中一样。我在那里放了一个回声来测试什么回来了，它应该是这样，所以我不知道发生了什么！有没有人有任何线索？

```
 private function check_string( $s )
    {
        //return preg_replace( '/[^a-z 0-9~%\.:_\\-()"]/i', '', $s );

        // a-z 0-9~%\.:_\\-()"
        echo $this->permitted_uri_chars;

        // /[^a-z 0-9~%\.:_\\-()"]/i
        $pattern = '/[^'. $this->permitted_uri_chars .']/i';    
        return preg_replace( $pattern, '', $s );            
    } 
```

我得到的错误是

`Message: preg_replace(): Compilation failed: range out of order in character class at offset 18`

**回答**

* * *

感谢杰森麦克里

`$pattern = '/[^'. preg_quote($this->config->item('permitted_uri_chars'), '/') .']+/i';`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T17:58:17.257

它在第一个示例中有效，因为您正确转义了 PHP 和正则表达式的字符。（即`\\`）。

使用字符串时，您只对 PHP 进行了转义。因此，当您在正则表达式中使用此字符串时，它不再被转义。

下面的例子证明了这一点：

```
echo '/[^a-z 0-9~%\.:_\\-()"]/i';
// becomes: /[^a-z 0-9~%\.:_\-()"]/i 
```

一些选择是：

*   双逃。
*   通过将破折号放在末尾来避免正则表达式转义：`/[^a-z 0-9~%.:_()"-]/`
*   如果[`preg_quote()`](http://php.net/preg_quote)您要接受字符串正则表达式语法，请使用。

**注意：**我鼓励您阅读有关[在字符类中转义](http://www.regular-expressions.info/charclass.html)的内容。

# ajax - 使用 JAX-RS/RESTEasy 实现 CORS 的 Ajax 请求

> ID：14589031
> 
> 赞同：5
> 
> 时间：2013-01-29T17:47:49.527
> 
> 标签：ajax, json, jax-rs, resteasy, cors

我有两台服务器（Apache 和 JBoss AS7），我需要向客户端提供对所有 http 方法的访问。所有这些请求都必须通过 ajax 发送。客户端代码示例：

```
$.ajax({
      type: "get",
      url: "http://localhost:9080/myproject/services/mobile/list",
      crossDomain: true,
      cache: false,
      dataType: "json",
      success: function(response) {
        console.log(response);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        console.log(textStatus);
        console.log(jqXHR.responseText);
        console.log(errorThrown);
        }
    }); 
```

在 JBoss AS7 中，我使用的是 RESTEasy，实现 CORS 如下：

```
@Path("/mobile")
@Provider
@ServerInterceptor
public class GroupMobile implements MessageBodyWriterInterceptor {

@Inject
private GroupDAO groupDAO;

@GET
@Path("/list")
@Produces(MediaType.APPLICATION_JSON)
public List<Group> getGroups() {
    return groupDAO.listAll();
}

@Override
public void write(MessageBodyWriterContext context) throws IOException,
        WebApplicationException {
    context.getHeaders().add("Access-Control-Allow-Origin", "*");
    context.proceed();
}

@OPTIONS
@Path("/{path:.*}")
public Response handleCORSRequest(
        @HeaderParam("Access-Control-Request-Method") final String requestMethod,
        @HeaderParam("Access-Control-Request-Headers") final String requestHeaders) {
    final ResponseBuilder retValue = Response.ok();

    if (requestHeaders != null)
        retValue.header("Access-Control-Allow-Headers", requestHeaders);

    if (requestMethod != null)
        retValue.header("Access-Control-Allow-Methods", requestMethod);

    retValue.header("Access-Control-Allow-Origin", "*");

    return retValue.build();
}
} 
```

web.xml 和 beans.xml 是空文件。当我访问 MyIP:8080 (Apache) 时，我收到错误消息：

```
XMLHttpRequest cannot load http://localhost:9080/myproject/services/mobile/list?_=1359480354190\. Origin http://MyIP:8080 is not allowed by Access-Control-Allow-Origin. 
```

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-03-21T15:24:17.723

最新的 resteasy (3.0.9-Final) 包括一个实用程序类`org.jboss.resteasy.plugins.interceptors.CorsFilter`。

您可以将 CorsFilter 对象添加到 Application 的单例对象集中，也可以直接将其添加到 ResteasyDeployment 的 ProviderFactory 中。

以下是示例应用程序类：

```
import java.util.HashSet;
import java.util.Set;
import javax.ws.rs.ApplicationPath;

import org.jboss.resteasy.plugins.interceptors.CorsFilter;

@ApplicationPath("/api")
public class RestApplication extends javax.ws.rs.core.Application {
    Set<Object> singletons;

    @Override
    public Set<Class<?>> getClasses() {
        HashSet<Class<?>> clazzes = new HashSet<>();
        clazzes.add(VersionService.class);
        return clazzes;
    }

    @Override
    public Set<Object> getSingletons() {
        if (singletons == null) {
            CorsFilter corsFilter = new CorsFilter();
            corsFilter.getAllowedOrigins().add("*");

            singletons = new LinkedHashSet<Object>();
            singletons.add(corsFilter);
        }
        return singletons;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-26T13:20:16.303

听起来这个问题与[https://issues.jboss.org/browse/RESTEASY-878](https://issues.jboss.org/browse/RESTEASY-878)有关。您可能无法使用`MessageBodyWriterInterceptor`. 尝试改用 servlet 过滤器 ( `@WebFilter`)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T18:09:38.250

您遇到的问题是您正在尝试执行跨站点脚本。您访问了该页面，`http://MyIP:8080`因此浏览器阻止您访问该域之外的资源。这是非常特定于浏览器的，基于浏览器的解决方法都会有所不同（您可以全局禁用 Chrome 中的安全性，也可以在 IE 中基于每个站点禁用安全性）。

如果您将页面加载为`http://localhost:8080`，则它应该允许您访问查询。或者，您可以实现将转发请求的代理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-24T05:06:30.197

好吧，我已经实现了一个小解决方案，首先我在我的项目 Web 中做了一个拦截器，我创建了一个名为“CORSInterceptor”的类，该类就是这种方式。

```
import org.jboss.resteasy.annotations.interception.ServerInterceptor;
import org.jboss.resteasy.core.ResourceMethod;
import org.jboss.resteasy.core.ServerResponse;
import org.jboss.resteasy.spi.Failure;
import org.jboss.resteasy.spi.HttpRequest;
import org.jboss.resteasy.spi.interception.MessageBodyWriterContext;
import org.jboss.resteasy.spi.interception.MessageBodyWriterInterceptor;
import org.jboss.resteasy.spi.interception.PreProcessInterceptor;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.ext.Provider;
import java.io.IOException;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

@Provider
@ServerInterceptor
public class CorsInterceptor implements PreProcessInterceptor, MessageBodyWriterInterceptor {

/**
     * The Origin header set by the browser at each request.
     */
    private static final String ORIGIN = "Origin";

 /**
     * The Access-Control-Allow-Origin header indicates which origin a resource it is specified for can be
     * shared with. ABNF: Access-Control-Allow-Origin = "Access-Control-Allow-Origin" ":" source origin string | "*"
     */
    private static final String ACCESS_CONTROL_ALLOW_ORIGIN = "Access-Control-Allow-Origin";

   //
    private static final ThreadLocal<String> REQUEST_ORIGIN = new ThreadLocal<String>();
    //
    private final Set<String> allowedOrigins;

 public CorsInterceptor(){
   this.allowedOrigins = new HashSet<String>();
   this.allowedOrigins.add("*");
 }

   @Override
    public ServerResponse preProcess(HttpRequest request, ResourceMethod method) throws Failure, WebApplicationException {
        if (!allowedOrigins.isEmpty()) {
            REQUEST_ORIGIN.set(request.getHttpHeaders().getRequestHeaders().getFirst(ORIGIN));
        }
        return null;
    }

@Override
public void write(MessageBodyWriterContext context) throws IOException, WebApplicationException {
    if (!allowedOrigins.isEmpty() && (allowedOrigins.contains(REQUEST_ORIGIN.get()) || allowedOrigins.contains("*"))) {
        context.getHeaders().add(ACCESS_CONTROL_ALLOW_ORIGIN, REQUEST_ORIGIN.get());
      }
    context.proceed();
    }
} 
```

在 File **Web.xml**中，我添加它

```
<context-param>
    <param-name>resteasy.providers</param-name>
    <param-value><package>.CorsInterceptor</param-value>
</context-param> 
```

**package** : 类的 Ubication。

请求我使用过的 JQuery。

```
$.ajax({
    type: 'GET',
    dataType: "json", 

    crossDomain : true,

    cache:false, 
    url: "http://localhost:12005/ProyectoWebServices/ws/servicioTest",
    success: function (responseData, textStatus, jqXHR) {
       alert("Successfull: "+responseData);
    },
    error: function (responseData, textStatus, errorThrown) {
        alert("Failed: "+responseData);
    }
}); 
```

它对我来说很好。我希望它可以帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-18T12:06:10.027

我最近遇到了同样的问题并添加了对我有用的解决方案：

以下是我所做的：

*   我创建了一个扩展 javax.ws.rs.core.Application 的类，并向其中添加了一个 Cors 过滤器。

在 CORS 过滤器中，我添加了`corsFilter.getAllowedOrigins().add("http://localhost:4200");`.

基本上，您应该添加要允许跨域资源共享的 URL。Ans 您也可以使用`"*"`而不是任何特定的 URL 来允许任何 URL。

```
public class RestApplication
    extends Application
{
    private Set<Object> singletons = new HashSet<Object>();

    public MessageApplication()
    {
        singletons.add(new CalculatorService()); //CalculatorService is your specific service you want to add/use.
        CorsFilter corsFilter = new CorsFilter();
        // To allow all origins for CORS add following, otherwise add only specific urls.
        // corsFilter.getAllowedOrigins().add("*");
        System.out.println("To only allow restrcited urls ");
        corsFilter.getAllowedOrigins().add("http://localhost:4200");
        singletons = new LinkedHashSet<Object>();
        singletons.add(corsFilter);
    }

    @Override
    public Set<Object> getSingletons()
    {
        return singletons;
    }
} 
```

*   这是我的 web.xml：

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
    <display-name>Restful Web Application</display-name>

    <!-- Auto scan rest service -->
    <context-param>
        <param-name>resteasy.scan</param-name>
        <param-value>true</param-value>
    </context-param>

    <context-param>
        <param-name>resteasy.servlet.mapping.prefix</param-name>
        <param-value>/rest</param-value>
    </context-param>

    <listener>
        <listener-class>
            org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
        </listener-class>
    </listener>

    <servlet>
        <servlet-name>resteasy-servlet</servlet-name>
        <servlet-class>
            org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
        </servlet-class>
        <init-param>
            <param-name>javax.ws.rs.Application</param-name>
            <param-value>com.app.RestApplication</param-value>
        </init-param>
    </servlet>

    <servlet-mapping>
        <servlet-name>resteasy-servlet</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>

</web-app> 
```

有一些您可能不需要或更改的自定义更改，例如：

```
 <servlet-mapping>
        <servlet-name>resteasy-servlet</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping> 
```

或者

```
 <context-param>
        <param-name>resteasy.scan</param-name>
        <param-value>true</param-value>
    </context-param> 
```

或者

```
 <context-param>
        <param-name>resteasy.servlet.mapping.prefix</param-name>
        <param-value>/rest</param-value>
    </context-param> 
```

**当我遇到这个问题时，我缺少 **的最重要的代码是，我没有将我的类扩展 javax.ws.rs.Application 即 RestApplication 添加到 init-param**`<servlet-name>resteasy-servlet</servlet-name>`**

 **```
 <init-param>
        <param-name>javax.ws.rs.Application</param-name>
        <param-value>com.app.RestApplication</param-value>
    </init-param> 
```

**因此我的过滤器无法执行，因此应用程序不允许来自指定 URL 的 CORS。**

PS：我使用的是 RestEasy 版本：3.12.1.Final**

# php - Box Sizing 取消格式化整个页面

> ID：14589041
> 
> 赞同：-1
> 
> 时间：2013-01-29T17:48:20.523
> 
> 标签：php, html, css

这可能是一个有点傻的问题，但对于像我这样没有 css 经验的人来说，并不是那么容易。问题是我正在尝试在我的项目中实现登录示例。当然你需要配置css、路径等。

问题是配置具有以下说明的登录面板：

```
*,
*:after,
*:before {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
    padding: 0;
    margin: 0;
} 
```

这使得每个应用程序中的所有盒子都毁容了。我该如何解决这个问题？我试图在调用它的地方命名 div 并将名称更改为`*`这个 div。但无所作为。有人可以帮助我吗？

```
echo '<div class="container">           
            <section class="main">
            <form class="form-1" id="login" method="post">
            <p class="field">
                <input type="text" name="login" id="username" placeholder="Nº Funcionario">
                <i class="icon-user icon-large"></i>
            </p>
                <p class="field">
                <input type="password" name="password" id="password" placeholder="Senha">
                <i class="icon-lock icon-large"></i>
            </p>
            <p class="submit">
                <button type="submit" value="Login" id="loginme" name="submit">
                <i class="icon-arrow-right icon-large"></i></button>
            </p>
            </form>
            </section></div>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T17:56:58.480

我建议不要使用边框。

默认情况下，元素的宽度计算如下：

宽度 = 设置宽度属性 + 填充 + 边框宽度

边框框，表示宽度的计算方式不同，还有其他用于调整框大小的属性，例如 padding-box。

tldr 删除所有这些，它很可能是由寻求快速而丑陋的解决特定问题的人所包含的。

许多浏览器也不支持 box-sizing，但所有浏览器都支持宽度。使用它一定会遇到重大问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:39:03.633

如果所有元素的宽度都是使用标准盒子模型计算的，你不能把它放在上面。两者都`*`涵盖`div`了很多元素。如果您需要`box-sizing: border-box`一个元素，则只为该元素指定它：

```
div.foo,
div.foo:after,
div.foo:before {
    /* ... */
} 
```

# jquery - Magento - 几个插件使用 jquery 并覆盖以前加载的插件

> ID：14589052
> 
> 赞同：0
> 
> 时间：2013-01-29T17:48:58.267
> 
> 标签：jquery, magento

我有使用 jQuery 和几个插件的 Magento 主题。一切都很好，直到我安装了几个扩展，每个扩展都包含自己的 jQuery 版本。

我的问题是新的 jQuery 包含覆盖 jQuery 对象并删除所有以前加载的插件。

此外，我注意到第 3 方扩展脚本可以包含在我的脚本列表的中间。

所以，

1.  我如何控制 Magento 中的脚本顺序？
2.  如果我会使用

    ```
    var $j = jQuery.noConflict(); 
    ```

`$j`在一些扩展加载 jQuery 之后会保留所有加载的插件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T13:44:26.170

我解决了这个问题，将我的 jQuery 库移动到 js 文件夹，然后修改每个扩展的路径，它工作得很好。

有关执行此操作的详细方法，请告诉我扩展名，我很乐意为您提供帮助。

# bash - SIPS 图像处理

> ID：14589053
> 
> 赞同：1
> 
> 时间：2013-01-29T17:48:58.603
> 
> 标签：bash, terminal, find, exec, sips

我正在尝试使用以下命令在当前目录中查找所有 PDF（不是递归的） - 但是我认为它不喜欢 --out 上的“{}”。

```
find . -iname "*.pdf" -maxdepth 1 -exec sips -s format jpeg --resampleHeightWidth 129 100 '{}' --out '{}'.jpg \; 
```

当我指定名称 --out test.jpg 时，与 -print 和 sips 一起使用时的查找工作有效。有什么办法可以使这项工作？还是我应该尝试 xargs？为了简单起见，我真的不想使用循环......有什么想法吗？

更新：我尝试使用 xargs - 但再次收到错误 out_dir_not_found。

```
find . -iname "*.pdf" -maxdepth 1 -print0 | xargs -0 -I % sips -s format jpeg --resampleHeightWidth 129 100 % --out "%.jpg"

mymbpro:pdfs dh$ find . -iname "*.pdf" -maxdepth 1 -print0 | xargs -0 -I % sips -s format jpeg --resampleHeightWidth 129 100 % --out "%.jpg"
Error 10: out_dir_not_found /Users/darenhunter/Desktop/pdfs/ATTENTION.pdf.jpg
Try 'sips --help' for help using this tool
Error 10: out_dir_not_found /Users/darenhunter/Desktop/pdfs/DisNCLB119.pdf.jpg
Try 'sips --help' for help using this tool
Error 10: out_dir_not_found /Users/darenhunter/Desktop/pdfs/services2012.pdf.jpg
Try 'sips --help' for help using this tool
Error 10: out_dir_not_found /Users/darenhunter/Desktop/pdfs/Fall2011.pdf.jpg
Try 'sips --help' for help using this tool 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:40:22.533

> 如果您将执行多个结果，则将结果通过管道传递给`xargs`命令会更有效。`xargs`是一个更现代的实现，并以更智能的方式处理长列表。该 `print0`选项可以与此一起使用。
> 
> 以下命令将确保将带有空格的文件名传递给执行的 COMMAND 而不会被 shell 拆分。乍一看，它看起来很复杂，但被广泛使用。

```
find . -print0 | xargs -0 COMMAND 
```

[**参考**](http://wikipedia.org/wiki/Find)

# java - 常规错误：罐子未签名

> ID：14589058
> 
> 赞同：0
> 
> 时间：2013-01-29T17:49:15.033
> 
> 标签：java, security, jnlp, java-web-start, griffon

仅当我尝试在 griffon 中将其作为 webstart 或 applet 运行时，我的应用程序中才会出现以下错误：

```
net.sourceforge.jnlp.LaunchException: Fatal: Initialization Error: Could not initialize application. 
    at net.sourceforge.jnlp.Launcher.createApplication(Launcher.java:778)
    at net.sourceforge.jnlp.Launcher.launchApplication(Launcher.java:552)
    at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:889)
Caused by: net.sourceforge.jnlp.LaunchException: Fatal: Application Error: 
  Cannot grant permissions to unsigned jars. 
  Application requested security permissions, but jars are not signed.
    at net.sourceforge.jnlp.runtime.JNLPClassLoader.setSecurity(JNLPClassLoader.java:312)
    at net.sourceforge.jnlp.runtime.JNLPClassLoader.<init>(JNLPClassLoader.java:232)
    at net.sourceforge.jnlp.runtime.JNLPClassLoader.getInstance(JNLPClassLoader.java:357)
    at net.sourceforge.jnlp.runtime.JNLPClassLoader.getInstance(JNLPClassLoader.java:330)
    at net.sourceforge.jnlp.Launcher.createApplication(Launcher.java:770)
    ... 2 more 
```

我需要在我的代码中添加什么来克服这个问题（我正处于开发阶段，还不想部署）？

我使用了命令：“griffon run-webstart -clean”

这是我的控制器文件：

```
package test1

import griffon.util.GriffonNameUtils as GNU
import griffon.transform.Threading

class Test1Controller {

    def model

    def clear = {
            model.griffonClass.propertyNames.each { name -> model[name] = ''
            }
    }

    @Threading(Threading.Policy.SKIP)
    def submit = {
            java.swing.JoptionPane.showMessageDialog(
            app.windowManager.windows.find{it.focused}, 
            model.griffonClass.propertyNames.collect([]) {
                     name -> "${GNU.getNaturalName(name)} = ${model[name]}"
            }.join('n')
            )
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-09T18:11:24.240

@Steinar 给出了正确答案：

> @ironmantis7x：在评论中称呼他人时，您应该在用户名前加上“@”。如果您不这样做，我认为他们不会收到通知。– Steinar 2013 年 3 月 13 日 22:51

# ios6 - 通过航向停止地图旋转

> ID：14589059
> 
> 赞同：0
> 
> 时间：2013-01-29T17:49:19.093
> 
> 标签：ios6, mapkit, xcode4.5

我已经通过 didupdateheading 旋转了地图。并设置MKUserFollowWithHeading。现在，如果我移动设备，用户总是指向北方。我想通过停止按钮停止地图的旋转到它已经旋转的位置。

这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T07:53:14.060

取地图旋转的角度

```
heading = newHeading.trueHeading; 
```

并通过实现停止按钮方法来转换停止按钮中的地图：

```
[mapView setTransform:CGAffineTransformMakeRotation(heading * M_PI /180.0f); 
```

# starling-framework - 八哥框架动画在进入帧时断断续续

> ID：14589063
> 
> 赞同：0
> 
> 时间：2013-01-29T17:49:23.900
> 
> 标签：starling-framework

我用starling 创建了一个基本的as3 web 项目。我所做的只是创建一个简单的图像并在 onEnterframe 中沿 x 移动图像。但似乎动画/运动并不流畅，每隔几帧就会出现帧数/跳动。下面是 onEnterFrame 和用于创建图像的测试函数。非常感谢您对此的任何帮助。

```
 private function onEnterFrame(e:Event):void
    {
        if(!img)
            return;
        img.x += 1;

        if(img.x >= 960)
            img.x = 0;
    }

    private function test():void
    {
          img = new Image(sAssets.getTextureAtlas("atlas").getTexture("flight_00"));
          addChild(img);
          img.x = 0;
          img.y = 320;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:19:10.947

那是因为每一帧的时间略有不同。为了实现流畅的动画，使用passedTime 参数声明onEnterFrame 处理程序（存储自上一帧以来经过的时间）并使用此值来移动对象，而不是假设每一帧将持续1/frameRate 秒。

```
private function onEnterFrame(passedTime:Number):void
{
    if(!img)
        return;

    img.x += passedTime * 100; // speed is 100 px/sec

    if(img.x >= 960)
        img.x = 0;
} 
```

注意：Starling 的最新版本支持这种形式的事件处理程序（不带事件参数），并且性能应该更高。如果您使用旧版本，您可以从事件对象的相应属性中获取经过的时间。

# c++ - 从下拉框中选择不同项目时更改选项卡小部件的 currentIndex()

> ID：14589066
> 
> 赞同：0
> 
> 时间：2013-01-29T17:49:32.477
> 
> 标签：c++, python, qt, porting

我是*C++*新手， 我刚刚开始将一个最初在**python/Qt**中的程序移植到**C++/Qt**，以便利用可以嵌入到我的程序中的更好的终端小部件。现在我有点卡住了，我正在尝试设置如果选择了下拉框中的不同项目，则`currentIndex()`选项卡小部件的相应更改。

到目前为止，这是我的代码：

```
 //main.cpp

    #include <QApplication>
    #include "mainwindow.h"

    int main(int argc, char *argv[])
    {
        QApplication a(argc, argv);
        MainWindow w;
        w.show();

        return a.exec();
    } 
```

这是mainwindow.h

```
 #ifndef MAINWINDOW_H
    #define MAINWINDOW_H

    #include <QMainWindow>
    #include <QTimer>

    namespace Ui {
    class MainWindow;
    }

    class MainWindow : public QMainWindow
    {
        Q_OBJECT

    public:
        explicit MainWindow(QWidget *parent = 0);
        ~MainWindow();
        QTimer *timer;
        void startMyTimer()
        {
            timer = new QTimer();
            timer->setInterval(1);
            timer->start();
            QObject::connect(timer,SIGNAL(timeout()),this,SLOT(changeIndex()));
        }

    private:
        Ui::MainWindow *ui;
        void changeIndex();
         };

    #endif // MAINWINDOW_H 
```

最后是 mainwindow.cpp

```
 #include "mainwindow.h"
    #include "ui_mainwindow.h"

    MainWindow::MainWindow(QWidget *parent) :
        QMainWindow(parent),
        ui(new Ui::MainWindow)
    {
        ui->setupUi(this);
        changeIndex();
    }

    MainWindow::~MainWindow()
    {
        delete ui;
    }

    void MainWindow::changeIndex()
    {
        if (ui->comboBox->currentText() == "add-apt-repository")
        {
            ui->stackedWidget->setCurrentIndex(0);
            ui->checkBox->setCheckState(Qt::Checked);
        }
        if (ui->comboBox->currentText() == "apt-get")
        {
            ui->stackedWidget->setCurrentIndex(1);
            ui->checkBox->setCheckState(Qt::Checked);
        }
        if (ui->comboBox->currentText() == "aptitude")
        {
           ui->stackedWidget->setCurrentIndex(2);
           ui->checkBox->setCheckState(Qt::Checked);
        }
        if (ui->comboBox->currentText() == "bzr")
        {
            ui->stackedWidget->setCurrentIndex(3);
            ui->checkBox->setCheckState(Qt::Unchecked);
        }
        if (ui->comboBox->currentText() == "cd")
        {
            ui->stackedWidget->setCurrentIndex(4);
            ui->checkBox->setCheckState(Qt::Unchecked);
        }
        if (ui->comboBox->currentText() == "chmod")
        {
            ui->stackedWidget->setCurrentIndex(5);
            ui->checkBox->setCheckState(Qt::Checked);
        }
    } 
```

我看过一堆 QTimer 的例子，但我很茫然。我也尝试过，`if (ui->comboBox->changeEvent())`但我可能也用错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T17:58:09.213

放下计时器，这里没用。相反，通过将 changeIndex() 放入“私有插槽：”部分，将其设为插槽：

```
public slots:
    void changeIndex(); 
```

然后在 MainWindow 构造函数中将组合框的[currentIndexChanged 信号](http://qt-project.org/doc/qt-4.8/qcombobox.html#currentIndexChanged)连接到您的插槽：

```
connect( ui->combobox, SIGNAL(currentIndexChanged(int)), this, SLOT(changeIndex()) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:01:27.737

首先，您可能必须标记`changeIndex()`为插槽，如下所示：

```
class MainWindow : public QMainWindow
{
    Q_OBJECT

    // ...

    private slots: 
        void changeIndex();

    private:
        Ui::MainWindow *ui;
} 
```

这也需要您调用 Qt 元对象编译器。如果您使用 qmake，那已经为您完成了。否则，这取决于您的构建系统。

其次，使用计时器有什么特别的原因吗？您还可以连接到组合框的`currentIndexChanged`信号之一。

# java - Jprofiler 7.2.2 - 我如何查看在方法中花费的时间

> ID：14589070
> 
> 赞同：10
> 
> 时间：2013-01-29T17:49:58.737
> 
> 标签：java, jprofiler

我已经下载了 JProfiler 的试用版，并且正在一个 java 1.5 控制台应用程序上对其进行测试。它只显示内存使用情况，即 java.lang.String 被实例化了多少次。我想看看调用了哪些方法以及每个方法花费了多少时间。我还没有弄清楚如何在试用版中执行此操作。

我查看了以下文章 http://java.dzone.com/articles/jprofiler-your-java-code-could，其中显示了“性能瓶颈”的菜单选项。我的下拉菜单中没有这个选项。试用版中是否禁用了此功能？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-30T08:54:01.670

激活左侧栏中的 CPU 视图部分，然后选择“热点”选项卡。您可能必须先开始记录 CPU 数据。如果没有记录数据，将有一个按钮，该选项卡允许您开始 CPU 记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-14T10:54:27.937

1.  打开 CPU 视图部分，现在单击“调用树”选项卡。
2.  右键单击并单击查找。
3.  现在您可以开始输入您想要调查的方法名称，您将看到您的方法的树形层次结构。
4.  您也可以右键单击您的方法，然后单击“设置为根”。
5.  现在，将方法设置为 root 后，可以轻松分析“热点”和“调用图”。

我使用的是 Jprofiler 10.0.3。

# ios - 如何判断哪个 iOS 字体名称是字体系列中的“常规”版本？

> ID：14589075
> 
> 赞同：0
> 
> 时间：2013-01-29T17:50:16.030
> 
> 标签：ios, cocoa-touch, fonts, nsattributedstring

我知道我可以使用 获取字体家族名称列表，`[UIFont familyNames]`并使用 遍历家族的字体名称`[UIFont fontNamesForFamilyName:]`。有什么方法可以判断哪个字体名称代表“正常”字体？命名没有任何一致性（“罗马”，“常规”，甚至没有修饰形容词）。我最终试图在一个子字符串上更改字体，`NSAttributedString`同时保持现有的特征和装饰。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:02:07.120

好吧，我需要更仔细地阅读 CoreText 文档。如果您使用正确的 CoreText 例程，则传入字体系列名称就足够了......

```
NSString *fontFamilyName = ...(font family name)...;
// Make a mutable copy of the attributed text
NSMutableAttributedString *workingAttributedText = [self.attributedText mutableCopy];

// Over every attribute run in the selected range...
[workingAttributedText enumerateAttributesInRange:self.selectedRange
    options:(NSAttributedStringEnumerationOptions) 0
    usingBlock:^(NSDictionary *attrs, NSRange range, BOOL *stop) {
        // get the old font
        CTFontRef oldFont = (__bridge CTFontRef)[attrs objectForKey:NSFontAttributeName];
        // make a new one, with our new desired font family name
        CTFontRef newFontRef = CTFontCreateCopyWithFamily(oldFont, 0.0f, NULL, (__bridge CFStringRef)fontFamilyName);
        // Convert it to a UIFont
        UIFont *newFont = [UIFont fontWithCTFont:newFontRef];
        // Add it to the attributed text
        [workingAttributedText addAttribute:NSFontAttributeName value:newFont range:range];
    }];

// Replace the attributed text with the new version
[self setAttributedText:workingAttributedText]; 
```

如果有更简单的方法可以做到这一点，我很想听听。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:14:52.610

列表中不必有常规字体。有些可能只提供粗体或仅斜体。这就是为什么经常将列表提供给用户让他们做出决定的原因。

# android - MapFragment 在 DialogActivity 中使用时会出现深色覆盖

> ID：14589079
> 
> 赞同：24
> 
> 时间：2013-01-29T17:50:34.140
> 
> 标签：android, android-maps-v2

我正在尝试以主题来展示其中`MapFragment`的`Android Maps v2 API`一个。这工作正常。然而，地图得到了一个黑暗的覆盖：`Activity``@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar`

![对话](../Images/1e982378323ab60e739869c284ba48bd.png)

当我将主题更改为 时`@android:style/Theme.DeviceDefault.Light.NoActionBar`，地图将按原样显示：

![普通的](../Images/9a5e987a9411b1908f64cad8aee39370.png)

这是我的 xml 布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <fragment
        android:id="@+id/mapfragment"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        class="com.google.android.gms.maps.MapFragment" />

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="HELLO"
        android:textSize="@dimen/textsize_large" />

</LinearLayout> 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-24T09:19:36.440

我遇到了同样的问题。经过一番研究，我发现了两个黑客：

*   在 styles.xml 中为您的主题添加此参数：
    `<item name="android:backgroundDimEnabled">false</item>`

不好的部分：它删除了活动后面的黑色覆盖层。

*   为地图对象设置顶部的 z 顺序：
    `GoogleMapOptions googleMapsOptions = new GoogleMapOptions();
    googleMapsOptions.zOrderOnTop( true );
    MapFragment mapFragment = MapFragment.newInstance(googleMapsOptions);`

不好的部分：地图位于缩放控件和 MyLocation 按钮的上方。

就个人而言，我选择第一个解决方案。
希望这有帮助！

[链接到源](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4865)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-08-01T10:07:27.347

对于`DialogFragment`：

```
getDialog().getWindow().clearFlags(WindowManager.LayoutParams.FLAG_DIM_BEHIND); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-10T06:23:36.453

要添加到[Audrel 的解决方案](https://stackoverflow.com/a/16188173/836540)，可以在显示地图时动态取消对话框窗口的暗淡，并在地图消失时将其调暗（例如，当您的对话框有多个页面时，其中一个是地图）：

```
private float mDimAmount;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    WindowManager.LayoutParams params = getWindow().getAttributes();
    mDimAmount = params.dimAmount; // remember original dim amount
    ...
}

private void undim() {
    WindowManager.LayoutParams params = getWindow().getAttributes();
    params.dimAmount = 0.0f;
    getWindow().setAttributes(params);
}

private void dim() {
    WindowManager.LayoutParams params = getWindow().getAttributes();
    params.dimAmount = mDimAmount;
    getWindow().setAttributes(params);
} 
```

仍然只是另一种解决方法，而不是解决根本原因......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-12T21:40:56.353

根据您在对话框中对地图的用途，如果您不需要任何地图控件，则可以使用`liteMode`其中仅显示地图图像的地图图像以及您加载的任何位置。它没有这个 z 层叠加问题。

您可以将其添加到`MapView`布局 xml：

`map:liteMode="true"`

这对我有用，因为我不希望我的地图是交互式的。

您可以在此处阅读 Google 文档：[https ://developers.google.com/maps/documentation/android-api/lite](https://developers.google.com/maps/documentation/android-api/lite)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-24T15:07:05.127

只需将此行添加到您的**样式**中！

```
 <item name="android:backgroundDimEnabled">false</item> 
```

这是我的风格 ：

```
<style name="AppTheme" parent="Theme.AppCompat.Light.NoActionBar">
    <item name="colorPrimary">@color/colorPrimary</item>
    <item name="colorPrimaryDark">@color/dark</item>
    <item name="colorAccent">@color/colorAccent</item>
    <item name="android:backgroundDimEnabled">false</item>
    <item name="windowActionBar">false</item>
</style> 
```

# rest - 有关使用 REST 和 Backbone 的身份验证工作流程的问题

> ID：14589080
> 
> 赞同：6
> 
> 时间：2013-01-29T17:50:35.843
> 
> 标签：rest, symfony, backbone.js

我目前正在开发一个使用 Backbone.js 构建的网站。该站点在 Symfony 中使用 FOSRestBundle 构建了一个 RESTful API。开发进展顺利，直到我偶然发现一些与用户相关的票证。

据我了解，处理此类问题的最佳方法是使用基于令牌的系统，用户在批准登录后获得访问令牌。我将描述我目前对工作流程的看法，并在此过程中提出问题。更重要的是，如果我有误解，请纠正我。

首先，用户访问登录表单，然后用户输入凭据，并向服务器发送 AJAX 请求。据我了解，这一切都应该使用 SSL 处理，但是使用 Backbonejs，您不能简单地说应该使用 HTTPS 访问登录页面，因为 Backbone 是一个单页框架。那么这会迫使我在整个应用程序中使用 HTTPS 吗？

在下一步中，REST 服务器验证凭据并获得批准，然后 REST 服务器将访问令牌发送到客户端。这个令牌（在客户端）是保存在本地存储还是 cookie 中？

登录信息是否也存储在服务器上，以便 REST 服务器可以在一定时间后将用户注销？

现在，客户端将这个访问令牌与其他请求一起发送，以便服务器可以识别客户端，并批准或不批准请求。那么访问令牌也存储在 REST 服务器上？

最后，这就是聪明人所说的“oauth”，还是与它有关？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T00:31:32.463

让我们一次一个地回答你的问题。

> > 据我了解，这一切都应该使用 SSL 处理，但是使用 Backbonejs，您不能简单地说应该使用 HTTPS 访问登录页面，因为 Backbone 是一个单页框架。那么这会迫使我在整个应用程序中使用 HTTPS 吗？

好的，那里有很多东西要解压。让我们从 SSL/HTTPS 开始。HTTPS 是一种*协议*；换句话说，它定义了如何向/从服务器发送数据包。它与您的应用程序是单页还是多页无关；任何一种类型的站点都可以使用 HTTP 或 HTTPS。

现在，话虽如此，通过 HTTP 发送登录信息（或任何其他包含密码的内容）是一个非常糟糕的主意，因为它使“坏人”很容易窃取用户的密码。因此，无论您是在做单页应用程序还是多页应用程序，在发送登录信息时都应该始终使用 HTTPS。由于必须同时支持 HTTP 和 HTTPS 很痛苦，而且由于其他非登录数据也可能很敏感，所以许多人选择只通过 HTTPS 完成所有请求（但你*没有*。

因此，要回答您的实际问题，Backbone 根本不会强迫您使用 HTTPS 登录。保护你的用户密码是强迫你的。

> > 在下一步中，REST 服务器验证凭据并获得批准，然后 REST 服务器将访问令牌发送到客户端。这个令牌（在客户端）是保存在本地存储还是 cookie 中？

虽然任何给定的框架可能会有所不同，但绝大多数使用 cookie 将令牌保存在本地。由于各种原因，它们是处理这类事情的最佳工具。

> > 登录信息是否也存储在服务器上，以便 REST 服务器可以在一定时间后将用户注销？

您已经有了基本的正确想法，但是服务器并没有完全存储登录信息……它更像是服务器将用户登录并创建了一个“会话”。它为该会话提供一个 ID，然后每当用户发出新请求时，该会话 ID 都会随请求一起提供（因为这就是 cookie 的工作方式）。然后服务器可以说“哦，这是 Bob 的会话”并为 Bob 提供适当的内容。

> > 现在，客户端将这个访问令牌与其他请求一起发送，以便服务器可以识别客户端，并批准或不批准请求。那么访问令牌也存储在 REST 服务器上？

如果您正在运行两个单独的服务器，它们将不会神奇地进行通信；你必须让他们互相交谈。因此，如果您的整个应用程序只有一个（可能是 REST-ful）服务器，您的生活会更轻松。如果您不能，那么您的 REST 服务器将不得不在每次收到请求时询问您的其他服务器“嘿，告诉我有关会话*SESSION ID的信息”。*

> > 最后，这就是聪明人所说的“oauth”，还是与它有关？

有点，有点，不是真的。OAuth 是一种授权标准，因此它有点相关，但除非您的登录系统涉及一个完全独立的服务器，否则您没有理由使用它。你*可以*使用 OAuth 来解决您的“两台服务器，一台 REST-ful 另一台没有”的问题，但这可能是矫枉过正（并且不管它超出了我在这篇 Stack Overflow 帖子中可以解释的范围）。

希望有帮助。

# sql - 添加到存储在 sql 2005 中的 xml

> ID：14589083
> 
> 赞同：2
> 
> 时间：2013-01-29T17:50:43.107
> 
> 标签：sql, sql-server, xml, insert

我有一个 SQL Server 2005 数据库，其中有一个名为改进的表。

在 Improvements 中有一个名为 TransactionID 的字段和一个名为 Comments 的字段。字段 Comments 是一种 XML 数据类型，具有如下条目。

```
<Comment>
    <CreatedBy>Bob</CreatedBy>
    <CreatedDateTime>2009-08-24T11:36:13.020774+01:00</CreatedDateTime>
    <CreaterRole>Manager</CreaterRole>
    <CreationStage>INITIAL REVIEW</CreationStage>
    <CreationStatus>APPROVED</CreationStatus>
    <UserComment>Approved</UserComment>
</Comment>
<Comment>
    <CreatedBy>Bob</CreatedBy>
    <CreatedDateTime>2009-08-24T11:36:25.7240616+01:00</CreatedDateTime>
    <CreaterRole>Manager</CreaterRole>
    <CreationStage>CAPTURE</CreationStage>
    <CreationStatus>ACCEPTED</CreationStatus>
    <UserComment />
</Comment> 
```

我需要输入一个额外的条目：

```
 <Comment>
    <CreatedBy>Bob</CreatedBy>
    <CreatedDateTime>2013-01-29T11:36:25.7240616+01:00</CreatedDateTime>
    <CreaterRole>Manager</CreaterRole>
    <CreationStage>CLOSED</CreationStage>
    <CreationStatus>CLOSED</CreationStatus>
    <UserComment>Closed as agreed<UserComment />
 </Comment> 
```

其中 TransactionID =*交易编号。*

我在互联网上找到了许多使用 SET 修改条目的解决方案.....但无法弄清楚如何实际添加条目。

任何人都可以帮我解决这个问题吗？

提前谢谢了。

凯夫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:06:20.947

```
declare @TransactionID int
declare @Comment xml

set @TransactionID = 1
set @Comment = '
<Comment>
    <CreatedBy>Bob</CreatedBy>
    <CreatedDateTime>2013-01-29T11:36:25.7240616+01:00</CreatedDateTime>
    <CreaterRole>Manager</CreaterRole>
    <CreationStage>CLOSED</CreationStage>
    <CreationStatus>CLOSED</CreationStatus>
    <UserComment>Closed as agreed</UserComment>
</Comment>'

update improvements 
set Comments.modify('insert sql:variable("@Comment") as last into /')
where TransactionID = @TransactionID 
```

# asp.net-mvc-4 - 在 ASP.NET MVC 4 中保留模型

> ID：14589084
> 
> 赞同：2
> 
> 时间：2013-01-29T17:50:48.790
> 
> 标签：asp.net-mvc-4

我有一个 ASP.NET MVC 4 应用程序。我对 ASP.NET MVC 4 比较陌生。目前，我正在尝试构建一个基本的任务列表应用程序。

```
public ActionResult Create()
{
  var model = new TaskModel();
  return View("~/Views/Task.cshtml", model);
}

[HttpPost]
public ActionResult Create(TaskModel model)
{
  if (model.TaskName.Length == 0)
  {
     // Display error message
  }
  else 
  {
    // Save to database
    // Write success message
  }
  return View("~/Views/Task.cshtml", model);
} 
```

如果出现错误，我会在屏幕上显示错误消息。我的问题是，之前在视图中输入的值没有显示出来。整个视图是空白的。在这种情况下如何保留视图中的值？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:01:14.637

我为此使用 TempData。

```
public ActionResult Create()
{
  var model = new TaskModel();
  TempData["task"] = model;
  return View("~/Views/Task.cshtml", model);
}

[HttpPost]
public ActionResult Create()
{
  var task = (TaskModel)TempData["task"];
  UpdateModel(task);
  if (model.TaskName.Length == 0)
  {
     // Display error message
  }
  else 
  {
    // Save to database
    // Write success message
  }

  TempData["task"] = task;
  return View("~/Views/Task.cshtml", model);
} 
```

MVC 的工作方式与 WebForms 不同，因为没有“控件”的概念，您必须自己保留状态。如果您不想使用 TempData，另一种选择是使用 LosFormatter 将您的控件序列化为隐藏的 HTML 字段。这将在 ASP.NET WebForms 中复制 ViewState 的功能

# perl - 使用 perl 在字符串中查找子字符串

> ID：14589089
> 
> 赞同：-1
> 
> 时间：2013-01-29T17:51:06.193
> 
> 标签：perl

下面是代码

```
$string = "any text
Affected area :
menu

Feature to test :

diagnostics
";

$string1=rindex($string,':');
print "$string1\n";

$string2=substr($string,$string1+1);
print "$string2"; 
```

我可以使用上面的代码在“要测试的功能”之后找到字符串，但我想找到用于受影响区域的字符串，例如。菜单。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:39:55.833

我认为这是某种测试程序。这样做会更有意义吗？

```
use strict;
use warnings;

my $feature_to_test;
my $affected_area;
while ( my $line <DATA> ) {
    chomp $line;
    if ( $line =~ /^Affected area\s*:/i ) {
        for (;;) {  #Loop forever (until I tell you to stop i.e.)
            my $line = <DATA>;
            if ( $line !~ /^\s*$/ ) {
               $affected_area = $line;
               last;
            }
        }
    }
    if ( $line =~ /^Affected area\s*:/i ) {
        for (;;) {  #Loop forever (until I tell you to stop i.e.)
            my $line = <DATA>;
            if ( $line !~ /^\s*$/ ) {
               $affected_area = $line;
               last;
            }
        }
    }
    if ( $line =~ /^Feature to test\s*:/i ) {
        for (;;) {  #Loop forever (until I tell you to stop i.e.)
            my $line = <DATA>;
            if ( $line !~ /^\s*$/ ) {
               $feature_to_test = $line;
               last;
            }
        }
    }

}
else {
    print qq("Not a special line: "$line"\n);
}

__DATA__
any text
Affected area :
menu

Feature to test :

diagnostics 
```

这种方法的优点是它允许您逐行测试，而不是尝试一次解析整个记录。另外，它更好地模拟了文件的读取方式。

也可以用来`split`将长文本拆分成一个数组，您也可以逐行遍历：

```
use strict;
use warnings;

my $string = "any text
Affected area :
menu

Feature to test :

diagnostics
";
my @string_list = split /\n/, $string;  #Now, this is split line by line
for my $line ( @string_list ) {
    print "same logic as above...\n";
} 
```

这样做作为一个循环并在每一行中读取会使逻辑更清晰，更容易理解。它可能效率不高，但即使在经济型 PC 上，即使在 Perl 中读取数百万行文件也不会超过几秒钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:01:38.733

也许使用[积极的后视](http://www.regular-expressions.info/lookaround.html)和捕获的正则表达式在这里会有所帮助：

```
use strict;
use warnings;

my $string = "any text
Affected area :
menu

Feature to test :

diagnostics
";

my ($area) = $string =~ /(?<=area :\n)(.+)/;

print $area; 
```

输出：

```
menu 
```

# git - 跨所有分支的 Git 日志（甚至是远程分支）

> ID：14589090
> 
> 赞同：18
> 
> 时间：2013-01-29T17:51:07.930
> 
> 标签：git, git-log

我正在尝试以下

```
git log --before {2.days.ago} --after {14.days.ago} --all --stat 
```

但它似乎只给了我一个远程分支的日志。我想获取远程和本地分支的日志。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-29T18:29:57.310

```
git log --before {2.days.ago} --after {14.days.ago} --all --stat --branches=* --remotes=* 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-30T12:44:11.493

> 你能解释一下--all、--branches=* 和--remotes=* 的作用，以及--all 是否是多余的吗？

`--all`, 如[`git rev-list`](https://git-scm.com/docs/git-rev-list)or中所述[`git rev-parse`](https://git-scm.com/docs/git-rev-parse#_options_for_objects), --all 包括`--branches`or `--remotes`:

```
--all 
```

> 显示在 refs/ 中找到的所有 refs。

```
--branches[=pattern]
--tags[=pattern]
--remotes[=pattern] 
```

> 分别显示所有分支、标签或远程跟踪分支（即，分别在`refs/heads`、`refs/tags`或中找到的引用`refs/remotes`）。
> 
> 如果给定模式，则仅显示与给定 shell glob 匹配的引用。
> 如果模式不包含通配符（`?`、`*`或`[`），则通过附加 将其转换为前缀匹配`/*`。

参见插图[`t/t6018-rev-list-glob.sh`#L136-L138](https://github.com/git/git/blob/8d530c4d64ffcc853889f7b385f554d53db375ed/t/t6018-rev-list-glob.sh#L136-L138)：

```
test_expect_success 'rev-parse --exclude with --all' '
    compare rev-parse "--exclude=refs/remotes/* --all" "--branches --tags"
' 
```

由于请求了远程分支，这应该足够了：

```
git log --before {2.days.ago} --after {14.days.ago} --stat --branches --remotes 
```

# backbone.js - Backbone：集合没有通过 Require.js 传递到视图中

> ID：14589101
> 
> 赞同：3
> 
> 时间：2013-01-29T17:51:56.553
> 
> 标签：backbone.js, requirejs, amd

我正在重写一个试图使用 AMD 方法的 Backbone.js 应用程序。我已经下载了 AMD 版本的 Backbone 和 Underscore。我检查并调用了 jQuery、Backbone 和 Underscore。这是一个相当简单的项目，但由于某种原因，我的收藏不再传递给我的视图。我是 AMD 的新手。

这是我的模型：

```
define([
    'underscore',
    'backbone'
], function(_, Backbone) {
    var tableModel = Backbone.Model.extend({});
    return tableModel;
}); 
```

这是我的收藏：

```
define([
    'jquery',
    'underscore',
    'backbone',
    'models/tableModel'
],
function($, _, Backbone, tableModel) {
    var tablesCollection = Backbone.Collection.extend({
        url: this.url,  // passed into collection at runtime, so same code can process multiple sets of data
        model: tableModel,
        initialize: function(models, options) {
            if (options && options.url) {
                this.url = options.url;
            }
            this.fetch({
                success: function(data, options) {
                    if ($.isEmptyObject(data.models)) {
                        App.Collections.Tables.NoData(data);
                    }

                }
            });
        }
    });

    return tablesCollection;
}); 
```

这是我的看法：

```
define([
    'jquery',
    'underscore',
    'backbone',
    'models/tableModel',
    'collections/tablesCollection',
    'views/tableView'
],
function($, _, Backbone, tableModel, tablesCollection, tableView) {
    var tv = Backbone.View.extend({
        tagName: 'div',
        initialize: function() {
            console.log(this.collection);  // returns collection and undefined 
            this.collection.on('reset', this.render, this);  // errors: this.collection is undefined
        },
        render: function() {
            return this;
        }
    });

    return tv;
}); 
```

这里是视图和集合被实例化的地方：

```
define([
    'jquery',
    'underscore',
    'backbone',
    'models/tableModel',
    'collections/tablesCollection',
    'views/tablesView'
], function($, _, Backbone, tableModel, tablesCollection, tablesView) {
    var t = new tablesCollection(null, { url: 'main-contact'} );
    var tables = new tablesView({ collection: t, template: 'main-contact-template'});
    $('#web-leads').html(tables.render().el);

}); 
```

为什么我会被`function (){return c.apply(this,arguments)}`退回`console.log(tablesCollection)`？就像集合没有被传入一样。这可能是路径问题吗？我的项目由一个`js`文件夹构成，其中包含名为`collections`和`models`的子文件夹`views`。如果我`console.log(this)`，我得到： ![在此处输入图像描述](../Images/0284e1b3c16b0fec8e6a5caeb64f331f.png)

我的数据在那里，但这是我需要的吗？为什么我尝试收藏时没有得到我的收藏`console.log`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T17:55:06.243

不要`tablesCollection`直接使用。使用`this.collection`. 你已经用它初始化了视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:10:19.293

您看到的是函数 tablesCollection，即 Backbone.Collection.extend(...) 函数。

*函数*tablesCollection可能很好地传递到视图中。但是，您需要在将对象记录到控制台之前实例化对象，例如 new tablesCollection(null, {url: 'url'})，否则将显示扩展包装函数，这就是您现在所看到的。

# javascript - 将变量传递给表单的值属性

> ID：14589103
> 
> 赞同：0
> 
> 时间：2013-01-29T17:51:59.290
> 
> 标签：javascript, forms, variables

对不起，这可能是非常基本的，但我想将一个变量从一个页面传递到另一个页面。我有一个包含名称列表的页面，下一页是一个表格。表单上的输入之一是名称。我想用从名称列表中单击的名称填充此名称输入的值。

例如，这是单击时链接到表单的名称列表：

```
<a href="form.html" id="John Doe">John Doe</a>
<a href="form.html" id="John Smith">John Smith</a>
<a href="form.html" id="Jane Doe">Jane Doe</a> 
```

form.html 看起来像这样：

```
<form>
<input name="name" type="text" value=""/>
</form> 
```

我希望文本输入的值根据单击的名称而改变。我更喜欢用 javascript 来做，但不管你们认为是最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T17:53:45.777

您必须在查询字符串中传递它：

```
<a href="form.html?name=John+Doe" id="John Doe">John Doe</a>
<a href="form.html?name=John+Smith" id="John Smith">John Smith</a>
<a href="form.html?name=Jane+Doe" id="Jane Doe">Jane Doe</a> 
```

然后，在 中`form.html`，使用以下命令获取名称：

```
var name = (window.location.search.match(/name=([^&]+)/) || [])[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T17:58:16.700

您可以使用查询字符串，使用 Javascript 对其进行解析，然后将值放入您的输入中。

在您的文本输入中添加一个 id 或其他内容，以供您参考您的输入。

```
function getQueryVariable(variable) {
var query = window.location.search.substring(1);
var vars = query.split('&');
for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    if (decodeURIComponent(pair[0]) == variable) {
        return decodeURIComponent(pair[1]);
    }
}
console.log('Query variable %s not found', variable);
}

var name = getQueryVariable('name');

document.getElementById('myInput').value = name; 
```

# c++ - 你如何使用 shallow_array_adaptor

> ID：14589106
> 
> 赞同：1
> 
> 时间：2013-01-29T17:52:25.447
> 
> 标签：c++, pointers, boost

我正在尝试与仅使用原始指针来保存数据的软件进行交互。`shallow_array_adaptor` 我非常有信心，如果我制作包装向量实例，我可以避免使用问题，`const`即使文档`shallow_array_adaptor`声称它“非常危险！”。

我想做这样的事情：

```
using namespace boost::numeric::ublas
void f(vector<double>& acc, double* arr){ 
    // assume acc is already correctly sized, and arr is correctly allocated

   // this syntax is not correct, I'm pretty sure I'll have to construct
   // the instance of shallow_array_adaptor, but don't know how  to
   // get it to the vector's constructor 
   const vector< double , shallow_array_adaptor< double > > view( arr );

    acc+=view; // by wrapping the raw pointer, I get to use nice syntax here.
} 
```

无需复制存储在`arr`.

我不确定我必须做什么来构造向量，以便它使用给定的指针作为存储。

# c++ - ISO C++ 禁止指针和整数之间的比较 [-fpermissive]

> ID：14589111
> 
> 赞同：0
> 
> 时间：2013-01-29T17:52:49.337
> 
> 标签：c++, iso

**编码**

```
int cycle_length(int i, int j) {
    int cycleLength = 0;
    for (int k = i; k <= j; k++) {
        cout << algorithm(k) << endl;
        if (algorithm(k) > cycle_length) {
            cycleLength = algorithm(k);
        }
    }
    return cycleLength;
} 
```

`ISO C++ forbids comparison between pointer and integer [-fpermissive]`

我在这一行得到了这个错误`if ( algorithm(k) > cycle_length)`。

但是，相同的代码如何在`main()`?? 这个错误是什么意思？？？

**添加** 的算法是一个接受整数输入并返回整数的函数。

```
int algorithm(int number1) {
    int counter = 1, number = number1;
    do {
        if (number % 2 == 0) {
            number = number / 2;
            counter++;
        } else {
            number = (3 * number) + 1;
            counter++;
        }
    } while (number != 1);

    return counter;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-29T17:57:09.067

您将函数的名称与几乎相同名称的局部变量混淆：

```
int cycle_length(int i, int j)
{
    int cycleLength 
```

您的函数被调用`cycle_length`，您的变量被调用`cycleLength`- 但您正在`cycle_length`进一步使用。

错误信息有点奇怪，因为编译器没有做“比较变量名和函数名，看看是否有相似的，然后建议你可能只是输入错误”——它只是说“嗯，你是将函数指针 [从函数名称中得到的] 与整数进行比较，这不成立！”

# mysql - Rails 中的电子邮件激活

> ID：14589112
> 
> 赞同：1
> 
> 时间：2013-01-29T17:53:00.250
> 
> 标签：mysql, ruby-on-rails, activation

我一直在查看 Rails 上的电子邮件激活示例，大多数示例只有一个用于激活令牌的列，并在其用户表中确认。我不确定，但我认为这不是一个好主意，因为当用户被激活时，几乎这两个列似乎都是浪费。我正在考虑进行激活的方式是拥有一个名为 Activation 的单独模型，该模型将是一种单向`have_one :user`关联，我会将用户在我的站点中的角色设置为“PENDING”或类似的东西。激活表将为每个用户保存一个激活令牌。然后将使用激活令牌生成一个链接，并向用户发送一封包含类似内容的电子邮件`www.mysite.com/activate?token='some_really_long_hash'`. 单击链接后，我的用户角色将设置为“会员”或类似的东西。这看起来是个好主意吗？我无法想象以这种方式激活的任何陷阱。建议？注释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:01:36.633

听起来您正处于在用户模型上实现状态机设计模式的介绍阶段，不，这不是一种糟糕的设计方法。它只是比大多数人需要的复杂。

我认为[状态机插件](https://github.com/pluginaweek/state_machine)可能是您希望执行的方法类型。显然，这可能超出了您的预期，但方法是相同的。

另请查看这些帖子：

*   [为什么开发人员应该被强制输入状态机](http://www.shopify.com/technology/3383012-why-developers-should-be-force-fed-state-machines#axzz2JO9kDxkN)
*   [为什么开发人员从不使用状态机](http://www.skorks.com/2011/09/why-developers-never-use-state-machines/)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T17:59:43.283

最直接的方法是生成一个随机令牌并将其保存到用户或成员记录的列中。它不必“非常长”，20 个随机字符就足够了，因为猜测的可能性很小，永远不会发生。

通常，令牌仅用于验证用户一次，但如果用户随后单击电子邮件，如果它仍然重定向回他们的个人资料，那就太好了。

通常，用户会切换到“已验证”或类似的状态，即存储在单独列中的状态标志。这保留了它们的初始成员类型，这可能是许多值之一。这就是您经常看到`validated_at`字段或`banned_until`字段的原因。

# gcc - gcc在安装FFmpeg时无法创建可执行文件

> ID：14589114
> 
> 赞同：7
> 
> 时间：2013-01-29T17:53:02.610
> 
> 标签：gcc, ffmpeg

我正在尝试直接从源代码安装 FFmpeg，但我不断收到此错误：

```
gcc is unable to create an executable file.
If gcc is a cross-compiler, use the --enable-cross-compile option.
Only do this if you know what cross compiling means.
C compiler test failed.

If you think configure made a mistake, make sure you are using the latest
version from Git.  If the latest version fails, report the problem to the
ffmpeg-user@ffmpeg.org mailing list or IRC #ffmpeg on irc.freenode.net.
Include the log file "config.log" produced by configure as this will help
solving the problem. 
```

任何人都可以帮忙吗？此外， yum install ffmpeg 不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T19:37:36.110

显然，由于我掌握的信息有限，您至少需要安装`gcc`才能编译 ffmpeg。有关说明，请参阅[如何在 CentOS 上编译 FFmpeg](https://ffmpeg.org/trac/ffmpeg/wiki/CentosCompilationGuide)。它是为 CentOS 设计的，但应该适用于 RHEL 和 Fedora。

或者，您可以简单地使用[ffmpeg 的静态构建](http://ffmpeg.org/download.html#LinuxBuilds)而不是编译，但它没有编译提供的自定义优势。

请注意，堆栈溢出仅限于编程问题和讨论。

# java - 自定义按钮在 Mac 上不起作用（ButtonUI）

> ID：14589119
> 
> 赞同：2
> 
> 时间：2013-01-29T17:53:17.583
> 
> 标签：java, macos, swing, jbutton, look-and-feel

我有一个应用程序，它在所有地方都使用自定义按钮来显示文本和图标。适用于 windows 和 linux，但现在 OSX 用户抱怨。文本不显示在 Mac 上，只是“...”。代码看起来很简单，但我对macs一无所知。我怎样才能解决这个问题？

测试用例：

```
package example.swingx;
import example.utils.ResourceLoader;
import com.xduke.xlayouts.XTableLayout;    
import javax.swing.*;
import javax.swing.plaf.ComponentUI;
import java.awt.*;
import java.awt.event.ActionEvent;

public class SmallButton extends JButton {
    private static ComponentUI ui = new SmallButtonUI();
    public SmallButton() {
        super();
        /*  final RepaintManager repaintManager = RepaintManager.currentManager(this);
        repaintManager.setDoubleBufferingEnabled(false);
        setDebugGraphicsOptions(DebugGraphics.FLASH_OPTION);*/
    }
    public SmallButton(AbstractAction action) {
        super(action);
    }
    public SmallButton(String text) {
        super(text);
    }
    public SmallButton(Icon icon) {
        super(icon);
    }
    public void updateUI() {
        setUI(ui);
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final JPanel buttonPanel = new JPanel(new XTableLayout());
        SmallButton firstSmallButton = new SmallButton("One");
        SmallButton secondSmallButton = new SmallButton("Two");
        SmallButton thirdSmallButton = new SmallButton();

        ImageIcon cameraIcon = (ImageIcon) ResourceLoader.getIcon("camera");
        SmallButton fourth = new SmallButton();

        fourth.setAction(new AbstractAction() {
            public void actionPerformed(ActionEvent e) {
                System.out.println("Fourth button pressed!");
            }
        });
        fourth.setIcon(cameraIcon);

        buttonPanel.add(firstSmallButton, "+");
        buttonPanel.add(secondSmallButton, "+");
        buttonPanel.add(thirdSmallButton, "+");
        buttonPanel.add(fourth, "+");

        final Container container = frame.getContentPane();
        container.add(buttonPanel);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

用户界面：

```
package example.swingx;

import javax.swing.*;
import javax.swing.plaf.ComponentUI;
import javax.swing.plaf.basic.BasicButtonUI;
import java.awt.*;

public class SmallButtonUI extends BasicButtonUI {
    private static final Color FOCUS_COLOR = new Color(0, 0, 0);
    private static final Color BACKGROUND_COLOR = new Color(173, 193, 226);
    private static final Color SELECT_COLOR = new Color(102, 132, 186);
    private static final Color DISABLE_TEXT_COLOR = new Color(44, 44, 61);
    private static final Insets DEFAULT_SMALLBUTTON_MARGIN = new Insets(2, 4, 2, 4);

    private final static SmallButtonUI smallButtonUI = new SmallButtonUI();

    public static ComponentUI createUI(JComponent component) {
        return smallButtonUI;
    }
    protected Color getSelectColor() {
        return SELECT_COLOR;
    }
    protected Color getDisabledTextColor() {
        return DISABLE_TEXT_COLOR;
    }
    protected Color getFocusColor() {
        return FOCUS_COLOR;
    }

    public void paint(Graphics g, JComponent c) {
        ((Graphics2D) g).setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        super.paint(g, c);
    }

    protected void paintButtonPressed(Graphics graphics, AbstractButton button) {
        if (button.isContentAreaFilled()) {
            Dimension size = button.getSize();
            graphics.setColor(getSelectColor());
            graphics.fillRect(0, 0, size.width, size.height);
        }
    }

    public Dimension getMinimumSize(JComponent component) {
        final AbstractButton button = ((AbstractButton) component);

        // Handle icon buttons:
        Icon buttonIcon = button.getIcon();
        if (buttonIcon != null) {
            return new Dimension(
                    buttonIcon.getIconWidth(),
                    buttonIcon.getIconHeight()
            );
        }

        // Handle text buttons:
        final Font fontButton = button.getFont();
        final FontMetrics fontMetrics = button.getFontMetrics(fontButton);
        final String buttonText = button.getText();
        if (buttonText != null) {
            final int buttonTextWidth = fontMetrics.stringWidth(buttonText);
            return new Dimension(buttonTextWidth + 15,
                    fontMetrics.getHeight() + 5);
        }
        return null;
    }

    protected void installDefaults(AbstractButton button) {
        super.installDefaults(button);
        button.setMargin(DEFAULT_SMALLBUTTON_MARGIN);
        button.setBackground(getBackgroundColor());
    }
    private Color getBackgroundColor() {
        return BACKGROUND_COLOR;
    }
    public Dimension getPreferredSize(JComponent component) {
        return getMinimumSize(component);
    }
    public Dimension getMaximumSize(JComponent component) {
        return super.getMinimumSize(component);
    }
    public SmallButtonUI() {
        super();
    }
} 
```

编辑：调试后，似乎 getMinimumSize() 在两个平台上都是相同的。此外，当我停在使用 Graphics 的任何地方时，mac 的 transY 值似乎为 47，而 linux 的值为 0。这 47 似乎也输入到剪辑区域中。哪里可以设置？\

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T08:03:34.697

您对首选尺寸的计算不正确。

`BasicButtonUI`用途`SwingUtilities.layoutCompoundLabel`，[在这里](https://stackoverflow.com/a/3597688/230513)检查。在标签中，如果字符串太长，则会添加省略号，但通常会调整按钮的大小以适合其整个文本。

如果无法更好地了解您的上下文，我将使用 a [`sizeVariant`](https://stackoverflow.com/a/2900157/230513)，如下所示。我还展示了一个`BasicButtonUI`使用较小的派生的简单示例`Font`。[UI 菜单](https://stackoverflow.com/a/11949899/230513)可以与[Quaqua](http://www.randelshofer.ch/quaqua/)结合使用进行测试。

![图片](../Images/de44fbcf3e4b96f44c851c9b00105a96.png)

```
import java.awt.Color;
import java.awt.Component;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.List;
import javax.swing.AbstractButton;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JToolBar;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.plaf.basic.BasicButtonUI;

/**
 * @see https://stackoverflow.com/a/14599176/230513
 * @see https://stackoverflow.com/a/11949899/230513
 */
public class Test {

    private void display() {
        JFrame f = new JFrame("Test");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setBackground(new Color(0xfff0f0f0));
        f.setLayout(new GridLayout(0, 1));
        f.add(createToolBar(f));
        f.add(variantPanel("mini"));
        f.add(variantPanel("small"));
        f.add(variantPanel("regular"));
        f.add(variantPanel("large"));
        JPanel customPanel = new JPanel();
        customPanel.add(createCustom("One"));
        customPanel.add(createCustom("Two"));
        customPanel.add(createCustom("Three"));
        f.add(customPanel);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    private static JPanel variantPanel(String size) {
        JPanel variantPanel = new JPanel();
        variantPanel.add(createVariant("One", size));
        variantPanel.add(createVariant("Two", size));
        variantPanel.add(createVariant("Three", size));
        return variantPanel;
    }

    private static JButton createVariant(String name, String size) {
        JButton b = new JButton(name);
        b.putClientProperty("JComponent.sizeVariant", size);
        return b;
    }

    private static JButton createCustom(String name) {
        JButton b = new JButton(name) {

            @Override
            public void updateUI() {
                super.updateUI();
                setUI(new CustomButtonUI());
            }
        };
        return b;
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().display();
            }
        });
    }

    private static class CustomButtonUI extends BasicButtonUI {

        private static final Color BACKGROUND_COLOR = new Color(173, 193, 226);
        private static final Color SELECT_COLOR = new Color(102, 132, 186);

        @Override
        protected void paintText(Graphics g, AbstractButton b, Rectangle r, String t) {
            super.paintText(g, b, r, t);
            g.setColor(SELECT_COLOR);
            g.drawRect(r.x, r.y, r.width, r.height);
        }

        @Override
        protected void paintFocus(Graphics g, AbstractButton b,
            Rectangle viewRect, Rectangle textRect, Rectangle iconRect) {
            super.paintFocus(g, b, viewRect, textRect, iconRect);
            g.setColor(Color.blue.darker());
            g.drawRect(viewRect.x, viewRect.y, viewRect.width, viewRect.height);
        }

        @Override
        protected void paintButtonPressed(Graphics g, AbstractButton b) {
            if (b.isContentAreaFilled()) {
                g.setColor(SELECT_COLOR);
                g.fillRect(0, 0, b.getWidth(), b.getHeight());
            }
        }

        @Override
        protected void installDefaults(AbstractButton b) {
            super.installDefaults(b);
            b.setFont(b.getFont().deriveFont(11f));
            b.setBackground(BACKGROUND_COLOR);
        }

        public CustomButtonUI() {
            super();
        }
    }

    private static JToolBar createToolBar(final Component parent) {
        final UIManager.LookAndFeelInfo[] available =
            UIManager.getInstalledLookAndFeels();
        List<String> names = new ArrayList<String>();
        for (UIManager.LookAndFeelInfo info : available) {
            names.add(info.getName());
        }
        final JComboBox combo = new JComboBox(names.toArray());
        String current = UIManager.getLookAndFeel().getName();
        combo.setSelectedItem(current);
        combo.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                int index = combo.getSelectedIndex();
                try {
                    UIManager.setLookAndFeel(
                        available[index].getClassName());
                    SwingUtilities.updateComponentTreeUI(parent);
                } catch (Exception e) {
                    e.printStackTrace(System.err);
                }
            }
        });
        JToolBar bar = new JToolBar("L&F");
        bar.setLayout(new FlowLayout(FlowLayout.LEFT));
        bar.add(combo);
        return bar;
    }
} 
```

# c++ - 在添加到数组之前检查重复，使用指针

> ID：14589123
> 
> 赞同：0
> 
> 时间：2013-01-29T17:53:34.060
> 
> 标签：c++

我有一个全局静态字符串 str[MAX] = { "aloha" , "behold", "donkey", "key", "joke", "none", "quack", "orange"};

这里的size是随机生成的，比如size=3，会打印出“Behold”、“donkey”和“none”。在添加到数组之前，我想检查它是否在里面。如果“看哪”、“驴”、“无”在数组内，如果我得到另一个词“驴”，它将拒绝并返回循环并生成另一个，因此我使用 i--

我不知道哪里出错了，希望有人能启发我。

谢谢。这是代码。

```
typedef char* Strings;

function example (Strings *s, int size)
{
    char *q;

    bool check;

    q = new char[MAX];

    *s = &q[0];
    for (int i = 0; i < size; i++)
    {
        k = rand () % 8;
        if (*s == '\0')
            *s = Str[k];
        else
        {
            check = compare (s, Str[k]);

            if (check == 1)
                *s = Str[k];
            else
                i--;
        }
        ++s;
    }

    cout << endl;
}

bool compare (Strings *s, char *str)
{
    while (*s != '\0')
    {
        if (strcmp (*s, Str))
            return true;
        else
            return false;
        ++s;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T20:47:24.080

如果你坚持使用指针和数组......

首先，编写`char ** find( const char * what, const char ** begin, const char ** end )`函数，搜索范围从`begin`到`end`直到它遇到一个等于`what`或直到它到达的元素`end`。元素的平等可以由`strcmp`功能决定。

第二，使用它。在你选择了一个之后`random_string`，`find`在你的`output_array`.

像那样：

```
const size_t Str_count = 8;
const char * Str[ Str_count ] =
{
    "aloha",
    "behold",
    "donkey",
    "key",
    "joke",
    "none",
    "quack",
    "orange"
};

const char **
find( const char * what, const char ** begin, const char ** end )
{
    while( begin != end )
    {
        if( !strcmp( what, *begin ) )
            break;

        begin++;
    }

    return begin;
}

int
generate( char ** output_array, size_t size )
{
    if( size > Str_count )
    {
        // infinite loop would occur
        return 1;
    }

    size_t i = 0;

    while( i < size )
    {
        const char * random_string = Str[ rand() % Str_count ]; // random index in [0-7] I suppose...

        // if we did not encounter the same string within the output_array
        if(    &output_array[ size ]
            == find
               (
                   random_string,
                   ( const char ** ) output_array,
                   ( const char ** ) &output_array[ size ]
               )
          )
        {
            // put the string in there
            output_array[ i ] = new char[ strlen( random_string ) ];
            strcpy( output_array[ i ], random_string );

            ++i;
        }
    }

    return 0;
} 
```

这行得通，但我应该警告你：拥有这样的全局变量通常被认为是“糟糕的编程风格”。此外，这并不是真正的 C++ 方式，因为它是纯 C 代码。

# ruby-on-rails-3 - 显示关联记录的计数

> ID：14589124
> 
> 赞同：1
> 
> 时间：2013-01-29T17:53:38.103
> 
> 标签：ruby-on-rails-3

作为我的站点管理员的一部分，我需要偶尔更新项目类别以反映不断变化的用户需求。

在我的`show method`(CategoriesController) 中，我有以下代码：

```
@projects = Project.count.where(:project.category_id => :id) 
```

我的控制器如下所示：

```
class ProjectCategory < ActiveRecord::Base
  attr_accessible :project_category
  belongs_to :project
end 
```

我似乎无法让它填充每个类别的所有项目的数量。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:04:31.823

你应该换行

```
@projects = Project.count.where(:project.category_id => :id) 
```

到

```
@projects = Project.where(:project.category_id => :id).count 
```

# game-engine - 如何在 Blender 中更改重力轴/方向

> ID：14589125
> 
> 赞同：2
> 
> 时间：2013-01-29T17:53:38.473
> 
> 标签：game-engine, game-physics, blender, bulletphysics

我正在 Blender Game Engline 中制作视频游戏，并且希望能够调整重力拉动物体的方向。我可以在脚本中更改[场景 Z 重力](http://www.blender.org/documentation/blender_python_api_2_65_9/bge.types.html#bge.types.KX_GameObject)，但这是沿 Z 轴的一维。

如果能够设置 X、Y 和 Z 重力，或者让所有东西同时围绕原点（或任意点）旋转，我会很好。

如果我可以让飞机施加重力或力场并让它围绕中心以设定的距离旋转（整个游戏世界被包裹在一个球体中），我也可以构建一个系统。

基本上，我希望能够从 python 脚本中自动对所有动态对象施加力，而无需 . 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T12:19:54.940

我认为您正在寻找[bge.constraints.setGravity(x, y, z)](http://www.blender.org/documentation/blender_python_api_2_65_10/bge.constraints.html?highlight=gravity#bge.constraints.setGravity) 来设置重力。

而这个：[bge.logic.getCurrentScene().gravity](http://www.blender.org/documentation/blender_python_api_2_65_10/bge.types.KX_Scene.html?highlight=gravity#bge.types.KX_Scene.gravity)来获得实际的重力。据此，您应该计算对象的理想旋转

# arrays - 在 actionscript 3 中需要一些数组帮助

> ID：14589128
> 
> 赞同：0
> 
> 时间：2013-01-29T17:53:48.410
> 
> 标签：arrays, actionscript-3

我对数组的概念很陌生……所以我需要一些帮助来理解和执行它……

所以我有5个按钮...

周一至周五

现在，当有人按下其中一个按钮时，我希望程序仅跟踪按下的那一天..有人可以逐步解释我该怎么做以及为什么吗？

我正在使用 flash actionscript 3 ..这几乎是我唯一知道该怎么做的事情...我已经尝试了一些 onlint tuts 但它们不是很清楚

```
var days: Array ["mon", "tues", "wed", "thurs", "fri"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:19:22.757

您的数组在您的帖子中创建错误。试试这个：

```
var days:Array = ["mon", "tues", "wed", "thurs", "fri"]; 
```

或者你也可以这样创建它，使用 Array 类的 push() 方法：

```
var days:Array = new Array();
days.push( 'mon');
days.push( 'tues');
days.push( 'weds');
days.push( 'thurs');
days.push( 'fri'); 
```

在您的帖子中跟踪数组的值：

```
trace( days[0] ); // returns "mon"
trace( days[1] ); // returns "tues"
trace( days[2] ); // returns "wed"
trace( days[3] ); // returns "thurs"
trace( days[4] ); // returns "fri" 
```

数组的内容存储在数组的“索引”中。数组的索引总是从 0 开始。

数组有一个长度。空数组的长度为 0。如果数组中至少包含一项，则长度为 1，并随着您添加更多项而增加。要遍历您的数组以获取值，请执行以下操作：

```
for(var i:int = 0; i < days.length; i++)
{
    trace( days[i] );
} 
```

数组是任何编程语言的强大且必不可少的部分。您可以从数组中删除项目、添加项目、删除特定索引处的特定项目、按名称删除项目、组合数组等等。您将从查看此[链接](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html)并研究 Array 类的属性和方法中受益。一旦您掌握了如何操作 Array 的窍门，您将永远不会在没有它们的情况下生存！

有很多方法可以将按钮与特定的数组索引相关联。**Dr.Denis McCracleJizz**提供的答案是一种方式，但如果您像您所说的那样对 AS3 不熟悉，那么它可能看起来有点让人不知所措，因为它使用了您可能还不熟悉的几个概念。让我看看我是否可以简化一下，尽管这会使代码更冗长：

```
mondayButton.addEventListener( MouseEvent.CLICK, onClickDayButton );
tuesdayButton.addEventListener( MouseEvent.CLICK, onClickDayButton );

function onClickDayButton( e:MouseEvent ):void
{
    if( e.target.name == 'mondayButton')
    {
        trace( days[0] );
    }
    else if( e.target.name == 'tuesdayButton')
    {
        trace( days [1] );
    }

    // and so on...
} 
```

如果您熟悉对象，则可以为每个按钮创建一个对象，该对象同时包含按钮和按钮 ID，并将它们存储在数组中：

```
var days:Array = ["mon", "tues", "wed", "thurs", "fri"];

var dayButtonArray:Array = new Array();

var mondayButtonObject:Object = new Object();
mondayButtonObject.button = mondayButton;
mondayButtonObject.id = 0;
dayButtonArray.push( mondayButtonObject );

var tuesdayButtonObject:Object = new Object();
tuesdayButtonObject.button = tuesdayButton;
tuesdayButtonObject.id = 1;
dayButtonArray.push( tuesdayButtonObject );

// and like above, the rest of the days here

// then loop through them and set the mouseEvent

for(var i:int = 0; i < dayButtonArray.length; i++)
{
   dayButtonArray[i].button.addEventListener( MoouseEvent.CLICK, onClickDayButton );
}

// and the function each button calls to

function onClickDayButton( e:MouseEvent ):void
{
    trace( days[ evt.target.id ] );
} 
```

您可以通过完全跳过 days 数组并将与按钮关联的日期添加到 dayButtonArray 而不是 id 来进一步简化上面的对象方法：

```
var dayButtonArray:Array = new Array();

var mondayButtonObject:Object = new Object();
mondayButtonObject.button = mondayButton;
mondayButtonObject.day = "monday";
dayButtonArray.push( mondayButtonObject );

var tuesdayButtonObject:Object = new Object();
tuesdayButtonObject.button = tuesdayButton;
tuesdayButtonObject.day = "tuesday";
dayButtonArray.push( tuesdayButtonObject );

// and like above, the rest of the days here

// then loop through them and set the mouseEvent

for(var i:int = 0; i < dayButtonArray.length; i++)
{
   dayButtonArray[i].button.addEventListener( MoouseEvent.CLICK, onClickDayButton );
}

// and the function each button calls to

function onClickDayButton( e:MouseEvent ):void
{
    trace( evt.target.day );
} 
```

现在变得像**Denis McCracleJizz 博士的**回答一样复杂。他的绝对值得一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:30:24.600

您的数组是一个项目列表，因此您的数组由一周中的几天组成。您可以使用这样的索引来访问它们。

```
trace(days[0])
//Outputs: mon

trace(days[3])
//Outputs: thurs 
```

现在对于您的按钮，有两种方法可以做到这一点，一种更复杂的干净，另一种工作得一样好，更简单。

在您的按钮上添加事件侦听器，以便当您单击第一个事件侦听器时，您可以使用 days[0] 跟踪天数数组的第一个元素

真正的方法是这样。

```
var days: Array ["mon", "tues", "wed", "thurs", "fri"];
var buttons: Array = [ stage.getChildByName("mondayButton"), stage.getChildByName("tuesdayButton") ];
//you need buttons name 'mondayButton' in your stage or this will crash.

//then somewhere in your program you add event listener to all the buttons in your array like so
for(var i:int =0; i < buttons.Length; i++){
     var myButton:Button = buttons[i];
     myButton.AddEventListener(onButtonClicked,Event.Mouse_Click);
}

public onButtonClicked(MouseEvent e):void{
    var myClickedButton:Button = (e.target as Button);
    //e.target is who sends the event, in this case its your buttons
    //next you look what position this button takes in your button array and get get
    //the day in the array from its index
    var index:int = buttons.indexOf(myClickedButton);
    trace(days[index]);
} 
```

请注意，此代码是从内存中编写的，请勿复制粘贴。这是做你想做的事情的更“复杂”的方法。希望这可以帮助 ：）

# android - 在android中获取当前位置时出现致命异常

> ID：14589130
> 
> 赞同：0
> 
> 时间：2013-01-29T17:53:50.063
> 
> 标签：android, gps, android-location

我正在创建一个 android 应用程序，我必须在其中根据纬度和经度获取当前的城市和国家/地区名称。但是程序崩溃并出现致命错误异常。我正在使用以下代码：

```
public class MainActivity extends Activity {

    LocationManager mlocManager;
    LocationListener mlocListener;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void getLoc(View v)
    {
        mlocManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        mlocListener = new MyLocationListener();

        mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mlocListener);
    }

    private class MyLocationListener implements LocationListener {

        @Override
        public void onLocationChanged(Location loc) {
            loc.getLatitude();
            loc.getLongitude();
            Address mAddresses = null;

            Geocoder gcd = new Geocoder(getApplicationContext(),
                    Locale.getDefault());
            try {
                mAddresses = (Address) gcd.getFromLocation(loc.getLatitude(),
                        loc.getLongitude(), 1);

            } catch (IOException e) {
                e.printStackTrace();

            }

            @SuppressWarnings("unchecked")
            String cityName = (mAddresses != null) ? ((List<Address>) mAddresses).get(0)
                    .getLocality() : TimeZone.getDefault().getID();
            @SuppressWarnings("unchecked")
            String countryName = (mAddresses != null) ? ((List<Address>) mAddresses).get(0)
                    .getCountryName() : Locale.getDefault().getDisplayCountry()
                    .toString();

            TextView tv = (TextView) findViewById(R.id.textView1);
            tv.setText("City Name: "+cityName+ " Country Name: "+countryName);

    //      mCurrentSpeed.setText(loc.getSpeed());
        }
} 
```

这是LogCat：

```
01-29 22:49:12.007: E/AndroidRuntime(12958): FATAL EXCEPTION: main
01-29 22:49:12.007: E/AndroidRuntime(12958): java.lang.ClassCastException: java.util.ArrayList
01-29 22:49:12.007: E/AndroidRuntime(12958):    at com.example.gpstest.MainActivity$MyLocationListener.onLocationChanged(MainActivity.java:56)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.location.LocationManager$ListenerTransport._handleMessage(LocationManager.java:227)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.location.LocationManager$ListenerTransport.access$000(LocationManager.java:160)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.location.LocationManager$ListenerTransport$1.handleMessage(LocationManager.java:176)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.os.Looper.loop(Looper.java:123)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at android.app.ActivityThread.main(ActivityThread.java:3687)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at java.lang.reflect.Method.invokeNative(Native Method)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at java.lang.reflect.Method.invoke(Method.java:507)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
01-29 22:49:12.007: E/AndroidRuntime(12958):    at dalvik.system.NativeStart.main(Native Method)
01-29 22:49:19.199: I/Process(12958): Sending signal. PID: 12958 SIG: 9 
```

有人可以帮我解决这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T17:56:11.153

您应该简单地声明`mAddresses`为列表：

```
List<Address> mAddresses = null; 
```

`Address`并删除您在单个和之间来回投射的位置`List<Address>`。[`getFromLocation()`](https://developer.android.com/reference/android/location/Geocoder.html#getFromLocation%28double,%20double,%20int%29)已经返回 a `List<Address>`，这样您就不会创建 ClassCastExceptions。

# iphone - iOS 如何在 iPhone Game Center 应用程序中实现抽屉？

> ID：14589132
> 
> 赞同：1
> 
> 时间：2013-01-29T17:53:58.150
> 
> 标签：iphone, uitableview, uiscrollview, game-center

我想实现一个在 iPhone Game Center 应用程序中运行的抽屉。当你拉一个`UITableView`然后假设我们已经到达桌子的顶部有这个抽屉滑动显示更多的内容。

我在这里尝试了一些解决方案，它们都可以工作，但我无法重新创建与 Game Center 示例中相同的功能。我试图在`UITableView`里面嵌入一个`UIScrollView`- 这个滚动视图顶部有一个视图，它扮演抽屉角色，下面有一个 tableView。我`UIScrollViewDelegate`为我的大 scrollView 和 tableView 设置了，并设法同步了两者的 contentOffsets。我为我的大滚动视图禁用了滚动条，所以我只能从我的 tableView 中看到滚动条。

然后我尝试将 tableView 设置为整个视图的子视图并设置另一个视图 - 抽屉视图作为同一视图的子视图，并再次使用`UIScrollViewDelegate`tableView 来调整两个视图的框架。

两种解决方案都可以，但这不是我想要的。我认为这两种解决方案的最大缺陷是，当我拉动我的 tableView 以显示抽屉时，我可以清楚地看到我没有与我的 tableView scrollView 交互，因为在整个拖动过程中滚动条保持在同一位置的顶部。当抽屉完全展开时，我现在可以与 tableView scrollView 交互（tableView 内容滚动和滚动条正在移动）

如果您查看附加的图片，您可以看到 Game Center 应用程序中的滚动条在抽屉展开时正在移动。就像抽屉是 tableView 的滚动视图的一部分，但是当完全展开时停止移动，如果我继续拉这个 tableView，我会在 tableView 和抽屉之间获得更多空间。如果您将 tableView 向上推以隐藏抽屉，则滚动条会下降。

我想实现一个在 iPhone Game Center 应用程序中运行的抽屉。当你拉一个`UITableView`然后假设我们已经到达桌子的顶部有这个抽屉滑动显示更多的内容。

我想在 Game Center 中复制这样的 viewController。如果有人知道该怎么做，请分享解决方案。

您可以在此处查看屏幕截图：

[http://i.stack.imgur.com/O44IS.png](http://i.stack.imgur.com/O44IS.png)

[http://i.stack.imgur.com/qDf7v.png](http://i.stack.imgur.com/qDf7v.png)

谢谢

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:20:43.453

ViewController 必须实现`UIScrollViewDelegate`并且在`scrollViewDidScroll`方法内部您必须进行一些计算。下面的代码来自一个旧项目：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    CGFloat scrollOffset = scrollView.contentOffset.y; // this is the important number.
    if (scrollOffset>=0 && scrollOffset<=topHeight) {
        CGRect frame = CGRectMake(0, scrollOffset/2, 320, topHeight - scrollOffset/2);
        photos.frame = frame;
    } else if (scrollOffset>topHeight) {
        CGRect frame = CGRectMake(0, 100, 320, 100);
        photos.frame = frame;
    } else {
        CGRect frame = CGRectMake(0, 0, 320, topHeight);
        photos.frame = frame;
    }
} 
```

根据您的反馈，我认为最好的选择是这样的：

```
|----------------------|  
|        DRAWER        |  
|----------------------|  
|                      |  
|                      |  
|                      |  
|     UIScrollView     |  
|                      |  
|                      |  
|                      |  
|----------------------| 
```

并在里面`scrollViewDidScroll`根据偏移量改变抽屉的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T13:25:12.833

我想我在 Game Center 应用程序中找到了他们的确切做法。我的解决方案的工作原理相同，并且实施起来非常简单。

首先我做了一个`UITableViewController`子类添加了一个`UIView`名为“blueView”的属性并对属性进行了一些调整`tableView`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.blueView = [[UIView alloc] initWithFrame:CGRectMake(0.0, -100.0, 320.0, 100.0)];
    self.blueView.backgroundColor = [UIColor blueColor];

    [self.tableView addSubview:self.blueView];
    [self.tableView setContentInset:UIEdgeInsetsMake(100.0, 0.0, 0.0, 0.0)];
    [self.tableView setScrollIndicatorInsets:UIEdgeInsetsMake(100.0, 0.0, 0.0, 0.0)];

} 
```

然后在`- (void)scrollViewDidScroll:(UIScrollView *)scrollView`方法中我正在调整视图，`scrollView.contentOffset.y`使其始终保持在顶部。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{

    if (scrollView.contentOffset.y < -100) {
        self.blueView.frame = CGRectMake(0.0, scrollView.contentOffset.y, 320.0, 100.0);
    } else {
        self.blueView.frame = CGRectMake(0.0, -100.0, 320.0, 100.0);
    }
} 
```

瞧！也许这会节省一些人的时间。

# intuit-partner-platform - 执行 TermQuery 返回错误 404

> ID：14589134
> 
> 赞同：1
> 
> 时间：2013-01-29T17:54:09.440
> 
> 标签：intuit-partner-platform

以下代码使 xml 反序列化失败：

var query = new TermQuery();

var results = query.ExecuteQuery(context);

var r = 结果.Count(); Console.WriteLine(r);

我收到 404 错误。用于访问 SalesTerm 查询的资源似乎不可用。

这是请求：

```
<?xml version="1.0" encoding="utf-8"?><TermQuery xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.intuit.com/sb/cdm/v2" /> 
```

这就是回应

```
<html><head><title>JBoss Web/2.1.12.GA-patch-03 - Error report</title><style><!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}--></style> </head><body><h1>HTTP Status 404 - Null subresource for path: https://services.intuit.com/sb/none/v2/556745565</h1><HR size="1" noshade="noshade"><p><b>type</b> Status report</p><p><b>message</b> <u>Null subresource for path: https://services.intuit.com/sb/none/v2/556745565</u></p><p><b>description</b> <u>The requested resource (Null subresource for path: https://services.intuit.com/sb/none/v2/556745565) is not available.</u></p><HR size="1" noshade="noshade"><h3>JBoss Web/2.1.12.GA-patch-03</h3></body></html> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:23:57.910

这是 DevKit 中的一个错误。如果您查看端点，DevKit 将“无”作为实体类型传递。

[https://services.intuit.com/sb/](https://services.intuit.com/sb/)**无**/

作为一种解决方法，您可以使用 DevDefined 或类似的库来构建您的 OAuth 请求并直接调用该服务。这是一个例子：

[http://pastebin.com/raw.php?i=dqTb7gFM](http://pastebin.com/raw.php?i=dqTb7gFM)

# google-tv - LG G2 上的 GTV 频道列表/更改 API/示例是否损坏？

> ID：14589135
> 
> 赞同：2
> 
> 时间：2013-01-29T17:54:09.453
> 
> 标签：google-tv

在 LG G2 Google TV 上，任何查询频道列表提供商的尝试都会引发此异常：“无效 URI：content://com.google.android.tv.provider/channel_listing”

官方频道更改示例和我自己的代码都是如此，我已经在 Sony GTV buddy box 上演示了这两个代码。

我在这里错过了什么吗？有没有我不知道的LG酱？还是这个简单明了的 LG 错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T16:52:22.500

更新：将您的 uri 更改为：

# GTV 第 3 版

content://com.google.tv.mediadevicesapp.ChannelListingProvider/channel_listing

还：

将所需权限从 com.google.android.tv.permission.READ_CHANNELS 更改为 com.google.android.tv.mediadevices.permission.READ_STREAMS

您返回的数据也会有所不同：

“channel_uri”更改为“url”“channel_name”更改为“name”“channel_number”更改为“channelNumber”“呼号”更改为“subName”

# 同时支持 v2 和 v3

```
int version = 0;
try {
    Class cl = Class.forName("com.google.android.tv.Version");
    version = cl.getField("GTV_SDK_INT").getInt(null); }
catch (Exception ex) {}

String contentUri;

if (version == 0) {
    // We're on old (Pre-V3 GoogleTV)
    contentUri = "content://com.google.android.tv.provider/channel_listing";
} else {
    // We're on V3 or newer.
    contentUri = "content://com.google.tv.mediadevicesapp.ChannelListingProvider/channel_listing";
    // or, if you're using the framework library:
    // Uri contentUri = com.google.android.tv.provider.ChannelListingContract.Channels.CHANNEL_LISTING_URI
}

/*

Column names are:

callsign
channel_name
channel_number
channel_uri
data_source

*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-03T04:07:29.740

根据 Google 发布的代码示例，我无法进行任何工作。但我偶然发现了这一点，现在它可以工作了：

[http://pastebin.com/CAKBWpCg](http://pastebin.com/CAKBWpCg)

似乎如果你有错误的 Uri 或列名，你会得到一个空游标。

# email - 在 HTML 电子邮件中包含图像的最佳方式？

> ID：14589136
> 
> 赞同：13
> 
> 时间：2013-01-29T17:54:10.453
> 
> 标签：email, html-email, email-attachments, email-client

我正在创建一些包含图像的 HTML 电子邮件。对于每封电子邮件，图像 + 电子邮件的大小小于 150kb。

我正在努力让它们为这里提到的主要客户工作良好[http://www.campaignmonitor.com/resources/will-it-work/email-clients/](http://www.campaignmonitor.com/resources/will-it-work/email-clients/)

据我所知，在电子邮件中包含图片的主要方式有两种：

*   **直接嵌入图像。**

    *   *优点：*打开电子邮件后立即加载图像（在大多数客户端中）。
    *   *缺点：*在移动浏览器上似乎效果不佳。
*   **自己托管它们并在电子邮件中使用指向它们的链接**
    *   *优点：*似乎有更好的兼容性。
    *   *缺点：*接收方总是必须单击“显示所有图像”按钮/链接，增加了在服务器上维护图像的复杂性。

在我看来，嵌入图像将是最好的解决方案，因为这意味着用户在打开电子邮件后会立即看到它们。**这是正确的还是你会建议另一种方式？**

非常感谢您的帮助 ：-）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-29T18:20:14.220

没有嵌入图像将自动加载的图像。“显示图像”将始终是有图像的收件人的选项。

我假设嵌入是附加图像，然后将其加载到正文中，就像通过将图像粘贴到 Outlook 中一样。这种方法会使收件箱中的文件变大，并且将所有图像作为附件看起来很乱。

通过链接到托管图像，无论您是自己托管还是使用电子邮件服务提供商（例如 Campaign Monitor 或 Mailchimp）自动托管，您都无需担心这一点。这是发送商业电子邮件的行业标准方式。

使用 ESP 并让他们托管您的图像。

# php - 使用 CakePHP 的 ORM，“不能重新声明类 Foo”

> ID：14589137
> 
> 赞同：0
> 
> 时间：2013-01-29T17:54:13.433
> 
> 标签：php, database, cakephp, orm, model

这是我的数据库结构：

```
create table dpt_tutores
(
id int primary key AUTO_INCREMENT,
nivel varchar(128),
apellidos varchar(256),
nombres varchar(256),
email varchar(512),
estado varchar(128)
);

create table dpt_grupos
(
id int primary key AUTO_INCREMENT,
fecha_de_creacion datetime,
alumnos varchar(512),
titulo varchar(1024),
id_curso int,
informe_nota decimal(5,2),
informe_rango varchar(16),
predefensa_fecha datetime,
predefensa_gmt varchar(16),
predefensa_webex varchar(16),
defensa_fecha datetime,
defensa_gmt varchar(16),
defensa_webex varchar(16),
id_revisor int,
FOREIGN KEY (id_revisor) REFERENCES dpt_tutores(id),
id_guia int,
FOREIGN KEY (id_guia) REFERENCES dpt_tutores(id)
);

create table dpt_grupos_iteraciones
(
id int primary key AUTO_INCREMENT,
fecha datetime,
ubicacion_archivo varchar(512),
nota float(4,2),
id_grupo int,
FOREIGN KEY (id_grupo) REFERENCES dpt_grupos(id)
); 
```

我添加了以下模型（`dpt_grupo.php`）：

```
<?php
class DptGrupo extends AppModel {

} 
```

我的控制器：

```
<?php
class DptController extends AppController {
  public $helpers = array('Html', 'Form');

  public function index() {
    $this->loadModel('Dpt_Grupo');
    $this->set('grupos', $this->dpt_grupo->find('all'));
  }
} 
```

但是当我在该控制器中运行操作时，我收到错误：

> 致命错误错误：无法重新声明类 DptGrupo 文件：C:\xampp\htdocs\foowebsite\app\Model\dpt_grupo.php 行：4
> 
> 注意：如果要自定义此错误消息，请创建 app\View\Errors\fatal_error.ctp

我怎样才能找到表中所有行的`dpt_grupos`列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T23:12:54.150

将模型文件重命名为 DptGrupo.php

```
$this->loadModel('DptGrupo');
$this->set('grupos', $this->DptGrupo->find('all')); 
```

# google-app-engine - 尝试从 Google App Engine Launcher 部署应用程序时出现错误 401

> ID：14589138
> 
> 赞同：3
> 
> 时间：2013-01-29T17:54:17.410
> 
> 标签：google-app-engine, authentication, http-status-code-401

我在从**Google App Engine Launcher**启动我的第一个应用程序时遇到了一些问题。我已经在 App Engine 网站上注册了一个帐户。单击部署按钮后，我会在 Google**弹出窗口**中输入部署应用程序，并在其中输入我在注册时提供的信息。然后我得到这个错误：

```
Starting update of app: isabelleengineapp, version: 1
12:49 PM Getting current resource limits.
Password for swissian@gmail.com: Use an application-specific password instead of your regular account password.
See http://www.google.com/support/accounts/bin/answer.py?answer=185833
However, now the recommended way to log in is using OAuth2\. See
https://developers.google.com/appengine/docs/python/tools/uploadinganapp#oauth
2013-01-29 12:49:22,607 ERROR appcfg.py:2203 An error occurred processing file '': HTTP Error 401: Unauthorized. Aborting. 
Error 401: --- begin server output ---
Must authenticate first.
--- end server output ---
2013-01-29 12:49:22 (Process exited with code 1) 
```

**现在，我认为这可能是因为我为我的Google**帐户设置了两步验证，但除了在获取部署弹出窗口时尝试使用*应用程序*特定密码之外，我不知道该怎么做，但这不起作用。有任何想法吗？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-05T04:46:10.763

You can try passing the `--oauth2` option to `appcfg.py`.

This is an alternative way of authenticating that avoids having to deal with passwords.

More details here: [https://developers.google.com/appengine/docs/python/tools/uploadinganapp#Python_Password-less_login_with_OAuth2](https://developers.google.com/appengine/docs/python/tools/uploadinganapp#Python_Password-less_login_with_OAuth2)

# facebook - 如何在 url 中获取没有用户 ID 的公共个人资料图片 url？

> ID：14589144
> 
> 赞同：0
> 
> 时间：2013-01-29T17:54:38.627
> 
> 标签：facebook, html, facebook-graph-api

我想使用图形 api 在我的 facebook html5 游戏中显示人们的个人资料图片。但是，我的问题是，我不希望其他人使用我的游戏，只需右键单击图片即可找到其他人的 Facebook id。

有什么方法可以从 facebook 获取图片 url 不明确的人的个人资料图片吗？

# mysql - MYSQL 使用 EBCDIC 而非 ASCII 排序

> ID：14589148
> 
> 赞同：0
> 
> 时间：2013-01-29T17:54:50.230
> 
> 标签：mysql, sql, sql-order-by

有没有办法通过使用 EBCDIC 而不是 ASCII 使用语句来进行 mysql 排序或排序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T17:57:00.390

有一个[令人惊讶](http://lists.mysql.com/mysql/180802)的排序规则，但您会在 Google 中找到它。

# c++ - 如何 SFINAE 启用返回“自动”的成员函数

> ID：14589150
> 
> 赞同：3
> 
> 时间：2013-01-29T17:54:54.617
> 
> 标签：c++, c++11, auto, sfinae

在模板元编程中，可以在返回类型上使用 SFINAE 来选择某个模板成员函数，即

```
 template<int N> struct A {
   int sum() const noexcept
   { return _sum<N-1>(); }
 private:
   int _data[N];
   template<int I> typename std::enable_if< I,int>::type _sum() const noexcept
   { return _sum<I-1>() + _data[I]; }
   template<int I> typename std::enable_if<!I,int>::type _sum() const noexcept
   { return _data[I]; }
}; 
```

但是，如果有问题的函数（在上面的例子中）具有自动检测的返回类型，这将不起作用`_sum()`，例如`_func()`在这个例子中

```
template<int N> class A
{
   /* ... */
private:
  // how to make SFINAE work for _func() ?
  template<int I, typename BinaryOp, typename UnaryFunc>
  auto _func(BinaryOp op, UnaryFunc f) const noexcept -> decltype(f(_data[0]))
  { return op(_func<I-1>(op,f),f(_data[I])); }
}; 
```

还可以做些什么来获得 SFINAE？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:22:12.113

在 David Rodríguez - dribeas 之后，以下代码按预期工作：

```
template<int N> class A
{
  int min_abs() const noexcept
  {
    return _func<N-1>([](int x, int y)->int { return std::min(x,y); },
                      [](int x)->int { return std::abs(x); });
  }
private:
  int _data[N];

  template<int I, typename BinaryOp, typename UnaryFunc>
  auto _func(BinaryOp op, UnaryFunc f) const noexcept
    -> typename std::enable_if< I>,decltype(f(_data[0]))>::type
  { return op(_func<I-1>(op,f),f(_data[I])); }

  template<int I, typename BinaryOp, typename UnaryFunc>
  auto _func(BinaryOp op, UnaryFunc f) const noexcept
    -> typename std::enable_if<!I>,decltype(f(_data[0]))>::type
  { return f(_data[I]); }
}; 
```

严格来说，我们还必须确保二元运算符`op`返回正确的类型。为了答案的简单和简洁，我把它留给读者去弄清楚......

# google-api - 使用 google oauth 2.0 和 scribe 检索博客提要

> ID：14589152
> 
> 赞同：0
> 
> 时间：2013-01-29T17:55:05.477
> 
> 标签：google-api, oauth-2.0, google-api-java-client, scribe, google-oauth

我使用 scribe 使用 oAuth 2.0 连接到 google 并成功获得了访问令牌。当我试图获取博客时，我总是收到以下错误

未经授权必须进行身份验证才能使用“默认”用户

下面是代码片段

```
GoogleOAuthParameters oauthParameters = new GoogleOAuthParameters();
oauthParameters.setOAuthConsumerKey(CONSUMER_KEY);
oauthParameters.setOAuthConsumerSecret(CONSUMER_SECRET_KEY);
oauthParameters.setScope("http://www.blogger.com/feeds");
oauthParameters.setOAuthToken(ACCESS_TOKEN);
oauthParameters.setOAuthTokenSecret(ACCESS_TOKEN_SECRET); // this is null 

BloggerService myService = new BloggerService("blogger");
try {           
myService.setOAuthCredentials(oauthParameters, new OAuthHmacSha1Signer());          
} catch (OAuthException e) {
e.printStackTrace();
}
final URL feedUrl = new URL("http://www.blogger.com/feeds/default/blogs");
Query query = new Query(feedUrl);
Feed resultFeed = myService.getFeed(query, Feed.class); 
```

无法在此处获取提要并显示上述未经授权的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T23:04:36.623

我相信杰森已经回答了你的问题。

您不想使用上面的库代码访问博客。使用新的 API，并使用 OAuth2 [https://developers.google.com/blogger/docs/3.0/using#auth](https://developers.google.com/blogger/docs/3.0/using#auth)

我不确定 scribe 是什么，但使用 OAuth2，您需要指出您正在构建的应用程序类型，它可能是从 Web 服务器运行的应用程序，也可能是已安装的应用程序。您确定了什么，您可以按照上面链接的 java 客户端库的相应文档获取访问令牌并检索数据。

# php - Xdebug 分析和 SOAP 客户端调用

> ID：14589157
> 
> 赞同：0
> 
> 时间：2013-01-29T17:55:14.980
> 
> 标签：php, soap, xdebug

我想知道为什么我的 Webgrind 没有在我的函数列表中显示 SOAP 调用。我在版本 2 中安装了 xdebug，在最新版本中安装了 Webgrind。我可以看到很多函数调用，包括 aso。但即使我有一个文件只执行一个 SOAP 调用，它也不会显示在 Webgrind 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T14:52:31.993

这确实很有趣。我知道我必须对 SOAP 扩展做一些诡计，因为它有点像个坏孩子。如果你能想出一个可重现的例子，请在[http://bugs.xdebug.org](http://bugs.xdebug.org)提交一个错误——我会看看。如果它包含我可以轻松运行的脚本，我将能够更快地获得它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:03:23.583

针对所有警告，我让 APD 和 xdebug 并行运行。必须禁用 APD，它就像一个魅力！

# android - 将自定义 css 加载到 WebView

> ID：14589161
> 
> 赞同：3
> 
> 时间：2013-01-29T17:55:43.593
> 
> 标签：android, android-webview, jsoup

**如何将自定义 CSS 文件注入 WebView？**

我正在使用 Jsoup 提取 HTML 代码，然后删除现有的 CSS 文件。我不知道如何正确地将我的本地 CSS 文件注入 HTML 代码。我以**Stackoverflow**为例。这是我的代码的一部分。我的**test.css**文件位于**assets 文件夹**中。

```
Document doc;
        String htmlcode = ""; 
        web = (WebView) findViewById(R.id.webView1);

        try {
            doc = Jsoup.connect("http://stackoverflow.com/users").get();
            doc.head().getElementsByTag("link").remove();
            doc.head().appendElement("link").attr("rel", "stylesheet")
                    .attr("type", "text/css").attr("href", "test.css");
            htmlcode = doc.html();
            web = (WebView) findViewById(R.id.webView1);
            web.loadDataWithBaseURL("file:///android_asset/test.css",
                    htmlcode, "text/html", "UTF-8", null);

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

这是我的**test.css**文件中的内容，它与 Stackoverflow 使用的 CSS 文件相同。

这是[一个链接](http://cdn.sstatic.net/stackoverflow/all.css?v=6d7ec4d8bbbd)！

谢谢你，我很感激你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T18:29:32.063

而不是 loadDataWithBaseURL 尝试 web.loadUrl("file:///android_asset/test.css");

# git - 在现有文件夹中初始化 gitolite 存储库

> ID：14589162
> 
> 赞同：3
> 
> 时间：2013-01-29T17:55:47.463
> 
> 标签：git, terminal, gitolite

我对 Git 和 Gitolite 还很陌生，但昨天我设法让它运行起来。

问题是，我有一个包含许多项目的文件夹（我们称之为`/projects`），我正在尝试将它们迁移到 Git。我将 Gitolites`/repositories`文件夹符号链接到这个`/projects`文件夹，所以现在每个新的 repo 都在`/projects`文件夹中创建。它工作正常。

但是现在我想为文件夹中的每个项目（子文件夹）创建一个 repo `/projects`。如果我在 Gitolite 中初始化一个新的仓库（我们称之为它`/myproject`），它会创建一个名为的新文件夹，`myproject.git`而不是将旧`myproject`文件夹与我已经在使用的文件一起使用。

那么，如何使用 Gitolite 将所有单个项目文件夹转换为 Git 存储库？我不想手动下载和附加所有这些文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:34:01.960

这就是[Gitolite 的工作](http://www.msnbc.msn.com/id/45755883/ns/msnbc-the_last_word/#50594835)方式：它管理*裸*存储库（`xxx.git`文件夹），而不是工作树（充满文件的目录，例如`projects/myprojects/`）。

所以：不要将存储库符号链接到 /projects：两者的目的截然不同。

您可以直接在自己`/projects/myproject/.git`的[目录](https://stackoverflow.com/a/10345296/6309)（

* * *

[Pierre De LESPINAY](https://stackoverflow.com/users/305189/pierre-de-lespinay)在官方文档[的评论](https://stackoverflow.com/questions/14589162/initialize-gitolite-repository-in-existing-folder/14589805?noredirect=1#comment39952240_14589805)中提到了 s：

## “[附录 1：将现有的 repos 引入 gitolite](http://gitolite.com/gitolite/basic-admin.html#existing) ”

> *   将存储库移至`$HOME/repositories`.
> *   确保：
>     *   它们都是裸回购。
>     *   所有回购名称都以“ `.git`”结尾。
>     *   所有文件和目录都由 gitolite 托管用户拥有和可写（尤其是如果您以 root 身份复制它们）。
> *   运行**`gitolite setup`**。
>     如果你忘记了这一步，你也可以忘记写访问控制！
> 
> 回到你的工作站：
> 
> *   如果存储库是普通存储库，请将它们添加到`conf/gitolite.conf`管理存储库的克隆中，然后提交并推送更改。
> *   如果 repos 是已经匹配 conf 文件中某些 repo 正则表达式的通配符 repos，则需要手动创建 gl-creator 文件，如下所示：

```
echo username > ~/repositories/path/to/repo.git/gl-creator 
```

# requirejs - chutzpah 是否支持 requirejs shims/config？

> ID：14589163
> 
> 赞同：6
> 
> 时间：2013-01-29T17:55:49.657
> 
> 标签：requirejs, qunit, chutzpah

我有一些 qunit 测试设置来测试我广泛使用 requirejs 的代码。我使用 Chutzpah 来执行在 VS 中运行的测试。如果我在浏览器中运行测试，但不是仅在 VS 中运行，一切正常。它似乎忽略了我的 require.config 调用。如果我将文件中的引用更改为不指向垫片而是直接指向文件，它将起作用，但这会破坏我的代码中的其他内容。

有人有这个工作吗？如果是这样，怎么做？我查看了他们的示例代码，但它没有使用 require.config 和 shims。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-22T06:35:01.640

从[本教程](https://github.com/mmanela/chutzpah/wiki/running-requirejs-unit-tests "教程")开始。

要使用 shims 运行配置，只需在 chutzpah.json 中添加对配置文件的引用。下面的示例，为了便于阅读而略微简化。

chutzpah.json 文件

```
{
  "Framework": "qunit",
  "TestHarnessReferenceMode": "AMD",
  "TestHarnessLocationMode": "SettingsFileAdjacent",
  "References": [
    { "Path": "../Scripts/Components/RequireJS/require.js" },
    { "Path": "config.js" }
  ]
} 
```

config.js 文件

```
require.config({
    "paths": {
        "jquery": "../Scripts/jquery-2.1.4",
        "jquery-linq": "../Scripts/jquery.linq",
        "signalr": "../Scripts/jquery.signalR-2.2.0",
        "signalrhubs": "../Scripts/mock-signalr-hubs",
        "knockout": "../Scripts/knockout-3.3.0",
        "constants": "../Scripts/constants",
        "HomeVm": "Source/HomeVm"
    },
    "shim": {
        "jquery.linq": {
            "deps": ["jquery"]
        },
        "bootstrap": {
            "deps": ["jquery"]
        },
        "signalr": {
            "deps": ["jquery"]
        }
    }
}); 
```

# iphone - 随机更改 UIButton（在本例中为扑克牌）的标题

> ID：14589164
> 
> 赞同：0
> 
> 时间：2013-01-29T17:55:49.947
> 
> 标签：iphone, objective-c, ios6, uibutton

ios 编程新手，所以为了练习，我正在尝试制作一个带有扑克牌的简单应用程序，它回到视图上，您​​可以点击它以显示卡片的正面。每次点击卡片的正面都会有所不同。我想要实现的是，当我点击卡片时：

1.  它翻转并显示一张随机卡片，
2.  每次翻转卡片时，标签都会增加 1

我完成了第二个要求，但我似乎无法正确完成第一个要求。我有 3 个模型（卡片、甲板、扑克牌） 我的甲板模型负责随机化卡片，这里是代码。

甲板.h

```
#import <Foundation/Foundation.h>
#import "Card.h"

@interface Deck : NSObject
- (void)addCard:(Card *)card atTop:(BOOL)atTop;

- (Card *)drawRandomCard;

@end 
```

甲板.m

```
#import "Deck.h"
@interface Deck()

@property (strong, nonatomic) NSMutableArray *cards;

@end

@implementation Deck
-(NSMutableArray *)cards
{
    if(!_cards) _cards =[[NSMutableArray alloc] init];
    return _cards;
} 

- (void)addCard:(Card *)card atTop:(BOOL)atTop
{
    if(card){
        if(atTop){
            [self.cards insertObject:card atIndex:0];
        }
        else
        {
            [self.cards addObject:card];
        }
    }
} 

- (Card *)drawRandomCard
{
    Card *randomCard = nil;  

    if(self.cards.count){
        unsigned index = arc4random() % self.cards.count;
        randomCard = self.cards[index];
        [self.cards removeObjectAtIndex:index];
    }

    return randomCard;
}
@end 
```

My PlayingCard 基本上描述了卡片的内容。例如。红心杰克，方块 2，其中杰克是卡片的“等级”，“红心”是卡片的花色，它们共同构成卡片的内容。

扑克牌.h

```
#import <Foundation/Foundation.h>
#import "Card.h"
@interface PlayingCard : NSObject

@property (strong, nonatomic) NSString *suit;
@property (nonatomic) NSUInteger   rank;

+ (NSArray *) validSuits;
+ (NSUInteger) maxRank;

- (NSString *)contents;
@end 
```

扑克牌.m

```
#import "PlayingCard.h"

@implementation PlayingCard

- (NSString *)contents
{
    NSArray *rankStrings = [PlayingCard rankStrings];
    return [rankStrings[self.rank] stringByAppendingString:self.suit];
}

@synthesize suit = _suit;

+(NSArray *)validSuits{
    return @[@"♥", @"♦", @"♠", @"♣"] ;
}

+(NSArray *)rankStrings{
    return  @[@ "?", @"A", @"2", @"3", @"4", @"5", @"6", @"7", @"8", @"9",@"10", @"J", @"Q", @"K"];

}
-(void)setSuit:(NSString *)suit
{
    if([[PlayingCard validSuits] containsObject:suit]){
        _suit = suit;
    }
}

-(NSString *)suit{
    return _suit ? _suit: @"?";
}

+ (NSUInteger)maxRank {
    return [self rankStrings].count-1;
}

-(void)setRank:(NSUInteger)rank{
    if(rank <= [PlayingCard maxRank]) {
        _rank = rank;
    }
}
@end 
```

最后是我的 ViewController.m

```
#import "CardGameViewController.h"
#import "Card.h"
#import "Deck.h"
#import "PlayingCard.h"

@interface CardGameViewController ()
@property (weak, nonatomic) IBOutlet UILabel *flipsLabel;
@property (nonatomic) int flipCount;
@property (nonatomic) NSString *title;
@property (weak, nonatomic) IBOutlet UIButton *cardRandom;
@end

@implementation CardGameViewController

- (void)setFlipCount:(int)flipCount
{
    _flipCount = flipCount;
    self.flipsLabel.text = [NSString stringWithFormat:@" Flips:%d", self.flipCount ];
}

- (IBAction)flipCard:(UIButton *)sender
{

    if(sender.isSelected) {
        sender.selected = NO;
        self.flipCount ++;
    }
    else{
        sender.selected = YES;
        self.flipCount ++;         
    }
}

@end 
```

我对此进行了研究，发现我可能应该使用

```
- (void)setTitle:(NSString *)title forState:(UIControlState)state 
```

其中状态将是 UIControlStateSelected 因为包含内容的卡片正面是按钮的选定内容但我不知道如何根据我的模型开发的随机卡片内容设置标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T20:12:37.870

假设您在 CardGameViewController 中有一个 Deck 类的属性（称为 cardDeck），并且您已经使用 addCard 方法用卡片填充了该属性。现在当用户点击翻转按钮时，你应该做这样的事情::

```
- (IBAction)flipCard:(UIButton *)sender
{

  //draw a random card
  Card *randomCard = [self.cardDeck drawRandomCard];

  //set the button title
  [sender setTitle:[randomCard contents] forState:UIControlStateSelected];

  if(sender.isSelected) {
    sender.selected = NO;
    self.flipCount ++;
  }
  else{
    sender.selected = YES;
    self.flipCount ++;         
  }
} 
```

希望这可以帮助

PS :: drawRandomCard 方法有一个返回类型“Card”，看起来应该是“PlayingCard”，或者 PlayingCard 类应该命名为 Card。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T23:42:35.230

你没有初始化你的扑克牌。您的 ViewController.m 文件应如下所示（一旦所有卡片都显示在 flipCard 方法中，我也会重置卡片组）：

```
 #import "CardViewViewController.h"
    #import "PlayingCardDeck.h"

    @interface CardViewViewController ()
    @property (weak, nonatomic) IBOutlet UILabel *flipsLabel;
    @property (nonatomic) int flipCount;
    @property (nonatomic) PlayingCardDeck *myDeck;
    @end
    @implementation CardViewViewController
    -(PlayingCardDeck *)myDeck
    {
        if(!_myDeck) _myDeck=[[PlayingCardDeck alloc] init];
        return _myDeck;
    }

    -(void)setFlipCount:(int)flipCount
    {
        _flipCount= (int) flipCount;
        self.flipsLabel.text=[NSString stringWithFormat:@"Flips: %d",self.flipCount];
    }
    - (IBAction)flipCard:(UIButton *)sender
    {
        if (!sender.isSelected)
        {
            if (self.flipCount >= 52)
            {
                self.flipCount = 0;
                self.myDeck = nil;
            }
            Card *cCard = [self.myDeck drawRandomCard];
            [sender setTitle: [cCard contents] forState:UIControlStateSelected];
            self.flipCount++;
        }
        sender.selected = !sender.isSelected;
    }

@end 
```

# asp.net - Juice UI：发布我的网站 - 控件哪里去了？

> ID：14589165
> 
> 赞同：0
> 
> 时间：2013-01-29T17:55:49.877
> 
> 标签：asp.net, visual-studio-2012, iis-7.5, publishing, juice-ui

我在 Visual Studio 2012 中使用带有 Juice UI 的 ASP.NET 创建了一个站点。当我发布到本地计算机的 Web 服务器（Windows 7 64 位，运行 IIS 7.5）时，一切都正常运行。但是，当我发布到公司 Web 服务器（Windows 2008 Server R2 64 位，运行 IIS 7.5）时，结果不一致。

90% 的情况下，当我浏览该网站时，Juice UI 控件会丢失。然而，当我检查相关文件是否在网络服务器上时，它们似乎都存在且正确。

什么可能导致这个令人沮丧和间歇性的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T04:38:25.187

本地网站的目录结构与生产环境的目录结构是否不同？可能是脚本位置问题。检查浏览器中的控制台输出/错误控制台以在加载脚本时查找 404 错误。

# java - 我的数据是 unicode，直到它通过 JDBC 推送，然后变成问号

> ID：14589169
> 
> 赞同：0
> 
> 时间：2013-01-29T17:56:02.030
> 
> 标签：java, jdbc

如果我直接用 unicode 字符调用我的 sproc，我可以在表中看到这些 un​​icode 字符。我可以从表中读取 unicode 字符。

在我的应用程序中，我可以调试代码并查看整个应用程序中的数据是 unicode。最后三行是：

```
query = String.format("EXEC prcLibhashRefreshLog_i @Requester=\'%s\', @Libhash=\'%s\', @Product=\'%s\', @Reason=\'%s\'", user, libHash, service, reason); 
```

我可以在调试器中看到“查询”中的数据仍然是 unicode。这里一切都很好。我可以将“查询”输出到页面，它是 unicode。

```
SQLStmt = DBConn.createStatement();
SQLStmt.execute(query); 
```

经过这一步后，数据库中的数据为“????????????”。我知道它不是 SQL Server，我知道它不是存储过程，我知道它不是数据。我该如何解决？

编辑：我忘记了字符串之前的“N”。我怎么这么傻。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:57:40.330

尝试：

```
&characterEncoding=UTF-8&useUnicode=yes 
```

在您的连接字符串中

# java - 使用复合主键映射表

> ID：14589170
> 
> 赞同：2
> 
> 时间：2013-01-29T17:56:02.813
> 
> 标签：java, hibernate, jpa

我在休眠中有以下实体，使用 JPA 注释

```
@Entity
@IdClass(PurchaseCounter.PurchaseCounterPK.class)
@Table(name = "customer_purchases_counter")
public class PurchaseCounter {

    public static class PurchaseCounterPK implements Serializable {

        Integer customerId;
        Integer purchaseId;

        public PurchaseCounterPK(Integer customerId, Integer purchaseId) {
            this.customerId = customerId;
            this.purchaseId = purchaseId;
        }

        public Integer getCustomerId() {
            return customerId;
        }

        public void setCustomerId(Integer customerId) {
            this.customerId = customerId;
        }

        public Integer getPurchaseId() {
            return purchaseId;
        }

        public void setPurchaseId(Integer purchaseId) {
            this.purchaseId = purchaseId;
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;

            PurchaseCounterPK that = (PurchaseCounterPK) o;

            if (customerId != null ? !customerId.equals(that.customerId) : that.customerId != null) return false;
            if (purchaseId != null ? !purchaseId.equals(that.purchaseId) : that.purchaseId != null) return false;

            return true;
        }

        @Override
        public int hashCode() {
            int result = customerId != null ? customerId.hashCode() : 0;
            result = 31 * result + (purchaseId != null ? purchaseId.hashCode() : 0);
            return result;
        }
    }

    Integer customerId;
    Integer purchaseId;
    Integer count = 0;

    @Id
    @Column(name = "customer_id")
    public Integer getCustomerId() {
        return customerId;
    }

    public void setCustomerId(Integer customerId) {
        this.customerId = customerId;
    }

    @Id
    @Column(name = "purchase_id")
    public Integer getPurchaseId() {
        return purchaseId;
    }

    public void setPurchaseId(Integer purchaseId) {
        this.purchaseId = purchaseId;
    }

    public Integer getCount() {
        return count;
    }

    public void setCount(Integer count) {
        this.count = count;
    }
} 
```

当我使用 Criteria 进行查询并使用 purchaseId 和 customerId 作为 Restriction.eq 过滤器时，这就是生成的查询：

```
select this_.customerId as customerId137_0_, this_.purchaseId as purchaseId137_0_, this_.count as count137_0_ from customer_purchases_counter this_ where this_.purchaseId=? and this_.customerId=? 
```

这当然是错误的，因为字段 customerId 和 purchaseId 没有重命名为我使用 @Column 指定的名称？？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:55:26.137

映射似乎是正确的。这很可能会发生[HHH-4256](https://hibernate.onjira.com/browse/HHH-4256)（*Hibernate 不尊重带有 IdClass 的 @Column(name=...) 注释*）。如果是这样，那么更新到更新版本的 Hibernate 提供了解决方案。

`@Column`同样根据使用注释的错误报告`IdClass`是解决方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-29T18:01:09.323

我不确定我是否理解正确，但 @Column 仅指定了将哪一列映射到您的 java 数据。

因此，您不应将 @Column 注释应用于您的 getter，而应将其应用于您的变量声明本身。

```
@ID
@Column (name="customer_Id")
Integer customerId;
@ID
@Column (name="purchase_Id")
Integer purchaseId; 
```

# xcode - Xcode 4.6 LLDB 中的 IRForTarget 错误

> ID：14589173
> 
> 赞同：1
> 
> 时间：2013-01-29T17:56:20.210
> 
> 标签：xcode, lldb, xcode4.6

自从升级到 Xcode 4.6 final，我经常在 LLDB 中看到：

```
(lldb) po [0x12eaf7a0 description]
Error [IRForTarget]: Call to a symbol-only function 'objc_msgSend' that is not present in the target
error: warning: receiver type 'int' is not 'id' or interface pointer, consider casting it to 'id'
error: The expression could not be prepared to run in the target 
```

`0x12eaf7a0`我可以通过将其添加为左窗格中的表达式来验证它是否为有效对象。我什至可以通过使用“打印描述”上下文菜单成功地显示它的描述。

有什么想法（除了切换回 GDB）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T22:34:55.573

我认为您只需要将您的地址转换为 id，例如

```
(lldb) po [(id)0x12eaf7a0 description] 
```

# java - 并排的两个 JFrame

> ID：14589181
> 
> 赞同：1
> 
> 时间：2013-01-29T17:56:44.027
> 
> 标签：java, swing, jframe, awt

是否可以设置两个不同的 JFrame 并**并排**显示它们？不使用 Internalframe、多个 Jpanels 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:21:22.183

首先将您的框架放置在每个屏幕设备上。

```
frame1.setLocation(pointOnFirstScreen);
frame2.setLocation(pointOnSecondScreen); 
```

工作示例：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Frame;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Point;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;

public class GuiApp1 {
protected void twoscreen() {
Point p1 = null;
Point p2 = null;
for (GraphicsDevice gd : GraphicsEnvironment.getLocalGraphicsEnvironment ().getScreenDevices()) {
    if (p1 == null) {
        p1 = gd.getDefaultConfiguration().getBounds().getLocation();
    } else if (p2 == null) {
        p2 = gd.getDefaultConfiguration().getBounds().getLocation();
    }
}
if (p2 == null) {
    p2 = p1;
}
createFrameAtLocation(p1);
createFrameAtLocation(p2);
 }

 private void createFrameAtLocation(Point p) {
final JFrame frame = new JFrame();
frame.setTitle("Test frame on two screens");
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
JPanel panel = new JPanel(new BorderLayout());
final JTextArea textareaA = new JTextArea(24, 80);
textareaA.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 1));
panel.add(textareaA, BorderLayout.CENTER);
frame.setLocation(p);
frame.add(panel);
frame.pack();
frame.setExtendedState(Frame.MAXIMIZED_BOTH);
frame.setVisible(true);
 }

public static void main(String[] args) {
SwingUtilities.invokeLater(new Runnable() {

    public void run() {
        new GuiApp1().twoscreen();
    }
});
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-03T15:11:27.390

是的，如下；

```
JFrame leftFrame = new JFrame();

// get the top left point of the left frame
Point leftFrameLocation = leftFrame.getLocation();
// then make a new point with the same top (y) and add the width of the frame (x)
Point rightFrameLocation = new Point(
            leftFrameLocation.x + leftFrame.getWidth(),
            leftFrameLocation.y);

JFrame rightFrame = new JFrame();
rightFrame.setLocation(rightFrameLocation); // and that's the new location 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-17T06:01:48.843

是的，这是一个非常简单的例子；对于我自己的用途，我对非模态 JDialogs 做同样的事情。

```
 public static void main(String[] args) {
        JFrame frameL = new JFrame("Left Frame");
        frameL.setSize(400, 200); // this size arbitrary; set how you need.
        frameL.setLocationRelativeTo(null);
        frameL.setVisible(true);

        Point p = frameL.getLocationOnScreen();
        Dimension d = frameL.getSize();

        JFrame frameR = new JFrame("Right Frame");
        frameR.setSize(300, 160); // this size arbitrary; set how you need.
        frameR.setLocation((p.x + d.width), p.y);
        frameR.setVisible(true);

        while(frameL.isVisible()) {
            try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        System.exit(0);
    } 
```

# java - 无法将面板添加到 Miglayout

> ID：14589189
> 
> 赞同：0
> 
> 时间：2013-01-29T17:57:04.663
> 
> 标签：java, swing, jcomponent, miglayout, preferredsize

我有一个扩展类 JComponent 的类，我在其中创建了一个带有图形的组件。我想使用 MigLayout 在框架中添加对象这个类，但是组件没有添加，我只能看到空框架。谢谢您的帮助。

用数字创建组件的类

```
public class DrawPictures extends JComponent
{
    static 
    {
        flagLeft = true;
        flagLeft  = true;
        flagforfoot = true;
    }

    public void setStringForMoveBall(String string)
    {
        stringForMoveBall = string;
    }

    public String getStringForMoveBall ()
    {
        return stringForMoveBall;
    }

    public DrawPictures() 
    {  
        changeColorBall = 0;
        stringForMoveBall = "";
        this.offset = 8;
        marginBetweenRectangles = 70;
        height = radiusWidth = 50;
        top = radiusHeight = 30;
        width = 60;
        left = 20;
        this.counter = 11;
        rectangles = new LinkedList<RoundRectangle2D>();
        ball = new Ellipse2D.Double( 400,570,top, top );
        FullCollection(rectangles);
        pusherFoot = new RoundRectangle2D.Double( 350, 600, 150, 50,radiusWidth,radiusHeight );

        timerForBall = new Timer(40, new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e)
            {   
                repaint();
            }
        } );
        timerForBall.start();
    }

    private void DrawRectangles( Graphics2D drawer )
    {
       if( flagforfoot )
       {
           //flagforfoot = false;
            for( int i = 0; i != rectangles.size(); ++i ) 
            {
                if ( i % 4 == 0)
                {
                    drawer.setColor( Color.RED );
                    drawer.fill(rectangles.get(i));
                }
                else if ( i % 3 == 0)
                {
                    drawer.setColor( Color.CYAN );
                    drawer.fill(rectangles.get(i));
                }
                else if ( i % 5 == 0)
                {
                    drawer.setColor( Color.YELLOW );
                    drawer.fill(rectangles.get(i));
                }
                else if ( i % 7 == 0)
                {
                    drawer.setColor( Color.WHITE );
                    drawer.fill(rectangles.get(i));
                }
                else if ( i % 8 == 0)
                {
                    drawer.setColor( Color.MAGENTA );
                    drawer.fill(rectangles.get(i));
                }
                else if ( i % 9 == 0)
                {
                    drawer.setColor( Color.GREEN );
                    drawer.fill(rectangles.get(i));
                }

                else 
                {
                    drawer.setColor( Color.PINK );
                    drawer.fill(rectangles.get(i));
                }
            }
        }
    }

    @Override protected void paintComponent( Graphics graphics )
    {
        super.paintComponent(graphics);
        drawer = (Graphics2D)graphics;
        DrawRectangles(drawer);     
        drawer.setColor(Color.YELLOW);
        drawer.fill(pusherFoot);
        MoveFootRectangle(pusherFoot);
        drawer.setColor(Color.GREEN);
        drawer.fill(ball);
        MoveBall( );

    }        

   private void CheckHitBallWithRectangles( )
   {    
       for( int i = rectangles.size() - 1; i > 0; --i )
       {
           if( ball.getMinY() >= rectangles.get(i).getMinY() &&
               ball.getMinY() <= rectangles.get(i).getMaxY() &&
               ball.getMaxX() >= rectangles.get(i).getMinX() &&
               ball.getMaxX() <= rectangles.get(i).getMaxX() )
           {
               if ( CompareStringsForMoveBall("") )
               {
                   stringForMoveBall = "DownAndLeftFromTopSide";
                   rectangles.remove(i);
                   rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
                   //--i;  
               }
               if( CompareStringsForMoveBall("UpAndRightFromLeftSide") )
               {
                   stringForMoveBall = "DownAndRightFromTopSide";
                   rectangles.remove(i);
                   //--i;
                   rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
               }
           }
           if(     ball.getMinY() >= rectangles.get(i).getMinY() &&
                   ball.getMinY() <= rectangles.get(i).getMaxY() &&
                   ball.getMinX() >= rectangles.get(i).getMinX() &&
                   ball.getMinX() <= rectangles.get(i).getMaxX())
           {
               if ( CompareStringsForMoveBall("") )
               {
                    stringForMoveBall = "DownAndLeftFromTopSide";
                    rectangles.remove(i);
                    //--i;
                    rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
               } 
           }

           if ( ball.getMaxY() >= rectangles.get(i).getMinY() &&
             ball.getMaxY() <= rectangles.get(i).getMaxY() &&
             ball.getMaxX() >= rectangles.get(i).getMinX() &&
             ball.getMaxX() <= rectangles.get(i).getMaxX())
           {
               if( CompareStringsForMoveBall("DownAndRightFromTopSide") )
               {
                   stringForMoveBall = "DownAndLeftFromTopSide";
                    rectangles.remove(i);
                    rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
                    //--i;
               }
               if( CompareStringsForMoveBall("UpAndRightFromLeftSide") )
               {
                   stringForMoveBall = "DownAndRightFromTopSide";
                    rectangles.remove(i);
                    //--i;
                    rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
               }
           }
           if ( ball.getMinX() >= rectangles.get(i).getMinX() &&
                ball.getMinX() <= rectangles.get(i).getMaxX()&&
                ball.getMinY() >= rectangles.get(i).getMinY() &&
                ball.getMinY() <= rectangles.get(i).getMaxY())
           {
                rectangles.remove(i);
                //--i;
               rectangles.add(i,new RoundRectangle2D.Double(0,0,0,0,0,0));
           }
           //System.out.println(rectangles.size());
       }
   }    
    public void MoveFootRectangle(RoundRectangle2D pusher) 
    {

            if( flagLeft && pusher.getX() >= 0)
            {

                pusher.setFrame(pusher.getX() - 30, pusher.getY(), 150, 60);
                flagLeft = false;
            }
            if( flagRight && pusher.getX() <= 730 )
            {
                pusher.setFrame(pusher.getX() + 30, pusher.getY(), 150, 60);
                flagRight = false;                 
            }

    }

   public static void SetStatusFlagLeft( )
   { 
       flagLeft = true; 
   }
   public static void SetStatusFlagRight( )
   {
       flagRight = true;
   }
   private void MoveBallYLessNull( )
   {
       if( CompareStringsForMoveBall( "" ) )
        {
            stringForMoveBall = "DownAndLeftFromTopSide";              
        }
        else if( CompareStringsForMoveBall( "UpAndRightFromLeftSide" ) )
        {
            stringForMoveBall = "DownAndRightFromTopSide";
        }
   }
   private void MoveBallXLessNull( )
   {
       if (  CompareStringsForMoveBall( "DownAndLeftFromTopSide" ) )  
        {
            stringForMoveBall = "DownAndRightFromTopSide"; 
        }
        else if( stringForMoveBall.compareTo( "" ) == 0 )
        {
        stringForMoveBall = "UpAndRightFromLeftSide";
        }
   }

    private void MoveBall()
    {     
         if ( CompareStringsForMoveBall( "" ) )
         {
             ball.setFrame(ball.getX() - offset, ball.getY() - offset, top, top);
         }
         if ( CompareStringsForMoveBall( "DownAndLeftFromTopSide" ) )
         {
             ball.setFrame(ball.getX() - offset, ball.getY() + offset, top, top);
         }

         if( ball.getX() < 0  )
         {
            MoveBallXLessNull();            
         }
         if( ball.getY() < 0 )
         {
            MoveBallYLessNull();             
         }
         if ( CompareStringsForMoveBall( "UpAndRightFromLeftSide" ) )
         {
             ball.setFrame(ball.getX() + offset, ball.getY() - offset, top, top );
         }

        if ( CompareStringsForMoveBall( "DownAndRightFromTopSide" ) )
         {
             ball.setFrame(ball.getX() + offset, ball.getY() + offset, top, top);
         }

        if ( ball.getMaxY() == pusherFoot.getMinY() && 
                ball.getCenterX() > pusherFoot.getMinX() 
             && ball.getCenterX() < pusherFoot.getMaxX() )
        {
            MoveBallHitWithFoot();
        }

        if( ball.getMaxX() > 880)
        {
            MoveBallForXMoreWidth();
        }

        CheckHitBallWithRectangles();
    }

    public void MoveBallForXMoreWidth( )
   {
       if ( CompareStringsForMoveBall( "DownAndRightFromTopSide" ) ) 
        {
            setStringForMoveBall("DownAndLeftFromTopSide");
        }
        else if( CompareStringsForMoveBall( "UpAndRightFromLeftSide" ) ) 
        {
           setStringForMoveBall("");               
        } 
   }

    public void MoveBallHitWithFoot( )
   {
       if ( CompareStringsForMoveBall( "DownAndRightFromTopSide" ) )
        {
           setStringForMoveBall("UpAndRightFromLeftSide") ;
        }
       else if ( CompareStringsForMoveBall( "DownAndLeftFromTopSide" ) ) 
        {
           setStringForMoveBall("");   
        }
   }
    public boolean CompareStringsForMoveBall( String moveforball )
   {
       if ( (getStringForMoveBall()).compareTo(moveforball) == 0 )
       { 
           return true;
       }
       else
       {
          return false;
       }
   }

   private void FullCollection(LinkedList<RoundRectangle2D> newrectangles)
   {
       int counterTop = 0;

       for( int i = 0; i <= counter; ++i )
       {
            newrectangles.add(new RoundRectangle2D.Double
              ( top + counterTop,left,width,height,radiusWidth,radiusHeight ));
            counterTop += marginBetweenRectangles;
       }

       counterTop = 0;

       for( int i = 0; i <= counter; ++i )
       {
            newrectangles.add(new RoundRectangle2D.Double
            ( top + counterTop,left + marginBetweenRectangles,width,height,radiusWidth,radiusHeight ));
            counterTop += marginBetweenRectangles;
       }

       counterTop = 0;

       for( int i = 0; i <= counter; ++i )
       {
            newrectangles.add(new RoundRectangle2D.Double
           ( top + counterTop,left + marginBetweenRectangles * 2,width,height,radiusWidth,radiusHeight ));
            counterTop += marginBetweenRectangles;
       }

   }
   private LinkedList<RoundRectangle2D> rectangles;
   private Ellipse2D ball;
   private int width,left,top,height, counter,radiusWidth,
           radiusHeight,marginBetweenRectangles,offset,changeColorBall;
   private RoundRectangle2D pusherFoot;
   private Timer timerForBall;
   private static boolean flagLeft,flagRight, flagforfoot;
   private String stringForMoveBall;
   private Graphics2D drawer;

} 
```

创建对象类 DrawPictures 并尝试添加到框架中的类

```
public class FrameForGame extends JFrame  
{
    public FrameForGame() 
    {
        super("MyGame");
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        setLayout(new MigLayout());

        setSize(WIDTH_H, HEIGHT_H);
        setLocation(150, 50);
        event = new ForEvents();
        addKeyListener(event); 
        add(new DrawPictures());
        setVisible(true);
    }
    private int WIDTH_H = 900;
    private int HEIGHT_H = 700;
    private ForEvents event;
    private JPanel panel;

       } 
```

具有 Main 方法的类

```
public class MyGame {

       public static void main(String[] args) 
    {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() 
            {
                FrameForGame frameForGame = new FrameForGame();             
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:24:10.827

*   [Graphics/2D](http://docs.oracle.com/javase/tutorial/2d/index.html)默认情况下永远不会将正确的大小返回给容器

*   [绘画到`JPanel`/`JComponent`不覆盖 PreferredSize 返回零维度](https://stackoverflow.com/a/7724971/714968)

# javascript - 提交后清除我的表单输入

> ID：14589193
> 
> 赞同：36
> 
> 时间：2013-01-29T17:57:14.900
> 
> 标签：javascript, jquery, html

根据我对该主题所做的搜索，我尝试了几种不同的方法，但由于某种原因，我无法让它工作。我只想在我点击提交按钮后清除我的文本输入和文本区域。

这是代码。

```
<div id="sidebar-info">
    <form name="contact-form" action="formprocess.php" method="post" target="ninja-frame">
        <h1>By Phone</h1>
        <p id="by-phone">XXX-XXX-XXXX</p>
        <h1>By Email</h1>
        <p id="form-row">Name</p>
        <input name="name" id="name" type="text" class="user-input" value="">
        <p id="form-row">Email</p>
        <input name="email" id="email" type="text" class="user-input" value="">
        <p id="form-row">Message</p>
        <textarea name="message" id="message" class="user-input" rows="10" maxlength="1500"></textarea>
        <p>*Please fill out every field</p>
        <input type="submit" value="Submit" id="submit" onclick="submitForm()">

        <script>
            function submitForm() {
            document.contact-form.submit();
            document.contact-form.reset();
            }
        </script>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-01-29T18:00:57.833

您的表单已被提交，因为您的按钮是 type `submit`。在大多数浏览器中，这会导致表单提交和加载服务器响应，而不是在页面上执行 javascript。

将提交按钮的类型更改为`button`. 另外，由于这个按钮被赋予了 id `submit`，它会导致与 Javascript 的提交函数发生冲突。更改此按钮的 id。尝试类似的东西

```
<input type="button" value="Submit" id="btnsubmit" onclick="submitForm()"> 
```

这种情况下的另一个问题是表单的名称包含`-`破折号。但是，Javascript 翻译`-`为减号。

您将需要使用基于数组的表示法或使用`document.getElementById()`/ `document.getElementsByName()`。该`getElementById()`函数直接返回元素实例，因为 Id 是唯一的（但它需要设置 Id）。`getElementsByName()`返回具有相同名称的值的数组。在这种情况下，由于我们没有设置 id，我们可以使用`getElementsByName`索引为 0 的。

尝试以下

```
function submitForm() {
   // Get the first form with the name
   // Usually the form name is not repeated
   // but duplicate names are possible in HTML
   // Therefore to work around the issue, enforce the correct index
   var frm = document.getElementsByName('contact-form')[0];
   frm.submit(); // Submit the form
   frm.reset();  // Reset all form data
   return false; // Prevent page refresh
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-11-09T09:56:55.770

由于您使用的是`jquery`图书馆，我建议您使用该`reset()`方法。

首先，给form标签添加一个id属性

```
<form id='myForm'> 
```

然后在完成后，将您的输入字段清除为：

```
$('#myForm')[0].reset(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-29T18:01:01.657

你可以试试这个：

```
function submitForm() {
  $('form[name="contact-form"]').submit();
  $('input[type="text"], textarea').val('');
} 
```

此脚本需要在页面上添加 jquery。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-29T18:01:14.477

最简单的方法是设置表单元素的值。如果您使用的是 jQuery（我强烈推荐），您可以轻松地做到这一点

```
$('#element-id').val('') 
```

对于表单中的所有输入元素，这可能有效（我从未尝试过）

```
$('#form-id').children('input').val('') 
```

请注意， .children 只会找到向下一级的输入元素。如果您需要找到孙子或这样的 .find() 应该可以工作。

可能有更好的方法，但这应该适合你。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-29T18:01:14.980

```
$('#contact-form input[type="text"]').val('');
$('#contact-form textarea').val(''); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-11-18T18:47:19.317

我在 jQuery 中使用了以下内容：

```
$("#submitForm").val(""); 
```

`submitForm`html中输入元素的id在哪里。我在我的函数之后运行它以从输入字段中提取值。下面的 extractValue 函数：

```
function extractValue() {
    var value = $("#submitForm").val().trim();
    console.log(value);
}; 
```

另外不要忘记包含`preventDefault();`阻止提交类型表单刷新页面的方法！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-06T06:10:30.503

只需在函数末尾包含这一行：

```
document.getElementById("btnsubmit").value = ""; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-23T13:22:53.667

```
var btnClear = document.querySelector('button');
var inputs = document.querySelectorAll('input');

btnClear.addEventListener('click', () => {
    inputs.forEach(input =>  input.value = '');
}); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-21T23:06:06.887

你可以`HTMLFormElement.prototype.reset`根据[MDN使用](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/reset)

```
document.getElementById("myForm").reset(); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-07-29T12:19:11.370

您可以分配给`onsubmit`属性：

```
document.querySelector('form').onsubmit = e => {
   e.target.submit();
   e.target.reset();
   return false;
}; 
```

[https://developer.mozilla.org/docs/Web/API/GlobalEventHandlers/onsubmit](https://developer.mozilla.org/docs/Web/API/GlobalEventHandlers/onsubmit)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-01T12:37:02.953

```
btnSave.addEventListener("click", () => {
  inputs.forEach((input) => (input.value = ""));
});
```

**点击后使用要清除输入的按钮而不是 btnSave **

# linux - 是否可以在单个服务器上为多个版本的 Red hat Linux 构建软件包？

> ID：14589194
> 
> 赞同：1
> 
> 时间：2013-01-29T17:57:16.460
> 
> 标签：linux, build, package

我有一组用于分析辐射数据的程序，我想为`Red Hat Linux`版本构建包`4.x`- `6.x`. 是否可以在运行单个版本的 Red Hat Linux 的单个构建服务器上构建这些包，或者我需要在运行版本 4.x 的服务器上构建版本 4.x 包并在服务器上构建版本 5.x 包运行版本 5.x？

如果我可以在单个服务器上为多个版本构建包，那么该服务器必须运行最新版本还是最旧版本的操作系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:07:56.673

1.  您需要`toolchain` 为不同的操作系统环境（Redhat 4.x 和 5.x 的工具链）进行构建，并且在工具链中，您可以为特定的操作系统构建包。工具链就像一个`chroot`环境。

2.  `KVM`您可以使用单个节点创建多个虚拟机并构建多个版本的包。

3.  您可以使用`UML`非常有趣的（用户模式 ​​Linux）...查看以下链接 [http://uml.devloop.org.uk/howto.html](http://uml.devloop.org.uk/howto.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:21:30.473

您可以在 chroot 监狱中构建您的软件包。您可以使用[mach](http://thomas.apestaart.org/projects/mach/)来执行此操作。这是一个[关于使用 mach 构建包的教程，](http://www.howtoforge.com/building-rpm-packages-in-a-chroot-environment-using-mach)您可以参考，尽管它可能已经过时。

# wolfram-mathematica - (* ::Input:: *) 在mathematica中是什么意思

> ID：14589195
> 
> 赞同：0
> 
> 时间：2013-01-29T17:57:29.657
> 
> 标签：wolfram-mathematica, maxima

我目前正在尝试将代码从**数学**转换为**maxima**。我不断遇到 `(* ::Input:: *)`，我不确定这意味着什么。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:17:31.737

`(* <anything> *)`表示评论。

就像`/* <anything> */`在`C++`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T10:16:54.420

[请参阅此处](http://reference.wolfram.com/mathematica/tutorial/TheSyntaxOfTheMathematicaLanguage.html)的文档。您也可以从[这里](http://reference.wolfram.com/mathematica/guide/Mathematica.html)开始，使用搜索引擎进入 Mathematica 文档。

# cocos2d-iphone - 我到底需要学习什么才能使用 cocos2d 和 cocos2d-x？

> ID：14589197
> 
> 赞同：1
> 
> 时间：2013-01-29T17:57:35.377
> 
> 标签：cocos2d-iphone, cocos2d-x, cocos2d-android

万一这有什么不同，我正在为 cocos2d-x 学习 c++

我知道这些 STL、OOP 和封装是什么意思。

我擅长循环，我对功能也很好。

我仍在研究类，我知道方法和成员值是什么，但我需要知道如何制作复杂的类还是只需要使用 em？

无论如何我都会从指针开始，但我想知道我需要使用它吗？

我需要学习所有的java来制作android部分吗？

我只是想知道我是否需要专注于某些事情，因为我正在自学并且我想尽可能地做好准备。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T03:42:36.590

我能给你的最好建议是开始为 cocos2d 或 2d-x 编程，无论你想使用什么。在您真正开始使用它之前，您不会学习它。

也就是说，

> 我仍在研究类，我知道方法和成员值是什么，但我需要知道如何制作复杂的还是只需要使用 em？

如果你的问题是，如果你应该学习如何制作自己的物品，是的，你绝对应该。面向对象的编程就是这样。

> 无论如何我都会从指针开始，但我想知道我需要使用它吗？

是的，您将需要使用它们。您在代码中看到的 *s 是指针。我 100% 确定没有它们你就无法创建游戏。

> 我需要学习所有的java来制作android部分吗？

不，您不需要学习“全部”Java。如果您使用 cocos2d-x，您将使用 c++ 编写代码，但是您需要了解如何创建 android 应用程序来创建项目和组织文件夹，以便正确构建它。

总体而言，您似乎才刚刚开始学习编程，这很棒。当我开始时，我不知道从什么开始，但根据我的个人经验，最好是开始制作一些东西。是的，所有的概念和基础知识都很重要，但在你真正使用它们并开始弄清楚事情是如何工作的之前，它不会真正粘在你身上。

最后如果你对 cocos2d-x 感兴趣

[最全的 Cocos2d-x 教程指南列表](https://stackoverflow.com/questions/10711047/the-completest-cocos2d-x-tutorial-guide-list)

尝试从上面的链接中查看一些东西。

对于 cocos2d 教程，Ray Wenderlich 提供了很棒的教程。

[http://www.raywenderlich.com/](http://www.raywenderlich.com/)

我不知道你到底对什么感兴趣...如果是创建应用程序，我建议你从没有 Cocos2d 的 iPhone 上的普通应用程序开始，但如果你真的只是想做游戏，我建议你从 cocos2d 开始而不是 cocos2d -X。我已经有一段时间没有使用 cocos2d-x 了，但是它有很多错误和小故障......希望它现在更好。另一方面，Cocos2d 通常非常稳定且易于使用。

祝你好运！

# android - VideoView 之上的 MediaController

> ID：14589198
> 
> 赞同：3
> 
> 时间：2013-01-29T17:57:36.757
> 
> 标签：android, media-player, android-videoview, mediacontroller

我需要在其顶部底部显示带有操作栏的视频。

我目前正在将 VideoView 与 MediaController 一起使用，但我找不到将 MediaController 放在 VideoView 顶部底部的方法。

实际上，我什至无法将 MediaController 放在 VideoView 之外，而是在它的底部！它总是出现在 VideoView 底部的某个地方，但有很大的填充！

我当前的代码是：

```
 VideoView video_view = (VideoView) getView().findViewById(R.id.video_view);
            video_view.setVideoURI(video_uri);

            MediaController controller = new MediaController(video_view.getContext())
            {
                @Override
                public void hide()
                {
                    this.show(0);
                }

                @Override
                public void setMediaPlayer(MediaPlayerControl player)
                {
                    super.setMediaPlayer(player);
                    this.show();
                }
            };

                    controller.setAnchorView(video_view);
            video_view.setMediaController(controller);
            video_view.start(); 
```

# c# - 从后面的代码将自定义列表对象属性绑定到文本框

> ID：14589200
> 
> 赞同：0
> 
> 时间：2013-01-29T17:57:49.547
> 
> 标签：c#, wpf, binding

**学生班**

```
public class Student
{
    string name;        

    List<SubjectInfo> subjectInfoList;        

    ....
} 
```

`List<SubjectInfo>`对于不同的学生，列表可以有不同数量的`SubjectInfo`对象。

**主题信息类**

```
public class SubjectInfo
{
    string subjectCode;

    int marks;

    ...
} 
```

我想在窗口上显示学生对象的详细信息。由于**List**有不同数量的对象计数，我从后面的代码中生成了这些。

```
int i = 10;

        foreach (SubjectInfo info in student.SubjectInfoList)
        {
            TextBox tb = new TextBox();
            tb.Width = 200;
            tb.Height = 20;
            tb.Margin = new Thickness(10, i, 0, 0);
            StudentDataGrid.Children.Add(tb);
            i += 60;
        } 
```

我想从后面的代码中绑定这个**列表列表。**但我不知道这样做。
我想绑定**标记**属性`student.SubjectInfoList`

请帮助我从代码隐藏中绑定列表对象属性。

**编辑**
这是示例学生对象；

```
Student student = new Student("Joe", new List<SubjectInfo>() { new SubjectInfo("Subject1", 50), new SubjectInfo("Subject2", 70)}); 
```

我的窗口应该是这样的；
![在此处输入图像描述](../Images/d45bcf1d2ab86d0bb267bcf5d85537b8.png)

**注意**如果学生做 4 个科目的总计`TextBox`数是 5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:11:22.813

最好在 XAML 中进行。但是，如果您真的想在代码隐藏中执行此操作，请尝试此操作。SubjectInfo 的字段必须是公开的。

```
foreach (SubjectInfo info in student.SubjectInfoList)
{
   TextBox tb = new TextBox();
   ///...
   tb.DataContext = info;
   Binding binding = new Binding("marks");
   tb.SetBinding(TextBox.TextProperty, binding);
   ///...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:11:51.820

纯 XAML 解决方案：

```
<Window  (... your window attributes) >

    ....

    <Grid x:Name="StudentDataGrid">
        <ListView ItemsSource="{Binding SubjectInfoList}">
            <ListView.ItemTemplate>
                <DataTemplate DataType="{x:Type local:SubjectInfo}">
                    <TextBox Text="{Binding Marks}"/>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</Window> 
```

但是要让它工作，你必须将你的字段转换为公共属性：

```
public class Student
{
    string name;        

    public List<SubjectInfo> SubjectInfoList { get; set; }

    ....
} 
```

和：

```
public class SubjectInfo
{
    string subjectCode;

    public int Marks { get; set; }

    ...
} 
```

### 更新

XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        Title="MainWindow" Height="350" Width="525">

    <Grid x:Name="StudentGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <TextBlock Text="Student name :" Grid.Row="0" Grid.Column="0"/>
        <TextBlock Text="Student marks :" Grid.Row="1" Grid.Column="0"/>

        <TextBox Text="{Binding Name}" Grid.Row="0" Grid.Column="1" />

        <ListView Grid.Row="1" Grid.Column="1" ItemsSource="{Binding SubjectInfoList}" BorderThickness="0">
            <ListView.ItemTemplate>
                <DataTemplate DataType="{x:Type local:SubjectInfo}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="{Binding SubjectCode}"/>
                        <TextBox Grid.Column="1" Text="{Binding Marks}"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</Window> 
```

编码：

```
using System.Collections.Generic;
using System.Windows;

namespace WpfApplication1
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            Student student = new Student("Joe", new List<SubjectInfo>() { new SubjectInfo("Subject1", 50), new SubjectInfo("Subject2", 70) });
            StudentGrid.DataContext = student;
        }
    }

    public class Student
    {
        public string Name { get; set; }
        public List<SubjectInfo> SubjectInfoList { get; set; }

        public Student(string name, List<SubjectInfo> list)
        {
            Name = name;
            SubjectInfoList = list;
        }
    }

    public class SubjectInfo
    {
        public string SubjectCode { get; set; }
        public int Marks { get; set; }

        public SubjectInfo(string subjectCode, int marks)
        {
            SubjectCode = subjectCode;
            Marks = marks;
        }
    }
} 
```

# android - 当意图服务停止时，我如何在主要活动中启动一个功能？

> ID：14589201
> 
> 赞同：0
> 
> 时间：2013-01-29T17:57:50.547
> 
> 标签：android, android-intent, broadcastreceiver

我创建了一个带有警报服务的应用程序并在用户设置 Timepicker 时播放警报 mp3 文件。警报服务类从带有警报管理器的广播接收器开始...我希望在停止警报服务时返回主要活动并启动发送功能蓝牙数据。我该怎么做？我用第二个接收器试试这个，但没有工作......

```
public class AlarmService extends IntentService {

public String response="";

MediaPlayer mPlayer;

  public AlarmService() {
    super("AlarmService");
  }

  // Will be called asynchronously be Android
  @Override
  protected void onHandleIntent(Intent intent) {

      mPlayer = MediaPlayer.create(AlarmService.this, R.raw.alarm);
      mPlayer.start();

       String data="start";
       Intent intentsend=new Intent("update");//Send data to update UI
       intentsend.putExtra( "Alarmdata",data);
       sendBroadcast(intentsend);

  } 
```

并在主要活动中......

```
 @Override
public void onResume() {
    super.onResume();

     updateReceiver=new BroadcastReceiver() {
          @Override
          public void onReceive(Context context, Intent intentsend) {
              //get extras, do some stuff
            String data1 = intentsend.getStringExtra("Alarmdata");
            if(data1=="start"){
            String data2="1";

         Toast.makeText(context, "Test updateReceiver!",Toast.LENGTH_LONG).show();

            try {
                sendData(data2);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            }

          }
      };
      IntentFilter updateIntentFilter=new IntentFilter("update");
      registerReceiver(updateReceiver, updateIntentFilter);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:12:55.283

使用 Handler 和 Messaging 来实现你想要的一个简单的例子就是这样。

首先发送您的工作已完成的消息

```
Message message = new Message();
    message.getData().putString("text",
            "exitedtask");
    Messenger messenger = new Messenger(
            completionHander);
    try {
        messenger.send(message);
    } catch (RemoteException e) {
        e.printStackTrace();
    } 
```

然后使用 Handler 来处理应该发生的事情

```
protected Handler completionHander = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            if (msg.getData().getString("text")
                    .equalsIgnoreCase("exitedtask")) {
                //do you work here
            }
        }
    }; 
```

# sockets - 双向发布者/订阅者 TCP 连接握手协议

> ID：14589202
> 
> 赞同：0
> 
> 时间：2013-01-29T17:57:54.673
> 
> 标签：sockets, distributed-computing, publish-subscribe

我想编写一个发布者/订阅者分布式应用程序，其中每个节点可以同时发布和订阅数据（按主题）。为简单起见，假设有一个阶段，发布者/订阅者首先向中央服务器报告他们想要发布/订阅的内容。当这完成时，服务器将信息发送给订阅者，他们应该连接到那里以接收发布（按主题）。因为节点可以发布和订阅，所以节点A可以连接到另一个节点B进行订阅，然后节点B也可以连接到节点A，因为它想订阅节点A发布的一些数据。这是一个循环的“依赖”。

我现在遇到的问题是，我确实希望只保留一个套接字用于两侧的这两个节点的通信，两者都用于发布数据和接收数据，因为套接字已经是一个双向结构。假设两个节点都有一个侦听端口的套接字侦听器。两个节点同时相互连接，哪个连接将被接受，哪个连接被丢弃？什么协议适合这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T00:55:42.173

这个过程类似于这个[开源网络库](http://www.networkcomms.net)使用的握手过程。一旦建立了连接 A -> B 或 B -> A，则单个现有连接将用于所有通信。您最好的选择可能是通过查看[入门](http://www.networkcomms.net/getting-started/)部分或[如何创建客户端服务器应用程序](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)文章来查看它的实际效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:30:28.543

一个很好的匹配你的问题可能是一些[DDS](http://en.wikipedia.org/wiki/Data_distribution_service)（数据分发服务）实现。它完全消除了任何具体端点的概念，只关注主题/数据。任何节点都可以充当主题/数据的生产者和消费者。DDS 中间件负责所有寻址、状态传播、序列化/反序列化、流控制等。它还处理（自动）发现新主题和数据。

这是一个[描述 DDS 工作原理的简短视频](http://www.youtube.com/watch?v=u-saogMmKOo)：

这是[各种 DDS 实现](http://portals.omg.org/dds/category/web-links/vendors)（商业和免费）的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T00:01:18.987

一个套接字可能是双向的，但它不能同时连接到两个端点。你需要：

*   与中央服务器的活动（客户端）连接
*   另一个连接到中央服务器告诉你连接的任何东西
*   一个监听（服务器）套接字，因此您可以接受入站连接
*   每个入站连接接受的套接字。

# php - 如何使用 APIfoursquare -PHP 显示日期

> ID：14589208
> 
> 赞同：0
> 
> 时间：2013-01-29T17:58:10.223
> 
> 标签：php, foursquare

我正在创建一个可以查看签到的应用程序，我实现了显示一些数据，但我无法显示日期，我阅读了 API 文档，发现以下内容：

```
 id: "5107ed69704379518de3cb5f"
    createdAt: 1359474025
    type: "checkin"
    timeZoneOffset: -420
    user: {
        id: "46466115"
        firstName: "Abraham"
        lastName: "Gonzalez"
        gender: "male"
        relationship: "self"
        photo: {
            prefix: "https://irs3.4sqi.net/img/user/"
            suffix: "/JB543SD4TURRQR2A.jpg"
        } 
```

我尝试实现它，但它显示了一串数字，我想知道如何解释这些数字，我做了一些研究，发现数字是秒（[http://www.epochconverter.com/](http://www.epochconverter.com/)），但我不知道如何解释它们：（

这是我的php代码：

```
$check_ins =json_decode(file_get_contents("https://api.foursquare.com/v2/users/self/checkins?oauth_token={$_SESSION['access_token']}"));
foreach($check_ins->response->checkins->items as $check_in):
        echo"

            <b>Lugar</b>: ".$check_in->venue->name."
            <br><b>Pais</b>: ".$check_in->venue->location->country."
            <br><b>Ciudad</b>: ".$check_in->venue->location->city."
            <br><b>Estado</b>: ".$check_in->venue->location->state."
            <b><br>Dirección</b>: ".$check_in->venue->location->address."
            **<b><br>Dirección</b>: ".$check_in->createdAt."**
            <br><br>";  
endforeach; 
```

所以，我的问题是：如何显示日期/或如何解释foursquare给我的数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:01:53.357

您是否尝试过[date()](http://php.net/manual/en/function.date.php)：

```
echo date("F j, Y H:i:s", $check_in->createdAt); 
```

它只是一个时间戳，所以基本的日期函数应该可以工作。如果我误解了，请评论，我可以更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:02:11.073

这显然是一个 Unix 时间戳值。您可以使用 PHP`date()`函数或`DateTime`对象将其转换为人类可读的格式。

现在尚不清楚该时间戳是否包含时区偏移值（即时间戳本地化到时区，因此您需要对其应用偏移以获取 UTC），或者它是否是 UTC 值并且您需要申请偏移量以获取签到的本地化时间。您可能需要查看文档，或者只是做一些实验来找出答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:02:31.093

该数字是时间戳。您可以使用 date 函数将其转换为人类可读的字符串：

```
date('Y-m-d H:i:s', $yourNumber); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T18:02:47.443

使用PHP的日期函数：，第一部分是你想要的格式，第二部分是unix时间戳：

```
echo date('d m Y h:i', 1359474025);

29 01 2013 04:40 
```

# ruby-on-rails - 如何将打包的所见即所得编辑器集成到我的 Rails 应用程序中

> ID：14589211
> 
> 赞同：1
> 
> 时间：2013-01-29T17:58:17.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, wysiwyg, wysihtml5

我决定使用[bootstrap-wysihtml5-rails](https://github.com/Nerian/bootstrap-wysihtml5-rails)，这是一个打包的所见即所得编辑器，内置 Twitter 引导程序。我的问题是关于如何“激活”我使用`form_for`助手创建的表单中的编辑器。

我有以下表格，我想在其中使用所见即所得编辑器：

```
<%= form_for(@question) do |f| %> 

  <%= f.label :title, "Title" %>
  <%= f.text_field :title %>

  <%= f.label :content, "Content" %>
  <%= f.text_area :content %> <!-- make this into wysiwyg editor -->

  <%= f.submit "Create question", class: "btn btn-large btn-primary" %>
<% end %> 
```

说明只需添加以下内容：

```
<textarea id="some-textarea" class='wysihtml5' placeholder="Enter text ..."></textarea>

<script type="text/javascript">
  $('.wysihtml5').each(function(i, elem) {
    $(elem).wysihtml5();
  });
</script> 
```

但是，对于如何仅切换`text_area`部分以使其成为所见即所得的方式，我有点迷茫。我查看了[Rails 指南](http://guides.rubyonrails.org/form_helpers.html)，`form_for`但没有看到如何插入 javascript 甚至将 css 类应用于特定字段。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:01:01.417

将 html 类添加`'wysihtml5'`到要在其上实现编辑器的任何 text_area。

```
<%= f.text_area :content, class: 'wysihtml5' %> 
```

您可以按照建议将脚本内联粘贴，也可以将全局初始化程序放在`app/assets/javascipts/application.js`：

```
$(function() {
  $('.wysihtml5').each(function(i, elem) {
    $(elem).wysihtml5();
  });
}) 
```

# python - OpenCV 2.4.3 的最小 Python 构建

> ID：14589214
> 
> 赞同：3
> 
> 时间：2013-01-29T17:58:21.493
> 
> 标签：python, opencv, build, cmake

我正在使用 OpenCV 的 Python 绑定来调用函数`matchTemplate`。这是我需要的唯一功能。为了能够调用`matchTemplate`，我必须将 OpenCV 的 python 绑定`cv2.pyd`与我的 (Windows) 应用程序一起提供，该应用程序重达 9MB。

有没有什么方法可以构建（Python 绑定）OpenCV，只包含我需要的模块`cv2.pyd`？`matchTemplate`似乎是`imgproc`模块的一部分，所以我认为我只需要 OpenCV`core`和`imgproc`.

我已经尝试过使用 OpenCV 的 CMake 选项，并且我想我已经设法只构建了一些模块。但是，一旦我禁用单个模块，比如`calib3d`将 CMake 设置`BUILD_OPENCV_calib3d`为 false，我也会“丢失”Python 构建。换句话说，当我使用 CMake 生成 Visual Studio 解决方案文件以构建除`calib3d`和*with* `python`之外的所有模块时，Visual Studio 解决方案包含除 and 之外的所有`calib3d` *模块* `python`。我尝试通过从调用`python`中删除来修改模块的 CMakeLists 文件`calib3d``ocv_add_module`

```
ocv_add_module(python BINDINGS opencv_core opencv_flann ...) 
```

以及包含标题的设置

```
set(opencv_hdrs
    "${OPENCV_MODULE_opencv_core_LOCATION}/include/opencv2/core/core.hpp"
    ... 
```

不幸的是，无济于事。有人知道怎么做这个吗？

我正在使用 Microsoft Visual Studio 2012 进行构建。

谢谢！

# xcode - CFArrayGetValueAtIndex 不会获得社交资料

> ID：14589216
> 
> 赞同：0
> 
> 时间：2013-01-29T17:58:39.520
> 
> 标签：xcode, ios5, ios6, addressbook

如果我尝试，我无法在 CFArrayGetValueAtIndex 获得社交资料信息（推特、脸书）。其他所有信息，如姓名、号码、www 我都知道了。我用 ABPersonCreateVCardRepresentationWithPeople 创建了一个 vCard，如果我尝试输出，我会得到如下信息：

```
BEGIN:VCARD
VERSION:3.0
PRODID:-//Apple Inc.//iOS 10.7.5//EN
N:lastname;Firstname;;;
FN:Firstname lastname
ORG:company;
TITLE:Jobtitle
item1.EMAIL;type=INTERNET;type=pref:my@mail.com
item1.X-ABLabel:Global
TEL;type=IPHONE;type=CELL;type=VOICE;type=pref:049651651561
item2.URL;type=pref:Www.com.com
item2.X-ABLabel:_$!<HomePage>!$_
X-SOCIALPROFILE;type=twitter;x-user=Twitteracc:http://twitter.com/Twitteracc
X-SOCIALPROFILE;type=facebook;x-user=Face.book:http://www.facebook.com/Face.book
END:VCARD 
```

我试图取回信息的代码是：

```
ABAddressBookRef book = ABAddressBookCreate();
ABRecordRef defaultSource = ABAddressBookCopyDefaultSource(book);

CFDataRef vCardData = (__bridge CFDataRef)[vCardString dataUsingEncoding:NSUTF8StringEncoding];
CFArrayRef vCardPeople = ABPersonCreatePeopleInSourceWithVCardRepresentation(defaultSource, vCardData);
ABRecordRef person = CFArrayGetValueAtIndex(vCardPeople, 0); 
```

...人没有社交信息。后来我尝试附加社交信息，也是一个错误。它只有在我创建一个新的 ABPersonCreate() 时才有效......所以这是我的错误吗？或者它还不能工作？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T12:43:22.290

这将是 SDK 中的一个错误......所以你唯一能做的就是分离字符串并创建一个新的 ABPerson - 使用 ABPersonCreate() - 看看我的代码 - 它对我有用。

-(NSMutableDictionary *)getMyVCardObjects:(NSString *)vCardString{

```
NSString *firstname;
NSString *lastname;
NSString *pos;
NSString *company;
NSString *email;
NSString *www;
NSString *tel;
NSString *twitterUserName;
NSString *facebookUserName;

NSArray *myArr = [vCardString componentsSeparatedByString:@"\n"];
for (int i=0; i<[myArr count]; i++) {

    //vorname nachname
    if ([[myArr objectAtIndex:i] rangeOfString:@"FN:"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@":"];
        if ([tempArray count] >= 2) {
            firstname = [[[tempArray objectAtIndex:1]componentsSeparatedByString:@" "] objectAtIndex:0];
            lastname = [[[tempArray objectAtIndex:1]componentsSeparatedByString:@" "] objectAtIndex:1];
        }
    }

    //company
    if ([[myArr objectAtIndex:i] rangeOfString:@"ORG:"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@":"];
        company = [[[tempArray objectAtIndex:1]componentsSeparatedByString:@";"] objectAtIndex:0];
    }

    //title = pos
    if ([[myArr objectAtIndex:i] rangeOfString:@"TITLE:"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@":"];
        pos = [tempArray objectAtIndex:1];
    }

    //email
    if ([[myArr objectAtIndex:i] rangeOfString:@"EMAIL;"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@";"];
        email = [[[tempArray objectAtIndex:2]componentsSeparatedByString:@":"] objectAtIndex:1];
    }

    //tel
    if ([[myArr objectAtIndex:i] rangeOfString:@"VOICE;"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@";"];
        tel = [[[tempArray objectAtIndex:4]componentsSeparatedByString:@":"] objectAtIndex:1];
    }

    //www
    if ([[myArr objectAtIndex:i] rangeOfString:@"URL;"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@";"];
        www = [[[tempArray objectAtIndex:1]componentsSeparatedByString:@":"] objectAtIndex:1];
    }

    //twitter
    if ([[myArr objectAtIndex:i] rangeOfString:@"twitter"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@";"];

        if ([[tempArray objectAtIndex:1] rangeOfString:@"type=twitter"].location != NSNotFound) {

            twitterUserName = [[[[[tempArray objectAtIndex:2]componentsSeparatedByString:@"="] objectAtIndex:1] componentsSeparatedByString:@":"] objectAtIndex:0];

        }

    }

    if ([[myArr objectAtIndex:i] rangeOfString:@"facebook"].location != NSNotFound) {

        NSArray *tempArray = [[myArr objectAtIndex:i] componentsSeparatedByString:@";"];

        if ([[tempArray objectAtIndex:1] rangeOfString:@"type=facebook"].location != NSNotFound) {

            facebookUserName = [[[[[tempArray objectAtIndex:2]componentsSeparatedByString:@"="] objectAtIndex:1] componentsSeparatedByString:@":"] objectAtIndex:0];

        }

    }
}
return [NSMutableDictionary dictionaryWithObjects:[NSArray arrayWithObjects:firstname,lastname,pos,company,email,www,tel,twitterUserName,facebookUserName, nil] forKeys:[NSArray arrayWithObjects:@"firstname",@"lastname",@"pos",@"company",@"email",@"www",@"tel",@"twitterUserName",@"facebookUserName", nil]]; 
```

}

玩得开心。

# java - 列表视图中的短信

> ID：14589223
> 
> 赞同：-2
> 
> 时间：2013-01-29T17:59:26.420
> 
> 标签：java, android, sms

我有一个大问题。我想得到一个**短信**列表并将它们保存在一个`list view`但我做不到！我在谷歌上搜索，我尝试的所有代码都给我错误并强制关闭。你能帮助我吗？这是我的代码。你能帮我如何编写代码以在列表视图中显示短信吗？我在 caricaMessaggi() 方法中加载短信。然后，我调用方法`caricaMessaggi()`来`onResume()`更新它们。

```
/**
 * Copyright 2012 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.media9.dizionarioalbhed;

import java.util.ArrayList;

import android.app.ActionBar;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentStatePagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.TextView;

public class MainActivity extends FragmentActivity {
     /**
     * The {@link android.support.v4.view.PagerAdapter} that will provide
     * fragments representing each object in a collection. We use a
     * {@link android.support.v4.app.FragmentStatePagerAdapter} derivative,
     * which will destroy and re-create fragments as needed, saving and
     * restoring their state in the process. This is important to conserve
     * memory and is a best practice when allowing navigation between objects in
     * a potentially large collection.
     */
    CollectionPagerAdapter mCollectionPagerAdapter;
    boolean avviato = false; 
    /**
     * The {@link android.support.v4.view.ViewPager} that will display the
     * object collection.
     */
    ViewPager mViewPager;
    EditText txtIt_AL;
    EditText txtAl_AL;
    EditText txtIt;
    EditText txtAl;
    private EditText etInput;
    private Button btnAdd;
    private ListView lvItem;
    private ArrayList<String> itemArrey;
    private ArrayAdapter<String> itemAdapter;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Create an adapter that when requested, will return a fragment
        // representing an object in
        // the collection.
        //
        // ViewPager and its adapters use support library fragments, so we must
        // use
        // getSupportFragmentManager.
        mCollectionPagerAdapter = new CollectionPagerAdapter(
            getSupportFragmentManager());

        // Set up action bar.
        final ActionBar actionBar = getActionBar();

        // Specify that the Home button should show an "Up" caret, indicating
        // that touching the
        // button will take the user one step up in the application's hierarchy.
        actionBar.setDisplayHomeAsUpEnabled(true);

        // Set up the ViewPager, attaching the adapter.
        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mCollectionPagerAdapter);
    }
    @Override
    protected void onStart() {
        super.onStart();
        // The activity is about to become visible.
    }
    @Override
    protected void onResume() {
        super.onResume();
        // The activity has become visible (it is now "resumed").
    }
    @Override
    protected void onPause() {
        super.onPause();
        // Another activity is taking focus (this activity is about to be "paused").
    }
    @Override
    protected void onStop() {
        super.onStop();
        // The activity is no longer visible (it is now "stopped")
    }

    /**
     * A {@link android.support.v4.app.FragmentStatePagerAdapter} that returns a
     * fragment representing an object in the collection.
     */
    public class CollectionPagerAdapter extends FragmentStatePagerAdapter {

    final int NUM_ITEMS = 4; // number of tabs

    public CollectionPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = new TabFragment();
        Bundle args = new Bundle();
        args.putInt(TabFragment.ARG_OBJECT, i);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        return NUM_ITEMS;
    }

    @Override
    public CharSequence getPageTitle(int position) {

        String tabLabel = null;
        switch (position) {
        case 0:
        tabLabel = getString(R.string.label1);
        break;
        case 1:
        tabLabel = getString(R.string.label2);
        break;
        case 2:
        tabLabel = getString(R.string.label3);
        break;
        case 3:
        tabLabel = getString(R.string.label4);
        break;
        }
        return tabLabel;
    }
    }

    /**
     * A dummy fragment representing a section of the app, but that simply
     * displays dummy text.
     */
    public static class TabFragment extends Fragment {

    public static final String ARG_OBJECT = "object";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

        Bundle args = getArguments();
        int position = args.getInt(ARG_OBJECT);

        int tabLayout = 0;
        switch (position) {
        case 0:
        tabLayout = R.layout.tab1;
        break;
        case 1:
        tabLayout = R.layout.tab2;
        break;
        case 2:
        tabLayout = R.layout.tab3;
        break;
        case 3:
        tabLayout = R.layout.tab4;
        break;
        }

        View rootView = inflater.inflate(tabLayout, container, false);

        return rootView;
    }

    }

    public void btnTraduzione_onClick(View view)
    {
        txtIt = (EditText) findViewById(R.id.txtIt);
        txtAl = (EditText) findViewById(R.id.txtAlb);
        txtAl.setText(FunzioniGenerali.italiano2albhed(txtIt));
    }

    public void btnInvia_onClick(View view)
    {
        txtAl = (EditText) findViewById(R.id.txtAlb);
        String shareBody = txtAl.getText().toString();
        Intent sharingIntent = new Intent(android.content.Intent.ACTION_SEND);
        sharingIntent.setType("text/plain");
        //sharingIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Subject Here");
        sharingIntent.putExtra(android.content.Intent.EXTRA_TEXT, shareBody);
        startActivity(Intent.createChooser(sharingIntent, getResources().getString(R.string.share_using)));

        /**txtAl = (EditText) findViewById(R.id.txtAlb);
        Intent smsIntent = new Intent(Intent.ACTION_VIEW);
        smsIntent.setType("text/plain");
        //smsIntent.putExtra("address", "12125551212");
        smsIntent.putExtra("sms_body",txtAl.getText().toString());
        startActivity(smsIntent);*/
    }

    public void btnTraduzioneAl_onClick(View view)
    {
        txtIt_AL = (EditText) findViewById(R.id.txtIt_AL);
        txtAl_AL = (EditText) findViewById(R.id.txtAlb_AL);
        txtAl_AL.setText(FunzioniGenerali.albhed2Italiano(txtIt_AL));

    }
    Uri uri;
    String[] body;
    String[] number;
    @SuppressWarnings("deprecation")
    public void caricaMessaggi()
    {
        Cursor c = null;
        uri = Uri.parse("content://sms/inbox");
        c= getContentResolver().query(uri, null, null ,null,null);
        c.requery();
        startManagingCursor(c);
        body = new String[c.getCount()];
        number = new String[c.getCount()]; 
        if(c.moveToFirst()){
                for(int i=0;i<10;i++){//c.getCount()
                        body[i]= c.getString(c.getColumnIndexOrThrow("body")).toString();
                        number[i]=c.getString(c.getColumnIndexOrThrow("address")).toString();
                        c.moveToNext();
                }
        }
        /**for(int i=0; i<10; i++)
        {
            AlertDialog.Builder miaAlert = new AlertDialog.Builder(this);
            miaAlert.setTitle(number[i]);
            miaAlert.setMessage(body[i]);
            AlertDialog alert = miaAlert.create();
            alert.show();
        }*/
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:10:46.960

在这里，您有从收件箱中获取所有短信的代码：

```
ArrayList<String> arr = new ArrayList<String>();

StringBuilder smsBuilder = new StringBuilder();
       final String SMS_URI_INBOX = "content://sms/inbox"; 
        final String SMS_URI_ALL = "content://sms/";  
        try {  
            Uri uri = Uri.parse(SMS_URI_INBOX);  
            String[] projection = new String[] { "_id", "address", "person", "body", "date", "type" };  
            Cursor cur = getContentResolver().query(uri, projection, "address=123456789", null, "date desc");
             if (cur.moveToFirst()) {  
                int index_Address = cur.getColumnIndex("address");  
                int index_Person = cur.getColumnIndex("person");  
                int index_Body = cur.getColumnIndex("body");  
                int index_Date = cur.getColumnIndex("date");  
                int index_Type = cur.getColumnIndex("type");         
                do {  
                    String strAddress = cur.getString(index_Address);  
                    int intPerson = cur.getInt(index_Person);  
                    String strbody = cur.getString(index_Body);  
                    long longDate = cur.getLong(index_Date);  
                    int int_Type = cur.getInt(index_Type);  

                    smsBuilder.append("[ ");  
                    smsBuilder.append(strAddress + ", ");  
                    smsBuilder.append(intPerson + ", ");  
                    smsBuilder.append(strbody + ", ");  
                    smsBuilder.append(longDate + ", ");  
                    smsBuilder.append(int_Type);  
                    smsBuilder.append(" ]\n\n"); 

arr.add(smsBuilder.toString());
                } while (cur.moveToNext());  

                if (!cur.isClosed()) {  
                    cur.close();  
                    cur = null;  
                }  
            } else {  
                smsBuilder.append("no result!");  
            } // end if  
            }
        } catch (SQLiteException ex) {  
            Log.d("SQLiteException", ex.getMessage());  
        } 
```

您必须在清单中拥有此权限：

`<uses-permission android:name="android.permission.READ_SMS" />`

如果要创建`ListView`use `ListActivity`，请创建如下布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/mylist"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

并使用适配器：

`ListView listView = (ListView) findViewById(R.id.mylist);` `ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,` `android.R.layout.simple_list_item_1, android.R.id.text1, arr);`

现在应该没问题。如果您有更多问题，请在评论中写下。如果我的问题对您有帮助，请给我投票并接受我的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T02:15:32.407

除了[Ty221](https://stackoverflow.com/users/1952862/ty221)响应：在查询子句中我认为字符串地址格式是正确的

```
Cursor cur = getContentResolver().query(uri, projection, "address=\"123456789\"", null, "date desc"); 
```

# c# - 引用另一个类中的随机用户信息

> ID：14589224
> 
> 赞同：0
> 
> 时间：2013-01-29T17:59:31.857
> 
> 标签：c#, testing

我正在尝试引用在我将要使用它们的另一个类中创建的一个类中生成的一些随机用户。

```
public static void RandUserName(string domain, string FullName, string Email)
            {
                string firstName = "";
                string lastName = "";
                string phone = "";
                RandomUserName(domain, firstName, lastName, Email, phone);
                FullName = String.Format("{0} {1}.com", firstName, lastName);
        }

Public static void RandName(string FirstName, string LastName)
        {            
            string[] maleNames = new string [1000]{"aaron", "abdul", "abe", "abel"}; 
            string[] femaleNames = new string [1000] {"abby", "abigail", "ada"};
            string[] lastNames = new string[1000] {"abbott", "acevedo", "acosta"};

Random rand = new Random(DateTime.Now.Second);
            if (rand.Next(1, 2) == 1)
            {
                FirstName = maleNames[rand.Next(0, maleNames.Length-1)];
            }
            else
            {
                FirstName = femaleNames[rand.Next(0, femaleNames.Length-1)];
            }
        }

 public static string RandomUserName(string Domain, string FirstName, string LastName, string Email, string phone)
        {
            RandName(FirstName, LastName);
            if (string.IsNullOrEmpty(Domain))
            {
                Domain = String.Format("{0}{1}.com", FirstName, LastName);
            }

            Email = "Tester" + LastName + "@" + Domain;
            phone = "850-555-1234";
            return FirstName;
        } 
```

这是我想在 VB.net 中引用这些名称的地方。我正在尝试将其翻译为 c#，这些来自我提出的请求：

```
 RandInfo.RandomUserName(Domain, .PrimaryContact.FirstName, .PrimaryContact.LastName, .PrimaryContact.Email, .PrimaryContact.Phone)
                RandInfo.RandomUserName(Domain, .BillingContact.FirstName, .BillingContact.LastName, .BillingContact.Email, .BillingContact.Phone)
                RandInfo.RandomUserName(Domain, .TechContact.FirstName, .TechContact.LastName, .TechContact.Email, .TechContact.Phone)
                RandInfo.RandomUserName(Domain, .EmergencyContact.FirstName, .EmergencyContact.LastName, .EmergencyContact.Email, .EmergencyContact.Phone) 
```

对不起，如果这一切令人困惑！有什么需要了解和帮助的问题请提出来！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:18:50.610

首先：我认为您可能误解了函数/方法的概念。在`void`您的“RandUserName”函数中，您将声明返回类型。

一个小例子：

```
public string GetFullName(string firstName, string lastName)
{
    return firstName + " " + lastName;
} 
```

像这样的调用：

```
GetFullName("John", "Doe") 
```

将返回“John Doe”。一种（丑陋的）替代方法是将方法中的参数声明为输出参数，但我会尽量避免这种情况。

您想要实现的目标可以通过多种方式完成，我将从设计一个具有、等`User`属性的类开始。`FirstName``LastName``Phone`

然后您可以创建一个生成此类实例的函数，其属性填充随机值。但我想你必须为自己付出一些努力。

# mongodb - 你如何在mongo中按日期分组？

> ID：14589226
> 
> 赞同：0
> 
> 时间：2013-01-29T17:59:36.893
> 
> 标签：mongodb, pymongo, mongodb-query

我有一堆文件：

```
{"timestamp" : 1304535236, "value" : 2}
{"timestamp" : 1304532236, "value" : 5}
{"timestamp" : 1304535647, "value" : 1} 
```

`timestamp`Unix时间戳在哪里。我想总结一下每天的总数`value`。注意：可能有许多文档的时间戳落在同一天的不同时间。

如果我做一个普通的 mongo 组查询是每个时间戳的总和，因为它们都是唯一的，这是没有帮助的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:16:57.853

您必须将`timestamp`值转换为`Date`对象，以便您可以按天分组。

使用 Rachel 的回答作为起点（在 shell 中）：

```
db.test.group({
  keyf: function(doc) {
    var date = new Date(doc.timestamp*1000);
    var dateKey = (date.getMonth()+1) + "/" + 
                  date.getDate() + "/" + 
                  date.getFullYear();
    return {day: dateKey};
  },
  initial: {value: 0},
  reduce: function(curr, result) { result.value += curr.value; }
}); 
```

返回：

```
[
  {
    "day": "5/4/2011",
    "value": 8
  }
] 
```

# c# - 如何访问嵌套在 ListView 中的控件的属性？

> ID：14589227
> 
> 赞同：2
> 
> 时间：2013-01-29T17:59:40.347
> 
> 标签：c#, asp.net, listview

我想知道我们如何访问嵌套在 ListView 模板中的控件的属性？

我在 ListView 模板中有一个 CheckBox 控件，但当我尝试在代码隐藏文件中访问它时，它没有出现在 IntelliSense 中。

请告诉我如何在 codeBehind 文件中访问该 CheckBox 的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:25:04.717

您需要使用该`ItemDataBound`事件来获取对`CheckBox`控件的引用。在`ItemDataBound`事件处理程序中，您可以使用该`FindControl`方法（从传入的`ListViewItemEventArgs`）获取对在`ItemTemplate`.

要从`ItemDataBound`首页连接，只需执行以下操作：

```
<asp:ListView ID="lv1" OnItemDataBound="lv1_ItemDataBound" runat="server"> 
```

要获得对 a 的引用`CheckBox`（请参见下面的完整示例），代码如下所示：

```
private void lv1_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    //Get a reference and check each checkbox
    var chk = e.Item.FindControl("chkOne") as CheckBox;
    if (chk != null)
        chk.Checked = true;
} 
```

这是一个完整的例子：

```
<%@ Page Language="C#" AutoEventWireup="true" %>
<%@ Import Namespace="System.Collections.Generic" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ListView ID="lv1" OnItemDataBound="lv1_ItemDataBound" runat="server">
            <LayoutTemplate><div id="itemPlaceholder" runat="server"></div></LayoutTemplate>
            <ItemTemplate>
                <div><asp:CheckBox ID="chkOne" Runat="server" /> <%# Container.DataItem %></div>
            </ItemTemplate>
        </asp:ListView>    
    </div>
    </form>
</body>
</html>
<script runat="server">
public void Page_Load(object sender, System.EventArgs e)
{
    if(!Page.IsPostBack)
    {
        var items = new List<string> { "Item #1", "Item #2", "Item #3" };
        lv1.DataSource = items;
        lv1.DataBind();
    }
}

private void lv1_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    //Get a reference and check each checkbox
    var chk = e.Item.FindControl("chkOne") as CheckBox;
    if (chk != null)
        chk.Checked = true;
}
</script> 
```

# javascript - 阻止 JavaScript 截断前导 0

> ID：14589228
> 
> 赞同：3
> 
> 时间：2013-01-29T17:59:41.497
> 
> 标签：javascript

我通常使用以下代码将 PHP 变量导入 JavaScript：

```
echo("var zipCode = " . $zipCode . ";"); 
```

这很好用，但在以 0 开头的邮政编码上，它会截断它。

我试图找出一种方法来保持领先的 0。

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:00:29.333

然后把它变成一个字符串：

```
echo("var zipCode = '" . $zipCode . "';"); 
```

`'`注意连接前后的两个字符`$zipCode`。

我确定`$zipCode`你的 PHP 中有一个字符串，但是当你回显它时，它不包含引号。这意味着您生成的 Javascript 将如下所示：

```
var zipCode = 01234; 
```

并且没有理由将其存储为数字（在这种情况下，数字不正确，因为它会认为它是八进制数）。

因此，通过添加`'`字符，生成的 Javascript 变为：

```
var zipCode = '01234'; 
```

并且应该可以很好地进行操作，因为无论如何您实际上应该只对邮政编码进行字符串操作。

如果出于某种原因，您决定需要邮政编码的数字形式，则可以在 Javascript 中使用它：

```
var zipCodeNum = parseInt(zipCode, 10); 
```

重要的部分是`, 10`，因为这将强制转换以 10 为底，忽略任何前导`0`s。

# matlab - 为什么下面的表达式会导致错误？

> ID：14589230
> 
> 赞同：2
> 
> 时间：2013-01-29T17:59:53.387
> 
> 标签：matlab

免责声明。我熟悉 Mathematica 但不熟悉 Matlab，所以如果这是一个新手问题，我深表歉意。

在使用 Matlab 的求解命令时，我在 Matlab 上遇到了一个奇怪的错误：

```
solve(0.2 = (1.4+1/2)^((1.4+1)/(2*(1.4-1)))*(M)/((1+(1.4-1)/2*M^2))^((1.4+1)/(2*(1.4-1))), M) 
```

错误是：

```
Error: The expression to the left of the equals sign is not a valid target for an assignment. 
```

Mathematica 中等效的 Solve 命令（使用相同的表达式）完美运行，所以我不认为我的表达式本身是无效的。此外，当我尝试使用文档网站上的示例时，我得到了同样的错误：http: [//www.mathworks.com/help/symbolic/mupad_ref/solve.html](http://www.mathworks.com/help/symbolic/mupad_ref/solve.html)

是配置问题还是我误解的命令语法有什么问题？

编辑：我也尝试使用 == 而不是 =，但我得到了一个不同的错误：

```
Undefined function or variable 'M'. 
```

另外，请注意，我正在运行 Matlab R2011b (7.13.0.564) 64 位 (glnxa64)。

Edit2：我用 syms 尝试了第一个建议的解决方案：

```
>> syms M
>> solve(0.2 == (1.4+1/2)^((1.4+1)/(2*(1.4-1)))*(M)/((1+(1.4-1)/2*M^2))^((1.4+1)/(2*(1.4-1))), M)
Error using char
Conversion to char from logical is not possible.

Error in solve>getEqns (line 245)
  vc = char(v);

Error in solve (line 141)
[eqns,vars,options] = getEqns(varargin{:}); 
```

Edit3：即使是最简单的方程式，我也能重现这个问题

```
>> syms x
>> solve(x^2 -4 == 0, x)
Error using char
Conversion to char from logical is not possible.

Error in solve>getEqns (line 245)
  vc = char(v);

Error in solve (line 141)
[eqns,vars,options] = getEqns(varargin{:}); 
```

此外，我也尝试了这里建议的解决方案：[MATLAB示例失败](https://stackoverflow.com/questions/9866366/matlab-examples-are-failing)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:39:28.680

Matlab 的 fsolve 命令假定表达式设置为零。如果以数字方式求解，您不会这样做：

```
x=solve(2=x+1,x) 
```

反而：

```
x=fsolve(@(x) x+1-2,0) 
```

在方程已经设置为零的情况下，@(x) 是您要解决的问题，而 0 是初始猜测。您必须包括在内。

象征性地使用solve，它看起来像这样：

```
syms x
val=solve(x+1-2) 
```

或者对于您的系统：

```
syms M
solve(-0.2+ (1.4+1/2)^((1.4+1)/(2*(1.4-1)))*(M)/((1+(1.4-1)/2*M^2))^((1.4+1)/(2*(1.4-1))))

ans =
                                     4.7161724968093348297842999805458
                                   0.029173662296926424763929809009225
 - 3.8716404782846254923900841980317 - 3.4984412176176158766571497649425*i
   1.4989673987314948651159693032542 + 5.5784387926679222829321168661041*i
   1.4989673987314948651159693032542 - 5.5784387926679222829321168661041*i
 - 3.8716404782846254923900841980317 + 3.4984412176176158766571497649425*i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:03:46.923

您应该将 M 定义为`sym`，并使用`==`而不是`=`

```
syms M
solve(0.2 == (1.4+1/2)^((1.4+1)/(2*(1.4-1)))*(M)/((1+(1.4-1)/2*M^2))^((1.4+1)/(2*(1.4-1))), M)

ans =
                                         4.7161724968093348297842999805458
                                       0.029173662296926424763929809009225
 - 3.8716404782846254923900841980317 - 3.4984412176176158766571497649425*i
   1.4989673987314948651159693032542 + 5.5784387926679222829321168661041*i
   1.4989673987314948651159693032542 - 5.5784387926679222829321168661041*i
 - 3.8716404782846254923900841980317 + 3.4984412176176158766571497649425*i 
```

# visual-studio-2010 - 将 Qt 5.0 与 Qt Creator 和 vs2010 编译器一起使用

> ID：14589232
> 
> 赞同：0
> 
> 时间：2013-01-29T18:00:01.033
> 
> 标签：visual-studio-2010, qt, qt-creator

我最近决定从 Qt 4.X 升级到 5，虽然现在它只支持 vs2010。每当我启动 Qt Creator 时，我都会发现没有任何编译器（并且设置中没有设置选项）。

问：如何下载vs2010编译器？我必须自己下载vs2010吗？我也会得到一个调试器吗？

我试过这个建议，但 Qt 没有选择编译器：[Using Visual Studio as a Compiler for QT Creator](https://stackoverflow.com/questions/10885938/using-visual-studio-as-a-compiler-for-qt-creator)

抱歉，如果之前有人问过这个问题，但我一直无法找到解释我应该做什么的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:47:43.163

您不需要重新编译 Qt，因为 SDK 版本是使用 msvc2010 32 位构建的。对于调试，您可能需要[下载 Windows SDK 8](http://msdn.microsoft.com/en-us/windows/desktop/hh852363.aspx)。Qt Creator 可能会自动检测您的编译器和调试器，但如果没有，请执行以下操作：

*   在 下`Options/Build & Run/Qt Versions`，指向 qmake.exe
*   在 下`Options/Build & Run/Kits`，将“Qt Version”设置为您刚刚创建的版本，并设置您的编译器和调试器

如果编译器在您的系统上，则应该自动检测它。

调试器类似于`C:\Program Files\Windows Kits\8.0\Debuggers\x86\cdb.exe`.

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:15:16.467

好像你还没有安装 MSVC。从[Microsoft 网站](http://www.microsoft.com/visualstudio/plk/products/visual-studio-express-products)获取。

比从诺基亚下载资源。将它们解压缩到一个新文件夹，例如 C:\QtSources 并用 MSVC 编译它们。[这个说明](https://stackoverflow.com/a/13085842/1152529)工作得很好。

最后将它们添加到 Qt Creator 中

```
Tools -> Options -> Building -> Qt Versions 
```

通过指向您的新 qmake 可执行文件

```
C:\QtSources\bin\qmake.exe 
```

希望 Qt 5 将与 MSVC 的免费 Express Edition 一起使用。

# c# - 在 C# 中，我可以发送一个输出参数以在其他地方使用吗

> ID：14589233
> 
> 赞同：1
> 
> 时间：2013-01-29T18:00:02.167
> 
> 标签：c#, out

我有一个函数被代码的另一部分调用，带有签名：

```
public override bool DoSomething(Foo f, out string failed)
{
    failed = "I failed";
    _anotherClassMethodExpectingString.SetString(failed);
} 
```

所以我的问题是 - 如果我需要向另一个类方法发送我的调用者在其“out”参数中期望的相同字符串，我可以只发送相同的变量，而不会对我的调用者产生任何影响吗？“out”参数让我有点困惑..我应该使用这样的东西吗：

```
public override bool DoSomething(Foo f, out string failed)
{
   string localStr = "I failed";
   failed = localStr;
   _anotherClassMethodExpectingString.SetString(localStr);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:02:33.803

除非您调用的后续方法也使用 out 参数，否则无需定义局部变量。该字符串将不受任何常规参数传递的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:02:11.083

如果您不希望或不希望您的方法的调用者看到第三种方法的任何更改，那么您所拥有的一切都很好。如果我正确阅读了您的问题，这似乎是您的意图。

如果您希望调用者反映由第三种方法引入的更改，则它也需要是一个`out`参数，或者通过返回值返回修改，然后您将在返回之前将其分配给原始 out 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:17:10.160

`ref`如果为不带or的方法声明参数`out`，则该参数可以具有与其关联的值。该值可以在方法中更改，但是当控制权返回给调用过程时，更改后的值将不会保留。

鉴于字符串在 .NET 中是不可变的，因此可以安全地传递`failed`给没有字符串参数的任何方法，`ref`并`out`确保它不会被更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T18:21:54.280

out 参数类似于 c++ 中对象的指针。因此，如果您不使用 'out' 定义器，则不会更改参数的值。

# python - 如何在 Python 中使用 urllib2 创建新目录并保存文件？

> ID：14589234
> 
> 赞同：1
> 
> 时间：2013-01-29T18:00:02.517
> 
> 标签：python, urllib2

我正在尝试创建一个 python 脚本来检查主机是否处于活动状态，如果是，则将网站下载到 results/ 目录中。一旦我学会了如何做到这一点，我将开始研究如何爬取和启动其他子进程（例如在检查完成后启动 nikto/skipfish 并加载保存的文件）。

```
#! /usr/bin/python

import os
import sys
import urllib
import urllib2
import subprocess

# Where the magic happens

str1 = raw_input("Enter your target: ")
print "Target = ", str1
print "commencing testing on", str1

# Let's set the user-agent headers
http_headers = {"User-Agent":"Mozilla/5.0"}

request = urllib2.Request(str1)
response = urllib2.urlopen(request)
payload = response.read()

dir_path = os.path.join(self.results)
os.makedirs(dir_path)
**with open(os.join.path(dir_path, 'index.html', 'wb') as file:
        file.write(payload)
print str1, "index written to file"**

# Send an email to notify us when complete
var = "world"
pipe = subprocess.Popen(["./email.sh", var], stdout=subprocess.PIPE)
result = pipe.stdout.read()
print result 
```

我收到以下错误消息：

```
File "./webtest.py", line 43
    with open(os.join.path(dir_path, 'index.html', 'wb') as file:
                                                          ^
SyntaxError: invalid syntax 
```

关闭括号后的错误（来自菲尔的回答）：

```
 Traceback (most recent call last):
      File "./webtest.py", line 41, in <module>
        dir_path = os.path.join(self.results)
NameError: name 'self' is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:11:48.283

你错过了一个括号：

```
with open(os.join.path(dir_path, 'index.html', 'wb')) as file: 
```

**编辑**

该行与您想要的目录有关。它给出错误是因为你不在课堂上（所以“自我”不存在）。最好的做法是用“结果”替换它并指定结果在哪里。例如：

```
results = "/resultsdir/"
dir_path = os.path.join(results) 
```

# c++ - 枚举完整图的哈密顿循环的算法（不计算循环、反转、环绕或重复的排列）

> ID：14589238
> 
> 赞同：2
> 
> 时间：2013-01-29T18:00:10.890
> 
> 标签：c++, algorithm, permutation, traveling-salesman, hamiltonian-cycle

我想生成一个完整的无向图的所有哈密顿循环（循环和反转算作重复的集合的排列，并且被排除在外）。

例如，{1,2,3} 的排列是

标准排列：

```
1,2,3
1,3,2
2,1,3
2,3,1
3,1,2
3,2,1 
```

我希望程序/算法为我打印的内容：

```
1,2,3 
```

由于 321 只是向后 123，所以 312 只是 123 旋转了一个位置，依此类推。

我看到很多关于给定集合具有的这些循环数量的讨论，以及查找图是否具有哈密顿循环的算法，但没有关于如何在完整的无向图中枚举它们（即一组数字可以在集合中的任何其他数字之前或之后）。

我真的很想要一个算法或 C++ 代码来完成这个任务，或者如果你能指导我到哪里有关于这个主题的材料。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:11:45.327

您可以对输出设置一些限制以消除不需要的排列。假设我们想要置换数字 1, ..., N。为了避免某些特殊情况，假设 N > 2。

为了消除简单的旋转，我们可以要求第一位是 1。这是真的，因为任意排列总是可以旋转成这种形式。

为了消除倒数，我们可以要求第二位的数字必须小于最后一位的数字。这是真的，因为从 1 开始的两个相互反转的排列中，恰好有一个具有此属性。

因此，一个非常简单的算法可以枚举所有排列并排除无效的排列。当然也有优化的可能。例如，在生成步骤中可以轻松避免不以 1 开头的排列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T21:29:53.150

检查路径是否与循环中不同点开始的路径相同的一种超级懒惰的方法（IE，相同循环或相同循环的反向是这样的：

1：决定按照惯例，所有循环将从最低的顶点数开始，并沿两个相邻序数中较低的方向继续。

因此，所有上述路径将以相同的方式进行描述。

第二个，其他有用的信息在这里：

如果您想检查两条路径是否相同，您可以将一条与其自身连接并检查它是否包含第二条路径或第二条路径的反向。

那是，

```
1 2 3 1 2 3 
```

包含上述所有路径或其相反的路径。由于找到所有哈密顿循环的过程似乎比这个算法的效率低下要慢得多，我觉得我可以把它扔进去:)

# c# - 尝试使用 c# 通过 TCP 接收对象时出现异常

> ID：14589243
> 
> 赞同：0
> 
> 时间：2013-01-29T18:00:20.047
> 
> 标签：c#, serialization, tcp

我正在尝试使用`objects`and接收。我不断收到，每个人都被派往一项新任务。我选择不使用，因为它太贵了。问题是，如果我一次只收到 1 一切都很好，但如果我试图收到超过 1 ，几秒钟后我得到： `TCP``C#``serialization``objects``object``threads``object``object``"the input stream is not a valid binary format. the starting contents (in bytes) are: ..."`

这是我的听力功能：

```
public void Listen()
        {
            try
            {
                TcpObject tcpObject = new TcpObject();
                IFormatter formatter = new BinaryFormatter();

                bool offline = true;
                Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal,
                    new Action(() => offline = Offline));

                while (!offline)
                {
                    tcpObject = (TcpObject)formatter.Deserialize(serverStream);

                    if (tcpObject.Command == Command.Transfer)
                    {
                        #region Task
                        Task.Factory.StartNew(() =>
                        {
                            SentAntenna sentAntenna = (SentAntenna)tcpObject.Object;

                            string antennaName = sentAntenna.Name;

                            if (MainWindow.SpectrumList.ContainsKey(antennaName))
                            {
                                PointCollection pointCollection = new PointCollection();
                                float minChan = sentAntenna.Min;
                                float maxChan = sentAntenna.Max;

                                if (MainWindow.SpectrumList[antennaName].spectrumViewModel.AbsoluteMinimum == -1)
                                {
                                    Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal,
                                        new Action(delegate
                                        {
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.AbsoluteMinimum = minChan;
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.AbsoluteMaximum = maxChan;
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.TBMinRange = minChan.ToString();
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.TBMaxRange = maxChan.ToString();
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.MinRange = minChan;
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.MaxRange = maxChan;
                                            MainWindow.SpectrumList[antennaName].spectrumViewModel.UpdateRange();
                                        }));
                                }

                                float gap = maxChan - minChan;
                                foreach (Frequency f in sentAntenna.Frequencies)
                                {
                                    float chan = ((f.Channel - minChan) / gap) * 310;
                                    float inten = ((f.Intensity - 1) / 599) * 100;
                                    pointCollection.Add(new Point(chan, inten));
                                }

                                pointCollection.Freeze();
                                Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal,
                                    new Action(() => MainWindow.SpectrumList[antennaName].spectrumViewModel.AllAntennaPoints = pointCollection.Clone()));
                            }
                            Thread.Sleep(50);
                        });
                        #endregion
                    }
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message); // raise an event
            }
        } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:05:55.827

尝试移动

```
SentAntenna sentAntenna = (SentAntenna)tcpObject.Object; 
```

到 StartNew() 之前的行。我相信这将解决您的问题。

我认为您不希望同时访问 tcpObject，因为它对所有任务都是全局的。

或者，您可以在 while 循环内实例化 TcpObject，然后将其保持在每个任务的本地。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:28:06.793

这个错误有几个原因：

1.  当两个对象同时写入一个连接时

2.  当 serverStream 出现问题时：流已接收到部分数据或接收到 0 长度数据

3.  您同时访问 tcpObject。这是个坏主意。

# python - 为什么 Django 会使用长 url lock python 获取请求？

> ID：14589244
> 
> 赞同：1
> 
> 时间：2013-01-29T18:00:20.687
> 
> 标签：python, django, django-urls

我在使用 Django 中的内置网络服务器时遇到了一个奇怪的错误（由于我正在积极开发中，因此尚未针对 Apache 进行测试）。我有一个适用于短 url 参数的 url 模式（例如 Chalk%20Hill），但在这个上锁定了 python

```
http://localhost:8000/chargeback/checkDuplicateProject/Bexar%20Street%20Phase%20IV%20Brigham%20Ln%20to%20Myrtle%20St 
```

获取请求只是说挂起，永远不会返回，我必须强制退出 python 才能让服务器再次运行。我究竟做错了什么？

编辑：在继续测试中，很奇怪，如果我只是输入 url，它会返回正确的 json 响应。然后它锁定python。但是，当我在网站上时，它永远不会返回，并且会锁定 python。

网址：

```
url(r'^chargeback/checkDuplicateProject/(?P<aProjectName>(\w+)((\s)?(-)?(\w+)?)*)/$', 'chargeback.views.isProjectDuplicate'), 
```

意见：

```
def isProjectDuplicate(request, aProjectName):
    #count the number of matching project names
    p = Project.objects.filter(projectName__exact = aProjectName).count()

    #if > 0, the project is a duplicate
    if p > 0:
        return HttpResponse('{"results":["Duplicate"]}', mimetype='application/json')
    else:
        return HttpResponse('{"results":["Not Duplicate"]}', mimetype='application/json') 
```

模型：

```
class Project(models.Model):
    projectName = models.TextField('project name')
    department = models.ForeignKey('Department')

    def __unicode__(self):
        return self.projectName 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T18:31:29.763

接受的答案是关于正则表达式的，但是由于我们正在讨论优化，我想我应该注意，可以修改用于检查项目是否存在的代码以生成更快的查询，特别是在您可能的其他上下文中不必要地计算数百万行。如果您愿意，可以将此称为“最佳实践”建议。

```
p = Project.objects.filter(projectName__exact = aProjectName).count()
if p > 0: 
```

可以改为

```
if Project.objects.filter(project_name__iexact=aProjectName).exists(): 
```

有两个原因。

首先，您没有使用`p`任何东西，因此无需将其存储为变量，因为它增加了可读性并且`p`是一个晦涩的变量名称，[最好的代码是根本没有代码](http://www.codinghorror.com/blog/2007/05/the-best-code-is-no-code-at-all.html)。

其次，这种方式我们只要求一行而不是将结果保存到查询集缓存中。请参阅官方[Queryset API 文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#exists)、[Stack Overflow 上的一个相关问题](https://stackoverflow.com/questions/14368205/django-any-difference-between-queryset-nonzero-and-queryset-exists/14369747#14369747)以及[django-developers 组上关于后者的讨论](https://groups.google.com/forum/#!msg/django-developers/L4irIYGPUWM/wK7fQ1q_SsYJ)。

此外，在 python（和 Django，自然）中，将字段命名为 lower_cased_separated_by_underscores 是习惯性的。请在 Python 样式指南[(PEP 8)](http://www.python.org/dev/peps/pep-0008/)上查看更多相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T17:28:23.683

由于您要检查`aProjectName`数据库中是否已经存在，因此您无需使正则表达式如此复杂。

我建议您将正则表达式简化为

```
url(r'^chargeback/checkDuplicateProject/(?P<aProjectName>[\w+\s-]*)/$', 'chargeback.views.isProjectDuplicate'), 
```

有关进一步的解释，请参阅问题[*url regex keep django busy/crashing*](https://groups.google.com/d/msg/django-users/Bxq9i0mttSc/DEz7S7M8lxAJ) on the django-users group。

# git - git - 遇到新手合并问题

> ID：14589246
> 
> 赞同：1
> 
> 时间：2013-01-29T18:00:32.267
> 
> 标签：git

我只是试图用这个命令提交一些东西：

```
git commit file_name
push origin reponame develop 
```

我得到了错误：

```
error: failed to push some refs to 'https://my_repo_path'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
hint: before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details. 
```

所以我试着做

```
git pull origin repo_name 
```

它给了我一个错误：

```
* branch            develop    -> FETCH_HEAD
error: Your local changes to the following files would be overwritten by merge:
    ... 3 file_names
Please, commit your changes or stash them before you can merge. 
```

解决这个问题的常用方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:04:07.983

听起来您有已修改但未提交的文件。尝试先存储您的更改，然后将它们重新应用到头顶：

```
git stash
git pull origin repo_name
git stash pop 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:04:29.953

在尝试拉动之前，您需要清理工作区。做一个`git status`，你会看到你有本地的、未签入的更改。您需要先提交或存储这些内容（如消息所述），然后才能从遥控器进行更新。

# vba - 将当前消息作为附件转发，然后删除原始消息

> ID：14589250
> 
> 赞同：2
> 
> 时间：2013-01-29T18:00:53.570
> 
> 标签：vba, outlook, outlook-2010

我的工作 Outlook 2010 帐户收到大量垃圾邮件。我提供了我们的垃圾邮件拦截器地址，以便将垃圾邮件（作为附件）转发到。

我想单击功能区上的一个图标（我已经有了这个）并运行 VBA 代码来获取当前消息，将其附加到新消息，将地址添加到新消息，发送新消息，然后删除原始消息。（删除可以是将邮件放在“已删除邮件”文件夹中，也可以将其永久删除。）

**解决了！！！！**

这是完全符合我要求的代码。我在网上找到它并对其进行了修改以满足我的需要。

```
Sub ForwardAndDeleteSpam()
'
' Takes currently highlighted e-mail, sends it as an attachment to
' spamfilter and then deletes the message.
'

    Set objItem = GetCurrentItem()
    Set objMsg = Application.CreateItem(olMailItem)

    With objMsg
        .Attachments.Add objItem, olEmbeddeditem
        .Subject = "SPAM"
        .To = "spamfilter@schools.nyc.gov"
        .Send
    End With
    objItem.Delete

    Set objItem = Nothing
    Set objMsg = Nothing
End Sub

Function GetCurrentItem() As Object
    On Error Resume Next
    Select Case TypeName(Application.ActiveWindow)
    Case "Explorer"
        Set GetCurrentItem = Application.ActiveExplorer.Selection.Item(1)
    Case "Inspector"
        Set GetCurrentItem = Application.ActiveInspector.CurrentItem
    Case Else
        ' anything else will result in an error, which is
        ' why we have the error handler above
    End Select

    Set objApp = Nothing
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:06:24.730

您可以使用它来浏览一系列电子邮件，而不仅仅是一个通过调整代码如下

```
Sub ForwardSpamToNetworkBox()

On Error Resume Next

Dim objItem As Outlook.MailItem

If Application.ActiveExplorer.Selection.Count = 0 Then
   MsgBox ("No item selected")
   Exit Sub
End If

For Each objItem In Application.ActiveExplorer.Selection
Set objMsg = Application.CreateItem(olMailItem)
    With objMsg
        .Attachments.Add objItem, olEmbeddeditem
        .Subject = "SPAM"
        .To = "spam@host.co.uk"
        .Send
    End With
objItem.Delete
Next

Set objItem = Nothing
Set objMsg = Nothing

End Sub 
```

这是使用来自[http://jmerrell.com/2011/05/21/outlook-macros-move-email的信息创建的](http://jmerrell.com/2011/05/21/outlook-macros-move-email)

理想情况下，我不会将其删除，而是将其移动到一个名为“已提交”的子文件夹中，但我无法让它在公用文件夹中工作

# orientdb - 无法创建从一个节点到另一个节点的边

> ID：14589259
> 
> 赞同：1
> 
> 时间：2013-01-29T18:01:15.123
> 
> 标签：orientdb

如何在 orientDb 中的 2 个类实例之间创建一条边。

我在 Db 中有我的 Xyz 类，具有以下属性

```
 #| RID     |name
--+---------+------------
 0|    #99:6|abc
 1|    #99:7|xyz 
```

1.  现在，当我尝试在这两个节点之间创建边缘时，我得到以下错误

> ```
> orientdb> create edge E1 from #99:6 to #99:7
> 
> Error: com.orientechnologies.orient.core.exception.OCommandExecutionException: 
> ```
> 
> 执行命令时出错：OCommandSQL [text=create edge E1 from #99:6 to #99:7] 错误：com.orientechnologies.orient.core.exception.OValidationException：已声明字段“OGraphEdge.out”作为 'OGraphVertex' 类型的 LINK 但值是文档 #99:6 的类 'Xyz' orientdb>

2.  我可以在边缘设置一组标签/标签/属性吗？
3.  我如何在 java 中创建边？我们有一些 java api 而不是调用 SQL 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T10:44:49.120

似乎记录 #99:6 属于不扩展 V (OGraphVertex) 的类。

# android - 全屏视频查看按钮

> ID：14589267
> 
> 赞同：0
> 
> 时间：2013-01-29T18:01:38.093
> 
> 标签：android, fullscreen, android-videoview, mediacontroller, android-fullscreen

我目前正在将 VideoView 与 MediaController 一起使用，我想知道是否有一种简单的方法可以添加全屏按钮模式。

这将是一个按钮，位于 MediaController 栏或 VideoView 顶部的其他位置，单击时将以全屏模式显示视频。

（顺便说一句，我很惊讶 Android 没有将此作为默认控制器添加到 MediaController 上！！！）

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:03:08.407

在我的应用程序中，我`VideoView`从其父级中删除了它并将其设置在内容视图中。

这里作为一个基本的想法（可能包含小错误）：

```
VideoView video = (VideoView)findViewById(...);
((ViewGroup)video.getParent()).removeChild(video);
setContentView(video); 
```

顺便说一句，根据您的目标平台，我建议使用[`TextureView`](http://developer.android.com/reference/android/view/TextureView.html).

# php - PHP SimpleXML - 节点作为字符串

> ID：14589276
> 
> 赞同：0
> 
> 时间：2013-01-29T18:02:14.777
> 
> 标签：php, casting, simplexml

我试图将 XML 节点（带子节点）作为字符串但没有成功。

这是我的xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<params>
  <main_settings>
    <id>23</account_id>
    <test/>
    <logo_url/>
    <app appid="test_12">
      <d:tag xmlns:c="http://mypage.com/test2" id="mypage_id_256" type="mypage_type_test">
        <path-info value="show"/>
      </d:tag>
    </app>
  </main_settings>
</params> 
```

这是行不通的。

```
 $var->params->main_settings->app; 
```

有没有办法使用 simpleXML 将节点（“app”）子节点作为刺痛？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:05:38.653

您可以在孩子上调用[asXml](http://php.net/manual/en/simplexmlelement.asxml.php)方法：

```
$var->params->main_settings->app->asXml(); 
```

也可以通过类型转换：

```
(string)$var->params->main_settings->app 
```

# php - 从匹配的锚文本中获取 href 值

> ID：14589277
> 
> 赞同：0
> 
> 时间：2013-01-29T18:02:19.170
> 
> 标签：php, html-parsing, domdocument

我对 DOMDocument 类很陌生，似乎无法找到我正在尝试做的事情的答案。

我有一个大的 html 文件，我想从基于锚文本的元素中获取链接。

所以例如

```
$html = <<<HTML
<div class="main">
    <a href="http://link.com" target="blank" ><span><font style="color: #e7552c;"><img src="http://images.com/spacer.gif"/>Keyword</font></span></a>
    other text
</div>
HTML;

// domdocument
$doc = new DOMDocument();
$doc->loadHTML($html); 
```

我想获取任何具有 text*关键字*的元素的 href 属性的值。希望这很清楚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:14:55.107

```
$html = <<<HTML
<div class="main">
    <a href="http://link.com" target="blank" ><span><font style="color: #e7552c;"><img src="http://images.com/spacer.gif"/>Keyword</font></span></a>
    other text
</div>
HTML;

$keyword = "Keyword";

// domdocument
$doc = new DOMDocument();
$doc->loadHTML($html);
$as = $doc->getElementsByTagName('a');
foreach ($as as $a) {
    if ($a->nodeValue === $keyword) {
        echo $a->getAttribute('href'); // prints "http://link.com"
        break;
    }
} 
```

# php - 是否有任何其他替代 PHP 的方法可以让我在服务器上部署不可读的代码？

> ID：14589278
> 
> 赞同：0
> 
> 时间：2013-01-29T18:02:28.067
> 
> 标签：php, security, content-management-system, webserver, bytecode

我正在开发一个具有 PHP 加密引擎的 CMS。但由于 PHP 代码是完全可见的，因此加密数据的方法很容易受到损害，因为购买产品的每个人都可以阅读代码。我想预编译 PHP 或使用任何其他服务器端脚本语言，它允许我提供包含程序字节码的文件，并执行与原始 PHP 文件完全相同的功能。有没有这样的语言？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:19:39.993

我知道 perl 可以预编译。这可能有用：[http ://www.perlmonks.org/?node_id=402933](http://www.perlmonks.org/?node_id=402933)

# git - 在 Windows 上设置 git 标签和结帐

> ID：14589285
> 
> 赞同：1
> 
> 时间：2013-01-29T17:54:40.537
> 
> 标签：git, build, tagging

我们正在将版本控制系统从 Starteam 更改为 Git 和 GitHub.com。在 Starteam，我们使用标签。标签是命名快照，例如 3.14.1.3145。这是每天早上自动构建的。第二天早上是 3.14.1.3146。我相信 git tag 与 label 相同？我们使用 Smartgit 作为客户端，但从构建应用程序中我们必须使用 git 命令行。

我是 git 的新手，想知道以下内容。

1.  如何在 Git 中设置标签并将其存储在 GitHub 上？
2.  如何从 GitHub 签出特定标签的所有文件，然后从中构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:17:08.927

是的，标签就是您所描述的。您可以像分支一样结帐，如果您使用结帐的 -b 选项，它将为您创建新的本地分支。如果你只签出没有 -b，git 会警告你，你不在任何分支上，但只要你不提交任何东西，这不是问题。

将标签推送到 Github 的方式与推送新分支的方式相同：`git push origin tagname`

创建标签名称时，请查看“git describe”命令。它可能会帮助你。

签出和构建：

```
git fetch origin && git checkout 3.14.1.314 --force && make 
```

顺便说一句，我对 Windows 上的 Git 扩展有少量但很好的经验。它有很好的 GUI，它包括一些带有 git 的基本 shell。

# svn - svnadmin 加载到现有目录？

> ID：14589287
> 
> 赞同：5
> 
> 时间：2013-01-29T18:02:49.127
> 
> 标签：svn, svnadmin

我们在工作中一直在做一些存储库跳跃，作为一个组合，我正在尝试将一些旧历史重写到我们将使用的新存储库中。如何将 SVN 转储文件重新加载到现有目录中存储库？

我已经做了一个`svnadmin dump`我想移动的旧树干和树枝。我已经处理它们以从转储文件中的路径中删除`trunk`和`branches/myBranch`前缀。我也加载了一个到`newRepo/fromOldRepo_ref/development`.

```
$ svn copy --parents file://`pwd`/newRepo/fromOldRepo_ref/development@172 file://`pwd`/newRepo/fromOldRepo_ref/features/2169 -m "Branch to 2169 reference branch"

Committed revision 182.
$ svnadmin load --parent-dir fromOldRepo_ref/features/2169 newRepo < dumpfile
<<< Started new transaction, based on original revision 2171
svnadmin: E160020: File already exists: filesystem 'newRepo/db', transaction '182-53', path 'fromOldRepo/features/2169'
     * adding path : fromOldRepo/features/2169 ... 
```

`newRepo/fromOldRepo_ref/development@172`然后我从to做了上面的分支`newRepo/fromOldRepo_ref/features/2169`。之后，我想`2169`通过加载另一个转储文件来创建更多提交，但它会出错，如上所示。这可以解决吗？

展望未来，我知道我们的程序、工具和实践还有许多其他真正的修复，可以避免我将来想要这样做。但目前，这无济于事。:]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:02:49.127

虽然该`--deltas`选项与`svndumpfilter`,不兼容`--incremental`。 `--deltas`将每个提交作为增量存储在转储文件中，从而节省磁盘空间。 `--incremental`将第一个条目捕获为概念增量（而不是仅仅节省磁盘空间），从而允许将目录的内容从转储文件加载到现有目录中。当第一次提交包含对文件夹属性的更改时，我还必须将转储文件的内容更改为更改类型，`change`而不是`add`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-22T21:22:53.310

当我收到此错误时，我正在尝试执行

```
svnadmin load 
```

[命令从cvs2svn](http://cvs2svn.tigris.org/)工具创建的转储中导入现有项目结构。我发现这是不正确的，因为在尝试创建主干文件夹时会抛出“文件已存在”类型的消息。相反，在 IDE 中，我在存储库中创建了一个远程文件夹并将其留空。然后发出

```
svnadmin load --parent-dir <emptyFolderName> C:\SVN\repos\myRepo C:\temp\dumpFile.dump 
```

这就是我的诀窍。

# c# - 从 C# 中的文件中读取文本并根据字符进行操作

> ID：14589298
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:03:22.760
> 
> 标签：c#, file, text, razor, formatting

我对为 Web 应用程序编写 c# 编码比较陌生，但对 c# 有一些了解。

我正在尝试读取一个文本文件（下面的示例）并生成一个网页，其格式基于用于分隔每一行的字符。

我确信有一种非常简单的方法可以做到这一点，但这就是我想出的。它适用于我当前的预期目的，但看起来既可怕又复杂。

我正在阅读的文件如下所示：

```
^This ^is ^the ^home ^file.|*This is a ^bullet point.|*^This is another one.|This isn't a bullet point. 
```

我必须阅读并显示的代码如下所示：

```
@{int bulletNum = 0;}
@foreach (string homeLine in homeData)
{
    foreach (string homeItem in homeLine.Split('|'))
    {
        if (homeItem.First()=='*')
        {
            bulletNum++;
            <ol class="round">
                <li class="num@(bulletNum)">
                    @foreach (string homeElementFirst in homeItem.Split(' '))
                    {
                        string homeElementSecond = homeElementFirst.TrimStart('*');
                        if (homeElementSecond.First() == '^')
                        {
                            <b>@homeElementSecond.TrimStart('^')</b>
                        }
                        else
                        {
                            @homeElementSecond <text> </text>
                        }
                    }
                </li>
            </ol>
        }
        else
        {
            foreach (string homeElement in homeItem.Split(' '))
            {
                if (homeElement.First() == '^')
                {
                    <b>@homeElement.TrimStart('^')</b>
                }
                else
                {
                    @homeElement <text> </text>
                }
            }
        }
        <br />
    }
} 
```

请原谅我可怕的变量名。

谁能帮我整理一下？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:22:44.887

看起来您正在尝试实现一种自定义标记语言，尽管它很简单。我建议您使用现有的库来处理这类事情。查看[Textile](http://textile.thresholdstate.com)，它做了类似的事情。有一个可用[的 Textile 的 C# 端口](http://textilenet.codeplex.com)。

# visual-c++ - 创建新的 VC++ 控制台应用程序时出现错误：找不到源文件 stdio.h、tchar.h

> ID：14589303
> 
> 赞同：0
> 
> 时间：2013-01-29T18:03:50.107
> 
> 标签：visual-c++, console-application, header-files, stdio

我刚刚开始使用*Ivor Horton 的 Starting Visual C++ 2010*和 Visual Studio Professional 2010 自学 VC++。但是，当我通过 File -> New Project -> Win32 Console Application 创建一个新的 VC++ 控制台应用程序来为控制台应用程序创建默认 shell 时，我收到以下关于在我的 stdafx.h 文件中包含默认库的错误：

```
error C1083: Cannot open include file: 'stdio.h': No such file or directory 
error: Cannot open include file:'tchar.h': No such file or directory 
```

我的 stdfx.h 文件如下：

```
#pragma once

#include "targetver.h"

#include <stdio.h>
#include <tchar.h> 
```

我可以看到 stdafx.h 中包含语句所针对的文件未拉入我的应用程序的 Header Files 目录，但我检查并安装了 VC++ 2010 x86 和 VC++ x64 并假设这些文件将包含在安装中因为这些引用是通过默认生成的新 VC++ 控制台应用程序进行的。我是否必须手动将它们放在每个项目的 Header Files 目录中？这些不应该被自动拉入吗？

更新：我看了看，`C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\include` 只看到 ammintrin.h、srv.h、wmiatlprov.h。这是否意味着我的 Visual Studio 安装可能存在问题？我可以从某个地方下载所需的头文件并将它们放在此目录中以更正问题吗？

# python - python中另一个对象内的对象

> ID：14589307
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:03:58.623
> 
> 标签：python, class, object

我用 Python 编写了一个程序。我有 A 类。它的一个变量 v 是另一个类 B 的实例：

```
class A:
 def __init__(self):
   self.v = B() 
```

B 类的形式为：

```
class B:
 def __init__(self):
  self.list = [1,2,3]
 def function(self):
  self.list[2] = 1 
```

我创建了一个实例 x=A()，将其放入列表 g (g=[x]) 中，然后通过打印 g[0].v.function() 更改 xv 中的变量之一。但是，当我要求计算机打印 g[0].v.list 时，它会打印 [1,2,3] 而不是 [1,2,1]。可能是什么原因？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:06:29.413

为我工作：

```
class A:
 def __init__(self):
   self.v = B()

class B:
 def __init__(self):
  self.list = [1,2,3]
 def function(self):
  self.list[2] = 1

x = A()
g = [x]
print g[0].v.function()
print g[0].v.list 
```

输出：

```
None
[1, 2, 1] 
```

# javascript - Backbone-forms.js - 如何在来自 github“文档”的示例中呈现提交按钮

> ID：14589309
> 
> 赞同：4
> 
> 时间：2013-01-29T18:04:00.780
> 
> 标签：javascript, html, backbone.js, backbone-forms

这是来自主干形式的代码。现在，我想呈现一个提交按钮来验证我的文本字段和记录的内容，除了如何将该提交按钮放入 dom 中。随意投反对票，无论如何，在我看来，这对于新手来说很难弄清楚

```
(function($) {
    var cities = {
        'UK': ['London', 'Manchester', 'Brighton', 'Bristol'],
        'USA': ['Washington DC', 'Los Angeles', 'Austin', 'New York']
    };

    //The form
    var form1 = new Backbone.Form({
        schema: {
            country: { type: 'Select', options: ['UK', 'USA'] },
            city: { type: 'Select', options: cities.UK },
            message: { type: 'Text'}
        }
    }).render();

    form1.on('country:change', function(form1, countryEditor) {
        var country = countryEditor.getValue(),
            newOptions = cities[country];
            form1.fields.city.editor.setOptions(newOptions);

    });

    //Add it to the page
    $('body').append(form1.el);
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T17:41:58.290

**我的朋友，您需要使用 BBF 模板！**

虽然附加它是一种方法，但您应该真正坚持 BBF 实现按钮的方式。您可以创建不同的模板或在必要时重新使用它们，并从这里您可以将属性添加到您的表单等。。希望这可以帮助...

**检查工作演示：http:** [//jsfiddle.net/c5QHr/116/](http://jsfiddle.net/c5QHr/116/)

```
$(function() {

//// Set the template -----------------------------> 
Backbone.Form.setTemplates({
    customTemplate: '<form id="your-form-id">{{fieldsets}}<input id="your-form-cancel" type="reset" value="cancel" name="reset" /><input type="submit" value="submit" name="submit" />'

});

var cities = {
    'UK': ['London', 'Manchester', 'Brighton', 'Bristol'],
    'USA': ['Washington DC', 'Los Angeles', 'Austin', 'New York']
};

//The form
var form = new Backbone.Form({
    //// Use the template ----------------------------->
    template: 'customTemplate',
    schema: {
        country: { type: 'Select', options: ['UK', 'USA'] },
        city: { type: 'Select', options: cities.UK }
    }
}).render();

form.on('country:change', function(form, countryEditor) {
    var country = countryEditor.getValue(),
        newOptions = cities[country];

    form.fields.city.editor.setOptions(newOptions);
});

//Add it to the page
$('body').append(form.el);

////Do something with the buttons ----------------------------->

$("#your-form-id").submit(function(){alert('BBF Form was submitted!'); return false;});
$("#your-form-cancel").on('click',function(){alert('BBF Form was cancelled!'); }); 
```

});

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T21:00:59.053

可以像这样使用 jQuery 在表单中添加提交按钮

```
$('yourBackboneform').append("<input type='submit' value='submit' name='submit' /><input type='reset' value='reset' name='reset' />"); 
```

主干表单的主要目的是 ajax 驱动的自动更新移动设备的疯狂东西，所以他们决定默认不呈现提交表单的东西，我猜

# c - 在 64 位机器中从 C 函数访问返回地址时出现分段错误

> ID：14589314
> 
> 赞同：2
> 
> 时间：2013-01-29T18:04:21.847
> 
> 标签：c, pointers, memory, gcc, segmentation-fault

我在 C (linux(x86_64)) 中有这样的代码：

```
typedef struct 
{
   char k[32];
   int v;
}ABC;

ABC states[6] = {0};

ABC* get_abc()
{
   return &states[5];
} 
```

在 main() 中：

```
int main()
{
  ABC *p = get_abc();
     .
     .
     .
  printf("%d\n", p->v); 
} 
```

在访问 p->v 时，我在 printf 语句中遇到分段错误。我试图从 gdb 调试它，它说“无法访问内存”。这里有一件重要的事情是，当我编译这段代码时，gcc 会在**ABC *p = get_abc();上向我发出警告。**我正在尝试将指针从整数转换。我的问题是我从 get_abc() 返回结构的地址，那么为什么编译器会给我这样的警告？为什么编译器将其视为整数？我认为由于此警告，我遇到了分段错误，因为整数不能在 x86_64 中保存内存地址。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:11:47.420

在函数之前定义`get_abc`原型`main`。如果函数原型在该函数调用之前不可用，编译器将默认将该函数视为传递`int`参数并返回`int`。这里`get_abc`实际上返回 8 字节地址，但该值已被抑制为 4 字节，并存储在`ABC *p`导致崩溃的变量中。

```
ABC* get_abc(); 
int main()
{
    ABC *p = get_abc();
} 
```

注意：在 int 大小和地址大小为 4 字节的 32 位机器上不会发生这种崩溃，因为不会发生抑制。但是那个警告会在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:17:18.913

您还没有向我们展示您的所有代码，但我可以肯定地猜测`get_abc()`and函数是在单独的源文件中定义的，并且在调用中`main()`没有可见的 visible 声明。`get_abc()``main()`

您应该创建一个包含以下*声明*的头文件`get_abc()`：

```
ABC *get_abc(); 
```

并且`#include`该标题在定义的文件`get_abc()`和定义的文件中都存在`main()`。（您还需要标头保护。）您需要将类型的定义移动`ABC`到该标头。

或者，作为一种快速而简单的解决方法，您可以在定义之前添加一个显式声明`main()`-- 但这是一个相当脆弱的解决方案，因为它取决于您是否完全正确地获得声明。

在没有可见声明的情况下，未声明的函数被假定为 return `int`。编译器看到您对 的调用`get_abc()`，生成代码来调用它*，就好像*它返回了一个`int`，然后将该值隐式转换`int`为指针。欢闹随之而来。

注意：实际上没有从`int`指针类型到指针类型的隐式转换，除了空指针常量的特殊情况，但许多编译器出于历史原因实现了这种隐式转换。此外，“隐式`int`”规则在 1999 版标准中被删除，但同样，由于历史原因，许多编译器仍然实施它。您的编译器应该具有启用更好警告的选项。如果您使用 gcc，请尝试`gcc -pedantic -std=c99 -Wall -Wextra`.

# oop - 从带有 Id 的数据库中获取对象时，我是否使用 Option 作为结果？

> ID：14589315
> 
> 赞同：3
> 
> 时间：2013-01-29T18:04:23.163
> 
> 标签：oop, scala, functional-programming, playframework-2.0, slick

我做了一个从数据库中获取用户的定义。

```
 def user(userId: Int) : User = database withSession {
    (for{
      u <- Users if u.id === userId} 
    yield u).first
  } 
```

如果与不存在的 userId 一起使用，数据库可能会返回一个空列表。
但是我看不到何时会提供不存在的 userId。例如，我的 userId 是从登录用户中获取的。如果提供了不存在的 userId，那么我认为可以使请求失败。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:30:55.130

不，很难使请求失败：

```
def user(userId: Int) : Option[User] // is OK
def user(userId: Int) : Either[String,User] // is OK
def user(usedId: Int) : User // is not OK 
```

或者你可以创建一个类型（一个概念）来封装一个 Integer 以确保它是一个有效的 UserId （在出生时）。

```
sealed case class UserId(u:Int) //extends AnyVal // If it's scala 2.10.0

object UserId {
    def get(i:Int) : Option[UserId] = //some validation

} /// ....

def  user(userId:UserId) : User //is OK // well it depends on the semantic of user destruction. 
```

当你创建一个 def 时，你必须确保你的函数的域（this 和 args）和 codomain（result）之间存在正确的关系。

无论如何，不​​要犹豫输入（创建概念），它会帮助你推理你的代码。

* * *

为什么`def user(userId: Int) :User`不行？

`Integer`因为元素之间的关系`User`不存在。如果 UserIds 都是正整数，但您要求，该`user(-10)`怎么办？（这不会发生，对吧？）这个调用应该引发异常吗？还是返回 null ？

如果你认为它应该返回 null，然后返回一个 Option，它封装了潜在的缺失对应关系。

如果您认为它应该引发异常，则返回：

*   一个`Validation[SomethingRepresentingAnError, User]`（斯卡拉兹），
*   一个`Either[SomethingRepresentingAnError, User]`(scala 2.7, 2.8, 2.9)
*   或[`Try[User]`](http://www.scala-lang.org/api/current/index.html#scala.util.Try)（scala 2.10）

拥有丰富的返回类型将帮助您正确使用 API。

顺便说一句，Scala 不使用检查异常，因此您不能使用异常作为替代结果。应该为真正的异常行为保留异常（作为运行时异常）。

也可以看看 ：

*   http://www.scala-lang.org/api/current/index.html#scala.util.control.Exception$

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T19:09:23.067

我认为在通过 id 获取数据时返回 Option[] 总是一个好主意。您无法确定具有此类 ID 的用户是否存在。例如。另一个请求已删除此用户或有人试图篡改您的输入数据。数据库是应用程序的外部系统，如果您知道如何从此类故障中恢复，那么您应该这样做。特别是在 Scala 中，Option 是完成此类任务的好工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T21:44:40.930

`Option`是表示某些可能失败的计算的返回值的最简单的方式。*只有*在处理 Java 代码并且您的双手以某种方式被现有 API 束缚时（并且当您从 Java 代码调用代码时）才`null`可以接受抛出异常或返回。

 *下一步`Option`是`Either[FailureIndication, SuccessValue]`.

进一步的改进是 ScalaZ 的`Validation`.*

# asp.net-mvc - 如何填充列表框

> ID：14589322
> 
> 赞同：0
> 
> 时间：2013-01-29T18:04:50.747
> 
> 标签：asp.net-mvc, entity-framework

我认为我的问题是基本的，但我无法在 Asp.Net MVC 3 中找到解决此问题的方法。

我有一个带有控制器的模型，称为“Concepto”。我想查看 Create 视图，这是一个包含来自 Concepto 模型的所有数据的 ListBox。

Index 视图显示了来自模型的完整数据，因此数据库连接和 EF 过程是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T23:35:06.683

您好，您应该使用模型创建一个强类型视图。在视图的上下文中拥有模型后，您可以使用 MVC 助手来呈现数据。例如，如果您在属性 PostalAddress 中存储了多行邮政地址数据，则可以使用

```
@Html.TextAreaFor(m => m. PostalAddress) 
```

您可以通过提供 col 和 row 信息作为第二个参数来进一步自定义文本区域

```
@Html.TextAreaFor(m => m. PostalAddress, new {@cols=”50”, @rows=”20”}) 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T04:01:33.363

您不能在 ListBox 中显示所有数据。但是，您可以使用需要字段`@Html.ListBoxFor()`名称和项目集合的方法将一个字段作为 List itme 的显示文本，将另一个字段作为其值（如 ID）。 `@Html.ListBoxFor(model => m.someId, Model.CollectionData);`

谢谢，

# c++ - 在 AMD CCC 中启用 OpenGL 三重缓冲 + vsync 会破坏我们的应用程序

> ID：14589323
> 
> 赞同：1
> 
> 时间：2013-01-29T18:04:53.790
> 
> 标签：c++, windows, opengl, graphics, driver

我们有一个用 C++ 编写的桌面 Windows 应用程序，它使用 OpenGL 渲染视图。

在某些 AMD 卡上，如果您打开 Catalyst Control Center 并强制启用 Triple Buffering 和 V-sync，它会破坏我们的应用程序：根本没有渲染，它只是一个灰屏（在某些其他驱动程序版本上，它会在创建上下文时崩溃）。关闭三重缓冲*或垂直同步**可*将其恢复正常。

我们用于`wglSwapIntervalEXT`在我们的应用程序中启用垂直同步。考虑到它可能会发生冲突，我删除了它的代码；不用找了。

这绝对是一个驱动程序错误，还是我们必须做任何不同的事情来处理三重缓冲？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T04:53:17.057

我在自己的应用程序中遇到了同样的问题，追踪起来令人抓狂。以下是我可以根据我为复制问题而构建的最小应用程序测试设置提供的附加信息：

1) 您设置像素格式和创建 GL RC 的所有调用都将成功。但是，GLDebugger 将显示 RC 实际上并没有获取静态缓冲区。

2) 当你尝试使 RC 成为当前状态时，它将返回 false，并且 GetLastError() 表示存在无效句柄。

3) 我只能在 MFC 中复制这个问题。那是你用的吗？当我使用直接的 Win32 API 构建测试平台应用程序时，它工作正常。这里必须有一个不起眼的互动。

4) 如果我将 RC 创建延迟到 OnCreate 之后，那么一切正常。

恐怕我的答案倾向于“驱动程序错误”，但第 4 点显示了一种解决方法——而不是在 OnCreate 中创建 GL 窗口，而是尝试在 OnInitialUpdate 中一次性完成——这到目前为止是有效的在为我测试！

**更新**：我已经就这个问题联系了 AMD，事实证明这是 MFC 最初创建宽度/高度为零的窗口，然后调整大小的结果。如果在您的 PreCreate 函数中分配非零维度，则一切正常。

希望这对于每个试图弄清楚这是怎么回事的人来说都是一个很好的资源！

# javascript - 使用谷歌地图在两组标记之间切换

> ID：14589324
> 
> 赞同：1
> 
> 时间：2013-01-29T18:04:59.353
> 
> 标签：javascript, google-maps-api-3, google-maps-markers, overlays

我正在使用 Google Maps Javascript API，在我的网站上我想显示人物和地点，但不能同时显示。用户应该能够从第一组人物标记切换到一组地点标记。

我可以简单地删除所有人物标记，然后放置所有地点标记，但似乎还有另一种使用 OverlayView 类进行切换的方法。

它是如何工作的 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T16:25:04.630

它可能首先看起来很笨拙，但标记本身是覆盖，并且“按书”删除和显示它们已经完成使用数组和循环设置对它们的引用，例如`marker.setMap(null)`我为你挖出的[文档示例](https://developers.google.com/maps/documentation/javascript/overlays#RemovingOverlays)很好地展示了你需要如何玩他们。我过去使用过它们（显示和删除）从未遇到过真正的性能问题，它相对较快。

关键是在您需要之前不要完全删除它们，只需将它们的地图设置为 null 即可将它们从地图中删除。如果您需要再次显示它们，请始终将它们保存在一个数组中。对于您的情况，我要么制作两个标记数组，要么只制作一个数组，其中标记具有参数，例如`marker.myType="people"`您可以在循环和执行操作时使用这些参数进行检查。

# performance - SSL 性能影响

> ID：14589326
> 
> 赞同：1
> 
> 时间：2013-01-29T18:05:00.853
> 
> 标签：performance, ssl, iis-7, login, https

> **可能重复：**
> [SSL 会产生多少开销？](https://stackoverflow.com/questions/548029/how-much-overhead-does-ssl-impose)

我最近与一位开发人员进行了交谈，他告诉我，在站点范围内实施 SSL 会使服务器负载增加 300 倍。这真的可信吗？我目前在所有页面上都使用 SSL，我们每天有数千名用户访问系统，没有任何明显的延迟。我们正在使用 IIS 7 服务器。

他的解决方案是仅在登录页面上使用 SSL 来保护登录凭据的传输。然后将它们重定向回 HTTP ...这是一种好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T19:34:10.100

HTTPS 中代价高昂的是握手，包括 CPU（非对称加密操作更昂贵）和网络往返（不仅是握手本身，还包括检查证书吊销）。在此之后，加密是使用对称加密完成的，这不应该对现代 CPU 造成很大的开销。有一些方法可以减少由于握手引起的开销（特别是通过会话恢复，如果支持和配置）。

在许多情况下，将静态内容配置为在客户端也可缓存是很有用的（请参阅 参考资料`Cache-Control: public`）。某些浏览器默认不缓存 HTTPS 内容。

使用 HTTPS 时将服务器的 CPU 负载增加 300 听起来好像配置不正确。

> 他的解决方案是仅在登录页面上使用 SSL 来保护登录凭据的传输。然后将它们重定向回 HTTP ...这是一种好习惯吗？

许多网站都这样做（包括 StackOverflow）。这取决于需要多少安全性。如果您这样做，则只有凭据会受到保护。攻击者可以窃听以纯 HTTP 传递的 cookie（或类似的身份验证令牌），并使用它来模拟经过身份验证的用户。

从 HTTP 切换到 HTTPS 或以其他方式切换时需要非常小心。例如，来自登录页面的身份验证令牌在传递给纯 HTTP 后应被视为“已泄露”。特别是，您不能假设仍然使用该身份验证令牌的后续 HTTPS 请求来自合法用户（例如，不允许它编辑“我的帐户”详细信息或任何类似内容）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-30T00:10:53.790

他正在弥补。您肯定想到 300 是一个可疑的整数吗？请他证明。测试和测量。

它肯定会给服务器*增加更多*负载，如果你真的有问题，其中大部分可以卸载到硬件加密加速器或前端盒，但根据我的经验，它可以忽略不计。请参阅[此处](https://stackoverflow.com/q/548029/372643)了解更多信息。

他关于在登录后恢复到 HTTP 的建议只有在登录页面是站点中唯一需要传输安全性的页面时才有意义。情况不太可能如此。

坦率地说，他似乎对这一切都不太了解。

大约 15 年前，我做了一个大型实验，结果表明在 Internet 上 SSL 的时间开销约为 30%。

# c# - Linq to SQL 插入商标“™”符号

> ID：14589327
> 
> 赞同：1
> 
> 时间：2013-01-29T18:05:01.967
> 
> 标签：c#, sql-server-2008, linq-to-sql

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:06:44.533

You should be able to just insert it. C# strings are unicode as are `nvarchar` columns. Have you tried simply inserting it?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:10:12.587

Have you tried with the ASCII value ( Alt + 0153 ) for "tm" symbol?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T18:13:23.190

Your literals are not unicode; try:

```
SELECT REPLACE(N'Microsoft™',N'™','') 
```

and

```
INSERT mytable(col1) VALUES (N'™') 
```

(hint: they work)

# c++ - 网络怪异行为

> ID：14589330
> 
> 赞同：2
> 
> 时间：2013-01-29T18:05:07.683
> 
> 标签：c++, sockets, networking

我有一个小应用程序（c++），它连接（winsock 连接/发送）到服务器并发送一个数据包（28 个字节）以检查是否有可用的更新。

该应用程序运行良好，我从不同的国家/地区尝试没有问题，但我在亚洲国家/地区遇到了一些问题。

服务器在美国，测试客户端在泰国。

问题是，客户端连接正常（我可以看到服务器上的连接），发送数据包（我可以看到客户端wireshark上传递的数据包），但永远不会到达服务器。

此捕获来自服务器，并且是到达的，仅此而已。

```
13:37:15.103682 IP asianet.co.th.52739 > transip.net.http: Flags [S], seq 3221849952, win 8190, options [mss 1460,nop,wscale 3,nop,nop,sackOK], length 0
13:37:15.103764 IP transip.net.http > asianet.co.th.52739: Flags [R.], seq 0, ack 3221849953, win 0, length 0
13:37:18.039495 IP asianet.co.th.46755 > transip.net.http: Flags [S], seq 3299550171, win 8190, options [mss 1460,nop,wscale 3,nop,nop,sackOK], length 0 
```

这是客户端上的捕获

```
No.     Time        Source                Destination           Protocol Length Info
      1 0.000000    asianet.co.th         transip.net         TCP      62     vtr-emulator > http [SYN] Seq=0 Win=65535 Len=0 MSS=1460 SACK_PERM=1

Frame 1: 62 bytes on wire (496 bits), 62 bytes captured (496 bits)
Ethernet II, Src: Dell_1e:1c:72 (78:2b:cb:1e:1c:72), Dst: Cisco_2c:17:c8 (00:21:1c:2c:17:c8)
Internet Protocol Version 4, Src: asianet.co.th (asianet.co.th), Dst: transip.net (transip.net)
Transmission Control Protocol, Src Port: vtr-emulator (3122), Dst Port: http (80), Seq: 0, Len: 0

No.     Time        Source                Destination           Protocol Length Info
      2 0.291298    transip.net         asianet.co.th         TCP      62     http > vtr-emulator [SYN, ACK] Seq=0 Ack=1 Win=8190 Len=0 MSS=1460 SACK_PERM=1

Frame 2: 62 bytes on wire (496 bits), 62 bytes captured (496 bits)
Ethernet II, Src: Cisco_2c:17:c8 (00:21:1c:2c:17:c8), Dst: Dell_1e:1c:72 (78:2b:cb:1e:1c:72)
Internet Protocol Version 4, Src: transip.net (transip.net), Dst: asianet.co.th (asianet.co.th)
Transmission Control Protocol, Src Port: http (80), Dst Port: vtr-emulator (3122), Seq: 0, Ack: 1, Len: 0

No.     Time        Source                Destination           Protocol Length Info
      3 0.291316    asianet.co.th         transip.net         TCP      54     vtr-emulator > http [ACK] Seq=1 Ack=1 Win=65535 Len=0

Frame 3: 54 bytes on wire (432 bits), 54 bytes captured (432 bits)
Ethernet II, Src: Dell_1e:1c:72 (78:2b:cb:1e:1c:72), Dst: Cisco_2c:17:c8 (00:21:1c:2c:17:c8)
Internet Protocol Version 4, Src: asianet.co.th (asianet.co.th), Dst: transip.net (transip.net)
Transmission Control Protocol, Src Port: vtr-emulator (3122), Dst Port: http (80), Seq: 1, Ack: 1, Len: 0

No.     Time        Source                Destination           Protocol Length Info
      4 1.276972    asianet.co.th         transip.net         HTTP     82     Continuation or non-HTTP traffic

Frame 4: 82 bytes on wire (656 bits), 82 bytes captured (656 bits)
Ethernet II, Src: Dell_1e:1c:72 (78:2b:cb:1e:1c:72), Dst: Cisco_2c:17:c8 (00:21:1c:2c:17:c8)
Internet Protocol Version 4, Src: asianet.co.th (asianet.co.th), Dst: transip.net (transip.net)
Transmission Control Protocol, Src Port: vtr-emulator (3122), Dst Port: http (80), Seq: 1, Ack: 1, Len: 28
Hypertext Transfer Protocol

No.     Time        Source                Destination           Protocol Length Info
      5 1.278358    transip.net         asianet.co.th         TCP      60     http > vtr-emulator [ACK] Seq=1 Ack=29 Win=27712 Len=0

Frame 5: 60 bytes on wire (480 bits), 60 bytes captured (480 bits)
Ethernet II, Src: Cisco_2c:17:c8 (00:21:1c:2c:17:c8), Dst: Dell_1e:1c:72 (78:2b:cb:1e:1c:72)
Internet Protocol Version 4, Src: transip.net (transip.net), Dst: asianet.co.th (asianet.co.th)
Transmission Control Protocol, Src Port: http (80), Dst Port: vtr-emulator (3122), Seq: 1, Ack: 29, Len: 0

No.     Time        Source                Destination           Protocol Length Info
      6 1.289416    asianet.co.th         transip.net         TCP      54     vtr-emulator > http [RST, ACK] Seq=29 Ack=1 Win=0 Len=0

Frame 6: 54 bytes on wire (432 bits), 54 bytes captured (432 bits)
Ethernet II, Src: Dell_1e:1c:72 (78:2b:cb:1e:1c:72), Dst: Cisco_2c:17:c8 (00:21:1c:2c:17:c8)
Internet Protocol Version 4, Src: asianet.co.th (asianet.co.th), Dst: transip.net (transip.net)
Transmission Control Protocol, Src Port: vtr-emulator (3122), Dst Port: http (80), Seq: 29, Ack: 1, Len: 0 
```

注意：如果您在任何地方看到“http”，那只是因为服务器在端口 80 上工作。

注意 2：客户端捕获的第 4 帧是我的数据包。

我知道找出问题所在可能很复杂，但也许有人可以给我一个线索。

谢谢。-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:45:34.627

您的服务器端捕获显示服务器将 RESET 发送回客户端，即**拒绝**连接。

另一方面，客户端捕获显示完成的三向 TCP 握手。这可以通过服务器前面的防火墙/路由器来解释，它试图通过伪装成目标 TCP 目标、完成握手、然后才将其重播到其后面的侦听服务器来防止[SYN 泛洪攻击。](http://en.wikipedia.org/wiki/SYN_flood)此外，在这种防御性场景中，通常会重新映射 TCP 序列号。`RST`然后，您稍后会在客户端捕获中看到这一点。

客户端的源端口号在两个捕获之间不匹配的事实（假设这是相同的对话）也指向中间某些东西的方向。

检查您的 DNS 是否正确。检查路径中有哪些中间设备（防火墙、交换机、路由器）以及它们在做什么。确保您的服务器软件实际上*正在侦听*该端口 80。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T20:08:59.853

您在服务器和客户端之间建立什么样的连接？TCP/IP？我不熟悉 Wireshark，但似乎第 4 帧被归类为“超文本传输​​协议”。我知道你的帖子说“注意：如果你在任何地方看到'http'，那只是因为服务器在端口 80 上工作。”但是 Wireshark 真的会仅仅因为它在端口 80 上而将其报告为“超文本传输​​协议”吗？也许您可以尝试其他未阻塞的端口，看看是否得到相同的结果？（并且任一端都可能在将一些数据包重定向到另一台主机的启用 NAT 的路由器后面？）

# android - 无法在三星 Galaxy Tab 10.1 (Android 3.1) 上安装 apk 文件。“Package ABC has mismatched uid”和“Can't byte swap: bad dex version”

> ID：14589333
> 
> 赞同：2
> 
> 时间：2013-01-29T18:05:20.733
> 
> 标签：android, unity3d

我有 Unity 项目，它适用于除三星 Galaxy Tab 10.1 (Android 3.1) 之外的所有设备。

这是日志：

```
 01-29 16:20:50.550: D/installd(228): DexInv: --- BEGIN '/data/app/ABC.apk' ---
01-29 16:20:50.550: E/PackageManager(296): Package A.B.C has mismatched uid: 10106 on disk, 10107 in settings
01-29 16:20:50.550: I/PackageManager(296): Linking native library dir for /data/app/ABC.apk
01-29 16:20:50.570: E/dalvikvm(1132): ERROR: Can't byte swap: bad dex version (0x30 33 36 00)
01-29 16:20:50.570: E/dalvikvm(1132): ERROR: Byte swap + verify failed
01-29 16:20:50.890: E/dalvikvm(1132): Optimization failed
01-29 16:20:50.890: W/installd(228): DexInv: --- END '/data/app/ABC.apk' --- status=0xff00, process failed
01-29 16:20:50.890: E/installd(228): dexopt failed on '/data/dalvik-cache/data@app@ABC.apk@classes.dex' res = 65280
01-29 16:20:50.900: W/PackageManager(296): Package couldn't be installed in /data/app/ABC.apk
01-29 16:20:50.980: D/dalvikvm(296): GC_EXPLICIT freed 1360K, 48% free 16024K/30791K, paused 10ms+5ms
01-29 16:20:50.990: D/AndroidRuntime(1123): Shutting down VM 
```

可能有人有同样的错误。

# c# - WCF Web 服务不返回 WSDL

> ID：14589336
> 
> 赞同：8
> 
> 时间：2013-01-29T18:05:34.457
> 
> 标签：c#, wcf, wsdl

使用`wsdl.exe /l:CS /serverInterface`，我从 WDSL 文档生成了一个 C# 接口。我已经在 WCF 类上实现了该接口。生成的服务在本地运行：

```
http://localhost:51454/TapasSim.svc 
```

这显示了默认站点。当我附加`?wsdl`到 URL 时出现问题：

```
http://localhost:51454/TapasSim.svc?wsdl 
```

![在此处输入图像描述](../Images/c23f986e3e540710895301f14717af78.png)

与我的预期不同，此链接不返回 WDSL 文档！相反，它指向您在没有`?wsdl`. 结果，我无法引用 Web 服务。如果我运行`svcutil.exe`它会给出这个错误：

> 如果您尝试生成客户端，这可能是因为元数据文档不包含任何有效的合同或服务，或者因为发现所有合同/服务都存在于 /reference 程序集中。验证您是否将所有元数据文档传递给该工具。

但我希望该错误与缺少回复的原因相同`?wsdl`。

什么可能导致 WCF`.svc`服务不生成 WSDL？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-29T19:51:46.063

事实证明，问题在于混合了两种技术。 `wdsl.exe`属于早于 WCF 的较旧的“Web 引用”。较新的工具`svcutil.exe`用于生成 WCF“服务引用”接口。

所以发生的事情是 WCF 寻找`[ServiceContract]`和`[OperationContract]`属性。当它找不到任何东西时，它默默地什么也没做。

至少可以说，对这种情况的无声压制很烦人。像这样的错误`No service with [ServiceContract] attribute found`真的会有所帮助。

请注意，您可以手动添加`[ServiceContract]`，但这会留下一半“服务参考”一半“Web 参考”。结果可能行不通。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T16:18:27.053

我在通过启动调试会话提供的 IE 窗口获取 WSDL 时遇到问题。我必须使用一个单独的窗口，确保我将 HTTPS 放在 URL 中。

我们在 443 (SSL) 上托管我们的服务。当您启动调试器时，即使 IE 窗口显示 http: (80)，它也在侦听 443 上的流量。
仅供参考，这是通过项目级别设置**SSL Enabled控制的**

# tomcat - 安装具有评估拓扑的 IBM Rational CLM 解决方案后服务器无法启动

> ID：14589339
> 
> 赞同：1
> 
> 时间：2013-01-29T18:05:38.913
> 
> 标签：tomcat, tomcat7, ibm-rational

我一直在尝试使用评估拓扑安装和运行 IBM Rational Solution for CLM，以进行软件演示。

我能够继续完成所有安装步骤，但是一旦我到达启动服务器的步骤，它就不会启动。

当我尝试启动服务器时，会打开一个新的命令提示符窗口，但会立即关闭。/server/tomcat/logs 下的日志文件未更新。

我最初是在 Windows 7 VMware 虚拟机中设置服务器。从那以后，我尝试在运行 CentOS 的新虚拟机中设置它，但得到了相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:43:01.627

如[该线程](https://jazz.net/forum/questions/79599/tomcat-server-not-starting?sort=votes&page=2)所示，调试此问题的唯一方法是在启动脚本中放置大量“回声”：

> 当我遇到这个问题时，真正帮助我的是在`.bat`文件中添加 echo 语句，看看它有多远。
> 在我的情况下，它一直到`catalina.bat`文件末尾，我在屏幕上打印出最终的运行命令。
> 当我在 dos 窗口中手动调用相同的命令时，我能够看到返回了什么错误，因为它在一瞬间后没有关闭。也许这种方法也会对您有所帮助。

通常是内存问题。

如果不是 - 还有几件事要检查：

> 1.  磁盘空间 - 你有很多可用的磁盘空间 - 尤其是。TEMP 环境变量的位置。
> 2.  当 Ralph 谈到以管理员身份启动时 - 他的意思是使用 shell 上的右键“以管理员身份运行”选项启动 DOS shell。
> 3.  您是否有任何防火墙设置阻止访问诸如 9443、9080 和更隐蔽的端口（如 9003）？
> 4.  安装 RTC 的用户是否具有对这些 c:\ibm 目录和子目录的读/写访问权限。如果Tomcat无法写入日志文件，我已经看到它无法启动（这是一个毫无意义的问题，因为您有catalina日志）。

[该线程](https://jazz.net/forum/questions/93111/error-in-tomcat-and-unable-connect-to-jts)确认了内存问题：

> 请检查[https://jazz.net/library/article/811](https://jazz.net/library/article/811)以了解您的服务器操作系统的补丁级别。该文件还指出至少 8GB RAM。
> 
> 如果日志中没有出现任何内容，则表示严重的 Tomcat 或 JVM 问题。您可能会遇到 RAM 问题。我建议查看核心转储以了解发生了什么。
> 
> 其他一些提示：
> 
> *   不要在 Program Files 中安装使用 /IBM/ 或其他东西
> *   如果这不是一个测试系统，请使用 DB2 而不是 derby。Derby 仅用于演示目的。

# ruby-on-rails - Ruby：堆栈级别太深（SystemStackError）

> ID：14589341
> 
> 赞同：5
> 
> 时间：2013-01-29T18:05:45.800
> 
> 标签：ruby-on-rails, ruby, cygwin, bundler

Ruby 在 Cygwin 中的 rails 和 bundler 崩溃了。

```
$ ruby -v
ruby 1.9.3p374 (2013-01-15 revision 38858) [i386-cygwin]

Chloe@dumbopc /cygdrive/c/Sites
$ rails -v
Rails 3.2.11

Chloe@dumbopc /cygdrive/c/Sites
$ cd testapp

Chloe@dumbopc /cygdrive/c/Sites/testapp
$ rails -v
/usr/lib/ruby/site_ruby/1.9.1/rubygems/requirement.rb:114: stack level too 
deep (SystemStackError)

Chloe@dumbopc /cygdrive/c/Sites/testapp
$ bundle install
Fetching gem metadata from https://rubygems.org/...........
Fetching gem metadata from https://rubygems.org/..
Unfortunately, a fatal error has occurred. Please see the Bundler
troubleshooting documentation at http://bit.ly/bundler-issues. Thanks!
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/friendly_errors.rb:32: 
stack level too deep (SystemStackError) 
```

我尝试了 Ruby 的两个版本，ruby 1.9.3p327 和 ruby​​-1.9.3-p374-1。我从谷歌发现了一些暗示 1.9.2 可能会解决问题的东西，但我无法在 setup.exe 中选择它。我也试过

```
peflags -x8192000 `which ruby` 
```

这没有帮助。我也试过18192000。我卸载了Ruby并重新安装。与导轨相同。仅当它位于应用程序目录中时才会失败。当我尝试

```
rails new testapp 
```

它创建目录和文件，但在`bundle install`. 我也无法`rails -v`在该目录中运行。我怀疑还有其他命令也会失败，但我还没有找到它们。我正在使用 Windows XP SP3。

```
$ uname -a
CYGWIN_NT-5.1 dumbopc 1.7.17(0.262/5/3) 2012-10-19 14:39 i686 Cygwin 
```

如果你好奇的话，这里有不好的台词

```
$ rails -v
/usr/lib/ruby/site_ruby/1.9.1/rubygems/requirement.rb:114: stack level too 
deep (SystemStackError)
$ cat -n /usr/lib/ruby/site_ruby/1.9.1/rubygems/requirement.rb | grep '^ *114'
   114      requirements.map { |op, version| "#{op} #{version}" }.sort
$ bundle install
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/friendly_errors.rb:32: 
stack level too deep (SystemStackError)
$ cat -n /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/friendly_errors.rb |  grep '^ *32'
    32        raise e 
```

我还尝试了 bundler 按照其链接提供的所有建议。我将 -d 添加到 rails 脚本并打印了以下内容：

```
$ rails -v
Exception `LoadError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems.rb:1264 - cannot load such file -- rubygems/defaults/operating_system
Exception `LoadError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems.rb:1273 - cannot load such file -- rubygems/defaults/ruby
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=0.9.2.2>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=rake version=10.0.3>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.5>
Exception `NoMethodError' at /usr/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1495 - undefined method `to_ary' for #<Gem::Specification name=json version=1.7.6>
/usr/lib/ruby/site_ruby/1.9.1/rubygems/requirement.rb:118: stack level too deep (SystemStackError)

$ head -1 /usr/bin/rails
#!/usr/bin/ruby.exe -d 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T19:16:17.737

我认为您的 peflags 命令行是错误的。尝试：

```
peflags -X409600 `which ruby` 
```

[如此处](https://stackoverflow.com/questions/13079890/first-ever-bundle-install-stack-level-too-deep/14790573#14790573)所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T11:08:41.527

同样的事情发生在我身上。我从 cygwin 安装文件中卸载了 ruby​​，当我在 CMD 中 ram ruby​​ -v 时，它仍然存在！

事实证明，我在“PATH”环境变量中有其他 ruby​​.exe 实例。所以检查你的环境变量，卸载所有东西，看看它是否指向另一个 ruby​​ 文件。

# c++ - C++ 是上下文无关的还是上下文敏感的？

> ID：14589346
> 
> 赞同：427
> 
> 时间：2013-01-29T18:05:56.800
> 
> 标签：c++, syntax, grammar, context-free-grammar, context-sensitive-grammar

我经常听到有人声称 C++ 是一种上下文相关的语言。举个例子：

```
a b(c); 
```

这是变量定义还是函数声明？这取决于符号的含义`c`。如果`c`是一个*变量*，则`a b(c);`定义一个名为`b`type的变量`a`。它直接用 初始化`c`。但是如果`c`是一个*类型*，那么`a b(c);`声明一个名为的函数`b`，它接受一个`c`并返回一个`a`。

如果您查看上下文无关语言的定义，它基本上会告诉您所有语法规则都必须具有仅由一个非终结符组成的左侧。另一方面，上下文相关文法允许在左侧出现任意的终结符和非终结符字符串。

浏览“C++ 编程语言”的附录 A，我找不到一个语法规则，它的左侧除了一个非终结符之外还有其他任何东西。这意味着 C++ 是上下文无关的。（当然，从上下文无关语言形成上下文相关语言的子集的意义上说，每种上下文无关语言也是上下文相关的，但这不是重点。）

那么，C++ 是上下文无关的还是上下文敏感的？

* * *

## 回答 #1

> 赞同：364
> 
> 时间：2013-01-29T18:18:40.330

下面是我（当前）最喜欢的演示为什么解析 C++ 是（可能）[图灵完备的](http://en.wikipedia.org/wiki/Turing_completeness)，因为它显示了一个程序在语法上是正确的，当且仅当给定整数是素数时。

所以我断言**C++ 既不是 context-free 也不是 context-sensitive**。

如果在任何产生式的两边都允许任意符号序列，则在[Chomsky 层次结构](http://en.wikipedia.org/wiki/Chomsky_hierarchy#The_hierarchy)中产生一个 Type-0 语法（“无限制”） ，它比上下文相关语法更强大；不受限制的文法是图灵完备的。上下文相关（Type-1）语法允许在产生式的左侧出现多个上下文符号，但相同的上下文必须出现在产生式的右侧（因此名称为“上下文敏感”）。[1] 上下文相关文法等价于[线性有界图灵机](http://en.wikipedia.org/wiki/Linear_bounded_automaton)。

在示例程序中，素数计算可以由线性有界图灵机执行，因此它并不能完全证明图灵等价，但重要的部分是解析器需要执行计算才能执行句法分析。它可以是任何可表示为模板实例化的计算，并且完全有理由相信 C++ 模板实例化是图灵完备的。例如，参见[Todd L. Veldhuizen 2003 年的论文](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.14.3670)。

无论如何，C++ 可以被计算机解析，所以它当然可以被图灵机解析。因此，不受限制的语法可以识别它。实际上编写这样的语法是不切实际的，这就是标准不尝试这样做的原因。（见下文。）

某些表达的“歧义”问题主要是红鲱鱼。首先，歧义是特定语法的特征，而不是语言。即使可以证明一种语言没有明确的语法，如果它可以被上下文无关语法识别，它就是上下文无关的。同样，如果它不能被上下文无关文法识别，但可以被上下文相关文法识别，则它是上下文相关的。模棱两可无关紧要。

但无论如何，就像`auto b = foo<IsPrime<234799>>::typen<1>();`下面程序中的第 21 行（即 ）一样，表达式一点也不含糊；它们只是根据上下文进行不同的解析。在这个问题的最简单表达中，某些标识符的句法类别取决于它们的声明方式（例如类型和函数），这意味着形式语言必须认识到两个任意长度的字符串在相同的程序是相同的（声明和使用）。这可以通过“复制”语法来建模，该语法是识别同一单词的两个连续精确副本的语法。[用抽水引理](http://en.wikipedia.org/wiki/Pumping_lemma)很容易证明这种语言不是上下文无关的。该语言的上下文敏感语法是可能的，并且在此问题的答案中提供了 Type-0 语法：[https ://math.stackexchange.com/questions/163830/context-sensitive-grammar-for-the-复制语言](https://math.stackexchange.com/questions/163830/context-sensitive-grammar-for-the-copy-language)。

如果有人试图编写一种上下文相关（或不受限制）的语法来解析 C++，它很可能会用乱七八糟的东西填满整个宇宙。编写图灵机来解析 C++ 将是同样不可能的任务。甚至编写 C++ 程序也很困难，据我所知，没有一个被证明是正确的。这就是为什么该标准不尝试提供完整的形式语法，以及为什么它选择用技术英语编写一些解析规则的原因。

在 C++ 标准中看起来像形式语法的东西并不是 C++ 语言语法的完整形式定义。它甚至不是预处理后语言的完整正式定义，这可能更容易形式化。（不过，这不是语言：标准定义的 C++ 语言包括预处理器，并且预处理器的操作是用算法描述的，因为它很难用任何语法形式来描述。它在那个部分描述词法分解的标准，包括必须多次应用的规则。）

各种文法（用于词法分析的两种重叠文法，一种在预处理之前进行，另一种在必要时在之后进行，加上“句法”文法）收集在附录 A 中，并附有重要说明（添加了重点）：

> 此 C++ 语法摘要旨在帮助理解。**这不是语言的准确表述**。特别是，此处描述的语法接受*有效 C++ 构造的超集*。必须应用消歧规则（6.8、7.1、10.2）来区分表达式和声明。此外，必须使用访问控制、歧义和类型规则来清除语法上有效但无意义的结构。

最后，这是承诺的程序。当且仅当 N in`IsPrime<N>`是素数时，第 21 行在语法上是正确的。否则，`typen`是整数，而不是模板，因此`typen<1>()`被解析为`(typen<1)>()`语法不正确，因为`()`它不是语法有效的表达式。

```
template<bool V> struct answer { answer(int) {} bool operator()(){return V;}};

template<bool no, bool yes, int f, int p> struct IsPrimeHelper
  : IsPrimeHelper<p % f == 0, f * f >= p, f + 2, p> {};
template<bool yes, int f, int p> struct IsPrimeHelper<true, yes, f, p> { using type = answer<false>; };
template<int f, int p> struct IsPrimeHelper<false, true, f, p> { using type = answer<true>; };

template<int I> using IsPrime = typename IsPrimeHelper<!(I&1), false, 3, I>::type;
template<int I>
struct X { static const int i = I; int a[i]; }; 

template<typename A> struct foo;
template<>struct foo<answer<true>>{
  template<int I> using typen = X<I>;
};
template<> struct foo<answer<false>>{
  static const int typen = 0;
};

int main() {
  auto b = foo<IsPrime<234799>>::typen<1>(); // Syntax error if not prime
  return 0;
} 
```

* * *

[1] 更专业地说，上下文相关语法中的每个产生式都必须是以下形式：

`αAβ → αγβ`

其中`A`是一个非终结符 和`α`,`β`可能是语法符号的空序列, 并且`γ`是一个非空序列。（语法符号可以是终结符或非终结符）。

这`A → γ`只能在上下文中阅读`[α, β]`。在上下文无关（类型 2）语法中，`α`并且`β`必须为空。

事实证明，您还可以使用“单调”限制来限制语法，其中每个产生式都必须采用以下形式：

`α → β`其中`|α| ≥ |β| > 0`  （`|α|`表示“的长度`α`”）

可以证明单调文法所识别的语言集与上下文相关文法所识别的语言集完全相同，而且通常更容易将证明建立在单调文法的基础上。因此，将“上下文敏感”视为“单调”的意思是很常见的。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2013-01-29T18:43:17.387

首先，您正确地观察到 C++ 标准末尾的语法中没有上下文相关规则，因此语法*是*上下文无关的。

但是，该语法并不能准确描述 C++ 语言，因为它会生成非 C++ 程序，例如

```
int m() { m++; } 
```

或者

```
typedef static int int; 
```

定义为“一组格式良好的 C++ 程序”的 C++ 语言不是上下文无关的（有可能表明仅仅需要声明的变量就可以做到这一点）。假设您理论上可以在模板中编写图灵完备的程序并根据其结果使程序格式错误，它甚至不是上下文敏感的。

现在，（无知的）人（通常不是语言理论家，而是解析器设计者）通常在以下某些含义中使用“非上下文无关”

*   模糊的
*   无法用 Bison 解析
*   不是 LL(k)、LR(k)、LALR(k) 或他们选择的任何解析器定义的语言类

标准后面的语法不满足这些类别（即它是模棱两可的，而不是 LL(k)...），因此 C++ 语法对它们来说“不是上下文无关的”。从某种意义上说，他们是对的，很难产生一个工作的 C++ 解析器。

请注意，此处使用的属性仅与上下文无关语言微弱相关 - 歧义与上下文敏感性没有任何关系（实际上，上下文相关规则通常有助于消除产生歧义），其他两个只是上下文的子集- 免费语言。并且解析上下文无关语言不是一个线性过程（尽管解析确定性语言是）。

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2009-07-23T16:46:09.733

是的。以下表达式具有不同*的操作顺序，*具体取决于*类型解析的上下文*：

编辑：当实际操作顺序发生变化时，使用“常规”编译器在装饰之前解析为未装饰的 AST（传播类型信息）变得非常困难。与此相比，提到的其他上下文相关的事情“相当容易”（并不是说模板评估很容易）。

```
#if FIRST_MEANING
   template<bool B>
   class foo
   { };
#else
   static const int foo = 0;
   static const int bar = 15;
#endif 
```

其次是：

```
static int foobar( foo < 2 ? 1 < 1 : 0 > & bar ); 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2013-01-29T18:52:31.027

要回答您的问题，您需要区分两个不同的问题。

1.  几乎所有编程语言的语法都是上下文无关的。通常，它以扩展的 Backus-Naur 形式或上下文无关语法的形式给出。

2.  然而，即使一个程序符合编程语言定义的上下文无关语法，它也不一定是一个*有效*的程序。程序必须满足许多非上下文无关属性才能成为有效程序。例如，最简单的此类属性是变量的范围。

总而言之，C++ 是否是上下文无关的取决于您提出的问题。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-07-23T17:00:16.757

您可能想看看Bjarne Stroustrup[的 The Design & Evolution of C++](http://www.stroustrup.com/dne.html)。在其中他描述了他尝试使用 yacc（或类似的）来解析 C++ 的早期版本时遇到的问题，并希望他使用递归下降代替。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2011-10-31T20:51:26.963

是的，C++ 是上下文敏感的，非常上下文敏感的。您不能通过使用上下文无关解析器简单地解析文件来构建语法树，因为在某些情况下，您需要从先前的知识中知道符号来决定（即在解析时构建符号表）。

第一个例子：

```
A*B; 
```

这是乘法表达式吗？

或者

这是将`B`变量声明为类型指针`A`吗？

如果 A 是一个变量，那么它就是一个表达式，如果 A 是一个类型，那么它就是一个指针声明。

第二个例子：

```
A B(bar); 
```

这是一个接受`bar`类型参数的函数原型吗？

或者

这是声明`B`类型的变量并使用常量作为初始化程序`A`调用 A 的构造函数吗？`bar`

您需要再次知道`bar`是符号表中的变量还是类型。

第三个例子：

```
class Foo
{
public:
    void fn(){x*y;}
    int x, y;
}; 
```

这是在解析时构建符号表无济于事的情况，因为 x 和 y 的声明出现在函数定义之后。所以你需要先扫描类定义，然后再看一遍方法定义，告诉 x*y 是一个表达式，而不是一个指针声明或其他什么。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-01-29T18:26:16.573

我感觉“上下文敏感”的正式定义和“上下文敏感”的非正式使用之间存在一些混淆。前者具有明确的含义。后者用于表示“您需要上下文才能解析输入”。

这也在这里被问到： [Context-sensitive vs Ambiguity](https://stackoverflow.com/questions/6088064/context-sensitivity-vs-ambiguity)。

这是一个上下文无关的语法：

```
<a> ::= <b> | <c>
<b> ::= "x"
<c> ::= "x" 
```

它是模棱两可的，因此为了解析输入“x”，您需要一些上下文（或忍受模棱两可，或发出“警告：E8271 - 第 115 行中的输入模棱两可”）。但它肯定不是上下文相关的语法。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-07-23T16:37:46.333

C++ 使用 GLR 解析器进行解析。这意味着在解析源代码期间，解析器*可能会*遇到歧义，但它应该继续并决定*稍后*使用哪个语法规则。

还看，

[为什么不能用 LR(1) 解析器解析 C++？](https://stackoverflow.com/questions/243383/why-c-cannot-be-parsed-with-a-lr1-parser)

* * *

请记住，上下文无关语法**不能**描述编程语言语法的**所有**规则。例如，属性文法用于检查表达式类型的有效性。

```
int x;
x = 9 + 1.0; 
```

您*不能*用上下文无关语法描述以下规则： **赋值的右侧应该与左侧的类型相同。**

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-01-30T18:58:54.360

没有类似 Algol 的语言是上下文无关的，因为它们具有约束表达式和语句的规则，标识符可以根据其类型出现在其中，并且因为在声明和使用之间可以出现的语句数量没有限制。

通常的解决方案是编写一个上下文无关的解析器，它实际上接受有效程序的超集，并将上下文敏感部分放在附加到规则的*临时“语义”代码中。*

C++ 远不止于此，这要归功于其图灵完备的模板系统。请参阅[堆栈溢出问题 794015](https://stackoverflow.com/questions/794015/what-do-people-mean-when-they-say-c-has-undecidable-grammar)。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-07-23T16:37:15.710

真的 ：）

J.斯坦利沃福德。[计算机系统](http://books.google.com/books?id=PMV2leoVg8kC&printsec=frontcover&source=gbs_v2_summary_r&cad=0)。第 341-346 页。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-07-23T16:50:13.143

有时情况更糟：[人们说 C++ 有“不可判定的语法”是什么意思？](https://stackoverflow.com/questions/794015/what-do-people-mean-when-they-say-c-has-undecidable-grammar)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-01-29T18:08:53.013

它是上下文相关的，`a b(c);`有两个有效的解析——声明和变量。当你说“If`c`是一个类型”时，这就是上下文，就在那里，你已经准确地描述了 C++ 对它的敏感程度。如果您没有“什么是`c`”的上下文 你无法明确地解析这个。

在这里，上下文以标记的选择来表达——如果解析器命名了一个类型，则解析器将一个标识符作为类型名标记读取。这是最简单的解决方案，并且避免了上下文敏感的许多复杂性（在这种情况下）。

编辑：当然，还有更多的上下文敏感性问题，我只关注你展示的那个。模板对此特别讨厌。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-01-31T00:01:07.520

C++ 标准中的产生式是在上下文无关的情况下编写的，但众所周知，它并没有真正准确地定义语言。大多数人认为当前语言中的歧义可以（我相信）通过上下文相关语法明确解决。

对于最明显的例子，让我们考虑最令人烦恼的 Parse `int f(X);`：. 如果`X`是一个值，那么这定义`f`为一个变量，将用 初始化`X`。If`X`是一个类型，它定义`f`为一个函数，接受一个 type 的参数`X`。

从语法的角度来看，我们可以这样看：

```
A variable_decl ::= <type> <identifier> '(' initializer ')' ';'

B function_decl ::= <type> <identifier> '(' param_decl ')' ';'

A ::= [declaration of X as value]
B ::= [declaration of X as type] 
```

当然，为了完全正确，我们需要添加一些额外的“东西”来解释干预其他类型声明的可能性（即，A 和 B 都应该是“包括将 X 声明为...的声明” ，或该订单上的东西）。

不过，这与典型的 CSG 仍然有很大不同（或者至少我记得它们）。这取决于正在构建的符号表 - 专门识别`X`为类型或值的部分，不仅仅是在此之前的某种类型的语句，而是正确符号/标识符的正确类型的语句。

因此，我必须做一些确定，但我的直接猜测是，这并不真正符合 CSG 的条件，至少作为通常使用的术语。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2013-01-31T08:41:26.133

非上下文无关语法的最简单情况涉及解析涉及模板的表达式。

```
a<b<c>() 
```

这可以解析为

```
template
   |
   a < expr > ()
        |
        <
      /   \
     b     c 
```

或者

```
 expr
   |
   <
 /   \
a   template
     |
     b < expr > ()
          |
          c 
```

这两个 AST 只能通过检查 'a' 的声明来消除歧义——如果 'a' 是模板，则前者为 AST，否则为后者。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-11-15T20:54:56.327

C++ 模板已被证明是图灵强大的。虽然不是正式的参考，但这里有一个地方可以查看这方面的内容：

[http://cpptruths.blogspot.com/2005/11/c-templates-are-turing-complete.html](http://cpptruths.blogspot.com/2005/11/c-templates-are-turing-complete.html)

我冒昧地猜测一下（就像一个古老而简洁的 CACM 证明表明 60 年代的 ALGOL 不能由 CFG 表示）并说 C++ 因此不能仅由 CFG 正确解析。CFG 与树传递或归约事件期间的各种 TP 机制相结合——这是另一回事。一般来说，由于停机问题，存在一些 C++ 程序不能被证明是正确/不正确的，但仍然是正确/不正确的。

{PS- 作为 Meta-S 的作者（上面有几个人提到过）——我可以肯定地说，Thothic 既没有失效，也不是免费提供的软件。也许我已经对这个版本的回复进行了措辞，这样我就不会被删除或投票否决-3。}

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-07-23T16:42:18.010

C++ 不是上下文无关的。我前段时间在编译器讲座中学到了它。快速搜索给出了这个链接，其中“语法或语义”部分解释了为什么 C 和 C++ 不是上下文无关的：

[维基百科谈话：上下文无关语法](http://en.wikipedia.org/?title=Talk:Context-free_grammar)

问候，
欧文斯

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-07-23T17:02:05.380

显然，如果您逐字逐句回答这个问题，几乎所有带有标识符的语言都是上下文相关的。

需要知道一个标识符是一个类型名（一个类名、一个由typedef引入的名字、一个typename模板参数）、一个模板名还是一些其他的名字才能正确的使用一些标识符。例如：

```
x = (name)(expression); 
```

如果`name`是类型名称，则为强制转换，如果`name`为函数名称，则为函数调用。另一种情况是所谓的“最令人烦恼的解析”，其中无法区分变量定义和函数声明（有一条规则说它是函数声明）。

这种困难引入了依赖名称的需要`typename`和`template`依赖名称。据我所知，C++ 的其余部分不是上下文敏感的（即可以为它编写一个上下文无关的语法）。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-09-18T11:31:35.407

> Meta-S" 是 Quinn Tyler Jackson 的上下文相关解析引擎。我没有使用它，但他讲述了一个令人印象深刻的故事。查看他在 comp.compilers 中的评论，并查看 rnaparse.com/MetaS%20defined.htm – 艾拉巴克斯特 7 月 25 日 10:42

正确的链接是[解析引擎](http://www.rnaparse.com/engines.htm)

Meta-S 是一家名为 Thothic 的已倒闭公司的财产。我可以将 Meta-S 的免费副本发送给任何感兴趣的人，并且我已经在 rna 解析研究中使用了它。请注意，示例文件夹中包含的“伪结语法”是由非生物信息学的业余程序员编写的，基本上不起作用。我的语法采用了不同的方法并且效果很好。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-07-29T16:34:11.667

这里的一个大问题是“上下文无关”和“上下文敏感”这两个术语在计算机科学中有点不直观。对于 C++，上下文敏感性看起来很像模棱两可，但在一般情况下不一定如此。

在 C/++ 中，if 语句只允许在函数体内使用。这似乎使它与上下文相关，对吧？嗯，不。上下文无关文法实际上并不需要您可以提取某行代码并确定其是否有效的属性。这实际上并不是上下文无关的意思。它实际上只是一个标签，模糊地暗示着某种与它的声音有关的东西。

现在，如果函数体内的语句根据直接语法祖先之外定义的内容（例如标识符是否描述类型或变量）而被不同地解析`a * b;`，那么它实际上是上下文相关的。这里没有真正的歧义。`a`如果是类型，它将被解析为指针的声明，否则将被解析为乘法。

上下文相关并不一定意味着“难以解析”。C 实际上并不难，因为臭名昭著的`a * b;`“歧义”可以用`typedef`之前遇到的包含 s 的符号表来解决。它不需要任何任意模板实例化（已被证明是图灵完备的）来解决这种情况，就像 C++ 有时所做的那样。实际上不可能编写一个不会在有限时间内编译的 C 程序，即使它具有与 C++ 相同的上下文敏感性。

Python（和其他对空格敏感的语言）也是上下文相关的，因为它需要词法分析器中的状态来生成缩进和缩进标记，但这并不比典型的 LL-1 语法更难解析。它实际上使用了解析器生成器，这也是 Python 具有如此无信息语法错误消息的部分原因。这里还需要注意的是，没有像`a * b;`Python 中的问题那样的“歧义”，给出了一个没有“歧义”语法的上下文相关语言的一个很好的具体示例（如第一段所述）。

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2016-05-29T04:37:12.740

[这个答案说 C++ 不是上下文无关的......](https://stackoverflow.com/a/14589567/120163)有一个暗示（不是回答者）它无法被解析，并且答案提供了一个困难的代码示例，如果某个常量不是一个，它会产生一个无效的 C++ 程序素数。

正如其他人所观察到的，关于*语言*是否是上下文相关/自由的问题与关于特定语法的相同问题不同。

为了解决关于可解析性的问题，我提供了经验证据，证明 C++ 存在上下文无关文法，可用于生成 AST，以通过实际上用现有 GLR 解析源文本来对源文本进行无上下文解析- 由显式语法驱动的基于解析器的工具。

是的，它通过“接受太多”而成功；并非它接受的所有内容都是有效的 C++ 程序，这就是为什么它会进行额外的检查（类型检查）。是的，类型检查器可能会遇到可计算性问题。在实践中工具没有这个问题；如果人们编写这样的程序，他们都不会编译。（我认为该标准实际上限制了展开模板的计算量，因此实际上计算量实际上是有限的，但可能相当大）。

如果您的意思是，*确定源程序是否是一组有效的 C++ 源程序的成员*，那么我同意这个问题要困难得多。但问题不是*解析*。

该工具通过将解析与对已解析程序的类型检查隔离开来解决此问题。（如果在没有上下文的情况下有多种解释，它会在解析树中记录一个*歧义*节点，并带有几个可能的解析；类型检查决定哪一个是正确的并消除无效的子树）。您可以在下面的示例中看到（部分）解析树；整棵树太大而无法放入 SO 答案中。请注意，无论使用值 234797 还是 234799，您都会得到一个解析树。

使用原始值 234799 在 AST 上运行工具的名称/类型解析器成功。使用值 234797 名称解析器失败（如预期）并显示错误消息“typen 不是类型”。因此该版本不是有效的 C++ 程序。

```
967 tree nodes in tree.
15 ambiguity nodes in tree.
(translation_unit@Cpp~GCC5=2#6b11a20^0 Line 1 Column 1 File C:/temp/prime_with_templates.cpp
 (declaration_seq@Cpp~GCC5=1021#6b06640^1#6b11a20:1 {10} Line 1 Column 1 File C:/temp/prime_with_templates.cpp
  (pp_declaration_seq@Cpp~GCC5=1022#6b049a0^1#6b06640:1 Line 1 Column 1 File C:/temp/prime_with_templates.cpp
   (declaration@Cpp~GCC5=1036#6b04980^1#6b049a0:1 Line 1 Column 1 File C:/temp/prime_with_templates.cpp
   |(template_declaration@Cpp~GCC5=2079#6b04960^1#6b04980:1 Line 1 Column 1 File C:/temp/prime_with_templates.cpp
   | (template_parameter_list@Cpp~GCC5=2082#6afbde0^1#6b04960:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |  (template_parameter@Cpp~GCC5=2085#6afbd80^1#6afbde0:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |   (parameter_declaration@Cpp~GCC5=1611#6afbd40^1#6afbd80:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |   |(basic_decl_specifier_seq@Cpp~GCC5=1070#6afb880^1#6afbd40:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |   | (decl_specifier@Cpp~GCC5=1073#6afb840^1#6afb880:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |   |  (trailing_type_specifier@Cpp~GCC5=1118#6afb7e0^1#6afb840:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp
   |   |   (simple_type_specifier@Cpp~GCC5=1138#6afb7a0^1#6afb7e0:1 Line 1 Column 10 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |  )trailing_type_specifier#6afb7e0
   |   | )decl_specifier#6afb840
   |   |)basic_decl_specifier_seq#6afb880
   |   |(ptr_declarator@Cpp~GCC5=1417#6afbc40^1#6afbd40:2 Line 1 Column 15 File C:/temp/prime_with_templates.cpp
   |   | (noptr_declarator@Cpp~GCC5=1421#6afbba0^1#6afbc40:1 Line 1 Column 15 File C:/temp/prime_with_templates.cpp
   |   |  (declarator_id@Cpp~GCC5=1487#6afbb80^1#6afbba0:1 Line 1 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   (id_expression@Cpp~GCC5=317#6afbaa0^1#6afbb80:1 Line 1 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   |(unqualified_id@Cpp~GCC5=319#6afb9c0^1#6afbaa0:1 Line 1 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   | (IDENTIFIER@Cpp~GCC5=3368#6afb780^1#6afb9c0:1[`V'] Line 1 Column 15 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |)unqualified_id#6afb9c0
   |   |   )id_expression#6afbaa0
   |   |  )declarator_id#6afbb80
   |   | )noptr_declarator#6afbba0
   |   |)ptr_declarator#6afbc40
   |   )parameter_declaration#6afbd40
   |  )template_parameter#6afbd80
   | )template_parameter_list#6afbde0
   | (declaration@Cpp~GCC5=1033#6b04940^1#6b04960:2 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |  (block_declaration@Cpp~GCC5=1050#6b04920^1#6b04940:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   (simple_declaration@Cpp~GCC5=1060#6b04900^1#6b04920:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   |(basic_decl_specifier_seq@Cpp~GCC5=1070#6b048e0^1#6b04900:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   | (decl_specifier@Cpp~GCC5=1073#6b048c0^1#6b048e0:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   |  (type_specifier@Cpp~GCC5=1110#6b048a0^1#6b048c0:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   |   (class_specifier@Cpp~GCC5=1761#6b04880^1#6b048a0:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   |   |(class_head@Cpp~GCC5=1763#6afb980^1#6b04880:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp
   |   |   | (class_key@Cpp~GCC5=1791#6afbca0^1#6afb980:1 Line 1 Column 18 File C:/temp/prime_with_templates.cpp)class_key
   |   |   | (IDENTIFIER@Cpp~GCC5=3368#6afbcc0^1#6afb980:2[`answer'] Line 1 Column 25 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   | (optional_base_clause@Cpp~GCC5=1872#6afba60^1#6afb980:3 Line 1 Column 32 File C:/temp/prime_with_templates.cpp)optional_base_clause
   |   |   |)class_head#6afb980
   |   |   |(member_specification@Cpp~GCC5=1794#6b042e0^1#6b04880:2 {2} Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   | (member_declaration_or_access_specifier@Cpp~GCC5=1806#6b04060^1#6b042e0:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |  (member_declaration@Cpp~GCC5=1822#6b04040^1#6b04060:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   (function_definition@Cpp~GCC5=1632#6b04020^1#6b04040:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |(function_head@Cpp~GCC5=1673#6afbec0^1#6b04020:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   | (ptr_declarator@Cpp~GCC5=1417#6afbfe0^1#6afbec0:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |  (noptr_declarator@Cpp~GCC5=1422#6afbf80^1#6afbfe0:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |   (noptr_declarator@Cpp~GCC5=1421#6afbf60^1#6afbf80:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |(declarator_id@Cpp~GCC5=1487#6afbea0^1#6afbf60:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |   | (id_expression@Cpp~GCC5=317#6afbb40^1#6afbea0:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |  (unqualified_id@Cpp~GCC5=319#6afbc80^1#6afbb40:1 Line 1 Column 34 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   (IDENTIFIER@Cpp~GCC5=3368#6afbc20^1#6afbc80:1[`answer'] Line 1 Column 34 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |   |   |  )unqualified_id#6afbc80
   |   |   |   |   | )id_expression#6afbb40
   |   |   |   |   |)declarator_id#6afbea0
   |   |   |   |   )noptr_declarator#6afbf60
   |   |   |   |   (parameter_declaration_clause@Cpp~GCC5=1559#6afbd00^1#6afbf80:2 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |(pp_parameter_declaration_list@Cpp~GCC5=1570#6afb940^1#6afbd00:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   | (pp_parameter_declaration_seq@Cpp~GCC5=1574#6afb800^1#6afb940:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |  (parameter_declaration@Cpp~GCC5=1610#6afb9a0^1#6afb800:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   (basic_decl_specifier_seq@Cpp~GCC5=1070#6afbf40^1#6afb9a0:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |(decl_specifier@Cpp~GCC5=1073#6afbfa0^1#6afbf40:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   | (trailing_type_specifier@Cpp~GCC5=1118#6afbfc0^1#6afbfa0:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |  (simple_type_specifier@Cpp~GCC5=1140#6afb860^1#6afbfc0:1 Line 1 Column 41 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |   |   |   |   | )trailing_type_specifier#6afbfc0
   |   |   |   |   |   |)decl_specifier#6afbfa0
   |   |   |   |   |   )basic_decl_specifier_seq#6afbf40
   |   |   |   |   |  )parameter_declaration#6afb9a0
   |   |   |   |   | )pp_parameter_declaration_seq#6afb800
   |   |   |   |   |)pp_parameter_declaration_list#6afb940
   |   |   |   |   )parameter_declaration_clause#6afbd00
   |   |   |   |   (function_qualifiers@Cpp~GCC5=1438#6afbce0^1#6afbf80:3 Line 1 Column 46 File C:/temp/prime_with_templates.cpp)function_qualifiers
   |   |   |   |  )noptr_declarator#6afbf80
   |   |   |   | )ptr_declarator#6afbfe0
   |   |   |   |)function_head#6afbec0
   |   |   |   |(function_body@Cpp~GCC5=1680#6b04000^1#6b04020:2 Line 1 Column 46 File C:/temp/prime_with_templates.cpp
   |   |   |   | (compound_statement@Cpp~GCC5=888#6afbee0^1#6b04000:1 Line 1 Column 46 File C:/temp/prime_with_templates.cpp)compound_statement
   |   |   |   |)function_body#6b04000
   |   |   |   )function_definition#6b04020
   |   |   |  )member_declaration#6b04040
   |   |   | )member_declaration_or_access_specifier#6b04060
   |   |   | (member_declaration_or_access_specifier@Cpp~GCC5=1806#6b042c0^1#6b042e0:2 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |  (member_declaration@Cpp~GCC5=1822#6b04820^1#6b042c0:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   (function_definition@Cpp~GCC5=1632#6b04280^1#6b04820:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   |(function_head@Cpp~GCC5=1674#6b04220^1#6b04280:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   | (basic_decl_specifier_seq@Cpp~GCC5=1070#6b040e0^1#6b04220:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   |  (decl_specifier@Cpp~GCC5=1073#6b040c0^1#6b040e0:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   |   (trailing_type_specifier@Cpp~GCC5=1118#6b040a0^1#6b040c0:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |(simple_type_specifier@Cpp~GCC5=1138#6b04080^1#6b040a0:1 Line 1 Column 49 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |   |   |   )trailing_type_specifier#6b040a0
   |   |   |   |  )decl_specifier#6b040c0
   |   |   |   | )basic_decl_specifier_seq#6b040e0
   |   |   |   | (ptr_declarator@Cpp~GCC5=1417#6b04200^1#6b04220:2 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |  (noptr_declarator@Cpp~GCC5=1422#6b041e0^1#6b04200:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   (noptr_declarator@Cpp~GCC5=1421#6b041a0^1#6b041e0:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |(declarator_id@Cpp~GCC5=1487#6b04180^1#6b041a0:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   | (id_expression@Cpp~GCC5=317#6b04160^1#6b04180:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |  (unqualified_id@Cpp~GCC5=320#6b04140^1#6b04160:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   (operator_function_id@Cpp~GCC5=2027#6b04120^1#6b04140:1 Line 1 Column 54 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |(operator@Cpp~GCC5=2070#6b04100^1#6b04120:1 Line 1 Column 62 File C:/temp/prime_with_templates.cpp)operator
   |   |   |   |   |   )operator_function_id#6b04120
   |   |   |   |   |  )unqualified_id#6b04140
   |   |   |   |   | )id_expression#6b04160
   |   |   |   |   |)declarator_id#6b04180
   |   |   |   |   )noptr_declarator#6b041a0
   |   |   |   |   (parameter_declaration_clause@Cpp~GCC5=1558#6afba40^1#6b041e0:2 Line 1 Column 65 File C:/temp/prime_with_templates.cpp)parameter_declaration_clause
   |   |   |   |   (function_qualifiers@Cpp~GCC5=1438#6b041c0^1#6b041e0:3 Line 1 Column 66 File C:/temp/prime_with_templates.cpp)function_qualifiers
   |   |   |   |  )noptr_declarator#6b041e0
   |   |   |   | )ptr_declarator#6b04200
   |   |   |   |)function_head#6b04220
   |   |   |   |(function_body@Cpp~GCC5=1680#6b04300^1#6b04280:2 Line 1 Column 66 File C:/temp/prime_with_templates.cpp
   |   |   |   | (compound_statement@Cpp~GCC5=889#6b04760^1#6b04300:1 Line 1 Column 66 File C:/temp/prime_with_templates.cpp
   |   |   |   |  (pp_statement_seq@Cpp~GCC5=894#6b04780^1#6b04760:1 Line 1 Column 67 File C:/temp/prime_with_templates.cpp
   |   |   |   |   (statement@Cpp~GCC5=857#6b04440^1#6b04780:1 Line 1 Column 67 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |(jump_statement@Cpp~GCC5=1011#6afba80^1#6b04440:1 Line 1 Column 67 File C:/temp/prime_with_templates.cpp
   |   |   |   |   | (pm_expression@Cpp~GCC5=551#6b04380^1#6afba80:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |  (cast_expression@Cpp~GCC5=543#6b04360^1#6b04380:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   (unary_expression@Cpp~GCC5=465#6b04340^1#6b04360:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |(primary_expression@Cpp~GCC5=307#6b04320^1#6b04340:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   | (id_expression@Cpp~GCC5=317#6b042a0^1#6b04320:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |  (unqualified_id@Cpp~GCC5=319#6b04260^1#6b042a0:1 Line 1 Column 74 File C:/temp/prime_with_templates.cpp
   |   |   |   |   |   |   (IDENTIFIER@Cpp~GCC5=3368#6b04240^1#6b04260:1[`V'] Line 1 Column 74 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |   |   |   |  )unqualified_id#6b04260
   |   |   |   |   |   | )id_expression#6b042a0
   |   |   |   |   |   |)primary_expression#6b04320
   |   |   |   |   |   )unary_expression#6b04340
   |   |   |   |   |  )cast_expression#6b04360
   |   |   |   |   | )pm_expression#6b04380
   |   |   |   |   |)jump_statement#6afba80
   |   |   |   |   )statement#6b04440
   |   |   |   |  )pp_statement_seq#6b04780
   |   |   |   | )compound_statement#6b04760
   |   |   |   |)function_body#6b04300
   |   |   |   )function_definition#6b04280
   |   |   |  )member_declaration#6b04820
   |   |   | )member_declaration_or_access_specifier#6b042c0
   |   |   |)member_specification#6b042e0
   |   |   )class_specifier#6b04880
   |   |  )type_specifier#6b048a0
   |   | )decl_specifier#6b048c0
   |   |)basic_decl_specifier_seq#6b048e0
   |   )simple_declaration#6b04900
   |  )block_declaration#6b04920
   | )declaration#6b04940
   |)template_declaration#6b04960
   )declaration#6b04980
  )pp_declaration_seq#6b049a0
  (pp_declaration_seq@Cpp~GCC5=1022#6b06620^1#6b06640:2 Line 3 Column 1 File C:/temp/prime_with_templates.cpp
   (declaration@Cpp~GCC5=1036#6b06600^1#6b06620:1 Line 3 Column 1 File C:/temp/prime_with_templates.cpp
   |(template_declaration@Cpp~GCC5=2079#6b065e0^1#6b06600:1 Line 3 Column 1 File C:/temp/prime_with_templates.cpp
   | (template_parameter_list@Cpp~GCC5=2083#6b05460^1#6b065e0:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |  (template_parameter_list@Cpp~GCC5=2083#6b05140^1#6b05460:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   (template_parameter_list@Cpp~GCC5=2083#6b04ee0^1#6b05140:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |(template_parameter_list@Cpp~GCC5=2082#6b04cc0^1#6b04ee0:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   | (template_parameter@Cpp~GCC5=2085#6b04ca0^1#6b04cc0:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |  (parameter_declaration@Cpp~GCC5=1611#6b04c80^1#6b04ca0:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |   (basic_decl_specifier_seq@Cpp~GCC5=1070#6b04a40^1#6b04c80:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |   |(decl_specifier@Cpp~GCC5=1073#6b04a20^1#6b04a40:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |   | (trailing_type_specifier@Cpp~GCC5=1118#6b04a00^1#6b04a20:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp
   |   |   |  (simple_type_specifier@Cpp~GCC5=1138#6b049e0^1#6b04a00:1 Line 3 Column 10 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |   | )trailing_type_specifier#6b04a00
   |   |   |)decl_specifier#6b04a20
   |   |   )basic_decl_specifier_seq#6b04a40
   |   |   (ptr_declarator@Cpp~GCC5=1417#6b04c40^1#6b04c80:2 Line 3 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   |(noptr_declarator@Cpp~GCC5=1421#6b04be0^1#6b04c40:1 Line 3 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   | (declarator_id@Cpp~GCC5=1487#6b04bc0^1#6b04be0:1 Line 3 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   |  (id_expression@Cpp~GCC5=317#6b04b60^1#6b04bc0:1 Line 3 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   |   (unqualified_id@Cpp~GCC5=319#6b04ac0^1#6b04b60:1 Line 3 Column 15 File C:/temp/prime_with_templates.cpp
   |   |   |   |(IDENTIFIER@Cpp~GCC5=3368#6b049c0^1#6b04ac0:1[`no'] Line 3 Column 15 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |   )unqualified_id#6b04ac0
   |   |   |  )id_expression#6b04b60
   |   |   | )declarator_id#6b04bc0
   |   |   |)noptr_declarator#6b04be0
   |   |   )ptr_declarator#6b04c40
   |   |  )parameter_declaration#6b04c80
   |   | )template_parameter#6b04ca0
   |   |)template_parameter_list#6b04cc0
   |   |(template_parameter@Cpp~GCC5=2085#6b04ec0^1#6b04ee0:2 Line 3 Column 19 File C:/temp/prime_with_templates.cpp
   |   | (parameter_declaration@Cpp~GCC5=1611#6b04ea0^1#6b04ec0:1 Line 3 Column 19 File C:/temp/prime_with_templates.cpp
   |   |  (basic_decl_specifier_seq@Cpp~GCC5=1070#6b04b40^1#6b04ea0:1 Line 3 Column 19 File C:/temp/prime_with_templates.cpp
   |   |   (decl_specifier@Cpp~GCC5=1073#6b04ba0^1#6b04b40:1 Line 3 Column 19 File C:/temp/prime_with_templates.cpp
   |   |   |(trailing_type_specifier@Cpp~GCC5=1118#6b04c60^1#6b04ba0:1 Line 3 Column 19 File C:/temp/prime_with_templates.cpp
   |   |   | (simple_type_specifier@Cpp~GCC5=1138#6b04580^1#6b04c60:1 Line 3 Column 19 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |   |)trailing_type_specifier#6b04c60
   |   |   )decl_specifier#6b04ba0
   |   |  )basic_decl_specifier_seq#6b04b40
   |   |  (ptr_declarator@Cpp~GCC5=1417#6b04e60^1#6b04ea0:2 Line 3 Column 24 File C:/temp/prime_with_templates.cpp
   |   |   (noptr_declarator@Cpp~GCC5=1421#6b04e40^1#6b04e60:1 Line 3 Column 24 File C:/temp/prime_with_templates.cpp
   |   |   |(declarator_id@Cpp~GCC5=1487#6b04de0^1#6b04e40:1 Line 3 Column 24 File C:/temp/prime_with_templates.cpp
   |   |   | (id_expression@Cpp~GCC5=317#6b04d80^1#6b04de0:1 Line 3 Column 24 File C:/temp/prime_with_templates.cpp
   |   |   |  (unqualified_id@Cpp~GCC5=319#6b04ce0^1#6b04d80:1 Line 3 Column 24 File C:/temp/prime_with_templates.cpp
   |   |   |   (IDENTIFIER@Cpp~GCC5=3368#6b04560^1#6b04ce0:1[`yes'] Line 3 Column 24 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |  )unqualified_id#6b04ce0
   |   |   | )id_expression#6b04d80
   |   |   |)declarator_id#6b04de0
   |   |   )noptr_declarator#6b04e40
   |   |  )ptr_declarator#6b04e60
   |   | )parameter_declaration#6b04ea0
   |   |)template_parameter#6b04ec0
   |   )template_parameter_list#6b04ee0
   |   (template_parameter@Cpp~GCC5=2085#6b05120^1#6b05140:2 Line 3 Column 29 File C:/temp/prime_with_templates.cpp
   |   |(parameter_declaration@Cpp~GCC5=1611#6b05100^1#6b05120:1 Line 3 Column 29 File C:/temp/prime_with_templates.cpp
   |   | (basic_decl_specifier_seq@Cpp~GCC5=1070#6b04d20^1#6b05100:1 Line 3 Column 29 File C:/temp/prime_with_templates.cpp
   |   |  (decl_specifier@Cpp~GCC5=1073#6b04dc0^1#6b04d20:1 Line 3 Column 29 File C:/temp/prime_with_templates.cpp
   |   |   (trailing_type_specifier@Cpp~GCC5=1118#6b04e80^1#6b04dc0:1 Line 3 Column 29 File C:/temp/prime_with_templates.cpp
   |   |   |(simple_type_specifier@Cpp~GCC5=1140#6b046e0^1#6b04e80:1 Line 3 Column 29 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |   )trailing_type_specifier#6b04e80
   |   |  )decl_specifier#6b04dc0
   |   | )basic_decl_specifier_seq#6b04d20
   |   | (ptr_declarator@Cpp~GCC5=1417#6b05080^1#6b05100:2 Line 3 Column 33 File C:/temp/prime_with_templates.cpp
   |   |  (noptr_declarator@Cpp~GCC5=1421#6b05020^1#6b05080:1 Line 3 Column 33 File C:/temp/prime_with_templates.cpp
   |   |   (declarator_id@Cpp~GCC5=1487#6b05000^1#6b05020:1 Line 3 Column 33 File C:/temp/prime_with_templates.cpp
   |   |   |(id_expression@Cpp~GCC5=317#6b04fa0^1#6b05000:1 Line 3 Column 33 File C:/temp/prime_with_templates.cpp
   |   |   | (unqualified_id@Cpp~GCC5=319#6b04f00^1#6b04fa0:1 Line 3 Column 33 File C:/temp/prime_with_templates.cpp
   |   |   |  (IDENTIFIER@Cpp~GCC5=3368#6b046c0^1#6b04f00:1[`f'] Line 3 Column 33 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   | )unqualified_id#6b04f00
   |   |   |)id_expression#6b04fa0
   |   |   )declarator_id#6b05000
   |   |  )noptr_declarator#6b05020
   |   | )ptr_declarator#6b05080
   |   |)parameter_declaration#6b05100
   |   )template_parameter#6b05120
   |  )template_parameter_list#6b05140
   |  (template_parameter@Cpp~GCC5=2085#6b05440^1#6b05460:2 Line 3 Column 36 File C:/temp/prime_with_templates.cpp
   |   (parameter_declaration@Cpp~GCC5=1611#6b05420^1#6b05440:1 Line 3 Column 36 File C:/temp/prime_with_templates.cpp
   |   |(basic_decl_specifier_seq@Cpp~GCC5=1070#6b05160^1#6b05420:1 Line 3 Column 36 File C:/temp/prime_with_templates.cpp
   |   | (decl_specifier@Cpp~GCC5=1073#6b04fe0^1#6b05160:1 Line 3 Column 36 File C:/temp/prime_with_templates.cpp
   |   |  (trailing_type_specifier@Cpp~GCC5=1118#6b050e0^1#6b04fe0:1 Line 3 Column 36 File C:/temp/prime_with_templates.cpp
   |   |   (simple_type_specifier@Cpp~GCC5=1140#6b050c0^1#6b050e0:1 Line 3 Column 36 File C:/temp/prime_with_templates.cpp)simple_type_specifier
   |   |  )trailing_type_specifier#6b050e0
   |   | )decl_specifier#6b04fe0
   |   |)basic_decl_specifier_seq#6b05160
   |   |(ptr_declarator@Cpp~GCC5=1417#6b053e0^1#6b05420:2 Line 3 Column 40 File C:/temp/prime_with_templates.cpp
   |   | (noptr_declarator@Cpp~GCC5=1421#6b053c0^1#6b053e0:1 Line 3 Column 40 File C:/temp/prime_with_templates.cpp
   |   |  (declarator_id@Cpp~GCC5=1487#6b05360^1#6b053c0:1 Line 3 Column 40 File C:/temp/prime_with_templates.cpp
   |   |   (id_expression@Cpp~GCC5=317#6b05280^1#6b05360:1 Line 3 Column 40 File C:/temp/prime_with_templates.cpp
   |   |   |(unqualified_id@Cpp~GCC5=319#6b051a0^1#6b05280:1 Line 3 Column 40 File C:/temp/prime_with_templates.cpp
   |   |   | (IDENTIFIER@Cpp~GCC5=3368#6b046a0^1#6b051a0:1[`p'] Line 3 Column 40 File C:/temp/prime_with_templates.cpp)IDENTIFIER
   |   |   |)unqualified_id#6b051a0
   |   |   )id_expression#6b05280
   |   |  )declarator_id#6b05360
   |   | )noptr_declarator#6b053c0
   |   |)ptr_declarator#6b053e0
   |   )parameter_declaration#6b05420
   |  )template_parameter#6b05440
   | )template_parameter_list#6b05460 
```

# javascript - jsPlumb/JQuery 如何定位任意数量的节点？

> ID：14589347
> 
> 赞同：1
> 
> 时间：2013-01-29T18:05:58.790
> 
> 标签：javascript, jquery, jsplumb

我正在尝试实现周边锚点，我终于达到了我的所有节点都在它们的形状内，按照它们应该的方式连接，而不是重叠，但我找不到如何在页面上更好地分散它们。

我有 2 组节点，第 1 组中的每个节点都连接到第 2 组中的所有相关节点。所有节点依次出现，连接相互重叠。我正在尝试关注[github 上的演示](https://github.com/sporritt/jsPlumb/tree/master/demo)，我看到每个节点都有额外的样式属性，将其定位在页面上的某个位置，我找不到如何、在何处或添加此属性的内容。

如何以一种很好的方式分散节点，使它们不会相互重叠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:44:15.250

这个库可能会有所帮助：[https ://github.com/lndb/jsPlumb_Liviz.js](https://github.com/lndb/jsPlumb_Liviz.js)

> 连接元素的 jsPlumb 库与 Liviz.js 的组合，用于定位这些元素。
> 
> 换句话说：使用 jsPlumb 进行 UI（连接 div），使用 Liviz.js 定位这些元素（div）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T21:18:42.233

我以前从未使用过这个库，但通过查看 API 文档。

尝试将 设置`anchorCount`为较小的值，默认为`60`。

```
[ "Perimeter", {
      shape:$(shapes[i]).attr("data-shape"),
      rotation:$(shapes[i]).attr("data-rotation"),
      anchorCount: 30 }] 
```

这样，锚将在形状上更加分散。

您还可以查看[StateMachine Connector](http://www.jsplumb.org/apidocs/files/jquery-jsPlumb-1-3-16-all-js.html#Connectors.StateMachine)，它似乎有一个`proximity`option 和 a `curviness`，可能两者都可以帮助您避免冲突。

我希望我理解你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T16:59:40.490

好的，经过长时间的敲打我的头在墙上，我终于明白了。它不是完美的，也不是很好，但基本上它做了我想要的，即：放置任意数量的节点，它们相互重叠。

首先，jsPlumb 不定位节点，它把它留给你，它只是连接它们。因此，在运行 jsPlumb.connect() 之前，我必须使用 js 和 css 分散节点。

这是代码：

CSS：

```
.group1, .group2 {
    z-index:6;
    opacity:0.7;
    filter:alpha(opacity=70);
    position:absolute;
    cursor:pointer;
    text-align:center;
    color:#333;
}

[data-shape=ellipse] {
    width:210px;
    height:70px;
    left:250px;
    top:300px;
    line-height: 70px;
    background-image:url(../img/ellipse.png);
}

[data-shape=circle] {
    width:70px;
    height:70px;
    left:100px;
    top:60px;
    line-height: 60px;
    background-image:url(../img/circle.png);
}

#chart {
    width:80%;
    height:50em;
    margin-left:3em;
    margin-top:3em;
    position:relative;
} 
```

JS：

```
function random_width() {
    return Math.floor(Math.random() * (900 - 200) + 200);
}

function random_height() {
    return Math.floor(Math.random() * (700 - 200) + 200);
}

function overlap (el1, el2) {
    var x1 = $(el1).offset().left;
    var x2 = x1 + $(el1).width();
    var y1 = $(el1).offset().top;
    var y2 = y1 + $(el1).height();

    var x3 = $(el2).offset().left;
    var x4 = $(el2).width() + x3;
    var y3 = $(el2).offset().top;
    var y4 = $(el2).height() + y3;

    if (x3 > x3 || x4 < x1) { return false; } //overlap not possible
    if (y3 > y2 || y4 < y1) { return false; } //overlap not possible

    if (x3 > x1 && x3 < x2) { return true; }
    if (x4 > x1 && x4 < x2) { return true; }

    if (y3 > y1 && y3 < y2) { return true; }
    if (y4 > y1 && y4 < y2) { return true; }
}

function change_position(el) {
    $(el).css({'left': random_width(), 'top': random_height()});
}

function have_overlap(els) {
    for (var k = 0; k < els.length; k++) {
        for (var t = 0; t < els.length; t++){
            if (k !== t && overlap(els[k], els[t])){
                return true;
            }
        }
    }

    return false;
}

function disperse() {
    var group1 = $('.group1');
    var group2 = $('group2');
    var divs = $.merge(group1, group2);
    var set = [];

    console.log('dispersing');
    for (var i = 0; i < divs.length; i++) {
        set.push(divs[i]);
        change_position(divs[i]);
        while (have_overlap(set)) {
            change_position(divs[i]);
        }
    }
} 
```

它正在做的是：

1.  获取我要使用的所有节点。
2.  放置第一个节点，将其保存在`set`数组中。
3.  放置下一个节点，将其添加到`set`并检查它是否与`set`数组中的其他节点重叠，如果重叠，请保持移动。

当所有节点分散时，我运行 jsPlumb.connect()，瞧，它们都是连接的。我对这里的效率并不感到满意，它需要时间才能完成。如果有人对如何改进它有任何建议，我很想听听。

# javascript - 骨干形式。Node.js 文档示例：Onchange Populator：如何隐藏第二个选择并在更改事件后显示它？

> ID：14589352
> 
> 赞同：2
> 
> 时间：2013-01-29T18:06:22.307
> 
> 标签：javascript, backbone.js, backbone-forms

这是我想从中学习的文档中的代码。在我看来，当更改事件被触发时，隐藏第二个选择并显示它会很酷。我尝试了一些功能注入，但效果不佳。谁能给这个问题2美分？

```
(function($) {
    var cities = {
        'UK': ['London', 'Manchester', 'Brighton', 'Bristol'],
        'USA': ['Washington DC', 'Los Angeles', 'Austin', 'New York']
    };

    //The form
    var form1 = new Backbone.Form({
        schema: {
            country: { type: 'Select', options: ['UK', 'USA'] },
            city: { type: 'Select', options: cities.UK },
            message: { type: 'Text'}
        }
    }).render();

    form1.on('country:change', function(form1, countryEditor) {
        var country = countryEditor.getValue(),
            newOptions = cities[country];
            form1.fields.city.editor.setOptions(newOptions);

    });

    //Add it to the page
    $('body').append(form1.el);
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T20:25:37.987

**form1.fields['message'].$el.hide();**

渲染后和

**form1.fields['message'].$el.toggle();** 在 on change 函数里面解决了这个问题。

```
(function($) {
    var cities = {
        'UK': ['London', 'Manchester', 'Brighton', 'Bristol'],
        'USA': ['Washington DC', 'Los Angeles', 'Austin', 'New York']
    };

    //The form
    var form1 = new Backbone.Form({
        schema: {
            country: { type: 'Select', options: ['UK', 'USA'] },
            city: { type: 'Select', options: cities.UK },
            message: {  
                //fieldAttrs: { style: 'width: 400px; height:300px;' }, 
                type: 'TextArea',
                fieldClass: 'message-input', 
                validators: [ 'required', /.{20,}/ ] 
            }
        }
    }).render();
    **form1.fields['message'].$el.hide();**

    *form1.on('country:change',* function(form1, countryEditor) {
        var country = countryEditor.getValue(),
            newOptions = cities[country];
            form1.fields.city.editor.setOptions(newOptions);
            **form1.fields['message'].$el.toggle();**
    });

    //Add it to the page
    $('body').append(form1.el);
})(jQuery); 
```

# r - 与整数斗争（最大整数大小）

> ID：14589354
> 
> 赞同：33
> 
> 时间：2013-01-29T18:06:29.067
> 
> 标签：r

我正在使用一个需要输入为整数的函数。

所以我一直在尝试[阅读有关制作整数的内容](http://www.r-tutor.com/r-introduction/basic-data-types/integer)：

```
y <- 3.14
as.integer(y)
[1] 3              # all cool 
```

一切都好，但如果我有

```
 x <- 1639195531833
 as.integer(x)
 [1] NA
 Warning message:
 NAs introduced by coercion 
```

我`options(digits = 15)`坚持了下来，这让我感到困惑，为什么它不起作用，但在干净的会话中，它一定与科学记数法有关。

我也试图欺骗 R，但它并不高兴：

```
 as.integer(as.character(x))
[1] 2147483647
Warning message:
inaccurate integer conversion in coercion 
```

我如何打败科学记数法并获得我的整数？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-29T18:10:24.107

R能容纳的最大整数是

```
.Machine$integer.max
# [1] 2147483647 
```

这与科学记数法无关，与计算机实际存储数字的方式有关。无论架构如何，当前版本的 R 仍将整数存储为 32 位。不过，这可能会在未来发生变化。

也可以看看`?as.integer`

目前您可以通过 int64 包访问 64 位整数

```
> as.integer(.Machine$integer.max)
[1] 2147483647
> # We get problems with this
> as.integer(.Machine$integer.max + 1)
[1] NA
Warning message:
NAs introduced by coercion 
> # But if we use int64
> library(int64)
> as.int64(.Machine$integer.max) + 1L
[1] 2147483648 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-05-22T16:34:20.637

更新 Dason 的答案（没有足够的声誉发表评论）：

int64 包现已弃用，但现在有一个名为 bit64 的包。我能够使用它达到相同的结果。语法从“as.int64”到“as.integer64”仅略有变化。

IE

```
library(bit64)
as.integer64(.Machine$integer.max) + 1L 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-06T08:24:35.063

似乎 int64 已被弃用。我使用包bit64，方法`as.integer64()`并解决了问题。详情参考[这里](https://cran.r-project.org/web/packages/bit64/bit64.pdf)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-29T18:14:41.880

有些类可以处理大整数。我使用 int64，它的小插图在这里：

[http://cran.r-project.org/web/packages/int64/vignettes/int64.pdf](http://cran.r-project.org/web/packages/int64/vignettes/int64.pdf)

要使用它，您只需将一些正常数字放入该类中，然后您可以将它添加或乘以正常 32 位整数最大值的阈值。祝你好运。

# ios - 从动态表格单元链接到特定的视图控制器

> ID：14589357
> 
> 赞同：1
> 
> 时间：2013-01-29T18:06:37.340
> 
> 标签：ios, uiviewcontroller, uitableview, uisearchbar

我正在尝试从动态表视图单元（作为搜索结果表的一部分）链接到特定的视图控制器

到目前为止我实现的代码是：

SearchViewController.h

```
import <UIKit/UIKit.h>

@interface SearchViewController : UITableViewController <UISearchDisplayDelegate, UISearchDisplayDelegate>
@property (strong,nonatomic) NSArray *sysTArray;
@property (strong,nonatomic) NSMutableArray *filteredsysTArry;
@property IBOutlet UISearchBar *sysTSearchBar;
@end 
```

搜索视图控制器.M

```
#import "SearchViewController.h"
#import "sysT.h"

@interface SearchViewController ()

@end

@implementation SearchViewController

@synthesize sysTArray;
@synthesize filteredsysTArry;
@synthesize sysTSearchBar;

- (id)initWithStyle:(UITableViewStyle)style
{
self = [super initWithStyle:style];
if (self) {
// Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];

sysTArray = [NSArray arrayWithObjects:
                [sysT sysTOfCategory:@"p" name:@"H1"],
                [sysT sysTOfCategory:@"p" name:@"W2"],
                [sysT sysTOfCategory:@"p" name:@"W3"],
                [sysT sysTtOfCategory:@"p" name:@"C4"],
                [sysT sysTOfCategory:@"c" name:@"O5"],
                [sysT sysTOfCategory:@"c" name:@"C6"],
                [sysT sysTOfCategory:@"a" name:@"L7"], nil];

self.filteredSysTArry = [NSMutableArray arrayWithCapacity:[sysTArray count]];

[self.tableView reloadData];

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section

{

if (tableView == self.searchDisplayController.searchResultsTableView) {
return [filteredsysTArry count];
}else{
return [sysTArray count];
}
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];

}     

 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:      (NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if ( cell == nil) {
cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault   reuseIdentifier:CellIdentifier];
}

SysT *sysT = nil;

if (tableView == self.searchDisplayController.searchResultsTableView) {
sysT = [filteredsysTArry objectAtIndex:indexPath.row];
}else{
sysT = [sysTArray objectAtIndex:indexPath.row];
}

cell.textLabel.text = sysT.name;
[cell setAccessoryType:UITableViewCellAccessoryDisclosureIndicator];
return cell;

}

#pragma mark Search Filtering

-(void)filterContentForSearchText:(NSString*) searchText scope:(NSString*)scope {
[self.filteredSysTArry removeAllObjects];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.name contains[c] %@",    searchText];
filteredSysTArry = [NSMutableArray arrayWithArray:[sysTArray   filteredArrayUsingPredicate:predicate]];

}

#pragma mark - UISearchDisplayController Delegate Methods
-(BOOL)searchDisplayController:(UISearchDisplayController *)controller     shouldReloadTableForSearchString:(NSString *)searchString {
[self filterContentForSearchText:searchString scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:    [self.searchDisplayController.searchBar selectedScopeButtonIndex]]];
return YES;
}

-(BOOL) searchDisplayController:(UISearchDisplayController *)controller  shouldReloadTableForSearchScope:(NSInteger)searchOption {
[self filterContentForSearchText:self.searchDisplayController.searchBar.text scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles]   objectAtIndex:searchOption]];
 return YES;}

@end 
```

如何根据动态单元格内的数据启动特定的视图控制器？

更详细地说，如果用户搜索 H1，然后单击该动态单元格，我将如何显示相关的 H1 视图控制器？

正如您可能从我非常粗略的代码中看出的那样，我正处于陡峭的学习曲线上。如果你能把你的答案尽可能地作为婴儿证明，那就太棒了，真的会帮助我。（另外，我正在使用故事板）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:13:25.403

您需要实现 tableView:didSelectRowAtIndexPath: 当您选择一行时调用它。您可以通过使用传递给该方法的 indexPath 查询数据源来获取该行的数据。然后，您可以使用所需的任何逻辑来选择接下来要转到哪个视图控制器。您可以通过调用 performSegueWithIdentifier 来做到这一点。

# haskell - 找不到模块“Yesod”

> ID：14589358
> 
> 赞同：3
> 
> 时间：2013-01-29T18:06:42.137
> 
> 标签：haskell, yesod

我有以下代码：

```
{-# LANGUAGE TypeFamilies, QuasiQuotes, MultiParamTypeClasses,
             TemplateHaskell, OverloadedStrings #-}

module Simple where
import Yesod
data HelloWorld = HelloWorld

mkYesod "HelloWorld" [parseRoutes|
/ HomeR GET
|]

instance Yesod HelloWorld

getHomeR = defaultLayout [whamlet|Hello World!|]

withHelloWorld  f = toWaiApp HelloWorld >>= f

main = warpDebug 3000 HelloWorld 
```

如果在 GHCI 中运行，则正常运行：

```
Ok, modules loaded: Simple.
*Simple> main
Application launched, listening on port 3000 
```

但是如果运行它：

```
wai-handler-devel 3000 Simple withHelloWorld 
```

控制台报错：

```
pshuvaev@pshuvaev-K73SV:~/works/haskell/yesod/SimpleSite$ wai-handler-devel 3000 Simple.hs withHelloWorld
Attempting to interpret your app...
Compile failed: 

Could not find module `Yesod'
Use -v to see a list of the files searched for. 
```

可能是什么问题呢？Yesod 已设置并显示在 的输出中`ghc-pkg list`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-14T21:06:39.877

在 Unix 系统上删除`~/.ghc`目录并运行：

```
ghc-pkg --global recache 
```

`C:\Users\USERNAME\AppData\Roaming\ghc`在 Windows 系统上（只是建议）从命令行删除并重新缓存（作为管理员）：

```
ghc-pkg --global recache 
```

**不确定Windows！**请检查！

# autofixture - AutoFixture : 将参数传递给样本生成器

> ID：14589360
> 
> 赞同：6
> 
> 时间：2013-01-29T18:06:47.520
> 
> 标签：autofixture

（我没有找到这样做的方法，从源代码看来它不受支持，但我可能忽略了它）

我想做类似的事情：

```
(new Fixture())
    .CreateAnonymous<Circle>(
        new CircleSpecification { MinRadius = 1, MaxRadius = 5 }
    ); 
```

所以这是 AutoFixture 中已经存在的类似种子习语的变体，但种子习语是非常硬编码的（或者我认为如此）。

**问题**：是否可以自定义夹具以接受样本的参数？

到目前为止，我最好的想法是构建一个包含结果对象的特殊规范类，以便您可以执行以下操作：

```
public class CircleSpecification {
    public double MinRadius { get; set; }
    public double MaxRadius { get; set; }

    public Circle Circle { get; set; }
} 
```

这样我就可以注册`CircleSpecificationSpecimenBuilder`可以使用的：

```
Circle circle = Fixture.CreateAnonymous<CircleSpecification>(
    new CircleSpecification { MinRadius = 0.0, MaxRadius = 5.0 }).Circle; 
```

请注意，要使用带有种子重载的 CreateAnonymous 种子参数类型必须匹配方法返回类型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T06:53:18.220

如果要在创建匿名实例时分配值，`Circle`可以使用以下`Build`方法：

```
var fixture = new Fixture();
var c = fixture
    .Build<Circle>()
    .With(x => x.Radius, 3)
    .CreateAnonymous(); 
```

但是，如果该属性没有什么特别之处`Radius`，为什么不干脆事后给它赋值呢？

```
var fixture = new Fixture();
var c = fixture.CreateAnonymous<Circle>();
c.Radius = 3; 
```

后一个选项更具声明性，使您能够使用[AutoFixture 的 xUnit.net 集成](http://blog.ploeh.dk/2010/10/08/AutoDataTheoriesWithAutoFixture.aspx)来编写更简洁的测试，从而消除所有意外的复杂性：

```
[Theory, AutoData]
public void Test3(Circle c)
{
    c.Radius = 3;

    // Act and assert here
} 
```

# c# - 如何在不刷新页面的情况下获取 cookie 值

> ID：14589361
> 
> 赞同：1
> 
> 时间：2013-01-29T18:06:57.073
> 
> 标签：c#, httpcookie

我在用户控件 [A] 中设置 cookie 值并读取另一个用户控件 [B] 中的值。

但是该值仅在服务器端的页面刷新时可用。我可以在 firebug cookie 选项卡中看到更新的值。

如果我引用页面，则正确的值正在页面中显示。

如何解决这个问题？下面是我用来读取用户控件 [B] 中的 cookie 的代码。它始终是旧值而不是我在 usercontrol[A] 中设置的新值

```
 HttpCookie cookieTool = Request.Cookies["previousTool"];

    string strSessionReturnToolTitle = "";
    string strSessionReturnToolURL = "";

    if (cookieTool != null)
    {
     //   Response.Write("<BR>Cookie value  " + cookieTool["returnToolurl"].ToString());
        if (Request.UrlReferrer == null)
        {
            cookieTool.Expires = DateTime.Now.AddDays(-1d);
            Response.Cookies.Add(cookieTool);
        }
        else
        {

            strSessionReturnToolTitle = cookieTool["returnTooltitle"];
            strSessionReturnToolURL = Server.UrlDecode(cookieTool["returnToolurl"]);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:13:11.303

`Request.Cookies`即将到来。`Response.Cookies`正在传出。

`Request.Cookies`只知道当前请求。当您通过 Response.Cookies 添加时，我认为它不会更新，直到以下请求。

`Response.Cookies["previousTool"]`如果`Request.Cookies["previousTool"]`为空，您可以尝试通过获取 cookie 。

如果这不起作用，您将需要另一种方法，例如将值存储在 Session 或`HttpContext.Current.Items`.

# python - 使用外键创建多个对象

> ID：14589362
> 
> 赞同：12
> 
> 时间：2013-01-29T18:07:03.440
> 
> 标签：python, django, factory-boy

我需要创建 10 个示例用户 ( `User`)，每个用户必须有 50 个文档 ( `Doc`)。如何使用 factoryboy 在 tests.py 中执行此操作？

```
#factories.py

from app_name.models import *
import factory
from datetime import datetime, timedelta, time
from django.contrib.auth.models import User

class UserFactory(factory.Factory):
    FACTORY_FOR = User

    username = factory.Sequence(lambda n: 'User ' + n)
    email = 'demo@mail.com'
    password = '1234567'

class DocFactory(factory.Factory):
    FACTORY_FOR = Doc

    user = factory.SubFactory(UserFactory)
    kategories = '1'
    doc_number = '12345678'
    date_join = factory.Sequence(lambda n:(datetime.now() + timedelta(days=n)).date(), int) 
```

在我的tests.py中：

```
from django.test import TestCase
from django_dynamic_fixture import G
from factories import * 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-29T22:48:19.940

```
users = UserFactory.create_batch(10)
for user in users:
    doc = DocFactory.create(user=user) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-12T14:31:47.213

您可以使用`post_generation`装饰器：

```
class UserFactory(factory.Factory):

    ...

    @factory.post_generation
    def create_docs(self, create, extracted, **kwargs):
        if not create:
            return
        for i in range(50):
            doc = DocFactory.create(user=self) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-23T09:54:46.970

您可以简单地执行 batch_create 以便为每个 DocFactory 对象创建新的 UserFactory 对象

```
`DocFactory.create_batch(10)` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-09T16:25:41.153

对于那些使用**SQLAlchemy**的人，这可以通过以下方法完成（*请注意，我使用的是 Person/Address 模型而不是上面的 User/Docs 模型示例*）。

```
from sqlalchemy import create_engine, Integer, Text, ForeignKey, Column
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import relationship, scoped_session, sessionmaker

import factory
from factory.alchemy import SQLAlchemyModelFactory as sqla_factory
import random

engine = create_engine("sqlite:////tmp/factory_boy.sql")
session = scoped_session(sessionmaker(bind=engine))
Base = declarative_base()

class Person(Base):
    id = Column(Integer, primary_key=True)
    name = Column(Text)
    addresses = relationship("Address", backref="person")

class Address(Base):
    id = Column(Integer, primary_key=True)
    city = Column(Text)
    street = Column(Text)
    street_number = Column(Integer)
    person_id = Column(Integer, ForeignKey('person.id'))

class AddressFactory(sqla_factory):
    class Meta:
        model = Address
        sqlalchemy_session = session
    street_number = random.randint(0, 10000)
    street = "Commonwealth Ave"
    city = "Boston"

class PersonFactory(sqla_factory):
    class Meta:
        model = Person
        sqlalchemy_session = session
    name = "John Doe"

Base.metadata.create_all(engine)
for i in range(100):
    person = PersonFactory(addresses=AddressFactory.create_batch(3)) 
```

这将为创建的每个人创建 3 个锻炼，其中每个锻炼通过`person_id`FK 引用该人。

# objective-c - 在 Objective C 中构建 USB 树

> ID：14589365
> 
> 赞同：1
> 
> 时间：2013-01-29T18:07:31.807
> 
> 标签：objective-c, tree, usb

我正在尝试构建一棵树来存储 USB 设备信息。我以为我会使用 NSMutableArray 和 NSMutableDictionary 来包含这些信息。我的问题是我从来没有学过软件工程——我边走边学——而且我对树理论一无所知。
我的树基于 USB 位置 ID，它有 8 个半字节长。据我了解，每个半字节代表树的一层（如果您明白我的意思）。我已经编写了一些测试代码，看看我是否可以正确地构建我的树 - 遗憾的是，我似乎做不到！

```
#import <Foundation/Foundation.h>

#define MAXCHILDREN 0xf

NSDictionary* AddItemToTree(NSDictionary* nodeEntry, unsigned int value, int depth)
{
    // Convert the value into a set of nibbles
    char *bytes = (char *)&value;
    char byte = bytes[depth];

    NSMutableDictionary* thisEntry = [[[NSMutableDictionary alloc] initWithDictionary:nodeEntry] autorelease];

    if (byte == 0)
    {
        [thisEntry setObject:[NSString stringWithFormat:@"%08x",value] forKey:@"Value"];
        [thisEntry setObject:[NSString stringWithFormat:@"%08x",byte] forKey:@"Byte"];
        [thisEntry setObject:[NSNumber numberWithInt:depth] forKey:@"Depth"];

        return thisEntry;
    }

    if(![[thisEntry allKeys]containsObject:@"ChildEntries"])
    {
        NSMutableArray* childArray = [[NSMutableArray alloc]init];
        NSMutableDictionary* newNode = [[NSMutableDictionary alloc] init];

        [childArray addObject:AddItemToTree(newNode,value,++depth)];

        [thisEntry setObject:[NSNumber numberWithInt:depth] forKey:@"Depth"];
        [thisEntry setObject:[NSString stringWithFormat:@"%08x",value] forKey:@"Value"];
        [thisEntry setObject:[NSString stringWithFormat:@"%08x",byte] forKey:@"Byte"];
        [thisEntry setObject:childArray forKey:@"ChildEntries"];

        [newNode release];
        [childArray release];

    }
    else
    {
        [[thisEntry objectForKey:@"ChildEntries"]addObject:AddItemToTree(thisEntry,value, ++depth)];

    }

    return thisEntry;
}

int main(int argc, char *argv[]) {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    NSMutableDictionary* treenode=[[NSMutableDictionary alloc]init];

    char bytearray[4] = {0x0F, 0x0F, 0x02, 0x00};
    unsigned int *value = (unsigned int*)bytearray;
    char bytearray2[4] = {0x0F, 0x02, 0x00, 0x00};
    unsigned int *value2 = (unsigned int*)bytearray2;
    char bytearray3[4] = {0x0F, 0x02, 0x00, 0x00};
    unsigned int *value3 = (unsigned int*)bytearray3;

    [treenode setObject:[NSNumber numberWithInt:0] forKey:@"Depth"];
    [treenode setObject:[NSString stringWithFormat:@"%08x",*value] forKey:@"Value"];
    [treenode setObject:AddItemToTree(treenode,*value, 0) forKey:@"ChildEntries"];

//    [[treenode objectForKey:@"ChildEntries"]addObject:AddItemToTree(treenode,*value2, 0)];

    [treenode writeToFile:@"/Users/headbanger/Desktop/test.plist" atomically:YES];

    [pool release];
} 
```

添加一个 USB 位置 ID 效果很好。添加第二个（通过取消注释 main 中的行）会导致 SIGABRT。我确信这非常简单，而且我犯了一个典型的新手错误。但是，这对我来说并不明显，您可以提供的任何帮助都将非常受欢迎。
我的树需要看起来像这样：

```
F-
 |--F-
 |   |--2
 |
 |--2 
```

即使尝试添加第三个字节数组，这棵树也应该是真的。
如果您可以在不针对 USB 的情况下回答问题，那将是最有帮助的，因为我真的很想了解树木以及我做错了什么。也就是说，如果有一种快速简便的方法可以在 Objective-C 中为我构建一棵树，那么我很想听听。
所以请专家们，有人能告诉我我做错了什么吗？感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:06:59.093

一个问题是您将字典设置为 ChildEntries 的类型：

```
[treenode setObject:AddItemToTree(treenode,*value, 0) forKey:@"ChildEntries"]; 
```

但在其他地方，您尝试将其用作 NSMutableArray（注意 addObject: 方法）：

```
[[thisEntry objectForKey:@"ChildEntries"]addObject:AddItemToTree(thisEntry,value, ++depth)]; 
```

要修复它，你可以做

```
[treenode setObject:[[NSMutableArray alloc] initWithObjects:AddItemToTree(treenode,*value, 0), nil]forKey:@"Children"]; 
```

但即使你的递归进展到 0x00 字节`if (byte==0)`，我认为，从精神上检查它，它会添加重复的孩子并产生一个非常深的树。

如果您没有收到警告您`addObject`使用 SIGABORT 的错误方法的消息，则说明您的环境有问题。

顺便说一句，很难阅读。像这样的线条

```
[treenode setObject:[[NSMutableArray alloc] initWithObjects:AddItemToTree(treenode,*value, 0), nil]forKey:@"Children"]; 
```

如果您编写以下代码，则更容易扫描并且不易出错：

```
NSString * const kChildren = @"Children";
// ...
NSMutableArray *children = [[NSMutableArray alloc] initWithObjects:AddItemToTree(treenode,*value, 0), nil];
[treenode setObject:children forKey:kChildren]; 
```

风格不是很客观-c-ish，您可以使用 NSUInteger 和 NSData 代替 unsigned int 和 char 数组。

* * *

您应该首先编写一个通用树，然后将其用于您的目的。这是我的树示例。它很丑，但它是我的。如您所见，这是常识。您可以设置条件，例如，每个节点有两个孩子，并且 left child < root < right child，然后您将获得一个具有更好的查找内容的属性的二叉搜索树。但我猜这会带你更多的代码。

```
#import <Foundation/Foundation.h>

typedef NS_ENUM(unsigned char, MyTreeVisitingOrder) {
    MyTreeOrderDepthFirst,
    MyTreeOrderValueFirst
};

#define Tree NSObject<MyTree>

@protocol MyTree
@property (nonatomic,strong) NSObject<NSCopying>* key;
@property (nonatomic,strong) NSObject *value;
@property (nonatomic,strong) NSMutableDictionary *children;
-(void) insertChild:(Tree*)node;
-(void) each:(void(^)(NSObject*))block order:(MyTreeVisitingOrder)order;
@end

@interface TreeImpl : NSObject <MyTree>
-(id) init __attribute__((unavailable("disabled")));
@end

@implementation TreeImpl

@synthesize key = _key;
@synthesize value = _value;
@synthesize children = _children;

-(id) initWithKey:(NSObject<NSCopying>*)key value:(NSObject*)value {
    self = [super init];
    if (self){
        _key = key;
        _value = value;
        _children = [NSMutableDictionary new];
    }
    return self;
}

-(void) insertChild:(Tree*)node {
    [_children setObject:node forKey:node.key];
}

-(void) each:(void(^)(NSObject*))block order:(MyTreeVisitingOrder)order {
    switch (order) {
        case MyTreeOrderDepthFirst:{
            if (_children) {
                for (id key in _children){
                    [[_children objectForKey:key] each:block order:order];
                }
            }
            block(_value);
            break;
        }
        case MyTreeOrderValueFirst:{
            block(_value);
            if (_children) {
                for (id key in _children){
                    [[_children objectForKey:key] each:block order:order];
                }
            }
            break;
        }
    }
}

@end

int main(int argc, char *argv[]) {
    @autoreleasepool {

        TreeImpl *a = [[TreeImpl alloc] initWithKey:@"A" value:@"A"];
        TreeImpl *b = [[TreeImpl alloc] initWithKey:@"B" value:@"B"];
        TreeImpl *c = [[TreeImpl alloc] initWithKey:@"C" value:@"C"];
        [a insertChild:b];
        [a insertChild:c];

        [a each:^(NSObject* value) {
            NSLog(@"> %@",value);
        } order:MyTreeOrderValueFirst];
        return EXIT_SUCCESS;
    }
} 
```

# c# - 在 DatePicker 中设置自定义应用程序栏按钮

> ID：14589366
> 
> 赞同：0
> 
> 时间：2013-01-29T18:07:35.537
> 
> 标签：c#, visual-studio, windows-phone-7, datepicker, toolkit

我有这篇文章中的 DatePicker：http: [//www.windowsphonegeek.com/articles/wp7-datepicker-and-timepicker-in-depth--api-and-customization](http://www.windowsphonegeek.com/articles/wp7-datepicker-and-timepicker-in-depth--api-and-customization)。有一句名言：

> 该工具包提供了必要的图标，但您必须从 PhoneToolkitSample 项目中复制它们。它们必须命名为“ApplicationBar.Cancel.png”和“ApplicationBar.Check.png”，并且构建动作必须是“Content”！

我不知道如何在 Visual Studio 2010 for Windows Phone 7 中将构建操作设置为“内容”。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:55:19.297

这是'12，但它完全一样。

![在此处输入图像描述](../Images/c590462963ef48479a44bcaf7a28421b.png)

将您的图像添加到您的项目中。确保它已被选中，然后打开“属性”窗口。在“构建操作”下，选择“内容”。

# python - Python中的连接函数

> ID：14589368
> 
> 赞同：0
> 
> 时间：2013-01-29T18:07:48.587
> 
> 标签：python

我正在编写使用 reverse() 函数反转字符串的代码，例如 GOOD ---> DOOG w/o。我快到了...

```
a = "hello"

for i in range(1,len(a)+1): 

    print a[-i], 
```

当我使用 join 函数完成代码时，它并没有像我预期的那样工作。任何想法为什么？使我抓狂。

```
a = "hello"

for i in range(1,len(a)+1): 

    print ""join.a([-i],) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:09:23.893

您可以像这样在一行中反转字符串：

```
a[::-1] 
```

切片就像`[start:stop:step]`. 因此，当您使用 -1 作为 时`step`，它会反向打印字符串。

```
>>> a = "hello"
>>> a[::-1]
'olleh' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:08:47.990

你可以这样做：

```
''.join(a[-i] for i in range(1,len(a)+1)) 
```

如果可迭代项具有多个要实际连接在一起的项，则您将传递一个只有一项的可迭代对象到`join`何时真正工作得最好。`join`这里我传递了一个生成器表达式。

但实际上，最简单、最有效的反转字符串的方法是：

```
a[::-1] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T18:23:08.527

我会去，`s[::-1]`但如果我不得不写一个循环，那么：

```
for i in range(len(s) - 1, -1, -1):
    print s[i] 
```

# php - $_POST/$_REQUEST 不会读取过去的撇号

> ID：14589376
> 
> 赞同：1
> 
> 时间：2013-01-29T18:08:31.160
> 
> 标签：php, html

我有一个`<select>`HTML 表单中的对象，其中一个`<option>`s 的值为`Test's for/ chars`.

的HTML：

```
<option value="Test's for/ chars">TEST'S FOR/ CHARS</option> 
```

$_REQUEST 和 $_POST 都打印：

`Test`

我试过转义没有效果的撇号。然后我会得到`Test\`.

我正在使用 php 5.4.6。

PHP - 广义

```
while($row = mysql_fetch_array($result)):?>
    <option value="<?=$row['field']?>" <?=strtoupper($row['field'])?></option>
<?endwhile;?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:19:04.650

您不能使用反斜杠转义 HTML 引号。尝试在输出中使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php) ($string, ENT_QUOTES)：

```
echo "<option value=\"" . htmlspecialchars($str) . "\">$str</option>"; 
```

此函数将特殊字符转换为适当的 HTML 实体：

```
The translations performed are:

'&' (ampersand) becomes '&amp;'
'"' (double quote) becomes '&quot;' when ENT_NOQUOTES is not set.
"'" (single quote) becomes '&#039;' (or &apos;) only when ENT_QUOTES is set.
'<' (less than) becomes '&lt;'
'>' (greater than) becomes '&gt;' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:27:33.853

我已经用 PHP5.3.10 试过你的例子，它开箱即用。我使用了以下示例代码：

*测试.html*：

```
<html>
 <head></head>
 <body>
  <form method="post" action="test.php">
  <select name="test">
    <option value="Test's for/ chars">TEST'S FOR/ CHARS</option>
  </select>
  <input name="submit" type="submit" />
  </form>
 </body>
</html> 
```

*测试.php*：

```
<?php

echo $_POST['test']; 
```

*在浏览器中输出*：

```
Test's for/ chars 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:14:29.207

```
<option value="Test's for/ chars">TEST'S FOR/ CHARS</option> 
```

需要在任何特殊汽车之前进行逃生。所以：`<option value="Test\'s for/ chars">TEST'S FOR/ CHARS</option>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T18:18:20.697

你能把 ' 改成 & #39;

```
<option value="Test&#39;s for/ chars">TEST&#39;S FOR/ CHARS</option> 
```

# c# - 如何格式化数据项字符串

> ID：14589377
> 
> 赞同：0
> 
> 时间：2013-01-29T18:08:42.807
> 
> 标签：c#, asp.net, data-binding

所以我有一个文本字段，我从数据库列表中调用一个数据项。我正在尝试格式化此字段，使其仅显示护照号码的最后 3 位数字，然后用 # 符号掩盖前 6 位数字。我怎样才能做到这一点内联还是我必须去后面的代码？

```
<asp:TextBox 
    ID="txtPassportNumber" 
    runat="server" 
    MaxLength="9" 
    text="<%# ((TSAPassenger) Container.DataItem).Passport.DocumentNumber %>" 
    Enabled="<%# IsOutsideTenDayCutoff %>"></asp:TextBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:18:15.317

您可以使用 string.Concat，其中 str 是您的 DataItem 字符串

```
 (str.Length==9) ? string.Concat(string.Empty.PadLeft(6, '#'), str.Substring(str.Length - 3)) : string.Empty; 
```

您可以更改后一个 string.Empty 以显示一些错误或任何您想要的错误护照号码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:15:56.080

你有没有尝试过这样的事情：

```
text="<%# '######' & string.right(((TSAPassenger) Container.DataItem).Passport.DocumentNumber,3) %>" 
```

但除非您在应用程序中需要该号码，否则只需从数据库命令中调用它即可。

# javascript - Meteor 应用程序不会自动刷新

> ID：14589381
> 
> 赞同：2
> 
> 时间：2013-01-29T18:08:52.770
> 
> 标签：javascript, meteor

我对 Meteor 非常陌生。在阅读了最初的文档和截屏视频之后，我才刚刚开始。之后，创建新应用程序，我开始试验示例 hello world 应用程序。但是，每当我对 JS 或 HTML 文件进行任何更改时，它都不会自动更新浏览器，而只有在我手动刷新页面之后才会更新。为什么这样 ？

我在 Ubuntu 12.10（64 位）上使用 Mozilla Firefox 16.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:55:48.583

确保您允许使用 cookie。当我指示 cookie Monster 只允许会话使用 cookie 时，我也遇到了同样的情况。当完全允许我的域时，刷新开始工作

# php - 在 Zend Web 应用程序中显示 Drupal 6 菜单

> ID：14589383
> 
> 赞同：0
> 
> 时间：2013-01-29T18:08:57.897
> 
> 标签：php, postgresql, zend-framework, menu, drupal-6

我在 Drupal 6 旁边运行了一个 Zend Web 应用程序。基本结构是这样的：

```
www.domain.com/cms/
www.domain.com/zf/ 
```

CMS 是 Drupal 内容，ZF 是 Zend Framework 内容。

这是问题。我希望将 Drupal 中的主要/次要链接放入 ZF 菜单中，以便在 CMS 和 Zend 之间导航时页面相对无缝。目前在 Zend 中进行了 Ajax 调用以从 Drupal 获取主要链接。这是低效的并且会出现在报告中，因此我的任务是修复它。

从概念上讲，最好的方法是什么？我应该在我的 ZF 应用程序中包含来自 Drupal 的文件还是其他什么？我对 Drupal 知之甚少，所以我不确定我是否可以通过数据库调用来获取链接，或者是否有我应该调用的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T12:19:39.747

我说最好的方法是以某种格式导出 Drupal 菜单，然后在您的 ZF 应用程序中解析它。为了保持同步，只需编写一个小脚本来执行导出并每天运行它或满足您的需求（最好在您的网站流量最低时，如果性能是优先考虑的）。

以下是与 Drupal 菜单相关的功能列表：[菜单系统](http://api.drupal.org/api/drupal/includes!menu.inc/group/menu/6)

这会让你开始：

```
 $menus = menu_get_menus();
  foreach ($menus as $menu_machine_name => $menu_human_name) {
    $menu_items = menu_tree_all_data($menu_machine_name);
  } 
```

但是您必须引导 Drupal，才能访问 Drupal 的所有功能。所以你可以做这样的事情：

```
require_once 'path/to/drupal/folder/installation/includes/bootstrap.inc'; 
drupal_bootstrap(DRUPAL_BOOTSTRAP_FULL); // you now have access to all Drupal functions 
```

当然，您可以直接调用数据库，但首先您必须了解 Drupal 如何获取菜单结构，然后删除您需要的 SQL 查询。

祝你好运！

# c# - ASP.NET MVC - FormsAuthentication.SetAuthCookie() 和 RolesIsUserInRole - 奇怪的行为

> ID：14589384
> 
> 赞同：3
> 
> 时间：2013-01-29T18:08:58.340
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, forms-authentication, roleprovider

我有这样的事情：

```
FormsAuthentication.SetAuthCookie(user, false);
var tmp = Roles.IsUserInRole("administrator");
var _tmp = Roles.IsUserInRole(user, "administrator"); 
```

`tmp`永远是假的，`_tmp`永远是真的。为什么是`tmp`假的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:16:58.007

由于您在登录操作期间执行此操作，因此可以安全地假设用户尚未登录，因此`User`on `HttpContext`（可从您的控制器通过`this.User`或 just访问`User`）设置为未经身份验证的主体。`Roles`将使用 current`User.Identity.Name`来获取用户名和检索角色，因此在这种情况下，您需要使用第二个重载。

如果出于某种原因需要使用第一个重载，则必须更新用户：

```
User = new GenericPrincipal(new GenericIdentity(user, "forms"), new string[0]); 
```

通常，FormsAuth 模块会`User`在用户登录后下次访问页面时进行适当的更新，方法是读取 auth ticket cookie，解密它，并使用在票证中找到的名称创建一个新`GenericPrincipal`的 a 。`FormsIdentity`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:17:02.417

`var tmp = Roles.IsUserInRole("administrator");`正在检查当前登录的用户是否在角色中，同时`var _tmp = Roles.IsUserInRole(user, "administrator");`正在检查是否`user`在角色中，他们当时是否已登录。而且由于`FormsAuthentication.SetAuthCookie(user, false);`在下一个请求之前不会生效，`user`因此实际上还没有登录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T18:42:20.087

SetAuthCookie 只设置cookie。它不会让您登录，也不会加载任何用户信息。

在下一个请求时读取 cookie，然后 ASP.NET 将配置角色和身份作为请求处理管道的一部分。

您可以绕过这一点，但它本质上意味着复制 asp.net 授权代码，全部用于一个请求。重定向用户并重新加载页面可能更容易。

# javascript - 如何让这个 JSONP 提要更新？

> ID：14589385
> 
> 赞同：0
> 
> 时间：2013-01-29T18:08:58.063
> 
> 标签：javascript, jquery, ajax, jsonp

我正在尝试在网页的 div 中显示带有 $ & ajax 的 JSONP 数据。我希望定期更新这些数据。但是下面的代码只显示一次数据，然后它就永远不会改变。我可以做些什么来显示数据，然后在提要中的信息更改时实际更改？

```
<script type = "text/javascript">
   setInterval(function refreshWeather() { 
   $(function() {
   $.ajax({
   url : "http://api.wunderground.com/api/mykey/conditions/forecast/q/autoip.json",
   dataType : "jsonp",
   success : function(parsed_json) { 
   var temp_f = parsed_json['current_observation']['temp_f'];
   var feelslike = parsed_json['current_observation']['feelslike_f'];
   var forecast = parsed_json['forecast']['txt_forecast']['date'];
   $('#content13').replaceWith(temp_f + " feels like " + feelslike);
     }
    });
    });
   }, 90000);

  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:13:57.900

这似乎有效：

```
$(function () {
    var refreshWeather = function () {
        $.ajax({
            url: "http://api.wunderground.com/api/mykey/conditions/forecast/q/autoip.json",
            dataType: "jsonp",
            success: function (parsed_json) {
                var temp_f = parsed_json['current_observation']['temp_f'];
                var feelslike = parsed_json['current_observation']['feelslike_f'];
                var forecast = parsed_json['forecast']['txt_forecast']['date'];
                $('#content13').replaceWith(temp_f + " feels like " + feelslike);
            }
        });
    };

    refreshWeather();
    setInterval(refreshWeather, 90000);
}); 
```

[http://jsfiddle.net/Nsu3h/](http://jsfiddle.net/Nsu3h/)

# java - 如何在 Java 中使用 JFileChooser 保存文件？

> ID：14589386
> 
> 赞同：22
> 
> 时间：2013-01-29T18:09:01.207
> 
> 标签：java, swing, file-io, jfilechooser

我有以下代码。它保存文件但内容为空。它出什么问题了？

```
public void saveMap() {
    String sb = "TEST CONTENT";
    JFileChooser chooser = new JFileChooser();
    chooser.setCurrentDirectory(new File("/home/me/Documents"));
    int retrival = chooser.showSaveDialog(null);
    if (retrival == JFileChooser.APPROVE_OPTION) {
        try {
            FileWriter fw = new FileWriter(chooser.getSelectedFile()+".txt");
            fw.write(sb.toString());
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-29T18:22:01.930

如果您使用的是 Java 7，请对资源使用 try。你会这样做：

```
try(FileWriter fw = new FileWriter(chooser.getSelectedFile()+".txt")) {
    fw.write(sb.toString());
} 
```

尝试使用资源`close()`会在失败或成功时自动调用。

如果您没有使用 Java 7，请不要忘记调用`close()`. `close()`会自动调用`flush()`。

```
...
fw.close();
... 
```

要了解为什么需要刷新，您需要了解 FileWriter 的工作原理。当您说`fw.write("blah")`时，它实际上将该字符串放入内存中的缓冲区中。填满缓冲区后，FileWriter 会将字符串写入硬盘。它具有这种行为，因为在大块中写入文件效率更高。

如果要在缓冲区达到容量之前清空缓冲区，则需要通过调用来告诉 FileWriter `flush()`。通话`flush()`在通信时也非常重要，例如通过互联网，因为您需要在另一端看到您的消息之前刷新。如果您的信息只是放在内存中，它不会对它们有多大用处。

完成任何 I/O 流后，您应该调用`close()`（标准 I/O 流除外）。这意味着操作系统不再需要维护这个流。在某些情况下，可以打开的流数量有限，例如文件，所以不要忘记关闭是非常重要的。

当您调用 close 时，它​​实际上做了两件事：清空缓冲区，然后关闭流。这是为了确保在流关闭之前不会留下任何东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-29T18:11:41.663

不要忘记`flush`和`close`你的`FileWriter`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-29T18:11:25.840

你需要`close()`你的 FileWriter。

# jsf - JSF - Faces-config 重定向参数 - howto

> ID：14589388
> 
> 赞同：0
> 
> 时间：2013-01-29T18:09:08.250
> 
> 标签：jsf, primefaces, jstl

我想通过使用 'faces-config' xml 文件资源（如“重定向”标签）来重定向我的应用程序流。

所以，这是我的“面孔”xml：

```
<navigation-rule>
  <from-view-id>/index.xhtml</from-view-id>
  <navigation-case>
    <from-outcome>falha_etapa_1</from-outcome>
    <to-view-id>/index.xhtml</to-view-id>
    <redirect>
      <redirect-param>
        <name>msg</name>
        <value>-1</value>
      </redirect-param>
    </redirect>
  </navigation-case>
</navigation-rule> 
```

在这里，我的 jsf 页面：

```
<h:form>
  <f:view>
    <p:outputLabel value="${param['msg']}" />
    and so on.... 
```

这个印刷品是什么（空白）！！！！为什么不能打印参数值？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T12:28:19.583

使用`<view-param>`而不是`<redirect-param>`.

像这样：

```
<view-param>
  <name>msg</name>
  <value>-1</value>
</view-param> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:06:57.270

更改`${param['msg']}`为`#{param['msg']}`

```
<p:outputLabel value="#{param['msg']}" /> 
```

更多信息：

*   [JSF 2.0 中的通信：隐式 EL 对象](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ImplicitELObjects)

# javascript - jQuery Datatables 找到最后一行，并从第一列获取数据，该列是隐藏列

> ID：14589390
> 
> 赞同：1
> 
> 时间：2013-01-29T18:09:15.840
> 
> 标签：javascript, jquery, datatables

我有一个数据表驱动的表设置，其中有几个隐藏列。我试图从中找出如何找到具有特定类的该表的最后一行。因此，我可以获取它的第一列，它是隐藏列之一，并将其​​数据用于我正在编写的另一个脚本的一部分。据我了解，这`fnGetData()`是我希望使用的功能。但是找到具有特定类的最后一行（tr）（该类有多行）。然后使用该行作为从第一个隐藏列中获取数据的手段，以便我可以使用它似乎在逃避我。

我需要知道如何找到最后一行，并以希望的方式使用它。有任何想法吗？除了在数据表 api 文档上找到的方法之外，我还没有尝试太多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:42:01.380

制作了一个快速简单的[jsFiddle](http://jsfiddle.net/Wkt3s/2)，说明了我如何理解您的表格的工作方式；和我使用的 jQuery：

```
$(".row:last td:hidden:first").text() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:34:40.140

像这样的东西应该适合你。使用 :last 选择器。

```
$(".trclass:last").children(".hiddenCol") ..... 
```

# python - 如何使用 Flask WTF FileField 实际上传文件

> ID：14589393
> 
> 赞同：13
> 
> 时间：2013-01-29T18:09:26.397
> 
> 标签：python, python-2.7, flask, flask-wtforms

在我的 forms.py 文件中，我有

```
 class myForm(Form):
       fileName = FileField() 
```

在我的 views.py 文件中，我有

```
 form = myForm()
    if form.validate_on_submit():
        fileName = secure_filename(form.fileName.file.filename) 
```

在我的 .html 文件中

```
 {% block content %}
     <form action="" method="post" name="simple" enctype="multipart/form-data">
        <p>
           Upload a file
             {{form.fileName()}}
         </p>
        <p><input type="submit" value="Submit"></p>
     </form>
     {% endblock %} 
```

当我点击提交但文件不在任何项目目录中时，它似乎工作。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-29T18:39:48.563

你有没有看过这个：

[https://flask.palletsprojects.com/en/2.0.x/patterns/fileuploads/#uploading-files](https://flask.palletsprojects.com/en/2.0.x/patterns/fileuploads/#uploading-files)

您必须设置一些配置，例如 UPLOAD_FOLDER 等。您还必须调用我在您发布的 views.py 代码中没有看到的 save() 函数。

```
file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename)) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-05-29T17:33:13.767

在 form.fileName.file 上，调用“.save”。

```
filename = secure_filename(form.fileName.file.filename)
file_path = os.path.join(app.config['UPLOAD_FOLDER'], filename)
form.fileName.file.save(file_path) 
```

确保使用 secure_filename() 来防止用户输入错误的文件名，例如“../../../../home/username/.bashrc”。

无论您使用什么操作系统，使用 os.path.join 都会生成正确的绝对路径。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-29T18:47:38.560

我只需要在 form.fileName.file.save 上调用 .save

```
 myFile = secure_filename(form.fileName.file.filename)
    form.fileName.file.save(PATH+myFile) 
```

# c++ - 错误 C2296：“*”：非法，左操作数的类型为“__int64 *”|

> ID：14589397
> 
> 赞同：0
> 
> 时间：2013-01-29T18:09:40.340
> 
> 标签：c++

以下代码产生错误：

```
error C2296: '*' : illegal, left operand has type '__int64 *'| 
```

错误行 (<------)

```
DWORD increasefactor = 1;

__int64 initialtime64 = 0;
__int64 initialoffset64 = 0;

...

BOOL WINAPI QueryPerformanceCounter_Detour(__int64 *lp)
{
    BOOL ret = QueryPerformanceCounter_Trampoline(lp);
    lp = ((lp-initialtime64)*increasefactor)+initialoffset64;   // <------
    return ret;
} 
```

我的错在哪里？

提前非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:16:50.243

`lp`是指向 的指针`__int64`，而不是实际的`__int64`。表达方式

```
lp = ((lp-initialtime64)*increasefactor)+initialoffset64; 
```

尝试将整数分配给指向整数的指针，更不用说稍后在同一行中从同一个指针中减去这一事实。

您需要使用`*`运算符取消引用指针以获取`lp`.

```
*lp = ((*lp-initialtime64)*increasefactor)+initialoffset64; 
```

您可能还应该阅读 C++/C 中的指针。

# image-processing - 哪个js库用于使用html5制作面部失真应用程序？

> ID：14589398
> 
> 赞同：1
> 
> 时间：2013-01-29T18:09:51.277
> 
> 标签：image-processing, image-manipulation, distortion

我使用 iphone face fun 和其他基于 flash 的在线面部失真应用程序。我想使用纯 html5 制作这样的应用程序。我看过 pixastic 库，但它没有任何图像失真过滤器。是否可以仅使用 js 库来旋转、扭曲或膨胀图像？我也在 stackoverflow 上搜索过类似的问题，但没有一个指向任何特定的库。如果有的话，最好在线提供一些html5人脸扭曲应用示例。

# mongodb - 如何确保 mongodb 地理空间坐标的小数精度？

> ID：14589401
> 
> 赞同：4
> 
> 时间：2013-01-29T18:09:58.203
> 
> 标签：mongodb, double, geospatial, precision

我需要在 mongodb 中保存经度/纬度坐标，但我不知道如何存储它们。我没有看到在线显示转换为字符串或将小数部分拆分为 2 个整数的示例。我假设为了启用地理索引，我必须将它们存储为双精度，例如：

```
{ _id : 100, pos: { long : 126.9, lat : 35.2 }, type : "restaurant"} 
```

我需要至少 6 位小数的精度，那么这在 mongodb 中是如何工作的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T19:20:22.820

MongoDB[支持`double`](http://docs.mongodb.org/manual/reference/glossary/#term-bson-types)数据类型。它用于所有浮点数。由于 MongoDB 实现了 BSON 规范，我们可能会认为它是 BSON double 的两倍。这是`8 bytes (64-bit IEEE 754 floating point)`根据[规范](http://bsonspec.org/#/specification)。[它支持](http://en.wikipedia.org/wiki/Double-precision_floating-point_format#IEEE_754_double-precision_binary_floating-point_format%3a_binary64)15-17 位有效数字。

所以别担心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T19:37:32.713

MongoDB 的地理空间索引使用传统的[geohash](http://docs.mongodb.org/manual/core/geospatial-indexes/#geospatial-indexes-geohash)。您可以[将哈希的精度配置为高达 32bits](http://docs.mongodb.org/manual/core/geospatial-indexes/#location-precision)，这相当于大约 8 或 9 位小数的精度。所以你会从双打中失去一些精度，但对于你的应用来说仍然很多。

# javascript - 访问 iframe 中的 dom 元素

> ID：14589402
> 
> 赞同：0
> 
> 时间：2013-01-29T18:10:08.780
> 
> 标签：javascript, jquery, dom, iframe

> **可能重复：**
> [jQuery 跨域 iframe 脚本](https://stackoverflow.com/questions/3083112/jquery-cross-domain-iframe-scripting)

我有一个调用外部 url 的 iframe。此时我正在本地工作。

```
<iframe id="iframeid" src="https://www.example.com/"></iframe> 
```

所有内容都显示正确。

现在我想通过 jquery 或 javascript 进行一些更改，我注意到我无法访问 iframe 中的元素。我的意思是如果我这样做

```
$('#iframeid').load(function(){
    var iframeBody = $("#iframeid").contents().find("body").length;
    console.log('iframeBody -->'+iframeBody);
}); 
```

它总是返回 0（零）。

我知道因为我正在使用不同的域，所以我受到了浏览器限制。但是我看到了这篇**[文章](https://stackoverflow.com/questions/5059302/cannot-load-an-external-page-with-jquery-load-into-a-div-in-my-page)**并尝试使用该插件，但我仍然得到未定义的值。

谁能帮帮我？？

谢谢大家

# php - SQL 语句中文字前的冒号是什么意思？

> ID：14589407
> 
> 赞同：7
> 
> 时间：2013-01-29T18:10:20.897
> 
> 标签：php, mysql, yii

**在变量前使用“ :** ”是什么意思？

例如，`:userId`在这段代码中：

```
public function removeUser($userId)
{
 $command = Yii::app()->db->createCommand();
 $command->delete(
 'tbl_project_user_assignment',
 'user_id=:userId AND project_id=:projectId',
 array(':userId'=>$userId,':projectId'=>$this->id));
} 
```

这是 Yii 框架中的 PHP、MySQL 代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-29T18:11:17.687

冒号是一个常用字符，表示 SQL 语句中变量值的占位符。在这种情况下，这些占位符将在运行时被`userId`and的值替换。`project_id`这对于避免 SQL 注入漏洞非常有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T18:41:18.427

**:userId**是占位符

根据 Yii 的[SQL 语句](http://www.yiiframework.com/doc/api/1.1/CDbCommand#bindValue-detail "数据库查询")文档：

> 对于使用命名占位符的预处理语句，这将是**:name**形式的参数名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:39:12.080

正如 thaidiotguy 提到的，这是一个通常用于准备好的语句的字符，尤其是 PDO。在 PDO 中，冒号表示以下是命名参数。

# php - 将 Twig 与 Slim 应用程序一起使用

> ID：14589408
> 
> 赞同：4
> 
> 时间：2013-01-29T18:10:22.763
> 
> 标签：php, twig, slim

我正在为我正在开发的一个简单网站使用 Slim 框架，并且还想使用 Twig 模板引擎。

我已经安装了 Slim、Slim Extras 和 Twig，我的`index.php`文件包含以下内容：

```
<?php

/* Require and initialize Slim and Twig */
require 'Slim/Slim.php';
\Slim\Slim::registerAutoloader();
require 'Twig/lib/Twig/Autoloader.php';
Twig_Autoloader::register();

$app = new \Slim\Slim(array(
    'view' => new \Slim\Extras\Views\Twig()
));

/* Application routes */
$app->get('/', function () {
    $pageTitle = 'hello world';
    $body = 'sup world';

    $app->view()->setData(array('title' => $title, 'body' => $body));
    $app->render('index.html');
});

/* Run the application */
$app->run(); 
```

但是，这会导致错误：`Fatal error: Call to a member function view() on a non-object in C:\xampp\htdocs\index.php on line 18`

我承认我不知道如何正确使用 Twig 和 Slim。我关注了关于目录结构和如何加载 Twig 的 StackOverflow 帖子，但我不知道如何向视图添加一些自定义数据，也不知道 Twig 的视图文件应该存储在哪里。

我用谷歌搜索，但很多信息都是针对旧版本的 Slim 的，并且缺少 Slim 文档本身。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-30T08:51:25.310

这是一个简单的 php 错误。您正在尝试访问未导入其范围的闭包中的变量，像这样修复它：

```
$app->get('/', function () use ($app) {
    // $app will work here
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-02T12:58:57.500

较新的 Slim 框架（我相信 2.2+）布局来自作曲家组件。Twig 文档对于在哪里放置什么以及如何向对象解释它有点含糊。我花了一些时间弄清楚如何初始化简单的文件系统环境。如果有人提出这个问题，希望它会有所帮助：

例子：

在工作/当前文件夹中，我有以下文件夹/文件：

```
templates
    home_page.html
vendor
    slim
    twig
    .
    .
index.php
composer.json 
```

`Templates`是我将放置 Twig 模板文件的位置，`vendor`是组件所在的文件夹（Slim，Twig ... 其余部分），`index.php`是 Slim 应用程序，并且`composer.json`是作曲家的控制文件。

我的初始化如下所示：

```
 <?php
    require_once 'vendor/autoload.php';
    // require 'Slim/Slim.php'; (old way)
    \Slim\Slim::registerAutoloader();

    $loader = new Twig_Loader_Filesystem('./templates');
    $twig = new Twig_Environment($loader /* ,array(twig config) */);

    $app = new \Slim\Slim(); 
```

注意带有加载器的**Twig_Loader_Filesystem**（我花了一些时间来弄清楚自从 Twigs 第一个示例使用以来出了什么问题`$loader = new Twig_Loader_String();`，并且它不会从文件中呈现，直到你发现你已经写了一个东西并期望做另一个的事实。

渲染如下：

```
$template = $twig->loadTemplate('home_page.html');
echo $template->render( array( /* values for template */ ) ); 
```

或者：

```
echo $twig->render('home_page.html',array( /* values for template */ ) ); 
```

不要忘记： function ( /* params */ ) **use($app, $twig)** as 来到达 twig 对象。

安全性：请注意，制作 .php 模板比 .html 更安全，因为 Slim 不会覆盖/保护文件系统中存在的文件夹，因此例如 apache 将直接发送文件而不咨询 Slim，或者，将模板放在网络之外空间。

# javascript - Backbone-forms.js - 我可以在脚本中配置一个文本字段，还是在渲染后使用 jQuery 来完成？

> ID：14589415
> 
> 赞同：0
> 
> 时间：2013-01-29T18:10:41.650
> 
> 标签：javascript, backbone.js, backbone-forms

嗨，我在我的脚本中得到了这个表单，我可以在脚本中解析选项值，如高度和宽度，还是让我在通过该脚本渲染后用 jQuery 设置它的样式？

```
var form1 = new Backbone.Form({
    schema: {
        country: { type: 'Select', options: ['UK', 'USA'] },
        city: { type: 'Select', options: cities.UK },
        message: { type: 'Text'}
    }
}).render(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:19:39.617

您可以使用该`fieldAttrs`属性为元素设置任何属性：

```
country: { 
  type: 'Select', 
  options: ['UK', 'USA'], 
  fieldAttrs: { style: "width: 400px; height: 30px;" } 
} 
```

或者，您可以使用该属性提供 CSS 类`fieldClass`，并使用常规样式表应用 CSS 规则：

```
country: { 
  type: 'Select', 
  options: ['UK', 'USA'], 
  fieldClass: 'country-select'
} 
```

所有可用的模式属性都[记录在这里](https://github.com/powmedia/backbone-forms#main-attributes)。

# c++ - 枚举类可以转换为基础类型吗？

> ID：14589417
> 
> 赞同：118
> 
> 时间：2013-01-29T18:10:46.643
> 
> 标签：c++, c++11

有没有办法将`enum class`字段转换为基础类型？我认为这将是自动的，但显然不是。

```
enum class my_fields : unsigned { field = 1 };

unsigned a = my_fields::field; 
```

GCC 拒绝了该分配。`error: cannot convert 'my_fields' to 'unsigned int' in assignment`.

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2013-01-29T18:16:10.973

我认为您可以使用[std::underlying_type](http://en.cppreference.com/w/cpp/types/underlying_type)来了解基础类型，然后使用强制转换：

```
#include <type_traits> //for std::underlying_type

typedef std::underlying_type<my_fields>::type utype;

utype a = static_cast<utype>(my_fields::field); 
```

有了这个，您不必*假设*底层类型，或者您不必在`enum class`类似的定义中提及它`enum class my_fields : int { .... }`。

您甚至可以编写一个*通用*转换函数，该函数应该能够将*任何* `enum class`转换为​​其基础*整数*类型：

```
template<typename E>
constexpr auto to_integral(E e) -> typename std::underlying_type<E>::type 
{
   return static_cast<typename std::underlying_type<E>::type>(e);
} 
```

然后使用它：

```
auto value = to_integral(my_fields::field);

auto redValue = to_integral(Color::Red);//where Color is an enum class! 
```

并且由于该函数被声明为`constexpr`，因此您可以在需要常量表达式的地方使用它：

```
int a[to_integral(my_fields::field)]; //declaring an array

std::array<int, to_integral(my_fields::field)> b; //better! 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2013-01-29T18:16:23.457

您不能*隐式*转换它，但可以进行显式转换：

```
enum class my_fields : unsigned { field = 1 };

// ...

unsigned x = my_fields::field; // ERROR!
unsigned x = static_cast<unsigned>(my_fields::field); // OK 
```

还要注意一个事实，分号应该*在*枚举定义中的闭合花括号之后，而不是之前。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-11-19T09:58:19.100

使用 C++23，您最终将获得一个库函数：

[std::to_underlying](https://en.cppreference.com/w/cpp/utility/to_underlying)

它已经在 GCC 11、Clang 13 和 MSVC 19.30（又名 2022 17.0）的标准库中实现。

在您能够使用 C++23 之前，我建议您（重新）将任何自定义实现命名为`to_underlying`并将其放置在一个`#if !defined(__cpp_lib_to_underlying)` `#endif`块之间，该块是关联的功能测试宏。这样，当 C++23 可供您使用时，您可以在将来某个时候简单地放弃代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-10T03:42:39.350

正如其他人指出的那样，没有隐式强制转换，但您可以使用显式`static_cast`. 我在我的代码中使用以下辅助函数来转换枚举类型及其基础类。

```
 template<typename EnumType>
    constexpr inline decltype(auto) getIntegralEnumValue(EnumType enumValue)
    {
        static_assert(std::is_enum<EnumType>::value,"Enum type required");
        using EnumValueType = std::underlying_type_t<EnumType>;
        return static_cast<EnumValueType>(enumValue);
    }

    template<typename EnumType,typename IntegralType>
    constexpr inline EnumType toEnum(IntegralType value)
    {
        static_assert(std::is_enum<EnumType>::value,"Enum type required");
        static_assert(std::is_integral<IntegralType>::value, "Integer required");
        return static_cast<EnumType>(value);
    }

    template<typename EnumType,typename UnaryFunction>
    constexpr inline void setIntegralEnumValue(EnumType& enumValue, UnaryFunction integralWritingFunction)
    {
        // Since using reinterpret_cast on reference to underlying enum type is UB must declare underlying type value and write to it and then cast it to enum type
        // See discussion on https://stackoverflow.com/questions/19476818/is-it-safe-to-reinterpret-cast-an-enum-class-variable-to-a-reference-of-the-unde

        static_assert(std::is_enum<EnumType>::value,"Enum type required");

        auto enumIntegralValue = getIntegralEnumValue(enumValue);
        integralWritingFunction(enumIntegralValue);
        enumValue = toEnum<EnumType>(enumIntegralValue);
    } 
```

使用代码

```
enum class MyEnum {
   first = 1,
   second
};

MyEnum myEnum = MyEnum::first;
std::cout << getIntegralEnumValue(myEnum); // prints 1

MyEnum convertedEnum = toEnum(1);

setIntegralEnumValue(convertedEnum,[](auto& integralValue) { ++integralValue; });
std::cout << getIntegralEnumValue(convertedEnum); // prints 2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-27T15:06:52.333

`underlying_cast`当必须正确序列化枚举值时，我发现以下函数很有用。

```
namespace util
{

namespace detail
{
    template <typename E>
    using UnderlyingType = typename std::underlying_type<E>::type;

    template <typename E>
    using EnumTypesOnly = typename std::enable_if<std::is_enum<E>::value, E>::type;

}   // namespace util.detail

template <typename E, typename = detail::EnumTypesOnly<E>>
constexpr detail::UnderlyingType<E> underlying_cast(E e) {
    return static_cast<detail::UnderlyingType<E>>(e);
}

}   // namespace util

enum SomeEnum : uint16_t { A, B };

void write(SomeEnum /*e*/) {
    std::cout << "SomeEnum!\n";
}

void write(uint16_t /*v*/) {
    std::cout << "uint16_t!\n";
}

int main(int argc, char* argv[]) {
    SomeEnum e = B;
    write(util::underlying_cast(e));
    return 0;
} 
```

# sql - 如何从存储过程返回创建表？

> ID：14589419
> 
> 赞同：1
> 
> 时间：2013-01-29T18:10:46.723
> 
> 标签：sql, sql-server, sql-server-2008

我有一个 Microsoft SQL Server R2 2008。我有生以来第一次看到它。
我有一个SP：

```
DECLARE @RC int
DECLARE @Id uniqueidentifier
DECLARE @Segment_ID uniqueidentifier
DECLARE @SDate datetime
DECLARE @EDate datetime
DECLARE @withBig bit
DECLARE @withKm bit
DECLARE @withGeo bit
DECLARE @withDescr bit

DECLARE @BusStationCursor CURSOR
SET @BusStationCursor = CURSOR FOR
SELECT Id, Segment_ID, E_Date_Begin, E_Date_Begin
FROM BusStation

OPEN @BusStationCursor
FETCH NEXT    FROM @BusStationCursor INTO @ID, @Segment_ID, @SDate, @EDate
WHILE @@FETCH_STATUS = 0
BEGIN

EXECUTE @RC = [dd_ugra].[dbo].[Request_BusStation] 
  @Id
  ,@Segment_ID
  ,@SDate
  ,@EDate
  ,@withBig=1
  ,@withKm=1
  ,@withGeo=1
  ,@withDescr=1

FETCH NEXT    FROM @BusStationCursor INTO @ID, @Segment_ID, @SDate, @EDate
END
CLOSE @BusStationCursor
DEALLOCATE @BusStationCursor
GO 
```

但是我有一个静态信息，所以我不想每次想查看数据时都调用 sp，如何使用 sp 结果创建表？

**更新**

所以我有一个返回一些列的 sp。我可以使用 sp 来创建视图。我不能发布 sp 因为它真的很大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:33:19.853

您可以[从视图中调用过程](https://stackoverflow.com/questions/349979/execute-a-sql-stored-proc-from-a-sql-view)：

```
create view MyView as
    select *
    from openrowset (
        'sqloledb',
        'server=(local);trusted_connection=yes;',
        'exec MyDatabase.dbo.MyStoredProcedure'
    ) 
```

请注意，您必须对任何参数进行硬编码，或者从 proc 返回所有可能的记录（可能必须更改 proc）并在视图定义或外部查询中使用 where 子句进行过滤（视图不接受参数，他们采用 where 子句）。

此外，您可以让您的视图只是光标的定义：

```
SELECT Id, Segment_ID, E_Date_Begin, E_Date_Begin
FROM BusStation 
```

然后再次在外部查询中使用 where 子句。这将假设 proc 中的光标和逻辑实际上并没有改变数据，这可能是一个很长的镜头（为什么它需要一个光标？）。

除此之外，您还必须准确了解 proc 正在做什么以确定您是否可以进行执行相同操作的查询（视图）。显然，如果没有 proc 的完整代码以及 proc 可能调用的任何其他 procs/functions/triggers/views，SE 社区将无法协助这项工作。

# visual-studio - 不同目录中的源文件和 MSBuild .proj 文件

> ID：14589420
> 
> 赞同：1
> 
> 时间：2013-01-29T18:10:57.210
> 
> 标签：visual-studio, msbuild

我有一个项目（目前它的 .csproj，仅包含 .js 文件）。我只将它用于一些后期构建事件，以及来自 Visual Studio 的智能感知。

我可以以某种方式具有以下目录结构吗？

```
Root/Projects/HelloWorld.(cs)proj
Root/Sources/Test.js 
```

但是 Visual Studio 似乎只从 .csproj 文件下的文件夹中获取源文件，如果我尝试从其他地方添加文件，它们会作为链接添加（我无法从 VS 删除或重命名）。例如，我可以将某些东西放入 .proj 文件中以更改根目录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T03:03:50.940

您可以`mklink /D Sources ..\Sources`欺骗 VS，但它可能会弄乱您的 VCS，或者您可以挂接到`AfterBuild`目标并将源从 VS 的根目录复制到 IntelliJ。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:35:43.577

Visual Studio 仅支持将文件添加到 a 的两种方法`.csproj`：将您添加的文件复制到（默认）目录层次结构下的某个位置，`.csproj`或者如果您选择将文件添加为链接，它会添加对该文件的引用。

你不能改变前一种行为，除非调用后一种行为，这显然有你不喜欢的缺点。

您可以直接编辑以在[item group](http://msdn.microsoft.com/en-us/library/646dk05y.aspx)`.csproj`中包含其他文件，这可能会构建，但不会像您在 IDE 本身中所期望的那样显示或运行。`Compile`

如果您的目标是分离源和项目，您可以重新排列目录的结构，以便项目都位于根目录，并且有一个源目录是这些项目的兄弟目录：

```
Foo.csproj
Foo.someotherproj
Source/
  *.js 
```

这意味着`.csproj`从 Visual Studio 查看时，您将所有内容都放在“源”文件夹中。

另一种选择可能是查看某种项目生成工具，例如[premake](http://industriousone.com/premake)或[CMake](http://www.cmake.org/)，但它们对 C# 项目文件的支持可能不是那么强大。

# ios - 如何在 iOS 中按字母顺序对 MediaQuery 的 ArtistQuery 数组进行排序

> ID：14589423
> 
> 赞同：0
> 
> 时间：2013-01-29T18:11:01.650
> 
> 标签：ios, cocoa-touch, uitableview, nsarray

在我的应用程序中，我加载 Artist 并输入`arrayOfArtists`并显示`UITableView`。

所以我需要索引我`UITableView`的 . 这就是为什么我需要像 iOS 内置音乐应用程序一样按字母顺序对我的艺术家数组进行排序。

![在此处输入图像描述](../Images/735ed1575afa18a983b525e16bcb1cf4.png)

像上面的照片，它可以索引`UITableView`到`Title`。

所以我需要按字母顺序对我的艺术家数组进行排序。

我怎样才能做到这一点？

这是我从 iPodLibrary 加载 Artist 的一些代码。

在`ViewDidLoad`

```
 MPMediaQuery *query = [MPMediaQuery artistsQuery];
    query.groupingType = MPMediaGroupingAlbumArtist;
    self.arrayOfArtist = [query collections]; 
```

在`CellForRowAtIndexPath`

```
cell.textLabel.text = [NSString stringWithFormat:@"%@",[[[self.arrayOfArtist objectAtIndex:indexPath.row] representativeItem] valueForProperty:MPMediaItemPropertyArtist]]; 
```

在`sectionForSectionIndexTitle`

```
- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index
{
    return 1;
} 
```

和

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
        return [self.arrayOfArtist count];
} 
```

我想按字母顺序显示我`TitleHeader`的`UITableView`索引`UITableView`。我怎样才能做到这一点？谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:13:15.313

使用选择器按字母顺序排序：

```
NSArray *sortedArray=[self.arrayOfArtist sortedArrayUsingSelector:@selector(localizedCaseInsensitiveCompare:)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T08:02:29.153

X-开发者-X -

通过实施，我得到了与您想要的几乎相同的东西

```
-(NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView 
```

和

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
```

sectionIndexTitlesForTableView 生成屏幕右边缘的索引字符，titleForHeaderInSection 生成节之间的标题。我附上了结果的屏幕截图。我确信可以通过更改表格视图中的一些 GUI 设置来使其完全相同。我看到的区别是我的标题栏有点透明，其中的字符是白色的。

![一个屏幕截图，揭示了我对音乐的不同寻常的品味：](../Images/56658ff8b578474e99e678bf814e1b01.png)

# php - 我需要 php 函数从浏览器而不是服务器获取时间

> ID：14589426
> 
> 赞同：0
> 
> 时间：2013-01-29T18:11:05.913
> 
> 标签：php

我正在编写论坛脚本，但由于服务器时间与我的国家时间不同，我及时遇到了问题；
我尝试使用这个自己的功能，但问题转移给了我在其他国家的朋友hhhhh：

```
function ftime($time, $reg = false)
{
    $time = $time ;
    $mytime = protect($_SESSION['mytime']);
    $time = $time + $mytime;
    $time2 = time() - 3600  + $mytime;
} 
```

** 注意：这不是我的全部功能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:12:21.427

PHP 是一种服务器端语言，不能直接获取客户端的时间。您将不得不检查时区并在客户端脚本的帮助下编写自己的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:21:45.670

确切地说，您需要 js 的帮助来确定时区。

检查这个：

[如何获取客户的时区？](https://stackoverflow.com/questions/1905397/how-to-get-clients-timezone)

[确定用户的时区](https://stackoverflow.com/questions/13/determining-a-web-users-time-zone)

# ios - 无法建立与服务器的连接

> ID：14589432
> 
> 赞同：1
> 
> 时间：2013-01-29T18:11:30.283
> 
> 标签：ios, objective-c

我必须通过调用 api /api/places来建立与服务器[http://sand.com的连接。](http://sand.com)我将 NSMutableURLRequest 对象用于上述 url 和 Authorization 标头。建立了几次连接，但我没有收到数据，但现在根本没有建立连接，而是多次调用了 didReceiveAuthenticationChallenge。（授权标头设置值是用户名：base64 格式的密码）我哪里出错了？

```
NSString *urlString =
        [NSString stringWithFormat:@"http://sand.com/api/places",hostURL];
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:[NSURL       URLWithString:urlString] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:300.0];
[theRequest setValue:@"Basic c3VyYWJoaV9taXNocmE6bWlzaHJhaml2ZQ==" forHTTPHeaderField:@"Authorization"];
[theRequest setHTTPMethod:@"GET"];
NSURLconnections *nuc = [NSURLconnections new];
nuc.delegate = self;
[nuc connectToRequest:theRequest];

- (void)connectToRequest:(NSURLRequest*)theRequest
{
    urlConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (urlConnection) 
    { 
      responseData=[NSMutableData data];
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:   (NSURLAuthenticationChallenge *)challenge 
{
   if ([challenge previousFailureCount] == 0)
    {  
       NikeAppDelegate *appDelegate = [[UIApplication sharedApplication]delegate];
    username = appDelegate.username; password = appDelegate.password;
       NSURLCredential *cred = [[NSURLCredential alloc]
                             initWithUser:username
                             password:password
                             persistence:NSURLCredentialPersistenceNone];
       [[challenge sender] useCredential:cred forAuthenticationChallenge:challenge]; 
    }
} 
```

# forms - PHP：CodeIgniter $this->form_validation->run() 验证两次？

> ID：14589433
> 
> 赞同：1
> 
> 时间：2013-01-29T18:11:30.257
> 
> 标签：forms, codeigniter, validation

**完毕**

没有机会在控制器操作中使用 $this->form_validation->run() 两次吗？CodeIgniter 似乎只验证第一条规则。我想使用 $this->form_validation->run() 两次，因为我需要第二个验证规则的验证值;)。

```
$this->form_validation->set_rules(...);
if($this->form_validation->run() === true)
{
    $value = $this->..._model->get( ...);  //use of validated value
    $this->form_validation->set_rules(...); //use of $value
    if($this->form_validation->run() === true)
    {
        //...
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:31:30.007

加载时尝试为 form_validation 库分配别名？那可能会解决问题。

```
$this->load->library('form_validation','','validation1');
$this->validation1->set_rules(...);
if($this->validation1->run() === true)
{
    $value = $this->..._model->get( ...);  //use of validated value
    $this->load->library('form_validation','','validation2');
    $this->validation2->set_rules(...); //use of $value
    if($this->validation2->run() === true)
    {
        //...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-27T14:25:50.417

在核心文件 - CodeIgniter_2.1.3/system/libraries/Form_validation.php 添加一行

```
$this->_field_data = array(); 
```

在方法运行（）中；

```
public function run($group = '')
    {
        // add this line for clear field data to use validation many times
        $this->_field_data = array(); 
```

# functional-programming - 有没有办法在 SML 中查看库函数代码？

> ID：14589439
> 
> 赞同：0
> 
> 时间：2013-01-29T18:11:52.480
> 
> 标签：functional-programming, sml

我对 List.combine 的完成方式很感兴趣

```
val combine : 'a list -> 'b list -> ('a * 'b) list

Transform a pair of lists into a list of pairs: combine [a1; ...; an] [b1; ...; bn] is [(a1,b1); ...; (an,bn)]. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T21:33:13.653

SML 的哪个实现？[MosML](https://github.com/kfl/mosml)、[MLton](http://mlton.svn.sourceforge.net/viewvc/mlton/)和[SML/NJ](http://smlnj-gforge.cs.uchicago.edu/scm/viewvc.php/?root=smlnj)都是开源的，所以你应该可以直接下载源代码或在浏览器中查看。实际上， ListPair 的 MosML 实现在[这里](https://github.com/kfl/mosml/blob/Rel-2.10/src/mosmllib/ListPair.sml)， zip 就在顶部，假设那是您正在谈论的功能。它确实完全符合您的描述。

# jquery - 无法让标记在谷歌地图中加载表单 XML 文件

> ID：14589441
> 
> 赞同：0
> 
> 时间：2013-01-29T18:11:56.757
> 
> 标签：jquery, xml, maps

我正在尝试根据存储在 XML 文件中的数据在谷歌地图上创建标记。

```
<rows>
  <row>
    <Content Type>Case Study</Content Type>
    <Solution Area/ Theme>Efficiency Optimization</Solution Area/ Theme>
    <Ecosystem>Energy & Utilities</Ecosystem>
    <Location>Abu Dhabi</Location>
    <City>Abu Dhabi</City>
    <lat>24.443935</lat>
    <long>54.41905</long>
    <Region>EMEA</Region>
    <Title>TAQA's multinational activity benefits from a single global banking              partner</Title>
  </row>
</rows> 
```

我的 XML 文件与 HTML 位于同一目录中。大约有 100 个标记要绘制。我正在尝试使用这个简单的 jQuery 示例来完成它（在分配了其他东西之后）。帮助

这是我的代码

```
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Google Maps JavaScript API v3 Example: Common Loader</title>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="util.js"></script>
<script type="text/javascript">
  google.load("maps", "3",  {other_params:"sensor=false"});
  google.load("jquery", "1.3.2");

  function initialize() {
    var myLatlng = new google.maps.LatLng(10, 0);
    var myOptions = {
      zoom: 2,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    jQuery.get("data.xml", {}, function(data) {
      jQuery(data).find("row").each(function() {
        var marker = jQuery(this);
        var latlng = new google.maps.LatLng(parseFloat(marker.attr("lat")),
                                    parseFloat(marker.attr("long")));
        var marker = new google.maps.Marker({position: latlng, map: map});
     });
    });
  }

  google.setOnLoadCallback(initialize);
</script>
</head>
<body>
  <div id="map_canvas" style="width:400px; height:300px"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:16:49.963

把它放在`doc ready`处理程序中：

```
$(function(){
  jQuery.get("data.xml", {}, function(data) {
    jQuery(data).find("row").each(function() {
      var marker = jQuery(this);
      var latlng = new google.maps.LatLng(parseFloat(marker.attr("lat")),
                                parseFloat(marker.attr("long")));
      var marker = new google.maps.Marker({position: latlng, map: map});
   });
  });
}); 
```

# visual-studio-2012 - 如何在 Visual Studio 2012 中使用 SQL Server Express 2008 部署 wpf 应用程序？

> ID：14589443
> 
> 赞同：0
> 
> 时间：2013-01-29T18:12:07.360
> 
> 标签：visual-studio-2012, installation, sql-server-express, sql-server-2008-express

我们在 .Net Framework 4 中有一个 wpf 应用程序，并在开发时使用 SQL Server Express 2008 作为数据库。现在我们要部署它。如何打包数据库并生成安装程序供用户下载并使用 Visual Studio 2012 将其安装到他们的机器上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T08:41:54.770

不知道您是否发现，但从 VS 2012 开始，Microsoft 不再提供他们的“Visual Studio 安装项目”。所以你需要使用另一个与VS集成的第三方工具。如果您想要一个免费且功能强大的工具，我推荐[WiX](http://wix.sourceforge.net/)，但您需要一些时间来学习它。

[Advanced Installer](http://www.advancedinstaller.com)还在其免费和付费版本中[与 Visual Studio 集成。](http://www.advancedinstaller.com/user-guide/ai-ext-vs.html)但是，对于您想做的事情，需要许可证。

# php - 需要有关使用双 MySQL 和 MSSQL 连接构建 php 框架的建议

> ID：14589444
> 
> 赞同：0
> 
> 时间：2013-01-29T18:12:11.153
> 
> 标签：php, mysql, sql-server

我的主要存储是 MySQL，但我**必须**使用远程 MSSQL Server，其中存储了书名和 ID。我对该远程 MSSQL Server 具有只读访问权限。所有其他数据（书籍作者、年份、描述等）都存储在我的本地 MySQL 数据库中。我无法在本地 MySQL 中存储标题（这是协议条件）。我的 PHP 框架允许为这些书籍添加描述和许多其他数据——所有数据都存储在 MySQL 中。

总的来说，我可以开发这个框架，但我有一个弱点。在这种情况下，我需要有关如何组织搜索的专业建议。因为我使用了 2 个不同的数据库，所以我不能使用简单的连接或其他任何东西。当然，我可以进行两步搜索：1）获取标题，2）获取其他内容，然后在 PHP 中形成结果。但恐怕它会很慢。有没有办法以某种方式从 MySQL 临时表中的 MSSQL 中选择标题？或者我可能会错过一些用于此类数据库合作的好技术？任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:20:21.150

MySQL 对 MSSQL 一无所知，因此您无法跨两种不同类型的数据库服务器连接。但是，您的结构对于您所描述的而言确实还不错。在我看来，您有三种可能的搜索方案 1）仅搜索标题 2）搜索标题和其他信息，3）仅搜索其他信息。你的问题是在案例 2 中，案例 1 和 3 都很简单。

正如你所提到的，我处理它的方式是一个两步过程，有点像这样：

1) 获取搜索查询

2) 获取任何可能匹配的标题的 MSSQL 结果

3) a) 将标题结果写入临时表或 b) 存储在内存结构中（取决于您用于搜索结果评分的内容 - 如果使用 MySQL 全文搜索，则需要写入临时表）

4a) 如果标题在临时表中，则对连接表执行搜索

4b）如果标题在内存中，则搜索其他书籍信息并根据需要在内存中加入数据。

由于不能在本地存储标题的限制，无论如何您都会遇到一些性能问题，但最大限度地减少查询数量会有所帮助。

PS你的协议*到底*说了什么？您可以将书名存储在内存中吗？或者您是否总是需要对远程服务器执行查询？如果您可以将它们存储*在内存中*，也许您可​​以查询 MSSQL 数据库并将标题放入 MySQL 内存表（[http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html](http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html) )，当服务器关闭时它会从内存中消失。

# tfs - 如何复制工作项及其任务

> ID：14589446
> 
> 赞同：15
> 
> 时间：2013-01-29T18:12:20.900
> 
> 标签：tfs, visual-studio-2012, workitem

我想复制一个工作项及其所有任务。

我正在使用这个版本的产品：11.0.50727.1 我正在为项目使用 Scrum 2.0 模板

如果这是可能的，我该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-29T19:11:25.570

你试过Excel吗？在对工作项进行大规模编辑时，它是您最好的朋友。您可以复制/粘贴多个工作项。通过选择除 ID 列之外的所有列。复制它们，然后将它们粘贴到 Excel 中打开的查询的底部。

您需要确保您使用的是基于树的查询，并且您要复制的所有列都是查询列的一部分。

但是，您可能会以这种方式丢失 HTML 类型字段的格式。

我很想知道您为什么要批量复制 Product Backlog 项目及其所有任务，从 scrum 的角度来看，我真的不明白这有什么意义。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-07-10T16:57:37.283

我看到这个问题已经超过 2 年了。Excel 不会为我创建父链接。这是我的 Powershell 解决方案：

```
if ( (Get-PSSnapin -Name Microsoft.TeamFoundation.PowerShell -ErrorAction SilentlyContinue) -eq $null )
{
     Add-PSSnapin Microsoft.TeamFoundation.PowerShell
}

[void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.Client")
[void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.Build.Client")
[void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.Build.Common")
[void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.TeamFoundation.WorkItemTracking.Client")

# Connect to TFS and get Work Item Store.
$tfsCollectionUrl = "https://tfs.CORP.com/tfs/group"
$tfs = Get-TfsServer -name $tfsCollectionUrl
$ws = $tfs.GetService([type]"Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemStore")

$storyID = 15211    # ID of the story you want to copy.

$story = $ws.GetWorkItem($storyID)
Write-Host "Cloning User Story: " + $story.Title

#Clone User Story
$cloneStory = $story.Copy()
($story, $cloneStory )
$cloneStory.Title = "COPY : " + $story.Title

# cloneStory will not have links to all the tasks that were linked to the orginal story.
# cloneStory will have two links, one to the same "feature" that the orginal was linked to, and one to the story it was cloned from.
$cloneStory.Links

# cloneStory will have 0 for an ID, because it has not yet been saved.
$cloneStory.Id
#$cloneStory.Save()
# cloneStory will now have an ID.
$cloneStory.Id
$parentID = $cloneStory.Id  # Parent ID will be used to link new cloned tasks to this story.

$links = $story.Links

# Define a Link Type to be used in the loop.
$linkType = $ws.WorkItemLinkTypes[[Microsoft.TeamFoundation.WorkItemTracking.Client.CoreLinkTypeReferenceNames]::Hierarchy]

foreach ( $link in $links )
{

    $itemID = $link.RelatedWorkItemId
    #$itemID

    $item = $ws.GetWorkItem($itemID)

    if ( ($item.Type).Name -eq "Task" )
    {
        $reportLine = "Cloning Task ID:{0} {1}" -f $itemId, $item.Title
        Write-Host $reportLine
        # Clone the Task
        # Create the Parent Link object
        # Add the Parent Link to Cloned Task
        # Save New Cloned Task

        $cloneTask = $item.Copy()
        $cloneTask.Title = "COPY : " + $item.Title
        $parentLink = new-object Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemLink($linkType.ReverseEnd, $parentID)
        $cloneTask.WorkItemLinks.Add($parentLink)
        $cloneTask.save()
        $cloneTask
    }
    else
    {
        $reportLine = "Skipping: {0} is not a Task, it is a {1}" -f $item.Title, ($item.Type).Name
        Write-Host $reportLine
    }
} 
```

# java - 在运行时加载自定义 ItemizedOverlay NullPointerException - Android

> ID：14589454
> 
> 赞同：1
> 
> 时间：2013-01-29T18:12:43.897
> 
> 标签：java, android, google-maps, overlay, itemizedoverlay

我正在为 android 制作一个地图应用程序，它允许用户放置自己的兴趣点。我想为放置的每种类型的点设置自定义图钉图标。当我尝试在运行时获取我的自定义 ItemizedOverlay 时，我得到了 NullPointerException。

在地图上添加一个点：

```
public void addPointToMap(PointOfInterest pointOfInterest) {

    OurItemizedOverlay itemizedOverlay = getOverlayForPointOfInterest(pointOfInterest); <--- NullPointer here
    //Add item to collection in OurItemized Overlay
    itemizedOverlay.addOverlay(pointOfInterest);
    mapOverlays.clear();
    mapOverlays.add(myLocationOverlay);
    mapOverlays.add(itemizedOverlay);
    mapView.invalidate();
} 
```

获取覆盖：

```
private OurItemizedOverlay getOverlayForPointOfInterest(PointOfInterest pointOfInterest) {

       String type = pointOfInterest.getType().toLowerCase();

       if(type.equals("monument")) {
           return monumentOverlay;
       }
       else if(type.equals("building")) {
           return buildingOverlay;
       }
       else if(type.equals("atm")) {
           return atmOverlay;
       }
       else if(type.equals("attraction")) {
           return attractionOverlay;
       }
       else if(type.equals("pub")) {
           return pubOverlay;
       }
       else if(type.equals("restaurant")) {
           return restaurantOverlay;
       }
       else if(type.equals("shop")) {
           return shopOverlay;
       }
       else if(type.equals("bridge")) {
           return bridgeOverlay;
       }
       else if(type.equals("station")) {
           return stationOverlay;
       }
       else if(type.equals("cafe")) {
           return cafeOverlay;
       }
       else if(type.equals("hotel")) {
           return hotelOverlay;
       }
       else {
           return defaultOverlay; 
       }
} 
```

设置 Drawables 和 Overlays：

```
/**
 * Set the overlay objects up
 */
private void setItemizedOverlays() {

    //SET OVERLAY Items
    monumentOverlay = new OurItemizedOverlay(monumentIcon, this);
    buildingOverlay = new OurItemizedOverlay(buildingIcon, this);
    shopOverlay = new OurItemizedOverlay(shopIcon, this);
    attractionOverlay = new OurItemizedOverlay(attractionIcon, this);
    bridgeOverlay = new OurItemizedOverlay(bridgeIcon, this);
    stationOverlay = new OurItemizedOverlay(stationIcon, this);
    pubOverlay = new OurItemizedOverlay(pubIcon, this);
    restaurantOverlay = new OurItemizedOverlay(restaurantIcon, this);
    cafeOverlay = new OurItemizedOverlay(cafeIcon, this);
    atmOverlay = new OurItemizedOverlay(atmIcon, this);
    hotelOverlay = new OurItemizedOverlay(hotelIcon, this);

}

/**
 * Set the icons for each Drawable object
 */
private void setDrawableIcons() {

    defaultIcon = this.getResources().getDrawable(R.drawable.downarrow);
    monumentIcon = this.getResources().getDrawable(R.drawable.monument);
    shopIcon = this.getResources().getDrawable(R.drawable.shop);
    attractionIcon = this.getResources().getDrawable(R.drawable.attraction);
    buildingIcon = this.getResources().getDrawable(R.drawable.building);
    bridgeIcon = this.getResources().getDrawable(R.drawable.bridge);
    stationIcon = this.getResources().getDrawable(R.drawable.station);
    pubIcon = this.getResources().getDrawable(R.drawable.pub);
    restaurantIcon = this.getResources().getDrawable(R.drawable.restaurant);
    cafeIcon = this.getResources().getDrawable(R.drawable.cafe);
    atmIcon = this.getResources().getDrawable(R.drawable.atm);
    hotelIcon = this.getResources().getDrawable(R.drawable.hotel);

} 
```

堆栈跟踪：

```
01-29 18:17:11.875: E/AndroidRuntime(12380): FATAL EXCEPTION: main
01-29 18:17:11.875: E/AndroidRuntime(12380): java.lang.NullPointerException
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.example.mapproject.MainActivity.addPointToMap(MainActivity.java:140)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.example.mapproject.MainActivity.onPointsOfInterestDownloaded(MainActivity.java:227)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.example.mapproject.DownloadPointsOfInterest.onPostExecute(DownloadPointsOfInterest.java:67)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.example.mapproject.DownloadPointsOfInterest.onPostExecute(DownloadPointsOfInterest.java:1)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.os.AsyncTask.finish(AsyncTask.java:602)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.os.AsyncTask.access$600(AsyncTask.java:156)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.os.Looper.loop(Looper.java:137)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at android.app.ActivityThread.main(ActivityThread.java:4441)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at java.lang.reflect.Method.invokeNative(Native Method)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at java.lang.reflect.Method.invoke(Method.java:511)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:823)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:590)
01-29 18:17:11.875: E/AndroidRuntime(12380):    at dalvik.system.NativeStart.main(Native Method) 
```

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:21:20.927

最有可能的错误 - 您进入了默认情况，我没有在 setItemizedOverlays 中看到 defaultOverlay 的初始化。但这对于调试器来说是一个很好的例子，在 getOverlayForPointOfInterest 中找出它进入了哪个分支，然后看看它为什么会为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:36:40.947

```
OurItemizedOverlay itemizedOverlay = getOverlayForPointOfInterest(pointOfInterest); <--- NullPointer here
    //Add item to collection in OurItemized Overlay
    itemizedOverlay.addOverlay(pointOfInterest);// here you overlay draw its k..
    mapOverlays.clear();  //now you clear mapoverlay so all overlay clear 
    mapOverlays.add(myLocationOverlay);//again you add maplocation overaly 
    mapOverlays.add(itemizedOverlay);
    mapView.invalidate(); 
```

用这个替换代码

```
 mapOverlays.clear(); 
OurItemizedOverlay itemizedOverlay = getOverlayForPointOfInterest(pointOfInterest); <-- 
        //Add item to collection in OurItemized Overlay
        itemizedOverlay.addOverlay(pointOfInterest);
        // mapOverlays.add(myLocationOverlay); 
        mapOverlays.add(itemizedOverlay);
        mapView.invalidate(); 
```

# php - .Htaccess - 在 mini MVC PHP 框架中获取新参数

> ID：14589456
> 
> 赞同：0
> 
> 时间：2013-01-29T18:12:49.903
> 
> 标签：php, .htaccess, url-routing

我有谷歌这个，但找不到任何东西，我自己也想不通。

我创建了一个迷你 MVC PHP Freamework 并拥有这个 .htaccess 文件：

```
DirectoryIndex index.php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
```

通常我从引导程序获取 url 并将模型和控制器获取到当前 url。

但是如果我有一个新的 GET 怎么办：

```
if (isset($_GET['topic']))
{
 // echo  the forum topic.
} 
```

现在网址是：`http://domain.com/mvc/forum/topic?topic=this-is-the-topic-title-url`

如何在 htaccess 中将其重写为`http://domain.com/mvc/forum/topic/this-is-the-topic-title-url`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:36:12.683

你可以...

1.  分析您的`$_GET['url']`参数并`$_GET`在程序中动态修改您的数组，*或者*
2.  使用多个重写规则：

    ```
    # Put this rewrite rule first, because it is more specific, and the
    # second rule will catch anything.
    RewriteRule ^(.+/topic)/(.+)$ index.php?url=$1&topic=$2 [QSA,L]
    RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T19:36:28.033

我解决了css文件：

```
# Allow any files or directories that exist to be displayed directly
RewriteCond ${REQUEST_URI} ^.+$
RewriteCond %{REQUEST_FILENAME} \.(gif|jpe?g|png|js|css|swf|php|ico|txt|pdf|xml)$ [OR]
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d [OR]
RewriteCond %{REQUEST_FILENAME} -l
RewriteRule ^ - [L] 
```

# php - MYSQL 在进行批量插入时失去连接

> ID：14589461
> 
> 赞同：0
> 
> 时间：2013-01-29T18:13:11.260
> 
> 标签：php, mysql, mysqli

我已经将我的测试服务器和新的生产服务器从 php 5.2 升级到了 5.4.7。此外，在 PHP 代码中，我将连接到 mysql 数据库的旧方法替换为新方法（所以我使用 mysqli_connect() 方法代替 mysql_connect()。这是因为从 PHP 版本 4.5 开始不推荐使用旧方法。

一切似乎都工作正常并且经过了很好的测试 - 我想，但我只是发现在进行批量单个插入查询时，mysql连接挂起。这发生在作为生产服务器（Centos Linux）的测试服务器上。所以 PHP 确实可以很好地建立连接，只有在进行批量插入时，连接才会中途丢失。

测试服务器（Windows XP，使用 XAMPP）给出错误消息：

> mysqli_connect():(HY000/2002): 每个套接字地址（协议/网络地址/端口）通常只允许使用一次

在 linux 机器上，我收到错误消息：

> mysqli_connect():(HY000/2003):无法连接到'127.0.0.1'上的MySQL服务器(99)

我基本上在做的是：

> While 循环查询结果
> 
> {
> 
> $query="插入 (a,b,c,d) 值(1,2,3,4)";
> 
> 查询执行（$查询）；
> 
> }

我认为问题在于我正在执行许多插入的事实；大约 100.000 个单独的插件。我没有使用持久的 mysql 连接。

我不知道是什么原因造成的（mysql、PHP、服务器本身）？

**添加**：运行/执行查询的代码（简化）类似于：

```
//the database connection class 
class database($query)
{    
    public function setup_connection() { 
        $this->link=mysqli_connect('localhost', 'my_user', 'my_password', 'my_db');
    } 

    public function execute_query($query){
        mysqli_query($this->link, $query);
    }
}

//a regular php page using the class 

$obj_db1=new database($query);

while($obj_db1->loop()) 
{
    $obj_db_insert=new database($query);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:15:19.790

确保在您的插入代码中您不会每次都打开与数据库的新连接。

我的猜测是正确的，根据您刚刚发布的代码，

使您的课程如下所示：

```
class database

{

public function setup_connection() {...}

public function execute_query($query){...}

public function close_connection(){...}
} 
```

然后在通话中使其如下所示：

```
$db = new database();
$db->setup_connection();

//execute your queries as much as you want ...
//loop start
$db->execute_query($query);
//loop end 

// close connection 
$db->close_connection(); 
```

# c# - DebugDiag 未显示 .NET 4 下的 .NET 堆栈信息

> ID：14589462
> 
> 赞同：7
> 
> 时间：2013-01-29T18:13:14.233
> 
> 标签：c#, .net, debugdiag

感觉这可能有一个简单的答案，但我一直找不到。

有问题的场景是一个 C# .NET 控制台应用程序。

我通常使用 DebugDiag 1.2 来检查来自我们遇到的挂起的 .dmp 文件——通常是线程锁定问题。它们是使用 DebugDiag 的“创建完整用户转储”选项创建的。

我最近开始编译面向 .NET 4 的应用程序，为开始使用 .NET 4 的一些功能做准备。但是，我注意到在使用 DebugDiag 分析这些 .dmp 文件时，所有 .NET 堆栈信息都丢失了。

如果我将 CLR 目标更改回 .NET 3.5，并从新的可执行文件中捕获 .dmp，则 .NET 调用堆栈信息就在那里。

当我查看 DebugDiag 的输出时，我看到一条注释说：

> **CLR 信息**
> 
> CLR 版本 = 4.0.30319.17929 CLR 调试器扩展 = C:\Program Files\DebugDiag\Exts\psscor4.dll
> 
> **.NET 线程摘要**
> 
> 请求线程存储失败

我认为“请求线程存储失败”是问题的关键，因为 .NET 3.5 .DMP 文件（使用 psscor2.dll）报告了“线程摘要”标题下的所有线程信息。

.dmp 是否缺少信息，或者 DebugDiag 出于某种原因无法检索它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-17T16:29:16.553

最终，这个问题自己解决了。我向微软发送了一个问题，他们说 DebugDiag 1.1 不支持 .NET 4+。他们不久前发布了 v1.2，确实如此 - 再次像魅力一样工作：

[http://www.microsoft.com/en-us/download/details.aspx?id=26798](http://www.microsoft.com/en-us/download/details.aspx?id=26798)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T21:48:29.470

假设您正在进行完整转储，这可能与它如何共同定位 sos 有关。在 3.5 下，它将使用 mscorlib 共同定位，而在 CLR 4 下，它将使用 clr 共同定位。这将取决于编写 debugdiag 以适应 CLR 4 的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-17T05:09:36.217

我遇到了同样的问题，对我来说，它有助于从 DebugDiag 的子目录“exts”中删除 psscor4.dll

在 DebugDiag 报告中，我的 CLR 运行时现在显示为：

```
CLR Information

CLR version = 4.0.30319.18052

CLR Debugger Extension = C:\Windows\Microsoft.NET\Framework\v4.0.30319\sos.dll 
```

PS：请注意使用正确版本的 DebugDiag（32 位与 64 位）。

# java - 通过 URL 下载图像

> ID：14589469
> 
> 赞同：2
> 
> 时间：2013-01-29T18:13:38.963
> 
> 标签：java, url, network-programming, download

我正在尝试在此链接上下载高分辨率产品图片

[http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.show-product/American-furniture/3005-75310/spindle-back-side-chair---ebony.cfm](http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.show-product/American-furniture/3005-75310/spindle-back-side-chair---ebony.cfm)

单击**下载高分辨率照片**时，我可以轻松下载，但是当我尝试复制图像 URL，然后从其他选项卡下载时，我得到 3005_75310.jpg 不存在。

所以我试图从第一个请求中查看请求标头并将它们设置在我的 URL java 对象中，但是创建的文件是空的，有人知道吗？

```
public static void saveImage(String imageUrl, String destinationFile) {
    URL url;
    try {
        url = new URL(imageUrl);
        URLConnection uc = url.openConnection();

        uc.setRequestProperty("Accept",
                "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        uc.setRequestProperty("Accept-Charset",
                "ISO-8859-1,utf-8;q=0.7,*;q=0.3");
        uc.setRequestProperty("Accept-Encoding", "gzip,deflate,sdch");
        uc.setRequestProperty("Accept-Language", "en-US,en;q=0.8");
        uc.setRequestProperty("Connection", "keep-alive");

        uc.setRequestProperty(
                "Referer",
                "http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.show-product/American-furniture/3005-75310/spindle-back-side-chair---ebony.cfm");

        InputStream is = url.openStream();
        OutputStream os = new FileOutputStream(destinationFile);

        byte[] b = new byte[2048];
        int length;

        while ((length = is.read(b)) != -1) {
            os.write(b, 0, length);
        }

        is.close();
        os.close();
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:26:52.240

提供的引荐来源网址并不是网站编码人员所期望的一种防止您正在执行的抓取的方法。示例工作请求：

```
$ wget \
  --referer=http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.show-product/American-furniture/3005-75310/spindle-back-side-chair---ebony.cfm \
  http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.photo-download/photo/3005_75310.jpg

Length: unspecified [image/jpeg]
Saving to: `3005_75310.jpg'

    [  <=>                                                                                ] 346,125      949K/s   in 0.4s

2013-01-29 13:24:02 (949 KB/s) - `3005_75310.jpg' saved [346125] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:28:00.997

对于它的价值，看起来唯一重要的标题是“Referer”标题：

这失败了：

```
curl "http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.photo-download/photo/3005_75310.jpg" > /test/3005_75310.jpg 
```

这有效：

```
curl -H "Referer: http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.show-product/American-furniture/3005-75310/spindle-back-side-chair---ebony.cfm" "http://www.hookerfurniture.com/index.cfm/furniture/furniture-catalog.photo-download/photo/3005_75310.jpg" > /test/3005_75310.jpg 
```

对于在 Java 中提取图像数据，我发现使用 DataInputStream 的 readFully() 方法最成功。

# linux - 如何在 Ubuntu 上安装旧版本的 Glibc

> ID：14589470
> 
> 赞同：0
> 
> 时间：2013-01-29T18:13:49.133
> 
> 标签：linux, ubuntu, glibc

> **可能重复：**
> [如何链接到特定的 glibc 版本？](https://stackoverflow.com/questions/2856438/how-can-i-link-to-a-specific-glibc-version)

我有一个`Ubuntu server`with `glibc 2.7`，如何安装到这台`glibc`旧版本的机器上，例如`2.2`or `2.0`。

谢谢！

# javascript - 访问每个外部的数据

> ID：14589471
> 
> 赞同：0
> 
> 时间：2013-01-29T18:13:55.703
> 
> 标签：javascript, templates, handlebars.js

在每个 Handlebars 中，我想访问一个属性并将该值应用于这些项目。在此示例中，我为每个选项数组值设置了一个段落标记。作为流程的一部分，我想将相同的类添加到这些相同的段落中。

JSON：

```
"newFaucetCrumbsDiv": {
"options": ["Intro","Video Gallery","Help Me Choose", "Recommendations"],
"recommendationsCount": "0",
"class":"newFaucetCrumbText"
    } 
```

模板：

```
<div id="newFaucetCrumbsDiv">
    {{#each newFaucetCrumbsDiv.options}}
        <p class="{{newFaucetCrumbsDiv.class}}">{{this}}</p>
    {{/each}}
</div> 
```

我的 p 标签显示正确，但类显示不正确。在 JSON 中，我不想为数组中的每个项目调用类 - 太冗长而且它们是相同的。是否有允许这样做的 Handlebars 语法？如果没有，什么助手可能会提供帮助？谢谢你，我刚刚开始使用 Handlebars~！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:15:03.317

您必须使用`../`退回到父上下文：

```
<div id="newFaucetCrumbsDiv">
    {{#each newFaucetCrumbsDiv.options}}
        <p class="{{../newFaucetCrumbsDiv.class}}">{{this}}</p>
    {{/each}}
</div> 
```

* * *

[这是来自文档](http://handlebarsjs.com/#paths)的引用：

> 嵌套的车把路径还可以包括`../`段，它们根据父上下文评估它们的路径......`../`路径段引用父模板范围，而不是上下文中的上一级......

# javascript - 将字符串从 Java servlet 传递到 jsp 到 js

> ID：14589473
> 
> 赞同：0
> 
> 时间：2013-01-29T18:14:00.197
> 
> 标签：javascript, jsp, servlets

我想将一个 Servlet 中的字符串传递给一个 jsp 页面，在那里它必须传递给一个驻留在外部 .js 中的 init 函数。这就是我到目前为止得到的：

**小服务程序**

```
request.setAttribute("jsonString", json.toString());
RequestDispatcher dispatcher = request.getRequestDispatcher("graph.jsp");
dispatcher.forward(request, response); 
```

**jsp**

```
<body onload="init('<%= request.getParameter("jsonString") %>');"> 
```

**js**

```
function init(jsonString){

    var json = jsonString; 
```

不幸的是，我在 init 函数中收到的唯一内容是 null。我确保 json.toString() 返回正确的值。所以它必须在转发和初始化函数之间丢失。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:18:07.060

您正在设置一个属性，但要检索一个参数，这[不是一回事](http://www.coderanch.com/t/361868/Servlets/java/request-getParameter-request-getAttribute)。我认为你应该尝试[表达语言](http://docs.oracle.com/javaee/6/tutorial/doc/bnahq.html)

```
<body onload="init('${jsonString}')"> 
```

您也可以使用`<%= request.getAttribute("jsonString") %>`，但对我来说它的可读性较差，而 EL 更简洁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:20:20.190

看看有没有区别

> request.setAttribute("jsonString",json.toString());
> 
> request.getParameter("jsonString")

它应该是

> request.getAttribute("jsonString")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:52:51.763

将 request.getParameter 更改为 request.getAttribute 将为您提供 jsonstring，但如果字符串中有新行或任何其他特殊字符（如单引号 (')），您可能会收到 javascript 错误。由于 javascript 错误，您将很难使用“警报 ()”进行调试或在页面上打印为 html。我建议使用firefox的firebug插件，你会在firebug控制台上看到错误。或者你可以查看页面的源代码，看看它是如何打印出代码的。

# ios - Cocos2d 2.x：理解 ccBezierConfig 行为

> ID：14589474
> 
> 赞同：2
> 
> 时间：2013-01-29T18:14:03.770
> 
> 标签：ios, cocos2d-iphone, bezier

不久前，我问了一个[问题](https://stackoverflow.com/questions/12430651/cocos2d-and-ios-cant-understand-use-of-control-points-using-ccbezierconfig)，一位用户友好地回复我，解释说有[这个插件工具](http://www.cse.unsw.edu.au/~lambert/splines/Bezier.html)可以用来创建快速贝塞尔曲线原型。

我尝试并制作了这个：

![这就是我用工具制作的](../Images/7ef64bc2d1e628bdba6cd9836f655d40.png)

我**认为**它会在这个 ccBezierConfig 中完美翻译：

```
ccBezierConfig bezier;
self.position = CGPointMake(-10.0f, 400.0f);
bezier.controlPoint_1 = CGPointMake(160, 190.0f);
bezier.controlPoint_2 = CGPointMake(200, 190.0f);
bezier.endPosition =CGPointMake(340.0f,280.0f);

id bezierForward = [CCBezierBy actionWithDuration:3 bezier:bezier];    
[self runAction: [CCSequence actions:
                  bezierForward, [CCHide action],
                  nil]]; 
```

不幸的是，我得到的路径并不像我所期望的那样安静。角色从屏幕的左上角开始移动，然后向上移动，我看不到预期的移动。

关于我做错了什么的任何解释？

顺便说一句.. 我在 iOS 6.0 上使用 Cocos2d 2.0，视网膜显示 iPod touch 第 4 代。

编辑：

另一个例子..

我认为这种配置会这样做[，](http://en.wikipedia.org/wiki/File:Bezier_3_big.png) 然后从头到尾做对称的事情，但“颠倒”。

关于我做错了什么的任何建议？

```
 ccBezierConfig bezier;

     self.position = CGPointMake(0.0f, 150.0f);
     bezier.controlPoint_1 = CGPointMake(-20.0f, 290.0f);
     bezier.controlPoint_2 = CGPointMake(260, 290.0f);
     bezier.endPosition =CGPointMake(340.0f,150.0f);

    id bezierForward = [CCBezierBy actionWithDuration:3 bezier:bezier];

    ccBezierConfig bezier2;
    bezier2.controlPoint_1 = CGPointMake(340.0f, 10.0f);
    bezier2.controlPoint_2 = CGPointMake(80, 10.0f);
    bezier2.endPosition =CGPointMake(-20.0f,150.0f);

    id bezierReturn = [CCBezierBy actionWithDuration:3 bezier:bezier2];

    [self runAction: [CCSequence actions:
                      bezierForward, bezierReturn, [CCHide action],
                      nil]]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T09:53:59.200

我使用的是 CCBezierBy，但这些示例基于 CCBezierTo 公式。因此，如果我使用 CCBezierTo 代替 CCBezierBy，一切都会按预期工作。

# maple - Maple 中符号的正值

> ID：14589476
> 
> 赞同：0
> 
> 时间：2013-01-29T18:14:06.900
> 
> 标签：maple

我需要将变量描述为积极的。它用作分段函数中的参数，根据定义它是正数，但我不知道如何将其设置为未知正数。我需要像 C++ 中的 unsigned 之类的东西，但对于 Maple。有什么建议吗？

**更新：**

例如：我做了一些评估，结果如下：

```
 piecewise(h <= 0, 0, 0 < h, (1/3)*h)  (1) 
```

但由于某些原因 h > 0，所以我想简化 (1)。如何将其设置为 Maple？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T01:44:16.543

不清楚您想要什么，因为您已经用宽松的术语描述了这个问题。在 Maple 的技术意义上，这里的“描述”是什么意思？和“功能”？

```
f:=proc(x::positive) if x>1 then y else z end if end proc:

f(4);
                           y

f(-4);
Error, invalid input: f expects its 1st argument, x, to be of type positive,
but received -4 
```

鉴于帖子的更新：也许你想要这样的东西，

```
f:=piecewise(h <= 0, 0, 0 < h, (1/3)*h):

simplify(f) assuming h>0;

                          1  
                          - h
                          3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T04:26:12.160

要向 Maple 指示该值为正实数，请使用

```
assume(h>0); 
```

# mysql - MYSQL 按 W/Count 排序

> ID：14589481
> 
> 赞同：0
> 
> 时间：2013-01-29T18:14:24.313
> 
> 标签：mysql, count, sql-order-by

我的表有用户名和用户积分，我正在制作排行榜列表。我想根据积分获得前十名的球员。我已将此查询表述为：

```
SELECT
    users.username,
    users.points
FROM users
ORDER BY users.points DESC
LIMIT 10 
```

但是，我还想根据 1 号玩家的位置来获取玩家的位置，而不为它创建新列。是否有一个 MYSQL 查询来获取`ORDER BY DESC`按点以及`COUNT`从中`ORDER`找到列表中的用户？( `WHERE username=`)。

编辑澄清：我想通过上述语句从 desc 中计算用户数。IE 1 - 用户 1 - 1000 分，2 - 用户 2 - 750 分……等等…… N - currentPlayer - currentPoints。我不介意使用`JOIN`声明，但我不希望有一个按排名排序的新玩家列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:40:33.343

尝试这个：

```
SELECT * FROM (
    select @rownum:=@rownum+1 `rank`, u.username, u.points 
    from users u, (SELECT @rownum:=0) r
    order by points desc) AS X
WHERE username ="Bob"; 
```

样本数据：

```
CREATE TABLE users(
  id int auto_increment primary key,
  username varchar (30),
  points INT
  );

INSERT INTO users(username,points)
VALUES ('Bob', 1000), ('Jack',750), ('Joe', 500) 
```

[SQL 小提琴演示](http://www.sqlfiddle.com/#!2/cc023/5)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-29T18:19:16.587

```
SELECT users.username, users.points FROM users WHERE users.points=MAX(users.points) OR users.username='<comparison username>' ORDER BY users.points DESC; 
```

# actionscript-3 - 使用 SpriteVisualElement 时宽度和高度为 0，但使用 Sprite 时大小正确

> ID：14589487
> 
> 赞同：0
> 
> 时间：2013-01-29T18:14:39.917
> 
> 标签：actionscript-3, apache-flex

我有一些代码，当我使用 Sprite 时，使用 addChild 时设置宽度和高度值，但使用 SpriteVisualElement 时，宽度和高度为 0。

```
 var sprite:Sprite = new Sprite();
        // ...
        sprite.cacheAsBitmap = true;
        sprite.transform.matrix = target.transform.matrix;
        sprite.addChild(bitmap); // width and height 250x65

        var spritevisualElement:SpriteVisualElement = new SpriteVisualElement();

        // ...
        spriteVisualElement.cacheAsBitmap = true;
        spriteVisualElement.transform.matrix = target.transform.matrix;
        spriteVisualElement.addChild(bitmap); // spriteVisualElement width and height 0x0 
```

到底是怎么回事？我可以让 SpriteVisualElement 工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T20:00:57.180

您可以将边界用于实际大小（顺便说一句`SpriteVisualElement`，在方法中测量自身时也使用边界`measure`，但由于某些原因`measure`，flex 不会自动调用它，并且无法（我找不到）手动调用它):

```
var bounds:Rectangle = container.getBounds(container);
trace("size:", bounds.right, bounds.bottom); //<-- clip the container by the rectangle with origin at (0, 0)
trace("size:", bounds.width, bounds.height); //<-- full with/height 
```

输出：

```
size: 100 100
size: 100 100 
```

# objective-c - 按特定顺序遍历 NSArrayController

> ID：14589492
> 
> 赞同：0
> 
> 时间：2013-01-29T18:14:56.357
> 
> 标签：objective-c, loops, nsarraycontroller

我需要按特定顺序遍历 coredata 模型中的 NSArrayController。

可以说我的模型有这些列：

```
animal (string)
name (string)
age (int) 
```

我想像这样遍历控制器：

```
for (animal *a in myNsArrayController.arrangedObjects)
{
  // Rest of code
} 
```

但我需要按动物年龄排序……我该怎么做？

搜索没有给我带来任何可用的结果..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:44:02.300

试试这个，它以 AKV 的答案为基础，但使用您的代码并包含 for 循环。我认为这应该工作！

```
NSSortDescriptor *sort = [NSSortDescriptor sortDescriptorWithKey:@"age" ascending:YES];
NSArray *sortedArray = [myNsArrayController.arrangedObjects sortedArrayUsingDescriptors:[NSArray arrayWithObject:sort]];
for (animal *a in sortedArray)
{
  // Rest of code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:19:25.753

首先根据动物年龄对数组进行排序。

然后循环遍历它。

```
NSSortDescriptor *sort = [NSSortDescriptor sortDescriptorWithKey:@"animalAge" ascending:YES];
[yourArray sortUsingDescriptors:[NSArray arrayWithObject:sort]]; 
```

编辑：

```
NSArray *yourArray=myNsArrayController.arrangedObjects; 
```

# javascript - 对淘汰赛js感到困惑

> ID：14589493
> 
> 赞同：20
> 
> 时间：2013-01-29T18:14:58.120
> 
> 标签：javascript, knockout.js

我遇到了这个敲除代码，我对以下代码的执行感到困惑：

```
 <!-- ko if: $parent.name == name -->
   <a data-bind='text: name'></a> 
   <!-- /ko --> 
```

这段代码不应该被解释为注释吗？

阅读文档： http:
[//knockoutjs.com/documentation/custom-bindings-for-virtual-elements.html](http://knockoutjs.com/documentation/custom-bindings-for-virtual-elements.html)
这看起来像自定义绑定？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-29T20:05:58.770

It's a knockout conditional comment. The HTML inside the comment block is only executed if the code validates to true. Knockout can read and process this comment for you. You don't have to do anything special. Simply supply the conditional and make sure the variables you reference do in fact exist. Then sit back and let knockout do the rest.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-30T05:03:30.140

它不是自定义绑定。您遇到的是[淘汰赛的文档](http://knockoutjs.com/documentation/custom-bindings-for-virtual-elements.html)所称的“虚拟元素”，它是应用于一段代码而不是元素的绑定。如果您想有条件地评估（即绑定到您的视图模型）DOM 的一部分，您可以将其放在带有`if`绑定的 div 中，也可以将其放在类似的注释中。

HTML 注释是 DOM 的一部分，因此没有什么可以阻止敲除检索和解释它们。

# javascript - 有什么更好的方法来创建适用于多行的下拉菜单？

> ID：14589501
> 
> 赞同：0
> 
> 时间：2013-01-29T18:15:08.980
> 
> 标签：javascript, jquery, html

在主要浏览器中创建与多行一起使用的下拉菜单有什么更好的方法？

谢谢！

像这样：

```
-------------
- Example 1 -
-   and     -  This is one item
- Example 2 -
-------------
-------------
- Example 3 -
-   and     -  This is another item
- Example 4 -
-------------
-------------
- Example 5 -
-   and     -  and this is another item
- Example 6 -
------------- 
```

给我同样的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T19:01:07.760

你只是在寻找

```
<br /> 
```

您会在每个文本框之后放置 html 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:52:37.890

`<br />`是一种解决方案。另一种方法是将每个控件包装在一个 div 类中并对其应用 css。从长远来看，使用 div 和 css 可以让您更好地控制。

```
//css
.coolClass
{
float:left;
}
//EndCss

<div class='coolClass'>
<asp:label>name</asp:label>
<asp:textobox runat='server' id='test1'/>
</div> 
```

# asp.net-mvc - 主页上的主要路线

> ID：14589506
> 
> 赞同：0
> 
> 时间：2013-01-29T18:15:14.923
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我需要创建一条路线，用户可以在其中打开特定页面，例如

[http://www.mywebsite.com/profilename](http://www.mywebsite.com/profilename)

输入此内容后，应显示将显示具有正确信息的配置文件的页面。基本上像脸书。

我需要创建的路线是什么。我这样做了，但是当例如有人键入[http://www.mywebsite.com/users](http://www.mywebsite.com/users)时会出现一个重定向循环，例如显示用户列表

```
 routes.MapRoute(
        name: "HomeIndexWithParam",
        url: "{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:49:21.323

您将需要创建几条路线才能使其正常工作。使用路线时，请记住顺序很重要，因此首先放置最具体的路线。

首先，您将为预定的控制器创建路由。这些路线始终相同。在这种情况下，“用户”路线：

```
routes.MapRoute(
    name: "Users",
        url: "users",
        defaults: new { controller = "Users", action = "Index" }); 
```

然后，您将遵循负责用户配置文件的路线：

```
routes.MapRoute(
        name: "UserProfile",
        url: "{username}",
        defaults: new { controller = "User", action = "Profile" }); 
```

我建议如果“用户名”遵循预定模式（用户名介于 4 到 16 个字符之间，只允许数字和文本等），则添加一个约束，以便它仅在满足约束时执行

在用户控制器的 Profile 操作方法中，您将获取用户名，如果找到用户名，则返回用户个人资料页面的视图。否则将用户重定向到主页。

最后，您将拥有默认路由：

```
routes.MapRoute(
        name: "Home",
        url: "",
        defaults: new { controller = "Home", action = "Index" }); 
```

希望这是有道理的。

# android - 在 Eclipse 中设置 Cocos2D 和 JBox2D

> ID：14589509
> 
> 赞同：0
> 
> 时间：2013-01-29T18:15:20.133
> 
> 标签：android, cocos2d-android, jbox2d

我正在尝试使用[Cocos2D-android](http://code.google.com/p/cocos2d-android-1/wiki/Using)和[JBox2D](http://www.jbox2d.org/)制作一个 Android 应用程序。我找到了几个教程并下载了示例代码，它运行良好，我可以在它的基础上进行构建，但是我无法找到关于如何实际设置我自己的新项目的明确说明。

我能看到的只有：

1.  在工作区中导入 cocos2d。
2.  转到项目属性并将 cocos2d 标记为库。
3.  现在创建您的项目并在项目属性中添加 cocos2d 库。
4.  如果您使用的是 box2d，则可能必须将 .so 添加到您的项目中，例如 cocos(libs/...)。

“在工作区中导入 cocos2d”是什么意思？

当我在 Eclipse 中单击导入时，它不允许我导入 .jar 文件。我尝试以我知道的方式添加 .jar：properties->Java Build Path->Add External Jars 但它不起作用（我不能以这种方式使用 Cocos2D 库）我不确定我是否理解 2- 3 要么。

有人可以在这里详细说明吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T05:18:13.897

好吧，有了[这个 jBox2D jar](http://code.google.com/p/jbox2d/downloads/list)和[这个 cocos2d-android jar](https://github.com/ZhouWeikuan/cocos2d/tree/master/cocos2d-android/libs)，事情就按预期工作了，只需将 jar 添加到 eclipse 中的 libs 文件夹中，然后右键单击每个 jar ->“构建路径”->“添加到构建路径。

# wpf - 如何使用不同类型的对象的二维数组进行数据绑定

> ID：14589511
> 
> 赞同：2
> 
> 时间：2013-01-29T18:15:53.600
> 
> 标签：wpf, xaml

我有几个单独但相关的问题，而且我是 WPF 的新手，所以请耐心等待。

我有一个 IFarmyardSpaces 的二维数组，其中一些是 FenceSpaces，一些是 FieldSpaces，等等。我基本上想要一个绑定到每个这些空间的按钮网格，并根据 IFarmyardSpace 的类型使用适当的按钮样式。

现在的问题是：1）是否可以轻松地将本质上是棋盘类型的布局进行数据绑定，并让各个项目以不同的方式自行设置样式？

2）如果没有，我需要单独创建和绑定按钮，如何将按钮绑定到二维数组中的特定对象？就像我想要一个绑定到 FarmyardSpaces[0,3] 中的 FenceSpace 的按钮？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:35:35.110

是的，您可以同时执行 1)。基础是您需要一个 ItemsControl，其中每个项目都是另一个 ItemsControl（获取行、列）。要改变模板，最简单的方法是使用具有 DataType 且没有 Key 的 DataTemplate 资源，而不是显式分配 ItemTemplate。您也可以使用 DataTemplateSelector，但这需要更多代码。您的模板看起来像这样：

```
<Window.Resources>
    <DataTemplate DataType="IFarmyardSpaces">
        <Button Style="..."/>
    </DataTemplate>
    <DataTemplate DataType="FenceSpaces">
        <Button Style="..."/>
    </DataTemplate>
</Window.Resources> 
```

而像这样的ItemsControl，这里使用UniformGrid来得到一个均分的网格布局：

```
<ItemsControl ItemsSource="{Binding TwoDArray}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid Columns="1"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <ItemsControl ItemsSource="{Binding}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Rows="1"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
            </ItemsControl>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

可能会出现复杂情况，例如如果数组大小不同时对齐，或者如果您在另一个控件上绑定相同类型，则模板会在其他地方应用，但这至少应该让您开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:19:39.830

您可以使用 IValueConverter 来完成。我在 Windows 8 Metro 应用程序中完成了这项工作，并在博客中对此进行了介绍：http: [//jwillmer.de/blog/2012/11/02/how-to-display-different-items-in-a-gridview/](http://jwillmer.de/blog/2012/11/02/how-to-display-different-items-in-a-gridview/)

在 MSDN，我找到了 IValueConverter 的另一个示例：http: [//msdn.microsoft.com/en-us/library/windows/apps/BR209903](http://msdn.microsoft.com/en-us/library/windows/apps/BR209903)我希望它有助于解决您的问题 ;-)

# javascript - AngularJS的基本可拖动？

> ID：14589516
> 
> 赞同：24
> 
> 时间：2013-01-29T18:16:01.690
> 
> 标签：javascript, jquery, angularjs

我不想要可拖动的可排序元素或任何花哨的东西，只是一个可拖动的元素，就像一个普通的 jQuery div 可拖动对象：

```
$("#draggable").draggable(); 
```

通过Angular做到这一点的正确方法是什么？我仍然使用 jQueryUI，还是在 AngularUI 中有什么可以使用的？我查看了这两个 Angular 库，但没有找到任何专门针对可拖动对象的内容。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-01-29T18:21:17.420

使用指令。

例子：

```
angular.module("myApp").directive('andyDraggable', function() {
  return {
    restrict: 'A',
    link: function(scope, elm, attrs) {
      var options = scope.$eval(attrs.andyDraggable); //allow options to be passed in
      elm.draggable(options);
    }
  };
}); 
```

HTML

```
<div andy-draggable>Drag me!</div>
<div andy-draggable="{key: value}">Drag me with options!</div> 
```

指令文档： http: [//docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

您还可以在拖动、连接事件等期间为元素的当前位置创建数据绑定。但这是一个非常基本的版本。

# hibernate - hibernate xml映射设置错误

> ID：14589517
> 
> 赞同：1
> 
> 时间：2013-01-29T18:16:06.153
> 
> 标签：hibernate, hibernate-mapping

我想在 Car 和 CarDetails 之间实现一对多的关系。所以一辆车可以有多个 CarDetails

我一直收到这个错误：

```
The content of element type "set" must match "(meta*,subselect?,cache?,synchronize*,comment?,key,(element|one-to-many|many-to-many|composite-element|many-to-any),loader?,sql-insert?,sql-update?,sql-delete?,sql-delete-all?,filter*)". 
```

所以这是我的 Car.hbm.xml

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="at.opendata.entitys">      
    <class name="Car" table="Cars">

        <id name="id" column="Car_Id">
            <generator class="increment"/>
        </id>
        <set name="carDetails" table="cardetail" cascade="all">
            <key column="detail_id"/>           
            <one-to-many class="at.opendata.entitys.CarDetail"/>
        </set>  
        <property name="name"/>
        <property name="vin"/>      
        <property name="location" type="org.hibernate.spatial.GeometryType" column="location"/>

    </class>    
</hibernate-mapping> 
```

# vb.net - Entity Framework 4 的扩展方法

> ID：14589518
> 
> 赞同：1
> 
> 时间：2013-01-29T18:16:09.677
> 
> 标签：vb.net, linq, entity-framework, expression-trees

我使用实体框架实体的扩展方法：

```
 <Extension()>
    Public Function IsExcluded(ByVal item As AnomalyProduct) As Boolean

        Dim result As Boolean

        If (item.WholesalerProductCode IsNot Nothing) AndAlso (item.WholesalerProductCode = _excludedChar) Then
            result = True
        Else
            result = False
        End If

        Return result

    End Function 
```

我想根据扩展方法结果获取实体列表：

```
 Private Function HasPacksExcluded(ByVal contextId As Guid) As Boolean

        Dim result As Boolean
        Dim context As ContextManager.ContextData
        Dim repo As ILancelotLabEntities

        context = _context.GetContext(contextId)
        repo = context.RepositoryContext

        result = repo.AnomalyProducts.ToList.Where(Function(p) p.IsExcluded).Any

        Return result

    End Function 
```

但是通过这种方式，我需要从数据库中加载所有**AnomalyProducts 。**最终得到一个布尔值需要很长时间。

我认为表达式树可以帮助我，但我无法做到这一点。

一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:27:50.797

您只能对内存中的数据执行此操作。当您在 Where（或任何其他）子句中放置一些 linq 时，实体框架会将其转换为 T-SQL。

这不能翻译成任何 T-SQL：

```
repo.AnomalyProducts.Where(Function(p) p.IsExcluded).Any 
```

这可以（因为您正在内存中获取所有数据：

```
repo.AnomalyProducts.ToList.Where(Function(p) p.IsExcluded).Any 
```

为了尽量减少工作量，您可以创建一个表达式（这是 Where 子句所期望的）并使用它。这只会最大限度地减少您必须复制和粘贴代码的位置。

```
Dim exp As Expression(Of Func(Of AnomalyProduct, Boolean)) = Function(a) Not String.IsNullOrEmpty(a.WholesalerProductCode) AndAlso a.WholesalerProductCode <> _excludedChar
repo.AnomalyProducts.Where(exp).Any 
```

我没有测试过它，但它应该工作得很好。

# ruby-on-rails-3 - 在观察者中使用翻译

> ID：14589521
> 
> 赞同：0
> 
> 时间：2013-01-29T18:16:15.250
> 
> 标签：ruby-on-rails-3, activerecord, internationalization, observers

我开始通过将通知邮件的发送外包给观察者来清理我的模型和控制器。

通过将它从控制器移动到观察器，我注意到一个问题：如果我调用“翻译”或简写“t”，我会得到答案“方法未定义”

好的，我真的很喜欢国际化的 Rails 实现。但是如何在模型和观察者中使用它呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:47:01.317

您可以通过 I18n 对象调用该方法：

```
I18n.t :whatever 
```

# javascript - Ajax 跨域半工作（xhr）

> ID：14589522
> 
> 赞同：0
> 
> 时间：2013-01-29T18:16:16.417
> 
> 标签：javascript, html, xmlhttprequest, openstreetmap, mapquest

我使用 xhr 对象从 mapquest 开放 API（Nominatim 和 Directions）获取信息。

我的问题是它适用于 Nominatim 服务，但不适用于 Directions（使用 Firefox 最新版本测试）。我的就绪状态为 4，但状态为 0，并且它永远不会改变。

这是我的代码：

```
var xhr;
try
{ 
 xhr = new ActiveXObject('Msxml2.XMLHTTP');
}
catch (e)
{
    try
    {  
        xhr = new ActiveXObject('Microsoft.XMLHTTP');
    }
    catch (e2)
    {
        try
        { 
            xhr = new XMLHttpRequest();
        }
        catch (e3)
        { 
            xhr = false;
        }
    }
}

xhr.onreadystatechange  = function()                                   
{                                     
    if(xhr.readyState  == 4)
    {
        if(xhr.status == 200)
        {
            alert(xhr.responseText);
        }
    }
};

xhr.open("GET", "http://open.mapquestapi.com/directions/v1/route?format=json&routeType="+routeType+"&timeType=0&enhancedNarrative=false&shapeFormat=raw&generalize=200&locale=fr_FR&unit=k&from="+latitude+","+longitude+"&to="+json[0].lat+","+json[0].lng+"&narrativeType=none", true);
xhr.send(null); 
```

URL 中的所有参数都在上面的代码中定义。

我只是不明白它为什么会起作用（因为它不应该因为这些请求是跨域的）以及为什么它适用于 nominatim 而不是方向！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T00:01:09.523

Nominatim 支持[CORS](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)（允许浏览器对 Nomatim API 进行跨域请求）。Mapquest 没有，正如mapquest 论坛上的[评论所暗示的那样。](http://developer.mapquest.com/widget/web/products/open/forums/-/message_boards/view_message/279948)

# c++ - C++ 异常处理的最佳实践是什么？

> ID：14589525
> 
> 赞同：14
> 
> 时间：2013-01-29T18:16:23.597
> 
> 标签：c++, exception, logging, exception-handling, coding-style

我在网上搜索了很多关于这个主题的文章。但是，我发现没有完整的清单来验证我们的代码的异常安全质量。

因此，我想从您那里收集有价值的 C++ 异常处理最佳实践。

我先列出一些我自己的做法：

1.  如果在析构函数中有任何异常，则捕获所有异常：

    ```
    struct A
    {
        ~A()
        {
            try
            {
                // Here may throw exceptions
            }
            catch (std::runtime_error& e)
            {}
            catch (...)
            {
                logging("...");
            }
        }
    }; 
    ```

2.  在异常信息中添加函数名、源文件名和行号。`__func__`，`__FILE__`并且`__LINE__`是好朋友。

3.  永远不要使用异常规范。原因在《C++ 编码标准》一书中给出。

你的是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-29T18:24:03.217

我知道这可能更适合作为评论而不是作为答案，但由于我链接的资源回答了你*所有*的问题**等等**，我认为也可以将它作为答案发布，只是为了给它更多可见性和/或相关性。

而且由于我不可能把它总结得比原来的更好，我什至不会尝试做一个简短的总结，因为我会冒着扭曲它或给出有偏见的概述的风险。

只需观看**[Jon Kalb 关于异常安全编码的两部分演讲](http://www.exceptionsafecode.com/)**。就是这样。

# .net - 使用浮点值进行单元测试

> ID：14589535
> 
> 赞同：1
> 
> 时间：2013-01-29T18:17:00.793
> 
> 标签：.net, unit-testing, testing, floating-point

我创建了一个类`Matrix`来对浮点矩阵进行数学运算（基本运算，逆运算，...）。

浮点精度使测试它们变得困难。通常，如果测试逆运算，如果矩阵的行列式接近于零，则误差可能很大。

如何对这些操作进行单元测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:59:24.943

有许多选项可能适合您的目标。

对于每个单独的输出元素，您可以根据对其有贡献的输入值设置该元素中允许的误差。（在复合运算的情况下，例如乘以矩阵，然后乘以它的逆矩阵，您仍将根据对最终值有贡献的所有值来设置容差。）

您可以选择行列式不接近零的输入矩阵进行测试。

您可以计算结果矩阵与理想结果的距离，并确定该距离是否超出您的误差容限，而不是测量单个元素中的误差。（例如，将两个矩阵相减，将元素的平方相加，然后取平方根。有关“距离”的其他概念和矩阵运算中的误差，请参考[此页](http://netlib.org/scalapack/slug/node135.html)。）

请记住，测试的目的是发现错误。这表明如果阈值小于错误可能导致的任何差异的大小，则可以使用非常大的容错度。也就是说，考虑代码中可能出现的错误类型：对错误元素的引用、数组外部的引用、操作遗漏等等。通常，这些错误会导致结果出现非常大的错误。只要您的测试捕捉到这些错误，它们就达到了它们的目的。

理想情况下，您会将运算的计算结果与理想结果进行比较，而不是反转运算并与原始输入进行比较。如果理想结果不可用，您可以使用扩展精度与更精确的计算结果进行比较。如果这通常不可用，那么您可以使用一组准备好的表现良好的矩阵进行比较，例如在各种位置（以及其他地方为零）只有几个简单元素（例如，小整数）的矩阵。将使用不同的输入矩阵重复每个测试，以便组合测试集涵盖必要的情况。但是每个测试都会有简单的输出，预期很少或没有舍入误差。

# sql-server - 转换存储在 SQL Server 的 VARCHAR 字段中的数字

> ID：14589541
> 
> 赞同：1
> 
> 时间：2013-01-29T18:17:20.127
> 
> 标签：sql-server

我有一个表，其中的付款存储在一个类型的列中`VARCHAR`

这是来自该领域的示例数据：

```
10.01
55.11 
```

最近，作为新请求的一部分，我们不得不从我们存储在`VARCHAR`列中的数字中删除小数点。

所以，我有这个：

```
CONVERT(BIGINT, CONVERT(REAL, RTRIM(LTRIM(@amt))) * 100) as PaymentAmount 
```

转换为`REAL`（不能转换为`BIGINT`from `VARCHAR`），乘以 100 然后转换为`BIGINT`

现在的问题是，有时在转换过程中，最终结果会少 1 美分。

示例：`'10.11'`转换为`1010`,`10.15`到`1014`

简单的测试方法：

```
SELECT CONVERT(BIGINT, CONVERT(REAL, RTRIM(LTRIM(10.15))) * 100) as PaymentAmount 
```

查询的结果是`1014`。

我通过将转换从`REAL`to`FLOAT`和删除转换为`BIGINT`.

另一种解决方法是`CAST`像这样使用：

```
CAST(@amt as float)*100  as PaymentAmount 
```

我使用从`10.00`到`10.99`和在 100 个值范围内的数字进行转换，**错误**的数字是：

*   `10.11`转换为`1010`
*   `10.15`转换为`1014`
*   `10.19`转换为`1018`
*   `10.23`转换为`1022`

该范围内的所有其他值都很好。奇怪的是，`11.11`转换为`1111`.

所以问题是，到底为什么要这样做，模式是什么？从[DataType MSDN](http://msdn.microsoft.com/en-us/library/ms187752.aspx) REAL 不是一个精确的数字，但 FLOAT 也是如此，但 float 适用于整个范围。

编辑：我没有提到`varchar`大小为 1000。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:34:26.920

你得到了转换差异，因为就像你说的那样，`REAL`这不是一个精确的数字......

您可能会看到 和 之间的差异`REAL`，`FLOAT`因为每种类型都有不同的*尾数*，这将导致精度损失不同。我相信您可以找到一个不同的数字，这会导致在使用`FLOAT`.

如果您想了解更多这些浮点类型的内部工作原理，请查看[每个计算机科学家应该了解的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

但除了转换差异之外，您的解决方案还有很多问题......

如果这些是付款...为什么要将金额存储在`VARCHAR`字段中，没有小数点？这为该数据引入了许多完整性问题的可能性。

接下来，[`MONEY`数据类型](http://msdn.microsoft.com/en-us/library/ms179882.aspx)不是更适合存储...你知道...钱的数据类型吗？

接下来，为什么不能直接从`VARCHAR`to转换`BIGINT`？ [这是一个完全有效的转换](http://msdn.microsoft.com/en-us/library/ms187928.aspx)：

```
DECLARE @amt VARCHAR(50)
SET @amt = ' 1001'
SELECT CONVERT(BIGINT, @amt*100) as PaymentAmount 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T18:34:42.507

```
declare @amt varchar(1000)
set @amt = '10.15'

select cast(replace(@amt, '.', '') as bigint) 
```

[SQL小提琴](http://sqlfiddle.com/#!6/d41d8/2217)

# powershell - Powershell比较巨大的文档目录树，只移动新的和更新的

> ID：14589543
> 
> 赞同：1
> 
> 时间：2013-01-29T18:17:26.080
> 
> 标签：powershell, robocopy

为文档管理系统的服务器之间移动 70k 文件制定计划。我相信今天存在 1200 个文件夹。

做初始副本是不费吹灰之力的。XCopy 或 RoboCopy。

如何识别任何新文件以及同一文件的较新版本？文档是基于 AutoCAD 的。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:05:16.883

查看 xcopy 的 /D 参数：

```
/D:mm-dd-yyyy 
```

复制在指定日期或之后更改的文件。 **如果没有给出日期，则仅复制源日期/时间比目标时间新的文件。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T19:16:01.543

`robocopy SRC DST /l`将列出双方所有新的和更改的文件。添加`/e`以包括新的空文件夹。添加`/it`以包含调整后的文件（大小和日期相同，但属性不同）。

# javascript - 通过引用添加两个数组

> ID：14589547
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:17:32.483
> 
> 标签：javascript, arrays, reference

我有两个数组，我将它们实例化为对象。我想连接这两个数组，我想通过引用来做。有没有办法做到这一点？我知道对象是通过引用的，但据我所知。

```
// array 1
function gdb() {
    this.data = [{
        "id":"AA",
        "pos": "0"
    },
    {
        "id":"AB",
        "pos":"3"
    }
    ]
    ;
}

// array 2
function xdb() {
    this.data = [{
        "id":"CM",
        "pos": "4"
    },
    {
        "id":"CR",
        "pos":"7"
    }
    ]
    ;
}

// arrays combined
function gdb() {
    this.data = [{
        "id":"AA",
        "pos": "0"
    },
    {
        "id":"AB",
        "pos":"3"
    },
    {
        "id":"CM",
        "pos": "4"
    },
    {
        "id":"CR",
        "pos":"7"
    }
    ]
    ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:39:32.860

要连接数组，只需使用他们的[`concat`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/concat)。不过，我不确定您所说的“通过引用”是什么意思。新数组（包含所有值）属性将指向与之前两个单独数组的属性相同的对象。但是，如果将新对象分配给旧数组属性，则新数组不会改变，这是完全不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:48:25.943

数组是对象，默认情况下通过引用传递。我不确定您是否尝试将这些函数用作构造函数（看起来像）。这是你需要的吗？

```
function ConstructorOne() {
    this.data1 = [
        {"id":"AA", "pos":"0"},
        {"id":"AB", "pos":"3"}
    ];
}

function ConstructorTwo() {
    // Inheritance 
    ConstructorOne.call(this);

    this.data2 = [
        {"id":"CM", "pos":"4"},
        {"id":"CR", "pos":"7"}
    ];
}

var obj = new ConstructorTwo();
obj.data = obj.data1.concat(obj.data2);

// Delete old ones if not needed - don't otherwise
//delete obj.data1;
//delete obj.data2;

// Making changes to the data property, will also 
// change data1 & data2 from the constructors, proving 
// that data is just a reference of data1 + data2
obj.data[2]['id'] = "PIZZA";
obj.data[1]['id'] = "APPLE";
obj.data[0]['id'] = "LETTUCE";

console.log(obj); 
```

# php - 加载大量数据的长时间运行的php脚本

> ID：14589549
> 
> 赞同：0
> 
> 时间：2013-01-29T18:17:39.940
> 
> 标签：php

我有一个 PHP 脚本只会在生产 Web 服务器上运行一次。该脚本加载大量数据库记录，然后对其进行迭代，对字段进行 json_decoding 并对其进行检查。一些字段将被修改并保存回数据库。

该脚本将消耗大量内存并可能运行 1 小时或更长时间。

对于这种类型的脚本，我应该记住什么，以确保它不会导致网站宕机或此类脚本的任何其他潜在危害。

脚本的基本流程如下：

```
1\. load all records from db table
2\. iterate over each row
  2.1 json_decode specific field
  2.2 if a matching field is found then
      2.2.1 Change the value 
      2.2.2 Save back to the database 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:24:26.277

确保使用 Cron 作业等设置它，并在低负载时间运行它。这取决于您网站的用户，因此您必须分析您的访问以确定什么是好的窗口。

如果这只需要运行一次，则为访问者发布维护窗口通知可能是有意义的。这将使他们能够提前计划，不要期望在给定时间之间有一个超级响应的站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:48:27.813

需要考虑的一些重要的数据库因素。

最后，我将在第 2 阶段之外的数据库事务中进行所有更新，而不是循环。

您应该查看您的数据库引擎，看看它是否使用行/表锁定。如果数据在其他地方使用，这肯定会阻止数据被读取/写入。

我不知道您的数据集，但以下是一些有助于提高脚本速度的想法......

使用 isset() 而不是 array_key_exists() 作为数组键要快得多，但要注意 NULL 值。

也许从数据库中散列键并将其与新数据集的散列进行比较。只需要检查一个值而不是每行中的多个值。可以节省大量迭代或关键检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:22:43.563

如果您正在处理大量数据和一些繁重的处理，并且您主要关心的是维护服务器对其他任务的可用性（例如为网站提供服务），您可能需要考虑将任务拆分为更小的块并有一个 cron 作业定期处理每个作业。

除此之外，您绝对应该看一下该[`set_time_limit()`功能](http://php.net/manual/en/function.set-time-limit.php)。有了它，您可以通过传递零值来确保您的脚本不会超时 -

```
set_time_limit(0); 
```

# javascript - JavaScript 空指针异常：为什么我动态创建的 iFrame 的 contentWindow 和 contentDocument 总是为空？

> ID：14589550
> 
> 赞同：2
> 
> 时间：2013-01-29T18:17:50.463
> 
> 标签：javascript, html, iframe

我使用 jQueryMobile 创建了一个单页网站。

“一页”是指整个网站只包含一个 index.html 文件，而不同的内容通过锚点显示，例如

*   index.html#开始
*   index.html#contact
*   index.html#aboutus
*   等等...

我通过 JavaScript 创建了一个 iFrame，如下所示：

```
var iframe = $("<iframe>").addClass("myframe").appendTo(container).get(0);
var iframeDoc = (iframe.contentDocument) ? iframe.contentDocument : iframe.contentWindow.document; 
```

在第 2 行中，我得到一个异常，其中指出：

> 未捕获的类型错误：无法读取 null 的属性“文档”

这似乎来自这个电话：

```
iframe.contentWindow.document 
```

所以，显然，两者`iframe.contentWindow`都是`iframe.contentDocument`空的。

现在出现了奇怪的部分：这只发生在其中一个锚上

示例：如果我使用 URL index.html#start 直接跳转到网站，一切正常，但在 index.html#aboutus 上，我得到了上面提到的异常。

请不要问我这两个主播有什么区别。它们完全不同，我不知道从哪里开始调试。

现在，我的问题是：为什么上面的代码不能在锚#aboutus 上运行，但在锚#start 上运行？

* * *

**更新：**为您提供更多信息：

1.  我想动态填写 iframe 的内容，**而不**使用*src*属性，而是使用 iFrameDoc.write() 函数。如您所见，您需要 iframe 文档，该文档为空。这种方法适用于其他锚点，但不适用于我的一个特定锚点“站点”。

    iframeDoc.open(); iframeDoc.write('Foo'); iframeDoc.close();

2.  我还尝试等待一段时间，直到 iframe 加载完毕。

结果还是一样

```
var iframe = $("<iframe>").addClass("myframe").appendTo(container).get(0);
setTimeout(function(){
var iframeDoc = (iframe.contentDocument) ? iframe.contentDocument : iframe.contentWindow.document;
}, 3000); 
```

“加载”事件甚至没有被触发，因为还没有内容写入 iframe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T10:59:48.037

我终于找到了问题的根源。存储在变量“容器”中的元素未正确附加到 DOM 树。这就是为什么 iframe 也不是 dom 的一部分并且没有创建文档的原因。

# c - 简化 looooong 表达式。有什么工具吗？

> ID：14589552
> 
> 赞同：0
> 
> 时间：2013-01-29T18:17:55.777
> 
> 标签：c, formatting

我正在做这个让大脑麻木的任务，我必须像这样简化 loooooong 表达式：

```
coef = ((((((((((inv_nrg >> 16) * (int)((short)nl)) + (((inv_nrg & 0x0000FFFF) * (int)((short)nl)) >> 16)))) + ((inv_nrg * ((16 == 1 ? (nl >> 1) + (nl & 1) : ((nl >> 15) + 1) >> 1)))))) >> 16) * (int)((short)(1024 << 1))) + ((((((((((inv_nrg >> 16) * (int)((short)nl)) + (((inv_nrg & 0x0000FFFF) * (int)((short)nl)) >> 16)))) + ((inv_nrg * ((16 == 1 ? (nl >> 1) + (nl & 1) : ((nl >> 15) + 1) >> 1)))))) & 0x0000FFFF) * (int)((short)(1024 << 1))) >> 16));
  } 
```

一定有一个工具可以把上面的表达方式，咀嚼一下，吐出一个更干净，更简单的表达方式？

请帮帮我——我的大脑快麻木了！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:35:11.497

将其分解为多个部分（并让编译器担心对其进行优化）

例如，您可以分配`inv_nrg >> 16`给一个变量`inv_nrg_high`。一样`inv_nrg & 0x0000ffff`_`inv_nrg_low`

一些数字常量也可以简化——(1024 << 1) 可以替换为实际值。

那里也有一些“死”的表达式`(16 == 1? stuff1 : stuff2 )`可以替换为，`stuff2`因为 16 永远不等于 1。

我会让你做实际删除所有多余的括号并替换变量的驴工作。这是完全有可能的，我已经完成了大部分工作，只是为了看看它做了什么[对我来说毫无意义，但没关系]。

编辑：花了几分钟，我想出了这个：

```
int inv_nrg_high = inv_nrg >> 16;
int inv_nrg_low  = inv_nrg & 0xFFFF;
int nl_sh_p1_sh     = ((nl >> 15) + 1) >> 1;
int x = ((inv_nrg_high * nl)) + ((inv_nrg_low * nl)) >> 16;
int y = (x + inv_nrg * nl_sh_p1_sh);

coef = ((y >> 16) * 2048) + ((y & 0x0000FFFF) * 2048) >> 16); 
```

[我不是 100% 确定它是正确的，但也不是那么遥远。

[它看起来像是来自 C 预处理器的东西，可能是一些复杂的定点数学或类似的结果]

# python - Google YouTube API v3 引发 503 后端错误

> ID：14589553
> 
> 赞同：4
> 
> 时间：2013-01-29T18:18:02.283
> 
> 标签：python, google-api

我正在开发一个应用程序，它可以从某些网站上抓取歌曲，并通过 Google 的 Youtube API 以编程方式在 youtube 上“喜欢”它们。为了获得我正在寻找的视频 ID，我使用艺术家和歌曲名称执行谷歌搜索并解析结果。此过程运行良好并返回有效的视频 ID（我已经手动测试过它们）。我遇到问题的地方是我基于视频 ID“点赞”的代码，它本质上是直接从谷歌的 YouTube API Python 示例中复制的：

```
def likeVideo(youtube, video_id):
    channels_list_response = youtube.channels().list(
      mine=True,
      part="contentDetails"
    ).execute()

    # Adding a video as a favorite or to the watch later list is done via the
    # same basic process. Just read the list id of the corresponding playlist
    # instead of "likes" as we're doing here.
    liked_list_id = channels_list_response["items"][0]["contentDetails"]["relatedPlaylists"]["likes"]

    body = dict(
      snippet=dict(
        playlistId=liked_list_id,
        resourceId=dict(
          kind="youtube#video",
          videoId=video_id
        )
      )
    )
    youtube.playlistItems().insert(
      part=",".join(body.keys()),
      body=body
    ).execute()

    print "%s has been liked." % video_id 
```

但是，我的应用程序抛出了这个错误：

```
apiclient.errors.HttpError: <HttpError 503 when requesting https://www.googleapis.com/youtube/v3/playlistItems?alt=json&part=snippet returned "Backend Error"> 
```

通过谷歌开发论坛搜索显示这可能是谷歌的服务器端问题，但我不确定我的具体情况。任何人都看到什么可能是错的？

编辑：过去几天我一直在使用这个应用程序，它似乎工作得还不错；很少有 503 错误...但是，此时通常每个会话只执行一个 API 请求。当我第一次遇到错误时，它正在执行大约 6 个批处理。在执行批处理请求时是否发生了我应该考虑的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T15:13:05.420

它不会让我评论你的问题，我并不认为这是一个答案，但也许只是需要考虑的事情。前段时间我在做一个项目，我有一个 CSV 列表，里面有 youtube 视频 URL。我想将视频的标题放在我的 CSV 列表中的 URL 旁边。鉴于页面的标题是视频的标题，我利用 URLLIB 从列表中的 URL 中抓取页面，抓取标题，将其放入我的列表中，然后循环浏览下一个，下一个，等等等等。无论如何，我只得到了部分结果！其中只有一半有效。好吧，事实证明我用 URLLIB 访问 youtube 的速度太快了，他们的服务器一定是在限制我或者其他什么，我实现了一个 5-15 秒的计时器并得到了不同的结果。我在每个视频之间做了 15 秒，我能够得到每个页面的标题。现在授予您使用我一无所知的youtube API，但也许通过他们的API调用youtube数据也会以某种方式受到限制？我只是在这里吐痰，很抱歉将其发布为答案，但我似乎找不到评论按钮！

编辑 - 要尝试使这看起来更像是一个答案，请尝试利用时间模块在 API 调用之间休眠。

```
while 0 == 0
  likeVideo(youtube, video_id)
  time.sleep(15) 
```

希望这会有所帮助，或者至少其他人可以。祝你好运！

# php - 仅在特定时间特价

> ID：14589555
> 
> 赞同：0
> 
> 时间：2013-01-29T18:18:06.753
> 
> 标签：php, magento, magento-1.7

我正在尝试为仅在特定时间和日期内适用于自身的产品创建目录价格规则或特价。

例如，某些类别 X 的产品应该在星期一 15:00 至 20:00 之间有特价。其他Y类产品在周四20:00-24:00有特价。

这应该发生在每个弱者没有激活或每周生成新规则的情况下。

我的第一种方法是生成“目录价格规则”并生成我自己的自定义属性字段“时间从”和“时间到”，但我没有找到教程或类似的东西来在目录价格规则生成中创建自定义属性.

我希望有人可以帮助我。

问候

狼3r

*编辑：* 也许还有另一种使用 cronjob 的方法，但我不知道如何执行代码来启用和禁用价格规则。

*Edit2：* 忘记 cron-jobs。我的供应商不支持这些...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:27:06.673

最好的方法是设置优惠券代码。[你可以在这里](http://www.magentocommerce.com/knowledge-base/entry/setting-a-coupon-code-to-your-promotions)找到如何做

或者（不建议）看到[这里](http://www.magentocommerce.com/boards/viewthread/16704/)- 我不知道你如何为一种产品定制这个，尽管它更像是当你有销售时。

**为了缓解“保存产品时规则消失”现象：**

1.  在 /app/code/core/Mage/CatalogRule/Model/ 中打开 Observer.php
2.  找到 applyAllRulesOnProduct() 方法
3.  在方法的最后，在“return $this;”之前，添加：

    $this->applyAllRules($this);

现在要解决仅在有限时间内有效的目录规则，（相同的过程，不同的方法）：

1.  确保 cron 已设置并正常工作。
2.  在 /app/code/core/Mage/CatalogRule/Model/ 中打开 Observer.php
3.  找到 dailyCatalogUpdate() 方法
4.  在方法的最后，在“return $this;”之前，添加：

    ```
    $this->applyAllRules( $this ); 
    ```

5.  打开 /app/code/core/Mage/CatalogRule/etc/config.xml

6.  找到 crontab > jobs > catalogrule_apply_all 区域
7.  改变

    ```
     <cron_expr>0 1 * * *</cron_expr> 
    ```

至

```
 <cron_expr>0 * * * *</cron_expr> 
```

# java - jprofiler 启用 CPU 数据启动

> ID：14589557
> 
> 赞同：0
> 
> 时间：2013-01-29T18:18:14.483
> 
> 标签：java, jprofiler

JProfiler 7.2.2 中的随附帮助指出：
**“除非在分析设置对话框的启动部分中选择了“启动时记录 CPU 数据”，否则必须通过单击手动启动数据采集...”**

我在配置文件设置对话框中没有“启动”部分，更不用说“在启动时记录 CPU 数据”复选框。
有人能帮忙吗？
我需要在启动时打开 CPU 分析，以便在我的 java 1.5 控制台应用程序中找到性能瓶颈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T08:57:48.957

请参见下面的屏幕截图，当您开始分析会话时会显示此对话框。

![在此处输入图像描述](../Images/78f92eb16bba703412814df364a6eeb6.png)

# ios - UINavigationItem touchView 触摸大小

> ID：14589561
> 
> 赞同：0
> 
> 时间：2013-01-29T18:18:20.427
> 
> 标签：ios, objective-c, uinavigationbar, uinavigationitem, uitapgesturerecognizer

我正在我的 UINavigationItem 的 touchView 上设置一个视图，并向它添加一个轻击手势识别器。奇怪的是，即使点击在视图之外，点击识别器也会被调用。知道为什么会发生这种情况吗？

```
UIView *testView = [[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 120.0f, 20.0f)];
testView.backgroundColor = [UIColor redColor];
UIGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(doStuff:)];
tapRecognizer.cancelsTouchesInView = YES;
[testView addGestureRecognizer:tapRecognizer];
testView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
self.navigationItem.titleView = testView; 
```

我可以在红框外点击，仍然触发手势识别器。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-29T18:22:49.180

用这种方式

```
UITapGestureRecognizer *tapRecognizer = 
  [[UITapGestureRecognizer alloc] initWithTarget:self 
                                          action:@selector(doStuff:)]; 
```

而不是这段代码

```
 UIGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(doStuff:)]; 
```

# ruby - 方法未定义？

> ID：14589564
> 
> 赞同：0
> 
> 时间：2013-01-29T18:18:31.257
> 
> 标签：ruby

我是红宝石新手。我试图做一个简单的方法（带参数）调用。

```
class MeowEncoder
    def method(c)
        puts c
        end
    end

print "please enter the thing you want"
s = gets.chomp()
MeowEncoder.method(s) 
```

它只是传递参数并打印出来。但是终端不断给我错误，比如

```
:MeowEncoder.rb:9: undefined method `toBinary' for MeowEncoder:Class (NoMethodError) 
```

这里发生了什么？

我做了一些增强。

```
class MeowEncoder
        def encode(n)
            toBianry(?n)
            puts ""
        end

        def toBinary(n)
            if n < 2
                print n
            else
                toBinary(n / 2)
                print n % 2
            end
        end
    end

    o = MeowEncoder.new

    print "please enter the thing you want: "
    s = gets.chomp()
    s.each_char{|c| o.encode(c)} #this doesn't work
    o.toBinary(212)  # this works 
```

我在这里做了一些改进。我尝试将 char 转换为它的 ASCII 值，然后转换为它的二进制形式。我可以制作单个 toBinary 作品。但是 Encode 方法也给了我同样的错误。发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:20:19.783

您定义了一个实例方法，但您试图在类对象上调用它。试试这个：

```
MeowEncoder.new.method(s) 
```

此外，对于一种方法来说，`method`这是一个**坏**名字。这将导致[名称冲突](http://ruby-doc.org/core-1.9.3/Object.html#method-i-method)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:44:37.973

为了扩展 Sergio 的答案，如果您真的想要在类上定义方法，有几种方法可以实现，但最直接的方法是在方法定义之前添加`self`如下所示：

```
def self.method(c)
  puts c
end 
```

这将允许您以当前方式调用该方法。

这个工作的原因是，在定义方法的上下文中，`self`设置为`MeowEncoder`类。相当于说：

```
def MeowEncoder.method(c)
  puts c
end 
```

这实际上是声明类方法的另一种有效方式，但使用`self`是更好的做法，因为如果您更改类的名称，重构会变得更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:54:39.350

而不是**each_char**使用**each_byte**并且不需要编码方法。

```
s.each_byte{|c| o.toBinary(c)} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-24T08:32:29.127

```
Book (title, author)
Author (pseudonym, first_name, last_name)
Book_catalog => collection of books
    methods
        add_book(book)
        remove_book(book)
        ​borrow_book(borrower, book)  => voeg boek toe aan borrower.books_borrowed
        return_book(borrower, book) => verwijder boek uit borrower.books_borrowed
        book_available?(book)
        search(title) => geeft gevonden book-object terug (anders nil)
Book_borrowing
    book (read-only), date_of_borrowing (read-only), date_of_return (read-only)
    borrow_book(book_to_borrow) : @date_of_borrowing = systeem-datum+uur
    return_book(book_to_return) : @date_of_return = systeem-datum+uur
Borrower
    member_nbr, first_name, last_name, books_borrowed = collection of Book_borrowing
    has_book_by_title(title) => geeft true of false terug
    has_book(book) => geeft true of false terug
Person(first_name, last_name) 
```

# javascript - 使用 HTML5 / JavaScript 访问 Amazon S3 上的文件

> ID：14589577
> 
> 赞同：2
> 
> 时间：2013-01-29T18:19:22.043
> 
> 标签：javascript, html, cordova, amazon-s3

是否可以使用 JavaScript / HTML5 访问 Amazon S3 上的文件。我基本上计划在 PhoneGap 应用程序中访问这些文件。

更具体地说，我的意思是中间没有任何服务器，即直接调用 Amazon S3。是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:22:06.027

是的。您可以为您的存储桶启用 CORS，以便可以通过`XMLHttpRequest`.

*   [http://aws.typepad.com/aws/2012/08/amazon-s3-cross-origin-resource-sharing.html](http://aws.typepad.com/aws/2012/08/amazon-s3-cross-origin-resource-sharing.html)
*   [http://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html)

当专门使用 PhoneGap/Cordova 时，您可以通过在应用程序中将域列入白名单来绕过在服务器上启用 CORS：

*   [http://docs.phonegap.com/en/2.3.0/guide_whitelist_index.md.html](http://docs.phonegap.com/en/2.3.0/guide_whitelist_index.md.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-19T09:10:12.153

回答我自己的问题 - 我想出了一个 JavaScript S3 请求签名者，使用它我能够签署 URL 并从 JavaScript 访问 S3 上的文件。

任何人需要任何详细信息，请发表评论并很乐意提供帮助。

干杯

# c - Sizeof Struct 成员在编译时技巧不起作用

> ID：14589584
> 
> 赞同：0
> 
> 时间：2013-01-29T18:19:37.793
> 
> 标签：c

在这里找到了这个答案： [sizeof a struct member](https://stackoverflow.com/questions/3864583/sizeof-a-struct-member)

将它完全复制到我的代码中，但我的编译器对象有一个指向不完整类类型的指针。

```
uint8_t clStructCount = sizeof(((struct ALMConfStr *) 0)->IntelRecsPerPg); 
```

我究竟做错了什么？我想在运行时将 clStructCount 设置为等于 IntelRecsPerPg 的值；我认为这是这样做的诀窍。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:27:06.260

您的结构的定义需要在编译器遇到您的 sizeof 代码时*可见*。

所以，这个翻译单元应该可以工作：

```
struct ALMConfStr {
  int IntelRecsPerPg[MagicNumber];
};
// ...
uint8_t clStructCount = sizeof(((struct ALMConfStr *) 0)->IntelRecsPerPg); 
```

无论是全部在一个文件中，还是结构在代码`#include`之前的标头 d 中`sizeof`。

然而，这：

```
struct ALMConfStr;
// ...
uint8_t clStructCount = sizeof(((struct ALMConfStr *) 0)->IntelRecsPerPg); 
```

不起作用，因为编译器不*知道*a`struct ALMConfStr`由什么组成，或者在那个上下文中 an`IntelRecsPerPg`可能是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:22:59.773

我认为没有定义`struct ALMConfStr`

或者`IntelRecsPerPg`不是`struct ALMConfStr`

说

```
struct ALMConfStr{
//some member variables
data_type IntelRecsPerPg;
//some more member variables
}; 
```

基本上`sizeof(((struct ALMConfStr *) 0)->IntelRecsPerPg)`试图得到

```
sizeof(IntelRecsPerPg) 
```

在结构中，假设结构在地址 0 处可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T19:09:33.413

从对无用的回答的评论中：

> 从我的头文件：

```
 typedef struct ALMConfStruct {
        uint8_t updateMode;
        uint8_t flashPgSize;
        uint8_t flashMaxPagesSize;
        uint8_t IntelRecsPerPg;
        fptr_t appResetAddr;
        uint16_t appEndAddr;
        uint8_t comIntf;
    }ALMConfStr; 
```

你的`struct`标签是`ALMConfStruct`和不是`ALMConfStr`，所以

```
struct ALMConfStr 
```

声明一个新的不完整`struct`类型。删除`struct`, 或`struct ALMConfStruct`在您的代码中使用以确定大小。

```
uint8_t clStructCount = sizeof(((ALMConfStr *) 0)->IntelRecsPerPg); 
```

或者

```
uint8_t clStructCount = sizeof(((struct ALMConfStruct *) 0)->IntelRecsPerPg); 
```

# ubuntu - xbindkey 可以模拟多个串行击键吗？

> ID：14589591
> 
> 赞同：2
> 
> 时间：2013-01-29T18:19:55.570
> 
> 标签：ubuntu, keyboard-shortcuts

假设我要指定 F1 连续做 2 件事，比如：

1.  提升我的浏览器窗口（也许使用 wmctrl - 它已经绑定到另一个键绑定，如 F8）
2.  将焦点移到选项卡 1（在我选择的浏览器中使用“Ctrl 1”实现）

xbindkey 语法可以实现这一点吗？像这样的东西：

```
"F8, Control + 1"
   F1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T11:53:32.727

Xbindkeys 将按键映射到命令。要让它模拟按键，您需要使用像[XMacro](https://apps.ubuntu.com/cat/applications/xmacro)这样的程序。

# javascript - Backbone-forms.js - 我可以像在 jQuery validate 中一样设置 minlength 还是让我在渲染主干表单后自行验证？

> ID：14589592
> 
> 赞同：0
> 
> 时间：2013-01-29T18:19:59.867
> 
> 标签：javascript, backbone.js, backbone-forms

这是我的表格：我可以在这个定义中设置验证规则，还是让我用条件语句手动验证它，还是已经内置了类似的东西？

为了学习目的，我想将 minlength 设置为 20，而无需我自己的条件。还是我应该通过将它们包含在插件文件中来扩展插件？

```
var form1 = new Backbone.Form({
schema: {
    country: { type: 'Select', options: ['UK', 'USA'] },
    city: { type: 'Select', options: cities.UK },
    message: { validators: ['required', 'message'] }
} 
```

}）。使成为（）;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:14:50.457

您可以将最小长度规则定义为正则表达式：

```
message: { validators: [ 'required', /.{20,}/ ] } 
```

[此处记录了](https://github.com/powmedia/backbone-forms#validation)所有验证选项。

# c++ - OpenCV，与教程中的代码匹配的特征

> ID：14589595
> 
> 赞同：10
> 
> 时间：2013-01-29T18:20:12.620
> 
> 标签：c++, opencv

我从 OpenCV 教程页面复制了[Feature Matching with FLANN](http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html#feature-flann-matcher)的代码，并进行了以下更改：

*   我使用了 SIFT 功能，而不是 SURF；
*   我修改了“匹配良好”的检查。代替

    ```
    if( matches[i].distance < 2*min_dist ) 
    ```

我用了

```
 if( matches[i].distance <= 2*min_dist ) 
```

否则，在将图像与其自身进行比较时，我会得到零匹配。

*   绘制关键点的修改参数：

    ```
    drawMatches( img1, k1, img2, k2,
                     good_matches, img_matches, Scalar::all(-1), Scalar::all(-1),
                     vector<char>(), DrawMatchesFlags::DEFAULT); 
    ```

[我从INRIA-Holidays dataset](http://lear.inrialpes.fr/~jegou/data.php)的 Ireland 文件夹中的所有图像中提取了 SIFT 。然后我将每个图像与所有其他图像进行比较并绘制匹配项。

但是，我在过去使用的任何其他 SIFT/Matcher 实现中从未遇到过一个奇怪的问题：

*   我与自己匹配的图像的匹配很好。除了一些关键点之外，每个关键点都映射到自身。见上图。![与自身匹配的图像](../Images/3f2a3dd9a741a95bdf4e2e892f36fdc8.png)
*   当我将 I 与另一个图像 J 匹配时（J 不等于 I），许多点被映射到同一个图像上。下面是一些示例。 ![火柴](../Images/d552efbfbbb7781c1bf505d238cfb7a4.png) ![火柴](../Images/1936d52d9e10a7b57256895b9340cb47.png)![火柴](../Images/bd62909dbe3039f970ad8db6bf355f36.png)

有没有人使用 OpenCV 教程中的相同代码并且可以报告与我不同的体验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:41:46.547

查看 matcher_simple.cpp 示例。它使用了一个蛮力匹配器，看起来效果很好。这是代码：

```
// detecting keypoints
SurfFeatureDetector detector(400);
vector<KeyPoint> keypoints1, keypoints2;
detector.detect(img1, keypoints1);
detector.detect(img2, keypoints2);

// computing descriptors
SurfDescriptorExtractor extractor;
Mat descriptors1, descriptors2;
extractor.compute(img1, keypoints1, descriptors1);
extractor.compute(img2, keypoints2, descriptors2);

// matching descriptors
BFMatcher matcher(NORM_L2);
vector<DMatch> matches;
matcher.match(descriptors1, descriptors2, matches);

// drawing the results
namedWindow("matches", 1);
Mat img_matches;
drawMatches(img1, keypoints1, img2, keypoints2, matches, img_matches);
imshow("matches", img_matches);
waitKey(0); 
```

# python - Matplotlib：子图中的插图

> ID：14589600
> 
> 赞同：1
> 
> 时间：2013-01-29T18:20:33.943
> 
> 标签：python, matplotlib

我必须做几个子图，每个子图在相对于子图的相同*自定义*位置都有一个插图。

原则上可以使用[本](http://matplotlib.org/mpl_toolkits/axes_grid/users/overview.html#insetlocator)`axes_grid1`示例中给出的方法来完成，但是，对于我的目的，或中的位置参数不够具体。`loc=``inset_axes``zoomed_inset_axes`

我也尝试过[`GridSpec`'s](http://matplotlib.org/api/gridspec_api.html?highlight=gridspec#matplotlib.gridspec) `get_grid_positions`，但我无法理解它返回的参数。

我怎样才能让插图在每个子图中看起来都一样，而不必被迫将它们放在特定位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T20:32:30.567

您可以手动完成：

```
ncols = 2
nrows = 2

inset_hfrac = .3
inset_vfrac = .3

inset_hfrac_offset = .6
inset_vfrac_offset = .6

top_pad = .1
bottom_pad = .1
left_pad = .1
right_pad = .1

hspace = .1
vspace = .1

ax_width = (1 - left_pad - right_pad - (ncols - 1) * hspace) / ncols
ax_height = (1 - top_pad - bottom_pad - (nrows - 1) * vspace) / nrows

fig = figure()

ax_lst = []
for j in range(ncols):
    for k in range(nrows):
        a_bottom = bottom_pad + k * ( ax_height + vspace)
        a_left = left_pad + j * (ax_width + hspace)

        inset_bottom = a_bottom + inset_vfrac_offset * ax_height
        inset_left = a_left + inset_hfrac_offset * ax_width

        ax = fig.add_axes([a_left, a_bottom, ax_width, ax_height])
        ax_in = fig.add_axes([inset_left, inset_bottom, ax_width * inset_hfrac, ax_height *  inset_vfrac])
        ax_lst.append((ax,ax_in)) 
```

这会让你失去使用的能力`tight_layout`，但会让你获得大量的控制权。

# php - Linux如何在后台进程中依次运行cat和unlink

> ID：14589603
> 
> 赞同：0
> 
> 时间：2013-01-29T18:20:39.497
> 
> 标签：php, linux, unix, merge, background-process

我有多个文件应该合并到一个文件中，完成后我想删除这些文件。我怎样才能做到这一点？我试过了

```
(cat 511MB.zip0 511MB.zip1 511MB.zip2 511MB.zip3 511MB.zip4 511MB.zip5 > 511MB.zip; unlink 511MB.zip0; unlink 511MB.zip1; unlink 511MB.zip2; unlink 511MB.zip3; unlink 511MB.zip4; unlink 511MB.zip5;) & 
```

像这样的东西，它是命中注定的，我的意思是如果 cat 还没有完成并且它已经删除了这些片段，那么它就不会生成一个完整的文件。那么猫完成后如何开始取消链接呢？

请注意，此命令我将使用 exec() 在 PHP 中运行它；我需要它在后台运行，以便用户体验流畅（文件上传后，用户可以在文件合并时移动到不同的页面）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:34:59.920

看在上帝的份上，使用变量：

```
(files="511MB.zip0 511MB.zip1 511MB.zip2 511MB.zip3 511MB.zip4 511MB.zip5"
 cat $files > 511MB.zip; unlink $files) & 
```

这是基本的 DRY（不要重复自己）的东西。如果`unlink`真的一次只需要一个文件，请使用`for`循环（但是，为什么不使用`rm`而不是`unlink`？）。如果名称包含空格，请使用数组。还是去干！

`cat`和之间的分号`unlink`确保顺序执行；在连接完成之前，取消链接不会开始。你不需要做任何其他事情。

`cat`如果您在后台自行运行，您会遇到问题：

```
# !!BAD!!
(files="511MB.zip0 511MB.zip1 511MB.zip2 511MB.zip3 511MB.zip4 511MB.zip5"
 cat $files > 511MB.zip &
 unlink $files) &
# !!BAD!! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:28:13.930

通过使用`&&`而不是`;`分隔您的命令，您可以确保在成功运行`cat`.

```
cat 511MB.zip0 511MB.zip1 511MB.zip2 511MB.zip3 511MB.zip4 511MB.zip5 > 511MB.zip && unlink 511MB.zip0 && unlink 511MB.zip1 && unlink 511MB.zip2 && unlink 511MB.zip3 && unlink 511MB.zip4 && unlink 511MB.zip5 
```

# c# - 玩家动画在接受游戏控制器输入时不起作用，但在接受键盘输入时起作用

> ID：14589606
> 
> 赞同：0
> 
> 时间：2013-01-29T18:20:54.767
> 
> 标签：c#, xna-4.0

在 c# 中编码并使用 XNA 4.0 框架我正在尝试为玩家控制开发键盘和游戏控制器输入。

我的游戏控制器输入代码如下；

```
GamePadState gamepadState = GamePad.GetState(PlayerIndex.One); 

if(gamepadState.ThumbSticks.Left.X != 0 || gamepadState.ThumbSticks.Left.Y != 0) 
{   
     //Handles rotation
     angle += thumbsticksMove(gamepadState); //handles Left.X and Left.Y input
     normalize(); //normalizes angle and sets normalizedAngle = angle
     this.Rotate(normalizedAngle); //takes value and passes it through Math helper
     //atan and pi*2
     //Ends handles rotation

     pos += (angle * speed);

     //Implementing framerate adjustment just for this class
     timeSinceLastFrame += (float)gameTime.ElapsedGameTime.Milliseconds;
     if (timeSinceLastFrame > millisecondsPerFrame)
     {
          timeSinceLastFrame -= millisecondsPerFrame;
          Animation();
     }
} 
```

这会按预期移动玩家，并且精灵会翻转到正确的方向，但动画片段**不起作用**。精灵应该在输入时随着玩家的移动而动画。这在从键盘输入时效果很好，见下文；

```
if (Keyboard.GetState().IsKeyDown(Keys.Right))
{
       input = Vector2.Zero;
       input.X = 1;

       //Handles rotation
       angle.X = input.X;
       normalize();
       this.Rotate(normalizedAngle);
       //Ends handles rotation

       pos += (input * speed);
       //Implementing framerate adjustment just for this class
       timeSinceLastFrame += (float)gameTime.ElapsedGameTime.Milliseconds;
       if (timeSinceLastFrame > millisecondsPerFrame)
       {
       timeSinceLastFrame -= millisecondsPerFrame;
       Animation();
       }
} 
```

我很难弄清楚为什么它适用于键盘输入而不适用于游戏控制器输入。它几乎看起来好像它正在尝试制作动画，但从未完全超过第 3 个动画单元格，或者动画速度如此之快以至于看起来好像几乎没有动画。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T02:11:08.247

我最终添加了

```
if (gamepadState.IsConnected){//Gamepad code}

if (!gamepadState.IsConnected){//Keyboard code} 
```

单独阅读输入似乎已经解决了这个问题。

不过感谢大家的帮助。

# c - 递归所有 C 文件

> ID：14589614
> 
> 赞同：12
> 
> 时间：2013-01-29T18:21:23.430
> 
> 标签：c, makefile

我真的无法进入makefile。**在以前的项目中，我在Makefile**中对所有编译任务进行了硬编码：

```
all: compile_a compile_b compile_c

compile_a:
    ${CC} ${CFLAGS} ${A_SRC} -o ${A_OUT} 
```

等等。

但是由于最新的项目比以前的每个项目都有*更多的文件*，我想写更好的 make 任务，当然少字符作为 make 对我的眼睛不是很友好（这让他们很痛苦）！:-P

我想要的是：

*   一项统治他们的任务（只是`make projectname`或`make all`，你知道吗？）
*   每个 C 文件都要编译一个任务（我读过一些关于这种`%.o: %.c`语法的东西，但并没有真正明白）
*   链接的一项任务（如何获取所有 .o 文件并将它们链接起来，而不需要对每个文件进行硬编码？）
*   一项清洁任务（哦，我可以做到！）

项目结构为：

```
bin (binary goes here!)
src
  some
  directories 
  are
  here 
```

我不知道我是否需要一个目标文件的目录，我把它们放进去`./bin`，我认为这已经足够了，不是吗？

也许我只需要一个可以用简单的话解释的人！

编辑：正如有人指出的那样，没有真正的问题，所以这里是：

*   如何递归编译所有C文件`bin/(filename).o`
*   如何`.o`在不知道文件名的情况下链接“bin/”中的所有文件

也许这有帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-29T18:31:57.080

试试这个：

```
CC = gcc
CFLAGS = -c -Wall -g -Os
LD = $(CC)
LDFLAGS = -lfoo

TARGET = MyProject

OBJECTS = $(patsubst %.c, %.o, $(wildcard *.c))

all: $(TARGET)

$(TARGET): $(OBJECTS)
        $(LD) -o $@ $^ $(LDFLAGS)

# You don't even need to be explicit here,
# compiling C files is handled automagically by Make.
%.o: %.c
        $(CC) $(CFLAGS) $^ -o $@

clean:
        rm $(TARGET) $(OBJECTS) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-29T18:58:21.013

我经常将该功能与您想要实现的`wildcard`功能结合使用。`foreach`

如果您的资源在其中，`src/`并且您想将二进制文件放入`bin/`my 的基本构造中，则`Makefile`如下所示：

```
SOURCES=$(shell find src -type f -iname '*.c')

OBJECTS=$(foreach x, $(basename $(SOURCES)), $(x).o)

TARGET=bin/MyProject

$(TARGET): $(OBJECTS)
    $(CC) $^ -o $@

clean:
    rm -f $(TARGET) $(OBJECTS) 
```

我通常利用 make 内置的隐式规则和预定义变量（[Make manual，第 10 章](http://www.gnu.org/software/make/manual/make.html#Implicit-Rules)）。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-01-29T18:31:04.120

无需详细说明 makefile，请使用 * 对您有利。

IE

```
compileAll:    gcc -c *.c
linkAll:       gcc *.o -o output.exe 
```

# excel - 将工作表分配给变量时出现运行时错误 13

> ID：14589621
> 
> 赞同：2
> 
> 时间：2013-01-29T18:22:01.857
> 
> 标签：excel, excel-2007, vba

我在一个单独的模块中创建了一个子例程，用于在我正在处理的 Excel 项目中分配一些全局变量。我正在将工作表分配给变量，并且有 9 个工作表/变量，但在运行时 13 上只有 1 个错误，当我检查本地窗口时，我看到分配的类型是“工作表”而不是“变量/对象/工作表#”作为其余的人都这样做。这是一些代码：

```
Public Cover, Notes, HWIO, IntChn, FbChn, _ 
 DigFb, AnaFb, RemAlm, OGoL As Worksheets

Public Sub AssignVars()
 Set Cover = Sheets("1\. Cover")
 Set Notes = Sheets("2\. Notes")
 Set HWIO = Sheets("3\. HW Input-Output")
 Set IntChn = Sheets("4\. Internal Channels")
 Set FbChn = Sheets("5\. Funct Block Channels")
 Set DigFb = Sheets("6\. Digital Funct Blocks")
 Set AnaFb = Sheets("7\. Analog Funct Blocks")
 Set OGoL = Sheets("OGOnline")
 Set RemAlm = Sheets("8\. Remote Alarming")
End Sub 
```

错误发生在`Set OGoL = Sheets("OGOnline")`

查看本地变量，我看到除了 OGoL 之外的所有变量都分配了一个工作表对象。OGoL 那里有“工作表”。它可能正盯着我看，但我不知道为什么我会遇到类型不匹配，该工作表按名称存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:41:43.793

发生这种情况是因为您将 Worksheet 分配*给*Worksheets*变量*。

在前七个变量初始化中没有遇到这种情况的原因是因为您已将这些变量声明为类型变体。为了将这些变量声明为 Worksheet 类型，您必须这样指明：

```
Public Cover As Worksheet, Notes As Worksheet, HWIO As Worksheet, _
IntChn As Worksheet, FbChn As Worksheet, DigFb As Worksheet, _
AnaFb As Worksheet, RemAlm As Worksheet, OGoL As Worksheet 
```

# python - 使用旁遮普邦连接到谷歌服务器时出错

> ID：14589625
> 
> 赞同：0
> 
> 时间：2013-01-29T18:22:10.757
> 
> 标签：python, xmpp, google-talk, punjab

我已经用（python 2.7.3）安装了旁遮普语。

我正在尝试使用通过旁遮普邦的emite作为中间连接到谷歌服务器（gmail.com）。

服务器似乎启动良好，我可以访问 localhost:5280/http-bind 但我尝试建立的任何连接都失败了。以下是从启动到尝试登录 gmail.com 帐户的日志：

```
2013-01-30 01:08:58+0530 [-] Log opened.
2013-01-30 01:08:58+0530 [-] twistd 11.1.0 (C:\Python27\python.exe 2.7.3) starting up.
2013-01-30 01:08:58+0530 [-] reactor class: twisted.internet.selectreactor.SelectReactor.
2013-01-30 01:08:58+0530 [-] Site starting on 5280
2013-01-30 01:08:58+0530 [-] Starting factory <twisted.web.server.Site instance at 0x000000000364EB08>
2013-01-30 01:09:38+0530 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - - [29/Jan/2013:19:39:38 +0000] "GET /http-bind HTTP/1.1" 200 170 "-" "Mozilla/5.0 (Windows NT 6.
1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Safari/537.17"
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] HEADERS 1359488636.27:
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] {'origin': 'http://127.0.0.1:8888', 'content-length': '226', 'accept-language': 'en-US,en;q=0.8', 'accept-en
coding': 'gzip,deflate,gzip', 'accept': '*/*', 'user-agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Sa
fari/537.17', 'accept-charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3', 'host': 'localhost:5280', 'referer': 'http://127.0.0.1:8888/Engile.html?gwt.codesvr=127.0.0.1
:9997', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'content-type': 'text/xml; charset=UTF-8'}
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] HTTPB POST :
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] <body to="gmail.com" content="text/xml; charset=utf-8" rid="228343" xmlns:xmpp="urn:xmpp:xbosh" ack="1" hold
="1" secure="true" xml:lang="en" wait="60" xmpp:version="1.0" ver="1.6" xmlns="http://jabber.org/protocol/httpbind" />
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] Session Created : ea15d8ba5d460c80a90371138987072b58eed580 1359488636.3
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] ================================== 1359488636.3 connect to gmail.com:5222 ==================================

2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] G:\Softwares\Libraries\punjab\punjab\session.py:85: exceptions.UserWarning: Domain argument to XMPPClientCon
nector should be bytes, not unicode
2013-01-30 01:13:56+0530 [HTTPChannel,2,127.0.0.1] Starting factory <punjab.session.Session object at 0x0000000003664390>
2013-01-30 01:13:57+0530 [-] DNSDatagramProtocol starting on 30443
2013-01-30 01:13:57+0530 [-] Starting protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003672C18>
2013-01-30 01:13:57+0530 [DNSDatagramProtocol (UDP)] DNSDatagramProtocol starting on 24214
2013-01-30 01:13:57+0530 [DNSDatagramProtocol (UDP)] Starting protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003672E80>
2013-01-30 01:13:57+0530 [-] (UDP Port 30443 Closed)
2013-01-30 01:13:57+0530 [-] Stopping protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003672C18>
2013-01-30 01:13:57+0530 [DNSDatagramProtocol (UDP)] DNSDatagramProtocol starting on 37666
2013-01-30 01:13:57+0530 [DNSDatagramProtocol (UDP)] Starting protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003660908>
2013-01-30 01:13:57+0530 [-] (UDP Port 24214 Closed)
2013-01-30 01:13:57+0530 [-] Stopping protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003672E80>
2013-01-30 01:13:57+0530 [-] (UDP Port 37666 Closed)
2013-01-30 01:13:57+0530 [-] Stopping protocol <twisted.names.dns.DNSDatagramProtocol object at 0x0000000003660908>
2013-01-30 01:13:58+0530 [Uninitialized] SID: ea15d8ba5d460c80a90371138987072b58eed580 => SEND: "<stream:stream xmlns:stream='http://etherx.jabber.org/streams'
 xmlns='jabber:client' to='gmail.com' version='1.0'>"
2013-01-30 01:13:58+0530 [XmlStream,client] SID: ea15d8ba5d460c80a90371138987072b58eed580 => RECV: '<stream:stream from="gmail.com" id="149344C387533058" versi
on="1.0" xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client"><stream:features><starttls xmlns="urn:ietf:params:xml:ns:xmpp-tls"><required/></
starttls><mechanisms xmlns="urn:ietf:params:xml:ns:xmpp-sasl"><mechanism>X-GOOGLE-TOKEN</mechanism><mechanism>X-OAUTH2</mechanism></mechanisms></stream:feature
s>'
2013-01-30 01:13:58+0530 [XmlStream,client] Wait until starttls is completed.
2013-01-30 01:13:58+0530 [XmlStream,client] [<twisted.words.protocols.jabber.xmlstream.TLSInitiatingInitializer object at 0x0000000003676AC8>]
2013-01-30 01:14:18+0530 [XmlStream,client] connect ERROR: [Failure instance: Traceback (failure with no frames): <class 'twisted.internet.error.ConnectionDone
'>: Connection was closed cleanly.
        ]
2013-01-30 01:14:18+0530 [XmlStream,client] HTTPB Error 200
2013-01-30 01:14:18+0530 [XmlStream,client] HTTPB Return Error: 200 -> <body xmlns='http://jabber.org/protocol/httpbind' type='terminate' condition='remote-con
nection-failed'/>
2013-01-30 01:14:18+0530 [XmlStream,client] 127.0.0.1 - - [29/Jan/2013:19:44:17 +0000] "POST /http-bind// HTTP/1.0" 200 105 "http://127.0.0.1:8888/Engile.html?
gwt.codesvr=127.0.0.1:9997" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Safari/537.17"
2013-01-30 01:14:18+0530 [XmlStream,client] expire (ea15d8ba5d460c80a90371138987072b58eed580)
2013-01-30 01:14:18+0530 [XmlStream,client] 0
2013-01-30 01:14:18+0530 [XmlStream,client] SESSION -> We have expired ea15d8ba5d460c80a90371138987072b58eed580 228344 []
2013-01-30 01:14:18+0530 [XmlStream,client] SID: ea15d8ba5d460c80a90371138987072b58eed580 => SEND: '</stream:stream>'
2013-01-30 01:14:18+0530 [XmlStream,client] Stopping factory <punjab.session.Session object at 0x0000000003664390> 
```

这里出了什么问题？

# django - 如何重置 PostgreSQL 表上的 ID 序列

> ID：14589634
> 
> 赞同：38
> 
> 时间：2013-01-29T18:22:58.323
> 
> 标签：django, postgresql

我最近将大量数据从旧数据库导入到新的 Postgresql 数据库中，作为新 Django 站点中模型的基础。

我使用了旧数据库中的 ID（因为各个表中的行相互引用），但它们并不都是连续的——通常存在很大的差距。

我注意到，当我通过 Django 应用程序添加一个新对象时，它一直使用从 1 开始的 ID，这没有问题，因为没有 ID 非常低的行。

但是一旦它到达第一行遗留数据，那么 postgres 显然会抱怨：

```
ERROR:  duplicate key value violates unique constraint "django_comments_pkey"
DETAIL:  Key (id)=(25) already exists. 
```

查看表格描述，我猜我需要在每个表格上重置某种序列：

```
 Table "public.django_comments"
     Column      |           Type           |                          Modifiers                           
-----------------+--------------------------+--------------------------------------------------------------
 id              | integer                  | not null default nextval('django_comments_id_seq'::regclass)
... 
```

我需要做什么来重置该序列，以便添加 ID 高于当前最大 ID 的新行？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-01-29T18:27:55.750

运行[sqlsequencereset](https://docs.djangoproject.com/en/3.0/ref/django-admin/#sqlsequencereset)它将打印您需要的所有重置命令。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2018-05-10T15:03:18.667

正如“Dmitry Shevchenko”所建议的那样，您可以运行`sqlsequencereset`来解决您的问题。

或者

`sqlsequencereset`您可以通过这种方式执行从 python 中生成的 SQL 查询（*使用默认数据库*）：

```
from django.core.management.color import no_style
from django.db import connection

from myapps.models import MyModel1, MyModel2

sequence_sql = connection.ops.sequence_reset_sql(no_style(), [MyModel1, MyModel2])
with connection.cursor() as cursor:
    for sql in sequence_sql:
        cursor.execute(sql) 
```

**我用Python3.6**、**Django 2.0**和**PostgreSQL 10**测试了这段代码。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-08-17T06:03:50.147

这是一个简短的片段，用于重置 Django 1.9+ 中的所有序列（基于[http://djangosnippets.org/snippets/2774/](http://djangosnippets.org/snippets/2774/)）并与 Python 3 兼容：

```
import os
from io import StringIO

os.environ['DJANGO_COLORS'] = 'nocolor'

from django.core.management import call_command
from django.apps import apps
from django.db import connection

commands = StringIO()
cursor = connection.cursor()

for app in apps.get_app_configs():
    label = app.label
    call_command('sqlsequencereset', label, stdout=commands)

cursor.execute(commands.getvalue()) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-09-04T09:56:37.517

所以在我看来，最快、最简单、最“Django”的方法是使用以下管理命令：

```
python manage.py sqlsequencereset app_name 
```

在此之后，您将获得以下内容：

```
BEGIN;
SELECT setval(pg_get_serial_sequence('"measurements_quantity"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "measurements.Quantities";
SELECT setval(pg_get_serial_sequence('"measurements.Prefixes"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "measurements.Prefixes";
COMMIT; 
```

下一步是在`python manage.py dbshell`管理命令中运行它，所以运行它，然后您将在终端中看到交互数据库 shell：

```
psql (11.7 (Debian 11.7-0+deb10u1), server 11.5 (Debian 11.5-1.pgdg90+1))
Type "help" for help.

postgres=# BEGIN;
BEGIN
postgres=# SELECT setval(pg_get_serial_sequence('"measurements.Quantities"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "measurements.Quantities";
 setval 
--------
      1
(1 row)

postgres=# SELECT setval(pg_get_serial_sequence('"measurements.Prefixes"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "measurements.Prefixes";
 setval 
--------
      1
(1 row)

postgres=# COMMIT;
COMMIT
postgres=# exit 
```

就那么简单。该`python manage.py sqlsequencereset app_name`命令将为您提供您需要运行的 SQL，并在`dbshell`.

无需编写您自己的自定义 SQL 或自定义代码，它会以正确的格式和选择的数据库引擎为您提供所需的内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-03-16T13:16:18.933

PostgreSQL 命令： `ALTER SEQUENCE app_model_id_seq RESTART WITH 1`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-29T18:26:22.973

```
select setval('django_comments_id_seq', 12345); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-14T15:06:49.273

此片段[在所有应用程序上运行 sqlsequencereset](http://djangosnippets.org/snippets/2774/)重置所有空模型的所有 ID

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-08-11T18:31:42.000

这是我刚刚在一个管理命令中实现的或多或少完全动态的解决方案，它对您尝试重置的主键的名称没有限制，因为它根据您在**settings**中的连接参数收集它。

我无法重置的唯一排序包括不是整数的 PK，这在**django.contrib.sessions**的 PK 中很明显，但我再次从未遇到过排序错误，所以我怀疑这是一个问题。

这是命令，使用运行`python manage.py reset_sequences`（显然只要您的文件/命令名为 reset_sequences.py）

```
import psycopg2
from django.conf import settings
from django.core.management.base import BaseCommand
from django.db import connections

def dictfetchall(cursor):
    """Return all rows from a cursor as a dict"""
    columns = [col[0] for col in cursor.description]
    return [
        dict(zip(columns, row))
        for row in cursor.fetchall()
    ]

class Command(BaseCommand):
    help = "Resets sequencing errors in Postgres which normally occur due to importing/restoring a DB"

    def handle(self, *args, **options):
        # loop over all databases in system to figure out the tables that need to be reset
        for name_to_use_for_connection, connection_settings in settings.DATABASES.items():
            db_name = connection_settings['NAME']
            host = connection_settings['HOST']
            user = connection_settings['USER']
            port = connection_settings['PORT']
            password = connection_settings['PASSWORD']

            # connect to this specific DB
            conn_str = f"host={host} port={port} user={user} password={password}"

            conn = psycopg2.connect(conn_str)
            conn.autocommit = True

            select_all_table_statement = f"""SELECT *
                                    FROM information_schema.tables
                                    WHERE table_schema = 'public'
                                    ORDER BY table_name;
                                """
            # just a visual representation of where we are
            print('-' * 20, db_name)
            try:
                not_reset_tables = list()
                # use the specific name for the DB
                with connections[name_to_use_for_connection].cursor() as cursor:
                    # using the current db as the cursor connection
                    cursor.execute(select_all_table_statement)
                    rows = dictfetchall(cursor)
                    # will loop over table names in the connected DB
                    for row in rows:
                        find_pk_statement = f"""
                            SELECT k.COLUMN_NAME
                            FROM information_schema.table_constraints t
                            LEFT JOIN information_schema.key_column_usage k
                            USING(constraint_name,table_schema,table_name)
                            WHERE t.constraint_type='PRIMARY KEY'
                                AND t.table_name='{row['table_name']}';
                        """
                        cursor.execute(find_pk_statement)
                        pk_column_names = dictfetchall(cursor)
                        for pk_dict in pk_column_names:
                            column_name = pk_dict['column_name']

                        # time to build the reset sequence command for each table
                        # taken from django: https://docs.djangoproject.com/en/3.0/ref/django-admin/#sqlsequencereset
                        # example: SELECT setval(pg_get_serial_sequence('"[TABLE]"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "[TABLE]";
                        try:
                            reset_statement = f"""SELECT setval(pg_get_serial_sequence('"{row['table_name']}"','{column_name}'), 
                                                    coalesce(max("{column_name}"), 1), max("{column_name}") IS NOT null) FROM "{row['table_name']}" """
                            cursor.execute(reset_statement)
                            return_values = dictfetchall(cursor)
                            # will be 1 row
                            for value in return_values:
                                print(f"Sequence reset to {value['setval']} for {row['table_name']}")
                        except Exception as ex:
                            # will only fail if PK is not an integer...
                            # currently in my system this is from django.contrib.sessions
                            not_reset_tables.append(f"{row['table_name']} not reset")

            except psycopg2.Error as ex:
                raise SystemExit(f'Error: {ex}')

            conn.close()
            print('-' * 5, ' ALL ERRORS ', '-' * 5)
            for item_statement in not_reset_tables:
                # shows which tables produced errors, so far I have only
                # seen this with PK's that are not integers because of the MAX() method
                print(item_statement)

            # just a visual representation of where we are
            print('-' * 20, db_name) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-21T14:31:53.123

基于@Paolo Melchiorre，我创建了一个自定义管理命令，用于填充所选应用程序的所有模型。

```
from django.core.management.base import BaseCommand
from django.apps import apps
from django.core.management.color import no_style
from django.db import connection

class Command(BaseCommand):
    def handle(self, *args, **kwargs):
        self.stdout.write('Reset AutoFields ...')
        APPS = ['app1', 'app2']

        APPS = [apps.get_app_config(app) for app in APPS]
        models = []
        for app in APPS:
            models.extend(list(app.get_models()))

        sequence_sql = connection.ops.sequence_reset_sql(no_style(), models)
        with connection.cursor() as cursor:
            for sql in sequence_sql:
                self.stdout.write(sql)
                cursor.execute(sql)
        self.stdout.write(self.style.SUCCESS('Reset AutoField complete.')) 
```

使用`python 3.7`和进行测试`django 2.2`。

# linux - 在bash中使用带有cp的变量

> ID：14589639
> 
> 赞同：12
> 
> 时间：2013-01-29T18:23:24.947
> 
> 标签：linux, bash, variables, cp

返回的文件将在文件名中包含空格，因此我通过 sed 运行文件名以在开头和结尾附加引号。但是，当我将 $CF 与 cp 一起使用时，它会失败。如果我手动回显 $CF 并使用生成的文件代替 $CF 它工作得很好。有什么问题？

```
CF=`ls -tr /mypath/CHS1*.xlsx | tail -1 | sed -e 's/^/"/g' -e 's/$/"/g'`
cp $CF "/mydest/myfile.xlsx" 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-29T18:24:48.397

您不需要像这样添加引号（实际上，它可能不起作用）。相反，只需`cp`在行中使用它们：

```
CF=$(ls -tr /mypath/CHS1*.xlsx | tail -1)
cp "$CF" "/mydest/myfile.xlsx" 
```

我将它从使用反引号更改为更新的（[和首选](https://stackoverflow.com/questions/9405478/command-substitution-backticks-or-dollar-sign-paren-enclosed)的）`$()`语法。

# domain-driven-design - 应用程序层和基础设施层之间的依赖关系有些混乱

> ID：14589641
> 
> 赞同：13
> 
> 时间：2013-01-29T18:23:39.240
> 
> 标签：domain-driven-design

1.  当应用程序使用*存储库*（这是一个*基础设施服务*）时，*存储库接口*被定义在*域层*中，而它的实现被定义在*基础设施层*中，因为这样*域模型*没有外向依赖关系。

a) 如果我们 100% 确定特定（非存储库）*基础设施服务* **InfServ**永远不会被域层中的任何代码调用*，*那么我假设***InfServ 的**接口*不需要在*域层*中定义？

2.  假设**InfServ**不会被 Domain 层中的代码调用（因此我们不需要在*Domain 层*中定义它的接口）：

a）如果**InfServ**将被*Application 层的 Services*调用，我假设*Application 层应该对**Infrastructure 层*有隐式依赖，而不是相反？换句话说，***InfServ 的**接口*和*它的实现*都应该在*基础设施层*中定义？

*b）应用层*依赖于*基础设施层*而不是其他方式更好的原因是*基础设施层*可以被许多应用程序重用，而*应用程序层*在大多数情况下仅特定于单个应用程序并且通常不能被其他应用程序重用？

c) 如果我们 100% 确定*Domain 层*中的任何代码都不会使用*Repository*，那么我们就不需要在*Domain 层*中定义它的接口了吗？

**更新：**

1)

> 是的，但是，域层的定义可以包括作为域外立面的应用程序服务。应用程序服务通常引用存储库和其他基础设施服务。它协调域对象和所述服务以实现用例。

一种）

> ...充当域的立面

难道我们不能争辩说“常规”（我在我的问题中提到的那些）*应用程序服务*也充当域的外观吗？

b)

> 应用程序服务通常引用存储库和其他基础设施服务。

从您的回复看来，您似乎在暗示（尽管您可能不是）“常规”*应用程序服务*通常不引用*基础设施服务*，实际上它们确实如此（据我所知）？！

2)

一种）

> 如上所述，我通常将应用程序服务合并到域层中。

“常规”*应用层*也是 BLL 层的一部分，所以我们不能说它与*域层合并（它实际上位于**域层*之上）吗？！

b)

> 我倾向于坚持六边形的建筑风格...

看起来六边形架构没有明确的*应用层*概念（即*应用服务*）？

C）

> 在域层声明存储库接口的部分好处是它指定了域的数据访问要求。

所以即使我们的域代码不会使用它，我们也应该在*域层中包含**Repository 接口？*

 ***第二次更新：**

2a)

> 如果您所说的“常规”应用程序服务与域交互，我认为将其作为域“层”的一部分是可以接受的。但是，域不应直接依赖于周围的应用程序服务，因此如果需要，可以将它们拆分为单独的模块。

*   我不确定您是否暗示*应用层*的设计（在传统的分层架构中）与您使用例如*洋葱架构将**应用层*与*域层*合并时有什么不同？

**   我会说至少就模块而言，两者不应该不同，因为在这两种情况下我们都可以分离*应用程序*和*域层*模块？（尽管我必须承认我跳过了伴侣模块（Evan 的书），因为我认为在学习 DDD 时我不需要这些知识：O）* 

 *2b)

> 是的，因为它可以与分层架构进行对比。严格的分层架构不符合在领域层声明存储库接口并在基础设施层实现的想法。这是因为，一方面，您在一个方向上存在依赖关系，但在部署方面，依赖关系在另一个方向上。Hexagonal 通过将域置于中心来解决这些问题。看看洋葱结构——它本质上是六边形的，但可能更容易掌握。

我还不知道 MVC 模式或 Asp.Net MVC，但无论如何，从阅读本系列的前三部分（这让我感到困惑到我停止阅读它），它似乎：

a）来自[洋葱文章](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)：

> 每一层都耦合到它下面的层，并且每一层通常耦合到各种基础设施问题。

作者暗示在传统的分层架构 TLA 中，*域层与**基础设施层*耦合，这当然不是真的，因为我们通常在*域层内定义**基础设施接口*（例如*存储库接口*）？！

 *b) 如果在使用 TLA 时我们决定在*应用层定义**基础设施接口*，那么*应用层*也不与*基础设施层*耦合？！

 ***c）由于*基础设施接口是在**应用程序核心*中定义的，因此*洋葱架构*不是与应用程序核心（包括*应用程序层*）耦合的*基础设施层*吗？

 **d）如果**c）是，将***应用程序层*耦合到*基础设施层*不是更好吗（出于我在原始问题中给出的原因（这里我假设域层不会调用基础设施服务））？

4)

来自[洋葱文章](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)：

> 围绕领域模型的第一层通常是我们可以找到提供对象保存和检索行为的接口，称为存储库接口。

来自[洋葱文章](http://jeffreypalermo.com/blog/the-onion-architecture-part-2/)：

> 控制器仅依赖于在应用程序核心中定义的接口。请记住，所有依赖项都朝向中心。

看来作者是在暗示，由于依赖关系只是内部的，而且基础设施接口是围绕领域模型定义的，领域模型中的代码不应该引用这些接口。换句话说，我们不应该将存储库引用作为参数传递给域实体的方法（正如您自己所说的那样）：

```
class Foo
{
           ...
       public int DoSomething(IRepository repo)
       {
              ...
            var info = repo.Get...;
              ...
       }
} 
```

出于上述原因，我必须承认，我看不到使用*Onion 架构*的好处，甚至看不到它与 TLA 有何不同（假设所有*基础设施接口都在**域层*中定义）--> 换句话说，我们不能描述 TLA使用*洋葱架构*图？！

**最后更新：**

2)

b)

> 是的。在 TLA 中，域层将根据基础设施层声明的类直接与基础设施通信，而不是相反。

只是为了确定——您是说使用 TLA，*基础设施接口*将在*基础设施层*中定义（我知道使用 Hexagonal/Onion 架构，它们是在应用程序核心中定义的）？

d)

> 耦合是双向的。应用程序核心依赖于基础设施中的实现，而基础设施依赖于应用程序核心中声明的接口。

我的观点是，由于 Onion 架构在*应用层*中声明了***InfServ**接口*（这里假设**InfServ**从未被*域层*调用，因此我们决定不在域层中定义InfServ*接口****——****参见*原始**1a**问题），它表示*应用层*控制***InfServ****接口*。但我认为如果*基础设施层*控制***InfServ****接口会更好，因为原始***2b**中所述的原因*****************问题？！*****************

 ********4)

> > 看来作者是在暗示，由于依赖关系只是内部的，而且基础设施接口是围绕领域模型定义的，领域模型中的代码不应该引用这些接口。
> 
> 在我看来，您的代码示例适合编码。

所以我说洋葱架构不允许“*域模型*”引用*基础设施接口*是正确的，因为它们是在 InDe 层中定义的**（** InDe**当然**也驻留在*应用程序核心*中）围绕 DM**强文本并从****DM**引用它们意味着依赖关系从**DM**上升到**InDe**？

> DDD 通常以六角形/洋葱形架构风格呈现，这就是为什么可能会有一些混乱。我认为您可能一直在做的事情已经是六角形的，这就是为什么它看起来是同一件事的原因。

是的，我也有这种印象。虽然我确实计划在阅读完 Evan 的书后更深入地研究 Hexagonal 架构（特别是因为新的 DDD 书将基于它的一些示例）。

**第四次更新：**

2)

d)

> 如果基础设施拥有接口和实现，那么域或应用层将负责为自己实现持久性。

我假设*应用程序*或*域*层需要自己实现它，因为引用*基础设施层*中定义的接口将洋葱的内层规则不依赖于外层（*基础设施层*是外层）？

4)

> 领域模型可以引用基础设施接口，例如存储库，因为它们是一起声明的。如果应用层从域中分离出来，就像在洋葱图中那样，那么域层可以避免引用接口，因为它们可以在应用层中定义。

但是根据那篇文章，*基础设施接口*是在围绕*Domain Layer*的层中声明的，这意味着它比*Domain Layer更接近**应用程序核心*的外边缘- 正如文章指出的那样，内层不应该依赖于外层>!

 *谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:53:34.340

1a) 是的，但是域层的定义可以包括作为域[外立面](http://en.wikipedia.org/wiki/Facade_pattern)的应用程序服务。应用程序服务通常引用存储库和其他基础设施服务。它协调域对象和所述服务以实现用例。

2a,b)

如上所述，我通常将应用程序服务合并到域层中。我倾向于坚持[六边形架构](http://alistair.cockburn.us/Hexagonal+architecture)风格，也称为端口和适配器。域位于中心，由应用程序服务封装，所有外部连接，包括存储库、UI 和服务都充当端口。

2c) 在域层声明存储库接口的部分好处是它指定了域的数据访问要求。

**更新**

1a) 我不打算将我提到的应用程序服务与“常规”应用程序服务区分开来。如果它是域上的外观，则适用规则。

1b) 可能有一些服务仍然可以称为应用程序服务，但与域没有直接关系，我想排除这些服务。

2a) 如果您所说的“常规”应用程序服务与域交互，我认为将其作为域“层”的一部分是可以接受的。但是，域不应直接依赖于周围的应用程序服务，因此如果需要，可以将它们拆分为单独的模块。

2b) 是的，因为它可以与分层架构进行对比。严格的分层架构不符合在领域层声明存储库接口并在基础设施层实现的想法。这是因为一方面您在一个方向上存在依赖关系，但在部署方面，依赖关系在另一个方向上。Hexagonal 通过将域置于中心来解决这些问题。看看[洋葱结构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)——它本质上是六边形的，但可能更容易掌握。

2c) 是的，但通常应用程序服务会引用存储库接口。

**更新 2**

2a) 它们的实施方式可能不同，但一般职责是相同的。主要区别在于依赖关系图。虽然您可以使用任一架构将应用程序服务分离到它们自己的模块中，但洋葱/六边形架构强调使用接口来声明对基础架构的依赖关系。

2ba）是的，这实际上是洋葱架构的一个特征。

b) 是的。在 TLA 中，域层将根据基础设施层声明的类直接与基础设施通信，而不是相反。

c) 是的，基础设施实现了领域层声明的接口。

d) 耦合是双向的。应用程序核心依赖于基础设施中的实现，而基础设施依赖于应用程序核心中声明的接口。

4）在我看来，您的代码示例是合适的代码。在某些情况下，实体需要访问存储库才能执行某些操作。但是，为了改善此代码的耦合特性，最好定义一个声明实体所需功能的特定接口，或者如果 lambdas 更好可用。然后存储库可以实现该接口，并且应用程序服务将在调用给定行为时将存储库传递给实体。这样，实体不依赖于通用的存储库接口，而是依赖于一个非常具体的角色。

DDD 通常以六角形/洋葱形架构风格呈现，这就是为什么可能会有一些混乱。我认为您可能一直在做的事情已经是六角形的，这就是为什么它看起来是同一件事的原因。

**更新 3**

2b）在 TLA 中不会有接口，或者不是同一种接口。域将直接与基础设施进行通信，例如持久性框架，因此它将负责持久性。

2d）如果基础设施拥有接口和实现，那么域或应用层将负责为它自己实现持久性。在 hexagonal/onion 中，持久性的实现是基础设施的一部分——它将抽象域“适应”到数据库。

4) 领域模型可以引用基础设施接口，例如存储库，因为它们是一起声明的。如果应用层从域中分离出来，就像在洋葱图中那样，那么域层可以避免引用接口，因为它们可以在应用层中定义。

**更新 4**

2d) 该声明不适用于具有如下层次结构的分层架构：UI -> 业务逻辑 -> 数据访问。业务逻辑层依赖于数据访问层，必须基于数据访问框架的对象模型来实现其数据访问。数据访问框架本身对业务层一无所知。

4) 本文仅指定了一种可能的架构。有可接受的变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T14:58:46.500

我看到将存储库接口放在应用程序层而不是域中的唯一好处是，如果您想在另一个应用程序中重用域 DLL，您将完全重新定义查询域实体集合的方式 - 换句话说，完全需要不同的存储库。

然而，这种方法有两个主要障碍：

*   领域层服务。它们代表处于许多实体十字路口的流程，因此需要多个引用来完成它们的工作。通过询问 Repositories 来获取这些引用对他们来说是一件常见且方便的事情。

    `RoutingService` [您可以在此处](https://github.com/SzymonPobiega/DDDSample.Net/tree/master/DDDSample-ModelLayers/DomainModel.DecisionSupport/Routing)找到一个示例。

*   此外，在某些特殊情况下，某些实体可能需要存储库的帮助才能找到特定的其他实体。例如，如果您有一个聚合根的层次结构，它们之间具有父/子关系，一个特定的实例可能会说“我需要满足这些条件的所有祖先/后代的列表”。存储库似乎最适合这种查询。*****************

# python - Python。Matplotlib 倒置图像

> ID：14589642
> 
> 赞同：10
> 
> 时间：2013-01-29T18:23:38.940
> 
> 标签：python, image, matplotlib

我不知道这里有什么问题。

```
import matplotlib.pyplot as plt

im = plt.imshow(plt.imread('tas.png'))
plt.show() 
```

Y轴倒置了。
所以我写了一个论点`origin='lower'`。

```
im = plt.imshow(plt.imread('tas.png'), origin='lower')
plt.show() 
```

而我所拥有的。
Y轴正常来了，但现在图像已经倒转了。

此外，当我尝试重新缩放 X 轴和 Y 轴时，图像并没有变小，只是剪掉了一块。

先感谢您。我会很感激一些帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-29T19:05:57.493

您遇到了图像编码方式的人工制品。由于历史原因，图像的原点是左上角（就像 2D 数组上的索引......想象只是打印出一个数组，数组的第一行是图像的第一行，依此类推。）

使用`origin=lower`有效地翻转您的图像（如果您要在图像顶部绘制东西，这很有用）。如果要将图像翻转为“正面朝上”*并*具有底部原点，则需要在调用之前翻转图像`imshow`

```
 import numpy as np
 im = plt.imshow(np.flipud(plt.imread('tas.png')), origin='lower')
 plt.show() 
```

# excel - 使用 VBA 将 CSV 文件读入 excel，然后将结果输出到特定的工作表

> ID：14589653
> 
> 赞同：3
> 
> 时间：2013-01-29T18:24:14.547
> 
> 标签：excel, vba, csv

我一直在寻找一段时间，找不到简单的解决方案。我有一个 csv 文件，我想使用 vba 将其读入 excel 并将结果输出到特定工作表上的特定单元格区域中。

我一直在使用以下代码，但如果我运行 excel 宏两次，它基本上会将数据附加到下一个空白列上，而不是复制它。它也只将其粘贴到活动工作表中，而不是我的特定工作表中。

关于如何做到这一点的任何建议？

谢谢，

```
Public Sub Example()
    Const csPath As String = "starting_positions.csv"
    Dim ws As Excel.Worksheet
    Set ws = Excel.ActiveSheet
    With ws.QueryTables.Add("TEXT;" & csPath, ws.Cells(1, 1))
        .FieldNames = True
        .AdjustColumnWidth = True
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileCommaDelimiter = True
        ''// This array will need as many entries as there will be columns:
        .TextFileColumnDataTypes = Array(xlTextFormat, xlTextFormat)
        .Refresh
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T20:37:56.167

假设您在需要收集 CSV 数据的同一工作簿中运行代码，请尝试以下操作：

1.  替换`Set ws = Excel.ActiveSheet`为`Set ws = ThisWorkbook.Sheets(1)`或`Set ws = ThisWorkbook.Sheets("Sheet1")`使用其索引或名称定义任何特定工作表。
2.  `ws.UsedRange.ClearContents`放置**前** `With...`一个块将清除整个工作表，因此新数据将被放置到与以前相同的位置。

另一个提示：如果您要**多次**使用此宏- 不要每次都创建新连接。如果所有选项都相似 - 仅使用`.Refresh`方法。

如果您在合并代码部分时遇到困难 - 尝试使用宏记录器手动传递任何步骤。对于您的情况，这将解决大部分问题。祝你好运！

# cygwin - Cygwin：git svn 抱怨配置文件错误

> ID：14589654
> 
> 赞同：1
> 
> 时间：2013-01-29T18:24:16.723
> 
> 标签：cygwin, git-svn

在 Cygwin 上使用 git-svn 执行远程操作，例如：

*   git svn 变基
*   git svn dcommit
*   等等

导致出现有关错误配置文件的许多奇怪错误消息之一

```
$ git svn rebase
fatal: bad config file line 1 in /home/tj/.gitconfig
fatal: bad config file line 1 in /home/tj/.gitconfig
Cannot rebase: You have unstaged changes.
Please commit or stash them.
rebase refs/remotes/git-svn: command returned error: 1 
```

实际上没有任何未分级的更改，该错误消息似乎是配置文件问题的产物：

```
# On branch master
nothing to commit (working directory clean) 
```

有时它会抱怨同一文件中的其他行，或 .git/config 中的行

我实际的 git 配置文件非常简单，完全相同的配置文件在其他机器（也运行 Cygwin）上也能正常工作。以供参考：

.gitconfig：

```
[user]
        name = tj
        email = tj@example.com 
```

.git/配置：

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
        ignorecase = true
        preloadindex = true
[svn-remote "svn"]
        url = https://url.to/repository
        fetch = :refs/remotes/git-svn 
```

octo-spacing 是文件中的一个选项卡，在 vim 中使用 set list 查看文件显示没有奇怪的字符混在一起。

最奇怪的是，有时它可以毫无问题地工作。但是，在短时间内，它会继续显示错误消息。如果有人知道这个问题可能是什么，或者如何解决它，我将不胜感激。

谢谢！

编辑：

到目前为止我已经尝试过：

*   从运行 Cygwin 的工作机器复制好的配置文件
*   在 Cygwin 中运行 rebaseall
*   重新安装 git-svn 包

我可能会尝试：

*   重新安装 Cygwin（宁愿不）

编辑2：成功？

在摆弄了几个小时之后，我尝试从 git 配置中一一删除，看看它是否有所作为。

从 .git/config 文件中删除 preloadindex = true 似乎已经解决了这个问题，尽管很难确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T04:02:41.837

罪魁祸首确实是core.preloadindex = true，这在cygwin中表现不佳。

# php - PHP计算负数和仅粗体偶数

> ID：14589657
> 
> 赞同：0
> 
> 时间：2013-01-29T18:24:32.503
> 
> 标签：php, numbers, bold

在一个表单上，我使用 PHP 显示从 1 到输入数字的每个数字。例如，如果我在表单上输入 10，它会显示 1 2 3 4 5 6 7 8 9 10。现在，我希望它能够通过计数到 0 (-10 -9 -8 -7) 来处理负数-6 -5 -4 -3 -2 -1 0) 并将结果中的每个偶数加粗，例如 2 4 6 8 10 等）。我已经详尽地搜索了答案，但没有任何运气。你们中的任何人会如何建议这样做？我的第一部分代码如下所示。先感谢您。

```
<?php
$num = $_POST['num'];
$limit = $_POST['num'];

echo "<pre>";   
do {
echo ($counter).'<br>';
$counter++;
} while ($counter <= $limit);
echo "<pre>";
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:26:35.777

你可以这样做

```
<?php
$num = $_POST['num'];
$limit = $_POST['num'];

echo "<pre>";   
do {
if( $counter % 2 == 0 )
{
    echo "<strong>" . $counter . "</strong><br />";
}
else
{
    echo ($counter).'<br>';
}
$counter++;
} while ($counter <= $limit);
echo "<pre>";
?> 
```

**解决方案 1**
好的，关于 %. 这是一个[模数](http://en.wikipedia.org/wiki/Modulo_operation)。如果您将其除以 mod 编号，它会返回剩余的数字。例如

```
0 % 2 = 0
1 % 2 = 1
2 % 2 = 0
3 % 2 = 1 this because 3 / 2 = 1 and a bit,
          you can't divide the last 1 completely by 2\. So remain 1
4 % 2 = 0 
```

**解决方案 2**
就像美眉说的，你可以使用`$counter & 1`. 这是做什么的？

如果您按位查看数字。你想与它机智1。

```
Bitwise number 2 = 0010 AND it with 0001 and your return will be 0000 (zero).
Bitwise number 3 = 0011 AND it with 0001 and your result will be 0001 (one). 
```

如果您接受这种情况并且只检查最后一位，您可以查看它是否是偶数。有关[按位运算](http://en.wikipedia.org/wiki/Bitwise_operation)的更多信息。

# ios - 有什么方法可以在取消 UIPopoverController 的同时触摸取消按钮？

> ID：14589659
> 
> 赞同：0
> 
> 时间：2013-01-29T18:24:39.030
> 
> 标签：ios, uibutton, touch, uipopovercontroller

我们有一个 uipopovercontroller 显示用户可以做出的一些选择。附近是一个开始搜索的 GO 按钮。我们需要关闭弹出框，但仍然允许一键触发 GO 按钮。过去，我们使用手动弹出控件来轻松处理此问题，这也是客户习惯的方式。关于如何获得这种行为但使用 Apple 的 UIPopoverController 解雇的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:37:10.500

首先我会结帐`passthroughViews`。他们将允许您告诉它在弹出框处于活动状态时允许触摸按钮。

> **直通视图**
> 
> 弹出框可见时用户可以与之交互的一组视图。
> 
> @property (nonatomic, copy) NSArray *passthroughViews Discussion 当弹出框处于活动状态时，与其他视图的交互通常会被禁用，直到弹出框被关闭。将视图数组分配给此属性允许弹出框之外的点击由相应的视图处理。
> 
> 可用性 适用于 iOS 3.2 及更高版本。

接下来在您的 GO 按钮选择器中，您只需要通过解雇来处理弹出框：

```
[popoverController dismissPopoverAnimated:YES]; 
```

# magento - Magento - 将比较按钮更改为 facebook like 按钮

> ID：14589666
> 
> 赞同：0
> 
> 时间：2013-01-29T18:25:15.810
> 
> 标签：magento, button, compare, magento-1.7

我想用 facebook like 按钮在 addto 按钮/链接中更改比较按钮，以及 addto wishlist 添加到购物车链接/按钮。

```
/app/design/frontend/default/theme/template/catalog/product/view/addto.phtml 
```

我想改变类别和产品视图。

这是addto.phtml的代码

```
 ?>

<?php $_product = $this->getProduct(); ?>
<?php $_wishlistSubmitUrl = $this->helper('wishlist')->getAddUrl($_product); ?>

<ul class="add-to-links">
<?php if ($this->helper('wishlist')->isAllow()) : ?>
    <li><a rel="tooltip" data-placement="top" title="<?php echo $this->__('Add to Wishlist') ?>" href="<?php echo $_wishlistSubmitUrl ?>" onclick="productAddToCartForm.submitLight(this, this.href); return false;" class="link-wishlist"><?php echo $this->__('Add to Wishlist') ?></a></li>
<?php endif; ?>
<?php
    $_compareUrl = $this->helper('catalog/product_compare')->getAddUrl($_product);
?>
<?php if($_compareUrl) : ?>
    <li><a rel="tooltip" data-placement="top" title="<?php echo $this->__('Add to Compare') ?>" href="<?php echo $_compareUrl ?>" class="link-compare"><?php echo $this->__('Add to Compare') ?></a></li>
<?php endif; ?>
</ul> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T22:33:36.077

```
<?php $_product = $this->getProduct(); ?>
<?php $_wishlistSubmitUrl = $this->helper('wishlist')->getAddUrl($_product); ?>

<ul class="add-to-links">
<?php if ($this->helper('wishlist')->isAllow()) : ?>
    <li><a rel="tooltip" data-placement="top" title="<?php echo $this->__('Add to Wishlist') ?>" href="<?php echo $_wishlistSubmitUrl ?>" onclick="productAddToCartForm.submitLight(this, this.href); return false;" class="link-wishlist"><?php echo $this->__('Add to Wishlist') ?></a></li>
<?php endif; ?>
    <li>
        <!-- put fb code here eg -->
        <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fmageigniter.com&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;font&amp;colorscheme=light&amp;action=like&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe>
    </li>
</ul> 
```

# c# - 单击文本框以显示弹出窗口，单击外部以关闭弹出窗口

> ID：14589667
> 
> 赞同：0
> 
> 时间：2013-01-29T18:25:34.323
> 
> 标签：c#, wpf, xaml

我正在设计一个 WPF 用户控件，文本框下有一个文本框和一个弹出窗口。我想单击文本框，然后显示弹出窗口。如果我在文本框外单击，弹出窗口将关闭。

现在的问题是如果我在用户控件区域之外单击，如何使文本框失焦？有没有更好的方法来设计这个控件？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:43:00.000

单击内部时，您应该显示弹出窗口，并在单击非用户时尝试使用链接中的解决方案将其关闭[是否有在 c# Windows Form 应用程序中的文本框外单击鼠标时触发的事件处理程序？](https://stackoverflow.com/questions/5201864/is-there-an-event-handler-that-is-fired-when-mouse-is-clicked-outside-textbox-i)

# mysql - MySQL如果第一个字符是数字

> ID：14589668
> 
> 赞同：1
> 
> 时间：2013-01-29T18:25:34.937
> 
> 标签：mysql, sql

我正在尝试编写一个 mysql 脚本来查看第一个字符是否是数字，这就是我到目前为止所做的

```
select CASE WHEN user_id REGEXP '[0-9]+' then 1 else 0 end as user_id  from table 
```

它将我的所有数据返回为 1...colum 是一个 varchar，我将拥有这样`1234`或这样的 user_id`USER-484`或 `ADMIN-464567' 是我想要做的可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:37:29.867

试试这个来检查起始字母/数字是否是一个数字：

```
select CASE WHEN user_id
REGEXP '^[0-9]+' 
then 1 else 0 end as user_id
from table; 
```

或者

```
select CASE WHEN user_id
REGEXP '^\d+' 
then 1 else 0 end as user_id
from table; 
```

我只是想知道您的查询安排。我以为应该是这样的

```
select user_id
from table
where REGEXP '^\d+' ; 
```

但你的实际上是在使用正确的`regex`. :)

## * [SQLFIDDEL 演示](http://sqlfiddle.com/#!2/589dc/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:37:37.433

所以你想显示 user_id 吗？然后把你的正则表达式放在`WHERE`子句中

```
select user_id from table
where
user_id REGEXP '^[0-9]+' 
```

你也错过了一个`^`意思是“在行首”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T04:45:40.500

由于您在 [0-9] 之前缺少 ^ ，因此它匹配您领域中任何位置的数字。通过指定 ^[0-9] 意味着它应该以数字开头。所以尝试使用 '^[0-9]'

# javascript - 添加和删 除元素 IF 类具有 x 样式...无法正常工作

> ID：14589669
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:25:36.587
> 
> 标签：javascript, jquery, jquery-plugins, quick-search

我正在使用一个 jquery 快速搜索插件（[https://github.com/riklomas/quicksearch](https://github.com/riklomas/quicksearch)），它根据输入到输入字段中的数据过滤列表。

如果没有返回结果，我想显示一条这样的消息。

快速搜索插件将 display: none 添加到所有不显示的列表元素。

因此，我尝试了这个：

```
 // load jquery.quicksearch
        $('#search').parent().css('display','block').end().quicksearch('#ul'+id+' li');

        // show / hide message
        $("input#search").keypress(function() {
                li = $('.category li');                 
                if (li.css('display') == 'none') {
                    $('body').append('<div id="noContent">no content</div>');
                } else { 
                    $('#noContent').remove();
                }
        }); 
```

结果是一个非常紧张/错误的解决方案。有时即使所有 li 项目都显示：无，它也不会附加消息。即使有列表项可见，它甚至也不会删除无内容消息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:28:09.537

阅读文档：你不需要做你正在做的事情。

只需使用该`noResults`选项。

他们的例子：

```
$('input#search').quicksearch('table tbody tr', {
    'delay': 100,
    'selector': 'th',
    'stripeRows': ['odd', 'even'],
    'loader': 'span.loading',
    'noResults': 'tr#noresults',
    ....... 
```

看起来你想要`'noResults': '#noContent'`

# android - 如何更改操作栏 API 15 的样式

> ID：14589671
> 
> 赞同：0
> 
> 时间：2013-01-29T18:25:49.700
> 
> 标签：android, styles, android-actionbar

我想更改操作栏的样式，所以我想将操作栏下的线条颜色从 Blue 更改为 Orange ，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:30:20.570

[这里](http://android-developers.blogspot.it/2011/04/customizing-action-bar.html)有一个很好的教程

使用您的自定义可绘制对象创建新样式

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <!-- the theme applied to the application or activity -->
    <style name="Theme.MyStyle" parent="@android:style/Theme.Holo">
        <item name="android:actionBarStyle">@style/MyActionBar</item>
        <!-- other activity and action bar styles here -->
    </style>

    <!-- style for the action bar backgrounds -->
    <style name="MyActionBar" parent="@android:style/Widget.Holo.ActionBar">
        <item name="android:background">@drawable/ab_background</item>
        <item name="android:backgroundStacked">@drawable/ab_background</item>
        <item name="android:backgroundSplit">@drawable/ab_split_background</item>
    </style>
</resources> 
```

然后在**AndroidManifest.xml**添加自定义样式

```
<application
        android:debuggable="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"

        android:theme="@style/Theme.MyStyle"
        >
   <activity ...>
   <activity .../>
   ...

</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:33:57.517

如果你想通过代码改变它，你可以试试这个：

```
getActionBar().setBackgroundDrawable(getResources().getDrawable(R.drawable.myninepatch)); 
```

# php - 在 PHP 中，如何从偏移量和国家/地区获取时区？

> ID：14589678
> 
> 赞同：2
> 
> 时间：2013-01-29T18:26:12.520
> 
> 标签：php, timezone

我正在进行 IP 查找以确定与 UTC 和国家/地区信息的时区偏移的“最佳猜测”。

因此，例如，我有抵消 -3 和国家巴西。

我想在同一偏移量中显示 BRT 而不是随机时区，即 ART

PHP中是否有一些内置方法可以使用此信息设置适当的时区？

如果没有，最简单的方法是什么？（假设我不能进行任何外部 API 调用）

如果我自己做数据库表，如何确保它保持最新？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T18:10:27.633

您*无法*从偏移量，甚至是偏移量加国家/地区解析时区。请参阅[TimeZone 标签 wiki](https://stackoverflow.com/tags/timezone/info)`TimeZone != Offset`部分。偏移量在很多时间点都发生了变化，并且不可避免地会再次发生变化。

您需要更多信息，例如纬度/经度。请参阅[此社区维基](https://stackoverflow.com/q/16086962/634824)。

如果您可以向您的用户询问他们的时区，请这样做。这是最好的方法。我最喜欢的 UI 是一个基于 JavaScript 地图的时区选择器，[例如这个](https://github.com/dosx/timezone-picker). 您可以使用[jsTimeZoneDetect](https://bitbucket.org/pellepim/jstimezonedetect)做出最佳猜测默认选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:38:13.510

您不必滚动自己的数据库，这是[GeoNames](http://www.geonames.org/export/)中的一个。您还[可以从 PHP 获取所有时区信息](https://stackoverflow.com/a/1727150/1493698)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-23T12:47:27.900

这个 PHP 函数返回一个包含所有现有时区的数组，包括偏移量，不完全是您正在寻找的，但它可能会有所帮助：

```
function time_zonelist(){
    $return = array();
    $timezone_identifiers_list = timezone_identifiers_list();
    foreach($timezone_identifiers_list as $timezone_identifier){
        $date_time_zone = new DateTimeZone($timezone_identifier);
        $date_time = new DateTime('now', $date_time_zone);
        $hours = floor($date_time_zone->getOffset($date_time) / 3600);
        $mins = floor(($date_time_zone->getOffset($date_time) - ($hours*3600)) / 60);
        $hours = 'GMT' . ($hours < 0 ? $hours : '+'.$hours);
        $mins = ($mins > 0 ? $mins : '0'.$mins);
        $text = str_replace("_"," ",$timezone_identifier);
        $return[$timezone_identifier] = $text.' ('.$hours.':'.$mins.')';
    }
    return $return;
} 
```

# sql - UPDATE 存在的行，INSERT 不存在的行

> ID：14589687
> 
> 赞同：1
> 
> 时间：2013-01-29T18:26:42.240
> 
> 标签：sql, sql-server-2008

我有两张桌子。用户和用户映射。我需要这样的东西...

```
INSERT INTO USERS (USER_ID, VALUE_TYPE, SOME_VALUE)
SELECT USERS.ID, 0, 1 
```

问题是如果用户和类型已经存在，我想更新而不是插入。这是我的解决方案。

```
DELETE FROM USERS
WHERE USERS.VALUE_TYPE = 0

INSERT INTO USERS (USER_ID, VALUE_TYPE, SOME_VALUE)
SELECT USERS.ID, 0, 1
FROM USERS 
```

这行得通，我只是在寻找更好的东西，如果它存在的话。有什么建议吗？

编辑。哎呀，我打错了。很抱歉造成混乱，并感谢所有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T19:00:20.303

你目前正在做的事情非常昂贵。如果您有一百万行并且只有四行发生了变化怎么办？如果没有行发生变化怎么办？

典型的模型是这样的：

```
-- first, update the rows that match
UPDATE u
  SET SOME_VALUE = m.SOME_VALUE
  FROM dbo.Users AS u
  INNER JOIN dbo.UserMap AS m
  ON u.ID = m.USER_ID
  AND u.VALUE_TYPE = m.VALUE_TYPE
  WHERE u.VALUE_TYPE = 0;

-- next, add the rows that don't match
INSERT dbo.Users(USER_ID, VALUE_TYPE, SOME_VALUE)
  SELECT m.USER_ID, 0, 1
  FROM dbo.UserMap AS m
  WHERE NOT EXISTS 
  (
    SELECT 1 FROM dbo.Users
      WHERE ID = m.USER_ID
      AND VALUE_TYPE = 0
  ); 
```

你也可以使用[`MERGE`](http://technet.microsoft.com/en-us/library/bb510625%28v=sql.100%29.aspx)，但我个人觉得语法相当令人生畏。此外，我不确定我是否相信[针对它报告的所有错误](https://www.google.com/webhp?sourceid=chrome-instant&rlz=1C5CHFA_enUS503US503&ion=1&ie=UTF-8#hl=en&tbo=d&rlz=1C5CHFA_enUS503US503&sclient=psy-ab&q=merge%20bug%20site%3Aconnect.microsoft.com&oq=&gs_l=&pbx=1&fp=4a19662fa4882be9&ion=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.41524429,d.dmQ&biw=2141&bih=1421)都已解决。（[不同的链接](http://connect.microsoft.com/SQLServer/SearchResults.aspx?SearchQuery=merge%2bbug)。）

# javascript - 为什么我不能以相同的方式引用所有属性？

> ID：14589691
> 
> 赞同：0
> 
> 时间：2013-01-29T18:27:02.060
> 
> 标签：javascript, html

我正在动态创建一个*输入*标签，它具有以下属性。

```
<input id='beep' id2='boop'></input> 
```

虽然我可以通过以下两种语法中的任何一种来引用第一个

```
var tag = document.getElementById("beep");
alert(tag.id);
alert(tag.attributes["id"]); 
```

*当涉及到我的自定义属性id2*时，我被迫使用后者。为什么？

```
var tag = document.getElementById("beep");
alert(tag.id2); // doesn't work - I get *undefined*
alert(tag.attributes["id2"]);
alert(tag["id2"]); // doesn't work - I get *undefined* 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:29:11.567

只有标准属性具有相关属性，`id2`是非标准的，因此它没有关联的属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T18:33:31.843

您在这里混合了两件事：HTML 和 DOM。HTML 有标签和属性的概念，而 DOM 有节点和属性的概念，虽然它们看起来很相似，但它们是独立的技术（至少在其核心）。

创建 DOM 元素时，只有官方的 HTML 属性（甚至可能不是全部）映射到 DOM 属性。在这个过程中也可能会被修改。DOM 节点上可用的属性在[DOM](http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html)和[HTML DOM 规范](http://www.w3.org/TR/DOM-Level-2-HTML/html.html)中定义。

元素`value`属性示例：`input`

> 当`type`元素的属性值为或时`"text"`，这表示交互式用户代理中相应表单控件的当前内容。更改此属性会更改表单控件的内容，但不会更改元素的 HTML 属性的值。当元素的属性值为、、、、或时，这表示元素的 HTML 值属性。请参阅 HTML 4.01 中的 value 属性定义。`"file"``"password"``value``type``"button"``"hidden"``"submit"``"reset"``"image"``"checkbox"``"radio"`

或者DOM 中的`class`HTML 属性：`className`

> 元素的`class`属性。由于与`"class"`许多语言公开的关键字冲突，此属性已被重命名。请参阅`class`HTML 4.01 中的属性定义。

您可以通过 访问所有 HTML 属性[`.getAttribute`](https://developer.mozilla.org/en/docs/DOM/element.getAttribute)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T18:30:48.050

某些浏览器确实支持您尝试执行的操作，但我不知道具体是哪个，对于自定义属性`<input data-id2="boop" />`，可以像这样使用和访问它：

```
var tag = document.getElementById("beep");
var id2 = tag.dataset.id2 
```

参见[元素数据集](https://developer.mozilla.org/en-US/docs/DOM/element.dataset)

# windows-7 - RubyTest Sublime Text 2 在 Windows 7 上不起作用

> ID：14589692
> 
> 赞同：2
> 
> 时间：2013-01-29T18:27:03.097
> 
> 标签：windows-7, sublimetext2, ruby-test

我已经搞砸了一个多小时，仍然无法让 RubyTest 在 Sublime Text 2 中工作。每次我尝试运行测试时，我都会收到一条简单的消息，即“'rspec' 未被识别为内部或外部命令、可运行的程序或批处理文件。”

我尝试了从 github 克隆安装 RubyTest 的方法，以及通过 Package Installer 获得相同的结果。我正在通过“subl”启动 Sublime Text 2。从我的应用程序的目录。

我知道我只是遗漏了一些简单的东西，但是我在网上找到的所有修复程序都特定于非 Windows 环境，我无法根据我的情况调整答案。

我没有使用 pik 或任何其他 Ruby 版本管理器。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T21:04:15.890

想通了，需要在我的用户 - RubyTest.sublime-settings 文件中的“rspec”命令前加上“bundle exec”才能使其工作。– 罗布 2013 年 1 月 29 日在 20:26

# c# - 在本地开发时（使用 Elmah）向该特定用户发送错误电子邮件？

> ID：14589697
> 
> 赞同：0
> 
> 时间：2013-01-29T18:27:09.447
> 
> 标签：c#, asp.net-mvc, web-config, elmah

我正在使用 Elmah，我希望发生的是，当我们的多个开发人员之一在本地运行他们的项目时，他们只会收到从该本地实例生成的任何错误电子邮件，如果在实时服务器上生成错误，请发送电子邮件不同的（组）电子邮件。现在我们只是使用（可怕的）方法，每个人都有自己的 web.config，不应该（但有时会）提交给我们的 Repo，然后在部署到 live 时更改电子邮件字符串。

我们都在使用 VS 2010 和 Cassini，但开发人员可以在他们的工作计算机或通过 VPN 连接的家用计算机上工作，但他们在家用计算机上的登录名并不能反映他们的工作计算机用户名。

到目前为止，我基本上只有这个 ELMAH 电子邮件设置：

```
<errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="ElmahDb" />
<errorMail from="no-reply@mydomain.com" to="myemail@mydomain.com" subject="Project Error" smtpPort="0" async="false" /> 
```

Application_Start 中的一个空方法：

```
protected void Application_Start()
    {
        Config.SetErrorEmailReceiver();
    }

public static void SetErrorEmailReceiver()
    {
        //some logic
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:51:22.457

最好的方法可能是使用外部配置文件。所以，你会改变你的 web.config 说：

```
<errorMail configSource="elmah-errorMail.config" /> 
```

然后每个开发人员将拥有自己的该文件的副本，其中包含：

```
<errorMail from="no-reply@mydomain.com" to="myemail@mydomain.com" subject="Project Error" smtpPort="0" async="false" /> 
```

当然，您的生产网络服务器上也有生产价值。

不过，我仍然不明白您为什么要将电子邮件发送给开发人员。一个黄色的死亡屏幕还不够警报吗：）

# c# - 客户端断开连接时聊天客户端崩溃

> ID：14589699
> 
> 赞同：0
> 
> 时间：2013-01-29T18:27:32.473
> 
> 标签：c#, client, runtime, chat, disconnect

我一直在关注一个制作聊天程序的旧教程，并且我一直在对其进行剖析以适应新形式，尽管我已经让它按预期工作，但它遇到了错误：“无法从传输中读取数据连接：阻塞操作被 WSACancelBlockingCall 调用中断。”

指向这部分代码。

```
 while (Connected)
        {
            // Show the messages in the log TextBox
            this.Invoke(new UpdateLogCallback(this.UpdateLog), new object[] { srReceiver.ReadLine() });
        } 
```

我只有在关闭客户端或断开连接时才会收到错误消息。

这是大部分客户端代码。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.IO;

namespace Table_Top_RPG
{
    public partial class Connect : Form
    {
        // Will hold the user name
        private string UserName = "Unknown";
        public static StreamWriter swSender;
        private StreamReader srReceiver;
        private TcpClient tcpServer;
        // Needed to update the form with messages from another thread
        private delegate void UpdateLogCallback(string strMessage);
        // Needed to set the form to a "disconnected" state from another thread
        private delegate void CloseConnectionCallback(string strReason);
        private Thread thrMessaging;
        private IPAddress ipAddr;
        private bool Connected;

        public Connect()
        {
            // On application exit, don't forget to disconnect first
            Application.ApplicationExit += new EventHandler(OnApplicationExit);
            InitializeComponent();
        }

        private void BtnConnect_Click(object sender, EventArgs e)
        {
            // If we are not currently connected but awaiting to connect
            if (Connected == false)
            {
                InitializeConnection();

            }
            else // We are connected, thus disconnect
            {
                CloseConnection("Disconnected at user's request.");
            }
        }

        // The event handler for application exit
        public void OnApplicationExit(object sender, EventArgs e)
        {
            if (Connected == true)
            {
                // Closes the connections, streams, etc.
                Connected = false;
                swSender.Close();
                srReceiver.Close();
                tcpServer.Close();
            }
        }

        private void InitializeConnection()
        {
            // Parse the IP address from the TextBox into an IPAddress object
            ipAddr = IPAddress.Parse(Connect.IpBox.Text);
            // Start a new TCP connections to the chat server
            tcpServer = new TcpClient();
            tcpServer.Connect(ipAddr, int.Parse(Connect.PortBox.Text));
            // Helps us track whether we're connected or not
            Connected = true;
            // Prepare the form
            UserName = Connect.NameBox.Text;
            // Disable and enable the appropriate fields
            IpBox.Enabled = false;
            NameBox.Enabled = false;
            Main.TxtMsg.Enabled = true;
            Connect.BtnConnect.Text = "Disconnect";
            // Send the desired username to the server
            swSender = new StreamWriter(tcpServer.GetStream());
            swSender.WriteLine(UserName);
            swSender.Flush();
            // Start the thread for receiving messages and further communication
            thrMessaging = new Thread(new ThreadStart(ReceiveMessages));
            thrMessaging.Start();
        }

        private void ReceiveMessages()
        {
            // Receive the response from the server
            srReceiver = new StreamReader(tcpServer.GetStream());
            // If the first character of the response is 1, connection was successful
            string ConResponse = srReceiver.ReadLine();
            // If the first character is a 1, connection was successful
            if (ConResponse[0] == '1')
            {
                // Update the form to tell it we are now connected
                this.Invoke(new UpdateLogCallback(this.UpdateLog), new object[] { "Connected Successfully!" });
            }
            else // If the first character is not a 1 (probably a 0), the connection was unsuccessful
            {
                string Reason = "Not Connected: ";
                // Extract the reason out of the response message. The reason starts at the 3rd character
                Reason += ConResponse.Substring(2, ConResponse.Length - 2);
                // Update the form with the reason why we couldn't connect
                this.Invoke(new CloseConnectionCallback(this.CloseConnection), new object[] { Reason });
                // Exit the method
                return;
                }
                // While we are successfully connected, read incoming lines from the server
                while (Connected)
                {
                    // Show the messages in the log TextBox
                    this.Invoke(new UpdateLogCallback(this.UpdateLog), new object[] { srReceiver.ReadLine() });
                }
            }

            internal void CloseConnection(string Reason)
            {
                // Show the reason why the connection is ending
                Main.ChatLog.AppendText(Reason + "\r\n");
                // Enable and disable the appropriate controls on the form
                IpBox.Enabled = true;
                NameBox.Enabled = true;
                Main.TxtMsg.Enabled = false;
                BtnConnect.Text = "Connect";
                // Close the objects
                Connected = false;
                swSender.Close();
                srReceiver.Close();
                tcpServer.Close();
            }

            // This method is called from a different thread in order to update the log TextBox
            private void UpdateLog(string strMessage)
            {
                // Append text also scrolls the TextBox to the bottom each time
                Main.ChatLog.AppendText(strMessage + "\r\n");
            }
        }
    } 
```

还有另一种称为 Main 的表单，其中发送了所有聊天对话框，但其大部分代码不相关。

如果有人知道更好的方法来处理这个问题或者知道一个好的聊天程序教程，我可以通过更好的例子来了解如何正确处理客户端连接和断开连接而不会崩溃，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:39:40.480

您可能应该考虑使用没有阻塞调用的异步编程。正如您肯定知道的那样，问题在于您在通话期间关闭了您的客户端。

我很确定 NetworkStream 和 StreamReader/Writer 确实有一些异步方法。尝试在这里查看一些：http: [//msdn.microsoft.com/en-us/library/system.io.streamreader.readasync.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readasync.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:07:19.530

我相信您需要在每次使用时关闭并处理每个流，因为您正在同步执行它们。考虑使用 using 语句进行写作......并为阅读做类似的事情。另外不要忘记将它们从 CloseConnection 中删除...

```
using (NetworkStream ns=tcpServer.GetStream())
{
    swSender = new StreamWriter(ns);
    swSender.WriteLine(UserName);
    swSender.Flush();
    ns.Close();
    ns.Dispose();
    swSender = null;
} 
```

# pentaho - Pentaho BI-Server JDBC 异常

> ID：14589701
> 
> 赞同：2
> 
> 时间：2013-01-29T18:27:38.170
> 
> 标签：pentaho

我正在设置 pentaho 双服务器，当我运行 start-pentaho.sh 时出现以下异常：

```
11:45:29,280 ERROR [SchemaUpdate] could not get database metadata
java.sql.SQLException: socket creation error
        at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
        at org.hsqldb.jdbc.jdbcConnection.<init>(Unknown Source)
        at org.hsqldb.jdbcDriver.getConnection(Unknown Source)
        at org.hsqldb.jdbcDriver.connect(Unknown Source)
        at java.sql.DriverManager.getConnection(Unknown Source)
        at java.sql.DriverManager.getConnection(Unknown Source)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:174)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:165)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:149)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:119)
        at org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.getConnection(LocalDataSourceConnectionProvider.java:82)
        at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)
        at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)
        at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:314)
        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1300)
        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newSessionFactory(LocalSessionFactoryBean.java:814)
        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:732)
        at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1369) 
```

我想我一定错过了将我的数据库用户名/密码和主机名添加到配置文件中。但是，我不知道我错过了更新的几个 pentaho 配置文件中的哪一个。从堆栈跟踪中，有人对我需要使用正确的数据库凭据更新哪个 pentaho 文件有任何建议吗？谢谢。

更新 - 我已经更新的三个配置文件是：

```
pentaho-solutions/system/hibernate/mysql5.hibernate.cfg.xml
pentaho-solutions/system/hibernate/hibernate-settings.xml
pentaho-solutions/system/applicationContext-spring-security-jdbc.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:23:29.783

听起来您需要更新文件 pentaho-solutions/system/applicationContext-spring-security-hibernate.propertie‌​s！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-24T02:51:59.637

你有 jdbc 库到 tomcat/lib 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-24T08:50:10.340

我不知道这可以帮助你，但我尝试[http://anonymousbi.wordpress.com/2012/10/28/pentaho-bi-server-4-5-0-definitive-mysql-installation-guide/](http://anonymousbi.wordpress.com/2012/10/28/pentaho-bi-server-4-5-0-definitive-mysql-installation-guide/)

# asp.net - EF 4.3 部署时的问题

> ID：14589702
> 
> 赞同：0
> 
> 时间：2013-01-29T18:27:42.783
> 
> 标签：asp.net, entity-framework, entity-framework-4.3

我在本地机器上安装了 EF4.3.1。

我创建了一个新的 Web 应用程序项目并添加了框架。然后我创建了一个数据库/模型等。该框架分为 2 个项目，1 个 DAL，1 个实体。在我的本地机器上，我仅限于 SQL Express 2008。

这是来自 web config 的配置部分：

```
 <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  </configSections> 
```

这是我使用的连接字符串：

```
<add name="PayDayLoanEntities" connectionString="metadata=res://*/Models.PayDayLoans.csdl|res://*/Models.PayDayLoans.ssdl|res://*/Models.PayDayLoans.msl;provider=System.Data.SqlClient;provider connection string='data source=.\SQLEXPRESS;attachdbfilename=&quot;C:\Documents and Settings\John\My Documents\Visual Studio 2010\Projects\IL\WebSite\App_Data\PayDayLoans.mdf&quot;;integrated security=True;connect timeout=30;user instance=True;multipleactiveresultsets=True;App=EntityFramework'" providerName="System.Data.EntityClient" /> 
```

这一切都有效！

在我的生产机器上，我使用 SQL 2008 网络版，因此将连接字符串更改如下：

```
<add name="PayDayLoanEntities" connectionString="metadata=res://*/Models.PayDayLoans.csdl|res://*/Models.PayDayLoans.ssdl|res://*/Models.PayDayLoans.msl;provider=System.Data.SqlClient;provider connection string='Data Source=localhost;Initial Catalog=PayDayLoans;uid=***;pwd=********&quot;;integrated security=True;connect timeout=30;user instance=True;multipleactiveresultsets=True;App=EntityFramework'" providerName="System.Data.EntityClient" /> 
```

但是，我收到以下错误消息：

```
Could not load file or assembly 'EntityFramework, Version=4.1.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

配置部分指的是 4.3.1，但错误是 4.1.0。有人知道我在这里缺少什么吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:33:12.930

很有可能您的解决方案中的某些内容在为 RELEASE 构建时引用了 EF 4.1.0。也许您的构建服务器没有正确更新？

在您的生产机器上运行[Fuslogvw](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.71%29.aspx)（以管理员身份，否则它会静默失败）。在启动 Web 应用程序之前开始记录绑定失败。Fuslogvw 会告诉你究竟是什么试图绑定 EF 4.1.0。

# c++ - 一个对象如何在 main() 和静态库中都可见？

> ID：14589707
> 
> 赞同：0
> 
> 时间：2013-01-29T18:27:58.853
> 
> 标签：c++, static-libraries

如何定义一个对象，以便可以从 main() 函数和静态库访问它？

该对象可以是静态的（在我的情况下它是一个记录器）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:41:10.080

您只需要将对象的声明放入主程序和库共享的公共头文件中。然后你可以把它的定义放在一个或另一个中，当一切都联系在一起时，它就会像你期望的那样工作。

# java - 关于桌面应用程序中的 Metro GUI

> ID：14589714
> 
> 赞同：0
> 
> 时间：2013-01-29T18:28:22.767
> 
> 标签：java, swing, microsoft-metro, awt, look-and-feel

我正在制作一个同时支持多种功能的软件。我知道逻辑，并且我已经开发了要支持的功能。

我希望我的项目看起来类似于 Windows 8 的 Metro GUI。它不需要特别是 Metro，而是类似的。

我知道标准 Swing 库中的所有布局。目前我正在使用`GroupLayout`。我应该如何进行，有什么想法吗？因为 UI 看起来很枯燥，而且我也不想使用 3rd 方 API。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T20:16:37.090

我个人会使用`GridBagLayout`，只是因为它可以让您为每个“组”提供更好的加权约束，但即使这样也可能并不完全合适。

我还会查看 Metro UX 指南以获取更多想法

这些可能会有所帮助

*   [http://msdn.microsoft.com/en-au/library/windows/apps/hh465403.aspx#tile_design_philosophy](http://msdn.microsoft.com/en-au/library/windows/apps/hh465403.aspx#tile_design_philosophy)
*   [http://blendinsider.com/technical/ux-guidelines-for-metro-style-app-development-2011-10-21/](http://blendinsider.com/technical/ux-guidelines-for-metro-style-app-development-2011-10-21/)（查找关于瓷砖的部分）

# sql-server-2012 - 当没有要删除的行时，在 sqlserver 中锁定和删除

> ID：14589716
> 
> 赞同：0
> 
> 时间：2013-01-29T18:28:31.137
> 
> 标签：sql-server-2012, locks

使用SqlServer2012，调用有没有优势

```
if exists (select * from tablename where condition) begin
   delete tablename where condition
end 
```

刚刚打电话

```
 delete tablename where condition 
```

什么时候通常不会有任何行匹配条件？

特别是，它会导致持有更少（或更少限制）的锁吗？

我正在进行适当的交易，因此我避免了竞争条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:38:16.353

SQL Server 不能折叠这两个语句，只能执行一次锁。但无论如何，这很容易证明。让我们创建一个 AdventureWorks 表的副本，执行您的两种类型的操作，并比较所使用的锁。您将看到您首先检查的方法执行的锁大约是两倍 - 您可以通过将输出的两个部分拆分为单独的文件并对它们进行任何类型的差异来检查这一点（或者只是比较大小 - 在我的情况下1.7 MB 与 788 KB）。

```
SELECT * INTO dbo.kablatz
  FROM AdventureWorks2012.Sales.SalesOrderHeader;

SET NOCOUNT ON;

DBCC FREEPROCCACHE WITH NO_INFOMSGS;
DBCC DROPCLEANBUFFERS WITH NO_INFOMSGS;

PRINT '---------------- Check first';

DBCC TRACEON(1200,3604,-1) WITH NO_INFOMSGS;

IF EXISTS (SELECT 1 FROM dbo.kablatz WHERE OrderDate < '20100101')
  DELETE dbo.kablatz WHERE OrderDate < '20100101';

DBCC TRACEOFF(1200,3604,-1) WITH NO_INFOMSGS;

DBCC FREEPROCCACHE WITH NO_INFOMSGS;
DBCC DROPCLEANBUFFERS WITH NO_INFOMSGS;

PRINT '---------------- Don''t check first';

DBCC TRACEON(1200,3604,-1) WITH NO_INFOMSGS;

DELETE dbo.kablatz WHERE OrderDate < '20100101';

DBCC TRACEOFF(1200,3604,-1) WITH NO_INFOMSGS;

GO
DROP TABLE dbo.kablatz; 
```

逻辑会告诉我们，删除行的检查已经发生在删除操作中。为什么要重复？

# php - 具有重复键的数组

> ID：14589717
> 
> 赞同：0
> 
> 时间：2013-01-29T18:28:38.593
> 
> 标签：php, arrays

我正在尝试从 CSV 文件导入一些产品。我正在使用我在 PHP 网站上找到的示例。

在获得一些数据并做出一些逻辑之后，我最终得到了这个：

```
Array
(
    [attribute_set_id] => 9
    [status] => 1
    [visibility] => 4
    [store] => en
    [store] => es
) 
```

如您所见，密钥库是重复的！

一个 var_dump

```
array(5) {
  ["attribute_set_id"]=>
  int(9)
  ["status"]=>
  int(1)
  ["visibility"]=>
  int(4)
  ["store"]=>
  string(2) "en"
  ["store"]=>
  string(2) "es"
} 
```

更糟糕的是，`isset()`总是返回`false`，`strlen`总是返回`0`。

有人可以帮我解决这个问题吗？

编辑：

在完成了 fab 的建议后，我得到了这个结果：

```
array(6) {
  [0]=>
  string(16) "attribute_set_id"
  [1]=>
  string(8) "store"
  [2]=>
  string(3) "sku"
  [3]=>
  string(4) "name"
  [4]=>
  string(17) "short_description"
  [5]=>
  string(5) "store"
} 
```

第一个存储键的长度为 8?。如何删除隐藏的字符？是否有在服务器级别进行的选项？因为在我搬到另一家托管公司之前，这个问题并没有发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:34:24.873

这只有在密钥中有不可见字符时才有可能。要验证它，试试这个：

```
var_dump(array_keys($your_array)); 
```

并查找字符串长度。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-01-29T18:33:36.507

所以你想删除重复的键？

为什么不在 PHP 中使用[array_unique()](http://php.net/manual/en/function.array-unique.php)方法。所以它看起来像这样：

```
$arrayWithoutDuplicates = array_unique($originalArray); 
```

# html - 如何删除/覆盖边界的一部分？

> ID：14589718
> 
> 赞同：0
> 
> 时间：2013-01-29T18:28:40.347
> 
> 标签：html, css, border

如何删除/覆盖右侧的 14px 边框`main_right_article_pic.png`？

![MSA](../Images/09b9a0dfe8a93c410224f277afec6198.png)

**HTML：**

```
<div class="main_right_article">
<span class="main_right_article_left">
    <img src="img/main_right_article_pic.png" width="54" height="54" alt="Joe Bloggs">
</span>
<article>
    <h4>Joe Bloggs</h4>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut mollis fringilla mi quis sollicitudin. Maecenas orci diam, congue eget sodales nec, facilisis eu eros.</p>
</article>
</div> 
```

**CSS：**

```
*
{
    margin: 0;
    padding: 0;
}

body
{
    font-family: 'Open Sans', sans-serif;
}

div.main_right_article
{
    clear: both;
    float: left;
    margin-top: 25px;
    width: 425px;
}

span.main_right_article_left
{
    float: left;
    background: url("../img/article_mark.png") no-repeat right 20px;
    height: 54px;
    width: 73px;
}

article
{
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
    background-color: #f1f1f1;
    border: 1px solid #c9c9ca;
    float: right;
    padding: 10px;
    width: 330px;
}

article h4
{
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 10px;
    text-shadow: 1px 1px 1px rgba(21, 21, 21, 0.3);
}

article p
{
    font-size: 12px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T02:45:14.800

我是这样做的：

**CSS：**

```
span.main_right_article_left
{
    float: left;
    height: 54px;
    width: 54px;
}

span.main_right_article_mark
{
    background-image: url("../img/article_mark.png");
    float: left;
    height: 14px;
    position: relative;
    right: -6px;
    top: 20px;
    width: 14px;
} 
```

**HTML：**

```
<div class="main_right_article">
    <span class="main_right_article_left std_pic">
        <img src="img/main_right_article_pic.png" width="54" height="54" alt="Joe Bloggs">
    </span>
    <span class="main_right_article_mark">&nbsp;</span>
    <article>
        <h4>Joe Bloggs</h4>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut mollis fringilla mi quis sollicitudin. Maecenas orci diam, congue eget sodales nec, facilisis eu eros.</p>
    </article>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:30:03.457

您可以使用 CSS 中的工具提示来避免此问题。

见：[http ://csstooltip.com](http://csstooltip.com)

# php - 在 openvbx 中使用 exec()

> ID：14589721
> 
> 赞同：1
> 
> 时间：2013-01-29T18:28:52.383
> 
> 标签：php, twilio

我正在尝试在 OpenVBX 中构建小程序，将 API 调用添加到 Desk（以前称为 Assistly）。

由于 Oauth 身份验证，我通常使用 twurl 来完成此操作 - 在 php 中，我一直在使用 exec() 进行 API 调用。但是，在实际流程中运行时，twiml.php 似乎不允许使用 exec()，甚至不允许使用反引号 (shell_exec())

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T19:06:26.183

exec() 不起作用的最常见原因是 PHP 的 safe_mode 被打开。从您发布的其他地方，我知道情况并非如此。

下一个最常见的原因是 exec（或特别是 libexec）被特别禁用。

之后，您开始自己遇到执行问题。命令行/shell 环境将具有与 Apache 环境不同的 php.ini，因此您的包含、PATH 等可能在两者之间有所不同。

您是否收到任何可以在 PHP error_log 中分享的特定错误？

# javascript - 有没有办法在没有 jquery 的情况下检测窗口的位置

> ID：14589722
> 
> 赞同：1
> 
> 时间：2013-01-29T18:29:01.003
> 
> 标签：javascript, css, onscroll

所以这就是我想要做的，我在页面顶部有一个粘性导航，背景是透明的。但是当用户向下滚动并且内容位于导航下方时，我想更改导航的背景，使其不透明。现在我已经实现了这一点，但我的问题是：当用户滚动回页面顶部时，导航背景是否可能再次变得透明？

例如：用户加载页面，导航是透明的，用户向下滚动，导航背景变为非透明，然后用户滚动回到页面顶部。是否可以让导航背景再次变得透明？我也试图在不使用 jquery 的情况下实现这一点！所以请只用原始的javascript回答！

```
___JS___
window.onscroll = function nav_bg(){
var header = document.getElementById("header");
header.setAttribute('style','background-color:rgba(0,0,0,1);')
}

___CSS___
#header{background-color:rgba(0,0,0,.4);} 
```

这是我当前的代码，但是当用户滚动回顶部时，背景保持不透明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:32:03.380

这就是 jQuery 的做法：

```
var doc = document.documentElement, body = document.body;
var left = (doc && doc.scrollLeft || body && body.scrollLeft || 0);
var top = (doc && doc.scrollTop  || body && body.scrollTop  || 0); 
```

一旦你知道窗口滚动到哪里，你只需要绑定到“滚动”事件（如果没有 jQuery，绑定有点棘手，只是因为旧浏览器有不同的方法来处理事件绑定）

```
var addEvent = (function( window, document ) {
 if ( document.addEventListener ) {
  return function( elem, type, cb ) {
   if ( (elem && !elem.length) || elem === window ) {
    elem.addEventListener(type, cb, false );
   }
   else if ( elem && elem.length ) {
    var len = elem.length;
    for ( var i = 0; i < len; i++ ) {
     addEvent( elem[i], type, cb );
    }
   }
  };
 }
 else if ( document.attachEvent ) {
  return function ( elem, type, cb ) {
   if ( (elem && !elem.length) || elem === window ) {
    elem.attachEvent( 'on' + type, function() { return cb.call(elem, window.event) } );
   }
   else if ( elem.length ) {
    var len = elem.length;
    for ( var i = 0; i < len; i++ ) {
     addEvent( elem[i], type, cb );
    }
   }
 };
}
})( this, document );
// Example Usage
addEvent( window, 'scroll', function() {
 //Test scroll position and set style
}); 
```

（这是从[这个页面](http://net.tutsplus.com/tutorials/javascript-ajax/javascript-from-null-cross-browser-event-binding/)获取的）

# css - 智能手机上的 HTML 菜单行为

> ID：14589723
> 
> 赞同：2
> 
> 时间：2013-01-29T18:29:08.133
> 
> 标签：css, html, responsive-design

目前正在尝试制作一个响应智能手机和平板电脑的网站。我在网站的菜单上遇到了一些麻烦。菜单基本上是这样的无序列表：

```
<ul class="navigation">
    <li><a href="page1.html">Page1</a></li>
    <li><a href="page2.html">Page2</a></li>
    <li>
        <a href="page3.html">Page3</a>
        <!-- Dropdown menu -->
        <ul class="subnav">
            <li><a href="page4.html">Page4</a></li>
        </ul>
    </li>      
</ul> 
```

内部无序列表是用户悬停`page3.html`链接时出现的下拉菜单。

在手机和平​​板电脑上，我希望菜单像手风琴一样，所以当用户触摸`page3.html`链接时，`subnav`列表会出现并将其他列表项向下推。我通过简单地将下拉列表设置为固定位置而不是让它在桌面上工作`position:absolute;`但是，在移动设备和平板电脑上，触摸`page3.html`仍将作为链接工作，因此用户当然会被重定向到`page3.html`而不是触发`subnav`列表。

有什么方法可以触发子导航列表而不触发用户第一次触摸它的链接？:-) 我正在尝试仅使用 CSS 解决方案，但如果需要 JS，我会很乐意使用它。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:41:47.127

有一个用 jQuery ( [Black Studio Touch Dropdown Menu](http://wordpress.org/extend/plugins/black-studio-touch-dropdown-menu/) ) 编写的 Wordpress 插件，它几乎可以满足您的需求。您可以在[此处](http://plugins.svn.wordpress.org/black-studio-touch-dropdown-menu/tags/0.2/)查看源代码并修改为独立于 Wordpress，如果这不是您正在使用的。它基本上检查设备是否是触摸屏设备，如果是，当您单击下拉菜单的父级时，它会展开它而不是单击链接。下一次，它实际上会点击链接。

# java - 在 java 中实现完整的 Diffie-Hellman 密钥交换加密

> ID：14589735
> 
> 赞同：1
> 
> 时间：2013-01-29T18:30:00.887
> 
> 标签：java, encryption, diffie-hellman

我有一个使用套接字发送和接收数据的聊天程序。现在，我想使用 Diffie-Hellman 密钥交换系统通过套接字加密数据传输。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:41:25.160

> 最简单的方法是什么？

使用[JSSE](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html)并配置为使用 Diffie Hellman。
`JSSE`是 Java 的套接字扩展`SSL`。使用`SecureSocket`提供与常规套接字相同接口的类（因此您当前的代码不需要更改）但`SSL`可以在您的网络连接中实现加密。
您应该研究提供的链接以了解如何配置以执行您需要的操作。

# c++ - 如何在 C++ 中将二维数组映射到一维数组中？

> ID：14589738
> 
> 赞同：0
> 
> 时间：2013-01-29T18:30:06.047
> 
> 标签：c++, arrays, matrix

可以说，我有一个 MxN 数组：`int *b;`以及`int **c;`在哪里

1.  中的值`b`由列（从`c`）存储，我需要将值从`c`到`b`
2.  中的值`b`按行（从`c`）存储，我需要将值从`c`到`b`

我知道基本上我会这样做：

```
j = index / N;
i = index - (j * M); 
```

为了将一维索引转换为二维坐标但有问题如何实现这两种情况，1）和2）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:37:54.077

令 W 为 2D 数组的宽度，H 为高度。然后假设行主要布局，一维索引“ix”与二维索引 [x,y] 相关，如下所示：

```
ix = y*w + x;
y = ix / w;  // implicit floor
x = ix % w; 
```

例如：

```
const int W = 3, H=2;
int m[H][W] = {{1,2,3}, {4,5,6}};
int* oneD = &m[0][0];
assert(oneD[1*W + 2] == m[1][2]); // element 6, y=1, x=2 
```

# css - 将 CSS 类应用于多个对象

> ID：14589740
> 
> 赞同：0
> 
> 时间：2013-01-29T18:30:11.563
> 
> 标签：css

我正在尝试将 css 类应用于`<th class='euroth'></th>`位于`table.tablesorter-All-Activity`或中的所有内容`table.tablesorter-Events`。

这就是我所做的

```
table.tablesorter-All-Activity,.tablesorter-Events th.euroth {
    width: 7px;
    vertical-align:middle;
    text-align: left;
    z-index: 5;
    } 
```

结果，第一个表格一直向左移动，第二个表格很好地接受了该样式。

这是为什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:31:10.403

您必须附加`th.euroth`到您的第一个选择器：

```
.tablesorter-All-Activity th.euroth,
.tablesorter-Events th.euroth {
    /* properties go here... */
} 
```

# ios - 如何将红色圆形减号图标作为具有透明背景的png？

> ID：14589742
> 
> 赞同：1
> 
> 时间：2013-01-29T18:30:18.933
> 
> 标签：ios, icons, badge, human-interface

我需要红色减号徽章图标 - 用于删除`UITableView`. 有没有办法以编程方式获取它？我通过谷歌搜索，浏览了几个图标数据库 - 没有成功。

（当我进入表格的编辑模式时获取图标很清楚 - 我需要图标作为视网膜分辨率的设计元素）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:33:38.317

您可以为此使用[UIKit-Artwork-Extractor](https://github.com/0xced/UIKit-Artwork-Extractor)。

# php - HTML中的表单审查

> ID：14589747
> 
> 赞同：0
> 
> 时间：2013-01-29T18:30:26.477
> 
> 标签：php, html, mysql, forms, blob

我希望我没有发布重复的问题，但我环顾四周（也用谷歌搜索了！），没有任何东西给我我正在寻找的答案。

我有一个 HTML 表单。当用户提交表单时，值将与 mysql 一起存储在他们的站点用户帐户下。

问题是，我希望用户能够随时返回并编辑表单。

当用户查看表单时，我当然可以使用来自 php 的值填充表单，但是当我尝试填充文件输入字段（并且文件已使用 blob 类型保存在 mysql 中）时，它变得很棘手。更不用说我想尽可能干净地做到这一点。

理想情况下，如果有一个方便的模块来审查已经在 J​​Query 中提交的表单，那就太好了。

任何人都可以提供任何建议吗？提前致谢！

编辑：这是我的意思的一个很好的例子 - 如果我在 chrome 中填写表单并在点击提交后重定向到下一页，如果我回击我回到表单并且它仍然填写了我之前输入的信息！我是否可以随时调用此行为，而不是仅在用户回击时调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:40:08.163

您不能预先归档`<input type="file"` . . 但是当他们回到表单时，他们肯定想看到他们上传的文件..这就是你的意思..

所以如果它是一张图片，你可以这样做：`<img src="loadpic.php?id=$var" />`

如果是他们上传的文件，只需在某种列表中列出文件名/日期和其他数据......等。

然后你仍然可以显示`<input type="file">`.. 但带有标签“添加更多图片”或“添加另一个文件”。。ETC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T21:31:59.620

除非有人有更好的方法，目前我正在使用两件事的组合：

1) 利用 $_SESSION 变量 2) 将表单中每个输入的“名称”属性设置为它在数据库中对应的字段的名称。

通过这种方式，我可以动态循环遍历所有值，而不是将它们全部硬编码。某些输入类型（如文件）是例外的，将自行处理。其他我可以做这样的事情：

插入mysql：

```
$fields = array();
$values = array();
foreach ($_POST as $field => $value) {
    $fields[] = $field;
    $values[] = addslashes($value);
}

$fieldString = 'Table_Name('.implode(', ', $aFields).')';
$valueString = "VALUES('".implode("', '", $aValues)."')";
mysql_query("INSERT INTO $fieldString $valueString"); 
```

查看表格有点相似。我正在使用 javascript 连接到 document.onload。我需要将 mysql 中的记录传递给 javascript，以便它可以填充表单。然后通过名称获取元素并为它们分配从 php.ini 传递的值是一件简单的事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T18:47:47.897

最简单且不必返回数据库的方法是将值存储在会话中。

```
<?php $_SESSION['myvalue'] = $inputvalue; ?> 
```

在 html 表单上使用：

```
<input type="text" name="myName" value="<?php echo $_SESSION['inputvalue']; ?>" /> 
```

完成后不要忘记取消设置会话变量：

```
<?php session_start(); unset($_SESSION['myvalue']); ?> 
```

# python - D3.js 有向图 Django 集成

> ID：14589748
> 
> 赞同：1
> 
> 时间：2013-01-29T18:30:33.917
> 
> 标签：python, django, d3.js, integration

我有一个简单的 Django 应用程序，它查询数据库并显示返回的对象的字段。我想知道将[这种](http://bl.ocks.org/1153292)有向图可视化集成到我的项目中的最佳方法是什么？到目前为止，我从未使用过 d3。

请允许我解释我的申请。目前，它只是一个表单，允许用户通过输入书籍的唯一 ID 来查询数据库中有关书籍信息的内容。这工作正常，内容通过使用模板显示。

我想做的是使用查询对象的字段之一将数据推送到上面的图形示例中，并在按下文本链接时简单地在新窗口中显示该图形。

这是我的应用程序结构：

# 代码

## myapp.models.py：

```
from django.db import models

class Book(models.Model):
    uid = models.IntegerField(primary_key=True)
    title = models.CharField(max_length=30)
    related_books = models.CharField(max_length=2048)
    class Meta:
        db_table = u'books' 
```

该字段`related_books`包含我希望绘制的数据。`rel_book1 rel_book2 rel_book3 ...`数据以每本书与查询的书对象相关的格式存储，每个对象都有`n`相关的书，但至少总是有两个。

## myproject.templates.search.html：

```
<form action="" method="get">
<label for="id_q">Search:</label>
<input id="id_q" name="q" type="text">
<input type="submit" value="Submit">

{% if found_entries %}
    <ul>
        {% for i in found_entries %}
            {{ i.uid }} {{ i.title }} {{ value|linebreaks }}
        {% endfor %}
    </ul>
{% endif %}
</form> 
```

所以这就是我想显示图表的地方；按下文本链接时在新窗口中显示。

## myapp.views.py：

```
from django.shortcuts import render_to_response
from django.template import RequestContext
from myapp.search import get_query
from myapp.models import Book

def search(request):
    query_string = ''
    found_entries = None

    if ('q' in request.GET) and request.GET['q']:
        query_string = request.GET['q']
        found_entries = Book.objects.filter(uid=query_string)

    return render_to_response('search.html',
                        { 'query_string': query_string, 'found_entries': found_entries },
                          context_instance=RequestContext(request)) 
```

因此，重申一下，用户输入给定书籍的唯一 ID，并显示与该书籍相关的数据库内容。在显示 ID 和标题的那一刻，我还想显示指向有向图示例的链接。

所以我的问题是，当查询 Book 模型时，我将如何从字段中提取信息`related_books`，以便我可以将这些数据推送到图形示例中，为生成的每个 Book 对象生成图形？

谢谢你陪我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:00:37.257

在我看来，您已经掌握了足够的信息。您的视图返回与过滤器匹配的书籍对象，并且`related_books`是 Book 类的成员。

您只需要通过迭代`related_books`每本书的属性来动态生成链接，例如

```
{% for book in found_entries %}
# print out whatever results here
<a href="graphing_page.html?contents=
    {% for content in book.related_books %}content{% endfor %}
">Graph this</a>
{% endfor %} 
```

我不确定 d3 库采用什么参数，但连接组件的列表似乎是合理的。

# html - 如何使文本越过 CSS 背景 img

> ID：14589749
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:30:47.273
> 
> 标签：html, css

我被要求为朋友制作一个按钮，但是我无法使文本保持在正确的位置。

这是我的 HTML 代码

```
<div id="sign-in-button">
    <p>Sign-in</p>
</div> 
```

这是我的 CSS 代码

```
#sign-in-button{
    height: 20px;
    width: 60px;
    background-color: orange;
    background-image: url(external_links_icon.png);
    background-position: right;
    background-repeat: no-repeat;
    border:1px solid gray;
    border-radius: 5px;
    position: absolute;
} 
```

您可能已经注意到“登录”一词不在橙色块内。你们中的任何人都知道解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:51:43.780

它是由 p 标签引起的，请尝试使用 span 标签。

```
<div id="sign-in-button">
  <span>Sign-in</span>
</div> 
```

# oop - 访问coffeescript中包含的类的父类

> ID：14589754
> 
> 赞同：0
> 
> 时间：2013-01-29T18:30:56.013
> 
> 标签：oop, coffeescript

```
 class ChildItem
     constructor : ->
         @activate()
     activate : ->
         if parent.ready #this line will fail
            console.log 'activate!'

  class ParentItem
     constructor : ->
        @ready = true;
        @child = new ChildItem()

  item = new ParentItem() 
```

我如何`item.ready`访问`item.child.activate`？必须有一个语法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:01:30.113

不，这没有特殊的语法。如果您需要 a`ChildItem`和 a之间的关系，`ParentItem`那么您必须自己连接它；例如：

```
class ChildItem
    constructor: (@parent) ->
        @activate()
    activate: ->
        console.log('activate') if(@parent.ready)

class ParentItem
    constructor: ->
        @ready = true
        @child = new ChildItem(@)

item = new ParentItem() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T19:03:14.243

不幸的是，没有语法可以神奇地访问它......即使是这样的东西`arguments.caller`也无济于事。但是有几种方法可以做到这一点，不确定你喜欢哪一种：

1) 传入 ready 参数（或者你也可以传入整个父级）。

```
class ChildItem
   constructor: (ready) ->
     @activate ready
   activate: (ready) ->
     if ready
        console.log 'activate!'

class ParentItem
   constructor : ->
      @ready = true
      @child = new ChildItem(@ready)

item = new ParentItem() 
```

2) 或者您可以使用`extends`which 可以让 ChildItem 访问 ParentItem 的所有属性和功能：

```
class ParentItem
   constructor : (children) ->
      @ready = true
      @childItems = (new ChildItem() for child in [0...children])

class ChildItem extends ParentItem
   constructor: ->
     super()
     @activate()
   activate: ->
     if @ready
        console.log 'activate!'

item = new ParentItem(1) 
```

# excel - VBA让单元格在另一个单元格下方的一行

> ID：14589757
> 
> 赞同：1
> 
> 时间：2013-01-29T18:31:07.700
> 
> 标签：excel, vba

好的，基本上我有一个销售管理系统，列出了所有待售的漫画，我正在尝试添加一种方法来添加另一个漫画。一切正常，但我需要更新显示总数的公式，以及我在下面的代码中尝试过的公式，但是当我尝试将我的 cellnum 设置为搜索返回的行号时，它会抛出一个 object required 错误。

```
Dim cellnum As Integer
Set cellnum = range("B4:B500").Find("TOTALS").Row

Dim cellnum_minus As Integer
Set cellnum_minus = cellnum - 1

Dim cellnum_plus As Integer
Set cellnum_plus = cellnum + 1

range("O" & cellnum).Value = "=SUM(O4:O" & cellnum_minus & ")"
range("Q" & cellnum).Value = "=AVERAGE(O4:O" & cellnum_minus & ")"
range("R" & cellnum).Value = "=MAX(R4:R" & cellnum_minus & ")"
range("S" & cellnum).Value = "=MIN(S4:S" & cellnum_minus & ")"
range("C" & cellnum_plus).Value = "=C" & cellnum & "/10"
range("D" & cellnum_plus).Value = "=D" & cellnum & "/10"
range("E" & cellnum_plus).Value = "=E" & cellnum & "/10"
range("F" & cellnum_plus).Value = "=F" & cellnum & "/10"
range("G" & cellnum_plus).Value = "=G" & cellnum & "/10"
range("H" & cellnum_plus).Value = "=H" & cellnum & "/10"
range("I" & cellnum_plus).Value = "=I" & cellnum & "/10"
range("J" & cellnum_plus).Value = "=J" & cellnum & "/10"
range("K" & cellnum_plus).Value = "=K" & cellnum & "/10"
range("L" & cellnum_plus).Value = "=L" & cellnum & "/10"
range("M" & cellnum_plus).Value = "=M" & cellnum & "/10"
range("N" & cellnum_plus).Value = "=N" & cellnum & "/10" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:34:38.467

为变量赋值时不要使用“set”。`Set`用于分配对对象的引用，就像您想要获取 Range 对象并分配它一样。喜欢`Set myRange = Range("A1:B2")`。

错误的

```
Dim cellnum As Integer
Set cellnum = range("B4:B500").Find("TOTALS").Row 
```

正确的

```
Dim cellnum As Long
cellnum = range("B4:B500").Find("TOTALS").Row 
```

此外，使用 Long 而不是 Integer。无论如何，VBA 都会将 Ints 转换为 Longs，此外还可以避免需要存储更大数字的错误。

# xna - 如何使用 XNA 创建类似 Paint 的应用程序？

> ID：14589760
> 
> 赞同：3
> 
> 时间：2013-01-29T18:31:20.807
> 
> 标签：xna, mouse, line, draw, paint

[此处](https://stackoverflow.com/questions/270138/how-do-i-draw-lines-using-xna)介绍了使用 XNA 以编程方式绘制线条的问题。但是，我希望允许用户像使用 MS Paint 等绘图应用程序一样在画布上绘图。

这当然需要鼠标指针位置的每个 x 和/或 y 坐标变化，以导致在画布上实时以蜡笔颜色绘制线条的另一个“点”。

在鼠标移动事件中，为了逐点绘制线，XNA API 需要考虑哪些因素？当然，从字面上看，我不是画一条线，而是一系列“点”。每个“点”可以并且可能应该大于单个像素。想想用毡尖笔画画。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T00:47:01.760

您提供的文章建议了一种用图元绘制线条的方法；换句话说，**矢量图形。**像 Paint 这样的应用程序大多是**基于像素的**（尽管像 Photoshop 这样的更高级的软件具有矢量和光栅化功能）。

## 位图编辑器

既然您希望它“像油漆一样”，我肯定会采用基于像素的方法：

1.  创建一个颜色值网格。（扩展[System.Drawing.Bitmap](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)类或实现您自己的。）
2.  开始（游戏）循环：
    *   处理输入并相应地更新网格中的颜色值。
    *   [将位图转换为 Texture2D](https://stackoverflow.com/q/2869801/925580)。
    *   使用精灵批处理或自定义渲染器将纹理绘制到屏幕上。
3.  如果需要，请保存位图。

## 在位图上绘图

我在答案的底部添加了我在这里使用的图像类的粗略草稿。但无论如何，代码应该是不言自明的。

如前所述，您还需要实现将图像转换为 Texture2D 并将其绘制到屏幕上的方法。

* * *

首先，我们创建一个新的 10x10 图像并将所有像素设置为白色。

```
var image = new Grid<Color>(10, 10);
image.Initilaize(() => Color.White); 
```

![白色10*10像素网格](../Images/f8e9cbaba809c64d7b8612a8b297896c.png)

接下来我们设置一个画笔。画笔本质上只是一个应用于整个图像的功能。在这种情况下，该函数应将指定圆圈内的所有像素设置为深红色。

```
// Create a circular brush
float brushRadius = 2.5f;
int brushX = 4;
int brushY = 4;
Color brushColor = new Color(0.5f, 0, 0, 1); // dark red 
```

![白色 10*10 彩色网格，带有圆圈和十字定义画笔区域和中心](../Images/a9f4c0220ba9aeef0cb27d53915881b9.png)

现在我们应用画笔。请参阅我的这个 SO 答案，了解如何[识别圆圈内的像素](https://stackoverflow.com/a/14487680/925580)。您可以将鼠标输入用于画笔偏移，并使用户能够在位图上实际绘制。

```
double radiusSquared = brushRadius * brushRadius;

image.Modify((x, y, oldColor) =>
{
    // Use the circle equation
    int deltaX = x - brushX;
    int deltaY = y - brushY;
    double distanceSquared = Math.Pow(deltaX, 2) + Math.Pow(deltaY, 2); 

    // Current pixel lies inside the circle
    if (distanceSquared <= radiusSquared)
    {
        return brushColor;
    }

    return oldColor;
}); 
```

![白色 10*10 彩色网格，圆圈内的所有像素设置为深红色](../Images/b7d105ebf8f8b5bb6c4ca0ed452fc49a.png)

您还可以在画笔颜色和旧像素之间进行插值。例如，您可以通过让混合量取决于画笔中心和当前像素之间的距离来实现“软”画笔。

![白色 10*10 彩色网格，带有柔和的深红色圆点](../Images/6ad0d6db5d8540e8d830361e32d128c9.png)

## 画一条线

为了绘制手绘线，只需重复应用画笔，每次使用不同的偏移量（取决于鼠标移动）：

![通过反复应用圆形画笔绘制线条](../Images/91f06ffc3118e72b238255aa7574537b.png)

* * *

## 自定义图像类

我显然跳过了一些必要的属性、方法和数据验证，但你明白了：

```
public class Image
{
    public Color[,] Pixels { get; private set; }

    public Image(int width, int height)
    {
        Pixels= new Color[width, height];
    }

    public void Initialize(Func<Color> createColor)
    {
         for (int x = 0; x < Width; x++)
         {
             for (int y = 0; y < Height; y++)
             {
                  Pixels[x, y] = createColor();
             }
         }
    }

    public void Modify(Func<int, int, Color, Color> modifyColor)
    {
         for (int x = 0; x < Width; x++)
         {
             for (int y = 0; y < Height; y++)
             {
                  Color current = Pixels[x, y];
                  Pixels[x, y] = modifyColor(x, y, current);
             }
         }
    }
} 
```

# ios - 无法在 iOS 应用程序中使用 dispatch_source_t 在 GCD 块中运行计时器

> ID：14589762
> 
> 赞同：11
> 
> 时间：2013-01-29T18:31:22.127
> 
> 标签：ios, objective-c, timer, grand-central-dispatch

我想在 GCD 块中创建一个计时器（它将每 2 秒触发一次并调用一个方法）以将其用作后台任务。但正如我所见，计时器永远不会触发。这是我的代码：

```
- (void)startMessaging
{
    BOOL queue = YES;
    dispatch_queue_t _queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_source_t timerSource = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,0,0, _queue);
    dispatch_source_set_timer(timerSource, dispatch_walltime(NULL, 0), 2ull * NSEC_PER_SEC,1ull * NSEC_PER_SEC );
    dispatch_source_set_event_handler(timerSource, ^{
        if (queue) {
            [self observeNewMsgs];
        }
    });
    dispatch_resume(timerSource);
}

- (void)observeNewMsgs
{
    NSLog(@"JUST TO TEST");
    // Staff code...
} 
```

那么这有什么问题呢？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-29T19:34:07.113

您必须创建`dispatch_source_t`一个类属性或实例变量，这样它就不会超出范围（因为在 ARC 中，当它超出范围时，它会被释放）。如果您这样做，您的代码将正常工作，例如：

```
@interface ViewController ()
@property (nonatomic, strong) dispatch_source_t timerSource;
@property (getter = isObservingMessages) BOOL observingMessages;
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self startMessaging];
}

- (void)startMessaging
{
    self.observingMessages = YES;
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    self.timerSource = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, queue);
    dispatch_source_set_timer(self.timerSource, dispatch_walltime(NULL, 0), 2ull * NSEC_PER_SEC, 1ull * NSEC_PER_SEC);
    dispatch_source_set_event_handler(self.timerSource, ^{
        if (self.isObservingMessages) {
            [self observeNewMsgs];
        }
    });
    dispatch_resume(self.timerSource);
}

- (void)observeNewMsgs
{
    NSLog(@"JUST TO TEST");
    // Staff code...
}

@end 
```

另请注意，如果您希望能够`BOOL`在后台进程启动后更改您的值，您可能也希望将其设为类属性，如上所示。我还重命名了它以`observingMessages`使其目的更明确。

（这只是风格，但我只对类实例变量使用下划线字符，所以我将你的`_queue`变量重命名为`queue`。）

# c++ - 检索叶目录

> ID：14589766
> 
> 赞同：1
> 
> 时间：2013-01-29T18:31:37.543
> 
> 标签：c++, boost, boost-filesystem

我有一些旧版本的 boost 代码使用 boost 文件系统库中路径类的成员函数 leaf()。但是，当最近尝试编译它时，我注意到它已经消失并被弃用了。

它正在执行的任务是获取指定文件夹中的所有目录并存储它们。

为了这个例子，假设我将它们输出到控制台。

例如，目录可以是：

`/home/user/dir/`

`/home/user/dir/one`

`/home/user/dir/two`

`/hone/user/dir/three`

所以我将 /home/user/dir 传递到 directory_iterator 并使用 is_directory() 检查它是否是目录。我想要打印路径的最后一部分，所以......

```
one
two
three 
```

我知道我可以通过搜索最后一个 / 等来进行一些字符串操作，但我想知道是否还有一种方法可以使用路径类来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:51:09.543

正如我从[Boost 文档](http://www.boost.org/doc/libs/1_45_0/libs/filesystem/v3/doc/deprecated.html)中看到的，leaf() 方法已被替换为 filename()。您可以使用迭代器获取所有元素。[Boost Filesystem Tutorial](http://www.boost.org/doc/libs/1_52_0/libs/filesystem/doc/tutorial.html#Class%20path-iterators-etc)中的更多内容，包括使用示例。

# scala - 在scala中并行移动两条路径

> ID：14589774
> 
> 赞同：2
> 
> 时间：2013-01-29T18:32:14.323
> 
> 标签：scala, performance

我有两棵树（路径），由一个节点定义

```
trait Node {
  def getParent : Node
  def op(n:Node)
} 
```

我想旅行两个节点，直到父节点并行为空，例如：

伪：

```
def simultanousUp(/*var*/ a:Node,/*var*/ b:Node) = 
     while(a != null) {
          a.op(b); 
          a = a.getParent;
          b = if(b!=null) b.getParent else null /*or throw somthing*/;
      } 
```

问题：在 scala 中是否有更优雅和/或高性能的方式来做到这一点？

为了避免误解：这不是关于并发执行的问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:44:01.177

父级不能为空。

首先，让我们正确：

```
trait Node {
  def parent : Option[Node]
  def op(n:Node) // what does op mean ? what is the return type of op ? 
                 //cannot be Unit
} 
```

然后

```
@scala.annotation.tailrec 
//it makes sure it's tailrec, so it can be optimized
def simultanousUp(a:Node, b:Node): (Node,Node) = {
      a.op(b)
      (a.parent, b.parent) match {
          case (Some(pa), Some(pb)) => simultanousUp(pa,pb)
          case _ => (a,b)
      }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T19:00:51.857

```
@annotation.tailrec final def simultaneousUp(a: Node, b: Node) {
  if (a != null && b != null) {
    a op b
    simultaneousUp(a.getParent, b.getParent)
  }
  // Throw exception or whatever on mismatched lengths?
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T18:42:38.107

如果 op 是一个简单的操作，你不能有效地并行运行它，因为遍历会消耗大量时间。

如果 op 是更复杂（即耗时）的操作，您可以并行执行。但是，您需要先将其转换为 ParVector 或类似的东西。

* * *

我认为没有更高效的方式来遍历它。然而，Stream 有一个更优雅（但可能不是那么高效）的解决方案：

```
def pathTo(start: Node): Stream[Node] = start.getParent match{
    case null => Stream.empty
    case nextPoint => Stream.cons(start, pathTo(nextPoint))
} 
```

# java - 用嵌套对象填充 Java 表单

> ID：14589775
> 
> 赞同：1
> 
> 时间：2013-01-29T18:32:15.847
> 
> 标签：java, playframework-2.0

我正在做一个项目，它有一个 web 服务服务器和 Play!2.0 作为 web 应用程序。两者都与 POJO 模型共享一个 JAR 文件。没有 JPA，没有其他关系。我只是将它们映射到 Mongo 对象。所有字段都是公共的，只有在 toString 上重载以简化调试。

现在我想用从 web 服务加载的对象在 Play 中填写一个表单。

```
Dispatch preDispatch= patientCardsService.getGetDispatch(name, surname, null);
Form<Dispatch> dispatchForm = form(Dispatch.class).fill(preDispatch);
return ok(patientCard.render(dispatchForm )); 
```

在现场我有这样的东西。

```
@(dForm: Form[Common.Models.Dispatch ])

@mainMobile("Card") {  

@jqmInput(dForm("status"), "Status")
@jqmInput(dForm("patientData.name"), "Name")
@jqmInput(dForm("patientData.surname"), "Surname")
} 
```

Dispatch 对象当然包含 PatientData 对象，其中包含姓名和姓氏字符串。jqmInput 是一个助手

```
@(field: Field, label: String, fieldType: Symbol = 'text)
<div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
    <label for="@field.id" class="ui-input-text" class="ui-input-text">@label</label>
    <input type="@fieldType.name" value="@field.value" name="@field.id" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset"/>
</div> 
```

这并没有充满对象。我已经检查并填充了填充之前的对象。

有人知道这是什么原因吗？

# html - 表单嵌套不正确

> ID：14589776
> 
> 赞同：0
> 
> 时间：2013-01-29T18:32:43.733
> 
> 标签：html, css, node.js, twitter-bootstrap, pug

我正在使用 Node.js、Jade 和 Bootstrap。我需要渲染一个表格，并且在每一行我都需要一个单独的表格。我试过这个：

```
 - for(var i = 0; i < renditeTabellen.length; ++i) {
      tr
        form(method="POST", action="/deleteTable")
          td#tableID #{i}
          td#tableName #{renditeTabellen[i].name}
          td#tableDate nix
          td
            button#delete.btn-danger(type="submit") Speichern
    - } 
```

但我得到这个输出： ![在此处输入图像描述](../Images/8f8b263aaa5648f8be81ddd23bd8b305.png)

所以`form`不是以正确的方式嵌套。它应该包含一个`tr` 我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:40:16.573

您不能将表单直接放入`TR`. 将其更改为在单个 td 中呈现表单。据我所知，您甚至不需要将所有`TD`s 包装成一行的表单。假设代码应该是这样的：

```
 - for(var i = 0; i < renditeTabellen.length; ++i) {
      tr            
        td#tableID #{i}
        td#tableName #{renditeTabellen[i].name}
        td#tableDate nix
        td
          form(method="POST", action="/deleteTable")
            button#delete.btn-danger(type="submit") Speichern
    - } 
```

另外，请记住只有表单元素（输入、选择、按钮等）与表单一起提交，因此您需要在按钮上放置一个 value 属性，该属性应包含应删除的项目的 ID。另外，按钮应该有一个名字，所以你可以从帖子中得到它。

# javascript - 打开和可视化电子表格

> ID：14589777
> 
> 赞同：0
> 
> 时间：2013-01-29T18:32:44.843
> 
> 标签：javascript, google-apps-script, google-spreadsheet-api

有什么方法可以用**javascript**打开和可视化**谷歌电子表格**吗？

换句话说，我想在 Google***电子表格 A****中创建一个脚本*，该脚本能够实际打开并选择***电子表格***B。通过查看- 我看到可以使用该方法；但它不会实际打开电子表格并选择特定工作表。**`Google Script API``SpreadsheetApp.openbyID()`**

 **有人可以告诉我这是否可能以及应该为此目的使用什么**API 命令？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:41:04.953

您可以通过将 JavaScript 嵌入到 google spreadshoot 页面来实现。

为此，您可以使用用户脚本或开发您的 google chrome 扩展程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T23:52:35.070

这是一种方法，从[如何通过 Google Apps 脚本访问不同 Google 电子表格上的数据？](https://stackoverflow.com/questions/11727975/how-to-access-data-on-different-google-spreadsheet-through-google-apps-script)：

```
var ss = SpreadsheetApp.openById(SPREADSHEET_ID_GOES_HERE);
var sheets = ss.getSheets();
// the variable sheets is an array of Sheet objects
var sheet1A1 = sheets[0].getRange('A1').getValue();
var sheet2A1 = sheets[1].getRange('A1').getValue(); 
```

您可以按工作表名称打开，但使用工作表编号更快，因为它不需要网络调用。**

# windows - 批处理文件将文件夹移动到子文件夹

> ID：14589784
> 
> 赞同：0
> 
> 时间：2013-01-29T18:32:58.180
> 
> 标签：windows, file, batch-file, directory, move

这是我当前的文件夹结构：

```
C:\Invoices\**CustomerName**\January 
```

我正在寻找一个脚本，它将遍历所有 CustomerNames 并将一月文件夹移动到

```
C:\Invoices\**CustomerName**\2013\January 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T23:24:36.697

```
cd \invoices
for /d %%I in (*) do (
    md "%%I\2013"
    move "%%I\January" "%%I\2013"
) 
```

# styling - 从样式输入按钮中删除闪烁的光标

> ID：14589793
> 
> 赞同：1
> 
> 时间：2013-01-29T18:33:31.500
> 
> 标签：styling, submit-button

我正在使用以下类为所有输入提交按钮设置样式：

```
.button {
    background: #E2F0FE;
    color: #000;
    border: 1px solid #CCC;
    margin: 5px 0 0;
    padding: 3px 5px;
    cursor: pointer}
.button:hover { background-color: #0281FF; } 
```

但是，当单击按钮时，按钮上会显示闪烁的文本光标，并且只要按钮具有焦点，光标就会继续在按钮的文本中闪烁。

有没有办法阻止这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T11:17:18.380

firefox 有一个插入符号浏览功能，由 F7 切换......[阅读更多](http://www.blog.highub.com/firefox-4/firefox-blinking-cursor/)......所以在你的情况下（就像我的一样）你必须在过去的某个时候按下键盘上的 F7，现在你得到闪烁的光标...但它应该发生在所有 Firefox 页面上。

我使用萤火虫试图找到闪烁光标所在的实际文本字段，但我没有找到一个......幽灵文本字段。

# c# - 有没有办法轻松解析可移植类库中的文件路径？

> ID：14589795
> 
> 赞同：12
> 
> 时间：2013-01-29T18:33:32.827
> 
> 标签：c#, .net, file, path, portable-class-library

我需要将路径解析为可移植类库中的部分，并获取文件名、扩展名、目录名等内容。

从 System.IO.Path 中访问所有这些方法都相当容易，但是，这似乎不存在于可移植类库中。是否有可以为我提供相同功能的此 API 或其他一些 API 的开源替代品？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:07:00.113

您可以使用或改编来自 Mono 的 System.IO.Path 代码：[https ://github.com/mono/mono/blob/master/mcs/class/corlib/System.IO/Path.cs](https://github.com/mono/mono/blob/master/mcs/class/corlib/System.IO/Path.cs)

编辑：另外，我的[PCL 存储](http://pclstorage.codeplex.com/)库为 PCL 提供了一些文件 IO API，包括`PortablePath.Combine()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T18:45:07.730

我会使用`Uri`类

```
var segments = new Uri("file://c:/dir1/dir2/a.txt").Segments 
```

PCL 支持

[http://msdn.microsoft.com/en-us/library/system.uri.aspx](http://msdn.microsoft.com/en-us/library/system.uri.aspx)

# java - Lucene - 从术语中获取文档 ID

> ID：14589799
> 
> 赞同：6
> 
> 时间：2013-01-29T18:33:41.437
> 
> 标签：java, lucene

在 Lucene 4.1 中，我看到您可以使用 DirectoryReader.docFreq() 来获取包含给定术语的索引中的文档数。有没有办法真正获得这些文件？对象或 ID 号都可以。我认为 AtomicReader.termDocsEnum() 会很有用，但我不确定我是否可以使用 AtomicReader - 我看不到如何在给定目录上创建 AtomicReader 实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:46:07.487

为什么不直接搜索呢？

```
IndexSearcher searcher = new IndexSearcher(directoryReader);
TermQuery query = new TermQuery(new Term("field", "term"));
TopDocs topdocs = searcher.query(query, numberToReturn); 
```

# jquery - Hulu 如何转换他们的页面？

> ID：14589801
> 
> 赞同：0
> 
> 时间：2013-01-29T18:33:45.483
> 
> 标签：jquery, transition, page-refresh

我想知道 Hulu 在链接之间单击时如何转换他们的页面？该页面似乎没有指示页面刷新或重定向。

可以用 jQuery 完成类似的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:45:50.243

为什么是的，是的，你可以！

看这里

[http://www.onextrapixel.com/2010/02/23/how-to-use-jquery-to-make-slick-page-transitions/](http://www.onextrapixel.com/2010/02/23/how-to-use-jquery-to-make-slick-page-transitions/)

# functional-programming - SML函数式编程高阶函数？

> ID：14589802
> 
> 赞同：-3
> 
> 时间：2013-01-29T18:33:47.243
> 
> 标签：functional-programming, sml, higher-order-functions

我需要实现一个功能

```
 ziprev : 'a list -> 'b list -> ('a * 'b) list
 - ziprev [1,2,3,4] [10,20,30,40];
 val it = [(1,40),(2,30),(3,20),(4,10)] : (int * int) list 
```

使用我已经创建的函数：

```
- zipW (fn (x, y) => x + y) [1,2,3,4] [10,20,30,40];
val it = [11,22,33,44] : int list 
```

和图书馆的 List.rev。我不知道如何用两个库做一个函数。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T20:03:17.767

**提示1：**

比较你的`ziprev`结果

```
List.zip [1,2,3,4] [10,20,30,40] 
```

你应该看到一个相当明显的模式。

**提示2：**

`List.rev` *反转*列表。

**提示 3：**

你可以`zipW`用来实现`List.zip`吗？
也就是说，如果你想说

```
normalzip xs ys = zipW something xs ys 
```

会`something`是什么？

# c++ - 声明模板时是否需要类型名/类

> ID：14589803
> 
> 赞同：5
> 
> 时间：2013-01-29T18:33:53.127
> 
> 标签：c++, template-meta-programming

当声明模板参数是`typename`/`class`必要的（因为我在下面建议的语言不能使用 diff 语法）。我知道模板参数可以是整数，因此您必须选择默认为 int 或 to `typename`/ class 但仍然如此。

即为什么不

```
template <T>
T max(T a, T b) {
    return a > b ? a : b;
} 
```

代替

```
template <typename T>
T max(T a, T b) {
    return a > b ? a : b;
} 
```

和

```
template<T, size_t n>
size_t array_size(const T (&)[n]) {
    return n;
} 
```

代替

```
template<typename T, size_t n>
size_t array_size(const T (&)[n]) {
    return n;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-29T18:43:20.467

如果模板参数默认为类型，该语言当然仍然可以工作；就像 C`int`在没有类型说明符的情况下默认为变量类型时工作一样。需要克服一些歧义，例如：

```
typedef int T;
template <T> class C;  // type, or non-type value of type `T`? 
```

但是，强迫您明确表示可以进行更好的诊断。如果我忘记指定非类型参数的类型，编译器可以立即发现错误并告诉我。在你的世界里，它会假设我想要一个类型参数，并继续尝试相应地解释模板；可能会产生令人困惑的错误，或者甚至可能成功编译完全错误的东西。

我无法评论这是否是此处不允许使用默认值的原因（或者从 C 中删除默认变量类型，或者从不允许在 C++ 中使用它们），但这对我来说肯定是一个足够好的理由。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-29T18:37:11.707

模板参数类型可能有很多不同的东西。`typename`在实践中是最常见的，但您需要指定它。我想如果没有指定类型，语言可能会假设你的意思`typename`，但他们没有那样指定。

# c# - Visual Studio 编码的用户界面单击从搜索返回的第一条记录

> ID：14589806
> 
> 赞同：1
> 
> 时间：2013-01-29T18:34:03.337
> 
> 标签：c#, visual-studio-2012, coded-ui-tests

我在 Visual Studio 2012 中为我正在测试的应用程序录制了一段录音。我记录添加一个带有案例的人（子记录）。案例编号是自动生成的，因此每次我运行此测试时都会有所不同。

当我播放录音时，尝试单击案例记录的链接时失败。这是因为每次执行的链接都不同。

指定这一点的代码在设计器中（即使在我将其“移动”到 UIMap 文件之后）。另外，我不能每次都改变它来预测这个数字是多少。

如何根据列表中的第一个链接（它是一个网格视图）而不是特定的链接测试和 url 来选择录音？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T23:44:56.547

一位聪明的同事帮助了我。这是他找到的解决方案：

```
replaced  Mouse.Click(uIHHP2013000005Hyperlink, new Point(49, 2)); 
```

在我的 UIMap 设计器中使用硬编码值定义的位置。

和：

```
HtmlControl control = new HtmlControl(this.UIPersonsCCDWindowsIntWindow.UIDetailsCCDDocument);
        control.SearchProperties.Add(HtmlControl.PropertyNames.ClassName, "HtmlHyperlink");
        UITestControlCollection controlcollection = control.FindMatchingControls();
        List<string> names = new List<string>();
        foreach (UITestControl x in controlcollection)
        {
            if (x is HtmlHyperlink)
            {
                HtmlHyperlink programCaseLink = (HtmlHyperlink)x;
                if (programCaseLink.Href.StartsWith("http://mywebsite.com/ProgramCase/Details/"))
                {
                    Mouse.Click(programCaseLink);
                }
            }
        } 
```

# javascript - 如何在 html 表单字段中显示提示？

> ID：14589807
> 
> 赞同：4
> 
> 时间：2013-01-29T18:34:23.517
> 
> 标签：javascript, html, hint

我有一个很长的 php 表单，用于保存用户输入的输入值。我想在输入框旁边显示提示。我知道这个[HTML 输入字段提示](https://stackoverflow.com/questions/6280034/html-input-field-hint) ，但这不是我的目标，我想在输入框旁边显示它，当用户选择相应的字段时，输入框会出现/消失。（我想要这个在 html 中而不是在 javascript 等中，因为我不知道 JavaScript。）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-29T18:41:33.853

您应该使用 HTML5 并使用文本字段，例如

```
<input type="text" placeholder="enter input" title="Enter input here"> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-29T18:38:45.250

您可以使用`:focus`CSS 伪类来实现。在输入框旁边放一个跨度并给它这个样式：

```
.hint { display: none; }
input:focus + .hint { display: inline; } 
```

JSBin：http: [//jsbin.com/inilot/1/edit](http://jsbin.com/inilot/1/edit)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-29T18:37:54.010

您可以使用`title`这样的参数：

`<input title="hint" ... />`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-29T18:46:36.970

这是一种不使用任何 Java{script} 代码的 CSS 技术：

```
<style>
.ami div {display:none}
.ami:hover div {display:block}
</style>
<a class=ami href="#">Please hover me <div>I show only when you over</div></a>
</html> 
```

希望我能帮助

# java - 在后台将文件上传到php脚本

> ID：14589818
> 
> 赞同：1
> 
> 时间：2013-01-29T18:34:23.513
> 
> 标签：java, android

我想将文件（图片）上传到服务器（PHP 脚本），但在后台。我正在搜索一个非常轻量级的 AsyncTask 来执行此操作，但我在 Google 上找不到任何有用的东西。

知道如何使用 AsyncTask 将文件上传到 PHP 吗？上传功能应该只获取本地文件作为变量，其他所有文件都应该不是变量......

也许有人可以帮助我？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-29T18:37:30.237

**在后台执行任务。**

您需要创建`service`并编写逻辑以将文件上传到服务器。

[在这里](http://developer.android.com/reference/android/app/Service.html)阅读。

# amazon-web-services - 如何确定将数据上传到 Amazon EC2 所需的时间？

> ID：14589819
> 
> 赞同：1
> 
> 时间：2013-01-29T18:34:49.620
> 
> 标签：amazon-web-services, amazon-ec2

我们需要填充位于 Amazon WS { EC2 (Compute Cluster 8 extra large) + EBS 1TB } 上的数据库。鉴于我们在本地有接近 700GB 的数据，我怎样才能找出上传整个数据所需的时间（理论上）？我找不到任何有关 EC2 数据上传/下载速度的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:47:31.970

因为这在很大程度上取决于您的站点和亚马逊数据中心之间的网络......

1.  用几 GB 测试它并推断。

2.  请注意[AWS Import/Export](http://aws.amazon.com/importexport/)，并考虑简单地向 Amazon 运送便携式硬盘驱动器的选项。（老话说：“永远不要低估装满磁带的旅行车的带宽”）。事实上，我注意到该[页面](http://aws.amazon.com/importexport/)包含一个“何时使用...”部分，它给出了传输时间与连接带宽的一些指示。

# c# - 我的控制器更新数据库的 MVC 4 C# 问题

> ID：14589827
> 
> 赞同：0
> 
> 时间：2013-01-29T18:35:21.723
> 
> 标签：c#, asp.net, database, asp.net-mvc-4

我使用用户信息更新数据库的方法存在问题。在 HttpGet 期间，它使用视图模型来确保数据的完整性，而在 HttpPost 中，数据被传回并在那里。（用断点进行了一些检查，一切都保存了他们应该拥有的正确用户数据）

但是，当我运行 .Save() 方法时，此信息不会存储到数据库中。

我已经通过手动更改数据检查它是否指向正确的数据库，它出现在列表视图中就好了。我错过了一些东西，只是无法弄清楚是什么><

下面是所有相关视图模型中都有表单数据的代码，但它只是不保存！

```
 [HttpPost]
    public ActionResult HouseCreate(CreateHouseViewModel viewModel)
    {

        if (ModelState.IsValid)
        {          
            var house = new House();
            house.address = viewModel.address;
            house.postCode = viewModel.postCode;
            house.noOfDisputes = viewModel.noOfDisputes;
            _db.Save();

          return RedirectToAction("House");
        }
        return View(viewModel);
    } 
```

house 是我的 house 数据库的一个对象，使用正确的主键正确建模（在数据库查看器中仔细检查。）保存调用：

```
void DataSources.Save()
    {
        SaveChanges();
    } 
```

没有错误出现，这使情况变得更糟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:42:38.300

```
using (var context = new UnicornsContext())
{
    var unicorn = new Unicorn { Name = "Franky", PrincessId = 1};

    context.Unicorns.Add(unicorn); // your missing line

    context.SaveChanges();
} 
```

[来源](http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:40:13.863

我假设您的“_db”对象是实体框架。这将有一个集合，也许是 _db.Houses ？您需要将对象添加到其中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T19:05:53.740

由于您使用的是实体框架，因此您需要通知实体框架您的模型已更新。在 HttpGet 和 HttpPost 方法之间，模型与数据库上下文解除关联。我认为以下代码可以将其重新附加到上下文中，以便您可以保存更改：

```
context.Entry(myEntity).State = EntityState.Modified;
context.MyEntities.Attach(myModel);
context.SaveChanges(); 
```

编辑：忘记添加重新附加方法部分，假设这是您更新的数据库中的现有记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T19:55:04.940

我发现这是向数据库添加项目的一种更可靠的方法：

```
// Note: db is your dbContext, model is your view model

var entity = db.Entry(model); // Required to attach the entity model to the database
                              //   you don't need the "var entity = " but its useful
                              //   when you want to access it for logging
db.Entry(model).State = EntityState.Added; // Required to set the entity as added - 
                                           //   modified does not work correctly

db.SaveChanges();             // Finally save 
```

# php - 带有输入字段的链式选择列表 - 以及从数据库中获取的值

> ID：14589829
> 
> 赞同：0
> 
> 时间：2013-01-29T18:35:02.120
> 
> 标签：php, sql

我想要达到的目标：

使用链式选择列表将数据插入数据库表（选项值取自数据库表）

**要求：**对于第一个选择列表（“tip_cheltuiala”），可用的选项值必须仅是已插入的行中未使用的选项值（可用选项为：选项 1、2 和 3；我已经插入带有选项 1 的行和 3，现在只有选项 2 必须可用）

**1\. 选择列表“tip_cheltuiala”：**

```
echo '<select name="tip_cheltuiala'.$row_chelt['id_factura'].'" id="tip_cheltuiala'.$row_chelt['id_factura'].'" class="selectContentIncasare">'.$opt_mod_inchidere->TipCheltuiala().'</select>'; 
```

以及该选择列表的功能：

```
class SelectListModInchidere{
public function TipCheltuiala(){
                    //looking for options that are  already in the table
        $stmt_chelt_inchisa = $this->conn->prepare('SELECT tip_cheltuiala FROM cheltuieli_mod_inchidere');
        $stmt_chelt_inchisa->execute(array());
        $results_chelt_inchisa = $stmt_chelt_inchisa->fetchAll();
        foreach($results_chelt_inchisa as $row_chelt_inchisa) {
            $chelt_inchisa[] = $row_chelt_inchisa['tip_cheltuiala'];
        }
        print_r($chelt_inchisa); // returns options 1 and 3

        for($i=0; $i < count($chelt_inchisa); $i++){    

            $stmt_tip_chelt = $this->conn->prepare('SELECT * FROM mi_categ_cheltuiala 
            WHERE tip_cheltuiala <> :chelt_inchisa');
            $stmt_tip_chelt->execute(array('chelt_inchisa' => $chelt_inchisa[$i]));
            $tip_cheltuiala = '<option value="0">selectati ...</option>';
            while($row_tip_chelt = $stmt_tip_chelt->fetch()) {
                $tip_cheltuiala .= '<option value="' . $row_tip_chelt['tip_cheltuiala'] . '">' . $row_tip_chelt['tip_cheltuiala'] . '</option>';
            }
            return $tip_cheltuiala;
        }
    }
}
$opt_mod_inchidere = new SelectListModInchidere(); 
```

**我有第一个问题**：选择列表填充了选项 2（这是正确的），但也填充了选项 3 - 我不知道为什么。

**2\. 选择列表“mod_inchidere”：** 根据选择列表“tip_cheltuiala”中选择的选项返回选项值

```
echo '<select name="mod_inchidere'.$row_chelt['id_factura'].'" id="mod_inchidere'.$row_chelt['id_factura'].'" class="selectContentIncasare">
      <option value="0">selectati ...</option>
      </select>'; 
```

以及该选择列表的函数（与函数 TipCheltuiala 属于同一类）：

```
public function ModInchidere(){
        $stmt_mod_inch = $this->conn->prepare('SELECT * FROM mi_mod_inchidere WHERE categorie_cheltuiala = :categorie_cheltuiala');
        $stmt_mod_inch->execute(array('categorie_cheltuiala' => $_POST['id_categ_cheltuiala']));
        $mod_inchidere = '<option value="0">selectati ...</option>'; 
        while($row_mod_inch = $stmt_mod_inch->fetch()) {
            $mod_inchidere .= '<option value="' . $row_mod_inch['mod_inchidere'] . '">' . $row_mod_inch['mod_inchidere'] . '</option>';
        }
        return $mod_inchidere;
    } 
```

**3\. 最后一步：**根据选择列表“mod_inchidere”中选择的选项，我需要返回一个与选择列表“mod_inchidre”中的选项相关的值（也存储在数据库中），并将该值放入输入字段中，所以用户可以（如果他愿意）修改该值。

在那一步，我不知道如何做到这一点。我可以将该值放在另一个选择列表中，但是：用户不能修改该值，也不是这样做的方法。

请帮帮我。

乐

**表结构**

**mi_categ_cheltuiala** -> | 编号 | tip_cheltuiala | categorie_cheltuiala |

**mi_mod_inchidere** -> | 编号 | categorie_cheltuiala | mod_inchidere |

**cheltuieli_mod_inchidere**（我需要插入数据的表）-> | 编号 | tip_cheltuiala | categorie_cheltuiala | mod_inchidere | 价值 |

要获得我需要在输入字段中输入的值，我需要为字段“mod_inchidere”查询表“mi_categ_valoare”

**mi_categ_valoare** -> | 编号 | mod_inchidere | 价值 |

**$_POST['id_categ_cheltuiala'] -> 解释：**

通过 jQuery，我获取在此选择列表“tip_cheltuiala”中选择的内容并将数据发送到方法 TipCheltuiala()

```
<script type="text/javascript">
$(document).ready(function(){
    $("select#mod_inchidere<?php echo $row_chelt['id_factura']; ?>").attr("disabled","disabled");
            $("select#tip_cheltuiala<?php echo $row_chelt['id_factura']; ?>").change(function(){
            $("select#mod_inchidere<?php echo $row_chelt['id_factura']; ?>").attr("disabled","disabled");
            $("select#mod_inchidere<?php echo $row_chelt['id_factura']; ?>").html("<option>asteptati ...</option>");
            var id_categ_cheltuiala = $("select#tip_cheltuiala<?php echo $row_chelt['id_factura']; ?> option:selected").attr('value');
            $.post("class/select_mod_inchidere.php", {id_categ_cheltuiala:id_categ_cheltuiala}, function(data){
            $("select#mod_inchidere<?php echo $row_chelt['id_factura']; ?>").removeAttr("disabled");
            $("select#mod_inchidere<?php echo $row_chelt['id_factura']; ?>").html(data);
        });
    }); 
</script> 
```

然后我使用一个服务文件来调用方法 TipCheltuiala()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T07:40:38.787

老实说：非英语的命名约定让我头晕目眩:)

问题：`There I have the first issue: the select list is populated with option 2 (that is correct) but also with option 3 - I can't figure out why.`

使用下面的单个查询来丢失`tip_cheltuila`：

```
SELECT 
    tip_cheltuila
FROM
    mi_categ_cheltuiala
WHERE
    tip_cheltuila NOT IN (SELECT 
            tip_cheltuiala
        FROM
            cheltuieli_mod_inchidere); 
```

需要研究其他问题...

# python - TypeError：“实例”类型的参数不可迭代

> ID：14589833
> 
> 赞同：1
> 
> 时间：2013-01-29T18:35:38.167
> 
> 标签：python, python-2.7, depth-first-search, pacman

所以这是我的代码，它在该行中断：

```
 if (suc not in sFrontier) or (suc not in sExplored): 
```

给出错误：TypeError：“实例”类型的参数不可迭代

```
 """
    The pseudocode I'm following
initialize the frontier using the initial state of the problem
initialize the explored set to be empty
loop do
    if the frontier is empty then return failure
    choose a leaf node and remove it from the frontier
    if the node contains a goal state then return the corresponding solution
    add the node to the explored set
    expand the chosen node, adding the resulting nodes to the frontier
        only if not in the frontier or explored set
"""

sFrontier = util.Stack()
sFrontier.push(problem.getStartState())
sExplored = util.Stack()
lSuccessors = []

while not sFrontier.isEmpty():
  leaf = sFrontier.pop()

  if problem.isGoalState(leaf):
    solution = []
    while not sExplored.isEmpty():
      solution[:0] = (sExplored.pop())[2]
      return solution
  sExplored.push(leaf)
  lSuccessors = problem.getSuccessors(leaf)
  for suc in lSuccessors:
      if (suc not in sFrontier) or (suc not in sExplored):
        sFrontier.push(suc)
return [] 
```

question.getSuccessors 返回一个后继状态列表、它们需要的操作以及成本 1。

所以之后

```
lSuccessors = problem.getSuccessors(leaf) 
```

l 继任者印刷品

```
 [((5,4), 'South', 1), ((4,5), 'West', 1)] 
```

之后

```
 for suc in lSuccessors: 
```

成功打印

```
 ((5,4), 'South', 1) 
```

为什么会断？是因为 sFrontier 和 sExplored 是堆栈，它不能在堆栈中查找吗？

我需要一个 contains() 方法还是只使用一个列表？

所有帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:38:37.370

我假设`util.Stack`是你的课。

提供一种`__contains__(self, x)`使对象支持`a in obj`检查的方法。

请参阅文档：[模拟容器类型](http://docs.python.org/2/reference/datamodel.html#emulating-container-types)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:38:40.373

如果您的堆栈不支持包含测试，它确实会引发错误。您需要向它们添加一个[`__contains__`方法](http://docs.python.org/2/reference/datamodel.html#object.__contains__)来支持`in`测试。

测试还有其他方法`in`可以找到堆栈中的项目，但不推荐使用它们，因为它们的效率低于`__contains__`方法；请参阅[`in`表达式文档](http://docs.python.org/2/reference/expressions.html#membership-test-details)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-19T17:06:31.590

`SFrontier`是一个包含列表的类。您在代码中检查 suc 是否在 sFrontier 类中，因为 sFrontier 不可迭代，所以您无法检查它。您必须编写`(suc in sFrontier.list)`以便检查 suc 是否在您的类 sFrontier 包含的列表中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-10-19T16:55:27.790

问题出在 if 案例的第一方面：

```
if (succ not in sFrontier) 
```

因此，您将 sFrontier 初始化为 Stack 但 Stack 是一个类，并且类不可迭代。您的类必须在其中包含一个列表，以便它可以用作容器。如果是这种情况，您需要做的是：

```
if (succ not in sFrontier.list) 
```

# php - HTML5 网络摄像头捕获显示图片

> ID：14589836
> 
> 赞同：2
> 
> 时间：2013-01-29T18:36:01.760
> 
> 标签：php, javascript, css, html

所以，我有这个 HTML5 聊天脚本，它要求用户输入他们的姓名和电子邮件才能开始聊天。该脚本从 gavatar 中获取用户显示图片。我正在尝试更改它以使其从用户计算机获取网络摄像头快照并将其设置为显示图片。

我已经看到了一些使用 HTML5 访问用户网络摄像头的示例，但我似乎无法弄清楚如何自动拍摄快照并将其设置为用户显示图片。

这是我当前的代码。

```
$(document).ready(function(){

    // Run the init method on document ready:
    chat.init();

});

var chat = {

    // data holds variables for use in the class:

    data : {
        lastID      : 0,
        noActivity  : 0
    },

    // Init binds event listeners and sets up timers:

    init : function(){

        // Using the defaultText jQuery plugin, included at the bottom:
        $('#name').defaultText('Nickname');
        $('#email').defaultText('Email');

        // Converting the #chatLineHolder div into a jScrollPane,
        // and saving the plugin's API in chat.data:

        chat.data.jspAPI = $('#chatLineHolder').jScrollPane({
            verticalDragMinHeight: 12,
            verticalDragMaxHeight: 12
        }).data('jsp');

        // We use the working variable to prevent
        // multiple form submissions:

        var working = false;

        // Logging a person in the chat:

        $('#loginForm').submit(function(){

            if(working) return false;
            working = true;

            // Using our tzPOST wrapper function
            // (defined in the bottom):

            $.tzPOST('login',$(this).serialize(),function(r){
                working = false;

                if(r.error){
                    chat.displayError(r.error);
                }
                else chat.login(r.name,r.gravatar);
            });

            return false;
        });

        // Submitting a new chat entry:

        $('#submitForm').submit(function(){

            var text = $('#chatText').val();

            if(text.length == 0){
                return false;
            }

            if(working) return false;
            working = true;

            // Assigning a temporary ID to the chat:
            var tempID = 't'+Math.round(Math.random()*1000000),
                params = {
                    id          : tempID,
                    author      : chat.data.name,
                    gravatar    : chat.data.gravatar,
                    text        : text.replace(/</g,'&lt;').replace(/>/g,'&gt;')
                };

            // Using our addChatLine method to add the chat
            // to the screen immediately, without waiting for
            // the AJAX request to complete:

            chat.addChatLine($.extend({},params));

            // Using our tzPOST wrapper method to send the chat
            // via a POST AJAX request:

            $.tzPOST('submitChat',$(this).serialize(),function(r){
                working = false;

                $('#chatText').val('');
                $('div.chat-'+tempID).remove();

                params['id'] = r.insertID;
                chat.addChatLine($.extend({},params));
            });

            return false;
        });

        // Logging the user out:

        $('a.logoutButton').live('click',function(){

            $('#chatTopBar > span').fadeOut(function(){
                $(this).remove();
            });

            $('#submitForm').fadeOut(function(){
                $('#loginForm').fadeIn();
            });

            $.tzPOST('logout');

            return false;
        });

        // Checking whether the user is already logged (browser refresh)

        $.tzGET('checkLogged',function(r){
            if(r.logged){
                chat.login(r.loggedAs.name,r.loggedAs.gravatar);
            }
        });

        // Self executing timeout functions

        (function getChatsTimeoutFunction(){
            chat.getChats(getChatsTimeoutFunction);
        })();

        (function getUsersTimeoutFunction(){
            chat.getUsers(getUsersTimeoutFunction);
        })();

    },

    // The login method hides displays the
    // user's login data and shows the submit form

    login : function(name,gravatar){

        chat.data.name = name;
        chat.data.gravatar = gravatar;
        $('#chatTopBar').html(chat.render('loginTopBar',chat.data));

        $('#loginForm').fadeOut(function(){
            $('#submitForm').fadeIn();
            $('#chatText').focus();
        });

    },

    // The render method generates the HTML markup 
    // that is needed by the other methods:

    render : function(template,params){

        var arr = [];
        switch(template){
            case 'loginTopBar':
                arr = [
                '<span><img src="',params.gravatar,'" width="23" height="23" />',
                '<span class="name">',params.name,
                '</span><a href="" class="logoutButton rounded">Logout</a></span>'];
            break;

            case 'chatLine':
                arr = [
                    '<div class="chat chat-',params.id,' rounded"><span class="gravatar"><img src="',params.gravatar,
                    '" width="23" height="23" onload="this.style.visibility=\'visible\'" />','</span><span class="author">',params.author,
                    ':</span><span class="text">',params.text,'</span><span class="time">',params.time,'</span></div>'];
            break;

            case 'user':
                arr = [
                    '<div class="user" title="',params.name,'"><img src="',
                    params.gravatar,'" width="30" height="30" onload="this.style.visibility=\'visible\'" /></div>'
                ];
            break;
        }

        // A single array join is faster than
        // multiple concatenations

        return arr.join('');

    },

    // The addChatLine method ads a chat entry to the page

    addChatLine : function(params){

        // All times are displayed in the user's timezone

        var d = new Date();
        if(params.time) {

            // PHP returns the time in UTC (GMT). We use it to feed the date
            // object and later output it in the user's timezone. JavaScript
            // internally converts it for us.

            d.setUTCHours(params.time.hours,params.time.minutes);
        }

        params.time = (d.getHours() < 10 ? '0' : '' ) + d.getHours()+':'+
                      (d.getMinutes() < 10 ? '0':'') + d.getMinutes();

        var markup = chat.render('chatLine',params),
            exists = $('#chatLineHolder .chat-'+params.id);

        if(exists.length){
            exists.remove();
        }

        if(!chat.data.lastID){
            // If this is the first chat, remove the
            // paragraph saying there aren't any:

            $('#chatLineHolder p').remove();
        }

        // If this isn't a temporary chat:
        if(params.id.toString().charAt(0) != 't'){
            var previous = $('#chatLineHolder .chat-'+(+params.id - 1));
            if(previous.length){
                previous.after(markup);
            }
            else chat.data.jspAPI.getContentPane().append(markup);
        }
        else chat.data.jspAPI.getContentPane().append(markup);

        // As we added new content, we need to
        // reinitialise the jScrollPane plugin:

        chat.data.jspAPI.reinitialise();
        chat.data.jspAPI.scrollToBottom(true);

    },

    // This method requests the latest chats
    // (since lastID), and adds them to the page.

    getChats : function(callback){
        $.tzGET('getChats',{lastID: chat.data.lastID},function(r){

            for(var i=0;i<r.chats.length;i++){
                chat.addChatLine(r.chats[i]);
            }

            if(r.chats.length){
                chat.data.noActivity = 0;
                chat.data.lastID = r.chats[i-1].id;
            }
            else{
                // If no chats were received, increment
                // the noActivity counter.

                chat.data.noActivity++;
            }

            if(!chat.data.lastID){
                chat.data.jspAPI.getContentPane().html('<p class="noChats">No chats yet</p>');
            }

            // Setting a timeout for the next request,
            // depending on the chat activity:

            var nextRequest = 1000;

            // 2 seconds
            if(chat.data.noActivity > 3){
                nextRequest = 2000;
            }

            if(chat.data.noActivity > 10){
                nextRequest = 5000;
            }

            // 15 seconds
            if(chat.data.noActivity > 20){
                nextRequest = 15000;
            }

            setTimeout(callback,nextRequest);
        });
    },

    // Requesting a list with all the users.

    getUsers : function(callback){
        $.tzGET('getUsers',function(r){

            var users = [];

            for(var i=0; i< r.users.length;i++){
                if(r.users[i]){
                    users.push(chat.render('user',r.users[i]));
                }
            }

            var message = '';

            if(r.total<1){
                message = 'No one is online';
            }
            else {
                message = r.total+' '+(r.total == 1 ? 'person':'people')+' online';
            }

            users.push('<p class="count">'+message+'</p>');

            $('#chatUsers').html(users.join(''));

            setTimeout(callback,15000);
        });
    },

    // This method displays an error message on the top of the page:

    displayError : function(msg){
        var elem = $('<div>',{
            id      : 'chatErrorMessage',
            html    : msg
        });

        elem.click(function(){
            $(this).fadeOut(function(){
                $(this).remove();
            });
        });

        setTimeout(function(){
            elem.click();
        },5000);

        elem.hide().appendTo('body').slideDown();
    }
};

// Custom GET & POST wrappers:

$.tzPOST = function(action,data,callback){
    $.post('php/ajax.php?action='+action,data,callback,'json');
}

$.tzGET = function(action,data,callback){
    $.get('php/ajax.php?action='+action,data,callback,'json');
}

// A custom jQuery method for placeholder text:

$.fn.defaultText = function(value){

    var element = this.eq(0);
    element.data('defaultText',value);

    element.focus(function(){
        if(element.val() == value){
            element.val('').removeClass('defaultText');
        }
    }).blur(function(){
        if(element.val() == '' || element.val() == value){
            element.addClass('defaultText').val(value);
        }
    });

    return element.blur();
} 
```

这是从 gravatar 抓取用户 DP 的 PHP 文件。

```
<?php

class ChatUser extends ChatBase{

    protected $name = '', $gravatar = '';

    public function save(){

        DB::query("
            INSERT INTO webchat_users (name, gravatar)
            VALUES (
                '".DB::esc($this->name)."',
                '".DB::esc($this->gravatar)."'
        )");

        return DB::getMySQLiObject();
    }

    public function update(){
        DB::query("
            INSERT INTO webchat_users (name, gravatar)
            VALUES (
                '".DB::esc($this->name)."',
                '".DB::esc($this->gravatar)."'
            ) ON DUPLICATE KEY UPDATE last_activity = NOW()");
    }
}

?> 
```

还有一点代码。

```
<?php

/* The Chat class exploses public static methods, used by ajax.php */

class Chat{

    public static function login($name,$email){
        if(!$name || !$email){
            throw new Exception('Fill in all the required fields.');
        }

        if(!filter_input(INPUT_POST,'email',FILTER_VALIDATE_EMAIL)){
            throw new Exception('Your email is invalid.');
        }

        // Preparing the gravatar hash:
        $gravatar = md5(strtolower(trim($email)));

        $user = new ChatUser(array(
            'name'      => $name,
            'gravatar'  => $gravatar
        ));

        // The save method returns a MySQLi object
        if($user->save()->affected_rows != 1){
            throw new Exception('This nick is in use.');
        }

        $_SESSION['user']   = array(
            'name'      => $name,
            'gravatar'  => $gravatar
        );

        return array(
            'status'    => 1,
            'name'      => $name,
            'gravatar'  => Chat::gravatarFromHash($gravatar)
        );
    }

    public static function checkLogged(){
        $response = array('logged' => false);

        if($_SESSION['user']['name']){
            $response['logged'] = true;
            $response['loggedAs'] = array(
                'name'      => $_SESSION['user']['name'],
                'gravatar'  => Chat::gravatarFromHash($_SESSION['user']['gravatar'])
            );
        }

        return $response;
    }

    public static function logout(){
        DB::query("DELETE FROM webchat_users WHERE name = '".DB::esc($_SESSION['user']['name'])."'");

        $_SESSION = array();
        unset($_SESSION);

        return array('status' => 1);
    }

    public static function submitChat($chatText){
        if(!$_SESSION['user']){
            throw new Exception('You are not logged in');
        }

        if(!$chatText){
            throw new Exception('You haven\' entered a chat message.');
        }

        $chat = new ChatLine(array(
            'author'    => $_SESSION['user']['name'],
            'gravatar'  => $_SESSION['user']['gravatar'],
            'text'      => $chatText
        ));

        // The save method returns a MySQLi object
        $insertID = $chat->save()->insert_id;

        return array(
            'status'    => 1,
            'insertID'  => $insertID
        );
    }

    public static function getUsers(){
        if($_SESSION['user']['name']){
            $user = new ChatUser(array('name' => $_SESSION['user']['name']));
            $user->update();
        }

        // Deleting chats older than 5 minutes and users inactive for 30 seconds

        DB::query("DELETE FROM webchat_lines WHERE ts < SUBTIME(NOW(),'0:5:0')");
        DB::query("DELETE FROM webchat_users WHERE last_activity < SUBTIME(NOW(),'0:0:30')");

        $result = DB::query('SELECT * FROM webchat_users ORDER BY name ASC LIMIT 18');

        $users = array();
        while($user = $result->fetch_object()){
            $user->gravatar = Chat::gravatarFromHash($user->gravatar,30);
            $users[] = $user;
        }

        return array(
            'users' => $users,
            'total' => DB::query('SELECT COUNT(*) as cnt FROM webchat_users')->fetch_object()->cnt
        );
    }

    public static function getChats($lastID){
        $lastID = (int)$lastID;

        $result = DB::query('SELECT * FROM webchat_lines WHERE id > '.$lastID.' ORDER BY id ASC');

        $chats = array();
        while($chat = $result->fetch_object()){

            // Returning the GMT (UTC) time of the chat creation:

            $chat->time = array(
                'hours'     => gmdate('H',strtotime($chat->ts)),
                'minutes'   => gmdate('i',strtotime($chat->ts))
            );

            $chat->gravatar = Chat::gravatarFromHash($chat->gravatar);

            $chats[] = $chat;
        }

        return array('chats' => $chats);
    }

    public static function gravatarFromHash($hash, $size=23){
        return 'http://www.gravatar.com/avatar/'.$hash.'?size='.$size.'&amp;default='.
                urlencode('http://www.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?size='.$size);
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:34:45.537

您可以将媒体流复制到画布中，然后根据需要进行操作。然后，您可以将事件侦听器分配给画布并单击鼠标以创建图像。你可以用画布`toDataUrl`方法做到这一点。

所以工作流程会是这样的：

*   访问相机`getUserMedia`
*   创建生活媒体流的副本并移动到画布中
*   将事件侦听器附加到`canvas`并单击...
*   `toDataUrl`使用方法将画布导出到图像

我希望你明白了。

**编辑：**

我刚刚用真实的代码示例找到了我所做的相同解释：[https ://developer.mozilla.org/en-US/docs/WebRTC/Taking_webcam_photos](https://developer.mozilla.org/en-US/docs/WebRTC/Taking_webcam_photos)

# java - 使用 NetBeans 编译，但无法从 bash 编译或运行

> ID：14589840
> 
> 赞同：1
> 
> 时间：2013-01-29T18:36:11.407
> 
> 标签：java, netbeans

我已经研究了几个星期，似乎无法弄清楚。我有一个使用 NetBeans 编写的 Java 程序。它有几个依赖的导入或 .jar 文件。它在 NetBeans 中运行良好。但我不知道如何调用 .jar 文件并从 bash 命令行编译。我正在使用 Mac。我已经阅读了几篇关于此的帖子，但到目前为止没有一篇对我有意义。程序中使用了 26 个导入。不知道是需要用Ant还是指定-CP或者Classpath来编译。当然，我不必键入每个 .jar 文件来从 bash 命令行编译它吗？

Java(TM) SE 运行时环境 (build 1.7.0_09-b05)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:41:27.140

您应该能够简单地将 ant 与`build.xml`Netbeans 项目目录中的 ant 一起使用。它应该为您“正常工作”。如果没有安装 Netbeans，该项目可能无法构建（例如，如果您尝试将项目移动到另一台机器），但使用 Netbeans，它应该可以开箱即用。

如果您没有安装 Ant，则需要安装它。

附加物：

要构建它，如果您安装了 Ant，您应该能够简单地转到`build.xml`文件所在的项目目录，然后键入“ant”，它应该构建并将内容放入`dist`目录中。

如果您进入`dist`目录并键入`java -jar yourapp.jar`，它应该会运行，因为 jar 中的清单将指向附近的 lib jar 文件。如果您想分发应用程序，java 有不同的选项，例如制作与 Mac 兼容的应用程序或 Windows EXE，您需要搜索这些。或者您可以简单地分发`dist`目录的内容并编写一个脚本来执行整个 java -jar yourapp.jar 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:41:57.400

如果你使用的是 Java 1.6 或更高版本，你可以将所有 26 个 jar 文件扔到一个文件夹中，然后简单地添加

```
-cp folder_name/* 
```

作为您的类路径参数。

其他一些选项是 1.) 在命令行上键入所有 26 个 jar 文件（使用您提到的 -cp 参数）2.) 使用 Ant 或 Maven 或其他一些构建工具并在配置文件中列出这 26 个 jar 文件说构建工具或 3.) 编写一个快速而肮脏的 shell 脚本，它将为您设置 CLASSPATH 环境变量，然后运行您的 javac 命令。

# ruby - 从 Ruby Cassandra Gem 读取数值数据时出现问题

> ID：14589841
> 
> 赞同：0
> 
> 时间：2013-01-29T18:36:21.030
> 
> 标签：ruby, cassandra

我在使用 Cassandra Gem 从 Cassandra 读取数据时遇到问题......这是我的代码：

```
require 'cassandra'
@states = {}
@client = Cassandra.new('Logs', "10.1.1.11:9160")
@client.get_range(:PlaybackStates) do |ckey,bb|
    @states[bb["State"].to_sym] = key
end
pp @states 
```

我明白了：

```
{:DrmInit=>"\x00\x00\x00(",
 :Buffering=>"\x00\x00\x00x",
 :PreBuffering=>"\x00\x00\x002",
 :Debug=>"\x00\x00\x016",
 :FullScreen=>"\x00\x00\x01\x90",
 :Seek=>"\x00\x00\x00\x96",
 :LoadManifest=>"\x00\x00\x00\x14",
 :Play=>"\x00\x00\x00d"} 
```

这是我所期望的：

```
{:DrmInit=>[40],
 :Buffering=>[120],
 :PreBuffering=>[50],
 :Debug=>[310],
 :FullScreen=>[400],
 :Seek=>[150],
 :LoadManifest=>[20],
 :Play=>[100]} 
```

我可以通过在代码中执行此操作来获得此结果：

```
require 'cassandra'
@states = {}
@client = Cassandra.new('Logs', "10.1.1.11:9160")
@client.get_range(:PlaybackStates) do |ckey,bb|
    @states[bb["State"].to_sym] = ckey.unpack("N*") # unpacking the string with N*
end
pp @states 
```

我还得到了时间戳和日期字段的二进制表示......我做错了吗？为什么 GEM 不转换数据类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T22:42:29.883

Twitter 的 cassandra gem 目前不理解 UTF8 以外的数据类型。因此，它将本机整数和其他数据类型解释为字符串。

我建议改用 cassandra-cql gem。它完全支持将原生 Cassandra 数据类型映射到原生 Ruby 类型。

[https://github.com/kreynolds/cassandra-cql](https://github.com/kreynolds/cassandra-cql)

[http://rubygems.org/gems/cassandra-cql](http://rubygems.org/gems/cassandra-cql)

# javascript - 在循环上的两个 div 之间淡入/淡出

> ID：14589842
> 
> 赞同：1
> 
> 时间：2013-01-29T18:36:22.297
> 
> 标签：javascript, jquery

我将如何让两个 div 在两者之间交替淡入/淡出，以便一次只能看到一个？并且还让它进入一个永无止境的循环？

提前致谢！！

我知道应该使用 .fadeOut 和 .fadeIn 来完成 - 但不知道如何让它一遍又一遍地循环。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:49:58.717

这是我自己的版本

[http://jsfiddle.net/3KydB/](http://jsfiddle.net/3KydB/)

```
window.switchIn = function () {
    $('.red').fadeToggle(function() {
        $('.blue').fadeToggle(function() {
            setTimeout(function() {window.switchOut();}, 500);
        });
    });

}

window.switchOut = function () {
    $('.blue').fadeToggle(function() {
        $('.red').fadeToggle(function() {
            setTimeout(function() {window.switchIn();}, 500);
        });
    });

}

setTimeout(function() {window.switchIn();}, 500) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T19:03:15.267

您的问题的解决方案比简单的解决方案要复杂一些，`fadeToggle`因为您不希望任何一个 DIV 同时显示。关键是将淡入淡出动作链接在一起，这样下一个淡入淡出动作在前一个淡入淡出动作完成之前不会执行。

从逻辑上讲，您想要：DIV1 淡入，DIV1 淡出，DIV2 淡入，DIV2 淡出，重复。

我下面的解决方案将采用页面上的任何两个元素并振荡它们的可见性*，而不会*同时显示任何一个。`iDuration`以毫秒为单位指定每个转换的时间。

[**工作示例**](http://jsfiddle.net/sNbcH/)

HTML：

```
<div id="div1" style="display:none;">DIV #1</div>
<div id="div2" style="display:none;">DIV #2</div> 
```

JavaScript：

```
function runToggle(iDuration, domFirst,domSecond) {
        $(domFirst).fadeToggle(iDuration, "linear",function() {
          $(domFirst).fadeToggle(iDuration, "linear",function() {
            $(domSecond).fadeToggle(iDuration,"linear",function() {
              $(domSecond).fadeToggle(iDuration,"linear",function() {
                  setTimeout(function() {
                      runToggle(domFirst,domSecond) ;
                  },50);
              });
            }); 
          });
       }); 
};

runToggle(1000, $('#div1'),$('#div2')); 
```

我使用`setTimeout`不是为了计时目的，而只是为了释放 JavaScript 解释器，以便浏览器可以在这个淡入淡出循环运行时做其他事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:47:41.550

你好吗，你可以做到这一点。

**setInterval()** - 以指定的时间间隔一遍又一遍地执行一个函数；

**setInterval（代码，毫秒，语言）**

所以，你可以创建一个函数来实现它。一个例子

```
<div id="one" style="display:none;"></div>
<div id="two"></div>
<script>
$(function(){
setInterval(function(){MakeToggleDivs();},1000);
});
function MakeToggleDivs(){
$('#one').fadeToggle(400);
$('#two').fadeToggle(400);
}
</script> 
```

这必须有效，告诉我是否无效。

祝你好运！

# php - c ++程序没有使用带有exec（），shell_exec（），system（）等命令的php脚本执行

> ID：14589843
> 
> 赞同：0
> 
> 时间：2013-01-29T18:36:30.957
> 
> 标签：php, c++, shell-exec

我正在尝试在 Ubuntu 12.04 中使用 php 脚本编译和执行 c++ 程序。c++ 程序正在编译，甚至 a.out 正在创建，但唯一的问题是 ./a.out 不起作用。我已经尝试了大多数命令来运行 ./a.out，例如 system()、exec()、shell_exec()、backtick、passthru 等。现在为了简单起见，a.out 在 php 所在的同一目录中创建文件驻留。我在这里发布代码

```
 $target = $_GET['name'];
 chmod($target,0777); 
 $handle = fopen("compile.sh", "x+");
 chmod("compile.sh",0777);
 $data = "g++ ".$target;     
 fwrite($handle, $data);
 fclose($handle);  
 system("sh compile.sh");    
 chmod("a.out", 0777);   
 system("./a.out"); 
```

我正在获取要从 url 编译的文件的名称等。上面的代码在倒数第二行之前都可以正常工作，即 chmod("a.out",0777) 但没有显示 cpp 程序的输出。**最有趣的部分是*在将 g++ 更改为 gcc 之后，相同的代码在 c 程序中运行得非常好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T13:05:57.593

我解决了由于文件 libgcc_s.so.1 给出错误而导致的问题

> /lib/libgcc_s.so.1：找不到版本“GCC_4.2.0”（/usr/lib/libstdcc+.so.6 需要）

我所做的只是将位于lampp目录的lib文件夹中的这个文件替换为gcc目录中的libgcc_s.so并将其重命名为libgcc_s.so.1。

# parsing - 在任意数量的其他规则中间匹配一个规则

> ID：14589847
> 
> 赞同：0
> 
> 时间：2013-01-29T18:36:44.327
> 
> 标签：parsing, antlr, predicate, greedy

我正在研究一种使用大括号来识别层次结构的数据定义语言。

```
typeA idS
{
    paramX = value
    typeB idT
    {
        paramY = value
    }       
} 
```

有大量不同的规则来验证哪些参数和子类型对某种类型的块有效。

我想添加功能以允许将特殊块类型放置在*任何*现有块或一组名称/值对周围。

```
BLOCK
{
    typeA idS
    {
        BLOCK
        {
            paramX = value
        }
        BLOCK
        {       
            typeB idT
            {
                paramY = value
            }
        }       
    }
 } 
```

有没有一种方法可以创建一个允许其内部的任何内容的块，而不必专门为每个现有类型添加 BLOCK 支持，并且不会丢失解析器检查子参数/类型对给定父项是否有效

我试过使用通配符，贪婪和非贪婪无济于事。

```
block: BLOCK '{' (options {greedy=false;} : .* ) '}' 
```

其他答案表明句法谓词可以解决它，但我无法弄清楚如何使用它们（链接到任何在线资源将不胜感激）。

有没有办法在不触及所有其他规则的情况下做到这一点？（希望不需要很多 BLOCK_subtypes 来保持父/子检查的完整性）。我担心可读性和维护麻烦。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T22:56:16.207

这似乎需要多次通过。

在第一遍中，您基本上可以只解析块和数据而无需进行任何验证，例如

```
blockType: BLOCK OPEN_BRACE type CLOSE_BRACE -> (BLOCK type);
blockParam: BLOCK OPEN_BRACE param CLOSE_BRACE -> (BLOCK param);
type: blockType | (typeName idName OPEN_BRACE param CLOSE_BRACE ->
                 (TYPE typeName idName param));
param: blockParam | (paramName EQUALS value -> (PARAM paramName value)); 
```

这将产生一个 AST，作为第二遍的输入。在那里，你需要像这样的规则

```
paramA: (PARAM paramNameA value) | (BLOCK paramA);
typeB: (TYPE typeNameB idNameB paramB) | (BLOCK typeB); 
```

块结构侵入了您的所有规则，但它是以标准方式这样做的。你甚至可以写一些东西来修改你的语法文件来添加它。

您也可能想要使用预处理器。用特殊的、否则无效的字符串替换 BLOCK { 和匹配的 } 的东西不难写。然后每个规则将具有 BLOCK_START 形式？东西BLOCK_END？。您应该能够添加操作以确保您不会有一个没有结束的开始，但是如果预处理器正在工作（并拒绝实际的特殊文本），那应该是不可能的。

所有这些可能比您想要的更具侵入性，但构造相当侵入。

我假设额外的标签实际上会触发某种特殊处理。如果它们只是语法糖，那么任何一种解决方案都是本地化的。预处理器只会删除 BLOCK 文本。AST 解决方案将生成相同的 AST，无论它匹配 BLOCK 还是裸语句。

# asp.net-mvc - MVC、Jquery 移动和日期选择器

> ID：14589855
> 
> 赞同：0
> 
> 时间：2013-01-29T18:37:22.300
> 
> 标签：asp.net-mvc, jquery-mobile

好的，我将我现有的 MVC4 应用程序扩展为移动应用程序。

对 jquery mobile 来说是全新的，我在 MVC 中遇到了很多问题。布局页面 (MVC) 和 jquery mobile 是一场噩梦，还是只有我一个人？

所以我只是想在我的页面中显示 jquery ui datepicker，它没有显示！我必须重新加载页面才能显示，为什么？？？

好的布局页面

```
@{
    Layout = null;

}

    <!DOCTYPE html>
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
            <meta name="apple-mobile-web-app-capable" content="yes" />
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title></title>
     <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css"/>
      <script src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
            <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
            <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>

        </head>
        <body>
            @RenderBody();
        </body>

    </html> 
```

现在的观点

```
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_AppLayout.Iphone.cshtml";

}

<script>
    $(function() {
        $( "#datepicker" ).datepicker();
    });

</script>
@using (Html.BeginForm())
{
    <div data-role="page" id="pageAccount">
    <div data-role="content">

       <div id="datepicker"></div>
</div>

        </div>

} 
```

任何想法为什么页面显示，但没有日期选择器（我必须重新加载页面才能显示）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:39:49.210

## 解决方案 ：

这应该改变：

```
$(function() {
    $( "#datepicker" ).datepicker();
}); 
```

对此：

```
$(document).on('pageshow', '#pageAccount', function(){       
    $( "#datepicker" ).datepicker();
}); 
```

长话短说。jQuery Mobile 不应该与经典的**`DOM`**就绪**`jQuery`**函数一起使用。而是**`jQuery Mobile`**为我们提供页面事件。如果您想了解更多关于 jQuery 移动页面事件及其工作原理的信息，请查看这篇**[文章](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**，以使其透明，这是我的个人博客。或者你可以看看**[这里](https://stackoverflow.com/a/14469041/1848600)**。

## 编辑 ：

这是一个工作示例：

改变位置

```
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script> 
```

进入：

```
 <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
 <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

**`jQuery Mobile`**与 .一起使用时应始终最后加载**`jQuery UI`**。

你也忘记了，你会发现没有格式化的 datepicker。**`jQuery UI`** **`CSS`****`CSS`**

# c++ - 这里有什么问题？

> ID：14589860
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:37:43.020
> 
> 标签：c++

> **可能重复：**
> [为什么循环条件内的 iostream::eof 被认为是错误的？](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)

我用这段代码将第一个“替换为”，第二个替换为“”，一切正常，除了它在读取最后一个字符后再次运行循环，这使得程序打印另一个字符

```
#include <fstream>
#include <iostream>
using namespace std ;
void main ()
{
    ifstream infile;
    infile.open("infile.txt");
    ofstream outfile;
    outfile.open("outfile.txt");
    char c ;

    int i = 0 ;
    while ( !infile.eof() )
    { 
        infile.get(c)
            if (c=='\"')
            {
                i++ ;
                if (i%2==0)
                    outfile<<"\'\'";
                else 
                    outfile<<"``";
            }
            else 
                outfile<<c;
    }
    outfile.close();
    infile.close();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:41:42.050

不要这样做`while ( !infile.eof() )`- 这仅检查前一次读取是否到达文件末尾，而不是下一次读取是否会。因此，当读取最后一个字符时，它会再次循环，发现它还没有到达文件末尾，然后继续读取另一个字符，即使没有另一个字符要读取。您`c`将具有与上一次迭代相同的值。

相反，请执行以下操作：

```
while (infile.get(c))
{
  // ... 
} 
```

这将从文件中读取一个字符，然后，如果成功，将对那个字符做一些事情。

# jquery - 使用 jquery 删除 url 字符串

> ID：14589861
> 
> 赞同：0
> 
> 时间：2013-01-29T18:37:45.493
> 
> 标签：jquery, attr

基本我知道，但是如何/如何使用 jquery 删除 url 字符串？

例如，您使用`attr`将图像的 url 字符串归因于一个名为#picbox 的 div，您将如何删除第一个 url 字符串（例如点击功能），然后将第二个 url 字符串重新归因于该 div？

```
var urlString1 = "images/1.jpg";
var urlString2 = "images/2.jpg";

$("#picbox").attr('src', urlString1);

$("#changeString").click(function(){
  // remove urlString1 then replace with urlString2
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:39:49.787

无需删除它。设置一个新的`src`将自动删除旧的：

```
$("#picbox").attr('src', urlString1);

$("#changeString").click(function(){
    $("#picbox").attr('src', urlString2);
}); 
```

* * *

为了获得更好的性能，您应该缓存该选择器：

```
$img = $("#picbox").attr('src', urlString1);

$("#changeString").click(function(){
     $img.attr('src', urlString2);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T19:00:36.463

目前尚不清楚您要实现什么目标，并且代码的第三行存在错误。

```
$("#picbox").attr(urlString1); // tries to read attribute named "images/1.jpg" of #picbox 
```

我假设你想要这样的东西：

```
$("#picbox").attr("data-url", urlString1); // stores value "images/1.jpg" in "data-url" attribute

$("#changeString").click(function(event) {
    $("#picbox").attr("data-url", urlString2); // replace previous value with new
}); 
```

您可以将属性名称“data-url”替换为适合您情况的名称。此外，如果您继续使用数据属性，您可以使用：

```
$("#picbox").data("url", urlString1); 
```

达到与 .attr() 相同的效果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:53:58.283

```
var urlString1 = "images/1.jpg";
var urlString2 = "images/2.jpg";

$("#picbox").attr("src",urlString1);

$("#changeString").click(function(){
  // remove urlString1 then replace with urlString2
  $("#picbox").attr("src",urlString2);
}); 
```

# html - 有没有办法访问 HTML 页面的主要图形上下文？

> ID：14589862
> 
> 赞同：0
> 
> 时间：2013-01-29T18:37:46.567
> 
> 标签：html, canvas, html5-canvas, framebuffer

> **可能重复：**
> [使用 HTML5/Canvas/Javascript 截取屏幕截图](https://stackoverflow.com/questions/4912092/using-html5-canvas-javascript-to-take-screenshots)

有没有办法将 HTML 页面的主要图形上下文复制到画布中？

从 Javascript 中，我想抓取当前可见 HTML 页面的“屏幕截图”并将其复制到缩略图或画布上。（不是来自单独的“截屏”应用程序，而是来自 javascript 页面本身）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:50:24.327

你不能这样做。但是，如果您使用 google chrome，您可以编写一个 chrome 扩展程序，这将为您提供用于捕获图像的新 javascript 函数，例如：

```
chrome.tab.captureVisibleTab( ....) 
```

例如可以查看源代码网页截图Extesnion： [https ://chrome.google.com/webstore/detail/webpage-webcam-screenshot/ckibcdccnfeookdmbahgiakhnjcddpki](https://chrome.google.com/webstore/detail/webpage-webcam-screenshot/ckibcdccnfeookdmbahgiakhnjcddpki)

# ruby-on-rails - 为什么我会收到此错误“Errno::ECONNREFUSED（连接被拒绝 - 连接（2））”？

> ID：14589867
> 
> 赞同：0
> 
> 时间：2013-01-29T18:38:03.157
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用设计和 reCaptcha。
我注册后，`Something went wrong`立即发生错误。
所以我看了一下日志。它说这个。

```
Completed 500 Internal Server Error in 1366ms

Errno::ECONNREFUSED (Connection refused - connect(2)):
  app/controllers/registrations_controller.rb:6:in `create' 
```

一切都在开发模式下完美运行，那么为什么我在生产模式下得到这个？

**注册控制器.rb**

```
4\. def create
5\.     if verify_recaptcha
6\.         super
7\.         flash.delete(:recaptcha_error)
8\.         else 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:11:52.843

因此，您无需在开发和生产中都设置动作邮件程序。我不知道为什么一切都在开发中。可能你有一个本地邮件服务器？[默认情况下](http://api.rubyonrails.org/classes/ActionMailer/Base.html)，actionmailer 尝试在`localhost:25`.

作为一种选择，尝试设置`config.action_mailer.delivery_method = :test`你的`production.rb`，看看问题是否会消失。此设置将告诉操作邮件程序不要发送电子邮件，而是将电子邮件标题和内容写入日志文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T21:43:18.233

这不是邮件错误。由于缺乏连接，这似乎是太阳黑子的错误。尝试在生产中启动太阳黑子：

```
bundle exec rake sunspot:solr:start RAILS_ENV=production 
```

# go - 使用golang的mgo库，如何检索列表等嵌套对象

> ID：14589869
> 
> 赞同：5
> 
> 时间：2013-01-29T18:38:07.677
> 
> 标签：go, mgo

我正在尝试检索填充此类的对象：

```
type Room struct {
    Name   string
    People []Person
    Chat   []ChatMessage
    Me     Person
} 
```

数据字段“人”作为空切片 [] 出现。我正在使用简单的查找来获取数据。

```
result := Room{}
err = c.Find(bson.M{"name": "dev"}).One(&result) 
```

我究竟做错了什么？

弄清楚了....

答案可以在这里找到： [https ://groups.google.com/d/msg/mgo-users/KirqfCSlKFc/t2l3l4yxFRwJ](https://groups.google.com/d/msg/mgo-users/KirqfCSlKFc/t2l3l4yxFRwJ)

基本上，只需要在 People []Person 行的末尾添加 'bson: ""'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T17:38:55.527

弄清楚了....

答案可以在这里找到：[https ://groups.google.com/d/msg/mgo-users/KirqfCSlKFc/t2l3l4yxFRwJ](https://groups.google.com/d/msg/mgo-users/KirqfCSlKFc/t2l3l4yxFRwJ)

基本上，只需要在 People []Person 行的末尾添加 'bson: ""'

# python - 获取失败的 django-celery 任务的参数

> ID：14589872
> 
> 赞同：3
> 
> 时间：2013-01-29T18:38:14.417
> 
> 标签：python, celery, django-celery

给定任务的 ID，是否可以获得用于调用特定失败 celery 任务的参数？我使用 MongoDB 作为代理并使用 django-celery 包。

我知道您可以很容易地获得结果，但想知道您是否可以对用于调用该任务的参数执行相同的操作。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T13:07:16.483

我设法通过为我的任务实现自定义 on_failure 处理程序来解决这个问题，如下所示：

[http://docs.celeryproject.org/en/latest/userguide/tasks.html#handlers](http://docs.celeryproject.org/en/latest/userguide/tasks.html#handlers)

我得到了 args 信息以及错误并将其保存到数据库中。

# xcode - 手动创建的 Git 存储库无法提交

> ID：14589882
> 
> 赞同：1
> 
> 时间：2013-01-29T18:38:48.417
> 
> 标签：xcode, git, repository, commit

使用以下命令使用终端应用程序创建 Git 存储库后

将 shell 集中在项目目录上

`$ cd ~/Desktop/Myproject`

设置 Git 存储库

`$ git init`

为“暂存区”准备文件

`$ git add .`

进行我的第一次提交

`$ git commit -m 'Initial Checkin'`

当我现在尝试在 Xcode 中提交时，我得到

> 由于未找到有效的工作副本，因此无法执行该操作。
> 
> 请验证您的文件是否受源代码控制，然后重试。

但是，如果我将任何项目文件和 $ git status 修改为 shell，它会告诉我我在 Xcode 中摆弄的任何文件都已被修改，我可以从那里提交。为什么不在 Xcode 中？

我在[Can't commit changes to local git repository](https://stackoverflow.com/questions/8148544/cant-commit-changes-to-local-git-repository)有一个战利品，但这些建议并没有解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T19:01:16.977

我曾经发生过这种情况，通过退出并重新打开 Xcode 解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T02:14:45.427

如果重新启动 XCode 没有帮助，因为您说它可以通过终端正常工作，请尝试在 XCode 中再次添加它。

转到Organzier--> Repositories--> Add Repository（左下角）-->为您的项目设置正确的值和本地路径

我的猜测是，由于您在 XCode 之外创建了存储库，由于某种原因，它没有正确检测到它，或者没有正确的权限。通过 XCode 重新添加存储库可能有助于为您解决此问题。

# python - c数组到python

> ID：14589883
> 
> 赞同：0
> 
> 时间：2013-01-29T18:38:51.163
> 
> 标签：python, c, ctypes

我需要使用共享库 (.so) 处理从 C 程序到 python 实例 (Django) 的大量数据。是否可以通过 ctypes 返回它们？

例如：

```
import ctypes
a = ctypes.CDLL('foo.so')
b = a.collect()
latitude  = b.latitude
longitude = b.longitude 
```

和一个 C：

```
main()
{
    /* steps to get the data */
    return <kind of struct or smth else>;
} 
```

我是新手，有没有办法提供这种数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:48:11.283

一种选择是通过指针参数返回值：

```
// c 
void collect(int* outLatitude, int* outLongitude) {
    *outLatitude = 10;
    *outLongitude = 20;
} 
```

和

```
# python
x = ctypes.c_int()
y = ctypes.c_int()
library.collect(ctypes.byref(x), ctypes.byref(y))
print x.value, y.value 
```

* * *

如果你需要更多，你可以返回一个结构：

```
// c
typedef struct  {
    int latitude, longitude;
} Location;

Location collect(); 
```

和

```
# python
class Location(ctypes.Structure):
    _fields_ = [('latitude', ctypes.c_int), ('longitude', ctypes.c_int)]

library.collect.restype = Location
loc = library.collect()
print loc.latitude, loc.longitude 
```

* * *

顺便说一句：你提到了 Django；我会在这里小心并发。请注意，您的 C 库可能会从不同的线程中调用。

# playframework-2.0 - 是否有由 Play（2.1.x 及更高版本）框架（如果有）认可/设计的 MV** JavaScript 框架？

> ID：14589889
> 
> 赞同：9
> 
> 时间：2013-01-29T18:39:23.273
> 
> 标签：playframework-2.0

我是 Play 框架的新手，我想知道它是否有任何“伴侣”MV** JavaScript 框架。

是否有任何框架（Backbone.js、Angular.js、Knockout.js、Ember.js 等）具有

*   来自 TypeSafe 的某种官方认可
*   Play框架社区背书
*   播放集成文档/教程
*   不错的开源 Play 框架插件

如果没有，是否有任何 MV** 框架应该避免出于任何特定原因与 Play 一起使用？

# asp.net - 当 apphost 配置中存在 system.web 配置时，IIS 8 中的 HTTP 错误 500.19

> ID：14589905
> 
> 赞同：9
> 
> 时间：2013-01-29T18:40:10.607
> 
> 标签：asp.net, iis, iis-8

我们有一个实用程序，可以在安装到客户服务器上时自动设置 ASP.NET Web 应用程序。该实用程序通常会在 applicationHost.config 中为新应用程序的位置路径添加许多配置。我们使用 Microsoft.Web.Administration 配置类以编程方式执行此操作。

这在 IIS 7.0 和 IIS 7.5 中运行良好，但是当我们尝试在 IIS 8（Server 2012）中安装相同的配置时，由于据称格式错误的 XML 元素（HRESULT 0x8007000d），我们开始为服务器上托管的所有内容收到 500.19 服务器错误. 我系统地检查了我们安装的所有配置，它似乎是 system.web/httpRuntime maxRequestLength 属性（见下文）。似乎 system.web 配置元素本身就是罪魁祸首，因为错误在它本身被删除之前不会消失。

我已经确认 system.web/httpRuntime 的部分定义声明它在任何地方都是允许的，并且您可以在配置的其他级别（例如 web.config）设置 system.web 配置而不会出现问题。为什么我们不能在 applicationHost.config 中设置它？

```
<location path="Default Web Site/ManagementConsole">
    <!-- ... more config ... -->
    <system.web>
        <httpRuntime maxRequestLength="10240" />
    </system.web>
</location> 
```

编辑：在原始帖子之后，我注意到 500.19 错误引用的文件是一个临时应用程序池配置文件（C:\inetpub\temp\apppools\apppoolname\apppoolname.config。该文件的内容是：

```
<!-- ERROR: There's been an error reading or processing the applicationhost.config file.  Line number: 905  Error message: The configuration section 'system.web' cannot be read because it is missing a section declaration
--> 
```

但是当我进入 applicationHost.config 并为 system.web 添加一个节组定义和一个为 httpRuntime 的节定义时，500.19 中的消息更改为声称存在重复的 system.web/httpRuntime 定义！所以我不能定义它，我也不能不定义它。什么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:50:06.483

我已经看到当未安装所有必要的模块时会发生此错误。它不会告诉您缺少模块，而是会抱怨配置已损坏。检查您在 IIS 7/7.5 机器上安装的相同模块是否也安装在 IIS 8 上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-26T18:06:51.977

在我们的例子中，我们没有安装 URL Rewrite。而不是抱怨它丢失它只是给了我们这个通用的信息。

我认为将站点从 IIS 7.x 转移到 8.x 时需要做的是首先验证所有插件都已正确安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-11T06:23:40.897

嗨，我发现这个 youtube 视频对[IIS 7 教程](http://www.youtube.com/watch?v=vBNoTK31zPo)很有帮助，它也可以帮助您解决问题。或者也许这个链接可以帮助你。[对 IIS 7 中的 HTTP 500.19 错误进行故障排除](http://blogs.iis.net/webtopics/archive/2010/03/08/troubleshooting-http-500-19-errors-in-iis-7.aspx)，[当您访问托管在 IIS 7.0 上的网站时出现错误消息：“HTTP 错误 500.19 – 内部服务器错误”](http://support.microsoft.com/kb/942055)。[像专业人士一样解决 IIS7 错误](http://mvolo.com/troubleshoot-iis7-errors-like-a-pro)

我提供的链接将指导您确定问题的原因，根据您的陈述，它在不同情况下会发生变化。下面是一个解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T20:55:32.993

我有一个类似的问题，我在[这里](https://stackoverflow.com/questions/10801340/http-error-500-19-internal-server-error)发布到 SO 。另请查看有关[Feature Delegation](https://stackoverflow.com/questions/12208209/iis-8-0-asp-net-and-error-500-19)的这篇文章。

# android - 当系统时钟改变分钟时采取行动？

> ID：14589927
> 
> 赞同：2
> 
> 时间：2013-01-29T18:41:36.967
> 
> 标签：android, runnable

我的 Android 应用程序`TextView`告诉用户数据年龄（“13 分钟前”）。我目前使用 a 每秒更新一次`Runnable`，以捕获当分钟更改`notifyDataSetChanged()`为我的适配器时。但这会导致每秒垃圾收集......

`TextView`当系统时钟改变分钟而不检查每秒是否有这种变化时，是否有另一种方法来触发更新（或采取一般行动）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:45:42.273

由于您已经设置了 Runnable 和回调，因此使用模来计算下一次更新应该发生的时间：

```
handler.postDelayed(runnable, 
        DateUtils.MINUTE_IN_MILLIS - System.currentTimeMillis % DateUtils.MINUTE_IN_MILLIS); 
```

这将在下一分钟发生时运行回调，无论是 59、30 还是 1 秒。请注意，如果 Runnable 只更新一个 TextView，不要忘记切换到`DateUtils.HOUR_IN_MILLIS`事件一小时前，每分钟更新“1 小时前”是没有意义的。

您可能会发现类似[`DateUtils.getRelativeTimeSpanString()`](https://developer.android.com/reference/android/text/format/DateUtils.html#getRelativeTimeSpanString%28long,%20long,%20long%29)用于创建“x 分钟前”字符串的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T18:59:26.120

虽然山姆的回答非常好，但我只是添加了这个，因为它非常适合这个问题。时钟变化时，实际上每分钟系统都会发送一次广播。它是`Intent.ACTION_TIME_TICK`并且您只能使用`BroadCastReceiver`在您的代码中手动注册的 a 来接收它，而不是通过清单。[请参阅此处](http://developer.android.com/reference/android/content/Intent.html#ACTION_TIME_CHANGED)的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:50:38.320

使用具有固定周期的 Timer 对象。

这些方法采用 TimerTask 对象。

请参阅google的[Timer 文档](http://developer.android.com/reference/java/util/Timer.html)

记住在停止活动时取消计时器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T19:02:03.497

除了山姆的好答案之外，还有更漂亮的解决方案。

利用[http://developer.android.com/reference/android/text/format/DateUtils.html](http://developer.android.com/reference/android/text/format/DateUtils.html)查找时间跨度并注册`android.intent.action.TIME_TICK`您将在列表视图中更新时间的位置。

这是另一个相同的问题和[答案](https://stackoverflow.com/questions/28934625/android-listener-that-detects-minute-changing-in-the-clock/44192366)

# python - 修改方法只有方法的名称和实例对象

> ID：14589934
> 
> 赞同：0
> 
> 时间：2013-01-29T18:41:56.730
> 
> 标签：python, class, methods, instance

我知道`getattr()`你可以调用该方法，但是我需要覆盖它，所以`myInstance.mymethod`会被覆盖。

我将方法的名称作为字符串和实例的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:43:19.500

你可以用`setattr`

```
>>> class Foo(object):
...    def method(self): pass
... 
>>> a = Foo()
>>> a.method()
>>> setattr(a,'method',1)
>>> a.method()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'int' object is not callable 
```

用另一种方法替换：

```
>>> import types
>>> setattr(a,'method',types.MethodType(lambda self: self.__class__.__name__,a))
>>> a.method()
'Foo' 
```

lambda 的东西只是定义函数的花哨的简写：

```
def func(self):
    return self.__class__.__name__

setattr(a,'method',types.MethodType(func,a)) 
```

# php - 如何四舍五入mysql行结果

> ID：14589937
> 
> 赞同：0
> 
> 时间：2013-01-29T18:42:02.970
> 
> 标签：php, mysql, rounding

如何四舍五入mysql结果值

```
$earnedbasic=$runrows['salary']/$runrows['days']*$runrows['countdaystotal']; 
```

**示例：工资除以天数乘以工作日**

```
150 salary
29 days
30 workingdays

150/29x30=155.17241 
```

如果结果是这样的，那么我现在想要整数值示例 155.17241 并且我只想要 155.173 请帮我解决这个问题

```
<?php

       while ($runrows = mysql_fetch_assoc($run))
       {

        //get data
       $workerid = $runrows['workerid'];
       $keywords = $runrows['keywords'];
       $salary =  $runrows['salary'];
       $days = $runrows['days'];
       $countdaystotal = $runrows['countdaystotal'];
       $earnedbasic=$runrows['salary']/$runrows['days']*$runrows['countdaystotal'];

 echo "<table class='sortable' border='1' cellpadding='10'>";
        echo "<tr> <th>ID</th> <th>Name</th><th>Basic</th><th>Days</th> <th>Earned Basic</th><th>Total Salary</th></tr>";

     echo "<tr width='50%' onmouseover=\"this.style.backgroundColor='#999999';\" onmouseout=\"this.style.backgroundColor='#d4e3e5';\"><td width='20%'><a href=\"detail.php?id=$id\" class=\"style1\">$workerid</a></td>
     <td width='20%'>$keywords</td>
    <td width='20%'>$salary</td>
     <td width='20%'>$countdaystotal</td>
     <td width='20%'>$earnedbasic</td></tr>";

echo "</table>";
       }

     }

    }

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:43:38.150

呃...[`round($earnedbasic,3)`](http://php.net/round)应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:45:58.083

```
<td width='20%'>".round($earnedbasic, 3)."</td> 
```

或者

```
$earnedbasic=round($runrows['salary']/$runrows['days']*$runrows['countdaystotal'],3); 
```

# java - Android 中是否有类似 java.awt.Robot 的类？

> ID：14589938
> 
> 赞同：2
> 
> 时间：2013-01-29T18:42:07.090
> 
> 标签：java, android, awt

我正在寻找与 java.awt.Robot 相同的 Android 类

java.awt.Robot 能够模拟按键和释放键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:45:11.787

不，不存在 的等价物`Robot`。出于明显的隐私和安全原因，应用程序无法控制其他应用程序。

对于测试，您可以通过任意数量的测试框架来“模拟按下和释放键”，例如标准的 Android JUnit 测试用例、uianimator 和 monkeyrunner。

# python - 使用 Tornado 通过 GET 服务所有 REST 请求

> ID：14589940
> 
> 赞同：1
> 
> 时间：2013-01-29T18:42:11.460
> 
> 标签：python, rest, get, tornado, url-pattern

我有一个 REST（或几乎是 REST）的 web api，
我希望 API 用户能够使用所有的 api，即使由于某种原因只能进行 GET 调用，所以计划是接受一个 url 参数（查询字符串) 这样`request_method`可以是 GET（默认）或 POST、PUT、DELETE，我想路由它们。

**我的问题**不是标准请求处理程序覆盖和检查`get(self)`方法中的每个 httpRequestHandler 如果这意味着 POST、PUT、DELETE 和调用适当的函数，有没有办法在更一般的情况下执行此“路由”方式，例如在应用程序定义中的 URL 模式或覆盖路由功能或其他什么？

为了**清楚起见**，这些请求都是通过带有参数的 GET 来的，例如 `?request_method=POST`

任何建议表示赞赏。

**可能的解决方案：**

*   只有一个“.*” url 模式并在单个 RequestHandler 中处理所有路由。应该可以正常工作，除了我不会利用 Tornado 的 url 模式匹配功能。

*   `if`在所有请求处理程序中的所有方法中添加一个，`get(self)`并检查请求是否应由处理，`get`如果不是，则调用相关方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T10:02:56.520

这将是一件非常愚蠢的事情。Chrome 和 Firefox 以及许多其他 Web 用户代理都会推测性地获取 (GET) 页面上的部分或全部链接，包括您的`request_method=DELETE`URL。您会发现您的数据库已被清空，只是因为有人环顾四周。不要故意破坏 HTTP。GET 被*定义*为一种“安全”的方法，这意味着可以获取您喜欢的任何 URL，并且不会发生任何不好的事情。

**在类似情况下为其他人**编辑**
： OP 说他正在使用 JSONP 并且控制 API 服务器和客户端 Web 应用程序。在这种情况下，理想的解决方案是[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)（CORS，[规范](http://www.w3.org/TR/cors/)），尽管该技术需要 IE8+、Firefox 3.5+、Safari 4+ 或 Chrome 3+。如果您需要针对较早的浏览器，并且您控制两个域，我建议至少为您自己的客户端 Web 应用程序合并两个域的内容。api 域可以保留给外部客户端，但它们会受到 CORS 浏览器要求的限制。**

# android - Android - 在自定义侦听器中获取返回值

> ID：14589942
> 
> 赞同：0
> 
> 时间：2013-01-29T18:42:28.430
> 
> 标签：android, static, listener

请原谅我的法语英语！

所以，我的 Android 代码有问题......我调用了一个返回自定义对象的 arrayList 的方法......但是这个 arrayList 是异步加载并在侦听器中返回的。

您知道调用侦听器的方法时如何返回数据吗？

这是我的代码：

```
 public static ArrayList<Advert> getAdverts(Context context) {
    // Initialize
    RestHelper restHelper = new RestHelper();

    // Set the listener
    restHelper.setOnRestListener(new OnRestListener<Advert>() {
        @Override
        public void onDataAvailable(ArrayList<Advert> result) {
            // -- Datas are loaded : now we must return them ! --
        }
    });

    // Launch the async query
    restHelper.getRemoteAdverts();
    } 
```

谢谢 ！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T19:11:48.240

好吧，请重新审视你的函数设计，你厌倦了在同步函数（getAdverts）中进行异步加载。如果您的函数是同步的，那么只需同步加载列表并返回。

如果出于任何原因，如果您想继续使用当前方法，请在 setOnRestListener 之后阻止调用者，当您收到回调（onDataAvailable）时将其解锁并返回您的列表。

为此，您可以使用 ConditionVariable。

阻塞调用者：ConditionVariable.block(); 条件变量.close();

解除阻塞/打开调用者：ConditionVariable.open(); 希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:58:20.603

我不确定这个问题。您有一个可以调用的异步方法，但由于它是一个异步方法，因此它无法返回您的结果，因此您有 2 个解决方案： - 在方法中等待所有数据都可用，但您失去了异步的好处。- 实现 Oberserver/Observable 模式。

对于第一个选项，请查看 RestHelper，也许您已经有了解决方案。第二个选项的示例：

```
public static void requestAdverts(Context context) {
RestHelper restHelper = new RestHelper();
final AdvertListener thisInstance = this;
restHelper.setOnRestListener(new OnRestListener<Advert>() {
    @Override
    public void onDataAvailable(ArrayList<Advert> result) {
        thisInstance.notifyDataLoaded(result);
    }
});
// Launch the async query
restHelper.getRemoteAdverts(); 
```

创建一个接口：

```
interface AdvertListener { 
    notifyDataLoaded(ArrayList<Advert> result);
} 
```

最后让主类（调用 requestAdverts 方法的类）实现您的新接口。

# c# - 从 C# 中的串行端口读取和写入，第 2 部分

> ID：14589943
> 
> 赞同：1
> 
> 时间：2013-01-29T18:42:31.410
> 
> 标签：c#, serial-port

我正在尝试用 C# 替换 C 程序。C 程序通过 COM1 串行端口连接到旧计算机。我没有任何关于 C 代码如何连接到另一台机器的信息，但它确实连接正确，所以我必须猜测它是如何做到的。我一直在使用[Portmon](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)试图弄清楚 C 程序是如何成功读写的。当我的新 C# 应用程序运行时，我也一直在运行 Portmon。在我的 C# 程序中，我使用 SerialPort 类。

我试图通过在工作程序上使用 Portmon 的输出来确定 SerialPort 类中的不同项目应该具有什么值。我的想法是，如果我能得到正确的类的值，它就会正确地写入和读取。程序（如下）无法正常工作。程序成功打开 COM1 端口，但在尝试写入句点（然后是另一个句点）时失败。这些给出了超时。

查看在旧 C 程序后面运行的 Portmon 的输出，工作程序打开 COM1 端口，然后写一个句点，然后再写一个句点，然后从 COM1 端口读取成功值（&OK）。旧程序设置了几个我想在我的 C# 程序中复制的值。

我已经尝试了以下 SerialPort 选项的各种组合，但显然我没有找到任何东西。

顺便说一句，我在 Stack Overflow 问题*[Read and writing from a serial port in C#, part 2中问了一些初步问题](https://stackoverflow.com/questions/14405740)*

我在运行程序的机器上使用 Windows XP。COM1 端口另一边的机器是一台很旧的 PC。

有一个更好的方法吗？使用 Portmon 以外的东西？对于旧程序的 Portmon 输出，Process 列是 ntvdm.exe。那是问题吗？我不应该使用 C# SerialPort 类吗？**可能最重要的问题是：我应该为 Serialport 类使用什么值来匹配旧程序？**

我的 C# 程序：

```
SerialPort comport = new SerialPort();
comport.BaudRate = 9600;
comport.DataBits = 7;

comport.StopBits = StopBits.One;
comport.Parity = Parity.Odd;
comport.RtsEnable = true;
comport.DtrEnable = true;
comport.Handshake = Handshake.RequestToSend;
comport.ReadBufferSize = 8192;
comport.WriteBufferSize = 100;
comport.WriteTimeout = 30000; // 30 sec
comport.ReadTimeout = 30000; // 30 sec

comport.PortName = "COM1";

string tempFbuffer;
byte[] Fbuffer = new byte[200];
string alldata5;

tempFbuffer = "..";

for (int cnt = 0; cnt < tempFbuffer.Length; cnt++)
{
   Fbuffer[cnt] = Convert.ToByte(tempFbuffer[cnt]);
}

comport.Open();
comport.Write(Fbuffer, 0, 1);
comport.Write(Fbuffer, 1, 1);

for (i = 0; i < 4; i++)
{
    alldata5 = alldata5 + comport.ReadChar();

}

comport.Close(); 
```

我想模仿的应用程序的 Portmon 输出如下。此应用程序连接到另一台机器并正常工作。我手动将标题放在顶部。

如您所见，在第 33 和 34 行有成功的写入，然后在第 35 和 36 行有成功的读取。我在后台使用 Portmon 运行程序。

```
#       Time            Process         Reuest                          Port    Result   Other
0       0.00004407      ntvdm.exe       IRP_MJ_CREATE                   Serial0 SUCCESS Options: Open
1       0.00000198      ntvdm.exe       IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
2       0.00000115      ntvdm.exe       IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
3       0.00000104      ntvdm.exe       IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
4       0.00000106      ntvdm.exe       IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
5       0.0000008       ntvdm.exe       IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
6       0.00000082      ntvdm.exe       IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
7       0.00000085      ntvdm.exe       IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
8       0.00000081      ntvdm.exe       IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
9       0.00000712      ntvdm.exe       IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 1200
10      0.00000349      ntvdm.exe       IOCTL_SERIAL_CLR_RTS            Serial0 SUCCESS
11      0.00000366      ntvdm.exe       IOCTL_SERIAL_CLR_DTR            Serial0 SUCCESS
12      0.00000225      ntvdm.exe       IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: NONE WordLength: 5
13      0.00000111      ntvdm.exe       IOCTL_SERIAL_SET_CHAR           Serial0 SUCCESS EOF:0 ERR:0 BRK:0 EVT:0 XON:11 XOFF:13
14      0.00000735      ntvdm.exe       IOCTL_SERIAL_SET_HANDFLOW       Serial0 SUCCESS Shake:0 Replace:0 XonLimit:2048 XoffLimit:512
15      0.00000133      ntvdm.exe       IOCTL_SERIAL_LSRMST_INSERT      Serial0 SUCCESS Char: ffffffff
16      0.00000338      ntvdm.exe       IOCTL_SERIAL_SET_QUEUE_SIZE     Serial0 SUCCESS InSize: 8192 OutSize: 100
17      0.00000083      ntvdm.exe       IOCTL_SERIAL_GET_TIMEOUTS       Serial0 SUCCESS
18      0.00000092      ntvdm.exe       IOCTL_SERIAL_SET_TIMEOUTS       Serial0 SUCCESS RI:-1 RM:0 RC:0 WM:0 WC:0
19      0.00000349      ntvdm.exe       IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
20      0.00000342      ntvdm.exe       IOCTL_SERIAL_SET_RTS            Serial0 SUCCESS
21      0.00001121      ntvdm.exe       IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 1200
22      0.00000262      ntvdm.exe       IOCTL_SERIAL_SET_WAIT_MASK      Serial0 SUCCESS Mask: RXCHAR CTS DSR RLSD ERR RING
23      36.94054111     ntvdm.exe       IOCTL_SERIAL_WAIT_ON_MASK       Serial0 SUCCESS
24      0.00000403      ntvdm.exe       IOCTL_SERIAL_CLR_DTR            Serial0 SUCCESS
25      0.00000356      ntvdm.exe       IOCTL_SERIAL_CLR_RTS            Serial0 SUCCESS
26      0.00000351      ntvdm.exe       IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
27      0.00000348      ntvdm.exe       IOCTL_SERIAL_SET_RTS            Serial0 SUCCESS
28      0.00000717      ntvdm.exe       IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 9600
29      0.00000145      ntvdm.exe       IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
30      0.00000246      ntvdm.exe       IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: ODD WordLength: 5
31      0.00000086      ntvdm.exe       IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
32      0.00000226      ntvdm.exe       IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: ODD WordLength: 7
33      0.00002222      ntvdm.exe       IRP_MJ_WRITE                    Serial0 SUCCESS Length 1: .
34      0.00002142      ntvdm.exe       IRP_MJ_WRITE                    Serial0 SUCCESS Length 1: .
35      0.00000562      ntvdm.exe       IRP_MJ_READ                     Serial0 SUCCESS Length 4: &OK.
36      0.00000239      ntvdm.exe       IRP_MJ_READ                     Serial0 SUCCESS Length 0:
37      0.00000533      ntvdm.exe       IOCTL_SERIAL_WAIT_ON_MASK       Serial0 SUCCESS
38      0.0000023       ntvdm.exe       IRP_MJ_READ                     Serial0 SUCCESS Length 0:
39      95.8854497      ntvdm.exe       IOCTL_SERIAL_WAIT_ON_MASK       Serial0 SUCCESS
40      0.00002486      ntvdm.exe       IRP_MJ_WRITE                    Serial0 SUCCESS Length 1: D 
```

我正在创建的 C# 应用程序的 Portmon 输出如下。上面的 C# 代码在后台使用 Portmon 运行时会创建此输出。我把标题。

如您所见，在写入期间第 69 行出现超时错误。我需要它与 C 足够接近，以便写入和读取工作。

显然波特率、字长、奇偶校验和其他几个设置正确。

```
#       Time            Process         Reuest                          Port    Result   Other
0       0.00004362      fancom.exe      IRP_MJ_CREATE                   Serial0 SUCCESS Options: Open
1       0.0000019       fancom.exe      IOCTL_SERIAL_GET_PROPERTIES     Serial0 SUCCESS
2       0.00000263      fancom.exe      IOCTL_SERIAL_GET_MODEMSTATUS    Serial0 SUCCESS
3       0.00000096      fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
4       0.00000097      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
5       0.00000084      fancom.exe      IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
6       0.00000097      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
7       0.00000081      fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
8       0.00000088      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
9       0.0000008       fancom.exe      IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
10      0.00000079      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
11      0.00000715      fancom.exe      IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 9600
12      0.00000355      fancom.exe      IOCTL_SERIAL_CLR_DTR            Serial0 SUCCESS
13      0.0000024       fancom.exe      IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: ODD WordLength: 7
14      0.00000107      fancom.exe      IOCTL_SERIAL_SET_CHAR           Serial0 SUCCESS EOF:1a ERR:3f BRK:3f EVT:1a XON:11 XOFF:13
15      0.00000779      fancom.exe      IOCTL_SERIAL_SET_HANDFLOW       Serial0 SUCCESS Shake:8 Replace:84 XonLimit:1024 XoffLimit:1024
16      0.0000008       fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
17      0.00000081      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
18      0.00000081      fancom.exe      IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
19      0.00000081      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
20      0.00000705      fancom.exe      IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 9600
21      0.00000349      fancom.exe      IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
22      0.0000022       fancom.exe      IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: ODD WordLength: 7
23      0.00000098      fancom.exe      IOCTL_SERIAL_SET_CHAR           Serial0 SUCCESS EOF:1a ERR:3f BRK:3f EVT:1a XON:11 XOFF:13
24      0.00000493      fancom.exe      IOCTL_SERIAL_SET_HANDFLOW       Serial0 SUCCESS Shake:9 Replace:84 XonLimit:1024 XoffLimit:1024
25      0.00000684      fancom.exe      IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
26      0.00000108      fancom.exe      IOCTL_SERIAL_SET_TIMEOUTS       Serial0 SUCCESS RI:-1 RM:-1 RC:30000 WM:0 WC:30000
27      0.00000227      fancom.exe      IOCTL_SERIAL_SET_WAIT_MASK      Serial0 SUCCESS Mask: RXCHAR RXFLAG CTS DSR RLSD BRK ERR RING
28      35.62327662     fancom.exe      IOCTL_SERIAL_WAIT_ON_MASK       Serial0 SUCCESS
29      0.00000399      fancom.exe      IOCTL_SERIAL_SET_QUEUE_SIZE     Serial0 SUCCESS InSize: 8192 OutSize: 100
30      30.00157726     fancom.exe      IRP_MJ_WRITE                    Serial0 TIMEOUT Length 1: .
31      0.00000767      fancom.exe      IRP_MJ_FLUSH_BUFFERS            Serial0 SUCCESS
32      0.00001012      fancom.exe      IOCTL_SERIAL_SET_WAIT_MASK      Serial0 SUCCESS Mask:
33      0.00000402      fancom.exe      IOCTL_SERIAL_CLR_DTR            Serial0 SUCCESS
34      0.00000116      fancom.exe      IRP_MJ_FLUSH_BUFFERS            Serial0 SUCCESS
35      0.0000023       fancom.exe      IOCTL_SERIAL_PURGE              Serial0 SUCCESS Purge: RXABORT RXCLEAR
36      0.00000163      fancom.exe      IOCTL_SERIAL_PURGE              Serial0 SUCCESS Purge: TXABORT TXCLEAR
37      0.00000404      fancom.exe      IRP_MJ_CLEANUP                  Serial0 SUCCESS
38      0.00322359      fancom.exe      IRP_MJ_CLOSE                    Serial0 SUCCESS
39      0.00004607      fancom.exe      IRP_MJ_CREATE                   Serial0 SUCCESS Options: Open
40      0.00000188      fancom.exe      IOCTL_SERIAL_GET_PROPERTIES     Serial0 SUCCESS
41      0.00000277      fancom.exe      IOCTL_SERIAL_GET_MODEMSTATUS    Serial0 SUCCESS
42      0.00000092      fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
43      0.00000112      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
44      0.0000008       fancom.exe  IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
45      0.00000093      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
46      0.00000079      fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
47      0.00000085      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
48      0.00000081      fancom.exe      IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
49      0.00000082      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
50      0.00000704      fancom.exe      IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 9600
51      0.00000352      fancom.exe      IOCTL_SERIAL_CLR_DTR            Serial0 SUCCESS
52      0.00000225      fancom.exe      IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: NONE WordLength: 8
53      0.00000113      fancom.exe      IOCTL_SERIAL_SET_CHAR           Serial0 SUCCESS EOF:1a ERR:0 BRK:0 EVT:1a XON:11 XOFF:13
54      0.00000489      fancom.exe      IOCTL_SERIAL_SET_HANDFLOW       Serial0 SUCCESS Shake:8 Replace:80 XonLimit:1024 XoffLimit:1024
55      0.00000084      fancom.exe      IOCTL_SERIAL_GET_BAUD_RATE      Serial0 SUCCESS
56      0.00000083      fancom.exe      IOCTL_SERIAL_GET_LINE_CONTROL   Serial0 SUCCESS
57      0.00000081      fancom.exe      IOCTL_SERIAL_GET_CHARS          Serial0 SUCCESS
58      0.00000081      fancom.exe      IOCTL_SERIAL_GET_HANDFLOW       Serial0 SUCCESS
59      0.00000696      fancom.exe      IOCTL_SERIAL_SET_BAUD_RATE      Serial0 SUCCESS Rate: 9600
60      0.00000344      fancom.exe      IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
61      0.00000222      fancom.exe      IOCTL_SERIAL_SET_LINE_CONTROL   Serial0 SUCCESS StopBits: 1 Parity: NONE WordLength: 8
62      0.00000102      fancom.exe      IOCTL_SERIAL_SET_CHAR           Serial0 SUCCESS EOF:1a ERR:0 BRK:0 EVT:1a XON:11 XOFF:13
63      0.00000474      fancom.exe      IOCTL_SERIAL_SET_HANDFLOW       Serial0 SUCCESS Shake:9 Replace:80 XonLimit:1024 XoffLimit:1024
64      0.00000345      fancom.exe      IOCTL_SERIAL_SET_DTR            Serial0 SUCCESS
65      0.00000081      fancom.exe      IOCTL_SERIAL_SET_TIMEOUTS       Serial0 SUCCESS RI:-1 RM:-1 RC:30000 WM:0 WC:30000
66      0.00000192      fancom.exe      IOCTL_SERIAL_SET_WAIT_MASK      Serial0 SUCCESS Mask: RXCHAR RXFLAG CTS DSR RLSD BRK ERR RING
67      30.00755135     fancom.exe      IOCTL_SERIAL_WAIT_ON_MASK       Serial0 SUCCESS
68      0.00000353      fancom.exe      IOCTL_SERIAL_SET_QUEUE_SIZE     Serial0 SUCCESS InSize: 8192 OutSize: 100
69      29.99287343     fancom.exe      IRP_MJ_WRITE                    Serial0 TIMEOUT Length 1: .
70      0.00000349      fancom.exe      IRP_MJ_FLUSH_BUFFERS            Serial0 SUCCESS
71      0.00000985      fancom.exe      IOCTL_SERIAL_SET_WAIT_MASK      Serial0 SUCCESS Mask: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T18:42:21.720

PortMon 为 \n 输出句点。

# php - .htaccess 漂亮的 URL 导致 404

> ID：14589948
> 
> 赞同：0
> 
> 时间：2013-01-29T18:42:41.710
> 
> 标签：php, .htaccess, rewrite

我想重写`mypage.com/foo.php`为`mypage.com/foo`. 我的重写正确地更改了 URL，但是结果页面是 404。

这是我到目前为止所得到的：

```
# Setup conditions for internal rewrite of Foo
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# Rewrite for TDS
RewriteRule ^foo/$ /foo.php [L,QSA]

# External redirect for Foo
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+foo\.php [NC]
RewriteRule ^ /foo/? [R=301,L] 
```

我缺少什么来完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:50:52.220

```
# Setup conditions for internal rewrite of Foo
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# Rewrite for TDS
RewriteRule ^foo mypage.com/foo.php [L,QSA] 
```

试试这个..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T19:52:40.873

如果您使用 Apache，请查看 error.log 文件，它应该为您提供一些有用的信息。

如果您使用的是 Windows Server，我确信有一个类似的日志文件可供查看。

# google-maps-api-3 - 为什么我的集群没有触发 MarkerClustererPlus.js 的 mouseover 和 mouseout 事件？

> ID：14589958
> 
> 赞同：2
> 
> 时间：2013-01-29T18:43:33.087
> 
> 标签：google-maps-api-3, google-maps-markers, mouseover, mouseout, markerclusterer

根据[MarkerClusterPlus 文档](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/docs/reference.html)，不会为 MarkerCluster 类触发`mouseover`and事件。我什至尝试在事件中填充它，因为我注意到你需要等待这个，然后再对集群进行任何其他操作，但没有运气。`mouseout``clusteringend`

```
var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 10,
    center: new google.maps.LatLng(arrLocLatLng[0], arrLocLatLng[1]),
    mapTypeId: google.maps.MapTypeId.ROADMAP
});

var arrMarkers = [
    new google.maps.Marker({
        position: new google.maps.LatLng(myLat1, myLng1)
    }),
    new google.maps.Marker({
        position: new google.maps.LatLng(myLat2, myLng2)
    })
];

var mcOptions = {gridSize: 50, maxZoom: 15};
var mc = new MarkerClusterer(map, arrMarkers, mcOptions);

// need to wait for clusteringend, otherwise clusters may not be in DOM
google.maps.event.addListener(mc, 'clusteringend', function () {

    var arrClusters = mc.getClusters(); // will just be one

    // THIS IS NOT FIRING
    // Event name: mouseout
    // Event args: c:Cluster
    // Event Desc: This event is fired when the mouse moves out of a cluster marker.
    google.maps.event.addListener(arrClusters[0], 'mouseover', function ()
    {
        alert('mouseover event triggered on this particular cluster);
    });

    // ALSO NOT FIRING
    // Event name: mouseover
    // Event args: c:Cluster
    // Event Desc: This event is fired when the mouse moves over a cluster marker.
    google.maps.event.addListener(arrClusters[0], 'mouseout', function ()
    {
        alert('mouseout event triggered on this particular cluster);
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T18:51:51.197

找到了。截至 2013 年 1 月 29 日，markerclusterer.js 文件版本 2.0.15 中有一个错误。

在 MarkerClusterer.js 文件（非打包版本）中，更改以下内容：

```
google.maps.event.addDomListener(this.div_, "mouseover", function () {
    var mc = cClusterIcon.cluster_.getMarkerClusterer();
    /**
     * This event is fired when the mouse moves over a cluster marker.
     * @name MarkerClusterer#mouseover
     * @param {Cluster} c The cluster that the mouse moved over.
     * @event
     */
    google.maps.event.trigger(mc, "mouseover", cClusterIcon.cluster_);
});

google.maps.event.addDomListener(this.div_, "mouseout", function () {
    var mc = cClusterIcon.cluster_.getMarkerClusterer();
    /**
     * This event is fired when the mouse moves out of a cluster marker.
     * @name MarkerClusterer#mouseout
     * @param {Cluster} c The cluster that the mouse moved out of.
     * @event
     */
    google.maps.event.trigger(mc, "mouseout", cClusterIcon.cluster_);
}); 
```

};

对此：

```
google.maps.event.addDomListener(this.div_, "mouseover", function () {
    var c = cClusterIcon.cluster_;
    /**
     * This event is fired when the mouse moves over a cluster marker.
     * @name MarkerClusterer#mouseover
     * @param {Cluster} c The cluster that the mouse moved over.
     * @event
     */
    google.maps.event.trigger(c, "mouseover", cClusterIcon.cluster_);
});

google.maps.event.addDomListener(this.div_, "mouseout", function () {
    var c = cClusterIcon.cluster_;
    /**
     * This event is fired when the mouse moves out of a cluster marker.
     * @name MarkerClusterer#mouseout
     * @param {Cluster} c The cluster that the mouse moved out of.
     * @event
     */
    google.maps.event.trigger(c, "mouseout", cClusterIcon.cluster_);
}); 
```

...它会工作。

# android - 如何在android语音识别中同时使用一种以上的语言

> ID：14589960
> 
> 赞同：4
> 
> 时间：2013-01-29T18:43:42.593
> 
> 标签：android, android-intent, speech-recognition, speech-to-text

我们所知道的，许多语言都包含来自其他语言的几个单词。在使用 android 语音识别 (Androdi4.1) 开发 android 应用程序时，我们需要该应用程序同时（或异步）处理两种语言（EN 和 TR）的语音输入，并为我们带来两种结果。

土耳其语发音的英文单词“Burger”是“Börgır”。如果我们在英语中使用 android 语音识别，应用程序将 Burger 理解为 Burger (on text)。如果我们在土耳其语中使用 android 语音识别，应用程序将 Burger 理解为 Börgır(on text) 这是因为土耳其语被写成口语。

例如：

带有土耳其语选项的语音识别结果：**Börgır** yemek istiyorum

带有英语选项的语音识别结果：**Burger** xxxxx yyyyyyyyy

预期结果是（综合结果）：Burger yemek istiyorum

那么你知道如何同时处理两种语言吗，用android语音识别来收集两种结果，然后我们将它们结合起来以获得最好的结果。

以下代码用于在应用程序中实现 android 语音识别：

```
Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);

// Specify the calling package to identify your application

intent.putExtra(RecognizerIntent.EXTRA_CALLING_PACKAGE, getClass().getPackage().getName());

intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE, "tr"); --- or eng-us 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T11:35:57.663

使用当前的 Android API 无法做到这一点。

您可以尝试同时运行两个[SpeechRecognizer](http://developer.android.com/reference/android/speech/SpeechRecognizer.html)实例（一个带有土耳其语`EXTRA_LANGUAGE`，另一个带有英语）。这可能不起作用，因为不同的服务不能同时使用麦克风。

您可以尝试自己实现记录部分，然后将生成的字节数组推送到两个不同的识别器。但是没有API。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-21T11:56:19.090

我是这样解决的：

> ```
>  language = "tr-TR"; 
> ```

```
 Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE, language);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_PREFERENCE, language);
    intent.putExtra(RecognizerIntent.EXTRA_SUPPORTED_LANGUAGES, language);
    intent.putExtra(RecognizerIntent.EXTRA_ONLY_RETURN_LANGUAGE_PREFERENCE, language);
    intent.putExtra(RecognizerIntent.EXTRA_CALLING_PACKAGE, language);
    intent.putExtra(RecognizerIntent.EXTRA_RESULTS, language);
    startActivityForResult(intent, REQUEST_CODE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T18:47:56.563

我建议您为语音识别器选择一种语言，例如英语。然后当你说你的另一种语言时，看看语音识别器会出现什么。您也许可以解释对此的英语认可。

例如，如果您想对英语识别器说西班牙语，而用户用西班牙语说“si”，您可能会注意到识别器将其识别为“see”

# c# - 如何设置默认组合框

> ID：14589964
> 
> 赞同：17
> 
> 时间：2013-01-29T18:44:05.967
> 
> 标签：c#, winforms, combobox, populate

所以我一直在寻找为我的组合框设置一个默认值。我发现了一些东西，但它们似乎都不起作用。

实际上，如果我创建一个简单的组合框并使用`comboBox1.SelectedIndex = comboBox1.Items.IndexOf("something")`它就可以工作，但是一旦我动态生成组合框的内容，我就无法再让它工作了。

这就是我填充组合框的方式（位于类的构造函数中）；

```
 string command = "SELECT category_id, name FROM CATEGORY ORDER BY name";
        List<string[]> list = database.Select(command, false);

        cbxCategory.Items.Clear();

        foreach (string[] result in list)
        {
            cbxCategory.Items.Add(new ComboBoxItem(result[1], result[0]));
        } 
```

我似乎无法让它设置一个默认值，就像如果我放在`cbxCategory.SelectedIndex = cbxCategory.Items.IndexOf("New")`上面的代码下面，它就不起作用。

顺便说一句，WinForms。

先感谢您。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-29T18:46:53.880

`cbxCategory.SelectedIndex` 应该设置为一个整数 from `0`to `Items.Count-1`like

```
cbxCategory.SelectedIndex  = 2; 
```

您的

```
 cbxCategory.SelectedIndex = cbxCategory.Items.IndexOf("New") 
```

只要没有 ComboboxItem 混淆字符串（“New”），就应该返回 -1；

另一个解决方案虽然我不太喜欢它

```
foreach(object obj in cbxCategory.Items){ 
    String[2] objArray = (String[])obj ;
    if(objArray[1] == "New"){
       cbxCategory.SelectedItem = obj;
       break; 
    }
} 
```

也许这还需要对您的代码进行以下转换

```
 foreach (string[] result in list)
    {
      cbxCategory.Items.Add(result);
    } 
```

我还没有测试过代码，我不确定转换为 String[2] 但类似的东西应该可以工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:56:23.607

看起来您正在 cbxCategory.Items 集合中搜索字符串，但它包含 ComboBoxItem 类型的项目。因此搜索将返回 -1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T19:10:05.917

您可以使用 LINQ。

```
//string command = "SELECT category_id, name FROM CATEGORY ORDER BY name";
//List<string[]> list = database.Select(command, false);
// sample data...
List<string[]> list = new List<string[]> { new string[] { "aaa", "bbb" }, new string[] { "ccc", "ddd" } };

cbxCategory.Items.Clear();

foreach (string[] result in list)
{
    cbxCategory.Items.Add(new ComboBoxItem(result[1], result[0]));
}

ComboBoxItem tmp = cbxCategory.Items.OfType<ComboBoxItem>().Where(x => x.ResultFirst == "bbb").FirstOrDefault();
if (tmp != null)
    cbxCategory.SelectedIndex = cbxCategory.Items.IndexOf(tmp); 
```

`ComboBoxItem`班级：

```
class ComboBoxItem
{
    public string ResultFirst { get; set; }
    public string ResultSecond { get; set; }

    public ComboBoxItem(string first, string second)
    {
        ResultFirst = first;
        ResultSecond = second;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T23:04:16.327

这是我的简单解决方案

```
 var list = comboBox1.Items.Cast<string>().ToList();
        cbxCategory.SelectedIndex = list.FindIndex(c => c.StartsWith("test")); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-09T09:55:50.393

我的解决方案：

```
int? defaultID = null;
foreach (DataRow dr in dataSource.Tables["DataTableName"].Rows)
{
     if ((dr["Name"] != DBNull.Value) && ((string)dr["Name"] == "Default Name"))
     {
          defaultID = (int)dr["ID"];
     }
}
if (defaultID != null) comboBox.SelectedValue = defaultID; 
```

# jquery - 从 JSON 格式生成带有冷融合的 excel 或 html

> ID：14589965
> 
> 赞同：1
> 
> 时间：2013-01-29T18:44:08.993
> 
> 标签：jquery, json, excel, coldfusion, coldfusion-8

我需要使用 JSON 格式的数据生成报告。这是接收参数并显示带有数据的 html 表或 excel 的操作文件。我在解析 JSON 数据时需要帮助，我正在进入所需的格式（html 或 excel）。我知道如何使用 excel 格式，我只需要解析 JSON 数据并输出它的帮助。

```
<cfajaxproxy cfc="components.acct.accttrx">
<script src="../jQuery/js/jquery-1.7.2.min.js"></script>

<cfparam name="prD" default="0_0">
<cfparam name="sM" default="1">
<cfparam name="sY" default="2013">
<cfparam name="status" default="0">
<cfparam name="FORM.fileformat" default="html">

<script type="text/javascript">
  jQuery(document).ready(function(){        
    var myURL = '../components/acct/accttrx.cfc';

  function populateReport(){            
  $.ajax({
  url: myURL + "?method=GetTranactions",
  type: 'POST',
  data: { 
    prID: '<cfoutput>#prD#</cfoutput>',
    mn: '<cfoutput>#sM#</cfoutput>',
    yr: '<cfoutput>#sY#</cfoutput>',
    st: '<cfoutput>#status#</cfoutput>',
    ea_adm:'1',
    slist:'',
    lang: '1'
  },
  dataType: "json",
  success: 
    function(data){
    $.each(data, function(index, item) {
      //(item.description,item.balance,item.accttrx_status);
      // I need help from this point to pass 
      // data to cfml part of my code
      });
    },
  error: 
    function(){
      alert("An error has occurred while fetching records");
    }
});
populateReport();
});
</script>
</HEAD>
<body>
<cfif FORM.fileformat Eq 'excel'>
    <cfset VARIABLES.vcFilename = "thisreport_" & DateFormat(Now(), "yyyymmdd") & "-" &  TimeFormat(Now(), "HHmmss") & ".xls">
    <cfsetting enablecfoutputonly="Yes">
    <cfcontent type="application/vnd.ms-excel">
    <cfheader name="Content-Disposition" value="inline;filename=""#VARIABLES.vcFilename#""">

     <cfoutput>
      <!--- here display data from JSON object --->
     </cfoutput>
  <cfsetting enablecfoutputonly="No">
  <cfelse>
    <div id="reportcontents" />  <!--- display row html --->
</cfif> 
```

这是来自响应的数据：

> {"ROWS":[ { "balance":-642.04000, "description":"ABC Company", "ee_name":"Jon, Doe", "plan_id":0, "debit":25000.22000, "accttrx_year":2013 ，“sponsor_id”：5，“division_id”：0，“accttrx_month”：1，“credit”：26591.25000，“trx_employee_id”：1，“cheque_amt”：25000.00000，“cheque_no”：“”，“accttrx_status”：“B ", "accttrx_id":15 }, { "balance":-642.04000, "description":"ABC 公司", "ee_name":"James, Done", "plan_id":0, "debit":32233.07000, "accttrx_year “：2013，”赞助商id”：5，“部门id”：0，“accttrx_month”：1，“信用”：30000.00000，“trx_employee_id”：1，“cheque_amt”：32233.07000，“cheque_no”：“”，“accttrx_status”：“P”， “accttrx_id”：14 } ]，“PAGE”：1，“记录”：2，“TOTAL”：1.0 }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T19:01:18.850

如果您使用的是 ColdFusion 8 或更高版本，则可以使用 DeserializeJSON() 将 JSON 转换为结构。然后，您可以使用 cfloop 循环此结构并将结构的内容转换为查询（在循环内使用 QueryNew()、QueryAddRow() 和 QuerySetCell()）。从那里，如果您使用 ColdFusion 9，您可以使用 cfspreadsheet 标记将该查询转换为 Excel 文件（或 csv 文件），或者您可以使用任何版本的 ColdFusion 输出纯旧 HTML 并设置标题以欺骗浏览器认为它是一个Excel文件，如下所示：

```
<cfcontent type="application/msexcel"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T00:52:02.370

1.  不要使用 AJAX。只需创建一个 JS 函数即可将报告参数推送到您的处理代码。有关示例，请参见[这篇文章。](https://stackoverflow.com/questions/4518702/how-to-download-a-file-on-clicking-the-name-of-file-using-php)本质上：

    ```
     window.location="process.cfm?param1=&param2="; 
    ```

2.  使用 '../components/acct/accttrx.cfc' 文件中的 deserializeJSON() 将发布的 JSON 解析为 CF 结构。

3.  使用以下CF让浏览器识别文件下载：

    ```
     <cfheader name="Content-Disposition" value="attachment;filename=XXXX">
     <cfcontent type="application/vnd.ms-excel" reset="false"> 
    ```

# highstock - Highstock addSeries 到指定的 Y 轴

> ID：14589966
> 
> 赞同：0
> 
> 时间：2013-01-29T18:44:09.130
> 
> 标签：highstock

奇怪的是，似乎没有一种方法可以使用 chart.addSeries() 方法将系列添加到哪个 Y 轴。这里没有关于目标轴的内容( [http://api.highcharts.com/highstock#Chart.addSeries%28%29 )。](http://api.highcharts.com/highstock#Chart.addSeries%28%29)这导致注定要针对相反轴绘制的线被错误地绘制在左侧；我认为这是该方法的基本先决条件。

有没有人见过任何可以解决这个问题的黑客或插件，或者知道在源代码中去哪里解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T10:50:45.827

您可以在 Highcharts 中定义系列时添加系列，因此您可以使用 yAxis 索引。看看例子[http://jsfiddle.net/68Fp4/1/](http://jsfiddle.net/68Fp4/1/)

```
$('#button').click(function() {
    chart.addSeries({
        name: 'ADBE',
        data: ADBE,
        yAxis:1
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:28:38.047

这就是该属性用于在您作为参数[`yAxis`](http://api.highcharts.com/highstock#series.yAxis)传入的系列配置对象中指定的内容。`addSeries``options`

# windows - 如何让 gcc 接受路径中的空格

> ID：14589971
> 
> 赞同：6
> 
> 时间：2013-01-29T18:44:23.443
> 
> 标签：windows, gcc

我正在尝试在 Windows 上使用 gcc 构建 qt5，但遇到了以下问题：
我有到 directx sdk 的路径：C:\Program Files (x86)\Microsoft DirectX SDK (June 2010)，而这个 g++ 无法处理它， 我越来越：
![在此处输入图像描述](../Images/21244a678879d9bc106908e8ccc5e5fe.png)

如何克服这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T18:45:18.903

这不是 gcc 的错，而是您的 shell/终端/构建器程序将所有这些作为单独的参数传递。`""`在命令行上添加一些围绕它。`-L`对于您显示的命令行上该标志的早期副本，它已经是正确的。

# .net - .NET 上的证书固定

> ID：14589973
> 
> 赞同：5
> 
> 时间：2013-01-29T18:44:26.883
> 
> 标签：.net, ssl, application-security

我想限制我的 .NET 应用程序只接受已知证书。那么如何在 .NET 上强制执行证书固定？最佳做法是什么？只验证指纹是否可以？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-23T03:44:35.677

根据[OWASP ，您可以使用 .NET 的](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning)[ServicePointManager](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.aspx)类实现证书和公钥固定

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-02T07:46:13.917

[https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#.Net](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#.Net)

这个 URL 已经有一个很好的例子。

```
// Encoded RSAPublicKey
private static String PUB_KEY = "30818902818100C4A06B7B52F8D17DC1CCB47362" +
    "C64AB799AAE19E245A7559E9CEEC7D8AA4DF07CB0B21FDFD763C63A313A668FE9D764E" +
    "D913C51A676788DB62AF624F422C2F112C1316922AA5D37823CD9F43D1FC54513D14B2" +
    "9E36991F08A042C42EAAEEE5FE8E2CB10167174A359CEBF6FACC2C9CA933AD403137EE" +
    "2C3F4CBED9460129C72B0203010001";

public static void Main(string[] args)
{
  ServicePointManager.ServerCertificateValidationCallback = PinPublicKey;
  WebRequest wr = WebRequest.Create("https://encrypted.google.com/");
  wr.GetResponse();
}

public static bool PinPublicKey(object sender, X509Certificate certificate, X509Chain chain,
                                SslPolicyErrors sslPolicyErrors)
{
  if (null == certificate)
    return false;

  String pk = certificate.GetPublicKeyString();
  if (pk.Equals(PUB_KEY))
    return true;

  // Bad dog
  return false;
} 
```

# java - HashMap获取“相等”但哈希不同的对象的值？

> ID：14589976
> 
> 赞同：7
> 
> 时间：2013-01-29T18:44:38.397
> 
> 标签：java

我有一个`HashMap<Point, T>`数据结构，其中包含映射到类的其他实例的几个点`T`。当我的类像这样实例化时，这个映射被赋予了一些默认值：

```
T t1 = new T();
T t2 = new T();
Point p1 = new Point(0, 1);
Point p2 = new Point(0, 2);

HashMap<Point, T> map = new HashMap<Point, T>();
static {
    map.put(p1, t1);
    map.put(p2, t2);
} 
```

在我的代码中，我将接收包含一个`x`和一个`y`值的事件。当我收到其中一个事件时，我正在尝试使用传递的 and 创建一个新对象`Point`，然后从映射中检索值，如下所示：`x``y`

```
Point p = new Point(event.getX(), event.getY); // Assume (x, y) = (0, 1) (p1)
if(p.equals(p1)    
    T t = map.get(p); 
```

虽然在这种情况下`p`等于（使用( x `p1`, y) = (0, 1) 我`null`从`map`.以防止碰撞。`hashCode()``Point (Point2D)``equals`

我的问题是：*如何从`map`使用新实例中检索值`p`？是否有另一种适合该用例的数据结构？*

我想我可以使用`toString()`或其他一些映射，`HashMap<String, T>`或者我可能会扩展`Point`类和`Override`方法`hashCode()`以适应我的目的。不过，如果有一种更简洁的方式，我很想听听这些方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:54:00.403

根据[Java 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#hashCode%28%29)，

> 如果根据方法两个对象相等`equals(Object)`，则对两个对象中的每一个调用该`hashCode`方法必须产生相同的整数结果。

在您的情况下，两个`Point`对象似乎相等（根据`equals`方法），但它们的哈希码不同。这意味着您需要修复您的`equals`和`hashCode`功能以彼此保持一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T18:59:53.933

您可以尝试编写一个自包含的示例，如下所示，我们可以运行

```
Map<Point, String> map = new LinkedHashMap<>();
for (int i = 0; i < 10; i++)
    for (int j = 0; j < 10; j++)
        map.put(new Point(i, j), "(" + i + "," + j + ")");

// test the map
int misMatches = 0;
for (int i = 0; i < 10; i++)
    for (int j = 0; j < 10; j++) {
        String expected = "(" + i + "," + j + ")";
        String text = map.get(new Point(i, j));
        if (!expected.equals(text)) {
            System.err.println("Expected <" + expected + "> but got <" + text + ">");
            misMatches++;
        }
    }
System.out.println(misMatches + " mis-matches found."); 
```

印刷

```
0 mis-matches found. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-29T19:15:27.033

我认为 Point 类的 equals() 或 hashcode() 没有任何问题。试试这个：

```
public static void main(String args[]) {

        Map<Point, Integer> map = new HashMap<Point, Integer>();
        Point p1 = new Point(0, 1);
        Point p2 = new Point(0, 2);
        map.put(p1,1);
        map.put(p2,2);
        Point p = new Point(0, 1);
        if(p.equals(p1)){
            System.out.println(map.get(p));
        }
        else{
            System.out.println("not");
        }

    } 
```

它正在产生正确的结果。

我猜你没有正确初始化地图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-29T18:50:18.780

hashCode() 应该使用与 equals() 相同的属性以保持一致。

另请参阅：[在 Java 中覆盖 equals 和 hashCode 时应考虑哪些问题？](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java)

# vba - 使用 VBA 从分布中生成随机数到内存

> ID：14589978
> 
> 赞同：4
> 
> 时间：2013-01-29T18:44:54.767
> 
> 标签：vba, excel, random, excel-2007, data-analysis

我想从 VBA (Excel 2007) 中的选定分布生成随机数。我目前正在使用带有以下代码的分析工具包：

```
 Application.Run "ATPVBAEN.XLAM!Random", "", A, B, C, D, E, F 
```

在哪里

```
A = how many variables that are to be randomly generated 
B = number of random numbers generated per variable 
C = number corresponding to a distribution
         1= Uniform
         2= Normal
         3= Bernoulli
         4= Binomial
         5= Poisson
         6= Patterned
         7= Discrete 
D = random number seed
E = parameter of distribution (mu, lambda, etc.) depends on choice for C
(F) = additional parameter of distribution (sigma, etc.) depends on choice for C 
```

但是我想让随机数生成到一个数组中，而不是生成到一张纸上。我知道在哪里`""`指定随机数应该打印到哪里，但我不知道将随机数分配给数组或其他形式的内存存储而不是工作表的语法。

我已尝试遵循此[Analysis Toolpak 站点上](http://www.cpearson.com/excel/atp.htm)讨论的语法，但没有成功。

我意识到 VBA 不是生成随机数的理想场所，但我需要在 VBA 中执行此操作。任何帮助深表感谢！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T20:14:11.780

使用内置功能是关键。除了泊松之外，这些函数中的每一个都有相应的版本。在我提出的解决方案中，我使用 Knuth 提出的算法从泊松分布中生成一个随机数。

对于离散或模式，您显然必须编写自定义算法。

关于种子，您可以在填充数组之前放置一个*Randomize [seed] 。*

```
Function RandomNumber(distribution As Integer, Optional param1 = 0, Optional param2 = 0)

    Select Case distribution
    Case 1 'Uniform
        RandomNumber = Rnd()
    Case 2 'Normal
        RandomNumber = Application.WorksheetFunction.NormInv(Rnd(), param1, param2)
    Case 3 'Bernoulli
        RandomNumber = IIf(Rnd() > param1, 1, 0)
    Case 4 'Binomial
        RandomNumber = Application.WorksheetFunction.Binom_Inv(param1, param2, Rnd())
    Case 5 'Poisson
        RandomNumber = RandomPoisson(param1)
    Case 6 'Patterned
        RandomNumber = 0
    Case 7 'Discrete
        RandomNumber = 0
    End Select

End Function

Function RandomPoisson(ByVal lambda As Integer)   'Algorithm by Knuth

    l = Exp(-lambda)
    k = 0
    p = 1

    Do
         k = k + 1
         p = p * Rnd()
    Loop While p > l

    RandomPoisson = k - 1

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:32:27.260

为什么不使用内置函数？

1.  制服 =`rnd`
2.  正常 =`WorksheetFunction.NormInv`
3.  伯努利 =`iif(rnd()<p,0,1)`
4.  二项式 =`WorksheetFunction.Binomdist`
5.  泊松 =`WorksheetFunction.poisson`
6.  图案=`for ... next`
7.  离散 =

-

```
select case rnd()
    case <0.1
       'choice 1
    case 0.1 to 0.4
       'choice 2
    case >0.4
       'choice 3
end select 
```

# javascript - 为什么我不能用 jquery 访问 ajax 拉取的内容

> ID：14589980
> 
> 赞同：1
> 
> 时间：2013-01-29T18:45:02.680
> 
> 标签：javascript, jquery, ajax, forms, wordpress

> **可能重复：**
> [在 ajax/jquery 调用的成功函数之外使用变量](https://stackoverflow.com/questions/5935968/use-variable-outside-the-success-function-from-an-ajax-jquery-call)

我有这段代码，但我不明白为什么 html 元素的访问只能在 ajax 成功函数内部工作。无论哪种方式，表单都是从 ajax 拉入的，但只有当我将其元素的所有选择放在 ajax 函数中时，我才能访问它。

`console.log('submit clicked');`不会以这种**方式**触发，但在“ajax 成功”内部，我认为使用 ajax 引入的所有内容都是 DOM 的一部分？

```
jQuery(document).ready(function($) {

console.log('ready');

$.ajax({
    type: 'GET',
    url: 'admin-ajax.php',
    data: { action: 'get_arve_form' },
    success: function(response){
        // var table = $(response).find('table');
        $(response).appendTo('body').hide();
        console.log('response');

                    [ if i move the code below this ajax function in here its workign fine why not outside of it?]

    }
});

// handles the click event of the submit button
$('#mygallery-submit').click(function(){
    console.log('submit clicked');
                [...]
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T18:52:06.120

Ajax 是异步的，因此您的元素在 ajax 调用完成之前不存在。

话虽如此，有两种方法可以解决它：

1）将您的代码移动到成功处理程序中

2) 使用事件委托将您的事件处理程序绑定到所有当前*和未来的*元素。

#2 的一个例子：

```
$(document).on('click', '#mygallery-submit', function(){
    console.log('submit clicked');
}); 
```

查看[jQFundamentals](http://jqfundamentals.com/chapter/events)以了解有关事件委托的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:54:20.210

这就是ajax的工作原理。加载外部页面时，您*只能*在成功处理程序上使用它。如果您希望它在其他地方可用，您必须以某种方式保存它，就像您正在做的那样。

但是，.click 函数在 ajax 调用返回成功之前执行。当您选择 $('#mygallery-submit') 时，它很可能是空的（您可能通过 ajax 加载它）。因此，如果您想在文档就绪时声明 click 函数，而不是在加载 ajax 页面时，您必须使用 .on 函数：

```
$('body').on('click', '#mygallery-submit', function() {
    console.log('submit clicked');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T18:52:18.187

因为`.click()`不是委托处理程序。如果您尝试将事件绑定到的元素在执行时不存在，则该事件将不会被绑定。试试`.on()`吧。

```
$('body').on('click', '#mygallery-submit', function() {
    // etc.
}); 
```

# ruby-on-rails-3 - Rails 3：压缩后无法解压缩zip

> ID：14589988
> 
> 赞同：1
> 
> 时间：2013-01-29T18:45:24.473
> 
> 标签：ruby-on-rails-3

我想在 Ruby on Rails 中压缩一些文件并将 zip 文件保存在 tmp 文件夹中。我有一个 Document 模型，它有一个带有关联上传者的名称字段。我还使用 Carrierwave 将文件上传到 Amazon S3。我有以下代码：

```
class Document < ActiveRecord::Base

  mount_uploader :name, DocumentUploader
  ...

end

def create_zip  
  documents = Document.all
  folder = "#{Rails.root}/tmp"
  tmp_filename = "#{folder}/export.zip"

  zip_path = tmp_filename
  Zip::ZipFile::open(zip_path, true) do |zipfile|
    documents.each do |photo|
      zipfile.get_output_stream(document.name.identifier) do |io|
        io.write document.name.file.read
      end
    end
  end

end 
```

这会在我的 tmp 文件夹中创建一个 export.zip 文件，但是当我尝试打开它时，存档管理器 (Mac OS X) 开始取消存档它，但一直在这样做而没有完成。我相信我的代码中缺少一些东西。zip 文件的大小对我来说确实有意义，但我遇到了这个问题。有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:34:19.887

实际上，我发现我可以使用其他程序（zipeg）打开 zip 文件。但是，只有文档数组中的最后一个文件在压缩文件中。我相信我一直在覆盖以前的文件，因为在所有情况下，唯一剩下的文件都被称为相同的（导出，作为 zip 本身的名称）。

下面的代码对我有用：

```
def create_zip
  documents = Document.all

  folder = "#{Rails.root}/tmp"
  tmp_filename = "#{folder}/export.zip"
  zip_path = tmp_filename

  Zip::ZipOutputStream.open(zip_path) do |zos|
    documents.each do |document|
      path = document.name_identifier
      zos.put_next_entry(path)
      zos.write photo.name.file.read
    end
  end
end 
```

# android - 从另一个活动中删除计时器

> ID：14589991
> 
> 赞同：-1
> 
> 时间：2013-01-29T18:45:29.613
> 
> 标签：android, timer, timertask

我有一个登录表单，我使用 sheredpreferences 来存储登录信息，如果用户没有按记住我按钮，我会在 5 分钟内保存用户名，然后删除用户名。如果登录后，假设 3 分钟过去了，我关闭了应用程序，现在我不需要执行计时器，我如何从正在运行的活动中关闭计时器，在这种情况下是 lertags.java？

这是代码...

登录.java

```
 CheckBox checkBox = (CheckBox) findViewById(R.id.silent_switch);
        if(checkBox.isChecked())
        {

            //save data username and password

            SharedPreferences.Editor prefEditor = gameSettings.edit();  
            prefEditor.putString("UserName",txtperson.getText().toString());  
            prefEditor.putString("Password", txtpass.getText().toString());  
            prefEditor.commit();

        }
        else

        {
            //create timer for 10 seconds,after that delete the user 

                TimerTask updateProfile = new CustomTimerTask(Login.this);
                timer.schedule(updateProfile, 10000);

        }
            //save the value user and the poosition

            SharedPreferences.Editor prefEditor = gameSettings.edit();  
            prefEditor.putString("User",user);  
            prefEditor.putString("Posto", posto); 

            prefEditor.commit();  

      //mensagemexibir("Login", "Welcome: "+user);

            Intent i = new Intent(Login.this, LerTags.class);

             startActivityForResult(i, 2);
              setResult(2);
             finish(); 
```

CustomTimertask.java

```
public class CustomTimerTask extends TimerTask {

private Context context;
private Handler mHandler = new Handler();

// Write Custom Constructor to pass Context
public CustomTimerTask(Context con) {
    this.context = con;
}

@Override
public void run() {
    // TODO Auto-generated method stub

    // your code starts here.
    // I have used Thread and Handler as we can not show Toast without starting new thread when we are inside a thread.
    // As TimePicker has run() thread running., So We must show Toast through Handler.post in a new Thread. Thats how it works in Android..
    new Thread(new Runnable() {
        public void run() {

            mHandler.post(new Runnable() {
                public void run() {
                 Toast.makeText( context, "10 seconds pass delete the user", Toast.LENGTH_LONG).show();
SharedPreferences.Editor prefEditor = gameSettings.edit();  
            prefEditor.putString("User","");  

            prefEditor.commit();  
                                        }

            });
        }
    }).start();

}

public void startact() {
    // TODO Auto-generated method stub

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:48:47.203

将任务存储在类的成员变量中，并在您不再希望它发生时调用它的取消（例如在 onPause 或 onStop 中，具体取决于您想要做什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:04:52.190

它非常简单。当您使用 CustomTimerTask 时，只需在您的应用程序将要关闭时让我们说 onDestroy () 或应用程序的任何其他退出点，您就可以编写以下行：

```
updateProfile.cancel(); 
```

为此，您必须存储“updateProfile”变量的引用。更多详情请点击[此处](https://stackoverflow.com/questions/10311087/how-to-stop-timer-android?rq=1)或[此处](https://stackoverflow.com/questions/12795593/how-to-cancel-the-timer-and-renew-the-same-timer/14591654#14591654)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T19:18:52.020

在所有活动中维护全局变量的最佳方法是在`Application`类中维护自定义计时器变量

1）创建一个`A`扩展的类（示例）`Application`

`TimerTask updateProfile`2)在 Class 中创建实例`A`。

3) 在类中创建方法来启动和取消定时器任务`A`[Eg: `startTimer()`, `cancelTimer()`]

3) 现在任何`Activity`用户都可以访问它。

4) 从任何活动中，您都可以取消计时器 [例如：`((A)getApplicationContext()).cancelTimer()`]。

# .htaccess - htaccess mod rewrite - 假目录

> ID：14589993
> 
> 赞同：0
> 
> 时间：2013-01-29T18:45:38.443
> 
> 标签：.htaccess, mod-rewrite

我有一个这样的 URL：[http](http://www.domain.com/index.php?token=123) ://www.domain.com/index.php?token= 123 我想将 URL 重写为： http: [//www.domain.com/123](http://www.domain.com/123)或[http://www .domain.com/123/](http://www.domain.com/123/) 使用这个 htaccess 我可以访问[http://www.domain.com/123/](http://www.domain.com/123/)但是我的 css 没有加载。

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}  -d

RewriteRule  ^.*$  -  [L]

RewriteRule ^([^/]+)/$  index.php?token=$1 [L] 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:50:21.290

如果我猜对了，那么您将 relativ 链接到您的 css 文件是您的问题。所以你需要更正你的css文件的路径。