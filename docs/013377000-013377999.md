# StackOverflow 问答 13377000-13377999

# javascript - 获取显示窗口的最后一个表 tr 和 div

> ID：13377000
> 
> 赞同：1
> 
> 时间：2012-11-14T10:25:24.920
> 
> 标签：javascript, jquery

我有两个 HTML 文件。

第一的：

```
<table>
    <tr>...</tr>
    <tr>...</tr>
    <tr>...</tr>
    <tr>...</tr>
    <tr>...</tr>
    <tr>...</tr>
    ...
</table> 
```

第二：

```
<div=container>
    <div>...</div>
    <div>...</div>
    <div>...</div>
    <div>...</div>
    <div>...</div>
    ...
</div> 
```

`table`并且`container`比窗口有更多的垂直尺寸。如何获取窗口中显示的当前最后一个 tr(div) 内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T10:33:31.867

[这里](http://upshots.org/javascript/jquery-test-if-element-is-in-viewport-visible-on-screen)有一个简单的 jQuery 插件，用于检查对象是否在屏幕上可见。您可以以相反的顺序循环遍历每个`div`或`tr`元素，使用该代码检查它是否在当前窗口内，直到找到在屏幕上可见*的那个。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:31:22.157

使用 jquery，您可以使用 css3 选择器，因此以下应该可以工作：

```
$("table > tr:last-of-type") 
```

对于 div 也是如此：

```
$("div#container > div:last-of-type") 
```

这将获得选择器中指定的第一个元素中的最后一个类型元素。如果您真的想要首屏上的内容，这不是解决方案

# php - 定期阅读浏览器会话

> ID：13377001
> 
> 赞同：0
> 
> 时间：2012-11-14T10:25:30.797
> 
> 标签：php

我想通过 php 脚本每 15 分钟清理一次会话变量。当来自网络浏览器的朗姆酒时，PHP 脚本工作正常。我需要自动化的过程。请提出解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:28:47.497

如果您需要某个脚本**每 15 分钟**运行一次，则创建一个`cronjob`, 每 15 分钟执行一次您的脚本。

这是一个小教程如何做到这一点：[http ://www.thesitewizard.com/general/set-cron-job.shtml](http://www.thesitewizard.com/general/set-cron-job.shtml)

# php - 防止具有“子菜单”类的 ul 元素成为 Wordpress 菜单中列表项的子元素

> ID：13377002
> 
> 赞同：1
> 
> 时间：2012-11-14T10:25:31.683
> 
> 标签：php, javascript, jquery, html, wordpress

我有一个使用 wordpress 模板标签生成的菜单`<?php wp_nav_menu(); ?>`。

生成的代码是：

```
<div class="menu">
<ul>
<li class="current_page_item">Current Page</li>
    <li class="page_item page-item-58">Menu Item #1
        <ul class='sub-menu'>
            <li class="page_item page-item-62">Child Item #1</li>
            <li class="page_item page-item-60">Child Item #2</li>
        </ul><!--END page-item-58 -->
    </li>
</ul>
</div> 
```

我的问题是：你如何防止`<ul class='sub-menu'>`成为孩子`<li class="page_item page-item-58">`？

我希望生成的代码如下所示：

```
<div class="menu">
<ul>
<li class="current_page_item">Current Page</li>
    <li class="page_item page-item-58">Menu Item #1</li><!--END page-item-58 -->
    <ul class='sub-menu'>
        <li class="page_item page-item-62">Child Item #1</li>
        <li class="page_item page-item-60">Child Item #2</li>
    </ul>
</ul>
</div> 
```

我似乎找不到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:31:06.047

这不是您应该努力实现的目标。ul 元素是另一个 ul 元素的子元素是非法的：http: [//www.whatwg.org/specs/web-apps/current-work/multipage/grouping-content.html#the-ul-element](http://www.whatwg.org/specs/web-apps/current-work/multipage/grouping-content.html#the-ul-element)

另请参阅 w3 规范：[http ://www.w3.org/TR/html401/struct/lists.html#h-10.2](http://www.w3.org/TR/html401/struct/lists.html#h-10.2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:01:46.873

所以我看到你想要那种结构，但是用 div 而不是 ul 和 li。你可以试试[这里](http://pastebin.com/8NBqruT7)找到的代码，看看它是否适合你？

这是一个扩展的类，它`Walker_Nav_Menu`的输出是：

```
<div class="menu-main-menu-container">
    <div id="menu-main-menu" class="menu">
        <div id="menu-item-4" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4"><a href="#">Sample Page</a></div>
        <div class="sub-menu">
            <div id="menu-item-5" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5"><a href="#">Sub-menu</a>
                <div class="sub-menu">
                    <div id="menu-item-6" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6"><a href="#">Sub-sub-menu</a></div>
                </div>
            </div>
            <div id="menu-item-7" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7"><a href="#">Another sub-menu</a></div>
        </div>
    </div>
</div> 
```

它将做的是，它不会将第一级子菜单包装在其所属的父级中，但会为更深的子菜单这样做。这是菜单的结构：

```
 - Sample Page
   - Sub-menu
     - Sub-sub-menu
   - Another sub-menu 
```

我不确定这是否正是你所追求的，但也许你可以和步行者一起玩，看看你是否能实现你想要的。

# ruby-on-rails-3 - 在 Rails 应用程序中添加管理员角色

> ID：13377009
> 
> 赞同：0
> 
> 时间：2012-11-14T10:25:54.833
> 
> 标签：ruby-on-rails-3, devise, ruby-on-rails-3.2

我想知道如何使用 devise gem 添加管理员角色。我已经将它用于普通用户，但不适用于管理员角色。我已阅读此[https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role)。上面明确提到了如何在应用程序中添加管理员角色。但我有一些关于以下内容的问题：

1.  如何指定该特定用户是管理员（在我的情况下，我只想要一个私人管理员来控制应用程序中的活动）？

2.  如何使用管理员角色进行基本的 CRUD 活动（我想要用户及其内容的 CRUD 活动）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:36:41.023

我使用过 Devise、CanCan 和 Rolify 堆栈来做一些管理工作。它超出了您的需要，但好处是惊人的。[关于如何在此处](https://github.com/EppO/rolify/wiki/Tutorial)进行设置的 wiki 。

如果你想要一个管理员，首先给你的所有用户一个角色，例如“成员”，然后也给你的管理员一个角色，比如“管理员”。

然后你可以使用设计检查`current_user`，你也可以使用 Rolify 之类的东西`if @user.has_role? "admin"`

老板很漂亮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-13T15:30:06.643

目前的轨道没有办法添加，除了像 CancanCan 和 rolify 这样的宝石。按照他们文档中的步骤，还将所有其他用户的 admin_role 设置为 false 并使用 rails 控制台将所需的用户设置为 true 下面的视频非常有帮助。

[Web crunch 教程，管理员角色](https://www.youtube.com/watch?v=PmkBBRq6jQ0&t=770s)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-01T13:26:59.403

对于使用**Rails 5**、[Devise](https://github.com/plataformatec/devise)和[CanCanCan](https://github.com/CanCanCommunity/cancancan)的更新解决方案（CanCan 看起来不再受支持），请查看：

1.  [RAILS 5：具有 3 种角色类型的用户帐户 - DEVISE、RAILS_ADMIN、CANCANCAN](https://codepany.com/blog/rails-5-user-accounts-with-3-types-of-roles-devise-rails_admin-cancancan/)

这是一个值得一提的替代解决方案；它使用 Rails [Pundit](https://github.com/varvet/pundit)和*has_secure_password*，值得一提：

2.  [在 Ruby on Rails 中实现角色和权限](http://culttt.com/2016/01/20/implementing-roles-and-permissions-in-ruby-on-rails/)

使用 CanCanCan 的优势在于它将授权与用户角色分离，而许多人发现 Pundit 更易于使用侵入性更小。两者都很好。

两者都解决了您想要做的事情。

# nhibernate - 如何将继承的类集映射到 NHibernate 中的 db？

> ID：13377010
> 
> 赞同：1
> 
> 时间：2012-11-14T10:25:57.087
> 
> 标签：nhibernate, c#-4.0, nhibernate-mapping

我有一个带有多个表的继承类结构。我的班级结构如下。（这不是真正的课程。我在这里创建了模仿原件的假课程以节省空间。）

```
class Account {
    public virtual int AID { get; set; }
    public virtual string Name { get; set; }
    public virtual string Serial { get; set; }
    public virtual string Type { get; set; }

    public Account { Type = "Default"; }
}

class Human : Account {
    public virtual string FirstName { get; set; }
    public virtual string LastName { get; set; }
    // more properties..

    public Human { Type = "Human"; }
}

class Bank : Account {
    public virtual string BranchName { get; set; }
    // more properties..

    public Bank { Type = "Bank"; }
} 
```

我的 Account.hbm.xml 文件如下所示。

```
 <class name="Account">
    <id name="AID" type="Int32">
      <generator class="native" />
    </id>
    <discriminator column="Type" type="string" />
    <property name="Name" />
    <property name="Serial" />
    <property name="Type" />

    <subclass name="Human" discriminator-value="Human">
      <join table="Account">
        <key column="AID" />
        <property name="FirstName" />
        <property name="LastName" />
      </join>
    </subclass>

    <subclass name="Bank" discriminator-value="Bank">
      <join table="Account">
        <key column="AID" />
        <property name="LocationName" />
      </join>
    </subclass>    
  </class> 
```

我执行此操作，并使用正确的字段集创建表。问题是当我插入记录时。

我按以下方式进行。

```
Bank bank = new Bank();
bank.Name = "Any Name";
bank.Serial = "0001";
bank.BranchName = "Local CIty";

using (ISession session = NHibernateHelper.OpenSession())
{
    using (ITransaction transaction = session.BeginTransaction())
    {
        session.Save(bank);
        transaction.Commit();
    }
} 
```

下面是 NUnit 产生的错误。也许我做错了什么。有人可以帮我吗？

```
NHibernate.PropertyValueException : Error dehydrating property value for 
xxxx.xxxxx.Bank.Name
  ----> System.IndexOutOfRangeException : Parameter index is out of range. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:30:38.647

<join>-子句与继承无关。<subclass> 元素就足够了。此处记录了处理继承的其他方法：http: [//nhibernate.info/doc/nh/en/index.html#inheritance](http://nhibernate.info/doc/nh/en/index.html#inheritance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T12:38:27.593

我用 cluase 修改了 Account.hbm.xml 映射文件。现在一切正常。我现在可以顺利插入记录而没有任何错误。

这是工作映射文件。

```
 <class name="Account">
    <id name="AID" type="Int32">
      <generator class="native" />
    </id>
    <!-- <discriminator column="Type" type="string" /> -->
    <property name="Name" />
    <property name="Serial" />
    <property name="Type" />

    <joined-subclass name="Human" table="Human">
      <key column="AID" />
      <property name="FirstName" />
      <property name="LastName" />
    </subclass>

    <joined-subclass name="Bank" table="Bank">
      <key column="AID" />
      <property name="LocationName" />
    </subclass>    
  </class> 
```

我认为可能是鉴别子句可能会有所帮助和过度使用。:) 没有它可以正常工作。

# docutils - 如何知道docutils的版本号

> ID：13377011
> 
> 赞同：0
> 
> 时间：2012-11-14T10:26:01.393
> 
> 标签：docutils

我发现自己正在搜索服务器正在运行的 docutils 版本。令我惊讶的是，它不像输入带有“--version”标志的任何命令那么简单。我终于通过下面的命令得到了它，但它不是比这更直接吗？

```
# Assuming we are on Debian like distribution
aptitude show python-docutils

# If "docutils" is managed by pip
pip freeze | grep docutils 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T11:58:37.173

Docutils 包（与许多其他 Python 包一样）通过参数公开版本号（在定义/文档`__version__`中搜索此版本号）。`/path/to/docutils/__init__.py`显示这一点的一个简单的衬线是：

```
python -c "import docutils; print docutils.__version__" 
```

**编辑**：刚刚尝试后，`python rst2html.py --version`我将以下信息打印到屏幕上

> rst2html.py（Docutils 0.9.1 [发布]，Python 2.6.8，在 linux2 上）

这就是你所追求的吗？

# objective-c - iPhone应用程序上的默认背景图像

> ID：13377012
> 
> 赞同：0
> 
> 时间：2012-11-14T10:26:02.393
> 
> 标签：objective-c, ios, uitableview, delegates

有没有办法在 AppDelegate 中设置整个应用程序的默认背景图像，就像为导航栏设置默认背景一样？

例子：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"navigation-bar.jpg"] forBarMetrics:UIBarMetricsDefault]; 
```

目前我的所有视图控制器上都有这段代码：

```
UIImage *backgroundImage = [UIImage imageNamed:@"bg.png"];
UIImageView *backgroundImageVIew = [[UIImageView alloc] initWithImage:backgroundImage];
self.myTable.backgroundView = backgroundImageVIew; 
```

我在 AppDelegate 中试过这个：

```
UIImage *backgroundImage = [UIImage imageNamed:@"bg.png"];
UIImageView *backgroundImageVIew = [[UIImageView alloc] initWithImage:backgroundImage];
[[UITableView appearance] setBackgroundView:backgroundImageVIew]; 
```

它适用于所有视图，除了我继续使用的视图。当我按下 Table View Cell 以切换到另一个视图时，应用程序冻结并且 CPU 上升到 100%。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:26:50.583

您可以创建 UINavigationController 的自定义子类，其中您的 pushViewController 方法看起来像

```
 -(void) pushViewController:(UIViewController*) vc animated:(BOOL) animated
    {
            UIImage *backgroundImage = [UIImage imageNamed:@"bg.png"];
            UIImageView *backgroundImageVIew = [[UIImageView alloc] initWithImage:backgroundImage];
            vc.backgroundView = backgroundImageVIew;
            [super pushViewController:vc animated:animated];
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T21:37:42.750

`didFinishLaunchingWithOptions`在 AppDelegates方法中使用以下代码解决了它：

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"bg.png"]];
imageView.frame = CGRectMake(imageView.frame.origin.x, 64.0, imageView.frame.size.width, imageView.frame.size.height);
[window addSubview:imageView]; 
```

Y 帧中的值 64.0 用于将 imageView 推送到状态栏和导航栏 (20 + 44) 的正下方。

# c# - 在 long[] 数组中查找索引

> ID：13377013
> 
> 赞同：-2
> 
> 时间：2012-11-14T10:26:07.993
> 
> 标签：c#, .net, arrays

我有一个 long[] 类型的数组，其中包含 19 组数字，然后是另一个 char[] 类型的数组，当用户输入“45324”时，我需要在 long[] 数组中找到该输入的索引并传递char[] 数组的索引，然后输出该位置的值。

所以 45324 索引可能是 12 并且 char[] 数组中的第 12 项可能是 '#' 我尝试了循环但是 pfft 我每次尝试都失败了。我宁愿不必重写代码并将所有这些值再次硬编码到不同类型的数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:29:17.593

```
int index = Array.IndexOf(array, long.Parse("45324")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:29:20.137

```
for(int i = 0; i < longArray.Length; i++)
{
  if(longArray[i].ToString() == input)
  {
    return i;
  }
}

return -1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:42:54.410

您可以使用`Array.IndexOf`来确定数组中某个值的索引。

```
long numberValue;

// First parse the string value into a long
bool isParsed  = Int64.TryParse(stringValue, out numberValue);

// Check to see that the value was parsed correctly
if(isParsed)
{
    // Find the index of the value
    int index = Array.IndexOf(numberArray, numberValue);

    // Check to see if the value actually even exists in the array
    if(index != -1)
    {
        char c = charArray[index];
        // ...
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T10:44:10.057

关于什么：

```
long input = Int64.Parse("45324");
int index = Array.IndexOf(long_array, input);
char output = default(char);
if(index != -1)
  output = char_array[index]; 
```

或者：

```
long input = Int64.Parse("45324");
int index = -1;
for(int i = 0; i < long_array.Length; i++){
    if(long_array[i] == input){
        index = i;
        break;
    }
}
char output = default(char);
if(index != -1)
   output = char_array[index]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:56:06.120

如果数据没有太大变化，您可以使用**Linq**将结果转换为字典，从而根据用户输入字符串执行快速查找。

假设你的长数组被调用`longs`并且你的字符数组被调用`chars`

```
var dict=longs
         .Select((x,i)=>new {Key=x.ToString(),Value=chars[i]})
         .ToDictionary(x=>x.Key,x=>x.Value); 
```

现在您可以使用输入字符串进行检查...

例如

```
if (!dict.ContainsKey(userInput)) // value not in the collection 
```

或者

```
char value= dict[userInput]; 
```

# c# - 使用单个实例在记事本中打开文本文件

> ID：13377020
> 
> 赞同：0
> 
> 时间：2012-11-14T10:26:52.500
> 
> 标签：c#, winforms, file, c#-4.0, notepad

在我的项目中，我试图打开一个文本文件。下面的代码可以工作，但是当用户一次又一次地单击按钮时，许多文件都被打开了。（我不想要）

```
System.Diagnostics.Process.Start(filePath); 
```

我也试过[这个](https://stackoverflow.com/q/420484/1577396)，`File.Open`它`File.OpenText`没有打开文本文件，也没有显示任何错误（尝试使用 try catch 块）

```
File.Open(filePath); (or)
File.OpenText(filePath); (or)
FileStream fileStream = new FileStream(filePath, FileMode.Open); 
```

我也试过这个：（*错误*：不能用实例引用访问，而是用类型名限定）

```
System.Diagnostics.Process proc = new System.Diagnostics.Process();
proc.Start(filePath);  /*red scribbles here*/
proc.WaitForExit(); 
```

如何仅显示文本文件 (.txt) 的一个实例。我的尝试做错了吗？请建议。

**编辑：**

我想在之后打开其他文本文件但不一样，并且在打开文本文件（或许多）后应该可以访问应用程序。我只有一个表格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T10:30:40.260

在表单级别创建字典：

```
public Dictionary<string, Process> OpenedProcesses = new Dictionary<string, Process>(StringComparer.OrdinalIgnoreCase); 
```

现在更改打开文件的方式（注意`HasExited`检查 - 这是必需的，以便用户可以关闭记事本并重新打开它）：

```
// make sure that path is always in form C:\Folder\file.txt - less chance of different 
// paths pointing to the same file.
filePath = System.IO.Path.GetFullPath(filePath);

Process proc;
if (this.OpenedProcesses.TryGetValue(filePath, out proc) && !proc.HasExited)
{
    MessageBox.Show("The file is already open!");
    // it could be possible to activate the window of the open process but that is another question on its own.
    return;
}

proc = System.Diagnostics.Process.Start(filePath);
this.OpenedProcesses[filePath] = proc; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:29:58.190

检查文件是否打开

[例子](https://stackoverflow.com/questions/11427265/is-there-a-way-to-programmatically-check-if-a-excel-file-is-opened)

然后做你想做的工作。

# blackberry - 黑莓 HttpPost 空指针异常 Java

> ID：13377021
> 
> 赞同：0
> 
> 时间：2012-11-14T10:27:00.293
> 
> 标签：blackberry, nullpointerexception, http-post

使用以下代码，服务器受到攻击，但我也想在 POST 方法中发送变量。

但它只是给了我一个空指针异常。它与`OutputStream`. 我已经检查过`postData`......它有一些地址，这意味着它不为空。

那么为什么给我空指针异常呢？

```
ConnectionFactory connFact = new ConnectionFactory();
ConnectionDescriptor connDesc;
try {
    connDesc = connFact.getConnection("http://example.com/login.php", Connector.READ_WRITE, returnContent);
    httpConn.setRequestMethod(HttpConnection.POST);
    httpConn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

    URLEncodedPostData encPostData = new URLEncodedPostData("UTF-8", false);
    encPostData.append("count", "Hell Yeah!");
    byte[] postData = encPostData.toString().getBytes("UTF-8");

    httpConn.setRequestProperty("Content-length", String.valueOf(postData.length));
    Dialog.alert("Post Data: " + postData);

    OutputStream os = httpConn.openOutputStream();
    os.write(postData);
    os.flush();
    httpConn = (HttpConnection) connDesc.getConnection();

    final int iResponseCode = httpConn.getResponseCode();
    UiApplication.getUiApplication().invokeLater(new Runnable() {
        public void run() {
            //Dialog.alert("Response code: " +  Integer.toString(iResponseCode));
        }
    });
} catch (IOException e) {
    System.err.println("Caught IOException: " + e.getMessage());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:59:02.050

您正在滥用该`ConnectionFactory.getConnection(String url, int transportType, String ConnectionUID)`方法。例如，检查您传递的内容`transportType`...

以下是 API 关于返回值的说明：

> 返回： 如果可以建立连接，则返回 ConnectionDescriptor；否则为空

所以，它只是失败并返回`null`。这就是你获得 NPE 的原因。

**更新**：

我建议只使用更简单的 API `ConnectionFactory.getConnection(String url)`：

```
ConnectionDescriptor cd = connFact.getConnection("http://example.com/login.php");
if (cd == null) {
    // throw an error signalling there is no connectivity right now
}
HttpConnection httpConn = (HttpConnection) cd.getConnection();
// the rest of the code working with httpConn .. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T12:52:20.247

查看链接的答案并验证“登录”程序的实现是否满足您的需求： [authentication username password url in blackberry](https://stackoverflow.com/questions/11294892/authentication-username-password-url-in-blackberry/11305561#11305561)

# jquery - 使用正则表达式验证货币时 IE 8 崩溃

> ID：13377022
> 
> 赞同：1
> 
> 时间：2012-11-14T10:27:03.867
> 
> 标签：jquery, regex, internet-explorer

我已经编写了一堆代码来获得有效的支出金额条目（`32.4554`,`234,324.34`等）。我还编写了代码来限制用户输入超过 13 位数字（不包括`.`and `,`）。

所有这些都在 Firefox 中完美运行。但是在 IE 8 中，位数超过 13 位后，如果输入一个字母，Internet Explorer 就会挂起并崩溃！在调试时，我注意到它在正则表达式行出现错误，但相同的正则表达式工作正常，直到没有超过 13 的限制！正则专家，请！给我看光！

```
function isIncorrectSpend(cubeCurrencySpend) {  
    if(!(/^([1-9]*[0-9]*,?[0-9]*)* (\.[0-9]*)?$/.test(cubeCurrencySpend))) {
        return true;
    }
    return false;
}

function isLongerThanThirteenDigits(cubeCurrencySpend) {
    cubeCurrencySpend = cubeCurrencySpend.replace(/,/g, "").replace(/\./g, "");
    if(cubeCurrencySpend.length>12) { 
        return true;
    }
    return false;
}

jQuery("input#minval").keyup( function() {
    if(isIncorrectSpend(jQuery("input#minval").val())) {
        jQuery("input#minval").val("");
        alert("please enter correct spend value");
    }        
});
jQuery("input#minval").keypress( function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if(isLongerThanThirteenDigits(jQuery("input#minval").val()) && (code > 47 && code < 58)) {
        alert("Please enter a number less than 13 digits");
        return false;
    }
    return true;
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T10:59:42.133

我很确定这是一个[灾难性的回溯](http://www.regular-expressions.info/catastrophic.html)。你的正则表达式有太多的可能性要检查，直到它失败。

问题是这部分

```
([1-9]*[0-9]*,?[0-9]*)* 
```

而且我很确定它没有按照您的预期进行。

这将匹配相同的东西，但会失败得更快：

```
/^[1-9]*[0-9,]*(\.[0-9]+)?$/ 
```

它仍然允许像 1,,,,,,,.123 这样的东西，但比你的要好得多。如果你想禁止这样的事情，你需要澄清你的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T18:10:08.483

此答案假定您希望验证满足以下条件的十进制“数字”：

## “数字”的定义

*   必须至少有一位数字，并且所有数字都必须是十进制（从 0 到 9）。
*   整数部分和小数部分都是可选的，但其中一个必须存在。
*   小数部分（如果存在）可以有任意位数，但总是以小数点开头。
*   如果整数部分多于一位，则前导数字不得为零。
*   如果整数部分多于三位数，可以使用逗号将整数分隔为数字三元组。
*   数字可以以可选符号开头，加号`+`或减号`-`。
*   不允许使用空格。
*   不允许使用指数部分。

鉴于上述要求，这里有一些有效和无效的数字

## 有效的“数字”：

```
0
0.
.0
0.0
1
+1
-1
1234
123456
1,234
12,345
123,456
123,456.7890 
```

## 无效的“数字”：

```
0FA92      // Invalid digit. Must be 0-9.
0123       // Multi-digit integer must lead with non-zero.
.          // Must have at least one digit.
1,23,4     // Commas must separate triplets of digits.
12345,678\. // Missing comma.
+  10      // Whitespace not allowed.
1.2E34     // Exponents not allowed. 
```

这是一个正则表达式（首先使用 Python 方便的原始字符串语法以注释、自由间距模式格式呈现）匹配满足上述要求的数字：

## 正则表达式验证“数字”

```
r"""
^          # Anchor to start of string.
[+\-]?     # Optional sign.
(?=\.?\d)  # Must have at least one digit.
(?:        # Optional integer part. Either...
  [1-9]    # A sequence of digits w/no commas.
  \d*      # (but first digit is not zero.)
|          # or an integer having commas...
  [1-9]    # First digit is not zero.
  \d{0,2}  # 1,2 or 3 digits ahead of 1st comma.
  (?:      # One or more comma + 3 digits.
    ,      # Comma separates
    \d{3}  # digit triplets.
  )+       # One or more comma + 3 digits.
| 0        # or integer part may be just zero.
)?         # Optional integer part.
(?:        # Optional fractional part.
  \.       # Dot separates
  \d*      # zero or more fraction digits.
)?         # Optional fractional part.
$          # Anchor to end of string.
""" 
```

这是一个实现上述正则表达式的 JavaScript 函数：

## 函数是有效数字（）

```
function isValidNumber(text) {
    var re = /^[+\-]?(?=\.?\d)(?:[1-9]\d*|[1-9]\d{0,2}(?:,\d{3})+|0)?(?:\.\d*)?$/;
    if((re.test(text))) return 'true';
    return 'false';
} 
```

请注意，在用户完成输入整个号码之前，您不应该尝试验证号码。为每个按键调用验证函数（正如您上面的代码似乎正在做的那样）恕我直言，这不是一个好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:08:06.613

您还可以更改正则表达式以结合长度和有效性检查。

```
function isIncorrectSpend(cubeCurrencySpend) {  
     return !/^(?!0)(?:\d[,\.]*){1,13}$/.test(cubeCurrencySpend);              
} 
```

# java - 带图像的按钮

> ID：13377024
> 
> 赞同：1
> 
> 时间：2012-11-14T10:27:11.827
> 
> 标签：java, image, swing, button

我正在尝试制作一个 Java 应用程序。Java 应用程序应该有一个带有流式布局的菜单栏。

现在，在这个菜单栏中，我想介绍三个按钮：

1.  开始一个新项目
2.  打开保存的项目
3.  保存项目

我想利用这些按钮中的图像。就像 Word 关联一张空白纸的图像来启动一个新项目，一个目录来打开一个保存的项目，以及一张软盘来保存一个项目。

请问这怎么能在Java中完成？

**编辑**

我试过这段代码：

```
UIManager.getIcon("FileView.directoryIcon");
UIManager.getIcon("FileView.fileIcon");
UIManager.getIcon("FileView.floppyDriveIcon"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:50:03.243

我不确定 Java 中是否有可用的标准图像，我相信没有。

但是您可以捕获这些图像或下载一个包。

然后您只需使用[此处的代码](https://stackoverflow.com/a/4801452/1360074)

```
JButton button = new JButton();

  try {
    Image img = ImageIO.read(getClass().getResource("resources/water.bmp"));
    button.setIcon(new ImageIcon(img));
  } catch (IOException ex) {
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:55:34.270

尝试：

```
ImageIcon icon = new ImageIcon("Path to the image.format");
JButton btnOne = new JButton();
btnOne.setBackground(icon); 
```

路径是您想要作为背景的捕获图像的位置。

# c# - 在c#中调整图片框大小的代码是什么？

> ID：13377026
> 
> 赞同：3
> 
> 时间：2012-11-14T10:27:21.423
> 
> 标签：c#, resize, size, picturebox

我只是 C# 的初学者，所以简单的答案真的很有帮助。

我正在尝试制作一个非常简单的游戏，可以检测大小为 50,50 的`MouseClick`a `PictureBox`（在游戏开始时）。在 PictureBox （有一个蓝色`BackgroundImage`）上每次成功的 MouseClick 之后，我想将`Size`PictureBox 更改为 ，使其在`Width`和中小 1 个像素`Height`。然后我会让 PictureBox 移动到一个随机位置（我已经知道该怎么做，所以这部分不需要帮助）。

我认为这可能与此有关，`picturebox.Resize`但我不太确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:29:37.207

这是一个一般性的问题，您应该在互联网上查找它，不要在这里问它.. btt：

```
Size size = new Size(100,100);
pictureBox1.Size = size; 
```

[http://msdn.microsoft.com/de-de/library/system.windows.forms.picturebox.aspxh](http://msdn.microsoft.com/de-de/library/system.windows.forms.picturebox.aspxh)

[http://msdn.microsoft.com/de-de/library/system.windows.forms.control.size.aspx](http://msdn.microsoft.com/de-de/library/system.windows.forms.control.size.aspx)

在您的情况下，这将是您的代码：

```
Size size = pictureBox1.Size;
size.Height--;
size.Width--;
pictureBox1.Size = size; 
```

要不就：

```
pictureBox1.Height--;
pictureBox1.Width--; 
```

或酷的：

```
private int size = 50;
private void button5_Click(object sender, EventArgs e)
{
    size--;
    pictureBox1.Height = pictureBox1.Width = size;
} 
```

回复：

```
private void button5_Click(object sender, EventArgs e)
{
    pictureBox1.Height = pictureBox1.Width = pictureBox1.Width - 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:16:55.313

这应该工作..

```
int newSize = 50; //Global variable 
```

**PictureBox1_Click**事件

```
pictureBox1.Size = new Size(newSize--,newSize--); 
```

# java - 使用 Google HTTP 客户端执行 POST、PUT 和 DELETE

> ID：13377029
> 
> 赞同：5
> 
> 时间：2012-11-14T10:27:28.030
> 
> 标签：java, http, httpclient

如何使用 Google HTTP 客户端进行 POST、PUT 和 DELETE：

```
@Test
public void testGetDBs() throws IOException {
    GooUrl url = new GooUrl(GOO_URL);
    List<String> path = new LinkedList<String>();
    path.add("users");
    path.add("id1");
    url.setPathParts(path);
    url.fields = "";
    HttpRequest request;
    try {
        request = requestFactory.buildGetRequest(url);
        request.setMethod(HttpMethod.POST);
        String result = request.execute().parseAsString();
        System.out.println("Result = " + result);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

假设我需要发布一个 JSON 字符串，该怎么做？另外，设置内容长度和类型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T18:40:51.243

您需要在执行之前构建适当的类型请求并设置其内容。

请注意，在您的示例代码中，您正在构建一个 GET 请求，然后将方法设置为 POST，这会造成混淆。查看 HttpRequestFactory 代码，每个 HTTP 方法都有一个构建方法。尝试：

```
final request = requestFactory.buildPostRequest(url);
final byte [] contentBytes = ...//get some bytes!!
final HttpContent content = new ByteArrayContent("application/json", contentBytes ); 
request.setContent( content );
final String result = request.execute().parseAsString(); 
```

似乎有几种不同类型的 HttpContent 可供选择（ByteArrayContent 如上所示），当然如果您发现它们不符合您的需求，您也可以自己实现 HttpContent 接口。

# sql - Oracle - 克隆表 - 结构、数据约束和所有

> ID：13377030
> 
> 赞同：6
> 
> 时间：2012-11-14T10:27:28.487
> 
> 标签：sql, oracle, oracle10g

我知道我可以通过以下方式复制故事结构和数据

```
create table testtable1 as select * from sourcetable 
```

有什么方法可以实际克隆所有内容、触发器、约束、授权等？

提前致谢。我们正在运行 10G。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-14T10:31:40.173

看一看`dbms_metadata`，尤其是它的程序`dbms_metadata.get_ddl`功能（见这个[大溪地链接](https://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_metada.htm#BGBBIEGA)）。

所以，在你的情况下，你会首先做一个

```
select dbms_metadata.get_ddl('TABLE', 'SOURCETABLE') from dual; 
```

根据*现在*的评论：不要忘记`dbms_metadata.get_dependent_ddl`：

```
select dbms_metadata.get_dependent_ddl('TABLE', 'SOURCETABLE') from dual; 
```

然后从给定的输出工作。

# java - 是否有任何用于 Map-Reduce 的自动化单元测试生成器？

> ID：13377031
> 
> 赞同：1
> 
> 时间：2012-11-14T10:27:32.663
> 
> 标签：java, junit, hadoop, mapreduce

我目前正在使用 MRUnit 为 Map-Reduce 编写单元测试。所以我的问题是：是否有任何工具可以自动为 map-reduce 生成单元测试？

# iphone - 在图像视图图像上写文字

> ID：13377034
> 
> 赞同：3
> 
> 时间：2012-11-14T10:27:40.483
> 
> 标签：iphone, uiimageview, uiimage, ios6

目前，我正在开发一个应用程序，其中我有一个图像视图，其中图像不断

一段时间后发生变化。现在我希望我能够写一些文字或绘制任何符号

,simple line,cross line 表示在图像上绘图出现在图像视图中。表示我想

在图像上添加文本或绘制一些符号或线条等。我到处寻找但不能

找到任何解决方案。我该如何解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:33:30.533

你有两个选择。

1.  添加 a`UILabel`作为 imageView 的子视图，并将 UILabel 的背景颜色设置为清除颜色。
2.  实现以下方法，该方法将图像和文本作为参数并返回文本添加的图像。

    //给UIImage添加文字

    ```
    -(UIImage *)addText:(UIImage *)img text:(NSString *)text1
    {

    int w = img.size.width;

    int h = img.size.height; 

    //lon = h - lon;

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);

    CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);

    CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1);

    char* text  = (char *)[text1 cStringUsingEncoding:NSASCIIStringEncoding];// "05/05/09";

    CGContextSelectFont(context, "Arial", 18, kCGEncodingMacRoman);

    CGContextSetTextDrawingMode(context, kCGTextFill);

    CGContextSetRGBFillColor(context, 255, 255, 255, 1);

    //rotate text

    CGContextSetTextMatrix(context, CGAffineTransformMakeRotation( -M_PI/4 ));

    CGContextShowTextAtPoint(context, 4, 52, text, strlen(text));

    CGImageRef imageMasked = CGBitmapContextCreateImage(context);

    CGContextRelease(context);

    CGColorSpaceRelease(colorSpace);

    return [UIImage imageWithCGImage:imageMasked];

    } 
    ```

参考：http: [//iphonesdksnippets.com/post/2009/05/05/Add-text-to-image-%28UIImage%29.aspx](http://iphonesdksnippets.com/post/2009/05/05/Add-text-to-image-%28UIImage%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:32:30.597

看看这是否有效：

```
//Add text to UIImage

-(UIImage *)addText:(UIImage *)img text:(NSString *)text1{

    int w = img.size.width;

    int h = img.size.height; 

    //lon = h - lon;

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);

    CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);

    CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1);

    char* text  = (char *)[text1 cStringUsingEncoding:NSASCIIStringEncoding];// "05/05/09";

    CGContextSelectFont(context, "Arial", 18, kCGEncodingMacRoman);

    CGContextSetTextDrawingMode(context, kCGTextFill);

    CGContextSetRGBFillColor(context, 255, 255, 255, 1);

    //rotate text

    CGContextSetTextMatrix(context, CGAffineTransformMakeRotation( -M_PI/4 ));

    CGContextShowTextAtPoint(context, 4, 52, text, strlen(text));

    CGImageRef imageMasked = CGBitmapContextCreateImage(context);

    CGContextRelease(context);

    CGColorSpaceRelease(colorSpace);

    return [UIImage imageWithCGImage:imageMasked];

} 
```

# cakephp - 避免后退按钮后的黑洞请求 CakePHP2.2

> ID：13377036
> 
> 赞同：2
> 
> 时间：2012-11-14T10:27:43.640
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.2

我注意到当我`Security`在 CakePHP2.2 上使用 Component 时表单是黑洞，并且用户在单击站点的其他链接后单击后退浏览器按钮以返回到表单。

例如：

> 家
> 
> 点击**新帖子**链接（但不发布）
> 
> 点击**新闻**
> 
> 返回**新帖子**
> 
> 正在尝试发布--->**黑洞！！**

有没有办法避免这种情况？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-06T07:14:47.873

其实是有办法的。您可以使用表单禁用页面的浏览器缓存，因此当您点击后退按钮时，会从服务器加载带有新哈希的整个新页面。

```
$this->response->disableCache(); 
```

只需将其放入您的 Controller 方法中即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:01:18.693

不，你不能，因为这个想法是为了避免表单操作。每个表单在第一次呈现时都会生成一个唯一的哈希值。提交表单时会在服务器端检查此哈希。当您第二次尝试提交表单时，当您点击提交按钮时，哈希不再有效。您可以禁用该操作的后期安全检查，但我不会为此牺牲安全性。

# c# - 每天在我的网站的固定时间调用一个函数

> ID：13377039
> 
> 赞同：0
> 
> 时间：2012-11-14T10:28:06.900
> 
> 标签：c#, asp.net, .net, function

我想每天晚上 11:00 调用一个函数来检查我所有用户的到期付款如何调用这个函数？问题是我不能使用任务计划，因为我正在使用共享服务器，而且我也在使用 IIS 7 我的网站位于 .Net 和 C#

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:31:23.317

有几个工具可以做到这一点。查看[Quartz.NET](http://quartznet.sourceforge.net/)。另一种解决方案可能是在 SQL Server 上安排一个作业，如果这是您正在使用的东西，并且取决于您希望该作业做什么。

也就是说，假设你真的不能使用任务调度程序。它非常可靠，并且易于使用，否则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T12:48:58.177

使用 Windows 服务解决了这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:34:27.783

您可以通过使用全局计时器或创建后台线程并将任务代码放入后台线程的工作函数中来做到这一点。

但是，它们都依赖于 asp.net 应用程序处于活动状态（未关闭）。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T10:35:08.440

我通常做的是创建一个自定义时间表。它会将必须完成的任务列表写入文件或数据库，它们使用计时器来运行任务并在完成时将它们标记为已完成。

该算法类似于：

每 X 分钟：

1.  检查待处理任务的数据源。
2.  执行任务
3.  为明天安排相同的任务
4.  将任务标记为已完成。
5.  下一个任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:36:29.707

构建一个执行此功能的安全网页，并从外部系统（例如您自己的 PC）调用它。

# php - PHP 创建一系列连续的行

> ID：13377040
> 
> 赞同：0
> 
> 时间：2012-11-14T10:28:14.830
> 
> 标签：php

如何修改此代码以使第二个数组的值以“值 4”开头并以“值 6”结尾？基本上 range() 的第一个参数应该是动态的，但我不确定这是否可能？

```
for($i = 1; $i <= 2; $i++)
{
    $rows[] = array_map(function($n) {
        return "value " . $n;
        }, range(1, 3));
} 
```

`print_r($rows)`应该

```
Array
(
    [0] => Array
        (
            [0] => value 1
            [1] => value 2
            [2] => value 3
        )

    [1] => Array
        (
            [0] => value 4
            [1] => value 5
            [2] => value 6
        )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:34:25.907

我已经对您的代码进行了一些重组。这是我的解决方案：

```
for($i = 0; $i < 2; $i++)
{
  $rows[] = array_map(function($n) {
    return "value " . ($n+1);
  }, range($i*3, $i*3+2));
};

print_r($rows); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:39:32.953

如果`for`您的逻辑中不需要循环，则可以直接将其输入`range`

```
$rows = array_map(function($n) {
    $n = 3 * $n;
    return array("value " . (1+$n), "value " . (2+$n), "value " . (3+$n), );
  }, range(0, 1) // 0 to max as in for loop
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:33:45.143

```
$row=array();
foreach(range(1,2) as $idx)
{
    $row[]=array_map(function($n){return "value $n";},range(($idx-1)*3+1,$idx*3));
}
print_r($row) 
```

这将输出：

```
Array
(
    [0] => Array
        (
            [0] => value 1
            [1] => value 2
            [2] => value 3
        )

    [1] => Array
        (
            [0] => value 4
            [1] => value 5
            [2] => value 6
        )

) 
```

# jquery - jQuery - 如何选择仅包含某些其他元素的元素

> ID：13377045
> 
> 赞同：2
> 
> 时间：2012-11-14T10:29:04.607
> 
> 标签：jquery

如何选择具有 <a name="something"></a> 的节点，以便将其包含的文本加粗？

```
<p>
  <a name="test"></a>
  Test 1
</p>

<p>
  <a href="test2"></a>
  Test 2
</p>

<div>
  <a name="test3"></a>
  Test 3
</div> 
```

期望的输出：

**测试 1**

测试 2

**测试 3**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T10:29:54.077

您可以使用[`.has()`](http://api.jquery.com/has/)方法：

```
$("p,div").has("a[name]").css("font-weight", "bold");​​​​​​​​​​​​​​​ 
```

或[`:has()`](http://api.jquery.com/has-selector/)选择器：

```
$("p:has(a[name]),div:has(a[name])").css("font-weight", "bold");​ 
```

**演示：http:** [//jsfiddle.net/bWvwa/](http://jsfiddle.net/bWvwa/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:30:24.227

```
$('a[name="something"]').css('fontWeight', 'bold'); 
```

# python - Scipy：循环填充从 数据库读取的直方图，逐个事件

> ID：13377046
> 
> 赞同：2
> 
> 时间：2012-11-14T10:29:06.720
> 
> 标签：python, numpy, scipy

您有时不想在创建一个巨大的列表*后填充直方图。*您想读取数据库并按事件填充直方图事件。例如：

```
collection = db["my_collection"]
for event in collection.find():
   histogram.fill(event['a_number']) 
```

因此，如果集合中有 100 亿个条目，我可以填充分析所需的任何直方图，而无需将所有数据都放入内存中。

我已经完成了构建自己的 fill_histogram 函数，但我认为应该有一些可以使用的东西...... HBOOK FORTRAN 库，在 1980 年代开发，将“HFILL”作为其最常用的子例程:)

顺便说一句，这是一个为 numpy.histogram 工作的函数，但我在 numpy 中找不到：

```
def hfill(histogram, datum, weight=1):
'''
Bin the right bin in a numpy histogram for datum, with weight.
If datum is outside histogram's bins' range, histogram does not change
'''
for idx, b in enumerate(histogram[1]):
    if idx > 0:
        if (datum < b and datum >= histogram[1][0]) or (datum <= b and idx == len(histogram[1]) - 1):
            histogram[0][idx - 1] += int(weight)
            break 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-07-13T23:46:46.453

我通常使用一个简单的包装器来`numpy.histogram`解决这个问题：

```
import numpy as np

class Hist1D(object):

    def __init__(self, nbins, xlow, xhigh):
        self.nbins = nbins
        self.xlow  = xlow
        self.xhigh = xhigh
        self.hist, edges = np.histogram([], bins=nbins, range=(xlow, xhigh))
        self.bins = (edges[:-1] + edges[1:]) / 2.

    def fill(self, arr):
        hist, edges = np.histogram(arr, bins=self.nbins, range=(self.xlow, self.xhigh))
        self.hist += hist

    @property
    def data(self):
        return self.bins, self.hist 
```

这允许使用要求：

```
from matplotlib import pyplot as plt

h = Hist1D(100, 0, 1)
for _ in range(1000):
    a = np.random.random((3,))
    h.fill(a)
    plt.step(*h.data)
    plt.show() 
```

编辑：如果有人有类似的基于事件的设置，但对于 2D 数据，我也有[代码](https://github.com/NichtJens/numpy-accumulative-histograms)。由于此处的问题中没有要求，因此我没有将其添加到答案中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-06T16:59:18.550

尽管这条消息是不久前发布的，但我想我会提到一些有用的工具，与 HBOOK/PAW 一样，用于您正在做的事情。我没有找到其他好的 Python 替代品来处理大量的内存不足数据。

*   PyROOT 将整个 ROOT 框架暴露给 Python，因此您可以使用它的 TH1/2/3 和 THnSparse 变体（参见[http://root.cern.ch/drupal/content/pyroot](http://root.cern.ch/drupal/content/pyroot)和一般 ROOT 文档）。假设您安装了带有 python 支持的 ROOT 并具有某种类型的“事件”（如 ROOT 的 TTree/TCain，它针对大型数据集进行了优化），逐个事件填充将如下所示：

    ```
    from ROOT import TH1F
    nbins, lo, hi = 100, -3, 3
    hist = TH1F('hist', 'my hist', nbins, lo, hi)
    for evt in events:
        hist.Fill(evt.somevalue)
    # render the histogram on a TCanvas (active if present, new otherwise)
    hist.Draw() 
    ```

*   rootpy 进一步“pythonizes”了 ROOT 接口（参见[http://rootpy.org](http://rootpy.org)）。在与上面相同的假设加上安装了 rootpy 的假设下，只有上面代码段的前两行会更改为：

    ```
    from rootpy.plotting import Hist
    hist = Hist(nbins, lo, hi) 
    ```

我已经使用 ROOT 和 PyROOT 很长时间了，最​​近尝试使用 rootpy 以更好地与一些 SciPy 工具集成。rootpy 与 matplotlib 的集成也很好，特别是如果您希望直方图显示在 IPython 笔记本中，例如：

```
from rootpy.plotting import Hist
import rootpy.plotting.root2matplotlib as rplt
import matplotlib.pyplot as plt

hist = Hist(100, -3, 3)
hist.FillRandom('gaus')
fig = plt.figure(figsize=(7, 5), dpi=100, facecolor='white')
rplt.errorbar(hist, xerr=False, emptybins=False)
plt.show() 
```

上面的代码片段可以作为一个最小的测试来查看是否安装了 ROOt、PyROOT、rootpy 和 matplotlib。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:49:57.653

Here's a simplified example:

```
>>> c = Counter()
>>> for j in xrange(10):
...   c[j] = j**2
>>> c
Counter({9: 81, 8: 64, 7: 49, 6: 36, 5: 25, 4: 16, 3: 9, 2: 4, 1: 1, 0: 0}) 
```

here at no time you have to have an in-memory list of integers. Sure, if you want to have the histogram as a `numpy` array, you'll have to construct it from the `Counter` manually.

If you're using python < 2.7, then `Counter` is not available from `collections`, but here's an [ActiveState recipe](http://code.activestate.com/recipes/576611/).

# iphone - 滚动视图后识别可见视图框架

> ID：13377049
> 
> 赞同：1
> 
> 时间：2012-11-14T10:29:13.127
> 
> 标签：iphone, uiscrollview, frame, visible

我试图在单击按钮时显示日期选择器。我希望日期选择器位于 iPhone 可见视图的中心。我的基本视图是 UIScrollView。它工作正常，直到我滚动视图。只要我向上滚动视图并单击向上移动的日期选择器按钮。我正在使用的代码是

```
- (void)changeDate:(UIDatePicker *)sender {
   NSLog(@"New Date: %@", sender.date);
   }

 - (void)removeViews:(id)object {
   scrollview.scrollEnabled = YES;
   [[self.view viewWithTag:9] removeFromSuperview];
   [[self.view viewWithTag:10] removeFromSuperview];
   [[self.view viewWithTag:11] removeFromSuperview];
   }  

  - (void)dismissDatePicker:(id)sender {
   scrollview.scrollEnabled = YES;
   CGRect toolbarTargetFrame = CGRectMake(0, self.view.bounds.size.height, 320, 44);
   CGRect datePickerTargetFrame = CGRectMake(0, self.view.bounds.size.height+44, 320, 216);
   [UIView beginAnimations:@"MoveOut" context:nil];
   [self.view viewWithTag:9].alpha = 0;
   [self.view viewWithTag:10].frame = datePickerTargetFrame;
   [self.view viewWithTag:11].frame = toolbarTargetFrame;
   [UIView setAnimationDelegate:self];
   [UIView setAnimationDidStopSelector:@selector(removeViews:)];
   [UIView commitAnimations];
   }

   - (IBAction)callDP:(id)sender {
    if ([self.view viewWithTag:9]) {
     return;
      }
     scrollview.scrollEnabled = NO;
     CGRect toolbarTargetFrame = CGRectMake(0, self.view.bounds.size.height/2-216/2-44, 320, 44);
     CGRect datePickerTargetFrame = CGRectMake(0, self.view.bounds.size.height/2-216/2, 320,    216);

UIView *darkView = [[UIView alloc] initWithFrame:self.view.bounds];
darkView.alpha = 0;
darkView.backgroundColor = [UIColor blackColor];
darkView.tag = 9;
UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(dismissDatePicker:)] ;
[darkView addGestureRecognizer:tapGesture];
[self.view addSubview:darkView];

UIDatePicker *datePicker = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, self.view.bounds.size.height+44, 320, 216)];
datePicker.datePickerMode = UIDatePickerModeDate;

datePicker.tag = 10;
[datePicker addTarget:self action:@selector(changeDate:) forControlEvents:UIControlEventValueChanged];
[self.view addSubview:datePicker];

UIToolbar *toolBar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, self.view.bounds.size.height, 320, 44)];
toolBar.tag = 11;
toolBar.barStyle = UIBarStyleBlackTranslucent;
UIBarButtonItem *spacer = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(dismissDatePicker:)];
[toolBar setItems:[NSArray arrayWithObjects:spacer, doneButton, nil]];
[self.view addSubview:toolBar];

[UIView beginAnimations:@"MoveIn" context:nil];
toolBar.frame = toolbarTargetFrame;
datePicker.frame = datePickerTargetFrame;
darkView.alpha = 0.5;
[UIView commitAnimations];
 } 
```

# java - 正则表达式模式

> ID：13377050
> 
> 赞同：1
> 
> 时间：2012-11-14T10:29:14.630
> 
> 标签：java, regex

我想创建一个模式，它匹配从 58 到 64 的所有[ASCii 十进制代码](http://www.asciichart.com/)（包括 58 和 64）

```
String regExp=""; //ASCii decimal codes 58 - 64

//How to define above regular expression string "regExp"

Pattern pattern = Pattern.compile(regExp); 
```

如何定义正则表达式字符串`regExp`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:35:46.223

如果要使用数值，请尝试

```
String regexp = "[\\x3a-\\x40]"; 
```

不幸的是，您不能指定十进制值。有关更多信息，请参阅[模式](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html)文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:36:11.317

这是原始 ASCII 数值。

```
String regExp = "[\\x3A-\\x40]+"; 
```

应该匹配所有出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T10:33:06.633

只需使用一个字符类：

```
String regExp="[:;<=>?@]"; 
```

# java - 带星号的数字

> ID：13377052
> 
> 赞同：2
> 
> 时间：2012-11-14T10:29:17.993
> 
> 标签：java, loops

我是 Java 新手，我想知道是否可以在数字旁边加上星号，例如：1* 2** 3***

我这里有我的代码

```
package ReviewExercise;
import java.util.Scanner;
public class review1 {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        Scanner sc = new Scanner(System.in);
        System.out.print("Enter number from 1 - 10: ");
        int num = sc.nextInt();

        //for(int r = 1; ; r++){
            for(int c = 1; c <= num; c++) {
                for (int r = c; r <= c; r++) {
                System.out.println(c);
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:31:45.487

简要地

```
for (int i = 0 i < noOfAsterisks; i++) {
   System.out.print("*");
} 
```

`print()`注意而不是的用法`println()`。`print()`输出后不会打印换行符，因此可用于打印上述序列。

您可能更喜欢使用[StringBuilder](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)`println()`在内存中构建一个字符串，然后在一个语句中将其打印出来。这可能更有效和/或更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:36:07.227

修改你的`for`循环如下：

```
for(int c = 1; c <= num; c++) 
{
    System.out.print(c);
    for (int r = 1; r <= c; r++) 
    {
        System.out.print("*");
    }
    System.out.print(" ");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:38:41.233

```
for(int c = 1; c <= num; c++)
{
    String line = String.valueOf(c);
    for (int r = 0; r < c; r++)
    {
        line += "*";
    }
    System.out.println("");
    System.out.println(line);
 } 
```

# android - 带有未在 FB 墙上发布的 URL 的 Android Facebook SDK 标题

> ID：13377059
> 
> 赞同：0
> 
> 时间：2012-11-14T10:29:33.710
> 
> 标签：android, facebook, url, sdk, posting

我可以使用以下代码成功将图像发布到 FB

```
byte[] data = null;      
ByteArrayOutputStream baos = new ByteArrayOutputStream();
photo.compress(Bitmap.CompressFormat.JPEG, 100, baos);
data = baos.toByteArray();

Bundle parameters = new Bundle();
parameters.putString("caption", "Test Caption");   
parameters.putString("method", "photos.upload");         
parameters.putByteArray("picture", data);  

AsyncFacebookRunner mAsyncRunner = new AsyncFacebookRunner(facebookClient);
mAsyncRunner.request(null, parameters, "POST", new SampleUploadListener(), null); 
```

但是当我尝试在标题中有一个 URL 如下

```
 parameters.putString("caption", "Test Caption: http://google.com/"); 
```

帖子未在 FB 墙上发布

这也行不通

```
parameters.putString("caption", "Test Caption: /"); 
```

我认为错误是在发布到墙上时发送 / 字符。我想知道有没有办法在标题中添加 url（或 / 字符）以将其发布到 FB 墙上

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T01:39:18.420

尝试`/`通过放置正斜杠来转义字符，以便您的字符串：

> “测试说明：http: [//google.com](http://google.com) ”

应该

> “测试标题：http:\/\/google.com”

还，

`mAsyncRunner.request(null, parameters,...`

`null`应该是`me/photos`。

# zend-framework - 过滤表格内容

> ID：13377060
> 
> 赞同：0
> 
> 时间：2012-11-14T10:29:36.417
> 
> 标签：zend-framework, zfdatagrid

我不太了解表格中过滤器的文档，当用户在过滤器输入中输入内容时如何更新？当我在我的示例中尝试时，这些值不会改变。我在控制器中的表的当前代码是这样的：

```
 $db = Zend_Db_Table::getDefaultAdapter();

    $grid = Bvb_Grid::factory('Table');
    $select = $db->select()->from('hosts');
    $grid->setSource(new Bvb_Grid_Source_Zend_Select($select));
    $grid->setImagesUrl('./images/');
    $grid->setUseKeyEventsOnFilters(true);
    $grid->saveParamsInSession(true);
    $myGrid = $grid->deploy();
    $this->view->hosts = $myGrid; 
```

为了让过滤器更新表格内容，我需要添加什么？

感谢您的阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T19:56:02.387

这可能是由于没有打印出 ZFDatagrid 生成的 javascript 函数造成的。

如果在尝试添加之前没有完成：

```
<?php echo $this->headScript();?> 
```

在布局或视图模板的 <head> 部分。

# python - 为什么这个循环返回两次？

> ID：13377070
> 
> 赞同：1
> 
> 时间：2012-11-14T10:30:03.130
> 
> 标签：python, loops

我有以下代码：

```
import re
from bs4 import BeautifulSoup

f = open('AIDNIndustrySearchAll.txt', 'r')
g = open('AIDNurl.txt', 'w')
t = f.read()
soup = BeautifulSoup(t)

list = []
counter = 0

for link in soup.find_all("a"):
    a = link.get('href')
    if re.search("V", a) != None:
        list.append(a)
        counter = counter + 1

new_list = ['http://www.aidn.org.au/{0}'.format(i) for i in list]
output = "\n".join(i for i in new_list)

g.write(output)

print output
print counter

f.close()
g.close() 
```

它基本上是通过一个保存的 HTML 页面并拉出我感兴趣的链接。我是 Python 新手，所以我确信代码很糟糕，但它（几乎）可以工作；）

当前的问题是它返回每个链接的两个副本，而不是一个。我确信这与循环的设置方式有关，但有点卡住了。

我欢迎有关此问题的任何帮助（如果需要，我可以提供更多详细信息 - 例如 HTML 和有关我正在寻找的链接的更多信息）以及任何一般代码改进，以便我可以尽可能多地学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:40:50.817

由于您也要求进行代码优化，因此我将发布我的建议作为答案。随意！

```
from bs4 import BeautifulSoup

f = open('AIDNIndustrySearchAll.txt', 'r')
t = f.read()
f.close()

soup = BeautifulSoup(t)
results = []   ## 'list' is a built-in type and shouldn't be used as variable name

for link in soup.find_all('a'):
    a = link.get('href')
    if 'V' not in a:
        results.append(a)

formatted_results = ['http://www.aidn.org.au/{0}'.format(i) for i in results]
output = "\n".join(formatted_results)

g = open('AIDNurl.txt', 'w')
g.write(output)
g.close()

print output
print len(results) 
```

这仍然不能解决您原来的问题，请参阅我和其他人的问题评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:43:28.437

正如其他人在评论中指出的那样，您的循环看起来不错，因此重复很可能在 HTML 本身中。如果您可以分享指向 HTML 文件的链接，也许我们可以提供更多帮助。

至于一般的代码改进，我可能会这样做：

```
from bs4 import BeautifulSoup
soup = BeautifulSoup(open('AIDNIndustrySearchAll.txt', 'r'))

# create a generator that returns actual href entries
links = (x.get('href') for x in soup.find_all('a'))

# filter the links to only those that contain "V" and store it as a 
# set to remove duplicates
selected = set(a for a in links if "V" in a)

# build output string using selected links
output = "\n".join('http://www.aidn.org.au/{0}'.format(a) for a in selected)

# write the string to file
with open('AIDNurl.txt', 'w') as f:
  f.write(output)

print output
print len(selected)  # print number of selected links 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:38:09.907

Find_all 返回所有元素的列表。如果你只想要第一个，你可以这样做： `for link in soup.find_all("a")[:1]:`. 目前尚不清楚为什么该列表是链接的副本。您可以使用打印语句来更好地了解代码。打印列表和列表长度等。也可以使用[pdb](http://docs.python.org/2/library/pdb.html)

# qt - 如何正确获取 QListView 的大小

> ID：13377082
> 
> 赞同：0
> 
> 时间：2012-11-14T10:30:55.417
> 
> 标签：qt, qlistview

我正在创建一个简单的小部件，其中包含一个带有图标的 qlistview 和一个 QSlider。小部件是使用 Qt 设计器创建的。我想要做的是让我的图标完全适合 QListView 的高度，以便我有一行图标。我试图通过使用从 QWidget 继承的函数来读取 qlistview 的高度，但我不断得到一个始终小于 QListView 实际大小的值。关于这种行为的任何提示？

我在下面给出我的部分代码。

表单的构造函数：

```
SliderWithButtons::SliderWithButtons(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::SliderWithButtons)
{
    ui->setupUi(this);

    //ui->commandListView->setStyleSheet(" QListView { background-color: lightgray }");
    ui->commandListView->setViewMode(QListView::IconMode);
    ui->commandListView->setFlow(QListView::LeftToRight);
    ui->commandListView->setWrapping(true);
    ui->commandListView->setMovement(QListView::Static);
    ui->commandListView->setResizeMode(QListView::Adjust);
    ui->commandListView->setLayoutMode(QListView::SinglePass);

    **mIconWidth = ui->commandListView->geometry().height();
    mIconHeight = mIconWidth;**

    ui->commandListView->setGridSize(QSize(mIconWidth,mIconHeight));
    ui->commandListView->setIconSize(QSize(mIconWidth,mIconHeight));

    **iconList = new IconList(this,mIconWidth, mIconHeight);**
    iconList->addIcons();

    ui->commandListView->setModel(iconList);
} 
```

我的模型的数据函数：

```
QVariant IconList::data(const QModelIndex &index, int role) const
{
    if (!index.isValid())
        return QVariant();

    if (role == Qt::DecorationRole)
        return QIcon(mIcons.value(index.row()).scaled(mIconWidth, mIconHeight,
                         Qt::KeepAspectRatio, Qt::SmoothTransformation));

    return QVariant();
} 
```

该小部件在垂直布局中仅包含一个 QListView 和一个 QSlider。问题是对 ui->commandListView->geometry().height() 的调用没有给出真正的 qlistview 高度，我也尝试过 ui->commandListView->height() 或 ui->commandListView->frameGeometry( ）。高度（）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:45:34.213

我实际上已经找到了解决方案。在您网站的另一篇文章中，我发现布局中小部件的大小仅在它们显示在屏幕上之前不久计算。所以我重写了 showEvent() 函数，并在 showEvent 函数中初始化了 QListView 和模型中图标的大小。我还使用一个布尔值来确保我只为第一个 showEvent() 执行此操作。没有更优雅的解决方案吗？

# php - 上传、创建新目录、获取本地 url、设置字段 - PHP + MySQL

> ID：13377084
> 
> 赞同：0
> 
> 时间：2012-11-14T10:31:07.823
> 
> 标签：php, mysql

我在整个互联网上搜索了这个。但是，我无法得到答案。我还是个初学者，还在学习php+Mysql。

我创建了一个包含图片、人名的表单。单击“提交”按钮后，php 和 mysql 脚本将在本地文件夹 (public_html/images/$name/) 中创建一个新目录。图像文件夹中新创建的文件夹应命名为人名（不带空格）。然后，将获取文件夹地址并将其放入 phpMyAdmin 表中的列中。例如，一个名叫比尔的人在表格中填写了他的数据。他上传了他的照片 (rockstar.jpg) 并在表单名称字段中输入了他的名字“Bill Fish”。然后，在他提交之后，脚本将创建一个新文件夹（/images/Bill_Fish/）并将他的图片（rockstar.jpg）放入其中。之后，文件夹地址 (/images/Bill_Fish/rockstar.jpg) 将被放入 phpMyAdmin 表的列中的文本字段中。

form_post.php 代码

```
 $name= $_POST["name"];

            $file= "images/$name/";

            **I'm stuck here** 
```

form.php 代码

```
 <tr>
              <td colspan="2"><input name="pic" type="file" id="pic" /></td>
            </tr>
            <tr>
              <td width="132"><span class="order">Name: </span></td>
              <td><span class="order">
                <input type="text" name="name" id="name" />
              </span></td>
            </tr> 
```

谁能帮我写这个脚本？很抱歉要求脚本，但我在网上搜索了所有内容，但无法得到答案。

非常感谢。非常感谢您的帮助：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:47:01.940

我想给出两个想法：

1.  如果用户可以输入或多或少的任何内容作为名称，仅仅替换下划线的空格可能是不够的。我建议使用适当的编码`url_encode()`，`url_decode()`因为路径的行为接近 url。想想像“Jon O'Hara”或“Nguy§/../äßt*+'s”这样的名字正在输入......
2.  通常您的任务解决方式不同：您为用户创建一个数据库条目，为该条目生成一个 id。通常这是一个自动递增的数字索引，这样您就可以避免两个帐户共享相同名称（发生...）和“外来字符”的问题。你拿*那个*id 作为要创建的目录的名称。这样以后很容易再次找到该文件夹​​。当您在数据库中识别出正确的条目时，您可以构建文件夹路径而无需存储它。这也有一个优点，即您要逐步生成的文件夹结构不是硬编码的。相反，您可能会得出要重组它的结论。通过重建路径，您只需更改重建算法，而在存储最终路径时，您必须更改数据库中的所有路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:42:30.450

```
$name= $_POST["name"];
$name = str_replace(' ', '_', $name); // replace space with underscore

$file= "images/".$name."/";
mkdir($file);

$filename = $_FILES['pic']['name']; // getting name of file being uploaded. Eg - rockstar
$ext = pathinfo($filename,PATHINFO_EXTENSION); // getting extension of file being uploaded
$destination = $file.$filename.'.'.$ext; // this will be images/Bill/rockstar.jpg

if(move_uploaded_file($_FILES['pic']['tmp_name'], $destination))
{
   echo 'File uploaded successfully';
}
else
{
   echo $_FILES['pic']['error'];
} 
```

请注意，这是为您提供有关文件上传的一般概念。当然，应采取措施确保只上传图片、文件大小限制等。

忘了`mkdir`。感谢 Tiit 提出这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:46:43.360

首先：表格应该有`enctype`上传文件的权限：

```
<form enctype="multipart/form-data" action="form_post.php" method="POST">
<input name="name" type="text"><br />
<input name="pic" type="file" /><br />
<input type="submit" value="Upload File" />
</form> 
```

其次让我们看看 PHP 方面。要获取文件数据，您必须查看 $_FILES 数组。有关图像的所有信息都将在`$_FILES['pic']`. 在该数组中有像“name”（文件名）和“tmp_name”（上传文件的临时名称）这样的元素。

您要执行以下操作： 创建文件夹：

```
$name = str_replace(" ","_",$_POST['name']); // replace space with an underscore
$dir = "images/".$name;
mkdir($dir); 
```

将临时文件移动到正确的文件夹：

```
$tmp_name = $_FILES['pic']['tmp_name'];
$name = $_FILES['pic']['name'];
move_uploaded_file($tmp_name, $dir."/".$name); 
```

并且您应该拥有自己描述的解决方案。

# javascript - Javascript 切片字符串

> ID：13377086
> 
> 赞同：-2
> 
> 时间：2012-11-14T10:31:14.290
> 
> 标签：javascript, string

> **可能重复：**
> [如何使用 JavaScript 拆分此字符串？](https://stackoverflow.com/questions/96428/how-do-i-split-this-string-with-javascript)

在我的 Rails 应用程序中，我正在连接字符串并通过 ajax 技术将其发送到 javascript。但是为了提高速度，我考虑了一种方法......非常简单，我需要将我的字符串切成三个变量：我的字符串看起来是这样的：

```
5.21o-o11.0o-o4 
```

那么如何将其切片

```
5.21

11.0

4 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:33:47.653

您可以使用`split`方法：

```
var arr = '5.21o-o11.0o-o4'.split('o-o') // [ "5.21" , "11.0", "4" ] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:34:00.493

假设`o-o`是分隔符，用于`split()`将其放入数组中：

```
var foo = '5.21o-o11.0o-o4';
var values = foo.split('o-o');
alert(values[0]); // = 5.21 
alert(values[1]); // = 11.0
alert(values[2]); // = 4 
```

这显然是一个例子。通常，要获取值，您将根据需要遍历数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:34:36.123

使用`.split()`方法如下：

```
var text = "5.21o-o11.0o-o4​​";
var split = text.split("o-o");
alert(split[0] + ', ' + split[1] + ', ' + split[2]); 
```

这是一个[小提琴](http://jsfiddle.net/WHUzQ/) ​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T10:34:41.403

`split`使用返回具有值的数组尝试此代码

```
var str = '5.21o-o11.0o-o4';
var substr = str.split('o-o');

//substr[0] 5.21
//substr[1] 11
//substr[2] 4 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:34:49.510

`.split('o-o')`只需在字符串中添加一个

```
alert('5.21o-o11.0o-o4​​​'.split('o-o'));​​ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T10:35:59.857

像这样的东西？

```
var data ="5.21o-o11.0o-o4"; 
var spliced = data.split('o-o'); 
```

# android - 带有复选框的ListView在android中使用多选

> ID：13377090
> 
> 赞同：3
> 
> 时间：2012-11-14T10:31:24.557
> 
> 标签：android, listview, checkbox

这是我的代码，当我单击按钮“b”时，列表视图会为每个项目填充一个复选框，现在我想将带有复选框的项目签入另一个活动，我如何实现这一点，我走了一半我很困惑剩下的部分怎么做

这是我的代码 XML 文件：

```
<Button
    android:id="@+id/b"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Pick contact" />

<ListView
    android:choiceMode="multipleChoice"
    android:id="@+id/lv"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

这是java代码：

```
import java.util.ArrayList;
import android.app.Activity;
import android.content.ContentResolver;
import android.database.Cursor;
import android.os.Bundle;
import android.provider.ContactsContract;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
 import android.widget.Button;
import android.widget.ListView;
import android.widget.Toast;

public class MainActivity extends Activity {
Button b;
int PICK_CONTACT;
ArrayList<String> al;
ArrayAdapter<String> aa;
ListView lv;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    b = (Button) findViewById(R.id.b);

    lv = (ListView) findViewById(R.id.lv);
    al = new ArrayList<String>();

    b.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {

            displaycontacts();
            System.out.println("size" + al.size());
            aa = new ArrayAdapter<String>(MainActivity.this,
                        android.R.layout.simple_list_item_multiple_choice, al);
            lv.setAdapter(aa);

        }
    });

    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int position ,long arg3) 
        {

            //here i should get the item which is checked
        }
    });

}

public void displaycontacts() {
    try {
        ContentResolver cr = getContentResolver();
        Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI, null,
                null, null, null);

        if (cur.getCount() > 0) {
            while (cur.moveToNext()) {

                String name = cur
                        .getString(cur
                                .getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
                if (Integer
                        .parseInt(cur.getString(cur
                                .getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER))) > 0) {
                    System.out.println("name : " + name);
                    al.add(name);

                }
            }

        }

    } catch (Exception e) {
        System.out.println("Error:::::::::::::::::::" + e);
    }

}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T10:43:44.000

尝试此链接以获取具有多项选择的列表视图。[http://android-coding.blogspot.in/2011/09/listview-with-multiple-choice.html](http://android-coding.blogspot.in/2011/09/listview-with-multiple-choice.html)。让我知道您的问题是否已解决？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:13:08.683

您需要比显示名称更多的信息来识别联系人。因此，请考虑使用 CursorAdapter 来获取并保留该信息。

如果您正在使用联系人，您可能希望使用[ContactsContract.ContactsColumns.LOOKUP_KEY](https://developer.android.com/reference/android/provider/ContactsContract.ContactsColumns.html#LOOKUP_KEY)来识别联系人。在这种情况下...

*   使用[ListView.getCheckedItemPositions()](http://developer.android.com/reference/android/widget/AbsListView.html#getCheckedItemPositions%28%29)获取选中项的位置
*   然后 ListView.getItemAtPosition(int) 让光标移动到那个位置
*   获取联系人的查找值

    ```
    cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY)); 
    ```

*   并将查找值的数组/列表放在用于启动活动的意图的附加部分中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-27T17:26:57.000

试试这个例子，你需要：

*   界面
*   数据（字符串文本，选择布尔值）
*   适配器
*   片段或活动
*   list_item.xml

您可以从数据开始：

```
public class MultipleData {
    private String text;
    private boolean selected;

    public MultipleData(String text, boolean selected) {
        this.text = text;
        this.selected = selected;
    }

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    }

    public boolean isSelected() {
        return selected;
    }

    public void setSelected(boolean selected) {
        this.selected = selected;
    }
} 
```

list_item.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:id="@+id/list_item_text"
        android:layout_width="match_parent"
        android:layout_height="90dp"
        android:text="@string/app_name"
        android:layout_toLeftOf="@+id/list_item_check_button"
        android:gravity="center"/>

    <RadioButton
        android:id="@+id/list_item_check_button"
        android:layout_width="wrap_content"
        android:layout_height="90dp"
        android:layout_alignParentRight="true"
        android:checked="false"
        android:clickable="false"
        android:focusable="false" />

</RelativeLayout> 
```

活动邮件.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".MainActivity">

        <ListView
            android:id="@+id/fragment_multiple_list_view"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

</RelativeLayout> 
```

适配器

```
public class MultipleAdapter extends BaseAdapter implements SelectedIndex {

    private final Context mContext;
    List<MultipleData> mList;

    @Override
    public void setSelectedIndex(int position) {

        if (mList.get(position).isSelected()) {
            mList.get(position).setSelected(false);
        } else {
            mList.get(position).setSelected(true);
        }
    }

    static class ViewHolder {
        TextView mTextView;
        RadioButton mRadioButton;
    }

    public MultipleAdapter(Context context, List<MultipleData> list) {
        this.mContext = context;
        this.mList = list;
    }

    @Override
    public int getCount() {
        return mList.size();
    }

    @Override
    public Object getItem(int position) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View rowView = convertView;

        if (rowView == null) {
            LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            rowView = inflater.inflate(R.layout.list_item, null);

            ViewHolder viewHolder = new ViewHolder();
            viewHolder.mTextView = (TextView) rowView.findViewById(R.id.list_item_text);
            viewHolder.mRadioButton = (RadioButton) rowView.findViewById(R.id.list_item_check_button);

            rowView.setTag(viewHolder);
        }

        // fill data
        ViewHolder holder = (ViewHolder) rowView.getTag();
        holder.mTextView.setText(mList.get(position).getText());
        holder.mRadioButton.setChecked(mList.get(position).isSelected());

        return rowView;
    }

} 
```

界面

```
public interface SelectedIndex {
    void setSelectedIndex(int position);
} 
```

在您的片段或活动中：

```
public class MultipleFragment extends Fragment implements AdapterView.OnItemClickListener {

    MultipleAdapter mAdapter;

    public MultipleFragment() {
        // Required empty public constructor
    }

    public static MultipleFragment newInstance() {
        return new MultipleFragment();
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        View view = inflater.inflate(R.layout.fragment_multiple, container, false);
        ListView listView = (ListView) view.findViewById(R.id.fragment_multiple_list_view);

        MultipleData android = new MultipleData("Android", false);
        MultipleData iPhone = new MultipleData("iPhone", false);
        MultipleData windowsMobile = new MultipleData("WindowsMobile", false);

        MultipleData blackberry = new MultipleData("Blackberry", false);
        MultipleData webOS = new MultipleData("WebOS", false);
        MultipleData ubuntu = new MultipleData("Ubuntu", false);

        MultipleData windows7 = new MultipleData("Windows7", false);
        MultipleData max = new MultipleData("Max OS X", false);
        MultipleData linux = new MultipleData("Linux", false);

        MultipleData os = new MultipleData("OS/2", false);
        MultipleData symbian = new MultipleData("Symbian", false);

        List<MultipleData> list = new ArrayList<>();
        list.add(0, android);
        list.add(1, iPhone);
        list.add(2, windowsMobile);

        list.add(3, blackberry);
        list.add(4, webOS);
        list.add(5, ubuntu);

        list.add(6, windows7);
        list.add(7, max);
        list.add(8, linux);

        list.add(9, os);
        list.add(10, symbian);

        mAdapter = new MultipleAdapter(getActivity(),list);
        listView.setAdapter(mAdapter);
        listView.setOnItemClickListener(this);
        return view;
    }

    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long l) {
        mAdapter.setSelectedIndex(position);
        mAdapter.notifyDataSetChanged();
    }
} 
```

[您可以在GitHub](https://github.com/CabezasGonzalezJavier/NotifyDataSetChanged)和此[博客](http://thedeveloperworldisyours.com/android/notifydatasetchanged/#sthash.0gtf6DnK.6XtHWUiF.dpbs)中查看此示例

# java - 客户端确认后 JMS 主题上的消息可用性？

> ID：13377092
> 
> 赞同：2
> 
> 时间：2012-11-14T10:31:33.737
> 
> 标签：java, jms, message-queue, jms-topic

我有一个简单的场景，发布者（我的 java 应用程序）在主题上发布消息。50 个客户端订阅了同一个 JMS 主题。一旦在主题上发布消息，所有 50 个订阅者都会收到通知。假设只有一个订阅者（0ut 0f 50）处理消息并在处理后发送确认。（一旦这个客户端处理完成后，我可以在 apache MQ 控制台上看到该消息已被消费。否则，如果在收到消息后没有客户端发送确认，我会将消息视为待处理消息）。

现在的问题是，一旦任何客户端发送确认并且任何新客户端订阅主题，他会收到有关消息的通知吗？或者它以任何客户端已使用消息的方式工作（这在内部意味着任何客户端已发送确认），不会向任何新订阅者发送进一步的通知，并且将从主题中删除消息（这是我正在经历的行为，但根据[http://en.wikipedia.org/wiki/Java_Message_Service](http://en.wikipedia.org/wiki/Java_Message_Service)下的发布/订阅模型，它看起来不应该以这种方式工作）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T04:49:56.230

我没有使用过 Apache MQ。但总的来说：

在发布/订阅模型中，当消息发布时，所有订阅者都将收到该发布。

订阅者仅向消息传递提供者而非发布者确认。当订阅者确认收到消息时，消息提供者会删除该消息，以便不再传递该消息。

如果在某个主题上发布消息后有新订阅者加入，则订阅者将不会获得该发布。订阅者将收到有关该主题的任何新出版物。像 IBM WebSphere MQ 之类的一些提供程序具有称为“保留发布”的功能，其中缓存了发布的副本。在发布后加入的任何新订阅者都将收到此缓存的发布。保留发布功能在主题发布之间存在时间延迟时很有用，新订阅者将立即获得缓存的发布，而不是等待发布者发布新发布。

# javascript - 如何在Angular Js中的指令值中执行Angular Expressions值

> ID：13377095
> 
> 赞同：3
> 
> 时间：2012-11-14T10:31:52.713
> 
> 标签：javascript, angularjs

如何在 Angular Js 中的 Directives 值中执行 Angular Expressions 值。 **{{user.name}}**正在工作。但是当我在指令（ ng-init ）中使用它时，它就不起作用了。

```
ng-init="formData.id='{{user.name}}'" 
```

还是有什么其他方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T13:05:29.813

顾名思义，该`ngInit`指令执行初始化任务，例如，如果要设置用户的姓名和年龄数据，可以执行以下操作：

```
<div ng-init="user.name='John'; user.age=50"> 
```

这是在 Angular 开始引导您的应用程序和编译模板之前执行的。双花括号包围的表达式`{{ }}`是告诉 Angular 评估表达式并产生输出的绑定，因此如果您想显示先前初始化的数据，只需将它们添加到您的文档中，如下所示：

```
<body ng-app>
    <div ng-init="user.name='John'; user.age=50">
      {{user.name}} is {{user.age}} years old.
    </div>
</body> 
```

​在这里查看非常基本的示例：http: [//jsfiddle.net/j9Nfd/](http://jsfiddle.net/j9Nfd/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T12:50:19.410

指令表达式是表达式，所以只需使用

```
ng-init="formData.id = user.name" 
```

# asp.net - SQL慢插入

> ID：13377100
> 
> 赞同：1
> 
> 时间：2012-11-14T10:32:15.600
> 
> 标签：asp.net, sql, sql-server

我有一个 ASP.NET 应用程序，它采用存储在 XML 中的一堆数据集并将它们扩展为 SQL，在扩展过程中它执行大量插入。

这些插入需要相当长的时间，现在我要公开承认我的 SQL 技能不是很好，所以我的诊断方法可能看起来有点粗糙。

在 SQL Server Management Activity Monitor 上，处理器时间大约为 3%，服务器上的实际 CPU 使用率也在这个范围内，因此代码没有完全运行，有 0 个等待任务，并且 I/O 稳定0.3MB/秒，批处理请求大约 180/秒

在资源等待中，Logging 的等待时间约为 900 毫秒，这导致我转向慢速磁盘，我将日志文件移动到另一组主轴，这将我的批处理请求增加到 260/秒，但它肯定不是全力以赴。

我是否认为它的磁盘导致了这个盒子的缓慢并且除了新服务器（它是一个带有 UW320 磁盘的旧 HP DL385 双 CPU）之外，一切基本上都在耐心等待它打开磁盘有没有办法加快插入速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T09:02:59.083

对于 SQL Server 的大量插入，您确实应该根据`SqlBulkCopy`您的要求使用。

这是一个小例子。

```
// Set up your target fields and types
Dictionary<string, string> uploadFields = new Dictionary<string, string>()
{
    { "LocationId", "System.Int32" },
    { "CalendarDate", "System.DateTime" },
    { "IsWorkingDay", "System.Boolean" },
    { "SnapshotDate", "System.DateTime" }
};

// Set up a DataTable to hold the stuff we want to send.
DataTable   massUpdate  = new DataTable();

// Use the dictionary above to set up columns
uploadFields
  .Keys
  .ToList()
  .ForEach(k => massUpdate.Columns.Add(k, Type.GetType(uploadFields[k])));

// Populate your datatable
foreach ( var thing in things )
{

   DataRow row = massUpdate.NewRow();

   row["LocationId"]       = thing.Id;
   row["CalendarDate"]     = thing.Date;
   row["IsWorkingDay"]     = thing.IsWorkingDay;
   row["SnapshotDate"]     = DateTime.UtcNow;

   massUpdate.Rows.Add(row);
}

// Finally, send the contents of the DataTable up via SqlBulkCopy.
// GetConnectionString
using (SqlConnection conn = new SqlConnection("Your connection string"))
{
  using (SqlBulkCopy copy = new SqlBulkCopy(conn))
  {
    conn.Open();

    foreach (var key in uploadFields.Keys)
    {
      copy.ColumnMappings.Add(key, key);
    }

    // Swap this table name with yoyr own.
    copy.DestinationTableName = "DestinationTableName";
    copy.WriteToServer(massUpdate);
    conn.Close();
  }
} 
```

文件：-

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:37:05.493

不完全熟悉您所处的环境，但可以进行交易吗？如果是这样，您可以通过首先启动事务，然后执行一堆 INSERT，然后结束事务来大大加快 INSERT。否则，每个 INSERT 都作为自己的事务运行，因此围绕它进行大量处理只是为了完成它。

# python - 使用 mod_wsgi 的 HTTP 基本身份验证

> ID：13377103
> 
> 赞同：2
> 
> 时间：2012-11-14T10:32:26.870
> 
> 标签：python, apache, wsgi, bottle

我正在尝试使用我编写的以下装饰器对 bottle.py 进行 HTTP 基本身份验证：

```
def check_auth(username, password):
if username == 'admin' and password == 'pass':
    return True
else:
    return False

def authenticate(msg_string = "Authenticate."):
response.content_type = "application/json"
message = {'message': msg_string}
resp = jsonpickle.encode(message)
response.status = "401 - Unauthorized"
response.headers['WWW-Authenticate'] = 'Basic realm="PyBit"'

return resp

def requires_auth(f):
def decorated(*args, **kwargs):
    print request.auth
    auth = request.auth
    if not auth: 
        return authenticate()
    elif not check_auth(auth[0],auth[1]):
        response.status = "401 - Unauthorized"
        return authenticate("HTTP Authentication Failed.")
    else:
        return f(*args, **kwargs)
return decorated 
```

它可以在内置的 wsgiref 服务器中运行，但当我使用 mod_wsgi 在 Apache 下运行我的应用程序时却不行。在这种情况下，“auth”对象始终为“None”。

阿帕奇在捏它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:44:42.393

没关系。排序它。默认情况下不传递授权标头。我们需要设置 WSGIPassAuthorization 指令来控制当等效的 HTTP 请求标头存在时，是否将 HTTP 授权标头传递给 WSGI 应用程序环境的 HTTP_AUTHORIZATION 变量中的 WSGI 应用程序。

# javascript - 在 AJAX 响应中将 HTML 标记显示为 HTML

> ID：13377104
> 
> 赞同：0
> 
> 时间：2012-11-14T10:32:27.570
> 
> 标签：javascript, ruby-on-rails, ajax

我有控制器方法：

```
def do_it
   @result = "some <b>another</b>"

   respond_to do | format |  
        format.js {render :layout => false}  
   end
end 
```

还有 do_it.js.erb：

```
$( "#in" ).html("<b>hello</b> <br /> <%= @result %>"); 
```

当我调用这个方法时，我会得到“你好”作为粗体文本，但“另一个”作为浏览器中带有标签的普通文本。

![在此处输入图像描述](../Images/fba7916334dd7d11e7e0f16244d83277.png)

我需要隐藏所有 html 标签并将“另一个”显示为粗体文本。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:50:47.057

<%= %> escapes the HTML code by default. You can prevent it from doing this by:

```
$( "#in" ).html("<b>hello</b> <br /> <%= raw @result %>"); 
```

or

```
@result = "some <b>another</b>".html_safe() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:50:11.323

我对 ruby​​ 不太了解，但我看到这篇文章可能与您的问题有关：

1- [rails：如何对字符串进行 html 编码/转义？有内置的吗？](https://stackoverflow.com/questions/692921/rails-how-to-html-encode-escape-a-string-is-there-a-built-in)

2-[如何在 Ruby 中编码/解码 HTML 实体？](https://stackoverflow.com/questions/1600526/how-do-i-encode-decode-html-entities-in-ruby)

我认为您应该对原始字符串进行 html 编码

```
@result = "some <b>another</b>" 
```

然后在显示时对其进行 html 解码。祝你好运

# java - 在java上交互端口usb

> ID：13377108
> 
> 赞同：1
> 
> 时间：2012-11-14T10:33:10.760
> 
> 标签：java, usb

我正在研究与 java 上的端口 usb 交互，我发现了两个库 JSR-80 和 jusb。你能告诉我哪个更好吗？或者是否存在任何其他？

注意：我在linux下工作

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:36:02.277

你可以试试[libusb](http://www.libusb.org/)

> libusb 是一个 C 库，可让应用程序轻松访问许多不同操作系统上的 USB 设备。libusb 是一个开源项目

查看[github 上的 libusb java 绑定](https://github.com/trygvis/javax-usb-libusb1)

或者有[usb4java](http://kayahr.github.com/usb4java/)，其中低级部分基于本机 libusb 0.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:57:53.487

两者都适用于 Linux，但对 Windows 有一些限制
[rxtx](http://ww6.rxtx.org/)是另一个非常好的库。无论如何，我建议你[这篇精彩的文章](http://today.java.net/pub/a/today/2006/07/06/java-and-usb.html)，你可以在其中看到两者的详细信息（JSR-80 和 JUSB）:)

# android - 想在亚马逊商店放一个apk

> ID：13377110
> 
> 赞同：2
> 
> 时间：2012-11-14T10:33:30.853
> 
> 标签：android, amazon-s3, google-play

我想将应用程序的 apk 文件放在亚马逊应用商店。关于这一点，我想知道一些与亚马逊应用商店相关的事情。

例如，一个人从 Google Play Store 下载“xyz”应用程序。然后他开始从亚马逊下载。因为包装是一样的。android会允许它在不同的应用商店安装相同的包吗？

我认为答案是否定的。但我不确定这一点。

如果答案是否定的。比我们必须用不同的包名构建apk？

如果答案是肯定的。而不是我们是否检查这个应用程序是从哪个商店下载的（因为我必须为 Google Play 商店和亚马逊实现不同的 inapp 方法）

# vba - VBA Microsoft Outlook 邮件处理 - 添加另一个案例

> ID：13377122
> 
> 赞同：2
> 
> 时间：2012-11-14T10:34:18.497
> 
> 标签：vba, outlook

在“ThisOutlookSession”中，我有这个捕获特定附件的子。我如何添加另一个条件，以便提取另一个特定的邮件和附件？

```
Private Sub Items_ItemAdd(ByVal item As Object)

    On Error GoTo ErrorHandler

    'Only act if it's a MailItem
    Dim Msg As Outlook.MailItem
    If TypeName(item) = "MailItem" Then
        Set Msg = item

        'Change variables to match need. Comment or delete any part unnecessary.
        If (Msg.SenderName = "Sender") And _
            (Msg.Subject = "Sub") And _
            (Msg.Attachments.Count >= 1) Then

            'Set folder to save in.
            Dim olDestFldr As Outlook.MAPIFolder
            Dim myAttachments As Outlook.Attachments
            Dim Att As String

            'location to save in.  Can be root drive or mapped network drive.
            Const attPath As String = "Z:\Folder\Folder\"

            ' save attachment
            Set myAttachments = item.Attachments
            Att = myAttachments.item(1).DisplayName
            myAttachments.item(1).SaveAsFile attPath & Att

            ' mark as read
            Msg.UnRead = False
        End If

    End If

ProgramExit:
    Exit Sub

ErrorHandler:
    MsgBox Err.Number & " - " & Err.Description
    Resume ProgramExit
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T14:23:06.273

您可以使用[If-Then-Else 语句](http://msdn.microsoft.com/en-us/library/752y8abs.aspx)或[Case 语句](http://msdn.microsoft.com/en-us/library/cy37t14y.aspx)在 VBA 代码中执行条件分支。下面提供了来自前面的 MSDN 链接的示例。

### If-The-Else 语句

```
If dayW = DayOfWeek.Wednesday Then 
    If hour = 14 Or hour = 15 Then 
        Return True 
    Else 
        Return False 
    End If 
ElseIf dayW = DayOfWeek.Thursday Then 
    If hour = 12 Then 
        Return True 
    Else 
        Return False 
    End If 
Else 
    Return False 
End If 
```

### 案例陈述

```
Select Case number
    Case 1 To 5
        Debug.WriteLine("Between 1 and 5, inclusive")
        ' The following is the only Case clause that evaluates to True. Case 6, 7, 8
        Debug.WriteLine("Between 6 and 8, inclusive")
    Case 9 To 10
        Debug.WriteLine("Equal to 9 or 10")
    Case Else
        Debug.WriteLine("Not between 1 and 10, inclusive")
End Select 
```

如果您的计算机没有打开，那么您的 VBA 代码将永远不会被执行。

# android - 如何在Android中viewpager的不可见片段中执行功能

> ID：13377126
> 
> 赞同：1
> 
> 时间：2012-11-14T10:34:32.107
> 
> 标签：android, android-asynctask, android-fragments

我有两个片段 Fragment1 和 Fragment2。当我启动应用程序时，两个片段中定义的函数都会被执行。所以启动需要很长时间（因为 XML 解析和列表视图的填充都在两个片段上执行）。我需要减少应用程序的启动时间。他们有什么方法可以在启动时执行 Fragment1，而将 Fragment2 的执行带到后台？这样用户就可以与 Fragment1 进行交互，而 Fragment2 在不打扰用户的情况下执行其功能。

这是我的代码，

片段1=>

```
 public class Fragment1 extends Fragment{

public static String feedurl="http://www.abcd.com/en/rssfeeds/1_2_3_5/latest/rss.xml";
static String URL = "";
static final String KEY_HEAD = "item"; // parent node
static final String KEY_DATE = "pubDate";
public static String headflag="";
int f=0;
GridView list;
HeadlinesAdapter adapter;
private TextView mMessageView;
private Button mClearButton;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.first_fragment, container, false);

    return v;
}

@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);

    headlines.parse();
    populate_listview();

    }

 public void populate_listview()
 {

     URL="http://www.abcd.com/en/rssfeeds/1_2_3_5/latest/rss.xml";
     ArrayList<HashMap<String, String>> newsList = new ArrayList<HashMap<String, String>>();

    XMLParser parser = new XMLParser();
    String xml = parser.getXmlFromUrl(URL);
    Document doc = parser.getDomElement(xml);
    NodeList nl = doc.getElementsByTagName(KEY_HEAD);
    NodeList itemLst = doc.getElementsByTagName("item");
    String MarqueeStr="";

    for (int i = 0; i < nl.getLength(); i++) {
        HashMap<String, String> map = new HashMap<String, String>();
        Element e = (Element) nl.item(i);
                    newsList.add(map);

 }
    list=(GridView)getActivity().findViewById(R.id.grid);
    adapter=new Adapter1(getActivity(), newsList);        
            list.setAdapter(adapter);

  } 
```

片段2=>

```
 public class Fragment2 extends Fragment{

public static String feedurl="http://www.abcd.com/en/rssfeeds/1_2_3_5/latest/rss.xml";
static String URL = "";
static final String KEY_HEAD = "item"; // parent node
static final String KEY_DATE = "pubDate";
public static String headflag="";
int f=0;
GridView list;
HeadlinesAdapter adapter;
private TextView mMessageView;
private Button mClearButton;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.second_fragment, container, false);

    return v;
}

@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);

    sports.parse();
    populate_listview();

    }

 public void populate_listview()
 {

     URL="http://www.abcd.com/en/rssfeeds/1_2_3_5/latest/rss.xml";
     ArrayList<HashMap<String, String>> newsList = new ArrayList<HashMap<String, String>>();

    XMLParser parser = new XMLParser();
    String xml = parser.getXmlFromUrl(URL);
    Document doc = parser.getDomElement(xml);
    NodeList nl = doc.getElementsByTagName(KEY_HEAD);
    NodeList itemLst = doc.getElementsByTagName("item");
    String MarqueeStr="";

    for (int i = 0; i < nl.getLength(); i++) {
        HashMap<String, String> map = new HashMap<String, String>();
        Element e = (Element) nl.item(i);
                newsList.add(map);

 }
    list=(GridView)getActivity().findViewById(R.id.grid2);
    adapter=new HeadlinesAdapter(getActivity(), newsList);        
            list.setAdapter(adapter);

  } 
```

主要活动=>

```
 public class MainActivity extends FragmentActivity {

private ViewPager mViewPager;
private MessageLoader mLoader;
private Button mSenderButton, mReceiverButton;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    // We get UI references
    mViewPager = (ViewPager) findViewById(R.id.viewPager);
    mSenderButton = (Button) findViewById(R.id.sender_button);
    mReceiverButton = (Button) findViewById(R.id.receiver_button);
    // set pager adapter
    mViewPager.setAdapter(new MyAdapter(this));
    // set receiver button listener
    mReceiverButton.setOnClickListener(new OnClickListener() {          

        public void onClick(View v) {
            mViewPager.setCurrentItem(1);
        }
    });

    mSenderButton.setOnClickListener(new OnClickListener() {            

        public void onClick(View v) {
            mViewPager.setCurrentItem(0);
        }
    });
}

private class MyAdapter extends FragmentPagerAdapter{

    private Context mContext;
    private String[] frags = {Fragment1.class.getName(), Fragment2.class.getName()};

    public MyAdapter(FragmentActivity activity) {
        super(activity.getSupportFragmentManager());
        mContext = activity;
    }

    @Override
    public Object instantiateItem(ViewGroup container, int position) {
        Fragment frag = (Fragment) super.instantiateItem(container, position);
        if(frag instanceof MessageLoader){
            mLoader = (MessageLoader) frag;
        }
        return frag;
    }

    @Override
    public Fragment getItem(int pos) {
        return Fragment.instantiate(mContext, frags[pos]);
    }

    @Override
    public int getCount() {
        return frags.length;
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:52:51.943

这与您的其他问题有关：

> 他们有什么方法可以在应用程序启动时停止执行 Fragment2。我只有在滑动到 Fragment2 时才需要启动它

不，你不应该首先尝试这样做。`ViewPager`需要第二个（`Fragment`尚不可见）处于良好状态，以便用户可以在选择时立即滑动到它。如果这`Fragment`不会被构建，那么用户体验将会很差，尤其是在您从`Url`主`UI`线程上解析一些 xml 的情况下。如果您想提高应用程序的速度并避免可能的 ANR，您应该真正考虑在后台线程上进行 xml 解析。

> 我想在启动时调用“function1”，只有在滑动到 Fragment2 时才调用“function2”

保持`Fragment`1 不变（调用您希望调用的方法），然后`OnPageChangeListener`在`ViewPager`. 我假设您使用自定义`FragmentPagerAdapter`，因此您可以获得对第二个的引用`Fragment`并直接调用该`populate_listview()`方法：

```
@Override
public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
      Fragment2 = (Fragment2) getSupportFragmentManager()
                    .findFragmentByTag(
                            "android:switcher:" + R.id.viewPager + ":" + 1);
      if (fragment != null) {
        fragment.populate_listview();// remove the call from onViewCreated
      }
} 
```

但这只是一个黑客。您要做的是使用后台线程（`AysncTask`或普通线程）进行长时间操作。看看这个[博客条目](http://android-developers.blogspot.ro/2009/05/painless-threading.html)。

# android - Android：当应用程序在后台运行时如何访问相机捕获

> ID：13377136
> 
> 赞同：1
> 
> 时间：2012-11-14T10:34:55.723
> 
> 标签：android, android-camera, video-capture, image-capture

我一直在寻找这个来实现我的应用程序。据我所知，我可以使用广播接收器来监听相机捕获。但我需要有关捕获的图像或视频的更多具体信息。我在 stackoverflow 找到的广播接收器代码也只是 XML .

想象一下，我们有一个工作和监听摄像头的程序。关闭我们的应用程序。仍在后台工作。打开 android 摄像头（不是来自我们的应用程序）。然后点击捕获按钮。等待保存图片。现在，有 2这里的情况。

**第一个是，如果有可能我们应该看到一个窗口包括“写一些标签EditText”或“不要再显示这个复选框”。**

**第二是，我们应该得到新捕获的图片的路径。**

因此，如何在图片保存事件和捕获按钮之间使用后台工作应用程序作为服务进行访问？如果只有 xml 方式可以做到这一点，你能解释一下如何用广播接收器访问图片的路径吗？

先感谢您。

# jquery - MVC3 中的 jQuery Ajax POST

> ID：13377139
> 
> 赞同：1
> 
> 时间：2012-11-14T10:35:02.837
> 
> 标签：jquery, ajax, asp.net-mvc-3, post

当我使用 jQuery.ajax 和 POST 方法从数据库中删除一个项目时，我收到此错误：

```
GET Http://localhost:54010/Admin/Category/Delete?id=77 404 Not Found 
```

CategoryController 中的操作：

```
[HttpPost]
public ActionResult Delete(int id) {
  try {
    db.CategoryRepository.Delete(id);
    db.Save();
    return Json(new {Result = "OK"});
  } catch (Exception ex) {
    return Json(new { Result = "ERROR", Message = ex.Message });
  }
} 
```

看法：

```
<a id="delete-category" class="btn btn-small" href="#">
  <i class="icon-remove"></i>
  @Resource.delete
</a> 
```

JavaScript：

```
$(function () {
  $('#delete-category').click(function (event) {
    event.preventDefault();
    $.ajax({
      method: 'POST',
      url: '@Url.Action("Delete","Category")',
      dataType: 'json',
      data: { id: '@Model.CategoryModel.Id' },
      success: function (data, textStatus, jqXHR) {
        console.log("success");
      },
      error: function () {
        alert('error');
      }
    });
  });
}); 
```

为什么点击事件不生成POST？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T10:37:43.090

您需要通过设置参数告诉`ajax()`方法发出`post`请求：`type`

```
$.ajax({
    // method: 'POST', <-- remove this
    type: 'POST', // <-- add this
    url: '@Url.Action("Delete","Category")',
    dataType: 'json',
    data: { id: '@Model.CategoryModel.Id' },
    success: function (data, textStatus, jqXHR) {
        console.log("success");
    },
    error: function () {
        alert('error');
    }
}); 
```

# android - 是否可以在同一个界面中有两个微调器？

> ID：13377144
> 
> 赞同：0
> 
> 时间：2012-11-14T10:35:25.520
> 
> 标签：android, android-spinner

我试图在同一个界面中有 2 个微调器，但它不起作用。为什么 ？它只显示一个微调器。

一个从数据库`android:id="@+id/sp11"`中检索信息，另一个从字符串文件中检索信息`android:id="@+id/typeMessage_spinner"`。只有从数组@string 文件中检索的那个有效。如果我删除`android:id="@+id/typeMessage_spinner"`从数据库中检索的工作。并且在界面中只显示一个微调器。

像这样 [http://im13.gulfup.com/W1fV1.png](http://im13.gulfup.com/W1fV1.png)

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />

      <Spinner
        android:id="@+id/sp11"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:prompt="@string/chooseCourse"
        android:layout_marginTop="20dip"
        android:layout_marginLeft="8dip"
        android:layout_marginRight="8dip"
    />
          <Spinner
        android:id="@+id/typeMessage_spinner"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:prompt="@string/chooseCourse"
        android:layout_marginTop="20dip"
        android:layout_marginLeft="8dip"
        android:layout_marginRight="8dip"
    />

</RelativeLayout> 
```

这是我在`onCreate()`. 看看我的第一个微调器，`onPostExecute()`我有第二个微调器

```
 public class MainActivity extends Activity {
        JSONParser jParser = new JSONParser(); // class
        ArrayList<HashMap<String, String>> coursesList;

        private static String url_all_course = "http://10.0.2.2/SmsPhp/view_all_course.php";

        private static final String TAG_SUCCESS = "success";
        private static final String TAG_course = "course";
        private static final String TAG_CourseID = "CourseID";
        private static final String TAG_Name = "Name";
        JSONArray courses = null;
        // Spinner element
         SpinnerAdapter adapter,adapter1;
        Spinner spinner ,spinner1;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            coursesList = new ArrayList<HashMap<String, String>>();

            spinner= (Spinner) findViewById(R.id.typeMessage_spinner);
            spinner1= (Spinner) findViewById(R.id.sp11);
            // Create an ArrayAdapter using the string array and a default spinner layout
            ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource( MainActivity .this,
                    R.array.typeMessage_spinner, android.R.layout.simple_spinner_item);
            // Specify the layout to use when the list of choices appears
            adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
            // Apply the adapter to the spinner
            spinner.setAdapter(adapter);
            new LoadAllCourses().execute();

        }

        class LoadAllCourses extends AsyncTask<String, String, String> {

            @Override
            protected String doInBackground(String... args) {
                // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                // getting JSON string from URL
                JSONObject json = jParser.makeHttpRequest(url_all_course, "GET",
                        params);

                // Check your log cat for JSON response
                Log.d("All courses: ", json.toString());

                try {
                    // Checking for SUCCESS TAG
                    int success = json.getInt(TAG_SUCCESS);

                    if (success == 1) {
                        // course found
                        // Getting Array of course
                        courses = json.getJSONArray(TAG_course);

                        // looping through All courses
                        for (int i = 0; i < courses.length(); i++)// course
                                                                    // JSONArray
                        {
                            JSONObject c = courses.getJSONObject(i); // read first

                            // Storing each json item in variable
                            String CourseID = c.getString(TAG_CourseID);
                            String Name = c.getString(TAG_Name);

                            // creating new HashMap
                            HashMap<String, String> map = new HashMap<String, String>();

                            // adding each child node to HashMap key => value
                            map.put(TAG_CourseID, CourseID);
                            map.put(TAG_Name, Name);

                            // adding HashList to ArrayList
                            coursesList.add(map);
                        }
                    } else {

                    }

                } catch (JSONException e) {
                    e.printStackTrace();
                }

                return null;
            }

            /**
             * After completing background task Dismiss the progress dialog
             * **/
            protected void onPostExecute(String file_url) {
                // dismiss the dialog after getting all products

                adapter1 = new CustomAdapter(MainActivity.this,
                        android.R.layout.simple_spinner_item,
                        coursesList);

                 spinner1.setAdapter(adapter1); // Set the custom adapter to the spinner
                    // You can create an anonymous listener to handle the event when is selected an spinner item
                 spinner1.setOnItemSelectedListener(new CustomOnItemSelectedListener() {

                   /*    @Override
                       public void onItemSelected(AdapterView<?> adapterView, View view,
                                int position, long id) {
                            // Here you get the current item (a User object) that is selected by its position
                            ArrayAdapter<HashMap<String, String>> x = (ArrayAdapter<HashMap<String, String>>) adapter.getItem(position);
                            // Here you can do the action you want to...
                            Toast.makeText(MainActivity.this, "ID: "+  x ,
                                Toast.LENGTH_SHORT).show();
                        }*/
                        @Override
                        public void onNothingSelected(AdapterView<?> adapter) {  }
                    });
                }
            }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:44:03.543

您已将两个微调器定位在完全相同的位置。

尝试将一个微调器移到其他方向

```
<Spinner
    android:id="@+id/sp11"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:prompt="@string/chooseCourse"
    android:layout_marginTop="20dip"
    android:layout_marginLeft="8dip"
    android:layout_marginRight="8dip" />
<Spinner
    android:id="@+id/typeMessage_spinner"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:prompt="@string/chooseCourse"
 add ->  android:layout_below="@+id/sp11"
    android:layout_marginTop="20dip"
    android:layout_marginLeft="8dip"
    android:layout_marginRight="8dip" /> 
```

# javascript - 在 jQuery Mobile 中更改翻转切换开关中的选项文本

> ID：13377145
> 
> 赞同：2
> 
> 时间：2012-11-14T10:35:27.190
> 
> 标签：javascript, jquery, html, jquery-mobile

我在 jQuery Mobile 中有一个切换开关组件（[此处为 jsfiddle](http://jsfiddle.net/aD5xD/3/)）

```
<select name="toggle" id="toggle" data-role="slider">
    <option id="value1" value="off">value1</option>
    <option id="value2" value="on">value2</option>
</select> 
```

我希望能够在任何给定时刻以编程方式更改显示的文本。

例如，“value1”应该变成“newvalue1”，“value2”应该变成“newvalue2”。

此函数应该使用新值重新创建切换开关，但实际上它什么也不做：

```
function yourfunction() { 
    //alert ("Changing stuff");
    $('#value1').html ('newvalue1');
    $('#value2').html ('newvalue2');
    var myswitch = $("#toggle");
    myswitch.slider("refresh", true);
}
window.setInterval(yourfunction, 3000);​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:33:43.193

这对你有用吗？

*   [http://jsfiddle.net/aD5xD/13/](http://jsfiddle.net/aD5xD/13/)

JS

```
function yourfunction() { 
        //alert ("Changing stuff");
        $('.ui-slider-label-a').text('newvalue1');
        $('.ui-slider-label-b').text('newvalue2');
        var myswitch = $("#toggle");
        myswitch.slider("refresh", true);

    }
window.setInterval(yourfunction, 3000);​ 
```

jQM 为两个选项（`ui-slider-label-a`和`ui-slider-label-b`）添加一个类，通过使用这些类，您可以访问正确的元素并更改文本。

注意：查看 jQM 添加的附加标记的最佳方法是使用 Google Chrome（恕我直言）并检查元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:49:52.867

尝试`$('#value1').text('newvalue1');`代替`$('#value1').html('newvalue1');`

# json - 在 Windows 应用商店应用程序中通过 WCF 数据服务启用 OData Json

> ID：13377146
> 
> 赞同：3
> 
> 时间：2012-11-14T10:35:28.313
> 
> 标签：json, windows-8, wcf-data-services, odata

为了获得更高的性能和更好的服务消耗效率，我正在使我的 WCF 数据服务 OData 服务器和客户端使用 json 序列化而不是默认原子相互通信。

为了实现这一点，我正在修改我的 http 标头：

```
args2.RequestMessage.SetHeader("Accept", "application/json;odata=verbose"); 
```

我可以确认（使用 Fiddler）我的服务正在以 json 格式返回我的 odata 流。

但是，当我的 Windows 8 应用商店应用程序客户端处理我收到的响应时

**NotSupportedException** - Content-Type 标头当前不支持“application/json”

在线阅读了几篇文章，我使用的 WCF 数据服务版本似乎应该支持 json 序列化。

那么给了什么？是因为客户端忽略了使 WCF 数据服务 3.0 运行的“odata=verbose”属性吗？或者实际上 Windows.Store WCF 数据服务客户端服务库实际上不支持 json 格式？

任何帮助，将不胜感激。

谢谢，

# bash - tcsh 中的 IF 语句错误

> ID：13377152
> 
> 赞同：2
> 
> 时间：2012-11-14T10:35:47.343
> 
> 标签：bash, if-statement, tcsh

通过 tcsh 执行 IF 语句时遇到问题。这对我来说很好 -

```
#!/bin/bash
if echo `cal|tail -6|sed -e 's/^.\{3\}//' -e 's/.\{3\}$//' |tr -s '[:blank:]' '\n' | head -11|tail -10|tr -s '\n' ' '`|grep -w `date "+%e"`
then
        echo "present"
else
        echo "absent"
fi 
```

这就是问题 -

```
#!/bin/tcsh
if echo `cal|tail -6|sed -e 's/^.\{3\}//' -e 's/.\{3\}$//' |tr -s '[:blank:]' '\n' | head -11|tail -10|tr -s '\n' ' '`|grep -w `date "+%e"`
then
        echo "present"
else
        echo "absent"
endif 
```

收到此错误-

```
if: Expression Syntax.
then: Command not found. 
```

我真的需要使用“tcsh”来运行它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:49:52.547

首先，您必须知道可以找到两个不同的 shell 系列：

*   Bourne 类型的 shell（Bash、zsh...）
*   C 语法类型 shell (tcsh, csh...)

如您所见，Bash 和 tcsh 不是来自同一个 shell 系列。因此，在 tcsh 上，if 语句与 bash 语句有点不同。在您的情况下，关键字“then”放错了位置。尝试将其放在“if”行的末尾：

```
#!/bin/tcsh
if(echo `cal|tail -6|sed -e 's/^.\{3\}//' -e 's/.\{3\}$//' \
|tr -s '[:blank:]' '\n' | head -11|tail -10|tr -s '\n' ' '`| \
grep -w `date "+%e"`) then
     echo "present"
else
     echo "absent"
endif 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T20:43:45.307

之所以有效，`bash`是因为`if`POSIX 样式的 shell 中的语句总是通过执行命令来工作（而且它恰好`[`是命令的别名`test`）。

但是，`if`中的语句`tcsh`不是这样工作的。它们有自己的语法（在[`tcsh`手册页](http://man.cx/tcsh%281%29)中的表达式下描述）。

尝试自行运行管道，然后检查退出状态`if`：

```
cal | tail -6 | sed -e 's/^.\{3\}//' -e 's/.\{3\}$//' | tr -s '[:blank:]' '\n' | head -11 | tail -10 | tr -s '\n' ' ' | grep -w `date "+%e"` >/dev/null
if ( $? == 0 ) then
    echo "present"
else
    echo "absent"
endif 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-19T13:43:57.473

我通常会做这样的事情，保持条件语句简单。但是，您可以将变量填入“if”中，然后检查您的 grep 是否为空。

```
set present = `tail -6 .... | grep “”`

if ( $present != “” ) then
   echo “present”
else
   echo “not present”
endif 
```

您还可以使用“-x”来帮助调试#!/bin/tcsh -x。这么小的东西，检查变量的回声应该可以做到，但是“-x”可能会给你所有你需要的信息。

# android - 使用支持库 v4 修订版 11 的嵌套片段

> ID：13377157
> 
> 赞同：13
> 
> 时间：2012-11-14T10:36:04.067
> 
> 标签：android, android-fragments, android-viewpager, android-support-library, android-nested-fragment

从今天早上开始的支持库的最后一个版本（[Android Support Package v4 revision 11](http://developer.android.com/tools/extras/support-library.html#Notes)）应该支持嵌套片段。

在我的项目中，我有一个包含[ViewPager](https://developer.android.com/reference/android/support/v4/view/ViewPager.html)的片段，而这个 ViewPager 包含几个片段。

我打电话`getSupportFragmentManager()`而不是`getFragmentManager`使用支持库的[FragmentManager](https://developer.android.com/reference/android/support/v4/app/FragmentManager.html)。

问题是我仍然遇到崩溃，例如：

```
java.lang.IllegalStateException: Recursive entry to executePendingTransactions
    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1416)
    at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:461)
    at android.support.v4.app.FragmentPagerAdapter.finishUpdate(FragmentPagerAdapter.java:141)
    at android.support.v4.view.ViewPager.populate(ViewPager.java:1012)
    at android.support.v4.view.ViewPager.setCurrentItemInternal(ViewPager.java:523)
    at android.support.v4.view.ViewPager.setCurrentItemInternal(ViewPager.java:495)
    at android.support.v4.view.ViewPager.onRestoreInstanceState(ViewPager.java:1221)
    at android.view.View.dispatchRestoreInstanceState(View.java:11910)
    at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2584)
    at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2590)
    at android.view.View.restoreHierarchyState(View.java:11888)
    at android.support.v4.app.Fragment.restoreViewState(Fragment.java:417)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:933)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
    at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
    at android.os.Handler.handleCallback(Handler.java:615)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4745)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
    at dalvik.system.NativeStart.main(Native Method) 
```

有什么我做错了吗？或者支持不支持真正的嵌套片段？

我的交易就这么简单：

```
getSupportFragmentManager().beginTransaction()
                    .replace(R.id.content, new MyFragment()).commit(); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-20T04:58:38.680

尝试使用`getChildFragmentManager()`而不是`getSupportFragmentManager()`. 这应该有帮助

# box-api - 传输编码分块盒 API

> ID：13377164
> 
> 赞同：1
> 
> 时间：2012-11-14T10:36:21.173
> 
> 标签：box-api, chunked, transfer-encoding

我想知道Box.net 是否支持***-H "transfer-encoding: chunked" ？***

```
curl --verbose https://www.box.com/api/2.0/files/content -H "Authorization: BoxAuth api_key=zzgfxxxxxxxxxxxxxxxqnvucpz&auth_token=09ngxxxxxxxxxx3esvtx2" -H "transfer-encoding: chunked" -F filename=@Bike.pdf -F folder_id=436000003 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T05:59:03.380

Box 目前不支持分块上传，但我们确实计划在未来这样做。目前还没有明确的时间表来添加它。

# android - 如何在android代码和本机代码之间创建回调？

> ID：13377168
> 
> 赞同：7
> 
> 时间：2012-11-14T10:36:43.020
> 
> 标签：android, android-ndk, native-code

我需要在本机代码（c 语言代码）和 Android 代码之间创建回调。我写了 JNI 函数来`C code`像这样从 android调用

JNI代码在这里

```
#include <android/log.h>

void initSocket(); 

#ifdef __cplusplus
extern "C" {
#endif

  JNIEXPORT void JNICALL Java_org_pjsip_pjsua_pjsua_1appJNI_initSocket(JNIEnv *jenv, jclass jcls) {

    __android_log_write(ANDROID_LOG_INFO, " JNI CODE ", " APP INIT SOCKET");        
    initSocket();        
  }
} 
```

C 代码看起来像这样

```
void initSocket()
{
    /// some more stuff
    printf("  initSocket function ");           
}

static int worker_thread(void *unused)
{       
    /// some more stuff
    return 0;
}

pj_bool_t on_rx_data1(pj_stun_sock *stun_sock, void *pkt, unsigned pkt_len, const pj_sockaddr_t *src_addr, unsigned addr_len)
{      
    /// some more stuff    
    return PJ_TRUE;
}

pj_bool_t on_data_sent1 (pj_stun_sock *stun_sock, pj_ioqueue_op_key_t *send_key, pj_ssize_t sent)
{        
    /// some more stuff
    return PJ_TRUE;  
}
pj_bool_t on_status1(pj_stun_sock *stun_sock, pj_stun_sock_op op, pj_status_t status)
{        
    /// some more stuff
    returnsockaddress();            
    return PJ_TRUE;
}

char* returnsockaddress()
{     
    /// some more stuff   
    return ipinttostring(sock_address);
}

char* ipinttostring(unsigned int addr )
{       
    /// some more stuff
    return fullIP;
} 
```

这是我在 C 语言中使用的代码，`initSocket()`从 JNI 调用函数。现在我想在`callback`这段代码中调用函数`C code`时创建一个。`on_status1`这个 on_status1 将在几秒钟内重复，当它被调用时，我想在 android 代码中调用一个函数。

**编辑**

我试过这样，但没有成功

```
JNIEXPORT void JNICALL Java_org_pjsip_pjsua_pjsua_1appJNI_initSocket(JNIEnv *jenv, jobject obj) {

      __android_log_write(ANDROID_LOG_INFO, " JNI CODE ", " APP INIT SOCKET");            
      initSocket();             
      jclass cls = jenv->GetObjectClass(obj);
      jmethodID methodid = env->GetMethodID(cls, "callback", "()V");            
      if(!methodid) {
          return;
      }            
      jenv->CallVoidMethod(obj , methodid);            
  } 
```

我在android代码中被声明为这样的函数。

```
public static void callback(String value) {
    Log.e(TAG, "value:" + value);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T12:14:37.840

试试这个 ：

```
JNIEXPORT void JNICALL Java_org_pjsip_pjsua_pjsua_1appJNI_initSocket(JNIEnv *jenv, jobject obj) {
  __android_log_write(ANDROID_LOG_INFO, " JNI CODE ", " APP INIT SOCKET");            
  initSocket();             
  // jclass cls = (*jenv)->GetObjectClass(jenv, obj);
  // or something like this :
  jclass cls = (*jenv)->FindClass(jenv, "org/pjsip/pjsua/pjsua_appJNI"); 
  jmethodID methodid = (*jenv)->GetStaticMethodID(jenv, cls, "callback", "(Ljava/lang/String;)V");            
  if(!methodid) {
      return;
  }       
  jstring jstr = (*jenv)->NewStringUTF(jenv, "Hello from C"); 
  (*jenv)->CallStaticVoidMethod(jenv, cls, methodid, jstr); 
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:05:59.350

从java代码：

```
public static void callback(String value){
    Log.e(TAG, "value:"+value);
 } 
```

并调用C：

```
typedef struct JniSMSMethodInfo
{
    JNIEnv *    env;
    jclass      classID;
    jmethodID   methodID;
} JniMethodInfo;

extern "C"
{
static JNIEnv* getJNIEnv(void)
{

    JavaVM* jvm = cocos2d::JniHelper::getJavaVM();
    if (NULL == jvm) {
        LOGD("Failed to get JNIEnv. JniHelper::getJavaVM() is NULL");
        return NULL;
    }

    JNIEnv *env = NULL;
    // get jni environment
    jint ret = jvm->GetEnv((void**)&env, JNI_VERSION_1_4);

    switch (ret) {
        case JNI_OK :
            // Success!
            return env;

        case JNI_EDETACHED :
            // Thread not attached

            // TODO : If calling AttachCurrentThread() on a native thread
            // must call DetachCurrentThread() in future.
            // see: http://developer.android.com/guide/practices/design/jni.html

            if (jvm->AttachCurrentThread(&env, NULL) < 0)
            {
                LOGD("Failed to get the environment using AttachCurrentThread()");
                return NULL;
            } else {
                // Success : Attached and obtained JNIEnv!
                return env;
            }

        case JNI_EVERSION :
            // Cannot recover from this error
            LOGD("JNI interface version 1.4 not supported");
        default :
            LOGD("Failed to get the environment using GetEnv()");
            return NULL;
    }
}
// get class and make it a global reference, release it at endJni().
static jclass getClassID(JNIEnv *pEnv)
{
    jclass ret = pEnv->FindClass(CLASS_NAME);
    if (! ret)
    {
        LOGD("Failed to find class of %s", CLASS_NAME);
    }

    return ret;
}
static bool getStaticMethodInfo(JniMethodInfo &methodinfo, const char *methodName, const char *paramCode)
{
    jmethodID methodID = 0;
    JNIEnv *pEnv = 0;
    bool bRet = false;

    do 
    {
        pEnv = getJNIEnv();
        if (! pEnv)
        {
            break;
        }

        jclass classID = getClassID(pEnv);

        methodID = pEnv->GetStaticMethodID(classID, methodName, paramCode);
        if (! methodID)
        {
            LOGD("Failed to find static method id of %s", methodName);
            break;
        }

        methodinfo.classID = classID;
        methodinfo.env = pEnv;
        methodinfo.methodID = methodID;

        bRet = true;
    } while (0);

    return bRet;
}
void callback(char* value){
    JniMethodInfo methodInfo;
    if (! getStaticMethodInfo(methodInfo, "callback", METHOD_SIGNATURE))
    {            
        return;
    }

    jstring stringArg = methodInfo.env->NewStringUTF(value);
    methodInfo.env->CallStaticVoidMethod(methodInfo.classID, methodInfo.methodID, stringArg1);
    methodInfo.env->DeleteLocalRef(stringArg);
    methodInfo.env->DeleteLocalRef(methodInfo.classID);
}

} 
```

CLASS_NAME: / METHOD_SIGNATURE: 从文件 *.class 中查看

# php - php正则表达式用于：“和”之间的字符串

> ID：13377170
> 
> 赞同：1
> 
> 时间：2012-11-14T10:36:45.533
> 
> 标签：php, regex, preg-match-all

我正在尝试使用 preg_match_all 在 PHP 中的数组之间`:"`和数组中获取字符串。`"`

例如：

```
"I am a string"("string"):"Need this string", "I am a string"("string"):"Need this string", etc, etc 
```

我有以下内容，但它没有返回任何结果或错误，并且在我尝试过的正则表达式构建器中工作。

```
/\"\:"(.*?)\"/ and #/\"\:"(.*?)\"/# 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:49:00.510

表达式可以变得更简单，如下所示：

```
if (preg_match_all('/:"(.*?)"/', $str, $matches)) {
    // $matches[1] will contain all the strings you want
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:43:10.160

试试这个模式：

```
#:"([^"]*)"# 
```

# riak - 查找存储特定数据的节点/分区

> ID：13377174
> 
> 赞同：0
> 
> 时间：2012-11-14T10:36:49.917
> 
> 标签：riak

我是 riak 的新手，并试图发现它的潜力。目前我正在玩`N,R,W`设置以查看影响。我在这里想念的是检查哪些数据存储在哪个节点/分区上。

有没有办法问

*   只有一个节点，它存储哪些数据？
*   每个节点，谁存储我想要的特定数据？

因此，如果我可以获得像节点 2 和 3 这样的信息来存储我需要的数据，那么如果我在`stop`节点 2 和 3 中请求该数据将会失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:13:04.237

我不知道有任何标准方法可以准确找出特定记录存储在哪些节点上（但不排除存在一个）。然而，这通常不是人们需要关心的事情。

如果以有序的方式添加或删除节点，Riak 基于一致的散列以对用户透明的方式在物理节点上分布记录，并在集群中重新分配数据（以维护 n_val 副本）。

如果一个节点意外宕机，该节点上保存的数据的更改将在宕机期间被其他节点跟踪，并在它恢复时传递给该节点。

这意味着只要您根据对数据的一致性要求定义 N、R 和 W，即使添加或删除节点，Riak 也会努力保留这些。

通过这种方式，我相信 Riak 在某种程度上不同于依赖分片的数据库，因为那里的数据更多地与特定节点相关联，不一定会自动重新分配到其他节点/分片。

# cuda - 针对数组的标准化优化 Cuda 内核

> ID：13377176
> 
> 赞同：1
> 
> 时间：2012-11-14T10:37:02.787
> 
> 标签：cuda, gpgpu, gpu, pycuda

我正在尝试按如下方式规范化数组。

1.  选择数组的前两个元素，找到总和并使用该总和除以它们。
2.  对其余元素执行相同操作。

它工作正常。但是当我增加数组的维度时，时间复杂度就会出现。我在下面给出了我的代码。

```
import pycuda.driver as drv
import pycuda.autoinit
from pycuda.compiler import SourceModule
import numpy as np

mod=SourceModule("""
__global__ void addition(float* a,float* c,float* d)
{
int i=blockIdx.y*blockDim.y+threadIdx.y;
for (i=0;i<=4;++i)
{
    int sum=0.0;
    for (int j=0;j<=1;++j)
    {
        sum+=a[2*i+j];
    }
c[i]=sum;
}
for (i=0;i<=4;i++)
{
    for (int j=0;j<=1;++j)
    {
        d[2*i+j]=a[2*i+j]/c[i];
    }
}
}
""")

addition=mod.get_function("addition")
a=np.array([1,2,3,1,2,3,2,1]).astype(np.float32)
c=np.zeros_like(a)
d=np.zeros_like(a)
addition(drv.In(a),drv.InOut(c),drv.InOut(d),block=(1,8,1))
print d 
```

d 的结果是 [0.33333334 0.66666669 0.75 0.25 0.40000001 0.60000002 0.666666669 0.33333334]。任何人都可以提出一些优化代码的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T16:05:38.790

如果您的实际应用程序只是对 中的一对值求和`a`，将该总和存储在`c`其中，然后用总和对这对值进行归一化并将它们存储在 中`d`，这样的事情是合理的：

```
__global__ void addition(float* a, float* c, float* d)
{
    int idx = threadIdx.x + blockDim.x*blockIdx.x;

    float2* avec = reinterpret_cast<float2*>(a);
    float2* dvec = reinterpret_cast<float2*>(d);

    float2 val = avec[idx];
    float sum = val.x + val.y;
    val.x \= sum;
    val.y \= sum;

    c[idx] = sum;
    dvec[idx] = val;     
} 
```

[免责声明：在浏览器中编写，从未编译，从未测试，不保证不会让您的 GPU 着火，使用风险自负]

这里使用向量类型来提高内存吞吐量，每个线程处理一对值。对于 N 个值，运行 N/2 个线程。如果您有超过 131070 个输入值（即 65535 对），则需要修改内核以处理多个输入。如果出现这种情况，我将把它作为练习留给读者。

# networking - 构建离线 Wi-Fi 接入点，提供连接设备跟踪 webapp

> ID：13377181
> 
> 赞同：2
> 
> 时间：2012-11-14T10:37:21.460
> 
> 标签：networking, webserver, wifi

我是设计替代现实游戏的团队的一员。我正在尝试评估我们的一个想法是否可行，我非常感谢 SO 专家的建议。

想法是这样的：*我们希望人们聚集在一个特定的位置，在那里广播一个 WiFi 接入点。一旦人们连接到这个点，他们就可以访问一个页面，显示有多少其他人连接到这个 WiFi 接入点，以及还有多少人应该连接才能在游戏中进行。因此，他们可以打电话给朋友寻求帮助，并带来更多的人。一旦达到特定数量的同时连接的用户，游戏就会继续。*

我们正在尝试设计这个系统，**使其不需要 Internet 连接**。我在想象几个组件：

1.  一台带有 WiFi 网卡的笔记本电脑广播一个开放的 WiFi 接入点
2.  在笔记本电脑上运行的服务器应用程序，监控和保存当前连接到接入点的设备数量
3.  强制门户（无需身份验证）重定向到本地“webapp”
4.  一个本地“webapp”，显示当前有多少设备连接到接入点（它会以某种方式从服务器应用程序检索此信息）

**第一个问题：这种接缝可行吗？**

* * *

现在，我试图想象一个用户拥有自己的互联网连接的智能手机的用例。假设 WiFi 接入点触手可及，并且智能手机连接到它。然后用户输入一个 URL（可能是一个 IP 地址？）

**第二个问题：智能手机不是在 3G 数据连接上而不是在 WiFi 接入点网络上查找 IP 地址吗？**

* * *

（我一直在寻找类似的问题，似乎更简单的方法是创建一个[在网络上寻找自身实例的应用程序](https://stackoverflow.com/questions/8140092/is-it-possible-for-android-devices-to-exchange-messages-over-an-access-point-and)，尽管该解决方案需要我们为智能手机开发本机应用程序。一个更简单的“webapp”将是交叉的-平台，也将支持计算机和其他 wifi 设备。）

感谢您的任何建议:)

# ms-access - 访问报告：数据透视表或报告的条件格式

> ID：13377183
> 
> 赞同：0
> 
> 时间：2012-11-14T10:37:25.633
> 
> 标签：ms-access, pivot-table

我在 access 2010 中有这些数据

```
Key Value Sec Rank Statut
142 71 AG 3 1
140 69 AG 1 1
141 70 AG 2 2
84 32 BK 1 2
96 40 BK 2 2
```

我需要生成一个报告

```
值 Rank1 Rank2 Rank3
AG 69 70 71
BK 32 40

```

（标题列是排名，标题行给出Sec，细节给出值）

我尝试使用数据透视表，但无法应用条件格式。（否则这将是一个很好的解决方案）如果 statut = 1，我需要选择背景颜色。

我想我必须有一个查询，为每一列显示一个等级

例如 ：

```
Sec Rank1 Rank2 Rank3 Rank1Statut Rank2Statut Rank3statut
AG 69 70 71 1 2 1
BK 32 40 2 2

```

但我没有设法重现你有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:38:14.003

您需要多个查询。例如：

秩

```
TRANSFORM Min(t.Value) AS MinOfValue
SELECT t.Sec
FROM ATable t
GROUP BY t.Sec
PIVOT t.Rank 
```

法规

```
TRANSFORM Min(t.Statut) AS MinOfStatut
SELECT t.Sec
FROM ATable t
GROUP BY t.Sec
PIVOT t.Rank 
```

加入两者

```
SELECT Rank.Sec, Rank.[1], Rank.[2], Rank.[3], 
       Statut.[1], Statut.[2], Statut.[3]
FROM Rank INNER JOIN Statut ON Rank.Sec = Statut.Sec; 
```

# macos - 使用 Terminal.app 时撤消外部粘贴

> ID：13377184
> 
> 赞同：1
> 
> 时间：2012-11-14T10:37:28.083
> 
> 标签：macos, emacs, emacs24

我将多行文本粘贴到 Emacs 中，它会自动插入。但是，要撤消它，您必须按`C-/`（或`M-x` `undo``⏎</kbd>) repeatedly, undoing one line at a time. Is it normal?`

如何使用单个撤消粘贴操作`C-/`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:02:12.367

在终端中运行 Emacs 时，粘贴确实进入了终端，而不是 Emacs。Emacs 从终端一一接收密钥。

有一些解决方法，但没有一个像撤消一样简单：例如，粘贴到`*scratch*`，然后从那里 kill-n-yank。或者，在粘贴之前，按`C-space`。然后您只需按 即可撤消`C-w`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T12:59:12.877

实际上，我使用了一些自定义 elisp，它撤消了自上次保存点以来的所有修改。如果您经常保存（我这样做），这将提供一个很好的逻辑撤消能力。假设您在粘贴块之前保存了缓冲区，这将删除整个粘贴。（注意，它可以跨多个保存点工作，这意味着您可以在撤消历史记录中一次撤消一个保存点）。

```
(defun undo-last-modification ()
  "Undo all changes since last save point in the buffer."
  (interactive)
  (let* ((repeat-undo (eq last-command 'undo))
         (cur-undo-list (if repeat-undo pending-undo-list buffer-undo-list))
         (head (car-safe cur-undo-list))
         (tail (cdr-safe cur-undo-list))
         (found-next-mod nil)
         (num-undos 0))

    ;; when in the midst of undoing, the first nil gets chopped off the list,
    ;; so add one if the list doesn't start with nil
    (if head (setq num-undos (1+ num-undos)))

    ;; search for next save point in the undo list
    (while (not found-next-mod)
      (if (not head)
          (setq num-undos (1+ num-undos))
        (if (and (listp head) (eq (car-safe head) t))
            (setq found-next-mod t)))
      (if tail
          (progn
            (setq head (car-safe tail))
            (setq tail (cdr-safe tail)))
        ;; end of list
        (setq found-next-mod t))
      )

    (if (> num-undos 0)
        (undo num-undos))
    )
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T13:31:16.103

如果您在 Mac OS 终端上运行 Emacs，此解决方案可能会有所帮助：[https ://stackoverflow.com/a/3963229/114833](https://stackoverflow.com/a/3963229/114833)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T14:48:02.167

嗯...如果自上次命令以来的时间很短，我将建议使用`pre-command-hook`删除最后一次的。`undo-boundary`但是我看到运行*后*`pre-command-hook`添加了撤消边界，所以这不是一个选项。您可能希望`M-x report-emacs-bug`，要求使这样的事情成为可能（甚至默认提供）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:40:58.207

您可以将其`(global-set-key [f5] 'undo);`放入您的 emacs 配置文件，即*.emacs*，然后 F5 命令将帮助您撤消最后的操作，包括粘贴。实际上，除了 F5 之外，您还可以设置任何您喜欢的键。

# mysql - MySQL SELECT TMP 行 - 开始日期和结束日期之间的日期

> ID：13377191
> 
> 赞同：3
> 
> 时间：2012-11-14T10:38:01.447
> 
> 标签：mysql, sql, date

我的表包含以下结构：

```
START_DATE | END_DATE   | COST
2012-11-01 | 2012-11-05 | 500.5 
```

我想执行一个返回以下结果的 SELECT 语句：

```
DATE       | COST
2012-11-01 | 100.1
2012-11-02 | 100.1
2012-11-03 | 100.1
2012-11-04 | 100.1
2012-11-05 | 100.1 
```

我可以弄清楚如何将总成本除以开始日期和结束日期之间的天数，但不知道如何为 DATE 列创建这些“虚拟行”。

也许根本不可能。很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:56:03.577

最好的办法是创建一个`Calendar`表。

出于您的目的，您只需要一列...

```
CREATE TABLE Calendar AS (calendar_date DATE) 
```

然后你用你感兴趣的所有日期填满这张表。即使是一百年，这张表仍然很小。

请记住将该列添加为主键。

然后你就加入到桌子上......

```
SELECT
  *
FROM
  yourTable
INNER JOIN
  calendar
    ON  calendar.calendar_date >= yourTable.start_date
    AND calendar.calendar_date <= yourTable.end_date 
```

稍后您可能会发现您想知道假期日期、财政年度边界等。这些都可以作为附加字段和索引添加到该日历表中。

它很像缓存，而不是在查询中重新计算混乱的基于日期的规则。

或者，您可以将其视为一个维度表，其中数据是 ID，其他列是事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:02:34.787

我同意**Dems**有一个日历表，这是最好的选择。因为 Mysql 没有像许多其他 RDBMS 那样的 ROW_NUMBER 函数。

**另一种选择**是创建一个带有序列号的表。您可以使用大量值（例如 1 到 100k）填充此表，您认为这将是任何 start_date 和 end_date 之间的最大天数

就像是

```
create table seq

(rn int);

insert into seq
select 0 as rn union all
select 1 as rn union all
select 2 as rn union all
select 3 as rn union all
select 4 as rn union all
select 5 as rn 
```

然后运行以下查询：

```
select DATE_ADD(START_DATE, INTERVAL rn day) ,
       COST/(select datediff(END_DATE,START_DATE)+1 from table1)
from Table1
cross join seq
where rn<=(select datediff(END_DATE,START_DATE) from table1) 
```

# [SQL小提琴演示](http://www.sqlfiddle.com/#!2/c95d6/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T14:56:08.527

我同意你 Sebas 的观点，这个在 oracle 中工作。用你的表名代替 table1

如果您无权访问，`all_objects`则

```
select ( I +START_DATE-1) date1,cost/((END_DATE-START_DATE)+1) cost from table1 ,(     select I  from DUAL
              model
              dimension by (1 i)
              measures (0 X)
              (X[for I from 2 to 10000 increment 1] = 0)) 
              where END_DATE>=I +START_DATE-1; 
```

如果您可以访问元表，`all_objects`那么试试这个

```
SELECT DATE1.DATE_ALL, table1.cost/((table1.END_DATE-table1.START_DATE)+1) NEW_COST 
FROM table1 INNER JOIN 
    (
     SELECT START_DATE + rownum-1 DATE_ALL 
     FROM ALL_OBJECTS
             CROSS JOIN table1
     WHERE 
         START_DATE + rownum - 1 <= (SELECT MAX(END_DATE) FROM table1)
    ) DATE1 ON table1.END_DATE >= DATE1.DATE_ALL 
```

如果您有任何问题，请告诉我。

# php - Twitter GET 搜索返回空结果

> ID：13377193
> 
> 赞同：0
> 
> 时间：2012-11-14T10:38:07.590
> 
> 标签：php, twitter, twitter-search

我对 Twitter 的 search get 方法的行为感到有点惊讶。

几周前，我创建了 twitter 帐户进行测试。我使用 search get 方法来解析推文，如下所示：

[http://search.twitter.com/search.json?q=netizencytest **_**](http://search.twitter.com/search.json?q=netizencytest)

它工作得很好，但是一周前的某个地方开始返回空结果。

那么，为什么会发生呢？它仍然为此帐户返回空结果。也许.. twitter 出于某些原因禁止解析此帐户？

另一个帐户正确返回结果，例如尝试这个[http://search.twitter.com/search.json?q= **symofficiel**](http://search.twitter.com/search.json?q=shymofficiel)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:12:02.453

此链接可以提供帮助： https: [//support.twitter.com/groups/32-something-s-not-working/topics/118-search/articles/66018-my-tweets-or-hashtags-are-missing-from -搜索已知问题](https://support.twitter.com/groups/32-something-s-not-working/topics/118-search/articles/66018-my-tweets-or-hashtags-are-missing-from-search-known-issue)

请记住，推特搜索只显示最近的推文，并且来自帐户**netizencytest**的最后一条推文是从 10 月 16 日开始的，尝试发布一些新的推文，然后再试一次。

# domain-driven-design - 可以根据服务拥有一个存储库吗？

> ID：13377196
> 
> 赞同：3
> 
> 时间：2012-11-14T10:38:13.840
> 
> 标签：domain-driven-design

我正在开发一个涉及版本控制实体的项目，以便归档用户修改的整个历史。

基本上，这个想法是，当创建实体时，其内容的版本 1 也会保存在存档表中。每当实体被修改时，也会存储一个增量版本。

将实体的状态保存到存档表由`ArchiveService`.

当实体被持久化时，需要调用 ArchiveService 来创建版本 1，因此最合乎逻辑的方式似乎是从存储库中调用它，从而将服务作为依赖项传递给存储库：

```
public class Repository {
    private ArchiveService archiveService;

    public Repository(ArchiveService service) {
        this.archiveService = service;
    }

    public void add(Entity entity) {
        // ... (persist the entity)

        this.archiveService.createVersion(entity);
    }
} 
```

这是一个好习惯，还是有什么缺点？到目前为止，我所看到的是依赖于存储库的服务，而不是相反。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:53:30.563

如果按照描述对其进行建模，您将隐含领域知识并将其隐藏在存储库中，而存储库本身并不是领域的一部分。我认为这不是一个好主意。

您可以使用[**域事件**](http://lostechies.com/jimmybogard/2010/04/08/strengthening-your-domain-domain-events/)对其进行建模，即`EntityCreated`。然后，事件侦听器可以拾取该事件并创建相应的存档条目。

**更新以回答评论中提出的问题：**

> 从概念上讲，存储库封装了持久化在数据存储中的一组对象以及对它们执行的操作，从而提供了持久层的更面向对象的视图。——*[马丁·福勒](http://martinfowler.com/eaaCatalog/repository.html)*

除了正式的定义：存储库知道如何存储和检索对象。为了能够做到这一点，它需要了解持久性机制或至少了解其下的数据访问层。

另一方面，域模型不应该依赖于外部的任何东西。在**[端口和适配器](http://alistair.cockburn.us/Hexagonal+architecture)**架构中（这比经典的分层方法更适合 DDD）存储库将是适配器之一。

您的域只知道其存储库的接口，实际实现在外部。这样，您只有向内的依赖项。基本上这是面向对象的，而具有向下指向、级联依赖关系的分层架构更像是一种过程方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T14:25:45.700

Is Archiving a domain concept that belongs to your Ubiquitous Language ? If it is, `ArchiveService` should be defined in the Domain layer. Otherwise, it can be defined in the Infrastructure layer and each implementation of IRepository will choose whether they archive or not.

In any case, I don't see anything wrong with a Repository depending on `ArchiveService` (or any other service). You could have every piece of code calling `repository.add(entity)` call `archiveService.createVersion(entity)` immediately afterwards, but it wouldn't be very convenient.

# python - 如何分析波形文件的频率

> ID：13377197
> 
> 赞同：2
> 
> 时间：2012-11-14T10:38:13.013
> 
> 标签：python, wave

如何简单分析波形文件的频率？没有额外的模块。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T10:52:53.507

“分析”是什么意思？它可能意味着很多不同的东西，但我所知道的最简单的方法之一是使用[卷积](http://en.wikipedia.org/wiki/Convolution)，您可以轻松地为[离散函数](http://en.wikipedia.org/wiki/Convolution#Discrete_convolution)实现它（您将在数组中有点或尝试离散步骤）：

![离散卷积方程](../Images/b6742a2ed5d19bdcb701f0203ad46b01.png)

这可以通过以下方式轻松完成：

```
for i in main_array:
    from = i - len(convolution_kernel)/2
    // Todo: check boundaries
    result[i] = 0

    for j in convolution_kernel:
        result[i] += convolution_kernel[j] * main_array( from+j) 
```

或者你可以使用循环卷积（想法取自 eryksuns 评论）：

```
result = [sum(f[m]*g[n-m] for m in xrange(len(f))) for n in xrange(len(g))] 
```

这将使您能够测试某个信号是否存在于另一个信号中（您将尝试频率 10、20、50，... 并获得最佳结果）。

你也可以[谷歌`determine wave frequency`](https://www.google.com/search?hl=en&q=determine%20discrete%20wave%20frequency)或研究一下[傅立叶变换](http://en.wikipedia.org/wiki/Fourier_transformation)（它是许多信号处理算法的基础）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T15:19:48.170

如果您不想实现整个 FFT 算法并且不想要任何其他模块，那么我会推荐[Goertzel 算法](http://en.wikipedia.org/wiki/Goertzel_algorithm)，它实际上是特定频率的傅里叶变换，并为您提供该频率的功率样本：

```
define goertzel(sample, target_frequency, sample_rate):
    s_prev = 0 
    s_prev2 = 0 
    normalized_frequency = target_frequency / sample_rate 
    coeff = 2 * cos(2 * PI * normalized_frequency) 
    for element in sample:
      s = element + coeff * s_prev - s_prev2 
      s_prev2 = s_prev 
      s_prev = s 
    end
    power = s_prev2 * s_prev2 + s_prev * s_prev - coeff * s_prev * s_prev2 
    return power 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:52:08.970

Disclaimer: Signal processing is not my specialty and this answer may be a bit crude and rudimentary; feel free to correct/ me :)

I would look into fourier-analysis. A [Fourier transformation](http://en.wikipedia.org/wiki/Fourier_transform) transforms your input from the time domain to the frequency domain. Let me explain that a bit more:

When sampling sound for instance, you determine your sampling frequency and your bit-depth. I believe CD's are sampled at 44.1 kHz with a resolution of 16 bits pr. sample. That means the music is sampled 44,100 times a second and converted to a 16bit value. The music is represented as a vector (or array) with a length of 44,100\. It is a function of time, thus this is the time domain.

On the other hand, do a Fourier-transform on the data and you'll have the data represented as a function of frequency instead. You will still have a vector 44,100 elements long, but each element will represent the amplitude - how much "signal" you have sampled at each frequency! In other words, how much signal of each given frequency your signal contains IN TOTAL over the whole sampling period.

You should look into discrete fourier analysis and an implementation of the Fast Fourier Transformation (FFT).

This question touches on FFT analysis a bit more: [Scipy/Numpy FFT Frequency Analysis](https://stackoverflow.com/questions/9456037/scipy-numpy-fft-frequency-analysis)

**EDIT:**

I've shamelessly stolen some graphics online:

*FFT formula:*

![enter image description here](../Images/207ce36a18b4981419cd3f87964aee5d.png)

*Time vs Frequency domain:*

![enter image description here](../Images/8c36aaa37fff9cd5c47f286dc2b1494a.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T12:02:27.837

如果您的波形文件仅包含一个音符，您只需检测波形的周期性即可获得基频（不是谐波）。通过寻找 0 交叉来做到这一点。

# jsp - jsp-会话-如何使用旧会话（如果存在）但不创建新会话

> ID：13377198
> 
> 赞同：1
> 
> 时间：2012-11-14T10:38:15.897
> 
> 标签：jsp

我倾向于使用 jsp 中的会话。

我有一个发送登录信息并传递给 servlet 的应用程序。如果他们正确的 servlet 创建一个新会话并将 page.jsp 发送到客户端。页面检查是否存在任何会话，如果不创建新会话并阻止用户。

当有任何会话时，我想阻止访问此页面的可能性，但如果我使用：

`<%@ page session=false %@>`

我将失去对旧会话的访问权限（如果她存在）。如何强制 jsp 连接到旧会话但不创建新会话？

如果我错过了什么，我将非常感激：

*   最佳实践
*   链接，解释等
*   任何建议:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T13:28:48.183

您无法*创建*会话。您只能*获取*一个会话，这将返回一个先前创建的会话（如果存在），或者创建一个并返回它（如果还没有会话存在）。

即使是未登录的用户也可以进行会话。事实上，如果他们浏览到一个没有`session=false`. 身份验证应该简单地获取会话，并在会话中存储一些`authenticated`标志（或`userId`令牌）。

如果您不希望经过身份验证的用户进入登录页面，那么当他们进入此页面时，检查`userId`令牌是否已经在会话中，并重定向到其他页面。

# spring - Spring webflow 在同一页面上丢失值

> ID：13377199
> 
> 赞同：0
> 
> 时间：2012-11-14T10:38:27.010
> 
> 标签：spring, spring-webflow-2

我是 Spring Webflow 的新手，我正在尝试创建一个流，它要么保存模型然后移动到下一页，要么保存模型并保持在同一页面上。进入下一页没有问题，验证工作，模型更新并进入下一页，按回并保留状态。

但是，在我的“保存”转换中，我没有指定视图，因此它保持在同一页面上，希望它更新模型。但是所有值都被清除了，我看到的是一个空表格。这最终将显示一个我稍后会担心的弹出窗口。我已经制作了模型流量镜。

```
<on-start>
    <evaluate expression="controller.createApplicationModel()" result="flowScope.applicationModel" />
</on-start>

<view-state id="contactInformation" view="contactInformation-tiles" model="applicationModel">       
    <transition on="next" to="aboutYou" >
        <evaluate expression="controller.save(applicationModel)" />
    </transition>
    <transition on="save" >
        <evaluate expression="controller.save(applicationModel)" />
    </transition>
</view-state> 
```

我的配置错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:45:10.400

问题不在于 webflow 配置，而在于您用来调用事件的方法。确保转换是由表单提交而不是链接触发的。

# character - Smarty substr 字符串跳过第一个字符

> ID：13377201
> 
> 赞同：6
> 
> 时间：2012-11-14T10:38:31.977
> 
> 标签：character, smarty, substr, skip

该变量`$siteroot`包含一个字符串，如下所示：

[http://www.example.nl/folder/](http://www.example.nl/folder/)

要获得[http://www.example.nl/](http://www.example.nl/)部分，您可以使用：

`{$siteroot|substr:0:22}`

但我想跳过这部分并返回 /folder/

文件夹的长度未知。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-14T10:47:55.117

```
{$siteroot|substr:22} 
```

应该管用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:00:18.567

```
{assign var="bar_at" value=$siteroot|strpos:"nl/"}
{$siteroot|substr:$bar_at+2} 
```

# r - 意外的字符串常量

> ID：13377206
> 
> 赞同：3
> 
> 时间：2012-11-14T10:38:50.173
> 
> 标签：r

我的数据库有问题。我想在 R 中输入数据库，但出现此消息“错误意外字符串常量”。

我写了这个命令：`read.csv(prova1,sep";", header=20)`

有什么问题？我想我的数据库中有一些东西，但我不知道它是什么。谢谢你的回复

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-23T08:45:51.317

就像评论一样，你犯了一个语法错误，即你忘记了and`=`之间的。`sep``;`

# java - 使用 kerberos 的 AccessControlException

> ID：13377207
> 
> 赞同：2
> 
> 时间：2012-11-14T10:38:54.840
> 
> 标签：java, tomcat7, kerberos

我们在部署在 tomcat7 中的应用程序中使用 Spring Security 和 kerberos。如果我们激活 java.security 我们得到异常：

```
java.security.AccessControlException: access denied ("javax.security.auth.PrivateCredentialPermission" "javax.security.auth.kerberos.KeyTab" "read")
java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
java.security.AccessController.checkPermission(AccessController.java:555)
java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
javax.security.auth.Subject$SecureSet$1.next(Subject.java:1024)
sun.security.jgss.krb5.Krb5Util$ServiceCreds.getKKeys(Krb5Util.java:283)
sun.security.jgss.krb5.Krb5Util$ServiceCreds.getEKeys(Krb5Util.java:301)
sun.security.jgss.krb5.Krb5AcceptCredential.getKrb5EncryptionKeys(Krb5AcceptCredential.java:156)
sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:768)
sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)
sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)
sun.security.jgss.spnego.SpNegoContext.GSS_acceptSecContext(SpNegoContext.java:871)
sun.security.jgss.spnego.SpNegoContext.acceptSecContext(SpNegoContext.java:544)
sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)
sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)
org.springframework.security.extensions.kerberos.SunJaasKerberosTicketValidator$KerberosValidateAction.run(SunJaasKerberosTicketValidator.java:153)
org.springframework.security.extensions.kerberos.SunJaasKerberosTicketValidator$KerberosValidateAction.run(SunJaasKerberosTicketValidator.java:1)
java.security.AccessController.doPrivileged(Native Method)
javax.security.auth.Subject.doAs(Subject.java:415)
org.springframework.security.extensions.kerberos.SunJaasKerberosTicketValidator.validateTicket(SunJaasKerberosTicketValidator.java:69) 
```

PrivateCredentialPermission 的 javadoc 说，我必须在 catalina.policy 中添加类似的内容

```
grant { permission javax.security.auth.PrivateCredentialPermission 
"com.sun.PrivateCredential javax.security.auth.kerberos.KeyTab \"duke\"", "read";    
}; 
```

其中 duke 是我的校长的名字或只是 *. 不幸的是，这不起作用。

com.sun.PrivateCredential 的正确替换是什么？

# c# - 基本选项卡控件

> ID：13377211
> 
> 赞同：2
> 
> 时间：2012-11-14T10:39:11.853
> 
> 标签：c#, visual-studio-2010

嗨，这确实是基本的东西，但我似乎无法在网上找到简单的答案。我正在使用 Visual Studio 2010，执行 C#，我在基本选项卡控件中有两个选项卡，在选项卡控件之外有一个计算按钮，我需要根据用户选择的选项卡计算不同的总和。

我最初的想法是使用如下`if`语句：

```
private void calculateButton_Click(object sender, EventArgs e)
        {
            if (tabControl.tab1.selected == true)
            {
                 MessageBox.Show("whatever");
            }
            else
            {
                 MessageBox.Show("doesnt matter");
            }
        } 
```

任何帮助都会很棒，因为您可能会说我对编程很陌生，所以感谢您花时间回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T10:48:02.317

尝试这个：

```
private void calculateButton_Click(object sender, EventArgs e)
{
    if (tabControl.SelectedTab == tab1)
    {
        MessageBox.Show("whatever");
    }
    else
    {
        MessageBox.Show("doesnt matter");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:48:30.157

```
private void calculateButton_Click(object sender, EventArgs e)
        {
            if (tabControl.SelectedTab == tab1)
            {
                 MessageBox.Show("whatever");
            }
            else
            {
                 MessageBox.Show("doesnt matter");
            }
        } 
```

# android - Android上的RXTX串口库

> ID：13377212
> 
> 赞同：1
> 
> 时间：2012-11-14T10:39:13.337
> 
> 标签：android, serial-port, rxtx

我在我的 Java 项目中使用[rxtx 库](http://rxtx.qbang.org/wiki/index.php/Main_Page)来读取来自我的 gps 芯片的串行数据。现在，我尝试将其移植到我的 Android 设备上，这是一个带有 Android 4.0.3 库存 ROM 的根深蒂固的 Galaxy Nexus。

我已经创建了一个项目并将我的类移植到了一个 android 版本。它使用[rxtx 库为 android](http://v-lad.org/projects/gnu.io.android/)像这样：

```
public void init() {
    try {
        Enumeration portIdentifiers = CommPortIdentifier.getPortIdentifiers();
        // / See what ports are available. and latch on desired port
        while (portIdentifiers.hasMoreElements()) {
            CommPortIdentifier pid = (CommPortIdentifier) portIdentifiers.nextElement();
            if (pid.getPortType() == CommPortIdentifier.PORT_SERIAL && pid.getName().equals(PORT)) {
                portId = pid;
                break;
            }
        }
        serialPort = (SerialPort) portId.open("test", 5000);
        in = serialPort.getInputStream();
        dis = new DataInputStream(in);
        serialPort.addEventListener(this);
        serialPort.setSerialPortParams(BAUDRATE, SerialPort.DATABITS_8, SerialPort.STOPBITS_1,
                SerialPort.PARITY_NONE);
        serialPort.notifyOnDataAvailable(true);
    } catch (PortInUseException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (TooManyListenersException e) {
        e.printStackTrace();
    } catch (UnsupportedCommOperationException e) {
        e.printStackTrace();
    }

} 
```

在此之后，我尝试使用`serialEvent(SerialPortEvent event)`-method 读取传入的数据。

但由于库的本机实现存在一些问题，我无法读取数据。这是我的 logcat 输出：

```
11-14 11:24:49.793: I/GNU.IO(15496): JNI_OnLoad called.
11-14 11:24:49.793: I/GNU.IO(15496): Testing the version.
11-14 11:24:49.800: I/GNU.IO(15496): entering RXTXCommDriver:getDeviceDirectory 
11-14 11:24:49.800: I/GNU.IO(15496): TestREAD.
11-14 11:24:49.808: I/GNU.IO(15496): /dev/ttyO0
11-14 11:24:49.808: I/GNU.IO(15496): entering RXTXPort:testRead 
11-14 11:24:49.808: I/GNU.IO(15496): RXTX Warning:  Removing stale lock file. /data/local/tmp/LCK..ttyO0
11-14 11:24:49.816: I/GNU.IO(15496): leaving RXTXPort:testRead 
11-14 11:24:49.832: I/GNU.IO(15496): entering RXTXCommDriver:getDeviceDirectory 
11-14 11:24:49.840: I/GNU.IO(15496): TestREAD.
11-14 11:24:49.847: I/GNU.IO(15496): /dev/ttyO0
11-14 11:24:49.847: I/GNU.IO(15496): entering RXTXPort:testRead 
11-14 11:24:49.847: I/GNU.IO(15496): leaving RXTXPort:testRead 
11-14 11:24:49.871: I/GNU.IO(15496): entering RXTXPort:Initialize 
11-14 11:24:49.879: I/GNU.IO(15496): entering RXTXPort:open 
11-14 11:24:49.886: I/GNU.IO(15496): leaving RXTXPort:open 
11-14 11:24:49.886: I/GNU.IO(15496): entering eventLoop
11-14 11:24:49.886: I/GNU.IO(15496):  
11-14 11:24:49.886: I/GNU.IO(15496): entering send_event 
11-14 11:24:49.886: I/GNU.IO(15496): send_event: !eventloop_interupted
11-14 11:24:49.886: I/GNU.IO(15496): send_event: jclazz
11-14 11:24:49.886: I/GNU.IO(15496): send_event: calling
11-14 11:24:49.886: I/GNU.IO(15496): send_event: called
11-14 11:24:49.886: I/GNU.IO(15496): leaving send_event 
11-14 11:24:49.886: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.886: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.886: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.886: I/GNU.IO(15496): entering send_event 
11-14 11:24:49.886: I/GNU.IO(15496): send_event: !eventloop_interupted
11-14 11:24:49.886: I/GNU.IO(15496): send_event: jclazz
11-14 11:24:49.886: I/GNU.IO(15496): send_event: calling
11-14 11:24:49.886: I/GNU.IO(15496): send_event: called
11-14 11:24:49.886: I/GNU.IO(15496): leaving send_event 
11-14 11:24:49.886: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.886: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.886: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.894: I/GNU.IO(15496): entering send_event 
11-14 11:24:49.894: I/GNU.IO(15496): send_event: !eventloop_interupted
11-14 11:24:49.894: I/GNU.IO(15496): send_event: jclazz
11-14 11:24:49.910: I/GNU.IO(15496): leaving RXTXPort:translate_speed 
11-14 11:24:49.910: I/GNU.IO(15496): entering RXTXPort:nativeSetSerialPortParams 
11-14 11:24:49.910: I/GNU.IO(15496): entering translate_date_bits 
11-14 11:24:49.910: I/GNU.IO(15496): entering translate_stop_bits 
11-14 11:24:49.910: I/GNU.IO(15496): leaving RXTXPort:translate_stop_bits 
11-14 11:24:49.910: I/GNU.IO(15496): entering translate_parity 
11-14 11:24:49.910: I/GNU.IO(15496): leaving translate_parity 
11-14 11:24:49.910: I/GNU.IO(15496): leaving RXTXPort:nativeSetSerialPortParams 
11-14 11:24:49.910: I/GNU.IO(15496): send_event: calling
11-14 11:24:49.910: I/GNU.IO(15496): send_event: called
11-14 11:24:49.910: I/GNU.IO(15496): leaving send_event 
11-14 11:24:49.910: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.910: I/GNU.IO(15496): entering send_event 
11-14 11:24:49.910: I/GNU.IO(15496): send_event: !eventloop_interupted
11-14 11:24:49.910: I/GNU.IO(15496): send_event: jclazz
11-14 11:24:49.910: I/GNU.IO(15496): send_event: calling
11-14 11:24:49.910: I/GNU.IO(15496): send_event: called
11-14 11:24:49.910: I/GNU.IO(15496): leaving send_event 
11-14 11:24:49.910: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.910: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.910: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.918: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.918: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.918: I/GNU.IO(15496): port_has_changed_fionread: change is 0
11-14 11:24:49.918: I/GNU.IO(15496): entering check_tiocmget_changes
11-14 11:24:49.918: I/GNU.IO(15496): leaving check_tiocmget_changes
11-14 11:24:49.918: I/GNU.IO(15496): port_has_changed_fionread: change is 0 
```

最后三行重复，直到我终止手机上的进程。串口上没有数据，其实看起来，就是连初始化都没有。对此有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-12T18:14:18.253

在 Android 中使用串口，​​我推荐使用以下库：[Serial Port API](http://code.google.com/p/android-serialport-api/)。对我有用，我相信对你有用。

# c++ - 在以下示例中，为什么 Eigen 比 ublas 慢 5 倍？

> ID：13377216
> 
> 赞同：11
> 
> 时间：2012-11-14T10:39:33.967
> 
> 标签：c++, algorithm, linear-algebra, eigen, ublas

在 Eigen 版本中，我使用“真正的”固定大小矩阵和向量，更好的算法（LDLT 与 uBlas 的 LU），它在内部使用 SIMD 指令。那么，为什么在下面的例子中它比 uBlas 慢？

我敢肯定，我做错了什么 - Eigen**必须**更快，或者至少具有可比性。

```
#include <boost/numeric/ublas/matrix.hpp>
#include <boost/numeric/ublas/vector.hpp>
#include <boost/numeric/ublas/lu.hpp>
#include <boost/numeric/ublas/symmetric.hpp>
#include <boost/progress.hpp>
#include <Eigen/Dense>
#include <iostream>

using namespace boost;
using namespace std;
const int n=9;
const int total=100000;

void test_ublas()
{
    using namespace boost::numeric::ublas;
    cout << "Boost.ublas ";
    double r=1.0;
    {
        boost::progress_timer t;
        for(int j=0;j!=total;++j)
        {
            //symmetric_matrix< double,lower,row_major,bounded_array<double,(1+n)*n/2> > A(n,n);
            matrix<double,row_major,bounded_array<double,n*n> > A(n,n);
            permutation_matrix< unsigned char,bounded_array<unsigned char,n> > P(n);
            bounded_vector<double,n> v;
            for(int i=0;i!=n;++i)
                for(int k=0;k!=n;++k)
                    A(i,k)=0.0;
            for(int i=0;i!=n;++i)
            {
                A(i,i)=1.0+i;
                v[i]=i;
            }
            lu_factorize(A,P);
            lu_substitute(A,P,v);
            r+=inner_prod(v,v);
        }
    }
    cout << r << endl;
}

void test_eigen()
{
    using namespace Eigen;
    cout << "Eigen ";
    double r=1.0;
    {
        boost::progress_timer t;
        for(int j=0;j!=total;++j)
        {
            Matrix<double,n,n> A;
            Matrix<double,n,1> b;
            for(int i=0;i!=n;++i)
            {
                A(i,i)=1.0+i;
                b[i]=i;
            }
            Matrix<double,n,1> x=A.ldlt().solve(b);
            r+=x.dot(x);
        }
    }
    cout << r << endl;
}

int main()
{
    test_ublas();
    test_eigen();
} 
```

输出是：

```
Boost.ublas 0.50 s

488184
Eigen 2.66 s

488184 
```

（Visual Studio 2010 x64 版本）

* * *

**编辑**：

为了

```
const int n=4;
const int total=1000000; 
```

输出是：

```
Boost.ublas 0.67 s

1.25695e+006
Eigen 0.40 s

5.4e+007 
```

我想，这种行为是由于 uBlas 版本就地计算分解，而 Eigen 版本创建了矩阵的副本（LDLT） - 所以它更适合缓存。

有没有办法在 Eigen 中进行就地计算？或者也许还有其他方法可以改进它？

* * *

**编辑：**

遵循 Fezvez 的建议并使用 LLT 而不是 LDLT 我得到：

```
Eigen 0.16 s

488184 
```

这很好，但它仍然会进行不必要的矩阵堆栈分配：

```
sizeof(A.llt()) == 656 
```

我宁愿避免它 - 它应该更快。

* * *

**编辑：**

我通过从 LDLT 子类化（它的内部矩阵受到保护）删除了分配，并直接填充它。现在 LDLT 的结果是：

```
Eigen 0.26 s
488209 
```

它有效，但它是解决方法 - 不是真正的解决方案......

LLT 的子类化也有效，但没有提供如此好的效果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T07:46:19.307

你的基准是不公平的，因为 ublas 版本就地解决，而 Eigen 版本可以很容易地调整这样做：

```
b=A.ldlt().solve(b);
r+=b.dot(b); 
```

使用 g++-4.6 -O2 -DNDEBUG 编译，我得到（在 2.3GHz CPU 上）：

```
Boost.ublas 0.15 s
488184

Eigen 0.08 s
488184 
```

如果您正在运行 32 位系统或（32 位编译链），请确保您在编译时启用了优化，并启用了 SSE2。

编辑：我也试图避免矩阵复制，但这根本导致零增益。

此外，增加 n，增加速度差（这里 n=90）：

```
Boost.ublas 0.47 s
Eigen 0.13 s 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T13:13:41.760

我按照您关于就地计算的提示进行操作：

使用完全相同的代码，并使用函数`A.llt().solveInPlace(b);`和`A.ldlt().solveInPlace(b);`（将 b 替换为 x），我明白了

```
There were  100000  Eigen standard LDLT linear solvers applied in  12.658  seconds 
There were  100000  Eigen standard LLT linear solvers applied in  4.652  seconds 

There were  100000  Eigen in place LDLT linear solvers applied in  12.7  seconds 
There were  100000  Eigen in place LLT linear solvers applied in  4.396  seconds 
```

对于这类问题，也许 LLT 求解器比 LDLT 求解器更合适？（我可以看到您正在处理大小为 9 的矩阵）

（顺便说一句，我回答了你之前关于第 9 维线性求解器的问题，我很遗憾地看到 Eigen 的 LDLT 实现有很多开销......）

# objective-c - SEGUE 并在另一个 VC 中显示大图

> ID：13377217
> 
> 赞同：2
> 
> 时间：2012-11-14T10:39:47.427
> 
> 标签：objective-c, segue, uicollectionview

我是oop和objective-c的新手。我有一个 collectionView 从我的手机加载照片。我想继续使用另一个 ViewController，以便我的资产以@全分辨率显示。我关注了这篇文章： Rob Mayoff[在 prepareForSegue 中设置 UIImageView.image](https://stackoverflow.com/questions/11515643/set-uiimageview-image-in-prepareforsegue)并想出了这个，这是我的主要 VC 代码：

```
 - (void)viewDidLoad
    {
        [super viewDidLoad];

        void (^assetEnumerator)(ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop)
        {
            if (result != NULL)
            {
                NSLog(@"See Asset: %@", result);
                [_gallery addObject:result];
            }

        };

        void (^assetGroupEnumerator)(ALAssetsGroup *, BOOL *) =  ^(ALAssetsGroup *group, BOOL *stop)
        {
            if(group != nil)
            {
                [group enumerateAssetsUsingBlock: assetEnumerator];

            }

           [self.collectionView reloadData];
        };

        _gallery = [[NSMutableArray alloc]init];

        _library = [[ALAssetsLibrary alloc] init];

        [_library enumerateGroupsWithTypes: ALAssetsGroupAlbum
                               usingBlock: assetGroupEnumerator
                             failureBlock: ^(NSError *error)
         {
             NSLog(@"Failure");
         }];
    }

    -(NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView
    {

        return 1;

    }

    -(NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
    {
        return _gallery.count;

    }

    -(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
    {

        ViewControllerCell *myCell = [collectionView dequeueReusableCellWithReuseIdentifier:@"myCell" forIndexPath:indexPath];

        _asset = [_gallery objectAtIndex:indexPath.row];

        _photo =[UIImage imageWithCGImage:[_asset thumbnail]] ;

        myCell.myImage.image = _photo;

        return myCell;
    }

    -(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath
    {
        _asset = [_gallery objectAtIndex:indexPath.row];
        _photo = [UIImage imageWithCGImage:[_asset thumbnail]];
        ALAssetRepresentation *rep = [_asset defaultRepresentation];
        CGImageRef ref = [rep fullResolutionImage];
        _img = [UIImage imageWithCGImage: ref];

    }

     //the segue is set to modal
    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
    {

        if ([segue.identifier isEqualToString:@"ShowPhoto"]) {

           PhotoZoomController *photoZoom = segue.destinationViewController;

            photoZoom.object = sender;

        }
    } 
```

现在为了显示我的完整图像，我在目标 VC 的 viewDidLoad 方法中执行此操作：

```
- (void)viewDidLoad
{
    ViewController *vc = [[ViewController alloc] init];

    _image = vc.img;

     [super viewDidLoad];

    _largePhoto.image = _image;   / *largePhoto is the UIImageView @property declared        
                                    in destination VC.h */

} 
```

我得到一个空白的 imageView。我当然做错了什么，真的需要你的帮助。我只是不知道该怎么办了提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:19:58.433

您最大的问题是`ViewController *vc = [[ViewController alloc] init];`创建了一个全新的视图控制器对象。作为新的，它不可能是包含您想要的图像的那个。

您需要的策略是使用该`prepareForSegue:`方法将图像传递给`PhotoZoomController`.

（这对我来说并不明显`photoZoom.object`。如果它是`ViewController`，您可以使用它来获取图像。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T15:30:05.670

I think you misunderstood how `prepareForSegue:` method works. It basically provides you a possibility to interact with viewController to which you are navigating to, like setting a property. So your `PhotoZoomController` should have a property UIImageView to which you pass the image. Then you can do something like this:

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"ShowPhoto"]) {
           PhotoZoomController *photoZoom = segue.destinationViewController;
            photoZoom.imageView = myCreatedImageView;
        }
    } 
```

This way once your modal view is displayed, its UIImageView property should be set properly. There is no need to create new view controller `ViewController *vc`, like you do.

# iphone - 如何获取手指坐标

> ID：13377219
> 
> 赞同：0
> 
> 时间：2012-11-14T10:39:58.817
> 
> 标签：iphone, objective-c, xcode

我找不到如何在 Xcode 中获取 iphone 上的鼠标/手指的坐标。

我试过了：

```
NSPoint mouseLoc;
mouseLoc = [NSEvent mouseLocation]; 
```

但这似乎不适用于iphone？API 无法识别它。

有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T10:58:09.257

这是 Apple 的文档：[UIResponder Class Reference](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIResponder_Class/Reference/Reference.html)。在 a `UIView`or`UIViewController`的子类中，您可以添加此方法：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touched = [[event allTouches] anyObject];
    CGPoint location = [touch locationInView:touched.view];
    NSLog(@"x=%.2f y=%.2f", location.x, location.y);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:55:44.750

您正在使用可可类。对于 iPhone，有 cocoa.touch，您需要它的 UIEvent 类。
allTouches 方法返回窗口的所有触摸事件。一旦有触摸，您可以询问它在视图中的位置。

**例子：**

```
void event : (UIEvent*) event
{
    NSSet* touches=[event allTouches];
    for(UITouch* touch in touches)
    {
        CGPoint point=[touch locationInView: yourView];
        <Do what you need to do with the point>
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:20:17.847

您可以使用 UITapGestureRecognizer 识别手指在屏幕上触摸的位置。为此，您必须在要处理触摸的控件上添加一个 UITapGestureRecognizer 对象/插座，例如在我的示例中，我在 View 上添加 UITapGestureRecognizer。

```
 UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(fingerTappedHere:)];
tapGesture.numberOfTapsRequired = 1;
tapGesture.numberOfTouchesRequired = 1;
[self.view addGestureRecognizer:tapGesture];
self.view.userInteractionEnabled = YES;

- (void)fingerTappedHere:(UITapGestureRecognizer *)sender {

CGPoint touchedPoint = [sender locationInView:self.view];
NSLog(@"x = %f, y = %f", touchedPoint.x, touchedPoint.y); 
```

}

希望它会帮助你。如需进一步查询，请通过 sales@agicent.com 联系我们。我们会尽力解决。

# c - 静态定义对性能、代码内存大小和数据内存大小的影响？

> ID：13377223
> 
> 赞同：0
> 
> 时间：2012-11-14T10:40:05.760
> 
> 标签：c, static

我知道使用静态定义（例如：）`static int toto;`是为了使函数或变量只能在本地文件中看到，而不是在整个源代码中看到。

我想知道静态定义是否有影响：

1.  关于二进制程序执行的性能？
2.  关于优化代码内存的内存大小？
3.  关于优化数据内存的内存大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:50:35.267

这通常是不可能回答的，因为它实际上取决于你的编译器有多聪明，你如何编译等等。

它可能使编译器更容易优化您的代码（例如，完全删除变量或内联函数，因为它知道它永远不会从外部调用；即使您只是编译这个单个翻译单元）。然而，这实际上取决于编译器以及变量或函数的使用方式（例如，在函数中使用它之前是否总是初始化）。

因此，正确使用它可能会对执行时间以及代码大小和内存使用产生积极影响。

* * *

至于`static`函数中的变量，情况可能完全不同（因为您可能会保留先前调用的变量，这可能会阻止它被删除）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:51:01.943

static 只是使变量或函数在当前翻译单元（当前源文件）中可见的方法。这意味着`global static`变量具有`internal linkage`.

因此，当然，构建每个标识符都具有内部链接的任何可执行文件都会更快，因为链接器无需解析外部符号或更少数量的外部符号。

但是不知道平台、编译器和版本就不能肯定，所以这只是一个笼统的解释

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:52:34.983

给出一个通用的答案非常困难，因为它取决于编译器和用例：

> 关于二进制程序执行的性能？

这取决于该值是否确定为常数，如果是，则其在高优化级别下传播和折叠。它还取决于它是在函数内还是在 TU 范围内是静态的。在 TU 范围内，它将被视为与任何其他 BSS 分配的变量相同，只有多个副本。在函数级别，与堆栈或寄存器局部变量相比，地址间接会增加相当多的开销（然而，L1 缓存会减轻大部分开销）。

> 关于优化代码内存的内存大小？

它不应该影响代码的内存大小，除了函数静态变量的情况，它不能被堆栈分配，因此需要内存地址访问，这增加了每次存储和加载的地址访问开销。不过，在大多数系统下，实际尺寸的增加可以忽略不计。

> 关于优化数据内存的内存大小？

取决于制作了多少副本，这取决于它包含多少个 TU（例如：可以为每个包含头的 TU 创建静态头变量）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T10:57:09.877

实际上，正如马里奥指出的那样，定义`static`一个局部变量告诉编译器在成功调用之间保留其值；这可能会产生很多影响。大多数情况下，这个变量成为一个“模块全局”变量，因此不会进入堆栈（我指的是嵌入式 fw）；

另一个影响是，如果您在`static`同时从不同线程调用的函数中使用 var ，则会获得不同（较低）的 RAM 使用率（当然，行为也非常不同）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:58:59.817

一个普遍的答案是：“它不能让它变得更糟，但它可以让它变得更好”。static 和 const 等做两件事——它们限制了你可以做什么，它们允许编译器做出更好的决定。编译器不必做出这些决定，但它可以，所以它不会受到伤害，如果你幸运的话，它会有所帮助。

# wpf - WPF WYSIWYG 打印多页

> ID：13377225
> 
> 赞同：1
> 
> 时间：2012-11-14T10:40:16.237
> 
> 标签：wpf, printing

我有 2 个场景，我想 WYSIWYG 打印用户控件。在一种情况下，我有一个 GridView（由 Telerik 提供），它可以在 X 和 Y 方向上跨越多个页面。在第二种情况下，我有一个可以在 Y 方向跨越多个页面的 TreeView（也是 Telerik 的）。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T10:44:33.127

在 WPF 中打印可能很困难，我建议使用[PrintEngine](http://www.codeproject.com/Articles/238135/WPF-Print-Engine-Part-I)。

你可能需要稍微调整一下，我知道我做到了，但这是一个非常好的开始。

你像这样使用它：

```
public static void PrintElement(FrameworkElement printMe)
{
    var suPrintVm = PrintControlFactory.Create(printMe);
    suPrintVm.ShowPrintPreview();
} 
```

然后会显示一个预览，您可以在其中指定打印详细信息。

# java - 尝试在 Java 中实现 Google 的“你的意思是”功能

> ID：13377232
> 
> 赞同：0
> 
> 时间：2012-11-14T10:40:35.633
> 
> 标签：java, lucene

我正在尝试在 java 中实现 google 的“你的意思是”功能。我在互联网上发现了一些代码说它可以正常工作，但在尝试运行它时却给我一个错误。我认为这与目录创建有关，这是我不完全理解的代码的唯一部分。

这是代码，你能帮我看看有什么问题吗？提前致谢！

```
 public static void main(String[] args) throws Exception {
             File dir = new File("C:/Users/Lala");
             Directory directory = FSDirectory.open(dir);

             SpellChecker spellChecker = new SpellChecker(directory);

             spellChecker.indexDictionary(
             new PlainTextDictionary(new File("fulldictionary00.txt")));
             String wordForSuggestions = "hwllo";
             int suggestionsNumber = 5;
             String[] suggestions = spellChecker.
                 suggestSimilar(wordForSuggestions, suggestionsNumber);
             if (suggestions!=null && suggestions.length>0) {
                 for (String word : suggestions) {
                     System.out.println("Did you mean:" + word);
                 }
             }
             else {
                 System.out.println("No suggestions found for word:"+wordForSuggestions);
             }

         } 
```

该文件`fulldictionary00.txt`是正确格式的纯文本文件。

我得到的错误是在第 18 行：

```
SpellChecker spellChecker = new SpellChecker(directory); 
```

所以它与目录创建有关。我正在粘贴我得到的错误，以防万一你看到它时有任何想法。

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/lucene/document/Fieldable at did_you_mean.main(did_you_mean.java:18) Caused by:     
 java.lang.ClassNotFoundException: org.apache.lucene.document.Fieldable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T17:24:02.663

好吧，在 lucene 4.0.0 中，spellchecker 放在一个名为 lucene-suggest-4.0.0.jar 而不是 lucene-spellchecker-XXX.jar 的包中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:42:53.193

**编辑**

不过，根据 OPs 的评论，错误是 Lucene 的 JAR 文件似乎不在类路径中......

*原始答案，不知道错误（将其保留在此处可能很有用）*

您必须将内容添加到指定的文件中......没有它就无法工作。稍微想一想：程序如何知道哪些单词是正确的，哪些不是？

对于纯文本字典文件的情况，您应该使用**[PlainTextDictionary](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_0/api/contrib-spellchecker/org/apache/lucene/search/spell/PlainTextDictionary.html)**

> 由文本文件表示的字典。
> 
> 允许的格式：每行 1 个字：
> word1
> word2
> word3

[此页面](http://wiki.apache.org/lucene-java/SpellChecker)在 Lucene 索引的上下文中对其进行了一些解释：

> 导入：将单词添加到字典中 我们可以添加来自 Lucene 索引（更准确地说来自一组 Lucene 字段）的单词，以及来自带有单词列表的文本文件。
> 
> 示例：我们可以添加我的索引的给定 Lucene 字段的所有关键字。

```
SpellChecker spell= new SpellChecker(dictionaryDirectory);
spell.indexDictionary(new LuceneDictionary(my_luceneReader,my_fieldname)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T10:52:33.770

以防万一其他人有同样的问题，我找到了解决方法！

首先，问题似乎出在我下载的 lucene 4.0.0 版本上，因为一个 jar 文件的一个类正在调用另一个已在该版本中重命名的 jar 文件中的一个类。

为了解决这个问题，我刚刚下载了一个旧版本（3.6.1），它需要对现有代码进行一些更改。在这个版本中， spellChecker.IndexDictionary() 函数需要 3 个参数：

`spellChecker.indexDictionary(new PlainTextDictionary(new File("fulldictionary00.txt")),config,false);`

config 是一个 IndexWriterConfig 对象。

我希望这会帮助有同样问题的人！@ppeterka 无论如何感谢您的帮助！

# php - 从字符串创建数组

> ID：13377240
> 
> 赞同：0
> 
> 时间：2012-11-14T10:41:09.907
> 
> 标签：php, arrays

我有一个这样的**字符串**：

```
$str = "array (
   'from' => 'OK',
   'to' => 'OK',
   array (
      'id' => 204847
   ),
)" 
```

我怎样才能创建匹配的数组？或者我怎么能得到 id ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:43:57.490

如果此字符串不是用户输入，最简单的方法是使用[`eval`](http://php.net/manual/en/function.eval.php).

```
eval('$myArray = '.$str.';'); 
```

**文档中的重要说明**：

> `eval()`语言结构***非常危险***，因为它允许执行任意 PHP 代码。***因此不鼓励使用它***。如果您已仔细验证除了使用此构造之外别无选择，请特别注意***不要将任何用户提供的数据***传入其中，而无需事先正确验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:43:35.360

你可以使用 PHP 的`eval()`函数，认为你需要确定这个字符串是可信的。即使这样我也不愿意推荐它：

**文档： http:** [//php.net/manual/en/function.eval.php](http://php.net/manual/en/function.eval.php)

**警告：** [php 中的 eval 什么时候是邪恶的？](https://stackoverflow.com/questions/951373/when-is-eval-evil-in-php)为什么它是邪恶的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T10:47:21.687

我将打破“按规定回答问题”的模式，因为`eval`它非常危险，我什至不会推荐使用它。

相反，将您的字符串更改为可识别的交换格式，例如[JSON](http://php.net/manual/en/book.json.php)甚至[XML](http://php.net/manual/en/book.xml.php)。还是[PHP的原生序列化格式](http://php.net/manual/en/function.serialize.php)...

# javascript - 如何确保浏览器不缓存我的 JS/CSS

> ID：13377243
> 
> 赞同：1
> 
> 时间：2012-11-14T10:41:20.827
> 
> 标签：javascript, css, browser-cache

> **可能重复：**
> [Css 文件缓存](https://stackoverflow.com/questions/4095487/css-file-caching)

我想确保用户始终获得我的代码的最新版本。

但是设置它以便浏览器不缓存文件是不好的，因为它需要在每个页面视图中重新加载。我想确保它不使用以前版本的缓存副本。例如。使用 1.3 版站点的 1.2 版 JS 的缓存副本。

我见过的一种方法是在每个版本上更改文件名并链接到每个版本上的不同文件名（例如'myscript1.3.js'） 这似乎需要付出很多努力并且有点hacky。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:44:45.273

这是一个非常好的解决方案，我什至会说这是最好的。

您还可以使用查询参数来指示新版本（?v=1、?v=2、...）。但这可能会抛弃一些公共代理（它们可能不会缓存文件）。有关详细信息，请参见此处：[https ://developers.google.com/speed/docs/best-practices/caching#LeverageProxyCaching](https://developers.google.com/speed/docs/best-practices/caching#LeverageProxyCaching)

当然，这需要您付出一些努力。但是你可以在你的部署过程中自动化所有这些（如何做到这一点完全取决于你的设置，所以我不能在不了解更多关于你的项目的情况下给你一个解决方案）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-14T10:48:09.183

方法 1：您更改服务器标头。对于不同的服务器，这些可能会有所不同，但对于 apache 服务器，您可以查看 mod_cache 模块[http://httpd.apache.org/docs/2.4/mod/mod_cache.html](http://httpd.apache.org/docs/2.4/mod/mod_cache.html)

方法 2：你使用一些元标记。你会在这里找到一个相关的问题[Using <meta> tags to turn off caching in all browsers?](https://stackoverflow.com/questions/1341089/using-meta-tags-to-turn-off-caching-in-all-browsers)

# ruby-on-rails - 人们是否将他们的 capistrano deploy.rb 和食谱提交给他们的私人 scm？

> ID：13377250
> 
> 赞同：4
> 
> 时间：2012-11-14T10:42:10.193
> 
> 标签：ruby-on-rails, git, version-control, ruby-on-rails-3.2, capistrano

抱歉这个相当愚蠢的问题，但是人们是否将他们的 Capistrano 文件（Capfile、deploy.rb、multisite > config/deploy/*）提交到他们的私人 scm 存储库？

是否有人们遵循的最佳实践或标准？你遵循什么？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:18:02.507

最佳实践是“是”，提交您的 deploy.rb，但不要提交任何包含密码、api_keys 或其他私有数据的文件——而是制作这些文件模板，例如在`database.yml`提交带有数据库名称、端口、用户名的文件，但类似

```
password: <db_password> 
```

创建模板文件。

显然，如果您的项目位于 GitHub 之类的公共存储库中，那就对了。但是，如果您的 SCM 是私有的，正如您所说，您应该像对待任何其他安全资源一样对待它。密码和密钥比“任何其他安全资源”更重要——它们应该是高度安全的。

对于一个完全自配置的系统，创建 capistrano（或者可能是 rake）任务来读取具有各种密码或密钥的仔细控制的本地文件（可能是 YAML），一旦提交的文件被部署，将密码写入模板。

如果密码或配置文件的格式没有太大变化，您可以使用 cap:setup 任务，然后手动添加密码，将它们保留在 app/shared/config 目录中，并让 capistrano 在源代码树中创建符号链接部署。

在部署方面，只有高权限用户才能执行此操作（尤其是在生产环境中）。这种做法允许您使密码和其他敏感数据仅对已​​被授予访问给定服务器的用户可见。

Ryan Bates 在类似这样的策略上做了一些很好的 RailsCasts，看看[其中的一些情节](http://railscasts.com/?tag_id=21)。请注意，许多 RailsCast 不再免费，但每月只需 9 美元，这非常值得！

# jquery - Flexslider 全屏 BG 淡入效果隐藏 div

> ID：13377256
> 
> 赞同：1
> 
> 时间：2012-11-14T10:42:50.687
> 
> 标签：jquery, fullscreen, flexslider

我将从淡入效果开始，其中触摸完美，图像在滑动时响应变化 - 但是 - 我有我的网站的 div 容器被发送到背景而不是图像前面。

我正在尝试将 flexslider 用作带触摸的全屏背景滑块。这是我的代码，如果有人愿意伸出援助之手。

问候， G

HTML 代码：

```
<div class="flexslider">
<ul class="slides">
<li>
  <img src="images/b3.jpg" />
</li>
<li>
  <img src="images/b4.jpg" />
</li>
<li>
  <img src="images/b6.jpg" />
</li>
</ul>
</div>

<div id="mainContainer2">

TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT.

</div>
</body> 
```

CSS 代码：

```
/* CSS Document */
*{margin:0;paddding:0}

html, body {
font-size: 12px;
margin:0;
paddding:0;
}

#mainContainer2 {
margin: auto;
width: 1000px;
height: 655px;
position:relative;
}

/* Browser Resets */
.flex-container a:active,
.flexslider a:active,
.flex-container a:focus,
.flexslider a:focus {outline: none;}
.slides,
.flex-control-nav,
.flex-direction-nav {margin: 0; padding: 0; list-style: none;}

/* FlexSlider Necessary Styles
*********************************/
.flexslider { width:100%; height: 100%; margin: 0; padding: 0; position:absolute;}
.flexslider .slides > li {display: none; -webkit-backface-visibility: hidden;} /* Hide     the slides before the JS is loaded. Avoids image jumping */
.flexslider .slides img {width: 100%; }
.flex-pauseplay span {text-transform: capitalize;}

/* Clearfix for the .slides element */
.slides:after {content: "."; display: block; clear: both; visibility: hidden; line-height: 0; height: 0;}
html[xmlns] .slides {display: block;}

    html .slides {height: 1%;}

/* No JavaScript Fallback /
/ If you are not using another script, such as Modernizr, make sure you

    include js that eliminates this class on page load */ .no-js .slides > li:first-child {display: block;}

/* FlexSlider Default Theme
*********************************/
.flexslider {margin: 0 0 60px; position:absolute; zoom: 1;}
.flex-viewport {max-height: 2000px; -webkit-transition: all 1s ease; -moz-transition: all 1s ease; transition: all 1s ease;}
.loading .flex-viewport {max-height: 300px;}
.flexslider .slides {zoom: 1;}

.carousel li {margin-right: 5px}

/* Direction Nav */
.flex-direction-nav {*height: 0;}
.flex-direction-nav a {width: 30px; height: 30px; margin: -20px 0 0; display: block;     background: url(images/bg_direction_nav.png) no-repeat 0 0; position: absolute; top: 50%; z-index: 10; cursor: pointer; text-indent: -9999px; opacity: 0; -webkit-transition: all .3s ease;}
.flex-direction-nav .flex-next {background-position: 100% 0; right: -36px; }
.flex-direction-nav .flex-prev {left: -36px;}
.flexslider:hover .flex-next {opacity: 0.8; right: 5px;}
.flexslider:hover .flex-prev {opacity: 0.8; left: 5px;}
.flexslider:hover .flex-next:hover, .flexslider:hover .flex-prev:hover {opacity: 1;}
.flex-direction-nav .flex-disabled {opacity: .3!important; filter:alpha(opacity=30);     cursor: default;}

/* Control Nav */
.flex-control-nav {width: 100%; position: absolute; bottom: -40px; text-align: center;}
.flex-control-nav li {margin: 0 6px; display: inline-block; zoom: 1; *display: inline;}
.flex-control-paging li a {width: 11px; height: 11px; display: block; background: #666; background: rgba(0,0,0,0.5); cursor: pointer; text-indent: -9999px; -webkit-border-radius: 20px; -moz-border-radius: 20px; -o-border-radius: 20px; border-radius: 20px; box-shadow: inset 0 0 3px rgba(0,0,0,0.3);}
.flex-control-paging li a:hover { background: #333; background: rgba(0,0,0,0.7); }
.flex-control-paging li a.flex-active { background: #000; background: rgba(0,0,0,0.9); cursor: default; }

.flex-control-thumbs {margin: 5px 0 0; position: static; overflow: hidden;}
.flex-control-thumbs li {width: 25%; float: left; margin: 0;}
.flex-control-thumbs img {width: 100%; display: block; opacity: .7; cursor: pointer;}
.flex-control-thumbs img:hover {opacity: 1;}
.flex-control-thumbs .flex-active {opacity: 1; cursor: default;} 
```

# javascript - 我可以使用 Javascript 来检测复选框是否已被选中？

> ID：13377268
> 
> 赞同：1
> 
> 时间：2012-11-14T10:43:19.630
> 
> 标签：javascript, ajax, checkbox

我正在尝试使用 Javascript 来检测是否已选中复选框。我的计划是允许用户选中复选框以将字母标记为已打印，然后使用 Ajax 更新数据库。

这是我正在使用的代码。

```
<label for="printed">Printed</label>
<input type="checkbox" name="8200" id="8200" value="P" onclick="checked(this.id);" />
<script type="text/javascript">
  function checked(id) {
    var remember = document.getElementById(id);
    if (remember.checked){
      alert("checked");
    }else{
      alert("You didn't check it!");
    }
  }
</script> 
```

我得到的只是一个错误说`Uncaught TypeError: boolean is not a function from Google Chrome and checked is not a function from Firefox.`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T10:46:31.110

您应该为您的 javascript 方法使用不同的名称，因为输入的布尔检查字段只是隐藏了您定义的那个...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:56:25.433

您需要更改 javascript 方法的名称。

HTML：

```
<label for="printed">Printed</label>
<input type="checkbox" name="8200" id="8200" value="P" onclick="isChecked(this.id);" /> 
```

JS：

```
 function isChecked(id) {
        var remember = document.getElementById(id);
        if (remember.checked){
            alert("checked");
        }else{
            alert("You didn't check it!");
        }
    } 
```

看看这个 JSFiddle：http: [//jsfiddle.net/6dx6A/39/](http://jsfiddle.net/6dx6A/39/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T10:51:53.087

只需将您使用的函数名称更改为“checked(this.id)”即可。我试过check1（this.id）。有效

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T10:54:31.290

您可以更改函数名称以获得答案，如下所示。它对我有用

```
function IsChecked(id)
{
    var remember = document.getElementById(id);
    if (remember.checked){
       alert("checked");
    }else{
       alert("You didn't check it!");
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-14T10:54:42.940

既然你有一个我不满意的不同的 jQuery 解决方案，我会给你我的 jQuery 解决方案：

```
<input type="checkbox" name="8200" id="theid" value="P" />

// 8200 isn't a valid id in HTML4, it can't start with a number
$('#theid').change(function(){
    if (this.checked)
        alert('checked');
    else
        alert('unchecked');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T10:49:54.620

这是您在 JQuery 解决方案中拥有的内容，适用于页面上的每个复选框（向选择器添加一个类，以便仅将其应用于某些复选框）

```
$(function(){
  var remember;
  $('input:checkbox').click(function(){
    remember = $(this).attr('id');

    if($(this).is(':checked')){
      // Checkbox is checked

    } else {
      // Checkbox is NOT checked

    }

  });
}); 
```

# c++ - 关于 DirectX11 命令列表的问题

> ID：13377273
> 
> 赞同：1
> 
> 时间：2012-11-14T10:43:42.427
> 
> 标签：c++, directx-11

关于这个主题，我有一些关于 ID3D11DeviceContext::FinishCommandList 和 CommandList 的问题，我认为 msdn 文档没有很好地涵盖这些问题。

1.  第二个参数（函数 ID3D11DeviceContext::FinishCommandList(...)），ID3D11CommandList **ppCommandList，它必须是一个新的未初始化的 ID3D11CommandList 对象还是可以重用 commandList 对象？

2.  生成的命令列表（使用函数 ID3D11DeviceContext::FinishCommandList(...) 创建）是否必须在完成后释放。或者应该由用户管理 AddRef() 和 Release()。

3.  根据我在使用 myDeferredDeviceContext->ExecuteCommandList(myCommandList, FALSE) 时的理解，myCommandList 与在 myDeferredDeviceContext 中创建的 commandList 合并。如果是这样，我可以使用 FinishCommandList(...) 更新 myCommandList 而不影响合并的 commandList 吗？

问候卡尔·汉森

# c# - 如何从 mdb 的表中检索最后一个主 ID？

> ID：13377279
> 
> 赞同：0
> 
> 时间：2012-11-14T10:43:56.350
> 
> 标签：c#, .net, sql, ms-access

我得到了下一列的表格：`Id, Name, Age, Class`

我正在尝试像这样在数据库中插入新行：

```
INSERT INTO MyTable (Name, Age, Class)
VALUES (@name, @age, @class) 
```

并得到一个例外：

```
"Index or primary key cannot contain a Null value." 
```

问题是如何在不知道下一个主 ID 的情况下添加新行，或者有一种方法可以在另一个查询的帮助下从表中获取此 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:57:24.573

您可以将 ID 列的数据类型更改为 AutoNumber 而不是 Integer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:47:27.387

不确定 Access，但 MySQL 语法是：

```
INSERT INTO MyTable (Id, Name, Age, Class) VALUES (NULL, @name, @age, @class); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:47:58.517

试试这个

```
INSERT INTO MyTable (id,Name, Age, Class)
 VALUES ((select max(id)+1 from MyTable),@name, @age, @class) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:05:34.640

请在 Mytable 中将“id”列设为自动编号，然后尝试

要不然

```
INSERT INTO MyTable (id,Name, Age, Class)
select max(id)+1,@name, @age, @class FROM MyTable 
```

# mysql - 查询执行计时方式

> ID：13377280
> 
> 赞同：1
> 
> 时间：2012-11-14T10:43:58.580
> 
> 标签：mysql

我正在使用计数运行此连接查询，由于有数千条记录，因此生成输出肯定需要近一个小时。但是当它完成执行时，它说，

`Showing rows 0 - 29 ( 11,851 total, Query took 31.9122 sec)`

请问mysql使用的是什么计时机制？因为它肯定不需要 31 秒 :)

非常感谢您..

**PS：**如果这个问题之前解决过，请指导我。我不知道在这种情况下要寻找什么。

**额外信息：** Mysql 在 Windows Vista 32 位的 XAMPP v3.0.12 上运行，intel Core2Quad Q8400 @ 2.66Ghz，4GB RAM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T10:45:54.833

查询本身可能只用了 31.9122 秒，但您执行命令时的其他一些事情需要更长的时间。例如，您如何连接到系统？

# facebook - 作为公司/艺术家 Facebook 网站的管理员/经理，是否可以“创建新应用程序”？

> ID：13377282
> 
> 赞同：-2
> 
> 时间：2012-11-14T10:44:02.783
> 
> 标签：facebook, facebook-apps, administration

我们开始管理/管理几个 facebook 公司/艺术家页面。是否可以在管理多个 Facebook 网站时创建应用程序（“创建新应用程序”）？我们喜欢将网站集成到 facebook 公司/艺术家页面（同时成为管理员/经理和 facebook 开发人员）。

感谢您提供任何信息，对我们来说似乎不太可能做到这一点。单击“创建新应用程序按钮”（或菜单栏中的应用程序）时，它会跳回到管理站点选择屏幕，其中包含所有页面（我的站点）列表。也许我们错过了什么，我们该怎么办？（Facebook 应用程序未在帐户设置中被阻止）

许多问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:41:29.620

只有当您使用常规 Facebook 用户帐户而不是像您在问题中使用的那样的企业帐户时，您才能创建 Facebook 应用程序。您可以参考对您的[问题](https://stackoverflow.com/questions/8798697/facebook-create-new-app-button-does-not-exist-anywhere)的评论中提到的问题

# jquery - 使用 ajax 调用自定义 Google 搜索

> ID：13377288
> 
> 赞同：0
> 
> 时间：2012-11-14T10:44:31.827
> 
> 标签：jquery, ajax, google-custom-search

我正在尝试使用 ajax 调用进行自定义 Google 搜索。

我在谷歌中搜索并找到了一个[很好的链接](http://www.searchtools.com/analysis/google-cse-ajax-basic-example.html)。

这里会自动出现一个文本框和一个按钮，当我们单击搜索按钮时，结果会显示在 div 中。

但我想搜索写在我自己创建的文本框中的项目。手段：我手动创建了一个文本框和一个按钮。当我单击我的按钮并在我的文本框中写入查询时，我想显示结果。

请帮忙

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T07:02:22.567

在提交按钮中写下这个

```
// get a custom search control & keep it in cseControl
// note: put your own custom search ID number here
var cseControl = new google.search.CustomSearchControl('009827885688477640989:igzwimalyta');
// open pages from search results clicks on the same page
cseControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
 // when there are no matches, explain why
cseControl.setNoResultsString("Sorry, there are no pages in this web site that match all the search terms.");
// make the search field visible in div with ID 'cseDiv'
 cseControl.draw('divGoogleResult');

 cseControl.execute(userInput);
 $('.gsc-search-box').hide(); 
```

# php - php中的数组到xml转换错误

> ID：13377295
> 
> 赞同：0
> 
> 时间：2012-11-14T10:44:50.703
> 
> 标签：php, xml, arrays

这是我的代码，

```
 $row=array(username=>'username',password=>'password');
 $var=array_flip($row);
 $xml = new SimpleXMLElement('<root/>');
 array_walk_recursive($var, array ($xml, 'addChild'));
 $result= $xml->asXML(); 
```

如果用户名和密码不同，分别说“abcd”和“efgh”，xml 如下所示：

```
<root>
<username>abcd</username>
<password>efgh</password>
</root> 
```

但如果它们相同，则说“abcd”，xml 看起来像这样：

```
<root>
<password>abcd</password>
</root> 
```

我希望它应该显示为

```
<root>
<username>abcd</username>
<password>abcd</password>
</root> 
```

那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:05:54.433

> [http://www.php.net/manual/en/function.array-flip.php](http://www.php.net/manual/en/function.array-flip.php)
> 
> 如果一个值出现多次，则最新的键将用作其值，而其他所有键都将丢失。

如果密码等于用户名，则 array_flip 返回只有一个元素的数组

```
array_flip(array(username=>'abcd',password=>'abcd'))
// will return array('abcd'=>'password') 
```

在这种情况下，您 cat 使用 foreach 而不是 array_walk_recursive

```
foreach ($row as $k => $v)
   $xml->addChild($k, $v); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:56:35.077

尝试

```
array_walk_recursive($row, function ($value, $key) use ($xml) { 
    $xml->addChild($key, $value); 
  }
); 
```

# iphone - 不同的视图支持不同的方向

> ID：13377296
> 
> 赞同：1
> 
> 时间：2012-11-14T10:44:58.220
> 
> 标签：iphone, orientation

是否有可能，在一个视图控制器中，一个视图支持方向而有些不支持。我的意思是假设我有一个 MainViewController 包含两个 UIView 说 FirstView 和 SecondView。一次只有一个视图可见。假设第一个视图支持两个方向而第二个视图仅支持纵向。当我在设备方向为横向时启动第二个视图时，它应该以纵向而不是横向模式启动。但我的问题是它仅在横向模式下启动。如果可能，那么我如何实现这一点?

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:29:51.650

指示是否支持方向的是 UIViewControllers；这不是 UIViews 的工作。

此外，Apple 的视图控制器框架假设特定的视图控制器不会改变其在其生命周期内支持哪些方向的想法。

因此，如果您有两个支持不同方向的视图，则它们需要位于不同的视图控制器中。如果可能，您需要朝那个方向设计您的应用程序。

在 iOS6 中添加了对 UIViewController 包含的支持；即，您可以拥有一个 UIViewController，它是一个“容器”控制器，可以在其内部呈现一个或多个不同的 UIViewController 视图。我不是 100% 确定这个容器如何处理子视图控制器的方向变化，但值得了解。

# wordpress - 如何在不编辑插件的情况下修改 wordpress 插件功能？

> ID：13377297
> 
> 赞同：5
> 
> 时间：2012-11-14T10:45:00.000
> 
> 标签：wordpress, function, plugins

我正在使用 wordpress 并且我搜索修改插件功能而不编辑插件**更新后不中断功能**。

但我还没有找到解决办法。你能帮助我吗 ？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-24T18:27:53.390

我多次遇到这个问题。正如其他人所说，您不能修改 PHP 函数。扩展类将不起作用，因为插件将实例化原始类，而不是您的扩展版本。

最好的解决方案（已经为我工作了好几次）是在现有插件中添加钩子并提交回原作者，如下所示：

1.  如果原始插件在 github 上，请 fork 并克隆它。否则，将原始插件置于`git`本地控制之下。您可能需要稍后进行差异或回滚。
2.  创建一个名为 WPML-extensions 的新插件（或其他）
3.  在原始插件代码中搜索要使用的操作或过滤器。如果它们已经可用并且可以满足您的需要，请通过从 WPML 扩展插件连接到它们来使用它们。
4.  如果 WPML 插件中不存在正确的钩子，请添加它们，然后按照上述步骤操作。尝试使用最新版本的原始插件，以最大限度地提高您的更改被接受的机会。
5.  如果您通过添加操作或过滤器修改了原始插件，请执行 a`git diff`保存补丁，以便稍后重新应用。将补丁提交给原始插件作者并希望最好。如果您只坚持操作和过滤器，作者很可能会立即接受您的更改。
6.  如果您稍后更新原始插件，则需要重新应用您的更改，直到它们被接受。您可以使用该差异文件。可能有一种方法可以`git rebase`用来重播您在更新插件后所做的更改。

# java - 如何从静态方法显示对话框

> ID：13377300
> 
> 赞同：3
> 
> 时间：2012-11-14T10:45:09.070
> 
> 标签：java, android, dialog, cocos2d-x, android-context

在我为 Android 和 IOS 使用的游戏中`cocos2dx`，我必须显示视频（适用于 Android）。我打算在对话框中显示它（在游戏视图的顶部）。问题是，我没有引用任何活动来显示对话框（因为对话框只能在活动中显示）。即使在 cocos2dx lib 文件夹中，有一个`Cocos2dxActivity`但我不知道如何使用它。从 C++ 代码中，我从 Java 类调用静态方法，如下所示

```
void LMJNICommunicator::showVideo()
{
     LOGD("initialiseDatabase inside LMJNICommunicator");

     jmethodID methodID = 0;
     JNIEnv *pEnv = 0;
     pEnv = getJNIEnv();
     jclass ret = pEnv->FindClass("com/mobinius/lostmonstersclass/LMDatabaseDataManager");
     methodID = pEnv->GetStaticMethodID(ret, "showVideo", "()V");

     if (! methodID)
     {
          LOGD("Failed to find static method id of %s", "showVideo");
          return;
     }

     pEnv->CallStaticVoidMethod(ret,methodID);
     pEnv->DeleteLocalRef(ret);

} 
```

我从 C++ 代码调用的静态方法（在普通 Java 类中）

```
Class LMDatabaseDataManager {

    public static void showVideo() {

         Dialog dialog = new Dialog(Cocos2dxActivity.getInstance());
         dialog.show();
        // getting Can't create handler inside thread that has not called Looper.prepare() error
    }
} 
```

我试图`Handler`像[这样](https://stackoverflow.com/questions/11483275/how-can-i-send-message-to-handler-from-a-static-function)使用但没有得到结果（在那篇文章中得到了同样的错误）。也试图得到这样`Context`的[静态](https://stackoverflow.com/questions/2002288/static-way-to-get-context-on-android)。

那么，我的方法正确吗？如果不正确，请建议我如何实现相同的方法。谢谢。

**编辑：**

终于得到了这个答案。早些时候，我尝试在具有应用程序静态上下文的 UI 线程上运行，如在[此](https://stackoverflow.com/questions/2002288/static-way-to-get-context-on-android)链接中，但没有得到......使用 Cocos2dxActivity 活动实例我得到了它。

```
Class LMDatabaseDataManager {

    public static void showVideo() {        

    Cocos2dxActivity.getInstance().runOnUiThread(new Runnable() {

        @Override
        public void run() {
            // TODO Auto-generated method stub
            Dialog dialog = new Dialog(Cocos2dxActivity.getInstance());
            dialog.show();            
        }
    });

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T13:19:00.240

尝试在 Cocos2dxActivity 中添加适当的行：

```
public class Cocos2dxActivity extends Activity {
    private static Cocos2dxActivity instance = null;
   @Override public void onCreate(Bundle b) {
     ...
     this.instance = this;
     }

     public static Cocos2dxActivity getInstance() {
        return instance;
     }

} 
```

当您要创建对话框时：

```
if (Cocos2dxActivity.getInstance() != null)  {
    AlertDialog dialog = new AlertDialog(Cocos2dxActivity.getInstance());
    // rest of your dialog code goes here
} 
```

# java - 如何链接以纯文本形式显示的 URL？

> ID：13377302
> 
> 赞同：1
> 
> 时间：2012-11-14T10:45:22.500
> 
> 标签：java, html

如何链接以纯文本形式显示的 URL？例如，

> 今天我想分享一个链接：www.google.com

我想通过放置`<a>`标签使“www.google.com”可点击。我是否必须使用 Java 字符串解析工具检测 URL 和链接并`<a>`在它们周围放置标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:56:35.720

您可以使用[Matthew O'Riordan 页面](http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the)中的正则表达式来匹配带有或不带有协议部分的 URL：

```
/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[.\!\/\\w]*))?)/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-06T14:56:25.287

您可以使用简单易用的[Linkify](https://github.com/HitSend/jQuery-linkify/)，它将以纯文本形式将给定选择器中的链接包围到链接。

# c - 关闭 Linux 套接字后的奇怪程序行为

> ID：13377305
> 
> 赞同：2
> 
> 时间：2012-11-14T10:45:43.417
> 
> 标签：c, linux, sockets

我正在研究Linux/UNIX套接字，所以我基于它写了一个非常简单的“游戏”，叫做“21匹配”。有一个由 21 场比赛组成的堆，每个玩家从中取一场、两场或三场比赛。拿下最后一场比赛的人输掉比赛。

显然，获胜的关键是在对手的回合中补充最多 4 场比赛，因此他必须参加最后一场比赛（仅当您进行第一回合时才有效）。因此，客户端连接到服务器并与服务器“玩”直到他输了。可以连接多个客户端，因此我限制了连接数，使我的主机拒绝任何其他客户端。

我唯一无法解决或解释的问题是，当有人被拒绝时，第一个客户会*立即*输掉比赛，即使他没有转弯。如果我让新客户端接触任何客户端的堆，这可能会得到解释，但我没有！我还跟踪了缓冲区数组，但它没有受到任何损害。

这是代码：

```
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <netinet/in.h>
#include <stdio.h>
#include <poll.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

void die (const char *s, int errcode);
int mkservsock();
void acceptclient();
void dropclient (int client);
void make_turn (int client);

enum
{
  port   = 3333,
  buf_s  = 100,
  limit  = 3
};

void die (const char *s, int errcode)
{
  perror (s);
  exit (errcode);
}

struct pollfd fds[limit + 1];  // client socket descriptors array
int left[limit + 1];           // how many matches left
int nfd = 1;                   // number of the next client
char buffer[buf_s];            // buffer for communicating

// creates a single socket to poll
int mkservsock()
{
  int s = socket (AF_INET, SOCK_STREAM, 0);
  struct sockaddr_in addr;
  addr.sin_family = AF_INET;
  addr.sin_port = htons (port);
  addr.sin_addr.s_addr = INADDR_ANY;
  if (bind (s, (struct sockaddr *)&addr, sizeof(addr)) == -1)
    die ("Can't bind socket", 1);

  if (listen (s, 1) == -1)
    die ("Can't start listening", 1);

  return s;
}

// adds new client to descriptors array or rejects it, if number of connections exceeds the limit
void acceptclient()
{
  int c = accept (fds[0].fd, 0, 0);
  fds[nfd].fd = c;
  fds[nfd].events = POLLIN;
  if (nfd == limit + 1)
  {
    sprintf (buffer, "Server is busy, try again later\n");
    send (fds[nfd].fd, buffer, strlen (buffer), 0);
    close (fds[nfd].fd);
    return;
  } else
  {
    left[nfd] = 21;
    sprintf (buffer, "Matches available: %d\nTake 1, 2 or 3!\n", left[nfd]);
    send (fds[nfd].fd, buffer, strlen (buffer), 0);
    nfd++;
  }
}

// disconnects a client in case of match ending or inappropriate data sent
void dropclient (int client)
{
  int i, j;
  close (fds[client].fd);
  for (i = client; i < nfd - 1; i++)
  {
    fds[i] = fds[i + 1];
    left[i] = left[i + 1];
  }
  nfd--;
}

void make_turn (int client)
{
  int n = recv (fds[client].fd, buffer, buf_s, 0);
  if (n == 0) {
    dropclient (client);
    return;

  } else if (n > 3)
  {
    // input counts as incorrect if it contains more than 1 symbol,
    // since we expect a single digit and nothing else
    // (yep, we get two extra bytes when receiving a message)
    sprintf (buffer, "I can break rules, too. Goodbye.\n");
    send (fds[client].fd, buffer, strlen (buffer), 0);
    dropclient (client);
    return;
  }

  // way to extract a digit from the character
  int received = buffer[0] - '0';  
  if (received > 3 || received <= 0)
  {
    sprintf (buffer, "You're allowed to take 1, 2 or 3 matches only\n");
    send (fds[client].fd, buffer, strlen (buffer), 0);
    return;

  } else if (received > left[client])
  {
    sprintf (buffer, "You can't take more than %d\n", left[client]);
    send (fds[client].fd, buffer, strlen (buffer), 0);
    return;

  } else  
  {
    // obviously, it happens only when there's the only match,
    // and the client has to take it
    if (left[client] == received)
    {
      sprintf (buffer, "You lost!\n");
      send (fds[client].fd, buffer, strlen (buffer), 0);
      dropclient (client);
      return;

    } else
    {
      // sort of "keeping the game up"
      left[client] -= 4;
      sprintf (buffer, "Matches left: %d (I took %d)\n", left[client], 4 - received);
      send (fds[client].fd, buffer, strlen (buffer), 0);
      return;
    }  
  }
}

int main (int argc, char *argv[])
{
  fds[0].fd = mkservsock ();
  fds[0].events = POLLIN;

  for (;;)
  {
    int status, i;
    status = poll (fds, nfd, -1);
    if (status == -1)
      die ("Error while polling", 1);

    if (fds[0].revents & POLLIN)
      acceptclient();

    for (i = 1; i < nfd; i++)
    {
      if (fds[i].revents & POLLERR)
      {
        printf ("Got troubles on %d\n", i);
        continue;
      }

      if (fds[i].revents & POLLIN)
        make_turn (i);
    }
  }
} 
```

这是第一个客户在达到最大值后发生的事情。连接数：

```
Matches available: 21
Take 1, 2 or 3! 
```

*（不要拿任何东西，同时有人连接并被拒绝）*

*（在此之后，发布任何数字，它会说堆中只有一个匹配项）*

```
1
You lost! 
```

请注意，当且**仅**当您的输入等于剩余的匹配数时，您才会输。发生什么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:06:55.180

你覆盖`left[]`, 当你打电话时`acceptclient()`，不要检查是否有空间`fds`来存储新的连接。

您首先初始化新客户端`fds`，然后拒绝连接，但为时已晚，因为您在数组之外写入了一个条目。除了数组之外，还有一个`left[]`数组，它现在存储了一个 1 或 0。因此，无论第一个客户如何回应，他总是选择最后一个。

# objective-c - quickDialog 表单的通用类

> ID：13377312
> 
> 赞同：0
> 
> 时间：2012-11-14T10:46:00.123
> 
> 标签：objective-c, ios, json, generic-programming, quickdialog

让我首先解释一下情况。我正在制作一个与 web 服务和 web 应用程序一起使用的 IOS 应用程序。举个例子。

假设我们有 X 公司。X 公司可以使用 web 应用程序制作各种表格（回调表格、会议请求表格、假期请求表格......）然后雇主将打开他们的应用程序并在表格视图中查看这些表格的所有标题。当他们点击一个标题时，他们会转到下一个屏幕并查看整个表单并开始填写它。

这里的困难是每个公司都可以创建自己的表格。所以X公司可能除了Y公司还有其他类型的表格。经过大量研究，我发现了QuickDialog这个神奇的库。你可以在[这里](http://escoz.com/open-source/quickdialog)找到它。绝对值得一试！

**问题** 好的，现在是问题。一旦用户填写表格，数据应该被发送回服务器。为此，我正在使用控制器类和 NSObject 类。最好的理解方法是查看登录示例。首先，这是登录的json。

```
{
    "grouped": true,
    "title": "Login Form",
    "controllerName": "LoginController",
    "sections": [
        { "title":"login", "elements": [
                { "type":"QEntryElement", "title":"Login","placeholder":"Login or email", "bind":"textValue:login", "key":"login"},
                {  "type":"QEntryElement", "title":"Password", "placeholder":"Password",  "secureTextEntry":true, "bind":"textValue:password" }
            ]
        },
        { "elements":[
                { "type":"QButtonElement", "key":"button", "title":"Login", "controllerAction":"onLogin:"}
            ]
        }
    ]
} 
```

可以看到这两个字段都有一个绑定选项。该项目包含一个 NSObject 类 (loginInfo) 在此类中，这些字段被添加为 NSStrings。

```
@interface LoginInfo : NSObject {
@private
    NSString *_password;
    NSString *_login;
} 
@property(strong) NSString *login;
@property(strong) NSString *password;
@end 
```

接下来是一个控制器类。在这个控制器类中，您说当按钮被按下时，您从文本字段中获取值到这个 loginInfo 类中。这是通过以下方式完成的。

```
- (void)onLogin:(QButtonElement *)buttonElement {

    [[[UIApplication sharedApplication] keyWindow] endEditing:YES];
    [self loading:YES];
    LoginInfo *info = [[LoginInfo alloc] init];
    [self.root fetchValueUsingBindingsIntoObject:info];
    [self performSelector:@selector(loginCompleted:) withObject:info afterDelay:2];
}
- (void)loginCompleted:(LoginInfo *)info {
    [self loading:NO];
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Welcome" message:[NSString stringWithFormat: @"Hi %@, I hope you're loving QuickDialog! Here's your pass: %@", info.login, info.password] delegate:self cancelButtonTitle:@"YES!" otherButtonTitles:nil];
    [alert show];
} 
```

好的，我知道这是很多信息。但我只想很好地解释我的问题。我认为控制器类不是我的问题，但 NSObject 类是。我希望这是通用的。因为这应该填充它从 json 中返回的属性。我不知道我该怎么做。

我希望有人能帮助我！如果您需要更多解释，请随时询问！

亲切的问候和非常感谢提前！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T14:31:37.770

`fetchValueUsingBindingIntoObjects:`需要一个“id”，这意味着几乎任何支持 KVC 的对象都会这样做：

```
NSMutableDictionary *dict = [NSMutableDictionary new];
[self.root fetchValueUsingBindingsIntoObject:dict]; 
```

通过这种方式，您可以获取有关任何表单的数据，并使用它将其发送回网络。

# sql - 带有附加信息的 unpivot()

> ID：13377315
> 
> 赞同：0
> 
> 时间：2012-11-14T10:46:11.547
> 
> 标签：sql, sql-server, tsql, unpivot

我有一些数据，例如：

```
t   starttime                 endtime

1   2012-11-13 07:00:00.000   2012-11-13 09:00:00.000
1   2012-11-13 09:00:00.000   2012-11-13 09:15:00.000
2   2012-11-13 09:00:00.000   2012-11-13 16:00:00.000
1   2012-11-13 09:15:00.000   2012-11-13 12:00:00.000
1   2012-11-13 12:30:00.000   2012-11-13 15:00:00.000
1   2012-11-14 07:00:00.000   2012-11-14 09:00:00.000
1   2012-11-14 09:00:00.000   2012-11-14 09:15:00.000
1   2012-11-14 09:15:00.000   2012-11-14 12:00:00.000
1   2012-11-14 12:30:00.000   2012-11-14 15:00:00.000
1   2012-11-15 07:00:00.000   2012-11-15 09:00:00.000
1   2012-11-15 09:00:00.000   2012-11-15 09:15:00.000
1   2012-11-15 09:15:00.000   2012-11-15 12:00:00.000
1   2012-11-15 12:30:00.000   2012-11-15 15:00:00.000 
```

并希望对其进行预处理，例如：

```
timestamp               t   x

2012-11-13 07:00:00.000 1   1
2012-11-13 09:00:00.000 1   0
2012-11-13 09:00:00.000 1   1
2012-11-13 09:00:00.000 2   1
2012-11-13 09:15:00.000 1   0
2012-11-13 09:15:00.000 1   1
2012-11-13 12:00:00.000 1   0
2012-11-13 12:30:00.000 1   1
2012-11-13 15:00:00.000 1   0
2012-11-13 16:00:00.000 2   0
2012-11-14 07:00:00.000 1   1
2012-11-14 09:00:00.000 1   0
2012-11-14 09:00:00.000 1   1
2012-11-14 09:15:00.000 1   0
2012-11-14 09:15:00.000 1   1
2012-11-14 12:00:00.000 1   0
2012-11-14 12:30:00.000 1   1
2012-11-14 15:00:00.000 1   0
2012-11-15 07:00:00.000 1   1
2012-11-15 09:00:00.000 1   0
2012-11-15 09:00:00.000 1   1
2012-11-15 09:15:00.000 1   0
2012-11-15 09:15:00.000 1   1
2012-11-15 12:00:00.000 1   0
2012-11-15 12:30:00.000 1   1
2012-11-15 15:00:00.000 1   0 
```

`x`应该定义，如果值`timestamp`来自`starttime`(x = 1) 或来自`endtime`(x = 0)。我知道，这是小菜一碟，使用两个`selects`和一个`union all`。

但我想知道**是否可以使用`unpivot()`**一些扩展？开始像：

```
SELECT 
    , UD."timeStamp"
    , UD."t"
    , "isStart"
FROM 
    (
        SELECT 
              "StartTime"
            , "EndTime"
            , "t"
            , < REFERENCE TO STARTTIME OR ENDTIME ? >
        FROM 
            Data 
    ) AS BC
UNPIVOT ( "timeStamp" FOR dummy IN ( "StartTime", "EndTime" )) AS UD 
```

`< REFERENCE TO STARTTIME OR ENDTIME ? >`应该提供信息，从哪个列 timeStamp 来自...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:50:39.933

像这样的东西怎么样，只需`CASE`对其应用一个声明：

```
select timestamp,
  t,
  case when col = 'starttime' then 1 else 0 end x
from yourtable
unpivot
(
  timestamp for col in (starttime, endtime)
) un 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/e95b3/2)

如果您不使用该`CASE`语句，则该`col`字段仅显示值`starttime`或`endtime`.

结果：

```
|                       TIMESTAMP | T | X |
-------------------------------------------
| November, 13 2012 07:00:00+0000 | 1 | 1 |
| November, 13 2012 09:00:00+0000 | 1 | 0 |
| November, 13 2012 09:00:00+0000 | 1 | 1 |
| November, 13 2012 09:15:00+0000 | 1 | 0 |
| November, 13 2012 09:00:00+0000 | 2 | 1 |
| November, 13 2012 16:00:00+0000 | 2 | 0 |
| November, 13 2012 09:15:00+0000 | 1 | 1 |
| November, 13 2012 12:00:00+0000 | 1 | 0 |
| November, 13 2012 12:30:00+0000 | 1 | 1 |
| November, 13 2012 15:00:00+0000 | 1 | 0 |
| November, 14 2012 07:00:00+0000 | 1 | 1 |
| November, 14 2012 09:00:00+0000 | 1 | 0 |
| November, 14 2012 09:00:00+0000 | 1 | 1 |
| November, 14 2012 09:15:00+0000 | 1 | 0 |
| November, 14 2012 09:15:00+0000 | 1 | 1 |
| November, 14 2012 12:00:00+0000 | 1 | 0 |
| November, 14 2012 12:30:00+0000 | 1 | 1 |
| November, 14 2012 15:00:00+0000 | 1 | 0 |
| November, 15 2012 07:00:00+0000 | 1 | 1 |
| November, 15 2012 09:00:00+0000 | 1 | 0 |
| November, 15 2012 09:00:00+0000 | 1 | 1 |
| November, 15 2012 09:15:00+0000 | 1 | 0 |
| November, 15 2012 09:15:00+0000 | 1 | 1 |
| November, 15 2012 12:00:00+0000 | 1 | 0 |
| November, 15 2012 12:30:00+0000 | 1 | 1 |
| November, 15 2012 15:00:00+0000 | 1 | 0 | 
```

# xml - xslt1中重复节点的xml元素xsl分组到html表输出

> ID：13377317
> 
> 赞同：0
> 
> 时间：2012-11-14T10:46:14.697
> 
> 标签：xml, xslt, xml-parsing, xslt-1.0, xsl-grouping

我有一个复杂的 xml 结构，如下所示：

```
 <Items>
      <Item>
          <ItemTexts>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description11</ItemTextsTypeDesc>
              <ItemTextsLine>1</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description12</ItemTextsTypeDesc>
              <ItemTextsLine>2</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description21</ItemTextsTypeDesc>
              <ItemTextsLine>3</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description22</ItemTextsTypeDesc>
              <ItemTextsLine>4</ItemTextsLine>
            </ItemText>
          </ItemTexts>
         </Item>
    <Item>
          <ItemTexts>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description11</ItemTextsTypeDesc>
              <ItemTextsLine>1</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description12</ItemTextsTypeDesc>
              <ItemTextsLine>2</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description21</ItemTextsTypeDesc>
              <ItemTextsLine>3</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description22</ItemTextsTypeDesc>
              <ItemTextsLine>4</ItemTextsLine>
            </ItemText>
          </ItemTexts>
         </Item>
<Item>
          <ItemTexts>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description11</ItemTextsTypeDesc>
              <ItemTextsLine>1</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type1</ItemTextsType>
              <ItemTextsTypeDesc>description12</ItemTextsTypeDesc>
              <ItemTextsLine>2</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description21</ItemTextsTypeDesc>
              <ItemTextsLine>3</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description22</ItemTextsTypeDesc>
              <ItemTextsLine>4</ItemTextsLine>
            </ItemText>
          </ItemTexts>
         </Item>
    <Item>
          <ItemTexts>
            <ItemText>
              <ItemTextsType>type3</ItemTextsType>
              <ItemTextsTypeDesc>description31</ItemTextsTypeDesc>
              <ItemTextsLine>1</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type3</ItemTextsType>
              <ItemTextsTypeDesc>description32</ItemTextsTypeDesc>
              <ItemTextsLine>2</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description21</ItemTextsTypeDesc>
              <ItemTextsLine>3</ItemTextsLine>
            </ItemText>
            <ItemText>
              <ItemTextsType>type2</ItemTextsType>
              <ItemTextsTypeDesc>description22</ItemTextsTypeDesc>
              <ItemTextsLine>4</ItemTextsLine>
            </ItemText>
          </ItemTexts>
         </Item>
    </Items> 
```

每个`<Item>`都有更多的 xml 元素，但我现在不会指定它们。

我在每个项目上使用 xsl 运行，例如：

```
<xsl:for-each select="Items/Item"> 
```

`<Item>`我为每行中的每一行和许多行生成表格`<td>`。

我需要一个示例来说明如何`<ItemText>`为`<ItemTextsType>`每个单独分组`<Item>`。

我会将结果安排在如下表格中：

```
 <table>
    <%--tr for each Item in Items--%>
    <tr>
        <td>
            some value from xml element according <b> Item1 </b>
        </td>
        <td>
            some more value from xml element according <b> Item1 </b>
        </td>
        <%--
        .
        .
        .
--%>
        <td>
            <table width="100%" dir="ltr">
                <tbody>
                    <tr style="background-color: #507CD1; text-align: center">
                        <td colspan="3" style="font: bold; color: white">
                            Item1
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 35px; font: bold; color: #507CD1;">
                            type1
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description11
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description12
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 35px; font: bold; color: #507CD1;">
                            type2
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description21
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description22
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
            even more value from xml element according <b> Item1 </b>
        </td>
        <%--
        .
        .
        .
        --%>
    </tr>
   <tr>
        <td>
            some value from xml element according <b> Item2 </b>
        </td>
        <td>
            some more value from  xml element according <b> Item2 </b>
        </td>
        <%--
        .
        .
        .
--%>
        <td>
            <table width="100%" dir="ltr">
                <tbody>
                    <tr style="background-color: #507CD1; text-align: center">
                        <td colspan="3" style="font: bold; color: white">
                            Item2
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 35px; font: bold; color: #507CD1;">
                            type1
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description11
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description12
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 35px; font: bold; color: #507CD1;">
                            type2
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description21
                        </td>
                    </tr>
                    <tr>
                        <td>
                            description22
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
            even more value from according <b> Item2 </b>
        </td>
        <%--
        .
        .
        .
        --%>
    </tr>
   <%-- and so on--%>
</table> 
```

关键是每个都有单独的分组`<Item>`到它自己的`<tr><td><table>` 里面，`<table>`里面有分组依据`<ItemTextsType>`

我尝试过类似的东西

```
<xsl:key name="item-texts-type" match="ItemText" use="ItemTextsType" />

<xsl:for-each select="ItemTexts/ItemText[count(. | key('item-texts-type', ItemTextsType)[1]) = 1]">

                        <xsl:sort select="ItemTextsType" />
                        <tr>
                          <td style ="height:35px;font: bold; color:#507CD1;">
                            <xsl:value-of select="ItemTextsType" />
                          </td>
                        </tr>

                        <xsl:for-each select="key('item-texts-type', ItemTextsType)">
                          <tr>
                            <td>
                               <xsl:value-of select="ItemTextsTypeDesc" />
                            </td>
                          </tr>
                        </xsl:for-each>

                      </xsl:for-each> 
```

但它只适用于**非**重复节点（如果只有一个`<Item>`它会正常工作）。 **我无法更改 xml 因为它来自 customer 。**

请帮助我，我需要它尽快。

谢谢 ！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:54:16.460

如果您想为每个单独分组，`Item`那么实现该目标的一种方法是包含一些唯一标识符`Item`作为键值的一部分，例如

```
<xsl:key name="item-texts-type" match="ItemText"
         use="concat(generate-id(ancestor::Item), '|', ItemTextsType)" />

<!-- assuming the context node is the current Item -->
<xsl:variable name="currentItemId" select="generate-id()" />

<xsl:for-each select="ItemTexts/ItemText[count(. | key('item-texts-type',
        concat($currentItemId, '|', ItemTextsType))[1]) = 1]">
  <!-- .... -->
  <xsl:for-each select="key('item-texts-type',
        concat($currentItemId, '|', ItemTextsType))"> 
```

如果您当然可以使用 XSLT 2.0，这将更加直接......

# php - bash脚本输出未显示在网页上

> ID：13377318
> 
> 赞同：1
> 
> 时间：2012-11-14T10:46:25.963
> 
> 标签：php, javascript, jquery, html, bash

我正在尝试将 bash 脚本的输出显示到我网页上的 div 中。但是当我加载页面时，什么都没有出现。这是我到目前为止所拥有的。

jQuery ajax 函数。Discon 是信息应该出现的 div 的名称。

```
$(document).ready(function() {
    $.ajax({
            type: "POST",
            url:  "discon.php",
            data: "Discontinuities",
            success: function(data) {
            $('#discon').html(data)
            }
    });
 }); 
```

这是我的 php 以获取 jquery 中的内容。请注意，注释掉的部分是我在 php 中尝试不同选项的地方。我已经尝试了几次，但似乎没有任何效果。

```
<?php

 echo passthru('/opt/bin/enc_current_test');

//$discon = exec('/opt/bin/enc_current_test', $o, $r);
//if ($r != 0){
//      print 'Error running command';
//      exit($r);
//}
//else{
//      print implode("\n", $o);
//}

?> 
```

我有另一个 bash 脚本在不同的 Div 中显示到同一页面，它工作正常，所以我的问题是为什么这个脚本会给我带来问题。这是 bash 脚本。

```
#!/bin/bash

while [ true ]
do
    counter=0

    clear
    date

    dir=/test/`date "+%Y/%m/%d"`

    cd $dir
    echo Writing On: `pwd`

            for i in `ls`
            do
                    if [ -n "$(ls -l $i/* | grep `date "+ %k:%M"`)" ];
                    then
                            echo $i
                            let "counter+=1"
                    fi
            done
    echo
    echo "Total Current Streams: "
    echo $counter
    sleep 60
    clear
done 
```

我在想这是因为脚本休眠了 60 秒，但是我在我的 html 中添加了标签以在相同的时间间隔刷新页面，但它仍然不起作用。关于为什么这个脚本不会显示的任何想法？在这一点上有点不知所措。感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:52:25.843

去掉`echo`前面的`passthru()`。

`passthru()`不返回任何东西（void），它直接输出。因此，您当前的声明与此相呼应`void`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:29:34.953

你的 bash 脚本运行无限循环

```
while [ true ]
do
...
done 
```

Web 服务器一直在等待脚本的答案，并且不会将其发送给客户端（浏览器）

尝试在 bash 脚本中评论 while loop 和 sleep 命令

我也猜你不想看到 clear 命令写的额外字符，所以也评论一下

```
#!/bin/bash

#while [ true ]
#do
    counter=0

#    clear
    date

    dir=/test/`date "+%Y/%m/%d"`

    cd $dir
    echo Writing On: `pwd`

            for i in `ls`
            do
                    if [ -n "$(ls -l $i/* | grep `date "+ %k:%M"`)" ];
                    then
                            echo $i
                            let "counter+=1"
                    fi
            done
    echo
    echo "Total Current Streams: "
    echo $counter
#    sleep 60
#    clear
#done 
```

# regex - 使用 sed linux 在具有特定字符串的行中输出一个数字

> ID：13377319
> 
> 赞同：2
> 
> 时间：2012-11-14T10:46:27.320
> 
> 标签：regex, linux, sed, compare

我有如下输入。

```
Curveplot
Time
Maxima of Curve
Part no.
13 #pts=2
* Minval=   0.000000e+000 at time=        0.000000
* Maxval=   2.237295e+000 at time=        0.001000
   0.000000e+000       0.000000e+000
   9.999999e-004       2.237295e+000
endcurve 
```

我想从这个文件中取出最大值，也就是 Maxval 之后的值

```
* Maxval=   2.237295e+000 
```

有人可以建议如何用 linux sed 来做吗？我的输出只会是数字 2.237295e+000。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:01:38.953

使用下面的单行只会显示`2.237295e+000`

`sed -nr 's/.*Maxval= *([^ ]*).*/\1/p'`

正则表达式：

```
Match:
.*      # match any characters
Maxval= # upto 'Maxval='
 *      # match multiple spaces (that is a space followed by *)
([^ ])  # match anything not a space, use brackets to capture (save this) 
.*      # match the rest of line

Replace with:
\1      # the value that a was captured in the first set of brackets. 
```

因此，我们有效地将包含单词的整行替换为`Maxval=`的值`Maxval`。

*注意：根据`sed`您可能需要使用的平台和/或实现，`-E`而不是`-r`.*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:53:08.483

单程：

```
sed -n 's/.*Maxval=\s*\([^ ]*\).*/\1/p' file.txt 
```

结果：

```
2.237295e+000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:55:45.543

提议：

`cat test.txt | grep Maxval | sed -e 's/^.*Maxval= *//' -e 's/ at.*$//' 2.237295e+000`

*   cat 将文件显示到标准输出
*   grep 只保留有趣的行
*   第一个 sed 正则表达式删除行首直到空格结束
*   第二个 sed 正则表达式删除 'at' 直到行尾

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:01:11.217

```
awk '/Maxval=/{print $3}' your_file 
```

测试如下：

```
> cat temp
Curveplot
Time
Maxima of Curve
Part no.
13 #pts=2
* Minval=   0.000000e+000 at time=        0.000000
* Maxval=   2.237295e+000 at time=        0.001000
   0.000000e+000       0.000000e+000
   9.999999e-004       2.237295e+000
endcurve
> awk '/Maxval=/{print $3}' temp
2.237295e+000 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T12:57:50.940

你也可以用 grep 来做：

```
<infile grep -o 'Maxval= *[^ ]\+' | grep -o '[^ ]\+$' 
```

输出：

```
2.237295e+000 
```

# java - 我应该如何对调用 MySQL 存储过程的 Java 进行单元测试？

> ID：13377324
> 
> 赞同：9
> 
> 时间：2012-11-14T10:46:49.137
> 
> 标签：java, mysql, unit-testing

我正在编写一个简单的应用程序，它将读取一些记录并将它们插入数据库。我已经编写了一个处理插入逻辑的存储过程，并计划单独测试它。现在我想为获取业务对象并将其传递给存储过程调用的逻辑部分编写一个好的单元测试。

我*想*我想要做的是传递数据库连接的模拟，然后断言调用是使用预期的参数值进行的：

```
Connection dbConnection = makeMockConnection();  // how?
MyObjectWriter writer = new MyObjectWriter(dbConnection);
writer.write(someSampleObject);
// somehow assert that dbConnection called
// `sp_saveMyObject` with param values x, y, and z 
```

然而，似乎有很多工作在里面挖掘`java.sql.Connection`，了解它是如何工作的，然后模拟所有的结果。是否有一个测试库可以为我完成所有这些工作？我是不是走错路了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:55:43.537

您可以使用模拟存储过程创建内存中的 HSSQL 数据库。模拟存储过程会在表中插入一行以显示它已运行以及它的参数是什么。运行被测代码，然后查看数据库以查看发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:29:24.723

如果你不关心`MyObjectWriter`它是如何工作的，那么我会倾向于编写一个集成测试而忘记一个单元测试。

你没有提到你是如何测试存储过程的，所以请原谅我，但我要做的是编写测试，围绕`MyObjectWriter`它调用数据库上的实际存储过程，然后验证数据库状态。如果可能的话，我会使用内存数据库来缩短测试持续时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:02:52.180

您可以使用装饰器设计模式进行连接模拟。您使用您使用的驱动程序创建与数据库的真实连接，该驱动程序由实现 Connection 接口的 ConnectionImpl 类包装，并将真实 Connection 作为成员。
您不想实际执行的每个真实调用，用模拟代码替换它，并且每个调用都保持调用真实连接对象的相同方法（委托调用）。
通过这种方式，您可以像往常一样进行编码，只是返回的对象与创建连接的方法不同。
现在，例如，在模拟对象（您的 ConnectionImpl）中，您可以添加检查输入的单元测试代码。

# javascript - 记录jQuery中调用的方法和参数

> ID：13377326
> 
> 赞同：2
> 
> 时间：2012-11-14T10:46:56.820
> 
> 标签：javascript, jquery, jquery-plugins

假设我有加载了几个插件的 jQuery。

我运行一些这样的代码：

```
$('someSelector').someMethod('someParam', 'someOtherParam');
$('someOtherSelector').someOtherMethod('anotherParam');
$('anotherSelector').anotherMethodWhichMayOrMayNotBeAPlugin(); 
```

我想为 jQuery 编写一个钩子，以记录我将持有的结构：

*   使用了什么选择器
*   调用了哪个方法
*   它得到了什么论据

我知道我可以覆盖两者`$()`以捕获选择器，并且可以向 jQuery 添加方法（通过编写插件），但我不完全确定如何获取方法的名称和参数，同时避免破坏 jQuery 及其插件的现有功能。

性能对这个来说不是很重要，所以任何动态的方式都可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:13:26.193

您可以遍历其中的所有函数`$.fn`并用您自己的函数替换它们中的每一个。

反过来，该函数可以记录调用它的 jQuery 对象的选择器及其接收的参数，然后调用原始函数。

就像是：

```
$.each($.fn, function(key, func) {
    if ($.isFunction(func)) {
        $.fn[key] = function() {
            console.log("Method '" + key + "' was called");
            console.log("  on selector '" + this.selector + "'");
            console.log("  with arguments: " + arguments);
            return func.apply(this, arguments);
        };
    }
}); 
```

# c# - 国际化向导在向导步骤之间传递模型数据

> ID：13377329
> 
> 赞同：2
> 
> 时间：2012-11-14T10:47:02.913
> 
> 标签：c#, wpf, mvvm, prism, wizard

我在这里找到了以下向导示例：http: [//www.codeproject.com/Articles/31837/Creating-an-Internationalized-Wizard-in-WPF](http://www.codeproject.com/Articles/31837/Creating-an-Internationalized-Wizard-in-WPF)

现在我花了很长时间看这个例子，我几乎理解了一切。但我不知道他是如何在不同的模型视图之间传递对象的。正如您可以想象的那样，这一步非常关键..

在示例中，他在主向导视图模型中使用了 CupOfCoffee 对象，并设法在整个向导中对其进行了调整。但我在任何地方都看不到他是如何做到的。

我已经尝试过像他一样重新创建一个项目，但没有成功。

谁能告诉我他是如何在不同的视图模型之间传递对象的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:58:23.967

`CupOfCoffee`通过 跨所有 ViewModel 共享`CoffeeWizardViewModel`，从而驱动整个向导。

它保持“全局”状态，并且从该状态继承的其他 ViewModel`CoffeeWizzardPageViewModelBase`仅包含一个页面的逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:01:35.247

只是一个疯狂的猜测：

在他正在初始化似乎是模型的`CreatePages()`每个 pageviewmodel 。`this.CupOfCoffee`

你知道你可以在 codeproject 下载完整的源代码吗？

# extjs3 - Extjs 3.4：ColumnModel 渲染器到其他数据索引？

> ID：13377332
> 
> 赞同：2
> 
> 时间：2012-11-14T10:47:05.730
> 
> 标签：extjs3

我的读者：

```
var reader = new Ext.data.JsonReader({
     totalProperty: 'total',
     successProperty: 'success',
     idProperty: 'id_k',
     root: 'rows',
     messageProperty: 'message'  // <-- New "messageProperty" meta-data }, [
     {name: 'id_k'},    {name: 'nm_kb', allowBlank: false},
     {name: 'id_p'},    {name: 'nm_p', allowBlank: false} ]); 
```

我的专栏：

> `{header: "Provinsi", width: 100, sortable: true, dataIndex: 'id_p'}`

**如何使 dataIndex: 'id_p' 显示为 'nm_p' 但仍然 dataIndex: 'id_p'？**

我希望它显示“nm_p”....

谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T10:53:28.940

在列上使用渲染器：

```
var Provinsi = {
   header: 'Provinsi',
   dataIndex: 'id_p',
   renderer: function(value, metaData, record, rowIndex, colIndex, store) {
      return record.data.nm_p;
   }
} 
```

[链接到文档](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.grid.Column-cfg-renderer)

# apache - Apache“别名”不包括某些域

> ID：13377344
> 
> 赞同：1
> 
> 时间：2012-11-14T10:47:31.187
> 
> 标签：apache, alias, subdomain

我在 Windows 上安装了 wampp 服务器。在这台服务器上，我有多个子域以及一些使用虚拟主机的主域运行。一个要求是自动为所有子域实现 robots.txt。例如：

```
site1.example.com

site2.example.com

site3.example.com

site1.example.net

site2.example.net 
```

因此，在 http.conf 中，我写了：

```
Alias /robots.txt D:/wampp/static-files/override-robots.txt 
```

以上满足了 example.com 和 example.net 上所有子域的要求，并且默认情况下，创建的每个新子域都将具有此 robots.txt，并且不必为每个子域放置单独的 robots.txt，但问题是有些主域也在这台服务器上，robots.txt 也从上面运行。例如：

```
www.primarydomain1.com

www.primardomain2.com 
```

现在，我想要的是 example.com 和 example.net 的所有子域都将自动从上面运行 robots.txt，不包括所有主域。可能是 Apache Alias 不是执行此操作的最佳方式，因此任何有关它的帮助或提示都会非常有帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T07:35:43.767

经过一些试验和运行，我找到了一个解决方案，我认为如果我在这里分享它可能会对某人有所帮助：

基本上，在 httpd.conf 文件中我写了：

```
Alias /robots.txt D:/wampp/static-files/override-robots.txt 
```

所以这将针对每个域和子域运行，但可以为每个域/子域的 vhosts 容器内的 vhosts 文件（即 httpd-vhosts.conf）中定义的特定域/子域覆盖它。因此，例如，如果我需要为 www.primarydomain1.com 提供不同的 robots.txt ：

```
<VirtualHost 212.212.212.212>
  DocumentRoot "D:/WebSites-Data/primarydomain1.com"
  ServerName primarydomain1.com
  ServerAlias www.primarydomain1.com
  ErrorLog "logs/primarydomain1.com-error.log"
  CustomLog "logs/primarydomain1.com-access.log" combined
  Alias /robots.txt D:/WebSites-Data/primarydomain1.com/this-robots.txt
</VirtualHost> 
```

所以这样如果有人点击 www.primarydomain1.com/robots.txt apache 将从

```
D:/WebSites-Data/primarydomain1.com/this-robots.txt 
```

对于其他域/子域，它继续提供服务：

```
Alias /robots.txt D:/wampp/static-files/override-robots.txt 
```

这也导致我们可以覆盖 httpd.conf 特定域的一些设置，如果我们在 vhosts 容器中定义它。

上述解决方案对我来说效果很好。如果此解决方案有任何缺点，请与我分享。

谢谢

# php - Jquery 从元素中获取 id 并包含在帖子中

> ID：13377345
> 
> 赞同：0
> 
> 时间：2012-11-14T10:47:38.467
> 
> 标签：php, javascript, jquery, ajax

有谁知道为什么这不起作用？

```
$(".v1").click(function(){
$.post("inc.php?action=vote&id="$(this).attr('id')"&vote=1");
});

$(".v2").click(function(){
$.post("inc.php?action=vote&id="$(this).attr('id')"&vote=2");
}); 
```

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:48:42.933

你错过了`+`连接之间

```
$(".v1").click(function(){
$.post("inc.php?action=vote&id=" + $(this).attr('id') + "&vote=1");
});

$(".v2").click(function(){
$.post("inc.php?action=vote&id=" + $(this).attr('id') + "&vote=2");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T10:49:36.183

您需要使用运算符将​​字符串连接到变量内容，`+`如下所示：

```
$.post("inc.php?action=vote&id=" + $(this).attr('id') + "&vote=1"); 
```

# vb.net - Visual Basics：如何对选定的文本或整个文档进行查找和替换？

> ID：13377347
> 
> 赞同：0
> 
> 时间：2012-11-14T10:47:40.467
> 
> 标签：vb.net, visual-studio-2010, replace

到目前为止，我已经能够为整个文本编写查找和替换代码。

```
Private Sub btnFFindNext_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnFFindNext.Click

    Dim search As String
    Dim length As String

    search = textToFind.Text 
    length = textToFind.Text.Length

        lastposition = RichTextBox.Find(textToFind.Text, lastposition, RichTextBoxFinds.None)

    RichTextBox.SelectionStart = lastposition
    RichTextBox.SelectionLength = length
    lastposition = lastposition + 1 
```

但是，我现在需要使它成为可能，以便如果用户选择一些文本，则仅对该选择执行查找和替换。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:34:44.413

您可以将 < [ricthTextBox.Find](http://msdn.microsoft.com/en-us/library/yab8wkhy%28v=vs.100%29.aspx) > 与 start 和 end 的参数一起使用（与您使用的类似）。
您可以从richTextBox 的事件（SelectionChanged）中获取第一个起点和终点

告诉我进展如何。

# http - HATEOAS Rel - 还有标准吗？

> ID：13377350
> 
> 赞同：24
> 
> 时间：2012-11-14T10:47:52.253
> 
> 标签：http, rest, hyperlink, asp.net-web-api, hateoas

我刚刚开始为我目前正在构建的 WebAPI 编写客户端实现。API 已经使用了 HATEOAS，所以我正在相应地编写客户端。我使用[RestSharp](http://restsharp.org/ "RestSharp")作为客户端的基础。

客户端在构建时（“ [https://myapi/start](https://myapi/start) ”）传递了 api 基本 URL，它会在该 URL 处触发请求，然后传递一组用于其他可用资源的 uri - 授权（“ [https://myapi/ authorize](https://myapi/authorize) ") 并请求访问令牌 (" [https://myapi/tokens](https://myapi/tokens) ") 以授权它调用 api 上的安全资源。

问题是对于返回的超媒体中的 rel="" 要求是否制定了任何标准？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-14T14:57:04.553

我相信[超文本应用语言](https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-08)(HAL) 是一个标准草案——试图标准化超媒体之间的这些链接。

这是 JSON 规范草案的链接[https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-03](https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-03)

HAL 规范强制“href”符合 Web 链接规范 (RFC 5988) 中定义的“目标 IRI”

这里有一个使用 C# 的 HAL 的 XML 实现[https://github.com/tavis-software](https://github.com/tavis-software)

上面相同的 GitHub 存储库还包含 RFC 5988 的示例 .Net 实现。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-03T15:18:27.250

正如另一个答案中所指出的， [Web 链接规范 RFC5988定义了一些不同类型的链接关系。](https://www.rfc-editor.org/rfc/rfc5988)但它也指示 IANA 创建链接关系注册并允许进一步的链接关系注册。该注册表是公共链接关系***的***最终列表，可在**[iana.org/assignments/link-relations](http://www.iana.org/assignments/link-relations/)**上找到，并将随着新关系的注册而更新。

HTTP API 中常用的关系包括：

*   `start`（从每个资源指向 API 起点）
*   `item`（从集合指向项目，例如从 Twitter 用户页面指向推文）
*   `collection`（反面`item`）
*   `previous`（接下来的四个用于分页资源，例如集合或多页文章）
*   `next`
*   `first`
*   `last`
*   `create-form`（从集合指向描述如何创建新集合项的资源，例如“新项”HTML 或 XForms 表单）
*   `edit-form`（从项目指向用于编辑该项目的表单，例如“编辑推文”按钮）

*如果该列表中的任何内容均未*涵盖您所需的关系，则您的关系**必须是 URI**。此外，建议在您控制的域中将该 URI 设置为可取消引用的 http URL，以便 API 客户端可以查找该关系的文档，例如`http://www.example.com/link-relations#tweets`. 通常，您的 API 起点将是一个集合列表，每个集合都有一个自定义链接关系，描述每个集合包含的资源类型。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-02-01T15:36:29.423

在进一步讨论 HATEOAS 标准之前，我想强调在实现 HATEOAS（现在也称为超媒体 API）的 API 中有三个主要概念：

*   HTTP 协议。在使用动词和返回码时，您必须尊重其约束。您还应该知道标题的作用，尤其是`Content-type`，以及一些动词的幂等性等微妙之处。有关更多信息，请参阅 RFC 2616
*   URI 结构。必须只提供有关定位资源的信息，并避免使用上下文数据。例如，已知的不良示例包括 language `/en/`、 version `/v01/`、 format`/json/`甚至`/do-something/`是 URI 中的动词。更多关于 RFC 3986 和 REST 指南
*   上下文数据，可以在正文、请求参数或标头中找到

REST 库的开发人员对 URI 和 HTTP 有严格的指导方针，但缺乏关于上下文数据以及它如何与请求的 JSON 正文中的应用程序数据混合的通用标准。

这就是为什么围绕 HATEOAS 的标准化工作主要是关于制定`media-type`. 旁边有好几个

*   [由 Mark Jones 概述的JSON HAL](https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-03)（约 2012 年）是最著名的
*   [Collections + JSON](http://amundsen.com/media-types/collection/format/) (ca 2013)，没有引起太多关注
*   [详细](https://verbose.readthedocs.io)（ca 2014）试图统一其他所有努力，但只有专家知道
*   [Siren](https://github.com/kevinswiber/siren) (ca 2017) 在 github 上有大约 1k 颗星
*   [JSON:API](https://jsonapi.org)（约 2015 年，但仍在进行中）是当前参考，其 1.0 版有很多实现，并得到了 Steve Klabnik 的支持，他围绕该主题创作了大量内容

关于您的原始问题，请参阅[此处](https://jsonapi.org/format/#document-resource-object-related-resource-links)`JSON:API`了解有关相关资源链接的说明。

希望这将帮助任何在 2019 年有同样担忧的人。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-14T14:51:31.433

这个 IETF 提议的标准[RFC5988 文档](http://tools.ietf.org/pdf/rfc5988.pdf)描述了不同类型的链接关系和提议的用法。它的重点是 HTTP 链接头规范，但它包括对其他链接关系类型的讨论。像一些（大多数？）RFC 一样，阅读它可能会让您比刚开始时更加困惑，但从长远来看，它值得付出努力。它会回答您问题中双引号之间的内容吗？可能不会，但至少你会得到一些想法来指导你的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-14T15:10:33.237

HAL 看起来确实很有趣。

对于其他研究此主题或 HATEOAS 的人来说，HAL 浏览器是必须的。查看以下链接：

[Heroku 上的 Hal 浏览器](http://haltalk.herokuapp.com//)

# c# - Unity：向 MSP/PD 客户端发送 OSC 消息

> ID：13377351
> 
> 赞同：0
> 
> 时间：2012-11-14T10:47:54.097
> 
> 标签：c#, unity3d, osc

我正在使用 Joe Garcia 的 UnityOSC 库，在 Joe Garcia 的库使用手册的帮助下，通过 AngryBots 演示从 Unity 游戏引擎发送 OSC 消息。我对如何使用这些文件有点困惑。我只是将文件导入当前的 Unity 项目，还是以某种方式安装为特定库？导入项目后，我是创建一个新的 C# 资产并调用函数，还是只是将 OSCHandler 脚本附加到我想要从中发送 OSC 的对象。尝试创建新的 C# 资产时，尝试使用 OSCHandler.SendMessagetoClient(); 等函数时出现编译器错误。因为需要非静态函数的对象引用。我为 OSCHandler 中的函数添加了“静态”前缀，但它只是在 Unity 控制台中引发了更多类似的错误，而且它没有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T01:42:19.703

您需要通过类的非静态实例调用这些函数，您可以使用`OSCHandler.Instance`ie访问该实例

```
OSCHandler.Instance.SendMessageToClient(); 
```

# javascript - 淘汰赛中的过去日期

> ID：13377352
> 
> 赞同：1
> 
> 时间：2012-11-14T10:47:54.877
> 
> 标签：javascript, knockout.js, datejs

我想在淘汰赛中获得过去的日期（比如昨天）。要获得当前日期，我写如下：

```
self.currentDate = ko.observable(new Date().toString('yyyy-M-dd')) 
```

但是如何在这里获得昨天的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:14:06.670

没有使用 date.js 库进行测试，但也许这样的东西可以工作：

```
var yesterday = Date.today().addDays(-1);
self.currentDate = ko.observable(yesterday.toString('yyyy-M-dd')); 
```

# excel - 删除“不”包含某些文本的 Excel 列，或仅复制包含某些文本的单元格

> ID：13377359
> 
> 赞同：1
> 
> 时间：2012-11-14T10:48:17.560
> 
> 标签：excel, excel-2010, vba

情况：

*   我有数百个 excel 文件（`.xls`和`.xlsx`）；
*   这些文件中的每一个都包含多个工作表；
*   这些表格中的每一个都有多列信息（在这种情况下，是联系方式）。
*   但是，所有文件（甚至任何文件中的任何工作表）的格式都不相同（例如，有时电子邮件地址可能在 J 列中，有时在 A 列或 D 列中，等等；有时它会被标记为“电子邮件”，有时它会被标记为“电子邮件地址”，有时它根本没有标签）。

**我需要将所有文件中所有工作表中的电子邮件地址放入一个单独的文本文件中。**

我正计划

1.  删除所有不包含电子邮件地址的列（即所有不包含“@”的列），然后将每个文件中的每个工作表转换为 csv/txt 文件。
2.  或从每个文件的每张纸中复制包含“@”的每个单元格并将其粘贴到一个 csv/txt 文件中。

我到底要怎么做呢？这些解决方案中的任何一个？任何人？

（注意：所有的 excel 文件都位于同一个文件夹中）

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:03:33.507

这是一种可能是您需要的 90% 的方法（在[vba](/questions/tagged/vba "显示标记为“vba”的问题")中，因为它更容易测试！）

简而言之：

1.  该代码用于`Dir`打开= "c:\temp\"下的每个*xls* * 文件`strDir`
2.  在该工作簿的每个工作表中找到真正的最后一个单元格以设置工作范围
3.  代码循环遍历该范围的每一行，并为“@”过滤该列的一维数组
4.  然后将过滤后的字符串写入[csv](/questions/tagged/csv "显示标记为“csv”的问题")文件

等等

*[更新：现在的代码]*

*- 循环通过行而不是列，这避免了大小问题，并且输出现在按行匹配输入文件*
*- 在电子邮件列表转储前加上工作簿和工作表名称*

**代码**

```
Sub GetEm()
Dim wb As Workbook
Dim ws As Worksheet
Dim rng1 As Range
Dim rng2 As Range
Dim rng3 As Range
Dim strFile As String
Dim strEmail As String
Dim strDir As String
Dim strFiltered As String
Dim objFSO As Object
Dim objTF As Object

With Application
    lngcalc = .Calculation
    .Calculation = xlCalculationManual
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set objFSO = CreateObject("scripting.filesystemobject")

strDir = "c:\tmp\"
strFile = Dir(strDir & "*.xls*")
Set objTF = objFSO.createtextfile(strDir & "output.csv", 2)

Do While Len(strFile) > 0
    Set wb = Workbooks.Open(strDir & strFile, False)
    For Each ws In wb.Sheets
        Set rng1 = ws.Cells.Find("*", ws.[a1], xlFormulas, , xlByRows, xlPrevious)
         'avoid blank sheets
        If Not rng1 Is Nothing Then
            Set rng2 = ws.Cells.Find("*", ws.[a1], xlFormulas, , xlByColumns, xlPrevious)
            Set rng2 = ws.Range(ws.[a1], ws.Cells(rng1.Row, rng2.Column))
            'avoid array errors on sheets with data only in A1
            If rng2.Columns.Count = 1 Then Set rng2 = rng2.Resize(rng2.Rows.Count, 2)
            For Each rng3 In rng2.Rows
            strFiltered = Join(Filter(Application.Transpose(Application.Transpose(rng3)), "@"), ",")
                If Len(strFiltered) > 0 Then
                objTF.writeline (wb.Name & "," & ws.Name & ",") & strFiltered
                End If
            Next
        End If
    Next
    wb.Close False
    strFile = Dir
Loop

Set wb = Workbooks.Open(strDir & "output.csv", False)
wb.Sheets(1).Columns.AutoFit

With Application
    .Calculation = lngcalc
    .EnableEvents = True
    .ScreenUpdating = True
End With 
```

结束子

# android - 如何创建下拉列表？

> ID：13377361
> 
> 赞同：251
> 
> 时间：2012-11-14T10:48:25.100
> 
> 标签：android, list, drop-down-menu, android-spinner

如何创建下拉列表？我已经尝试过 ScrollView 但这并不是我所需要的。

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2013-07-15T08:47:17.390

简单/优雅/我是怎么做的：

**预习：**

![在此处输入图像描述](../Images/4ef7ca64a96ccc4d585c0d2c7085e57a.png)

**XML:**

```
<Spinner
    android:id="@+id/spinner1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@android:drawable/btn_dropdown"
    android:spinnerMode="dropdown"/> 
```

`spinnerMode`设置`dropdown`为 androids 进行下拉的方式。（[https://developer.android.com/reference/android/widget/Spinner#attr_android:spinnerMode](https://developer.android.com/reference/android/widget/Spinner#attr_android:spinnerMode)）

**爪哇：**

```
//get the spinner from the xml.
Spinner dropdown = findViewById(R.id.spinner1);
//create a list of items for the spinner.
String[] items = new String[]{"1", "2", "three"};
//create an adapter to describe how the items are displayed, adapters are used in several places in android.
//There are multiple variations of this, but this is the basic variant.
ArrayAdapter<String> adapter = new ArrayAdapter<>(this, android.R.layout.simple_spinner_dropdown_item, items);
//set the spinners adapter to the previously created one.
dropdown.setAdapter(adapter); 
```

**文档：**

这是基础知识，但还有更多需要通过实验自学。 [https://developer.android.com/guide/topics/ui/controls/spinner.html](https://developer.android.com/guide/topics/ui/controls/spinner.html)

1.  您可以使用 setOnItemSelectedListener 。（[https://developer.android.com/guide/topics/ui/controls/spinner.html#SelectListener](https://developer.android.com/guide/topics/ui/controls/spinner.html#SelectListener)）
2.  您可以从 xml 添加字符串列表。（[https://developer.android.com/guide/topics/ui/controls/spinner.html#Populate](https://developer.android.com/guide/topics/ui/controls/spinner.html#Populate)）
3.  此视图有一个 appCompat 版本。（[https://developer.android.com/reference/androidx/appcompat/widget/AppCompatSpinner](https://developer.android.com/reference/androidx/appcompat/widget/AppCompatSpinner)）

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2012-11-21T21:48:49.457

微调器 xml：

```
<Spinner
      android:id="@+id/spinner"
      android:layout_width="wrap_content"
      android:layout_height="match_parent" /> 
```

爪哇：

```
public class MainActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener{

    private Spinner spinner;
    private static final String[] paths = {"item 1", "item 2", "item 3"};

    @Override
    protected void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_layout);

        spinner = (Spinner)findViewById(R.id.spinner);
        ArrayAdapter<String>adapter = new ArrayAdapter<String>(MainActivity.this,
                android.R.layout.simple_spinner_item,paths);

        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);
        spinner.setOnItemSelectedListener(this);

    }

    @Override
    public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {

        switch (position) {
            case 0:
                // Whatever you want to happen when the first item gets selected
                break;
            case 1:
                // Whatever you want to happen when the second item gets selected
                break;
            case 2:
                // Whatever you want to happen when the thrid item gets selected
                break;

        }
    }

    @Override
    public void onNothingSelected(AdapterView<?> parent) {
            // TODO Auto-generated method stub
        }

} 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2015-04-21T16:45:09.083

![在此处输入图像描述](../Images/7e98488058df3b44cb28cebe8e716c9e.png)

这是它的代码。

activity_main.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<Spinner
    android:id="@+id/static_spinner"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="20dp"
    android:layout_marginTop="20dp" />

<Spinner
    android:id="@+id/dynamic_spinner"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

字符串.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<string name="app_name">Ahotbrew.com - Dropdown</string> 
<string-array name="brew_array">
    <item>Cappuccino</item>
    <item>Espresso</item>
    <item>Mocha</item>
    <item>Caffè Americano</item>
    <item>Cafe Zorro</item>
</string-array> 
```

主要活动

```
Spinner staticSpinner = (Spinner) findViewById(R.id.static_spinner);

    // Create an ArrayAdapter using the string array and a default spinner
    ArrayAdapter<CharSequence> staticAdapter = ArrayAdapter
            .createFromResource(this, R.array.brew_array,
                    android.R.layout.simple_spinner_item);

    // Specify the layout to use when the list of choices appears
    staticAdapter
            .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    // Apply the adapter to the spinner
    staticSpinner.setAdapter(staticAdapter);

    Spinner dynamicSpinner = (Spinner) findViewById(R.id.dynamic_spinner);

    String[] items = new String[] { "Chai Latte", "Green Tea", "Black Tea" };

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, items);

    dynamicSpinner.setAdapter(adapter);

    dynamicSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
        @Override
        public void onItemSelected(AdapterView<?> parent, View view,
                int position, long id) {
            Log.v("item", (String) parent.getItemAtPosition(position));
        }

        @Override
        public void onNothingSelected(AdapterView<?> parent) {
            // TODO Auto-generated method stub
        }
    }); 
```

这个例子来自 [http://www.ahotbrew.com/android-dropdown-spinner-example/](http://www.ahotbrew.com/android-dropdown-spinner-example/)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-12-22T08:08:20.397

这段代码对我来说很好，希望它也能帮助你。

项目.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="1dip" >
    <TextView
        android:id="@+id/spinnerItem"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:padding="2dp"
        android:textSize="12sp" >
    </TextView>
</RelativeLayout> 
```

详细信息.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_marginBottom="20dp"
        android:background="#FF00FF">   
    <Spinner
            android:id="@+id/dropStatus"
            android:layout_width="250dp"
            android:layout_height="30dp"
            android:layout_marginBottom="7dp"
            android:drawSelectorOnTop="true"/> 
</LinearLayout> 
```

适配器类：

```
import java.util.ArrayList;

import android.content.Context;
import android.content.res.Resources;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.TextView;

public class StatusAdapter extends ArrayAdapter<StatusBean> {

    private Context context;
    private ArrayList<StatusBean> statuses;
    public Resources res;
    StatusBean currRowVal = null;
    LayoutInflater inflater;

    public StatusAdapter(Context context,
            int textViewResourceId, ArrayList<StatusBean> statuses,
            Resources resLocal) {
        super(context, textViewResourceId, statuses);
        this.context = context;
        this.statuses = statuses;
        this.res = resLocal;        
        inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {
        return getCustomView(position, convertView, parent);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        return getCustomView(position, convertView, parent);
    }

    public View getCustomView(int position, View convertView, ViewGroup parent) {
        View row = inflater.inflate(R.layout.status_item, parent, false);
        currRowVal = null;
        currRowVal = (StatusBean) statuses.get(position);
        TextView label = (TextView) row.findViewById(R.id.spinnerItem);
        if (position == 0) {
            label.setText("Please select status");
        } else {
            label.setText(currRowVal.getStatus());
        }

        return row;
    }
} 
```

状态豆类：

```
public class StatusBean {

    private String status;
    private String statusCode;

    public StatusBean() {
    }

    public StatusBean(String status,
            String statusCode) {
        this.status = status;
        this.statusCode = statusCode;
    }

    public String getStatus() {
        return status;
    }

    public void setStatus(String status) {
        this.status =  status;
    }

    public String getStatusCode() {
        return statusCode;
    }

    public void setStatusCode(String statusCode) {
        this.statusCode = statusCode;
    }
} 
```

活动课：

在 onCreate 方法里面：

```
static ArrayList<StatusBean> STATUS_LIST = new ArrayList<StatusBean>();

for(int i=0;i<=10;i++) {
STATUS_LIST.add(new StatusBean(“Status ”+i, “Stattus ”+i));
}

final Spinner  dropStatus = (Spinner)findViewById(R.id.dropStatus);
            Resources res = getResources(); 
            StatusAdapter adapter = new StatusAdapter(this, R.layout.item, SessionData. STATUS_LIST, res);
            dropStatus.setAdapter(adapter); 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-03-01T07:28:04.473

你需要一个`Spinner`. 这是一个例子：

```
spinner_1 = (Spinner) findViewById(R.id.spinner1);
spinner_1.setOnItemSelectedListener(this);
List<String> list = new ArrayList<String>(); 
list.add("RANJITH");
list.add("ARUN");
list.add("JEESMON");
list.add("NISAM");
list.add("SREEJITH");
list.add("SANJAY");
list.add("AKSHY");
list.add("FIROZ");
list.add("RAHUL");
list.add("ARJUN");
list.add("SAVIYO");
list.add("VISHNU");

ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, list);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner_1.setAdapter(adapter);

spinner_2 = (Spinner) findViewById(R.id.spinner_two);
spinner_2.setOnItemSelectedListener(this);
List<String> city = new ArrayList<String>();
city.add("KASARGOD");
city.add("KANNUR");
city.add("THRISSUR");
city.add("KOZHIKODE");
city.add("TRIVANDRUM");
city.add("ERNAMKULLAM");
city.add("WAYANAD");
city.add("PALAKKAD");
city.add("ALAPUZHA");
city.add("IDUKKI");
city.add("KOTTAYAM");
city.add("PATHANAMTHITTA");
city.add("KOLLAM");
city.add("MALAPPURAM");
ArrayAdapter<String> adapter2 = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, city);
adapter2.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner_2.setAdapter(adapter2); 
```

* * *

```
@Override
public void onItemSelected(AdapterView<?> parent, View view, int position,
        long id) {
    // TODO Auto-generated method stub
    Toast.makeText(this, "YOUR SELECTION IS : " + parent.getItemAtPosition(position).toString(), Toast.LENGTH_SHORT).show();

}

@Override
public void onNothingSelected(AdapterView<?> parent) {
    // TODO Auto-generated method stub

} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-12-10T09:55:51.033

> 您还可以使用**AppCompatSpinner**小部件：

```
<android.support.v7.widget.AppCompatSpinner
    android:id="@+id/spinner_order_type"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    app:backgroundTint="@color/red"/> 
```

> 在您的 Activity 类中：

```
AppCompatSpinner spinOrderType = (AppCompatSpinner) findViewById(R.id.spinner_order_type);
List<String> categories = new ArrayList<String>();
        categories.add(getString(R.string.label_table_order));
        categories.add(getString(R.string.label_take_away));

        ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(mContext,
                R.layout.layout_spinner_item, categories);
        dataAdapter.setDropDownViewResource(R.layout.layout_spinner_item);
        spinOrderType.setAdapter(dataAdapter);
        spinOrderType.setSelection(0);

        spinOrderType.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long l) {
                String item = parent.getItemAtPosition(position).toString();
                Log.d(TAG, item);
            }

            @Override
            public void onNothingSelected(AdapterView<?> adapterView) {

            }
        }); 
```

> layout_spinner_item.xml

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    xmlns:tools="http://schemas.android.com/tools"
    android:gravity="left"
    android:textSize="@dimen/text.size.large"
    android:textColor="@color/text.link"
    android:padding="@dimen/margin.3" /> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-08-09T16:49:49.307

在 Kotlin 中，您可以这样做：

首先，将此代码放入您的布局中

```
 <Spinner
            android:id="@+id/spinner"
            android:layout_width="wrap_content"
            android:layout_height="match_parent"/> 
```

然后你可以在 Activity 的 onCreate() 中做 ->

```
 val spinner = findViewById<Spinner>(R.id.spinner)
    val items = arrayOf("500g", "1kg", "2kg")
    val adapter = ArrayAdapter<String>(
        this,
        android.R.layout.simple_spinner_dropdown_item,
        items
    )
    spinner.setAdapter(adapter) 
```

您可以从下拉列表中获取侦听器：

```
 spinner.onItemSelectedListener = object : OnItemSelectedListener {
        override fun onItemSelected(
            arg0: AdapterView<*>?,
            arg1: View?,
            arg2: Int,
            arg3: Long
        ) {
            // Do what you want
            val items = spinner.selectedItem.toString()

        }

        override fun onNothingSelected(arg0: AdapterView<*>?) {}
    } 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-10-15T08:44:58.007

尝试这个...

```
<string-array name="names">

        <item></item>
        <item>By Bus</item>
        <item>By Train</item>
        <item>By Van</item>
        <item>By Bike</item>
    </string-array>

String travel_type;

ArrayAdapter<String> myAdapter = new ArrayAdapter(AddNew_Trip.this,android.R.layout.simple_list_item_1, getResources().getStringArray(R.array.names)); 
        myAdapter.setDropDownViewResource(android.R.layout.simple_dropdown_item_1line); 
        mySpinner.setAdapter(myAdapter); 

        mySpinner.setOnItemSelectedListener( 
                new AdapterView.OnItemSelectedListener() { 

                    @Override 
                    public void onItemSelected(AdapterView<?> adapterView, View view, int i, long l) { 
                        travel_type = String.valueOf(adapterView.getItemAtPosition(i)); 
                        //Toast.makeText(Plan_Trip.this, travel_type, Toast.LENGTH_SHORT).show(); 
                    } 

                    @Override 
                    public void onNothingSelected(AdapterView<?> adapterView) { 

                    } 

                } 
        ); 
    } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-12-19T10:05:52.297

**您可以通过这些简单的步骤创建微调器**

*首先在 xml 中创建微调器*

```
<Spinner
        android:id="@+id/select"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:textColor="#070707"></Spinner> 
```

*现在在值中创建字符串数组*

```
 <string-array name="itemselect">
    <item>Repurchase</item>
    <item>Coupons</item>
</string-array> 
```

*现在在java文件中初始化*

```
public class MemberCart_Activity extends AppCompatActivity {

Spinner select;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_member_cart);

    select=findViewById(R.id.select);
 ArrayAdapter<String> myadapter=new ArrayAdapter<String>(Main_Activity.this,android.R.layout.simple_list_item_1,getResources().getStringArray(R.array.itemselect));
    myadapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    select.setAdapter(myadapter); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-03-16T14:29:30.113

尝试这个：

```
package example.spin.spinnerexample;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.Toast;

public class MainActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener{

    String[] bankNames={"BOI","SBI","HDFC","PNB","OBC"};
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //Getting the instance of Spinner and applying OnItemSelectedListener on it
        Spinner spin = (Spinner) findViewById(R.id.simpleSpinner);
        spin.setOnItemSelectedListener(this);

        //Creating the ArrayAdapter instance having the bank name list
        ArrayAdapter aa = new ArrayAdapter(this,android.R.layout.simple_spinner_item,bankNames);
        aa.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        //Setting the ArrayAdapter data on the Spinner
        spin.setAdapter(aa);
    }

    //Performing action onItemSelected and onNothing selected
    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int position,long id) {
        Toast.makeText(getApplicationContext(), bankNames[position], Toast.LENGTH_LONG).show();
    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

    }
} 
```

activity_main.xml：-

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".MainActivity">

    <Spinner
        android:id="@+id/simpleSpinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="100dp" />

</RelativeLayout> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-30T22:14:18.277

![在此处输入图像描述](../Images/bb0d80cd6dd03db26f4b45423c6c0024.png)

![在此处输入图像描述](../Images/d812f17c54638ce0c2497f035520e8b3.png)

```
parseInt(binding.inputAge.text.toString()), 
```

新建android资源文件（dropdown_item）`R.layout.dropdown_item`，将textview放在里面。

文本视图代码：

```
`<TextView android:id="@+id/textView"
 android:layout_width="match_parent"
 android:layout_height="wrap_content"
 android:padding="14sp"
 android:text="textView"
 android:textColor="@color/black"
 android:textSize="16sp"
 android:textStyle="bold"
 xmlns:android="http://schemas.android.com/apk/res/android"/>` 
```

![在此处输入图像描述](../Images/c62b2b5a7b2d75b4d1e62c4b1a51b6bd.png)

![在此处输入图像描述](../Images/882998dedbd758ddc443e25f79a039e6.png)

// 绑定适配器并获取值 `binding.ddCity.setAdapter(showCity)` `binding.ddCity.selectedItem.toString()`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-01-31T06:48:40.090

创建 Spinner inm XML android:entries="@array/locations" 然后将鼠标悬停在数组/位置上并创建资源文件

资源文件应类似于“New Yorkshire”

```
 </resources>` 
```

然后

```
binding.spinner.selectedItem.toString() 
```

# web-services - Spring 事务不会在未由 Spring 上下文实例化的类中回滚

> ID：13377362
> 
> 赞同：1
> 
> 时间：2012-11-14T10:48:27.483
> 
> 标签：web-services, spring, transactions, soapui, rollback

我在 Spring 中处理事务时遇到问题。我有一个 Web 服务，它简单地迭代一定次数，每次都将一条记录插入到 Oracle 数据库中。我将我的服务的插入方法标记为@Transactional，因为我希望它在任何插入失败时回滚（在运行时异常之后，即在要插入空对象的情况下）。

问题是，如果我通过 java 测试服务，使用通过 Spring 应用程序上下文实例化服务的 main，evertything 工作正常（我得到每条记录回滚）。相反，如果我使用soapUI 测试Web 服务，则在将其部署到本地服务器后，就像看不到@Transactional 注释一样。

我报告我的代码。

这是我的服务：

```
@Service
public class MyService{

        @Transactional
        public void insert(List<DAO> l) {

              for(DAO item : l) {
              //Insert item into the DB
              //and throw a RunTimeException in case of failure (i.e.,item null)
              }
        }
} 
```

这是我的主要内容：

```
public class TestMain{

    public static void main(String[] args) {

        ApplicationContext ac = new FileSystemXmlApplicationContext(SPRING_CONTEXT_XML_PATH);

        MyService service = ac.getBean(MyService .class);

        List<DAO> l; //Suppose it is initialized    
        service.insert(l); //Rollback working if RuntimeException is thrown     
} 
```

}

正如我所说，当我使用 Spring 应用程序上下文实例化 Web 服务时，上面的代码可以工作，但是如果我在将 MyService 部署在服务器上之后通过soapUI调用它（这实际上是服务的目的），@Transactional 不是执行。

有人可以向我解释这种行为吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:02:12.600

每次`insert`调用该方法时，spring都会为您启动一个事务，因为它具有`@Transactional`注释。当`insert`返回时事务被提交（或者如果抛出异常则回滚）。

当 spring 创建一个 type 的 bean 时`MyService`，它用这样的东西包装`insert`方法：

```
EntityManager em = ...; // get EntityManager here
EntityTransaction tx = null;
try {
    tx = em.getTransaction();
    tx.begin();

    // your insert method is called here.

    tx.commit();
} catch (Exception e) {
    if ( tx != null && tx.isActive() ) {
        tx.rollback();
    }
} 
```

soupUI 不处理`@Transactional`注释。您必须自己启动事务并提交/回滚。

# c# - 处理包装任务的有限并发级别任务调度程序（具有任务优先级）

> ID：13377365
> 
> 赞同：6
> 
> 时间：2012-11-14T10:48:38.307
> 
> 标签：c#, .net, task-parallel-library, priority-queue, async-await

我很难找到一个可以安排优先任务但也可以处理“包装”任务的任务调度程序。这类似于[Task.Run](https://stackoverflow.com/a/13292081/1514235)试图解决的问题，但您不能将任务调度程序指定为`Task.Run`. 我一直在使用`QueuedTaskScheduler`Parallel [Extensions Extras Samples](http://bit.ly/W4Bjm1)中的一个来解决任务优先级要求（这篇[文章](https://stackoverflow.com/a/9326483/1514235)也建议）。

这是我的例子：

```
class Program
{
    private static QueuedTaskScheduler queueScheduler = new QueuedTaskScheduler(targetScheduler: TaskScheduler.Default, maxConcurrencyLevel: 1);
    private static TaskScheduler ts_priority1;
    private static TaskScheduler ts_priority2;
    static void Main(string[] args)
    {
        ts_priority1 = queueScheduler.ActivateNewQueue(1);
        ts_priority2 = queueScheduler.ActivateNewQueue(2);

        QueueValue(1, ts_priority2);
        QueueValue(2, ts_priority2);
        QueueValue(3, ts_priority2);
        QueueValue(4, ts_priority1);
        QueueValue(5, ts_priority1);
        QueueValue(6, ts_priority1);

        Console.ReadLine();           
    }

    private static Task QueueTask(Func<Task> f, TaskScheduler ts)
    {
        return Task.Factory.StartNew(f, CancellationToken.None, TaskCreationOptions.HideScheduler | TaskCreationOptions.DenyChildAttach, ts);
    }

    private static Task QueueValue(int i, TaskScheduler ts)
    {
        return QueueTask(async () =>
        {
            Console.WriteLine("Start {0}", i);
            await Task.Delay(1000);
            Console.WriteLine("End {0}", i);
        }, ts);
    }
} 
```

上述示例的典型输出是：

```
Start 4
Start 5
Start 6
Start 1
Start 2
Start 3
End 4
End 3
End 5
End 2
End 1
End 6 
```

我想要的是：

```
Start 4
End 4
Start 5
End 5
Start 6
End 6
Start 1
End 1
Start 2
End 2
Start 3
End 3 
```

**编辑：**

我想我正在寻找一个类似于 的任务调度程序来`QueuedTaskScheduler`解决这个问题。但欢迎任何其他建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T13:44:01.917

不幸的是，这不能用 a 解决`TaskScheduler`，因为它们总是在这个`Task`级别上工作，并且一个`async`方法几乎总是包含多个`Task`s。

您应该将 a[`SemaphoreSlim`](http://msdn.microsoft.com/en-us/library/system.threading.semaphoreslim.aspx)与优先调度程序结合使用。或者，您可以使用[`AsyncLock`](http://blogs.msdn.com/b/pfxteam/archive/2012/02/12/10266988.aspx)（也包含在我的[AsyncEx 库](http://nitoasyncex.codeplex.com/)中）。

```
class Program
{
  private static QueuedTaskScheduler queueScheduler = new QueuedTaskScheduler(targetScheduler: TaskScheduler.Default, maxConcurrencyLevel: 1);
  private static TaskScheduler ts_priority1;
  private static TaskScheduler ts_priority2;
  private static SemaphoreSlim semaphore = new SemaphoreSlim(1);
  static void Main(string[] args)
  {
    ts_priority1 = queueScheduler.ActivateNewQueue(1);
    ts_priority2 = queueScheduler.ActivateNewQueue(2);

    QueueValue(1, ts_priority2);
    QueueValue(2, ts_priority2);
    QueueValue(3, ts_priority2);
    QueueValue(4, ts_priority1);
    QueueValue(5, ts_priority1);
    QueueValue(6, ts_priority1);

    Console.ReadLine();           
  }

  private static Task QueueTask(Func<Task> f, TaskScheduler ts)
  {
    return Task.Factory.StartNew(f, CancellationToken.None, TaskCreationOptions.HideScheduler | TaskCreationOptions.DenyChildAttach, ts).Unwrap();
  }

  private static Task QueueValue(int i, TaskScheduler ts)
  {
    return QueueTask(async () =>
    {
      await semaphore.WaitAsync();
      try
      {
        Console.WriteLine("Start {0}", i);
        await Task.Delay(1000);
        Console.WriteLine("End {0}", i);
      }
      finally
      {
        semaphore.Release();
      }
    }, ts);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T10:08:48.510

我能找到的最佳解决方案是制作我自己的版本（在[Parallel Extensions Extras Samples](http://bit.ly/W4Bjm1)源代码`QueuedTaskScheduler`中找到的原始版本）。

我`bool awaitWrappedTasks`在`QueuedTaskScheduler`.

```
public QueuedTaskScheduler(
        TaskScheduler targetScheduler,
        int maxConcurrencyLevel,
        bool awaitWrappedTasks = false)
{
    ...
    _awaitWrappedTasks = awaitWrappedTasks;
    ...
}

public QueuedTaskScheduler(
        int threadCount,
        string threadName = "",
        bool useForegroundThreads = false,
        ThreadPriority threadPriority = ThreadPriority.Normal,
        ApartmentState threadApartmentState = ApartmentState.MTA,
        int threadMaxStackSize = 0,
        Action threadInit = null,
        Action threadFinally = null,
        bool awaitWrappedTasks = false)
{
    ...
    _awaitWrappedTasks = awaitWrappedTasks;

    // code starting threads (removed here in example)
    ...
} 
```

`ProcessPrioritizedAndBatchedTasks()`然后我将方法修改为`async`

```
private async void ProcessPrioritizedAndBatchedTasks() 
```

然后我在执行计划任务的部分之后修改了代码：

```
private async void ProcessPrioritizedAndBatchedTasks()
{
    bool continueProcessing = true;
    while (!_disposeCancellation.IsCancellationRequested && continueProcessing)
    {
        try
        {
            // Note that we're processing tasks on this thread
            _taskProcessingThread.Value = true;

            // Until there are no more tasks to process
            while (!_disposeCancellation.IsCancellationRequested)
            {
                // Try to get the next task.  If there aren't any more, we're done.
                Task targetTask;
                lock (_nonthreadsafeTaskQueue)
                {
                    if (_nonthreadsafeTaskQueue.Count == 0) break;
                    targetTask = _nonthreadsafeTaskQueue.Dequeue();
                }

                // If the task is null, it's a placeholder for a task in the round-robin queues.
                // Find the next one that should be processed.
                QueuedTaskSchedulerQueue queueForTargetTask = null;
                if (targetTask == null)
                {
                    lock (_queueGroups) FindNextTask_NeedsLock(out targetTask, out queueForTargetTask);
                }

                // Now if we finally have a task, run it.  If the task
                // was associated with one of the round-robin schedulers, we need to use it
                // as a thunk to execute its task.
                if (targetTask != null)
                {
                    if (queueForTargetTask != null) queueForTargetTask.ExecuteTask(targetTask);
                    else TryExecuteTask(targetTask);

                    // ***** MODIFIED CODE START ****
                    if (_awaitWrappedTasks)
                    {
                        var targetTaskType = targetTask.GetType();
                        if (targetTaskType.IsConstructedGenericType && typeof(Task).IsAssignableFrom(targetTaskType.GetGenericArguments()[0]))
                        {
                            dynamic targetTaskDynamic = targetTask;
                            // Here we await the completion of the proxy task.
                            // We do not await the proxy task directly, because that would result in that await will throw the exception of the wrapped task (if one existed)
                            // In the continuation we then simply return the value of the exception object so that the exception (stored in the proxy task) does not go totally unobserved (that could cause the process to crash)
                            await TaskExtensions.Unwrap(targetTaskDynamic).ContinueWith((Func<Task, Exception>)(t => t.Exception), TaskContinuationOptions.ExecuteSynchronously);
                        }
                    }
                    // ***** MODIFIED CODE END ****
                }
            }
        }
        finally
        {
            // Now that we think we're done, verify that there really is
            // no more work to do.  If there's not, highlight
            // that we're now less parallel than we were a moment ago.
            lock (_nonthreadsafeTaskQueue)
            {
                if (_nonthreadsafeTaskQueue.Count == 0)
                {
                    _delegatesQueuedOrRunning--;
                    continueProcessing = false;
                    _taskProcessingThread.Value = false;
                }
            }
        }
    }
} 
```

方法的改变`ThreadBasedDispatchLoop`有点不同，因为我们不能使用`async`关键字，否则我们将破坏在专用线程中执行计划任务的功能。所以这里是修改版`ThreadBasedDispatchLoop`

```
private void ThreadBasedDispatchLoop(Action threadInit, Action threadFinally)
{
    _taskProcessingThread.Value = true;
    if (threadInit != null) threadInit();
    try
    {
        // If the scheduler is disposed, the cancellation token will be set and
        // we'll receive an OperationCanceledException.  That OCE should not crash the process.
        try
        {
            // If a thread abort occurs, we'll try to reset it and continue running.
            while (true)
            {
                try
                {
                    // For each task queued to the scheduler, try to execute it.
                    foreach (var task in _blockingTaskQueue.GetConsumingEnumerable(_disposeCancellation.Token))
                    {
                        Task targetTask = task;
                        // If the task is not null, that means it was queued to this scheduler directly.
                        // Run it.
                        if (targetTask != null)
                        {
                            TryExecuteTask(targetTask);
                        }
                        // If the task is null, that means it's just a placeholder for a task
                        // queued to one of the subschedulers.  Find the next task based on
                        // priority and fairness and run it.
                        else
                        {
                            // Find the next task based on our ordering rules...                                    
                            QueuedTaskSchedulerQueue queueForTargetTask;
                            lock (_queueGroups) FindNextTask_NeedsLock(out targetTask, out queueForTargetTask);

                            // ... and if we found one, run it
                            if (targetTask != null) queueForTargetTask.ExecuteTask(targetTask);
                        }

                        if (_awaitWrappedTasks)
                        {
                            var targetTaskType = targetTask.GetType();
                            if (targetTaskType.IsConstructedGenericType && typeof(Task).IsAssignableFrom(targetTaskType.GetGenericArguments()[0]))
                            {
                                dynamic targetTaskDynamic = targetTask;
                                // Here we wait for the completion of the proxy task.
                                // We do not wait for the proxy task directly, because that would result in that Wait() will throw the exception of the wrapped task (if one existed)
                                // In the continuation we then simply return the value of the exception object so that the exception (stored in the proxy task) does not go totally unobserved (that could cause the process to crash)
                                TaskExtensions.Unwrap(targetTaskDynamic).ContinueWith((Func<Task, Exception>)(t => t.Exception), TaskContinuationOptions.ExecuteSynchronously).Wait();
                            }
                        }
                    }
                }
                catch (ThreadAbortException)
                {
                    // If we received a thread abort, and that thread abort was due to shutting down
                    // or unloading, let it pass through.  Otherwise, reset the abort so we can
                    // continue processing work items.
                    if (!Environment.HasShutdownStarted && !AppDomain.CurrentDomain.IsFinalizingForUnload())
                    {
                        Thread.ResetAbort();
                    }
                }
            }
        }
        catch (OperationCanceledException) { }
    }
    finally
    {
        // Run a cleanup routine if there was one
        if (threadFinally != null) threadFinally();
        _taskProcessingThread.Value = false;
    }
} 
```

我已经对此进行了测试，它提供了所需的输出。这种技术也可以用于任何其他调度程序。例如`LimitedConcurrencyLevelTaskScheduler`和`OrderedTaskScheduler`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:44:09.260

我认为实现这个目标是不可能的。一个核心问题似乎是 a`TaskScheduler`只能用于运行代码。但是也有不运行代码的任务，比如IO任务或者定时器任务。我不认为`TaskScheduler`基础设施可以用来安排这些。

从 TaskScheduler 的角度来看，它看起来像这样：

```
1\. Select a registered task for execution
2\. Execute its code on the CPU
3\. Repeat 
```

步骤 (2) 是同步的，这意味着`Task`要执行的必须作为步骤 (2) 的一部分开始和结束。这意味着这`Task`不能执行异步 IO，因为那将是非阻塞的。从这个意义上说，`TaskScheduler`只支持阻塞代码。

我认为最好通过自己实现一个版本来`AsyncSemaphore`按优先顺序释放服务员并进行节流，从而为您提供最好的服务。您的异步方法可以以非阻塞方式等待该信号量。所有 CPU 工作都可以在默认线程池上运行，因此无需在 custom 中启动自定义线程`TaskScheduler`。IO 任务可以继续使用非阻塞 IO。

# javascript - 输入一个名称的所有列表属性值

> ID：13377370
> 
> 赞同：2
> 
> 时间：2012-11-14T10:48:58.623
> 
> 标签：javascript, jquery, html

在我的列表中，我有属性“data-pic”、“data-audio”和“data-word”......

```
<li data-audio="sounds/words/black.wav" data-pic="images/words/black.png" data-word="black"></li> 
```

如果我要将“黑色”更改为其他内容，有没有办法通过 HTML 输入一次新词来更改所有属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:52:21.180

你可以使用javascript函数..

```
function writeLi(color){
    return '<li data-audio="sounds/words/'+color+'.wav" data-pic="images/words/'+color+'.png" data-word="'+color+'"></li>'
} 
```

那个怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:03:16.817

使用 jQuery 的另一种可能更短的方法：

```
$.each($("li").data(), function(key, value) {
    data[key] = value.replace("black", "white");
}); 
```

[**示例小提琴**](http://jsfiddle.net/hfK9n/)

不过，您可能希望使用“黑色”以外的占位符值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T10:54:25.750

您可以利用属性数组，这只是一个简单的示例，根据您的情况，您可能需要更高级的方法来替换“黑色”，而不是像这样的直接替换。

```
var el = document.getElementById("yourList");
for( var i = 0, max = el.attributes.length; i < max; i++ ){
 if( el.attributes[i].nodeName.indexOf("data") > -1 ){
  el.attributes[i].nodeValue.replace("black","newValue");
 }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T10:55:14.967

这也有效：

```
var elem = $("li")[0];
var attrs = elem.attributes;
for(var i=0;i<attrs.length;i++) {
   $(elem).attr(attrs[i].nodeName,attrs[i].nodeValue.replace(/black/gi,'white'));                                               
}
​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T10:54:12.303

你可以这样做：

```
var myWord = $('li').data('word');
var newWord = 'blue';

$('li').data('word', newWord);

$('li').data('audio', $('li').data('audio').replace(myWord, newWord));
$('li').data('pic', $('li').data('pic').replace(myWord, newWord)); 
```

但这将是一个糟糕的方法。最好是：

```
$('li').data('word', 'yellow');
$('li').data('audio', 'sounds/words/yellow.wav');
$('li').data('pic', 'images/words/yellow.png'); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-14T10:54:19.890

jQuery：

```
$('div.#ContainerName li').each(function(a,li) {
  if(this.attr('data-word') == 'black') {
    li.attr('data-word', yourNewValueHere)
    li.attr('data-audio', yourNewValueHere1)
    li.attr('data-pic', yourNewValueHere2)
  }
}); 
```

如果需要，使用容器名称来限制范围（否则它将检查所有 LI，这可能太多/太慢/不受欢迎）

# android - 擦除屏幕上的所有内容并显示图像

> ID：13377372
> 
> 赞同：0
> 
> 时间：2012-11-14T10:49:12.747
> 
> 标签：android, android-layout

我有一个包含各种视图的活动（按钮、文本等）。我想做的是以编程方式擦除其中的所有内容，然后将一些图片设置为背景。当然，使用相同的活动而不切换到不同的活动。那可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:54:20.053

如果您真的想擦除可以使用的所有内容：

```
ViewGroup.removeAllViews(); 
```

在布局中的根视图上。

但是您可能需要考虑使用[ViewSwitcher](http://developer.android.com/reference/android/widget/ViewSwitcher.html "视图切换器")或简单地使用隐藏内容

```
View.setVisibility(View.GONE) 
```

而是能够重用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:52:44.467

您的所有视图都必须位于某个主布局中（如果没有，请将它们放在一个这样的布局中）。给该布局一个 id，然后使用 findViewById() 获取该布局，并在其上调用[removeAllViews()](http://developer.android.com/reference/android/view/ViewGroup.html#removeAllViews%28%29)或 removeAllViewsInLayout() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:52:59.770

您可以将所有视图放在一个布局中，并将布局的可见性设置为 View.GONE 并将图像可见性设置为可见

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:03:59.590

没有必要实际删除视图。改用`ViewSwitcher`：

```
<?xml version="1.0" encoding="utf-8"?>

<ViewSwitcher
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/viewswitcher"
        android:layout_width="match_parent"
        android:layout_height="match_parent">

    <ImageView
            android:src="@drawable/your_image"
            android:layout_width="match_parent"
            android:layout_height="match_parent"/>

    <LinearLayout
            android:layout_height="match_parent"
            android:layout_width="match_parent">

            <!-- your views here -->

    </LinearLayout>

</ViewSwitcher> 
```

然后，在您的代码中：

```
ViewSwitcher vs = (ViewSwitcher) findViewById(R.id.viewswitcher);
vs.showNext();
vs.showPrevious(); 
```

# twitter-bootstrap - Shim Twitter Bootstrap for RequireJS

> ID：13377373
> 
> 赞同：37
> 
> 时间：2012-11-14T10:49:26.057
> 
> 标签：twitter-bootstrap, requirejs

RequireJS[文档](http://requirejs.org/docs/api.html#ieloadfail)说要支持旧版本的 IE，您需要配置`enforceDefine: true`.

> 因此，如果您想支持 Internet Explorer、捕获加载错误并通过直接 define() 调用或 shim 配置来编写模块化代码，请始终将 enforceDefine 设置为 true。有关示例，请参见下一节。
> 
> 注意：如果你确实设置了 enforceDefine: true，并且你使用 data-main="" 来加载你的主 JS 模块，那么那个主 JS 模块必须调用 define() 而不是 require() 来加载它需要的代码。主 JS 模块仍然可以调用 require/requirejs 来设置配置值，但是对于加载模块，它应该使用 define()。

由于 Twitter Bootstrap 不是 AMD 模块，因此我需要对其进行填充以使其正常工作。这就是我的配置方式；

```
<script type="text/javascript">
    var require = {
        paths: {
            "bootstrap": "../bootstrap",
            "jquery": "../jquery-1.8.2"
        },
        shim: {
            "bootstrap": ["jquery"]
        },
        enforceDefine: true
    };
</script> 
```

后来，当我的模块想要将引导程序作为依赖项时，我仍然会收到一条错误消息；

```
Error: No define call for bootstrap 
```

[http://requirejs.org/docs/errors.html#nodefine](http://requirejs.org/docs/errors.html#nodefine)

如果我正确理解了文档，`enforceDefine`应该忽略垫片，但事实并非如此。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-25T23:51:03.753

根据文档，如果“脚本是 shim 配置的一部分，该配置指定了可以检查加载的全局字符串属性，并且该检查失败，则会引发错误。”

要解决此问题，您需要在 shim 配置中添加导出值，以便 RequireJS 可以检查脚本是否已成功加载。如果 Bootstrap 有点棘手，因为 Bootstrap 不会“导出”属性全局变量，只有一堆 jquery 插件，但您可以使用这些插件中的任何一个作为导出值，例如`$.fn.popover`：

```
{
    paths: {
        "bootstrap": "../bootstrap",
        "jquery": "../jquery-1.8.2"
    },
    shim: {
        "bootstrap": {
          deps: ["jquery"],
          exports: "$.fn.popover"
        }
    },
    enforceDefine: true
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-15T19:01:12.543

我没有用 shim 施展魔法，而是将引导 JS 转换为一个模块：

```
define([ "jquery" ], function($) {
  // bootstrap JS code
}); 
```

我在论坛和 stackoverflow 上找到的所有其他内容都对我不起作用，因为我从 CDN 获得了 jQuery。[我假设是因为我遇到了http://requirejs.org/docs/api.html](http://requirejs.org/docs/api.html)上的 requireJS 文档中描述的问题

> 不要在构建中混合 CDN 加载和 shim 配置。示例场景：您从 CDN 加载 jQuery，但使用 shim 配置加载依赖于 jQuery 的 Backbone 的库存版本。进行构建时，请确保在构建文件中内联 jQuery，并且不要从 CDN 加载它。否则，Backbone 将内联在构建的文件中，并在加载 CDN 的 jQuery 加载之前执行。这是因为 shim 配置只是延迟加载文件，直到加载依赖项，但不执行任何自动包装定义。构建后，依赖项已经内联，shim 配置不能延迟执行未定义（）的代码，直到以后。定义（）' d 模块在构建后确实与 CDN 加载的代码一起工作，因为它们正确地将其源代码包装在定义工厂函数中，该函数在加载依赖项之前不会执行。所以教训：shim config 是非模块化代码、遗留代码的权宜之计。定义（）的模块更好。

将引导程序转换为普通的 AMD 模块并删除 shim 配置为我解决了这个问题。唯一的缺点：您无法从引导 CDN 中检索引导。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-09-25T13:54:35.703

我在我的项目中使用这个配置：

**启动.js**

```
require.config({
    paths: {
        /* other paths are omitted */
        'bootstrap': '../libs/bootstrap'
    },
    shim: {
        'bootstrap/bootstrap-slider': { deps: ['jquery'], exports: '$.fn.slider' }, 
        'bootstrap/bootstrap-affix': { deps: ['jquery'], exports: '$.fn.affix' },
        'bootstrap/bootstrap-alert': { deps: ['jquery'], exports: '$.fn.alert' },
        'bootstrap/bootstrap-button': { deps: ['jquery'], exports: '$.fn.button' },
        'bootstrap/bootstrap-carousel': { deps: ['jquery'], exports: '$.fn.carousel' },
        'bootstrap/bootstrap-collapse': { deps: ['jquery'], exports: '$.fn.collapse' },
        'bootstrap/bootstrap-dropdown': { deps: ['jquery'], exports: '$.fn.dropdown' },
        'bootstrap/bootstrap-modal': { deps: ['jquery'], exports: '$.fn.modal' },
        'bootstrap/bootstrap-popover': { deps: ['jquery'], exports: '$.fn.popover' },
        'bootstrap/bootstrap-scrollspy': { deps: ['jquery'], exports: '$.fn.scrollspy'        },
        'bootstrap/bootstrap-tab': { deps: ['jquery'], exports: '$.fn.tab' },
        'bootstrap/bootstrap-tooltip': { deps: ['jquery'], exports: '$.fn.tooltip' },
        'bootstrap/bootstrap-transition': { deps: ['jquery'], exports: '$.support.transition' },
        'bootstrap/bootstrap-typeahead': { deps: ['jquery'], exports: '$.fn.typeahead'  },
    }
});

require(['domReady', 'app'], function(domReady, app) {
    domReady(function() {
        app.init();
    });
}); 
```

然后在我的代码中我使用这个：

```
define(['jquery', 'underscore', 'backbone', 'text!templates/photos-list.html'], function($, _, Backbone, html) {
    var PhotosListView = Backbone.View.extend({
        viewImageFullscreen: function(e) {
            e.preventDefault();

            require(['bootstrap/bootstrap-modal', 'text!templates/photo-modal.html'], function(modal, htmlModal) {
                 var modalTemplate = _.template(htmlModal, options);
                 $('body').append(modalTemplate);

                 // setup
                 $(selector + '_modal').modal({
                     backdrop: true,
                     keyboard: true,
                     show: false
                 }).css({
                     'width': function() { return ($(document).width() * 0.55) + 'px'; },
                     'margin-left': function() { return -($(this).width() * 0.5); }
                 });

                 // trigger `modal` 
                 $(selector + '_modal').modal('show');
             }); // require() call
         // ... 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-25T17:09:50.123

@lexeme 和 @benjaminbenben 将这个概念包装在一个 RequireJS 插件中如何创建垫片，需要 jQuery 并且还返回 jQuery，所以你不需要手动包含它？

要使用引导组件，您只需使用：

```
define(['bootstrap!tooltip'], function($){
  $('[data-toggle="tooltip"]').tooltip();
}); 
```

你会使用这个[require-bootstrap-plugin](https://gist.github.com/jbmoelker/b8c3c4359db7ca94439f#file-bootstrap-js)来使它工作。

# ruby-on-rails-3 - 未通过 Rails 找到 Twitter Bootstrap

> ID：13377374
> 
> 赞同：1
> 
> 时间：2012-11-14T10:49:28.180
> 
> 标签：ruby-on-rails-3, configuration, twitter-bootstrap

我正在学习 Ruby on Rails 并尝试实现 Twitter Bootstrap。我知道如何使用和编辑它，就像我以前使用过的一样——只是没有导轨。

设置已完成，如下所示：[http](http://ruby.railstutorial.org/chapters/filling-in-the-layout?version=3.2#sec-custom_css) ://ruby.railstutorial.org/chapters/filling-in-the-layout?version=3.2#sec-custom_css - 当我阅读这本书时。

出现以下错误：`File to import not found or unreadable: bootstrap.scss.`尝试导入`@import "bootstrap"`.

这是我的宝石文件：

```
source 'https://rubygems.org'

gem 'rails', '3.2.1'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3-ruby'
gem 'bootstrap-sass', '~> 2.1.1.0'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
... 
```

我错了什么？先感谢您！

**编辑：**

我是否也必须安装“指南针”？检查时`gem server`我在“bootstrap-sass”下找到`bootstrap-sass 2.1.1.0 [rdoc] [www] - depends on compass, sass-rails.`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:46:47.767

我只是按照您提供的链接中的说明进行操作，并且使用引导程序没有问题。我只做了以下步骤：

1) 编辑 Gemfile，使资产组看起来像：

```
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'bootstrap-sass', '~> 2.1.1.0'
  gem 'uglifier', '>= 1.0.3'
end 
```

2）创建文件`app/assets/stylesheets/custom.css.scss`并放置以下行：

```
@import 'bootstrap'; 
```

3）生成一个脚手架：

```
rails g scaffold posts title:string body:text date:date 
```

4）迁移数据库：

```
rake db:migrate 
```

5) 启动服务器

```
rails s 
```

6）访问帖子页面

```
http://localhost:3000/posts 
```

可以查看查看生成的css：

```
http://localhost:3001/assets/custom.css 
```

引导 css 折叠的地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T11:11:35.310

`gem 'bootstrap-sass', '~> 2.1.1.0'`应该出`:assets`群。只需将其放在`gem 'sqlite3-ruby`' 下面并`bundle install`再次运行。

# hibernate - Java persistence.xml 多个持久性单元“找不到符号...导入”

> ID：13377382
> 
> 赞同：2
> 
> 时间：2012-11-14T10:49:57.343
> 
> 标签：hibernate, maven, junit, persistence.xml, persistence-unit

我的 NetBeans-Maven-Project 有问题。如果我将另一个 Persistence-Unit 添加到具有相同实体的相同 persistence.xml 中，我会得到一些我不理解的异常。

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="com.xxx.plugin.connector_xxxAuthServices_war_firstPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>com.xxx.plugin.entities.Businesspartner</class>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <shared-cache-mode>NONE</shared-cache-mode>
    <validation-mode>NONE</validation-mode>
    <properties>
      <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/db_first?zeroDateTimeBehavior=convertToNull"/>
      <property name="javax.persistence.jdbc.password" value="xxx"/>
      <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/>
      <property name="javax.persistence.jdbc.user" value="root"/>
    </properties>
  </persistence-unit>

  <!--  
  <persistence-unit name="com.xxx.plugin.connector_xxxAuthServices_war_secondPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>com.xxx.plugin.entities.Businesspartner</class>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <shared-cache-mode>NONE</shared-cache-mode>
    <validation-mode>NONE</validation-mode>
    <properties>
      <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/db_second?zeroDateTimeBehavior=convertToNull"/>
      <property name="javax.persistence.jdbc.password" value="xxx"/>
      <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/>
      <property name="javax.persistence.jdbc.user" value="root"/>
    </properties>
  </persistence-unit>
  -->
</persistence> 
```

如果我取消注释第二个 PU，我会得到一些例外：

```
------------------------------------------------------------------------
BUILD FAILURE
------------------------------------------------------------------------
Total time: 2.558s
Finished at: Wed Nov 14 10:26:32 CET 2012
Final Memory: 21M/56M
------------------------------------------------------------------------
Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.0.2:testCompile (default-testCompile) on project xxxAuthServices: Compilation failure: Compilation failure:
D:\Users\me\Documents\xxx\code\trunk\xxxAuthServices\src\test\java\com\xxx\plugin\webservices\MaterialsLoginRESTfulWSTest.java:[8,35] error: cannot find symbol

could not parse error message:   symbol:   class Businesspartner
location: package com.xxx.plugin.entities 
```

MaterialsLoginRESTfulWSTest 是一个 jUnit-Test，第 9 行是“import com.xxx.plugin.entities.Businesspartner”。

我已经黔驴技穷了。有没有大神帮忙解决下...

最好的问候扎克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T08:40:23.573

忘记发布我的修复/错误。我的 Maven-Rep 有一个旧的或不匹配的版本。

问候扎克

# java - 如何从另一个单独的类更改 java Cardlayout

> ID：13377386
> 
> 赞同：2
> 
> 时间：2012-11-14T10:50:22.080
> 
> 标签：java, swing, jpanel, cardlayout

请我一直在尝试从另一个类（JPanel）切换 CardLayout，这是 CardLayout 上的卡片之一，我已经搜索并对此进行了很长时间的研究，但没有发现任何帮助。

我有一个 CardLayout 和两个单独的 JPanel 添加到 CardLayout，现在我希望能够在单独的 JPanel 或单独的类上执行活动后切换卡片，那么如何从另一个类切换 CardLayout？我的代码如下。

```
package myApp;
import java.awt.CardLayout;

public class TestmyCard extends javax.swing.JFrame {

/**
 * Creates new form TestmyCard
 */
public TestmyCard() {
    initComponents();
    jPanel1.add(new FirstCard(),"card3");
    jPanel1.add(new SecondCard(),"card4");
}

public void chgCard(String nwCard){
            CardLayout cl = (CardLayout)(jPanel1.getLayout());
   cl.show(jPanel1,nwCard);

}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    jPanel1 = new javax.swing.JPanel();
    jPanel2 = new javax.swing.JPanel();
    jLabel1 = new javax.swing.JLabel();
    jPanel3 = new javax.swing.JPanel();
    jButton1 = new javax.swing.JButton();
    jButton2 = new javax.swing.JButton();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    jPanel1.setName("Cards");
    jPanel1.setLayout(new java.awt.CardLayout());

    jPanel2.setName("card2");

    jLabel1.setText("second panel");

    javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
    jPanel2.setLayout(jPanel2Layout);
    jPanel2Layout.setHorizontalGroup(
        jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jPanel2Layout.createSequentialGroup()
            .addGap(119, 119, 119)
            .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap(203, Short.MAX_VALUE))
    );
    jPanel2Layout.setVerticalGroup(
        jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jPanel2Layout.createSequentialGroup()
            .addGap(140, 140, 140)
            .addComponent(jLabel1)
            .addContainerGap(92, Short.MAX_VALUE))
    );

    jPanel1.add(jPanel2, "card2");

    jPanel3.setBackground(new java.awt.Color(153, 255, 153));

    jButton1.setLabel("First Btn");
    jButton1.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton1ActionPerformed(evt);
        }
    });

    jButton2.setLabel("Second Btn");
    jButton2.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton2ActionPerformed(evt);
        }
    });

    javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
    jPanel3.setLayout(jPanel3Layout);
    jPanel3Layout.setHorizontalGroup(
        jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jPanel3Layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(jButton1)
            .addGap(18, 18, 18)
            .addComponent(jButton2)
            .addContainerGap(181, Short.MAX_VALUE))
    );
    jPanel3Layout.setVerticalGroup(
        jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
            .addContainerGap(27, Short.MAX_VALUE)
            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jButton1)
                .addComponent(jButton2))
            .addGap(20, 20, 20))
    );

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 439, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGap(0, 0, Short.MAX_VALUE))
        .addGroup(layout.createSequentialGroup()
            .addGap(37, 37, 37)
            .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap())
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 246, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 25, Short.MAX_VALUE)
            .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap())
    );

    pack();
}// </editor-fold>                        

private void jButton2ActionPerformed(java.awt.event.ActionEvent evt)    {                                         
    // TODO add your handling code here:
    CardLayout cl = (CardLayout)(jPanel1.getLayout());
   cl.show(jPanel1,"card3");
   //cl.next(jPanel1) ;
}                                        

private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    // TODO add your handling code here:
    CardLayout cl = (CardLayout)(jPanel1.getLayout());
   cl.show(jPanel1,"card4");
}                                        

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /*
     * Set the Nimbus look and feel
     */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /*
     * If Nimbus (introduced in Java SE 6) is not available, stay with the
     * default look and feel. For details see
     * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(TestmyCard.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(TestmyCard.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(TestmyCard.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(TestmyCard.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /*
     * Create and display the form
     */
    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            new TestmyCard().setVisible(true);
        }
    });
}
// Variables declaration - do not modify                     
private javax.swing.JButton jButton1;
private javax.swing.JButton jButton2;
private javax.swing.JLabel jLabel1;
private javax.swing.JPanel jPanel1;
private javax.swing.JPanel jPanel2;
private javax.swing.JPanel jPanel3;
// End of variables declaration                   
} 
```

FirstCard（单独的 jpanel）

```
package myApp;

public class FirstCard extends javax.swing.JPanel {

/**
 * Creates new form FirstCard
 */
public FirstCard() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    jLabel1 = new javax.swing.JLabel();
    guName = new javax.swing.JTextField();
    guAddrs = new javax.swing.JTextField();
    jLabel14 = new javax.swing.JLabel();
    jLabel15 = new javax.swing.JLabel();
    guOccu = new javax.swing.JTextField();
    jLabel16 = new javax.swing.JLabel();
    guPhone = new javax.swing.JTextField();

    jLabel1.setText("Guarantee Name :");

    jLabel14.setText("Address :");

    jLabel15.setText("Occupation :");

    jLabel16.setText("Phone :");

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
    this.setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jLabel14)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(guAddrs, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jLabel16)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(guPhone, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jLabel15)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(guOccu, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jLabel1)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                    .addComponent(guName, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE)))
            .addContainerGap(228, Short.MAX_VALUE))
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(43, 43, 43)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel1)
                .addComponent(guName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel15)
                .addComponent(guOccu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGap(30, 30, 30)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel14)
                .addComponent(guAddrs, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel16)
                .addComponent(guPhone, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addContainerGap(135, Short.MAX_VALUE))
    );
}// </editor-fold>                        
// Variables declaration - do not modify                     
private javax.swing.JTextField guAddrs;
private javax.swing.JTextField guName;
private javax.swing.JTextField guOccu;
private javax.swing.JTextField guPhone;
private javax.swing.JLabel jLabel1;
private javax.swing.JLabel jLabel14;
private javax.swing.JLabel jLabel15;
private javax.swing.JLabel jLabel16;
// End of variables declaration                   
} 
```

SecondCard（单独的 jpanel）

```
package myApp;

public class SecondCard extends javax.swing.JPanel {

/**
 * Creates new form SecondCard
 */
public SecondCard() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    jLabel1 = new javax.swing.JLabel();
    jButton1 = new javax.swing.JButton();

    jLabel1.setText("this is the second card");

    jButton1.setText("SwitchCard");
    jButton1.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton1ActionPerformed(evt);
        }
    });

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
    this.setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(120, 120, 120)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jButton1)
                .addComponent(jLabel1))
            .addContainerGap(173, Short.MAX_VALUE))
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(62, 62, 62)
            .addComponent(jLabel1)
            .addGap(18, 18, 18)
            .addComponent(jButton1)
            .addContainerGap(183, Short.MAX_VALUE))
    );
}// </editor-fold>

private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
    TestmyCard nc = new TestmyCard();
    nc.chgCard("Card2");
}

// Variables declaration - do not modify
private javax.swing.JButton jButton1;
private javax.swing.JLabel jLabel1;
// End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T12:16:24.457

在您提供的代码中，您从未将`FirstCard`and添加`SecondCard`到将`JPanel`布局设置为`CardLayout`. 既然你写的是这样的：

```
jPanel1.add(jPanel2, "card2"); 
```

这`jPanel2`是一个实例`JPanel`，因为您已在您的`TestmyClass`类中初始化它，如：

```
jPanel2 = new javax.swing.JPanel(); 
```

相反，我猜你应该写的是：

```
jPanel2 = new SecondCard(passPanelWithCardLayoutAsArgument); // So that you can manoeuvre around b/w other JPanels 
```

这是一个可以帮助您的小型工作示例：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class CardLayoutExample
{
    private JPanel contentPane;
    private MyPanel panel1;
    private MyPanel panel2;
    private MyPanel panel3;

    private void displayGUI()
    {
        JFrame frame = new JFrame("Card Layout Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setBorder(
            BorderFactory.createEmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new CardLayout());

        panel1 = new MyPanel(contentPane
                , Color.RED.darker().darker());
        panel2 = new MyPanel(contentPane
                , Color.GREEN.darker().darker());
        panel3 = new MyPanel(contentPane
                , Color.DARK_GRAY); 

        contentPane.add(panel1, "Panel 1"); 
        contentPane.add(panel2, "Panel 2");
        contentPane.add(panel3, "Panel 3");         

        frame.setContentPane(contentPane);      
        frame.pack();   
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new CardLayoutExample().displayGUI();
            }
        });
    }
}

class MyPanel extends JPanel 
{

    private JButton jcomp1;
    private JPanel contentPane;
    private Color backgroundColour;

    public MyPanel(JPanel panel, Color c) 
    {   
        contentPane = panel;
        backgroundColour = c;

        setOpaque(true);
        setBackground(backgroundColour);

        //construct components
        jcomp1 = new JButton ("Show New Panel");
        jcomp1.addActionListener( new ActionListener()
        {
            public void actionPerformed(ActionEvent e)
            {
                CardLayout cardLayout = (CardLayout) contentPane.getLayout();
                cardLayout.next(contentPane);
            }
        });

        add(jcomp1);
    }

    @Override
    public Dimension getPreferredSize()
    {
        return (new Dimension(500, 500));
    }
} 
```

**最新编辑：** ***使用您的组件并尝试将其放入 CardLayout，使用此代码：***

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class CardLayoutExample
{
    private JPanel contentPane;
    private FirstCard panel1;
    private SecondCard panel2;

    private void displayGUI()
    {
        JFrame frame = new JFrame("Card Layout Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setBorder(
            BorderFactory.createEmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new CardLayout());

        panel1 = new FirstCard(contentPane);
        panel2 = new SecondCard(contentPane);

        contentPane.add(panel1, "Panel 1"); 
        contentPane.add(panel2, "Panel 2");     

        frame.setContentPane(contentPane);      
        frame.pack();   
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new CardLayoutExample().displayGUI();
            }
        });
    }
}

class FirstCard extends javax.swing.JPanel 
{
    private javax.swing.JTextField addField;
    private javax.swing.JTextField nameField;
    private javax.swing.JTextField occField;
    private javax.swing.JTextField phoneField;
    private javax.swing.JLabel nameLabel;
    private javax.swing.JLabel addLabel;
    private javax.swing.JLabel occLabel;
    private javax.swing.JLabel phoneLabel;
    private JPanel centerPanel;
    private JPanel contentPane;
    private JButton nextButton;

    public FirstCard(JPanel cp) 
    {
        this.contentPane = cp;
        initComponents();
    }

    private void initComponents() 
    {
        setOpaque(true);
        setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        setBackground(Color.RED);
        setLayout(new BorderLayout(5, 5));

        nameLabel = new javax.swing.JLabel("Guarantee Name : ");
        nameField = new javax.swing.JTextField();   
        addLabel = new javax.swing.JLabel("Address : ");
        addField = new javax.swing.JTextField();        
        occLabel = new javax.swing.JLabel("Occupation : ");
        occField = new javax.swing.JTextField();
        phoneLabel = new javax.swing.JLabel("Phone : ");
        phoneField = new javax.swing.JTextField();
        centerPanel = new JPanel();
        nextButton = new JButton("Next");
        nextButton.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent ae)
            {
                nextButtonAction(ae);
            }
        });

        centerPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        centerPanel.setOpaque(true);
        centerPanel.setBackground(Color.WHITE);
        centerPanel.setLayout(new GridLayout(0, 2, 5, 5));
        centerPanel.add(nameLabel);
        centerPanel.add(nameField);
        centerPanel.add(addLabel);
        centerPanel.add(addField);
        centerPanel.add(occLabel);
        centerPanel.add(occField);
        centerPanel.add(phoneLabel);
        centerPanel.add(phoneField);

        add(centerPanel, BorderLayout.CENTER);
        add(nextButton, BorderLayout.PAGE_END);
    }                   

    private void nextButtonAction(ActionEvent ae)
    {
        CardLayout layout = (CardLayout)contentPane.getLayout();
        layout.next(contentPane);
    }
}

class SecondCard extends javax.swing.JPanel 
{

    private javax.swing.JButton nextButton;
    private javax.swing.JLabel textLabel;
    private JPanel contentPane;

    public SecondCard(JPanel cp) 
    {
        contentPane = cp;
        initComponents();
    }

    private void initComponents() 
    {

        setOpaque(true);
        setBackground(Color.GREEN.darker().darker());
        setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        textLabel = new JLabel("this is the second card", JLabel.CENTER);
        textLabel.setForeground(Color.WHITE);
        nextButton = new javax.swing.JButton();

        nextButton.setText("SwitchCard");
        nextButton.addActionListener(new ActionListener() 
        {
            public void actionPerformed(ActionEvent evt) 
            {
                jButton1ActionPerformed(evt);
            }
        });

        add(textLabel);
        add(nextButton);
    }

    private void jButton1ActionPerformed(ActionEvent evt) 
    {
        CardLayout layout = (CardLayout) contentPane.getLayout();
        layout.show(contentPane, "Panel 1");
    }
} 
```

**清除字段的方法**

```
private void clearFields()
{
    Component components[] = centerPanel.getComponents();
    for (Component comp : components)
    {
        if (comp instanceof JTextField)
        {
            JTextField tfield = (JTextField) comp;
            tfield.setText("");
        }
        else if (comp instanceof JComboBox)
        {
            JComboBox cbox = (JComboBox) comp;
            cbox.setSelectedIndex(0);
        }
        else if (comp instanceof JRadioButton)
        {
            JRadioButton rbut = (JRadioButton) comp;
            rbut.setSelected(false);
        }
    }
} 
```

您将`actionPerformed()`在 Button 的方法中调用它，这会将您带到下一张卡片。

# php - 图片下载自动添加水印

> ID：13377389
> 
> 赞同：0
> 
> 时间：2012-11-14T10:50:31.770
> 
> 标签：php, javascript, image-manipulation, watermark

当有人从您的网站下载图像时，是否可以添加水印？如果是，最好的方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T10:53:10.027

如果你的意思是在`Right Click -> Save`ing 时，那恐怕是不可能的。
如果你通常意味着你有一个专用的下载按钮或链接，你可以让它通过一个 PHP 文件重定向请求，该文件将添加所需的水印并生成一个新的图像文件供下载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:16:53.863

### 我有一个更好的主意。

既然您说当人们**右键单击并选择 Save As**时要保护东西。因此，我们可以使用 9gag 的方式。

创建具有固定大小的页脚的图像。使用底边距的页脚大小的负边距父级。Give`overflow: hidden;`使用户无法看到隐藏在视图中的水印。现在，当用户右键单击并另存为图像时，他们将有水印。总而言之，图像没有没有水印的地方。因此，在上传图片时，请使用上述技术添加水印。

* * *

或者，如果您想制作单独的水印图像，那么您可以检查热链接文件，然后提供水印图像。

```
header("content-type: image/jpeg");
if (!isset($_SERVER['HTTP_REFERER'])){die("alert('Restricted Access!');");};
$_u=parse_url($_SERVER['HTTP_REFERER']);
$_u=preg_replace("/(www.)/i","",strtolower($_u['host']));
$_i=$_SERVER['HTTP_HOST'];
$_i=preg_replace("/(www.)/i","",strtolower($_i));
if ($_u != $_i){
   //handle this with gd or redirect
} 
```

按照[本教程](http://www.codeofaninja.com/2012/04/append-watermark-image-using-php-and.html)中的说明在图片上制作水印。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T10:54:54.580

请检查本网站中相同的以下网址，这将对您有很大帮助

[http://www.phpjabbers.com/put-watermark-on-images-using-php-php20.html](http://www.phpjabbers.com/put-watermark-on-images-using-php-php20.html)

以下来自上面的链接

```
 <?php
function watermarkImage ($SourceFile, $WaterMarkText, $DestinationFile) { 
   list($width, $height) = getimagesize($SourceFile);
   $image_p = imagecreatetruecolor($width, $height);
   $image = imagecreatefromjpeg($SourceFile);
   imagecopyresampled($image_p, $image, 0, 0, 0, 0, $width, $height, $width, $height); 
   $black = imagecolorallocate($image_p, 0, 0, 0);
   $font = 'arial.ttf';
   $font_size = 10; 
   imagettftext($image_p, $font_size, 0, 10, 20, $black, $font, $WaterMarkText);
   if ($DestinationFile<>'') {
      imagejpeg ($image_p, $DestinationFile, 100); 
   } else {
      header('Content-Type: image/jpeg');
      imagejpeg($image_p, null, 100);
   };
   imagedestroy($image); 
   imagedestroy($image_p); 
};
?>
<?php
$SourceFile = 'image1.jpg';//image path
$DestinationFile = 'images/image1-watermark.jpg'; //Out put path
$WaterMarkText = 'Copyright Watermark text';
watermarkImage ($SourceFile, $WaterMarkText, $DestinationFile);
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T10:56:27.450

我建议使用函数`imagecopymerge()`在 php [http://www.php.net/manual/en/function.imagecopymerge.php](http://www.php.net/manual/en/function.imagecopymerge.php)中添加水印，但如前所述：应在将它们加载到浏览器之前添加它们。当用户下载它们（右键单击）时，它们已经被提供给他们的浏览器（并且通常在缓存中）。

当然，您可以动态提供所有图像并检查`http_referer`图像加载。如果缺少或不是预期的（未从您的网页加载文件），则添加水印，但这并非万无一失。

# html - 无法同时显示：inline-block 和 width:100%

> ID：13377392
> 
> 赞同：0
> 
> 时间：2012-11-14T10:50:38.753
> 
> 标签：html, css, styles, width, inline

我不是 CSS 专业人士。所以我只知道它的一些基础知识。我的任务是拥有 100% 的正文宽度，同时它不应该在浏览器窗口调整大小时包装内容。

为了实现这一点，我添加`display: inline-block`了我的 body 标签的 CSS 样式。但是当我这样做时，宽度会减小。然后我尝试添加`width:100%`到身体风格。宽度按我的意愿改变，但随后`display: inline-block`停止工作。如何同时启用这两个属性？

```
<body style="display: inline-block; width:100%"><!--content---></body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:00:23.917

为什么要固定`body`宽度？如果您愿意，只需在体内使用容器

CSS

```
body {
  height: 100%;
  width: 100%;
}

.container {
  width: 1000px;
  margin: 0 auto;
} 
```

HTML

```
<body>
  <div class="container"></div>
</body> 
```

或者，如果您希望您的内容区域`100%`不仅仅是将您的 CSS 更改为此

CSS

```
body {
  height: 100%;
  width: 100%;
}

.container {
  width: 100%;
} 
```

# c# - 在 WinRT 中从 UI 调用 HttpClient - 没有任何反应

> ID：13377395
> 
> 赞同：2
> 
> 时间：2012-11-14T10:50:48.333
> 
> 标签：c#, windows-8, dotnet-httpclient, winrt-async

我正在尝试在 Windows 8 Metro App 中获取网站的内容。我仍然对异步和等待方法有点困惑。
但这就是我所拥有的：

```
private void HelloButton_Click(object sender, RoutedEventArgs e)
{  
    GetPage().Wait();
}

private async Task GetPage()
{
      HttpClient client = new HttpClient();

      HttpResponseMessage response = await client.GetAsync("http://www.supertext.ch");
      response.EnsureSuccessStatusCode();
      string responseBody = await response.Content.ReadAsStringAsync();
} 
```

不幸的是，什么也没有发生。如果尝试调试它，它只会在 GetAsync() 处停止。
我是否需要使 HelloButton_Click 函数也异步？
即使我等待函数 GetPage() 的完成？
我可以直接从 GUI 线程调用网络请求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:29:51.150

不要调用`Wait`任务。`await`它。这是一个常见的初学者错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:54:36.397

将 HelloButton_Click 更改为：

```
private async void HelloButton_Click(object sender, RoutedEventArgs e)
{  
    await GetPage();
} 
```

# spring - 无法解析 JspException 和 PageContext

> ID：13377396
> 
> 赞同：13
> 
> 时间：2012-11-14T10:50:50.960
> 
> 标签：spring, jsp

[这是关于在 spring mvc 应用程序的 jsp 页面中访问资源](https://stackoverflow.com/questions/13376473/accessing-resources-in-jsp-page-of-spring-mvc-app)的问题的后续问题 感谢@kmb385，我能够解决该问题，但现在我的 JSP 文件 javax.servlet.jsp.JspException 中出现以下 Eclipse 错误不能解析为一个类型和

javax.servlet.jsp.PageContext 无法解析为类型

正如 kmb385 所建议的，这是我的控制器：

```
@Controller
public class AdminController {

        @RequestMapping("/")
        protected ModelAndView handleRequestInternal(HttpServletRequest request,
            HttpServletResponse response) throws Exception {

            ModelAndView model = new ModelAndView("index");
            model.addObject("msg", "hello world");

            return model;
        }   
    } 
```

这是我的 index.jsp 页面以防万一：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<!-- <link type="text/css" rel="stylesheet" href="css/style.css"/> -->
<style type="text/css">
    <%@include file="css/style.css" %>
    </style>
<title>My Project - MainPage</title>
</head>
<body>
<h2 class="main_heading2">My Project - MainPage</h2>
<div style="float: right; width: 30%; text-align: center">
<p style="float:left;">an image should be here</p>
<img src="images/logo.jpg" alt="Logo"/>
<img src="${pageContext.servletContext.contextPath}/resources/images/logo.jpg" />
</div>

</body> 
```

通过在 JSP 验证器中禁用它，我遇到了“解决方案”，但除非您能给出合理的理由，否则请不要建议这样做。我宁愿正确纠正这个问题

任何帮助表示赞赏

**更新：** 根据@kmb385 的要求构建路径屏幕抓取 ![Eclipse 构建路径](../Images/a236076da726ff91c29e36f5b05ce881.png)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-14T11:02:33.793

尝试将`servlet-api`pom.xml 中的依赖项设置为提供。这个 jar 可能与 tomcat 提供的 servlet-api.jar 冲突。

```
 <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency> 
```

还要确保包含 jsp-api 依赖项，再次按照提供的方式设置：

```
 <!-- Servlet -->
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>javax.servlet.jsp-api</artifactId>
        <version>2.3.3</version>
        <scope>provided</scope>
    </dependency> 
```

通过右键单击您的项目 > 属性，确保您的所有 Maven 依赖项都用于构建项目。在部署程序集选项卡上单击添加按钮，然后单击 Java 构建路径条目，然后单击 Maven 依赖项，最后单击完成。

您可能还需要将 Maven 依赖项添加到构建路径。右键单击您的项目 > Maven > 更新项目配置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-03T14:46:18.427

如果你已经在 maven 中下载了所有的依赖项并且错误仍然没有消失，请按照以下步骤操作：

1.  右键单击项目并转到属性
2.  点击目标运行时间
3.  选中您正在使用的服务器前面的框。

这应该有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-14T11:14:59.857

尝试导入类。

修改你的jsp的第一行看起来像这样；

`<%@ page language="java" import="javax.servlet.jsp.PageContext" contentType="text/html; charset=ISO-8859-1"pageEncoding="ISO-8859-1"%>`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-30T11:42:12.387

**添加到 pom.xml 依赖项**：

```
 <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.1</version>
        <scope>provided</scope>
    </dependency> 
```

**JSP：**

确保在标记之前添加 jsp：

```
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> 
```

获取 JSP 的上下文：

```
<c:set var="contextPath" value="${pageContext.request.contextPath}"/> 
```

导入样式 css：

```
<link type="text/css" rel="stylesheet" href="${contextPath}/css/yourCssFile.css"/> 
```

**调度程序-servlet：**

在您的“spring-dispatcher-servlet.xml”上添加以下行：

```
<beans xmlns="... xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="...
http://www.springframework.org/schema/mvc 
http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<mvc:resources mapping="/resources/**" location="/resources/css/" /> 
```

也许，您需要添加此适配器：

```
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>
<bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/> [Optional]
<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
    <property name="order" value="0"/>
</bean> 
```

此处解释：[如何使用 spring MVC 在 jsp 中包含 js 和 css](https://stackoverflow.com/questions/26276603/how-to-include-js-and-css-in-jsp-with-spring-mvc)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-27T15:05:19.500

如何解决 javax.servlet.jsp.PageContext 无法解析为类型

1：- 选择您的项目并右键单击

2:- 转到属性

3:- 单击目标运行时

4:- 勾选“Apache Tomcat v8.0”

在我的情况下，我使用的是 Apache v8.0

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-24T05:17:40.023

```
This will solve the problem 

<!-- Need this to compile JSP -->
        <dependency>
            <groupId>org.apache.tomcat.embed</groupId>
            <artifactId>tomcat-embed-jasper</artifactId>
            <scope>provided</scope>
        </dependency> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-24T07:53:53.200

这种替代方法对我`<%=request.getContextPath()%>`有用，它可以获取应用程序上下文。

# visual-studio-2010 - CoffeeScript 智能感知

> ID：13377398
> 
> 赞同：4
> 
> 时间：2012-11-14T10:50:54.077
> 
> 标签：visual-studio-2010, coffeescript, visual-studio-2012

我使用 Visual Studio 进行开发，我很习惯 Intellisense。但是在编写 CoffeeScript 时，您并没有真正得到任何语法检查或 Intellisense。

是否有允许这样做的 VS 插件？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:58:40.127

您只能使用 coffeescript（在任何 IDE 上）AFAIK 进行语法检查/着色。

作为替代方案，您可以使用 TypeScript 来获得完整的 Visual Studio 工具支持（并与 javascript 保持接近），或者使用一些将代码转换为 javascript 的转编译器，对于 C# 有[Saltarelle](http://www.saltarelle-compiler.com/)和对于 CIL（.NET 字节码，因此与任何 .NET 语言），我刚刚找到[了 JSIL](http://jsil.org/)，但我不知道它的效果如何。

请注意，生成的代码“外观”对于调试和使用外部库可能很重要，因此需要在类型语言中包含一些工作。

对于 js 代码的可读性，我会推荐 TypeScript（类似于咖啡脚本，更简单，但作为一种语言功能不那么强大）。Saltarelle 代码看起来可读（没有尝试很多），对于 JSIL 我不知道。

编译为 JS 的语言列表：[https ://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-c​​ompile-to-JS](https://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-compile-to-JS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T01:33:07.360

Webstorm 和所有 JetBrains IDE 最近添加了一些代码完成和重构支持。它知道我自己的类中有哪些方法，并会在我键入时提示完成。键入时的红色波浪下划线编译还没有出现，但它即将到来。我敢打赌 Webstorm 也是第一个实现 CS source map 的。在过去的 11 个月里，他们增加了很多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T10:57:43.327

看看这个：http: [//visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a](http://visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a)

这是另一个：[http ://chirpy.codeplex.com/](http://chirpy.codeplex.com/)

我认为这应该做你想要的。

# knockout.js - errors() 中的第一项是 [null]

> ID：13377399
> 
> 赞同：4
> 
> 时间：2012-11-14T10:50:55.613
> 
> 标签：knockout.js, knockout-validation

我有以下代码：

```
function JobTask() {
    var self = this;

    self.description = ko.observable('').extend({
        required: true
    });
    self.priority = ko.observable('').extend({
        number: true,
        required: true
    });
    self.complete = ko.observable(false);
}

function CreateJobViewModel() {
    var self = this;

    self.task = ko.observable(new JobTask());

    self.taskErrors = ko.validation.group(self.task);
    self.addTask = function () {

        if (self.taskErrors().length) {
            console.log(self.taskErrors());
            self.taskErrors.showAllMessages();
        }
        else {
            ...
        }
    };
} 
```

问题是，当我添加任务时，即使我正确输入了字段，由于某种原因它也是无效的。控制台输出`[null]`. 经过进一步调查，似乎即使我没有正确输入我的字段，我`taskErrors`数组中的第一项总是`[null]`. 所以它可能看起来像：`[null], "This field is required."`. 不知道我做错了什么？

## 编辑

这是我为这个问题创建的小提琴：http: [//jsfiddle.net/5kh6h/1/](http://jsfiddle.net/5kh6h/1/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T13:24:58.003

您的任务属性是可观察的（一个函数），因此要对其应用验证，您应该使用 () 传递对象。

```
self.taskErrors = ko.validation.group(self.task()); 
```

当您的对象是可观察的时，您应该小心。

```
self.task = ko.observable(new JobTask()); 
```

您可以像这样访问他的属性：

```
console.log(self.task().description); 
```

不像这样：

```
console.log(self.task.description); 
```

没有 () 的任务是一个函数而不是一个对象，这就是诀窍。

这是你的工作小提琴：http: [//jsfiddle.net/mounir/5kh6h/5/](http://jsfiddle.net/mounir/5kh6h/5/)

祝你好运

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T13:18:38.187

将错误移入`JobTask`，问题就消失了。

[http://jsfiddle.net/jearles/5kh6h/4/](http://jsfiddle.net/jearles/5kh6h/4/)

--

```
function JobTask() {
    var self = this;

    self.description = ko.observable('').extend({
        required: true
    });
    self.priority = ko.observable('').extend({
        number: true,
        required: true
    });
    self.complete = ko.observable(false);
    self.errors = ko.validation.group(self);    
}

function CreateJobViewModel() {
    var self = this;

    self.task = ko.observable(new JobTask());

    self.addTask = function() {

        if (self.task().errors().length) {
            console.log(self.task().errors());
            self.task().errors.showAllMessages();
        }
        else {
            alert('Success!');
        }
    };

} 
```

# ruby-on-rails - 守卫和红宝石版本的问题

> ID：13377402
> 
> 赞同：1
> 
> 时间：2012-11-14T10:51:30.110
> 
> 标签：ruby-on-rails, rspec, guard

我在我的 Gemfile 中添加了防护和 rb-notify 并运行包：

```
gem 'guard-rspec', '1.2.1', :group => :test

gem 'rb-inotify', '0.8.8', :group => [:development, :test]
gem 'libnotify', '0.5.9', :group => [:development, :test] 
```

但是，当我运行 bundle exec spork 时，我得到以下信息：

```
bundle exec guard
10:47:09 - INFO - Guard uses Libnotify to send notifications.
10:47:09 - INFO - Guard uses TerminalTitle to send notifications.
10:47:09 - INFO - Guard is now watching at '/home/paul/work/test-demo'
10:47:09 - INFO - Guard::RSpec is running, with RSpec 2!
10:47:09 - INFO - Running all specs
Running tests with args ["--drb", "-f", "progress", "-r", "/home/paul/.rvm/gems/ruby-1.9.2-p290@test-demo/gems/guard-rspec-1.2.1/lib/guard/rspec/formatters/notification_rspec.rb", "-f", "Guard::RSpec::Formatter::NotificationRSpec", "--out", "/dev/null", "--failure-exit-code", "2", "spec"]...
Done.

/home/paul/.rvm/gems/ruby-1.9.2-p290@test-demo/gems/ffi-1.1.5/lib/ffi_c.so: [BUG] Segmentation fault
ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]

Aborted 
```

我猜它是 1.8.7 和 1.9.2 的东西。我正在运行 rvm 和 1.9.2。`ruby -v`告诉我 1.9.2，但 seg 错误似乎与 1.8.7 相关。

我的保护文件非常简单：

```
guard 'rspec', :version => 2, :all_after_pass => false, :cli => '--drb' do
  watch(%r{^spec/.+_spec\.rb$})
  watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
  watch('spec/spec_helper.rb')  { "spec" }

  # Rails example
  watch(%r{^app/(.+)\.rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
  watch(%r{^app/(.*)(\.erb|\.haml)$})                 { |m| "spec/#{m[1]}#{m[2]}_spec.rb" }
  watch(%r{^app/controllers/(.+)_(controller)\.rb$})  { |m| ["spec/routing/#{m[1]}_routing_spec.rb", "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb", "spec/acceptance/#{m[1]}_spec.rb"] 
  watch(%r{^spec/support/(.+)\.rb$})                  { "spec" }
  watch('config/routes.rb')                           { "spec/routing" }
  watch('app/controllers/application_controller.rb')  { "spec/controllers" }

  # Capybara request specs
  watch(%r{^app/views/(.+)/.*\.(erb|haml)$})          { |m| "spec/requests/#{m[1]}_spec.rb" }

end 
```

有什么想法我可能会出错吗？编辑：奇怪的是，当我更改为使用 Ruby 1.8.7 时它可以工作（在更改了许多其他依赖于 1.9.2 的 gem/代码之后）。不过，我仍然想使用更高版本的 ruby

# java - 带回溯的数独算法 - java

> ID：13377407
> 
> 赞同：5
> 
> 时间：2012-11-14T10:52:03.207
> 
> 标签：java, algorithm, sudoku, backtracking

所以我有这个大学任务来解决数独......我读到了关于算法 X 和跳舞算法，但他们没有帮助我。

我需要通过回溯来实现。我用维基百科给出的位置上的数字硬编码了二维数组中的一些索引（所以我确信它是可解决的）。

我得到的代码如下：

```
public void solveSudoku(int row, int col)
   {
      // clears the temporary storage array that is use to check if there are
      // dublicates on the row/col
      for (int k = 0; k < 9; k++)
      {
         dublicates[k] = 0;
      }
      // checks if the index is free and changes the input number by looping
      // until suitable
      if (available(row, col))
      {
         for (int i = 1; i < 10; i++)
         {
            if (checkIfDublicates(i) == true)
            {
               board[row][col] = i;
               if (row == 8)
                  solveSudoku(0, col + 1);
               else if (col == 8)
                  solveSudoku(row + 1, 0);
               else
                  solveSudoku(row, col + 1);

               board[row][col] = 0;
            }
         }
      }
      // goes to the next row/col
      else
      {
         if (row == 8)
            solveSudoku(0, col + 1);
         else if (col == 8)
            solveSudoku(row + 1, 0);
         else
            solveSudoku(row, col + 1);
      }
   }

   /**
    * Checks if the spot on the certain row-col index is free of element
    * 
    * @param row
    * @param col
    * @return
    */
   private boolean available(int row, int col)
   {
      if (board[row][col] != 0)
         return false;
      else
         return true;
   }

   /**
    * Checks if the number given is not already used in this row/col
    * 
    * @param numberToCheck
    * @return
    */
   private boolean checkIfDublicates(int numberToCheck)
   {
      boolean temp = true;
      for (int i = 0; i < dublicates.length; i++)
      {
         if (numberToCheck == dublicates[i])
         {
            temp = false;
            return false;
         }
         else if (dublicates[i] == 0)
         {
            dublicates[i] = numberToCheck;
            temp = true;
            return true;
         }
      }
      return temp;
   } 
```

我正在使用 StackOverflow

```
// goes to the next row/col
          else
          {
             if (row == 8)
                solveSudoku(0, col + 1);
             else if (col == 8)
                solveSudoku(row + 1, 0);
             else
                solveSudoku(row, col + 1);
          } 
```

这意味着我必须在某个时候停止递归，但我不知道怎么做！如果您在该`solve()`功能中发现任何其他错误 - 请告诉我。因为我不确定我是否完全理解“回溯”的东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:01:44.787

例如，如果您跟踪当前的递归深度，您可以停止递归

```
public void solveSudoku(int row, int col, int recursionDepth) {
    // get out of here if too much
    if (recursionDepth > 15) return;

    // regular code...
    // at some point call self with increased depth
    solveSudoku(0, col + 1, recursionDepth + 1);
} 
```

* * *

> 如果您在 solve() 函数中发现任何其他错误，请告诉我。

代码太多:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T11:03:06.780

这大致是我过去的做法。

```
Whenever all the definite moves have been taken and there is a choice of equally good next moves:
    copy your grid data structure and push it onto a stack.
    take the first candidate move and continue solving recursively
    Whereever you get stuck:
         pop the saved grid off the stack
         take the next candidate move. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T12:26:50.663

我用一种更简单的方式做到了：

```
public void solve(int row, int col)
   {
      if (row > 8)
      {
         printBoard();
         System.out.println();
         return;
      }
      if (board[row][col] != 0)
      {
         if (col < 8)
            solve(row, col + 1);
         else
            solve(row + 1, 0);
      }
      else
      {
         for (int i = 0; i < 10; i++)
            if (checkRow(row, i) && checkCol(col, i))
                  //&& checkSquare(row, col, i))
            {
               board[row][col] = i;
               if (col < 8)
                  solve(row, col + 1);
               else
                  solve(row + 1, 0);
            }
         board[row][col] = 0;
      }
   }

   private boolean checkRow(int row, int numberToCheck)
   {
      for (int i = 0; i < 9; i++)
         if (board[row][i] == numberToCheck)
            return false;

      return true;
   }

   private boolean checkCol(int col, int numberToCheck)
   {
      for (int i = 0; i < 9; i++)
         if (board[i][col] == numberToCheck)
            return false;

      return true;
   } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T13:40:53.337

我不确定你为什么说 Dancing Links 和 Algorithm X 没有用。
您的意思是您无法将数独映射到算法 X 旨在解决的精确覆盖问题的实例？
或者它对于你需要的东西来说太复杂了？

如果是前者，您可能需要查看：[Java Sudoku Solver implementation Knuth's Dancing Links Algorithm](http://www.ocf.berkeley.edu/~jchu/publicportal/sudoku/sudoku.paper.html)。这很清楚，也解释了背后的原因。

NB 算法 X 是一种回溯算法，因此，如果这是您唯一的要求，您绝对可以使用这种方法。

希望这能有所帮助。

# c# - 如何在 c# 中检测两个图像之间的冲突？

> ID：13377408
> 
> 赞同：1
> 
> 时间：2012-11-14T10:52:11.537
> 
> 标签：c#, visual-studio-2010, collision-detection

> **可能重复：**
> [基本 2d 碰撞检测](https://stackoverflow.com/questions/3851520/basic-2d-collision-detection)

希望你能帮我解决这个问题。我是 c# 新手，所以非常缺乏经验。但基本上我正在尝试制作一个游戏，其中某些物体从天而降。羽毛等一些物体需要一段时间才能掉落，而金属球会掉落得更快。您从一定数量的现金开始，可以购买您选择的武器放置在下面的地面上。现在我以前从未做过任何与碰撞有关的事情，所以简单的答案会有很大帮助！

以下是游戏中的一些碰撞：（不确定不同类型的碰撞是否编码不同）

*   子弹与坠落物体的碰撞
*   坠落物体与地面碰撞（无生命）
*   坠落物体与另一个物体周围一定半径之间的碰撞（例如，如果武器从其中心发出辐射束）
*   旋转物体（旋转刀片）与坠落物体之间的碰撞

如果有人可以帮助我，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:39:37.427

几个月前，我在海流计算方面遇到了类似的问题。还有一个算法需要解决（10 年前小学编程竞赛）关于卡片落地并检测是否存在重叠。

在海流中，我有几乎无限数量的流路径矢量，因此我计算了其中电流不受障碍物影响的最小半径。如果电流太靠近障碍物（在最小半径内），则开始进行精确碰撞的实际计算。

关于卡片。卡由 4 点表示。让我们说 2d, (0,0), (1,0), (0, 1), (1, 1)。要检测另一张牌是否与其重叠，只需检测第二张牌点是否放置在该方格内，反之亦然。

对于 Vyktor 之前提到的真正的子弹/羽毛碰撞检查主题。

# simperium - Simperium 409 错误，这是什么原因造成的？

> ID：13377412
> 
> 赞同：0
> 
> 时间：2012-11-14T10:52:25.373
> 
> 标签：simperium

我正在 iOS6 中设置一个现有应用程序以与 simperium 一起使用，几周以来一切顺利，但今天我开始看到这些错误。

我删除了 Simperium 中的应用程序并开始使用新的应用程序，但仍然出现错误。

测试用例是对已经在 coredata 中拥有数据的现有用户的升级。所以他们创建了 simperium 帐户，这是 simperium 所做的第一个同步。

```
2012-11-14 10:46:31:931 Simperium POST returned error 409 for change {
ccid = da3d0c7bed984f88872f9e7d7527f0f9;
clientid = "ios-ca84b5cc41cc00962c1141a2854aeee0";
error = 409;
id = 54f58c57de65485f889aa4b30c39c54b;
r =     (
    50a3760437a401650500001b
); 
```

}

我也看到了其中一些错误，但不是很多：

```
2012-11-14 10:44:52:823 Simperium error: transform diff for a ghost member (ghost    <SPGhost: 0x1d6324c0>, memberData (null)) that doesn't exist (showInDropDown): {
o = "+";
v = 0; 
```

}

还有这个：

Simperium 超时，服务器没有响应 GET 代码 504 (ClipModel82)，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T21:16:39.573

504 是预期的超时。预计不会出现其他错误。409 是重复的更改，它被忽略但不应该发生。如果您通过非 iOS 客户端对 Core Data 模型中不存在的属性进行更改，则可能会发生转换错误。

有几件事要尝试：使用撰写本文时在 GitHub 上的“iosupdate”分支。它具有最新的更改和修复。也可以尝试`setVerboseLoggingEnabled:YES`通过电子邮件与我们联系，包括作为附件的日志输出 (help@simperium.com)。

# javascript - Javascript for () 循环变体

> ID：13377415
> 
> 赞同：2
> 
> 时间：2012-11-14T10:52:39.030
> 
> 标签：javascript, for-loop

我正在使用以下属性创建此元素：

```
var x = document.createElement('x');
x.setAttribute('ha','1');
x.setAttribute('he','2');
x.setAttribute('hi','3'); 
```

然后我使用这两种形式循环遍历它，每次得到不同的输出：

```
>>>for(var i in x.attributes) console.log(x.attributes[i]);
ha="1"
he="2"
hi="3"
3
item()
getNamedItem()
setNamedItem()
removeNamedItem()
getNamedItemNS()
setNamedItemNS()
removeNamedItemNS() 
```

还有一个：

```
>>>for(var i=0;i<x.attributes.length;i++) console.log(x.attributes[i]);
ha="1"
he="2"
hi="3" 
```

那么，这不应该给出相同的结果吗？为什么不 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T10:55:10.333

该`for...in`方法遍历对象的所有属性，包括“本机”属性。要将输出限制为您定义的那些属性：

```
for (var i in obj) {
    if (obj.hasOwnProperty(i)) {
        console.log(i);
    }
} 
```

参考：

*   [`for...in`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in).
*   [`hasOwnProperty()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T10:55:14.940

这是因为您也从原型中获得了一切。用于`hasOwnProperty`仅迭代您设置的那些属性：

```
for(var i in x.attributes){ 
    if (x.hasOwnProperty(i)) {
        console.log(x.attributes[i]);
    }
} 
```

# php - 我怎么能用php做到这一点？

> ID：13377417
> 
> 赞同：-3
> 
> 时间：2012-11-14T10:52:50.787
> 
> 标签：php

我是 php 新手。现在我想知道这些

1）我如何获取到最后一个文件夹的 url 路径假设 url 是`http://www.abc.com/xyz/aaa/bbb/login.php?id=23` 我想要占用的`http://www.abc.com/xyz/aaa/bbb`

2）如何在从数据库显示时为图像提供神秘的路径

`<img src="<?php echo $path;?>" />`我怎样才能给这个 $path 神秘的

3）我如何在每天晚上 11 点发送邮件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:03:10.827

让我们开始收集一些答案。如果您可以对上述评论中的问题给出有意义的答案，则可能会有更多信息：

* * *

**问题 1**：很可能这是您想要做的：

```
substr($url, 0, -strlen(strrchr($url,'/'))) 
```

或者：

```
dirname(sprintf('http://%s%s', $_SERVER['HTTP_HOST'], $_SERVER['REQUEST_URI'])) 
```

* * *

**问题 2**：混淆 url 中使用的路径以引用某处发布的图像几乎没有意义：url 必须引用图像才能使任何人都能看到图像。为此，图像的位置必须通过 url 公开，那么混淆的意义何在？模糊的 url 引用了图像，但是它看起来。每个人都可以使用该 url 来检索图像。

* * *

**问题 3**：您在系统级别配置了一个每天晚上 11 点运行的 crontab 条目。那份工作叫做`wget http://localhost/myapp/sendmail.php`. 该脚本`sendmail.php`收集所需的数据并发送电子邮件。

# cakephp - 在自定义类中使用 cake htmlhelper

> ID：13377426
> 
> 赞同：0
> 
> 时间：2012-11-14T10:53:35.663
> 
> 标签：cakephp

我有一个自定义类，我存储在 /app/Lib 中，我想使用 htmlhelper 但由于该类没有扩展任何内容，因此对 $this 的引用`$this->Html->link`给出了错误：调用成员函数链接（）非对象

我如何在自己的班级中使用这个助手？

这是：

```
<?php
class Tree {

  private $level = 0;

  public function show_tree($tree_array) {
    $this->level++;
    $style = ($this->level==1) ? ' class="sortable"':'';
    echo "<ol".$style.">\n";
    foreach ($tree_array as $t) {
        echo "<li id=\"list_".$t['Category']['id']."\">\n";         
        echo "<div>".$t['Category']['name'];?>
        echo $this->Html->link(__('View'), array('action' => 'view', $t['Category']['id']));
        echo $this->Html->link(__('Edit'), array('action' => 'edit', $t['Category']['id']));
        echo $this->Form->postLink(__('Delete'), array('action' => 'delete', $t['Category']['id']), null, __('Are you sure you want to delete # %s?', $t['Category']['id']));
        echo "</span>\n";
        echo "</div>\n";
        if (!empty($t['children'])) $this->show_tree($t['children']);
        echo "</li>\n";
    }
    echo "</ol>\n";
    $this->level--;
   }

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:10:43.030

通过查看您的代码，您显然需要一个帮助程序，而不是一个库。

扩展 html 帮助程序或在您的自定义帮助程序中使用它，例如名为 NestedListHelper。这是 MVC 上下文中的正确方法，也是编写代码最少的方法。

看看这个 TreeHelper，它还会根据树结构生成嵌套列表，它可能类似于您尝试做的事情：[https ://github.com/CakeDC/utils/blob/master/View/Helper/TreeHelper .php](https://github.com/CakeDC/utils/blob/master/View/Helper/TreeHelper.php)

# c++ - 管道中有多少数据（c ++）

> ID：13377427
> 
> 赞同：0
> 
> 时间：2012-11-14T10:53:36.227
> 
> 标签：c++, pipe

我试图猜测管道中有多少数据，我不想使用`while(read)`，因为它在 EOF 之前一直阻塞。

有没有办法做到这一点？

我真的想要这样的东西：

```
i = pipe1.size();
pipe1.read(i); 
```

我再说一遍，我不想使用`while (read)`，因为它一直阻塞到 EOF。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T10:56:23.720

来自管道的数据量可能是无限的，就像流一样，没有`size`管道中的概念。如果你不想让它阻塞，如果没有什么可读的，你应该`O_NONBLOCK`在调用时设置标志`pipe2()`：

```
pipe2(pipefd, O_NONBLOCK); 
```

这样，当您调用时，`read()`如果没有数据，它将失败并设置`errno`为`EWOULDBLOCK`

```
if (read(fd, ...) < 0) {
   if (errno == EWOULDBLOCK) {
      //no data
   }
   //other errors
} 
```

从手册页：

> O_NONBLOCK：在两个新打开的文件描述上设置 O_NONBLOCK 文件状态标志。使用此标志可节省对 fcntl(2) 的额外调用以实现相同的结果。

您还可以在阻塞管道上使用[select()来超时。](http://linux.die.net/man/2/select)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T13:18:07.710

这可以帮助你，但它是特定于 unix 的：

```
#include <iostream>

#include <sys/types.h>
#include <sys/ioctl.h>
#include <sys/socket.h>
#include <errno.h>

int pipe_fd; /* your pipe's file descriptor */

......

int nbytes = 0;

//see how much data is waiting in buffer
if ( ioctl(pipe_fd, FIONREAD, &nbytes) < 0 )
{
    std::cout << "error occured: " << errno;
}
else 
{
    std::cout << nbytes << " bytes waiting in buffer";
} 
```

# bash - 从 shell 脚本执行 Maven 任务并获取错误代码

> ID：13377436
> 
> 赞同：15
> 
> 时间：2012-11-14T10:54:06.130
> 
> 标签：bash, shell, maven

我正在从 bash 脚本执行 Maven 部署任务，但是即使 Maven 任务失败，脚本也会继续并完成而不会出现错误。

我已经尝试了 -e 标志，但这会导致部署失败。我还尝试了以下（伪代码）

```
result_code= mvn deploy
if [$result_code -gt 0];then
exit 1 
```

有什么建议我可以确定部署是否成功？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-14T11:00:57.933

`result_code=mvn deploy`不是获得退货状态的方法

你可以试试例如：

```
#!/bin/bash
mvn deploy
STATUS=$?
if [ $STATUS -eq 0 ]; then
echo "Deployment Successful"
else
echo "Deployment Failed"
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-28T13:05:23.470

此外，如果有人使用 Windows 10，这是我使用的示例：

```
mvn deploy
if not %ERROR_CODE%==0 goto error

echo SUCCESS
goto end

:error
echo FAILED

:end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-13T21:24:21.353

尽管失败，但一个人的 mvn 任务可能返回 0 的另一个可能原因是：**小心将 maven 的输出通过管道传输到其他程序**。例如，我正在使用`grcat`（`grc`构建在其之上），它将始终返回退出代码 0；

```
\mvn compile | grcat ~/conf.mvn 
```

我不确定如何保留输出的漂亮颜色编码。那里有 color_maven.sh 但还有其他问题。

# javascript - Flask webservice 的 HighCharts 查询参数问题

> ID：13377441
> 
> 赞同：3
> 
> 时间：2012-11-14T10:54:30.437
> 
> 标签：javascript, python, character-encoding, highcharts, flask

我有一个*HighCharts*客户端，其职责是从 Web 服务加载数据并显示图表。请求数据的函数如下所示：

```
function requestData() {
    $.ajax({
        url:  'http://myhost.com/type?x=1&y=2&z=3',
        headers: { 
          Accept : "application/json"
        },
        type: "GET",
        dataType: "json",
        success: function(data) {
          //do something
        },
        cache: true
    });
} 
```

（以后`url`会动态生成属性）

目标 Web 服务是只读的，并使用*Flask*微框架实现：其目的是将 JSON 数据返回给 HighCharts 客户端。这是处理数据请求的 Flask 视图（函数）：

```
@app.route('/<type>')
def get_data(type):

    x = request.args.get('x','')
    y = request.args.get('y','')
    z = request.args.get('z','')

    [...] 
```

**问题**：当我在 Chrome 中执行 javascript 代码时，以下 HTTP 请求被发送到 web 服务：

```
GET /type?x=1&amp;y=2&amp;z=3 HTTP/1.1  // '&' have been escaped to '&amp;'
Host: myhost.com
Connection: keep-alive
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11
Accept: application/json
Referer: http://myhost.com/chart.html
Accept-Encoding: gzip,deflate,sdch
Accept-Language: it-IT,it;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

...我从服务器得到一个 404 状态代码（错误请求），只要一个或多个请求的查询参数为空或格式错误，这是非常好的和预期的：

```
HTTP/1.0 400 BAD REQUEST
Content-Type: text/html; charset=utf-8
Content-Length: 16
Server: Werkzeug/0.8.3 Python/2.7.3
Date: Wed, 14 Nov 2012 10:23:49 GMT 
```

在我的 Flask 网络服务上调试后，我注意到只有`x`查询参数（请注意是 HTTP 请求中的第一个参数）被*正确解析*，而`y`和`z`是*空字符串*，这会导致 404。

为什么会这样？关于`&`->`&amp;`转义的任何字符集不一致？

谢谢，任何提示都会有真正的帮助（请问您是否需要更多规格或代码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:03:15.300

我认为错误与您预期的转义＆符号一样。

尝试这个：

```
function requestData() {
    $.ajax({
        url:  'http://myhost.com/type',
        headers: { 
          Accept : "application/json"
        },
        data: {
            x: 1,
            y: 2,
            z: 3
        },
        type: "GET",
        dataType: "json",
        success: function(data) {
          //do something
        },
        cache: true
    });
} 
```

# git - 如何更新从 SVN 克隆的 git repo 中的用户电子邮件

> ID：13377446
> 
> 赞同：0
> 
> 时间：2012-11-14T10:54:47.213
> 
> 标签：git, github, git-svn

我将我的 SVN 存储库克隆到 GIT。当我这样做时，我指出了带有用户名的文件。

```
user1 = User1 <user1@mail.com>
user2 = User2 <user2@mail.com> 
```

然后我更新到github。除一个用户外，所有用户都被识别。我发现我在电子邮件中犯了拼写错误。

我用了这个方法`git --filter-branch`。

[在 Git 中更改多个提交的作者和提交者名称和电子邮件](https://stackoverflow.com/questions/750172/how-do-i-change-the-author-of-a-commit-in-git)

它成功地改变了这个用户的邮件。但是现在当我推送到 github 时，它说它是最新的，并且不想更新 github 上的用户电子邮件。

我该如何更新它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:05:20.160

您可以从另一侧修复它：

GitHub 用户可能有不止一封电子邮件，所有电子邮件都将链接到提交中的正确用户（AFAICS）

# mustache - 使用 Mustache.js 使用 Partials 渲染页面

> ID：13377452
> 
> 赞同：1
> 
> 时间：2012-11-14T10:55:12.893
> 
> 标签：mustache

我实际上制作了一个名为 Rendr.html 的 html 页面

并尝试此代码-----

在脚本中

```
<script type="text/javascript">
var tmpl = "{{>rendr}} {{>inc/header}} {{>../header}}",
data = {},
partials = {
    header : "<h2>First</h2>",
    'inc/header' : "<h1>rendr</h1>",
    '../header' : "<h4>whatever</h4>",
    'rendr' :"rendr.html"
},
html = Mustache.render(tmpl, data, partials);

document.write(html);
</script> 
```

但它只是打印 render.html 而不是渲染到该页面。

# php - wordpress 中的 AJAX 和 PHP 循环进展

> ID：13377455
> 
> 赞同：4
> 
> 时间：2012-11-14T10:55:14.763
> 
> 标签：php, ajax, wordpress, loops, progress

我尝试为一个简单的 php 循环制作某种进度指示器。

这里有[很多关于进度和 php 循环的 ajax / php 问题](https://stackoverflow.com/search?q=php%20loop%20progress%20ajax&submit=search)，但是在阅读了很多之后，我仍然无法实现（也不完全理解）逻辑..

他们中的大多数要么在谈论*-upload-*进度条，要么过于本地化到特定情况。（要么 - 要么我不知道如何选择正确的关键字进行搜索。）

我的最终目标是制作一个进度条，但首先，我尝试了一个小回声循环。

我尝试了以下方法：

**HTML 表单：**

```
<p class="submit">
    <input type="submit" class="button-primary" id="o99_sudi_do_now" value="<?php _e('DO IT NOW !', 'o99_sudi_domain'); ?>" />
    <img src="<?php echo admin_url('/images/wpspin_light.gif'); ?>" class="waiting" id="o99_sudi_loading" style="display:none;"/>
</p>

            <div id="o99_sudi_results"></div> 
```

**jQuery**

```
jQuery(document).ready(function($){
  jQuery('#o99_sudi_do_now_form').click(function(e){
    e.preventDefault();
    jQuery.post(ajaxurl,{action:'o99_random_loop'}, function(data){
      jQuery('#o99_sudi_results').empty().append( data );
    });
  });
}); 
```

**PHP**

```
function o99_random_loop_cb(){
 for ($i = 0; $i < 10; $i++) {
        //ob_end_clean(); // [TESING]
        echo '-- step' .$i . ' of 10</br>';
        //flush();// [TESING]
        //usleep(100000000000*0.1); // total time 10 sec.// [TESING]
        //ob_flush();// [TESING]
        usleep(20000);
    }
  die(); 
```

并且因为它都在 wordpress 管理区域中 -

```
add_action( 'wp_ajax_o99_random_loop', 'o99_random_loop_cb' ); 
```

结果（或输出）是**：**

```
-- Step 0 of 10
-- Step 1 of 10
-- Step 2 of 10
-- Step 3 of 10
-- Step 4 of 10
-- Step 5 of 10
-- Step 6 of 10
-- Step 7 of 10
-- Step 8 of 10
-- Step 9 of 10 
```

这有点好，但问题是输出到达并且只有在执行完成时才更新 div - 我希望它能够即时更新，逐步......（我真正的计划循环很长，迭代大约需要 2-3 秒。）

就像你可以看到的代码一样，我已经尝试过`flush();`，`ob_flush();`以及我看到的任何其他建议，但我怀疑这里的逻辑是错误的（因为它是 wordpress？？或者在错误的地方刷新？）实际上，无论如何很多我`flush()`; - 结果仅在函数结束时到达..

我的目标是制作一个进度条 - 但现在即使是简单的回声进度的帮助也会很棒..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:18:09.013

您无法通过对 PHP 的单个 POST 来实现您想要的。即使刷新 PHP 输出，jQuery 端也不会处理结果处理程序，直到整个 PHP 进程完成。很久以前，只有一些浏览器（Netscape 等）会在文档完成之前开始显示内容，但是，使用 AJAX，在 PHP 脚本完成之前，您不会看到任何来自 PHP 的结果内容。完成的。

因此，您一次获得所有输出的原因。

有几种可能的方法可以完成您想做的事情。一种方法是将您的 PHP 循环分成多个阶段，以便每次只执行循环的一部分。然后，您可以执行几次迭代（甚至一次迭代）并将结果返回给浏览器。然后浏览器将显示结果并再次调用 PHP 以进行下一次迭代（或一组迭代）。虽然这会给您提供进度指示器，但它会大大减慢您的整体操作速度，因此不推荐。

编辑以删除由于并发问题而无法使用的 SESSION 的使用：

另一种选择是让 PHP 将循环的进度保存到数据库中，并让浏览器端定期轮询另一个 PHP 脚本，该脚本检查数据库以确定进度。在快速循环中，这不会有太大帮助，但在更长的运行循环中，这可能是可行的。因此，随着您的 $.post 调用，您将开始一系列定时的 $.get 调用以检查进度。

编辑：这里有一些片段来说明：

```
// variable to control polling logic
var pollInterval;
// Your current post logic here with the addition of a variable to stop execution of the polling process
jQuery.post(ajaxurl,{action:'o99_random_loop'}, function(data){
    // post is complete so stop execution
    window.clearInterval(pollInterval);
});
// Now start a get process to get the progress every 5 seconds
pollInterval = window.setInterval(function () {
    // I'm assuming pollingurl is the URL to your PHP script that checks the progress
    jQuery.get(pollingurl, function(data){
        jQuery('#o99_sudi_results').empty().append( data );
    });
}, 5000); 
```

我现在假设在 PHP 方面，您可以轻松地将进度保存到数据库表并从表中检索所述进度。

# asp.net-mvc-3 - ViewModel、XML 和向导

> ID：13377456
> 
> 赞同：-1
> 
> 时间：2012-11-14T10:55:16.823
> 
> 标签：asp.net-mvc-3, entity-framework-5

我正在使用 MVC3、Razor 和 EF5。

我现在意识到在向导中为每个页面使用 ViewModel 是一个好主意，尤其是当您需要验证记录的一部分时。我还需要在每个页面提交后保存。域模型没有验证注释。

但是我现在想到了一个更好/更坏的主意？？？！！！最终，我将从数据库生成 XML 以将此记录放入报告中。因此，可能/建议拥有一个具有显式列名的 ViewModel 和一个仅包含所有 ViewModel 属性数据进入的 XML 字段的域模型。想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T15:31:49.537

由于 XML 用于存储/交换，我认为它只会使 ViewModel 更加复杂。我认为您可以编写代码，最终将您的 ViewModel 转换为 XML。

# symfony - 将属性添加到树枝文件中的输入元素

> ID：13377458
> 
> 赞同：1
> 
> 时间：2012-11-14T10:55:30.670
> 
> 标签：symfony

我有一个从控制器内部生成的表单。
然后在树枝文件中，我需要向字段（textarea）添加一个属性（占位符）。
在树枝文件中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T10:59:51.827

```
{{ form_row(form.yourField, { 'attr':{'placeholder':'sample value'} }) }} 
```

# javascript - ant进程中的echo文件名

> ID：13377460
> 
> 赞同：4
> 
> 时间：2012-11-14T10:55:35.247
> 
> 标签：javascript, css, ant, yui

我目前在 ant 构建过程中使用 YUI 压缩器来缩小 CSS 和 JavaScript 文件。虽然它正在缩小每个文件，但我希望它输出它当前尝试应用可执行文件的文件的名称，以便如果发生错误，我知道哪个文件导致了错误。例如：

```
[echo] Minifying JS files...
[echo] Trying to minify file1.js...
[echo] Trying to minify file2.js.... 
```

在将应用指令应用于所有文件之后，我看到的每个解决方案似乎都只是回显文件集中的所有文件名。

我的 ant 构建目前看起来像这样：

```
<target name="minifyJS" depends="overwriteCSSWithMinified">
    <echo message="minifying js files and saving them to fileName-min.js" />
    <apply executable="java" parallel="false" dest="${toWebHome}">
        <fileset dir="${toWebHome}">
            <exclude name="**/*.min.js" />
            <include name="**/*.js"/>
         </fileset>
         <arg line="-jar"/>
         <arg path="yuicompressor-2.4.7.jar" />
         <arg line="-v"/>
         <srcfile/>
         <arg line="-o"/>
         <mapper type="glob" from="*.js" to="*-min.js"/>
         <targetfile/>
     </apply>
 </target> 
```

也许还有另一种方法可以做到这一点，而不是使用文件集，而是使用一条指令一次循环遍历每个文件并在文件上执行应用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-15T19:27:28.127

为此，您需要包含[ant-contrib](http://ant-contrib.sourceforge.net)。然后你可以这样做：

```
<target name="minifyJS" depends="overwriteCSSWithMinified">
    <echo message="minifying js files and saving them to fileName-min.js" />
    <foreach target="yui" param="jsFile">
        <fileset dir="${toWebHome}">
            <exclude name="**/*.min.js" />  
                     <!-- should this be -min.js instead of .min.js ? -->
            <include name="**/*.js"/>
        </fileset>
    </foreach>
</target>

<target name="yui">
    <echo message="${jsFile}"/>
    <exec executable="java">
        <arg value="-jar"/>
        <arg value="yuicompressor-2.4.7.jar"/>
        <arg value="-v"/>
        <arg value="-o"/>
        <arg value="'.js$:-min.js'"/>
        <arg value="${jsFile}" />
    </exec>
</target> 
```

# javascript - 如何像在 javascript 中一样在 html 中嵌入 groovy 脚本？

> ID：13377466
> 
> 赞同：3
> 
> 时间：2012-11-14T10:55:55.437
> 
> 标签：javascript, html, groovy

是否可以像在 javascript 中一样在 html 中嵌入 groovy 脚本？我想要一个使用 groovy 脚本而不是 javascript 的 onclick 按钮事件

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T10:58:22.277

你不能

您可以使用 AJAX 调用将运行 groovy 脚本的网络服务器，但您不能像 JavaScript 这样在浏览器中运行 groovy。

[（为了这个答案的完整性，我想你可以推出一个支持 groovy 的小程序，然后使用该小程序执行一些 groovy，但我只会用 javascript 编写脚本并错过这种 Rube-goldberg 阴谋）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T13:25:08.620

这是一个相当古老的项目，我不确定它实际上走了多远，但[Andres Almiray](http://jroller.com/aalmiray/)已经[做了](http://jroller.com/aalmiray/entry/running_groovy_on_an_applet) [一些](http://jroller.com/aalmiray/entry/more_on_groovy_applets) [工作](http://www.jroller.com/aalmiray/entry/live_grapplet_test)，通过[Grapplet](http://groovy.codehaus.org/Grapplet)在浏览器中运行 Groovy 的能力。

我自己没用过，但看起来很有希望。

# eclipse - GWT 编译崩溃 JVM

> ID：13377467
> 
> 赞同：6
> 
> 时间：2012-11-14T10:55:59.537
> 
> 标签：eclipse, gwt, gxt

我正在尝试在 JDK 7u7 下编译一个相对简单的、仅限客户端的 GWT 2.5.0 应用程序。

该项目在开发模式下运行良好。我还记得不久前它在另一台机器上编译正常。（它有 GWT 2.4 和一些 JDK 7，我通过在新机器上创建全新的 GWT 项目并将旧源复制到新的 src 目录，将我的项目转移到 GWT 2.5。我相信在这个阶段一切都很好，因为“开发模式”运行正常，即使在清理项目/缓存之后）。

GWT Eclipse 插件是最新的（昨天从我的 Indigo 的更新站点安装）。

我尝试使用/不使用“-localWorkers 2”，以及不同的内存设置（“-Xmx512m”、“-Xmx2048m”）。我正在尝试不同的输出样式（模糊的、详细的）和不同的日志级别（就像它可以改变任何东西:)）。我什至尝试过“-draftCompile” - 没有成功。

无论如何，在任何情况下，编译都会在几秒钟后停止，并报告 JVM 崩溃报告，如 memcpy (!) 之类的 C 函数或一些 JVM 内部函数。

JVM 跟踪文件：[http://pastebin.com/KzTrQqw7](http://pastebin.com/KzTrQqw7) GWT 调试级别日志：http: [//pastebin.com/yQZHi4Am](http://pastebin.com/yQZHi4Am)

任何想法为什么这会发生在我身上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T16:42:58.427

好的，事实证明你只能在某些时候用 JDK7 编译 GWT（我什至尝试创建一个新的、空的、示例项目，即“GreetingService”项目——它在我的配置中也崩溃了）。

但是有了 JDK6，它就很好了，这要归功于 Anders R. Bystrup。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T16:48:35.423

我没有使用过 JDK 7，但我通常会将 JVM 堆栈大小增加到 4M

```
-Xss4M 
```

# lucene - 从 Lucene 索引查询时返回相同的文档两次

> ID：13377470
> 
> 赞同：1
> 
> 时间：2012-11-14T10:56:05.217
> 
> 标签：lucene

我是 Lucene 的新手。我有一些新闻文本，我正在使用以下字段进行索引：

```
doc.add(new Field("url", article.getUrl(), TextField.TYPE_STORED));
doc.add(new Field("source", article.getSource(), TextField.TYPE_STORED));
doc.add(new Field("title", article.getArticleTitle(), TextField.TYPE_STORED));
doc.add(new Field("content", article.getArticleContent(), TextField.TYPE_STORED));
doc.add(new Field("date", DateTools.dateToString(article.getArticleDate(), DateTools.Resolution.DAY), TextField.TYPE_STORED));
doc.add(new Field("type", article.getType().getName(), TextField.TYPE_STORED)); 
```

当我根据这些字段进行查询时，在某些情况下，同一个文档会被返回两次。我使用以下代码查询索引：

```
StandardAnalyzer analyzer = new StandardAnalyzer(Version.LUCENE_40);

String contentQueryString = buildQuery(contentKeywords);
Query contentKeywordsQuery = null;
if (!StringUtils.isEmpty(contentQueryString)) {
    contentKeywordsQuery = new QueryParser(Version.LUCENE_40, "content", analyzer).parse(contentQueryString);
}

Query titleKeywordsQuery = null;
String titleQueryString = buildQuery(titleKeywords);
if (!StringUtils.isEmpty(titleQueryString)) {
    titleKeywordsQuery = new QueryParser(Version.LUCENE_40, "title", analyzer).parse(titleQueryString);
}

String sFrom = DateTools.dateToString(from, DateTools.Resolution.DAY);
String sTo = DateTools.dateToString(to, DateTools.Resolution.DAY);
Term lowerTerm = new Term("date", sFrom);
Term upperTerm = new Term("date", sTo);
Query dateQuery = new TermRangeQuery("date", lowerTerm.bytes(), upperTerm.bytes(), true, true);

Term sourceTerm = new Term("source", source);
Query sourceQuery = new TermQuery(sourceTerm);

Term typeTerm = new Term("type", type);
Query typeQuery = new TermQuery(typeTerm);

BooleanQuery q = new BooleanQuery();
q.add(dateQuery, BooleanClause.Occur.MUST);
q.add(sourceQuery, BooleanClause.Occur.MUST);
q.add(typeQuery, BooleanClause.Occur.MUST);
if (null != titleKeywordsQuery) {
    q.add(titleKeywordsQuery, BooleanClause.Occur.MUST);
}
if (null != contentKeywordsQuery) {
    q.add(contentKeywordsQuery, BooleanClause.Occur.MUST);
}
Directory index = new SimpleFSDirectory(new File("resources/lucene_index"));
int hitsPerPage = 5;
IndexReader reader = DirectoryReader.open(index);
IndexSearcher searcher = new IndexSearcher(reader);
TopScoreDocCollector collector = TopScoreDocCollector.create(hitsPerPage, true);
searcher.search(q, collector);
ScoreDoc[] hits = collector.topDocs().scoreDocs;

for (int i = 0; i < hits.length; ++i) {
    int docId = hits[i].doc;
    Document d = searcher.doc(docId);
    QueryResult r = new QueryResult(d.get("url"), d.get("title"), d.get("date"), hits[i].score);
    results.add(r);
} 
```

特别是这一行为同一个文档提供了两次点击：

```
ScoreDoc[] hits = collector.topDocs().scoreDocs; 
```

索引中不应该有任何重复的文档，我已经检查过了。

# haskell - Prelude.read 没有解析。输入在一个函数中起作用，而不是在另一个函数中

> ID：13377474
> 
> 赞同：0
> 
> 时间：2012-11-14T10:56:24.423
> 
> 标签：haskell

对，我有两个功能。两者都采用完全相同的文件输入。`run2D`完美运行，但`oneR`给了我错误`Prelude.read: no parse`。这让我感到困惑，因为我的理解是没有解析错误通常意味着输入文件存在问题，显然没有。

```
run2D :: [String] -> IO()
run2D [file,r] = do
    thefile <- readFile file
    let [v,e,f] = lines thefile
    print(pullChi(eg2D (verticesMake (read v)) (read e) (read f) (read r)) (read r))

oneR :: [String] -> IO()
oneR [file] = do
    thefile <- readFile file
    let [v,e,f] = lines thefile
    print(oneRobot (read v) (read e) (read f)) 
```

这是我的输入文件的内容

```
7
[[0,1],[1,2],[0,2],[1,3],[2,3],[1,4],[2,4],[0,6],[1,6],[1,5],[5,6],[4,5]]
[[0,1,2],[1,2,3],[1,2,4],[0,1,6],[1,5,6],[1,4,5]] 
```

和我的 oneRobot 功能

```
oneRobot :: Integer -> [Integer] -> [Integer] -> Integer -- Takes #vertices, list of edges and robots and returns the euler characteristic where number of robots = 1
oneRobot v e f = v - genericLength(e) + genericLength(f) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:13:39.220

问题是：在您的文件中，您`[[Integer]]`在第二行和第三行有一个表示。

更改`oneRobot`函数签名和实现以反映这一点：

```
oneRobot :: Integer -> [[Integer]] -> [[Integer]] -> Integer 
```

`concat`或者如果它适合您的任务，则将您的整数列表列表展平：

```
print(oneRobot (read v) (concat $ read e) (concat $ read f)) 
```

# sql - 季度天数，SQL Server

> ID：13377484
> 
> 赞同：3
> 
> 时间：2012-11-14T10:57:17.317
> 
> 标签：sql, sql-server, days

如果给出了开始日期和结束日期，我想计算每季度的天数。

例如，一个表有两列，开始日期和结束日期。开始日期 = 9 月 1 日，结束日期为 11 月 14 日。

我想计算每个季度在这两天之间存在的天数

```
Q3 - 30 days
Q4 - 45 days (for this scenario) 
```

问候。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:22:48.543

```
declare @StartDate date='2012-09-01';
declare @EndDate date='2012-11-14';

select CEILING(month(dateadd(q,datediff(q,0,dateadd(dd,number ,@StartDate)),0))/3.0) as  QuarterNo,
        COUNT(*) as 'number of days'
 from   master..spt_values
 where  type='p'
 and    dateadd(dd,number ,@StartDate)<=@EndDate
 group by dateadd(q,datediff(q,0,dateadd(dd,number ,@StartDate)),0) 
```

# [SQL小提琴演示](http://www.sqlfiddle.com/#!3/d41d8/6162)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:15:51.323

您可以使用递归查询来获取此信息。这会生成开始日期和结束日期之间的日期列表，然后获取每季度的天数：

```
;with cte (start, enddate) as
(
  select startdate, enddate
  from yourtable
  union all
  select dateadd(dd, 1, start), enddate
  from cte
  where dateadd(dd, 1, start) <= enddate
)
select datepart(q, start) Quarter, count(datepart(q, start)) NoDays
from cte
group by datepart(q, start) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/e605b/6)

# mocha.js - 摩卡卡住了，控制台没有输出

> ID：13377487
> 
> 赞同：1
> 
> 时间：2012-11-14T10:57:23.560
> 
> 标签：mocha.js, yeoman

我在 yeoman 中使用 mocha 作为构建目标：`yeoman test`.

但我看到的唯一输出是

> 运行“mocha:all”（摩卡）任务
> 
> 测试 index.html

当我在浏览器中打开同样的 index.html 时，它就可以工作了。

我希望测试结果会显示在控制台中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:53:49.280

我的 phantomjs 是`1.4.1`，它不像你那样工作。在我将 phantomjs 更新为 之后`1.8`，它正在工作。

我使用 MacOS，更新命令是：

1.  须藤酿造更新
2.  sudo brew unlink phantomjs
3.  sudo brew install phantomjs

# php - Magento - 致命错误：类名必须是有效对象或字符串

> ID：13377491
> 
> 赞同：6
> 
> 时间：2012-11-14T10:57:44.623
> 
> 标签：php, magento, e-commerce

我在安装 Magento 时遇到问题，希望有人可以帮助我。

当我访问该站点时，我突然开始收到以下错误消息：

```
Fatal error: Class name must be a valid object or a string in /app/code/core/Mage/Core/Model/Resource.php on line 215 
```

this 所指的功能是：

```
/**
  * Get connection type instance
  *
  * Creates new if doesn't exist
  *
  * @param string $type
  * @return Mage_Core_Model_Resource_Type_Abstract
  */
public function getConnectionTypeInstance($type)
{
    if (!isset($this->_connectionTypes[$type])) {
        $config = Mage::getConfig()->getResourceTypeConfig($type);
        $typeClass = $config->getClassName();
        $this->_connectionTypes[$type] = new $typeClass();
    }
    return $this->_connectionTypes[$type];
} 
```

这是第 215 行：

```
$this->_connectionTypes[$type] = new $typeClass(); 
```

我一直在寻找有类似问题但没有任何运气的人，所以我被卡住了，真的需要解决这个问题

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T14:59:21.200

我在这里遇到了同样的问题。尝试添加

```
<type>pdo_mysql</type> 
```

在连接节点内的*local.xml文件中。*它应该是这样的：

```
 <default_setup>
            <connection>
                <host><![CDATA[localhost]]></host>
                <username><![CDATA[your_user]]></username>
                <password><![CDATA[your_pass]]></password>
                <dbname><![CDATA[your_db]]></dbname>
                <initStatements><![CDATA[SET NAMES utf8]]></initStatements>
                <model><![CDATA[mysql4]]></model>
                <type><![CDATA[pdo_mysql]]></type>
                <pdoType><![CDATA[]]></pdoType>
                <active>1</active>
            </connection>
        </default_setup> 
```

并且还尝试检查您的编辑器在自动格式化您的 xml 配置文件时是否添加了换行符或空格。有时*类型*节点（和其他节点）的值放在下面的行中，它会破坏解析。因此，请确保 xml 文件中的值周围没有空格或换行符。

# vbscript - 获取我的函数的类型不匹配

> ID：13377495
> 
> 赞同：1
> 
> 时间：2012-11-14T10:58:15.613
> 
> 标签：vbscript

我收到一条错误消息，即

```
Type mismatch: 'EMXWEB_IE_LAUNCH'
Line (1): "' ==============================================================================". 
```

该功能是 **选项显式**

```
Public Function EMXWEB_IE_LAUNCH (dicArguments, sErrMsg)

Dim strVersion
Dim strExeVersion
Dim WshShell
Dim strEMXWebBrowserTitleBarText
Dim ie

Const strFunctionName = "EMXWEB_IE_LAUNCH"

Set ie = CreateObject( "InternetExplorer.Application" )
ie.Navigate "www.google.com"
ie.Visible=True

End Function 
```

任何人都可以让我知道我错在哪里以及为什么我会遇到这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T07:52:32.430

我在带有“line(1)”的 QTP 中看到这样的错误，它有时与在您拥有该函数的库之前加载的库有关。缺少其他库中的块结尾或函数结尾。

也许你可以联系起来，但是当 QTP 保存文件的富文本格式被破坏时，我也看到了这个奇怪的东西。您可以尝试将整个代码粘贴到记事本中以获取纯文本，然后将整个 QTP 文件替换为记事本中的文本并保存。这种疯狂已经为我工作了好几次。

# jquery - jquery 的滚动事件在具有 IE 7 标准的 IE 7 中不起作用，但在 IE8、9 中起作用

> ID：13377496
> 
> 赞同：0
> 
> 时间：2012-11-14T10:58:16.543
> 
> 标签：jquery, html, internet-explorer

我在下面有一个示例，其中有一个条款 div，其中包含一些条款和条件作为内容。当用户将 div 滚动到底部时，复选框被启用。这仅在具有 IE 7/8/9 标准的 IE 7 中不起作用（我正在从开发人员窗口更改标准选项）。以下是我的 html、css 和 js：

```
<body>
    <div id="terms">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer lacinia dui vel velit bibendum cursus. Nunc eget lacus vitae nulla euismod elementum ornare ac urna. Nam enim est, bibendum eu ultricies eu, mollis vitae lacus. Duis porta vulputate feugiat. Nullam eu iaculis lacus. Aliquam adipiscing posuere consequat. Donec et dui non massa congue eleifend. Nunc tortor diam, luctus eget mollis sit amet, posuere nec lectus. Morbi sit amet ultricies nisi. Nam sodales quam non mi tristique sollicitudin. Vestibulum vel augue eget mi tincidunt commodo. Sed egestas metus nibh, et vestibulum augue.

     Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer lacinia dui vel velit bibendum cursus. Nunc eget lacus vitae nulla euismod elementum ornare ac urna. Nam enim est, bibendum eu ultricies eu, mollis vitae lacus. Duis porta vulputate feugiat. Nullam eu iaculis lacus. Aliquam adipiscing posuere consequat. Donec et dui non massa congue eleifend. Nunc tortor diam, luctus eget mollis sit amet, posuere nec lectus. Morbi sit amet ultricies nisi. Nam sodales quam non mi tristique sollicitudin. Vestibulum vel augue eget mi tincidunt commodo. Sed egestas metus nibh, et vestibulum augue.
</div>

<input type="checkbox" name="cb1" id="cb1" disabled="true" />

</body> 
```

CSS：

```
<style type="text/css">
        #terms {
    height: 100px;
    overflow: auto;
}

body{

    width:960px;
    margin: 0 auto;
}
    </style> 
```

JS：

```
<script src="jquery-1.8.1.js"></script>
    <script type="text/javascript">//<![CDATA[ 
$(window).load(function(){
$('#terms').scroll(function() {
    if ($(this)[0].scrollHeight - $(this).scrollTop() == $(this).outerHeight()) {
        $("#cb1").removeAttr("disabled");
    }
    else {
        $("#cb1").attr("disabled", "true");
    }
});
});//]]>  

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:06:16.967

问题在于赋予 div 的额外填充，该填充设置为滚动溢出。由于为其定义了填充，因此在 IE 中不满足上面脚本标记中定义的条件。

# java - 反射 getDeclaredMethods() 和不在类路径中的类

> ID：13377497
> 
> 赞同：3
> 
> 时间：2012-11-14T10:58:19.753
> 
> 标签：java, reflection

我正在使用反射从特定类中获取所有方法。

这个类引用了不在我的类路径中的类，所以我得到一个异常：

> java.lang.NoClassDefFoundError：

对此：

```
Method methods[] = theClass.getDeclaredMethods(); 
```

是否有可能以某种方式“跳过”不在类路径中的所有内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:30:20.297

Class.forName() 不会加载一个类，无论它是否在类路径中。它只会返回一个已经加载的类的句柄。

类以两种主要方式之一加载：

1.)类在import语句中被引用（java.lang.*是自动导入的，所以java.lang包中的每个类都是从一开始就被类加载的）

2.) 使用来自 ClassLoader 的调用加载一个类，在这种情况下，它的所有依赖项都已解决。并加载

因此，如果您尝试在类路径之外加载一个类，或者在类路径之外加载依赖项，则需要将 ClassLoader 子类化并告诉它如何加载您的类及其依赖项。

请参阅此处的 ClassLoader 规范：http: [//docs.oracle.com/javase/1.4.2/docs/api/java/lang/ClassLoader.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ClassLoader.html)

此外，还有现成的 ClassLoader 子类可以执行您想要的操作，例如 URL ClassLoader，它可以让您简单地将 ClassLoader 实例指向路径，并加载该路径中的任何类。

# c# - 反序列化错误 - 未设置对象引用

> ID：13377500
> 
> 赞同：2
> 
> 时间：2012-11-14T10:58:33.173
> 
> 标签：c#, deserialization

我正在尝试反序列化 c#3.5 中的 xml 字符串，下面的代码在 c# 4.0 中确实有效。当我尝试在 c#3.5 中的代码中运行`Object reference not set to an instance of an object`时，当代码尝试初始化 XmlSerializer 时出现异常。

任何帮助，将不胜感激。

```
string xml = "<boolean xmlns=\"http://schemas.microsoft.com/2003/10/serialization/\">false</boolean>";
var xSerializer = new XmlSerializer(typeof(bool), null, null,
             new XmlRootAttribute("boolean"),
             "http://schemas.microsoft.com/2003/10/serialization/");

             using (var sr = new StringReader(xml))
            using (var xr = XmlReader.Create(sr))
            {
                var y = xSerializer.Deserialize(xr);
            }

System.NullReferenceException was unhandled
  Message="Object reference not set to an instance of an object."
  Source="System.Xml"
  StackTrace:
       at System.Xml.Serialization.XmlSerializer..ctor(Type type, XmlAttributeOverrides overrides, Type[] extraTypes, XmlRootAttribute root, String defaultNamespace, String location, Evidence evidence)
       at System.Xml.Serialization.XmlSerializer..ctor(Type type, XmlAttributeOverrides overrides, Type[] extraTypes, XmlRootAttribute root, String defaultNamespace)
       ....
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:03:40.290

看起来在 .NET 3.5 中它不喜欢`Type[] extraTypes`为空。只需传递一个空`Type[]`值，例如`new Type[0]`，或者只是简单地传递：

```
var xSerializer = new XmlSerializer(typeof(bool), null, Type.EmptyTypes, 
                 new XmlRootAttribute("boolean"),
                 "http://schemas.microsoft.com/2003/10/serialization/"); 
```

附带说明：当`XmlSerializer`使用非平凡的构造函数（比如这个）创建实例时，缓存和重用序列化程序**非常重要**- 否则它将为每个序列化程序生成一个内存中的程序集，这是一个：坏为了性能，但是 b: 导致严重的内存泄漏（无法卸载程序集）。

# iphone - 在其中心旋转 UILabel

> ID：13377504
> 
> 赞同：1
> 
> 时间：2012-11-14T10:58:46.820
> 
> 标签：iphone, ios, uilabel

我试图`UILabel`在它的中心旋转 a ，但是当它旋转时它会改变它的位置。它不会粘在它的中心。我正在使用以下代码来旋转它：

```
float fromAngle = atan2(m_locationBegan.y-lblText.center.y, m_locationBegan.x-lblText.center.x);
//float toAngle = atan2(_location.y-lblText.center.y, _location.x-lblText.center.x);
float toAngle = atan2(_location.y-lblText.center.y+5, _location.x-lblText.center.x+5);
float newAngle = wrapd(m_currentAngle + (toAngle - fromAngle), 0, 2*3.14);

CGAffineTransform cgaRotate = CGAffineTransformMakeRotation(newAngle);
lblText.transform = cgaRotate;

int oneInFifty = (newAngle*50)/(2*3.14);

NSLog(@"%@",[NSString stringWithFormat:@"fromAngle: %f toAngle: %f Angle: %f 1in50: %i",fromAngle, toAngle, newAngle, oneInFifty]); 
```

有人可以帮我阻止中心从那里移动吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:43:57.507

看看这篇[博文](http://www.informit.com/blogs/blog.aspx?uk=Ask-Big-Nerd-Ranch-Rotating-an-iPhone-View-Around-a-Point)。

示例： ( `label`= `UILabel`)

```
// UIView's transform property is a CGAffineTransform.
[UIView beginAnimations:nil context:NULL]; // arguments are optional
view.transform = CGAffineTransformMakeRotation(M_PI_2);
[UIView commitAnimations];

// CALayer's transform property is a CATransform3D.
// rotate around a vector (x, y, z) = (0, 0, 1) where positive Z points
// out of the device's screen.

label.layer.transform = CATransform3DMakeRotation(M_PI_2, 0, 0, 1); 
```

# database - Visual Basic .NET Access 数据库记录添加

> ID：13377507
> 
> 赞同：0
> 
> 时间：2012-11-14T10:58:54.387
> 
> 标签：database, vb.net, ms-access

我对数据库保存更改有疑问：

```
 coon1.ConnectionString = _
    "Provider=Microsoft.Jet.OLEDB.4.0;Data source=" & _
    "magazyn.mdb"
     sql = "INSERT INTO magazyn   (ID_Towaru,Kod_Towaru,Nazwa_Towaru,Ilość_w_magazynie,ilość_minimalna,ALERT) VALUES ('" & jakiid & "','" & kodtowaru & "','" & nazwatowaru & "','" & iloscwmagazynie & "','" & iloscminimalna & "',0)"

    Dim MyConnection As New OleDbConnection(conn)
    Dim command1 As New OleDbCommand(sql, MyConnection)

    command1.Connection.Open()
    command1.ExecuteNonQuery()
    MyConnection.Close() 
```

我尝试将新记录添加到表中`magazyn`，但是当使用 Access 打开数据库时，我没有看到与`magazyn`表中相关的任何新记录。但是`ViewGrid`在我关闭并重新打开程序之前，我会向我展示这个新元素。

有人知道问题出在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:58:23.193

始终使用参数而不是字符串连接。应绝对遵守此规则

```
sql = "INSERT INTO magazyn  " + 
       "(Kod_Towaru,Nazwa_Towaru,Ilość_w_magazynie,ilość_minimalna,ALERT) " + 
       "VALUES (?, ?, ?, ?,0)"
Using MyConnection As New OleDbConnection(conn)
Using command1 As New OleDbCommand(sql, MyConnection)
    command1.Connection.Open()
    command1.Parameters.AddWithValue("@Kod", kodtowaru)
    command1.Parameters.AddWithValue("@naz", nazwatowaru)
    command1.Parameters.AddWithValue("@ilo", iloscwmagazynie)
    command1.Parameters.AddWithValue("@mini", iloscminimalna)
    command1.ExecuteNonQuery()
End Using
End Using 
```

当然，这要求用作参数值的变量具有正确的数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T07:50:07.627

请在模块中的代码下方插入此代码。

导入 System.Data.OleDb 模块 Module1

```
Public OleCn As New OleDbConnection()

Public Function StrConnection() As String

    StrConnection = "Provider=Microsoft.Ace.Oledb.12.0; Data Source=" & My.Application.Info.DirectoryPath.ToString() & "\BackUp\Testing.Accdb;"

    Return StrConnection
End Function 
```

在此之后在保存按钮中插入下面的编码。

Dim msg As DialogResult = MessageBox.Show("你想保存这条记录吗？", "Response", MessageBoxButtons.YesNo, MessageBoxIcon.Question)

```
 If (msg = vbYes) Then

        If RequiredEntry() = True Then
            Return
        End If

        Try
            With OleCn
                If .State <> ConnectionState.Open Then
                    .ConnectionString = StrConnection()
                    .Open()
                End If
            End With
        Catch ex As Exception
            MessageBox.Show(ex.Message, "Connection Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
        End Try

        Try

            Dim sSQL As String = "insert into Vendor values(@VendorCode,@VendorName,@Address,@City,@LandPhone,@Mobile,@EmailID,@Balance)"

            Dim cmd As OleDbCommand = New OleDbCommand(sSQL, OleCn)

            'VendorCode
            Dim VendorCode As OleDbParameter = New OleDbParameter("@VendorCode", OleDbType.VarChar, 10)
            VendorCode.Value = txtVendorCode.Text.ToString()
            cmd.Parameters.Add(VendorCode)

            'VendorName
            Dim VendorName As OleDbParameter = New OleDbParameter("@VendorName", OleDbType.VarChar, 25)
            VendorName.Value = txtVendorName.Text.ToString()
            cmd.Parameters.Add(VendorName)

            'Address
            Dim Address As OleDbParameter = New OleDbParameter("@Address", OleDbType.VarChar, 50)
            Address.Value = txtAddress.Text.ToString()
            cmd.Parameters.Add(Address)

            'City
            Dim City As OleDbParameter = New OleDbParameter("@City", OleDbType.VarChar, 25)
            City.Value = txtCity.Text.ToString()
            cmd.Parameters.Add(City)

            'LandPhone
            Dim LandPhone As OleDbParameter = New OleDbParameter("@LandPhone", OleDbType.VarChar, 50)
            LandPhone.Value = txtLandPhone.Text.ToString()
            cmd.Parameters.Add(LandPhone)

            'Mobile
            Dim Mobile As OleDbParameter = New OleDbParameter("@Mobile", OleDbType.VarChar, 15)
            Mobile.Value = txtMobile.Text.ToString()
            cmd.Parameters.Add(Mobile)

            'EmailID
            Dim EmailID As OleDbParameter = New OleDbParameter("@EmailID", OleDbType.VarWChar, 25)
            EmailID.Value = txtEmailID.Text.ToString()
            cmd.Parameters.Add(EmailID)

            'Balance
            Dim Balance As OleDbParameter = New OleDbParameter("@Balance", OleDbType.VarWChar, 10)
            Balance.Value = txtBalance.Text.ToString()
            cmd.Parameters.Add(Balance)

            If cmd.ExecuteNonQuery() Then

                OleCn.Close()
                MessageBox.Show("New Record is Added Successfully.", "Record Saved")
                Call clear()

            Else

                MsgBox("Record Addition Failed ", MsgBoxStyle.Critical, "Addition Failed")

                Return
            End If

        Catch ex As Exception
            MessageBox.Show(ex.Message.ToString(), "Data Error")
            Exit Sub
        End Try
    End If 
```

# node.js - 强大在 node.js 中不起作用

> ID：13377510
> 
> 赞同：1
> 
> 时间：2012-11-14T10:59:13.013
> 
> 标签：node.js, file-upload, multipartform-data, formidable

我正在使用强大的包来解析 node.js 中的表单以上传文件。当我尝试触发 form.parse() 方法时，它无法正常工作。

这是我的服务器端代码。

```
var formidable = require('formidable'),
http = require('http'),
util = require('util');
console.log("Before parsing");
var form = new formidable.IncomingForm();
form.parse(req, function(err, fields, files) {
console.log(util.inspect({fields: fields, files: files}));
});
return; 
```

请给一些建议。

# android - 如何限制android中跨应用程序的sql lite数据访问？

> ID：13377512
> 
> 赞同：0
> 
> 时间：2012-11-14T10:59:18.677
> 
> 标签：android, sqlite, database-security, data-security

如何限制应用程序只能访问我允许的 SQL lite（android 数据库）中的数据？例如 - 我希望我从联系人列表中选择的联系人不应被手机上运行的任何应用程序访问？我正在制作一个应用程序，它在运行时会隐藏选定的联系人，即使是 Android 提供的默认联系人查看器应用程序也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:16:17.773

所有应用程序（有权访问它们）都可以访问系统联系人数据库中的所有联系人。

如果您想隐藏联系人，您必须将它们存储在您自己的私有数据库中。

# arrays - 数组占位符

> ID：13377515
> 
> 赞同：0
> 
> 时间：2012-11-14T10:59:29.673
> 
> 标签：arrays, placeholder

我有一个数组，其中 PLACEHOLDER 是我稍后在代码中得到的变量 $value 的占位符：

```
$names = array(
    "<a href='http://skyler.com' title='PLACEHOLDER'>Skyler</a>",
    "<a href='http://jesse.com' title='PLACEHOLDER'>Jesse</a>",
    "<a href='http://walter.com' title='PLACEHOLDER'>Walter</a>",
    "<a href='http://skyler.com' title='PLACEHOLDER'>Skyler</a>",
    "<a href='http://hank.com' title='PLACEHOLDER'>Hank</a>",
    "<a href='http://marie.com' title='PLACEHOLDER'>Marie</a>",
    "<a href='http://walter.com' title='PLACEHOLDER'>Walter</a>",
    "<a href='http://walter.com' title='PLACEHOLDER'>Walter</a>",
    "<a href='http://jesse.com' title='PLACEHOLDER'>Jesse</a>",
    ); 
```

为了检查数组中相等值的频率，我用`array_count_values`.

```
$count = array_count_values($names);

foreach ($count as $key => $value) {
    echo $value . ' – ' . $key . '<br />';
} 
```

所以我得到这样的东西：

```
3 – <a href='http:/walter.com' title='PLACEHOLDER'>Walter</a>
2 – <a href='http://jesse.com' title='PLACEHOLDER'>Jesse</a>
2 – <a href='http://skyler.com' title='PLACEHOLDER'>Skyler</a>
1 – <a href='http://hank.com' title='PLACEHOLDER'>Hank</a>  
1 – <a href='http://marie.com' title='PLACEHOLDER'>Marie</a> 
```

现在我将 PLACEHOLDER 替换为 $value，因此我将数字作为链接的标题标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:04:21.520

你在问什么，我不明白，你想用 $value 替换 PLACEHOLD 然后这样做

```
$names = array(
"<a href='http://skyler.com' title='".$PLACEHOLDER."'>Skyler</a>",
"<a href='http://jesse.com' title='".$PLACEHOLDER."'>Jesse</a>"
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:07:07.723

用于`str_replace`将 PLACEHOLDER 替换为`$value`

```
foreach ($count as $key => $value) {
    $key = str_replace('PLACEHOLDER', $value, $key); //<--replace PLACEHOLDER here
    echo $value . ' – ' . $key . '<br />';
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:10:19.080

```
foreach ($count as $key => $value) {
    echo $value . ' – ' . str_replace('PLACEHOLDER', $value, $key) . '<br />';
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T11:11:31.957

正确的代码是：

```
foreach ($count as $key => $value) {
    echo str_replace('PLACEHOLDER', $value, $key); //this will replace placeholder with number of tags
    echo '<br />';
} 
```

# php - 按百分比排序的查询 - 两个表中的值

> ID：13377516
> 
> 赞同：0
> 
> 时间：2012-11-14T10:59:29.247
> 
> 标签：php, mysql

我有两个具有以下结构的表：

**表 1**：显示玩家尝试的次数。

```
Player_id, n_tries, date 
```

**表 2**：显示球员击球次数。

```
Player_id, n_hits, date 
```

最后，我希望获得玩家今天的命中百分比（尝试次数与命中次数）以及今天和一周前之间点击次数的增加/减少。我希望结果按（今天）命中后代的百分比排序。因此，例如，如果我们有一个 id = 1 的玩家和一个 id = 2 的玩家，使用以下数据：

表格1：

```
1, 10, "2012-10-14"
2, 13, "2012-10-14"
1, 20, "2012-10-7"
2, 15, "2012-10-7" 
```

表 2：

```
1, 5, "2012-11-14"
2, 10, "2012-11-14"
1, 0, "2012-11-7"
2, 3, "2012-11-7" 
```

我最终需要证明这一点：

Player_id，命中率（今天），命中率差异（今天与一周前）

```
2            77%       +233%
1            50%       +100% (actually is infinite -> (5 - 0)/0 ) 
```

我有从两个表中获取值的查询：

第一个表 - 尝试次数：

```
SELECT player_id, date, sum(n_tries) 
FROM player_tries 
WHERE (d_date = CURDATE() OR d_date = DATE_SUB(CURDATE(), INTERVAL 7 DAY))
GROUP BY date, player_id
ORDER BY player_id, date 
```

我做了一个 sum(n_tries) 因为玩家可以在特定的一天进行多行尝试。

第二个表 - 命中数：

```
SELECT player_id, date, sum(n_hits) 
FROM player_hits
WHERE (d_date = CURDATE() OR d_date = DATE_SUB(CURDATE(), INTERVAL 7 DAY))
GROUP BY date, player_id
ORDER BY player_id, date 
```

所以，我的问题是：如果从第一个查询中我得到一个如下所示的结果列表：

```
Player_id, date,         n_tries
1         2012-11-07        20
1         2012-11-14        10
2         2012-11-07        15
2         2012-11-14        13 
```

从第二张桌子我得到这个：

```
 Player_id, date,         n_hits
    1         2012-11-07        0
    1         2012-11-14        5
    2         2012-11-07        3
    2         2012-11-14        10 
```

能够混合这些结果并能够拥有某种按命中率（今天）排序的结构的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:24:13.627

Select hits from today and a week ago:

```
select h1.player_id, `h1.date`,
       sum(h1.hits) as hits_today,
       sum(h2.hits) as hits_last_week
from player_hits h1
left join player_hits h2 on h2.player_id = h1.player_id
                            and `h2.date` = date_sub(`h1.date`, interval 7 days)
group by h1.player_id, `h1.date`; 
```

If you only want rows when there is a corresponding entry a week before, then replace the left join with an inner join.

The select for the tries table looks equivalent.

First select your results into arrays with `player_id` as keys.

```
$hits_array = array();
$result = mysqli_query(...);
while ($row = mysqli_fetch_assoc($result)) {
    $player = $row['player_id'];
    $hits_array[$player] = $row['hits'];
} 
```

You do the same with the tries table.

Now you can join the two arrays on the player_id keys:

```
foreach ($hits_array as $player => $hits) {
    echo "$player " . ($hits / $tries[$key]) . "\n";
} 
```

# ajax - 使用 Ajax 时需要使用 XMLHTTPRequest 吗？

> ID：13377518
> 
> 赞同：0
> 
> 时间：2012-11-14T10:59:34.543
> 
> 标签：ajax, xmlhttprequest

我是 Ajax 的新手。我发现 Ajax 将使用 XMLHTTPRequest。任何人都可以用一个例子来澄清我在没有 Ajax 和使用 Ajax 的情况下使用 XMLHttpRequest 吗？

异步回发将如何发生？

谢谢，拉克什。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:08:55.003

XMLHTTPRequest 是使我们所说的 AJAX 成为可能的底层浏览器功能，你不能没有另一个。Postback 听起来像是对 .Net 的引用，它是一种完全独立于 AJAX/XMLHTTPRequest 的技术。

[在这里了解更多](http://en.wikipedia.org/wiki/Ajax_%28programming%29)

# python - 如何在 Blender 2.64 中导入 wxPython 模块？

> ID：13377520
> 
> 赞同：1
> 
> 时间：2012-11-14T10:59:43.427
> 
> 标签：python, wxpython, blender

我正在尝试在我的 Blender 游戏引擎中导入 wxPython，但出现错误：

python代码（在搅拌机中）：

```
import bge
import wx

app = wx.App()

frame = wx.Frame(None, -1, 'frame in blender')
frame.Show()

app.MainLoop() 
```

错误 ：-

```
 Traceback (most recent call last):
  File "Text", line 2, in <module>
  ImportError: No module named wx 
```

我用谷歌搜索了这个错误，但没有发现任何有用的东西..

另外，我将 wx 目录从 python 的 lib 安装目录复制到了搅拌机的 lib 目录。之后，我收到错误：-

```
Traceback (most recent call last):
File "Text", line 2, in <module>
File "C:\Program Files\Blender Foundation\Blender\2.64\python\lib\wx\__init__.py", line 
14, in <module>
import __version__
ImportError: No module named __version__ 
```

请帮我！！

系统详情：-

```
os: windows 7
blender version : 2.64a
wxPython version : 2.8 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:36:05.017

这是因为 Blender 提供了 Python 解释器的内置版本。

您可能可以通过[另一种导入模块的方式来](http://www.google.com/#q=python+import+module+another+directory)解决这个问题。

我还应该提醒一下，Blender 游戏引擎在很大程度上是非常古老的，许多 OpenGL 调用真的非常非常古老并且被弃用（它基于固定的管道行为），我不会考虑任何“严肃”的游戏引擎任何类型的应用程序。Blender 本身是一个很好的应用程序，它不是游戏引擎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T17:40:10.263

如前所述，这可能是不可能的/不容易的。查看[此对话框以了解与 Tkinter 的类似问题，](http://blenderartists.org/forum/showthread.php?231023-Tkinter-in-Blender)您可能会在您的任务中找到一些帮助，或者找到无法完成的原因。但是请注意，如果您只想要一个带有搅拌机游戏引擎的 gui，那么[bgui 似乎是一个替代方案。](http://code.google.com/p/bgui/wiki/Gallery)

# maven - 存储没有版本号的 Nexus/Maven 工件

> ID：13377525
> 
> 赞同：3
> 
> 时间：2012-11-14T11:00:25.070
> 
> 标签：maven, nexus

我需要在 Maven/Nexus 中存储一个工件，但是当它被拉下时，它最后不能有版本号。

在你责备我之前，把你的怒容指向甲骨文。

我有`comm.jar`（Oracle 通信端口驱动程序）。我已经把它放在我的 nexus 服务器中，它降为`comm-1.0.jar`. 但是 JAR 包含以下代码：

```
if(streamtokenizer.ttype == -3 
    && (i = streamtokenizer.sval.indexOf("comm.jar")) != -1) 
```

使用它自己的名字来知道在哪里可以找到它的配置文件是硬编码的。jar 已签名，因此我无法对其进行更改。

那么......我如何在 Nexus 中存储一个罐子并且上面没有分机号？

* * *

这不是我问题的确切答案，但它确实解决了我的问题。

我将我的 jar 称为“comm.jar-1.0.2.jar” 代码在文件名中查找“comm.jar”，所以现在它找到了！好的，所以这是一个软糖，我很幸运内部代码只是在寻找 indexOf。但它有效！

感谢大家对此的建议！

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:59:43.900

这不是一个完整的答案，更多的是关于如何处理这个问题的想法。

我认为您需要使用存在的版本号声明您的依赖关系，以确保 Maven 乐于解决工件并构建它。因此，诀窍是确保在将它捆绑到您的成品中之前对其进行重命名。

Maven[`dependency:copy-dependencies`](https://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html)目标有一个[`stripVersion`](https://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html#stripVersion)可能有用的参数。我怀疑您可以使用它来正确重命名 JAR，也许作为程序集的一部分（确保将依赖关系移动到属于类路径的目录）。

但是，这样的计划很可能会破坏您的开发环境。也许您可以通过使用正确名称伪造 JAR 文件来解决这个问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T14:05:53.127

如果您希望它与战争项目一起使用，那么您可以使用[文件名映射](http://maven.apache.org/plugins/maven-war-plugin/examples/file-name-mapping.html)来剥离版本。

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.3</version>
            <configuration>
                <outputFileNameMapping>@{artifactId}@.@{extension}@</outputFileNameMapping>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

依赖的 jar 将正常结束，`WEB-INF/lib`但现在没有版本。

但是从你的问题很难说出你的最终产品是什么，war，jar，zip，......

# javascript - Javascript：DIV 内容到 URL 字符串，结果 = [对象节点列表] 和“未定义”

> ID：13377526
> 
> 赞同：1
> 
> 时间：2012-11-14T11:00:25.600
> 
> 标签：javascript, wordpress, undefined, innerhtml, nodelist

这是一个非常具体的问题，如果听起来重复，请见谅。

我有一段代码可以操作 Wordpress 的“按此”功能，该功能允许快速撰写有关远程站点的博客，包括复制文本选择。

我想要操纵它，是从 wordpress 引擎网站重新记录（带信用）整个博客文章。Wordpress.com 在他们的站点中内置了此功能，但如果您有自己的托管站点，则此功能不存在。

我已经设法选择了正确的 DIV，并让弹出窗口正常工作，但是内容不存在。

结果来自：

```
 y = d.getElementsByClassName('entry'), 
```

是 y = [对象节点列表]

```
z = y.innerHTML, 
```

结果是“未定义”

```
for (var i = 0; i < y.length; ++i) {
z = z + y[i];} 
```

结果是 '[object HTMLDivElement][object HTMLDivElement]' （结果与从 y.innerHTML 中提取的结果相同）

我已经广泛搜索以寻求帮助，但无法为代码引入解决方案。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:50:58.900

Not sure why you put a ',' at the end where a ';' should be

```
 y = d.getElementsByClassName('entry'), 
```

Your problem is that getElement **s** ByClassName('entry') returns an array of **all** elements which share the class name 'entry';

If you want to access the first you should use

```
y = d.getElementsByClassName('entry')[0]; 
```

Or you can use **for** to go through all:

```
for(var i in d.getElementsByClassName('entry')) {
  y = d.getElementsByClassName('entry')[i];
  alert(y.innerHTML);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:02:36.680

你几乎明白了，试试这个：

```
var z = '';
for (var i = 0; i < y.length; ++i) {
   z = z + y[i].innerHTML;
}
alert(z); //will alert the html content of all your .entry elements 
```

# iphone - 如果它不适合 webView (iphone)，则从 html 字符串中裁剪最后一句

> ID：13377527
> 
> 赞同：0
> 
> 时间：2012-11-14T11:00:31.350
> 
> 标签：iphone, html, webview, crop

我有一系列文本，其中包含粗体部分。这个粗体字或句子在哪里没有规则，所以我在必要时使用 webView 显示带有粗体标签的 html 字符串。现在我的 webViews 不会在任何地方滚动，有时文本不适合它们。

**所以这是我的问题：**

我想裁剪文本，使其适合我的 webView 并且裁剪不会在句子中间，而是如果不适合则裁剪整个句子。所以最后，文本应该以适合的最后一句话结尾。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T01:35:34.733

我所做的是从 html 句子中去除 html 标签，计算文本占用的高度，然后删除文本的最后一部分，用“。”分隔。（点）如果它超过了要求的高度。

这是执行此操作的代码。

NSString *returnedString = [[[NSString alloc] initWithString:htmlText] autorelease];

```
CGSize a = [[returnedString stripHtml] sizeWithFont:font constrainedToSize:CGSizeMake(sizeToFit.width, 999)];

NSMutableArray *sentences = [[NSMutableArray alloc] initWithArray:[returnedString componentsSeparatedByString:@"."]];

while (a.height > sizeToFit.height) {

    _lastTextExceededLimits = NO;

    if (sentences.count > 1) {
        // -2 because last sentence is not deletable and contains html tags
        NSString *sentence2 = [sentences objectAtIndex:(sentences.count - 2)];

        NSString *stringToReplace = [NSString stringWithFormat:@"%@%@",sentence2, @"."];
        returnedString = [returnedString stringByReplacingOccurrencesOfString:stringToReplace  withString:@""];

        [sentences removeLastObject];
    } else
        returnedString = [returnedString stringByReplacingOccurrencesOfString:[sentences lastObject] withString:@""];

    a = [[returnedString stripHtml] sizeWithFont:font constrainedToSize:CGSizeMake(sizeToFit.width, CGFLOAT_MAX)];

}
[sentences release];

return returnedString; 
```

# wpf - WCF 客户端托管在具有 WPF UI 的 Windows 服务中

> ID：13377528
> 
> 赞同：0
> 
> 时间：2012-11-14T11:00:32.077
> 
> 标签：wpf, wcf

我现在有一个 WCF 服务托管在 WPF 应用程序中。它在 WCF 服务器-客户端场景中运行，客户端也可以调用服务器（双工通信）。

我想在 Windows 服务中托管 WCF 客户端，但我想保留 WPF UI，因为它在调用回服务器时提供了功能（例如请求信息）。我知道 Windows 服务没有 UI，但在这种情况下我需要它。

在 WPF 应用程序和 Windows 服务之间进行通信的最佳方式是什么？（可能比套接字更好的东西？）

这很有用的场景如下：

*   从 WPF 应用程序中，我可以选择充当服务器的 WCF 服务需要什么样的信息，

*   此“命令”将发送到托管 WCF 客户端实例的 Windows 服务，并使用该实例调用服务器和

*   通过 Windows 服务托管的 WCF 客户端服务在 WPF 应用程序中显示信息。

谢谢，阿德里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:12:26.060

既然服务已经作为 WCF 运行，那么如何在 WCF 接口上公开一些额外的“管理”方法并让 WPF 应用程序通过这些方法与服务交互呢？

您必须添加一个安全层以确保只有合法用户才能调用这些新方法，但由于 WCF 基础结构已经到位，因此该解决方案可能是工作最少的。

# python - 如何在 Google App Engine for Python 上设置 ETAGS？

> ID：13377529
> 
> 赞同：2
> 
> 时间：2012-11-14T11:00:34.133
> 
> 标签：python, json, google-app-engine, http-headers

我正在从 Google App Engine 服务器提供一些 JSON 内容。我需要为内容提供一个 ETAG，以了解自我上次加载数据以来它是否发生了变化。然后我的应用程序将删除它的旧数据并使用新的 JSON 数据来填充它的视图。

```
 self.response.headers['Content-Type'] = "application/json; charset=utf-8"
    self.response.out.write(json.dumps(to_dict(objects,"content"))) 
```

为响应设置 ETAG 的最佳做法是什么？我必须自己计算 ETAG 吗？或者它是一种让 HTTP 协议执行此操作的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:19:10.220

您必须自己计算电子标签值。电子标签是不透明的字符串，只对应用程序有意义。

最佳实践是连接所有决定 JSON 内容的输入变量（转换为字符串）；如果发生更改，将导致 JSON 输出发生更改的任何内容都应该是其中的一部分。如果这些字符串中有任何您不想暴露的敏感信息，请改用这些值的 MD5 哈希值。

例如，在我管理的一个 CMS 应用程序中，首页具有以下电子标签：

```
|531337735|en-us;en;q=0.5|0|Eli Visual Theme|1|943ed3c25e6d44497deb3fe274f98a96|| 
```

我们关心的输入变量已经与`|`符号连接成一个不透明的值，但它确实代表了几个不同的输入值，例如最后修改的时间戳（数字）、浏览器接受的语言标题、当前的视觉主题、以及从浏览器 cookie 中检索到的内部 UID（并确定首页上的内容取自哪个上下文）。如果这些变量中的任何一个发生变化，则页面可能会有所不同，并且缓存的副本将过时。

请注意，如果没有快速验证的方法，电子标签将毫无用处。客户端会将它包含在`If-None-Match`请求标头中，服务器应该能够快速从当前变量重新计算电子标签标头并查看标签是否仍然是最新的。如果重新计算所花费的时间与重新生成内容主体的时间相同，那么发送`304 Not Modified`响应而不是响应中的完整 JSON 主体只会节省一点带宽`200 OK`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T12:41:14.440

如果您使用的是 webapp2，它可以根据响应正文自动添加一个 md5 ETag。

```
self.response.md5_etag() 
```

[http://webapp-improved.appspot.com/guide/response.html](http://webapp-improved.appspot.com/guide/response.html)

# php - 如何使用 tcpdf 类 php 将 pdf417 对象输出为条形码图像？

> ID：13377534
> 
> 赞同：1
> 
> 时间：2012-11-14T11:00:56.257
> 
> 标签：php, tcpdf

我能够使用 tcpdf 中的 pdf417 类创建一个 pdf417 对象。但我不确定使用 tcpdf 类 php 为上述对象获取基于图像的输出的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T06:29:32.830

我在错误的方向上使用了来自 tcpdf 中 example50.php 的代码来解决这个问题并解决了它。

# android - Android：点击 5 次或更多后启动 Activity

> ID：13377547
> 
> 赞同：1
> 
> 时间：2012-11-14T11:01:48.423
> 
> 标签：android, android-intent, onclicklistener

我有一个`onClick`使用意图启动活动的侦听器，但是如何使侦听器仅在用户单击五次或更多次时才触发活动意图？

```
public boolean onClick(View v) {

    Intent myIntent = new Intent(activity, loginActivity.class);
    activity.startActivity(myIntent);

    return false;   
} 
```

这里我要登录Activity。登录成功后如何返回之前的活动？

```
public void onClick(View v) {

    String username = Username.getText().toString();
    String password = Password.getText().toString();

    if(username.equals("guest") && password.equals("guest")) {
        lResult.setText("Login successful.");
    } else {
        lResult.setText("Login failed");
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-14T11:06:12.517

在程序中有一个静态变量，每次点击都会增加。

当您单击计数达到 5 时，触发代码启动 LoginActivity。

```
static int i = 0;

@override
public void onClick(View view) {
    i++;
    if (i == 5) {
        i = 0;
        Intent myIntent = new Intent(activity, loginActivity.class);
        activity.startActivity(myIntent);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:07:13.167

为您的活动添加一个静态计数器。

```
static int clickCount; 
```

在您的 onClick 中：

```
if(clickCount++<5){return;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:05:20.427

您可以尝试建立一个计数器来计算点击次数，然后从第 5 次点击开始让他继续前进

要返回上一个活动，只需调用

```
finish(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:10:31.507

对于第一个问题，只是类上的一个计数器变量，并在 onClick() 上递增，并在开始意图之前检查它的 >= 5。

```
 int clickCounter;

    public boolean onClick(View v) {

            clickCounter++;

            if (clickCounter >= 5) {

                    Intent myIntent = new Intent(activity, loginActivity.class);
                    activity.startActivity(myIntent);
            }

            return false;   
    } 
```

对于第二个问题，您必须考虑之前的 Activity 是否必须保持完全相同的方面或更新用户数据。查看 Activity.startActivityForResult (Intent intent, int requestCode) 以调用活动并从中获取结果值。-

# c - 字符串数组中的c指针

> ID：13377548
> 
> 赞同：0
> 
> 时间：2012-11-14T11:01:53.787
> 
> 标签：c, string, pointers

我正在尝试使用指针算法将一个 char 数组复制到另一个 char 数组中。在 copy() 中似乎是正确的，但是我不明白它进入 main 后会发生什么。char a[] 即使我调用了该函数，也没有得到 char b[] 的值。我错过了什么吗？呵呵呵呵

```
 #include <stdio.h>

    void copy(char a[], char b[]){
        int *apoint = &a;
        printf("%d\n", apoint);
        printf("%d\n", &a);
        *apoint = b;
        printf("%d\n", *apoint);
        printf("%s\n", a);
        printf("%s\n", b);
    }

   int main(void){
        char a[100];
        char b[] = "bluhbluh";

        copy(a,b);
        printf("%d\n", a);
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:19:52.803

这真的不是很有意义的C。我怀疑它甚至没有在没有警告的情况下编译？

首先获取 array 的地址`a`，然后获取 array 的地址`b`，将其转换为整数（没有强制转换！），然后将该整数写入 array `a`。然后，在 main 结束时，您尝试将 char 数组打印为整数。

指针算术不太像那样工作。:)

我认为你真的打算做这样的事情：

```
void copy(char a[], char b[]){
    char *ptr_a = a;
    char *ptr_b = b;

    while (*ptr_b != '\0') {
        *ptr_a = *ptr_b;
        ptr_a++;
        ptr_b++;
    }
    *ptr_a = '\0';
}

int main(void){
    char a[100];
    char b[] = "bluhbluh";

    copy(a,b);
    printf("%s\n", a);
} 
```

当然，正确的做法是这样的：

```
#include <string.h>

int main(void){
    char a[100];
    char b[] = "bluhbluh";

    strncpy(a, b, 100);
    printf("%s\n", a);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:25:27.507

As ams points out in his/her answer, if you want a *copy* of the array, you need to duplicate each entry. Assuming you don't want to duplicate the array, but instead want `a` to point at `b`:

`apoint` doesn't do anything - it can't change the pointers of `a` or `b`. If you wanted to modify the address that `a` or `b` pointed to, you'd have to pass the address of them to your function. This won't work, however, as [arrays are not pointers](http://www.lysator.liu.se/c/c-faq/c-2.html) - it's why you can't reassign arrays in C. You can modify pointers though - the following is an example of modifying a pointer to `a` to point at `b`:

```
#include <stdio.h>

void redirect(char** a, char* b){
    *a = b;
}

int main(void){
    char a[100];
    char b[] = "bluhbluh";

    char* apt = a;
    redirect(&apt,b);
    printf("a=%s, b=%s", apt,b);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:09:38.753

`apoint`应该是 a `char*`，你没有关于这个指针分配的警告吗？此外，您不会迭代字符串的所有字符...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:12:58.777

也许这行`int *apoint = &a`是错误的，`&a`是指向 char 的指针，而`apoint`is `int *`。你没有编译错误吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T11:15:42.727

`-Wall`如果启用或在 gcc中复制 char 的方法不好`-Werror`，您会看到很多错误。

您想要的东西，只需复制 main 中的指针即可，无需调用`copy (a,b);`

```
char *a;
char b[]="bluhbluh"
a=b; 
```

现在开始指向字符串“bluhbluh”

但我认为你不希望你希望每个字符都`array b`被复制到`array a`

你必须这样做

```
void copy(char *a,char *b)
{
  while(*b!='\0')
    *a++=*b++;
 }

int main()
{
  char a[100];
  char b[]="bluhbluh";
  copy(a,b);
  printf("%s\n",a);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T11:21:12.450

您的代码中有一些重大错误，特别是这一行不正确`int *apoint = &a;`，应该是`char* *apoint = &a;`

```
//Corrected Code:
#include <stdio.h>

void copy(char a[], char b[]){
    char* *apoint = &a;
    printf("%d\n", apoint);
    printf("%d\n", &a);
    *apoint = b;
    printf("%d\n", *apoint);
    printf("%s\n", a);
    printf("%s\n", b);
}

int main(void){
    char a[100];
    char b[] = "bluhbluh";

    copy(a,b);
    printf("%d\n", a);
} 
```

这将解决主要的代码问题，尽管我认为您的复制功能仍然不会给出您想要的结果，因为方法似乎不太正确。

# android - 带有背景的android警报器

> ID：13377553
> 
> 赞同：0
> 
> 时间：2012-11-14T11:02:21.920
> 
> 标签：android, android-asynctask, android-service, alarmmanager, android-handler

在我的一个应用程序中，我提供了多个警报并且它工作得很好。我想通过一些与互联网相关的后台任务来扩展该警报功能。当为特定给定值设置警报时，应用程序开始每隔 30 秒从我的服务器检查该值。每当返回相同的值时，警报就会响起。我的服务器每 30 秒更新一次新数据。

现在我正在使用广播接收器和不同的待处理意图 ID 设置多个警报。我应该如何开始实施？我对这个警报管理器、服务、接收器、处理程序、异步任务应该使用哪个感到困惑？

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:53:03.987

您可以创建一个新的 BroadcastReceiver 并设置每 30 秒重复一次警报，以便在您希望开始轮询服务器时触发接收器。

然后，新接收器可以检查您的服务器，如果满足条件，可以在警报管理器上调用取消以取消触发它的重复警报。

# random - 随机图像滑块设置 z-index

> ID：13377554
> 
> 赞同：0
> 
> 时间：2012-11-14T11:02:28.530
> 
> 标签：random

当我使用这个脚本时，它以红色结束，因为这是最后一个。所以不知何故我需要添加 z-index:+1 ？

jsfiddle.net/fourroses666/MCDw7

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:17:59.053

这不是您问题的答案，但可能是您正在寻求的解决方案。因此，如果您想要图像的连续褪色。你应该有两张图片，背景一张的不透明度设置为 1，前景一张从 0 渐变到 1。当它达到 1 后，你将前景图像放在背景中，并在前景中添加一个不透明度为 0 的新图像...

[这是在 JSFiddle 上](http://jsfiddle.net/z3LQb/)

JS代码：

```
function changeImg(){
    var img1 = document.getElementById("1");
    var img2 = document.getElementById("2");
    img1.src = img2.src;
    $("#2").css({ opacity: 0 });
    var randomNumber = Math.floor(Math.random()*(16*16*16 - 1));
    var randomStr = randomNumber.toString(16);
    img2.src = "http://dummyimage.com/50/" + randomStr + "/" + randomStr;
    $('#2').delay(200).animate({opacity:1},150, function(){
            changeImg();
    });

}

$(document).ready(function(){   
    changeImg();
});​ 
```

HTML 代码：

```
<div id="container">
    <img id="1" src="http://dummyimage.com/50/000/000" />
    <img id="2"/>    
</div>​​​​​ 
```

CSS 代码：

```
div img{
    position:absolute;
    width: 50px;
    opacity:1;
} 
```

# java - 没有使用 Maven 插件从 xsd 生成的 JAXB 类

> ID：13377556
> 
> 赞同：-1
> 
> 时间：2012-11-14T11:02:32.353
> 
> 标签：java, maven, maven-jaxb2-plugin, jaxb2-maven-plugin

我无法看到使用 jaxb2-maven-plugin 从我的 xsd 生成的任何 jaxb 类

```
 <bulid>
    <pluginManagement>
    <plugins>
        <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>jaxb2-maven-plugin</artifactId>
        <version>1.5</version>
        <executions>
            <execution>
                <phase>generate-sources</phase>
                <goals>
                    <goal>generate</goal>
                </goals>
            </execution>
        </executions>
        <configuration>

            <schemaDirectory>src/main/xsd</schemaDirectory>
<sourceGenerationDirectory>target/sources</sourceGenerationDirectory>
<classGenerationDirectory>target/classes</classGenerationDirectory>
        </configuration>
        </plugin>
    </plugins>
    </pluginManagement>
    </bulid>
    <dependencies>
    <dependency>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>jaxb2-maven-plugin</artifactId>
        <version>1.5</version>
    </dependency> 
```

我通过给 clean install generate:generate 来运行我的 pom 是正确的方法吗？请提出一种生成 jaxb 类的方法

我什至试图通过 mvn generate-sources 运行什么都没有生成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:06:04.343

这在某个时间点对我有用；你可以从那里工作：

```
<plugin>
    <groupId>com.sun.tools.xjc.maven2</groupId>
    <artifactId>maven-jaxb-plugin</artifactId>
    <version>1.1</version>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <removeOldOutput>false</removeOldOutput>
        <schemaDirectory>src/main/resources/xsd</schemaDirectory>
        <includeBindings>
            <includeBinding>*.xjb</includeBinding>
        </includeBindings>
    </configuration>
</plugin> 
```

该插件绑定到`generate-sources`阶段。

干杯，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T12:10:34.237

我刚刚将我的目标更改为 xjc 和 mvn jaxb2:xjc 它工作了我能够生成 jxb 类

# apache - 瑞士法郎限制

> ID：13377562
> 
> 赞同：0
> 
> 时间：2012-11-14T11:02:47.140
> 
> 标签：apache, tomcat, flash, cross-domain-policy

我有两个 swf（A 和 B），在 A 里面我正在做 B 的 urloader。它工作正常。它们在同一个目录中。现在我想要的是阻止每个人访问 B（A 除外）。我正在使用带有 https 的 apache/tomcat 服务器。这是我的跨域文件

```
<cross-domain-policy>
     <allow-access-from domain="*" to-ports="*" secure="false"/>
</cross-domain-policy> 
```

之所以这样，是因为我还需要访问一些外部端口。

是否可以通过跨域保护B，或者通过配置tomcat访问规则直接在服务器中保护B？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:43:31.730

如果您能够直接下载 swf B，那么任何人都可以。跨域策略文件简直就是flash所推崇的东西。

如果你想阻止下载，我建议你在两者之间引入服务器端语言。

类似的东西：`.../download.php?id=xyz`或`.../download.aspx?id=xyz`

在那里您可以验证/验证对 swf 的请求。

# java - 拆分字符序列但保留字符串

> ID：13377566
> 
> 赞同：0
> 
> 时间：2012-11-14T11:03:08.677
> 
> 标签：java, android, regex

我办公室的一个程序员做了一个有点迟钝的数据库，所以我遇到了一个问题。我有一个需要分成 4 部分的字符串，所以我可以从索引中读取数据。

我得到的字符串是这样的：

> 瞄准器|4-28-2-2.mp3=12###

我想找回的数组是：

> 1.  瞄准器
> 2.  4-28-2-2.mp3
> 3.  12
> 4.  ###

我目前使用的 Java 代码：

```
String assignmentRaw = "aimer|4-28-2-2.mp3=12###";
String[] assignmentSplit = assignmentRaw.split("\\||=");

for(String assignment : assignmentSplit)
    Log.i(ElkeDagApplication.DEBUG_TAG, assignment); 
```

并返回：

> 1.  瞄准器
> 2.  4-28-2-2.mp3
> 3.  12###

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:14:02.663

如果最后一次拆分的要求是：左边是一个数字，右边是#，你可以这样做

```
String[] assignmentSplit = assignmentRaw.split("\\||=|(?<=\\d)(?=#)"); 
```

`(?<=\\d)`是检查左侧数字的[后向断言](http://www.regular-expressions.info/lookaround.html)

`(?=#)`是一个[先行断言](http://www.regular-expressions.info/lookaround.html)，检查右侧的“#”

# forms - Yii：为模型添加属性

> ID：13377573
> 
> 赞同：2
> 
> 时间：2012-11-14T11:03:29.540
> 
> 标签：forms, yii

我正在尝试向我的模型（“CustomUser”）之一添加一个属性，该模型继承了我的模型“User”。

我想以“createUser”形式使用此属性作为验证密码字段。我想使用虚拟属性，因为我无法修改只有一个字段“密码”的数据库。

但是，当我尝试获取包含表单的视图时，会显示此错误：

> 未定义属性“User.password_verification”。

这是发生错误的行：

```
echo $form->labelEx($user,'password_verification');    
echo $form->textField($user,'password_verification',array('size'=>30,'maxlength'=>40)); 
```

### 我的用户.php：

```
class User extends CActiveRecord { 
... 

public function rules(){        
  return array(
    array('username, password, email', 'required'),             
    array('created_by', 'numerical', 'integerOnly'=>true),
    array('username, email', 'length', 'max'=>255),
    array('password', 'length', 'max'=>32),
    array('valid_from, valid_until, added_on', 'safe'),             
    array('username, email', 'unique'),
    array('id, type, username, password, email, valid_from, valid_until, 
    added_on,created_by','safe','on'=>'search'),
  );
...
} 
```

### 我的 CustomUser.php

```
class CustomUser extends User
{
    public $password_verification;

    public function rules()
    {
        $newRules = array(
                array('password_verification', 'required'),
                array('password_verification', 'length', 'max' => 32),
                array('password', 'compare', 'compareAttribute' => 'password_verification'),
                array('password_verification', 'safe', 'on' => 'search'),
        );
        return array_merge(User::model()->rules(), $newRules);
    }
} 
```

你认为这是我的`rules()`功能有问题吗？你知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:17:47.827

像这样定义：

```
class User extends CActiveRecord { 

 $password_verification

 .... 
```

然后您的模型将能够访问此属性，因为您已将其定义为公共属性，该属性将用作 Active Record 的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T13:46:34.287

错误

> 未定义属性“User.password_verification”

表示您将`User`模型传递给您的视图，但`$password_verification`属性仅存在于`CustomUser`模型中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T10:12:20.477

谢谢大家的答案。

最后，我犯了一个大错误...-__-

我在视图中使用了 User 而不是 CustomUser（我专注于 actionCreate，我忘记了 actionIndex()...）

对不起。

祝你有美好的一天

迈克尔

# debugging - 在 Windows 8 中调试 OnFileActivated

> ID：13377578
> 
> 赞同：2
> 
> 时间：2012-11-14T11:03:57.153
> 
> 标签：debugging, windows-8

我已将我的 Windows 8 应用程序与文件类型相关联。但是，当我打开该文件时，我的应用程序开始打开然后崩溃。

在附加调试器时，我无法找到一种方法来执行此操作。

我认为我的 OnFileActiavted 方法有问题，所以我求助于更改该方法中的随机代码位。这不起作用，所以我想知道我应该如何调试这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T11:34:29.653

这行得通吗？您可以在不立即启动应用程序的情况下进行调试。您还可以调试其他人的应用程序。

![在此处输入图像描述](../Images/3a2e0b6c5d6ab377f3ca457161d8693f.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-07T17:36:33.210

另一种方法：

```
Debugger.Launch(); 
```

当您的应用程序启动并执行到此行时，您的应用程序将停止并且 VS 会询问您是否要附加调试器。

# windows - 通信对象 System.ServiceModel.Channels.ServiceChannel 不能用于通信，因为它处于故障状态

> ID：13377581
> 
> 赞同：4
> 
> 时间：2012-11-14T11:04:22.003
> 
> 标签：windows, wcf, service, state, faulted

> 通信对象 System.ServiceModel.Channels.ServiceChannel 不能用于通信，因为它处于故障状态。

当 Windows 应用程序尝试通过 wsDualHttpBinding 与作为 Windows 服务托管的 WCF 通信时，我收到此错误。WCF 用于通过串行端口与设备通信。Windows 应用程序过去常常通过 WCF windows 服务发送命令。

这是堆栈跟踪：

> 堆栈跟踪：在 System.ServiceModel.Channels.CommunicationObject.ThrowIfDisposedOrNotOpen() 在 System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) 在 System .ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
> 
> 在 [0] 处重新引发异常：在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) 处的 System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) 处 GridSplitter.CommandServiceReference。 ICommandService.SendToMultipleChannel(String[] channel, Int32[][] locid, String cmd, Int32 cmdData) at GridSplitter.CommandServiceReference.CommandServiceClient.SendToMultipleChannel(String[] channel, Int32[][] locid, String cmd, Int32 cmdData) at GridSplitter.MainWindow.bwChkAndSendRedeploy_DoWork（对象发送者，DoWorkEventArgs e）：2012 年 11 月 9 日上午 11:05:58

1.  我不明白为什么服务会进入故障状态。
2.  我是否应该捕获此异常并执行一些补丁工作（如果推荐）？
3.  TCP 绑定可以帮助我避免/删除此异常吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T13:28:34.797

您的问题是您的代码`ChannelFactory`在服务调用产生故障后使用服务代理的实例（服务参考，由 SvcUtil 生成或直接从创建）。WCF 的实现方式，一旦与该代理的调用引发错误，您就不能“重用”服务代理。

您需要按照这篇针对 WCF 特定要求[的好帖子中显示的行编写适当的异常处理逻辑。](http://geekswithblogs.net/DavidBarrett/archive/2007/11/22/117058.aspx)无论您配置要使用的代理的实际绑定如何，都需要执行此操作。

# javascript - 如何在不同域上设置 iframe 内容的样式？

> ID：13377584
> 
> 赞同：4
> 
> 时间：2012-11-14T11:04:37.807
> 
> 标签：javascript, html, css, iframe

我有一个托管在一个域和多个网站上的小部件，它们使用 iframe 来显示小部件。我希望 iframe 的内容根据父网站进行样式设置，但我知道由于[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，父网站无法操纵来自另一个域的内容。

我可以访问小部件和父网站，并且想知道根据父网站更改小部件样式的最佳方法是什么？我更喜欢一种方法，这意味着如果新网站需要包含 iframe 或现有网站更改了样式，我就不必更改小部件。

将父网站样式表的位置传递给小部件并使用它来设置小部件的样式是一个可行的想法，如果是，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T10:28:36.883

我建议在您的小部件所在的服务器上创建一个基于查询字符串参数返回 CSS 的 Web 服务。小部件 iframe 可以加载位于外部的资源，前提是它们在 HTML 中明确定义，而不是动态附加到 DOM（想想 Google 托管的 JavaScript 库，例如 jQuery 和相关的 CSS）。

另一种解决方案，假设您使用的是现代浏览器，您可以使用[window.postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)

此 API 允许您将事件（以及随之而来的数据……例如 CSS 字符串）从父窗口分派到子窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:30:45.840

在托管小部件的服务器上，您可以使用以下命令获取来自请求的页面（如果您使用 php）：

```
$_SERVER["HTTP_REFERER"] 
```

基于此，您可以为小部件使用不同的样式。

# ios - 可访问性：将语音焦点移到 UITableViewController 中 tableView 中的第一个单元格

> ID：13377585
> 
> 赞同：4
> 
> 时间：2012-11-14T11:04:45.177
> 
> 标签：ios, uitableview, accessibility, navigationcontroller

我有一个有两个 UITableViewControllers 的主窗口。在第一个 tableViewController（左窗格）中选择单元格时，右侧的 tableViewContainer 被填充。在画外音模式下，我希望当第一个 tableViewController 中的单元格被选中时，secondViewController 中的第一个单元格获得焦点，以便从那里开始轻弹顺序。请注意，我已经尝试了以下两种方法：

1）制作第二个视图控制器的第一个单元格，firstResponder。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

{          
    UITableViewCell *outCell =(UITableCellView*)  [tableView dequeueReusableCellWithIdentifier:MyIdentifier];
    if (indexPath.row == 0)
    {
        [outCell becomeFirstResponder];
    }
} 
```

2）我还尝试将单元格作为第一个可访问性项目发布布局更改通知。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{          
    UITableViewCell *outCell =(UITableCellView*)  [tableView dequeueReusableCellWithIdentifier:MyIdentifier];

     if (indexPath.row == 0)
     {
         UIAccessibilityPostNotification(UIAccessibilityLayoutChangedNotification, outCell);
     }
} 
```

上述方法均无效。知道我还能尝试什么或上述方法有什么问题吗？

请注意：我已阅读视图控制器的文档（[https://developer.apple.com/LIBRARY/IOS/#featuredarticles/ViewControllerPGforiPhoneOS/Accessibility/AccessibilityfromtheViewControllersPerspective.html](https://developer.apple.com/LIBRARY/IOS/#featuredarticles/ViewControllerPGforiPhoneOS/Accessibility/AccessibilityfromtheViewControllersPerspective.html) - 将 VoiceOver 光标移动到特定元素）。尝试在我的示例中发布 LayoutChanged 通知和 ScreenChangedNotifications 并尝试使用示例代码（ListAdder - [http://developer.apple.com/library/ios/#samplecode/ListAdder/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/ListAdder/Introduction/Intro.html)，它也使用NavigationController 就像我们所做的那样），但即使使用示例，上述内容也不起作用。

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-30T22:30:41.723

我通过发布*屏幕更改通知*解决了这个问题。该调用的第二个参数是要选择第一个单元格的表视图的视图。

UIAccessibilityPostNotification(UIAccessibilityScreenChangedNotification, [[self nextTableViewController] view];

# ios - 使用 Trigger.io 编写 iOS 移动应用程序的 Apple 设备是什么？

> ID：13377588
> 
> 赞同：1
> 
> 时间：2012-11-14T11:05:02.283
> 
> 标签：ios, trigger.io

我想制作一个 iOS 应用程序，但我没有 Mac 或任何装有 iOS 的设备。我读到我可以使用 Trigger.io 在 Windows 和 Linux 上制作 iOS 应用程序。我要制作的应用程序相当简单。我需要的是一个带有 iOS 的设备来测试。我应该得到哪些设备？我正在考虑购买 Iphone 4 和 Ipad 2，因为它们很便宜。你怎么看？如果我只在这 2 台设备上进行测试，我能否成功构建应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:17:45.763

这些将是很好的测试设备。你会错过配备 Retina 显示屏的 iPad，这意味着你可能会猜测这些屏幕上的图标和启动图像的外观，但最重要的是涵盖手机和平板电脑的外形尺寸。

# ios - 每次调用方法时，我可以将同名的 UIImage 添加到 NSMutableArray 吗？

> ID：13377589
> 
> 赞同：0
> 
> 时间：2012-11-14T11:05:11.143
> 
> 标签：ios, uiimage, nsmutablearray, afnetworking, nsurlrequest

我正在使用 AFNetworking API，并且正在使用 AFImageRequestOperation 函数从服务器 API 调用图像 URL 以将其转换为 UIImage。我想做的是；每次我调用这个方法时：

```
NSURLRequest *requestImage = [NSURLRequest requestWithURL:theImageURL];
// theImageURL is the Image URL that is collected in a previous method from the server.

            AFImageRequestOperation *imageOperation = [AFImageRequestOperation imageRequestOperationWithRequest:requestImage imageProcessingBlock:nil success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image)
            {
                 objImageArray = [[NSMutableArray alloc] init];
                 if (requestImage != nil) {

                 [objImageArray addObjectsFromArray:image];

                 }

            } failure:nil];

            [imageOperation start]; 
```

所以我调用了 URL 并成功地将图像 URL 分配给了*UIImage*。然后我分配了一个*NSMutableArray*并将图像添加到其中。我遇到的问题是，每次再次调用该方法时，MutableArray 都会用新图像替换旧图像。我提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:18:00.450

您应该能够在 .h 文件中设置 NSMutableArray。

```
@property(nonatomic, strong) NSMutableArray * objImageArray; 
```

然后删除您在 .m 文件中创建数组的代码。

```
objImageArray = [[NSMutableArray alloc] init]; 
```

然后您可以使用相同的添加对象，但您需要确保将其设置为数组。

```
[self.objImageArray addObjectsFromArray:image]; 
```

编辑：该数组不关心它包含的对象的名称，因此它们都可以具有相同的名称。当您从数组索引而不是名称获取图像后查找图像时。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:13:44.160

每次调用此块时，您都会重新创建一个`objImageArray`. 因此它变成空的，旧的`UIImage`自动释放池释放旧的`UIImage`，然后您`UIImage`随时添加一个新的 => 不超过 1 个对象。您应该创建一次，而不是每次调用该块时。至少，尝试在块之外分配它。

# php - 关闭搜索隐私

> ID：13377591
> 
> 赞同：0
> 
> 时间：2012-11-14T11:05:15.917
> 
> 标签：php, search-engine, profile

如何使用 php 向搜索引擎隐藏配置文件详细信息？

我只想阻止搜索引擎在我的网站上查看用户的详细信息

从他们的帐户页面设置关闭搜索隐私。

例如：Facebook 个人资料隐私

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:58:22.793

如果机器人尊重它们，则使用 robots.txt / html 元标记很好，但否则毫无意义。保护信息的唯一现成方法是使用某种身份验证系统，其中只有注册会员才能查看某些内容，否则会限制谁可以查看什么内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:07:57.173

您可以将以下行添加到 html/php 页面的标题部分

```
<meta name="robots" content="noindex, nofollow" />
<meta name="googlebot" content="noindex, nofollow" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:08:11.050

使用如下内容创建 robots.txt

```
User-agent: *
Disallow: /profile 
```

有关可能选项的更多信息，请参见[此处](http://www.robotstxt.org/robotstxt.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:09:55.477

您可以尝试使用[`/robots.txt`](http://www.robotstxt.org/robotstxt.html)，但不能保证他们会真正尊重该配置。

[您可能要做的第二件事是通过指定黑名单（您可以谷歌`list of search robot ip`](https://www.google.com/search?hl=en&ie=UTF-8&q=list%20of%20search%20robots%20ip)）从像[这样](http://www.iplists.com/)的列表中指定所有 ip （尽管这是[恶意软件使用的](https://stackoverflow.com/a/9546330/1149736)做法）来隐藏机器人的包含。

# android - Android：使用 ContentProvider 阅读电子邮件

> ID：13377595
> 
> 赞同：3
> 
> 时间：2012-11-14T11:05:20.710
> 
> 标签：android, email, android-contentprovider

我想使用 ContentProvider 从默认的 HTC 邮件应用程序读取来自 Android 设备 (Wildfire S) 的电子邮件，类似于读取 SMS：

```
Uri allMessage = Uri.parse("content://sms/");
ContentResolver cr = getContentResolver();
Cursor c = cr.query(allMessage, null, null, null, null);
while  (c.moveToNext()) {
    smss.add(new SMSObject(c)); //custom object which just retrieves all fields
} 
```

邮件也应该有类似的东西，所以我检查了所有可用的 ContentProviders：

```
for (PackageInfo pack : getPackageManager().getInstalledPackages(PackageManager.GET_PROVIDERS)) {
    ProviderInfo[] providers = pack.providers;
    if (providers != null) {
        for (ProviderInfo provider : providers) {
            Log.d("Example", "provider: " + provider.authority);
        }
    }
} 
```

在此列表中（其中包含 , 和 之类的东西`gmail-ls`，`sms`所以`com.android.calendar`我在正确的轨道上）我找到了`mail`，所以我尝试了这个：

```
Uri allMessage = Uri.parse("content://mail/");
ContentResolver cr = getContentResolver();
Cursor c = cr.query(allMessage, null, null, null, null);
while  (c.moveToNext()) {
    emails.add(new SMSObject(c)); //custom object. should work with emails as well
} 
```

但我得到了这个例外：

`11-14 11:48:42.105: E/AndroidRuntime(3609): java.lang.RuntimeException: Unable to start activity ComponentInfo{nl.me.emailretriever/nl.me.emailretriever.MainActivity}: java.lang.SecurityException: Permission Denial: opening provider com.htc.android.mail.MailProvider from ProcessRecord{40685dd8 3609:nl.me.emailretriever/10076} (pid=3609, uid=10076) requires com.htc.android.mail.permission.READ_MAIL or com.htc.android.mail.permission.WRITE_MAIL`... `11-14 11:48:42.105: E/AndroidRuntime(3609): Caused by: java.lang.SecurityException: Permission Denial: opening provider com.htc.android.mail.MailProvider from ProcessRecord{40685dd8 3609:nl.me.emailretriever/10076} (pid=3609, uid=10076) requires com.htc.android.mail.permission.READ_MAIL or com.htc.android.mail.permission.WRITE_MAIL`

所以我添加了这两个权限，但无济于事。

```
<uses-permission android:name="com.htc.android.mail.permission.WRITE_MAIL" />
<uses-permission android:name="com.htc.android.mail.permission.READ_MAIL" /> 
```

我怎样才能像访问 SMS 一样阅读/访问电子邮件？为什么我得到一个例外，虽然我有所需的权限？

# java - 在 html (java servlet) 中单击了哪个列表元素

> ID：13377599
> 
> 赞同：-1
> 
> 时间：2012-11-14T11:05:40.970
> 
> 标签：java, html, list, servlets

问题显示在标题中。这是代码：

```
<div class=\"column-left\">
    <ul class=\"nav nav-list\">     
            <li tabindex=\"1\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Ortaggi</a></li>
            <li tabindex=\"2\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Verdure</a></li>
            <li tabindex=\"3\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Formaggi</a></li>
            <li tabindex=\"4\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Frutta</a></li>
            <li tabindex=\"5\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Semi</a></li>
            <li tabindex=\"6\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Succhi</a></li>
            <li tabindex=\"7\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Piante</a></li>
            <li tabindex=\"8\"><a href=\"BuyerSelectionPage\"><i class=\"icon-leaf\"></i> Erbe</a></li>
    </ul>
</div> 
```

它是来自 java 的剪切和粘贴，所以不要看 \" 而不是 "

我如何从 java servlet 中捕获它？因为我想创建查询数据库的动态页面，而不是创建大量静态页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:31:30.730

添加带有 href 的参数并使用检查此参数的值`request.getParameter("sel")`

例如：

```
 <li tabindex=\"1\"><a href=\"BuyerSelectionPage?sel=1\"><i class=\"icon-leaf\"></i> Ortaggi</a></li>
    <li tabindex=\"2\"><a href=\"BuyerSelectionPage?sel=2\"><i class=\"icon-leaf\"></i> Verdure</a></li>
    <li tabindex=\"3\"><a href=\"BuyerSelectionPage?sel=3\"><i class=\"icon-leaf\"></i> Formaggi</a></li> 
```

# ios - 如何在 Cocoa touch 中进行范围控制？

> ID：13377600
> 
> 赞同：0
> 
> 时间：2012-11-14T11:05:43.430
> 
> 标签：ios, cocoa-touch

是否可以对 UISlider 进行子类化以显示两个旋钮，以便我可以选择一个范围？如果没有，我有什么选择来进行这样的控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:11:50.733

这是一个教程，向您展示如何制作您想要的东西。[教程](http://buildmobile.com/wicked-ios-range-slider-part-one/)

# c# - 在 .net 4.0 应用程序中引用 .net 2.0 程序集

> ID：13377601
> 
> 赞同：1
> 
> 时间：2012-11-14T11:05:46.923
> 
> 标签：c#, .net

我有一个 .net 4.0 项目，我想在其中引用 .net 2.0 程序集。[正如我从这篇](http://msdn.microsoft.com/en-us/library/ee518876.aspx)文章中了解到的，.net 2.0 程序集将在 4.0 运行时加载，并且不能保证向后兼容性。有没有办法在这种情况下强制处理并加载 2.0 运行时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:42:57.247

进程中并行版本控制仅支持独立运行而无需共享数据的代码。特别是对于加载 CLR 以执行托管代码的本机代码。它是 CLR 版本控制问题的解决方案，一旦像 Explorer 这样的非托管程序加载 CLR，比如支持用 .NET 编写的 shell 扩展，则 CLR 版本由扩展要求的任何版本选择。如果另一个扩展需要更高版本的 CLR，则效果不佳。.NET 4 的并行版本控制功能解决了这个问题，每个扩展都有自己的 CLR。不需要共享数据，这些扩展互不了解。

显然，这不是您想要做的事情的解决方案。Microsoft 做了很多努力来使 .NET 4.0 尽可能与以前的 .NET 版本兼容，并且加载 .NET 2.0 程序集当然得到了很好的支持。在某种程度上，他们确实利用这个机会修复了几个旧错误，这些错误的修复可能会破坏旧代码。从技术上讲，您的 2.0 代码可能依赖于此类错误的行为，但可能性不大。你只需要重新测试你的代码。

# android - Soundpool 只播放文件的前 5 秒。为什么？

> ID：13377604
> 
> 赞同：25
> 
> 时间：2012-11-14T11:05:59.940
> 
> 标签：android, soundpool

我在我的应用程序中使用 Soundpool，到目前为止效果很好，但我确实有一个 10 秒的 wav 文件。不幸的是，soundpool 只播放前 5 秒。如何让 soundpool 播放整首曲目？我已将 wav 转换为 -- ogg 和 mp3 仍然是同样的问题。它只播放前 5 秒。任何帮助将非常感激。

```
//set up audio player
mSoundPool = new SoundPool(20, AudioManager.STREAM_MUSIC, 0);
//load fx
mSoundPoolMap.put(RAW_1_1, mSoundPool.load(this, R.raw.loop1, 1));
//playing soundpool
case R.id.button1:          
mSoundPool.stop(mStream1);
mStream1= mSoundPool.play(mSoundPoolMap.get(RAW_1_1), streamVolume, streamVolume, 1, LOOP_1_TIME, 1f); 
```

UPD Last: 也许有人会在这里找到并阅读它。似乎 soundpool 不能播放超过 5 秒。这是他的最大值，对于更长的声音使用 MediaPlayer。我希望你不会像我那样花太多时间）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-23T15:46:06.740

所以我认为你在 SoundPool 中达到了 1M 的限制。

SoundPool 将缓冲区大小硬编码为 1M，对于所有加载的文件，以 pcm 格式存储。

所以它不关心ogg或wav。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-13T08:29:16.133

我们通过降低 *.ogg 效果采样率解决了类似的问题。我们的初始采样率为 44 kHz ~ 只播放了 10 秒的声音，降低到 16 kHz 将可播放性提高到 30 秒

[在这个讨论](http://www.cocos2d-x.org/forums/6/topics/4604?r=36114#message-36114)中找到了解决方案

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-10-08T09:56:03.677

SoundPool 旨在播放短音效。要播放音乐（大音频文件），您需要使用[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)

```
// R.raw.audio_file - res/raw/audio_file.mp3

mediaPlayer = MediaPlayer.create(this, R.raw.audio_file);
mediaPlayer.start(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-14T12:11:37.070

这个活动对我有用

```
public class MainActivity extends Activity {

    private Integer soundID;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        this.setVolumeControlStream(AudioManager.STREAM_MUSIC);
        // Load the sound
        AudioManager audioManager = (AudioManager) getSystemService(AUDIO_SERVICE);
        float actualVolume = (float) audioManager
            .getStreamVolume(AudioManager.STREAM_MUSIC);
        float maxVolume = (float) audioManager
            .getStreamMaxVolume(AudioManager.STREAM_MUSIC);
        final float volume = actualVolume / maxVolume;

        SoundPool soundPool = new SoundPool(10, AudioManager.STREAM_MUSIC, 0);

        soundPool.setOnLoadCompleteListener(new OnLoadCompleteListener() {
          @Override
          public void onLoadComplete(SoundPool soundPool, int sampleId,
              int status) {
                      @Override
      public void onLoadComplete(SoundPool soundPool, int sampleId,
          int status) {
          soundPool.play(soundID, volume, volume, 1, 0, 1f);
          try {
            Thread.sleep(5000); // play twice
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
          soundPool.play(soundID, volume, volume, 1, 0, 1f);
      }
    });
          }
        });
        soundID = soundPool.load(this, R.raw.sound2, 1);
      //load fx
      //playing soundpool

    }
} 
```

您必须加载声音异步并检查音频缓存 - 它可能会溢出。

阅读这篇文章 [http://www.google.by/url?http://www.vogella.com/articles/AndroidMedia/article.html](http://www.google.by/url?http://www.vogella.com/articles/AndroidMedia/article.html)

它非常细心

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-24T13:04:25.007

您的文件可能太大。如果您仍然不需要立体声，请尝试从立体声更改为单声道。或者尝试对您的文件进行下采样。

减少文件在我的情况下有效。

# linux - 递归地chmod

> ID：13377606
> 
> 赞同：253
> 
> 时间：2012-11-14T11:06:09.490
> 
> 标签：linux, shell, find, chmod

我有一个存档，由其他人存档，我想在下载后自动更改提取文件中的文件系统分支以获得读取权限。（我无法更改存档的创建方式）。

我研究了这个线程：[chmod：如何递归地将执行权限添加到已经具有执行权限的文件，](https://stackoverflow.com/questions/6937885/chmod-how-to-recursively-add-execute-permissions-only-to-files-which-already-ha)就像其他一些文件一样，但没有乐趣。

这些目录最初带有多个但都是错误的标志，它们可能显示为：

```
drwx------
d---r-x---
drwxrwxr-x
dr--r-xr-- 
```

这些只是我迄今为止发现的少数几个，但可能更多。

`find`尝试在没有`x`权限的情况下查看目录时出错，因此不会将其传递给`chmod`. 到目前为止，我一直在做的是手动更改父目录的权限，然后进入子目录并为它们做同样的事情等等。但这是很多手工劳动。没有办法自动执行此操作吗？

即我现在是怎么做的：

做：

```
$ chmod -R +x
$ chmod -R +r 
```

直到我没有错误，然后

```
$ find -type f -exec chmod -x {} + 
```

但必须有更好的方法。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-11-14T11:36:26.057

您可以使用带有`X`模式字母（大写 X）的 chmod 来仅为目录设置可执行标志。

在下面的示例中，可执行标志被清除，然后递归地为所有目录设置：

```
~$ mkdir foo
~$ mkdir foo/bar
~$ mkdir foo/baz
~$ touch foo/x
~$ touch foo/y

~$ chmod -R go-X foo 
~$ ls -l foo
total 8
drwxrw-r-- 2 wq wq 4096 Nov 14 15:31 bar
drwxrw-r-- 2 wq wq 4096 Nov 14 15:31 baz
-rw-rw-r-- 1 wq wq    0 Nov 14 15:31 x
-rw-rw-r-- 1 wq wq    0 Nov 14 15:31 y

~$ chmod -R go+X foo 
~$ ls -l foo
total 8
drwxrwxr-x 2 wq wq 4096 Nov 14 15:31 bar
drwxrwxr-x 2 wq wq 4096 Nov 14 15:31 baz
-rw-rw-r-- 1 wq wq    0 Nov 14 15:31 x
-rw-rw-r-- 1 wq wq    0 Nov 14 15:31 y 
```

一点解释：

*   `chmod -x foo`- 清除*可执行*标志`foo`
*   `chmod +x foo`- 设置*可执行*标志`foo`
*   `chmod go+x foo`- 同上，但只为*组*和*其他*用户设置标志，不要触摸*用户*（所有者）权限
*   `chmod go+X foo`- 同上，但只适用于目录，不要碰文件
*   `chmod -R go+X foo`- 与上面相同，但*递归*地对所有子目录执行此操作`foo`

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2012-11-14T11:23:20.183

除了执行权限之外，您还需要读取权限才能列出目录。如果您只有执行权限，那么您可以找到目录中条目的名称，但没有其他信息（甚至没有类型，所以您不知道哪些条目是子目录）。这对我有用：

```
find . -type d -exec chmod +rx {} \; 
```

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2012-11-14T11:20:11.187

尝试同时更改所有权限：

```
chmod -R +xr 
```

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2015-03-02T07:07:43.557

为了使所有者可以写入所有内容，由组读取/执行，并且世界可执行：

```
chmod -R 0755 
```

让一切都敞开：

```
chmod -R 0777 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-07-14T07:50:16.203

**递归地**向当前文件夹中的所有文件（不是文件夹）添加可执行权限，`sh`扩展名为：

`find . -name '*.sh' -type f | xargs chmod +x`

* 注意[管道 ( `|`)](https://unix.stackexchange.com/a/30852/6272)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-02-01T13:22:27.547

将 0777 分配给从当前路径开始的所有文件和目录：

> chmod -R 0777 ./

# android - Android SDKTools r21 库错误

> ID：13377607
> 
> 赞同：2
> 
> 时间：2012-11-14T11:06:09.643
> 
> 标签：android, android-library, android-sdk-tools

我今天更新到最新的`SDKTools`，[`r21`](http://developer.android.com/tools/sdk/tools-notes.html)项目不再正确打包。

例如，我将其`ActionBarSherlock`用作`library`项目，当我运行应用程序时，出现以下错误：

```
java.lang.NoClassDefFoundError: com.actionbarsherlock.R$styleable 
```

我已经恢复`r20`并再次工作。

有什么改变吗，我们应该添加不同的`library projects`? [我在Release General Notes](http://developer.android.com/tools/sdk/tools-notes.html)中看不到类似的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T21:56:50.310

是的，是 ADT r21 造成的。

[http://tools.android.com/download/adt-21-preview#TOC-New-in-ADT-21-Preview-5](http://tools.android.com/download/adt-21-preview#TOC-New-in-ADT-21-Preview-5) *库项目的 R 类仅使用库所需的 ID 生成，减少了字段和方法达到 dex 文件限制的风险。*

您需要手动清理库项目中的 bin 文件夹。

您可以在 Tor Norbye google+ 页面 [https://plus.google.com/116539451797396019960/posts/KVax2483Erk查看更新](https://plus.google.com/116539451797396019960/posts/KVax2483Erk)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T19:44:54.240

同样的问题，但我已经解决了。

**我做了什么：**

1.  项目/清理/构建所有库项目
2.  删除库项目并在 android 项目中读取它
3.  Android 工具/修复 android 项目上的项目属性
4.  项目/清理/构建在android项目上

希望这会有所帮助，也对您有用。

# java - JAVA：SWT 文本 + MouseListener

> ID：13377612
> 
> 赞同：0
> 
> 时间：2012-11-14T11:06:27.490
> 
> 标签：java, swt, mouselistener, settext

让我描述一下我的情况，我`Text`的 Java SE SWT 应用程序中有 SWT：假设 USER 将在应用程序运行时`String`向创建的内容写入一些东西 ( ) 。`Text`我想介绍一些`MouseListener`可以做到这一点的东西：当用户点击`Text`对象/小部件时，它`Text`本身会清除（`setText("");`）（如果以前写过一些字符串）。

`MouseListener`有 3 种方法：`mouseDown(...)`, `mouseUp(..)`, `mouseDoubleClick(...)`-> 我应该只`mouseDown(...)`在这种情况下使用 - 仅此而已。

在`mouseDown(..)`方法中，我需要调用实际文本对象引用的方法：`"XY".setText("");`通过鼠标点击的文本。-> 这我不知何故无法获得。

我希望它以某种方式像一般应用程序一样应用于我将在我的应用程序中使用的`MouseListener onMouseClickText`任何 SWT 。`Text`

有谁知道如何做到这一点`MouseListener`或更好：如何在`Text`里面获得对现有点击 SWT 的引用`MouseListener`？

***这是示例代码：***

```
package sk.tokra.example;

//imports here
.
.
import org.eclipse.swt.widgets.Text;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
.
.

public class Application {

 //class fields
 Text text;
 private static final Logger logger = LoggerFactory.getLogger(Application.class);
 .
 .
 .

 // main 
 public static void main(String[] args) {
  logger.debug("main(), Starting app!");
  try {
   Application window = new Application();
   window.open();
  } catch (Exception e) {
   e.printStackTrace();
  }
  logger.debug("main(), Exiting app!");
  return;
 }

 /**
  * Open the window.
  */
 public void open() {
  logger.debug("open()");
  Display display = Display.getDefault();
  createContents();
  shell.open();
  shell.layout();
  while (!shell.isDisposed()) {
   if (!display.readAndDispatch()) {
    display.sleep();
   }
  }
 }

 /**
  * Create contents of the window.
  */
 protected void createContents() {
  text = new Text(shell, SWT.BORDER);
  text.addMouseListener(onMouseClickText);
  . 
  .
  .
 }

 //other stuff/methods/listener part
 private MouseListener onMouseClickText = new MouseListener() {
  @Override
  public void mouseUp(MouseEvent arg0) {
   logger.debug("onMouseClickFind, mouseUp()");
  }

  @Override
  public void mouseDown(MouseEvent arg0) {
   logger.debug("onMouseClickFind, mouseDown()");
   // HERE I WOULD NEED to obtain refence of Text
   // then call .setText("");
  }

  @Override
  public void mouseDoubleClick(MouseEvent arg0) {
   logger.debug("onMouseClickFind, mouseDoubleClick()");
  }
 };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:31:34.023

正如 Naveen 建议的那样，最好使用焦点侦听器，因为相同的文本小部件可以通过多种不同的方式（如键盘上的选项卡）接收焦点。您可能也想处理这种情况。

在任何情况下，无论您使用 a`FocusListener`还是`MouseListener`在 上`Text`，您都可以获取实际导致事件的小部件。如果是鼠标侦听器，您会收到一个实例，`MouseEvent`您可以使用它`MouseEvent#widget`来访问 Text 控件。您的代码在侦听器实现中如下所示：

```
//other stuff/methods/listener part
private MouseListener onMouseClickText = new MouseListener() {
  @Override
  public void mouseUp(MouseEvent arg0) {
    ((Text) arg0.widget).setText("");
  }
...
} 
```

您可以将相同的侦听器实例添加到多个`Text`小部件，它应该可以工作。

# erlang - 我可以在 Erlang 中更改进程的优先级吗？

> ID：13377614
> 
> 赞同：6
> 
> 时间：2012-11-14T11:06:46.337
> 
> 标签：erlang, scheduling

我从这里[http://cs.ucsb.edu/~puneet/reports/erlang.pdf](http://cs.ucsb.edu/~puneet/reports/erlang.pdf)（第 4.4 节）了解到 Erlang 中的进程调度基于 4 个不同的队列 - 其中一个被指定为“最高优先级”。我有一个 Erlang 程序，我想分配一个进程，以便它的指令加入这个队列。有没有办法做到这一点？这样做时是否有任何观察？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T11:13:37.830

[在这里](http://erlang.org/doc/man/erlang.html#process_flag-2)查看 Erlang 的文档。有一个 BIF，称为`process_flag(Flag, Option)`.

```
process_flag(priority, Level)
% This sets the process priority. Level is an atom. 
% There are currently four priority levels: low, normal, high, and max. 
% The default is normal. 
```

# php - 寻找 在很长的文本中标记

> ID：13377615
> 
> 赞同：1
> 
> 时间：2012-11-14T11:06:47.770
> 
> 标签：php

`p`我有一个很长的 HTML 文本，我想在其中迭代PHP 中标签的id 值。我的原始字符串：

```
$mystring="
<p> my very long text with a lot of words ....</p>
<p></p>
<p> my other paragraph with a very long text ...</p>
(...)
"; 
```

我想要的结果：

```
$myparsestring= "
<p id=1>my very long text with a lot of words ....</p>
<p id=2> my other paragraph with a very long text ...</p>
"; 
```

如您所见，我可以使用`getElementsByTagName ()`和正则表达式（可能会拆分）。

您对这项工作有何指导？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:15:39.957

如果您打算解析 html，请尝试将[DOM](http://php.net/manual/en/book.dom.php)与[xpath](http://php.net/manual/en/simplexmlelement.xpath.php)一起使用。

这是一个简单的例子：

```
$xpath = new DOMXPath($html);
$query = '//*/p';
$entries = $xpath->query($query); 
```

不要使用正则表达式，如果您打算像这样解析 html，请使用此方法，除非您有使用正则表达式的特定原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:13:30.117

你可以`regex`这样去：

```
$mystring="
<p> my very long text with a lot of words ....</p>
<p></p>
<p> my other paragraph with a very long text ...</p>
(...)
";

// This will give you all <p> tags, that have some information in it.
preg_match_all('/<p>(?<=^|>)[^><]+?(?=<|$)<\/p>/s', $mystring, $matches);

$myparsestring = '';
for( $k=0; $k<sizeof( $matches[0] ); $k++ )
{
    $myparsestring .= str_replace( '<p', '<p id='.($k+1), $matches[0][$k] );
}

echo htmlspecialchars( $myparsestring ); 
```

和输出/结果：

```
<p id=1> my very long text with a lot of words ....</p>
<p id=2> my other paragraph with a very long text ...</p> 
```

# java - Firefox ESR - 在两个不同的选项卡中加载相同的小程序两次时仅打开一个 VM

> ID：13377616
> 
> 赞同：1
> 
> 时间：2012-11-14T11:06:53.167
> 
> 标签：java, firefox, applet, jvm

我正在使用 Firefox ESR 10.0.10。当我在两个不同的选项卡中打开同一个小程序两次时，只会打开一个控制台。对我来说，看起来两个实例都在同一个虚拟机中。如果我现在打开带有相同小程序的第三个选项卡，则会打开第二个控制台，在第四个选项卡上再次不会...

我必须做些什么来确保为每个选项卡或小程序实例分别打开一个新的 VM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T06:44:41.500

[`SEPARATE_JVM`](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/applet/applet_deployment.html#SEPARATE_JVM)请参阅为每个小程序实例启动一个。

> `boolean`指定特定小程序应在其自己的 JVM 实例中运行的参数。这支持某些强大的桌面小程序，这些小程序不能容忍来自在同一 JVM 中运行的其他小程序的任何干扰，并且可能会消耗堆空间或其他资源。

```
<APPLET archive="my_applet.jar" code="MyApplet" width="300" height="300">
    <PARAM name="java_arguments" value="...">
    <PARAM name="separate_jvm" value="true">
</APPLET> 
```

# c++ - C++ 写入文本文件的特定部分而不覆盖

> ID：13377617
> 
> 赞同：0
> 
> 时间：2012-11-14T11:06:53.353
> 
> 标签：c++, file

我正在编写一个简单的日历应用程序，它将数据保存在文本文件中。我使用 iCalendar 格式，所以我的文本文件以“END:VCALENDAR”结尾。

当用户添加新事件时，应用程序应该在文本文件末尾写入关联数据而不覆盖“END:VCALENDAR”，我该怎么做？删除保存在文本文件中间的事件怎么样？是否需要使用更新的数据再次写入整个文件？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:27:06.007

没有任何方法可以插入文件中间；底层操作系统不支持它。通常的技术是将文件复制到一个临时文件中，沿着这条线进行任何您需要的修改，然后（并且*只有*在副本的输出上没有错误的情况下 - 验证输出流*在*关闭）删除输入文件并将临时文件重命名/移动为原始名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:09:30.970

您不能通过在文件中间写入来动态“扩展”文件。您需要：

1.  将整个日历反序列化到内存，然后将其写回（最佳选择）
2.  将超出您要插入数据的点的所有内容读入内存，写入数据，然后写入存储的文件“tail”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:23:29.277

C++ 库不支持任何方法，与 append 不同，它提供了在文件的任何特定位置插入的选项；无论是文本文件还是二进制文件。

那么您有两种选择：第一种是您假设的选择，即读取整个文件，更新数据并再次写回。其次是在文件中查找最后一行的第一个字符**E**，如 END:VCALENDAR，写入您的*事件*，然后将“END:VCALENDAR”附加到它。

是的，您可以通过编程找到最后一行的第一个字符**E**就在最后一个换行符之后。抱歉，据我所知，没有其他办法。

# css - 向 CKEDITOR.stylesSet 添加涉及多个元素的条目

> ID：13377620
> 
> 赞同：0
> 
> 时间：2012-11-14T11:06:58.440
> 
> 标签：css, cross-browser, ckeditor

我有一个包含两件事的项目符号列表设计：

一个。替换列表图标的蓝色箭头图像

湾。每个列表项的顶部和下方都有一个非常轻的虚线边框。

我想通过（[CKEDITOR.stylesSet](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.stylesSet.html)）将它构建到 CKEditor 中，以便用户可以从下拉列表中选择这种特定样式的列表，而不必编写任何代码来这样做。

我已经成功地创建了一个包含特定类的列表（现在有了这个主题），但是，我遇到了一些问题，因为它似乎是同时应用虚线和蓝色箭头的唯一方法是通过 CSS3 使用多个背景，**SURPRISE**在 IE8 或更低版本中不起作用。

如果我添加了一些 DOM 污染（即，将列表项文本包围在一个跨度中），我可以为它设置主题；但是，似乎 CKEDITOR.stylesSet 只允许为每个样式设置一个元素（即，我可以将 ul 设置为元素或将 li 设置为元素，但是我无法使用一种样式在 UL 上设置一个类并围绕带有跨度的子 li 元素的文本）。

或者有吗？我正在考虑为此使用 JavaScript，但我也愿意接受其他建议来完成我正在做的事情。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T18:48:35.993

箭头或虚线都不需要使用背景图像。你可以通过 CSS 来实现。您需要 CKEditor 做的就是将一个类应用于（听起来您已经是），然后使用类似于以下的 CSS：

```
.styled li {
    border-top: dotted 1px black;
    border-bottom: dotted 1px black;
}
.styled
{
    list-style: square url('http://www.wcb.ny.gov/site_images/blueArrow.gif')
} 
```

完整的工作示例：http: [//jsfiddle.net/jwynveen/ZhjCK/](http://jsfiddle.net/jwynveen/ZhjCK/)

# android - KSoap2 outOfMemoryError 打电话 Android

> ID：13377622
> 
> 赞同：0
> 
> 时间：2012-11-14T11:07:07.100
> 
> 标签：android, out-of-memory, android-ksoap2

我尝试使用 KSoap2 从 WebService 获取一些数据。

WebService 响应一个非常大的 XML 文件，所以当我执行 HttpTransportSE.call() 时，我得到一个 ouOfMemory 异常。

是否有可能从 Soap Web 服务中获得截断的响应？或者有没有办法将它直接写入设备上的文件中？这是我获取数据的课程：

```
 public static SoapObject GetItemData()
{

    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME_ITEM_DATA);
    request.addProperty("Company", company);
    request.addProperty("SerialNumber", serialId);

    itemEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    itemEnvelope.dotNet = true;

    itemEnvelope.setOutputSoapObject(request);

    AndroidHttpTransportSE androidHttpTransport = new AndroidHttpTransportSE(URL);
    androidHttpTransport.debug = true;
    Log.d("==ITEM_URL==", URL);
    try
    {
       androidHttpTransport.call(SOAP_ACTION_ITEM_DATA, itemEnvelope);
       Log.d("==ItemVerbindung==", "Verbindung aufgebaut");
    }
    catch (Exception e)
    {
       e.printStackTrace();
       Log.d("==ItemVerbindung==", "HTTPCALL nicht ausgeführt");
    }

    try
    {
        itemResult = (SoapObject)itemEnvelope.getResponse();
        Log.d("==ItemResponse==", "PropertyCount: "+itemResult.getPropertyCount());
    }
    catch(ClassCastException e)
    {
        itemResult = (SoapObject)itemEnvelope.bodyIn;           
    } 
    catch (SoapFault e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    if(itemResult != null)
    {
        return itemResult;
    }   
    return null;
} 
```

我还复制了 HttpTransportSE.java 并对其进行操作以直接写入文件。但是我得到一个无效的令牌错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T14:20:40.540

我找到了一个不使用 KSoap2 库的解决方案。

这是代码：

```
try {

    java.net.URL url = new java.net.URL(URL);
    HttpURLConnection rc = (HttpURLConnection) url.openConnection();
    rc.setRequestMethod("POST");

    rc.setDoOutput(true);
    rc.setDoInput(true);

    rc.setRequestProperty("Content-Type", "text/xml; charset=utf-8");
    rc.addRequestProperty("User-Agent", HTTP.USER_AGENT);
    rc.setRequestProperty("SOAPAction", SOAP_ACTION_ITEM_DATA);
    OutputStream out = rc.getOutputStream();
    Writer wout;
    wout = new OutputStreamWriter(out);
    wout.write("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    wout.write("<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">");
    wout.write("<soap:Body>");
    wout.write("<GetItemData2 xmlns=\"http://localhost/HSWebBL\">");
    wout.write("<Company>" + company + "</Company>");
    wout.write("<SerialNumber>" + serialId + "</SerialNumber>");
    wout.write("</GetItemData2>");
    wout.write("</soap:Body>");
    wout.write("</soap:Envelope>");
    wout.flush();
    wout.close();
    rc.connect();

    Log.d("==CLIENT==", "responsecode: " + rc.getResponseCode() + " " + rc.getResponseMessage());
    InputStream in = new BufferedInputStream(rc.getInputStream(), BUFFER_SIZE);
} catch (ProtocolException e) {
    e.printStackTrace();
} catch (MalformedURLException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

我使用 SAXParser 来解析 InputStream。这样我就不会再收到 outOfMemoryException 并且没有解析错误了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:14:40.110

我记得以前见过这个问题：

两个建议：

1) 下载时将 SOAP XML 流直接保存到磁盘。不要将其存储在内存中。

2) 使用**SAX 样式的解析器**对其进行解析，您不会将整个 DOM 加载到内存中，而是将其解析为块。

**编辑：检查这个**->[非常大的SOAP响应-Android-内存不足错误](https://stackoverflow.com/questions/4941581/very-large-soap-response-android-out-of-memory-error/12732396#12732396)

# javascript - 在 Internet Explorer 中使用 XSL 将 DOM 文档转换为片段

> ID：13377624
> 
> 赞同：0
> 
> 时间：2012-11-14T11:07:07.427
> 
> 标签：javascript, xml, internet-explorer, xslt

在 Firefox 和 Chrome 中，我使用这样的东西来使用 XSL 将 XML 文档转换为 DOM 片段：

```
var xsl = document.implementation.createDocument(); // i.e. a DOM document
var processor = new XSLTProcessor();
processor.importStylesheet(xsl);

var xml = document.implementation.createDocument(); // i.e. a DOM document
var fragment = processor.transformToFragment(xml, document); 
```

在实际代码中，`xsl`并且`xml`是使用 jQuery 从远程文件加载的`dataType: "xml"`，两者都是 XML 文档。

Internet Explorer 中的等价物是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:22:57.653

尝试

```
// code for IE
if (window.ActiveXObject)
 {
 ex=xml.transformNode(xsl);
 document.getElementById("demo").innerHTML=ex;
 }
 // code for Mozilla, Firefox, Opera, etc.
 else if (document.implementation && document.implementation.createDocument)
  {
  xsltProcessor=new XSLTProcessor();
   xsltProcessor.importStylesheet(xsl);
   resultDocument = xsltProcessor.transformToFragment(xml,document);
  document.getElementById("demo").appendChild(resultDocument);
 }
} 
```

# android - 掉线/拦截电话

> ID：13377630
> 
> 赞同：1
> 
> 时间：2012-11-14T11:07:16.660
> 
> 标签：android, telephony

作为我的应用程序的一部分，我需要阻止来电。即当我的应用程序正在运行时，我将挂断任何呼叫并简单地通知呼叫者用户正忙或类似的事情。

我希望使用 android SDK 来做到这一点，我希望支持 Android 2.2 及更高版本。

我已经看过了

[如何阻止android中的呼叫](https://stackoverflow.com/questions/1083527/how-to-block-calls-in-android) （说，我引用“暂时不可能完成任务。”）

[拦截来电](https://stackoverflow.com/questions/3141494/intercept-incoming-calls) （也说不可能）

[我们可以在android中拦截来电吗？](https://stackoverflow.com/questions/8222295/can-we-intercept-incoming-call-in-android) （`telephonyService.endCall();`作为解决方案给出）

[创建自定义呼叫处理应用程序](https://stackoverflow.com/questions/4257242/create-a-custom-call-handling-application) （说不可能）

[https://groups.google.com/forum/?fromgroups=#!topic/android-developers/gc5vOHjBE30](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/gc5vOHjBE30) （讨论似乎没有定论）

但他们似乎没有多大帮助。即使在阅读了很多关于堆栈溢出、谷歌群组和其他论坛的问题之后，我仍然不清楚这是否可能。还有很多问题和线程都超过 2-3 年了，从而增加了我的困惑。

如果这是可能的，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T11:51:39.270

在 android 2.2 删除隐藏的电话接口之后，这似乎是不可能的。

所以是的，“暂时不可能完成任务。”

# jquery - 如何使用 jquery 知道图像是否存在

> ID：13377631
> 
> 赞同：1
> 
> 时间：2012-11-14T11:07:17.707
> 
> 标签：jquery

我有 src 的图像属性。我想知道当我从服务器中删除图像时，它应该显示图像不存在于 alt 属性中。否则它应该显示图像。我正在使用 alert 进行测试，但不知道要使用哪个关键字。

```
<head>
<script type="text/javascript">
$(function(){
alert($('img').attr('src'))     
})
</script>
</head>
<body>
<img src="http://cdn1.iconfinder.com/data/icons/momenticons-gloss-basic/momenticons-gloss-basic/32/information2.png" />
</body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:10:07.120

如果`img`元素 src 返回一个`404`（或除 之外的任何其他 http 结果`200`），它将引发一个`error`您可以捕获的事件。

尝试这个：

```
$("img").error(function(){
    $(this).hide(); // hide image
    // or you can display a generic 'not found' image
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T11:10:16.793

jQuery 允许您为这些情况绑定错误事件处理程序。

您可以执行以下操作：

```
$('img').error(function(){ $(this).hide(); }).attr('alt', 'Does not exist'); 
```

编辑：您可以在这里阅读更多内容：http: [//api.jquery.com/error/](http://api.jquery.com/error/)

# sql - Postgres 更新 x WHERE id IN y

> ID：13377632
> 
> 赞同：3
> 
> 时间：2012-11-14T11:07:23.653
> 
> 标签：sql, postgresql, union, postgresql-performance

以前可能有人问过这个问题，但是在谷歌上搜索“IN”之类的关键字效果并不好。

这是我的查询：

```
UPDATE tblCustomer SET type = 2 
WHERE idcustomer                                
IN (SELECT fidcustomer1
    FROM tblorder                   
     UNION                      
    SELECT fidcustomer2
    FROM tblorder                   
   ) 
```

将其分解：我想将出现在订单表中的所有客户的所有客户的类型（只是一个 int）设置为 2，位于任一列中。

在我的测试数据中，这些表中没有一个包含超过几百行，但是查询运行了很多分钟（即使没有 UNION，这似乎也没有太大区别），显然是重新执行内部查询在客户中每行一次。我显然可以将它重写为一个 SELECT DISTINCT(id)，然后进行几百次单行更新，并以我用于 ODBC 访问的任何语言执行逻辑，但这只是一个 hack。

我怎样才能正确地重写它？

附录：我要更新的表包含很多相对较大的 BYTEA blob，每行几 MB。它们设置为外部存储或扩展，但我想知道这是否会使顺序扫描变慢。所有更新似乎都需要很长时间，而不仅仅是这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:16:13.270

我建议一种更简单的方法：

```
UPDATE tblCustomer c
SET    type = 2 
FROM   tblorder o
WHERE  c.idcustomer IN (o.fidcustomer1, o.fidcustomer2)
AND    c.type IS DISTINCT FROM 2  -- optional, to avoid empty updates 
```

除非，如果 中有**重复项**，`tblorder`那么与您所拥有的类似的方法是明智的：

```
UPDATE tblCustomer c
SET    type = 2 
FROM  (
    SELECT fidcustomer1 AS cust FROM tblorder
    UNION
    SELECT fidcustomer2 FROM tblorder
    ) o
WHERE  c.idcustomer = o.cust
AND    c.type IS DISTINCT FROM 2; 
```

无论哪种方式，在 PostgreSQL 中，加入表通常比`IN`表达式执行得更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T11:43:00.180

```
-------------------------------
-- Use two EXISTS:
-------------------------------
UPDATE tblCustomer tc
SET type = 2
WHERE EXISTS (
    SELECT *
    FROM tblorder ex
    WHERE ex.fidcustomer1 = tc.idcustomer
    )
OR EXISTS (
    SELECT *
    FROM tblorder ex
    WHERE ex.fidcustomer2 = tc.idcustomer
    );

-------------------------------
-- or combine the two EXISTS::
-------------------------------
UPDATE tblCustomer tc
SET type = 2 
WHERE EXISTS (
    SELECT *
    FROM tblorder ex
    WHERE ex.fidcustomer1 = tc.idcustomer
    OR ex.fidcustomer2 = tc.idcustomer
    ); 
```

我的直觉是第一个版本（有两个独立的存在）会表现得更好，因为如果一个存在会产生，执行程序可能会*短路*`True`。这将避免 UNION 构造固有的删除重复阶段（可能还有排序）。

# java - RunWith(PowerMockRunner.class) 不适用于包注释

> ID：13377634
> 
> 赞同：8
> 
> 时间：2012-11-14T11:07:41.950
> 
> 标签：java, junit, annotations, powermock

我试图让 RunWith(PowerMockRunner.class) 与我现有的包注释一起工作。

**版本：**

powermock 1.4.12 mockito 1.9.0 junit 4.8.2

**package-info.java** // 这是用于包注释的

```
@TestAnnotation(version="1.0")
package com.smin.dummy; 
```

**TestAnnotation.java** // 这是包“com.smin.dummy”的元数据注释类

```
package com.smin.dummy;

import java.lang.annotation.*;

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.PACKAGE)
public @interface TestAnnotation {
  String version();
} 
```

**爪哇**

```
package com.smin.dummy;

public class A {
    private static Package myPackage;
    private static TestAnnotation version;

    static {
      myPackage = TestAnnotation.class.getPackage();
      version = myPackage.getAnnotation(TestAnnotation.class);
     }

    public static String getVersion() {
        return version.version();
    }
} 
```

**MockA.java**

```
package com.smin.dummy;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

import com.smin.dummy.A;

@RunWith(PowerMockRunner.class) //comment out this line to see the difference
@PrepareForTest(A.class)
public class MockA {
@Test
public void test_mocked() throws Throwable {
    String thisVersion = A.getVersion();
    System.out.println(thisVersion);
}
} 
```

在 unitest **MockA.java**中，如果我不使用`RunWith(PowerMockRunner.class)`，我将按预期`thisVersion`打印。`0.1`但加起来之后`RunWith(PowerMockRunner.class)`，`thisVersion`就变成了`null`。我怀疑 PowerMockRunner 在这里对包注释做了一些有趣的事情，有人知道吗？请参阅下面我的代码的迷你版：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T15:29:17.380

基于@Alban 在评论中的侦查，似乎将此注释添加到您的测试用例应该可以规避该问题：

```
@PowerMockIgnore("com.smin.dummy.TestAnnotation") 
```

# batch-file - 暂停由tortoiseSVN客户端调用的“on-xxx-yyy-hook”脚本

> ID：13377642
> 
> 赞同：0
> 
> 时间：2012-11-14T11:08:14.213
> 
> 标签：batch-file, tortoisesvn

## 问题

我们有一个批处理脚本，在 post-commit-hook 和 post-update-hook 上调用。如果批处理脚本中发生错误，我们希望暂停脚本或显示输出。

在脚本中的某处发出一个`pause`不会导致从钩子调用时插入暂停。

正常运行脚本会暂停。

是否有可能在钩子脚本中发出暂停？如果是这样，怎么做？还是有其他方法可以在钩子脚本中显示错误？

## 脚本应该做什么？

我们希望在 xx_version.c 文件中包含当前构建的修订号。这是必要的，以便我们的测试人员可以使用某个版本执行他们的测试，并且我们作为开发人员可以继续使用更新的版本，直到他们完成测试，如果有任何问题，我们可以切换回那个版本，看看我们是否可以修复它。但是该修订信息需要存储在软件本身中，即使需要修复“问题”时，我们也可以随时返回某个修订。测试人员将始终使用“夜间构建”来测试软件和硬件。

## 2012-11-16 更新

我们取得了一些进展，但方向完全错误。我们使用 Eclipse 作为 IDE，并且我们希望当我们从 Eclipse 中更新/提交时会执行挂钩。可悲的是，情况并非如此。因此，我们正在寻找其他方式来自动运行这些脚本。提交/更新时最好在 Eclipse 中使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T10:26:02.237

前言：

*   Eclipse SVN 集成与 TortoiseSVN 和 TSVN 客户端钩子无关
*   任何和每个钩子都可以编写自己的日志文件以供以后阅读此日志
*   您可以使用动态获取存储库树的 HEAD 修订版`svn info URL`

如果你真的想要并使用客户端钩子，你不要忘记 TortoiseSVN 中的钩子设置

![在此处输入图像描述](../Images/b31ffbcfce5819600daaffe5371109c6.png)

虽然“等待”在您的情况下没有意义，但不要隐藏输出窗口可能很有用

PS：也许在 Eclipse 中，您只能启动通常的 SVN 脚本，其中**只有退出代码**可用

# python - 使用python将csv单元格格式化为文本

> ID：13377643
> 
> 赞同：3
> 
> 时间：2012-11-14T11:08:14.303
> 
> 标签：python, text, csv, format

我正在提供一行数据以写入 csv 文件。它们大多是浮点型数字。但是当它写入 csv 文件时，单元格默认为自定义格式。所以如果我有一个像 3.25 这样的输入数字，它会打印为“Mar 25”。我怎样才能避免这种情况？
这是一段代码：

```
data = [0.21, 3.25, 25.9, 5.2]  
f = open('Boot.csv','w')  
out = csv.writer(f, delimiter=';', quoting=csv.QUOTE_NONE)  
out.writerow(data) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:12:32.733

该`csv`模块正在很好地写入数据 - 我猜您正在 Excel 中打开它以查看结果，并且 Excel 决定将其自动格式化为日期。

这是一个 excel 问题，您需要通过将其更改为 Text （或任何非通用的）来告诉它不要使用该字段

如果您正在编写 Excel 数据，您可能想查看该`xlwt`模块（查看非常有用的站点[http://www.python-excel.org/](http://www.python-excel.org/)） - 那么您的值类型不会那么容易波动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T12:15:25.467

这不是问题，只是 MS Excel 试图“帮助”。如果您要以编程方式进一步处理输出 csv 文件，则不会有任何问题。

如果您必须在 Excel 中处理/查看数据，您可能需要引用所有数据（通过使用 csv.QUOTE_ALL 而不是 csv.QUOTE_NONE，在这种情况下，Excel 应将所有内容视为文本，而不是试图“有帮助”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:16:58.543

这不是`csv`. `csv`无非是逗号分隔的值。如果你在记事本中打开文件，它会如你所愿。

当您在 excel 中打开它时，它会猜测每个值代表什么，因为此信息不是也不能在 CSV 文件中编码。无论出于何种原因，excel 决定`3.25`代表一个日期，而不是一个数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T15:08:08.767

这不是您编写的代码的问题；它使用 Excel（您可能会使用它来打开 CSV）——它被解释`3.25`为`March 25`. 您可以通过选择受影响的单元格，右键单击并按“设置单元格格式”，然后在“数字”选项卡中选择“数字”作为您的类别来解决此问题，确保显示正确的小数位数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T11:35:52.253

尝试使用不会被误解为日期的格式：

```
out.writerow(['%.12f' % item for item in data]) 
```

这将包括尾随零，因此 Excel 应始终将其解析为数字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-23T12:11:37.383

如果您的所有问题都是 Excel 奇怪地导入 CSV，那么您应该直接编写 XLSX 文件而不是 CSV。这使您可以完全控制单元格内容的解释。

到目前为止，我用 Python 编写 Excel 文件的最佳包是[openpyxl](https://openpyxl.readthedocs.io/en/default/)（甚至被更广泛传播的 xlwt 包的作者推荐[）](https://github.com/python-excel/xlwt)。

取自 openpyxl 文档的一些示例代码：

```
from openpyxl import Workbook
wb = Workbook()

# grab the active worksheet
ws = wb.active

# Data can be assigned directly to cells
ws['A1'] = 42

# Rows can also be appended
ws.append([1, 2, 3])

# Python types will automatically be converted
import datetime
ws['A2'] = datetime.datetime.now()

# Save the file
wb.save("sample.xlsx") 
```

# c++ - 动态插入集合

> ID：13377649
> 
> 赞同：0
> 
> 时间：2012-11-14T11:08:36.173
> 
> 标签：c++, set

我想知道如何动态地将数据插入到集合中。我有一个带有不同点的文本文件，我需要动态插入到集合中，因为我不知道那里会有多少项目。

样本.txt

```
Point [3 4]
Point [5 6] 
```

主文件

```
 set<Point> s_p2;
 if (strData.find("Point") != string::npos) {
   pos = strData.find("t");
   strData = strData.substr(pos + 2, 4);
   istringstream in(strData);
   Point temp_p;
   in >> temp_p;
   s_p2.insert(temp_p);
} 
```

`s_p2`是集合容器，下面的代码集循环到文件末尾。

Q1：如果我这样做，我的套装只有一件还是多件`temp_p`？

Q2：如何打印出集合中的值？

.

```
ostream& operator<<(ostream &out, Point &p2) {
    p2.setDistFrOrigin();
    out << "[" << setw(4) << p2.getX() << setw(1) << "," << setw(4) << p2.getY() << "]   " << setprecision(3) << p2.getScalarValue() << endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:13:24.050

> Q1：如果我这样做，我的套装将只有一项或多项 temp_p

那要看。该集合只会存储唯一 `Point`的 s，因此如果`temp_p`每次都不同，它们都会被存储。a 的“唯一性”`Point`是使用用于集合排序的比较函数确定的。如果不大于且不大于，则两个元素`A`和`B`相等。`A``B``B``A`

> Q2 如何打印出集合中的值？

您应该定义一个`std::ostream& operator<<(std::ostream& os, const Point& p)`运算符，然后使用`std::cout`. 例如：

```
std::ostream& operator<<(std::ostream& os, const Point& p)
{
  return os << p.someMethod() << " " << p.someOtherMethod();
} 
```

然后，

```
std::set<Point> pointSet = ....;
for (std::set<Point>::const_iterator it = pointSet.begin(); 
     it!= pointSet.end(); 
     ++it)
{
  std::cout << *it << "\n";
} 
```

或者，在 C++11 中

```
for (const auto& p : pointSet)
{
  std::cout << p << "\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:17:38.563

假设您的所有代码都有效：

Q1-您将在集合中获得多个项目，因为每次代码运行时，如果创建了新的 temp_p，然后在插入集合时将其复制到集合中

Q2-您可以使用**迭代器**来遍历*集合*并打印其项目：

```
set<Point>::iterator mySetIterator;

for (mySetIterator =  s_p2.begin(); mySetIterator != s_p2.end(); mySetIterator++)
{
   //print mySetIterator, where mySetIterator is a pointer to the n-th value of your set
   cout<<(*mySetIteartor);
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-14T11:41:44.980

> Q1：如果我这样做，我的套装将只有一件或多件`temp_p`

由于您使用的是定义为存储唯一键的集合容器，因此您将获得每个点的唯一值。如果您使用的是多重集，那么您将有多个值。

> Q2 如何打印出集合内的值？

我同意 juanchopanza 写的。

顺便说一句：通过查看您的代码，您读取的每个点，插入的值似乎都是`[3 4`等等。这是您打算做的吗？

# firewall - 防火墙与数据包嗅探器

> ID：13377651
> 
> 赞同：0
> 
> 时间：2012-11-14T11:08:58.577
> 
> 标签：firewall, packet-sniffers

我是计算机网络的新手。我遇到了两个术语防火墙和数据包嗅探器。

对我来说，明智的操作似乎都是一样的。请澄清

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:12:24.843

**防火墙**

防火墙可以是基于软件或基于硬件的，用于帮助保持网络安全。其主要目标是通过分析数据包并确定是否应允许通过来控制传入和传出的网络流量

**嗅探器**

数据包分析器（也称为网络分析器、协议分析器或数据包嗅探器，或对于特定类型的网络，以太网嗅探器或无线嗅探器）是一种计算机程序或一块计算机硬件，可以拦截和记录通过数字网络或网络的一部分

顺便说一句，你也可以查看维基百科...

# performance - MacOS 上奇怪的 fseek()/fwrite() 性能

> ID：13377652
> 
> 赞同：2
> 
> 时间：2012-11-14T11:08:58.560
> 
> 标签：performance, macos, fwrite, performance-testing, fseek

我的Mac上`fseek()`/的写入性能有问题。`fwrite()`我正在处理最大 4 GB 的大文件，下面的测试是用一个只有 120 MB 的相当小的文件进行的。我的策略如下：

*   `fopen()`磁盘上的新文件
*   用零填充文件（大约需要 3 秒）
*   将小块数据写入随机位置（30.000 个块，每个 4k）

整个过程大约需要 120 秒。

写入策略绑定到图像旋转算法（请参阅我的问题[here](https://stackoverflow.com/questions/13358919/how-can-i-speed-up-rotating-a-huge-tiff-by-90-degrees)），除非有人为旋转问题提出更快的解决方案，否则我无法更改使用`fseek()`然后将 4k 或更少写入文件的策略.

我观察到的是：前几千个`fseek()`/`fwrite()`性能相当不错，但性能下降得非常快，比任何系统缓存被填满时所期望的要快。下图显示了`fwrite()`每秒 s 与以秒为单位的时间。如您所见，7 秒后`fseek()`/`fwrite()`速率达到约。每秒 200 次，仍在下降，直到在过程结束时达到每秒 100 次。

![fwrite() 每秒 vs 时间](../Images/4b112de72d53b4fe53d7319cb7179462.png)

在该过程的中间（2 或 3 次），操作系统决定将文件内容刷新到磁盘，我可以从控制台输出中看到它挂了几秒钟，在此期间我大约有。在我的磁盘上写入 5 MB/s（这不算多）。在`fclose()`系统似乎写入整个文件后，我看到 20 MB/s 的磁盘活动持续了更长的时间。

如果我`fflush()`每 5.000`fwrite()`秒使用一次，则行为根本不会改变。放入`fclose()`/`fopen()`强制冲洗以某种方式加速了整个事情。10%。

我确实描述了这个过程（下面的截图），你看，几乎所有的时间都花在了里面`fwrite()`，`fseek()`而且可以深入到`__write_nocancel()`他们两个人身上。

![分析写入函数](../Images/07a210561ba141411923c23276e898af.png)

**完全荒谬的总结**

想象一下我的输入数据完全适合我的缓冲区的情况，因此我能够线性写入我的旋转输出数据，而无需将写入过程分成片段。我仍然使用`fseek()`定位文件指针，只是因为写入函数的逻辑是这样的，但在这种情况下，文件指针被设置到它已经存在的相同位置。人们预计不会对性能产生影响。**错了**。

荒谬的是，如果我删除`fseek()`对该特殊情况的调用，我的函数会在**2.7 秒**内完成，而不是 120 秒。

`fseek()`现在，经过很长的前言，问题是：即使我寻求相同的位置，为什么会对性能产生如此大的影响？我怎样才能加快速度（通过其他策略或其他函数调用，如果可能，禁用缓存，内存映射访问，......）？

作为参考，这是我的代码（未整理，未优化，包含大量调试输出）：

```
-(bool)writeRotatedRaw:(TIFF*)tiff toFile:(NSString*)strFile
{
    if(!tiff) return NO;
    if(!strFile) return NO;

    NSLog(@"Starting to rotate '%@'...", strFile);

    FILE *f = fopen([strFile UTF8String], "w");
    if(!f)
    {
        NSString *msg = [NSString stringWithFormat:@"Could not open '%@' for writing.", strFile];
        NSRunAlertPanel(@"Error", msg, @"OK", nil, nil);
        return NO;
    }

#define LINE_CACHE_SIZE (1024*1024*256)

    int h = [tiff iImageHeight];
    int w = [tiff iImageWidth];
    int iWordSize = [tiff iBitsPerSample]/8;
    int iBitsPerPixel = [tiff iBitsPerSample];
    int iLineSize = w*iWordSize;
    int iLinesInCache = LINE_CACHE_SIZE / iLineSize;
    int iLinesToGo = h, iLinesToRead;

    NSLog(@"Creating temporary file");
    double time = CACurrentMediaTime();
    double lastTime = time;
    unsigned char *dummy = calloc(iLineSize, 1);
    for(int i=0; i<h; i++) fwrite(dummy, 1, iLineSize, f);
    free(dummy);
    fclose(f);
    f = fopen([strFile UTF8String], "w");
    NSLog(@"Created temporary file (%.1f MB) in %.1f seconds", (float)iLineSize*(float)h/1024.0f/1024.0f, CACurrentMediaTime()-time);
    fseek(f, 0, SEEK_SET);

    lastTime = CACurrentMediaTime();
    time = CACurrentMediaTime();
    int y=0;
    unsigned char *ucRotatedPixels = malloc(iLinesInCache*iWordSize);
    unsigned short int *uRotatedPixels = (unsigned short int*)ucRotatedPixels;
    unsigned char *ucLineCache = malloc(w*iWordSize*iLinesInCache);
    unsigned short int *uLineCache = (unsigned short int*)ucLineCache;
    unsigned char *uc;
    unsigned int uSizeCounter=0, uMaxSize = iLineSize*h, numfwrites=0, lastwrites=0;
    while(iLinesToGo>0)
    {
        iLinesToRead = iLinesToGo;
        if(iLinesToRead>iLinesInCache) iLinesToRead = iLinesInCache;

        for(int i=0; i<iLinesToRead; i++)
        {
            // read as much lines as fit into buffer
            uc = [tiff getRawLine:y+i withBitsPerPixel:iBitsPerPixel];
            memcpy(ucLineCache+i*iLineSize, uc, iLineSize);
        }

        for(int x=0; x<w; x++)
        {
            if(iBitsPerPixel==8)
            {
                for(int i=0; i<iLinesToRead; i++)
                {
                    ucRotatedPixels[iLinesToRead-i-1] = ucLineCache[i*w+x];
                }
                fseek(f, w*x+(h-y-1), SEEK_SET);
                fwrite(ucRotatedPixels, 1, iLinesToRead, f);
                numfwrites++;
                uSizeCounter += iLinesToRead;
                if(CACurrentMediaTime()-lastTime>1.0)
                {
                    lastTime = CACurrentMediaTime();
                    NSLog(@"Progress: %.1f %%, x=%d, y=%d, iLinesToRead=%d\t%d", (float)uSizeCounter * 100.0f / (float)uMaxSize, x, y, iLinesToRead, numfwrites);
                }
            }
            else
            {
                for(int i=0; i<iLinesToRead; i++)
                {
                    uRotatedPixels[iLinesToRead-i-1] = uLineCache[i*w+x];
                }
                fseek(f, (w*x+(h-y-1))*2, SEEK_SET);
                fwrite(uRotatedPixels, 2, iLinesToRead, f);
                uSizeCounter += iLinesToRead*2;
                if(CACurrentMediaTime()-lastTime>1.0)
                {
                    lastTime = CACurrentMediaTime();
                    NSLog(@"Progress: %.1f %%, x=%d, y=%d, iLinesToRead=%d\t%d", (float)uSizeCounter * 100.0f / (float)uMaxSize, x, y, iLinesToRead, numfwrites);
                }
            }
        }
        y += iLinesInCache;
        iLinesToGo -= iLinesToRead;
    }

    free(ucLineCache);
    free(ucRotatedPixels);
    fclose(f);

    NSLog(@"Finished, %.1f s", (CACurrentMediaTime()-time));

    return YES;
} 
```

我有点迷茫，因为我不明白系统如何“优化”我的通话。任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T09:34:58.237

只是为了以某种方式结束这个问题，我会自己回答并分享我的解决方案。

尽管我无法提高`fseek()`调用的性能，但我确实实现了一个性能良好的解决方法。`fseek()`目的是不惜一切代价避免。因为我需要将数据片段写入目标文件的不同位置，但这些片段出现的距离相等，并且这些片段之间的间隙将被稍后写入的其他片段填充，我将写入拆分为多个文件。我写入与生成片段流一样多的文件，然后在最后一步中，重新打开所有这些临时文件，旋转读取它们并将数据块线性写入目标文件。这个性能很好，达到大约。上面给出的示例需要 4 秒。

# c - 我做了什么？指向双精度指针的指针？

> ID：13377656
> 
> 赞同：-2
> 
> 时间：2012-11-14T11:09:22.180
> 
> 标签：c, arrays, pointers

出于某种原因，我认为我有 allRates 是 x*y*z 长度指针，指向双精度数，rates 本质上是一个 3 维数组。但我不记得它是如何工作的。

```
// Allocate 3D Rate Array  
 double *allRates = malloc( x*y*z*sizeof(double) );
  if (!allRates) exit(1);
 double ***rates = malloc( x*sizeof(double **) );
  if (!rates) exit(1);

 for(i=0; i<x; i++) {
  rates[i] = malloc(y * sizeof(double *));
// Check rates[i] allocation?
  for(j=0; j<y; j++) {
   rates[i][j] = allRates + (i*y*z) + (j*z);
  }
 } 
```

它运行正常......我只是在处理文档，自三月份以来一直没有处理这部分代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T12:13:59.930

```
// Allocate 3D Rate Array  
 double *allRates = malloc( x*y*z*sizeof(double) );
  if (!allRates) exit(1); 
```

分配一个足够大的内存块来保存`x*y*z`type`double`的值（如果维度足够小；如果乘积的数学结果不能表示为 a `size_t`，它会分配该模的剩余部分`SIZE_MAX + 1`）。

```
 double ***rates = malloc( x*sizeof(double **) );
  if (!rates) exit(1); 
```

分配一块足够大的内存来保存`x`类型的值`double**`（同样，如果`x`足够小）。这些被用作第一维的索引。

```
 for(i=0; i<x; i++) {
  rates[i] = malloc(y * sizeof(double *));
// Check rates[i] allocation? 
```

检查分配绝对是可取的。如果没有失败，每个`rates[i]`都指向一个足够大的内存块来保存`y`指向`double`.

```
 for(j=0; j<y; j++) {
   rates[i][j] = allRates + (i*y*z) + (j*z);
  }
 } 
```

每个`double*`s`rates[i][j]`都指向分配给 的块，在元素`allRates`的偏移处，乘以 -plane 的大小加上乘以-element 行的长度，因此指向plane中 row 的第一个元素。`i*(y*z) + j*z``i``y×z``j``z``rates[i][j]``j``i`

如果 C99 可用，或者`y`是`z`编译时常量，那么通过分配

```
double (*rates)[y][z] = malloc(x * sizeof *rates); 
```

寻址时使用较少的间接寻址。

# python - 如何检查文件是否写入终端？

> ID：13377657
> 
> 赞同：3
> 
> 时间：2012-11-14T11:09:25.377
> 
> 标签：python, unix

有没有办法检查 python 进程的输出是否被写入文件？我希望能够做类似的事情：

```
if is_writing_to_terminal:
    sys.stdout.write('one thing')
else: 
    sys.stdout.write('another thing') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:13:35.343

您可以使用`os.isatty()`来检查文件描述符是否是终端：

```
if os.isatty(sys.stdout.fileno()):
    sys.stdout.write('one thing')
else: 
    sys.stdout.write('another thing') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:13:24.123

使用`os.isatty`. 这需要一个文件描述符 (fd)，它可以通过`fileno`成员获得。

```
>>> from os import isatty
>>> isatty(sys.stdout.fileno())
True 
```

如果您想支持任意文件喜欢（例如`StringIO`），那么您必须检查文件喜欢是否具有关联的 fd，因为并非所有文件喜欢都这样做：

```
hasattr(f, "fileno") and isatty(f.fileno()) 
```

# c#-4.0 - 尝试使用 PetaPoco T4 模板时出错

> ID：13377658
> 
> 赞同：1
> 
> 时间：2012-11-14T11:09:26.797
> 
> 标签：c#-4.0, orm, t4, petapoco

我正在尝试使用 PetaPoco T4 模板（来自 NuGet，版本 4.0.3），但是当我尝试运行模板时出现以下错误：

> 运行转换：System.ArgumentException：不支持 URI 格式。
> 在 System.IO.Path.NormalizePath(String path, Boolean fullCheck, Int32 maxPathLength) 在 System.IO.Path.GetFullPathInternal(String path) 在 System.IO.FileInfo.Init(String fileName, Boolean checkHost) 在 System.IO。 FileInfo..ctor(String fileName) 在 Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation.GetProjectPath() 在 Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation.GetConfigPath() 在 Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation.GetConnectionString(String& connectionStringName, String& providerName) 在Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation.InitConnectionString() 在 Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation.LoadTables() 在 Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation。变换文本（）

在数据库.tt

我不确定我在这里做错了什么..连接字符串已指定并且已在 Database.tt 中正确设置。除了正确的连接字符串之外，使用此 T4 模板是否还有其他要求？

我的 Database.tt 设置如下所示：

```
// Settings
ConnectionStringName = "ConnectionString";
Namespace = "TVPPData";
RepoName = "MyContext";
GenerateOperations = true;
GeneratePocos = true;
GenerateCommon = true;
ClassPrefix = "";
ClassSuffix = "";
TrackModifiedColumns = true; 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:29:20.820

我自己想通了：

事实证明，Petapoco T4 模板不适用于使用其 URL 或 IIS 条目添加到解决方案中的网站项目。我现在已经将该项目重新添加为文件系统项目，现在它工作正常。

# android-webview - 在一个屏幕中显示两个 webview

> ID：13377663
> 
> 赞同：1
> 
> 时间：2012-11-14T11:09:39.263
> 
> 标签：android-webview

我正在尝试制作一个可以在一个屏幕上显示两个网站的 webview 应用程序。但是当我运行我的应用程序时，它会显示一个网站并在新浏览器上打开。我怎样才能显示两个网站，但它在新浏览器上不起作用？这是我的 WebViewActivity 类：

```
 package com.mkyong.android;

    import android.app.Activity;
    import android.os.Bundle;
    import android.webkit.WebView;

   public class WebViewActivity extends Activity {

    private WebView webView1, webView2;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.webview);

        webView1 = (WebView) findViewById(R.id.webView1);
        webView1.getSettings().setJavaScriptEnabled(true);
        webView1.loadUrl("http://www.google.com");
        webView2 = (WebView) findViewById(R.id.webView2);
        webView2.getSettings().setJavaScriptEnabled(true);
        webView2.loadUrl("http://www.google.com");

    }

 } 
```

这是我的 xml 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <WebView
        android:id="@+id/webview1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.39" />

    <WebView
        android:id="@+id/webview2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.53" />

  </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:24:28.293

I suggest you use framelayout and try to set webviewClient to your webview

this function shouldOverrideUrlLoading (in the declaration of the webviewClient)

```
@Override
             public boolean shouldOverrideUrlLoading(WebView view, String url) 
            {
                Log.i("Page", url);
                view.setWebViewClient(new MyWebViewClient());
                view.setWebChromeClient(new MyWebChromeClient());
                view.loadUrl(url);
                return true;
            } 
```

will override url loaded by the webview and force it to be loaded in the webview not in the new browser

# c# - 数据访问层设计：不同的提供者相同的表和单例

> ID：13377666
> 
> 赞同：0
> 
> 时间：2012-11-14T11:09:49.183
> 
> 标签：c#, database, design-patterns, data-access-layer

我需要构建一个数据访问库，以便以后在许多小型应用程序中使用。

它将大量使用 DataReader 对象。SQL Server 或 DB2/400 中的表可能具有相同的结构。这意味着例如一个方法

```
GetItemsByWarehouse() 
```

必须能够针对 SQL Server DB 或 DB2 运行。它将在哪里运行取决于服务器可用性和用户选择。

我打算做的（并且需要建议）是：

1.  实现基于单例设计模式的 DAL，以确保我的库只有一个实例。
2.  具有将设置连接字符串的属性。
3.  如果目标服务器是 AS400 或 SQL，则具有将设置的属性。

我不知道这种做法是否正确。我应该实现第 3 点还是可以从连接字符串中获取类型？

另外我应该如何实现上述方法？检查属性并在方法内部决定我是否会使用`Sqlconnection`等`OleDbConnection`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:50:25.433

我从我的 micro Orm 粘贴此代码。构造函数有多个重载来指定要使用的 Db。

```
 public class DbAccess : IDisposable
{
    public DbAccess()
    {
        var cnx=ConfigurationManager.ConnectionStrings[0];
        if (cnx==null) throw new InvalidOperationException("I need a connection!!!");

        Init(cnx.ConnectionString,ProviderFactory.GetProviderByName(cnx.ProviderName));
    }

    public DbAccess(string connectionStringName)
    {
        var cnx = ConfigurationManager.ConnectionStrings[connectionStringName];
        if (cnx == null) throw new InvalidOperationException("I need a connection!!!");

        Init(cnx.ConnectionString, ProviderFactory.GetProviderByName(cnx.ProviderName));
    }

    public DbAccess(string cnxString,string provider)
    {
        Init(cnxString,ProviderFactory.GetProviderByName(provider));
    }

    public DbAccess(string cnxString,DBType provider)
    {
      Init(cnxString,ProviderFactory.GetProvider(provider));
    }

    public DbAccess(string cnxString,IHaveDbProvider provider)
    {
        Init(cnxString, provider);
    } //other stuff
   } 
```

请注意，DAO (DbAccess) 并不关心具体的提供者。这是 ProviderFactory 的外观。在这里，您可以添加一种方法来检测数据库并返回提供程序。

```
 internal static class ProviderFactory
{
    public static IHaveDbProvider GetProviderByName(string providerName)
    {
        switch (providerName)
        {
            case SqlServerProvider.ProviderName:return new SqlServerProvider();
            case MySqlProvider.ProviderName:return new MySqlProvider();
            case PostgresProvider.ProviderName:return new PostgresProvider();
            case OracleProvider.ProviderName:return new OracleProvider();
            case SqlServerCEProvider.ProviderName:return new SqlServerCEProvider();
            case SqliteProvider.ProviderName:return new SqliteProvider();
        }
        throw new Exception("Unkown provider");
    }

    public static IHaveDbProvider GetProvider(DBType type)
    {
        switch (type)
        {
            case DBType.SqlServer: return new SqlServerProvider();
            case DBType.SqlServerCE: return new SqlServerCEProvider();
            case DBType.MySql: return new MySqlProvider();
            case DBType.PostgreSQL:return new PostgresProvider();
            case DBType.Oracle:return new OracleProvider();
            case DBType.SQLite:return new SqliteProvider();
        }
        throw new Exception("Unkown provider");
    }
} 
```

有关更多代码片段和灵感，您可以查看[Github 存储库](https://github.com/sapiens/SqlFu/tree/master/src/SqlFu)

我建议不要使用单例模式，让 DI 容器来管理实例生命周期要好得多。此外，应用程序应该使用 DAO 的接口而不是具体实例（这将在未来帮助您）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:17:45.140

看看[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)

您可以拥有一个与 DAL 合同的接口以及每个上下文的实现。使用工厂，它可以决定在每种情况下使用哪个实现。工厂将需要“切换规则”来决定使用什么。

# sql - 如何从最大计算中获得完整的行？

> ID：13377668
> 
> 赞同：4
> 
> 时间：2012-11-14T11:10:04.253
> 
> 标签：sql, oracle, join, group-by

我确实与`GROUP BY`- 再次作斗争。我可以处理的基础知识，但就是这样：如何在`group by`不破坏分组的情况下访问我在 中命名的不同列？请注意，这`group by`只是我自己的想法，可能还有其他更好的方法。不过，它必须在 Oracle 中工作。

这是我的例子：

```
create table xxgroups (
  groupid int not null primary key,
  groupname varchar2(10)
);
insert into xxgroups values(100, 'Group 100');
insert into xxgroups values(200, 'Group 200');

drop table xxdata;
create table xxdata (
  num1 int,
  num2 int,
  state_a int,
  state_b int,
  groupid int,
    foreign key (groupid) references xxgroups(groupid)
);
-- "ranks" are 90, 40, null, 70:
insert into xxdata values(10, 10, 1, 4, 100);
insert into xxdata values(10, 10, 0, 4, 200);
insert into xxdata values(11, 11, 0, 3, 100);
insert into xxdata values(20, 22, 5, 7, 200); 
```

任务是为每个结果行创建一个结果行，`distinct (num1, num2)`并打印从和中`groupname`计算出的最高“排名” 。`state_a``state_b`

> 请注意，前两行具有相同`num`的 s，因此只应选择较高的排名——即`groupname`“Group 200”。

我认为，我对基本的了解已经很远了`group by`。

```
SELECT xd.num1||xd.num2 nummer, max(ranking.goodness)
FROM xxdata xd
    , xxgroups xg
    ,( select state_a, state_b, r as goodness
       from dual
       model return updated rows
       dimension by (0 state_a, 0 state_b) measures (0 r)
       rules (r[1,4]=90, r[3,7]=80,r[5,7]=70, r[4,7]=60, r[0,7]=50, r[0,4]=40)
       order by goodness desc
      ) ranking
WHERE xd.groupid=xg.groupid
  and ranking.state_a (+) = xd.state_a
  and ranking.state_b (+) = xd.state_b
GROUP BY xd.num1||xd.num2
ORDER BY nummer
; 
```

结果是我需要的 90%：

```
nummer   ranking
----------------
1010     90
1111      
2022     70 
```

100％完美将是

```
nummer   groupname
-------------------
1010     Group 100
1111     Group 100
2022     Group 200 
```

*   棘手的部分是，我想要`groupname`结果。而且我不能将它包含在 中`select`，因为那样我就*必须*将它也放入其中`group by`- 这是我*不*想要的（然后我不会从所有组中选择最佳排名条目）
*   在我的解决方案中，使用`model`表格来计算“排名”。我确定还有其他解决方案。关键是，这是一个我不想做两次的重要计算。
*   我从其他示例中知道，可以使用第二个查询返回到原始行以访问`groupname`，但我看不到如何在不重复排名计算的情况下在这里做到这一点。
*   一个不错的建议是`group by`用`LIMIT 1`/替换`ORDER BY goodness`并将此计算选择用作过滤子选择。但是a）在Oracle中没有`LIMIT`，我怀疑a`rownum<=1`会在子选择中做，b）无论如何我都无法绕开它。也许有办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T12:05:45.893

您可以使用[`FIRST`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions065.htm#i1000901)聚合修饰符有选择地将您的函数应用于组的一部分行 - 这里是单行（[SQLFiddle 演示](http://sqlfiddle.com/#!4/fd0f8/14)）：

```
SELECT xd.num1||xd.num2 nummer, 
       MAX(xg.groupname) KEEP (DENSE_RANK FIRST 
                               ORDER BY ranking.goodness DESC) grp,
       max(ranking.goodness)
FROM xxdata xd
    , xxgroups xg
    ,( select state_a, state_b, r as goodness
       from dual
       model return updated rows
       dimension by (0 state_a, 0 state_b) measures (0 r)
       rules (r[1,4]=90, r[3,7]=80,r[5,7]=70, r[4,7]=60, r[0,7]=50, r[0,4]=40)
       order by goodness desc
      ) ranking
WHERE xd.groupid=xg.groupid
  and ranking.state_a (+) = xd.state_a
  and ranking.state_b (+) = xd.state_b
GROUP BY xd.num1||xd.num2
ORDER BY nummer; 
```

您的分析方法也适用，但由于我们已经在这里使用了聚合，我们不妨使用`FIRST`修饰符一次性获取所有列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:39:10.983

哇，我以前搜索过，但现在我找到[了这个答案](https://stackoverflow.com/a/10670844/472245)，我可以采用它来回答我的问题。这里的Oracle 解决方案是`over`,`partition by`和:`order by``row_number()`

```
select *
from ( select data.*, row_number()
         over (partition by nummer order by goodness desc) as seqnum
from (
SELECT xd.num1, xd.num2 nummer, xg.groupname, ranking.goodness
FROM xxdata xd
    , xxgroups xg
    ,( select state_a, state_b, r as goodness
       from dual
       model return updated rows
       dimension by (0 state_a, 0 state_b) measures (0 r)
       rules (r[1,4]=90, r[3,7]=80,r[5,7]=70, r[4,7]=60, r[0,7]=50, r[0,4]=40)
      ) ranking
WHERE xd.groupid=xg.groupid
  and ranking.state_a (+) = xd.state_a
  and ranking.state_b (+) = xd.state_b
ORDER BY nummer
) data )
where seqnum = 1
; 
```

结果是

```
 10         10 Group 100          90          1
    11         11 Group 100                      1
    20         22 Group 200          70          1 
```

这是美丽的。

现在我必须尝试理解究竟是`over`什么`select`......

# matlab - 隐马尔可夫模型工具箱/库

> ID：13377669
> 
> 赞同：2
> 
> 时间：2012-11-14T11:10:05.757
> 
> 标签：matlab, image-processing, signal-processing, hidden-markov-models

我现在正在尝试在我的项目中使用隐藏马尔可夫模型，我在网上搜索了很多隐藏马尔可夫模型的实现，无论是在 MATLAB 还是在 C/C++ 中。事实上，Matlab 提供了一个统计工具箱，其中包括一个隐马尔可夫模型的实现。我是这个领域的新手，我想知道哪个工具箱或库是最好的。购买隐马尔可夫模型的统计工具箱是否明智？此外，我计划在图像处理的背景下使用这个模型。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:18:49.417

首先你必须先了解隐马尔可夫模型

这是一篇关于语音识别的隐马尔可夫模型的好论文

> [http://www.ece.ucsb.edu/Faculty/Rabiner/ece259/Reprints/tutorial%20on%20hmm%20and%20applications.pdf](http://www.ece.ucsb.edu/Faculty/Rabiner/ece259/Reprints/tutorial%20on%20hmm%20and%20applications.pdf)

matlab实现可以参考matlab官方文档

> [http://www.mathworks.com/help/stats/hidden-markov-models-hmm.html](http://www.mathworks.com/help/stats/hidden-markov-models-hmm.html)

如果你想在 C 中实现它，你可以在这里看到一个很好的例子

> [http://www.codeproject.com/Articles/69647/Hidden-Markov-Models-in-C](http://www.codeproject.com/Articles/69647/Hidden-Markov-Models-in-C)

如果你想问我一些关于隐马尔可夫模型的问题，我很乐意帮助你，但我认为你应该先了解基本的，然后如果你有任何问题可以在评论中问我或给我发电子邮件（你可以看到它在我的个人资料中）我希望这个答案对你有帮助:)

# python - 使用 webclient.Agent 时，connectionLost 可能出现哪些异常？

> ID：13377673
> 
> 赞同：2
> 
> 时间：2012-11-14T11:10:16.963
> 
> 标签：python, http, twisted, webclient

我已经使用 webclient.Agent 编写了一个 http 下载器。

主体消费者对象的 connectionLost 函数使用原因参数调用。

```
def connectionLost(self, reason):
    if isinstance(reason.value, ResponseDone):
        self.df.callback(None)
    else:
        self.df.errback(reason.value) 
```

我真的很想知道“原因”中可能的异常类是什么，因为我需要将它们全部捕获并稍后在使用 inlineCallbacks 的调用函数中处理它们。到目前为止，我确定：

`ConnectError, BindError, ConnectionClosed, ResponseFailed`

这是在某处记录的吗？大多数文档只包含含糊的“...errback with a description of the error ...”语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T17:28:45.767

你不需要专门捕捉它们。异常处理尊重继承：如果你试图捕捉一个基类并引发了一个子类，你也会捕捉到它。 `Exception`是 Python 中几乎所有异常的基类，所以如果你抓住了它，你就会抓住几乎所有的东西。

```
try:
    yield agent.request(...)
except Exception as e:
    print 'Oh no, some failure'
else:
    print 'Success' 
```

没有所有例外的完整列表`Agent.request`可能会失败，因为不可能提前知道这个列表。失败可能是由于连接设置 - 但它是普通 TCP 连接还是 HTTPS URL 的 SSL 连接？由于不幸的用户网络配置，可能是通过 SOCKS 代理建立的连接。这些都可能以不同的方式失败。这同样适用于实际的 HTTP 请求本身——谁知道服务器的行为？也许它会响应一个意外的错误代码，或者它会响应一些 Agent 甚至无法解析并触发低级 HTTP 客户端协议实现的异常。解析器是手工制作的，所以可能有很多不同的异常可能来自这种问题。然后是内容和传输编码的变化，

因此，与其尝试在您使用的每个地方都列出所有这些异常的完整列表，不如`Agent.request`只专门处理您知道的异常类型并为其编写特殊代码，然后使用`except Exception`.

# mysql - 仅使用 JSTL 时出错（未找到适合数据源的驱动程序）

> ID：13377675
> 
> 赞同：0
> 
> 时间：2012-11-14T11:10:20.443
> 
> 标签：mysql, sql, servlets, jstl, sqldatasource

我在 Servlet 中使用此代码来使用数据库：

```
Class.forName("com.mysql.jdbc.Driver");
DriverManager.getConnection("jdbc:mysql://localhost/petshop", user, password); 
```

它工作正常。现在我正在尝试做同样的事情，但使用 JSTL：

```
<sql:setDataSource var="connection" driver="com.mysql.jdbc.Driver" url="jdbc:mysql://localhost/petshop" user="root" password="admin" scope="page" /> 
```

但后者不起作用。我不明白。我的错误在哪里？

更准确地说，错误是：

> 无法获得连接，DataSource 无效：“java.sql.SQLException：找不到适合连接的驱动程序”

# php - php代码头的效率

> ID：13377676
> 
> 赞同：0
> 
> 时间：2012-11-14T11:10:21.817
> 
> 标签：php, wordpress

这段代码不是最优的，我正在努力寻找更好的方法。

基本上，您单击一个按钮，该按钮将 ajax 请求发送到下面列出的此文件，该文件从 WordPress 数据库中获取随机帖子。很多时候这些重复并且给人的印象是它不起作用，为了解决这个问题，我检查了当前 id = 旧 id，如果它们相同，则获得一个新帖子，但是我还没有找到在其中运行另一个 wpquery 的方法另一个查询。

```
<?php
    require_once('../../../wp-blog-header.php');
    header('HTTP/1.1 200 OK');
?>
    <span id="postss"><?php
        query_posts(array(
            'cat' => 39,
            'order' => 'ASC', // ASC
            'orderby' => 'rand',
            'showposts' => 1,
            ));
        $wp_query->is_archive = true; $wp_query->is_home = false;
        if (have_posts()) : while (have_posts()) : the_post();

        session_start();
        if(!isset($_SESSION['oldId']))
        {
            $_SESSION['oldId'] = get_the_id();
        }else{
            $curId = get_the_id();
            if($_SESSION['oldId'] == $curId)
            {
                header("Location: http://website.com/testimonialPull.php");     
            }else{

    the_content();
        }
        $_SESSION['oldId'] = get_the_id();
    }

    endwhile; endif;

?> 
```

因此，发送标头请求大约需要 1 秒才能显示新帖子，而通常大约需要 2/10 秒。有没有更有效和更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:45:36.490

只需像这样修改您的`query_posts()`电话：

```
$args = array(
    'cat' => 39,
    'order' => 'ASC', // ASC
    'orderby' => 'rand',
    'showposts' => 1,
);
if ( isset( $_SESSION['oldId'] ) {
    $args['post__not_in'] = array( $_SESSION['oldId'] );
}
query_posts( $args ); 
```

该`post__not_in`参数指定将从查询中排除的 ID 数组。

如果您想阅读有关`WP_Query`该类及其接受的参数的更多信息（那些与接受的参数匹配`query_posts()`） - 请参阅 codex 页面 - [Class Reference/WP Query](http://codex.wordpress.org/Class_Reference/WP_Query)。

PP：我不明白为什么你不只是在`init`动作钩子上挂钩一个函数并进行查询`http://website.com/?pullTestimonial=1`（我不确定这是否会减慢完成过程，但这通常是我实现这一点的方式）

这是一个示例代码：

```
function fetch_testimonial() {
    if ( isset( $_GET['pullTestimonial'] ) ) {
        // Your code that will be executed goes here
        exit;
    }
}
add_action('init', 'fetch_testimonial', 10); 
```

您从中获得的好处是您不需要在根目录中的某处有文件，否则您的链接不会像[http://website.com/wp-content/themes/mytheme/testimonialPull.php](http://website.com/wp-content/themes/mytheme/testimonialPull.php)

# c - 未唤醒多进程设置中处于等待条件的线程

> ID：13377677
> 
> 赞同：1
> 
> 时间：2012-11-14T11:10:29.277
> 
> 标签：c, linux, synchronization, pthreads, wait

在 Linux 上使用来自 pthread 的等待条件和互斥锁在进程之间进行同步时，我遇到了一个奇怪的问题。请注意，这不仅仅在一个进程中的线程之间。

我的用例是有一个生产者创建资源（在我的例子中是图像），将它们保存到共享内存区域，更新有关资源的一些信息，然后向等待的消费者发出信号。共享内存和元数据部分工作正常，所以我会忽略它，问题是信号不能可靠地工作。用例很简单，消费者错过一两张图片并不重要，如果消费者还没有时间阅读，生产者基本上只是覆盖一张旧图片。所以等待条件只需要处理唤醒消费者，我不需要任何资源计数或其他数据。

生产者和消费者都有这样的结构：

```
struct EventData {
    pthread_mutex_t mutexHandle;
    pthread_cond_t  conditionHandle;
}; 
```

消费者进程中的一个线程坐下来等待某事发生：

```
pthread_mutex_lock( &eventData->mutexHandle );
pthread_cond_wait( &eventData->conditionHandle, &eventData->mutexHandle );
thread_mutex_unlock( &eventData->mutexHandle ); 
```

生产过程在创建图像、将其保存到共享内存并准备好让消费者抓取图像时执行此操作：

```
pthread_mutex_lock( &eventData->mutexHandle );
pthread_cond_signal( &eventData->conditionHandle );

// also tried:
//pthread_cond_broadcast( &eventData->conditionHandle );
pthread_mutex_unlock( &eventData->mutexHandle ); 
```

这对我来说看起来很不错，并且在某种程度上有效。生产者可以毫无问题地向消费者发出大约 100-1000 次信号，消费者醒来，抓取图像并显示它，结果是我可以看到移动的视频。在某些时候，通常大约几百帧，消费者将在 pthread_cond_wait() 中冻结并且永远不会返回。生产者仍然愉快地创建图像，调用 pthread_cond_signal() 并继续没有问题。消费者没有完全冻结，只有执行 pthread_cond_wait() 的线程，应用程序的其余部分运行没有问题。

因此，当信号从一个线程移动到另一个进程中的另一个线程时，某些东西会导致信号丢失。消费者冻结之前通常需要 5-20 秒，并且唤醒工作的次数也在 100 到 1000 之间变化（基于目前看到的值）。

由于默认情况下在进程之间共享互斥锁和等待条件并非易事，因此我使用此设置来创建原语：

```
 EventData * eventData;

    int fd = open( tmpnam(NULL), O_RDWR | O_CREAT | O_EXCL, 0666);
    if (fd < 0) {
        // failed to open file for event
    }

    if ( ftruncate(fd, sizeof (eventData )) < 0 ) {
        // failed to truncate file
    }

    // setup attributes to allow sharing between processes
    pthread_condattr_init( &conditionAttribute );
    pthread_condattr_setpshared( &conditionAttribute, PTHREAD_PROCESS_SHARED );
    pthread_mutexattr_init( &mutexAttribute );
    pthread_mutexattr_setpshared( &mutexAttribute, PTHREAD_PROCESS_SHARED );

    // map memory for the event struct
    eventData = (EventData *) mmap(NULL, sizeof(EventData), PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
    close (fd);

    // finally initialize the memory
    pthread_mutex_init( &eventData->mutexHandle, &mutexAttribute );
    pthread_cond_init( &eventData->conditionHandle, &conditionAttribute ); 
```

以上是由创建互斥锁和等待条件的一方完成的。文件的名称，即 tmpnam(NULL) 实际上已保存并传递给其他进程以进行打开：

```
 int fd = open( nameOfEventFile, O_RDWR, 0666 );
    if (fd < 0) {
        // failed to open file for event
    }

    eventData = (EventData *) mmap( NULL, sizeof(EventData), PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0 );
    close( fd ); 
```

我在这里没有看到任何错误，并希望得到一些关于可能出错的提示，特别是因为它在一些随机时间工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:14:24.947

一旦我写了 95% 的问题，这个错误就让我眼前一亮……我仍然决定把它和修复一起放在这里，以防其他人偶然发现类似的东西。创建互斥锁和等待条件的部分如下所示：

```
EventData * eventData;

int fd = open( tmpnam(NULL), O_RDWR | O_CREAT | O_EXCL, 0666);
if (fd < 0) {
    // failed to open file for event
}

if ( ftruncate(fd, sizeof (eventData )) < 0 ) {
    // failed to truncate file
} 
```

如果您仔细看，您会发现 ftruncate() 截断为 eventData 指针的大小，而不是 struct EventData 的大小。所以，这里需要的一个字符修复是：

```
if ( ftruncate(fd, sizeof (EventData )) < 0 ) {
    // failed to truncate file
} 
```

确实是愚蠢的错误。

# php - 在其他变量名称中使用变量 - PHP

> ID：13377680
> 
> 赞同：0
> 
> 时间：2012-11-14T11:10:33.183
> 
> 标签：php

看到这个：

```
 $q = 'blah';
        for($k = 0; $k < count($results_array); $k++){
            $results_array_ . $k = explode(',', $results_array[$k]);
            foreach($results_array_ . $k as $key => $value){
                if (stripos($value, $q) === false) {
                unset($results_array_ . $k[$key]);
                break;
                }
            }
        } 
```

在第 3 行，我只是使用“$results_array_ . **$k** ”，它工作得很好，但在第 6 行，我在“unset($results_array_ . **$k** [$key])”上遇到 PHP 解析错误，为什么这发生了？

我感谢任何帮助

* * *

为什么我这样做：

我有一个名为 results_array 的数组：

```
var_dump($results_array):
0 => php,mysql,jquery,ruby,html,css,lamp
1 => mouse,keyboard,laptop,pad
2 => table,sofa,caption 
```

我有一个 $q 代表查询，我想在 $results_array 中搜索并删除与查询无关的项目，所以如果我设置**$q=a**那么结果数组应该是这样的：

```
0 => lamp
1 => keyboard,laptop,pad
3 => table,sofa,caption 
```

现在，我想把上面的结果放在results_array的每个索引中，最后results_array应该是：

```
0 => lamp
1 => keyboard
2 => laptop
3 => pad
4 => table
5 => sofa
6 => caption 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:14:48.633

### 回答原始问题

`unset`期望其参数是对值的直接引用，例如`$var`or `$array['key']`。如果要根据其他值动态创建参数，则必须使用[变量变量](http://php.net/manual/en/language.variables.variable.php)语法：

```
unset(${$results_array_ . $k[$key]}); 
```

这将消除警告，但它仍然不会使代码工作，因为它存在根本缺陷。您提到的第 3 行内容如下：

```
$results_array_ . $k = explode(',', $results_array[$k]); 
```

它所做的是将一个数组分解为`$k`然后连接`$results_array_`并`$k`...丢弃结果。你可以很容易地写

```
$k = explode(',', $results_array[$k]); 
```

并且它的工作方式相同（除非可能不给出不存在的内容）`E_NOTICE`。`$_results_array_`

因此，您似乎对某些 PHP 基础知识的工作方式存在误解。最好你问另一个问题来解释*你正在尝试做什么*，以确定什么是做这件事的好方法。

### 回答当前问题

让我们一步一步来：

1.  取出字符串数组并将每个字符串转换为一个数组`explode`，形成一个数组数组。您可以使用[`array_map`](http://php.net/manual/en/function.array-map.php)或简单的`foreach`.
2.  将数组“展平”成一个大数组。[`array_merge`](http://php.net/manual/en/function.array-merge.php)你可以用or来做这个[`array_merge_recursive`](http://php.net/manual/en/function.array-merge-recursive.php)（细节会有点不同，想法是一样的）。
3.  搜索展平的数组并用 过滤掉不感兴趣的元素[`array_filter`](http://php.net/manual/en/function.array-filter.php)。
4.  如有必要，重新索引过滤后的数组，使其具有连续的数字键[`array_values`](http://php.net/manual/en/function.array-values.php)。

这是执行此操作的代码，尽管略有不同（我在第一行同时使用 执行步骤 1 和 2 [`array_reduce`](http://php.net/manual/en/function.array-reduce.php)）：

```
$array = (...);
$array = array_reduce($array, function(&$result, $item) {
    return array_merge($result, explode(',', $item));
}, array());
$array = array_filter($array, function($item) use ($string) { 
    return strpos($item, $string) !== false;
});
$result = array_values($array); 
```

一个不使用花哨功能的版本：

```
// Step 1
foreach($array as &$row) {
    $row = explode(',', $row);
}
unset($row);

// Step 2
$array = call_user_func_array('array_merge_recursive', $array);

// Step 3
foreach ($array as $k => $v) {
    if(strpos($v, 'a') === false) unset($array[$k]);
}

// Step 4
$array = array_values($array); 
```

# jquery - JQuery 检查返回的响应是 JSON

> ID：13377681
> 
> 赞同：0
> 
> 时间：2012-11-14T11:10:34.083
> 
> 标签：jquery

我可以获得 2 个响应标头来处理。看到底。

**问题：**

*如果我得到 JSON 响应而不是需要执行`postValidation`函数来处理 JSON，但如果它是 html 则不执行。我可以解决这个检查 html 标记以停止执行，但寻找任何干净的方法来检查返回的响应是有效的 JSON 并在 AJAX 调用中停止函数执行。*

**getValidationErrors**总是返回 NULL。不知道为什么。如果你能告诉我有什么问题，请。

```
 $.ajax({
                        url: url,
                        type: 'POST',
                        data: viewData,
                        //dataType: "json",
                        cache: false,
                        complete: postValidation,
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            console.log("error :"+XMLHttpRequest.responseText);
                        }
                       /* ,
                        success: function (data) {
                            $("#status").html('name = ' + data.name + ', age = ' + data.age);
                        }*/
                    });

function postValidation(request) {
                clearValidationErrors();

                var text = request.responseText;
                var errorsObject = getValidationErrors(text);

                //var errorsObject = JSON.parse(request.responseText);
            };

var getValidationErrors = function(data) {
                if (typeof data === "object") {
                    alert("1");
                    return data;
                }
                else {
                    if (data.indexOf("/* {") === 0) {
                        alert("2");
                        return eval("( " + data.substring(2, data.length - 2) + " )");
                    } else {
                        alert("3");
                        return null;
                    }
                }
            }; 
```

**请求 1：响应标头**

```
Content-Type    application/json;charset=UTF-8

{ "fieldErrors": {"name":["You must enter your name"],"age":["Only people ages 13 to 19 may take this quiz"]}} 
```

**请求 2：响应标头**

```
Content-Type    text/html;charset=UTF-8

<html>
<head>
    <title></title>
</head>
<body>

</body>
</html> 
```

# dll - 静态链接到 xcode 4.5 中的 .dylib 错误

> ID：13377683
> 
> 赞同：1
> 
> 时间：2012-11-14T11:10:42.277
> 
> 标签：dll, xcode4, static-libraries

我正在尝试使用 FMOD，我正在重新创建示例项目之一。当程序加载时，它说

```
 dyld: Library not loaded: ./libfmodex.dylib
  Referenced from:     (...project filepath...)
  Reason: image not found 
```

我通过构建目标的阶段、使用二进制文件扩展链接、单击 + 号、单击其他，然后导航到 libfmodex.dylib 来进行链接。然后它会自动填写库搜索路径。

程序构建并运行，但立即停止并显示上述错误消息。是否有某种我缺少的编译器标志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T14:31:59.007

我在其他地方发现它需要添加一个构建脚本（目标->构建阶段->添加构建阶段->运行脚本）

```
cp "/absolute/filepath/of/your/libfmodex.dylib" .
cp -f "$TARGET_BUILD_DIR/$PRODUCT_NAME" .
cp "/absolute/filepath/of/your/libfmodex.dylib" "$TARGET_BUILD_DIR" 
```

# php - 无法将新模型添加到 opencart

> ID：13377684
> 
> 赞同：0
> 
> 时间：2012-11-14T11:10:51.330
> 
> 标签：php, opencart

我a，尝试对opencart中的注册过程进行修改。我已经修改了视图中的表单，并将值发布到 account/customer.php 模型中，我在其中添加了一些代码来处理我的新字段，如下所示：

```
/* add children and links to product categories */
    $this->load->model('account/children');
    //loop childrens names to use key for remaining info
    foreach($data['children-name'] as $key=>$name){
        //re-assign data and purify
        $child['name'] = mysql_real_escape_string($name);
        $child['surname'] = mysql_real_escape_string($data['children-surname'][$key]);
        $child['gender'] = mysql_real_escape_string($data['children-gender'][$key]);
        $child['dob'] = mysql_real_escape_string($data['children-dob'][$key]);
        $child['school'] = mysql_real_escape_string($data['children-school'][$key]);
        $child['unit'] = mysql_real_escape_string($data['children-unit'][$key]);
        $child['height'] = mysql_real_escape_string($data['children-height'][$key]);
        $child['chest'] = mysql_real_escape_string($data['children-chest'][$key]);
        $child['waist'] = mysql_real_escape_string($data['children-waist'][$key]);
        $child['waistToKnee'] = mysql_real_escape_string($data['children-waist-to-knee'][$key]);
        $child['insideLeg'] = mysql_real_escape_string($data['children-inside-leg'][$key]);
        $child['shoeSize'] = mysql_real_escape_string($data['children-shoe-size'][$key]);
        $child['customerId'] = $customer_id;

        //update/create child record
        $this->model_account_children->addChild($child);
    }
    /* end add children and links to product categories */ 
```

然后我在 account/children.php 中创建了相关模型文件，其中包含以下代码：

```
class ModelAccountChildren extends Model {
    public function addChild($data) {
        //create other fields not in $data
        $lastUpdated = date('Y-m-d h:i:s');
        $childCat = getChildCategory($data['school']);
        $dob = date('Y-m-d h:i:s', $date['dob']);
        if($data['gender'] == 'm'){
            $data['gender'] = 'Male';
        }else{
            $data['gender'] = 'Female';
        }
        echo "INSERT INTO " . DB_PREFIX . "customer_children (customer_id, child_name, child_surname, child_gender, child_dob, category_id, child_school, child_unit, child_height, child_chest, child_waist, child_waist_to_knee, child_inside_leg, child_shoe_size, child_last_updated) VALUES (".$data['customerId'].", '".$data['name']."', '".$data['surname']."', '".$data['gender']."', '".$dob."', ".$childCat['category_id'].", '".$data['school']."', '".$data['unit']."', '".$data['unit']."', '".$data['height']."', '".$data['chest']."', '".$data['waist']."', '".$data['waistToKnee']."', '".$data['insideLeg']."', '".$data['shoeSize']."', '".$lastUpdated."')";
        //perform insert
        $this->db->query("INSERT INTO " . DB_PREFIX . "customer_children (customer_id, child_name, child_surname, child_gender, child_dob, category_id, child_school, child_unit, child_height, child_chest, child_waist, child_waist_to_knee, child_inside_leg, child_shoe_size, child_last_updated) VALUES (".$data['customerId'].", '".$data['name']."', '".$data['surname']."', '".$data['gender']."', '".$dob."', ".$childCat['category_id'].", '".$data['school']."', '".$data['unit']."', '".$data['unit']."', '".$data['height']."', '".$data['chest']."', '".$data['waist']."', '".$data['waistToKnee']."', '".$data['insideLeg']."', '".$data['shoeSize']."', '".$lastUpdated."')");
    }

    public function updateChild($data) {

    }

    public function getChildCategory($childSchoolStr){
        $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "category_description WHERE name LIKE '" . $childSchoolStr . "'");

        return $query->row;
    }
} 
```

由于某种原因，脚本在我在 model/account/customer.php 中调用它时无法访问新模型：

```
$this->load->model('account/children'); 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T13:36:15.290

解决了伙计们。

```
$childCat = getChildCategory($data['school']); 
```

有点脑残，上面的行应该是：

```
$childCat = $this->getChildCategory($data['school']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:07:55.017

这对我来说似乎是正确的。您可以在模型中使用它。你使用 vqmod 吗？尝试删除缓存文件。也许在你的模型中添加一个测试函数，看看你可以调用它。你得到什么错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T12:09:24.140

你确定把文件放进去`catalog/model/account/children.php`吗？如果是这样，您是否收到任何有助于调试的错误消息？另外，当您运行代码时，您确定其中`$data['children-name']`包含数据吗？

# java - GWT：完成对象并删除其事件处理程序

> ID：13377685
> 
> 赞同：1
> 
> 时间：2012-11-14T11:10:55.420
> 
> 标签：java, events, gwt, event-handling

在 GWT 中，我有`MyClass`注册一些事件处理程序的类。有一个对象 ( `object1`) `MyClass`，在特定时刻，我想完成并使其处理程序停止侦听，因为之后我将创建一个不同的`MyClass`对象 ( `object2`)。

我怎样才能做到这一点？我已经尝试过`object1 = null`，但它的处理程序一直在听（至少有一段时间）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T12:30:49.033

处理程序可能仍然存在，因为 gc 没有绕过销毁它们。如果侦听器不继续存在很重要，则需要注销它们。

一种方法是取消注册 HandlerRegistration。例如，[addClickHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/FocusWidget.html#addClickHandler%28com.google.gwt.event.dom.client.ClickHandler%29)返回一个可以取消注册的[HandlerRegistration 。](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/event/shared/HandlerRegistration.html)何时以及如何执行此操作取决于您的 GUI 类。您可以将注销放在您的 finalize 方法中，但您可能会发现这些方法被非常偶尔地调用，因为 gc 并且当然因为这不是 java 而是 javaScript。[因此，请考虑将它们放在您的 gui 元素onDetach](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/Widget.html#onDetach%28%29)或[onUnload](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/Widget.html#onUnload%28%29)的分离或破坏方法中。

# android - AChartEngine 多个 Y 轴重叠值

> ID：13377687
> 
> 赞同：1
> 
> 时间：2012-11-14T11:11:06.137
> 
> 标签：android, axis, overlap, achartengine

我使用 AChartEngine 作为库来绘制我的折线图。该折线图由多个 Y 轴（3-5 轴）组成，并在 X 轴上的时间线上。

我的问题是，Y 轴值重叠（见图）

这是我的代码：

```
//Puls, Geschwindigkeit und Hoehenmeter dem Diagramm hinzufugen
        HashMap<Long, Heartrate> heartrateMap = trainingLog.getHeartrateList();
        HashMap<Long, GPS> gpsMap = trainingLog.getGpsList();
        //Puls, Geschwindigkeit und Hoehenmeter dem Diagramm hinzufugen
        XYSeries heartrateSeries = new XYSeries("Puls", 0);
        XYSeries altitudeSeries = new XYSeries("Höhenmeter", 1);
        XYSeries speedSeries = new XYSeries("Geschwindigkeit", 2);

        for(int i=0; i<trainingLog.getDuration(); i++){
            Heartrate heartrate = heartrateMap.get(Long.valueOf(i));
            if(heartrate != null){
                heartrateSeries.add(i, heartrate.getHeartrate());
            }

            GPS gps = gpsMap.get(Long.valueOf(i));
            if(gps != null){
                altitudeSeries.add(i, gps.getAltitude());
                speedSeries.add(i, gps.getSpeed());
            }
        }

        XYMultipleSeriesDataset dataSet = new XYMultipleSeriesDataset();
        dataSet.addSeries(0, heartrateSeries);
        dataSet.addSeries(1, altitudeSeries);
        dataSet.addSeries(2, speedSeries);

        XYMultipleSeriesRenderer multiRenderer = new XYMultipleSeriesRenderer(3);

        //Renderer fuer Pulswerte
        XYSeriesRenderer rendererHeartrate = new XYSeriesRenderer();
        rendererHeartrate.setColor(Color.RED);
        multiRenderer.addSeriesRenderer(rendererHeartrate);
        //Renderer fuer Hoehenmeter
        XYSeriesRenderer rendererAltitude = new XYSeriesRenderer();
        rendererAltitude.setColor(Color.BLUE);
        multiRenderer.addSeriesRenderer(rendererAltitude);
        //Renderer fuer Geschwindigkeit
        XYSeriesRenderer rendererSpeed = new XYSeriesRenderer();
        rendererSpeed.setColor(Color.DKGRAY);
        multiRenderer.addSeriesRenderer(rendererSpeed);

        //Hintergrundfarbe weiß setzen
        multiRenderer.setApplyBackgroundColor(true);
        multiRenderer.setBackgroundColor(Color.WHITE);
        multiRenderer.setMarginsColor(Color.argb(0x00, 0x01, 0x01, 0x01));

        //Label--Einstellungen
        multiRenderer.setYLabelsColor(0, Color.RED);
        multiRenderer.setYLabelsColor(1, Color.BLUE);
        multiRenderer.setYLabelsColor(2, Color.DKGRAY);
        multiRenderer.setLabelsTextSize(25);

        int length = multiRenderer.getSeriesRendererCount();
        for (int i = 0; i < length; i++) {
            XYSeriesRenderer r = (XYSeriesRenderer) multiRenderer.getSeriesRendererAt(i);
            r.setLineWidth(2f);
        }

        //Legenden-Einstellungen
        multiRenderer.setLegendTextSize(20);

        multiRenderer.setMargins(new int[] {20, 20, 20, 20});

        Looper.prepare();
        graphicalView = ChartFactory.getLineChartView(getActivity(), dataSet, multiRenderer); 
```

有谁知道如何解决这个问题？最好的方法是将 y 标签设置为彼此平行，但我还没有找到一种方法来做到这一点。或者是否有一个函数可以将每个 y 标签的边距设置为 y 轴？

谢谢你的帮助！

![在此处输入图像描述](../Images/36f8e3ed41344bc54c00ddeffd99169e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:23:03.133

您可以为 Y 轴标签设置不同的对齐方式。例如，第一个系列会将标签对齐在左侧，第二个在右侧，第三个在中心。

```
multiRenderer.setYLabelsAlign(Align.LEFT, 0);
multiRenderer.setYLabelsAlign(Align.RIGHT, 1);
multiRenderer.setYLabelsAlign(Align.CENTER, 2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-11T14:52:51.400

只需为您使用的所有三个刻度设置 y 轴最小值和最大值。

然后使用 Color.argb 将两个 Y 刻度的颜色更改为透明

# java - 奇怪的 IF-ELSE 行为：IF-ELSE 两个循环都在执行

> ID：13377690
> 
> 赞同：1
> 
> 时间：2012-11-14T11:11:22.137
> 
> 标签：java, android, if-statement

我在验证函数中使用了 If-Else 语句。我有一个包含所有验证功能的验证类，然后我通过 Validation 类的对象访问这些方法。发生的事情是控件在两种情况下都进入

```
if(some cond ..)
System.out.println("inside IF");
else
System.out.println("inside ELSE"); 
```

我也试过

```
if(some cond ..)
{
System.out.println("inside IF");
}
else
{
System.out.println("inside ELSE");
} 
```

在这两种情况下，控件都进入了两个条件并打印了两条线。我无法向自己解释这一点，无论我给出什么条件，如果这不是语法错误，它应该只进入其中一个循环而不是两个循环

任何人都可以解释如何同时执行 IF 和 ELSE 条件？

我在我的项目中做了一些其他不相关的更改，一段时间后它工作正常，但当时我无法解释我自己是如何做到的

顺便说一句，如果重要的话，我在一个 android 项目中使用这个类，因此使用了 android 编译器

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:15:01.520

您的意思是 if-else 条件语句，而不是循环。

这听起来像一个线程问题。您可能有一个线程在一条路线上运行，而另一个线程调用相同的方法并在另一条路径上运行。这就是您可以显示两个字符串的方式。

为了调试它，您可以在每次调用`Thread.currentThread()`结束时打印。`System.out.println`我相信你会看到不同的`Thread`对象地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T02:22:13.627

谷歌人在这里结束；我在Android的java中遇到了同样的情况。

就我而言（不是完全相同的代码）；

```
int state = 1;
if(state == 1)
{
    //invokes here
    state = 3;
}
else if(state==2){}
else if (state ==3)
{
    //invokes here too
} 
```

问题是，如果这是在“触摸”之类的事件上运行的；它可能会运行多次。上述代码的第二次调用显然会运行 state ==3 部分代码。为避免这种情况，您应该使用单击事件或在第一次触摸后短暂忽略触摸事件的计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-01T16:30:28.420

这是流量的问题。当我在 for 循环中使用 if-else 时，我遇到了同样的问题。实际上，它第一次执行 if 块，但第二次执行 else 块，因为第二次 if 条件不满足。现在，如果您在循环内使用 if-else，则使用 break 语句

# android - 我需要在android中正确排列条形图

> ID：13377691
> 
> 赞同：0
> 
> 时间：2012-11-14T11:11:23.050
> 
> 标签：android, bar-chart

![在此处输入图像描述](../Images/a437698cb51ccfdf0e331488d2378699.png)

![在此处输入图像描述](../Images/b5ead02bfe5a3db2ad8c85ba14acf6f5.png)

现在我正在使用 AChartEngine 在 android 中创建一个条形图。运行我的应用程序后，首先模拟器显示如下图所示。但我需要像下面的第二张图片一样展示如何做到这一点？

而且我还需要改变背景的颜色，我也想改变条形图的颜色，如何做这些事情？

我已经尝试过这些代码，但无法正常工作

```
renderer.setApplyBackgroundColor(true);
renderer.setBackgroundColor(Color.GRAY); 
```

请找到我的来源以供参考。

**图表.java**

```
public class Chart extends Activity {
EditText edt1, edt2;
TextView txtv1;
Button btn;
Bundle data;

String[] orderNo = new String[10];
int[] freightRate = new int[10];
int[] marginPercent = new int[10];

@Override
public void onCreate(Bundle savedInstanceState)     {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    edt1 = (EditText) findViewById(R.id.editText1);
    edt2 = (EditText) findViewById(R.id.editText2);
    btn = (Button) findViewById(R.id.button1);

    btn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            getTMSChart(edt1.getText().toString(), edt2.getText().toString());
            Intent intnt = new Intent(v.getContext(), BarGraphActivity.class);
            intnt.putExtras(data);

            startActivity(intnt);
        }
    });
}

public void getTMSChart(String FromDate, String ToDate) 
{

    System.setProperty("http.keepAlive", "false");
    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

    envelope.dotNet = true;

    String METHOD = "GetTMSChart";
    String NAMESPACE = "http://tempuri.org/";
    String SOAP_ACTION = "http://tempuri.org/GetTMSChart";
    String URL = "http://54.251.60.177/TMSOrdersService/TMSDetails.asmx";

    SoapObject request = new SoapObject(NAMESPACE, METHOD);

    request.addProperty("FromDate", FromDate.trim());
    request.addProperty("ToDate", ToDate.trim());
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

    try {
        androidHttpTransport.call(SOAP_ACTION, envelope);
        SoapObject result = (SoapObject) envelope.bodyIn;
        SoapObject root = (SoapObject) ((SoapObject) (result).getProperty(0)).getProperty("NewDataSet");
        int tablesCount = root.getPropertyCount();

        data = new Bundle();

        for (int i = 0; i < tablesCount; i++) {

            SoapObject table = (SoapObject) root.getProperty(i);
            orderNo[i] = table.getPropertyAsString("Order_No");
            freightRate[i] = Integer.parseInt(table.getPropertyAsString("Freight_Rate"));
            marginPercent[i] = Integer.parseInt(table.getPropertyAsString("Margin_Percent"));               

/*Toast.makeText(getApplicationContext(), "Order No:" + orderNo[i] + "\nFreigtRate:" + freightRate[i] + "\nMarginPc:" + marginPercent[i], Toast.LENGTH_SHORT).show();*/
        }
        data.putStringArray("orderno", orderNo);
        data.putIntArray("freightrate", freightRate);
        data.putIntArray("marginpercent", marginPercent);
        data.putInt("count",tablesCount);
    }
catch (Exception e) 
{
    Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
    e.printStackTrace();
    }   }} 
```

**条形图活动.java**

```
public class BarGraphActivity extends Activity{

String[] orderNo = new String[10];
int[] freightRate = new int[10];
int[] marginPercent = new int[10];
int count;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main1);

    Bundle idata = getIntent().getExtras();
    if (idata !=null)
    {
        orderNo = idata.getStringArray("orderno");  
        freightRate = idata.getIntArray("freightrate");
        marginPercent = idata.getIntArray("marginpercent");
        count = idata.getInt("count");

        CategorySeries series = new CategorySeries("Order-FreightRate Graph");
        for ( int i = 0; i < count; i++){
            series.add(orderNo[i], freightRate[i]);
        }

        XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();
        dataset.addSeries(series.toXYSeries());

        XYSeriesRenderer renderer = new XYSeriesRenderer();
        renderer.setDisplayChartValues(true);
        //renderer.setChartValuesSpacing(1);

        XYMultipleSeriesRenderer mRenderer = new XYMultipleSeriesRenderer();
        mRenderer.addSeriesRenderer(renderer);

        for ( int i = 0; i < count; i++){
            mRenderer.addXTextLabel(i+1, orderNo[i]);
            }

        mRenderer.setZoomButtonsVisible(true);
        mRenderer.setBarSpacing(0.5);

        Intent intent = ChartFactory.getBarChartIntent(getApplicationContext(), dataset, mRenderer, Type.DEFAULT);
        startActivity(intent);      
        }        }  } 
```

感谢您宝贵的时间！..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T09:33:18.067

嗨，如果您想更改图表的背景颜色，只需使用这些方法

```
 mrenderer.setApplyBackgroundColor(true);
   mrenderer.setBackgroundColor(Color.parseColor("#898989")); // here you have to give hexa decimal code 
   mrenderer.setMarginsColor(Color.parseColor("#898989")); // here you have to give hexa decimal code 
```

如果你想改变你的酒吧颜色意味着这样做

```
 int[] colors = new int[] { Color.parseColor("#DAE1EB"), Color.parseColor("#406193")};
     int color_length = colors.length;
     for (int i = 0; i < color_length; i++) 
     {
         SimpleSeriesRenderer r = new SimpleSeriesRenderer();
         r.setColor(colors[i]);
         r.setChartValuesSpacing(5);
         mrenderer.addSeriesRenderer(r);
     } 
```

如果您要创建多个渲染器，则意味着对双条使用不同的颜色。如果您正在创建单条，则意味着只提供一种颜色。它会起作用。

# c++ - 带有可变参数模板的递归继承和继承参数问题

> ID：13377692
> 
> 赞同：8
> 
> 时间：2012-11-14T11:11:25.340
> 
> 标签：c++, inheritance, variadic-templates

如果我使用像以下示例这样的继承链，我可以使用来自最深基础的 vars，而不会出现任何问题：

```
 class A { public: int x; };
    class B : public A { };
    class C: public B { public: void Do() { cout << x << endl; } }; 
```

如果我对递归可变参数模板类做同样的事情，我将无法访问我的变量。知道如何访问变量以及为什么我看不到我的变量吗？

```
 template <class ...Parms>
    class Example;

    template <class Head, class ...Parms>
    class Example<Head, Parms...>: public Example<Parms...>
    {
    };

    template <>
    class Example<>
    {
        public:
        int x;
    };

    template <class ...Parms>
    class Last: public Example<Parms...>
    {
        void Do() { cout << x << endl; }
    }; 
```

在实例化类的任何实例之前编译失败！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T11:22:46.373

`x`在这种情况下是一个从属名称，因此您必须访问 if as `this->x`（或通过在类定义中放置 using 声明将其纳入范围：

```
using Example<Params...>::x; 
```

**编辑**

其原因在标准的 [temp.res] 中进行了讨论。基本上：当编译器解析你的模板时，它只会看到`x`. 它无法知道这`x`取决于模板的参数（在您的情况下它会这样做，因为它来自依赖于它们的基类）。因此，编译器在解析模板时尝试`x`使用它知道的内容进行解析，但失败了。

写作`this->x`表示`x`指类的成员；由于特定类的基类依赖于模板参数，因此编译器在解析模板时知道它无法`x`解析，并将推迟解析直到模板被实例化。那时，模板参数是已知的。

这同样适用于`using Example<Params...>::x;`。这也告诉编译器`x`依赖于模板参数，它的解析必须推迟到实例化。

# php - 在 PHP 中从截断的 XML 数据创建 SimpleXmlElement

> ID：13377697
> 
> 赞同：0
> 
> 时间：2012-11-14T11:11:40.730
> 
> 标签：php, xml, curl, simplexml

我正在使用 cURL 检索 XML 数据，但由于 CURLOPT_TIMEOUT（出于其他原因这是必要的），它被截断。有没有办法以某种方式纠正/丢弃/恢复这些数据的部分，以便 SimpleXmlElement 可以读取它？

当允许完整接收文件时，它会被完美解析，我需要一种在传输被切断时仍然获取对象的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:52:34.990

Afaik 没有像“不完整的 XML 解析器”这样的工具。如果您需要从此类文件中提取数据，您可能必须使用字符串函数或正则表达式手动完成。

话虽如此，您可能希望更改您的 XML 文档以使其适合时间范围。压缩 (gzip) 或拆分为多个文档可能是一种选择。

# ios - iPhone 的 Flash 嵌入资源文件夹？

> ID：13377698
> 
> 赞同：0
> 
> 时间：2012-11-14T11:11:44.933
> 
> 标签：ios, actionscript-3, flash, loading

我正在编写一个使用 FDT5.5 打包为 iPhone 应用程序的 Flash 游戏。我希望能够从资源文件夹加载图像和声音，以避免嵌入所有内容。是否可以在我的游戏中加载的编译过程中包含一个文件夹？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-15T20:35:20.333

很抱歉，但我不相信 iPhone 应用程序可以做到这一点。

# opengl - 关于 glTexImage3D

> ID：13377700
> 
> 赞同：3
> 
> 时间：2012-11-14T11:11:57.067
> 
> 标签：opengl, textures

在 3D 纹理的情况下，

对于三维纹理，z 索引指的是三维。这到底是什么意思？

对于二维数组纹理，z 索引是指切片索引。是不是如果我们有 4 层 2D 纹理，那么如果 z=2，它将指的是第 2 个 2D 纹理切片。？

那么当我们有目标 GL_TEXTURE_3D 和 GL_TEXTURE_2D_ARRAY 除了纹理坐标之间的差异之外，有什么区别呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T18:05:31.207

> 对于三维纹理，z 索引指的是三维。这到底是什么意思？

无论你*想*表达什么意思。

纹理只不过是一个查找表。该查找表的索引称为纹理坐标。纹理坐标的含义完全取决于您打算如何使用它。它可能是太空中的一个位置。它可能是三个维度的函数的 XYZ。这可能是很多事情。

停止将纹理视为*图片。*

在 2D 纹理中，纹理坐标的 S 和 T 分量表示沿纹理的 X 轴和 Y 轴要访问的距离。如果 S 为 1，则表示右侧。如果 S 为 0，则表示左侧。等等。

3D 纹理和 STP 坐标也是如此。如果 P 为 0，则表示 3D 纹理的“最远”深度。如果 P 为 1，则表示“最近”深度。

就您上传的数据而言，它始终基于右手坐标系。所以bottom/left/back是(0, 0, 0)点，top/right/front是(1, 1, 1)点。您在数据中提供的第一个深度层是最远的深度层，下一层是第二远的，依此类推。

> 对于二维数组纹理，z 索引是指切片索引。是不是如果我们有 4 层 2D 纹理，那么如果 z=2，它将指的是第 2 个 2D 纹理切片。？

不，它会提到*第三个*。从零开始的索引，就像 C/C++ 中的所有其他内容一样。

> 那么当我们有目标 GL_TEXTURE_3D 和 GL_TEXTURE_2D_ARRAY 除了纹理坐标之间的差异之外，有什么区别呢？

1.  二维数组的层之间没有过滤。如果您在 3D 纹理中使用 GL_TEXTURE_MAG_FILTER 和 GL_LINEAR，它将从 8 个纹理像素中采样值并在所有 3 个方向上进行插值。如果您使用 2D 数组执行此操作，它将选择一个特定的 Z 层进行采样，并在该层中选择 4 个纹素进行插值。

2.  Mipmap 的工作方式不同。3D 纹理包含 3D 图像。因此，每个 mipmap 也是 3D 的。因此，mipmap 缩减是三维的。如果基础层是 32x32x32，那么下一个 mipmap 将是 16x16x16。

    2D 阵列纹理包含*2D 图像*。它们包含一组 2D 图像，但这是一个实现细节；它只是二维图像的集合。每个 2D 图像都有自己的 mipmap，但这些是*2D mipmap*。因此，2D 阵列纹理的每个 mipmap 使用的*图像数量*与所有其他纹理相同。因此，如果 2D 数组的基础层使用 32x32 2D 图像，并且这些图像有 32 个，则下一个 mipmap 层将使用 16x16 2D 图像，但*仍然有 32 个。*

3.  数组纹理使用整数值作为纹理坐标的第三个分量（要从中获取的数组层）。3D 纹理对所有三个组件使用归一化值。

简而言之，除了您用来向它们上传数据的功能外，*它们没有任何共同之处。*

通过[查看 OpenGL wiki 上有关纹理的各个页面](http://www.opengl.org/wiki/Texture)了解更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T11:25:41.580

3D 纹理可以在所有三个维度上进行插值，而 2D 纹理阵列仅在两个图像维度上进行插值，而不是跨切片进行插值。

# java - JMS 中的点对点与发布/订阅模型

> ID：13377703
> 
> 赞同：21
> 
> 时间：2012-11-14T11:12:08.877
> 
> 标签：java, jms, publish-subscribe, mom

我是 JMS 的新手。我从“hello world”开始，我在主题上发布来自 java 应用程序的消息并从客户端（node.js Javascript）监听它。我已经浏览了[这个维基百科条目](http://en.wikipedia.org/wiki/Java_Message_Service)，但根据我之前的理论理解，我有一些问题。

根据我的理解，点对点是队列实现，最多可以有一个消费者订阅队列，并且只能被那个消费者消费。生产者和消费者都不知道彼此。在我的例子中，队列托管在消息代理上 Apache ActiveMQ。队列可以由生产者在发布消息之前创建（也可以提前从控制台创建）。

在发布/订阅模型的情况下，它几乎与点对点相同，只是我们使用主题而不是队列。在此模型中，该主题可能会有更多的消费者。消息发布后，将通知所有订阅者。现在，如果有任何订阅者，发送已发布消息的确认，消息将被视为已消费并且不再可供新订阅者使用？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-15T04:26:04.837

点对点意味着消息通过队列从一个应用程序（生产者或发送者）发送到另一个应用程序（消费者/接收者）。可以有多个消费者在一个队列上监听，但只有一个消费者会收到消息。因此它是点对点或一对一。

另一方面，发布/订阅是另一种消息传递模型，其中消息（或通常称为的发布）通过主题发送给多个消费者（或订阅者）。主题是发布者和订阅者之间的链接。订阅者可能会或可能不会确认发布的消息。JMS 等实现向消息传递提供者确认消息，但不确认消息的发送者。所有订阅者都将收到出版物，包括持久版和非持久版。除非它是保留的发布，否则同一主题的任何新订阅者都不会获得该发布。

**我建议您进一步阅读，**

> 1.  持久订阅
> 2.  非持久订阅
> 3.  保留出版物

# java - Java Minimax井字游戏

> ID：13377705
> 
> 赞同：3
> 
> 时间：2012-11-14T11:12:11.463
> 
> 标签：java, tic-tac-toe, minimax

我目前正在尝试实现一个`Minimax algorithm`for `Tic Tac Toe`。在当前版本中，在某些情况下，计算机会出现问题，我不太清楚为什么。例如，如果我（作为人类玩家）从左上角的 x 开始，计算机的反应是左下角的 ao（当然，这等于他输了）整个程序在`MVC-Design`.

问题：**我是否正确纠正了 Minimax 算法，或者（如果没有）是什么导致了“坏”动作？**

这是代码：（我省略了一些我测试正确的方法的代码）

```
 package tictactoe;

    import java.util.*;

    public class AIMinimax {

        Game game;
        Cell[][] cell = new Cell[3][3];
        int[] bestMove;
        public AIMinimax(Game game) {
              this.game=game;
              for(int i=0;i<3;i++)
              {
                  for(int j=0;j<3;j++)
                  {
                      cell[i][j]=game.getCell(i,j);
                  }
              }
           }

        //Calculates the best move.
        private int minimax(Cell player)
        {
            //Computer tries to maximize the bestscore, Player tries to minimize the bestscore.

            int bestScore = 0;
            if(player==Cell.CIRCLE) bestScore=-1; 
            if(player==Cell.CROSS) bestScore=+1;

            int currentScore;
            List<int[]> moves = identifyMoves();
            if(moves.isEmpty() || hasWon(Cell.CROSS) || hasWon(Cell.CIRCLE))
            {
                //System.out.println(hasWon(Cell.CROSS));
                //System.out.println(hasWon(Cell.CIRCLE));
                //System.out.println(moves.isEmpty());
                currentScore=evaluate();
                bestScore=currentScore;
            }
            else
            {
                for (int[] move : moves) {
                    if (player==Cell.CIRCLE)
                    {
                        cell[move[0]][move[1]]=Cell.CIRCLE;
                        currentScore=minimax(Cell.CROSS);
                        if(currentScore>bestScore)
                {
                    bestScore=currentScore;
                    bestMove = move;
                }
            }
            else if(player==Cell.CROSS)
            {
                cell[move[0]][move[1]]=Cell.CROSS;
                currentScore=minimax(Cell.CIRCLE);

                if(currentScore<bestScore  )
                {

                    bestScore=currentScore;
                    bestMove=move;
                }
            }   

            cell[move[0]][move[1]]=Cell.EMPTY;
            if((player==Cell.CIRCLE&&bestScore==1)||(player==Cell.CROSS&&bestScore==-1))
            {
                return bestScore;
            }
        }
        }
                System.out.println(bestScore);
        return bestScore;
        }

    //Compute all possible next moves.
    //@return List of int[2] arrays where int[0] indicates the column and int [1] indicates the row.
    private List<int[]> identifyMoves(){}

    //Evaluates the current board. 
    // -1 if the player wins, +1 if the computer wins, 0 for a draw
    //No other values needed as the depth of the minimax algorithm is maximal.

    private int evaluate() {
        int result=0;
        if(hasWon(Cell.CIRCLE)) result=1;
        if(hasWon(Cell.CROSS)) result=-1;

        return result;
    }
    //return true if the player has won and false if the other player won or there is
    // a draw.

    public boolean hasWon(Cell player){}

    //Returns the next move for the computer as a int[2] where int[0] indicates the column and 
    //int[1] indicates the row.
    public int[] nextMove(Cell player)
    {
        int minimaxResult= minimax(player);

        return bestMove

    }

}

    package tictactoe;

    public enum Cell {

        EMPTY,
        CROSS,
        CIRCLE;

    } 
```

游戏类表示 Cell[][] 数组中的字段（与 AIMinimax 相同）并创建 AIMinimax 的实例并在此调用 nextMove，以生成计算机做出的下一个移动。默认情况下，人类玩家总是启动。

先感谢您！

# javascript - 如何在 jsonp 调用中接收有关 404,409 和其他服务器错误的通知

> ID：13377708
> 
> 赞同：2
> 
> 时间：2012-11-14T11:12:28.123
> 
> 标签：javascript, ajax, jsonp, staledataexception

我有这个 jsonp 函数：

```
 function jsonp(url, callback) {
    var script = document.createElement("script");
    script.setAttribute("type","text/javascript");
    script.setAttribute("onerror","javascript:DisplayPopUp('','staleExceptionRefresh')");
    script.setAttribute("src", url + questionMark + "accept=jsonp&callback="+callback + "&cachebuster="+new Date().getTime());
    document.getElementsByTagName("head")[0].appendChild(script);
} 
```

我捕捉到这样的成功事件：

```
function someCallbackFunction(data1, data2) {} 
```

但问题是，如果我收到 404 或 409 或其他一些服务器错误，我不知道如何捕捉它们（它们不会出现在 上`someCallbackFunction`）。

我可以设置一个`onerror`属性来显示一些东西，但是我如何捕捉服务器的响应。

这是我无法使用常规回调函数捕获的服务器响应的示例：

```
DeleteWebsiteAjaxCall({"action":"", "type":"", "callerId":""}, {errorDescription: "important description I want to display","success":false,"payload":null}); 
```

如何在函数上捕获这些错误（过时的异常？！）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:20:10.057

```
function jsonp(url, callback) {
    var script = document.createElement("script");
    script.setAttribute("type","text/javascript");
    script.setAttribute("src", url + questionMark + "accept=jsonp&callback="+callback + "&cachebuster="+new Date().getTime());
    var errHandler = function(evt) {
      clearTimeout(timer)
      // reference to http://www.quirksmode.org/dom/events/error.html
      // you will get an error eventually, and you can call callback manually here, to acknowledge it.
      // but unfortunately, on firefox you can get error type as undefined, and no further detail like error code on other browser either. 
      // And you can tell the callback function there is a net error (as no other error will fire this event.)
      window[callback](new Error());
    };
    script.onerror = errHandler;
    script.onload = function() {
      clearTimeout(timer);
    }
    // also setup a timeout in case the onerror failed.
    document.getElementsByTagName("head")[0].appendChild(script);
    var timer = setTimeout(errHandler, 5000);
} 
```

如果您的服务器将在 404/409 发生时响应，则将 200 状态代码发送到客户端，而不是使脚本被评估。

否则，浏览器将忽略服务器响应并触发 onerror 事件。

# php - 将 HTML 地理位置存储到 PHP 变量

> ID：13377710
> 
> 赞同：0
> 
> 时间：2012-11-14T11:12:43.983
> 
> 标签：php, javascript, html, geolocation

我目前正在尝试通过 html5 获取地理位置并将它们存储到 php 变量中以供进一步处理。

我遵循了示例[w3schools](http://www.w3schools.com/html/html5_geolocation.asp)，但我不知道如何更改函数以返回纬度和经度并将它们存储在单独的 php 变量 $lat 和 $lon 中。

这是我的代码（不正确）。它是一个 php 函数，可以打印出地理定位脚本。

```
function printGeoLocScript() {
    echo <<<_END

    <script>
function getLatitude()
  {
  if (navigator.geolocation)
    {
    return navigator.geolocation.getCurrentPosition(getLat,showError);
    }
  else{return  "Geolocation is not supported by this browser.";}
  }

function getLongitude()
  {
  if (navigator.geolocation)
    {
    return navigator.geolocation.getCurrentPosition(getLon,showError);
    }
  else{return  "Geolocation is not supported by this browser.";}
  }
function getLat(position)
  {
  return  position.coords.latitude;
  }

function getLon(position)
  {
   return position.coords.longitude;    
  }

function showError(error)
  {
  switch(error.code) 
    {
    case error.PERMISSION_DENIED:
      return "User denied the request for Geolocation."
    case error.POSITION_UNAVAILABLE:
      return "Location information is unavailable."
    case error.TIMEOUT:
      return "The request to get user location timed out."
    case error.UNKNOWN_ERROR:
     return "An unknown error occurred."

    }
  }
</script>

_END;
} 
```

请注意，如果坐标不可用，我希望这两个函数（getLongitude 和 getLatitude 通过 showError 方法返回字符串错误。

最后，这些方法将通过表单的 post 操作调用.. （虽然我不应该有任何问题）

# linux - 正则表达式 - 查找具有一个字符串的出现

> ID：13377712
> 
> 赞同：1
> 
> 时间：2012-11-14T11:12:45.960
> 
> 标签：linux, shell, grep

我试图在 /var/www/vhost 目录中查找过去 24 小时内修改的所有文件。

使用 find 命令可以正常工作，然后，我想过滤列表，因为我不想要 jpg 文件、jpeg 文件等。

现在我有了这个，它工作正常：

```
find /var/www/vhosts/ -ctime 0 -type f | grep  -ve ".jpg$" | grep -ve ".jpeg" 
```

我想（并且知道）我的问题有更好的解决方案。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:18:49.990

将您的 find 命令本身更改为

```
find /var/www/vhosts/ -not \( -name "*.jpeg" -o -name "*.jpg" \) -ctime 0 -type f 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:18:10.147

使用`-regex`和`!`（否定）：

```
find $DIR -regextype posix-extended ! -regex '.*\.(gif|jpg|pdf|png)$' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:21:37.270

您可以使用一个 find 命令完成所有操作：

```
find /var/www/vhosts -ctime 0 -type f \! -iname \*.jpg \! -iname \*.jpeg 
```

# c# - 是否有与 C++ __FILE__、__LINE__ 和 __FUNCTION__ 宏等效的 C#？

> ID：13377714
> 
> 赞同：9
> 
> 时间：2012-11-14T11:12:49.270
> 
> 标签：c#

我有一个 C++ 代码，我正在尝试迁移到 C#。在那里，在 C++ 上，我使用以下宏定义进行调试。

```
#define CODE_LOCATION(FILE_NAME, LINE_NUM, FUNC_NAME) LINE_NUM, FILE_NAME, FUNC_NAME
#define __CODE_LOCATION__ CODE_LOCATION(__FILE__, __LINE__, __FUNCTION__) 
```

C# 中是否有类似的构造？我知道 C# 中没有宏，但是有没有其他方法可以在执行期间获取当前文件、行和函数值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-14T11:22:52.850

如果您使用的是 .net 4.5，则可以使用[CallerMemberName CallerFilePath CallerLineNumber 属性](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callerlinenumberattribute.aspx)来检索此值。

```
public void DoProcessing()
{
    TraceMessage("Something happened.");
}

public void TraceMessage(string message,
    [CallerMemberName] string memberName = "",
    [CallerFilePath] string sourceFilePath = "",
    [CallerLineNumber] int sourceLineNumber = 0)
{
    Trace.WriteLine("message: " + message);
    Trace.WriteLine("member name: " + memberName);
    Trace.WriteLine("source file path: " + sourceFilePath);
    Trace.WriteLine("source line number: " + sourceLineNumber);
} 
```

如果您使用的是较旧的框架和 Visual 2012，您只需将它们声明为它们在框架中（相同的命名空间）以使其工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T11:17:07.753

我想[`StackFrame`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.aspx)这正是你要找的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-14T11:22:42.287

在 .NET 4.5 中有一组新属性可用于此目的：[调用者信息](http://msdn.microsoft.com/en-us/library/hh534540.aspx)

# iphone - Objective-C 中的 NSDate 和 dateString

> ID：13377716
> 
> 赞同：0
> 
> 时间：2012-11-14T11:12:55.073
> 
> 标签：iphone, objective-c, ios, nsdate, nsdata

我想将日期对象保存到我的应用程序的后端。这是代码：

```
NSDate *date = self.birthPickerView.date;
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"YYYY-MM-dd HH:mm:ss"];
NSString *stringFromDate = [formatter stringFromDate:date];
NSLog(@"%@", stringFromDate);

NSDate *endDate = [formatter dateFromString:stringFromDate];
[formatter release];

NSLog(@"%@", endDate);

// Save to database
[user setObject:endDate forKey:@"birth"]; 
```

这是打印出来的结果：

```
1985-03-05 00:00:00
1985-03-04 23:00:00 +0000 
```

结束日期不对。我想保存`1985-03-05`在数据库中。你能帮我出什么问题吗？

**编辑**

```
[self.birthPickerView setTimeZone:[NSTimeZone localTimeZone]];

        NSLog(@"%@", self.birthPickerView.date);
        NSLog(@"%@", self.birthPickerView.timeZone);

        [user setObject:self.birthPickerView.date forKey:self.navTitle]; 
```

此代码保存`1984-03-04 23:00:00`在数据库中。它有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:18:55.293

我不明白您为什么需要将日期转换为字符串，然后再转换回日期。

但是，我很确定会发生这种情况，因为您没有在 NSDateFormatter 上设置时区。默认时区是 GMT，这可能会导致您在那里看到的时间偏移。

# javascript - 实现搜索功能

> ID：13377717
> 
> 赞同：0
> 
> 时间：2012-11-14T11:12:55.737
> 
> 标签：javascript, html, full-text-search, search-engine

我正在使用 HTML5 开发客户端应用程序

我的数据（仅文本数据）存储在我的文件 JSON（70 Mega）中。

我想实现一个函数来搜索我的数据文件中的所有事件。

此功能是否存在开源？或者实现它的最佳方法是什么？

谢谢你的意见

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:02:00.027

如果您打算在客户端使用 Javascript，请查看[http://kiro.me/projects/fuse.html](http://kiro.me/projects/fuse.html)

然而，70Mb 的数据对于任何浏览器来说都太大了，绝对不推荐使用客户端搜索实现。

# php - mod重写错误

> ID：13377725
> 
> 赞同：0
> 
> 时间：2012-11-14T11:13:28.613
> 
> 标签：php, html, mod-rewrite

我有一个这样显示的域

www.example.co.uk/index.php

该站点的不同部分位于不同的物理文件夹中。例如

www.example.co.uk/watersports/index.php?page=activities

水上运动是物理文件夹。

或者

www.example.co.uk/health-and-fitness/index.php?page=the-gym

水上运动是物理文件夹。

我尝试使用我在 Stack 上找到的类似 mod rewrite，如下所示

```
RewriteEngine on
RewriteBase /
RewriteRule ^\.htaccess$ - [F]
RewriteCond %{HTTP_USER_AGENT} ^EmailSiphon
RewriteRule ^.*$ - [F]
RewriteRule ^/$1 /index.php?page=$1
RewriteRule ^/$1 /index.php 
```

但它不起作用。

我试图使网址看起来像这样

www.example.co.uk/watersports/activities

www.example.co.uk/health-and-fitness/the-gym

谁能帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:31:20.727

试试这个

```
RewriteEngine on
RewriteBase /
RewriteRule ^([^/]*)/([^/]*)/?$ $1/index.php?page=$2&%{QUERY_STRING} [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T14:18:03.070

试试这个 ：

```
RewriteEngine on
RewriteRule ^([a-zA-Z0-9/_-]+)/([a-zA-Z0-9-]+)$ $1/index.php?page=$2 [L] 
```

在我的电脑上它工作得很好，即使有多个像这样的子文件夹：

```
http://localhost/experiment/stackoverflow-13377725/activities/foo
http://localhost/experiment/stackoverflow-13377725/activities/foo/bar
... 
```

# android - 从数据库中检索数据

> ID：13377727
> 
> 赞同：0
> 
> 时间：2012-11-14T11:13:34.197
> 
> 标签：android, android-asynctask

我正在尝试从数据库中检索特定数据，例如自定义广告、用户名、日期等。所以遵循此代码中的代码[需要一个简单的 android/webservice 工作教程吗？](https://stackoverflow.com/questions/7520243/need-a-simple-tutorial-for-android-webservice-work). 我错了，因为我是 android.Getting 以下错误，任何人都可以提供帮助

```
11-13 21:57:14.720: E/AndroidRuntime(399): FATAL EXCEPTION: main
11-13 21:57:14.720: E/AndroidRuntime(399): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.response/com.response.FetchList}: java.lang.ClassCastException: com.response.FetchList
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.os.Looper.loop(Looper.java:123)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-13 21:57:14.720: E/AndroidRuntime(399):  at java.lang.reflect.Method.invokeNative(Native Method)
11-13 21:57:14.720: E/AndroidRuntime(399):  at java.lang.reflect.Method.invoke(Method.java:521)
11-13 21:57:14.720: E/AndroidRuntime(399):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-13 21:57:14.720: E/AndroidRuntime(399):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-13 21:57:14.720: E/AndroidRuntime(399):  at dalvik.system.NativeStart.main(Native Method)
11-13 21:57:14.720: E/AndroidRuntime(399): Caused by: java.lang.ClassCastException: com.response.FetchList
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
11-13 21:57:14.720: E/AndroidRuntime(399):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577) 
```

**编辑** Manifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.response"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Response"
        android:label="@string/title_activity_response" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="android.support.v4.app.FragmentActivity" />
    </activity>
    <activity
        android:name=".XMLParser"
        android:label="@string/title_activity_response" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".FetchList"
        android:label="@string/title_activity_response" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:27:20.483

如果您完全按原样从该链接获取代码，那么您可能会在该行遇到该错误，

```
public class FetchList extends asyncTask<Void,Void,Byte>{

                doinbackground{ 
```

这实际上是

```
 public class FetchList extends asyncTask<Void, Void, Byte> {
        @Override
        protected Byte doInBackground (Void... voids){
          ...
        }
    } 
```

**编辑：**从您评论中的代码，

```
public class FetchList extends AsyncTask<Void,Void,Byte>{
  @Override
  protected Byte doInBackground1(Void... arg0){
        // this was explained in first step
        Response res = new Response("url");
        String response = res.getResponse();
        XMLParser xml = new XMLParser(response);
        ArrayList<XMLParser> itemList = xml.getItemList();
        return xml.parse();
  }
} 
```

在这种情况下，让我知道 Logcat 输出是什么。

# security - 云与内部数据库相结合。安全性有多好？

> ID：13377732
> 
> 赞同：2
> 
> 时间：2012-11-14T11:13:38.753
> 
> 标签：security, cloud

我目前正在研究云计算。我为一家处理高度隐私数据的公司这样做，所以我正在考虑这种情况：

数据库仍在内部的混合云。应用程序本身可能在云中，因为每月一次它会变得非常繁忙，因此肯定会获得一些扩展利润。我想知道这个安全性究竟是如何工作的。

客户将通过安全连接访问网站（将在云中）。这意味着数据将被加密传递到云网站。数据最终必须从那里进入数据库，但是……这怎么可能？

因为内部的数据库服务器不知道如何处理已经加密的数据（我认为？）。内部数据库服务器不是与客户和 Web 应用程序一起设置的证书的一部分。我是对的还是我在监督什么？我不是证书和加密方面的专家。

另外，另一个问题：如果这可以解决，并且数据将一直被加密，那么将其放在公共云环境中是否安全？还是应该使用私有云？

非常感谢！！提前！！

亲切的问候，

任斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:24:24.100

Both systems can live separately and communicate with each other through a message bus. The web site can publish events for the internal system (or any party) to pick up and the internal system can publish events as well that the web site can process.

This way the web site doesn't need access to the internal database and the internal application doesn't have to share more information than is strictly necessary.

By publishing those events on a transactional message queue (such as MSMQ) you can make sure messages are never lost and you can configure transport level security and message level security to ensure that others aren’t tampering messages.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T13:08:44.190

从应用程序的角度来看，应用程序服务器和数据库服务器之间的安全连接应该是完全透明的。VPN 连接可以将运行应用程序的云实例与现场数据库连接起来，允许管理员使用数据库服务器的 IP 地址简单地定义数据源。

当然，当云实例受到威胁时，这确实会产生安全问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-25T14:11:29.620

一旦使用访问数据库的用户的静态 Mac ID 建立安全连接，内部数据库就不会受到损害。管理员可以通过一次性批准提供对 Mac id 的访问权限，并将用户添加到他的 Windows 控制台。

# php - PHP - javascript 验证 - 单选按钮警报

> ID：13377737
> 
> 赞同：0
> 
> 时间：2012-11-14T11:13:52.537
> 
> 标签：php, button, radio

我在一个表单中输入了三个单选按钮。当其中一个字段为空时，我希望在用户单击提交时出现警报框。我怎么能用javascript做到这一点？

到目前为止我的代码是..

```
 <?php

   session_start();
   $Load=$_SESSION['login_user'];
   include('../connect.php');

                if (isset($_POST['submit']))

{  

   $v1 = intval($_POST['v1']);
   $v2 = intval($_POST['v2']);
   $v3 = intval($_POST['v3']);
   $total = $v1 + $v2 + $v3  ;

 mysql_query("INSERT into Form1 (P1,P2,P3,TOTAL)
 values('$v1','$v2','$v3','$total')") or die(mysql_error());
 header("Location: mark.php");
 }

?>

<html>

<head>

<?php

if(!isset($_SESSION['login_user']))

header("Location:index.html");

?>
  <title>Q&A Form</title>

</head>

<body>

    <center><form method="post" action="mark.php"  >

    <table style="width: 20%" >
        <tr>
    <th> Criteria </th>
    <th> </th>
    </tr>
    <tr>
    <th> Excellent </th>
    <td >  4 </td>
    </tr>
    <tr>
    <th > Good <font size="3" > </font></th>
    <td>  3 <font size="4" > </font></td>
    </tr>
    <tr>
    <th > Average <font size="3" > </font></th>
    <td >  2 <font size="4" > </font></td>
    </tr>
    <tr>
    <th > Poor <font size="3" > </font></th>
    <td >  1 <font size="4" > </td>
    </tr>

<font size='4'>
    <table style="width: 70%">
        <tr>
<th > School Evaluation <font size="4" > </font></th>

<tr>
<th > Criteria <font size="4" > </font></th>
            <th> 4<font size="4" > </font></th>
            <th> 3<font size="4" > </font></th>
            <th> 2<font size="4" > </font></th>
            <th> 1<font size="4" > </font></th>

        </tr>
<tr>
<th> Your attendance<font size="4" > </font></th>
<td>  <input type="radio" name ="v1" value = "4"    onclick="updateTotal();"/></td>
<td>  <input type="radio" name ="v1" value = "3"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v1" value = "2"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v1" value = "1"    onclick="updateTotal();" /></td>    
</tr>

<tr>
<th > Your grades  <font size="4" > </font></th>
<td>  <input type="radio" name ="v2" value = "4"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v2" value = "3"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v2" value = "2"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v2" value = "1"    onclick="updateTotal();" /></td>    
</tr>

<tr>
<th >Your self-control <font size="4" > </font></th>
<td>  <input type="radio" name ="v3" value = "4"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v3" value = "3"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v3" value = "2"    onclick="updateTotal();" /></td>
<td>  <input type="radio" name ="v3" value = "1"    onclick="updateTotal();" /></td>    
</tr>       

        </tr>
    </table>

    <br>
    <td><input type="submit" name="submit" value="Submit">

    <input type="reset" name="clear" value="clear" style="width: 70px"></td>

 </form> 
</center> 
```

我有想法说

```
<form name="form1" action="mark.php" onsubmit="return validateForm()" method="post"> 
```

但是我应该在 validateForm() 中写什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:23:05.847

这是非常简单的 javascript 验证。样本取自以下 w3c

```
function validateForm()
{
var x=document.forms["myForm"]["fname"].value;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:24:27.283

In your form page head section insert this code for your grades option check

```
 <script type="text/javascript">
 function validateform()
  {
    if(document.getElementsByName('v2').value="")
    {
      alert('Your grades is not selected');
    return false;
    }
  }
    </script> 
```

in this way you can achieve for remaining radio buttons.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:28:50.697

另外的选择：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>

    <script type="text/javascript">
function validateForm(formData){
    if(!this.v1.checked && !this.v2.checked && !this.v3.checked){
        alert('Chose an option please');
        return false;
    }
    }
    </script>

    <title></title>
</head>

<body>
    <form name="form1" action="mark.php" onsubmit="return validateForm()" method="post"> 
        <input type="radio" value="1" id="v1" name="v1"> <input type="radio" value="1" id="v2" name="v2"> <input type="radio" value="1" id="v3" name="v3"> <input type="submit" value="Send">
    </form>
</body>
</html> 
```

# javascript - 哈希的使用和用户在历史中的移动

> ID：13377738
> 
> 赞同：0
> 
> 时间：2012-11-14T11:14:00.010
> 
> 标签：javascript, hash, history

* * *

当客户端打开其 url 中带有尾随“#something”的页面时，我在脚本中使用一些哈希来滚动到页面的不同元素。问题是当用户使用返回和他的客户端的按钮时。一旦客户搬回来或搬回来，我怎样才能让脚本再次做出反应？

这是代码的相关部分：

```
// Arrivée avec une ancre
var $h = window.location.hash;
if ($h != '') {
    var $arrh =  {'#home': '#panel_home', '#services': '#panel_services', '#realisations': '#panel_realisations', '#contact': '#panel_contact', '#about': '#panel_about' };
    $('#left').scrollTo($arrh[$h], 500);
}
else {
    $('#left').scrollTo('#panel_home', 500);
} 
```

我希望我的问题是可以理解的......我是法国人，我只是尽力用英语解释我的想法。

我不知道我要问的是否可能，但如果您有想法，欢迎您的帮助！

**编辑-0：**

'刚刚在那里看到了一个看似相似的讨论：[Detecting Back Button/Hash Change in URL](https://stackoverflow.com/questions/172957/detecting-back-button-hash-change-in-url) 如果我找到解决方案，我会阅读并带回答案（提出的一些链接真的很有趣）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:21:59.277

这个 CSS 选择器可能会有所帮助：

```
#left:target
{
.
.
.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:17:29.900

将此代码添加到函数中，并在哈希更改时调用该函数。我不确定我是否完全理解，但从我所做的来看，我认为这对你来说应该很好：

```
var scrollFunction = function (){
    var $h = window.location.hash;
    if ($h != '') {
        var $arrh =  {'#home': '#panel_home', '#services': '#panel_services', '#realisations': '#panel_realisations', '#contact': '#panel_contact', '#about': '#panel_about' };
        $('#left').scrollTo($arrh[$h], 500);
    }
    else {
        $('#left').scrollTo('#panel_home', 500);
    }
};
window.onhashchange = scrollFunction; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:21:13.400

您还可以尝试使用 jquery 插件，例如开发的 jquery hash-change (https://github.com/cowboy/jquery-hashchange) 或 jquery history (http://tkyk.github.com/jquery-history-plugin/)对于类似的要求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T00:02:54.080

好吧，满足我需要的解决方案在那个插件中：

[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)

也许它会帮助别人......

ps：真的好用；只需将脚本链接到您的文档并添加如下内容：

```
$(window).hashchange(function(){
    my_func();
}); 
```

# python - 在雪豹上安装 numpy

> ID：13377745
> 
> 赞同：0
> 
> 时间：2012-11-14T11:14:37.263
> 
> 标签：python, numpy, version, osx-snow-leopard, gcc-4.2

当我尝试通过 python.org python2.6 安装安装 numpy 时，我在我的 OS X 终端上收到这些错误。

```
sh: gcc-4.2: command not found 
```

这会导致失败。我注意到这个问题上已经有一个 pastebin（http://pastebin.com/hieSKe3A），但我无法在网上找到适用于 Snow Leopard 的答案（Lion 似乎有很多答案）。

我注意到 numpy 需要 python.org python2.6 安装。我正在尝试这样做。顺便说一句，如果我有办法阻止 numpy mpkg 的安装程序检查可用的 python 版本？（如果是，我可能有另一种 hacky 方式来做到这一点。）

帮助？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T13:45:32.170

在 Snow Leopard 上安装 gcc 4.2 有两个主要选项：

1.  [**从osx-gcc-installer**](https://github.com/kennethreitz/osx-gcc-installer/downloads)下载预构建的二进制文件。这是最简单的方法。

2.  [在开发人员中心](https://developer.apple.com/downloads/index.action)下载**Xcode 的命令行工具**包并按照[本指南](https://apple.stackexchange.com/questions/45651/xcode-4-and-snow-leopard/45660#answer-45660)将其安装在雪豹上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T15:22:34.067

在终端类型“gcc”中，您将收到消息“command not found”。

有时需要 C 或 GCC 编译器，MAC OS X 默认没有安装它

要安装 gcc 编译器，您需要下载并安装 xcode 的命令行工具（请参阅 Apples 开发人员页面）

# vb6 - 如何在 vb6.0 中显示缩小的网络浏览器

> ID：13377747
> 
> 赞同：6
> 
> 时间：2012-11-14T11:14:43.220
> 
> 标签：vb6

这是用于缩小网络浏览器的代码

```
Const OLECMDID_OPTICAL_ZOOM = 63
Const OLECMDEXECOPT_DONTPROMPTUSER = 2

Web1.ExecWB OLECMDID_OPTICAL_ZOOM, OLECMDEXECOPT_DONTPROMPTUSER, CLng(35), vbNull 
```

当我使用代码时，出现以下运行时错误：

> -2147221248 (80040100)：自动化错误

有任何想法吗？

编辑：我使用你提供的代码。一旦我使用 exe 并运行它显示以下错误，它在调试模式下工作正常。![在此处输入图像描述](../Images/287ef19b8fdb3df4c47a307f031cef54.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:59:40.127

这仅在文档加载后才有效，然后似乎会持续用于后续导航。

如果在没有 DOM 文档的情况下尝试更改光学变焦，则会出现错误 80040100。

下面的代码只是在适当的时间初始设置缩放；

```
Private Const OLECMDID_OPTICAL_ZOOM As Long = 63
Private Const OLECMDEXECOPT_DONTPROMPTUSER As Long = 2

Private mblHasSetZoom As Boolean

Private Sub Form_Load()
    web1.Navigate2 "http://www.google.com"
End Sub

Private Sub web1_DocumentComplete(ByVal pDisp As Object, URL As Variant)
If Not mblHasSetZoom Then
    web1.ExecWB OLECMDID_OPTICAL_ZOOM, OLECMDEXECOPT_DONTPROMPTUSER, 35&
    mblHasSetZoom = True
End If
End Sub 
```

# ios - iOS 不是典型的后台位置跟踪计时器问题

> ID：13377750
> 
> 赞同：0
> 
> 时间：2012-11-14T11:14:53.453
> 
> 标签：ios, background, nstimer, core-location, objective-c-blocks

我正在开发一个示例应用程序来跟踪用户在后台的位置，但我不想让定位服务始终处于启用状态，但我的计时器中的某些内容无法正常运行。

我的想法是，每隔 x 分钟，服务就会继续，当它有一个正确的新位置时，它会再次发布，现在设置为 10 秒，仅用于测试。（显着的 LocationChange 不是诀窍，不够准确）

我搜索了很多（iOS 开发中心 + StackOverflow）并找到了“新的”后台定位功能，它允许您在进入后台后 10 分钟内运行代码，使用 beginBackgroundTaskWithExpirationHandler、几个块和一个计时器。

我将后台模式设置为位置，现在我认为我不需要处理后台时间的结束（首先我想每 15-20 秒获取一次位置）

代码工作“正常”但是：

*   计时器有时会触发，有时不会。
*   当计时器触发时，它至少需要 10 分钟才能完成。
*   操作系统中的一些随机操作（例如进入搜索桌面）似乎可以估计计时器触发（不确定这一点，我不知道它是如何可能的，但它是......）

而通过代码将是另一个问题。

appdelegates 的方法：

// **applicationDidEnterBackground**

```
- (void)applicationDidEnterBackground:(UIApplication *)application{

NSLog(@"to background");

UIApplication*    app = [UIApplication sharedApplication];

bgTask = [app beginBackgroundTaskWithExpirationHandler:^{
    [app endBackgroundTask:bgTask];
    bgTask = UIBackgroundTaskInvalid;
}];

// Start the long-running task and return immediately.
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    // Do the work associated with the task.
    _triggertimer = nil;
    [self initTimer];

});
NSLog(@"backgroundTimeRemaining: %.0f", [[UIApplication sharedApplication] backgroundTimeRemaining]);} 
```

//**初始化定时器**

```
- (void) initTimer{
NSLog(@"InitTimer ");

UIApplication *app = [UIApplication sharedApplication];

bgTask = [app beginBackgroundTaskWithExpirationHandler:^{

_triggertimer = [NSTimer scheduledTimerWithTimeInterval:10.0
                                                     target:self
                                                   selector:@selector(checkUpdates:)
                                                   userInfo:nil
                                                    repeats:YES];

[[NSRunLoop currentRunLoop] addTimer:_triggertimer forMode:NSDefaultRunLoopMode] ;
[[NSRunLoop currentRunLoop] run];

}];} 
```

//**检查更新**

```
- (void)checkUpdates:(NSTimer *)timer{

NSLog(@"CheckUpdates ");

UIApplication*    app = [UIApplication sharedApplication];

if (nil == _locationManager) _locationManager = [[CLLocationManager alloc] init];

_locationManager.delegate = self;

_locationManager.distanceFilter = 10;
_locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;

[_locationManager startUpdatingLocation];
[_locationManager startMonitoringSignificantLocationChanges];

double remaining = app.backgroundTimeRemaining;
NSLog(@"Reminaing %f", remaining);} 
```

我尝试了很多东西来解决这个问题，也许我搞砸了或错过了一些东西......你看到了什么？也许是一些概念错误，我正在尝试向这些块介绍自己，但我还没有对它们进行分类 ¬¬

**顺便说一句，为什么在使用beginBackgroundTaskWithExpirationHandler**做任何事情之前我发现的所有代码都包含这个？

```
 bgTask = [app beginBackgroundTaskWithExpirationHandler:^{
    [app endBackgroundTask:bgTask];
    bgTask = UIBackgroundTaskInvalid;
}]; 
```

我以为这是为了拍摄 600 秒的背景……但我不确定！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:23:51.873

当您的应用程序处于后台时，计时器将不再触发，除非您在应用程序的 info.plist 中 为[UIBackgroundModes 键设置了“位置”值。](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html)

您可以使用 beginBackgroundTaskWithExpirationHandler 延长您被允许在后台运行的时间（如果您尚未设置“位置”），但这应该始终与相应的结束调用配对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T15:06:59.537

好的，问题是我调用了 beginBackgroundTaskWithExpirationHandler 两次，一次在**ApplicationDidEnterBackground**中，另一次在**initTimer** ...

# c# - OpenXML SDK 获取 ActiveX 控件值

> ID：13377752
> 
> 赞同：1
> 
> 时间：2012-11-14T11:15:01.013
> 
> 标签：c#, .net, ms-word, activex, openxml-sdk

对于我在大学的一个项目，我必须创建一个 Word 文档形式的测试，并在其中添加一些 ActiveX 表单以供其他人完成。在此之后，我必须以编程方式从中提取答案并在测试中评分。

我使用 OpenXML SDK 来处理文档，但它让我很头疼，因为我找不到获取 ActiveX 值的方法。

那么解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:15:01.013

在网上搜索和对文档稍作嗅探后，我发现 ActiveX 控件数据可以在控件 ID 指定的文档部分中找到。确定控件的类型有点棘手，因为我没有找到任何关于此的文档。显然，您必须从控件中获取“classid”属性并尝试将其与您知道的 classid 匹配。下面是确定三种类型控件值的代码。其余的 id 被标记为未知，您可以直观地将它们与您在文档中添加的那些进行匹配。

```
 using System;
using System.Collections.Generic;
using System.Xml.Linq;
using System.Xml;
using System.IO;
using System.Text;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Wordprocessing;
using DocumentFormat.OpenXml.Packaging;

namespace OpenXMLTest
{
    class Program
    {
        const string textBoxId = "{8BD21D10-EC42-11CE-9E0D-00AA006002F3}";
        const string radioButtonId = "{8BD21D50-EC42-11CE-9E0D-00AA006002F3}";
        const string checkBoxId = "{8BD21D40-EC42-11CE-9E0D-00AA006002F3}";

        static void Main(string[] args)
        {
            string fileName = @"C:\Users\Andy\Desktop\test_l1demo.docx";
            using (WordprocessingDocument doc = WordprocessingDocument.Open(fileName, false))
            {
                foreach (Control control in doc.MainDocumentPart.Document.Body.Descendants())
                {
                    Console.WriteLine();
                    Console.WriteLine("Control {0}:", control.Name);
                    Console.WriteLine("Id: {0}", control.Id);

                    displayControlDetails(doc, control.Id);
                }
            }

            Console.Read();
        }

        private static void displayControlDetails(WordprocessingDocument doc, StringValue controlId)
        {
            string classId, type, value;

            OpenXmlPart part = doc.MainDocumentPart.GetPartById(controlId);
            OpenXmlReader reader = OpenXmlReader.Create(part.GetStream());
            reader.Read();
            OpenXmlElement controlDetails = reader.LoadCurrentElement();

            classId = controlDetails.GetAttribute("classid", controlDetails.NamespaceUri).Value;

            switch (classId)
            {
                case textBoxId:
                    type = "TextBox";
                    break;
                case radioButtonId:
                    type = "Radio Button";
                    break;
                case checkBoxId:
                    type = "CheckBox";
                    break;
                default:
                    type = "Not known";
                    break;
            }

            value = "No value attribute"; //displays this if there is no "value" attribute found
            foreach (OpenXmlElement child in controlDetails.Elements())
            {
                if (child.GetAttribute("name", controlDetails.NamespaceUri).Value == "Value")
                {
                    //we've found the value typed by the user in this control
                    value = child.GetAttribute("value", controlDetails.NamespaceUri).Value;
                }
            }

            reader.Close();

            Console.WriteLine("Class id: {0}", classId);
            Console.WriteLine("Control type: {0}", type);
            Console.WriteLine("Control value: {0}", value);

        }
    }
} 
```

# apache - CloudFront 和 mod_pagespeed - 收到错误的内容

> ID：13377757
> 
> 赞同：1
> 
> 时间：2012-11-14T11:15:28.093
> 
> 标签：apache, cdn, amazon-cloudfront, mod-pagespeed

我正在使用 CloudFront 和在服务器上运行的 mod_pagespeed。

更新 CSS 或刷新缓存时，我看到有问题的行为，首先在浏览器上刷新会返回原始 CSS（这很好）。当我第二次刷新时，我得到了正确的操纵 CSS 文件名，但来自 CloudFront 的文件内容仍然是原始内容，而不是正确的操纵内容。

为什么会发生这种情况？知道如何解决这个问题吗？

**更新：**

由于某种原因，它刚刚停止发生......我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-16T06:11:07.717

SimonW，自从您的原始帖子以来，pagespeed（2013 年 3 月的 1.2.24.1 版本中）添加了一项功能来直接处理此问题。该指令通过以下方式启用：

Apache：ModPagespeedRewriteDeadlinePerFlushMs dead_value_in_milliseconds

Nginx: 页面速度 RewriteDeadlinePerFlushMs dead_value_in_milliseconds;

文档将指令描述如下（强调我的）：

> 当 PageSpeed 尝试重写未缓存（或过期）的资源时，它将等待每个刷新窗口最多 10 毫秒（默认情况下）以完成并返回优化的资源（如果可用）。如果在该时间内未完成，则返回原始（未优化）资源，优化器将移至后台以供将来请求。可以应用以下指令来更改截止日期。增加此值会增加页面延迟，但可能会减少加载时间（例如在值得等待图像压缩完成的带宽受限的链接上）。**请注意，小于或等于零的值将导致 PageSpeed 无限期地等待。**

因此，如果您为 deadline_value_in_milliseconds 指定值 0，您应该始终获得完全优化的页面。我会警告说，在某些情况下，延迟可能会很高。在我的情况下，我真的想要这种行为，即使存在延迟问题，因为内容要缓存在我的 CDN 的边缘服务器上，因此，我希望将最优化的版本提供给 CDN 进行缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T14:18:30.333

如果您有多个后端服务器并且 CloudFront 访问的服务器与 HTML 请求所通过的服务器不同，则可能会发生这种情况。在这种情况下，资源在 HTML 服务器上被重写，而不是在其他服务器上。有一个短暂的超时，如果其他服务器在这段时间内没有完成重写，它只会使用`Cache-Control: private,max-age=300`. CloudFront 可能会缓存一段时间（尽管显然不应该），但最终会从您的后端重新请求资源并获得正确重写的版本。

# android - 从项目中删除支持的语言

> ID：13377760
> 
> 赞同：2
> 
> 时间：2012-11-14T11:15:48.647
> 
> 标签：android, localization

我制作了一个支持两种语言的安卓应用。但在项目期间，我想删除一种语言。我删除了所有本地化文件和文件夹（values-de/drawable-de/ ...）我可以在我的设备和模拟器上运行该应用程序，但是当我开始“导出签名的应用程序包”时，我收到一个 lint 警告，即我的字符串没有翻译成“de”。

删除不再受支持的语言的正确方法是什么？

# java - Java 类名应该与包名重复吗？

> ID：13377766
> 
> 赞同：15
> 
> 时间：2012-11-14T11:16:29.613
> 
> 标签：java, naming-conventions

我正在考虑以下情况下 Java 的最佳实践是什么：

我的程序中有一个逻辑，我想放在一个单独的包中。

例如（我目前的情况），这是一个收集一些统计数据然后将它们发送到服务器的逻辑）。所以我的项目**com.example.project**下的包将被命名为**com.example.project.statistics**。

包内会有一些类，在本例中是 StatisticsDispatcher（基本上是事件的容器和管理器）和 StatisticsEvent（应该计算到统计中的事件）。

问题是，我应该使用什么命名约定？我看到两个选项：

1.  **如上所述的**StatisticsDispatcher**和**StatisticsEvent 。**类名清楚地表明了类的作用，但在绝对名称上有点冗长，例如 com.example.project.statistics.StatisticsEvent。**
***   **调度程序**和**事件**。它更短，并且类的目的从它的绝对名称中可以清楚地看出，例如 com.example.project.statistics.Dispatcher ，但稍后在代码中这些名称可能与其他包的类不明确，即使不是，当我在文件开头导入这些类，“Dispatcher”和“Event”之类的类名非常笼统，在文件中间，它们与什么相关并不明显。**

 **在谷歌搜索 java 包和类命名约定时，我没有发现任何关于此的提及。恐怕第一个选项会是正确的，但我真的不喜欢包名和类名的冗长，所以我想问一下其他程序员，你如何解决这种情况。

提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-14T11:19:28.927

我宁愿明确（也许冗长）而不是简洁（也许模棱两可）。

你的例子重新。`Dispatcher`/`Event`是一个很好的。如果你不走运，你最终将不得不完全限定这些的每一次出现以解决任何歧义。

在这种情况下，您最终会得到大量冗长的代码，或者重组代码以使冲突的类不共存（冲突实际上可能表明不相关的实体共存，但这是另一个讨论）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T11:22:44.097

我肯定会选择第一个，即 StatisticsDispatcher 和 StatisticsEvent，因为单独使用 Dispatcher 和 Event 这两个词可能意味着很多事情（尤其是在 Java EE 中）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-14T12:20:27.443

我也肯定会选择不那么模棱两可的名字。使用可能与其他包冲突的任何名称：

*   给代码的人类阅读者带来问题。如果我看到“事件”，那么我可能会认为它是一个常见的 Java 库，解决此问题的唯一方法是回读该`import`语句。
*   causes problems for IDEs. Eclipse, for example, sometimes "helpfully" guesses the most likely package. List, Element, Attribute, etc. may be imported from packages you never even knew existed! And it can be a surprising amount of wasted time to debug this.**

# scalability - 在 Java 7 的 fork/join 中重用任务对象

> ID：13377770
> 
> 赞同：1
> 
> 时间：2012-11-14T11:16:50.647
> 
> 标签：scalability, java-7, fork-join

我想使用 Java fork join 来解决递归问题，但我不想为每个递归步骤显式创建一个新任务实例。原因是太多的任务等于太多的对象，在处理几分钟后就填满了我的记忆。

我在 Java 6 中有以下解决方案，但是 Java 7 有更好的实现吗？

```
final static AtomicInteger max = new AtomicInteger(10);  // max parallel tasks
final static ThreadPoolExecutor executor = new ThreadPoolExecutor(....);

private void submitNewTask() {
    if (max.decrementAndGet()>=0) {
        executor.execute(new Task(....));
        return;
    }
    run();  // avoid creating a new object
}

public void run() {
    ..... process ....
    // do the recursion by calling submitNewTask()
    max.incrementAndGet();
} 
```

我尝试了`invoke()`再次在同一任务上调用该函数（当然是在更新相关字段之后），但它似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T08:34:29.390

我认为您没有使用正确的方法。Fork/Join 框架旨在以并行方式在（可能）大数据集上执行长时间运行的算法，将数据分成更小的部分（`RecursiveTask`本身），而不是由更多线程执行（加速多个线程的执行） cpu”机器）使用工作窃取策略。

A`RecursiveTask`不需要复制所有数据，而只是为了在您正在处理的部分保留索引（以避免有害的重叠），因此数据开销保持在最低限度（当然，每个`RecursiveTask`也消耗内存）。

在算法设计中，内存占用和执行时间之间通常存在一个线程，因此 FJ 框架旨在减少执行时间，支付（我认为相当少的）内存占用。如果执行时间不是您首先关心的问题，我认为 FJ 对您的问题毫无用处。

# python - 在 Python 中处理除 SIGINT 以外的信号的“正确”方法？

> ID：13377773
> 
> 赞同：3
> 
> 时间：2012-11-14T11:16:56.997
> 
> 标签：python, signals

我有一些 Python 代码需要能够处理 SIGINT。为此，我使用了这样的东西：

```
def mymethod(*params):
  obj = MyObj(params)
  try:
    obj.do_some_long_stuff()
  except KeyboardInterrupt:
    obj.cleanup() 
```

太棒了，真的很简单。是的，Python 很棒！

但是，我现在还需要处理其他信号，即 SIGTSTP 和 SIGQUIT。我正在尝试做的是类似的事情。这是一些伪代码，演示了我正在尝试使用 SIGTSTP 做什么（我希望它足够清楚）：

```
def mymethod(*params):
  obj = MyObj(params)
  try:
    obj.do_some_long_stuff()
  catch SIGINT:
    obj.cleanup()
  catch SIGTSTP:
    log_stop(obj) # Log that we stopped obj (add info about stop signal happening in obj-specific log file )
    raise SIGTSTP # Do normal SIGTSTP behavior as if we didn't catch the signal 
```

看来这里的方法是使用信号模块。但是，我的问题是我不能再访问对象状态，因为我可以使用`KeyboardInterruptException`：

```
import os
import signal

def handler(signum, frame):
  print "I can't access obj from here anymore!" # How to access obj from here?
  signal.signal(signum, signal.SIG_DFL)
  os.kill(os.getpid(), signum) # Rethrow signal, this time without catching it

def mymethod(*params):
  obj = MyObj(params)
  signal.signal(signal.SIGTSTP, handler)
  obj.do_some_long_stuff() 
```

那么我该如何解决这个问题，即在处理信号的同时仍然可以访问我正在使用的对象？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-14T11:48:45.983

或者使用闭包：

```
import os
import signal

def create_handler(obj):
    def _handler(signum, frame):
        print "obj is availiable here!"
        print obj
        signal.signal(signum, signal.SIG_DFL)
        os.kill(os.getpid(), signum) # Rethrow signal, this time without catching it
    return _handler

def mymethod(*params):
  obj = MyObj(params)
  signal.signal(signal.SIGTSTP, create_handler(obj))
  obj.do_some_long_stuff() 
```

`create_handler(obj)`返回一个可以访问的处理函数`obj`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:31:39.100

这将在处理程序是类方法并包含自身成员的条件下工作。

您可以将 obj 设为全局，因为您可以从每个函数中访问它。

```
import os
import signal
obj = None

def handler(signum, frame):
    log_stop(obj)
    signal.signal(signum, signal.SIG_DFL)
    os.kill(os.getpid(), signum) # Rethrow signal, this time without catching it

def mymethod(*params):
    global obj # to signal that the obj we are changing here is the global obj

    obj = MyObj(params)
    handler.obj = obj
    signal.signal(signal.SIGTSTP, handler)
    obj.do_some_long_stuff() 
```

（注意：我个人尽可能避免使用全局参数，因为全局意味着真正的全局）。

# .htaccess - .htaccess 与部分匹配的域名

> ID：13377778
> 
> 赞同：1
> 
> 时间：2012-11-14T11:17:16.467
> 
> 标签：.htaccess, http-status-code-301

我的 .htaccess 文件中有一组非常基本的重写条件，它不适用于一个条件。

我已经通过 .htaccess 测试器运行它，它声称它应该可以工作，但它不在真实站点上。

我有 site.com、site.com.au、anothersite.com.au，它们都应该重定向到 site.com.au

```
RewriteBase /

# Domain Aliases  
Rewritecond %{HTTP_HOST} !^www\.site\.com\.au$ [NC]
RewriteRule (.*) http://www.site.com.au/$1 [L,R=301] 
```

当我访问 anothersite.com.au 时，它成功地向 site.com.au 发送了 301，但是当我访问 site.com 时，它只停留在 site.com 而不是 301。我已经使用过`^`并且`$`应该将匹配限制为确切的 .com.au 域，但它似乎仍然只是决定 .com 就足够了并且不会重定向。

我还尝试对所有域使用单独的规则 - 这以相同的方式运行。

有人能为我解释一下吗？

# delphi - 如何让嵌入式浏览器不提示下载文件的保存位置？

> ID：13377779
> 
> 赞同：2
> 
> 时间：2012-11-14T11:17:19.180
> 
> 标签：delphi, download

如何以编程方式单击下载按钮后下载文件，因此不需要知道下载文件的 url。

文件下载后会出现提示并询问您是否要保存文件，按“是”后，另一个提示会询问您要保存文件的位置。因此，文件首先下载，可能会在某个地方的缓冲区中，在初始下载后，会出现提示。

那么，一旦单击按钮，您如何捕获下载流并将其保存为某个文件，而不会出现弹出提示？

（单击按钮的任何方法都可以，以下应该可以。）

```
procedure TForm1.Button1Click(Sender: TObject);
var
  x: integer;
  ovLinks: OleVariant;
begin
  WebBrowser1.Navigate('The web page');
  //wait for page to down load
  ovLinks := WebBrowser1.OleObject.Document.all.tags('A');
  if ovLinks.Length > 0 then
  begin
    for x := 0 to ovLinks.Length-1 do
      begin
        if Pos('id of button', ovLinks.Item(x).id) > 0 then
        //or if Pos('href of button', ovLinks.Item(x).href) > 0 then
        begin
          ovLinks.Item(x).click;
          Break;
        end;
      end;
  end;
end; 
```

这个问题的原因是：文件的url总是找不到。例如：在这个[网站上](http://financials.morningstar.com/income-statement/is.html?t=AAPL&ops=clear)，我无法以编程方式找到网址，但在按下导出按钮后，使用 IE 将文件下载到“临时 Internet 文件”文件夹中。在 IE 的“临时 Internet 文件”文件夹中，它有一个“Internet 地址”列，其中显示了 url。但在 Chrome 中不存在这样的数据。但是，在这个[网站上](http://www.cvrda.org/boats/cvrda_handicap/cvrda_handicap.htm)，我可以通过编程方式找到网址，但是当我下载文件时，按“此处”，该文件不会出现在 IE 的“临时 Internet 文件”文件夹中。对于其他网站，可以在文件夹中找到 url，并以编程方式找到它，但在其他网站上，无论哪种方式都找不到 url。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T00:08:25.197

将[`IDownloadManager`](http://msdn.microsoft.com/en-us/library/aa753613%28v=vs.85%29.aspx)接口及其[`Download`](http://msdn.microsoft.com/en-us/library/aa753612%28v=vs.85%29.aspx)方法实现到您的 Web 浏览器控件，您可以简单地控制您需要的内容。每当您要下载文件时都会调用该[`Download`](http://msdn.microsoft.com/en-us/library/aa753612%28v=vs.85%29.aspx)方法（仅当弹出另存为对话框时）。

***1\. 嵌入式网页浏览器***

您可以使用[`Embedded Web Browser`](http://www.bsalsa.com/product.html)已实现此接口并触发与`OnFileDownload`中相同命名事件不同的控件`TWebBrowser`。参见例如[`this thread`](http://www.bsalsa.com/forum/showthread.php?t=1038)如何使用它。

***2.自己做***

另一种选择是您可以`TWebBrowser`自己实现它。在下面的示例中，我使用 interposed 类只是为了展示原理，但是将其包装为组件非常容易（这就是我`OnBeforeFileDownload`发布的原因）。

***2.1。OnBeforeFileDownload 事件***

`TWebBrowser`这个插入类中的唯一扩展是`OnBeforeFileDownload`在下载文件时触发的事件（在弹出另存为对话框之前，而不是[`OnFileDownload`](http://docwiki.embarcadero.com/Libraries/XE2/en/SHDocVw.TWebBrowser.OnFileDownload)事件，而不是在下载文档本身时）。如果您不为其编写事件处理程序，则 Web 浏览器控件将像以前一样运行（显示另存为对话框）。如果您编写事件处理程序并将其声明的参数返回 False `Allowed`，则文件保存将被取消。如果您将参数返回 True `Allowed`（默认情况下），将显示另存为对话框。请注意，如果您通过设置`Allowed`为 False 来取消下载，则需要自己下载文件（正如我在本例中使用 Indy 同步所做的那样）。为此，有`FileSource`常量参数，包含下载文件的 URL。以下是事件参数概述：

*   Sender (TObject) - 事件发送者
*   FileSource (WideString) - 源文件 URL
*   Allowed (Boolean) - 声明的布尔参数，它决定是否允许文件下载（默认值为 True）

***2.2\. IDownloadManager 实现***

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  StdCtrls, OleServer, OleCtrls, Dialogs, ActiveX, MSHTML, UrlMon, SHDocVw,
  IdHTTP;

const
  IID_IDownloadManager: TGUID = '{988934A4-064B-11D3-BB80-00104B35E7F9}';
  SID_SDownloadManager: TGUID = '{988934A4-064B-11D3-BB80-00104B35E7F9}';

type
  IDownloadManager = interface(IUnknown)
    ['{988934A4-064B-11D3-BB80-00104B35E7F9}']
    function Download(pmk: IMoniker; pbc: IBindCtx; dwBindVerb: DWORD;
      grfBINDF: DWORD; pBindInfo: PBindInfo; pszHeaders: PWideChar;
      pszRedir: PWideChar; uiCP: UINT): HRESULT; stdcall;
  end;
  TBeforeFileDownloadEvent = procedure(Sender: TObject; const FileSource: WideString;
    var Allowed: Boolean) of object;
  TWebBrowser = class(SHDocVw.TWebBrowser, IServiceProvider, IDownloadManager)
  private
    FFileSource: WideString;
    FOnBeforeFileDownload: TBeforeFileDownloadEvent;
    function QueryService(const rsid, iid: TGUID; out Obj): HRESULT; stdcall;
    function Download(pmk: IMoniker; pbc: IBindCtx; dwBindVerb: DWORD;
      grfBINDF: DWORD; pBindInfo: PBindInfo; pszHeaders: PWideChar;
      pszRedir: PWideChar; uiCP: UINT): HRESULT; stdcall;
  protected
    procedure InvokeEvent(ADispID: TDispID; var AParams: TDispParams); override;
  published
    property OnBeforeFileDownload: TBeforeFileDownloadEvent read FOnBeforeFileDownload write FOnBeforeFileDownload;
  end;

type
  TForm1 = class(TForm)
    Button1: TButton;
    WebBrowser1: TWebBrowser;
    FileSourceLabel: TLabel;
    FileSourceEdit: TEdit;
    ShowDialogCheckBox: TCheckBox;
    procedure Button1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    procedure BeforeFileDownload(Sender: TObject; const FileSource: WideString;
      var Allowed: Boolean);
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

{ TWebBrowser }

function TWebBrowser.Download(pmk: IMoniker; pbc: IBindCtx; dwBindVerb,
  grfBINDF: DWORD; pBindInfo: PBindInfo; pszHeaders, pszRedir: PWideChar;
  uiCP: UINT): HRESULT;
var
  Allowed: Boolean;
begin
  Result := E_NOTIMPL;
  if Assigned(FOnBeforeFileDownload) then
  begin
    Allowed := True;
    if pszRedir <> '' then
      FFileSource := pszRedir;
    FOnBeforeFileDownload(Self, FFileSource, Allowed);
    if not Allowed then
      Result := S_OK;
  end;
end;

procedure TWebBrowser.InvokeEvent(ADispID: TDispID; var AParams: TDispParams);
begin
  inherited;
  // DispID 250 is the BeforeNavigate2 dispinterface and to the FFileSource here
  // is stored the URL parameter (for cases, when the IDownloadManager::Download
  // won't redirect the URL and pass empty string to the pszRedir)
  if ADispID = 250 then
    FFileSource := OleVariant(AParams.rgvarg^[5]);
end;

function TWebBrowser.QueryService(const rsid, iid: TGUID; out Obj): HRESULT;
begin
  Result := E_NOINTERFACE;
  Pointer(Obj) := nil;
  if Assigned(FOnBeforeFileDownload) and IsEqualCLSID(rsid, SID_SDownloadManager) and
    IsEqualIID(iid, IID_IDownloadManager) then
  begin
    if Succeeded(QueryInterface(IID_IDownloadManager, Obj)) and
      Assigned(Pointer(Obj))
    then
      Result := S_OK;
  end;
end;

{ TForm1 }

procedure TForm1.Button1Click(Sender: TObject);
var
  HTMLWindow: IHTMLWindow2;
  HTMLDocument: IHTMLDocument2;
begin
  WebBrowser1.Navigate('http://financials.morningstar.com/income-statement/is.html?t=AAPL&ops=clear');
  while WebBrowser1.ReadyState <> READYSTATE_COMPLETE do
    Application.ProcessMessages;

  HTMLDocument := WebBrowser1.Document as IHTMLDocument2;
  if not Assigned(HTMLDocument) then
    Exit;
  HTMLWindow := HTMLDocument.parentWindow;
  if Assigned(HTMLWindow) then
  try
    HTMLWindow.execScript('SRT_stocFund.Export()', 'JavaScript');
  except
    on E: Exception do
      ShowMessage(E.Message);
  end;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  ReportMemoryLeaksOnShutdown := True;
  WebBrowser1.OnBeforeFileDownload := BeforeFileDownload;
end;

procedure TForm1.BeforeFileDownload(Sender: TObject; const FileSource: WideString;
  var Allowed: Boolean);
var
  IdHTTP: TIdHTTP;
  FileTarget: string;
  FileStream: TMemoryStream;
begin
  FileSourceEdit.Text := FileSource;
  Allowed := ShowDialogCheckBox.Checked;
  if not Allowed then
  try
    IdHTTP := TIdHTTP.Create(nil);
    try
      FileStream := TMemoryStream.Create;
      try
        IdHTTP.HandleRedirects := True;
        IdHTTP.Get(FileSource, FileStream);
        FileTarget := IdHTTP.URL.Document;
        if FileTarget = '' then
          FileTarget := 'File';
        FileTarget := ExtractFilePath(ParamStr(0)) + FileTarget;
        FileStream.SaveToFile(FileTarget);
      finally
        FileStream.Free;
      end;
    finally
      IdHTTP.Free;
    end;
    ShowMessage('Downloading finished! File has been saved as:' + sLineBreak +
      FileTarget);
  except
    on E: Exception do
      ShowMessage(E.Message);
  end;
end;

end. 
```

***2.3\. 下载管理器项目***

您可以将上述代码（用 Delphi 2009 编写）作为一个完整的项目下载[`from here`](http://projects-stackoverflow-tlama.googlecode.com/files/13377779.ZIP)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T21:20:04.427

我不知道这是否会让你到达你需要去的地方，但它似乎很有希望。使用我这里的 TWebBrowser（从“Microsoft Internet Controls 1.1 版”导出），您可以使用 OnBeforeNavigate2 事件来监视 Web 浏览器处理的所有 URL。您从那里遇到的问题是确定您需要做什么，捕获 URL，然后自己处理。这是我在您展示的[第一个网站](http://financials.morningstar.com/income-statement/is.html?t=AAPL&ops=clear)上使用控件的五分钟内的一个简短示例。

```
procedure TForm1.WebBrowser1BeforeNavigate2(Sender: TObject;
     pDisp: IDispatch; var URL, Flags, TargetFrameName, PostData,
     Headers: OleVariant; var Cancel: WordBool);
  begin
    Edit1.Text := String(URL);
    if Pos('CSV', Edit1.Text) > 0 then
      Cancel := true;
  end; 
```

如您所见，有很多参数，您必须[找到文档](http://msdn.microsoft.com/en-us/library/aa768326%28v=vs.85%29.aspx)才能了解它们的含义。但在我的简短示例中，我所做的是将导航 URL 放入 Edit1.Text（如果您真的想观看正在发生的事情，最好使用 TMemo）。鉴于您的示例，实际上没有任何迹象表明它是直接下载的文件，但是使用上面的代码，我可以取消浏览器的操作（显示下载提示等），然后将 URL 放在 Edit1 框中在行动。如果要进一步挖掘，我相信您可以查看有问题的标题并确定该网站是否打算向您发送您应该下载的文件，因为 URL 本身并没有说“CSV文件”（把[http://financials.morningstar.com/ajax/ReportProcess4CSV.html?t=AAPL®ion=usa&culture=us_EN&reportType=is&period=12&dataType=A&order=asc&columnYear=5&rounding=3&view=raw&productCode=USA&r=809199&denominatorView=raw&number=3](http://financials.morningstar.com/ajax/ReportProcess4CSV.html?t=AAPL&region=usa&culture=us_EN&reportType=is&period=12&dataType=A&order=asc&columnYear=5&rounding=3&view=raw&productCode=USA&r=809199&denominatorView=raw&number=3)进入网络浏览器下载有问题的 CSV 文件）。

希望这对你来说是一个好的开始。

# android - 使用 adb 更改屏幕方向 Android

> ID：13377783
> 
> 赞同：2
> 
> 时间：2012-11-14T11:17:33.557
> 
> 标签：android, adb

我想更改 Nexus S 屏幕的方向。我浏览了日志，发现了这个：I/InputReader(220): Device reconfigured: id=6, name='Melfas MMSxxx Touchscreen'，表面尺寸现在是 720x1280，模式是 1 条消息。我可以使用 adb 来处理这个问题吗，因为加速度计不工作！！

# java - 在android源码中找不到自己创建的文件路径

> ID：13377784
> 
> 赞同：1
> 
> 时间：2012-11-14T11:17:37.073
> 
> 标签：java, android

我正在测试一些东西。

我在 packages/apps/Camera/ 中创建了**assets文件夹，并在文件夹中添加了****test.txt**文件。

但是当我根据下面的代码片段在**onCreate()**方法中访问该文件时，我发现我无法获取该文件。

```
 File file = new File("/assets/test.txt");
    BufferedReader reader = null;
    try {
        Log.v("jerikc","read the file");
        reader = new BufferedReader(new FileReader(file));
        String tempString = null;
        int line = 1;

        while ((tempString = reader.readLine()) != null) {

            Log.v("jerikc","line " + line + ": " + tempString);
            line++;
        }
        reader.close();
    } catch (IOException e) {
        Log.v("jerikc","exception");
        e.printStackTrace();
    } finally {
        if (reader != null) {
            try {
                reader.close();
            } catch (IOException e1) {
            }
        }
    } 
```

日志是：

*V/jerikc (3454): 读取文件*

*V/jerikc (3454)：异常*

我想我添加了错误的路径。("/assets/test.txt") 。那么正确的道路是什么？

**其他一些信息：**

我的真实代码是一个 Util 类，没有上下文。如果我加上上下文，代码结构会有很大的变化。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:27:11.957

您必须阅读以下资产

```
AssetManager mAsset = context.getAssets();

InputStream is = mAsset.open("test.txt"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:37:26.263

您可以通过这种方式从assest文件夹中获取路径...试试这个...

```
File file = new File("file:///assets/test.txt"); 
```

而不是这个..

```
File file = new File("/assets/test.txt"); 
```

# android - 在 Android 中开发 iPad 应用程序

> ID：13377788
> 
> 赞同：-3
> 
> 时间：2012-11-14T11:17:45.293
> 
> 标签：android, ipad, android-layout, android-emulator

我的任务是将 iPad 应用程序转换为 Android 平板电脑。我马上进入我的担忧。iPad 的屏幕分辨率和尺寸只有 2 个不同的版本，因此您可以在小分辨率中进行设计，并为更大的分辨率添加图形。在 Android 中这很好，你有可绘制的文件夹。但是当你在模拟器中测试时，我不应该设置 iPad 的分辨率吗？1024x748 并在那里测试我的应用程序？好的，我将使用 dp、sp、包装内容、填充父级来获得我的值，但我的目标设备是平板电脑。您对为此类任务设置模拟器有何看法？

接下来是关于建筑的一些事情。在 iPad 中，我有视图和子视图，子控制器出现在另一个控制器的“顶部”。到目前为止，我认为片段可能会发生这种情况，但是这些片段布局可以有维度吗？或者你只是挂在包装内容等？我的意思是，例如，您有一个 1024x748 的视图，另一个视图出现在屏幕右下角的顶部 300x300 上。不同的控制器，不同的视图，交换数据！关于这种设计的任何示例教程？

我可以在屏幕上的特定位置显示一个带有各种视图的“弹出”类型吗？就像您按下一个按钮，旁边会出现一个带有指向箭头的视图矩形。

提前谢谢你，我希望你能理解我在问什么。评论任何不一致之处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:18:57.977

你在这里有什么问题？您必须在 Android 上创建一个与现在在 iOS 上类似的应用程序。这两个平台在 API 和 UI 方面都不同。因此，首先，您/或您 cmpny 的设计师必须重新设计应用程序，以使其适合 Android 世界......所以换句话说，这里重要的是“你做什么”，而不是“你怎么做” “...您必须为您的 Android 用户设计相同的体验...而这并不是从简单地移植您的应用程序和编码开始的。

您不应该简单地从 iPad 应用程序中获取功能，并直接将它们强制到 Android 版本中，因为外观和感觉，两个系统的行为是不同的。在开始之前，您应该深入研究 Android 设计指南......[这里](http://developer.android.com/design/index.html)和[这里](http://developer.android.com/guide/practices/ui_guidelines/index.html)

例如：在 iPhone 世界中，您可以使用绝对定位，因为您只有几个有效分辨率。对于 Android，布局必须是动态的，因为您有大量不同的分辨率。推荐的程序布局，硬件按钮的数量，这些都是不同的。用户的期望不同。Android 手机的操作方式与基于 iOS 的设备不同……用户期望以不同方式访问功能……

另一种方法是使用能够为每个不同平台设计应用程序的框架。因此，它们有一个抽象层，在它之上（有它的约束）你设计你的应用程序，并且你可以将它发布到所有不同的平台（iOS、Android、WP7、W8、Bada 等），什么是实际平台支持..)。[这](http://sixrevisions.com/mobile/cross-platform-mobile-apps/)是有关此类平台的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T12:08:23.893

我会尝试让它变得有意义。

**到模拟器屏幕大小**

Android 有任何大小和形状，因此您应该为此进行开发。有时，将模拟器中的尺寸实际设置为一些模糊的东西，只是为了看看它是否看起来不错，这可能是一个优势。也就是说，我会在最受欢迎的平板电脑品牌上进行测试，例如：

*   Nexus 7，华硕变压器 eee pad (1280×800)
*   Nexus 10 (2560×1600)（由于尺寸大，难以测试）
*   Amazon Kindle Fire HD (1280 × 800)（与 nexus 相同，但[一些](https://stackoverflow.com/q/13156157/969325)报告表明它的处理方式不同，所以如果你有一个物理测试它）

一般来说，您应该始终在多种屏幕尺寸以及多种设备上进行测试，因为总会有一些您没有想到的差异（例如亚马逊 kindle fire HD），所以请尽可能多地使用平板电脑可以或使用某种测试服务。

**关于架构**

Android 也有视图和子视图。片段是代码和视图的简单组合，类似的视图有大小。片段可以[轻松地交换数据](https://stackoverflow.com/a/12858761/969325)，但它是通过其父活动发生的。

您**永远**不想在屏幕上的特定位置放置不同的视图。为 android 设置 UI 更像是为网页设置 UI，而不是为报纸设置 UI。您没有特定的尺寸，但每个设备都有不同的尺寸。因此，您应该制作一个可以拉伸到各种尺寸并且仍然看起来不错的布局。这可以通过多种方式实现。

# php - jqplot 图表未显示在我的 jquerymobile 页面中

> ID：13377790
> 
> 赞同：2
> 
> 时间：2012-11-14T11:17:57.123
> 
> 标签：php, json, jquery, jquery-mobile, jqplot

我正在准备一个 jquerymobile 应用程序，我想在其中插入一个 jqplotchart，以便为此编写代码。但现在问题是图表没有显示在我的页面中。

图书馆我

```
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<link rel="stylesheet" href="stylesheets/jquery.mobile-1.1.1.min.css" type="text/css"/>
<link rel="stylesheet" href="stylesheets/jquery.jqplot.css" type="text/css"/>
<link rel="stylesheet" href="stylesheets/jqm-docs.css" type="text/css"/>
<script src="jquery.jqplot.min.js" type="text/javascript"></script>
<script src="jqplot.pieRenderer.min.js" type="text/javascript"></script>
<script src="jqplot.barRenderer.min.js" type="text/javascript"></script>
<script src="jqplot.categoryAxisRenderer.min.js" type="text/javascript"></script>
<script src="underscore-min.js" type="text/javascript"></script>
<script src="hideAddressBar.js" type="text/javascript"></script>
<script src="app.js" type="text/javascript"></script>
<script type="text/javascript" src="jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="jquery.dataTables.min.js"></script>
<script type="text/javascript" src="jquery.mobile-1.2.0.min.js"></script>
<script type="text/javascript" src="jqm-docs.js"></script>
<script type="text/javascript" src="jquery.flot.min.js"></script>
<script type="text/javascript" src="JQPlot/plugins/jqplot.canvasAxisLabelRenderer.min.js"></script>
<script type="text/javascript" src="JQPlot/plugins/jqplot.canvasTextRenderer.min.js"></script> 
```

我写的javascript：

```
$(document).bind("mobileinit",function() {
            // go to server for chart data

            $('#pagePlotChart').live('pageshow',function() {
            $.get("mygraphdata",  function(data){
            $.jqplot('plotChart', data,{ 
                title:'My Chart',
            axesDefaults: 
                { 
                labelRenderer: $.jqplot.CanvasAxisLabelRenderer
                },
            axes: 
                { xaxis: { label:"Day", pad: 0 }, 
                yaxis: { label: "Measurement" } 
            } 
            });
            }); 
            return false;
            });
            }); 
```

html代码：

```
<div id="pagePlotChart" data-role="page" data-rockncoder-jspage="managePlotChart">
    <header data-role="header" data-position="fixed">
        <h1>Plot Chart</h1>
    </header>
    <section data-role="content">
        <div id="plotChart" class="myChart"></div>
        <button id="refreshPlotChart" value="Refresh Chart" data-mini="true"></button>
    </section>
</div> 
```

实际上我必须从一些 php 文件中获取 json 数据并传递给这个图表。并且图表应该通过使用来自某个 php 文件的 json 数据来显示图表。

我的 json 数据将采用这种格式 ["v1:myName","g:233","h:322"]..etc。

php 文件正在发送 json 数据。我签入了提琴手。但图表不起作用。请告诉我解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T00:41:02.083

请参阅有关 jQuery Mobile 在页面初始化后呈现内容的[相关问题。](https://stackoverflow.com/questions/5651776/jquery-mobile-rendering-problems-with-content-being-added-after-the-page-is-init)基本上，您可以根据 naugtur 的评论使用 .trigger('create') 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T13:38:57.217

首先，我注意到您在页面标题中加载了 jQuery mobile 两次。尝试删除旧版本，并将大部分或全部 JS 包含移动到页脚，这样您的页面可以（部分）在浏览器下载 JS 文件之前呈现。jqplot 组件的最佳实践当然是将包含移动到页脚。

加载 jqplot 组件的实际顺序几乎是正确的。不过，看起来主 jQuery 文件需要在主 jqplot 文件之前加载 - 现在只有移动版本的 jQuery 在 jqplot 之前加载。请参阅[此答案](https://stackoverflow.com/questions/11747241/including-jqplot-files-in-particular-order/14225435#14225435)以获取更多详细信息。

如果 jqplot 正在加载但数据不存在，或者数据或图表代码可能有错误，您将在图表所在的页面中看到一个空白区域。确保您可以加载与您从 PHP 页面获取的数据一起手工组装的静态图表页面。这将测试数据和包含。

如果 jqplot 根本没有加载（例如，如果依赖项没有按正确的顺序加载），您将在页面上根本看不到图表的任何空白空间，并且它将在图表应该存在的地方以零空间呈现。

看起来您正确调用了图表 div。但是我不确定是否`$(document).bind("mobileinit",function()`有效。jqplot 的基本调用通常是 `$(document).ready(function()`. 在呈现页面时最初不可见的 div 中设置图表可能会很棘手。如果这就是问题所在，[这个问题可能会有所帮助。](https://stackoverflow.com/questions/5489885/why-does-my-chart-jqplot-fail-to-render-until-i-press-a-button-when-integrated?rq=1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-10T07:56:10.310

**There is an easier way (worked in my case):**

-**first:** delare your *plot container div* outside of any page (for example just below *body* tag):

```
<body>
<div id="plotContainer"></div>
... 
```

-**then:** set the plot (Chart) in your *$(document).ready(function(){ ... **here** ... });* and hide it so it will not show between pages:

```
$("#jqxChart").jqxChart(settings);
$("#jqxChart").hide(); 
```

-**finaly:** just copy the div with the plot inside your page:

```
<script>
$('#page_ID').bind('pageshow', function(data) { 
$("#jqxChart").appendTo("#ID_of_DIV_you_want");
$("#jqxChart").show();  
$('#jqxChart').jqxChart('refresh');
});
</script> 
```

Hope this helps!!!

# python - 是否可以在不将整个文档加载到内存的情况下获取 Excel 文档的行数？

> ID：13377793
> 
> 赞同：65
> 
> 时间：2012-11-14T11:18:02.283
> 
> 标签：python, openpyxl

我正在开发一个处理大型 Excel 2007 文件的应用程序，我正在使用[OpenPyXL](http://packages.python.org/openpyxl/)来完成它。OpenPyXL 有两种不同的读取 Excel 文件的方法——一种是“普通”方法，即一次将整个文档加载到内存中，另一种方法是使用迭代器逐行读取。

问题是当我使用迭代器方法时，我没有得到任何文档元数据，如列宽和行/列数，我**真的**需要这些数据。我假设这些数据存储在靠近顶部的 Excel 文档中，因此不必将整个 10MB 文件加载到内存中即可访问它。

那么，有没有办法在不先将整个文档加载到内存中的情况下获得行/列数和列宽？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2015-09-10T22:52:10.113

加上 Hubro 所说的，显然`get_highest_row()`已被弃用。使用`max_row`and`max_column`属性返回行数和列数。例如：

```
 wb = load_workbook(path, use_iterators=True)
    sheet = wb.worksheets[0]

    row_count = sheet.max_row
    column_count = sheet.max_column 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-14T14:32:13.663

# **此答案中建议的解决方案已被弃用，可能不再有效。**

* * *

看一下 OpenPyXL ( [IterableWorksheet](https://bitbucket.org/ericgazoni/openpyxl/src/94b05cf9defb9787b4dfbf9e8dca7ba6e0b33d56/openpyxl/reader/iter_worksheet.py?at=default#cl-251) ) 的源代码，我已经弄清楚了如何从迭代器工作表中获取列数和行数：

```
wb = load_workbook(path, use_iterators=True)
sheet = wb.worksheets[0]

row_count = sheet.get_highest_row() - 1
column_count = letter_to_index(sheet.get_highest_column()) + 1 
```

`IterableWorksheet.get_highest_column`返回一个字符串，其中包含您可以在 Excel 中看到的列字母，例如“A”、“B”、“C”等。因此我还编写了一个函数来将列字母转换为从零开始的索引：

```
def letter_to_index(letter):
    """Converts a column letter, e.g. "A", "B", "AA", "BC" etc. to a zero based
    column index.

    A becomes 0, B becomes 1, Z becomes 25, AA becomes 26 etc.

    Args:
        letter (str): The column index letter.
    Returns:
        The column index as an integer.
    """
    letter = letter.upper()
    result = 0

    for index, char in enumerate(reversed(letter)):
        # Get the ASCII number of the letter and subtract 64 so that A
        # corresponds to 1.
        num = ord(char) - 64

        # Multiply the number with 26 to the power of `index` to get the correct
        # value of the letter based on it's index in the string.
        final_num = (26 ** index) * num

        result += final_num

    # Subtract 1 from the result to make it zero-based before returning.
    return result - 1 
```

虽然我还没有弄清楚如何获得列大小，所以我决定在我的应用程序中使用固定宽度的字体和自动缩放的列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-10-15T07:55:39.653

蟒蛇 3

```
import openpyxl as xl

wb = xl.load_workbook("Sample.xlsx", enumerate)

#the 2 lines under do the same. 
sheet = wb.get_sheet_by_name('sheet') 
sheet = wb.worksheets[0]

row_count = sheet.max_row
column_count = sheet.max_column

#this works fore me. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-15T12:27:49.483

这可能非常令人费解，我可能会遗漏明显的内容，但是如果没有 OpenPyXL 填充 Iterable Worksheets 中的 column_dimensions （请参阅我上面的评论），我可以看到在不加载所有内容的情况下找到列大小的唯一方法是直接解析 xml ：

```
from xml.etree.ElementTree import iterparse
from openpyxl import load_workbook
wb=load_workbook("/path/to/workbook.xlsx", use_iterators=True)
ws=wb.worksheets[0]
xml = ws._xml_source
xml.seek(0)

for _,x in iterparse(xml):

    name= x.tag.split("}")[-1]
    if name=="col":
        print "Column %(max)s: Width: %(width)s"%x.attrib # width = x.attrib["width"]

    if name=="cols":
        print "break before reading the rest of the file"
        break 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-21T14:57:14.217

使用熊猫的选项。

1.  获取具有行数和列数的所有工作表名称。

```
import pandas as pd
xl = pd.ExcelFile('file.xlsx')
sheetnames = xl.sheet_names
for sheet in sheetnames:
    df = xl.parse(sheet)
    dimensions = df.shape
    print('sheetname', ' --> ', dimensions) 
```

2.  行和列的单张计数。

```
import pandas as pd
xl = pd.ExcelFile('file.xlsx')
sheetnames = xl.sheet_names
df = xl.parse(sheetnames[0])   # [0] get first tab/sheet.
dimensions = df.shape
print(f'sheetname: "{sheetnames[0]}" - -> {dimensions}') 
```

输出`sheetname "Sheet1" --> (row count, column count)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-08T03:41:31.983

[https://pythonhosted.org/pyexcel/iapi/pyexcel.sheets.Sheet.html](https://pythonhosted.org/pyexcel/iapi/pyexcel.sheets.Sheet.html) 参见：row_range() 实用函数获取行范围

如果你使用 pyexcel，可以调用 row_range 获取最大行数。

python 3.4 测试通过。

# objective-c - 将日期时间从 NSString 转换为 NSDate

> ID：13377795
> 
> 赞同：0
> 
> 时间：2012-11-14T11:18:07.120
> 
> 标签：objective-c, ios, nsdate, xcode4.5, nstimezone

时区总是给我带来麻烦。这次我必须将我在 NSSTring 中的 date-time 转换为 NSDate。

我正在做这样的事情。

```
NSString *myStringDate=@"14-11-2012 4:09:00 PM +0500"

NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setTimeZone:[NSTimeZone systemTimeZone]];
[formatter setDateFormat:@"dd-MM-yyyy h:mm:ss a Z"];

NSDate *aDate = [formatter dateFromString:myStringDate];
NSLog(@"%@",aDate); 
```

但我有这样的输出

`14-11-2012 11:09:00 +0000`

此外，没有设置 AM/PM :-(

我想要的是`14-11-2012 4:09:00 PM +0500`与字符串中相同的日期时间。

感谢期待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:36:32.483

转换的输出是 GMT 时间

```
NSString *myStringDate=@"14-11-2012 4:09:00 PM +0500"

NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setTimeZone:[NSTimeZone systemTimeZone]];
[formatter setDateFormat:@"dd-MM-yyyy h:mm:ss a Z"];

NSDate *aDate = [formatter dateFromString:myStringDate];

 NSDateFormatter* df_utc = [[[NSDateFormatter alloc] init] autorelease];
 [df_utc setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
 [df_utc setDateFormat:@"yyyy.MM.dd G 'at' HH:mm:ss zzz"];

 NSDateFormatter* df_local = [[[NSDateFormatter alloc] init] autorelease];
 [df_local setTimeZone:[NSTimeZone timeZoneWithName:@"EST"]];
 [df_local setDateFormat:@"yyyy.MM.dd G 'at' HH:mm:ss zzz"];

 NSString* ts_utc_string = [df_utc stringFromDate:aDate];
 NSString* ts_local_string = [df_local stringFromDate:aDate]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:28:21.497

Here Is the Change need to be taken.

```
[formatter setDateFormat:@"dd-MM-yyyy h:mm:ss a "]; 
```

Thanks

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:38:50.407

转换看起来是正确的，但默认输出是 UTC 时间 ( `+0000`) 和 24 小时制时钟，这就是为什么您没有区分 AM/PM 的原因（“01:00 PM”将是 13:00）。如果你想要一个特定的表示，你还需要格式化*输出*`[formatter stringFromDate:aDate]`( )...</p>

对于 UTC 问题，您需要选择您选择的时区，方法是使用该选项代替`[NSTimeZone systemTimeZone]`. 尝试`[NSTimeZone localTimeZone]`入门。

# asp.net-mvc - SinglePageApplication - 匹配 2012 年秋季更新的示例视频

> ID：13377798
> 
> 赞同：1
> 
> 时间：2012-11-14T11:18:12.463
> 
> 标签：asp.net-mvc, single-page-application

我正在尝试重新创建 Steven Sanderson 演示的 ASP.NET 单页应用程序

> 单页应用程序 - 适用于带有 ASP.NET MVC4 的台式机、移动设备、平板电脑

我已经下载并安装了 Build Preview - [http://www.asp.net/vnext](http://www.asp.net/vnext)
我使用 NuGet，尝试将我的 SPA 脚手架更新到 ASP.NET SPA MVC 4 (Beta)
我正在运行 Visual Studio 2012

当我创建一个新的 MVC4 应用程序时，我所拥有的和我看到的演示之间存在一些明显的差异。

首先，在创建一个新项目后，如果您查看您拥有的站点看起来完全不同

**史蒂夫桑德森得到什么**

![史蒂夫的默认值](../Images/5f99bcf0c4c4bd20316e2f9d945b1a37.png)

**我得到什么**

![我的默认](../Images/4fcb40e3d11b3b24f49965bb8f302edf.png)

然后继续按照他的例子，他创建了一个控制器，并有一个选项

> 具有读/写操作和视图的单页应用程序，使用实体框架

这在我的创建控制器对话框中不可用

**史蒂夫桑德森得到什么**

![Steve 的添加控制器对话框](../Images/42f540cfeb0089d97baeb19c0ca69dcc.png)

**我得到什么**

![我的添加控制器对话框](../Images/50e5e5b9082ab92d8981ee7234fde596.png)

为什么我的选项不一样？
我没有安装什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T02:30:29.367

正如您所发现的，新的 SPA 模板是一个完全不同的模板。短篇小说... 新模板被修改为起点，旧模板被认为过于规范。

新模板是一个预览版，在发布时会有更多变化。这个想法是您可以将其用作 SPA 的起点，然后根据需要添加功能和其他库。

更新：如果您想了解有关最新模板中内容的更多信息，可以在此处阅读我的帖子：http: [//www.johnpapa.net/insidespatemplate](http://www.johnpapa.net/insidespatemplate)

# python - Python ctypes：一字节变量

> ID：13377806
> 
> 赞同：1
> 
> 时间：2012-11-14T11:18:59.387
> 
> 标签：python, ctypes

使用 python 结构`pack('<B',1)`值正确打包`<01>`到一个字节，但使用 ctypes 我无法获得类似的结果。

是否可以使用 ctypes 获得相同的结果？

`c_byte`似乎是 4 个字节`<01000000>`。

添加了示例代码。

```
class TEST(Structure):
    _fields_ = [("int", c_int),("byte", c_byte)]

test = TEST(2,1)
print test.int
print test.byte

#bytes
print hexlify(buffer(test)[:]) 
```

现在打印是

```
2
1
0200000001000000 
```

字节应该是 0200000001。是因为缓冲区调用还是我应该以某种方式声明字节对齐？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:56:31.470

这可能是因为对齐/填充，使用[`_pack_`](http://docs.python.org/dev/library/ctypes.html#ctypes.Structure._pack_)设置：

```
class TEST(Structure):
    _pack_ = 1
    _fields_ = [("int", c_int),("byte", c_byte)]

test = TEST(2,1)    
print hexlify(test) 
```

将打印`0200000001`

# javascript - 做 support javascript in design mode?

> ID：13377808
> 
> 赞同：0
> 
> 时间：2012-11-14T11:19:03.007
> 
> 标签：javascript, html, iframe

Does the HTML nodes in `<iframe>` support javascript in design mode? For the following code, dialog doesn't pop up when I click the `<span>`. My browser is FF 16.0.2\. Is there any way to get an alert when clicking the span?

```
<html>
  <body >
    <iframe id="myeditor" style="width:500px; height:170px;"></iframe><br><br>
    <script type="text/javascript">
      editor = document.getElementById("myeditor").contentWindow;
      editor.document.designMode="on";
      editor.document.open();

      editor.document.write('head <span onclick="alert(1)" style="border: solid 1px #666">click me</span> tail');

      editor.document.close();
    </script>

  </body>
</html> 
```

Thanks for reading here. :D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:27:37.220

> **Event Handling Disabled**
> 
> A further difference for Mozilla is that once a document is switched to designMode, all events on that particular document are disabled. Once designMode is turned off however (as this now seems possible in Mozilla 1.5) the events become active again.

From [MDN](https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla).

# select - 游标中的查询 SELECT 错误

> ID：13377810
> 
> 赞同：0
> 
> 时间：2012-11-14T11:19:14.737
> 
> 标签：select, plsql, cursor, procedure

我在光标中的选择有问题。选择在其他窗口中正常工作，但我在使用光标的过程中出现错误，为什么？我更改了表和数据库的名称，但在此过程之外选择可以

**我的错误：PL/SQL：ORA-04052：ORA-00604：ORA-03106：**

```
CREATE OR REPLACE PROCEDURE ChangeDismissDate
IS
BEGIN
    DECLARE
          v_id VARCHAR2(40);
          v_dateABC DATE;
          v_dateDismiss DATE;
        CURSOR cur IS
                select emp.EMP_NO, abc.date, emp.DISMISS_DATE  
                from  bazaabc.EmployeesDetails@BAZA_ABC abc,
                      employee_tab emp,
                      person_info_tab pin,
                      oracle_account oa
                where bhd.emp_no = emp.EMP_NO
                and   pin.PERSON_ID = emp.EMP_NO
                and   oa.USERNAME = pin.USER_ID
                and   emp.EMP_NO in (    
                select pi.PERSON_ID from tab_person pi
                where fu.active = 'TRUE'
                and   fu.IDENTITY = pi.USER_ID) AND emp.EMP_NO like '%L%'
                and nvl(abc.date,to_date('20491231','yyyymmdd')) <> nvl(emp.DISMISS_DATE,to_date('20491231','yyyymmdd'));

        BEGIN
                       OPEN cur;
                           LOOP
                                FETCH cur INTO v_id,v_dateABC,v_dateDismiss;

                                 DBMS_OUTPUT.PUT_LINE('v_id:  ' || v_id);
                                 DBMS_OUTPUT.PUT_LINE('v_dateABC:  ' || v_dateABC);
                                 DBMS_OUTPUT.PUT_LINE('v_dateDismiss:  ' ||v_dateDismiss );

                           EXIT WHEN cur%NOTFOUND;
                           END LOOP;
                       CLOSE cur;
        END;

END;
/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:12:32.703

您可以通过添加异常块来尝试解决您遇到的错误吗

```
CREATE OR REPLACE PROCEDURE ChangeDismissDate
IS
BEGIN
    DECLARE
          v_id VARCHAR2(40);
          v_dateABC DATE;
          v_dateDismiss DATE;
        CURSOR cur IS
                select emp.EMP_NO, abc.date, emp.DISMISS_DATE  
                from  bazaabc.EmployeesDetails@BAZA_ABC abc,
                      employee_tab emp,
                      person_info_tab pin,
                      oracle_account oa
                where bhd.emp_no = emp.EMP_NO
                and   pin.PERSON_ID = emp.EMP_NO
                and   oa.USERNAME = pin.USER_ID
                and   emp.EMP_NO in (    
                select pi.PERSON_ID from tab_person pi
                where fu.active = 'TRUE'
                and   fu.IDENTITY = pi.USER_ID) 
                AND emp.EMP_NO like '%L%'
                and nvl(abc.date,to_date('20491231','yyyymmdd')) <>  
                nvl(emp.DISMISS_DATE,to_date('20491231','yyyymmdd'));

        BEGIN
                       OPEN cur;
                           LOOP
                  FETCH cur INTO v_id,v_dateABC,v_dateDismiss;    
                  DBMS_OUTPUT.PUT_LINE('v_id:  ' || v_id);
                  DBMS_OUTPUT.PUT_LINE('v_dateABC:  ' || v_dateABC);
                  DBMS_OUTPUT.PUT_LINE('v_dateDismiss:  ' ||v_dateDismiss );

                           EXIT WHEN cur%NOTFOUND;
                           END LOOP;
                       CLOSE cur;
        END;
EXCEPTION
    WHEN NO_DATA_FOUND
    THEN
        DBMS_OUTPUT.put_line (DBMS_UTILITY.format_error_stack);
    WHEN OTHERS
    THEN
        DBMS_OUTPUT.put_line (DBMS_UTILITY.format_error_stack);

END;
/ 
```

# php - 使用 PHP FreeTDS 扩展从 MSSQL 服务器获取带有 UTF-8 字符集的数据

> ID：13377812
> 
> 赞同：19
> 
> 时间：2012-11-14T11:19:25.353
> 
> 标签：php, sql-server, utf-8, freetds

我似乎无法使用 FreeTDS 扩展从编码为 UTF-8 的 MSSQL 获取数据。

连接：

```
ini_set('mssql.charset', 'UTF-8');
$this->_resource = mssql_connect($config['servername'], $config['username'], $config['password']); 
```

我无法使用任何其他扩展。

我试过创建 ~/.freetds.conf

```
[global]
client charset = UTF-8 
```

我试过将参数传递给php：

```
php -d mssql.charset="UTF-8" index.php 
```

数据仍然不是 UTF-8。

php -i

```
mssql

MSSQL Support => enabled
Active Persistent Links => 0
Active Links => 0
Library version => FreeTDS

Directive => Local Value => Master Value
mssql.allow_persistent => On => On
mssql.batchsize => 0 => 0
mssql.charset => no value => no value
mssql.compatability_mode => Off => Off
mssql.connect_timeout => 5 => 5
mssql.datetimeconvert => On => On
mssql.max_links => Unlimited => Unlimited
mssql.max_persistent => Unlimited => Unlimited 
```

想法？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-14T11:25:34.800

我有一个类似的问题，并尝试了我可以在网上找到的所有设置 - 徒劳无功。

就我而言，问题在于 FreeTDS 本身的配置。在 Linux 上，该文件是 /etc/freetds/freetds.conf

我不得不将版本更改为 7.0（也许其他数字也可以。我刚试过 7.0）

```
[global]
    # TDS protocol version
    tds version = 7.0 
```

在此之后，驱动程序似乎接受了字符集的更改。

```
ini_set('mssql.charset', 'UTF-8'); 
```

顺便说一句：更改立即生效，之后无需重新启动任何内容

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-14T11:27:36.543

MSSQL 和 UTF-8 有时是相当痛苦的。我不得不手动转换它。问题：MSSQL 实际上并不了解和支持 UTF-8。

从数据库值转换为 UTF-8：

```
mb_detect_encoding($value, mb_detect_order(), true) === 'UTF-8' ? $value : mb_convert_encoding($value, 'UTF-8'); 
```

从 UTF-8 转换为数据库值：

```
mb_convert_encoding($value, 'UCS-2LE', mb_detect_encoding($value, mb_detect_order(), true)); 
```

幸运的是，我使用的是 Doctrine，所以我所要做的就是创建一个自定义的 StringType 实现。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-02-26T11:58:39.693

如果您使用 freeTDS，您应该更改以下行`/etc/freetds/freetds.conf`：

```
[global]
# TDS protocol version
tds version = 4.2 
```

对此：

```
[global]
# TDS protocol version
tds version = 8.0
;tds version = 4.2 
```

最后添加这一行：

```
# set charset
client charset = UTF-8 
```

** clinet 字符集在全局 [范围]

在您的查询中，您应该使用 N 个字符。像这样：

```
$query = "INSERT INTO dbo.SMSOutbox (StationID, Dest, Text) VALUES ";
   $query .= '(';
   $query .= "'" . $this->stationId . "', ";
   $query .= "'" . $this->destination . "', ";
   $query .= "N'" . $this->text . "'";
   $query .= ')'; 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-06-17T14:07:23.073

您还可以通过在连接到数据库之前在 $connectionInfo 中添加 CharacterSet UTF-8 来解决此问题。

```
$serverName = "MyServer";
$connectionInfo = array( "Database"=>"AdventureWorks", "CharacterSet" => "UTF-8");
$conn = sqlsrv_connect( $serverName, $connectionInfo); 
```

工作正常不需要额外的编码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-14T18:23:16.853

似乎需要 7.0 或更高版本。iconv() 似乎也很好用，但是很乏味。

```
$query = $this->db->query($sql);
$result = $query->fetchAll(PDO::FETCH_OBJ);
foreach ($result as $row) {
    foreach (get_object_vars($row) as $key => $value) {
    $row->$key = (mb_detect_encoding($value, mb_detect_order(), true) === 'UTF-8') 
            ? $value : iconv('iso-8859-1', 'utf-8', $value);
    }
    $results[] = $row;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-25T07:21:52.200

我遇到了这个问题，并通过在连接到 MSSQL Server 之前将此行添加到我的 php 脚本中来解决：

```
ini_set('mssql.charset', 'UTF-8'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-02T17:40:07.943

您应该根据您使用的 SQL Server 版本更改您的 TDS 版本。查看安装指南了解详细信息。

[http://www.freetds.org/userguide/choosingtdsprotocol.htm](http://www.freetds.org/userguide/choosingtdsprotocol.htm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-21T12:12:32.890

我使用与上面相同但Windows 1250，所以：

```
$query = $this->db->query($sql);
$result = $query->fetchAll(PDO::FETCH_OBJ);
foreach ($result as $row) {
    foreach (get_object_vars($row) as $key => $value) {
    $row->$key = (mb_detect_encoding($value, mb_detect_order(), true) === 'UTF-8') 
            ? $value : iconv('windows-1250', 'utf-8', $value);
    }
    $results[] = $row;
} 
```

然后它起作用了，但我使用波兰语字符

# javascript - 在 Silverlight 中调用 javascript

> ID：13377816
> 
> 赞同：2
> 
> 时间：2012-11-14T11:19:40.807
> 
> 标签：javascript, wpf, silverlight

我有一个 Silverlight 应用程序，它与我的网络摄像头进行通信以拍照。

**Silverlight 代码**

```
protected void photoButton_Click(object sender, RoutedEventArgs e)
{
    this.src.CaptureImageCompleted += (s, a) =>
    {
        this.lastSnapshot = a.Result;
        this.snapshot.Visibility = Visibility.Visible;
        this.snapshot.Source = this.lastSnapshot;
        HtmlPage.Window.Invoke("SalvaFoto");                
        this.src.Stop();
    };

    src.CaptureImageAsync();
} 
```

**ASPX 我在哪里调用我的 Silverlight 应用程序**

```
 var htmlEmbedSilverlight = "<div id='silverlightControlHost'> "
                    + "<object data='data:application/x-silverlight-2,' type='application/x-silverlight-2' width='550px' height='250px'> "
                    + "<param name='source' value='../../ClientBin/FotoEmprestimoChave.xap'/> "
                    + "<param name='onError' value='onSilverlightError' /> "
                    + "<param name='background' value='white' /> "
                    + "<param name='minRuntimeVersion' value='4.0.60310.0' /> "
                    + "<param name='autoUpgrade' value='true' /> "
                    + "<param name='InitParams' value='chave_id=" + data + "' /> "
                    + "<a href='http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.60310.0' style='text-decoration:none'> "
                    + "<img src='http://go.microsoft.com/fwlink/?LinkId=161376' alt='Get Microsoft Silverlight' style='border-style:none'/> "
                    + "</a> "
                    + "</object><iframe id='_sl_historyFrame' style='visibility:hidden;height:0px;width:0px;border:0px'></iframe></div>";
            $("#tiraFotoSilverlight").html(htmlEmbedSilverlight); 
```

**问题**

当我尝试`Javascript`在当前`ASPX`页面中执行时`HtmlPage.Windows.Invoke("javascript_method");`不起作用。

我做错了什么？

我也尝试过以下代码但没有成功

```
protected void photoButton_Click(object sender, RoutedEventArgs e)
{
    this.src.CaptureImageCompleted += (s, a) =>
    {
        this.lastSnapshot = a.Result;
        this.snapshot.Visibility = Visibility.Visible;
        this.snapshot.Source = this.lastSnapshot;

        HtmlElement Script = HtmlPage.Document.CreateElement("script");
        Script.SetAttribute("type", "text/javascript");
        Script.SetProperty("text", "$(document).ready(function () { alert('hi'); });");

        this.src.Stop();
    };

    src.CaptureImageAsync();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T14:32:43.690

我是新的 Silverlight/Javascript，但是在我这样做的地方，我需要使用 Dispatcher.BeginInvoke：

```
Dispatcher.BeginInvoke(() =>
    {
        HtmlPage.Window.Invoke("SalvaFoto");
    }); 
```

# facebook - 使用 Javascript SDK 在没有任何对话的情况下发布 Facebook 帖子

> ID：13377819
> 
> 赞同：2
> 
> 时间：2012-11-14T11:20:00.813
> 
> 标签：facebook, facebook-javascript-sdk

我一直在寻找没有显示对话的 facebook 发布。在阅读 Facebook 开发人员文档时，有几件事似乎可以回答这个问题，但在使用它们之后，我得出结论，这些内容不适用于此功能。

1.  显示模式：它们是不同类型的对话显示模式，但如果我不想显示对话，则无法定义。
2.  显式共享：这似乎是最接近的。但是没有办法在 JS SDK 中使用它。那里提到的参数，我在JS中试过，但没有解决。

然后在这里对我来说最成功的是使用

> 方法：'/我/饲料'

但问题是，它说：

> [用户] 分享了一个链接

这是我不想要的。我想要一个正常的发布，但不显示任何对话。

我用于简单发布的代码如下：

```
function publishNewsFeed(picURL, name, caption, description)
{
    var obj = 
    {
      method: 'feed',
      link: fbAppURL,
      picture: picURL,
      name: name,
      caption: caption,
      description: description
    };
    function callback(response) 
    {
      document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
    }          

    FB.ui(obj, callback);
} 
```

任何帮助将不胜感激。

谢谢-WI

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:02:16.437

> 显示模式：它们是不同类型的对话显示模式，但如果我不想显示对话，则无法定义。

那将是胡说八道——如果你不想*使用*对话框，那么就不要使用对话框。

但是如果你想使用一个对话框，那么它必须以某种方式“显示”——否则它就*不是*一个对话框。

> 但问题是，它说*[User] 共享了一个*我不想要的链接。

这是当前的“错误”——如果您在帖子中提供操作链接，它将正常显示。

[https://developers.facebook.com/bugs/485696594791863](https://developers.facebook.com/bugs/485696594791863)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T05:10:09.627

试试这个：

```
function jesseSays(){
    var body = 'Yeah science Mr. White!!';
    FB.api('/me/feed', 'post', { 
      message: body,
      link: 'http://www.neoapps.com.br',
      picture: 'http://www.neoapps.com.br/assets/img/logo-big.png'
    }, function(response) {
      if (!response || response.error) {
        alert('Error occured');
      } else {
        alert('Post ID: ' + response.id);
      }
    });
  } 
```

# pool - apache commons pool - 如何使用带参数的工厂

> ID：13377820
> 
> 赞同：1
> 
> 时间：2012-11-14T11:20:05.943
> 
> 标签：pool, apache-commons-pool

我正在尝试使用 apache commons pool 创建一个“对象”池。由于我已经有一个对象工厂，它接受一个字符串类型参数并创建一个正确类型的对象，我想使用这个工厂。

但问题是通用池对象的签名都不允许我传递一个带参数的工厂。

```
//This is a wrapper class that holds an Object pool
Class INService {

    private ObjectPool<INConnection> pool_ = null;

    /**
     * Constructs an instance of INService, given a pool size 
     * and a class which implements INHandler interface.
     * @param poolSize - size of the service pool 
     * @param c - the class which handles the INHandler service interface.
     */
    public INService(int poolSize, String objectType) {

        pool_ = new GenericObjectPool<INConnection>(factory, Objecttype); // won't compile.
    }
    ...
} 
```

PoolableObjectfactory 接口定义了 makeObject、destroyObject、validateObject、activateObject 和 passivateObject 等方法。但是没有带参数的 makeObject() 方法。

似乎我能做到这一点的唯一方法是为每种类型的对象编写多个工厂类并编写 if-else 的东西，例如：

```
 public INService(int poolSize, String objectType) {

        if (objectType.equals("scap")
            pool_ = new GenericObjectPool<INConnection>(scapFactory);
        else if (objectType.equals("ucip")
            pool_ = new GenericObjectPool<INConnection>(ucipFactory);
        ...
    } 
```

或者，有没有什么优雅的方法，而不是仅仅为了这个而复制/创建几个工厂类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T13:02:21.847

您应该阅读[`KeyedObjectPool<K,V>`](https://commons.apache.org/proper/commons-pool/apidocs/org/apache/commons/pool2/KeyedObjectPool.html "Apache Commons-Pool：KeyedObjectPool 接口")也可以在 commons-pool 中找到的界面。

从它的javadoc：

```
A keyed pool pools instances of multiple types. Each type may be accessed using an arbitrary key. 
```

然后，您可以实现 a`KeyedPoolableObjectFactory<K,V>`根据`key`参数创建实例，它具有[`makeObject(K key)`](https://commons.apache.org/proper/commons-pool/apidocs/org/apache/commons/pool2/KeyedPooledObjectFactory.html#makeObject-K-)您正在寻找的功能。

PS：您似乎没有将您的问题的任何答案标记为“已接受”，您可能想要解决这个问题。

# c# - 如何使用公共属性设置私有成员的值？

> ID：13377821
> 
> 赞同：0
> 
> 时间：2012-11-14T11:20:06.850
> 
> 标签：c#

这是我的课：

```
 class EmpDetails
    {
        private string _EmpName;
        private int _EmpID;
        private string _EmpDepartment;
        private string _EmpPosition;

        public string EmpName
        {
            get
            {
                return _EmpName;
            }
            set
            {
                _EmpName = value;
            }
        }
        public int EmpID
        {
            get
            {
                return _EmpID;
            }
            set
            {
                _EmpID = value;
            }

        }
        public string EmpDepartment
        {
            get
            {
                return _EmpDepartment;
            }
            set
            {
                _EmpDepartment = value;
            }
        }
        public string EmpPosition
        {
            get
            {
                return _EmpPosition;
            }
            set
            {
                _EmpPosition = value;
            }
        }
    }
} 
```

以下是我的表格：

```
public partial class Form1 : Form

    {
        EmpDetails d = new EmpDetails();
        public Form1()
        {
            InitializeComponent();
        }

        private void btnSet_Click(object sender, EventArgs e)
        {
            d.EmpName = txtName.Text;
            d.EmpID = Convert.ToInt32(txtID.Text);
            d.EmpDepartment = txtDepartment.Text;
            d.EmpPosition = txtPosition.Text;
        }

        private void btnClear_Click(object sender, EventArgs e)
        {
            txtName.Clear();
            txtID.Clear();
            txtDepartment.Clear();
            txtPosition.Clear();
        }

        private void btnGet_Click(object sender, EventArgs e)
        {
            txtName.Text = d.EmpName;
            txtID.Text = Convert.ToString(d.EmpID);
            txtDepartment.Text = d.EmpDepartment;
            txtPosition.Text = d.EmpPosition;
        }
    }
} 
```

我正在使用表单中的文本框设置值，以便这些值进入我在类中创建的属性。

我收到如下错误： `EncapsulationAssignmentCSharp.EmpDetails` 不包含定义，并且找不到 接受第一个类型参数的 `GetEmpName`扩展方法（您是否缺少 using 指令或程序集引用？`GetEmpName``EncapsulationAssignmentCSharp.EmpDetails`

我猜我必须创建一个带参数的构造函数并使用关键字设置值`this`，但我不确定如何将值传递给构造函数。请帮助我，我不太擅长编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-21T21:46:49.287

调试并运行代码并检查您的代码是否正在调用 GetEmpName

# php - 找不到命令：P HP exec()

> ID：13377823
> 
> 赞同：4
> 
> 时间：2012-11-14T11:20:15.290
> 
> 标签：php, node.js, shell

这真让我抓狂。我需要让 php 执行命令来重新启动在节点中运行的脚本。我正在使用一个永远调用的节点应用程序来运行所述脚本。代码如下：

```
<?php 
  echo '<pre>';
  echo exec('sudo -u dalton forever restart botti.js 2>&1');
  echo '</pre>';
?> 
```

但是，当我运行它时，我得到`sudo: forever: command not found`

接下来，我尝试`which forever`and `type forever`，两者都给了我：
`forever: /usr/local/bin/forever`

我将代码编辑为：
`echo exec('sudo -u dalton /usr/local/bin/forever restart botti.js 2>&1');`

编辑：拼写错误后，现在的错误是：
`/usr/bin/env: node: No such file or directory`

我无计可施。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T11:49:08.483

由于该`forever`命令仅运行，当您提供完整路径时，我怀疑它`/usr/local/bin`不在您的`PATH`环境变量中，该变量包含所有目录，默认情况下搜索可执行命令，以分隔`:`（我怀疑您在 Linux 上，可能其他操作系统不同）

我怀疑`forever`电话`/usr/bin/env node`。来自的错误`env`可能是由于`node`不在您的范围内引起的`PATH`。

要在 php 中设置 PATH，请使用`putenv('PATH=<your path here>');` 例如附加`/usr/local/bin`：

```
putenv('PATH=' . getenv('PATH') . ':/usr/local/bin') 
```

这也可能是一个`sudo`问题，请尝试`-E`（保留环境）开关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T12:09:23.617

想通了，我还需要定义节点：

`$asdf = system('sudo -E -u dalton /usr/local/bin/node /usr/local/bin/forever restart botti.js 2>&1');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-22T14:09:18.547

永久创建符号链接

```
ln -s /usr/local/bin/forever /usr/bin/env/forever 
```

如果它仍然被称为“nodejs”，也适用于nodejs。将其称为“节点”

```
ln -s /usr/bin/nodejs /usr/bin/node 
```

我将解决永远执行的问题。

对于php方面，试试这个

```
echo shell_exec("your command sh"); 
```

# android - getSupportFragmentManager() 包含待机后的空片段

> ID：13377828
> 
> 赞同：1
> 
> 时间：2012-11-14T11:20:42.637
> 
> 标签：android, tabs, android-fragments, android-viewpager, android-fragmentactivity

设备进入待机状态后，如果我打电话， `getSupportFragmentManager()`我会得到一个`FragmentManager`包含未初始化的片段，其所有变量都设置为`null`.

这里有一些代码：

```
this.mAdapter = new MyAdapter(getSupportFragmentManager());

this.mPager = (ViewPager) findViewById(R.id.pager);
this.mPager.setAdapter(mAdapter);

TabPageIndicator titleIndicator = (TabPageIndicator) findViewById(R.id.titles);
titleIndicator.setViewPager(mPager);
titleIndicator.setOnPageChangeListener(new OnPageChangeListener()
{
    @Override
    public void onPageSelected(int position)
    {
        mAdapter.getItem(position).onFocus();
    }

    @Override
    public void onPageScrolled(int arg0, float arg1, int arg2)
    {
    }

    @Override
    public void onPageScrollStateChanged(int arg0)
    {
    }
}); 
```

这是 MyAdapter 类：

```
public static class MyAdapter extends FragmentStatePagerAdapter
{
    ArrayList<ExtendedFragment> tabs = new ArrayList<ExtendedFragment>();
    String[] titles = new String[] { "FRAG1", "FRAG2", "FRAG3", "FRAG4", "FRAG5", "FRAG6"};

    public MyAdapter(FragmentManager fm)
    {
        super(fm);

        tabs.add(new frag1());
        tabs.add(new frag2());
        tabs.add(new frag3());
        tabs.add(new frag4());
        tabs.add(new frag5());
        tabs.add(new frag6());
    }

    @Override
    public int getCount()
    {
        return tabs.size();
    }

    @Override
    public ExtendedFragment getItem(int position)
    {
        return tabs.get(position);
    }

    @Override
    public CharSequence getPageTitle(int position)
    {
        return titles[position];
    }
} 
```

实现该`ExtendedFragment`方法`onFocus()`，每个片段都覆盖，因为当标签获得焦点时，我需要采取一些操作。当我从待机状态恢复设备`onFocus()`并被解雇时，如果我尝试`View`使用`getView()`我得到`null`.

为什么我的观点是空的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:27:17.643

您可以尝试覆盖 onSaveInstanceState 方法。

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            if (savedInstanceState != null) {
                mContentFragment = getSupportFragmentManager().getFragment(
                        savedInstanceState, "mContent");
            }
            if (mContentFragment == null) {
                mContentFragment = new YourFragment();
            }
    }

    public void onSaveInstanceState(Bundle outState) {
            super.onSaveInstanceState(outState);
            getSupportFragmentManager().putFragment(outState, "mContent",
            mContentFragment);
    } 
```

# arrays - Fortran 中的数组边界检查 - 这很危险吗？

> ID：13377829
> 
> 赞同：2
> 
> 时间：2012-11-14T11:20:42.567
> 
> 标签：arrays, fortran

我有一些旧的 Fortran 代码，我正在使用最新的 Intel 编译器（在 Visual Studio 中运行）重新编译这些代码。可悲的是，我的 Fortran 技能有点生疏。

此特定代码使用数组来记录程序执行期间发生的任何问题。这个数组是这样声明的：

```
CHARACTER FAIL(25)*(255) 
```

这是一段代码，它检查这个数组，如果它找到一个以`'F'`(ie 'failed')开头的元素，它会做一些事情

```
 DO 20 CNTERR = OERRNO,ERRNO
         IF (FAIL(CNTERR)(1:1).EQ.'F') GOTO 9999
   20 CONTINUE 
```

几乎在所有情况下`OERRNO`都`ERRNO`为零，因此`CNTERR`也将为零。我认为这意味着——因为 Fortran 使用基于 1 的数组——我正在查看一个不存在的元素。

使用 VS 中的默认“发布”配置，代码将毫无问题地编译和运行。它将编译但无法使用默认的“调试”配置运行。我认为，重要的区别在于“调试”设置了“检查数组和字符串边界”选项，即`/check:bounds`.

我的问题：如果使用“发布”配置构建，代码似乎可以正确运行。但我是否正在做一件会咬我的严重坏事？当您请求越界数组元素时，Fortran 会返回什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:45:05.217

> 我的问题：如果使用“发布”配置构建，代码似乎可以正确运行。但我是否正在做一件会咬我的严重坏事？当您请求越界数组元素时，FORTRAN 会返回什么？

你说的对。越界访问总是错误的，是的，它很容易咬你。至于Fortran说会发生什么？好吧，它只是说你不能这样做，在这种情况下，实现可以做任何它喜欢的事情，从无到有，到输出有用的错误消息，到发出 3 分钟的警告。

要修复它，我们需要更多代码，但我怀疑将 OERRNO 初始化为 1 会做到这一点，因为在 ERRNO=0 的情况下，将不会执行循环。

另一件事：

> 字符失败（25）*（255）

我的 F77 生锈了，这里的 F90 风格不同，但我不确定这是否正确。我失败的记忆暗示

```
CHARACTER*255 FAIL(25) 
```

反而。

# service - 我可以使用 Azure 服务总线来保护来自我的 APP 的 REST 调用吗？

> ID：13377830
> 
> 赞同：1
> 
> 时间：2012-11-14T11:20:50.170
> 
> 标签：service, servicebus

Azure 如何帮助我保护我的休息服务？服务总线是否提供了一种更简单的方法来保护我的 REST 服务，而无需我安装自己的 SSL 证书？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:39:59.007

是的。ServiceBus 使用 SSL 在传输级别加密连接，并使用 ACS 进行身份验证和授权。对于这种情况，您不需要导入自己的证书。

以下是如何在启用 ACS 的情况下使用 SB REST API 的示例： [http ://rickgaribay.net/archive/2012/01/19/common-service-bus-queue-operations-with-the-rest-api.aspx](http://rickgaribay.net/archive/2012/01/19/common-service-bus-queue-operations-with-the-rest-api.aspx)

# javascript - Morris.js 每一个都缺少标签书写

> ID：13377831
> 
> 赞同：-1
> 
> 时间：2012-11-14T11:20:58.547
> 
> 标签：javascript

并提前感谢。我有这个问题，在插件中，当我使用 ajax 带来信息以使用“Morris.js”构建条形图时，轴的每一秒条都没有显示信息，但是如果我将“json”直接写入代码它工作正常我的错误是什么？这是代码：

```
 $(document).ready(function(){ 

 var numberOfSeconds=30*1000; //the interval of refreshing the information of the calls per server
 var x=getTheInfoAboutTheServers();

//The m_graph contains an information 
   //and build the graph itself later we update the data with the m_graph.setData() function
     var m_graph= Morris.Bar({
            element: 'my_chart',
            data:   x,
            xkey: 'y',
            ykeys: ['a'],
            labels: ['Number of calls']
        });

/**
 * This Function get the number of calls per each server
 * return a JSON object to the morris.js pluggin
 */

function getTheInfoAboutTheServers(){

var inf=null;

$.ajax({

     async: false,    
     type: "POST",
     url : $('#site_url').val()+"index.php/Login_controller/mw_iaa_rawGraphInfoClient",
     dataType: "JSON",
        success: function(data){

            var dataArr=[];

                for (key in data) {
                    if (!isNaN(key)) {
                        var obj = data[key];

                        var mySplitResult = obj['callserver'].split(".");
                        var calls=parseInt(obj['numOfCalls']);

                        dataArr.push({ y: String(mySplitResult[0]), a : calls});
                      }
                  }
            inf=dataArr;

       }
 });    

 return inf;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:26:40.893

这是因为 $.ajax 在函数 getTheInfoAboutTheServers 中异步执行。因此，该方法返回inf 的值，即*null*，因为此时没有执行ajax 函数。

要解决此问题，您需要从将 json 作为参数传递的 ajax-success 方法中调用另一个函数，而不是将其分配给变量

# java - jetty：如何声明 JVM 范围的 jndi 条目并绑定到 java:comp/env

> ID：13377832
> 
> 赞同：5
> 
> 时间：2012-11-14T11:21:07.213
> 
> 标签：java, jetty, jndi

我正在尝试在 Jetty 服务器中定义一些 JNDI 条目（它们将在 JVM 范围内），但它们没有按预期自动绑定到“java:comp/env”命名空间。我正在关注以下文档：[http ://wiki.eclipse.org/Jetty/Feature/JNDI#Configuring_env-entries](http://wiki.eclipse.org/Jetty/Feature/JNDI#Configuring_env-entries)

这是我的 jetty.xml：

```
<Configure id="server" class="org.eclipse.jetty.server.Server">

<New class="org.eclipse.jetty.plus.jndi.EnvEntry">
    <Arg></Arg>
    <Arg>prop/someValue</Arg>
    <Arg type="java.lang.String">hello</Arg>
    <Arg type="boolean">true</Arg>
</New>

</Configure> 
```

正如 Jetty 示例所暗示的那样，我期待它绑定到“java:comp/env/prop/someValue”，但似乎根本没有创建“java:comp/env”。

但是，查找“prop/someValue”确实有效。

注意-我没有 webapp，所以没有 WEB-INF/jetty-env.xml 也没有 web.xml。我刚刚启动一个 Jetty 服务器并尝试使用所需的 JNDI 条目对其进行配置。

还尝试使用“bindToENC”方法显式绑定我的条目：

```
<Configure id="server" class="org.eclipse.jetty.server.Server">

<New class="org.eclipse.jetty.plus.jndi.EnvEntry">
    <Arg></Arg>
    <Arg>prop/someValue</Arg>
    <Arg type="java.lang.String">hello</Arg>
    <Arg type="boolean">true</Arg>
</New>
    <Call name="bindToENC">
        <Arg>prop/someValue</Arg>
    </Call>

</Configure> 
```

但这会导致服务器启动失败：

```
2012-11-14 11:17:25,648 DEBUG - XML new class org.eclipse.jetty.plus.jndi.EnvEntry (org.eclipse.jetty.xml.XmlConfiguration)
2012-11-14 11:17:25,650 DEBUG - SAVE prop/someValue in null (jndi)
2012-11-14 11:17:25,656 DEBUG - InitialContextFactory.getInitialContext() (jndi)
2012-11-14 11:17:25,664 DEBUG - Created initial context delegate for local namespace:org.eclipse.jetty.jndi.local.localContextRoot@664883c (jndi)
2012-11-14 11:17:25,665 DEBUG - InitialContextFactory.getInitialContext() (jndi)
2012-11-14 11:17:25,665 DEBUG - Created initial context delegate for local namespace:org.eclipse.jetty.jndi.local.localContextRoot@6e811c88 (jndi)
2012-11-14 11:17:25,666 DEBUG - Looking up name="__" (jndi)
2012-11-14 11:17:25,666 DEBUG - Adding binding with key=__ obj=org.eclipse.jetty.jndi.NamingContext@39dd3812 for context=null as __: org.eclipse.jetty.jndi.NamingContext:org.eclipse.jetty.jndi.NamingContext@39dd3812 (jndi)
2012-11-14 11:17:25,666 DEBUG - Subcontext __ created (jndi)
2012-11-14 11:17:25,666 DEBUG - Looking up name="prop" (jndi)
2012-11-14 11:17:25,666 DEBUG - Adding binding with key=prop obj=org.eclipse.jetty.jndi.NamingContext@6a8c436b for context=__ as prop: org.eclipse.jetty.jndi.NamingContext:org.eclipse.jetty.jndi.NamingContext@6a8c436b (jndi)
2012-11-14 11:17:25,666 DEBUG - Subcontext prop created (jndi)
2012-11-14 11:17:25,667 DEBUG - Removing binding with key=someValue (jndi)
2012-11-14 11:17:25,667 DEBUG - Adding binding with key=someValue obj=prop/someValue for context=prop as someValue: org.eclipse.jetty.plus.jndi.EnvEntry:prop/someValue (jndi)
2012-11-14 11:17:25,667 DEBUG - Bound object to someValue (jndi)
2012-11-14 11:17:25,667 DEBUG - Looking up name="prop" (jndi)
2012-11-14 11:17:25,667 DEBUG - Adding binding with key=prop obj=org.eclipse.jetty.jndi.NamingContext@27b15692 for context=null as prop: org.eclipse.jetty.jndi.NamingContext:org.eclipse.jetty.jndi.NamingContext@27b15692 (jndi)
2012-11-14 11:17:25,667 DEBUG - Subcontext prop created (jndi)
2012-11-14 11:17:25,667 DEBUG - Removing binding with key=someValue (jndi)
2012-11-14 11:17:25,668 DEBUG - Adding binding with key=someValue obj=hello for context=prop as someValue: java.lang.String:hello (jndi)
2012-11-14 11:17:25,668 DEBUG - Bound object to someValue (jndi)
2012-11-14 11:17:25,668 DEBUG - XML call bindToENC (org.eclipse.jetty.xml.XmlConfiguration)
2012-11-14 11:17:25,668 DEBUG - InitialContextFactory.getInitialContext() (jndi)
2012-11-14 11:17:25,668 DEBUG - Created initial context delegate for local namespace:org.eclipse.jetty.jndi.local.localContextRoot@6baa9f99 (jndi)
2012-11-14 11:17:25,671 DEBUG - >>> new root context requested  (org.eclipse.jetty.jndi.java.javaURLContextFactory)
2012-11-14 11:17:25,673 DEBUG - Adding binding with key=comp obj=Reference Class Name: javax.naming.Context
Type: parser
Content: org.eclipse.jetty.jndi.java.javaNameParser
 for context=null as comp: javax.naming.Reference:Reference Class Name: javax.naming.Context
Type: parser
Content: org.eclipse.jetty.jndi.java.javaNameParser
 (jndi)
2012-11-14 11:17:25,673 DEBUG - Looking up name="comp/env" (jndi)
2012-11-14 11:17:25,690 DEBUG - Using thread context classloader (jndi)
2012-11-14 11:17:25,690 DEBUG - No entry for classloader: sun.misc.Launcher$AppClassLoader@35a16869 (jndi)
2012-11-14 11:17:25,690 DEBUG - Looking up name="env" (jndi)
2012-11-14 11:17:25,690 WARN  - Config error at <Call name="bindToENC"><Arg>prop/someValue</Arg></Call> (org.eclipse.jetty.xml.XmlConfiguration)
2012-11-14 11:17:25,690 WARN  - Config error at <New class="org.eclipse.jetty.plus.jndi.EnvEntry"><Arg/><Arg>prop/someValue</Arg><Arg type="java.lang.String">hello</Arg><Arg type="boolean">true</Arg><Call name="bindToENC"><Arg>prop/someValue</Arg></Call></New> (org.eclipse.jetty.xml.XmlConfiguration)
Exception in thread "main" java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.jetty.util.TypeUtil.call(TypeUtil.java:538)
    at org.eclipse.jetty.xml.XmlConfiguration$JettyXmlConfiguration.call(XmlConfiguration.java:732) 
```

有谁知道如何让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-27T17:56:38.283

您可以通过两种方式绑定`prop/someValue`到`java:comp/env/prop/someValue`。第一个是引用 web.xml 中的 env-entry，如下所示：

```
<env-entry> 
   <env-entry-name>prop/someValue</env-entry-name> 
   <env-entry-type>java.lang.String</env-entry-type> 
   <env-entry-value>hello</env-entry-value> 
</env-entry> 
```

但是，在您的情况下，您没有 WEB-INF/web.xml，根据 J2EE，有效的 Web 应用程序不需要它。您可以使用`bindToENC`方法将绑定保留到 Jetty。这可以这样做：

```
<Configure id="server" class="org.eclipse.jetty.server.Server">
   <New class="org.eclipse.jetty.plus.jndi.EnvEntry">
      <Arg></Arg> <!-- Empty argument - scope set to JVM -->
      <Arg>prop/someValue</Arg>
      <Arg type="java.lang.String">hello</Arg>
      <Arg type="boolean">true</Arg>
      <Call name="bindToENC">
         <Arg>prop/someValue</Arg>
      </Call>
   </New>
</Configure> 
```

所以你的错误是将`<Call>`块留在 EnvEntry 之外。尽管请记住，调用`bindToENC`仅适用于`jetty-env.xml`NOT in`context.xml`或`jetty.xml`.

此外，为了让 Jetty 读取`jetty-env.xml`文件并包含其内容，您需要`java -jar [jetty]/start.jar --add-to-startd=jndi,plus`在 Jetty 9 中启用 jndi 和 plus 模块（必须两者）（模块之间没有空格），在以前的版本中，您可以在此处找到说明：[http:// wiki.eclipse.org/Jetty/Feature/JNDI#Detailed_Setup](http://wiki.eclipse.org/Jetty/Feature/JNDI#Detailed_Setup)

# java - 字符串文字和永久代内存区域

> ID：13377834
> 
> 赞同：10
> 
> 时间：2012-11-14T11:21:12.310
> 
> 标签：java, string

当我们说实习字符串存储在永久代区域中时，字符串文字也同样适用吗？还是仅适用于由 inter() 执行的字符串？

实际上博客文章通常说字符串池包含对字符串对象的引用，而实际的字符串对象*在堆中*的某个地方。永久代是在堆内还是在堆外也有很多困惑。（我使用了 jcosole，它显示的永久 gen 与堆不同。许多帖子说它是堆的一部分，许多人说它是不同的）

**编辑：** 当我跑的时候：

```
public class stringtest2{
  public static void main(String args[]){
    int i=0;
    List<String> list=new ArrayList<String>();
    while(true){
      String s="hello"+i;
      String s1=i+"hello";
      String s2=i+"hello"+i;
      System.out.println(s);
      s.intern();

      s1.intern();
      s2.intern();
      list.add(s);
      list.add(s1);
      list.add(s2);
      i++;
    }
  }
} 
```

我期待`Java.lang.OutOfMemoryError: PermGen space`但我得到了：

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at java.util.Arrays.copyOf(Arrays.java:2760)
        at java.util.Arrays.copyOf(Arrays.java:2734)
        at java.util.ArrayList.ensureCapacity(ArrayList.java:167)
        at java.util.ArrayList.add(ArrayList.java:351)
        at stringtest2.main(stringtest2.java:20) 
```

难道不应该`Java.lang.OutOfMemoryError: PermGen space`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T11:35:59.137

> 当我们说实习字符串存储在永久代区域中时，字符串文字也同样适用吗？

文字字符串被保留。所以是的，在 Java 6-.

**从 Java 7 开始，interned 字符串不再存储在永久代中**。它们像您要创建的任何其他对象一样存储在堆的主要部分。

> 不应该是 Java.lang.OutOfMemoryError: PermGen space

您得到的异常是由创建一个位于堆上的数组引起的。要尝试获得“永久内存不足”错误，您可以尝试删除这些`list.add()`行。但是请注意，可以对实习字符串进行垃圾收集，因此即使这样做也不会导致您期望的异常。

[参见 RFE](http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html#jdk7changes) 6962931 ：

> 在 JDK 7 中，interned 字符串不再分配在 Java 堆的永久代中，而是与应用程序创建的其他对象一起分配在 Java 堆的主要部分（称为年轻代和年老代）中. 此更改将导致更多数据驻留在主 Java 堆中，而永久代中的数据更少，因此可能需要调整堆大小。由于此更改，大多数应用程序只会看到相对较小的堆使用差异，但加载许多类或大量使用 String.intern() 方法的大型应用程序将看到更显着的差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T11:28:11.310

如[`String`JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#intern%28%29)中所述，所有 String 字面量都是自动实习的：

> **所有文字字符串和字符串值的常量表达式都是实习的。**

我希望您手动实习的字符串和任何字符串文字之间的行为是一致的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:54:23.727

`s.intern()`返回对实习字符串的引用，但您没有使用它。尝试`s = s.intern()`

# android - 在 webview 中成功加载网页时如何触发功能？

> ID：13377836
> 
> 赞同：3
> 
> 时间：2012-11-14T11:21:12.243
> 
> 标签：android, webview

我想在 webview 完成加载网页并且没有收到错误后触发一个函数。根据我的实验，onPageFinished() 会被多次触发，并且在大多数情况下，它会在 onReceivedError() 之前执行。

那么如何才能知道网页加载完毕并且没有收到错误呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T13:11:24.693

您可以设置`WebViewClient`并`WebView`覆盖其回调方法，这将让您知道网页何时完成加载页面。例如

```
webView.setWebViewClient(new MyWebViewClient());

private class MyWebViewClient extends WebViewClient {

    @Override
    public void  onPageStarted(WebView view, String url, Bitmap favicon){
        super.onPageStarted(view, url, favicon);
        if(progess!=null){
            progess.dismiss();

        }
        progess = ProgressDialog.show(LoadUrl.this, "", "Loading please wait...");
    }
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        super.shouldOverrideUrlLoading(view, url);
        if (Uri.parse(url).getHost().equals("callback")) {
            // This is my web site, so do not override; let my WebView load the page
             Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
            startActivity(intent);
            return false;
        }
        // Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs

        view.loadUrl(url);
       return true;
    }

    @Override
    public void onPageFinished(WebView view, String url){
        super.onPageFinished(view, url);

        // Add YOUR CODE HERE 
    }

    public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
     super.onReceivedError(view, errorCode, description, failingUrl);
     Toast.makeText(LoadUrl.this, "Sorry! " + description, Toast.LENGTH_SHORT).show();
   }

    @Override
 public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {
     super.onReceivedSslError(view, handler, error);
     handler.proceed(); 

 }
} 
```

这里`onPageFinished(WebView view, String url)`会在 webView 加载完当前 Page 时调用。

希望能帮助到你 ：）

# wso2 - 将属性从 inSequence 传递到 outSequence

> ID：13377837
> 
> 赞同：3
> 
> 时间：2012-11-14T11:21:25.537
> 
> 标签：wso2, wso2esb, hl7, synapse

我正在向 HL7 TCP/IP 端口发送带有代理的消息，并在 outSequence 中获得响应。但我的问题是 inSequence 中设置的所有属性都不再可用。它们都是空的。我测试了所有不同的范围（传输、轴 2、轴 2 客户端），但它们都不起作用。

[我在这篇文章中看到它应该是可能的](https://stackoverflow.com/questions/13144596/stwso2esb-outsequence-processing)。HL7 发件人是否破坏了属性？ **如何在 outSequence 中使用我的 inSequence 属性？**

我的代理示例（从 ActiveMQ JMS 获取消息并发送到 HL7 端口 4000）：

```
<?xml version="1.0" encoding="UTF-8"?>
<proxy xmlns="http://ws.apache.org/ns/synapse" xmlns:hl7="http://wso2.org/hl7"  xmlns:urn="urn:hl7-org:v2xml" name="demo_toHL7" transports="jms" startOnLoad="true" trace="disable">
    <parameter name="transport.jms.Destination">demo_qFilter</parameter>
    <parameter name="transport.jms.ConnectionFactory">queueBlocking</parameter>
    <parameter name="transport.jms.DestinationType">queue</parameter>
    <parameter name="transport.jms.ContentType">
        <rules>
            <jmsProperty>contentType</jmsProperty>
            <default>application/edi-hl7</default>
        </rules>
    </parameter>
    <target faultSequence="rollbackSequence">
        <inSequence>
            <log level="full"/>
            <property name="ClientApiNonBlocking" scope="axis2" action="remove"/>
            <property name="testProperty" value="blabla" scope="transport"/>
            <property name="messageType" value="application/edi-hl7" scope="axis2"/>
            <property name="ContentType" value="application/edi-hl7" scope="axis2"/>            
            <send>
                <endpoint>
                    <address uri="hl7://localhost:4000"/>
                </endpoint>
            </send>
        </inSequence>
        <outSequence>
            <log level="custom">
                <property name="PROPERTY" expression="get-property('transport','testProperty')"/>
            </log>
        </outSequence>
    </target>
</proxy> 
```

* * *

我正在使用 WSO2 ESB 4.0.3 并安装了 HL7 功能。作为接收者，我使用 7edit 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:42:54.567

尝试将属性范围设置为“默认/突触”

FiveO 编辑评论：

尝试将属性范围设置为“默认”：

将传输属性从 inSequence 发送到 outSequence（代表默认范围）：

```
<inSequence>
   ...
   <property name="myPropertyInTransport" value="myValue" scope="transport"/>
   <property name="myPropertyInDefault" expression="get-property('transport','myPropertyInTransport')" scope="default"/>
   ...
</inSequence>
<outSequence>
   ...
   <property name="myPropertyInTransport" expression="get-property('default', 'myPropertyInDefault')" scope="transport"/>
   <!-- Now myProperty is also available in the outSequence -->
   ...
</outSequence> 
```

# ios - NSMutableArray 在 iPad 上被释放，但在模拟器中没有

> ID：13377842
> 
> 赞同：-2
> 
> 时间：2012-11-14T11:21:56.433
> 
> 标签：ios, ipad, ios-simulator, automatic-ref-counting

我在 .m 代码中有以下代码

```
@implementation MyGameController
{
    NSMutableArray* viewsarray;
} 
```

我正在以这种方式初始化它

```
- (void)viewDidLoad
{
   viewsarray = [[NSMutableArray alloc] init];
   for (int i=0; i < TOTAL_ITEMS; i++)
   {
        ItemController* iv = [[ItemController alloc] initWithNibName:@"ItemPadXib" bundle:nil];

        [viewsarray addObject:iv];
    }
} 
```

当我在这个函数的末尾检查时 - 数组是完整的并且包含我所有的项目。但是，后来它被释放（我认为）并且viewsarray被设置为nil。

我知道这一点，因为后来我尝试像这样访问它

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    ItemController* iv1 = [viewsarray objectAtIndex:index];
    ....
} 
```

当我`bp`在这个函数中设置 a -`viewsarray`是`nil`

我试图将其声明`viewsarray`为 a`property`但行为是相同的

一件重要的事情 - 在模拟器上它工作得很好。有什么不同吗 ？ARC 的行为是否不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T12:38:12.947

实例变量是强的`viewsarray`（默认情况下），因此不能自动释放。内存管理（通过 ARC）在模拟器和设备上是相同的。您的错误在其他地方。

# c# - 为实时网站编写和显示错误消息？

> ID：13377845
> 
> 赞同：0
> 
> 时间：2012-11-14T11:22:01.420
> 
> 标签：c#, asp.net-mvc

我正在开发一个网站，当我在本地主机上运行它时，一切正常。

我已将此网站上传到 fireFTP，现在可以在线访问我的网站。

该网站与在本地主机上托管时的性能不同，我找不到错误，因为我的网站没有中断。

我想做一些测试，想知道如何显示错误信息？？

我想显示这样的错误消息：

![在此处输入图像描述](../Images/b2b264d283e0bb6191e047ee34d27965.png)

但是使用自定义消息，例如“代码进入方法 writeToSpreadSheet”。

这样我就可以找到我的代码所在的位置并指出出了什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:26:52.747

您需要`show detailed error messages`在 IIS 设置中启用，请参阅下面的链接以获取有关如何执行此操作的简短教程。

[IIS7：如何在客户端浏览器浏览时启用网站的详细错误消息？](http://blogs.msdn.com/b/rakkimk/archive/2007/05/25/iis7-how-to-enable-the-detailed-error-messages-for-the-website-while-browsed-from-for-the-client-browsers.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:29:47.483

在 web.config 里面添加这一行，这样你就不必接触 IIS 配置：

```
<customErrors mode="On">
      <error redirect="error404.html" statusCode="404" />        
</customErrors> 
```

更改所需的 html 页面的 error404.html。当找不到某些页面时，用户将被重定向到那里

# twitter-bootstrap - 引导日期选择器

> ID：13377847
> 
> 赞同：11
> 
> 时间：2012-11-14T11:22:12.537
> 
> 标签：twitter-bootstrap

我试图让引导日期选择器突出显示在下拉日期选择器上选择的日期。它目前没有这样做..我错过了什么？

```
<div class="input-append date" id="datepicker" data-date="dateValue: Customer.DateOfBirth" data-date-format="dd-mm-yyyy">
    <input class="span2" size="16" type="text" data-bind="value: Customer.DateOfBirth" readonly="readonly" />
    <span class="add-on"><i class="icon-calendar"></i></span>
</div> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-14T13:11:43.340

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-23T16:08:27.547

```
<linkrel="stylesheet"href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<script src="js/bootstrap.min.js" type="text/javascript"></script>

<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<link href="http://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="js/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="js/bootstrap-datepicker.min.js" type="text/javascript"></script>

<script>

    $(document).ready(function() {
        $('#datePicker')
            .datepicker({
                format: 'mm/dd/yyyy'
            })
            .on('changeDate', function(e) {
                // Revalidate the date field
                $('#eventForm').formValidation('revalidateField', 'date');
            });

        $('#eventForm').formValidation({
            framework: 'bootstrap',
            icon: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                name: {
                    validators: {
                        notEmpty: {
                            message: 'The name is required'
                        }
                    }
                },
                date: {
                    validators: {
                        notEmpty: {
                            message: 'The date is required'
                        },
                        date: {
                            format: 'MM/DD/YYYY',
                            message: 'The date is not a valid'
                        }
                    }
                }
            }
        });
    });

</script>

<div class="form-group">
    <div class="date">
        <div class="input-group input-append date" id="datePicker">
            <input type="text" class="form-control" name="date" />
            <span class="input-group-addon add-on"><span class="glyphicon glyphicon-calendar"></span></span>
        </div>
    </div>
</div> 
```

为此，您必须拥有 bootstrap-datepicker.js 和 bootstrap-datepicker.min.js 文件。您也可以调用 $('#datePicker').datepicker(); 方法，但它有自己的默认设置。所以在脚本标签中，我在 datepicker() 方法中应用了我自己的自定义。然后我只是在 div 标签中创建了一个 datepicker 输入组件，该组件在 body 标签中定义，但我已经简要介绍了它。

你的问题的解决方案是跨度标签。哪个 r 在 datepicker 输入组件上应用图标。我选择了一个日历图标，它是 glyphicon glyphicon-calendar。但在它必须告诉浏览器我将通过在 span 标签中写入 class="input-group-addon add-on" 来嵌入图标之前，该标签用于将图标与文本输入分组。

# c# - 错误提供程序检查了输入文本框的位数

> ID：13377848
> 
> 赞同：0
> 
> 时间：2012-11-14T11:22:14.257
> 
> 标签：c#, winforms, validation

我在 C# winform 中使用了错误提供程序。在我的表单中有文本框。错误提供者检查它是否包含两个数字。这意味着输入是数字，数字的数量是两个数字。当输入为 2 char 时，错误提供程序有效，但当输入为 char 和 digit 时，错误提供程序无效。请检查我的代码。

```
 private void textbox1_Leave(object sender, EventArgs e)
        {
            string text = textbox1.Text;
            bool hasDigit = false;

                foreach (char letter in text)
                {
                    if (char.IsDigit(letter))
                    {
                        hasDigit = true;
                        break;
                    }
                }

            // Call SetError or Clear on the ErrorProvider.
            if (!hasDigit )
            {
                errorProvider1.SetError(textbox1, "Please enter digit");
            }
            else if(hasDigit) 

            {

                if (text.TextLength != 2)
                {
                    errorProvider1.SetError(textbox1, "Number of digit is two number");
                }
                else
                errorProvider1.Clear();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:25:13.313

因此，您要确保所有字符都是数字。但是你只检查第一个，如果这是一个数字，你就打破了循环：

```
foreach (char letter in text)
{
    if (char.IsDigit(letter))
    {
        hasDigit = true;
        break;
    }
} 
```

相反，您可以为此使用 Linq。`Enumerable.All`是为此目的而制作的：

```
bool allDigits = text.All(c => Char.IsDigit(c)); 
```

（但也许我完全偏离了轨道，因为问题不太清楚恕我直言）

# r - R中带连字符的字符串

> ID：13377849
> 
> 赞同：0
> 
> 时间：2012-11-14T11:22:15.673
> 
> 标签：r, rstudio

我在 R 中有一个字符串（使用 RStudio）

```
legend <- c('Up to 5 minutes', '5-10 minutes', '10–20 minutes', '20–40 minutes', '40–80 minutes', '80-160 minutes', '160-320 minutes', '5.3-10.6 hours', '10.6-21.2 hours', '1-2 days') 
```

当我逐行运行源代码时，它运行良好。但是当我获取代码时，它会引发错误

```
Error in source(con, echo = echo, print.eval = print.eval, max.deparse.length = max.deparse.length,  : 
  con:29:52: unexpected INCOMPLETE_STRING 
```

问题可能出在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T20:58:30.813

RStudio 上发布的讨论更新：

[http://support.rstudio.org/help/discussions/problems/3945-bug-when-sourcing-the-application](http://support.rstudio.org/help/discussions/problems/3945-bug-when-sourcing-the-application)

相关部分：

> 直到现在我才注意到它但是在开始 RI 时

```
Enabling Justin-In-Time compilation, level 3.
[1] 0
During startup - Warning messages:
1: Setting LC_CTYPE failed, using "C" 
2: Setting LC_COLLATE failed, using "C" 
3: Setting LC_TIME failed, using "C" 
4: Setting LC_MESSAGES failed, using "C" 
5: Setting LC_PAPER failed, using "C" 
[R.app GUI 1.53 (6335) i386-apple-darwin9.8.0]

WARNING: You're using a non-UTF8 locale, therefore only ASCII characters will work.
Please read R for Mac OS X FAQ (see Help) section 9 and adjust your system preferences accordingly. 
```

> 阅读常见问题解答我做了标准`system("defaults write org.R-project.R force.LANG en_US.UTF-8")`，现在它工作正常。

# php - PHP | 通过 $_POST[] 获取输入名称

> ID：13377850
> 
> 赞同：12
> 
> 时间：2012-11-14T11:22:27.407
> 
> 标签：php, post, properties

HTML 示例：

```
 <form method="post" id="form" action="form_action.php">
    <input name="email" type="text" />
  </form> 
```

用户填写输入字段：dfg@dfg.com

```
echo $_POST['email']; //output: dfg@dfg.com 
```

表单中每个输入的名称和值都会发送到服务器。有没有办法获得 name 属性？所以像..

```
echo $_POST['email'].name; //output: email 
```

编辑：澄清对我的问题的一些困惑；

这个想法是使用开关动态验证每个输入。我使用一个单独的验证类来保持一切清洁。这是我最终结果的一个简短示例：

```
//Main php page
if (is_validForm()) {
    //All input is valid, do something..
}

//Separate validation class    
function is_validForm () {
    foreach ($_POST as $name => $value) {
        if (!is_validInput($name, $value)) return false;
    }
    return true;
   }

function is_validInput($name, $value) {
    if (!$this->is_input($value)) return false; 

    switch($name) {
        case email: return $this->is_email($value);  
        break;
        case password: return $this->is_password($value);
        break;
//and all other inputs
        }
    } 
```

感谢raina77ow 和其他所有人！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-14T11:23:56.857

您可以在循环中处理 $_POST`foreach`以获取名称及其值，如下所示：

```
foreach ($_POST as $name => $value) {
   echo $name; // email, for example
   echo $value; // the same as echo $_POST['email'], in this case
} 
```

但是您无法从`$_POST['email']`value 中获取属性的名称 - 它是一个简单的字符串，并且它不存储其“来源”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T11:24:25.560

```
foreach($_POST as $key => $value)
{
 echo 'Key is: '.$key;
 echo 'Value is: '.$value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:26:02.083

如果你想动态地做，你可以这样做：

```
foreach ($_POST as $key => $value)
{
    echo 'Name: ', $key, "\nValue: ", $value, "\n"; 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T11:26:43.933

循环你`object/array`的`foreach`：

```
foreach($_POST as $key => $items) {
    echo $key . "<br />";
} 
```

或者您可以使用`var_dump`or`print_r`调试大变量，例如`arrays`or `objects`：

```
echo '<pre>' . print_r($_POST, true) . '</pre>'; 
```

或者

```
echo '<pre>';
var_dump($_POST);
echo '</pre>'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-14T11:33:58.877

其实我找到了一些可能对你有用的东西，看看这个-

[http://php.net/manual/en/function.key.php](http://php.net/manual/en/function.key.php)

这个页面说下面的代码，

```
<?php
$array = array(
    'fruit1' => 'apple',
    'fruit2' => 'orange',
    'fruit3' => 'grape',
    'fruit4' => 'apple',
    'fruit5' => 'apple');

// this cycle echoes all associative array
// key where value equals "apple"
while ($fruit_name = current($array)) {
    if ($fruit_name == 'apple') {
        echo key($array).'<br />';
    }
    next($array);
}
?> 
```

会给你输出，

水果
1 水果4
水果5

就如此容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T11:27:23.430

current(array_keys($_POST)) 应该给你你正在寻找的东西。虽然没有测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-09T09:52:35.877

查看已提交或将要提交的表单名称的好方法

```
<?php
$i=1;
foreach ($_POST as $name => $value) {
echo "</b><p>".$i." ".$name; 
echo " = <b>".$value; 
$i++;
}
?> 
```

只需将您的表单发送到此脚本，它就会向您显示正在提交的内容。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-11-14T11:25:44.480

您可以使用 foreach 循环来获取所有设置的值。

```
foreach ($_POST AS $k=>$v){
    echo "$k is $v";
} 
```

你的例子

```
echo $_POST['email'].name; //output: email 
```

没有意义，因为您已经知道要访问的值的名称？

# less - 使用 Less：避免树继承

> ID：13377851
> 
> 赞同：2
> 
> 时间：2012-11-14T11:22:30.470
> 
> 标签：less

当我想写类似的东西时

```
.security-list ul {
    list-style: none;
    margin-left: 0;
}
.security-list ul li {
    padding: 10px 9px;
    display: inline-block;
}
.security-list ul li a {
    width: 234px;
    color: #000;
    text-decoration: none;
    display: inline-block;
    background-image: url(http://domain.com/infopage-icons.png);
    background-position: 200px 0;
    background-repeat: no-repeat;
}
.security-list ul li a.basket,
.security-content h3.basket {
    background-position: 200px 0;
}

.security-list ul li a.creditcard,
.security-content h3.creditcard {
    background-position: 200px -205px;
} 
```

我最终写：

```
.security-list ul {
    list-style: none;
    margin-left: 0;

    li {
        padding: 10px 9px;
        display: inline-block;

        a {
            width: 234px;
            color: #000;
            text-decoration: none;
            display: inline-block;
            background-image: url(http://domain.com/infopage-icons.png);
            background-position: 200px 0;
            background-repeat: no-repeat;

            &.basket,
            .security-content h3.basket {
                background-position: 200px 0;
            }

            &.creditcard,
            .security-content h3.creditcard {
                background-position: 200px -205px;
            }
        }
    } 
```

但我遇到的问题是这会将最后两个块编译为

```
.security-list ul li a.basket,
.security-list ul li a .security-content h3.basket { ... }

.security-list ul li a.creditcard,
.security-list ul li a .security-content h3.creditcard { ... } 
```

**我真正想要**的是：

```
.security-list ul li a.basket,
.security-content h3.basket{ ... }

.security-list ul li a.creditcard,
.security-content h3.creditcard { ... } 
```

我可以在**LESS**中做什么，他知道**我不想继承洞树**，但仍然不会在相同的样式规则上重复自己，换句话说，不要创建 2 个具有相同内容的规则......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:43:16.370

您的问题是您想忽略巢内的巢，这（至少目前）不可能。如果它确实有效，它也会使代码难以阅读，因为您不会期望在嵌套中定义*非嵌套项。*

我认为对此的一种优雅解决方案，尤其是在您的情况下，是进一步抽象嵌套。`.security`这段代码通过将其全部定位在一个嵌套中来接近您想要的：

```
.security {
    &-list ul {
        list-style: none;
        margin-left: 0;

        li {
            padding: 10px 9px;
            display: inline-block;

            a {
                width: 234px;
                color: #000;
                text-decoration: none;
                display: inline-block;
                background-image: url(http://domain.com/infopage-icons.png);
                background-position: 200px 0;
                background-repeat: no-repeat;
            }
         }
     }

     &-list ul li a,
     &-content h3 {
         &.basket {
                background-position: 200px 0;
         }
         &.creditcard {
                background-position: 200px -205px;
         }
     }
} 
```

上面的代码将调用从列表中的深层嵌套中分离出来，这确实需要在调用中重复少量代码`ul li a`，但它会产生以下 CSS：

```
.security-list ul {  
  list-style: none;  
  margin-left: 0;
}
.security-list ul li {
  padding: 10px 9px;  
  display: inline-block;
}
.security-list ul li a {
  width: 234px;  
  color: #000;  
  text-decoration: none;  
  display: inline-block;  
  background-image: url(http://domain.com/infopage-icons.png);  
  background-position: 200px 0;  
  background-repeat: no-repeat;
}
.security-list ul li a.basket,
.security-content h3.basket {  
  background-position: 200px 0;
}
.security-list ul li a.creditcard,
.security-content h3.creditcard {  
  background-position: 200px -205px;
} 
```

假设`.security-list`该类仅用于包含真实列表的容器（如 a `ul`），那么如果您能够`background-position`从直接`security-list ul li a`选择器中删除 ，则可以减少 and 的选择器，`.basket`并`.creditcard`通过删除它的`ul li`部分来制作它just`.security-list a.basket`等。这将减少该调用上的选择器嵌套膨胀。

# android - 处理android应用程序中的来电

> ID：13377852
> 
> 赞同：2
> 
> 时间：2012-11-14T11:22:39.013
> 
> 标签：android, android-mediaplayer, telephonymanager

我开发了一个与音乐相关的安卓应用程序。我在处理来电时的媒体播放器时遇到问题。我想在通话期间暂停音频，并在通话结束后恢复。我需要建议是否使用带有 onstatechanged 的​​ TelephonyManager 来暂停和恢复音频（或）在来电期间暂停和恢复应用程序本身的任何其他方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:29:22.133

干得好

在清单中包含以下权限。

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

然后

```
PhoneStateListener phoneStateListener = new PhoneStateListener() {
    @Override
    public void onCallStateChanged(int state, String incomingNumber) {
        if (state == TelephonyManager.CALL_STATE_RINGING) {

        } else if(state == TelephonyManager.CALL_STATE_IDLE) {
           Play music
        } else if(state == TelephonyManager.CALL_STATE_OFFHOOK) {
           Pause music
        }
        super.onCallStateChanged(state, incomingNumber);
    }
};

TelephonyManager mgr = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
if(mgr != null) {
    mgr.listen(phoneStateListener, PhoneStateListener.LISTEN_CALL_STATE);
} 
```

并通过取消注册成为一个好的安卓公民`onDestroy`

```
if(mgr != null) {
    mgr.listen(phoneStateListener, PhoneStateListener.LISTEN_NONE);
} 
```

当用户接听电话时，`CALL_STATE_OFFHOOK`将被调用。您可以编写代码来暂停播放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T11:25:02.687

在您的活动中使用`onPause()`和方法。`onResume()`当有来电时，会调用 onPause() 方法。挂断电话时会调用 onResume() 。

即使用户单击从其他应用程序发送的通知，这也将起作用。

# charts - JavaFX 2.x：如何绘制平行线？

> ID：13377860
> 
> 赞同：1
> 
> 时间：2012-11-14T11:22:59.953
> 
> 标签：charts, line, javafx-2

下面的代码在 XY lineChart 上绘制线条

```
import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.control.Label;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.Pane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Line;
import javafx.scene.shape.LineTo;
import javafx.scene.shape.MoveTo;
import javafx.scene.shape.Path;
import javafx.stage.Stage;

public class Lines extends Application {

Path path;

public static void main(String[] args) {
    launch(args);
}

@Override
public void start(Stage stage) {

    final CategoryAxis xAxis = new CategoryAxis();
    final NumberAxis yAxis = new NumberAxis(0.5, 9.5, 0.1);
    yAxis.setTickUnit(1);
    //yAxis.setPrefWidth(35);
    yAxis.setMinorTickCount(10);
    yAxis.setTickLabelFormatter(new NumberAxis.DefaultFormatter(yAxis) {
        @Override
        public String toString(Number object) {
            String label;
            label = String.format("%7.2f", object.floatValue());
            return label;
        }
    });
    final LineChart<String, Number> lineChart = new LineChart<String, Number>(xAxis, yAxis);

    lineChart.setCreateSymbols(false);
    lineChart.setAlternativeRowFillVisible(false);
    lineChart.setLegendVisible(false);

    XYChart.Series series1 = new XYChart.Series();

    series1.getData().add(new XYChart.Data("Jan", 1));
    series1.getData().add(new XYChart.Data("Feb", 4.5));
    series1.getData().add(new XYChart.Data("Mar", 2.5));
    series1.getData().add(new XYChart.Data("Apr", 6.5));
    series1.getData().add(new XYChart.Data("May", 4.5));
    series1.getData().add(new XYChart.Data("Jun", 8.5));
    series1.getData().add(new XYChart.Data("Jul", 6.5));

    BorderPane bp = new BorderPane();
    bp.setCenter(lineChart);
    Scene scene = new Scene(bp, 800, 600);
    lineChart.setAnimated(false);
    lineChart.getData().addAll(series1);

    Lines.MouseHandler mh = new Lines.MouseHandler( bp );
    bp.setOnMouseClicked( mh );
    bp.setOnMouseMoved( mh );

    stage.setScene(scene);

    path = new Path();
    path.setStrokeWidth(1);
    path.setStroke(Color.BLACK);

    scene.setOnMouseDragged(mh);
    scene.setOnMousePressed(mh);
    bp.getChildren().add(path);
    stage.setScene(scene);
    stage.show();
}

class MouseHandler implements EventHandler< MouseEvent > {
private boolean gotFirst    = false;
private Line    line;
private Pane    pane;
private double  x1, y1, x2, y2;

public MouseHandler( Pane pane ) {
    this.pane = pane;
}    
@Override
public void handle( MouseEvent event ) {
    if( event.getEventType() == MouseEvent.MOUSE_CLICKED ) {
        if( !gotFirst ) {
            x1 = x2 = event.getX();
            y1 = y2 = event.getY();
            line = new Line( x1, y1, x2, y2 );

            pane.getChildren().add( line );

            gotFirst = true;
        } 
        else {
            line = null;
            gotFirst = false;
        }
    } 
        else {
            if( line != null ) {
                x2 = event.getX();
                y2 = event.getY();
                // update line
                line.setEndX( x2 );
                line.setEndY( y2 );
        }
     }
  }
  }
  } 
```

我想在绘制后复制（克隆）一条线，例如这张图片

![在此处输入图像描述](../Images/4e99ff3cce6f2ff32516f4864be5bb11.png)

因此，首先用鼠标左键单击点 1，然后再用鼠标单击点 2：我的目标是现在拥有这条线的副本（相同的长度，相同的斜率），我可以将其放置在图表上的任何位置，在本例中由鼠标左键第三次单击点 3。

这个怎么做？

谢谢！

# c# - 从asp.net中的JS文件调用javascript函数

> ID：13377863
> 
> 赞同：0
> 
> 时间：2012-11-14T11:23:05.440
> 
> 标签：c#, javascript, asp.net

我在我的页面中引用了我的 javascript，如下所示

```
<script src="JScript1.js" type="text/javascript"></script> 
```

这些是我在该脚本文件中的函数

```
function multiplication(txtQuantity) {
var weight = document.getElementById(txtQuantity).value;
}
 function f(sender, args) {
args.IsValid = false;
var gridview = document.getElementById("<%=Gridview1.ClientID%>");
var txt = gridview.getElementsByTagName("textarea");
for (i = 0; i < txt.length; i++) {

    if (txt[i].id.indexOf("TextBox1") != -1) {

        if (txt[i].value == '') {
            args.IsValid = false;
        }
        else {
            args.IsValid = true;
        }

    }
}
}

function f1(sender, args) {
args.IsValid = false;
var gridview = document.getElementById("<%=Gridview1.ClientID%>");
var txt = gridview.getElementsByTagName("textarea");
for (i = 0; i < txt.length; i++) {

    if (txt[i].id.indexOf("TextBox2") != -1) {

        if (txt[i].value == '') {
            args.IsValid = false;
        }
        else {
            args.IsValid = true;
        }

    }
}
 } 
```

我想从后面的代码中调用这些函数，并且我想将该函数分配给自定义验证器

我尝试了一些如下但不工作

```
<asp:CustomValidator ID="custValCountry" runat="server" ValidationGroup="Country"
                        ValidateEmptyText="true" ControlToValidate="TextBox1" ClientValidationFunction="javascript:f"
                        ErrorMessage="Other is required"></asp:CustomValidator> 
```

另外，我在我的`RowDataBound`活动中写如下，这也不起作用

```
protected void Gridview1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            TextBox txt = (TextBox)e.Row.FindControl("TextBox1");
            Page.ClientScript.RegisterClientScriptBlock(txt.GetType(), "onBlur", "multiplication('" + txt.ClientID + "')");
            //Page.ClientScript.RegisterClientScriptBlock(, "Script", "alert('Records Successfuly Saved!');", true);
           // txt.Attributes.Add("onBlur", "return javascript:multiplication('" + txt.ClientID + "');");
            //TextBox txt1 = (TextBox)e.Row.FindControl("TextBox2");
            txt1.Attributes.Add("onBlur", "return javascript:multiplication('" + txt1.ClientID + "');");
        }
    } 
```

有人能帮我吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:27:33.560

静态 JavaScript 文件通常不会通过 ASP.NET 获取，因此这一行将不起作用：

```
var gridview = document.getElementById("<%=Gridview1.ClientID%>"); 
```

为网格使用固定 ID 并直接指定：

```
var gridview = document.getElementById('my-grid');

<asp:GridView ID="my-grid" ClientIDMode="Static" runat="server" ...> 
```

或者想出一些其他方法来查找 ID。

另请注意，此功能几乎毫无价值：

```
function multiplication(txtQuantity) {
var weight = document.getElementById(txtQuantity).value;
} 
```

你得到重量然后什么都不做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:29:58.143

您需要意识到您的 javascript 函数是在客户端的浏览器中运行的，而不是在运行您的代码的服务器上。如果您需要从后面的代码中调用函数，则需要在后面的代码中创建等效函数。

# javascript - Twitter Bootstrap Collapse / Responsive Nav 在 FF / Chrome 中不起作用

> ID：13377865
> 
> 赞同：1
> 
> 时间：2012-11-14T11:23:23.100
> 
> 标签：javascript, twitter-bootstrap

我使用 Twitter Bootstrap 制作了一个简单的响应式页面：http: [//jsfiddle.net/5YNmm/3/](http://jsfiddle.net/5YNmm/3/)

响应式导航和任何折叠切换在 FF 和 Chrome 中只工作一次。在 IE 中，它们工作得很好。

折叠示例是从引导站点复制的：

```
<button type="button" class="btn btn-danger" data-toggle="collapse" data-target="#demo">Press me to toggle</button>
<div id="demo" class="collapse in"> Collapsible Content, initially shown </div> 
```

由于我不包含任何其他 js，因此[Bootstrap nav-collapse 切换一次](https://stackoverflow.com/questions/11959501/bootstrap-nav-collapse-toggles-once)或此处[twitter-bootstrap Collapse 在第一次单击后停止工作](https://stackoverflow.com/questions/12231095/twitter-bootstrap-collapse-stops-working-after-first-click)不应该是错误，其中 $.support.transition 被另一个库覆盖。

非常感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:49:08.340

它在css文件中。我在这个小提琴更新中所做的只是删除你的两个 css 文件（显然没有在小提琴上加载）

```
<link rel="stylesheet" type="text/css" href="./bootstrap_files/stylesheet_427bb03fe1.css" media="all">
<link rel="stylesheet" type="text/css" href="./bootstrap_files/frontend.css" media="all"> 
```

并将其替换为引导 CDN 托管的 CSS 文件

```
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"> 
```

它现在可以在 chrome 和 firefox 上折叠和扩展。小提琴链接在这里：http: [//jsfiddle.net/5YNmm/6/](http://jsfiddle.net/5YNmm/6/)

如果无法访问 css 文件，我无法告诉您更多信息 - 但希望这可以为您指明正确的方向！！

# linear-regression - 权重变化时加权最小二乘回归的有效重新计算

> ID：13377868
> 
> 赞同：2
> 
> 时间：2012-11-14T11:23:45.920
> 
> 标签：linear-regression, linear-algebra, eigen, ublas

[我正在执行wiki](http://en.wikipedia.org/wiki/Linear_least_squares_(mathematics)#Weighted_linear_least_squares)上描述的加权最小二乘回归：WLS

我需要解这个方程： $B= (t(X) *W* X)^{-1}*t(X) *W* y$

我使用 SVD 查找： $(t(X) *W* X)^{-1}$ 并将其存储在矩阵中。此外，我存储矩阵 $H= (t(X) *W* X)^{-1}*t(X) *W$ 并对 y 的任何新值执行以下操作：B= H* y。这样我就可以节省随着 y 的变化而重复 SVD 和矩阵乘法的成本。

W是对角矩阵，一般不会改变。但是有时我会更改 W 矩阵对角线上的一两个元素。在那种情况下，我需要再次执行 SVD 并重新计算 H 矩阵。这显然是缓慢且耗时的。

我的问题是：如果我知道 W 发生了什么变化而 X 没有任何变化，是否有更有效的方法来重新计算 (t(X) *W* X)^-1？

或者换句话说，考虑到只有 W 中的对角线元素可以改变已知量，是否有一种有效的分析方法可以找到 B？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T18:28:38.453

有这样一种方法，如果您计算的逆是真正的逆而不是广义逆（即，没有一个奇异值是 0）。但是，建议在使用时谨慎一些。如果您以无限精确的方式计算总和，一切都会好起来的。对于有限的精度，特别是对于几乎奇异的问题——如果某些奇异值非常大——这些公式可能会导致精度损失。

我将调用逆存储 C。如果将 d（可以是正数或负数）添加到第 m 个权重，那么修改后的 C 矩阵，C~ 说，和修改后的 H，H~，可以计算如下这：

(' 表示转置，e_m 为全为 0 的向量行，除了第 m 个槽为 1)

让

```
c = the m'th column of H, divided by the original m'th weight    
a = m'th row of the data matrix X    
f = e_m - a*H    
gamma = 1/d + a*c 
```

（所以 c 是列向量，而 a 和 f 是行向量）

然后

```
C~ = C - c*c'/gamma
H~ = H + c*f/gamma 
```

如果你想找到新的 B，比如说，对于给定的 y，它可以通过以下方式计算：

```
r = y[m] - a*B
B~ = B + (r/gamma) * c 
```

这些公式的推导是直截了当但乏味的矩阵代数。[矩阵求逆引理](http://en.wikipedia.org/wiki/Woodbury_matrix_identity)派上用场了。

# jpa-2.0 - 如果实体具有乐观锁，EclipseLink 批量更新不起作用

> ID：13377869
> 
> 赞同：1
> 
> 时间：2012-11-14T11:23:51.247
> 
> 标签：jpa-2.0, eclipselink

[官方文档](http://wiki.eclipse.org/Optimizing_the_EclipseLink_Application_%28ELUG%29#How_to_Use_Batch_Writing_for_Optimization)说：

> 批量写入可以通过在单个事务中而不是单独向数据库发送 INSERT、 **UPDATE**和 DELETE 语句组来提高数据库性能

（重点是我的）。

但是如果一个实体有`Optimistic Locking`@Version 字段，那么所有的更新都是独立执行的。

为了证明这一点，这里是源代码片段`DatabaseAccessor:566`：

```
if (/* ommited */(!dbCall.hasOptimisticLock() || getPlatform().canBatchWriteWithOptimisticLocking(dbCall) ) /* ommited */) {
  // this will handle executing batched statements, or switching mechanisms if required
  getActiveBatchWritingMechanism().appendCall(session, dbCall);
  //bug 4241441: passing 1 back to avoid optimistic lock exceptions since there   
  // is no way to know if it succeeded on the DB at this point.
  return Integer.valueOf(1);
} 
```

所以，基本上，上面的代码片段意味着，如果 Entity 有一个乐观锁，那么批量更新将被忽略。

有解决方法吗？我仍然想使用 JPA。

**更新**：
事实证明，我需要添加此属性`persistence.xml`以启用具有乐观锁定的批量更新：

```
<property name="eclipselink.target-database" value="org.eclipse.persistence.platform.database.oracle.Oracle11Platform"/> 
```

请注意，可以使用 Oracle10Platform 或更高版本作为值。较低版本不支持此功能。

此外，要启用批量写入，您必须在 persistence.xml 中添加至少一个属性：

```
<property name="eclipselink.jdbc.batch-writing" value="JDBC" /> 
```

您还可以选择配置批量大小：

```
<property name="eclipselink.jdbc.batch-writing.size" value="1000" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T14:05:39.290

您是否检查了您正在使用的平台类的 canBatchWriteWithOptimisticLocking() 方法？有这个调用是为了如果您的驱动程序可以支持返回批处理中单个调用的行计数，以便 Eclipselink 可以根据需要抛出一个乐观锁异常，则可以使用批处理。

# windows-phone-7 - WP7 Listbox UI 虚拟化如何工作

> ID：13377872
> 
> 赞同：1
> 
> 时间：2012-11-14T11:24:02.707
> 
> 标签：windows-phone-7, memory-leaks, observablecollection, virtualizingstackpanel

我正在使用具有 的 ListBox，`VirtualizingStackPanel`据说默认情况下支持 UI 虚拟化。

但是，当我设置我的**listStudent**（类型为`ObservableCollection`，其中有 5 个学生）时`ItemsSource`，我的`Listbox`. 然后，每当用户滚动到末尾时，我都会向我的**listStudent**添加另外 5 个学生（当然会通知 UI）。但我看到消耗的内存不断增加。`StackPanel`和记忆力没什么区别

UI 虚拟化如何工作？**向listStudent**添加新项目时如何保持低内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T08:13:53.967

虚拟化意味着列表不构造您尚未滚动到的列表项。

所以你可以把你的测试代码放到项目的加载函数或使用的转换器代码中。你可以看看虚拟化是否有效

例如

您可以将转换器绑定到学生的姓名道具并且您可以记录它。然后您知道该项目何时创建

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T11:47:16.240

确保您没有修改`ListBox` `ItemsPanel`会破坏 UI 虚拟化

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T11:36:28.757

Sheldon_Xiao on 在 MSDN 上指出了一些[有助于解释 UI 虚拟化的参考资料](http://social.msdn.microsoft.com/Forums/en/wpf/thread/ad722b94-851a-4396-9f18-2fba144fd678)

# wcf - 隐藏我的 WCF 方法

> ID：13377874
> 
> 赞同：0
> 
> 时间：2012-11-14T11:24:04.873
> 
> 标签：wcf, service, hide

我有一个自托管的 WCF 服务。现在，如果有人想要他/她可以轻松创建代理并使用我的方法。怎么保护这个东西。我希望项目之外的任何人都可以使用我的方法。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:13:48.980

这已经讨论过很多次了。

一种选择是您可以使用用户名/密码对客户端进行身份验证，并使用 ssl 保护连接。如果连接是通过互联网，这很好。

读[这个](https://stackoverflow.com/questions/5265635/easiest-way-to-protect-wcf-services)，[这个](http://msdn.microsoft.com/en-us/library/ff648840.aspx)和[这个](http://www.codeproject.com/Articles/36289/8-steps-to-enable-windows-authentication-on-WCF-Ba)

# c# - Await alternative in .NET 4.0?

> ID：13377875
> 
> 赞同：10
> 
> 时间：2012-11-14T11:24:11.013
> 
> 标签：c#, .net, task-parallel-library, c#-5.0

What would be the best alternative for the await keyword in .NET 4.0 ? I have a method which needs to return a value after an asynchronous operation. I noticed the wait() method blocks the thread completely thus rendering the asynchronous operation useless. What are my options to run the async operation while still freeing the UI thread ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T19:58:10.727

我认为你的基本选择是

*   使用`Task`和`.ContinueWith()`
*   使用异步[CTP](http://www.microsoft.com/en-us/download/details.aspx?id=9983)和`async`/`await`
*   使用[反应式扩展](http://msdn.microsoft.com/en-us/data/gg577609.aspx)

最简单的方法可能是安装 Async CTP。据我所知，许可证允许商业用途。它修补编译器并附带一个 150kb 的 dll，您可以将其包含到您的项目中。

您可以使用`Task`和`.ContinueWith()`。但这意味着，您必须在异常处理和流量控制方面付出一些努力。

任务是一种功能结构。这就是为什么`ContinueWith()`不能很好地与`for`循环或`try-catch`块等命令式结构混合使用。因此`async`，并`await`得到了介绍，以便编译器可以帮助我们。

如果你不能得到编译器的支持（即你使用.Net 4.0），你最好的办法是使用[TAP](http://www.microsoft.com/en-us/download/details.aspx?id=19957)和一个功能框架。[Reactive Extensions](http://msdn.microsoft.com/en-us/data/gg577609.aspx)是一个很好的处理异步方法的框架。

只需谷歌搜索“反应式扩展任务”即可开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T09:49:45.137

您可以实现`await`与`yield`协程类似的行为，我在非 4.5 代码中使用它。您需要一个`YieldInstruction`从应该异步运行的方法中检索的类：

```
public abstract class YieldInstruction
{
    public abstract Boolean IsFinished();
} 
```

然后你需要一些`YieldInstruction`（处理任务的ae `TaskCoroutine`）的实现并以这种方式使用它（伪代码）：

```
public IEnumerator<YieldInstruction> DoAsync()
{
    HttpClient client = ....;
    String result;
    yield return new TaskCoroutine(() => { result = client.DownloadAsync(); });
    // Process result here
} 
```

现在您需要一个调度程序来处理指令的执行。

```
for (Coroutine item in coroutines)  
{  
    if (item.CurrentInstruction.IsFinished())  
    {
         // Move to the next instruction and check if coroutine has been finished 
         if (item.MoveNext()) Remove(item);
    }
} 
```

`Invoke`在开发 WPF 或 WinForms 应用程序时，如果您在正确的时间更新协程，您也可以避免任何调用。你也可以扩展这个想法，让你的生活更轻松。样本：

```
public IEnumerator<YieldInstruction> DoAsync()
{
    HttpClient client = ....;
    client.DownloadAsync(..);

    String result;
    while (client.IsDownloading)
    {
        // Update the progress bar
        progressBar.Value = client.Progress;
        // Wait one update
        yield return YieldInstruction.WaitOneUpdate;
    }
    // Process result here
} 
```

# python - pyodbc, call stored procedure with table variable

> ID：13377877
> 
> 赞同：4
> 
> 时间：2012-11-14T11:24:18.260
> 
> 标签：python, pyodbc

I have to call a MS SQLServer stored procedure with a table variable parameter.

```
/* Declare a variable that references the type. */
DECLARE @TableVariable AS [AList];

/* Add data to the table variable. */
INSERT INTO @TableVariable (val) VALUES ('value-1');
INSERT INTO @TableVariable (val) VALUES ('value-2');

EXEC  [dbo].[sp_MyProc]
            @param = @TableVariable 
```

Works well in the SQL Sv Management studio. I tried the following in python using PyOdbc:

```
cursor.execute("declare @TableVariable AS [AList]")
for a in mylist:
    cursor.execute("INSERT INTO @TableVariable (val) VALUES (?)", a)
cursor.execute("{call dbo.sp_MyProc(@TableVariable)}") 
```

With the following error: error 42000 : the table variable must be declared. THe variable does not survive the different execute steps. I also tried:

```
sql = "DECLARE @TableVariable AS [AList]; "
for a in mylist:
    sql = sql + "INSERT INTO @TableVariable (val) VALUES ('{}'); ".format(a)
sql = sql + "EXEC  [dbo].[sp_MyProc]   @param = @TableVariable"
cursor.execute(sql) 
```

With the following error: No results. Previous SQL was not a query. No more chance with

```
sql = sql + "{call dbo.sp_MyProc(@TableVariable)}" 
```

does somebody knows how to handle this using Pyodbc?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T17:36:40.840

现在问题的根源是 SQL Server[变量具有定义它的](http://msdn.microsoft.com/en-us/library/ms188927.aspx)**批处理**的范围。每次调用 cursor.execute 都是一个单独的批处理，即使它们在同一个事务中。

有几种方法可以解决这个问题。最直接的方法是重写您的 Python 代码，以便将所有内容作为一个批次发送。（我在我的测试服务器上对此进行了测试，只要您添加 set nocount on 或使用[nextset 跳过](http://code.google.com/p/pyodbc/wiki/StoredProcedures)中间结果，它就应该可以工作。）

一种更间接的方法是重写过程以查找临时表而不是表变量，然后只创建和填充临时表而不是表变量。未在存储过程中创建的[临时表具有创建它的会话的范围。](http://msdn.microsoft.com/en-us/library/aa258255%28v=SQL.80%29.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T17:07:38.927

我相信这个错误与sql忘记表变量无关。我最近遇到过这种情况，问题是如果 SP 还返回受影响事物的计数，pyodbc 不知道如何从存储过程中获取结果集。

在我的情况下，解决这个问题的方法是简单地将“SET NOCOUNT ON”放在 SP 的开头。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:46:54.197

我不确定这是否有效并且我无法测试它，因为我没有 MS SQL Server，但是您是否尝试过在单个语句中执行所有内容：

```
cursor.execute("""
DECLARE @TableVariable AS [AList];

INSERT INTO @TableVariable (val) VALUES ('value-1');
INSERT INTO @TableVariable (val) VALUES ('value-2');

EXEC [dbo].[sp_MyProc] @param = @TableVariable;
"""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-09T04:06:28.407

我有同样的问题，但这里的答案都没有解决它。我无法让“SET NOCOUNT ON”工作，也无法使用表变量进行单个批处理操作。起作用的是分两批使用临时表，但整天都在寻找正确的语法。下面的代码在第一批中创建并填充一个临时表，然后在第二批中，它使用数据库名称执行存储过程，并在存储过程名称前加上两个点。此语法对于避免错误“找不到存储过程'x'。(2812) (SQLExecDirectW))”很重要。

```
def create_incidents(db_config, create_table, columns, tuples_list, upg_date):
    """Executes trackerdb-dev mssql stored proc.
    Args:
        config (dict): config .ini file with mssqldb conn.
        create_table (string): temporary table definition to be inserted into 'CREATE TABLE #TempTable ()'
        columns (tuple): columns of the table table into which values will be inserted.
        tuples_list (list): list of tuples where each describes a row of data to insert into the table.
        upg_date (string): date on which the items in the list will be upgraded.
    Returns:
        None
    """

    sql_create = """IF OBJECT_ID('tempdb..#TempTable') IS NOT NULL
            DROP TABLE #TempTable;
        CREATE TABLE #TempTable ({});
        INSERT INTO #TempTable ({}) VALUES {};
        """
    columns = '"{}"'.format('", "'.join(item for item in columns))
    # this "params" variable is an egregious offense against security professionals everywhere. Replace it with parameterized queries asap.
    params = ', '.join([str(tupl) for tupl in tuples_list])
    sql_create = sql_create.format(
        create_table
        , columns
        , params)
    msconn.autocommit = True
    cur = msconn.cursor()
    try:
        cur.execute(sql_create)
        cur.execute("DatabaseName..TempTable_StoredProcedure ?", upg_date)
    except pyodbc.DatabaseError as err:
        print(err)
    else:
        cur.close()
    return

create_table = """
    int_column int
    , name varchar(255)
    , datacenter varchar(25)
    """

create_incidents(
    db_config    = db_config
, create_table = create_table
, columns      = ('int_column', 'name', 'datacenter')
, cloud_list   = tuples_list
, upg_date     = '2017-09-08') 
```

存储过程使用`IF OBJECT_ID('tempdb..#TempTable') IS NULL`语法来验证临时表是否已创建。如果有，则程序从中选择数据并继续。如果尚未创建临时表，则 proc 中止。这会强制存储过程使用在存储过程本身之外但在同一会话中创建的#TempTable 的副本。pyodbc 会话一直持续到游标或连接关闭并且 pyodbc 创建的临时表具有整个会话的范围。

```
IF OBJECT_ID('tempdb..#TempTable') IS NULL
BEGIN
    -- #TempTable gets created here only because SQL Server Management Studio throws errors if it isn't.
    CREATE TABLE #TempTable (
        int_column int
        , name varchar(255)
        , datacenter varchar(25)
    );

    -- This error is thrown so that the stored procedure requires a temporary table created *outside* the stored proc
    THROW 50000, '#TempTable table not found in tempdb', 1;
END
ELSE
BEGIN
    -- the stored procedure has now validated that the temporary table being used is coming from outside the stored procedure
    SELECT * FROM  #TempTable;
END; 
```

最后，请注意“tempdb”不是占位符，就像我第一次看到它时所想的那样。“tempdb”是一个实际的 MS SQL Server 数据库系统对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-24T23:42:50.020

设置`connection.autocommit = True`和使用`cursor.execute()`一次而不是多次。您传递给的 SQL 字符串`cursor.execute()`必须包含所有 3 个步骤：

1.  声明表变量
2.  用数据填充表变量
3.  执行使用该表变量作为输入的存储过程

3 个步骤之间不需要分号。

这是一个功能齐全的演示。我没有为参数传递而烦恼，因为它无关紧要，但它也可以正常工作，作为记录。

**SQL 设置（提前执行）**

```
CREATE TYPE dbo.type_MyTableType AS TABLE(
    a INT,
    b INT,
    c INT
)
GO

CREATE PROCEDURE dbo.CopyTable
    @MyTable type_MyTableType READONLY
AS
BEGIN
    SET NOCOUNT ON;
    SELECT * INTO MyResultTable FROM @MyTable
END 
```

**Python**

```
import pyodbc

CONN_STRING = (
    'Driver={SQL Server Native Client 11.0};'
    'Server=...;Database=...;UID=...;PWD=...'
)

class DatabaseConnection(object):
    def __init__(self, connection_string):
        self.conn = pyodbc.connect(connection_string)
        self.conn.autocommit = True
        self.cursor = self.conn.cursor()

    def __enter__(self):
        return self.cursor

    def __exit__(self, *args):
        self.cursor.close()
        self.conn.close()

sql = (
    'DECLARE @MyTable type_MyTableType'
    '\nINSERT INTO @MyTable VALUES'
    '\n(11, 12, 13),'
    '\n(21, 22, 23)'
    '\nEXEC CopyTable @MyTable'
)

with DatabaseConnection(CONN_STRING) as cursor:
    cursor.execute(sql) 
```

如果要将 SQL 分布在对 的多个调用中`cursor.execute()`，则需要改用临时表。请注意，在这种情况下，您仍然需要`connection.autocommit = True`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-04T15:02:45.503

正如[Timothy](https://stackoverflow.com/users/43818/timothyawiseman)指出的那样，问题在于使用 nextset()。

我发现，当您执行（）多语句查询时，pyodbc 检查（是否存在任何语法错误）并仅执行批处理中的第一个语句而不是整个批处理，除非您明确指定 nextset()。

说你的查询是：

```
cursor.execute('select 1 '
               'select 1/0') 
print(cursor.fetchall()) 
```

你的结果是：

```
[(1, )] 
```

但是一旦你通过命令指示它在批处理中进一步移动，这是语法错误的部分：

```
cursor.nextset() 
```

你有它：

```
pyodbc.DataError: ('22012', '[22012] [Microsoft][ODBC SQL Server Driver][SQL Server]Divide by zero error encountered. (8134) (SQLMoreResults)') 
```

因此解决了我在多语句查询中使用变量表时遇到的问题。

# node.js - Node.js video chat application

> ID：13377884
> 
> 赞同：19
> 
> 时间：2012-11-14T11:24:42.393
> 
> 标签：node.js, web-applications, video, chat

How would you implement a video chat application using node.js?

Any resources(tutorials, books, links) or a general gameplan/strategy would be greatly appreciated

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-04T20:55:26.470

现在有两个用于视频聊天的 Node.js 项目。两者都是实验性的，但我听说如果你能让它们运行，它们会很好地工作。

[https://github.com/webRTC/webrtc.io-client](https://github.com/webRTC/webrtc.io-client) => 当前的聊天冠军。

[https://github.com/kdomagal/Web-RTC](https://github.com/kdomagal/Web-RTC) => 只有一个演示应用

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-14T14:02:22.750

有一个针对这类问题的项目 (http://www.webrtc.org/)。我可能会将视频流式传输到服务器，然后再传输到客户端，或者等到 P2P API 准备好，如果您有时间等待，然后再实施 P2P 版本。

# c# - Convert List to Dictionary with strategy

> ID：13377885
> 
> 赞同：4
> 
> 时间：2012-11-14T11:24:43.093
> 
> 标签：c#, linq, dictionary, lambda

I have List < DTO > where DTO class looks like this,

```
 private class DTO
    {
        public string Name { get; set; }
        public int Count { get; set; }
    } 
```

I create objects and add it to List.

```
var dto1 = new DTO { Name = "test", Count = 2 };
var dto2 = new DTO { Name = "test", Count = 3 };
var dtoCollection = new List<DTO> {dto1, dto2}; 
```

Now my requirement is I need to create an Dictionary from the dtoCollection whose Key is **Name** field and value is Sum of **Count** fields.

For example, if you convert the above dtoCollection to Dictionary, the entry should be like

> Key = "test" , Value = "5"

Where Value is obtained from summing up the **Count** fields whose **Name** fields are same

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-14T11:30:04.177

我想这会做你需要的：

```
dtoCollection.GroupBy(x => x.Name).ToDictionary(x => x.Key, x => x.Sum(y => y.Count)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:31:37.010

以下是 linq 查询

```
var dict = dtoCollection.GroupBy(x=>x.Name).ToDictionary(x=>x.Key, x=>x.Select(y=>y.Count).Sum()); 
```

# javascript - IE8 及以下未定义的 Javascript 'Node'

> ID：13377887
> 
> 赞同：3
> 
> 时间：2012-11-14T11:24:56.200
> 
> 标签：javascript, jquery, nodes, textnode

我有以下代码似乎在除 IE8 及以下版本之外的所有浏览器中都可以正常工作。

```
$("table.availability").each( function() {
    var siteName = $(this).parent().siblings("h2").contents().filter(function() { return this.nodeType == Node.TEXT_NODE; }).text()
    alert(sitename);
}); 
```

它获取元素的内容并删除子元素中包含的所有内容，只留下该元素的文本。

我得到的错误说这`Node`是未定义的 - 所以我在 js 文件的顶部声明它，然后得到相同的消息，`TEXT_NODE`所以我声明它。然后我收到以下错误：

`Unable to get property 'TEXT_NODE' of undefined or null reference`

谁能帮我解决这个问题，或者谁能想到更好的方法来获得相同的结果。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T11:27:02.620

该`TEXT_NODE`常数的[值为 3](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1950641247)。你可以使用它：

```
return this.nodeType === 3; 
```

旧版本的 IE 只是没有实现`Node`接口，但它们仍然遵循 DOM 规范并分配正确的`nodeType`属性值。

如果你想使用“常量”，你可以`Node`自己声明一个对象：

```
var Node = Node || {
    ELEMENT_NODE: 1,
    ATTRIBUTE_NODE: 2,
    TEXT_NODE: 3
    // etc... if you might need other node types
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-25T06:56:20.650

对于 IE8 及以下版本节点不起作用，更改`node`为`window`对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:37:34.890

我猜你的结构是这样的：

```
<h2>
    text to filter
    <span>other text</span>
</h2> 
```

而您正试图过滤掉 h2 中的“其他文本”？如果是这样 - 为什么不在您需要的文本周围添加另一个标签包装器，例如

```
<h2>
    <span class="text-to-filter">text to filter</span>
    <span>other text</span>
</h2> 
```

并这样做：

```
$(this).parent().siblings("h2").find('.text-to-filter').text() 
```

# sql - SQL 默认值约束 INFORMATION_SCHEMA

> ID：13377894
> 
> 赞同：0
> 
> 时间：2012-11-14T11:25:19.817
> 
> 标签：sql, sql-server, information-schema

我的表中有一个具有默认值约束“DF_DOC_DMA_PLACE_1_dma_id”的列

我想删除该列，但首先我需要删除该约束。问题是该表存在于许多数据库中，并且在其中一些数据库中不存在约束。如何首先检查约束是否存在，然后将其删除？

我知道 INFORMATION_SCHEMA 中的视图，但我找不到具有此约束的视图？你能告诉我默认值约束在哪里吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:50:47.710

请使用以下查询查找每个表的默认约束。

```
SELECT OBJECT_NAME(OBJECT_ID) AS NameofConstraint,
SCHEMA_NAME(schema_id) AS SchemaName,
OBJECT_NAME(parent_object_id) AS TableName,
type_desc AS ConstraintType
FROM sys.objects
WHERE type_desc = 'DEFAULT_CONSTRAINT' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:49:46.397

根据你会发现的内容尝试一些东西......

```
select t.name as 'table', c.[name] as 'column' ,dc.[name],dc.[definition]
from sys.tables as t
join sys.columns as c on (c.[object_id] = t.[object_id])
join sys.default_constraints as dc on (dc.[object_id] = c.[default_object_id]) 
```

# c# - How to open a text file in C#/WinForms/TextBox - mad Editor

> ID：13377896
> 
> 赞同：1
> 
> 时间：2012-11-14T11:25:21.127
> 
> 标签：c#, winforms, richtextbox

I have developed a Text Editor in WinForms. you can download it from [here](http://sourceforge.net/projects/textpadv1/) and use it. It works fine. But when I right-click a text file in Windows Explorer and try to open it, it doesn't show it. I have searched solution for this on Web, but failed. Can you suggest a resolution to this. Or should I use RichTextBox. I also tried to create a simple Test project with `RichTextBox` and used `LoadFile()`.

```
// Load the contents of the file into the RichTextBox.
richTextBox1.LoadFile(openFile1.FileName, RichTextBoxStreamType.RichText); 
```

This caused a file format error.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T14:00:16.377

好的，根据您的评论和提供的代码，它不会从 Windows 打开文件。

当 windows 将文件发送给程序以打开它时，它将作为第一个参数发送给 exe，例如`notepad.exe C:\Users\Sean\Desktop\FileToOpen.txt`.

您需要使用`Environment.CommandLine`or来获取参数`Environment.GetCommandLineArgs()`。

有关详细信息，请参见此处：[如何将命令行参数传递给 WinForms 应用程序？](https://stackoverflow.com/questions/1179532/how-do-i-pass-command-line-arguments-to-a-winforms-application)

我会在你的表单`Load`事件中处理这个并将参数传递给你的函数：

```
string filename = Environment.GetCommandLineArgs()[0];
richTextBox1.LoadFile(filename, RichTextBoxStreamType.RichText); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T14:46:41.157

I just solved the problem. Thanks for your help.
I am adding answer for future help who face the similar problem.
Here is the solution:

Call the following method from Form_Load():

```
public void LoadFileFromExplorer()
{
   string[] args = Environment.GetCommandLineArgs();

   if (args.Length > 1)
   {
     string filename1 = Environment.GetCommandLineArgs()[1];
     richTextBox1.LoadFile(filename1, RichTextBoxStreamType.PlainText);
   }
} 
```

To make this work, change Main():

```
static void Main(String[] args)
    {
        if (args.Length > 0)
        {
            // run as windows app
            Application.EnableVisualStyles();
            Application.Run(new Form1());
        }
        else
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:59:30.327

问题是使用：

```
richTextBox1.LoadFile(openFile1.FileName, RichTextBoxStreamType.RichText); 
```

您必须选择[*富文本格式 (RTF)*](https://en.wikipedia.org/wiki/Rich_Text_Format)文件，这是因为加载普通文本文件会给您带来文件格式错误 (ArgumentException)。所以你可以用这种方式加载它：

```
string[] lines = System.IO.File.ReadAllLines(openFile1.FileName);
richTextBox1.Lines = lines; 
```

# php - Variable different on php echo and javascript alert

> ID：13377903
> 
> 赞同：1
> 
> 时间：2012-11-14T11:25:52.140
> 
> 标签：php, javascript

I have a dynamic multilanguage website. My php echos the current language right, but javascript doesn't even if loading after body.

My php:

```
<?php echo $language ?> 
```

This gives me english, portuguese, german or french accordingly to the one is being used.

when i try with javascript this way:

```
 <script type="text/javascript">
    function language() {
        var ci = {
            language : "<?php echo $language; ?>"
        };
        if(ci.language = 'portuguese') {
            alert(ci.language);
            return false;
            fb_language = "pt_PT";
        } else if (ci.language = 'english') {
            alert(ci.language);
            return false;
            fb_language = "en_US";
        } else if (ci.language = 'german') {
            alert(ci.language);
            return false;
            fb_language = "de_DE";
        } else if (ci.language = 'french') {
            alert(ci.language);
            return false;
            fb_language = "fr_FR";
        } else {
            fb_language = "en_US";
        }
    };
    </script>

<body onload="language();"> 
```

It always gives me portuguese in javascript, can't make it alert the right language, but in php it gives me the right language im using.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:27:25.443

这个：

```
if(ci.language = 'portuguese') { 
```

应该：

```
if(ci.language === 'portuguese') { 
```

在其他`if`陈述中依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:27:43.073

用作： `ci.language == 'portuguese'`代替`ci.language = 'portuguese'`

# android - 单击重置按钮时如何清除复选框

> ID：13377904
> 
> 赞同：2
> 
> 时间：2012-11-14T11:25:56.463
> 
> 标签：android, checkbox

在我的项目中，我有许多线性布局的复选框。默认情况下运行项目时，所有复选框都未选中，我需要选中一些复选框。在复选框下方有一个重置按钮。单击重置按钮时，所有复选框均未选中。我该怎么做呢？请帮忙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-14T11:27:53.040

Call this in onClick()of Reset button.

```
if (checkBox1.isChecked()) {
             checkBox1.setChecked(false);
         }
if (checkBox2.isChecked()) {
             checkBox2.setChecked(false);
         } 
```

. . . and so on

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T12:00:45.487

要取消选中所有选中的 CheackBoxes，请在 ListView/Array 中保留选中复选框的引用，并在单击重置按钮时将它们标记为未选中，

```
ListView <CheckBox> selectedcheckBox = new ListView<CheckBox> (); 
```

当复选框被选中时---

```
selectedcheckBox.add(referanceofckeckbox). 
```

现在单击重置按钮时

```
public void onclick(View v){

 for(CheckBox cb : selectedcheckBox){
 cb.setChecked(false);

} 

} 
```

希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-04T15:54:09.077

```
if (checkBox.isChecked()) {
            checkBox.toggle();
        }
use this for all the checkboxes used. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-12T18:59:54.990

对我来说，它是这样工作的：

```
CheckBox checkBox = (CheckBox) findViewById(R.id.check_box);
        checkBox.setChecked(false); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-08T16:09:22.427

我看到这是旧东西，但没有有效的答案，所以也许这个对任何人都有帮助。

jQuery + CSS 选择器对此非常有效。如果您只想取消选中所有已选中的复选框，则只需要以下代码：

```
$('[type=checkbox]:checked').prop('checked', false); 
```

而如果你想切换所有你可以添加变量来保持选中状态，如下所示：

```
var isChecked = $('[type=checkbox]').is(':checked');
$('[type=checkbox]').prop('checked', !isChecked); 
```

# html - Windows、@font-face 和西里尔文

> ID：13377905
> 
> 赞同：2
> 
> 时间：2012-11-14T11:25:58.083
> 
> 标签：html, css, windows, font-face, webfonts

我遇到了字体和西里尔字符的问题。在 OS X 上的任何浏览器中显示时，字体会正确呈现，但在 Windows 7 机器（chrome 等）上查看时，字体无法呈现。

字体已经通过 Font Squirrel 并且文件附带的演示也失败了。

字体css：

```
@font-face {
    font-family: 'open_sansregular';
    src: url('opensans-regular-webfont.eot');
    src: url('opensans-regular-webfont.eot?#iefix') format('embedded-opentype'),
         url('opensans-regular-webfont.woff') format('woff'),
         url('opensans-regular-webfont.ttf') format('truetype'),
         url('opensans-regular-webfont.svg#open_sansregular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

这是我的问题的一个非常基本的例子。[http://joshmahony.com/font_test/opensans-regular-demo.html](http://joshmahony.com/font_test/opensans-regular-demo.html)

编辑：我已经更新了我的链接，因此字体回退到新罗马时代，并添加了一些英文字符以表明西里尔文正在回落。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T11:41:30.923

您可能生成了不包含西里尔字符的 Open Sans 版本。使用 Google Web Fonts 页面，您需要选中用户界面中的相关复选框。对于俄语，我想检查“Cyrillic”就足够了，不需要“Cyrillic Extended”。

选择是在“几乎完成”页面的“2\. 选择你想要的字符集”。

# android - 将表单组件添加到自定义 android 视图

> ID：13377910
> 
> 赞同：1
> 
> 时间：2012-11-14T11:26:34.300
> 
> 标签：android, user-interface, android-linearlayout, android-custom-view

我有一个自定义视图（扩展视图），我想在 OnCreate 函数中添加控件（按钮/文本框等），以便在运行时将这些组件添加到视图中：

```
public Section(Context context) {
    super(context);

    this.setBackgroundColor(Color.argb(255, 242, 242, 242));
    this.setOnTouchListener(mSectionOnTouch);

    LinearLayout l = new LinearLayout(this.getContext());
    l.setOrientation(LinearLayout.VERTICAL);
    Button btn = new Button(this.getContext());
    btn.setId(1);
    btn.setText("btn1");
    l.addView(btn);

    Button btn2 = new Button(this.getContext());
    btn2.setId(2);
    btn2.setText("btn2");
    l.addView(btn2);

} // Section 
```

但这似乎没有任何作用......有人可以告诉我我做错了什么吗？

非常感谢

FR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T17:11:53.917

您永远不会添加`l`到您的视图中。它应该如下所示：

```
public Section(Context context)
{
    // setup linear layout

    addView(l);
} 
```

一个稍微简单的方法是让您的自定义视图扩展 LinearLayout。然后您可以直接将视图添加到您的自定义视图中，而不必嵌套另一个容器，这对性能更好。

# php - 通过 MySQL 查询插入逗号分隔值

> ID：13377911
> 
> 赞同：4
> 
> 时间：2012-11-14T11:26:35.010
> 
> 标签：php, mysql, sql, database

我有一张表（在 phpmyadmin 中），其中包含以下字段和结构：

```
Table 1
id  | sponsor
1   | -1 
2   | 1  
3   | 1  
4   | 2  
5   | 4  
6   | 4 
```

现在我想将上表中的数据插入到新表中，如下所示：

```
Table 2
id  | children
1   | 2,3
2   | 4 
3   |   
4   | 5,6
5   |   
6   | 
```

实际上这是树结构，我保存在 mysql 数据库中。
我已经在 php 中编写了一个脚本，但是由于表 1 中有超过 100K 行，所以它花费了太多时间。请告诉我一个高效的 sql 查询来快速完成这项任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T12:23:21.637

询问：

**[SQLFIDDLE 示例](http://sqlfiddle.com/#!2/d76d3/10)**

```
SELECT 
t1.id,
(SELECT group_concat(id separator ', ')
  FROM table1 t2
   WHERE t2.sponsor = t1.id) AS children
FROM table1 t1
GROUP BY t1.id 
```

结果：

```
| ID | CHILDREN |
-----------------
|  1 |     2, 3 |
|  2 |        4 |
|  3 |   (null) |
|  4 |     5, 6 |
|  5 |   (null) |
|  6 |   (null) | 
```

插入语句：

```
INSERT INTO table2
    SELECT 
    t1.id,
    (SELECT group_concat(id separator ', ')
      FROM table1 t2
       WHERE t2.sponsor = t1.id) AS children
    FROM table1 t1
    GROUP BY t1.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T13:18:24.083

这类似于[@Justin 的答案](https://stackoverflow.com/a/13378771/297408)，但使用左连接而不是相关子查询：

```
INSERT INTO Table2 (id, children)
SELECT
  sp.id,
  GROUP_CONCAT(ch.id) AS children
FROM Table1 sp
LEFT JOIN Table1 ch ON sp.id = ch.sponsor
GROUP BY t1.id
; 
```

SELECT 语句结果的演示可以[在 SQL Fiddle](http://sqlfiddle.com/#!2/d76d3/15)中找到（并使用） （该模式是从 Justin 借来的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T11:31:08.353

您的 SELECT 元素之一应该是 a `GROUP_CONCAT(...) as column`，它将连接那些用逗号分隔的值。如果要按其中一个值进行过滤，可以使用`GROUP BY -whatever- HAVING find_in_set( -number- , column )`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T11:31:38.990

看看以下是否有帮助

```
INSERT INTO table2
SELECT sponsor, GROUP_CONCAT(id)
FROM table1
GROUP BY id 
```

# html5-video - html5：上一个/下一个按钮播放前/后视频

> ID：13377912
> 
> 赞同：3
> 
> 时间：2012-11-14T11:26:37.287
> 
> 标签：html5-video

我是 html5 的新手。我创建了一个默认加载视频的 html 页面。我需要创建一个带有播放/暂停按钮、下一个和上一个按钮以及一组视频的 html 页面。单击下一个按钮时，应该加载数组中的下一个视频，与上一个按钮类似。

我使用 html5 标签来调用第一个视频（加载在屏幕上）。我如何实现下一个和上一个按钮功能。我如何创建一系列视频以及如何调用它们。

任何帮助，将不胜感激。

```
<video  id="video1" class="container1" preload="auto"controls="controls" tabindex="0" >
<source id="v1" type="video/mp4" codecs="avc1.42E01E, mp4a.40.2" src="videos\mov_bbb.mp4"></source>
<source id="v2" type="video/ogg" codecs="theora, vorbis" src="videos\mov_bbb.ogv"></source>
<source id="v3" type="video/webm" codecs="vp8, vorbis"  src="videos\mov_bbb.webm"></source>
</video> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:04:33.883

您可以通过设置两个按钮并触发更改视频元素来源的事件来实现。这样你只需要一个 html5 Video 元素。javascript 代码如下所示：

```
var player = document.querySelector('#video');
var i = 0;
var back = document.querySelector('#back');
var next = document.querySelector('#next');
var videos = [  // here is your list of videos
    'video1.mp4',
    'video2.mp4',
    '...'
];

back.addEventListener('click',function(){
    player.src = videos[i == 0 ? videos.length-- : i--];
    video.play();
},false);

next.addEventListener('click',function(){
    player.src = videos[i == videos.length-- ? 0 : i++];
    video.play();
},false);

player.src = videos[i];
player.play(); //init the video player 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:27:53.477

在您的 html 视频容器中：

```
<video id='currentVideo'></video> 
```

***JavaScript 代码：***

```
//Global variable for the current video name
var currentVideoName='video1.avi';

var videoList=['video1.avi','video2.mp4','video3.mpg'];
var myVideo = document.getElementById('currentVideo');

var index = videoList.indexOf(window.currentVideoName);

//Next button
myVideo.pause();
myVideo.currentTime=0;
myVideo.src = 'videosDirectory/'+videoList[index+1];
window.currentVideoName=videoList[index+1];
myVideo.play();

//Pause button
myVideo.pause();

//Previous button
myVideo.pause();
myVideo.currentTime=0;
myVideo.src = 'videosDirectory/'+videoList[index-1];
window.currentVideoName=videoList[index-1];
myVideo.play();

//Play button
myVideo.play(); 
```

# iphone - 如何在 iPhone 上实现自动应答？

> ID：13377913
> 
> 赞同：0
> 
> 时间：2012-11-14T11:26:38.363
> 
> 标签：iphone, objective-c, ios, iphone-privateapi

显然，已经有一些应用程序在 iphone 上实现了自动应答：

[http://www.iclarified.com/entry/index.php?enid=20776](http://www.iclarified.com/entry/index.php?enid=20776)

这是怎么做到的？如何以编程方式自动接听电话？（私有 API 可以）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T19:50:24.100

首先，关于越狱与私有 API 的注意事项：

私有 API 只是未记录的 API，可以在越狱或越狱设备上执行。但是，Apple 将拒绝使用私有 API 的应用程序（不会接受它们进入 AppStore）。所以，你可以在被监禁的设备上使用它们，但你会在分发这个应用程序时遇到问题。

我的猜测是 AutoAnswer 是越狱调整。它们只能在越狱手机上执行。

我认为了解如何实现 AutoAnswer 的最简单方法是反汇编它并检查它挂钩的 API。更难的方法是反汇编 Phone 应用程序（可能是 Springboard 的一部分，我不记得了）并找到需要挂钩的 API 以提供相同的功能。

# ios - 为什么我得到“权限被拒绝”

> ID：13377914
> 
> 赞同：3
> 
> 时间：2012-11-14T11:26:39.127
> 
> 标签：ios, cocoa-touch

我想在我的 iPhone 应用程序的 Documents 文件夹中写入一个文件。但是当我尝试打开路径时，我得到了

> Cocoa 错误 257 - 权限被拒绝。

这是一个小代码片段：

```
// create path to file
NSURL *path = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] objectAtIndex:0];
NSLog(@"%@", [path description]);

NSError *error = nil;
NSString *filename = [NSString stringWithContentsOfURL:path encoding:NSUTF8StringEncoding error:&error];
NSLog(@"%@", error);
NSLog(@"%@", [filename description]); 
```

你能告诉我，那个代码有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:00:07.793

看起来好像您正在尝试打开文档目录而不是该目录中的文件。`stringWithContentsOfURL`将文件的内容加载到 中`NSString`，因此它不是文件名。

如果`filename`应该是*路径*而不是文件的内容，请`stringWithContentsOfURL:`改用。

# cocoa - OSX NSStatusBar 状态栏图标尺寸？

> ID：13377919
> 
> 赞同：6
> 
> 时间：2012-11-14T11:26:49.307
> 
> 标签：cocoa

我找不到文档或提示 OSX 中状态栏或菜单栏图标应具有的尺寸。我发现这样的图标对于普通显示器有 18x18 像素，但是对于视网膜显示器如何做到这一点？它是 36x36 吗？在这种情况下，通常的命名约定 ...@2 是否有效？

苹果官方文档涵盖了所有其他图标大小的信息，但没有关于状态栏图标的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T17:59:31.387

从文档：

> 当您创建一个图标以放入 PDF 格式的工具栏控件时，OS X 将自动缩放您的图标以进行高分辨率显示。您不需要提供高分辨率版本。

没有@2X 版本。

> 对于工具栏中的独立图标，创建易于识别的吸引人的图像。因为独立的工具栏图标不需要适合工具栏控件，所以您有更多的空间来表达它们。在为工具栏设计独立图标时，请遵循以下准则：
> 
> 使用直截了当的视角。使轮廓清晰明了。使用抗锯齿。明智地使用颜色来增加意义。为标准和高分辨率显示器创建图标。您需要提供两种资源：32x32 和 32x32@2x。对应的画布尺寸见表 5-1。使用 PNG 格式。

[以供参考](http://developer.apple.com/library/mac/#documentation/userexperience/conceptual/applehiguidelines/IconsImages/IconsImages.html#//apple_ref/doc/uid/20000967-TPXREF102%28)

# iphone - 在应用代理中添加导航栏

> ID：13377926
> 
> 赞同：0
> 
> 时间：2012-11-14T11:27:20.263
> 
> 标签：iphone, objective-c, ios, xcode

我的 appdelegate 有问题。我想添加一个导航栏，但它不起作用。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    self.tabBarController = [[UITabBarController alloc] init];

    UniversViewController *universViewController = [[UniversViewController alloc] initWithNibName:@"ProduitsListinTableViewController" bundle:nil];
    universViewController.title = @"univers";

    CategoriesViewController *categoriesViewController = [[CategoriesViewController alloc] initWithNibName:@"ProduitsListinTableViewController" bundle:nil];
    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:categoriesViewController];
    navigationController.title = @"categories";
    [navigationController setNavigationBarHidden:NO];

    ProduitsListinTableViewController *produitListe = [[ProduitsListinTableViewController alloc] initWithNibName:@"ProduitsListinTableViewController" bundle:nil];
    produitListe.title = @"troisième";

    _tabBarController.viewControllers = [NSArray arrayWithObjects:universViewController, categoriesViewController, produitListe, nil];

    [self.window setRootViewController:_tabBarController];
    [self.window makeKeyAndVisible];

    return YES;
} 
```

我是否必须在 appdelegate 中添加一些内容`UniversViewController`，`CategoriesViewController`或者`ProduitsListinTableViewController`这直接在 appdelegate 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:29:39.930

当我同时拥有 UINavigationController 和 UITabbarController 时，我总是采用这种方法：
您需要从基于视图的应用程序开始。然后在你的 appDelegate 文件中创建一个 UITabbarController。

```
Appdelegate.h

UITabBarController *tabBarController;
// set properties

Appdelegate.m

// Synthesize

tabBarController = [[UITabBarController alloc] init];
tabBarController.delegate=self;

// Adding Search,Nearby,Map,AboutUs,Favorites Tabs to tabBarController  
Search * search = [[Search alloc] init];  
UINavigationController *searchNav = [[UINavigationController alloc]        initWithRootViewController:search];  

Nearby* nearby = [[Nearby alloc] init];  
UINavigationController *nearbyNav = [[UINavigationController alloc] initWithRootViewController:nearby];  

Map* map = [[Map alloc] init];  
UINavigationController *mapNav = [[UINavigationController alloc] initWithRootViewController:map];  

AboutUs* aboutUs = [[AboutUs alloc] init];  
UINavigationController *aboutUsNav = [[UINavigationController alloc] initWithRootViewController:aboutUs];  

Favorites* favorites = [[Favorites alloc] init];  
UINavigationController *favoritesNav = [[UINavigationController alloc] initWithRootViewController:favorites];  

NSArray* controllers = [NSArray arrayWithObjects:searchNav,nearbyNav,mapNav,aboutUsNav,favoritesNav, nil];  
tabBarController.viewControllers = controllers; 

[window addSubview:tabBarController.view]; 
```

您可以相应地管理要在哪个选项卡中放置导航控制器或仅放置视图控制器。

然后在上面提到的每个视图控制器中你需要实现

```
- (id)init {} 
```

您可以在其中设置选项卡名称和图像。

我总是遵循这种方法，它永远不会失败。选项卡始终可见。您可以根据您的代码进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:55:22.923

试试这个代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

    // Override point for customization after application launch.

    UIViewController *viewController1, *viewController2,*viewController3,*viewController4,*viewController5;

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
    {

        viewController1 = [[[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil] autorelease];

        navController=[[UINavigationController alloc] initWithRootViewController:viewController1];

        viewController2 = [[[SearchViewController alloc] initWithNibName:@"SearchViewController" bundle:nil] autorelease];

        navController2=[[UINavigationController alloc] initWithRootViewController:viewController2];

        viewController3 = [[[LocationsViewController alloc] initWithNibName:@"LocationsViewController" bundle:nil] autorelease];

        navController3=[[UINavigationController alloc] initWithRootViewController:viewController3];

        viewController4 = [[[CallViewController alloc] initWithNibName:@"CallViewController" bundle:nil] autorelease];

        navController4=[[UINavigationController alloc] initWithRootViewController:viewController4];

        viewController5 = [[[MyBookingsViewController alloc] initWithNibName:@"MyBookingsViewController" bundle:nil] autorelease];

        navController5=[[UINavigationController alloc] initWithRootViewController:viewController5];

    }

    self.tabBarController = [[[UITabBarController alloc] init] autorelease];

    self.tabBarController.viewControllers = [NSArray arrayWithObjects:navController,navController2,navController3,navController4,navController5,nil];

    //self.window.rootViewController =self.navController;

    self.window.rootViewController=self.tabBarController;

    [self.window makeKeyAndVisible];

    return YES;
} 
```

# java - 当模态对话框可见时如何通知线程？

> ID：13377927
> 
> 赞同：0
> 
> 时间：2012-11-14T11:27:19.553
> 
> 标签：java, multithreading, swing, modal-dialog

我正在使用 SwingUtilities.invokeLater 将模态对话框设置为在 SwingWorker 线程中可见。我希望 SwingWorker 线程等到对话框变得可见。做这个的最好方式是什么？我已将以下代码放入 SwingWorker 对象的 doInBackground() 方法中。

```
synchronized (myDialog) {
    while (!myDialog.isVisible()) {
            myDialog.wait();
    }
} 
```

在 MyDialog 类中被覆盖的 setVisible() 方法中：

```
public void setVisible(boolean enabled) {
    synchronized (this) {
        notifyAll();
    }

    super.setVisible(enabled);
} 
```

但是，这似乎不起作用，因为存在时间问题 - notifyAll() 必须在 super.setVisible() 之前调用，因此 SwingWorker 线程可以处于等待状态。

我试图找出一个很好的方法来做到这一点，但我很沮丧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T14:33:45.167

不要从工作人员的`doInBackground()`方法中操作对话框。取而代之`publish()`的是适当的结果并使对话框从`process()`. 您还可以注册一个`PropertyChangeListener`将被触发以响应`setProgress()`来自 的调用`doInBackground()`。这个[例子](https://stackoverflow.com/a/4637725/230513)说明了这两种机制。

顺便说一句，我会重申@kleopatra 和@mKorbel 的建议，以更好地解释您*到底*想要实现什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:32:33.950

*   使用`JOptionPane`而不是普通的`JDialog`

*   `JOptionPane`阻止代码执行，直到某些动作实现

*   你可以添加`JComponents`到`JOptionPane`相同的`JDialog`

# c# - C# windows 应用程序中的文件上传

> ID：13377932
> 
> 赞同：5
> 
> 时间：2012-11-14T11:27:29.680
> 
> 标签：c#, winforms

在我的 C# Windows 应用程序中，我想上传一个 pdf 文件，但在我的工具箱中我找不到 FileUpload 控件。

如何在 C# windows 应用程序中上传 pdf 文件？

问候

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-14T11:45:13.623

在表单上放置一个 OpenFileDialog 控件后，假设您单击一个按钮并：

```
 private void button1_Click(object sender, EventArgs e)
        {
            DialogResult result = openFileDialog1.ShowDialog();
            if (result == DialogResult.OK) // Test result.
            {
            //Do whatever you want
            //openFileDialog1.FileName .....
            }
        } 
```

它是这样的:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:32:11.077

您可以使用**OpenFileDialog**获取所需文件的文件名，然后使用 .NET **File**对象从文件中读取数据。您可能需要一个能够显示 PDF 文件的控件。请阅读以下内容：

[使用 C# 在 Windows 窗体中查看 PDF](https://stackoverflow.com/questions/4504442/viewing-pdf-in-windows-forms-using-c-sharp)

# openjpa - 在注解中使用 PersistenceContext

> ID：13377934
> 
> 赞同：0
> 
> 时间：2012-11-14T11:27:33.417
> 
> 标签：openjpa

是否可以在普通的 JAVA 类中使用 PersistenceContext 作为 JPA 的注释？如果没有，你能告诉我如何在没有任何注释的情况下使用 PersistenceContext 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T18:04:54.080

是的，您可以在任何 Java 类中使用 @PersistenceContext。但是，您必须在 Spring 配置中指定 annotation-config，如下例所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:annotation-config/>
</beans> 
```

一旦你指定了，你可以使用@PersistenceContext，如下所示：

```
package com.sample.dao.impl

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.Query;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;

public class CustomerDaoImpl {

    @PersistenceContext
    private EntityManager em;

    public Customer getCustomerByName(String customerName) {
        Query query = em.createQuery("SELECT c FROM Customer c WHERE c.name = ?1");
        query.setParameter(1, customerName);
        List<Customer> results = query.getResultList();
        if (results.size() > 0) {
            return results.get(0);
        }
        return null;
    }
} 
```

# java - Using a different HTML template for the same XSL stylesheet

> ID：13377939
> 
> 赞同：3
> 
> 时间：2012-11-14T11:27:47.103
> 
> 标签：java, html, xslt, velocity, xalan

Is it possible to use a different HTML layout for the same XSLT stylesheet?

I have been reading up on XSLT and most examples i see show that the HTML code is actually embedded within the stylesheet.

Is it possible to use the same stylesheet for more than one HTML layout? (I am thinking similar to how Velocity works - i.e. multiple HTML files can be processed using the same Velocity tags).

I am using the Java Xalan processor to process the XSLT.

## Edit

I have tried @Dimitre Novatchev approach below and it works perfectly. The only thing is how would i handle looping through elements? For example, if the xml document is modified to be:

```
<person>
 <fname>John</fname>
 <lname>Smith</lname>
 <age>25</age>
 <age>33</age>
 <age>55</age>
</person> 
```

How can i iterate through each of the age elements?

Here is what i tried on the HTML template but i didnt see any difference:

```
<html xmlns:gen="my:tranform-generated">
 <body>
  <h1>Hi <gen:fname/> <gen:lname/>!</h1>

  You are <gen:age/> years old.  

  <gen:for-each select="/person/age">
    <gen:age/>,
  </gen:for-each>

 </body>
</html> 
```

Expected output

I would like the output of the above to be

```
Hi JohnSmith!
You are 25 years old. 

25, 33, 55 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T13:25:31.250

**是的，这是一个非常强大的技术，我称之为“填空”。**

这是一个非常简短的示例：

骨架1：

```
<html xmlns:gen="my:tranform-generated">
 <body>
  <h1>Hi <gen:fname/>!</h1>
 </body>
</html> 
```

骨架 2：

```
<html xmlns:gen="my:tranform-generated">
 <body>
  <h1>Hi <gen:fname/> <gen:lname/>!</h1>

  You are <gen:age/> years old.
 </body>
</html> 
```

XSLT 转换作为外部参数传递“要使用的骨架”的 Uri，它“按原样”复制所有节点，但特殊命名的元素除外（其名称位于特殊命名空间“my:tranform-生成”）。这些被 XSLT 转换中与它们匹配的模板的结果替换。

**以下是此类转换的示例**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:gen="my:tranform-generated" exclude-result-prefixes="gen">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pSkeleton" select="'file:///c:/temp/delete/Skeleton1.xml'"/>

 <xsl:variable name="vData" select="/"/>

 <xsl:template match="/">
  <xsl:apply-templates select="document($pSkeleton)/*"/>
 </xsl:template>

 <xsl:template match="*">
     <xsl:element name="{name()}">
       <xsl:copy-of select="namespace::*[not(. = 'my:tranform-generated')]"/>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:element>
 </xsl:template>

 <xsl:template match="@*">
  <xsl:attribute name="{name()}"><xsl:value-of select="."/></xsl:attribute>
 </xsl:template>

 <xsl:template match="*[namespace-uri()='my:tranform-generated']">
  <xsl:value-of select="$vData/*/*[name() = local-name(current())]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于此 XML 文档时**：

```
<person>
 <fname>John</fname>
 <lname>Smith</lname>
 <age>25</age>
</person> 
```

**产生了想要的正确结果（使用 Skeleton1.xml）：**

```
<html>
   <body>
      <h1>Hi John!</h1>
   </body>
</html> 
```

**当对同一个 XML 文档应用相同的转换，但`$pSkeleton`传递给它的外部参数的值为 时`"file:///c:/temp/delete/Skeleton2.xml"`，我们再次得到想要的结果（格式化的 Skeleton2）：**

```
<html>
   <body>
      <h1>Hi JohnSmith!</h1>

      You are 25 years old.

   </body>
</html> 
```

**更新**：

这是一个如何处理迭代的示例——按照 OP 的要求：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:gen="my:tranform-generated" exclude-result-prefixes="gen">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pSkeleton" select="'file:///c:/temp/delete/Skeleton3.xml'"/>

 <xsl:variable name="vData" select="/"/>

 <xsl:template match="/">
  <xsl:apply-templates select="document($pSkeleton)/*"/>
 </xsl:template>

 <xsl:template match="*">
     <xsl:element name="{name()}">
       <xsl:copy-of select="namespace::*[not(. = 'my:tranform-generated')]"/>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:element>
 </xsl:template>

 <xsl:template match="@*">
  <xsl:attribute name="{name()}"><xsl:value-of select="."/></xsl:attribute>
 </xsl:template>

 <xsl:template match="*[namespace-uri()='my:tranform-generated']">
  <xsl:value-of select="$vData/*/*[name() = local-name(current())]"/>
 </xsl:template>

 <xsl:template match="gen:context" priority="2">
     <xsl:apply-templates>
       <xsl:with-param name="pContext"
         select="$vData/*/*[name()=current()/@select][1]"/>
     </xsl:apply-templates>
 </xsl:template>

 <xsl:template match="gen:iterate" priority="2">
  <xsl:param name="pContext"/>

  <xsl:variable name="vDelim" select="string(@delimiter)"/>

  <xsl:for-each select="$pContext/*[name()= current()/@select]">
   <xsl:if test="not(position()=1)"><xsl:copy-of select="$vDelim"/></xsl:if>
   <xsl:copy-of select="node()"/>
  </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

Skeleton3.xml：

```
<html xmlns:gen="my:tranform-generated">
 <body>
  <h1>Hi <gen:fname/> <gen:lname/>!</h1>

  You are <gen:age/> years old.

  Education:
  <gen:context select="education">
    <gen:iterate select="degree" delimiter=", "/>
  </gen:context>
 </body>
</html> 
```

**当上述转换应用于此 XML 文档时：**

```
<person>
 <fname>John</fname>
 <lname>Smith</lname>
 <age>25</age>

 <education>
  <degree>MSc. Biology</degree>
  <degree>MBa.</degree>
  <degree>PhD. Computer Science</degree>
 </education>
</person> 
```

**产生了想要的正确结果**：

```
<html>
   <body>
      <h1>Hi JohnSmith!</h1>

      You are 25 years old.

        Education:
        MSc. Biology, MBa., PhD. Computer Science
   </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T11:34:42.863

是的，这是可能的。您可以在 xsl:if 标签中包围 html 块

例如：

```
<xsl:if test="value &gt; 75000"><p>Print out this html</p></xsl:if> 
```

# xml - Print a string that changes according to node number

> ID：13377942
> 
> 赞同：0
> 
> 时间：2012-11-14T11:28:02.150
> 
> 标签：xml, xslt

I have a XML file like this one

```
<contents>
        <content loid="1.0.71719207" type="images"/>
        <content loid="1.0.71719207" type="images"/>
    <content loid="1.0.71719207" type="images"/>
    <content loid="1.0.71719207" type="images"/>
</contents> 
```

With XSL I want to obtain the following XML:

```
<div class="Image_1"></div>
<div class="Image_2"></div>
<div class="Image_3"></div>
<div class="Image_4"></div> 
```

So basically I need to perform a loop and for every `<xsl:for-each select="contents/content">` to print out `<div class="Image_N"></div`> where `N` is the number of the node.

I'm trying with Altova simulator, but I don't know how to increment `N` from 1 to number of nodes.

This is my code. I'm a beginner with XSL:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" omit-xml-declaration="yes" indent="no"     encoding="utf-8" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"     doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN" />
    <xsl:template match="/">

                        <xsl:for-each select="contents/content">
                                <div class="EM_Story_Image_N"></div>

                       </xsl:for-each>

    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:59:22.200

**当这个 XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="/*">
    <xsl:apply-templates />
  </xsl:template>

  <xsl:template match="content">
    <div class="Image_{position()}" />
  </xsl:template>

</xsl:stylesheet> 
```

**...应用于 OP 的原始 XML：**

```
<contents>
  <content loid="1.0.71719207" type="images"/>
  <content loid="1.0.71719207" type="images"/>
  <content loid="1.0.71719207" type="images"/>
  <content loid="1.0.71719207" type="images"/>
</contents> 
```

**...产生了预期的结果：**

```
<div class="Image_1" />
<div class="Image_2" />
<div class="Image_3" />
<div class="Image_4" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T12:08:32.160

`for`XSLT 中没有像您在更多过程或 OO 语言中那样的计数循环，但您确实可以访问当前列表中当前节点的位置，您正在通过该`position()`函数对其进行迭代。

```
<xsl:for-each select="contents/content">
  <div class="EM_Story_Image_{position()}"></div>
</xsl:for-each> 
```

但请注意，这在`position()`很大程度上取决于上下文 - 如果你有，说

```
<contents>
  <content loid="1.0.71719207" type="images"/>
  <content loid="1.0.71719207" type="images"/>
  <content type="somethingelse" />
  <content loid="1.0.71719207" type="images"/>
  <content loid="1.0.71719207" type="images"/>
</contents> 
```

那么在`<xsl:for-each select="contents/content">`最后一个`<content>`元素中的位置为 5，但在`<xsl:for-each select="contents/content[@type='images']">`同一个节点中的位置为 4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T12:49:01.237

我建议学习 Michael Kay 的书“XSLT 2.0 和 XPath 2.0 程序员参考”（[亚马逊链接与回扣](http://www.amazon.com/gp/search/ref=as_li_qf_sp_sr_tl?ie=UTF8&camp=1789&creative=9325&index=aps&keywords=XSLT%202.0%20and%20XPath%202.0%20Programmer%27s%20Reference&linkCode=ur2&tag=bernhardwagne-20 "XSLT 2.0 和 XPath 2.0 程序员参考")）

这是一种比使用更麻烦的方法`position()`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" omit-xml-declaration="yes" indent="no"     encoding="utf-8" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"     doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN" />
    <xsl:template match="/">
        <html>
            <head><title>Test conteggio</title>
            </head>
            <body>

                <xsl:for-each select="contents/content">
                    <xsl:variable name="count"><xsl:number level="any" count="content"/></xsl:variable>
                    <div class="Image_{$count}"></div>
                </xsl:for-each>

            </body>
        </html>
    </xsl:template>
</xsl:stylesheet> 
```

# ruby-on-rails - Rails UJS - Unbind Event handlers

> ID：13377943
> 
> 赞同：2
> 
> 时间：2012-11-14T11:28:04.883
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

I've a delete button generated by the `link_to` helper method. It produces the following markup.

```
<a href="/clips/150" class="btn btn-mini btn-danger" data-confirm="Are you sure?" data-method="delete" rel="nofollow">Destroy</a> 
```

When, I click this button, it opens `confirm` dialog box as expected.

However, I want to override this confirm dialog box. I want to show a confirm dialog box using [Bootbox](http://bootboxjs.com).

So, I tried to unbind the click events from these buttons. I've tried all the following ways (in console). But none works.

```
$('a[data-confirm]').unbind('click') 
```

or,

```
$('a[data-confirm]').off('click') 
```

or,

```
$('a[data-confirm]').undelegate('click') 
```

Even, I tried `click.rails` as event name as I see this is the declaration in jquery_ujs.js.

```
$(document).delegate(rails.linkClickSelector, 'click.rails', function(e) { 
```

You may ask me to remove `:confirm => true` when calling helper method. But I don't want that. I want that as default feature. I will override runtime. How can I achieve that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:32:59.533

尽管我询问了如何覆盖 rails ujs 默认确认方法，但我的实际意图是使用引导框确认对话框而不是默认浏览器的确认框。

我在这里得到了开箱即用的解决方案。我在这里链接这个，以便它帮助其他有类似要求的人：

[https://gist.github.com/2823526](https://gist.github.com/2823526)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:43:59.463

如何覆盖默认的确认操作？参见 UJS 的源代码：

```
// Default confirm dialog, may be overridden with custom confirm dialog in $.rails.confirm
confirm: function(message) {
  return confirm(message);
}, 
```

# javascript - jQuery中是否有一种方法可以从元素向上遍历dom树并在其父元素之前检查选择器

> ID：13377945
> 
> 赞同：3
> 
> 时间：2012-11-14T11:28:13.227
> 
> 标签：javascript, jquery

例如：

```
<div class="mainWrapper">
    <div class="FirstLayer">
        <input class="foo" value="foo" />
    </div>

    <div class="SecondLayer">
        <div class="thirdLayer">
            <input class="fee" />
        </div>
    </div>
</div> 
```

假设我有`input.fee`jQuery 对象，我还需要获取`input.foo`. 现在我知道我可以使用多种方法，`$(this).parents(':eq(2)').find('.foo')`但我想在具有不同级别和节点数量的布局上使用这种方法。所以我想知道是否有一种方法可以简单地从开始`.fee`并一直向上直到找到第一个匹配元素，`.prevAll()`似乎没有这样做。有很多元素`.foo`，我特别需要上下文中`.fee`的第一个元素。`.fee`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T11:31:54.653

这个怎么样：

```
$('input.fee').closest(':has("input.foo")')
              .find('input.foo').val(); 
```

这是[**JS Fiddle**](http://jsfiddle.net/YZ6vg/3/)可以玩的。)

更新：对@VisioN 表示敬意——当然，`parents:first`它很好地被`closest`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:46:59.123

这将选择之前的 input.foo

```
// self might have siblings that are input.foo so include in selection
$( $("input.fee").parentsUntil(":has(input.foo)").andSelf()

        // if input.off is sibling of input.fee then nothing will
        // be returned from parentsUntil. This is the only time input.fee
        // will be selected by last(). Reverse makes sure self is at index 0
        .get().reverse() )

        // last => closest element
        .last()                 

        //fetch siblings that contain or are input.foo elements
        .prevAll(":has(input.foo), input.foo") 

        // first is closest
        .first() 

        // return jQuery object with all descendants
        .find("*")         

        // include Self in case it is an input.foo element 
        .andSelf() 

        .filter("input.foo")

        // return value of first matching element
        .val() 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-14T11:30:05.977

[`jQuery.closest()`](http://api.jquery.com/closest/)接受选择器并完全按照您的需要 - 找到第一个匹配的元素，它是某物的父元素。还有[jQuery.parents()](http://api.jquery.com/parents/)确实采用选择器来过滤元素祖先。使用那些与方法相结合的`find`方法，你就设置好了。

`$('input.fee').closest('.mainWrapper").find('.foo')`有诀窍，不是吗？

# google-maps - 如何在谷歌地图上获得两点（火车站）的纬度/纬度？

> ID：13377948
> 
> 赞同：1
> 
> 时间：2012-11-14T11:28:27.213
> 
> 标签：google-maps

我即将用方向服务追踪两个车站之间的铁路。问题是我不能得到两个站的纬度/经度，它总是得到一个邻居点。

路线是（在谷歌地图网站上搜索）：

```
Ceres, TO to Stazione Porta Nuova, Corso Vittorio Emanuele II, 58, Torino 
```

我需要 Ceres（火车站）和 Stazione Porta Nuova, Corso Vittorio Emanuele II, 58, Torino（火车站）的纬度/纬度。我怎样才能得到它们？

所以我可以在我的地图上画出同一条铁路（棕色线）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T11:38:50.323

```
public class GetXMLTask
{
    static double longitute;
    static double latitude;
    public JSONObject getLocationInfo(String address)
    {
        StringBuilder stringBuilder = new StringBuilder();
        try 
        {
            address = address.replaceAll(" ","%20");    
            HttpPost httppost = new HttpPost("http://maps.google.com/maps/api/geocode/json?address=" + address + "&sensor=false");
            HttpClient client = new DefaultHttpClient();
            HttpResponse response;
            stringBuilder = new StringBuilder();
            response = client.execute(httppost);
            HttpEntity entity = response.getEntity();
            InputStream stream = entity.getContent();
            int b;
            while ((b = stream.read()) != -1) 
            {
                stringBuilder.append((char) b);
            }
        } 
        catch (ClientProtocolException e) 
        {
            Log.i("getLocationInfo ClientProtocolException", e.toString());
        } 
        catch (IOException e) 
        {
            Log.i("getLocationInfo IOException", e.toString());
        }
        JSONObject jsonObject = new JSONObject();
        try 
        {
            jsonObject = new JSONObject(stringBuilder.toString());
        } 
        catch (JSONException e) 
        {
            Log.i("getLocationInfo JSONException", e.toString());
        }
        return jsonObject;
    }

    public ArrayList<Double> getLatLong(JSONObject jsonObject) 
    {
        ArrayList<Double> latlng = new ArrayList<Double>();

        try 
        {
            longitute = ((JSONArray)jsonObject.get("results")).getJSONObject(0).getJSONObject("geometry").getJSONObject("location").getDouble("lng");
            latitude = ((JSONArray)jsonObject.get("results")).getJSONObject(0).getJSONObject("geometry").getJSONObject("location").getDouble("lat");
            latlng.add(latitude);
            latlng.add(longitute);
        } 
        catch (JSONException e) 
        {
            longitute = 0;
            latitude = 0;
            Log.i("getLatLong", e.toString());
        }
        return latlng;
    }
}

now we can call it inside our class by

latitude = new GetXMLTask().getLatLong(new GetXMLTask().getLocationInfo(address)).get(0);
longitude = new GetXMLTask().getLatLong(new GetXMLTask().getLocationInfo(address)).get(1); 
```

我可能没有超级优化的代码，但这对我来说工作得很好，试一试，只是在你的调用类中传递了地址

# java - 什么是定义地图的正确方法 方法参数

> ID：13377953
> 
> 赞同：3
> 
> 时间：2012-11-14T11:28:43.990
> 
> 标签：java, generics

我有一个自定义 Map to String 方法。它适用于任何类型的具有 String 键的 Map，不限于某些特定的映射值类型。例如，映射值可能来自`javax.jms.Message.getObjectProperty(String name)`方法，或者只是纯字符串。

以下哪个是最“正确”的方法签名，为什么，或者都是平等的？

```
String map2String(Map<String, Object> map){...} 
```

或者

```
String map2String(Map<String, ?> map){...} 
```

或者

```
String map2String(Map<String, ? extends Object> map){...} 
```

或（添加编辑）

```
<E> String map2String(Map<String, ? extends E> map){...} 
```

或者是其他东西？

此外，该方法包含类似于这样的 for-each 循环：

```
for(Entry<String, ?> entry : map.entrySet()) {
    String key = entry.getKey();
    String value = entry.getValue().toString();
} 
```

哪个是`entry`变量的“正确”类型，是否重要（`?`映射中的不兼容组合除外，`Object`在条目类型中）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T11:49:37.623

`String map2String(Map<String, ?> map){...}`是正确的（`? extends Object`是多余的）

第一个不起作用，因为你不能打电话

```
Map<String,Integer> myMap = {...}
map2String(myMap); // Map<String,Integer>  is not  Map<String,Object> 
```

条目变量的正确类型`Entry<String, ?>`正如您所怀疑的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:38:38.363

最好的方法是使用您发布的第一个示例，而不是`Object`使用您的类类型。否则，您必须将 Object 转换为其他类或使用`instanceof`，这不是一个好主意

```
 String map2String(Map<String, YourClass> map){...} 
```

关于其他：

`String map2String(Map<String, ? extends Object> map){...}`

好吧，`? extends Object`这不是最好的选择，因为每个类都派生自`Object`. `? extends Object`和之间没有区别`?`。

`extends`在以下情况下可以使用通配符：

```
class MyClass extends RootClass
....
class YourClass extends RootClass
....
String map2String(Map<String, ? extends RootClass> map)   // this method can fetch argumets by type of Map  `MyClass` and `YourClass`. 
```

更远：

```
String map2String(Map<String, ?> map){...} 
```

假设您没有使用`String map2String(Map map){...}`任何类型。编译器会告诉你： *Map 是一种原始类型。对泛型类型 Map 的引用应该被参数化*。但是您懒得考虑要采用的女巫参数。我看到很多次，人们键入：`String map2String(Map<?,?> map){...}`删除警告。但它的坏方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T12:36:45.690

处理集合我会选择继承和泛型作为原则。

例如，我会声明一个接口或抽象基类，并将其作为集合类型参数传递，例如：

```
public abstract class AnimalBaseClass {
    //...
    public abstract void makeSound();
}

public interface AnimalInterface {
    public void makeSound();
} 
```

然后集合将变成`Map<String, AnimalInterface>`or 或`Map<String, ? extends AnimalBaseClass>`。这样，第一个映射将接受任何实现`AnimalInterface`的类，第二个映射将接受抽象基类的任何子类`AnimalBaseClass`，例如`Dog extends AnimalBaseClass`.

至于您关于定义列表中的野生类型的问题，答案在于java泛型的继承原则，即：`List<Integer>`不是 的子类型`List<Number>`，而是`List<Integer>`or`List<? extends Integer>`的子类型`List<? extends Number>`。所以，如果你有`List<Integer> li`并且`List<Number> ln`你不能等同于`ln = li`. `ln`但是，如果您声明`List<? extends Number> ln`等式将有效。但不要忘记，虽然等式是有效的，但将 Numbers 添加到列表中会导致编译时错误，例如 in `ln.add(new Float())`，因此您的引用将更像是内容的“只读”版本。

因此，您的通用方法将变为：

```
public <T extends YourBaseClass> String map2String(Map<String, T> map) {
    //do something with your map and return a String object
} 
```

而且，如果你想`Object`成为你的基类，只需省略' `extends YourBaseClass`'。

# c# - 无法在 HttpResponseMessage 标头上设置 Content-Type 标头？

> ID：13377957
> 
> 赞同：80
> 
> 时间：2012-11-14T11:29:18.670
> 
> 标签：c#, asp.net, rest, asp.net-web-api

我正在使用 ASP.NET WebApi 创建一个 RESTful API。我正在我的一个控制器中创建一个 PUT 方法，代码如下所示：

```
public HttpResponseMessage Put(int idAssessment, int idCaseStudy, string value) {
    var response = Request.CreateResponse();
    if (!response.Headers.Contains("Content-Type")) {
        response.Headers.Add("Content-Type", "text/plain");
    }

    response.StatusCode = HttpStatusCode.OK;
    return response;
} 
```

当我通过 AJAX 使用浏览器放置到该位置时，它给了我这个异常：

> 误用的标头名称。确保请求标头与 HttpRequestMessage 一起使用，响应标头与 HttpResponseMessage 一起使用，内容标头与 HttpContent 对象一起使用。

但是对于响应来说，这不是`Content-Type`一个完全有效的标头吗？为什么我会收到此异常？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-11-14T11:39:59.627

看看[HttpContentHeaders.ContentType 属性](http://msdn.microsoft.com/en-us/library/system.net.http.headers.httpcontentheaders.contenttype.aspx)：

```
response.Content.Headers.ContentType = new MediaTypeHeaderValue("text/plain"); 
```

* * *

```
if (response.Content == null)
{
    response.Content = new StringContent("");
    // The media type for the StringContent created defaults to text/plain.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-12T17:44:20.660

ASP Web API 中缺少一些东西：`EmptyContent`类型。它将允许发送空正文，同时仍允许所有特定于内容的标头。

将以下类放在代码中的某个位置：

```
public class EmptyContent : HttpContent
{
    protected override Task SerializeToStreamAsync(Stream stream, TransportContext context)
    {
        return Task.CompletedTask;
    }
    protected override bool TryComputeLength(out long length)
    {
        length = 0L;
        return true;
    }
} 
```

然后根据需要使用它。您现在有一个用于额外标题的内容对象。

```
response.Content = new EmptyContent();
response.Content.Headers.LastModified = file.DateUpdatedUtc; 
```

为什么使用`EmptyContent`而不是`new StringContent(string.Empty)`？

*   [`StringContent`](https://github.com/dotnet/corefx/blob/master/src/System.Net.Http/src/System/Net/Http/ByteArrayContent.cs)是一个执行大量代码的重类（因为它继承了[`ByteArrayContent`](https://github.com/dotnet/corefx/blob/master/src/System.Net.Http/src/System/Net/Http/ByteArrayContent.cs)）
    *   所以让我们节省几纳秒
*   `StringContent`将添加一个额外的无用/有问题的标题：`Content-Type: plain/text; charset=...`
    *   所以让我们节省一些网络字节

# iphone - ios - 每次 application:openURL:sourceapplication 被触发时，iCloud 备份大小都会增加

> ID：13377960
> 
> 赞同：2
> 
> 时间：2012-11-14T11:29:23.560
> 
> 标签：iphone, ios, size, icloud, openurl

我有一个可以打开不同文件的应用程序。为避免应用程序被 Apple 拒绝，只需将用户数据备份到 iCloud。我已尽一切努力满足“iOS 数据存储指南”的要求。

但我无法解决这个问题：每次应用程序：openURL:sourceApplication:annotation: 方法被触发时，我的应用程序的 iCloud 大小都会增加文件大小。

为了测试，现在当 openURL 方法被触发时，我只是返回 YES，所以我的应用程序对传入的 URL 什么都不做，但大小仍然增加。

正在发生的事情的摘要（例如从邮件应用程序打开 3 mb 的邮件附件）：
- iCloud 上应用程序的实际大小：3Mb
- 点击附件
- 选择使用我的应用程序打开
- 触发 openURL 事件
- openURL 返回是的，无需做任何其他事情
- iCloud 上应用程序的实际大小：6Mb

我做错了什么？

谢谢克劳迪奥

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T13:45:34.220

该文件正在从电子邮件应用程序的沙箱复制到您的应用程序的沙箱中。通过查看 URL 组件，您可以准确地看到它的位置。您很可能希望 iCloud 排除该文件（我建议将其移动到已设置此标志的文件夹中），如果您的应用程序不再需要该文件，请务必清理该文件。

# iphone - 如何将 twitter 登录页面（iPhone 设置页面）重定向到我的应用程序？

> ID：13377961
> 
> 赞同：2
> 
> 时间：2012-11-14T11:29:28.373
> 
> 标签：iphone, ios, twitter

我正在使用 Twitter 框架进行 Twitter 连接。它完美登录，但登录后不会重定向到我的应用程序。一旦我登录然后手动关闭设置页面，如何以编程方式重定向到应用程序。我怎样才能做到这一点？请帮我。提前致谢。我正在使用下面的代码

```
if ([TWTweetComposeViewController canSendTweet])
{
    // Create account store, followed by a twitter account identifer
    account = [[ACAccountStore alloc] init];
    ACAccountType *accountType = [account accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

    // Request access from the user to use their Twitter accounts.
    [account requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error)
     {
         // Did user allow us access?
         if (granted == YES)
         {
             // Populate array with all available Twitter accounts
             twitterInfoArray = [account accountsWithAccountType:accountType];

             NSLog(@"account = %@", account);
             NSLog(@"arrayOfAccounts = %@", twitterInfoArray);

             // Populate the tableview
             if ([twitterInfoArray count] > 0)
             {
                 [self performSelectorOnMainThread:@selector(StartwithTwitterUser) withObject:NULL waitUntilDone:NO];
             }
             else
             {
                 NSLog(@"Not Login");
             }
         }
     }];
}
else
{
    [self LoadTwiiter];
} 
```

# windows - 使用 ClickOnce 部署的应用程序验证桌面应用程序问题

> ID：13377965
> 
> 赞同：1
> 
> 时间：2012-11-14T11:29:38.497
> 
> 标签：windows, windows-8, visual-studio-2012, clickonce, windows-store

我在 Windows 8 下的 Visual Studio 2012 中使用 ClickOnce 部署了一个 C# 应用程序，我想将其验证为要在 Windows 应用商店中列出的桌面应用程序。

此应用程序使用 ClickOnce 成功安装在 Windows 8 中，但是当我尝试使用 Windows 应用程序认证工具包对其进行验证时，最终出现以下错误：

> 由于您的安装，Windows 应用认证工具包未检测到任何新应用程序。
> 
> 除非成功安装应用程序，否则测试无法继续。
> 
> 请确认您的安装程序工作正常并再次运行 Windows 应用认证工具包。

由于 ClickOnce 部署集成在 Visual Studio 2012 中，我对这个错误感到非常失望。有没有办法使用 ClickOnce 部署的应用程序通过 Windows 应用程序认证工具包测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:09:35.937

不可以，ClickOnce 应用程序无法通过认证。:( 这是来自 Windows 应用商店团队的官方说法：“ClickOnce 部署管理安装/卸载与传统安装程序有点不同。例如，安装位置不会按照桌面认证要求的要求转到 %ProgramFiles%，简而言之切割具有 Windows 应用程序使用的不同扩展名，例如 *.lnk 等。结果是这些应用程序没有被 ACK 正确检测到，因此无法被认证。

这是[解释桌面应用程序认证要求的链接](http://msdn.microsoft.com/en-us/library/windows/desktop/hh749939)。要求您的应用程序安装在 Program Files 下，并且 ClickOnce 应用程序安装在用户文件夹下。这个和其他要求导致它无法认证。

# r - 处理R中的矩阵

> ID：13377973
> 
> 赞同：1
> 
> 时间：2012-11-14T11:30:02.973
> 
> 标签：r

我的任务是获取一组给定数据并将其作为矩阵发布，我已经完成了这项工作。

现在，我已经有了这个带有列名和行名的矩阵，我需要检查矩阵中条目的绝对值是否大于 0.5。如果是这种情况，则需要打印此特定值以及列和行的名称。

此外，所讨论的矩阵是对称的，其对角线的值等于 1，因此不必打印。

您对如何实现它有任何想法吗？我应该将这些结果放入矩阵还是数据框中？这两个哪个更容易实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:06:57.710

一个例子：

```
set.seed(101)
x <- matrix(rnorm(100),10) 
xx <- cor(x) # correlation matrix
rownames(xx) <- colnames(xx) <- letters[1:10] 
```

找到感兴趣的组合 (|r| > 0.5)：

```
combinations <- levels(interaction(rownames(xx), colnames(xx)))
idx <- abs(xx) > 0.5
diag(idx) <- idx[upper.tri(idx)] <- FALSE
results <- data.frame(combination = combinations[idx], rho = xx[idx])

#   combination        rho
# 1         d.a -0.5739332
# 2         e.a  0.6352977
# 3         f.c  0.5977269
# 4         h.g -0.8208542 
```

# deployment - 从私有 github 存储库部署

> ID：13377978
> 
> 赞同：2
> 
> 时间：2012-11-14T11:30:05.967
> 
> 标签：deployment, github

我是 git 和 github 的新手（我之前使用过 Subversion）。我找不到解决方案，如何仅将主分支从我的私有存储库导出到我的生产服务器。

我需要准备一个自动化解决方案（通过结构调用）。我发现 git 有存档命令，但这不适用于 github（我设置了 SSH 密钥）：

```
someuser@ews1:~/sandbox$ git archive --format=tar --remote=git@github.com:someuser/somerepository.git master
Invalid command: 'git-upload-archive 'someuser/somerepository.git''
  You appear to be using ssh to clone a git:// URL.
  Make sure your core.gitProxy config option and the
  GIT_PROXY_COMMAND environment variable are NOT set.
fatal: The remote end hung up unexpectedly 
```

所以我需要另一种方法来做到这一点。我不想在导出中使用来自 git 的任何元文件。当我克隆时，我会将所有这些文件放在 .git 目录中（我不想要），这会下载比我真正需要的更多的数据。

有没有办法通过 ssh 做到这一点？或者我只能通过 HTTPS 下载 zip 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:36:57.277

我不确定我是否完全理解你的问题。

我使用此命令将当前主版本拉到我的服务器：

```
curl -sL --user "user:pass" https://github.com/<organisation>/<repository>/archive/master.zip > master.zip 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-11T08:49:42.773

正如我在[**SO answer on download GitHub archives from a private repo**](https://stackoverflow.com/a/25782826/1872673)中解释的那样，在创建[GitHub 访问令牌](https://stackoverflow.com/a/25782826/1872673)后，您可以使用`wget`或`curl`获取所需`<version>`的 repo（例如`master`，`HEAD`提交 SHA-1，...）。

解决方案`wget`：

```
wget --output-document=<version>.tar.gz \
    https://api.github.com/repos/<owner>/<repo>/tarball/<version>?access_token=<OAUTH-TOKEN> 
```

解决方案`curl`：

```
curl -L https://api.github.com/repos/<owner>/<repo>/tarball/<version>?access_token=<OAUTH-TOKEN> \
    > <version>.tar.gz 
```

# c - 不使用时删除posix共享内存？

> ID：13377982
> 
> 赞同：16
> 
> 时间：2012-11-14T11:30:08.113
> 
> 标签：c, linux, shared-memory

是否有任何方法，无论是否特定于 linux，`shm_open()`在没有进程使用它们时删除 posix 共享内存段（使用 获得）。即对它们进行引用计数，并在引用变为 0 时让系统删除它们

几点注意事项：

*   如果程序崩溃，建立一个 atexit 处理程序来删除它们不起作用。

*   目前，linux特有的方式，我将pid嵌入到段名中，并尝试通过在外部程序中走/dev/shm来找到未使用的段。其缺点是必须定期以一种相当骇人的方式从外部清理它们。

*   由于程序可以运行多个副本，因此为程序在启动时重用的段使用定义明确的名称是不可行的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T22:17:10.547

如果您的程序执行中有一个众所周知的点，即所有需要打开共享内存段的进程都已经这样做了，您可以安全地取消链接它。取消链接会将对象从全局命名空间中移除，但只要至少有一个进程保持其文件描述符处于打开状态，它就会一直存在。如果在那之后发生崩溃，文件描述符会自动关闭，并且引用计数会减少。一旦没有打开未链接共享内存块的描述符，它就会被删除。

这在以下场景中很有用：进程创建一个共享内存块，取消链接，然后分叉。子进程继承文件描述符，可以使用共享内存块与父进程通信。一旦两个进程都终止，该块将在两个文件描述符都关闭时自动删除。

未链接时，共享内存块无法供其他进程打开。同时，如果使用`shm_open()`与未链接块相同的名称，则会创建一个新的完全不同的共享内存块。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T17:25:21.610

不——至少在 Linux 上，内核不包含任何可以做到这一点的东西。某些应用程序需要在某个时候调用 shm_unlink() 以摆脱共享内存段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-12T13:53:34.100

我找到了一种使用系统命令和 Linux 命令“fuser”的方法，它允许列出打开文件的进程。这样，你可以检查共享内存文件（位于/dev/shm"）是否还在使用，如果没有就删除它。注意检查/删除/创建操作必须包含在进程间临界区中使用命名互斥锁或命名信号量或文件锁。

```
 std::string shm_file = "/dev/shm/" + service_name + "Shm";
        std::string cmd_line = "if [ -f " + shm_file + " ] ; then if ! fuser -s " + shm_file + " ; then rm -f " + shm_file + " ; else exit 2 ; fi else exit 3 ; fi";
        int res = system(cmd_line.c_str());
        switch (WEXITSTATUS(res)) {
        case 0: _logger.warning ("The shared memory file " + shm_file + " was found orphan and is deleted");         break;
        case 1: _logger.critical("The shared memory file " + shm_file + " was found orphan and cannot be deleted");  break;
        case 2: _logger.trace   ("The shared memory file " + shm_file + " is linked to alive processes");            break;
        case 3: _logger.trace   ("The shared memory file " + shm_file + " is not found");                            break;
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-02-18T15:06:38.407

对于使用 sysV API 创建的共享内存，可能会有这样的行为。仅在 Linux 上。它不是 POSIX 共享内存，但可能对您有用。

在[The Linux Programming Interface](http://shop.oreilly.com/product/9781593272203.do)一书中，shmctl() 的可能参数之一描述如下。

> IPC_RMID 将共享内存段及其关联的 shmid_ds 数据结构标记为删除。如果当前没有进程附加该段，则立即删除；否则，在所有进程都与它分离后（即，当 shmid_ds 数据结构中的 shm_nattch 字段的值降至 0 时），该段被删除。在某些应用程序中，我们可以确保在应用程序终止时整齐地清除共享内存段，方法是在所有进程都使用 shmat() 将其附加到其虚拟地址空间后立即将其标记为删除。这类似于打开文件后取消链接。在 Linux 上，如果已使用 IPC_RMID 将共享段标记为删除，但尚未删除，因为某些进程仍然附加它，那么另一个进程可以附加该段。然而，这种行为是不可移植的：大多数 UNIX 实现阻止新的附加到标记为删除的段。（SUSv3 对在这种情况下应该发生什么行为保持沉默。）一些 Linux 应用程序已经开始依赖这种行为，这就是为什么 Linux 没有被更改以匹配其他 UNIX 实现的原因。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-23T11:37:29.230

让我们假设最复杂的情​​况：

*   您有多个进程通过共享内存进行通信
*   他们可以随时开始和结束，甚至可以多次。这意味着没有主进程，也没有可以初始化共享内存的专用“第一个”进程。
*   这意味着，例如，您无法安全地取消链接共享内存，因此[Sergey](https://stackoverflow.com/a/35485092/214777)和[Hristo 的](https://stackoverflow.com/a/13445202/214777)答案都不起作用。

我看到了两种可能的解决方案，并欢迎对它们提供反馈，因为互联网对这个问题非常沉默：

1.  将写入共享内存中的共享内存的最后一个进程的 pid（或更具体的进程标识符，如果有的话）存储为锁。然后你可以做某事。像下面的伪代码：

    ```
     int* pshmem = open shared memory()

     while(true) 
         nPid = atomic_read(pshmem)
         if nPid = 0 
            // your shared memory is in a valid state
            break
         else 
            // process nPid holds a lock to your shared memory
            // or it might have crashed while holding the lock
            if process nPid still exists 
              // shared memory is valid
              break
            else 
              // shared memory is corrupt
              // try acquire lock 
              if atomic_compare_exchange(pshmem, nPid, my pid) 
                 // we have the lock
                 reinitialize shared memory
                 atomic_write(pshem, 0) // release lock
              else 
                 // somebody else got the lock in the meantime
                 // continue loop 
    ```

    这验证了最后一位作家在写作时没有死。共享内存的持续时间仍然比您的任何进程长。

2.  使用读取器/写入器文件锁来确定是否有任何进程是第一个打开共享内存对象的进程。然后第一个进程可能会重新初始化共享内存：

    ```
     // try to get exclusive lock on lockfile
     int fd = open(lockfile, O_RDONLY | O_CREAT | O_EXLOCK | O_NONBLOCK, ...)
     if fd == -1
         // didn't work, somebody else has it and is initializing shared memory
         // acquire shared lock and wait for it
         fd = open(lockfile, O_RDONLY | O_SHLOCK)
         // open shared memory
     else 
         // we are the first
         // delete shared memory object
         // possibly delete named mutex/semaphore as well

         // create shared memory object (& semaphore)
         // degrade exclusive lock to a shared lock
         flock(fd, LOCK_SH) 
    ```

    文件锁似乎是 POSIX 系统上唯一（？）在进程终止时自动清除的机制。不幸的是，[使用它们的注意事项列表非常非常长](http://chris.improbable.org/2010/12/16/everything-you-never-wanted-to-know-about-file-locking/)。该算法假设`flock`至少在本地机器上支持底层文件系统。该算法不关心锁是否对 NFS 文件系统上的其他进程实际可见。它们只需对访问共享内存对象的所有进程可见。

    [此解决方案已在 boost.interprocess 之上实施。](https://github.com/boostorg/interprocess/pull/132)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T12:05:51.573

你不能只使用全局计数信号量来引用计数吗？包装附加和分离调用，以便信号量在附加到内存时递增，在分离时递减。当分离将信号量减少到零时释放段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-14T12:37:18.360

不确定，如果以下工作，或可行。但我的尝试。

为什么不执行每次程序崩溃时都会执行的帮助程序。

IE：

```
/proc/sys/kernel/core_pattern  to  /path/to/Myprogram %p 
```

Myprogram 在进程崩溃时执行，可能您可以进一步探索。

看

```
man 5 core.  for more information. 
```

希望这在一定程度上有所帮助。

# php - Zend 框架模块库

> ID：13377983
> 
> 赞同：2
> 
> 时间：2012-11-14T11:30:10.100
> 
> 标签：php, zend-framework, refactoring, autoload

我正在开发一个 Zend Framework (1.11) 应用程序，我将其移植到模块中，以便开发人员可以插入和播放我们软件的各种添加内容，也可以轻松删除。

我遇到的问题（并且似乎无法找到答案）我有可靠的库代码，即我的结构目前是这样

```
- application
  - (the standard ZF stuff)
  - modules
     - testModule
        - Bootstrap.php
        - controllers
        - configs
        - views
 - library
    - CoreStuff
       - Class.php
       - SpecialClass.php
    - testModuleLibrary
       - Class.php
       - SpecialClass.php 
```

而我真正想要的是这样，以便其他开发人员更容易将模块安装到我们的系统中。

```
 - application
   - (the standard ZF stuff)
   - modules
      - testModule
         - Bootstrap.php
         - controllers
         - configs
         - views
         - library
            - Class.php
            - SpecialClass.php
 - library
    - CoreStuff
       - Class.php
       - SpecialClass.php 
```

我可以在模块 Bootstrap 中使用 Autoloader 吗？还是我必须将它添加到我的包含路径中？

[编辑]

这是我当前的模块引导程序，我用危险的谷歌搜索一次又一次地看到这段代码，但它似乎没有任何区别

```
<?php

    class Notifications_Bootstrap extends Zend_Application_Module_Bootstrap {

        protected function _initLibraryAutoloader () {
            return $this->getResourceLoader()->addResourceType('library', 'library', 'library');
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T10:26:48.627

您可以在应用程序配置文件中定义您的库路径，例如：这是 YML 中的示例

```
project:
    bootstrap:
        path: APPLICATION_PATH/Bootstrap/index.php
        class: Bootstrap_Index
    Autoloadernamespaces:
        - Zend_
        - Library1_
        - Library2_
    resources:
        FrontController:
            moduledirectory:
                - APPLICATION_PATH/modules
...... 
```

这是 INI 格式的示例

```
[bootstrap]
        Autoloadernamespaces[] = "Zend_"
        Autoloadernamespaces[] = "Library1_"
        Autoloadernamespaces[] = "Library2_"

        resources.FrontController.moduleDirectory = APPLICATION_PATH"/modules"
        resources.FrontController.resetRouterOnEveryRequest = true

        bootstrap.path = APPLICATION_PATH "/Bootstrap/index.php"
        bootstrap.class = "Bootstrap_Index" 
```

关于项目目录结构，我建议您使用类似于：

```
- application 
    - Bootstrap
        - index.php
    - Modules
        - Mod1
            - controllers
            - views
        - Mod2
            - controllers
            - views
        ...
- library 
    - Zend
        - ...
    - Library1
        - ...
    - Library2
        - ... 
```

完成目录结构后，您可以拥有像 /:module/:controller/:action 这样的 URL，并将所有第 3 方代码分开保存在自己的池库目录中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T15:25:02.873

我已经用以下代码解决了我的问题。我真的不知道为什么我没有早点想出这个:( :(

```
class Notifications_Bootstrap extends Zend_Application_Module_Bootstrap {
    protected function _initConfig () {
        set_include_path(implode(PATH_SEPARATOR, array(
            dirname(__FILE__) . '/library',
            get_include_path(),
        )));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:58:33.257

我添加此回复希望既能回答原始查询，又能对此处提交的一些项目进行澄清。我是 ZF 1.11 中模块的活跃开发人员，并且在我们维护的几个模块之一中使用我每天将要解释的内容。

对于此回复的长度，我提前道歉。有几个项目需要涵盖和考虑。

首先，对于实施。

据我所知，提供的以下代码段在 1.8 左右工作，而不是您想要的 1.11。

```
<?php

class Notifications_Bootstrap extends Zend_Application_Module_Bootstrap {

    protected function _initLibraryAutoloader () {
        return $this->getResourceLoader()->addResourceType('library', 'library', 'library');
    }

} 
```

如果我将在下面解释一些关键元素，以下内容将可以正常工作。

```
protected function _initLibraryAutoloader () {
    return $this->getResourceLoader()->addResourceType('library', 'library', 'Library_');
} 
```

您会注意到第三个参数（命名空间）略有不同。对此的最佳解释是可能将函数更新为以下内容：

```
protected function _initLibraryAutoloader () {
    $this->getResourceLoader()->addResourceType('library', 'library', 'Library_');
    var_dump($this->getResourceLoader()->getResourceTypes());die;
} 
```

您的输出应该类似于：

```
Array
(
[dbtable] => Array
    (
        [namespace] => Admin_Model_DbTable
        [path] => /path/to/trunk/application/modules/admin/models/DbTable
    )

[mappers] => Array
    (
        [namespace] => Admin_Model_Mapper
        [path] => /path/to/trunk/application/modules/admin/models/mappers
    )

[form] => Array
    (
        [namespace] => Admin_Form
        [path] => /path/to/trunk/application/modules/admin/forms
    )

[model] => Array
    (
        [namespace] => Admin_Model
        [path] => /path/to/trunk/application/modules/admin/models
    )

[plugin] => Array
    (
        [namespace] => Admin_Plugin
        [path] => /path/to/trunk/application/modules/admin/plugins
    )

[service] => Array
    (
        [namespace] => Admin_Service
        [path] => /path/to/trunk/application/modules/admin/services
    )

[viewhelper] => Array
    (
        [namespace] => Admin_View_Helper
        [path] => /path/to/trunk/application/modules/admin/views/helpers
    )

[viewfilter] => Array
    (
        [namespace] => Admin_View_Filter
        [path] => /path/to/trunk/application/modules/admin/views/filters
    )

[library] => Array
    (
        [namespace] => Admin_Library
        [path] => /path/to/trunk/application/modules/admin/library
    )

) 
```

如果您将其与之前的“库”作为第三个参数进行比较，您很快就会明白为什么它会产生如此重要的差异。

重申一下，此时，您已经声明了一个带有“Library_”前缀的库类型，它转换为“Admin_Library”。现在，要实现这一点，您将在模块中拥有库文件夹，就像在主应用程序模块中一样，只需稍作调整。要拥有一个 Admin 模块特定的控制器操作 (Admin_Library_Controller_Action)，您将拥有 library/Controller/Action.php，其类名为 Admin_Library_Controller_Action。这是大多数人一开始会感到困惑的地方，但它与您应该在模块中使用的其他资源命名空间非常相似。

技术解释到此结束。如果您不再阅读，您将能够拥有一个特定于您的模块并且完全独立的库，以便于复制/粘贴可重用模块的实现。

现在对我在这里看到的其他一些回复发表一些评论。

无穷大

> “如果您遵循您的结构，您最终可能会得到 - Module1 (Lib1, Lib2) - Module2 (Lib1, Lib3)，因此您将开始复制所需的库。”

这在技术上是正确的，但如果您发现自己经常在各处使用相同的库，则确实会在您的实际开发风格中带来更多问题。我们通常将这些公共项目存储在另一个库中，我们将其用作外部库，与 Zend 相同，并与 Zend 并排放置在主应用程序库文件夹中。

如果您已经这样做了，我认为可能需要进一步澄清的是，如果您正确使用命名空间，您绝对不必担心库类名的冲突。您可能会在短时间内发现您需要在多个模块中拥有具有相同代码的类，但是一旦发生这种情况，您应该考虑除了我上面提到的 Zend 之外的通用库。

我再次为这个回复的长度道歉。我希望它可以帮助任何可能遇到这篇文章需要在模块中实现库的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T12:11:53.827

您可以只使用模块的 Boostrap.php。提供一个函数

```
protected function _initAutoload(){} 
```

使库可用。因此，您可以让模块开发人员去做，因为它是开发模块以使其资源可加载的工作的一部分:)

# sql - SUM 干扰 COUNT

> ID：13377988
> 
> 赞同：2
> 
> 时间：2012-11-14T11:30:23.250
> 
> 标签：sql, sql-server-2008-r2

使用这个查询，我得到了我需要的每个客户下了多少订单的结果。但是，当我在 SELECT 字段中使用 SUM(OrderLine.ActualPrice) 并使用内部联接将 Order 表链接到包含价格的 OrderLine 表时。COUNT 结果有偏差，因为 OrderLine 表包含同一个 Order 的多个 OrderNo，因为一个订单可以包含多个产品。

如何将 COUNT 保留为我使用此查询获得的结果，同时输入他们订单的总购买量的 SUM 查询？

```
SELECT C.custno, 
       companyname, 
       Count(customerorder.orderno)AS 'Total Orders', 
FROM   customer C 
       INNER JOIN customerorder 
               ON customerorder.custno = C.custno 
GROUP  BY C.custno, 
          companyname 
```

修改后的查询结果不正确

```
SELECT C.custno, 
       companyname, 
       Count(customerorder.orderno)AS 'Total Orders', 
       Sum(orderline.actualprice) 
FROM   customer C 
       INNER JOIN customerorder 
               ON customerorder.custno = C.custno 
       INNER JOIN orderline 
               ON customerorder.orderno = orderline.orderno 
GROUP  BY C.custno, 
          companyname 
```

这是我尝试使用并收到倾斜的 COUNT 结果的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T11:35:29.747

你有两个基本的选择。

**使用 DISTINCT**

```
SELECT C.custno, 
       companyname, 
       Count(DISTINCT customerorder.orderno)AS 'Total Orders', 
       Sum(orderline.actualprice) 
FROM   customer C 
       INNER JOIN customerorder 
               ON customerorder.custno = C.custno 
       INNER JOIN orderline 
               ON customerorder.orderno = orderline.orderno 
GROUP  BY C.custno, 
          companyname 
```

*笔记：*

在对另一个问题的评论中，您说这仍然是结果。这似乎意味着相同的`orderno`内容可以出现在不止一个`customerorder`记录中。那是对的吗？

**使用子查询使连接 1:1 而不是 1:many**

```
SELECT C.custno, 
       companyname, 
       Count(customerorder.orderno)AS 'Total Orders', 
       Sum(orderline.actualprice) 
FROM   customer C 
       INNER JOIN customerorder 
               ON customerorder.custno = C.custno 
       INNER JOIN (SELECT orderno, SUM(actualprice) AS actualprice
                     FROM orderline 
                 GROUP BY orderno)
               ON customerorder.orderno = orderline.orderno 
GROUP  BY C.custno, 
          companyname 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:33:37.737

尝试这个

```
SELECT C.custno, 
       companyname, 
       Count(Distinct customerorder.orderno)AS 'Total Orders', 
       Sum(orderline.actualprice) 
FROM   customer C 
       INNER JOIN customerorder 
               ON customerorder.custno = C.custno 
       INNER JOIN orderline 
               ON customerorder.orderno = orderline.orderno 
GROUP  BY C.custno, 
          companyname 
```

对 DISTINCT 订单号使用计数

# node.js - 从 STOMP/AMQP 中选择哪一个？

> ID：13377992
> 
> 赞同：11
> 
> 时间：2012-11-14T11:30:37.963
> 
> 标签：node.js, jms, amqp, stomp

我使用 node.js 作为 jms 主题的客户端。有两种协议可用于在主题上建立连接。论文是 Stomp 和 AMQP。我在[http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol](http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) 和[http://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol](http://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol)阅读了关于它们的简要介绍。两者似乎都是线路级协议，即作为八位字节流通过网络发送的数据。我没有找到任何应​​该首选的具体原因。如果有人可以阐明它，那将很有帮助。

另一点是协议都以声明它们是可互操作的为荣。互操作性术语是否意味着如果有人想取消特定的消息代理实现说 apache active MQ 而想要插入 Websphere MQ ，转换将是平滑的（前提是同时支持 AMQP/STOMP 或任何其他有线 levl 协议）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-17T18:06:17.963

您可能会看到性能上的差异（请参阅[此基准测试](https://blog.x-aeon.com/2013/04/10/a-quick-message-queue-benchmark-activemq-rabbitmq-hornetq-qpid-apollo/)基于许多因素，包括消息大小和队列条目的持久性要求。

通常情况下，还有其他因素需要考虑，特别是如果您的消息大小/计数/等。并不意味着在性能方面有明显的赢家，也没有一种协议能以另一种方式满足您的功能要求。

[本文](https://web.archive.org/web/20160322044219/http://blogs.vmware.com/vfabric/2013/02/choosing-your-messaging-protocol-amqp-mqtt-or-stomp.html)特别提示在不同的 STOMP 代理实现中可能存在更多碎片。引用那篇文章

> STOMP ...使用带有“目标”字符串的 SEND 语义。代理必须映射到它内部理解的东西，例如主题、队列或交换。然后消费者订阅这些目的地。由于规范中没有强制要求这些目的地，因此不同的代理可能支持不同风格的目的地。因此，在代理之间移植代码并不总是那么简单。

至少对于 AMQP（它吹捧互操作性是其最重要的优势之一），您在切换提供者/语言时应该遇到的唯一问题是设置所述新提供者时固有的问题。例如，我读过 ZeroMQ 可能比 RabbitMQ 承担更多的配置工作，但这并不是因为 AMQP 特有的任何属性。

# ios - 我们可以在 ios 中使用 nsdata 创建电影播放器 吗？

> ID：13377996
> 
> 赞同：3
> 
> 时间：2012-11-14T11:30:57.540
> 
> 标签：ios, video, nsdata, mpmovieplayer

我知道我们可以使用创建电影播放器`initWithContentURL:`​​，并且可以传递 NSUrl 参数。这里我没有 NSUrl，我只有 NSData。通过使用它可以创建电影播放器​​吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-14T12:25:25.167

没有可用于使用数据初始化 Movieplayer 的方法。

**我的建议：**您需要将数据作为视频文件写入文档目录，然后使用该 url 初始化播放器。

### 目标 C

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *appFile = [documentsDirectory stringByAppendingPathComponent:@"MyFile.m4v"];
[data writeToFile:appFile atomically:YES]; 
```

这`data`是`NSData`视频文件的。

您现在可以使用该`appFile`变量来初始化您的电影播放器​​。

```
NSURL *movieUrl = [NSURL fileURLWithPath:appFile];
MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController] alloc] initWithContentURL:movieUrl]; 
```

### 迅速

保存文件：

```
let paths = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true)
if let docDir = paths.first
{
    let appFile  = docDir.appending("/MyFile.m4v")
    let movieUrl = URL(fileURLWithPath: appFile)

    do
    {
        try data.write(to: movieUrl, options: .atomic)
    }
    catch let error as NSError
    {
        print(error.localizedDescription)
    }
} 
```

初始化电影播放器​​：

```
let moviePlayer = MPMoviePlayerController(contentURL: movieUrl) 
```

**注意：** [MPMoviePlayerController](https://developer.apple.com/documentation/mediaplayer/mpmovieplayercontroller)在**iOS 9**中已弃用，因此您可能需要使用[AVPlayerViewController](https://developer.apple.com/documentation/avkit/avplayerviewcontroller)

# mysql - 使用实体框架加入和联合

> ID：13377997
> 
> 赞同：1
> 
> 时间：2012-11-14T11:31:07.290
> 
> 标签：mysql, database, linq, entities

我有两张表（客户和电子邮件），一张包含客户数据，包括主要电子邮件地址，另一张包含附加电子邮件地址。

我需要从他们的多个电子邮件地址之一验证用户，无论它是在客户端还是电子邮件表上。我想出了这个运行良好的 SQL 语句：

```
set @email = 'client@domain.com';
select c1.credits > 0 as Allowed, c1.Email as MainEmail from 
customers c1 inner join (select ClientId,  Email FROM customers WHERE 
Email=@email union all select ClientId, Email FROM emails WHERE Email=@email) e1 
on c1.ClientId = e1.ClientId; 
```

如何使用基于方法的语法在 LINQ to Entities 中编写此查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T15:57:05.563

If i understand correctly,

Customer may or may not have the email (Additional) in `emails` table. Also, Customer have more than one additional emails entry in `emails` table. Like below

```
List<Customer> customers = new List<Customer> 
{ 
    new Customer { ClientId = 1, Email = "client1@domain.com", Credits = 2 },
    new Customer { ClientId = 2, Email = "client2@domain.com", Credits = 1 },
    new Customer { ClientId = 3, Email = "client3@domain.com", Credits = 1 },
};

List<Emails> emails = new List<Emails> 
{ 
    new Emails { ClientId = 1, Email = "client1-2@domain.com" },
    new Emails { ClientId = 1, Email = "client1-3@domain.com" },
    new Emails { ClientId = 2, Email = "client2-1@domain.com" },
}; 
```

In that case, Use the below query to get it done,

```
var result = from c in customers
             let _emails = emails.Where(e => c.ClientId == e.ClientId).Select(t => t.Email)
             where c.Email == "client3@domain.com" || _emails.Contains("client3@domain.com")
             select new
             {
                 Allowed = c.Credits > 0,
                 MainEmail = c.Email
             }; 
```

I hope it helps you.