# StackOverflow 问答 12625000-12625999

# java - 使用 Mockito 调用多个其他方法的方法的单元测试

> ID：12625002
> 
> 赞同：10
> 
> 时间：2012-09-27T15:34:51.557
> 
> 标签：java, unit-testing, mockito

也许我的搜索完全失败了，但是我找不到任何与如何为 Java 类/方法编写单元测试相关的文档或讨论，而 Java 类/方法又会调用其他非私有方法。看起来，Mockito 的立场是，如果必须使用间谍来测试需要模拟内部方法调用的方法，则设计可能存在问题（不是真正的 OO）。我不确定这是否总是正确的。但使用间谍似乎是实现这一目标的唯一方法。例如，为什么你不能有一个“包装器”风格的方法，它又依赖于其他方法来实现原始功能，但另外提供功能、错误处理、日志记录或依赖于其他方法的结果的不同分支等？

所以我的问题有两个：

1.  有一个内部调用其他方法的方法是设计和实现不佳的代码吗？
2.  如果一个人选择了 Mockito 作为他们的模拟框架，那么为这种方法编写单元测试的最佳实践和/或方法是什么（假设它本身是一个好主意）？

这可能是一个困难的要求，但我希望那些决定回答的人不仅仅是重新发布 Mockito 的措辞和/或对间谍的立场，因为我已经知道这种方法和意识形态。另外，我也使用过 Powermockito。对我来说，这里的问题是 Mockito 开发了这个框架，必须创建额外的解决方法来支持这个需求。所以我想我想要回答的问题是，如果间谍是“坏的”，并且 Powermockito 不可用，应该如何对调用其他非私有方法的方法进行单元测试？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T10:34:07.547

> 有一个内部调用其他方法的方法是设计和实现不佳的代码吗？

并不真地。但我想说，在这种情况下，调用其他方法的方法应该像其他尚未单独测试的方法一样进行测试。也就是说，它可以保护您免受公共方法在您没有注意到的情况下停止调用其他方法的情况。

是的，它（有时）会产生很多测试代码。我相信这就是重点：编写测试的痛苦是一个很好的线索，您可能需要考虑将这些子方法提取到一个单独的类中。

如果我能接受这些测试，那么我认为子方法还没有被提取出来。

> 如果一个人选择了 Mockito 作为他们的模拟框架，那么为这种方法编写单元测试的最佳实践和/或方法是什么（假设它本身是一个好主意）？

我会做这样的事情：

```
public class Blah {
    public int publicMethod() {
        return innerMethod();
    }

    int innerMethod() {
        return 0;
    }
}

public class BlahTest {
    @Test
    public void blah() throws Exception {
        Blah spy = spy(new Blah());
        doReturn(1).when(spy).innerMethod();

        assertThat(spy.publicMethod()).isEqualTo(1);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-22T23:23:46.773

对我来说，这个问题与凝聚力的概念密切相关。

我的回答是：

在一个类中拥有调用其他方法（私有）的方法（公共）是可以的，实际上这通常是我认为的好代码。然而，有一个警告，你的班级应该仍然具有很强的凝聚力。对我来说，这意味着你的班级的“状态”应该被很好地定义，你班级的方法（思考行为）应该以可预测的方式参与改变你的班级状态。

您要测试的情况是否如此？如果没有，您可能正在查看一门课程，而您应该查看两门（或更多）课程。

您要测试的类的状态变量是什么？

您可能会发现，在考虑了这些类型问题的答案之后，您的代码变得更容易以您认为应该的方式进行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T17:25:13.510

如果您确实需要（或想要）避免再次调用较低级别的方法，则可以将它们存根而不是模拟它们。例如，如果方法 A 调用 B 和 C，您可以这样做：

```
MyClass classUnderTest = new MyClass() {
    @Override
    public boolean B() {return true;}

    @Override
    public int C() {return 0;}
};
doOtherCommonSetUp(classUnderTest);
String result = classUnderTest.A("whatever");
assertEquals("whatIWant", result); 
```

我已经在遗留代码中使用了相当多的方法，在这些代码中，大量的重构很容易导致软件版本的造船者病：将难以测试的东西隔离成一个小方法，然后将其存根。

但是，如果被调用的方法相当无害并且不需要嘲笑，我只是让它们再次被调用，而不用担心我覆盖了它们中的每条路径。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-20T15:43:14.247

真正的问题应该是：

> **我真正想测试什么？**

实际上答案应该是：

> **我的对象响应外部变化的行为**

也就是说，根据与对象交互的方式，您希望在单个测试中测试每个可能的单个场景。这样，您可以确保您的班级根据您提供测试的场景的期望做出反应。

> **有一个内部调用其他方法的方法是设计和实现不佳的代码吗？**

不是真的，真的不是！这些从公共成员调用的所谓私有方法就是辅助方法。有辅助方法是完全正确的！

辅助方法可以帮助将一些更复杂的行为从类本身分解成更小的可重用代码。只有它知道它应该如何表现并通过你的类的公共成员相应地返回状态。

很少见带有辅助方法的类，通常它们必须采用类不应该从外部世界做出反应的内部行为。

> **如果一个人选择了 Mockito 作为他们的模拟框架，那么为这种方法编写单元测试的最佳实践和/或方法是什么（假设它本身是一个好主意）？**

以我的拙见，您不会测试这些方法。当公共成员通过公共成员调用时您期望的对象的状态进行测试时，它们会得到测试。例如，使用 MVP 模式，如果您想测试用户身份验证，则不应测试每个私有方法，因为私有方法可能会从依赖于被测对象的对象中调用其他公共方法等等。相反，测试你的观点：

```
@TestFixture
public class TestView {
    @Test
    public void test() {
        // arrange
        string expected = "Invalid login or password";
        string login = "SomeLogin";
        string password = "SomePassword";

        // act
        viewUnderTest.Connect(login, password);
        string actual = viewUnderTest.getErrorMessage;

        // assert
        assertEqual(expected, actual);
    }
} 
```

这个测试方法描述了一旦点击了connectButton，你的视图的预期行为。如果该`ErrorMessage`属性不包含预期值，这意味着您的视图或演示者的行为不符合预期。您可以检查演示者是否订阅了您的视图`Connect`事件，或者您的演示者是否设置了正确的错误消息等。

事实是，您永远不需要测试私有方法中发生的任何事情，因为您需要在调试时进行调整和更正，这反过来又会导致您同时测试内部方法的行为，但不应该使用特殊的测试方法专门为那些辅助方法编写的。

# c# - 添加和删 除具有附加参数的处理程序？

> ID：12625003
> 
> 赞同：3
> 
> 时间：2012-09-27T15:34:55.953
> 
> 标签：c#

当您添加和**删除**事件处理程序并希望有其他参数时，您如何执行此操作？下面的代码就像我想要的，但显然不起作用。

你会怎么做？- 我不能使用委托或 lambda 很麻烦，因为我还需要删除处理程序。

```
 private static void IsDefaultChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs args)
    {
        if ((bool)args.NewValue)
        {
            Window.Current.CoreWindow.KeyUp += CoreWindowOnKeyUp(dependencyObject);
        }
        else
        {
            Window.Current.CoreWindow.KeyUp -= CoreWindowOnKeyUp(dependencyObject);
        }

    }

    private static void CoreWindowOnKeyUp(CoreWindow sender, KeyEventArgs args, DependencyObject dependencyObject)
    {
        ((ICommand)dependencyObject.GetValue(Button.CommandProperty)).Execute(null);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:46:54.250

你可以做的是：

*   在方法中保留一些`DependencyObject`添加/删除的 s集合`IsDefaultChanged`。
*   修改您的`CoreWindowOnKeyUp`处理程序，使其仅接受预期的两个参数，并查询`DependencyObject`s 本身的集合。将此事件绑定一次，不要解除绑定。

即，不是让每个当前依赖对象的事件都具有处理程序，而是使用单个处理程序来查询当前依赖对象的集合的事件。

```
HashTable<DependencyObject> current = new HashTable<DependencyObject>();

// Bound as before
private static void IsDefaultChanged(
    DependencyObject dependencyObject,
    DependencyPropertyChangedEventArgs args)
{
    if ((bool)args.NewValue)
        current.Add(dependencyObject);
    else
        current.Remove(dependencyObject);
}

// Permanently bound, once.
private static void CoreWindowOnKeyUp(CoreWindow sender, KeyEventArgs args)
{
    foreach(var do in current)
    {
        ((ICommand)do.GetValue(Button.CommandProperty)).Execute(null);
    }
} 
```

或者，如果 Richard 的代码没有正确解除绑定 lambda，您可以保留 a`Dictionary<DependencyObject, EventHandler>`以便检索已绑定的*确切lambda 并相应地解除绑定。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:42:52.623

您可以使用[闭包](http://csharpindepth.com/articles/chapter5/closures.aspx)来关闭匿名委托中的dependencyObject，不确定语法是否正确，但类似。

```
private static void IsDefaultChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs args) 
{ 
    var func = (object sender,KeyEventArgs e) =>
    {
         ((ICommand)dependencyObject
             .GetValue(Button.CommandProperty)).Execute(null); 
    };
    if ((bool)args.NewValue) 
    { 
        Window.Current.CoreWindow.KeyUp += func; 
    } 
    else 
    { 
        Window.Current.CoreWindow.KeyUp -= func; 
    } 

} 
```

# android - 如何创建淡出的对话框或弹出窗口？

> ID：12625004
> 
> 赞同：0
> 
> 时间：2012-09-27T15:34:55.110
> 
> 标签：android, android-dialog, android-dialogfragment

我想创建一个弹出/对话框，它出现在我的屏幕左下角（我的活动），并且在一定时间后淡出，类似于 Toast，但它比 Toast 更复杂，因为它有它自己的布局（图像等）。任何人都知道 DialogFragment 或 PopupWindow 或任何其他类是否可行？如果是这样，哪个类可能最适合这种要求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:46:15.733

您可以使用自定义视图创建 Toast：http: [//developer.android.com/guide/topics/ui/notifiers/toasts.html](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)

# iphone - 如何在我的表格视图中加载 20 x 20 的事件记录，其中事件按日期排序并将标题标题显示为事件日期

> ID：12625014
> 
> 赞同：0
> 
> 时间：2012-09-27T15:35:42.863
> 
> 标签：iphone, ios, uitableview

在我的应用程序中，我正在加载带有事件的表（来自服务器），我在其中按日期对它们进行排序，并在标题标题作为事件日期的部分中显示。现在我的要求是（因为有很多记录）加载 20 x 20 记录，并且它们必须按部分排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T09:17:51.477

我假设您正在使用 Rest Web 服务加载数据。在服务器上的某个地方，您需要有一条 SQL 语句来加载事件

```
SELECT * from events order by date ASC LIMIT page,20 
```

其中 page 是您正在加载的页数。您的 iPhone 应用程序将从： 1- int page = 0;

2- 创建一个 NSMutableDictionary 来存储页面检索到的所有事件。

3- 使用 post 方法和页面参数（page = 0）向 REST 资源发送请求。

4- 我们肯定会获得 20 个（或更少）事件。

5- 对于每个新的事件数据，创建一个 NSMutableArray 并将其存储在我们的可变字典中，键为事件日期。

6- 每当向字典添加新事件时，检查字典是否有带有此事件日期的键，如果是，则使用该键将事件添加到可变数组中，否则创建新的可变数组并将事件添加到其中，然后将其添加到带有事件日期的字典。

7-显示带有标题的表格视图键，节数：

```
[[eventDictionary allKeys] count];

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
        //fetch the event for this cell;
        NSString *sectionKey = [[eventDictionary allKeys] objectAtIndex:indexPath.section];
        NSMutableArray *thisSectionEvents =  [eventDictionary objectForKey: sectionKey];
        Event *event = [thisSectionEvents objectAtIndex.row];

        //Create your customcell here and pass data to it.
} 
```

8-加载下一页：

8 页++

8-b 使用新页面值发送请求

8-c 将新事件添加到已包含 20 个第一个事件的 Mutable 字典中；

8-d 在表视图上重新加载数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T19:39:11.807

你在使用核心数据吗？如果是这样，那么您可以将所有记录保存在那里，然后使用 NSFetchRequest 以 20 个记录增量提取数据。您还需要携带一个变量来跟踪从数据库中加载了多少记录。

# facebook - Facebook Scrumptious 示例应用程序无法构建

> ID：12625020
> 
> 赞同：0
> 
> 时间：2012-09-27T15:36:02.690
> 
> 标签：facebook, xcode4

我做了他们在视频中所做的事情。但是，当我使用美味的应用程序并尝试构建/运行它时，我的失败了。它说：“解析问题。需要一个类型。”

以下是它认为损坏的三行（位于 ACAccountStore.h 中）：

```
 // Returns the account type object matching the account type identifier. See
    // ACAccountType.h for well known account type identifiers
    - (ACAccountType *)accountTypeWithAccountTypeIdentifier:(NSString
    *)typeIdentifier;

    // Returns the accounts matching a given account type.
    - (NSArray *)accountsWithAccountType:(ACAccountType *)accountType;

// this method is called on an arbitrary queue.
- (void)requestAccessToAccountsWithType:(ACAccountType *)accountType 
                  withCompletionHandler:(ACAccountStoreRequestAccessCompletionHandler)handler; 
```

这是教程的链接。在我撞到这堵墙之前，我什至没有做到两分钟。 [http://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/](http://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)

我正在运行 Xcode v4.4.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:13:38.767

从该教程的第 1 步开始：

*安装先决条件*

您需要**Xcode 4.5**和可选的 Git

尝试升级 XCode 并查看它是否使用推荐的版本构建。

# joomla - Joomla 更改活动菜单

> ID：12625025
> 
> 赞同：1
> 
> 时间：2012-09-27T15:36:15.750
> 
> 标签：joomla, menu, components

如何使用代码更改菜单？

我发现：

```
$currentMenuId = JSite::getMenu()->getActive()->id ; 
```

返回当前活动的菜单项

然而，

```
$menu->setActive( $menuitemid ); 
```

什么都不做，

无论我使用，

```
$app = JFactory::getApplication(); $menu = $app->getMenu();
$menu->setActive( $menuitemid ); 
```

或者，

```
$menu = JSite::getMenu(); $menu->setActive( $menuitemid ); 
```

如何更改菜单？

# jquery - 如何在 asp.net 中使用 jquery ajax 方法在文本框更改上显示成功消息？

> ID：12625028
> 
> 赞同：1
> 
> 时间：2012-09-27T15:36:20.840
> 
> 标签：jquery, asp.net, ajax

我有一个 EmployeeMaster 页面，我在其中输入 empcode、empname 等。输入 empcode 后，当我单击 empname 文本框时，如果不存在这样的 empcode，我想显示成功图像，如果存在 empcode，则显示失败图像。

有没有办法使用 jquery ajax 方法来显示这个？

下面是我如何尝试调用文本框更改功能。

```
 $(document).ready(function(){
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    //Raised before processing of an asynchronous postback starts and the postback request is sent to the server.
    prm.add_beginRequest(BeginRequestHandler);
    // Raised after an asynchronous postback is finished and control has been returned to the browser.
    prm.add_endRequest(EndRequestHandler);    
    AutoComp();//function for autofill textbox and it works perfectly.     
    $("#<%=txtEmpCode.ClientID %>").change(checkEmpCode);//calling textbox change  function

});
function checkEmpCode() {
    alert('hai');
} 
```

这里没有显示警报。我该如何解决这个问题....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T18:28:44.603

这是您调用 Web 服务的 javascript，它检查 empcode 是否重复，如果重复，该方法将返回 0

```
<script type="text/javascript"> 
  $(function() {
    $("#empcode").change(checkEmpCode);
  });

  function checkEmpCode() {
    $.ajax({
      type: "POST",
      url: "Service.asmx/CheckEmpCode",
      data: "{empcode: '" + $('#empcode').val() + "'}",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function(response) {            
        if (response.d != "0") {
          $("#failureimage").show();
        }
        else{
          $("#successimage").show();
        }

      }
    });
  }

</script> 
```

您的网络服务将具有此方法

```
[WebMethod]
public int CheckEmpCode(string empcode)
{
  string connect = @"Server=SERVER;Database=Database;Trusted_Connection=True;";
  string query = "SELECT COUNT(*) FROM Employee WHERE empcode = @empcode";
  using(SqlConnection conn = new SqlConnection(connect))
  {
    using(SqlCommand cmd = new SqlCommand(query, conn))
    {
      cmd.Parameters.AddWithValue("empcode", empcode);
      conn.Open();
      return (int)cmd.ExecuteScalar();
    }
  }
} 
```

# java - 嵌套迭代列表，然后最终删除

> ID：12625038
> 
> 赞同：4
> 
> 时间：2012-09-27T15:37:06.477
> 
> 标签：java, oop, loops, iterator

我正在尝试遍历一个列表，同时已经遍历它（嵌套循环）。考虑下面的代码：

```
ArrayList<Integer> list = new ArrayList<Integer>(); // add some values to it

for(int i : list) { // ConcurrentModificationException

   Iterator iterator = list.iterator();

   while(iterator.hasNext()) {

      int n = iterator.next();

      if(n % i == 0) {
         iterator.remove();
      }

   }

} 
```

上面的示例导致 ConcurrentModificationException。当然，移除元素的条件只是一个例子。

我确定我只是错过了一些东西；但是**我应该如何构造一个在 Java 中实现相同目标**而不抛出异常的循环呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T15:48:08.220

显然`list`，当您迭代它时进行修改会导致执行。您可以使用另一个列表来维护要删除的元素列表并在最后删除它们。

```
ArrayList<Integer> list = new ArrayList<Integer>(); // add some values to it
ArrayList<Integer> del = new ArrayList<Integer>(); // Elements to be deleted

for(int i : list) { // ConcurrentModificationException
   Iterator iterator = list.iterator();
   while(iterator.hasNext()) {    
      int n = iterator.next();
      if(n % i == 0) {
          del.add(n);      
      }
   }
}

list.removeALL(del); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:08:01.007

使外部迭代迭代列表的副本。

```
for (int i : new ArrayList<>(list)) {

  Iterator<Integer> iterator = list.iterator();

  while (iterator.hasNext()) {

    int n = iterator.next();

    if (n % i == 0) {
      iterator.remove();
    }

  }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T15:42:22.240

你得到了`ConcurrentModificationException`因为，在做`for`循环时，你试图修改`list`.

我不确定以下是否是优雅的解决方案，但如下所示可能有效：

```
 Iterator<Integer> iterator = list.iterator();
            int i=1;
            while (iterator.hasNext()) {

                int n = iterator.next();

                if (n % i == 0) {
                    iterator.remove();
                }
                i++;
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T15:41:58.750

您不能从正在迭代的列表中删除项目。一种选择是将您需要的项目添加到另一个列表中。最后，您列出了您需要的项目。或者您可以迭代原始列表的克隆。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T15:45:33.720

我做了一些和你很相似的事情。看看这段代码。

```
out:for(int h=0; h<tempAl.size(); h++) {
                        if(tempAl.get(0).split("\\s")[0].equals("OFF")){
                            tempAl.remove(0);
                            h=-1;
                            continue;
                        }
                        if(tempAl.get(h).split("\\s")[0].equals("ON")){
                            ONTime= tempAl.get(h);
               ///rest fof the code
    } 
```

我认为您也可以在从数组列表中删除元素后更改索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T15:52:55.603

我没有尝试过，但要么使用：

```
List<Integer> list = new ArrayList<Integer>(); 
// add some values to it  
for(Iterator<Integer> iterator1 = list.iterator(); iterator1.hasNext();) { 
    int i = iterator1.next();
    for(Iterator<Integer> iterator2 = list.iterator(); iterator2.hasNext();){
        int n = iterator.next();        
        if(n % i == 0) {          
            iterator2.remove();       
        }     
    }  
} 
```

或者如果这仍然抛出 ConcurrentModificationException （我不确定如果您使用由同一列表支持的 2 个迭代器会发生什么），则使用：

```
List<Integer> list = new ArrayList<Integer>(); 
// add some values to it  
for(int i : new ArrayList(list)){ // copy list 
    ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T15:54:56.353

`foreach`java 语法隐藏了一个迭代器，但隐藏它，不可能`remove`在这个上调用方法。

所以我会这样做：

```
ArrayList<Integer> list = new ArrayList<Integer>(); // add some values to it

int count = 0;
for(Iterator<Integer> it = list.iterator();it.hasNext();count++){ //increments count++
   Integer currentInt = it.next();
   if(currentInt % count == 0){
     it.remove();
   }
} 
```

您可以看到无需辅助迭代器即可实现相同的功能。

您不能同时遍历同一个列表。总而言之，`modcount`每次列表并行更改或迭代时，变量用于检测自身的意外变化。从而导致`ConcurrentModificationException`. 它经常出现在多线程环境中，开发人员必须意识到这一点。

此外，更喜欢使用`for`循环而不是`while`循环来迭代集合。

为什么 ？

因为使用这种`while`方式，您让迭代器对象在循环之后仍然在范围内，而使用`for`，它不会。一个简单的 ackward 调用`it.next()`会以`NoSuchElementException`.

这是保持的最佳做法；）

# c# - c#中的Web进度条

> ID：12625040
> 
> 赞同：3
> 
> 时间：2012-09-27T15:37:09.747
> 
> 标签：c#, asp.net, multithreading, c#-2.0

我正在寻找一种使用带有 c# 的 webforms 在 web 中显示“进度条”的方法。

我做了一个简单的例子，我只想要一个标签显示 1%、2%、3% 等关于将在服务器中运行的后台进程。当它完成更新，比如显示警报之类的东西时，真正的需要比这要复杂一些，但我认为我可以自己做。我在代码中遇到的问题是我总是得到 0.. 在我的“进度条”中它没有得到更新，我遗漏了一些东西，但我不知道它是什么。

**编辑**

我试图每秒提醒该值以查看该值而不是标签，但它无论如何都不起作用。

我错过了`OnClientClick="javascript:GetProgress();"`第一个问题，我更新了它，它仍然无法正常工作

**编辑 2**

HttpConext.Current 在将其作为线程调用时为空。我应该使用比会话或应用程序更多的东西，也许是单调类？

任何帮助将非常感激。

* * *

**来自 ASPX 和 JS 的重要信息**

```
 <div style="width: 800px" class="css_container">
        <cc1:ToolkitScriptManager ID="sm" runat="server" EnableScriptGlobalization="true"
            EnableScriptLocalization="true" AsyncPostBackTimeout="60000" EnablePageMethods="true">
        </cc1:ToolkitScriptManager>
        <asp:UpdatePanel ID="upPanel" runat="server">
            <ContentTemplate>
               <asp:Button ID="btn" runat="server"  Text="Do Something"
                                    CausesValidation="False" OnClick="btn_Click" OnClientClick="javascript:GetProgress();" />
            </ContentTemplate>
        </asp:UpdatePanel>
  </div> 
```

* * *

```
 function GetProgress() {
       PageMethods.GetProcessed(function(result) {
                alert(result);
                if (result < 100) {
                    setTimeout(function(){GetProgress();}, 1000);
                }                  
            });

    } 
```

* * *

**代码背后的重要事情**

```
[WebMethod(EnableSession=true), ScriptMethod]
    public  static string GetProcessed()
    {
        return HttpContext.Current.Session["processed"].ToString();
    }

protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
             Session["processed"] = 0;
        }
    }

protected void btn_Click(object sender, EventArgs e)
    {
       AClass oClass = new AClass();
        Thread oThread = new Thread(delegate()
            {
                oClass.UpdateSession();
            });
           oThread.Start();
    } 
```

* * *

**来自 Aclass 的重要事项**

```
public class AClass
{ 
    public void UpdateSession()
    {
          for(int i = 0; i< 100; i++)
          {

            HttpContext.Current.Session["processed"] =  i;
            System.Threading.Thread.Sleep(1000);
          }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:52:34.533

我认为这里可能发生了一些事情：

1.  您的线程可能会在响应结束时终止。我认为您可以通过更改定义线程的方式来解决此问题：

    ```
    Thread oThread = new Thread(new ThreadStart(oClass.UpdateSession));
    oThread.IsBackground = true; // Set this
    oThread.Start(); 
    ```

2.  您将字符串百分比返回给回调函数，然后将其与数字进行比较。这不是一个真正的问题，但为了良好的编程，您应该更改您的服务器端`GetProcessed()`以返回一个实际的整数：

    ```
    public static int GetProcessed()
    {
        int result = 0;
        int.TryParse(HttpContext.Current.Session["processed"].ToString()), out result);
        return result;
    } 
    ```

3.  UpdatePanel 请求在后台启动整个页面生命周期。您能否验证此代码不会在您的 GetProcessed() Web 方法的每个滴答声中都重置您的进度？

    ```
    if (!IsPostBack)
    {
         Session["processed"] = 0;
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:59:40.967

问题是您调用的`Session`不是正在更新值的那个。所以，你有几个选择。

`Application`首先，如果您的应用程序仅由一个用户使用（不太可能，但我对应用程序一无所知），您可以将其设为变量。

其次，您可以使用某种相关键，以便您可以从`Application`键控变量中获取值。

在按钮单击中进行更改：

```
protected void btn_Click(object sender, EventArgs e) 
{
    // NEW CODE
    // set the hidden field value here with a correlation key
    var correlationKey = Guid.NewGuid().ToString();
    this.correlationKey.Value = correlationKey;

    AClass oClass = new AClass(); 
    Thread oThread = new Thread(delegate() 
        { 
            oClass.UpdateSession(correlationKey); 
        }); 
    oThread.Start(); 
} 
```

现在像这样修改 JavaScript：

```
function GetProgress() {
    PageMethods.GetProcessed(document.getElementById("correlationKey").value,
        function(result) {
            alert(result);
            if (result < 100) {
                setTimeout(function(){GetProgress();}, 1000);
            }   
        });   
} 
```

现在修改`GetProcessed`方法如下：

```
[WebMethod(EnableSession=true), ScriptMethod]
public  static string GetProcessed(string correlationKey)
{
    var dictionary = Application["ProcessedQueue"] as Dictionary<string, int>;
    if (dictionary == null || !dictionary.ContainsKey(correlationKey)) { return "0"; }
    return dictionary[correlationKey].ToString();
} 
```

现在修改`UpdateSession`方法如下：

```
public void UpdateSession(string correlationKey)
{
    var dictionary = Application["ProcessedQueue"] as Dictionary<string, int>;
    if (dictionary == null)
    {
        dictionary = new Dictionary<string, int>();
        Application["ProcessedQueue"] = dictionary;
    }

    if (!dictionary.ContainsKey(correlationKey)) { dictionary.Add(correlationKey, 0); }

    for (int i = 0; i< 100; i++)
    {
        dictionary[correlationKey] =  i;
        System.Threading.Thread.Sleep(1000);
    }
} 
```

现在清理`Page_Load`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T17:30:25.753

我使用了@Mike 的想法.. 并对其进行了一些更改，因为 HttpContext.Current 为空...并将其替换为静态对象。这对我来说很好，也做了一些并发测试并且工作正常..

```
<div style="width: 800px" class="css_container">
        <cc1:ToolkitScriptManager ID="sm" runat="server" EnableScriptGlobalization="true"
            EnableScriptLocalization="true" AsyncPostBackTimeout="60000" EnablePageMethods="true">
        </cc1:ToolkitScriptManager>
        <asp:UpdatePanel ID="upPanel" runat="server">
            <ContentTemplate>
               <asp:HiddenField ID="correlationKey" runat="server" />
               <asp:Button ID="btn" runat="server"  Text="Do Something"
                                    CausesValidation="False" OnClick="btn_Click" OnClientClick="javascript:GetProgress();" />
            </ContentTemplate>
        </asp:UpdatePanel>
  </div> 
```

* * *

```
function GetProgress() {
    PageMethods.GetProcessed(document.getElementById("correlationKey").value,
        function(result) {
            alert(result);
            if (result < 100) {
                setTimeout(function(){GetProgress();}, 1000);
            }   
        });   
} 
```

* * *

```
protected void btn_Click(object sender, EventArgs e) 
{
    // NEW CODE
    // set the hidden field value here with a correlation key
    var correlationKey = Guid.NewGuid().ToString();
    this.correlationKey.Value = correlationKey;

    AClass oClass = new AClass(); 
    Thread oThread = new Thread(delegate() 
        { 
            oClass.UpdateSession(correlationKey); 
        }); 
    oThread.Start(); 
} 
```

* * *

```
public class AClass
{
    public static Dictionary<string, int> ProcessedQueue { get; set; }

    public void UpdateSession(string correlationKey)
    {
        var dictionary = ProcessedQueue; // HttpContext.Current.Application["ProcessedQueue"] as Dictionary<string, int>;
        if (dictionary == null)
        {
           dictionary = new Dictionary<string, int>();
           ProcessedQueue = dictionary;// HttpContext.Current.Application["ProcessedQueue"] = dictionary;
        }

        if (!dictionary.ContainsKey(correlationKey)) { dictionary.Add(correlationKey, 0); }

        for (int i = 0; i < 100; i++)
        {
             dictionary[correlationKey] = i;
         System.Threading.Thread.Sleep(1000);
        }
    }
} 
```

* * *

```
[WebMethod(EnableSession = true), ScriptMethod]
public static string GetProcessed(string correlationKey)
{
     var dictionary = AClass.ProcessedQueue; //     HttpContext.Current.Application["ProcessedQueue"] as Dictionary<string, int>;
     if (dictionary == null || !dictionary.ContainsKey(correlationKey)) { return "0"; }
     return dictionary[correlationKey].ToString();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T15:43:47.230

也许我错过了一些东西，但是您的 javascript（至少您在问题中提出的内容）没有更新页面上的任何内容。你说你的进度条一直都是0，这可能是因为你注释掉了改变显示的行。

`//document.getElementById("divProgress").innerHTML = result + "%";`

显示的值是否`alert`正确？另外，您是否确认它`UpdateSession()`运行正确并实际在会话中设置了一个值？

# java - 如何在 Android 中从枚举的 ToString 访问资源字符串？

> ID：12625041
> 
> 赞同：20
> 
> 时间：2012-09-27T15:37:11.920
> 
> 标签：java, android

在我的应用程序中，我有一个从枚举中填充的 Spinner：

```
ArrayAdapter<myEnum> enumAdapter = new ArrayAdapter<Stroke> (parentActivity.getApplicationContext(), R.layout.simple_spinner_item, myEnum.values());
enumAdapter.setDropDownViewResource(R.layout.simple_spinner_dropdown_item);
enumSpinner.setAdapter(strokeAdapter); 
```

这使用枚举`toString()`方法的覆盖来获取枚举值的友好名称以显示在`Spinner`. 目前我的枚举为友好名称硬编码了字符串，但我想将这些字符串移动`strings.xml`到支持本地化。

但是， toString 无权访问 a`Context`所以我不确定如何解析资源 ID。

有没有办法在枚举的 toString() 方法中获取本地化字符串？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-27T18:05:07.667

如果我理解正确，这里真正的问题是如何`Context`从您的中获取 a `enum`，以便您可以调用`Context.getString()`以获取所需字符串的本地化版本。

`Context`一种方法是在应用程序的方法中设置类型的静态成员变量`onCreate()`，这在[此答案](https://stackoverflow.com/a/4410349/248994)中进行了描述。这里的想法是，每次创建或重新创建您的应用程序时，您都将在一个易于获取的变量中保留应用程序上下文。

然后，在枚举值的构造函数中传入资源 ID，并在`toString()`方法中使用 Context。

例如：

```
public enum Example {
    HELLO(R.string.hello),
    WORLD(R.string.world);

    private int mResourceId;

    private Example(int id) {
        mResourceId = id;
    }

    @Override
    public String toString() {
        return App.getContext().getString(mResourceId);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-25T16:34:06.307

> @Override public String toString() { return App.getContext().getString(id); }

重要的是，您的枚举类与您的活动没有任何联系，因为如果您想在另一个应用程序中使用，那么您将无法引用静态上下文。

因此，更好的方法是将字符串的资源 id 返回给活动，然后让活动使用他们的 id 获取字符串。

因此，从您的枚举类中，您将有一个类似于以下内容的方法：

```
 public  int getResourceId()
  {
    return resourceId;
  } 
```

然后在您的活动中，我将建立一个包含数组列表的列表：

```
final List<String> enumList = new ArrayList<String>();
for ( final MyEnum status : MyEnum.values() )
{
  enumList.add( getString( status.getResourceId() ) );
} 
```

然后你可以使用 enumList 和你的 ArrayAdapter，Bingo :)

因此，现在您与 enum 类没有任何联系，因此，如果您构建另一个需要使用相同 enum 类的应用程序，您可以轻松地做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-28T08:22:58.713

使用静态应用程序总是一个不好的做法，因为它不仅破坏了 Instant Run，而且这也违背了解耦原则，从而使得模块化难以实现。更不用说Android实际上在一个进程中支持多个应用程序。

出于这个原因，我建议为枚举定义一个内部类作为您的适配器条目。

```
enum Example {
    A(R.string.label_a),
    B(R.string.label_b);

    Example(@StringRes int label) { mLabel = label; }
    private @StringRes int mLabel;

    class Entry {
        private final Context mContext;
        Entry(final Context context) { mContext = context; }
        @Override public String toString() { return mContext.getString(mLabel); }
    }
} 
```

然后，为适配器构建一个 Example.Entry 数组。

```
Arrays.stream(Example.values()).map(item -> item.new Entry(context)).toArray(Example.Entry[]::new) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T17:54:05.390

我不是 100% 确定我明白你在问什么。

> 有没有办法在枚举的 toString() 方法中获取本地化字符串？

你当然可以在你`@Override`的`toString()`方法里面`myEnum`改变它的显示方式：

```
public enum myEnum {
    ONE("1"),
    TWO("2");
    private String pretty;
    private myEnum(String pretty) {
        this.pretty = pretty;
    }
    @Override
    public String toString() {
        // you can localise this string somehow here
        return pretty;
    }
} 
```

# java - 让 Jsoup 支持 JavaScript 动态生成的 html

> ID：12625043
> 
> 赞同：5
> 
> 时间：2012-09-27T15:37:15.330
> 
> 标签：java, javascript, html, jsoup, htmlunit

现在我正在开发一个网络爬虫。这个应该解析一些特定的站点并给我一个 xml 文件的输出。到目前为止，这没有问题。Crawler 可以工作，您可以通过 cfg 文件快速自定义它。我使用 Jsoup 来解析 HTML 内容。

我刚刚添加了几个站点，并注意到通过 JavaScript 创建的 HTML 内容存在巨大问题。没有办法让 Jsoup 支持 Javascript 吗？或者至少获得我可以在浏览器中看到的完整 HTML 内容。

我已经尝试过 HtmlUnit，但是这个做得不好。它没有给我在浏览器中获得的内容。

真诚的，

奥戈福

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T00:08:49.073

Jsoup 不支持 javascript，也不模拟浏览器。如果您打算执行 Javascript，请忘记它。根据我的经验，HtmlUnit 是一个无头浏览器，它给了我最好的结果（总是谈论 Java 框架）。

在 HtmlUnit 中值得尝试的一件事是在创建实例时更改`BrowserVersion`（Chrome / InternetEplorer / FireFox） 。`WebClient`一些站点以不同的方式做出反应，*有时*只是更改该值*可能*会给您带来预期的结果。

# php - 用 PHP 提取部分 url 字符串

> ID：12625044
> 
> 赞同：0
> 
> 时间：2012-09-27T15:37:20.080
> 
> 标签：php, parsing, url

我在字符串中有以下 URL：

```
$url = 'http://local/aspx/abdl.aspx?W=192796142&ID=Mini+Buggy+1'; 
```

我想解析“W”参数。

在这个例子中，我想返回：192796142

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:47:16.123

使用`parse_url`和`parse_str`。

```
$url = 'http://local/aspx/abdl.aspx?W=192796142&ID=Mini+Buggy+1';

parse_str(parse_url($url, PHP_URL_QUERY), $params);

echo $params['W']; //192796142 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:38:05.173

使用 PHP`parse_url`函数。

[http://php.net/manual/en/function.parse-url.php](http://php.net/manual/en/function.parse-url.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T05:57:09.830

当您正在寻找一个简单的单线时，您可以使用[parse_str](http://ch2.php.net/parse_str)和[parse_url](http://ch2.php.net/parse_url)：

```
parse_str(parse_url($url, PHP_URL_QUERY), $out);
echo $out['W']; 
```

# android - SQL查询为不同的客户从同一个表中求和不同的值[for android]

> ID：12625047
> 
> 赞同：-1
> 
> 时间：2012-09-27T15:37:34.677
> 
> 标签：android, sqlite

有人可以帮我吗：我有 5 个表的数据库：[数据库图](https://i.stack.imgur.com/DukRh.jpg)stat_list 表预先填充了 5 个值（Att、pass、TD、inter、pass）。我想在 android 中创建一个表，它将显示每个玩家表 Stat_list 中所有值的总和。非常感谢！

![表格示例](../Images/0a484e8124f54d63b21806455529855b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:38:54.070

```
 String sQry = "SELECT * FROM Stat_list;";
    SQLiteDatabase db = null;
    int count = -1;
    Cursor cursor = null;
    try {
        db = SQLiteOpenHelper.getReadableDatabase();
        cursor = db.rawQuery(sQry, null);
        if (cursor.moveToFirst()) {
            do {
                int playerScore = Integer.parseInt(cursor.getString(1)) +
                                  Integer.parseInt(cursor.getString(2)) +
                                  Integer.parseInt(cursor.getString(3)) +
                                  Integer.parseInt(cursor.getString(4))
                 ContentValues playerScores = new ContentValues();

                 playerScores.put(THE_NAME_OF_THE_SCORE_COLUMN, playerScore);
                 try{
                     db.update(NAME_OF_TABLE_WITH_SUMMED_PLAYER_SCORES,playerScores, "PlayerName = " cursor.getString(1), null);
                    }catch(SQLiteException e){}
                 } 
                 while (cursor.moveToNext());
        }           
    }
    catch (SQLiteException e) {
        Log.d("SQL Error", e.getMessage());
    }
    finally { 
        cursor.close();
        db.close(); 
    } 
```

上面的代码片段从数据库中提取信息，总结分数并将其插入另一个表中。不过，您必须输入特定的值，例如正确的列名和表名。

# python - 如何格式化 x 轴，以便我可以使用 matplotlib 跳过值

> ID：12625048
> 
> 赞同：0
> 
> 时间：2012-09-27T15:37:37.467
> 
> 标签：python, matplotlib

我想格式化我的 xticks，这样就没有我目前在下图中的任何间隙。我只想在我的数据中拥有 xaxis 中的点。

我的 x 轴点在下面，这就是我想要的，并且：

```
[128, 132, 136, 140, 149, 153, 157, 161, 36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124] 
```

如何定义我的格式化程序？

![情节1](../Images/6169c90009d13b2eb728e11b48d030e3.png)

# python - nginx+uwsgi+django，uwsgi中好像有一些奇怪的缓存，帮帮我

> ID：12625050
> 
> 赞同：4
> 
> 时间：2012-09-27T15:37:48.637
> 
> 标签：python, django, nginx, uwsgi

这是 uwsgi 配置：

```
[uwsgi]  
uid = 500
listen=200
master = true  
profiler = true 
processes = 8 
logdate = true  
socket = 127.0.0.1:8000  
module = www.wsgi  
pythonpath = /root/www/
pythonpath = /root/www/www 
pidfile = /root/www/www.pid  
daemonize = /root/www/www.log  
enable-threads = true
memory-report = true
limit-as = 6048 
```

这是 Nginx 配置：

```
server{  
    listen 80;  
    server_name 119.254.35.221;      
    location / {  
        uwsgi_pass 127.0.0.1:8000;  
        include uwsgi_params;  
    }  
} 
```

django 工作正常，但是除非我重新启动 uwsgi，否则无法看到修改的页面。（更重要的是，当我配置 8 个工作进程时，当我按 ctrl+f5 一会儿时，我可以看到修改后的页面，似乎只有确定worker 可以读取和响应修改后的页面，但其他人只显示旧页面，谁缓存旧页面？我没有配置任何关于缓存的内容）

我没有配置django，它与“python manager runserver ...”配合得很好，但是在使用nginx + uwsgi时会出现这个问题。

（nginx和uwsgi都是新安装的，我确定这里没有配置其他东西..）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T00:39:38.623

*   uwsgi 不会自动重新加载你的代码，只有开发服务器会
*   runserver 用于调试目的，uwsgi 和 nginx 用于生产
*   在生产中，您可以通过`service uwsgi restart`或通过 init.d 脚本重新启动 uwsgi
*   [使用touch-reload](http://projects.unbit.it/uwsgi/wiki/Management)甚至有更好的方法来重新加载 uwsg

通常不需要清理`.pyc`文件，只有当文件的时间戳错误时才会发生（我在整个职业生涯中只见过几次）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:48:30.230

这是正常行为。`uwsgi`除非您重新启动它，否则不会重新读取您的代码（它不像`runserver`您拥有 时那样工作`DEBUG=True`）。

如果在你更新了你的代码之后，重新启动了 uwsgi，清除了你的浏览器缓存并且它*仍然*没有反映你的更改，那么你应该`*.pyc`从你的源目录中删除文件。

我通常使用这个：

```
find . -name "*.pyc" -exec rm {} \; 
```

粗略地说，`.pyc`是代码的“编译”版本。如果 Python 未检测到源代码的更改，它将加载此优化版本。如果您删除这些文件；然后它将重新读取您的源文件。

# ruby-on-rails - Rails 控制器中的错误处理，用于将嵌入式 Mongoid 文档添加到模型

> ID：12625051
> 
> 赞同：1
> 
> 时间：2012-09-27T15:37:49.823
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, mongoid

我有一个嵌入文档的项目模型。目前，以下comments_controller 代码将成功为项目添加评论。但是，如果将评论文档推送到 item 的评论数组中失败，我将不知道这一点。

```
 #this does work, but i do not know if the push fails
  def create
    comment = Comment.new(:text => params[:text])
    @item.comments << comment
    render :text => comment
  end 
```

我想要这样的东西，但@item.comments << 评论不返回真或假：

```
 #this does not work
  def create
    comment = Comment.new(:text => params[:text])
    if @item.comments << comment
      render :text => comment
    else
      render :text => 'oh no'
    end
  end 
```

文档推送失败时也不会抛出异常：

```
 #this does not work
  def create
    begin
      comment = Comment.new(:text => params[:text])
      @item.comments << comment
      render :text => comment
    rescue Exception => e
      render :text => 'oh no'
    end
  end 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:36:21.353

您必须为评论设置项目，然后将其保留。如果保存顺利，comment.save 将返回 true，否则返回 false。您可以根据需要处理这两种情况。

```
def create
  comment = Comment.new(:text => params[:text])
  comment.item = @item  
  if comment.save
    render :text => "yay"
  else
    render :text => "oh no"
  end
end 
```

# java - 在 libgdx 中截屏

> ID：12625052
> 
> 赞同：4
> 
> 时间：2012-09-27T15:37:52.443
> 
> 标签：java, android, libgdx

我有一个应用程序，我想在其中截取游戏屏幕的屏幕截图并将其保存为图像并上传到 Facebook。我正在使用 Libgdx，我的重点是 android。

谁能帮助我如何以编程方式截取游戏屏幕并将其保存为图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-28T11:13:32.927

现在相当容易。Libgdx 提供了一个示例，可以在[Take a Screenshot](https://libgdx.com/wiki/graphics/taking-a-screenshot)页面上找到该示例。

我必须添加一个语句才能使其正常工作。图像无法直接保存到`/screenshot1.png`。只需在前面加上`Gdx.files.getLocalStoragePath()`.

源代码：

```
public class ScreenshotFactory {

    private static int counter = 1;
    public static void saveScreenshot(){
        try{
            FileHandle fh;
            do{
                fh = new FileHandle(Gdx.files.getLocalStoragePath() + "screenshot" + counter++ + ".png");
            }while (fh.exists());
            Pixmap pixmap = getScreenshot(0, 0, Gdx.graphics.getWidth(), Gdx.graphics.getHeight(), false);
            PixmapIO.writePNG(fh, pixmap);
            pixmap.dispose();
        }catch (Exception e){           
        }
    }

    private static Pixmap getScreenshot(int x, int y, int w, int h, boolean yDown){
        final Pixmap pixmap = ScreenUtils.getFrameBufferPixmap(x, y, w, h);

        if (yDown) {
            // Flip the pixmap upside down
            ByteBuffer pixels = pixmap.getPixels();
            int numBytes = w * h * 4;
            byte[] lines = new byte[numBytes];
            int numBytesPerLine = w * 4;
            for (int i = 0; i < h; i++) {
                pixels.position((h - i - 1) * numBytesPerLine);
                pixels.get(lines, i * numBytesPerLine, numBytesPerLine);
            }
            pixels.clear();
            pixels.put(lines);
        }

        return pixmap;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-27T23:39:43.663

简单的解决方案：

```
Image screenShot = new Image(ScreenUtils.getFrameBufferTexture()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-27T13:58:21.527

我只是想在这里添加一些东西。

在进行屏幕截图时，我们还需要考虑黑条和调整大小的窗口。如果您没有视口（用于移动设备），只需将装订线尺寸替换为 0。

**以下是正确拍摄*fullScreen-screenShot 的方法*：**

```
final Pixmap pixmap = ScreenUtils.getFrameBufferPixmap(
                    MyGdxGame.viewport.getLeftGutterWidth(),
                    MyGdxGame.viewport.getTopGutterHeight(),
                    Gdx.graphics.getWidth() - MyGdxGame.viewport.getLeftGutterWidth() - MyGdxGame.viewport.getRightGutterWidth(),
                    Gdx.graphics.getHeight() - MyGdxGame.viewport.getTopGutterHeight() - MyGdxGame.viewport.getBottomGutterHeight()); 
```

然后您可以使用 PixmapIO 保存像素图。[https://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/PixmapIO.html](https://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/PixmapIO.html)

**注意：**请注意，y 不是底部装订线，而是顶部装订线。因为坐标系不同。这也是图像颠倒的原因。

您也可以使用下面链接中的代码翻转像素图（仅当您不打算将其转换为纹理然后是 Sprite 时）。

[https://stackoverflow.com/a/19746741/2205307](https://stackoverflow.com/a/19746741/2205307)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T05:15:53.510

你想创建一个 FrameBuffer，frameBuffer.begin()，渲染一切，frameBuffer.end()。

然后，您可以获得像素图。这具有将其保存为任何图像文件所需的一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-02T07:32:42.473

谢谢我使用链接[http://code.google.com/p/libgdx-users/wiki/Screenshots](http://code.google.com/p/libgdx-users/wiki/Screenshots)解决了它？但使用 PixmapIO.wirtePNG ( pixmap , fileHandle ) 而不是 PNG.toPNG 因为它给出了没有 PNG 类的错误。

感谢帮助我的 Stick2。

# bash - 在文件中查找字符串

> ID：12625058
> 
> 赞同：1
> 
> 时间：2012-09-27T15:38:07.107
> 
> 标签：bash, shell, unix, grep

我有一个 foo.txt 格式的文件

```
 id, some_string, stringy_string.. 
  and so on 
```

我如何在这个 foo.txt 中找到一个特定的 id

此 id 将/应该仅出现在一行中。（即没有多个实例？）谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T15:44:30.477

这取决于 id 的外观。如果它们不包含任何 grep 特殊字符，则可以使用

```
grep '^id,' foo.txt 
```

匹配行的`^`开头，逗号只是确保 id 在那里结束（因此`id12`在 中不匹配`id123`）。

如果特殊字符可以出现在 id 中，则必须对其进行转义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T06:34:34.130

`sed -n '/id/p' filename` 它将显示该特定模式 (id)， `grep -o -n 'id' filename` 并将显示该 id 以及该文件中模式匹配的行号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T05:48:08.330

```
grep "id" filename 
```

您可以轻松地从文件中搜索 id 或字符串或任何内容。

如果要将字符串替换为另一个字符串，

你可以使用 sed：

```
sed 's/your string/new string/g' 
```

# mysql - 到 BLOB 还是不到 BLOB

> ID：12625063
> 
> 赞同：3
> 
> 时间：2012-09-27T15:38:25.737
> 
> 标签：mysql, blob, innodb

我正在编写一个由 MySQL 数据库备份的 Web 应用程序，其中一个表有可能变得非常大（千兆字节的顺序），其中很大一部分表操作正在写入。其中一个表列需要存储一个可能非常大的字符串序列。到目前为止，在我的测试中，它的大小已达到 289 字节，但为了安全起见，我想设计的最大大小为 1 kb。目前我将该列作为 MySQL MediumBlob 字段存储在 InnoDB 表中。

同时，我一直在用谷歌搜索确定 BLOB 与其他存储形式的相对优缺点。那里的信息太多了，也许太多了。我收集到的是，InnoDB 将 BLOB 的前几个字节（如果记忆对我有用，则为 789）存储在表行本身和其他地方。我也有这样的想法，如果一行每列有多个 BLOB（我的表没有），那么“其他地方”是每个 BLOB 的不同位置。除此之外，我的印象是访问 BLOB 数据比访问行数据慢得多（这听起来很合理）。

我的问题就是这样 - 鉴于我的 BLOB 大小和表的巨大潜在大小，我应该为一个 blob 烦恼吗？另外，如果我使用某种形式的行内存储，这不会对表能够容纳的最大行数产生不利影响吗？

MySQL 很简洁，可以让我摆脱开发环境中的几乎所有事情。但是……那不是真实的世界。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:52:00.627

如果 BLOB 数据大于 250kb，则不值得。在你的情况下，我不会打扰自己 BLOB'n。[读这个](http://research.microsoft.com/apps/pubs/default.aspx?id=64525)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:52:25.813

我相信你已经看过[这里](http://dev.mysql.com/doc/refman/5.0/en/innodb-restrictions.html)，但是很容易忽略一些细节，因为在涉及 InnoDB 限制时需要牢记很多。

您的一个问题（表的最大大小）的简单答案是 64TBytes。使用可变大小类型将存储移动到单独的文件中肯定会改变行数的上限，但 64TBytes 是相当大的空间，因此比率可能非常小。

将具有 1KByte 字符串类型的列存储在表中似乎是一个可行的解决方案，因为与 64TBytes 相比，它也非常小。特别是如果您对查询速度有非常严格的要求。

此外，请记住，InnoDB 64TByte 限制可能会被您正在使用的操作系统的最大文件大小推低。您始终可以将多个文件链接在一起，以便为您的表格腾出更多空间，但随后它开始变得更加混乱。

# c++ - 为什么+运算符重载返回类型是类类型而不是整数？

> ID：12625075
> 
> 赞同：1
> 
> 时间：2012-09-27T15:39:11.140
> 
> 标签：c++, operator-overloading

在本文中作者选择返回类型为类类型[http://www.learncpp.com/cpp-tutorial/92-overloading-the-arithmetic-operators/](http://www.learncpp.com/cpp-tutorial/92-overloading-the-arithmetic-operators/)*强调文本*，我们可以将返回类型更改为返回int ，因为我想做下面的事情，我试过了，效果很好，为什么作者做了返回类型类？？

```
#include <cstdlib>
#include <iostream>
using namespace std;
class Cents // defining new class
{
    private:
    int m_Cents;
    int m_Cents2;
    public:
    Cents(int Cents=0, int Cents2=0) // default constructor
    { 
        m_Cents=Cents;
        m_Cents2=Cents2;
}
Cents(const Cents &c1) {m_Cents = c1.m_Cents;}
friend ostream& operator<<(ostream &out, Cents &c1); //Overloading << operator
friend int operator+(const Cents &c1, const Cents &c2); //Overloading + operator
};
ostream& operator<<(ostream &out, Cents &c1)
{
out << "(" << c1.m_Cents << " , " << c1.m_Cents2 << ")" << endl;
return out; 
}
int operator+(const Cents &c1, const Cents &c2)
{
return ((c1.m_Cents + c2.m_Cents) + (c1.m_Cents2 + c2.m_Cents2 ));
}
int main(int argc, char *argv[])
{
Cents cCents(5, 6);
Cents bCents;
bCents = cCents;
cout << bCents << endl;
Cents gCents(cCents + bCents, 3);
cout << gCents << endl;
system ("PAUSE");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T15:41:56.203

除了许多其他事情之外，要记住的一件事是，在相同类型的两个对象之间进行加法的结果总是属于那种非常特定的类型。所以它可能对你有用，但在逻辑上它是不正确的。其次，您无法在`+`不返回类类型的情况下执行嵌套语句。例如，如果你想这样做。

```
Obj1 + Obj2 + Obj3 ; 
```

你会得到一个编译时错误。原因是`+`operator 的重载函数应该按相同类类型的值返回结果。下面编写的运算符也可以为函数调用编写如下。

```
Obj1 + Obj2 ; 
```

相当于...

```
Obj1.operator+(Obj2) ; 
```

对于嵌套加法操作，您可以这样做。

```
Obj1 + Obj2 + Obj3 ; 
```

这相当于....

```
(Obj1.operator+(Obj2)).operator+(Obj3) ;
|---------------------| 
```

在这里，这部分...

```
(Obj1.operator+(Obj2)) 
```

成为另一个临时类对象，在其上调用下一个方法`Obj3`作为参数。所以如果你不从`+`函数返回类对象，这部分将是一个`int`而不是一个对象。该`+`函数不会在该 int 或任何其他非类数据类型上调用。所以它会给你一个错误。

简而言之，建议始终从重载`+`函数中按值返回对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:42:32.333

一般来说，加法的语义是当您添加两个给定类型的对象时，您希望结果对象具有相同的类型。

你没有理由*不能*做你想做的事，但这是非标准加法语义的一个例子。

# java - JUnit 测试 - 应该通过预期结果的测试有什么问题？

> ID：12625080
> 
> 赞同：1
> 
> 时间：2012-09-27T15:39:30.900
> 
> 标签：java, eclipse, unit-testing, testing, junit

我正在我的 DB-Application 中测试一个简单的东西。创造一个产品。为此，我使用 Junit 测试，这是总是失败的测试，而不是预期的结果变成绿色（通过）......

```
@Test
public void testCreate(){
    Produkt test = new Produkt(20, "junit", "junitk", false, 900.67, true, true);
    handler.createProdukt(test);
} 
```

当我简单地使用主要方法尝试它时（只是创建一个新的 Produkt 并查看它是否有效......），create 函数运行良好并创建了这个 Produkt。

我究竟做错了什么？

PS.：这是我设置测试的代码：

```
@Before
public void setUp() throws SQLException, ClassNotFoundException{
    try {
        this.shandler = new ServiceHandler();
        this.setServiceHandler(shandler);
        manager.getConnection();
        manager.getConnection().setAutoCommit(false);
    } catch (SQLException ex) {
        System.err.println("ERROR:");
        ex.printStackTrace();
    }

}

@After
public void tearDown() throws SQLException, ClassNotFoundException{
    manager.getConnection().rollback();
    manager.closeConnection();
} 
```

**更新** 我猜你的意思是失败跟踪：

> java.lang.NullPointerException at tests.JUnitAbstractTests.testCreate(JUnitAbstractTests.java:35) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect。 DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45) at org. junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) 在 org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42) 在 org.junit.internal.runners.statements.InvokeMethod。 org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263) 的评估（InvokeMethod.java:20）。junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47) at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231) at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60) at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229) at org.junit.runners.ParentRunner.access$000(ParentRunner.java: 50) 在 org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222) 在 org.junit.runners.ParentRunner.run(ParentRunner.java:300) 在 org.eclipse.jdt.internal.junit4.runner。 JUnit4TestReference.run(JUnit4TestReference.java:50) 在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner。runTests(RemoteTestRunner.java:467) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner. java:390) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:51:01.783

假设您的代码片段是准确的，您的方法会在您的测试使用字段时`setUp()`实例化一个字段。堆栈跟踪清楚地表明您在. 所以你做错的事情是试图在一个值为空的对象上调用一个方法。`shandler``testCreate()``handler``testCreate()`

# mysql - 如何从秒到时间

> ID：12625081
> 
> 赞同：-2
> 
> 时间：2012-09-27T15:39:31.257
> 
> 标签：mysql, time

如何在 mysql 上从秒到时间传递？

out 的日期格式为 hh:mm:ss.ms

对不起。我需要例如 0.98 秒 -> 00:00:00.980; 使用 sec_to_tiem 返回 00:00:01。

谢谢。

我已经实现了这种方式：

```
select concat(if(floor(seconds/(60 * 60)) = 0,'00',lpad(floor(seconds/(60 * 60)),2,'0')), 
':',
if(floor(seconds/60) = 0,'00',lpad(floor(seconds / 60),2,'0')), 
':',
seconds % 60) 
```

但它必须以其他更有效的方式存在

另一种方式：

```
CONCAT(lpad(floor(seconds / 3600), 2, '0'), ':', 
      lpad(floor(seconds / 60), 2, '0'), ':',
      lpad(floor(seconds  % 60), 2, '0'), '.', 
      lpad(SUBSTRING_INDEX((seconds * 1000) % 1000, '.', 1), 3, '0')) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:45:42.813

```
SELECT MAKETIME (<yourseconds>/(60*24), <yourseconds>/60, <yourseconds>%60) 
```

或格式

```
SELECT TIME_FORMAT( MAKETIME( <yourseconds>/ ( 60 *24 ) , <yourseconds>/60, <yourseconds>%60 ) ,  '%T.%f' ) 
```

# ruby-on-rails - 按特定条件查找所有关联对象

> ID：12625082
> 
> 赞同：0
> 
> 时间：2012-09-27T15:39:42.320
> 
> 标签：ruby-on-rails, ruby, find, associations, named-scope

* * *

```
class QuestionGroup < ActiveRecord::Base
  has_many :questions
end

class Question < ActiveRecord::Base
  belongs_to :question_group
  has_many :question_answers
  has_many :question_users_answers, :through => :question_answers, :source => :user_question_answers

  def self.questions_without_answers(user_id)
    select {|q| q.question_users_answers.where(:user_id=>user_id).empty?}
  end
end

class QuestionAnswer < ActiveRecord::Base
  belongs_to :question
  has_many :user_question_answers
end 
```

如果没有用户答案，我需要找到所有问题我通过类方法**self.questions_without_answers(user_id)**

但是我怎样才能找到所有存在 questions_without_answers 和特定用户的 QuestionGroups？

PS：我需要找到所有未回答的问题以及拥有这些问题的所有组，我可以通过*find*或*named-scope*来完成吗？

**更新：**

```
 def self.groups_without_answers(user_id)
    questions_ids = Question.questions_without_answers(user_id).map {|q| q.id}
    all(:conditions => "id in (select distinct question_group_id from questions where id in (#{questions_ids.join(',')}))")
  end 
```

但我认为这不好，或者我错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:54:46.523

```
class QuestionGroup < ActiveRecord::Base
  has_many :questions

  def self.without_answers(user_id)
    joins(%"inner join questions on question_groups.id = questions.question_group_id
            inner join question_answers
              on question_answers.question_id = questions.id
            inner join question_groups
              on question_answers.question_users_answers_id = question_users_answers.id").where("user_question_answers.user_id" => user_id).select { |qq| ... }
    end
  end
end 
```

您可以将一些内部联接更改为 leftout join 以获取您要加入的表不匹配的记录，例如*没有 answer*的记录。您要加入的表的字段的所有字段都将具有 NULL 值。添加 where **id is null**甚至会过滤到没有答案的问题。

请记住，这只是一种替代技术。您可以通过以下方式以编程方式简单地解决问题：

```
class QuestionGroup
  def self.question_groups_without_answers(user_id)
    select {|qq| qq.question_users_answers.where(:user_id=>user_id).empty?}.map{ |qq| qq.question_group }
  end
end 
```

进行联接的一个优点是数据库会完成所有工作，并且您不需要向数据库发送多个 SQL 查询，因此速度会**快得多**。

# android - Android 电子市场应用内结算私钥 (RSA)

> ID：12625087
> 
> 赞同：0
> 
> 时间：2012-09-27T15:39:58.667
> 
> 标签：android, in-app-purchase, key, google-play

我想在我的应用程序中实现应用内计费。我有一个私钥（由 Google 提供）来验证请求，但我需要将其放入 .pem 文件中。问题是当我将它粘贴到表单中时：

```
-----BEGIN RSA PRIVATE KEY-----
------------<MY KEY>----------
-----END RSA PRIVATE KEY----- 
```

它说这是一个无效的证书。

如何在有效的 .pem 文件中转换密钥字符串？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T04:12:20.227

Google 提供的不是私有密钥，而是*公钥*。私钥位于 Google 的服务器上。您使用什么语言/库？您可能需要一个 PEM*公钥*文件，如下所示：

```
-----BEGIN PUBLIC KEY-----
<PASTE HERE>
-----END PUBLIC KEY----- 
```

# php - 日期和 if else 语句 PHP

> ID：12625090
> 
> 赞同：1
> 
> 时间：2012-09-27T15:40:06.060
> 
> 标签：php, date, time

我目前正在编写一些似乎在逻辑上工作的 PHP 代码

```
$tod = date("G");
if($tod >= 5 && $tod <= 11)      { $work = "Morning's"; }
elseif($tod >= 12 && $tod <= 17) { $work = "Afternoon's"; }
else                               $work = "Evening's";

$dw = date( "l");

if($work = "Morning's")       { $pre = "Morning"; }
elseif($work = "Afternoon's") { $pre = "Afternoon"; }
else                            $pre = "Evening"; 
```

出于某种原因，如果我在回显 $work 时尝试将 $tod 变量增加或设置为每个范围内的某个值，无论 $tod 设置为什么，它总是返回“Morning's”。我的 if..elseif..else 语句有问题吗？加载页面时，我没有收到任何错误。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:42:23.910

试试这个，如果你忘记了两个“=”

```
 $tod = date("G");
    if($tod >= 5 && $tod <= 11) {$work = "Morning's";}
    elseif($tod >= 12 && $tod <= 17) {$work = "Afternoon's";}
    else $work = "Evening's";
    $dw = date( "l");
    if($work == "Morning's"){$pre = "Morning";}
    elseif($work == "Afternoon's"){$pre = "Afternoon";}
    else $pre = "Evening"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:21:58.867

只是为了缩短一点（并更正拼写：复数是 w/o `'`）：

```
$pre = "Evening";
in_array( date( "G" ), range( 5, 11 ) )  AND $pre  = "Morning";
in_array( date( "G" ), range( 12, 17 ) ) AND $pre = "Afternoon";
$work = "{$pre}s"; 
```

# editor - 如何理解这个 vim 脚本？

> ID：12625091
> 
> 赞同：9
> 
> 时间：2012-09-27T15:40:17.630
> 
> 标签：editor, vim

以下是来自 vim 插件的 vim 脚本：

vim 的语法有点奇怪：

1.  `!exists("*s:SetVals")`，为什么他们之前是一个starmark `s:`？
2.  函数！，为什么有一个`!`字符？
3.  `&iskeyword`，这是一个变量，如果是，它是在哪里定义的？
4.  `s:`和是什么`g:`，它们之间有什么区别？
5.  为什么应该使用 let ？比如`let &dictionary = g:pydiction_location`，我可以把它改成这样`&dictionary = g:pydiction_location`吗？

> 如果 !exists("*s:SetVals")
> 
> ```
>  function! s:SetVals()
>       " Save and change any config values we need.
> 
>       " Temporarily change isk to treat periods and opening 
>       " parenthesis as part of a keyword -- so we can complete
>       " python modules and functions:
>       let s:pydiction_save_isk = &iskeyword
>       setlocal iskeyword +=.,(
> 
>       " Save any current dictionaries the user has set:
>       let s:pydiction_save_dictions = &dictionary
>       " Temporarily use only pydiction's dictionary:
>       let &dictionary = g:pydiction_location
> 
>       " Save the ins-completion options the user has set:
>       let s:pydiction_save_cot = &completeopt
>       " Have the completion menu show up for one or more matches:
>       let &completeopt = "menu,menuone"
> 
>       " Set the popup menu height:
>       let s:pydiction_save_pumheight = &pumheight
>       if !exists('g:pydiction_menu_height')
>           let g:pydiction_menu_height = 15
>       endif
>       let &pumheight = g:pydiction_menu_height
> 
>       return ''
>   endfunction 
> ```
> 
> 万一

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-27T16:02:28.997

> **1.** `!exists("*s:SetVals")`为什么他们在 s: 之前是一个星标？

星号是exists函数的特殊语法，它表示我们正在检查是否存在一个名为SetVals的函数。该选项`iskeyword`可以检查和`exists("&iskeyword")`ex 命令`echo``exists(":echo")`

看`:h exists(`

> **2.** `function!`为什么会有！特点？

感叹号表示如果该函数已存在，则将其替换。

看`:h user-functions`

> **3.** `&iskeyword`，这是一个变量，如果是，它是在哪里定义的？

那是一个 vim 选项。您可以检查它是否设置为`:set iskeyword?`

> **4.**什么是`s:`和`g:`，它们有什么区别？

这些定义了以下符号的范围。`s:`表示该符号是脚本的本地符号，而`g:`表示该符号将是全局的。

见见见`:h internal-variables`_`s:``:h script-variable`

> **5.**为什么`let`要使用？比如`let &dictionary = g:pydiction_location, can i change it to be &dictionary = g:pydiction_location`？

Vimscript 是需要用关键字声明变量的语言之一。我认为没有比 with 更容易声明变量的方法了`let`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T16:01:45.347

我可以回答其中的一些问题，但我将从受您最近的问题启发的一般性评论开始。

在 Vim 极其详尽的文档中，您的大部分问题的答案都非常清楚。如果你认真使用 Vim，你必须知道如何使用它。开始`:help`并仔细阅读。它支付。相信我。

您可以在 中找到所有这些子问题的答案`:help expression`。

*   `!exists("*s:SetVals")`，为什么他们之前是一个starmark `s:`？

    见`:help exists()`。

*   `function!`，为什么会有`!`人物？

    没有感叹号，如果您重新获取脚本，Vim 将不会替换之前的定义。

*   `&iskeyword`，这是一个变量，如果是，它是在哪里定义的？

    这就是您在脚本中测试 vim 选项值的方式。见`:help iskeyword`。

*   `s:`和是什么`g:`，它们之间有什么区别？

    这些是命名空间。看`:help internal-variables`

*   为什么`let`要使用？比如 let `&dictionary = g:pydiction_location`，我可以把它改成 be`&dictionary = g:pydiction_location`吗？

    不，您不能，`:let`这是您定义或更新变量的方式。习惯它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T15:55:12.017

见`:help eval.txt`。它描述了大部分 vimscript 语法。

# php - PHP日期与sql比较

> ID：12625092
> 
> 赞同：-2
> 
> 时间：2012-09-27T15:40:18.883
> 
> 标签：php, mysql, date

> **可能重复：**
> [如何在我的查询中使用日期格式？](https://stackoverflow.com/questions/7072002/how-to-use-date-format-in-my-query)

我有一个来自表单帖子的日期为 09-23-2012 并且在我的 sql 数据库中我使用日期时间格式保存日期，例如 2012-09-23 23:11:13 我想创建一个查询来比较这两个日期。这两个日期应该相等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:51:39.787

尝试`DATE_FORMAT`：

```
WHERE DATE_FORMAT(the_field, '%Y-%m-%d') = CAST(:yourInput AS DATE) 
```

或类似的东西

# iphone - 监控 iOS 中其他应用程序的内存使用情况

> ID：12625097
> 
> 赞同：1
> 
> 时间：2012-09-27T15:40:45.377
> 
> 标签：iphone

我严重怀疑它甚至可以通过苹果批准的应用程序，但我在 cydia 中看到了一些应用程序，它们可以让您查看各个应用程序正在使用多少内存，并且想知道这是否可能在不越狱设备的情况下实现。

我问的原因是我正在帮助设计一个“绿色”充电器和随附的应用程序，客户认为向用户展示哪些应用程序正在耗尽电池或使用最多内存以尝试延长电池寿命是有益的。

# php - 通过 PHP 进行简单的 MySQL 查询

> ID：12625100
> 
> 赞同：0
> 
> 时间：2012-09-27T15:40:58.713
> 
> 标签：php, mysql, database

我有一个大约 500,000 行的表，需要对其进行查询以检索结果。基本上用户只需输入一个案例编号，然后我想执行以下查询并使用 while 循环显示结果

```
if (!empty($_POST["casenum"])) {
    $result2 = mysql_query("SELECT Box_Content.case_number, Transfer.number, Transfer.location, Box.number FROM Box_Content, Transfer, Box WHERE Box_Content.box_id = Box.id and Box.transfer_id = Transfer.id and Box_Content.case_number = '".$_POST['casenum']."'");

    while ($row = mysql_fetch_array($result2)) {
        echo "Case number: ".$casenum." text ";
        echo "<br />";
    }

} else {
    echo "<h4>WARNING!!! Search criteria entered not valid. Please search again.</h4>";
} 
```

我在这里做错了什么？

编辑：

如果只返回一行，它现在可以工作，但是对于两行，它似乎正在尝试打印整个表格......

```
$casenum = $_POST["casenum"];
echo "<br />The case number entered is: $casenum<br />";

if (!empty($_POST["casenum"]))
        {
        $result2 = mysql_query("SELECT Box_Content.case_number, Transfer.number as transfer_number, Transfer.location as transfer_location, Box.number as box_number FROM Box_Content, Transfer, Box WHERE Box_Content.box_id = Box.id and Box.transfer_id = Transfer.id and Box_Content.case_number = '" . $_POST['casenum'] . "'");

        while($row = mysql_fetch_array($result2))
                {
                print_r ($row);
                echo "<br />";
                echo "<b>Case number: </b>" . $row['case_number'] ."<br />";
                echo "<b>Transfer number: </b>" . $row['transfer_number'] ."<br />";
                echo "<b>Transfer location: </b>" . $row['transfer_location'] ."<br />";
                echo "<b>Box number: </b>" .$row['box_number'] ."<br />";
                }
}

else
        {
        echo "<h4>WARNING!!! Search criteria entered not valid. Please search again.</h4>";
        }

var_dump($_POST); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:42:46.687

尝试：

```
 while ($row = mysql_fetch_array($result2)) {
        echo "Case number: ". $row['Box_Content.case_number'] ." text ";
        echo "<br />";
    } 
```

`$row['case_number']`将输出`case_number`结果集中每一行的检索结果。

但是，您应该考虑做以下两件事之一：

1.  开始使用最佳实践。
2.  开始使用不推荐使用的 SQL 库（mysqli、PDO）。

此查询容易受到 SQL 注入的影响：

```
"SELECT Box_Content.case_number, Transfer.number, Transfer.location, Box.number
     FROM Box_Content, Transfer, Box
     WHERE Box_Content.box_id = Box.id and Box.transfer_id = Transfer.id
     and Box_Content.case_number = '".$_POST['casenum']."'" 
```

用来`mysql_real_escape_string($_POST['casenum'])`修补这个。

**参考**： http: [//php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)

由于未准备好的语句操作，这些`mysql_*`函数早已被弃用。改为为您的项目查看[mysqli](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:46:59.120

**我在这里做错了什么？**

1) $casenum 没有在你的代码中设置......（请告诉我它什么都不是，你没有打开注册超全局变量？！）你可能想要`$row['case_number']`

2）但无论如何，这并不是你做错了什么......你最大的错误是在没有任何验证或清理的情况下使用用户输入......

想象一下，如果`$_POST["casenum"]`等于...

`' or 1=2 union select user,password,email,salt from users`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:52:32.577

你似乎`$casenum`从无处使用。

尝试：

```
while($row = mysql_fetch_assoc($result2))
   echo "Case number: ".$row['number']." text <br />"; 
```

使用 mysql_fetch 函数时 assoc 将带回命名索引数据，num 将带回数字索引数据，array 将带回两者，因此请尝试使用其中一个。

然后，当您`$row = mysql_fetch_assoc($result2)`对返回的每一行数据执行基本操作时，将其存储为 $row 中的（在本例中为关联）数组，这样您就可以通过标准数组命令 ( `$row['foo']`) 访问您的数据。

# java - 根据 HTTP 请求创建的 PDF 不会在 Internet Explorer 中打开

> ID：12625108
> 
> 赞同：4
> 
> 时间：2012-09-27T15:41:26.827
> 
> 标签：java, internet-explorer, pdf, flying-saucer

我有一个 servlet，它根据请求中的一些参数在响应中生成 PDF。当我尝试在 IE 中打开/下载此文件时，我收到以下消息：

“无法从 [站点] 下载 [文件名]。无法打开此 Internet 站点。请求的站点不可用或找不到。请稍后再试。”

这是我设置的响应：

```
response.setHeader("Content-Disposition", "attachment;filename=" + title + ".pdf");

response.setContentType("application/pdf"); 
```

其他浏览器一切正常。

**更新：**

我试过内联而不是附件。这将打开一个新窗口而不是打开/保存对话框（我希望有对话框），错误消息消失了，但新窗口在 IE 中只是空的。仍在使用其他浏览器。

我尝试了简单的、双引号和不包含任何未转义字符的文件名。双引号和无引号没有区别，但是单引号会附加到文件名中，我当然不想要。

文件名不包含非转义字符。

我已经检查了[这个](http://greenbytes.de/tech/tc2231/)页面上的测试，它说所有浏览器都通过了[带有文件名的附件，没有引号。](http://greenbytes.de/tech/tc2231/#attwithasciifilenamenq)这是从一开始就使用的。

添加 Content-Lenght 标头没有区别。

顺便说一句，飞碟是用来制作 PDF 的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:46:54.687

我建议看一下[http://greenbytes.de/tech/tc2231/](http://greenbytes.de/tech/tc2231/)，它列出了一大堆测试用例，了解不同浏览器如何使用不同的`Content-Disposition`标头值。我的猜测是`title`包含空格或其他一些需要转义的特殊字符，而 IE 目前正在抱怨非转义值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:50:48.927

您是否尝试过以下标题：

```
response.setHeader("Content-Length", lenght);
response.setHeader("Content-Disposition", "inline; filename='" + filename + "'"); 
```

文件名应该大写。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-25T13:56:23.830

这已经有一段时间了，但我认为我应该更新它，因为找到了解决方案。

正在使用的 CMS 添加了一些我一开始没有考虑到的标题：

*   缓存控制：私有
*   Pragma：无缓存

如果没有缓存，似乎是IE的下载问题。这些标头在 CMS 的升级中被更改，从而解决了问题。

例子：

*   缓存控制：公共，最大年龄=31536000
*   日期：格林威治标准时间 2012 年 12 月 6 日星期四 14:14:14
*   过期：格林威治标准时间 2013 年 12 月 6 日星期五 14:14:14

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-31T21:15:47.810

我遇到了同样的问题，最终是 IE 无法处理响应代码 201（所有其他浏览器都处理它）。当我将其更改为 200 时，IE 下载的文件就好了。

[这篇文章](https://stackoverflow.com/questions/7003678/pdf-generation-not-displaying-in-ie)为我指明了正确的方向。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-24T06:38:39.020

通过下面的代码，我可以在 IE 浏览器中查看 pdf。response.setHeader("Content-Disposition", "attachment;filename=" + title + ".pdf");

非常感谢。

# ios - 从 iOS 调用 WCF 数据服务服务操作

> ID：12625109
> 
> 赞同：1
> 
> 时间：2012-09-27T15:41:30.067
> 
> 标签：ios, json, wcf-data-services, odata

### 如何从 iOS 调用 WCF 中的服务操作？

我在我的 WCF 数据服务中定义了一个服务操作（绑定到我的数据库架构中的存储过程），我需要从 iOS 调用它。假设我的`.svc.cs`文件中有以下声明：

```
[WebInvoke(RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
public IQueryable<Foo> GetFoos(int param1, DateTime param2, string param3)
{
  return CurrentDataSource.GetFoos(param1, param2, param3).AsQueryable();
} 
```

而且我已经在以下位置设置了适当的权限`InitializeService`：

```
config.SetServiceOperationAccessRule("GetFoos", ServiceOperationRights.AllRead); 
```

当我尝试通过来自 iOS 的 HTTP POST 调用它时，我得到一个包含在 JSON 中的错误：

> 错误请求 - 查询语法错误。

似乎它不喜欢我传递参数的方式。我在 POST 请求的请求正文中将它们传递给 JSON 编码（`NSJSONSerialization`用于将 a`NSDictionary`转换为 JSON 字符串）。`.svc`相同的方法适用于另一个未连接到 WCF 的Web 服务 ( )，它的操作以相同的方式注释。

以类似的方式对我的另一个问题的回答表明，可以在客户端和服务器之间协商数据格式，并且我读到[日期](https://stackoverflow.com/a/11443630/412107)[格式](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)很难，所以也许这是我的`DateTime`参数问题。但是我尝试了 JSON 格式（`\/Date(836438400000)\/`和`/Date(836438400000)/`）和 JSON Light 格式（`1996-07-16T00:00:00`）都无济于事。

所以我的问题是：调用此操作的正确方法是什么？如果我需要让我的应用程序告诉服务器期望什么格式，我该怎么做？

**更新**：我尝试使用[此问题](https://stackoverflow.com/questions/10849962/how-to-pass-a-null-value-to-a-wcf-data-services-service-operation?rq=1)`datetime'1996-07-16T00:00:00'`中提到的格式。同样的错误。

**更新 2**：服务操作的[MSDN 页面](http://msdn.microsoft.com/en-us/library/cc668788.aspx)似乎表明`Method = "POST"`在为服务操作添加注释时不支持任何其他内容`WebInvoke`。我尝试从上面代码中引用的内容中删除所有内容并将方法设置为 POST。同样的错误。

**更新 3**：根据 Pawel 的建议，我对我的数据服务进行了新的服务操作，如下所示：

```
[WebInvoke(Method = "POST")]
public IQueryable<string> GetFoos()
{
    List<string> foos = new List<string>();
    foos.Add("bar");
    return foos.AsQueryable();
} 
```

`accept:application/json;charset=utf-8`通过将方法设置为 POST、添加和`Content-Length:0`到标题，我能够使其在 Fiddler 的 Composer 窗格中工作。然后我在操作中添加了一个 int 参数（称为 param1）。我在 Fiddler 中将请求的主体设置为`{"param1":"1"}`并运行它（Fiddler 自动更新了我的 content-length 标头），并得到了同样的错误。我将参数的类型更改为字符串并再次运行我的请求并且它有效。所以我的问题似乎是非字符串类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:53:42.437

您需要在 URL 中而不是在请求正文中发送参数。

# jquery - 将 TOGGLE 添加到“输入文本时显示 div”

> ID：12625110
> 
> 赞同：0
> 
> 时间：2012-09-27T15:41:38.760
> 
> 标签：jquery, input, toggle, jquery-events

用户在开始输入时能够看到输入字段下方出现的选项。这是当前执行此操作的 Javascript：

```
 #number {
    display:none;
    }

    <body onload="
    $('#gname').bind('keyup change',function(){
    if(this.value.length > 0){
    $('#number').show();
    }
    else {
    $('#number').hide();}
    });
    ">

    <input type="text" id="gname">

    <div id="number">
        testing testing
    </div>
</body> 
```

我还试图让用户在输入之前也可以选择在 div 上切换，并且在输入后出现 div 时也可以关闭它...

关于如何操作代码的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:47:14.363

使用`toggle()`功能 - [**DEMO**](http://jsfiddle.net/LUqzK/1/)

```
$(function() {

    $('#gname').on('keyup change', function() {
        if (this.value.length > 0) {
            $('#number').show();
        } else {
            $('#number').hide();
        }
    });    

    $("#hint").on("click", function() {
        $('#number').toggle();
    });

}); 
```

**更新**

要在单击按钮禁用提示后禁用提示重新出现 - 只需取消绑定事件侦听器：

```
$("#hint").on("click", function() {
    $('#number').toggle();
    $('#gname').off('keyup change');
}); 
```

[**演示**](http://jsfiddle.net/LUqzK/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:47:49.680

你想为它处理焦点和模糊功能..试试这个

```
$('#gname').bind('keyup change blur', function() {
    if (this.value.length > 0) {
        $('#number').show();
    }
    else {
        $('#number').hide();
    }
});

$('#gname').on('focus', function() {
    $('#number').show();

});​ 
```

[检查演示](http://jsfiddle.net/GEqv8/1/)

# ios - iCloud 和 Web 应用程序

> ID：12625111
> 
> 赞同：2
> 
> 时间：2012-09-27T15:41:43.880
> 
> 标签：ios, cocoa-touch, cocoa, icloud

我有一个 iOS 应用程序可以让用户管理食谱。我还希望他们能够在 iPad 和 Mac 上管理相同的食谱。似乎 iCloud 可以让我做到这一点。

但是，如果我还想构建一个提供相同功能的 Web 应用程序，我是否认为我需要自己的非 iCloud 解决方案？是否有任何 iCloud API 可以让用户登录到他们的苹果帐户并访问添加到 iOS/OS X 应用程序中的数据？

如果我想允许网络访问数据，我是否被迫编写自己的数据服务和同步过程？还是有一些方法可以至少将 iCloud 数据“连接”到我自己的用户帐户？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T19:33:01.987

我认为通过 Web 应用程序进行“本机”集成是不可能的：

> [iPhone 和 Webapp 通过 iCloud 同步 ??](https://stackoverflow.com/questions/7773920/iphone-and-webapp-sync-through-icloud)

Apple 实际上有一个 iCloud Web 界面，但它只有自己的应用程序（联系人、日历等）。

# ruby - 帖子总数？

> ID：12625113
> 
> 赞同：14
> 
> 时间：2012-09-27T15:41:49.973
> 
> 标签：ruby, jekyll, liquid

我试图弄清楚如何显示一个类别（或全部）中的帖子总数。我设想如下所示，但无法完全弄清楚。我错过了文档中的某些内容吗？

```
{% for post in site.categories.CAT %}
    ...do some counting
{% endfor %}

posts: {% number_of_posts %}

{% for post in site.categories.CAT %}
    {{ post.title }}
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-15T14:35:26.603

```
# all posts

{{ site.posts | size }}

# posts in one category

{{ site.categories.CAT | size }} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:30:21.290

```
{% for post in site.categories.CAT %}
   {% capture post_count %} {{ post_count | plus: 1 }} {% endcapture %}
{% endfor %}
{{ post_count }} 
```

# json - QT4开源项目构建可重用组件

> ID：12625115
> 
> 赞同：0
> 
> 时间：2012-09-27T15:41:56.280
> 
> 标签：json, qt, user-interface, qt4

是否有任何开源项目可以在 QT4 中构建可重用的 GUI 组件，并将额外的连接信息保存在 JSON 文件中？Qt 设计器允许您构建一个对话框并将信号和插槽连接在一起并将结果保存为 UI 文件。我正在寻找一个可以扩展它以构建组件的项目，您可以轻松地将其插入到 c++ 或 pyside 应用程序中。一个例子是为电影播放器​​构建一个播放控件，其中包含所有的开始、停止、倒带、快进按钮。然后在应用程序中，您只需加载 UI 文件或可能带有额外输入和输出的 JSON 文件以进行回调。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T04:46:26.243

leeg，你所说的用 JSON 做的事情相当广泛。我必须同意 Stefan 的评论，即将您的自定义小部件建模为 QWidget 的子类是正确的方法。

您可以轻松地将类放入任何 Qt GUI 应用程序中。在创建标准 Qt GUI 库中不存在的新 GUI 元素时，我经常使用这种技术。您可以设置布局（垂直和水平），然后将小部件嵌套在小部件中以设计行为复杂的小部件。从那里，您可以创建自定义插槽和信号来处理不同的事件。

例如，您提到了带有开始、停止、倒带和快进按钮的电影播放器​​的播放器控件。您需要创建一个包含小部件，然后将水平布局添加到您的包含小部件。然后，您可以添加开始、停止、倒带和快进按钮。如果您想要按钮的图像，您可以在按钮本身上设置按钮图像。然后你可以发出开始、停止、倒带和快进的信号。在调用对象中，您将插槽连接到每个相应的信号。

这个骨架应该可以帮助您入门：

```
#include <QtCore>
#include <QtGui>

class PlayerControl : public QWidget
{
    Q_OBJECT
    signals:
        void start();
        void stop();
        void rewind();
        void fastForward();

    private slots:
        void startClicked();
        void stopClicked();
        void rewindClicked();
        void fastForwardClicked();

    public:
        PlayerControl(QWidget *parent);
        ~PlayerControl();

    private:
        QPushButton startButton;
        QPushButton stopButton;
        QPushButton rewindButton;
        QPushButton fastForwardButton;
}

void PlayerControl::PlayerControl(QWidget *parent)
{
    // do setup here
    connect(startButton, SIGNAL(clicked()), this, SLOT(startClicked()));
    connect(stopButton, SIGNAL(clicked()), this, SLOT(stopClicked()));
    connect(rewindButton, SIGNAL(clicked()), this, SLOT(rewindClicked()));
    connect(fastForwardButton, SIGNAL(clicked()), this, SLOT(fastForwardClicked()));
}

void PlayerControl::~PlayerControl()
{
    // clean up
}

void PlayerControl::startClicked()
{
    emit start();
}

void PlayerControl::stopClicked()
{
    emit stop();
}

void PlayerControl::rewindClicked()
{
    emit rewind();
}

void PlayerControl::fastForwardClicked()
{
    emit fastForward();
} 
```

# perl - 读取和解析多个文本文件

> ID：12625117
> 
> 赞同：0
> 
> 时间：2012-09-27T15:42:03.970
> 
> 标签：perl, unix, sed, awk

任何人都可以提出一种简单的方法来实现这一目标。我有几个以扩展名 .vcf 结尾的文件。我将举两个文件的例子在下面的文件中，我们感兴趣

文件 1：

```
38  107 C   3   T   6   C/T
38  241 C   4   T   5   C/T
38  247 T   4   C   5   T/C
38  259 T   3   C   6   T/C
38  275 G   3   A   5   G/A
38  304 C   4   T   5   C/T
38  323 T   3   A   5   T/A 
```

文件2：

```
38  107 C   8   T   8   C/T
38  222 -   6   A   7   -/A
38  241 C   7   T   10  C/T
38  247 T   7   C   10  T/C
38  259 T   7   C   10  T/C
38  275 G   6   A   11  G/A
38  304 C   5   T   12  C/T
38  323 T   4   A   12  T/A
38  343 G   13  A   5   G/A 
```

索引文件：

```
107
222
241
247
259
275
304
323
343 
```

索引文件是根据文件 1 和文件 2 中的唯一位置创建的。我已经准备好作为索引文件。现在我需要根据这里的位置读取所有文件并解析数据并写入列。从上面的文件中，我们对第 4（Ref）和第 6（Alt）列感兴趣。另一个挑战是相应地命名标题。所以输出应该是这样的。

```
Position    File1_Ref   File1_Alt   File2_Ref   File2_Alt
107 3   6   8   8
222         6   7
241 4   5   7   10
247 4   5   7   10
259 3   6   7   10
275 3   5   6   11
304 4   5   5   12
323 3   5   4   12
343         13  5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:11:21.840

您可以使用以下[`join`](http://ss64.com/bash/join.html)命令执行此操作：

```
# add file1
$ join -e' ' -1 1 -2 2 -a 1 -o 0,2.4,2.6 <(sort -n index) <(sort -n -k2 file1) > file1.merged

# add file2
$ join -e' ' -1 1 -2 2 -a 1 -o 0,1.2,1.3,2.4,2.6 file1.merged <(sort -n -k2 file2) > file2.merged

# create the header
$ echo "Position File1_Ref File1_Alt File2_Ref File2_Alt" > report
$ cat file2.merged >> report 
```

输出：

```
$ cat report

Position File1_Ref File1_Alt File2_Ref File2_Alt
107 3 6 8 8
222     6 7
241 4 5 7 10
247 4 5 7 10
259 3 6 7 10
275 3 5 6 11
304 4 5 5 12
323 3 5 4 12
323 4 12 4 12
343 13 5 13 5 
```

* * *

**更新：**

这是一个可用于组合多个文件的脚本。

做出了以下假设：

*   索引文件已排序
*   vcf 文件按其第二列排序
*   文件名中没有空格（或任何其他特殊字符）

将以下脚本保存到一个文件中，例如`report.sh`，从包含您的文件的目录中运行它而不使用任何参数。

```
#!/bin/bash

INDEX_FILE=index    # the name of the file containing the index data
REPORT_FILE=report  # the file to write the report to
TMP_FILE=$(mktemp)  # a temporary file

header="Position"   # the report header
num_processed=0     # the number of files processed so far 

# loop over all files beginning with "file". 
# this pattern can be changed to something else e.g. *.vcf
for file in file*
do
    echo "Processing $file"
    if [[ $num_processed -eq 0 ]]
    then
        # it's the first file so use the INDEX file in the join
        join -e' ' -t, -1 1 -2 2 -a 1 -o 0,2.4,2.6 <(sort -n "$INDEX_FILE") <(sed 's/ \+/,/g' "$file") > "$TMP_FILE"
    else
        # work out the output fields
        for ((outputFields="0",j=2; j < $((2 + $num_processed * 2)); j++))
        do
            outputFields="$outputFields,1.$j"
        done
        outputFields="$outputFields,2.4,2.6"

        # join this file with the current report
        join -e' ' -t, -1 1 -2 2 -a 1 -o "$outputFields" "$REPORT_FILE" <(sed 's/ \+/,/g' "$file") > "$TMP_FILE"
    fi
    ((num_processed++))
    header="$header,File${num_processed}_Ref,File${num_processed}_Alt"
    mv "$TMP_FILE" "$REPORT_FILE"
done

# add the header to the report
echo "$header" | cat - "$REPORT_FILE"  > "$TMP_FILE" && mv "$TMP_FILE" "$REPORT_FILE"

# the report is a csv file. Uncomment the line below to make it space-separated.
# tr ',' ' ' < "$REPORT_FILE"  > "$TMP_FILE" && mv "$TMP_FILE" "$REPORT_FILE" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:47:32.933

此 Perl 解决方案将处理 1 个或更多 (50) 个文件。

```
#!/usr/bin/perl
use strict;
use warnings;
use File::Slurp qw/ slurp /;
use Text::Table;

my $path = '.';
my @file = qw/ o33.txt o44.txt /;
my @position = slurp('index.txt') =~ /\d+/g;
my %data;

for my $filename (@file) {
    open my $fh, "$path/$filename" or die "Can't open $filename $!";
    while (<$fh>) {
        my ($pos, $ref, $alt) = (split)[1, 3, 5];
        $data{$pos}{$filename} = [$ref, $alt];
    }
    close $fh or die "Can't close $filename $!";
}

my @head;
for my $file (@file) {
    push @head, "${file}_Ref", "${file}_Alt";
}

my $tb = Text::Table->new( map {title => $_}, "Position", @head);

for my $pos (@position) {
    $tb->load( [
                $pos,
                map $data{$pos}{$_} ? @{ $data{$pos}{$_} } : ('', ''), @file
               ]
    );
}
print $tb; 
```

# c - 使用 ZeroMQ 和 ProtocolBuffers 发送结构

> ID：12625119
> 
> 赞同：0
> 
> 时间：2012-09-27T15:42:18.750
> 
> 标签：c, protocol-buffers, zeromq

我正在编写一个应该通过 ZeroMQ 发送 C 结构的程序。因此，我使用 Google 的 ProtocolBuffers 来序列化结构。

我现在确实有我的订户端没有收到任何东西的问题。发布者打印出“消息已成功发送”，所以我认为错误发生在订阅者端。

出版商：

```
int main (void)
{
    Message protomsg = MESSAGE__INIT;
        void *buf;
    unsigned len;

        void *context = zmq_ctx_new();
        void *subscriber = zmq_socket(context, ZMQ_PUB);
    zmq_bind(subscriber, "ipc://my.sock");

        //Initialising protomsg (not so important)

        //sending message

        len = message__get_packed_size(&protomsg);
    buf = malloc(len);
    message__pack(&protomsg, buf);

    zmq_msg_t output;
    zmq_msg_init_size(&output, len);
    zmq_msg_init_data(&output, buf, len, NULL, NULL);
    if(zmq_msg_send(&output, subscriber, 0) == -1)
        perror("Error sending message \n");
    else
        printf("Message successfully sent \n");
    zmq_msg_close(&output);
        free(buf);

        zmq_close (subscriber);
        zmq_ctx_destroy (context);
        return 0;
} 
```

订户：

```
 int main (void){
        Message *protomsg;
            void *context = zmq_ctx_new ();
            void *publisher = zmq_socket (context, ZMQ_SUB);
            zmq_connect(publisher, "ipc://my.sock");
            zmq_setsockopt(publisher, ZMQ_SUBSCRIBE, "", 0);

            // Read packed message from ZMQ.
        zmq_msg_t msg;
        zmq_msg_init(&msg);
        if(zmq_msg_recv(&msg, publisher, 0) == -1)
            perror("Error receiving message \n");
        else
            printf("Message received");
        memcpy((void *)protomsg, zmq_msg_data(&msg), zmq_msg_size(&msg));

            // Unpack the message using protobuf-c.
        protomsg = message__unpack(NULL, zmq_msg_size(&msg), (void *)&data);   
        if (protomsg == NULL)
        {
            fprintf(stderr, "error unpacking incoming message\n");
            exit(1);
        }

            printf("Address: %u, Type: %u, Information[0]: %u, Information[1]: %u \n", protomsg->address-48, protomsg->frametype, protomsg->information[0], protomsg->information[1]);
        zmq_msg_close (&msg);

        // Free the unpacked message
        message__free_unpacked(protomsg, NULL);

            //close context,socket..
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:10:53.277

不知道是否有人仍然关心这个，但是这里是......我同意@Steve-o 这是一个时间问题，尽管我认为问题是你过早地关闭了发布者套接字。

您的发布者代码发布消息，然后立即关闭套接字并终止上下文。所以消息在发布者中存在几毫秒，然后就永远消失了。

如果您首先运行发布者，它会执行此操作，退出并且消息消失。当您启动订阅者时，它会尝试连接到不再存在的 IPC 套接字。ZeroMQ 允许这样做，并且订阅者将阻塞，直到有 IPC 套接字可以连接。

我没有查看 ZeroMQ IPC 源代码，但我怀疑，在幕后，订阅者会定期尝试连接到发布者套接字。现在，如果您再次运行发布者，它可能会工作，但您会遇到严重的竞争状况。如果您在 ZeroMQ 工作程序尝试重试的确切时刻启动发布者，则连接可能会发生，您甚至可能在发布者销毁所有内容之前收到您的消息。

我很确定这个问题与结构和 protobuf 无关。从 ZeroMQ 的角度来看，您只是在发送字节。没有区别。如果您的 ZeroMQ 字符串测试用例与 ZeroMQ 结构的测试用例确实相同 - 那么代码更改可能会添加或删除能够以错误方式打破竞争条件的几纳秒。

具体建议：

*   将发布者中的套接字重命名为“发布者”而不是订阅者（复制/粘贴错误）
*   在 zmq_close （发布者）之前添加 30 秒的睡眠；
*   希望这将解决您的测试代码的问题
*   如果这不能解决问题，请考虑切换到 tcp 传输并使用[wireshark](http://www.wireshark.org)来诊断到底发生了什么。

# api - RESTful API 身份验证/安全性

> ID：12625121
> 
> 赞同：4
> 
> 时间：2012-09-27T15:42:22.380
> 
> 标签：api, google-app-engine, authentication, python-2.7, api-key

我正在为我在 GAE python 上的应用程序开发一个 RESTful API，现在我正试图找出保护这个 API 的最佳方法。我在这个应用程序上有自己的成员/身份验证机制。

做这个的最好方式是什么？

*   拥有公钥/私钥对
*   成为 OAuth 提供者
*   HTTP 身份验证（对我来说似乎很弱）
*   其他？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:56:05.337

您可以使用 Google 服务帐户进行用户身份验证。但是，人们仍然可以注册一个帐户并使用您的 API，您的应用引擎费用肯定会上涨。他们刚刚在 Google I/O 2012 上介绍了 Google Cloud Endpoints。您将拥有一个仅在您的客户端应用程序（Android、iOS）上使用的客户端 ID。

[Google I/O 2012 - 使用 Yaniv Inbar 和 Sriram Saroop 构建使用 Web API 的 Android 应用程序](http://www.youtube.com/watch?v=dylFNrvZ_3U)

[Google I/O 2012 - 为 Android、iOS 和 Web 构建移动应用引擎后端](http://www.youtube.com/watch?v=NU_wNR_UUn4)

如果您有兴趣，您应该尝试在以下位置注册受信任的测试人员

[http://endpoints-trusted-tester.appspot.com/](http://endpoints-trusted-tester.appspot.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T04:34:41.927

首先，丢弃 HTTP Auth。不建议在真正的 REST API 中使用它，因为它驻留在 cookie 上。

我会选择 OAuth。有一个名为[appengine_oauth_provider](https://github.com/mohangk/appengine_oauth_provider)的库，它可以帮助您开始实现自己的提供程序。

# .net - 如何使用 .net 中的 RX 扩展来使用 UDP 字节流

> ID：12625126
> 
> 赞同：3
> 
> 时间：2012-09-27T15:42:30.853
> 
> 标签：.net, vb.net, udp, system.reactive, dispose

我想出了这个解决方案。（尚未测试）通过网络上的大量弹跳。

```
Private Function ObserveUDP() As IObservable(Of bytes())

    Dim f = Function(observer)
                Dim endpoint = New IPEndPoint(IPAddress.Parse(Me.IpAdress), Me.IPPort)
                Dim client = New UdpClient(endpoint)

                Dim obs = observable.*emphasized text*Generate(Of Task(Of UdpReceiveResult), UdpReceiveResult) _
                      ( Nothing _
                      , Function(task As Task(Of UdpReceiveResult)) task Is Nothing Or Not task.IsCompleted() _
                      , Function(task As Task(Of UdpReceiveResult)) client.ReceiveAsync() _
                      , Function(task As Task(Of UdpReceiveResult)) task.Result)

                Dim observable = obs.Select(Function(r) r.Buffer)

                dim handle = observable.Subscribe(observer)

                Dim df = Sub() 
                    client.Close()
                    handle.Dispose()
                End Sub

                Return Disposable.Create(df)

    End Function

    Return observable.Create(f)

End Function 
```

我的要求是确保在订阅被删除时关闭 UDP 客户端。我很确定上面的代码很接近，但我认为它不太正确。任何输入将不胜感激。

*** 编辑 ***

其实上面的例子是完全错误的，只会同步创建大量的任务对象，而不是等待它们。经过一番反复试验，我提出了以下通用函数，用于展开一个被一遍又一遍地调用的等待对象。任何意见？

```
''' initializer - a function that initializes and returns the state object
''' generator   - a function that asynchronously using await generates each value
''' finalizer   - a function for cleaning up the state object when the sequence is unsubscribed

Private Function ObservableAsyncSeq(Of T, I)( _
    initializer As Func(Of I), _
    generator As Func(Of I, Task(Of T)), _
    finalizer As Action(Of I))  As IObservable(Of T)

    Dim q = Function(observer As IObserver(Of T))
                Dim go = True
                Try
                    Dim r = Async Sub()
                                Dim ii As I = initializer()
                                While go
                                    Dim result = Await generator(ii)
                                    observer.OnNext(result)
                                End While
                                finalizer(ii)
                                observer.OnCompleted()
                            End Sub
                    Task.Run(r)
                Catch ex As Exception
                    observer.OnError(ex)
                End Try

                ' Disposable for stopping the sequence as per
                ' the observable contract
                Return Sub() go = False

            End Function

    Return Observable.Create(q)
End Function 
```

以及与 UDP 一起使用的示例

```
Private Function ObserveMeasurementPoints2() As IObservable(Of ProcessedDate)
    Dim initializer = Function()
                          Dim endpoint = New IPEndPoint(IPAddress.Parse(Me.IpAdress), Me.IPPort)
                          Return New UdpClient(endpoint)
                      End Function

    Dim finalizer = Function(client As UdpClient)
                        client.Close()
                    End Function

    Dim generator = Function(client As UdpClient) As Task(Of UdpReceiveResult)
                        Return client.ReceiveAsync()
                    End Function

    Return ObservableAsyncSeq(initializer, generator, finalizer).Select(Function(r) ProcessBytes(r.Buffer))

End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:29:34.550

您可以使用`Observable.Using`提到的 Enigmativity 或简单地使用接受 an作为返回参数的常规`Observable.Create`方法- 这足以安全处理。`IDisposable`

使用迭代器或异步非常好。我列出了一种更类似于 Rx 的方法来做到这一点：

```
Public Shared Function UdpStream(Of T)(endpoint As IPEndPoint, processor As Func(Of Byte(), T)) As IObservable(Of T)
    Return Observable.Using(Of T, UdpClient)(
        Function() New UdpClient(endpoint),
        Function(udpClient) _
            Observable.Defer(Function() udpClient.ReceiveAsync().ToObservable()) _
            .Repeat() _
            .Select(Function(result) processor(result.Buffer))
    )
End Function 
```

传统方式：

```
Public Shared Function UdpStream(Of T)(endpoint As IPEndPoint, processor As Func(Of Byte(), T)) As IObservable(Of T)
    Return Observable.Using(
        Function() New UdpClient(endpoint),
        Function(udpClient) Observable.Defer( _
        Observable.FromAsyncPattern(
            AddressOf udpClient.BeginReceive,
            Function(iar)
                Dim remoteEp = TryCast(iar.AsyncState, IPEndPoint)
                Return udpClient.EndReceive(iar, remoteEp)
            End Function)
        ).Repeat() _
         .Select(processor)
    )
End Function 
```

测试：

```
Shared Sub Main()
    Using UdpStream(New IPEndPoint(IPAddress.Loopback, 13200),
                    Function(bytes) String.Join(",", bytes)
                    ).Subscribe(AddressOf Console.WriteLine)
        Console.ReadLine()
    End Using

    Console.WriteLine("Done")
    Console.ReadKey()
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T00:19:55.780

看一下`Observable.Using`- 它专门用于创建一个使用一次性资源生成其值的可观察对象，并在完成后自动处理资源。

您会发现`UdpClient`具有相同的`Close`&`Dispose`方法实现，因此`Close`如果您调用`Dispose`.

从反射器：

```
void IDisposable.Dispose()
{
    this.Dispose(true);
}

public void Close()
{
    this.Dispose(true);
} 
```

这是 的签名`Using`：

```
Public Shared Function Using(Of TSource, TResource As IDisposable)(
    ByVal resourceFactory As Func(Of TResource),
    ByVal observableFactory As Func(Of TResource, IObservable(Of TSource)))
        As IObservable(Of TSource) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T09:27:39.073

我以前没有使用过 UDPClient，但您似乎正在使用任务（基数 =1）来尝试接收数据流（基数 = 很多）。似乎可以解决这个问题，您重复了查询。这意味着您的查询将执行此操作

1.  创建一个UDP客户端
2.  调用数据请求
3.  接收它获得的第一个数据
4.  将数据推送到序列上
5.  关闭序列
6.  处理 UDPClient
7.  创建 UDPClient（返回步骤 1）
8.  调用数据请求
9.  接收它获得的第一个数据
10.  ....直到您处理连接。

我认为您应该能够通过拉入字节流来读取套接字/网络连接。我在我的博客文章中向您展示了如何做到这一点：

[http://introtorx.com/Content/v1.0.10621.0/15_SchedulingAndThreading.html#CreatingYourOwnIterator](http://introtorx.com/Content/v1.0.10621.0/15_SchedulingAndThreading.html#CreatingYourOwnIterator)

这样，您只需打开一个连接并在收到字节时推送它们。

快速谷歌一下，我还发现对 UDPClient 实现的可靠性存在担忧。 [http://www.codeproject.com/Articles/1938/Issues-with-UdpClient-Receive](http://www.codeproject.com/Articles/1938/Issues-with-UdpClient-Receive)

高温高压

李

```
using System;
using System.IO;
using System.Reactive.Concurrency;
using System.Reactive.Disposables;
using System.Reactive.Linq;

namespace MyLib
{
    public static class ObservableExtensions
    {
        //TODO: Could potentially upgrade to using tasks/Await-LC
        public static IObservable<byte> ToObservable(
            this Stream source,
            int buffersize,
            IScheduler scheduler)
        {
            var bytes = Observable.Create<byte>(o =>
            {
                var initialState = new StreamReaderState(source, buffersize);
                var currentStateSubscription = new SerialDisposable();
                Action<StreamReaderState, Action<StreamReaderState>> iterator =
                (state, self) =>
                    currentStateSubscription.Disposable = state.ReadNext()
                        .Subscribe(
                            bytesRead =>
                            {
                                for (int i = 0; i < bytesRead; i++)
                                {
                                    o.OnNext(state.Buffer[i]);
                                }
                                if (bytesRead > 0)
                                    self(state);
                                else
                                    o.OnCompleted();
                            },
                            o.OnError);
                var scheduledWork = scheduler.Schedule(initialState, iterator);
                return new CompositeDisposable(currentStateSubscription, scheduledWork);
            });
            return Observable.Using(() => source, _ => bytes);
        }

        private sealed class StreamReaderState
        {
            private readonly int _bufferSize;
            private readonly Func<byte[], int, int, IObservable<int>> _factory;
            public StreamReaderState(Stream source, int bufferSize)
            {
                _bufferSize = bufferSize;
                _factory = Observable.FromAsyncPattern<byte[], int, int, int>(
                source.BeginRead,
                source.EndRead);
                Buffer = new byte[bufferSize];
            }
            public IObservable<int> ReadNext()
            {
                return _factory(Buffer, 0, _bufferSize);
            }
            public byte[] Buffer { get; set; }
        }
    }
} 
```

# wcf - 仅限于一个客户端/连接

> ID：12625128
> 
> 赞同：1
> 
> 时间：2012-09-27T15:42:39.697
> 
> 标签：wcf, silverlight, iis

我花了 2 天时间寻找解决此问题的方法。似乎在 SilverLight 应用程序中调用 WCF 目前仅限于 1 个客户端，而它与使用 WCF 的控制台应用程序完美配合。

目前问题尚不清楚，我什至不知道必须遵循哪种方法。

**环境**

操作系统：Windows 2008 R2 Enterprise、Silver Light 4、C# 4、IIS：7.5

**应用架构**

*   由控制台应用程序托管的 WCF 服务

    ```
    [OperationContract]
    string DoConnect(int id, string who); 
    ```

*   Silver Light 应用程序在 IIS 托管的按下按钮上以异步方式引用/调用 WCF。

    ```
    private void MultipleConnection(object sender, RoutedEventArgs e1)
    {
        WCFServicesX3Ref.WCFServicesX3Client client = new WCFServicesX3Ref.WCFServicesX3Client();
        client.DoConnectCompleted += (s,e) =>
        {
            if (e.Result == null){ MessageBox.Show("Not Connected");}
            else{MessageBox.Show(e.Result);}
        };
        client.DoConnectAsync(Convert.ToInt32(whoid.Text),winToLoad.Text);
    } 
    ```

*   控制台应用程序在启动时以同步方式引用/调用 WCF。

    ```
    Console.WriteLine("Beginning...");
    Ref.WCFServicesX3Client client = new Ref.WCFServicesX3Client();
    client.DoConnect(1, "User 1");
    client.DoConnect(2, "User 2");
    client.DoConnect(3, "User 3");
    client.Close(); 
    ```

**应用程序行为/问题**

由控制台应用程序托管的 WCF 已启动并等待...

我使用本地地址上的 Internet browner 连接到由 IIS 托管的 Silver Light 应用程序，然后按“按钮”调用 WCF --> 返回 OK

在相同的本地地址上打开一个新网页：显示 Silver light 应用程序，然后按“按钮：调用 WCF --> 不返回任何内容 - 调用没有错误或异常返回。

我可以启动几个客户端控制台应用程序（同步模式），问题没有出现。

**问题**

异步模式是否需要手动关闭（我虽然它是自动完成的）？

是 IIS 配置/参数化的问题吗？如果您知道我应该将测试/搜索的重点放在哪里，欢迎您:)。

谢谢。

# json - Json数据和html表

> ID：12625129
> 
> 赞同：1
> 
> 时间：2012-09-27T15:42:40.020
> 
> 标签：json, foreach, html-table

我有这个结构：

HTML部分：

```
<table id="table_div" class="table table-striped table-condensed"><tbody></tbody></table> 
```

JS部分：

```
var data = json_response['data'];

  $("#table_div").html('<thead><tr><td>TIMESTAMP</td><td>VALUE</td></tr></thead>');

  $.each(data, function(index, value) {
    $('#table_div > tbody:last').append('<tr><td>' + value + '<td></tr>'); 
  }); 
```

现在，我的矢量数据取自 java 控制台，例如：

```
{"data": [[1348754599, 0.0], [1348754639, 0.0], [1348754680, 0.0], [1348754721, 0.0], [1348754761, 0.0], [1348754802, 0.0], [1348754842, 0.0], [1348754883, 0.0], [1348754924, 0.0], [1348754964, 0.0], [1348755005, 0.0], [1348755045, 0.0], [1348755086, 0.0], [1348755126, 0.0], [1348755167, 0.0], [1348755208, 0.0]]} 
```

而此时的结果是时间戳和值都在 TIMESTAMP 下，但列 VALUE 为空。

```
TIMESTAMP   VALUE 
```

1348756790,0
1348756830,0
1348756871,0
1348756911,0
1348756952,0
1348756992,0
1348757033,0

我该怎么做才能拥有

```
Timestamp Value
12876      0
129487     1 
```

非常感谢你！

****编辑****

这是现在生成的html：

```
<table id="table_div" class="table table-striped table-condensed"><tbody><tr><td>TIMESTAMP</td><td>VALUE</td></tr><tr><td>1348760408,0</td><td></td></tr><tr><td>1348760448,0</td><td></td></tr></tbody></table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:50:19.707

我之前的回答是假的。我记错了如何`$.each()`工作。

您的原始代码是正确的，只是您没有将每个元素部分分解为其时间戳和值组件。我认为这段代码会做你想做的事：

```
 $("#table_div").html('<thead><tr><td>TIMESTAMP</td><td>VALUE</td></tr></thead>');

  $.each(data, function(index, value) {
    $('#table_div > tbody:last').append('<tr><td>' + value[0] + '</td><td>' + value[1] +'</td></tr>'); 
  }); 
```

# javascript - 全局处理 jQuery AJAX 错误

> ID：12625133
> 
> 赞同：0
> 
> 时间：2012-09-27T15:42:50.010
> 
> 标签：javascript, ajax, jquery, error-handling

你们对全局处理 AJAX 错误有什么想法，在控制台中显示任何/所有信息？

截至目前，我做这样的事情：

```
jSpace._displayAjaxErrors = function (xhrResponseText) {

    var errObj = $.parseJSON(xhrResponseText);

    // _log is an internal console log that won't break in IE (aka does nothing)
    _self._log('\n -- AJAX ERROR @ ' + _self._getTimeStamp() + ' --');

    _self._log('ExceptionType : '   + errObj.ExceptionType);
    _self._log('Error Message : '   + errObj.Message);
    _self._log('StackTrace    : \n' + errObj.StackTrace);​

    // then a dialogBox here
}; 
```

每个`.ajax()`人目前都包括以下内容：

```
error: function (xhr, status, error) {
    jSpace._displayAjaxErrors(xhr.responseText);
} 
```

我不熟悉[.ajaxError()](http://api.jquery.com/ajaxError/)，**但想知道是否有更好的方法来完成这一切！**

**您如何轻松查看错误是什么/在哪里？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:51:25.433

jQuery 已经提供`ajaxError`了全局捕获所有 ajax 错误的功能，你只需要使用它

```
$( "div.log" ).ajaxError(function(e, jqxhr, settings, exception) {
  //e for event 
  //jqxhr for xhrResponse
}); 
```

[http://api.jquery.com/category/ajax/global-ajax-event-handlers/](http://api.jquery.com/category/ajax/global-ajax-event-handlers/)

# java - 在 dwr addRows 函数中处理 java List

> ID：12625135
> 
> 赞同：0
> 
> 时间：2012-09-27T15:42:57.513
> 
> 标签：java, javascript, ajax, dwr

我正在调用 ajaxcontroller 从服务器获取数据。ajaxController.fetchCounts(callFetchcounts);

callFetchcounts，一旦我得到数据，这个函数就会被调用。我是这样处理的：

```
var callFetchcounts = function(data) {
if( data.length > 0){
    dwr.util.addRows("rounded-corner",[data] , cellFuncs, { escapeHtml:false });
}}

var cellFuncs = [
 function(data) {return data.category},
 function(data) {return data.count},
 function(data) {return "<a href=''>Edit</a>"}
]; 
```

从 ajaxController 我将获得对象列表。（我什至可以获得对象数组。）我想填充一个表，其中行数 = 结果列表/数组中的元素数。列数 = 每个列表对象中的元素数。我想用 List 对象的数据填充列。

这该怎么做？我在这里感到震惊。谁能帮我举个例子。

谢谢，蒂鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T08:27:22.380

这应该会有所帮助 - [http://www.packtpub.com/article/dwr-java-ajax-user-interface-basic-elements-part2](http://www.packtpub.com/article/dwr-java-ajax-user-interface-basic-elements-part2) :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T14:46:58.083

你几乎完成了你的使命！
您需要做的就是在代码上调整几个点，检查一下：

```
function fillTable(data) {
		if( data.length > 0){
			var cellFuncs = [
			 function(data) {return data.category},
			 function(data) {return data.count},
			 function(data) {return "<a href='#'>Edit</a>"}
			];

			// You don't have to use [data] if data is a list(array) of objects
			// User [data] only if data is a single object
			dwr.util.addRows("rounded-corner", data , cellFuncs, { escapeHtml:false });
		}
}
```

# c++ - ro 如何声明一个指向函数的成员

> ID：12625136
> 
> 赞同：0
> 
> 时间：2012-09-27T15:43:08.963
> 
> 标签：c++

```
#define SYNC_DATA_CB list<string> (*syncData)(void) 
```

我想在我的类中有一个成员（静态与否无关紧要），它将保存对函数指针的引用。

我试图这样声明，但没有编译：

```
SyncProcess{
  public:
   SyncProcess(SYNC_DATA_CB);
   static SYNC_DATA_CB sync_cb_;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:50:02.580

我认为您可能正在寻找的是 typedef 。

```
typedef list<string>(*syncData)(void);

class SyncProcess{
  public:
   SyncProcess( syncData );
   static syncData sync_cb_;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:49:54.597

```
std::function<list<string> (void)> myPointer; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:50:45.563

使用 typedef 而不是宏：

```
class SyncProcess
{
public:    

   // Typedef to create function pointer alias SyncDataFunc
   typedef list<string>(*SyncDataFunc)();

   // Use alias as input parameter type
   SyncProcess(SyncDataFunc func);

   // Use alias as static member type
   static SyncDataFunc sync_cb_;
}; 
```

# python - 管理民俗学的图书馆/平台？

> ID：12625138
> 
> 赞同：4
> 
> 时间：2012-09-27T15:43:11.803
> 
> 标签：python, tags, taxonomy, ontology, folksonomy

我正在构建一个涉及重要用户和自动标记服装的应用程序。

结构一般如下：

```
[Category Tag]
exclusive=true
values=pants,shirt,shoe,tie,etc 
```

因此，基本上任何单个项目都将使用每个“类别”中的 1 个或多个标签进行标记。一类标签可以围绕互斥等定义规则。

我已经准备好了一些东西，但是由于这个标记机制已经在项目中有机地发展了，它的设计并没有很好地发挥它现在在我们的应用程序中扮演的核心角色。

在我重新设计它之前，我想知道是否有人知道一个库或平台（最好是易于与 python 互操作的），它将允许：

*   创建/添加标签和类别
*   将元数据添加到类别以允许执行规则集（互斥）
*   理想情况下，很容易序列化数据集以供客户使用

有什么建议么？

# vba - VBA：运行时错误 55 - 文件已打开（通过使用 FileDialog）

> ID：12625140
> 
> 赞同：0
> 
> 时间：2012-09-27T15:43:24.090
> 
> 标签：vba, ms-access, import, runtime-error, text-files

在 VBA Ms Access 中，我导入一个 txt 文件逐行解析它。

我使用 FileDialog 以便用户可以选择要导入的文件，但是当我打开文件来读取它时，我收到运行时错误 55 - 文件已打开。

费用是：

```
Dim openDialog As FileDialog

Set openDialog = Application.FileDialog(msoFileDialogFilePicker)
On Error GoTo DoNothing
With openDialog
   .title = "Import"
   .AllowMultiSelect = False
   .Show
End With

FName = openDialog.SelectedItems.Item(1)
'Close FName

Open FName For Input Access Read As #1
On Error GoTo DoNothing 
```

相反，如果我使用 Close Fname，则不会出现运行时错误，但导入不起作用（导入的代码是正确的，因为当我对名称文件进行硬编码时它会起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:47:28.900

获得文件名后，使用以下命令删除对话框处理程序：

```
Set openDialog = Nothing 
```

# java - 如何仅在硒网格中运行一种测试方法

> ID：12625143
> 
> 赞同：0
> 
> 时间：2012-09-27T15:43:27.183
> 
> 标签：java, selenium, junit, selenium-grid, surefire

我正在使用 JUnit 4.8.1 和 Surefire 2.8.1。在我的机器上，我只能通过以下方式运行一种测试方法：

`$$ mvn clean test -Dtest=TestClass#TestMethod`

但是在网格配置中运行相同的命令时，TestClass 中的所有测试都会运行。

pom的唯一区别是

```
<configuration>
   <parallel>both</parallel>
</configuration> 
```

Surefire 插件中的配置。

任何想法，我如何在网格中只运行一种测试方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T16:46:41.157

可能的解决方案是使用`@Categories`注释。但我使用简单的网络驱动程序（不是网格）。[尝试在此处](http://johndobie.blogspot.com/2012/04/unit-and-integration-tests-with-maven.html)逐步设置

这个想法如下：您注释一组要排除的测试，然后在 POM 文件中显示您以类似的方式排除它们：

```
<configuration>
<excludes>
<exclude>blablabla.class</exclude>
</excludes>
</configuration> 
```

希望这对您有所帮助。

# metadata - Tridion CoreService 创建组件缺少元数据

> ID：12625144
> 
> 赞同：7
> 
> 时间：2012-09-27T15:43:31.647
> 
> 标签：metadata, tridion

**我得到异常 = {“无法找到 uuid：5708986b-390f-4728-b0c7-b49bd3d8f407：元数据。”}**

```
schemaId = UpdatePubId(schemaId, containerId);
SchemaData schemaData = (SchemaData)client.Read(schemaId, null);
string xml = string.Format("<{0} xmlns=\"{1}\">{2}</{0}>", schemaData.RootElementName, schemaData.NamespaceUri, fields);

ComponentData componentData = new ComponentData
{
    Content = xml,
    ComponentType = ComponentType.Normal,
    Title = title,
    Schema = new LinkToSchemaData { IdRef = schemaId },
    LocationInfo = new LocationInfo { OrganizationalItem = new LinkToOrganizationalItemData { IdRef = containerId } },
    Id = "tcm:0-0-0", 
    MetadataSchema = schemaData.MetadataSchema,
    Metadata = schemaData.Metadata
};

try
{
    componentData = client.Save(componentData, new ReadOptions()) as ComponentData;
    componentData = client.CheckIn(componentData.Id, new ReadOptions()) as ComponentData;
    message.Set("Component", title + ", successfully");
}
catch (Exception exception)
{
    message.Set("Component", exception.Message);
} 
```

感谢 Tridion 专家

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T16:27:35.417

您在正确的路径上，但错误表明您没有为您尝试创建的组件提供元数据字段。

此行不正确：

```
Metadata = schemaData.Metadata 
```

它应该非常像您创建内容字段的那个：

```
Metadata = String.Format("<Metadata xmlns=\"{0}\">{1}</Metadata>",schemaData.NamespaceUri, "YOUR METADATA XML") 
```

# javascript - Zoomy 脚本在 Joomla K2 站点中不起作用

> ID：12625145
> 
> 赞同：0
> 
> 时间：2012-09-27T15:43:32.477
> 
> 标签：javascript, jquery-plugins, joomla, joomla-k2

我有一个 Joomla K2 站点，当用户单击 K2 中的图像时，它应该在带有 k2 的弹出窗口中打开。但现在这不再起作用了，问题出在 Zoomy 脚本中。这是[我网站上的一个项目，](http://zasvadba.mk/kategorii/ketering/%D1%82%D0%B5%D1%82%D0%BA%D0%B0-%D0%B1%D0%B8%D0%B1%D0%B5%D1%80%D1%87%D0%B5.html)任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:54:33.127

好吧，我认为问题在于您有 5 个版本的 jQuery 正在运行大声笑。如果您使用 Firebug 或 Chrome 的扩展程序打开源代码，您将能够看到。如果您的扩展有 jQuery 参数，请关闭其中的 4 个，否则使用以下代码确保它只嵌入一次：

```
<?php
  // load jQuery, if not loaded before
  if(!JFactory::getApplication()->get('jquery')){
    JFactory::getApplication()->set('jquery',true);
    $document =& JFactory::getDocument();
    $document->addScript(JURI::root() . "path_to_file/jquery-1.8.2.js");
  }
?> 
```

**更新：**

以下是嵌入的 jQuery 文件：

1.  ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js
2.  ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js
3.  /plugins/content/plg_zoomin/plg_zoomin/jquery-1.5.min.js
4.  /modules/mod_sj_k2_accordion/assets/js/jquery-1.5.min.js
5.  /plugins/system/onexitpopup/js/jquery.1.7.1.js

我不确定 2 个 googleapis 来自哪里，但 1 个来自一个名为的模块`mod_sj_k2_accordion`，其他来自 2 个插件。因此，找到插件并删除 jQuery 引用或添加我在上面发布的代码。如果您确实使用我上面发布的代码，请确保更改**路径**。

# iphone - 使用 Restkit 和 Core 数据检索图像

> ID：12625146
> 
> 赞同：0
> 
> 时间：2012-09-27T15:43:31.973
> 
> 标签：iphone, objective-c, ios, uiimage, restkit

我有一个核心数据应用程序，它使用休息工具包从 Web 服务中检索数据。我从 web 服务得到的响应是这样的 json 字符串 -

```
"nodeRef": "workspace:\/\/SpacesStore\/b1d51831-990d-47a8-a018-f1c1bg33f594",
        "type": "document",
        "name": "x.jpg",
        "displayName": "x.jpg",
        "title": "myTestProject", 
```

（这是图像周围的一些元数据。如果我想检索此图像，那么我应该使用此 url 访问它 - [http://x.co.uk/share/proxy/alfresco/api/node/workspace/SpacesStore/ b1d51831-990d-47a8-a018-f1c1bg33f594/content/thumbnails/ipad1024?c=force](http://x.co.uk/share/proxy/alfresco/api/node/workspace/SpacesStore/b1d51831-990d-47a8-a018-f1c1bg33f594/content/thumbnails/ipad1024?c=force)） - 注意我稍微更改了 URL，因此您将无法访问它。您还需要进行身份验证才能访问 URL。所以我想知道如何获取此图像并将其本地存储在我的 SQLite DB 上？我显然可以访问该 URL，但我究竟如何提示它下载图像

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T20:03:41.363

我在这种情况下所做的是对图像进行延迟加载，例如：

```
image=[UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:self.absoluteUri]]];
NSData *imageData=UIImageJPEGRepresentation(image, JPGCompression); 
```

然后存储它。在 Restkit 之外。这是不久前的事，但它对我有用。基本上从restkit中提取URL，当图像显示在屏幕上时进行延迟加载，然后在加载一次后将其存储回核心数据（或任何地方）。希望这可以帮助。

# c++ - 常见的父类型 ifstream 和 ofstream

> ID：12625148
> 
> 赞同：1
> 
> 时间：2012-09-27T15:43:32.940
> 
> 标签：c++, file, c++11, stream

我有一个包含 an`std::ofstream`和 an的类`std::ifstream`（一次只能激活一个）。我想重载`operator()`以返回当前的活动流。但是什么是`std::ofstream`和`std::ifstream`返回公共引用的公共基类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T17:11:55.247

*我想重载 operator() 以返回当前的活动流*这绝对没有意义，而且闻起来像一个设计缺陷。你为什么要退货？该运算符的调用者应该能够对返回值做什么？它既不能输入也不能输出。

我不知道你真正想做什么，但也许这样的事情对你有用，虽然它很危险

```
template<typename T> class wrapper
{
  T*const ptr;
  wrapper(T*p) : ptr(p) {}
public:
  bool empty() const { return ptr; }
  operator T& () const
  {
    if(empty()) throw some_exception("trying to use empty wrapper");
    return *ptr;
  }
  friend some_class;
};

class some_class
{
   ifstream _ifstream;
   ofstream _ofstream;
   bool ifstream_is_active;
   bool ofstream_is_active;
public:
   operator wrapper<ifstream> () const
   { wrapper<ifstream>(ifstream_is_active? &_ifstream : 0); }
   operator wrapper<ofstream> () const
   { wrapper<ofstream>(ofstream_is_active? &_ofstream : 0); }
}; 
```

但这很危险，因为您可能正在处理悬空指针。您可以通过使用`shared_ptr`（自己解决）来避免这种情况，但这意味着`some_class`不再控制这些流的生命周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:56:48.083

输入和输出流是非常不同的类型。它们共享的唯一通用基类是[`std::ios`](http://en.cppreference.com/w/cpp/io/basic_ios). 除了一些错误检查之外，它并没有太多内容。

这两种流类型只共享最基本的接口。出于显而易见的原因，它们彼此之间几乎没有关系。

# android - 为什么 OnItemClickLIstener 不适用于 PullToRefreshLIstView？

> ID：12625155
> 
> 赞同：2
> 
> 时间：2012-09-27T15:43:47.683
> 
> 标签：android

我正在使用以下代码：-

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.newsfeed);
    setAllControlls();
     myPrefs = this.getSharedPreferences(
            AppConstants.MYPREF, MODE_WORLD_READABLE);
    userid = myPrefs.getString(AppConstants.USER_ID, "");

    if(checkInternet(NewFeeds.this))
    {
      new callNewsfeeddata().execute(userid);
    }
    else
    {
        Toast.makeText(NewFeeds.this,"Please Check Your Internet Connection",Toast.LENGTH_LONG).show();
    }

    objlistview.setOnRefreshListener(new OnRefreshListener() {

        @Override
        public void onRefresh() {
            if(checkInternet(NewFeeds.this))
            {
                new callNewsfeeddata().execute(userid);
            }
            else
            {
                Toast.makeText(NewFeeds.this,"Please Check Your Internet Connection",Toast.LENGTH_LONG).show();
            }
        }
    });

    objHandler = new Handler() {
        public void handleMessage(Message msg) {
            switch (msg.what) {
            case AppConstants.UPDATE_ADDRESS:
                if (!((String) msg.obj).equals("0")) {
                    System.out.println("inside---" + objlocationvalue);
                    objlocationvalue = (String) msg.obj;
                } else {
                    objlocationvalue = "1";
                }
                break;
            }
        }
    };
    objLocationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
}

private void setAllControlls() {

    objlistview = (PullToRefreshListView) findViewById(R.id.newsfeedlistview);
    objlistview.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int pos,
                long arg3) {

            int pos1=pos-1;

            NewsFeedModle objnewsfeedmodle = objlist.get(pos);
            String type = objnewsfeedmodle.getType();
            if(type.equalsIgnoreCase("job"))
            {
                String postid = objnewsfeedmodle.getJobId();
                Intent objintent = new Intent(NewFeeds.this,ShowNewPostJobDetails.class);
                Bundle objbundle = new Bundle();
                objbundle.putString("postid", postid);
                objbundle.putString("from","newsfeed");
                objintent.putExtras(objbundle);
                startActivity(objintent);
            }
            if(type.equalsIgnoreCase("deals"))
            {
                String postid = objnewsfeedmodle.getDealid();
                Intent objintent = new Intent(NewFeeds.this,ShowNewFindDeal.class);
                Bundle objbundle = new Bundle();
                objbundle.putString("postid", postid);
                objbundle.putString("from","newsfeed");
                objintent.putExtras(objbundle);
                startActivity(objintent);
            }
            if(type.equalsIgnoreCase("stuff"))
            {
                String postid = objnewsfeedmodle.getStuffId();
                Intent objintent = new Intent(NewFeeds.this,ShowNewFindStuff.class);
                Bundle objbundle = new Bundle();
                objbundle.putString("postid", postid);
                objbundle.putString("from","newsfeed");
                objintent.putExtras(objbundle);
                startActivity(objintent);
            }

        }
    });
}

private class callNewsfeeddata extends
        AsyncTask<String, Void, List<NewsFeedModle>> {
    ProgressDialog objprogress = new ProgressDialog(NewFeeds.this);
    AppRequestHandler objApprequest = new AppRequestHandler();

    List<NewsFeedModle> objresponce = new ArrayList<NewsFeedModle>();

    @Override
    protected void onPreExecute() {
        objprogress.setMessage("Please Wait While Loading...");
        objprogress.show();
    }

    @Override
    protected List<NewsFeedModle> doInBackground(String... params) {
        objresponce = objApprequest.newsFeedRequest(params[0]);
        return objresponce;
    }

    @Override
    protected void onPostExecute(List<NewsFeedModle> result) {
        if (objprogress.isShowing()) {
            objprogress.dismiss();
        }
        if(objlist!=null && objlist.size()!=0)
        {
            objlist.clear();    
        }
        String msgcount="";
        if (result != null) 
          {
            objlist=result;
            if(objlist.size()==0)
            {
                Log.i("check",""+objlist.size());
                Log.i("check22222",""+result.size());
            }
            if(objlist!=null && objlist.size()!=0)
            {
             msgcount = objlist.get(0).getMessagescount();  
            }
            TabActivity tab=(TabActivity) getParent();
            TextView tv=(TextView) tab.findViewById(R.id.notificationmsg);
            tv.setText(msgcount);
            Editor objedit = myPrefs.edit();
            objedit.putString(AppConstants.MESSAGECOUNT, msgcount);
            objedit.commit();
            objnewsFeedAdapter = new NewsFeedAdapter(NewFeeds.this,objlist,(float)objlattvalue,(float)objlongvalue,objlocationvalue);
            objlistview.setAdapter(objnewsFeedAdapter);
            objnewsFeedAdapter.notifyDataSetChanged();
            objlistview.onRefreshComplete();
        }
    }
} 
```

我在 setAllContrill 方法中定义了 OnItemClickLIstener 但它不起作用。listView 无法点击任何人建议我。我正在使用 github pulltorefresh 代码。我无法找出问题所在，因为在其他地方它正在工作..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:08:31.773

试试：`

```
objlistview.getRefreshableView().setOnItemClickListener(new OnItemClickListener...) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T12:54:02.493

`getRefreshableView()`无济于事，因为`setOnItemClickListener()`in`PullToRefreshListView`只是一种传递方法：

```
public void setOnItemClickListener(OnItemClickListener listener) {
    mRefreshableView.setOnItemClickListener(listener);
} 
```

我遇到了同样的问题，结果发现我在项目布局中有可点击的元素。使此元素不可点击后，它开始工作。

# g++ - 用于 Windows 的 mxe 交叉编译...标准输出消息在哪里？

> ID：12625157
> 
> 赞同：2
> 
> 时间：2012-09-27T15:43:55.480
> 
> 标签：g++, cross-compiling, wine, mxe

我正在使用[MXE](http://mxe.cc) (i686-pc-mingw32-g++) 从我的 Debian 主机系统交叉编译一个基本的 C++ Windows XP 控制台应用程序。在我的 Debian 系统上运行它时（感谢 Wine），我可以在控制台上看到 stdout 输出。但是，如果我在 Windows XP 上从 Windows 控制台运行相同的可执行文件，我看不到我的标准输出输出......（使用`printf`函数）。

# python - 通过 IDLE 将文档插入 MongoDB 时如何禁止显示 ObjectID

> ID：12625161
> 
> 赞同：1
> 
> 时间：2012-09-27T15:44:11.193
> 
> 标签：python, mongodb, python-2.7, pymongo, python-idle

当您使用 Pymongo 通过 IDLE 将单个文档或一组文档插入 MongoDB 实例时，所有成功插入的文档的 ObjectID 都会回显到标准输出。

```
>>> new_posts = [{"author": "Mike",
...               "text": "Another post!",   
...               "tags": ["bulk", "insert"],
...               "date": datetime.datetime(2009, 11, 12, 11, 14)},
...              {"author": "Eliot",
...               "title": "MongoDB is fun",
...               "text": "and pretty easy too!",
...               "date": datetime.datetime(2009, 11, 10, 10, 45)}]
>>> posts.insert(new_posts)
[ObjectId('...'), ObjectId('...')] 
```

我可以运行一个选项来阻止这些 ObjectID 显示吗？问题是，当 IDLE 必须渲染大量文本（例如，添加数万个 objectid）时，它会出现问题。

FWIW，我使用的是 Python 2.7 和最新版本的 PyMongo。如有必要，很高兴提供更多详细信息。

谢谢，

本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:48:24.927

您可以将结果分配给变量，然后它不会被回显。

```
>>> echo=d.echo
>>> echo.insert({"new":"test"})
ObjectId('50647520594bc0f223000000')
>>> new=echo.insert({"new":"test"})
>>> 
```

# ipad - iPad：iOS 6.0 AutoLayout 和 iOS 5.0 AutoSize 在一起？

> ID：12625163
> 
> 赞同：2
> 
> 时间：2012-09-27T15:44:28.890
> 
> 标签：ipad, ios5, ios6, autosize, autolayout

> **可能重复：**
> [在 iOS 6 中启用自动布局，同时保持向后兼容 iOS 5](https://stackoverflow.com/questions/12411980/enabling-auto-layout-in-ios-6-while-remaining-backwards-compatible-with-ios-5)

我知道 iOS 6.0 支持 AutoLayout 功能，如果我想支持 iOS 5.0，我必须在 willAnimateRotationToInterfaceOrientation 中实现手动方法来调整纵向和横向模式下的控件大小。我的问题是我是否可以进行一些设置，以便我的应用程序在 iOS 6.0 上运行时使用 AutoLayout，而在 iOS 5.0 上运行时使用自定义方法？我认为在运行自定义方法之前检查 iOS 版本应该是解决方案，但我不能同时使用 AutoLayout 和 Autosize 选项。有人可以请提出他们对此的想法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T11:39:35.853

[我会在这里](https://stackoverflow.com/questions/12411980/enabling-auto-layout-in-ios-6-while-remaining-backwards-compatible-with-ios-5)看看接受的答案

本质上，创建 2 个部署目标，每个目标使用不同的故事板（一个使用自动布局，一个不使用）。

# android - Android解码gif问题

> ID：12625169
> 
> 赞同：2
> 
> 时间：2012-09-27T15:44:44.160
> 
> 标签：android, class, android-activity, gif, decoder

我想在我的初始屏幕上加载一个 gif 图像。我使用了webview，但它有问题。然后我在 google code 中找到了一个类，它允许我解码 gif 图像并显示它。问题是，在模拟器上它的工作。这是模拟器上的图像：

[http://i47.tinypic.com/2ds0gvs.jpg](http://i47.tinypic.com/2ds0gvs.jpg)

这是我在真实设备上得到的。我尝试在 2.2.2 和 2.3.6 上运行，结果相同，第一次循环通过正确，然后我得到这个：

[http://i45.tinypic.com/2u6d4df.jpg](http://i45.tinypic.com/2u6d4df.jpg)

这是飞溅活动

```
 public class InitActivity extends Activity {
    Application APP = new Application();
    private GifView gifView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        setFullScreen();
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_activity_init);
        gifView = (GifView) findViewById(R.id.app_init_preloaderHolder);
        gifView.setGif(R.drawable.p);
        gifView.play();

    }

    public void setFullScreen(){
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    }

} 
```

这是 GifView 类

公共类 GifView 扩展视图 {

```
public static final int IMAGE_TYPE_UNKNOWN = 0;
public static final int IMAGE_TYPE_STATIC = 1;
public static final int IMAGE_TYPE_DYNAMIC = 2;

public static final int DECODE_STATUS_UNDECODE = 0;
public static final int DECODE_STATUS_DECODING = 1;
public static final int DECODE_STATUS_DECODED = 2;

private GifDecoder decoder;
private Bitmap bitmap;

public int imageType = IMAGE_TYPE_UNKNOWN;
public int decodeStatus = DECODE_STATUS_UNDECODE;

private int width;
private int height;

private long time;
private int index;

private int resId;
private String filePath;

private boolean playFlag = false;

public GifView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

/**
 * Constructor
 */
public GifView(Context context) {
    super(context);
}

private InputStream getInputStream() {
    if (filePath != null)
        try {
            return new FileInputStream(filePath);
        } catch (FileNotFoundException e) {
        }
    if (resId > 0)
        return getContext().getResources().openRawResource(resId);
    return null;
}

/**
 * set gif file path
 * 
 * @param filePath
 */
public void setGif(String filePath) {
    Bitmap bitmap = BitmapFactory.decodeFile(filePath);
    setGif(filePath, bitmap);
}

/**
 * set gif file path and cache image
 * 
 * @param filePath
 * @param cacheImage
 */
public void setGif(String filePath, Bitmap cacheImage) {
    this.resId = 0;
    this.filePath = filePath;
    imageType = IMAGE_TYPE_UNKNOWN;
    decodeStatus = DECODE_STATUS_UNDECODE;
    playFlag = false;
    bitmap = cacheImage;
    width = bitmap.getWidth();
    height = bitmap.getHeight();
    setLayoutParams(new LayoutParams(width, height));
}

/**
 * set gif resource id
 * 
 * @param resId
 */
public void setGif(int resId) {
    Bitmap bitmap = BitmapFactory.decodeResource(getResources(), resId);
    setGif(resId, bitmap);
}

/**
 * set gif resource id and cache image
 * 
 * @param resId
 * @param cacheImage
 */
public void setGif(int resId, Bitmap cacheImage) {
    this.filePath = null;
    this.resId = resId;
    imageType = IMAGE_TYPE_UNKNOWN;
    decodeStatus = DECODE_STATUS_UNDECODE;
    playFlag = false;
    bitmap = cacheImage;
    width = bitmap.getWidth();
    height = bitmap.getHeight();
    setLayoutParams(new LayoutParams(width, height));
}

private void decode() {
    release();
    index = 0;

    decodeStatus = DECODE_STATUS_DECODING;

    new Thread() {
        @Override
        public void run() {
            decoder = new GifDecoder();
            decoder.read(getInputStream());
            if (decoder.width == 0 || decoder.height == 0) {
                imageType = IMAGE_TYPE_STATIC;
            } else {
                imageType = IMAGE_TYPE_DYNAMIC;
            }
            postInvalidate();
            time = System.currentTimeMillis();
            decodeStatus = DECODE_STATUS_DECODED;
        }
    }.start();
}

public void release() {
    decoder = null;
}

@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);

    if (decodeStatus == DECODE_STATUS_UNDECODE) {
        canvas.drawBitmap(bitmap, 0, 0, null);
        if (playFlag) {
            decode();
            invalidate();
        }
    } else if (decodeStatus == DECODE_STATUS_DECODING) {
        canvas.drawBitmap(bitmap, 0, 0, null);
        invalidate();
    } else if (decodeStatus == DECODE_STATUS_DECODED) {
        if (imageType == IMAGE_TYPE_STATIC) {
            canvas.drawBitmap(bitmap, 0, 0, null);
        } else if (imageType == IMAGE_TYPE_DYNAMIC) {
            if (playFlag) {
                long now = System.currentTimeMillis();

                if (time + decoder.getDelay(index) < now) {
                    time += decoder.getDelay(index);
                    incrementFrameIndex();
                }
                Bitmap bitmap = decoder.getFrame(index);
                if (bitmap != null) {
                    canvas.drawBitmap(bitmap, 0, 0, null);
                }
                invalidate();
            } else {
                Bitmap bitmap = decoder.getFrame(index);
                canvas.drawBitmap(bitmap, 0, 0, null);
            }
        } else {
            canvas.drawBitmap(bitmap, 0, 0, null);
        }
    }
}

private void incrementFrameIndex() {
    index++;
    if (index >= decoder.getFrameCount()) {
        index = 0;
    }
}

private void decrementFrameIndex() {
    index--;
    if (index < 0) {
        index = decoder.getFrameCount() - 1;
    }
}

public void play() {
    time = System.currentTimeMillis();
    playFlag = true;
    invalidate();
}

public void pause() {
    playFlag = false;
    invalidate();
}

public void stop() {
    playFlag = false;
    index = 0;
    invalidate();
}

public void nextFrame() {
    if (decodeStatus == DECODE_STATUS_DECODED) {
        incrementFrameIndex();
        invalidate();
    }
}

public void prevFrame() {
    if (decodeStatus == DECODE_STATUS_DECODED) {
        decrementFrameIndex();
        invalidate();
    }
} 
```

这是 gif 解码器类

```
public class GifDecoder {
    /**
     * File read status: No errors.
     */
    public static final int STATUS_OK = 0;
    /**
     * File read status: Error decoding file (may be partially decoded)
     */
    public static final int STATUS_FORMAT_ERROR = 1;
    /**
     * File read status: Unable to open source.
     */
    public static final int STATUS_OPEN_ERROR = 2;
    /** max decoder pixel stack size */
    protected static final int MAX_STACK_SIZE = 4096;
    protected InputStream in;
    protected int status;
    protected int width; // full image width
    protected int height; // full image height
    protected boolean gctFlag; // global color table used
    protected int gctSize; // size of global color table
    protected int loopCount = 1; // iterations; 0 = repeat forever
    protected int[] gct; // global color table
    protected int[] lct; // local color table
    protected int[] act; // active color table
    protected int bgIndex; // background color index
    protected int bgColor; // background color
    protected int lastBgColor; // previous bg color
    protected int pixelAspect; // pixel aspect ratio
    protected boolean lctFlag; // local color table flag
    protected boolean interlace; // interlace flag
    protected int lctSize; // local color table size
    protected int ix, iy, iw, ih; // current image rectangle
    protected int lrx, lry, lrw, lrh;
    protected Bitmap image; // current frame
    protected Bitmap lastBitmap; // previous frame
    protected byte[] block = new byte[256]; // current data block
    protected int blockSize = 0; // block size last graphic control extension info
    protected int dispose = 0; // 0=no action; 1=leave in place; 2=restore to bg; 3=restore to prev
    protected int lastDispose = 0;
    protected boolean transparency = false; // use transparent color
    protected int delay = 0; // delay in milliseconds
    protected int transIndex; // transparent color index
    // LZW decoder working arrays
    protected short[] prefix;
    protected byte[] suffix;
    protected byte[] pixelStack;
    protected byte[] pixels;
    protected Vector<GifFrame> frames; // frames read from current file
    protected int frameCount;

    private static class GifFrame {
        public GifFrame(Bitmap im, int del) {
            image = im;
            delay = del;
        }

        public Bitmap image;
        public int delay;
    }

    /**
     * Gets display duration for specified frame.
     * 
     * @param n
     *          int index of frame
     * @return delay in milliseconds
     */
    public int getDelay(int n) {
        delay = -1;
        if ((n >= 0) && (n < frameCount)) {
            delay = frames.elementAt(n).delay;
        }
        return delay;
    }

    /**
     * Gets the number of frames read from file.
     * 
     * @return frame count
     */
    public int getFrameCount() {
        return frameCount;
    }

    /**
     * Gets the first (or only) image read.
     * 
     * @return BufferedBitmap containing first frame, or null if none.
     */
    public Bitmap getBitmap() {
        return getFrame(0);
    }

    /**
     * Gets the "Netscape" iteration count, if any. A count of 0 means repeat indefinitiely.
     * 
     * @return iteration count if one was specified, else 1.
     */
    public int getLoopCount() {
        return loopCount;
    }

    /**
     * Creates new frame image from current data (and previous frames as specified by their disposition codes).
     */
    protected void setPixels() {
        // expose destination image's pixels as int array
        int[] dest = new int[width * height];
        // fill in starting image contents based on last image's dispose code
        if (lastDispose > 0) {
            if (lastDispose == 3) {
                // use image before last
                int n = frameCount - 2;
                if (n > 0) {
                    lastBitmap = getFrame(n - 1);
                } else {
                    lastBitmap = null;
                }
            }
            if (lastBitmap != null) {
                lastBitmap.getPixels(dest, 0, width, 0, 0, width, height);
                // copy pixels
                if (lastDispose == 2) {
                    // fill last image rect area with background color
                    int c = 0;
                    if (!transparency) {
                        c = lastBgColor;
                    }
                    for (int i = 0; i < lrh; i++) {
                        int n1 = (lry + i) * width + lrx;
                        int n2 = n1 + lrw;
                        for (int k = n1; k < n2; k++) {
                            dest[k] = c;
                        }
                    }
                }
            }
        }
        // copy each source line to the appropriate place in the destination
        int pass = 1;
        int inc = 8;
        int iline = 0;
        for (int i = 0; i < ih; i++) {
            int line = i;
            if (interlace) {
                if (iline >= ih) {
                    pass++;
                    switch (pass) {
                    case 2:
                        iline = 4;
                        break;
                    case 3:
                        iline = 2;
                        inc = 4;
                        break;
                    case 4:
                        iline = 1;
                        inc = 2;
                        break;
                    default:
                        break;
                    }
                }
                line = iline;
                iline += inc;
            }
            line += iy;
            if (line < height) {
                int k = line * width;
                int dx = k + ix; // start of line in dest
                int dlim = dx + iw; // end of dest line
                if ((k + width) < dlim) {
                    dlim = k + width; // past dest edge
                }
                int sx = i * iw; // start of line in source
                while (dx < dlim) {
                    // map color and insert in destination
                    int index = ((int) pixels[sx++]) & 0xff;
                    int c = act[index];
                    if (c != 0) {
                        dest[dx] = c;
                    }
                    dx++;
                }
            }
        }

        image = Bitmap.createBitmap(dest, width, height, Config.ARGB_8888);
    }

    /**
     * Gets the image contents of frame n.
     * 
     * @return BufferedBitmap representation of frame, or null if n is invalid.
     */
    public Bitmap getFrame(int n) {
        if (frameCount <= 0)
            return null;
        n = n % frameCount;
        return ((GifFrame) frames.elementAt(n)).image;
    }

    /**
     * Reads GIF image from stream
     * 
     * @param is
     *          containing GIF file.
     * @return read status code (0 = no errors)
     */
    public int read(InputStream is) {
        init();
        if (is != null) {
            in = is;
            readHeader();
            if (!err()) {
                readContents();
                if (frameCount < 0) {
                    status = STATUS_FORMAT_ERROR;
                }
            }
        } else {
            status = STATUS_OPEN_ERROR;
        }
        try {
            is.close();
        } catch (Exception e) {
        }
        return status;
    }

    /**
     * Decodes LZW image data into pixel array. Adapted from John Cristy's BitmapMagick.
     */
    protected void decodeBitmapData() {
        int nullCode = -1;
        int npix = iw * ih;
        int available, clear, code_mask, code_size, end_of_information, in_code, old_code, bits, code, count, i, datum, data_size, first, top, bi, pi;
        if ((pixels == null) || (pixels.length < npix)) {
            pixels = new byte[npix]; // allocate new pixel array
        }
        if (prefix == null) {
            prefix = new short[MAX_STACK_SIZE];
        }
        if (suffix == null) {
            suffix = new byte[MAX_STACK_SIZE];
        }
        if (pixelStack == null) {
            pixelStack = new byte[MAX_STACK_SIZE + 1];
        }
        // Initialize GIF data stream decoder.
        data_size = read();
        clear = 1 << data_size;
        end_of_information = clear + 1;
        available = clear + 2;
        old_code = nullCode;
        code_size = data_size + 1;
        code_mask = (1 << code_size) - 1;
        for (code = 0; code < clear; code++) {
            prefix[code] = 0; // XXX ArrayIndexOutOfBoundsException
            suffix[code] = (byte) code;
        }
        // Decode GIF pixel stream.
        datum = bits = count = first = top = pi = bi = 0;
        for (i = 0; i < npix;) {
            if (top == 0) {
                if (bits < code_size) {
                    // Load bytes until there are enough bits for a code.
                    if (count == 0) {
                        // Read a new data block.
                        count = readBlock();
                        if (count <= 0) {
                            break;
                        }
                        bi = 0;
                    }
                    datum += (((int) block[bi]) & 0xff) << bits;
                    bits += 8;
                    bi++;
                    count--;
                    continue;
                }
                // Get the next code.
                code = datum & code_mask;
                datum >>= code_size;
                bits -= code_size;
                // Interpret the code
                if ((code > available) || (code == end_of_information)) {
                    break;
                }
                if (code == clear) {
                    // Reset decoder.
                    code_size = data_size + 1;
                    code_mask = (1 << code_size) - 1;
                    available = clear + 2;
                    old_code = nullCode;
                    continue;
                }
                if (old_code == nullCode) {
                    pixelStack[top++] = suffix[code];
                    old_code = code;
                    first = code;
                    continue;
                }
                in_code = code;
                if (code == available) {
                    pixelStack[top++] = (byte) first;
                    code = old_code;
                }
                while (code > clear) {
                    pixelStack[top++] = suffix[code];
                    code = prefix[code];
                }
                first = ((int) suffix[code]) & 0xff;
                // Add a new string to the string table,
                if (available >= MAX_STACK_SIZE) {
                    break;
                }
                pixelStack[top++] = (byte) first;
                prefix[available] = (short) old_code;
                suffix[available] = (byte) first;
                available++;
                if (((available & code_mask) == 0) && (available < MAX_STACK_SIZE)) {
                    code_size++;
                    code_mask += available;
                }
                old_code = in_code;
            }
            // Pop a pixel off the pixel stack.
            top--;
            pixels[pi++] = pixelStack[top];
            i++;
        }
        for (i = pi; i < npix; i++) {
            pixels[i] = 0; // clear missing pixels
        }
    }

    /**
     * Returns true if an error was encountered during reading/decoding
     */
    protected boolean err() {
        return status != STATUS_OK;
    }

    /**
     * Initializes or re-initializes reader
     */
    protected void init() {
        status = STATUS_OK;
        frameCount = 0;
        frames = new Vector<GifFrame>();
        gct = null;
        lct = null;
    }

    /**
     * Reads a single byte from the input stream.
     */
    protected int read() {
        int curByte = 0;
        try {
            curByte = in.read();
        } catch (Exception e) {
            status = STATUS_FORMAT_ERROR;
        }
        return curByte;
    }

    /**
     * Reads next variable length block from input.
     * 
     * @return number of bytes stored in "buffer"
     */
    protected int readBlock() {
        blockSize = read();
        int n = 0;
        if (blockSize > 0) {
            try {
                int count = 0;
                while (n < blockSize) {
                    count = in.read(block, n, blockSize - n);
                    if (count == -1) {
                        break;
                    }
                    n += count;
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
            if (n < blockSize) {
                status = STATUS_FORMAT_ERROR;
            }
        }
        return n;
    }

    /**
     * Reads color table as 256 RGB integer values
     * 
     * @param ncolors
     *          int number of colors to read
     * @return int array containing 256 colors (packed ARGB with full alpha)
     */
    protected int[] readColorTable(int ncolors) {
        int nbytes = 3 * ncolors;
        int[] tab = null;
        byte[] c = new byte[nbytes];
        int n = 0;
        try {
            n = in.read(c);
        } catch (Exception e) {
            e.printStackTrace();
        }
        if (n < nbytes) {
            status = STATUS_FORMAT_ERROR;
        } else {
            tab = new int[256]; // max size to avoid bounds checks
            int i = 0;
            int j = 0;
            while (i < ncolors) {
                int r = ((int) c[j++]) & 0xff;
                int g = ((int) c[j++]) & 0xff;
                int b = ((int) c[j++]) & 0xff;
                tab[i++] = 0xff000000 | (r << 16) | (g << 8) | b;
            }
        }
        return tab;
    }

    /**
     * Main file parser. Reads GIF content blocks.
     */
    protected void readContents() {
        // read GIF file content blocks
        boolean done = false;
        while (!(done || err())) {
            int code = read();
            switch (code) {
            case 0x2C: // image separator
                readBitmap();
                break;
            case 0x21: // extension
                code = read();
                switch (code) {
                case 0xf9: // graphics control extension
                    readGraphicControlExt();
                    break;
                case 0xff: // application extension
                    readBlock();
                    String app = "";
                    for (int i = 0; i < 11; i++) {
                        app += (char) block[i];
                    }
                    if (app.equals("NETSCAPE2.0")) {
                        readNetscapeExt();
                    } else {
                        skip(); // don't care
                    }
                    break;
                case 0xfe:// comment extension
                    skip();
                    break;
                case 0x01:// plain text extension
                    skip();
                    break;
                default: // uninteresting extension
                    skip();
                }
                break;
            case 0x3b: // terminator
                done = true;
                break;
            case 0x00: // bad byte, but keep going and see what happens break;
            default:
                status = STATUS_FORMAT_ERROR;
            }
        }
    }

    /**
     * Reads Graphics Control Extension values
     */
    protected void readGraphicControlExt() {
        read(); // block size
        int packed = read(); // packed fields
        dispose = (packed & 0x1c) >> 2; // disposal method
        if (dispose == 0) {
            dispose = 1; // elect to keep old image if discretionary
        }
        transparency = (packed & 1) != 0;
        delay = readShort() * 10; // delay in milliseconds
        transIndex = read(); // transparent color index
        read(); // block terminator
    }

    /**
     * Reads GIF file header information.
     */
    protected void readHeader() {
        String id = "";
        for (int i = 0; i < 6; i++) {
            id += (char) read();
        }
        if (!id.startsWith("GIF")) {
            status = STATUS_FORMAT_ERROR;
            return;
        }
        readLSD();
        if (gctFlag && !err()) {
            gct = readColorTable(gctSize);
            bgColor = gct[bgIndex];
        }
    }

    /**
     * Reads next frame image
     */
    protected void readBitmap() {
        ix = readShort(); // (sub)image position & size
        iy = readShort();
        iw = readShort();
        ih = readShort();
        int packed = read();
        lctFlag = (packed & 0x80) != 0; // 1 - local color table flag interlace
        lctSize = (int) Math.pow(2, (packed & 0x07) + 1);
        // 3 - sort flag
        // 4-5 - reserved lctSize = 2 << (packed & 7); // 6-8 - local color
        // table size
        interlace = (packed & 0x40) != 0;
        if (lctFlag) {
            lct = readColorTable(lctSize); // read table
            act = lct; // make local table active
        } else {
            act = gct; // make global table active
            if (bgIndex == transIndex) {
                bgColor = 0;
            }
        }
        int save = 0;
        if (transparency) {
            save = act[transIndex];
            act[transIndex] = 0; // set transparent color if specified
        }
        if (act == null) {
            status = STATUS_FORMAT_ERROR; // no color table defined
        }
        if (err()) {
            return;
        }
        decodeBitmapData(); // decode pixel data
        skip();
        if (err()) {
            return;
        }
        frameCount++;
        // create new image to receive frame data
        image = Bitmap.createBitmap(width, height, Config.ARGB_8888);
        setPixels(); // transfer pixel data to image
        frames.addElement(new GifFrame(image, delay)); // add image to frame
        // list
        if (transparency) {
            act[transIndex] = save;
        }
        resetFrame();
    }

    /**
     * Reads Logical Screen Descriptor
     */
    protected void readLSD() {
        // logical screen size
        width = readShort();
        height = readShort();
        // packed fields
        int packed = read();
        gctFlag = (packed & 0x80) != 0; // 1 : global color table flag
        // 2-4 : color resolution
        // 5 : gct sort flag
        gctSize = 2 << (packed & 7); // 6-8 : gct size
        bgIndex = read(); // background color index
        pixelAspect = read(); // pixel aspect ratio
    }

    /**
     * Reads Netscape extenstion to obtain iteration count
     */
    protected void readNetscapeExt() {
        do {
            readBlock();
            if (block[0] == 1) {
                // loop count sub-block
                int b1 = ((int) block[1]) & 0xff;
                int b2 = ((int) block[2]) & 0xff;
                loopCount = (b2 << 8) | b1;
            }
        } while ((blockSize > 0) && !err());
    }

    /**
     * Reads next 16-bit value, LSB first
     */
    protected int readShort() {
        // read 16-bit value, LSB first
        return read() | (read() << 8);
    }

    /**
     * Resets frame state for reading next image.
     */
    protected void resetFrame() {
        lastDispose = dispose;
        lrx = ix;
        lry = iy;
        lrw = iw;
        lrh = ih;
        lastBitmap = image;
        lastBgColor = bgColor;
        dispose = 0;
        transparency = false;
        delay = 0;
        lct = null;
    }

    /**
     * Skips variable length blocks up to and including next zero length block.
     */
    protected void skip() {
        do {
            readBlock();
        } while ((blockSize > 0) && !err());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:56:20.063

为什么不只使用android的默认加载圈？这段代码真的有点矫枉过正......只需制作一个 9.patch 图像作为启动屏幕，然后在其上放置一个来自 android 核心的加载圆圈。（进度条）

自定义图像动画 [Android：从静止图像制作动画](https://stackoverflow.com/questions/5611123/android-make-animation-from-still-images)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:54:51.483

然后，您可以在背景或整个布局上设置图像，并使用旋转的 android 圆圈（进度条）。

# java - 为什么 Matcher.find() 在 Matcher.lookingAt() 之后运行时返回 false？

> ID：12625171
> 
> 赞同：4
> 
> 时间：2012-09-27T15:44:49.633
> 
> 标签：java, regex

我注意到调用`Matcher.lookingAt()`会影响`Matcher.find()`. 我运行`lookingAt()`了我的代码，它返回了*true*。然后当我跑步`find()`以便可以开始返回比赛时，我得到了*false*。如果我删除`lookingAt()`呼叫，则`find()`返回*true*并打印我的匹配项。有谁知道为什么？

**试用1：**

```
Matcher matches = Pattern.compile("T\\d+").matcher("T234bird");
System.out.println(matches.lookingAt()); //after running this, find() will return false
while (matches.find())
    System.out.println(matches.group());
//Output: true 
```

**试验2：**

```
Matcher matches = Pattern.compile("T\\d+").matcher("T234bird");
//System.out.println(matches.lookingAt()); //without this, find() will return true
while (matches.find())
    System.out.println(matches.group());
//Output: T234 
```

**试验3：**

```
Matcher matches = Pattern.compile("T\\d+").matcher("T234bird");
while (matches.lookingAt()) 
    System.out.println(matches.group());
//Output: T234 T234 T234 T234 ... till crash
//I understand why this happens. It's not my question but I just included it in case someone may try to suggest it 
```

最终，我要实现的是：首先确认匹配在字符串的开头，然后打印出来。我最终做了：

```
Matcher matches = Pattern.compile("T\\d+").matcher("T234bird");
if(matches.lookingAt()) 
    System.out.println(matches.group());
//Output: T234 
```

这解决了我的问题，但我的问题是：有谁知道为什么`lookingAt()`会影响`find()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:49:25.813

对`.lookingAt()`match*和 consumes* `T234`的调用，因此以下`.find()`调用从`bird`- 不匹配开始。

您需要重置匹配器对象才能重新开始。

或者只是在您的正则表达式中使用字符串开头的锚点并`.find()`立即使用：

```
Matcher matches = Pattern.compile("^T\\d+").matcher("T234bird");
if (matches.find())
    System.out.println(matches.group()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T15:51:33.483

在试验 1 中，呼叫`lookingAt`匹配`T234`，并且您随后的呼叫开始**在前一场比赛结束**`find`时寻找匹配。如果你想回到你需要调用的字符串的开头。[Matcher.find()](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#find%28%29)的文档中对此进行了解释：**[`Matcher.reset()`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#reset%28%29)**

 **> 此方法从该匹配器区域的开头开始，或者，如果该方法的先前调用成功并且匹配器此后尚未重置，则从前一个匹配不匹配的第一个字符开始。

请注意，它`lookingAt`适用于`start`, `end`，并且`group`方法相同`find`，因此如果您只对字符串的开头感兴趣，则可以这样做：

```
Matcher matches = Pattern.compile("T\\d+").matcher("T234bird");
if (matches.lookingAt())
    System.out.println(matches.group()); 
```

你必须使用`if`而不是在`while`这里，因为`lookingAt`总是从字符串的开头开始，而不是在上一个匹配的结尾，所以`while`永远循环。**

# cognos - 如何将页脚单元格变成数据容器？

> ID：12625172
> 
> 赞同：1
> 
> 时间：2012-09-27T15:44:59.887
> 
> 标签：cognos, cognos-8

我有一个拆分页脚，我通过[如何在 Cognos 中将页脚/页眉拆分为多个单元格？](https://stackoverflow.com/q/12480915/869458)，但我需要其中一个拆分单元格作为数据容器。

这是页脚/列表项：

![在此处输入图像描述](../Images/29b3779d638be954fbe3a1f1dfd212a1.png)

我实际上想要右列中的位置计数和左列中的文本项作为标签。

尝试将查询项拖到右页脚单元格时，出现此错误：“此对象只能插入数据容器”

![IBM Cognos 8 报告工作室。 此对象只能插入到数据容器中。](../Images/35065268bafac0fa81889cf58153f3ea.png)

下面分别是左项和右项的属性列表：

![在此处输入图像描述](../Images/36c1f78993e1bd80a4ebe2de59a0503c.png) ![在此处输入图像描述](../Images/94ad2378f497178b577eab2b97f36130.png)

如何将此页脚单元格转换为数据容器或以其他方式允许我设置那些“文本源”属性以允许它接受来自查询的数据项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T05:41:46.973

这可以很容易地完成，在您按下工具栏上的 unlcok 按钮后。
从锁定状态：
![锁定](../Images/90fc8df51b8b42c172ded83b3e214305.png)

解锁状态：
![开锁](../Images/356d94a26a372014e12b1c946a9a28ac.png)

现在，您可以轻松地将项目从单元格拖动到另一个单元格，并将查询项拖动到单元格中。

# junit - 使用 TomEE 嵌入式 EJBContainer api 进行 EJB 测试：java.lang.ClassFormatError 异常

> ID：12625173
> 
> 赞同：5
> 
> 时间：2012-09-27T15:45:03.300
> 
> 标签：junit, ejb, apache-tomee

我会使用 TomEE 嵌入式 EJBContainer 测试我的 EJB。

这是我的 JUnit 测试用例框架：

```
package com.xxx.indexer.scheduler.service;

import java.util.Properties;

import javax.ejb.embeddable.EJBContainer;
import javax.naming.NamingException;

import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

import com.xxx.indexer.scheduler.AbstractTest;

public class BookingAuditServiceImplTest extends AbstractTest {

    private static EJBContainer container;

    @BeforeClass
    public static void start() {
        final Properties props = new Properties();
        props.setProperty(EJBContainer.PROVIDER, "tomee-embedded");
        container = EJBContainer.createEJBContainer(props);
    }

    @AfterClass
    public static void stop() {
        container.close();
    }

    @Before
    public void inject() throws NamingException {
        container.getContext().bind("inject", this);
    }

    @Test
    public void test() {
        // TODO
    }

} 
```

这些是我的 maven 依赖项：

```
<dependency>
  <groupId>junit</groupId>
  <artifactId>junit</artifactId>
  <version>4.10</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>javax</groupId>
  <artifactId>javaee-api</artifactId>
  <version>6.0</version>
  <scope>provided</scope>
</dependency>
<dependency>
  <groupId>org.apache.openejb</groupId>
  <artifactId>tomee-embedded</artifactId>
  <version>1.0.0</version>
  <scope>test</scope>
</dependency> 
```

当我启动测试类时， EJBContainer.createEJBContainer() 方法抛出 java.lang.ClassFormatError 异常：

```
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/ejb/embeddable/EJBContainer
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
at java.lang.Class.getDeclaredFields0(Native Method)
at java.lang.Class.privateGetDeclaredFields(Class.java:2308)
at java.lang.Class.getDeclaredFields(Class.java:1760)
at org.junit.runners.model.TestClass.<init>(TestClass.java:44)
at org.junit.runners.ParentRunner.<init>(ParentRunner.java:73)
at org.junit.runners.BlockJUnit4ClassRunner.<init>(BlockJUnit4ClassRunner.java:55)
at org.junit.internal.builders.JUnit4Builder.runnerForClass(JUnit4Builder.java:13)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:29)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
at org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:24)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.<init>(JUnit4TestReference.java:33)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestClassReference.<init>(JUnit4TestClassReference.java:25)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createTest(JUnit4TestLoader.java:48)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.loadTests(JUnit4TestLoader.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:452)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-27T15:45:03.300

[我在此链接https://stackoverflow.com/a/3416368/1412839](https://stackoverflow.com/a/3416368/1412839)上读到，问题是 maven 依赖项的顺序。

我必须首先声明 tomee 嵌入式工件，然后在 javaee api 之后，以这种方式：

```
<dependency>
  <groupId>org.apache.openejb</groupId>
  <artifactId>tomee-embedded</artifactId>
  <version>1.0.0</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>javax</groupId>
  <artifactId>javaee-api</artifactId>
  <version>6.0</version>
  <scope>provided</scope>
</dependency> 
```

有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T10:22:12.663

你也可以用 org.apache.openejb:javaee-api:6.0-4 替换 javax:javaee-api (broken jar) 并且它总是有效的;)

# jquery - HTML5 - div 内的画布绘图

> ID：12625176
> 
> 赞同：0
> 
> 时间：2012-09-27T15:45:12.133
> 
> 标签：jquery, html, html5-canvas

我有这段代码可以让我像我想要的那样画一条水平线。问题是，当我在其中使用它时，它可以绘制，但是如果我拉伸浏览器窗口，线条会改变位置。我想这与它被包裹在右边的事实有关吗？我试图这样做，但它也没有奏效。我真的需要那些与布局对齐的线条。

```
<canvas id="myCanvas" width="1250" height="120"></canvas>

  <script>

    var canvas = $("#myCanvas")[0];
    var c = canvas.getContext("2d");
    var amount = 0;
    var startX = 164;
    var startY = 120;
    var endX = 1094;
    var endY = 120;

    setTimeout(function() {
    var interval = setInterval(function() {
        amount += 0.005; // change to alter duration
        if (amount > 1) {
            amount = 1;
            clearInterval(interval);
        }
        c.clearRect(0, 0, canvas.width, canvas.height);
        c.strokeStyle = "black";
        c.lineWidth=1;
        c.strokeStyle="#707070";
        c.moveTo(startX, startY);
        // lerp : a  + (b - a) * f
        c.lineTo(startX + (endX - startX) * amount, startY + (endY - startY) * amount);
        c.stroke();
    }, 0);

}, 3000);

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:49:29.257

调整画布大小时，画布绘图尺寸不会自动适应显示它的站点。你必须自己做。

我通常在我的画布抽屉初始化例程中做这样的事情：

```
this.canvas = canvas;
this.context = this.canvas.getContext("2d");
var _this = this;
var setDim = function() {
    _this.w = _this.canvas.clientWidth;
    _this.h = _this.canvas.clientHeight;
    _this.canvas.width = _this.w;
    _this.canvas.height = _this.h;
    _this.dimChanged = true;
    _this.draw();
};
setDim();
$(window).resize(setDim); 
```

# javascript - Dojo 树菜单展开节点 OnMouserOver

> ID：12625177
> 
> 赞同：0
> 
> 时间：2012-09-27T15:45:16.093
> 
> 标签：javascript, jquery, dojo

嗨，我在我的应用程序中使用道场树形菜单。我正在使用 onClick 事件来展开特定的树节点。相反，我希望每当我将鼠标悬停在加号图像上时，它应该通过将鼠标悬停在该节点上来扩展该节点的内容。这是代码 -

```
var treeControl = new dijit.Tree({
        model: xyz,
        id: 'abc',
        showRoot: false,
        openOnClick: true, 
```

我该怎么做 ？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:52:17.180

使用[`dojo/on`事件委托](http://livedocs.dojotoolkit.org/dojo/on#event-delegation)：

```
// dependencies:
// var on = require("dojo/on");
// var mouse = require("dojo/mouse");
// var registry = require("dijit/registry");

on(tree.domNode, on.selector("img.dijitTreeExpandoClosed", mouse.enter), function(event) {
    var treeNode = registry.getEnclosingWidget(event.target);
    treeNode.tree._expandNode(treeNode);
}); 
```

在 jsFiddle 上查看它的实际效果：http: [//jsfiddle.net/phusick/gUNuC/](http://jsfiddle.net/phusick/gUNuC/)

# ruby-on-rails - Rails：我应该使用观察者还是回调（使字段保持最新）？

> ID：12625178
> 
> 赞同：2
> 
> 时间：2012-09-27T15:45:16.920
> 
> 标签：ruby-on-rails, activerecord, callback, models, observer-pattern

我正在开发一个系统，其中 ActiveRecord 实体和字段需要始终保持一致。很多时候，某些字段是从其他字段派生的，并且需要始终保持最新。有时，这甚至可能跨实体发生。

例如：

```
class User < ActiveRecord::Base
  attr_accessible :first_name, :last_name
  attr_protected  :name

  # I need to keep 'name' up to date at all times
  after_update do
    name = self.first_name + ' ' + self.last_name
    true
  end
end 
```

这里的哲学问题是我是否应该在回调或观察者内部实现这种类型的行为（以及数百个类似的行为）。我可以想到以下两个原因：

### 回调

*   行为定义更容易访问（您只需查看模型定义就知道在哪里查看）
*   保持字段/实体之间的一致性不是辅助问题，而是实体行为的复杂部分。事实上，保持数据的一致性（隐含地）是任何实体的首要要求。

### 观察员

*   随着系统行为最终变得更加复杂，模型往往更轻量级（不会因数百个回调方法而臃肿）
*   保持字段/实体之间的一致性是一个辅助问题，与模型的主要职责无关；因此，应该将其分解为外部观察者

### 有经验的大侠可以赐教一下吗？

*   有没有我没有考虑过的具体考虑因素？
*   在决定什么属于回调和观察者方面，您的指导方针是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T18:15:49.053

根据设计模式一书，这最适合观察者模式。使用 and Observer，您的 after_update/save 逻辑与您的模型分离。从您的示例中很难看出，但是如果您从回调中更新其他模型，那么您正在使用其他模型的知识污染您的用户模型。因此，Observer 应该介入处理。

此外，您可以在 Rails 中禁用观察者，从而在您不关心触发“回调”的情况下更快地进行单元测试。

# objective-c - 使用 nibs 构建视图是好的做法吗？

> ID：12625183
> 
> 赞同：1
> 
> 时间：2012-09-27T15:45:38.153
> 
> 标签：objective-c, ios, xcode, interface-builder, nib

我刚刚读了一条评论，说类似

> 另一个从不使用笔尖的理由

在 iOS 中使用 nib 构建视图是不是很糟糕？我认为这是一个很好的系统，使您无需编写大量代码即可快速构建视图。我使用笔尖已经有一段时间了，从来没有看到过使用它们的缺点。

所以我的问题是：我应该使用 nib 还是编写我的视图，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:51:51.520

我更喜欢尽可能使用 NIB！我的理由是：

*   易于维护且需要更改我可以立即查看结果。
*   现在 iPhone5 有了新的分辨率 - 在 NIB 中事情真的很容易做到
*   便于使用
*   编写更少的代码

我什至在那里制作了小弹出视图并将容器视图设置为隐藏。然后我用 containerView.hidden = YES/NO; 显示/隐藏这些弹出视图

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:58:10.797

我认为“永远不要使用笔尖”的说法是荒谬的。您只需要知道何时使用它们以及何时避免使用它们。它们非常适合复杂但静态的视图，您会在其中浪费大量时间来获取正确的坐标和大小。对于动态 GUI，您当然应该使用代码。

但是，有些人可能会担心 GUI 超出他们的控制范围，如果他们不通过代码自己创建它并查看每个细节。但这是一个主观的观点。

**一个肯定的缺点是，如果您使用源代码控制**，则很难合并 xib 。Xib 文件实际上是 XML 文件，当您在 GUI 中更改某些内容时，会在后台添加、删除或更改大量引用。这将导致非常难以解决的冲突。

另一个可能是**性能原因**。从 nib 文件加载 GUI 会稍微慢一些（在某些情况下），然后直接在代码中创建它。有些人建议不要对必须在应用程序启动时加载的 GUI 使用任何 nib，以缩短启动时间。但我不确定是否有显着差异。

# android - java.lang.ClassCastException 在 android 中使用 ksoap2

> ID：12625190
> 
> 赞同：1
> 
> 时间：2012-09-27T15:45:51.757
> 
> 标签：android, web-services, soap, android-ksoap2

我正在使用 Eclipse 通过 android 进行开发并尝试连接到 .Net 网络服务。我正在使用 ksoap2 库来调用 web 服务，但在调用返回任意对象的方法时出现此异常：

```
09-27 16:29:59.641: W/System.err(312): java.lang.ClassCastException: org.ksoap2.serialization.SoapObject 
```

返回布尔值或整数的方法可以正常工作，但这一直给我带来问题。这是来自服务器的响应：

```
<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<getUsuarioResponse xmlns="http://www.saintek.cl/">
<getUsuarioResult>
<EntityKey>
<EntitySetName>Usuarios</EntitySetName>
<EntityContainerName>ModelNeearsContainer</EntityContainerName>
<EntityKeyValues>
<EntityKeyMember>
<Key>Id</Key>
<Value xsi:type="xsd:int">7</Value>
</EntityKeyMember>
</EntityKeyValues>
</EntityKey>
<Id>7</Id>
<ReputacionId xsi:nil="true" />
<FotoId xsi:nil="true" />
<CoordenadasId xsi:nil="true" />
<FechaNacimiento>1900-01-01T00:00:00</FechaNacimiento>
<FechaRegistro>2012-09-21T16:46:07.707</FechaRegistro>
<Telefono />
<Reputacion_Id xsi:nil="true" />
<Habilitado>false</Habilitado>
<CoordenadaReference />
<FotoReference />
<ReputacionReference />
</getUsuarioResult>
</getUsuarioResponse>
</soap:Body>
</soap:Envelope> 
```

这是我的代码：

```
 String strJson = "";

    String usuario = ((EditText)findViewById(R.id.editText_mail_entrar)).getText().toString();
    String password = ((EditText)findViewById(R.id.editText_password_entrar)).getText().toString();

    request = new SoapObject(WebServiceConstants.NAMESPACE, METHOD_NAME);

    //---le agregamos los parametros---
    request.addProperty("usuario", usuario);
    request.addProperty("password", password);

    envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true; //por que es .NET

    envelope.setOutputSoapObject(request);
    //envelope.addMapping(WebServiceConstants.NAMESPACE, "Usuario", new Usuario().getClass());

    HttpTransportSE transporte = new HttpTransportSE(WebServiceConstants.URL);
    transporte.debug = true;

    try {

        transporte.call(SOAP_ACTION, envelope);
        resultsRequestSoap = (SoapPrimitive)envelope.getResponse();

    } catch (IOException e) {

        e.printStackTrace();

    } catch (XmlPullParserException e) {

        e.printStackTrace();
    } catch (Exception e) {
        e.printStackTrace();
    }

    strJson = resultsRequestSoap.toString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:10:03.453

将 resultsRequestSoap 声明为 Object 类的实例，并尝试不进行类转换，如下所示

```
 resultsRequestSoap = envelope.getResponse(); 
```

# nginx - 子域设置 nginx

> ID：12625203
> 
> 赞同：1
> 
> 时间：2012-09-27T15:46:43.487
> 
> 标签：nginx, subdomain, virtualhost

我的 reviewer24.com.conf 文件如下所示：

```
server {
  server_name reviewer24.com www.reviewer24.com;

  access_log /home/nginx/domains/reviewer24.com/log/access.log combined buffer=32k;
  error_log /home/nginx/domains/reviewer24.com/log/error.log;

  root /home/nginx/domains/reviewer24.com/public;

  location / {

  # Enables directory listings when index file not found
  #autoindex  on;

  # Shows file listing times as local time
  #autoindex_localtime on;

  # Enable for vBulletin usage WITHOUT vbSEO installed
  #try_files         / /index.php;

  }

  include /usr/local/nginx/conf/staticfiles.conf;
  include /usr/local/nginx/conf/php.conf;
  include /usr/local/nginx/conf/drop.conf;
  #include /usr/local/nginx/conf/errorpage.conf;
} 
```

我创建了一个文件夹“m”并在其中放置了网站的移动版本。我应该在这个 .conf 文件中添加什么规则，这样当您访问：[http](http://m.reviewer24.com) ://m.reviewer24.com 时，它会显示“m”文件夹中的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:50:48.727

我会专门为您的移动站点创建一个新的 .conf 文件，例如在`m.reviewer24.com.conf`一个新的服务器块中，然后重新加载您的 nginx 配置。

这样，如果您需要对子域配置进行特定更改，则更易于管理。或者，您可以将新服务器块附加到现有配置中。

您可能还想委托移动流量访问和错误日​​志的位置:)

```
server {
  server_name m.reviewer24.com;

  access_log /home/nginx/domains/reviewer24.com/log/access.log combined buffer=32k;
  error_log /home/nginx/domains/reviewer24.com/log/error.log;

  root /home/nginx/domains/reviewer24.com/public/m;

  location / {

  # Enables directory listings when index file not found
  #autoindex  on;

  # Shows file listing times as local time
  #autoindex_localtime on;

  # Enable for vBulletin usage WITHOUT vbSEO installed
  #try_files         / /index.php;

  }

  include /usr/local/nginx/conf/staticfiles.conf;
  include /usr/local/nginx/conf/php.conf;
  include /usr/local/nginx/conf/drop.conf;
  #include /usr/local/nginx/conf/errorpage.conf;
} 
```

# c# - Silverlight MultiBinding 与转换器，转换器在 OnPropertyChange 后未触发

> ID：12625207
> 
> 赞同：2
> 
> 时间：2012-09-27T15:46:54.280
> 
> 标签：c#, silverlight, binding, converter, multibinding

在 Silverlight 项目中使用具有多个绑定的转换器时遇到一些问题。任务是在单击按钮时禁用按钮，具体取决于自定义转换器中四个属性的评估方式。任务流程如下：

*   初始化按钮时触发转换器
*   在 ViewModel 中单击按钮并触发命令
*   在一个 viewModel 属性中记录按钮的 ID
*   在 ViewModel 中为三个视图模型属性之一触发 OnPropertyChanged
*   这应该触发转换器

除了最后一步，一切都在工作。在最后第二步中，我可以看到在 OnPropertyChanged 触发后再次访问该属性。所以我不明白为什么绑定没有选择这个改变并启动转换器。我认为这可能是由于按钮项位于数据网格中以及使用路径和元素名称的绑定。

我从[这里](http://www.codeproject.com/Articles/286171/MultiBinding-in-Silverlight-5)使用 Silverlight 5 的 MultiBinding 解决方案。

而且我已经看到[了这个问题](https://stackoverflow.com/questions/5583830/multibinding-with-multivalueconverter-does-not-update?tab=active)，但它的解决方案在 Silverlight (Binding.IndexerName) 中不可用。

因此，在实际控件中，我有一个数据网格，其中每一行都有一个文本块和一个按钮。

Button IsEnabled 绑定到一个转换器，其中三个值来自 ViewModel（属性 AC），一个来自 datagrid.ItemSource (Id)。

```
<Button Tag="{Binding Id}"
    IsEnabled="{multibinding:MultiBinding Mode=TwoWay,
    UpdateSourceTrigger=PropertyChanged, 
    Source1={Binding Path=DataContext.PropertyA, ElementName=LayoutRoot}, 
    Source2={Binding Path=DataContext.PropertyB, ElementName=LayoutRoot}, 
    Source3={Binding Id},
    Source4={Binding Path=DataContext.PropertyC, ElementName=LayoutRoot}, 
    Converter={StaticResource myConverter}}"> 
```

Button Click 事件绑定到我的 viewModel 上的命令。

```
<i:Interaction.Triggers>
  <i:EventTrigger EventName="Click">
    <i:InvokeCommandAction Command="{Binding Path=DataContext.ClickCommand, ElementName=LayoutRoot}"
                                                                CommandParameter="{Binding Id}"/>
 </i:EventTrigger>
</i:Interaction.Triggers> 
```

在 viewModel 中触发 OnPropertyChanged 事件

```
public void OnClickCommand(int Id)
{OnPropertyChanged("PropertyA");} 
```

实际上，我只是设置了一个 hack 来刷新整个控件，这将重新初始化并重新启动转换器，但是对于解决此问题的任何帮助将不胜感激。

# c# - 在不知道类型的情况下返回泛 型

> ID：12625209
> 
> 赞同：8
> 
> 时间：2012-09-27T15:46:57.540
> 
> 标签：c#, generics, inheritance, types, factory

我有一种情况，我有一个类在其泛型类型参数中接受某个对象类型的实例。布局是这样的：

```
public abstract BaseClass { ... }
public DiamondClass : BaseClass { ... }
public SilverClass : BaseClass { ... }

public Handler<T> where T : BaseClass { ... } 
```

**我希望**能够创建一个方法来返回一个实例，`Handler<DiamondClass>`或者`Handler<BaseClass>`在输入时不定义类型。我已经尝试过这些方面的东西：

```
public Handler<BaseClass> GetHandler(HandlerType type)
{
    switch(type)
    {
        case HandlerType.Diamond: return new Handler<DiamondClass>();
        case HandlerType.Silver: return new Handler<SilverClass>();
        default: throw new InvalidOperationException("...");
    }
} 
```

但这不起作用，因为显然`Handler<DiamondClass>`不会隐式转换为`Handler<BaseClass>`. 我可以这样指定：

```
public Handler<T> GetHandler<T>(HandlerType type) where T : BaseClass
{
    switch(type)
    {
        case HandlerType.Diamond: return (Handler<T>)new Handler<DiamondClass>();
        case HandlerType.Silver: return (Handler<T>)new Handler<SilverClass>();
        default: throw new InvalidOperationException("...");
    }
} 
```

但现在我需要调用`GetHandler<DiamondClass>`or `GetHandler<BaseClass>`。这违背了拥有一个基于枚举返回正确处理程序的方法的目的，而不知道类型。我希望我可以定义一个`Type`对象并传递它，如下所示：

```
 Type objType = typeof(DiamondClass);
 var handler = Handler<objType>(); 
```

但显然 C# 不允许这种愚蠢行为。我已经采取了几种不同的方式，我想有办法做到这一点，但我很难过。

* * *

（实际上，我确实通过返回一个`dynamic`对象来完成这项工作，但如果可能的话，我想避免它，因为它失去了任何类型安全和 Intellisense 支持。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T15:50:01.267

这就是*协*变发挥作用的地方，协变和逆变仅适用于接口和委托，因此，要解决您的问题，只需将新接口定义`IHandler`为*协变*，[`out`](http://msdn.microsoft.com/en-us/library/dd469487.aspx)其中指定类型参数是协变的：

```
public interface IHandler<out T> where T : BaseClass 
{
} 
```

具有协变类型参数的接口使其方法能够返回比类型参数指定的更多的派生类型

它会起作用的。更多信息在[这里](http://msdn.microsoft.com/en-us/library/dd799517.aspx)

# java - 有不同风格的“REST”吗？

> ID：12625212
> 
> 赞同：1
> 
> 时间：2012-09-27T15:47:01.383
> 
> 标签：java, .net, rest, protocols

我在 Microsoft Stack 公司工作。我们在一些项目中使用了 REST，所以我知道它可以很好地与 Microsoft 技术配合使用。

但是现在我们有一家外部公司为我们提供 REST 服务。该公司不使用任何 Microsoft 技术。（他们主要使用Java）

我的理解是 REST 是一种协议，使用什么技术来构建它并不重要。Microsoft 工具应该能够使用它。

但我通常将我的阅读和学习限制在 Microsoft Stack，所以我不确定这一点。任何有 Java 和 Microsoft 经验的人都可以让我知道其中一个和另一个使用的 REST 服务是否可以很好地协同工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:53:18.130

REST 是一种架构风格——它可以与 Java/.NET/Ruby/Whatever 一起使用。

如果写得正确，任何现代语言都可以使用 REST API。

# java - 在 linux 服务器上启动 netty 应用程序

> ID：12625222
> 
> 赞同：2
> 
> 时间：2012-09-27T15:47:35.420
> 
> 标签：java, linux, netty, background-process

我写了一个小的 netty 服务器应用程序，打包在一个我想部署在 linux 服务器上的 jar 文件中。

由于我没有部署 java 应用程序的专业经验，我想知道通过以下方式启动 netty 服务器是否足够：

```
java -jar NettyServer.jar  NettyServer & 
```

显然，可以创建一个脚本来确保正确的用户启动进程等，但这是部署（独立）java 服务的方式吗？

这似乎太容易了，考虑到其他所有问题/答案似乎都提到了一些大的容器-bean-glassfish-tomcat-whatnot（如果/当出现问题时我可能会考虑稍后）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:54:00.767

是的，就是这样——不需要容器！！我使用 netty 作为底层框架构建了一个中间件（[http://sourceforge.net/projects/serviceconnecto/ ）。](http://sourceforge.net/projects/serviceconnecto/)这也是我启动服务器的方式！只需验证类路径设置是否正确——这意味着库位于正确的位置并且 jar 存档已正确构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T08:13:32.907

我个人更喜欢 Upstart 在 linux 上启动服务。[http://upstart.ubuntu.com/](http://upstart.ubuntu.com/) 非常好用，也可以在崩溃时重启你的应用程序。我希望它有所帮助。

# c - select() 如何提醒 fd “准备好”？

> ID：12625224
> 
> 赞同：26
> 
> 时间：2012-09-27T15:47:36.420
> 
> 标签：c, linux, sockets, messaging, file-descriptor

我不知道为什么我很难找到这个，但我正在查看一些 linux 代码，我们正在使用`select()`等待文件描述符来报告它已经准备好。从选择的手册页：

```
select() and pselect() allow a program to monitor multiple file descriptors,
waiting until one or more of the file descriptors become "ready" for some
class of I/O operation 
```

所以，太好了……我在某个描述符上调用 select，给它一些超时值，然后开始等待指示消失。文件描述符（或描述符的所有者）如何报告它“准备好”以便`select()`语句返回？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-27T16:38:19.200

*它通过*返回报告它已准备好。

`select`等待通常不在您的程序控制范围内的事件。本质上，通过调用`select`，您的程序会说“我无事可做，直到...，请暂停我的进程”。

您指定的条件是一组事件，其中任何一个都会唤醒您。

例如，如果您正在下载某些东西，您的循环将不得不等待新数据到达，如果传输卡住则发生超时，或者用户中断，这正是这样`select`做的。

当您进行多次下载时，到达任何连接的数据都会触发程序中的活动（您需要将数据写入磁盘），因此您需要`select`在文件描述符列表中提供所有下载连接的列表以供监视“读”。

当您同时将数据上传到某个地方时，您再次使用`select`来查看连接当前是否接受数据。如果对方在拨号，它只会缓慢地确认数据，所以你的本地发送缓冲区总是满的，任何写入更多数据的尝试都会阻塞，直到缓冲区空间可用，或者失败。通过将我们发送到的文件描述符`select`作为“写入”描述符传递，一旦缓冲区空间可用于发送，我们就会收到通知。

一般的想法是您的程序变成*事件驱动的*，即它对来自公共消息循环的外部事件做出反应，而不是执行顺序操作。你告诉内核“这是我想做的一组事件”，内核给你一组已经发生的事件。两个事件同时发生是相当普遍的；例如，一个 TCP 确认包含在一个数据包中，这可以使同一个 fd 既可读（数据可用）又可写（确认的数据已从发送缓冲区中删除），因此您应该准备好处理所有事件在再次调用之前`select`。

更好的一点是，它`select`基本上给你一个承诺，即一次调用`read`或`write`不会阻塞，而不对调用本身做任何保证。例如，如果有 1 个字节的缓冲区空间可用，您可以尝试写入 10 个字节，内核会返回说“我已写入 1 个字节”，因此您也应该准备好处理这种情况。一个典型的做法是有一个缓冲区“要写入这个fd的数据”，只要它不为空，就将fd添加到写入集中，通过尝试将所有内容写入来处理“可写”事件当前在缓冲区中的数据。如果之后缓冲区为空，那很好，如果不是，请再次等待“可写”。

“异常”集很少使用——它用于具有带外数据的协议，其中数据传输可能会阻塞，而其他数据需要通过。如果您的程序当前无法接受来自“可读”文件描述符的数据（例如，您正在下载，并且磁盘已满），您不希望将描述符包含在“可读”集中，因为您无法处理该事件`select`如果再次调用将立即返回。如果接收方将 fd 包含在“异常”集中，并且发送方要求其 IP 堆栈发送带有“紧急”数据的数据包，则接收方会被唤醒，并可以决定丢弃未处理的数据并与发送方重新同步. 这`telnet`协议使用它，例如，用于 Ctrl-C 处理。除非您正在设计需要此类功能的协议，否则您可以轻松地将其排除在外，而不会造成任何伤害。

强制代码示例：

```
#include <sys/types.h>
#include <sys/select.h>

#include <unistd.h>

#include <stdbool.h>

static inline int max(int lhs, int rhs) {
    if(lhs > rhs)
        return lhs;
    else
        return rhs;
}

void copy(int from, int to) {
    char buffer[10];
    int readp = 0;
    int writep = 0;
    bool eof = false;
    for(;;) {
        fd_set readfds, writefds;
        FD_ZERO(&readfds);
        FD_ZERO(&writefds);

        int ravail, wavail;
        if(readp < writep) {
            ravail = writep - readp - 1;
            wavail = sizeof buffer - writep;
        }
        else {
            ravail = sizeof buffer - readp;
            wavail = readp - writep;
        }

        if(!eof && ravail)
            FD_SET(from, &readfds);
        if(wavail)
            FD_SET(to, &writefds);
        else if(eof)
            break;
        int rc = select(max(from,to)+1, &readfds, &writefds, NULL, NULL);
        if(rc == -1)
            break;
        if(FD_ISSET(from, &readfds))
        {
            ssize_t nread = read(from, &buffer[readp], ravail);
            if(nread < 1)
                eof = true;
            readp = readp + nread;
        }
        if(FD_ISSET(to, &writefds))
        {
            ssize_t nwritten = write(to, &buffer[writep], wavail);
            if(nwritten < 1)
                break;
            writep = writep + nwritten;
        }
        if(readp == sizeof buffer && writep != 0)
            readp = 0;
        if(writep == sizeof buffer)
            writep = 0;
    }
} 
```

如果我们有可用的缓冲区空间并且在读取端没有文件结束或错误，我们会尝试读取，如果缓冲区中有数据，我们会尝试写入；如果到达文件结尾并且缓冲区为空，那么我们就完成了。

这段代码的行为显然不是最理想的（它是示例代码），但是您应该能够看到内核在读取和写入方面做的比我们要求的少是可以接受的，在这种情况下，我们只需返回并说“无论何时你准备好了”，而​​且我们从来没有在不询问它是否会阻塞的情况下读取或写入。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-27T15:55:43.637

从同一个手册页：

> 在退出时，集合被修改以指示哪些文件描述符实际更改了状态。

因此，使用`FD_ISSET()`传递给 select 的集合来确定哪些 FD 已准备好。

# php - Ajax 调用未传递任何 POST 值

> ID：12625227
> 
> 赞同：0
> 
> 时间：2012-09-27T15:47:42.847
> 
> 标签：php, jquery, mysql, ajax

我有一个具有可排序行的表。该表是从一个 mysql 数据库生成的，该数据库具有一个名为“displayorder”的字段，用于对表进行排序。当用户拖放行时，我想在用户删除行时使用 AJAX 将这些更改提交到数据库。

目前，我可以看到来自 AJAX 调用成功部分的 console.log() 输出，当我在那里输出数据（顺序）时，它看起来很棒，如下所示： `["order_1=1", "order_2=2", "order_4=3", "order_3=4"]`

但是根据 Firebug 的说法，在 $_POST 中传递的所有内容都是“未声明的”。如何从我的 indexpage_order.php 文件中访问该 order 变量？

我有这个 jquery 代码：

```
 <script>
    $(document).ready(function() {
        var fixHelper = function(e, tr) {
            var $originals = tr.children();
            var $helper = tr.clone();
            $helper.children().each(function(index)
            {
              $(this).width($originals.eq(index).width())
            });
            return $helper;
        };
        var sortable = $("#sort tbody").sortable({
        helper: fixHelper,
        stop: function(event, ui) {
            //create an array with the new order
            order = $(this).find('input').map(function(index, obj) {
                var input = $(obj);
                input.val(index + 1);
                return input.attr('id') + '=' + (index + 1);
            });
            $.ajax({
                    type: 'POST',
                    url: 'indexpage_order.php',
                    data: order,
                error: function() {
                    console.log("Theres an error with AJAX");
                },
                success: function(order) {
                    console.log("Saved.");
                    console.log(order);
                }
            });
            return false;
        }
        });
    });
    </script> 
```

indexpage_order.php 包含：

```
if(isset($_POST) ) {

    while ( list($key, $value) = each($_POST) ) {
        $id = trim($key,'order_'); //trim off order_
        $sqlCommand = 
            "UPDATE indexpage 
             SET displayorder = '".$value."' 
             WHERE id = '".$id."'";
        $query = mysqli_query($myConnection,$sqlCommand) or die (mysqli_error($myConnection));
        $row = mysqli_fetch_array($query);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:08:40.890

您可以简单地重写为 POST 生成数据的 js 代码。

```
order = {}
$(this).find('input').map(function(index, obj)
  { 
    return order[this.id] = index;
  }
) 
```

休息应该在 PHP 中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:01:13.307

看起来您在 JavaScript 数组中发送订单

当它到达你的 PHP 时，它是不可读的。

如果它是一个对象，请查看[json_decode](http://php.net/manual/en/function.json-decode.php)函数。如果它是一个数组，则在数据传输之前对其进行序列化，然后在 php 端进行反[序列化。](http://php.net/manual/en/function.unserialize.php)

PHP 无法理解 JavaScript 数组或对象，除非它们被正确编码/序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:08:45.357

`order`是一个数组。在你的 ajax 脚本`order`中像这样转换，`query string`

`data: order.join('&'),`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T15:49:57.947

在 PHP 文件中尝试使用 $_REQUEST 而不是 $_POST 来使用 ajax 的 POST 方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T16:03:38.517

将 js 数组转换`order`为 json 对象，因为 ajax 数据需要在 json 中使用`JSON.stringify`. 因此，它需要`data:JSON.stringify(order),`在 ajax 函数中。

或者，在 ajax 函数中`json_encode`像这样使用`data: <?php echo json_encode(order); ?>,`

# wpf - 根据视图模型中的更改更新依赖属性

> ID：12625232
> 
> 赞同：2
> 
> 时间：2012-09-27T15:47:52.283
> 
> 标签：wpf, mvvm, viewmodel, dependency-properties

我在 WPF 中的数据绑定方面遇到了一些问题。下面是场景：我制作了一个模拟拨号盘的用户控件（即，一个由 12 个按钮组成的数组，数字从“0”到“9”加上“#”和“清除”键）。该控件位于类库中，它是按照 MVVM 模式实现的，主要是因为我需要类库中的组件易于进行单元测试。

控件的视图模型非常简单，每次用户按下拨号盘按键时，它基本上都会更新一个公共的“DialedNumber”字符串（内部连接到模型）。绑定工作正常，通过使用调试器，我可以确认视图模型中的“DialedNumber”变量正在更新，因为我按下拨号盘中的按钮。

这个 DialPad 控件由一个单独的 XAML 文件 (Panel.xaml) 使用，该文件列出了属于我的自定义类库的几个控件。

现在，我想在 Panel 文件中添加一个 TextBlock，以显示 DialPad 中保存的“DialedNumber”字符串。这是 Panel.xaml 中的代码片段：

```
<PanelControls:DialPad x:Name="MyDialPad" DialedNumber="55325"/>
<TextBlock Text="{Binding ElementName=MyDialPad, Path=DialedNumber}" /> 
```

我得到的结果是文本块在开始时显示正确的数字（即“55325”），但是当我按下拨号盘键时它的内容没有得到更新（即使拨号盘的视图模型在我按下时得到更新）新键，正如我用调试器检查过的那样）。

下面是 DialPad 视图的代码：

```
public partial class DialPad : UserControl
{
    public DialPad()
    {
        InitializeComponent();
        DataContext = new DialPadViewModel();
    }

    public void DialedNumberChanged(object sender, EventArgs e)
    {
        return;
    }

    public DialPadViewModel DialPadViewModel
    {
        get { return DataContext as DialPadViewModel; }
    }

    public string DialedNumber
    {
        get
        {
            var dialPadViewModel = Resources["DialPadVM"] as DialPadViewModel;
            return (dialPadViewModel != null) ? dialPadViewModel.DialedNumber : "";
        }
        set
        {
            var dialPadViewModel = Resources["DialPadVM"] as DialPadViewModel;
            if (dialPadViewModel != null)
            {
                dialPadViewModel.DialedNumber = value;
            }
        }
    }
} 
```

这是 DialPad 视图模型：

```
public class DialPadViewModel : ObservableObject
{
    public DialPadViewModel()
    {
        _dialPadModel = new DialPadModel();
    }

    #region Fields

    private readonly DialPadModel _dialPadModel;
    private ICommand _dialPadKeyPressed;

    #endregion

    #region Public Properties/Command

    public DialPadModel DialPadModel
    {
        get { return _dialPadModel; }
    }

    public ICommand DialPadKeyPressedCommand
    {
        get
        {
            if (_dialPadKeyPressed == null)
            {
                _dialPadKeyPressed = new RelayCommand(DialPadKeyPressedCmd);
            }
            return _dialPadKeyPressed;
        }
    }

    public string DialedNumber
    {
        get { return _dialPadModel.DialedNumber; }
        set
        {
            _dialPadModel.DialedNumber = value;
            RaisePropertyChanged("DialedNumber");
        }
    }

    #endregion

    #region Private Helpers

    private void DialPadKeyPressedCmd(object parameter)
    {
        string keyPressedString = parameter.ToString();

        if (keyPressedString.Length > 0)
        {
            if (char.IsDigit(keyPressedString[0]))
            {
                DialedNumber += keyPressedString[0].ToString(CultureInfo.InvariantCulture);
            }
            else if (keyPressedString == "C" || keyPressedString == "Clr" || keyPressedString == "Clear")
            {
                DialedNumber = "";
            }
        }
    }

    #endregion
} 
```

让我重申一下我的问题：Panel.xaml 中的文本块在开始时显示正确的数字 (55325)，但当我按下 DialPadButtons 时它的值永远不会更新。我在 DialPadKeyPressedCmd 中放置了一个断点，我可以确认每次按下拨号盘中的键时都会执行该方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:11:29.100

如果将 DialPad 放在 View 中，则可以在 ViewViewModel 中创建 DialPadViewModel-Property (public+global)：

```
public DialPadViewModel DialPadViewModel = new DialPadViewModel(); 
```

现在将 View 的 DataContext-Binding 设置为 ViewViewModel 并将 DialPads DataContext 也绑定到它，例如

```
<local:DialPad DataContext="{Binding}"/> 
```

现在您可以绑定到 DialPadViewModel 中的属性：

```
<TextBox Text="{Binding Path=DialPadViewModel.DialedNumber}"/> 
```

这就是你如何从你的视图和你的拨号盘访问你的拨号盘视图模型。

编辑：

现在尝试更改 DialPad.xaml.cs 中的 DialedNumber 属性，如下所示：

```
public string DialedNumber
{
    get
    {
        return DialPadViewModel.DialedNumber;
    }
    set
    {
        DialPadViewModel.DialedNumber = value;
    }
} 
```

编辑2：我发现了问题：

在您的 DialPad.xaml 中，您的所有命令都从资源绑定到 DialPadViewModel，而 TextBloc 绑定到 DialPads DataContext，这是 DialPadViewModel 的另一个实例。

因此，每次您点击 DialPad-Button 时，您都会从资源的 DPVM 实例中更改 DialedNumber 的值，而不是从 DataContext 的 DPVM 实例中更改 DialedNumber。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:21:08.827

DependencyProperties 旨在指向其他一些属性以获取它们的值。因此，您可以将其指向您的`DialPadViewModel.DialedNumber`，也可以在使用 UserControl 时将其指向其他字符串（绑定或硬编码值，如“551”），但您不能两者都做。

在您的情况下，当有人绑定到`DialedNumber`依赖项属性时，他们正在用新值替换当前值（绑定到`DialPadViewModel.DialedNumber`）。

根据您的代码的外观和您想要做什么，有几种方法可以解决它。

首先，您可以坚持让想要使用您的控件的人也使用您的 ViewModel，并且不要创建`DialedNumber`公共依赖属性。

因此，而不是被允许创建具有属性`SomeOtherDialedNumber`和绑定的自定义类

```
<DialPad DialedNumber="{Binding SomeOtherDialedNumber}"> 
```

他们被迫`DialPadViewModel`在他们想要使用 DialPad 控件的任何时候在他们的代码中使用。为此，您需要删除`this.DataContext = new DialPadViewModel`UserControl 代码隐藏中的`DialPadViewModel``DialPadViewModel``DialPad`

```
<DataTemplate DataType="{x:Type DialPadViewModel}">
    <local:DialPad />
</DataTemplate> 
```

我能想到的另一种选择是将您的 DependencyProperty 与您的 ViewModel 属性与一些 PropertyChange 通知同步。

您需要`DialPadViewModel.DialedNumber`在`DialedNumber`依赖属性更改时进行更新（您可能需要使用[DependencyPropertyDescriptor.AddValueChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.addvaluechanged.aspx)进行属性更改通知），并且您还必须编写一些内容来在更改时更新`DialedNumber`依赖属性的源`DialPadViewModel.DialedNumber`。

就个人而言，如果我的 UserControl 有一个 ViewModel，那么我使用第一个选项。如果不是，我完全摆脱 ViewModel 并在代码隐藏中为我的 UserControl 构建逻辑，而不使用 ViewModel。

这样做的原因是 WPF 使用两个层：UI 层和数据层。这`DataContext`是数据层，ViewModel 通常是数据层的一部分。通过在 UserControl 的构造函数中显式设置数据层 ( `DataContext`)，您将数据层与 UI 层结合起来，这违背了使用 MVVM 的最大原因之一：关注点分离。UserControl 应该只是一个漂亮的外壳，您应该能够将它放置在您想要的任何数据层之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:05:12.143

听起来您可以在视图中添加一个 TextBox 并将其 Text 属性绑定到您的视图模型的 DialedNumber 属性。

```
 <TextBox Text="{Binding Path=DialedNumber}"></TextBox> 
```

您的视图模型属性可能如下所示：

```
 private string _dialedNumber;
    [DefaultValue("551")]
    public string DialedNumber
    {
        get { return _dialedNumber; }
        set
        {
            if (value == _dialedNumber)
                return;
            _dialedNumber= value;
            _yourModel.DialedNumber= _dialedNumber;
            this.RaisePropertyChanged("DialedNumber");
        }
    } 
```

如果我误解了你的问题，请告诉我。

# audio - 构建兼容 ADC 核心音频的 USB 或火线

> ID：12625240
> 
> 赞同：1
> 
> 时间：2012-09-27T15:48:12.643
> 
> 标签：audio, usb, core, adc

我正在寻找有关如何构建符合 ADC Core Audio 以连接到 mac USB 或 Firewire 的文档。我一直在寻找有关如何在计算机端编程时处理核心音频的信息。

我需要有关如何使音频硬件 Core Audio 兼容的信息。

谁能给我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T21:03:19.273

这是一个很好的解决方案。它为您完成所有艰苦的工作。如果您甚至有基本的硬件工程经验，这应该可以帮助您上路。这个芯片会很好用。需要很少的外部组件。 [http://www.silabs.com/products/interface/usbtouart/Pages/usb-to-i2s-digital-audio-bridge.aspx](http://www.silabs.com/products/interface/usbtouart/Pages/usb-to-i2s-digital-audio-bridge.aspx)

# c++ - 这个结构的大小

> ID：12625244
> 
> 赞同：2
> 
> 时间：2012-09-27T15:48:24.607
> 
> 标签：c++, sizeof

> **可能重复：**
> [为什么结构的 sizeof 不等于每个成员的 sizeof 之和？](https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member)

我随机创建了一个结构，它的大小让我感到惊讶，因为结果不等于我的计算：

```
int main( int argc, char ** argv ) {
    struct S
    {
        int i;
        int b;
        int c;
        long int e;
    };
    cout << sizeof (struct S) << endl; //sizeof is still an operator
    return 0;
} 
```

通常，3*int + 1*long int = 3*4 + 8 = 20。

但是，结果是 24。

这 4 个字节来自哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T15:50:50.350

你`struct`被*填充*了四个字节，大概是放置`long int`在 8 字节边界上以加快对它的访问。这取决于平台：并非所有编译器都会添加这些字节。

# iphone - 在应用委托中弹出到根视图控制器

> ID：12625249
> 
> 赞同：4
> 
> 时间：2012-09-27T15:48:39.590
> 
> 标签：iphone, objective-c, ios, xcode

我有一个有人登录的应用程序，如果他们在将其发送到后台超过 10 分钟后启动它，我会弹出一个不错的小“会话已过期”警报并将它们发送到根视图控制器（登录页面）。

一切正常，但我不知道如何从应用程序委托的 applicationWillEnterForeground: 方法弹出到导航控制器堆栈中的根视图控制器。

我尝试将 navigationController 保存到 appDelegate 变量中，但我想知道应用程序是否在后台运行了几天，如果 iOS 开始释放一些变量，因为当时我在此方法中遇到错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T15:51:31.617

如果导航控制器是您的应用程序的根视图控制器，那么您可以像这样获得它：

```
UINavigationController *myNavCon = (UINavigationController*)self.window.rootViewController; 
```

`self`应用程序委托在哪里

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-12T06:58:57.280

只是为了让事情更清楚，可以使用以下从 AppDelegate 弹出到 rootviewcontroller

```
UINavigationController *navigationController = (UINavigationController  *)self.window.rootViewController;
[navigationController popToRootViewControllerAnimated:YES]; 
```

这里 self 是应用程序委托。

# c++ - 在双链表中插入节点

> ID：12625254
> 
> 赞同：1
> 
> 时间：2012-09-27T15:49:11.660
> 
> 标签：c++, linked-list

我正在尝试将节点添加到链表的开头。这是我的代码，但是当我对其进行测试时，它不起作用。关于我可能做错了什么的任何想法？在此先感谢您的帮助！

```
void List<T>::insertFront(T const & insert)
{
    ListNode * newNode = new ListNode(insert);
    if (head != NULL)
    {
        head->prev = newNode;
        head = head->prev;
        head->prev = NULL;
    }
    else
    {
        head = newNode;
        tail = newNode;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:54:06.450

双向链表以两种方式链接，您仅以一种方式附加新节点。

你需要一个：

`newnode->next = head;`

在你解开旧头之前在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-09T07:05:53.147

**尝试这个。**

**下面的方法只接受输入并制作一个双向链接列表**

```
node DoublyLinkedList()
{
node *list, *tptr, *nptr;
int n, item;
cout << "Enter numbers of node: ";
cin >> n;
list = NULL;
tptr = NULL;
for (int i = 0; i < n; i++)
{
    //Input new node value
    cout << "Enter Item " << i + 1 << ": ";
    cin >> item;
    //Creating new node
    nptr = new(node);
    nptr->back = NULL;
    nptr->data = item;
    nptr->next = NULL;

    if (list == NULL)
    {
        list = nptr;
        tptr = nptr;
    }
    else
    {
        tptr->next = nptr;
        nptr->back = tptr;
        tptr = nptr;
    }
}
cout << endl;
tptr = list;
while (tptr != NULL)
{
    cout << tptr->data;
    tptr = tptr->next;
    if (tptr != NULL)
    {
        cout << "<=>";
    }
}
return *list;
} 
```

**使用以下方法插入新节点**

```
void InsertToDoubly()
{
node *list, *tptr, *nptr, *pptr;
int newItem;
list = new(node);
tptr = NULL;
pptr = NULL;
*list = DoublyLinkedList(); // See this method implementation above.
cout << endl;
cout << "Input new node value to insert: ";
cin >> newItem;

nptr = new(node);
nptr->back = NULL;
nptr->data = newItem;
nptr->next = NULL;

tptr = list;
int i = 0;
while (tptr != NULL && tptr->data < newItem)
{
    pptr = tptr;
    tptr = tptr->next;
    i++;
}
if (i == 0)
{
    // Inserting at the beggining position.
    nptr->next = tptr;
    tptr->back = nptr;
    list = nptr;
}
else if (tptr == NULL)
{
    //Inserting at the last position
    pptr->next = nptr;
    nptr->back = pptr;
}
else
{
    //Inserting into the middle position
    pptr->next = nptr;
    nptr->back = pptr;
    nptr->next = tptr;
    tptr->back = nptr;
}
tptr = list;
ShowNode(tptr);
cout << endl;
} 
```

**主要方法**

```
int main()
{
   InsertToDoubly();
} 
```

# r - 如何在R中使用数据头作为变量名

> ID：12625263
> 
> 赞同：0
> 
> 时间：2012-09-27T15:50:07.447
> 
> 标签：r, variables, header

我正在尝试运行逐步回归，`R`其中包含 600 个奇数变量作为 .csv 文件标题中的列名。

如何将列名用作回归方程中的变量？

我对此非常陌生，并且我的理解有限，我可以将列保存为列表并将其用于运行 glm，例如

`model.1 <- glm(x~ paste(list), family= poisson, link = logit).`

非常感谢任何帮助。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:03:50.277

如果您已正确读取数据（例如，`header=TRUE`如上面评论中指定的那样），您最终应该得到一个 600+ 列的数据框（`x`响应的 1 列，每个预测变量的列）：我会调用现在这个`mydata`。在这种情况下，正如@TylerRinker 建议的那样，您可以只包含所有预测变量：`glm(x~.,data=mydata,family=poisson)`（logit 链接是默认链接；如果您想明确指定它，您可以说`glm(x~.,data=mydata,family=poisson(link="logit"))`。然后您可以使用`step`, 或`stepAIC`来自 MASS 包。

但是，我必须补充一点，除非您知道自己在做什么，否则从统计的角度来看，对 600 个变量进行逐步回归是一个***非常非常非常糟糕***的想法（谷歌类似于“逐步回归问题”或“逐步回归 Harrell ”）。我强烈建议您看一下类似`glmnet`包的东西，它采用了一种更明智的方法来使用大量预测变量进行建模。

# c - 在条件语句中分配可变长度的字符串

> ID：12625267
> 
> 赞同：0
> 
> 时间：2012-09-27T15:50:22.343
> 
> 标签：c, string, scope

我是 C 新手，我正在尝试制作一个可变长度的字符串，如下所示：

```
int main(int argc, char *argv[]) {
    if (argc > 1) {
        char filename[] = argv[1];
    }
    else {
        char filename[] = "temp.txt";
    }
    printf("%s", filename);
} 
```

当然，这不起作用，因为字符串的范围仅在条件语句内。

如何根据条件语句将此变量分配给未知长度的字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:52:20.007

这是一种方式：

```
char* filename = "this is a different one";

if (boolean)
    filename = "this is a file name";

printf("%s", filename); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:52:28.647

在简单的情况下，如您的示例中，您可以`char *`在外部范围声明 a ：

```
char *str = "a different file name";
if (boolean)
    str = "this file name"; 
```

但是任何更复杂的事情，你都需要保留一个缓冲区。通常文件名/路径操作更复杂。您*可以*使用 eg 执行与上述相同的操作`argv[1]`，但我会复制参数，因为我可能会在稍后的程序中进行*更改* `filename`，并且只需将新指针分配给参数数组或文字字符串，就会造成问题。

```
char filename[MAX_PATH + 1];

strncpy(filename, "temp.txt", MAX_PATH);
if (argc > 1)
    strncpy(filename, argv[1], MAX_PATH);

// .. later
strncat(filename, "temp.txt", MAX_PATH); 
```

但是，如果您只设置`filename`一次，以下也将起作用：

```
char *filename = "temp.txt";

if (argc > 1)
    filename = argv[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T15:53:08.367

您必须在 if 语句之外声明文件名变量，否则在 if 语句之后它将不可见。在 if 语句中，您必须使用 strcpy 将字符串复制到变量中。如果您不必更改字符串，则可以使用 char 指针而不是 char 数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T15:57:07.677

在条件语句之前定义字符串。然后使用字符串复制功能，例如`strcpy`，将您想要的值放入字符串中。例如：

```
char filename[ MAX_PATH ];  
if (boolean) { 
    strcpy( filename, "this file name" ); 
} 
else { 
    strcpy( filename, "a different file name" ); 
} 
printf("%s", filename); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T15:53:39.290

```
char filename[256];

if (boolean) {
    strcpy(filename,"this file name");
}
else {
    strcpy(filename, "a different file name");
}
printf("%s", filename); 
```

或者您可以使用它`malloc`来分配内存并复制字符串。

# javascript - simpleCart.checkout() 抛出 this.create 不是函数

> ID：12625269
> 
> 赞同：0
> 
> 时间：2012-09-27T15:50:24.127
> 
> 标签：javascript

我使用 simpleCart。我尝试开始结帐过程，所以我这样做

```
<script>
$(document).ready(function(){
    simpleCart.checkout();
})
</script> 
```

但我知道 this.create 不是函数 Line: 1385。知道为什么会发生这种情况吗？这是链接[http://nmse.edge1.net/order-online](http://nmse.edge1.net/order-online)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T20:47:22.060

simpleCart(js) 需要使用 jQuery、Prototype 或 Mootools。

# c++ - 在非常量函数中使用 const_iterator

> ID：12625271
> 
> 赞同：0
> 
> 时间：2012-09-27T15:50:32.490
> 
> 标签：c++, stl, iterator

我有一个类似于以下结构的程序：

```
class A {
    private:
        std::set<B> members;
    public:
        void func(const C& arg) {
            std::set<B>::iterator iter = members.find(a);
            if(iter != members.end()) {
                iter->check(arg);
            }
        }
}

class B {
    private:
        std::deque<C> writers;
    public:
        void check(const C& arg) {
            if(std::find(writers.begin(), writers.end, arg) != writers.end()) {
                /* Code */
            }
        }
}

class C {
  private:
      int id;
  public:
      bool operator==(const C& arg) {
          return arg.id == this->id;
      }
} 
```

当我编译它时，我收到以下错误消息：

```
no matching function for call to ‘B::check(const C&) const’  
note: candidates are: void B::check(const C&) <near match> 
```

如果我声明`check()`为，`const`那么编译器会抛出一个错误，要求将`==`C 类中的重载运算符声明为`const`. 我不知道是否将重载运算符设为`const`正确的做法。（我试过一次，据我记得它也给出了一些错误）。

我已经尝试解决这个问题超过五天了，但仍然没有线索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:54:17.030

首先`operator==` **应该**是`const`。它不会修改数据，也不应该修改数据，除非您想迷惑您的用户。一般来说，每个不需要修改对象状态的函数都应该`const`提供最大的灵活性（即允许通过常量引用进行调用）。

同样可以应用于`B::check`，如果它只测试而不修改，那么它应该是`const`。并且通过扩展`A::func`，如果它不需要修改，那么它应该是 const。

错误信息在不同的编译器中会略有不同。在您的情况下，编译器执行了重载解析并且没有找到与它抱怨的调用匹配：

> 没有匹配函数调用 'B::check(const C&) const'<br> 注意：候选者是：void B::check(const C&)

这表明它看到了您的成员但将其丢弃，因为它需要带有`const`标签的成员函数。在其他编译器中，错误消息将包含以下内容：*调用`void B::check(const C&)`丢弃限定符*，这有点复杂，并试图说明在 const 引用上调用非常量成员函数需要忽略`const`限定符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T15:59:20.667

您绝对应该声明`B::check()`并且`C::operator==`因为`const`它们不会更改对象状态中的任何内容。

此外，它可能不是那么明显，但`std::set<B>::iterator`实际上是[`const_iterator`](http://en.cppreference.com/w/cpp/container/set)（假设您使用的是 C++11 编译器）！因此，您无法通过迭代器从`B`对象中调用任何非常量函数成员。`set`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-27T16:00:33.637

请记住，如果可能，您应该更喜欢非常量版本。至少这是斯科特·梅伯所说的。

这是一个很长的讨论：

[我应该更喜欢迭代器而不是 const_iterators 吗？](https://stackoverflow.com/questions/765257/should-i-prefer-iterators-over-const-iterators)

# struts2 - struts2 - 是否可以在动作类中以地图的形式接受请求参数？

> ID：12625272
> 
> 赞同：0
> 
> 时间：2012-09-27T15:50:35.937
> 
> 标签：struts2, struts

我有一个像这样的课程：

```
class FileAction{
   Map<FilterType, String> grades;
 ....
} 
```

`FilterType`是一个`enum`带值的 : `GroupFilter`,`TimeFilter`等。现在，每个过滤器都应该有一个对应的值（就像`GroupFilter`会有一个对应的`groupId`）。

我希望从 UI 传递带有过滤器值的过滤器类型，并在操作类中接收它。有什么方法可以从 UI 传递数据，这些数据可以自动转换为动作类中存在的地图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:04:13.523

是的，struts2 有类型转换，你应该看看[Vita Rara上的](http://www.vitarara.org/cms/struts_2_cookbook/updating_a_list_of_domain_entities)[文档](http://struts.apache.org/2.x/docs/type-conversion.html#TypeConversion-AnadvancedexampleforindexedListsandMaps)和这个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:01:56.253

Struts2 有足够的能力将 UI 发送的数据转换`Map`为它应该知道的`Struts2`类型转换器，不幸的是，没有一个系统足够聪明，可以知道所有可用的数据类型，所以我们需要告诉系统我们的自定义类型以及转换方式他们

您需要为此创建自己的自定义类型转换器。查看有关创建自定义[类型转换器的官方文档](http://struts.apache.org/2.3.1/docs/type-conversion.html)

# iphone - 指南针航向错误校准

> ID：12625274
> 
> 赞同：1
> 
> 时间：2012-09-27T15:50:47.637
> 
> 标签：iphone, mapkit, heading

我有一个指南针应用程序，问题是它需要一些转弯才能校准。应用程序加载的第二次显示错误的航向，只有在左右转弯后才会给出正确的航向。我有“locationManagerShouldDisplayHeadingCalibration”函数返回“YES”，但它从不要求校准......也许我错过了一些技术？

谢谢

# sql - 删除 ActiveRecord 中的记录，但记录仍显示在 Localhost:3000

> ID：12625284
> 
> 赞同：0
> 
> 时间：2012-09-27T15:51:23.687
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我所做的是使用 SQLite 并手动从数据库表中删除了一些记录。当我在 Rails 服务器上测试它时，这应该会更新我的应用程序状态。但是当我转到 Localhost:3000 时，删除的记录仍然出现！

关于如何删除它以便我可以继续测试我的代码的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:21:10.773

尝试在您的项目中访问 rails 控制台

命令：

```
rails console

Model.find(id_of_model) 
```

如果存在，您可以使用以下方法将其销毁：

```
Model.find(id_of_model).destroy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:26:05.050

确保您删除了开发数据库中的记录。默认情况下，服务器在开发环境中运行。

# jquery - 带有图像的随机推荐

> ID：12625286
> 
> 赞同：0
> 
> 时间：2012-09-27T15:51:26.040
> 
> 标签：jquery, html, css, wordpress

我希望在我的主页上展示一系列推荐。我只想一次显示一个推荐。计划是在页面刷新时随机化。

我希望推荐书有引言、作者和作者的照片。在使用插件之前设法获得随机推荐，但我喜欢用图片将面孔链接到报价的想法。

我已经创建了我希望做的静态版本。

```
<div id="right_sidebar">
<div class="testimonials">
<div class="ref-picture"></div>
<blockquote>
<cite><p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce eget vestibulum elit. Cras pretium, dui sed egestas elementum, augue eros mattis erat, quis porta diam urna vitae lacus.</p>
</cite>
<div class="author">Paul Scholes - Manchester United</div>
</blockquote>
</div>
</div> 
```

CSS：

```
.testimonials {
width: 218px;
padding: 0px;
margin: 0px;
font-family: "adelle",serif;
margin-top: 13px;
padding-top: 10px;
position: relative;
}

.ref-picture {
width: 100px;
height: 100px;
border-radius: 75px;
background: url('images/testimonial1.jpg') no-repeat;
position: absolute;
top: 0px;
left: 59px;
margin: 0 auto;
padding: 0;
z-index: 2;
}

.testimonials .author {
padding: 10px;
padding-top: 0px;
font-family: "adelle",serif;
color: #dedede!important;
font-size: 11px;
border: 0px;
}

.testimonials blockquote {
font-size: 18px;
line-height: 24px;
font-family: Lato;
font-style: normal;
font-weight: lighter;
color: #333;
padding: 0px;
margin-top: 5px;
background: black;
position: relative;
top: 50px;
}

.testimonials blockquote cite {
font-size: 11px;
}

.testimonials blockquote cite p {
line-height: 16px!important;
padding: 70px 10px 20px 10px;
color: white;
} 
```

首先，这可行吗？如果是这样，有人对我如何做到这一点有任何建议吗？也许某种 JQuery 脚本？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:01:56.863

PJ,

结帐： http: [//www.wpbeginner.com/wp-tutorials/how-to-display-random-posts-in-wordpress/](http://www.wpbeginner.com/wp-tutorials/how-to-display-random-posts-in-wordpress/)

您可以使用 Wordpress Codex 中的这些信息添加其他信息，例如摘录和作者。

作者：[http ://codex.wordpress.org/Author_Templates](http://codex.wordpress.org/Author_Templates)

摘录：[http ://codex.wordpress.org/Function_Reference/the_excerpt](http://codex.wordpress.org/Function_Reference/the_excerpt)

我希望这会有所帮助！

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:05:14.023

将推荐信放在一个数组中：

```
var testimonials = [
  { picture: 'images/testimonial1.jpg', cite: 'Lorem ipsum dolor sit amet', author: 'Paul Scholes - Manchester United' },
  { picture: 'images/testimonial2.jpg', cite: 'consectetur adipiscing elit.', author: 'Paul Scholes - Manchester United' },
  { picture: 'images/testimonial3.jpg', cite: 'Lorem ipsum dolor sit amet', author: 'Paul Scholes - Manchester United' },
  { picture: 'images/testimonial4.jpg', cite: 'consectetur adipiscing elit.', author: 'Paul Scholes - Manchester United' },
  { picture: 'images/testimonial5.jpg', cite: 'Lorem ipsum dolor sit amet', author: 'Paul Scholes - Manchester United' },
  { picture: 'images/testimonial6.jpg', cite: 'consectetur adipiscing elit.', author: 'Paul Scholes - Manchester United' }
]; 
```

随机选择一个：

```
var testimonial = testimonials[Math.floor(Math.random() * testimonials.length)]; 
```

将细节放在元素中。在这里，您可以使用 jQuery 轻松查找和更新元素：

```
$('.testimonials .ref-picture').css('backgroundImage', 'url('+testimonial.picture+')');
$('.testimonials cite p').text(testimonial.cite);
$('.testimonials .author').text(testimonial.author); 
```

演示：http: [//jsfiddle.net/Guffa/wme4V/](http://jsfiddle.net/Guffa/wme4V/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:09:19.870

我完全支持 jQuery。您可以使用以下随机化插件来随机化推荐。[在此处](http://jquery.com/)阅读有关 jQuery的更多信息

```
(function($) {

$.fn.randomize = function(childElem) {
  return this.each(function() {
      var $this = $(this);
      var elems = $this.children(childElem);

      elems.sort(function() { return (Math.round(Math.random())-0.5); });  

      $this.remove(childElem);  

      for(var i=0; i < elems.length; i++)
        $this.append(elems[i]);      

  });    
}
})(jQuery); 
```

# java - 比较当前日期和以前的日期

> ID：12625288
> 
> 赞同：0
> 
> 时间：2012-09-27T15:51:32.530
> 
> 标签：java

我正在尝试比较两个日期。我的第一次约会是：

```
Date previousDate ="Returns a date as 2011-12-09 in a gregorian date" 
```

第二个日期是我的“当前日期”，我的当前日期为：

```
SimpleDateFormat format = new SimpleDateFormat("yyyy/mm/dd");
Date date=new Date(); 
```

当我尝试将当前日期与之前的日期进行比较时，我只能比较年份（或仅比较模式中的第一件事）。

```
System.out.println("date"+previousDate.compareto(format(date)); 
```

我能够将输出设为“1”，因为它只比较年份而不是整个日期。你们中的任何人都可以弄清楚我缺少什么吗？我尝试了很多方法，但都没有成功。请让我知道我是否可以解决这个问题，或者我需要一个不同的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:52:44.887

经过

```
SimpleDateFormat(yyyy/mm/dd); 
```

我猜你的意思是

```
SimpleDateFormat("yyyy/MM/dd"); 
```

但重要的一点是，按照惯例，`compareTo`通常返回 -1、0 或 1。

这是 Date#compareTo 的实现：

```
974     public int compareTo(Date anotherDate) {
975         long thisTime = getMillisOf(this);
976         long anotherTime = getMillisOf(anotherDate);
977         return (thisTime<anotherTime ? -1 : (thisTime==anotherTime ? 0 : 1));
978     } 
```

# winforms - 哪种容器控件最适合 Windows 窗体上的一组重复进度条？

> ID：12625293
> 
> 赞同：0
> 
> 时间：2012-09-27T15:51:36.913
> 
> 标签：winforms

我需要在人时对字典中为每个人显示一个进度条。对于我的进度条列表，TableLayoutPanel 似乎是一个不错的选择。它是否合适，或者我应该看什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:13:43.653

取决于你有多少“人次”对。如果您有数百或数千个，全`ProgressBars`I 成像将相当昂贵。你可以覆盖`DataGridViewCell/Column`并创建一个`DataGridViewProgressCell/Column`，这将是一个轻量级的解决方案，看起来也不错......

![进步](../Images/41cf2bb67b9b0196c51baac2e93dfd5a.png)

如果这是你之后我会给你一些代码。否则，我会按照你的建议做，使用 a`TableLayoutPanel`似乎是一个不错的选择。

我希望这有帮助。

# html - 是否可以将函数内部循环中的变量值获取到全局变量中？

> ID：12625295
> 
> 赞同：1
> 
> 时间：2012-09-27T15:51:39.183
> 
> 标签：html, function, variables, javascript

我需要在通过循环后获取变量的结果，我尝试通过使其成为全局变量来获取它的值，但它的值不会改变。这可能吗？

这是我的代码，我试图获取变量 t 的值：

```
var t;

function processSplashbacks() {
    var splashbacks = document.worktopForm.splashbacks.value;   
    for (t = 1; t <= splashbacks; t++){
        var splashbackInfo = '<label> Length: </label><input type="text" id="length' + t + '" value="0"/>(cm)<br /><label> Width: </label><input type="text" name="width' + t + '" value="0"/>(cm)<br /><br />';
        document.getElementById("splashWidLen").innerHTML += 'Splashback ' + t + ' dimensions<br />' + splashbackInfo;
    }
}

function deleteSplashbacks() {
    document.getElementById("splashWidLen").innerHTML = "";
}

console.log(t); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:57:07.660

尝试：

```
<input type="button" value="Add Splashbacks" onClick="processSplashbacks(); console.log(t);"/> 
```

据我所知，你只`console.log(t)`在一个地方打电话。它仅在页面加载时记录它，即在用户单击按钮之前。您必须`console.log(t);`在函数调用后再次调用。

也就是说，全局变量可能不是最好的解决方案。你最好做那个函数`return t;`，然后记录返回，像这样：

```
<input type="button" value="Add Splashbacks" onClick="console.log(processSplashbacks());"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:56:46.447

所以你只是想将变量设置为全局变量？

这应该有效：`window.t = t;` 只需将其放在循环中并递增。

我不确定这实际上会有多大用处。您确定要能够访问循环控制变量吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T15:57:28.917

代码中的 4 条语句是：

*   t 的声明
*   两个函数的声明
*   印刷吨

它们都在页面加载时运行，但声明一个函数并不会执行它......每当执行该函数时，它将在您的`console.log(t)`语句之后。

现在如果你写这个：

```
onClick="processSplashbacks(); console.log(t);" 
```

那么它应该工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T15:59:50.030

The function is defined, and you log the variable to the console before the function has run. Instead, you can rewrite the function to define and return its own t, and then the onclick handler can display it to the log.

# php - 虽然循环和卷曲，提交网址中的垃圾

> ID：12625296
> 
> 赞同：2
> 
> 时间：2012-09-27T15:51:41.237
> 
> 标签：php, curl, while-loop

我需要通过帖子字符串将一堆数据从 CSV 提交到 url，为此我正在执行以下操作：

```
<?php

$CSVleadfile = "leads.csv";

//lead file information lookup

$f = fopen($CSVleadfile, "r");

//begin while loop

while($row = fgetcsv($f)) {
        $contactId = $row[1];
        $createDate = $row[2];
        $callerAni = $row[3];
        $tfn = $row[4];
        $firstname = $row[5];
        $lastname = $row[6];
        $address1 = $row[7];
        $address2 = $row[8];
        $city = $row[9];
        $state = $row[10];
        $zip = $row[11];
        $homephone = $row[12];
        $email = $row[13];      

// load data for posting array

$post_data = array(
"Prs_First" => "$firstname",
"Prs_Middle" => "",
"Prs_Last" => "$lastname",
"Prs_Email" => "$email",
"Prs_Phone1" => "$homephone",
"Prs_Phone2" => "$callerAni",
"Prs_Address1" => "$address1",
"Prs_Address2" => "$address2",
"Prs_City" => "$city",
"Prs_State" => "$state",
"Prs_Zip" => "$zip",
"InitialContactDate" => "$createDate",
);

//traverse array and prepare data for posting (key1=value1)

unset($post_items);

foreach ($post_data as $key => $value) {
    $post_items[] = $key . '=' . $value;
}

//create the string to be posted using implode()

$post_string = implode ('&', $post_items);

//create cURL connection

$curl_connection = curl_init('https://www.whatever.com');

//echo to make sure string is formed correctly 

echo "Submitting: <br />";
echo "$post_string";
echo "<br />";

//set options

curl_setopt($curl_connection, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($curl_connection, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl_connection, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl_connection, CURLOPT_FOLLOWLOCATION, 1);

//set data to be posted

curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_string);

//perform the request

$result = curl_exec($curl_connection);

$result = simplexml_load_string($result);
$result = json_encode($result);
$result = json_decode($result, true);

echo "<br />";
if (isset($result)){
echo "<pre>";
print_r($result);
echo "$result";
print_r($result[0]);
echo "$result[0]";
echo "</pre>";
} else {
echo "it's still broken.";
$result = "Still TFB";
}
echo "<br />";

unset($curl_connection);
unset($result);
unset($post_string);

}

//end while loop

fclose($f);

?> 
```

现在，我遇到的问题有两个方面：首先，无论我尝试回显 $result 还是 print_r，我都看不到最后回显的任何结果。第二个问题是这需要永远。我们正在谈论 30 秒的提交......这让我想知道它是否由于某种原因超时？我以前从来没有在这样的while循环中使用过curl，所以我不确定是否需要做一些额外的清理......或者以某种方式回显更多信息以从curl进行故障排除。我开始觉得我已经不知所措了……哈！

**编辑：**

好的，所以我按照建议将 curl 函数扔到了循环之外：

```
<?php

$CSVleadfile = "testing.csv";

//lead file information lookup

$f = fopen($CSVleadfile, "r");

while ($row = fgetcsv($f)) {
$contactId = $row[1];
$createDate = $row[2];
$callerAni = $row[3];
$tfn = $row[4];
$firstname = $row[5];
$lastname = $row[6];
$address1 = $row[7];
$address2 = $row[8];
$city = $row[9];
$state = $row[10];
$zip = $row[11];
$homephone = $row[12];
$email = $row[13];

// load data for posting array
$post_data = array(
    "that" => "$junk",
);

//traverse array and prepare data for posting (key1=value1)
foreach ($post_data as $key => $value) {
    $post_items[] = $key . '=' . $value;
}

//create the string to be posted using implode()
$post_string = implode('&', $post_items);

//perform the request
executeCurl();

}

//outside loop curl function

function executeCurl() {

//create cURL connection
$curl_connection =      curl_init('https://www.whatever.com');

//set options

curl_setopt($curl_connection, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($curl_connection, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl_connection, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl_connection, CURLOPT_FOLLOWLOCATION, 1);

//set data to be posted

curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_string);

$result = curl_exec($curl_connection);

$result = simplexml_load_string($result);

echo "<br />";
if (isset($result)) {
    var_dump($result);
    die;
} else {
    echo "it's still broken.";
    $result = "Still TFB";
}
echo "<br />";

file_put_contents("./Results.txt", $results, FILE_APPEND | LOCK_EX);
}

fclose($f);
?> 
```

我已经去掉了 json 的怪异之处......老实说，我不记得为什么我把它扔在那里了，很确定它可能是格式化的，但无论哪种方式，我期望的结果都是这样的：

```
<string xmlns="http://www.whatever.com">11940576</string> 
```

这就是我想记录回该文本文件的内容:D 虽然行为没有变化:(我的 var_dump 导致 bool(false)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:08:55.347

问题一：你为什么要把你的帖子数据数组转换成字符串？Curl 很高兴地接受了一个数组`CURLOPT_POSTFIELDS`，并使用一个数组将 Content-Type 标头设置为 multipart/form-data。

问题 2： curl 将使用`curl_setopt_array()`.

# ipad - cache.manifest / 离线使用网络应用程序的奇怪行为保存到 ipad ios6 上的主屏幕

> ID：12625297
> 
> 赞同：3
> 
> 时间：2012-09-27T15:51:48.617
> 
> 标签：ipad, web-applications, ios6, offline-caching, cache-manifest

我刚刚在 iPad 上使用新的 iOS 6 发现了一些奇怪的行为。我正在测试一个网络应用程序以供离线使用。Web 应用程序只不过是一个带有缓存清单的静态网站，因此没有使用像 sencha touch 这样的特殊框架或像 phnoegap 这样的工具。只是 HTML、CSS 和 JavaScript 以及一个 cache.manifest。

该应用程序之前运行良好：我可以将网站保存到主屏幕。当我从那里打开它时，所有数据都将被下载以进行缓存。在下载结束时，弹出窗口会询问我是否要将缓存增加到 50MB - 接受 - 一切都很好 - 离线使用有效。

现在更新到 iOS 6 后：我对应用程序进行了一些更改。从主屏幕卸载应用程序。在移动 Safari 中再次打开它。保存到主屏幕。当打开下载按预期开始。但随后它冻结在 99%。当我在控制台中查找它时，我收到错误消息：“应用程序缓存更新失败，因为超出了大小配额。”

奇怪的事情来了：当我在浏览器中打开它时，下载开始，最后我被问到是否要将缓存大小增加到 50MB。我当然确认。当我现在在“网站数据”中查看 safari 的首选项时，我看到这个应用程序的所有缓存数据大约是 33MB！所以根本不超过50MB！

这是iOS6的错误吗？自 iOS 6 更新以来，在将网站保存到主屏幕时，是否有人遇到过缓存数据问题？感谢您的帮助，因为我真的被困在这里......在网上找不到任何有用的东西......

（不幸的是，我无法发布任何指向网络应用程序和/或其文件的链接）。

**编辑：**

我发现了有关此问题的更多信息：

[http://www.nsbasic.com/blog/?p=928](http://www.nsbasic.com/blog/?p=928)

显然，保存到主屏幕的 wep-apps 现在被视为原生应用程序，这意味着保存到主屏幕的同一 Web 应用程序的每个实例都有自己的“存储沙箱”。因此数据独立于移动 Safari 中保存的数据。这意味着如果您删除所有移动 safari 的网站数据，这对保存到主屏幕的网络应用程序没有影响（在 ios6 之前，它们共享相同的数据）。

我还发现了这个：

[iOS 6 破坏了 webapps 中的 GeoLocation (apple-mobile-web-app-capable)](https://stackoverflow.com/q/12503815/1254555)

虽然不是完全相同的主题，但它可能是相关的。显然网络应用程序使用保存到主屏幕

```
<meta content="yes" name="apple-mobile-web-app-capable" /> 
```

将无法使用地理位置。仅当您从 Web 应用程序中删除此元标记时，地理位置才有效。也许这也是缓存问题的解决方法，我还不能测试它。但话又说回来：如果将保存到主屏幕的 Web 应用程序更像原生应用程序处理，也许不再需要 cache.manifest？如果我发现更多，我会在这里报告。

**编辑2：**

好的，经过一些测试并且没有来自网络和苹果的有用提示，我至少发现了一些东西：当我删除

```
<meta content="yes" name="apple-mobile-web-app-capable" /> 
```

从网站上看，一切都很好，因为就像你打开 Safari 一样，到目前为止我没有任何问题。所以我的兴趣是让它在没有浏览器 chrome 的情况下工作。如上所述，缓存仅达到 99%，然后我得到缓存大小配额超出错误。然后我只是关闭了主屏幕应用程序并再次打开它。现在缓存下载重新开始，完成就好了！没有冻结，没有错误！一切似乎都存储在本地。我今天只能在 iPad 模拟器上测试它，但我希望我能在稍后拿到我们的设备后尽快确认这一点。

因此，似乎不是被问到是否要增加缓存大小，而是得到缓存大小配额超出错误。也许是因为现在主屏幕应用程序的数据存储处理方式不同，您不必再手动增加缓存大小（这当然是纯粹的猜测）。不过，如果是这样的话，应该不会有任何错误。因此，您不必被要求增加缓存大小，而是必须打开主屏幕应用程序两次，顺便说一句，这是一个相当蹩脚的解决方法......

**编辑3：**

我只能在真实设备上确认此行为：保存到主屏幕->从主屏幕打开->下载到缓存文件->缓存大小配额最后超出错误->关闭主屏幕应用程序（按主页按钮）- > 再次重新打开它 -> 再次下载缓存文件 -> 这次没有错误 -> 一切都可以离线使用。

我还在一台装有 iOS 5 的设备上对其进行了测试，它可以正常工作，没有错误。所以这绝对是 iOS 6 的问题。

其他人可以确认这种行为或错误吗？

**编辑4：**

我偶尔有机会在 iOS 6.1.3 上对此进行测试——不幸的是仍然是相同的行为......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:17:45.913

我发现以下链接很有帮助。它解释说，由于主屏幕应用程序现在像本地应用程序一样存储，它们有自己的存储/缓存。

地理位置在第一次迭代时有效，但从那时起无法更新。

[iOS 6 地理位置和本地数据存储](http://www.elevatedgis.com/blog/2012/09/21/ios-6-geolocation-and-local-data-storage/)

> “主屏幕应用程序中的数据现在像原生应用程序一样存储。每个原生应用程序都有自己的沙箱，用于存储、备份和恢复数据。在 iOS 6 之前，主屏幕应用程序与在浏览器中运行的同一个应用程序共享数据. 如果用户清除浏览器中的缓存，主屏幕版本的应用程序也会丢失数据。在 iOS 6 中，主屏幕应用程序的数据会像原生应用程序一样保存到沙箱中。备份和恢复可以正确处理数据，并且清除浏览器中的缓存不会影响它们。”

# windows - 在窗口中禁用中断

> ID：12625298
> 
> 赞同：2
> 
> 时间：2012-09-27T15:51:49.933
> 
> 标签：windows, driver, interrupt

我需要原子地执行一段代码。我想唯一的方法是禁用中断，我怎么能在 Windows 下做到这一点？我正在搜索一个允许我这样做的 Windows 操作系统，所以我不关注特定的窗口。即使是 Windows CE 也不错。

斯特凡诺

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:18:14.360

用户编写的代码完全禁用中断的概念几乎违背了 Windows 的一些基本设计假设。

对于初学者，您不能禁用来自用户模式应用程序的中断。（这是一个特权指令。）

在内核模式下，您可以使用 IRQL 来防止大多数抢占（但不是全部）。这是在 Windows 下执行非抢占式硬件操作的“标准”方式。我怀疑这是你真正想要的。如果您可以让您的代码在更高级别的 IRQL 范围内运行，那么您应该没问题。 [有关 IRQL 的信息，请参阅此链接。](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http://download.microsoft.com/download/e/b/a/eba1050f-a31d-436b-9281-92cdfeae4b45/IRQL_thread.doc&ei=H9BlUMWJHeP00gGY2YDYDw&usg=AFQjCNGN8B8iueodNRqGgsn61r6mbr8gPg&sig2=y-WLPB485cN4dA9kA2NxQg) 请记住，你跑得越高，就会有越多的事情发生。预计性能计数器会变得不准确，设备缓冲区溢出等。

作为后门，您可以将原始汇编 CLI/STI 指令嵌入内核驱动程序，但这可能会破坏很多事情，除非您的代码在很短的时间内禁用中断。如果没有，请期待蓝屏。此外，我相信 AMD64 编译器将与您尝试进行内联汇编进行斗争。

我强烈建议您放弃原子性要求。

**其他一些选项：**

*   引导到您自己的环境以运行您的测试（类似于 Memtest86）。
*   考虑使用父 RTOS 内核。有现成的“Windows RTOS”解决方案将 Windows 作为父 RTOS 的子进程运行。现有的 Windows 应用程序和驱动程序运行良好，并且为 RTOS 编写时间关键/原子任务。该领域最受欢迎的播放器是[来自 IntervalZero 的 RTX](http://www.intervalzero.com/)。

**此外，还有一个关于 x86 的肮脏小秘密您应该知道：** 即使您在汇编中编写 RTOS，您在 x86 平台上编写的几乎所有内容都不能保证是原子的。即使您执行 CLI/STI，系统管理中断也会中断您的代码。

# sql - SQL 使用长浮点数时遇到问题，数学

> ID：12625308
> 
> 赞同：2
> 
> 时间：2012-09-27T15:52:10.270
> 
> 标签：sql, sql-server-2000

我的库存数据库中有 2 个值。一个是 QtyOnHand（浮点数），另一个是计算该项目的所有库存交易（想想`SUM(TransQty)`transQty 也是浮点数）。问题是，随着时间的推移，由于未知原因，其中一些值会不同步。所以现在我正在尝试清理它们。

基本上，我采用 QtyOnHand（我们声明它是准确的），并从中减去交易总额。然后针对差额在交易中进行更正输入。在我们得到带有大量“十进制灰尘”的数字之前，这非常有效。此外，`0`即使在实际值更像`0.0000000000000000237`.

以下是一些我无法更正的数据。

![示例数据](../Images/98133c51d2ea087359ff85f72ef25717.png)

带有科学计数法的项目给我带来了麻烦。甚至显示项目 PLXL-105-H 的行（显示 -18、-18）也无法准确显示，因为我的查询仅返回 1% 不匹配范围之外的值。我一直在 TSQL 中工作，它有助于操作 C# 程序中的值吗？

所以，这是我的问题：我应该如何处理这些数字？我尝试将它们转换为 DECIMAL(38,38)，但这给了我算术溢出。我需要得到一个代表差异的准确值，然后使用该值来平衡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:02:37.143

你是如何尝试进入的？

做类似的事情：

```
with to_update as (
     select itemNumber, QtyOnHand, TransBal
     from t
)
update tb_table
    set offset = TransBal - QtyOnHand
    from to_update
    where to_udpate.itemNumber = tb_table.itemNumber 
```

应该做的伎俩。

听起来您正试图将数据从数据库中取出，对其进行操作，然后再将其放回。如果您留在数据库中，则不会有问题，因为值永远不会转换为字符串。

顺便说一句，对于十进制转换，你应该使用`decimal(38,19)`什么的。scale参数是小数点右边的位数，所以设置为38只代表-1到1之间的数字。

# c# - 如何设置文件扩展名的默认程序？

> ID：12625309
> 
> 赞同：2
> 
> 时间：2012-09-27T15:52:18.350
> 
> 标签：c#

> **可能重复：**
> [在窗口注册表中注册文件扩展名？](https://stackoverflow.com/questions/1720710/register-file-extension-in-window-registry)

我想让我的程序在安装时成为 .txt 文件的默认程序。很多程序都做同样的事情，例如在安装浏览器时，所有的 html 文件都会获得程序的图标，如果打开，程序就会打开，而不需要用户将其设置为默认程序。我怎样才能做到这一点？对于图标，例如，microsoft word 对程序和文件使用不同的图标。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:15:19.737

您应该编辑您的注册表： [例如](http://daycounter.com/LabBook/Changing-File-Associations-With-Registry-Editor.phtml)

或者您应该创建一个安装程序项目并设置适当的配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:29:02.237

微软在[实现自定义文件格式](http://msdn.microsoft.com/en-us/library/windows/desktop/ff521657%28v=vs.85%29.aspx)（包括与外壳集成的其他方式）方面有这个。

因为您想将您的应用程序与已经与另一个应用程序关联的扩展名关联起来，所以您必须学习有关[公共和私有文件类型](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144148%28v=vs.85%29.aspx)的部分。

# javascript - grep 或映射二维数组

> ID：12625319
> 
> 赞同：0
> 
> 时间：2012-09-27T15:52:33.950
> 
> 标签：javascript, jquery, arrays, map

我正在编写一个脚本，在该脚本中我导入了一个 CSV，该 CSV 目前是一个二维数组：

```
 eData[0]=["Del","Trotter","Sales"];
    eData[1]=["Rodney","Trotter","IT"]; 
```

我想要做的是 grep 或使用二级数据上的搜索字符串映射到另一个数组，所以如果我搜索以“de”开头的名字，`eData[0]`则将分配给数组，或者如果我搜索以“开头的姓氏” tr" 两者都`eData[0]`将`eData[1]`被制成一个新的数组

基本上相当于：

```
 `SELECT * FROM ad_colleague_info WHERE ad_colleague_info.First LIKE '"+$('#searchbox').val()+"%'";` 
```

好的，我不得不将地图更改为 grep，但这似乎完全有效：

```
 var search = new RegExp( "\\b"+$('#searchbox').val()+"+", "gi");
    FeData = jQuery.grep(eData, function (value) {
        if(typeof(value[0]) != "undefined" && value[0] !== null && value[0].match(search)) return value;
        return null;
    }); 
```

# c# - 了不起的 DBA 创建硬查询，并在 Entity Framework 5 上实现它

> ID：12625327
> 
> 赞同：0
> 
> 时间：2012-09-27T15:52:56.827
> 
> 标签：c#, .net, sql-server, entity-framework

我对 EF5 没有太多经验，我的 DBA 生成的查询非常复杂，而且我在工具的选择上非常有限。我将描述问题。数据库未规范化，因此此类查询是必要的。而且我不能影响它的结构和查询例如我有查询：

```
SELECT A.my_id, 
    A.field_1, 
    A.field_2, 
    A.field_3, 
    A.field_4, 
    A.field_5, 
    A.field_6,
    A.field_7, 
    A.field_8, 
    A.field_9, 
    B.field_10, 
    C.field_11, 
    C.field_12,
    C.field_13, 
    C.field_14, 
    D.field_15, 
    E.my_id2, 
    E.field_16, 
    E.field_17, 
    E.field_18, 
    G.field_19
    etc...
FROM tbl1 A, 
tbl2 B, tbl3 C, tbl4 D, tbl5 E, tbl6 F, tbl7 G
WHERE A.my_id                   = B.my_id
  AND A.my_id                   = C.my_id
  AND A.my_id                   = D.my_id
  AND A.my_id                   = E.my_id
  AND E.my_id3                  = F.my_id3
  AND E.my_id4                  = G.my_id4
  AND E.my_id2                  = <value from code>
  AND F.param1                  = <value from code>
  AND B.param4                  = 'KEY1'
  AND B.param5                  = 'KEY2'
  AND E.param8                  > 0 
  AND E.param9                  = 'KEY3'
  AND E.param10                 <> 'KEY4'       
  AND G.param11                 = 'KEY5'
  AND G.param12                 <= <SYSTEM DATETIME>
  AND G.param13                 >= <SYSTEM DATETIME>
  AND A.param2                  <= <SYSTEM DATETIME>
  AND A.param3                  >= <SYSTEM DATETIME>
  AND B.param6                  <= <SYSTEM DATETIME>
  AND B.param7                  >= <SYSTEM DATETIME>` 
```

现在我将描述使用 Entity Framework 5 在代码中移动查询时遇到的问题。

我对主表进行 INNER JOIN。像这样。

```
ObjectContext.CreateQuery<ETbl5>(entityName).
.Where(E =>
    E.param2 >= SqlFunctions.GetDate() && E.param3 <= SqlFunctions.GetDate() &&
    E.param8 > 0 && E.param9 == "KEY3" &&
    E.param10 != "KEY4" && E.my_id2 == <value from code>
)
.Join((Context as MyDbContext).ETbl7 ,
    E => new { A.my_id4},
    G => new { B.my_id4},
    (E, G) => E
) 
```

如何为 JOIN 添加条件`AND G.param12 <= <SYSTEM DATETIME>`？如何在匿名类型中添加此类条件？

我总是有很多问题，我认为我走错了路。或许除了解决问题，你还可以告诉我处理此类查询的正确策略。我知道它可以转移到存储过程中，但是我希望输出 IQuerable 以在 Grid with Pagination 中使用它。感谢您的关注。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T18:03:30.190

我会推荐一种不同的方法：根据 DBA 的查询在数据库中创建一个视图，并将其映射到您的实体框架模型。您将受益于 IQueriable，并且不需要转换所有这些复杂的查询。此外，您将不对您在查询转换（从 SQL 到 LINQ）期间引入的可能错误负责

# css - 如何为 DIV 赋予几何形状？

> ID：12625331
> 
> 赞同：0
> 
> 时间：2012-09-27T15:53:07.090
> 
> 标签：css

这是否可能：围绕当前 DIV 创建 DIV？

例如，一些 DIV 位于中心（大圆圈），而其他 DIV 在其周围（星形），如图所示。CSS能完成这样的任务吗？

![职位示例](../Images/024329c63f8e05f94b3d81894e5a2f6b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:01:36.257

是的，当然要通过这个链接.. [link1](http://css-tricks.com/examples/ShapesOfCSS/)和[link2](http://www.css3shapes.com)。

然后`div`通过给出定位来设置's [:)](https://developer.mozilla.org/en-US/docs/CSS/position)欢呼。

**更新**：（*仅添加了 chrome 供应商前缀*）

## HTML：

```
<div class="parent">
    <div class="star topMid"></div>
    <div class="star top left"></div>
    <div class="star top right"></div>
    <div class="star midLeft"></div>
    <div class="star midRight"></div>
    <div class="star bottom left"></div>
    <div class="star bottom right"></div>
    <div class="star bottomMid"></div>
</div> 
```

## CSS：

```
.parent {
    border-radius: 50%;
    width: 300px;
    height: 300px;
    position: relative;
}
.parent:after {
    content:"";
    border-radius: 50%;
    top: 55px;
    left: 55px;
    right: 55px;
    bottom: 55px;
    position: absolute;
    border: 1px solid red;
}
.star {
    position: absolute;
    width: 0px;
    height: 0px;
    border-width: 20px 20px 20px 20px;
    border-color: transparent transparent green transparent;
    border-style: solid;
}
.star:after {
    content:"";
    position: absolute;
    width: 0px;
    height: 0px;
    border-width: 20px 20px 20px 20px;
    border-color: transparent transparent green transparent;
    border-style: solid;
    -webkit-transform: rotate(180deg);
    top: 7px;
    left: -20px;
}
.top {
    top: 12.5%;
}
.left {
    left: 12.5%;
}
.bottom {
    bottom: 20%;
}
.right {
    right: 12.5%;
}
.topMid {
    top:0px;
    left:50%;
    margin-left:-25px;
}
.bottomMid {
    bottom: 25px;
    left:50%;
    margin-left:-25px;
}
.midLeft {
    top:50%;
    left:5px;
    margin-top:-25px;
}
.midRight {
    top:50%;
    right:5px;
    margin-top:-25px;
} 
```

[**工作小提琴**](http://jsfiddle.net/venkateshwar/DbpSu/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:55:00.753

要实现这样的布局，可以使用[绝对定位](http://css-tricks.com/absolute-positioning-inside-relative-positioning/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:28:24.810

伙计们已经用绝对定位说出了正确答案。但这是我建议的提示：

```
 <div class="bigDiv">
         <div class="smallDive">

         </div>
          <div class="smallDive">

         </div>
         <div class="smallDive">

         </div>
         //...
    </div>

    .bigDive{
       position:relative;
       //...
     }
     .smallDiv{
       position:absolute;
       //...
     } 
```

因此，在这种情况下，内部 smallDive 的位置将根据大俯冲位置计算，而不是根据显示器的角。

# javascript - jQuery返回true但如果正确则不输入

> ID：12625336
> 
> 赞同：1
> 
> 时间：2012-09-27T15:53:27.583
> 
> 标签：javascript, jquery, jquery-selectors

当我提醒

```
$(this).attr("clicked") == "aa" 
```

它发出警报`true`。但此代码不会提醒 aa。

```
 if ($(this).attr("clicked") == "aa"){
  alert("aa");
 } 
```

任何人都可以帮助解决这个问题吗？谢谢

**编辑**

这个内容是

```
<a id='Comedy' hoverb='green' clicked='aa'>want to laugh</a> 
```

整段代码：

```
$('.left a').live("click", function() {

 if ($(this).attr("clicked") == "aa"){

  $(this).css('background',black);
  alert("aa");

 }

  else {

 //do somethingelse

}

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:56:54.667

clicked 不是默认属性.. 试试这个..

**如果没有上下文，这**也没有任何意义..如果您不指定上下文，这意味着窗口..

```
<a id='Comedy' hoverb='green' data-clicked='aa'>want to laugh</a>

$('#Comedy').on('click', function(e) {
    e.preventDefault();
    if ($(this).data("clicked") == "aa") {
        alert("aa");
    }
});​ 
```

// 试试这个

```
$('#Comedy').on('click', function(e) {
    e.preventDefault();
    if ($(this).attr("clicked") == "aa") {
        alert("aa");
    }
});​ 
```

**更新代码**

```
$(this).css('background','black');   <---- black needs to be bound in '' ..Missing that 
```

[检查演示](http://jsfiddle.net/MQ6ky/1/)

[更新的演示](http://jsfiddle.net/MQ6ky/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:12:11.527

我认为问题出在这个街区

```
$(this).css('background',black); 
```

将属性值作为

```
$(this).css('background','black'); 
```

# c# - 将日期从 Visual Basic 转换为 C-Sharp

> ID：12625339
> 
> 赞同：3
> 
> 时间：2012-09-27T01:44:57.703
> 
> 标签：c#, .net, vb.net, document-conversion

因此，作为实用程序的练习，我自己承担了将我们可怜的旧 vb .net 1.1 应用程序之一转换为 C# .net 4.0 的任务。

我使用[Telerik 代码转换](http://converter.telerik.com/)作为起点，最终出现约 150 个错误（考虑到其超过 20k 的代码，这还不算太糟糕，而且我很少能使用生产源代码让它在没有错误的情况下运行）其中许多处理时间/日期在 vb 与 c# 中。

我的问题是，您将如何在 VB 中表示以下语句

```
If oStruct.AH_DATE <> #1/1/1900# Then 
```

在 C# 中？转换器给了我

```
 if (oStruct.AH_DATE != 1/1/1900 12:00:00 AM) { 
```

这当然是不正确的，但我似乎无法弄清楚如何使它正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T01:52:48.267

```
 if (oStruct.AH_DATE != new DateTime(1900, 1, 1){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T01:58:55.387

你可以试试这个构造：

```
if ( DateTime.Compare(oStruct.AH_DATE, new DateTime(1900, 1, 1)) == 0 )
{
// your code here
} 
```

这是如何在 .NET 中比较 DateTimes 的参考 - [DateTime.Compare 方法](http://msdn.microsoft.com/en-us/library/system.datetime.compare.aspx)

**注意：**比较两个日期（如整数）可能会导致错误的结果。因为，.NET 中的日期时间结构有其特定的属性。在比较两个日期时，我总是会尽量留心，并且总是选择`DateTime.Compare`更安全的一面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:01:44.240

这应该有效：

```
if (oStruct.AH_DATE != DateTime.Parse("1/1/1900")) 
```

# java - 匹配每个单词的第一个字符

> ID：12625344
> 
> 赞同：1
> 
> 时间：2012-09-27T15:53:40.127
> 
> 标签：java, regex

假设我所有的单词都用空格分隔，即例句：

```
the browser keeps sending requests to check 
```

我应该匹配`tbksrtc`，这是每个单词的第一个字母。这与正则表达式有关吗？而不是将其拆分为数组（使用空格）。

如果是，将如何编写该正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:25:52.017

您可以使用以下正则表达式：

```
(?<=^|\s)\p{L} 
```

如果前面有空格或字符串的开头，它将匹配一个字母。不要忘记放弃以实际将该正则表达式强制转换为Java字符串。

快速 PowerShell 测试：

```
PS> $s = 'the browser keeps sending requests to check'
PS> -join [regex]::Matches($s, '(?<=^|\s)\p{L}')
tbksrtc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:57:19.673

您可以匹配非空格：

```
String str = "the browser keeps sending requests to check";
Matcher m = Pattern.compile("(\\S)(\\S+)").matcher(str);
while (m.find()) {
    System.out.print(m.group(1));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:21:14.287

我认为对于这种简单的情况，更易读的方法是有效地拆分字符串：

```
public String generateInitials (String original){
    String[] words= original.split(" ");
    return retrieveInitialsOfEachWord(words);
}

private String retrieveInitialsOfEachWord(String[] words){
    String initials = "";
    for(String word : words){
        initials += word.substring(0,1);
    }
    return initials;
} 
```

事实上，这几行代码比解码正则表达式和猜测作者意图更容易理解。

如果开发人员没有通过方法名很好地表明他的意图，那么可能很难按预期解码正则表达式。

无论如何，使用基本的 java 语法或涉及正则表达式`Matcher`只是一个口味问题。

# c# - 记录未插入访问数据库

> ID：12625348
> 
> 赞同：2
> 
> 时间：2012-09-27T15:53:54.137
> 
> 标签：c#, asp.net, ms-access

我有一个 C# windows 应用程序，我正在尝试将数据（已由用户输入）插入到 access 数据库中。我没有收到任何错误，但它没有输入数据。任何想法？

```
 string sqlInsert = "insert into assessment (id) values (@id)";

        using (OleDbConnection conn = new OleDbConnection(dsn))
        {

            OleDbCommand cmd = new OleDbCommand(sqlInsert, conn);

            cmd.Parameters.Add("@id", OleDbType.VarChar, 50).Value = iDTextBox.Text.Trim().Length != null ? storedID.Trim() : "";

            conn.Open();
            cmd.ExecuteNonQuery();
            conn.Close();
        } 
```

id 的数据类型是`Text`.

编辑：连接字符串存储在 app.config 中：

```
<add name="conn" connectionString="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\CADSCUPP.mdb" providerName="System.Data.OleDb"/> 
```

并通过以下方式在代码中访问：

```
private string dsn = System.Configuration.ConfigurationManager.ConnectionStrings["conn"].ConnectionString; 
```

如果我手动插入记录（而不是通过代码后面的代码），我可以在程序的其他地方读取记录，以便连接正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T15:53:17.193

众所周知，Windows 7 在编译和运行 WinForms 应用程序时会在其他地方复制 Access 数据库。我不知道它对 ASP.NET 应用程序执行此操作，但这是可能的。验证应用程序正在访问的数据库是否位于您认为的位置可能是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T19:01:49.710

在 Sql Text 中使用问号而不是 @。参数名称与访问无关。只有订单才算。我已经有一段时间没有使用访问权限了——但这是我记得的一件事，它曾经让我发疯。使用 Access，参数名称无关紧要。

```
string sqlInsert = "insert into assessment (id) values (?)";

        using (OleDbConnection conn = new OleDbConnection(dsn))
        {

            OleDbCommand cmd = new OleDbCommand(sqlInsert, conn);

            cmd.Parameters.Add("?", OleDbType.VarChar, 50).Value = iDTextBox.Text.Trim().Length == 0 ? storedID.Trim() : "";

            conn.Open();
            cmd.ExecuteNonQuery();
            conn.Close();
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:08:08.077

您可以验证您的字符串连接是否正确

样本 ：

```
connetionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=yourdatabasename.mdb;" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T21:48:32.423

我在您的连接字符串中没有看到任何身份验证。尝试以下字符串之一：

[http://www.connectionstrings.com/access-2007](http://www.connectionstrings.com/access-2007)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-26T18:48:56.490

我认为您缺少提及命令类型。添加另一行，如下所示：

```
OleDbCommand cmd = new OleDbCommand(sqlInsert, conn);
cmd.CommandType = CommandType.Text; 
```

# sql-server - 正常的 SQL Server 索引是否包含主键值？

> ID：12625357
> 
> 赞同：2
> 
> 时间：2012-09-27T15:54:21.473
> 
> 标签：sql-server, indexing

我正在创建一个用于数据处理的查找表。结构比较简单。

第一个字段将是主键和聚集索引。将有第二个字段跟踪项目类型。

我们希望在第二个字段上建立索引，因为一些（但不是所有查询）将在该字段上进行搜索。这些查询还需要提取主键的值。

我希望使用非聚集索引的查询不必去表并提取主键值。

所以我的问题是，普通的 SQL Server 索引上是否有主键值，或者它们是否只有一个指向聚集索引的指针（出于我的目的，我只是假设主键和聚集索引是共同的）？如果它只包含一个指向磁盘的指针而不是主键值，我正在考虑将第一列（主键）作为基于第二列的普通索引上的包含列。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T16:00:29.063

引用文档[`CREATE INDEX`](http://msdn.microsoft.com/en-us/library/ms188783.aspx)：

> 如果在表上定义了聚集索引，则非聚集索引始终包含聚集索引列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T15:58:02.527

它们不一定有 PK 列，而是聚集索引的键列。它们确实用作指向 CI 行的指针，但也可用于其他类型的查询。

例如，列 A 上的索引（而不是显式地在 ID 上）可以满足查询`select A, ID from T`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:01:48.107

索引的键值确定数据的顺序。数据与索引一起存储，以便对数据本身进行排序。对于聚集索引，非聚集索引上的指针由定义聚集索引的值组成。否则，如果表（堆）上不存在索引，则使用扫描，其中通过使用行标识符作为指针来搜索数据。

来源：SQL Server 2008 查询性能调优提炼

# javascript - 将 OpenLayer 矢量图层从自动更改为手动获取请求

> ID：12625358
> 
> 赞同：1
> 
> 时间：2012-09-27T15:54:23.840
> 
> 标签：javascript, ajax, model-view-controller, openlayers

我有一个返回`FeatureCollection`JSON 格式的 Web 服务器。我使用下面的代码得到了这个，效果很好：

```
var vectorLayer = new OpenLayers.Layer.Vector('geoJSON', {
    strategies: [new OpenLayers.Strategy.Fixed()],
    protocol: new OpenLayers.Protocol.HTTP({
        url: '<%= Url.Action("Vectors", "Maps") %>',
        format: new OpenLayers.Format.GeoJSON()
    }),
    styleMap: new OpenLayers.StyleMap(style)
}); 
```

我想将其转换为手动异步获取请求，作为其他内容的一部分（我正在显示路线并想做几个请求，每个路线一个，这样我就可以在计算时显示它们，避免很大的延迟）。

所以，我把上面的代码改成了下面的代码：

```
OpenLayers.Request.GET({
    url: '<%= Url.Action("Vectors", "Maps") %>',
    async: true,
    success: function(e) {
        var features = new OpenLayers.Format.GeoJSON().read(e.responseText);
        vectorLayer.addFeatures(features);
    }
}); 
```

但是，当我运行它时，虽然调用了回调，但`e.responseText`看起来还不错，并且 features 变量似乎包含正确的对象，并且它们确实被添加到了`vectorLayer`，**它们出现在错误的位置；就在原点旁边**。在 OSM 的最大变焦下，它们几乎没有分开，而它们应该分散在英国各地。

知道为什么自从更改为手动 GET 后它们出现在错误的位置？

* * *

请参阅下面的我当前的代码清单：

```
var map, layer;
map = new OpenLayers.Map(element.id);
baseLayer = new OpenLayers.Layer.OSM('Simple OSM Map');

var context = {
    getColor: function(feature) {
        return feature.attributes['Colour'];
    },
    getImageURL: function(feature) {
        return feature.attributes['ImageURL'];
    },
    getLabel: function(feature) {
        return feature.attributes['Label'];
    }
};

var template = {
    externalGraphic: '${getImageURL}',
    pointRadius: 5,
    strokeWidth: 3,
    strokeColor: "${getColor}"
};

var style = new OpenLayers.Style(template, { context: context });

/*var vectorLayer = new OpenLayers.Layer.Vector('geoJSON', {
strategies: [new OpenLayers.Strategy.Fixed()],
protocol: new OpenLayers.Protocol.HTTP({
url: '<%= Url.Action("Vectors", "Maps") %>',
format: new OpenLayers.Format.GeoJSON()
}),
styleMap: new OpenLayers.StyleMap(style)
});*/

var vectorLayer = new OpenLayers.Layer.Vector('geoJSON');
vectorLayer.styleMap = new OpenLayers.StyleMap(style);

OpenLayers.Request.GET({
    url: '<%= Url.Action("Vectors", "Maps") %>',
    async: true,
    success: function(e) {
        var features = new OpenLayers.Format.GeoJSON().read(e.responseText);
        vectorLayer.addFeatures(features);
    }
});

map.addLayers([baseLayer, vectorLayer]);
map.setCenter(
    new OpenLayers.LonLat(-4, 55).transform(
        new OpenLayers.Projection("EPSG:4326"),
        map.getProjectionObject()
    ), 6
); 
```

返回的 JSON 示例（自工作以来未更改）：

```
{ "features" : [ { "geometry" : { "coordinates" : [ -0.72766602400000002,
                51.273638529999999
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/ByBox.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ [ -0.82559629999999995,
                  51.296390000000002
                ],
                [ -0.72766602400000002,
                  51.273638529999999
                ],
                [ -0.82559629999999995,
                  51.296390000000002
                ]
              ],
            "type" : "LineString"
          },
        "properties" : { "Colour" : "#{72:x2}{241:x2}{152:x2}",
            "ImageURL" : null
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -0.82559629999999995,
                51.296390000000002
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/Home.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -0.41132172900000002,
                50.821081319999998
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/ByBox.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ [ -0.47245280000000001,
                  50.817610000000002
                ],
                [ -0.41132172900000002,
                  50.821081319999998
                ],
                [ -0.47245280000000001,
                  50.817610000000002
                ]
              ],
            "type" : "LineString"
          },
        "properties" : { "Colour" : "#{206:x2}{155:x2}{66:x2}",
            "ImageURL" : null
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -0.47245280000000001,
                50.817610000000002
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/Home.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ 0.074993041999999996,
                51.270947649999997
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/ByBox.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ [ 0.075924359999999996,
                  51.268300000000004
                ],
                [ 0.074993041999999996,
                  51.270947649999997
                ],
                [ 0.075924359999999996,
                  51.268300000000004
                ]
              ],
            "type" : "LineString"
          },
        "properties" : { "Colour" : "#{99:x2}{146:x2}{254:x2}",
            "ImageURL" : null
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ 0.075924359999999996,
                51.268300000000004
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/Home.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -0.24428876999999999,
                51.583668719999999
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/ByBox.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ [ -0.251608,
                  51.580390000000001
                ],
                [ -0.24428876999999999,
                  51.583668719999999
                ],
                [ -0.251608,
                  51.580390000000001
                ]
              ],
            "type" : "LineString"
          },
        "properties" : { "Colour" : "#{188:x2}{122:x2}{221:x2}",
            "ImageURL" : null
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -0.251608,
                51.580390000000001
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/Home.png"
          },
        "type" : "Feature"
      },
      { "geometry" : { "coordinates" : [ -1.4948717600000001,
                53.68926664
              ],
            "type" : "Point"
          },
        "properties" : { "Colour" : "#ffffff",
            "ImageURL" : "/360Scheduling/Content/Images/ByBox.png"
          },
        "type" : "Feature"
      }
    ],
  "type" : "FeatureCollection"
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T09:08:22.897

原因是投影错误。JSON 文件中的点位于 EPSG:4326 投影中，而 OpenStreetMap 位于 EPS:900913 中。

当您自动获取数据时，OpenLayers 显然会转换坐标，如果它们处于与地图不同的投影中。

您应该在将要素添加到地图之前对其进行转换：

```
var features = new OpenLayers.Format.GeoJSON().read(e.responseText);
var transformedFeatures = [];
for(var i= 0; i < features.length; i++){
  transformedFeatures.push(features[i].geometry.transform(
     new OpenLayers.Projection("EPSG:4326"),
     new OpenLayers.Projection("EPSG:900913")
  ));
}
vectorLayer.addFeatures(transformedFeatures); 
```

# jquery - 从值填充输入的单选按钮

> ID：12625360
> 
> 赞同：0
> 
> 时间：2012-09-27T15:54:34.840
> 
> 标签：jquery, input, add, radio

```
$(document).ready(function() {
    var ttline2 = $('#FIELD_' + FieldIDS['TT_Line2']);

    ttline2 = $('#FIELD_' + FieldIDS['BadgeHolder']; + $('#FIELD_' + FieldIDS['strap_clip']; + $('#FIELD_' + FieldIDS['Lanyard'];
    }); 
```

所以我上面的代码是这样的。我有3个单选按钮，每个单选按钮都有一个值，每个值需要添加到一个输入字段，输入字段是TT_Line2。我可以使用 $('#FIELD_' + FieldIDS['Lanyard']; 调用特定字段。在 JSLINT 上，它说使用点表示法会更好。

问题，我无法将其传递给输入字段。还是新的形式填充。

这是我的 HTML 代码

```
 <tbody><tr valign="top" style="width: 125px; "><td style="width: 125px"><input type="radio" name="FIELD_1366" id="FIELD_1366" value="No"><span>No</span>
    </td>
    </tr>
    <tr valign="top" style="width: 125px; "><td style="width: 125px"><input type="radio" checked="" name="FIELD_1366" id="FIELD_1366" value="BadgeHolder"><span>Yes</span>
    </td>
    </tr>
    </tbody>

    <tbody><tr valign="top" style="width: 125px; "><td style="width: 125px"><input type="radio" name="FIELD_898" id="FIELD_898" value="No"><span>No</span>
    </td>
    </tr>
    <tr valign="top" style="width: 125px; "><td style="width: 125px"><input type="radio" checked="" name="FIELD_898" id="FIELD_898" value="BulldogClip"><span>Yes</span>
    </td>
     </tr>
    </tbody>

    <tbody><tr valign="top" style="width: 200px; "><td style="width: 200px"><input type="radio" name="FIELD_1276" id="FIELD_1276" value="No"><span>No</span>
    </td>
    </tr>
    <tr valign="top" style="width: 200px; "><td style="width: 200px"><input type="radio" checked="" name="FIELD_1276" id="FIELD_1276" value="White"><span>White</span>
    </td>
    </tr>
    <tr valign="top" style="width: 200px; "><td style="width: 200px"><input type="radio" name="FIELD_1276" id="FIELD_1276" value="Black"><span>Black</span>
    </td>
    </tr>
    </tbody>

    <div class="fieldSpacer" id="DIV_119"><p class="fieldSpacer">JDELITM</p><p><input value="50-D-EXPKOE-V-F" style="width: 200px; " name="FIELD_119" id="FIELD_119"></p>
     <script language="javascript">
  FieldIDs["JDELITM"] = 119;
     </script>
    <div id="VALID_VAR_119" style="display:none" class="validationError"></div>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:08:53.733

**.val** 搞砸了..

它应该是**.val()** 而不是......你也缺少一些右**括号）**

此外，您正在读取 textvalue 并保存在变量中...将值存储到变量中并不意味着该值会自动更新..您需要明确设置它。

试试这个代码

```
$(document).ready(function() {
     var ttline2 = $('#FIELD_' + FieldIDS['BadgeHolder']).val() 
         + $('#FIELD_' + FieldIDS['strap_clip']).val() 
         + $('#FIELD_' +  FieldIDS['Lanyard']).val();

     $('#FIELD_' + FieldIDS['TT_Line2']).val(ttline2);
 });​ 
```

**更新的代码** 如果要添加数字，则需要首先解析它们，因为值存储为字符串。

```
var FieldIDS = { 'BadgeHolder' : 'Badge'  , 'strap_clip' : 'Clip' , 'Lanyard' : 'Yard' , 'TT_Line2' : 'Line'};

$(document).ready(function() {
     var ttline2 = parseInt($('#FIELD_' + FieldIDS['BadgeHolder']).val())
         + parseInt($('#FIELD_' + FieldIDS['strap_clip']).val()) 
         + parseInt($('#FIELD_' +  FieldIDS['Lanyard']).val());

     $('#FIELD_' + FieldIDS['TT_Line2']).val(ttline2);
    });​ 
```

[更新的演示](http://jsfiddle.net/MQ6ky/3/)

# java - 需要使用xml绘制模糊线

> ID：12625361
> 
> 赞同：1
> 
> 时间：2012-09-27T15:54:39.113
> 
> 标签：java, android, xml

需要使用 xml 而不是图像或位图来绘制模糊线。

![在此处输入图像描述](../Images/b283b17c3c97175177949f174275ecde.png)

// 在 xml 中我只是画了一条线。

如何使它成为模糊边缘

```
<View
        android:id="@+id/blur_divider_line"
        android:layout_width="wrap_content"
        android:layout_height="1dp"
        android:layout_marginLeft="25dp"
        android:background="@color/white"
/> 
```

[在这里，他们](http://android-coding.blogspot.in/2012/05/create-blur-edge-on-bitmap-using.html)使用 BlurMaskFilter 在位图中使用模糊效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:54:34.667

使用开始和结束颜色相同的渐变，而中间颜色将是纯色。这将创建一个阴影效果。

```
 <gradient 
                    android:angle="270" 
                    android:startColor="#0fff"
                    android:centerColor="#000"                        
                    android:endColor="#0fff" 
                    android:type="linear" /> 
```

请注意，开始和结束颜色应具有 100% 的透明度。

# php - Laravel 托管错误

> ID：12625362
> 
> 赞同：2
> 
> 时间：2012-09-27T15:54:40.923
> 
> 标签：php, laravel

我在我的 php 项目中使用 laravel，一切在 devlopment 中运行良好，但在托管期间，因为我没有在服务器上获得 shell 访问权限，所以我无法创建符号链接。所以我将公用文件夹的内容移动到根目录并相应地更改了 index.php 。但我一直收到这个错误

```
Warning: chdir() [function.chdir]: No such file or directory (errno 2)  
in /home/saarorgi/public_html/paths.php on line 62

Parse error: syntax error, unexpected T_STRING in 
/home/saarorgi/public_html/laravel/laravel.php on line 1

You can check the link -> saar.org.in 
```

请快速回复它真的很紧急

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T07:00:33.267

您应该确保您的 PHP 版本与 Laravel 要求相同或更好，这在我很久以前就发生过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:13:57.667

1\. 将 Laravel 的 public 文件夹中的文件复制到你想要放在 public_html 上的文件夹中。

2.将 Laravel 的其他文件夹复制到您想要放置的任何位置。如果需要，请重命名。

3.使用文本编辑器打开您的公共文件夹中的 index.php ，并更改“require ' `../paths.php';`”以适合您的目录结构。

4.用文本编辑器打开paths.php，改变“ `path['xxxx'] = 'xxxxx';`”格式行以适应你的目录结构。

5.不要忘记为您的“存储”目录设置许可。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-08T18:21:29.547

Check your PHP version >= 5.4, this one:

```
Parse error: syntax error, unexpected T_STRING in 
/home/saarorgi/public_html/laravel/laravel.php on line 1 
```

Belongs to that.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-03-23T11:30:59.590

这种类型的错误通常是由于 PHP 版本问题而发生的。更新到 PHP 7，这是 PHP 的最新版本。此外，如果错误仍然存​​在，您可能需要联系您的托管服务提供商，因为许多托管服务提供商几乎没有限制，因此您可以请求他们允许访问。

# java - Java Card 布局许多静态变量

> ID：12625363
> 
> 赞同：0
> 
> 时间：2012-09-27T15:54:44.853
> 
> 标签：java, static, cardlayout

我刚刚从一位使用卡片布局的前同事那里继承了一个 Swing 应用程序。

它有大约 40 种不同的 JPanel 卡，它们都是静态的并构成 GUI。

这些静态面板中的每一个都是一个不同的类，每个类都有大约 50 个静态变量，它们都继承自同一个超类，它是 JPanel 的子类。

我计划将这 50 个静态变量和方法中的尽可能多的放入父类中以提高可读性。

我担心的是，所有这些静态变量和 JPanel 在不需要时都位于内存中。

我想知道这是否应该创建逐屏GUI的方式，或者是否有更有效的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:00:59.603

顺便说一句，它听起来并不特别优雅，但这并不意味着它是一个糟糕的设计。

就内存使用而言，2,000 个变量并不是很多内存，除非它们是大数据结构。我想知道有多少静态变量可以重构。毕竟，`static int sFoo;`在两个子类中是内存中的两个变量，它们可能用于不同的目的。将它们放入公共超类意味着现在只有一个变量，并且（潜在的）多个目的现在可能会发生冲突。

此外，效率是旁观者的眼中。在不了解细节的情况下，很难说一堆静态面板是否是初始化应用程序的最有效方式。另一种效率是利用你的时间。在我看来，问题在于，根据需要进行修补以维护应用程序是否更有效，或者花大量时间进行前期重构是否更有效，希望能减少维护应用程序的时间。谁知道？我对这类事情的一般理念是，“如果它没有坏，就不要修理它”。

# java - 如何在 JAVA 中检查空 XML 元素

> ID：12625374
> 
> 赞同：3
> 
> 时间：2012-09-27T15:55:16.790
> 
> 标签：java, xml-parsing

我有一个如下的 XML：

```
<info>
    <userId>Admin</userId>
    <userNotes></userNotes>         
</info> 
```

我正在尝试在 JAVA 中解析它。这是我的代码片段：

```
NodeList userIdNodeList = document.getElementsByTagName("userId");

if (userIdNodeList!=null) {
    userId = userIdNodeList.item(0).getChildNodes().item(0).getNodeValue().trim();
}            

NodeList userNotesNodeList = document.getElementsByTagName("userNotes");

if (userNotesNodeList!=null) {
    userNotes = userNotesNodeList.item(0).getChildNodes().item(0).getNodeValue().trim();
} 
```

`userNotes`但是上面的代码由于元素为空而引发了 NULL 指针错误。

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T15:59:20.420

*（更正）*

`userNotesNodeList.item(0).getChildNodes().getLength()`如果没有子元素或文本，将返回 0。

**为什么**

`userNotesNodeList`是`<userNotes>`节点列表。有1个。无论如何你可以检查长度来验证它。

`userNotesNodeList.item(0)`是第一个`<userNotes>`元素。

`userNotesNodeList.item(0).getChildNodes()`是里面的东西的列表`<userNotes>...</userNotes>`。

如果没有文本，这是一个具有 0 个元素的 NodeList，所以

```
userNotesNodeList.item(0).getChildNodes().getLength() should return 0. 
```

我建议将 vars 用于中间结果（以使代码更清晰）。或者创建一些辅助方法来避免这种繁琐的 XML api。

```
NodeList userNotesNodeList = document.getElementsByTagName("userNotes");
// userNotesNodeList should not be null, it can be zero length, but not null
Element userNotesElement = (Element) userNotesNodeList.item(0);
if (userNotesElement.getChildNodes().getLength() > 0) // then it has text
{
   userNotes = userNotesElement.getChildNodes().item(0).getNodeValue();
} 
```

# php - 我正在尝试用正则表达式拆分一个句子

> ID：12625378
> 
> 赞同：1
> 
> 时间：2012-09-27T15:55:45.420
> 
> 标签：php, regex

我整天都在试图解决这个问题，但我怎样才能可靠地按以下顺序拆分下一行。

> 被动：标记与附近盟友隔离的敌人。主动：造成 70/100/130/160/190 (+) 点物理伤害。如果目标被孤立，数量会增加到 100/145/190/235/280 (+)。进化的大爪：对孤立的敌人造成的伤害增加其已损失生命值的 12/12/12/12/12%（对怪物最大 200/200/200/200/200）。将尝尝恐惧的范围和卡兹克的基本攻击范围扩大 50/50/50/50/50。

```
Array
(
    [0] =>  Array
        (
            [0] => Passive
            [1] => Marks enemies who are isolated from nearby allies.
        )
    [1] =>  Array
        (
            [0] => Active
            [1] => Deals 70/100/130/160/190 (+) physical damage. If the target is isolated, the amount is increased to 100/145/190/235/280 (+).
        )
    [2] =>  Array
        (
            [0] => Evolved Enlarged Claws   
            [1] => Increases damage to isolated enemies by 12/12/12/12/12% of their missing health (max 200/200/200/200/200 vs. monsters). Increases the range of Taste Their Fear and Kha'Zix's basic attacks by 50/50/50/50/50.
        )
) 
```

我不能超过中间的句子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:19:48.723

```
(?:^|\s*)([^.:]+):\s*(.+?\.)(?=[\w\s]+:|$) 
```

名称在捕获组 1 中，描述在捕获组 2 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:04:39.290

好吧，这似乎可以解决问题...

```
preg_match_all('/(?<=^|[.] )([^:]+): (.+?[.])(?=[^.]+:|$)/', $text, $matches, PREG_SET_ORDER);
var_dump($matches); 
```

...如果我理解给定的结构（`'Term: Description. Term: Description'`等）。实际上，描述中的冒号可能会破坏它；点在这里做得很好。

这个匹配的结果可以很容易地转换成一个关联数组：

```
$spell = array();
foreach ($matches as $match) {
   $spell[$match[1]] = $match[2];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:12:39.353

用作`.`父/主数组和`:`子数组的分隔符。

```
function so12625378_explode_to_multiarray( $string )
{
    foreach ( explode( ". ", $your_string ) as $part )
        $result[] = explode( ": ", $part );

    return $result;
} 
```

采用：

```
 $string = 'Passive: Marks enemies who are isolated from nearby allies. Active: Deals 70/100/130/160/190 (+) physical damage. If the target is isolated, the amount is increased to 100/145/190/235/280 (+).';
 echo '<pre>'.var_export( so12625378_explode_to_multiarray( $string ), true ).'</pre>'; 
```

# python - 如何在windows中处理python中的文件上传？

> ID：12625379
> 
> 赞同：3
> 
> 时间：2012-09-27T15:55:50.180
> 
> 标签：python, python-3.x, cgi

我确实将 HTML 表单发布到在简单的 python 服务器上运行的 python 脚本。一个帖子请求中最多可以发布 10 个文件。图像数据的访问方式如下：

```
import cgi
# simple post data access
form = cgi.FieldStorage()
imgfieldname = "image1"
imagedata = form[imgfieldname].file.read()

# size varies for the same source image file for different uploads
# on Win7 for no obvious reason
size = len(imagedata)

# save image data to file, results in an truncated image on Win7
# as the image is already truncated when read from form above
fh = open("image1", "wb")
fh.write(imagedata)
fh.close() 
```

上面的代码在 Mac OS 10.8 下的 Python 3.2.3 上运行良好。我确实在 Win7 中的 Python 3.2.3 下遇到随机错误。文件上传不是随机完成的。我有时会上传完整的文件，有时会收到截断的文件。

发布数据的 HTML 表单如下所示：

```
<form action="/cgi-bin/save.py" method="post" name="Formular" id="Formular"  enctype="multipart/form-data">
<input type="file" formenctype="multipart/form-data" name="image1"/>
<input type="file" formenctype="multipart/form-data" name="image2"/>
<input type="file" formenctype="multipart/form-data" name="image3"/>
<input type="file" formenctype="multipart/form-data" name="image4"/>
<input type="file" formenctype="multipart/form-data" name="image5"/>
<input type="submit" value="save" />
</form> 
```

有谁知道为什么在Win7下会发生这种情况？

**编辑**

执行脚本的 python 服务器看起来像

```
#!/usr/bin/env python
#-*- coding: ISO-8859-1 -*-

import http.server
import socketserver
import subprocess
import os
import time
import threading

import cgi
import cgitb; cgitb.enable()

try: # Windows needs stdio set for binary mode.
    import msvcrt
    msvcrt.setmode (0, os.O_BINARY) # stdin  = 0
    msvcrt.setmode (1, os.O_BINARY) # stdout = 1
except ImportError:
    pass

PORT = 8000

class MyHandler(http.server.CGIHTTPRequestHandler):

    # Disable logging DNS lookups
    def address_string(self):
        return str(self.client_address[0])

class ThreadingHTTPServer(socketserver.ThreadingMixIn, http.server.HTTPServer):
    pass

if __name__=='__main__':

    #Handler = http.server.CGIHTTPRequestHandler
    Handler = MyHandler

    #httpd = http.server.HTTPServer(("", PORT), Handler)
    httpd = ThreadingHTTPServer(('localhost', 8000), Handler)

    print("serving at port", PORT)
    httpd.serve_forever() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:26:44.567

```
try: # Windows needs stdio set for binary mode.
    import msvcrt
    msvcrt.setmode (0, os.O_BINARY) # stdin  = 0
    msvcrt.setmode (1, os.O_BINARY) # stdout = 1
except ImportError:
    pass 
```

从这个页面：[http ://webpython.codepoint.net/cgi_file_upload](http://webpython.codepoint.net/cgi_file_upload)

# android - EditText android:numeric="decimal" 和 android:inputType="numberDecimal" 的区别

> ID：12625380
> 
> 赞同：1
> 
> 时间：2012-09-27T15:55:52.833
> 
> 标签：android

我想知道，这2之间有什么区别？

```
 <EditText                
            android:inputType="numberDecimal" /> 
```

* * *

```
 <EditText                
            android:numeric="decimal" /> 
```

我意识到两者都有相同的行为。他们将用户输入限制为“ **0123456789** ”。

那么，两者之间有什么区别吗？有没有更好的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:04:07.700

所有这些属性都已弃用：

```
android:numeric
android:phoneNumber
android:inputMethod
android:capitalize
android:autoText 
```

支持一个属性：

```
android:inputType 
```

（请记住，不推荐使用的功能有一天会在未来的版本中消失，因此最好使用受支持的版本。）

* * *

无论出于何种原因，它们的弃用没有在 TextView（或 EditText）文档中标记......但是它们在[R.attr](http://developer.android.com/reference/android/R.attr.html)页面上得到了正确注释，并且大概您会在 IDE 的 XML 编译器中看到警告（至少在 Android 的 Eclipse 插件中）在。）

# php - Yii 防止在客户端验证时提交表单

> ID：12625383
> 
> 赞同：1
> 
> 时间：2012-09-27T15:56:07.007
> 
> 标签：php, jquery, validation, yii, client-side

我在尝试在 yii 1.1.12 上进行客户端验证时遇到问题。我有以下

```
<?php
Yii::app()->clientScript
        ->registerCoreScript('jquery');
?>
<?php $form=$this->beginWidget('CActiveForm', array(
    'id'=>'my-form',
    'enableClientValidation' => true,
        'clientOptions'=> array('validateOnSubmit'=>true,
                                 'afterValidate'=>'js:function() 
                                        {     
                                           return false
                                        }'
                                ),
        'htmlOptions' => array('enctype' => 'multipart/form-data'),
)); 
?> 
```

即使在验证后使用 return false，我的表单仍在提交中。有什么办法可以解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T05:15:16.557

You may be going right way. But Yii client side validation also depends on the error you show in form. If your showing error using `CHtml::error()` method than for that variable client side validation will not happen. I can't say what you are using as you have not posted any code. So try Using `$form->error()` method. Let me know if still your are facing problem.

Also check the link below given.

```
<?php
Yii::app()->clientScript
        ->registerCoreScript('jquery');
?>
<?php $form=$this->beginWidget('CActiveForm', array(
    'id'=>'my-form',
    'enableClientValidation' => true,
    'clientOptions'=> array('validateOnSubmit'=>true),
    'htmlOptions' => array('enctype' => 'multipart/form-data'),
)); 
?> 
```

[http://www.waytoblogger.com/blog/technical/yii/yii-client-side-validation/](http://www.waytoblogger.com/blog/technical/yii/yii-client-side-validation/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:04:49.963

试试这个：

```
<?php $form=$this->beginWidget('CActiveForm', array(
    'id'=>'my-form',
    'enableClientValidation' => true,
    'htmlOptions' => array('enctype' => 'multipart/form-data'),
)); 
?> 
```

我看到`clientOptions`你没有做任何具体的事情。所以就删了。而且您不必自己包含jquery，据我所知，yii会在需要时自动包含它（我猜这里需要activeform）。你可以看看这个[网址](http://www.yiiframework.com/doc/api/1.1/CActiveForm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:16:43.400

解决了。刚刚删除

```
<?php
Yii::app()->clientScript
        ->registerCoreScript('jquery');
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-10T10:06:08.603

```
'enableClientValidation'=>true,
 'clientOptions' => array('validateOnSubmit'=>true), 
```

# javascript - 谷歌地图 api 3 MouseEvent latLng

> ID：12625384
> 
> 赞同：0
> 
> 时间：2012-09-27T15:56:12.397
> 
> 标签：javascript, google-maps-api-3, geolocation, mouseevent

我正在尝试使用谷歌地图作为定位位置的工具。为此，我正在使用 javaScript api v3。我也在使用[ipinfodb](http://www.infodb.com) api 进行地理定位。我遇到了一个我怀疑是 API 问题的问题，但可能我忘记了一些东西......这是我的代码的一部分：

```
var googleMap = null; // of type google.maps.Map
var googleApiKey = <myGoogleApiKey>;
var scriptLoaded = false;
var latLng = null; // expecting format: "lat,lng" or "(lat,lng)"
var marker = null; // of type google.maps.Marker

function setLatLong(locationStr){
    if (null != locationStr && locationStr.length>2){
        latLng = ""+locationStr;
    if (null != googleMap){
            var ll = latLng.split(","); 
            ll[0] = ll[0].replace(/\(/i,"");
            ll[1] = ll[1].replace(/\)/i,"");
            //TODO: write ll[0], and ll[1] somewhere
        }
    }
}

function loadGoogleMapsScript() {
    if (!scriptLoaded){
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "https://maps.googleapis.com/maps/api/js?key="+ 
                     googleApiKey+"&sensor=false&callback=initGoogleMaps";
        document.body.appendChild(script);
        scriptLoaded = true;
    }
}

function initGoogleMaps() {
var llArray = null;
if (null != latLng) llArray = latLng.split(",");
else  llArray = [0,0];

if (null == googleMap){
      var mapOptions = {
        zoom: 13,
        center: new google.maps.LatLng( (llArray && llArray.length == 2)? parseFloat(llArray[0]) : null, 
                                        (llArray && llArray.length == 2)? parseFloat(llArray[1]) : null ),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        draggable:true
      };
      googleMap = new google.maps.Map(document.getElementById("theMapId"), mapOptions);
      google.maps.event.addListener(googleMap, 'click', function(event) {
            placeMarker(event.latLng);
      setTimeout('placeMarker(googleMap.getCenter())',500);
} else{
      googleMap.setZoom(13);
      googleMap.setCenter((llArray && llArray.length == 2)? parseFloat(llArray[0]) : null, 
                          (llArray && llArray.length == 2)? parseFloat(llArray[1]) : null );
}
}

function placeMarker(location) {
    if ( !isNaN(location.lat()) && !isNaN(location.lng()) )
        setLatLong("("+location.lat()+","+location.lng()+")");
    else return null;
    if (marker){
        marker.setMap(null);
        marker.setMap(googleMap);
        marker.setPosition(location);
     } else{
        marker = new google.maps.Marker({
            position: location,
            map:googleMap,
            clickable:false,
            draggable:true
        });
        google.maps.event.addListener(marker, 'dragend', function(event) {
            placeMarker(event.latLng);
        });
    }
} 
```

当我打开弹出式 div 时，我首先调用 loadGoogleMapsScript()，该弹出式 div 会在作业完成后从页面中删除。一切都很完美，但有时地图会发疯。如果我不更改标记的位置，下次（在同一会话中）我尝试打开弹出 div，与地图的 onclick 事件相关的 MouseEvent.lat() 的值变为 NaN，并且标记略微向顶部移动地图。无法正确拖动地图。这就是我用来移除弹出窗口的方法：

```
function removePopupDiv(){
    jQuery('.popup_div-area').remove();
//setTimeout("removeScriptBySrcContent('https://maps.g');removeScriptBySrcContent('.googleapis');",300);
    scriptLoaded = false;
    googleMap = null;
    marker = null;
} 
```

如您所见，我什至尝试删除添加的脚本标签，但没有成功，有时会出现问题。我试图解决这个问题一段时间，但没有成功。以前有人遇到过这个问题吗？我找不到其他人抱怨这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:20:06.590

Google 开发人员有一个带有演示的站点，他们有[一个](http://gmaps-samples-v3.googlecode.com/svn/trunk/geocoder/getlatlng.html)可能有用的站点。

在开发 Google Map 应用程序之前，您应该先学习[基础知识](https://developers.google.com/maps/documentation/javascript/reference)，然后再继续

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T10:14:30.680

这是我的错误......每次设置值时，我都应该有来自任何不需要的字符的经度和纬度数据的清晰字符串。现在一切都像魅力一样。

```
function setLatLong(locationStr){
    if (null != locationStr && locationStr.length>2){
        latLng = ""+locationStr;
            latLng = latLng.replace(/\(/g,"");
            latLng = latLng.replace(/\)/g,"");
            latLng = latLng.replace(/ */g,"");
    }
... 
```

# java - blueJ kareltje 在世界上制造港口

> ID：12625385
> 
> 赞同：1
> 
> 时间：2012-09-27T15:56:12.903
> 
> 标签：java, bluej

Kareltje 需要穿过迷宫

现在我想创建一个 Kareltje 必须找到的坐标列表。这些坐标是端口（墙）。当 Kareltje 走到这个港口时，它会放下一堵墙，这样他就不能回去了。我的问题是我不知道如何制作墙壁和坐标。有人可以帮我弄这个吗？

**这是我现在得到的代码：**

```
import wereld.Robot;

public class OefenRobot4 extends Robot  {

    boolean finish = false;

    public OefenRobot4(String naam)
    {
        super(naam);
    }

    public void hoofdProgramma()
      {
          vraagBegin();
          Verplaatsen();
          Lopen();
      }

    public String vraagBegin() {
        String deVraag = vraagTekst("Wil je karel helpen zodat de piepbal op zijn plek terecht komt?");
            if(deVraag.equalsIgnoreCase("ja"))
                {
                    zeg ("Oke laten we snel gaan beginnen!");
                }
            else if(deVraag.equalsIgnoreCase("nee"))
                {
                    zeg("Kareltje is verdrietig want zijn piepbal kan hij nu niet terugbrengen ");
                }
    return deVraag;
    }

    public void Verplaatsen(){

      if(pos_x==1&&pos_y==1)
        {
            mijnWereld.verplaats(this, 26,19);
            piepbalMeenemen();
        }

    }

      public void Lopen() {

          while(finish != true) {
              int D = dobbel();

              switch (D) {
                case 1: linksom();
                        break;
                case 2: rechtsom();
                        break;
                default: if (!voorObstakel()) {
                          stap();
                          positieControle();
                         }
                        break;

                }

        }
    }

       public boolean piepbalMeenemen() {
        opPiepbal();
            {
                pakPiepbal();
            }
        return heeftPiepbal();
    }

    public void positieControle()
    {
        if (pos_x==1&&pos_y==1)
            {
                legPiepbal();

                zeg("Ik heb de piepbal terug gebracht!");
            }
    }
} 
```

**这是来自 de oefenwereld 的代码：**

```
// Code voorbeeld voor een robot met de naam Kareltje

import wereld.*;

public class OefenWereld4 extends Wereld
{

    OefenRobot4 robot;

    public static void main(String args[])
    {
        OefenWereld4 wereld = new OefenWereld4();
    }

    public OefenWereld4()
    {
        super(myworld);
        setSlaaptijd(1);
        robot = new OefenRobot4("Kareltje");
        plaats(robot, 1, 1);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T13:30:25.303

为了帮助您，我们还需要包含 Wereld 和 Robot 类的代码。

# ruby-on-rails-3 - RAILS 3.2：如何从“路由错误”页面中救援

> ID：12625386
> 
> 赞同：0
> 
> 时间：2012-09-27T15:56:13.590
> 
> 标签：ruby-on-rails-3, rails-routing

如何从`RoutingError`Rails 3.2 应用程序中解救，例如重定向到`root_path`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:07:04.703

我想不出你想从 RoutingError 中解救出来的任何情况。

如果您希望所有未指定的路由重定向到某个特定操作（例如，对于自定义“未找到”错误），您可以使`routes.rb`文件中的最后一个路由匹配任何内容并指向那里：

```
match "*path" => 'some_controller#some_action' 
```

按顺序尝试路由并使用第一个匹配的路由，因此只要它保持在最后，当且仅当没有其他路由与请求的路径匹配时才会使用它。

# perl - 如何将文件输出到特定目录？

> ID：12625391
> 
> 赞同：1
> 
> 时间：2012-09-27T15:56:34.520
> 
> 标签：perl

我希望将我正在创建的文件输出到我在 perl 脚本中创建的目录中。

我可以创建目录

```
use File::Path;

$dir = "foo/";
mkpath($dir); 
```

和我的文件

```
$FILE = "output.txt";
unless(open $filehandle, ">", $FILE){
  die "\nUnable to create $FILE:\n$!";
}
printf $filehandle "writing stuff to my file\n";
printf $filehandle "and some more stuff\n";
close($filehandle); 
```

一切正常，除了我是要输出到我之前在脚本中创建的目录的文件。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:09:01.910

您可以使用 chdir 更改目录，或将目录添加到文件名：

```
chdir($dir) or die "Failed to cd to $dir: $!";
# or
$FILE = "$dir/output.txt"; 
```

但不要两者都做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:36:31.893

```
use File::Spec::Functions;
my $dir = "/somedir";
my $FILE = "output.txt";

my $path = catfile($dir, $FILE)
my $filehandle

unless(open $filehandle, '>',  $path){
  die "\nUnable to create $FILE\n";
}
close($filehandle) 
```

和其他的没有太大区别，但是你可以`catfile`根据当前的操作系统来做路径。移植代码时，您不想更改构建路径的方式。

此外，使用`lexical`文件处理程序是比使用 Bareword (FILE) 更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:12:46.887

此代码将执行您的要求：

```
$FILE = "$dir/output.txt";
unless(open $filehandle, ">", $FILE){
  die "\nUnable to create $FILE:\n$!";
}
printf $filehandle "writing stuff to my file\n";
printf $filehandle "and some more stuff\n";
close($filehandle); 
```

您需要指定要写入文件的路径。您可以使用绝对路径或相对路径，从当前工作目录开始。

# javascript - 如何使用 cookie、JQuery、Javascript？

> ID：12625395
> 
> 赞同：1
> 
> 时间：2012-09-27T15:56:48.923
> 
> 标签：javascript, jquery, cookies

我目前正在创建一个简单的待办事项列表，但我遇到了 cookie 问题。当我删除该行时`$.cookie(todoDescription+1, todoDescription);`，添加任务的按钮起作用，并且新任务被添加到列表中。但是当我在网页中留下这条线时，它会闪烁并且什么也没有发生。

```
 $(document).ready( function() {  

    showCookies();            // to show previous tasks when page is reloaded
    var all =0;

        $('#add_todo').click( function() {                 // button that adds a task

        var cookies = get_cookies_array() ;

        var todoDescription = $('#todo_description').val();   // string from textinput
           var mykey = todoDescription + 1;            //i jst decided to have such key

         $.cookie(todoDescription+1, todoDescription);     //this line doesnt work!

            //add task
            $('.todo_list').prepend(
            '<div class="todo">'
                + '<div>'
                    + '<input type="checkbox" id = "cb" class="check_todo" name="check_todo"/>'
                + '</div>'

                + '<div class="todo_description" contentEditable = "true">'
                    + todoDescription
                + '</div>'

                +'<div id = "delete">' +'<input id = "x" type = "submit" value = "X" onclick = "$.cookie('todoDescription+1',null);$(this).parent().parent().remove();"/>'+ '</div>'
            +'</div>');

           return false;

        }); //end add todo

    });

    function showCookies()
    {

    var cookies = get_cookies_array() ;
        for(var name in cookies) {
        if(name == cookies[name]+1){
             $('.todo_list').prepend(
            '<div class="todo">'
                + '<div>'
                    + '<input type="checkbox" id = "cb" class="check_todo" name="check_todo"/>'
                + '</div>'

                + '<div class="todo_description" contentEditable = "true">'
                    + cookies[name]
                + '</div>'

                +'<div id = "delete">' +'<input id = "x" type = "submit" value = "X" onclick = "$.cookie('name',null);$(this).parent().parent().remove();"/>'+ '</div>'
            +'</div>');
        }
        }

    }
     function get_cookies_array(){ 

          var cookies = { };
            if (document.cookie && document.cookie != '') {

                var split = document.cookie.split(';');
                    for (var i = 0; i < split.length; i++) {
                    var name_value = split[i].split("=");
                    name_value[0] = name_value[0].replace(/^ /, '');
                    cookies[decodeURIComponent(name_value[0])] = decodeURIComponent(name_value[1]);
        } 
    }
    return cookies;   
    } 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:01:51.467

以下是 jQuery cookie 的使用说明

创建会话 cookie：

```
$.cookie('the_cookie', 'the_value'); 
```

创建过期 cookie，从那时起 7 天：

```
$.cookie('the_cookie', 'the_value', { expires: 7 }); 
```

创建过期 cookie，在整个站点中有效：

```
$.cookie('the_cookie', 'the_value', { expires: 7, path: '/' }); 
```

读取 cookie：

```
$.cookie('the_cookie'); // => "the_value"
$.cookie('the_cookie', { raw: true }); // => "the_value" not URL decoded
$.cookie('not_existing'); // => null 
```

删除 cookie：

```
// returns false => No cookie found
// returns true  => A cookie was found
$.removeCookie('the_cookie'[, options]); 
```

注意：删除 cookie 时，您必须传递与设置 cookie 完全相同的路径、域和安全选项，除非您依赖默认选项。

# msbuild - MSBuild Exec Task，按项目组拆分退出代码

> ID：12625396
> 
> 赞同：1
> 
> 时间：2012-09-27T15:56:50.830
> 
> 标签：msbuild, itemgroup

我在构建（msbuild）期间启动了一组应用程序。命令元数据仅用于在生产中进行测试，它将包含真正的命令行。如何实现 Exec 任务的输出以知道应用程序 1 已完成，退出代码为 1608，应用程序 2 的退出代码为 1605。

```
<ItemGroup>
    <App Include="Application 1">
        <Command>exit 1608</Command>
    </App>
    <App Include="Application 2">
        <Command>exit 1605</Command>
    </App>
</ItemGroup>

<Exec Command="%(App.Command)" ContinueOnError="true">
    <Output TaskParameter="ExitCode" ItemName="ExitCode"/>
</Exec>

<Message Text="%(App.Identity) was completed with ExitCode="???"/> 
```

# ruby - 在 Ruby 中计算哈希值

> ID：12625398
> 
> 赞同：13
> 
> 时间：2012-09-27T15:57:03.073
> 
> 标签：ruby

我在 Ruby 中有一个哈希数组，如下所示：

```
domains = [
  { "country" => "Germany"},
  {"country" => "United Kingdom"},
  {"country" => "Hungary"},
  {"country" => "United States"},
  {"country" => "France"},
  {"country" => "Germany"},
  {"country" => "Slovakia"},
  {"country" => "Hungary"},
  {"country" => "United States"},
  {"country" => "Norway"},
  {"country" => "Germany"},
  {"country" => "United Kingdom"},
  {"country" => "Hungary"},
  {"country" => "United States"},
  {"country" => "Norway"}
] 
```

从这个哈希数组中，我想创建一个看起来像这样的新哈希：

```
counted = {
  "Germany" => "3",
  "United Kingdom" => "United Kingdom",
  "Hungary" => "3",
  "United States" => "4",
  "France" => "1"
} 
```

有没有使用 Ruby 1.9 的简单方法来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T17:31:16.103

这个怎么样？

```
counted = Hash.new(0)
domains.each { |h| counted[h["country"]] += 1 }
counted = Hash[counted.map {|k,v| [k,v.to_s] }] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T17:54:58.527

```
domains.each_with_object(Hash.new{|h,k|h[k]='0'}) do |h,res|
  res[h['country']].succ!
end
=> {"Germany"=>"3",
 "United Kingdom"=>"2",
 "Hungary"=>"3",
 "United States"=>"3",
 "France"=>"1",
 "Slovakia"=>"1",
 "Norway"=>"2"} 
```

# vb.net - 对象的类型初始化器抛出异常

> ID：12625399
> 
> 赞同：2
> 
> 时间：2012-09-27T15:57:04.620
> 
> 标签：vb.net, class, initialization

我收到一个运行时错误“'SensionVB.CommonCall' 的类型初始化程序引发了异常。” 尝试实例化对象调用时：

```
Dim general As New SensionVB.CommonCall 
```

当单步执行代码时，一旦遇到上述代码行并失败，它就会执行 .

微软的建议是检查空值，或者添加新的，在这种情况下都不是真的

SensionVB = Project CommonCall = 具有各种功能的公共类

```
Public Class CommonCall
Protected WithEvents litOne As System.Web.UI.WebControls.Literal
Public Shared sConnection As String = ConfigurationManager.ConnectionStrings("SerialStamperConnectionString").ConnectionString
Public Shared oConnection As New MySqlClient.MySqlConnection(sConnection)
Public Shared sMaxSerialNumber As String = "S000001"
Public Shared bLoggedin As Boolean = False
Public Shared iPageWidth As Integer = 1024

Public Shared isValidPassword As Boolean = False
Public Shared strCompanyID As String = ""
Public Shared strSecurityID As String = ""

Dim Response As New HttpResponse(HttpWriter.Null)
Const TimeOutInMinutes As Integer = 60
Const SiteTitle As String = "SensiOn"
Public Const PageWidth As Integer = 1250
Public SSOenabled As Boolean
Const SuperUserEmails As String = "super@domain.com"
Public Sub Initialize()
    oConnection.Open()
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T02:02:07.290

我看到三行可能是罪魁祸首：

* * *

```
Public Shared sConnection As String = ConfigurationManager.ConnectionStrings("SerialStamperConnectionString").ConnectionString 
```

这里有几个潜在的问题。一，您的连接字符串名称（“SerialStamperConnectionString”）不正确。如果此名称与 web.config 中的键不匹配，则它将返回`Nothing`，当您尝试获取该`ConnectionString`属性的值时会导致 NullReferenceException。

* * *

```
Public Shared oConnection As New MySqlClient.MySqlConnection(sConnection) 
```

可能是您上面的连接字符串在 web.config 中没有正确配置，因此返回`Nothing`为 ConnectionString。如果 sConnection 已设置为`Nothing`，则 MysqlConnection 构造函数可能会抛出 NullReferenceException。

* * *

```
Dim Response As New HttpResponse(HttpWriter.Null) 
```

如果`HttpWriter.Null`是，`Nothing`那么这也可能是您的问题的根源（出于上述相同的原因）。

* * *

如果这些建议似乎都没有导致问题，那么我建议发布有关您的问题的更多信息（包括堆栈跟踪）。提供一百万个信誉点不会向我们提供有关您的代码的任何其他信息。

* * *

**附录**
根据关于共享构造函数（以及扩展成员）的 VB 文档：

> 共享构造函数的确切运行时间主要取决于实现，但如果显式定义了共享构造函数，则会提供一些保证：
> 
> *   共享构造函数在创建任何类类型的实例之前运行。
> *   共享构造函数在访问结构类型的任何实例成员之前运行，或者在显式调用结构类型的任何构造函数之前运行。调用为结构创建的隐式无参数构造函数不会导致共享构造函数运行。
> *   共享构造函数在引用任何类型的共享成员之前运行。
> *   共享构造函数在从该类型派生的任何类型加载之前运行。
> *   在程序的单次执行期间，共享构造函数不会运行多次。
> 
> [9.3.2 共享构造函数](http://msdn.microsoft.com/en-us/library/aa711965%28v=vs.71%29.aspx)

您可能会发现创建一个 Shared 构造函数来初始化您的共享字段很有用：

```
Public Shared sConnection As String
Public Shared oConnection As MySqlClient.MySqlConnection

Shared Sub New()
    Dim l_connectionString = ConfigurationManager.ConnectionStrings("SerialStamperConnectionString")
    If l_connectionString IsNot Nothing Then
        sConnection = l_connectionString.ConnectionString
        oConnection = New MySqlClient.MySqlConnection(sConnection)
    Else
        ' What to do here?
    End If
End Sub 
```

这很可能不会解决您的问题，但它可能更容易找到和处理（空字符串等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:56:48.727

此行可能会使其失败：

```
Dim Response As New HttpResponse(HttpWriter.Null) 
```

因为它同时被初始化。尝试将其设置为：

```
Dim Response As HttpResponse = Nothing 
```

并在代码中对其进行初始化以进行初始化。您还可以检查是否获得了空对象。

假设您在共享变量中获得正确的结果，您还在进行一些初始化：

```
Public Shared oConnection As New MySqlClient.MySqlConnection(sConnection) 
```

这些不会影响初始化，因为它们是共享的，但 IMO 是不好的做法。

而不是`Initialize()`，为什么不使用`New()`：

```
Public Sub New()
    'TODO move init. of Response to here.
    'TODO move init. of oConnection to here.
    oConnection.Open() 'TODO error check
End Sub 
```

# facebook-fql - 带排序的部分文本用户搜索 - 我该如何解决这个问题？

> ID：12625403
> 
> 赞同：0
> 
> 时间：2012-09-27T15:57:09.073
> 
> 标签：facebook-fql

我正在尝试实现一种“公众人物”搜索形式，它采用部分字符串并返回可能为公众所知的页面和用户。在页面方面，我按喜欢的数量排序，在用户方面，我按订阅者的数量排序。页面工作正常。用户没有。

我的问题的症结在于我不能在用户表上使用 CONTAINS() ，如下所示：

```
SELECT id, name from USER where CONTAINS("Jimmy F") ORDER BY subscriber_count DESC 
```

我得到零结果。但是，如果我使用 Profile 表，它就可以工作。从这里，我可以做一个子查询，结果如下：

```
SELECT uid,name from USER WHERE uid in (SELECT id FROM profile where
CONTAINS("Jimmy F")) ORDER BY subscriber_count DESC 
```

这里的问题是子查询没有排序。所以，在这个例子中，我希望看到拥有 633k 订阅者的[Jimmy Fallon 。](https://graph.facebook.com/fql?q=select%20name,uid,subscriber_count%20from%20user%20where%20uid%20=%201646868425)我没有，因为他不包含在该配置文件子查询中。我可以增加该子查询的 LIMIT，但它会减慢很多（LIMIT 200 需要 4 秒才能返回，并且*仍然*不包括 Jimmy）。

所以我在这里的广泛问题是：有什么想法吗？我不知道在哪里可以得到更好的结果，在这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T20:50:13.977

我认为您遇到的问题是由于 Facebook 的可见性限制。在文档的某处，Facebook 解释说，当它执行任何查询时，它首先收集结果，然后过滤掉可见的结果。

我用这个查询做了一些测试：

```
SELECT uid, name, subscriber_count FROM user WHERE CONTAINS(_STRING_) 
  ORDER BY subscriber_count DESC 
```

我尝试的值越具体，我收到的数据就越多：例如“Jimmy Fallon”、“Paul Ryan”和“Michael Arrington”似乎都返回了合适的人作为第一个结果。“Joe Biden”返回了数据，但前 10 个回复（如“Mehmad Moha”）没有在他们的名字中包含任何“Joe”或“Biden”的变体。

我尝试的其他值`_STRING_`没有返回任何数据，包括“Jimmy F”、“Barack Obama”、“Mitt Romney”或“Mark Zuckerberg”。返回的结果必须是私有的，对我不可见。

我不确定`CONTAINS`实际搜索的是什么。它似乎没有在任何地方记录。返回的人是否是朋友似乎没有任何关联。

似乎确实可以向其中添加一个字段，例如`CONTAINS('Jimmy F', name)`，这会产生 OAuth 错误：`'name' is not a valid search field for the user table`。我在用户表中找不到任何不返回此错误的字段。

您可以尝试对此提交错误报告，但`CONTAINS()`似乎是不受支持的功能。

# java - 总是四舍五入一个数字

> ID：12625408
> 
> 赞同：1
> 
> 时间：2012-09-27T15:57:29.580
> 
> 标签：java, math, rounding

我想知道如何指示 Java 始终舍入给定的数字。

例如：

```
1.08 rounds to 1
1.88 rounds to 1
1.999999999999 rounds to 1
0.0002 rounds to 0
123.77 rounds to 123 
```

有什么建议么？

提前致谢！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T15:59:37.767

[`Math#floor`这](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#floor%28double%29)就是：

> 返回小于或等于参数且等于数学整数的最大（最接近正无穷大）双精度值

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T15:59:43.150

我会用`Math.floor(double)`而不是`Math.round(double)`

或者，如果您想向 0 舍入，您可以直接施放

```
double d = 1.999999999999;
long l = (long) d; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T17:33:33.793

Math.floor 函数可以解决问题。

采用双精度，返回小于或等于参数且等于数学整数的最大（最接近正无穷大）双精度值。

如果您需要以不同的形式使用它，只需将其转换为（即 int）

如果您对它的工作原理感到好奇，请在此处查看规格：http: [//docs.oracle.com/javase/6/docs/api/java/lang/Math.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html)

如果您需要一个示例，请告诉我，我会联系您 :)

# variables - umbraco razor - 检查字段是否存在

> ID：12625409
> 
> 赞同：3
> 
> 时间：2012-09-27T15:57:33.307
> 
> 标签：variables, razor, umbraco, undefined

我有以下代码，但是如果我没有图像（它是媒体选择器），则会出现错误

```
<umbraco:Macro runat="server" language="cshtml">
@{
    dynamic image = new umbraco.MacroEngines.DynamicMedia(@Model.whereMap);
    <img class="where-map" src="@image.umbracoFile" width="150" height="250"/>
 }
</umbraco:Macro> 
```

我已经尝试了所有明显的东西来检查空值，但没有任何乐趣。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-29T08:55:42.860

看看这些剃须刀方法：

*   @Model.HasProperty（字符串属性别名）
*   @Model.HasValue（字符串属性别名）
*   @Model.IsNull（字符串属性别名）

参考：[Umbraco Razor 备忘单](http://our.umbraco.org/FileDownload?id=3103)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-14T23:38:48.773

在 Umbraco 6 MVC 中，您可以使用

键入：

```
@{
    if(Model.Content.HasValue("mainImage")){
        var mediaItem = Umbraco.TypedMedia(Model.Content.GetPropertyValue("mainImage")); 
        <img src="@mediaItem.GetPropertyValue("umbracoFile")" alt="@mediaItem.GetPropertyValue("Name")"/>    
    }   
} 
```

动态的：

```
@{      
    if (CurrentPage.HasValue("mainImage")){                                         
        var dynamicMediaItem = Umbraco.Media(CurrentPage.mainImage);
        <img src="@dynamicMediaItem.umbracoFile" alt="@dynamicMediaItem.Name"/>
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-09T00:01:56.477

尝试

```
CurrentPage.HasProperty("mainImage") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-06-26T09:39:09.553

尝试使用以下代码

```
@if(!String.IsNullOrEmpty(@Model.whereMap))
{
 <img class="where-map" src="@image.umbracoFile" width="150" height="250"/> 
} 
```

# python - 将情节传出班级

> ID：12625410
> 
> 赞同：3
> 
> 时间：2012-09-27T15:57:36.037
> 
> 标签：python, matplotlib

我一直在尝试将 pyplot Figure 从外部类中传递出来（如必须导入），但没有成功。我什至不知道这是否是我应该解决从课堂上获得情节（未显示）的问题的方式。

```
from matplotlib.figure import Figure
import matplotlib.pyplot as plt

class Plotter(object):
    def __init__(self, xval=None, yval=None):
        self.xval = xval
        self.yval = yval

    def plotthing(self):
        f = Figure(1)
        sp = f.add_subplot(111)
        sp.plot(self.xval, self.yval, 'o-')
        return f 
```

这就是大致的类（名称 plotfile.py）。这是其他大量脚本。

```
from plotfile import Plotter
import matplotlib.pyplot as plt

app = Plotter(xval=range(0,10), yval=range(0,10))
plot = app.plotthing()
app.show(plot) 
```

我已经尝试了这个主题的几种变体，并尝试了我最好的 googlefu，但没有成功。任何帮助将不胜感激。如果我在我的方法上走得很远，我很乐意听到如何正确地做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:11:12.350

几点：我不认为`Figure`像你想象的那样工作，而且你的`Plotter`对象没有`.show()`方法，所以`app.show(plot)`不会工作。以下对我有用：

* * *

```
# plotfile.py
import matplotlib.pyplot as plt

class Plotter(object):
    def __init__(self, xval=None, yval=None):
        self.xval = xval
        self.yval = yval

    def plotthing(self):
        f = plt.figure()
        sp = f.add_subplot(111)
        sp.plot(self.xval, self.yval, 'o-')
        return f 
```

* * *

```
from plotfile import Plotter

app = Plotter(xval=range(0,10), yval=range(0,10))
plot = app.plotthing()
plot.show()
raw_input() 
```

* * *

# php - 与运营商有关的问题

> ID：12625415
> 
> 赞同：1
> 
> 时间：2012-09-27T15:57:53.067
> 
> 标签：php, mysql

我有这个表格，我用它来搜索数据库中的特定记录。

这是查询：

```
$sql = "select * from `hostess` where first_name_en like '%$term' or family_name_en like '%$term%' order by `family_name_en` asc"; 
```

问题是，如果我搜索 ie *ele*，就会出现所有包含*ele*的名称，例如*elena*等，但是如果我写*elena*什么都不会出现。

**怎么会**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:12:51.927

您在第一个 LIKE 中遗漏了 %。目前你的说法搜索任何以ele结尾的名字。

1.  `LIKE '%ele'`- 匹配任何以 ele 结尾的东西
2.  `LIKE 'ele%'`- 将匹配以 ele 开头的任何内容
3.  `LIKE '%ele%'`- 将匹配任何带有 ele 的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:03:31.420

```
$sql = "select * from `hostess` where first_name_en like '%$term%' or family_name_en like '%$term%' order by `family_name_en` asc"; 
```

**%$期限%**

**用这个**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:04:15.597

您是否有理由不使用value`%`的末尾`first_name_en`？

```
$sql = "select * from `hostess` where first_name_en like '%$term%' or family_name_en like '%$term%' order by `family_name_en` asc"; 
```

**编辑：**对于大小写问题：

```
$term = strtolower($term);
$sql = "select * from `hostess` where lower(first_name_en) like '%$term%' or lower(family_name_en) like '%$term%' order by `family_name_en` asc"; 
```

# c - C "%d" 格式说明符

> ID：12625416
> 
> 赞同：5
> 
> 时间：2012-09-27T15:57:53.183
> 
> 标签：c, format-specifiers

以下代码将输出显示为“d”：

```
void main()
{

  short int a=5;

   printf("%d"+1,a);

   getch();

} 
```

实际效果如何`printf()`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T15:59:34.163

`printf`没有“看到”格式说明符，因为您正在传递一个指向`"%d"`加一的指针。这相当于自己传递`"d"`：

```
printf("d", a); 
```

将打印`d`并忽略`a`. 这不是特定于`printf`，指针算术与所有`char`指针一样工作，包括从字符串文字（即双引号字符序列）获得的指针。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T15:59:24.197

这是`printf("%d"+1,a);`它不会显示的问题，因为只有一个格式说明符，并且 ("%d"+1) 会生成错误

它可以是`printf("%d+1",a);`或者`printf("%d",a+1);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:46:44.263

诸如“%d”之类的字符串字面量是*数组表达式*，在大多数情况下，数组表达式将被转换为指针表达式，其值是数组第一个元素的地址：

```
项目地址 00 01 02 03
----- -------- -- -- -- --
"%d" 0xfffbec00 '%' 'd' 0 ??

```

字符串文字“%d”从地址 0xfffbec00 开始（例如）。通过编写`"%d"+1`，您将 1 添加到结果指针值（给出 0xfffbec01），因此您有效地将字符串文字“d”传递给`printf`.

由于字符串“d”不包含格式说明符，`printf`因此按原样打印字符串。该参数在传递给之前进行`a`评估*，*`printf`否则将被忽略。

# java - JSF 2.0 使用请求 bean 动态添加和删除表行

> ID：12625417
> 
> 赞同：1
> 
> 时间：2012-09-27T15:57:52.543
> 
> 标签：java, jsf-2

我是 JSF 的新手（将它用于我的硕士论文），我正在努力实现以下目标：

我想从表中动态添加和删除一行并仅刷新该部分而不是整个页面

我的情况：

1.  我在一个页面中有两个 h:forms，第一个显示来自通过视图传递的对象的数据
2.  在第二个 h:form 中，我有一个**p:dataTable**和一个用于在表中添加数据的输入表单。添加按钮使用 f:ajax 事件在添加输入后呈现第二个 h:form。到目前为止一切正常......

问题是，每次我想在表中添加新条目时，旧条目都会被删除，或者我无法向表中添加条目。页面的负责 bean 是请求范围 bean，每次我为页面执行渲染 oder 更新时，都会创建一个新 bean...

如何在不创建新 bean 的情况下添加一行（或删除一行）？我只想保留添加的数据。

如果需要，我可以提供这种 stange 行为的代码......

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-22T04:57:12.467

两个文件……

演示.xhtml：

```
<h:head>

    <title> Student database </title>
</h:head>
<h:body>
    <h:form>
        <h2 style="color: darkmagenta"> The Student Database <hr color="darkmagenta"/></h2>

        <h:dataTable value="#{stu.bookList}" var="o" style="color: black">

            <h:column>
                <f:facet name="header"> Student Id  </f:facet>#{o.id}
            </h:column>
            <h:column>
                <f:facet name="header"> Student Name  </f:facet>#{o.name}
            </h:column>
            <h:column>
                <f:facet name="header"> Phone No  </f:facet>#{o.phoneno}
            </h:column>
            <h:column>
                <f:facet name="header"> Address  </f:facet>#{o.address}
            </h:column>
            <h:column>
                <f:facet name="header"> Action</f:facet>
                <h:commandLink value="Delete" action="#{stu.deleteAction(o)}" /> /
                <h:commandLink value="Edit" action="#{stu.editAction(o)}" /> 

                    </h:column>
                 </h:dataTable>

        <br/> <br/>
        <h2 style="color: darkmagenta" >To Add/Update Enter The Details <hr color="darkmagenta"/></h2>
            <table style="color: black">

        <tr>
            <td>Student Id :</td>
            <td><h:inputText size="20" value="#{stu.book.id}" /></td>
        </tr>
        <tr>
            <td>Student Name :</td>
            <td><h:inputText size="20" value="#{stu.book.name}" /></td>
        </tr>
        <tr>
            <td>Phone No:</td>
            <td><h:inputText size="20" value="#{stu.book.phoneno}" /></td>
        </tr>
        <tr>
            <td>Address :</td>
            <td><h:inputText size="20" value="#{stu.book.address}" /></td>
        </tr>
        </table>
            <h:commandButton value="Add" action="#{stu.addAction}" disabled="#{stu.enable}" />  <h:commandButton value="Update" action="#{stu.updateAction}" disabled="#{stu.disable}" />

    </h:form>
</h:body> 
```

用户Bean.java：

```
@ManagedBean(name = "stu")
@SessionScoped
public class UserBean implements Serializable {

    private static final long serialVersionUID = 1L;

    private Book book = new Book();
    private boolean disable=true;
    private boolean enable=false;
     private ArrayList<Book> bookList = new ArrayList<Book>();

    public UserBean() {
        book = new Book();

    }

    public boolean isEnable() {
        return enable;
    }

    public void setEnable(boolean enable) {
        this.enable = enable;
    }

    public boolean isDisable() {
        return disable;
    }

    public void setDisable(boolean disable) {
        this.disable = disable;
    }

    public Book getBook() {
        return book;
    }

    public void setBook(Book book) {
        this.book = book;
    }

    public ArrayList<Book> getBookList() {
        return bookList;
    }

    public void setBookList(ArrayList<Book> bookList) {
        this.bookList = bookList;
    }

    public void addAction() {

        System.out.println("Going to Add Data");

            bookList.add(book);
       book = new Book();
        System.out.println("The Data is Added Succesfully");

    }

    public String deleteAction(Book book) {
        System.out.println("Going to Delete Data");
        bookList.remove(book);
        System.out.println("The Data is Deleted Succesfully");
        return null;
    }

    public void editAction(Book book1) {
      setDisable(false);
      setEnable(true);
      book = new Book();
        book.setId(book1.getId());
        book.setName(book1.getName());
        book.setPhoneno(book1.getPhoneno());
        book.setAddress(book1.getAddress());

    }
public void updateAction(){
System.out.println("Going to update Data");
for (Iterator<Book> it = bookList.iterator(); it.hasNext();) {
          Book result = it.next();
            System.out.println(result.id);
            if (result.id == book.getId()) {
                System.out.println(result.id);
                System.out.println("address" + result.address);
                System.out.println("naame" + result.name);
                System.out.println(result.phoneno);

                result.setName(book.getName());
                result.setPhoneno(book.getPhoneno());
                result.setAddress(book.getAddress());
                book = new Book();
                 setDisable(true);
                 setEnable(false);
            }
            else{
              System.out.println("No Data To Update");  
              setDisable(true);
            } 
```

# java - Java 无法将枚举用作注解的字符串参数（例如：Jackson）

> ID：12625422
> 
> 赞同：10
> 
> 时间：2012-09-27T15:58:04.323
> 
> 标签：java, string, enums, annotations, jackson

我正在编写使用[Jackson](http://jackson.codehaus.org/)进行 JSON 序列化的 Java 代码。我必须在我的类之前使用的一个注释是`@JsonTypeName(/*Insert string here*/)`，以便为此类的对象提供唯一的序列化标识符。在我当前的代码中，我们使用另一个类的全局常量来设置 String 参数。例子：

```
public class AnnotationValues {
    private static final String id1 = "1";
    private static final String id2 = "2";
    private static final String id3 = "3";
    // And so on...
} 
```

使用这个类，我们的注解看起来像`@JsonTypeName(AnnotationValues.id1)`. 我个人不认为这是一种非常健壮的编码风格，使用一类全局字符串常量。一旦我的应用程序需要处理大量 JSON 消息并因此需要许多不同的标识符，这将变得很烦人。一般来说，我自然会通过使用`enum`. 我会将课程替换为：

```
public enum AnnotationValues {
    ID1("1"),
    STATS_RESPONSE("2"),
    SESSION_RESPONSE("3"),
    /* Add more... */;
    public final String value;
    private AnnotationValues(String value) {
        this.value = value;
    }
} 
```

使用这个枚举，我想写`@JsonTypeName(AnnotationsValues.ID1.value)`作为我的注释。但这不起作用。我收到此错误消息：*“注释属性 JsonTypeName.value 的值必须是常量表达式”*。一个简单的 Google/SOF 搜索将我带到[这个 SOF 帖子](https://stackoverflow.com/questions/3271659/use-enum-type-as-value-parameter-for-rolesallowed-annotation)，告诉我为什么这是一个错误；注释参数的字符串值必须是常量。很烦人，我不能使用`enum`.

还有其他人遇到这个问题吗？此类问题的公认解决方案是什么？我真的应该为我的注释使用一长串字符串常量吗？有什么办法可以使用我的枚举来挽救？还要别的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T17:16:49.677

我真的希望我或其他人能给你一个不同的答案，但是不，没有其他更好的方法了。在这种情况下，我们都被一个充满静态最终字符串的类所困。您尝试使其工作的方式应该有效，但事实并非如此。目前，这只是 Java 中的方式。我自己曾经遇到过这个问题，我也很恼火地发现不能将 Enums 视为常量表达式。我感受到你的痛苦，我希望我能给你一个不同的答案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-02T06:10:28.903

正如另一个答案所建议的那样，不，这对于 Java 注释是不可能的。

但我想问这个：为什么你认为使用 of`Enum`会比使用 String 常量更好？对我来说，这些方法看起来很相似，而且为了简单起见，添加 Enum 包装器有什么意义？两种情况下的引用是相似的，实际常量存储在一个集中的地方，这有它的好处，这样你就可以共享相同的字符串。

所以我不太明白“不要认为这是一种非常健壮的编码风格”，或者至少不明白使用额外的无操作枚举包装器将如何改进设计。

# jquery - jQuery无限滚动分页

> ID：12625427
> 
> 赞同：1
> 
> 时间：2012-09-27T15:58:14.913
> 
> 标签：jquery, pagination, scroll, infinite

我从[http://andersonferminiano.com/jqueryscrollpagination](http://andersonferminiano.com/jqueryscrollpagination)获得了这个脚本。它是一个无限滚动器，我喜欢它，但我有一个问题。例如我有这个页面。democontent.html 包含 100 个结果。该脚本只是在一个分页中获取该页面的所有结果，并一次又一次地循环相同的结果，这使我的页面加载非常困难。我希望以某种方式在第一次分页时给我 20 个，在第二个分页中再给我 20 个等，而不是循环相同的结果。可能吗？这是功能：

```
$(function(){
$('#content').scrollPagination({
    'contentPage': 'democontent.html', // the url you are fetching the results
    'contentData': {}, // these are the variables you can pass to the request, for example: children().size() to know which page you are
    'scrollTarget': $(window), // who gonna scroll? in this example, the full window
    'heightOffset': 10, // it gonna request when scroll is 10 pixels before the page ends
    'beforeLoad': function(){ // before load function, you can display a preloader div
        $('#loading').fadeIn(); 
    },
    'afterLoad': function(elementsLoaded){ // after loading content, you can use this function to animate your new elements
         $('#loading').fadeOut();
         var i = 0;
         $(elementsLoaded).fadeInWithDelay();
         if ($('#content').children().size() > 200){ // if more than 100 results already loaded, then stop pagination (only for testing)
            $('#nomoreresults').fadeIn();
            $('#content').stopScrollPagination();
         }
    }
}); 
```

# javascript - 仅使用 javascript 替换损坏的图像

> ID：12625432
> 
> 赞同：2
> 
> 时间：2012-09-27T15:58:28.487
> 
> 标签：javascript, image, d3.js

这似乎是一个被问了一千次的问题......但我已经花了两天时间，还没有解决。

我见过这样的答案[，](https://stackoverflow.com/questions/2050597/what-is-the-optimum-way-to-handle-broken-images)尤其是第一个。但是当我尝试只使用 javascript 来完成时，程序永远不会等待。即使我把回报放进去

```
if(image.complete) {return path;} 
```

与其等待图像加载，不如一无所有地退出。

这是我的代码。我想要它在纯 Javascript 中，因为函数的返回值是 d3.js 中 svg:image 的属性值

```
.attr("xlink:href", function (d) {
          var imagePath = "http://xxxxx/peopleimages/" + d.num + ".jpg";
          var img = new Image();
          function onErrorHandler(image) {
              image.onerror = "";
              image.src = genericPath;
              return false;
          }
          img.onerror = onErrorHandler(this);
          img.src = imagePath;

          return img.src; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T18:19:01.113

我不知道您是否需要什么，但通常我使用 onload 和 onerror 并且我没有问题。有些是这样的：

```
function loadImg(targetId,imgURL){
    var contenedorImgs = document.getElementById("container");
    target = document.getElementById(targetId);
    var img = new Image();
    img.onload = function(){
        contenedorImgs.replaceChild(img,target);
        img.id = targetId;
    };
    img.onerror = function(){
        img.src = "http://marcocavalieri.es/fotos/miniaturas/1B.jpg";
    };
    img.src = "http://dev.marcocavalieri.es/fotos/" + imgURL;
} 
```

这段代码是我女儿和我为 Marco Cavalieri 开发的真实代码的摘录，您可以在[http://dev.marcocavalieri.es](http://dev.marcocavalieri.es)看到，在这种情况下，我预加载了图像，因为我需要一些淡入和淡出。您可以在小提琴中看到生动的摘录示例：http: [//fiddle.jshell.net/hmariod/kCRHV/1/](http://fiddle.jshell.net/hmariod/kCRHV/1/)

Bonne annee et bonne santé！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:04:59.803

代码应该更像这样：

```
function onErrorHandler() {
    $(this).off('error', onErrorHandler);
    this.src = genericPath;
    return false;
}
$(img).on('error', onErrorHandler);
img.src = imagePath;

return img.src; 
```

# java - 为什么重绘时这个 JTable 会减半？

> ID：12625435
> 
> 赞同：0
> 
> 时间：2012-09-27T15:58:35.893
> 
> 标签：java, swing, jtable

请帮我调试代码。我正在使用 JTable 制作日历，但是每当我按下下一个或上一个按钮时，日历都无法正确重新绘制。它被“切成两半”，然后再按一次它就消失了。我尝试了不同的方法来处理这个问题，但我真的不知道。

这是代码：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;
import java.util.*;
import java.lang.*;

public class NewCalendar extends JFrame
{
    private JFrame frame = new JFrame();
    private Object[] colNames = {"Sun","Mon","Tue","Wed","Thurs","Fri","Sat"};
    private Object[][] days = new Object[6][7];

    private JLabel lblMonth, lblYear;
    private JButton btnPrev, btnNext, pinBoard, addEntry;
    private Container pane;
    private JPanel pnlCalendar;
    private JComboBox cmbYear;
    private int realYear, realMonth, realDay, currYear, currMonth;
    GregorianCalendar calx = new GregorianCalendar();
    GregorianCalendar cal;
    JScrollPane scroll;
    JTable table;
    TableModel model;
    int row;
    int column;

    public NewCalendar()
    {
        realDay = calx.get(GregorianCalendar.DAY_OF_MONTH);
        realMonth = calx.get(GregorianCalendar.MONTH);
        realYear = calx.get(GregorianCalendar.YEAR);

        //cal = new GregorianCalendar(2012, 10, 27);
        //cal = new GregorianCalendar(realYear, 9, realDay);
        cal = new GregorianCalendar(realYear, realMonth+1, realDay);

        GregorianCalendar cald = new GregorianCalendar(realYear, realMonth, realDay);

        int nod = cald.getActualMaximum(GregorianCalendar.DAY_OF_MONTH);
        int som = cal.get(GregorianCalendar.DAY_OF_WEEK);

        System.out.println(realYear + " " + realMonth + " " + realDay);
        currYear = realYear;
        currMonth = realMonth;
        for( int i=1; i<=nod; i++ )
        {
            row = new Integer((i+som-2)/7);
            column = (i+som-2)%7;
            days[row][column] = new Integer(i);
        }
        TableModel model = new DefaultTableModel(days, colNames)
        {
            private static final long serialVersionUID = 1L;
            public boolean isCellEditable(int row, int column)
            {
                return days[row][column] != null;
            }
        };

        table = new JTable(model);
        table.setRowHeight(38);
        table.setColumnSelectionAllowed(true);
        table.setRowSelectionAllowed(true);
        table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        for(int i=0; i<7; i++)
        {
            table.getColumnModel().getColumn(i).setCellEditor(new ClientsTableRenderer(new JCheckBox()));
        }

        table.getTableHeader().setReorderingAllowed(false);

        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        table.setShowHorizontalLines(true);
        table.setShowVerticalLines(true);

        scroll = new JScrollPane(table);
        /*frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout( new BorderLayout() );
        frame.pack();
        frame.add(scroll);
        frame.setLocation(150,150);
        frame.setVisible(true);
        frame.setSize(325,450);
        frame.setResizable(false);*/

        this.setTitle("Calendar");
        this.setSize(325,450);
        pane = this.getContentPane();
        pane.setLayout(null);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setVisible(true);
        this.setResizable(false);

        //create controls
        lblMonth = new JLabel("January");
        lblYear = new JLabel("Change year: ");
        cmbYear = new JComboBox();
        btnPrev = new JButton("<<");
        btnNext = new JButton(">>");
        pinBoard = new JButton("Go to Pin Board");
        addEntry = new JButton("Add Entry");
        pnlCalendar = new JPanel(null);

        for( int i=realYear-100; i<=realYear+100; i++)
        {
            cmbYear.addItem(String.valueOf(i));
        }

        //register action listeners
        btnPrev.addActionListener( new btnPrev_Action() );
        btnNext.addActionListener( new btnNext_Action() );
        cmbYear.addActionListener( new cmbYear_Action() );

        //add controls to pane
        pane.add(pnlCalendar);
        pnlCalendar.add(scroll);
        pnlCalendar.add(lblMonth);
        pnlCalendar.add(lblYear);
        pnlCalendar.add(cmbYear);
        pnlCalendar.add(btnPrev);
        pnlCalendar.add(btnNext);
        pnlCalendar.add(pinBoard);
        pnlCalendar.add(addEntry);

        //set bounds
        pnlCalendar.setBounds(0,0,500,500);
        lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25, 100,25);
        lblYear.setBounds(10,305,80,20);
        cmbYear.setBounds(230,305,80,20);
        btnPrev.setBounds(10,25,50,25);
        btnNext.setBounds(260,25,50,25);
        pinBoard.setBounds(10,340,300,25);
        addEntry.setBounds(10,380, 300, 25);
        scroll.setBounds(10,50,300,250);
        refreshCalendar( currMonth, currYear); //refresh calendar
    }

    public void refreshCalendar( int month, int year )
    {
        String[] months = {"January","February","March","April","May","June","July","August","September","October","November","December"};
        int nod, som; //number of days, start of month
        btnPrev.setEnabled(true);
        btnNext.setEnabled(true);
        days = new Object[6][7];
        if( month == 0 && year <= realYear-100)
            btnPrev.setEnabled(false);
        if( month == 11 && year >= realYear+100 )
            btnNext.setEnabled(false);
        lblMonth.setText(months[month]); //refresh month label
        lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25,180,25); //re-align label with calendar
        cmbYear.setSelectedItem(String.valueOf(year));
        cal = new GregorianCalendar(year, month, 1);
        System.out.println("refreshed: " + year + " " + month + " 1");
        nod = cal.getActualMaximum(GregorianCalendar.DAY_OF_MONTH);
        som = cal.get(GregorianCalendar.DAY_OF_WEEK);
        for( int i=1; i<=nod; i++ )
        {
            row = new Integer((i+som-2)/7);
            column = (i+som-2)%7;
            days[row][column] = new Integer(i);
        }

        for(int i = 0; i < 6; i++)
        {
            for(int j = 0; j < 7; j++)
            {
                if(days[i][j] == null) System.out.print(" ");
                else System.out.print(days[i][j]+"");
                System.out.print("\t");
            }
            System.out.println();
        }

        TableModel model1 = new DefaultTableModel(days, colNames)
        {
            private static final long serialVersionUID = 1L;
            public boolean isCellEditable(int row, int column)
            {
                return days[row][column] != null;
            }
        };

        JTable table1 = new JTable(model1);
        table1.setRowHeight(38);
        table1.setColumnSelectionAllowed(true);
        table1.setRowSelectionAllowed(true);
        table1.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        for(int i=0; i<7; i++)
        {
            table1.getColumnModel().getColumn(i).setCellEditor(new ClientsTableRenderer(new JCheckBox()));
        }

        table1.getTableHeader().setReorderingAllowed(false);

        table1.setPreferredScrollableViewportSize(table.getPreferredSize());
        table1.setShowHorizontalLines(true);
        table1.setShowVerticalLines(true);

        JScrollPane scroll1 = new JScrollPane(table1);
        // scroll = scroll1;
        pnlCalendar.removeAll();
        pnlCalendar.add(scroll1);
        pnlCalendar.add(lblMonth);
        pnlCalendar.add(lblYear);
        pnlCalendar.add(cmbYear);
        pnlCalendar.add(btnPrev);
        pnlCalendar.add(btnNext);
        pnlCalendar.add(pinBoard);
        pnlCalendar.add(addEntry);
        pnlCalendar.revalidate();
        // pnlCalendar.repaint();
        // pane.repaint();
    }

    public static void main( String[] args ) throws Exception
    {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        /*EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                new NewCalendar();
            }
        });*/

        new NewCalendar();
    }

class ClientsTableRenderer extends DefaultCellEditor
{
    private JButton button;
    private String label;
    private boolean clicked;
    private int row, col;
    private JTable table;

    public ClientsTableRenderer(JCheckBox checkBox)
    {
        super(checkBox);
        button = new JButton();
        button.setOpaque(true);
        button.addActionListener(new ActionListener()
        {
            public void actionPerformed( ActionEvent e )
            {
                fireEditingStopped();
            }
        });
    }

    public Component getTableCellEditorComponent( JTable table, Object value, boolean isSelected, int row, int column)
    {
        this.table = table;
        this.row = row;
        this.col = column;
        button.setForeground(Color.black);
        button.setBackground(UIManager.getColor("Button background"));
        label = (value == null) ? "" : value.toString();
        button.setText(label);
        clicked = true;
        return button;
    }

    public Object getCellEditorValue()
    {
        if(clicked)
        {
            //this is what happens when a cell is clicked
            JOptionPane.showMessageDialog( button, "Column with Value: "+table.getValueAt(row,col)+" - Clicked!\n Row: "+row+" Column: "+col);
        }
        clicked = false;
        return new String(label);
    }

    public boolean stopCellEditing()
    {
        clicked = false;
        return super.stopCellEditing();
    }

    protected void fireEditingStopped()
    {
        super.fireEditingStopped();
    }
}

class btnPrev_Action implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        if( currMonth == 0 )
        {
            currMonth = 11;
            currYear -= 1;
        }
        else
        {
            currMonth -= 1;
        }

        refreshCalendar(currMonth, currYear);
    }
}

class btnNext_Action implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        if( currMonth == 11 )
        {
            currMonth = 0;
            currYear += 1;
        }
        else
        {
            currMonth += 1;
        }

        refreshCalendar(currMonth, currYear);
    }
}

class cmbYear_Action implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {
        if( cmbYear.getSelectedItem() != null )
        {
            String b = cmbYear.getSelectedItem().toString();
            currYear = Integer.parseInt(b);
            //ssrefreshCalendar(currMonth, currYear);
        }
        else
        {
            currMonth -= 1;
        }

        refreshCalendar(currMonth, currYear);
    }
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:50:23.313

几个观察：

*   Swing GUI 对象应该*只*在[事件分派线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建和操作。

    ```
    public static void main(String[] args) throws Exception {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new NewCalendar();
            }
        });
    } 
    ```

*   不要使用`setBounds()`; 使用[布局管理器](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)；您的组件在我的平台上出现[截断。](https://stackoverflow.com/a/12532237/230513)

*   不要*替换*`refreshCalendar()`;中的表格 只需更新`TableModel`; `JTable`当模型触发相关事件时，监听视图将自动刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:17:01.710

如果添加/删除组件，重绘是不够的，因为组件需要重新排序。这可以通过在调用`validate()`之前调用来完成`repaint()`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-06-08T20:00:03.383

你好。试试这个代码人。我想知道有多少人用过这个：D

```
 package dafs;

        /*Contents of CalendarProgran.class */

        //Import packages
        import javax.swing.*;
        import javax.swing.event.*;
        import javax.swing.table.*;
        import java.awt.*;
        import java.awt.event.*;
        import java.util.*;

        public class CalendarProgram{
            static JLabel lblMonth, lblYear;
            static JButton btnPrev, btnNext;
            static JTable tblCalendar;
            static JComboBox cmbYear;
            static JFrame frmMain;
            static Container pane;
            static DefaultTableModel mtblCalendar; //Table model
            static JScrollPane stblCalendar; //The scrollpane
            static JPanel pnlCalendar;
            static int realYear, realMonth, realDay, currentYear, currentMonth;

            public static void main (String args[]){
                //Look and feel
                try {UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());}
                catch (ClassNotFoundException e) {}
                catch (InstantiationException e) {}
                catch (IllegalAccessException e) {}
                catch (UnsupportedLookAndFeelException e) {}

                //Prepare frame
                frmMain = new JFrame ("Gestionnaire de clients"); //Create frame
                frmMain.setSize(330, 375); //Set size to 400x400 pixels
                pane = frmMain.getContentPane(); //Get content pane
                pane.setLayout(null); //Apply null layout
                frmMain.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); //Close when X is clicked

                //Create controls
                lblMonth = new JLabel ("January");
                lblYear = new JLabel ("Change year:");
                cmbYear = new JComboBox();
                btnPrev = new JButton ("<<");
                btnNext = new JButton (">>");
                mtblCalendar = new DefaultTableModel(){public boolean isCellEditable(int rowIndex, int mColIndex){return false;}};
                tblCalendar = new JTable(mtblCalendar);
                stblCalendar = new JScrollPane(tblCalendar);
                pnlCalendar = new JPanel(null);

                //Set border
                pnlCalendar.setBorder(BorderFactory.createTitledBorder("Calendar"));

                //Register action listeners
                btnPrev.addActionListener(new btnPrev_Action());
                btnNext.addActionListener(new btnNext_Action());
                cmbYear.addActionListener(new cmbYear_Action());

                //Add controls to pane
                pane.add(pnlCalendar);
                pnlCalendar.add(lblMonth);
                pnlCalendar.add(lblYear);
                pnlCalendar.add(cmbYear);
                pnlCalendar.add(btnPrev);
                pnlCalendar.add(btnNext);
                pnlCalendar.add(stblCalendar);

                //Set bounds
                pnlCalendar.setBounds(0, 0, 320, 335);
                lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25, 100, 25);
                lblYear.setBounds(10, 305, 80, 20);
                cmbYear.setBounds(230, 305, 80, 20);
                btnPrev.setBounds(10, 25, 50, 25);
                btnNext.setBounds(260, 25, 50, 25);
                stblCalendar.setBounds(10, 50, 300, 250);

                //Make frame visible
                frmMain.setResizable(false);
                frmMain.setVisible(true);

                //Get real month/year
                GregorianCalendar cal = new GregorianCalendar(); //Create calendar
                realDay = cal.get(GregorianCalendar.DAY_OF_MONTH); //Get day
                realMonth = cal.get(GregorianCalendar.MONTH); //Get month
                realYear = cal.get(GregorianCalendar.YEAR); //Get year
                currentMonth = realMonth; //Match month and year
                currentYear = realYear;

                //Add headers
                String[] headers = {"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"}; //All headers
                for (int i=0; i<7; i++){
                    mtblCalendar.addColumn(headers[i]);
                }

                tblCalendar.getParent().setBackground(tblCalendar.getBackground()); //Set background

                //No resize/reorder
                tblCalendar.getTableHeader().setResizingAllowed(false);
                tblCalendar.getTableHeader().setReorderingAllowed(false);

                //Single cell selection
                tblCalendar.setColumnSelectionAllowed(true);
                tblCalendar.setRowSelectionAllowed(true);
                tblCalendar.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

                //Set row/column count
                tblCalendar.setRowHeight(38);
                mtblCalendar.setColumnCount(7);
                mtblCalendar.setRowCount(6);

                //Populate table
                for (int i=realYear-100; i<=realYear+100; i++){
                    cmbYear.addItem(String.valueOf(i));
                }

                //Refresh calendar
                refreshCalendar (realMonth, realYear); //Refresh calendar
            }

            public static void refreshCalendar(int month, int year){
                //Variables
                String[] months =  {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};
                int nod, som; //Number Of Days, Start Of Month

                //Allow/disallow buttons
                btnPrev.setEnabled(true);
                btnNext.setEnabled(true);
                if (month == 0 && year <= realYear-10){btnPrev.setEnabled(false);} //Too early
                if (month == 11 && year >= realYear+100){btnNext.setEnabled(false);} //Too late
                lblMonth.setText(months[month]); //Refresh the month label (at the top)
                lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25, 180, 25); //Re-align label with calendar
                cmbYear.setSelectedItem(String.valueOf(year)); //Select the correct year in the combo box

                //Clear table
                for (int i=0; i<6; i++){
                    for (int j=0; j<7; j++){
                        mtblCalendar.setValueAt(null, i, j);
                    }
                }

                //Get first day of month and number of days
                GregorianCalendar cal = new GregorianCalendar(year, month, 1);
                nod = cal.getActualMaximum(GregorianCalendar.DAY_OF_MONTH);
                som = cal.get(GregorianCalendar.DAY_OF_WEEK);

                //Draw calendar
                for (int i=1; i<=nod; i++){
                    int row = new Integer((i+som-2)/7);
                    int column  =  (i+som-2)%7;
                    mtblCalendar.setValueAt(i, row, column);
                }

                //Apply renderers
                tblCalendar.setDefaultRenderer(tblCalendar.getColumnClass(0), new tblCalendarRenderer());
            }

            static class tblCalendarRenderer extends DefaultTableCellRenderer{
                public Component getTableCellRendererComponent (JTable table, Object value, boolean selected, boolean focused, int row, int column){
                    super.getTableCellRendererComponent(table, value, selected, focused, row, column);
                    if (column == 0 || column == 6){ //Week-end
                        setBackground(new Color(255, 220, 220));
                    }
                    else{ //Week
                        setBackground(new Color(255, 255, 255));
                    }
                    if (value != null){
                        if (Integer.parseInt(value.toString()) == realDay && currentMonth == realMonth && currentYear == realYear){ //Today
                            setBackground(new Color(220, 220, 255));
                        }
                    }
                    setBorder(null);
                    setForeground(Color.black);
                    return this;  
                }
            }

            static class btnPrev_Action implements ActionListener{
                public void actionPerformed (ActionEvent e){
                    if (currentMonth == 0){ //Back one year
                        currentMonth = 11;
                        currentYear -= 1;
                    }
                    else{ //Back one month
                        currentMonth -= 1;
                    }
                    refreshCalendar(currentMonth, currentYear);
                }
            }
            static class btnNext_Action implements ActionListener{
                public void actionPerformed (ActionEvent e){
                    if (currentMonth == 11){ //Foward one year
                        currentMonth = 0;
                        currentYear += 1;
                    }
                    else{ //Foward one month
                        currentMonth += 1;
                    }
                    refreshCalendar(currentMonth, currentYear);
                }
            }
            static class cmbYear_Action implements ActionListener{
                public void actionPerformed (ActionEvent e){
                    if (cmbYear.getSelectedItem() != null){
                        String b = cmbYear.getSelectedItem().toString();
                        currentYear = Integer.parseInt(b);
                        refreshCalendar(currentMonth, currentYear);
                    }
                }
            }
        } 
```

# content-management-system - Umbraco 内容选项卡为空白

> ID：12625437
> 
> 赞同：1
> 
> 时间：2012-09-27T15:58:43.900
> 
> 标签：content-management-system, umbraco

我有一个 Umbraco 4.7.1.1 站点，该站点神秘地丢失了一种特定数据类型的内容和属性数据。数据类型在设置/文档类型中是完整的，但是在内容树中查看时，没有内容。截图见链接：[截图](http://test.vintagenine.com/umbraco.gif)

数据是使用 CMS Import 上传的，并且已经在网站上运行了几个月，但现在才开始显示这个问题。我尝试重新发布内容并循环应用程序池，但没有成功。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T09:05:12.640

你能检查一下`<compilation>`你的 web.config 中的标签是否将 debug 属性设置为“true”吗？Umbraco 后台有许多问题，只有当 Umbraco 包含的客户端依赖 CSS 和 Javascript 缓存和缩小库被激活时才会出现，当调试模式设置为“false”（或不存在）时会发生这种情况。将其设置为 true 意味着后台 CSS & JS 不会被缩小，并且可能会解决您的问题。

# c++ - 为旧版本对齐 VS2010 和 VS6 编译器和链接器开关

> ID：12625441
> 
> 赞同：2
> 
> 时间：2012-09-27T15:58:59.320
> 
> 标签：c++, visual-studio-2010, compiler-construction, projects-and-solutions, visual-studio-6

对于旧项目，我在 Visual Studio 2010 中有一个解决方案，它使用 Visual Studio 6 编译器使用 Visual Studio 2010 的[Daffodil 扩展](http://daffodil.codeplex.com/)进行编译。

我试图让编译器（和链接器）输入与使用 Visual Studio 6 时的输入相等（尽可能）。所以我将 VS2010 项目的构建日志文件与构建日志进行比较VS6 中相同项目的文件。

我注意到在 VS2010 中构建时，在生成的命令行上传递的编译器开关是不同的。其中一些差异我可以在 VS2010 的项目文件设置中修复，但其他一些我似乎找不到：例如`/FD`和`/TP`开关在使用 VS6 构建时存在，但在使用 VS2010 构建时不存在，我似乎无法在任何地方找到这些开关在 IDE 的项目设置中。还有其他一些我似乎无法解决的差异，因为我找不到 VS6 的默认开关（是的，我试过 Google）：例如，`/EHsc`使用 VS2010 构建时存在该开关，但使用 VS6 构建时不存在，这是区别还是这是 VS6 编译器的默认设置？

**所以我的问题是：**

*   是否有 VS6 编译器的默认值列表？
*   对于故障排除：我如何查看 IDE 或 Daffodil 注入或拒绝了哪些开关？

PS：
*我注意到在 VS6 中存在但在 VS2010 中不存在的`/FD`
编译器开关：* 我注意到在 VS6 中不存在但在 VS2010 中存在的编译器开关：`/EHsc` `/Gd` `/TP` `/WX-` `/O2` `/Oy-`
我知道其中大部分可能在项目设置中修复，但我决定添加无论如何，这个项目的完整列表，希望有人可以对特别麻烦的编译器开关进行对齐。

**更新：**好的，这是我发现并解决的问题：

*   该`/WX-`开关（将警告视为错误）可能是无害的，假设它是一个原本不存在的开关的否定，似乎没有任何效果，我怀疑它是由 Daffodil 注入的
*   该`/O2`开关（喜欢快速代码）暗示了其他几个优化开关，是一个严重的错误，通过*清除*项目设置中的优化设置 删除
*   开关（省略帧指针）也可能是无害的，假设它是一个原本不存在的`/Oy-`开关的否定，似乎没有任何效果，我怀疑它是由 Daffodil 注入的
*   IDE 注入了一个`/D _VC80_UPGRADE=0x0600`开关，但它对 VS6 编译器没有意义，所以它是无害的
*   `/EHsc`开关（同步异常处理）显然与最初已经存在的开关相同，所以`/GX`这似乎没问题
*   `/Gd`开关（默认`cdecl`调用约定）显然是 VS6 编译器的默认设置，因此它的存在是无害的，我怀疑它是由 Daffodil 或 IDE 注入 的
*   开关（将`/TP`所有文件视为 C++ 源文件）我无法找到如何在任何地方配置它，但混合源可能很危险，我不知道如何摆脱这个开关，它是由 Daffodil 或 IDE 注入的

然后链接器切换......我设法对齐其中的大部分，除了：

*   开关（保留堆栈大小）在 VS6 中是十六进制的`/stack`，但在 VS2010 中是十进制并用引号括起来，所以我必须在命令行上指定它，但是......
*   `/machine:I386`和`/mapinfo:lines`开关在 VS2010 中是未知的，所以我不得不在命令行中指定它们。它们被附加到文件列表之后的链接器命令行的最后，这很容易被忽略，我不能 100% 确定链接器实际上在文件列表之后选择了额外的开关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:55:19.503

该`/TP`开关由 IDE 添加。

该`/stack`开关接受十进制或 C 语言表示法的值。我做了一个快速测试，VC6 链接器似乎也正确解释了引号中的值，所以我认为您不需要单独指定这些值。

可以在 Linker\Advanced 属性页上指定这些`/machine`值，尽管看起来可选值列表与 VC6 文档不太匹配。这可能是 Daffodil 错误，也可能是文档不准确。

如您所述，该`/mapinfo`开关必须添加到“其他选项”中。

如果您没有禁用日志记录，您可以检查您的链接器命令日志文件 ( `link.command.1.log`) 以查看命令行上传递的确切开关。我用`/mapinfo`开关对此进行了测试，并按预期将其附加到命令行的末尾。

# sql - 如何读取/写入 Easy Dental 2010 DAT 文件？

> ID：12625443
> 
> 赞同：2
> 
> 时间：2012-09-27T15:58:59.383
> 
> 标签：sql, database

我有一个在牙科诊所工作的朋友，他们希望我编写一个数据迁移工具。他们希望将数据从存储在 SQL 数据库中的旧系统中的数据导出到 Easy Dental 2010。除了患者数据，还有他们希望导入 Easy Dental 患者记录的数字文档（图像）。

我看了一下Easy Dental，似乎有可能。Easy Dental 似乎使用 Faircom 的 C-TreeAce 嵌入式引擎，但我不知道他们使用的是哪个版本。我遇到的两个问题是

1.  我不知道 Easy Dental 文件的文件/表格结构。

2.  我不知道如何读写这些 C-TreeAce 文件。

任何有助于快速开始的事情将不胜感激。

我的专长主要是使用 rdbms 后端（如 Oracle）在 Java 中进行企业 Web 开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-22T08:54:34.563

要连接到这些文件以读取/写入并获取 db 结构，最简单的方法是通过 ODBC 连接。您可以通过下载 C-Tree express 版本获取 ODBC 驱动程序（下载： http: [//www.faircom.com/ace/download_t.php](http://www.faircom.com/ace/download_t.php) - 设置：[http://www.baybreezesoft.com/help/sqledge/faq_ctree。 php](http://www.baybreezesoft.com/help/sqledge/faq_ctree.php) ).

然后，您可以使用任何支持 ODBC 连接的 DB 工具轻松浏览文件，并且由于您是 Java 开发人员，因此可以使用 sun.jdbc.odbc.JdbcOdbcDriver。但是，您可能仍然需要凭据才能连接到文件数据库，我希望这是 Windows 身份验证，或者您需要进行一些逆向工程（查看文件、调试）。

# php - 用户登录时出现“无效”错误

> ID：12625445
> 
> 赞同：-1
> 
> 时间：2012-09-27T15:59:04.800
> 
> 标签：php, mysql

我有表“用户”然后里面是列“用户名”和“密码”

用户名 = 管理员

密码（散列）= 管理员

```
<?php
    $message = "";
    if (isset($_POST['submit'])){
    $username = trim(mysql_prep($_POST['user_name']));
    $password = trim(mysql_prep($_POST['password']));
    $hashed_password = sha1($password);

    if (empty($username) || empty($password)){
        $message = "You must enter username and password" . "<br />";
    } else {
        $query = "SELECT * ";
        $query .= "FROM user ";
        $query .= "WHERE user_name = '{$username}' ";
        $query .= "AND password = '{$hashed_password}' ";
        $query .= "LIMIT 1";

        $result  = mysql_query($query);
        verify_database($result);

        if (mysql_num_rows($result) == 1){
            $found_user = mysql_fetch_array($result);
            redirect_to("content.php");
        } else {
            $message = "Invalid username or password" . "<br />";
        }

    }

} 
```

?>

```
 <form action="login.php" method="post">
            <?php echo $message; ?>
            User Name: <input type="text" name="user_name"/><br />
            Password: &nbsp;  <input type="password" name="password"/><br />
            <input type="submit" name="submit" value="Login"/>
        </form> 
```

现在的问题是即使我输入了正确的用户名和密码。我不断收到“无效的用户名或密码”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:00:17.363

尝试这个：

```
<?php
$message = "";

if (isset($_POST['submit'])){
    $username = trim($_POST['user_name']);
    $password = trim$_POST['password']);
    $hashed_password = sha1($password);

    if (empty($username) || empty($password)){
        $message = "You must enter username and password" . "<br />";
    } else {
        $query = "SELECT * ";
        $query .= "FROM user ";
        $query .= "WHERE user_name = '{$username}' ";
        $query .= "AND password = '{$hashed_password}' ";
        $query .= "LIMIT 1";

        $result  = mysql_query($query);
        verify_database($result);

        if (mysql_num_rows($result) == 1){
            $found_user = mysql_fetch_array($result);
            redirect_to("content.php");
        } else {
            $message = "Invalid username or password" . "<br />";
        }

    }

}

 <form action="login.php" method="post">
            <?php echo $message; ?>
            User Name: <input type="text" id="user_name" name="user_name"/><br />
            Password: &nbsp;  <input type="password" id="password" name="password"/><br />
            <input type="submit" name="submit" value="Login"/>
        </form> 
```

# mysql - MySQL 似乎只使用一个 CPU 内核

> ID：12625450
> 
> 赞同：4
> 
> 时间：2012-09-27T15:59:24.103
> 
> 标签：mysql

我正在对包含超过 500 万行的表运行查询，该查询大约需要 30 分钟才能运行。由于显而易见的原因，这是不可接受的，我已经重写了查询以在 10 秒内执行。但我的根本问题是查询只使用了大约 12.5% 的 cpu，而且似乎没有使用服务器的全部资源。服务器有 8 个内核，并且在运行查询 100%/8 个内核 = 每个内核 12.5% CPU 时似乎只使用 1 个。如果重要，数据库使用 MyISAM 引擎。

我知道在大多数情况下，您不希望您的服务器因 1 个查询而陷入困境，但在这种情况下，这是可以接受的（查询在现实世界无法访问的测试服务器上运行，因此流量和其他正在运行的服务是没问题）。

长话短说，是否可以让单个查询访问超过 1 个 CPU，或者由于 MySQL 架构，是否不可能线程（在 CPU 级别）单个查询？我猜还有第三种选择，查询仅使用 12.5 cpu 而 MySQL 可以在每个查询中使用多个内核只是巧合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T13:30:55.967

“目前一条SQL语句在同一个物理线程中从头到尾运行。”

[http://lists.mysql.com/internals/37329](http://lists.mysql.com/internals/37329)

# c# - 使用 lambda 返回字符串

> ID：12625452
> 
> 赞同：0
> 
> 时间：2012-09-27T15:59:30.920
> 
> 标签：c#, lambda

下面是我的问题，我想将文本框的文本设置为类型等于参展商的 WizFile 对象的文件名......我该怎么做？

```
private IList<WizFile> wizFiles;
wizFiles = importerService.GetWizFiles();

txtExhibitors.Text = wizFiles.FileName where wizFiles.Type = exhibitors 
```

wizFiles 中只有一个 WizFile 类型等于参展商。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:00:52.387

您的查询返回一个`IEnumrable<string>`- 您只需要一个：

```
wizFiles.First(w => w.Type == exhibitors).FileName 
```

`First`如果存在则返回第一项，如果列表为空则抛出异常。

您可以使用`FirstOrDefault`which，如果列表为空，a`string`将返回。`null`

如果列表中只有一项很重要，请考虑使用`Single`or`SingleOrDefault`代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:01:52.540

开始：

```
 txtExhibitors.Text = wizFiles.First(wiz => wiz.Type == exhibitors).FileName; 
```

您可能希望在获取 FileName 之前使用 FirstOrDefault 并检查 null。

# c# - SQL Server 计算列如何在 EntityFramework 中工作？

> ID：12625453
> 
> 赞同：3
> 
> 时间：2012-09-27T15:59:32.137
> 
> 标签：c#, .net, sql-server-2008, entity-framework

我有一个表，其列`TotalAmount`是 columns 的计算列`Amount+Extra`，那么如果我在该表上使用实体框架，这个计算是如何工作的？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T17:24:05.913

此外，marc_s 的响应重要的是要注意，更改 EF 实体的基础属性不会重新计算值，除非您保存对象然后从数据库中刷新它。换句话说，C# 对象上的属性不实现从数据库中的计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T17:21:39.787

计算列要么 (a) 每次访问时重新计算，要么 (b) 如果您使用`PERSISTED`关键字定义它，则在表的数据页中创建一个实际列，并将值存储在那里。

无论如何，对于 Entity Framework，这两种计算列的行为都应该像常规列一样。如果实体框架访问表并从中读取数据，它应该获取当前值`TotalAmount`并将其存储在实体的相应属性中。

当您从数据库创建 ADO.NET 实体数据模型时，EF 会发现该列是*计算*列，因此您将无法为该属性设置新值（显然）：

![在此处输入图像描述](../Images/f5e624355d83c0aea646fd230785184c.png)

# osgi - 在 OSGi 捆绑激活期间打开文件

> ID：12625456
> 
> 赞同：1
> 
> 时间：2012-09-27T15:59:39.373
> 
> 标签：osgi, equinox, spring-dm

我已经定义了一个`cluster_implementation`带有声明式服务 (DS) 组件定义的 OSGi 包 ( )，指定了一个导出的服务、一个激活方法和一个停用方法。

在 Activate 方法的主体中，我需要访问文件系统中不存在但捆绑在 OSGi 包本身中的一个文件。在激活方法期间，文件内容被检索为`InputStream`using `java.lang.ClassLoader:getResourceAsStream`。

这主要是有效的，但在一种情况下它不起作用。在我的应用程序中，由 导出的服务`cluster_implementation`可以被其他捆绑包通过服务注册表或声明式服务或 spring-dm 引用。组件的激活策略是`delayed`在第一次引用服务时激活它。

现在，如果激活是因为来自声明性服务组件的引用，则文件内容可以正常读取，如果激活是因为 spring-dm 组件需要该服务，那么`InputStream`资源的`NULL`! `immediate="true"`现在我已经通过在组件属性中设置使组件立即激活来解决问题，但是我的要求是：

*   是否允许在 DS 组件激活期间以 Stream 的形式获取资源的内容？
*   如果这是合法的，为什么通过 spring-dm 激活会导致资源作为 Stream 不可访问？顺便说一句，资源在那里 - 如果我这样做，`Bundle.findEntries`我可以看到它！

我使用的 OSGi 框架是 Equinox 3.6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T06:39:07.937

我猜你的激活器和 spring dm 之间存在时间问题。Spring dm 使用和扩展器来监视带有 spring 上下文的包并初始化它们。这可能与激活器并行运行。老实说，我原以为激活器会首先运行，但似乎情况并非如此。

要解决这个问题，您可以确保文件是由首先访问文件的一方创建的，但要小心使其线程安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T07:24:23.087

我想你一定有比你想象的更多的问题。任何已解析的捆绑包都可以访问资源，并且与 DS 完全无关。由于您的类已加载，您的代码可以从 JAR 加载。

这种行为似乎令人费解，并且可能是框架中的错误。当您使用片段时，我只能想象这会出错？但即使这样似乎也没有任何意义。您是否尝试过其他框架，Felix 具有非常好的诊断功能。

# java - 在有状态 EJB/CDI bean 上导致“事务不活动”异常，而 才不是

> ID：12625460
> 
> 赞同：0
> 
> 时间：2012-09-27T15:59:50.710
> 
> 标签：java, jsf, jakarta-ee, ejb, cdi

我有一个 Seam 3 视图范围的有状态 EJ bean，它在 JSF 页面中使用（您可以在第一次阅读时跳过代码）：

```
@Named
@ViewScoped
@Stateful
@TransactionAttribute( TransactionAttributeType.SUPPORTS )
@LocalBean
public class CollisionManager implements ActionListener, Serializable
{
    ...

    @Inject
    private CollisionService          collisionService;

    // selected collisions (must be an array, call 911-PRIMEFACES)
    private Collision[]               selectedCollisionsArray;
    private List<Collision>           selectedCollisions;

    public Collision getSelectedCollision()
    {
        if ( this.selectedCollisionsArray == null || this.selectedCollisionsArray.length == 0 )
        {
            return null;
        }

        return this.selectedCollisionsArray[0];
    }

    public void setSelectedCollision( Collision selectedCollision )
    {
        this.selectedCollisionsArray = new Collision[1];
        this.selectedCollisionsArray[0] = selectedCollision;
    }

    /**
     * Called by <f:actionListener>
     *
     * This throws an exception:
     * java.lang.IllegalStateException: Transaction is not active in the current thread.
     *    ...
     */
    @Override
    public void processAction( ActionEvent event )
    {
        this.log.infov( "Calling single-selection CLASS NAME action listener for {0}", this.selectedCollisionsArray[0] );

        reloadSelectedCollisions();
    }

    /**
     * Called by <f:setPropertyActionListener>
     *
     * This throws no exception.
     */
    public void setReloadCollision( @SuppressWarnings( "unused" ) Collision selectedCollision )
    {
        this.log.infov( "Calling single-selection PROPERTY action listener for {0}", this.selectedCollisionsArray[0] );

        reloadSelectedCollisions();
    }

    public void reloadSelectedCollisions()
    {
        this.selectedCollisions = ...; // reload list for at least one selected collision
    }

    public void setSelectedStateChangeCollision( Collision selectedStateChangeCollision )
    {
        this.selectedStateChangeCollision = selectedStateChangeCollision;
    }
} 
```

我们有一个项目列表（碰撞），其中可以通过复选框选择多个项目。每个项目都有一个专用按钮来编辑单个碰撞。

![在此处输入图像描述](../Images/fb5d454b616bf67c11ef5f8528f4c028.png)

这是顶部的多选 JSF 命令按钮：

```
<p:commandButton icon="ui-icon ui-icon-flag"
                 value="Change state"
                 disabled="#{empty collisionManager.selectedCollisionsArray}"
                 actionListener="#{collisionManager.reloadSelectedCollisions}"
                 process="@this"
                 update=":state-change-dialog"
                 oncomplete="stateChangeDialog.show();">
<f:setPropertyActionListener target="#{collisionManager.selectedStateChangeCollision}" value="#{collisionManager.selectedCollisions[0]}" />
</p:commandButton> 
```

这个按钮**没有问题**。

由于用户在调用对话框**之前已经选择了项目，因此在按下此按钮（显示编辑对话框）时，多选元素是已知的。**

对于列中的单选按钮，我**首先**使用了以下非常相似的命令按钮：

```
<p:commandButton icon="ui-icon ui-icon-flag"
                 actionListener="#{collisionManager.reloadSelectedCollisions}"
                 process="@this"
                 update=":state-change-dialog :collision-form:list"
                 oncomplete="stateChangeDialog.show();">
    <f:setPropertyActionListener target="#{collisionManager.selectedCollision}" value="#{cln}" />
    <f:setPropertyActionListener target="#{collisionManager.selectedStateChangeCollision}" value="#{cln}" />
</p:commandButton> 
```

这当然会失败，因为在`collisionManager.reloadSelectedCollisions()`通过`<f:setPropertyActionListener`.

然后我删除了命令按钮`actionListener`属性并尝试了一个“类名”动作监听器来解决排序问题：

```
<p:commandButton icon="ui-icon ui-icon-flag"
                 process="@this"
                 update=":state-change-dialog :collision-form:list"
                 oncomplete="stateChangeDialog.show();">
    <f:setPropertyActionListener target="#{collisionManager.selectedCollision}" value="#{cln}" />
    <f:actionListener type="de.company.project.CollisionManager" />
    <f:setPropertyActionListener target="#{collisionManager.selectedStateChangeCollision}" value="#{cln}" />
</p:commandButton> 
```

为了使该`processAction( ActionEvent event )`方法起作用，我必须将接口添加到`CollisionManager`bean 并使用`@LocalBean`. 您可以看到上面发布的最终课程。

但是，这会引发异常：

```
java.lang.IllegalStateException: Transaction is not active in the current thread.
    at com.sun.enterprise.transaction.jts.JavaEETransactionManagerJTSDelegate.validateTransactionManager(JavaEETransactionManagerJTSDelegate.java:447)
    at com.sun.enterprise.transaction.jts.JavaEETransactionManagerJTSDelegate.setRollbackOnlyDistributedTransaction(JavaEETransactionManagerJTSDelegate.java:344)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.setRollbackOnly(JavaEETransactionManagerSimplified.java:971)
    at com.sun.enterprise.transaction.UserTransactionImpl.setRollbackOnly(UserTransactionImpl.java:257)
    at org.jboss.seam.transaction.UTTransaction.setRollbackOnly(UTTransaction.java:82)
    at org.jboss.seam.transaction.DefaultSeamTransaction.setRollbackOnly(DefaultSeamTransaction.java:104)
    at org.jboss.seam.faces.transaction.UnexpectedExceptionObserver.processEvent(UnexpectedExceptionObserver.java:48)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:267)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:263)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:245)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:233)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:213)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:590)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:580)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:575)
    at org.jboss.seam.faces.event.SystemEventBridge.processEvent(SystemEventBridge.java:69)
    at org.jboss.seam.faces.event.DelegatingSystemEventListener.processEvent(DelegatingSystemEventListener.java:51)
    at javax.faces.event.SystemEvent.processListener(SystemEvent.java:106)
    at com.sun.faces.application.ApplicationImpl.processListeners(ApplicationImpl.java:2168)
    at com.sun.faces.application.ApplicationImpl.invokeListenersFor(ApplicationImpl.java:2144)
    at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:302)
    at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:246)
    at javax.faces.application.ApplicationWrapper.publishEvent(ApplicationWrapper.java:670)
    at javax.faces.application.ApplicationWrapper.publishEvent(ApplicationWrapper.java:670)
    at org.jboss.seam.faces.environment.SeamApplicationWrapper$Proxy$_$$_WeldClientProxy.publishEvent(SeamApplicationWrapper$Proxy$_$$_WeldClientProxy.java)
    at com.sun.faces.lifecycle.Phase.queueException(Phase.java:160)
    at com.sun.faces.lifecycle.Phase.queueException(Phase.java:149)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:104)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at de.company.project.filter.encoding.EncodingFilter.doFilter(EncodingFilter.java:62)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:126)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.jboss.solder.servlet.exception.CatchExceptionFilter.doFilter(CatchExceptionFilter.java:65)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.jboss.solder.servlet.event.ServletEventBridgeFilter.doFilter(ServletEventBridgeFilter.java:74)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at de.company.project.filter.security.LoginFilter.doFilter(LoginFilter.java:96)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

作为一个补丁，我尝试了一个`<f:setPropertyActionListener>`，传递当前列表实体：

```
<p:commandButton icon="ui-icon ui-icon-flag"
                 process="@this"
                 update=":state-change-dialog :collision-form:list"
                 oncomplete="stateChangeDialog.show();">
    <f:setPropertyActionListener target="#{collisionManager.selectedCollision}" value="#{cln}" />
    <f:setPropertyActionListener target="#{collisionManager.reloadCollision}" value="#{cln}" />
    <f:setPropertyActionListener target="#{collisionManager.selectedStateChangeCollision}" value="#{cln}" />
</p:commandButton> 
```

此 OTOH 不会**引发**异常。这真的让我想知道...

**问**：

为什么这适用于`<f:setPropertyActionListener>`（调用方法`setReloadCollision( Collision selectedCollision )`），但它与`<f:actionListener />`（调用方法`processAction( ActionEvent event )`）失败？

请注意，我尝试了两种侦听器方法的所有变体都没有成功`@TransactionAttribute( TransactionAttributeType.REQUIRED )`。`@TransactionAttribute( TransactionAttributeType.REQUIRES_NEW )`

高度赞赏帮助。

附录：

1.  谁应该知道这个？
2.  “普通”Java EE 开发人员应该知道什么？
3.  这些信息隐藏在哪里？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:11:35.430

我认为还有另一个异常导致了这个问题，但不知何故它被吞没了。查看堆栈跟踪，我会尝试在

`org.jboss.seam.faces.transaction.UnexpectedExceptionObserver.processEvent(UnexpectedExceptionObserver.java:48)`

看看那里发生了什么。在调用 UnexpectedExceptionObserver.processEvent 之后，Seam 将事务设置为 rollbackOnly，就像在异常之后一样，例如 NullPoInterException。

# c++ - 自定义分配器有时会因 stl 向量而崩溃

> ID：12625461
> 
> 赞同：2
> 
> 时间：2012-09-27T15:59:56.473
> 
> 标签：c++, stl, allocator

我得到了一个自定义分配器，它实现了它自己的分配策略、它自己的 malloc/free 等。现在，我被要求将此自定义分配器与 STL 容器（无论是向量还是其他容器）一起使用。例如，我创建了一个类，`my_stdAllocator`它是一个符合*ISO C++ 标准*的接口。通过这个类，我调用我的分配器的方法。例如：

```
template <class T>
class my_stdAllocator {

    // ...other required stuff...

    // allocate 'num' elements of type T
    pointer allocate(size_type num, const_pointer = 0) {
        return static_cast<T*>(MYAllocator::instance()->malloc(num));
    }

    // deallocate memory at 'p'
    void deallocate(pointer p, size_type num=0) { 
        MYAllocator::instance()->free(p);
    }

    // initialize allocated memory at 'p' with value 'value'
    void construct(pointer p, const T& value) {   
        ::new ((void*)p) T(value);  
    }

    // destroy elements of initialized memory at p
    void destroy(pointer p) {
        p->~T();
    }

    // ...other required stuff...

} // end my_stdAllocator 
```

自定义分配器通常就像一个魅力：它已经过广泛的测试，它肯定会提高性能，限制碎片等。当我将它用作 stl 容器的分配器时，（比如，一个向量）它有这种奇怪的行为它有时可以正常工作，而有时它会因段错误而崩溃。

举个例子，它正确地分配和释放一个向量`char`：

```
typedef char TP;

int main(int argc, char* argv[]) { 

std::vector<TP, my_stdAllocator<TP> > vec;

std::string s ("Whatever string, no matter how long...");

std::string::iterator it;
for (it=s.begin(); it<s.end(); ++it)
    vec.push_back(*it);

... 
```

在向量内按“手动”数字时可以

```
typedef double TP;

int main(int argc, char* argv[]) { 

std::vector<TP, my_stdAllocator<TP> > vec;

// "manual" push_back
vec.push_back(3.2);
vec.push_back(6.4);
vec.push_back(9.6);
vec.push_back(12.8);
vec.push_back(15.1);
vec.push_back(18.3);
vec.push_back(21.5);

... 
```

通过循环插入元素时，它会因分段错误而停止：

```
typedef int TP;

int main(int argc, char* argv[]) { 

std::vector<TP, ff_stdAllocatorInst<TP> > vec;

for(unsigned int i=0; i<size; ++i)
    vec.push_back( (TP) i );

... 
```

*当为至少*一定数量的元素保留空间时，它就像一个魅力：

```
typedef int TP;

int main(int argc, char* argv[]) { 

std::vector<TP, ff_stdAllocatorInst<TP> > vec;

vec.reserve(size);
for(unsigned int i=0; i<size+150; ++i)
    vec.push_back( (TP) i );

... 
```

*请注意，当使用像这样的新展示位置*时，不会发生上述段错误：

```
void *p = MYAllocator::instance()->malloc(size);
std::vector<TP> *vec = new (p) std::vector<TP>
for(unsigned int i=0; i<size; ++i)
    vec->push_back( (TP) i );

... 
```

正如我已经说过的，自定义分配器已经过测试并且工作正常。我的类是 C++ 标准和自定义分配器之间的简单接口。我尝试使用 gdb 对其进行调试，但没有帮助：底层分配器没问题，我的代码中一定有一些错误，但我不明白哪里出了问题！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T16:05:17.097

在调用自定义分配器的`malloc`函数时，您需要乘以要分配的对象的大小：

```
pointer allocate(size_type num, const_pointer = 0) {
    return static_cast<T*>(MYAllocator::instance()->malloc(num*sizeof(T)));
} 
```

# android - 如何使用 Mockito 和 dexmaker 进行 Android 测试？

> ID：12625464
> 
> 赞同：6
> 
> 时间：2012-09-27T16:00:03.720
> 
> 标签：android, mockito, dexmaker

我正在尝试让 Mockito (1.9.5 rc1) 在我的 Android 测试中工作（使用 Robotium）。为了让它在 DVM 上运行，我将 dexmaker.jar 和 dexmaker-mockito.jar (v 0.9) 放在测试项目的类路径中。

在 Eclipse 中将以下测试作为 Android JUnit 测试运行时：

```
package com.stampay.pos.test;

import roboguice.RoboGuice;
import android.app.Application;

import com.jayway.android.robotium.solo.Solo;
import com.stampay.pos.activities.HomeActivity;
import com.stampay.pos.model.Consumer;
import com.stampay.pos.util.ScannerAndroid;

import static org.mockito.Mockito.*;

public class HomeActivityTest extends ActivityTest<HomeActivity> {
    private Solo solo;
    Application app;

    public HomeActivityTest() {
        super(HomeActivity.class);

    }

    @Override
    public void setUp() throws Exception {
        solo = new Solo(getInstrumentation(), getActivity());
    }

    @Override
    public void tearDown() throws Exception {
        solo.finishOpenedActivities();
        RoboGuice.util.reset();
    }

    public void testScan() throws Exception {

        ScannerAndroid scanner = (ScannerAndroid) getActivity().getScannerHelper();

        Consumer mockConsumer = mock(Consumer.class);

        //scanner.generateResult("consumer1");
    }
} 
```

我得到以下堆栈跟踪：

```
java.lang.ExceptionInInitializerError
at com.stampay.pos.test.HomeActivityTest.testScan(HomeActivityTest.java:41)
at java.lang.reflect.Method.invokeNative(Native Method)
at android.test.InstrumentationTestCase.runMethod(InstrumentationTestCase.java:214)
at android.test.InstrumentationTestCase.runTest(InstrumentationTestCase.java:199)
at android.test.ActivityInstrumentationTestCase2.runTest(ActivityInstrumentationTestCase2.java:192)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1584)
Caused by: java.lang.ExceptionInInitializerError
at org.mockito.internal.MockitoCore.<init>(MockitoCore.java:40)
at org.mockito.Mockito.<clinit>(Mockito.java:932)
... 15 more
Caused by: java.lang.ExceptionInInitializerError
at org.mockito.internal.util.MockUtil.<clinit>(MockUtil.java:21)
... 17 more
Caused by: org.mockito.exceptions.misusing.MockitoConfigurationException: Failed to load interface org.mockito.plugins.MockMaker using jar:file:/data/app/com.stampay.pos.test-2.apk!/mockito-extensions/org.mockito.plugins.MockMaker
... 15 more
Caused by: java.lang.ClassNotFoundException: com.google.dexmaker.mockito.DexmakerMockMaker
at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
at org.mockito.internal.configuration.ClassPathLoader.loadImplementations(ClassPathLoader.java:133)
at org.mockito.internal.configuration.ClassPathLoader.findPlatformMockMaker(ClassPathLoader.java:102)
at org.mockito.internal.configuration.ClassPathLoader.<clinit>(ClassPathLoader.java:61)
at org.mockito.internal.util.MockUtil.<clinit>(MockUtil.java:21)
at org.mockito.internal.MockitoCore.<init>(MockitoCore.java:40)
at org.mockito.Mockito.<clinit>(Mockito.java:932)
... 15 more 
```

有什么建议么？[http://code.google.com/p/dexmaker/](http://code.google.com/p/dexmaker/)和[http://code.google.com/p/mockito/wiki/ReleaseNotes](http://code.google.com/p/mockito/wiki/ReleaseNotes)不提供任何有用的信息。

这里似乎报告了一个类似的问题：http: [//www.paulbutcher.com/2012/05/mockito-on-android-step-by-step/#comment-65955](http://www.paulbutcher.com/2012/05/mockito-on-android-step-by-step/#comment-65955)

[更新：使用来自https://github.com/paulbutcher/mockito-on-android/tree/master/WarehouseManagerTest/libs](https://github.com/paulbutcher/mockito-on-android/tree/master/WarehouseManagerTest/libs)的 .jar 文件，一切正常，尽管他使用了基于 1.9.1 的过时的 Mockito 快照

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T15:15:35.717

我在尝试使用 mockito 1.9.5-rc1 时遇到了同样的问题。

dexmaker 页面[指出，为此您需要 1.9.5+](http://code.google.com/p/dexmaker/)，显然 RC1 并没有削减它。[Mockito 1.9.5 似乎是几天前才发布](http://code.google.com/p/mockito/wiki/ReleaseNotes)的，所以它应该很快就会出现在 Maven Central 中。

同时，您可以[从 Mockito 的网站下载 1.9.5 zip](http://code.google.com/p/mockito/downloads/list)。如果您使用的是 Maven，则可以使用`mvn install:install-file`. 我还通过查看最新的 Mockito 源（未发布的 1.9.8）、构建和安装到我的本地 Maven 存储库来实现此功能。

# database - 在两个 Django 项目之间共享模型（和表）

> ID：12625466
> 
> 赞同：0
> 
> 时间：2012-09-27T16:00:12.527
> 
> 标签：database, django, model, celery

我想通过复制模型将主要 django 项目的繁重流程分担到另一个 django 项目。

这意味着共享数据库表。这是一个解释表是如何共享的图表：按照编号的箭头，看看我是如何想象信息流的。

![http://i.imgur.com/kOdeq.png](../Images/a4e558d446ca7bbdec81abe98a2eaf2a.png)

INTERFACE 项目是拼图的用户交互部分，它处理输入和输出并定义用户希望解决的问题。SOLVE 项目解决了繁重的用户定义问题，并在准备好后，将解决方案作为记录放入 INTERFACE 可以读取的自己的表中，并将 INTERFACE 呈现给用户。

这种设计在两个 ORM 的同步方面会有哪些注意事项？这甚至是个好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:35:44.967

换句话说，您正在重新发明一个任务队列？

也就是说，接口只是插入表示“为我做这个”的记录，然后从“这是为你做的”表（或同一个表，没关系）中检索结果？

您真正需要的是某种远程异步 rpc 调用接口，是的，如果您愿意，您可以以这种方式重建。

我仍然建议重新评估芹菜 - 我已经多次推迟了它，但现在我已经设置了它，这让我很震惊，我之前没有使用它。您甚至可以使用 Django DB 作为消息队列后端（尽管我只说对低容量站点这样做）。

无论如何，至于具体问题：

使用相同数据库表的两个独立进程没有继承问题，Django 和您的数据库连接器都不会在这方面添加额外的约束。

您将需要您的工作进程（“解决”）定期轮询数据库以查找要执行的任务，或向其发送消息（提示：芹菜！）。您的 ui 客户端（“界面”）可以在用户刷新时检查数据库。

从实现的角度来看，在两个项目之间完全共享代码（所有模型、视图等）可能是最简单的。您将有一个进程以正常方式启动 ui Web 服务器，对于工作人员来说，连接自定义管理命令可能是启动工作人员循环的最简单方法。

如果您在打算写入行时不使用[select_for_update ，那么您“可能”会遇到一些与数据库锁定/竞争条件有关的问题。](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.select_for_update)或者，您可以使用[.save(update_fields=zzz)](https://docs.djangoproject.com/en/dev/releases/1.5/#support-for-saving-a-subset-of-model-s-fields)来避免争用，但这仅在 1.5 中。

# c# - 更改已通过其他方法打开的表单上的标签文本

> ID：12625467
> 
> 赞同：0
> 
> 时间：2012-09-27T16:00:16.007
> 
> 标签：c#, winforms

我需要更改已经打开的 C# Winform 上的标签文本。该表单是从我的程序中的不同方法打开的，因此它已经打开，并且在首次创建表单时我无法访问该表单的原始引用。

我尝试在下面的代码中执行此操作，但无法访问表单上的标签。有没有办法可以更改已经运行的表单（从另一种方法）上的标签？

```
//http://stackoverflow.com/questions/3861602/c-sharp-how-check-if-the-form-is-already-open-and-close-it-if-it-does
Form fc = Application.OpenForms["form1"];

if (fc != null)
{
     //This does not work.  I can not access the lblNewItems label.
     //The label has it's public modifier set to Public and I am able
     //to set this label successfully when I create the form originally
     //from the other method.

     fc.lblNewItems.Text = "Change text"; 
} 
```

编译上述内容时，出现以下错误：

> 错误 4“System.Windows.Forms.Form”不包含“lblNewItems”的定义，并且找不到接受“System.Windows.Forms.Form”类型的第一个参数的扩展方法“lblNewItems”（您是否缺少使用指令还是程序集引用？）

有人可以告诉我这是否可行，如果可以；如何更改已从另一种方法打开的表单上的标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:20:18.843

你的问题是`fc`type `Form`，而你的标签`lblNewItems`实际上是在某个子类上`Form`（我猜你的类是`Form1`基于这个问题的）。`fc`在尝试访问其元素之前，您需要转换为实际的表单类型：

```
Form1 fc = (Form1)Application.OpenForms["form1"];    
if (fc != null)
{
     fc.lblNewItems.Text = "Change text"; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:05:09.640

> 该表单是从我的程序中的不同方法打开的，因此它已经打开，并且在首次创建表单时我无法访问该表单的原始引用。

在 Program.cs 中创建对表单的公共静态引用，以便您可以从任何方法访问它，只需在设置标签文本之前检查 Null。

# java - 日期验证，包括相应月份的天数

> ID：12625469
> 
> 赞同：0
> 
> 时间：2012-09-27T16:00:22.957
> 
> 标签：java, validation, date, datetime

进行日期验证的最佳方法是什么，包括检查月份在 1 到 12 之间以及天在 1 到最大值之间。各月份的天数（包括闰年）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:03:49.687

你可以用它来检查日期是否有效，你可以调整它（删除无用的信息）你想用它做什么

```
try {
            int dayInt = Integer.parseInt(day);
            int monthInt = Integer.parseInt(month);
            int yearInt = Integer.parseInt(year);
            Calendar cal = new GregorianCalendar();
            cal.setLenient(false);
            cal.set(yearInt, monthInt-1, dayInt);
            //this will throw an exception if the date is not valid:
            cal.getTime();
        } catch (Exception e) {         
            System.out.println("Invalid date entered.", e);
} 
```

还可以查看[日历 API](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)，了解更多验证日期的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:11:44.793

以一种压缩和更清洁的方式：

```
Calendar cal = Calendar.getInstance();
try {
    cal.setTime(theConcernedDate);
}
catch (Exception e) {
  System.out.println("Invalid date");
} 
```

# css - 灯箱打开时 CSS 媒体查询被覆盖

> ID：12625474
> 
> 赞同：2
> 
> 时间：2012-09-27T16:00:50.390
> 
> 标签：css, colorbox, responsive-design, media-queries

当屏幕小于 1000 像素时，我有一个 CSS 媒体查询覆盖一个元素。媒体查询运行良好，直到我打开一个颜色框，那时媒体查询被以前的样式覆盖。

我的代码是这样的：

大师.css

```
#header .holder {
...
width: 960px;
...
} 
```

移动.css

```
@media all and (max-width: 1000px) and (min-width: 320px) {
  #header .holder {
  ...
  width: 100%;
  ...
  }
} 
```

当我打开一个颜色框时，我在 Chrome 的 CSS 检查器中得到了这个：http://i.imgur.com/mhWvF.png [（](http://i.imgur.com/mhWvF.png) 以前的样式是覆盖媒体查询的）

为什么代码会被覆盖？窗口中的颜色框触发了什么事件来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:52:42.693

colorbox的作者在这里。我以前没有听说过这个问题，但这可能是您在颜色框中显示的内容的结果。

像这样的奇怪问题通常是由于人们不正确地将 HTML 文档打开为 ajax，而不是在 iframe 中显示它们。由此产生的无效 HTML、脚本和样式的混合会导致各种问题。

我的猜测是，这是特定于您的实现的东西。我建议尝试在 jsfiddle.net 中创建问题的简化演示，并在此处或 colorbox 的问题跟踪器中发布指向该问题的链接。

# java - R中的MemoryError而read.xlsx

> ID：12625481
> 
> 赞同：13
> 
> 时间：2012-09-27T16:01:10.373
> 
> 标签：java, r, out-of-memory, heap-memory, r-xlsx

我正在使用以下 R 代码（也使用 Java 参数来增加内存）：

```
library(xlsx)
options(java.parameters = "-Xmx1g")
library(XLConnect)
NiVe <- read.xlsx("version1.xlsx",1) 
```

该`version1.xlsx`文件大小为 13 MB。我收到以下错误：

```
Error in .jcall("RJavaTools", "Ljava/lang/Object;", "invokeMethod", cl,  : 
  java.lang.OutOfMemoryError: Java heap space 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-27T16:20:55.090

尝试增加java堆大小（足够），通过使用：

```
options(java.parameters = "-Xmx1000m") 
```

> 如果您使用的是 32 位 R，请确保您也在使用 32 位 Java；如果您使用的是 64 位 R，请确保您也在使用 64 位 Java。如果您收到指示内存不足的 Java 堆空间消息，请参阅[这篇文章](http://rwiki.sciviews.org/doku.php?id=tips:data-io:ms_windows#exchanging_data_between_r_and_ms_windows_apps_excel_etc)。

[这个线程](http://comments.gmane.org/gmane.comp.lang.r.mac/6552)可以帮助你，使用垃圾收集。

**参考：**
[exchanging_data_between_r_and_ms_windows_apps_excel_etc](http://rwiki.sciviews.org/doku.php?id=tips:data-io:ms_windows#exchanging_data_between_r_and_ms_windows_apps_excel_etc)
[stats-rosuda-devel_001621](http://mailman.rz.uni-augsburg.de/pipermail/stats-rosuda-devel/2011q1/001621.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T15:55:46.503

您应该确保在初始化任何 JVM**之前**设置 Java 参数，即在加载 XLConnect 或 xlsx 包之前。请注意，在您的情况下，您使用的是*read.xlsx*函数，它不是 XLConnect 函数，因此不需要 XLConnect 包。XLConnect 替代方法是函数*readWorksheetFromFile*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-05T20:51:43.650

试试这个： - 可能这可以工作。它对我有用

1）下载xlsx文件时，使用这个download.file(fileURL, destfile="./whatever", mode="wb")

2) 切换到常规 R，而不是 R Studio，

# r - 提取R中的唯一字符串

> ID：12625482
> 
> 赞同：0
> 
> 时间：2012-09-27T16:01:12.933
> 
> 标签：r

我有 40 个 CSV 文件。在每个中，有一列名称。在每个名称列中，可能会重复相同的名称（总共，名称列平均有 20,000 行，大约一半是唯一的）。我想创建一个出现在多个文件中的名称列表（同时被告知出现在哪些文件中）。如果相同的名称出现在多个文件中，我想知道每个文件的名称。

所以，在小范围内：

```
 File1
  Name
  John
  Peter
  Abby
  John

  File2
  Mike
  Tim
  John
  Anothername

  File3
  Me
  Mike
  Adam
  Eve 
```

我想要的输出是这样的：

```
data.frame
Names         File
John           1
John           2
Mike           2
Mike           3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:20:03.750

如果您将所有 csvs 放入列表中，您可能会采用以下方法：

```
#generate a fake data set easy to work with
LIST <- lapply(rpois(10, 10), function(i)data.frame(id=1:i, state=sample(state.name, i)))

#add the file number as a column
v <- lapply(1:length(LIST), function(i)data.frame(LIST[[i]], file=rep(i, nrow( LIST[[i]]))))

#make one big data frame
dat <- do.call(rbind, v)[, -1]

#reorder said data frame
dat[order(dat$state, dat$file), ] 
```

# c++ - Eclipse CDT 和编译 C++ 模板

> ID：12625493
> 
> 赞同：2
> 
> 时间：2012-09-27T16:01:45.657
> 
> 标签：c++, templates, build, eclipse-cdt

我有一个非常基本的系统用于学习 C++ 模板。我的理解是应该在模板声明文件中包含模板定义并编译它而不是实现，如下所示：

```
/*LINKEDLIST.H*********************************/

#ifndef LINKEDLIST_H_
#define LINKEDLIST_H_

#include "node.h"

template <typename T>
class linkedlist {
    /*..*/
};

#include "linkedlist.tpp"

/*LINKEDLIST.TPP*********************************/

#include "node.h"

template<typename T>
linkedlist<T>::linkedlist() {
    /*..*/
} 
```

如何让 Eclipse CDT 编译模板的头文件？它似乎试图自己编译模板文件并给我`linker input file unused because linking not done`错误。

```
Building file: ../linkedlist.tpp
Invoking: GCC C++ Compiler
g++ -O0 -g3 -Wall -c -fmessage-length=0 -MMD -MP -MF"linkedlist.d" -MT"linkedlist.d" -o "linkedlist.o" "../linkedlist.tpp"
g++.exe: warning: ../linkedlist.tpp: linker input file unused 
```

我可以编写自己的 makefile，但我很想看看 IDE 中是否有解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:10:32.553

您不构建`.tpp`文件。它们仅包含在带有`#include`指令的头文件中。

相反，您将头文件包含在适当的`.cpp`源文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-11T17:24:20.080

您的 .tpp 文件关联为 C++**源**文件而不是 C++**模板**文件。要解决这个问题：

进入 Eclipse 首选项窗口。

C/C++ -> 文件类型

在文件名列中，找到其中包含 tpp 的扩展名（很可能是 *.tpp）并将其删除。

点击新建...

模式：*.tpp
类型：C++**头**文件

# git - 如何将 git difftool 与 docdiff 一起使用

> ID：12625499
> 
> 赞同：1
> 
> 时间：2012-09-27T16:01:59.140
> 
> 标签：git, diff, git-diff, difftool

我该如何`git difftool`使用`docdiff`？

对于某些文档，我喜欢`docdiff`显示输出的格式。 `Docdiff`然而，输出一个 HTML 文件（如果我们想要它最好的输出）。我应该如何调用`git difftool`以使其在浏览器中显示 HTML diff 结果？

# javascript - 编写一个提示输入字符串和警报的脚本

> ID：12625501
> 
> 赞同：0
> 
> 时间：2012-09-27T16:02:07.783
> 
> 标签：javascript, string, alert, backslash

我需要一些帮助来编写一个提示输入字符串并警告输入的字符串是否包含反斜杠字符或泰卢固语字母 ddha (U+0C22) 的脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:12:01.923

提示输入字符串：

```
var string = prompt("Enter a string"); 
```

检查它是否包含反斜杠：

```
string.match(/\\/) 
```

检查它是否包含泰卢固语字母：

```
string.match(/\u0c22/) 
```

如果找到匹配项，该`match`方法将返回一个包含匹配字母的数组，否则将返回`null`.

# excel - 将值粘贴到用户选择的单元格范围内，有时单元格之间为空白

> ID：12625506
> 
> 赞同：2
> 
> 时间：2012-09-27T16:02:34.627
> 
> 标签：excel, vba

我想运行一个在多个选定单元格中复制日期的宏，有时它们是一个范围，但有时可能会选择单个单元格。所有单元格将位于同一列中。我录制了一个宏来执行此操作，但每次都复制到相同的范围或单元格中。我希望它复制到我选择的单元格中 - 每次都会有所不同。

这是代码

```
Macro1 Macro
' Test copy range
'
' Keyboard Shortcut: Ctrl+e
'
    Range("$AD$10").Select
    Selection.Copy
    Range("C10").Select
    ActiveWindow.SmallScroll Down:=7
    Range("C10,C12,C16:C21").Select
    Range("C16").Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:17:29.190

我几乎不推荐这个，但如果你想将它粘贴到当前选择中，那么试试这个

```
Option Explicit

Sub Sample()
    With Sheets("Sheet1")
        .Range("$AD$10").Copy
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    End With
End Sub 
```

如果您使用上述方法，请确保您进行了正确的错误处理。

或者使用 an`InputBox()`选择您的范围并将其粘贴到其中。看这个例子

```
Option Explicit

Sub Sample()
    Dim Ret As Range

    With Sheets("Sheet1")
        On Error Resume Next
        Set Ret = Application.InputBox(Prompt:="Please select a range where you want to paste", Type:=8)
        On Error GoTo 0

        If Not Ret Is Nothing Then
            .Range("$AD$10").Copy

            Ret.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _
            SkipBlanks:=False, Transpose:=False
        End If
    End With
End Sub 
```

**截屏**

![在此处输入图像描述](../Images/4611f5a131f8c7a615ba6df9534f7cf2.png)

# jquery - 单击时切换背景位置

> ID：12625508
> 
> 赞同：2
> 
> 时间：2012-09-27T16:02:51.180
> 
> 标签：jquery, toggle, background-position

我正在尝试实现这一点[是否有一种简单的方法可以在点击事件的两个状态之间切换背景位置？](https://stackoverflow.com/questions/12573432/is-there-an-easy-way-to-toggle-background-position-between-two-states-on-click-e)

我已经构建了一个*应该可以*工作的函数.. 不知道为什么它不会。对于我的项目中如此乏味的部分，我花了好几个小时试图实现这一点，但这是必要的。

请看一下这个函数：

```
$("#secondarrow").click(function(){
    /*$(".arrows").toggle( 
    function(){ 
        $(this).css({"background-position":"0px 0px"}); 
    },  
    function(){ 
        $(this).css({"background-position":"0px -30px"}); 
    });*/
    /*$(".arrows").toggleClass(function() {
    if ($(this).is(".arrows")) {
    return ".arrowsup";
    } else {
    return ".arrows";
    }
    });*/
    $('#secondarrow').toggle(function() { 
    $("#arrow2").css('backgroundPosition', '0px -15px'); 
    }, function() { 
    $("#arrow2").css('backgroundPosition', '0px 0px'); 
    });
$("#ukmore").slideToggle(100);
$("#clause").slideToggle(100);
}); 
```

它应该做的是，在单击 div 名称第二个箭头时，它会显示许多子类别，*同时*从指向下方的箭头（表示*单击显示更多*）指向一个向上的箭头，该箭头是同一背景图像的一部分（表示*单击以隐藏子类别*）。

我已经尝试了许多不同的功能结构，但它们都没有按要求工作，最新的一个 - 没有被注释掉的 - 确实改变了背景位置以显示向上的箭头，但它只是在第一次单击并且仅在直接单击#arrow1 div 时才执行此操作，当我需要它在单击#secondarrow div 时来回切换时。

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T17:33:31.370

首先 - 你需要更多地练习处理事件。

`.toggle`也是一个事件处理程序，因此您基本上添加了一个新的单击处理程序，用于在单击项目时进行切换。

你只需要做这样的事情：

```
$("#secondarrow").toggle(function() { 
    $("#arrow2").css('backgroundPosition', '0px -15px');
    //do more stuff on first click
    }, function() { 
    $("#arrow2").css('backgroundPosition', '0px 0px'); 
    //do more stuff on second click
    }); 
```

我无法检查上述内容是否适合您。我建议也将您的代码放入 jsFiddle 以解决 stackoverflow 问题。

**第二件事**

最好创建一个具有第二个位置的 css 类，然后绑定一个单击事件，在该事件中切换该类：

```
$("#secondarrow").click(function(){
   $("#arrow2").toggleClass('position2');
}) 
```

还有一个提示：

使用 firebug 或 chrome 开发者工具来调试你的代码。您可以检查您的选择器是否正确。另外，阅读选择器缓存，例如。`$element=$('.something'); $element.show()`

# c# - Datagrid添加行默认添加一个空行

> ID：12625509
> 
> 赞同：0
> 
> 时间：2012-09-27T16:02:53.313
> 
> 标签：c#, wpf, xaml

该函数`InsertProductItem`会将 arow 添加到 datgrid 中。该代码有效，但默认情况下会添加一个空行。我怎样才能删除它？

xml:

```
<DataGrid Name="dgProductList" 
                                  ItemsSource="{Binding Path=ProductList}"> 
```

代码：

```
public ObservableCollection<SalesItem> _ProductList = new ObservableCollection<SalesItem>();
        public ObservableCollection<SalesItem> ProductList { get { return _ProductList; } set { _ProductList = value; } }

        public SalesWindow()
        {
            InitializeComponent();

            this.DataContext = this;
        }

public void InsertProductItem(Product product)
        {
            SalesItem item = new SalesItem { ProductName = product.Name, Quantity = 1, TotalPrice = product.Price };
            ProductList.Add(item);
        } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:05:08.170

如果您不想使用 DataGrid 的默认添加行方式，请在 DataGrid[上将 CanUserAddRows](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.canuseraddrows.aspx)设置为 False

```
<DataGrid Name="dgProductList" 
          ItemsSource="{Binding Path=ProductList}"
          CanUserAddRows="False"> 
```

# objective-c - IOS视图变化

> ID：12625510
> 
> 赞同：0
> 
> 时间：2012-09-27T16:02:59.500
> 
> 标签：objective-c, ios, model-view-controller, view

我正在我的 iphone 应用程序中创建一个教程。我想知道，我是否需要为每个视图创建一个新的 .h .m 和 .xib 文件？或者我可以将多个 .xib 文件连接到同一个 .h 文件，而不是使用 .m 文件在视图之间切换？

例子

我有一个显示有多个选项的表视图。用户选择一个选项，该教程以不同的视图开始。我可以使用新的视图 .h .m 文件来控制多个 .xib 文件，还是每个视图都需要自己的视图控制器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:13:22.707

如果屏幕包含活动`UIControl`元素，例如`UIButton`. 因此，如果第一个屏幕有 3 个按钮，第二个屏幕有 2 个按钮，并且它们都执行不同的选择器，那么您最好坚持每个视图都有一个视图控制器。

对于用户从 UITableView 中选择条目的情况，您绝对希望使用单独的视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:11:17.457

现在在 iOS 5.0 + 中，我建议您使用故事板，它们比 .xib 文件更易于使用并且具有更多功能。

在 Google 上搜索 Storyboard 教程，或在 Apple Docs 中获取： [https ://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html#//apple_ref/doc/ uid/TP40011318](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011318)

# c++ - 是否可以在 C++ 中使用运算符重载来更改（未修改的）包含函数的含义？

> ID：12625511
> 
> 赞同：3
> 
> 时间：2012-09-27T16:02:59.780
> 
> 标签：c++, operator-overloading

我打算在不更改任何实际代码的情况下调整（或获取有关）程序功能的信息。我最初希望这可以通过使用 C++ 运算符重载功能来完成，但最初的测试并不令人满意。

## 具体的

我在*sample.c*文件中有一个简单的函数：

```
void dunno() {
    int x = 1;
    int y = 4;
    int z = x + y;
} 
```

为了改变功能，我创建了一个头文件（在我的脑海中），如下所示：

```
...

int operator+(int x1, int x2) // this syntax is obviously not allowed by C++?
{
    // Change and gain knowledge here!
    return something here;
}   

#include "sample.c"

... 
```

换句话说：我试图改变例如两个正在添加的整数的真正含义。最重要的是，当未修改的函数试图添加两个整数时，应该调用**我的运算符重载函数而不是标准的 C int+int...**

对不起，伙计们，很难体面地解释我想说什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:06:07.153

是的，您可以这样做，但前提是至少有一个操作数是用户定义的类型（这意味着您的示例`int`不起作用），并且该类型还没有该运算符的定义（或者您会得到多个定义错误）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:24:52.677

您可以*通过*为要拦截的每个原语编写一个值包装类（或使其成为存储类型上的模板），然后使用宏来完成这项工作，如下所示：

```
template <typename T> class Primitive;
template <typename T>
Primitive<T> operator+(Primitive<T>, Primitive<T>);

template <typename T> class Primitive {
    T value;
public:
    typedef Primitive<T> MyType;
    Primitive<T>(T);
    // ...    
    friend MyType operator+<T>(MyType, MyType);
    // etc. etc.
};

#define int Primitive<int>
#include "sample.c"
#undef int

... 
```

但这会变得难以想象，你真的不应该这样做。

要理解的关键是你会通过这样做来改变代码，很难确定行为改变了多少。此外，它只会破坏`sample.c`声明外联函数或变量所包含的任何标头。

一个更好的方法可能只是在调试器中单步调试代码，如果你真的想看看它到底做了什么（或者，如果合适的话，`dunno`它的数据类型的模板，这样你就可以在没有宏hacky的情况下传递调试值类型）。

# exception - 处理 CXF 异常

> ID：12625513
> 
> 赞同：1
> 
> 时间：2012-09-27T16:03:14.423
> 
> 标签：exception, service, web, cxf

我使用@WebFault 注释来处理我的 Web 服务上的 CXF 异常，它可以很好地解析异常，但我无法捕获所有这些！

我解释一下，如果出现这样的异常：

> org.apache.cxf.interceptor.Fault：无法发送消息。

我无法在我的网络服务方法中捕捉到它。

主要目标是处理与客户的沟通中断。

如果有人有想法，真的很感激:)

# javascript - 如何使用 Javascript 而不是 JQuery 获取选定的选项 ID

> ID：12625516
> 
> 赞同：15
> 
> 时间：2012-09-27T16:03:29.183
> 
> 标签：javascript, html, select

我需要为两个选择标签使用 Javascript 而不是 JQuery 打印选定的选项 ID。

假设我们有多个选择标签。

```
<select  onchange="showOptions(this)" id="my_select1">
   <option value="a1" id="ida1">Option1</option>
   <option value="a2" id="ida2">Option2</option>
</select>

<select  onchange="showOptions(this)" id="my_select2">
   <option value="b1" id="idb1">Option1</option>
   <option value="b2" id="idb2">Option2</option>
</select> 
```

我发现了以下方式`options[selectedIndex].id`，但我怎么知道该行指的是哪一个..

有什么建议么？

我尝试了以下但没有奏效。

```
<select id="my_select" onchange="showOptions2(this)">
   <option value="o1" id="id1">Option1</option>
   <option value="o2" id="id2">Option2</option>
</select>

<script type = "text/javascript">

function showOptions2(s){
 var adVALUE = console.log(s[s.selectedIndex].value); // get value
 var adID = console.log(s[s.selectedIndex].id); // get id

  alert(adID);

}
</script> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-27T16:05:19.203

```
<select onchange="showOptions(this)">
   ... 
```

* * *

此功能将完成工作

```
function showOptions(s) {
  console.log(s[s.selectedIndex].value); // get value
  console.log(s[s.selectedIndex].id); // get id
} 
```

请注意，除非您将它们用于其他目的，否则您可以省略`id`on`select`元素

示例 jsbin：http: [//jsbin.com/adopiz/2/edit](http://jsbin.com/adopiz/2/edit)

# mysql - 没有为登录选择数据库

> ID：12625518
> 
> 赞同：1
> 
> 时间：2012-09-27T16:03:35.833
> 
> 标签：mysql, database

> **可能重复：**
> [未选择数据库 - PHP & MySQL](https://stackoverflow.com/questions/8513484/no-database-selected-php-mysql)

我正在尝试使用 MySQL 数据库创建基本登录，但每次尝试登录时都会出现“未选择数据库”错误。我有一个包含两个表用户（登录名）和评论（帖子）的数据库设置。代码有点乱，不符合标准，但这不是供公众使用的。

这是代码：

```
<?php
error_reporting (0);
session_start();

if(!$_SESSION['username']){
    header ('location: login.php');
}
else{
error_reporting(0);
require('connect.php');
echo "<a href=\"logout.php\">Logout</a><br /><br /><br />";
$name = $_SESSION['username'];
$today = date("c");
//$today = date("c", strtotime()); 
$comment = $_POST['comment'];
$submit=isset($_POST['submit']);
if($submit)
{
    if($name&&$comment)
    {
    $query = mysql_query("INSERT INTO comment (name,comment,time) VALUES ('$name','$comment','$today')");
header("Location: success.php");
}
else
{
    echo "Please fill out all the fields.";
}}}
?>
<html>
<head>
<title>Comment Box</title>
<script src="jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="jquery.timeago.js" type="text/javascript"></script>
<script>
jQuery(document).ready(function() {
  jQuery("abbr.timeago").timeago();
});
</script>
</head>
<style>
body {
background-color: #DFDFDF;
}
</style>
<body>
<link type="text/javascript" href="localtime.js" />
<form action="#" method="POST">
<label>Name: </label>
<br />
<input type="text" disabled="disabled" name="name" value="<?php echo "$name" ?>" />
<br />
<br />
<label>Comment: </label>
<br />
<textarea name="comment" cols="25" rows="7"></textarea>
<br />
<br />
<input type="submit" name="submit" value="Comment" />
<br />
</form>
<hr width="1100px" size="5px" />
</body>
<?php
require('connect.php');
$query=mysql_query("SELECT * FROM comment ORDER BY id DESC");
while($rows=mysql_fetch_assoc($query))
{
 $id=$rows['id'];
 $dname=$rows['name'];
 $dcomment=$rows['comment'];
 $dtime=$rows['time'];
 $atime="<abbr class='timeago' title='$dtime'></abbr>";

 echo '<font color="red">Name:</font>  ' . $dname . '&nbsp; &nbsp;&nbsp;&nbsp;'. $atime      .     '<br />' . '<br />' . '<font color="red">Comments:</font>  ' . '<br />' . $dcomment . '&nbsp' . '&nbsp' .
      '&nbsp' . '&nbsp';

  if($_SESSION['username']=="admin"){
    echo "<a href=\"delete.php?id=" . $rows['id'] . "\">Delete User</a>"; 
 }
 else
 {
    echo "";
}

echo '<br />' . '<br />' . 
     '<hr size="5px" width="500px" color="blue" />' . '<br />' . '<br />' ;    
}
?>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:18:13.393

I don't know what you have on connect.php file. Maybe you forgot this line:

```
mysql_select_db("table_name",$db); 
```

# mongoid - 如何重置 mongoid 3 数据库连接

> ID：12625521
> 
> 赞同：3
> 
> 时间：2012-09-27T16:03:41.387
> 
> 标签：mongoid, mongoid3, moped

在 Mongoid 2.x 中，可以执行`Mongoid.database.connection.close`重置数据库连接。这个特定的 API 在 Mongoid3 中不再可用，重置连接的新方法是什么？

动机：在查询正在进行时中断查询（ctrl-c）会终止您的连接。任何后续查询都将挂起。此外，诸如超时之类的抛出错误也会做同样的事情（参见：[http](http://simple10.com/rescuing-from-racktimeout-to-close-mongodb-connection) ://simple10.com/rescuing-from-racktimeout-to-close-mongodb-connection ）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-20T20:17:02.277

我找到了解决方案！

```
Mongoid::Sessions.default.disconnect 
```

或者

```
Model.collection.database.session.disconnect 
```

如果您`ctrl-c`在控制台中中断查询，这将正确重置连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T20:56:13.760

事实证明，Mongoid3 的替代 mongo 驱动程序 Moped 实际上会自动处理重试连接。

[https://github.com/mongoid/moped/blob/master/lib/moped/node.rb#L115](https://github.com/mongoid/moped/blob/master/lib/moped/node.rb#L115)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-31T16:12:01.097

除了断开特定会话与

`Mongoid::Sessions.default.disconnect`

您还可以通过以下方式断开所有会话

`Mongoid::Sessions.disconnect`

您可以通过以下方式获取所有活动会话的列表

`Mongoid.sessions`

# c# - 站点核心插入项目数据完整性

> ID：12625529
> 
> 赞同：4
> 
> 时间：2012-09-27T16:03:58.330
> 
> 标签：c#, asp.net, transactions, sitecore, sitecore6

当您在 Sitecore 中插入项目时，您会使用如下代码：

```
Item newItem = parentItem.Add("NameOfNewItem", template); 
```

然后编辑该项目。

然后保存该项目。

如果中间发生错误，在`parentItem.Add`指令之后，您的新项目上的字段不会保存，但子项目已创建并放置在内容树中，所以我们在内容树中有一个不完整的项目（真的错了） .

无论如何要在这条线上插入一个项目吗？

1.  创建一个项目
2.  填充项目
3.  最后，将填充的项目添加到内容树中。

换句话说，有没有办法把`parentItem.Add`指令放在整个过程的最后？

这确实有助于提高数据完整性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T07:10:03.043

开箱即用，我认为不支持交易。[这里](http://sebastianpatten.wordpress.com/2009/05/06/sitecore-and-item-transactions/)有一篇关于 Sitecore 和 Item 事务的好文章，它实现了类似于 Unit of Work 的方法来给出对项目的原子操作的近似值。

Sitecore 内核程序集在内部为需要它的操作提供事务支持。API 似乎没有公开此功能或允许访问数据库 IDbConnection。

```
public virtual DataProviderTransaction CreateTransaction();

Declaring Type: Sitecore.Data.DataProviders.Sql.SqlDataApi 
Assembly: Sitecore.Kernel, Version=6.0.0.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:12:09.617

您基本上是在寻求一种使用事务来创建项目的方法。

Sitecore 6 不支持此功能。有人提到（几年前）Sitecore 7 将支持事务。

# ibm-mq - Spring JMS 重新注册持久订阅

> ID：12625535
> 
> 赞同：1
> 
> 时间：2012-09-27T16:04:06.623
> 
> 标签：ibm-mq, publish-subscribe, websphere-7, spring-jms, subscriptions

我正在开发一个使用 Spring JMS (v3.1.0) 来使用来自主题 (IBM WebSphere MQ v7) 的一些消息的应用程序，并且对 MQ 的监控表明，在每次调用侦听器时，我们都会刷新/重新注册持久订阅。这会导致 MQ 出现意外过载。值得一提的是，该应用程序正在 IBM WepSphere v7 上运行。

这是我们的配置：

```
<bean id="myMessageListenerContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
    <property name="destinationResolver" ref="jmsDestResolver"/>
    <property name="destination" ref="myTopic"/>
    <property name="connectionFactory" ref="myTopicConnectionFactory"/>
    <property name="messageListener" ref="myMessageListener" />
    <property name="pubSubDomain" value="true" />
    <property name="subscriptionDurable" value="true"/>
    <property name="durableSubscriptionName" value="${durableSubscriptionName}"/>
    <property name="sessionTransacted" value="true"/>
    <property name="transactionManager" ref="transactionManager" />
    <property name="taskExecutor" ref="taskExecutor" />

    <!-- Only CACHE_CONSUMER will lead to a fixed registration:
    http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jms/listener/DefaultMessageListenerContainer.html#isRegisteredWithDestination%28%29
    -->
    <property name="cacheLevelName" value="CACHE_CONSUMER" />

    <!-- clientId already specified on the Topic Connection Factory -->
</bean>

<!-- Lookup the topic -->
<jee:jndi-lookup id="myTopic" jndi-name="${myTopic.jndiName}" />

<!-- Lookup the topic connection factory -->
<jee:jndi-lookup id="myTopicConnectionFactory" jndi-name="${myTopicConnectionFactory.jndiName}" />

<!-- Implements javax.jms.MessageListener -->
<bean id="myMessageListener" class="com.sample.jms.MyMessageListener" />

<!-- Get WebSphere work manager --> 
<bean id="taskExecutor" class="org.springframework.scheduling.commonj.WorkManagerTaskExecutor">
   <property name="workManagerName" value="${taskManager.jndiName}" />
</bean>

<!-- 
    Lookup WebSpere transaction manager. More info see: 
    http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/transaction.html#transaction-application-server-integration-websphere 
 -->
<bean id="transactionManager" class="org.springframework.transaction.jta.WebSphereUowTransactionManager"/> 
```

**编辑**：这些是我们正在使用的属性：

```
durableSubscriptionName=myMessageListenerContainer
myTopic.jndiName=jms/myTopic
myTopicConnectionFactory.jndiName=jms/myTopicConnectionFactory
taskManager.jndiName=wm/default 
```

任何想法如何解决这个问题？谢谢！安德烈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:17:44.437

在我自己对 Websphere + Spring 的研究中，我遇到了这个问题。也许它会帮助你：

[https://stackoverflow.com/a/795767/945150](https://stackoverflow.com/a/795767/945150)

基本上 Spring 是在不使用池的情况下创建大量连接

# javascript - 自动完成动画

> ID：12625539
> 
> 赞同：0
> 
> 时间：2012-09-27T16:04:16.753
> 
> 标签：javascript, jquery

我正在使用 JQuery 进行自动完成。我正在使用 onFocus() 来启动自动完成。

我在显示自动完成动画时遇到问题：

```
var j$ = jQuery.noConflict();

function getAutoCompleteDesignations(){

    var availableTags = new Array();
    availableTags = {!JSONDesignationString};

    $('[id$=tags]').autocomplete({
        source: availableTags
    });

} 
```

如何在输入框中输入时显示动画？

# c# - 如何设置 .Net 应用程序以写入 Windows 共享

> ID：12625540
> 
> 赞同：0
> 
> 时间：2012-09-27T16:04:25.670
> 
> 标签：c#, .net, iis, permissions

我在 IIS 7 机器上有一个 .Net 4.0 应用程序，需要将文件写入单独服务器上的 Windows 共享。我有 IIS 设置来模拟并确保我的用户帐户对另一台服务器上的位置具有写入权限。但是，当我通过浏览器运行我的应用程序时，我会收到一个登录提示，并且在输入我的凭据后，我会收到一个 401 说明

```
You do not have permission to view this directory or page using the credentials that you supplied. 
```

我确定我输入的密码是正确的，但这仅在我启动我的应用程序后发生（我可以直接访问网页，但是当我单击按钮运行应用程序时，我得到了这个）

我也尝试在 IIS 中取消模拟，但是当我运行应用程序时，我收到 500 错误，服务器上的错误日志显示

```
An unhandled access exception has occurred. 
```

我对问题可能是什么感到困惑，但我知道它可能是 IIS 中的权限问题。任何帮助将不胜感激，如果需要更多信息，请告诉我。

**编辑**

我去了部署应用程序的服务器，我能够运行应用程序以通过 IIS 浏览写入文件，没有任何问题。但是，如果我尝试通过浏览器从桌面运行该应用程序，则会出现错误。

我运行了 procmon 并且事件完全相同，相同的用户，所有内容，唯一的区别是结果。我想这是一个跳跃问题，但我不确定如何解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T18:42:26.420

我不确定这是否是修复，但我得到了它的工作，

我将应用程序池设置为作为网络服务运行，启用模拟，但在身份验证部分关闭了 Windows 身份验证。不确定为什么该设置会导致此问题

# hibernate - hibernate createalias 向内部联接添加“或”条件

> ID：12625541
> 
> 赞同：1
> 
> 时间：2012-09-27T16:04:32.540
> 
> 标签：hibernate, join, criteria, alias, conditional-statements

我想使用休眠条件和 createAlias 这样的查询：

SELECT .
`table1`"any_field" FROM `table1`内部连接`table2`。= 。或。= table2.field1`table1``field1``table2``field1``table1``field2`

在哪里 .....

主要问题是我无法在内部连接中添加“OR”条件，我应用的所有限制和东西总是变成“AND”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T14:14:47.090

肯定效率不高：

```
session.createCriteria(T2.class, "t2")
    .add(Restriction.or(
        Subquery.exists(DetachedCriteria.for(T1.class).add(Restrictions.eqProperty("field1", "t2.field1")),
        Subquery.exists(DetachedCriteria.for(T1.class).add(Restrictions.eqProperty("field2", "t2.field1")))
    .list(); 
```

# mysql - 两周前的 Wordpress 查询

> ID：12625542
> 
> 赞同：0
> 
> 时间：2012-09-27T16:04:35.537
> 
> 标签：mysql, wordpress

以下查询可追溯到一周，但我将如何使它回到两周：

```
$columnists=new WP_Query(array('showposts'=>3, 'cat'=>66622, 'orderby'=>'rand','w'=>date('W'),'year'=>date('Y'))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:50:45.377

你试过这个吗

```
'w'=>date('W')-1 
```

代替

```
'w'=>date('W') 
```

如果它在这里不起作用是 WP_Query 函数的文档 [http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

# ffmpeg - 如何在不编码的情况下更改 MPEG2-ts？

> ID：12625543
> 
> 赞同：2
> 
> 时间：2012-09-27T16:04:36.000
> 
> 标签：ffmpeg, mpeg2-ts

我有很多用于苹果流媒体的 ts 文件（MPEG2-TS 格式）。我可以使用 ffmpeg 更改此文件的 PTS/PCR 参数吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-27T20:51:05.320

是的。

看看[setpts 过滤器](http://ffmpeg.org/ffmpeg.html#asetpts_002c-setpts)。他们的慢动作示例使用命令行如下所示：

```
ffmpeg -i in.mpg -vf setpts=2.0*PTS out.mpg 
```

# php - 使用下拉菜单查询数据库并在同一页面或另一页面上返回结果

> ID：12625548
> 
> 赞同：0
> 
> 时间：2012-09-27T16:04:42.177
> 
> 标签：php, mysql, html

我有一个包含一些 PHP 的页面，如下所示：

```
<table>
    <thead>
        <tr>
            <th class="wheniwant">Date</th>
            <th class="wheniwant">Income Amount</th>
            <th class="wheniwant">Expense Amount</th>
        </tr>
    </thead>

    <?php
    //DB CONNECTION

    $varDatePaid = ""; $varIncomePaid =""; $varExpensePaid = "";

    $sql = mysql_query( 
        "
            SELECT DATE_FORMAT(`date_paid`, '%Y-%m') `date_paid`,
            SUM(CASE WHEN `categoryType` = 'Income' THEN `amount_paid` END) `IncomeAmount`,
            SUM(CASE WHEN `categoryType` = 'Expense' THEN `amount_paid` END) `ExpenseAmount`
            FROM `accounting`
            GROUP BY DATE_FORMAT(`date_paid`, '%Y-%m')
        "
     );

    while($row = mysql_fetch_array($sql))
        {
            $varDatePaid = $row['date_paid'];
            $varIncomePaid = $row['IncomeAmount'];
            $varExpensePaid = $row['ExpenseAmount'];                        
    ?>

    <tr>
        <td><?php echo $varDatePaid; ?></td>
        <td><?php echo $varIncomePaid; ?></td>
        <td><?php echo $varExpensePaid; ?></td>
        </tr>

    <?php   

        }
    ?>
</table> 
```

这将返回一个类似的表：

![截屏](../Images/b5e83d6bc5a3ad6a1adefb9a21f5e5bc.png)

然后我想添加一些东西：

```
$sql_query = "SELECT id, DATE_FORMAT(`date_paid`, '%Y') AS year FROM accounting GROUP BY year ORDER BY year DESC";

$result = mysql_query($sql_query) or die(mysql_error());
while ($row = mysql_fetch_array($result)){
echo '<option value='. $row['year'] . '>'. $row['year'] . '</option>'; 
```

创建某种过滤器以将结果限制在特定年份。如何在不离开页面的情况下执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:08:16.077

您没有真正提供足够的信息或您尝试过的任何东西。

您将需要一个 HTML 表单，其上的`<select>`框具有唯一 ID，以便您可以通过 $_POST 获取 PHP 中的值，然后在“WHERE”语句中将这些值输入到 SQL 中。

例如

```
<form action="script.php" method="post">
    <select id="filter">
        <option value="value1">Value 1</option>
        <option value="value2">Value 2</option>
        <option value="value3">Value 3</option>
   </select>
   <input type="submit" value="Filter">
</form> 
```

在 script.php 中：

```
<?php
 // DB connect
 $filter = $_POST['filter'];
 $query = "
                  SELECT *
                  FROM TableName
          WHERE field_to_filter = '$filter'
          ORDER BY something ASC
                  "
 //etc
 ?> 
```

请注意，这是一个非常简短的例子。根据您正在尝试做的事情，它会有很大的不同。另外，这没有考虑从表单接受用户输入并将其传递给 SQL 的任何安全问题。

如果 script.php 是当前页面，按下提交按钮将简单地刷新页面，过滤器现在就位。将需要更多代码来确保选择框之前的选择仍然处于活动状态。如果您不想刷新页面，则需要 jQuery 之类的东西，如果您以前没有使用过它，这将增加另一个级别的复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:15:56.417

您首先在 html 中定义下拉列表，并在所选值更改时提交：

```
<form id="myForm" action="samePage.php" method="post">
<select id="mySelection" name="mySelection" onChange="$('#myForm').submit();">
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select>
</form> 
```

并且您修改 php 中的查询以按所选值进行过滤：

```
$sql = mysql_query(  
                      "
                      SELECT *
                      FROM TableName
                      where ColumnName like '%" . mysql_real_escape_string($_POST['mySelection']) . "%'
              ORDER BY something ASC
                      "
                     ); 
```

我没有测试代码，但你应该从这里得到这个想法。我假设您将 jquery 用于*$('#myForm').submit()*脚本。

# nginx - 建立一个 wiki 但 nginx 给我带来了问题

> ID：12625554
> 
> 赞同：0
> 
> 时间：2012-09-27T16:04:55.047
> 
> 标签：nginx, mediawiki

我试图在 wiki.lightenedblade.com 上设置一个 wiki，当我尝试访问该链接时，它给了我一条 404 消息

但是，我的配置和 LocalSettings 文件似乎是有序的，而不是 nginx 配置。这是我的 NginX 配置：

```
 server {
            listen  80;
            server_name lightenedblade.com www.lightenedblade.com;
            root /home/metalmine/public_html/lightenedblade;

            location / {
                    autoindex on;
                    index index.html;
            }
        location ~ \.php$ {
                    fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;
                    fastcgi_index  index.php;
                    fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
                    autoindex on;
                    index index.php;
                    include        fastcgi.conf;
        }

    }

    server {
            server_name wiki.lightenedblade.com;
            root /home/metalmine/public_html/lightenedblade/w;

            # Location for the wiki's root
        location / {
            # Do this inside of a location so it can be negated
            location ~ \.php$ {
                try_files $uri $uri/ =404; # Don't let php execute non-existent php files
                include /etc/nginx/fastcgi_params;
                fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;
            }
        }

        location /images {
            # Separate location for images/ so .php execution won't apply

            location ~ ^/images/thumb/(archive/)?[0-9a-f]/[0-9a-f][0-9a-f]/([^/]+)/([0-9]+)px-.*$ {
                # Thumbnail handler for MediaWiki
                # This location only matches on a thumbnail's url
                # If the file does not exist we use @thumb to run the thumb.php script
                try_files $uri $uri/ @thumb;
            }
        }
        location /images/deleted {
            # Deny access to deleted images folder
            deny    all;
        }

        # Deny access to folders MediaWiki has a .htaccess deny in
        location /cache       { deny all; }
        location /languages   { deny all; }
        location /maintenance { deny all; }
        location /serialized  { deny all; }

        # Just in case, hide .svn and .git too
        location ~ /.(svn|git)(/|$) { deny all; }

        # Hide any .htaccess files
        location ~ /.ht { deny all; }

        # Uncomment the following code if you wish to hide the installer/updater
        ## Deny access to the installer
        #location /mw-config { deny all; }

        # Handling for the article path
        location /wiki {
            include /etc/nginx/fastcgi_params;
            # article path should always be passed to index.php
            fastcgi_param SCRIPT_FILENAME   $document_root/index.php;
            fastcgi_pass  unix:/var/run/php-fpm/php-fpm.sock;
        }

        # Thumbnail 404 handler, only called by try_files when a thumbnail does not exist
        location @thumb {
            # Do a rewrite here so that thumb.php gets the correct arguments
            rewrite ^/images/thumb/[0-9a-f]/[0-9a-f][0-9a-f]/([^/]+)/([0-9]+)px-.*$ /thumb.php?f=$1&width=$2;
            rewrite ^/images/thumb/archive/[0-9a-f]/[0-9a-f][0-9a-f]/([^/]+)/([0-9]+)px-.*$ /thumb.php?f=$1&width=$2&archived=1;

            # Run the thumb.php script
            include /etc/nginx/fastcgi_params;
            fastcgi_param SCRIPT_FILENAME   $document_root/thumb.php;
            fastcgi_pass  unix:/var/run/php-fpm/php-fpm.sock;
        }

    } 
```

这是我的 LocalSettings：[https ://gist.github.com/3794836](https://gist.github.com/3794836)

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:19:57.633

你到底有什么问题？

我确实注意到第二个“服务器”不是“监听”......你有 server_name，但不是监听 80......

试试 nginx -t

它通常会告诉您配置中是否有问题以及在哪里！

编辑（评论不是很可读）

404 未找到...因此服务器正在侦听但未找到您请求的页面 (1)。

我注意到你还有：

```
location / {
            # Do this inside of a location so it can be negated
            location ~ \.php$ {
                try_files $uri $uri/ =404; # Don't let php execute non-existent php files 
```

(1) 您请求了移动站点的“根”，因此 nginx 将查找“index.*”

但是你没有“index.php”

您可以添加“索引 index.php;” 假设移动站点是 php 并且文件 index.php 当然存在

希望这能解决你的问题

# python - SQLite 返回无法转换为可用字符串的 Unicode 缓冲区

> ID：12625557
> 
> 赞同：5
> 
> 时间：2012-09-27T16:05:00.647
> 
> 标签：python, sqlite

我正在从 sqlite3 数据库中读取记录。数据以文本形式存储在数据库中，但是我正在取回缓冲区（它们是 Unicode 格式，我找不到任何东西似乎可以将它们转换为可用的文本（无论是否为 Unicode））

为了使它工作，我必须在 SQL 查询中转换为 TEXT。

我错过了什么？

举个例子：

```
import sqlite3

con = sqlite3.connect('D:\\test.db' )
cur = con.cursor()

print "Before CAST"
cur.execute('SELECT Type FROM \"Internet Explorer History\" ')
row = cur.fetchone()

print row
print row[0]
print type(row[0])
print str(row[0])
print str(row[0]).encode('utf-8')

print "----------------"

print "After CAST"
cur.execute('SELECT CAST( Type as TEXT) FROM \"Internet Explorer History\" ')
row = cur.fetchone()

print row
print row[0]
print type(row[0])
print str(row[0])
print str(row[0]).encode('utf-8') 
```

这给出了以下输出：

```
Before CAST
(<read-write buffer ptr 0x0276A890, size 24 at 0x0276A870>,)
C a c h e  R e c o r d 
<type 'buffer'>
C a c h e  R e c o r d 
C a c h e  R e c o r d 
----------------
After CAST
(u'Cache Record',)
Cache Record
<type 'unicode'>
Cache Record
Cache Record 
```

注意：CAST 之前的“缓存记录”字母之间的空格是空值。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T19:13:13.593

尝试：

```
print str(row[0]).decode('utf-16le') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-14T15:27:34.903

如何将数据插入到您的`"Internet Explorer History"`表中？我敢打赌，它是作为二进制对象（例如 Python 类型缓冲区）插入的，所以 SQLite 将它作为 blob 而不是文本返回。

尝试插入正确的 unicode 对象，然后执行相同的查询并检查其输出。

# javascript - 如何获取之前方法附加的元素？

> ID：12625558
> 
> 赞同：0
> 
> 时间：2012-09-27T16:05:00.240
> 
> 标签：javascript, jquery

源示例是这样的

```
// block with caption
var caption_block = "<div class='caption-block'><h1>"+ options.title + "</h1><div class='pages'><a href='/' id='left_pg'></a><div id='counter'>"+ (i+1)+'/'+(elms+1)+"</div><a href='/' id='right_pg'></a></div></div>";

// put the elemnt with caption into the DOM
$('ul.slider').before(caption_block);

// by click in #counter TEST
$('a').bind('click',function(){

 $('#slider').find('#counter').text(" TEST ");

}); 
```

倒霉，但它什么都不做。

脚本找不到`div#counter`. 如何得到它？

html看起来像

```
<div id="slider"><ul class="slider" /></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:06:32.663

试试这个，

与以前

```
$('a').click(function(){

    $('#slider').prev('div').find('#counter').text(" TEST ");
}); 
```

或使用滑块的父级

```
$('a').click(function(){

     $('#slider').parent.find('#counter').text(" TEST ");
}); 
```

直接带id

```
$('a').click(function(){

    $('#counter').text(" TEST ");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:08:52.137

您使用它的方式`before`是将其`ul.slider`作为同级添加到包含`div#counter`. 您可以通过检查其共同父级来选择滑块：

```
$('a').click(function(){
  $('#slider').parent().find('#counter').text(" TEST ");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:08:59.310

写吧`$('#counter').text(" TEST ")`

我也认为你需要绑定你的链接标签，如下所示，

```
$('a', $('ul.slider')).click (function () {
    $('#counter').text(" TEST ")
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T16:11:04.133

首先，您通过类名引用滑块`.slider`，稍后您通过 id 引用它`#slider`。

其次，您没有 id 为 'a' 的锚点`#a`，您可能希望使用它`$('a')`来引用锚点元素。

第三，您的选择器正在寻找`#counter`滑块内部，它不是它的子级。它是在滑块之前插入的，而不是作为一个孩子。

请参阅此小提琴以获取一些工作代码[http://jsfiddle.net/DyexP/2/](http://jsfiddle.net/DyexP/2/)

```
<ul id="slider" class="slider">ul</ul>​

var i = 1;
var elms = 10;
var options = {};
options.title = "title";

// block with caption
var caption_block = "<div class='caption-block'><h1>"+ options.title + "</h1><div class='pages'><a href='/' id='left_pg'></a><div id='counter'>"+ (i+1)+'/'+(elms+1)+"</div><a href='#' id='right_pg'>click me</a></div></div>";

// put the elemnt with caption into the DOM
$('ul.slider').before(caption_block);

// by click in #counter TEST
$('a').click(function(){
     $('#slider').parent().find('#counter').text(" TEST ");
});​ 
```

# reporting - 如何在 oracle apex 中将表单视图中的报表行显示为只读

> ID：12625559
> 
> 赞同：2
> 
> 时间：2012-09-27T16:05:02.957
> 
> 标签：reporting, oracle-apex

我有一个 apex 报告，其中包含许多具有各种数据类型的行。现在用户想要详细查看每一行。为此，他们希望它在表单视图中。

但是表单视图必须有条件地只读（这样用户如果没有权限就不能更改任何内容）。

我发现，oracle 的交互式报告为“单行视图”生成了一个类似的视图（尽管它不是有条件可编辑的）。

换句话说，我想通过将列旋转到行来显示报表的行。

请帮我怎么做。

（创建一个新的表单视图，然后将每个元素设为只读是一种选择，但它有很多问题，不适合超过 50 个报表。）

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T07:52:35.597

我想说您唯一的选择是创建表单页面，尤其是在您想要编辑时。IR 没有内置那种功能，如果你想通过`apex_item`API 给它们，你仍然需要编写自定义流程。
在创建时创建报告+表单组合是最快的（选择新页面的表单，然后是带有报告的表单）。
现在您必须为您的 IR 选择查询，并将其用作表单查询的基础。
要使您的项目有条件地只读，您可以对项目使用只读条件。如果您使用 a `plsql function returning boolean`，您甚至可以通过`apex_util.public_check_authorization`(doc: [APEX_UTIL](http://docs.oracle.com/cd/E23903_01/doc/doc.41/e21676/apex_util.htm#CHDJHBFJ) )测试授权方案
除了这条路线非常烦人且耗时之外，我不知道它有这些“很多问题”。

* * *

现在，如果您的表单必须作为一个整体有条件地只读，而不仅仅是某些项目，您也可以通过其他方式解决它。
**对于两者，您都必须创建表单页面**：没有办法解决这个问题，并且是最快和最简单的。

1.  表单页面上的条件 javascript+条件处理：

    *   动态动作，页面加载时触发。执行javascript：

        ```
        $('input').prop('readonly', true); 
        ```

        这会将所有输入项设置为只读。

    *   例如，通过使用 CSS，您可以让您的用户清楚这一点

        ```
        input[readonly]{ background-color: grey; } 
        ```

    他们仍然可以导航和查看光标，但无法直接编辑。当然，javascript 是不够的。有人仍然可以通过使用诸如萤火虫之类的工具或即开发人员工具来更改值。要阻止这种情况，请更改您的动态操作（仅在用户没有权限时触发）和您的记录处理过程（仅在用户有权限时运行）的条件和/或授权检查。当用户没有权限并设法更改值并提交它们时，不会将任何内容发送到数据库。

2.  条件链接+表单页面：

    *   设置报告的默认链接列以显示报告详细信息视图。
    *   在您的报告上创建另一个链接列，它将链接到您的表单页面。
    *   将第二个链接栏的显示条件或授权设置为仅在用户被授权时显示。
    *   为了防止未经授权的用户访问该页面并操纵 url 以更改记录的值，您必须为该页面设置授权方案。或者过程，无论你真正喜欢什么。或者使用会话状态保护。（我猜是阅读安全性的好时机！）

# php - 如何使用这行代码在 PHP 中实现动态分页？

> ID：12625561
> 
> 赞同：1
> 
> 时间：2012-09-27T16:05:05.380
> 
> 标签：php, html, css, twitter-bootstrap, pagination

我想知道如何使这个列表从 1 到 1000 内联，也许使用滚动就可以了，并且根据我的输出 prev 和 1 不包括在内，我该如何解决这个问题？

![在此处输入图像描述](../Images/80c41728787c4d0c359ae658961b8bfe.png)

这是我使用的代码：

```
echo 
        '<div class="pagination">
            <ul>
                <li>Prev</li>';
        if(isset($_SESSION['paging'])){
            $pages=$_SESSION['paging'];
            echo 
                '<li>'.$pages.'</li>';
        }
        else{
            echo 
                '<li>'.$pages.'</li>';
            $_SESSION['paging']=$pages;
            $_SESSION['paging1']=$pages;
        }
?>
        <li>Next</li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T18:15:58.310

这是一种错误的方法……提供 1k 的分页链接是没有意义的！这是一种可怕的用户体验和不必要的 DOM 负载

我建议你像我在下面列出的方法一样：

假设您当前的活动页面是#11

```
<|- Start <- Previous - 9 - 10 - 11 - 12 - 13  - Next -> Last -|> 
```

# html - 带有 HTML 5 画布的纺车

> ID：12625564
> 
> 赞同：3
> 
> 时间：2012-09-27T16:05:10.607
> 
> 标签：html, canvas, html5-canvas, createjs

我试图让这 2 个 png 图像在我的画布上简单地旋转。图像比画布大，因为我只想在轮子旋转到画布时显示轮子的某些部分。我在画布上完美地得到了 png，它们是圆形的，与底部对齐并居中，因此它只显示轮子的那个部分。我在我的代码中使用 createjs 和 easl 和 tween。出于某种原因，当我旋转图像时，它会从某个随机注册点进行旋转。有没有办法让这个图像围绕它自己的中心旋转，它不在画布区域？

```
var CANVAS;
var STAGE;
var CTX;

var imageCount = 0;

var img1Obj = new Image();
var img2Obj = new Image();
var img3Obj = new Image();

var img1;
var img2;
var img3;

var box;

function init(){

    CANVAS  = document.getElementById("spinWheel");
    STAGE   = new createjs.Stage(CANVAS);
    CTX     = CANVAS.getContext('2d');  

    img1Obj.src = "img/iphone_wheel_outer.png";
    img2Obj.src = "img/iphone_wheel_middle.png";
    img3Obj.src = "img/iphone_wheel_inner.png";

    img1Obj.name = "img1";
    img2Obj.name = "img2";
    img3Obj.name = "img3";

    img1Obj.onload = loadImages;
    img2Obj.onload = loadImages;
    img3Obj.onload = loadImages;

    createjs.Ticker.setFPS(30);
    createjs.Ticker.addListener(STAGE);

}

function loadImages(e)
{
    if(e.target.name == 'img1'){img1 = new createjs.Bitmap(img1Obj); }
    if(e.target.name == 'img2'){img2 = new createjs.Bitmap(img2Obj); }
    if(e.target.name == 'img3'){img3 = new createjs.Bitmap(img3Obj); }

    imageCount++;

    /* Display graphics until all of them are loaded */

    if(imageCount == 3)
    {
        buildInterface();
    }
}

function buildInterface(){

    img1.x = -370;
    img2.x = -370;
    img3.x = -370;

    img1.y = 235;
    img2.y = 235;
    img3.y = 235;

    createjs.Tween.get(img1,{loop:true})
            .to({rotation : 360}, 2000);

    STAGE.addChild(img1, img2, img3, box);

}

$(document).ready(function() {
    init();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:08:51.747

我终于弄明白了。

这里告诉我旋转上下文的答案没有错，如果我使用 createjs.Bitmap 在画布中生成图像，它只是不起作用。但是，使用 createjs 库实际上要简单得多。我所要做的就是：

```
img1.regX   = img1.image.width/2|0;
img1.regY   = img1.image.height/2|0; 
```

这实际上直接针对位图的注册点，我无需操作上下文，因为 createjs.Bitmap 对象在内部为我处理了这个问题。

无论如何感谢您的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:21:42.523

要在画布上旋转，您必须执行以下操作：

```
context.translate(cx, cy);
context.rotate   (radians); 
```

但我不确定它是否适用于 createjs.Bitmap 对象，必须尝试一下。平移将设置点旋转。

也许尝试：

```
img1.translate((.5*img1.width),(.5*img1.height)); 
```

img1.height 必须为此工作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-27T17:50:19.213

我没有看到上面的 css，但问题可能是 transform-origin 属性

阅读更多链接：[http ://www.w3schools.com/cssref/css3_pr_transform-origin.asp](http://www.w3schools.com/cssref/css3_pr_transform-origin.asp)

```
div
{
transform: rotate(45deg);
transform-origin:20% 40%;
-ms-transform: rotate(45deg); /* IE 9 */
-ms-transform-origin:20% 40%; /* IE 9 */
-webkit-transform: rotate(45deg); /* Safari and Chrome */
-webkit-transform-origin:20% 40%; /* Safari and Chrome */
-moz-transform: rotate(45deg); /* Firefox */
-moz-transform-origin:20% 40%; /* Firefox */
-o-transform: rotate(45deg); /* Opera */
-o-transform-origin:20% 40%; /* Opera */
} 
```

# python - 模板中的GAE“每个”？

> ID：12625571
> 
> 赞同：2
> 
> 时间：2012-09-27T16:05:18.900
> 
> 标签：python, django, google-app-engine, django-templates

我`for each`在 GAE 的模板中使用（它使用 Django 的模板语言）

```
{% for blog_info in blog_archive %}                         
  {{ blog_info.time|date:"M Y" }}
{% endfor %} 
```

但我只想循环一次，我尝试这样做：

```
{% for blog_info in blog_archive %}     
  {{ blog_info.time|date:"M Y" }}
  {% break %}
{% endfor %} 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:22:11.223

`{% for %}`模板标签不`{% break %}`支持. `var`在模板中，您可以使用访问列表的第一项`{{ var.0 }}`。

在您的情况下，请尝试：

```
{{ blog_archive.0.time|date:"M Y" }} 
```

# android - 带有自定义子项的 Android 自定义容器

> ID：12625574
> 
> 赞同：0
> 
> 时间：2012-09-27T16:05:32.947
> 
> 标签：android

> **可能重复：**
> [Android 自定义 LayoutContainer](https://stackoverflow.com/questions/12623289/android-custom-layoutcontainer)

我正在设计一个扩展线性布局的自定义布局。此布局的子级也将是自定义线性布局。有人可以告诉我如何做到这一点吗？我也定义了父容器的所有布局。我的线性父级定义了所有三个构造函数，因为我想通过 xml 添加自定义参数。我如何为子内容充气？这些会自动膨胀吗？有人可以给我看一些代码让我开始吗？我是 Android 新手，真的很困惑从哪里开始。

亲切的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:10:58.103

孩子们会自动充气。如果您想在孩子膨胀后做一些进一步的初始化，您可以`onFinishInflate`在您的容器中覆盖。

至于使用自定义属性，这在培训主题[创建视图类](http://developer.android.com/training/custom-views/create-view.html)中进行了描述。

# regex - DB2 选择中的 RegEx

> ID：12625576
> 
> 赞同：1
> 
> 时间：2012-09-27T16:05:45.497
> 
> 标签：regex, select, db2

我有一个表，其中一列具有以下格式的大型 json 对象。列数据类型是 VARCHAR

```
column1
--------
{"key":"value",....} 
```

我对列数据的第一个值感兴趣

在正则表达式中，我可以通过`.*?:(.*),.*`group(1) 给我价值

我如何在选择查询中使用它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T12:09:41.237

不要那样做，这是糟糕的数据库设计。将键和值作为列分解到它们自己的表中，或使用 XML 数据类型。XML 可以正常工作，因为您可以很好地索引结构，并且可以对数据使用 XPATH 查询。XPATH 原生支持正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-28T12:23:10.480

您可以在 xQuery 中使用正则表达式，您只需要从 SQL 查询或 FLORW 查询中调用函数匹配项。

这是一个如何在 SQL 中使用正则表达式的示例：

```
db2 "with val as (
 select t.text
 from texts t
 where xmlcast(xmlquery('fn:matches(\$TEXT,''^[A-Za-z 0-9]*$'')') as integer) = 0
)
select * from val" 
```

了解更多信息：

*   [http://pic.dhe.ibm.com/infocenter/db2luw/v10r5/topic/com.ibm.db2.luw.xml.doc/doc/xqrfnmat.html](http://pic.dhe.ibm.com/infocenter/db2luw/v10r5/topic/com.ibm.db2.luw.xml.doc/doc/xqrfnmat.html)
*   [http://angocadb2.blogspot.fr/2014/04/regular-expressions-in-db2.html](http://angocadb2.blogspot.fr/2014/04/regular-expressions-in-db2.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T08:06:27.047

不幸的是，DB2 没有任何内置的正则表达式功能。我确实找到了一篇关于如何使用库添加它的文章：

[http://www.ibm.com/developerworks/data/library/techarticle/0301stolze/0301stolze.html](http://www.ibm.com/developerworks/data/library/techarticle/0301stolze/0301stolze.html)

如果没有正则表达式，此操作将一团糟。您*可以*创建一个函数，逐个字符地遍历字符串以查找第一个值。或者，如果您需要做的不仅仅是这个操作，您*可以*创建一个解析 json 并将其放入键/值表的过程。不过，这两个听起来都不好玩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-17T13:32:25.000

在 DB2 for z/OS 中，您必须使用 PASSING 选项将变量传递给 XMLQUERY

```
db2 "with val as (
 select t.text
 from texts t
 where xmlcast(xmlquery('fn:matches($TEXT,''^[A-Za-z 0-9]*$'')'
               PASSING t.text as "TEXT") as integer) = 0
)
select * from val" 
```

# css - 将 div 移动到另一个位置，但前提是它包含在另一个 div 中？

> ID：12625577
> 
> 赞同：0
> 
> 时间：2012-09-27T16:05:58.167
> 
> 标签：css, positioning

我有一个这样的div：

```
<div class="someclass">
    ....
</div> 
```

如果任何父 div 具有 XYZ 类，我怎么能说只应该移动 div？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:07:56.573

根据其父/祖先选择元素：

```
/* the 'default' */
.someclass {
    position: relative;
}

/* the someclass element that has an ancestor of class 'ancestorClass' */
.ancestorClass .someclass {
    position: absolute;
    top: 0;
    right: 0;
} 
```

在没有关于“移动”的明确（或任何）信息的情况下，在上下文中，我假设您正在使用`position`以某种方式重新定位元素。如果您采用另一种方法，则只需修改 CSS 规则以反映您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:09:04.503

你的意思是这样的？

```
.XYZ > .someclass  /* use this if the .someclass is next child class of the .XYZ */
{
   position:absolute; /* relative or fixed */  
} 
```

或者像大卫托马斯一样简单地使用

```
.XYZ .someclass   /* use this if the .someclass is a child class or inside to .XYZ  */
{
  position:absolute; /* relative or fixed */  
} 
```

# mobile - 在移动 Safari 中强制使用非异步 XMLHttpRequest

> ID：12625578
> 
> 赞同：0
> 
> 时间：2012-09-27T16:05:59.140
> 
> 标签：mobile, safari, xmlhttprequest

我在网页上设置了以下代码（此时为私有）：

```
function DoRequest(httpReq,url,param){

  httpReq.open("POST",url,false);
  httpReq.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
  httpReq.send(param);
  httpReq.onreadystatechange = function() {
   if (httpReq.readyState==4) {alert(httpReq.responseText);}
  }

  if(httpReq.status==200){
    return httpReq.responseText;
  } else {
    return httpReq.status;
 }
} 
```

当我通过它运行请求时，通过 pc 上的 firefox、safari，即 7-9、chrome 等，我得到 200 状态和正确返回的文本。

当我在我的 iphone 或 ipad 上运行相同的页面时，我的状态为 0，响应文本为空，以及来自正确响应文本后缀的回调函数的警报。在继续执行移动 safari 浏览器的代码之前，它似乎没有等待请​​求完成，是否有更好的强制它等待，或者我看不见的标志？

我也只在 safari 上获得了 onreadystate 回调，它在任何其他浏览器中都没有，我尝试删除该函数，以防它以某种方式触发它运行异步而不是没有但没有骰子它仍然运行异步尽管第三个参数为假。

我也只是尝试`httpRq.open("POST",url);`不使用第三个参数并且不使用 onreadystatechange 函数并且仍然运行异步。

url 是绝对路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:17:04.563

Mobile Safari 不支持同步使用 XMLHttpRequest（在您的代码中打开的第三个参数为 false，这是不受支持的）。

任何依赖于请求结果的东西都应该被移到回调函数中，并在你的 onreadystatechange 函数中调用，就在你有 alert() 调用的地方。

# android - 需要制作一张桌子：哪个更适合表演？

> ID：12625580
> 
> 赞同：0
> 
> 时间：2012-09-27T16:06:14.423
> 
> 标签：android, android-layout

在我的应用程序中，我从网上下载了一些需要以表格方式排列的数据。我已经知道维度：大约 26 行和 6 列，无论如何数据可以在后续调用中更改，因此我必须以动态方式创建此表。

因为它是一张我虽然使用 TableLayout（以前从未使用过）的表格，但另一方面，我可以简单地使用列表视图，对单个项目使用具有水平方向的 6 个元素的线性布局。

ListView 让我很感兴趣，因为它是一个适配器视图（我想我稍后会将这些数据存储在 sqllite db 中）所以填充它非常简单明了，反正我不知道它是否最适合我的问题。

你的意见是什么？TableLayout、ListView 还是其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:39:59.217

在性能方面，我认为您应该使用`ListView`，因为`ListView`支持视图回收，您可以查看[this](http://www.google.com/events/io/2009/sessions/TurboChargeUiAndroidFast.html)和[this](https://stackoverflow.com/questions/3817628/recycling-views-in-a-listview-worth-it) post以获取有关视图回收的更多详细信息。

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:12:59.073

ListView 是一组布局，这些布局自动显示在另一个之下。开发者通过 Activity 中的一段代码添加新项目。一个例子是地址簿，你有很多联系人一个接一个。

另一方面，TableView 是在布局文件中定义的，不仅需要包含彼此下方或上方的元素，还可以将元素排列在左侧或右侧。TableView 正是它所说的：一个有行和列的表。

这是一个[类似的问题](https://stackoverflow.com/questions/1709166/android-listview-elements-with-multiple-clickable-buttons)，可能会回答您想知道的问题

# javascript - 与淘汰赛绑定

> ID：12625585
> 
> 赞同：1
> 
> 时间：2012-09-27T16:06:39.007
> 
> 标签：javascript, knockout.js

所以我有这个问题，数据没有显示在表格中。

我的视图模型：

```
var my = {};
my.viewModel = {
    Person: ko.observableArray([
        { name: "Alireza", family: "Davoodi", city: "Tehran", date: new Date().getTime() },
        { name: "Alireza", family: "Davoodi", city: "Tehran", date: new Date().getTime() },
        { name: "Alireza", family: "Davoodi", city: "Tehran", date: new Date().getTime() },
        { name: "Alireza", family: "Davoodi", city: "Tehran", date: new Date().getTime() },
        { name: "Alireza", family: "Davoodi", city: "Tehran", date: new Date().getTime() },
    ])
};

ko.applyBindings(my.viewModel); 
```

看法：

```
<tbody data-bind="foreach: Person" >
    <tr>
        <td data-bibd="text: name"></td>
        <td data-bibd="text: family"></td>
        <td data-bibd="text: city"></td>
        <td data-bibd="text: date"></td>
    </tr>
</tbody> 
```

数据未列于表中；我哪里错了？

我得到的输出是：`[object,object]`

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T16:23:00.777

你有一个错字：`data-bibd`应该是`data-bind`. 其余的[似乎](http://jsfiddle.net/PajjL/)都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:49:51.937

当然有spinningarrow指的错字。您的 JSON 格式也有一个小问题（最后一行中的逗号）。

另外，我相信更好的实现（保留面向对象的淘汰方法）是这样的：

```
var my = {};
my.viewModel = function () {
    this.Person = ko.observableArray([{
        name: "Alireza",
        family: "Davoodi",
        city: "Tehran",
        date: new Date().getTime()
    }, {
        name: "Alireza",
        family: "Davoodi",
        city: "Tehran",
        date: new Date().getTime()
    }, {
        name: "Alireza",
        family: "Davoodi",
        city: "Tehran",
        date: new Date().getTime()
    }, {
        name: "Alireza",
        family: "Davoodi",
        city: "Tehran",
        date: new Date().getTime()
    }, {
        name: "Alireza",
        family: "Davoodi",
        city: "Tehran",
        date: new Date().getTime()
    } ]);
};

ko.applyBindings(new my.viewModel()); 
```

你可以在这里看到它[在 JSFiddle 中工作。](http://jsfiddle.net/spitoglou/YxBqq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-28T08:58:19.060

```
 Person: ko.observableArray([
        { name: ko.observable("Alireza"), family: ko.observable("Davoodi"), city:ko.observable("Tehran"), date:ko.observable(new Date().getTime()) },   ]) 
```

所有 json 值都放在 ko.observable 上。

# c# - 如何序列化字典 到 javascript？

> ID：12625588
> 
> 赞同：0
> 
> 时间：2012-09-27T16:06:51.443
> 
> 标签：c#, json, serialization, dictionary

这是我的代码：

```
public class PuntoMappa
{
    string Lat;
    string Lng;

    public PuntoMappa(string Lat, string Lng)
    {
        this.Lat = Lat;
        this.Lng = Lng;
    }
}   

PuntiCategoriaMappa.Add("1111", new PuntoMappa("1", "2"));
PuntiCategoriaMappa.Add("2222", new PuntoMappa("3", "4"));
PuntiCategoriaMappa.Add("3333", new PuntoMappa("5", "6"));

var jsonSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "PuntiCategoriaMappa", "PuntiCategoriaMappa = " + jsonSerializer.Serialize(PuntiCategoriaMappa) + ";", true); 
```

但序列化是：

```
PuntiCategoriaMappa = {"1111":{},"2222":{},"3333":{}}; 
```

好吧，我丢失了`PuntoMappa`对象的序列化。

我怎样才能正确地做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:09:30.247

您必须公开 Lat 和 Lng。

```
public class PuntoMappa
{
    public string Lat { get; private set; }
    public string Lng { get; private set; }

    public PuntoMappa(string Lat, string Lng)
    {
        this.Lat = Lat;
        this.Lng = Lng;
    }
} 
```

# binding - 无法在 IIS 网站上创建 nettcp 端口绑定

> ID：12625590
> 
> 赞同：0
> 
> 时间：2012-09-27T16:06:57.557
> 
> 标签：binding, iis-7, activation, net.tcp

我一直试图在 IIS 默认网站上为端口 9999 创建一个 nettcp 端口绑定；但是总是从 net.tcp 监听器得到以下错误；

> 解析站点 '1' 的 net.tcp 绑定 '9999: *' 时出错，因此该站点的协议暂时被禁用。有关更多详细信息，请参阅异常消息。绑定：net.tcp:9999：* 来源：System.ServiceModel.Activation.ListenerAdapter/12547953 异常：System.UriFormatException：协议绑定“9999：*”对“net.tcp”无效。这可能是因为端口号超出范围。在 System.ServiceModel.Channels.BaseUriWithWildcard..ctor（字符串协议，Int32 defaultPort，字符串绑定，Int32 段计数，字符串路径，字符串 sampleBinding）在 System.ServiceModel.Channels.BaseUriWithWildcard.CreateHostedUri（字符串协议，字符串绑定，字符串路径）在 System.ServiceModel.Activation.ListenerAdapter.RegisterBindings(IActivatedMessageQueue queue, Int32 siteId, String[] bindings, String path) 进程名称：SMSvcHost 进程 ID：1120

有人对可能是什么问题有任何想法吗？或者我们如何能够进一步调查这个问题的方法？我检查了防火墙设置，似乎没有专门阻止该端口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T03:40:22.353

验证计算机上是否安装了非 HTTP 激活功能。 ![WCF 激活 - Windows 功能](../Images/84a8df62bb98d428185223835c0e93f6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T11:42:36.147

结果我的*Net.TCP 监听适配器服务*由于某种原因停止运行；开启此功能可解决问题。下面给出的步骤；

1.  在服务器上；从管理工具打开服务
2.  验证 Net.Pipe 侦听器适配器或 Net.Tcp 侦听器适配器服务是否正在运行。如果没有，请右键单击该服务，然后单击“开始”。

Saurabh Chowdhury 的上述回答也是常见的故障排除步骤；但是，这不是我的问题。

此[链接](https://rohitguptablog.wordpress.com/2011/06/16/configuring-wcf-service-with-nettcpbinding/)还很好地概述了需要注意的其他一些要点。

# sql - SSIS-新专栏

> ID：12625592
> 
> 赞同：0
> 
> 时间：2012-09-27T16:07:04.590
> 
> 标签：sql, sql-server, sql-server-2008, ssis

我有一个包含 4 列的文本文件，我必须从中创建 9 列。

例子

输入

```
id,
no,
product, 
quantity 
```

派生列

```
id, 
no,
product, 
quantity,
id_out,
no_out,
product_out, 
quantity_out,
Type 
```

在这里，我将所有四个 Out 行作为输入，但 Type 与 Input 无关。稍后将由参考文本文件填充。那么你能告诉我如何添加新列吗？

欣赏你的努力。

谢谢你，

343

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:44:35.830

我通过使用 Null 运算符得到...感谢您的努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:11:59.007

如果您只想要结构，您可以选择 NULL 值

```
 SELECT id, 
           no,
           product, 
           quantity,
           NULL as [id_out],
           NULL as [no_out],
           NULL as [product_out], 
           NULL as [quantity_out],
           NULL as [Type] 
```

# javascript - 在页面上加载后使用图像

> ID：12625593
> 
> 赞同：0
> 
> 时间：2012-09-27T16:07:12.597
> 
> 标签：javascript, jquery, html

我已将 Facebook 上的远程图像加载到我的网页上。我想找到它的缓存位置，这样我就可以获得它的 src 路径，这样我就可以在我的画布上使用它。我遇到的问题是，当我尝试设置 Facebook src 路径时，它给了我跨源错误，因为它不是本地文件。这是 HTML5 本地存储可以解决的问题吗？

最后，我希望有一个加载图像的路径，不涉及我将它们保存到我的服务器并再次将它们拉下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:09:11.743

您可以通过在 jquery 上添加图像来做到这一点，`.load()`因为当整个页面完全加载时，窗口加载事件会稍后执行，

# c# - 如何使用异步方法更正写入测试？

> ID：12625595
> 
> 赞同：2
> 
> 时间：2012-09-27T16:07:20.087
> 
> 标签：c#, nunit, .net-4.5, async-await

我有迭代图像的课程。

```
public class PictureManager
    {
        private int _current;
        public List<BitmapImage> _images = new List<BitmapImage>(5);
        public static string ImagePath = "dataImages";

        public async void LoadImages()
        {
            _images = await GetImagesAsync();
        }
        public async Task<List<BitmapImage>> GetImagesAsync()
        {
            var files = new List<BitmapImage>();
            StorageFolder picturesFolder = await KnownFolders.PicturesLibrary.GetFolderAsync("dataImages");
            IReadOnlyList<IStorageItem> itemsList = await picturesFolder.GetItemsAsync();
            foreach(var item in itemsList)
            {
                if(!(item is StorageFile)) continue;
                var tempImage = new BitmapImage(new Uri(item.Path));
                Debug.WriteLine(string.Format("add {0}", item.Path));
                files.Add(tempImage);
            }
            return files;

        }
} 
```

我写了这个测试方法（我使用 nUnit）：

```
 [TestFixture]
    public class PictureManagerTest
    {
        private PictureManager _pic;

        [SetUp]
        public void Init()
        {
            _pic = new PictureManager();
            _pic.LoadImages();

        }

        [Test]
        public void ElementOfImagesIsNotNull()
        {
            _pic.GetImagesAsync().ContinueWith(r =>
            {
                BitmapImage image = r.Result[0];
                image = null;
                Assert.IsNotNull(image);
            });
        }
} 
```

为什么这个测试成功？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:23:13.890

到目前为止，nUnit 不直接支持异步测试（但是，MSTest 和 xUnit 支持）。

您可以通过等待结果来解决此问题，如下所示：

```
 [Test]
    public void ElementOfImagesIsNotNull()
    {
        var continuation = _pic.GetImagesAsync().ContinueWith(r =>
        {
            BitmapImage image = r.Result[0];
            image = null;
            Assert.IsNotNull(image);
        });

        // Block until everything finishes, so the test runner sees this correctly!
        continuation.Wait();
    } 
```

当然，第二种选择是使用类似 MSTest 的东西，它确实支持测试异步代码，即：

```
 [TestMethod]
    public async Task ElementOfImagesIsNotNull()
    {
        var images = await _pic.GetImagesAsync();

        BitmapImage image = r.Result[0];
        image = null;
        Assert.IsNotNull(image);
    } 
```

# java - 使用泛型返回动态 JAXBElement

> ID：12625596
> 
> 赞同：3
> 
> 时间：2012-09-27T16:07:27.720
> 
> 标签：java, generics, jaxb

我有多个根元素，因此，我需要写

```
JAXBElement<BookType> jaxbBookType = objectFactory.createBookType (bookType);
JAXBElement<OrderType> jaxbOrderType = objectFactory.createOrderType (orderType); 
```

等等。我不想一次又一次地编写这段代码。我正在尝试编写一个方法，该方法将根据其输入返回 JAXBElement。

我想写的是

```
public <T> JAXBElement<T> getJaxbElement (Object obj){
    if (obj instanceof OrderType){
        return objectFactory.createOrderType((OrderType)obj);
    }
} 
```

但很明显，我做错了。由于我对泛型了解不多，并且在阅读了一段时间后，我仍然感到困惑。有人可以在这里帮我一点忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:39:31.350

如果您可以假设将`instanceof`运算符与参数一起使用，则只需转换为`JAXBElement<T>`就足够了：

```
public <T> JAXBElement<T> getJaxbElement (Object obj){
    Object ret;
    if (obj instanceof OrderType){
        ret = objectFactory.createOrderType((OrderType)obj);
    }
    else if (obj instanceof BookType){
        ret = objectFactory.createBookType((BookType)obj);
    }
    return (JAXBElement<T>) ret;
} 
```

如果你不能，作为方法名称，这里必须是动态的，一种可能性是使用反射（*总是不可靠并且可能适得其反*）。

请注意，您还必须传递`Class`of`T`以便它在运行时可用（不可能这样做`T.getName()`）：

```
public <T> JAXBElement<T> getJaxbElement (Object obj, Class<T> clazz){
    ObjectFactory objectFactory = getObjectFactory();
    String methodName = "create" +  clazz.getName();
    Method m = objectFactory.getClass().getDeclaredMethod(methodName, clazz);
    Object ret = m.invoke(objectFactory, obj);
    return (JAXBElement<T>) ret;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T17:39:39.327

```
public <T> JAXBElement<T> getJaxbElement (Object obj){
    if (obj instanceof OrderType){
        return (JAXBElement<T>)objectFactory.createOrderType((OrderType)obj);
    }
} 
```

或者可能使 T obj 的类型

```
public <T> JAXBElement<T> getJaxbElement (T obj){
    if (obj instanceof OrderType){
        return (JAXBElement<T>)objectFactory.createOrderType((OrderType)obj);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-26T10:38:17.967

**[JAXBElement](https://docs.oracle.com/javase/7/docs/api/javax/xml/bind/JAXBElement.html)**泛型的另一种选择

```
public class Example<T> {

    public JAXBElement<T> toDo(final T genericType, Class<T> operationClass) {
        final JAXBElement<T> jaxbElement = 
            new JAXBElement<T>(new QName(operationClass.getClass().getSimpleName()), operationClass, genericType);

        return jaxbElement;
    }        
} 
```

问候！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-21T03:17:24.217

简单的方法，我在下面做了：

```
public static <T> JAXBElement<T> createJaxbElement(T object, Class<T> clazz) {
    return new JAXBElement<>(new QName(clazz.getSimpleName()), clazz, object);
} 
```

# javascript - Rails 3 - 取决于单选按钮选择的复选框

> ID：12625613
> 
> 赞同：0
> 
> 时间：2012-09-27T16:08:25.940
> 
> 标签：javascript, jquery, html, ruby-on-rails-3, user-experience

我需要一个解决方案来隐藏/显示取决于单选按钮选择的复选框。我尝试了在这里和那里找到的不同解决方案，但我可以让它们工作。

背景：我有一个可以与企业相关联的联系人池。用户可以选择多个联系人，但必须选择一个主要联系人。所以我有一个单选按钮组，所有联系人选择主要联系人，我有一个复选框组，所有联系人再次选择“其他”联系人。

需要：现在，我喜欢做的是，当用户在单选按钮组中选择主要联系人时，该联系人将从“其他联系人”复选框组中删除，因此用户不能两次选择同一个联系人。我可以使用 JQuery 以及纯 JavaScript。

约束：单选按钮组和复选框组是使用 Rails Tag 助手动态创建的。所以元素的 id 和名称有点棘手。此外，在业务和联系人之间有一个 has_many :trough。

所以对于单选按钮，我有：

```
<% @contacts.each do |contact| %>
<li><%= radio_button_tag 'primary_contact', contact.id, @primary_contact == contact, :class => 'radio'%>&nbsp;&nbsp;<%= contact.name %>,&nbsp;<%= contact.contact_type.name %></li>
<% end %> 
```

对于复选框组，我有：

```
<%= hidden_field_tag 'business[contact_ids][]', "" %>
<% @contacts.each do |contact| %>
<li><%= check_box_tag 'business[contact_ids][]', contact.id, @business.contacts.include?(contact), :class => 'radio' %>&nbsp;&nbsp;<%= contact.name %>,&nbsp;<%= contact.contact_type.name %></li>
<% end %> 
```

非常欢迎任何关于其他设计（使用单选按钮和复选框......）以实现我的目标的建议。

谢谢阿兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:27:36.883

```
<li><%= radio_button_tag ... :id => "#{contact.id}", :onclick => 'removeFromOtherList(this.id);' %><%= "  #{contact.name}, #{contact.contact_type.name}" %></li> 
```

这样，您就有了 HTML 标记 ID 的联系人 ID。Onclick 它将删除\禁用其他联系人

对其他联系人执行相同操作

```
...<%= check_box_tag ... :class => 'radio', :id => "otherContact#{contact.id}" %> ... 
```

然后我们可以从另一个列表中删除正确的联系人

```
function removeFromOtherList(contactId) {
   $("#otherContact"+contactId).parent().remove(); //to remove the LI
} 
```

[演示](http://jsfiddle.net/D4WsM/)

**编辑：**

一种方法是使用显示/隐藏并跟踪最后选择的收音机

```
var lastSelectedRadioId = null;
function removeFromOtherList(contactId) {
  $("#otherContact"+contactId).parent().hide();
  if(lastSelectedRadioId ){
     $("#otherContact"+lastSelectedRadioId ).parent().show();       
  }
  lastSelectedRadioId = contactId;
} 
```

[演示](http://jsfiddle.net/D4WsM/1/)

# jenkins - Jenkins 无法使用 SVN 凭据或下载新插件/新版本

> ID：12625614
> 
> 赞同：6
> 
> 时间：2012-09-27T16:08:27.090
> 
> 标签：jenkins

**谁能建议如何解决这两个问题？**

**- 无法升级 Jenkins 和 SVN 插件**

**- 无法连接到 svn**

我正在 Windows 64 位机器上设置 Jenkins。它被配置为作为 Windows 服务运行。

我们在 Windows 7 64 位操作系统上运行它

詹金斯 1.482

我可以从机器上的用户帐户进行 SVN 更新/结帐。

当我尝试在 jenkins 上设置工作时，我在尝试添加 svn 凭据时得到以下信息

```
FAILED: org.tmatesoft.svn.core.SVNErrorMessage: svn: OPTIONS /svn/client/trunk failed 
```

更多细节是：

```
FAILED: org.tmatesoft.svn.core.SVNErrorMessage: svn: OPTIONS /svn/client/trunk failed

org.tmatesoft.svn.core.SVNException: svn: OPTIONS /svn/client/trunk failed
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:298)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:283)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:271)
    at ... 
```

我停止了服务并从命令行运行 Jenkins 并尝试了同样的事情 - 结果相同。

我可以使用 Tortoise 客户端并通过具有相同凭据的 Firefox 连接到 svn 服务器。

在研究这个问题时，我看到了一些关于类似问题的帖子，唯一一个似乎声称可以解决它的帖子是回滚到 Jenkins svn 插件版本。

然后我尝试为 svn 安装最新的 jenkins 和插件。下载失败。啊哈，我想——显然是防火墙问题。所以我禁用了防火墙。

还是不行。我无法自动下载或获取新的 Jenkins 或 SVN 插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T21:10:24.293

尝试使用此选项启动 jenkins：

```
-Dsvnkit.http.sslProtocols="SSLv3" 
```

或者，如果 Jenkins 在单独的 JVM 中启动 svn 插件，请尝试将该行添加到 svn 插件运行配置所在的位置。

这是 svnkit 的一个已知问题，它被 Jenkins 的 svn 插件使用：

[http://issues.tmatesoft.com/issue/SVNKIT-176](http://issues.tmatesoft.com/issue/SVNKIT-176)

此外，[这个](https://stackoverflow.com/a/9247915/760757 "这个")答案对于升级您的 svn 插件可能会有所帮助。

要更改您的 Windows 服务命令行：

1.  打开命令行窗口**cmd.exe**
2.  `sc qc "JenkinsSlave"`（如果那是您的服务名称）
3.  选择并复制 BINARY_PATH_NAME 值
4.  更改它，`-Dsvnkit.http.sslProtocols=""SSLv3""`在 jar 路径之后添加 - 注意双引号
5.  `sc config "JenkinsSlave" binPath= <paste the changed value copied earlier>`

将**JenkinsSlave**替换为您的服务名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T20:01:39.247

Windows 7 x64 有一些自动防火墙设置。您可能需要打开防火墙端口以允许连接。

您应该能够通过尝试在 Jenkins 之外运行您的 svn 客户端来验证或消除此原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-17T13:31:35.197

有点晚的话题，但是您是否尝试过以下解决方案？

[http://www.daangemist.nl/2014/03/03/jenkins-reports-sslv3-error-on-svn-update](http://www.daangemist.nl/2014/03/03/jenkins-reports-sslv3-error-on-svn-update)

那个对我有用，就我而言，我想使用 -Dsvnkit.http.sslProtocols="TLSv1"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-05T08:27:05.593

使用您的帐户运行 Jenkins 服务怎么样？

# php - PHP 电子邮件附件 - 画布图像空白

> ID：12625617
> 
> 赞同：4
> 
> 时间：2012-09-27T16:08:36.793
> 
> 标签：php, ajax, email, canvas

更新：我收到的图像是空白图像，是我画布的大小。它不是画布上的图像。我能够将新的画布 PNG 插入 DOM，所以我知道图像数据是好的。

进一步：我可以在图像数据发送到 PHP 表单之前复制图像数据，将该代码粘贴到另一个页面上的标记中，因为它的 src 和正确的图像显示！这么近！

我的用户在 HTML5 画布上创建了一个图像。我需要将图像作为电子邮件附件发送给用户。我可以使用 jquery AJAX 捕获图像并将其发布到 PHP 页面。

是的，我已经阅读了十几个其他相关的帖子，这就是我达到这一点的原因。不 - 他们都没有回答我的问题 - 这部分总是被跳过。否 - 我不想使用 PHPMailer（可怕的文档）或任何其他类。这可以使用 PHP mail() 来实现。我很接近。

这是我的网络应用程序中的 javascript：

```
var data = "to=" + to + "&subject=" + subject;          
var canvas2 = document.getElementById("canvas");
var strDataURI = canvas2.toDataURL(); 
data = data + "&attachment="  + strDataURI;

$.ajax({
    type: "POST",
    url: "mail2.php",
    data: data,
    success: function(){

        $("#loading").fadeOut(100).hide();
        $('#message-sent').fadeIn(500).show();               
   }
}); 
```

发布此数据：

```
 "to=erik@mydomain.com&subject=test&attachment=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3gAAAHBCAYAAAA7NBnaAAA..." 
```

到这个 PHP 页面（更新，更简单）：

```
<?PHP    
$to =   $_REQUEST['to'];
$subject =  'PHP Mail Attachment Test';
$bound_text =   "jimmyP123";
$bound =    "--".$bound_text."\r\n";
$bound_last =   "--".$bound_text."--\r\n";

$attachment = $_REQUEST['attachment'];
$attachment =  substr($attachment,strpos($attachment,",")+1);
$attachment = chunk_split($attachment);

$headers =  "From: admin@server.com\r\n";
$headers .=     "MIME-Version: 1.0\r\n"
."Content-Type: multipart/mixed; boundary=\"$bound_text\"";

$message .=     "If you can see this MIME than your client doesn't accept MIME types!\r\n"
.$bound;

$message .=     "Content-Type: text/html; charset=\"iso-8859-1\"\r\n"
."Content-Transfer-Encoding: 7bit\r\n\r\n"
."hey my <b>good</b> friend here is a picture of regal beagle\r\n"
.$bound;

//$file =   file_get_contents("http://www.litfuel.net/php/regal_004.jpg");

$message .=     "Content-Type: image/png; name=\"index.png\"\r\n"
."Content-Transfer-Encoding: base64\r\n"
."Content-disposition: attachment; file=\"index.png\"\r\n"
."\r\n"
.$attachment
//.chunk_split(base64_encode($file))
.$bound_last;

if(mail($to, $subject, $message, $headers))
{
     echo 'MAIL SENT';
} else {
     echo 'MAIL FAILED';
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T06:56:54.430

我注意到您使用的是heredoc。这可能会导致这里出现问题。

电子邮件中的行尾必须是`\r\n`(CRLF)，所以我建议改用字符串连接重写它，然后它应该可以工作。

另外，请确保您申请`chunk_split()`以`$attachment`保持行长 <= 76。

# python - Python3 将 Unicode 字符串转换为 int 表示

> ID：12625627
> 
> 赞同：13
> 
> 时间：2012-09-27T16:09:04.407
> 
> 标签：python, string, unicode, python-3.x, int

众所周知，计算机处理数字。我现在正在输入此文本，服务器从中生成一个数字，当您想阅读它时，您将从服务器获取文本。

我怎么能自己做到这一点？

我想用我自己的算法加密一些东西，我的算法适用于整数，但现在我想加密一个字符串，我不知道如何将 Unicode 字符串转换为整数，反之亦然。

我正在使用 Python 3。有没有人知道我的问题的优雅解决方案？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-27T16:12:23.917

您正在寻找[`ord()`功能](http://docs.python.org/py3k/library/functions.html#ord)，我认为：

```
>>> ord('a')
97
>>> ord('\u00c2')
192 
```

这为您提供了 Unicode 代码点的整数。

要转换一整套字符，请使用列表推导：

```
>>> [ord(c) for c in 'Hello World!']
[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33] 
```

它的反[`chr()`函数](http://docs.python.org/py3k/library/functions.html#chr)是：

```
>>> chr(97)
'a'
>>> chr(193)
'Á' 
```

请注意，当您加密结束解密文本时，您*通常*将文本编码为具有[*字符编码*](https://en.wikipedia.org/wiki/Character_encoding)的二进制表示。Unicode 文本可以用不同的编码进行编码，具有不同的优点和缺点。如今，Unicode 文本最常用的编码是[UTF-8](https://en.wikipedia.org/wiki/UTF-8)，但也有其他的。

在 Python 3 中，二进制数据在[`bytes`object](https://docs.python.org/3/library/stdtypes.html#bytes)中表示，您可以使用该方法将文本编码为字节，然后使用以下[`str.encode()`方法](https://docs.python.org/3/library/stdtypes.html#str.encode)返回[`bytes.decode()`](https://docs.python.org/3/library/stdtypes.html#bytes.decode)：

```
>>> 'Hello World!'.encode('utf8')
b'Hello World!'
>>> b'Hello World!'.decode('utf8')
'Hello World!' 
```

`bytes`值实际上只是序列，如列表、元组和字符串，但由 0-255 的整数组成：

```
>>> list('Hello World!'.encode('utf8'))
[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33] 
```

就个人而言，在加密时，您希望对生成的字节进行编码和加密。

如果这一切看起来势不可挡或难以理解，也许这些关于 Unicode 和字符编码的文章可以提供帮助：

*   [每个开发人员都需要了解 Unicode](https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/)
*   Ned Batchelder 的[实用 Unicode](https://nedbatchelder.com/text/unipain.html)
*   Python 的[Unicode HOWTO](https://docs.python.org/3/howto/unicode.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-27T18:32:26.260

将 Unicode 字符串转换*为数字*的常用方法是将其转换为字节序列。Unicode 字符是纯抽象的，每个字符都有自己的编号；但是，还有更多方法可以将数字转换为字节流。可能最通用的方法是将字符串编码为 UTF-8 编码。您可以选择多种方法从中获取整数。这是一个（我从 Ivella 那里借来了漂亮的字符串——我希望里面没有坏话:)：

```
Python 3.2.1 (default, Jul 10 2011, 20:02:51) [MSC v.1500 64 bit (AMD64)] on win32
Type "copyright", "credits" or "license()" for more information.
>>> s = "Hello, World, عالَم, ދުނިޔެ, जगत, 世界"
>>> b = s.encode('utf-8')
>>> b
b'Hello, World, \xd8\xb9\xd8\xa7\xd9\x84\xd9\x8e\xd9\x85, \xde\x8b\xde\xaa\xde\x82\xde\xa8\xde\x94\xde\xac, \xe0\xa4\x9c\xe0\xa4\x97\xe0\xa4\xa4, \xe4\xb8\x96\xe7\x95\x8c' 
```

现在我们有了字节序列，其中数字从 128 到 255 的字节显示为十六进制编码的转义序列。让我们将所有字节转换为它们的十六进制代码作为字节串。

```
>>> import binascii
>>> h = binascii.hexlify(b)
>>> h
b'48656c6c6f2c20576f726c642c20d8b9d8a7d984d98ed9852c20de8bdeaade82dea8de94deac2c20e0a49ce0a497e0a4a42c20e4b896e7958c' 
```

我们可以把它看作是一个用十六进制表示的大数字（作为文本）。允许我们将其`int`转换为抽象数字——在打印时——通常被转换为十进制表示法。

```
>>> i = int(h, 16)
>>> i
52620351230730152682202055464811384749235956796562762198329268116226267262806875102376740945811764490696968801603738907493997296927348108 
```

现在您可以将它存储为一个数字，对其进行加密（尽管更常见的是加密较早的字节序列），然后将其转换回整数。请注意，没有多少语言（可能没有数据库）能够处理这么大的整数。

让我们回到原来的字符串。首先将其转换为十六进制表示（字符串）。

```
>>> h2 = hex(i)
>>> h2
'0x48656c6c6f2c20576f726c642c20d8b9d8a7d984d98ed9852c20de8bdeaade82dea8de94deac2c20e0a49ce0a497e0a4a42c20e4b896e7958c'
>>> h3 = h2[2:]   # remove the 0x from the beginning
>>> h3
'48656c6c6f2c20576f726c642c20d8b9d8a7d984d98ed9852c20de8bdeaade82dea8de94deac2c20e0a49ce0a497e0a4a42c20e4b896e7958c'
>>> type(h3)
<class 'str'> 
```

我们不得不删除它，`0x`因为它只说其余的是代表数字的十六进制字符。请注意，`h3`是`str`类型。正如我们在 Python 3（见顶部）中一样，它`str`表示 Unicode 字符串。下一步是将这对十六进制数字转换回字节。让我们试试`unhexlify()`：

```
>>> binascii.unhexlify(h3)
Traceback (most recent call last):
  File "<pyshell#16>", line 1, in <module>
    binascii.unhexlify(h3)
TypeError: 'str' does not support the buffer interface 
```

哎呀！它只接受字节串​​。然后，将 Unicode 中的每个十六进制数字编码为字节串中的十六进制数字。要走的路是编码；但是，编码为 ASCII 是微不足道的。

```
>>> b2 = h3.encode('ascii')  # character by character; subset of ascii only
>>> b2
b'48656c6c6f2c20576f726c642c20d8b9d8a7d984d98ed9852c20de8bdeaade82dea8de94deac2c20e0a49ce0a497e0a4a42c20e4b896e7958c'
>>> b3 = binascii.unhexlify(b2)
>>> b3
b'Hello, World, \xd8\xb9\xd8\xa7\xd9\x84\xd9\x8e\xd9\x85, \xde\x8b\xde\xaa\xde\x82\xde\xa8\xde\x94\xde\xac, \xe0\xa4\x9c\xe0\xa4\x97\xe0\xa4\xa4, \xe4\xb8\x96\xe7\x95\x8c' 
```

现在我们有了与第一个类似的字节串`.encode('utf-8')`。让我们使用逆运算——从 UTF-8 解码。我们应该得到与开始时相同的 Unicode 字符串。

```
>>> s2 = b3.decode('utf-8')
>>> s2
'Hello, World, عالَم, ދުނިޔެ, जगत, 世界'
>>> s == s2   # is the original equal to the result?
True 
```

:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-27T18:45:57.537

来自python的文档：

> binascii[模块](http://docs.python.org/py3k/library/binascii.html)包含许多在二进制和各种 ASCII 编码的二进制表示之间进行转换的方法。

例如，您可以使用[`binascii.hexlify`](http://docs.python.org/py3k/library/binascii.html#binascii.hexlify)获取*二进制字符串*“LOL”的十六进制表示，并通过[int](http://docs.python.org/py3k/library/functions.html#int)内置函数将其转换为整数：

```
>>> binascii.hexlify(b"LOL")
b'4c4f4c'
>>> int(binascii.hexlify(b"LOL"), 16)
5001036 
```

由于您需要将此应用于 unicode 字符串，因此您首先需要将它们编码为二进制字符串。您可以[`str.encode`](http://docs.python.org/py3k/library/stdtypes.html#str.encode)为此目的使用该方法：

```
>>> int(binascii.hexlify("fiŝaĵo".encode("utf-8")), 16)
7379646744164087151 
```

就是这样。

反之亦然，您将需要反转每个步骤。首先将整数以十六进制表示形式转换为二进制字符串（您可以使用[`format(int, "x")`](http://docs.python.org/py3k/library/string.html#formatspec)然后对其进行编码），将十六进制转换为 ascii`binascii.unhexlify`并最后解码为 utf-8：

```
>>> binascii.unhexlify(format(7379646744164087151, "x").encode("utf-8")).decode("utf-8")
'fiŝaĵo' 
```

这是一个循序渐进的解释，如果您真的要使用这些工具，最好以函数的形式排列它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-27T17:24:32.437

在 Martijn Pieters 给出的解决方案的基础上，您可以使您的字符串成为一个巨大的数字，Python 3 可以很好地处理它，因为它的 int 类型是任意大的（这不是“计算机如何工作”，请参阅我对您问题的评论） .

给定字符数字代码列表：

```
>>> a = [ord(c) for c in 'Hello World!']
>>> print(a)
[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33] 
```

并且知道，从[Unicode](http://en.wikipedia.org/wiki/Unicode)上的 Wikipedia 页面，最大的 unicode 字符数是 10FFFF（十六进制），您可以这样做：

```
def numfy(s):
    number = 0
    for e in [ord(c) for c in s]:
        number = (number * 0x110000) + e
    return number

def denumfy(number):
    l = []
    while(number != 0):
        l.append(chr(number % 0x110000))
        number = number // 0x110000
    return ''.join(reversed(l)) 
```

因此：

```
>>> a = numfy("Hello, World, عالَم, ދުނިޔެ, जगत, 世界")
>>> a
31611336900126021[...]08666956
>>> denumfy(a)
'Hello, World, عالَم, ދުނިޔެ, जगत, 世界' 
```

其中这个 0x110000（来自 10FFFF + 1）是不同的预见 Unicode 字符的数量（1114112，十进制）。如果你确定你只使用英文字母，你可以在这里使用 128，如果你使用一些带有重音的拉丁语言，使用 256 是安全的。无论哪种方式，你的数字都会小得多，但它不能代表每个 Unicode 字符。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-27T16:15:38.663

这会将每个字符转换为数字...

```
s="hello \u2020"
print [ord(c) for c in s] 
```

# matlab - 有没有办法在matlab中使用哈希表/哈希图？

> ID：12625629
> 
> 赞同：16
> 
> 时间：2012-09-27T16:09:13.603
> 
> 标签：matlab, data-structures

> **可能重复：**
> [MATLAB 中的哈希表](https://stackoverflow.com/questions/3591942/hash-tables-in-matlab)

## 一般问题

有什么方法可以在 Matlab 中获取 hashset 或 hashmap 结构？

我经常发现自己需要查找唯一条目或检查向量中的成员资格，并且使用诸如`unique()`逻辑索引之类的命令似乎可以搜索向量，并且对于大量值集确实很慢。在 Matlab 中执行此操作的最佳方法是什么？

## 例子

例如，假设我有一个素数列表并想检查 3 是否为素数：

```
primes = [2,3,5,7,11,13];

if primes(primes==3)
    disp('yes!')
else
    disp('no!')
end 
```

如果我用长向量来做这件事，很多时候事情会变得很慢。

## 在其他语言中

所以基本上，在 Matlab 中是否有与 python 的`set()`and`dict()`或类似的 Java 的`java.util.HashSet`and等价的东西？`java.util.HashMap`如果没有，是否有任何在大向量中进行查找的好方法？

## 编辑：对答案的反思

这是我在答案中得到建议的运行时间。

```
>> b = 1:1000000;
>> tic; for i=1:100000, any(b==i);; end; toc
Elapsed time is 125.925922 seconds.

s = java.util.HashSet();
>> for i=1:1000000, s.add(i); end    
>> tic; for i=1:100000, s.contains(i); end; toc
Elapsed time is 25.618276 seconds.

>> m = containers.Map(1:1000000,ones(1,1000000));
>> tic; for i=1:100000, m(i); end; toc
Elapsed time is 2.715635 seconds 
```

Java 集的构建也很慢，因此根据问题的不同，这也可能很慢。真的很高兴容器。地图提示。它真的破坏了其他例子，而且它也是即时设置的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-27T16:18:56.870

像这样？

```
>> m = java.util.HashMap;
>> m.put(1,'hello,world');
>> m.get(1)
ans =
hello, world 
```

或者，如果您想要 Matlab-native 实现，请尝试

```
>> m = containers.Map;
>> m('one') = 1;
>> m('one')
ans =
     1 
```

这实际上是键入的——它接受的唯一键是 type `char`。您可以在创建映射时指定键和值类型：

```
>> m =  containers.Map('KeyType','int32','ValueType','double');
>> m(1) = 3.14;
>> m(1)
ans =
  3.14 
```

如果您尝试输入除 a 之外的任何键`int32`和除 a 之外的任何值，您现在将得到错误`double`。

您还可以使用 Set：

```
>> s = java.util.HashSet;
>> s.put(1);
>> s.contains(1)
ans = 
     1
>> s.contains(2)
ans = 
     0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:16:37.810

根据您的示例的文字程度，这`disp`将是一个巨大的开销（I/O 非常慢）。

除此之外，我相信进行这样的检查的最快方法是：

```
if find(primes==3,1,'first')
    disp('yes');
else
    disp('no');
end 
```

**编辑**，您也可以使用`any(primes==3)`- 快速速度测试显示它们大致相同：

```
>> biglist = 1:100000;
>> tic;for i=1:10000
find(biglist==i,1,'first');
end
toc
Elapsed time is 1.055928 seconds.

>> tic;for i=1:10000
any(biglist==i);
end
toc
Elapsed time is 1.054392 seconds. 
```

# python - Web2py：如何配置 menu.py 以将链接添加到外部链接

> ID：12625632
> 
> 赞同：1
> 
> 时间：2012-09-27T16:09:16.207
> 
> 标签：python, web-applications, web2py

我刚刚开始从示例中学习 web2py 框架，我看到 menu.py 配置如下：

```
response.menu = [
    (T('Index'), False, URL('default','index'),[]),] 
```

然后菜单栏中会显示一个项目，链接到：

> %网站%/%应用程序名称%/默认/索引

那么问题来了，如何配置 menu.py 文件以添加项目以链接到外部链接？说：www.google.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:37:23.130

元组中的第三项可以是任何 URL，而不仅仅是由 web2py`URL()`函数生成的。所以，你可以这样做：

```
response.menu = [(T('Index'), False, 'http://www.google.com')] 
```

# python - 去除最后一个逗号的字符串函数

> ID：12625636
> 
> 赞同：50
> 
> 时间：2012-09-27T16:09:22.253
> 
> 标签：python

输入

```
str = 'test1,test2,test3,' 
```

输出

```
str = 'test1,test2,test3' 
```

要求去掉最后出现的 ','

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-09-27T16:10:15.987

只需使用[rstrip()](https://docs.python.org/2/library/string.html#string.rstrip)。

```
result = your_string.rstrip(',') 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-27T16:17:38.203

```
str = 'test1,test2,test3,'
str[:-1] # 'test1,test2,test3' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-10T11:30:52.687

**这个问题很老，但试图给出更好的答案**

```
str = 'test1,test2,test3,' 
```

它将检查最后一个字符，如果最后一个字符是逗号，它将删除，否则将返回原始字符串。

```
result = str[:-1] if str[-1]==',' else str 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-10T11:41:56.503

虽然这样的事情有点过头了。我认为这个声明会对你有所帮助。

```
str = 'test1,test2,test3,'    
result = ','.join([s for s in str.split(',') if s]) # 'test1,test2,test3' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-13T04:01:54.960

str = 'test1,test2,test3,'

逗号是字符串中的最后一个字符，由索引 -1 或 表示`str[-1]`。

因此，要删除最后一个字符，您需要将字符串置于`str[:-2]`解决方案所在的范围内：

```
 str = 'test1,test2,test3' 
```

但由于字符串是不可变的，您可能希望将不带尾随逗号的新变量分配给新变量。

```
anotherStr = 'test1,test2,test3' 
```

# database - HSQLDB 索引不一致

> ID：12625638
> 
> 赞同：2
> 
> 时间：2012-09-27T16:09:37.223
> 
> 标签：database, jdbc, hsqldb, indexing

我在我们的 java 项目中遇到了 HSQLDB 的奇怪行为。非常简单的查询返回不一致的结果。我将问题追溯到某些表的索引不是最新的。不幸的是，我既不是 SQL 专家，也不是处理 java 数据库的专家。

HSQLDB 版本是 2.2.8。我试图更新到 2.2.9 但这没有帮助。

我们的数据库非常简单。它包含几个独立的表。他们之间没有任何关系。每个表都配备了索引，其中一个是结合了几列的唯一索引。这是一个例子：

```
CREATE CACHED TABLE PUBLIC.MYTABLE(
  A BIGINT DEFAULT -9999 NOT NULL,
  B BIGINT DEFAULT -9999 NOT NULL,
  C NUMERIC(12,7) DEFAULT -9999.0000000 NOT NULL,
  D INTEGER DEFAULT -9999 NOT NULL);

CREATE INDEX IDX1 ON PUBLIC.MYTABLE( A );
CREATE INDEX IDX2 ON PUBLIC.MYTABLE( B );
CREATE INDEX IDX3 ON PUBLIC.MYTABLE( C );

CREATE UNIQUE INDEX MYTABLE_PRIMARY_KEY ON PUBLIC.MYTABLE( A, B ); 
```

我们通常从 java 程序中插入行和查询表，从不更新现有行。插入操作看起来像这样：

```
Connection con = ...; // get connection from 
PreparedStatement stmt;

con.setAutoCommit( false );

stmt = this.con.prepareStatement( 
    String.format( 
       "insert into %s values (?,?,?,?)", "MYTABLE"));

stmt.setLong(1, data1);
stmt.setLong(2, data2);
stmt.setDouble(3, data3);
stmt.setInt(4, data4);

stmt.addBatch() 
```

在其他地方我们执行批处理

```
stmt.executeBatch();
stmt.clearBatch();
con.commit(); 
```

代码循环执行，之后我们关闭语句并使用适当的方法连接。此外，连接 url 末尾有“shutdown=true”，所以我们希望数据库能够正确关闭。

正如我前面提到的，我在 SQL 查询时注意到了这个问题，例如

```
SELECT COUNT(*) FROM MYTABLE 
```

开始返回不合理的结果，例如它只返回了预期行数的大约一半。作为一项实验，我从表中删除了唯一索引，并且所有查询都正常工作。这就是为什么我认为由于某种原因索引在插入时没有正确更新。查看索引的线索来自谷歌搜索和阅读留言板和论坛上的评论。

如在我使用[的 HSQLDB 中禁用并重建索引中所述](https://stackoverflow.com/a/12569539/1703316)

```
SHUTDOWN COMPACT 
```

并且修复了我们数据库中的所有表，所有数据都在那里，所有查询都返回正确的结果。我怀疑该问题的作者遇到了与我类似的问题。

好的，我的数据是安全的，所以我想了解并纠正问题的根源。

索引是否应该在插入时更新？或者这是一个错误的假设，我们每次更新数据库时都需要执行 SHUTDOWN COMPACT？

多列的唯一索引是否可能是问题的根源？

我将不胜感激任何建议或指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T20:09:06.310

索引总是在插入/删除/更新时更新。不需要为此执行 SHUTDOWN COMPACT。

目前尚不清楚是什么导致了不一致。如果你可以用虚拟数据重现它，然后提交一个测试用例到 HSQLDB 项目，它会被调查。

# vim - vim 快捷键最大化和最小化快捷键

> ID：12625649
> 
> 赞同：3
> 
> 时间：2012-09-27T16:10:20.660
> 
> 标签：vim, shortcut

我正在寻找一种最大化和最小化分屏窗口的方法。我知道快捷键，但忘记了它们。任何分屏提示表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T18:02:13.343

要最小化拆分的高度：

*   正常模式：`z0<CR>`
*   命令模式：`:resize 0`

最大化高度：

*   正常模式：`z999<CR>`或`<c-w>_`
*   命令模式：`:resize 999`

如果需要，这些当然可以映射到更方便的快捷方式。

你也可以尝试所谓的“Rolodex”模式，它总是最大化活动分割的高度：

```
:set winheight=999 
```

# grep - Pandas：类似 grep 的函数

> ID：12625650
> 
> 赞同：19
> 
> 时间：2012-09-27T16:10:31.477
> 
> 标签：grep, row, pandas

如果它有一些字符串或值，Pandas 中是否有类似 grep 的内置函数来删除一行？提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-27T18:03:33.140

看看 df['column_label].str 下面的示例将删除 A 列包含“a”字符且“B”等于 20 的所有行。

```
In [46]: df
Out[46]:
     A   B
0  foo  10
1  bar  20
2  baz  30

In [47]: cond = df['A'].str.contains('a') & (df['B'] == 20)

In [48]: df.drop(df[cond].index.values)
Out[48]:
     A   B
0  foo  10
2  baz  30 
```

# python - 用于打乱解扰文件内容的简单 Python 代码

> ID：12625652
> 
> 赞同：1
> 
> 时间：2012-09-27T16:10:33.723
> 
> 标签：python, file, scramble

我正在寻找一个简单的小程序来加扰和解扰文件的内容。该文件是一个 zip 文件，因此它可能包含任何字符。正在考虑类似二进制补码之类的东西，但不知道如何在 Python 中做到这一点。

这样做的原因是我现在的雇主有严格的互联网和文件安装法，我想邮寄自己的文件，而邮件程序不会将附件检测为 zip 文件（即使您将其重命名为 .jpg，它也会这样做）。

我已经在我的工作机器上安装了 Python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:19:25.420

您可以尝试`xor`使用特定值创建文件的内容，创建[XOR-cipher](http://en.wikipedia.org/wiki/XOR_cipher)，只需确保以二进制模式读取/写入文件。您必须对此进行测试，看看它是否适合您的目的（它适用于文本文件，我不明白为什么它不适用于二进制文件。）

当然，您必须使用相同的（键）值（例如字符）进行编码和解码 - 尽管您可以对这两种操作使用相同的代码。

这是我最近整理的一些代码，它们就是这样做的：

```
import sys

def processData(filename, key):
    with open(filename, 'rb') as inf, open(filename+'.xor', 'wb') as outf:
        for line in inf:
            line = ''.join([chr(ord(c)^ord(key)) for c in line])
            outf.write(line)

if __name__ == '__main__':
    if len(sys.argv) != 3:
        print 'Usage: xor_it filename key'
        print '       key = a single character'
    else:
        processData(sys.argv[1], sys.argv[2]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:25:14.903

我已经成功通过[StealthZip](http://www.softpedia.com/get/System/File-Management/StealthZIP.shtml)通过电子邮件和代理限制！

但是，如果您确实想在 python 中执行此操作，则可以尝试使用[pickle](http://docs.python.org/library/pickle.html)。以二进制模式加载文件，腌制，发送，并在接收端取消腌制。不过，我不知道 pickle 与二进制文件的功能有多好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T01:09:57.143

您也可以简单地对文件进行 base64 编码。这将使您的文件更大，但具有所有 ascii 文本的好处（然后您可以将其粘贴到电子邮件中。）

请注意，这将覆盖当前文件。将其更改为输出到另一个文件并不难。

```
#b64.py
import base64
import sys

def help():
    print """Usage: python b64.py -[de] file
    -d\tdecode
    -e\tencode"""
    sys.exit(0)

def decode(filename):
    with open(filename) as f:
        bin = base64.b64decode(f.read())
    with open(filename,'wb') as f:
        f.write(bin)

def encode(filename):
    with open(filename,'rb') as f:
        text = base64.b64encode(f.read())
    with open(filename,'w') as f:
        f.write(text)

if len(sys.argv) != 3:
    help()

if sys.argv[1] == "-d":
    decode(sys.argv[2])
elif sys.argv[1] == "-e":
    encode(sys.argv[2])
else:
    help() 
```

# matlab - Matlab神经网络测试

> ID：12625665
> 
> 赞同：2
> 
> 时间：2012-09-27T16:11:20.183
> 
> 标签：matlab, neural-network

我创建了一个神经网络，性能很好。通过使用 nprtool，我们可以使用输入数据和目标数据来测试网络。这是我的问题，使用提供的目标数据测试神经网络的目的是什么？是不是测试不应该有目标数据，这样我们就可以知道在没有目标数据的情况下训练好的神经网络表现如何？希望有人回复，谢谢=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:18:25.140

我不熟悉`nprtool`，但我怀疑它会将*输入*数据提供给您的神经网络，然后将您的 NN*输出*数据与*目标*数据进行比较（并据此计算某种成功率）。

**所以你的神经网络永远不会看到*目标*数据，它只是用来衡量性能。**

这就像学校练习本的“教师版”。学生（即 NN）没有答案，但老师（即`nprtool`）会将她/他的答案与他们进行比较。（好吧，老师可能/希望知道这个主题，但你明白了。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T17:38:00.390

“目标”数据`t`是用作训练网络的示例所需要`y`的。`y=net(x)`nprtool 所做的是将训练集分为三组：训练集、验证集和测试集。

第一个用于实际更新网络。

第二个用于确定网络的性能（注意：此集合不以任何方式用于更新网络）：随着 NN“学习”验证集上的误差（作为 和 之间的差异`t`）`net(x)`减少。趋势最终会停止甚至逆转：这种现象被称为“[过度拟合](http://en.wikipedia.org/wiki/Overfitting)”，这意味着神经网络现在正在追逐训练集，以牺牲泛化能力为代价“记忆”它（意思是：用看不见的数据表现良好） . 所以这个验证集的目的是在 NN 开始过拟合之前确定何时停止训练。这应该回答你的问题。

最后，第三组用于外部测试，让您的一组数据不受训练过程的影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-22T04:09:40.613

尽管整个数据集 [训练、验证和测试] 是训练算法的输入，但测试数据绝不用于设计（即训练和验证）网络

总计 = 设计 + 测试

设计 = 训练 + 验证

训练数据用于估计权重和偏差

验证数据用于监控非训练数据的设计性能。无论训练数据的性能如何，如果验证性能在 6 个（默认）时期内持续下降，则终止训练（验证停止）。

这减轻了 OVERTRAINING AN OVERFIT NET 的可怕现象，即使训练集的性能正在提高，非训练数据的性能也会下降。

过拟合网络比训练方程具有更多的未知权重和偏差，从而允许无限数量的解决方案。一个使用两个未知数但只有一个方程的过拟合的简单示例：

已知：a、b、c

查找：唯一的 x1 和 x2

使用：a * x1 + b * x2 = c

希望这可以帮助。

格雷格

# java - MapReduce - WritableComparables

> ID：12625669
> 
> 赞同：1
> 
> 时间：2012-09-27T16:11:25.357
> 
> 标签：java, mapreduce, word-count

我是 Java 和 Hadoop 的新手。我正在尝试一个非常简单的程序来获得频繁对。

例如

```
Input: My name is Foo. Foo is student. 
Intermediate Output:
    Map:
        (my, name): 1
        (name ,is): 1
        (is, Foo): 2 // (is, Foo) = (Foo, is) 
        (is, student) 
```

所以最后它应该给频繁的pair is `(is ,Foo)`。

伪代码如下所示：

```
Map(Key: line_num, value: line)
words = split_words(line)
for each w in words:
     for each neighbor x:
          emit((w, x)), 1) 
```

在这里，我的钥匙不是一个，而是一对。在浏览文档时，我读到对于每个新键，我们必须实现[WritableComparable](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/WritableComparable.html)。

所以我对此感到困惑。如果有人可以解释这门课，那就太好了。不确定这是不是真的。然后我可以自己弄清楚如何做到这一点！

我不想要任何代码，既不映射器也不想要任何东西......只想了解这个 WritableComparable 做什么？WritableComparable 的哪个方法实际上比较了键？我可以看到 equals 和 compareTo，但我找不到任何解释。请不要代码！谢谢

编辑 1：在 compareTo 中，我为对 (a, b) = (b, a) 返回 0 但仍然不会使用相同的减速器，在 compareTo 方法中有什么方法可以将键 (b, a) 重置为 (a, b ) 或生成全新的密钥？

编辑 2：我不知道生成新密钥，但在 compareTo 更改逻辑中，它运行良好..！谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T19:13:40.443

`WritableComparable`是一个接口，它使实现它的类成为两件事：`Writable`，这意味着它可以通过序列化等方式从您的网络写入和读取。如果您要将它用作键或值以便它可以在 Hadoop 节点之间发送。而且`Comparable`，这意味着必须提供方法来显示给定类的一个对象如何与另一个对象进行比较。这在 Reducer 通过键组织时使用。

当您想创建自己的对象作为键时，此接口是必需的。您需要创建自己的`InputFormat`，而不是使用 Hadoop 附带的其中之一。这可能会变得相当困难（根据我的经验），特别是如果您不熟悉 Java 和 Hadoop。

所以如果我是你，我不会为此烦恼，因为有一个更简单的方法。我会使用`TextInputFormat`既方便又方便的默认设置`InputFormat`以及非常易于使用和理解。您可以简单地将每个键作为`Text`与字符串非常相似的对象发出。不过有一个警告；就像您提到的那样`"is Foo"`，`"Foo is"`需要评估为相同的键。因此，对于您提取的每一对单词，在将它们作为键传递给该`String.compareTo`方法之前，请按字母顺序对其进行排序。这样你就可以保证没有重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T07:54:28.790

这是您的问题的映射器类，没有实现频繁的单词对逻辑。我想你不是在找那个。

```
public class MR {

public static class Mapper extends org.apache.hadoop.mapreduce.Mapper<LongWritable, Text, Text, LongWritable>
{
    public static int check (String keyCheck)
    {
        // logig to check key is frequent or not ?
        return 0;
    }
    @Override
    protected void map(LongWritable key, Text value, Context context)
            throws IOException, InterruptedException {
        Map< String, Integer> keyMap=new HashMap<String, Integer>();
        String line=value.toString();
        String[] words=line.split(" ");
        for(int i=0;i<(words.length-1);i++)
        {
            String mapkeyString=words[i]+","+words[i+1];
            // Logic to check is mapKeyString is frequent or not .
            int count =check(mapkeyString);
            keyMap.put(mapkeyString, count);

        }
        Set<Entry<String,Integer>> entries=keyMap.entrySet();
        for(Entry<String, Integer> entry:entries)
        {
            context.write(new Text(entry.getKey()), new LongWritable(entry.getValue()));
        }

    }

}
public static class Reduce extends Reducer<Text, LongWritable, Text, Text>
{

    protected void reduce(Text key, Iterable<LongWritable> Values,
            Context context)
            throws IOException, InterruptedException {

    }

}
public static void main(String[] args) {
    Configuration configuration=new Configuration();
    try {
        Job job=new Job(configuration, "Word Job");
        job.setMapperClass(Mapper.class);
        job.setReducerClass(Reduce.class);
        job.setInputFormatClass(TextInputFormat.class);
        FileInputFormat.setInputPaths(job, new Path(args[0]));
        FileOutputFormat.setOutputPath(job, new Path(args[1]));
        job.waitForCompletion(true);

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

} 
```

# primefaces - 如何使用 Webdriver (Selenium2) 定位器 By.id 来定位 PrimeFaces 自动生成的带有冒号“：”的 ID

> ID：12625672
> 
> 赞同：1
> 
> 时间：2012-09-27T16:11:33.653
> 
> 标签：primefaces, webdriver

当尝试将文本发送到通过 PrimeFaces 创建的 TextBox 时：

我尝试：

```
getDriver().findElement(By.id("addRowTable:0:hostName")).sendKeys("testing"); 
```

html是：

输入主机名：$(function() {PrimeFaces.cw('Watermark','widget_addRowTable_0_j_idt474',{id:'addRowTable:0:j_idt474',value:'Hostname',target:'addRowTable:0:hostName'},'水印');}); PrimeFaces.cw('InputText','widget_addRowTable_0_hostName',{id:'addRowTable:0:hostName'});.xxxxcxxxxxdddddddddd.net

我得到的 XPath 为：

```
//*[@id="addRowTable:0:hostName"] 
```

我得到例外：

```
org.openqa.selenium.NoSuchElementException: Unable to locate element: {"method":"id","selector":"addRowTable\\:0\\:hostName"}
Command duration or timeout: 149 milliseconds
For documentation on this error, please visit: http://seleniumhq.org/exceptions/no_such_element.html 
```

当我看

```
http://seleniumhq.org/exceptions/no_such_element.html 
```

我得到一个通用的解释：

```
The element may not be present. 
```

甚至转义：使用 \ 不起作用

```
getDriver().findElement(By.id("addRowTable\\:0\\:hostName")).sendKeys("testing"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T12:20:27.680

在我们的应用程序中，我们从不直接检查完整 ID，因为它依赖于组件在 JSF 组件树中的位置。

相反，您应该使用以($=) 运算符**结尾的 CSS。**

```
getDriver().findElement(By.cssSelector("input[id$=\"hostName\"]")).sendKeys("testing"); 
```

或者，使用[页面对象](http://code.google.com/p/selenium/wiki/PageObjects)：

```
public class MyPage extends PageObject {

    @FindBy(css="input[id$=\"hostName\"]")
    private WebElement hostName;

    public void setHostName(String hostName) {
        hostName.sendKeys("testing");
    }

} 
```

# iphone - iPhone OCR 不能识别所有捕获的图像文本，但可以识别预定义的文本图像

> ID：12625676
> 
> 赞同：1
> 
> 时间：2012-09-27T16:11:45.873
> 
> 标签：iphone, objective-c, ios, xcode, ocr

我已经按照链接/教程**使用 ocr api 实现了名片阅读器图像**

[http://tinsuke.wordpress.com/2011/11/01/how-to-compile-and-use-tesseract-3-01-on-ios-sdk-5/](http://tinsuke.wordpress.com/2011/11/01/how-to-compile-and-use-tesseract-3-01-on-ios-sdk-5/)

它可以扫描一些*`screen shots of UIalert views / table views. and some images having text`*如下的文本。

**可以识别这张图片上的文字：**

![在此处输入图像描述](../Images/ac2e7d4c01af0dacfdb2d1ddc5e8367f.png) ![在此处输入图像描述](../Images/06ff562f992795f5ce1df0726007c13a.png)

*`[Airoplane mode wi-fi vpn ratch data sounds brightness general wall paper]`*

但是当我捕获名片时，它会返回一些特殊的字符和数字。如果捕获的图像中的文本非常清晰且大文本，有时会被识别。

**无法识别跟随图像上的文字**

![在此处输入图像描述](../Images/cbfdcb27206cdc984199b2015393987c.png) ![在此处输入图像描述](../Images/024168fb27690b753bfa1fdafbbcba36.png)

*`[ xas $- 432 *7 5$#2 $@@#%^ ^&* I( WQ#$ follow like√ √dg @ ]`*

为什么如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:21:47.093

Tesseract 库是开源库。我认为它不是那么准确。OCR 为分辨率超过 150 像素的黑白图像提供了最佳效果。您使用 iPad 或 iPhone 的相机拍摄的图像以 72 像素保存，而 tesseract 无法提供最佳效果结果。如果您更感兴趣，那么有一些准确度很高的付费图书馆，您可以尝试一些：[这里](https://stackoverflow.com/questions/9062755/ocroptical-character-recoginition-libraries-for-iphone)

# javascript - jQuery 的 $(selector).position().left 在 Firefox、Chrome 浏览器中有时会失败

> ID：12625677
> 
> 赞同：0
> 
> 时间：2012-09-27T16:11:50.900
> 
> 标签：javascript, jquery, html, css, position

我有一个内容幻灯片：

幻灯片容器
|--> 包装器
|------> slide1、slide2 等。

这就像计算包装器的位置 X 和幻灯片的位置 X 一样简单，以确定在哪里滑动包装器以便下一张/上一张幻灯片显示在容器的视口中。这很简单。

对于 Firefox 和 Chrome，我使用 CSS3 transform 和 transition-duration 来为幻灯片制作动画。一切都很完美。几乎。

问题只是当我非常快地单击下一步按钮时。我正在使用 jQuery 的

```
$(selector).position().left 
```

读取幻灯片的位置 X（左）并且位置变为**0**（而不是预期的，例如 300 像素）。我确实有一个标志 isAnimating 以防止用户走得太快，但这也无济于事。它确实可以防止滚动内容过快，但左侧位置可能仍为**0**，就好像其他原因导致它无法确定一样。

我做了一个简短的搜索，发现如果正在加载图像，一些浏览器将无法确定它的位置，直到加载结束。但是，每张幻灯片都有一个图像，但在其中。幻灯片的 CSS 似乎所有宽度和边距都设置得很好。

问题是为什么会根据我描述的场景发生这种情况，以及可能有什么可以改进的地方来确定 Firefox、Chrome 浏览器的位置 X？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:36:52.933

我已经决定，如果**offsetLeft**对我来说始终不可靠，我可以使用元素的宽度及其在容器中的索引位置来确定位置 X

```
var newWrapperPos = undefined;
$(lotWrapper).children('div').each(function(index){
        if($(this).attr("id") === "slot"+id){
            var width = $(this).width();
            newWrapperPos = index * width;
            return false;
        }
    }); 
//now I can shift wrapper to position = newWrapperPos 
```

抱歉，我无法共享代码 - 撕掉所有涉及的功能有点费时。但如果有人有更好的答案，请告诉我。现在这对我来说很好。

# c++ - C之类的数组语法？

> ID：12625679
> 
> 赞同：0
> 
> 时间：2012-09-27T16:11:54.440
> 
> 标签：c++, c, arrays, syntax

这是什么语法`double x[]`？

它是声明数组的C方式吗？

如果我有类似的功能

```
void evaluate(double x[], double *f)
{
   // evaluate
} 
```

我可以传递任意长度的参数 x 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:15:16.390

数组类型的参数的行为与指针完全相同。您不能真正将数组作为函数参数传递。但是，这种语法给人一种错觉，即为了便于阅读，您可以这样做。所以你的功能相当于：

```
void evaluate(double *x, double *f)
{
  // evaluate
} 
```

从 ISO/IEC 14882:2011 的 §8.3.5/5 开始：

> 在确定每个参数的类型后，将“T的数组”或“返回T的函数”类型的任何参数分别调整为“指向T的指针”或“返回T的函数的指针”。

表示数组的表达式将衰减为指向其第一个元素的指针，因此您仍然可以这样做：

```
void evaluate(double x[]);
int array[] = {1, 2, 3, 4, 5};
evaluate(array); // The array decays to a pointer to its first element 
```

从§4.2：

> “NT 数组”或“T 的未知边界数组”类型的左值或右值可以转换为“指向 T 的指针”类型的纯右值。结果是指向数组第一个元素的指针。

所以是的，您确实可以传递任意长度的数组。实际上，您只是传递一个指向第一个元素的指针。但是，如果需要，您还需要传递数组的长度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T16:18:39.020

数组可能会令人困惑，因为在大多数情况下，数组的名称会衰减为指向其第一个元素的指针。所以：

```
double x[3];          // x is an array of 3 doubles
void f(double x[3]);  // f takes a pointer to double
f(x);                 // calls f with the address of x[0] 
```

将数组类型衰减为指针的原因`f`是，您不必为每个数组大小都有一个单独的函数：

```
double x[3];
double y[4];
void f(double x[3], int size) {
    for (int i = 0; i < size; ++i)
        std::cout << x[i] << ' ';
    std::cout << '\n';
}
f(x, 3);
f(y, 4); 
```

如果参数是`double*x`, `double x[]`, `double x[3]`, `double x[17]`, `double x[]`;它的工作方式相同 在所有这些情况下，`x`都被视为`double*`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T16:16:15.063

在函数的参数列表中，`double x[]`与`double *x`.

> 我可以传递任意长度的参数 x 吗？

是的，你可以通过。但是没有办法知道`x`函数中数组的长度`evaluate`。所以你可能也想传递长度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-27T16:16:37.950

[C 常见问题解答，第 6.4 节](http://c-faq.com/aryptr/aryptrparam.html)

> 由于数组立即衰减为指针，因此数组从未真正传递给函数。您可以假设一个函数接收一个数组作为参数，并通过将相应的参数声明为数组来说明它：
> 
> ```
>  void f(char a[])
>     { ... } 
> ```
> 
> 从字面上解释，这个声明没有用，所以编译器转过身来假装你写了一个指针声明，因为这是函数实际上会收到的：
> 
> ```
>  void f(char *a)
>     { ... } 
> ```
> 
> 如果函数传统上用于对数组进行操作，或者如果参数在函数中自然地被视为数组，那么将函数称为“接收”数组并没有什么特别的错误。
> 
> 这种将类似数组的声明符转换为指针的方法仅适用于函数形式参数声明，其他任何地方都没有。如果转换困扰您，您不会被迫使用它；许多程序员得出的结论是，它造成的混乱超过了声明“看起来像”函数内的调用或使用的小优势。（请注意，转换只发生一次；类似 char a2[][] 的东西不起作用。请参阅问题 6.18 和 6.19。）

换句话说，在函数参数声明中，未指定长度的数组与指针相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-27T16:15:36.570

```
void evaluate(double x[], double *f)
{
   // evaluate
} 
```

实际上相当于：

```
void evaluate(double *x, double *f)
{
   // evaluate
} 
```

在 C 和 C++ 中。

这意味着`x`参数的类型`double *`在这两种情况下都是。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T16:13:58.417

是的，在c中，数组是这样声明的

**好读**

1.  [C中的字符数组声明和初始化](https://stackoverflow.com/questions/4978056/char-array-declaration-and-initialization-in-c)
2.  [简单的 C 数组声明/赋值问题](https://stackoverflow.com/questions/1582165/simple-c-array-declaration-assignment-question)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T16:17:16.390

您的函数的参数`x`是一个未指定长度的数组。这意味着您可以将任何类型的数组传递`double`给它，无论大小。您还可以将指向 a 的指针*作为*`double`参数传递。

但是有一个警告：您不能`sizeof`在数组上使用运算符`x`，因为它没有大小。

# android - ContentProvider BulkInsert 和 ApplyBatch

> ID：12625681
> 
> 赞同：2
> 
> 时间：2012-09-27T16:11:58.157
> 
> 标签：android, android-contentprovider

在我的应用程序中，我目前正在使用内容提供程序将 700 多个项目写入数据库。出于某种原因，当我尝试使用以下方法一次完成所有项目时：

```
 mContentResolver.bulkInsert(mContentUri, insertVals)); 
```

其中 insertVals 是一个包含 700 个项目的 ContentValues[]。每次我这样做时，我都会返回 0 行。但是当我中断对 bulkInsert 的调用以使每个插入只有 100 个项目时，它可以完美运行。这种新方式似乎效率低下。有没有人知道为什么会发生这种情况？我一直无法找到您可以使用 bulkInsert 插入的最大项目数的文档。

**注意**我也尝试过使用 ApplyBatch，并且得到了完全相同的结果。当我为所有 700 个项目执行此操作时，它不起作用。当我一次为 100 件物品做这件事时，它就像一个魅力。

感谢所有的帮助！

# javascript - Javascript循环不起作用

> ID：12625683
> 
> 赞同：-1
> 
> 时间：2012-09-27T16:11:58.250
> 
> 标签：javascript, loops, for-loop

我正在尝试在 Javascript 中运行 for 循环，但我的代码似乎无法正常工作。有任何想法吗？我的代码现在如下：

```
var someData = [
 {
   id: 0,
   summary: "Event 1",
   startTime:  new Date(2012,0, 1, 10),
   endTime: new Date(2012,0, 1, 12),
   calendar: "Calendar1"
 },
 {
   id: 1,
   summary: "Event 2",
   startTime:  new Date(2012,0, 1, 14),
   endTime: new Date(2012,0, 1, 15),
   calendar: "Calendar2"
 }
];

var someData = 
    [
    for(i=0;i<2;i++)
    {
        {
        id:i,
    summary: "Some Event",
    startTime: new Date(2012,8,24,10),
        endTime: new Date(2012,8,24,13),
        calendar: "Calendar"
    },
   }
   ]; 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:13:37.780

你不能这样写 for..loop .. 试试下面，

```
var someData = [];

for(i=0;i<2;i++) {
   someData.push({
        id:i,
        summary: "Some Event",
        startTime: new Date(2012,8,24,10),
        endTime: new Date(2012,8,24,13),
        calendar: "Calendar"
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:17:43.503

使用方法`push()`。除非它是对象中包含的匿名函数，否则不能将代码体放入数组中。

```
var someData = [];

for(var i = 0; i < 2; i++)
{
    someData.push({
        id: i,
        summary: "Some Event",
        startTime: new Date(2012, 8, 24, 10),
        endTime: new Date(2012, 8, 24, 13),
        calendar: "Calendar"
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:14:47.280

您不能将代码混合到文字声明中。首先创建数组，然后用数据填充它：

```
var someData = [];

for(i=0;i<2;i++) {
  someData.push(
    {
      id:i,
      summary: "Some Event",
      startTime: new Date(2012,8,24,10),
      endTime: new Date(2012,8,24,13),
      calendar: "Calendar"
    }
  );
} 
```

# jquery - Viewport Jquery Mobile 的替代方案

> ID：12625692
> 
> 赞同：1
> 
> 时间：2012-09-27T16:12:47.827
> 
> 标签：jquery, jquery-mobile, blackberry

我正在创建一个将通过黑莓本机应用程序中的 Web 浏览器控件使用的应用程序。在黑莓浏览器中，应用程序按预期响应，在本机应用程序浏览器控件中它非常慢。似乎主要的性能成本是这样的：

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

如果我把它拿出来，应用程序运行良好，但由于明显的原因，它没有正确缩放。找到替代方案的最佳方法是什么（如果有的话）？我只关注 bleckberry 应用程序，没有其他移动设备，有什么我可以尝试绕过它，但仍然保持应用程序的缩放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:22:08.727

另一个选择是将操作系统、浏览器或手机重新检测为黑莓。然后您需要创建另一个站点，它与桌面站点或移动站点完全不同。Blackberry 具有完全不同的样式/css 支持。

以下是取决于黑莓支持的软件版本的信息：

[http://docs.blackberry.com/en/developers/deliverables/11844/Feature_CSS_512751_11.jsp](http://docs.blackberry.com/en/developers/deliverables/11844/Feature_CSS_512751_11.jsp)

您还可以在页面的侧边栏上查看它们如何支持表格、图像、表单和媒体流的基础知识。

# java - 为使用 Javassist 创建的新方法的参数添加注释

> ID：12625697
> 
> 赞同：3
> 
> 时间：2012-09-27T16:12:54.570
> 
> 标签：java, javassist

我需要为方法参数添加注释。该方法之前是使用 javassist 创建的，例如：

```
CtClass cc2 = pool.makeClass("Dummy");
CtMethod method = CtNewMethod.make("public java.lang.String dummyMethod( java.lang.String oneparam){ return null; }", cc2); 
```

我要添加的注释非常简单：

```
@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)

public @interface Param {
    /** Name of the parameter */
    String name() default "";
} 
```

1) 在方法创建中写注解 throws

```
javassist.CannotCompileException: [source error] syntax error near "myMethod(@Param 
```

2）找到了这个[解决方案](https://community.jboss.org/thread/169003)，但它基于在我的情况下返回null的行：

```
AttributeInfo paramAtrributeInfo = methodInfo.getAttribute(ParameterAnnotationsAttribute.visibleTag); // or inVisibleTag 
```

我迷失了如何做到这一点；有没有人找到一种方法来创建一个新方法并为其参数添加任何注释？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T14:13:47.187

根据我在原始问题中提到的解决方案找到了解决方法。我无法创建一个类，并向它添加一个方法，并使用 javassist 在其参数中插入一个注释。但是使用真实的类作为模板，可以找到并编辑参数注释。

1）首先，使用带有所需注释的方法创建一个类

```
public class TemplateClass {
    public String templateMethod(@Param String paramOne) {
        return null;
    }
} 
```

2）加载它

```
ClassPool pool = ClassPool.getDefault();
CtClass liveClass = null;
try {
     liveClass = pool.get("your.package.path.Dummyclass");
} catch (NotFoundException e) {
     logger.error("Template class not found.", e);
} 
```

3）工作

```
// -- Get method template
    CtMethod dummyMethod = liveClass.getMethods()[2];
    // -- Get the annotation
    AttributeInfo parameterAttributeInfo = dummyMethod.getMethodInfo().getAttribute(ParameterAnnotationsAttribute.visibleTag);
    ConstPool parameterConstPool = parameterAttributeInfo.getConstPool();
    ParameterAnnotationsAttribute parameterAtrribute = ((ParameterAnnotationsAttribute) parameterAttributeInfo);
    Annotation[][] paramArrays = parameterAtrribute.getAnnotations();
    Annotation[] addAnno = paramArrays[0];
    //-- Edit the annotation adding values
    addAnno[0].addMemberValue("value", new StringMemberValue("This is the value of the annotation", parameterConstPool));
    addAnno[0].addMemberValue("required", new BooleanMemberValue(Boolean.TRUE, parameterConstPool));
    paramArrays[0] = addAnno;
    parameterAtrribute.setAnnotations(paramArrays); 
```

然后在构建结果类之前更改 CtClass 和/或 CtMethod 的名称。它没有预期的那么灵活，但至少有些场景可以用这样的方法解决。欢迎任何其他解决方法！

# google-fusion-tables - 无法将数据插入我拥有的融合表中

> ID：12625702
> 
> 赞同：1
> 
> 时间：2012-09-27T16:13:33.033
> 
> 标签：google-fusion-tables

我正在使用融合表 SQL API (1.0) 将数据插入表中。我拥有这张桌子，这张桌子是私人的。但是，当我使用`INSERT INTO`SQL API 将数据插入到我的表中时，我收到了我无权执行此方法的错误。由于我拥有该表，我不明白为什么我没有插入权限。

我使用 API 资源管理器对其进行了测试。这是生成的网址：

[https://developers.google.com/apis-explorer/#p/fusiontables/v1/fusiontables.query.sql?sql=INSERT+INTO+1kYltHIvQBnfHeAFLwzoSO_F_xTA-Ef6N4MbHmvM+(Name%252C+Location)+VALUES+('Test'% 252C+'地址')&_h=2&](https://developers.google.com/apis-explorer/#p/fusiontables/v1/fusiontables.query.sql?sql=INSERT+INTO+1kYltHIvQBnfHeAFLwzoSO_F_xTA-Ef6N4MbHmvM+%28Name%252C+Location%29+VALUES+%28%27Test%27%252C+%27Address%27%29&_h=2&)

谢谢，GA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:56:55.463

您是否已通过 OAuth 授权您的请求？该请求需要有一个授权令牌，将您标识为发出请求的人。

如果您使用 API Explorer，您可以单击“使用 OAuth 2.0 授权请求：”旁边的按钮，它会自动为您设置令牌。

[https://developers.google.com/fusiontables/docs/v1/using#auth](https://developers.google.com/fusiontables/docs/v1/using#auth)

# ios - 从两个较小的 UIImage 创建一个 UIImage

> ID：12625708
> 
> 赞同：2
> 
> 时间：2012-09-27T16:13:39.743
> 
> 标签：ios, uiimage, core-graphics, image-manipulation

我有两个`UIImage`. 如何创建`UIImage`仅将两个原始图像拼接在一起的第三个？我想要顶部的第一张图像和底部的第二张图像，这样顶部图像的底部边缘与底部图像的顶部边缘齐平。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T16:33:09.157

像这样的东西应该可以工作（虽然我还没有测试过）

```
-(UIImage *)imageWithTopImage:(UIImage *)topImage bottomImage:(UIImage *)bottomImage
{
    UIGraphicsBeginImageContext(CGSizeMake(topImage.size.width, topImage.size.height + bottomImage.size.height);
    [topImage drawInRect:CGRectMake(0, 0, topImage.size.width, topImage.size.height)];
    [bottomImage drawInRect:CGRectMake(0, topImage.size.width, bottomImage.size.width, bottomImage.size.height)];
    UIImage *combinedImage = UIGraphicsGetImageFromCurrentImageContext();    
    UIGraphicsEndImageContext();
    return combinedImage;
} 
```

# java - modalPanel 中的 inputTextarea 不更新支持 bean

> ID：12625713
> 
> 赞同：0
> 
> 时间：2012-09-27T16:13:58.440
> 
> 标签：java, jsf, richfaces

我在 modalPanel 中有这个 inputTextarea，我在支持 bean 中更新相应值 (motivePopupMotive) 的唯一方法是在 inputTextarea 中添加 a4j:support 来设置 ajaxSingle=true，如下所示：

```
<a4j:support event="onchange" ajaxSingle="true"></a4j:support> 
```

在通过单击“btnSavePopupMotive”按钮调用方法保存之前。如果我不这样做，当我单击“btnSavePopupMotive”按钮时，支持 bean 中的值总是一个空字符串。

但我不想要这个解决方案，因为当我调用 ajax 函数时，我会显示一个“正在加载”的图像，并且我不希望仅仅因为用户在这个输入中输入一些文本而显示这个图像。我怎么能解决这个问题？这是代码：

```
<div style="position: absolute;">
    <a4j:form id="form2">
        <r:modalPanel id="panelPopupMotive" resizeable="false" autosized="true" minWidth="300" minHeight="20" >

            <table width="99%" bgcolor="#FFFFFF" style="border-collapse: collapse; border: 0px solid #000000;">
                <tr><td>
                        <fieldset>
                            <legend class="fmeSmallLegend"><h:outputText value="Motive" /> </legend>
                            <table><tr><td>
                                <h:inputTextarea id="motivePopupMotive" 
                                    onkeydown="verifySize(this, 200);" 
                                    onkeyup="verifySize(this, 200);"
                                    onchange="verifySize(this, 200);"
                                    value="#{ParameterFaces.motivePopupMotive}"
                                    rows="4" style="width: 380px;" onfocus="this.style.background='#FFFED2';" onblur="this.style.background='#F5F5F5';">
                                </h:inputTextarea>                                          
                            </td></tr></table>
                        </fieldset>
                </td></tr>  
                <tr>
                    <td align="center">
                        <a4j:commandButton id="btnSavePopupMotive"
                            value="Save" onclick="saveMotive();"
                            style="width:80px" type="submit"
                            oncomplete="closePopupMotive();"
                            title="Save" reRender="motivePopupMotive,existsErrorMotive">
                        </a4j:commandButton>
                        <r:spacer width="5px" />
                        <a4j:commandButton id="btnCancel"
                            value="Cancel" style="width:80px" 
                            oncomplete="Richfaces.hideModalPanel('panelPopupMotive');"
                            title="Cancel">
                        </a4j:commandButton>
                    </td>
                </tr>               
            </table>
            <script type="text/javascript">
                function closePopupMotive(){
                    if (document.getElementById('form2:motivePopupMotive').value == 'false'){
                        Richfaces.hideModalPanel('panelPopupMotive');
                    }
                }
            </script>

            <a4j:jsFunction name="saveMotive" reRender="motivePopupMotive" oncomplete="saveValidatedMotive();"/>

            <a4j:jsFunction name="saveValidatedMotive" actionListener="#{ParameterFaces.save}" reRender=""/>
        </r:modalPanel>
    </a4j:form>
</div> 
```

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T18:00:04.233

原来是因为我在表单内使用了 modalPanel ...我将表单放在 modalPanel 之外，一切正常。

# extract - 维基百科的别名摘录

> ID：12625716
> 
> 赞同：-3
> 
> 时间：2012-09-27T16:14:01.640
> 
> 标签：extract, dump, wikipedia, dbpedia

我知道可以通过转储提取维基百科内容。但是，是否也可以提取搜索别名？

例如，那个“奥巴马”是“巴拉克奥巴马”的别名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:47:20.743

[您可以在DBpedia](http://dbpedia.org)从 Wikipedia 提取的[重定向数据集中](http://wiki.dbpedia.org/Downloads38#redirects)找到您要查找的数据（[RDF](http://en.wikipedia.org/wiki/Resource_Description_Framework)格式）。

# javascript - 检查 jQuery 中是否存在 Attribute('id')

> ID：12625717
> 
> 赞同：12
> 
> 时间：2012-09-27T16:14:01.780
> 
> 标签：javascript, jquery

如何检查 jQuery 中是否存在属性 ID？

我四处搜索，发现这应该可行：

```
if ($(this).attr('id').attr('id'))
{

} 
```

我仍然收到此错误：TypeError: Object gauge1 has no method 'attr'

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-27T16:15:48.253

这本身将起作用：

```
if($(this).attr("id")) 
```

检查有关问题的现有 jsfiddle：http: [//jsfiddle.net/rwaldron/wVqvr/4/](http://jsfiddle.net/rwaldron/wVqvr/4/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-27T16:16:04.610

用老方法试试

```
if (this.id) { 
    //do something
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-27T16:17:31.037

您可以使用该[`is`方法](http://api.jquery.com/is/)和[Has Attribute Selector](http://api.jquery.com/has-attribute-selector/)：

```
if ($(this).is('[id]')) {

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-31T11:29:05.350

`if ($(this).attr('id')){ alert(id); }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T16:16:27.567

你也可以只使用普通的 js 对象

```
if( this.id !== undefined && this.id.length > 0 ){
 //todo: use id
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T16:19:53.657

HTML：

```
<div class="hey"></div>
<div class="you" id="woah"></div>
<div id="results"></div>​ 
```

jQuery：

```
var id = $('div.hey').attr('id');
if (id) {
    // Have an id.
} else {
    // Don't have an id.
} 
```

小提琴：http: [//jsfiddle.net/NEVYT/](http://jsfiddle.net/NEVYT/)

# delphi - Delphi 中的 DataModule (dm) 是什么？

> ID：12625721
> 
> 赞同：21
> 
> 时间：2012-09-27T16:14:38.390
> 
> 标签：delphi

在您的项目中使用 DataModule 的目的是什么？与普通类或模块相比，它有什么特殊属性吗？它通常用于什么的约定是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-27T16:20:26.077

数据模块是一个非可视“表单”（容器），可以包含非可视组件（通常是数据库组件，尽管可以添加任何组件，例如对话框和[Indy](http://www.indyproject.org/index.en.aspx)组件），然后可以由许多表单共享。

本维基进一步解释：[Delphi](http://delphi.wikia.com/wiki/Data_module) Wiki 。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-27T16:26:36.680

它通常用于 Dataset 和 DataSource 对象，以将它们保存在中心位置。DataModule 上只能包含非可视组件，但不仅限于数据访问组件。你可以在上面放一个 TTimer 和 SaveDialog 等...

当您有多个表单时，它可能很有用，只需要在一个地方更改代码，而不是每个表单。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-27T16:29:14.153

数据模块不同于可以在表单设计器中设计的简单类，并且可以使用对象检查器编辑其组件。数据模块还有一个在 DFM 文件中流式传输的资源。

此外，数据模块可以被其他数据模块、表单和框架使用，然后它的组件也可以在对象检查器中进行选择。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-27T16:26:42.077

在我的桌面应用程序中，我通常有一个包含一堆`TImageList`s 的数据模块。如果我的应用程序使用`TCP/IP`，则组件位于单独的数据模块上。当然，我的应用程序几乎所有的逻辑都放在不同的数据模块中。而且，如果我需要创建一个服务应用程序，我会将我的逻辑放在一个数据模块中，以便我可以轻松地围绕它创建一个桌面应用程序以进行调试。最后，但最不重要的是，我大部分时间都将数据访问组件放在数据模块上。

# vim - 删除时vim切换缓冲区覆盖行为

> ID：12625722
> 
> 赞同：5
> 
> 时间：2012-09-27T16:14:41.660
> 
> 标签：vim, vi

Vim 很棒，但是像很多人一样，当我想复制、删除、然后粘贴时，我真的很生气—— yank 缓冲区被删除操作覆盖了。

现在我知道有 101 种解决方法和映射，其中一些在像这样的帖子中被列举：[任何方式在 vim 中删除而不覆盖你最后的 yank？](https://stackoverflow.com/questions/3638542/any-way-to-delete-in-vim-without-overwriting-your-last-yank)

但是所有这些解决方案都有缺点——即使我是缓冲专家（我不是）。例如，过多的击键——而我通常 xxxx 快速删除 4 个字符（只是一个击键因为我按住它并等待自动重复），我现在切换到 ,x,x,x,x 或无论映射我必须使用不同的缓冲区。

真正理想的是简单的模式切换，您可以切换 D、d、X 和 x 键的副作用行为，以便它们交替执行或不将其文本写入缓冲区。这样我就可以简单地进入“无副作用”模式并删除到心的内容，然后在我准备好时粘贴。如果需要，可以重新启用副作用。

有谁知道这样做的方法？

[更新：解决方案] 好的，我明白了：我编写了一个切换“无副作用”模式的函数......完美运行！请参阅下面我接受的正确答案

[更新 #2] 我的解决方案仍然很有效，当我进行大量删除和粘贴时，我一直使用它。但与此同时，我还找到了一种更轻松的方法来满足复制、粘贴、删除的特定用例，用于要删除的文本是连续的简单情况。

正常拉出文本后，然后我使用 v 命令直观地突出显示要删除的文本，然后使用 p 命令简单地粘贴它。无需任何特殊映射即可达到预期效果。

这个工作流程的唯一问题是，如果我想再次粘贴，原来的粘贴缓冲区会被突出显示的文本粘贴的行为覆盖，但是这种行为很容易通过 .vimrc 中的以下映射进行更改：

```
vnoremap p "_dp
vnoremap P "_dP 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T02:56:49.567

好的，我明白了——.vimrc 中的这个脚本让我可以有效地切换“无缓冲区副作用”模式，当激活“无缓冲区副作用”模式时，d 和 x 键不再覆盖缓冲区。

在 .vimrc 中添加这个

```
function! ToggleSideEffects()
    if mapcheck("dd", "n") == ""
        noremap dd "_dd
        noremap D "_D
        noremap d "_d
        noremap X "_X
        noremap x "_x
        echo 'side effects off'
    else
        unmap dd
        unmap D
        unmap d
        unmap X
        unmap x
        echo 'side effects on'
    endif
endfunction
nnoremap ,, :call ToggleSideEffects()<CR> 
```

然后使用组合键 ,, （两个逗号）切换进入和退出此模式

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-27T17:57:36.417

我认为尝试“关闭”每个删除/更改命令的副作用即使不是不可能也将过于困难。处理这种情况的基本方法：

*   `"_`在您的删除或更改命令中使用黑洞 ( ) 寄存器。例如`"_dd`
*   将`"0`包含最新 yank 的寄存器与您的粘贴命令一起使用。例如`"0p`
*   将文本提取到命名寄存器。例如`"ayy`，后来做`"ap`

我个人倾向于这种`"0p`方法，因为这符合我的思维方式。

现在看到您要求没有这样的变通办法，我提供了一些功能来改变粘贴命令以在我的所谓`paste_copy`和`nopaste_copy`模式之间切换。`nopaste_copy`是 Vim 的默认行为。将以下内容放入您的`~/.vimrc`:

```
function! PasteCopy(cmd, mode)
  let reg = ""
  if exists('g:paste_copy') && g:paste_copy == 1 && v:register == '"'
    let reg = '"0'
  elseif v:register != '"'
    let reg = '"' . v:register
  endif
  let mode = ''
  if a:mode == 'v'
    let mode = 'gv'
  endif
  exe "norm! " . mode . reg . a:cmd
endfunction

command! -bar -nargs=0 TogglePasteCopy let g:paste_copy = exists('g:paste_copy') && g:paste_copy == 1 ? 0 : 1<bar>echo g:paste_copy ? '  paste_copy' : 'nopaste_copy'

nnoremap <silent> p :call PasteCopy('p', 'n')<cr>
nnoremap <silent> P :call PasteCopy('P', 'n')<cr>
nnoremap <silent> ]p :call PasteCopy(']p', 'n')<cr>
nnoremap <silent> [p :call PasteCopy('[p', 'n')<cr>
nnoremap <silent> ]P :call PasteCopy(']P', 'n')<cr>
nnoremap <silent> [P :call PasteCopy('[P', 'n')<cr>
vnoremap <silent> p :<c-u>call PasteCopy('p', 'v')<cr>
vnoremap <silent> P :<c-u>call PasteCopy('P', 'v')<cr> 
```

您可以通过 切换您的 paste_copy 模式`:TogglePasteCopy`。您可能更喜欢这样的映射

```
nnoremap <leader>tp :TogglePasteCopy<cr> 
```

作为最后的一条建议，我强烈建议`"0p`在这种方法上使用或使用命名寄存器，因为它们是 vim 的本机并且需要担心的“模式”更少。

# java - Hibernate CriteriaAPI 和 like 运算符。交换操作数 + 独立于数据库的连接 - 有可能吗？

> ID：12625726
> 
> 赞同：0
> 
> 时间：2012-09-27T16:14:52.477
> 
> 标签：java, sql, hibernate, hibernate-criteria

**介绍**

我有一个奇怪的任务 - 在 Hibernate Criteria API（即数据库独立风格）上编写类似于

```
select * from branch b where '2/5/3/' like b.hier_path + '%' 
```

连接运算符在哪里`+`。连接运算符是 MS SQL 中依赖于数据库的“+”，“||” 在甲骨文等

我必须使用 Criteria API（并且无法切换到 HQL）。

**问题 #1 - 类似运算符**

不幸的是，Hibernate 只允许编写基于 Java 对象属性的 Criteria：

```
pCriteria.createCriteria(Branch.class).add(Restrictions.like("hierarchyPath", "2/5/3/%")); 
```

相当于

```
select * from branch where 'hier_path like 2/5/3/%' 
```

我不知道如何交换 like 运算符的操作数。

**问题 #2 - 独立于数据库的连接**

SQL 代码必须适用于 Oracle、MS SQL Server、DB2、Postgres、Sybase、MySQL、HSQLDB、Firebird（和其他一些新的关系数据库）。

我现在得到的是基于 SQL 的 hack：

```
Restrictions.sqlRestriction("? like concat({alias}.hier_path,'%')", "2/5/3/", Hibernate.STRING) 
```

不幸的是，`concat`上述数据库（Postgres 和 Firebird 除外）中大多数都存在**依赖于数据库的功能。**该方法是一种解决方法，不能用作常量解决方案（我将尝试将自定义函数添加`concat`到没有它的数据库）。

**结论**

有人可以提出改进我的 hack（独立于数据库的 SQL）或更正原始 CriteriaAPI 的建议吗？

**更新 28.09.12**

`concat`函数[出现在 Postgres 9.1](http://www.postgresql.org/docs/9.1/static/functions-string.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T12:02:02.003

您可以编写自己的 Criterion 实现，它会生成一个类似于您在问题中的 SQL 子句，除了它将使用与条件查询关联的方言来获取适当的 concat 函数并将连接委托给这个依赖于数据库的连接函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:18:33.577

谢谢@JB 尼泽。受他的想法启发的代码：

```
private class InverseLikeExpression extends SimpleExpression{
    private static final String CONST_HQL_FUNCTION_NAME_CONCAT = "concat";
    private static final String CONST_LIKE = " like ";
    private static final String CONST_LIKE_SUFFIX = "'%'";

    private final String propertyName;

    protected InverseLikeExpression(String pPropertyName, Object pValue) {
        super(pPropertyName, pValue, CONST_LIKE);
        propertyName = pPropertyName;
    }

    @Override
    public String toSqlString(Criteria criteria, CriteriaQuery criteriaQuery) throws HibernateException {
        String[] columns = criteriaQuery.getColumnsUsingProjection(criteria, propertyName);
        Dialect dialect = criteriaQuery.getFactory().getDialect();
        SQLFunction concatFunction = (SQLFunction) dialect.getFunctions().get(CONST_HQL_FUNCTION_NAME_CONCAT);

        StringBuffer fragment = new StringBuffer();
        if (columns.length>1) fragment.append('(');
        for ( int i=0; i<columns.length; i++ ) {
            String fieldName = concatFunction.render(Arrays.asList(new Object[] {columns[i], CONST_LIKE_SUFFIX}), criteriaQuery.getFactory());
            fragment.append("?").append( getOp() ).append(fieldName);
            if ( i<columns.length-1 ) fragment.append(" and ");
        }
        if (columns.length>1) fragment.append(')');
        return fragment.toString();
    }       
} 
```

# javascript - 反向地理定位问题

> ID：12625728
> 
> 赞同：1
> 
> 时间：2012-09-27T16:15:00.507
> 
> 标签：javascript, html, geocode

**编辑：已解决，使用工作代码更新。谢谢大家！**

我有一个在 jsFiddle 中运行的反向地理定位应用程序，但我似乎无法让它在正常环境中工作。

JS 小提琴：http: [//jsfiddle.net/vd3mK/](http://jsfiddle.net/vd3mK/)

本地代码：

```
<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>​​
        <script>
        var geocoder;
        function initialize() {

            geocoder = new google.maps.Geocoder();
            codeLatLng();
        }

        function codeLatLng() {     
            var input = document.getElementById("latlng").getAttribute('value');
            var latlngStr = input.split(",", 2);
            var lat = parseFloat(latlngStr[0]);
            var lng = parseFloat(latlngStr[1]);
            var latlng = new google.maps.LatLng(lat, lng);
            geocoder.geocode({
                'latLng': latlng
            }, function(results, status) {

                document.getElementById("test").innerHTML = '' + (results[0].formatted_address); + ''
            });
        }
​       </script>   
    </head>
    <body onload="initialize()">        
        <div id="latlng" value="43.4494152,-80.4881973"></div>

        <div id="test"></div>
    </body>
</html> 
```

当本地版本在我的浏览器中运行时，它会给我：“â€‹â€‹â€‹â€‹”。

这是什么原因造成的？我如何解决它？谢谢！

**工作代码**

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>​​
        <script type="text/javascript">
            var geocoder;
            function codeLatLng() {
                var input = document.getElementById("latlng").getAttribute('value');
                var latlngStr = input.split(",", 2);
                var lat = parseFloat(latlngStr[0]);
                var lng = parseFloat(latlngStr[1]);
                var latlng = new google.maps.LatLng(lat, lng);
                geocoder.geocode({
                    'latLng' : latlng
                }, function(results, status) {

                    document.getElementById("test").innerHTML = '' + (results[0].formatted_address);
                    +''
                });
            }

            function initialize() {

                geocoder = new google.maps.Geocoder();
                codeLatLng();
            }
       </script>   
    </head>
    <body onload="initialize();">        
        <div id="latlng" value="43.4494152,-80.4881973"></div>

        <div id="test"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:49:41.400

您需要通过元标记设置页面的编码，但您还需要以**UTF-8****对实际页面（*文件）进行编码。***

# sql - SQL Server 计算表每列中不同值的数量

> ID：12625729
> 
> 赞同：1
> 
> 时间：2012-09-27T16:15:00.407
> 
> 标签：sql, sql-server

我有一个大约 150 列的表。我想`count(distinct(colName))`为每一列找到 ，但我想知道是否有办法在不实际输入每一列名称的情况下这样做。

理想情况下我会使用`count(distinct(*))`，但这不起作用。

还有其他建议吗？

编辑：

如果这是我的桌子：

```
 id         col1         col2        col3      ...
  01         10001       west         north  
  02         10001       west         south  
  03         10002       east         south  
  04         10002       west         north  
  05         10001       east         south  
  06         10003       west         north 
```

我正在寻找这个输出

```
count(distinct(id))   count(distinct(col1))    count(distinct(col2))   count(distinct(col3))
       6                       3                    2                      2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:29:26.947

你可以这样做：

```
DECLARE @query varchar(max)
    SELECT @query = 
    'SELECT ' + SUBSTRING((SELECT ',' +'COUNT(DISTINCT(' + column_name + ')) 
             As ' + column_name + ' '  
             FROM information_schema.columns
             WHERE 
             table_name = 'table_name'
             for xml path('')),2,200000)  +  'FROM table_name'

PRINT(@query) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:38:22.360

使用以下脚本构建 T-SQL 查询，该查询将返回表中每列的不同计数。用您的表名替换`@Table`值。

```
DECLARE @Table SYSNAME = 'TableName'; 

-- REVERSE and STUFF used to remove trailing UNION in string
SELECT REVERSE(STUFF(REVERSE((SELECT 'SELECT ''' + name 
                                     + ''' AS [Column], COUNT(DISTINCT(' 
                                     + QUOTENAME(name) + ')) AS [Count] FROM ' 
                                     + QUOTENAME(@Table) + ' UNION ' 
                              -- get column name from sys.columns  
                              FROM   sys.columns 
                              WHERE  object_id = Object_id(@Table)
                              -- concatenate result strings with FOR XML PATH
                              FOR XML PATH (''))), 1, 7, ';')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-21T16:34:39.760

布莱恩的扩展回答。他的出色答案按字母顺序列出了这些字段。
如果您有十几个字段，这没问题。如果您有 150 个字段，如 OP 所述，这会将字段保持在其表的顺序中。
我修改了他的查询以检查 213 列（供应商的）表，并希望发布以供将来参考。

```
DECLARE @Table SYSNAME = 'Your table name; without schema; no square brackets'; 

-- REVERSE and STUFF used to remove trailing UNION in string
SELECT REVERSE(STUFF(REVERSE((SELECT 'SELECT ' 
        + CAST(column_id AS VarChar(4)) + ' AS [column_id],' -- extra column
        + '''' + name 
        + ''' AS [Column], COUNT(DISTINCT(' 
        + QUOTENAME(name) + ')) AS [Count] FROM ' 
        + QUOTENAME(@Table) + ' UNION ' 
    -- get column name from sys.columns  
    FROM   sys.columns 
    WHERE  system_type_id NOT IN (34,240) AND object_id = Object_id(@Table) 
    ORDER BY column_id -- keeps columns in table order
    -- concatenate result strings with FOR XML PATH
    FOR XML PATH (''))), 1, 7, ';')); 
```

我决定不编辑布莱恩的答案，因为人们通常不需要额外的专栏。
（如果您不添加 column_id 列，则 ORDER BY 无效。我相信这是因为只有最外面的 ORDER BY 才能保证订购最终输出；我希望有一个 msft 参考来证实这一点）

编辑：对字段类型 Image 和 Geography 使用函数 Count 会引发错误。
添加了“system_type_id NOT IN (34,240)”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T16:19:12.907

我不相信只有 MySQL 是可能的。我认为您将不得不使用服务器端语言来获得所需的结果。

使用“DESC TABLE”作为您的第一个查询，然后为每个“字段”行编译您的查询。

* * *

忽略这个，错误的系统标签:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-27T16:24:04.593

这应该这样做：

```
select count(*) from (select distinct * from myTable) as t 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!3/d411f/1)测试。

```
create table Data
(
    Id int,
    Data varchar(50)
)

insert into Data 
select 1, 'ABC'
union all
select 1, 'ABC'

select count(*) 
from (select distinct * from Data) as t 
```

# c++ - Qt Creator - calloc 因内存大而失败

> ID：12625734
> 
> 赞同：4
> 
> 时间：2012-09-27T16:15:29.290
> 
> 标签：c++, c, qt, gcc, calloc

我对 Qt Creator 或其组件之一有疑问。

我有一个需要大量内存（大约 4 GB）的程序，我使用 calloc 来分配它。如果我使用 mingw/gcc（不使用 Qt 框架）编译 C 代码，它可以工作，但是如果我在 Qt Creator 中编译它（使用 C++ 将 C 代码嵌入到 Qt 框架中），使用 mingw/gcc 工具链, calloc 返回一个空指针。

我已经搜索并找到了 qt-pro 选项`QMAKE_LFLAGS += -Wl,--large-address-aware`，它适用于某些情况（大约 3.5GBytes），但如果我超过 4GBytes，它只适用于使用 gcc 编译的 C 代码，而不适用于 Qt。

使用 Qt Creator 编译时，如何使用 calloc 分配所需的内存量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:08:43.190

因此，您的`cigwin`工具链会为您构建 64 位应用程序。可以由 64 位应用程序分配的内存的可能大小是 2 ^(64)字节，远远超过 4Gb。但是 Qt Creator（如果您从 QtSDK 安装它并且没有手动重新配置它）使用 Qt 的工具链，它构建 32 位应用程序。理论上，您可以通过 32 位应用程序分配 4Gb 的内存，但不要忘记，所有库也将加载到此内存中。在实践中，您可以分配大约 3 Gb 的内存，而不是在一个连续的块中。

## 您有 3 种方法可以解决您的问题：

*   重新考虑你的算法。不要分配 4Gb 的 RAM、使用更智能的数据结构或使用磁盘缓存等。我相信如果您的问题*实际上需要*超过 4 GB 的内存来解决，您就不会问这个问题。

*   将 Qt 代码与 C 程序分开。然后，您仍然可以将 64-bit-target-compiler 用于 C 程序，将 32-bit-target-compiler 用于 Qt/C++ 部分。[您可以通过任何进程间通信](https://stackoverflow.com/questions/1008957/interprocess-communication-on-windows)机制与您的 C 程序进行通信。（实际上标准输入/输出流通常就足够了）

*   移动到 64 位。我的意思是，对 C 和 C++ 代码都使用 64 位目标编译器。但这并不像人们想象的那么简单。您需要在 64 位模式下重建 Qt。关闭一些模块和一些代码修复（我试过一次）是可能的，但[Windows 64 位官方不支持](http://qt-project.org/doc/qt-4.8/supported-platforms.html)。

# git - Gerrit 和修改非交互式用户

> ID：12625738
> 
> 赞同：2
> 
> 时间：2012-09-27T16:15:40.157
> 
> 标签：git, gerrit

我使用 ssh (gerrit create-user) 在 Gerrit 中创建了一个本地用户。我想更改用户的正确名称，但找不到任何方法。

我可以更改用户数据还是至少可以删除用户？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-17T20:21:22.127

## 更改全名信息

如果您可以使用该用户登录

1.  转到右上角的“设置”
2.  点击“联系方式”
3.  更新用户的全名

修改数据库中的用户

1.  连接到数据库：`ssh -p 29418 review.example.com gerrit gsql`
2.  找到要修改的用户：`select * from accounts ;`
3.  更新用户数据：`update accounts set full_name = 'Any User Name' where account_id = <X>`

## 删除用户

目前没有简单的方法来删除一个帐户。您需要删除正确表中的引用（没有那么多）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-20T11:34:17.263

添加评论以防有人在为 Gerrit**使用 LDAP 时**难以更改用户名。

当您在 gerrit.config 中通知 accountFullName 设置时，您无法从 UI 更改用户名（尽管似乎如果您将其留空，您将能够，但我没有成功）

我最终做的是将 accountFullName 配置为 ${givenName} ${sn}。

从文档（config.gerrit 的，[https](https://gerrit-documentation.storage.googleapis.com/Documentation/2.8.5/config-gerrit.html) ://gerrit-documentation.storage.googleapis.com/Documentation/2.8.5/config-gerrit.html ）：

“对于 RFC 2307 服务器，默认是 displayName，对于 Active Directory，默认是 ${givenName} ${sn}。”

# jquery - jQuery 1.8 是否改变了 .data() 返回值的方式？

> ID：12625742
> 
> 赞同：2
> 
> 时间：2012-09-27T16:15:55.557
> 
> 标签：jquery

相关问题：[停止 jQuery .data() 转换](https://stackoverflow.com/questions/12622812/stop-jquery-data-from-converting)

根据以下文档`.data()`：

> 每次尝试都将字符串转换为 JavaScript 值（这包括布尔值、数字、对象、数组和 null），否则将其保留为字符串。要将值的属性作为字符串检索而不进行任何转换，请使用 attr() 方法

jQuery 1.7.2 也是如此，但 1.8.2 不进行转换。这是新的预期行为吗？

例如，使用 HTML`<div data-code-name="007">Bond, James</div>`

jQuery v1.7.2 `$("div").data("codeName")`返回 7 示例：http: [//jsfiddle.net/dMHS4/](http://jsfiddle.net/dMHS4/)

jQuery v1.8.2 `$("div").data("codeName")`返回“007”示例：http: [//jsfiddle.net/dMHS4/2/](http://jsfiddle.net/dMHS4/2/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:21:24.927

我认为这回答了你的问题

[http://bugs.jquery.com/ticket/7579](http://bugs.jquery.com/ticket/7579)

他们还有一个测试小提琴[http://jsfiddle.net/dmethvin/8SsWK/](http://jsfiddle.net/dmethvin/8SsWK/)

它表明，如果转换为数字将其从 1.0 更改为 1，那么它现在被视为字符串，而不是数字。如果您在 1.7.2 和 1.8.2 中运行测试，您会看到这种差异

# python - 使用非英文字符的 Google http://maps.google.com/maps/geo 查询

> ID：12625745
> 
> 赞同：3
> 
> 时间：2012-09-27T16:16:06.277
> 
> 标签：python, google-maps, urllib, google-geocoding-api

我正在创建一个 Python（使用`urllib2`）解析器，其中包含非英语字符的地址。目标是找到每个地址的坐标。

**当我在Firefox**中打开此网址时：

```
http://maps.google.com/maps/geo?q=Czech%20Republic%2010000%20Male%C5%A1ice&output=csv 
```

它被转换（地址框中的更改）为

```
http://maps.google.com/maps/geo?q=Czech Republic 10000 Malešice&output=csv 
```

并返回

```
200,6,50.0865113,14.4918052 
```

这是一个**正确**的结果。

**`urllib2`**但是，如果我在（或 Opera 浏览器）中打开相同的 url（编码，使用 %20 等） ，结果是

```
200,4,49.7715220,13.2955410 
```

这是**不正确**的。如何打开第一个 url`urllib2`以获得“ `200,6,50.0865113,14.4918052`”结果？

**编辑：**

使用的代码

```
import urllib2

psc = '10000'
name = 'Malešice'
url = 'http://maps.google.com/maps/geo?q=%s&output=csv' % urllib2.quote('Czech Republic %s %s' % (psc, name))

response = urllib2.urlopen(url)
data = response.read()

print 'Parsed url %s, result %s\n' % (url, data) 
```

输出

`Parsed url http://maps.google.com/maps/geo?q=Czech%20Republic%2010000%20Male%C5%A1ice&output=csv, result 200,4,49.7715220,13.2955410`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:23:43.830

我可以重现这种行为，起初我对它发生的原因感到目瞪口呆。[使用wireshark](http://www.wireshark.org/)对HTTP 请求进行更仔细的检查表明，Firefox 发送的请求（毫不奇怪）包含更多的HTTP-Headers。

最后，结果证明是**`Accept-Language`**标题有所不同。你只有得到正确的结果，如果

*   设置了`Accept-Language`标题
*   **并且**它首先列出了一种非英语语言（优先级似乎无关紧要）

因此，例如，此`Accept-Language`标头有效：

```
headers = {'Accept-Language': 'de-ch,en'} 
```

总而言之，像这样修改您的代码对我有用：

```
# -*- coding: utf-8 -*-
import urllib2

psc = '10000'
name = 'Malešice'
url = 'http://maps.google.com/maps/geo?q=%s&output=csv' % urllib2.quote('Czech Republic %s %s' % (psc, name))
headers = {'Accept-Language': 'de-ch,en'}

req = urllib2.Request(url, None, headers)
response = urllib2.urlopen(req)
data = response.read()

print 'Parsed url %s, result %s\n' % (url, data) 
```

**注意**：在我看来，这是 Google 地理编码 API 中的一个错误。标`Accept-Language`头指示用户代理更喜欢内容的语言，但它不应该对请求的解释方式有任何影响。

# mysql - MySQL中用户定义的sql数据类型

> ID：12625747
> 
> 赞同：-1
> 
> 时间：2012-09-27T16:16:12.153
> 
> 标签：mysql, sql

我想知道是否可以创建用户定义的 sql 数据类型。例如，数据类型可以是“fruit”，然后可能是“apple”、“pear”和“orange”。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:27:46.237

正如foampile所指出的，[这个问题之前已经被问过了](https://stackoverflow.com/questions/3138392/does-mysql-support-user-defined-data-types)。

但是，在您的情况下，您可以使用[ENUM 类型](http://dev.mysql.com/doc/refman/5.5/en/enum.html)：

```
CREATE TABLE my_fruits (
    id INT AUTO_INCREMENT,
    fruit ENUM('apple', 'pear', 'orange'),
    PRIMARY KEY(id)
);

INSERT INTO my_fruits(fruit) VALUES('pear'), ('apple'), ('orange'), ('pear'); 
```

[SQLfiddle 显示用法](http://sqlfiddle.com/#!2/00c3a/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:30:22.030

对于这种情况，您始终可以使用[枚举。](http://dev.mysql.com/doc/refman/5.0/en/enum.html)

例如

```
create table testing_fruits
(fruits enum('apple', 'grapes', 'banana',...)); 
```

但是这种方法的问题是你将不得不一次又一次地使用枚举......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:36:51.120

我意识到我不需要创建新的数据类型。我真正需要做的是创建一个新的“fruits”表，在我的“meal”表中创建一个外键“fruit_type”列，并在 fruits 表中创建“apple”、“pear”和“orange”行。现在，您只能将水果插入到 'meal' 表中，如果它存在于 'fruits' 表中。

# c# - wpf动画问题

> ID：12625749
> 
> 赞同：0
> 
> 时间：2012-09-27T16:16:17.093
> 
> 标签：c#, wpf

我有一个 xaml 视图，其中包含我放入内容控件的动画。在 xaml 背后的代码中，我通过故事板查找资源加载动画。到目前为止这很好。我遇到的问题是在我的 xaml 中有一个按钮从视图模型触发中继命令，执行数据库调用然后提示消息。我想要实现的是当我点击按钮时，我想显示动画，然后当消息框显示时，我想隐藏动画。到目前为止还没有运气。

主视图

```
<ContentControl Name="loader" />

<StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
    <Button Content="Test" Command="{Binding TestCommand, Mode=OneWay}" />
</StackPanel> 
```

主视图.cs

```
public MainView()
{
    InitializeComponent();

    _loading = new LoadingUC();  
    _loaderUC = _loading;         
    showLoading.Content = _loaderUC;

    Storyboard showUC = FindResource("Test_Loading") as Storyboard;
    showUC.Begin(_loaderUC);    
} 
```

测试视图模型

```
public ICommand TestCommand
{
    get
    {
        return _TestCommand ?? (_TestCommand = new RelayCommand(p => TestSave()));
    }
}

private void TestSave()
{
// show loading
    if (SaveSuccessFul() == true)
    {
        //hide loading
        MessageBox.Show("Save Completed");

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:19:08.917

您的 ViewModel 可以在显示消息框之前引发事件。

```
public event EventHandler LoadSuccessful;

private void TestSave()
{
// show loading
    if (SaveSuccessFul() == true)
    {
        //hide loading
        if (LoadSuccessful != null)
           LoadSuccessful(this, EventArgs.Empty);
        MessageBox.Show("Save Completed");

    }
} 
```

视图可以注册到该事件并在收到事件时停止动画。

```
public MainView()
{
    InitializeComponent();

    _loading = new LoadingUC();  
    _loaderUC = _loading;         
    showLoading.Content = _loaderUC;

    Storyboard showNewPatUC = FindResource("Test_Loading") as Storyboard;
    showNewPatUC.Begin(_loaderUC);  
}

void OnLoadSuccessful(object sender, EventArgs args)
{
    Storyboard showNewPatUC = FindResource("Test_Loading") as Storyboard;
    showNewPathUC.Stop();
} 
```

# c# - 在 PHP 中检索从 C# 应用程序发送的 POST 数据

> ID：12625755
> 
> 赞同：1
> 
> 时间：2012-09-27T16:16:38.743
> 
> 标签：c#, php, post, httpwebrequest, httpwebresponse

这样做时偶然发现了一个问题，我首先搜索了 SO 以尝试查找其他人是否有类似的问题，并发现了这个问题：[POST data to a PHP page from C# WinForm](https://stackoverflow.com/questions/304337/post-data-to-a-php-page-from-c-sharp-winform)

但是，当我尝试这个问题的答案中给出的代码示例时，它不起作用。我发出请求的 PHP 脚本会响应一条消息，指示未设置必须设置的 POST 变量。这是我的 C# 代码：

```
HttpWebRequest POSTreq =
    (HttpWebRequest)WebRequest.Create("http://82.41.255.140/api/post-ptr");

string POSTdata = "action=" + HttpUtility.UrlEncode("date");
byte[] data = Encoding.ASCII.GetBytes(POSTdata);

POSTreq.Method = "POST";
POSTreq.ContentType = "application/x-www-form-urlencoded";
POSTreq.ContentLength = data.LongLength;

POSTreq.GetRequestStream().Write(data, 0, data.Length);

HttpWebResponse POSTres = (HttpWebResponse)POSTreq.GetResponse();
Console.WriteLine("HTTP Status Code {0}", POSTres.StatusCode);
Console.WriteLine("Response Method: {0}", POSTres.Method);
Console.WriteLine("Response Text: {0}",
    new StreamReader(POSTres.GetResponseStream()).ReadToEnd());
Console.ReadLine(); 
```

这是 PHP 脚本中的代码：

```
<?php    
    $A = strtolower($_POST["action"]);

    if ($A == "date")
    {
        echo date("c");
    }
    else if ($A == "ip")
    {
        echo $_SERVER["REMOTE_ADDR"];
    }
    else if ($A == null || $A == "")
    {
        echo "bad_request:no_argument:POST_action";
    }
    else
    {
        echo "bad_request:invalid_argument:POST_action";
    }

    exit();
?> 
```

当我从 C# 程序发出 POST 请求时，我看到以下屏幕，表明`action`尚未设置变量。我错过了我的代码中的明显内容吗？

![屏幕](../Images/e9218034f5e360776a75376efc818352.png)

感谢回复的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:20:23.450

您可能需要刷新流。我通常这样做：

```
string POSTdata = "action=" + HttpUtility.UrlEncode("date");
byte[] data = Encoding.ASCII.GetBytes(POSTdata);

POSTreq.Method = "POST";
POSTreq.ContentType = "application/x-www-form-urlencoded";
POSTreq.ContentLength = data.LongLength;

using (Stream stream = POSTreq.GetRequestStream()) {
    stream.Write(data, 0, data.Length);
    stream.Flush();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:27:23.017

您没有关闭请求流。请参阅[MSDN 文档中的此示例，该示例](http://msdn.microsoft.com/en-us/library/d4cek6cc.aspx)与您的代码非常接近。

**编辑**

您的 PHP 空值检查也不正确。 [见这篇文章](https://stackoverflow.com/questions/8236354/php-is-null-or-empty)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:23:25.360

我发现了问题。

事实证明，我`/`在请求中省略了尾随，并且请求得到了 301，无论出于何种原因，它都删除了 post 变量。

`http://82.41.255.140/api/post-ptr`本来应该如此`http://82.41.255.140/api/post-ptr/`。

感谢所有回答的人，我已经 +1 了。

# javascript - uiwebview javascript 不返回

> ID：12625758
> 
> 赞同：2
> 
> 时间：2012-09-27T16:16:56.343
> 
> 标签：javascript, objective-c, uiwebview, return-value

有一个奇怪的行为。在`UIWebView`我有一个 javacript 函数来检测元素的位置。这个：

```
function getPosition(element){

    var el = element;
    var pos = [el.offsetLeft, el.offsetTop];
    var parent = el.offsetParent;
    if (parent != el) {
        while (parent) {
            pos[0] += parent.offsetLeft;
            pos[1] += parent.offsetTop;
            parent = parent.offsetParent;
        }
    }
    //alert(pos);
    return pos;
} 
```

没什么特别的……但是当我这样调用函数时：

```
NSString *position = [browserWebView stringByEvaluatingJavaScriptFromString:@"getPosition(document.getElementById('exampleElement'));"]; 
```

我得到一个空的`NSString`背部。当我在函数中插入警报（现在取消注释）时，我在警报中得到了正确的位置！！

`pos`当正确的返回值似乎存在时，为什么我没有取回值并只得到一个空字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T18:56:57.433

这对我来说相当简单，同时也是一个完全的谜。我不知道为什么，但是**“stringByEvaluatingJavaScriptFromString：”**喜欢 javascript 结果已经类似于字符串。要修复您的代码，只需在返回数组中添加一个 join() 函数：

```
return pos.join(); 
```

这会将数组连接成单个字符串，并且它将作为 NSString 传递没有问题。

我认为警报起作用的原因是它不会破坏以类似方式显示数据的网站。

# javascript - javascript canvas检测点击形状

> ID：12625766
> 
> 赞同：17
> 
> 时间：2012-09-27T16:17:21.583
> 
> 标签：javascript, function, events, canvas, click

我在javascript中的点击功能有问题。这是我的代码：

```
var canvas = document.getElementsByTagName("canvas")[0];
var ctx = canvas.getContext('2d');

BigCircle = function(x, y, color, circleSize) {
    ctx.shadowBlur = 10;
    ctx.shadowColor = color;
    ctx.beginPath();
    ctx.arc(x, y, circleSize, 0, Math.PI * 2, true);
    ctx.fill();
    ctx.closePath();
};

var bigGreen = new BigCircle(1580, 800, '#5eb62b', 180);

function init() {
    $("#bigGreen").click(function(e){
    alert("test");              
    });
}
$(document).ready(function() {
    init();
}); 
```

但是点击事件不起作用！有人知道为什么吗？非常感谢您！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-01-14T14:39:55.613

您现在可以在 Chrome 和 Firefox 中使用命中区域：

[https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Hit_regions_and_accessibility#Hit_regions](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Hit_regions_and_accessibility#Hit_regions)

```
ctx.beginPath();
ctx.arc(70, 80, 10, 0, 2 * Math.PI, false);
ctx.fill();
ctx.addHitRegion({id: "bigGreen"}); 
```

并添加回调

```
canvas.onclick = function (event)
{
    if (event.region) {
        alert('You clicked ' + event.region);
    }
} 
```

或者只使用众多画布 API 之一：

[http://www.fabricjs.com/](http://www.fabricjs.com/)

[http://www.createjs.com/easeljs](http://www.createjs.com/easeljs)

[http://www.paperjs.org](http://www.paperjs.org)

ETC...

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-27T16:35:07.580

没有看到你的 html 这个问题有点不清楚，似乎你想在画布上绘制一些东西并使用 jquery 为圆圈添加点击事件，这是不可能的。

您可以使用 jquery 在画布上获取单击事件，并从光标位置计算用户是否单击了圆圈，但 jquery 不会帮助您，您必须自己进行数学计算。

jquery 仅适用于 dom 元素。

```
BigCircle = function(ctx,x, y, color, circleSize) {
    ctx.beginPath();
    ctx.arc(x, y, circleSize, 0, Math.PI * 2, true);
    ctx.fillStyle=color
    ctx.fill();
    ctx.closePath();
    this.clicked=function(){
      ctx.fillStyle='#ff0000'
      ctx.fill();
    }
};

function init() {
  var canvas = document.getElementsByTagName("canvas")[0];
  var ctx = canvas.getContext('2d');
  var bigGreen = new BigCircle(ctx,50, 50, '#5eb62b', 50);
  $('#canvas').click(function(e){
    var x = e.clientX
      , y = e.clientY          
    if(Math.pow(x-50,2)+Math.pow(y-50,2) < Math.pow(50,2))   
      bigGreen.clicked()
  })    
}

$(document).ready(function() {
    init();   
}); 
```

​</p>

jsfiddle 在这里 [http://jsfiddle.net/yXVrk/1/](http://jsfiddle.net/yXVrk/1/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-12-28T22:58:32.687

Canvas API 函数**isPointInPath** () 可用于辅助命中检测。这个函数至少可以判断鼠标坐标是否在一个复杂的形状内，而无需自己进行复杂的数学运算。也可以用于简单的形状，但我的用例是用于贝塞尔曲线路径。但是，您需要将此函数合并到绘图逻辑中以在路径打开时进行测试，或者保留一组 Path2d 对象以进行测试。我在 onClick 处理程序上重绘并从事件参数中传递鼠标坐标，但我认为我可以保留一个 Path2d 对象数组。

[https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/isPointInPath](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/isPointInPath)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T16:40:24.560

bigGreen 不在 HTML 中，因此 $("#bigGreen") 不选择任何内容。你不能在 JavaScript 函数之类的东西上添加点击函数；既然它们在 DOM 中不存在，你怎么能点击一个呢？您应该用#canvas 替换#bigGreen，因为“canvas”是您的HTML 元素。

我叉了你的小提琴在[这里](http://jsfiddle.net/JjRpN/)展示这个。

**编辑**：如果你想看到用户点击了一个特定的圆圈，你可以使用画布点击事件，然后，通过传递给点击事件的坐标来确定哪个圆圈被点击。

# c# - 将值保存在缓存 Windows 8 应用程序 Metro 中

> ID：12625767
> 
> 赞同：0
> 
> 时间：2012-09-27T16:17:23.873
> 
> 标签：c#, caching, microsoft-metro

我使用一个返回国家列表的网络服务{名称，人口，表面，iscapital等..}。

我需要将它放在应用程序 Metro 的缓存中，以避免每次都调用 Web 服务。

我如何在 Windows 8 中做到这一点？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:56:28.587

您可以创建一个列表/数组来存储这些项目。当您的应用程序被暂停时，您应该坚持这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T03:44:54.543

您应该使用`LocalStorage`，这将帮助您在应用程序中持久化对象。阅读本文： [在 Windows 8 Metro Apps 中将本地存储与 C# 和 XAML 结合使用](http://www.codeguru.com/csharp/.net/using-local-storage-with-c-and-xaml-in-windows-8-metro-apps.html)

# jquery-mobile - jquery mobile复选框显示问题

> ID：12625773
> 
> 赞同：1
> 
> 时间：2012-09-27T16:17:49.603
> 
> 标签：jquery-mobile, checkbox

请帮助我。我是 CSS 和 jQuery Mobile 的新手，我遇到了这个问题。

我页面中的复选框不显示该框；只有标签。当我单击标签时，左侧会出现一个正方形。

现在，只有当我将 CSS 文件下载到本地文件并引用它时，才会出现问题。如果我直接从服务器引用 CSS 文件，则该框会出现在文本之前并且可以正常工作。以下是示例来源：

**有错误的来源：**

```
<!DOCTYPE HTML> 
<html>
    <head>
        <title>Mobile App Login</title> 
        <meta name=viewport content="user-scalable=no,width=device-width">
        <link rel="stylesheet" href="../jQuery/jquery.mobile.css">
        <script src="../jQuery/jquery.js"></script>
        <script src="../jQuery/jquery.mobile.js"></script>
    </head>
    <body>
        <div data-role=page id=home>

            <div data-role=header>
                <h1>Login Screen</h1> 
            </div>

            <div data-role=content>
                <label>
                    <input type="checkbox" name="checkbox-0" /> 
                    I agree 
                </label>
                <input type="checkbox" name="checkbox-1" id="checkbox-1" class="custom" />
                <label for="checkbox-1">I agree</label>
            </div>
        </div>
    </body>
</html> 
```

**没有错误的来源：**

```
<!DOCTYPE HTML>
<html>
    <head>
        <title>Mobile App Login</title>
        <meta name=viewport content="user-scalable=no,width=device-width" />
        <link rel="stylesheet"  href="http://jquerymobile.com/test/css/themes/default/jquery.mobile.css" />
        <script src="../jQuery/jquery.js"></script>     
        <script src="../jQuery/jquery.mobile.js"></script>
    </head>
    <body>
        <div data-role=page id=home>

            <div data-role=header>
                <h1>Login Screen</h1>
            </div>

            <div data-role=content>
                <label>
                    <input type="checkbox" name="checkbox-0" /> 
                    I agree 
                </label>
                <input type="checkbox" name="checkbox-1" id="checkbox-1" class="custom" />
                <label for="checkbox-1">I agree</label>
            </div>
        </div>
    </body>
</html> 
```

其他一切正常；只是盒子的显示导致了我的问题。我获取了 CSS 和 JS 文件的最新文件并进行了检查。

没有盒子，用户可能会认为它只是一个标签

由于我是新人，无法提供图片，对不起...

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:17:21.747

为我在字段集中添加复选框解决了同样的问题。

```
<fieldset data-role="controlgroup">
  <input type="checkbox" name="checkbox-2" id="checkbox-2" class="custom" />
  <label for="checkbox-2">I agree</label>
</fieldset> 
```

# .net - 如何在sql server表中查找表列的所有子项？

> ID：12625775
> 
> 赞同：1
> 
> 时间：2012-09-27T16:17:53.050
> 
> 标签：.net, sql, sql-server-2008

我有一个 sql 数据库表

```
CREATE TABLE [dbo].[LedgerGroups](
    [GroupName] [varchar](50) NOT NULL primary key,
    [GroupParent] [varchar](50) NULL
) 
```

表中的记录是

***`-----GroupName------ ---GroupParent---`***

```
Bangalore Customers    Karnataka Customers
Chennai Customers      Tamilnadu Customers
Customers              NULL
Ernakulam Customers    Kerala Customers
Hubli Customers        Karnataka Customers
Karnataka Customers    Customers
Kerala Customers       Customers
Kollam Customers       Kerala Customers
Nagercoil Customers    Tamilnadu Customers
Suppliers              NULL
Tamilnadu Customers    Customers
Tirunelveli Customers  Tamilnadu Customers 
```

我如何查询表以便我可以获得特定值的所有子项。例如，如果我给`Customers`它应该返回其父级是客户及其子级的子级的所有行，依此类推..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T17:58:28.983

这应该这样做：

```
DECLARE @Group VARCHAR(50)
SET @Group = 'Karnataka Customers'

;WITH CTE AS
(
  SELECT *
  FROM [dbo].[LedgerGroups]
  WHERE GroupParent = @Group
  UNION ALL
  SELECT B.*
  FROM CTE A
  INNER JOIN [dbo].[LedgerGroups] B
  ON A.GroupName = B.GroupPArent
)
SELECT *
FROM CTE
OPTION(MAXRECURSION 0); 
```

这[是一个工作的 sqlfiddle](http://sqlfiddle.com/#!3/4c270/9)供您尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:23:25.107

您可以将表连接到自身。此查询将返回所有父母和他们可能关联到的任何孩子：

```
SELECT Parent.GroupName, Parent.GroupParent
,Children.GroupName, Children.GroupParent
from LedgerGroup as Parent
LEFT JOIN LedgerGroup as Children on Parent.GroupName = Children.GroupParent
--  WHERE Parent.GroupName = '' 
```

# reporting-services - 在 Reporting Services 的页眉上显示来自数据集的不同隐藏文本框

> ID：12625777
> 
> 赞同：1
> 
> 时间：2012-09-27T16:17:59.693
> 
> 标签：reporting-services, textbox, header, ssrs-tablix

在我的报告中，我有根据 SP 上的参数出现的矩阵。每个矩阵都有一个特定的“代码”/描述，我想相应地显示在页眉上。

我尝试使用 an`<<Expr>>`但效果不佳，因为它只显示数据库的第一条记录而不是特定矩阵的代码。

然后我发现我可以用“ `=ReportItems!TextBoxXX.Value`”显示一个特定的文本框，所以我向每个矩阵添加了隐藏的代码值。

现在我想在 TextBox 内的页眉中添加所有值的串联，但这没有用，我得到了：

```
"The value expression for the textrun "textboc11.Paragraphs[0].TextRuns[0]" refers to more than one report item. An expression in a page header or footer can refer to only one report item. 
```

因此，我的下一次尝试包括添加单独的文本框，每个文本框都有所需的文本框值，一个在另一个之后（如一堆文本框）。现在一切正常，除了每个文本框占用的“空间”出现在报告中，显示所需的值和渲染时每个文本框上方的空白。

关于如何防止这种行为的任何想法？也许用文本框创建一个数组并创建一个 IIF 或者我不知道，我已经搜索了好几天，似乎没有什么是好的方法。

我希望有人能给我一些建议，我自己解释一下。

谢谢！

# jquery - 在 JQuery 中检查视口

> ID：12625779
> 
> 赞同：0
> 
> 时间：2012-09-27T16:18:07.863
> 
> 标签：jquery, jquery-ui, viewport

我有一个导航栏，可以在页面上下移动时调整大小。在页面顶部，它不应该缩小，但确实会缩小。我需要检查用户是否位于页面顶部并且不缩小导航栏。这是代码：

```
<script type="text/javascript">
     $('#brand_logo').on('inview mouseenter', function(event, visible) {
    if (visible === true) {
         console.log("I got my eye on it Charlie");
        $("#topnav").animate({
            opacity: 1.0,
            width: '98%',
            height: '38px'
        });
        // $(".head-wrap-left").hide();
    } else {
         console.log("Let's set the mood.");

        $("#topnav").animate({
            opacity: 0.9, //0.6 original
              width: '310px',
              height: '33px'

        });
        $("#topnav_behind").slideUp();

        $('#topnav').bind({
                    mouseenter: function() {
                        $("#topnav").animate({opacity: 1.0, width: '98%', height: '38px'});
                    },
                    mouseleave: function() {
                           $("#topnav").animate({opacity: 0.9, width: '310px', height: '33px'});
                    }
                    });
        }});

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:23:01.313

可能重复：[https ://stackoverflow.com/a/473010/1250044](https://stackoverflow.com/a/473010/1250044)

```
$.extend($.expr[':'], {
    inView: function(a) {
        var st = (document.documentElement.scrollTop || document.body.scrollTop),
            ot = $(a).offset().top,
            wh = (window.innerHeight && window.innerHeight < $(window).height()) ? window.innerHeight : $(window).height();
        return ot > st && ($(a).height() + ot) < (st + wh);
    }
}); 
```

# svn - SVN 状态并忽略文件夹

> ID：12625782
> 
> 赞同：3
> 
> 时间：2012-09-27T16:18:15.843
> 
> 标签：svn, svnignore

> **可能重复：**
> [如何使用 SVN 忽略目录？](https://stackoverflow.com/questions/116074/how-to-ignore-a-directory-with-svn)

我正在尝试执行 svn 状态以查看我尚未提交的文件，但是有一个名为 'phpunit' 的文件夹，我想忽略该文件夹，这可能吗？

谢谢，J

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:28:09.347

请参阅 SVNBook 文章[“忽略未受版本控制的项目”](http://svnbook.red-bean.com/en/1.7/svn.advanced.props.special.ignore.html)。

您要查找的命令： `svn propset svn:ignore "phpunit" .`

请参阅[`svn propset`参考资料](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.propset.html)。

# jquery - 将元素附加或添加到页面正文

> ID：12625784
> 
> 赞同：1
> 
> 时间：2012-09-27T16:18:17.963
> 
> 标签：jquery, iframe, google-chrome-extension

我正在尝试将 div 从`content_script`. 我用下面的代码试了一下：

**方法一：**

```
$('body').prepend('<div  id="topbar"></div >'); 
```

**方法二：**

```
$('html:not(:has(parent)) > body:first').prepend('<div  id="topbar"></div >');
// Several other similar approaches. 
```

但这里的问题是，它将这个 div 注入到所有发现的主体它（jquery 选择器）中。**即**如果一个页面包含一个`iframe`then，这个div 也会被注入到它，因为ifrmae 包含一个body。

实际上，`Approach 2`上面显示的在普通脚本/网络文件中运行良好，但在 chrome 的`content_script`. 请帮我解决这个问题。

**内容脚本：**

```
var jqueryScript = "Javascript/References/jquery-1.7.min.js";
var topBarPage = "TopBar.html";

// Handle the requests.
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
    if(request.method == "dockPopup"){
        injectPopupToPage();
        sendResponse({});
    }
    else if(request.method == "undockPopup"){
        removePopupFromPage();
        sendResponse({});
    }
    else{
        sendResponse({});
    }
});

// Add the popup/topbar to page
function injectPopupToPage(){

    // Create script element
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = chrome.extension.getURL(jqueryScript);

    // Append jquery to page header.
    $('head').append(script);

    // Move the page down. >>>>>>>>>>>> Tried with various ways with no luck!!!!
    $('body').css('marginTop','39px');
    $('body').css('padding-top','64px');

    // Append the top bar to page.
    $('body').prepend('<div  id="topbar"></div >');
    $('#topbar').load(chrome.extension.getURL(topBarPage));

    $('#topbar').css({
        'background-color': '#FBC619',
        'position':'fixed',
        'left':'0',
        'top':'0',
        'width':'100%',
        'z-index':'9999'
    });
}

// Remove the Popup/Topbar from page.
function removePopupFromPage(){
    $('#topbar').remove();
    $('body').removeAttr('style');
} 
```

**清单.json**

```
{
 "name": "Inject",
 "manifest_version": 2,
 "version": "0.0.0",
 "description": "Inject.",
 "browser_action": {
   "default_popup": "Popup.html"
 },
 "permissions": [
   "tabs",
   "chrome://favicon/",
   "http://*/*", 
   "https://*/*"
 ],
 "content_scripts": [
  {
    "matches": ["http://*/*"],
    "js": ["Javascript/References/jquery-1.7.min.js","Javascript/content_script.js"],
    "run_at": "document_start",
    "all_frames": true
  }
 ],
  "web_accessible_resources": ["TopBar.html","Javascript/TopBar.js","Javascript/References/jquery-1.7.min.js"]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T18:18:27.883

你可以试试：

```
$(document.body).prepend('<div  id="topbar"></div >'); 
```

由于您直接引用主文档（您需要向下遍历以获取 iframe 的主体），因此它实际上无法选择除主`<body>`元素之外的任何内容。事实上，你没有选择任何东西。您只是将 jQuery 对象机制包装在常规的旧 JS 对象周围。

如果您*仍然*有问题，我不知道该告诉您什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:02:01.157

[正如Rob W](https://stackoverflow.com/users/938089/rob-w)在评论中指出的那样，我需要在文件中设置`all_frames`false 。`manifest.json`

这是修改后的**manifest.json**文件：

```
{
 "name": "Inject",
 "manifest_version": 2,
 "version": "0.0.0",
 "description": "Inject.",
 "browser_action": {
   "default_popup": "Popup.html"
 },
 "permissions": [
   "tabs",
   "chrome://favicon/",
   "http://*/*", 
   "https://*/*"
 ],
 "content_scripts": [
  {
    "matches": ["http://*/*"],
    "js": ["Javascript/References/jquery-1.7.min.js","Javascript/content_script.js"],
    "run_at": "document_start",
    "all_frames": false
  }
 ],
  "web_accessible_resources": ["TopBar.html","Javascript/TopBar.js","Javascript/References/jquery-1.7.min.js"]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:22:16.053

```
$('body:first').prepend('<div  id="topbar"></div >');
$('body').first().prepend('<div  id="topbar"></div >');
$('body').eq(0).prepend('<div  id="topbar"></div >'); 
```

all 给你第一个身体元素。

# javascript - js 函数会接受一个对象数组来代替它的争论吗？

> ID：12625785
> 
> 赞同：1
> 
> 时间：2012-09-27T16:18:18.360
> 
> 标签：javascript, function

我有一个带有 X 参数的函数。我很好奇函数是否会接受一个包含 args 的对象并且仍然可以正常工作。

例子：

```
 var x = 0;
  var y = 0;
  var z = "test";
  someFunction(x,y,z); 
```

对比

```
 var obj = new Object();
  obj.x = 0;
  obj.y = 0;
  obj.Z = "test";
  somefunction(obj); 
```

对比

```
 var obj = new Array();
  obj.push(0);
  obj.push(0);
  obj.push("test");
  somefunction(obj); 
```

我知道你可以对其进行编程来处理它，但我很好奇函数是否能够接受不同格式的参数，只要它们都在那里。

**编辑：**

将对象收集在一起时，我似乎遇到了各种各样的语法错误。我是什么意思？我的意思是我有一些接受一些参数的*函数*，包括回调.....所以当试图写出来，并将所有的参数/回调放在一个数组中做**somefunction.apply(objArray)**时，它在添加项目时出错进入集合。我这样做的方式是：

```
 x = new Array();
 x = [url, 
function(){
    displayFile(url, 'image', null, ft_id, null, null, null, null, !MA.isiOS());
}, 
function(e){
    if(DEBUG) console.log('Error creating gallery thumbnail');
    alert('There was a problem creating a thumbnail');
    MA.hideMessage();
}
  ];
  newArray.push(x); 
```

它似乎搞砸了 x 定义设置。这种方法不喜欢这样设置回调吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:19:38.213

如果`obj`是 Array 版本，它将使用[`Function.prototype.apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply).

```
somefunction.apply(window, obj); 
```

参数将作为个人传递

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:42:27.917

大多数 JavaScript 函数将参数视为可选，如果没有传递参数，它们将简单地设置为`undefined`，因此无论类型如何，您的函数都会被调用并尽其所能执行其任务。也就是说，您*可以*预测并防止某些明显的问题：

```
function moo(a,b)
{
    console.log(a + ' & ' + b);
}
moo('cat','dog');//logs cat & dog
moo();//logs undefined & undefined
moo({name1:'catbert',name2:'dogbert'});//logs [object Object] & undefined 
```

正如您所看到的，在很多情况下您的函数可能会表现不佳，或者根本不会......为了解决这个问题，您可以像这样编写函数：

```
function moo(a,b)
{
    if (a instanceof Array)
    {
        return moo.apply(this,a);
    }
    if (a instanceof Object)
    {
        args = [];
        for (n in a)
        {
            if (a.hasOwnProperty(n))
            {
                args.push(a[n]);
            }
        }
        return moo.apply(this,args);
    }
    a = a || 'No argument a';//set default value for falsy arguments
    b = b || 'No argument b';
    console.log(a + '&' + b);
} 
```

这有点冗长，但是这样，您的函数可以处理两个意外参数：

```
moo({name1:'catbert',name2:'dogbert'});//logs catbert & dogbert
moo();//logs No argument a & no argument b
moo(['foo','bar']);//foo & bar
//and of course:
moo('cow','bull');//still works 
```

还要记住，任何*额外*的参数都将被忽略，所以

```
moo('cow','bull','sheep');//sheep is ignored 
```

好吧，事实上，您仍然可以得到任何未在函数定义中定义的参数：

```
function noArgs()
{
    var argumentArray = Array.prototype.slice.call(arguments);
    //or = Array.prototype.slice.apply(arguments,[0]);
    console.log(argumentArray);
}
noArgs(1,2,3);//logs [1,2,3] 
```

请注意，尽管`arguments`对象确实具有长度属性，并且可以让您像数组 ( `arguments[0]`) 一样访问每个参数，但它不是数组！这就是为什么你必须使用`Array.prototype.slice.call(arguments)`. 这将返回一个数组，其中包含传递给函数的所有参数。

* * *

只是一个旁注：最好不要使用`new Array()`构造函数调用来实例化一个新的数组对象，只需使用文字符号：`[2,3,4,5]`. 对于对象也是如此：`{bar:'foobar'}`.
尤其是数组构造函数。当您想要一个看起来像的数组时，看到它可能会导致问题`[123]`（`new Array(123)`返回一个具有 123 个索引的数组，全部设置为`undefined`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:20:33.110

是的，它将接受任何格式..但您的函数`somefunction`应该处理所有这些格式。

另外，是否将其传递到那里也没关系..

```
function someFunction(a,b,c,d) {
   alert(a + ' ' + b + ' ' + c + ' ' + d)
}

someFunction();  // alerts undefined undefined undefined undefined
someFunction({a: 'test'}, 10, 20, 30); //alerts [Object object] 10 20 30 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T16:23:06.620

您可以这样做，但您必须通过变量名访问参数的属性。像这样

```
var obj = new Object();
obj.x = 0;
obj.y = 0;
obj.z = "test";
somefunction(obj);

function somefunction(param) {
    param.x; //0
    param.y; //0
    param.z; //test
} 
```

您还可以使用变量访问函数参数`arguments`。

```
function somefunction() {
    var param = arguments[0];
    param.x; //0
    param.y; //0
    param.z; //test
} 
```

在本地，*不*，你不能。有关解决方案，请参阅**user1689607**的答案。

# audio - 如何使用 openAL (java) 重新加载 wav 文件

> ID：12625787
> 
> 赞同：1
> 
> 时间：2012-09-27T16:18:31.473
> 
> 标签：audio, reload, wav, openal, java-3d

我编写了一个加载 .wav 文件的应用程序，但它只加载一次。我希望能够在第一首曲目结束后重新加载 wav 文件。我怎样才能在 java 中做到这一点？另外，如果我在曲目结束后（加载所选曲目时）两次点击播放，它会抛出一个

```
IllegalThreadStateException.
 if (threadStatus != 0 || this != me)
            throw new IllegalThreadStateException(); 
```

我用来加载文件的代码是这样的：

```
OpenAL openal = new OpenAL();

source = openal.createSource(new File(Audioplayer.path));
System.out.println(source.toString());
source.play();
source.setGain(0.75f);      // 75% volume
source.setPitch(0.85f);     // 85% of the original pitch
source.setPosition(0, 0, 0); // -1 means 1 unit to the left
source.setLooping(false);    // Loop the sound effect
j=source.getBuffer();
System.out.println(j);
for (i=1;i<=10000;i++){
    Thread.sleep(1);        // Wait for 10 seconds
}
Thread.sleep(10000);        // Wait for 10 seconds
source.close();
openal.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:54:14.790

只需用一个循环包围该区域，每次完成时它都会重新加载那段代码。

# json - 哪些推文不是推文？

> ID：12625803
> 
> 赞同：0
> 
> 时间：2012-09-27T16:19:16.457
> 
> 标签：json, twitter

[`sample`](https://dev.twitter.com/docs/api/1.1/get/statuses/sample)我已经使用api抓取了大量推文。那太棒了。我知道如何“抓取”实际上是删除推文通知的推文，但是还有很多其他情况，谁知道何时会添加另一个？[这些案例实际上在这里](https://dev.twitter.com/docs/platform-objects/tweets)提到：

> 推文可以嵌入、回复、收藏、不收藏、转发、取消转发和删除。

我怎么知道我有一个 POTO（普通的旧 Twitter 对象）而不是删除、收藏等？

*是否有一个标准流程可以识别这一点？*例如，`Delete`推文以开头，`{"delete":{....`因此我可以将其作为字符串进行匹配，或者尝试将其作为键查找（在 JSON-Simple 上，它是这样[做](http://code.google.com/p/json-simple/wiki/DecodingExamples#Example_5_-_Stoppable_SAX-like_content_handler)的）。如果所有的 POTO 都开始 了，那该有多好，`{"tweet":{....`然后我可以将它们挑选出来，而不必丢弃任何不是 POTO 的东西（需要对每个非 POTO 进行检查）。

我可以只使用密钥检查器来查找我需要的*每个*密钥，并希望它是相关且正确的（例如，推文正文和推文/用户都有一个`id`，除非它是一个删除然后它是一个`id`和`user_id`。你需要进入`entities`）。但是，如果我使用*[Storm](https://github.com/nathanmarz/storm/wiki)*（我最终会使用），我可能会在稍后插入一个[螺栓](https://github.com/nathanmarz/storm/wiki/Tutorial#bolt)，然后我必须回去更改我的支票。

那么，有没有一种简单的方法来区分推文是推文（POTO）而不是其他东西？

# facebook - Facebook 优惠是否有固定链接？

> ID：12625804
> 
> 赞同：0
> 
> 时间：2012-09-27T16:19:17.140
> 
> 标签：facebook

我刚刚发现了 Facebook Offers，这看起来很有趣。我知道如何创建一个，我的问题是，一旦创建，它是否有永久链接？我想从我博客中的链接链接到此 Facebook 优惠。

谢谢 Themos

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:59:46.460

是的，它创建了一个永久链接。

例如，这里有一个百吉饼店[提供的 Facebook 优惠的永久链接。](https://www.facebook.com/einsteinbros/posts/10150654432142417)

当您创建报价时，它确实会获得一个永久序列化链接，您可以在 Facebook 之外共享该链接（因此是`Sharing`实用程序）。根据此[Facebook 文档](http://www.facebook.com/help/?faq=404498446244125#How-do-I-stop-an-offer-I%27m-running?)，您可以`stop`提供报价，并且该链接仍然可用/可见，但没有人可以索取报价。您可以`delete`提供和永久链接很可能是 404。

资源：有关更多信息和详细查看 Facebook 优惠，我发现此[博客条目](http://www.marismith.com/facebook-launches-facebook-offers-for-businesses/)很有帮助。

# iphone - ios 从 nsmutable 数组中删除对象并重新索引数组

> ID：12625806
> 
> 赞同：1
> 
> 时间：2012-09-27T16:19:19.057
> 
> 标签：iphone, ios, nsmutablearray

从 nsmutable 数组中删除对象并重新索引数组的最佳方法是什么？我的意思是重新索引例如：

在 20 个对象的数组中，我删除了索引为 11 的对象。我有 19 个对象，但索引 11 上的对象将为零。我想要的是拥有 0..18 的 19 个对象的数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:22:45.577

你可以使用

```
- (void)removeObjectAtIndex:(NSUInteger)index 
```

它将自动重新索引数组，因为“所有超出的元素`index`都通过从索引中减去 1 来移动”。

有关详细信息，请参阅[NSMutableArray 类参考](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/removeObjectAtIndex%3a)。

# java - 队列数据结构的Java数组表示

> ID：12625807
> 
> 赞同：4
> 
> 时间：2012-09-27T16:19:19.337
> 
> 标签：java, arrays, queue

我试图通过用一维数组表示它来创建一个队列。我知道人们可能会建议我使用列表甚至默认的 java 队列对象会更轻松，但我是来学习的，所以我不想求助于如此简单的解决方案。到目前为止，我的实现遇到了一些问题：

1.  如果队列已满，则无法添加对象。
2.  移动物体。

例如 QueueArray -> [ ], [A], [B] 移动它，使其最终如下： QueueArray -> [A], [B], [ ]

现在听我说，问题编号 1#。我的逻辑思维告诉我以某种方式增加队列数组的大小以便能够接收更多对象，事情是我不确定如何在不将所有对象保存到另一个临时数组然后将它们复制到新的更大尺寸的数组。我什至不确定这是否是一种明智可行的方式来执行此操作。

问题 2# 我在想可能只是检查队列数组中的空对象，如果找到它们，只需将元素移动一个索引。

这是我的代码，我也愿意接受其他改进。

```
import java.util.Scanner;

public class Queue {
    Object[] q;
    int head, tail;
    Scanner in;

    public Queue(int size){ 
        q = new Object[size];
        menu();
    }

    public void menu(){
        System.out.println("\t");   
        System.out.println("1\. add(x) - Adds the object x to end of the queue");
        System.out.println("2\. remove() - Removes the first object in the queue");
        System.out.println("3\. view - Shows contents in queue");
        System.out.println("4\. exit - Exits program");
        System.out.println("Select your operation:"+"\t");  

        while(true){
            in = new Scanner(System.in);
            int userInput = in.nextInt();

            if(userInput == 1){
                System.out.println("Give value of object");
                in = new Scanner(System.in);
                Object userIn = in.next();
                add(userIn);
                menu();
            }

            if(userInput == 2){
                remove();
                menu();
            }

            if(userInput == 3){
                peek();
                menu();
            }

            if(userInput == 4){
                System.exit(0);
            }
        }
    }

    // Adds the object to the end of the queue
    Object add(Object letter){

        // If the queue is not full, add to back of queue
        if(tail >= q.length){
            System.out.println("Queue is full");
            return null;
        } else {
            q[tail] = letter;
            tail++;
        }
        return tail;
    }

    // Removes the first object in the queue
    Object remove(){
        if(q.length == 0){
            return null;
        } else {
            q[head] = null;
            head++;
        }
        return head;
    }

    // Returns the head, tail and all other objects in the queue
    void peek(){
        System.out.println("Head: "+q[head]);
        System.out.println("Tail: "+q[tail-1]);
        System.out.println(q[0]+", "+q[1]+", "+q[2]+", "+q[3]+", "+q[4]+".");
    }

    public static void main(String[] args){
        new Queue(5);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:24:14.840

在内部，我相信大多数 Java 列表对象在某些时候实际上只有一个不可变数组，这就是您所遇到的。

他们所做的调整大小，然后是在某个完整的百分比阈值（比如 75%），他们将创建一个两倍大小的新数组。因此，如果您有一个 4 项数组，并插入了三个项，该结构将在内部将其存储数组更新为大小 8，并在有 6 个项时再次执行此操作，依此类推。

至于实际复制，请查看 System.arraycopy，它允许您指定源和目标数组。

在转移方面，为什么要转移？为什么不只保留一个指向当前索引的指针？

比如看这个操作链……

队列对象，队列对象，出队对象，队列对象。

你的结构可能看起来像

```
[,,,] - head at 0, tail at 0
[obj1,,,] - head at 0, tail at 1
[obj1,obj2,,] - head at 0, tail at 1
[obj1,obj2,,] - head at 1, tail at 1
[obj1,obj2,obj3,] - head at 1, tail at 2
[obj1,obj2,obj3,] - head at 2, tail at 2 
```

使用此方法，并且如其他答案所述，您还可以将索引包装在仍然可用的元素上。在上面的示例中，如果您再添加两个元素，由于前两个不再使用，您可以开始用新元素替换它们。

显然，当没有足够的对象出列以允许更多对象排队时，您仍然需要处理调整大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:27:40.600

所以，你是对的，有一些数据结构可以完全按照你的要求做，但是由于这更像是一个练习而不是应用程序，这就是我要说的。

#1

您将整个*n*长度数组复制到*n* +1 长度数组的解决方案将起作用。但是还有另外两种通常使用的方法来做到这一点，这两种方法都不涉及复制整个数组。

第一个是在创建队列时预先分配最大大小。如果您熟悉的话，这类似于您必须为 C 中的数组预先分配内存的方式。这是迄今为止 3 种解决方案中最简单的，也是最快的。

我会指出，如果您使用此解决方案，您会经常看到用于实现队列的所谓“循环缓冲区”或“环形缓冲区”[1]。您应该阅读有关此主题的链接文章。

第二种是使用某种链表[2]，而不是只存储值，而是存储一个 (value, next-address) 对。然后，您可以动态添加项目。但是在 Java 中做到这一点是相当困难的。链接的文章提供了有关链接列表的更多见解。

#2

***不要转移。*** 根据队列的大小和元素的大小，它可能需要更长的时间——移位将是***O*** (n)——如果你不知道这意味着什么，请参阅 [3]。

而不是移位，使用类似循环缓冲区的东西 [1]。跟踪头部和尾部（或头部和大小）。

如果你使用环形缓冲区插入来做这样的事情，那么***O*** (1) 会好得多。

**在旁边**

在我看来，学习数据结构非常重要，所以很好。但是（同样，我也认为）像 Java 这样的语言使得理解数据结构的基础知识比诸如 C 或 C++ 之类的语言要困难得多。请注意，并非不可能，但 Java 的托管内存方面混淆了 C 没有的数据结构实现的一些更精细的点。如果你*真的*想了解这些数据结构，我强烈建议在某个时候用 C/C++ 来实现它们，只是为了看看什么是必要的以及它是如何工作的。

[1] [http://en.wikipedia.org/wiki/Circular_buffer](http://en.wikipedia.org/wiki/Circular_buffer)
[2] [http://en.wikipedia.org/wiki/Linked_list](http://en.wikipedia.org/wiki/Linked_list)
[3] [http://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

# amazon-web-services - 为 Amazon Cloudfront 上的多个边缘站点预缓存动态生成的图像

> ID：12625829
> 
> 赞同：8
> 
> 时间：2012-09-27T16:20:44.780
> 
> 标签：amazon-web-services, amazon-cloudfront

我们目前在许多边缘站点使用 CloudFront 来提供动态调整为不同大小尺寸的产品图像（接近一百万）。我们的 Cloudfront 发行版使用原始 EC2 php 脚本从 S3 检索原始图像，根据提供的查询字符串标准（宽度、高度、裁剪等）动态转换它，并将其流式传输回 Cloudfront，后者将其缓存在边缘位置。

但是，第一次加载非缓存图像的网站访问者会受到这种相当大的转换的打击。

我们希望能够“预缓存”我们的图像（通过使用请求每个图像 url 的批处理作业），这样最终用户就不会第一个点击特定尺寸的图像，等等。

不幸的是，由于图像仅缓存在分配给预缓存服务的边缘位置上，因此使用另一个边缘位置的网站访问者将无法获得缓存的图像，并且会受到源服务器上大量调整大小的脚本的影响。

我们提出的唯一解决方案是，每个边缘位置都可以在合理的加载时间内检索图像，这是：

我们有一个指向原始 EC2 php 脚本的 Cloudfront 发行版。但是，原始脚本没有进行上述图像转换，而是将请求和查询字符串参数转发到另一个 Cloudfront 分发。此发行版具有执行图像转换的原始 EC2 php 脚本。这样，图像始终缓存在我们的 EC2 实例（爱尔兰）附近的边缘位置，从而避免在从另一个边缘位置请求图像时执行另一次转换。

因此，例如，瑞典的请求命中 /image/stream/id/12345，瑞典边缘位置没有缓存，因此它将请求发送到源，即爱尔兰的 EC2 机器。然后，EC2“流式传输”页面从另一个 Cloudfront 发行版加载 /image/size/id/12345，该发行版到达爱尔兰边缘位置，该边缘位置也没有缓存。然后它向源端发送请求，同样是同一台 EC2 机器，但发送到调整大小的“大小”页面。此后，瑞典和爱尔兰的边缘站点都缓存了图像。

现在，来自法国的请求请求相同的图像。法国边缘位置没有缓存它，因此它调用源，即爱尔兰的 EC2 机器，它调用再次命中爱尔兰边缘位置的第二个 CF 分发。这次它确实缓存了图像，并且可以立即返回。现在法国边缘位置也缓存了图像，但不必调用“调整大小”页面 - 只有在爱尔兰缓存图像的“流媒体”页面。

这也意味着我们在爱尔兰的“预缓存”批处理服务可以对爱尔兰边缘位置进行请求，并在我们的网站访问者请求图像之前预缓存图像。

我们知道这看起来有点荒谬，但我们希望最终用户在调整图像大小时永远不必等待很长时间，这似乎是唯一切实可行的解决方案。

我们是否忽略了另一个/更好的解决方案？对以上内容有何评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T14:11:34.730

我不确定这会减少加载时间（如果这是您的目标）。

是的，此设置将节省一些“转换时间”，但另一方面，这也会在服务器之间创建额外的通信。

**IE**客户端调用法语 POP >> 法语 POP 调用爱尔兰 POP = 下载时间（和一些）的两倍，这可能比“转换时间”长...

我为 Incapsula 工作，我们实际上开发了自己独特的行为分析启发式过程来处理动态内容缓存。（在这里简要记录：http: [//www.incapsula.com/the-incapsula-blog/item/414-advanced-caching-dynamic-through-learning](http://www.incapsula.com/the-incapsula-blog/item/414-advanced-caching-dynamic-through-learning)）

*我们的场地是：*

虽然一个网站可以有数百万个动态对象，但只有其中一些需要重复请求。

按照这个逻辑，我们有一个算法可以学习访问模式，为缓存找到好的“候选人”，然后将它们缓存在冗余服务器上。（从而避免了上述的“双重下载”）

然后每 5 分钟重新扫描一次内容，以保持新鲜度，并且启发式系统保持跟踪，以确保内容仍然受欢迎。

这是一个过于简单的解释，但它展示了核心思想，即：找出你的用户最需要什么。参与所有 POP。跟踪以保持新鲜度并检测趋势。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T13:51:14.603

只是一个想法...

运行两个缓存。

1.  每个边缘位置一个，
2.  爱尔兰的服务器上的一个（如果有多个服务器，则为 elasticache）。它们不需要被缓存超过几分钟。

将运行的微实例附加到数据管道或队列，

当请求进入源服务器时，返回并服务器缓存图像。还将 url 放到队列中。

然后，让守护程序对每个边缘位置进行多次调用。此时，您的服务器将再次受到攻击（因为其他边缘位置将没有图像）-但它将立即从缓存中提供服务-无需执行昂贵的转换。

如果它不进行转换，并且仅从缓存中提供服务 - 应该没什么大不了的。

所以流程是这样的

```
Request -> Cloud Front -> EC2 -> Add to cache   -> Response -> CloudFront Cache -> User
     -                        -> Queue new request at each edge location
Request -> Cloud Front -> EC2 -> already cached -> Response -> CloudFront -> User 
```

您需要某种形式的标记来说明它已经被提供和缓存，否则您最终会陷入无限循环。

# php - 处理函数后重定向用户

> ID：12625831
> 
> 赞同：0
> 
> 时间：2012-09-27T16:20:45.370
> 
> 标签：php, codeigniter

我是代码点火器的新手，我想知道如何将用户重定向回以前的视图并在他们提交表单后显示成功或错误消息。

这是我的看法

```
<div id="modal">
    <?php echo form_open('additem/insert', array('id'=>'insert')); ?> 
    <div class="field">
        <label for="title">Title:</label>
        <input type="text" name="title" value="<?=(isset($_GET['title'])) ? $_GET['title'] : ''?>" />
    </div>
    <div class="field">
        <label for="link">Link:</label>
        <input type="text" name="raw_link" value="<?=(isset($_GET['link'])) ? $_GET['link'] : ''?>" />
    </div>
    <div class="field">
        <label for="title">Additional Info: <span class="tip">(size or colour)</span></label>
        <input type="text" name="additional_info" />
        <input type="hidden" name="fb_user_id" value="<?=$_SESSION['data']['fb_user_id']?>" />
    </div>
</form> 
```

这是我的控制器

```
class Additem extends CI_Controller {
public function index() {

    $this->load->helper('form');
    $this->load->model('list_model');

    $this->load->view('modal/add-item');
}

public function insert() {

    $data = array(
        'id' => $this->input->post('id', TRUE),
        'title' => $this->input->post('title', TRUE),
        'raw_link' => $this->input->post('raw_link', TRUE),
        'additional_info' => $this->input->post('additional_info', TRUE),
        'fb_user_id' => $this->input->post('fb_user_id', TRUE)
    );

    $this->load->model('list_model');
    $this->list_model->add_list_item($data);
} 
```

}

这是模型

```
function add_list_item($data) {

    $this->load->database();

    $this->db->trans_start();

    $this->db->query("INSERT list_items (fb_user_id, added, title, raw_link, additional_info) VALUES(".$this->db->escape($data['fb_user_id']).", NOW(), ".$this->db->escape($data['title']).", ".$this->db->escape($data['raw_link']).", ".$this->db->escape($data['additional_info']).")");
    $this->db->query("UPDATE users SET num_items = num_items +1 WHERE fb_user_id = ".$this->db->escape($data['fb_user_id'])."");

    $this->db->trans_complete();

    if ($this->db->trans_status() === FALSE) {
       log_message('error', 'Unable to add list item for user '.$data['fb_user_id'].'');
    }
} 
```

目前，我只看到一个空白屏幕，其中 url 指向表单位置 additem/insert，尽管一切正常。我只想通过成功或失败消息将用户重定向回上一个视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:07:08.423

好吧，我认为您正在尝试搜索以下内容：

```
function add_list_item($data) {

    $this->load->database();

    $this->db->trans_start();

    $this->db->query("INSERT list_items (fb_user_id, added, title, raw_link, additional_info) VALUES(".$this->db->escape($data['fb_user_id']).", NOW(), ".$this->db->escape($data['title']).", ".$this->db->escape($data['raw_link']).", ".$this->db->escape($data['additional_info']).")");
    $this->db->query("UPDATE users SET num_items = num_items +1 WHERE fb_user_id = ".$this->db->escape($data['fb_user_id'])."");

    $this->db->trans_complete();

    $status = TRUE;
    if ($this->db->trans_status() === FALSE) {
       log_message('error', 'Unable to add list item for user '.$data['fb_user_id'].'');
       $status = FALSE;
    }
    return $status;
} 
```

现在，根据交易状态，您可以显示相应的视图：

```
public function insert() {

    $data = array(
        'id' => $this->input->post('id', TRUE),
        'title' => $this->input->post('title', TRUE),
        'raw_link' => $this->input->post('raw_link', TRUE),
        'additional_info' => $this->input->post('additional_info', TRUE),
        'fb_user_id' => $this->input->post('fb_user_id', TRUE)
    );

    $this->load->model('list_model');

    $status = $this->list_model->add_list_item($data);
    if ($status == TRUE)
    {
        // 1\. you can show a view
        $this->load->view('success_view');

        // 2\. or do a redirection
        redirect('success_controller', "refresh");
    }
    else
    {
         // 1\. you can show a view
        $this->load->view('error_view');

        // 2\. or do a redirection
        redirect('error_controller', "refresh");
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T17:16:47.420

填写表格后，这取决于您是否要使用新的控制器。如果没有，我会做这样的事情：

```
function insert()
{

    //Load the appropriate files (as the form ..) ..
    $this->load->library('form_validation');

    //Put some form_validetaion rules .. you have to set it for each field
    $this->form_validation->set_rules('title', 'title', 'trim|required|xss_clean');

    if(!$this->form_validation->run())
    {
        // the there was an error in the form or the user didn't submit it yet
        //load your view and pass an error message, see the form validation page for that
        $this->session->set_flashdata('errorMessage', 'see the error message for each field');
        $this->load->view('form', $data);
    }else{
        //YOUR CODE HERE
        // the form hass successfully validated
        $this->session->set_flashdata('flashMessage', 'The has been validated successfully');
        redirect('"controller"/"function"');

    }

} 
```

# sql-server - 是否有任何查询可以在 SQL Server 中生成数据库转储？

> ID：12625832
> 
> 赞同：-1
> 
> 时间：2012-09-27T16:20:48.227
> 
> 标签：sql-server, database

是否有任何查询来生成数据库转储？我想在没有 gui 的情况下生成转储，尤其是对于 mssql？我不想使用任何导入/导出工具。简而言之，我需要使用查询为 db 中的所有对象编写脚本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T17:05:32.060

这适用于 SQL Server。

```
declare @sql nvarchar(255), @table sysname

declare cr cursor local for
  select name from sys.tables where type = 'U'

open cr
fetch next from cr into @table

while @@fetch_status = 0
begin
  set @sql = 'select * from [' + @table + ']'
  exec sp_executesql @sql
  fetch next from cr into @table
end

close cr
deallocate cr 
```

这个想法是枚举“用户”表并`select *`从每个表中创建动态 SQL...

# cakephp - CakePHP 充当翻译和 $Model::find()

> ID：12625835
> 
> 赞同：1
> 
> 时间：2012-09-27T16:20:58.363
> 
> 标签：cakephp, translate

我已将翻译行为附加到我的一个模型中，对此我有一些缺点：

1) 如果在将行为附加到模型时，我没有在作为参数传递的所有字段中保存数据，则 $Model::find() 方法不会获取插入的行。

```
public $actsAs = array(
    'Translate' => array(
        'title' => 'title_Translation',
        'description' => 'description_Translation',
        'description_long' => 'description_long_Translation'
    )
); 
```

例如：如果我`$Model::save()`只将值传递给方法`'title'`，则数据将被保存，即使在 i18n 表中，但`$Model::find()`什么也得不到。我必须传递所有字段的数据。

我可以强制它检索那些记录吗？

2) 我怎样才能在应用程序的管理端获取所有记录（无论保存记录的语言如何）以便列出它们以便用户可以更改它（编辑数据，以多种语言保存数据）？现在，我只能获取与当前语言对应的记录（从配置中读取或显式设置）..

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T13:02:52.243

我解决了它，我将 TranslateBehavior 复制到 app/Model/Behavior （只是为了避免将来升级时出现问题并保留原来的以防万一）然后我更改了行为的 _addJoin(...) 方法，只是更改了第 255 行从 INNER 到 LEFT 的连接类型（我使用 cake 2.2.3）。

现在，如果一条记录存在，它总是会被检索到，即使翻译的字段丢失。

除了需要检查翻译字段是否为空之外，没有看到任何缺点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T05:16:04.973

好吧，我可能有点晚了，但无论如何......

1）Cake 在获取一行时使用 INNER JOIN 并且它是相关的翻译，所以基本上没有简单的方法解决这个问题。您必须确保每次都保存每个可翻译字段 - 即使您只是将其保存为空白。唯一的选择是绕过核心使其使用左连接而不是内连接 - 但不要这样做。

2）食谱解释了如何在这里获取所有记录：http: [//book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html#retrieve-all-translation-records-for-a-field](http://book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html#retrieve-all-translation-records-for-a-field)

现在，可能大多数时候您只想获得一个翻译，因此您不想修改模型中 $actsAs['Translate'] 数组的定义。所以我所做的是在 AppModel.php 中设置了一个方法，它可以即时修改 $actsAs['Translate'] 数组：

```
/*  
 * See http://book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html#using-the-bindtranslation-method
 * This is for making it so we fetch all translations, as opposed to just that of the current locale.
 * Used for eg. editing (multiple translations) via the admin interface.
 */
public function bindAllTranslations(){
    $translatableFields = $this->actsAs['Translate'];

    $keyValueFields = array();
    foreach($translatableFields as $field){
        $keyValueFields[$field] = $field.'Translation';
    }

    $this->bindTranslation($keyValueFields,false);  // false means it will be changed for all future DB transactions in this page request - and won't be reset after the next transaction.
} 
```

因此，如果它是一个管理方法（或任何其他您想要所有翻译的情况），您在查找之前调用该代码：

```
$this->MyModel->bindAllTranslations();
$this->MyModel->find('all'); 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-04T22:35:31.000

不确定它是否对您有帮助，但您也可以在调用*find()之前使用数组来设置语言环境*

```
$this->YourModel->locale = array("ENG", "GER", "JAP"); 
```

这样，您将始终获得所有记录，即使它们没有所有可能的翻译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-11T21:44:35.200

非常感谢eleonzx，十年来我一直有这个问题，有了你的简单回答，我现在可以继续前进了！所以再次感谢。

也许这段代码可以帮助很多人：

在我的 AppController beforeFilter 方法中，我调用 _setLanguage

```
private function _setLanguage() {
    if($this->Session->read('Config.language')){
        $locale = $this->Session->read('Config.language');
        $this->{$this->modelClass}->setLocale($locale);
    }else{
        $this->{$this->modelClass}->Behaviors->disable('Translate');
    }
} 
```

在 else 条件下，如果会话中没有设置语言环境，我会即时禁用翻译行为以获取原始内容（我使用基本链接在语言之间切换）。

# mysql - 在我的 sql 中的组之前排序

> ID：12625836
> 
> 赞同：0
> 
> 时间：2012-09-27T16:20:59.053
> 
> 标签：mysql, sorting, group-by, group-concat

我试图在分组之前对表（评论）进行排序，所以我创建了一个名为的临时表`comm_sorted`并按时间戳对其进行排序。

但是，它仍然不起作用。

```
 $sql = "
select images.id,images.image as imageURL, images.fid as userID, user.name as userFullName, images.comment as feedDescription, images.sharedServices, stores.name as customerName, 
CONCAT('[', 
GROUP_CONCAT(
DISTINCT CONCAT('\"',likes.uid,'\"')),']') as likes , 
CONCAT('[', 
GROUP_CONCAT(
DISTINCT CONCAT('{\"userId\":\"',comm_sorted.uid,'\",\"comment\":\"',comm_sorted.comment,'\",\"timeStamp\":\"',comm_sorted.timestamp,'\"}') separator ','),']')  as comments FROM images 
LEFT JOIN stores on images.client_id=stores.id 
LEFT JOIN likes on images.id=likes.feedid 
LEFT JOIN (select * from comments order by timestamp DESC) as comm_sorted on images.id=comm_sorted.feedid  
LEFT JOIN user on images.fid=user.id WHERE images.fid=:userID group by images.id, user.name, images.image, images.comment, images.sharedServices, stores.name order by images.Timestamp 
DESC LIMIT $offset, $limit"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:00:13.100

感谢 Barmar 先生 - 您可以在 GROUP_CONCAT() 函数中添加 ORDER BY comm_sorted.timestamp 选项。无需临时查询。问题关闭。

# r - 如何在具有大型数据集的 R 中使用 princomp() 或 prcomp() 函数，而不转换数据？

> ID：12625837
> 
> 赞同：2
> 
> 时间：2012-09-27T16:20:59.133
> 
> 标签：r, transpose, pca, princomp

我刚刚开始了解 PCA，我希望将它用于超过 4,00,000 行的巨大微阵列数据集。我有样本形式的列，以及基因/基因座形式的行。我确实浏览了一些关于使用 PCA 的教程，并且遇到了 princomp() 和 prcomp() 以及其他一些。

现在，正如我在这里了解到的那样，为了在双图中绘制“样本”，我需要将它们放在行中，将基因/基因座放在列中，因此我必须在将数据用于主成分分析。

但是，由于行数超过 4,00,000，我无法将它们转换为列，因为列是有限的。所以我的问题是，有没有办法使用这些 R 函数对我的数据执行 PCA 而不转置它？如果没有，你们中的任何人都可以建议我这样做的任何其他方式或方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:39:21.007

为什么你讨厌转置你的数据？这简单！

如果您将数据读入 R （例如作为 matrix `microarray.data`），您可以只用一个命令转置它们：

```
transposed.microarray.data<-t(microarray.data) 
```

# linux - Makefile 错过了一条看起来可用的规则

> ID：12625838
> 
> 赞同：0
> 
> 时间：2012-09-27T16:21:03.263
> 
> 标签：linux, compilation, makefile

我有以下 Makefile，我想用它`serial.c`在 Linux 中构建一个位于当前目录中的项目，但它使用内部的 C++ 库，`src`并且`include`应该构建到一个目录`obj`中，以保持所有文件清晰和分离。

```
#define some paths
DHOME      = ${HOME}/Serial
SRC        = ${DHOME}/src
INCLUDE    = ${DHOME}/include
BIN        = ${DHOME}/bin
OBJ        = ${DHOME}/obj

# compiler
CFLAGS        = -I$(INCLUDE)
CXX           = g++ -g ${INCLUDE} 
MAKE          = ${CXX} -O -Wall -fPIC -c

$(OBJ)/%.o: $(SRC)/%.cc
    $(MAKE) $(CFLAGS) $< -o ${OBJ}/$@ 

serial: $(OBJ)/%.o
    ${CXX} -o $@ $@.c $< $(CFLAGS) 

.PHONY: clean
clean:
    @rm -f serial $(OBJ)/*.o 
```

`make serial`尝试或只是时的错误消息`make`是

```
make: *** No rule to make target `/home/alex/Serial/obj/%.o', needed by `serial'.  Stop. 
```

但是在查看 Makefile 时，似乎我已经指定了这个规则（规则之上的`serial`规则）。我可能错过了一些基本的东西。也许有更好的方法来处理这样的项目并将不同的部分清楚地分开在目录中？

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:57:27.860

问题是你的规则：

```
serial: $(OBJ)/%.o 
```

由于`%`此规则的 TARGET 中没有，因此这不是模式规则。所以它会寻找一个名为`/home/alex/Serial/obj/%.o`（字面意思）的文件，该文件不存在且无法制作。

您需要`serial`依赖于实际对象文件名的列表。然后模式规则 `$(OBJ)/%.o: $(SRC)/%.cc`可以匹配其中的每一个并将用于编译它。

**编辑**

如果要自动生成该列表，可以在源文件上使用 glob 规则，然后使用模式替换来生成目标文件：

```
SOURCES = $(wildcard $(SRC)/*.cc)
OBJECTS = $(SOURCES:$(SRC)/%.cc=$(OBJ)/%.o) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:56:58.910

模式匹配规则作用于*目标*。

您没有提供要构建的目标列表，因此模式匹配不会像您假设的那样工作。

模式匹配*不*构造为在命令行上用作通配符。您不能要求 make 寻找目标，您必须提供它们。

所以，如果`serial`依赖于一些特定的`.o`文件，你需要提供这些。最简单的方法是重写你的规则：

```
serial: $(OBJ)/foo.o $(OBJ)/bar.o $(OBJ)/fie.o
    #Insert build command here, as needed 
```

这将触发模式匹配，因为每个目标文件在链接之前都被设置为目标`serial`。

# c++ - libc.so.6 的 linux 错误

> ID：12625841
> 
> 赞同：0
> 
> 时间：2012-09-27T16:21:16.870
> 
> 标签：c++, linux

我在我的 ubuntu 12.04 机器上编译了一个 c++ 程序，并试图在 red hat linux 服务器上运行它。当我在服务器上运行它时，我得到了这个错误：

> /lib64/libc.so.6：未找到版本“GLIBC_2.14”

我找到了 libc.so.6 文件，发现它链接到同一目录中的 libc-2_12.so。我假设我需要将 libc-2_12.so 文件替换为 libc-2_14.so 之类的文件。但是通过搜索，我发现没有办法做到这一点，或者甚至有可能。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:31:10.030

如果您在红帽集群的某处有正确的库（否则得到一个有效的库），只需将其路径添加到`LD_LIBRARY_PATH`环境变量的前面（`LD_RUN_PATH`也可以这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:28:10.723

IMO，最好的方法是为 RedHat 重新编译您的程序。在 RH 中，替换该文件的唯一方法是重新编译整个 libc，但它会破坏使用 RH 安装的所有其他软件。RH 的打包系统不允许您在不同版本的 libc 之间切换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:37:57.390

正如其他答案所说，最好的方法是在服务器上重新编译你的程序。另一种方法可能是静态链接您的程序，通过`-static`在链接时传递给 GCC（或者，如果您只是使用单个命令进行编译，则在编译程序时）。

这应该会引入所有依赖项并创建一个虽然非常大的单个程序，而不是在运行时使用动态链接器。但是，各种行为都可能出错，因此您最终可能会遇到奇怪的行为，或者根本没有用处。**谨慎使用**。

当然，这只有在两台机器具有相同架构的情况下才有效。

# php - 播放 php mp3 生成的文件，无需保存或下载

> ID：12625844
> 
> 赞同：0
> 
> 时间：2012-09-27T16:21:34.927
> 
> 标签：php, html

所以我正在生成 mp3 文件，它工作正常，因为当我下载它时，我可以很好地播放它，但现在我想做的是将该文件输出到我的浏览器并在我的浏览器中播放，所以我尝试的是：

```
header("Pragma: no-cache");
header('Cache-Control: no-store, no-cache, must-revalidate');
header('Content-Type: audio/mepeg');
header("Content-Disposition: attachment; filename=\"validate.mp3\"");
header("Content-Transfer-Encoding: binary");
header("Content-length: $size"); 
```

**和**

```
<embed autoplay="true" height="0" width="0" src="actions/play_file"  /> 
```

当然 id 不起作用，它只是强制下载该文件，因为我已经使用过

`"Content-Disposition: attachment; filename=\"validate.mp3\"")`

我很确定我是否为此使用了正确的 html 标签？但如果我是，我所需要的只是正确的标题来完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:57:12.367

这是一种提供文件的方法：

```
header("Content-type: audio/mpeg");
header("Content-length: " . filesize($file));
header("Cache-Control: no-cache");
header("Content-Transfer-Encoding: binary"); 
readfile($file); 
```

或成块

```
$total     = filesize($filepath);
$blocksize = (2 << 20); //2M chunks
$sent      = 0;
$handle    = fopen($filepath, "r");

// Push headers that tell what kind of file is coming down the pike
header('Content-type: '.$content_type);
header('Content-Disposition: attachment; filename='.$filename);
header('Content-length: '.$filesize * 1024);

// Now we need to loop through the file and echo out chunks of file data
// Dumping the whole file fails at > 30M!
while($sent < $total){
    echo fread($handle, $blocksize);
    $sent += $blocksize;
}

exit(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T17:04:12.463

您要做的重要事情是指定`Content-Type`标题。浏览器（或其他用户代理）用它做什么取决于他们，而不是你。您现在使用的内容类型不正确。使用`audio/mpeg`.

让它始终播放的唯一方法是在网页上包含一个播放器。为此，您可以使用 HTML5 音频标签、Flash、嵌入等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-09T15:54:02.437

......然而......另一种更简单的方法......自从一家名为 Ivona 的波兰公司于 2013 年 1 月 24 日被亚马逊收购的那一刻起，我就测试了这种方法，因此证明它是可行的在设置您的 AWS Polly 凭证之后，该框的。

```
 header('Accept-Ranges: none');
    header('Content-Type: audio/mpeg');

    echo $audio; 
```

# c# - Application.Current 对于单元测试为 Null

> ID：12625848
> 
> 赞同：8
> 
> 时间：2012-09-27T16:21:49.913
> 
> 标签：c#, mstest, nullreferenceexception, applicationdomain

我在代码库中有一些方法依赖于 Application.Current.Dispatcher.Invoke... 以确保事情在 GUI 线程上运行。我目前正在尝试为这些方法编写单元测试，但（如预期的那样）Application.Current 为空，所以我得到了 NullReferenceException。

我尝试按照此处的建议在他们自己的 AppDomain 中运行受影响的测试：http: [//social.msdn.microsoft.com/Forums/en-US/wpf/thread/786d5c06-0511-41c0-a6a2-5c4e44f8ffb6/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/786d5c06-0511-41c0-a6a2-5c4e44f8ffb6/)

但是当我这样做时，Application.Current 仍然为空。不应该启动 AppDomain 为我设置 Application.Current 吗？为什么它仍然为空？

我的代码：基类：

```
[TestClass()]
[Serializable]
public class UnitTest
{
    protected void ExecuteInSeparateAppDomain(string methodName)
    {
        AppDomainSetup appDomainSetup = new AppDomainSetup();
        appDomainSetup.ApplicationBase = Environment.CurrentDirectory;
        AppDomain appDomain = AppDomain.CreateDomain(methodName, null, appDomainSetup);

        try
        {
            appDomain.UnhandledException += delegate(object sender, UnhandledExceptionEventArgs e)
            {
                throw e.ExceptionObject as Exception;
            };

            UnitTest unitTest = appDomain.CreateInstanceAndUnwrap(GetType().Assembly.GetName().Name, GetType().FullName) as UnitTest;

            MethodInfo methodInfo = unitTest.GetType().GetMethod(methodName, BindingFlags.NonPublic | BindingFlags.Instance);

            if (methodInfo == null)
            {
                throw new InvalidOperationException(string.Format("Method '{0}' not found on type '{1}'.", methodName, unitTest.GetType().FullName));
            }

            try
            {
                methodInfo.Invoke(unitTest, null);
            }
            catch (System.Reflection.TargetInvocationException e)
            {
                throw e.InnerException;
            }
        }
        finally
        {
            AppDomain.Unload(appDomain);
        }
    }
} 
```

调用单元测试（包含在继承自 UnitTest 的类中）：

```
[TestMethod()]
public void QualifierViewModel_FlagsAndLoadDatasets()
{
    ExecuteInSeparateAppDomain("TestLoadDataSets");
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T19:53:02.747

所以现在我有一个讨厌的解决方法。我基本上将所有使用 Application.Current 的测试方法移动到一个测试中（因此它们都将在同一个线程上）并调用 new Application()。

讨厌的代码：

```
[TestClass]
    public class IntegrationTests
    {
        private CedarFile testCedarFile;

        /// <summary>
        /// This test tests methods that utilize Application.Current. 
        /// They all have to be in the same test because they must run on the same thread to use the Application instance.
        /// </summary>
        [TestMethod]
        public void IntegrationTests_All()
        {
            new Application();

            QualifierViewModel_FlagsAndLoadDatasets();
            CurrentFilesViewModel_AddCedarFile();
            CurrentFilesViewModel_AddCedarFileReadOnly();
        }
... the private methods to test ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T11:05:24.213

此解决方法对我有用：

```
[TestClass]
public class MockAppTests
{
    private static Application application = new Application() { ShutdownMode= ShutdownMode.OnExplicitShutdown };
}

[TestClass]
public class IntegrationTests : MockAppTests
{        
    [TestMethod]
    public void MyTest()
    {
        //test
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-27T16:42:41.833

尝试删除该`Serializable`属性，而是`UnitTest`从`MarshalByRefObject`.

# php - HTML/php 解析器错误

> ID：12625854
> 
> 赞同：0
> 
> 时间：2012-09-27T16:22:12.323
> 
> 标签：php, html

我正在浏览[http://net.tutsplus.com/tutorials/php/online-file-storage-with-php/comment-page-2/#comments](http://net.tutsplus.com/tutorials/php/online-file-storage-with-php/comment-page-2/#comments)上的教程 ，它工作正常，直到：

```
if(strlen($message) > 0)
{
    $message = '<p class="error">' . $message . '</p>';
} 
```

这行 php 在 index.php 中找到。当我在 Firefox 中查看页面时，看起来 php 解析器停止在大于。我可以逃脱角色吗？我需要吗？

编辑：所有的php代码：

```
<?php 
//Load the settings
require_once("settings.php");

$message = "";
//Has the user uploaded something?
if(isset($_FILES['file']))
{
    $target_path = Settings::$uploadFolder;
    $target_path = $target_path . time() . '_' . basename( $_FILES['file']['name']); 

    //Check the password to verify legal upload
    if($_POST['password'] != Settings::$password)
    {
        $message = "Invalid Password!";
    }
    else
    {
        //Try to move the uploaded file into the designated folder
        if(move_uploaded_file($_FILES['file']['tmp_name'], $target_path)) {
            $message = "The file ".  basename( $_FILES['file']['name']). 
            " has been uploaded";
        } else{
            $message = "There was an error uploading the file, please try again!";
        }
        }

    //Clear the array
    unset($_FILES['file']);
}

if(strlen($message) > 0)
{
    $message = '<p class="error">' . $message . '</p>';
}    
?>
<html> ... </html> //my html code 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:35:35.817

`>`不会导致 PHP 解析器停止。

没有看到服务器的 HTML 输出，很难确定，但由于`>`是文件中的第一个`>`，PHP 解析器似乎*永远不会启动*，浏览器会处理`<?php`文件开头和`strlen($message) >` **作为标签**。

您需要通过安装了 PHP 并配置为处理该文件的 Web 服务器访问 PHP（通常通过为其提供 .php 文件扩展名来完成）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:33:49.990

那这个呢？

```
if(!empty($message)){
    $message = '<p class="error">'.$message.'</p>';
} 
```

但是为什么不直接将段落标签分配给错误消息，而不是先分配错误消息`$message`然后再分配段落标签呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:34:59.453

if 条件没有任何错误，它工作正常

![在此处输入图像描述](../Images/0e80a1a678b1213fc1e11bd46761f838.png)

中可能出现的问题

1.  `if(isset($_FILES['file']))`
2.  `if($_POST['password'] != Settings::$password)`
3.  `if(move_uploaded_file($_FILES['file']['tmp_name'], $target_path))`

如果你没有进入 if 身体，这意味着问题

```
 if(isset($_FILES['file'])) 
```

因为如果它比 `$message = "";`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-27T16:29:33.183

始终使用**Yoda 条件**并以 (the) reverse(d) 顺序编写此类语句（您通常习惯于：

```
if ( 0 !== strlen( $message ) )
{
    $message = 'Hello World!';
} 
```

无论如何，您也可以简单地检查`! empty( $message )`

# html - 浮动下浮动的 HTML 文本 - Chrome 错误？

> ID：12625856
> 
> 赞同：0
> 
> 时间：2012-09-27T16:22:19.430
> 
> 标签：html, google-chrome, css-float

Chrome 中的以下代码导致文本与第二个`div`. 在 FF 中看起来还可以。这真的是一个错误，还是我只是无法理解一些基础知识？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
</head>
<body style="width:400px;">
    <div style="float:right; width:100px; height:45px; background-color:gray;">
    </div>
    <div style="clear:right; float:right; width:200px; height:45px; background-color:blue;" >
    </div>
    <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </p>
</body>
</html> 
```

# python - 从 Python 列表中的每个元素中删除最后一个字符

> ID：12625860
> 
> 赞同：1
> 
> 时间：2012-09-27T16:22:33.827
> 
> 标签：python, arrays, element

我有一个列表 find_words 这是

```
[u'Duration$', u'Noun$', u'Adjective$'] 
```

我想删除所有的 '$' 所以它看起来像

```
[u'Duration', u'Noun', u'Adjective'] 
```

我该怎么做？另外，我如何重新添加“$”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:24:31.163

您可以简单地通过[列表理解](http://www.youtube.com/watch?v=t85uBptTDYY&list=UUAuqj5Bs5mTTl1mIVDmuAlw&index=1&feature=plcp)来做到这一点，并且[`str.rstrip()`](http://docs.python.org/library/stdtypes.html#str.rstrip)：

```
[word.rstrip("$") for word in words] 
```

或者添加它们：

```
[word+"$" for word in words] 
```

例如：

```
>>> words = ['Duration$', 'Noun$', 'Adjective$']
>>> words = [word.rstrip("$") for word in words]
>>> words
['Duration', 'Noun', 'Adjective']
>>> [word+"$" for word in words]
['Duration$', 'Noun$', 'Adjective$'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T16:24:56.087

列表理解是你的朋友。

您可以选择仅删除最后一个字符`word[:-1]`或 $ 如果它存在`word.rstrip('$')`。这将由应用程序定义

```
 words = [u'Duration$', u'Noun$', u'Adjective$']
 result = [word[:-1] for word in words] 
```

还要重新添加它：

```
 added_back = [word + '$' for word in result] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T16:24:57.023

```
words = [ x[:-1] for x in words ] 
```

将从每个项目中删除最后一个字符

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T16:24:18.667

要删除最后一个字符，无论它是什么：

```
find_words = [i[:-1] for i in find_words] 
```

`rstrip`但是如果它保证是一个，你应该使用`$`：

```
find_words = [i.rstrip("$") for i in words] 
```

添加一个`$`：

```
find_words = [i + "$" for i in find_words] 
```

# django - 在 Django 模型中，单词 start 是一个可用的字段名称吗？

> ID：12625861
> 
> 赞同：2
> 
> 时间：2012-09-27T16:22:44.543
> 
> 标签：django, modelform

我有一个名为 Order 的模型，其中包含一个名为 start 的日期时间字段。我可以从该字段读取和写入该字段没有问题。

但是，我刚刚创建了一个 ModelForm 并将 start 指定为 Meta 中的字段之一 =() ，我得到：

```
Unknown field(s) (start) specified for Order 
```

通过复制和粘贴字段名称，我确保它不是拼写错误。如果我删除该字段，它会起作用。

这是确切的 ModelForm

```
class OrderForm(ModelForm):
    class Meta:
        model = Order
        fields = ('details', 'start', 'quantity', 'total') 
```

**编辑添加了更多细节：**

我尝试使用 exclude = () 来排除除我需要的字段之外的所有字段，并且即使我不排除它，也不会出现在表单中。

这是模型：

```
class Order(MyModel):
    user = models.ForeignKey(User, )
    invoice = models.ForeignKey(Invoice, )
    unit_price = models.DecimalField(max_digits=6, decimal_places=2, blank=True, null=True, )
    subtotal = models.DecimalField(max_digits=6, decimal_places=2, blank=True, null    =True, )
    tax = models.DecimalField(max_digits=6, decimal_places=2, blank=True, null=True, )
    misc = models.DecimalField(max_digits=5, decimal_places=2, blank=True, null=True, )
    total = models.DecimalField(max_digits=6, decimal_places=2, blank=True, null=True, )
    start = models.DateTimeField(auto_now_add=True, blank=True, null=True, )
    end = models.DateTimeField(editable=True, blank=True, null=True, )
    duration = models.PositiveSmallIntegerField(blank=True, null=True, )
    quantity = models.PositiveSmallIntegerField(blank=True, null=True, )
    notes = models.CharField(max_length=256, blank=True, null=True, )
    details = models.CharField(max_length=64, blank=True, null=True, )
    configured = models.BooleanField(default=False, ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T17:42:35.020

消除：

```
auto_now_add=True 
```

[型号字段参考 | Django 文档 | 姜戈](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.DateField.auto_now_add)：

> 按照目前的实现，将 auto_now 或 auto_now_add 设置为 True 将导致该字段设置为 editable=False 和 blank=True。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T17:30:49.193

我删除了 auto_now_add=True 并且问题解决了。

感谢大家的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:46:16.510

也许你已经`editable=False`为这个领域定义了`start`？

根据文档：

> 如果`False`是，该字段将不会显示在 admin 或任何其他`ModelForm`中。默认为`True`。

# mysql - Rails 加入和喜欢？

> ID：12625863
> 
> 赞同：1
> 
> 时间：2012-09-27T16:22:55.107
> 
> 标签：mysql, ruby-on-rails-3, join, squeel

我正在尝试使用 rails 中的连接来检索搜索字段中的一些信息库，但我似乎找不到好的语法，我有两个表节省，产品和节省正在为产品节省。我想要的是根据我发现这项工作的产品名称找到一个节省： Saving.all(:joins => :product, :conditions => { :products => { :title => 'Title Name' } }) 它检索与名为 Title Name 的产品对应的保存。

现在我该如何改变它以找到 product title 包含 params[:title] 的节省？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T12:58:55.853

```
Saving.joins{product}.where{(savings.products.title =~ my{"%#{params[:term]}%"} } with squeel 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:46:04.357

```
Saving.joins(:product).where('products.title like ?', "%#{params[:title]}%") 
```

# oracle - hibernate - 在 hql 中使用没有 group by 子句的“有”

> ID：12625870
> 
> 赞同：1
> 
> 时间：2012-09-27T16:23:10.400
> 
> 标签：oracle, hibernate

我试图运行一个 hql 查询，该查询汇总（总和）在特定帐户上进行的交易数量，我不需要 group by，因为我的 where 子句具有特定的帐户过滤器（其中 account = :account）

但是，我确实希望仅在聚合值小于/大于某个给定值时才返回聚合值。当我在没有'group by'的where子句之后添加'have'时，我得到一个错误 - 意外标记：有

在本机 sql 中，我成功添加了没有 group by 的“有”

关于如何使其与 hql 一起工作的任何想法？

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:36:25.787

数据库不允许您将分组列与非分组和非聚合列混合的原因是，对于非分组/非聚合列，它必须为每组选择一行的值，但不知道如何选择一个。

如果你不在乎，那么你可以把它放在一边，如果没关系，因为它们都是一样的，你也可以按它们分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:38:00.170

它不是 hql，但如果您有本机查询，请像这样运行它：

```
Query query = session.createSQLQuery("select, *** ,... blah blah")
//set If you need
query.setParameter("myparam", "val"); 
List result = query.list(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-27T16:40:46.907

在我看来，这是无稽之谈。“拥有”是针对“分组依据”结果的条件完成的。如果你不分组，那么它没有多大意义。

我会说HQL做不到。可能 Hibernate 程序员没有想到这种情况，因为他们认为它不重要。

无论如何，你不需要它。

如果它是一个简单的查询，那么您可以在您的 java 代码中决定是想要结果还是不需要它。

如果它在子选择中，那么您可以使用主选择中的 where 条件来解决问题。

如果您认为确实有必要，请您举一个更具体的例子。

# jquery - 跨浏览器方式将 jQuery 和其他依赖项加载到用户脚本/greasemonkey 脚本中

> ID：12625873
> 
> 赞同：0
> 
> 时间：2012-09-27T16:23:22.330
> 
> 标签：jquery, cross-browser, greasemonkey, userscripts

我正在研究一些 Google Chrome 用户脚本，现在我想让它们也可以在其他浏览器上运行。

这意味着 Greasemonkey 与 Firefox 的兼容性，我想我听说 Opera 也有一些支持，如果它也可以支持 Safari 和 Explorer，那么在一个脚本中就可以了。

但我有一个问题。我正在将 jQuery 加载到我的脚本中，有时还加载到其他库或依赖项中，例如 jQuery UI。这似乎很难仅适用于一个浏览器。是否有一些片段/框架/模式可以为所有支持 Greasemonkey 用户脚本版本的浏览器执行此操作？

* * *

我一直在使用[Brian Schweitzer 的“Multiple-dependancy Chrome-friendly userscript pattern”，](http://userscripts.org/scripts/review/123588)但事实证明它有一些缺陷，当我在 Stack Exchange 上使用它时，会阻止帖子编辑工具栏和预览出现，所以我寻找替代品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:32:34.207

虽然我在 Crossrider 工作，但我的观点可能有点偏颇 - 根据您的描述，我认为[Crossrider](http://crossrider.com/)的框架对您有用。您可以使用原生 jQuery 进行开发，并且您的代码可以在所有主流浏览器（Chrome、Firefox、IE 和 Safari）上运行。

它会为您节省很多在每个浏览器上“正确处理”的麻烦。

# javascript - 如何检测 chrome 和 safari 浏览器（webkit）

> ID：12625876
> 
> 赞同：61
> 
> 时间：2012-09-27T16:23:30.740
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 或 javascript 检测 chrome 和 safari 浏览器。我认为我们不应该使用 jQuery.browser。这里有什么建议吗？非常感谢！

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-09-27T16:28:12.620

如果您不想使用`$.browser`，请查看**案例 1**，否则**案例 2**和**3**可能会帮助您了解**情况**，因为不建议使用`$.browser`（用户代理可以使用它来欺骗）。可以使用另一种方法来`jQuery.support`检测功能支持而不是代理信息。

但...

如果您坚持获取浏览器类型*（仅 Chrome 或 Safari）*但不使用`$.browser`，则**案例 1**就是您要寻找的...

* * *

## 这符合您的要求：

**案例 1：（** *没有 jQuery 也没有 $.browser，只有 javascript）*

**现场演示：http:** [//jsfiddle.net/oscarj24/DJ349/](http://jsfiddle.net/oscarj24/DJ349/)

```
var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
var isSafari = /Safari/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor);

if (isChrome) alert("You are using Chrome!");
if (isSafari) alert("You are using Safari!"); 
```

* * *

这些案例我以前使用过并且效果很好，但不推荐使用......

**案例2：（** *使用jQuery和$.browser，这个比较棘手）*

**现场演示：http:** [//jsfiddle.net/oscarj24/gNENk/](http://jsfiddle.net/oscarj24/gNENk/)

```
$(document).ready(function(){

    /* Get browser */
    $.browser.chrome = /chrome/.test(navigator.userAgent.toLowerCase());

    /* Detect Chrome */
    if($.browser.chrome){
        /* Do something for Chrome at this point */
        /* Finally, if it is Chrome then jQuery thinks it's 
           Safari so we have to tell it isn't */
        $.browser.safari = false;
    }

    /* Detect Safari */
    if($.browser.safari){
        /* Do something for Safari */
    }

}); 
```

**案例3：（** *使用jQuery和$.browser，“优雅”的解决方案）*

**现场演示：http:** [//jsfiddle.net/oscarj24/uJuEU/](http://jsfiddle.net/oscarj24/uJuEU/)

```
$.browser.chrome = $.browser.webkit && !!window.chrome;
$.browser.safari = $.browser.webkit && !window.chrome;

if ($.browser.chrome) alert("You are using Chrome!");
if ($.browser.safari) alert("You are using Safari!"); 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2013-05-09T10:27:29.857

这里的大多数答案都已过时，没有更多的答案`jQuery.browser`，为什么有人甚至会使用 jQuery 或者会嗅到`User Agent`超出我的范围。

> **与其检测浏览器，不如检测一个*功能***
> （无论它是否受支持）。

以下是`false`在*Mozilla Firefox*、*Microsoft Edge*中；它`true`在*谷歌浏览器*中。

```
"webkitLineBreak" in document.documentElement.style 
```

**请注意，这不是面向未来的。**浏览器可以在将来的任何时间实现该`-webkit-line-break`属性，从而导致错误检测。然后，您可以在 Chrome 中查看文档对象并选择任何带有`webkit`前缀的内容，并检查其他浏览器中是否缺少该内容。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-27T16:25:46.590

与其检测浏览器，不如检测一个功能（无论它是否受支持）。这就是[Modernizr](http://modernizr.com/)所做的。

当然，在某些情况下，您仍然需要检查浏览器，因为您需要解决问题而不是检测功能。`WebKit`不使用 jQuery 的具体检查`$.browser`：

```
var isWebKit = !!window.webkitURL; 
```

正如一些评论所暗示的，上述方法不适用于旧版 Safari。使用评论中建议的另一种方法和另一个答案进行更新：

```
var isWebKit = 'WebkitAppearance' in document.documentElement.style; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-02-13T09:46:06.647

2019年仍然存在怪癖和不一致之处。

例如，浏览器之间的缩放 svg 和指针事件。

该主题的所有答案都不再有效。（也许那些有*jquery*的人）

这是一个**替代方案**，通过原生[CSS 支持 api](https://developer.mozilla.org/en-US/docs/Web/API/CSS)使用 javascript 测试是否支持 css 规则。可能会进化，适应！

请注意，可以传递许多用分号分隔的 css 规则，以便进行最佳检测。

```
if (CSS.supports("( -webkit-box-reflect:unset )")){
  console.log("WEBKIT BROWSER")
  // More math...
 } else {
  console.log("ENJOY")
 }
```

```
if (CSS.supports("( -moz-user-select:unset )")){
  console.log("FIREFOX!!!")
 }
```

注意不要在循环中使用它，为了提高性能，最好在负载时填充一个常量：

```
const ff = CSS.supports("( -moz-user-select:unset )")
if (ff){ //... } 
```

仅使用*[CSS](https://developer.mozilla.org/en-US/docs/Web/CSS/@supports)*，上面将是：

```
@supports (-webkit-box-reflect:unset) {
  div {
    background: red
  }
}

@supports (-moz-user-select:unset) {
  div {
    background: green
  }
}
```

```
<div>
  Hello world!!
</div>
```

[可能的 -webkit- 仅 css 规则列表。](https://developer.mozilla.org/en-US/docs/Web/CSS/WebKit_Extensions)

[可能的 -moz- 唯一规则列表。](https://developer.mozilla.org/en-US/docs/Web/CSS/Mozilla_Extensions)

[我可以使用css支持吗？](https://caniuse.com/#search=support)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-07T17:04:49.247

`/WebKit/.test(navigator.userAgent)`- 就是这样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-27T16:28:12.297

> 我正在尝试使用 jquery 或 javascript 检测 chrome 和 safari 浏览器。

采用`jQuery.browser`

> 我认为我们不应该使用 jQuery.browser。

那是因为检测浏览器是个坏主意。如果您真的打算这样做，它仍然是检测浏览器（当涉及 jQuery 时）的最佳方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-06T11:33:37.140

您可以使用这个缩小的 jQuery 片段来检测您的用户是否正在使用移动设备查看。如果您需要测试特定设备，我在下面包含了一组 JavaScript 片段，可用于检测各种移动手持设备，例如 iPad、iPhone、iPod、iDevice、Andriod、Blackberry、WebOs 和 Windows Phone。

```
/**
 * jQuery.browser.mobile (http://detectmobilebrowser.com/)
 * jQuery.browser.mobile will be true if the browser is a mobile device
 **/

    (function(a){jQuery.browser.mobile=/android.+mobile|avantgo|bada/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)/|plucker|pocket|psp|symbian|treo|up.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|/(k|l|u)|50|54|e-|e/|-[a-w])|libw|lynx|m1-w|m3ga|m50/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(-|2|g)|yas-|your|zeto|zte-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera); 
```

**示例用法：**

```
if(jQuery.browser.mobile)
{
console.log(‘You are using a mobile device!’);
}
else
{
console.log(‘You are not using a mobile device!’);
} 
```

**检测 iPad**

```
var isiPad = /ipad/i.test(navigator.userAgent.toLowerCase());
if (isiPad)
{
…
} 
```

**检测 iPhone**

```
var isiPhone = /iphone/i.test(navigator.userAgent.toLowerCase());
if (isiPhone)
{
…
} 
```

**检测 iPod**

```
var isiPod = /ipod/i.test(navigator.userAgent.toLowerCase());
if (isiPod)
{
…
} 
```

**检测设备**

```
var isiDevice = /ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase());

if (isiDevice)
{
…
} 
```

**检测安卓**

```
var isAndroid = /android/i.test(navigator.userAgent.toLowerCase());

if (isAndroid)
{
…
} 
```

**检测黑莓**

```
var isBlackBerry = /blackberry/i.test(navigator.userAgent.toLowerCase());

if (isBlackBerry)
{
…
} 
```

**检测 WebO**

```
var isWebOS = /webos/i.test(navigator.userAgent.toLowerCase());

if (isWebOS)
{
…
} 
```

**检测 Windows Phone**

```
var isWindowsPhone = /windows phone/i.test(navigator.userAgent.toLowerCase());

if (isWindowsPhone)
{
…
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-14T16:36:10.640

这里有很多答案。这是我的第一个考虑。

如果没有 JavaScript，包括用户出于安全目的最初在其浏览器中禁用 Javascript 的可能性，如果用户信任该站点，则用户将其列入白名单，DOM 将无法使用，因为 Javascript 已关闭。

以编程方式，您需要考虑后端服务器端或前端客户端。

借助后端，您可以使用共同的 HTTP“User-Agent”请求标头和/或浏览器发出的任何可能的专有 HTTP 请求标头来输出浏览器特定的 HTML 内容。

对于客户端站点，您可能希望强制执行 Javascript 以允许您使用 DOM。如果是这样，那么您可能希望首先在 HTML 页面中使用以下内容：

```
<noscript>This site requires Javascript. Please turn on Javascript.</noscript> 
```

虽然我们即将迎来每一位 Web 编码员都以某种方式（或不以某种方式）依赖 Javascript 的一天，但今天，假设每个用户都启用了 javascript 将是设计和产品开发质量检查的错误。

我也见过很多网站最终会出现空白页面或网站崩溃，因为它假定每个用户都启用了 javascript。不可以。出于安全考虑，他们最初可能关闭了 Javascript，并且某些浏览器（例如 Chrome）将允许用户将网站按域列入白名单。Edge 是我所知道的唯一浏览器，微软在哪里决定完全禁用用户关闭 Javascript 的能力。Edge 不提供白名单概念，因此这是我个人不使用 Edge 的原因之一。

使用标签是通知用户您的网站在没有 Javascript 的情况下将无法运行的简单方法。一旦用户打开它并刷新/重新加载页面，DOM 现在就可以使用线程回复引用的技术来检测 chrome 与 safari。

具有讽刺意味的是，我来到这里是因为我正在按平台进行更新，并在谷歌上搜索相同的基本问题；铬与萨拉菲。我不知道 Chrome 会创建一个名为“chrome”的 DOM 对象，这实际上是您检测“chrome”与其他所有内容所需的全部内容。

var isChrome = typeof(chrome) === "object";

如果为真，你有 Chrome，如果为假，你有其他浏览器。

检查 Safari 是否也创建了自己的 DOM 对象，如果是，则获取对象名称并执行相同的操作，例如：

var isSafari = (typeof(safari) === "object");

希望这些提示有所帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-27T16:25:04.517

jQuery 提供：

```
if ($.browser.webkit){
    ...
} 
```

进一步阅读[http://api.jquery.com/jQuery.browser/](http://api.jquery.com/jQuery.browser/)

**更新**

如其他答案/评论中所述，检查功能支持总是比代理信息更好。jQuery 还为此提供了一个对象：`jQuery.support`. 检查[文档](http://api.jquery.com/jQuery.support/)以查看要检查的详细列表功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-29T14:33:43.113

我用这个：

```
 const isSafari = /^((?!android|windows|crios|fxios|opios|chrome|firefox|mercury|edge|ie|msie|trident|opera|opt).)*safari/i.test(navigator.userAgent);
console.log(isSafari);
```

# qt - 是否有可用于 libspotify 的 Qt 包装器？

> ID：12625877
> 
> 赞同：3
> 
> 时间：2012-09-27T16:23:37.560
> 
> 标签：qt, spotify

你可以猜到我是 Qt 开发人员，为了尽快启动和运行 libspotify，我正在寻找一个 Qt 包装器。

我确实遇到了这个链接[https://github.com/romnes/libqspotify](https://github.com/romnes/libqspotify)但是你可以看到源是两年前的。我猜从那时起 libspotify 已经有了很大的发展。

这样的包装器是否存在？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T18:14:22.833

[QSpot](http://qspot.garage.maemo.org/)似乎仍在开发中，并且基于 libqspotify（他们已将 libqspotify 源代码复制到他们的 qspotify_src 目录中）。该目录最近有一些提交（2012 年 8 月），所以我猜他们的课程比您在 GitHub 上找到的课程更新鲜。

QSpot 的来源可以[在这里找到](http://gitorious.org/qspot)。

如果这对您不起作用，还有 MeeSpot，它基于一个名为 libQtSpotify 的库，位于[MeeSpot 的源代码](http://qt.gitorious.org/qt-labs/meespot)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-03T12:05:47.923

还有[战斧](http://www.tomahawk-player.org/index.html)。它也是[开源的](https://github.com/tomahawk-player/tomahawk?source=c)

# barcode - 使用 GW EPL 命令将图形打印到 Zebra LP2844？

> ID：12625879
> 
> 赞同：4
> 
> 时间：2012-09-27T16:23:52.983
> 
> 标签：barcode, zebra-printers, epl, barcode-printing

我需要打印通过 Web 服务返回给我的图像（数据以 RAW 格式返回），但我终其一生都无法弄清楚如何使用 EPL 将图形打印到标签上。

EPL 手册将图形写入指令定义为：

```
GWp1, p2, p3, p4, DATA 
```

所有的参数都返回给我，所以我不用担心计算高度，宽度等，但我的问题是我不知道如何格式化DATA。

手册说数据应该是

> 没有图形文件格式的原始二进制数据。数据必须以字节为单位。

我试过传递一个二进制字符串和一个十六进制字符串，但似乎没有任何效果。在 EPL 手册中没有关于如何使用此命令的示例，经过数小时的在线搜索后，我无法找到如何使用该命令的单个示例（即我可以复制和粘贴以发送到的示例 EPL 命令打印机）。

有谁知道如何使用这个命令？你能给我举个例子吗？（例如，我不是指框架、代码等，我的意思是简单的 EPL 命令）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:26:26.393

我可以确认数据是原始的、未压缩的二进制文件。它也是反转的——也就是说，0 位打印为黑色，至少在我的 UPS 固件 LP-2844 上是这样。我不知道为什么 Zebra 的所有示例都将数据显示为编码为十六进制表示。

值得注意的是，如果您在端口 9100 上向打印机发送数据（使用 netcat例子）：

```
nc printer_hostname_or_ip_address 9100 < test_file.txt 
```

您不会从打印机那里得到任何反馈，除了标签是否已打印。

我的 LP-2844（UPS 固件）打印机大约需要 5-6 秒才能将包含 816 宽 x 1218 高下载位图的标签打印到 4 英寸宽 x 6 英寸高的标签上。这似乎是所有成像时间：一次发送三个标签并没有更快，并且网络连接（通过 Lantronix LPS1-T）保持打开状态，直到最终标签打印。该图像处于打印机的原始分辨率（203 点/英寸），并且没有进行抖动或调整大小（我认为 EPL2 甚至不知道如何抖动或调整大小）。

通过将标签优化为许多较小的位图（以及水平和垂直线段，也许还有填充的矩形块），可以加快成像时间。这不会是一个非常困难的优化，因为图像是一个单比特黑白位图，并且代码会相当简单。不过，我不知道它是否真的会加快速度。

运行 ZPL 并带有内置以太网端口（在线 500 美元）的更现代的 Zebra GX420 可以在 1-2 秒内打印相同的标签（具有基本相同的图形下载编码）。

顺便说一句，由于我还没有真正回答这个问题，因此原始 EPL 代码是：

```
(a blank line)
N
q816
Q1218,20
GW10,10,102,1218,(124236 bytes of inverted bitmap data)
P 
```

所有换行符都是 0x0a（unix 风格）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T20:49:05.380

也许这会[有所帮助](https://support.zebra.com/cpws/docs/eltron/gw_command.htm)，它有示例（并更正了手册中的错误）。此外，使用 GM 命令可能更容易，每次只删除图像（有关[stackexhange 的](https://stackoverflow.com/questions/9829540/printing-with-epl-via-php-storing-images)问题，请参见此处）。

话虽如此，我从来没有让我的 Eltron 成功打印图像（但我的工作不需要它）。

祝你好运！！

编辑：这是另一个带有示例 Perl 代码的[链接。](http://blog.esumina.com/2011/10/printing-bitmaps-and-chinese-to-zebra.html)他们的目标是汉字，但展示了如何打印巨浪图像（奇怪的是日本）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T00:44:17.993

我发现使用 ASCII 字符无法通过 EPL 将图形发送到 Zebra 打印机。数据实际上必须作为 RAW 数据发送。因此，例如，您无法使用 Zebra Setup Utilities 或任何其他无法直接通过打印机从文件写入 RAW 数据的方式将图形发送到打印机。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-16T21:02:03.767

我发现解决此问题的唯一方法是将标签创建为图像，然后通过应用程序中的打印命令将该图像发送到打印机。

# java - 罐子的最佳位置

> ID：12625887
> 
> 赞同：2
> 
> 时间：2012-09-27T16:24:21.753
> 
> 标签：java, tomcat

如果有人可以提供帮助，请快速提出最佳实践问题。

我正在将我的项目实施到运行 tomcat 的网络服务器上。这将托管相当多的域，这些域主要是静态的，只有 HTML 代码。然而，我的包括一个数据库连接器和一些 JAX jar。

我的问题是

作为最佳实践，最好将 .JAR 文件放入 $TOMCAT_HOME/lib 以便它们可用于所有 Web 应用程序（将来可能被其他人使用），或者我应该将它们保存在 WEB-INF/lib 文件夹中是特定于 webapp 的。如果我随后构建另一个使用这些 JAR 的 web 应用程序，我将不得不将它们复制到该新 web 应用程序的 WEB-INF/lib 文件夹中。

我知道它会以任何一种方式工作，但最好的做法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T16:26:15.487

我*倾向于*将它们保留在每个 webapp 上。这使您有机会升级一个 web 应用程序，而无需接触其他应用程序。因此，您可以向一个应用程序推出修复等，而无需重建/重新测试其他应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T20:32:25.237

像 Tomcat 这样的应用服务器被设计成能够将 webapp 相互隔离，使它们能够独立更改，使用相同库的不同版本等。除非你*绝对确定*你的应用*总是*需要相同的版本，并且*总是*准备好同时（或从不）升级到新版本，然后将它们保留在每个 webapp 上更有意义。

# django - Django 平面页面和图像

> ID：12625889
> 
> 赞同：4
> 
> 时间：2012-09-27T16:24:37.900
> 
> 标签：django, django-flatpages

我有兴趣在我的项目中使用 Flatpages 应用程序，但也希望有一个地方（在管理员的某个地方）来上传我想在这些 flatpages 上引用的图像。

有没有办法在不使用 CMS 应用程序的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:49:35.037

最简单的方法是将图像上传到照片托管（picasa、flickr 等）。如果您更喜欢使用 django admin，您可以编写一个具有单个模型的简单应用程序，如下所示：

```
class Image(models.Model):
    title    = models.CharField(max_length=255)
    file    = ImageField(upload_to='car_images')

    def get_absolute_url(self):
        return (self.file and self.file.url) or '' 
```

# iphone - 如何以编程方式制作立方体 cocos3d

> ID：12625892
> 
> 赞同：1
> 
> 时间：2012-09-27T16:24:48.570
> 
> 标签：iphone, objective-c, cocos2d-iphone, cocos3d

```
CC3BoundingBox bounds = makeBounds(9.5, 5.0, 4.0, 0, 0, 0);
CC3MeshNode *cube = [[CC3MeshNode alloc] init];
[cube populateAsSolidBox:bounds]; 
```

我已经尝试过了，但 populateAsSolidBox: 不再存在。如何在最新的 cocos3d 中以编程方式创建一个简单的盒子或立方体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T01:48:28.957

populateAsSolidBox：存在于 cocos 0.7.1 和 0.7.2

请参考[cocos3d的文档](http://brenwill.com/docs/cocos3d/0.7.2/api/interface_c_c3_mesh_node.html#a1ea6896b09a8a424b09452283b8b6702)

顺便说一句，你#import "CC3ParametricMeshNodes.h" 了吗？

您需要确保包含正确的标题。

# c - 创建一个新进程来执行ls命令

> ID：12625898
> 
> 赞同：2
> 
> 时间：2012-09-27T16:25:04.497
> 
> 标签：c, linux, fork

我想编写一个程序来创建一个新进程，并且在该子进程中，它应该执行命令：`ls`。与此同时，父母应该等待孩子死去。但是，我的代码不起作用。

请帮帮我，非常感谢！

```
int main()
{
    char * read;
    size_t size;

    getline(&read , &size , stdin);
    read[strlen(read)-1] = '\0';
    printf("%s\n" , read);
    int status;
    pid_t f;
    if((f = fork()) == 0)   
    {
        execvp(read , &read);
        exit(0);
    }
    else
    {   
        wait(&status);
    }       
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:38:30.083

从[man execvp](http://linux.die.net/man/3/execvp)：

> execv()、execvp() 和 execvpe() 函数提供了一个指向以 null 结尾的字符串的指针数组，这些字符串表示新程序可用的参数列表。按照惯例，第一个参数应该指向与正在执行的文件关联的文件名。**指针数组必须以 NULL 指针终止。**

您需要使用一个数组`char*`并将最后一个元素设置为`NULL`.

我不确定`getline()`正在阅读什么，但我猜它是要`ls`d 的目录。第一个参数`execvp()`应该是`ls`，第二个参数是数组`char*`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T23:19:06.057

考虑以下：

```
#define  _GNU_SOURCE
#define  _POSIX_C_SOURCE 200809L

#include <unistd.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <stdio.h>
#include <string.h>
#include <errno.h>

int main(int argc, char *argv[])
{
    char   *input_arg[2];
    char   *input_str = NULL;
    size_t  input_len = 0;
    char  **args;
    ssize_t len;
    size_t  n;
    pid_t   child, p;
    int     status;

    if (argc < 2) {

        /* No command line parameters. Read command from stdin. */
        len = getline(&input_str, &input_len, stdin);

        /* Find length excluding the newline at end. */
        if (len > (ssize_t)0)
            n = strcspn(input_str, "\r\n");
        else
            n = 0;

        if (n > (size_t)0) {

            /* Terminate input command before the newline. */
            input_str[n] = '\0';

        } else {

            fprintf(stderr, "No input, no command.\n");
            return 1;
        }

        input_arg[0] = input_str;
        input_arg[1] = NULL;
        args = input_arg;

    } else {

        /* Use command line parameters */
        argv[argc] = NULL;
        args = argv + 1;
    }

    child = fork();
    if (child == (pid_t)-1) {
        fprintf(stderr, "Cannot fork: %s.\n", strerror(errno));
        return 1;
    }

    if (!child) {
        /* This is the child process. */

        errno = ENOENT;
        execvp(args[0], args);

        fprintf(stderr, "%s: %s.\n", args[0], strerror(errno));
        exit(127);
    }

    do {
        p = waitpid(child, &status, 0);
    } while (p == (pid_t)-1 && errno == EINTR);
    if (p == (pid_t)-1) {
        fprintf(stderr, "Lost child process: %s.\n", strerror(errno));
        return 127;

    }
    if (p != child) {
        fprintf(stderr, "waitpid() library bug occurred.\n");
        return 127;

    }

    if (WIFEXITED(status)) {
       if (!WEXITSTATUS(status))
           fprintf(stderr, "Command successful.\n");
       else
           fprintf(stderr, "Command failed with exit status %d.\n", WEXITSTATUS(status));
       return WEXITSTATUS(status);
    }

    if (WIFSIGNALED(status)) {
        fprintf(stderr, "Command died by signal %s.\n", strsignal(WTERMSIG(status)));
        return 126;
    }

    fprintf(stderr, "Command died from unknown causes.\n");
    return 125;
} 
```

如果指定，上面使用命令行参数，否则它从标准输入中读取一个。由于标准输入未标记化，因此您只能提供命令名称，不能提供参数。如果将`input_arg[]`数组放大为

```
 char   *input_arg[4]; 
```

并将分配修改为

```
 input_arg[0] = "/bin/sh";
    input_arg[1] = "-c";
    input_arg[2] = input_str;
    input_arg[3] = NULL;
    args = input_arg; 
```

然后输入字符串将使用`/bin/sh`shell 处理，就像`popen()`做的那样。

您还可以使用`len = getdelim(&input_str, &input_len, '\0', stdin);`和删除`input_str[n] = '\0';`分配以允许多行输入；只要它足够短以适合命令行参数缓冲区（最大长度取决于您的操作系统），shell 应该可以很好地处理这些问题。

Shell 如何将输入拆分为单独的命令和参数的规则相当复杂，您不应尝试模仿它们。相反，为用户找到一种简单的方法来单独指定参数（如命令行参数大小写），或者使用 shell 为您完成。如果您不进行任何拆分，您可能需要删除输入行末尾的换行符。

需要注意的一点是 for`execvp(file, args)`是`args[0]`应用程序看到的名称（如`$0`or `argv[0]`），并且`args[1]`是第*一个*参数。每个参数都由 NUL ( `\0`) 终止，就像字符串通常在 C 中一样，并且`args`指针数组必须以指针结尾`NULL`。如果没有参数，则`args[1] == NULL`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:30:50.970

为什么不直接使用系统命令...

```
#include <stdio.h>
#include <stdlib.h>

int main ()
{
  int i;
  printf ("Executing command ls...\n");
  i=system ("ls");
  printf ("The value returned was: %d.\n",i);
  return 0;
} 
```

* * *

更新：

```
#include  <stdio.h>
#include  <sys/types.h>
#include <stdlib.h>

void  main(void)
{
     pid_t  pid;

     pid = fork();
     if (pid == 0) // this is child process
     {
      int i;
      printf ("Executing command ls...\n");
      i=system ("ls");
      printf ("The value returned was: %d.\n",i);
     }
     else // this is paraent process 
     {
      int status=0
      wait(&status);
      printf ("Child process is returned with: %d.\n",status);
      }
} 
```

# javascript - Slickgrid 自动编辑特定列

> ID：12625905
> 
> 赞同：2
> 
> 时间：2012-09-27T16:25:26.717
> 
> 标签：javascript, slickgrid

如何将特定的 SlickGrid 列设置为自动编辑？

`autoEdit`是网格的一个属性，但它适用于所有列。我只需要将第一列设置为自动编辑。我怀疑我可以订阅该`onActiveCellChanged`事件，但需要有关如何指示 SlickGrid 进入编辑模式的帮助。

# windows-phone-7 - 获取“在独立存储文件流上不允许操作”保存 jpg

> ID：12625910
> 
> 赞同：2
> 
> 时间：2012-09-27T16:26:08.600
> 
> 标签：windows-phone-7, isolatedstorage

怎么了？我在此行中收到此错误“在 IsolatedStorageFileStream 上不允许操作”：

```
using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile("folder\\" + fileName, FileMode.Create)) 
```

第一次运行正常，但第二次不行。

```
string nameFile= e.UserState.ToString();
Stream stream = e.Result;   
using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
{
    if (!myIsolatedStorage.DirectoryExists("folder"))
    {
        myIsolatedStorage.CreateDirectory("folder");
        infoTextBlock.Text = "'folder' created...";
    }
    using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile("folder\\" + fileName, FileMode.Create))
    {
        stream.CopyTo(fileStream);                                
    }
} 
```

## 更新

回答问题：

**例外：**

[System.IO.IsolatedStorage.IsolatedStorageException] = {“IsolatedStorageFileStream 上不允许操作。”}

**堆栈跟踪：**

```
 at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, IsolatedStorageFile isf)
   at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, IsolatedStorageFile isf)
   at NameApp.Backup.client_DownloadImatgesCompleted(Object sender, LiveDownloadCompletedEventArgs e)
   at Microsoft.Live.LiveConnectClient.<>c__DisplayClass6.<RaiseDownloadCompletedEvent>b__4()
   at Microsoft.Live.SynchronizationContextWrapper.<>c__DisplayClass2.<Post>b__0(Object state)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(RuntimeMethodInfo rtmi, Object obj, BindingFlags invokeAttr, Binder binder, Object parameters, CultureInfo culture, Boolean isBinderDefault, Assembly caller, Boolean verifyAccess, StackCrawlMark& stackMark)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, StackCrawlMark& stackMark)
   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
   at System.Delegate.DynamicInvokeOne(Object[] args)
   at System.MulticastDelegate.DynamicInvokeImpl(Object[] args)
   at System.Delegate.DynamicInvoke(Object[] args)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.Dispatch(DispatcherPriority priority)
   at System.Windows.Threading.Dispatcher.OnInvoke(Object context)
   at System.Windows.Hosting.CallbackCookie.Invoke(Object[] args)
   at System.Windows.Hosting.DelegateWrapper.InternalInvoke(Object[] args)
   at System.Windows.RuntimeHost.ManagedHost.InvokeDelegate(IntPtr pHandle, Int32 nParamCount, ScriptParam[] pParams, ScriptParam& pResult) 
```

**我在我正在使用的地方放置断点（fileStream），这些是文件名：**

第一次运行：

文件名：

*   控制图片.txt
*   PhotoChooser-c197865c-cbe6-4202-a95f-e4eeb16da943.jpg
*   PhotoChooser-d1d0c947-664f-425b-aaa2-85b17a4a73ec.jpg
*   PhotoChooser-4ce1b884-8d7f-444e-925d-2ca2ae2b3b7c.jpg

第二次运行：

文件名：

*   控制图片.txt

这里崩溃，但变量“NameFile”包含正确的名称：

*   PhotoChooser-c197865c-cbe6-4202-a95f-e4eeb16da943.jpg
*   PhotoChooser-d1d0c947-664f-425b-aaa2-85b17a4a73ec.jpg
*   PhotoChooser-4ce1b884-8d7f-444e-925d-2ca2ae2b3b7c.jpg

## 更新 2

我已经看到上传文件后出现问题。我发现当我尝试打开、删除、覆盖等之前上传的文件时出现异常...

我正在使用这段代码：

```
private void UploadFilePictures()

using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
{
   this.client.UploadCompleted
                    += new EventHandler<LiveOperationCompletedEventArgs>(ISFileImatges_UploadCompleted);

   foreach (string fileName in myIsolatedStorage.GetFileNames("folder\\*.jpg"))
   {

      fileStream = myIsolatedStorage.OpenFile("folder\\" + fileName, FileMode.Open, FileAccess.Read);
      this.client.UploadAsync(skyCarpetaImatges_ID, fileName, true, fileStream, null);    
   }
}
}

   private void ISFileImatges_UploadCompleted(object sender, LiveOperationCompletedEventArgs args)
{
              fileStream.Close();
              fileStream.Dispose()

    this.client.UploadCompleted -= new EventHandler<LiveOperationCompletedEventArgs>(ISFileImatges_UploadCompleted);
} 
```

## 解决方案：

在标记的解决方案中查看评论

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T05:08:19.363

试试这个：

```
using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
{
    using (var stream = new IsolatedStorageFileStream("folder\\" + fileName,FileMode.Create,FileAccess.Write,myIsolatedStorage ))
     {
            using (StreamWriter writer = new StreamWriter(stream))
            {
                  writer.WriteLine(data);
                  writer.Close();
            }
            stream.Close();
      }
} 
```

我希望它有所帮助。

# javascript - jQuery点击事件可以解除绑定或重置吗？

> ID：12625919
> 
> 赞同：2
> 
> 时间：2012-09-27T16:27:00.147
> 
> 标签：javascript, jquery, html, memory-leaks

我在我正在处理的网页上发现了资源泄漏。

该网页有两个文本字段，单击时显示模式对话框，向后端执行数据请求，然后在表格中显示该信息，用户可以从中选择一个条目以在他们最初单击的文本框中使用。

我将点击事件绑定到文本框，如下所示：

```
var $field = $('#one-of-the-text-fields');

$field.click(function () {
        App.DialogClass.show();
        App.DialogClass.PopulateTable();
        App.DialogClass.GotoPageButtonAction(actionArgs);  // Offender!
}); 
```

...调用...

```
App.DialogClass = (function($) {

var pub {},
    $gotoPage = $('#pageNumberNavigationField'),
    $gotoPageButton = $('#pageNumberNavigationButton');

// ...SNIP unimportant other details...

pub.GotoPageButtonAction = function (args) {
    $gotoPageButton.click(function () {
        var pageNumber = $gotoPage.val();
        pub.PopulateTable(args);   // Breakpoint inserted here...
    });
};

return pub;

})(jQuery); 
```

我注意到泄漏是因为当我使用 Chrome 的 JavaScript 调试器运行时，每次单击不同的按钮时总是会遇到一个额外的断点（例如，当我第一次单击字段 A 时，断点会被命中两次。当我点击字段时B之后，断点被击中3次。如果我在*那*之后点击A ，断点被击中四次。根据需要外推。）

在我的代码中，我没有对给定字段的现有点击事件做任何事情。我怀疑我的泄漏源于事件没有得到清理的事实。话虽如此，我对 JavaScript/jQuery 也不是很熟悉。从控件中删除点击事件有哪些技巧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:30:11.330

当然。只需解开它们：

```
$field.unbind('click'); 
```

但是，请记住，这将删除*所有*单击事件处理程序，而不仅仅是您的。为了安全起见，您应该在绑定处理程序时使用命名空间：

```
$field.bind('click.mynamespace', function(){
    // do something
}); 
```

然后，

```
$field.unbind('click.mynamespace'); 
```

因此，只有您的处理程序将被删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T16:36:01.667

如果您使用**.bind()**绑定它们**.unbind()**删除事件

如果您使用**.on()**绑定它们.off **()**删除事件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T16:28:22.450

JQuery 提供了[unbind](http://api.jquery.com/unbind/)函数来取消绑定事件监听器。

请注意，您也可以使用[removeEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.removeEventListener)在 vanilla JS 中执行此操作。

但是，您可能不应该每次都绑定，而不是取消绑定`GotoPageButtonAction`：一次就足够了。

# c - 为什么将 printf 的结果传递给另一个 printf 工作？

> ID：12625920
> 
> 赞同：4
> 
> 时间：2012-09-27T16:27:01.640
> 
> 标签：c, printf

以下代码如何工作？

```
void main()
{
    printf("%d", printf("earth"));
} 
```

这给出了输出：`earth5`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T16:29:22.093

的返回值`printf`是打印的字符数。`printf`首先调用内部。相当于：

```
int rc = printf("earth");
printf("%d", rc); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T16:32:32.657

这绝对没问题:-)

print("earth") 输出 earth 并返回 5（打印的字符数）。

另一个 printf 获取 5 作为参数并将其输出为整数（因为 %d）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T16:31:40.020

`%d`期望一个整数来打印它。`printf`返回打印的字符数，并且您正在打印一个 5 字符的字符串。

它首先评估内部打印以找出打印了多少个字符，然后评估外部打印 5。

# javascript - 动态更新所有出现的 至

> ID：12625922
> 
> 赞同：0
> 
> 时间：2012-09-27T16:27:04.887
> 
> 标签：javascript, css

我有很多使用无法正常工作的旧嵌套列表的 html 页面。我想动态查看页面是否使用它并添加类属性或建议更好的方法来执行此操作。

动态更新所有出现的

```
<ol type="a"> to <ol class="alpha"> 
```

或者建议是否有办法我仍然可以使用该类型但使用嵌入式 CSS 应用样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:34:58.507

如果你想用 JavaScript 做到这一点，用 jQuery 很容易：

```
$(document).ready(function(e) {
    $('ol[type="a"]').addClass("alpha").removeAttr("type");
}); 
```

这会将 <ol type="a"> 更改为 <ol class="alpha">，方法是选择带有 type="a" 的 ol，然后添加 alpha 类，然后删除 type 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:29:56.980

在不使用 JavaScript 的情况下，您可以使用 CSS 属性选择器：

```
ol[type=a] {
    color: red;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/UQ7XG/1/)。

重要的是要注意，这也可能“无法正常工作”（我在第一次阅读您的问题时错过了这个短语），这取决于“不工作”是如何表现出来的，或者是什么不起作用。

如果您觉得必须使用 JavaScript，那么以下方法有效：

```
var ols = document.getElementsByTagName('ol');

for (var i=0, len=ols.length; i<len; i++){
    ols[i].className = ols[i].type == 'a' ? 'alpha' : '';
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/UQ7XG/2/)。

如果要在`type`设置类后删除该属性：

```
var ols = document.getElementsByTagName('ol');

for (var i=0, len=ols.length; i<len; i++){
    if (ols[i].type == 'a') {
        ols[i].className = 'alpha';
        ols[i].removeAttribute('type');
    }        
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/UQ7XG/3/)。

# c# - JQuery 和 Razor 控制器查看 ActionResult

> ID：12625926
> 
> 赞同：0
> 
> 时间：2012-09-27T16:27:21.813
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, razor

我有一个控制器可以返回这样的成功或错误页面：

```
[HttpPost]
public ActionResult File_post(HttpPostedFileBase file)
{
   if (...)
      return View("Success");
   else
      return View("Error");
} 
```

这些成功和错误页面仅包含基本文本并显示在 Shared/_Layout.cshtml 中。

在我的 js 中，我想调用返回视图定义的那些页面，但我该怎么做呢？

我测试了：`window.location.reload();`
哪个有效，但它只会重新加载实际的索引页面。
如果我尝试：`window.location.href = data.url;`
它会失败，因为页面**http://xxx/xxx/File_post**不存在。
如果我这样做：`$('#main').html(data);`
页面看起来不错，但内容是空的。

**编辑：**我正在使用 jquery.fileupload 所以我有：

```
 <input id="fileupload" type="file" name="file" /> 
```

和

```
$('#fileupload').fileupload(
{
  done: function (e, data) {
    // Use the return View("Success")
  },
  fail: function (e, data) {
    // Use the return View("Error")
  }
}); 
```

在我的 jqXHR.reponseText 和 data.result 中有很好的“成功”或“错误”html，所以我想我需要用这个填充页面但是如何？

有任何想法吗 ？多谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T09:45:34.653

我找到了怎么做。正如我在布局中所做的`<div id="main">` 那样，我可以使用我的 data.result 用我的“成功”或“错误”消息填充页面。所以我有 ：

```
done: function (e, data) {
  $('#main').html(data.result);
} 
```

和

```
return PartialView("Success"); 
```

现在页面已正确显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:48:22.193

您可以尝试使用此代码

```
$.ajax({
 type: "POST",
 url: Settings.YourUrl,
 data: "{queryString:'" + searchVal + "'}",
 contentType: "application/json; charset=utf-8",
 dataType: "html",
 success: function (data) {
 alert("here" + data.d.toString());
}); 
```

在您的视图中，您可以添加此代码

```
var Settings= {
    YourUrl: '@Url.Action("Action","Controller")'
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:51:22.717

当前操作只能处理 POST 请求。因此，您可以创建另一个操作来返回 GET 请求的视图。

前任。

```
public ViewResult Success()
{
   return View();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T07:54:08.900

您可以将 statusCode 更改为 500 或您需要的错误代码；

C＃

```
[HttpPost]
public ActionResult File_post(HttpPostedFileBase file)
{
   if (...) 
   {
      return View("Success");
   }
   else
   {
      Response.StatusCode = 500;
      Response.TrySkipIisCustomErrors = true; 
      return View("Error");
   }
} 
```

JS：

```
$('#fileupload').fileupload(
{
  done: function (e, data) {
    // Use the return View("Success")
  },
  fail: function (e, data) { // http status response != 200
    // Use the return View("Error")
  }
}); 
```

# c# - 多个包括使用实体框架和存储库模式

> ID：12625929
> 
> 赞同：1
> 
> 时间：2012-09-27T16:27:23.730
> 
> 标签：c#, entity-framework, generics, repository-pattern

我正在使用实体框架和存储库模式进行所有数据访问，当使用表导航时，我注意到当我获得第一个对象并引用导航对象中的字段时正在运行 2 个查询。由于我在数据库中有很多关系，将这种技术用于我的导航属性可能会导致性能开销。

我研究了这个`Include(string tableName)`方法，这会很好用（如果我没有使用通用 RP），但这只需要一个表名。我已经设法通过更改我的 where from`classs`来在我的存储库模式中为一个包含复制此内容，`EntityObject`但是如何使用存储库模式在一个查询中包含多个包含？

这是我的代码：

```
public class GenericRepository<T> : IRepository<T> where T : EntityObject, new()
{
    private Entities _Context;
    private ObjectSet<T> _ObjectSet;

    public IQueryable<T> FindBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate, string include)
    {
        // This works OK
        return this._ObjectSet.Include(include).Where(predicate);
    }

    public IQueryable<T> FindBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate, param string[] include)
    {
        // This will not work but is what I am trying to do
        return this._ObjectSet.Include(include).Where(predicate);
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T16:36:11.683

您可以链接您的包含：

```
public IQueryable<T> FindBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate, param string[] include)
{
    IQueryable<T> query = this._ObjectSet;
    foreach(string inc in include)
    {
       query = query.Include(inc);
    }

    return query.Where(predicate);
} 
```

# r - 如何在 R 中为所有 plot.default、plot 或 lines 调用默认设置颜色

> ID：12625931
> 
> 赞同：7
> 
> 时间：2012-09-27T16:27:34.793
> 
> 标签：r, colors, plot, default

为了简化我的日常 R 交互，我想为我的所有绘图设置默认颜色。例如，假设我想用红线制作所有图（如 gnuplot...:-)）

到目前为止，这是我的 .Rprofile 的片段

```
setHook(packageEvent("grDevices", "onLoad"), 
    function(...) 
        grDevices::X11.options(width = 14, height = 8, type = "Xlib", xpos = 600,     ypos = 30, canvas = "grey87"))

suppressPackageStartupMessages( require(Defaults) )
suppressPackageStartupMessages( require(utils) )
suppressPackageStartupMessages( require(graphics) )

setDefaults("plot.default",frame.plot=FALSE, type='l', col=2) 
```

我在这里所做的如下：`grDevices`加载包时（通过加载`graphics`包），我`X11.options`使用我喜欢的参数调用：更宽的框，浅灰色背景，xlib 调用（因为我正在进行远程调用，而 cairo in我当前的环境太慢了（另一个需要解决的问题））然后我默默地加载了 3 个包`Defaults`，`utils`和`graphics`. 需要第二个来避免`find`函数错误消息。

最后，魔术函数`setDefaults`为散点图函数设置了 3 个参数`plot.default`。第三个参数`col`不是函数的参数，`plot.default`而是`par()`函数的一个参数。

但是，`setDefaults`打电话`par`也不起作用。

欢迎任何解决方案...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T20:07:23.793

每次打开新的图形框架时，您都可以使用该`"plot.new"`挂钩设置默认值。`par`（钩子的工作方式记录在`?plot.new`和`?setHook`）

在您的情况下，只需将此行添加到您的 .Rprofile 中：

```
setHook("plot.new", function() par(col = "red")) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T19:01:18.137

颜色等参数是基于每个设备设置的，因此当您关闭一台设备并创建新设备时，所有参数都会设置回其默认值。为此，我将创建您自己的设备功能，打开设备然后设置参数，例如：

```
mydev.new <- function(...) {
  dev.new(...)
  par(col='red')
} 
```

您显然可以替换`dev.new`为`x11`或其他东西，但这可能是最便携的。现在您可以使用打开一个新设备`mydev.new`，默认颜色将设置为红色。

此外，如果您运行命令

```
options(device=mydev.new) 
```

然后，当您没有打开图形设备并运行绘图命令时，您的函数将运行以打开新的绘图设备，因此在这种情况下默认值也将为红色。您可以扩展该`mydev.new`函数（或任何您想调用的函数）以针对您可能想要使用的不同情况设置其他选项、​​获取参数等。

# javascript - jQuery UI 可拖动元素放入可排序

> ID：12625935
> 
> 赞同：6
> 
> 时间：2012-09-27T16:27:53.187
> 
> 标签：javascript, jquery, jquery-ui, draggable, droppable

我有一个可拖动项目的列表，我希望能够将它们拖动到可排序的内容块上。这是我的标记：

```
<div class='items'>
    <div class="one">One</div>
    <div class="two">Two</div>
</div>

<div class="content">
    <div class="block">Foo</div>
    <div class="block">Bar</div>
</div> 
```

问题是，我希望拖动的项目在拖动开始后立即“成为”一个块，并在它被放下时保持一个块。我试过这个：

```
$('.items div').draggable({
    helper: function(e) {
        return $('<div>').addClass('block').text( $(e.target).text() );
    },
    connectToSortable: ".content"
});

$('.content').sortable();​ 
```

**小提琴：http: [//jsfiddle.net/MF4qu/](http://jsfiddle.net/MF4qu/)**

但是，即使我创建了一个看起来像块的自定义助手，它也会在它被放下后立即恢复为原始拖动的元素。有谁知道如何在我的示例页面中正确插入一个块？我已经查看了 UI API，但我无法弄清楚。

```
​ 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-27T19:21:30.683

当可拖动元素被放入可排序时，它会触发可排序`update`事件。一种解决方案是监听该事件，并将丢弃的项目变成一个块：

```
$('.items div').draggable({
    helper: function(e) {
        return $('<div>').addClass('block').text( $(e.target).text() );
    },
    connectToSortable: ".content"
});

$('.content').sortable({
    update: function (event, ui) {
        ui.item.addClass('block');
    }
});​ 
```

**工作演示：http:** [//jsfiddle.net/DaXuT/1/](http://jsfiddle.net/DaXuT/1/)

# c# - 使用 linq-to-sql 删除记录列表

> ID：12625936
> 
> 赞同：2
> 
> 时间：2012-09-27T16:27:53.467
> 
> 标签：c#, linq-to-sql

我正在编写一个 linq-to-sql 查询来删除记录列表：我传入一个 RecordID 列表，我希望删除相应的记录。

这是我到目前为止所拥有的：

```
public void DeleteMyRecords(List<long> TheRecordIDs)
{
   using (TheDC MyDC = new TheDC()) //TheDC is the DataContext 
   {
       MyDC.DeleteOnSubmit(from a in MyDC.TheTable
                           where TheRecordIDs.Contains(a.RecordID)
                           select a).SubmitChanges(); 
   }
} 
```

现在，我看到`DeleteOnSubmit`红色下划线。您如何编写这样的查询以使其正常工作？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:30:39.673

由于查询可能返回多于一条记录，您可能需要调用`DeleteAllOnSubmit`

```
var records = from a in MyDC.TheTable
                           where TheRecordIDs.Contains(a.RecordID)
                           select a;

MyDC.TheTables.DeleteAllOnSubmit(records); 
MyDc.SubmitChanges(); 
```

# ruby-on-rails - 如何在载波中访问模型？

> ID：12625937
> 
> 赞同：0
> 
> 时间：2012-09-27T16:28:03.823
> 
> 标签：ruby-on-rails, carrierwave

我按照下面的方式执行此操作，但它返回“无文本”。如何在载波中正确访问模型？

# photo_uploader.rb

```
process :poster

def poster
 manipulate! format:"jpg" do |source|
  txt = Magick::Draw.new
  txt.pointsize = 20
  txt.gravity = Magick::SouthGravity
  txt.fill = "white"
  source.border(50, 50, "black").annotate(txt, 0, 0, 0, 0, "#{model.title}" )

 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:47:01.257

您可以通过这种方式访问​​模型。所有错误意味着模型的标题字段中实际上没有文本。如果您检查 params 哈希，您可能会看到

```
"my_model"=>{"title"=>"", "image"=> ...) 
```

因此，您应该检查控制器中的非空白标题：

```
unless params[:title].blank?
    MyModel.create(params[:my_model])
end 
```

# sql-server-2008 - 哪个查询具有更好的性能 - 带有 case 语句的 where 子句？

> ID：12625938
> 
> 赞同：0
> 
> 时间：2012-09-27T16:28:05.697
> 
> 标签：sql-server-2008

Cars 是一个具有 CarType 列的表。CarType 是非空的，可以包含 2 个值。CarDonated 和 CarSold。

我们从报告中传入一个参数以包含所有 CarType 或特定的 CarType（例如 CarDonated）。

场景 1 中的参数传入“Car”（对于所有 CarTypes）、“CarD”用于 CarDonated、“CarS”用于 CarSold。

```
select *
from Cars c
where c.CarType like @CarTypeParam + '%' 
```

或者

场景 2 中的参数传入 '0'（适用于所有 CarTypes）、'CarDonated'、'CarSold'

```
select *
from Cars c
where c.CarType = case when @CarTypeParam = '0' 
                   then c.CarType
                   else @CarTypeParam 
                  end 
```

哪种场景/编码方法更好？我不太熟悉在 where 子句中使用 case 语句。在这两种情况下，优化器是否仍然能够在 CarType 上使用索引？哪个编码更好？

SQL Server 2008 R2（连同 SSRS）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:31:49.553

第一个可能稍微好一点，因为`CarType like @CarTypeParam + '%'`至少可以对索引进行范围搜索，`CarType`而`CASE`表达式完全不可分割。

如果只有 50% 的选择性，则无论如何都不太可能使用索引，除非您碰巧有一个索引，其前导列`CarType`覆盖了查询中的所有列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:51:20.347

Gabe - 确定这一点的最佳方法是自己测试它。查看为两者生成的查询计划，并确保至少两个查询都在进行搜索而不是扫描。然后，我将在使用 Profiler 监视服务器的同时运行这些查询，以检查每个正在执行的读取次数，以及可能使用更多的整体资源。对于您正在编写的任何查询，这都是合理的建议。

# azure - Azure SQL Server 防火墙 IP 地址范围

> ID：12625945
> 
> 赞同：13
> 
> 时间：2012-09-27T16:28:12.937
> 
> 标签：azure

从 Azure MySQL 迁移到 SQL Server，我需要指定可以访问 Db 的 IP 地址范围。

0.0.0.0 到 255.255.255.255 的范围可以输入吗？是否有一系列 IP 地址会给我一个“全部允许”。对我来说，知道请求来自哪里并不断更新数据库防火墙规则是不切实际的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T16:40:15.037

> 0.0.0.0 到 255.255.255.255 的范围可以输入吗？是否有一系列 IP 地址会给我一个“全部允许”。对我来说，知道请求来自哪里并不断更新数据库防火墙规则是不切实际的。

是的，这将允许从每个 IP 地址访问您的 SQL Azure 数据库，但当然不推荐这样做。当您提到您不知道从哪里收到请求时，您是指对您的应用程序的请求还是连接到数据库的请求？如果是对您的应用程序的请求，您实际上不需要指定此范围。您可以只指定 0.0.0.0，这将允许您在 Windows Azure 中运行的应用程序访问此数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-16T19:07:26.020

每次您希望从新的连接时，我建议您使用适用于 mac 的 powershell / Azure 命令行工具 ( [http://azure.microsoft.com/en-us/documentation/articles/command-line-tools/](http://azure.microsoft.com/en-us/documentation/articles/command-line-tools/) ) 运行脚本知识产权。

如果使用 Mac 使用命令行工具链接您的 Azure 订阅，则：

```
#!/bin/bash

externalIP=$(curl -s icanhazip.com)

ruleName="temp$externalIP"

回声“$外部IP”

azure sql firewallrule create [ServerName] "$ruleName" "$externalIP" "$externalIP"

```

将其保存为 azureip.sh 并从终端运行。

如果使用 Windows，有很多使用 PowerShell 的示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-24T16:19:09.787

添加到 Ronald 的解决方案，删除现有的临时规则并使用 ipv4 端点。

```
#!/bin/bash

server="yourservername"
azure sql firewallrule list $server | awk '{print $2}'  | grep temp | while read line ; do azure sql firewallrule delete $server  $line -q ; done

externalIP=$(curl -s ipv4.icanhazip.com)

ruleName="temp$externalIP"

azure sql firewallrule create $server "$ruleName" "$externalIP" "$externalIP" 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-03-09T08:02:23.700

它很旧，但刚到这里，我猜 Azure SQL 数据库服务器（配置选项卡）下允许服务是或否。将其切换为是

# jsp - jsp文件中的引导工具提示...再次

> ID：12625947
> 
> 赞同：2
> 
> 时间：2012-09-27T16:28:17.270
> 
> 标签：jsp, twitter-bootstrap, tooltip

再次抱歉，但我无法使其与现有解决方案一起使用。这是在 Tomcat 7 中运行的 .jsp 文件。

```
<head>
 ...
<link href="bootstrap.css" rel="stylesheet" type="text/css" />
<script src="bootstrap.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"
                type="text/javascript"></script>
<script type='text/javascript'>
$(document).ready(function() {
   $("[rel=tooltip]").tooltip();
});
</script>
</head>
<body>
...
<a href="#" rel="tooltip" data-title="tooltip" data-content="hallo" data-placement="right">Tooltip on
                        right</a>
... 
```

通常这应该工作不应该吗？已经尝试在 html 文件的正文或末尾获取 .js 内容。它没有显示工具提示。也许它在jsp文件中不起作用？oO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T14:57:03.897

尝试在引导之前调用 jquery：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<script src="bootstrap.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-23T22:13:35.477

就我而言，我使用输入：

```
<input type="text" title="Tooltip on right." data-toggle="tooltip" class="form-control tooltip-demo" placeholder=""> 
```

以及他各自的剧本：

```
<script>
   $(function () {
     $('[data-toggle="tooltip"]').tooltip({
          track: false,
          position: {my: "left+10", at: "right"}
      });
   })
</script> 
```

# iphone - 浮动：对；导致元素在 iPhone/iPad 上的容器外破坏的元素

> ID：12625949
> 
> 赞同：2
> 
> 时间：2012-09-27T16:28:20.887
> 
> 标签：iphone, html, ios, css, ipad

我正在尝试修复我的网站上发生在 iPhone 和 iPad 上的错误。

您可以在此处查看页面： [http ://revivelab.com/demo_sites/iphoner/](http://revivelab.com/demo_sites/iphoner/)

这就是我所指的休息时间：

![在此处输入图像描述](../Images/0503133999feb64a261ae06f608dccf2.png)

当您将它加载到 iPhone 上时，它起初看起来还不错，但如果您放大，元素会弹出其包含的 div 之外。

棕色/卡其色背景应用于宽度为 100% 的 div，然后将宽度为 1024px 的 div 置于其内部并居中，蓝绿色框位于该 div 内部。当它破裂时，它甚至会在 100% 宽度的容器之外破裂。

有没有人遇到过这个？任何解决方案的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:05:25.397

问题似乎来自大多数移动浏览器中父元素大小和默认视口大小的不匹配。

iPad 和 iPhone 默认视空间为模拟的 980px 宽度，您分配给元素的最小尺寸为 986px，它的子元素 #content_container 的宽度为 100%。

现在 #content 元素的计算宽度为 1024 像素，带有填充（大于父最小值）。

然后 .content_left 元素的实际宽度为 1024 像素，超出其父级实际宽度 1014 像素。

所以在我看来你需要让这些尺寸网格化。我有两个选择，我认为可以解决这个问题。

(1) 将#content 和 .content_left 元素的大小减小到970px，将标签的最小尺寸减小到980px。

(2) 添加一个视口元标记来简单地将页面扩展到您最终得到的 1034px 宽度之外

```
<meta name="viewport" content="width=1034"> 
```

我希望这有帮助。

# python - python终止/杀死子进程组

> ID：12625951
> 
> 赞同：3
> 
> 时间：2012-09-27T16:28:22.760
> 
> 标签：python, subprocess, popen, kill, kill-process

我有一些 python 脚本通过 subprocess.Popen() 以级联方式打开自己。

（我打电话给script1.py，他制作了script2.py的popen，他制作了script3.py等的popen）

有没有办法从 script1.py PID 终止/杀死 script1.py 的所有子进程。

os.killpg() 不起作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T20:33:07.430

通过在script2.py执行开始时改变gid，后续进程属于script2 gid。因此，使用 script2 的 pid 从 script1.py 调用 killpg() 效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T12:27:05.690

在 script1.py 中，杀死打开到 script2.py 的子进程。

```
Popen.terminate() 
```

或 Popen.kill()

# sml - SML - 未捕获的异常为空

> ID：12625954
> 
> 赞同：2
> 
> 时间：2012-09-27T16:28:24.730
> 
> 标签：sml

我正在尝试编写一个 SML 程序来检查矩阵是否是奇异的。矩阵已表示为列表列表。示例 [[1,2],[3,4],[15,50]] 是有效的，但 [[1,2],[1,2,3]] 不是。

```
fun remove (l,r)= 
    let fun iter(front,l,i)= 
      if i=r then front@tl(l) 
      else
        iter(front@[hd(l)],tl(l),i+1)
    in 
    iter([],l,1) end;

fun removed (l,r)=
    let fun iter(l,m)=if tl(l)=[] 
      then m@[remove (hd(l),r)] 
      else iter(tl(l),m@[remove (hd(l),r)])
    in
    iter(tl(l),[]) end;

fun nth (l,i)=let fun iter(l,c)=if i=c then hd(l) else iter(tl(l),c+1) in iter(l,1) end;

fun deter (l)=let fun iter(det,i,j)=if i=(length l)+1 then det else iter (det+j*(nth (hd(l),i))*(deter (removed(l,i))),i+1,j*(~1))
                 in iter(0,1,1) end 
```

函数deter被定义但是当我给它一个输入时，会发生未捕获异常为空的错误。请帮我调试一下。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T16:54:11.877

问题源于试图调用一个`hd`或`tl`一个空列表。

避免此类问题的最佳方法是尽可能避免使用这些功能。100 次中有 99 次，您可以使用模式匹配代替，然后编译器将检查您是否同时处理非空列表和空列表。

要在列表上使用模式匹配，您可以使用类似于以下模式的内容：

代替

```
fun f ls = ... (* code where you use hd ls, tl ls *) 
```

利用

```
fun f (x::xs) = ... (* non-empty list; x = the head, xs = the tail *)
  | f []      = ... (* empty list *) 
```

# c# - 无法将 int 参数传递给 Crystal Report

> ID：12625956
> 
> 赞同：2
> 
> 时间：2012-09-27T16:28:27.430
> 
> 标签：c#, visual-studio-2010, crystal-reports-xi

我有一个带有单个参数的简单水晶报表，它应该在报表上生成一个项目。我已经列出了下面的代码，以及报告中的参数设置。当我尝试将报告打印到打印机（代码片段中的最后一行）时，我收到以下异常；

CrystalDecisions.CrystalReports.Engine.ParameterFieldCurrentValueException 未处理 消息=缺少参数值。

我也尝试过使用 ParameterFieldDefinitions 和 ParameterFieldDefinition 对象的报告，但我最终得到了相同的结果。

任何帮助将不胜感激。

```
 ReportDocument loReport = new ReportDocument();

        loReport.Load(path+"InventoryItemsBarCodeLabel.rpt");

        SqlConnectionStringBuilder loConnectionString = new SqlConnectionStringBuilder(ConnectionUtilities.getConnectionString());

        ParameterValues currentParameterValues = new ParameterValues();
        ParameterDiscreteValue parameterDiscreteValue = new ParameterDiscreteValue();
        parameterDiscreteValue.Value = Convert.ToInt32(psMasterId);

        loReport.SetParameterValue("pnMasterId", parameterDiscreteValue.Value);
        loReport.SetDatabaseLogon(loConnectionString.UserID,
            loConnectionString.Password,
            loConnectionString.DataSource,
            loConnectionString.InitialCatalog);
        loReport.Refresh();
        loReport.PrintToPrinter(1, false, 1, 1); 
```

报告参数：名称：pmMasterId，类型：数字，值列表：动态，值 = MasterId，描述 = MasterId，参数 = ?pnMasterId

报告选择记录：{Inventory_Items.MasterId} = {?pnMasterId}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T16:46:51.413

在设置参数**之前**尝试移动 SetDatabaseLogon() 方法；我相信它会重置报告文档和之前通过的任何参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T17:00:51.827

您是否尝试过直接设置参数而不是使用 Parameter 对象？

```
loReport.SetParameterValue("pnMasterId", Convert.ToInt32(psMasterId)); 
```

# haskell - 在 Traveler 游戏中实现计时器

> ID：12625963
> 
> 赞同：2
> 
> 时间：2012-09-27T16:29:09.860
> 
> 标签：haskell, frp, reactive-banana

这个问题是我从[这里](https://stackoverflow.com/questions/12292934/functional-banana-traveller-game-intriguing-and-maddening)开始的问题的延续。我正在使用[小行星](https://github.com/HeinrichApfelmus/reactive-banana/blob/master/reactive-banana-wx/src/Asteroids.hs)示例作为工作模型。

我想在这里谈论的问题是计时器问题。小行星示例使用`event0`函数来制作一个，它依赖于`Graphics.UI.WX`库。我不想在这个项目中使用 WX。有人可以告诉我`event0`一般在做什么，以便我可以弄清楚我需要做什么来制作类似的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:02:56.487

要将 reactive-banana 绑定到基于事件的外部框架，无论是 WX 还是其他任何框架，请查看该`Reactive.Banana.Frameworks`模块。

来自 reactive-banana-wx的函数`event0`只是对[`fromAddHandler`](http://hackage.haskell.org/packages/archive/reactive-banana/latest/doc/html/Reactive-Banana-Frameworks.html#v%3afromAddHandler)来自所述模块的函数的一个薄包装。reactive-banana 的示例代码演示了它的用法。

# c++ - 为什么在指定重载类型的返回值时会出现编译错误？

> ID：12625967
> 
> 赞同：1
> 
> 时间：2012-09-27T16:29:26.833
> 
> 标签：c++

我知道在 C++ 中，您可以像函数一样重载运算符。与 C++ 中的函数一样，您必须指定返回值：

```
struct A {

    int operator +();

}; 
```

在这里，我重载`operator+`了一个返回`int`. 但是我发现当我重载一个类型同时给它一个返回值时，我得到`error: return type specified for 'operator int'`.

```
struct A {

    void operator int() {} // error

}; 
```

但是，如果我拿走返回值，它就可以正常工作。

```
struct A {

    operator int() {} // pass

}; 
```

该错误是否意味着通过`int`在函数参数之前使用，我正在创建一个返回`int`. 或者这是一些错误？如果我希望函数不返回值怎么办？有人可以解释为什么我会收到这个错误吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T16:31:44.607

根据定义，`operator int()`返回一个`int`. 它将在`A`需要将类型对象转换为`int`. 这与第一个代码片段完全不同，其中运算符是`operator+()`; 你可以定义它来返回几乎任何你喜欢的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-27T16:31:25.713

好吧，`operator int`是将您的 A 转换为 a 的运算符`int`，因此它已经定义了返回类型，并且通过编写`void operator int`您正在给它*另一个*返回类型！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-27T16:32:49.537

`operator int()`是从您的类型到 的隐式转换运算符`int`。因此它不能有任何返回类型，除非`int`由操作员名称定义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T16:34:26.060

您将普通（一元和二元）运算符与*类型转换*运算符混淆了

# python - win32con.MB_YESNO 和 win32con.MB_OK

> ID：12625969
> 
> 赞同：1
> 
> 时间：2012-09-27T15:58:49.333
> 
> 标签：python, popup

我正在尝试弹出消息窗口，但运气不佳。我想在开始进程之前询问用户是否存在某些文件，然后指示用户下载这些文件（如果它们尚不存在）。我选择使用 win32api.MessageBox / win32con.MB_YESNO 函数抛出一个消息框，询问文件是否存在，然后如果答案为“不”，则使用 win32con.MB_OK 另一个消息框。

脚本运行并出现一个带有是/否按钮的消息框，但如果单击任一按钮，则不会发生任何事情。我实际上必须单击主脚本对话框上的“关闭”按钮，然后只有“否”按钮才能在消息框中起作用。但后来我得到一个因用户错误而取消的进程。

虽然我确信还有另一种方法可以做到这一点，但既然我已经开始走这条路，我决心要弄清楚。有人有什么想法吗？我想我已经检查了 7 页 Google 结果中的每个链接，但仍然不知道我做错了什么。

```
import arcpy, win32com.client, win32api, win32con
from win32con import MB_OK, MB_YESNO

result = win32api.MessageBox(0, "Do the files exist?.", "Shapefiles", win32con.MB_YESNO);
if result == win32con.IDYES:
    pass
else:
    win32api.MessageBox(0, "Please downloaded the windswath and forecast point & lines from HURREVAC and restart the script.", "HURREVAC Shapefiles", win32con.MB_OK);

arcpy.AddMessage("did this work?") 
```

# javascript - 单击选择列表的滚动条时如何保留输入焦点

> ID：12625976
> 
> 赞同：4
> 
> 时间：2012-09-27T16:29:59.770
> 
> 标签：javascript, google-chrome, focus, dom-events, timepicker

我为 mootools 编写了一个小插件，以便将时间选择器附加到输入字段。

它工作得很好，但我注意到在 Chrome 中，当您单击滚动条以导航选择器列表时，输入会失去焦点。在其他浏览器中，它不会失去焦点。

[http://jsfiddle.net/SDBCe/](http://jsfiddle.net/SDBCe/)

```
//the events that close the selector during blur:
el.addEvents({
    'focus': function() {
        TimePicker.active(el);
    },
    'blur': function() {
        setTimeout( function() {
            el.fireEvent('change');
        },150);
    },
    'change': function() {
        TimePicker.validateField(el);
        TimePicker.inactive(el);
    },
    'keypress': function(evt) {
        if(evt.key == 'enter') {
            el.blur();
        }
    }
}); 
```

我应该如何调整我的事件，这样只需使用下拉列表上的滚动条就不会模糊我的输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T18:58:06.683

在调查了那里的其他一些选择器之后，我意识到诀窍不是添加一个关闭模糊列表的事件，而是通过执行以下操作检查其他可能性来模拟模糊事件：

```
1\. upon the opening of the list, add a click event to the document that
   checks to see if the click is not on in the active input, and not on
   the active list. If this is true and the click is in fact on a non-listy
   part of the document, then close it.
2\. add an event to each list item in the suggest list (when the list is
   open only) that selects the value and closes the list.
3\. add an keydown event to the input itself so if the user hits enter,
   it changes the value and closes the list. 
```

可以在这里找到新版本的 javascript 代码：http: [//jsfiddle.net/SDBCe/1/](http://jsfiddle.net/SDBCe/1/)

# sed - 将每一行分成相等的部分

> ID：12625980
> 
> 赞同：1
> 
> 时间：2012-09-27T16:30:16.313
> 
> 标签：sed, awk

如果有人可以建议我使用命令（sed 或 AWK 单行命令）将文件的每一行分成相等的部分，我会很高兴。例如将每行分成 4 部分。

输入：

```
ATGCATHLMNPHLNTPLML 
```

输出：

```
ATGCA THLMN PHLNT PLML 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:42:39.110

我怀疑 awk 不是最好的工具，但是：

```
gawk --posix '{ l = sprintf( "%d", 1 + (length()-1)/4);
    gsub( ".{"l"}", "& " ) } 1' input-file 
```

如果你有一个 posix 兼容的 awk，你可以省略 --posix，但是 --posix 对于 gnu awk 是必需的，因为这似乎是最常用的实现，我已经给出了 gawk 方面的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:40:38.603

这应该使用 GNU sed 工作：

```
sed -r 's/(.{4})/\1 /g' 
```

*   `-r`需要使用扩展正则表达式
*   `.{4}`每四个字符捕获一次
*   `\1`指的是被括号包围的捕获组，`(` `)`并在该组后面添加一个空格
*   `g`确保在每一行上尽可能多地进行替换

一个测试; 这是我终端中的输入和输出：

```
$ echo "ATGCATHLMNPHLNTPLML" | sed -r 's/(.{4})/\1 /g'
ATGC ATHL MNPH LNTP LML 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T20:24:53.180

### perl

`perl`在这里可能是一个更好的选择：

```
export cols=4
perl -ne 'chomp; $fw = 1 + int length()/$ENV{cols}; while(/(.{1,$fw})/gm) { print $1 . " " } print "\n"' 
```

这会重新计算每一行的字段宽度。

### 核心工具

一个 GNU coreutils 替代方案，field-width 是根据第一行选择的`infile`：

```
cols=4
len=$(( $(head -n1 infile | wc -c) - 1 ))
fw=$(echo "scale=0; 1 + $len / 4" | bc)

cut_arg=$(paste -d- <(seq 1 $fw 19) <(seq $fw $fw $len) | head -c-1 | tr '\n' ',') 
```

的值`cut_arg`在上述情况下：

```
1-5,6-10,11-15,16- 
```

现在将线切割成适当的块：

```
cut --output-delimiter=' ' -c $cut_arg infile 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T20:35:35.367

这可能对您有用（GNU sed）：

```
sed 'h;s/./X/g;s/^\(.*\)\1\1\1/\1 \1 \1 \1/;G;s/\n/&&/;:a;/^\n/bb;/^ /s/ \(.*\n.*\)\n\(.\)/\1 \n\2/;ta;s/^.\(.*\n.*\)\n\(.\)/\1\2\n/;ta;:b;s/\n//g' file 
```

解释：

*   `h`将模式空间 (PS) 复制到保持空间 (HS)
*   `s/./X/g`用相同的非空格字符替换 HS 中的每个字符（在这种情况下`X`）
*   `s/^\(.*\)\1\1\1/\1 \1 \1 \1/`将行分成 4 部分（空格分隔）
*   `G`将换行符后跟 HS 的内容附加到 PS
*   `s/\n/&&/`将换行符加倍（稍后用作标记）
*   `:a`引入循环命名空间
*   `/^\n/bb`如果我们到达换行符，我们就完成并分支到`b`命名空间
*   `/^ /s/ \(.*\n.*\)\n\(.\)/\1 \n\2/;ta;`如果第一个字符是空格，则在此时向实行添加一个空格并重复
*   `s/^.\(.*\n.*\)\n\(.\)/\1\2\n/;ta`任何其他角色都会碰到并重复
*   `:b;s/\n//g`全部完成只需删除标记并打印出结果

这项工作适用于任何长度的线，但是该线不能完全被 4 整除，最后一部分也将包含余数。

# javascript - 从另一个 javascript 获取值

> ID：12625984
> 
> 赞同：0
> 
> 时间：2012-09-27T16:30:28.133
> 
> 标签：javascript, xul

我想在调用 scipt2 时传递值（用户名）。script1 独立，但在 script1 之后，所以到 script1 填充了值但需要它是持久的以供将来的脚本调用使用。

script1.js

```
 var user = "";
function method1(){

    var username = document.getElementById('username').value;
    var app = new UserText();
    app.setValue(username);
    // more logic
    }
function UserText(){

    this.getValue = function(){
        return this.user;
    };

    this.setValue = function(val){
        this.user = val;
    };
} 
```

Script2.js

```
alert(UserText.getValue()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:01:24.360

您将不得不向全局范围公开某些内容。现在，当您调用 时`method1()`，用户名被存储在`UserText`. 该特定实例由您的变量表示，`app`该变量当前仅适用于该`method1()`函数。

解决这个问题的一种方法是简单地将声明移动`app`到全局范围。换句话说，将脚本的第一部分更改为以下内容：

```
var user = "";
var app;
function method1() {
    var username = document.getElementById('username').value;
    app = new UserText();
    app.setValue(username);
    // more logic
} 
```

请注意，我已将`var app`声明移至全局范围。现在您可以通过以下方式使用您的用户值访问实例

```
alert(app.getValue()); 
```

在相关的说明中，您应该知道您的`var user = "";`行目前什么都不做，至少对于您提供给我们的代码。`this.user`当您在类内部读写时`UserText`，它使用该类的实例来存储信息，这就是为什么您会在`app.user`属性中找到您的值而不仅仅是`user`变量。

# java - 我不能在java中调用存储过程使用hibernate和sql-server 2008

> ID：12625985
> 
> 赞同：0
> 
> 时间：2012-09-27T16:30:28.253
> 
> 标签：java, sql-server, hibernate, stored-procedures

> **可能重复：**
> [在 Hibernate 中调用存储过程](https://stackoverflow.com/questions/3681045/calling-a-stored-procedure-in-hibernate)

我有以下问题：我无法在 java 中调用存储过程

我所做的是：

创建一个实现可序列化 semaforoBO 调用的类并添加以下内容

```
@Entity
@NamedNativeQuery(
name="CalculoSemaforo",
query = "exec CalculoSemaforo codigo,fecha",
callable=true,
resultClass=char.class
)
public class SemaforoBO implements Serializable{
//code
} 
```

存储过程的名称是 CalculoSemaforo，并且有两个输入变量返回一个字符。然后在 SemaforoBO 中有一个执行以下操作的函数：

```
public char semaforo(){
        DBTenant dbTenant = new DBTenant();
        Session sess;
        try {
            sess = dbTenant.getTenantSession();
            Query query =sess.getNamedQuery("CalculoSemaforo");
            query.setString("codigo", this.codigoarticulo);
            query.setLong("fecha",this.fecha);
            sem = (Character) query.uniqueResult();
        }
        catch(NullPointerException e)
        {
            sem = 'x';
        }
        return sem;
} 
```

但它给了我一个例外 org.hibernate.MappingException: Named query not known: CalculoSemaforo

知道这个解决方案如何谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:05:54.400

我找到了使用没有映射的休眠调用存储过程的替代方法，或者您必须依赖一个类来调用

```
DBTenant dbTenant = new DBTenant();
        Session sess;
        try {
            sess = dbTenant.getTenantSession();
            Query qry = sess.createSQLQuery("{ call Iturria.dbo.CalculoSemaforo2(?,?) }");
            qry.setString(0, this.codigoarticulo);
            qry.setLong(1, this.fecha);
            sem = (Character) qry.uniqueResult();
        }
        catch(NullPointerException e)
        {
            sem = 'y';
            return sem;
        } 
```

感谢您的回复

# ms-access - 为下一条记录生成时间戳，而不是当前记录

> ID：12625987
> 
> 赞同：0
> 
> 时间：2012-09-27T16:30:35.737
> 
> 标签：ms-access, timestamp

我对 MS-Access 有一个小问题，如下所示。

我有一个带有 Timestamp 列的表（该字段的格式为`Date/Time`，默认值为`Now()`）。问题是每当我创建一条新记录时，都会为我要创建的下一条记录设置时间戳，而不是我正在创建的记录。

这意味着我创建记录 50，并且时间戳设置为记录 51。如果我一周后返回并创建记录 51，则记录 51 的时间戳将是一周后，时间戳将设置为记录 52 ，我将在未来的某个时候创建​​它。

您可以通过启动 MS-Access 来重新创建问题，创建一个包含几个字段的新表，其中一个是日期/时间，并将该字段的默认值设置为`Now()`.

这是设计使然，还是我在做一些愚蠢的事情？如果是设计使然，我如何在 MS-Access 中实现我想要的时间戳类型（在创建记录时设置日期/时间的时间戳）？如果我在做一些愚蠢的事情，我到底在做什么？

编辑：下面是新创建的 Access 表的屏幕截图：

![最初的](../Images/f9b4f31d764ff9f7b5db3b9959e69870.png)

我添加了一些文本来记录一，时间戳设置为记录二：

![第二](../Images/793157b2cd6c21d823a9c1d672e42faa.png)

我允许一些时间过去，将一些数据放入记录二，并且时间戳没有改变，现在记录三有一个时间戳：

![第三](../Images/1833760d765ef7d7b82778c3b6e834cb.png)

如果我关闭并打开表，则（新）记录的时间戳会在我打开表时更新为：

![然后](../Images/a7bd1ecffabd8ecb78bc1c277fb85b14.png)

我允许一些时间过去，更新记录和时间戳停留在我打开表的时间：

![最后](../Images/1dd89db9d6193631af3f8f4c84ac1b21.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T03:53:05.973

正如评论中已经揭示的那样，这个问题来自于在表中进行编辑，将 Now() 设置为 TimeStamp 字段的默认值。

我建议您创建一个表格而不是在表格中进行编辑。如果您希望它看起来相似，只需使用数据表表单。然后在 Form 的 BeforeUpdate 事件中输入如下代码：

```
Me!TimeStamp = Now() 
```

作为旁注，我不会使用 TimeStamp 作为字段名称。某些 RDBMS（例如 SQL Server）具有称为 TimeStamp 的数据类型。最好避免使用属于数据类型或保留字的字段名称。将 Access 数据库迁移到 SQL Server 非常常见，当您尝试执行此操作时可能会遇到问题。

相反，我会创建两个字段。一个称为 DateTimeEntered，另一个称为 DateTimeModified。我认为这两个字段在我制作的几乎每张表中都是必需的。如果您想要对记录进行任何类型的同步，您会希望至少有一个 DateTimeModified 字段。

# c# - 断言.AreEqual （和相关的泛型函数）不要强制他们的参数类型

> ID：12625995
> 
> 赞同：3
> 
> 时间：2012-09-27T16:30:54.307
> 
> 标签：c#, unit-testing, generics, type-conversion

我正在编写一些单元测试，实际上我正在重构后修复单元测试，我注意到一些非常奇怪的行为。原始断言使用了 AreEqual 方法的非泛型风格。

```
Assert.AreEqual(Foo.Do(...), Bar.Do(...).Conversion(...)); 
```

经过一些重构， Foo.Do() 不再返回相同的类型，需要额外的转换来保持等价。但是，AreEquals 函数很乐意接受任何对象，因此测试在运行时失败，而不是像人们希望的那样在编译时失败。

因此，我决定将断言更改为它们的通用对应项，以强制将来此类更改会变成编译时错误。

```
Assert.AreEqual<X>(Foo.Do(...), Bar.Do(...).Conversion(...)); 
```

此时，我还没有更改 Foo.Do() 以返回正确的类型，所以我应该得到一个编译错误，即 Foo.Do() 的返回不是 X。令我惊讶的是，没有任何反应。编译成功就好了。我假设某处的类型之间必须存在隐式转换，但一些实验表明没有。我已经尝试了一些其他模拟示例，以查看具有非泛型和泛型风格的函数是否会以这种方式进行交互，但我无法重现此行为，除非使用此类。

为什么编译器不强制这两个值都是 X 类型，即使如果您将鼠标悬停在 Visual Studio 中的函数上，它似乎暗示了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T19:36:10.317

经过一番令人沮丧的搜索后，我最终在一组扩展方法中找到了一个隐式转换，这些方法被另一个测试中的另一行代码拉入，与手头的类型完全无关。从那以后，我与那个进行黑客攻击的人交谈过。另一个隐式转换失败。

# android - 将手势传递给 Android 中的不同处理程序

> ID：12625997
> 
> 赞同：1
> 
> 时间：2012-09-27T16:31:12.637
> 
> 标签：android, android-event

我的 Android 应用程序本质上是一个实现“SurfaceHolder.Callback”接口的 Surface View。我或多或少地实时显示二维数据图。此外，我添加了一个文本视图来显示叠加在表面视图上的一些附加数据。

我目前的问题是 Surface View 处理各种手势和触摸，但 Text View 似乎正在拦截触摸。

如何将事件从文本视图传递到底层（字面意思是在相对布局中）表面视图进行处理？

谢谢，
R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T12:59:02.437

我希望不必这样做（回答我自己的问题），但这是我认为我从一些关于 SO 的帖子中了解到的：

在 Android 相对布局中，“顶部”视图首先获取事件。就我而言，Surface View 顶部的 Text View 不应该对任何东西做任何事情，因此有必要将所有事件“向下”传递到堆栈中。我做到了这一点：

```
textView.setOnTouchListener (new View.OnTouchListener()
{
    @Override
    public boolean onTouch (View v, MotionEvent event)
    {
        return false;
    }
}); 
```

令人讨厌的部分（在我看来）是 Android 帮助文本的欺骗性质，它说：

“返回 - 如果侦听器已经消费了事件，则返回 true，否则返回 false。”

在我看来（再次，我的观点），这件事的基调是颠倒了因果关系。我想这是在吹毛求疵，但文本可能应该说“返回 TRUE 以指示事件应该被消耗（由操作系统，看起来），否则为假。”

# php - 动态 php 页面的 CSS 问题

> ID：12625998
> 
> 赞同：0
> 
> 时间：2012-09-27T16:31:14.230
> 
> 标签：php, css, dynamic, xhtml, css-tables

我不是 HTML 和 CSS 的初学者……但我使用的是 PHP。我有一个非常小的动态生成的 PHP 页面，它创建一个表格并用数字填充它。CSS 正在处理随机项目，非常奇怪，我不确定发生了什么。`<body>`标签 CSS 根本不起作用。没有一处房产受到它的影响。`table.temps`css 也不起作用，但如果我删除它，那么标签`<th>`就会失去它的样式。这是一个家庭作业，我知道这很容易解决，我最近在 CSS 和 PHP 方面遇到了最糟糕的时间。

都是一页，而且相对较小，所以这里是文档：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<title>Lab 1</title> 

<style type="text/css">
<!-- Declare document <body> styles -->
body{
    background-color: #9FDBFF;
    color: #333;
    font-family: Helvetica, sans-serif;
    font-size: .8em;
    height: 100%;
    width: 100%;
}

<!-- Declare document table styles -->
table.temps {
    width: 50%;
    height: auto;
    min-height: 400px;
    border: 2px solid black;
    color: #333;
}

th {
    background: blue;
    color: #FFF;
    height: 20px;
    width: 100px;
}

.colorIt {
    background-color: #CCC;
}
</style>

</head>
<body>
<?php

$intTableTotalWidth = 8;
$intTableTotalHeight = 8;
$intCount = 1;

print("<table class='temps'>");
print("<th>Farenheight</th>");
print("<th>Celcius</th>");

for ($intHeight = 0; $intHeight < $intTableTotalHeight; $intHeight++) {
print("<tr>");

for ($intWidth = 0; $intWidth < $intTableTotalWidth; $intWidth++) {

    if ($intCount % 2 == 0){
        print("<td class='colorIt'>" . $intCount ."</td>");
    }
    else {
        print ("<td>" . $intCount . "</td>");
    }

    $intCount++;
}

print("</tr>");
}

print("</table>");
?>
</body>
</html> 
```

**编辑：我的错人，我什至没有意识到我在 CSS 中使用 HTML 注释。它是内部 CSS，因此 CSS 注释不会改变 HTML 文档中的颜色，这让我很反感。我解决了这个问题。感谢您的意见！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:38:10.317

您正在样式标签中使用 html 注释。这是不允许的。你不应该**在**样式和脚本标签中使用 html 注释。这是不允许的。删除它们，一切都会奏效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T16:37:48.927

删除这些行

```
<!-- Declare document <body> styles -->
<!-- Declare document table styles --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:42:38.617

1.  您的`<th>`标签应嵌入`<tr>`标签中：`<tr><th>col1</th><th>col2</th></tr>`.

2.  您输出的单元格/行比使用定义的列多`<th>`。如果您希望 a`<th>`包含两列，则应使用`<th colspan="2">col1</th>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T18:23:51.407

更简单的解决方案：`session_start()`在 .php 文件的开头，将所有主题放在一个数组中，然后包含样式表

```
session_start()
$theme=array("links"=>"#ff0000", "bkg"=>"#00ff00");
$_SESSION["Theme"]=$theme;
...
<link rel="stylesheet" type="text/css" href="default.php"> 
```

你的样式表看起来像这样：default.php

```
<?php session_start();
if (isset($_SESSION["Theme"])) {
    extract($_SESSION["Theme"]);
    header("Content-type: text/css");
} else {
// this part is for proper coloring the file, editor will see <style> 
// but when loaded from main file <style> will be discarded     
?>
<style>
<?php } ?>
a {
   color:<?=$links?>;      
}

body {
    background-color: <?=$bkg?>;
} 
```