# StackOverflow 问答 14175000-14175999

# mysql - 如何优化这个 MySQL 代码？

> ID：14175001
> 
> 赞同：1
> 
> 时间：2013-01-05T18:36:44.867
> 
> 标签：mysql, optimization

表结构：

```
CREATE TABLE IF NOT EXISTS `categories` (
  `id` smallint(4) unsigned NOT NULL AUTO_INCREMENT,
  `parentid` smallint(4) unsigned DEFAULT NULL,
  `category` varchar(150) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `parentid` (`parentid`,`category`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=10 ;

INSERT INTO `categories` (`id`, `parentid`, `category`) VALUES
(1, NULL, 'A'),
(2, NULL, 'B'),
(3, 1, 'A.1'),
(4, 1, 'A.2'),
(5, 1, 'A.3'),
(6, 1, 'A.4'),
(7, 3, 'A.1.1'),
(8, 3, 'A.1.2'),
(9, 3, 'A.1.3'); 
```

代码“callcategorycount”函数是调用“categorycount”过程以便在select语句中使用：

```
DELIMITER $$

CREATE FUNCTION callcategorycount(id SMALLINT(4)) RETURNS SMALLINT(4) BEGIN
    CALL categorycount(id, @categorycount);
    RETURN @categorycount;
END$$

CREATE PROCEDURE categorycount(IN categoryid SMALLINT(4), OUT categorycount SMALLINT(4)) BEGIN
    DROP TEMPORARY TABLE IF EXISTS results;
    DROP TEMPORARY TABLE IF EXISTS temp1;
    DROP TEMPORARY TABLE IF EXISTS temp2;

    CREATE TEMPORARY TABLE temp1 AS
        SELECT DISTINCT id, parentid FROM categories WHERE parentid = categoryid;

    CREATE TEMPORARY TABLE results AS
        SELECT id, parentid FROM temp1;

    WHILE ( SELECT COUNT(*) FROM temp1 ) DO
        CREATE TEMPORARY TABLE temp2 AS
            SELECT DISTINCT id, parentid FROM categories WHERE parentid IN (SELECT id FROM temp1);

        INSERT INTO results SELECT id, parentid FROM temp2;
        DROP TEMPORARY TABLE IF EXISTS temp1;

        CREATE TEMPORARY TABLE temp1 AS
            SELECT id, parentid FROM temp2;

        DROP TEMPORARY TABLE IF EXISTS temp2;
    END WHILE;

    SELECT COUNT(*) INTO categorycount FROM results;

    DROP TEMPORARY TABLE IF EXISTS results;
    DROP TEMPORARY TABLE IF EXISTS temp1;
END$$

DELIMITER ; 
```

对于输出（执行时间：1.7886 秒）：

```
SELECT id, parentid, category, callcategorycount(id) AS subcategories FROM categories;

|id|parentid|category|subcategories
|1|NULL|A|7
|2|NULL|B|0
|3|1|A.1|3
|4|1|A.2|0
|5|1|A.3|0
|6|1|A.4|0
|7|3|A.1.1|0
|8|3|A.1.2|0
|9|3|A.1.3|0 
```

如何优化“categorycount”程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T19:38:24.703

您可以执行以下操作，尽管我建议您仔细检查我的逻辑，因为它完成得很快。

**将计数器字段添加到类别表**

```
-- TABLE

drop table if exists categories;
create table categories
(
cat_id smallint unsigned not null auto_increment,
name varchar(255) not null,
parent_cat_id smallint unsigned null,
child_counter smallint unsigned not null default 0,
primary key categories_pk (cat_id),
key categories_parent_idx (parent_cat_id)
)
engine = innodb; 
```

**创建用于插入类别的存储过程**

```
-- SPROCS

drop procedure if exists insert_category;
delimiter #

create procedure insert_category
(
in p_name varchar(255),
in p_parent_cat_id smallint unsigned
)
proc_main:begin

declare v_done tinyint unsigned default 0;
declare v_depth smallint unsigned default 0;

  insert into categories (name, parent_cat_id) values (p_name, p_parent_cat_id);

  if p_parent_cat_id is null then
    leave proc_main;
  end if;

  -- work out the parents

  create temporary table hier(
    parent_cat_id smallint unsigned, 
    cat_id smallint unsigned, 
    depth smallint unsigned default 0
  )engine = memory;

  insert into hier select parent_cat_id, cat_id, v_depth from categories where cat_id = p_parent_cat_id;

  /* http://dev.mysql.com/doc/refman/5.0/en/temporary-table-problems.html */

  create temporary table tmp engine=memory select * from hier;

  while not v_done do

    if exists( select 1 from categories c
        inner join tmp on c.cat_id = tmp.parent_cat_id and tmp.depth = v_depth) then

        insert into hier 
            select c.parent_cat_id, c.cat_id, v_depth + 1 from categories c
            inner join tmp on c.cat_id = tmp.parent_cat_id and tmp.depth = v_depth;

        set v_depth = v_depth + 1;          

        truncate table tmp;
        insert into tmp select * from hier where depth = v_depth;

    else
        set v_done = 1;
    end if;

  end while;

  -- update parent counts

  update categories c
  inner join hier h on c.cat_id = h.cat_id
  set
   c.child_counter = c.child_counter + 1;

  drop temporary table if exists hier;
  drop temporary table if exists tmp;

end proc_main #

delimiter ; 
```

**测试和结果**

```
truncate table categories;

call insert_category('A',null); -- 1
call insert_category('B',null);

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |             0 |
|      2 | B    |          NULL |             0 |
+--------+------+---------------+---------------+
2 rows in set (0.00 sec)

call insert_category('C',1); -- 3
call insert_category('D',1);
call insert_category('E',1); -- 5
call insert_category('F',1);

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |             4 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             0 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             0 |
|      6 | F    |             1 |             0 |
+--------+------+---------------+---------------+
6 rows in set (0.00 sec)

call insert_category('G',3); -- 7
call insert_category('H',3);
call insert_category('I',3); -- 9

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |             7 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             3 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             0 |
|      6 | F    |             1 |             0 |
|      7 | G    |             3 |             0 |
|      8 | H    |             3 |             0 |
|      9 | I    |             3 |             0 |
+--------+------+---------------+---------------+
9 rows in set (0.00 sec) 
```

**附加测试**

```
call insert_category('K',7); -- 10

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |             8 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             4 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             0 |
|      6 | F    |             1 |             0 |
|      7 | G    |             3 |             1 |
|      8 | H    |             3 |             0 |
|      9 | I    |             3 |             0 |
|     10 | K    |             7 |             0 |
+--------+------+---------------+---------------+
10 rows in set (0.00 sec)

call insert_category('L',9); 
call insert_category('M',10); 

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |            10 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             6 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             0 |
|      6 | F    |             1 |             0 |
|      7 | G    |             3 |             2 |
|      8 | H    |             3 |             0 |
|      9 | I    |             3 |             1 |
|     10 | K    |             7 |             1 |
|     11 | L    |             9 |             0 |
|     12 | M    |            10 |             0 |
+--------+------+---------------+---------------+
12 rows in set (0.00 sec)

call insert_category('N',7); 

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |            11 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             7 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             0 |
|      6 | F    |             1 |             0 |
|      7 | G    |             3 |             3 |
|      8 | H    |             3 |             0 |
|      9 | I    |             3 |             1 |
|     10 | K    |             7 |             1 |
|     11 | L    |             9 |             0 |
|     12 | M    |            10 |             0 |
|     13 | N    |             7 |             0 |
+--------+------+---------------+---------------+
13 rows in set (0.00 sec)

call insert_category('O',5); 

select * from categories;
+--------+------+---------------+---------------+
| cat_id | name | parent_cat_id | child_counter |
+--------+------+---------------+---------------+
|      1 | A    |          NULL |            12 |
|      2 | B    |          NULL |             0 |
|      3 | C    |             1 |             7 |
|      4 | D    |             1 |             0 |
|      5 | E    |             1 |             1 |
|      6 | F    |             1 |             0 |
|      7 | G    |             3 |             3 |
|      8 | H    |             3 |             0 |
|      9 | I    |             3 |             1 |
|     10 | K    |             7 |             1 |
|     11 | L    |             9 |             0 |
|     12 | M    |            10 |             0 |
|     13 | N    |             7 |             0 |
|     14 | O    |             5 |             0 |
+--------+------+---------------+---------------+
14 rows in set (0.00 sec) 
```

完整脚本在这里： http: [//pastie.org/5649953](http://pastie.org/5649953)

希望它对您有所帮助或指向最佳解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:38:15.157

试试这个查询

```
SELECT 
      T2.*,
      IFNULL(c.SubCount,0) as SUBCAOUNT
FROM (
    SELECT
        @r AS _id,
        (SELECT @r := parentid FROM categories WHERE id = _id) AS parentid,
        @l := @l + 1 AS lvl
    FROM
        (SELECT @r := 9, @l := 0) vars,
        categories m
    WHERE @r <> 0) T1
JOIN categories T2
ON T1._id = T2.id
LEFT JOIN (
            SELECT 
                COUNT(id) as SubCount, 
                parentid 
            FROM categories
            GROUP BY parentid) as c ON c.parentid = T1._id
ORDER BY T1.lvl DESC; 
```

在这个查询中，我使用 9 作为参数，因为它是 A 的最终深度。

输出

```
ID  PARENTID    CATEGORY    SUBCAOUNT
1   (null)      A           4
3   1           A.1         3
9   3           A.1.3       0 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/fb53a/18/0)

编辑：试试这个查询。

```
SELECT 
      T2.*,
      SUM(c.SubCount) as SUBCAOUNT
FROM (
    SELECT
        @r AS _id,
        (SELECT @r := parentid FROM categories WHERE id = _id) AS parentid,
        @l := @l + 1 AS lvl
    FROM
        (SELECT @r := 9, @l := 0) vars,
        categories m
    WHERE @r <> 0) T1
JOIN categories T2
ON T1._id = T2.id
LEFT JOIN (
            SELECT 
                IFNULL(COUNT(id),0) as SubCount, 
                parentid 
            FROM categories
            GROUP BY parentid) as c ON c.parentid = T1._id

ORDER BY T1.lvl DESC; 
```

输出

```
ID  PARENTID    CATEGORY    SUBCAOUNT
9   3           A.1.3       7 
```

## [演示](http://sqlfiddle.com/#!2/fb53a/25)

**更多编辑**

这是你如何做到的

```
SELECT
      c.id,
      c.category,
      IFNULL(Total,0) as No_Of_Children
FROM categories as c
LEFT JOIN (
            SELECT
                 id,
                 COUNT(parentid) as Total,
                 parentid
            FROM categories
            GROUP BY parentid
) as lc ON lc.parentid = c.id; 
```

**输出**

```
ID  CATEGORY    NO_OF_CHILDREN
1   A           4
2   B           0
3   A.1         3
4   A.2         0
5   A.3         0
6   A.4         0
7   A.1.1       0
8   A.1.2       0
9   A.1.3       0 
```

这是

## [演示](http://sqlfiddle.com/#!2/fb53a/34)

# iphone - 从子视图中使用 segue

> ID：14175005
> 
> 赞同：0
> 
> 时间：2013-01-05T18:37:31.857
> 
> 标签：iphone, ios6, segue, uicollectionview, uistoryboardsegue

我有一个包含集合视图的视图。我以编程方式（在 viewDidLoad 中）添加了这个集合视图——所以它不在情节提要上。此集合视图包含多个单元格。当用户单击集合视图中的一个单元格时，我想切换到另一个视图控制器（我计划在情节提要上添加）。我的问题是 - 由于集合视图不在情节提要上，我该如何摆脱它？或者有没有其他方法可以做到这一点。

对上述原始问题的一些更新：

在父视图控制器中，我执行以下操作：

```
//Layout for the collection view
CDLayout *cdLayout = [[CDLayout alloc] initWithItemSize:CGSizeMake(cardWidth, cardHeight) withItemInsets:UIEdgeInsetsMake(topInset, leftInset, bottomInset, rightInset) withInterItemSpacingX:8.0f withTopMargin:margin withLeftMargin:margin withBottomMargin:margin withRightMargin:margin shouldRotate:NO];

//This is the collection view controller
CDLineLayoutViewController *cdLineVC = [[CDLineLayoutViewController alloc] initWithCollectionViewLayout:cdLayout withItemCount:12 ];

// add the collection view controller to self - the parent    
[self addChildViewController:cdLineVC];

[cdLineVC didMoveToParentViewController:self];

// add collectionView as a subview
[self.view addSubview:cdLineVC.collectionView]; 
```

collectionView 有 12 张卡片。当用户单击其中一张卡片时，我想移动到另一个视图控制器。

如您所见，集合视图不在情节提要上。那么，有没有办法创建一个segue？

顺便说一句，一种选择是 Taseen 在下面建议的。我试过了，它正在工作。但据我了解，这实际上并不是“转场”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T00:37:20.403

你能告诉我们你写的任何代码吗

我从您的问题中了解到，您在**viewDidLoad 中添加了集合视图。**而且我相信您已将集合视图的委托设置为 self，因此在 **didSelectItemAtIndexPath**方法中您可以编写此代码

```
 -(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath
{
    //From indexpath.item, you know which cell was clicked

    //using switch method

    switch (indexPath.item) {
        case 0:
            //You Can push the view controller from here
            //You need to import the header file of that View controller
           DestinationViewController *destinationView;

            //if the self controller in which the collection view is shown is embedded in Navigation controller,
            //you can push using
            [self.navigationController pushViewController:destinationView animated:YES];

            //if it is not embedded, use modal segue
            [self.modalViewController presentModalViewController:destinationView animated:YES];

            break;

        default:
            break;
    }
} 
```

**编辑：**您将在情节提要上从**ParentViewController**到**DestinationController**创建的 segue将具有 segueIdentifier 属性。如下所示， ![在此处输入图像描述](../Images/62a17f672cc1c22b8d311ee47f4c9621.png) 然后在**didSelectItemAtIndexPath**中而不是推送控制器，您可以使用此代码

```
[self performSegueWithIdentifier:@"collectionViewSegue" sender:self]; 
```

您还可以使用 prepareForSegue 方法配置目标视图控制器。

```
 -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    DestinationViewController *targetVC = (DestinationViewCOntroller *)segue.destinationViewController;
    //if you pass anything you can do it here
    //if to set any public variable for example image for the imageview
    targetVC.cardImageView.image = [UIImage imageNamed:@"queen.png"];
} 
```

此方法将在您的父控制器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:04:38.560

通过 ctrl-click 初始 viewController 创建一个新的 segue 并拖动到目标 viewController。不要忘记设置 segue 标识符。而不是覆盖 -(void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender 方法。

# php - 唯一页面查看次数（cookie vs. ip 地址 vs. 其他）

> ID：14175006
> 
> 赞同：2
> 
> 时间：2013-01-05T18:37:33.373
> 
> 标签：php

我将向我的网站添加页面查看次数，其中视图将在数据库中更新。以前，我也做过类似的思考，我使用用户的 ip 地址来确定唯一视图。

现在，我只是想知道我是否应该改用 cookie。我无法理解哪个更好。或者我应该同时使用两者来更严格？

对此问题有信心的人，请回复，我会接受您的观点。我只需要多一点信心来选择一个或第二个。

PS如果您认为这两个有更好的选择，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T18:41:56.163

1.  使用谷歌分析
2.  使用某种 http 日志阅读器/解析器。

看看[http://www.phpmyvisites.us/](http://www.phpmyvisites.us/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T18:43:54.370

当 5 台 PC 从同一个 IP 连接到您的站点时会发生什么，假设它们位于无线路由器后面，这是一个很好的计数吗？如果查看该页面的同一个人拥有像今天大多数宽带互联网连接一样具有动态 IP 的互联网连接会怎样

cookie 可以完成这项工作，但我不确定如何解决这个问题以及为什么在他导航的客户端级别进行跟踪，cookie 也可以被删除或阻止......

一个简单的方法是使用谷歌分析或谷歌网站管理员工具

# javascript - 浏览器窗口之间的 PubSub javascript 库

> ID：14175007
> 
> 赞同：0
> 
> 时间：2013-01-05T18:37:33.730
> 
> 标签：javascript, dom-events, publish-subscribe, observer-pattern

您是否知道任何现有的**PubSub**库是否提供了在窗口之间进行通信的可能性？作为可以使用的示例：

*   弹出窗口（使用 window.open 打开）和开启器之间的通信
*   iframe 和容器页面之间的通信
*   谷歌浏览器扩展的扩展页面之间的通信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T07:42:02.977

有几个用于发布/订阅类型交互的库。

以下是我最近研究的一些候选人：

*   Jim Cowart 的[postal.js](http://github.com/postaljs/postal.js)和 postal.xframe 插件。
*   Ben Alman 的[帖子留言](http://benalman.com/projects/jquery-postmessage-plugin/)
*   easyXDM.net

我不确定它们如何匹配您的示例，但它们都处理 iFrame 问题。easyXDM 主要对跨域调用感兴趣，所以可能适用于所有场景。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-01T18:45:13.850

对于 Chrome 扩展中的 pubsub 功能，我编写了 chromeps 库： [https ://github.com/anderspitman/chromeps](https://github.com/anderspitman/chromeps)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:40:52.667

我不熟悉在浏览器窗口之间进行通信的方式，但是如果涉及到服务器，则可以在每个页面和服务器之间创建一个 Web 套接字，并且服务器可以在它们之间代理方法。socket.io (node) 或 SignalR (asp.net) 等库可以抽象出大部分管道。

# zend-framework2 - ZF2 服务定位器

> ID：14175009
> 
> 赞同：3
> 
> 时间：2013-01-05T18:37:39.750
> 
> 标签：zend-framework2

我对 zf2 很陌生，我正在尝试它。我有一个视图助手，我需要它来访问一个表对象。在我的控制器中，我可以运行：

```
$this->getServiceLocator(); 
```

但理想情况下，我会在我的视图助手中运行它。不幸的是，我似乎无法从我的视图助手中访问它。我尝试通过构造函数传递它，在 module.config.php 中配置一个工厂方法，但是当我尝试这样做时，Zend 将不再将 tablegateway 对象传递给我从模块模块中的服务工厂方法创建的模型对象之一。 .php 文件。这似乎是因为它不再调用工厂方法，而是选择在没有任何参数的情况下运行实例化。

我不确定我是否理解为什么视图工厂方法会影响一组具有不同名称的不同工厂方法。

谁能告诉我我在做什么有什么问题？我可以提供更多细节，但在不提供整个代码库的情况下，我不清楚哪些细节实际上很重要。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T07:48:05.890

Crisp 确实为您的问题提供了一个有效的答案，但我建议更进一步。服务定位器的注入使您的视图助手与框架和服务定位器模式紧密耦合并且容易受到攻击，因为应用程序中的每段代码都可以修改服务定位器中的每个服务。

有理由[直接注入您的依赖](http://blog.ircmaxell.com/2012/08/object-scoping-triste-against-service.html)项，因此您只依赖于您的依赖项并且您不再实现此反模式。假设您的视图助手依赖于`MyModule\Model\MyTable`，那么您的视图助手的构造函数将如下所示：

```
namespace MyModule;

use MyModule\Model\MyTable;
use Zend\View\Helper\AbstractHelper;

class MyViewHelper extends AbstractHelper
{
  protected $table;

  public function __construct(MyTable $table)
  {
    $this->table = $table;
  }
} 
```

正如您所指出的，您`MyTable`现在只需注入：

```
namespace MyModule;

class Module
{
  public function getViewHelperConfig()
  {
    return array(
      'factories' => array(
        'MyViewHelper' => function($sm) {
          $sm = $sm->getServiceLocator(); // $sm was the view helper's locator
          $table = $sm->get('MyModule_MyTable');

          $helper = new MyModule\View\Helper\MyHelper($table);
          return $helper;
        }
      )
    );
  }
} 
```

请注意，在视图助手工厂中，您的服务管理器是*视图助手的*服务管理器，而不是注册表的“主要”服务管理器（另请参阅[我之前写的博客文章](http://juriansluiman.nl/en/article/120/using-zend-framework-service-managers-in-your-application)）。`$sm->getServiceLocator()`为你解决这个问题。

> 我不确定我是否理解为什么视图工厂方法会影响一组具有不同名称的不同工厂方法。

不是，因此您的代码中可能存在错误。如果上述方法不起作用，请提供有关您的服务管理器配置的更多详细信息，以便我更新我的答案。

上述方法的一大优点是您可以使视图助手的单元测试变得非常容易。您可以模拟表网关并专注于视图助手的完整行为。

```
use MyModule\View\Helper\MyHelper;

public function testHelperusesTable
{
  $mock   = $this->getMock('MyModule\Model\MyTable');
  $helper = new MyHelper($mock);

  // Test your $helper now
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T20:22:09.600

您可以从 Module.php 中的视图助手配置中将服务定位器注入到您的视图助手中

```
// Application/Module.php

public function getViewHelperConfig()
{
    return array(
        'factories' => array(
            'myViewHelper' => function ($serviceManager) {
                // Get the service locator 
                $serviceLocator = $serviceManager->getServiceLocator();
                // pass it to your helper 
                return new \Application\View\Helper\MyViewHelper($serviceLocator);
            }
        )
    );
} 
```

在你看来助手

```
<?php
namespace Application\View\Helper;

use Zend\View\Helper\AbstractHelper,
    Zend\ServiceManager\ServiceLocatorInterface as ServiceLocator;

class MyViewHelper extends AbstractHelper
{
    protected $serviceLocator;

    public function __construct(ServiceLocator $serviceLocator)
    {
        $this->serviceLocator = $serviceLocator;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:16:37.043

在 Zend Framework 中工作时，我们经常需要自定义帮助程序，这使我们的工作变得容易，在 zf1 中从帮助程序访问数据库模型很容易，但我被困在如何访问自定义视图帮助程序中任何表的数据库模型，但就像我一样需要它我通过在视图中创建新的数据库适配器对象以非专业的方式解决问题，这从来都不是好方法，但最近我通过非常有趣的方式了解了在视图助手中访问数据库适配器并且我有对任何表执行任何查询，它可能不是 Zend F2 的方式，而是解决问题的非常简单和简短的方法。

这是我的模型示例...

```
<?php

namespace Application\Model;

use Zend\Db\TableGateway\TableGateway;

class SlideImageSubTable {

    protected $tableGateway;
    public $adapter;

    public function __construct(TableGateway $tableGateway) {
        $this->tableGateway = $tableGateway;
        $this->adapter = $this->tableGateway->getAdapter();
    }

    public function fetchAll() {
        $resultSet = $this->tableGateway->select();
        return $resultSet;
    }

    public function getSlideImageSub($id) {
        $id = (int) $id;
        $rowset = $this->tableGateway->select(array('id' => $id));
        $row = $rowset->current();
        if (!$row) {
            throw new \Exception("Could not find row $id");
        }
        return $row;
    }

    public function getImageMenu($id) {
        $id = (int) $id;
        $rowset = $this->tableGateway->select(array('slide_image_id' => $id));
        $rows = array_values(iterator_to_array($rowset));
        if (!$rows) {
            throw new \Exception("Could not find row $id");
        }
        return $rows;
    }

    public function saveSlideImageSub(SlideImageSub $slideImageSub) {
        $data = array(
            'slide_image_id' => $slideImageSub->slide_image_id,
            'title' => $slideImageSub->title,
            'description' => $slideImageSub->description
        );

        $id = (int) $slideImageSub->id;
        if ($id == 0) {
            $this->tableGateway->insert($data);
        } else {
            if ($this->getSlideImageSub($id)) {
                $this->tableGateway->update($data, array('id' => $id));
            } else {
                throw new \Exception('Form id does not exist');
            }
        }
    }

    public function deleteSlideImageSub($id) {
        $this->tableGateway->delete(array('id' => $id));
    }

} 
```

只需查看“public $adapter”公共变量即可。在构造函数中，我将通过调用 $this->tableGateway->getAdapter(); 来初始化它。方法，getAdapter() 通过网关对象可用。

然后在我的控制器操作视图中，我必须将它分配给任何变量并将该变量传递给查看页面。像这样..

```
public function equitiesAction() {
        $image_id = $this->params('id');
        $result = $this->getTable('SlideImageSub')->getImageMenu($image_id);
        $adapter = $this->table->adapter;
        $view = new ViewModel(array(
                    'result' => $result,
                    'adapter' => $adapter,
                ));
        return $view;
    } 
```

在视图中，我将“适配器”对象传递给这样的自定义视图..

```
<?php echo $this->GetMenuProducts( $this->adapter); ?> 
```

现在在自定义视图中，我可以使用这个数据库适配器对象并在任何表上创建选择查询。

希望这会对某人有所帮助，我四处寻找在自定义视图助手中使用数据库访问，但提供的配置方法对我不起作用。

谢谢

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-05-02T19:27:50.930

```
$this->getView()->getHelperPluginManager()->getServiceLocator(); 
```

# html - 如何将谷歌地图集中在航路点而不是“地址”消息上？

> ID：14175014
> 
> 赞同：0
> 
> 时间：2013-01-05T18:38:11.280
> 
> 标签：html, iframe, maps

```
<iframe width="280" height="230" frameborder="0" scrolling="no" marginheight="0"
marginwidth="0" src="https://maps.google.com/maps?
f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=Milwaukee,+wi&amp;aq=&amp;
sll=42.970,-87.870&amp;sspn=0.004379,0.010568&amp;ie=UTF8&amp;hq=&amp;
hnear=Milwaukee,+Milwaukee,+Wisconsin&amp;t=m&amp;z=12&amp;iwloc=A&amp;
output=embed"></iframe> 
```

以上是我用于威斯康星州密尔沃基的谷歌地图的代码。然而，在页面上，它是一个相对较小的地图，它以“地址”消息而不是航点标记为中心。我该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:02:47.383

这很简单，信息窗口气泡取决于`iwloc`参数。从中删除 Marker 项目，默认情况下它不会打开它。

```
<iframe width="280" height="230" frameborder="0" scrolling="no" marginheight="0"
marginwidth="0" src="https://maps.google.com/maps?
f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=Milwaukee,+wi&amp;aq=&amp;
sll=42.970,-87.870&amp;sspn=0.004379,0.010568&amp;ie=UTF8&amp;hq=&amp;
hnear=Milwaukee,+Milwaukee,+Wisconsin&amp;t=m&amp;z=12&amp;iwloc=&amp;
output=embed"></iframe> 
```

注意`iwloc=&amp;`而不是`iwloc=A&amp;`.

[**这是一个演示**](http://jsbin.com/asoqog/3/)

# html - 低于全高 div 的 div

> ID：14175015
> 
> 赞同：1
> 
> 时间：2013-01-05T18:38:11.663
> 
> 标签：html, css

我正在制作一个单页网站，所以它是一个长页面。但我想制作第一个 div，它是页面的全高和全宽，并且有一个 logo 居中。然后我想在它下面放置固定高度的div。

所以当页面打开时，logo总是居中的，下面的div还不可见（因为第一个占满高度）。当他们开始滚动时，下一个 div 就在它的正下方并显示出来。

这甚至可能吗？我试图寻找这个，但什么也没找到。

谢谢马克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T18:49:25.407

给你：http: [//jsfiddle.net/BramVanroy/NMeAQ/](http://jsfiddle.net/BramVanroy/NMeAQ/)

```
html, body {
  width: 100%;
  height: 100%;
}

#logo {
  width: 100%;
  height: 100%;
  background: #ccc;
}

#logo > img {
  border: 10px white solid;
  left: 50%;
  margin-left: -130px; /* the width of your image divided by 2 */
  top: 50%;
  margin-top: -130px; /* the height of your image divided by 2 */
  position: absolute;
} 
```

# python - Python pthread_detach 模拟

> ID：14175016
> 
> 赞同：4
> 
> 时间：2013-01-05T18:38:12.573
> 
> 标签：python, pthreads, detach

各位晚上好。我正在使用 Python 2.7 和*线程*模块编写多线程程序。这是一个代码示例：

```
# Importing myFunc function which will be run in the new thread
from src.functions import myFunc
# Importing a threading module
import threading
# Creating and running new thread initiated by our function
# and some parameters.
t = threading.Thread(target=myFunc, args=(1, 2, 3))
t.start() 
```

我知道在 C++（POSIX 线程库）中有一个[pthread_detach()](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_detach.3.html)函数，它将正在运行的线程置于分离状态。它保证该线程在函数结束后将资源释放回系统。那么，在 Python 中有没有类似这样的函数？或者，也许，在Python中根本不需要分离线程，线程占用的资源会在线程函数结束后自动释放？

[我试图在docs.python.org](http://docs.python.org/2/library/threading.html)和 Google上搜索信息，但没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:56:55.763

大家早上好。实际上答案是*'根本没有必要在 Python 中分离线程'*。*这个答案是GaiveR*同志从[那里](http://python.su/forum/topic/20403/)给我的。您只需要查看 Python 的源代码（thread_pthread.h）：

```
long
PyThread_start_new_thread(void (*func)(void *), void *arg)
{
...
    status = pthread_create(&th,
#if defined(THREAD_STACK_SIZE) || defined(PTHREAD_SYSTEM_SCHED_SUPPORTED)
                         &attrs,
#else
                         (pthread_attr_t*)NULL,
#endif
                         (void* (*)(void *))func,
                         (void *)arg
                         );

#if defined(THREAD_STACK_SIZE) || defined(PTHREAD_SYSTEM_SCHED_SUPPORTED)
    pthread_attr_destroy(&attrs);
#endif
    if (status != 0)
    return -1;

    pthread_detach(th);
...
} 
```

# ruby-on-rails - Rails、Devise、OmniAuth：请求附加字段并将它们存储在数据库中

> ID：14175017
> 
> 赞同：2
> 
> 时间：2013-01-05T18:38:39.210
> 
> 标签：ruby-on-rails, facebook, ruby-on-rails-3, devise, omniauth

我是Rails的新手。

所以...在我的 Rails 应用程序中，我有 OmniAuth Facebook 集成，我想在我的数据库中添加一些字段，例如名字、姓氏和位置。

我关注了这个[wiki](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)，我有一个简单的登录，但没有额外的字段（名字、姓氏、位置）。

所以，我在我的**config/initializers/devise.rb 中添加了这个：**

```
require 'omniauth-facebook'
config.omniauth :facebook, '123456...', '123456...',
    scope: 'first_name, last_name, location',
    stategy_class: OmniAuth::Strategies::Facebook 
```

所以，如果我是正确的，上面会要求这些额外的字段。

现在，在我的模型 user.rb 中，我想添加 3 行，它将请求的值传递给数据库。

```
def self.find_for_facebook_omniauth(omniauth, signed_in_resource=nil)
  basic = {
      provider:  omniauth.provider,
      uid:       omniauth.uid,
      }
  User.where(basic).first || User.create(basic.merge(
      firstname: omniauth.info.firstname,  # these are the
      lastname:  omniauth.info.lastname,   # lines I'm not
      location:  omniauth.info.location,   # sure of
      email:     omniauth.info.email,
      password:  Devise.friendly_token[0,20],
      ))
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-22T22:36:48.433

假设您`omniauth`是，那么您可能会发现哈希`request.env["omniauth.auth"]`中不包含其他字段。`.info`

在这种情况下，使用 更安全`.extra.raw_info`，它将包含其他范围的字段。

* * *

在这里我请求了额外的范围`user_hometown`，我们可以看到它在`info`散列中丢失了：

```
>> auth.info
=> #<OmniAuth::AuthHash::InfoHash email="dukedave@gmail.com" first_name="Dave" image="http://graph.facebook.com/508528599/picture?type=square" last_name="Tapley" name="Dave Tapley" nickname="dave.tapley" urls=#<OmniAuth::AuthHash Facebook="https://www.facebook.com/dave.tapley"> verified=true> 
```

但出现在`extra.raw_info`（之后`gender`）：

```
>> auth.extra.raw_info
=> #<OmniAuth::AuthHash email="dukedave@gmail.com" first_name="Dave" gender="male" hometown=#<OmniAuth::AuthHash id="105540216147364" name="Phoenix, Arizona"> id="508528599" last_name="Tapley" link="https://www.facebook.com/dave.tapley" locale="en_US" name="Dave Tapley" timezone=-7 updated_time="2013-11-22T22:10:26+0000" username="dave.tapley" verified=true> 
```

# c# - 从 AppConfig 文件中获取连接字符串后，如何在整个应用程序中重用连接字符串？

> ID：14175018
> 
> 赞同：1
> 
> 时间：2013-01-05T18:38:41.910
> 
> 标签：c#, connection-string

我在几个存储库类中有这段代码，我一直在回忆这个方法`GetConnectionString()`。基本上，我想调用`GetConnectionString()`一次并让`ConnectionString`我的所有存储库类都可以使用该变量，并在获取该变量后重用该变量。我该怎么做呢？

```
public class OrganizationRepository
{
    string ConnectionString;
    public static string GetConnectionString()
    {
        string strReturn = string.Empty;
        strReturn = ConfigurationManager.ConnectionStrings["MyTeamScoresDB"].ConnectionString;
        return strReturn;
    }
  ....
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T18:40:36.433

您将连接字符串传递给任何需要它的类。

不过，唯一需要的类是存储库类。

在这里实现重用的唯一方法是有一个`RepositoryBase`获取连接字符串的位置，所有存储库都继承自它，因此可以访问它。

```
public class RepositoryBase
{
    private string connectionString;
    public static string RepositoryBase()
    {
        connectionString= ConfigurationManager.ConnectionStrings["MyTeamScoresDB"].ConnectionString;
    }

    protected string ConnectionString
    {
       get { return connectionString;}
    }
  ....
}

public class OrganizationRepository : RepositoryBase
{
    // Can use the ConnectionString property of the base class
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:11:41.837

配置管理器类已经提供了缓存，因此多次调用 ConnectionStrings 属性不会导致任何开销。此外，我建议您创建一个抽象基础存储库类，在其中管理连接字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:08:45.503

那这个呢：

```
public class MyConfiguration{

     private static string myConnString;

     public static string MyConnectionString
     {
         get{
               if(myConnString == null){
                    myConnString = ConfigurationManager.ConnectionStrings["MyTeamScoresDB"].ConnectionString;
               }
               return myConnString;
         }
     } 
} 
```

它将在请求时第一次初始化连接字符串，然后重用该值。

# wcf - 具有双工连接的 wsDualHttpBinding 和 clientBaseAddress

> ID：14175022
> 
> 赞同：1
> 
> 时间：2013-01-05T18:39:33.197
> 
> 标签：wcf

我见过人们在 wsDualHttpBinding 绑定时使用 clientBaseAddress。什么是clientBaseAddress。它有什么特殊含义。

1) clientBaseAddress 的意义是什么？2）如果我不提供clientBaseAddress，那么可能会出现什么问题？

寻找讨论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:03:44.473

双 HTTP 绑定使用两个连接 - 一个从客户端到服务器用于常规请求，第二个从服务器到客户端用于回调。`clientBaseAddress`用于解决回调端点正在侦听的位置。该地址被发送到服务器，以便它可以打开连接并回调客户端。如果您不指定地址，则使用默认地址，因为双 HTTP 绑定必须工作。

# java - 滚动 JScrollPane 时的特殊效果

> ID：14175024
> 
> 赞同：1
> 
> 时间：2013-01-05T18:39:48.407
> 
> 标签：java, swing, jscrollpane, paintcomponent, jviewport

使用 JScrollArea 滚动时如何处理这种奇怪的效果：

![滚动时的奇怪效果](../Images/2feb4460a52fb3d2ccae1fa9e71ac224.png)

编码：

```
import java.util.*;
import java.util.prefs.BackingStoreException;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.AdjustmentEvent;
import java.awt.event.AdjustmentListener;
import java.awt.image.BufferedImage;
import java.io.*;
import javax.swing.*;

import javax.imageio.*;

public class Main extends JFrame implements ActionListener, AdjustmentListener{
    CustomComponent cc;
    JScrollPane jsp;

    public static void main(String[] args) {
        Main m = new Main();
    }

    public Main(){
        setTitle( "Diverse Testari 7");
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setSize(600, 400);

        cc = new CustomComponent();
        cc.setImage("rgbcmy.jpg");

        jsp = new JScrollPane( cc,
                JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,
                JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED );
        jsp.setPreferredSize( new Dimension( getWidth(), getHeight() ) );
        jsp.setOpaque( true );
        jsp.setBackground( Color.DARK_GRAY );
        jsp.getVerticalScrollBar().addAdjustmentListener(this);
        jsp.getHorizontalScrollBar().addAdjustmentListener(this);
        setBackground( Color.red );

        add( jsp );
        setVisible( true );
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        System.out.println("EVENT: " + e.toString() );

    }

    @Override
    public void adjustmentValueChanged(AdjustmentEvent arg0) {
        // TODO Auto-generated method stub

    }

}

class CustomComponent extends JPanel{
    BufferedImage img = null;
    public void setImage( String str ){
        try {
            img = ImageIO.read( new File( str ) );
            System.out.println(img.getColorModel().toString());
            System.out.println("SUCCESS!");

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public Dimension getPreferredSize() {
        // TODO Auto-generated method stub
        return new Dimension(img.getWidth(), img.getHeight() );
    }

    @Override
    protected void paintComponent(Graphics g) {
        Graphics2D g2d = (Graphics2D) g;
        g2d.setClip(100, 100, 100, 100);
        System.out.println("paintComponent");

        if( img != null )
        {
            System.out.println("Obs: Imagine existenta!");
            g2d.drawImage(img, null, 0,0);
        }
        else
        {
            System.out.println("Eroare: nu este imaginea!");
        }
    }//*/
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:03:09.533

尝试在 paintComponent 重写方法的开头调用 super.paintComponent(g)。像这样：

```
@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    // rest of the method's code 
```

希望这可以帮助！祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:02:37.307

这是一个常见问题`paint code isn't optimized`，部分副作用可以通过禁用闪烁来消除，必须为`JViewports ScrollMode`

```
JViewport viewPort = jsp.getViewport();
viewPort.setScrollMode(JViewport.BLIT_SCROLL_MODE);
viewPort.setScrollMode(JViewport.BACKINGSTORE_SCROLL_MODE);
viewPort.setScrollMode(JViewport.SIMPLE_SCROLL_MODE); 
```

并通过`super.paintComponent(g);`太通知`+1 for Óscar Gómez Alcañiz`

# oracle - Oracle Apex 如何从当前 id 生成值

> ID：14175025
> 
> 赞同：0
> 
> 时间：2013-01-05T18:40:16.597
> 
> 标签：oracle, oracle-apex

我是 Apex 的新手。但我已经阅读了文档。但不能完全在我想看的页面中。

那么，如何从 Apex 表单中的 id 生成值？

我有一个名为 customers 的表，其中包含 cust_id 和 member_id。现在我想在用户填写注册时根据 cust_id 生成 member_id。cust_id 已排序。

例如： - 用户将是第三个，所以 cust_id 是 3。（我猜这个值将无法访问，因为 cust_id 将在保存后生成）。- 现在我希望我的 member_id 具有这种类似的值：20130003（2013 是根据日期，0003 是 cust_id。

谁能告诉我怎么做。

注意： - 我想要 cust_id 和 member_id 因为客户有两种类型，即成员或非成员。所以对于非成员，member_id 将为空

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T10:02:30.813

您可以使用触发器

```
create or replace trigger bi_customers 
before insert into customers 
for each row
begin
select to_number(to_char(sysdate,'YYYY'))*10000+:new.cust_id into :new.member_id from dual;
end; 
```

# java - java中的随机唯一数

> ID：14175029
> 
> 赞同：2
> 
> 时间：2013-01-05T18:40:51.743
> 
> 标签：java, random, queue

我正在尝试获取随机数列表并将其放入队列中，而不会重复随机数。

```
 int number = 40;

        for (int j = 0; j<number; j++)
        {
            int pick = random.nextInt(number);
            myQueue.add(Integer.toString(pick));
        }
        System.out.println("the queue size: "+myQueue.size());
        Iterator it = myQueue.iterator();
        while(it.hasNext()){
                String iteratorValue = (String)it.next();
                System.out.println("queue next value: "+iteratorValue);
        } 
```

使用上面的代码，我得到了一些随机数的重复

有谁知道怎么做？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T18:44:10.657

这个怎么样：

```
List<String> list = new ArrayList<String>(number);

for (int i = 0; i < number; i++)
    list.add(Integer.toString(i));

Collections.shuffle(list);

myQueue.addAll(list); 
```

在某个范围内“添加唯一随机数”相当于将该范围内的所有数字相加，然后对结果进行洗牌。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T18:43:45.040

创建一个集合并在生成它们时将它们添加到其中。每次生成新数字时，请检查 Set 是否已包含该值。继续生成新数字并检查集合，直到找到不存在的数字。

沿着这些思路......（请注意，`Set.add(...)`如果值已经在 Set 中，则返回 false，因此 do-while 循环将继续，直到生成唯一的数字。）

```
 int number = 40;
   Set mySet = new HashSet();
   for (int j = 0; j<number; j++)
   {
       Integer pick;

       do{
           pick = random.nextInt(number);
       } while(!mySet.add(pick));
       myQueue.add(Integer.toString(pick));
   }
   System.out.println("the queue size: "+myQueue.size());
   Iterator it = myQueue.iterator();
   while(it.hasNext()){
           String iteratorValue = (String)it.next();
           System.out.println("queue next value: "+iteratorValue);
   } 
```

尽管如 ARS 所述，您似乎不是在寻找一个随机的唯一数字，而是在 0 到 40 之间的所有数字的随机打乱列表。如果是这种情况，请使用他/她的解决方案，因为它是更好的方式来实现这一目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:45:34.543

如果随机数的范围很小，那么您可以简单地生成具有可用值的列表并`Collections.shuffle`在列表上使用。

# sql - 当数据库表已经被记录填充时，更改数据库表中的属性数据类型

> ID：14175036
> 
> 赞同：1
> 
> 时间：2013-01-05T18:41:44.357
> 
> 标签：sql, sql-server-2008

当数据库表在 SQL 中有记录时，我们可以更改属性的数据类型吗？

我正在使用 Microsoft Management Studio 2008。我得到的错误是：** 将数据类型 nvarchar 转换为浮点数时出错。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T18:45:52.467

**简而言之：****仅当更改的数据类型**与新修改的数据类型兼容时，才可以使用`alter column`命令。另外，建议用事务来完成。

 **例如：您可以使用下面的脚本将列从 varchar(50) 更改为 nvarchar(200)。

```
alter table TableName 
alter column ColumnName nvarchar(200) 
```

**编辑：**关于您在更改列类型时发布的错误。

> ** 将数据类型 nvarchar 转换为浮点数时出错。**

一种方法是创建一个新列，并将所有好的（*可转换和兼容*的）记录转换为新列。之后，您可能想清理未转换的不良记录，删除旧列并将新添加和填充的列重命名为原始名称。**重要提示：**首先使用测试环境进行所有这些操作。通常，玩制作表会变成把事情搞砸的坏习惯。

**寻找更多关于类似 SE 帖子的讨论的**参考资料：****

 ***   [更改大表中的列类型](https://stackoverflow.com/q/10754665/1437962)
*   [如何在不丢失数据的情况下更改 SQL Server 数据库中的列数据类型](https://stackoverflow.com/q/5136013/1437962)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T18:53:00.350

显然，没有默认转换为您的新数据类型。一种解决方案可能是创建具有请求类型的第二列，并编写您自己的转换函数。完成此操作后，删除第一列并用相同的名称重命名第二列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:53:04.720

需要考虑的事项：你的桌子有多大。然后使用`alter table`语法。我们不知道您要更改什么数据类型，因此例如

更改列：

```
Alter Table [yourTable] Alter column [yourColumn] varchar(15) 
```

*   您也可以尝试添加新列，然后使用旧列更新该列。删除旧列。重命名新列。**这是一种更安全的更好方法**，因为有时您持有的数据可能对新数据类型反应不佳......

一个帖子来寻找想法：[更改大表中的列类型](https://stackoverflow.com/questions/10754665/change-column-types-in-a-huge-table?lq=1)，[如何在不丢失数据的情况下更改 SQL 数据库中的列数据类型](https://stackoverflow.com/questions/5136013/how-to-change-column-datatype-in-sql-server-database-without-losing-data)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-31T06:13:53.880

更改该列的数据类型..但一般 sql 不允许更改。它会提示您删除该列..有设置来实现那个东西。
转到工具->选项->设计器->表和数据库设计器并取消选中阻止保存选项。我正在使用 abt sql server 2008R2。现在您可以轻松更改数据类型。[![在此处输入图像描述](../Images/f6379e67ea1caa8231d53cbe2a016ed6.png)](https://i.stack.imgur.com/TTTJ9.png)****

# linux - 从可执行文件中删除所有符号表和重定位信息的影响？

> ID：14175040
> 
> 赞同：11
> 
> 时间：2013-01-05T18:42:17.777
> 
> 标签：linux, gcc, assembly, executable

**[`gcc -s`](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options)**使用Unix进行编译**[`strip`](http://en.wikipedia.org/wiki/Strip_%28Unix%29)**从可执行文件中删除所有符号表和重定位信息（使其更小）。

这会影响可执行文件的功能吗？**[某些执行地址空间布局随机化 ( ASLR](http://en.wikipedia.org/wiki/Address_space_layout_randomization)** )的操作系统是否需要此信息？如果不是，为什么要让它们放在首位？

对上述内容进行稍微**详细**的概述会有所帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T21:04:01.423

很明显，删除重定位信息会干扰 ASLR。

但是，我已经查看`man strip`了我的几个系统，但没有一个建议`strip`确实（或确实可以？）删除重定位信息。它主要是关于删除调试符号。

# jquery - jquery.form 和文件上传的跨域请求

> ID：14175043
> 
> 赞同：2
> 
> 时间：2013-01-05T18:42:39.033
> 
> 标签：jquery, iframe, file-upload, jquery-forms-plugin, asyncfileupload

我正在尝试使用 jquery 表单插件使跨域文件上传表单工作，但我在 firebug 控制台中不断收到以下错误：

```
Permission denied to access property 'document' 
```

它发生在 jquery.form 插件的以下行

```
403: var doc = frame.contentWindow ? frame.contentWindow.document : frame.contentDocument ? frame.contentDocument : frame.document; 
```

如果我使用 safari，我会收到此错误：

```
Unsafe JavaScript attempt to access frame with URL http://s1.test-host/index.php/upload/start?is-async=1 from frame with URL http://test-host/index.php/main/. Domains, protocols and ports must match. 
```

for 的 html 如下所示：

```
 <form action="http://s1.test-host//index.php/upload/start" method="post" accept-charset="utf-8" id="upload-form" enctype="multipart/form-data">
    <input type="hidden" name="MAX_FILE_SIZE" value="1204000"  />
      <label for="file-input">Input File</label>
      <input type="file" name="file" value="" id="file-input" alt="Input File"  />
      <input type="submit" name="upload" value="Convert" id="start-upload" />
  </form> 
```

javascript看起来像这样：

```
$(this).ajaxForm ({
    beforeSubmit: onFileFormSubmit,     // pre-submit callback
    success:      onFileFormSubmitEnd,  // post-submit callback
    resetForm:    true,             // reset the form after successful submit
    dataType:     'json',           // force response type to JSON
    iframe:       true              // force the form to be submitted using an iframe
}); 
```

目标php页面有这个：

```
 if ($_SERVER['HTTP_ORIGIN']) {
        header('Access-Control-Allow-Origin: *');
        header('Access-Control-Allow-Methods: POST, GET, OPTIONS');
        header('Access-Control-Max-Age: 1000');
        header('Access-Control-Allow-Headers: Content-Type');
    }
   ... // Usual upload handling code 
```

但似乎没有任何效果。我什至尝试将 'dataType' 更改为 'jsonp' 并将表单方法从 'post' 更改为 'get' 但所有这些都无济于事，我仍然不断收到相同的错误。如果我查看服务器，文件确实会上传，但 javascript 无法调用成功函数。

谷歌搜索后，我发现可能有其他解决方案，如“JQuery 文件上传”或“plupload”，但我真的需要一些简单的东西，我不想使用 HTML5 功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:45:31.563

文件上传插件使用 iframe 上传文件。由于您无法在没有适当 CORS 标头的情况下跨域发布，并且您无法将 CORS 标头提供给 iframe，因此这根本是不可能的。最好的选择是将其发布到您的服务器，然后根据需要使用服务器端代码将其移动到跨域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T03:36:55.080

我知道你不想要任何花哨的东西，但对于没有完全 XHR 支持的浏览器中的跨域，我建议使用**jQuery-File-Upload**插件。它使用 iframe 将文件上传到另一个域。但它需要更多的工作：

*   您需要将上传服务器响应更改为插件的[预期](http://github.com/blueimp/jQuery-File-Upload/wiki/Setup)
*   您需要在原始服务器中的某处上传[result.html](http://github.com/blueimp/jQuery-File-Upload/wiki/Cross-domain-uploads)以获得响应

如果你不想要 UI 的东西，你可以使用插件的*基本*版本。

# java - 修改或删除文件中的数据

> ID：14175050
> 
> 赞同：0
> 
> 时间：2013-01-05T18:43:34.637
> 
> 标签：java, file, file-io

今天我正在尝试在Windows平台上使用Java修改和删除文件内数据的算法。

第 1 步：创建临时文件 第 2 步：将 originalFile 中所需的数据写入字符串并写入到临时文件 第 3 步：将临时文件重命名为 originalFile。

### ****编码：****

```
`import java.io.File;
import java.io.IOException;
import java.io.FileWriter;
import java.util.Scanner;
import java.io.FileNotFoundException;

public class testing{
    private static String temp;
    public static void main(String [] args)
    {
        try{
        File tempFile = File.createTempFile("haha\\temporary", ".txt");         //create a temporary file in haha folder
        FileWriter writer = new FileWriter(tempFile); 
        Scanner input = new Scanner(new File("haha\\testing.txt")); //get input from testing.txt
        temp = input.next();
        writer.write(temp);
        writer.close();
        File origFile = new File("haha\\testing.txt");
        tempFile.renameTo(origFile);
        }
        catch ( FileNotFoundException fileNotFoundException ){}
        catch(IOException ioException){}
    }
}` 
```

 **在上面的代码中，要编辑的文本文件位于一个文件夹名称`haha`中，该文件夹名称与另一个文件夹一起位于另一个文件夹中。`testing.class`我试过这段代码无济于事，原始文本文件没有变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T18:49:43.370

如果您的文件位于同一目录中，则无需将路径传递给 File 构造函数。

```
Scanner input = new Scanner(new File("testing.txt")); 
```

这应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:09:54.180

您需要关闭 Scanner 对象才能进行更改，底层操作系统具有必须释放的文件锁。

```
 input.close();
     File origFile = new File("haha\\testing.txt"); 
```**

# node.js - Chrome 中的“意外响应代码：503”。也许与heroku上的socket.io有关？

> ID：14175051
> 
> 赞同：14
> 
> 时间：2013-01-05T18:43:43.287
> 
> 标签：node.js, heroku, socket.io, google-chrome-devtools

我在 Heroku 上使用 socket.io 和 node.js。一切似乎都奏效了。但是，在 Chrome 开发栏中，我得到`Unexpected response code: 503`. 有谁知道这可能意味着什么？我应该担心吗？它会占用浏览器的内存吗？如果是这样，我可以压制它吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-03T14:46:54.507

Heroku 在 Cedar 堆栈上“不支持”websockets ~~（没有关于何时支持的消息）~~更新：见下文。 [他们建议](https://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku)将以下代码添加到您的 Socket.io 实现中：

```
// assuming io is the Socket.IO server object
io.configure(function () { 
  io.set("transports", ["xhr-polling"]); 
  io.set("polling duration", 10); 
}); 
```

这样做的原因是 Heroku 在你的测功机之上添加了一个路由层。您的代码将在服务器上执行*，*但不确定它将是哪个服务器。因此，WebSockets 无法将数据发送到“正确”的服务器。Socket.IO 将降级为长轮询，通过路由层保持连接处于活动状态，确保事件将在正确的服务器上执行。

更新：[Heroku WebSockets](https://blog.heroku.com/archives/2013/10/8/websockets-public-beta)现在处于公开测试阶段！`heroku labs:enable websockets -a myapp`您可以通过在您的应用程序目录中执行来为您的应用程序添加 WS 支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-17T21:39:59.590

对于 2016 年来自谷歌的人。

现在支持 Heroku websockets，无需打开它们。[Heroku 上的 WebSockets](https://devcenter.heroku.com/articles/websockets)

请务必检查您在 Heroku 上的日志。我注意到 503 错误发生在 chrome 中，检查日志后发现我的 Heroku 应用程序崩溃了。我的代码中有一个错误导致它没有响应（根本与 socket.io 无关）

修复了代码，503 消失了！

# php - 通过javascript重复元素

> ID：14175054
> 
> 赞同：0
> 
> 时间：2013-01-05T18:43:52.330
> 
> 标签：php, javascript

我想重复这些元素：包含一个单元格并选择菜单通过 while 从数据库中获取数据

```
<div id="orginal">
<td width="99">
    <select name= "certificate"  id="xx" 
    onchange="BK.Ajax.Updates('newfile.php?id='+document.getElementById('xx').value,'ajx');" size="1">
        <option>.....</option>
        <?
        $sql_company=mysql_query("select * from company");
        while ($row=mysql_fetch_array($sql_company))
        {
            echo "<option value='$row[id]'> ";
            echo $row['name'] ;
            echo "</option>";
        }
        ?></select>

    </td> 
```

在另一个 div 中：

```
<div id="wrapper">
</div> 
```

使用 Javascript 代码：

```
<script language="javascript">
function repeat()
{
var el = document.createElement('div');
var oldHTML = document.getElementById('orginal').innerHTML;
el.innerHTML = oldHTML;
document.getElementById('wrapper').innerHTML = el;
}
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T18:48:01.697

该`innerHTML`属性用于将 HTML（字符串）设置为元素。如果要添加元素对象本身，则需要使用`.appendChild()`

代替

`document.getElementById('wrapper').innerHTML = el;`

和

`document.getElementById('wrapper').appendChild(el);`

# php - 在特定时间自动增加 P HP 中的变量

> ID：14175057
> 
> 赞同：-1
> 
> 时间：2013-01-05T18:43:54.853
> 
> 标签：php, cron

好的，所以我对 php 相当陌生。我在网上找不到解决我的问题的方法，所以就在这里。我正在为 Windows 开发 XAMPP，在我的网页上有一个 ID 范围从 1 到 1000 的数组。然后我有一个名为 $currentid 的变量，它代表当前 ID。

```
$currentid=$ids[0] 
```

问题是我需要某种方法让这个 currentid 变量在每天午夜（UTC）自动递增 1，然后刷新页面。因此，例如，我希望明天该变量为：

```
$currentid=$ids[1] 
```

我听说过有关 Cron 工作的一些信息，但我不知道它们是如何工作的，或者它们是否是这样做的唯一方法。谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:02:56.477

Marc B 是正确的，你需要一个 cron 工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T18:52:11.660

您可以给脚本一个 get var，例如：

```
yourscript.php?old_id=[value] 
```

使用 javascript 在特定时间重新加载页面...

在下一步中捕获重新加载后的值并增加它

```
$id = $_GET[old_id];
$id++; 
```

# php - 下面的mysql错误是什么？

> ID：14175060
> 
> 赞同：-2
> 
> 时间：2013-01-05T18:44:25.107
> 
> 标签：php, mysql, create-table

这是创建一个名称为用户 id 的新表

```
$tablename=$_SESSION['lgn-id'];

mysql_query("CREATE TABLE $tablename(
qtno INT NOT NULL AUTO_INCREMENT, 
PRIMARY KEY(qtno),
 qt VARCHAR())")
 or die(mysql_error());  

echo " so I created one!"; 
```

它显示以下错误表名称为 text36.txt@gmail.com

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '@gmail.com(qtno INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(qtno), qt V' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T18:50:47.433

问题在于未引用的表名以及`VARCHAR()`. 它必须有一个长度，例如`VARCHAR(100)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T18:47:12.917

从错误中问题很明显，您的表名中不能有`@`字符。

您可以将其包装在反引号中以解决该问题。您还需要为`varchar()`

参考文献：[9.2。架构对象名称](http://dev.mysql.com/doc/refman/5.0/en/identifiers.html)，[11.1.6.1。CHAR 和 VARCHAR 类型](http://dev.mysql.com/doc/refman/5.0/en//char.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:54:04.190

您的创建语句应该是

```
CREATE TABLE `$tablename`(
qtno INT(10) NOT NULL AUTO_INCREMENT, 
qt VARCHAR(100),
PRIMARY KEY(qtno)) 
```

为每个用户创建单独的表是个坏主意，假设你有 1000 多个用户，你想创建 1000 多个表吗？为帖子创建表`UserId, Post`并从用户表和帖子中存储用户ID

您可以创建 Posts 表，如

```
CREATE TABLE UserPosts
(
   id INT(10) NOT NULL AUTO_INCREMENT,
   UserId Varchar(100),
   UserPost varchar(1024),
   InserDate DateTime,
   PRIMARY KEY(id)
) 
```

然后你可以做

```
select UserId, UserPost FROM UserPosts Where UserId = 'text36.txt@gmail.com' 
```

# jquery - twitter bootstrap 词缀“刷新”方法

> ID：14175062
> 
> 赞同：1
> 
> 时间：2013-01-05T18:44:31.517
> 
> 标签：jquery, twitter-bootstrap

Twitter Bootstrap 的 Affix 组件列出了一个不存在的名为“刷新”的方法。我想这个方法会解除绑定（例如 jQuery.off('affix.data.api') ）并重新计算偏移量（例如 offset-top），因为页面可能已经调整大小，DOM 元素可能已经添加、删除等

由于这种方法不存在，我很好奇是否有人找到了“刷新”页面上所有当前附加元素的解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T21:25:17.707

你可以这样做：

```
$('[data-spy=affix]').each(function () { $(this).data('affix').checkPosition(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:08:57.177

[因此，您在http://twitter.github.com/bootstrap/javascript.html#affix](http://twitter.github.com/bootstrap/javascript.html#affix)上使用数据间谍或 javascript 描述的方法，并使用 .affix('refresh') 方法，并且您已将 CSS 设置为指定当它们被贴上时，你的 div 会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-29T01:19:12.523

我相信它`$('#element').affix('checkPosition')`适用于引导程序 3.1.x。

# objective-c - 观察对象的所有属性变化

> ID：14175069
> 
> 赞同：2
> 
> 时间：2013-01-05T18:44:55.467
> 
> 标签：objective-c, cocoa, key-value-observing

> **可能的重复：**
> [观察 Objective-C 中任何类属性的变化](https://stackoverflow.com/questions/1910449/observing-a-change-to-any-class-property-in-objective-c)

我有一个`currentUser`包含`int`s 和`const char*`s 的对象，我正在尝试实现一个注销系统。当按下注销按钮时，我希望能够检查我是否对对象进行了任何更改，如果是，我想在注销之前提示用户保存。

为了做到这一点，我认为我需要能够观察对对象所做的更改（如果有的话）。我考虑过 KVO，但我不知道如何将整个变量视为关键路径。有人对我应该做什么有任何想法吗？另外，如果您也可以发布一些代码，那将有所帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T18:49:50.243

不确定这是否符合您的需求，但是否可以向 NSNotificationCenter 发布通知？

# matlab - 搜索单元格和提取行

> ID：14175072
> 
> 赞同：0
> 
> 时间：2013-01-05T18:45:33.137
> 
> 标签：matlab

我正在尝试检查特定值位于单元格中的哪些行，然后从另一个单元格中检索这些位置中的行并将它们放入变量中。

我的数据是这样的：

```
1x4 Cell =

     A           B          C            D           %Cell labels for clarity
{10x1 Cell} {10x1 Cell} {10x1 Cell} [10x1 Double]

   B          blue          M           4.78
   R          red           N           6.43
   R          red           N           6.89
   B          blue          M           7.99
   B          blue          M           5.87
   B          blue          M           4.78
   R          red           N           6.43
   R          red           N           6.89
   B          blue          M           7.99
   B          blue          M           5.87 
```

例如，它会像这样：1) 搜索`"blue"`位于 中的行`B`，2) 发现“蓝色”位于第 1、4、5、6、9 和 10 行。然后 3) 提取行1、4、5、6、9 和 10 从另一个数据单元`C`, 到一个新变量。

据我所知，像这样的逻辑操作`==`可能不足以完成我想做的事情。我应该考虑哪些功能来实现这一目标？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T23:00:02.287

试试这个：

```
C(cellfun(@isequal, B, repmat({'blue'},10,1))) 
```

解释：

*   `repmat`制作一个大小为 B 的 'blue' 单元阵列
*   `isequal`比较两个单元格的内容
*   `cellfun`对所有单元格重复并返回逻辑列
*   `C(...)`用该列索引 C 并返回匹配的行

问候

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T23:36:16.927

我会分两步做。首先进行比较并获取逻辑数组，然后使用它和单元格乐趣来提取您的行。

```
idx = strcmp('blue', A{2});
B = cellfun(@(x) x(idx), A, 'UniformOutput', false); 
```

# java - 将声明变量的字符串（例如“x+y”）转换为双精度作为数学函数

> ID：14175085
> 
> 赞同：0
> 
> 时间：2013-01-05T18:46:30.950
> 
> 标签：java

我正在尝试做的是读取一行（字符串）并将其用作数学函数以在不同点获取（双）值或答案（基本上就像一个计算器）

我包含了一个非常简单的代码，说明我正在尝试做的事情只是为了直接和直接：

```
double x, y, z;
String function;

x = 5;
y = 4;
function = "(x*y)+y";

z = Double.parseDouble(function);

/*
I want z to equal this
z = (x*y)+y;
*/
System.out.print("z= " + z); 
```

同样，这只是一个示例代码，可以更清楚地了解我的问题。我的问题又是：当 z 是双精度且函数是字符串时，如何设置 z = function？

注意：如您所见，我尝试了 parse，但它不起作用。我也尝试逐个字符地读取字符串，但它也不起作用，因为它将字符的值加在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:01:48.040

我建议你看看[Parboiled](https://github.com/sirthias/parboiled)。与几乎所有其他 Java 解析器解决方案不同，您编写语法......在 Java 中。

更重要的是，在 Java 示例中，还有可用的[计算器](https://github.com/sirthias/parboiled/tree/master/examples-java/src/main/java/org/parboiled/examples/calculators)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T18:50:42.700

我猜您正在寻找[lexer](http://en.wikipedia.org/wiki/Lexical_analysis)和[parser](http://en.wikipedia.org/wiki/Parsing)。

这些是每个编译器或解释器的基本组件

*   词法分析器能够将输入（您的字符串）拆分为标记
*   解析器能够构建一棵树，表示您的标记的句法形状，以便在语义上进一步解释

这门学科非常广泛，我建议您从Java 的[ANTLR](http://www.antlr.org/)之类的东西开始，它是一个解析器生成器，可以根据您通过语法指定的规则生成词法分析器和解析器。有很多，这只是我想到的第一个。

如果您想忘记所有这些理论，只需在您的 Java 程序中嵌入 JavaScript 或 Groovy 之类的东西，它们就能够解释在运行时给出的代码，这样您就可以这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T18:54:07.763

Java没有`eval`内置的东西。[但是您可以为此使用spEL](http://static.springsource.org/spring/docs/3.0.x/reference/expressions.html)、[mvel](http://mvel.codehaus.org)或[Jexl](http://commons.apache.org/jexl/)等表达式语言。

也许[这个](https://stackoverflow.com/questions/13940294/techniques-of-el-on-java)SO question 可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T19:05:26.003

```
float eval(String exp)
{
    char[] a = exp.toCharArray();
    float[] buffer = new int[exp.length];
    int k = 0;
    for(int i : a)
    { 
        if(a[i] >= 48 && a[i] <= 57) //checking for numbers
        {
             int x = a[i] - '0';
             buffer[k++] = x;
        }
        else if(a[i] == '+' || a[i] == '-' || a[i] == '*' || a[i] == '/') //checking for operands
        {
             float result;
             switch(a[i])
             {
                  case '+': result = buffer[k] + buffer[k-1]; break;       
                  case '-': result = buffer[k] - buffer[k-1]; break;
                  case '*': result = buffer[k] * buffer[k-1]; break; 
                  case '/': result = buffer[k] / buffer[k-1]; break;               
             }
        }
        buffer[k++] = result;
    }
    return buffer[k]; //finally returning the recent value
} 
```

使用这样的方法。会有很大帮助。使用堆栈数据结构实现。

# php - $_POST 合并数组并仅存储在一列中

> ID：14175087
> 
> 赞同：0
> 
> 时间：2013-01-05T18:46:41.473
> 
> 标签：php, ajax, database

我有一个发布到 php 处理程序的表单，它将表单中的数据保存到数据库中。我认为保存功能不是问题。我认为这是`$_POST`合并表单数据的问题。当我查看 sql 表时，数据在那里，但所有值都出现在一列中，因此变量从表单中正确传递。

这是我的代码：

```
$name = isset($_POST['name']) ? $_POST['name'] : '';
$email = isset($_POST['email']) ? $_POST['email'] : '';
$com_dis = isset($_POST['comment']) ? $_POST['comment'] : '';
$id = isset($_POST['id']) ? $_POST['id'] : '';

$lowercase = strtolower($email);
$image = md5( $lowercase );

try{
    $conn = new PDO( DB_DSN, DB_USERNAME, DB_PASSWORD );
    $sql = 'INSERT INTO comments ( com_name, com_email, com_dis, post_id_fk ) VALUES ( :name, :email, :com_dis, :id )';
    $st = $conn->prepare ( $sql );
$st->bindValue( ":name", $name, PDO::PARAM_STR );
    $st->bindValue( ":email", $email, PDO::PARAM_STR );
    $st->bindValue( ":com_dis", $com_dis, PDO::PARAM_STR );
    $st->bindValue( ":id", $id, PDO::PARAM_INT );
    $st->execute();
    $conn = null;
}catch(PDOException $e ){
    echo "QUERY FAILED" . $e->getMessage();
}; 
```

如果我使用`$id = $_POST['id']`所有变量，它会抛出一个未识别的索引错误。当我打印`$_POST`时，它会显示一个数组，其中数组称为名称，内容只是其余的变量，它们是存储在表中的相同数据。

如何让数据正确保存或停止`$_POST`合并变量？保存在正确的列中？

这是我的表格：

```
<form action="#" method="post">
    <input type="hidden" name="id" id="id" value="<?php echo $id; ?>"/><br />
    <span class="titles">Name</span><span class="star">*</span><br /><input type="text" name="name" id="name"/><br />

    <span class="titles">Email</span><span class="star">*</span><br /><input type="text" name="email" id="email"/><br />

    Comment<br /><textarea name="comment" id="comment"></textarea><br />

    <input type="submit" class="submit" value=" Submit Comment " />
</form> 
```

表单通过 AJAX 传递：

```
$(function() {

    $(".submit").click(function() {

        name = $("#name").val();
        var email = $("#email").val();
        var comment = $("#comment").val();
        var id = $("#id").val();
        var dataString = 'name='+ name + 'email=' + email + 'comment=' + comment + 'id=' + id;

        if(name=='' || email=='' || comment==''){
            alert('Please Give Valid Details');
        }

        else{
            $("#flash").show();
            $("#flash").fadeIn(400).html('<img src="ajax-loader.gif" align="absmiddle">&nbsp;<span class="loading">Loading Comment...</span>');

            $.ajax({
                type: "POST",
                url: "commentajax.php",
                data: dataString,
                cache: false,
                success: function(html){

                    $("ol#update").append(html);
                    $("ol#update li:last").fadeIn("slow");
                    document.getElementById('email').value='';
                    document.getElementById('name').value='';
                    document.getElementById('comment').value='';
                    $("#name").focus();

                    $("#flash").hide();
            }
        });
    }
return false;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T18:59:37.367

您需要连接您的数据字符串：

```
var dataString = 'name='+ name + 'email=' + email + 'comment=' + comment + 'id=' + id; 
```

应该

```
var dataString = 'name='+ name + '&email=' + email + '&comment=' + comment + '&id=' + id; 
```

# python - Python：urllib2 和代理

> ID：14175089
> 
> 赞同：0
> 
> 时间：2013-01-05T18:46:42.630
> 
> 标签：python, proxy, urllib2

我正在尝试用 Python 编写一个脚本，该脚本使用代理列表每 x 秒重新加载一个页面，而我目前遇到了一个问题。我知道这也不是代理的错，因为我可以 ping 它们并且它们返回正常。它们是 HTTP 代理。我的脚本将此错误返回给我：

```
urllib.error.URLError: <urlopen error [WinError 10061] No connection could be made because the target machine actively refused it> 
```

我不知道如何解决它。这是实际的脚本：

```
import urllib.request
import time
proxy_list = input("Name of proxy list file?: ")
proxy_file = open(proxy_list, 'r')
url = input("URL to bot? (Has to include http://): ")
sleep = float(input("Time between reloads? (In seconds, 0 for none): "))
proxies = []
for line in proxy_file:
    proxies.append( line )
proxies = [w.replace('\n', '') for w in proxies]

while True:
    for i in range(len(proxies)):
        proxy = proxies[i]
        proxy2 = {"http":"http://%s" % proxy}
        proxy_support = urllib.request.ProxyHandler(proxy2)

        opener = urllib.request.build_opener(proxy_support)
        urllib.request.install_opener(opener)
        urllib.request.urlopen(url).read()
        time.sleep(float(sleep)) 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:19:49.290

不要使用`urllib2`. 说真的，只是不要。

你的圣杯：[`requests`](http://docs.python-requests.org/en/latest/)。

你想要做的是：

```
while True:
    for proxy in proxies:
        r = request.get(my_url, proxies={'http': proxy})
        print r.text
        time.sleep(float(sleep)) 
```

# python - 获取文件夹名称

> ID：14175099
> 
> 赞同：3
> 
> 时间：2013-01-05T18:47:18.823
> 
> 标签：python

我遍历文件夹中的一堆文件夹和文件，这样做：

```
def get_files_in_directory(directory=rootDirectory):
    for root, dirs, files in os.walk(directory, topdown='true'):
        print("root %s dirs %s files %s" %(root, dirs, files));
        for file in files:
            ext = os.path.splitext(file)[-1].lower();
            if (ext == '.mod'):
                print(file); 
```

当我打印文件时，我还想打印包含它的目录的相对名称。

所以如果我有

```
C:\\myfolderA\\myFolderB\\myFile.MOD 
```

我只是得到

```
myFolderB 
```

我不想

```
C:\\myFolderA\\myFolderB 
```

当然我可以从 dir 变量中得到

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-07-28T10:55:33.903

使用`os.path.relpath(".","..")`，你就完成了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T18:51:00.680

使用[`os.path.relpath()`](http://docs.python.org/2/library/os.path.html#os.path.relpath)：

```
print os.path.relpath(root, directory) 
```

`directory`函数中已经存在的局部变量名称在哪里。`os.path.relpath()`创建`root`一个相对于 的路径`directory`。既然你从那里开始你的步行，`directory`那将是`myFolderB`一个起点`directory = "C:\\myfolderA"`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-21T22:48:19.320

file_path 是文件的完整路径。

```
folder_path = os.path.dirname(file_path) 
```

folder_path 现在是包含文件的文件夹的完整路径。

```
path,folder_name = os.path.split(folder_path) 
```

folder_name 现在只是 folder_path 末尾的文件夹名称。

```
print folder_name 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-05T18:52:23.390

```
>>> os.path.relpath('/myFolderA/myFolderB/myFile.MOD', '/myFolderA')
'myFolderB/myFile.MOD' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T18:50:52.370

用[`os.path.relpath("myFolderA\\myFile.MOD", "c:\\")`](http://docs.python.org/2/library/os.path.html). `os.path.abspath`也可能派上用场。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-05T19:05:41.497

看看 David Beazley 的演讲，“系统程序员的生成器技巧”。

可以在[此处](http://www.dabeaz.com/generators/index.html)找到演示文稿中的幻灯片和源代码。

# javascript - JavaScript？多层弹出

> ID：14175103
> 
> 赞同：0
> 
> 时间：2013-01-05T18:47:38.860
> 
> 标签：javascript

我想要一个像这样的多层弹出窗口： ![JavaScript 弹出窗口](../Images/f1f67b7c31549470338c4c0732fb7560.png)

这个功能叫什么名字？描述它的唯一可能方式是“多层弹出”，因为我不知道它的名称。我在很多网站上都看到过，我可以有一个教程或者一个片段吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T18:48:57.453

这通常称为灯箱。

已知的良好实现是

*   [http://www.digitalia.be/software/slimbox2](http://www.digitalia.be/software/slimbox2)
*   [http://leandrovieira.com/projects/jquery/lightbox/](http://leandrovieira.com/projects/jquery/lightbox/)
*   [http://fancybox.net/](http://fancybox.net/)

可能还有更多。选择最符合您要求的一种。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T18:58:29.057

> 这个功能叫什么名字？

这些框通常称为“模态”或“模态弹出窗口”。

AKX 引用了一些非常好的。我个人更喜欢facebox：[https ://github.com/defunkt/facebox](https://github.com/defunkt/facebox)

此外，Twitter Boostrap 模态看起来也很酷：http: [//twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

# python - 是否可以使用 Python 将 Excel 工作表中的数据推送到数据库中？

> ID：14175110
> 
> 赞同：-2
> 
> 时间：2013-01-05T18:48:24.020
> 
> 标签：python, xlrd, xlwt, xlutils

我有一个要求，我需要使用 Python 写入 excel 单元格，我将从网页收集的数据。

但没有选择如何做到这一点。

你们有什么想法吗？

***根据@Marcin 的评论，这里是我正在寻找的更明确的要求***

**为什么需要python？**->*是的，我正在使用 Python 和 Beautiful Soup 模块从网页中获取数据。*

**excel在哪里运行，或者根本就在运行？**->*当脚本从网页完成其数据收集时需要 Excel，并将尝试到下一页执行相同的任务，我希望将当前数据保存为 excel 格式。*

**这与网络有什么关系？你到底想达到什么目的？** *希望对您的上述问题给出这个答案。*

**您可以只使用 CSV 文件吗？** *是的，我可以使用它，但我的最终目标是将数据推送回数据库，可以是 Oracle 或 Access 数据库。*

***建筑学***

```
 ------------------
                |       web        |
                |       page       |
                 ------------------
                          |
                          |
                          |
            Python and BS4(Data Extraction)
                          |
                          |
                          |
                 ------------------                               
                |       Excel      |
                |       data       |
                 ------------------
                          |
                          |
                          |
             Python to Push Data(Oracle/Access)
                          |
                          |
                          |
                 ------------------
                |       Any        |
                |       DB         |
                 ------------------ 
```

**编辑**

**根据@Thang**

我试过但收到错误：

```
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\Happy>python
Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win
32
Type "help", "copyright", "credits" or "license" for more information.
>>> import win32com.client
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named win32com.client
>>> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:23:34.477

实际上，您有几个选择，具体取决于您要做什么。

[`xlwt`](https://secure.simplistix.co.uk/svn/xlwt/trunk/xlwt/doc/xlwt.html)- 我认为这非常适合从 Python 操作 Excel 文件。我已将您链接到文档。 [DataNitro](https://datanitro.com/) - 用于 Excel 中的 Python 脚本。它有点慢，但我已经用过很多次了。您可以（通常使用 VBA）让 Excel 发出 Web 请求并拉入表格。在我知道如何编程之前，这就是我进行所有网络抓取的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:19:22.480

对于 Office 2007 及更高版本，API 是 .Net，因此您可以使用[Python for .Net](http://pythonnet.sourceforge.net/)或[IronPython](http://ironpython.net/)。

Thang 提到了 pywin32，它也适用于 Office 2007 及更高版本和更早的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:22:32.557

如果您正在使用 Office 2007 excel（又名 xlsx 文件），请尝试[使用](http://packages.python.org/openpyxl/)OpenPyXL

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T19:43:08.683

如果您只需要能够使用 Excel 中的数据，请使用该模块将其保存为`csv`格式。`csv`

如果您需要直接生成 Excel 格式文件（我认为您没有理由这样做，因为您没有说您正在接收 excel 文件），您可以使用其他答案中提到的第三方模块之一。

更新：使用 CSV 不会阻止您将数据放入数据库；同样，如果您想将数据放入数据库，Excel 也不会特别帮助您。更好的方法是将数据简单地保存在内存中，并在完成后将其写入数据库。如果您需要中间存储，请使用另一个数据库。

# c++ - opencv - 图像乘法

> ID：14175114
> 
> 赞同：4
> 
> 时间：2013-01-05T18:48:39.153
> 
> 标签：c++, matlab, opencv, multiplication

嗨，我想玩一点 Mat 课。我想在两个图像之间明智地做一个产品元素，MATLAB [immultiply](http://www.mathworks.it/it/help/images/ref/immultiply.html)的 c++/opencv 端口。

这是我的代码：

```
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include "opencv2/imgproc/imgproc.hpp"

#include <iostream>

using namespace cv;
using namespace std;

Mat imgA, imgB;
Mat imgAB;
Mat product;

void printMinMax(Mat m, string s) {
    double minVal; 
    double maxVal; 
    Point minLoc; 
    Point maxLoc;

    minMaxLoc( m, &minVal, &maxVal, &minLoc, &maxLoc );
    cout << "min val in " << s << ": " << minVal << endl;
    cout << "max val in " << s << ": " << maxVal << endl;
}

int main(int /*argc*/, char** /*argv*/) {

    cout << "OpenCV version: " << CV_MAJOR_VERSION << " " << CV_MINOR_VERSION << endl;

    imgA = imread("test1.jpg"); 
    cout << "original image size: " << imgA.rows << " " << imgA.cols << endl;
    cout << "original type: " << imgA.type() << endl;
    cvtColor(imgA, imgA, CV_BGR2GRAY);
    printMinMax(imgA, "imgA");

    imgB = imread("test2.jpg"); 
    cout << "original image size: " << imgB.rows << " " << imgB.cols << endl;
    cout << "original type: " << imgB.type() << endl;
    cvtColor(imgB, imgB, CV_BGR2GRAY);
    printMinMax(imgB, "imgB");

    namedWindow("originals", CV_WINDOW_AUTOSIZE);
    namedWindow("product", CV_WINDOW_AUTOSIZE);

    imgAB = Mat( max(imgA.rows,imgB.rows), imgA.cols+imgB.cols, imgA.type());
    imgA.copyTo(imgAB(Rect(0, 0, imgA.cols, imgA.rows)));
    imgB.copyTo(imgAB(Rect(imgA.cols, 0, imgB.cols, imgB.rows)));

    product = imgA.mul(imgB);
    printMinMax(product, "product");

    while( true )
    {
        char c = (char)waitKey(10);

        if( c == 27 )
            { break; }

        imshow( "originals", imgAB );
        imshow( "product", product );
    }

    return 0;
} 
```

结果如下：

```
OpenCV version: 2 4
original image size: 500 500
original type: 16
min val in imgA: 99
max val in imgA: 255
original image size: 500 500
original type: 16
min val in imgB: 0
max val in imgB: 255
init done 
opengl support available 
min val in product: 0
max val in product: 255 
```

我认为产品中的最大值必须大于 255，但被截断为 255，因为两个矩阵的类型是 16。我试图将矩阵转换为 CV_32F 但产品中的 maxVal 是 64009（一个数字我不明白）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T01:15:11.743

感谢[Wajih 的](https://stackoverflow.com/users/349026/wajih) [评论](https://stackoverflow.com/questions/14175114/opencv-image-multiplication#comment19642872_14175114)，我做了一些基本的测试和一些基本的调试，我得到了完美的工作。我认为这可以成为关于 alpha 混合和图像乘法的迷你教程，但现在只有几行注释代码。

请注意，这两个图像必须具有相同的大小..并且肯定应该对可靠的代码进行一些错误检查..

希望它可以帮助某人！而且，当然，如果您有一些提示可以使此代码更具可读性或更紧凑（单行人员非常感谢！）或高效.. 只需发表评论，非常感谢！

```
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include "opencv2/imgproc/imgproc.hpp"

#include <iostream>

using namespace cv;
using namespace std;

void printMinMax(Mat m, string name) {
    double minVal; 
    double maxVal; 
    Point minLoc; 
    Point maxLoc;

    if(m.channels() >1) {
        cout << "ERROR: matrix "<<name<<" must have 1 channel for calling minMaxLoc" << endl;
    }

    minMaxLoc( m, &minVal, &maxVal, &minLoc, &maxLoc );
    cout << "min val in " << name << ": " << minVal << " in loc: " << minLoc << endl;
    cout << "max val in " << name << ": " << maxVal << " in loc: " << maxLoc << endl;
}

int main(int /*argc*/, char** /*argv*/) {

    cout << "OpenCV version: " << CV_MAJOR_VERSION << " " << CV_MINOR_VERSION << endl; // 2 4

    Mat imgA, imgB;
    Mat imgAB;
    Mat product;

    // fast matrix creation, comma-separated initializer
    // example1: create a matrix with value from 0 to 255
    imgA = Mat(3, 3, CV_8UC1);
    imgA = (Mat_<uchar>(3,3) << 0,1,2,3,4,5,6,7,255);
    cout << "test Mat 3x3" << endl << imgA << endl;

    // not that if a value exceed 255 it is truncated at value%256 
    imgA = (Mat_<uchar>(3,3) << 0,1, 258 ,3,4,5,6,7,255);
    cout << "test Mat 3x3 with last element truncated to 258%256=2" << endl << imgA << endl;

    // create a second matrix
    imgB = Mat(3, 3, CV_8UC1);
    imgB = (Mat_<uchar>(3,3) << 0,1,2,3,4,5,6,7,8);

    // now the matrix product. we are multiplying a value that can goes from 0-255 with another 0-255 value..
    // the edge cases are "min * min" and "max * max", 
    // that means: our product is a function that return a value in the domain 0*0-255*255 ; 0-65025
    // ah, ah! this number exceed the Mat U8C1 domain!, we need different data types. 
    // we need a bigger one.. let's say 32FC1 

    Mat imgA_32FC1 = imgA.clone();
    imgA_32FC1.convertTo(imgA_32FC1, CV_32FC1);
    Mat imgB_32FC1 = imgB.clone();
    imgB_32FC1.convertTo(imgB_32FC1, CV_32FC1);

    // after conversion.. value are scaled?
    cout << "imgA after conversion:" << endl << imgA_32FC1 << endl;
    cout << "imgB after conversion:" << endl << imgB_32FC1 << endl;

    product = imgA_32FC1.mul( imgB_32FC1 );
    // note: the product values are in the range 0-65025
    cout << "the product:" << endl << product << endl;

    // now, this does not have much sense, because we started from a 0-255 range Mat and now we have a 0-65025 that is nothing..
    // it is not uchar range and it is not float range (that is a lot bigger than that)
    // so, we can normalize back to 0-255
    // what do i mean with 'normalize' now?
    // i mean: scale all values for a constant that maps 0 to 0 and 65025 to 255..
    product.convertTo(product, CV_32FC1, 1.0f/65025.0f * 255);
    // but it is still a 32FC1.. not as the start matix..
    cout << "the product, normalized back to 0-255, still in 32FC1:" << endl << product << endl;
    product.convertTo(product, CV_8UC1);
    cout << "the product, normalized back to 0-255, now int 8UC1:" << endl << product << endl;

    cout << "-----------------------------------------------------------" << endl;

    // real stuffs now.
    imgA = imread("test1.jpg"); 
    cvtColor(imgA, imgA, CV_BGR2GRAY);

    imgB = imread("test2.jpg"); 
    cvtColor(imgB, imgB, CV_BGR2GRAY);

    imgA_32FC1 = imgA.clone();
    imgA_32FC1.convertTo(imgA_32FC1, CV_32FC1);
    imgB_32FC1 = imgB.clone();
    imgB_32FC1.convertTo(imgB_32FC1, CV_32FC1);

    product = imgA_32FC1.mul( imgB_32FC1 );
    printMinMax(product, "product");
    product.convertTo(product, CV_32FC1, 1.0f/65025.0f * 255);
    product.convertTo(product, CV_8UC1);

    // concat two images in one big image
    imgAB = Mat( max(imgA.rows,imgB.rows), imgA.cols+imgB.cols, imgA.type());
    imgA.copyTo(imgAB(Rect(0, 0, imgA.cols, imgA.rows)));
    imgB.copyTo(imgAB(Rect(imgA.cols, 0, imgB.cols, imgB.rows)));

    namedWindow("originals", CV_WINDOW_AUTOSIZE);
    namedWindow("product", CV_WINDOW_AUTOSIZE);

    while( true )
    {
        char c = (char)waitKey(10);

        if( c == 27 )
            { break; }

        imshow( "originals", imgAB );
        imshow( "product", product );
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:05:30.687

没错，您应该将矩阵 imgA、imgB 转换为 CV32FC1 类型。由于该矩阵中的最大值为 255，因此可能的最大值为 65025。但是，imgA 和 imgB 的最大值可能不在同一位置，因此很有可能为 64009。

# mysql - 选择两个值并更新

> ID：14175116
> 
> 赞同：-2
> 
> 时间：2013-01-05T18:48:47.967
> 
> 标签：mysql, sql

我想`SELECT id, some_complex_calculations FROM some_table`然后更新`some_table`以插入`some_complex_calculations`具有适当 ID 的其他列。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T18:51:50.117

尝试这个：

```
UPDATE some_table 
SET other_column = some_complex_calculations 
WHERE Id = 5; #appropiate ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:02:12.063

如果我理解您的要求，那么这就是您想要的，UPDATE 将替换现有行。但是你想插入行我猜，

```
INSERT INTO SOME_TABLE(YOUR_OTHER_COLUMN) 
VALUES(SELECT some_complex_calculations FROM some_table WHERE ID=4) #For Example 
```

# wms - 通过 WMS 对栅格进行分类

> ID：14175117
> 
> 赞同：1
> 
> 时间：2013-01-05T18:48:49.407
> 
> 标签：wms

我尝试使用 WMS 在 web 上以 geotiff 格式显示栅格地图。我想对光栅文件进行分类。我怎样才能做到这一点？我在 Windows 上使用地图服务器。以下是我的 .map 文件。我得到的是

```
MAP
NAME PM10
IMAGECOLOR 255 255 255
SIZE 600 800
IMAGETYPE PNG24 ## use AGG to for anti-aliassing
OUTPUTFORMAT
NAME 'AGG'
DRIVER AGG/PNG
MIMETYPE "image/png"
IMAGEMODE RGB
EXTENSION "png"
END # outputformat
PROJECTION
"init=epsg:3035" #latlon on etrs 1989 laea
 END
 EXTENT 3487500 2297500 4402500 3202500 # meters extents of region2
 WEB
 IMAGEPATH "c:/tmp/ms_tmp/"
 IMAGEURL "/ms_tmp/"
 METADATA
  "ows_enable_request"   "*"
  "map" "C:/ms4w/apps/airpollution/config.map"
  "ows_schemas_location" "http://schemas.opengeospatial.net"
  "ows_title" "Sample WMS"
  "ows_enable_request"   "*"
  "ows_onlineresource" "http://localhost:7070/cgi-bin/mapserv.exe?       map=C:/ms4w/apps/airpollution/config.map&"
  "ows_srs" "EPSG:3035 " #latlon      
  "wms_feature_info_mime_type" "text/plain"
  "wms_feature_info_mime_type" "text/html"
  "wms_server_version" "1.1.1"
  "wms_formatlist" "image/png,image/gif,image/jpeg, image/geotiff"
  "wms_format" "image/geotiff"
 END #metadata
 END #web
 LAYER
 NAME "pm10"
DATA "pm10.tif"
 TYPE RASTER
 STATUS ON
    METADATA
  "ows_title" "pollution"
 END #metadata
 PROJECTION
  "init=epsg:3035"
END #projection
CLASSITEM "[pixel]"
 # class using simple string comparison, equivelent to ([pixel] = 0)
 CLASS
 EXPRESSION "0"
 STYLE
  COLOR 20 20 20
 END
 END
# class using an EXPRESSION using only [pixel].
CLASS
EXPRESSION ([pixel] >= 0AND [pixel] < 7)
STYLE
  COLOR 255 0 0
END
CLASS
EXPRESSION ([pixel] >= 7AND [pixel] < 20)
STYLE
  COLOR 0 255 0
END
END
CLASS
EXPRESSION ([pixel] >= 7AND [pixel] < 50)
STYLE
  COLOR 0 0 255
END
END

END #layer pm10
END #map 
```

我得到的回应是这张图片![WMS的响应](../Images/13be51dae06220471e36a6035d9eb569.png)

它似乎只读取第 3 行

```
IMAGECOLOR 255 255 255 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:19:51.743

我不太了解地图服务器，但我知道您可以使用 SLD（样式化图层描述符）从 WMS 设置栅格样式，这只是一个 xml 文件，您可以根据 OGC 标准传入 WMS 请求。

换句话说：您可以在 XML 模式中指定分类。以下是一个简单的 SLD 示例，它将除白色像素之外的所有内容设置为黑色，白色像素的样式为不透明。

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
<StyledLayerDescriptor version="1.0.0" xmlns="http://www.opengis.net/sld" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd">
    <NamedLayer>
        <Name>undefined</Name>
        <UserStyle>
            <Name>rasterr</Name>
            <Title>Rasterr</Title>
            <Abstract>A simple raaster style</Abstract>
            <FeatureTypeStyle>
                <FeatureTypeName>Feature</FeatureTypeName>
                <Rule>
                    <RasterSymbolizer>
                        <Opacity>1.0</Opacity>
                        <ColorMap>
                            <ColorMapEntry color="#ffffff" quantity="0" opacity="0.0" />
                            <ColorMapEntry color="#000000" quantity="1" />
                            <ColorMapEntry color="#000000" quantity="2" />
                            <ColorMapEntry color="#000000" quantity="3" />
                            <ColorMapEntry color="#000000" quantity="4" />
                            <ColorMapEntry color="#000000" quantity="5" />
                            <ColorMapEntry color="#000000" quantity="6" />
                            <ColorMapEntry color="#000000" quantity="7" />
                            <ColorMapEntry color="#000000" quantity="8" />
                            <ColorMapEntry color="#000000" quantity="9" />
                            <ColorMapEntry color="#000000" quantity="10" />
                        </ColorMap>
                    </RasterSymbolizer>
                </Rule>
            </FeatureTypeStyle>
        </UserStyle>
    </NamedLayer>
</StyledLayerDescriptor> 
```

像这样传递 SLD：

```
http://demo.mapserver.org/cgi-bin/wms?SERVICE=wms&VERSION=1.1.1&REQUEST=GetMap&LAYERS=country_bounds&SLD=http://demo.mapserver.org/ogc-demos/map/sld/sld_line_simple.xml 
```

在这里阅读更多：

[http://mapserver.org/ogc/sld.html](http://mapserver.org/ogc/sld.html) - 这是用于地图服务器的，使用 RasterSymbolizer 和 ColorMap 进行分类。在该页面上还描述了颜色图的工作原理。

[http://www.opengeospatial.org/standards/sld](http://www.opengeospatial.org/standards/sld) [维基百科](http://en.wikipedia.org/wiki/Styled_Layer_Descriptor)

# magento - 如何使用 Facebook 登录？

> ID：14175120
> 
> 赞同：0
> 
> 时间：2013-01-05T18:49:17.567
> 
> 标签：magento

用 facebook 创建登录连接的最佳/最快方法是什么？

有没有一些很棒的免费扩展可以做到这一点？

我知道这是那些悬而未决的问题之一。只是寻找提示或扩展。然后我将阅读我的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:35:17.437

查看[Facebook Connect Magento Extension](http://inchoo.net/ecommerce/magento/facebook-connect-magento-extension/)（免费）或[Magestore 的 Facebook 登录](http://www.magentocommerce.com/magento-connect/facebook-login.html)（付费）

请参阅[如何在 magento 网站中进行 facebook 登录集成？](https://stackoverflow.com/questions/10136076/how-to-do-facebook-login-integration-in-magento-website)

# objective-c - 访问器方法中的 Objective-C 防御性复制

> ID：14175121
> 
> 赞同：4
> 
> 时间：2013-01-05T18:49:23.990
> 
> 标签：objective-c, defensive-programming, defensive-copy

来自 Java 背景，我在想办法在 Objective-C 中进行防御性编程时遇到了麻烦。
假设*SomeClass*是可变的并提供了一个*复制*方法，这是我用 Java 编写的一段典型代码：

```
public MyClass  
{ 
    private SomeClass customerList;
    ...
    public SomeClass getCustomerList() {
        return this.customerList.copy(); 
    }
    public void setCustomerList(SomeClass list) {
        this.customerList = list.copy();
    }
} 
```

我花了一些时间才弄清楚

```
@property (nonatomic, copy) SomeClass *customerList; 
```

在将 setter 的参数分配给 customerList 属性之前，会对其进行复制。让我困惑的是写一个合适的吸气剂。到目前为止，它看起来像这样：

```
(SomeClass *)customerList {  
    if(!_customerList) {  
        _customerList = [[SomeClass alloc] init];
    }
    return _customerList;
} 
```

它适用于所有内部方法调用，如 self.customerList = ...，但会将直接指针传递给任何造成安全漏洞的外部调用。我正在考虑提供一个不同的公共 getter 来返回一个副本，但想避免它，因为它需要一个非常规的名称。你会如何处理这种情况？
谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T18:55:01.617

`-customerList`您可以将实现覆盖为： `return [_customerList copy];`. 请注意，这通常不是其他人期望访问器工作的方式，因此请务必记录下来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T05:02:58.770

如果您想返回由属性及其 getter 支持的副本，使用此表单非常容易：

```
@interface MyClass : NSObject
- (SomeClass *)copyCustomerList;
@end

@interface MyClass ()
@property (nonatomic, copy) SomeClass * customerList; // hide what you can
@end

@implementation MyClass
- (SomeClass *)copyCustomerList { return self.customerList.copy; }
@end 
```

尽管您可以实现自己的 getter —— 正如 Carl 所提到的，这在 ObjC 中是非常规的。

您可以采取的另一种方法是为实际属性使用不同的名称：

```
@interface MyClass : NSObject
- (SomeClass *)customerList;
@end

@interface MyClass ()
@property (nonatomic, copy) SomeClass * privCustomerList;
@end

@implementation MyClass

- (SomeClass *)customerList
{
 // -autorelease if MRC
 return self.privCustomerList.copy;
}

@end 
```

# android - Android Webview href链接不起作用

> ID：14175126
> 
> 赞同：2
> 
> 时间：2013-01-05T18:49:43.253
> 
> 标签：android, webview, href

基本上，我有一个指向内部*“note.html”*文件的 Webview。

在这个用 HTML 编写的*note.html*文件中，我有一个网站`HREF`，但是当我在设备上单击它时，我收到一条错误消息：

```
"the webpage at file:///android/asset/www.blahblah.com might be temporarily down ...etc." 
```

我有点意识到我必须解析 URL 或类似的东西，并且非常感谢有关如何获取`HREF`链接以打开浏览器的正确 Web 链接的响应。

**变量：** private static final String tip_URL = "file:///android_asset/tip.html";

**onCreate:** WebView mywebview = (WebView) findViewById(R.id.webview); mywebview.loadUrl(tip_URL);

这在移动设备上运行良好，但是，在 tip.html 中有一个网站链接，当点击时我希望打开浏览器以访问该网站..它不是另一个本地页面..

# algorithm - 获取第 i 个前缀而不计算其他前缀

> ID：14175128
> 
> 赞同：2
> 
> 时间：2013-01-05T18:49:52.263
> 
> 标签：algorithm, math, permutation

我读了这篇[文章](https://stackoverflow.com/questions/7918806/finding-n-th-permutation-without-computing-others)，它与我遇到的问题非常接近，但无法概括它。我正在尝试通过使用多个 CPU 搜索所有路径来解决旅行销售人员问题。我需要的是一种将路径前缀编码为整数并将其分配给每个 CPU 的方法，以便它知道应该扫描哪些路径。例如，如果城市数量是 10，一个可能的 3 前缀（假设前缀长度是固定的并且已知）是 4-10-3（有 10*9*8 个前缀），因此接收它的 CPU 将搜索所有以 4-10-3 开头的路径。由于城市数量很大，我无法计算n！因此我不能使用上面的帖子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:36:43.373

排列为数字的标准表示使用[阶乘数字系统](http://en.wikipedia.org/wiki/Factorial_number_system)中表示的[Lehmer 代码](http://en.wikipedia.org/wiki/Lehmer_code)。这个想法是n个元素的每个排列都可以映射到n个数字的序列，其中第一个在0到（n - 1）的范围内，第二个在0到（n - 2）的范围内等。然后，这个数字序列可以表示为阶乘数字系统中的单个整数。

我相信应该可以调整这个技巧来处理排列的前缀而不是整个排列。假设您有 n 个元素，并且想要选择其中 k 个的排列。为此，首先计算部分排列的 Lehmer 码。您将得到一个由 k 个数字组成的序列，而不是得到一个由 n 个数字组成的序列。例如，给定`c a d`从 中提取的部分排列`a b c d e f g`，您的 Lehmer 代码将如下所示：

*   `c`是的第二个（零索引）元素`a b c d e f g`
*   `a`是第零个（零索引）元素`a b d e f g`
*   `d`是第一个（零索引）元素`b d e f g`

所以 Lehmer 代码将是`(2, 0, 1)`.

一旦你有了这个 Lehmer 代码，你就可以尝试将它编码为一个整数。为此，您可以使用修改后的阶乘数字系统编码。具体来说，您可以尝试执行以下操作。如果你有 n 个元素并且想要其中 k 个的排列，那么最后一个元素总共会有 (n - k + 1) 个可能的选择。倒数第二个元素总共有 (n - k + 2) 个可能的选择，倒数第三个元素有 (n - k + 3) 个可能的选择，等等。因此，您可以使用 Lehmer代码并执行以下操作：

1.  保持最后一位不变。
2.  将倒数第二个元素乘以 (n - k + 1)。
3.  将倒数第三个元素乘以 (n - k + 1)(n - k + 2) 4 ...
4.  将第一个元素乘以 (n - k + 1)(n - k + 2)...(n - 1)
5.  总结这些价值观。

这会为排列生成一个唯一的整数代码。

例如，我们的 Lehmer 码是`(2, 0, 1)`，n = 7 和 k = 3。因此，我们将计算

> 1 + 0 × (7 - 3 + 1) + 2 × (7 - 3 + 2)(7 - 3 + 3)
> 
> = 1 + 2 × (5 × 6)
> 
> = 5 + 2 × 30
> 
> = 61

要反转此过程，您可以获取整数并通过此过程向后运行它以恢复部分 Lehmer 代码。为此，首先取数字并除以 (n - k + 1)(n - k + 2)...(n - 1) 以取回 Lehmer 码的第一个数字。然后，将数字修改为 (n - k + 1)(n - k + 2)...(n - 1) 以去掉第一位。然后，将数字除以 (n - k + 1)(n - k + 2)...(n - 2) 得到 Lehmer 码的第二个数字，然后除以 (n - k + 1)( n - k + 2)...(n - 2) 去掉第二个数字。重复此操作，直到 Lehmer 代码的所有数字都被重建。

例如，给定前缀 61、n = 7 和 k = 3，我们将从 61 除以 7 × 6 = 30 开始。这样得到 2，余数为 1。因此 Lehmer 码的第一个数字是 2。 30，我们得到数字 1。接下来，我们除以 6。得到 0，余数为 1。因此第二个数字是 0。最后，我们读出剩余的数字，即 Lehmer 码的最后一个数字，1 . 我们已经恢复了我们的 Lehmer 代码`(2, 0, 1)`，从中我们可以很容易地重建排列。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:37:05.560

这里最简单的方法是映射前缀而不将其视为排列的一部分。不要把前缀映射到[0,10*9*8-1]，而是映射到[0,10*10*10-1]，所以前缀0,4,5会映射到数字45，前缀 4,1,9 将映射到数字 419（当然，假设总共有 10 个城市）。

# objective-c - 何时观察/不观察事件

> ID：14175132
> 
> 赞同：1
> 
> 时间：2013-01-05T18:49:59.640
> 
> 标签：objective-c, ios, events, notifications

我目前正在使用基于 UINavigationController 的流程：

```
Events +-> Event Input
       |
       +-> People -> People Input 
```

当集合更改时，Events 和 People 底层的模型会触发通知。我正在将观察者连接`viewWillAppear:animated:`到`viewWillDisappear`. 这一切看起来都很好，但我真正想要的是让观察者在我从事件转换到人员时被连接起来，并保持连接状态直到我转换回事件。这样，即使人员输入隐藏了人员，也会处理通知，以便我可以更新我的列表。

注意：*我没有使用 segues。*

连接观察者和解开它们的最佳位置在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T10:12:19.810

然后您可以将时间范围从 viewDidLoad 用于观察到 dealloc 用于不观察。然后，您可以在视图实际存在的唯一条件下更新您的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:48:51.477

我选择解决这个问题的方法是将当前控制器与 s 的`navigationController`集合进行比较`viewController`。如果它不包含在此集合中，那么我知道视图已弹出并且我可以不观察事件。我在`viewDidDisappear`.

# java - 无法实例化活动 ComponentInfo android

> ID：14175133
> 
> 赞同：0
> 
> 时间：2013-01-05T18:50:08.723
> 
> 标签：java, android, cordova

01-05 18:35:42.754：E/AndroidRuntime(5814)：java.lang.RuntimeException：无法实例化活动 ComponentInfo{src.mynewfolder/mynewfolder.java}：java.lang.ClassNotFoundException：加载程序 dalvik 中的 mynewfolder.mynewproj。 system.PathClassLoader[/data/app/src.mynewfolder-1.apk]

我知道这部分看起来很奇怪：

```
{src.mynewfolder/mynewfolder.java} 
```

但是android清单文件xml中的那部分：package =“src.mynewfolder” - 我必须放一个“。” （点）某处或它说

“应用程序包 'AndroidManifest.xml' 必须至少有 2 个段。”

“mynewfolder 在 src 中，mynewproj.java 在 mynewfolder 中。

尝试设置这个 android phonegap 环境真是太可怕***了***。为什么这么难？我的每一步都有障碍。

任何帮助，将不胜感激。

编辑：

从这个网站： [https ://groups.google.com/forum/?fromgroups=#!topic/android-developers/tXX3eFCzpvM](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/tXX3eFCzpvM)

是说包的名称是由一个点分隔的两部分，所以当我再次创建目录时，我将包命名为 thispackage.p，所做的只是在“thispackage”中创建一个名为“p”的新文件夹.

现在当我运行应用程序时，例外是：

01-05 19:04:06.944：E/AndroidRuntime(7019)：java.lang.RuntimeException：无法实例化活动 ComponentInfo{thispackage.p/thisproj.java}：java.lang.ClassNotFoundException：加载程序 dalvik 中的 thisproj.java。 system.PathClassLoader[/data/app/thispackage.p-2.apk]

我决定忘掉Phonegap，改用钛金属。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:04:25.437

你得到一个`ClassNotFoundException`.
如果您正在使用一些外部库，请确保将它们添加到 Build Path。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:16:35.867

看起来您引用了一个名为“thisproj.java”的类，它在 java 中是无效的命名约定，并会导致引发此错误...

在 java 中，所有类都必须以大写字母开头，并且包含它的文件必须具有相同的名称，扩展名为 .java。

例如：

```
public class ThisProj { ... } 
```

应该在名为**ThisProj.java的文件中定义**

当您提到该类时，您必须确保使用该类的确切名称：

```
// Instantiate a ThisProj object
ThisProj thisProj = new ThisProj();

// static reference
ThisProj.someMethod(); 
```

# mysql - 在 phpmyadmin php.ini 和 mysql.cnf 中上传巨大的 csv 文件的问题检出

> ID：14175137
> 
> 赞同：0
> 
> 时间：2013-01-05T18:50:44.103
> 
> 标签：mysql, csv, phpmyadmin

我想为我的这个问题寻求一些帮助。

我正在使用 phpmyadmin，我需要上传巨​​大的 CSV 文件（或多或少 40 MB）；我在使用 phpmyadmin 时遇到了很多问题，但我已经解决了很多问题，顺序如下：

> 我在 php.ini 中更改了上传大小值 我在 mysql.cnf 中更改了数据包大小 我检查了超时变量，即 28,800 秒（默认） 我的电脑上不存在 htaccess（我在本地使用 phpmyadmin主持人）

现在，在放置了巨大的尺寸（200 M）之后，我设法上传了多达 20 MB 的 csv 文件，但是当我尝试上传 42 MB 的文件时，导入开始并且在 60 秒或更短的时间内屏幕变为空白，我可以看到左侧的选项和当前浏览 phpmyadmin 但文件未上传。

不显示错误

谁能给我一些帮助？此外，php.ini 中的显示错误开关为 ON（默认情况下）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:05:36.110

您还应该`max_input_time`在 php.ini 中设置

php.ini 中的重要设置是：

`upload_max_filesize` `post_max_size` `max_execution_time` `max_input_time`

# objective-c - UIPopoverController 的 UIView：如何去除阴影？

> ID：14175147
> 
> 赞同：1
> 
> 时间：2013-01-05T18:51:43.707
> 
> 标签：objective-c, uiview, ios6, xcode4.3, uipopovercontroller

以下是我的弹出窗口的快照：

![在此处输入图像描述](../Images/68bd6917de1e76b728bce925306e195f.png)

我有一个`UIViewController`（比如 A），我想显示为`popoverController`. 另外我想自定义弹出框，所以我正在自定义`UIPopoverBackgroundView`（比如'b' - 橙色背景）。一切正常，除了在将 A.view 和 'b' 的角变圆后，我有一条矩形阴影线（从快照中它可能属于 A.view - 绿色背景）。基于`UIView`或`UIViewController`API，有什么方法可以消除该阴影。我只对删除视图左侧、顶部和右侧的黑线而不是模糊的阴影感兴趣。

我确实尝试过：

```
[A.view.layer setShadowOpacity:0.0]; 
```

但没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:27:14.380

在您的 UIPopoverBackgroundView 子类中，覆盖类方法：

```
+ (BOOL)wantsDefaultContentAppearance 
```

要返回`NO`。这可以防止绘制内部阴影，如此[处](http://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverBackgroundView_class/Reference/Reference.html#//apple_ref/occ/clm/UIPopoverBackgroundView/wantsDefaultContentAppearance)所述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-01T21:23:08.647

删除 layoutSubviews 方法中对 [super layoutSubviews] 的调用。

覆盖 wantDefaultContentAppearance 并返回 NO 对我不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T21:10:13.487

您无法`UIPopoverController`直接控制 a 的阴影。您的选择是：

1.  滚动你自己的弹出窗口。
2.  子类`UIPopoverBackgroundView`化并为弹出框的框架提供您自己的图形。与官方文档相反，当您子类化时，阴影不会为您绘制`UIPopoverBackgroundView`。这是一篇关于如何做到这一点的好帖子：http: [//blog.andrewkolesnikov.com/custom-background-color-tint-for-uipopover-64835](http://blog.andrewkolesnikov.com/custom-background-color-tint-for-uipopover-64835)

# forms - 选择表单类型仅发布第一个选项

> ID：14175150
> 
> 赞同：0
> 
> 时间：2013-01-05T18:52:00.663
> 
> 标签：forms, symfony

Symfony 版本：`Symfony 2.1.7-DEV.`

我有一个带有选择字段的表单，现在如果我选择多个选项，他只会发布第一个选项。

我有这样的表单类型：

```
 $builder->add( 'weeks', 'entity', array(
        'class' => 'VM\NameBundle\Entity\CaravanRow',
        'property' => 'line',
        'query_builder' => function(EntityRepository $er ) use ( $caravan ) {
            return $er->createQueryBuilder('w')
                      ->orderBy('w.dateFrom', 'ASC')
                      ->where('w.caravan = :caravan' )
                      ->andWhere('w.visible = 1')
                      ->setParameter( 'caravan', $caravan );
        },
        'attr' => array(
            'multiple' => true,
            'size'     => 5,
            'style'    => 'width: 415px;'
        )
    )); 
```

现在在网站上的选择表单中看起来像这样：

```
<select id="reservation_weeks" style="width: 415px;" size="5" multiple="1" required="required" name="reservation[weeks]">
    <option value="1">20 - 11-05 t/m 18-05 (2013)</option>
    <option value="2">21 - 18-05 t/m 25-05 (2013)</option>
    <option value="3">22 - 25-05 t/m 01-06 (2013)</option>
    <option value="4">23 - 01-06 t/m 08-06 (2013)</option>
    <option value="5">24 - 08-06 t/m 15-06 (2013)</option>
</select> 
```

`reservation[weeks]`不应该吗`reservation[weeks][]`？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:22:14.927

您必须添加选项 multiple 但不在 attr 数组中

```
$builder->add( 'weeks', 'entity', array(
    'class' => 'VM\NameBundle\Entity\CaravanRow',
    'property' => 'line',
     ....
    'multiple' => true 
```

# macos - 如何告诉自制软件从某个 url 获取包？

> ID：14175152
> 
> 赞同：0
> 
> 时间：2013-01-05T18:52:11.103
> 
> 标签：macos, homebrew

我正在安装`gfortran`via `brew`，它试图获取`mpfr`从[http://www.mpfr.org/mpfr-3.1.1/mpfr-3.1.1.tar.bz2](http://www.mpfr.org/mpfr-3.1.1/mpfr-3.1.1.tar.bz2)调用的依赖项。但是，链接似乎已失效。`brew`说`Recv failure`，我的浏览器也打不开。

然后我找到了另一个 url 来获取它：[http://ftp.gnu.org/gnu/mpfr/mpfr-3.1.1.tar.bz2](http://ftp.gnu.org/gnu/mpfr/mpfr-3.1.1.tar.bz2)，我认为它们是一样的。如何告诉`brew`从后一个 url 中获取它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:18:38.527

哦，我发现这很容易：

1.  运行`brew edit mpfr`。
2.  替换网址。
3.  注释掉`def patches`块。

然后再试`brew install mpfr`一次，它工作正常。

# android - 如何使我的 ListView 项目可点击？

> ID：14175153
> 
> 赞同：3
> 
> 时间：2013-01-05T18:52:10.580
> 
> 标签：android, listview

我对android非常陌生。我正在制作一个列表视图，每次单击列表项时，它都应该打开一个新活动。在这种情况下，设置活动。我尝试了很多方法，但都没有奏效。任何形式的帮助将不胜感激。这是我的代码：

```
package com.alex.mylist;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ListView;

public class Settings extends ListActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);

        ListView lstSettings = (ListView) findViewById(R.id.lstSettings);
        lstSettings.getChildAt(1).setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent mainIntent = new Intent(v.getContext(), Register.class);
                startActivity(mainIntent);
            }
        });
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T18:55:11.747

使用[listView.setOnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.html) 使 listview 项目可点击

```
lstSettings.setOnItemClickListener(new ListView.OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> a, View v, int i, long l) {

        Intent mainIntent = new Intent(Settings.this,
                                             Register.class);
        startActivity(mainIntent);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T18:54:03.660

为您的列表视图设置 ItemSelectedListener 或 ItemClickListener。

```
listView.setOnItemSelectedListener(new ListView.OnItemSelectedListener() {

   @Override
   public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
        // call Activity
    }

    @Override
    public void onNothingSelected(AdapterView<?> parent) {
        // TODO Auto-generated method stub
    }

});

listView.setOnItemClickListener(new ListView.OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        // call activity
    }

}); 
```

# javascript - 更改在 HTML5 画布元素上绘制的图像的颜色

> ID：14175156
> 
> 赞同：3
> 
> 时间：2013-01-05T18:52:23.437
> 
> 标签：javascript, html, html5-canvas, grayscale

我在这里有这张图片：![在此处输入图像描述](../Images/5c080d6c654ede064963f21a1da40c28.png)

如何将其整个颜色更改为用户定义的 rgb 值？

换句话说，给定一个灰度图像，我如何将它切换回颜色，颜色是任何 rgb 值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T06:34:27.287

感谢@Rikonator 的评论，解决方案如下：

```
function changeColor(img, r, g, b) {
    var c = document.createElement('canvas');
    c.width = img.width;
    c.height = img.height;
    var ctx = c.getContext('2d');
    ctx.drawImage(img, 0, 0);
    var imgData=ctx.getImageData(0, 0, c.width, c.height);
    for (var i=0;i<imgData.data.length;i+=4)
    {
        imgData.data[i]= r | imgData.data[i];
        imgData.data[i+1]= g | imgData.data[i+1];
        imgData.data[i+2]= b | imgData.data[i+2];
    }
    ctx.putImageData(imgData,0,0);
    return c;
}, 
```

# iphone - 在 iPhone 应用程序中复制电子邮件

> ID：14175157
> 
> 赞同：-3
> 
> 时间：2013-01-05T18:52:29.133
> 
> 标签：iphone, ios, ios5, ios6

我可以在我的应用程序中从我的 iPhone 设备电子邮件应用程序复制/打开电子邮件吗？

谢谢， 苏尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:02:29.717

没有。第 3 方应用程序无法访问用户的电子邮件或电子邮件帐户信息。

# python - 请解释一下这个类，子类，异常代码

> ID：14175159
> 
> 赞同：-1
> 
> 时间：2013-01-05T18:52:57.567
> 
> 标签：python

```
class AndTrigger(Trigger):
    def __init__(self,object1,object2):
        self.object1 = object1
        self.object2 = object2
    def evaluate(self,object):
        return self.object1.evaluate(self) and self.object2.evaluate(self) 
```

我实现了这个 AND 触发器，它按预期工作，但我只能通过反复试验才能使其工作——我不知道“自我”在这门课上做什么。

这是我认为正在发生的事情： the`__init__`是类的构造函数，因此该类的任何实例在创建时都会使用它。该类有两个属性（object1，object2），`__init__`创建类时告诉新实例这些新属性将被称为“object1”和“object2”，因此它们被分配给 self.object1 等。

现在，这个评估函数应该防止触发器中未实现的加注，但这不是我没有得到的。在这个评估函数中，它看起来有两个参数——AndTrigger 的实例和另一个对象。但是 的定义中的另一个对象在`evaluate()`哪里？这对我来说只是一个谜，它是如何工作的，但它确实如此！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T18:58:14.437

当您调用绑定的成员函数时，`self`会自动提供第一个参数 ( )。它指的是调用函数的对象。

为了便于说明，我们假设`self.object1`和`self.object2`都是 type `TriggerX`。以下：

```
def evaluate(self, obj):
    return self.object1.evaluate(self) and self.object2.evaluate(self) 
```

那么等价于：

```
def evaluate(self, obj):
    return TriggerX.evaluate(self.object1, self) and TriggerX.evaluate(self.object2, self) 
```

我希望这能解决问题。

PS我从上下文中怀疑以下内容：

```
def evaluate(self, obj):
    return self.object1.evaluate(self) and self.object2.evaluate(self) 
```

应该

```
def evaluate(self, obj):
    return self.object1.evaluate(obj) and self.object2.evaluate(obj) 
```

PPS 请不要`object`用作变量名，因为这会影响内置类。

# android - Android 地图已完全加载

> ID：14175170
> 
> 赞同：1
> 
> 时间：2013-01-05T18:54:08.283
> 
> 标签：android, android-mapview

我有一个要求，我需要拍摄 mapview 的图像并将其用于在 pdf 中显示。我可以拍摄图像并以 pdf 格式显示，但唯一的问题是当我拍摄 MapView 的快照时，有时地图没有完全填充。

是否有任何事件可以通知我地图是否已完全加载或以任何其他方式知道地图是否已加载到 android 应用程序中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T13:56:26.040

因此，经过太多天的发现，我最终得出的结论是，没有 100% 保证的方法可以找到它。目前的方法很少，其中之一是：

```
canCoverCenter
public boolean canCoverCenter()
Checks whether we currently have a map tile to cover the center of the map. 

Returns:
True if there is a tile for the center, false otherwise. 
```

* * *

但它只通知中心瓷砖而不是所有瓷砖。:(

# delphi - Delphi - 带边界的 Pos()

> ID：14175173
> 
> 赞同：0
> 
> 时间：2013-01-05T18:54:21.423
> 
> 标签：delphi, assembly

我希望有一个 Pos() 适合用于指定 Source 字符串中的边界，而不是让它在整个数据中执行搜索。Fe: NewPos(SubStr, SourceString, Offset, EndingOffset)

它应该是对最新 Delphi XE3 中当前 ASM FastCode 实现的修改，因此它将比 PurePascal 实现更快（显然也比使用简单的 Pos 或 PosEx 更快）。此外，它应该适用于 Unicode 字符串。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-05T18:56:07.350

[`PosEx`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.StrUtils.PosEx)在单位里看看`StrUtils`。这看起来像你正在寻找的......

# php - 创建解锁/锁定页面功能

> ID：14175174
> 
> 赞同：1
> 
> 时间：2013-01-05T18:54:33.373
> 
> 标签：php, html

我正在尝试创建类似锁定和解锁页面功能的东西。用户必须按以下顺序浏览页面：

```
$steps = array(1 =>'create_session.php',2 => 'QandATable.php',3 => 'individualmarks.php',4 => 'penalty.php',5 => 'penaltymarks',6 => 'complete.php'); 
```

所以应该发生的是，如果用户在一个他们应该在的页面上，那么该页面应该被解锁（或者换句话说，如果用户访问一个页面它们不应该打开，然后该页面被锁定（在显示带有`Continue`超链接的 div 的地方会遇到 else 语句）。

问题是即使用户在正确的页面上，当它应该被解锁时页面仍然被“锁定”，以便用户可以使用该页面。目前所有访问的页面都被锁定，所以我的问题是当用户在正确的页面上时如何解锁页面？

下面是一个示例 create_session.php：

```
 <?php
session_start();
include ('steps.php'); //exteranlised steps.php
?>
<head>
...

</head>
<body>

<?php
if ((isset($username)) && (isset($userid))) { //checks if user is logged in
    if (allowed_in() === "Allowed") {
        //create_session.php code:
    } else {
        $page = allowed_in() + 1;
?>
 <div class="boxed">
<a href="<?php echo $steps[$page] ?>">Continue with Current Assessment</a>
<?php
    }

} else {
    echo "Please Login to Access this Page | <a href='./teacherlogin.php'>Login</a>";
    //show above echo if user is not logged in
}
?> 
```

以下是完整的steps.php：

```
<?php

$steps = array(1 =>'create_session.php',2 => 'QandATable.php',3 => 'individualmarks.php',4 => 'penalty.php',5 => 'penaltymarks',6 => 'complete.php');

function allowed_in($steps = array()){
// Track $latestStep in either a session variable
// $currentStep will be dependent upon the page you're on

if(isset($_SESSION['latestStep'])){
   $latestStep = $_SESSION['latestStep'];
}
else{
   $latestStep = 0;
}
$currentStep = basename(__FILE__); 

$currentIdx = array_search($currentStep, $steps);
$latestIdx = array_search($latestStep, $steps);

if ($currentIdx - $latestIdx == 1 )
    {
       $currentIdx = $_SESSION['latestStep'];
       return 'Allowed';
    }
    return $latestIdx;
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:00:28.860

像这样的东西，虽然这可能不会按原样工作：

```
$allowed_page = $_SESSION['latestStep'];
if ($steps[$allowed_page] == $_SERVER['SCRIPT_NAME']) {
   ... allowed to be here ...
} 
```

基本上，给定您的“步骤”数组，您可以将允许页面的索引存储在会话中。当他们完成一个页面并“解锁”下一页时，您在会话中增加该索引值并重定向到序列中的下一页。

```
if ($page_is_done) {
    $_SESSION['latestStep']++;
    header("Location: " . $steps[$_SESSION['latestStep']]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:08:13.170

保持简单，似乎你把目标复杂化了。似乎您只是想确保用户完成流程的先前步骤，然后才能继续下一步。为什么不尝试更多类似...

```
// General Idea
$completedArr = array('1' => false, '2' => false ...);
$pageMap = array('page1.php' => '1', 'page2.php' => '2' ...);

// On Page1
$completedArr = $_SESSION['completedArr'];
$locked = true;
$currentStep = $pageMap[$_SERVER['SCRIPT_NAME']];  // '1'
if($currentStep > 1)
{
    if($completedArr[$currentStep - 1] === true)
        $locked = false;
}
else
{
    $locked = false;
}

$completedArr[$currentStep] = true;
$_SESSION['completedArr'] = $completedArr; 
```

也可以根据需要将其用于连续页面。这个想法是您将定义的 pageMap 为脚本名称提供索引号。然后，您只需在“解锁”此页面之前检查上一个索引是否已标记为已完成。

# algorithm - 如何遍历二进制抽象语法树以生成带有最少正确括号的中缀符号

> ID：14175177
> 
> 赞同：6
> 
> 时间：2013-01-05T18:54:42.743
> 
> 标签：algorithm, binary-tree

我正在传递一个表示数学公式的二进制 AST。每个内部节点是一个运算符，叶节点是操作数。我需要遍历树并以中缀表示法输出公式。这很容易通过使用递归算法遍历树来完成，`Print()`如下所示。该`Print()`方法的问题是在转换为中缀时会丢失操作顺序，因为没有生成括号。

我编写了`PrintWithParens()`输出正确中缀公式的方法，但是它添加了多余的括号。您可以在我的 main 方法的四种情况中的三种中看到，它在不需要括号时添加了括号。

我一直在绞尽脑汁试图找出正确的算法`PrintWithMinimalParens()`应该是什么。我确信必须有一种算法可以在需要对术语进行分组时只输出括号，但是我一直无法正确实现它。我想我必须需要查看当前节点下方树中运算符的优先级，但是我现在拥有的算法不起作用（请参阅我的 main 方法中的最后 2 个案例。不需要括号，但是我的逻辑添加它们）。

```
public class Test {

static abstract class Node {

    Node left;
    Node right;
    String text;

    abstract void Print();
    abstract void PrintWithParens();
    abstract void PrintWithMinimalParens();

    int precedence()
    {
        return 0;
    }
}

enum Operator { 
    PLUS(1,"+"), 
    MINUS(1, "-"), 
    MULTIPLY(2, "*"), 
    DIVIDE(2, "/"), 
    POW(3, "^") 
    ;

    private final int precedence;
    private final String text;

    private Operator(int precedence, String text)
    {
        this.precedence = precedence;
        this.text = text;
    }

    @Override
    public String toString() {
        return text;
    }

    public int getPrecedence() {
        return precedence;
    }
}

static class OperatorNode extends Node {

    private final Operator op;

    OperatorNode(Operator op)
    {
        this.op = op;
    }

    @Override
    void Print() {
        left.Print();
        System.out.print(op);
        right.Print();
    }

    @Override
    void PrintWithParens() {
        System.out.print("(");
        left.PrintWithParens();
        System.out.print(op);
        right.PrintWithParens();
        System.out.print(")");
    }

    @Override
    void PrintWithMinimalParens() {

        boolean needParens = 
                (left.precedence() != 0 && left.precedence() < this.op.precedence) 
                || 
                (right.precedence() != 0 && right.precedence() < this.op.precedence);

        if(needParens)
            System.out.print("(");

        left.PrintWithMinimalParens();
        System.out.print(op);
        right.PrintWithMinimalParens();

        if(needParens)
            System.out.print(")");

    }

    @Override
    int precedence() {
        return op.getPrecedence();
    }

}

static class TextNode extends Node {

    TextNode(String text)
    {
        this.text = text;
    }

    @Override
    void Print() {
        System.out.print(text);
    }

    @Override
    void PrintWithParens() {
        System.out.print(text);
    }

    @Override
    void PrintWithMinimalParens() {
        System.out.print(text);
    }

}

private static void printExpressions(Node rootNode) {

    System.out.print("Print() : ");
    rootNode.Print();
    System.out.println();
    System.out.print("PrintWithParens() : ");
    rootNode.PrintWithParens();
    System.out.println();
    System.out.print("PrintWithMinimalParens() : ");
    rootNode.PrintWithMinimalParens();
    System.out.println();
    System.out.println();

}

public static void main(String[] args) 
{
    System.out.println("Desired:  1+2+3+4");
    Node rootNode = new OperatorNode(Operator.PLUS);
    rootNode.left = new TextNode("1");
    rootNode.right = new OperatorNode(Operator.PLUS);
    rootNode.right.left = new TextNode("2");
    rootNode.right.right = new OperatorNode(Operator.PLUS);
    rootNode.right.right.left = new TextNode("3");
    rootNode.right.right.right = new TextNode("4");

    printExpressions(rootNode);

    System.out.println("Desired: 1+2*3+4");
    rootNode = new OperatorNode(Operator.PLUS);
    rootNode.left = new TextNode("1");
    rootNode.right = new OperatorNode(Operator.PLUS);
    rootNode.right.left = new OperatorNode(Operator.MULTIPLY);
    rootNode.right.left.left = new TextNode("2");
    rootNode.right.left.right = new TextNode("3");
    rootNode.right.right = new TextNode("4");

    printExpressions(rootNode);

    System.out.println("Desired: 1+2*(3+4)");
    rootNode = new OperatorNode(Operator.PLUS);
    rootNode.left = new TextNode("1");
    rootNode.right = new OperatorNode(Operator.MULTIPLY);
    rootNode.right.left = new TextNode("2");
    rootNode.right.right = new OperatorNode(Operator.PLUS);
    rootNode.right.right.left = new TextNode("3");
    rootNode.right.right.right = new TextNode("4");

    printExpressions(rootNode);

    System.out.println("Desired: 1+2^8*3+4");
    rootNode = new OperatorNode(Operator.PLUS);
    rootNode.left = new TextNode("1");
    rootNode.right = new OperatorNode(Operator.MULTIPLY);
    rootNode.right.left = new OperatorNode(Operator.POW);
    rootNode.right.left.left = new TextNode("2");
    rootNode.right.left.right = new TextNode("8");
    rootNode.right.right = new OperatorNode(Operator.PLUS);
    rootNode.right.right.left = new TextNode("3");
    rootNode.right.right.right = new TextNode("4");

    printExpressions(rootNode);
    }
} 
```

输出：

```
Desired:  1+2+3+4
Print() : 1+2+3+4
PrintWithParens() : (1+(2+(3+4)))
PrintWithMinimalParens() : 1+2+3+4

Desired: 1+2*3+4
Print() : 1+2*3+4
PrintWithParens() : (1+((2*3)+4))
PrintWithMinimalParens() : 1+2*3+4

Desired: 1+2*(3+4)
Print() : 1+2*3+4
PrintWithParens() : (1+(2*(3+4)))
PrintWithMinimalParens() : 1+(2*3+4)

Desired: 1+2^8*3+4
Print() : 1+2^8*3+4
PrintWithParens() : (1+((2^8)*(3+4)))
PrintWithMinimalParens() : 1+(2^8*3+4) 
```

**有可能实现`PrintWithMinimalParens()`我想要的吗？顺序是隐含在树中的事实是否使我想做的事情变得不可能？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T16:56:21.867

在您的代码中，您将每个运算符与其子项进行比较，以查看是否需要在其周围加上括号。但是您实际上应该将其与其父级进行比较。以下是一些可以确定是否可以省略括号的规则：

1.  您永远不需要在 AST 根的运算符周围使用括号。
2.  如果运算符 A 是运算符 B 的子级，并且 A 的优先级高于 B，则可以省略 A 周围的括号。
3.  如果左结合运算符 A 是具有相同优先级的左结合运算符 B 的左孩子，则可以省略 A 周围的括号。左结合运算符是一个`x A y A z`被解析为的运算符`(x A y) A z`。
4.  如果右结合运算符 A 是具有相同优先级的右结合运算符 B 的右孩子，则可以省略 A 周围的括号。右关联运算符是一种`x A y A z`被解析为的运算符`x A (y A z)`。
5.  如果您可以假设运算符 A 是[关联](http://en.wikipedia.org/wiki/Associative_property)的，即`(x A y) A z = x A (y A z)`对于所有 x,y,z，并且 A 是同一个运算符 A 的子，您可以选择省略子 A 周围的括号。在这种情况下，重新解析表达式将产生一个不同的 AST，在评估时给出相同的结果。

`+`请注意，对于您的第一个示例，仅当您可以假设它是关联的（在处理正常数字时是正确的）并实施规则 #5 时，所需的结果才是正确的。这是因为您的输入树是以右关联方式构建的，而运算符`+`通常是左关联的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T16:49:39.567

**如果左子或**右子具有较低优先级的运算符，即使其中一个是较高或相等优先级的运算符，则您将整个表达式括在括号中。

我认为你需要将你的布尔值 needParens 分成左右孩子的不同案例。像这样的东西（未经测试）：

```
void PrintWithMinimalParens() {

    boolean needLeftChildParens = 
            (left.precedence() != 0 && left.precedence() < this.op.precedence);
    boolean needRightChildParens = 
            (right.precedence() != 0 && right.precedence() < this.op.precedence);

    if(needLeftChildParens)
        System.out.print("(");
    left.PrintWithMinimalParens();
    if(needLeftChildParens)
        System.out.print(")");

    System.out.print(op);

    if(needRightChildParens)
        System.out.print("(");
    right.PrintWithMinimalParens();
    if(needRightChildParens)
        System.out.print(")");

} 
```

另外，我认为您的最后一个示例不正确。看着你的树，我认为它应该是：

```
1+2^8*(3+4) 
```

# javascript - Highstock：将系列添加到烛台图表

> ID：14175187
> 
> 赞同：3
> 
> 时间：2013-01-05T18:55:26.520
> 
> 标签：javascript, ajax, jquery, highcharts, highstock

我在将数据系列添加到烛台图表（Highstock -> Highcharts）时遇到问题。

脚本：

```
$.ajax({
            url : 'indicator',
            type : 'GET',
            data : {
                currency : $("#selectionField3").val(),
                period : $("#selectionField2 option:selected").val(),
                indicator : 'cos'
            },
            success : function(data) {
                console.log('data2');
                console.log(chart);
                console.log(data);
                chart.addSeries([ {
                    type : 'line',
                    name : 'wskaznik',
                    data : data
                } ], true, true);

                chart.redraw();
                console.log(chart);
            },
            error : function(data) {
                console.log(data);
            } 
```

我尝试了另一种方式，但它仍然不起作用。

```
function setButtonIndicator() {
    $('.checkboxButton').click(function() {
        var name = $(this).attr("name");
        $.ajax({
            url : 'indicator',
            type : 'GET',
            data : {
                currency : $("#selectionField3").val(),
                period : $("#selectionField2 option:selected").val(),
                indicator : 'cos'
            },
            success : function(data) {
                console.log('data2');
                console.log(chart);
                console.log(data);
                chart.addSeries({
                    type : 'line',
                    name : 'wskaznik',
                    data : data
                }, true, true);

                chart.redraw();
                console.log(chart);
            },
            error : function(data) {
                alert(data);
                console.log(data);
            }

        });

        if (indicators[name]) {
            $(this).css({
                'opacity' : '0.5'
            });
        } else {
            $(this).css({
                'opacity' : '1'
            });
        }
        indicators[name] = !indicators[name];

    });
} 
```

数据如下所示：

```
[
[1357084080000,1.03909],
[1357084140000,1.0391],
[1357084200000,1.03912],
[1357084260000,1.03913],
[1357084320000,1.03917],
[1357084380000,1.03921],
[1357084440000,1.03925],
[1357084500000,1.0393],
[1357084620000,1.03935],
[1357084680000,1.0394],
[1357084740000,1.03945],
[1357084800000,1.0395],
[1357084860000,1.03955],
[1357084920000,1.03959],
[1357084980000,1.03963],
[1357085040000,1.03966],
[1357085100000,1.03968],
[1357085160000,1.03969],
[1357085220000,1.03969],
[1357085280000,1.03967],
[1357085340000,1.03965],
[1357085400000,1.03963],
[1357085460000,1.03961],
[1357085520000,1.03959],
[1357085580000,1.03959],
[1357085640000,1.03958],
[1357085700000,1.03958],
[1357085760000,1.03957],
[1357085820000,1.03956],
[1357085880000,1.03955],
[1357085940000,1.03954],
[1357086000000,1.03953],
[1357086060000,1.03952],
[1357086120000,1.03952],
[1357086180000,1.03953],
[1357086240000,1.03952],
[1357086300000,1.03952],
[1357086360000,1.03951],
[1357086420000,1.03948],
[1357086480000,1.03946],
[1357086540000,1.03943],
[1357086600000,1.0394],
[1357086660000,1.03936],
[1357086720000,1.03937],
[1357086780000,1.03938],
[1357086840000,1.03941],
[1357086900000,1.03947],
[1357086960000,1.03954],
[1357087020000,1.03966],
[1357087080000,1.03978],
[1357087140000,1.03994],
[1357087200000,1.04008],
[1357087260000,1.04024],
[1357087320000,1.04039],
[1357087380000,1.04053],
[1357087440000,1.04066],
[1357087500000,1.04081],
[1357087560000,1.0409],
[1357087620000,1.04102],
[1357087680000,1.0411],
[1357087740000,1.04116],
[1357087800000,1.04122],
[1357087860000,1.04125],
[1357087920000,1.0413],
[1357087980000,1.04132],
[1357088040000,1.0414],
[1357088100000,1.04148],
[1357088160000,1.04154],
[1357088220000,1.04162],
[1357088280000,1.04171],
[1357088340000,1.04178],
[1357088400000,1.04187],
[1357088460000,1.04194],
[1357088520000,1.04203],
[1357088580000,1.04213],
[1357088640000,1.04222],
[1357088700000,1.0423],
[1357088760000,1.04237],
[1357088820000,1.04242],
[1357088880000,1.04243],
[1357088940000,1.04244],
[1357089000000,1.04247],
[1357089060000,1.0425],
[1357089120000,1.04255],
[1357089180000,1.04262],
[1357089240000,1.04267],
[1357089300000,1.04272],
[1357089360000,1.04275],
[1357089420000,1.04279],
[1357089480000,1.04283],
[1357089540000,1.04285],
[1357089600000,1.04289],
[1357089660000,1.04294],
[1357089720000,1.04299],
[1357089780000,1.04305],
[1357089840000,1.04309],
[1357089900000,1.04313],
[1357089960000,1.04318],
[1357090020000,1.0432],
[1357090080000,1.04324],
[1357090140000,1.04329],
[1357090200000,1.04333],
[1357090260000,1.04337],
[1357090320000,1.04343],
[1357090380000,1.04352],
[1357090440000,1.04363],
[1357090500000,1.0438],
[1357090560000,1.04396],
[1357090620000,1.04411],
[1357090680000,1.04428],
[1357090740000,1.04446],
[1357090800000,1.04461],
[1357090860000,1.04476],
[1357090920000,1.04488],
[1357090980000,1.04499],
[1357091040000,1.0451],
[1357091100000,1.04521],
[1357091160000,1.04531],
[1357091220000,1.04542],
[1357091280000,1.04552],
[1357091340000,1.04553],
[1357091400000,1.04556],
[1357091460000,1.04559],
[1357091520000,1.04562],
[1357091580000,1.04563],
[1357091640000,1.04567],
[1357091700000,1.04574],
[1357091760000,1.04585],
[1357091820000,1.04594],
[1357091880000,1.04604],
[1357091940000,1.04612],
[1357092000000,1.04619],
[1357092060000,1.04621],
[1357092120000,1.04626],
[1357092180000,1.04633],
[1357092240000,1.04641],
[1357092300000,1.04648],
[1357092360000,1.04651],
[1357092420000,1.04653],
[1357092480000,1.04656],
[1357092540000,1.04657],
[1357092600000,1.04658],
[1357092660000,1.0466],
[1357092720000,1.04664],
[1357092780000,1.04669],
[1357092840000,1.04673],
[1357092900000,1.04676],
[1357092960000,1.04678],
[1357093020000,1.0468],
[1357093080000,1.0468],
[1357093140000,1.04682],
[1357093200000,1.04686],
[1357093260000,1.04691],
[1357093320000,1.04697],
[1357093380000,1.04701],
[1357093440000,1.04704],
[1357093500000,1.04708],
[1357093560000,1.04712],
[1357093620000,1.0472],
[1357093680000,1.04736],
[1357093740000,1.04749],
[1357093800000,1.0476],
[1357093860000,1.0477],
[1357093920000,1.0478],
[1357093980000,1.04787],
[1357094040000,1.04798],
[1357094100000,1.0481],
[1357094160000,1.04819],
[1357094220000,1.04829],
[1357094280000,1.04838],
[1357299120000,1.04024],
[1357299180000,1.04025],
[1357299240000,1.04027],
[1357299300000,1.0403],
[1357299360000,1.04032],
[1357299420000,1.04033],
[1357299480000,1.04035],
[1357299540000,1.04038],
[1357299600000,1.04041],
[1357299660000,1.04046],
[1357299720000,1.04047],
[1357299780000,1.04047],
[1357299840000,1.04047],
[1357299900000,1.04047],
[1357299960000,1.04045],
[1357300020000,1.04041],
[1357300080000,1.04039],
[1357300140000,1.04038],
[1357300200000,1.04038],
[1357300260000,1.04038],
[1357300320000,1.04038],
[1357300380000,1.04039],
[1357300440000,1.0404],
[1357300500000,1.04042],
[1357300560000,1.04047],
[1357300620000,1.04051],
[1357300680000,1.04055],
[1357300740000,1.04059],
[1357300800000,1.04064],
[1357300860000,1.04071],
[1357300920000,1.04075],
[1357300980000,1.0408],
[1357301040000,1.04083],
[1357301100000,1.04086],
[1357301160000,1.0409],
[1357301220000,1.04092],
[1357301280000,1.04093],
[1357301340000,1.04094],
[1357301400000,1.04094],
[1357301460000,1.04094],
[1357301520000,1.04094],
[1357301580000,1.04094],
[1357301640000,1.04095],
[1357301700000,1.04095],
[1357301760000,1.04096],
[1357301820000,1.04097],
[1357301880000,1.04097],
[1357301940000,1.04098],
[1357302000000,1.04098],
[1357302060000,1.04097],
[1357302120000,1.04098],
[1357302180000,1.04098],
[1357302240000,1.04096],
[1357302300000,1.04094],
[1357302360000,1.04093],
[1357302420000,1.04093],
[1357302480000,1.04092],
[1357302540000,1.04091],
[1357302600000,1.04089],
[1357302660000,1.04085],
[1357302720000,1.0408],
[1357302780000,1.04076],
[1357302840000,1.04076],
[1357302900000,1.04073],
[1357302960000,1.0407],
[1357303020000,1.04067],
[1357303080000,1.04064],
[1357303140000,1.04062],
[1357303200000,1.04059],
[1357303260000,1.04058],
[1357303320000,1.04055],
[1357303380000,1.04056],
[1357303440000,1.04058],
[1357303500000,1.04062],
[1357303560000,1.04066],
[1357303620000,1.04069],
[1357303680000,1.04069],
[1357303740000,1.04072],
[1357303800000,1.04077],
[1357303860000,1.04082],
[1357303920000,1.04089],
[1357303980000,1.04097],
[1357304040000,1.04105],
[1357304100000,1.04112],
[1357304160000,1.0412],
[1357304220000,1.04125],
[1357304280000,1.04131],
[1357304340000,1.04135],
[1357304400000,1.04138],
[1357304460000,1.04141],
[1357304520000,1.04145],
[1357304580000,1.04147],
[1357304640000,1.04147],
[1357304700000,1.04149],
[1357304760000,1.04148],
[1357304820000,1.04147],
[1357304880000,1.04145],
[1357304940000,1.04144],
[1357305000000,1.04142],
[1357305060000,1.0414],
[1357305180000,1.04138],
[1357305240000,1.04138],
[1357305300000,1.04138],
[1357305360000,1.04139],
[1357305420000,1.0415],
[1357321260000,1.04597],
[1357321320000,1.04601],
[1357321380000,1.04606],
[1357321440000,1.04611],
[1357321500000,1.04615],
[1357321560000,1.04619],
[1357321620000,1.04623],
[1357321680000,1.04626],
[1357321740000,1.04629],
[1357321800000,1.04632],
[1357321860000,1.04635],
[1357321920000,1.04636],
[1357321980000,1.04637],
[1357322040000,1.04638],
[1357322100000,1.04638],
[1357322160000,1.04637],
[1357322220000,1.04636],
[1357322280000,1.04636],
[1357322340000,1.04636],
[1357322400000,1.04637],
[1357322460000,1.04637],
[1357322520000,1.04639],
[1357322580000,1.04641],
[1357322640000,1.04643],
[1357322700000,1.04645],
[1357322760000,1.04648],
[1357322820000,1.04651],
[1357322880000,1.04654],
[1357322940000,1.04657],
[1357323000000,1.0466],
[1357323060000,1.04661],
[1357323120000,1.04664],
[1357323180000,1.04666],
[1357323240000,1.04667],
[1357323300000,1.04669],
[1357323360000,1.04669],
[1357323420000,1.0467],
[1357323480000,1.04669],
[1357323540000,1.04668],
[1357323600000,1.04668],
[1357323660000,1.04667],
[1357323720000,1.04666],
[1357323780000,1.04665],
[1357323840000,1.04664],
[1357323900000,1.04664],
[1357323960000,1.04663],
[1357324020000,1.04663],
[1357324080000,1.04663],
[1357324140000,1.04663],
[1357324200000,1.04663],
[1357324260000,1.04663],
[1357324320000,1.04663],
[1357324380000,1.04664],
[1357324440000,1.04665],
[1357324500000,1.04666],
[1357324560000,1.04667],
[1357324620000,1.04668],
[1357324680000,1.04669],
[1357324740000,1.04671],
[1357324800000,1.04672],
[1357324860000,1.04672],
[1357324980000,1.04673],
[1357325040000,1.04673],
[1357325100000,1.04675],
[1357325160000,1.04677],
[1357325220000,1.04679],
[1357325280000,1.04681],
[1357325340000,1.04684],
[1357325400000,1.04686],
[1357325520000,1.04688],
[1357325580000,1.04689],
[1357325640000,1.04691],
[1357325700000,1.04691],
[1357325760000,1.04693],
[1357325820000,1.04694],
[1357325880000,1.04697],
[1357328520000,1.04757],
[1357328580000,1.04755],
[1357328640000,1.04752],
[1357328700000,1.0475],
[1357328760000,1.04748],
[1357328820000,1.04747],
[1357328880000,1.04745],
[1357328940000,1.04743],
[1357329000000,1.04742],
[1357329060000,1.04741],
[1357329120000,1.04741],
[1357329180000,1.0474],
[1357329240000,1.04739],
[1357329300000,1.04737],
[1357329360000,1.04734],
[1357329420000,1.04733],
[1357329480000,1.04731],
[1357329540000,1.0473],
[1357329600000,1.0473],
[1357329660000,1.04729],
[1357329720000,1.04728],
[1357329780000,1.04728],
[1357329840000,1.04727],
[1357329900000,1.04727],
[1357329960000,1.04727],
[1357330080000,1.04727],
[1357330140000,1.04728],
[1357330200000,1.04731],
[1357330260000,1.04734],
[1357330320000,1.04739],
[1357330380000,1.04745],
[1357330440000,1.04754],
[1357330500000,1.04763],
[1357330560000,1.04771],
[1357330620000,1.04779],
[1357330680000,1.04787],
[1357330740000,1.04795],
[1357330800000,1.04803],
[1357330860000,1.04812],
[1357330980000,1.0482],
[1357331040000,1.04829],
[1357331100000,1.04835],
[1357331160000,1.0484],
[1357331220000,1.04844],
[1357331280000,1.04848],
[1357331340000,1.04848],
[1357331400000,1.04848],
[1357331460000,1.04848],
[1357331520000,1.04848],
[1357331580000,1.04848],
[1357331640000,1.04847],
[1357331700000,1.04846],
[1357331760000,1.04845],
[1357331820000,1.04843],
[1357331880000,1.04842],
[1357331940000,1.04841],
[1357332060000,1.04841],
[1357332120000,1.04842],
[1357332180000,1.04841],
[1357332240000,1.04839],
[1357332300000,1.04836],
[1357332360000,1.04834],
] 
```

它是一组点：[ [x,y],[x,y]...]。

此脚本将系列（系列 [3]）添加到图表和名称，但数据集为空，xDate 和 yData 集也是如此。

Console.log（图表）：

```
$a {plotBox: Object, tooltip: yb, clipRect: Ga, plotLeft: 10, chartSubtitleOptions: Object…}
_sharedClip1000undefined: null
_sharedClip1000undefinedm: null
addSeries: function (a,b,c){var d,e=this;a&&(Fa(c,e),b=p(b,!0),J(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;b&&e.redraw()}));return d}
angular: undefined
animation: true
axes: Array[4]
axisOffset: Array[4]
callback: undefined
chartBackground: Ga
chartHeight: 385
chartSubtitleOptions: Object
chartTitleOptions: Object
chartWidth: 816
clipBox: Object
clipRect: Ga
container: <div>
containerHeight: 385
containerWidth: 816
counters: Lb
credits: Ga
detachedaddSeries: null
detachedinit: null
detachedredraw: null
extraBottomMargin: 64
hasCartesianSeries: true
hasRendered: true
hoverPoint: null
hoverPoints: null
hoverSeries: null
init: function (a){var b=this.options.chart,c;b.reflow!==!1&&D(this,"load",
inverted: undefined
isDirtyBox: false
isDirtyLegend: true
isResizing: 0
jQuery18208388212455902249: Object
legend: Ab
marginBottom: 94
marginRight: 10
maxTicks: null
options: Object
optionsMarginBottom: undefined
optionsMarginLeft: undefined
optionsMarginRight: undefined
optionsMarginTop: undefined
pan: function (a){var d=b.xAxis[0],h=!1;if(d.options.ordinal&&d.series.length){var i=b.mouseDownX,j=d.getExtremes(),k=j.dataMax,l=j.min,m=j.max,o;o=b.hoverPoints;
plotBorderWidth: 0
plotBox: Object
plotHeight: 281
plotLeft: 10
plotSizeX: 796
plotSizeY: 281
plotTop: 10
plotWidth: 796
pointCount: 486
polar: undefined
redraw: function (a){var b=this.axes,c=this.series,d=this.tracker,e=this.legend,f=this.isDirtyLegend,g,h=this.isDirtyBox,i=c.length,j=i,k=this.renderer,l=k.isHidden(),m=[];Fa(a,this);for(l&&this.cloneRenderTo();j--;)if(a=c[j],a.isDirty&&a.options.stacking){g=!0;break}if(g)for(j=i;j--;)if(a=c[j],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(f=!0)});if(f&&e.options.enabled)e.render(),this.isDirtyLegend=
renderTo: <div>
renderer: pa
runChartClick: undefined
scroller: Pb
series: Array[3]
0: c
chart: $a
closestPointRange: 3600000
color: "#4572A7"
columnIndex: 0
cropStart: 0
cropped: undefined
currentDataGrouping: Object
data: Array[0]
forceCrop: true
group: Ga
groupedData: Array[70]
hasGroupedData: true
hasRendered: true
index: 0
isDirty: false
isDirtyData: false
jQuery18208388212455902249: Object
markerGroup: Ga
name: "AUDUSD"
options: Object
pointAttr: Array[0]
pointRange: 3600000
points: Array[70]
processedXData: Array[70]
processedYData: Array[70]
segments: Array[1]
selected: false
state: ""
tooltipOptions: Object
tooltipPoints: Array[797]
trackerGroup: Ga
translatedThreshold: 281
visible: true
xAxis: Sa
xData: Array[4096]
xIncrement: null
yAxis: Sa
yData: Array[4096]
__proto__: c
1: c
animate: null
animationTimeout: 3162
area: Ga
areaPath: Array[2914]
chart: $a
closestPointRange: 600000
color: "#4572A7"
cropStart: 0
cropped: undefined
currentDataGrouping: Object
data: Array[0]
forceCrop: true
graph: Ga
graphPath: Array[2908]
group: Ga
groupedData: Array[416]
hasGroupedData: true
hasRendered: true
index: 1
isDirty: false
isDirtyData: false
jQuery18208388212455902249: Object
markerGroup: Ga
name: "Navigator"
options: Object
pointAttr: Array[0]
pointRange: 0
points: Array[416]
processedXData: Array[416]
processedYData: Array[416]
segments: Array[1]
selected: false
sharedClipKey: "_sharedClip1000undefined"
singlePoints: Array[0]
state: ""
symbol: "circle"
tooltipOptions: Object
visible: true
xAxis: Sa
xData: Array[4096]
xIncrement: null
yAxis: Sa
yData: Array[4096]
__proto__: c
2: c
animate: null
animationTimeout: 3259
chart: $a
_sharedClip1000undefined: null
_sharedClip1000undefinedm: null
addSeries: function (a,b,c){var d,e=this;a&&(Fa(c,e),b=p(b,!0),J(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;b&&e.redraw()}));return d}
angular: undefined
animation: true
axes: Array[4]
axisOffset: Array[4]
callback: undefined
chartBackground: Ga
chartHeight: 385
chartSubtitleOptions: Object
chartTitleOptions: Object
chartWidth: 816
clipBox: Object
clipRect: Ga
container: <div>
containerHeight: 385
containerWidth: 816
counters: Lb
credits: Ga
detachedaddSeries: null
detachedinit: null
detachedredraw: null
extraBottomMargin: 64
hasCartesianSeries: true
hasRendered: true
hoverPoint: null
hoverPoints: null
hoverSeries: null
init: function (a){var b=this.options.chart,c;b.reflow!==!1&&D(this,"load",
inverted: undefined
isDirtyBox: false
isDirtyLegend: true
isResizing: 0
jQuery18208388212455902249: Object
legend: Ab
marginBottom: 94
marginRight: 10
maxTicks: null
options: Object
optionsMarginBottom: undefined
optionsMarginLeft: undefined
optionsMarginRight: undefined
optionsMarginTop: undefined
pan: function (a){var d=b.xAxis[0],h=!1;if(d.options.ordinal&&d.series.length){var i=b.mouseDownX,j=d.getExtremes(),k=j.dataMax,l=j.min,m=j.max,o;o=b.hoverPoints;
plotBorderWidth: 0
plotBox: Object
plotHeight: 281
plotLeft: 10
plotSizeX: 796
plotSizeY: 281
plotTop: 10
plotWidth: 796
pointCount: 486
polar: undefined
redraw: function (a){var b=this.axes,c=this.series,d=this.tracker,e=this.legend,f=this.isDirtyLegend,g,h=this.isDirtyBox,i=c.length,j=i,k=this.renderer,l=k.isHidden(),m=[];Fa(a,this);for(l&&this.cloneRenderTo();j--;)if(a=c[j],a.isDirty&&a.options.stacking){g=!0;break}if(g)for(j=i;j--;)if(a=c[j],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(f=!0)});if(f&&e.options.enabled)e.render(),this.isDirtyLegend=
renderTo: <div>
renderer: pa
runChartClick: undefined
scroller: Pb
series: Array[3]
seriesGroup: Ga
setSize: function (e,f,g){a.top=h=a.getAxisTop(f);if(c&&d)c.options.top=d.options.top=h;r.call(b,e,f,g)}
spacingBox: Object
tooltip: yb
tracker: zb
trackerGroup: Ga
xAxis: Array[2]
yAxis: Array[2]
__proto__: Object
closestPointRange: undefined
color: "#AA4643"
cropStart: 0
cropped: undefined
currentDataGrouping: null
data: Array[0]
forceCrop: true
graph: Ga
graphPath: Array[0]
group: Ga
groupedData: null
hasGroupedData: undefined
hasRendered: true
index: 2
isDirty: false
isDirtyData: false
jQuery18208388212455902249: Object
markerGroup: Ga
name: "Series 3"
options: Object
pointAttr: Array[0]
pointRange: 0
points: Array[0]
processedXData: Array[0]
processedYData: Array[0]
segments: Array[0]
selected: false
sharedClipKey: "_sharedClip1000undefined"
singlePoints: Array[0]
state: ""
symbol: "diamond"
tooltipOptions: Object
tooltipPoints: Array[0]
tracker: Ga
trackerGroup: Ga
visible: true
xAxis: Sa
xData: Array[0]
xIncrement: null
yAxis: Sa
yData: Array[0]
__proto__: W
length: 3
__proto__: Array[0]
seriesGroup: Ga
setSize: function (e,f,g){a.top=h=a.getAxisTop(f);if(c&&d)c.options.top=d.options.top=h;r.call(b,e,f,g)}
spacingBox: Object
tooltip: yb
tracker: zb
trackerGroup: Ga
xAxis: Array[2]
yAxis: Array[2]
__proto__: Object 
```

我正在使用 Java 方法获取数据：

```
@RequestMapping(value = "/indicator", method = RequestMethod.GET)
public @ResponseBody
String getHitoricalIndicator(@RequestParam("indicator") String indicator2,
        @RequestParam("period") String period,
        @RequestParam("currency") String currency) {
    JSONObject js = new JSONObject();
    System.out.println(indicator2 + period + currency);
    Indicators ind = new Indicators();
    String pe = null;
    if (period.equals("1"))
        pe = PERIOD_CODE.PERIOD_M1.toString();
    if (period.equals("15"))
        pe = PERIOD_CODE.PERIOD_M15.toString();
    if (period.equals("30"))
        pe = PERIOD_CODE.PERIOD_M30.toString();
    if (period.equals("60"))
        pe = PERIOD_CODE.PERIOD_H1.toString();
    if (period.equals("240"))
        pe = PERIOD_CODE.PERIOD_H4.toString();
    if (period.equals("1440"))
        pe = PERIOD_CODE.PERIOD_D1.toString();
    Currency cur = sc.getCurrencies().get(currency);
    Period p = cur.data.get(pe);
    long[] timestamp = new long[p.size];
    double[] close = new double[p.size];
    int l = 0;
    for (CandleStick r : p.list) {
        timestamp[l] = r.getTimestamp();
        close[l] = r.getClose();
        l++;
    }
    double[] results = ind.SMA(Indicators.standardPeriod, close);

    String responseCandle = "[";
    int g = results.length;
    int licz = 0;
    for (int w = 0; w < results.length; w++) {
        responseCandle = responseCandle + "[" + Long.toString(timestamp[w])
                + ", " + Double.toString(results[w]);
        if (licz + 1 == g)
            responseCandle = responseCandle + "]";
        else
            responseCandle = responseCandle + "], ";
        licz++;
    }
    responseCandle = responseCandle + "]";

    logger.info(responseCandle);
    js.put("dane", responseCandle);

    return responseCandle;
} 
```

您知道将系列添加到图表的另一种方法吗？

我寻找，但我没有找到回应。

请帮我。

马特乌斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:11:49.243

该[`addSeries`](http://api.highcharts.com/highstock#Chart.addSeries%28%29)方法接受一个对象，而不是一个数组。

所以调用应该是这样的：

```
chart.addSeries({
    type : 'line',
    name : 'wskaznik',
    data : data
}, true, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:50:37.120

我找到了解决方案。

$.ajax 和 $.getJSON 的区别。

**解决方案！**

```
$.getJSON('candlestick', {
        currency : $("#selectionField3").val(),
        period : $("#selectionField2 option:selected").val()
    }, function(data) {
        chart = new Highcharts.StockChart({
            chart : {
                renderTo : 'chart'
            },
            rangeSelector : false,
            // title : {
            // text : 'Candlestick Chart'
            // },

            series : [ {
                type : 'candlestick',
                name : $("#selectionField3").val(),
                data : data,
            } ],
        }); 
```

$.json 的响应是文本类型，但 $.getJSON 类似于数组类型。

感谢您的关注和帮助。

国王问候，

马特乌什·贾穆泽克

# xml - Delphi - Fast(er) XML 解析器

> ID：14175188
> 
> 赞同：-3
> 
> 时间：2013-01-05T18:55:35.740
> 
> 标签：xml, delphi, parsing, assembly

我正在为 Delphi 寻找一个非常快速的 XML 解析器，用于非常简单的数据。

考虑以下类型的数据：

```
<node>
    <datatype1>randomdata</datatype1>
    <datatype2>randomdata</datatype2>
    <datatype3>randomdata</datatype3>
    <datatype4>randomdata</datatype4>
    <datatype5>randomdata</datatype5>
    <datatype6>randomdata</datatype6>
    <datatype7>randomdata</datatype7>
    <datatype8>randomdata</datatype8>
    <datatype9>randomdata</datatype9>
    <datatype10>randomdata</datatype10>
    <datatype11>randomdata</datatype11>
    <datatype12>randomdata</datatype12>
    <datatype13>randomdata</datatype13>
    <datatype14>randomdata</datatype14>
    <datatype15>randomdata</datatype15>
    <datatype16>randomdata</datatype16>
    <datatype17>randomdata</datatype17>
    <datatype18>randomdata</datatype18>
    <datatype19>randomdata</datatype19>
    <datatype20>randomdata</datatype20>
</node> 
```

复制这 10000 次（数据类型和数据在实际场景中明显不同）。还要考虑包含 Unicode 的数据。

这将被解析并加载到一个记录数组中，例如

```
Type MyData = record
  d1,d2,d3,d4,d5,
  d6,d7,d8,d9,d10,
  d11,d12,d13,d14,d15,
  d16,d17,d18,d19,d20: string;
end; 
```

我为此编写了一个自定义解析器，在我的计算机中大约需要。从加载文件到填充 10,000 条记录，整个过程需要 115 毫秒。

因此，我正在寻找可以更快地完成此任务的东西。

相关问题：

[utf8 字符串边界内的 Pos()](https://stackoverflow.com/questions/14168974/delphi-perform-pos-within-utf8-string-boundaries)

[Delphi - 带边界的 Pos()](https://stackoverflow.com/questions/14175173/delphi-pos-with-boundaries)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T20:23:11.883

首先让我告诉您，您在这里优化了错误的事情：除非您出于娱乐目的这样做，否则您的方法是错误的。XML 不是一种困难的格式，但它确实有它的怪癖并且它需要它的自由。它是一种为国外应用程序之间的数据交换而设计的格式，所以重点需要放在兼容性上，而不是速度上！当遇到稍微改变的 XML 文件时给出错误结果的非标准超快速解析器有什么好处？

如果你能找到一个 XML 解析库，它可以保证与任何能够以 HDD 读取数据的速度一半的速度解析数据的东西兼容，那么只需实现一个生产者-消费者多线程应用程序，其中一个线程不断读取数据从磁盘，而其他两个只是进行解析。最后，在保持兼容性的同时，您只会受到 HDD 速度的限制。如果您只追求速度，您可能会犯错误，请跳过 XML 功能，这取决于您正在处理的示例 XML 文件的某些特殊性。您的应用程序可能会因多种原因而中断。

请记住，应用程序最昂贵的周期是维护，而不是生产。你今天通过制造速度提高 50% 的东西而获得的东西，但在一年左右的时间里，当计算机速度提高 50% 时（使你在竞争中的优势消失），将在一年左右的时间里失去。此外，超出此类过程的自然限制是没有意义的，例如 HDD 的速度。使用 RAM 驱动器中的文件进行测试无关紧要 - 当应用程序投入生产时，它将与 HDD 中的文件一起使用，并且您的应用程序的性能将受到 HDD 速度的限制。

* * *

无论如何，我偶尔会喜欢挑战，我真的很喜欢解析器。下面是一个非常简单的解析器实现，它只查看输入字符串中的每个字符*一次*，并且只在需要的地方复制内容：复制节点的名称以便决定下一步做什么，并在适当的时候复制节点的“有效负载”，为了将其推入阵列。在我的“适度”i7 @ 3.4 Ghz 上，解析通过复制样本数据 10,000 次构建的字符串需要 63 毫秒。它显然比你的时间要好，但要提醒一句，这段代码很脆弱：它*取决于*有一个特定形式的 XML 文件。没办法。

```
program Project28;

{$APPTYPE CONSOLE}

uses SysUtils, DateUtils, Windows;

const SampleData =
    '<node>'#13#10+
    '  <datatype1>randomdata</datatype1>'#13#10+
    '  <datatype2>randomdata</datatype2>'#13#10+
    '  <datatype3>randomdata</datatype3>'#13#10+
    '  <datatype4>randomdata</datatype4>'#13#10+
    '  <datatype5>randomdata</datatype5>'#13#10+
    '  <datatype6>randomdata</datatype6>'#13#10+
    '  <datatype7>randomdata</datatype7>'#13#10+
    '  <datatype8>randomdata</datatype8>'#13#10+
    '  <datatype9>randomdata</datatype9>'#13#10+
    '  <datatype10>randomdata</datatype10>'#13#10+
    '  <datatype11>randomdata</datatype11>'#13#10+
    '  <datatype12>randomdata</datatype12>'#13#10+
    '  <datatype13>randomdata</datatype13>'#13#10+
    '  <datatype14>randomdata</datatype14>'#13#10+
    '  <datatype15>randomdata</datatype15>'#13#10+
    '  <datatype16>randomdata</datatype16>'#13#10+
    '  <datatype17>randomdata</datatype17>'#13#10+
    '  <datatype18>randomdata</datatype18>'#13#10+
    '  <datatype19>randomdata</datatype19>'#13#10+
    '  <datatype20>randomdata</datatype20>'#13#10+
    '</node>'#13#10;
const NodeIterations = 10000;

type
  TDummyRecord = record
    D1, D2, D3, D4, D5, D6, D7, D8, D9, D10, D11, D12, D13,
      D14, D15, D16, D17, D18, D19, D20: string;
  end;
  TDummyRecordArray = array[1..NodeIterations] of TDummyRecord;

procedure ParseDummyXMLToRecordArray(const InputText:string; var A: TDummyRecordArray);
var PInputText: PChar;
    cPos, TextLen: Integer;
    C: Char;
    State: Integer;

    tag_starts_at: Integer;
    last_payload_starts_at: Integer;
    FlagEndTag: Boolean;

    NodeName, Payload: string;

    cNode: Integer;

const st_not_in_node = 1;
      st_in_node = 2;
begin
  cPos := 1;
  TextLen := Length(InputText);
  PInputText := @InputText[1];
  State := st_not_in_node;
  last_payload_starts_at := 1;
  cNode := 0;

  // This is the lexer/parser loop. It's a finite-state machine with only
  // two states: st_not_in_node and st_in_node
  while cPos < TextLen do
  begin
    C := PInputText[cPos-1];
    case State of

      // What happens when we're NOT currently inside a node?
      // Not much. We only jump to st_in_node if we see a "<"
      st_not_in_node:
        case C of
          '<':
            begin
              // A node starts here. Switch state and set up some simple
              // flags.
              state := st_in_node;
              tag_starts_at := cPos + 1;
              FlagEndTag := False;
            end;
        end;

      // What happens while inside a node? Again, not much. We only care about
      // the "/" - as it signals an closing tag, and we only care about the
      // ">" because that means the end of the ndoe.
      st_in_node:
        case C of
          '/': FlagEndTag := True;
          '>':
            begin
              // This is where the magic haepens. We're in one of possibly two states:
              // We're ither seeing the first <name> of a pair, or the second </name>
              //
              if FlagEndTag then
                begin
                  // This is the closing pair of a tag pair, ie, it's the </NodeName> What we'll do
                  // depends on what node is closing, so we retreive the NodeName:
                  NodeName := System.Copy(InputText, tag_starts_at+1, cPos - tag_starts_at-1);
                  if NodeName <> 'node' then // SAMPLE-DATA-SPECIFIC: I know I don't care about "node" tags.
                  begin
                    // SAMPLE-DATA-SPECIFIC: I know there are only two kinds of nodes:
                    // "node" and "datatypeN". I retreive the PAYLOAD for the node because
                    // I know it's not "ndoe" and I know I'll need it.
                    Payload := System.Copy(InputText,last_payload_starts_at, tag_starts_at - last_payload_starts_at -1);
                    // Make sure we're dealing with a valid node
                    if (cNode > 0) and (cNode <= High(A)) then
                      begin
                        // Based on NodeName, copy the Payload into the appropriate field.
                        if NodeName = 'datatype1' then A[cNode].D1 := Payload
                        else if NodeName = 'datatype2' then A[cNode].D2 := Payload
                        else if NodeName = 'datatype3' then A[cNode].D3 := Payload
                        else if NodeName = 'datatype4' then A[cNode].D4 := Payload
                        else if NodeName = 'datatype5' then A[cNode].D5 := Payload
                        else if NodeName = 'datatype6' then A[cNode].D6 := Payload
                        else if NodeName = 'datatype7' then A[cNode].D7 := Payload
                        else if NodeName = 'datatype8' then A[cNode].D8 := Payload
                        else if NodeName = 'datatype9' then A[cNode].D9 := Payload
                        else if NodeName = 'datatype10' then A[cNode].D10 := Payload
                        else if NodeName = 'datatype11' then A[cNode].D11 := Payload
                        else if NodeName = 'datatype12' then A[cNode].D12 := Payload
                        else if NodeName = 'datatype13' then A[cNode].D13 := Payload
                        else if NodeName = 'datatype14' then A[cNode].D14 := Payload
                        else if NodeName = 'datatype15' then A[cNode].D15 := Payload
                        else if NodeName = 'datatype16' then A[cNode].D16 := Payload
                        else if NodeName = 'datatype17' then A[cNode].D17 := Payload
                        else if NodeName = 'datatype18' then A[cNode].D18 := Payload
                        else if NodeName = 'datatype19' then A[cNode].D19 := Payload
                        else if NodeName = 'datatype20' then A[cNode].D20 := Payload
                        else
                          raise Exception.Create('Unknown node: ' + NodeName);
                      end
                    else
                      raise Exception.Create('cNode out of bounds.');
                  end;
                  // Repeat :-)
                  state := st_not_in_node;
                end
              else
                begin
                  // Node start. Retreive node name. I only care about the start of the "NODE" - if I see that
                  // I'll increment the current node counter so I'll go on filling the next position in the array
                  // with whatever I need.
                  NodeName := System.Copy(InputText, tag_starts_at, cPos - tag_starts_at);
                  last_payload_starts_at := cPos+1;
                  if NodeName = 'node' then Inc(cNode);
                  state := st_not_in_node;
                end;
            end;
        end;
    end;
    Inc(cPos);
  end;
end;

var DataString: string;
    SB: TStringBuilder;
    i: Integer;
    DummyArray: TDummyRecordArray;
    T1, T2, F: Int64;

begin
  try
    try
      // Prepare the sample string; 10.000 iterations of the sample data.
      SB := TStringBuilder.Create;
      try
        for i:=1 to NodeIterations do
          SB.Append(SampleData);
        DataString := SB.ToString;
      finally SB.Free;
      end;

      // Invoke the simple parser using the string constant.
      QueryPerformanceCounter(T1);

      ParseDummyXMLToRecordArray(DataString, DummyArray);

      QueryPerformanceCounter(T2);
      QueryPerformanceFrequency(F);
      WriteLn(((T2-T1) * 1000) div F);

      // Test parse validity.
      for i:=1 to NodeIterations do
      begin
        if DummyArray[i].D1 <> 'randomdata' then raise Exception.Create('Bug. D1 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D2 <> 'randomdata' then raise Exception.Create('Bug. D2 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D3 <> 'randomdata' then raise Exception.Create('Bug. D3 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D4 <> 'randomdata' then raise Exception.Create('Bug. D4 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D5 <> 'randomdata' then raise Exception.Create('Bug. D5 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D6 <> 'randomdata' then raise Exception.Create('Bug. D6 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D7 <> 'randomdata' then raise Exception.Create('Bug. D7 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D8 <> 'randomdata' then raise Exception.Create('Bug. D8 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D9 <> 'randomdata' then raise Exception.Create('Bug. D9 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D10 <> 'randomdata' then raise Exception.Create('Bug. D10 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D11 <> 'randomdata' then raise Exception.Create('Bug. D11 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D12 <> 'randomdata' then raise Exception.Create('Bug. D12 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D13 <> 'randomdata' then raise Exception.Create('Bug. D13 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D14 <> 'randomdata' then raise Exception.Create('Bug. D14 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D15 <> 'randomdata' then raise Exception.Create('Bug. D15 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D16 <> 'randomdata' then raise Exception.Create('Bug. D16 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D17 <> 'randomdata' then raise Exception.Create('Bug. D17 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D18 <> 'randomdata' then raise Exception.Create('Bug. D18 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D19 <> 'randomdata' then raise Exception.Create('Bug. D19 doesn''t have the proper value, i=' + IntToStr(i));
        if DummyArray[i].D20 <> 'randomdata' then raise Exception.Create('Bug. D20 doesn''t have the proper value, i=' + IntToStr(i));
      end;

    except on E: Exception do Writeln(E.ClassName, ': ', E.Message);
    end;
  finally
    WriteLn('ENTER to Exit');
    ReadLn;
  end;
end. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:18:14.180

如果您的 XML 很简单，格式固定，文件很大，并且您需要非常快速的处理，我建议您自己实现解析，使用简单的 while (i < length(unputStr)) 循环。在那里您可以搜索“<”符号、提取节点名称等。

# drupal - Drupal 7：将 CSV 导入节点中的多个分类字段

> ID：14175189
> 
> 赞同：2
> 
> 时间：2013-01-05T18:55:41.110
> 
> 标签：drupal, drupal-7, drupal-modules

我已经开始了一个新的 Drupal 项目，其中我有多个词汇表，以及一个包含这些词汇表的节点作为带有自动完成框的字段。我有一个 CSV 文件，我想知道是否有任何方法使用提要或最终迁移模块来使列在不同的词汇表下创建标签。请注意，它们自己的标签可能还需要创建多个值。

尝试显示我的意思，这可能是 CSV 文件中的一行：Content_type_ID;Tax1_name;Tax1_email;Tax2_ID;Tax2_Year;Tax2_Month

其中 Tax1 和 Tax2 是不同的词汇表，作为我的内容类型中的字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:00:58.630

看看[Feeds 模块](http://drupal.org/project/feeds)。

> 将数据导入或聚合为节点、用户、分类术语或简单的数据库记录。

[文档链接](http://drupal.org/node/622696)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:02:57.117

还可以看看[Migrate 模块](http://drupal.org/project/migrate)，但是“Feeds 模块”非常好用。

# vb.net - VB.net | 将 REG_BINARY 写入注册表

> ID：14175190
> 
> 赞同：0
> 
> 时间：2013-01-05T18:55:43.373
> 
> 标签：vb.net, registry

我正在尝试将 REG_BINARY 写入注册表，但由于某种原因，第二组文本给出了一个错误，说它需要一个 }？

```
My.Computer.Registry.SetValue("HKEY_CURRENT_USER\TEST", "KEY", New Byte() {86, 23, E3, 92, 1E, E8, 65, 07, D5, 12, 1E, E3, E3, E3, E3},RegistryValueKind.Binary) 
```

我如何将它作为 REG_BINARY 写入注册表？

在 ab 之后它声明 cd 期望一个 } 之后？

**编辑**

我很抱歉没有提到......这确实对问题产生了影响，我试图写的内容是十六进制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:02:36.393

对于数组初始化程序，这不是合法的 VB.NET 语法。您需要用逗号分隔每个数组元素值，例如`New Byte() {0,1,2,3,4}`. 如果要写入十六进制值而不是十进制值，请使用`&H`前缀，例如`New Byte() {&H0,&H1,&H2,&H3,&H4}`.

# c# - 在我的项目架构中，我应该在哪里放置自定义成员资格提供程序？

> ID：14175191
> 
> 赞同：3
> 
> 时间：2013-01-05T18:55:51.307
> 
> 标签：c#, asp.net, n-tier-architecture

4 个月前我开始学习如何构建 N-Tier Web 应用程序，但我仍然不完全了解将所有内容放在哪里。我的架构基于 Scott Millett 的《Professional ASP.NET Design Patterns》一书，如下：

*   项目控制器
*   项目.基础设施
*   项目.模型
*   项目.存储库.NHibernate
*   项目服务
*   项目.UI.Web.MVC

在他的案例研究中，他在基础设施项目中使用了标准的会员资格提供程序。如果我想创建另一个 Web 应用程序，我可以轻松地将基础设施项目添加到解决方案中，并准备好使用会员资格。

但我想创建我自己的使用 NHibernate 的自定义成员资格提供程序。我应该在我的 Services 项目中为它创建一个服务并在我的 Repository.NHibernate 项目中为它创建一个存储库吗？还是我应该仍然使用基础设施项目并在那里创建它们，以便我可以在其他项目中重用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:58:47.060

不要过度设计您的解决方案，这些事情没有真正的对错。做最简单的事情来解决您的问题并提供功能。

所以最大的问题是，当您可以使用 SqlMembershipProvider 来实现相同的事情时，为什么要这样做（当然，除非您正在更改使用 aspnet_regsql 命令创建的表结构）

无论如何，抛开问题不谈，我倾向于遵循微软的命名空间约定。因此，在您的情况下，我将在您的解决方案中创建一个名为 YourCompany.Web.Security 的新类库，然后在名为 YourCompany.Web.Security.HibernateMembershipProvider 的命名空间中创建提供程序类。您所有的存储库和服务以及其他垃圾都将进入此程序集。

现在您遇到的更大问题是关于数据存储的学术问题。根据我的经验，最好不要将身份和“一般”配置文件数据与应用程序数据放在同一个数据库中。所以这个新的程序集应该检查你正在连接的数据库实例并创建表等来支持你的成员需求（假设你正在实现一个完整的提供者）

您可能还需要编写自己的 web/windows 应用程序来管理用户。

因此，当 SqlMembershipProvider 已经存在所有这些时，我真的会质疑您正在做的事情的价值。

说了这么多，对于调查 .net 4.5 的新 Microsoft Identity Foundation (WIF) 功能并使用 azure 管理您的身份数据，还有很多话要说。它很容易设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T20:20:57.963

尽管我完全同意 Peter 和 Modika，但我想补充几点。

在设计您的应用程序时，您需要了解将这些内容放在单独项目中的原因，并对关注点分离有透彻的了解。意思是，你需要知道你在分离什么，为什么你会担心它。

我没有读过那本书，所以我对作者的方法没有评论。无论如何，在相信作者如何命名事物是“专业”的做法之前，停下来不仅要考虑您的应用程序，还要考虑诸如 .net 框架本身之类的事物的结构。

在任何给定的项目中，您可能必须生成几种类型的工件，包括：数据访问代码、对象模型、UI、业务逻辑等。

有几个自然边界区域。例如，您可能希望将数据访问代码分离出来，以防您需要换出永久存储选项，甚至只是换出使用 LINQ、NHibernate 或您拥有的访问方法等访问方法。

您可能希望在其他解决方案中重用对象模型的可能性；或者您甚至可能想要支持交换 UI 部分，例如从 WebForms 移动到 MVC 到任何东西。您甚至可能需要根据对象模型的使用方式或使用对象来将不同的业务逻辑应用于对象模型。

也就是说，并非每个应用程序都有相同的结构需求。例如，如果没有业务逻辑，对象模型可能完全没有意义；或者，更有可能的是，某些逻辑绝对必须与类定义合并，而其他逻辑则特定于库的使用方式。如果是前者，那么您有充分的理由将业务逻辑与类定义放在完全相同的项目/程序集中。如果是后者，那么您可能希望将其分离到其他程序集中并为对象实现接口定义。

根据我的经验，如果您不知道，请将其放在一起，因为这是最简单的选择，如果情况需要，可以在以后重构您想要的内容。

如果您在早期进行过度设计，那么您会增加项目时间/成本，从而获得可能永远无法实现的*潜在收益；*这很少是一个好的决定。还有一个问题是，你不知道以后可能需要什么，现在分离可能意味着你今天增加了项目时间，但以后*仍然*需要重构，这是双重打击。真正专业的开发人员恕我直言，在评估潜在解决方案时会考虑成本/开发时间。

* * *

现在，了解关于很有可能在其他项目中重用的定制会员提供程序的特定要求。自定义提供者应该在它自己的项目和命名空间中。我可能会使用像`Company.Security`. 这将提供最佳的可移植性方法，允许您仅重用相关代码，而无需拖累这个项目特有的各种其他东西。

因为它使用提供者模型，所以您的其他项目中不应该有需要直接引用这个的代码。只需使用已经存在的接口即可。

# c++ - C++ - 将 ANSI 编码的文本读取为宽字符串

> ID：14175198
> 
> 赞同：0
> 
> 时间：2013-01-05T18:57:01.300
> 
> 标签：c++

我的目标是阅读 ANSI 编码的文本。但由于某些原因，我使用 fgetws() （不是 fgets）函数，当然文件是以二进制模式打开的。这是演示我的问题的短代码

```
 bool testfunc(wchar_t path[])
  {
     wchar_t buffer[10];

     if( FILE * fr=_wfopen(path,L"rb") )
     {
        fgetws(buffer,sizeof(buffer),fr);
        fclose(fr);
        return true;
     }
     else return false;
  } 
```

当我调用此函数并将 ANSI 编码的文本文件路径作为参数传递时，运行时会出现访问冲突错误。当文本大小足够大时，似乎会发生错误。我不知道问题出在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:04:46.120

根据文档，`fgetws`的第二个参数是数组中的宽字符数，而不是字节数，所以：

```
fgetws(buffer,sizeof(buffer)/sizeof(*buffer),fr); 
```

一个有用的经典宏是：

```
#define countof(x) (sizeof(x)/sizeof(*(x))) 
```

或者一个花哨的 C++ 模板：

```
template <typename T, int N>
int countof(T (&a)[N])
{
    return N;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:14:22.290

如果文件仅包含[ASCII](http://en.wikipedia.org/wiki/Ascii)字符（请记住 ASCII 是[Unicode](http://en.wikipedia.org/wiki/Unicode)的子集，并且 的大小`wchar_t`是特定于实现的，并且可能适合 Unicode 字符子集的某些固定宽度编码；因此`wchar_t`不是很便携），您需要将每个单独的 ASCII 字符转换为其等效的宽字符：

```
{
#define SIZE 80
    char cbuf[SIZE];
    wchar_t wbuf[SIZE];
    char* pc;
    wchar_t* pw;
    memset (cbuf, 0, sizeof(cbuf));
    memset (wbuf, 0, sizeof(wbuf));
    fgets (cbuf, SIZE, fr);
    for ((pc=cbuf), (pw=wbuf); pc<cbuf+SIZE && *pc != 0; pc++, pw++)
      *pw = (wchar_t) *pc;
} 
```

PS 仔细阅读[fgetws(3)](http://linux.die.net/man/3/fgetws)手册页的*注释。*可以理解为吓人。

# iphone - iPhone屏幕尺寸4按下按钮

> ID：14175200
> 
> 赞同：1
> 
> 时间：2013-01-05T18:57:08.273
> 
> 标签：iphone, ios, xcode

每次我为 iPhone 4 设置布局并为 iPhone 5 切换视图时，它都会按下所有按钮并弄乱我的布局，我该如何防止这种情况发生？例如，如果我切换到 iPhone 5 的屏幕尺寸，如果 iPhone 4 中间有一个按钮，它在底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:16:20.830

转到尺寸选项卡并更改红色支柱以锚定到顶部而不是底部。

iOS6 有另一个选项：自动布局，如果需要或者需要与 iOS5 及更低版本的兼容性，可以禁用它。

![在此处输入图像描述](../Images/733946571578cfef544a7fe1fe4f17c1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:17:23.993

您可以根据它所在视图的高度设置按钮的框架位置。使用视图框架

```
- (void)viewWillAppear:(BOOL)animated 
```

# ios - CFBridgeRetained 但只有 CFRleased 的 ARC 对象会发生什么情况？

> ID：14175201
> 
> 赞同：3
> 
> 时间：2013-01-05T18:57:31.930
> 
> 标签：ios, macos, memory, automatic-ref-counting, core-foundation

假设仍然存在未完成的强引用，这是否会导致泄漏，因为没有人（ARC 和我）不再管理该对象？

```
 CFTypeRef cf_object = CFBridgingRetain(arc_object);
 // do stuff
 CFRelease(cf_object); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:22:15.683

要回答您的问题，上面的代码看起来不错。`CFRelease`当你在做 CF 时，你需要做 a `Create`，`Retain`或者`Copy`. 正如 Rob 建议的那样，您还可以查看`CFBridgingRelease`. 有关 ARC 更改的更多详细信息，您可以查看此[Raywenderlich 教程](http://www.raywenderlich.com/5773/beginning-arc-in-ios-5-tutorial-part-2)。

根据[苹果](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/CFBridgingRetain)`CFBridgingRetain`文档，

> 将 Objective-C 指针转换为 Core Foundation 指针，并将所有权转移给调用者。

```
CFTypeRef CFBridgingRetain(id X) 
```

> **讨论：** 您使用此函数将 Objective-C 对象转换为 Core Foundation 样式的对象并获取该对象的所有权，以便您可以管理其生命周期。您负责随后释放该对象。

在这里，您需要释放`cf_object`哪个 ARC 不会处理它。一旦你调用`CFRelease`，它就会被释放。

关于[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/CFBridgingRelease)`CFBridgingRelease`

> 将非 Objective-C 指针移动到 Objective-C 并将所有权转移给 ARC。

```
id CFBridgingRelease(CFTypeRef X) 
```

> **讨论：**您使用此函数将 Core Foundation 样式的对象转换为 Objective-C 对象并将对象的所有权转移给 ARC，这样您就不必释放该对象。

请注意，当您使用 时 `CFBridgingRelease`，它会将所有权转移给 ARC，ARC 将对其进行管理。

例如：-

```
CFStringRef cfName = ABRecordCopyValue(person, kABPersonFirstNameProperty);
NSString *name = (NSString *)CFBridgingRelease(cfName); 
```

ARC将`name`在这里管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T19:33:26.927

在您修改后的问题中，您提供的代码没有泄漏。您使用 将 Objective-C 对象转换为 Core Foundation 指针，`CFBridgingRetain`增加了进程中核心基础对象的保留计数。但是，你用 a 平衡了它`CFRelease`，它再次减少了保留计数（当保留计数为零时，它将被释放），所以一切都很好。没有泄漏。

最重要的是，这个小小的核心基金会往返`cf_object`不会对 ARC 的管理产生不利影响`arc_object`。

所以，你的问题是：

> 假设仍然存在未完成的强引用，这是否会导致泄漏，因为没有人（ARC 和我）不再管理该对象？

几个想法：

1.  ARC 从未管理过 Core Foundation 对象`cf_object`。你是。通过打电话`CFRelease`，你已经履行了你的责任。

2.  ARC 从未停止管理 Objective-C 对象，`arc_object`. 它仍然是。并且当所有强引用都被删除（包括任何 Core Foundation 保留）时，对象将被释放。

3.  你在你的问题前加上关于还有其他强有力的参考的评论。这与泄漏问题、Core Foundation 手动管理内存等问题无关。如果您的 Core Foundation 相关代码代码未能清理并导致泄漏，它会这样做，而不管其他强引用（尽管，诚然，在删除所有其他强引用之前，您通常不会真正体验/检测到泄漏）。

这个问题意味着您担心代码中的泄漏以及 Core Foundation 对象和函数的使用。静态分析器（Xcode 的“产品”菜单上的“分析”，或按`shift`+ `command`+调用`B`）非常擅长诊断代码是否存在泄漏，包括桥接和核心基础。

# c - 在 C 中将二叉树转换为数组（并稍后保存）

> ID：14175205
> 
> 赞同：0
> 
> 时间：2013-01-05T18:57:43.680
> 
> 标签：c, serialization, data-structures, binary-tree

所以，我正在做这个客户应用程序，您可以在其中创建/修改/搜索/列出客户。后来这扩展到通过订单将客户与产品联系起来等等，但我现在的重点只是客户。我已经创建了一个二叉树并且所有这些功能都可以工作，但是我需要一种方法来存储创建的客户以备下次使用。

我想以某种方式我必须将所有客户（在每个节点中找到）转移到一个数组中，然后将该数组写入文件“customer.dat”。花了很多时间。这里有一些代码片段可以帮助更好地理解我有什么功能和结构：

```
typedef struct customer
{
    char Name[MAXNAME];
    char Surname[MAXNAME];
    char ID[MAXID];
    char Address[MAXADDRESS];
} Cstmr;

typedef struct node
{
    Cstmr item;
    struct node * left;
    struct node * right;
} Node;

typedef struct tree
{
    Node * root;
    int size;
} Tree; 
```

以上是结构体，Node 包含 Cstmr 类型的项目和链接的左右节点。树包含一个根节点和大小。

```
void Traverse (const Tree * ptree, void (* pfun)(Cstmr item))
{
    if (ptree != NULL)
        InOrder(ptree->root,pfun);
}

static void InOrder(const Node * root, void(* pfun)(Cstmr item))
{
    if (root != NULL)
    {
    InOrder(root->left, pfun);
    (*pfun)(root->item);
    InOrder(root->right, pfun);
    }
} 
```

这些功能用于列出客户并添加功能

```
void printItem(Cstmr C)
{ 
    printf("%-10s %-10s %-8s\n", C.Name, C.Surname, C.ID);
} 
```

最后以书面形式执行

```
Traverse(tree,printItem); 
```

我试图将 printItem 更改为另一个函数以添加到数组（输出到文件而不是屏幕），但现在事情变得太复杂了！有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:01:41.800

你不能在你的中序函数中间返回——它不会执行你遍历的“右边”。由于您的函数实际上并没有返回任何内容，因此只需删除多余的“返回”应该没有问题。

像这样：

```
static void InOrder(const Node * root, void(* pfun)(Cstmr item))
{
    if (root != NULL)
    {
    InOrder(root->left, pfun);
    (*pfun)(root->item);
    InOrder(root->right, pfun);
    }
} 
```

我还建议您在编译器中启用警告并实际修复您收到的任何警告，因为编译器应该能够注意到您在此处返回是不正确的 [即使它只是“您在不应该返回值时返回值”] .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:03:16.697

对于初学者，您的逻辑中有一个错误，用于进行按顺序遍历。我在这里转载了代码：

```
static void InOrder(const Node * root, void(* pfun)(Cstmr item))
{
    if (root != NULL)
    {
        InOrder(root->left, pfun);
        return (*pfun)(root->item);
        InOrder(root->right, pfun);
    }
} 
```

请注意，您`return`在逻辑中间有一个语句。这意味着在您下降到左子树之后，您将评估当前节点处的函数并返回，然后继续处理右子树。删除该`return`语句应该可以解决此问题。

至于您的问题的一个很好的解决方案 - 有一个相当简单的递归算法，用于将已排序的元素数组转换为完美平衡的二叉搜索树。如果您能够按顺序将二叉搜索树的每个元素写入文件，则可以通过将其读入一个巨大的数组来重建该树，然后从该数组重建 BST。

从数组重建二叉搜索树的逻辑在伪代码中给出：

```
Node* arrayToTree(Item array[], int start, int end) {
    if (start >= end) return NULL;

    int mid = (start + end) / 2;
    Node* result  = /* Convert array[mid] to a Node. */
    result->left  = arrayToTree(array, start, mid);
    result->right = arrayToTree(array, mid + 1, end);

    return result;
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:09:33.273

如果将数据存储在数组中不是必需的，则可以调整函数以使用而不是`printItem`直接写入文件。您还需要将文件句柄传递给您的函数。[`fprintf`](http://www.cplusplus.com/reference/cstdio/fprintf/)`printf`

你的`InOrder`遍历也有点错误。当您立即返回它上面时，该行`InOrder(root->right, pfun);`永远不会执行。仅删除`return`关键字。一旦你确认你的`InOrder`遍历工作正常，尝试进行适当的修改以将它打印到一个文件中（最好使用一个函数指针，就像你用 做的那样`printItem`）。

如果您确实想写入数组，则需要知道树中的项目总数或使用动态容器（在 C 中不可用，除非您自己编写），尽管您可以完成您需要的没有数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T19:31:20.027

正如其他人所说，“返回”会禁用以下代码的执行。你的编译器也应该弹出一个错误，因为你在一个 void 函数中返回一个值。

只需使用类似这样的东西来写出你的数据（没有数组）：

```
/* sure it may be "static"? */
static void InOrder(const Node * root)
{
    if (root != NULL)
    {
    InOrder(root->left);

    Cstmr cust = root->item;
    BUFFERED_WRITE(cust.Name, strlen(cust.Name) + 1);
    BUFFERED_WRITE(cust.Surname, strlen(cust.Surname) + 1);
    BUFFERED_WRITE(cust.ID, strlen(cust.Surname) + 1);
    BUFFERED_WRITE(cust.Address, strlen(cust.Address) + 1);

    InOrder(root->right, pfun);
    }
} 
```

函数 BUFFERED_WRITE 只是一个对文件描述符进行缓冲写入的函数的占位符。它也可以是“write(export_fd, cust.Name, strlen(cust.Name) + 1)”之类的东西。

导入反之亦然，需要额外的边界检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T10:41:29.487

感谢大家的帮助，我已经找到了树到数组问题的解决方案，实际上很简单。

首先，我声明了 Cstmr 类型的数组：

```
Cstmr save[MAXITEMS]; 
```

然后我所要做的就是复制并稍微编辑 printItem(Cstmr C) 函数。而不是 printf，它只是添加到 save[MAXITEMS]。

```
void saveItem(Cstmr C)
{
    int size = TreeItemCount(&id);
    save[size] = C;
    printf("%s...saved", save[size].Name); //just to check that it works
} 
```

后来我创建了另一个函数来检查树是否为空，然后使用 Traverse 函数：

```
void SaveCustomers(Tree*pt)
{
    if (TreeIsEmpty(pt))
        puts("Nothing to save!");
    else
        Traverse(pt,saveItem);
} 
```

感谢所有快速回复！

# project - 在代码块中制作可移植的 SFML 项目

> ID：14175210
> 
> 赞同：0
> 
> 时间：2013-01-05T18:58:10.120
> 
> 标签：project, codeblocks, sfml

我在代码块中使用 SFML 制作了一个游戏作为我的编程项目。问题是，我的老师想要他可以在自己的电脑上编译的格式的源代码。他没有 sfml 也没有代码块。

所以我想知道是否无论如何我可以使我的项目可移植，以便他可以简单地在他自己的电脑上编译它？

不允许只提交 exe 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:26:22.233

您对“便携式”的理解是什么？它们应该在两台 Windows PC 之间或两个不同操作系统之间移植吗？

Code::Blocks 项目本身即使在操作系统之间也总是可移植的，但对于库来说，它在很大程度上取决于所使用的系统。对于两个 Windows 版本，应该有可能提供完整的库（lib、头文件、二进制文件）并简单地使用项目文件中的相对路径。但它仍然需要你和你的老师使用相同的编译器，否则你可能会遇到问题（例如，RC 二进制文件不适用于 GCC 版本 >= 4.7.x）。

但正如安库里奥所说：

> 如果他[你的老师]有任何能力，他编写一个小游戏应该没有问题。

# algorithm - 最大流量和最小流量？

> ID：14175220
> 
> 赞同：2
> 
> 时间：2013-01-05T18:59:33.510
> 
> 标签：algorithm, graph, max-flow

我有一个带有一些边和节点的流网络。在离开该源节点的边上，我想放置一些最小流量，以便在该边上至少有 x 流量（如果这不可能，我想知道这一点）。我已经实现了 Ford-Fulkerson 算法来找到最大流量，但我不确定如何调整我的算法来做到这一点。我考虑过减少离开源节点的边缘的容量，但这对我不起作用。

谁能指导我解决这个问题的正确方向？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:05:10.587

您正在寻找一种算法来计算“具有边缘需求的流”或“具有下限的流”。有很多简单的算法可以解决这个问题。 **[这组注释](http://compgeom.cs.uiuc.edu/~jeffe/teaching/algorithms/notes/18-maxflowext.pdf)**详细介绍了一种可能的方法，但如果您要进行一些快速的 Google 搜索，我敢打赌，您可以找到更多关于此的信息。

希望这可以帮助！

# javascript - 移动包含 youtube 视频的 iframe onresize

> ID：14175223
> 
> 赞同：1
> 
> 时间：2013-01-05T18:59:48.420
> 
> 标签：javascript, jquery, html, iframe

我有一个使用 Youtube API 嵌入的 youtube 视频，以便能够利用自动播放等功能。我真的不是网页设计师，我遇到了一些问题。当我调整窗口大小时，我无法在 iframe 中移动或调整 youtube 视频的大小（移动更重要）。来电：

```
window.onresize 
```

然后改变左或右，居中它不起作用。

这是我的 html，它可能很糟糕，但正如我所说，我不是网页设计师。

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<link rel="stylesheet" type="text/css" href="stylesheet.css">
</head>

<body id="b">
<div id="logo"></div>
<div id="main2"></div>
<div id="yt"></div>

</body>
<script>

var scrollDiv = document.createElement("div");
scrollDiv.className = "scrollbar-measure";
document.body.appendChild(scrollDiv);

// Get the scrollbar width
var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;

// Delete the DIV
document.body.removeChild(scrollDiv);

var youtube=document.getElementById("yt");
youtube.style.width=screen.width-(screen.width/2)+"px";
youtube.style.height=(screen.width-(screen.width/2))/(16/9)+"px";
///YOUTUBE
 var tag = document.createElement('script');
    tag.src = "http://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    var done = false;
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('yt', {
          height: '600',
          width: '1000',
                  left: '300',
          videoId: 'J---aiyznGQ',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
    }

function redirectTo()
{
//replace between "" with anything. Keep the 'http://' if the webpage is a website outside your directory.
window.location.replace("http://www.google.com");}

function onPlayerReady(evt) {
        evt.target.playVideo();
    }

    function onPlayerStateChange(evt) {
        /*var duration=player.getDuration()*1000;
        if (evt.data == YT.PlayerState.PLAYING && !done) {
           setTimeout(stopVideo, duration);
            done = true;
        }*/
                if (evt.data == YT.PlayerState.ENDED){
                $('#ytvid').fadeTo(/*time - millisecond*/2000, /*opacity*/0);
                setTimeout(redirectTo, /*time - millisecond*/2000);
                }
    }
    /*function stopVideo() {
                $('#ytvid').fadeTo(2000, 0);
        player.stopVideo();
    }*/

//OTHER
var i=document.getElementById("main2");
var j=document.getElementById("logo");
var y=document.getElementById("yt");
i.style.width=screen.width+"px";
document.getElementById("b").style.width=screen.width-scrollbarWidth+"px";
j.style.left=(window.innerWidth/2)-(screen.width/16)+"px";

j.style.backgroundSize=screen.width/16+"px";

window.onresize =hs;
function hs()
{
var l=100;
/*i.style.width=window.innerWidth+"px";
i.style.minWidth=screen.width+"px";*/
j.style.left=(window.innerWidth/2)-l+"px";
//y.style.width="100px";

j.style.backgroundSize=screen.width/16+"px";

}
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:07:56.297

看起来您走在正确的轨道上，尽管您可能想尝试一种纯 CSS 方法以使其更容易。如果目标是将视频保持在页面中心，请将 YouTube 视频放在固定宽度的 div 中，并将 margin-left 和 margin-right 设置为 auto。然后，浏览器会在浏览器调整大小时自动将 div（以及包含的视频）居中。

**编辑：**

这是使用 CSS 的 margin:auto 来居中内容的示例：

```
<!DOCTYPE html>
<html>
<head>
<title></title>
<style>
.centered {
    display: block;
    margin: auto;
}
</style>
</head>
<body>
<iframe width="640" height="480" class="centered" src="http://www.youtube.com/embed/J---aiyznGQ?rel=0" frameborder="0" allowfullscreen></iframe>
</body>
</html> 
```

请注意，您必须给它一个宽度（在本例中为 640）才能使其工作。否则，默认情况下 div 是全宽的，即使它的内容不是。

# c# - Glut glutSolidSphere 工作不正确

> ID：14175225
> 
> 赞同：0
> 
> 时间：2013-01-05T19:00:11.330
> 
> 标签：c#, opengl, glut

使用 GLUT 绘制简单球体时遇到问题。当我绘制一个球体时，应用程序只绘制一个黑色形式（我的背景颜色是白色），而当我试图绘制一个线立方体时，我只得到一个黑点。这是我的代码

```
private void init()
{
    Glut.glutInit();
    Glut.glutInitDisplayMode(Glut.GLUT_SINGLE | Glut.GLUT_RGB | Glut.GLUT_DOUBLE);

    Gl.glClearColor(255, 255, 255, 1);

    Gl.glViewport(0, 0, AnT.Width, AnT.Height);

    Gl.glMatrixMode(Gl.GL_PROJECTION);
    Gl.glLoadIdentity();

    Glu.gluPerspective(45, (float)AnT.Width / (float)AnT.Height, 0.1, 200);

    Gl.glMatrixMode(Gl.GL_MODELVIEW);
    Gl.glLoadIdentity();

    Gl.glEnable(Gl.GL_DEPTH_TEST);
    Gl.glEnable(Gl.GL_LIGHTING);
    Gl.glEnable(Gl.GL_LIGHT0);
}

private void draw()
{
    Gl.glClear(Gl.GL_COLOR_BUFFER_BIT | Gl.GL_DEPTH_BUFFER_BIT);

    Gl.glClearColor(255, 255, 255, 1);
    Gl.glLoadIdentity();

    //Glut.glutWireCube(100);
    Glut.glutSolidSphere(1, 16, 16);

    Gl.glPopMatrix();
    Gl.glFlush();
    AnT.Invalidate();
} 
```

我的 init 函数在加载表单和我的绘制函数时被调用 - 在绘制它时。谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:28:40.507

```
Glut.GLUT_SINGLE | Glut.GLUT_RGB | Glut.GLUT_DOUBLE 
```

`GLUT_SINGLE`并且`GLUT_DOUBLE`是互斥的。选一个。

```
Gl.glPopMatrix(); 
```

您缺少相应的`glPushMatrix()`，但对于这个特定的用例，您也不需要。

```
Gl.glClearColor(255, 255, 255, 1); 
```

`glClearColor()`s在`float`0.0 和 1.0 之间。

* * *

试试这个顺序：

```
private void init()
{
    Glut.glutInit();
    Glut.glutInitDisplayMode(Glut.GLUT_SINGLE | Glut.GLUT_RGB);
    Gl.glViewport(0, 0, AnT.Width, AnT.Height);
}

private void draw()
{
    Gl.glClearColor(1, 1, 1, 1);
    Gl.glClear(Gl.GL_COLOR_BUFFER_BIT | Gl.GL_DEPTH_BUFFER_BIT);

    Gl.glMatrixMode(Gl.GL_PROJECTION);
    Gl.glLoadIdentity();
    Glu.gluPerspective(45, (float)AnT.Width / (float)AnT.Height, 0.1, 200);

    Gl.glMatrixMode(Gl.GL_MODELVIEW);
    Gl.glLoadIdentity();
    Gl.glTranslatef(0, 0, -5);

    Gl.glEnable(Gl.GL_DEPTH_TEST);
    Gl.glEnable(Gl.GL_CULL_FACE);
    Gl.glEnable(Gl.GL_LIGHTING);
    Gl.glEnable(Gl.GL_LIGHT0);

    Glut.glutSolidSphere(1, 16, 16);

    // Gl.glDisable(Gl.GL_LIGHTING);
    // Glut.glutWireCube(1);

    Gl.glFinish();
    AnT.Invalidate();
} 
```

# ruby-on-rails - 路线不匹配

> ID：14175227
> 
> 赞同：0
> 
> 时间：2013-01-05T19:00:11.933
> 
> 标签：ruby-on-rails

我无法使用 link_to 在控制器中调用操作。

我在我的 routes.rb 文件中定义了一个到预订控制器的路由（如下所述），我想访问“my/reservations”控制器中的“create_commercial”操作。

所以如果我使用`rake routes | grep 'reservation'`

```
 visitor_my_reservations GET    (/:locale)/my/reservations/visitor(.:format)                               {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"visitor"}
           create_commercial_my_reservations POST   (/:locale)/my/reservations/create_commercial(.:format)                     {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"create_commercial"}
                      confirm_my_reservation PUT    (/:locale)/my/reservations/:id/confirm(.:format)                           {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"confirm"}
                          pay_my_reservation GET    (/:locale)/my/reservations/:id/pay(.:format)                               {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"pay"}
              payment_success_my_reservation GET    (/:locale)/my/reservations/:id/payment_success(.:format)                   {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"payment_success"}
               payment_cancel_my_reservation GET    (/:locale)/my/reservations/:id/payment_cancel(.:format)                    {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"payment_cancel"}
                             my_reservations POST   (/:locale)/my/reservations(.:format)                                       {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"create"}
                          new_my_reservation GET    (/:locale)/my/reservations/new(.:format)                                   {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"new"}
                         edit_my_reservation GET    (/:locale)/my/reservations/:id/edit(.:format)                              {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"edit"}
                              my_reservation GET    (/:locale)/my/reservations/:id(.:format)                                   {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"show"}
                                             PUT    (/:locale)/my/reservations/:id(.:format)                                   {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"update"}
                                             DELETE (/:locale)/my/reservations/:id(.:format)                                   {:locale=>/en|en-US|en-GB/, :controller=>"my/reservations", :action=>"destroy"}
                   show_test_my_reservations GET    /test/my/reservations/show(.:format)                                       {:controller=>"test/my/reservations", :action=>"show"}
                     new_test_my_reservation GET    /test/my/reservations/new(.:format)                                        {:controller=>"test/my/reservations", :action=>"new"} 
```

所以我然后尝试：-

```
<td><%= link_to 'book', create_commercial_my_reservations_path %></td> 
```

我也试试这个： -

```
<%= link_to('Book', {:controller => 'my/reservations', :action => 'create_commercial', :method => :post}) %> 
```

我在控制台窗口中看到了两个选项：-

```
Started GET "/en-GB/my/reservations/create_commercial" for 127.0.0.1 at Sat Jan 05 18:29:30 +0000 2013
  Processing by My::ReservationsController#show as HTML
  Parameters: {"id"=>"create_commercial", "locale"=>"en-GB"}
Geokit is using the domain: localhost 
```

URL 是正确的，但正在调用动作“show”，方法是“get”，而不是“post”。

有没有人知道我可能做错了什么......非常感谢指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:03:22.830

尝试...

```
<%= link_to 'book', create_commercial_my_reservations_path, :method => :post %> 
```

需要注意的是，链接到 #create 操作而不是 #new 操作似乎有点奇怪，但我不知道您的应用程序......

# sql-server - 使用 nhibernate t-sql 表值用户定义函数

> ID：14175229
> 
> 赞同：1
> 
> 时间：2013-01-05T19:00:33.190
> 
> 标签：sql-server, nhibernate, hql, user-defined-functions

是否可以将*table t-sql 表值用户定义*函数用作 HQL 查询的一部分？

这里[通过用户定义的函数输出进行休眠过滤](https://stackoverflow.com/questions/1706259/nhibernate-filtering-by-user-defined-function-output)是一个如何创建自定义方言扩展的示例，但在此示例中使用了标量 UDF。

假设我有以下 t-sql UDT

```
CREATE FUNCTION [dbo].[getSuitableProjects]  
(
    @userID INT  
)  
RETURNS @result TABLE   
(  
    ProjectID INT  
)  
AS  
-- body of the function .. 
```

我希望能够编写以下 hql - 第二行是伪代码，只是我想调用我的函数作为 hql 查询的一部分 - 真正的查询更复杂，它具有获取连接等。

```
StringBuilder hql = new StringBuilder();  
hql.AppendLine("select p from Projects p WHERE p.ProjectID IN");  
hql.AppendLine("(run with parameter -> getSuitableProjects(:userID))");

IQuery q = UOW.Session.CreateQuery(hql.ToString());  
q.SetInt32("userID", userID); 
```

我花了一些时间寻找答案，但没有结果。可能吗 ？
先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T18:29:15.687

也许有人会发现它很有用，我以以下查询结束

```
var query = UOW.Session.QueryOver<Project>();
query = query.Where(...) //where  citeria which can be expressed in QueryOver
query = query.Fetch(z => z.Items).Eager.TransformUsing(Transformers.DistinctRootEntity);

var criteria = query.UnderlyingCriteria
.Add(Expression.Sql("{alias}.ID IN (SELECT ProjectID FROM dbo.getSuitableProjects(12))")) 
```

我的目标是预先加载项目（*z.Items*）并同时限制为仅可供用户使用的项目 -> 此逻辑位于我的表值 UDF 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T00:51:57.387

不，您不能在 HQL 中使用表值函数。

请改用 SQL ( `CreateSQLQuery(...)`)。

# visual-studio - IIS 上的 Communicator API

> ID：14175231
> 
> 赞同：0
> 
> 时间：2013-01-05T19:00:48.160
> 
> 标签：visual-studio, iis

我有以下错误：

> 由于以下错误，检索具有 CLSID {8885370D-B33E-44B7-875D-28E403CF9270} 的组件的 COM 类工厂失败：80080005 服务器执行失败（来自 HRESULT 的异常：0x80080005 (CO_E_SERVER_EXEC_FAILURE)）。

尝试在 iis 中使用 office communicator api 时。

此 api (com) 在 Visual Studio 上成功运行。在 iis 上运行此 Web 应用程序后，我在 iis 应用程序池中`platform target`更改`x86`并启用**32 位应用程序。**

知道是什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:35:13.160

当 Visual Studio 和 Communicator 都没有在管理员权限下运行时，我遇到了这个错误。

# android - 如何在 Android 数据库查询和选择中的 OR 语句中搜索 NULL

> ID：14175233
> 
> 赞同：5
> 
> 时间：2013-01-05T19:00:59.910
> 
> 标签：android, null, where

关于数据库查询的几个查询：

所以我有以下数据库查询，它有一个 WHERE 语句，其中包括三个字符串变量（rackingSystem、制造商、“Amber Risk”）。

```
public Cursor fetchComponentsAndSpecForManufacturer(long inspectionId, String rackingSystem, String manufacturer) {
    Cursor mCursor =
            rmDb.query(true, DAMAGED_COMPONENTS_TABLE, new String[] {
                    DAMAGED_COMPONENT_ID,
                    LOCATION_LINK,
                    RUN_LINK,
                    AREA_LINK,
                    INSPECTION_LINK,
                    LOCATION_REF,
                    RACKING_SYSTEM,
                    COMPONENT,
                    COMPONENT_TYPE,
                    QUANTITY,
                    POSITION,
                    RISK,
                    ACTION_REQUIRED,
                    NOTES_GENERAL,
                    MANUFACTURER,
                    TEXT1,
                    TEXT2,
                    TEXT3,
                    TEXT4,
                    NOTES_SPEC,
                    SPEC_SAVED}, 
                    INSPECTION_LINK + " = " + inspectionId + " AND " + RACKING_SYSTEM + " = ? AND " + MANUFACTURER + " = ? AND " + RISK + " = ? ", 
                    new String[] {rackingSystem, manufacturer, "Amber Risk"},
                    COMPONENT_TYPE + ", " + TEXT1 + ", " + TEXT2 + ", " + TEXT3 + ", " + TEXT4 + ", " + NOTES_SPEC,
                    null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
} 
```

问题一：

我如何搜索 NULL，因为在上面的示例中，制造商在数据库中可能为 NULL（因为用户可能尚未为该位在数据库中输入任何内容）。

问题2：

我可以在 WHERE 语句中包含 OR 语句吗？因此，目前我正在搜索所有“琥珀风险”的记录，但我还需要在此列表中包含“红色风险”的条目。如果我能做到这一点，我应该如何编辑 WHERE 语句？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:03:40.450

> 如何搜索 NULL，因为在上面的示例中，制造商可能在数据库中为 NULL

使用`MANUFACTURER + " IS NULL"`.

> 我可以在 WHERE 语句中包含 OR 语句吗？

是的。让我们搜索 null 或空的制造商：

```
MANUFACTURER + " IS NULL OR " + MANUFACTURER + " = ''" 
```

* * *

> 因此，目前我正在搜索所有“琥珀风险”的记录，但我还需要在此列表中包含“红色风险”的条目。

```
INSPECTION_LINK + " = " + inspectionId + " AND " + RACKING_SYSTEM + " = ? AND " + 
        MANUFACTURER + " IS NULL AND (" + RISK + " = ? OR " + RISK + " = ?)", 
new String[] {rackingSystem, manufacturer, "Amber Risk", "Red Risk"}, 
```

# mysql - 根据主键将缺失的记录添加到mysql表中

> ID：14175236
> 
> 赞同：1
> 
> 时间：2013-01-05T19:01:07.707
> 
> 标签：mysql, rows, records

我有一个有成员的mysql表，大约有1400条记录，我打算换一个新的会员软件（amember v3 to amemberv4）。问题是成员 v4 是一个全新的程序，因此数据库表不能有任何丢失的记录，否则它将根据主键重新排序。例如，成员表中的成员 ID 与产品表中的产品 ID 相关联。有一个引用此维度的事实表。

我的问题是如何添加具有缺失的起始成员 ID 的空记录。例如，该表以成员 ID 4 而不是 1、2、3 开头。我需要帮助找到解决方案来根据丢失的会员 ID 添加这些丢失的记录。我确实根据第一个表（membersold，members）制作了第二个表，因为我确信我需要将它们相互连接以创建更新语句来添加那些缺失的记录。大约有 7 列将只是空值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:35:44.547

首先：Jan Dvorak 和 Michael Berkowski 所说的都是绝对正确的。因此，**请仔细检查**您是否*真的*需要此 hack，因为您不需要的可能性非常*大*。

但以防万一，只是为了它，这会将所有 ID 插入到一个表中 - 只要它们是主键，并且它们不存在。

几乎任何其他方式都更好（除了可能手工完成），但需要 MySQL 或其他语言的过程。

```
-- insert IDs from 1 to 1701, plus another field "otherfield" with value "othervalue"
-- The maximum ID here is about 2400, but you said you needed at most 1400.
-- And you can add 1000 instead of 1 to the value of 'id' and run it again
-- to insert ids from 1000 to 2701 :-)

INSERT IGNORE INTO yourtable
      (id, otherfield)
SELECT id, 'othervalue'
FROM (
    SELECT 1+a.x+b.x*7+c.x*49+d.x*343 AS id FROM
    ( SELECT 0 AS x UNION SELECT 1 UNION SELECT 2 UNION
      SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 ) AS a
    JOIN
    ( SELECT 0 AS x UNION SELECT 1 UNION SELECT 2 UNION
      SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 ) AS b
    JOIN
    ( SELECT 0 AS x UNION SELECT 1 UNION SELECT 2 UNION
      SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 ) AS c
    JOIN
    ( SELECT 0 AS x UNION SELECT 1 UNION SELECT 2 UNION
      SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 ) AS d
   ) AS generated
WHERE generated.id < 1701; 
```

正如我所说，这是一种非常丑陋的做事方式。

如果您有任何可用的语言，您可以生成插入查询并运行它们，例如在 bash 中：

```
( for id in $( seq 1 1400 ); do
    echo "INSERT IGNORE INTO mytable ( id, otherfield ) VALUES ( $id, 'hello' );"
done ) | mysql databasename 
```

或者在 PHP、python 或 Perl 中——你只需要生成一个 SQL INSERT 语句的形式

```
INSERT IGNORE INTO mytable ( id ) VALUES ( ... ); 
```

并用递增计数器填充空白，然后将语句发送到数据库。将`IGNORE`跳过已经存在的值。如何填空取决于您选择的语言。如果您需要填充其他字段，请`id`在空格后面输入名称及其默认值。

# javascript - css3 转换后的元素未触发 onClick 事件

> ID：14175240
> 
> 赞同：0
> 
> 时间：2013-01-05T19:01:28.033
> 
> 标签：javascript, events, css, transform, css-transitions

//编辑我的大脑陷入了困境。一切正常，这个问题是错误的和过时的

如果我旋转一个元素并尝试单击具有绑定 eventListener (onClick) 的元素，则该事件不会触发（悬停也关闭）。如果我删除转换，事件会按预期触发。我知道，通过进行转换，元素只出现在不同的位置，但“实际上仍在其原始位置”。但是让一个元素转换，却杀死它所有的 eventListeners 似乎很愚蠢..？我应该深入研究什么方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:20:32.330

不确定您使用的是原始 JavaScript 还是 jQuery，但我没有问题：

* * *

```
div {
width: 50px;
height:50px;
Background: blue;
-WebKit-transform:rotate(45deg) translate(100px, 100px);
} 
```

* * *

```
$('div').click(function(){
$(this).hide();
}); 
```

* * *

[http://jsfiddle.net/JNM6x/](http://jsfiddle.net/JNM6x/)

* * *

也许你可以发布你的代码？可能是其他事情给您带来麻烦。

# matlab - 添加向量和矩阵单元

> ID：14175253
> 
> 赞同：1
> 
> 时间：2013-01-05T19:02:17.393
> 
> 标签：matlab

我正在尝试修改我的代码以使用向量并且无法解决看起来很简单的问题

我收到以下错误

```
"??? Error using ==> plus
Number of array dimensions must match for binary array op.

Error in ==> mesh_analysis at 57
 Y_mtx(1,1,1:N)=Y_mtx(1,1,1:N)+5./(R3*Zof_R1_C1_L1parrC2);" 
```

现在，`Zof_R1_C1_L1parrC2`是一个长度为 N 的向量，R3 是一个标量/数字

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:18:02.433

`Y_mtx(1,1,1:N)`is`[1 1 N]`和因此 is的大小与is或的大小**不同**。`Zof_R1_C1_L1parrC2``[1 N]``[N 1]`

请注意，尽管元素的数量相同，但大小却**不同**。

您可以使用`permute`来更改 to 的`Zof_...`大小`[1 1 N]`。

# android - android 中主 UI 线程的 Looper.prepare() 和 Looper.loop() 方法调用

> ID：14175257
> 
> 赞同：1
> 
> 时间：2013-01-05T19:02:43.983
> 
> 标签：android, multithreading, looper

在 android 中，我们只是创建 UI 线程，`Handler`因为主 UI 线程已经有了它的`Looper`.

我想知道框架代码中 UI 线程的调用位置`Looper.prepare`和位置。`Looper.loop`我正在挖掘框架代码几个小时试图找到它。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:12:07.207

它在类`android.app.ActivityThread`中的`main`方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:06:44.267

如果你不得不求助于 using `Looper`，而你不知道问题的答案，那么你可能做的事情太复杂了。在大多数情况下，Android 完全自主地处理这类事情，你真的不必担心它......

只需从 GUI 线程制作处理程序，放入 onResume() 或类似的东西就可以了。

```
Handler handler;

@Override
protected void onResume()
{
    super.onResume();

    handler = new Handler();
} 
```

否则，您可以使用该`runOnUiThread`命令。

```
runOnUiThread(new Runnable() {
    public void run() {
        the_textView.setText(someText);
    }}); 
```

# c# - 为什么用 AesCryptoServiceProvider 第二次解密这个字符串不相等？

> ID：14175272
> 
> 赞同：3
> 
> 时间：2013-01-05T19:04:42.860
> 
> 标签：c#, c#-4.0, encryption, character-encoding, aes

我在 C#（VS2012，.NET 4.5）中加密和解密文本时遇到问题。具体来说，当我加密并随后解密一个字符串时，输出与输入不同。然而，奇怪的是，如果我复制加密的输出并将其硬编码为字符串文字，解密就可以了。以下代码示例说明了该问题。我究竟做错了什么？

```
var key = new Rfc2898DeriveBytes("test password", Encoding.Unicode.GetBytes("test salt"));
var provider = new AesCryptoServiceProvider { Padding = PaddingMode.PKCS7, KeySize = 256 };
var keyBytes = key.GetBytes(provider.KeySize >> 3);
var ivBytes = key.GetBytes(provider.BlockSize >> 3);
var encryptor = provider.CreateEncryptor(keyBytes, ivBytes);
var decryptor = provider.CreateDecryptor(keyBytes, ivBytes);

var testStringBytes = Encoding.Unicode.GetBytes("test string");
var testStringEncrypted = Convert.ToBase64String(encryptor.TransformFinalBlock(testStringBytes, 0, testStringBytes.Length));

//Prove that the encryption has resulted in the following string
Debug.WriteLine(testStringEncrypted == "cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc="); //Result: True

//Decrypt the encrypted text from a hardcoded string literal
var encryptedBytes = Convert.FromBase64String("cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc=");
var testStringDecrypted = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length));

//Decrypt the encrypted text from the string result of the encryption process
var encryptedBytes2 = Convert.FromBase64String(testStringEncrypted);
var testStringDecrypted2 = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes2, 0, encryptedBytes2.Length));

//encryptedBytes and encryptedBytes2 should be identical, so they should result in the same decrypted text - but they don't: 
Debug.WriteLine(testStringDecrypted == "test string"); //Result: True
Debug.WriteLine(testStringDecrypted2 == "test string"); //Result: FALSE
//testStringDecrypted2 is now "૱﷜ୱᵪ㭈盐æing". Curiously, the last three letters are the same.
//WTF? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T19:41:15.260

这似乎是 AES ICryptoTransform 的 .NET 框架实现中的一个错误，您使用您的行引用：

```
provider.CreateDecryptor(keyBytes, ivBytes); 
```

[为CanReuseTransform](http://msdn.microsoft.com/en-us/library/system.security.cryptography.icryptotransform.canreusetransform.aspx)返回 true但是它似乎在解密后没有清除输入缓冲区。有一些解决方案可以让它发挥作用。

**选项 1** 创建第二个解密器并用它解密第二个字符串。

```
var key = new Rfc2898DeriveBytes("test password", Encoding.Unicode.GetBytes("test salt"));
var provider = new AesCryptoServiceProvider { Padding = PaddingMode.PKCS7, KeySize = 256 };
var keyBytes = key.GetBytes(provider.KeySize >> 3);
var ivBytes = key.GetBytes(provider.BlockSize >> 3);
var encryptor = provider.CreateEncryptor(keyBytes, ivBytes);
var decryptor = provider.CreateDecryptor(keyBytes, ivBytes);
var decryptor2 = provider.CreateDecryptor(keyBytes, ivBytes);

var testStringBytes = Encoding.Unicode.GetBytes("test string");
var testStringEncrypted = Convert.ToBase64String(encryptor.TransformFinalBlock(testStringBytes, 0, testStringBytes.Length));

//Prove that the encryption has resulted in the following string
Console.WriteLine(testStringEncrypted == "cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc="); //Result: True

//Decrypt the encrypted text from a hardcoded string literal
var encryptedBytes = Convert.FromBase64String("cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc=");

var testStringDecrypted = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length));

//Decrypt the encrypted text from the string result of the encryption process
var encryptedBytes2 = Convert.FromBase64String(testStringEncrypted);

var testStringDecrypted2 = Encoding.Unicode.GetString(decryptor2.TransformFinalBlock(encryptedBytes2, 0, encryptedBytes2.Length));

//encryptedBytes and encryptedBytes2 should be identical, so they should result in the same decrypted text - but they don't: 
Console.WriteLine(testStringDecrypted == "test string"); //Result: True
Console.WriteLine(testStringDecrypted2 == "test string"); //Result: True

Console.Read(); 
```

**选项 2** 使用 RijandaelManaged（或 AesManaged）而不是 AesCryptoServiceProvider，它应该是相同的算法（尽管 AesCryptoServiceProvider 和 AesManaged 都将块大小限制为 128）

```
var key = new Rfc2898DeriveBytes("test password", Encoding.Unicode.GetBytes("test salt"));
var provider = new RijndaelManaged { Padding = PaddingMode.PKCS7, KeySize = 256 };
var keyBytes = key.GetBytes(provider.KeySize >> 3);
var ivBytes = key.GetBytes(provider.BlockSize >> 3);
var encryptor = provider.CreateEncryptor(keyBytes, ivBytes);
var decryptor = provider.CreateDecryptor(keyBytes, ivBytes);

var testStringBytes = Encoding.Unicode.GetBytes("test string");
var testStringEncrypted = Convert.ToBase64String(encryptor.TransformFinalBlock(testStringBytes, 0, testStringBytes.Length));

//Prove that the encryption has resulted in the following string
Console.WriteLine(testStringEncrypted == "cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc="); //Result: True

//Decrypt the encrypted text from a hardcoded string literal
var encryptedBytes = Convert.FromBase64String("cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc=");

var testStringDecrypted = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length));

//Decrypt the encrypted text from the string result of the encryption process
var encryptedBytes2 = Convert.FromBase64String(testStringEncrypted);

var testStringDecrypted2 = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes2, 0, encryptedBytes2.Length));

//encryptedBytes and encryptedBytes2 should be identical, so they should result in the same decrypted text - but they don't: 
Console.WriteLine(testStringDecrypted == "test string"); //Result: True
Console.WriteLine(testStringDecrypted2 == "test string"); //Result: True

Console.Read(); 
```

**选项 3：** 改用 using 语句

```
var key = new Rfc2898DeriveBytes("test password", Encoding.Unicode.GetBytes("test salt"));
var provider = new AesCryptoServiceProvider { Padding = PaddingMode.PKCS7, KeySize = 256 };
var keyBytes = key.GetBytes(provider.KeySize >> 3);
var ivBytes = key.GetBytes(provider.BlockSize >> 3);
var encryptor = provider.CreateEncryptor(keyBytes, ivBytes);

var testStringBytes = Encoding.Unicode.GetBytes("test string");
var testStringEncrypted = Convert.ToBase64String(encryptor.TransformFinalBlock(testStringBytes, 0, testStringBytes.Length));

//Prove that the encryption has resulted in the following string
Console.WriteLine(testStringEncrypted == "cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc="); //Result: True

//Decrypt the encrypted text from a hardcoded string literal
var encryptedBytes = Convert.FromBase64String("cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc=");

string testStringDecrypted, testStringDecrypted2;

using (var decryptor = provider.CreateDecryptor(keyBytes, ivBytes))
{
    testStringDecrypted =
        Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length));
}

//Decrypt the encrypted text from the string result of the encryption process
var encryptedBytes2 = Convert.FromBase64String(testStringEncrypted);

using (var decryptor = provider.CreateDecryptor(keyBytes, ivBytes))
{
    testStringDecrypted2 =
        Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes2, 0, encryptedBytes2.Length));
}

//encryptedBytes and encryptedBytes2 should be identical, so they should result in the same decrypted text - but they don't: 
Console.WriteLine(testStringDecrypted == "test string"); //Result: True
Console.WriteLine(testStringDecrypted2 == "test string"); //Result: True

Console.Read(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T20:11:26.827

即使您在两种情况下都使用相同的输入，但问题是第一次调用后，decryptor.TransformFinalBlock() 的行为发生了变化。值是在字符串文字还是变量中没有区别。此页面似乎表明解密器在第一次使用后将自身“重置”到某个初始状态：

[http://www.pcreview.co.uk/forums/icryptotransform-transformfinalblock-behavior-bug-t1233029.html](http://www.pcreview.co.uk/forums/icryptotransform-transformfinalblock-behavior-bug-t1233029.html)

似乎您可以通过重新调用`provider.CreateDecryptor(keyBytes, ivBytes)`为您想要执行的每个解密获取一个新的解密器来解决这个问题：

```
 //Decrypt the encrypted text from a hardcoded string literal
        var encryptedBytes = Convert.FromBase64String("cc1zurZinx4yxeSB0XDzVziEUNJlFXsLzD2p9TWnxEc=");
        var testStringDecrypted = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length));

        decryptor = provider.CreateDecryptor(keyBytes, ivBytes);

        //Decrypt the encrypted text from the string result of the encryption process
        var encryptedBytes2 = Convert.FromBase64String(testStringEncrypted);
        var testStringDecrypted2 = Encoding.Unicode.GetString(decryptor.TransformFinalBlock(encryptedBytes2, 0, encryptedBytes2.Length)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:57:08.443

正如评论中所提到的，我假设这是一个重用解密器的问题，它可能仍然具有第一次解密的​​最后一个块处于其状态，所以它不是从头开始，你会得到奇怪的结果。

实际上，前几天我不得不编写一个 AES 字符串加密器/解密器，我已经将其包含在这里，以及单元测试（需要 Xunit）。

```
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using Xunit;

public interface IStringEncryptor {
    string EncryptString(string plainText);
    string DecryptString(string encryptedText);
}

public class AESStringEncryptor : IStringEncryptor {
    private readonly Encoding _encoding;
    private readonly byte[] _key;
    private readonly Rfc2898DeriveBytes _passwordDeriveBytes;
    private readonly byte[] _salt;

    /// <summary>
    /// Overload of full constructor that uses UTF8Encoding as the default encoding.
    /// </summary>
    /// <param name="key"></param>
    /// <param name="salt"></param>
    public AESStringEncryptor(string key, string salt)
        : this(key, salt, new UTF8Encoding()) {
    }

    public AESStringEncryptor(string key, string salt, Encoding encoding) {
        _encoding = encoding;
        _passwordDeriveBytes = new Rfc2898DeriveBytes(key, _encoding.GetBytes(salt));
        _key = _passwordDeriveBytes.GetBytes(32);
        _salt = _passwordDeriveBytes.GetBytes(16);
    }

    /// <summary>
    /// Encrypts any string to a Base64 string
    /// </summary>
    /// <param name="plainText"></param>
    /// <exception cref="ArgumentNullException">String to encrypt cannot be null or empty.</exception>
    /// <returns>A Base64 string representing the encrypted version of the plainText</returns>
    public string EncryptString(string plainText) {
        if (string.IsNullOrEmpty(plainText)) {
            throw new ArgumentNullException("plainText");
        }

        using (var alg = new RijndaelManaged { BlockSize = 128, FeedbackSize = 128, Key = _key, IV = _salt })
        using (var ms = new MemoryStream())
        using (var cs = new CryptoStream(ms, alg.CreateEncryptor(), CryptoStreamMode.Write)) {
            var plainTextBytes = _encoding.GetBytes(plainText);

            cs.Write(plainTextBytes, 0, plainTextBytes.Length);
            cs.FlushFinalBlock();

            return Convert.ToBase64String(ms.ToArray());
        }
    }

    /// <summary>
    /// Decrypts a Base64 string to the original plainText in the given Encoding
    /// </summary>
    /// <param name="encryptedText">A Base64 string representing the encrypted version of the plainText</param>
    /// <exception cref="ArgumentNullException">String to decrypt cannot be null or empty.</exception>
    /// <exception cref="CryptographicException">Thrown if password, salt, or encoding is different from original encryption.</exception>
    /// <returns>A string encoded</returns>
    public string DecryptString(string encryptedText) {
        if (string.IsNullOrEmpty(encryptedText)) {
            throw new ArgumentNullException("encryptedText");
        }

        using (var alg = new RijndaelManaged { BlockSize = 128, FeedbackSize = 128, Key = _key, IV = _salt })
        using (var ms = new MemoryStream())
        using (var cs = new CryptoStream(ms, alg.CreateDecryptor(), CryptoStreamMode.Write)) {
            var encryptedTextBytes = Convert.FromBase64String(encryptedText);

            cs.Write(encryptedTextBytes, 0, encryptedTextBytes.Length);
            cs.FlushFinalBlock();

            return _encoding.GetString(ms.ToArray());
        }
    }
}

public class AESStringEncryptorTest {
    private const string Password = "TestPassword";
    private const string Salt = "TestSalt";

    private const string Plaintext = "This is a test";

    [Fact]
    public void EncryptionAndDecryptionWorkCorrectly() {
        var aesStringEncryptor = new AESStringEncryptor(Password, Salt);

        string encryptedText = aesStringEncryptor.EncryptString(Plaintext);

        Assert.NotEqual(Plaintext, encryptedText);

        var aesStringDecryptor = new AESStringEncryptor(Password, Salt);

        string decryptedText = aesStringDecryptor.DecryptString(encryptedText);

        Assert.Equal(Plaintext, decryptedText);
    }

    [Fact]
    public void EncodingsWorkWhenSame()
    {
        var aesStringEncryptor = new AESStringEncryptor(Password, Salt, Encoding.ASCII);

        string encryptedText = aesStringEncryptor.EncryptString(Plaintext);

        Assert.NotEqual(Plaintext, encryptedText);

        var aesStringDecryptor = new AESStringEncryptor(Password, Salt, Encoding.ASCII);

        string decryptedText = aesStringDecryptor.DecryptString(encryptedText);

        Assert.Equal(Plaintext, decryptedText);
    }

    [Fact]
    public void EncodingsFailWhenDifferent() {
        var aesStringEncryptor = new AESStringEncryptor(Password, Salt, Encoding.UTF32);

        string encryptedText = aesStringEncryptor.EncryptString(Plaintext);

        Assert.NotEqual(Plaintext, encryptedText);

        var aesStringDecryptor = new AESStringEncryptor(Password, Salt, Encoding.UTF8);

        Assert.Throws<CryptographicException>(() => aesStringDecryptor.DecryptString(encryptedText));
    }

    [Fact]
    public void EncryptionAndDecryptionWithWrongPasswordFails()
    {
        var aes = new AESStringEncryptor(Password, Salt);

        string encryptedText = aes.EncryptString(Plaintext);

        Assert.NotEqual(Plaintext, encryptedText);

        var badAes = new AESStringEncryptor(Password.ToLowerInvariant(), Salt);

        Assert.Throws<CryptographicException>(() => badAes.DecryptString(encryptedText));
    }

    [Fact]
    public void EncryptionAndDecryptionWithWrongSaltFails()
    {
        var aes = new AESStringEncryptor(Password, Salt);

        string encryptedText = aes.EncryptString(Plaintext);

        Assert.NotEqual(Plaintext, encryptedText);

        var badAes = new AESStringEncryptor(Password, Salt.ToLowerInvariant());

        Assert.Throws<CryptographicException>(() => badAes.DecryptString(encryptedText));
    }
} 
```

# sql - 需要帮助只选择所有孩子都有关闭日期的案例

> ID：14175286
> 
> 赞同：0
> 
> 时间：2013-01-05T19:06:27.080
> 
> 标签：sql, sql-server, tsql

我知道标题令人困惑，但我需要帮助确定哪些法庭案件中与该案件相关的所有孩子都具有 programClosureDate。我可以运行这个查询：

```
CaseInfo Table
CaseID,
CaseNumber,
CaseName

CaseChild Table
CaseID,           FK to CaseInfo
ChildPartyID, FK to PartyID in Party table
ProgramClosureDate

Party Table
ID,
PartyID,
Firstname,
LastName

SELECT           ci.CaseNumber, ci.CaseName, p.firstname+' '+p.lastname AS child, 
                 ci.programClosureDate
FROM             CaseInfo ci JOIN
                 CaseChild cc ON ci.CaseID = cc.CaseID JOIN
                 Party p ON cc.ChildPartyID = p.PartyID

WHERE            cc.ProgramClosureDate IS NOT NULL                    
ORDER BY         ci.CaseName 
```

但这只是给了我有 programClosureDate IS NOT NULL 的孩子。
任何帮助是极大的赞赏。安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:14:24.917

你可以使用这个 WHERE 条件

```
Where CaseID not in (Select CaseID  from CaseChild ProgramClosureDate IS NULL ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:23:04.530

此查询为您提供所有孩子都有关闭日期的情况。

```
select CaseId
from CaseChild cc
group by CaseId
having count(*) = count(cc.ProgramClosureDate) 
```

它使用了一个小技巧。. . `count(*)`是每种情况下的记录`count(cc.ProgramCLosureDate)`数，是非空关闭日期的数量。当所有案件都结案时，这些都是相同的。

如果您想了解更多信息，可以加入：

```
select ci.CaseNumber, ci.CaseName, p.firstname+' '+p.lastname AS child, 
       ci.programClosureDate
from (select CaseId
      from CaseChild cc
      group by CaseId
      having count(*) = count(cc.ProgramClosureDate)
     ) closed join
     CaseInfo ci
     on closed.CaseId = ci.CaseId join
     Party p
     ON cc.ChildPartyID = p.PartyID
order by ci.CaseName 
```

上面的子查询用于定义其余查询的总体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T06:54:07.380

另一种方法...我不确定建议的不同方法的性能，最好进行测试。

```
;WITH OpenCases AS
(
    SELECT DISTINCT CaseID
    FROM CaseChild
    WHERE ProgramClosureDate IS NULL
)
SELECT   ci.CaseNumber
        ,ci.CaseName
        ,child  = p.firstname+' '+p.lastname
        ,ci.programClosureDate
FROM CaseInfo   ci 
JOIN CaseChild  cc  ON ci.CaseID = cc.CaseID
JOIN OpenCases  oc  ON ci.CaseID != oc.CaseID
JOIN Party      p   ON cc.ChildPartyID = p.PartyID
WHERE cc.ProgramClosureDate IS NOT NULL                    
ORDER BY ci.CaseName 
```

# android - 订单号按字母顺序

> ID：14175289
> 
> 赞同：0
> 
> 时间：2013-01-05T19:07:04.547
> 
> 标签：android, sqlite

在我的数据库 sqlite 中，我有一列将浮点数和时间存储为字符串，为什么当我尝试使用此查询对它们进行排序时

```
select... order by cast("+filter+" as real) 
```

以错误的顺序返回我的数字列：

```
 22,5
    23
    23,5
    23
    23,5
    24,5
    24 
```

或者我的时代专栏也有这个错误的顺序：

```
00:56
00:57
00:52
00:46 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:16:21.340

尝试

```
select... order by cast(replace("+filter+",',','.') as real) 
```

Sqlite 期望点，而不是逗号，作为小数部分分隔符。它还默默地忽略不可转换的尾部，因此 '24,5' 被转换为 24.0。

在您的时间列中，如果您将其排序为字符串，而不是强制转换为浮点数，它将被很好地排序。但是如果你出于某种原因想要转换它，你可以用 . 将冒号变成点`replace`。

# javascript - $.getJSON 结果转化为 html

> ID：14175293
> 
> 赞同：0
> 
> 时间：2013-01-05T19:07:22.933
> 
> 标签：javascript, jquery, html, getjson, handlebars.js

我在这里阅读了一些示例，但是我仍然有点卡住。我并从格式如下的 api 获取提要

```
{
total:123,
id: "1234",
results: [
           {
           id: "1234",
           name: "bobs market",
           phone: "123-456-7890",
           othervalue: "33333333",
           onemore: "get this"
           },
           {
           id: "1235",
           name: "jans market",
           phone: "123-456-7899",
           othervalue: "33333353",
           onemore: "get this one"
           }
         ]
} 
```

我正在尝试使用 $.getJSON 功能循环遍历每条记录并在 div 中显示每个业务，其 id 为 #bizresults，因此生成的 html 看起来像这样

```
<div id="business">
      <h4><a href=#>Business Name</a></h4>
      <p id="phone">555-555-5555</p>
      <p id="adr">
      <span id="street-address">12 Main Street</span>
      <span id="locality">Sacramento</span>
      <span id="region">CA</span>
</div> 
```

我似乎在脚本中得到了结果，我可以在 Chrome 开发控制台中看到它们，但是我似乎无法将输出输出到我的 div。

****接受我查看@Handlebars.js 的建议****我仍然不完全在那里-**

 **```
<script id="biz_template" type="text/x-handlebars-template">

    <div id="businesses">
    {{#each jsonResult}}
    <a href=#><h4>{{name}}</a></h4>
    <p id="phone">{{phone}}</p>
    <p id="adr">
    <span id="street-address">{{address}}</span>
    <span id="locality">{{city}}</span>
    <span id="region">{{state}}</span>
    </p>
    {{/each}}
    </div>

  </script>

<script>
       var source = $("#biz_template").html();
       var template = Handlebars.compile(source);

var data = '{"totalCount":61,"impId":"17","jsonResult":[{"impId":"17","listingId":"94523","pageUrl":"/page/LA/new-orleans/ccs-coffee-house/17-94523.html","name":"CC's Coffee House","phone":"(504) 586-0278","address":"650 Poydras St","city":"New Orleans","state":"LA","latitude":"29.949339","longitude":"-90.070017"},{"impId":"17","listingId":"417428","pageUrl":"/page/LA/metairie/ccs-community-coffee-house/17-417428.html","name":"CC's Community Coffee House","phone":"(504) 831-1449","address":"701 Metairie Rd","city":"Metairie","state":"LA","latitude":"29.98763","longitude":"-90.130528"},{"impId":"17","listingId":"228835","pageUrl":"/page/LA/new-orleans/ccs-community-coffee-house/17-228835.html","name":"Cc's Community Coffee House","phone":"(504) 566-1863","address":"228 St Charles Av","city":"New Orleans","state":"LA","latitude":"29.951952","longitude":"-90.069885"}]}';

$("#biz").html(template(data));
 </script> 
```

有什么想法吗？

我确实在 HTML 中有带有 biz id 的 div

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:14:27.157

这里的任务是在 getJSON 成功函数中建立标记。您可以通过连接字符串或使用模板系统（如把手、JsRender、下划线等）来做到这一点。如果您正在寻找双向绑定，请查看 Angular 或 Knockout。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:50:46.177

我刚刚做了一个带有`$.getJSON`把手的插件，这只是它的一部分，基本上是你所需要的。如果你愿意，我可以发布整个插件。

不要忘记将文件或 url 引用到车把

```
<script src="http://cloud.github.com/downloads/wycats/handlebars.js/handlebars-1.0.rc.1.js" type="text/javascript"></script>

var container = $('#tweets'),
    template: $('#tweets-template').html()

$.getJSON(this.url, function(data) {
                    var tweets = $.map(data.results, function(tweet) {
                        return {
                            author: tweet.from_user,
                            tweet: tweet.text,
                            thumb: tweet.profile_image_url,
                            url: 'http://twitter.com/' + tweet.from_user + '/status/' + tweet.id_str
                        };
                    });

                    var templateHandlebars = Handlebars.compile(template);
                    container.append(templateHandlebars(tweets));
});

//this is the html and the template
<ul id="tweets">
        <script id="tweets-template" type="text/x-handlebars-template">
            {{#each this}}
                <li>
                    <img src={{thumb}} alt={{author}} />
                    <p><a href={{url}}>{{tweet}}</a></p>
                </li>
            {{/each}}
        </script>
</ul> 
```**

# javascript - Dropbox的图片短网址

> ID：14175299
> 
> 赞同：0
> 
> 时间：2013-01-05T19:08:00.663
> 
> 标签：javascript, http, dropbox

1.我想从 img 标签中的“短 url”呈现 Dropbox 图像，如下所示：

```
 <img src="https://db.tt/mght345atp" alt="Dropbox image"/> 
```

但是如果我这样做，将不会呈现图像。我做错了什么还是不可能？对于长网址，它的工作原理就像一个魅力，但 Dropbox 的移动客户端（Android 和我也认为是 ios 客户端）只能通过“共享”和“复制链接”创建和复制“短网址”。我需要这些东西才能在我的移动应用程序中合并来自不同用户的图像（他们会自己做），所以图像将从不同用户的共享链接加载。

2.那么Dropbox短网址是什么意思？我的意思是，当您无法记住无意义的字母组合时，它们有什么用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:14:40.527

您的第 1 点似乎不是一个问题。如果那里有问题，请澄清你在问什么。浏览器应该能够从缩短的 URL 中很好地呈现图像。短 URL 通常会返回重定向状态代码和新 URL，然后浏览器将从新重定向 URL 中获取图像。这比仅使用原始 URL 获取图像效率低，因为它需要对图像的两个 Web 请求（一个到缩​​短的 URL，然后一个到重定向 URL）而不是一个，但它应该可以正常工作。

对于您的第 2 点，短 URL 提供了长度更短的好处。它们在电子邮件和其他类型的帖子中效果更好，其中长 URL 甚至可能比行长还可能导致消息可读性或实际操作中的问题（当 URL 插入换行符时）。此外，随着短信和 Twitter 中短消息的流行，短 URL 可以为您保存消息中的字符，以便您可以将字符数用于消息的其他部分。

短 URL 的目的不是为了提高记住它们的能力，因为它们的混合字母数字的密集组合不容易记住。他们从来不适合那个目的。为了便于记忆，您需要自己的自定义域，您可以在其中使用简短的英文单词/短语作为您的 URL，这些 URL 易于记忆并且可能与主题相关。

# javascript - 检测 URL 更改是否返回

> ID：14175302
> 
> 赞同：0
> 
> 时间：2013-01-05T19:08:14.137
> 
> 标签：javascript, hash, navigation, back

我有一个 Web 应用程序，它在导航时使用了一些微妙的效果。基本上页面从右侧“滑入”。

应用程序中的所有内容都基于对哈希的更改，所有这些都运行良好。

我只是在寻找一种方法来确定对 URL 的更改是否是“后退”操作。我不会试图影响更改——我的应用程序已经完美地处理了这一点。我只是想扭转“效果”。换句话说，如果我知道他们正在单击“返回”，我想从左侧滑入，而不是通常的从右侧滑入的动作。

请记住，我不需要动画本身的帮助或跟踪哈希中的应用程序状态——我只需要知道如何知道更改是否是“返回”动作。

此外，我真的不想在应用程序中保留哈希状态列表，因为用户单击以尝试确定他们是否要“返回”。我可能会考虑，如果它真的是唯一的选择，但我希望找到一个只知道用户是否启动的解决方案（返回按钮，history.go（-1），右键单击“返回”等）。

在没有明确跟踪哈希更改的情况下，这些信息是否在 javascript 中可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:13:57.307

使用前一页变量。我将假设当您“更改”页面时，您是通过中心功能进行的。

**在您的转到页面功能中**

```
// Try to get the previous page if known (will be 'unidentified' if unknown)
var prevPage = window.previousPage;

// Set this page as the previous before moving.
window.previousPage = 'this page';

// Assume that gotoPage is where we are headed
if(gotoPage == prevPage)
{
    // We're going back!
}
else
{
    // We're going forward!
} 
```

附言

我使用 window.previousPage 作为通用容器并使用 prevPage 在范围内进行比较。这是为了限制您必须设置 window.previousPage 的位置数量而设计的

**编辑：**

没有考虑过多次返回，使用数组的相同想法（未经测试，但这是一般想法）

```
var prevPage = '';

if( Object.prototype.toString.call( window.previousPage ) === '[object Array]' )
    prevPage = window.previousPage[ window.previousPage.length - 1 ];

if(prevPage == gotoPage)
{
    // Splice out the last entry
    window.previousPage.splice( window.previousPage.length - 1, 1);
    // Going back DO NOT add new window.previousPage
}
else
{
    // Going forward add the previousPage before changing
    window.previousPage[ window.previousPage.length ] = 'this page';

    // Move Page
} 
```

# c++ - 安全地使用 auto_ptr 交换对象而不锁定在多线程环境中？

> ID：14175303
> 
> 赞同：4
> 
> 时间：2013-01-05T19:08:28.977
> 
> 标签：c++, multithreading, performance, copy-on-write

我在堆上分配了一些很少修改但需要快速读取访问的数据结构。一个示例是在堆上分配的结构，许多线程以只读方式非常频繁地访问该结构。`auto_ptr`需要定期重写此结构并避免锁定争用，重写它并快速与结构的新`auto_ptr`实例交换指针。

我从`CopyOnWriteArrayList`Java 中得到了这个想法，并希望在 C++ 中执行类似的性能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:18:19.437

[`std::auto_ptr`](http://en.cppreference.com/w/cpp/memory/auto_ptr)[`reset()`](http://en.cppreference.com/w/cpp/memory/auto_ptr/reset)在调用非常量成员（如您所建议的）时没有任何线程安全保证。此外，[`std::unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr)您应该考虑作为替代的`auto_ptr`as也没有`auto_ptr`被有效地弃用。

[`std::shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr) *确实*提供了这样的线程安全保证。

您通常可以保证`shared_ptr`引用计数是以原子方式操作的，这意味着在创建 a 的副本时您可以安全地避免数据竞争`shared_ptr`，前提是此时没有人正在修改`shared_ptr`。

考虑以下用于您的`shared_ptr`. 您有一个`shared_ptr<string> sharedString;`当前指向`std::string`. 许多线程调用`get()`来检索指向字符串的指针是安全的。他们也可以这样创建自己的共享指针：`shared_ptr<string> myString = sharedString;`，前提是没有人更改共享指针指向的内容。

现在，让我们返回并修复示例中存在的竞争条件。当需要更改全局共享指针指向的内容时，线程可能正在制作它的副本——这是一个问题，因为它可能使副本处于不一致的状态。因此，我们必须确保以原子方式更改和复制它。

幸运的是，`shared_ptr`它提供了许多 C++11 原子操作的特化：[`atomic_load`](http://en.cppreference.com/w/cpp/atomic/atomic_load)、[`atomic_store`](http://en.cppreference.com/w/cpp/atomic/atomic_store)和[`atomic_exchange`](http://en.cppreference.com/w/cpp/atomic/atomic_exchange).

制作 的副本时`shared_ptr`，使用`atomic_load`，更新 时`shared_ptr`，使用`atomic_store`。

这样做很重要，原因有两个。

1.  atomic_* 操作为您提供了一种线程安全的方式来制作共享指针的副本。
2.  制作副本意味着当全局共享指针发生更改时，您的副本仍然指向旧字符串，因此您的代码不必担心它所操作的数据会在它不期望的情况下发生更改。

现在，重要的是要注意在 a 上使用线程安全操作`shared_ptr`不会为其指向的类型提供任何线程安全性。您始终必须注意以线程安全的方式使用指向的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T19:17:22.247

您可以使用 reset() 即时重新分配 auto_ptr，顺便说一下，它会破坏以前指向的对象实例。

但是，auto_ptr 已被 unique_ptr 弃用，它有一个 swap() 函数，似乎有点坚持你正在寻找的东西。

请记住，这些类*不是*线程安全的。

# flash - flash cs3 尝试打开 .fla 文件时出现意外的文件格式

> ID：14175308
> 
> 赞同：2
> 
> 时间：2013-01-05T19:08:55.343
> 
> 标签：flash, cs3

我正在使用 flash cs3 pro，尝试打开文件时出现错误“意外的文件格式”，我在 CS4 和 CS5 中也无法打开相同的文件

我可以做些什么来正确打开这个 .fla 文件吗？

或者如果有人可以尝试打开它并再次为cs3保存它？

如果文件已损坏，有什么方法可以恢复我的文件（我的操作系统是 Windows 8）

谢谢，玛尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T03:14:25.497

验证源 *.fla 文件不会使用最新的 Flash Pro 版本 CS 6 打开（如果需要，请下载试用版）。

如果它仍然不起作用，您可以尝试提取 .fla 的资产并将它们投入到新项目中。解释此过程的一些链接包括[获取库资产](https://stackoverflow.com/a/4453942/1091955)和[修复损坏的 .fla 文件的 9 个步骤](http://www.downloadatoz.com/howto/how-to-fix-corrupt-fla-file-on-adobe-flash-cs5,11482.html)。

# java - 在Java中按y值排序坐标的最简单方法？

> ID：14175309
> 
> 赞同：5
> 
> 时间：2013-01-05T19:09:01.780
> 
> 标签：java, arrays, list, sorting

假设我有一个（以任何方式未排序）数组：

```
[ 12 64 35 ]
[ 95 89 95 ]
[ 32 54 09 ]
[ 87 56 12 ] 
```

我想对其进行排序，以便第二列按升序排列：

```
[ 32 54 09 ]
[ 87 56 12 ]
[ 12 64 35 ]
[ 95 89 95 ] 
```

以下是我考虑过的处理方法：

1.  将每个 [ xyz ] 值制成一个列表，并将每个 xyz 值与一个标识符相关联，该标识符的属性是 xyz 值的 y 值。然后，对标识符进行排序。（我不确定对 Java 数组进行排序是否会保留该行中的相应值）

2.  使用 hashmap 做和之前一样的事情

但是，上述两种方法显然有些浪费和复杂，因为它们依赖于不需要的外部标识符值，那么有没有更简单、更快、更优雅的方法来做到这一点？

抱歉，如果这是一个愚蠢的问题，我完全不熟悉 Java 对数组进行排序的方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:11:22.413

最简单和最干净的方法是编写一个小的比较器类。这也将使您在控制排序行为方面具有更大的灵活性；例如，您可以对第一个元素或数组的任何元素进行排序。

比较器将类似于：

```
new Comparator(){

            public int compare ( Integer[] obj1, Integer[] obj2)
            {
                return obj1[1].compareTo(obj2[1]); 
            } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-05T19:24:50.723

这是一个单行（如果您将匿名类算作一行），使用[`Arrays.sort()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28T%5B%5D,%20java.util.Comparator%29)和适当类型和编码的[`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)：

```
Arrays.sort(grid, new Comparator<int[]>() {
    public int compare(int[] o1, int[] o2) {
        return o1[1] - o2[1];
    }
}); 
```

请注意简单的比较表达式`o1[1] - o2[1]`- 无需拆箱`Integer`并使用`Integer.compareTo()`.

这是对您的数据的测试：

```
public static void main(String[] args) {
    int[][] grid = new int[][] { 
        { 12, 64, 35 },
        { 95, 89, 95 },
        { 32, 54,  9 },
        { 87, 56, 12 }};
    Arrays.sort(grid, new Comparator<int[]>() {
        public int compare(int[] o1, int[] o2) {
            return o1[1] - o2[1];
        }
    });
    System.out.println(Arrays.deepToString(grid).replace("],", "],\n"));
} 
```

输出：

```
[[32, 54, 9],
 [87, 56, 12],
 [12, 64, 35],
 [95, 89, 95]] 
```

* * *

只是为了好玩，这里它实际上是一行：

```
Arrays.sort(grid, new Comparator<int[]>() {public int compare(int[] o1, int[] o2) {return o1[1] - o2[1];}}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T19:23:01.247

使用自定义比较器。

此实现更通用，因为您可以将其用于任何`Comparable`类型和任何排序索引。如果您还需要`T`类型本身的自定义比较器，则需要在构造函数中传递它并替换`.compareTo()`调用。

```
public class ArrayElementComparator<T implements Comparable<? super T>> implements Comparator<T[]> {

    private final int sortIndex;

    public ArrayElementComparator(int sortIndex) {
        this.sortIndex = sortIndex;
    }

    @Override
    public int compare(T[] left, T[] right) {
        // Optional: null checks and boundary checks
        if (left == null && right == null) {
            return 0;
        }
        if (left == null || left.length <= sortIndex) {
            return 1;
        }
        if (right == null || right.length <= sortIndex) {
            return -1;
        }
        return left[sortIndex].compareTo(right[sortIndex]);
    }

} 
```

用法：

```
List<Integer[]> list = new List<Integer[]>();
// ... Add records
Collections.sort(list, new ArrayElementComparator<Integer>(1)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T19:15:00.700

如果这三个值表示 3D 欧几里得空间中的 (x, y, z) 坐标，您可以编写一个类来保存它们。然后使用这些点的列表或数组以及客户比较器按您希望的方式对它们进行排序。

# r - 有效的回归系数存储在现有数据框中

> ID：14175310
> 
> 赞同：1
> 
> 时间：2013-01-05T19:09:08.223
> 
> 标签：r, apply, performance

我正在尝试提高脚本的效率，基本上，我运行了许多线性回归，并且对于每个拟合模型，我将估计的系数和标准误差结果存储在先前创建的数据框中，例如`results`.

因此，在存储任何回归系数之前，数据框`results`已经具有所需的维度。

此外，对于`i`我所做的每一个回归：

```
mod.fit <- plm(y ~ x1 + x2, index="group", sample) 
```

然后我运行：

```
 results[i,1] <- summary(m.fit)$coefficients[1,1]
  results[i,2] <- summary(m.fit)$coefficients[2,1]
  results[i,3] <- summary(m.fit)$coefficients[1,2]
  results[i,4] <- summary(m.fit)$coefficients[2,2] 
```

有没有办法使上述存储步骤更快？

.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T19:46:06.243

您可以使用矩阵索引：

```
results[i,1:4] <- summary(m.fit)$coefficients[matrix(c(1,2,1,2,1,1,2,2),ncol=2)] 
```

如果`results`只有 4 列宽，您可以消除`1:4`左侧的。

交替

```
results[i,] <- summary(m.fit)$coefficients[1:2,1:2] 
```

应该可以工作，因为 R 以列优先顺序存储矩阵。

我鼓励你使用`coef()`访问器而不是`$coefficients`，如果它是为`summary.plm`类定义的......

# android - 使用 SharedPreferences 从 ListView 保存数据

> ID：14175313
> 
> 赞同：4
> 
> 时间：2013-01-05T19:09:19.980
> 
> 标签：android, listview, sharedpreferences

我试图寻找答案，但找不到我要找的东西：这是我第一次尝试保存数据/使用 SharedPreferences，所以我不太确定自己在做什么。要点是，当用户在 EditText 中输入内容后，它会填充 ListView。但我也想要它，以便在执行此操作时，应用程序还会保存字符串，以便我可以在用户重新进入应用程序时使用 LoadPreferences 来获取它。虽然这不会发生

编码：

```
public class TaskPage extends SherlockActivity {

EditText display;
ListView lv;
ArrayAdapter<String> adapter;
Button addButton;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    display = (EditText) findViewById(R.id.editText1);
    lv = (ListView) findViewById(R.id.listView1);
    addButton = (Button) findViewById(R.id.button1);

    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
    lv.setAdapter(adapter);
    LoadPreferences();

    addButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            String task = display.getText().toString();

                adapter.add(task);
                adapter.notifyDataSetChanged();
                SavePreferences("LISTS", task);
        }
    });
}

protected void SavePreferences(String key, String value) {
    // TODO Auto-generated method stub
    SharedPreferences data = PreferenceManager.getDefaultSharedPreferences(this);
    SharedPreferences.Editor editor = data.edit();
    editor.putString(key, value);
    editor.commit();

}

protected void LoadPreferences(){
    SharedPreferences data = PreferenceManager.getDefaultSharedPreferences(this);
    String dataSet = data.getString("LISTS", "None Available");

} 
```

我很确定我做错了什么，但没有错误。所以当我运行应用程序时，一切正常，除了没有保存（或者它只是没有显示在 ListView 中）

那么我该如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:18:11.153

将您的 LoadPreferences() 方法更改为：

```
protected void LoadPreferences(){
    SharedPreferences data = PreferenceManager.getDefaultSharedPreferences(this);
    String dataSet = data.getString("LISTS", "None Available");

     adapter.add(dataSet);
     adapter.notifyDataSetChanged();
} 
```

在您当前的代码中，您没有添加`dataSet` 到`ArrayAdapter`

# android - 为什么我的画布动画比简单的 ImageView + 矩阵慢得多？

> ID：14175317
> 
> 赞同：0
> 
> 时间：2013-01-05T19:09:48.653
> 
> 标签：android, animation, android-asynctask, android-canvas

我正在实现全景查看器。我是用 ImageView 做的，在 AsyncTask 中用它的 Matrix 移动图像（`foto`是 ImageView，`m`是一个 Matrix）：

```
 protected void onProgressUpdate(Integer... values) {
        if (values[0] == 0) {
            m.setScale(scale, scale);
            m.postTranslate(values[1], 0);
            foto.setImageMatrix(m);
        }
    } 
```

它工作得很好，除了运动不是很平滑（平滑=恒定速度，特别是没有“跳跃”和没有“停止”）。

为了寻找解决方案，我阅读了有关 Canvas 的文档：

*当您的应用程序需要定期重新绘制自身时，选项“b”绘制到 Canvas 会更好。视频游戏等应用程序应自行绘制到画布上。*

看起来这正是我需要的！所以我做了以下事情：

首先，我创建了一个`scaleBitmap`缩放图像以适应窗口高度（这是为了避免重新缩放）和一个屏幕大小的位图`fitBitmap`。然后，我创建了两个屏幕大小相等的矩形，`destRect`并且`srcRect`. 现在，新的`onProgressUpdate()`AsyncTask 方法是：

```
 protected void onProgressUpdate(Integer... values) {
        if (values[0] == 0) {
            srcRect.offset(-1, 0);
            canvas.drawBitmap(scaledBitmap, srcRect, destRect, null);
            foto.setImageBitmap(fitBitmap);
        }
    } 
```

这也有效。但它比以前慢了很多！不仅如此，它还会“跳”很多帧，除非我将速度设置得非常低。可怕！但是根据文档，Canvas 可以很好地加速动画。所以我在做一些非常错误的事情。

你能告诉我哪个是我的错误，或者如何更好地实现这一点？

谢谢！！

**编辑**

根据（我所了解的）@aragaer 的建议，我尝试了以下方法，但没有运气（仍然缓慢而跳跃）：

```
 @Override
    protected void onProgressUpdate(Integer... values) {
        if (values[0] == 0) {
            m.setScale(scale, scale);
            m.postTranslate(values[1], 0);
            canvas.drawBitmap(myBitmap, m, null);
            canvas.drawBitmap(fitBitmap, 0, 0, null);
            foto.invalidate();
        }
    } 
```

还尝试在方法中注释/取消注释最后两行中的任何一个/两个，但没有运气。没有最后一个，什么都不会发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:53:42.267

在第二种情况下，它会使整个视图无效。这就是为什么。

您根本不应该使用`setImageView`- 直接覆盖`onDraw`并绘制位图。这会更快。

正确的做法是这样的：

*   您创建自己的位图，大小与您要使用的视图相同。
*   您创建一个画布并将其设置为绘制到该位图中。
*   当你需要画一些东西时，你把东西画到那个画布上。知道确切更改的矩形会使视图的确切矩形无效。`onDraw`在您将缓存位图绘制到提供的画布中的位置被调用。

这是一个小部件的链接，当用户在表面上移动手指时绘制线条：[link](https://github.com/aragaer/reminder_android/blob/master/src/com/aragaer/reminder/DrawView.java)。它有点复杂，因为我使用了两个位图，一个用于内部表示，另一个用于向用户显示的内容。忽略它，看看我是如何使用`cache`位图的。

# c++ - 在我的 C++ 程序中既不写也不写工作

> ID：14175320
> 
> 赞同：0
> 
> 时间：2013-01-05T19:10:10.697
> 
> 标签：c++, binaryfiles

我正在为我的学校项目编写一个涉及大量二进制文件的 c++ 程序。我的问题是，每当编译器遇到写入语句（我的意思是使用 fstream::write 将数据从类的对象写入二进制文件）时，执行就会停止并且我会收到异常终止消息。我确定“写”语句是问题所在，因为在它执行之前的每个语句，而下一个语句没有。当我改用 fwrite 时，问题似乎已经解决，但后来我发现数据实际上并没有写入文件。我尝试在另一个函数或使用“this”指针的方法中将对象写入文件，但计算机似乎不接受其中任何一个。

该程序在几天前之前运行良好，但似乎出乎意料的是，它停止了工作。我无法附上源代码，因为问题遍布整个程序，有 5000 多行。但是，以下是导致问题的示例：

```
bottle b; //bottle is a class
fstream file ("Bottle.dat",ios::out|ios::binary);
file.write ((char*)&b,sizeof(b)); 
```

作为替代，我也尝试过

```
FILE*fptr=fopen ("Bottle.dat","w");
fwrite (&b, sizeof(b), 1, fptr); 
```

前者导致异常终止，后者不起作用。编译期间没有错误消息。有谁能够帮我？不过，我是编程的新手（还在上高中），所以请尽量保持简单。谢谢！

编辑：也许这将作为更好的例子。

```
class irrigation
{   int n,i,itime[20],t[20];
    float amt[20],water[20];
protected:
    float irr;
public:
    float getirr()
    {   return irr;
    }
    void irrigate();
};

void irrigate_calc()
{   fstream file ("Irrigate.dat",ios::in|ios::binary);
    irrigation i;
    file.read ((char*)&i,sizeof(i));
    file.close();
    i.irrigate();
    fstream file1 ("Irrigate.dat",ios::out|ios::binary);
    file1.write ((char*)&i,sizeof(i));
    file1.close();
} 
```

据我所知，当我打开一个文件进行读取，再次关闭它然后打开它进行写入时，就会出现问题。当然，我确实尝试过直接在 ios::in、ios::out 和 ios::ate 模式下打开文件，但这把事情搞砸了。

编辑 2：同一个程序面临的另一个问题是一些正常的 cout 语句间歇性地吐出垃圾：许多特殊字符和来自其他完全不相关的 cout 语句的一点点。发生这种情况有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T02:13:30.123

由于您的对象不是`POD`，因此您可以尝试写出它的所有成员。例如，

```
#include <fstream>

using namespace std;

class B
{
public:
    // Simple constructor
    B(int mem1, char mem2) : member1(mem1), member2(mem2) {}

    // Have some methods here
    bool write() const {
      fstream file("Bottle.dat", ios::out|ios::binary);
      if(!file.is_open())
        return false;
      file.write(reinterpret_cast<const char*>(&member1), sizeof(int));
      file.write(&member2, sizeof(char));
      file.close();
      return true;
    }

private:
    int member1;
    char member2;
};

int main()
{
  B sample(52, 'c');
  sample.write();
  return 0;
} 
```

现在你可以打电话`yourobj.write()`，它可以写出`Bottle.dat`。您可以随心所欲地写出/编码您的数据。但这是一个简单的直接输出。您的前 4 个字节（嗯，`sizeof(int)`字节）将是`member1`，您的下一个字节是`member2`. 因此，如果您愿意，也可以轻松地以这种格式阅读。

**编辑**

我已经更新了我的代码以使其成为可编译的示例。您可以使用十六进制编辑器观察输出文件以验证一切是否正确。您应该能够（在任何编辑器中）能够明显看到`char`对应于`member2`. 如果您在十六进制编辑器中打开它，您将看到前 4 个字节等于数字`0x34`。根据您机器的字节序，它可能看起来像`00000034`或者`34000000`这是十进制`52`，这是我们根据我的示例代码所期望的。

# java - java.sql.SQLException：Io 异常：网络适配器无法建立连接

> ID：14175325
> 
> 赞同：1
> 
> 时间：2013-01-05T19:10:46.097
> 
> 标签：java, gwt, oracle10g, ejb

我开始在 GWT 中开发应用程序。首先，我尝试了一个简单的登录。当用户点击登录按钮时，如果用户名和密码在数据库中，异步调用会检查服务器。当我仅在服务器端运行它时（在一个简单的 main() 方法中）它工作正常。但是当我在我的浏览器中使用 GWT（实际上最后调用相同的方法）尝试它时，它会抛出以下异常（简而言之）：

`javax.persistence.PersistenceException: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.4.1.v20121003-ad44345): org.eclipse.persistence.exceptions.DatabaseException Internal Exception: java.sql.SQLException: Io exception: The Network Adapter could not establish the connection Error Code: 17002`

我注意到`EntityManagerFactory emf = Persistence.createEntityManagerFactory(...)`没关系，抛出异常`EntityManager em = emf.createEntityManager();`

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:23:23.757

我想我终于找到了答案。当我开始开发我的应用程序时，我生成了示例代码。我勾选了“使用 Google App Engine”。现在在没有 GAE 的情况下重新开始整个项目并且它可以工作。我正在学习 GWT，老实说，我不知道 GAE 是干什么用的。我只是点击了“下一个下一个完成”，并没有意识到危险......

# php - 带有土耳其语文本的 mysql 字符编码

> ID：14175327
> 
> 赞同：0
> 
> 时间：2013-01-05T19:11:21.497
> 
> 标签：php, mysql, character-encoding, turkey-test

我正在尝试将单词表保存到我的数据库中。Wordlist 是一个 utf-8 编码的文本文档。这是我的表结构；

```
CREATE TABLE IF NOT EXISTS `wordlist` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `kelime` char(64) COLLATE utf8_turkish_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `kelime` (`kelime`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_turkish_ci AUTO_INCREMENT=1140209 ; 
```

这是添加单词的php代码；

```
<?php
ini_set('max_execution_time', 3000);
$handle = @fopen("wordlist.txt", "r");

if ($handle) {
    include("ekle.php"); // makes db connection
    $sql = "insert into wordlist (kelime) VALUES (?)";
    $dbh->beginTransaction();
    $sth = $dbh->prepare($sql);
    while (($buffer = fgets($handle, 4096)) !== false) {
        $sth->execute(array(trim($buffer)));
    }
    if (!feof($handle)) {
        echo "Error: unexpected fgets() fail\n";
        $dbh->rollBack();
    } else {
        $dbh->commit();
    }
    fclose($handle);
}?> 
```

我的数据库的默认排序规则也是 utf-8_turkish_ci。当我添加单词时，我的单词表在 phpmyadmin 上看起来不对； ![在此处输入图像描述](../Images/fa09db2e5d60503cfe85cded0776e242.png)

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:52:54.997

我在过去的经验中已经遇到过这个问题，我通过以下步骤解决了这个问题，

**步骤#1：** ***在头部部分将字符集设置为 UTF-8***

首先，浏览器需要知道您将在此页面中显示或使用 Unicode。因此，转到您的部分并将字符集设置为 utf-8。因此，浏览器将能够无任何错误且流畅地显示 Unicode 文本。您还可以复制并粘贴以下行：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

**步骤#2：** ***创建数据库***

当您创建 (a) 数据库和 (b) 数据库中的任何表时，将它们的排序规则设置为 utf8_unicode_ci 并且您知道如果您使用的是 phpMyAdmin，这非常容易。

**步骤#3：** ***数据库初始化***

初始化数据库连接时，请添加“额外的行”</p>

```
<?php

    define('HOSTNAME', 'localhost');
    define('USERNAME', 'database_user_name');
    define('PASSWORD', 'database_password');
    define('DATABASE', 'database_name');

    $dbLink = mysql_connect(HOSTNAME, USERNAME, PASSWORD);
    mysql_query("SET character_set_results=utf8", $dbLink);
    mb_language('uni'); 
    mb_internal_encoding('UTF-8');
    mysql_select_db(DATABASE, $dbLink);
    mysql_query("set names 'utf8'",$dbLink);

?> 
```

但是你为什么要添加额外的行？因为您正在让数据库知道您将很快使用哪种输入。

**步骤#4：** ***在数据库中插入输入/数据***

```
<?php

    mysql_query("SET character_set_client=utf8", $dbLink);
    mysql_query("SET character_set_connection=utf8", $dbLink);

    $sql_query = "INSERT INTO
    TABLE_NAME(field_name_one, field_name_two)
    VALUES('field_value_one', 'field_value_two')";
    mysql_query($sql_query, $dbLink);

?> 
```

为什么要添加前两行？因为数据库应该知道要存储什么样的数据。

**步骤#5：** ***更新数据库中的输入/数据***

```
<?php

    mysql_query("SET character_set_client=utf8", $dbLink);
    mysql_query("SET character_set_connection=utf8", $dbLink);

    $sql_query = "UPDATE TABLE_NAME
    SET field_name_one='field_value_one', field_name_two='field_value_two'
    WHERE id='$id'; ";
    mysql_query($sql_query, $dbLink);

?> 
```

因此，在使用 Unicode 时，您在运行查询字符串之前添加了额外的两行。

**第 6 步：** ***从数据库中搜索数据***

```
<?php

    mysql_query("SET character_set_results=utf8", $dbLink);

    $sql_query = "SELECT * FROM TABLE_NAME WHERE id='$id'; ";
    $dbResult = mysql_query( $sql_query, $dbLink);

?> 
```

每次搜索 Unicode 数据时添加一行就足够了。

这就是你几乎完成了。

我认为这可以帮助您解决问题。

# ruby-on-rails-3 - before_destroy 回调中未加载关联

> ID：14175330
> 
> 赞同：3
> 
> 时间：2013-01-05T19:11:28.640
> 
> 标签：ruby-on-rails-3, activerecord, callback

我有一个简单的模型`User`。`Account`如果帐户附加了用户，我想防止删除该帐户。我创建一个`User`和一个`Account`并将它们关联起来。然后，我`Account.find(x).destroy`在控制台上做。账号被销毁！

笔记：

1.  用户`account_id`是正确的。
2.  `Account.find(x).users.empty?`在控制台返回`false`
3.  `Account.find(x).destroyable?`在控制台返回`true`
4.  `users.empty?`在`def destroyable?`回报`true`！

我做错了什么？它是什么？

代码（Ruby 1.9.2-p290 上的 Rails 3.2.9）：

```
class User < ActiveRecord::Base
  belongs_to :account
end

class Account < ActiveRecord::Base

  has_many :users, dependent: :destroy
  attr_accessible :name
  before_destroy :destroyable?

  def destroyable?
    if users.empty? # This returns true when called via callback.
      true
    else
      false
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T19:30:17.340

所以，事实证明这是另一个 Rails 陷阱。

解决方法是移动`before_destroy`上面的`has_many`调用。

*   [https://github.com/rails/rails/issues/670](https://github.com/rails/rails/issues/670)
*   [https://github.com/lifo/docrails/commit/79cbfc8](https://github.com/lifo/docrails/commit/79cbfc8)

@Yves Senn，你是对的。从现在开始我会避免它。使用`dependent: :restrict`而不是`dependent :destroy`，在这种情况下，消除了我的`before_destroy`回调的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:23:09.107

我认为问题是`dependent: :destroy`。如果您不想销毁关联用户的帐户，则不应添加相关选项。

这也是非常危险的，因为它可能会意外地破坏用户。

# string - 简单的 bash 脚本 - 连接字符串

> ID：14175333
> 
> 赞同：0
> 
> 时间：2013-01-05T19:11:43.400
> 
> 标签：string, macos, bash, loops, for-loop

我正在学习 bash 脚本，我写了这个简单的脚本：

```
#!/bin/bash
for f in $(cat test.csv | cut -d';' -f 4)
do
EXT=".pdf"
echo "$f$EXT"
done 
```

文件 test.csv 在哪里：

```
col1;col2;col3;test1
col1;col2;col3;test2
col1;col2;col3;test3
... 
```

该脚本的输出是：

```
.pdf
.pdf
.pdf
... 
```

预期的输出将是：

```
test1.pdf
test2.pdf
test3.pdf
... 
```

对不起，愚蠢的问题，但我被困在这个，我认为，小问题。

此脚本的输出相同：

```
#!/bin/bash
while IFS=\; read col1 col2 col3 col4
do
echo "$col4".pdf
done < test.csv 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T08:43:20.690

或使用 sed：

```
sed  's/.*;\(.*\)/\1.pdf/' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:26:31.577

不要这样做`for i in $(cat something)`。它会将整个文件保存在不需要的内存中。它也不适用于列中的空格。

更好地逐行解析，并使用 shell 工具来拆分列（`read`内置）。

类似的东西

```
while IFS=\; read col1 col2 col3 col4
do
    echo "$col4".pdf
done < test.csv 
```

应该做。

`IFS=\;`如果您的列由空格分隔，则可以删除该部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:51:21.157

尝试这个：

```
#!/bin/bash
while read line
do
        LINE=`echo "$line" | awk -F';' '{print $4}'`
        echo "${LINE}.pdf"
done < test.csv 
```

# javascript - 不透明度为 0 时隐藏 div 内的可点击链接

> ID：14175337
> 
> 赞同：1
> 
> 时间：2013-01-05T19:12:01.747
> 
> 标签：javascript, jquery, html, css, click

我的`HTML`结构如下：

```
<div class="boxes workshops wrapl">
    <a href="#" id="showw1" class="workshops-button lfloat">Show it</a>
</div>

<div class="boxes exhibitions">
    <a href="#" id="showex1" class="exhibitions-button lfloat">Show it</a>
</div> 
<div class="boxes gallery">
    <a href="#" id="showex1" class="gallery-button lfloat">Show it</a>
</div> 
```

类`.boxes`是彼此相邻设置的正方形。有关于`30`盒子的。最初，所有框都设置为`opacity:1`，所有`-button`类都设置为`opacity:0`。

但是，如果我将鼠标悬停在 中`.boxes`，链接也是可点击的。

我的`.navi`菜单：

```
<div id="navi">
    <a href="#"><div id="t0"><span>Home</span></div></a>
    <a href="#"><span>Events</span></a>
    <a href="#"><span>Gallery</span></a>
    <a href="#"><span>Exhibitions</span></a>
</div> 
```

我的`javascript`代码用于更改`opacity`.

```
 <script type="text/javascript">
    var isHome = true;
        $(function () {

            $("#navi a").click(function() {
                c = $(this).text().toLowerCase();
                isHome = c=="home";
                if (isHome){
                    $('.events-button, .workshops-button, .gallery-button, .sponsors-button, .hospitality-button, .lectures-button, .exhibitions-button').animate({opacity:0.0},500);
                    $(".boxes").animate({opacity: 1.0}, 500 );

                } else {
                    $('.' + c).animate({opacity: 1.0}, 500 );
                    $('.' + c + "-button").animate({opacity: 1.0}, 500 ).addClass('activehack');
                    $('.activehack').not('.' + c + "-button").animate({opacity: 0.0}, 500 );
                    $('.boxes').not('.' + c).animate({opacity: 0.3}, 500 );
                }
            });
        });
</script> 
```

当元素不可见时，如何删除它们的`click`事件？`-button`

**编辑#1** 我不必单击`.-button`元素。

当我单击`home`时，所有内容都`.boxes`应该出现，但`<a>..</a>`每个元素中的元素都`.boxes`不能点击。然后，如果我单击`.events`，则只有`.boxes`with class:`.events`应该与具有 class 的元素一起出现**[** `<a>...</a>`并且`.events-button`它们现在应该可以单击。]

[Jsfiddle 在这里。](http://jsfiddle.net/prateeksachan/qGpML/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:23:53.623

[**工作演示**](http://jsfiddle.net/ueFXY/2/)

```
$('a[class="button"]').click(function(e){ // <--- don't miss this e
    if ($(this).css('opacity')==0) e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T07:45:45.833

我知道你已经接受了一个答案，但事情只是阻止点击事件并不会停止默认行为——当你将鼠标悬停在锚点上时，“手”图标表示可以点击。确实，您应该显示/隐藏锚点，而不是覆盖单击它们时发生的事情，因为*它们首先不应该是可单击的*。

这是一个实际显示/隐藏链接的[jsfiddle](http://jsfiddle.net/jesus_tesh/tKXzf/)，使它们作为“副作用”而无法点击，但也是用户的预期行为。

`$(".boxes a").hide();`单击主页链接时添加，隐藏 div 中的所有锚标记。

当单击任何其他导航项时也会使用此选项，然后`$('.' + c + ' a').show();`用于显示相关链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:27:24.990

取消绑定不必要的处理程序使用[.unbind()](http://api.jquery.com/unbind/)

# vb.net - 我需要在计时器运行时禁用某个功能

> ID：14175340
> 
> 赞同：-1
> 
> 时间：2013-01-05T19:12:13.430
> 
> 标签：vb.net, function, timer

我正在开发一个用于图像托管站点的项目，我需要找到一种方法，以便当用户按下热键调用一个函数时，它将触发一个计时器 x 秒，这将禁用该功能叫。

我已经有了功能设置和热键，我需要添加的只是在计时器计时时禁止在计时器内调用该功能。有任何想法吗？或者有可能吗？

最好的问候和非常感谢，奥罗拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:16:00.190

```
Dim run As Boolean
Sub tick() Handles Timer.Tick
    If run Then
        callfunction()
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:17:14.237

最简单的方法是在启动 Timer 之前设置一个布尔变量，然后在 Timer 的 Tick EventHandler 中将其重置。

像这样的东西：

```
Public Class Form1
    Dim disableFunction As Boolean = False
    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        Timer1.Interval = 2000 '2 second wait time
    End Sub

    Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs) Handles Timer1.Tick
        Timer1.Stop()
        disableFunction = False
    End Sub

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        If disableFunction Then Exit Sub
        disableFunction = True
        Timer1.Start()
    End Sub
End Class 
```

# css - 如何使跨度将可用空间延伸到其他跨度？

> ID：14175341
> 
> 赞同：0
> 
> 时间：2013-01-05T19:12:13.437
> 
> 标签：css, width, html

我想创建一个由 div 中的三个 span 组成的元素。三个跨度应使用 div 提供的整个宽度。左右跨度具有固定的宽度，中间的跨度应该使用它们之间的整个可用空间。我一直在尝试许多不同的东西（浮动、溢出等），但我还没有找到答案，而且我的想法已经不多了......

代码相当简单：

```
<div class="row">
  <span class="rowLeft">LEFT</span>
  <span class="rowCentre">CENTER</span>
  <span class="rowRight">RIGHT</span>
</div> 
```

使用以下 CSS：

```
.row {
  display: block;
  height: 62px;
  border: 1px dotted black;
}
.rowLeft {
  float: left;
  width: 40px;
  height: 60px;
  border: 1px solid red;
}
.rowCentre {
  float: left;
  height: 60px;
  border: 1px dashed blue;
}
.rowRight {
  float: right;
  width: 60px;
  height: 60px;
  border: 1px solid green;
} 
```

我为此创建了一个 jsFiddle：http: [//jsfiddle.net/ezAdf/](http://jsfiddle.net/ezAdf/)

**问题**：从这里开始，如何使中心跨度拉伸左右跨度之间的可用空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:21:40.497

您可以`display:table-cell`在每个跨度上使用 CSS 属性，然后将中心跨度上的宽度设置为 100%。

**[jsFiddle 示例](http://jsfiddle.net/j08691/ezAdf/2/)**

```
.row {
  display: block;
  height: 100px;
  border: 1px dotted black;
}
.rowLeft {
  width: 40px;
  height: 60px;
  border: 1px solid red;
  display:table-cell;
}
.rowCentre {
  height: 60px;
  border: 1px dashed blue;
  display:table-cell;
  width:100%;

}
.rowRight {
  width: 60px;
  height: 60px;
  border: 1px solid green;
  display:table-cell;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T01:51:52.533

有点像@j08691 的解决方案，有一些变化。（虽然可以在 4 个浏览器中使用。）我删除了浮动，添加`display: table-cell`到**span**和`display: table`plus`width: 100%`到**.row**

[在这里](http://jsfiddle.net/WmpZG/)工作小提琴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:40:16.483

只需对您的 CSS 文件进行以下更改：

```
.row {
  display: block;
  height: 62px;
  border: 1px dotted black;   
  position: relative;
}

.rowLeft {
  width: 40px;
  height: 60px;
  border: 1px solid red; 
  float: left;
}

.rowCentre{
  position: absolute;
  left: 40px;
  right: 60px;
  height: 60px;
  border: 1px dashed blue;  
  float: left;
}

.rowRight{
  width: 60px;
  height: 60px;
  border: 1px solid green;  
  float: right;
} 
```

# zen-cart - 为什么我的笔记本电脑无法访问 zen-cart 网站？

> ID：14175342
> 
> 赞同：0
> 
> 时间：2013-01-05T19:12:26.610
> 
> 标签：zen-cart

访问 zencart 主页时，我在笔记本电脑的浏览器上收到此错误 - 会是什么问题？

![在此处输入图像描述](../Images/e494c6da82c44703f25de16a83c76756.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:24:16.443

我认为这是 zencart 网站上的临时问题。你的笔记本电脑什么都没有。这可能已经修复，因为我现在可以浏览它:)

干杯

# javascript - 即使指定了@grant，Greasemonkey AJAX 帖子似乎也不起作用

> ID：14175345
> 
> 赞同：3
> 
> 时间：2013-01-05T19:12:58.060
> 
> 标签：javascript, http-post, greasemonkey, gm-xmlhttprequest

我的脚本不起作用。AJAX 调用没有发生。为什么？

```
// ==UserScript==
// @name        prova
// @namespace   http://blogpagliaccio.wordpress.com/
// @description prova
// @include     http://*
// @version     1
// @grant       GM_xmlhttpRequest
// @require     http://userscripts.org/scripts/source/85398.user.js
// ==/UserScript==

// [........... other code]

    console.log('start ajax call...');
            GM_xmlhttpRequest({
                    method: "POST",
                    url: "www.prova.it",
                    data: {parametro:parametro},
                    onload: function(response) {
                            console.log(response.responseText);
                    },
                    onerror: function(reponse) {
                            alert('error');
                            console.log(reponse);
                    }
            }); 
```

我在指令中列出了 API 函数`@grant`，但没有看到 AJAX 调用和响应。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:59:36.733

请参阅[文档`GM_xmlhttpRequest()`](http://wiki.greasespot.net/GM_xmlhttpRequest#Arguments)。 `data`只需要一个**字符串**。

如果您尝试向 发送非字符串数据`data`，您将收到如下错误：

> 组件没有请求的接口
> （113 超出范围 67）

因此，您必须将数据编码为适当的字符串。此外，您需要发送适当的`Content-Type`标头。两种主要类型/方法是：

1.  `application/x-www-form-urlencoded`
    和
2.  `application/json`

两种方法的编码和发送数据如下所示：

**表单编码数据：**

```
GM_xmlhttpRequest ( {
    method:     "POST",
    url:        "www.prova.it",
    data:       "parametro=" + encodeURIComponent (parametro),
    headers:    {
        "Content-Type": "application/x-www-form-urlencoded"
    },
    onload:     function (response) {
        console.log(response.responseText);
    },
    onerror:    function(reponse) {
        //alert('error');
        console.log("error: ", reponse);
    }
} ); 
```

**JSON序列化数据：**

```
GM_xmlhttpRequest ( {
    method:     "POST",
    url:        "www.prova.it",
    data:       JSON.stringify ( {parametro:parametro} ),
    headers:    {
        "Content-Type": "application/json"
    },
    onload:     function (response) {
        console.log(response.responseText);
    },
    onerror:    function(reponse) {
        //alert('error');
        console.log("error: ", reponse);
    }
} ); 
```

# php - Javascript倒计时+价格调整

> ID：14175346
> 
> 赞同：0
> 
> 时间：2013-01-05T19:13:06.567
> 
> 标签：php, javascript, countdown

我试图制作一个 JS 倒计时脚本来调整要走的秒数和必须支付的价格。

例如：您将在**5**秒内被重定向或点击这里支付**150**立即重定向。

因此，每秒 30 个虚拟硬币。

我已经尝试过，但我很讨厌 JS。

所以，我尝试了什么（通过复制/粘贴在互联网上找到的其他代码）：

```
<script type="text/javascript">
function countDown(secs,elem) {
    var element = document.getElementById(elem);
    element.innerHTML = "Please wait for "+secs+" seconds";
    if(secs < 1) {
        clearTimeout(timer);
        location.href='mywebpage.php';
    }
    secs--;
    var timer = setTimeout('countDown('+secs+',"'+elem+'")',1000);

        timeout = 4;
        if(document.getElementById('costs'))
            document.getElementById('costs').innerHTML='&euro; '+(timeout*30);
        document.getElementById('status').innerHTML = formatTime (timeout);
        timeout--;
}
</script> 
```

然后当然有HTML：

```
<div id="costs"></div>
<div id="status"></div>

<script type="text/javascript">countDown(3000,"status");</script> 
```

我希望有一个人可以帮助我。

自动倒计时，当计数器达到零时必须重定向，必须从第二个“计数器”每秒起飞 30 次。

所有提示将不胜感激。

提前致谢。

编辑：注意倒计时有效，超时也有效，但我不知道如何将倒计时链接到 timeout = 4（倒计时函数的数量应该是 4，已经尝试过 document.getElementById('status');和类似的东西）。

编辑2：

固定的！

所以，想通了。

对于也在寻找类似 JS 的人：

```
<script type="text/javascript">
function countDown(secs, ele)
{

    if(secs <= -1)
    {
        location.href = 'rangtest.php'; // No need to kill a timeout it only fires once
    }
    else
    {
        // This is just copying your code, you should fix this to use the targeted ele
        if(document.getElementById('costs'))
            document.getElementById('costs').innerHTML='&euro; '+(secs*30);
        document.getElementById('status').innerHTML = (secs);

        secs--;
        setTimeout( function() { countDown(secs, ele); }, 1000);
    }
}

</script> 
```

感谢@丹市长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:21:37.900

我一直在尝试将参数应用于计时器函数时遇到问题，这导致我总是定义一个匿名函数，该函数又调用我试图调用的函数。下面将需要一些修改，但应该有所帮助。

```
function countDown(secs, ele)
{
    if(secs <= 0)
    {
        location.href = 'mypage.htm'; // No need to kill a timeout it only fires once
    }
    else
    {
        // This is just copying your code, you should fix this to use the targeted ele
        if(document.getElementById('costs'))
            document.getElementById('costs').innerHTML='&euro; '+(secs*30);
        document.getElementById('status').innerHTML = formatTime (secs);

        secs--;
        setTimeout( function() { countDown(secs, ele); }, 1000);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T07:29:03.810

我更喜欢使用 jquery 的 bind 函数，而不是每次都支付创建新匿名函数的开销：

```
setTimeout(countDown.bind(this, secs, ele), 1000); 
```

# android - Android中的软键盘键码

> ID：14175347
> 
> 赞同：1
> 
> 时间：2013-01-05T19:13:17.923
> 
> 标签：android, keyboard

虚拟键盘，SoftKeyboard，每个字符都有自己的 KeyCode，还是它与 Android 的关系？如果是这样，我在哪里可以获得所有符号/字符的 KeyCode 列表？,

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:16:26.053

[这](http://developer.android.com/reference/android/view/KeyEvent.html)部分文档列出了 SDK 中存在的所有 KeyCode。所有键盘都使用这些键码来允许您输入内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T17:54:03.407

您正在谈论的有两个键码或（代码）

*   **KeyEvent**[参考](http://developer.android.com/reference/android/view/KeyEvent.html)中的键码
*   **IME（输入法编辑器） [参考中的](http://developer.android.com/guide/topics/text/creating-input-method.html)**代码****

 **它们都用于不同的领域，但在您的情况下，它提到了用户按下软键盘时的“字符”显示，这让您感到困惑。

为了更好地理解 IME，请参阅 SDK 附带的 Android 示例应用程序。

请注意，在 IME 中，大写和小写使用相同的代码。您可能需要使用

```
KeyboardView.setShifted(boolean) 
```

希望能帮助到你。干杯。**

# python - 为什么 Python 的多处理模块在 Windows 上启动新进程时会导入 __main__？

> ID：14175348
> 
> 赞同：27
> 
> 时间：2013-01-05T19:13:17.970
> 
> 标签：python, windows, python-2.7, multiprocessing

我正在为我的初学者学生玩一个库，并且我正在使用 Python 中的多处理模块。我遇到了这个问题：[importing and using a module that uses multiprocessing without making the infinite loop on Windows](https://stackoverflow.com/questions/11367835/importing-and-using-a-module-that-uses-multiprocessing-without-causing-infinite/11367998#11367998)

例如，假设我有一个模块`mylibrary.py`：

```
# mylibrary.py

from multiprocessing import Process

class MyProcess(Process):
    def run(self):
        print "Hello from the new process"

def foo():
    p = MyProcess()
    p.start() 
```

还有一个调用这个库的主程序：

```
# main.py

import mylibrary

mylibrary.foo() 
```

如果我`main.py`在 Windows 上运行，它会尝试将 main.py 导入新进程，这意味着代码会再次执行，从而导致进程生成的无限循环。我可以像这样修复它：

```
import mylibrary

if __name__ == "__main__":
    mylibrary.foo() 
```

但是，这对于初学者来说非常混乱，而且似乎没有必要。新流程正在创建中`mylibrary`，为什么不直接导入新流程`mylibrary`？有没有办法解决这个问题而不必改变`main.py`？

顺便说一句，我正在使用 Python 2.7。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-05T19:18:16.337

Windows 没有`fork`，因此无法像现有进程一样创建新进程。所以子进程不得不再次运行你的代码，但是现在你需要一种方法来区分父进程和子进程，`__main__`就是这样。

这在此处的文档中有所介绍：http: [//docs.python.org/2/library/multiprocessing.html#windows](http://docs.python.org/2/library/multiprocessing.html#windows)

我不知道另一种构造代码以避免分叉炸弹效应的方法。

# mongodb - MongoDB查询与别名相同的表

> ID：14175351
> 
> 赞同：1
> 
> 时间：2013-01-05T19:13:25.907
> 
> 标签：mongodb

我有一个集合“详细信息”。

```
{
   "_id": ObjectId("50e876e49d5d0cbc08000001"),
   "user_id": "50e876e49d5d0cbc08000000",
   "left": NumberInt(1),
   "right": NumberInt(2)
}   
{
   "_id": ObjectId("50e876b79d5d0c040a000001"),
   "user_id": "50e876b79d5d0c040a000000",
   "left": NumberInt(3),
   "right": NumberInt(4)
} 
```

我想在 MongoDB 中编写一个类似于 SQL 的查询，如下所示：

```
SELECT node.user_id
FROM details AS node,
        details AS parent
WHERE node.left BETWEEN parent.left AND parent.right
       AND parent.user_id = "50e876e49d5d0cbc08000000"
ORDER BY node.left; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:05:16.173

您可以先查询 parent，然后使用它来查询其他所有内容：

```
parent = db.details.findOne({user_id: ObjectId("50e876e49d5d0cbc08000000")});
query = {left: {$gt: parent.left, $lt: parent.right}};
select = {user_id: 1};
db.details.find(query,select).sort({left: 1}) 
```

如果要查询“大于或等于”和“小于或等于”而不是“大于”和“小于”，则将 and`$gt`替换为`$lt`and `$gte`。`$lte`

# ruby-on-rails-3 - 使用包含检查数组内容是否为对象

> ID：14175352
> 
> 赞同：0
> 
> 时间：2013-01-05T19:13:27.090
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

我的 rails 控制台上有以下数组：

```
u.favorites

[#<Favorite id: 20, candidate_id: 6, ...>, #<Favorite id: 21, candidate_id: 7,..">, #<Favorite id: 22, candidate_id: 8, ...">, #<Favorite id: 23, candidate_id: 9, ...">, #<Favorite id: 24, candidate_id: 10, ...">] 
```

如您所见，我有candidate_id：6、candidate_id：7、candidate_id：8、candidate_id：9、candidate_id：10。但如果我试试这个：

u.favorites.include?(:candidate_id => 5) o canidate 6、7、8、9 或 10 我错了。

我做错了什么？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:16:17.763

尝试

```
u.favorites.select{|f| f.candidate_id==5}.any? 
```

或者

```
u.favorites.collect(&:candidate_id).include?(5) 
```

# iphone - 所有 UIButton 的自定义字体

> ID：14175353
> 
> 赞同：1
> 
> 时间：2013-01-05T19:13:29.520
> 
> 标签：iphone, ios, ipad, fonts, uibutton

我努力了：

```
[[UILabel appearanceWhenContainedIn:[UIButton class], nil] setFont:[UIFont fontWithName:@"TwinkleStarROB" size:24.0]]; 
```

它在 iOS 6 上运行良好，但在 iOS 5 上字体显示不佳。它仅在单击后显示。

图片示例：应用加载时：[应用加载](http://cl.ly/image/1W0n0O2Y2t0R) 时的[图片 点击时：点击时的图片](http://cl.ly/image/04473w2i2L3C)

似乎是什么问题？

当应用程序运行时，我在控制台中得到了这个，但不知道如何修复它：

> “按钮文本属性仅适用于 UIControlStateNormal、UIControlStateHighlighted 和 UIControlStateDisabled。state = 1 被解释为 UIControlStateHighlighted。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T17:21:07.317

更改 a 字体的更好方法可能`UILabel`是直接在每个标签上进行。

```
UILabel* label = ....;

label.font = [UIFont fontWithName:@"TwinkleStarROB" size:24.0] 
```

只要确保您调整大小`UILabel`以处理较大的字体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:50:20.043

我为所有按钮创建了 IBOutlet 并更改了它的字体。

# ruby-on-rails-3 - Rails 没有在 Gemfile 中运行 gem

> ID：14175354
> 
> 赞同：2
> 
> 时间：2013-01-05T19:13:43.760
> 
> 标签：ruby-on-rails-3, gem, rvm

我在 RVM 环境中运行 Rails 3.2.1 和 Ruby 1.9.2-p290

在我的 dev 文件夹中，我有许多不同的 Rails 应用程序，都运行上述程序，但我没有创建单独的 gemsets

我用自己的 gemfile 创建了一个新应用程序，运行了 bundle install 等，一切都很好，直到我回到我最初正在开发的主应用程序

当我现在做一个 rake 路线时，我得到了错误

```
rake aborted!
You have already activated rake 10.0.3, but your Gemfile requires rake 10.0.2\. Using bundle exec     may solve this. 
```

我想我知道如何回到正轨，但这是我不明白的：

当我查看 .rvm/gems/ruby-1.9.2-p290/gems 文件夹时，我可以看到 rake-0.8.7、rake-0.9.2.2、rake-10.0.2、耙子-10.0.3

所以我安装了一个 rake 10.0.2 版本，我的主应用程序 gemfile.lock 调用 rake(10.0.2) 并且当我运行 bundle exec rake routes 它确实有效（大概运行 10.0.2？），但是当我运行一条直线 rake 路线，Rails 似乎想要运行一个没有被要求的不同版本的 Rake。

所以我的问题是，鉴于调用已安装 Gem 的特定版本似乎不像您预期​​的那样，我如何知道实际运行的是哪个版本的已安装 Gem？

（另外，我想如果我在同一个 RVM 空间中开发不同的应用程序，我可能应该为每个应用程序创建单独的 gemset？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T23:17:15.873

此问题已在 ruby​​gems 2.0 中得到修复 - 可以尊重 Gemfile 以加载任何可执行的 gem。

至于您的问题，RVM 随附我的 gem 安装`rubygems-bundler`，如果可能，它应该自动解决依赖关系 - 如果未安装正确的版本，它将回退到您的问题，有一张票可以改变情况以在这种情况下引发异常 - [https： //github.com/mpapis/rubygems-bundler/issues/37](https://github.com/mpapis/rubygems-bundler/issues/37)

基本上 - 确保`bundle install`在项目中执行任何操作之前运行，并`rubygems-bundler`确保运行正确版本的 gem。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:39:16.250

问题是当您安装了同一个 gem 的多个版本时，您将执行的二进制文件`rake`始终是最新版本。如果您的应用程序依赖于该 gem 的旧版本，则无法激活它，因为新版本已经加载。

有三种解决方案：

1.  使用`bundle exec rake`这将始终使用您的 Gemfile 中的版本
2.  使用捆绑器 binstubs: `bundle --binstubs`. 这会`./bin`在您的项目中创建一个文件夹。您现在可以从 Gemfile 访问指定 gem 版本的二进制文件。你可以打电话给 rake`./bin/rake`
3.  卸载较新的版本，使二进制文件指向 Gemfile 中的那个

**编辑：**正如您所提到的，您还可以创建单独的 gemset 来推迟问题。有时，当您更新分支上的 gem 然后切换时，您仍然会收到错误。

# .htaccess - .htaccess 重写特定的现有目录

> ID：14175356
> 
> 赞同：0
> 
> 时间：2013-01-05T19:13:45.007
> 
> 标签：.htaccess, mod-rewrite, rewrite

我正在尝试获取一个现有目录 /blog （以及类似的目录`/blog(/*)`），以重定向到 index.php 以及任何不存在的目录，如下所示。

```
# Turn on URL rewriting
RewriteEngine On

# Installation directory
RewriteBase /

RewriteRule ^blog(.*)$ /index.php/$1 [L]

# Allow any files or directories that exist to be displayed directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rewrite all other URLs to index.php/URL
RewriteRule ^(.*)$ /index.php/$1 [L]

ErrorDocument 404 404.shtml 
```

到目前为止，我已经尝试了大约一千件事，但没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:21:15.707

您是否在 httpd.conf 中将 allowoverride 设置为 all ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:24:01.847

尝试以下操作：

```
RewriteEngine On

RewriteRule blog /index.php [L]

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

# java - 知道谁实例化了我自己

> ID：14175357
> 
> 赞同：1
> 
> 时间：2013-01-05T19:13:46.260
> 
> 标签：java, object, instanceof

有可能在一个实例化自己的类中知道吗？我有一个可以被许多其他类实例化的类 Listener，所以在 Listener 中我想知道谁是“父亲”；

我不想用

```
if(objectA instanceOf Class)
.... 
```

但我认为是这样的：

```
if(this.instanceOf Class1)
    System.out.println("Hello i'm the class Listener instanced by Class1);
else if(this.instanceOf Class2)
    System.out.println("Hello i'm the class Listener instanced by Class2); 
```

这是可能的还是我白痴？;) 谢谢尼古拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:16:44.057

如果您只是在寻找调用构造函数的对象的类，那么[这个问题](https://stackoverflow.com/questions/421280/in-java-how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection)可能就是您要寻找的。获取构造函数中的堆栈跟踪，并使用它来确定哪个类调用了构造函数。

如果您正在寻找特定的 Object 引用而不是类，则需要将其作为参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:17:10.343

您可以这样做（只需删除`.`- `this instanceof ClassA`），但在我看来这是一种不好的做法。如果你想有一个依赖于子类的行为，只需在每个子类中实现一个方法并在此时调用它。

例如：

```
public class Parent
{
    public void foo()
    {
        bar();
    }

    public void bar()
    {
        System.out.println("Parent");
    }

    public static void main()
    {
        new Parent.foo(); // prints "Parent"
        new SubA.foo();   // prints "SubA"
        new SubB.foo();   // prints "SubB"
    }
}

public class SubA extends Parent
{
    @Override public void bar()
    {
        System.out.println("SubA");
    }
}

public class SubB extends Parent
{
   @Override public void bar()
    {
        System.out.println("SubB");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:18:18.213

如果我理解正确，您想知道哪些类（以及这些类的实例）包含对 Listener 类实例的引用。

一种可能的解决方案是创建一个接口（例如 ListenerHolder），该接口定义所有“侦听器持有者”必须具有的方法，并在侦听器的构造函数中接受它的实例。

```
public interface ListenerHolder {
    public void doSomething();
}

public class Listener {
    public Listener(ListenerHolder holder) {
        this.holder = holder;
    }

    public void doListener() {
        this.holder.doSomething();
    }

    private ListenerHolder holder;
} 
```

话虽如此，也许您可​​以解释您要解决的真正问题是什么。我怀疑您应该考虑原始问题的其他可能解决方案。

# c++ - 将任意数量的特定单词读入 cstring

> ID：14175359
> 
> 赞同：0
> 
> 时间：2013-01-05T19:14:00.693
> 
> 标签：c++, xcode, struct, unions, cstring

我正在尝试使用 struct/union 实现将文本文件读入 cstring 数组。首先，这是我的文本文件的样子：

```
F South Korea
Male Psy Park Jae Sang
31 - 12 - 1977
3 CSCI114 55 CSCI103 44 GangNam 100

S Female Super Junior
5 - 8 - 1978 
2 CSCI114 60 CSCI103 80

F People Republic Of China
Unknown James Bond
11 - 12 - 1976
4 CSCI114 54 CSCI124 66 CSCI007 99 CSCI123 28 
```

现在，忽略明显的亚洲流行歌星引用，我的讲师决定用这个例子来填充 - 我希望能够阅读 CSCI 之前的第一个数字，这是数字或课程及其各自的成绩，并自动（循环）它文本文件中的所有 3 名（或更多）学生。

我还没有为我在这里试图描述的内容编写任何代码，但这是我到目前为止所拥有的。

```
#include <iostream>
#include <fstream>
#include <cstdlib>
#include <ctime>
using namespace std;

const int MAX = 80;

struct Birthday
{
    char day[MAX];
    char month[MAX];
    char year[MAX];
};

struct Local
{
    char name[MAX];
    char gender[MAX];
    Birthday bd;
    char subjects [MAX];
};

struct Foreigner
{
    char name[MAX];
    char nationality[MAX];
    char gender[MAX];
    Birthday bd;
    char subjects [MAX];
};

union Student
{
    Local     localStudent;
    Foreigner foreignStudent;
};

enum CountryType {S, F};

struct UowStudents
{
    CountryType ct;
    Student st;
};

int fileToArray (fstream& afile, char fileName [], UowStudents& x);

int main ()
{
    srand(time_t(NULL));

    fstream afile;
    UowStudents x [MAX];
    char fileName[MAX];
    cout << "Enter filename: ";
    cin >> fileName;
    int size = fileToArray (afile, fileName, *x);

}

int fileToArray (fstream& afile, char fileName [], UowStudents& x)
{
    afile.open(fileName, ios::in);

    if (!afile)
    {
        cout << fileName << "could not be opened for read" << endl;
        exit (-1);
    }
    //file to array.
    char locale;
    char dateJunk;
    afile >> locale;
    afile.getline(x.st.foreignStudent.nationality, MAX);
    afile >> x.st.foreignStudent.gender;
    afile.getline(x.st.foreignStudent.name, MAX);
    afile >> x.st.foreignStudent.bd.day;
    afile >> dateJunk;
    afile >> x.st.foreignStudent.bd.month;
    afile >> dateJunk;
    afile >> x.st.foreignStudent.bd.year;

    //Tests my cstring arrays to see everything is copied in correctly.
    cout << locale << " " << x.st.foreignStudent.nationality;
    cout << endl;
    cout << x.st.foreignStudent.gender;
    cout << x.st.foreignStudent.name;
    cout << endl;
    cout << x.st.foreignStudent.bd.day << " - ";
    cout << x.st.foreignStudent.bd.month << " - ";
    cout << x.st.foreignStudent.bd.year;
    return 0;
} 
```

这是我处理完所有数组信息的最终文本文件，如下所示：

[http://i.imgur.com/HSLvp.jpg](http://i.imgur.com/HSLvp.jpg)

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:44:28.650

您可以通过这种方式阅读每个课程列表：

```
int numOfCourses;
afile >> numOfCourses;
for (int i = 0; i < numOfCourses; i++)
{
    string course;
    afile >> course;

    int grades;
    afile >> grades;

    // Fill in structure from `course` and `grades`...
} 
```

# paypal - 贝宝标准方法

> ID：14175360
> 
> 赞同：0
> 
> 时间：2013-01-05T19:14:03.413
> 
> 标签：paypal

对于我的项目，我一直在集成 PayPal 沙箱。我已将以下代码用于标准方法。但我无法收到来自 PayPal 的通知电话（notify-url）。怎么了？

```
<form id="form1" action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post" style="display:none;"  accept-charset="utf-8">
  <input type="hidden" name="business" value="test2_biz@gmail.com" />
  <input type="hidden" name="cmd" value="_cart" />
  <input type="hidden" name="paymentaction" value="sale" />
  <input type="hidden" name="item_name_1" value="lap" />
  <input type="hidden" name="amount_1" value="1" />
  <input type="hidden" name="quantity_1" value="1" />
  <input type="hidden" name="first_name" value="1" /><!--customer first name -->
  <input type="hidden" name="last_name" value="1" /><!--customer last name -->
  <input type="hidden" name="address1" value="1" /><!--customer address 1 name -->
  <input type="hidden" name="address2" value="1" /><!--customer add2 name -->
  <input type="hidden" name="email" value="dfd@rr.ee" /><!--customer email name -->
  <input type="hidden" name="city" value="1" /><!--customer city name -->
  <input type="hidden" name="state" value="1" /><!--customer state name -->
  <input type="hidden" name="country" value="1" /><!--customer country name -->
  <input type="hidden" name="zip" value="1" /><!--customer zip name -->
  <input type="hidden" name="currency_code" value="USD" /><!--currrecy in which payment u need-->
  <input type="hidden" name="upload" value="1" /><!--paypal parameter-->
  <input type="hidden" name="return" value="HOST_NAME/default/index/order-return" />
  <input type="hidden" name="cancel_return" id="cancel_return" value="" />
  <input type="hidden" name="notify_url" id="notify_url" value="HOST_NAME/default/index/notify-url/order/222">
  <input type="submit" value="submit">
  </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:31:45.963

正如我在评论中写给你的那样，你应该有一个适当的 IPN 侦听器和 PayPal 的消息验证，以认为对你的 URL 的调用是成功的。这是一个基本监听器的粗略示例：

```
 <?php

    function validateIpnMessage() {
        $ch = curl_init('https://www.sandbox.paypal.com/cgi-bin/webscr');
        curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, "cmd=_notify-validate&".http_build_query($_POST));
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_FORBID_REUSE, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: Close'));

        if( !curl_errno($ch)) {
            $res = curl_exec($ch);
            curl_close($ch);
            if ($res === "VERIFIED") {
                return TRUE;
            }
        }

        return FALSE;
    }

    if ($_SERVER['REQUEST_METHOD'] == 'POST' && !empty($_POST)) {
        if(validateIpnMessage()) {
            // THE MESSAGE IS VALIDATED

            // REST OF YOUR CODE GOES HERE
        }
    }
?> 
```

您是否确保在您的个人资料中启用了 IPN？无论如何，我建议您首先通过使用 IPN 测试工具手动测试来检查您的侦听器 URL 是否有效（可在您的[PayPal Sandbox帐户中的“测试工具”下找到）](https://developer.paypal.com)

# jquery - 如何从 li 列表中的链接获取 href 值？

> ID：14175361
> 
> 赞同：9
> 
> 时间：2013-01-05T19:14:12.837
> 
> 标签：jquery

这是一个[**小提琴**](http://jsfiddle.net/nLyqA/)

我想获取`href`属性，我用`$(this).attr('href')`了但是不行！

**HTML** ：

```
<div class="wrap_atletas_interno">
    <ul>
        <li class="atleta">
            <a href="teste.html">
                <div class="nome_86_atleta">Antônio</div>
                <img src="atletas/antonio_86px.jpg" />
            </a>
        </li>
        <li  class="atleta">
            <div class="nome_86_atleta">Cauê</div>
            <img src="atletas/caue_86px.jpg" />
        </li>
        <li class="atleta">
            <div class="nome_86_atleta">Dudu</div>
            <img src="atletas/dudu_86px.jpg" />
        </li>
    </ul>
</div> 
```

**JavaScript**：

```
$('.atleta').click(function (e) {
    e.preventDefault();
    $('.atleta').removeClass('atleta_atual');
    $(this).addClass('atleta_atual');
    var h = $(this).attr('href');
    alert(h);
    $.get(h, function (data) {
        //$(".detalhes_atleta").html(data).fadeIn("slow");
        alert(h);
    });
}); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-05T19:19:14.507

[检查更新的小提琴](http://jsfiddle.net/nLyqA/2/)

改变了

```
var h = $("a",this).attr('href'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:19:31.527

`$(this)`指`li`的是链接的父级。你需要使用

```
$(this).find('a').attr('href'); 
```

另外请修复您的`html`, 块元素不应该在内联元素中。

在您的情况下，`div`不应该在`a`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:28:30.793

您想要`href`来自 的属性`a`，但`$(this)`在您的示例中是针对 的`li`，这就是它不起作用的原因。

为什么不设置点击事件`a`呢？

例子：`$('.atleta a').click(function(e) ...`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T19:16:53.460

尝试

```
var h = $('a', this).attr('href'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-05T19:17:34.243

试试这个

```
 var href= $('a',this).length>0? $('a',this).attr('href') : ''; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-05T19:21:30.523

在这里，`$this`是指向`<li>`但你需要的`href`attr`<a>`所以找到`<a>`里面`<li>`并获取 attr `href`...

尝试这个

```
$(this).find('a').attr('href'); 
```

# mysql - 正确使用 SQL 中表之间的多对多关系？

> ID：14175367
> 
> 赞同：0
> 
> 时间：2013-01-05T19:15:06.703
> 
> 标签：mysql, sql, database, foreign-keys

我有一个作业（因此请相应地回答），其中包括 Animals 和 Zookeepers 之间的多对多关系，并且我设置了我的 SQL 来创建这种关系，如下所示：

```
CREATE TABLE Animal
( 
    animalID VARCHAR(5) NOT NULL PRIMARY KEY,
    -- more rows created here;
);

CREATE TABLE Zookeeper 
( 
    employeeID VARCHAR(5) NOT NULL PRIMARY KEY,
    -- more rows created here;
);

CREATE TABLE Animal_Zookeeper
(
    animal_id VARCHAR(5) NOT NULL,
    employee_id VARCHAR(5) NOT NULL,
    PRIMARY KEY (employee_id, animal_id)
);

-- insert data to Animal/Zookeeper tables

ALTER TABLE Animal_Zookeeper
    ADD CONSTRAINT FK_Animal_Zookeper_Relation_1
    FOREIGN KEY (animal_id)
    REFERENCES Animal(animalID)
    ON UPDATE RESTRICT
    ON DELETE RESTRICT,
    ADD CONSTRAINT FK_Animal_Zookeeper_Relation_2
    FOREIGN KEY (employee_id)
    REFERENCES Zookeeper(employeeID)
    ON UPDATE RESTRICT
    ON DELETE RESTRICT; 
```

我想检查这是否是表示这种关系的正确方式，或者我是否遗漏了一些东西，因为我对这意味着什么并不完全有信心（澄清一下会很好：D）。我也有一个零或多对一或多的关系来表示，这是否与上述相同？

在此先感谢，正如我所说的那样，这是一项任务，所以不要为我做，只需检查一下，一些指针会有所帮助：p

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:21:56.540

这是一个适当的多对多设置。对于 0/1 对多，您只需消除 animal_zookeeper 表，并将关系移动到父动物和/或 zookeeper 表之一，例如：

```
table animal {
  ...
  zookeeper foreign key ...
} 
```

这将允许**一个**动物园管理员被分配给一只动物，但同一个动物园管理员可以有多个动物分配给他们。如果您要求动物拥有 zookeeper，则 zookeeper 字段为“not null”。如果你想拥有没有 zookeeper 的“孤儿”动物，你可以在 zookeeper 字段中允许空值。

* * *

编辑：集合论

将您的两个表视为记录集：一组动物园管理员和一组动物。

这是 1:many 的设置，其中动物是很多的，而动物园管理员是其中的一个。请注意，“一个”并不意味着只有一个动物园管理员。x:y 的东西是指表中的**记录**。一个动物园管理员记录可以有许多指向它的动物记录。这并不意味着你有一个动物园管理员来照顾整个动物园。

```
 table animals {
     id
     zookeeper foreign key (zookeepers.id) default null
 }

 table zookeepers {
     id
 } 
```

如果您有动物园管理员“John”和“Jane”，那么任何给定的动物都可以分配给他们中的任何一个（或两者都没有）。

```
 (many)    (one/none)
 tiger     John
 leopard   John
 monkey    (null)    <--monkey is orphaned, with no zookeeper assigned.
 elephant  Jane 
```

所以约翰在照顾老虎和豹子（一个动物园管理员，很多动物），简有大象（一对多，碰巧是一对一），猴子独自一人，没有人。但是你永远不会得到`John: monkey + Jane: monkey`，因为这些动物只能有一个动物园管理员分配给它们。

要执行 one:many，意味着没有孤儿动物，您可以将您的动物更改为：

```
table animal {
   id
   zookeeper foreign key (zookeepers.id) NOT NULL
                                        ^^^^^^^^^
} 
```

现在猴子不能有“没有人”，因为数据库强制你为猴子分配一个动物园管理员。它仍然是 1:m，但您现在已经不允许 0:m 的情况。

1:m “恰好存在一个 X 可以分配多个 Y”。例如，一个动物园管理员可以处理多只动物，但每只动物只能分配一个动物园管理员。反之亦然 - 一只动物可以有多个饲养员，但每个饲养员只能有一只动物

米：米：敞开的，多种动物以不同的组合与多个动物园管理员相关联。这是最灵活的设置，允许任意组合 zookeeper:animal 关系。但它的副作用是很难防止 0:m 的情况，而不在 zookeeper_animal 表上添加 CHECK CONSTRAINTS，并非所有数据库都支持（例如 mysql）。

# safari - css 线性渐变拉丝金属效果不适用于 Safari 中的较大宽度

> ID：14175371
> 
> 赞同：2
> 
> 时间：2013-01-05T19:15:26.907
> 
> 标签：safari, linear-gradients, css

我正在尝试在大型表面上的 safari 中使用拉丝金属效果。这个想法来自这里：[http ://simurai.com/post/9214147117/css3-brushed-metal](http://simurai.com/post/9214147117/css3-brushed-metal)

话虽如此，在 Safari 中，渐变是关闭的，并且在较大的宽度处有粗的白色和黑色线条，这破坏了效果。我尝试过调整渐变，经过多次尝试，我未能成功摆脱粗线。

在其他浏览器（包括 Chrome）中看起来不错。据我所知，该问题仅发生在 Safari 中。

JS Fiddle 为方便起见：http: [//jsfiddle.net/Qzdme/2/](http://jsfiddle.net/Qzdme/2/)

相关CSS：

```
 /* Setting min-width because problem is only noticeable at larger widths */
    min-width: 900px;           
    background-image:   -webkit-repeating-linear-gradient(left, hsla(0,0%,100%,0) 0%, hsla(0,0%,100%,0)   6%, hsla(0,0%,100%, .1) 7.5%),                    
                        -webkit-repeating-linear-gradient(left, hsla(0,0%,  0%,0) 0%, hsla(0,0%,  0%,0)   4%, hsla(0,0%,  0%,.03) 4.5%),                    
                        -webkit-repeating-linear-gradient(left, hsla(0,0%,100%,0) 0%, hsla(0,0%,100%,0) 1.2%, hsla(0,0%,100%,.15) 2.2%),
                        -webkit-linear-gradient(-90deg, hsl(0,0%,78%)  0%, 
                                                        hsl(0,0%,90%) 47%, 
                                                        hsl(0,0%,78%) 53%,
                                                        hsl(0,0%,70%)100%); 
```

**更新**：我能够通过增加第二个重复线性渐变的亮度来摆脱粗黑线：http: [//jsfiddle.net/Qzdme/3/](http://jsfiddle.net/Qzdme/3/) 但我仍然看到粗白线......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T06:05:28.450

检查这个小提琴， [http://jsfiddle.net/siyakunde/Qzdme/38/](http://jsfiddle.net/siyakunde/Qzdme/38/)

我已经给了`background-size`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:01:52.147

重复梯度在最大 % hsl 值和新的 0% 值的开始之间转换时并不智能。您可以尝试逐渐过渡回第一组 hsl 值，例如：

```
div {
  height: 200px;
  min-width: 900px;         
  background-image:     -webkit-repeating-linear-gradient(left, hsla(0,0%,100%,0) 0%, hsla(0,0%,100%,0)   6%, hsla(0,0%,100%, .1) 7.5%, hsla(0,0%, 100%,0) 9%),                 
            -webkit-repeating-linear-gradient(left, hsla(0,0%,  0%,0) 0%, hsla(0,0%,  0%,0)   4%, hsla(0,0%,  0%,.03) 4.5%, hsla(0,0%,  0%,0) 6%),                  
            -webkit-repeating-linear-gradient(left, hsla(0,0%,100%,0) 0%, hsla(0,0%,100%,0) 1.2%, hsla(0,0%,100%,.15) 2.2%, hsla(0,0%,100%,0) 4%),
            -webkit-linear-gradient(-90deg, hsl(0,0%,78%)  0%, 
                            hsl(0,0%,90%) 47%, 
                            hsl(0,0%,78%) 53%,
                            hsl(0,0%,70%)100%);

} 
```

这是 jsfiddle 版本：http: [//jsfiddle.net/Qzdme/35/](http://jsfiddle.net/Qzdme/35/)

放大后，这似乎看起来更平滑一些。祝你好运！

# python - 为什么特定的导入会看到其他导入？蟒蛇2.6

> ID：14175381
> 
> 赞同：0
> 
> 时间：2013-01-05T19:16:34.930
> 
> 标签：python

我有两个文件。SysDump.py`from libApi import _SysDump`和另一个文件 libApi.py 我有很多类，其中一个是

```
class _SysDump():
    import cPickle as _cPickle
    import math as _math
    from zipfile import ZipFile as _ZipFile
    import re as _re 
```

问题是 SysDump 中的导入不仅可以看到 libApi.py 中的 _SysDump，还可以看到其他类！如何防止它在其他类中看到？

蟒蛇 2.6。是的，我确实有一个`__init__.py`. 它可以以任何方式帮助带来我希望的隐私吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:20:41.970

Python 没有隐私的概念。如果您试图将一个模块中的信息隐藏到另一个导入它的模块中，则不能。这是来自其他编程语言的概念，在 Python 中没有并行性。

# algorithm - 支持减少键的有序字典？

> ID：14175387
> 
> 赞同：8
> 
> 时间：2013-01-05T19:17:02.530
> 
> 标签：algorithm, data-structures, decrease-key

许多快速优先级队列（例如[斐波那契堆](http://en.wikipedia.org/wiki/Fibonacci_heap)和[配对堆](http://en.wikipedia.org/wiki/Pairing_heap)）支持减少键操作，该操作采用已存储在优先级队列中的元素并有效地降低其优先级。在斐波那契和配对堆的情况下，减少键的执行速度比从优先级队列中删除元素并稍后重新插入它要快。

我想知道有序字典结构（二叉搜索树、跳过列表等）是否可以支持类似的操作。具体来说，假设我有一个有序字典，并且想要将某个键/值对的键更改为不同的键。在有序字典的任何标准表示上是否可以在 O(1) 或 O(log log n) 时间内做到这一点？我很好奇，因为使用平衡的 BST，这可以通过移除元素并重新插入它在 O(log n) 时间内完成，但似乎可能有更快的方法来做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T10:55:44.070

想象以下场景：

你开始 N 个元素。现在，

1.  您创建一个大小为 N 的“有序字典”，其中包含大于任何元素的某个值 X 的 N 个副本。
2.  然后在每个 X 上调用 reduction-key，将其更改为 N 个实元素之一。
3.  遍历字典，按顺序读出元素。

在大多数有序字典的实现中，步骤 1 和 3 都将花费 O(N) 时间。如果减少键需要 O(1) 或 O(log log N) 时间，则步骤 2 需要 O(N) 或 O(N log log N) 时间。这意味着您可以在 O(N) 或 O(N log log N) 时间内进行排序。

通过基于比较的排序的 O(N log N) 下限，这意味着您不能在 O(1) 或 O(N log log N) 时间内执行减少键，除非

*   您的有序字典不是基于比较（通常只有在您知道元素的特殊情况时才会发生这种情况，例如它们都在 1-100 范围内），或者
*   您的有序字典不支持 O(N) 时间内的步骤 1 和 3（这将排除所有常见的嫌疑人，例如 BST 或跳过列表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:22:15.357

排序数组或排序链表支持`O(1)`减少或增加键（假设没有/最少重复，请参阅第 4 段）。这是因为，如果您考虑一下，您最多需要交换 2 个元素来进行减键或增键操作。

不是实践中最好的数据结构（尽管它们有自己的位置），但仍然是一个答案。

唯一的限制是您需要一个指向该节点的指针才能开始，因为它已经`O(log n)`分别`O(n)`用于查找该节点。

如果有重复，则移动可能`O(n)`对两者都采取最坏的情况（如果大多数值相同），这是非常糟糕的。但是，对于链表，应该可以`O(1)`通过具有某种链表的链表来获得，其中大链表中的每个节点代表一个特定的值，并且从那里的每个链表代表所有节点等于那个值。

## 我关于为什么 BBST 或跳过列表不起作用的原始答案：

（没有删除，因为浪费似乎很可惜）

对于 BBST 或跳过列表来说，最坏的情况小于`O(log n)`移动单个元素是不可能的，尽管据我所知，它**至少与 re-insert 一样有效**。平均情况可能小于`O(log n)`.

**我们正在寻找它 -**查找只是为了找到您想要移动的元素的位置，`O(log n)`显然您需要这样做。

如果您出于某种奇怪的原因已经拥有该职位：

**为什么最坏情况的移动不能少于`O(log n)`BST：**考虑当试图移动根并且下一个元素位于树的高度时（例如，右孩子有一个左孩子，一个左孩子有一个左孩子左孩子...下降到树的高度）。你需要`O(log n)`找到它。

**为什么最坏情况下的移动不能少于`O(log n)`跳过列表：**考虑一个存在于`O(log n)`列表中的项目，然后是一个存在于`O(log n)`这些列表中的项目（如果可能的话，从[图片](http://en.wikipedia.org/wiki/Skiplists)中可以看出，我对跳过列表有点基本）。您显然需要交换`O(log n)`列表中的适用项目。

如果您已经拥有该职位，则可能存在一个有效的有序结构，但可能不适用于任何基于树的结构（因为上面提出的论点），据我所知，大多数有效的有序结构结构。

# c++ - 向量 来自 STD 的对象不会在头文件之外显示完成

> ID：14175390
> 
> 赞同：0
> 
> 时间：2013-01-05T19:17:14.230
> 
> 标签：c++, autocomplete, codeblocks

**编辑：解决方案：重新声明“使用命名空间标准；” 在 .cpp 文件中！**

我正在使用 Code::Blocks，我无法获得一个矢量对象来向我展示它在我声明它的标头之外的可用函数！

我无法获得显示我可以对对象执行的所有功能的框。

我的 .h 中有这个：

```
 vector<DrawObject> objects; 
```

在我的 .cpp （.h 文件）中，这样做不会显示任何内容：

```
 objects. 
```

如果我做对象。在 .cpp 上，它会显示应有的一切。它会起作用，这只是一个小麻烦，但它会很方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:28:32.630

这是设计使然，我怀疑您无能为力。

C++ 的代码完成很难，因为 IDE 本质上需要编译整个（可能不完整和错误的）代码。无论如何，C++ 都很难解析，更不用说必须关心不完整代码的连续后台编译。

因此，大多数 IDE（包括 Code::Blocks）实际上并没有实现完整的解析器，只是一个非常基本的子集，并且代码完成非常原始。

这在未来可能会改变，因为现在有一个强大且相当有效的解决方案，称为[libclang](http://clang.llvm.org/doxygen/group__CINDEX.html)。但在 Code::Blocks 被修补以在内部使用它之前，这种行为将持续存在。

# c# - TranslateTransform 取消 ScaleTransform

> ID：14175404
> 
> 赞同：3
> 
> 时间：2013-01-05T19:18:19.227
> 
> 标签：c#, .net, wpf

我是 WPF 的新手，在玩了很多之后，我终于按照我正在工作的项目中想要的方式安排了我的控件。我有一个显示图像的矩形。鼠标滚轮用动画缩放图像，`ScaleTransform`鼠标单击/拖动在屏幕上移动图像。问题是如果我放大或缩小图像然后尝试移动它，它会自动将其自身缩放回 1（原始大小）。有没有办法在缩放时移动它？编辑：我尝试将 ScaleTransform 和 TranslateTransform 设置为 TransformGroup，但仍然没有用。

我遇到的另一个问题是，如果图像大于父容器，它会超出范围，我尝试`ClipToBounds = True`在父容器上进行设置，但它不起作用。

代码：

```
private void Window_MouseWheel_1(object sender, MouseWheelEventArgs e)
{
    if (e.Delta > 0)
    {
        ScaleTransform scaleP = new ScaleTransform();
        scaleP.CenterX = e.GetPosition(this).X;
        scaleP.CenterY = e.GetPosition(this).Y;

        rect.RenderTransform = scaleP;

        DoubleAnimation dblAnimX = new DoubleAnimation();
        dblAnimX.From = scaleXFrom;
        dblAnimX.To = scaleXTo + 0.1;
        scaleXFrom = scaleXTo +0.1;
        scaleXTo += 0.1;
        Duration = new Duration(TimeSpan.FromSeconds(0.15));

        DoubleAnimation dblAnimY = new DoubleAnimation();
        dblAnimY.From = scaleYFrom;
        dblAnimY.To = scaleYTo + 0.1;
        scaleYFrom = scaleYTo +0.1;
        scaleYTo += 0.1;
        Duration = new Duration(TimeSpan.FromSeconds(0.15));

        scaleP.BeginAnimation(ScaleTransform.ScaleXProperty, dblAnimX);
        scaleP.BeginAnimation(ScaleTransform.ScaleYProperty, dblAnimY);
    }
    else
    {
        ScaleTransform scaleM = new ScaleTransform();
        scaleM.CenterX = e.GetPosition(this).X;
        scaleM.CenterY = e.GetPosition(this).Y;

        rect.RenderTransform = scaleM;                           

        DoubleAnimation dblAnimX = new DoubleAnimation();
        dblAnimX.From = scaleXFrom;
        dblAnimX.To = scaleXTo -0.1;
        scaleXFrom = scaleXTo -0.1;
        scaleXTo -= 0.1;
        dblAnimX.Duration = new Duration(TimeSpan.FromSeconds(0.15));

        DoubleAnimation dblAnimY = new DoubleAnimation();
        dblAnimY.From = scaleYFrom;
        dblAnimY.To = scaleYTo - 0.1;
        scaleYFrom = scaleYTo -0.1;
        scaleYTo -= 0.1;
        Duration = new Duration(TimeSpan.FromSeconds(0.15));

        scaleM.BeginAnimation(ScaleTransform.ScaleXProperty, dblAnimX);
        scaleM.BeginAnimation(ScaleTransform.ScaleYProperty, dblAnimY);
    }
}

private void rect_MouseMove_1(object sender, MouseEventArgs e)
{
    if (e.LeftButton == MouseButtonState.Pressed)
    {
        System.Windows.Point p = e.GetPosition(this);
        TranslateTransform tt = new TranslateTransform();
        tt.X = (p.X - mouseDownX);
        tt.Y = (p.Y - mouseDownY);

        rect.RenderTransform = tt;

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:33:56.840

或者您使用[MatrixTransform](http://msdn.microsoft.com/en-us/library/ms635220.aspx)：

```
var matrix = Matrix.Identity;
matrix.Scale(1.5, 2.5);
matrix.Translate(30, 60);
rect.RenderTransform = new MatrixTransform(matrix); 
```

甚至更短：

```
var matrix = new Matrix(1.5, 0, 0, 2.5, 30, 60);
rect.RenderTransform = new MatrixTransform(matrix); 
```

或者更好的是，您避免每次都设置一个新的 RenderTransform 并且只更新变换矩阵：

```
// set RenderTransform once in constructor
rect.RenderTransform = new MatrixTransform()

...

// update matrix in event handler
((MatrixTransform)rect.RenderTransform).Matrix = new Matrix(...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:26:42.930

我没有根据您的情况调整以下示例，因为您提供的代码很长。如果可以的话，请考虑只发布它的关键部分。

要组合不同类型的`Transform`，您可以使用`TransformGroup`, 以这种方式。

```
void Button_Click_1(object sender, RoutedEventArgs e)
{
    var button = sender as Button;
    var transformGroup = new TransformGroup();
    var scale = new ScaleTransform(1.5, 2.5);
    var translate = new TranslateTransform(30, 60);
    transformGroup.Children.Add(scale);
    transformGroup.Children.Add(translate);
    button.RenderTransform = transformGroup;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-26T21:14:27.930

我还尝试将 MatrixTransform 与鼠标事件一起使用，并成功使其像这样工作：

```
public partial class MainWindow : Window
{
    ....
    // MyMatrixTransform could directly be defined in the xaml file        
    private MatrixTransform MyMatrixTransform = new MatrixTransform();

    public MainWindow()
    {
        InitializeComponent();
        MyMatrixTransform= new MatrixTransform();
        // MyCanvasArea is a canvas defined in the xaml file
        MyCanvasArea.RenderTransform = MyMatrixTransform;
        .....
    }

    // canvas_MouseWheel is attached to canvas in the xaml file as follow
    // <Canvas x:Name="MyCanvasArea" MouseWheel="canvas_MouseWheel" />
    void canvas_MouseWheel(object sender, MouseWheelEventArgs e)
    {
        if (e.Delta > 0)
        {
            Matrix matrix = MyMatrixTransform.Matrix;
            matrix.Scale(1.1, 1.1);
            MyMatrixTransform.Matrix = matrix;
        }
        else
        {
            Matrix matrix = MyMatrixTransform.Matrix;
            matrix.Scale(0.9, 0.9);
            MyMatrixTransform.Matrix = matrix;
        }
    }
    ....
} 
```

可能可以直接访问 MatrixTransform 中的 Matrix 字段，但我找不到方法。

# jboss - 通过 jndi 配置数据源时启动 jboss 服务器时出错

> ID：14175405
> 
> 赞同：4
> 
> 时间：2013-01-05T19:18:27.250
> 
> 标签：jboss

我正在尝试通过 jboss 中的 jndi 配置数据源。

启动服务器时出现以下错误

```
 2013-01-06 00:18:01,078 ERROR [ProfileServiceBootstrap] (Thread-2) Failed to load profile:: org.jboss.deployers.client.spi.IncompleteDeploymentException: Summary of incomplete deployments (SEE PREVIOUS ERRORS FOR DETAILS):

    *** DEPLOYMENTS MISSING DEPLOYERS: Name

    vfs:///D:/downloads/jboss-6.1.0.Final/server/default/deploy/jboss-local-jdbc.rar

    DEPLOYMENTS MISSING DEPENDENCIES:
      Deployment "jboss-switchboard:appName=practice,module=practice" is missing the following dependencies:
        Dependency "java:/DefaultDS" (should be in state "Installed", but is actually in state "** NOT FOUND Depends on 'java:/DefaultDS' **")
      Deployment "jboss.web.deployment:war=/practice" is missing the following dependencies:
        Dependency "jboss-switchboard:appName=practice,module=practice" (should be in state "Installed", but is actually in state "Create")
      Deployment "jboss:service=KeyGeneratorFactory,type=HiLo" is missing the following dependencies:
        Dependency "jboss.jca:name=DefaultDS,service=DataSourceBinding" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.jca:name=DefaultDS,service=DataSourceBinding' **")

    DEPLOYMENTS IN ERROR:
      Deployment "java:/DefaultDS" is in error due to the following reason(s): ** NOT FOUND Depends on 'java:/DefaultDS' **
      Deployment "jboss.jca:name=DefaultDS,service=DataSourceBinding" is in error due to the following reason(s): ** NOT FOUND Depends on 'jboss.jca:name=DefaultDS,service=DataSourceBinding' **
      Deployment "vfs:///D:/downloads/jboss-6.1.0.Final/server/default/deploy/oracle-ds.xml" is in error due to the following reason(s): java.lang.IllegalStateException: No ConnectorMetaData found for mdf rarName: jboss-local-jdbc.rar

        at org.jboss.deployers.plugins.deployers.DeployersImpl.checkComplete(DeployersImpl.java:1228) [:2.2.2.GA]
        at org.jboss.deployers.plugins.main.MainDeployerImpl.checkComplete(MainDeployerImpl.java:905) [:2.2.2.GA]
        at org.jboss.system.server.profileservice.deployers.MainDeployerPlugin.checkComplete(MainDeployerPlugin.java:87) [:6.1.0.Final]
        at org.jboss.profileservice.deployment.ProfileDeployerPluginRegistry.checkAllComplete(ProfileDeployerPluginRegistry.java:107) [:0.2.2]
        at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:135) [:6.1.0.Final]
        at org.jboss.system.server.profileservice.bootstrap.BasicProfileServiceBootstrap.start(BasicProfileServiceBootstrap.java:56) [:6.1.0.Final]
        at org.jboss.bootstrap.impl.base.server.AbstractServer.startBootstraps(AbstractServer.java:827) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
        at org.jboss.bootstrap.impl.base.server.AbstractServer$StartServerTask.run(AbstractServer.java:417) [jboss-bootstrap-impl-base.jar:2.1.0-alpha-6]
        at java.lang.Thread.run(Thread.java:662) [:1.6.0_31]

    2013-01-06 00:18:01,156 INFO  [org.apache.coyote.http11.Http11Protocol] (Thread-2) Starting Coyote HTTP/1.1 on http-127.0.0.1-8080
    2013-01-06 00:18:01,171 INFO  [org.apache.coyote.ajp.AjpProtocol] (Thread-2) Starting Coyote AJP/1.3 on ajp-127.0.0.1-8009
    2013-01-06 00:18:01,171 INFO  [org.jboss.bootstrap.impl.base.server.AbstractServer] (Thread-2) JBossAS [6.1.0.Final "Neo"] Started in 2m:57s:984ms 
```

以下是 $JBOSS_HOME\server\default\deploy 目录中的 oracle-ds.xml 文件

口语-ds.xml .................................................. .....................................

```
 <datasources>
      <local-tx-datasource>
        <jndi-name>DefaultDS</jndi-name>
        <connection-url>jdbc:oracle:thin:@localhost:1521:myDB</connection-url>
        <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>
        <user-name>user_name</user-name>
        <password>pwd</password>
        <min-pool-size>5</min-pool-size>
        <max-pool-size>20</max-pool-size>
        <!-- Checks the Oracle error codes and messages for fatal errors -->
        <exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.OracleExceptionSorter</exception-sorter-class-name>

         <metadata>
             <type-mapping>Oracle9i</type-mapping>
          </metadata>
      </local-tx-datasource>

    </datasources> 
```

web.xml 的内容

```
 web.xml
    ....................................................
    <resource-ref>
          <description>Oracle DS</description>
          <res-ref-name>jdbc/DefaultDS</res-ref-name>
          <res-type>javax.sql.DataSource</res-type>
          <res-auth>Container</res-auth>
    </resource-ref> 
```

jboss-web.xml 的内容

```
 jboss-web.xml
    ..................................................
    <?xml version="1.0" encoding="UTF-8"?>
    <jboss-web>
        <resource-ref>
            <res-ref-name>jdbc/DefaultDS</res-ref-name>
            <res-type>javax.sql.DataSource</res-type>
            <jndi-name>java:/DefaultDS</jndi-name>
        </resource-ref>
    </jboss-web>

Any help will be appreciated. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T09:32:34.913

JBoss 使用 DefaultDS。您必须将“DefaultDS”更改为另一个名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-06T12:12:23.310

您的部署中缺少 jboss-local-jdbc.rar，尝试获取它并将其放在部署文件夹中。

# java-me - 在 J2ME 中，是否有任何方法或属性类似于 gotFocus 和 lostFocus 控制的功能

> ID：14175412
> 
> 赞同：1
> 
> 时间：2013-01-05T19:19:21.977
> 
> 标签：java-me, lcdui

在我的 J2ME 应用程序中，我想在获得名为 as 的选择组控制的焦点时添加一个播放命令，`Tones`并且在失去对选择组控制的关注后，应该删除该命令。

我该怎么做？

**更新：**

这是我的代码：

```
 import javax.microedition.midlet.*;

 import javax.microedition.lcdui.*;

 public class Focusoncontrol extends MIDlet implements CommandListener
 {  
    Display disp;

    TextField Text1, Text2, Text3;
    ChoiceGroup Tones;
    Form frm;
    Command Save, Back, Play;

    public Focusoncontrol()
    {
        disp = Display.getDisplay(this);
        frm  = new Form("Focus demo");
        Text1 = new TextField("Text1", "", 20, 0);
        Text2 = new TextField("Text2", "", 20, 0);
        Text3 = new TextField("Text3", "", 20, 0);
        Tones = new ChoiceGroup("Tones", Choice.POPUP, new String[]{"Tone 1", "Tone 2"}, null);
        Save = new Command("Save", Command.SCREEN, 1);
        Back = new Command("Back", Command.EXIT, 3);
        Play = new Command("Play", Command.OK, 2);

        frm.append(Text1);
        frm.append(Text2);
        frm.append(Tones);
        frm.append(Text3);
        frm.addCommand(Save);
        frm.addCommand(Back);
        frm.setCommandListener(this);

        disp.setCurrent(frm);
    }

    public void startApp() 
    {
    }

    public void pauseApp() 
    {
    }

    public void destroyApp(boolean unconditional) 
    {
    }

    public void commandAction(Command c, Displayable d) 
    {
        if(c == Back)
        {
            destroyApp(true);
            notifyDestroyed();
        }
    }
} 
```

我没有在应用程序初始化期间添加播放命令，因为我必须在 Tones（ChoiceGroup 控件）获得焦点时在表单上添加播放命令，并在 ChoiceGroup 控件失去焦点时删除命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T12:47:18.773

`ChoiceGroup`是一个`Item`对象，要使用您描述的命令，您需要 **[ItemCommandListener](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/ItemCommandListener.html "API 文档")**：

> 一种侦听器类型，用于接收已在[Item](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Item.html)对象上调用的命令的通知。一个项目可以`Commands`与之关联。当调用此类命令时，应用程序会通过调用[setItemCommandListener()](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Item.html#setItemCommandListener%28javax.microedition.lcdui.ItemCommandListener%29)调用已在 Item 上设置的[commandAction()](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/ItemCommandListener.html#commandAction%28javax.microedition.lcdui.Command,%20javax.microedition.lcdui.Item%29)方法来通知应用程序...`ItemCommandListener`

要为选择组设置“播放”命令，请使用方法`Item.addCommand(Command)`：

```
Tones.addCommand(Play); // add command to item
Tones.setItemCommandListener(/*... define  item cmd listener*/); // set listener 
```

上面的代码可以例如在调用`disp.setCurrent(frm)`您的代码片段之前编写。

# backbone.js - 如果对象只是 Handlebars.js 中的一个值怎么办？

> ID：14175414
> 
> 赞同：1
> 
> 时间：2013-01-05T19:19:43.460
> 
> 标签：backbone.js, handlebars.js

将[handlebars.js](http://handlebarsjs.com/)模板与backbone.js 一起使用。将视图连接到仅包含整数值的模型。它不是一个对象，它只是一个整数值。

通常在使用把手时，假设所有数据都在一个封装对象内，所以为了访问模板内的字段，我可以这样做：

```
{{物业名称}} 

```

如果没有属性，我只想显示对象值本身，我该怎么办？有没有办法使用 handlebars.js 模板来做到这一点，或者我是否需要使用`parse()`模型中的方法将整数值操作到对象中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:23:08.733

您要查找的关键字是`{{this}}`.

奇怪的是`{{.}}`，由于对路径的相对上下文支持，例如`../parent`.

# sql - 在 sql server 中执行 COUNT 和 PERCENTAGE 的最佳方法是什么？

> ID：14175417
> 
> 赞同：0
> 
> 时间：2013-01-05T19:20:00.597
> 
> 标签：sql, sql-server-2008, sql-server-2005

我有 3 个字段名，年龄、性别和同意。

同意有 2 种类型的值 - 同意和不同意。

我想要做的是获得同意的 COUNT 和 % 的年龄和性别，以及具有 Not Agreed 值的 COUNT 和 % 的年龄和性别。

我们希望布局类似于：

```
AGE           GENDER            AGREED
93 600  40%   Female 700 62%   Agreed
   1300 60%          320 38%   Not Agreed 
```

首先，请记住我只是编造了数字，但从上面的示例中，我试图展示我们想要的布局。

每个年龄将有 2 组值。同意的人数及其百分比*和*未同意的人数及其百分比。

与性别相同。

我希望这不会令人困惑。

以下是我正在使用的代码，但相信我走错了路。

提前非常感谢。

```
Select gender, age, agreed, count(agreed)totalAgreed,Agreed = convert(VARCHAR,convert(MONEY,100.0 * count(agreed) /(SELECT count(agreed) FROM   myTable)), 1) + '%' 

From myTable
Group By gender, age, agreed 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:26:43.220

您只需要按性别和年龄汇总即可获得计数。您可以根据需要使用条件聚合。以下查询以数字形式获取计数和百分比。

```
select gender, age, count(*) as cnt,
       sum(case when agreed = 'Agreed' then 1 else 0 end) as NumAgreed,
       sum(case when agreed = 'NotAgreed' then 1 else 0 end) as NotAgreed,
       avg(case when agreed = 'Agreed' then 1.0 else 0 end) as NumAgreedRatio,
       avg(case when agreed = 'NotAgreed' then 1.0 else 0 end) as NotAgreedRatio
from myTable
group by gender, age 
```

表格与您想要的表格有点不同。这也有效吗？此外，我没有费心将数字转换为百分比，因为我喜欢将数字保留为数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:39:45.090

看看这个 SQL Fiddle：

[http://sqlfiddle.com/#!3/9cc6d/9](http://sqlfiddle.com/#!3/9cc6d/9)

```
--Returns count of agreed by gender:
SELECT Gender, Agreed, COUNT(*) as [Count]
FROM MyTable GROUP BY Agreed, Gender;

--Returns count of agreed overall:
SELECT Agreed, COUNT(*) as [Count]
FROM MyTable GROUP BY Agreed;

--Returns count of agreed by gender with percentages
With Overall as (SELECT CAST(COUNT(*) AS FLOAT) as [Count] FROM MyTable)
    SELECT mt.Gender, mt.Agreed, COUNT(*) as [Count], CAST(COUNT(*) AS FLOAT) / o.Count as [Percentage]
FROM MyTable mt
    CROSS JOIN Overall o
GROUP BY mt.Agreed, mt.Gender, o.Count; 
```

这应该让你开始。

如果您想将数据集转换为单行，您可以在表示层中处理它，手动为每列执行子选择，或者使用 SQL 的 PIVOT 功能，您可以在此处了解：[http://nycdotnet .blogspot.com/2012/07/pattern-for-pivot.html](http://nycdotnet.blogspot.com/2012/07/pattern-for-pivot.html)

# python - 使用 PyGTK 为 xscreensaver 创建屏幕保护程序

> ID：14175419
> 
> 赞同：1
> 
> 时间：2013-01-05T19:20:12.133
> 
> 标签：python, pygtk, screensaver

我想创建一个用 Python 和 PyGTK 编写的屏幕保护程序（用于 xsreensaver）。但是我有一个问题，我无法处理命令行获取的窗口 id。

以下调用是 xsreensaver 的子进程（当我打开 xscreensaver 首选项时），我认为给定的 window-id 是屏幕保护程序必须放置“预览”屏幕保护程序的小部件的 ID：

```
/usr/lib/xscreensaver/spampy -root -window-id 0x1E00CBC 
```

有谁知道我怎么能把东西放进去？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T09:15:08.090

使用[`gtk.Plug`](http://pygtk.org/docs/pygtk/class-gtkplug.html)，它是一个 GTK 容器，如果你给它一个窗口 ID，它就会将自己嵌入到一个窗口中。

# html - 图像周围的边框和阴影不起作用

> ID：14175420
> 
> 赞同：0
> 
> 时间：2013-01-05T19:20:27.577
> 
> 标签：html, css

我正在尝试在“主图像”周围设置边框和框阴影。通过单击“小图像”，主图像被替换。

您可以在[此处](http://jsbin.com/welcome/70057/)查看行为。

不幸的是，我无法在主图像周围设置边框和阴影。

```
 box-shadow:0px 0px 30px black;
   -webkit-box-shadow:0px 0px 30px black;
   -moz-box-shadow:0px 0px 30px black;
   border: 4px solid white; 
```

问题出在哪里，我该如何解决？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:41:23.197

您的代码段中有很多语法错误会导致这些问题，例如在正文之外打开 div 标签以及在 head 和 body 之间没有 doctype 打开脚本标签等。

[http://validator.w3.org/check?uri=http%3A%2F%2Fjsbin.com%2Fwelcome%2F70057%23img1&charset=%28detect+automatically%29&doctype=Inline&group=0](http://validator.w3.org/check?uri=http%3A%2F%2Fjsbin.com%2Fwelcome%2F70057%23img1&charset=%28detect+automatically%29&doctype=Inline&group=0)

我相信您将能够简单地将您的 css 应用于 img 并通过首先修复语法来获得结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:48:47.330

问题出在你的`.imgouter`div 上。它就像一个展示东西的小窗口。您的图像与该窗口的大小相同，这就是您看不到 boxshadow 的原因。（顺便说一句，你没有在你的 jsbin 中给他们一个 boxshadow）。当你点击小图像时，如果你给它`.imgInner img`一个 boxshadow，你可以看到 boxshadow。您需要使`.imgouter`尺寸更大才能看到阴影。

做这样的事情：http: [//jsfiddle.net/chanckjh/8jM9d/](http://jsfiddle.net/chanckjh/8jM9d/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:51:43.700

您发布的代码可以正常工作，并且可以在我的浏览器中正常工作。然后，我查看了链接，在搜索您的源代码后，我没有看到您的 CSS 包含在页面中，也没有应用于您的图像。所以我添加了它。

这样做之后，我注意到问题在于包含`div`主图像的事实没有`30px`显示阴影的边距/填充。

将其复制并粘贴到您的文件`CSS`中以查看它的工作原理：

```
.imgOuter {
    overflow: hidden;
    width: 775px; //Adjusted Width
    height: 450px; //Adjusted Height
    padding: 20px;
}

.imgOuter img{
    box-shadow:0px 0px 15px #666;
    -webkit-box-shadow:0px 0px 15px #666; 
    -moz-box-shadow:0px 0px 15px #666;
    border: 10px solid #fff;
    margin-bottom: 45px; //Added to shift your other images away from new region
} 
```

我看到您在页面上有所有图像并且具有偏移样式，使用上述方法`CSS`将需要一些简单的数学来将您的边距调整回您拥有它们的位置。

工作图像： ![**截屏**](../Images/517b8417e445536db6ff138fcad09f08.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T19:27:51.540

试试这个 -

```
.imgouter {
  border: 4px solid white;
  box-shadow:0px 0px 30px black;
} 
```

# iphone - 从 UIImagePickerController 选择后旋转视频以上传到服务器

> ID：14175438
> 
> 赞同：2
> 
> 时间：2013-01-05T19:22:27.773
> 
> 标签：iphone, xcode, uiimagepickercontroller

所以我已经看到了这些答案和许多其他答案：

[如何检测 (iPhone SDK) 视频文件是以纵向还是横向录制的。](https://stackoverflow.com/questions/4627940/how-to-detect-iphone-sdk-if-a-video-file-was-recorded-in-portrait-orientation)

[如何在上传到网络服务器之前从 UIImagePickerController 旋转视频](https://stackoverflow.com/questions/7896742/how-do-i-rotate-a-video-from-uiimagepickercontroller-before-uploading-to-a-webse)

我了解如何从 UIImagePickerController 获取视频的方向，但是如何实际旋转 Image Picker 返回的视频 url，以便在上传时它不会旋转 90 度？

编辑：

我正在使用这种方法来获取视频的方向。获得视频方向后，如何将其实际旋转到返回的方向？

```
- (UIInterfaceOrientation)orientationForTrack:(AVAsset *)asset
{
AVAssetTrack *videoTrack = [[asset      tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];
CGSize size = [videoTrack naturalSize];
CGAffineTransform txf = [videoTrack preferredTransform];

if (size.width == txf.tx && size.height == txf.ty)
    return UIInterfaceOrientationLandscapeRight;
else if (txf.tx == 0 && txf.ty == 0)
    return UIInterfaceOrientationLandscapeLeft;
else if (txf.tx == 0 && txf.ty == size.width)
    return UIInterfaceOrientationPortraitUpsideDown;
else
    return UIInterfaceOrientationPortrait;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T14:07:44.347

```
- (UIImageOrientation)getImageOrientationWithVideoOrientation:(UIInterfaceOrientation)videoOrientation {
UIImageOrientation imageOrientation;
switch (videoOrientation) {
    case UIInterfaceOrientationLandscapeLeft:
        imageOrientation = UIImageOrientationUp;
        break;
    case UIInterfaceOrientationLandscapeRight:
        imageOrientation = UIImageOrientationDown;
        break;
    case UIInterfaceOrientationPortrait:
        imageOrientation = UIImageOrientationRight;
        break;
    case UIInterfaceOrientationPortraitUpsideDown:
        imageOrientation = UIImageOrientationLeft;
        break;
}
return imageOrientation;
} 
```

# python - Python 装饰器函数作用域

> ID：14175441
> 
> 赞同：1
> 
> 时间：2013-01-05T19:22:45.910
> 
> 标签：python, multithreading, decorator, scoping

我似乎无法弄清楚下面的代码是否没有将 demovar 暴露给装饰函数：

```
def exposebasevar(function):
    def decorator(*args, **kwargs):
        demovar = 'Where am I?' # => or MyThreadSafeObjectHandle()
        return function(*args, **kwargs)
    return decorator

@exposebasevar
def usesexposedvariable():
    print demovar # this line will give an error

usesexposedvariable() 
```

背景：我有一个带有一个全局变量的模块，每个函数都使用它。现在我想让那个线程安全，所以我想通过装饰器使这个 var 可用。然后在装饰器中，我可以找出对象的哪个实例属于线程并将其传递进去。这样我就不需要更改每个函数的签名或内容。

有人知道如何设置吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:25:44.647

那将是动态范围。被广泛认为是一个非常糟糕的主意，因此在包括 Python 在内的各种语言中都不受支持。只是不可能，除非你想拉*非常*肮脏和脆弱的黑客。我实际上将其作为标准免责声明包括在内，而不是因为我有任何这样的解决方案。我能提供的最接近“工作”的方法是重写字节码，呃。

相反，将其作为修饰函数的参数。或者摆脱全球批发，从长远来看，这可能会更简单更好。

```
def exposebasevar(function):
    def decorator(*args, **kwargs):
        demovar = 'Where am I?'
        return function(*args, demovar=demovar, **kwargs)  # <<
    return decorator

@exposebasevar
def usesexposedvariable(demovar):  # <<
    print demovar 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T19:25:10.937

您的代码不起作用的原因与以下不起作用的原因完全相同：

```
def f():
  print v   # NameError: global name 'v' is not defined

def g():
  v = 42
  f()

g() 
```

最干净的方法可能是`demovar`作为参数传递给`function`：

```
def exposebasevar(function):
    def decorator(*args, **kwargs):
        demovar = 'Where am I?' # => or MyThreadSafeObjectHandle()
        return function(*args, demovar=demovar, **kwargs)
    return decorator

@exposebasevar
def usesexposedvariable(demovar):
    print demovar # this line will give an error

usesexposedvariable() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:47:53.557

> 我有一个带有一个全局变量的模块，每个函数都使用它。现在我想让那个线程安全......

您所描述的基本上是目的[`threading.local`](http://docs.python.org/2/library/threading.html#threading.local)；不幸的是，您可能需要*稍微*更改代码才能使其工作，问题在于线程本地对象本身不是线程本地的；只有它的属性是。只要您始终使用线程本地对象的属性，它几乎是透明的：

# java - 将文件读取到字符串数组并显示每条记录

> ID：14175449
> 
> 赞同：0
> 
> 时间：2013-01-05T19:23:22.670
> 
> 标签：java, arrays, file

我的代码应该读取文件并将每一行（每条记录）存储到一个字符串数组中。

我的txt文件是这样的：

```
FName Lname Number
second secondsecond 22
thired thithird 33
fourth fourfourr 44
fifth fiffif 55 
```

但是，当我运行我的代码时，我的程序不显示每行的第一个字符！像这样显示：

```
econd secondsecond 22
hired thithird 33
ourth fourfourr 44
ifth fiffif 55 
```

我的代码：

```
public class ReadfileIntoArray {

String[] columns=new String[]  {"FName","Lname","Number"};
String[] data=new String[100];

public void read() throws IOException{
FileReader fr=new FileReader("D:\\AllUserRecords.txt");
BufferedReader br=new BufferedReader(fr);
String line;  

while((line=br.readLine())!=null){

    for(int i=0;i<=br.read();i++){
        data[i]=br.readLine();
        System.out.println(data[i]);
    }
    }  
br.close();
System.out.println("Data length: "+data.length);
}

public static void main(String[] args) throws IOException{
    ReadfileIntoArray rfta=new ReadfileIntoArray();
    rfta.read();
}
} 
```

我想看到数据长度：5（因为我有五行），但我看到 100！

（我想要抽象表模型的这些信息）

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:27:35.403

因为您在第二行将数组大小声明为 100。所以你基本上有两个选择，如果文件中的行数不会改变，那么将数组的大小声明为 5。如果它会改变，那么我建议你使用例如[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)。

```
List<String> data = new ArrayList<String>();
//in the while loop
data.add(br.readLine()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:27:24.123

您的`data`数组的大小将始终为 100，因为当您实例化它时 ( `String[] data = new String[100]`) 会创建一个具有 100 个索引的空白数组。`String[]`您可以使用 a而不是使用 a`List<String>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:28:24.817

您的代码已修改：

```
public class ReadfileIntoArray {

    String[] columns = new String[] { "FName", "Lname", "Number" };
    String[] data = new String[100];

    public void read() throws IOException {
        FileReader fr = new FileReader("D:\\AllUserRecords.txt");
        BufferedReader br = new BufferedReader(fr);
        String line;

        int i = 0;
        while ((line = br.readLine()) != null) {
            data[i] = line;
            System.out.println(data[i]);
            i++;
        }
        br.close();
        // This is for resize the data array (and data.length reflect new size)
        String[] dataNew = new String[i];
        System.arraycopy(data, 0, dataNew, 0, i);
        data = dataNew;
        System.out.println("Data length: " + data.length);
    }

    public static void main(String[] args) throws IOException {
        ReadfileIntoArray rfta = new ReadfileIntoArray();
        rfta.read();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T19:27:13.073

`br.read()`从每行的开头读取一个字符，然后`br.readLine()`阅读其余字符。

这个内循环没有什么意义。

```
for(int i=0;i<=br.read();i++){
    data[i] = br.readLine();
    System.out.println(data[i]);
} 
```

这应该是你所需要的。如果您不想要第一行，请`br.readLine()`在循环之前添加一个额外的调用。

```
int i = 0;
while((line=br.readLine())!=null){
    data[i] = line;
    System.out.println(line);
    i++;
} 
```

`ArrayList<String>`如果您不知道需要多少行，您还应该尝试使用动态大小的数据结构来存储字符串（例如）。然后，您可以使用`myList.size()`来获取行数。

```
List myList = new ArrayList<String>();
while((line=br.readLine())!=null){
    myLine.add(line);
    System.out.println(line);
}  

System.out.println(myList.size());

//Retrieve the data as a String[].
String[] data = (String[]) myList.toArray(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T19:36:08.473

在读取行的循环内部，使用 String 方法`split`处理每一行。不要从阅读器中绘制，因为它会在阅读时向前移动文件指针。您可以使用空格分割

```
String [] parts = stringName.split("\\s"); 
```

然后，您可以完全访问每行中的所有三个项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-05T19:53:10.397

为什么这么复杂？以下是我的解决方案，供参考。

```
String line;  
int cnt;

cnt = 0;
while((line = br.readLine()) != null){
    System.out.println(line);
    cnt++;
}

br.close();
System.out.println("Data length: "+cnt); 
```

# css - 绝对位置在 IE8 中无法正常工作

> ID：14175454
> 
> 赞同：0
> 
> 时间：2013-01-05T19:23:54.463
> 
> 标签：css, internet-explorer, css-position

我正在编写一个基本模板，但我在使用 Internet Explorer 8 时遇到了问题。我创建了一个 Slider Carousel，并将它放在绝对位置，以便在顶部多显示一点。在 firefox、chroome 和 Safari 中存在任何问题，但在 Internet Explorer 8 中，轮播后的内容无法正确显示

为什么会这样？如何在 IE 中解决这个问题？

[在这里](http://experiments.hostzi.com/landing/)你可以看到模板：

IE 中正在发生的事情的打印屏幕![在此处输入图像描述](../Images/ad3fd7c2e86a3014c42c4e008c0a5a3d.png)

这是我的html：

```
 <div class="container-carousel container ">
        <article id="carousel">
            <div class="row">
                <div id="lista1" class="als-container">
                <span class="als-prev"><img src="images/left_arrow.png" alt="prev" title="precedente" /></span>
                    <div class="als-viewport">
                        <ul class="als-wrapper">
                            <li class="als-item"><img src="images/als-images/social.png" alt="social" title="social" /><h3>Appz Theme</h3><hr><p>Lorem ipsum dolor sit amet,<br>omnis euismod indoctum mel.</p></li>
                            <li class="als-item"><img src="images/als-images/android.png" alt="android" title="android" /><h3>Easy to use</h3><hr><p>Lorem ipsum dolor sit amet,<br>omnis euismod indoctum mel.</p></li>
                            <li class="als-item"><img src="images/als-images/apple.png" alt="apple" title="apple" /><h3>Amazing design</h3><hr><p>Lorem ipsum dolor sit amet,<br>omnis euismod indoctum mel.</p></li>
                            <li class="als-item"><img src="images/als-images/google.jpg" alt="google" title="google" /><h3>Dashboard view</h3><hr><p>Lorem ipsum dolor sit amet,<br>omnis euismod indoctum mel.</p></li>
                        </ul>
                    </div>
                <span class="als-next"><img src="images/right_arrow.png" alt="next" title="successivo" /></span>
            </div>      
       </article>
    </div>
    <div class="container">
       <div class="row">
            <div class="application">
                <p>Get your <span class="bold">free</span> <a class="mainbutton" href="">Download</a> of <span class="app">App</span> today!</p>
            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:09:25.890

根据 W3C 在线验证器，您的 HTML 无效。

[http://validator.w3.org/check?uri=http%3A%2F%2Fexperiments.hostzi.com%2Flanding%2F&charset=%28detect+automatically%29&doctype=Inline&group=0](http://validator.w3.org/check?uri=http%3A%2F%2Fexperiments.hostzi.com%2Flanding%2F&charset=%28detect+automatically%29&doctype=Inline&group=0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-15T10:07:14.560

有时即不能支持文章，更改为 div。

# c++ - 正则表达式匹配 C 语言数字

> ID：14175455
> 
> 赞同：1
> 
> 时间：2013-01-05T19:23:59.950
> 
> 标签：c++, c, regex, qt, qregexp

我正在尝试匹配 Qt 中的数字以进行语法突出显示，并且我正在尝试以下正则表达式：

```
"[^a-fA-F_][0-9]+" // For numbers.
"[^a-fA-F_][0-9]+\\.[0-9]+" // For decimal numbers.
"[^a-fA-F_][0-9]+\\.[0-9]+e[0-9a-fA-F]+" // For scientific notation.
"[^a-fA-F_]0[xX][0-9a-fA-F]+" // For hexadecimal numbers. 
```

但是文本是匹配的，例如 [1024，并且也突出显示了 [。我只想突出显示 1024 部分。

另一个问题是，当我键入 aoe2 和键入 aoe25 时，正则表达式会突出显示。当数字前面有字母或下划线时，我不想突出显示它，因为那样它将是一个标识符。

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T19:29:08.293

好吧，`[`因为这个声明它匹配：

```
[^a-fA-F_]
This will match anything that is not the letters A-F(any case) or an underscore 
```

如果这是你想要的，你为什么不只是匹配数字？

```
For integers:         \b\d+
For decimal numbers:  \b\d+.\d+
For scientific:       \b\d+e\d+
For hexadecimal:      \b[\dA-Fa-F]+ 
```

同样正如@Jan Dvorak 提到的，您可以使用单词边界`\b`，以确保您的匹配从单词（或数字）的开头开始。请参阅此处的示例：[http ://regex101.com/r/kC6dK3](http://regex101.com/r/kC6dK3)

# c# - 设计器未找到 app.xaml 的样式

> ID：14175459
> 
> 赞同：1
> 
> 时间：2013-01-05T19:24:41.057
> 
> 标签：c#, .net, wpf, xaml

我刚刚注意到我的 xaml 编辑器看不到 App.xaml 中定义的样式。

```
<Application x:Class="MyApp.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="Windows\MainWindow.xaml">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Assets/Themes/ShinyBlue.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            // this one gets a warning that's never used, though it is
            <LinearGradientBrush x:Key="backgroundBrush" EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="{StaticResource NormalBrushGradient3}" Offset="0.1" />
                <GradientStop Color="{StaticResource NormalBrushGradient1}" Offset="0.4" />
            </LinearGradientBrush> 
```

对这种样式的每次调用都带有下划线，并且设计师都没有加载任何样式（一切都是白色的）。当我运行该应用程序时，一切看起来都很好 - 正在加载样式。

最近我将入口点更改为我的应用程序：

```
public partial class App : Application
{
    [System.STAThreadAttribute()]
    public static int Main(string[] args)
    {
        var dirsToCreate = new[]
            {
                Settings.Default.PhotosDirectory
            };
        foreach (var dir in dirsToCreate)
        {
            if (!Directory.Exists(dir))
                Directory.CreateDirectory(dir);
        }

        App app = new App();
        app.InitializeComponent();
        app.Run();

        return 0;
    } 
```

我怀疑，但不能确定这个更改的入口点可能与此有关（我将 MainWinow 的构建操作更改为“页面”）。

任何想法发生了什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:13:27.680

1.  由于您更改了入口点，您是否将 app.xaml 中的“StartupUri”属性更改为要启动的新窗口？

2.  app.xaml 文件中的 x:Class 属性是什么，startupwindow.xaml 文件中的 x:Class 属性是什么？

3.  您是否尝试过将样式引用为 DynamicResource 而不是 StaticResource？DynamicResource 不会在编译时加载您的样式，它会在运行时加载它们。编辑时您不会在“设计”窗口中看到应用的样式，但会在您运行应用程序时应用这些样式。这可能不是解决此问题的最佳方法，但我过去这样做只是为了克服一些愚蠢的小障碍。就个人而言，我从不使用设计器窗口，我只是用 XAML 编写我的 UI，所以这对我来说并不是一个真正的问题。

试试这些，让我知道它们是否适合你。

# java - IDEA 是否识别 Play Scala 模板更改？

> ID：14175460
> 
> 赞同：1
> 
> 时间：2013-01-05T19:24:45.737
> 
> 标签：java, scala, playframework, intellij-idea, playframework-2.0

我发现 IntelliJ IDEA 12 不理解对 Scala 模板的更改。例如，假设我有 index.html.scala ：

```
@(message: String) 
```

我的控制器使用以下方法调用它：

```
return ok(index.render("Your new application is ready.")); 
```

然后我将模板更改为：

```
@(message: String, foo: String) 
```

控制器是：

```
return ok(index.render("Your new application is ready.", "foo")); 
```

我发现 IDEA 会将控制器代码标记为红色，声称我有一个我不应该有的额外参数（“foo”）。直到我点击页面并且 Play 重新编译模板，错误突出显示才消失。

当然，这是一个大问题，因为 IDEA 出色的语法突出显示的全部意义在于让我在加载浏览器之前确保我的代码是好的。当前行为的工作方式，我的流程是代码->重新加载->检查错误，而不是首选代码->检查错误->重新加载。

还有其他人遇到这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:00:59.640

默认情况下，Play 等待下一个请求（即在浏览器中手动刷新页面）以涉及热重载（并重新编译更改的元素）。

使用 运行您的应用程序`play ~run`，因此它将在文件保存后立即重新加载。并且更改的参数将在接下来的几秒钟内对 Idea 12 可见

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-05T19:36:28.117

我只是把它输入谷歌：[http ://plugins.intellij.net/plugin?pluginId=7080](http://plugins.intellij.net/plugin?pluginId=7080)

# php - 在 Symfony2 中使用 Form Collections 和 Doctrine 上传图片

> ID：14175463
> 
> 赞同：8
> 
> 时间：2013-01-05T19:24:49.597
> 
> 标签：php, forms, file-upload, symfony, doctrine-orm

我一直在尝试使用 Symfony2 中的文件上传来制作表单集合并遵循本指南

[http://symfony.com/doc/master/cookbook/form/form_collections.html](http://symfony.com/doc/master/cookbook/form/form_collections.html)

但似乎无法使这部分工作：

```
// src/Acme/TaskBundle/Entity/Task.php

// ...

public function setTags(ArrayCollection $tags)
{
foreach ($tags as $tag) {
    $tag->addTask($this);
}

$this->tags = $tags;
} 
```

. 基本上，我有一个属性实体和一个具有一对多关系的图像实体。我已经让它们的每一个 FormTypes 和 Property Entity 都保持得很好，另一方面 Image 实体的 property_id 列总是为 NULL，即使 Image 实体的其他属性得到正确地保持。

这是属性实体：

```
<?php

namespace Mata\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;

use Mata\MainBundle\Entity\Image;

class Property
{
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 * @var string
 *
 * @ORM\Column(name="name", type="string", length=255)
 */
private $name;

/**
 * @var string
 *
 * @ORM\Column(name="description", type="text")
 */
private $description;

/**
 * @var float
 *
 * @ORM\Column(name="price", type="float")
 */
private $price;

/**
 * @var string
 *
 * @ORM\Column(name="type", type="string", length=255)
 */
private $type;

/**
 * @var integer
 *
 * @ORM\Column(name="owner", type="integer")
 */
private $owner;

/**
 * @var boolean
 *
 * @ORM\Column(name="available", type="boolean")
 */
private $available;

/**
 *
 *
 * @ORM\OneToMany(targetEntity="Image", mappedBy="property", cascade={"persist"})
 */
private $images;

public function __construct()
{
    $this->images = new ArrayCollection();
}

/**
 * Get id
 *
 * @return integer 
 */
public function getId()
{
    return $this->id;
}

/**
 * Set name
 *
 * @param string $name
 * @return Property
 */
public function setName($name)
{
    $this->name = $name;

    return $this;
}

/**
 * Get name
 *
 * @return string 
 */
public function getName()
{
    return $this->name;
}

/**
 * Set description
 *
 * @param string $description
 * @return Property
 */
public function setDescription($description)
{
    $this->description = $description;

    return $this;
}

/**
 * Get description
 *
 * @return string 
 */
public function getDescription()
{
    return $this->description;
}

/**
 * Set price
 *
 * @param float $price
 * @return Property
 */
public function setPrice($price)
{
    $this->price = $price;

    return $this;
}

/**
 * Get price
 *
 * @return float 
 */
public function getPrice()
{
    return $this->price;
}

/**
 * Set type
 *
 * @param string $type
 * @return Property
 */
public function setType($type)
{
    $this->type = $type;

    return $this;
}

/**
 * Get type
 *
 * @return string 
 */
public function getType()
{
    return $this->type;
}

/**
 * Set owner
 *
 * @param integer $owner
 * @return Property
 */
public function setOwner($owner)
{
    $this->owner = $owner;

    return $this;
}

/**
 * Get owner
 *
 * @return integer 
 */
public function getOwner()
{
    return $this->owner;
}

/**
 * Set available
 *
 * @param boolean $available
 * @return Property
 */
public function setAvailable($available)
{
    $this->available = $available;

    return $this;
}

/**
 * Get available
 *
 * @return boolean 
 */
public function getAvailable()
{
    return $this->available;
}

/**
 * Add images
 *
 * @param \Mata\MainBundle\Entity\Image $images
 * @return Property
 */
public function addImage(\Mata\MainBundle\Entity\Image $images)
{
    $this->images[] = $images;

    return $this;
}

public function setImages(ArrayCollection $images)
{
    foreach ($images as $image) {
        $image->setProperty($this);
    }

    $this->images = $images;
}

/**
 * Remove images
 *
 * @param \Mata\MainBundle\Entity\Image $images
 */
public function removeImage(\Mata\MainBundle\Entity\Image $images)
{
    $this->images->removeElement($images);
}

/**
 * Get images
 *
 * @return \Doctrine\Common\Collections\Collection 
 */
public function getImages()
{
    return $this->images;
}
} 
```

图像实体：

```
namespace Mata\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * Image
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="Mata\MainBundle\Entity\ImageRepository")
 * @ORM\HasLifecycleCallbacks
 */
class Image
{
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 * @Assert\File(maxSize="6000000")
 */
public $file;

/**
 * @var string
 *
 * @ORM\Column(name="name", type="string", length=255)
 */
private $name;

/**
 * @var string
 *
 * @ORM\Column(name="path", type="string", length=255)
 */
private $path;

/**
 * @ORM\ManyToOne(targetEntity="Property", inversedBy="images")
 * @ORM\JoinColumn(name="property_id", referencedColumnName="id")
 */
protected $property;

/**
 * Get id
 *
 * @return integer 
 */
public function getId()
{
    return $this->id;
}

/**
 * Set name
 *
 * @param string $name
 * @return Image
 */
public function setName($name)
{
    $this->name = $name;

    return $this;
}

/**
 * Get name
 *
 * @return string 
 */
public function getName()
{
    return $this->name;
}

/**
 * Set path
 *
 * @param string $path
 * @return Image
 */
public function setPath($path)
{
    $this->path = $path;

    return $this;
}

/**
 * Get path
 *
 * @return string 
 */
public function getPath()
{
    return $this->path;
}

public function getAbsolutePath()
{
    return null === $this->path
        ? null
        : $this->getUploadRootDir().'/'.$this->path;
}

public function getWebPath()
{
    return null === $this->path
        ? null
        : $this->getUploadDir().'/'.$this->path;
}

protected function getUploadRootDir()
{
    // the absolute directory path where uploaded
    // documents should be saved
    return __DIR__.'/../../../../web/'.$this->getUploadDir();
}

protected function getUploadDir()
{
    // get rid of the __DIR__ so it doesn't screw up
    // when displaying uploaded doc/image in the view.
    return 'uploads/documents';
}

/**
 * @ORM\PrePersist()
 * @ORM\PreUpdate()
 */
public function preUpload()
{
    if (null !== $this->file) {
        // do whatever you want to generate a unique name
        $filename = sha1(uniqid(mt_rand(), true));
        $this->path = $filename.'.'.$this->file->guessExtension();
    }
}

/**
 * @ORM\PostPersist()
 * @ORM\PostUpdate()
 */
public function upload()
{
    if (null === $this->file) {
        return;
    }

    // if there is an error when moving the file, an exception will
    // be automatically thrown by move(). This will properly prevent
    // the entity from being persisted to the database on error
    $this->file->move($this->getUploadRootDir(), $this->path);

    unset($this->file);
}

/**
 * @ORM\PostRemove()
 */
public function removeUpload()
{
    if ($file = $this->getAbsolutePath()) {
        unlink($file);
    }
}

/**
 * Set property
 *
 * @param \Mata\MainBundle\Entity\Property $property
 * @return Image
 */
public function setProperty(\Mata\MainBundle\Entity\Property $property)
{
    $this->property = $property;

    return $this;
}

/**
 * Get property
 *
 * @return \Mata\MainBundle\Entity\Property
 */
public function getProperty()
{
    return $this->property;
}
} 
```

属性表格类型：

```
namespace Mata\AdminBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

use Mata\AdminBundle\Form\Type\ImageType;

class PropertyType extends AbstractType
{

    public function buildForm(FormBuilderInterface $builder, array $options)
    {

        $builder->add('name');
        $builder->add('description');
        $builder->add('price');
        $builder->add('type');
        $builder->add('owner');
        $builder->add('available');
        $builder->add('images', 'collection', array(
            'type' => new ImageType(),
            'allow_add' => true,
            'by_reference' => false,
            'allow_delete' => true,
            'prototype' => true

        ));

    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Mata\MainBundle\Entity\Property',
        ));
    }

    public function getName()
    {
        return 'property';
    }
} 
```

图像形式类型：

```
namespace Mata\AdminBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class ImageType extends AbstractType
{

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('name','text');
        $builder->add('file', 'file');

    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Mata\MainBundle\Entity\Image',
        ));
    }

    public function getName()
    {
        return 'images';
    }
} 
```

控制器动作：

```
public function addAction(Request $request)
{

    $em = $this->getDoctrine()->getManager();
    $property = new Property();

    $form = $this->createForm(new PropertyType(), $property);

    if ($request->isMethod('POST')) {
        $form->bind($request);

        if ($form->isValid()) {
            $em->persist($property);
            $em->flush();

            $this->get('session')->getFlashBag()->add('notice', 'Successfully added new Property');

            return $this->redirect($this->generateUrl('mata_admin.property.create'));
        }
    }

    return $this->render('MataAdminBundle:Property:add.html.twig',array(
        'title' =>  'Property',
        'form' => $form->createView()
        )
    );
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-27T22:59:29.903

当您添加 by_reference => false 时，您应该在 add 函数中设置计数器实体。

因此，您的 property_id 应该正确地保留在图像中，将您的属性中的 addImage 函数更改为：

```
public function addImage(\Mata\MainBundle\Entity\Image $image)
{
  $this->images[] = $image;

  $image->setProperty($this);

  return $this;
} 
```

# iphone - 移动 safari 上的网页没有缩放以适应视口？

> ID：14175464
> 
> 赞同：0
> 
> 时间：2013-01-05T19:24:53.373
> 
> 标签：iphone, css, mobile-safari, viewport

我只使用 ems 和百分比作为 css 单位创建了一个简单的。它是一个包含一些元素的容器 div，它位于页面中心，代码如下：

```
position: absolute;
top: 50%;
left: 50%;
margin-top: -25.875em;
margin-left: -38.187em;
padding: 0;
width: 76.375em;
height: 47.75em; 
```

它适用于除 iphone 和 ipad 之外的所有浏览器。它只呈现我页面的右上角。

我补充说：

```
<meta name="viewport" content="maximum-scale=2, minimum-scale=.2, initial-scale=.6"> 
```

它在 ipad 上按比例缩小，但对于 iphone 来说仍然太大，并且页面在纵向模式下根本无法缩放。

最后，通过谷歌搜索和使用元标记，我能想到的最佳解决方案是将元标记减少为：

```
<meta name="viewport" content="user-scalable=yes" > 
```

结合这个：

```
@media all and ( max-device-width: 780px ) {
  body {
    text-align: center;
  }
  .page-content {
    position: relative;
    top: 0;
    left: 0;
    display: inline-block;
    margin-top: 4%;
    margin-left: 100px;
    margin-right: 120px;
    margin-bottom: 4%;
    text-align: left;
  }
} 
```

页面仍然呈现非常大的比例，但至少可以按比例缩小。

移动 Safari 不应该自动缩小页面吗？相对单位在这里搞砸了我吗？

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:26:34.607

改用这个：

`<meta name="viewport" content="width=device-width, initial-scale=1.0">`

# mysql - SQL WHERE IN 需要很长时间来处理 SELECT 语句

> ID：14175465
> 
> 赞同：0
> 
> 时间：2013-01-05T19:24:55.117
> 
> 标签：mysql, sql, query-optimization

我想重构以下查询，因为它需要一段时间来处理：

```
SELECT `user_product`.* FROM `user_products` AS `user_product`
INNER JOIN `items` ON (`user_product`.`item_id` = `items`.`id`) 
INNER JOIN `user_tags` ON (`items`.`id` = `user_tags`.`item_id`)
INNER JOIN `tags` ON (`user_tags`.`tag_id` = `tags`.`id`)
WHERE `tags`.`title` IN ('tag3', 'tag')
GROUP BY `items`.`id`
ORDER BY `items`.`created_at` DESC 
```

当我`EXPLAIN`得到以下结果时：

```
+----+-------------+--------------+--------+---------------+---------+---------+----------------------+-------+---------------------------------+
| id | select_type | table        | type   | possible_keys | key     | key_len | ref                  | rows  | Extra                           |
+----+-------------+--------------+--------+---------------+---------+---------+----------------------+-------+---------------------------------+
| 1  | SIMPLE      | user_tags    | ALL    | NULL          | user_id | 12      | NULL                 | 27802 | Using temporary; Using filesort |
| 1  | SIMPLE      | user_product | ALL    | NULL          | NULL    | NULL    | NULL                 | 22676 | Using where; Using join buffer  |
| 1  | SIMPLE      | items        | eq_ref | PRIMARY       | PRIMARY | 4       | user_product.item_id | 1     | Using where                     |
| 1  | SIMPLE      | tags         | eq_ref | PRIMARY,title | PRIMARY | 4       | user_tags.tag_id     | 1     | Using where                     |
+----+-------------+--------------+--------+---------------+---------+---------+----------------------+-------+---------------------------------+ 
```

查询需要 17 秒，其中有两个标签，`WHERE IN`而 0.009 有一个。优化查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:36:22.507

尝试在 user_tags.item_id 和 user_products.item_id 上添加索引

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:29:43.190

`in`MySQL 应该在语句中处理一组常量。您是否单独为每个标签的查询计时？其中一个标签可能有很多数据。

如果您在 tags.title 上有一个索引，它可能也会有所帮助。

# c++ - 不要在 GCC 中使用 -O3 标志优化特定循环

> ID：14175467
> 
> 赞同：0
> 
> 时间：2013-01-05T19:25:01.290
> 
> 标签：c++, c, optimization, gcc, openmp

在我的代码中，我使用一个简单的 int 变量（名为 counter）来同步 4 个线程。

这是我的代码片段：

```
int counter = 0;
#pragma omp parallel shared(counter) num_threads(4) 
{
    while(counter != thread_id){
        // What should I put here?
    }
    // Actions needed to be performed 'in order'
    counter++;
    // The rest of the code
} 
```

我面临的问题是，如果我使用 -O3 优化标志，则编译代码中的 while 循环“消失”......例如，如果我在循环中放置了 printf 行，则会发生 while 并且一切正常。 ..

我应该在我的 while 循环中放什么，这样 -O3 才不会影响它的行为？

- - 编辑 - -

抱歉缺少上下文......我需要创建在特定处理器上工作的线程团队，因为我正在使用 NUMA 系统，所以我需要“团队创建”部分，以便我可以使用处理器亲和性.. .请看这个相关的问题： [Specific thread order in C using GCC and OMP](https://stackoverflow.com/questions/14167265/specific-thread-order-in-c-using-gcc-and-omp)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:43:29.760

如前所述，这是同步线程的一种不好的方法。由于我不希望我的回答被否决，我将解释您应该使用其他形式的同步。通常，信号量用于计算事物，因此这可能是正确的做法，但由于我们没有您的所有代码，因此没有特别好的方法来判断。

# exception - 异常处理程序在捕获 SEH 异常时不调用析构函数

> ID：14175476
> 
> 赞同：1
> 
> 时间：2013-01-05T19:26:09.533
> 
> 标签：exception, seh

```
class ScopedShit
{
public:
    ScopedShit() {
        cout << "ScopedShit()" << endl;
    }
    ~ScopedShit() {
        cout << "~ScopedShit()" << endl;
    }
};

void foo()
{
    ScopedShit ss;
    int x = 0;
    int y = 5 / x;
}

int main()
{
    __try {
        foo();
    }
    __except(true) {
        cout << "Continuing..." << endl;
    }
} 
```

输出：

> ScopedShit()
> 
> 继续...

我正在阅读这篇文章[http://www.codeproject.com/Articles/2126/How-aC-compiler-implements-exception-handling](http://www.codeproject.com/Articles/2126/How-a-C-compiler-implements-exception-handling)，其中解释了：

> 但在它（异常处理程序）调用 catch 块之前（它从 funcinfo 结构中知道 catch 块的地址，见图 4），它必须执行堆栈展开：清理该函数帧下面的函数的堆栈帧。堆栈帧的清理涉及到非常小的复杂性：**异常处理程序必须在异常发生时在帧上找到函数的所有本地对象并调用它们的析构函数。**

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T19:31:39.300

我相信您需要[`/EHa`](http://msdn.microsoft.com/en-us/library/1deeycx5.aspx)在编译时指定 SEH 异常以调用 C++ 析构函数。

> 如果未指定 /EH，编译器将捕获结构化异常和 C++ 异常，**但不会销毁因异常而超出范围的 C++ 对象。**

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/1deeycx5.aspx)。

# android - android中的部分粗体字符串

> ID：14175481
> 
> 赞同：3
> 
> 时间：2013-01-05T19:26:40.157
> 
> 标签：android

我想加粗每行的第一个单词。但不是粗体，而是显示整个代码！

```
 private void addAsimA(ArrayList<String> products) {
         products.add("<b>Apple</b> It is red");
         products.add("<b>Banana</b> It is yellow");
         products.add("<b>Mango</b> It is green"); 
```

我怎样才能得到这样的输出：

**苹果**它是红色的

**香蕉**是黄色的

**芒果**是绿色的

这是完整的java文件

```
 public class MainActivity extends Activity {

    TextView txtv, txt1;
    ImageView imgv;

       // List view
    private ListView lv;

    // Listview Adapter
    ArrayAdapter<String> adapter;

    // ArrayList for Listview
    ArrayList<HashMap<String, String>> productList;

     ArrayList<String> products = new ArrayList<String>();

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

         addAsimA(products);
         addAsimB(products);
    }

 private void addAsimA(ArrayList<String> products) {        

             products.add("<b>Apple</b> It is red");
             products.add("<b>Banana</b> It is yellow");
             products.add("<b>Mango</b> It is green");
              }

             private void addAsimB(ArrayList<String> products) {

                 products.add("<b>Flower</b> It is nice");
                 products.add("<b>Fog</b> It is white");
                 products.add("<b>Rose</b> It is pink");

                  lv = (ListView) findViewById(R.id.list_view);

                  // your code is added here but what is the problem?
                    TextView txt1 = (TextView) findViewById(R.id.product_list);
                    txt1.setText(Html.fromHtml(products.get(productList)));

                    // Adding items to listview
                    adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.product_list,   products);
                    lv.setAdapter(adapter);                

         }
    } 
```

文本视图的 XML 文件在这里：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <!-- Product Name -->

     <com.examdple.customproduct.CustomTextView

            android:textColor="?android:textColorPrimary"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingTop="4sp"
            android:id="@+id/product_list"
            android:paddingLeft="20sp"
            android:paddingBottom="2sp"
            android:textSize="15sp" />

</LinearLayout> 
```

如果有人想要该文件：[http ://www.mediafire.com/?op37c1itodd8724](http://www.mediafire.com/?op37c1itodd8724)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:29:36.313

像这样：

```
TextView txt = (TextView) findViewById(R.id.myTxtV);
txt.setText(Html.fromHtml(products.get(index))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:45:43.730

只需将您的字符串放入 strings.xml 并像这样更改它，

```
<string name="hello"><b>Hello</b> World, fh!</string> 
```

并像这样设置这个文本

```
android:text="@string/hello" 
```

# java - 如何将 fileUpload Interceptor 与其他拦截器堆栈一起使用？

> ID：14175483
> 
> 赞同：1
> 
> 时间：2013-01-05T19:26:42.013
> 
> 标签：java, jsp, file-upload, struts2, interceptorstack

这是我的`struts.xml`配置文件，其中有一个登录拦截器。我想使用不同的文件上传拦截器，在不同的操作中使用不同的文件类型，以及给定的最大大小。但问题就在这里：它总是采用默认值`maximumSize`和`allowedType`. 我在哪里做错了？

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

    <struts>
<constant name="struts.enable.DynamicMethodInvocation"
    value="false" />
<constant name="struts.devMode" value="false" />
<constant name="struts.custom.i18n.resources"
    value="ApplicationResources" />

<package name="default" extends="struts-default" namespace="/">
    <result-types>
        <result-type name="tiles"
            class="org.apache.struts2.views.tiles.TilesResult" />
    </result-types>

    <interceptors>
        <interceptor name="nlogin" class="com.picvik.interceptor.LoginInterceptor"/>
        <interceptor-stack name="loginStack">
            <interceptor-ref name="servletConfig"/>
            <interceptor-ref name="params"/>
            <interceptor-ref name="nlogin"/>
            <interceptor-ref name="prepare"/>
            <interceptor-ref name="chain"/>
            <interceptor-ref name="modelDriven"/>
            <interceptor-ref name="staticParams"/>
            <interceptor-ref name="params"/>
            <interceptor-ref name="conversionError"/>
            <interceptor-ref name="validation"/>
            <interceptor-ref name="workflow"/>
        </interceptor-stack>
    </interceptors>
    <!-- <default-interceptor-ref name="loginStack"/>  -->

    <global-results>
        <result name="login" type="tiles">/login.tiles</result>
    </global-results>

    <action name="home" 
        class="com.picvik.action.HomeAction">
        <interceptor-ref name="loginStack"/>
        <result name="success" type="tiles">/home.tiles</result>
        <result name="error" type="tiles">/welcome.tiles</result>
    </action>
    <action name="registration" 
        class="com.picvik.action.RegisterAction" method="execute">
        <result name="success" type="tiles">/register.tiles</result>
    </action>
    <action name="register" 
        class="com.picvik.action.RegisterAction" method="register">
        <result name="success" type="tiles">/registerverify.tiles</result>
        <result name="error" type="tiles">/register.tiles</result>
        <result name="input" type="tiles">/register.tiles</result>
    </action>
    <action name="verify" 
        class="com.picvik.action.RegisterAction" method="verify">
        <result name="success" type="tiles">/login.tiles</result>
        <result name="error" type="tiles">/registerverify.tiles</result>
    </action>

     <action name="login" class="com.picvik.action.LoginAction">
        <result name="success" type="tiles">/home.tiles</result>
        <result name="input" type="tiles">/login.tiles</result>
    </action>

    <action name="dologin" class="com.picvik.action.LoginAction" method="login">
        <interceptor-ref name="defaultStack"/>
        <result name="success" type="tiles">/home.tiles</result>
        <result name="input" type="tiles">/login.tiles</result>
    </action>

    <action name="logout" class="com.picvik.action.LoginAction" method="logout">
        <interceptor-ref name="defaultStack"/>
        <result name="success" type="tiles">/login.tiles</result>
    </action>

    <action name="viewprofile" class="com.picvik.action.ViewProfileAction">
        <interceptor-ref name="loginStack"/>
        <result name="success" type="tiles">/viewprofile.tiles</result>
    </action>
    <action name="editprofile" class="com.picvik.action.ViewProfileAction">
        <interceptor-ref name="loginStack"/>
        <result name="success" type="tiles">/editprofile.tiles</result>
    </action>
    <action name="saveprofile" class="com.picvik.action.ViewProfileAction" method = "saveProfile">
        <interceptor-ref name="loginStack"/>
        <result name="success" type="tiles">/home.tiles</result>
        <result name="input" type="tiles">/editprofile.tiles</result>
    </action>

    <action name="changeprofilephoto" class="com.picvik.action.ChangeProfilePhotoAction">
        <interceptor-ref name="loginStack"/>
        <result name="success" type="tiles">/changephoto.tiles</result>
        <result name="input" type="tiles">/changephoto.tiles</result>
    </action>

    <action name="uploadprofilephoto"
            class="com.picvik.action.ChangeProfilePhotoAction" method="uploadProfilePhoto">
         <interceptor-ref name="fileUpload">
            <param name="maximumSize">2097152</param>
            <param name="allowedTypes">
                image/png,image/gif,image/jpeg,image/pjpeg
            </param>
        </interceptor-ref>
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">viewprofile</param>
        </result>
        <result name="input" type="tiles">/changephoto.tiles</result>
    </action>
    <!-- video upload-->
    <action name="videouploader"
            class="com.picvik.action.UploadVideoAction" method="execute">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/videoupload.tiles</result>
    </action>

    <action name="uploadvideo"
            class="com.picvik.action.UploadVideoAction" method="uploadVideo">
         <interceptor-ref name="fileUpload">
            <param name="maximumSize">209715200</param>
            <param name="allowedTypes">
                video/mp4
            </param>
        </interceptor-ref>
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">editvideo</param>
        </result>
        <result name="input" type="tiles">/videoupload.tiles</result>
    </action>
    <action name="editvideo"
            class="com.picvik.action.UploadVideoAction" method="editVideo">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">home</param>
        </result>
        <result name="input" type="tiles">/editvideo.tiles</result>
    </action>
    <action name="savevideos"
            class="com.picvik.action.UploadVideoAction" method="saveVideo">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">listVideo</param>
        </result>
        <result name="error" type="tiles">/editvideo.tiles</result>
    </action>
    <!-- video upload ends here-->

    <!-- photo upload -->
    <action name="photouploader"
            class="com.picvik.action.UploadPhotoAction">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/photoupload.tiles</result>
    </action>

    <action name="uploadphoto"
            class="com.picvik.action.UploadPhotoAction" method="uploadPhoto">
         <interceptor-ref name="fileUpload">
            <param name="maximumSize">20971520</param>
            <param name="allowedTypes">
                image/png,image/gif,image/jpeg,image/pjpeg
            </param>
        </interceptor-ref>
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">editphoto</param>
        </result>
        <result name="input" type="tiles">/photoupload.tiles</result>
    </action>

    <action name="editphoto"
            class="com.picvik.action.UploadPhotoAction" method="editPhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">home</param>
        </result>
        <result name="input" type="tiles">/editphoto.tiles</result>
    </action>
    <action name="savephotos"
            class="com.picvik.action.UploadPhotoAction" method="savePhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">listalbum</param>
        </result>
        <result name="error" type="tiles">/editphoto.tiles</result>
    </action>

    <action name="listalbum"
            class="com.picvik.action.ViewAlbumAction" method="listAlbum">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/listalbum.tiles</result>
    </action>

    <action name="listphoto"
            class="com.picvik.action.ViewAlbumAction" method="listPhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/listphoto.tiles</result>
    </action>

    <action name="listalbumphoto"
            class="com.picvik.action.ViewAlbumAction" method="listAlbumPhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/listalbumphoto.tiles</result>
    </action>

    <action name="viewphoto"
            class="com.picvik.action.ViewAlbumAction" method="viewPhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type="tiles">/viewphoto.tiles</result>
    </action>

    <action name="commentonphoto"
            class="com.picvik.action.CommentAction" method="commentOnPhoto">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">listphoto</param>
        </result>
    </action>

    <action name="commentonalbum"
            class="com.picvik.action.CommentAction" method="commentOnAlbum">
        <interceptor-ref name="loginStack"></interceptor-ref>
        <result name="success" type= "redirectAction">
            <param name="actionName">listalbum</param>
        </result>
    </action>

</package> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:07:56.810

使用以下配置属性覆盖默认值

```
struts.multipart.maxSize=2097152 
```

取自 default.properties。注意没有`0`在最后。

查看文档和示例如何使用[`fileUpload`](http://struts.apache.org/core-developers/file-upload.html)拦截器。

# php - PHPStorm 和模块参考

> ID：14175485
> 
> 赞同：4
> 
> 时间：2013-01-05T19:26:46.840
> 
> 标签：php, module, directory-structure, phpstorm, project-structure

我的 PHP 项目中有以下文件：

```
index.php
private/module1.php
private/module2.php 
```

以这种方式`index.php`引用`module1.php`：

```
require_once('private/module1.php'); 
```

反过来，`module1.php`requires `module2.php`，因此它具有以下行：

```
require_once('private/module2.php'); 
```

我需要从根通知相对路径才能使其工作。我猜这是因为**require_once命令需要一个来自***当前*文档的路径，它恰好是 index.php。问题是 PHP Storm 无法管理这个引用。例如，它不会将字符串`private/module2.php`转换为超链接，也不会将其作为实际引用。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T11:57:50.153

您只需要通过指定 PhpStorm 应该用来解析引用的包含路径来正确配置您的 PhpStorm 项目。

转到文件-> 设置-> PHP。

在那里，您应该将项目根目录（您的 index.php 所在的目录）添加到包含路径列表中。

完成此操作后，PhpStorm 应解析`require_once('private/module2.php')`.

此外，您可以通过*index.php*中某处的[set_include_path()将](http://php.net/set_include_path)*私有*目录添加到 PHP 使用的包含路径列表中。然后你可以从你的*module1.php*调用。*`require_once('module2.php')`*

 **同样，您必须将*私有*目录添加到 PhpStorm 使用的包含路径列表中，以使其能够解析此引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:00:45.047

您也可以只使用基本网址。像

```
require_once($base_url . 'private/module2.php'); 
```

基本 url 可以由您自己在某个地方定义，或者您可以使用 $_SERVER 变量来获取它 [http://www.php.net/manual/en/reserved.variables.server.php](http://www.php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:35:34.227

PhpStorm 无法提供参考，因为它正在寻找

```
index.php
private/module1.php
private/private/module2.php 
```

`module1.php`应该只需要文件名`module2.php`：

`require_once('module2.php);`**

# php - 脚本中的多个 PDO 查询

> ID：14175486
> 
> 赞同：0
> 
> 时间：2013-01-05T19:26:52.507
> 
> 标签：php, mysql, pdo

我试图找出在单个脚本中使用 PDO 运行多个 SQL 查询的最佳实践。数据库连接是在脚本开始时建立的，但随后我需要进行多个不同的查询。我目前正在做的（我不确定这是最佳实践）是：

```
$db = new PDO('mysql:host='.$DBHOST.';dbname='.$DBNAME.';charset=UTF-8', $DBUSER, $DBPASSWORD);

$query = $db->prepare("SELECT count(*) as total from bande_ips WHERE ip=:ip");
$query->bindValue(':ip', $_SESSION['REMOTE_ADDR'], PDO::PARAM_STR);
$query->execute();
$array = $query->fetchAll(PDO::FETCH_ASSOC);

$query = NULL;
$query = $db->prepare("SELECT * from failed_login WHERE IP=:ip and email=:email");
$query->bindValue(':ip', $_SESSION['REMOTE_ADDR'], PDO::PARAM_STR);
$query->bindValue(':email', $email, PDO::PARAM_STR);
$query->execute();
$array = $query->fetchAll(PDO::FETCH_ASSOC); 
```

如您所见，我在一个脚本中准备了两个单独的查询。但是我开始设置`$query = NULL;`，因为脚本事先混淆了单独的查询（它期待我不再调用的旧查询的参数，这导致我不确定这是否是最佳实践。）

在继续迁移到 PDO 之前，我只想确认这是最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T23:02:04.803

> 该脚本事先混淆了单独的查询（它期待我不再调用的旧查询的参数）

这是您的程序流程在其他一些代码中的问题。很可能循环运行。

`$query`至于您在此处发布的代码，无需设置`NULL`- 无论如何它都会被下一行覆盖。

请注意，mysql 的有效字符集是`utf8`，不是`utf-8`

# jquery - 更新 DIV 内容时未处理 ROR 代码

> ID：14175487
> 
> 赞同：1
> 
> 时间：2013-01-05T19:26:57.620
> 
> 标签：jquery, ruby-on-rails, ajax, render

请，我请求你对 Ajax 的帮助。我已经找到了几个解决这个问题的方法，但没有一个有效。

每当我尝试使用 ROR 代码更新 DIV 内容时，它都会显示代码，而不是结果。我隐藏了与我的问题无关的代码，以保持问题清晰且易于理解。

在我的 HTML 中，我有这个链接：

```
<%= link_to 'Adicionar lançamento (+)', '#', id: "add-lancamento"  %> 
```

在我的 JS 文件中，我有：

```
$('#add-lancamento').click(function(event){
  $('#dialog').html("<%= escape_javascript( render(:partial => 'form') ).html_safe %>");
  event.preventDefault();
}); 
```

我知道该链接有效，因为#dialog 中的内容正在发生变化。但新内容是：

```
<%= escape_javascript( render(:partial => 'form').html_safe ) %> 
```

我正在使用“escape_javascript”和“html_safe”，已经将“”更改为“”，但我仍然得到相同的结果。它显示代码而不处理它。它不会渲染部分。

我发现了几个与不同版本的 Rails 相关的解决方案，所以这些是我的系统详细信息：

```
Ruby version    1.9.3 (i386-mingw32)
RubyGems version    1.8.16
Rack version    1.4
Rails version   3.2.8
JavaScript Runtime  JScript
Active Record version   3.2.8
Action Pack version 3.2.8
Active Resource version 3.2.8
Action Mailer version   3.2.8
Active Support version  3.2.8
Middleware  
ActionDispatch::Static
Rack::Lock
#<ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x39fdc08>
Rack::Runtime
Rack::MethodOverride
ActionDispatch::RequestId
Rails::Rack::Logger
ActionDispatch::ShowExceptions
ActionDispatch::DebugExceptions
ActionDispatch::RemoteIp
ActionDispatch::Reloader
ActionDispatch::Callbacks
ActiveRecord::ConnectionAdapters::ConnectionManagement
ActiveRecord::QueryCache
ActionDispatch::Cookies
ActionDispatch::Session::CookieStore
ActionDispatch::Flash
ActionDispatch::ParamsParser
ActionDispatch::Head
Rack::ConditionalGet
Rack::ETag
ActionDispatch::BestStandardsSupport
Application root    D:/sites/ror/buf4
Environment development
Database adapter    sqlite3
Database schema version 20121224183551 
```

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:43:03.230

您的 javascript 文件是否具有扩展名 .js.erb？假设您正在使用资产管道，能够做到这一点

```
<%= escape_javascript( render(:partial => 'form') ).html_safe %> 
```

在您的 javascript 文件中需要是否具有 .js.erb 扩展名

# grails - GORM 在删除时在多对一关系中将外键设置为空

> ID：14175489
> 
> 赞同：0
> 
> 时间：2013-01-05T19:27:06.263
> 
> 标签：grails, constraints, grails-orm

我的域名：

```
Company {
   String name
}

Contact {
   String name
   Company compa

   static constraints = {
      compa (nullable: true)
   }
} 
```

如果公司有来自联系人的外键约束，我无法删除它。我希望删除工作，并且在删除公司时将 compa 属性设置为 null。

是否有这样做的约束？有没有比我尝试的更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T17:00:45.727

试试这个，也许还有其他选择。我没有测试过这段代码，只是给你一个想法。

在 Company.groovy 中：

```
 def beforeDelete() {
      Contact.withNewSession {
          Contact.findAllByCompany(this).each {
            it.company = null
            it.save()
          }
      }
 } 
```

# sed - sed 查找限制在行号范围内的行号

> ID：14175490
> 
> 赞同：2
> 
> 时间：2013-01-05T19:27:06.560
> 
> 标签：sed

我正在尝试使用 sed 在文本文件中查找字符串的行号。以下代码完美运行。

```
variable1=$(sed -n '/asdf/ =' $file); 
```

我遇到的问题是当我尝试将搜索限制在一系列行号时。在下面的示例中，我试图将其限制在第 5 行到第 10 行。假设“asdf”存在于第 7 行。我没有将值设置为 variable2。

```
variable2=$(sed -n '5,10 /asdf/ =' $file); 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:07:30.867

你的 sed 线非常接近。见下文（借用 sudo_O 的输入示例：

```
kent$  echo "qwer
asdf
zxcv
qwer
asdf
zxcv
qwer
asdf
zxcv"| sed -n '5,10 {/asdf/=}'  
5
8 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:58:36.573

以下是如何使用`awk`：

```
$ cat file
qwer
asdf
zxcv
qwer
asdf
zxcv
qwer
asdf
zxcv 

$ awk '/asdf/ && NR>=5 && NR<=10 {print NR}' file
5
8 
```

如果您想在第一次匹配后停止`exit`脚本并使用命令替换将值存储在变量中：

```
$ awk '/asdf/ && NR>=5 && NR<=10 {print NR; exit}' file
5

$ var=$(awk '/asdf/ && NR>=5 && NR<=10 {print NR; exit}' file)

$ echo $var
5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:10:54.947

这对我有用：

```
variable2=$(sed -n '5,10 {/asdf/=}' $file); 
```

# wpf - WPF，Visual Studio 的混合？

> ID：14175497
> 
> 赞同：5
> 
> 时间：2013-01-05T19:27:29.540
> 
> 标签：wpf, visual-studio-2012, expression-blend, blend-2012

我听说过在 VS 2008-2010 中使用 WPF（xaml 设计器）的投诉，但在 2012 中没有。它仍然是使用 Blend 的标准还是 VS 2012 拥有我们需要的一切？我知道最近发布了“Blend for Visual Studio”。这就是魔法融合吗？

这当然是假设我们没有设计师要求 Blend。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T12:26:40.063

从 Visual Studio 2012 开始，XAML 设计体验基于在 Expression Blend for Visual Studio 中运行的相同代码。这将极大地增强 VS 中的设计体验，但它仍然不是 Blend 提供的全部功能集。

一个警告：Visual Studio 的当前版本的 Expression Blend（现在免费，带有 VS，顺便说一句）仅适用于 Windows 应用商店应用程序。Visual Studio Update 2 将提供对 WPF、SL、Windows Phone 和 SketchFlow 的支持。如果在此之前需要，可以下载[预览版](http://blendinsider.com/technical/announcing-blend-sketchflow-preview-for-visual-studio-2012-2012-08-15/)。

# vba - Word 2010 VBA代码查找，选择和删除具有特定列标题的表列

> ID：14175499
> 
> 赞同：4
> 
> 时间：2013-01-05T19:27:38.430
> 
> 标签：vba, ms-word

该方案是每周在 Word 2010 中收到需要调整的表格。在宏的其他添加中，需要删除名为“WebSite”的列。**不过，名为“WebSite”的列可能并不总是在同一位置。**

我需要知道用于查找、选择和删除可能会更改位置但始终保持相同列标题的特定表列的 VBA 代码。

**有没有办法在 vba 代码中插入搜索词，以确保删除右列，即使每次在 Word 中打开表时它在表中的位置可能会改变？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:56:03.560

尝试：

```
Dim tbl As Table
Dim cl As Cell

''All tables
For Each tbl In ActiveDocument.Tables
    ''Look in row 1 only ...
    For Each cl In tbl.Rows(1).Cells
        ''For a cell containing website and end of cell
        If cl.Range.Text = "website" & Chr(13) & Chr(7) Then
            ''Select ...
            cl.Column.Select
            ''Allow the user to choose delete
            If MsgBox("Del selected?", vbYesNo) = vbYes Then
                cl.Column.Delete
            End If
        End If
    Next
Next 
```

# sql - 使用 IN 列表和/或循环基于用户输入的 SQL 更新

> ID：14175513
> 
> 赞同：0
> 
> 时间：2013-01-05T19:29:09.123
> 
> 标签：sql, sql-update

我需要编写一个更新，该更新需要用户输入文本（如下）并运行有效的更新（需要这样做）。我认为我需要使用某种类型的循环或游标。*参考*列可能有其他文本，而不仅仅是“燃料=？”。用户知道格式必须是 'FUEL=?' 使此更新生效。我目前无法向表中添加附加列。我是新来的……谢谢你的帮助！！

### 用户输入将如下：

燃料组 = A, C

新附加费 = 2

### 需要这样做

```
update tblroutes
set DriverSurcharge = 2
where Reference like '%FUEL=A%' or  Reference like '%FUEL=C%' 
```

### 表开始

路线ID | 参考 | 附加费

F01 | Windows 燃料=A | 0

F02 | 燃料=A | 0

F03 | 燃料=B | 0

F04 | 赢得 8 燃料=B | 0

F05 | 燃料=C | 0

F06 | 燃料=C MAC | 0

F07 | 燃料=D | 0

### 想要的最终结果

路线ID | 参考 | 附加费

F01 | Windows 燃料=A | 2

F02 | 燃料=A | 2

F03 | 燃料=B | 0

F04 | 赢得 8 燃料=B | 0

F05 | 燃料=C | 2

F06 | 燃料=C MAC | 2

F07 | 燃料=D | 0

我可以一次更新 1 个“燃料组”，但希望用户能够一次将更新运行到他们想要的任意数量的组。

```
DECLARE @Surcharge INT
DECLARE @Group Varchar

--This will give the user a input box for surcharge amount
--SET @Surcharge= '<< Please enter surcharge amount. >>'
----This will give the user a input box for fuel group(s)
--SET @Group= '<< Please enter fuel group(s). >>'

--If the user entered 4 & A
SET @Surcharge= '4'
SET @Group= 'A'

update tblroutes
set DriverSurcharge = @Surcharge
where Reference like '%FUEL='+@Group+'%' 
```

现在如果用户输入 Fuel Group = A, C 我该如何处理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:01:48.897

如果我理解正确，您的主要问题是在 SQL 中解析用户输入。解析实际上意味着拆分字符串。只要您在临时表或表变量中有单独的值，您就可以在循环中运行您的（已经创建的）查询。

看看这个问题和答案：[如何拆分字符串以便可以访问项目 x？](https://stackoverflow.com/questions/2647/split-string-in-sql)

# c# - 将 Func 分配给表达式，反之亦然

> ID：14175514
> 
> 赞同：19
> 
> 时间：2013-01-05T19:29:16.660
> 
> 标签：c#, linq, lambda, expression, func

我在篡改 Expressions 并且在某些时候感到困惑

1.  我们可以将相同的 LamdaExpression 分配给 Expression 和/或 Func。但是我们不能将 Func 分配给表达式（或将表达式分配给 Func）。为什么我们不能这样做？我查找是否定义了 Expression 和 Func 之间的转换运算符，但我找不到。

    ```
    Func<int, int> sumFunc            = i => i + i;
    Expression<Func<int, int>> sumExp = i => i + i;

    // sumExp = sumFunc; // Cannot convert source type 'System.Func<int,int>' to target type 'System.Linq.Expressions.Expression<System.Func<int,int>>'
    // sumFunc = sumExp; // Cannot convert source type 'System.Linq.Expressions.Expression<System.Func<int,int>>' to target type 'System.Func<int,int>' 
    ```

2.  即使我们不能将 LambdaExpression 分配给对象。再说一次，为什么我们不能这样做？

    ```
    // object o = i => i + i; // Cannot convert source type 'lambda expression' to target type 'object' 
    ```

3.  我认为编译器有一些东西。如果是这样，我们是否可以编写我们的自定义类型以这种（令人困惑的）方式表现并利用某些东西。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-05T23:05:52.453

关于[C# 语言规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)的 lambda 表达式，如

```
i => i + i 
```

是一个匿名函数。具有此分类的表达式可以隐式转换为兼容的委托类型或表达式树类型。这就是为什么你可以同时写

```
Func<int, int> sumFunc            = i => i + i;
Expression<Func<int, int>> sumExp = i => i + i; 
```

第一个是委托类型，第二个是表达式树类型。因为这些类型之间没有隐式转换，所以不能赋值`sumFunc = sumExp`，反之亦然。但是由于表达式树`sumExp`表示一个 lambda 表达式，您可以将该表达式编译为可执行委托并将其分配给`sumFunc`，因为这是一个兼容的委托：

```
sumFunc = sumExp.Compile(); 
```

另一个方向是不可能的，因为委托不能轻易地“反编译”成表达式树。

写不出来的原因

```
object o = i => i + i; 
```

也就是说，匿名函数本身没有值或类型，它只能转换为委托或表达式树类型。你必须告诉编译器你想要哪一个，所以你可以先转换它，然后将结果分配给 type 的变量`object`：

```
object sumFuncObject = (Func<int, int>) (i => i + i);
object sumExpObject = (Expression<Func<int, int>>) (i => i + i); 
```

关于您的最后一个问题：您可以在复杂类型之间创建自定义的隐式或显式转换，以便可以将这种“魔术”应用于分配。有关详细信息，请参阅[转换操作编程指南](http://msdn.microsoft.com/en-us/library/09479473.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-04T09:21:37.837

实际上，这两个表达式都是语法糖，由编译器以不同的语言结构进行转换。

当您编写 lambda 表达式时，编译器会执行以下操作：生成与您的 lamda 表达式匹配的成员函数并将其分配给您的 sumFunc 变量（这不是确切的代码，只是为了了解一下）：

```
class Program
{
   private static int generatedname(int i)
   {
        return i + i;
   }

   static void Main()
   {
       Func<int, int> sumFunc = generatedname;
   } 
} 
```

当您编写表达式树时，会发生更多魔术。在编译时，编译器将您的表达式转换为表达式树“构造”。像这样。

```
class Program
{
    static void Main()
    {
        var addPrm = Expression.Parameter(typeof(int), "i");
        Expression<Func<int, int>> sumExp = 
            Expression.Lambda<Func<int, int>>(
                Expression.Add(
                    addPrm,
                    addPrm
                ),
                addPrm
            );
    } 
} 
```

你看这是完全不同的事情，这就是为什么你不能简单地把一个扔给另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:34:02.133

表达式是一种抽象。它允许 Linq 有效地为数据库、XML 或其他数据源构建 SQL 查询。它在概念上类似于抽象语法树，它存储查询的语法元素，因此 Linq 提供程序可以构建查询。

如果它按您的预期工作，它需要做的是获取 lambda 函数的抽象语法树并生成表达式对象树。好吧，据我所知，这实际上是不可能的，那又有什么好处呢？

# php - Facebook 打开图表重置

> ID：14175516
> 
> 赞同：0
> 
> 时间：2013-01-05T19:29:21.337
> 
> 标签：php, jquery

我想做的是动态重置网页中的元数据，我的想法是这样的：

```
<meta property="og:title" content="<?php if(isset($title)){echo $title;} ?>" /> 
```

当我将鼠标悬停在页面上的按钮上时，我想设置变量 $title。我知道我可以用 jquery 捕获它，所以我需要做的就是将数据传递给 php 脚本。由于 jquery 是客户端而 php 是服务器端，我看不到如何实现它。尽管下面的代码是无稽之谈，但我希望它有助于解释我想要实现的目标：

```
<script>
    $(function(){
    $('button selector').hover(function(){
        var mdata = 'Some value';
        });
    });
</script>

<?php 
    if(isset(mdata)){
        $phpvariable = mdata;
    }
?> 
```

有什么方法可以达到这种效果吗？也许我可以用 jquery 做这一切？

# asp.net - 如何使用 asp.net mvc windows 身份验证自动登录用户

> ID：14175520
> 
> 赞同：0
> 
> 时间：2013-01-05T19:29:50.353
> 
> 标签：asp.net, asp.net-mvc, iis-7

我正在开发一个 asp.net mvc Web 应用程序，并且我已经更新了 web.config 文件以使用 Windows 身份验证，如下所示：-

```
 <authentication mode="Windows" />
    <authorization>
      <deny users="?" />
    </authorization> 
```

目前，系统会提示用户输入用户名和密码对话框来输入他们的凭据，那么有没有一种方法可以自动签署用户而无需重新输入他们的凭据？此致

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:34:39.137

如果用户已经通过应用程序所在的域（例如您的 Intranet）进行身份验证，他们将自动登录。如果您的用户来自另一个网络（例如 Internet），他们将收到基本身份验证对话框提示你看到了。

确保 IIS 具有它的身份验证设置，以便您没有启用匿名和启用 Windows 身份验证。

# ruby - 错误消息中引用了两个不同版本的 ruby ？

> ID：14175521
> 
> 赞同：1
> 
> 时间：2013-01-05T19:29:59.353
> 
> 标签：ruby

> **可能重复：**
> [为什么当我的 Ruby 版本与 1.9.1 不同时，gems 安装在 1.9.1 目录中？](https://stackoverflow.com/questions/6352262/why-are-gems-installed-in-a-1-9-1-directory-when-my-ruby-version-is-different-th)

我在控制台中收到以下错误消息。我修复了这个错误，但有一些我不明白的地方，即 1.9.3 和 1.9.1 之间的差异的含义。

```
.rbenv/versions/1.9.3-p327/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem' 
```

ruby 的系统范围版本已使用 rbenv 设置为 1.9.3，但是，这只是最近才完成的，我想知道这个特定的应用程序是否是用 1.9.1 制作的。是`site_ruby/1.9.1`指的那个吗？

第二个问题，我知道我可以检查系统中使用的 ruby​​ 的当前版本，`ruby -v`但是你如何找出项目是用什么版本的 ruby​​ 制作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:41:33.913

这是因为 1.9.1 是 Ruby C API 版本，它允许该目录中的 gem 跨符合相同 Ruby C API 版本（1.9.1-1.9.3 都使用 1.9.1）的 Ruby 版本使用，而无需重新编译 C 扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:37:05.893

gems 和 site_ruby 的子目录自`1.9.1`.

# matlab - MATLAB fitensemble：它如何构建每棵树？基于所有特征或特征子集？

> ID：14175526
> 
> 赞同：0
> 
> 时间：2013-01-05T19:30:35.237
> 
> 标签：matlab, random-forest

我在 matlab 2011b 中使用带有“Bag”的 fitensemble 函数进行分类，方法如下：

**fitensemble(特征, classLabels,'Bag',10,'tree','type', 'classification');**

有人可以告知构建每个决策树的 fitensemble 选择特征吗？它是否为每棵树选择所有特征的子集（就像原始的 Breiman 的随机森林一样）？或者它选择所有特征来构建每棵树？

例如，如果数据集中有 500 个特征，每棵树是基于 500 个特征构建的，还是随机选择 500 个特征的子集来构建每棵树？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T10:08:52.457

看一下 和的`NVarToSample`性质。您可以将其设置为正整数或“全部”。默认情况下，分类使用“全部”进行提升，使用变量数量的平方根进行装袋（您的情况）。对于回归，它使用“全部”进行提升，使用 1/3 的变量数量进行装袋。`ClassificationTree.template``Regressiontree.template``fitensemble`

# iphone - 如何将 UIColor 输入到用户默认值？

> ID：14175527
> 
> 赞同：-1
> 
> 时间：2013-01-05T19:30:42.483
> 
> 标签：iphone, objective-c, xcode, nsuserdefaults, uicolor

> **可能重复：**
> [将 UIColor 保存到 NSUserDefaults 并从中加载](https://stackoverflow.com/questions/1275662/saving-uicolor-to-and-loading-from-nsuserdefaults)

我想初始化用户默认值，制作 NSDictionary，输入数据和 refisterDefaults。但是这段代码有错误。

```
//if UserFilter entry is nothing, create.
NSDictionary *defaultFilter = [NSDictionary dictionaryWithObject:[NSNumber numberWithInt:0] forKey:@"UserFilter"];
[userDefaults registerDefaults:defaultFilter];

//if UserBadgeColor entry is nothing, create.
UIColor *color = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
NSValue *valColor = [NSValue value:&color withObjCType:@encode(UIColor)];
NSDictionary *defaultBadgeColor = [NSDictionary dictionaryWithObject:valColor forKey:@"UserBadgeColor"];
[userDefaults registerDefaults:defaultBadgeColor]; 
```

运行，UserFilter部分没有问题。但 UserBadgeFilter 部分有错误。错误行在最后。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:25:30.770

从手册：

> NSUserDefaults 类提供方便的方法来访问常见类型，例如浮点数、双精度数、整数、布尔值和 URL。默认对象必须是一个属性列表，即以下实例（或集合实例的组合）：NSData、NSString、NSNumber、NSDate、NSArray 或 NSDictionary。如果要存储任何其他类型的对象，通常应该将其归档以创建 NSData 的实例。

但是你可以简单地使用 NSData，所以在你的情况下：

```
UIColor *color = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
NSData* colorData= [NSKeyedArchiver archivedDataWithRootObject: color];
NSDictionary *defaultBadgeColor = [NSDictionary dictionaryWithObject: colorData forKey:@"UserBadgeColor"];
[userDefaults registerDefaults:defaultBadgeColor]; 
```

[当您从默认值中读取数据时，使用NSKeyedUnarchiver](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSKeyedUnarchiver_Class/Reference/Reference.html)将数据解码回 UIColor 。

# iphone - 多视图的 UIView 动画重复计数

> ID：14175529
> 
> 赞同：-2
> 
> 时间：2013-01-05T19:30:51.580
> 
> 标签：iphone, objective-c, ios, xcode

我想应用超过 10 个元素的摆动动画。它适用于 6 - 9 个元素。如果元素摆动超过 10 次，则应用成功，但是，如果我在动画应用程序没有响应时按下主页按钮。

我的代码是：

```
while(subviews)
{
    [UIView beginAnimations:@"wiggle" context:nil];

    [UIView setAnimationDuration:0.1];

    [UIView setAnimationRepeatAutoreverses:YES];

    [UIView setAnimationRepeatCount:FLT_MAX];

        //wiggle 1 degree both sides
    touchView.transform = CGAffineTransformMakeRotation(0.0174532925);

    touchView.transform = CGAffineTransformMakeRotation(-0.0174532925);

    [UIView commitAnimations];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:03:03.517

在您的应用程序委托中保留对您的视图的引用并取消所有动画`applicationWillResignActive:`。

# javascript - 使用 jQuery 在列表中搜索特定文本

> ID：14175531
> 
> 赞同：0
> 
> 时间：2013-01-05T19:31:19.113
> 
> 标签：javascript, jquery, html, css

我无法将列表限制为仅添加唯一项目这是我到目前为止所拥有的

```
function addTab(tabName)
{
    var tabList=$("#pageContent ul").find("li").text();
    if($("#pageContent ul li:contains('"+tabList+"')").length<1)
    {
        $("#pageContent ul").append("<li>"+tabName+"</li>");
    }
    else
    {   

    }
} 
```

但它不起作用我不确定出了什么问题，据我所知，这应该是最好的方法。

我打算使用 jQuery UI 选项卡，但我的布局使用浮动和混乱的选项卡小部件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:37:32.020

您正在获取所有 li 元素的文本内容，然后尝试选择包含该特定文本的 li 元素，这没有意义，您甚至没有`tabName`在过滤逻辑中使用，请尝试以下 using`filter`方法。

```
function addTab(tabName) {
    var $e = $("#pageContent ul");
    var n = $e.find("li").filter(function(){
        var t = this.textContent || this.innerText;
        return t === tabName
    }).length;

    if (n === 0) {
        $e.append("<li>"+tabName+"</li>");
    } else {  
       // ...
    }
} 
```

# c# - 将 LAB 颜色存储为整数

> ID：14175538
> 
> 赞同：1
> 
> 时间：2013-01-05T19:32:12.847
> 
> 标签：c#, serialization, colors, rgb

使用 RGB 值时，.NET 内置了将其从整数转换的方法，并且将颜色转换为 int 很简单。有没有办法将 LAB 颜色存储为整数？与 RGB 不同，LAB 颜色值可以为负值。如果我可以避免它，我不想将颜色存储在 RGB 中并在运行时转换它们，因为我不需要 RGB 值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:36:34.780

所以正在完成的转换是 RGB -> XYZ 与旧的 2 度观察者和 CIE 标准光源 D65 -> CIELAB。用于执行的代码供参考，如下所示（假设 R、G、B 在 [0, 1] 中）。

考虑到这些从 RGB 中每个通道 8 位开始的转换，L* 的范围是 [0, 100], a* (-85.92, 97.96], b* (-107.54, 94.20]。这些值是非常接近的。理论上, a* 和 b* 是无界的，但是你会发现一些地方谈到了 +-128、+-110 等的限制。我的建议是简单地将 128 与每个值相加，再乘以 100，然后四舍五入到整数（对于颜色应该足够精确）。任何给定的 L*a*b 三元组都可以用 16 位无符号整数表示。您可以将它们打包成 64 位整数。解包后您将减去 128从每个值。如果你能保留三个有符号的短整数，事情就会变得简单得多。

```
def rgb_xyz(r, g, b): # 2o. D65
    triple = [r, g, b]

    v, d = 0.04045, 12.94
    for i, c in enumerate(triple):
        triple[i] = 100 * (c / d if c <= v else ((c + 0.055)/1.055)**2.4)

    multipliers = (
            (0.4124, 0.3576, 0.1805),
            (0.2126, 0.7152, 0.0722),
            (0.0193, 0.1192, 0.9505))

    x, y, z = [sum(row[i] * triple[i] for i in range(3))
            for row in multipliers]
    return x, y, z

def xyz_cielab(x, y, z):
    triple = [x, y, z]

    t0, a, b = 0.008856, 7.787, 16/116.
    ref = (95.047, 100.0, 108.883)
    for i, c in enumerate(triple):
        triple[i] /= ref[i]
        c = triple[i]
        triple[i] = c ** (1/3.) if c > t0 else a * c + b

    l = 116 * triple[0] - 16
    a = 500 * (triple[0] - triple[1])
    b = 200 * (triple[1] - triple[2])
    return l, a, b 
```

# hibernate - 如何在休眠对象中正确存储枚举数组？

> ID：14175540
> 
> 赞同：0
> 
> 时间：2013-01-05T19:32:27.293
> 
> 标签：hibernate, enums

我有一个包含一组标签的实体 A，如以下代码段所示：

```
@Entity
@Table(name = "tab_a")
public class A {

......

@Column(name = "name")
@ElementCollection(targetClass = Genre.class, fetch = FetchType.EAGER)
@CollectionTable(name = "tab_resource_tags", joinColumns = @JoinColumn(name = "id"))
@Enumerated(value = EnumType.STRING)
@OrderColumn
private Set<Genre> resourceTags;

------
} 
```

我创建了一个额外的 tab_resource_tags 只是为了让这个东西正常工作，但是当我运行我的单元测试并将标签插入到类 A 中时，新创建的表仍然是空的。我真的不明白它的意义。

我的目标是将标签存储在存储“A”实体的同一个表中。理想情况下，它们应该是纯文本并用逗号分隔以便人类可读。

我的问题是：创建一个单独的表仅用于插入一组/列表枚举是否值得？完全不将枚举反映到数据库中并将其插入原始的“A”表中*不是*更优雅吗？

任何与此相关的意见将不胜感激。

**后期编辑：**

作为一种解决方法，我尝试指定

```
@CollectionTable(name = "tab_a", joinColumns = @JoinColumn(name = "id")) 
```

但是 Hibernate 说来自 tab_a 的列没有默认值（我会说这很奇怪）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T17:57:53.533

这是我解决此问题的方法（以防其他人需要此信息）：

注释几乎相同，因此您可以查看原始问题（标签的@Column 表示来自 tab_resource_tags 的列，而不是 tab_a 和 @JoinColumn 属于同一个 tab_resource_tags）。可以在这里仔细查看：[http ://en.wikibooks.org/wiki/Java_Persistence/ElementCollection](http://en.wikibooks.org/wiki/Java_Persistence/ElementCollection)

问题出在数据库表上：

数据库中的 tab_a 表没有什么特别之处。重要的部分是 tab_resource_tags：

```
CREATE TABLE `tab_resource_tags` (
    `resource_descriptor_id` int(11) NOT NULL,
    `tag_name` varchar(255) NOT NULL
) 
```

*   注意这里缺少主键（这是我的错误）。

所以现在，每次我添加一个包含一组类型为 Genre 的 Enum 的实体时，它们都会进入标签表，有效地模拟多对多关系（仅使用 Enums 而不是真正的类）。

希望这可以说清楚。

# html - 一个没有任何 html 或 body 标签但只有一个 div 的 html 文件在所有浏览器中呈现

> ID：14175542
> 
> 赞同：2
> 
> 时间：2013-01-05T19:32:35.660
> 
> 标签：html

当我看到如果我将以下内容保存到扩展名为“htm”的文件中时，我感到很吃惊，然后它会呈现并显示 JavaScript 警报。

我的印象是浏览器肯定需要 html，至少需要 body 标签来呈现 html 文件。

**浏览器这样做是否正常，这是否会导致任何与安全相关的问题？**

```
 <table width="100%" height="100%" border="1">
            <tr>
                <td  style="margin:0 auto;">
                    <div style='color:red;height:100%;width:100%;margin:0 auto;text-align:center;border-width:1px;border-color:blue;border-style:solid;vertical-align:middle' id="div1">
                        Does this render in a Browser, since there are html, head and body tags?
                        <div id='div2' style='height"100%;width:100%;margin:0 auto;text-align:center;border-width:1px;border-color:green;border-style:solid;'>Hello! Will the browser show this?</div>
                    </div>
                </td>
            </tr>
        </table>
      <script type='text/javascript'>    alert('showing without tags');</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:15:27.237

浏览器根据文件扩展名（对于本地文件）或 Content-Type HTTP 标头（对于通过 HTTP 访问的文件）确定文档是否为 HTML，而不是基于与文档中的内容有关的任何内容（除了某些版本的 Internet Explorer 将嗅探非文本/html 文档以查看它们是否可能是 HTML）。

一旦浏览器确定一个文档是 HTML，它会尽其所能呈现它，尽管有任何可能使它无效的东西。为应对不良文档而编写的浏览器和因为浏览器可以应对而编写的不良文档的组合导致了所有浏览器中越来越强大的错误恢复例程的螺旋式上升。

缺少的`html`和`body`标记不会导致它无效，这些元素的开始和结束标记在所有版本的 HTML 中都是可选的（尽管不是没有可选标记的 XHTML）。如果给定了合适的 Doctype 和标题，该文档将是有效的。

向浏览器提供无效 HTML 没有内在的安全问题。您必须小心您允许将哪些用户生成的内容添加到您的网站（但即使浏览器只接受有效文档，您也必须小心），有时糟糕的 HTML 可能会利用浏览器中的安全漏洞（但它是浏览器供应商解决这些问题的责任）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:01:23.587

当面对这样的 HTML（没有 doctype）时，大多数浏览器都会进入[quirks](http://en.wikipedia.org/wiki/Quirks_mode) [mode](http://quirks.spec.whatwg.org/)。

他们如何解释 HTML 并在这一点上呈现它不是标准化的并且是特定于实现的。

这也意味着您不能依赖在未来版本中保持不变的行为。

简而言之 - 不要依赖当今的浏览器以任何特定方式呈现此类 HTML - 它可能会改变。

至于您的安全问题 - 我真的不明白这与安全有什么关系（除了正常的浏览器安全问题）。

# ios - 如何更改自定义按钮的文本？

> ID：14175544
> 
> 赞同：3
> 
> 时间：2013-01-05T19:33:06.687
> 
> 标签：ios, uibutton

我需要为这个自定义按钮设置文本。我认为它就像使用`setText`方法来设置它的文本一样简单。但是，不幸的是，它不起作用。

那么，为什么这种方法不适用于任何**自定义按钮**？

当我们将其类型更改为**自定义**时，基本上它是如何影响这个的`UIButton`？

谢谢你。

**编辑：**我通过 IB创建了这个**UIButton 。**用于更改文本的代码是这样的：

```
 [self.btnDiscover setTitle:@"Discover" forState:UIControlStateNormal]; 
```

![自定义按钮](../Images/244fbc1b89067e575eb80168a000649d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T19:38:47.493

使用`setTitle:forState:`代替`setText`，例如：

```
[button setTitle:NSLocalizedString(@"CONTACT_BUTTON", @"Contact Us") forState:UIControlStateNormal]; 
```

另外，请确保您使用`setBackgroundImage:forState:`的是设置按钮图像而不是`setImage:forState:`.

至于您关于自定义样式的问题，分配`UIButtonTypeCustom`给按钮仅意味着该按钮未分配样式（[source](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIButton_Class/UIButton/UIButton.html#//apple_ref/doc/c_ref/UIButtonType)）：

> UIButtonType自定义
> 
> 没有按钮样式。

# regex - 使用正则表达式的 Neo4j 索引查询

> ID：14175546
> 
> 赞同：3
> 
> 时间：2013-01-05T19:33:30.153
> 
> 标签：regex, indexing, neo4j

我正在尝试通过 Name 上的索引来获得一些艺术家的喜欢：

```
START n=node:Artist(Name =~ 'Michael*.')
MATCH n<-[:LIKES]-liker
return liker.Id, n.Label
LIMIT 50 
```

我有这个错误：无效的查询字符串文字或参数预期“START n = node：ArtistId（Name =〜'Michael *。'）”

我想知道如何在索引查询中使用正则表达式？我知道我可以在比赛中使用正则表达式，但我不知道如何在 START 中使用正则表达式。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:33:51.537

您不能使用正常的正则表达式语法，但可以使用通配符：

```
START n=node:Artist('Name:Michael*') 
```

**编辑**：

Neo4J 使用[Apache Lucene](http://lucene.apache.org/core/old_versioned_docs/versions/2_9_1/queryparsersyntax.html#Wildcard%20Searches)进行索引查询。除了通配符之外，您还可以做一些其他很酷的事情。

# android - 使用布局充气器更新搜索栏

> ID：14175547
> 
> 赞同：0
> 
> 时间：2013-01-05T19:33:47.377
> 
> 标签：android, layout, seekbar

我有一个搜索栏，需要从服务中更新。但是光标根本不动。这是代码（您可以看到很多布局，因为我只放了您需要的代码，但这些布局中还有其他视图对象）：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="top"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="100dp"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="-80dp"
        android:gravity="center_horizontal"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal" >

            <SeekBar
                android:id="@+id/seekBarTime"
                android:layout_width="200dp"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical" />

        </LinearLayout>

    </LinearLayout>

</RelativeLayout> 
```

爪哇

```
public class MediaPlayerService extends Service implements Runnable {

    private MediaPlayer mediaPlayer = null;
    private SeekBar seekBarTime;
    private Handler handler;
    private Runnable runnable;

    @Override
    public void onCreate() {
        //SET SEEKBAR
        LayoutInflater inflater = ( LayoutInflater ) getSystemService( LAYOUT_INFLATER_SERVICE );
        View layout = inflater.inflate( R.layout.play_song , null);
        seekBarTime = (SeekBar) layout.findViewById(R.id.seekBarTime);
        seekBarTime.setOnSeekBarChangeListener(this);

        handler = new Handler();
        runnable = this;
        handler.post(runnable);
    }

    // Seekbar
    public void run() {     
        if(mediaPlayer.isPlaying()) {

            int currentPosition = 0;
            int total = mediaPlayer.getDuration();
            seekBarTime.setMax(total);
            currentPosition = mediaPlayer.getCurrentPosition();

            Log.w("disgustingapps", currentPosition + " / " + total);

            seekBarTime.setProgress(currentPosition);

        }

        handler.postDelayed(runnable, 1000);
    }
} 
```

logcat 向我保证 currentPosition 和 total 不为空。然而什么也没发生。你能帮助我吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:04:28.650

它应该工作。我测试了你的`run()`方法，在我这边，SeekBar 更新得很好。
您在哪里创建和启动`MediaPlayer`?

run() 方法正在检查媒体播放器是否正在播放：

```
if(mediaPlayer.isPlaying()) {
...
} 
```

但我没看到`mediaPlayer().start()`

# applescript - 内联苹果脚本

> ID：14175548
> 
> 赞同：1
> 
> 时间：2013-01-05T19:33:48.407
> 
> 标签：applescript, osascript

我需要内联编写以下脚本

```
tell app "Spotify Queue"
    addTrack "spotify:track:7sa1xOgT1c8xQfbSL5FrCe"
end tell 
```

像这个

```
sh('osascript -e \'tell app "Spotify" to playpause\'') 
```

但我做错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:36:02.947

您不需要多行：

```
tell app "Spotify Queue" to addTrack "spotify:track:7sa1xOgT1c8xQfbSL5FrCe" 
```

如果您确实需要不止一行，可以像这样使用 osascript：

```
osascript -e 'tell app "Finder"' -e 'display dialog "Multi-line"' -e 'end' 
```

# android - Android - 从另一个类为主要活动制作吐司

> ID：14175550
> 
> 赞同：0
> 
> 时间：2013-01-05T19:33:51.230
> 
> 标签：android, timer, toast

我已经整天寻找解决方案。不幸的是，还没有找到任何可以帮助我的东西。

我必须每 15 分钟更改一次值​​​。我不会在我的主要活动中做，但现在是不同的班级。我认为这样的事情不会有问题，但我被困住了。我想打印一条测试消息，但给定的上下文有问题。可能我的“计时器”有一个普遍的问题。

这是我的代码：

主要活动：

```
tm = new TimerLoerg(this.getApplicationContext());
tm.startTimer(); 
```

这里是我的计时器课（未完成）

```
package at.android.dertestloerk;

import android.app.Activity;
import android.content.Context;
import android.graphics.drawable.AnimationDrawable;
import android.os.Handler;
import android.view.Gravity;
import android.widget.ImageView;
import android.widget.Toast;

    public class TimerLoerg extends Activity{

    private Handler handler = new Handler();
    int ms;
    Toast toast;

    private ImageView imageViewLoerg;
    private AnimationDrawable animatedLoerg;

    private Context context;
    Activity activity;

    public TimerLoerg(Context context, Activity activity){
        this.context = context;
        this.activity = activity;
    }

    public void startTimer() {
        ms = 5000;
        handler.postDelayed(timedTask, ms);

        activity.runOnUiThread(new Runnable() {
            public void run() {
                toast = Toast.makeText(context, "Timer gestartet", Toast.LENGTH_SHORT);
                toast.setGravity(Gravity.CENTER, 0, 0);
                toast.show();
            }
        });
    }

    public void changeLoerg() {
        int stufe;
        // layout = (RelativeLayout)findViewById(R.id.LayoutMain);
        imageViewLoerg = (ImageView)activity.findViewById(R.id.imageViewLoerg);

        stufe = SettingsLoerg.getLevel(context);

        Object tag = imageViewLoerg.getTag();

        if (stufe == 1) {
            int loergId = R.drawable.animatedegg;

            if( tag != null && ((Integer)tag).intValue() == loergId) {
                loergId = R.drawable.animatedloerg;
                animatedLoerg.stop();
                //playAnimationNodelay();
                imageViewLoerg.setTag(loergId);
                imageViewLoerg.setBackgroundResource(loergId);
                playAnimationNodelay();
            }
        }
    }

    public void changeStats() {
        int hunger;

        hunger = SettingsLoerg.getHunger(context);
        if (hunger < 15) {
            toast = Toast.makeText(context, "Loerg is very hungry!", Toast.LENGTH_SHORT);
            toast.show();
        }
        else {
            hunger = hunger - 15;
            SettingsLoerg.setHunger(hunger, context);
        }
    }

    private void playAnimation() {
        if (this.imageViewLoerg.getDrawable() instanceof AnimationDrawable) {
            this.animatedLoerg = (AnimationDrawable)this.imageViewLoerg.getDrawable();
            Handler handler = new Handler(getMainLooper());
            handler.postDelayed(new Runnable() {

                @Override
                public void run() {
                    animatedLoerg.start();              
                }
            }, 1500);
        }
    }

    private void playAnimationNodelay() {
        if (this.imageViewLoerg.getDrawable() instanceof AnimationDrawable) {
            this.animatedLoerg = (AnimationDrawable)this.imageViewLoerg.getDrawable();
            animatedLoerg.start();
        }
    }

    private Runnable timedTask = new Runnable(){
          @Override
          public void run() {
           changeLoerg();
           handler.postDelayed(timedTask, 5000);
          }};
} 
```

日志：

```
01-05 20:33:02.521: E/AndroidRuntime(7199): FATAL EXCEPTION: main
01-05 20:33:02.521: E/AndroidRuntime(7199): java.lang.NullPointerException
01-05 20:33:02.521: E/AndroidRuntime(7199):     at at.android.dertestloerk.TimerLoerg$2.run(TimerLoerg.java:29)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at android.os.Handler.handleCallback(Handler.java:615)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at android.os.Looper.loop(Looper.java:137)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at android.app.ActivityThread.main(ActivityThread.java:4745)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at java.lang.reflect.Method.invokeNative(Native Method)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at java.lang.reflect.Method.invoke(Method.java:511)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-05 20:33:02.521: E/AndroidRuntime(7199):     at dalvik.system.NativeStart.main(Native Method) 
```

如您所见， Timer 类未链接到布局。不知道会不会出问题？我只需要一些活动方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:39:50.993

您永远不会为该`toast`字段分配值。当您访问它时，`toast.setGravity(Gravity.CENTER, 0, 0);`您会得到一个空指针异常。

# sockets - 使用TCL插座时挂窗

> ID：14175552
> 
> 赞同：2
> 
> 时间：2013-01-05T19:34:00.897
> 
> 标签：sockets, tcl, tk

我正在使用 TCL 套接字命令在两个 TCL/Tk 应用程序之间进行通信，比如 A 和 B，它们都有关联的 GUI。B 上的服务器基本上接受来自 A 的命令并返回执行结果。问题是 B 的 GUI 在执行完成后立即挂起。有没有办法让两个 GUI 独立工作？我正在使用以下脚本来设置两个应用程序之间的连接：

使用以下 TCL 脚本 client.tcl 启动应用程序 A

```
proc execute { cmd } {
    set cid [socket localhost 9900]
    puts $cid $cmd
    while { [gets $cid line] >= 0 } {
        puts $line
    } 
    close $cid
}

set pid [exec B server.tcl &]

execute {puts HelloWorld} 
```

其中 server.tcl 通过应用程序 B 设置服务器

```
proc server { cid addr port } {
     set cmd [gets $cid]
     catch $cmd result
     puts $cid result
     close $cid
}

socket -server server 9900

vwait forever 
```

目标是让 B 的 GUI 处于活动状态，而用户继续使用 A 的 GUI。这样，用户可以根据需要在两个 GUI 之间切换。A 和 B 都提供了不同的功能来处理需要同时提供的相同数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:05:57.600

您发布的代码有两个关键问题：

1.  客户端在向其写入工作（即要执行的命令）后不会刷新它的套接字，因为出于性能原因，默认情况下非默认通道（不是标准输入、标准输出、标准错误）是完全缓冲的。这可能会导致服务器从一开始就不会真正接收到命令。

2.  `fileevent`服务器不会通过-registered 脚本以非阻塞模式处理接受的套接字。

此外，您还有一个小问题，如果您想发送多行数据，您会发现您的协议不合适。您可能关心也可能不关心这个问题，并且有几种不同的方法可以解决它。

## 关键问题1

处理客户大问题的最好方法是使用

```
fconfigure $cid -buffering none 
```

打开插座后直接。这告诉 Tcl 它应该总是立即将数据发送`puts`到套接字上的通道。（或者，使用`line`而不是`none`获得行缓冲；在这种情况下也可以很好地工作。）您还可以进行显式刷新：

```
flush $cid 
```

那将在`puts`.

## 关键问题2

最佳实践将使用更像这样的服务器脚本，其中一个过程设置接受的套接字连接的服务，另一个过程处理消息的读取和写入。接受过程 ( `server`) 关闭阻塞（并且通常也调整缓冲）并且操作过程 ( `readLine`) 使用`eof`and`fblocked`来确定是`gets`成功还是失败。

```
proc server { cid addr port } {
    fconfigure $cid -blocking 0
    fileevent $cid readable "readLine $cid"
}

proc readLine { cid } {
    set cmd [gets $cid]
    if { [eof $cid] } {
        close $cid
    } elseif { ![fblocked $cid] } {
        catch $cmd result
        puts $cid $result
        close $cid
    }
}

socket -server server 9900
vwait forever 
```

## 另一个问题

如果你真的这样做，另一个大问题是多行消息很有用。要么你需要在`readLine`上面累积行，直到它有一个完整的命令（`append`和`info complete`这里的帮助），要么你需要一些其他机制来处理数据传输。在生产代码中，委托给像 comm 这样的包变得更容易......</p>

# ios - 带有自定义日期的 UIPickerView

> ID：14175555
> 
> 赞同：0
> 
> 时间：2013-01-05T19:34:02.413
> 
> 标签：ios, xcode, nsmutablearray, nsdate, uipickerview

我不能使用 UIDatePicker。在所有评论者告诉我只使用 UIDatePicker 之前，我只想在一开始就把它扔掉。我想要一个显示一年中所有日子的选择轮，直到今天，并将其显示为 Day: 1/Jan 1, Day: 2/Jan 2 等等。这是我到目前为止所拥有的，它检测它是一年中的哪一天的“数字”，并用直到今天的所有日期填充 PickerWheel：

```
NSCalendar *currentCalendar = [NSCalendar currentCalendar];
    NSDate *today = [NSDate date];

    NSInteger dc = [currentCalendar  ordinalityOfUnit:NSDayCalendarUnit
                                               inUnit:NSYearCalendarUnit
                                              forDate:today];
    options = [[NSMutableArray alloc]init];

    for (int index = 1; index <= dc; index++)
    {
        NSString *pickerItemTitle = [NSString stringWithFormat: @"Day: %d", index];
        [options addObject: pickerItemTitle];
    } 
```

我能做些什么来使它也匹配 NSInteger 与日期，并让它成为 pickerItemTitle 的一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:27:39.000

想通了。添加了一些代码以在循环中形成基于日期整数的日期。现在，为 uipickerview 设置数组的 viewWillAppear 方法如下所示：

```
- (void)viewWillAppear:(BOOL)animated
{

    NSCalendar *currentCalendar = [NSCalendar currentCalendar];
    NSDate *today = [NSDate date];

    NSInteger dc = [currentCalendar  ordinalityOfUnit:NSDayCalendarUnit
                                               inUnit:NSYearCalendarUnit
                                              forDate:today];
    options = [[NSMutableArray alloc]init];

    for (int index = 1; index <= dc; index++)
    {
        NSDateComponents *components = [[NSDateComponents alloc] init];
        [components setDay:index];
        NSCalendar *gregorian = [[NSCalendar alloc]
                                 initWithCalendarIdentifier:NSGregorianCalendar];
        NSDate *date = [gregorian dateFromComponents:components];
        NSDateFormatter *formatter = [[NSDateFormatter alloc]init];
        [formatter setDateFormat:@"MMM dd"];
        NSString *articleDateString = [formatter stringFromDate:date];
        NSString *pickerItemTitle = [NSString stringWithFormat: @"Day: %d/%@", index, articleDateString];
        [options addObject: pickerItemTitle];
    }
    [super viewWillAppear:YES];  
} 
```

# jquery - 通过javascript调用控制器的方法

> ID：14175556
> 
> 赞同：0
> 
> 时间：2013-01-05T19:34:07.633
> 
> 标签：jquery, asp.net-mvc, razor

大家好，我是 mvc 新手不是通过ajax的动作方法的方法。查看代码

* * *

```
@{
    ViewBag.Title = "About Us";
}
<script type="text/javascript">

    function ajaxcall() {
        $.ajax({
            url: 'ValidatePin',
            type: 'Post',
            success: function (result) {

                alert(result.d);

            }

        })
    }
</script>
<h2>About</h2>
<p>
     Put content here.

<input type="button" onclick="ajaxcall()"  value="clickme" />

</p> 
```

这是我的方法代码

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Services;
namespace MvcApplication1.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewBag.Message = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            return View();
        }
   [WebMethod]
        public static string ValidatePin()
        {
            return "returned from controller class";

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T06:18:27.610

[带有编码框架](https://incframework.codeplex.com/)的替代解决方案：

**控制器**

```
 [HttpGet]
    public ActionResult ValidatePin()
    {
        return IncJson(new AlertVM(){Message = "Some thing"});
    } 
```

**剃刀页面**

```
@(Html
  .When(JqueryBind.Click)
  .Do()
  .AjaxGet(Url.Action("ValidatePin","Pin"))
  .OnSuccess(dsl => dsl.Utilities.Window.Alert(Selector.Incoding.Data<AlertVM>(r=>r.Message)))
  .AsHtmlAttributes()
  .ToButton("clickme")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:39:21.723

为什么你坚持不实现一个动作方法而不是这个静态方法？我的第二个问题是你的方法实际上是做什么的？验证什么？那么你如何将它传递给这个方法呢？

认为您可能想要这样的东西：

```
public JsonResult ValidatePin(string id) /*id=pin*/
{
    bool result;
    // do something
    return Json(new { IsValid = result, Message = "something" }, JsonRequestBehavior.AllowGet);
}

$.ajax({
                url: '/validatepin/' + pin,
                type: 'POST',
                dataType: 'json',
                data: json,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {

        alert(data.message + '  ' + data.IsValid);
                }
            }) 
```

# ajax - 使用 PUT 上传 S3 的简单工作示例？

> ID：14175560
> 
> 赞同：1
> 
> 时间：2013-01-05T19:34:43.250
> 
> 标签：ajax, upload, amazon-s3, amazon, put

我正在尝试使用简单的 PUT 方法（如果需要，使用 jQuery）上传文件，但亚马逊文档似乎太肤浅，我无法理解。有几个例子 - 很少有旧的，很少有新的（但通常过于复杂）。

有没有人可以写一个简单的教程。这里有三个简单的部分 - 带有单个的 HTML 文件`input[type="file"]`，将生成签名的 PHP 文件和将使用 File API 和 AJAX（我理解的 PUT 方法）将文件存储在 S3 上的最复杂的 JavaScript。

我认为很多人会认为这样一个工作示例是救命稻草，考虑到亚马逊可能不会让 S3 文档对新手友好一些。

# git - Hg-git 停止为多个分支工作

> ID：14175561
> 
> 赞同：8
> 
> 时间：2013-01-05T19:34:50.167
> 
> 标签：git, github, mercurial, bitbucket, hg-git

我保留了mercurial的[主要仓库](https://bitbucket.org/scriptoid/diagramo)，但使用 hg-git 为 git 爱好者[制作了一个克隆。](https://github.com/alexgheorghiu/diagramo/)

问题是在 mercurial repo 中我回到了之前的提交，创建了一个新的匿名分支并关闭了旧分支。（原因：推迟一个功能的开发）

之后我看到 hg-git 停止工作。

我什至试图强制提交，但仍然没有成功。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-05T21:06:39.333

好的...终于在另一个 hg-git[相关问题上找到了答案](https://stackoverflow.com/questions/3982006/no-changes-are-pushed-when-using-hg-git?rq=1)

因此，您似乎必须将“主”书签更新到当前分支。

```
hg bookmark -f master 
```

# android - Android webview, openfilechooser 终止

> ID：14175564
> 
> 赞同：1
> 
> 时间：2013-01-05T19:35:52.060
> 
> 标签：android, webview, android-webview

我有一个简单的应用程序，可以选择上传图像（画廊或相机），我使用 webview 并设法使其工作。

当我打开“openfilechoosr”对话框并返回我的应用程序**而不选择**任何文件（通过背面或只是单击我的应用程序屏幕）时，我遇到了问题，而不是我的应用程序不再响应（直到 android 重新启动），当我重新启动它，它显示为一个空白页。

更多信息：

每次我在没有选择任何文件的情况下退出文件选择器后尝试打开应用程序时都会遇到的错误（应用程序将在重新启动 android 后再次运行）：

> java.lang.Throwable：在设置 WebViewCore 之前不支持 EventHub.removeMessages(int what = 107)

我的代码：[MainActivity]

```
webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(true);
webView.getSettings().setBuiltInZoomControls(true);
webView.getSettings().setSavePassword(false);
webView.getSettings().setSaveFormData(false);
webView.setWebViewClient(new MyWebViewClient());
webView.setWebChromeClient(new MyWebChromeViewClient());  
webView.loadUrl(url);

private class MyWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

    private class MyWebChromeViewClient extends WebChromeClient {
        //@Override
        public void openFileChooser(ValueCallback<Uri> uploadMsg, String acceptType )  {      
             File imageStorageDir = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), "MyApp");
            // Create the storage directory if it does not exist
            if (! imageStorageDir.exists()){
                imageStorageDir.mkdirs();                  
            }
            File file = new File(imageStorageDir + File.separator + "IMG_" + String.valueOf(System.currentTimeMillis()) + ".jpg");  
            imageUri = Uri.fromFile(file); 

            final List<Intent> cameraIntents = new ArrayList<Intent>();
            final Intent captureIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            final PackageManager packageManager = getPackageManager();
            final List<ResolveInfo> listCam = packageManager.queryIntentActivities(captureIntent, 0);
            for(ResolveInfo res : listCam) {
                final String packageName = res.activityInfo.packageName;
                final Intent intent = new Intent(captureIntent);
                intent.setComponent(new ComponentName(res.activityInfo.packageName, res.activityInfo.name));
                intent.setPackage(packageName);
                intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);
                cameraIntents.add(intent);
            }

            uploadMessage = uploadMsg; 
            Intent intent = new Intent(Intent.ACTION_GET_CONTENT);  
            intent.addCategory(Intent.CATEGORY_OPENABLE);  
            intent.setType("image/*"); 
            Intent chooserIntent = Intent.createChooser(intent,"Image Chooser");
            chooserIntent.putExtra(Intent.EXTRA_INITIAL_INTENTS, cameraIntents.toArray(new Parcelable[]{}));
            activity.startActivityForResult(chooserIntent,  FILECHOOSER_RESULTCODE); 
        } 
```

请指教。

谢谢乔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T14:14:51.927

我发现了问题，

我忘了在“onActivityResult”中添加结果等于“取消”的情况，即 0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:40:54.617

也可以在[这里查看类似的帖子](https://stackoverflow.com/questions/11724129/android-webview-file-upload/15136924#15136924)

不要忘记在对话框中处理 Cancel 并告诉 WebChrome 选择已完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-29T14:13:06.027

当 resultCode == 0（后退按钮）时，在回调中返回 null

```
mUploadMessage.onReceiveValue(null); 
```

# jquery - jQuery Slit Slider 问题

> ID：14175565
> 
> 赞同：0
> 
> 时间：2013-01-05T19:35:56.723
> 
> 标签：jquery, html, css

我正在使用[这个很棒](http://tympanus.net/codrops/2012/06/05/fullscreen-slit-slider-with-jquery-and-css3/comment-page-5/#comments)的教程来创建一个水平图像滑块，但是显然有些地方是错误的，因为滑块看起来坏了。Javascript 也不起作用。我只是 JS 的初学者，希望从中学到一些东西。

我正在使用一个名为 phpVMS 的 CMS，其中每个页面都用作可修改的模板。Layout.cpl 可以不言自明地显示所有页面的总体布局。我检查了没有任何 CSS 或 JS 文件覆盖 mypage.cpl 中的那些。

![在此处输入图像描述](../Images/2637c4f98075ac11bd5b49ff9e7e9474.png)

```
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script type="text/javascript" src="<?php echo SITE_URL?>/lib/skins/flyeuro/scripts/jquery.ba-cond.min.js"></script>
<script type="text/javascript" src="<?php echo SITE_URL?>/lib/skins/flyeuro/scripts/jquery.slitslider.js"></script>
<script type="text/javascript" src="<?php echo SITE_URL?>/lib/skins/flyeuro/scripts/modernizr.custom.79639.js" ></script>

<link rel="stylesheet" type="text/css" href="<?php echo SITE_URL?>/lib/skins/flyeuro/css/slider-style.css" />
<link rel="stylesheet" type="text/css" href="<?php echo SITE_URL?>/lib/skins/flyeuro/css/custom.css" /> 
```

Chrome 似乎指出这是唯一的错误......

```
Uncaught TypeError: Cannot call method 'prefixed' of undefined 
```

出现错误的行...

```
this.transEndEventName = this.transEndEventNames[ Modernizr.prefixed( 'transition' ) ]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:34:44.823

***只需尝试以下示例：***

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
        <title>Fullscreen Slit Slider with CSS3 and jQuery</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <meta name="description" content="Fullscreen Slit Slider with CSS3 and jQuery" />
        <meta name="keywords" content="slit slider, plugin, css3, transitions, jquery, fullscreen, autoplay" />
        <meta name="author" content="Codrops" />
        <link rel="shortcut icon" href="../favicon.ico"> 
        <link rel="stylesheet" type="text/css" href="css/demo.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" type="text/css" href="css/custom.css" />
        <script type="text/javascript" src="js/modernizr.custom.79639.js"></script>
        <noscript>
            <link rel="stylesheet" type="text/css" href="css/styleNoJS.css" />
        </noscript>
    </head>
    <body>

        <div class="container demo-2">

            <!-- Codrops top bar -->
            <div class="codrops-top clearfix">
                <a href="http://tympanus.net/Tutorials/CSS3BouncingBall/">
                    <strong>&laquo; Previous Demo: </strong>3D Bouncing Ball with CSS3
                </a>
                <span class="right">
                    <a href="http://www.flickr.com/photos/majownik/">Images by Majownik</a>
                    <a href="http://tympanus.net/codrops/?p=9357">
                        <strong>Back to the Codrops Article</strong>
                    </a>
                </span>
                <div class="clr"></div>
            </div><!--/ Codrops top bar -->

            <header class="clearfix">

                <h1>Slit Slider <span>with CSS3 and jQuery</span></h1>

                <nav class="codrops-demos">
                    <a href="index.html">Demo 1</a>
                    <a class="current-demo" href="index2.html">Demo 2</a>
                </nav>

            </header>

            <div id="slider" class="sl-slider-wrapper">

                <div class="sl-slider">

                    <div class="sl-slide" data-orientation="horizontal" data-slice1-rotation="-25" data-slice2-rotation="-25" data-slice1-scale="2" data-slice2-scale="2">
                        <div class="sl-slide-inner">
                            <div class="bg-img bg-img-1"></div>
                            <h2>A bene placito.</h2>
                            <blockquote><p>You have just dined, and however scrupulously the slaughterhouse is concealed in the graceful distance of miles, there is complicity.</p><cite>Ralph Waldo Emerson</cite></blockquote>
                        </div>
                    </div>

                    <div class="sl-slide" data-orientation="vertical" data-slice1-rotation="10" data-slice2-rotation="-15" data-slice1-scale="1.5" data-slice2-scale="1.5">
                        <div class="sl-slide-inner">
                            <div class="bg-img bg-img-2"></div>
                            <h2>Regula aurea.</h2>
                            <blockquote><p>Until he extends the circle of his compassion to all living things, man will not himself find peace.</p><cite>Albert Schweitzer</cite></blockquote>
                        </div>
                    </div>

                    <div class="sl-slide" data-orientation="horizontal" data-slice1-rotation="3" data-slice2-rotation="3" data-slice1-scale="2" data-slice2-scale="1">
                        <div class="sl-slide-inner">
                            <div class="bg-img bg-img-3"></div>
                            <h2>Dum spiro, spero.</h2>
                            <blockquote><p>Thousands of people who say they 'love' animals sit down once or twice a day to enjoy the flesh of creatures who have been utterly deprived of everything that could make their lives worth living and who endured the awful suffering and the terror of the abattoirs.</p><cite>Dame Jane Morris Goodall</cite></blockquote>
                        </div>
                    </div>

                    <div class="sl-slide" data-orientation="vertical" data-slice1-rotation="-5" data-slice2-rotation="25" data-slice1-scale="2" data-slice2-scale="1">
                        <div class="sl-slide-inner">
                            <div class="bg-img bg-img-4"></div>
                            <h2>Donna nobis pacem.</h2>
                            <blockquote><p>The human body has no more need for cows' milk than it does for dogs' milk, horses' milk, or giraffes' milk.</p><cite>Michael Klaper M.D.</cite></blockquote>
                        </div>
                    </div>

                    <div class="sl-slide" data-orientation="horizontal" data-slice1-rotation="-5" data-slice2-rotation="10" data-slice1-scale="2" data-slice2-scale="1">
                        <div class="sl-slide-inner">
                            <div class="bg-img bg-img-5"></div>
                            <h2>Acta Non Verba.</h2>
                            <blockquote><p>I think if you want to eat more meat you should kill it yourself and eat it raw so that you are not blinded by the hypocrisy of having it processed for you.</p><cite>Margi Clarke</cite></blockquote>
                        </div>
                    </div>
                </div><!-- /sl-slider -->

                <nav id="nav-dots" class="nav-dots">
                    <span class="nav-dot-current"></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </nav>

            </div><!-- /slider-wrapper -->

            <div class="content-wrapper">
                <h2>About this slider</h2>
                <p>The Slit Slider is a slideshow with a twist: the idea is to slice open the current slide when navigating to the next or previous one. Using jQuery and CSS animations we can create unique slide transitions for the content elements. </p>
            </div>

        </div>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.ba-cond.min.js"></script>
        <script type="text/javascript" src="js/jquery.slitslider.js"></script>
        <script type="text/javascript"> 
            $(function() {

                var Page = (function() {

                    var $nav = $( '#nav-dots > span' ),
                        slitslider = $( '#slider' ).slitslider( {
                            onBeforeChange : function( slide, pos ) {

                                $nav.removeClass( 'nav-dot-current' );
                                $nav.eq( pos ).addClass( 'nav-dot-current' );

                            }
                        } ),

                        init = function() {

                            initEvents();

                        },
                        initEvents = function() {

                            $nav.each( function( i ) {

                                $( this ).on( 'click', function( event ) {

                                    var $dot = $( this );

                                    if( !slitslider.isActive() ) {

                                        $nav.removeClass( 'nav-dot-current' );
                                        $dot.addClass( 'nav-dot-current' );

                                    }

                                    slitslider.jump( i + 1 );
                                    return false;

                                } );

                            } );

                        };

                        return { init : init };

                })();

                Page.init();

                /**
                 * Notes: 
                 * 
                 * example how to add items:
                 */

                /*

                var $items  = $('<div class="sl-slide sl-slide-color-2" data-orientation="horizontal" data-slice1-rotation="-5" data-slice2-rotation="10" data-slice1-scale="2" data-slice2-scale="1"><div class="sl-slide-inner bg-1"><div class="sl-deco" data-icon="t"></div><h2>some text</h2><blockquote><p>bla bla</p><cite>Margi Clarke</cite></blockquote></div></div>');

                // call the plugin's add method
                ss.add($items);

                */

            });
        </script>
    </body>
</html> 
```

另请参阅以下位置：[http ://tympanus.net/codrops/2012/06/05/fullscreen-slit-slider-with-jquery-and-css3/](http://tympanus.net/codrops/2012/06/05/fullscreen-slit-slider-with-jquery-and-css3/)

我认为这可以帮助您解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T15:25:00.887

只需在 jquery.slitslider.js 之前加载modernizr.custom.79639.js：

```
<script type="text/javascript" src="<?php echo SITE_URL?>/lib/skins/flyeuro/scripts/modernizr.custom.79639.js" ></script>
<script type="text/javascript" src="<?php echo SITE_URL?>/lib/skins/flyeuro/scripts/jquery.slitslider.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T14:40:14.160

我有一个类似的问题，原来 jquery 库坏了。还要确保在 javascript 之前包含 css。

# wordpress - 1and1 上的 Google Apps SMTP 问题

> ID：14175567
> 
> 赞同：1
> 
> 时间：2013-01-05T19:36:01.320
> 
> 标签：wordpress, smtp, gmail, contact-form-7

我在这里束手无策。我正在尝试设置 SMTP 设置以在 Wordpress 插件联系表 7 中使用。我的电子邮件服务器是通过 Google Apps 设置的，我的网站托管在 1and1 上。我正在使用 WP 插件配置 SMTP 来设置它。在我尝试发送测试电子邮件后，我收到以下错误：

```
SMTP Error: Could not connect to SMTP host. 
```

我的 SMTP 设置是：

```
SMTP host: smtp.gmail.com
SMTP port: 465
Secure connection: SSL
Auth: yes
SMTP username: my-username@my-domain.com
SMTP password: password
Sender email: my-username@my-domain.com 
```

我还尝试了 TLS 上的 587 端口和 25 端口。我已经调用了 1and1 两次，两次他们都说他们不阻止端口并且无法帮助我，因为我的电子邮件指向了 Gmail。我尝试过其他 WP 插件来设置 SMTP 设置。我已经仔细检查了 Google 在我的 1and1 DNS 中提供给我的 MX 记录是否正确。我不知道我还能做什么，我已经读到其他人在这个设置和其他人身上有类似的问题，但我还没有找到任何可以解决我的问题的东西。许多人说是网络主机阻止了端口，但 1and1 两次我都说他们没有阻止端口，这是一个 Gmail 问题。我不知道还能尝试什么。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-17T17:16:45.233

他们不诚实，他们确实阻止了 SMTP 端口 465 和 587 如果您在 1and1 上托管了域并配置了一个电子邮件地址，他们可能会说他们确实阻止了.. 我有 wordpress 网站试图使用 Contact for 7 和 POSTMAN SMTP 插件 Postman has diag例程，它清楚地表明 1and1 正在阻止唯一打开的邮件端口是 443。

# python - 基于 django 类的视图多对多字段显示选定值

> ID：14175568
> 
> 赞同：2
> 
> 时间：2013-01-05T19:36:03.193
> 
> 标签：python, django, django-models, django-views, django-class-based-views

我有一个使用基于更新视图类的视图创建的表单。它显示数据库中输入类型字段中的每个值，除了多对多字段的值。
我应该在视图或模型中插入什么，以便用户可以看到他们选择了哪些选项（例如在内置管理模块中）。

这是我的看法：

```
class StudentUpdateView(LoginRequiredMixin, UpdateView):

form_class = StudentForm
model = Student
template_name = 'forms/modify.html'

def get_context_data(self, **kwargs):
    context = super(StudentUpdateView, self).get_context_data(**kwargs)
    context['year'] = Setting.objects.get(id=2)
    return context

def form_valid(self, form):
    if self.request.is_ajax():
        self.object = form.save()
        return HttpResponse(json.dumps("success"),
            mimetype="application/json")
    return super(StudentUpdateView, self).form_valid(form)

def form_invalid(self, form):
    if self.request.is_ajax():
        return HttpResponseBadRequest(json.dumps(form.errors),
            mimetype="application/json")
    return super(StudentUpdateView, self).form_invalid(form) 
```

**编辑：**

这是我使用的模型，因为 Model Form 和 StudentForm 不存在

```
class Student (models.Model):
name = models.CharField(u'Imię', max_length=40)
surname = models.CharField(max_length=80)
email = models.EmailField(blank=True)
subjects = models.ManyToManyField(Subjects, blank=True)
programs = models.ManyToManyField(Programs, editable=False)
history = models.CharField(max_length=50, editable=False)
added = models.DateTimeField(auto_now=True)

def __unicode__(self):
    return u'%s %s'(self.name, self.surname)

class StudentForm(ModelForm):
    class Meta:
        model = Student 
```

# mysql - 加入表格之间的投票并获得百分比

> ID：14175581
> 
> 赞同：1
> 
> 时间：2013-01-05T19:37:04.623
> 
> 标签：mysql, join

我已经在这个工作了一个小时。我尝试了几种不同的连接和子查询，但都没有运气。这是情况。

两张桌子。一个带有主索引，一个是用户投票列表。我想确定一个特定用户为另一个用户留下了多少票（容易）......然后找出总票数的百分比并按此排序（困难）。

表 1 有列：post_id、poster_id 表 2 有列：post_id、voter_id、vote

post_id 在两个表之间是相关的。像这样的简单查询将为您提供一个输出，显示 1 个用户离开另一个用户的总票数......然后排序显示谁给另一个用户留下的票数最多。

```
SELECT poster_id, voter_id, count(*) AS votes
FROM table_1, table_2
WHERE table_1.post_id = table_2.post_id
GROUP BY poster_id, voter_id
ORDER BY votes DESC 
```

效果很好......但我想看看谁留下的选票占用户总选票的百分比最多。所以我还需要获得“poster_id”的总票数，然后将当前数字除以百分比......然后按该百分比排序。输出应该是这样的：

```
poster_id | voter_id | votes | vote_total | percent
----------------------------------------------------
   1      |    3     |   10  |     10     |   100%
   3      |    1     |   15  |     25     |    60%     
   2      |    1     |   3   |      6     |    50%
   2      |    3     |   2   |      6     |    33%
   3      |    2     |   5   |     25     |    20%
   2      |    4     |   1   |      6     |    17% 
```

等等

基本上，选民#3 负责 100% 的海报#1 的选票。海报#3 60% 的选票来自选民#1……等等。

我们试图找出是否有特定用户给予某人比其他用户更多的选票（以百分比计），以试图找出潜在的滥用行为。

我认为 RIGHT JOIN 会起作用，但它不起作用。

```
SELECT t1.poster_id, t1.voter_id, count(*) AS votes, count(t3.*) AS votes_total, votes / votes_total AS percentage
FROM (table_1 t1, table_2 t2)
RIGHT JOIN (table_1 t3, table_2 t4)
    ON (t3.post_id = t4.post_id AND t3.poster_id = t1.poster_id)
WHERE t1.post_id = t2.post_id
GROUP BY t1.poster_id, t2.voter_id
ORDER BY percentage DESC 
```

基本上永远运行并且不返回任何东西。我从内存中输入了该查询，并不能完全代表真实的表名。任何朝着正确方向的点都会有所帮助。可能是内联？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:47:17.070

试试这个：

```
SELECT
    poster_id,
    voter_id,
    count(*) AS votes,
    count(*) * 100 / total.total_votes as percentage
FROM table_1
join (
    select poster_id, count(*) AS total_votes
    FROM table_1
    join table_2 on table_1.post_id = table_2.post_id
    GROUP BY poster_id
) total on total.poster_id = table_1.poster_id
join table_2 on table_1.post_id = table_2.post_id
GROUP BY poster_id, voter_id
ORDER BY votes DESC 
```

这使用一个子查询来返回每个poster_id 的总票数，然后加入它，就好像它是一个表一样。

还要注意使用正确连接而不是通过 where 子句连接的变化。

# perl - perl 中的匿名哈希是什么？

> ID：14175585
> 
> 赞同：18
> 
> 时间：2013-01-05T19:37:20.077
> 
> 标签：perl, data-structures, perl-data-structures, hash

```
$hash = { 'Man' => 'Bill',
          'Woman' => 'Mary,
          'Dog' => 'Ben'
        }; 
```

Perl 的“匿名哈希”究竟做了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-05T19:38:39.163

它是对可以存储在标量变量中的哈希的引用。它与常规散列完全一样，不同之处在于大括号`{...}`创建了对散列的*引用*。

请注意这些示例中不同括号的用法：

```
%hash = ( foo => "bar" );   # regular hash
$hash = { foo => "bar" };   # reference to anonymous (unnamed) hash
$href = \%hash;             # reference to named hash %hash 
```

这很有用，例如，如果您想将哈希作为参数传递给子例程：

```
foo(\%hash, $arg1, $arg2);

sub foo {
    my ($hash, @args) = @_;
    ...
} 
```

这是一种创建多级哈希的方法：

```
my %hash = ( foo => { bar => "baz" } );  # $hash{foo}{bar} is now "baz" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-06T18:45:03.960

当您需要引用散列并且命名散列不方便或不必要时，您可以使用匿名散列。例如，如果您想将哈希传递给子程序，您可以编写

```
my %hash = (a => 1, b => 2);
mysub(\%hash); 
```

但是如果不需要通过其名称访问哈希，`%hash`您可以等效地编写

```
mysub( {a => 1, b => 2} ); 
```

这在您需要对哈希的引用时派上用场，尤其是在您构建嵌套数据结构时。代替

```
my %person1 = ( age => 34, position => 'captain' );
my %person2 = ( age => 28, position => 'boatswain' );
my %person3 = ( age => 18, position => 'cabin boy' );

my %crew = (
  bill => \%person1,
  ben  => \%person2,
  weed => \%person3,
); 
```

你可以只写

```
my %crew = (
  bill => { age => 34, position => 'captain' },
  ben  => { age => 28, position => 'boatswain' },
  weed => { age => 18, position => 'cabin boy' },
); 
```

并添加成员，

```
$crew{jess} = { age => 4, position => "ship's cat" }; 
```

比整洁得多

```
my %newperson = ( age => 4, position => "ship's cat" );
$crew{jess} = \%newperson; 
```

当然，即使使用名称创建散列，如果将其引用传递到其他地方，则可能无法使用该原始名称，因此必须将其视为匿名。例如在

```
my $crew_member = $crew{bill} 
```

`$crew_member`现在实际上是对匿名哈希的引用，无论数据最初是如何构造的。即使数据（在某些范围内）仍然可以访问，因为`%person1`没有一般的方法知道这一点，并且只能通过其引用访问数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-06T06:26:14.490

这很简单。他们允许你写

```
push @hashes, { ... };

f(config => { ... }); 
```

代替

```
my %hash = ( ... );
push @hashes, \%hash;

my %config = ( ... );
f(config => \%config); 
```

（如果你想知道引用的目的，那就完全是另一回事了。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-08-28T12:06:30.470

任何“匿名”都是以没有名称的方式使用的数据结构。

您的问题使此页面上的其他人感到困惑，因为您的示例显示您为创建的哈希命名，因此它不再是匿名的。

例如 - 如果你有一个子程序并且你想返回一个哈希，你可以编写这个代码： -

```
return {'hello'=>123}; 
```

因为它在那里没有名字——它是匿名的。继续阅读以消除其他人通过引入参考文献在此页面上添加的额外混乱，这不是一回事。

这是另一个匿名哈希（一个空的）：

```
{} 
```

这是一个匿名哈希，里面有一些东西：

```
{'foo'=>123} 
```

这是一个匿名（空）数组：

```
[] 
```

这是一个匿名数组，里面有一些东西：

```
['foo',123] 
```

大多数时候，当人们使用这些东西时，他们实际上是在尝试将它们神奇地放入其他数据结构中，而不会在这样做时给它们一个浪费时间的临时名称。

例如 - 您可能希望在数组中间有一个散列！

```
@array=(1,2,{foo=>3}); 
```

该数组有 3 个元素 - 最后一个元素是散列！($array[2]->{foo} 是 3)

```
perl -e '@array=(1,2,{foo=>1});use Data::Dumper;print Data::Dumper->Dump([\@array],["\@array"]);'
$@array = [
            1,
            2,
            {
              'foo' => 1
            }
          ]; 
```

有时您不想传递整个数据结构，而是只想使用*指针*或对数据结构的引用。在 perl 中，您可以通过在变量前面添加“\”来做到这一点；

```
%hashcopy=%myhash;     # this duplicates the hash
$myhash{test}=2;       # does not affect %hashcopy
$hashpointer=\%myhash; # this gives us a different way to access the same hash
$hashpointer->{test}=2;# changes %myhash
$$hashpointer{test}=2; # identical to above (notice double $$) 
```

如果你疯了，你甚至可以引用匿名哈希：

```
perl -e 'print [],\[],{},\{}'
ARRAY(0x10eed48)REF(0x110b7a8)HASH(0x10eee38)REF(0x110b808) 
```

有时 perl 足够聪明，可以知道您的真正*意思是*参考，即使您没有特别说明，例如我的第一个“返回”示例：

```
perl -e 'sub tst{ return {foo=>bar}; }; $var=&tst();use Data::Dumper;print Data::Dumper->Dump([\$var],["\$var"]);'     
$var = \{
       'foo' => 'bar'
     }; 
```

或者：-

```
perl -e 'sub tst{ return {foo=>bar}; }; $var=&tst(); print "$$var{foo}\n$var->{foo}\n"'
bar
bar 
```

# asp.net - 使用 html 拒绝基于 Ajax JSON 的帖子

> ID：14175587
> 
> 赞同：5
> 
> 时间：2013-01-05T19:37:34.337
> 
> 标签：asp.net, asp.net-mvc

当使用 JQuery 的 $.Ajax(..) 将包含标记的 JSON 对象发布到 MVC 操作方法时，我惊讶地发现内容没有被 ASP.Net 的请求验证拒绝。

请求验证不适用于 JSON 帖子是否有原因？

使用以下定义，服务器不会拒绝标记...

```
$.ajax({
        url: '/Controller/Action',
        data: JSON.stringify({data:data}),
        type: "POST",
        dataType: "json",
        contentType: "application/json",
      }); 
```

似乎它与 JSON 类型的帖子相关联

我正在使用 .Net 4.0 MVC 3.0

我正在创建将评论保存到数据库的功能。似乎是一个安全问题，标记/脚本可以使它通过请求验证......

我正在发布一个具有各种属性的 JSON 对象（例如commentText）由于某种原因，如果它包含诸如此类的标记，它不会拒绝我的`<div></div>`帖子

在这里找到一篇似乎可以解释这种行为的文章：

[http://weblogs.asp.net/imranbaloch/archive/2011/05/23/security-issue-in-asp-net-mvc3-jsonvalueproviderfactory.aspx](http://weblogs.asp.net/imranbaloch/archive/2011/05/23/security-issue-in-asp-net-mvc3-jsonvalueproviderfactory.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T13:26:30.410

这里似乎有一个线索 [http://weblogs.asp.net/imranbaloch/archive/2011/05/23/security-issue-in-asp-net-mvc3-jsonvalueproviderfactory.aspx](http://weblogs.asp.net/imranbaloch/archive/2011/05/23/security-issue-in-asp-net-mvc3-jsonvalueproviderfactory.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T00:18:45.773

I don't know how exactly the data you pass to the server looks like, but right now I assume that it is just a plain string value 'xyz'. In this case the server gets the following POST data:

> {"data":"test"}

This is perfectly ok and does not represent a potential thread identified by ASP.NET.

PS: If you are using other values as data the whole story might be different...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:33:59.857

我想你在谈论请求验证？它在 MVC 中启用，因此您的 JSON 字符串不能被 asp.net 视为威胁 - 我不记得它是否会默认拒绝包含标记的 json 字符串，但我怀疑不会。

有关它的更多信息：[http ://weblogs.asp.net/imranbaloch/archive/2011/02/19/understanding-request-validation-in-asp-net-mvc-3.aspx](http://weblogs.asp.net/imranbaloch/archive/2011/02/19/understanding-request-validation-in-asp-net-mvc-3.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T17:54:47.873

请求验证使用数据注释在模型中工作。您可以在模型中启用和禁用 HTML 化妆输入。您可以在模型中使用 [AllowHtml] 来执行此操作。之后，如果用户在任何普通字段中输入 HTML，那么您可以使用 Model.IsValid 属性检查错误。

# macos - Mac 替代 fiddler 的自动回复功能

> ID：14175589
> 
> 赞同：4
> 
> 时间：2013-01-05T19:37:49.533
> 
> 标签：macos, http, mocking, fiddler, charles-proxy

Fiddler 让我拦截 http 请求并使用来自本地计算机的文件进行响应。我正在寻找一种在 mac 上可以做到这一点的工具。

我测试了查尔斯，但它的“重写工具”不允许这样做。我还尝试了只允许查看请求的 httpscoop，以及我什至找不到 gui 的wireshark（可能是由于我在 mac 上的菜鸟）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T15:42:42.367

据我了解，Charles 的**地图**功能提供了您正在寻找的内容。

如果您的 Mac 上有 Windows PC 或 VM，则可以使用 Fiddler 来[捕获 Mac 的流量](http://www.fiddler2.com/fiddler/help/hookup.asp#mac)。另外值得注意的是，我现在在 Telerik，我们的目标之一是使用 Fiddler 支持更多平台。Mono 框架的 Fiddler 的 alpha 版本现已推出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T09:58:16.637

你可以尝试一个免费的 chrome 扩展：[Trumpet](https://chrome.google.com/webstore/detail/trumpet/cflekmkldaldnelemkkldoaedapbkmog)

特征：

通配符模式

正则表达式模式

类别

文件拖动

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-07T22:57:26.673

试试[Tamper](http://dutzi.github.io/tamper/)，它基于[mitmproxy](http://www.mitmproxy.org)，它允许您查看当前选项卡发出的所有请求，修改它们并在下次刷新时提供修改后的版本。

# sql - 如何在设计期间更改 SQL 表默认数据类型

> ID：14175590
> 
> 赞同：6
> 
> 时间：2013-01-05T19:37:50.750
> 
> 标签：sql, sql-server

在 SQL Server Management Studio 表设计器中设计表时，我想更改默认数据类型。我当前的默认值是 nchar(10)，我正在创建一个包含很多整数数据类型的表。我查看了工具选项，但找不到任何地方可以更改它。我正在运行 SQL Server 2008 R2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T07:09:36.330

这是可能的，但需要修改注册表。每次您希望更改默认值时，都需要进行这种令人厌烦的更改，因此我同意 NYCdotNet。

```
HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\100\Tools\Shell\DataProject 
```

![regpath 截图](../Images/eea7bf15cf92b8b6a1240174d1265975.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T19:47:23.210

听起来您已经准备好使用 T-SQL 而不是设计器来创建表。以下代码的变体将涵盖您将基本模式组合在一起，如果您想做更多的事情，您可以随时在设计器中修改表格。

```
CREATE TABLE MyTableName (
  MyID INT NOT NULL IDENTITY(1,1),
  MyColumn1 INT NOT NULL,
  MyColumn2 INT NULL,
  MyColumn3 VARCHAR(100) NULL,
  PRIMARY KEY (MyID)
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-27T22:48:01.363

**更新：我很抱歉，读你的问题太快了。此解决方案适用于 VS2015 中的可视化设计器，而不适用于 SQLSMS。无论如何我都会留下答案。**

这已在 Visual Studio 2015 中更改。现在位于：

> 选项 > 数据库工具 > 表和数据库设计器 > 列选项

[![在此处输入图像描述](../Images/784a4e4dbc76ace1feccc0fb6261a57b.png)](https://i.stack.imgur.com/jTBp7.png)

# asana - Asana API 路线图 - 完成任务（包括存档）

> ID：14175591
> 
> 赞同：3
> 
> 时间：2013-01-05T19:37:54.930
> 
> 标签：asana

您是否计划增加从项目中检索（通过 API）所有任务的可能性，包括那些已归档的任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-24T01:37:30.897

在 API 正式支持之前，您始终可以查询`/tasks?completed_since=now`以仅获取不完整的任务，然后查询`/tasks`和过滤仅出现在第二个列表中的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:42:38.703

（我在 Asana 工作）

这将是一个有用的功能，我们已经计划添加它。但是，我无法评论何时可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-01T00:53:42.483

归档任务可以通过在按项目查询任务的请求中包含参数 ?include_archived=true 来访问。

[Asana 文档中的任务部分](https://asana.com/developers/api-reference/tasks)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T15:22:04.710

我也在尝试做同样的事情。我们正在使用一个项目来跟踪我们制造车间的生产线事件。我发现这篇文章很有帮助，您可以将“?include_archived=true”附加到您的查询中，但我发现您还可以通过任务标签对任务进行反向查找。这也将显示已完成的任务。

# intellij-idea - XMLHttpRequest 在 Dart 中使用 IntelliJ 的跨源请求

> ID：14175592
> 
> 赞同：1
> 
> 时间：2013-01-05T19:38:05.420
> 
> 标签：intellij-idea, dart, dartium

我正在使用 dart 的 html 库的 HttpRequest 类相对加载一个 json 文件。在 Dart 编辑器中它工作正常。使用我收到的带有 JetBrains chrome 扩展的 intelliJ 的 dart 插件...

```
XMLHttpRequest cannot load file:///C:/project/web/path/to/my/file.json. Cross origin requests are only supported for HTTP.  :0
Exception: Error: NETWORK_ERR: XMLHttpRequest Exception 101
Stack Trace: #0      HttpRequest.send (file:///E:/b/build/slave/dartium-win-full-trunk/build/src/build/Release/obj/global_intermediate/webkit/bindings/dart/dart/html/HttpRequest.dart:33:3) 
```

我正在传递一个相对 url，当检查我看到它的 URL 时：“path/to/my/file.json”

这是裸骨测试。

```
import 'dart:html';

main(){
  Loader loader = new Loader();
  loader.load("someFile.json");
}

class Loader {
  load(String url) {
    var request = new HttpRequest();
    request.open('GET', url, true);
    request.send();
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T01:23:00.037

我不确定为什么它在一种情况下而不是另一种情况下工作，但`GET`如果你不使用`http`. 有关为什么会这样的详细信息，请参阅这些。我从未使用过 IntelliJ，因此很遗憾，我无法谈论该上下文的具体细节。

```
http://stackoverflow.com/questions/8449716/cross-origin-requests-are-only-supported-for-http-but-its-not-cross-domain
http://stackoverflow.com/questions/3102819/chrome-disable-same-origin-policy
http://stackoverflow.com/questions/10752055/cross-origin-requests-are-only-supported-for-http-error-but-im-loading-a-co 
```

# javascript - Javascript 和正则表达式，多重匹配

> ID：14175595
> 
> 赞同：0
> 
> 时间：2013-01-05T19:38:20.057
> 
> 标签：javascript, jquery, css, regex

我有一个简单的问题要问你（对你来说，我个人花了几个小时来解决这个问题）。我在 Javascript/Jquery 中创建了一个 Web 应用程序来验证 CSS 样式表。

我需要使用正则表达式从选择器中提取多个 CSS 类名。我做了类似的事情：

```
var selector = this.value;
var userNewClass = selector.match(/[.]([A-Za-z_-]*)/);
alert(userNewClass.toString()); 
```

它几乎可以工作了，但我的代码有两个问题（你这里有一个正则表达式菜鸟）。如果我写类似：

```
.test:hover 
```

它还给我

```
.test, test 
```

相同的类名，但带点，另一个不带点。如果我编写一个具有多个类名的选择器：

```
.test, .hello 
```

我得到了相同的结果......无论如何修改我的正则表达式（或我的代码？）以获得所有带有点（。）的类名称，考虑到用户可以在同一个类中拥有无限数量的类选择器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:42:58.483

`.test`是完整匹配，`test`是捕获的组（括号中的任何内容`()`）。您还需要`g`在关闭后的末尾添加 a`/`以匹配每个实例，而不仅仅是第一个。

也就是说，您可能不需要正则表达式，并且`split`在字符串上使用可能会更好。

```
'.test, .hello'.split(', ') // returns an array ['.test', '.hello'] 
```

如果你绝对必须使用正则表达式，试试这个：

```
/\.(\w+)/g 
```

`\w+`这将匹配（并捕获）紧随文字的一个或多个字母和/或数字的任何和所有序列`.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:55:20.743

您将不得不使用 RegExp.exec 方法：

```
var input = ".test1.test2 .test3, .test4";

var re = /\.[\w\-]+/ig, match, matches = [];

while (match = re.exec(input)) {
  matches.push(match[0]);
}

alert(matches); 
```

使用 split 将不起作用，因为您将不得不解析出伪类和所有其他可能的 CSS 语法元素。

# javascript - 包含 JavaScript 的 JQuery.load() 页面

> ID：14175596
> 
> 赞同：0
> 
> 时间：2013-01-05T19:38:36.303
> 
> 标签：javascript, jquery, html

我有一个 html 页面，其中包含一些用于从 Google API 生成图表的 javascript。当我直接访问该页面时，它按预期工作，显示图表。

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load('visualization', '1.0', { 'packages': ['corechart'] });
google.setOnLoadCallback(drawChart);
function drawChart() {
   //// code to generate chart
   var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
   chart.draw(data, options);
}
</script>
<div id="chart_div">
   Chart Div
</div> 
```

我想将此图表加载到另一个页面上。我尝试使用 JQuery 的 $.get 和 $.load，但都没有工作。如果我在页面中添加一些文本并调用 get/load 我可以看到文本但看不到图表 - 似乎 Javascript 没有执行。

我添加`alert('msg')`并看到`google.load`被调用，但没有调用其他 JS。

从我想要包含图表的其他页面中，我有以下 JS：

```
$(document).ready(function () {
    $('#test').load('chart?param=1', function () {
        alert('Load was performed.');
    });
}); 
```

但“负载已执行”永远不会受到打击。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:23:07.890

“SCRIPT5009：‘谷歌’未定义”

我怀疑`<script type="text/javascript" src="https://www.google.com/jsapi"></script>`当你 .load() 那个代码块时这不起作用。由于 jQuery 已经在运行，试试这个

```
<!-- get rid of this <script type="text/javascript" src="https://www.google.com/jsapi" -->
<script type="text/javascript">
// does not need $(function()) unless you're running this on its own
// when loading this in using $.load() it's already ready.

$.getScript('https://www.google.com/jsapi', function(){
    google.load('visualization', '1.0', { 'packages': ['corechart'] });
    google.setOnLoadCallback(drawChart);
});
function drawChart() {
   //// code to generate chart
   var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
   chart.draw(data, options);
}
</script> 
```

# c# - 绑定 DataSource 时如何防止 listBox_SelectedIndexChanged 事件？

> ID：14175599
> 
> 赞同：0
> 
> 时间：2013-01-05T19:38:39.253
> 
> 标签：c#, winforms, listbox

我有 ListBox 控件（WinForm 项目）。

当我将 DataSource 绑定到 ListBox 控件时，会触发 listBox_SelectedIndexChanged 事件。

这是代码：

公共 Form1() { InitializeComponent();

```
 string conn ="consntring";

        SqlDataAdapter adapter = new SqlDataAdapter("SELECT * FROM Colors", conn);

        DSColors dataSetcColors = new DSColors();

        adapter.Fill(dataSetcColors.Colors); 

        listBox1.DisplayMember = "ColorName";
        listBox1.ValueMember = "ColorID";
        listBox1.DataSource = dataSetcColors.Colors;
    }

    private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
    {

    }
} 
```

知道如何在绑定 DataSource 时防止 listBox_SelectedIndexChanged 事件吗？

# php - 确定有多少文本适合固定 div

> ID：14175603
> 
> 赞同：3
> 
> 时间：2013-01-05T19:39:01.737
> 
> 标签：php, javascript, html

> **可能重复：**
> [使用 Javascript 计算文本宽度](https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript)

好吧，这就是我想看看是否可以完成的事情。我想获取用户提交的文本（所以..可变长度）并将其放入固定宽度/高度的 div 中。如果文本将超出分配的空间，我想尽可能多地显示并在末尾放置一个省略号 (...)，尽可能靠近边界。

所以我想知道......是否有可能告诉某个文本块将占用多少空间（javascript）？我不想使用等距字体，即使我这样做了，我也不知道它是否会有很大帮助。

我开始怀疑是否根本没有太多变量需要考虑，并且我最终需要做一些不太精确的事情，例如输出固定的最大字符数。但我想看看以前是否有人完成过类似的事情，或者普遍的共识是“不可能/不值得努力”。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:53:27.620

[工作小提琴](http://jsfiddle.net/780rt6m0/)

```
function width(tex) {
    var text = tex;
    var div = document.createElement("div");
    div.style.position="absolute";
    div.style.top="-999px";
    div.style.left="-999px";
    div.id = "width";
    div.innerHTML=tex;
    document.body.appendChild(div);
    var el = document.getElementById("width");
    var w = el.offsetWidth;
    el.parentNode.removeChild(el);
    return w;
}
var s = parseInt(width("s"), 10);
alert(s); 
```

以上将返回文本的宽度！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T19:44:38.790

快速搜索[在这里](https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript)为您揭示了这个可能的解决方案。

这可能不是您正在寻找的。当我发现更多时，我会继续挖掘和更新。

# java - 需要改变现有c函数的原型

> ID：14175604
> 
> 赞同：-2
> 
> 时间：2013-01-05T19:39:03.637
> 
> 标签：java, c, java-native-interface

我需要通过 JNI 从我的 Java 代码中调用现有的 C 函数。正如 JNI 所建议的那样，我使用 Javah 工具为本机 C 函数创建了一个头文件，然后将其包含在 C 文件中。

我是否需要更改现有 C 函数的函数原型（在头文件中生成）？

如果我的示例代码有任何错误，请纠正我

示例代码：

```
 #include <stdio.h>
         #include <jni.h>
         #include "myHeader.h"
         int main(){
int result=Nativecall();
return 0;
 }
int NativeCall(){  //Native Method implementation
int sample=10;
return sample;
 }
  _______________
   myHeader.h

   JNIEXPORT jint JNICALL Java_test__NativeCall
     (JNIEnv *, jobject); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:48:16.863

不，您不必做任何事情，javah 为您完成工作，只需将头文件包含在您的 C 文件中并实现头文件中定义的功能。所以根据你的情况应该是这样的，你可以看到我们使用的原型和javah在头文件中定义的一样

```
JNIEXPORT jint JNICALL
    Java_test__NativeCall
                    (JNIEnv *env, 
                    jobject callingObject)
    {
    int sample=10;
    return (jint)sample;
    } 
```

# c# - 按组对类函数进行分类

> ID：14175605
> 
> 赞同：2
> 
> 时间：2013-01-05T19:39:06.760
> 
> 标签：c#

想象一个如下的类..这是提供给我的一个类..我无法更改它的来源..

```
public class MyClass
{
    object _Object { get; set; }

    public void FuncA1() { _Object = new object(); }
    public void FuncA2() { _Object = new List<object>(); }

    public int FuncB1() { _Object = 0; return 0; }
    public int FuncB2() { _Object = 123; return 123; }

    public string FuncC1() { _Object = null; return null; }
    public string FuncC2() { _Object = "Hello"; return "Hello"; }
} 
```

我试图为这个类创建一个包装器，这样我就可以将它的许多功能分组到类别中。

```
MyWrapper.Voids.FuncA1();
MyWrapper.Voids.FuncA2();
MyWrapper.Integers.FuncB1();
MyWrapper.Integers.FuncB2();
MyWrapper.Strings.FuncC1();
MyWrapper.Strings.FuncC2(); 
```

对于这种情况，我能想到的唯一解决方案是像这样设计包装器：

```
public class MyWrapper
{
    MyClass _Instance { get; set; }
    public _Void Voids { get; private set; }
    public _Integer Integers { get; private set; }
    public _String Strings { get; private set; }

    public class _Void
    {
        MyWrapper _Parent { get; set; }

        public void FuncA1() { _Parent._Instance.FuncA1(); }
        public int FuncA2() { return _Parent._Instance.FuncA2(); }
    }
    public class _Integer
    {
        ...
    }
    public class _String
    {
        ...
    }

    public MyWrapper()
    {
        _Instance = new MyClass();
        Voids = new _Voids(this);
        Integers = new _Integer(this);
        Strings = new _String(this);
    }
} 
```

该解决方案有效，但存在许多问题： - 内部类被迫公开，这允许用户实例化它们.. - 我被迫在子类中维护父对象的引用..

有没有更好的方法来做到这一点？

编辑：最初发布的代码有点令人困惑，因为它把注意力从核心问题上转移到了一个函数是否会导致异常的问题上，如果它们都在同一个对象上工作..

注意：这不是实际代码..我将这个示例拼凑在一起以展示我正在尝试做的事情..在对象周围创建一个包装器（我无法更改原始对象的代码）并将函数分组为类别..

最终编辑：遵循 Juharr 的建议..这是我为完成我想要的事情所做的事情..为了改善他人..

```
public interface IVoid
{
    void FuncA1();
    void FuncA2();
}
public interface IInteger
{
    int FuncB1();
    int FuncB2();
}
public class MyWrapper
{
    public MyClass Instance { get; private set; }
    public IVoid Voids { get; private set; }
    public IInteger Integers { get; private set; }

    private abstract class MyBase
    {
        protected MyWrapper Parent { get; set; }
        protected MyClass Instance { get { return Parent.Instance; } }
        public MyBase(MyWrapper oParent) { Parent = oParent; }
    }
    private class MyVoid : MyBase, IVoid
    {
        public MyVoids (MyWrapper oParent) : base(oParent) { }
        public void FuncA1() { Instance.FuncA1(); }
        public void FuncA2() { Instance.FuncA2(); }
    }
    private class MyInteger : MyBase, IInteger
    {
        public MyInteger (MyWrapper oParent) : base(oParent) { }
        public int FuncB1() { return Instance.FuncB1(); }
        public int FuncB2() { return Instance.FuncB2(); }
    }

    public MyWrapper()
    {
        Instance = new MyClass();
        Voids = new MyVoid(this);
        Integers = new MyInteger(this);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:07:01.337

您可以改为编写公共接口。那么你的内部类不必公开。所以像这样。

```
public interface IIntger
{
    void Set(int iValue);
    int Get();
}

public class MyWrapper
{
    MyClass _Instance { get; set; }
    public IInteger Integer { get; private set; }

    private class _Integer : IInteger
    {
        MyWrapper _Parent { get; set; }

        public void Set(int iValue) { _Parent._Instance.IntegerSet(iValue); }
        public int Get() { return _Parent._Instance.IntegerGet(); }
    }

    public MyWrapper()
    {
        _Instance = new MyClass();
        Integer = new _Integer(this);
    }
} 
```

编辑：

要回答问题的第二部分，您将需要对父类的引用或对要包装的类的引用。所以你可以有这个。

```
public class MyWrapper
{
    public IInteger Integer { get; private set; }

    private class _Integer : IInteger
    {
        MyClass _Instance { get; set; }
        public _Integer(MyClass myClass) { _Instance = myClass; }
        public void Set(int iValue) { _Instance.IntegerSet(iValue); }
        public int Get() { return _Instance.IntegerGet(); }
    }

    public MyWrapper(MyClass instance)
    {
        Integer = new _Integer(instance);
    }
} 
```

# c++ - std::vector push_back(Object()) 和 push_back(new Object()) 的区别？

> ID：14175607
> 
> 赞同：10
> 
> 时间：2013-01-05T19:39:21.447
> 
> 标签：c++, vector, insert, std

在我当前的代码中，我想将新的 DrawObjects 插入到我创建的向量中，

std::vector<DrawObject> 对象；

有什么区别：

```
objects.push_back(DrawObject(name, surfaceFile, xPos, yPos, willMoveVar, animationNumber)); 
```

和

```
objects.push_back(new DrawObject(name, surfaceFile, xPos, yPos, willMoveVar, animationNumber)); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-05T19:42:00.163

第一个添加**非指针**对象，而第二个添加**指向**向量的指针。所以这一切都取决于你应该做哪个向量的声明。

在您的情况下，由于您已声明`objects`为`std::vector<DrawObject>`，所以第一个将起作用，因为`objects`可以存储类型的项目`DrawObject`，而不是`DrawObject*`。

在 C++11 中，您可以`emplace_back`用作：

```
objects.emplace_back(name, surfaceFile, xPos, yPos, 
                     willMoveVar, animationNumber); 
```

注意区别。将其与：

```
objects.push_back(DrawObject(name, surfaceFile, xPos, yPos, 
                            willMoveVar, animationNumber)); 
```

使用`emplace_back`，您不会在调用点构造对象，而是将参数传递给向量，然后向量在内部就地构造对象。在某些情况下，这可能会更快。

阅读有关[emplace_back](http://en.cppreference.com/w/cpp/container/vector/emplace_back)的文档（强调我的），

> 将新元素附加到容器的末尾。该元素是就地构造的，即**不执行复制或移动操作**。*使用提供给函数的完全相同的参数*调用元素的构造函数。

由于它避免了*copy*或*move*，因此生成的代码可能会更快一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:41:07.753

给定

```
std::vector< DrawObject > objects; 
```

两个版本的区别在于第一个是正确的，而第二个是错误的。

如果第二个版本编译，正如您在评论中指出的那样，它不会按照您的预期进行。它还建议您可能应该考虑制作一些`DrawObject`'s 构造函数`explicit`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:41:26.163

第二个版本期望`objects`是一个指向 DrawObject 的**指针**向量，而第一个版本期望`objects`持有对象本身。因此，根据`objects`只有一个版本的声明将编译。

如果你声明你`objects`的方式，只有第一个版本会编译，如果你声明对象`std::vector< DrawObject*> objects;`只有第二个版本会编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T19:41:22.703

当您使用关键字创建对象时，`new`您将其分配在堆上。这将返回一个指向该对象的指针。

当您创建一个没有关键字的对象时，`new`它将在堆栈上分配，您将可以就地访问该对象。

# php - 两个 Ajax 调用不能同时工作（heroku）

> ID：14175609
> 
> 赞同：2
> 
> 时间：2013-01-05T19:39:26.593
> 
> 标签：php, jquery, ajax, heroku, concurrency

我有以下代码：

```
$(window).load(function()
{
    $('#content1').load('database.php');
    setInterval (function() 
    { 
        $.post('status.php', { id: '1'}, function(responseText, responseStatus)
        { 
            $('#content2').html(responseText); 
        });  
    }, 5000);
}); 
```

基本上，我调用 database.php 进行一些数据库插入，并使用周期性间隔来获取其进度状态。问题是在插入期间，间隔帖子给了我请求超时错误。只有在 database.php 完成处理后，才会写入 content2 中的文本。

现在我在 status.php 文件中使用了非常简单的代码，只是为了看看在处理 database.php 时是否能得到响应。这是代码（非常简单）：

```
<?php
    echo "hello";
?> 
```

我不知道为什么我收到超时错误而没有得到响应。如您所见，在 statuse.php 文件中，我没有使用任何可以阻止调用的 php 会话变量。有趣的是，一旦数据库的处理完成，我确实得到了响应。也就是说，我得到文本“你好”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:59:31.773

您可能正在使用会话。PHP 的默认基于文件的会话处理程序会在脚本处于活动状态时**锁定**会话，因此从调用的那一刻起`session_start()`，使用同一会话的其他脚本不能并行运行，因为其他脚本将阻塞并挂在 session_start() 调用上直到第一个脚本完成。

如果您希望您的“进度”检查调用成功，您必须`session_write_close()`在数据库脚本中执行一个操作，以便放弃会话锁定并且该会话上的其他请求可以继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T03:35:48.370

问题是我的服务只使用了一个测功机。由于数据库处理需要一些时间并且由我的单个测功机处理，因此无法处理其他 AJAX 请求。为了允许并发，需要更多的测功机。

但是，不鼓励这样做，因为每个当前使用该服务的用户都需要一个 dyno，再加上另一个 dyno 来处理简单的 AJAX 请求。鼓励使用工作线程（例如 Heroku 支持的 IronWorker），这样这些冗长的进程就不会导致您的测功机忙到无法处理其他请求的程度。

# php - PHPUnit 在基本“测试”文件夹之外时无法找到 Zend_Test_PHPUnit_ControllerTestCase

> ID：14175610
> 
> 赞同：0
> 
> 时间：2013-01-05T19:39:28.093
> 
> 标签：php, zend-framework, phpunit

我正在使用 PHP 5.3.4、Zend 1.11.11 和 PHPUnit 3.7.1 运行 Wamp Server。我的项目结构是默认的 Zend 布局，其中测试文件夹组织如下：

```
tests/
   application/
   library/
   bootstrap.php
   phpunit.xml
   IndexControllerTest.php 
```

两者`application/`和 `library/`都是空的。这个基本案例适用于我当前的设置，我可以`phpunit IndexControllerTest`从终端运行，它运行测试没有错误。一旦我将 IndexControllerTest.php 移动到不同的位置（例如，在`application/`目录中），就会出现问题。然后我从 phpunit 收到一个致命错误：

```
PHP Fatal error: Class 'Zend_Test_PHPUnit_ControllerTestCase' not found in 
X:\Program Files (x86)\Wamp\www\Local_site\Zend\login\tests\application\IndexControllerTest.php 
on line 3 
```

现在除非我弄错了，否则 Autoloader 应该会处理这个问题`require()`，但是一旦我更改了测试文件的位置，就会出现问题。我已经尝试一遍又一遍地调整 phpunit.xml 文件，但我不确定这是我的问题所在，还是在我的 bootstrap.php 或我的代码中。任何见解将不胜感激。甚至向正确的方向轻推。以下是相关文件：

**phpunit.xml**

```
<phpunit bootstrap="./bootstrap.php">
<testsuites>
<testsuite name="My Project">
    <directory>./tests</directory>
</testsuite>

</testsuites>

<filter>
    <!-- If Zend Framework is inside your project's library, uncomment this filter -->

    <whitelist>
        <directory suffix=".php">/library/Zend</directory>
    </whitelist>

</filter>
</phpunit> 
```

**引导程序.php**

```
<?php

// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'testing'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance(); 
```

**索引控制器测试.php**

```
<?php
class IndexControllerTest extends Zend_Test_PHPUnit_ControllerTestCase
{
    protected $application;

    public function setUp() 
    {
        // Assign and instantiate in one step:
        $this->bootstrap = new Zend_Application(
            'testing',
            APPLICATION_PATH . '/configs/application.ini'
            );
        parent::setUp();
    }

    public function testTrue()
    {
         $this->assertTrue(true);
    }
} 
```

根据来自黄金互联网的其他建议，我还将我的 php/php.ini include_path 更改为：

```
include_path=".;X:\Program Files (x86)\Wamp\bin\php\php5.3.4\pear;X:\Program Files (x86)\Wamp\bin\php\php5.3.4\pear\PHPUnit" 
```

我需要明确包括`Zend/Test/PHPUnit/ControllerTestCase.php`吗？我已经尝试了数百种解决方案，但我一直在盲目飞行，所以我可能非常接近甚至不知道它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-24T14:25:12.107

您不需要在测试用例中明确包含引导文件。

您需要在包含路径上有库文件夹（其中包含 Zend 库）。bootstrap.php 文件应该对此负责。

此错误消息有两个可能的原因：

1.  phpunit.xml 无法引用正确的 bootstrap.php。

2.  引导文件没有引用正确的库路径（我认为这里就是这种情况）

您可以在 bootstrap.php 中回显包含路径，以确保其设置正确。

基本上，将以下行添加到 bootstrap.php 之前的 require_once

```
$includePath  = get_include_path();
echo "appPath = ".APPLICATION_PATH. "\n";
echo "includePath = $includePath \n"; 
```

includePath 应该有一个应用程序/库文件夹的条目（请注意，有 2 个应用程序文件夹。一个包含类，另一个包含测试。您应该指的是测试目录之外的那个）

[这](http://framework.zend.com/manual/1.12/en/project-structure.project.html)是典型的文件夹结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:04:58.843

设法找到解决这个问题的方法（就像它一样简单......）。无论出于何种原因，phpunit.xml 都没有引导我的 bootstrap.php 文件。在我在 IndexControllerTest.php 中声明我的类之前，它需要我的引导程序：

**索引控制器测试**

```
require_once '/path/to/bootstrap.php';

IndexControllerTest extends Zend_Test_PHPUnit_ControllerTestCase
{
      public function testTrue() 
      {
              $this->assertTrue(true);
      }
} 
```

在每个测试文件中都需要这个似乎很奇怪，我相信我很快就会找到一个更永久的解决方案。希望这可以帮助某人。

**编辑**

在我简单地将我的 phpunit.xml 文件复制到与 IndexControllerTest 相同的目录并更改`bootstrap="bootstrap.php"`为`bootstrap="../bootstrap.php"`新的 phpunit.xml 文件的地方找到了更好的解决方案。现在`require_once`该目录中的所有测试文件都不需要。似乎仍然是一个粗略的修复，但总比没有好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T22:50:59.410

在过去的几个小时里，我一直在为此苦苦挣扎，并使用我设法想出以下答案的答案，并将其添加到我的 application/bootstrap.php

```
require_once 'Zend/Loader/Autoloader/Resource.php';

$resourceLoader = new Zend_Loader_Autoloader_Resource(array(
'basePath'      => APPLICATION_PATH,
'namespace'     => '',
'resourceTypes' => array(
    'cplib' => array(
        'path'      => 'library/CP',
        'namespace' => 'CP_'
    ),
),
)); 
```

一旦我有了这个，我就能够自动加载正确的 Zend 库文件，而无需手动指定它们。

# javascript - Webkit：根据窗口大小调整 div 和 div 内元素的大小

> ID：14175613
> 
> 赞同：0
> 
> 时间：2013-01-05T19:39:53.437
> 
> 标签：javascript, webkit, webkit-transform

我有`div`一个包含文本的元素，我在用它缩放内部文本时尝试调整其大小。

`webkit-transform: scale( blah, blah )`CSS 属性非常适合按特定因子缩放 div，但我需要它与**窗口大小成比例**缩放。

有谁知道有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T16:00:43.063

可以用百分号吗？如果需要，请按比例制作。

# html - 如何使 jqgrid 工具栏按钮与标准 jquery ui-buttons 大小相同

> ID：14175615
> 
> 赞同：0
> 
> 时间：2013-01-05T19:40:06.823
> 
> 标签：html, css, jquery-ui, button, jqgrid

使用带有 jquery ui Redmond 主题的 jqgrid。

顶级工具栏包含标准的添加、删除等按钮和创建的自定义按钮

```
 $grid = $("#grid");
   $grid.jqGrid("navGrid", "#grid_toppager", { 
        search:  true,
        del: true,
        add: true,
        refresh: true, 
        edit: true } );
   $grid.jqGrid('navButtonAdd', '#grid_toppager', {
        caption: '',
        id: "grid_printbutton",
        title: 'Print order',
        buttonicon: 'ui-icon-print'
    }); 
```

html:

```
 <div id="grid1container" style="width: 100%; height: 100%">
        <table id="grid">
        </table>
    </div> 
```

按钮只包含图标，没有标题。页面还包含带有使用 jquery ui button() 函数创建的普通按钮的工具栏。jqgrid 按钮的高度和宽度小于使用 jquery ui 按钮功能创建的普通按钮。用户很难以典型的屏幕分辨率点击它们。

如何使 jqgrid 顶级工具栏按钮大小与标准 jquery ui 按钮相同？按钮的宽度和高度是否可以增加，或者是否可以使用相同的按钮创建其他工具栏并强制它们调用对应的 jqgrid 工具栏按钮操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T03:31:29.453

只需使用 CSS 样式，在此示例中，

`#grid_printbutton { /*Styles to match other button themes */}`

这将为您的按钮设置样式。根据按钮的宽度/高度，您还可以深入研究网格的 CSS 样式默认值，以确保网格/分页器区域有足够的空间来显示这些较大的按钮。

对于预建按钮，它们的样式由

```
<td id="search_GridName" class="ui-pg-button ui-corner-all" title="Find records">
   <div class="ui-pg-div">
      <span class="ui-icon ui-icon-search"></span>
   </div>
</td> 
```

因此，要设置样式，您可以应用一些特定样式。内联按钮你可以找到类似的东西。虽然如果您增加行大小以容纳更大的内联行按钮，您的网格将显示的信息量将会减少。

# ruby-on-rails - 如何设置嵌套资源的视图，这些资源在 Rails 的父资源中显示为选项卡？

> ID：14175617
> 
> 赞同：2
> 
> 时间：2013-01-05T19:40:26.503
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-resources

我有一个资源`Company`有很多`Projects`和`People`. 公司的`index`操作在表格中显示每个公司。该`show`操作显示了一些关于它的附加信息，然后我想显示另一个表，其中包含“项目”和“人员”选项卡。

当我单击“人员”选项卡时，我应该转到 URL“companies/:id/people”，同样也可以访问“项目”选项卡。我不担心 AJAX 或在操作`@company`期间将所有这些信息预加载到变量中`show`。一个简单的嵌套资源就可以了。

现在，当我在“companies/:id/people”时，它将使用`PeopleController#index`，但我想显示嵌套在公司视图中的视图（我想这只是表格？）`show`。所以当我在“companies/:id/people”和“companies/:id/projects”之间切换时，唯一改变的是表格，而不是外面的公司信息。

这种事情容易做到吗？如果 Rails 不是为了轻松处理这类事情而构建的，我不介意使用其他东西。我只是对视图层没有太多经验，所以我不太了解它，因为我主要使用 JSON。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:17:12.787

**基本示例：**

项目控制器 && 人员控制器：

```
layout :current_layout

def current_layout
  if @company && @company.persisted? && request.path_parameters[:action] == "index" # i prefer helper 'current_action'
    "company"
  else
    "application"
  end
end 
```

帮手：

```
def parent_layout(layout)
  @view_flow.set(:layout, self.output_buffer)
  self.output_buffer = render(:file => "layouts/#{layout}")
end 
```

公司布局：

```
#views/layouts/company.html.erb

<h1><%= @company %></h1>
<ul class="tabs">
 <li>Info</li>
 <li>Info</li>
 <li>Info</li>
</ul>
<%= yield %>
<%= parent_layout(:application) %> 
```

人物模板：

```
# views/people/index.html.erb

<% if current_layout == "company" %> # just table
  <%= render "people_table" %>
<% else %>
  <h1>People controller</h3>
  <%= render @people %>
<% end %> 
```

项目模板：

```
# views/projects/index.html.erb

<% if current_layout == "company" %> # just table
  <%= render "projects_table" %>
<% else %>
  <h1>Projects controller</h3>
  <%= render @projects %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:53:24.193

我建议你看一下 rails guides，特别[是从外部路由到](http://guides.rubyonrails.org/routing.html).

然而，rails 可以处理这个问题，您的路线将通过以下方式设置：

```
resources :company do
       resource :projects
       resource :people
end 
```

我假设您已经设置了所有 CRUD 操作，那么这将起作用。但是请注意，它会更改您的命名路线。

IE

如果你打电话

```
projects_path 
```

在您看来，它们现在将变为：

```
company_projects_path 
```

您可以使用命令查看完整的路由列表

```
rake routes 
```

# ios - 在 iOS 上的 Twitter 撰写视图之后显示 Facebook 撰写视图

> ID：14175618
> 
> 赞同：2
> 
> 时间：2013-01-05T19:40:36.823
> 
> 标签：ios, facebook, twitter, nsnotifications, slcomposeviewcontroller

我有一个应用程序，用户可以选择通过 Twitter 和 Facebook 与人们分享更新，如果他们希望通过两者分享，那么事情就很棘手了。如果您尝试一个接一个地调用他们的 SLComposeViewController，则只会出现 Twitter，而 Facebook 则根本不会出现。我试图通过使用 NSNotifications 来解决这个问题，但它们似乎从未被调用，并通过使用完成处理程序，但这些似乎永远不会工作，只会让整个 UI 变得奇怪。谁能帮我一个接一个地显示 SLComposeView 吗？我已经用头撞墙四个小时了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:19:47.827

假设您尝试使用`presentViewController`' 完成处理程序并得到不正确的结果，这是另一种方法。您可以像往常一样展示第一个作曲家，然后在作曲家的完成块中展示第二个作曲家。一旦第一个作曲家完成被解雇，就会调用这个完成处理程序。

在我在下面设置的示例中，第二个作曲家只会在第一个返回时出现`SLComposeViewControllerResultDone`，允许您在用户点击取消时一起关闭所有作曲家。但是，如果您不想要此功能，可以通过保留呈现第二个作曲家的逻辑，但一起删除 switch 语句来轻松删除它。此代码经过测试，应该会产生您正在寻找的结果。希望能帮助到你！

```
if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
    SLComposeViewController *facebookComposer = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];
    [facebookComposer setInitialText:@"facebook"];
    [facebookComposer setCompletionHandler:^(SLComposeViewControllerResult result) {

        switch (result) {
            case SLComposeViewControllerResultCancelled:
                NSLog(@"Post Canceled, bail out");
                break;
            case SLComposeViewControllerResultDone:

                if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter]) {
                    SLComposeViewController *twitterComposer = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];
                    [twitterComposer setInitialText:@"twitter"];
                    [twitterComposer setCompletionHandler:^(SLComposeViewControllerResult result) {
                        NSLog(@"done with both sharing options");
                    }];
                    [self presentViewController:twitterComposer animated:YES completion:nil];
                }

                break;

            default:
                break;
        }
    }];
    [self presentViewController:facebookComposer animated:YES completion:nil];
} 
```

# java - 在处理语言中使用 OpenCV 时的 EXCEPTION_ACCESS_VIOLATION (0xc0000005)

> ID：14175620
> 
> 赞同：0
> 
> 时间：2013-01-05T19:40:52.883
> 
> 标签：java, opencv, processing

我的处理代码如下。

```
import hypermedia.video.*;
import processing.video.*;
import java.awt.Rectangle;

OpenCV opencv;

int width = 320;
int height = 240;

void setup() {

size( 320, 240 ); //set window size

opencv = new OpenCV( this ); //setup openCV
opencv.capture( width, height ); // open video stream
opencv.cascade( OpenCV.CASCADE_FRONTALFACE_ALT );
}

void draw(){
opencv.read();
image(opencv.image(), 0, 0);
Rectangle[] faces = opencv.detect( 1.2, 2, OpenCV.HAAR_DO_CANNY_PRUNING, 40, 40 );
noFill();
  stroke(255,0,0);
  for( int i=0; i<faces.length; i++ ) {
    rect( faces[i].x, faces[i].y, faces[i].width, faces[i].height );
  }
} 
```

此代码工作几秒钟，然后发生异常。

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x6d961b22, pid=232, tid=4008
#
# JRE version: 6.0_33-b03
# Java VM: Java HotSpot(TM) Client VM (20.8-b03 mixed mode windows-x86 )
# Problematic frame:
# V  [jvm.dll+0xa1b22]
#
# An error report file with more information is saved as:
# C:\Documents and Settings\Administrator\Desktop\processing-2.0b7\hs_err_pid232.log
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
# 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:51:40.450

我认为这是 opencv_core.CvMemStorage 的内存分配问题。这是一个未在您的库中公开的类。我有同样的问题。我正在使用 javacv（直接，而不是 javacvpro），因为我想运行多个 haar 级联（您只能使用 javacvpro 或较旧的 hypermedia.video.* 加载一个）。如果我在每个帧上都运行它们，我很好。如果我在每一帧上运行不同的检测器（然后再次循环通过检测器），我会在几个循环后得到这个错误。

下面的片段失败，但这是我想要做的（用不同的检测器处理每个后续帧）：

```
// Using JavaCV directly, not JavaCVPro!
import com.googlecode.javacpp.Loader;
import com.googlecode.javacv.*;
import com.googlecode.javacv.*;
import com.googlecode.javacv.cpp.*;
String cascades[] = {
  "haarcascade_eye.xml",            // 0
  "haarcascade_eye_tree_eyeglasses.xml",    // 1
  "haarcascade_frontalface_alt.xml"      // 2
}
int detectors[] = {1,3};
// haar detectors to use

String cascPath = "C:/opencv/data/haarcascades/";
// preload multiple classifiers. can do this with javacvpro, not with javacv or hypermedia.video.*

void haarSetup() {
    for (int i = 0; i < detectors.length; i++) {
      String classifierFile = cascPath+cascades[detectors[i]];
      classifier[i] = 
        new opencv_objdetect.CvHaarClassifierCascade(opencv_core.cvLoad(classifierFile));
    }
    storage = opencv_core.CvMemStorage.create();
    opencv_core.cvClearMemStorage(storage); // is this needed? couldn't hurt, right?
}

// contains list of preloaded haar cascades. code not included here...
opencv_core.CvSeq features[] = new opencv_core.CvSeq[detectors.length];
int whichHaar = 0;

// run one cascade per frame, then cycle through them.
void processHaars(PImage piz) {
  // convert to IplImage...  
  BufferedImage imgBuf = (BufferedImage) piz.getNative();    
  opencv_core.IplImage iplImgOut=opencv_core.IplImage.createFrom(imgBuf);
  // do one haar cascade per invocation.
  int ii = whichHaar;
  features[ii] = opencv_objdetect.cvHaarDetectObjects(iplImgOut, classifier[ii], storage, 1.1, 3, opencv_objdetect.CV_HAAR_DO_CANNY_PRUNING);
  whichHaar++;
  if (whichHaar >= detectors.length){
    whichHaar = 0;
    // is THIS causing the problem??
    opencv_core.cvClearMemStorage(storage);
  }
} 
```

这个片段永远有效，但我不想要它的作用（在一个帧上运行所有检测器）：

```
void processHaars(PImage piz) {
// convert to IplImage...  
BufferedImage imgBuf = (BufferedImage) piz.getNative();    
opencv_core.IplImage iplImgOut=opencv_core.IplImage.createFrom(imgBuf);

for (ii=0; ii<detectors.length; ii++)
    faces[ii] = opencv_objdetect.cvHaarDetectObjects(iplImgOut, classifier[ii], storage, 1.1, 3, opencv_objdetect.CV_HAAR_DO_CANNY_PRUNING);

opencv_core.cvClearMemStorage(storage);
} 
```

如果我找到完整的解决方案，我会发布它。

# apache - 如何在 URL 中更改 Joomla 中的组件名称？

> ID：14175623
> 
> 赞同：0
> 
> 时间：2013-01-05T19:41:00.450
> 
> 标签：apache, .htaccess, joomla, joomla-component

如何更改 joomla 中的 URL：

```
http://sitename.com/components/original-component-name/rest 
```

至：

```
http://sitename.com/components/any-component-alias/rest 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T05:46:50.920

虽然您要求做的事情是可能的，但重命名组件会相当复杂。作为重命名的一部分，您必须在组件的每个文件中更新数十个（如果不是数百个）类的名称。因此很可能会遇到一些错误。

更容易的前景是避免在您的网站中使用这些类型的网址。如果视图不存在菜单项，Joomla 只会退回到该样式的 url。因此，您可以将网址设置为：

```
http://sitename.com/any-component-alias/ 
```

为此，请进入菜单管理器并创建一个新菜单项。如果您不想将其作为主菜单的一部分，您可以创建一个新菜单。（我通常有一个名为“隐藏”的菜单，用于我想要别名但实际上并不从菜单链接到整个站点的菜单项。）创建菜单项时，请确保类型与组件和视图匹配。然后，别名将是在标题下方的别名框中输入的任何内容。

您可能遇到的一个问题是组件可能没有特定视图的菜单类型。在这种情况下，您需要将必要的 metadata.xml 文件添加到视图中（这又比重命名组件容易得多！）。可以在这里找到一个很好的教程：http: [//docs.joomla.org/Adding_view_layout_configuration_parameters](http://docs.joomla.org/Adding_view_layout_configuration_parameters)。

# java - Java processbuilder 子进程在退出后继续

> ID：14175624
> 
> 赞同：3
> 
> 时间：2013-01-05T19:41:03.723
> 
> 标签：java, daemon, processbuilder

我正在开发一个自动更新脚本，它应该能够在完成后重新启动守护进程。

我目前正在尝试这个：

```
 final ArrayList<String> command = new ArrayList<String>();
    String initScriptPath = Config.GetStringWithDefault("init_script", "/etc/init.d/my-daemon");
    command.add("/bin/bash");
    command.add("-c");
    command.add("'" + initScriptPath + " restart'");

    StringBuilder sb = new StringBuilder();
    for (String c : command) {
        sb.append(c).append(" ");
    }
    Log.write(LogPriority.DEBUG, "Attempting restart with: " + sb.toString());

    final ProcessBuilder builder = new ProcessBuilder(command);

    builder.start();

    // Wait for a couple of seconds
    try {
        Thread.sleep(5000);
    } catch (Exception e) {
    }

    System.exit(0); 
```

但是 System.exit 似乎停止重新启动？它确实停止了，但不会重新开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T19:50:07.907

您绝对应该在退出之前等待您的流程完成：

```
final ProcessBuilder builder = new ProcessBuilder(command);
builder.redirectErrorStream(true);
final Process process = builder.start();
final int processStatus = process.waitFor(); 
```

并且您应该使用进程的输出流，因为如果输出缓冲区已满，它可能会导致进程阻塞。不确定这是否适用于您的场景，但无论如何它都是最佳实践：

```
String line = null;
final BufferedReader reader =
    new InputStreamReader (process.getInputStream());
while((line = reader.readLine()) != null) {
   // Ignore line, or do something with it
} 
```

最后一部分还可以使用[Apache IOUtils之类的库。](http://commons.apache.org/io/apidocs/org/apache/commons/io/IOUtils.html#readLines%28java.io.InputStream%29)

# rspec2 - 当使用 Grape 作为 Rack 应用程序时，Warden 在 rspec 测试中不可用

> ID：14175626
> 
> 赞同：5
> 
> 时间：2013-01-05T19:41:09.173
> 
> 标签：rspec2, warden

在我的 RSpec 测试中，让 Warden 的哈希出现在请求哈希中时遇到问题。当我在开发模式下运行我的应用程序时，Warden 密钥就在那里，但在测试环境中，一切都是零。我在下面包含了我的基本 rspec 配置。如果有人对我出错的地方有任何想法，我真的很想知道，我几乎整天都在摆弄这个。

在开发模式下运行时找到Warden，但在测试模式下运行时`env['warden']`总是`nil`

这是我在开发模式下检查请求对象内的warden hash时得到的示例：

```
request['warden']
=> Warden::Proxy:70272688271480 @config={:default_scope=>:default, :scope_defaults=>{}, :default_strategies=>{:_all=>[:password, :basic]}, :intercept_401=>true, :failure_app=>GrapeApe::BadAuthentication} 
```

这是我在测试期间检查请求对象内的warden hash时得到的结果：

```
request['warden']
=> nil 
```

规范帮助文件

```
require 'rubygems'

ENV["RACK_ENV"] ||= 'test'

require 'rack/test'
require 'capybara/rspec'
require 'factory_girl'
require File.expand_path("../../config/environment", __FILE__)

FactoryGirl.find_definitions

RSpec.configure do |config|
  config.mock_with :rspec
  config.expect_with :rspec
  config.include Capybara::DSL
  config.include Rack::Test::Methods
  config.include Warden::Test::Helpers
  config.after :each do
    Warden.test_reset!
  end
end

Capybara.configure do |config|
  config.app = GrapeApe::App.new
  config.server_port = 9293
end 
```

Example Spec wherewarden 应该抛出 403 响应，因为用户尚未通过身份验证。

```
it "should get a specfic sketch" do
  get "/api/v1/sketches/#{@sketch.id}"
  JSON.parse(last_response.body)['files'].should == ["foo"]
end 
```

示例错误：

```
Failure/Error: JSON.parse(last_response.body)['files'].should == ["foo"]
JSON::ParserError:
756: unexpected token at 'undefined method `authenticated?' for nil:NilClass' 
```

检查监狱长钥匙的相关葡萄助手方法

```
module GrapeApe
  module Helpers
    def warden
      env['warden']
    end

    def authenticated
      if warden.authenticated?
        return true
      elsif params[:access_token] and
        User.find_for_token_authentication("access_token" => params[:access_token])
        return true
      else
        error!('401 Unauthorized', 401)
      end
    end

    def current_user
        warden.user || User.find_for_token_authentication("access_token" => params[:access_token])
    end

    def authenticated_user
      authenticated
      error!('401 Unauthorized', 401) unless current_user
    end

  end
end 
```

# mysql - 主键会加速索引吗？

> ID：14175627
> 
> 赞同：11
> 
> 时间：2013-01-05T19:41:11.150
> 
> 标签：mysql, performance, indexing, benchmarking

除了方便的自增和`UNIQUE`特性，PK真的能加速索引吗？

无论是非 PK 索引`INT`还是 PK （同一列，两个不同的测试），速度是否相同？如果我在同一个系统的同一张表上有相同的`UNIQUE` `INT`列，如果具有索引的列也启用了 PK 会更快吗？PK 是否让与其共存的索引更快？

拜托，如果你能这么好，实际结果只有系统统计数据。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-05T19:51:46.297

表的**主键代表您在最****重要的查询**中使用的列或列集。它有一个关联索引，用于**快速查询性能**。查询性能受益于**NOT NULL 优化**，因为它不能包含任何**NULL**值。使用**InnoDB 存储引擎**，表数据在**物理上进行**组织，以根据主键列或列进行**超快速查找和排序。**

如果您的表很大且很重要，但没有明显的列或列集可用作主键，则您可以创建一个具有自动增量值的单独列以用**作主键**。当您使用外键连接表时，这些**唯一 ID**可以用作**指向其他表中相应行的指针。**

另请参阅以下位置：[http](http://www.dbasquare.com/2012/04/04/how-important-a-primary-key-can-be-for-mysql-performance/) ://www.dbasquare.com/2012/04/04/how-important-a-primary-key-can-be-for-mysql-performance/和[http://www.w3schools .com/sql/sql_primarykey.asp](http://www.w3schools.com/sql/sql_primarykey.asp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:43:41.973

基表中的行由为表定义的主键的值唯一标识。表的主键由一个或多个列的值组成。

主键被自动索引以促进有效的信息检索。

主键索引是对表最有效的访问路径。

可以将其他列或列组合定义为二级索引，以提高数据检索的性能。二级索引是在创建表后定义的（使用 CREATE INDEX 语句）。

二级索引可能有用的一个例子是，当定期对具有许多行的表中的非键列执行搜索时，在列上定义索引可能会加快搜索速度。搜索结果不受索引影响，但搜索速度得到优化。

但是应该注意，索引会为更新、删除和插入操作带来开销，因为索引也必须更新。

索引是内部结构，一旦创建，用户就无法显式访问。如果内部查询优化过程确定索引将提高搜索效率，则将使用索引。

SQL 查询在内部准备好执行时会自动优化。优化过程确定执行每个查询的最有效方式，这可能涉及也可能不涉及使用适用的索引。

# javascript - 没有哈希的网址更改

> ID：14175637
> 
> 赞同：1
> 
> 时间：2013-01-05T19:42:04.413
> 
> 标签：javascript, html, url, history

当我在当前页面的弹出窗口中打开带有预览图像的大图像时，我想更改 url。我不想使用 window.location.hash 功能，因为接下来我想通过 PHP 使用新的 url 进行操作，我发现这很复杂，可以使用哈希来实现。所以，我发现我可以使用 HTML5 功能来制作这个。

```
window.history.pushState(“object or string”, “Title”, “/new-url”); 
```

我的问题是：当我关闭大图像时，我想从页面中删除这个新网址。我怎么能做这个，不使用

```
window.history.back(); 
```

?

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:49:59.447

关闭图像**与**按下浏览器中的后退按钮不同。这类似于跟随另一个链接返回原始页面。所以没有必要回去。再`pushState`一次，回到原来的 URL。

另一方面，如果该人*确实*单击了浏览器中的后退按钮，那么您也希望将他们带回原始页面。所以你需要监听`popstate`事件，当它被触发时，运行一个函数来删除弹出图像：

```
window.addEventListener("popstate", function(e) {
    hideimage();
} 
```

阅读[有关 HTML5 历史 API 的更多信息](http://diveintohtml5.info/history.html)。

# ruby-on-rails - Ruby on Rails find - 找到错误的对象？

> ID：14175638
> 
> 赞同：1
> 
> 时间：2013-01-05T19:42:05.190
> 
> 标签：ruby-on-rails, find

我是 Ruby on Rails 的新手。我正在尝试建立一对多的关联。我有一个“项目”，该项目应该有很多“任务包”。那看起来不错。

现在我想在页面上只显示为该选定项目过滤的任务包。

我在 ProjectController 类中做了这个：

```
def select
    puts "==Projects=="
    puts params[:id]

    @project = Project.find{params[:id]}
    puts @project.id
    session[:project_id] = @project.id

    puts session[:project_id]

    redirect_to taskbundles_path
end 
```

我到达那里没有问题，但是 find 方法找到了 id 为 3 的项目，而不是找到了 id 为 4 的项目？我检查了，id 为 4 的项目存在。

输出

```
==Projects==
4
3
3

Started GET "/projects/select/4" for 127.0.0.1 at 2013-01-05 20:19:03 +0100
Processing by ProjectsController#select as HTML
  Parameters: {"id"=>"4"}
  ?[1m?[35mProject Load (0.0ms)?[0m  SELECT "projects".* FROM "projects"
Redirected to http://localhost:3000/taskbundles
Completed 302 Found in 3ms (ActiveRecord: 0.0ms) 
```

我不知道我在哪里做错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T19:44:55.283

我认为你有一个语法问题：`@project = Project.find{params[:id]}`应该是`@project = Project.find(params[:id])`. ID 需要作为参数传递。您的代码创建了一个 ruby​​ 块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-02T18:56:04.223

我认为你应该使用 @project = Project.find_by{params[:id]} 而不是 Project.find{params[:id]}

如果 id 不存在 find 方法会给你异常并停止执行剩余的代码，就像你使用 find_by 方法一样，如果 id 在数据库中不存在，它将返回 nil 。

# exchangewebservices - EWS 签名更新错误

> ID：14175652
> 
> 赞同：0
> 
> 时间：2013-01-05T19:43:12.023
> 
> 标签：exchangewebservices, signature

```
public void updateSignature(ExchangeService exchange, String signature) {
    try {
        FolderId f = new FolderId(WellKnownFolderName.Root);
        UserConfiguration user = UserConfiguration.bind(exchange,
                "OWA.UserOptions", f, UserConfigurationProperties.All);

        if (user.getDictionary().containsKey("signaturetext"))
            user.getDictionary().setElements("signaturetext", signature);
        else
            user.getDictionary().addElement("signaturetext", signature);
        user.update();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

我收到 user.update() 的空指针异常；我可以在设置新签名之前在控制台中打印旧签名，也可以在字典中设置新签名之后打印。但是，我无法永久更新更改。提前致谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T09:53:39.823

在其他代码中，它使用的是 root.parentFolderId 而不是 root。也许是这个问题：

附上代码

```
static void SetSigniture(ExchangeService service) throws Exception {
    Folder Root = Folder.bind(service, WellKnownFolderName.Root);
    UserConfiguration OWAConfig = UserConfiguration.bind(service, "OWA.UserOptions", Root.getParentFolderId(), UserConfigurationProperties.All);
    String hsHtmlSigniture = "<img src='http://www.baidu.com/img/baidu_jgylogo3.gif' />";
    String stTextSig = "Text sig";
    System.out.println(OWAConfig.getDictionary().getElements("timezone"));;
    if (OWAConfig.getDictionary().containsKey("signaturehtml")) {
        OWAConfig.getDictionary().setElements("signaturehtml", new Object());
    } else {
        OWAConfig.getDictionary().addElement("signaturehtml", hsHtmlSigniture);
    }
    if (OWAConfig.getDictionary().containsKey("signaturetext")) {
        OWAConfig.getDictionary().setElements("signaturetext", stTextSig);
    } else {
        OWAConfig.getDictionary().addElement("signaturetext", stTextSig);
    }
    OWAConfig.update();
} 
```

# c++ - boost.process 批处理脚本无法运行另一个程序

> ID：14175653
> 
> 赞同：3
> 
> 时间：2013-01-05T19:43:24.403
> 
> 标签：c++, winapi, boost, process, batch-file

我正在调用批处理`cmd.exe /C`脚本`Boost.process`

```
 boost::process::context context;
  context.stdout_behavior = boost::process::capture_stream();

#ifdef WIN32
  arguments.push_front("/c");
  arguments.push_front(_script);
  boost::process::child external_process = boost::process::launch("cmd.exe", arguments, context);
#else
  boost::process::child external_process = boost::process::launch(_script, arguments, context);      
#endif      
  boost::process::status status_code = external_process.wait(); 
```

如果我直接调用批处理文件，即使使用 cmd.exe /C 它也会调用外部可执行文件。

但是当通过我的程序调用批处理脚本时，它根本不会调用外部程序。外部可执行文件生成一些文件。还将一些文本打印到标准输出。我既没有看到那些文本，也没有看到要生成的任何文件。

我什至尝试将目标可执行文件替换为`notepad.exe`然后出现一个消息框`Application failed to initialize properly (0xc0150004) click on OK to terminate application`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T16:41:51.050

我发现`boost::process::context`不是跨平台。我必须`boost::process::win32_context`在 Windows 上使用。并且可能有问题，`silence_stream`或者可能是我身边的问题。

```
//I've a list of argv in arguments

#ifdef WIN32
  arguments.pop_front();
  arguments.push_front(_script);
  arguments.push_front("/C");
  arguments.push_front("script.bat");

  boost::process::win32_context win32_context;
  win32_context.stdout_behavior = boost::process::capture_stream();
  win32_context.environment = boost::process::self::get_environment(); 

  boost::process::child external_process = boost::process::win32_launch(std::string("C:/Windows/System32/cmd.exe"), arguments, win32_context);
#else
  boost::process::context context;
  context.stdout_behavior = boost::process::silence_stream();

  boost::process::child external_process = boost::process::launch(_script, arguments, context);
#endif

  boost::process::status status_code = external_process.wait(); 
```

它没有得到`PATH`所以应用程序无法找到`dll`。`win32_context.environment = boost::process::self::get_environment()`解决了这个问题。

# javascript - 如何在 angularjs 应用程序中刷新视图而不刷新页面

> ID：14175658
> 
> 赞同：4
> 
> 时间：2013-01-05T19:43:45.797
> 
> 标签：javascript, model-view-controller, angularjs

我有一个列出联系人报告的简单应用程序，在其中我创建了一个从 Mongolab 获取数据的列表视图。

在那我还做了一个输入表单，在提交时在列表中创建一个新的联系人报告

我在控制器中使用的功能是根据他们网站上的 angular 示例建模的：

```
app.factory('Contact',function($mongolabResource){
    return $mongolabResource('contacts');
});

function ContactCreateCtrl($scope,$location,Contact) {
Contact.save(contact,function(){
        $location.path('/');
    });
}; 
```

$location.path() 是重新加载页面的回调。

我如何重写它，以便在提交数据时（.save() 成功）视图重新加载而不重新加载页面？

我尝试删除然后重新定义数组，但似乎不起作用：

```
Contact.save(contact,function(){
        delete $scope.contacts;
        $scope.contacts = Contact.query();
    }); 
```

我也想在删除功能上实现这一点。有人可以指出我可以在哪里学习这个吗？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T21:15:22.663

好的，我更新了您的小提琴以从数据库中获取值：http: [//jsfiddle.net/joshdmiller/Y223F/2/](http://jsfiddle.net/joshdmiller/Y223F/2/)。

```
app.controller( 'MainCtrl', function ( $scope,Contact ) {
  $scope.updateContacts = function () {
    Contact.query( function( data ) {
      $scope.contacts = data;
    });
  };

  $scope.save = function( newContact ) {
    Contact.save( newContact, function() {
      $scope.updateContacts();
    });
  };

  // The initial data load
  $scope.updateContacts();  
}); 
```

有两点需要注意：

(1) 我将您的 Mongo 查询移到一个函数中，以便在创建新记录时再次调用它；

(2) $mongolabResource 期望回调成功时执行；你的应用程序闪烁，因为你没有提供一个。换句话说，从您调用查询到获取完成，您的列表是空的。相反，我们希望它*仅*在获得新数据时才发生变化。我也改了。

在手动添加项目或从数据库中获取项目方面，最佳实践是基于用例并且存在权衡。但是对于这样的小数据，只需从数据库中获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:01:36.947

让它工作，但仍然不确定在范围内推入数组，如果我们可以从数据库中获取会更好

```
function ContactCreateCtrl($scope,$location,Contact) {
    Contact.save(contact,function(){
    $scope.contacts.push(contact);
}); 
```

我还需要由 db 自动生成的 _id 对象，用于链接目的。这种方法没有给我_id，有什么见解吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-02T19:05:19.923

我正在分享我在使用 firebase auth 服务从 firebase 注销后如何清除视图中的数据的答案。`$scope.currentUser = null;`调用注销方法后数据仍然存在。必须重新加载才能看到数据更改。不是最好的用户体验。

```
$scope.getCurrentUser = function() {
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                // User is signed in.
                $scope.currentUser = user;
            } else {
                // No user is signed in.
                $scope.currentUser = null;
                console.log('user not signed in.');
            }
        });
    }

$scope.getCurrentUser();

$scope.signout = function() {
        firebase.auth().signOut().then(function() {
          // Sign-out successful.
          console.log('signed out success');
          $scope.getCurrentUser();
        }, function(error) {
          // An error happened.
          console.log(error);
        });

    } 
```

因此调用 getUserData 方法并使 currentUser = null 更新视图而无需重新加载。这是一个使用 firebase 的示例，但经过一些调整，它可能适用于您在不重新加载整个页面的情况下从视图中清除数据的需求。Firebase 在这里完成了清除用户对象的繁重工作，但我的视图并不关心，直到我再次检查我的 getCurrentUser 方法以查看是否仍有用户，如果没有，则从 $scope 中清除它而不重新加载视图。

# php - 我无法让 strpos 使用换行符

> ID：14175663
> 
> 赞同：1
> 
> 时间：2013-01-05T19:44:23.940
> 
> 标签：php, newline, strpos

我对 php 很陌生，不知道如何解决这个问题。我有一个表格，想将一些字符串传递给它，并用另一个文件检查它。如果所有字符串都在同一行上，它工作正常，但只要我输入多行字符串，它就会失败。

我有一个包含以下代码的 php 文件：

```
<?php
echo "<center><form method='post' enctype='multipart/form-data'>";
echo "<b></b><textarea name='texttofind' cols='80' rows='10'></textarea><br>";
echo "<input name='submit' type='submit' style='width:80px' value='Run' />";
echo "</form></center>";

$texttofind = $_POST['texttofind'];
if(get_magic_quotes_gpc()) {
    $texttofind = stripslashes($texttofind);
}
$texttofind = html_entity_decode($texttofind);
$s = file_get_contents ("/home/xxxxx/public_html/abc.txt");
if (strpos ($s, $texttofind) === false) {
    echo "not found";
}
else
    echo "found";
?> 
```

在 abc.txt 中，我有

```
dog  
cat  
rat 
```

每当我打开 php 页面并只输入 dog 或 cat 时，它会很好并显示`'found'`消息，但是当我输入多行（如“dog `<enter on keyboard>`cat”）并单击提交按钮时，它会返回`'not found'`消息。

代码有什么问题，或者无论如何要对其进行调整以便能够搜索多行？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:55:30.093

当您将搜索词放在新行上时，您正在添加比较文件中不存在的字符。比如当你进入...

狗猫老鼠

您实际上正在发送一个看起来像...的字符串

“狗\n猫\n老鼠”

其中 \n 表示字符 13 或标准的非 Windows 换行符。对此的修复取决于您想要做什么。您可以使用 PHP 的 explode 函数搜索结果，将输入字符串转换为数组，然后获取每个单词的位置...

```
$inputs = explode("\n", $_POST['field']);
$positions = array();

foreach($inputs as $val)
    $positions[] = str_pos($compareTo, $val); 
```

现在 $positions 应该是为每一行找到的 str_pos 的数组。

如果您仍在尝试搜索比较文件是否包含所有文本，您只是不在乎它是否在新行上，您可以简单地一起删除新行字符（也删除 \r 只是为了安全的）

```
$inputs = str_replace("\n", "", $_POST['field']);
$inputs = str_replace("\r", "", $inputs); 
```

现在输入将是“dogcatrat”。您可以使用 str_replace 的第二个参数来设置空格而不是 \n 以返回以空格分隔的列表。

```
$inputs = str_replace("\n", " ", $_POST['field']);
$inputs = str_replace("\r", "", $inputs); 
```

是的，我们仍然一起忽略 \r （愚蠢的窗口）。尽管如此，我建议阅读如何使用数组、explode & implode 和 str_replace。许多人会对此发表评论并告诉您 str_replace 不好，您应该学习正则表达式。作为一名经验丰富的开发人员，我发现很少有正则表达式替换在简单的字符替换中提供任何更好的功能的情况，它将使您学习一种全新的命令语言。现在忽略那些告诉你使用正则表达式但在不久的将来肯定会学习正则表达式的人。你最终会需要它，只是不是为了这种性质的东西。

[http://php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

[http://php.net/manual/en/function.explode.php](http://php.net/manual/en/function.explode.php)

[http://php.net/manual/en/function.implode.php](http://php.net/manual/en/function.implode.php)

[http://php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)

[http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-05T19:51:54.453

```
<?php
$values=explode("\n",$txttofind);
foreach($values as $value)
{
    if (strpos ($s, $value) === false)
    {
        echo "$value : not found <br>";
    }
    else
    {
        echo "$value : found <br>";
    }
}
?> 
```

# c# - 使用 C# 在 SQL Server 中保存数据的最快方法是什么？

> ID：14175665
> 
> 赞同：2
> 
> 时间：2013-01-05T19:44:29.133
> 
> 标签：c#, .net, sql-server

我目前正在使用 C# 开发一个小型 .NET 应用程序，该应用程序通过一些 Web 服务获取数据。

数据以对象表示，因此将数据存储在基于文档的数据库中是合乎逻辑的，但需要使用 SQL Server。

那么，将数千甚至数百万行插入数据库的最快方法可能是什么。

我对任何可能支持它的框架持开放态度，但我无法找到任何关于此的基准测试，例如在实体框架上。

要迭代数据并每行插入一次只会减慢速度，然后将数据转储到文件中会更快，然后使用 SSIS 进行批量导入，但对于这种情况，我宁愿避免这种情况，并保持C# 应用程序中的所有逻辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T19:46:16.150

您可能想使用`SqlBulkCopy`该类。它对于大数据非常有效。

# client-server - 如何更新服务器端的功能但保持客户端的功能不变

> ID：14175666
> 
> 赞同：0
> 
> 时间：2013-01-05T19:44:36.857
> 
> 标签：client-server

**服务器端：**

```
function sender(x, y){
   do something
} 
```

**客户端：**

```
function receiver(x,y){
   do something
} 
```

现在，我们需要以某种方式将服务器端的函数更改为只需要一个参数：

```
function sender(x){
   do something
} 
```

在不更改/更新客户端功能的情况下，我们如何保持这两个功能相互配合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:58:11.127

您可能想为新功能制作一个包装器。像这样：函数发件人（x，y）{发件人（x）}

# c# - 如何使用数据网格中的图像自动将评级从 int 转换为 Panel？

> ID：14175669
> 
> 赞同：1
> 
> 时间：2013-01-05T19:44:44.767
> 
> 标签：c#, wpf, datagrid

一件事需要帮助。我有`DataGrid`，将它绑定到这个类：

```
class Book
{
    public string Title { get; set; }
    public string Author { get; set; }
    public string Tags { get; set; }
    public string Year { get; set; }
    public string Description { get; set; }
    public string Path { get; set; }
    public int Rating { get; set; }
    public Statistics Stats { get; set; }
} 
```

这是 XAML：

```
<DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True" ItemsSource="{Binding}" Margin="56,49,12,12" Name="booksDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" ColumnWidth="*" MinWidth="400" MinHeight="250">
        <DataGrid.Columns>
            <DataGridTextColumn x:Name="titleColumn" Binding="{Binding Path=Title}" Header="Title" Width="2*" />
            <DataGridTextColumn x:Name="authorColumn" Binding="{Binding Path=Author}" Header="Author" Width="*" />
            <DataGridTextColumn x:Name="tagsColumn" Binding="{Binding Path=Tags}" Header="Tags" Width="*" />
            <DataGridTextColumn x:Name="yearColumn" Binding="{Binding Path=Year}" Header="Year" Width="*" />
            <DataGridTextColumn x:Name="ratingColumn" Binding="{Binding Path=Rating}" Header="Rating" Width="*" />
        </DataGrid.Columns>
</DataGrid> 
```

但我想显示的评级不是数字，而是五颗星的图像。如何将 int 值转换为带有图像的面板之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:00:11.000

你可以尝试这样的事情：

```
class Book
{
    public string Title { get; set; }
    public string Author { get; set; }
    public string Tags { get; set; }
    public string Year { get; set; }
    public string Description { get; set; }
    public string Path { get; set; }
    public int Rating { get; set; }
    public Statistics Stats { get; set; }

  public string displayRating 
    {
        get
        {
            if (Rating > 0)
            {
                var temp = "";
                for (int i = 0; i < Rating; i++)
                {
                    temp += "*";
                }
                return temp;
            }
            return "No rating found";
        } 
    }
} 
```

如果您的`Rating`属性 = 5，则`displayRating`属性将为`"*****"`. 您可以像这样将该属性绑定`displayRating`到您的gridview：

```
 <DataGridTextColumn x:Name="ratingColumn" Binding="{Binding Path=displayRating}" Header="Rating" Width="*" /> 
```

**编辑：**

如果您需要的最大星星数量不是一个超级大的数字（例如 30+），您可以为每个评级制作一个 .jpg。所以你用 1* 制作一个 .jpg 文件，用 2* 制作一个 .jpg 文件。然后在你的 displayRating 字符串中执行以下操作：

```
 public string displayRating 
    {
        get{ return "pathToYourJpg" + Rating + ".jpg";}
    } 
```

假设您有以下 Jpg：

```
c:/users/desktop/rating1.jpg
c:/users/desktop/rating2.jpg
c:/users/desktop/rating3.jpg
c:/users/desktop/rating4.jpg 
```

如果您的评分为 4，则 displayProperty 评分将返回 `"c:/users/desktop/rating4.jpg"`使用此路径将其绑定到您的数据网格。

像这样的东西（不确定，我自己实际上没有做过，但应该是这样的）：

```
<Image Source="{Binding Path=displayRating}" Stretch="Fill" Height="100" Width="100" /> 
```

这只是我的想法..这是你可以做到的一种方式，而不是说这是最好的:)

# android - Android 可搜索字典

> ID：14175670
> 
> 赞同：0
> 
> 时间：2013-01-05T19:44:49.367
> 
> 标签：android, android-sqlite

我对 Android 比较陌生，我正在开发我的第一个应用程序，字典。到现在为止，我能够显示单词列表并提供一种在书签列表中添加单词的机制，但我不是能够弄清楚如何在 Sqlite 中使用 fts3 添加搜索功能。我需要的是在用户在应用程序中搜索特定单词时提供建议。有人可以告诉我如何进行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:44:05.607

[AutoCompleteTextView](http://developer.android.com/reference/android/widget/AutoCompleteTextView.html)将为您提供帮助。

# asp.net - 您的 SQL 语句的某些部分嵌套得太深。重写查询或将其分解为更小的查询

> ID：14175675
> 
> 赞同：3
> 
> 时间：2013-01-05T19:45:49.730
> 
> 标签：asp.net, asp.net-mvc, entity-framework, linq-to-entities

我在我的 asp.net mvc Web 应用程序中有以下方法，并且我使用实体框架作为数据访问层：-

```
 public IEnumerable<AaaUserContactInfo> getcontactinfo(long[] id)
        {
var organizationsiteids = (from accountsitemapping in entities.AccountSiteMappings
where id.Any(accountid => accountsitemapping.ACCOUNTID == accountid)
select accountsitemapping.SITEID).ToList();

var usersdepts = from userdept in entities.UserDepartments
join deptdefinition in entities.DepartmentDefinitions on userdept.DEPTID equals deptdefinition.DEPTID

where organizationsiteids.Any(accountid => deptdefinition.SITEID == accountid)

var contactsinfos = from contactinfo in entities.AaaUserContactInfoes 
                                join userdept in usersdepts on  contactinfo.USER_ID equals userdept.USERID

                                 select contactinfo;

            return contactsinfos; 
```

但是如果记录的数量很大，那么我会得到以下错误：-

> 您的 SQL 语句的某些部分嵌套得太深。重写查询或将其分解为更小的查询。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Data.SqlClient.SqlException：您的 SQL 语句的某些部分嵌套得太深。重写查询或将其分解为更小的查询。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [SqlException (0x80131904): 你的 SQL 语句的某些部分嵌套太深。重写查询或将其分解为更小的查询。]
> System.Data.SqlClient.SqlConnection.OnError（SqlException 异常，布尔 breakConnection，Action 1 完成，Int32 超时，Task& 任务，布尔 asyncWrite）+577 System.Data.SqlClient.SqlCommand .RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String 方法) +107 System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior 行为, String 方法) +288 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior 行为) +180`1 wrapCloseInAction) +388
> System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) +688
> System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) +4403
> System.Data.SqlClient.SqlDataReader.TryConsumeMetaData() +82
> System.Data.SqlClient.SqlDataReader.get_MetaData() +135
> System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +6665229
> System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite) +6667096
> System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`
> 
> System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands（EntityCommand entityCommand，CommandBehavior 行为）+689

虽然如果返回的记录数很少，那么代码可以正常工作，那么可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T18:17:38.230

根据评论中上述重复问题的答案，尝试以下作为第一个查询的 where 子句，因为这很可能是所有麻烦的问题：

`where id.Contains(accountsitemapping.ACCOUNTID)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:09:26.410

我很想删除那里的所有联接并单独进行查找。

那样可能会适得其反，但如果你

```
var organizationsiteids = (from accountsitemapping in entities.AccountSiteMappings
where id.Any(accountid => accountsitemapping.ACCOUNTID == accountid)
select accountsitemapping.SITEID).ToList(); 
```

然后将其保存在内存中，遍历该集合并使用它从您的数据库中获取其余详细信息，它既可以简化查询，也可以解决错误。

然而，作为对您的实际问题的回答，最有可能生成的 SQL 是在幕后生成一个 SQL 连接，该连接具有许多连接条件，或者嵌套查询供 SQL 服务器处理。

你可以做两件事来帮助解决这个问题。

1) 如果您有权访问正在使用的 SQL 服务器，请使用 SQL Server Profiler 工具，并查看正在生成的 SQL 代码。或2）（我不记得如何做到这一点）但是获得EF / L2S或您使用什么来将SQL输出到Visual Studio中的调试/输出窗口。

你可能想做的最后一件事。

下载 LinqPad ( [http://www.linqpad.net/](http://www.linqpad.net/) ) 并使用它在您的代码中重现查询，然后您可以在沙盒中坐下来玩 Linq 语句，以帮助您了解什么是继续。

除非您可以发布正在生成的 SQL（选项 1 是首选方式），否则我无法提供更多帮助，而且我现在要在晚上登出互联网 :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-12T14:00:42.563

另一种解决方案是遍历记录以获取另一个记录并聚合到最终列表。

它不是最快的，不是美丽的，而是会解决的。

# java - 密码广播接收器根本不工作

> ID：14175680
> 
> 赞同：0
> 
> 时间：2013-01-05T19:47:20.173
> 
> 标签：java, android, broadcastreceiver

我正在开发一个应用程序（主要供私人使用），我想在其中实现一个密码系统。

我已经设置了以下广播接收器，但是当我进入`*#*#887755#*#*`它时，它不会启动接收器。

为什么是这样？请问谁能告诉我是什么问题？

`AndroidManifest.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.liamwli.spyware.usertrack"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="7"
        android:targetSdkVersion="10" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".ProcessSMS"
            android:label="@string/app_name" >
        </activity>
        <activity
            android:name=".ActivityConfig"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="com.liamwli.spyware.usertrack.ACTIVITYCONFIG" />
            </intent-filter>
        </activity>

        <receiver android:name=".CodeReceive" >
            <intent-filter>
                <action android:name="android.provider.Telephony.SECRET_CODE" />

                <data
                    android:host="887755"
                    android:scheme="android_secret_code" />
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

`CodeReceive.java`：

```
package com.liamwli.spyware.usertrack;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.widget.Toast;

class CodeReceive extends BroadcastReceiver {

    @Override
    public void onReceive(Context arg0, Intent arg1) {
        // TODO Auto-generated method stub

        Toast.makeText(arg0, "Worked", Toast.LENGTH_SHORT).show();

        Intent i = new Intent(arg0, ActivityConfig.class);
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        arg0.startActivity(i);

    }

} 
```

我没有收到*任何*logcat 输出，并且我尝试添加`android:exported="true"`到接收器，但是没有区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T11:01:33.617

我发现这是由于 Android 3.1+ 的变化

广播接收器现在将无法工作，直到应用程序在 Android 3.1+ 上启动，因此该应用程序将无法工作。

绕过它的方法是将其安装为系统应用程序，或者允许用户手动启动它，然后隐藏图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:54:05.210

尝试使用完整的包名

```
<receiver android:name="com.something.something.CodeReceive" > 
```

# java - 找到封闭的 GeneralPath 包围的区域

> ID：14175685
> 
> 赞同：0
> 
> 时间：2013-01-05T19:47:41.803
> 
> 标签：java, geometry

> **可能重复：**
> [如何计算 java.awt.geom.Area 的面积？](https://stackoverflow.com/questions/2263272/how-to-calculate-the-area-of-a-java-awt-geom-area)

我不知道如何开始，希望有人能提供帮助？

我有一个封闭的`java.awt.geom.GeneralPath`，我尝试测量正方形（以*squarepixel* ( ) 为单位的*面积*）。*`point ^ 2`*

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:50:26.687

您可以使用格林定理并进行轮廓积分来计算面积。使用高斯求积以分段方式沿离散化路径积分。

这向您展示了它是如何工作的：

[http://mathinsight.org/greens_theorem_find_area](http://mathinsight.org/greens_theorem_find_area)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:02:39.260

因为`GeneralPath`implements `Shape`，你可以计算返回的`contains()`每个`true`像素的次数。如果需要，您可以通过.`Rectangle``getBounds()``createTransformedShape()``AffineTransform`*

# visual-studio - WiX 不嵌入二进制文件

> ID：14175686
> 
> 赞同：3
> 
> 时间：2013-01-05T19:47:46.237
> 
> 标签：visual-studio, wix, installation

我正在使用 WiX 创建我的产品安装程序。由于某种原因，它不再将 .exe 和 .dll 嵌入到安装程序中。所以我有这个：

```
<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="ProgramFilesFolder">
    <Directory Id="USERSPECIFIEDDIR" Name="My-app-name" />
  </Directory> 
```

它会在名为 My-app-name 的文件夹旁边创建一个 .msi，其中包含应用程序所需的所有 .exe 和 dll 文件。如果我从那里运行安装程序，没关系，但是如果我将 msi 移到其他地方（没有子目录），它会出错，因为它找不到文件。我如何告诉 WiX 将所有二进制文件嵌入到安装程序中？

如果有帮助，这里有一些来自我的 wxs 的其他片段。如果您需要任何其他信息，请告诉我。哦，我直接从 Visual Studio 2008 使用 wix。

```
<DirectoryRef Id="USERSPECIFIEDDIR">
  <Component Id="MainExe" Guid="580F8F15-C06C-49A7-ADDC-56C96580DC0D">
    <File Id="MainExe" Name="OrderMonkey.exe" KeyPath="yes" />
  </Component>
  <Component Id="OMEmailerExe" Guid="3B0AECC3-67E5-40B3-83CB-9B84FE965ED8">
    <File Id="OMEmailerExe" Name="OMEmailer.exe" />
  </Component>
  <Component Id="migradomDLL" Guid="37E1BCAE-EB39-4DF5-88C7-AE74CA5EA171">
      <File Id="migradom" Name="MigraDoc.DocumentObjectModel.dll" />
  </Component>
  <Component Id="migrarenderDLL" Guid="C2910B9E-0B06-467A-853C-7651BE7BD9E4">
        <File Id="migrarender" Name="MigraDoc.Rendering.dll" />
  </Component>
  <Component Id="migrartfDLL" Guid="CEBE4DE9-7CA0-4F48-A8B1-1D46E4E48B66">
          <File Id="migrartf" Name="MigraDoc.RtfRendering.dll" />
  </Component>
  <Component Id="mysqldataDLL" Guid="2E474737-474C-4146-8E67-D3837B5DB862">
            <File Id="mysqldata" Name="MySql.Data.dll" />
  </Component>
  <Component Id="pdfchartingDLL" Guid="7467B6C2-BE38-4283-B179-9FA94C4A087F">
              <File Id="pdfcharting" Name="PdfSharp.Charting.dll" />
  </Component>
  <Component Id="pdfsharpDLL" Guid="39F23E36-BF9C-40C1-8190-6A3554B879BC">
                <File Id="pdfsharp" Name="PdfSharp.dll" />
  </Component>
  <Component Id="sqliteDLL" Guid="B043CF20-8DC2-4A10-AE4B-4721263A111E">
    <File Id="sqlite" Name="System.Data.SQLite.dll" KeyPath="yes" />
  </Component>
</DirectoryRef>
<DirectoryRef Id="ApplicationProgramsFolder">
  <Component Id="ApplicationShortcut" Guid="414E91FD-7410-492C-9D48-8125C6ECCF0B">
    <Shortcut Id="ApplicationStartMenuShortcut"
              Name="Order Monkey"
              Description="Order Monkey Orders and Quotes"
              Target="[USERSPECIFIEDDIR]OrderMonkey.exe"
              WorkingDirectory="USERSPECIFIEDDIR" />
    <Shortcut Id="ApplicationOfflineStartMenuShortcut"
              Name="Order Monkey Offline"
              Description="Order Monkey Orders and Quotes"
              Target="[USERSPECIFIEDDIR]OrderMonkey.exe"
              WorkingDirectory="USERSPECIFIEDDIR" 
              Arguments="-offline" />
    <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
    <RegistryValue Root="HKCU" Key="Software\Microsoft\OrderMonkey" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
  </Component>
</DirectoryRef>

<Feature Id='Complete' Level='1' Title='Order Monkey Complete' Description='The complete package' ConfigurableDirectory='TARGETDIR' Display='expand'>
  <ComponentRef Id='MainExe' />
  <ComponentRef Id='OMEmailerExe' />
  <ComponentRef Id='migradomDLL' />
  <ComponentRef Id='migrarenderDLL' />
  <ComponentRef Id='migrartfDLL' />
  <ComponentRef Id='mysqldataDLL' />
  <ComponentRef Id='pdfchartingDLL' />
  <ComponentRef Id='pdfsharpDLL' />
  <ComponentRef Id='sqliteDLL' />
  <ComponentRef Id='ApplicationShortcut' />
  <ComponentRef Id='AppData' />
</Feature> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T20:26:05.313

使用这些元素：

```
<Package Compressed="yes" InstallScope="perMachine" />
<MediaTemplate EmbedCab="yes" /> 
```

`Package/@Compressed="yes"`创建橱柜而不是松散的文件。`MediaTemplate/@EmbedCab="yes"`将默认文件柜嵌入到 .msi 中。

# xml - 解析 XML 以获取 AutoHotKey 中的值？

> ID：14175690
> 
> 赞同：1
> 
> 时间：2013-01-05T19:48:06.017
> 
> 标签：xml, xpath, autohotkey

我正在尝试从 XML 文件中获取要检索的值。**[但是，使用在这里](http://www.autohotkey.com/board/topic/16137-xpath-v3-read-and-write-xml-documents-with-xpath-syntax/)**找到的 xpath 脚本。我似乎无法让它工作。这是我遇到问题的地方：

```
xml := xpath_load("C:\Users\Will\Desktop\Hotkey\IsogenID.xml")
MsgBox % xml 
```

文件在那里，路径是正确的。但是，xpath_load 函数将“0”的值返回到 xml 变量中。它应该加载整个 XML 文件，以便以后对其进行解析。

这是 XML 文件：

```
<itemLookup>
    <version>1.0</version>
    <typeID>37</typeID>
    <typeName>Isogen</typeName>
</itemLookup> 
```

我正在尝试解析位于现场的**37个。**

知道可能出了什么问题或另一种解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:25:42.683

自动热键论坛上的某个人给了我这个问题的答案，所以我想我也会在这里发布。

```
xmldata = ; replace with fileread as you already have done
(join`r`n
<?xml version="1.0"?>
<itemLookup>
    <version>1.0</version>
    <typeID>37</typeID>
    <typeName>Isogen</typeName>
</itemLookup>
)
doc := ComObjCreate("MSXML2.DOMDocument.6.0")
doc.async := false
doc.loadXML(xmldata)

DocNode := doc.selectSingleNode("//itemLookup/typeID")
DocText := DocNode.text
MsgBox %DocText% 
```

# c# - 为什么 TextElemt 类不是从 Control 类派生的？

> ID：14175691
> 
> 赞同：0
> 
> 时间：2013-01-05T19:48:14.667
> 
> 标签：c#, wpf, block, paragraph

考虑这个 Xaml：

```
<RichTextBox>
<Document>
   <Paragraph> 
       <Run Text="FirstWord " />
       <Run Text="SecondWord"/>
   </Paragraph >
   <Paragraph>  
       <Run Text="FirstWord " />
       <Run Text="SecondWord"/>
   </Paragraph >
 </Document>
</RichTextBox > 
```

现在，假设由于某些原因我使用这样的东西：

```
<StackPanel Orientation = "Vertical">
   <StackPanel Orientation = "Horizontal">  // as a Paragraph
       <TextBlock Text="FirstWord " />
       <TextBlock Text="SecondWord"/>
   </StackPanel>
   <StackPanel Orientation = "Horizontal">  // another Paragraph
       <TextBlock Text="FirstWord " />
       <TextBlock Text="SecondWord"/>
   </StackPanel>
</StackPanel> 
```

[Run](http://msdn.microsoft.com/en-us/library/system.windows.documents.run%28v=vs.95%29.aspx)或[Paragraph](http://msdn.microsoft.com/en-us/library/system.windows.documents.paragraph%28v=vs.95%29.aspx)或其他[TextElement](http://msdn.microsoft.com/en-us/library/system.windows.documents.textelement%28v=vs.95%29.aspx)不是控件，因此它们没有`ArrangeOverride`或方法`MesureOverride`。我的问题是为什么它们不是控件？是因为性能问题还是测量尺寸、排列和渲染 a`TextElement`和 a之间没有太大区别`Control`？换句话说，第一个 Xaml 比第二个 Xaml 有什么好处（除了它的外观）？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T07:23:26.097

它们不是控件，因为它们与文档的其余部分没有分开。您在文档中设置的不是子控件，而是文档的内容。渲染完全在 RichTextBox 内完成。

第一个示例和第二个示例之间的主要区别在于 RichTextBox 允许您创建具有不同格式的部分文本的流动文本。虽然可以通过使用普通的 TextBlocks 来做到这一点，但很难对换行符和动态调整大小等内容进行微调。

# php - .htaccess 和多个条件

> ID：14175693
> 
> 赞同：1
> 
> 时间：2013-01-05T19:48:21.870
> 
> 标签：php, .htaccess, url, mod-rewrite

对于这个显示

```
website.com/city-name 
```

我正在使用这个`.htaccess`规则：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?skill=$1 [L,QSA] 
```

它正在工作。现在我需要添加这个友好的 URL：

```
website.com/applicant/12 #(12 is applicant's ID)
#or
website.com/applicant/12-john-doe #(id + name) 
```

请在这个条件下帮助我`.htaccess`吗？不幸的是，我不是很熟悉`.htaccess`。

谢谢

**编辑：**我尝试过的：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?skill=$1 [L,QSA]
RewriteRule ^applicant/(.*) index.php?id=applicant&applicant_id=$1 [L,QSA] 
```

当我注释掉第 4 行时，最后一条规则起作用（但不起作用`website.com/city-name`）。如何合并这两个规则？

**EDIT2： 碰撞，有人会帮助我吗？**

# ruby-on-rails - 创建新记录时是否可以获取用户的Mac地址？

> ID：14175695
> 
> 赞同：4
> 
> 时间：2013-01-05T19:48:29.493
> 
> 标签：ruby-on-rails

是否可以获得发布新记录的用户的 MAC 地址？
如果我有名为 的列`mac_address`，我如何编写控制器以将 MAC 地址放入该列？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-30T03:01:51.803

您可以接听`request.ip`并调用 ping。这应该将 ip 放入您机器的 arp 缓存中。通过转储 arp 缓存，您可以匹配 MAC 地址。

```
`ping -c 1 #{request.ip}`
sleep(10) # For dramatic effect
arptable = `arp -a`
entries = arptable.split("\n")
ipmap = {}
entries.each do |e|
  ent = e.split(" ")
  ipmap["#{ent[1].gsub(/\(|\)/, "")}"] = ent[3]
end
puts ipmap["#{request.ip}"] 
```

此代码在 osx mavericks 上进行了测试，工具和格式可能在 linux/bsd/solaris 上有所不同，但应该是相同的方法，另一个警告是它只适用于您的本地 Intranet/网段。

# 更新

在 amazon linux 上检查，格式似乎相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-05T20:03:17.763

用户的 mac 地址不是 Web 请求的一部分。

我知道这不是您的问题，但您可以使用请求对象获取他们的 IP 地址：

```
request.ip 
```

在您的`create`操作中，您可能会有以下内容（假设您有一个 column `ip_address`）：

```
def create
  @item = Item.new(params[:item])
  @item.ip_address = request.ip
  if @item.save
    ...
  end
end 
```

# c# - Modelstate 未通过 Jquery POST 从 JSON 更新值

> ID：14175696
> 
> 赞同：0
> 
> 时间：2013-01-05T19:48:36.153
> 
> 标签：c#, asp.net-mvc, jquery

基本上我从下拉列表中获取一个值并通过 AJAX 将其传递给客户端方法。基于这个值，我得到数据，我想把它放到一个文本框中。

```
<script type="text/javascript">        
    $('#dropdownlist').change(function () {
        $.post('/Index/GetJSON/' + this.value, null,                               
            function (data) {
                $('#somefield').val(data)                                  
            });
    });
 </script> 
```

所以这个方法被调用：

```
[HttpPost]
public JsonResult GetJSON(int ID)
{
    return Json(data);
} 
```

标记

```
@Html.EditorFor(m => m.somefield) 
```

somefield 确实在视觉上改变了它的价值。但是当我检查它的价值时它没有得到更新。好像 val(data.ID) 没有注册到模型。由于我的代码，我也不能调用 ModelState.Clear() ......

我使用这种方法而不是 Ajax.Form 和部分视图的原因是因为我在 HTML.BeginForm （已提交）中拥有所有标记，其中许多不同的下拉列表通过 AJAX 通过文本框进行交互，并且您不能嵌套 Ajax.Form与 HTML.BeginForm。因此我无法通过 Ajax.Form 提交对模型的更改并调用 ModelState.Clear()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:02:06.243

`.val()`如果您希望更改反映在元素 value attr use 中，请设置元素的 value 属性[`.attr()`](http://api.jquery.com/attr/)

```
$('#somefield').attr('value', data) 
```

# python - shutil 复制树错误

> ID：14175699
> 
> 赞同：0
> 
> 时间：2013-01-05T19:48:58.003
> 
> 标签：python

> **可能重复：**
> [错误说 \\\\Ref\\builds/out 存在但它不存在](https://stackoverflow.com/questions/14176227/error-says-ref-builds-out-exists-but-it-doesnt-exist)

我正在尝试使用以下代码复制源代码树并遇到此错误，不知道为什么会出现此错误？错误说 \\Ref\builds/out 存在但它不存在，任何人都对什么有任何输入这里错了吗？

```
//local/mnt/workspace/04.01_HY11/out
\\Ref\builds/out
copying
Traceback (most recent call last):
  File "test.py", line 21, in <module>
    main()
  File "test.py", line 18, in main
    copytree(src,dst)
  File "test.py", line 11, in copytree
    shutil.copytree(s, d)
  File "/pkg/qct/software/python/2.5.2/.amd64_linux26/lib/python2.5/shutil.py", line 110, in copytree
    os.makedirs(dst)
  File "/pkg/qct/software/python/2.5.2/.amd64_linux26/lib/python2.5/os.py", line 171, in makedirs
    mkdir(name, mode)
OSError: [Errno 17] File exists: '\\\\Ref\\builds/out' 
```

Python代码

```
import os,shutil

def copytree(src, dst, symlinks=False, ignore=None):
    for item in os.listdir(src):
        s = os.path.join(src, item)
        print s
        d = os.path.join(dst, item)
        print d
        if os.path.isdir(s):
            print "copying"
            shutil.copytree(s, d, symlinks, ignore)
        else:
            shutil.copy2(s, d)
def main ():
    src="//local/mnt/workspace/04.01_HY11"
    dst="\\\\Ref\\builds"
    copytree(src,dst)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:43:29.707

错误是因为目标目录已经存在，您必须先将其删除。

# php - 如何按父ID对数组进行分组

> ID：14175701
> 
> 赞同：0
> 
> 时间：2013-01-05T19:49:11.343
> 
> 标签：php, arrays

这是我的数组输出

```
Array
(
    [1] => Array
        (
            [id] => 1
            [name] => Category A
            [parent] => 0
        )
    [2] => Array
        (
            [id] => 2
            [name] => Sub Cat A - 1
            [parent] => 1
        )
    [3] => Array
        (
            [id] => 3
            [name] => Sub Cat A - 2
            [parent] => 1
        )
    [4] => Array
        (
            [id] => 4
            [name] => Sub Cat A 2 - 1
            [parent] => 3
        )
    [5] => Array
        (
            [id] => 5
            [name] => Category B
            [parent] => 0
        )
    [6] => Array
        (
            [id] => 6
            [name] => Sub Cat B - 1
            [parent] => 5
        )
    [7] => Array
        (
            [id] => 7
            [name] => Category C
            [parent] => 0
        )
) 
```

我尝试过这个但输出错误。

```
foreach ($categories as $key => $category) {
    $group[$category['parent']][$key] = $category;
} 
```

问题：如何重新组合数组&我的期望输出应该是这样的

```
Category A
    Sub Cat A - 1
    Sub Cat A - 2
        Sub Cat A 2 - 1
Category B
    Sub Cat B - 1
Category C 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:41:27.883

试试这个代码；

```
<?php
$as // your array
$new_as = array();
foreach ($as as $ind => $a) {
    $new_as[$a['id']] = $a;
    $new_as[$a['id']]['children'] = array();
}

foreach ($new_as as $ind => &$new_a) {
    $parent = $new_as[$ind]['parent'];
    if(isset($new_as[$parent])){
        $new_as[$parent]['children'][] = & $new_as[$ind];
    }
}
echo '<pre>';
foreach ($new_as as $ind => &$new_a) {
    if ($new_a['parent'] == 0) {
        echo $new_a['name'];
        echo "\n";
        print_children($new_a['children'],1);
    }
}
echo '</pre>';    
function print_children($children, $level = 0)
{
    foreach ($children as $child) {
        echo str_repeat("    ", $level);
        echo $child['name'];
        echo "\n";
        print_children($child['children'], $level + 1);
    }
} 
```

# binding - MonoTouch 自定义绑定不适用于 Delegate 中的某些方法

> ID：14175703
> 
> 赞同：0
> 
> 时间：2013-01-05T19:49:25.020
> 
> 标签：binding, xamarin.ios

我有一个本地库的以下协议，我正在尝试为其编写 MonoTouch 绑定（它还有一个名为 Brsp 的接口部分）。

```
@protocol BrspDelegate <NSObject>
@required
- (void)brsp:(Brsp*)brsp OpenStatusChanged:(BOOL)isOpen;
- (void)brsp:(Brsp*)brsp SendingStatusChanged:(BOOL)isSending;
@optional
- (void)brspDataReceived:(Brsp*)brsp;
- (void)brsp:(Brsp*)brsp ErrorReceived:(NSError*)error;
- (void)brspModeChanged:(Brsp*)brsp BRSPMode:(BrspMode)mode;
@end 
```

MonoTouch 绑定：

```
[BaseType(typeof(NSObject))]
[Model]
interface BrspDelegate 
{
    [Abstract]
    [Export("brsp:OpenStatusChanged:"), EventArgs("OpenStatus")]
    void OpenStatusChanged(Brsp brsp, bool isOpen);

    [Abstract]
    [Export("brsp:SendingStatusChanged:"), EventArgs("SendingStatus")]
    void SendingStatusChanged(Brsp brsp, bool isSending);

    [Export("brspDataReceived:")]
    void DataReceived(Brsp brsp);

    [Export("brsp:ErrorReceived:"), EventArgs("Error")]
    void ErrorReceived(Brsp brsp, NSError error);

    [Export("brspModeChanged:"), EventArgs("Mode")]
    void ModeChanged(Brsp brsp, BrspMode mode);
} 
```

正在调用打开状态，发送状态和错误接收方法，但模式更改不起作用。因此，在 Brsp 类中直接引用了 Delegate，因此该部分应该可以工作。在某一时刻，我得到了 modechanged 也可以工作，所以我知道当我在 Brsp 类上调用“changeMode”时会调用它。但是后来我把它搞砸了，现在它不再起作用了......

另外，现在我使用的是 Delegate 私有类，而不是基于事件的方法。因为当我尝试为上述方法之一连接生成的事件时，应用程序崩溃而没有来自 MonoTouch 的任何错误或警告。

我怀疑绑定不是 100% 正确的，所以这些方法没有正确地粘合在一起，但是我尝试了很多很多不同的东西，AFAIK 这应该可以工作......

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:17:43.363

您的绑定

```
- (void)brspModeChanged:(Brsp*)brsp BRSPMode:(BrspMode)mode; 
```

缺少一个参数。尝试：

```
[Export("brspModeChanged:BRSPMode:"), EventArgs("Mode")]
void ModeChanged(Brsp brsp, BrspMode mode); 
```

# iphone - 没有可用的预置 iOS 设备。连接 iOS 设备或选择 iOS 模拟器作为目标

> ID：14175707
> 
> 赞同：1
> 
> 时间：2013-01-05T19:49:31.247
> 
> 标签：iphone, xcode4, sdk

> 没有可用的预置 iOS 设备。连接 iOS 设备或选择 iOS 模拟器作为目标。

我有此应用程序的设备配置文件...我应该在哪里更正此问题？我正在使用 XCode 6.0，而我的 iPhone 版本是 6.0.1，我是否需要将我的 Mac SDK 更新到 6.0.1？

# javascript - XML 到 JavaScript 数组 [谷歌地图]

> ID：14175708
> 
> 赞同：0
> 
> 时间：2013-01-05T19:49:34.690
> 
> 标签：javascript, google-maps

我需要从 xml 创建 Javascript 数组 ..

我使用 ajax 从 poly php 获取 xml 数据。一切都好。

我必须像这样创建数组：

```
 point = [
                 new google.maps.LatLng(40.9921196514,47.8604733650 ),
                 new google.maps.LatLng(40.9922511293,47.8606186245 ),

        ]; 
```

代码

```
 downloadUrl("poly.php", function(data) {
        var xml = data.responseXML;
        var polys = xml.documentElement.getElementsByTagName("poly");
        for (var i = 0; i < polys.length; i++) {

             var pid  = polys[i].getAttribute("pid");

   point = [
          new google.maps.LatLng(parseFloat(polys[i].getAttribute("plat")), parseFloat(polys[i].getAttribute("plng")) );
        ]; 
```

我已经这样做了，但它不起作用..（（

PS 我从 MySQL 获取数据。

...

xml:

```
 <polys>
<poly pid="1" pstatus="status1" plat="40.992638" plng="47.860474"/>
<poly pid="2" pstatus="status2" plat="40.992252" plng="47.860619"/>
</polys> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:42:28.553

我可以假设您使用`downloadUrl`googles [util.js](http://code.google.com/p/gmaps-samples-v3/source/browse/trunk/xmlparsing/util.js?r=16)中的功能吗？

是时：`data`已经是文档，不需要访问`data.responseXML`

每次尝试访问 的属性`xml`都会导致错误，`xml`因为`undefined`

替换这个：

```
 var xml = data.responseXML;
    var polys = xml.documentElement.getElementsByTagName("poly"); 
```

和：

```
 var polys = data.documentElement.getElementsByTagName("poly"); 
```

* * *

 **有一个语法错误：

```
point = [
          new google.maps.LatLng(parseFloat(polys[i].getAttribute("plat")), parseFloat(polys[i].getAttribute("plng")) );
        ]; 
```

删除分号：

```
("plng")) );
//---------^ 
```

但是要获得所需的结果，您必须在循环外创建点数组：

```
var point=[]; 
```

并将 LatLng 添加到循环内：

```
point.push(new google.maps.LatLng(parseFloat(polys[i].getAttribute("plat")),  
                                  parseFloat(polys[i].getAttribute("plng")))); 
```**

# java - 如何使用java在操作系统中查找用户名

> ID：14175709
> 
> 赞同：0
> 
> 时间：2013-01-05T19:49:53.210
> 
> 标签：java, operating-system

> **可能重复：**
> [在java中获取登录用户名](https://stackoverflow.com/questions/797549/get-login-username-in-java)

我正在寻找一种方法来在 java 的操作系统中找到用户的名称，这样我就可以获得正确的目录，以了解如何找出用户的 appdata 上是否缺少文件。我正在使用这段代码：

`File myFile = new File("C:" + File.separator + "Users" + File.separator, "Matty" + File.separator, "AppData" + File.separator, "Roaming");

System.out.println(myFile.isDirectory());

if (myFile.isDirectory() = true)

{
//这将安装程序，但我需要找出它是否已经安装

安装程序.install()

}`

必须有一个代码，因为大多数安装人员必须知道用户的名字是什么！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:52:27.267

尝试：

```
public class OSName
{
    public static void main(String[] args)
    {
        System.out.println("Your username is: " + System.getProperty("user.name"));
    }
} 
```

相关文档在[这里](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#getProperty%28java.lang.String%29)和[这里](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)。

# c# - 类似于在 Windows Phone 中设置小时列表的滚动列表

> ID：14175717
> 
> 赞同：1
> 
> 时间：2013-01-05T19:50:36.843
> 
> 标签：c#, list, windows-phone

我想使用看起来像这个列表的组件，您可以在 Windows Phone 中设置小时时使用它。这个组件名称是什么？如何为其添加元素？

![在此处输入图像描述](../Images/22720c48ec2ef7153647c8027ca072d0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:02:44.707

它在 Silverlight 工具包中的组件是 LoopingSelector，它使用户能够以简单的方式实现各种循环场景。您可以查看该[链接](http://windowsphonegeek.com/articles/WP7-LoopingSelector-in-depth--Part1-Visual-structure-and-API)以获取更多信息。

# vb.net - 使用数据表和列表框将变量传递给新表单

> ID：14175718
> 
> 赞同：0
> 
> 时间：2013-01-05T19:50:49.293
> 
> 标签：vb.net

我目前正在尝试编写一个像地址簿这样的应用程序。列表框工作正常，它正确地显示了一切。但我需要将所选列表框项的 id 传递给另一个表单。我在 Form2 中得到了这样的代码：

```
Private myTable As New DataTable()
Public Sub LoadXml(sender As Object, e As EventArgs) Handles Me.Load

    With myTable.Columns
        .Add("DisplayValue", GetType(String))
        .Add("HiddenValue", GetType(Integer))
    End With
    myTable.DefaultView.Sort = "DisplayValue ASC"

    ListBox1.DisplayMember = "DisplayValue"
    ListBox1.ValueMember = "HiddenValue"
    ListBox1.DataSource = myTable
    Dim doc As New Xml.XmlDocument
    doc.Load("c:\address.xml")
    Dim xmlName As Xml.XmlNodeList = doc.GetElementsByTagName("name")
    Dim xmlSurname As Xml.XmlNodeList = doc.GetElementsByTagName("surname")
    Dim xmlId As Xml.XmlNodeList = doc.GetElementsByTagName("id")
    For i As Integer = 0 To xmlName.Count - 1
        Dim nazwa As String = xmlName(i).FirstChild.Value + " " + xmlSurname(i).FirstChild.Value
        myTable.Rows.Add(nazwa, xmlId(i).FirstChild.Value)
        MsgBox(myTable.Rows(i).Item(1).ToString)
    Next i
    ListBox1.Sorted = True
End Sub 
```

稍后在代码中我有事件：

```
Public Sub ListBox1_DoubleClick(sender As Object, e As EventArgs) Handles ListBox1.DoubleClick

End Sub 
```

我想知道如何从 DataTable 中为选定的列表框项目调用 id。我希望你明白我的意思，因为我的英语不完美:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T00:18:25.400

Since you have added the XML value `id` to the data table column `HiddenValue` and you have assigned `HiddenValue` as the `ValueMember` for the listbox, once a record is selected in the listbox, id will be available in the listbox's `[SelectedValue][1]` member. For example:

```
Public Sub ListBox1_DoubleClick(sender As Object, e As EventArgs) Handles ListBox1.DoubleClick
    MsgBox("Selected Id: " & ListBox1.SelectedValue.ToString())
End Sub 
```

# php - wordpress 风格的菜单管理器

> ID：14175719
> 
> 赞同：1
> 
> 时间：2013-01-05T19:50:56.747
> 
> 标签：php, jquery-ui, menu, drag-and-drop

我正在尝试使用`php`和为我自己的 CMS 制作一个 WordPress 样式的菜单管理器`jquery-ui`。我已经迈出了第一步，但我真的不知道我应该如何进行，尤其是如何实现菜单项之间的父子关系。我的实际代码看起来像

```
<style>
#sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
#sortable li { margin: 0 5px 5px 5px; padding: 5px; font-size: 1.2em; height: 1.5em; }
html>body #sortable li { height: 1.5em; line-height: 1.2em; }
.ui-state-highlight { height: 1.5em; line-height: 1.2em; }
</style>
<script>
$(function() {
    $( "#sortable" ).sortable({
        placeholder: "ui-state-highlight"
    });
    $( "#sortable" ).disableSelection();
});
</script>       
        <div class="admin_menus">
                            <ul id="sortable">
                            <?php foreach($menus as $menu): ?>
                                <?php if(array_key_exists('children', $menu)):?>         
                                <li class="ui-state-default">
                                 <?= $menu['name'] ?>
                                  <ul class="dropdown-menu_test">
                                    <?php foreach($menu['children'] as $menu_child):?>
                                    <li class="ui-state-default" ><?= $menu_child['name'] ?></li>
                                    <?php endforeach;?>

                                  </ul>

                                </li>
                                <?php else:?>
                                <li class="ui-state-default" ><?= $menu['name'] ?></li>
                                <?php endif;?>
                                <?php endforeach;?>                                                                         
                            </ul>
        </div> 
```

`$menus`从数据库中检索到的菜单项存放在哪里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-09T06:14:08.083

[您可以使用此插件在您的网站http://dbushell.github.io/Nestable/](http://dbushell.github.io/Nestable/)中实现可拖动菜单功能

它使用简单，您可以自己定制。

# php - 如何将特定标签从 RSS XML 导入 MySQL 数据库

> ID：14175720
> 
> 赞同：1
> 
> 时间：2013-01-05T19:51:10.863
> 
> 标签：php, mysql, import, simplexml

我要做的是使用 PHP 的 simpleXML 函数将 RSS XML 提要导入 MySQL 数据库。但是 PHP 脚本唯一要做的就是将 0 写入我的数据库。我在做什么错？

示例 rss.xml

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?xml-stylesheet title="XSL_formatting" type="text/xsl" href="/divers/rss/xslt.php" ?> 
<rss version="2.0"  xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
       <title></title>
       <link></link>
       <description></description>
   <lastBuildDate></lastBuildDate>
   <ttl></ttl>
   <item>
       <title></title>
       <description></description>
       <link></link>
       <guid></guid>
       <pubDate></pubDate>
   </item>
</channel>
</rss> 
```

PHP

```
<?php

  include ('config.php'); 

  $xml_file = "http://xml.xml/rss.xml";
  $xml_load = simplexml_load_string(file_get_contents($xml_file));

  $link = (string)$xml_load->link;
  $guid = (string)$xml_load->guid;

  $sql = "INSERT INTO table (link,guid) VALUES('$link','$guid');";

  mysql_query($sql) or die("Error ".mysql_error());

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:55:08.937

这就是我正在做的事情：

```
$sxml = simplexml_load_file($feedURL); // loads in simple xml format

        foreach ($sxml->entry as $entry) {
            $title = stripslashes($entry->title);
            $summary = stripslashes($entry->summary);
        } 
```

如您所见，我使用`stripsplashes()`.

我想它看起来像：

```
foreach($xml->item as $item) {
  $link = stripslashes($item->link);
  $guid = stripslashes($item->guid);
} 
```

# android - Android照片浏览上传错误：传递结果失败resultinfo{who=null......}

> ID：14175722
> 
> 赞同：0
> 
> 时间：2013-01-05T19:51:37.953
> 
> 标签：android, android-intent, android-camera

每当我尝试单击浏览按钮时，我都想浏览我的画廊并从中选择一张照片并将其显示在新活动中。直到我在同一个活动上显示照片之前没有错误，但是一旦我更改代码以将照片转移到另一个意图上，就会出现强制关闭错误 ![在此处输入图像描述](../Images/ba0bb64a0693fa79fcf303d1a0fa0b39.png)

这是我的代码：

主屏幕 ：

```
Button button = (Button) findViewById(R.id.Button01);
    button.setOnClickListener(new OnClickListener() 
    {
          public void onClick(View arg0) 
          {
                     Intent intent1 = new Intent(MainActivity.this,Edit.class);
             startActivity(intent1);
          }

    }); 
```

另一个屏幕：

```
public class Edit extends Activity 
   {

private String selectedImagePath;
private static final int SELECT_PICTURE = 1;
private ImageView img;

      protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.edit);

    img = (ImageView)findViewById(R.id.ImageView1);

     Intent intent = new Intent();
         intent.setType("image/*");
         intent.setAction(Intent.ACTION_GET_CONTENT);
         startActivityForResult(Intent.createChooser(intent,"Select Picture"), SELECT_PICTURE); 
```

}

```
 public void onActivityResult(int requestCode, int resultCode, Intent data) 
 {

    if (resultCode == RESULT_OK) 
        {
            if (requestCode == SELECT_PICTURE) 
            {
                Uri selectedImageUri = data.getData();
                selectedImagePath = getPath(selectedImageUri);
                System.out.println("Image Path : " + selectedImagePath);
                img.setImageURI(selectedImageUri);
            }
        }

 }

public String getPath(Uri uri) {
        String[] projection = { MediaStore.Images.Media.DATA };
        Cursor cursor = managedQuery(uri, projection, null, null, null);
        int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        cursor.moveToFirst();
        return cursor.getString(column_index);
    } 
```

# c - 如何为基于文本的程序创建 GUI？

> ID：14175723
> 
> 赞同：0
> 
> 时间：2013-01-05T19:51:41.423
> 
> 标签：c, shell, user-interface

我现在完全处于一个基本项目中，它正在用 C 重新编码一个 unix shell。它当然打算在 tty 中工作，这意味着没有 GUI。虽然我想添加一个选项以将其与图形模式一起使用。因为它是一个基于文本的程序，所以当我使用 Gnome（使用 alacarte）启动它时，它会在 Gnome 终端中启动它自己。我要添加的是一种图形界面，例如 Gnome 终端应用程序。有没有一种简单的方法可以将基于文本的程序放在一种带有图形元素的框架中？我想摆脱任何其他应用程序来启动我的 shell，所以当我处于图形模式时（不使用 tty 时）我想要我自己的框架，而不是另一个启动它的应用程序。谁能帮我 ？=)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:25:21.867

您不能使用标准 C 库创建 GUI。不过，您可以使用外部库制作一个。

使用[OpenCV](http://opencv.org/)可以制作 GUI，并且该项目背后有一个大型社区。你可以在他们的网站上找到很多代码示例和教程。此外，您可以将 OpenCV 用于许多其他与[计算机视觉](https://en.wikipedia.org/wiki/Computer_vision)相关的事情。

您还可以使用[GTK+](http://www.gtk.org/)为您的程序编写 GUI。它非常简单，并且易于初学者使用。不过它更侧重于图形，如果您想要外部库所需的其他功能，您可能无法使用 GTK+。

# c++ - 如何从 MSDN 编译动态虚拟通道 C++ 示例

> ID：14175725
> 
> 赞同：2
> 
> 时间：2013-01-05T19:51:44.533
> 
> 标签：c++

在 MSDN 上有一个[C++ 示例，介绍如何创建动态虚拟通道插件](http://msdn.microsoft.com/en-us/library/windows/desktop/bb540854%28v=vs.85%29.aspx)。

我的问题是我不知道如何编译它。

我是否需要创建一个 ATL 项目并`main.cpp`复制粘贴在 msdn 上找到的代码？我怎么称呼这个项目？如果我使用 name 创建 ATL 项目`DVCPlugin`，Visual Studio 2008 会自动创建`DVCPlugin_i.h file`，否则我没有该文件。

`tsvirtualchannels.h`是 Windows 7 SDK 的一部分，所以至少包含我没有问题。

我得到的错误之一是：

> `&CLSID_DVCSamplePlugin`无法识别的标识符

我尝试使用名称创建 ATL 项目，`DVCSamplePlugin`但收到与上述相同的消息。

为了能够编译该源代码，我需要做什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-02T22:50:16.100

我花了几个小时，但我得到了使用 VS 2012 构建的客户端插件的源代码。这是我的步骤。

1.  启动一个名为`DVCPlugin`. 选择 DLL 的选项。
2.  选择对 COM+ 的支持并选中对象注册器的复选框。
3.  添加一个名为`GUID.cpp`DVCPlugin 项目的文件。包含`stdafx.h`在这个文件中。
4.  ATL 给了我一个名为 CompReg 的类，它有自己的 IDL 条目和 GUID。我需要将该 GUID 与`CDVCSamplePlugin`类相关联。
5.  在`DVCPlugin.cpp`中，将 include for 添加`<tsvirtualchannels.h>`到顶部。
6.  将其余的示例代码粘贴到`DllInstall()`.
7.  将行更改`DECLARE_REGISTRY_RESOURCEID(IDR_PLUGIN)`为`DECLARE_REGISTRY_RESOURCEID(IDR_DVCPLUGIN)`。
8.  看起来构建解决方案以静默方式运行`DVCPlugin.rgs`文件中的注册表脚本。不过，我不得不将线程模型更改为免费。
9.  如果 mstsc.exe 是 64 位，则需要 64 位插件 dll 才能使动态发现工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:12:49.873

这只是一些用于测试远程桌面连接的代码 -

> 远程桌面连接 (RDC) 客户端实现了一个“回声”侦听器，该侦听器始终存在并侦听传入连接。当您编写动态虚拟通道 (DVC) 模块的服务器端时，作为快速测试，您可以打开一个名为“ECHO”的端点。从该端点实例化的通道的任何写入都将导致接收到相同的数据。

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/bb540879%28v=vs.85%29.aspx)。此类项目通常包含在某些 SDK 中。这似乎是[Windows 8 SDK的一部分](http://msdn.microsoft.com/en-US/windows/desktop/aa904949)

更新：在蒂姆（见下文）的批评之后，我决定添加这些带有 MSDN 信息的链接 - [远程桌面服务。TS-Teleport：示例说明](http://blogs.msdn.com/b/rds/archive/2007/09/19/ts-teleport-sample-instructions.aspx)和 [远程桌面服务博客。动态虚拟通道](http://blogs.msdn.com/b/rds/archive/2007/09/20/dynamic-virtual-channels.aspx)

# jquery - 使用 jQuery 将 id 应用于列表项链接

> ID：14175730
> 
> 赞同：0
> 
> 时间：2013-01-05T19:52:02.453
> 
> 标签：jquery

我想将 id 添加到无序列表项。不是`<li>`标签，而是`<li>`标签内部，如下所示：

`<li><a href="#" id="Here i want to add an id"></a></li>`

因此，如果您可以看到，在 a 标签内，我想添加一个 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T19:55:19.313

```
$('li > a').attr('id', 'id_to_add'); 
```

理想情况下，您会有一个更具体的选择器`li`。你应该给你`li`的 a`class`或者`id`你可以用来更好地识别它，例如

```
<li class="needs-id">...

$('li.needs-id > a').attr('id', '...'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:05:30.447

您需要确保不会在文档中引入重复的 ID。因此，您需要测试文档中是否已使用 id。`attr('id', 'some_id')`在一组节点上使用，会直接引入重复。因此，您将不得不使用`.each`. 此外，您需要确保不会意外删除现有的 id，这可能会导致不必要的副作用。

```
function generateId(base) {
    generateId.iterator = generateId.iterator || 1;
    base = base || '';
    while (document.getElementById(base + generateId.iterator)) {
       generateId.iterator ++;
    }
    return base + generateId.iterator;
}

$('li > a').each(function() {
    this.id = this.id || generateId();
}); 
```

# html - 避免在移动设备上调整宽度

> ID：14175732
> 
> 赞同：1
> 
> 时间：2013-01-05T12:15:14.547
> 
> 标签：html, mobile

我正在为我的团队打印一些纯文本表格。

由于 txt 文件很难为通用设备呈现，我将代码传递到 HTML 文件中。

现在一切正常，除了 Android 和 BB 设备，因为浏览器正在缩小表格，所以它们变得不可读。

我试过`<div style="width: 500px">`了，但这只是设置最大宽度，而不是最小值。

有什么办法可以避免我的固定宽度表成为真正的固定宽度？

我的简单代码，仅供参考：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<pre>

HERE GOES MY FIXED WIDTH TABLE

</pre>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:11:05.477

尝试使用以下内容设置移动访问的视口窗口：

`<meta name="viewport" content="width=d-width, initial-scale=1, maximum-scale=1">`

用设备的实际像素宽度替换*d-width 。*

# asp.net-mvc-routing - 如何在 ASP.NET MVC 中将区域视图设置为主页？

> ID：14175736
> 
> 赞同：5
> 
> 时间：2013-01-05T19:52:30.617
> 
> 标签：asp.net-mvc-routing, asp.net-mvc-areas

如何在包含区域的 ASP.NET MVC 应用程序中将视图设置为域的主页。我需要一个特定区域的视图作为主页。怎么可能做到这一点？

我尝试使用以下代码但没有成功。

```
public static void RegisterRoutes(RouteCollection routes) {
            routes.MapRoute(
                name: "Home",
                url: "",
                defaults: new { controller = "Home", action = "Index" }, 
                namespaces: new string[] { "WebApp.Areas.UI.Controllers" }
                );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T07:58:33.367

在 Area 文件夹中有一个名为*AreaName* AreaRegistration 的文件，该文件来自 AreaRegistration，它有一个函数 RegisterArea 来设置路由。

区域中的默认路由是*AreaName* /{controller}/{action}/{id}。修改它可以将一个区域设置为默认区域。例如，我将默认路由设置为 {controller}/{action} 以满足我的要求。

```
public class UIAreaRegistration : AreaRegistration
{
        public override string AreaName
        {
            get
            {
                return "UI";
            }
        }

        public override void RegisterArea(AreaRegistrationContext context)
        {
            context.MapRoute(
                "UI_default",
                "{controller}/{action}/{id}", //******
                new {controller = "Home", action = "Index", id = UrlParameter.Optional}
            );
        }
    } 
```

# java - 标记“;”上的 Java 语法错误 预期的

> ID：14175739
> 
> 赞同：-5
> 
> 时间：2013-01-05T19:52:52.340
> 
> 标签：java, syntax, minecraft, minecraft-forge

我的java代码有一个小问题。错误是

> 令牌“;”上的语法错误，预期

这是我的代码：

```
package natchly.chest;

import natchly.chest.blocks.BlockStoneChest;
import net.minecraft.block.Block;
import cpw.mods.fml.common.Mod;
import cpw.mods.fml.common.Mod.Init;
import cpw.mods.fml.common.network.NetworkMod;
import cpw.mods.fml.common.registry.GameRegistry;
import cpw.mods.fml.common.registry.LanguageRegistry;
import cpw.mods.fml.common.event.FMLInitializationEvent;

@Mod(modid="chestsplus", name="Chests+", version="1.4.6_01")
@NetworkMod(clientSideRequired=true, serverSideRequired=false)
public class ModChests {

    public int idBlockStoneChest = 250;
    public static Block blockStoneChest; // <-------- Error here
    blockStoneChest = new BlockStoneChest(idBlockStoneChest).setBlockName("blockNAZWABLOKU").setHardness(1.5F).setResistance(5.0F);
    @Init
    public void init(FMLInitializationEvent e) {
        GameRegistry.registerBlock(blockStoneChest);
        LanguageRegistry.addName(blockStoneChest, "Stone Chest");
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T19:54:53.130

要么这样做：

```
public static Block blockStoneChest = new BlockStoneChest(idBlockStoneChest).setBlockName("blockNAZWABLOKU").setHardness(1.5F).setResistance(5.0F); 
```

或这个：

```
public static Block blockStoneChest; <-------- Error here
static {
    blockStoneChest = new BlockStoneChest(idBlockStoneChest).setBlockName("blockNAZWABLOKU").setHardness(1.5F).setResistance(5.0F);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:55:10.293

将这两行合并为一个声明和实例化步骤。除非在方法内部，否则 Java 不允许这样做。

```
public static BlockStoneChest blockStoneChest = new BlockStoneChest(idBlockStoneChest).setBlockName("blockNAZWABLOKU").setHardness(1.5F).setResistance(5.0F); 
```

# c# - 在 C# 中执行异步触发时省略等待语句是否安全并忘记使用 ado.net 写入数据库

> ID：14175740
> 
> 赞同：3
> 
> 时间：2013-01-05T19:53:01.477
> 
> 标签：c#, asp.net, asynchronous, ado.net

在 asp.net 应用程序中，我想尽可能高效地登录到数据库。我正在使用基本的 ADO.NET 写入日志数据库，并且我想异步执行此操作，所以这就是我所做的：

```
 using (var conn = new SqlConnection(_connectionString)) {
            using (var cmd = new SqlCommand("INSERT INTO dbo.Logs (TimeStamp,ThreadId,Level,Message,Exception) VALUES (@TimeStamp,@ThreadId,@Level,@Message,@Exception)", conn)) {
                cmd.Parameters.AddWithValue("@TimeStamp", DateTime.UtcNow);
                cmd.Parameters.AddWithValue("@ThreadId", Thread.CurrentThread.ManagedThreadId);
                cmd.Parameters.AddWithValue("@Level", level);
                cmd.Parameters.AddWithValue("@Message", msg);
                cmd.Parameters.AddWithValue("@Exception", ex == null ? "" : ex.ToString());
                conn.Open();
                cmd.ExecuteNonQueryAsync();
            }
        } 
```

现在我的问题是我是否应该对 cmd.ExecuteNonQueryAsync() 语句执行等待，或者是否可以省略等待，因为我基本上只需要执行一次即发即弃。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T20:00:48.727

仅仅触发并忘记异步操作是不行的——它可能会因异常而失败，在这种情况下，您几乎肯定想要做一些事情（通知用户/重试/炸毁）。（此外，如果有人使用特定选项，任务中的异常最终会导致进程中断）。

另外：谁负责关闭连接？

**编辑**：为了使连接关闭的问题更清楚，我将用`try`/重写 using 语句`finally`（我知道它不是完全相同的 IL，但它足够接近以查看问题所在） - 在这种情况下，代码大致变成：

```
SqlConnection conn;
try {
    conn = new SqlConnection("connString");
    SqlCommand cmd;
    try {
        cmd = new SqlCommand("INSERT INTO dbo.Logs (TimeStamp,ThreadId,Level,Message,Exception) VALUES (@TimeStamp,@ThreadId,@Level,@Message,@Exception)", conn);
        cmd.AddParameters();
        conn.Open();
        cmd.ExecuteNonQueryAsync();
    } finally {
        if (cmd != null) cmd.Dispose();
 } finally {
    if (conn != null) conn.Close();
 } 
```

您可以看到它`cmd.Dispose()`是在 之后调用的`cmd.ExecuteNonQueryAsync()`。这怎么能行？我看到两种可能性：

1.  要么`cmd.Dispose()`（通过设计或意外）在能够完成工作之前不会返回`cmd.ExecuteNonQueryAsync`- 这意味着您实际上只是从`cmd.Dispose`after回来`cmd.ExecuteNonQueryAsync`；在这种情况下，代码可以工作，但您不会从等待/异步中受益；
2.  或者以阻止完成`cmd.Dispose()`的方式执行；`cmd.ExecuteNonQueryAsync()`在这种情况下，代码不起作用；

在这两种情况下，程序都是错误的——你需要或者`await`调用`Wait()`任务以确保它的行为正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T00:10:51.243

正如其他人所提到的，强烈考虑一个稳定的、经过良好测试的库，例如 ELMAH 或 log4net。如果您决定自己推出，请考虑使用[基于 ETW 的解决方案](http://blogs.msdn.com/b/vancem/archive/2012/07/09/logging-your-own-etw-events-in-c-system-diagnostics-tracing-eventsource.aspx)，该解决方案的开销要少得多，并且可以轻松包含相关的 OS/.NET/IIS/ASP.NET 事件。我已经完成了对数据库的日志记录；这听起来像是个好主意，但你会遇到后勤问题。

要回答您的实际问题，`await`如果您需要对错误做出响应，则最好这样做。如果这真的是一劳永逸，那么您可以忽略`Task`结果。如果你的方法是`async`，编译器会在你忽略 a 时警告你`Task`；为避免警告，您可以将其分配给未使用的变量：

```
var _ = cmd.ExecuteNonQueryAsync(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-25T03:06:16.000

最简单的方法是对同步操作使用 Task.Run() 进行即发即弃。

例如，

```
Task.Run(() =>
{
     LogDatabase();

}); 
```

其中 LogDatabase() 是与 ExecuteNonQuery() 同步的标准 ADO.NET。

# c - sizeof 保证位对齐的一种实现

> ID：14175748
> 
> 赞同：2
> 
> 时间：2013-01-05T19:53:49.697
> 
> 标签：c, sizeof

`define`一句话是 ：

```
#define _INTSIZEOF(n)   ( (sizeof(n) + sizeof(int) - 1) & ~(sizeof(int) - 1) ) 
```

我被告知目的是位对齐。
我想知道它是如何工作的，提前谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T20:03:48.543

上面的宏只是将 的大小`n`与最近的大于或等于`sizeof(int)`边界对齐。

`a`将值与最近的大于或等于*任意*边界对齐的基本算法`b`是

1.  除以四舍五入*，*然后`a`_`b`
**   再次乘以商`b`。*

 *在无符号（或只是正）值的域中，第一步是通过以下流行的技巧实现的

```
q = (a + b - 1) / b
// where `/` is ordinary C-style integer division (rounding down)
// Now `q` is `a` divided by `b` rounded up 
```

将此与第二步结合起来，我们得到以下结果

```
aligned_a = (a + b - 1) / b * b 
```

在`aligned_a`您获得所需的对齐值。

将此算法应用于手头的问题将得到以下`_INTSIZEOF`宏的实现

```
#define _INTSIZEOF(n)\
  ( (sizeof(n) + sizeof(int) - 1) / sizeof(int) * sizeof(int) ) 
```

这已经足够好了。

但是，如果您事先知道对齐边界是 2 的幂，则可以通过用简单的按位运算替换除法+乘法序列来“优化”计算

```
aligned_a = (a + b - 1) & ~(b - 1) 
```

这正是上述`_INTSIZEOF`宏的原始实现中所做的。

这种“优化”可能对某些编译器有意义（尽管我希望现代编译器能够自行解决）。但是，考虑到上述`_INTSIZEOF(n)`宏显然是用作编译时表达式（它不依赖于任何运行时值，除了作为 传递的 VLA 对象/类型`n`），以这种方式优化它没有多大意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T19:56:01.223

这里有一个提示：

一个常用的方法`ceil(a/b)`是：

```
(a + (b-1)) / b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-01T17:50:05.610

b * ( (a + b - 1) / b ) = (a + b - 1) & ~(b - 1)

要了解上述原因为何成立，请考虑以下几点：

第一部分（为什么 q = (a + b - 1) / b 产生我们正在寻找的数字）：

...请注意，我们希望 q 是 a 中 b 的数量，但向上取整（即，如果整数除法后有余数，则该余数应向上取整为 b，因此 q 增加 1 ）。

存在 Q 和 R 使得 a = Qb + R，因此 a + b - 1 = Qb + b - 1 + R。如果我们对 a + b - 1 进行整数除法，我们将得到 Q + (b- 1+R)/b。如果 R 为零，则第二部分将为零，如果 R 不为零，则为 1（注意 R 保证小于 b）。

第二部分（宏）：

现在如果 b 是 2 的幂，那么 a + b - 1 除以 b 只是 b 的指数的右移（即 b = 2^n，然后右移 n 位）。

此外，乘以 b 是左移（左移 n 位）

因此结合起来，我们所做的就是将最右边的 n 位清除为零，这是通过屏蔽来实现的：~(b-1) 给我们 1111...111000...0 其中 1 的数量等于 n ( b = 2^n)*

# python - Python，Selenium Webdriver：未为 Firefox 驱动程序加载 Span

> ID：14175750
> 
> 赞同：1
> 
> 时间：2013-01-05T19:54:33.333
> 
> 标签：python, selenium, webdriver

我的 Firefox 驱动程序在显示我网站的其中一个弹出窗口的跨度时遇到问题。由于声誉，我不允许发布图像，但这里是 Firefox 和 Chrome 驱动程序的示例： [https ://www.dropbox.com/s/6yzgi40xljpdyp5/spans.png](https://www.dropbox.com/s/6yzgi40xljpdyp5/spans.png)

所以对于 Firefox，我需要修改我的定位器：

```
_apply_button = (By.XPATH, "//button[contains(text(), 'Apply')]") 
```

它不适用于 Chrome，因此 Chromedriver 有另一个版本：

```
_apply_button = (By.XPATH, "//button[contains(span, 'Apply')]") 
```

有没有办法正确加载跨度？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:02:19.010

尝试[通过链接文本](http://selenium-python.readthedocs.org/en/latest/locating-elements.html#locating-hyperlinks-by-link-text)选择元素：

```
_apply_button = driver.find_element_by_link_text('Apply') 
```

另一种解决方案如下：

```
_apply_button = (By.XPATH, "//button/span[contains(text(), 'Apply')]") 
```

# android - 画布上的图像未显示

> ID：14175754
> 
> 赞同：0
> 
> 时间：2013-01-05T19:54:50.050
> 
> 标签：android, ondraw

我对 Android 很陌生，但为什么我的图像没有显示在画布上？我知道它工作正常，因为背景颜色是黑色，我用相同的方法 onDraw 更改了它。谁能帮我？提前致谢！

```
 public PongView(Context context) {
    super(context);
    paddle1 = BitmapFactory.decodeResource(getResources(), R.drawable.pongpaddle);
    paddle2 = BitmapFactory.decodeResource(getResources(), R.drawable.pongpaddle);
}
protected void onDraw(Canvas canvas) {
    xp1 = canvas.getWidth()/2;
    xp2 = canvas.getWidth()/2;
    yp1 = 25;
    yp2 = 760;
    canvas.drawColor(Color.BLACK);
    canvas.drawBitmap(paddle1, xp1,yp1, null);
    canvas.drawBitmap(paddle2,xp2,yp2, null);
    Paint white = new Paint();
    white.setColor(Color.WHITE);
    canvas.drawText("Score P1:"+ p1Score +" P2: " + p2Score , 700, 20,white );  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:47:01.223

根据您上面的评论，我认为正在发生的事情是，android 运行时正在绘制到画布上，而您`onDraw`没有被调用。`this.setWillNotDraw(false)`您可以通过调用类的构造函数来避免这种情况。一旦你清除了这个标志，你的 onDraw() 就会被调用。

**资料来源：** Android 开发者文档说，如果你覆盖 View's `onDraw()`，你必须清除这个标志。检查[setWillNotDraw](http://developer.android.com/reference/android/view/View.html#setWillNotDraw%28boolean%29)

# facebook-opengraph - Facebook 和 Linkedin 分享按钮

> ID：14175757
> 
> 赞同：0
> 
> 时间：2013-01-05T19:54:57.970
> 
> 标签：facebook-opengraph, facebook-sharer

我在我网站的一个页面上放置了 facebook 和 Linkedin 分享按钮。我已经为该页面设置了 fb opengraph 标签。我还设置了带有我想在 FB 和 Linkedin 上分享的描述的元标记，但是当我在 facebook 上分享内容时，我得到了错误的 url 和分享的描述。请看一下，并在我错的地方给我任何想法。 [这是页面](http://tinyurl.com/bfoteyl)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T08:51:15.530

[我在 facebook 调试器中检查了](http://developers.facebook.com/tools/debug)我的 URL 和 OG 标签，它指出我有一个类型错误，并且缺少一个描述标签，这是必不可少的。修复这些，使一切变得完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-30T14:47:17.693

对于那些想要同时针对 Facebook 和 LinkedIn 测试他们的页面的*人*...

*   **[Facebook 页面调试器](https://developers.facebook.com/tools/debug)**
*   **[LinkedIn 邮政检查员](https://www.linkedin.com/post-inspector/)**

# ruby-on-rails - 如何将独立维护的 ruby 脚本合并到 Rails 应用程序中

> ID：14175763
> 
> 赞同：2
> 
> 时间：2013-01-05T19:55:23.963
> 
> 标签：ruby-on-rails, ruby, plugins, gem

我有一个 ruby​​ 脚本 (.rb)，它打开一个文件并在一些解析后生成一个 csv 文件。

我独立维护脚本，并可能在其他应用程序中使用。

现在我只是将代码复制并粘贴到我的控制器中......我知道这是不对的！

我应该如何将此 ruby​​ 脚本合并到我的应用程序中？

我把它变成宝石吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:20:10.560

使其成为宝石并安装它是一种选择。否则，将文件的目录注册为加载路径。那部分可能取决于操作系统。例如，对于 Ubuntu Linux，我在终端中执行以下操作：

```
export RUBYLIB=path_to_the_directory_where_the_file_is 
```

然后，`require`该文件并使用它。当您希望您的库根据是直接从命令调用还是从另一个 ruby​​ 脚本调用而表现不同时，常见的方法是在您的库中编写：

```
if __FILE__ == $0
  commands_to_execute_when_called_directly_from_command
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:25:51.657

我们一直在编写基于 Ruby 的小型命令行工具，并将它们视为常规的 Linux 应用程序。使用反引号或 调用它们是微不足道的，或者像我们使用常规应用程序一样`%x`使用常规管道 ( ) 链接它们。`|`

如果我们要抛出大量数据，通常我们会`--json`使用 OptionParser 添加一个标志，它允许我们将 JSON 发送到调用程序，从而更容易重用数据，而不必解析 CSV 或柱状数据.

您可以在`/usr/local/bin`*nix 系统上安装这类应用程序，确保路径设置为在那里搜索，然后在 shell、Ruby 或任何其他能够使用子 shell 的语言之间共享代码。

仅仅因为它们是用 Ruby 编写的，并不意味着它们必须是 gem 或模块。Ruby 的功能远不止这些，并且非常适合通常的宿主生态。

# haskell - 使用带有 Graphics.SOE 包的 Haskell Gtk 小部件

> ID：14175767
> 
> 赞同：0
> 
> 时间：2013-01-05T19:55:42.060
> 
> 标签：haskell, graphics, gtk, gtk2hs

我一直在研究Paul Hudak[的《Haskell School of Expression 》一书，并使用其相关的基于 gtk 的图形库 Graphics.SOE.Gtk（文档](http://www.cs.yale.edu/homes/hudak/SOE/software1.htm)[链接](http://cvs.haskell.org/Hugs/pages/libraries/HGL/Graphics-SOE.html)）进行小型 2D 绘图实验。

然而，这个库是非常基础的，只有真正具有绘制形状的能力。目前，我正在编写一些需要特定 GUI 小部件（例如按钮和文本框）的程序。我的问题是：是否可以将 SOE 库的绘图功能与[gtk2hs](http://hackage.haskell.org/package/gtk-0.12.3)中的 GUI 小部件一起使用？例如，能够编写一个程序，我可以在其中单击一个按钮，该按钮会导致程序在同一窗口的另一个容器中绘制三角形。

我已经在网上搜索了一种方法来做到这一点，但大多数教程建议使用 cairo 使用 Gtk 进行任何图形绘制；SOE图形的API看起来是一个相对独立的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:14:09.430

不，没有一种真正有意义的方式来`soegtk`定期`gtk`进行互动。原因是`soegtk`保持其所有数据类型都是抽象的；从“使实现者可以轻松地更改实现而不更改接口”的角度来看，这是一个很好的做法，但从“我只是一个想要以接口的方式处理事物的用户”来看，这可能会有点限制不要承诺允许”的观点。

你可以：

*   复制`soegtk`包中单个模块的文本，并调整导出行以导出更多内容，并愉快地打破你不喜欢的任何抽象边界
*   无意义的互动；例如，让您的`gtk`按钮打开一个`soegtk`包含感兴趣图形的窗口
*   学习不同的绘图库，例如，`cairo`或`diagrams`

# json - Web Api 不会序列化我的对象图

> ID：14175771
> 
> 赞同：-1
> 
> 时间：2013-01-05T19:56:04.523
> 
> 标签：json, asp.net-web-api, json.net

我有两个简单的实体：

```
public class Ingredient : IEntity
{
    public Ingredient()
    {
        Drinks = new List<Drink>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Drink> Drinks { get; set; }
}

public class Drink : IEntity
{
    public Drink()
    {
        Ingridients = new List<Ingredient>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Ingredient> Ingridients { get; set; }
    public string Approach { get; set; }
} 
```

我收到以下错误：

```
Object graph for type 'Gudo.Core.Model.Ingredient' contains cycles and cannot be serialized if reference tracking is disabled. 
```

我尝试在集合上使用`JsonIgnore`Attribute并尝试使用：`Drinks`

```
JsonSerializerSettings jsSettings = new JsonSerializerSettings();
        jsSettings.ReferenceLoopHandling = ReferenceLoopHandling.Ignore; 
```

在我的 global.asax

什么都行。。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T05:28:07.927

您是否确保在 JSON 格式化程序的序列化程序设置上进行了设置？这条线应该为你做：

```
GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = ReferenceLoopHandling.Ignore; 
```

# ruby-on-rails - echo $PATH 与 .bash_profile 不匹配

> ID：14175773
> 
> 赞同：5
> 
> 时间：2013-01-05T19:56:13.690
> 
> 标签：ruby-on-rails, macos, path, terminal, homebrew

我正在尝试在 Mountain Lion 上安装自制软件，以便可以安装 Ruby 1.9.3。经过多年只使用 PHP 编程，我终于开始使用 Rails、Git 等。无论如何，我使用的是给我的笔记本电脑。因此，我的登录帐户不是原始帐户。我认为这可能导致我遇到的问题。

运行 brew doctor 时，我得到以下信息：

> 警告：在您的路径中找不到 Homebrew 的 sbin。考虑修改您的 PATH 变量，使其包含：/usr/local/sbin

运行 echo $PATH 时，我得到以下信息：

> /usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin:/Users/chadimoglou/.rvm/bin

我的主目录中没有 .profile 。有一个 .bash_profile。看起来像这样

> [[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # 将 RVM*作为函数加载到 shell 会话中*

非常感谢对这个终端菜鸟的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:59:46.967

在您的 .bash_profile 中，您可以简单地执行以下操作：

```
export PATH="$PATH:/usr/local/sbin" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T11:59:25.013

您可以手动编辑您的`$PATH`和`/bin`. [本指南](http://ubuntulinuxknowhow.blogspot.com/2013/06/what-are-path-and-bin-used-for.html)并不算太糟糕，它帮助我理解了 sudoer 的整个概念`$PATH /bin`并成为一名 sudoer。

# python - 如何更新循环中的单个变量？

> ID：14175774
> 
> 赞同：0
> 
> 时间：2013-01-05T19:56:13.417
> 
> 标签：python, loops

我在while循环中尝试做的是用整数10迭代付款，这样如果整数（g）`CBalance <= 0`在12个月内未能获得，那么所有变量都会重置，除了g，它会上升由 1。

```
Balance = float(raw_input('Enter Balance '))
Rate = float(raw_input('Enter interest rate '))
monthlyI = Rate/12
month = 0
g = 1
Payment = 10
CBalance = Balance
while CBalance > 0:
    Payment = Payment*g
    month += 1
    CBalance = CBalance *(1+ monthlyI)- Payment
    if month > 12:
        month = 0
        g += 1
        Cbalance = Balance 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:58:59.953

我想我终于明白你的问题是什么以及导致问题的原因 - 即变量名的简单拼写错误。`if`要修复它，只需将`while`循环中的语句的最后一行更改为：

```
 if month > 12:
            month = 0
            g += 1
            Cbalance = Balance 
```

至：

```
 if month > 12:
            month = 0
            g += 1
            CBalance = Balance  # note corrected spelling of variable name on left 
```

这就解释了为什么所有的值都没有被重置。如果您明确提到它在您的问题中是哪个变量（如果您知道的话），那将会很有帮助。无论如何，当您使用大写和混合大小写变量名称时，这种事情更有可能发生。

出于这个原因，许多程序员试图避免使用它们，特别是对于像 Python 这样的语言，您通常不必在使用它们之前声明变量。您可能想查看 PEP 8 样式指南的[命名约定](http://www.python.org/dev/peps/pep-0008/#naming-conventions)部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:12:54.570

> 我在while循环中尝试做的是将付款迭代10的整数，以便如果该整数（g）在12个月内未能获得CBalance <= 0，则除g之外的所有变量都会重置, 增加 1。

我认为正在发生的事情是，每次运行此程序时，您都会得到：

```
Payment = 10 * 1 //First while payment = 10 
```

第二次

```
Payment = 10 * 1 //payment = 10 again. 
```

结果是：

```
 CBalance = CBalance * (1 + monthlyI) - 10 
```

哪个永远不会变成负值，这是结束循环所必需的？

虽然您可能想要：

```
counter = 1;
while CBalance > 0:
   Payment = Payment*counter
   month += 1
   counter += 1
   CBalance = CBalance *(1+ monthlyI)- Payment
   if month > 12:
      month = 0
      counter = 1
      g += 1
      Cbalance = Balance 
```

# jquery - 显示加载而不是 body 或 div

> ID：14175778
> 
> 赞同：1
> 
> 时间：2013-01-05T19:57:14.850
> 
> 标签：jquery, ajax, html

我有一个简单的代码来显示和加载带有 ajax 的下一页。在显示新页面之前，我可以显示加载图像`div`，代码：

```
<div class="loading"><img src="{THEME}/images/loader.gif" /></div> 
```

我的内容的 div 是这样的：

```
<div id="dle-content"></div> 
```

现在，我的问题是，如何显示 loading`div`而不是 dle-content `div`？

**jQuery：**

```
<script type="text/javascript">
function nextPage() {
var nextPage = $('#ajax-next-page a').attr('href');
ShowLoading("");
if (nextPage !== undefined) {
$.ajax({
url: nextPage,
success: function(data) {
$('#ajax-next-page').remove();
$('#next-page').remove();
HideLoading("");
$('#dle-content').append($('#dle-content', data).html());
}
})
}
};
</script> 
```

我想`div`在加载`div`显示时在 dle-content 上制作模糊或深色背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:07:15.720

[工作小提琴](http://jsfiddle.net/ukePj/)

```
function ShowLoading() {
  var img = "loading.gif"; // here define name of image
  var s = document.createElement("div");
  s.style.width = "100%";
  s.style.height = "100%";
  s.style.background = "rgba(0, 0, 0, 0.8)";
  s.style.position = "absolute";
  s.style.top = "0px";
  s.style.left = "0px";
  s.id = "wrapper";
  document.body.appendChild(s);
  var image = document.createElement("img");
  image.src = img;
  image.style.margin = "0 auto";
  document.getElementById("wrapper").appendChild(image);
}

function HideLoading() {
  $("#wrapper").fadeOut();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:05:07.590

也许试试

```
 $(".loading").bind("ajaxSend", function() {
            $(this).show();
            $('.dle-content').hide
        }).bind("ajaxStop", function() {
            $(this).hide();
            $('.dle-content').show
        }) 
```

# javascript - 如何使用 Javascript 查找网站引用？

> ID：14175779
> 
> 赞同：-1
> 
> 时间：2013-01-05T19:57:14.737
> 
> 标签：javascript, jquery

我如何使用 Javascript 找到哪个网站引用了我的网站？例如，如果 A.com 有指向 B.com（我的网站）的链接，我怎么知道谁引用了我的网站？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T19:59:41.423

您应该能够使用[`document.referer`](https://developer.mozilla.org/en-US/docs/DOM/document.referrer)来检索此信息。

# c++ - 模板化成员函数指针作为模板参数

> ID：14175783
> 
> 赞同：1
> 
> 时间：2013-01-05T19:57:30.333
> 
> 标签：c++, templates, c++11, variadic-templates

我希望接受一个模板化的成员函数作为模板参数。

例如，给定这个类：

```
class A
{
public:
    template<typename... Args>
    void Foo(Args...) {}

    void Bar() {}
}; 
```

我希望能够致电：

```
Invoke<&A::Foo>(5, true); 
```

并让这类似于调用：

```
A a;
a.Foo(5, true); 
```

我知道如何做到这一点`Bar()`：

```
template<void (A::*F)()>
void Invoke()
{
    A a;
    (a.*F)();
}

int main()
{
    Invoke<&A::Bar>();
} 
```

是否可以将其扩展到模板化成员函数指针？或者类似地，编写一个可以处理任何参数类型的函数的转发函数。这不起作用，但类似于：

```
template<typename... Args, void (A::*F)(Args...)>
void Invoke(Args... args)
{
    A a;
    (a.*F)(args...);
} 
```

我明白为什么这可能是不可能的，但如果这是真的，你能指出为什么的标准吗？我也在尝试更多地了解该标准的细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:03:41.130

> 是否可以将其扩展到模板化成员函数指针？

不，虽然如果你只需要一个特定的实例，`Foo`你可以使用`Invoke<&A::Foo<int, bool>>`.

> 或者类似地，编写一个可以处理任何参数类型的函数的转发函数。

为了能够使用不同的签名，您必须修改`Invoke`以对任何类型的*可调用*对象进行操作。然后，您必须定义一个调用您的实际函数的*可调用*对象：

```
struct callable_foo
{
    explicit callable_foo( A& obj ) : _obj( obj ){}

    template< typename ...Args >
    void operator ()( Args&&... args )
    {
         _obj.Foo( std::forward< Args >( args )... );
    }

    A& _obj;
} 
```

# objective-c - 使用`id object2 = [object copy]`和`id object2 = object`有什么区别？

> ID：14175784
> 
> 赞同：0
> 
> 时间：2013-01-05T19:57:55.963
> 
> 标签：objective-c, object, copy

我在 Objective-C 中做了一些测试，我对`copy`方法有疑问。有什么区别：

```
id object2 = [object copy]; 
```

和：

```
id object2 = object; 
```

?

`object = nil`在此注释之后是否可见差异？那么在第一种情况下`object2`等于`object`但在第二种情况下`object2`等于`nil`？何时`copy`正确使用方法？

谢谢你的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:03:26.953

第一种方法复制一个对象（如果它符合`<NSCopying>`协议）——即它创建一个逻辑上等同于旧实例的对象的**新实例。**这两个对象将位于内存中的不同位置。

```
+----------+  +---------------------------------------------+
| Object 1 |  | Copy of object 1, with identical properties |
+----------+  +---------------------------------------------+
    ^                ^
    |                |
 "object"        "object2" 
```

第二行仅将指针分配给`object`变量`object2`- 它不会创建新实例，指针将指向完全相同的对象：

```
+--------+
| Object |
+--------+
   ^  ^
   |  +--------------+
"object"         "object2" 
```

> 当 object = nil 时差异是否可见？

不，从那时起两个变量都将是`nil`（`nil`Obejctive-C 中的消息传递总是产生`nil`或 0）。

> 何时正确使用复制方法？

每当您需要复制现有对象时，例如当您想要修改其上的某些属性而不影响原始对象时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T20:00:21.300

不同之处在于，如果您复制对象，您将拥有一个独立的副本，并且如果您更改该对象，则原始对象不会受到影响。

例如你有一个 NSNumberFormatter：

```
NSNumberFormatter* f1= [NSNumberFormatter new];
f1.numberStyle= NSNUmberFormatterDecimalStyle;
NSNumberFormatter* f2= [f1 copy];
f2.numberStyle= NSNUmberFormatterScientificStyle; 
```

在这种情况下， f1 不受更改的影响。

但是，如果您进行简单的分配：

```
NSNumberFormatter* f1= [NSNumberFormatter new];
f1.numberStyle= NSNUmberFormatterDecimalStyle;
NSNumberFormatter* f2= f1;
f2.numberStyle= NSNUmberFormatterScientificStyle; 
```

然后 f1 也会受到变化的影响。

如果您使用不可变对象，则不应该关心这种差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T20:04:35.520

使用标准 object2 = object 是引用或指向分配。这意味着 object 和 object2 都应该指向同一个内存区域。应用于任一对象的任何更改都应同时影响它们（或更准确地说，它们都从完全相同的内存位置读取和写入）。

当您使用复制时，您将在内存中创建一个新部分并使用与对象相同的值填充它。在这种情况下，您有 2 个不同的内存区域，它们以相同的值开头。当您编辑对象时，您正在为该变量名编辑内存中的值。编辑对象 2 的值时，您仅编辑对象 2 的内存值。

当您的意思是两个变量名称都指向完全相同的内存区域时，您肯定希望使用引用方法来限制内存使用和开销。如果这两个对象是相互独立的，您需要创建和维护一个副本。

# drupal - 在单独的页面上显示 comment_form

> ID：14175786
> 
> 赞同：0
> 
> 时间：2013-01-05T19:58:15.237
> 
> 标签：drupal, drupal-7

我尝试在节点编辑页面上显示“comment_form”，但无法获取 rignt 对象或传递给表单构建器的参数，这里是代码 - >

```
print drupal_render(drupal_get_form('comment_form', $node)); 
```

这似乎可行，但是有一些错误，例如缺少参数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T13:16:20.750

这很简单，您不需要特定的开发，您可以使用[Talk](http://drupal.org/project/talk)模块或为您的页面创建链接：

> /node/%/评论

或者您可以使用视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:19:24.023

为此，请使用面板模块并对您的页面进行面板化

# javascript - targetTouches 是否跟踪在多个元素上同时移动的触摸？

> ID：14175789
> 
> 赞同：2
> 
> 时间：2013-01-05T19:58:43.907
> 
> 标签：javascript, html, events, dom-events, multi-touch

假设我有四个手指向下：元素 A 中的两个手指 (1, 2) 和元素 B 中的两个手指 (3, 4)。

假设我然后移动手指 1 和手指 3。

我应该查看一个包含手指 1 和 3的`touchmove`事件。`changedTouches`

但是会`targetTouches`包含什么？它会包含 1 和 2，或 3 和 4，还是全部 4？

似乎提供足够信息的唯一方法是发送**两个** `touchmove`事件，即 1 和 2 在同一个元素上，而 3 和 4 都在不同的元素上。

我正在构建一个触摸框架，并且我一直在构建一个跟踪所有手指及其目标的全局数据结构，所以我确实知道发生了什么，但我想知道如果`targetTouches`事件可以为我提供所有这些，是否可以完全跳过这样做必要的信息。

我`touchstart`在我的页面上对其进行了测试：

![触摸启动](../Images/77be88507eed04a08e67420490fa4477.png)

```
document.touchstart = function(evt) { console.log("touchstart", evt.targetTouches); } 
```

我按照上面描述的顺序放下四根手指。接下来，我将尝试查看是否可以找出 targetTouches 包含的内容`touchmove`，因为它会生成多少数据，所以这是一项更困难的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:07:41.663

我将在 iOS6.0 (iPhone 5)、iOS5.1.1 (iPad 3)、Android 4.2.1 (Chrome 18.0.1025469) 上的 Nexus 7 和 Nexus 7 上的 Firefox for Android 17 上发布我的发现。

目前只有 iPhone 5 的数据。这是很多工作。

我所做的是在页面和`touchstart`调用中创建两个元素`preventDefault()`以防止滚动。然后我计算了它和缓冲区`touchmove`的长度并将其显示在 DOM 中。此外，我计算了事件发生的速率。这是代码片段：`changedTouches``targetTouches`

```
// exposed is a variable which other code uses rAF to present a representation of it on the DOM so I can view it
touchmove: function(evt) { 
    evt.preventDefault(); 
    var time = Date.now();
    var diff = time - exposed.touch_move_last_time; 
    if (!exposed.touch_move_last_time) exposed.touch_move_last_time = Date.now();
    if (!exposed.touch_move_rate) exposed.touch_move_rate = 0;
    exposed.touch_move_last_time = time;
    exposed.touch_move_rate += (diff - exposed.touch_move_rate)*0.01;
    exposed.touch_move_changedTouches_count = evt.changedTouches.length;
    exposed.touch_move_targetTouches_count = evt.targetTouches.length; 
```

当我四处移动手指时，我将它移动成一个圆圈而不是之字形，因为在之字形点它可以触发比采样率更少的事件。由于收敛速度低（这是为了产生不会持续波动的数字），持续摩擦大约需要 5 秒才能使读数稳定在采样率上。

iOS6.0：

**将两根手指放在一个元素中并移动一根手指：**
`changedTouches`大小：1（移动的那个）
`targetTouches`大小：2（两个手指在元素上）
采样率：16.66ms

**将两根手指放在一个元素中并左右移动：**
`changedTouches`大小：2（都在移动）
`targetTouches`大小：2（元素上的两个手指）
采样率：16.66ms

**在每个元素中放下一根手指并移动一根手指：**
`changedTouches`大小：1（移动的那个）
`targetTouches`大小：1（指的是移动的那个最初触摸的元素）
采样率：16.66ms

**在每个元素中放下一根手指并左右移动两根手指：**
`changedTouches`大小：1（移动的那个）
`targetTouches`大小：1（指移动的那个最初触摸的元素）
采样率：8.29ms

**在第一个元素中放下一根手指，在第二个元素中放下两个手指：**
*如果在第二个元素中移动一根手指*
`changedTouches`大小：1
`targetTouches`大小：2
采样率：16.66ms

*如果在第二个元素中移动两个手指*
`changedTouches`大小：2
`targetTouches`大小：2
采样率：16.6 毫秒（真的很难保持第一根手指不动）

*如果在第一个元素中移动手指*
`changedTouches`大小：1
`targetTouches`大小：1
采样率：16.66ms

*如果在第一个元素中移动手指，在第二个元素中移动一个手指*
`changedTouches`大小：1
`targetTouches`大小：在 1 和 2 之间波动
采样率：8.29ms

*如果移动所有三个手指*
`changedTouches`大小：在 1 和 2 之间波动
`targetTouches`大小：2 采样率：约 8.3 毫秒

**在每个元素中放下两根手指，在每个元素中左右移动一根手指：**
`changedTouches`尺寸：1
`targetTouches`尺寸：2
采样率：约 9ms

很明显，在采样率为 ~120Hz 的所有情况下，我至少有两个元素在其中移动，这显然表明它将`touchmove`为每个同时触摸的元素触发一个单独的元素。我敢打赌，将测试扩展到 3 个元素会看到 180Hz 的采样率。更新：我在 iPad 上测试了 3 个元素，它确实产生了 5.4 毫秒的读数。

我有点好奇的是为什么我总是得到 8.29ms 而不是 8.33ms。9ms 的读数可能只是因为它的处理量比全速处理的多（因为我已经让 DOM 更新每一帧）

另一个更新：

在 Nexus 7 上的 Chrome 上，`changedTouches`缓冲区似乎总是充满了所有的触摸，因为`webkitForce`每次触摸的读数总是在变化。它也很慢，以至于采样率读数给出的有用信息为零。但是通过更改页面上最后一个有序元素中存在的手指数量，似乎`touchmove`事件也正确地在每个元素的基础上被触发。

Nexus 7 上的 Firefox 在产生合理的采样率读数方面要好一些，但显示的更新比 Chrome 还要慢。在 Firefox 变得不那么不稳定之前，我认为让代码在其上正常工作是不值得的。

# c# - UserControl 在回发后失去 ViewState

> ID：14175795
> 
> 赞同：1
> 
> 时间：2013-01-05T19:59:30.517
> 
> 标签：c#, asp.net, user-controls, viewstate

我正在尝试创建一个简单的寻呼机用户控件，它将在 ASP.NET 中继器的页脚中使用。

每次用户单击 Next 我想将 PageCounter 增加 10 并将值保存在 ViewState 中。它在我第一次单击 lbNext 时起作用，但之后它不断重置为 10 并且`ViewState["PageCounter"]`为空

我试过用它来装饰我的财产，`[PersistenceMode(PersistenceMode.Attribute)]`但仍然没有运气。为什么值没有被持久化到 ViewState？

**澳交所：**

```
<%@ Control Language="C#" EnableViewState="true" AutoEventWireup="true" CodeBehind="Pager.ascx.cs" Inherits="WebApplication6.Pager" %>
<asp:LinkButton ID="lbPrevious" runat="server" OnCommand="SetPage" CommandArgument="Previous">Previous</asp:LinkButton>
<asp:TextBox ID="txtPage" runat="server" EnableViewState="true" Enabled="false"></asp:TextBox>
<asp:LinkButton ID="lbNext" runat="server" OnCommand="SetPage" CommandArgument="Next">Next</asp:LinkButton> 
```

**后面的代码：**

```
public partial class Pager : System.Web.UI.UserControl
{
    [PersistenceMode(PersistenceMode.Attribute)]
    public int PageCounter
    {
        get
        {
            var counter = ViewState["PageCounter"];
            return ((counter == null) ? 0 : (int)counter);
        }
        set
        {
            ViewState["PageCounter"] = value;
            txtPage.Text = value.ToString();
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
            PageCounter = 0;
    }

    protected void SetPage(object sender, CommandEventArgs e)
    {
        switch (e.CommandArgument.ToString())
        {
            case "Previous":
                PageCounter -= 10;
                break;
            case "Next":
                PageCounter = PageCounter + 10;
                break;
        }
    }
} 
```

**编辑：**

这是我将 Pager 用户控件添加到中继器的代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Repeater.aspx.cs" Inherits="WebApplication6.Repeater" %>
<%@ Register Src="Pager.ascx" TagName="Pager" TagPrefix="asp" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Repeater control</title>
</head>
<body>
    <form id="form1" runat="server">
    <asp:Repeater ID="booksRepeater" runat="server">
        <ItemTemplate>
            <table>
                <tr>
                    <td>
                        Name:&nbsp;<asp:Label ID="lblName" runat="server" Text='<%# Bind("FirstName") %>' />
                    </td>
                </tr>
                <tr>
                    <td>
                        Surname:&nbsp;<asp:Label ID="lblSurname" runat="server" Text='<%# Bind("LastName") %>' />
                    </td>
                </tr>
            </table>
            </div>
        </ItemTemplate>
        <FooterTemplate>
            <asp:Pager ID="pager" runat="server" />
        </FooterTemplate>
    </asp:Repeater>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:31:53.440

当您的数据绑定到您的中继器（“booksRepeater”）时，您的代码不会显示。确保及时绑定数据。听起来像这个问题：[Maintaining viewstate of a repeater](https://stackoverflow.com/questions/7416421/maintaining-viewstate-of-a-repeater)

# android - 是否有任何视图可以帮助我显示 HTML 文本？

> ID：14175797
> 
> 赞同：0
> 
> 时间：2013-01-05T19:59:31.910
> 
> 标签：android

我有一些带有 html 标签的文本：a、br、b，我需要向用户显示这些文本。是否有任何视图或方法来显示此文本以供用户保持格式？先感谢您

更新：

有代码：

```
 TextView view=new TextView(this);
    view.setText(Html.fromHtml("<a href='www.google.com'>link</a>"));
    view.setAutoLinkMask(Linkify.ALL); 
```

当我单击链接时，没有任何操作。我该如何解决？我需要打开浏览器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:03:27.693

如果您在字符串资源中使用了一些 HTML 标签，那么您可以使用..

```
textView.setText(Html.fromHtml(R.string.your_string)); 
```

并在您的 textview XML 中设置标签**android:autoLink="all"或**

**view.setMovementMethod(LinkMovementMethod.getInstance());** 在爪哇。

它会给你想要的输出...... :)

# jquery - 子元素的目标属性

> ID：14175805
> 
> 赞同：-1
> 
> 时间：2013-01-05T19:59:56.793
> 
> 标签：jquery, parent-child

我有以下列表，当用户单击一个 li 时，我想在一个变量中分配 img.tip 的属性 src 的值。请问有什么帮助吗？谢谢！！

```
<ul class="list">
<li data-id="7" data-thumb="http://test.com/assets/pdc/thumbs/66.png" data-img="http://test.com/assets/pdc/img/66.png" data-country="Australia" data-company="Big Farm" data-app="Tea" data-brand="Big Farm" data-package="500" class="product air-500 cat7">
    <img class="tip" data-country="Australia" data-brand="Big Farm" src="assets/img/ajax-loader.gif">
</li>
</ul> 
```

由于某种原因，此代码在单击的 li 元素中获取 data-thumb 属性：S 知道为什么吗？

```
$(".list li").on("click", function() {
    var src = $(this).children(".tip").prop("src");
    // ...
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:07:34.970

```
$(".list li").on("click", function() {
    var src = $(this).children(".tip").prop("src");
    // ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:01:55.343

```
<li onclick="var x = this.getElementsByName('img')[0].src">
   <img src="kittens.jpg" />
</li> 
```

# java - Java Swing JScrollPane 显示的输出与书中显示的不同。行标签在 Java 中消失了

> ID：14175812
> 
> 赞同：2
> 
> 时间：2013-01-05T20:00:37.260
> 
> 标签：java, swing, containers, jscrollpane

以下代码没有给我它应该的输出。它应该给出的输出如下所示：

[我想得到的输出](https://16aba0be-a-62cb3a1a-s-sites.googlegroups.com/site/learningswing/chapter_11_oreilly_swing/output.jpg?attachauth=ANoY7cpZBkfpRg8MI6HFSX5xju8rqxGQakfkt_kndVpAa-0C76ZouVFvu3VZrD9A4j5CDy__At2LkMWFgECGcNT-ynt_Xt-AKLhmV4c8z7Qk9_0eRT11RrHktG1zSSkpnR5g3tZ0Ql3s5P-7-8sJcPWi_nK3pbJDwjfLk2UDyplBLo7tAlqBDWGeju7a0eOJPoGLnb5zJnHihO62tm3hEqkDgodOEu_VruGAdRlRICNOeD9oJvs4uY0_3A0xobcxOrh1I152JGpp&attredirects=0)

而不是那个输出，我得到了一个类似于下面的输出：

[我现在得到的错误输出](https://16aba0be-a-62cb3a1a-s-sites.googlegroups.com/site/learningswing/chapter_11_oreilly_swing/output_that_I_get.jpg?attachauth=ANoY7cpF2gyLWjUElS0on4q4yfe-Y3NfjkoK4urJXCFeIZ9vljVDErqKoMZsLAg8M3ZskrkTkM-GXNbqra-ns8o0tEY-KajOZSKA3saT8jbUaC7F3CGoBcaBVoCM_DJ2wE8g5O7YsFZ2vOnZAIQdyKnoHt9ZWJ3XPIFrAPUz2zbrisQ7qDfpIUVSoe-eb-nPZWpWevmRK5Ap5tuD8zQd4w6jF3ZBKufvROhpso9KexlKYbx21M10YfSyfVjEsyFxhnRgumHwsU3k&attredirects=0)

我注意到我没有得到的事情是：

1.  我没有得到垂直和水平的滚动条。
2.  我没有得到面板“p”中每一行的行标题。
3.  格式似乎也受到干扰。当程序启动时，单选按钮是不可见的，直到我将鼠标移到它们上面。

此代码来自使用 Eclipse IDE 的 O'REILLY 的 Java Swing 书（第 11 章）。

* * *

```
package khan.ajmal.oreilly.swing;

import java.awt.Window;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class BasicWindowMonitor extends WindowAdapter {

    @Override
    public void windowClosing(WindowEvent e) {
        Window w = e.getWindow();
        w.setVisible(false);
        w.dispose();
        System.exit(0);
    }
} 
```

* * *

/*一个组件大于应用程序窗口的 JScrollPane。*/ 包 khan.ajmal.oreilly.swing.Chapter11_SpecialtyPanesAndLayoutManagers；

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ButtonGroup;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.JScrollPane;
import javax.swing.JViewport;
import javax.swing.ScrollPaneConstants;

import khan.ajmal.oreilly.swing.BasicWindowMonitor;

public class ScrollDemo2 extends JFrame {
    JScrollPane scrollPane = new JScrollPane();

// Constructor
    public ScrollDemo2() {
        super("JScrollPane Demonstration");

    /* Add in some JViewports for the column and row headers */
        JViewport jv1 = new JViewport();
        jv1.setView(new JLabel(
            new ImageIcon(
                       "C:/Users/Ajmal/workspace/OreillySwing/src/khan/ajmal/oreilly/swing/Chapter11_SpecialtyPanesAndLayoutManagers/columnLabel.jpg")));

        scrollPane.setColumnHeader(jv1);

        JViewport jv2 = new JViewport();
        jv2.setView(new JLabel(
            new ImageIcon(
                    "C:/Users/Ajmal/workspace/OreillySwing/src/khan/ajmal/oreilly/swing/Chapter11_SpecialtyPanesAndLayoutManagers/rowLabel.jpg")));
    scrollPane.setRowHeader(jv2);

    /* And throw in an information button */
    JButton jb1 = new JButton(
            new ImageIcon(
                    "C:/Users/Ajmal/workspace/OreillySwing/src/khan/ajmal/oreilly/swing/Chapter11_SpecialtyPanesAndLayoutManagers/question.jpg"));
    jb1.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            String message = "This is an active corner!";
            String title = "Information";
            int type = JOptionPane.INFORMATION_MESSAGE;
            JOptionPane.showMessageDialog(null, message, title, type);
        }// method actionPerformed ends here.
    }// Definition of inner class ActionListener ends here.
    );/* Passing arguments to method addActionListener ends here. */
    scrollPane.setCorner(ScrollPaneConstants.UPPER_LEFT_CORNER, jb1);
    setSize(300, 200);
    addWindowListener(new BasicWindowMonitor());
    init();
    setVisible(true);
}// Constructor ends here.

private void init() {
    JRadioButton form[][] = new JRadioButton[12][5];
    String counts[] = { " ", "0-1", "2-5", "6-10", "11-100", "101+" };
    String categories[] = { "Household", "Office", "Extended Family",
            "Company (US)", "Company (World)", "Team", "Will",
            "Birthday Card List", "High School", "Country", "Continent",
            "Planet" };
    JPanel p = new JPanel();
    p.setSize(600, 400);
    p.setLayout(new GridLayout(13, 6, 10, 0));

    for (int row = 0; row < 13; row++) {
        // creating a button group in each iteration of the row loop
        ButtonGroup bg = new ButtonGroup();
        for (int col = 0; col < 6; col++) {
            // We need to create column headers in the first row
            if (row == 0)
                p.add(new JLabel(counts[col]));
            else {
                /*
                 * When the control moves to a new row, check for the
                 * column. In the first column put row headers
                 */
                if (col == 0) {
                    p.add(new JLabel(categories[row - 1]));/*
                                                             * row will have
                                                             * at least
                                                             * value of 1
                                                             * when control
                                                             * is at this
                                                             * line.
                                                             */
                } else {
                    form[row - 1][col - 1] = new JRadioButton();
                    bg.add(form[row - 1][col - 1]);/*
                                                     * add this button to
                                                     * the button group
                                                     */
                    p.add(form[row - 1][col - 1]);
                }
            }
        }// col for loop ends here.
    }// row for loop ends here.

    // Adding the panel to a scrollpane
    // scrollPane = new JScrollPane(p);
    scrollPane.add(p);
    // adding the scrollpane to the contentpane of the frame
    getContentPane().add(scrollPane, BorderLayout.CENTER);
}// method init ends here.

public static void main(String[] args) {
    new ScrollDemo2();
}// method main ends here.

}// class ScrollDemo2 ends here. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T22:43:48.887

在代码中初始化组件的顺序存在一些问题。这些有点难以挑选，所以我冒昧地重新组织你的代码以使事情更清晰。我想你会发现这段代码更可行。（注意：我删除了 BasicWindowAdapter 的导入和您对 ImageIcon 的调用）

一些外卖提示：

1.  尝试仅在一种方法中使用给定的组件。您的代码正在从 Constructor 和 init() 访问 scrollPane。
2.  不要犹豫，创建做一些非常具体的事情、接受特定输入并提供特定输出的方法。例如，下面的 createScrollPane() 采用 JPanel 并返回 JScrollPane。该方法的作用很清楚，并且不需要使用具有类作用域的变量。
3.  尽量不要在构造函数中构建 UI。一个好的做法是创建一个 init() 方法，并让 init() 调用其他方法来构建 UI 的特定部分。

这是您修改后的代码：

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ButtonGroup;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.JScrollPane;
import javax.swing.JViewport;
import javax.swing.ScrollPaneConstants;

public class ScrollDemo2 extends JFrame {

// Constructor
public ScrollDemo2() {
    super("JScrollPane Demonstration");
    init();
    setSize(300, 200);
    setVisible(true);
}// Constructor ends here.

private void init() {
    JPanel panel = createFormPanel();
    JScrollPane scrollPane = createScrollPane(panel);
    this.getContentPane().add(scrollPane, BorderLayout.CENTER);
}// method init ends here.

private JPanel createFormPanel() {
    JRadioButton form[][] = new JRadioButton[12][5];

    JPanel p = new JPanel();
    p.setSize(600, 400);
    p.setLayout(new GridLayout(13, 6, 10, 0));

    for (int row = 0; row < 13; row++) {
        // creating a button group in each iteration of the row loop
        ButtonGroup bg = new ButtonGroup();
        for (int col = 0; col < 6; col++) {
            // We need to create column headers in the first row
            if (row == 0)
                p.add(new JLabel(COUNTS[col]));
            else {
                /*
                 * When the control moves to a new row, check for the
                 * column. In the first column put row headers
                 */
                if (col == 0) {
                    p.add(new JLabel(CATEGORIES[row - 1]));/*
                                                             * row will have
                                                             * at least
                                                             * value of 1
                                                             * when control
                                                             * is at this
                                                             * line.
                                                             */
                } else {
                    form[row - 1][col - 1] = new JRadioButton();
                    bg.add(form[row - 1][col - 1]);/*
                                                     * add this button to
                                                     * the button group
                                                     */
                    p.add(form[row - 1][col - 1]);
                }
            }
        }// col for loop ends here.
    }// row for loop ends here.
    return p;
}

private JScrollPane createScrollPane(JPanel panel) {
    JScrollPane scrollPane = new JScrollPane(panel);

    /* Add in some JViewports for the column and row headers */
    JViewport jv1 = new JViewport();
    jv1.setView(new JLabel("COL LABEL"));

    scrollPane.setColumnHeader(jv1);

    JViewport jv2 = new JViewport();
    jv2.setView(new JLabel("ROW LABEL"));
    scrollPane.setRowHeader(jv2);

    /* And throw in an information button */
    JButton jb1 = new JButton("?");
    jb1.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            String message = "This is an active corner!";
            String title = "Information";
            int type = JOptionPane.INFORMATION_MESSAGE;
            JOptionPane.showMessageDialog(null, message, title, type);
        }// method actionPerformed ends here.
    }// Definition of inner class ActionListener ends here.
    );/* Passing arguments to method addActionListener ends here. */
    scrollPane.setCorner(ScrollPaneConstants.UPPER_LEFT_CORNER, jb1);

    return scrollPane;
}

public static void main(String[] args) {
    new ScrollDemo2();
}// method main ends here.

public static final String[] COUNTS = { " ", "0-1", "2-5", "6-10", "11-100", "101+" };
public static final String[] CATEGORIES = { "Household", "Office", "Extended Family",
        "Company (US)", "Company (World)", "Team", "Will",
        "Birthday Card List", "High School", "Country", "Continent",
        "Planet" };

}// class ScrollDemo2 ends here. 
```

# php - 多个相互依赖的查询

> ID：14175813
> 
> 赞同：2
> 
> 时间：2013-01-05T20:00:43.603
> 
> 标签：php, mysql, sql, mysqli

我有两个相互依赖的查询，即如果第一个查询未执行，则不应执行第二个查询，反之，如果无法执行第二个查询，则不应执行第一个查询。

```
INSERT INTO `table` VALUES (1,2,3)
UPDATE `otherTable` SET `val1`=1 WHERE `id`=$idOfInsert 
```

`ON DUPLICATE KEY UPDATE`不是答案。

我尝试使用`mysqli::multi_query`，但事实证明它会执行第一个，即使第二个无法执行（它会因错误而停止）。

我怎样才能在 PHP 中实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:09:16.013

如果您使用的引擎支持它（InnoDB、BDB），您可以使用事务。

有关示例，请参见[http://dev.mysql.com/doc/refman/5.0/en/commit.html](http://dev.mysql.com/doc/refman/5.0/en/commit.html)。

编辑：使用*mysqli*的快速示例：

```
$connection->autocommit(FALSE); // disable auto-commit and start a new transaction
$result  = $connection->query("INSERT INTO `table` VALUES (1,2,3)");
$result &= $connection->query("UPDATE `otherTable` SET `val1`=1 WHERE `id`=$idOfInsert");
if (!$result) {
  // One of the queries has failed: cancel the transaction
  $connection->rollback();
} else {
  // Both queries worked:commit the current transaction
  $connection->commit();
}
$connection->autocommit(TRUE); // enable auto-commit 
```

您可能想要优化查询（即，如果第一个查询失败，则不执行第二个查询，使用准备好的语句，...）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-03-01T15:12:22.630

我正在寻找的是交易。@tmuguet 的回答当时确实帮助了我，但现在从时间的角度来看，我想提供一个更新的答案。

每个查询都需要单独执行并使用准备好的语句来防止 SQL 注入。

```
try {
    // Start transaction
    $mysqli->begin_transaction();

    $mysqli->query('INSERT INTO `table` VALUES (1,2,3)');

    $stmt = $mysqli->prepare('UPDATE otherTable SET val1=1 WHERE id=?');
    $stmt->bind_param('s', $idOfInsert);
    $stmt->execute();

    // Commit changes
    $mysqli->commit();
} catch (\Throwable $e) {
    // Something went wrong. Rollback
    $mysqli->rollback();
    throw $e;
} 
```

当然，要使其正常工作，您需要启用 mysqli 错误报告。只需`new mysqli()`在您的代码中添加此行。

```
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-05T20:17:14.920

使用 [INSERT IGNORE] 使 SQL 服务器忽略错误。

```
INSERT IGNORE INTO `table` VALUES (1,2,3); 
```

然后使用 LAST_INSERT_ID() 获取插入的 ID，如果没有插入任何内容，则使用 0。如果没有 ID = 0 的记录，这将使 UPDATE 失败。

```
UPDATE `otherTable` SET `val1`=1 WHERE `id`=LAST_INSERT_ID(); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-01-05T20:03:17.200

将其分解为多个查询调用：

```
$result = mysql_query("INSERT ...");
if ($result) {
    mysql_query("UPDATE ...");
} 
```

但是“第二个不行就不要做”是不可能的。PHP 无法及时返回并警告第一个查询第二个查询失败。

# c - 从文件中读取（c 编程）

> ID：14175816
> 
> 赞同：0
> 
> 时间：2013-01-05T20:00:52.370
> 
> 标签：c, file

这是我的代码：

```
#include <stdio.h>
#define N 4
#define A_INPUT "agents.txt"

typedef struct
{
    long id;
    char lastName[20];
    char name[20];
    char type;
    int workHours;
    long managId;
    int sell[10];
} Agents;

Agents AgArr[N]={0};

void main()
{
    int i,j=1;
    FILE*agents;
    agents=fopen(A_INPUT,"r");

    if(agents == NULL)
    {
        printf("Unable to open file.\n");
        exit();
    }

    for (i=0; i<N; i++)
    {
        fscanf(agents, "%ld", &AgArr[i].id);
        fscanf(agents, "%s", &AgArr[i].lastName);
        fscanf(agents, "%s", &AgArr[i].name);
        fscanf(agents, "%c", &AgArr[i].type);
        fscanf(agents, "%d", &AgArr[i].workHours);
        fscanf(agents, "%ld", &AgArr[i].managId);
    } 
} 
```

这是我从中读取的文本文件：

```
045654987 Cohen Yael P 135 302546887
024587891 Cohen Rafi F 150 -1
306354487 Gabai Shai P 112 302546887
302546887 Benzur Gadi M 130 -1 
```

问题是数组没有得到所有文本，我得到空格和 0。如何正确扫描它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:04:13.550

您需要*仔细阅读*[fscanf(3)](http://linux.die.net/man/3/fscanf)的文档（并阅读两次）。

然后了解为什么有时在`fscanf`格式字符串中需要空格，也许

```
 if (fscanf(agents," %ld %s",&AgArr[i].id, &AgArr[i].lastName)==2) { 
```

（实际上它可以而且可能应该更多；你可以`fscanf`用六个参数进行一次但很长的调用，但你应该测试 的结果`fscanf`）。

你应该测试它的结果`fscanf`是否有意义。

你的`for`循环可能应该是

```
 for (i=0; !feof(agents) && i<10; i++) 
```

而且我相信您应该`FILE*`用一个名称来命名您的变量，以提醒它是某个文件（不是一组代理），例如`agf`或`agents_file`代替`agents`

# javascript - 如何动态调用这个包含构建页面所需内容的脚本并允许它只运行一次？

> ID：14175819
> 
> 赞同：2
> 
> 时间：2013-01-05T20:01:15.327
> 
> 标签：javascript, jquery, html, css, jquery-mobile

该脚本包含一些变量并做一些 jQuery 的东西。我需要它在页面正确加载时运行。

但是，当有人单击最初加载/创建的页面上的链接，转到该链接页面（外部但 jQuery Mobile）并点击后退按钮（浏览器或移动页面的标题中）时，脚本会再次运行。

我不想要这种行为，因为没有必要重建页面——所以我的性能受到了影响。

这是我加载脚本的方式：

```
url = $.url();
rawterm = url.param('t').toLowerCase();
term = decodeURIComponent(rawterm).replace(/\+/g, " ");

var script=document.createElement('script');
script.type='text/javascript';
script.src= rawterm + ".js";
$("body").append(script); 
```

被调用/创建的脚本有这样的东西：

```
tagLimit = 200;

var myName = rawterm;
var myKey = "somekey"
var updatePage = "mtl_u_master.html?t=" + myName;
var tagSearchPage = "mtl_s_master.html?t=" + myName;
var newestPage = "mtl_n_master.html?t=" + myName;

$('#searchPage').attr('href',tagSearchPage);
$('#updatePage').attr('href',updatePage);
$('#newestPage').attr('href',newestPage); 
```

对任何和所有替代方法开放。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T23:07:16.010

当你说 ：

> 但是，当有人单击最初加载/创建的页面上的链接时，会转到该链接页面（外部但 jQuery Mobile），

你的意思是你正在使用 rel="external"。如果你这样做了，那么没有任何帮助，因为 rel="external" 正在导致整个页面刷新，而我不是在谈论 data-role="page" 刷新，这将是一个完整的网页刷新。当您返回原始页面时，所有内容都将再次执行，包括您的脚本，但这应该不是问题，因为您的脚本第一次执行的所有内容现在都消失了（包括页面 DOM）。

更多相关信息可以在这里找到：http: [//jquerymobile.com/test/docs/pages/page-links.html](http://jquerymobile.com/test/docs/pages/page-links.html)

如果您不使用 rel="external" （记住 rel="external" 应该只用于从其他域加载页面），您的问题可以很容易地解决。您只需要使用 mobileinit 事件，如下所示：

```
$(document).on("mobileinit", function(){
    alert('Executed only once');
}); 
```

该事件只会执行一次，并且必须放在加载 jQuery mobile js 的 script 标签之前，如下所示：

```
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />     
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript" >
$(document).on("mobileinit", function(){
    alert('Executed only once');
});
</script>
<script type="text/javascript" src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

或像这样：

```
<script src="jquery.js"></script>
<script src="custom-scripting.js"></script>
<script src="jquery-mobile.js"></script> 
```

更多相关信息可以在这里找到：http: [//jquerymobile.com/test/docs/api/globalconfig.html](http://jquerymobile.com/test/docs/api/globalconfig.html)

# php - 如果 Locations 相等，则将多个结果合并为一个

> ID：14175823
> 
> 赞同：1
> 
> 时间：2013-01-05T20:01:29.697
> 
> 标签：php, mysql

我正在尝试创建谷歌地图标记来显示事件，但是我遇到的问题是有时事件发生在同一位置 - 因此标记重叠。

我想如果更多行具有相同的结果，是否可以将结果折叠成*一个*`venues.VENUE_LOCATION`。

因此，与其生成这样的 xml：

```
<marker lat="48.153938" lng="17.108459" venue="2" html="Event 1 - Jan 1" />
<marker lat="48.153938" lng="17.108459" venue="2" html="Event 2 - Jan 10" />
<marker lat="48.153938" lng="17.108459" venue="2" html="Event 3 - Jan 18" />
<marker lat="49.459843" lng="17.564821" venue="5" html="Event 55 - Jan 4" />
<marker lat="49.459843" lng="17.564821" venue="5" html="Event 70 - Jan 10" /> 
```

我会有一个标记，其中包含该位置所有标记的信息。

```
<marker lat="48.153938" lng="17.108459" venue="2" html="Event 1 - Jan 1<BR>Event 2 - Jan 10<BR>Event 3 - Jan 18" />
<marker lat="49.459843" lng="17.564821" venue="5" html="Event 55 - Jan 4<BR>Event 70 - Jan 10" /> 
```

知道我该怎么做吗？这是我当前的 php 代码

```
 $query = "SELECT
    events.ID,
    events.EVENT_NAME,
    events.start_datetime,
    events.end_datetime,
    events.VENUE_LOCATION,
    venues.VENUE_NAME,
    venues.VENUE_LOCATION,
    venues.LAT,
    venues.LNG,
    GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME) AS MUSIC_STYLE_NAME
    FROM events
    INNER JOIN venues 
    ON events.VENUE_LOCATION = venues.ID
    INNER JOIN events_music_styles
    ON events.ID = events_music_styles.event_id
    INNER JOIN music_styles
    ON events_music_styles.music_style_id = music_styles.id
    WHERE start_datetime >= '$phpFromDate'
    AND start_datetime <= '$phpToDate' 
";

$result = mysql_query($query);
if (!$result) {
  die('Invalid query: ' . mysql_error());
}

header("Content-type: text/xml");
echo '<markers>';

if(mysql_num_rows($result) > 0)
{
while ($row = @mysql_fetch_assoc($result))
{
  echo '<marker ';
  echo 'event_id="' . parseToXML($row['ID']) . '" ';
  echo 'lat="' . parseToXML($row['LAT']) . '" ';
  echo 'lng="' . parseToXML($row['LNG']) . '" ';
  echo 'venue="' . parseToXML($row['VENUE_LOCATION']) . '" ';
  echo '/>';
}
}
echo '</markers>'; 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T11:06:23.697

尝试根据以下内容修改您的 SQL 查询`GROUP_CONCAT`：

```
GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME SEPARATOR '<br>') AS MUSIC_STYLE_NAME 
```

`GROUP BY`在查询末尾添加语句：

```
GROUP BY venues.LAT, venues.LNG 
```

然后当您打印标记标签时，添加`html`属性：

```
echo 'html="' . parseToXML($row['MUSIC_STYLE_NAME']) . '" '; 
```

所需代码：

```
$query = "SELECT
    events.ID,
    events.EVENT_NAME,
    events.start_datetime,
    events.end_datetime,
    events.VENUE_LOCATION,
    venues.VENUE_NAME,
    venues.VENUE_LOCATION,
    venues.LAT,
    venues.LNG,
    GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME SEPARATOR '<br/>') AS MUSIC_STYLE_NAME
    FROM events
    INNER JOIN venues 
    ON events.VENUE_LOCATION = venues.ID
    INNER JOIN events_music_styles
    ON events.ID = events_music_styles.event_id
    INNER JOIN music_styles
    ON events_music_styles.music_style_id = music_styles.id
    WHERE start_datetime >= '$phpFromDate'
    AND start_datetime <= '$phpToDate'
    GROUP BY venues.LAT, venues.LNG
";

$result = mysql_query($query);
if (!$result) {
  die('Invalid query: ' . mysql_error());
}

header("Content-type: text/xml");
echo '<markers>';

if(mysql_num_rows($result) > 0)
{
    while ($row = @mysql_fetch_assoc($result))
    {
      echo '<marker ';
      echo 'event_id="' . parseToXML($row['ID']) . '" ';
      echo 'lat="' . parseToXML($row['LAT']) . '" ';
      echo 'lng="' . parseToXML($row['LNG']) . '" ';
      echo 'venue="' . parseToXML($row['VENUE_LOCATION']) . '" ';
      echo 'html="' . parseToXML($row['MUSIC_STYLE_NAME']) . '" ';
      echo '/>';
    }
}
echo '</markers>'; 
```

# php - cookie 仅在设置它们的页面上确定

> ID：14175824
> 
> 赞同：0
> 
> 时间：2013-01-05T20:01:36.510
> 
> 标签：php, cookies

我有一个使用 mvc 模式的大网站，很难提供链接和内容的详细信息，但我想问一个简单的问题。

当我像这样设置cookie时`setcookie("countviews_interview_downloads_1",'1',$this->registry->config['countviews_cookie_lifetime']);`

然后像这样检查：

```
if (isset($_COOKIE['countviews_interview_downloads_1']))
{
  print('msg: cookie is on interview #1');
  exit;
} 
```

`msg: cookie is on interview #1`仅在已设置的页面上出现一条消息。

如果我把这个检查cookie的代码放在它没有出现的任何其他页面上，就像它从未设置过一样。

请帮帮我。谢谢！。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:11:42.207

如果您没有为 cookie 指定任何路径，则 cookie 仅对同一路径有效。在你的情况下，那将是`/interview/christmas/countdownloads`. 因此，只需将 cookie 的路径设置为`/`，它就会出现在所有其他路径中：

```
setcookie("countviews_interview_downloads_1",'1',$this->registry->config['countviews_cookie_lifetime'], '/') 
```

# php - php搜索函数返回错误

> ID：14175830
> 
> 赞同：1
> 
> 时间：2013-01-05T20:01:58.230
> 
> 标签：php, search

好的，我今天一直在为我的网站创建搜索功能，到目前为止一切顺利，我找到了一个真正有用的 youtube 教程，我已将所有代码放入 search.php 文件中。

但是我收到了这些错误，也许有人可以向我解释并可能提供帮助

```
Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in /home/content/34/9587634/html/MyDomain.Com/search.php on line 21

Warning: mysql_fetch_assoc() expects parameter 1 to be resource, boolean given in /home/content/34/9587634/html/MyDomain.Com/search.php on line 25 
```

这是我使用的代码。我已经尝试搜索，但似乎无法找到问题

```
<html>
<?php
$k = $_GET['k'];
$terms = explode(" ", $k);
$query = "SELECT * FROM content WHERE ";

foreach ($terms as $each){
$i++; 

if ($i == 1)
$query .= "content LIKE '%$each%' ";
else
$query .= "OR content LIKE '%$each%' ";
}

include('config.php');

$query = mysql_query($query);
$numrows = mysql_num_rows($query);

while ($row = mysql_fetch_assoc($query)) {
$FirstName = $row['FirstName'];

}

?>
</html> 
```

非常感谢所有帮助谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:13:31.323

如果查询包含错误，[mysql_query()将返回 FALSE。](http://php.net/manual/ru/function.mysql-query.php)因此，您尝试执行查询**mysql_query($query)**和 mysql_query 返回 FALSE(也许)。函数[mysql_num_rows()](http://php.net/manual/en/function.mysql-num-rows.php)需要一个参数，它必须是 mysql_query() 函数的结果。不是布尔值。

但是 $query 是假的。

FALSE 是布尔值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:25:12.107

**只需尝试以下示例：**

```
<?php

if($_GET['k'])
{
    $terms = explode(" ", $k);

        foreach ($terms as $value) {

        if($value=='') $q.=""; else $q.="(`content-value` LIKE '%$value%' OR `content-value` LIKE '%$name%') ";

        if($q=="") $total=0;

    else
    {
        $search = "SELECT * FROM ".CONTENT." WHERE".$q;
        $search = str_replace('WHERE','WHERE ',$search);
        $search_res = mysql_query($search) or die("Search: ".$search.mysql_error());
        $total = mysql_num_rows($search_res);
    }
    }
}
?> 
```

我认为这可以帮助您解决问题。

# asp.net-mvc - 我们如何从视图中的 JQuery 访问模型的属性？

> ID：14175831
> 
> 赞同：0
> 
> 时间：2013-01-05T20:02:01.163
> 
> 标签：asp.net-mvc, json

我的模型有一个包含项目集合的字段。我想从与此特定模型绑定的视图中的 jquery 访问该集合。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T03:16:32.197

这是一种巧妙的方法。通过 foreach 循环构建 JSON 数据对象。通过 ajax 调用加载数据会更好，但这是不同日子的不同解决方案。

在这里，我假设您有一个至少具有 Id 和 Name 属性的项目集合。你会想让你的@foreach 循环比我的好一点，因为 JSON 确实不允许在最后一项末尾有额外的 ','。

```
var data = [
    @foreach (var item in Model.MyCollection)
    {
        <text>{"key":"@item.Id", "value":"@item.Name"},</text>
    }
];
$.each(data, function(i) {
    alert(data[i].key + ": " + data[i].value);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:48:43.550

我做了这样的事情，不确定它有多“正确”，但它有效并且对我有意义。

```
var view = Backbone.View.extend({
    el: $('window'),
    render: function() {
        var that = this;
        var model = new myModel();
        model.fetch({
            success: function({
                that.dataModel = model;
            });
        });
    }

}); 
```

然后在任何你可以做 this.dataModel 的地方，它应该是你的模型

# php - HTML表单不提交数据？

> ID：14175833
> 
> 赞同：0
> 
> 时间：2013-01-05T20:02:05.517
> 
> 标签：php, html, forms, form-submit, splash-screen

我正在尝试为我的网站创建一个 Splash 页面，由 Boonex dolphin 提供支持，但似乎无法让登录工作。（它只是要求用户再次登录）。

这是代码。

```
<form id="login_box_form" action="member.php" method="post" onsubmit="validateLoginForm(this); return false;"
      class="form_advanced">
    <input class="form_input_hidden bx-def-font" type="hidden" name="csrf_token" value="cV4xs5rYHF2=caQ68kyq"/>
    <input type="text" name="ID" value="Username" maxlength="20" class="default login" onclick="clearval('Username);"
           style="margin-right: 5px;"/>
    <input type="password" name="Password" value="Password" class="default login" onclick="clearval('Password');"/>
</form>
<a href="member.php" id="loginButton" class="sidebarButton floatLeft" onclick="document.login_box_form.submit();"><span>login</span></a> 
```

有任何想法吗？

（现场演示[http://cometogethersupport.pro/splash.php](http://cometogethersupport.pro/splash.php)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:06:35.867

```
document.login_box_form.submit() 
```

应该是

```
document.getElementById('login_box_form').submit() 
```

在[Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/)控制台中，当我尝试这两种方法时，我看到了以下内容：

```
> document.login_box_form
  undefined
> document.getElementById('login_box_form');
  <form id=​"login_box_form" action=​"http:​/​/​cometogethersupport.pro/​member.php" method=​"post" onsubmit=​"validateLoginForm(this)​;​ return false;​" class=​"form_advanced">​…​&lt;/form>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:08:57.337

您正在使用表单 ID 获取要提交的表单（）。或者像这样向表单添加一个属性：

```
<form name="login_box_form"></form> 
```

或将您的函数调用更改为：

```
onclick="document.getElementById('login_box_form').submit()" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T17:35:54.513

不禁注意到这一点：

```
clearval('Username); 
```

忍不住要你改！（对不起！）

```
clearval('Username'); 
```

另外，为什么不试试这个，假设这是您将数据提交到的地方：

```
<form  id="login_box_form" action="http://cometogethersupport.pro/member.php" method="post" onsubmit="validateLoginForm(this); return false;" class="form_advanced"> 
```

PS：

```
(2) Uncaught SyntaxError: Unexpected token ILLEGAL Line 99 
```

更新 jQuery？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T23:14:29.047

好的，我设法在标签中使用以下代码解决了这个问题：

```
 <script type="text/javascript">
function frmSubmit() {
document.login_box_form.submit();
}
</script> 
```

然后将超链接设置为

```
javascript:frmSubmit(); 
```

希望这可以帮助其他人解决这个问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T23:23:28.570

您是否尝试`return false`从标签的`onSubmit`属性中删除 ？`<form`

# php - 不要在 bbCode 标签内搜索

> ID：14175834
> 
> 赞同：0
> 
> 时间：2013-01-05T20:02:06.290
> 
> 标签：php, search, bbcode

我有一个普通的 bbCode 函数，例如在我的帖子中搜索`[b]`并`[/b]`用粗体文本替换它们。当访问者在我的博客上搜索某个帖子时，他或她可能会搜索图像的文件名 ( `[img]path/to/image.jpg[/img]`)。如果发生这种情况，由于突出显示，图像将从帖子中消失。

我怎样才能让搜索引擎（这是一个常规的`WHERE column LIKE '%string%'`）**不在**我的 bbCodes 中搜索？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:45:37.247

您可以添加另一个子句来排除某些标签：

```
WHERE column LIKE '%string%'
AND column NOT LIKE '%[img]%[/img]%' 
```

请注意，这样做会排除所有带有 [img] 标签的结果，即使您可能需要考虑其他标签。由于这可能不是您真正想要的，因此您应该保持查询不变，并使用 PHP 中的正则表达式进行替换。

# memory-management - 自动内存管理 == 垃圾收集？

> ID：14175835
> 
> 赞同：1
> 
> 时间：2013-01-05T20:02:09.103
> 
> 标签：memory-management, garbage-collection

一位朋友正在用非英语语言写一本书，但在翻译垃圾收集 (GC) 时遇到了麻烦。另一方面，自动内存管理 (AMM) 的翻译效果很好。

维基百科[关于 GC](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)的文章指出 GC 是 AMM 的一种形式。同一篇文章还指出，引用计数 (RC) 是垃圾收集的一种形式。所以，看起来我们有 AMM 作为 GC 的超集，而 GC 作为 RC 的超集。但是，有许多非正式文本可以互换使用 GC 和 AMM。因此，似乎可以有把握地说，AMM（也称为 GC）是通过跟踪指针识别（不）可达对象或依赖引用计数来实现的。

我的问题是：是否有任何 AMM 技术不能归类为 GC？或者，等效地，GC 和 AMM 之间的区别是否合理？

请随时评论我对 AMM (GC) 分类的疯狂猜测 :-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:05:11.833

通常情况下，这些术语没有官方定义。但是您可以考虑，例如，C++ 的[RAII 惯用语](http://en.wikipedia.org/wiki/RAII)是一种自动内存管理形式。它与引用计数或垃圾收集完全不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:06:11.463

我认为这更多的是一个常见用法和读者期望的问题，而不是精确的定义。当然，任何自动内存管理技术都会“收集垃圾”，因此是 GC。但在实践中，如果你说“GC”，人们会认为你指的是具有更具体属性的东西（通常是：不确定的终结、未引用对象的自动检测、收集循环的能力），如果你不是，就会感到困惑.

# php - 使用 Symfony 向 mysql 数据库添加列

> ID：14175842
> 
> 赞同：0
> 
> 时间：2013-01-05T20:02:54.277
> 
> 标签：php, sql, symfony

当我在本地机器上使用 Symfony 时，如果我需要更新我的数据库模式（比如说，向表中添加一个新列），我修改了实体文件，然后运行`php console doctrine:schema:update --force`​​. 现在我的代码在远程服务器上（没有 SHH 访问可用）。我可以再次修改实体，然后使用 phpMyAdmin 修改表，这样我就不需要执行更新命令，但我不确定这是否正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:33:23.133

[正如文档中所说](http://symfony.com/doc/current/book/doctrine.html#creating-the-database-tables-schema)，使用`doctrine:schema:update --force`是强大的，但不是最好的方法：

> 利用此功能的更好方法是通过[迁移](http://symfony.com/doc/current/bundles/DoctrineMigrationsBundle/index.html)，它允许您生成这些 SQL 语句并将它们存储在迁移类中，这些迁移类可以在您的生产服务器上系统地运行，以便安全可靠地跟踪和迁移您的数据库模式。

看看引用中的链接 (to `DoctrineMigrationsBundle`) 这是如何工作的。

# c# - 与 c# 中委托声明的区别

> ID：14175850
> 
> 赞同：5
> 
> 时间：2013-01-05T20:03:23.443
> 
> 标签：c#, delegates

> **可能重复：**
> [为什么使用“new DelegateType(Delegate)”？](https://stackoverflow.com/questions/7735159/why-use-new-delegatetypedelegate)
> [new Thread(void Target()) 和 new Thread(new ThreadStart(void Target())) 有什么区别？](https://stackoverflow.com/questions/10482121/what-is-the-difference-between-new-threadvoid-target-and-new-threadnew-thre)

所以我经历了一点委托，并以某种方式得到了整个想法。现在，我到处都能看到这样的例子：

```
public delegate void Deleg();
Deleg deleg = new Deleg(FunctionName);

deleg(); 
```

我认为这会创建一个委托对象，其函数指向作为参数传递给构造函数。

现在，我也可以这样做：

```
public delegate void Deleg();
public Deleg deleg;  

deleg = FunctionName;
deleg(); 
```

这似乎只创建一个引用，并传递函数的地址。它的工作原理是一样的，并且具有所有的委托功能。

但是现在，不管我在第二个例子中多写了一行，由于第一个在教程中更受欢迎，我真的会从第二个中失去或获得一些东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:09:38.377

好处是打字少了一点。编译器现在比最初更聪明，所以它可以隐式地进行方法组转换，这就是你不必`new Deleg(FunctionName)`再做的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:13:24.357

如果您在同一行添加分配（就像您在第一个示例中所做的那样），那么您键入的代码量大致相同。

```
public delegate void Deleg();
public Deleg deleg = FunctionName;
deleg(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T20:13:52.517

其次是委托推断。

该方法的顺序和类型是否与委托的输入参数列表匹配？

*   **是**-> 推断委托，因为方法签名与委托的签名匹配。

*   **否**-> 委托和方法输入参数不匹配。不可能进行委托类型推断。

使用委托类型推断会丢失一些东西吗？**没有**。这是同一件事，我认为这是更可取的：更少冗长的代码，它提高了可读性。

此外，委托类型推断为您添加了另一个选项：

```
public delegate void Do();

Do some = () =>
{
   // Do stuff
}; 
```

或者

```
public delegate void Do(string a, string b);

// C# compiler infers the delegate from the lambda/anonymous method signature and it infers the type of the whole parameters too!
Do some = (a, b) =>
{
   // Do stuff
} 
```

# c# - C#：是否可以有条件地从编译中排除某些文件？

> ID：14175853
> 
> 赞同：6
> 
> 时间：2013-01-05T20:03:28.670
> 
> 标签：c#, visual-studio-2010, silverlight

我想有条件地编译一个不包括特定类的项目。可能吗？

**更新：**

基本上我正在寻找的是通过不编译特定类（存储在单独的 .cs 文件中）及其所有依赖项来通过命令行指令减小生成的 .xap 文件的大小。

这是[MSDN](http://msdn.microsoft.com/en-us/library/7z0wd3d7%28v=vs.71%29.aspx)建议手动执行此操作的方式。如果有办法以自动化的方式有条件地做到这一点，那将是一个完美的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T14:05:31.120

项目文件`ProjectName.cproj`是一个包含项目属性和编译器指令的纯 xml 文件。要包含的文件列在`<ItemGroup>...</ItemGroup>`标签之间。可以有一个或多个这样`<ItemGroup>`的列表。因此，您要做的就是将要有条件地编译的文件放入一个单独的文件中，`<ItemGroup>`然后添加一个条件作为属性：

```
<ItemGroup Condition=" '$(BUILD)' == 'IMAGE' ">
    <Compile Include="PngEncoder\Adler32.cs" />
    <Compile Include="PngEncoder\CRC32.cs" />
    <Compile Include="PngEncoder\Deflater.cs" />
    <Compile Include="PngEncoder\DeflaterConstants.cs" />
    <Compile Include="PngEncoder\DeflaterEngine.cs" />
    <Compile Include="PngEncoder\DeflaterHuffman.cs" />
    <Compile Include="PngEncoder\DeflaterOutputStream.cs" />
    <Compile Include="PngEncoder\DeflaterPending.cs" />
    <Compile Include="PngEncoder\IChecksum.cs" />
    <Compile Include="PngEncoder\PendingBuffer.cs" />
    <Compile Include="PngEncoder\PngEncoder.cs" />
</ItemGroup> 
```

`BUILD`现在这组文件只有在定义了名称和值的属性时才会包括在内`"IMAGE"`。可以在项目文件本身中定义属性：

```
<PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Release</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.50727</ProductVersion>
    ...
</PropertyGroup> 
```

或者从命令行传入：

```
msbuild ProjectName.cproj /p:BUILD=IMAGE 
```

`msbuild.exe`带有**.NET 框架**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T20:05:07.513

你可以使用[`ConditionalAttribute`](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)这个：

> 向编译器指示应忽略方法调用或属性，除非定义了指定的条件编译符号。

```
[Conditional("SomeCondition")]
public void WillCompileOnlyIfSomeConditionIsDefined()
{
} 
```

另一种方法是使用[预处理器指令](http://msdn.microsoft.com/en-us/library/ed8yd1ha.aspx)：

```
#if !SomeCondition
  // will only compile if SomeCondition is false
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-08T23:55:34.703

在带有 Visual Studio Online 的构建中，ItemGroup 元素中的条件属性将被忽略。

[如此处](https://whathecode.wordpress.com/2012/10/07/conditional-project-or-library-reference-in-visual-studio/)所述，支持使用`When/Choose/Otherwise`属性。

```
 <Choose>
     <When Condition="'$(Configuration)' == 'Debug With Project References'">
       <ItemGroup>
        <ProjectReference Include="..\SomeProject\SomeProject.csproj">
        <Project>{6CA7AB2C-2D8D-422A-9FD4-2992BE62720A}</Project>
        <Name>SomeProject</Name>
      </ProjectReference>
    </ItemGroup>
  </When>
      <Otherwise>
        <ItemGroup>
           <Reference Include="SomeProject">
             <HintPath>..\Libraries\SomeProject.dll</HintPath>
           </Reference>
         </ItemGroup>
       </Otherwise>
    </Choose> 
```

# c++ - C++：减去向量

> ID：14175858
> 
> 赞同：8
> 
> 时间：2013-01-05T20:03:56.610
> 
> 标签：c++

我有两个向量。我需要从vector1中删除vector2中的内容。

[编辑：尚不清楚这是否意味着根据下面的链接进行每个元素减法或设置差异]

我使用 Visual Studio 2010。

似乎有一种方法：http: [//msdn.microsoft.com/en-us/library/system.windows.vector.subtract.aspx](http://msdn.microsoft.com/en-us/library/system.windows.vector.subtract.aspx)

但它不知何故不起作用，甚至没有代码示例。

你可以帮帮我吗？如果不存在标准方法，也许您可​​以建议如何通过循环组织它？先感谢您。

```
#include "stdafx.h";
#include <vector>;
#include <iostream>

using namespace std;

int main ()
{
  vector<int> vector1;
  vector<int> vector2;

  for (int i = 0; i < 10; i++)
  {
vector1.push_back (i);
  }

  for (int i = 0; i < 6; i++)
  {
    vector2.push_back (i);
  }

  myvector1 = Subtract(vector1, vector2); 

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-05T20:05:01.087

您应该使用`std::set_difference`：[http ://en.cppreference.com/w/cpp/algorithm/set_difference](http://en.cppreference.com/w/cpp/algorithm/set_difference)

首先你需要`sort`你的`vectors`, 因为`set_difference`在*排序*范围内操作。也就是说，除非它们已经*排序*（例如在您的用例中）。

```
std::sort(vector1.begin(), vector1.end());
std::sort(vector2.begin(), vector2.end()); 
```

然后你这样称呼它：

```
std::vector<int> difference;
std::set_difference(
    vector1.begin(), vector1.end(),
    vector2.begin(), vector2.end(),
    std::back_inserter( difference )
); 
```

这将附加到在 中找到但在中找不到`difference`的那些元素。`vector1``vector2`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-11-21T22:58:41.170

`std::transform(vector1.begin(), vector1.end(), vector2.begin(), vector1.begin(), std::minus<int>())`

第 4 个参数是结果的位置。即使向量的大小不同，它也应该可以工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T20:31:36.450

如果您不想使用`std::set_difference`，可以这样做：

```
// substracts b<T> to a<T>
template <typename T>                                                                                            
void
substract_vector(std::vector<T>& a, const std::vector<T>& b)                                                     
{
    typename std::vector<T>::iterator       it = a.begin();
    typename std::vector<T>::const_iterator it2 = b.begin();

    while (it != a.end())
    {
        while (it2 != b.end() && it != a.end())
        {
            if (*it == *it2)
            {
                it = a.erase(it);
                it2 = b.begin();
            }

            else
                ++it2;
        }
        if (it != a.end())
            ++it;

        it2 = b.begin();
    }
} 
```

这将从中的`a`所有值中删除`b`。

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-20T21:25:05.760

我建议切换到具有内置向量算术运算的 EigenVectors：

[http://eigen.tuxfamily.org/dox-devel/group__TutorialMatrixArithmetic.html](http://eigen.tuxfamily.org/dox-devel/group__TutorialMatrixArithmetic.html)

因此，您可以使用 +、-、*、/ 等运算符

```
#include <iostream>
#include <Eigen/Dense>
using namespace Eigen;
int main()
{
  Matrix2d a;
  a << 1, 2,
       3, 4;
  MatrixXd b(2,2);
  b << 2, 3,
       1, 4;
  std::cout << "a + b =\n" << a + b << std::endl;
  std::cout << "a - b =\n" << a - b << std::endl;
  std::cout << "Doing a += b;" << std::endl;
  a += b;
  std::cout << "Now a =\n" << a << std::endl;
  Vector3d v(1,2,3);
  Vector3d w(1,0,0);
  std::cout << "-v + w - v =\n" << -v + w - v << std::endl;
} 
```

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2018-05-29T12:43:03.597

/*最简单的方法*/

```
#include<stdio.h>
main()
{
 int A,B,C;
 printf("enter the two numbers 1st 2nd=");
 scanf("%d",&A);
 scanf("%d",&B);
 C=A-B;
 printf("Result=");
 printf
} 
```

# database - Cloudbees 分离开发 和生产数据库

> ID：14175859
> 
> 赞同：1
> 
> 时间：2013-01-05T20:03:59.680
> 
> 标签：database, environment, cloudbees

在 Cloudbees 中使用开发和生产数据库的推荐方法是什么？有没有办法保持相同的 cloudbees-web.xml 配置并让环境负责连接正确的 dev/prod 数据库？

我在 cloudbees 中使用 Java/JPA/MySQL，或者至少尝试使用。

Ĵ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T07:44:15.100

一个选项是在 cloudbees-web.xml 中使用“[环境”](https://wiki.cloudbees.com/bin/view/RUN/CloudBeesWebXml)

更好的选择（恕我直言）是使用 SDK[将数据源绑定](https://developer.cloudbees.com/bin/view/RUN/Resource+Management)到应用程序，以便部署完全相同的 WAR，而无需未使用的配置或 cloudbees 特定的部署描述符（cloudbees-web.xml 则无用），但绑定到 dev/prod数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T00:56:25.310

是的。您可以`cloudbees-web.xml`在表单中使用属性扩展。`${property_name}`

然后，您使用该`bees config:set`命令来定义`property_name`要部署到的应用程序 ID 的值。

因此，每当您部署到`app-dev`实例时，它将使用 dev 数据库，而部署到`app-prod`实例时将使用 prod 数据库。

这对于存储敏感信息也很有用，例如 jdbc 密码，因为它们不再嵌入在`.war`文件中

有关详细信息，请参阅[cloudbees wiki](http://developer.cloudbees.com/bin/view/RUN/Configuration+Parameters)

# ruby-on-rails - has_many IF 条件

> ID：14175875
> 
> 赞同：3
> 
> 时间：2013-01-05T20:05:34.407
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有可以有女士的广告，但前提是类型是“俱乐部”。

有没有一种方法可以做到这一点？特别是不创建女士对象？如果她的父母是 type=club，我是否必须在创建之前检查一个女士对象？

```
class Advertisement < ActiveRecord::Base

  validates_inclusion_of :type, in: %w(club lady)

  has_many :ladies, :dependent=>:destroy

  #only have ladies if the club =
  def ladies 
    return nil unless type == "club"
    super    
  end

end 
```

我正在使用 Rails 3.2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:36:58.107

Rails 做到这一点的方法是 STI：

```
 class Advertisement < ActiveRecord::Base
 end

 class LadyAd < Advertisement
   has_many :ladies, :dependent=>:destroy
 end 
```

并且只有 LadyAd 对象能够拥有女士。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T12:13:39.473

似乎所有这一切都是将组合（has_many）与继承（女士<广告）混合在一起，这没有多大意义（技术上和概念上）。如果是这种情况并且您没有使用 Lady 和 Club 对象，您至少应该将类型重命名为 ad_type...

假设您要进行自我参照加入，那么您将需要一个 club_id 列：

```
class Advertisement < ActiveRecord::Base
   has_many :ladies, -> {where(type: 'club')}, class_name: "Advertisment"
 end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:18:57.043

也许使用活动记录关联扩展：（使用 proxy_association.owner）

[http://guides.rubyonrails.org/association_basics.html#association-extensions](http://guides.rubyonrails.org/association_basics.html#association-extensions)

```
module LadiesAtClub
  def at_club
    # you may need to iterate over an array or something here...
    proxy_association.owner.type == 'club'
  end
end

class Advertisement < ActiveRecord::Base
  has_many :ladies :extend => LadiesAtClub
end 
```

# javascript - 在 Rails 应用程序中实现 WrapBootstrap 主题

> ID：14175879
> 
> 赞同：8
> 
> 时间：2013-01-05T20:06:05.393
> 
> 标签：javascript, css, ruby-on-rails, twitter-bootstrap

我刚买了一个 wrapbootstrap 主题并试图将它插入到我的 rails 应用程序中。一些 css 像 padding、navbar、glyphicons 和大多数 javascripts 都不能正常工作。我将所有样式表和 javascripts 分别复制到 assets/stylesheets 和 assets/javascripts 中。知道如何解决这些问题吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-05T22:29:48.400

确实，这是一个不错的主题集合。您应该首先打开`css`文件并将所有对 dir 的调用替换为`../img/`plain`images/`以使管道找到主题的图形元素。那是容易的部分。

例如，为了使用字形，您应该在 assets 下创建一个新目录`fonts`。然后将字形图像复制到那里并展开`application.rb`文件中的可用资产，如下所示：

```
 config.assets.paths << Rails.root.join("app", "assets", "fonts") 
```

之后，您应该将您的重命名`font-awesome.css`为`font-awesome.css.scss.erb`并更改其中的`@font-face`声明，如下所示：

```
@font-face {
font-family: "FontAwesome";
src: url('<%= asset_path('fontawesome-webfont.eot')%>');
src: url('<%= asset_path('fontawesome-webfont.eot?#iefix')%>') format('eot'), url('<%=    asset_path('fontawesome-webfont.woff')%>') format('woff'), url('<%= asset_path('fontawesome-webfont.ttf')%>') format('truetype'), url('<%= asset_path('fontawesome-webfont.svg#FontAwesome')%>') format('svg');
font-weight: normal;
font-style: normal;
} 
```

如果我错过了一些小部分，那是因为周六晚上的红酒......不要犹豫，询问更多细节。

# android - 如何本地分析 ACRA 崩溃报告

> ID：14175882
> 
> 赞同：0
> 
> 时间：2013-01-05T20:06:41.837
> 
> 标签：android, mongodb, analysis, acra

现在使用[ACRA](https://github.com/ACRA/acra/wiki/AdvancedUsage#wiki-Implementing_your_own_sender)几天并将报告发送到我的 MongoDb 后端 HTTPS 服务器，是否有一些工具可以在我的 PC 上使用来分析崩溃数据。

我在想我可以在本地处理这个问题，而不使用任何 Bugsense、Zubhium、HockeyApp、Google Docs。我知道这个问题有点可疑，但我找不到有关此的信息，因为一般方式似乎暗示了上述 Bugsense，Zub。

我知道通过使用上述内容，我可以更丰富、更好地了解崩溃数据。

**更新**我尝试了 Google Docs 以查看它是如何工作的，并最终实现了我自己的[sender](https://github.com/ACRA/acra/wiki/AdvancedUsage#wiki-Implementing_your_own_sender)，发送到我的 HTTPS 服务器。现在崩溃日志只是保存到 MongoDb`Document`

**更新** 我在 google play 市场上有一个应用程序，它正在使用 ACRA。该应用程序具有自定义 ACRA `ReportSender`，它将报告数据发送回我的 HTTPS 服务器。我想自己解决这个问题，因为该应用程序已经使用互联网

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-06T06:00:40.257

为什么要将崩溃报告发送到开发环境中的本地服务器？它更容易，只需通过 adb 直接使用 logcat 输出，您将获得更详细的信息。

# ios - 导航栏按钮动画错误

> ID：14175884
> 
> 赞同：0
> 
> 时间：2013-01-05T20:07:04.250
> 
> 标签：ios, uinavigationcontroller, uiimageview, uibarbuttonitem, uinavigationitem

以下尝试制作导航按钮并为其设置动画，但是我认为我遗漏了一些东西。

请让我知道我哪里出错了。

谢谢！这是在自定义 UINavigationItem 类中

```
-(void)awakeFromNib{
    [super awakeFromNib];
    UIImage *myimage = [UIImage imageNamed:@"navBarFilter.png"];
    NSArray * imageArray  = [[NSArray alloc] initWithObjects:
                             [UIImage imageNamed:@"navBarFilter.png"],
                             [UIImage imageNamed:@"navBarFilter1.png"],
                             [UIImage imageNamed:@"navBarFilter2.png"],
                             [UIImage imageNamed:@"navBarFilter3.png"],
                             [UIImage imageNamed:@"navBarFilter4.png"],
                             [UIImage imageNamed:@"navBarFilter5.png"],
                             nil];

    CGRect frameimg = CGRectMake(0, 0, myimage.size.width, myimage.size.height);

    UIButton *someButton = [[UIButton alloc] initWithFrame:frameimg];
    [someButton setBackgroundImage:myimage forState:UIControlStateNormal];

    UIBarButtonItem *filterButton =[[UIBarButtonItem alloc] initWithCustomView:someButton];

    someButton.imageView.animationImages =imageArray;
    someButton.imageView.animationDuration=2.0;
    someButton.imageView.contentMode=UIViewContentModeBottomLeft;

    [someButton.imageView startAnimating];

    self.rightBarButtonItem =filterButton;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:55:34.740

弄清楚了：

```
-(void)awakeFromNib{
    [super awakeFromNib];

    NSArray * imageArray  = [[NSArray alloc] initWithObjects:
                             [UIImage imageNamed:@"navBarFilter.png"],
                         [UIImage imageNamed:@"navBarFilter1.png"],
                         [UIImage imageNamed:@"navBarFilter2.png"],
                         [UIImage imageNamed:@"navBarFilter3.png"],
                         [UIImage imageNamed:@"navBarFilter4.png"],
                         [UIImage imageNamed:@"navBarFilter5.png"],
                         nil];
    UIImageView *imageView = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"navBarFilter.png"]];

    imageView.animationImages =imageArray;
    imageView.animationDuration=1.5;

    UIButton *someButton = [UIButton buttonWithType:UIButtonTypeCustom];
    someButton.bounds=imageView.bounds;
    [someButton addSubview:imageView];

    UIBarButtonItem *filterButton =[[UIBarButtonItem alloc] initWithCustomView:someButton];

    self.rightBarButtonItem =filterButton;
    [imageView startAnimating];

} 
```

# ios - 编辑时iOS UITextField未清除

> ID：14175885
> 
> 赞同：1
> 
> 时间：2013-01-05T20:07:09.090
> 
> 标签：ios, uitableview, uitextfield, textfield, placeholder

我有一个标准的 UITextField，已添加到 UITableViewCell 中，每当我去编辑它时，其中的文本都不会清除。我试过放置一个占位符，编辑时也不会清除。这是怎么回事？

```
if (indexPath.row == 1) {
        cell.textLabel.text = @"Device ID";
        cell.accessoryType = UITableViewCellAccessoryNone;
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
        deviceID = [[UITextField alloc] initWithFrame:CGRectMake(115, 11, 388, 22)];
        deviceID.delegate = self;
        deviceID.adjustsFontSizeToFitWidth = YES;
        deviceID.font = [UIFont boldSystemFontOfSize:15];
        deviceID.textColor = [UIColor blackColor];
        deviceID.autocorrectionType = UITextAutocorrectionTypeNo;
        deviceID.autocapitalizationType = UITextAutocapitalizationTypeNone;
        deviceID.textAlignment = NSTextAlignmentLeft;
        deviceID.clearButtonMode = UITextFieldViewModeWhileEditing;
        deviceID.keyboardType = UIKeyboardTypeDefault;
        deviceID.backgroundColor = [UIColor clearColor];
        deviceID.delegate = self;
        deviceID.clearsOnBeginEditing = YES;
        deviceID.text = [[NSUserDefaults standardUserDefaults] objectForKey:DEVICE_ID];
        [deviceID setEnabled:YES];
        [cell addSubview:deviceID];
    }

- (BOOL)textFieldShouldClear:(UITextField *)textField {

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:16:05.623

`cellForRowAtIndexPath`每当调用时，您都会将相同文本字段的多个实例添加到单元格中。在其中创建文本字段`viewDidLoad`并添加到此单元格。它应该工作。

另一种方法是继承你的子类`UITableViewCell`并将这个 textFiled 添加为它的`init`方法中的属性。然后您可以将值设置为`cell.textField.text = @"some value";`

如果在 中添加这一行`cellForRowAtIndexPath`，

```
deviceID = [[UITextField alloc] initWithFrame:CGRectMake(115, 11, 388, 22)]; 
```

每当重新加载表视图时都会调用它，并且您将丢失以前文本字段的引用。因此，您需要确保只创建一个文本字段并将其添加到 tableview 单元格。这也将确保您在单元格中只创建了一个文本字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:11:27.910

如果您尝试此委托方法会怎样：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField
{
   [textField setText:@""];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T06:18:01.910

我在另一篇文章中发现了以下内容（通常与视图有关）：

```
[self.view.subviews makeObjectsPerformSelector: @selector(removeFromSuperview)]; 
```

并转换为：

```
[cell.contentView.subviews makeObjectsPerformSelector: @selector(removeFromSuperview)]; 
```

完美地解决了这个线程中的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-17T19:56:23.820

你可以用这个

```
[deviceID removeFromSuperview];
devideID = nil;
deviceID = [[UITextField alloc] initWithFrame:CGRectMake(115, 11, 388, 22)];
... 
```

虽然接受的答案有效，但如果您不想将必须创建 UITextField 的责任委托给 ViewController，请使用此

# php - 在给定时期内可用的房间数量？

> ID：14175886
> 
> 赞同：0
> 
> 时间：2013-01-05T20:07:14.467
> 
> 标签：php, mysql, sql, database-design

我需要能够检查用户给出的日期范围是否可用。我的数据库中有一个名为的表`booked`，其中包含开始日期、结束日期以及在此期间已预订的房间数量。

假设我的`booked`表如下所示：

```
room_id | start      | end        | amount_of_rooms_booked
1       | 2012-12-12 | 2012-12-15 | 2
1       | 2012-12-13 | 2012-12-16 | 3
1       | 2012-12-18 | 2012-12-19 | 1 
```

如果 1 总共有 8 个房间，并且用户在和`room_id`之间要求这个房间，是否可以进行查询，检查每天预订的房间是否不超过 8 个。`2012-12-10``2012-12-20``SUM`

我可以这样做的另一种方法是单独存储每一天，并使用这样的`booked`表格：

```
room_id | start      | amount_of_rooms_booked
1       | 2012-12-12 | 2
1       | 2012-12-13 | 5
1       | 2012-12-14 | 5
1       | 2012-12-15 | 3
1       | 2012-12-18 | 1 
```

这种方式会在数据库中使用更多空间，但可能会更容易。我应该做什么？如果第一个想法我将如何进行查询？还有其他更好的方法来实现我想要做的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:15:02.770

要回答你原来的问题，你会这样做：

```
SELECT SUM(amount_of_rooms_booked) FROM booked
WHERE (start BETWEEN '2012-12-10' AND '2012-12-20' OR
       end BETWEEN '2012-12-10' AND '2012-12-20')
AND room_id = 1 
```

我认为您存储它的方式很好，尽管我可能会在每个房间预订中存储一行，而不是带有“amount_of_rooms_booked”列的行。那么上面的查询将是一个 COUNT 查询而不是一个 SUM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:08:59.593

对于您的第一个选项，您始终可以使用这样的[函数](https://stackoverflow.com/questions/1378593/get-a-list-of-dates-between-two-dates-using-a-function)。

然后你有一个这样的查询（我正在使用 SQL Server），它返回在给定日期预订少于 8 个的房间：

```
SELECT D.theDate, SUM(amount_of_rooms_booked) AS [amount_of_rooms_booked]
FROM
          booked
INNER JOIN
          dbo.ExplodeDates('20121210','20121220') D ON D.thedate BETWEEN booked.start AND booked.end
WHERE
          booked.room_id = @room
GROUP BY
          booked.room_id, D.thedate
HAVING
          SUM(amount_of_rooms_booked) < @bookingLimit 
```

但是，如果这种做法是最好的，我不知道。我宁愿使用您的第二个选项，因为解释起来不太复杂，而且我永远不知道我是否需要另一种查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:19:07.210

我建议在每个房间的每个预订日排一排。

使用这种结构，每个可能的计算都变得更容易。是的，您会遇到表中有更多数据的缺点，但它不会像您想象的那样影响您的数据库。我认为大多数查询会更快，因为您将避免使用日期进行复杂的计算。

所以这是我对第二种方法的优点：

*   它符合用户的思维模式（大部分）
*   SQL更简单！更快（大部分）
*   更容易维护
*   更容易保持数据清洁（可能）

# php - 我可以在一个 MySQL 查询中使用多个 WHERE 语句吗？

> ID：14175890
> 
> 赞同：0
> 
> 时间：2013-01-05T20:07:29.180
> 
> 标签：php, mysql, sql

免责声明：我知道可以将 AND 和 OR 运算符添加到单个 WHERE 语句中，这通常是正确的方法......

但是，我正在根据各种外部因素动态构建一个复杂的查询。出于可读性和可维护性的目的，如果我可以为始终需要满足的某些条件设置一个 WHERE 语句，然后再添加另一个（第二个）语句，这将根据情况而改变。

A. 这是有效的 MySQL 吗？B. 出于某种特殊原因，这是一个糟糕的想法吗？

这是一个简化的示例：

```
<?php 
$query = "
SELECT a,b,c
FROM table1
LEFT JOIN table2 on foo=bar
LEFT JOIN table3 on foo2=bar2
...
WHERE foobar = something_that_is_consistent 
AND boobar = something_else_consistent
...
";

if ( $something_special ) {
$query .= "WHERE ..."
}

if ( $something_else_special ) {
$query .= "WHERE ..."
} 
```

这是一个微不足道的例子，但希望它能说明我在想什么，以及我是如何尝试避免查询字符串中出现大块的嵌套条件的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:08:26.353

不可以。用于`AND`在一个中组合多个子句`WHERE`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:09:35.670

你不能。但是您可以轻松地调整您的代码，以便它记住您是否已经添加了一个`WHERE`子句并随后使用`AND`(or `OR`)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:12:55.447

你`WHERE`应该是一个然后使用`AND`

```
 <?php 
   $query = "
 SELECT a,b,c
 FROM table1
 LEFT JOIN table2 on foo=bar
 LEFT JOIN table3 on foo2=bar2
 ...
 WHERE foobar = something_that_is_consistent 
 AND boobar = something_else_consistent
 ...
 ";

if ( $something_special ) {
 $query .= "AND ..."
 }

 if ( $something_else_special ) {
 $query .= "AND ..."
 } 
```

# ios - 使用 XMPP 的 Facebook 聊天室

> ID：14175899
> 
> 赞同：2
> 
> 时间：2013-01-05T20:08:18.430
> 
> 标签：ios, facebook, xmpp, chat, xmppframework

我正在尝试创建基于移动的聊天应用程序。

基本上，我希望用户使用他们的 Facebook 帐户连接到 Facebook（使用[XMPPFramework](https://github.com/robbiehanson/XMPPFramework)）

我希望有用户可以加入的预先存在的房间。我注意到 XMPPFramework 确实支持[XEP-0045](https://github.com/robbiehanson/XMPPFramework/tree/master/Extensions/XEP-0045)扩展，但我不确定如何在 Facebook 聊天中创建房间（有可能吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T00:02:32.140

这是不可能的，因为 Facebook XMPP 服务器本身不支持 MUC，而且它们也不与 XMPP 网络联合。

# ruby-on-rails - Carrierwave S3 编辑时保留文件

> ID：14175903
> 
> 赞同：1
> 
> 时间：2013-01-05T20:08:47.187
> 
> 标签：ruby-on-rails, carrierwave

我让 Carrierwave 将图像上传到我的站点并将它们存储在 S3 上。

但是，每当用户编辑记录时，即使他们不需要更改图像，他们也必须再次上传图像。我想让现有图像继续使用，除非用户“选择”上传新图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:06:52.887

在[carrierwave wiki](https://github.com/jnicklas/carrierwave/wiki)中，您有一个部分[如何：保留上传的文件（针对特定的上传者）](https://github.com/jnicklas/carrierwave/wiki/How-to%3a-Keep-uploaded-files-%28for-a-specific-uploader%29)。我不知道这是否适用于 S3，但您可以尝试一下。

要保留所有上传的文件，请使用如下初始化程序：

```
CarrierWave.configure do |config|
  config.remove_previously_stored_files_after_update = false
end 
```

如果您想在每次上传的基础上进行配置：

```
class AvatarUploader < CarrierWave::Uploader::Base
  configure do |config|
    config.remove_previously_stored_files_after_update = false
  end

  ...
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T04:06:50.643

我不知道我做了什么，但这现在正在工作。虽然 UI 没有反映图像仍然存在，但用户不需要再次上传图片。

# python - 我应该如何存储来自 Pyramid 应用程序的登录信息？烧杯？

> ID：14175908
> 
> 赞同：2
> 
> 时间：2013-01-05T20:09:31.760
> 
> 标签：python, cookies, pyramid, beaker

我来自 PHP 世界，刚刚开始学习 Pyramid 框架。目前我正在尝试找出存储用户数据的最佳选择。

因此，在 PHP 中，我编写了一个模型，该模型利用 php 内置会话和 cookie 组合。只有当用户在登录时选择勾选“记住我”框时，才会使用 Cookie。因此，当用户登录时，会话包含可以使登录合法化的数据。当会话过期时，将对有效 cookie 进行检查，然后重新创建会话并延长 cookie 有效的日期。

所以在金字塔这里，我想做一些类似的事情，但可能更容易更好。我目前对金字塔烧杯感兴趣：http: [//beaker.readthedocs.org/en/latest/](http://beaker.readthedocs.org/en/latest/)

我的困境是，我应该使用哪种持久化方法？如果我只想将 Beaker 用于会话，那么我想我想使用 memcached 或仅内存配置。如果我想添加持久性，我肯定想通过 sqlalchemy 使用 mysql 数据库，因为我不想让服务器与会话文件混淆。或者我可以首先使用加密的 cookie，因此甚至可以消除大量工作，这些工作无论如何都必须使用 cookie 完成，因此也无需在服务器上存储会话。

你建议我和什么一起去？

由于这个网站不是主流的东西，而是高级客户的工具，我认为记住我的选项真的没有必要，我想我很想默认打开它，所以我应该去与基于烧杯饼干的会话？

在这种情况下，我的金字塔 development.ini 配置应该如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:26:02.937

如果您想在会话中使用带有 memcached 的烧杯，您的配置应该包括以下内容：

```
config.ini:

pyramid.includes =
    pyramid_tm
    pyramid_beaker

session.type = ext:memcached
session.url = url:11211
session.lock_dir = /tmp/memcached/lock 
```

如果需要，您可以改用 cookie。此外，您不需要使用 memcached 并且可以在服务器本地或内存中存储为文件。

# asp.net - 在 VS2012 上使用 MSBuild 从命令行部署到 FTP 不起作用，没有错误

> ID：14175910
> 
> 赞同：1
> 
> 时间：2013-01-05T20:09:35.760
> 
> 标签：asp.net, visual-studio, visual-studio-2012

我正在尝试从命令行执行发布配置文件。

1.  在 Visual Studio 中创建发布配置文件（右键单击项目 -> 发布）
2.  验证它有效。当我按下发布时，这些东西会去它应该去的地方（FTP 站点）

现在我想从 TFS 执行此操作，这意味着 MSBuild。

从命令行，我尝试了这个：

```
msbuild.exe WebApplication1.csproj /p:DeployOnBuild=true;PublishProfile="ftp";Password={INSERT-PASSWORD} 
```

我没有收到错误。并且文件未在 FTP 站点上发布。发布配置文件的名称是 ftp.pubxml。物理上在这里：

`WebApplication1\Properties\PublishProfiles\ftp.pubxml`

这就是 Visual Studio 2012 默认放置的地方。

我使用的是 FTP 部署，而不是 Web 部署。没有点击一次。网上很多东西都讲这两个。这是一个无聊的、旧的 FTP 部署。

[关于这里的相关问题](https://stackoverflow.com/questions/13250695/publishing-vs2012-solution-from-team-city)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T03:13:40.730

我刚刚在[http://sedodream.com/2013/01/06/CommandLineWebProjectPublishing.aspx](http://sedodream.com/2013/01/06/CommandLineWebProjectPublishing.aspx)上发布了一篇博客，希望能为您解决这个问题。

**命令行不支持 FTP 发布**。您会收到一条错误消息，让您知道这一点，但**您的命令行缺少一个非常重要的属性**

```
/p:VisualStudioVersion=11.0 
```

我在[http://sedodream.com/2012/08/19/VisualStudioProjectCompatabilityAndVisualStudioVersion.aspx](http://sedodream.com/2012/08/19/VisualStudioProjectCompatabilityAndVisualStudioVersion.aspx)上更详细地介绍了这个属性。总而言之，`VisualStudioVersion`引入了该属性以允许 VS 2010 和 VS 2012 共享项目文件和解决方案。如果您不指定此属性的值，它将默认为 10.0。

在您的情况下，由于您正在构建项目，因此您需要指定此属性。由于您没有指定该值，因此它默认为 10.0，并且使用的构建+发布过程是来自 VS 2010 的。显然，您的机器上同时安装了 VS2010 + VS2012。

如果您传入属性 /p:VisualStudioVersion=11.0，您将收到的错误应该让您知道命令行不支持 FTP 发布。

注意：如果您确实希望我们支持 FTP 的命令行发布，最好的办法是在[aspnet.uservoice.com](http://aspnet.uservoice.com)上提出建议。

# ruby-on-rails - 未定义的方法'email' for nil:NilClass in Exibe the mail of table Father

> ID：14175913
> 
> 赞同：2
> 
> 时间：2013-01-05T20:09:52.093
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我有一个问题，我把这个归因于我评论模型：

```
class Comment < ActiveRecord::Base
  attr_accessible :comment
  belongs_to :post
  belongs_to :user 
```

这在用户模型中

```
class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation
  has_many :posts
  has_many :comments 
```

但这不起作用：

```
 <% post.comments.each do |comment|   %>
    <div id="comments" >
      <%= comment.user.email %>
           <%= comment.comment %>
    </div>
   <%end%> 
```

出现错误：

```
undefined method `email' for nil:NilClass 
```

请问有什么问题，在创建评论时我做出了属性，请看：

```
 @comment = @post.comments.create(params[:comment],:user_id => current_user.id) 
```

我如何解决这个错误，请-

更新下一个响应，错误仍然存​​在：

我试试这个：

```
@comment = Comment.new(params[:comment])
@comment.user = current_user
@comment.post = @post
@comment.save 
```

这个

```
@comment = @post.comments.create(params[:comment].merge(:user_id => current_user.id)) 
```

和这个：

```
@comment = @post.comments.build(params[:comment])
@comment.user = current_user
@comment.save 
```

不工作

同样的错误：

```
undefined method `email' for nil:NilClass
Extracted source (around line #48):

45: 
46:       <% post.comments.each do |comment|   %>
47:         <div id="comments" >
48:           <%= comment.user.email %>
49:                <%= comment.comment %>
50:         </div>
51:        <%end%> 
```

我不知道我的模型评论有什么问题：user_id

```
 attr_accessible :comment,:user_id,:post_id 
```

我的表格是这样的

```
 <div id="comment_form_<%= post.id %>" style="display: none;" >

      <%= form_for [post,post.comments.build], :remote => true,:class=>"comment" do |com| %>
          <%= com.text_area :comment %>
          <%= com.submit "aaa" %>

      <%end %> 
```

请帮助我，我不知道错误在哪里，数据库已正确迁移

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:13:08.337

如果您查看日志，您可能会看到有关尝试分配 user_id 的警告。如果您要使用 attr_accessible 那么您需要添加您希望分配的所有属性。改变

```
 attr_accessible :comment 
```

至

```
 attr_accessible :comment,:user_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:12:05.170

```
# Model
class Comment < ActiveRecord::Base
  attr_accessible :comment, :user_id
end

#Controller
@comment = @post.comments.create(params[:comment].merge(:user_id => current_user.id)) 
```

但接下来会更好（：user_id 不可用于批量分配）：

```
@comment = @post.comments.build(params[:comment])
@comment.user = current_user
@comment.save 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:29:15.340

怎么样

```
@comment = Comment.new(params[:comment])
@comment.user = current_user
@comment.post = @post
@comment.save 
```

# c++ - C++ 向函数发送任何类型的参数

> ID：14175914
> 
> 赞同：9
> 
> 时间：2013-01-05T20:10:01.880
> 
> 标签：c++, function, types, arguments, void

就是这样：我想创建一个 void 函数，它将接收两个众所周知的值类型，另一个可以是任何值。代码将是这样的：

```
void change_settings(string element, short setting, ??? value) {
    switch (setting) {
        case ST_NAME:
            // Cast value to string or char* and change element.name
        break;
        case ST_AMOUNT:
            // Cast value to integer and change element.amount
        break;
        case ST_ENABLED:
            // Cast value to boolean and change element.enabled
        break;
    }
} 
```

我尝试创建值的类型`const void*`，但我得到一个错误（`cast from ‘const void*’ to ‘short int’ loses precision`），因为我只是这样做了：`short name = (short)value`，这一定是一些疯狂的绝望试验，希望能走运。现在，我不知道是否有这样做的方法，传递任何类型的变量的指针，然后将其转换为它是什么（我知道根据每种情况预期的变量类型。我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-05T20:12:15.587

你应该使用[模板](http://en.cppreference.com/w/cpp/language/function_template)

```
template <typename T>
void change_settings(string element, short setting, T value); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-05T20:11:20.313

由于您似乎事先知道 的所有潜在类型`value`，并且您希望根据类型有不同的行为，因此您可以编写一系列函数重载：

```
void change_settings(const std::string& element, short setting, const std::string& value);

void change_settings(const std::string& element, short setting, int value);

void change_settings(const std::string& element, short setting, bool value); 
```

这消除了对运行时切换的需要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-05T20:12:06.880

假设您正在谈论运行时切换（与编译时相反，在这种情况下模板可能是答案）：

您可以考虑一个变体类（例如`boost::variant`），或者可能使用多态性（即定义继承层次结构和实现特定行为的虚函数）。

# c# - 如何在 Windows Phone 中一遍又一遍地让故事板自动重播

> ID：14175915
> 
> 赞同：0
> 
> 时间：2013-01-05T20:10:16.827
> 
> 标签：c#, windows-phone-7, storyboard, expression-blend

我已经创建了混合故事板，当我进入某个页面时它会自动启动，但我想在它结束后自动重播它。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:34:45.110

这很简单..

只需连接您的故事板完成事件并在其完成事件中再次调用播放事件。

```
 // Like Here my storyboard is sbSquare
    private void sbSquare_Completed(object sender, EventArgs e)
    {
        this.sbSquare.Begin();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T06:56:05.860

@Arslan 建议的答案是 work around not actual solution 。您需要使用 Storyboard 的 RepeatedBehviour 属性。通过以下链接。

[重复动画](http://msdn.microsoft.com/en-us/library/ms753367.aspx)

# iphone - 在 iPhone 5 上运行时需要注意哪些会导致不稳定的情况？

> ID：14175916
> 
> 赞同：0
> 
> 时间：2013-01-05T20:10:35.243
> 
> 标签：iphone, ios, ios-simulator, iphone-5

我不确定这是否会成为一个有用的问题/线程，因为我没有任何具体的例子或片段可以提供。

我所知道的是，我一直在通过模拟器（Retina 4"）测试我的应用程序，没有任何问题。然后当我部署到设备（通过 ad-hoc）时，我看到稳定性问题，比如动画中的断断续续、普遍迟缓和由于各种原因偶尔会发生崩溃（主要是在视图之间导航的地方）。

在以前的 iPhone 设备版本上，事情似乎运行良好。

该应用程序有几个手动管理内存的文件。所有其他文件都受到自动内存清理的影响。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:03:05.810

如有疑问...使用仪器！让它帮助您找出慢速动画中的问题所在。请记住，因为 iPhone 5 上有更多的空间，所以它必须加载更多的资源，例如，在 TableView 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T03:15:10.343

动画慢？观看有关加速动画的 WWDC 2012 视频。基本上，当您从模拟器切换到设备时，您所经历的正是您所期望的。模拟器是您的计算机，它速度非常快并且具有大量内存。该设备不是，不是，也不是。这就是您在设备上进行测试的原因。电话没有任何“问题”。

# php - if 语句在 foreach 循环中只显示一次

> ID：14175918
> 
> 赞同：1
> 
> 时间：2013-01-05T20:10:54.463
> 
> 标签：php, loops, if-statement, foreach

我有一个关于 PHP 中的 foreach 循环的问题。出于某种原因，我似乎只能以这种方式回显最后一行，而我迷失了这个问题所在。每当我在 foreach 循环内部和 IF 语句外部的回显中检查 $onderdeeltje[1] 和 $selectedmodel 时，它都会完美地粘贴它们而没有任何问题。它还表明它们是相等且相同的，并且应该对 IF 语句做出反应。一旦我比较了 IF 语句中的两个，它只显示最后一个。每当我删除复选框 echo 并将其替换为 echo "test" 等任何内容时；它还显示我只测试一次。有人可以对此有所了解吗？我在同一页面中有多个（2 + 这个）这样的 foreach 循环，它们可以完美地工作，但只有这个似乎有问题。

```
echo "<form method='post' action='formpie.php'>";

$onderdelen = file("onderdelen.txt");

foreach ($onderdelen as $onderdeel) 
{
    $onderdeeltje = explode(",", $onderdeel);

    if ($onderdeeltje[1] == $selectedmodel)
    {
        echo "<input type='checkbox' name='check_list[]' value='$onderdeeltje[0]'>$onderdeeltje[0]<br>";
    }
}

echo "</form>"; 
```

$selectedmodel 将是：iPhone 3G，文本列表是这样的：

```
Reparatie touchscreen €41.50,iPhone 3G
Reparatie Wi-Fi-antenne €50.00,iPhone 3G
Reparatie trilmodule €40.00,iPhone 3G
Reparatie sim slot €70.50,iPhone 3G
Reparatie oorluidspreker €46.00,iPhone 3G 
```

它仅显示：Reparatie oorluidspreker €46.00 作为复选框。

请帮帮我！：） 提前致谢！

## -------------------------------------------------- ------------

**怎么解决：**

似乎输出中可能有隐藏的空格，如果这些空格是每行粘贴的，`<br>`或者在我的情况下是重复表单复选框值的列表，则这些空格是不可见的。

要解决此问题，您只需在 IF equal 语句之前或内部修剪值，如下所示：

```
foreach ($onderdelen as $onderdeel) 
{
    $onderdeeltje = explode(",", $onderdeel);

    if (trim($onderdeeltje[1]) == $selectedmodel)
    {
        echo "<input type='checkbox' name='check_list[]' value='$onderdeeltje[0]'>$onderdeeltje[0]<br>";
    }
} 
```

***感谢 ZombieSpy 的支持解决了。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:19:58.080

正如 Marc B 所说，你可能有换行符，所以使用**str_replace**

```
echo "<form method='post' action='formpie.php'>";

$onderdelen = file("onderdelen.txt");

foreach ($onderdelen as $onderdeel) 
{
    $onderdeeltje = explode(",", $onderdeel);

    if (str_replace ("\n", "", $onderdeeltje[1]) == $selectedmodel)
    {
        echo "<input type='checkbox' name='check_list[]' value='$onderdeeltje[0]'>$onderdeeltje[0]<br>";
    }
}

echo "</form>"; 
```

# html - CSS：如何将图像宽度设置为大于容器的宽度

> ID：14175919
> 
> 赞同：2
> 
> 时间：2013-01-05T20:10:57.863
> 
> 标签：html, css, image, resize, position

我的任务很简单，但我似乎无法完成它。

我有一个`div`大小为 100 像素 x 100 像素的容器。它的位置设置为`relative`，在里面我有一个位置设置为的图像`absolute 0 0`。我想使用 CSS 将图像的大小设置为 200 像素 x 200 像素。从 div 中切出的内容很容易通过设置隐藏`overflow: hidden`。

这里的问题是 Chrome 和 Mozilla 都不允许我设置大于容器大小的图像大小。

如果重要的话，容器就住在另一个容器里面`overflow: hidden`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:14:47.200

[对我来说很好（演示）](http://jsfiddle.net/zdDBC/1/)

```
#wrapper
{
  width:100px;
  height:100px;
  overflow:hidden;
}

img
{
  width:200px;
  height:200px;
} 
```

# objective-c - 在 SharePoint 2010 上对 GetList Web 服务的 Objective-C 调用不返回任何数据

> ID：14175926
> 
> 赞同：0
> 
> 时间：2013-01-05T20:11:51.090
> 
> 标签：objective-c, web-services, sharepoint, get

刚开始使用对 SharePoint(2010) 的 Web 服务调用并进行调用`GetWebCollection`，并且`GetListCollection`正常工作并返回预期的数据。运行`GetListCollection`按预期返回所有 SP 列表。

```
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/" />
</soap:Body>
</soap:Envelope> 
```

从返回的 SP 列表中，我提取日历列表的内部名称 {A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}

```
<_sList>
    <InternalName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</InternalName>
    <Title>Calendar</Title>
    ….. 
```

当我尝试`GetList`使用该 ID 值拨打电话时，我的问题出现了：

```
NSString *soapFormat = [NSString stringWithFormat:@"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"
                        "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n"
                        "<soap:Body>\n"
                        "<GetList xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\" />\n"
                        "<listName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</listName>\n"
                        "</GetList>\n"
                        "</soap:Body></soap:Envelope>\n"];

    NSLog(@"Request is : %@",soapFormat);

    NSURL *locationOfWebService = [NSURL URLWithString:@"http://192.168.0.114/_vti_bin/lists.asmx"];

    NSLog(@"Web url = %@",locationOfWebService);

    NSMutableURLRequest *theRequest = [[NSMutableURLRequest alloc]initWithURL:locationOfWebService];

    NSString *msgLength = [NSString stringWithFormat:@"%d",[soapFormat length]];

    [theRequest addValue:@"text/xml" forHTTPHeaderField:@"Content-Type"];
    [theRequest addValue:@"http://schemas.microsoft.com/sharepoint/soap/GetList"
                            forHTTPHeaderField:@"SOAPAction"];
    [theRequest addValue:msgLength forHTTPHeaderField:@"Content-Length"];
    [theRequest setHTTPMethod:@"POST"]; 
```

当我在 iPad 5.1 模拟器中运行它时，`GetList`调用会进行身份验证并连接，但会返回 0 个字节。

```
2013-01-05 13:31:56.053 SoapSharePoint[1936:c07] Request is : <?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/" />
<listName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</listName>
</GetList>
</soap:Body></soap:Envelope>
2013-01-05 13:31:56.055 SoapSharePoint[1936:c07] Web url = http://192.168.0.114/_vti_bin/lists.asmx
2013-01-05 13:31:56.059 SoapSharePoint[1936:c07] Connected...
2013-01-05 13:31:56.136 SoapSharePoint[1936:c07] Received Auth Req.
2013-01-05 13:31:56.147 SoapSharePoint[1936:c07] Received 0 Bytes!
2013-01-05 13:31:56.147 SoapSharePoint[1936:c07] 
```

在另一个工作站上使用 Fiddler 并使用 U2U CAML Query Builder 我可以看到 U2U 产品问题 a `GetListCollection`，`GetAllSubWebCollections`当它启动时（现在知道所有站点和列表），当我双击日历列表时，他们发送此`SOAP`请求：

```
POST http://g2010/_vti_bin/lists.asmx HTTP/1.1
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5466)
Content-Type: text/xml; charset=utf-8
SOAPAction: "http://schemas.microsoft.com/sharepoint/soap/GetList"
Host: g2010
Content-Length: 378
Expect: 100-continue
Connection: Keep-Alive

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/">
<listName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</listName>
</GetList>
</soap:Body>
</soap:Envelope> 
```

这将返回列表字段，并允许我构建一个`CAML`查询，然后返回日历列表中的 2 个项目。我不明白为什么我的电话`GetList`没有返回任何数据，并希望有人能发现我的明显错误:-)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T13:22:20.420

这种解释可能有点矫枉过正，但不是不清楚。您`GetList`的代码在代码块中过早结束。

```
<GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/" />
    <listName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</listName>
</GetList> 
```

第一个 GetList 标记上的最后一个 / 确保`GetList`立即关闭。写作`<GetList />`和写作一样`<GetList></GetList>`。所以你的代码块被视为：

```
<GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/" >
</GetList>
<listName>{A2CEBD3C-D07A-44A3-BE34-975AFE57F56C}</listName>
</GetList> 
```

其中前两行是`GetList`没有 listName 的行，第三行是 listName 但`GetList`周围不再有任何内容，第四行是“GetList 结束”标签，什么都不做。

删除第一个`GetList`标签中的最后一个/应该使一切正常:-)

# javascript - Chrome 打包应用程序中的 GUI

> ID：14175927
> 
> 赞同：1
> 
> 时间：2013-01-05T20:11:51.917
> 
> 标签：javascript, python, user-interface, google-chrome-extension, google-chrome-app

我是 Chrome 打包应用程序和 GUI 的新手。我可以在 Chrome 打包应用程序中使用哪种类型的 Gui？我可以在 Python 中使用 Tkinter 吗？还是我应该使用 Javascript GUI？如果是，那么您认为哪一个是最好的，因为我需要绘制画布并上传图像以改变亮度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:22:01.867

> 就像 Web 应用程序一样，打包的应用程序是用 HTML5、JavaScript 和 CSS 编写的。

[根据谷歌自己的主题页面，](http://developer.chrome.com/apps/about_apps.html)打包的应用程序只是向你开放了更多的 API。它们不允许您执行本机代码或其他脚本语言。您的 GUI 必须使用 HTML5 和 JavaScript 编写。[HTML5 Boilerplate](https://github.com/h5bp/html5-boilerplate)和/或[jQuery UI](http://jqueryui.com/)可能会有所帮助。

# php - 您是否将存储库注入到域对象中？

> ID：14175931
> 
> 赞同：3
> 
> 时间：2013-01-05T20:12:32.850
> 
> 标签：php, oop, repository, domain-driven-design

在每天学习 10 多个小时的领域驱动设计一周后，我开始觉得自己开始很好地理解它，直到今天读到这篇文章：

[http://blog.fedecarg.com/2009/03/15/domain-driven-design-the-repository/](http://blog.fedecarg.com/2009/03/15/domain-driven-design-the-repository/)

那篇文章的作者说您将存储库注入到域对象中，这对我来说没有任何意义。

我不是这个主题的专家，但我认为他是错的，但我想从这里的一些人那里得到一些关于将存储库注入域对象是对还是错的意见。

上周我每天都在阅读，因为我阅读了另一篇文章，另一篇文章对我来说听起来都一样（这是一件好事），直到我看到我在上面发布的文章，如果我的这张照片让我三思而后行模式不正确。

您是否应该注入存储库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T21:01:05.817

所示示例使用[Active Record 模式](http://en.wikipedia.org/wiki/Active_record_pattern)。在这种模式中，实体知道如何自救。这通常不被认为是良好[的关注点分离，](http://en.wikipedia.org/wiki/Separation_of_concerns)因为该类知道两件事：数据属性*和*如何保持自身。

将存储库注入 Active Record 对象比我见过的一些 Active Record 实现要好（因为您至少可以换出存储库实现），但在我看来（以及大多数 DDD 社区）依赖是向后的：

> 存储库应该依赖于它返回的对象，而不是相反。这样做的原因是您的“域对象”（稍后会详细介绍）可以存在（并且应该是可测试的）而无需加载或保存（即依赖于存储库）。

所以回答你的问题，不。您不应该将存储库注入域对象。

然而，值得注意的是，这并不是一个真正的领域对象，因为它没有行为——只是简单的 get/sets（访问器/突变器）。它只是一个[数据传输对象 (DTO)](http://en.wikipedia.org/wiki/Data_transfer_object)。如果真的没有行为，你就不需要领域模型——它只是简单的 CRUD。

# javascript - 播放器状态在 beatport 与 iframe 上实现了 javascript？声云支持？

> ID：14175936
> 
> 赞同：0
> 
> 时间：2013-01-05T20:12:45.360
> 
> 标签：javascript, html, audio, iframe, soundcloud

我使用 iframe 在我的许多网站上成功实施了静态播放器。到目前为止，这已经达到了我的目的，并且实现起来有点复杂。我经常需要通过 php 中的 GET 变量传递“框架”状态。我的一个客户一直有显示问题，很高兴看到网址出现在地址栏中，这让我重新思考我的方法。

在查看 Beatport 的 html5 播放器源时，似乎他们使用的是 javascript 实例化播放器，看起来非常剖析和精确。那么......他们是否在跟踪玩家状态并将这些变量从一个页面传递到另一个页面？他们的平台是什么？带ajax的php？节点.js？红宝石？这是异步 i/o 在工作吗？或者只是 html5 的音频对象提供的酷炫？这是我想了解的，因为我可能必须为未来的应用重新定位我的整个方法。

此外，soundcloud player api 会吐出进度位置吗？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:21:38.737

据我所知，Beatport 网站是完整的 ajax，没有实际的页面重新加载，当您单击链接时，主站点内容会动态重新加载。地址栏中的位置更改可以通过javascript完成（http://stackoverflow.com/questions/1457/modify-address-bar-url-in-ajax-app-to-match-current-state）

我建议为这种功能使用某种框架。我不熟悉 PHP 框架环境，但在 SO 上听说过[http://agiletoolkit.org/](http://agiletoolkit.org/)似乎提供了这种功能

Soundloud 播放器确实会“吐出”更新。它记录在他们的 API 中：

[http://developers.soundcloud.com/docs/custom-player#events](http://developers.soundcloud.com/docs/custom-player#events)

> **onMediaTimeUpdate.scPlayer**在播放器播放时不断触发，可用于在播放器节点之外显示轨道进度

```
$(document).bind('onMediaTimeUpdate.scPlayer', function(event){
console.log(event.target, 'the track is at ' + event.position + ' out of ' + event.duration    + ' which is ' + event.relative + ' of the total');
}); 
```

# php - 使用 Kohana ORM 匹配所有 WHERE IN 值

> ID：14175940
> 
> 赞同：0
> 
> 时间：2013-01-05T20:12:57.093
> 
> 标签：php, mysql, kohana, kohana-orm

我有以下基于标签获取产品的代码：

```
self::factory('user_product')
    ->join('items', 'INNER')->on('user_product.item_id', '=', 'items.id')
    ->join('user_tags', 'INNER')->on('items.id', '=', 'user_tags.item_id')
    ->join('tags', 'INNER')->on('user_tags.tag_id', '=', 'tags.id')
    ->where('tags.title', 'IN', $tags)
    ->order_by('items.created_at', 'DESC')->group_by('items.id')->find_all(); 
```

这会生成以下 SQL：

```
SELECT `user_product`.* FROM `user_products` AS `user_product`
INNER JOIN `items` ON (`user_product`.`item_id` = `items`.`id`) 
INNER JOIN `user_tags` ON (`items`.`id` = `user_tags`.`item_id`)
INNER JOIN `tags` ON (`user_tags`.`tag_id` = `tags`.`id`)
WHERE `tags`.`title` IN ('tag1', 'tag2')
GROUP BY `items`.`id`
ORDER BY `items`.`created_at` DESC 
```

我想修改我的查询，使其仅返回`user_products`同时具有`tag1`and的查询`tag2`（在 where in 语句中）。所以我想我需要在后面添加以下内容`WHERE`：

```
HAVING COUNT(DISTINCT `tags`.`title`) = 2 
```

我将如何使用 Kohana 的 ORM 来做到这一点，目前我有以下但无法解决如何集成 COUNT 和 DISTINCT 方法：

```
->having_open()->having('tags.title','=','2')->having_close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:19:44.547

使用以下方法使其工作：

`->having_open()->having(DB::expr('COUNT(DISTINCT`标签`.`标题`)'),'=',2)->having_close();`

# refresh - 在重定向之前对数据使用 Post/Redirect/Get... 元刷新？

> ID：14175944
> 
> 赞同：0
> 
> 时间：2013-01-05T20:13:10.400
> 
> 标签：refresh, post-redirect-get

我已经这样做了一段时间，但在涉及 PRG 时仍然感到困惑。我知道它是如何工作的，例如我会这样做：

```
if($_POST){
 header("Location: ".$_SERVER['REQUEST_URI']);
 exit(); 
```

}

因为它会停止用户刷新并再次将 POST 发送到服务器。但我不断收到“警告：无法修改标头信息 - 标头已发送”等等消息。我知道这是因为重定向需要在任何空格或回显或文本等之前进行......所以在标题上方将是理想的！

但是如果我的表单被发送到一个没有标题或任何东西的随机 .php 页面（我可以在其中处理数据和编辑数据库等），这对我来说更有意义 - 但这样我就不能包含任何 Wordpress 功能处理我的数据并做我需要做的事情。就像我会包含几行 Wordpress 以允许我访问这些功能，但是这样我就无法处理数据然后重定向用户。

目前为了解决这个问题，我正在处理数据并使用元刷新来重定向，我知道这很糟糕！

希望这是有道理的 :) 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:25:21.180

我不确定这样做的正确方法是什么

但通常我使用 js 重定向`echo '<script>window.location="somefile.php";</script>';` 来避免这个错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-22T15:07:09.613

我通常使用 location.replace(URL) 所以如果用户回击他们的浏览器，他们不会被困在重定向迷宫中：

```
window.location.replace(urlToRedirectTo); 
```

# multithreading - 在 scala 上制作线程局部对象

> ID：14175945
> 
> 赞同：12
> 
> 时间：2013-01-05T20:13:15.207
> 
> 标签：multithreading, scala, singleton

我正在用 scala 编写一个计算库。我将类似的功能分组到包含一堆过程和一些为 O(1) 时间数据静态分配的内存的原生 scala 单例对象中。

这种方法适合单线程使用。但是同时从不同的线程调用库函数可能会覆盖临时数据并给调用者错误的答案。

我可以通过在函数本地空间中移动所有静态分配的内存来复制这个库并编写线程安全版本。但我更喜欢通过定义线程局部变量来避免它。

在斯卡拉有可能吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-05T20:25:30.230

只需使用 Java 的`java.lang.ThreadLocal`类来存储变量。

```
val tl = new ThreadLocal[String]
tl.set("fish")
tl.get   // "fish" 
```

请注意，这样做会带来非零的性能损失（我记得大约 6 ns）。如果您正在做真正轻量级的事情（例如增加索引），您可能会注意到速度上的差异。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-03-27T09:22:00.370

自 Java 8 发布以来，有更多的声明方式来初始化`ThreadLocal`：

**斯卡拉：**

```
val local = ThreadLocal.withInitial[String](() => "init value"); 
```

**Java中的类比：**

```
ThreadLocal<String> local = ThreadLocal.withInitial(() -> "init value"); 
```

在 Java 8 发布之前，您必须执行以下操作：

**斯卡拉：**

```
val local = new ThreadLocal[String]{
  override def initialValue = "init value"
} 
```

**Java中的类比：**

```
ThreadLocal<String> local = new ThreadLocal<String>(){
    @Override
    protected String initialValue() {
        return "init value";
    }
}; 
```

**注意：** 评估是惰性的，因为您传递的`java.util.function.Supplier`lambda 在被调用时只评估一次，`ThreadLocal#get`但之前没有评估过值。

# android - Android Fragments 和 SlidingMenu

> ID：14175947
> 
> 赞同：1
> 
> 时间：2013-01-05T20:13:18.623
> 
> 标签：android, android-fragments, android-fragmentactivity

我正在构建一个使用来自以下位置的滑动菜单库的应用程序：

[https://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)

我有一个关于如何在此菜单模式中使用片段和活动的设计问题。

选项 1：当用户单击滑动菜单选项时，启动一个同样实现滑动菜单的新活动。

选项 2：当用户单击滑动菜单选项时，切换到主活动内的新片段。在这种情况下，我基本上会有一个活动来承载几个不同的片段，这些片段可以根据用户选择的菜单选项进行交换。

有没有人从上述两个选项中看到任何优点/缺点或有更好的选择？

谢谢，内森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:33:03.870

我相信这取决于，但乍一看，选项 2 似乎更合理。

首先是因为选项 1 更容易出现代码重复。让每个 Activity 实现滑动菜单，似乎是一个糟糕的设计。

其次，在配置更改（例如屏幕方向）时，Fragment 可以让您的生活变得更加轻松，因为如果在 Activity 中声明所有实例对象都会被销毁，并且您应该在使用 Fragments 时编写保存和恢复其状态的代码你不需要这样做。只需声明`setRetainInstance(true)`并保留在 Fragment 中声明的所有实例对象。

# android - 返回内容值

> ID：14175948
> 
> 赞同：0
> 
> 时间：2013-01-05T20:13:23.670
> 
> 标签：android, nullpointerexception

在我的应用程序的某个地方。我需要从方法返回 ContentValues。但似乎我做不到，或者在实现它时我错过了一些东西。当我想将此返回值传递给另一个类方法时，它会因为 nullPointerException 而崩溃。

这是我调用返回 ContentValues 方法并将其传递给其他方法的地方：

```
new Thread(new Runnable() {
            public void run() {
                try{
                    Thread.sleep(3000);
                    generateFeatures gen=new generateFeatures(getBaseContext());
                    ContentValues ourContentValues=gen.letsRollOut(); //calling the method that returns smth. type ContentValues 
                    makeDesicion md=new makeDesicion(ourContentValues,getBaseContext());
                    md.controlWithDB();
                    md.finalDesicion();
                    db.delete("Koordinatlar", null, null);
                    }
                    catch(InterruptedException ex){
                        ex.printStackTrace();
                    }

            }
          }).start(); 
```

返回 ContentValues 的方法：

```
public ContentValues letsRollOut(){
        boolean bitti=false;

        Cursor firstTimeHandler=db.rawQuery("SELECT MIN(zaman) FROM Koordinatlar", null);
        firstTimeHandler.moveToFirst();

        long firstTime= firstTimeHandler.getLong(0);
        long nextTime=firstTime+3000;

        Cursor lastTimeHandler=db.rawQuery("SELECT MAX(zaman) FROM Koordinatlar", null);
        lastTimeHandler.moveToFirst();

        long lastTime=lastTimeHandler.getLong(0);
        while(!bitti){

            myContentValues.clear();

            calculateAverage(firstTime,nextTime);
            calculateStandartDev(firstTime,nextTime);
            calculateAverageAbsoluteDifferance(firstTime,nextTime);
            calculateAverageResultant(firstTime,nextTime);
            calculateMax(firstTime,nextTime);
            calculateBinnedDist(firstTime,nextTime);

            firstTime=(long) (nextTime+0.00000001);
            nextTime=(nextTime+3000);

            if(nextTime>=lastTime){
                bitti=true;

            }

            myContentValues.put("ortX", averageX);
            myContentValues.put("ortY", averageY);
            myContentValues.put("ortZ", averageZ);
            myContentValues.put("stdX", stdX);
            myContentValues.put("stdY", stdY);
            myContentValues.put("stdZ", stdZ);
            myContentValues.put("aadX", aadX);
            myContentValues.put("aadY", aadY);
            myContentValues.put("aadZ", aadZ);
            myContentValues.put("maxX", maxX);
            myContentValues.put("maxY", maxY);
            myContentValues.put("maxZ", maxZ);
            myContentValues.put("averageResultantAcc", averageResultantAcc);

        }

        return myContentValues;

    } 
```

这是我得到错误的地方。

```
public makeDesicion(ContentValues ourContentValues,Context con){
        testContentValues.putAll(ourContentValues);  // get nullpointer error in this line.
        ourContext=con;
        veriTabani=new VeriTabani(this.ourContext);
        db=veriTabani.getWritableDatabase();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:20:06.753

看起来你忘了初始化`testContentValues`：

```
testContentValues = new ContentValues(); 
```

# java - 如何将图标添加到 JButton

> ID：14175951
> 
> 赞同：0
> 
> 时间：2013-01-05T20:13:30.340
> 
> 标签：java, swing, icons, png, jbutton

我正在看这个教程：[关于如何创建自定义 JButtons](http://www.youtube.com/watch?v=6iV-v_m0z0w&list=ECFE2CE09D83EE3E28)

我把我的文件放在 C < Users < MyUserName < workspace < ProjectName < src 中，就像教程说的那样，我得到了这个错误`Exception in thread "main" java.lang.NullPointerException at javax.swing.ImageIcon.<init>(Unknown Source) at Gui.<init>(Gui.java:20) at tuna.main(tuna.java:6)` 在下一个教程的评论中，它说把它放在 C < Users < MyUserName < workspace < ProjectName < bin 所以我试过了，我仍然得到同样的错误。我正在使用 eclipse，并且我的版本比教程中使用的版本更新。有什么帮助吗？

附加信息：文件为 .png

金枪鱼：

```
 Gui item = new Gui();
    item.setSize(300,300);
    item.setLocation(200,100);
    item.setVisible(true);
    item.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

编辑：它现在正在工作，我不知道为什么它之前出错了，我没有改变任何东西。无论如何感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:23:05.123

只要从放置图像的位置加载图像，放置图像的位置就无关紧要。如果您正在使用

```
Icon yourIconName = new ImageIcon(getClass().getResource("yourIconName.png")); 
```

那么它不仅需要在您的 src 文件夹中，而且还需要在与 tuna 相同的包中。

如果您使用的是绝对路径，`"C/Users/MyUserName/workspace/projectName/imageFile.png"`请确保您拥有要查找的图像的正确路径。

此外，您似乎正在使用 The New Boston 的教程，如果您发布您正在查看的教程可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:21:26.910

您可以使用以下内容查看您的根目录是什么。

```
 File f = new File("");
  System.out.println(f.getAbsolutePath()); 
```

很可能您的程序正在查找与您想象的不同的目录。

# delphi - 如何获取特定树节点的根索引？

> ID：14175953
> 
> 赞同：4
> 
> 时间：2013-01-05T20:13:43.907
> 
> 标签：delphi, treeview, delphi-xe2

我遇到了树视图中节点索引的差异。这棵树只有 2 个层次结构，许多根节点和每个根节点下的许多节点。当我阅读时`TTreeView.Selected.Index`，我只得到根节点的索引，但是当我阅读`TTreeView.Items[TTreeView.Selected.Index]`（循环迭代）时，我得到一个完全不同的树节点。

一个更具体的例子，假设我有这个数据：

*   根 1
    *   项目 1.1
    *   项目 1.2
    *   项目 1.3
*   根 2
    *   项目 2.1
    *   项目 2.2
    *   项目 2.3
*   根 3
    *   项目 3.1
    *   项目 3.2
    *   项目 3.3

现在假设我选择“Root 3”并阅读`TTreeView.Selected.Index`，它将返回`2`。但是，当我阅读`TTreeView.Items[2]`它时，它会返回“Item 1.2”，因为它实际上是列表中的第三项。我选择的“Root 3”实际上是索引号 8。

读取当前选择的根节点的索引的正确方法是什么，所以我得到`8`而不是`2`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T20:43:19.807

`TTreeNode.Index`是相对于`TTreeNode.Parent`。`TTreeView.Items[]`使用绝对索引，因此请`TTreeNode.AbsoluteIndex`改用。但是，`Items[Selected.AbsoluteIndex]`它是多余且低效的，因为它返回的返回值`TTreeNode`相同`Selected`。

# firefox-addon - 如何覆盖默认的下载/保存按钮处理程序？

> ID：14175956
> 
> 赞同：0
> 
> 时间：2013-01-05T20:14:02.173
> 
> 标签：firefox-addon

我正在尝试制作一个扩展程序，将下载管理器窗口作为侧边栏或其他方式打开，而不是新窗口。

*   为此，我必须首先停止“保存对话框”中的“保存”按钮，以将下载管理器作为新窗口打开。

*   然后，我必须将`oncommand`按钮的属性设置为我的自定义函数。

**我认为可以做到：（请参阅编辑，而不是这个）**

（如果我在“保存对话框”中有“保存”按钮的 ID，我可以 `removeAttribute("oncommand")`然后`setAttribute("oncommand", "some_other_function");`

不过，我非常不清楚更新的属性是否会持续。如果通过`openDialog`调用（内部）打开保存对话框，则每次都会出现一个新对话框。

*   这是正确的做法吗？那么，“保存”按钮的 ID 是什么？（另外，我怎么知道“保存对话框”何时打开？那是保存按钮有任何意义的时候。）
*   还能怎么办？）

**编辑 ：**

我认为可以通过 XPCOM 接口实现。**有什么办法可以**：

*   知道何时开始下载/保存？
*   可以访问在上述操作之后打开的“保存”对话框吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:07:41.443

**1 -**我可以使用[nsiDownloadService](https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIObserverService) XPCOM 接口判断何时开始下载。

```
var observerService = Components.classes["@mozilla.org/observer-service;1"]
                      .getService(Components.interfaces.nsIObserverService);
observerService.addObserver(this, "dl-start", false); 
```

`dl-start`是必需的主题 ID。（我找不到`dl-start`MDN 中记录的位置。有人可以指出吗？）

**2 -**我只需将首选项设置`browser.download.manager.showWhenStarting`为`false`阻止 Firefox 在新窗口中打开它自己的下载管理器。

# ruby - 有条件地在哈希中包含键值对

> ID：14175958
> 
> 赞同：12
> 
> 时间：2013-01-05T20:14:30.113
> 
> 标签：ruby, hashtable

有人可以帮我缩短以下方法吗？我从这个开始，我很喜欢：

```
def self.some_hash
  { "foo" => "bar" }
end 
```

现在我想添加一个可选键。我能想到的最简洁的语法是这样的：

```
def self.some_hash(some_key=nil)
  answer = { "foo" => "bar" }
  answer[some_key] = "yucky, long-winded syntax" if some_key
  answer
end 
```

修改后的方法有效，但我对虚拟墨水的浪费感到不满。有没有办法缩短它？我意识到可以在哈希文字上使用三元运算符，但这会强制（我认为）在`"foo" => "bar"`条件的每个分支上重复该对，这也略低于原始值。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-05T20:28:12.540

```
def self.some_hash(some_key = nil)
  {"foo" => "bar"}.merge(some_key ? {some_key => "yucky, long-winded syntax"} : {})
end 
```

或者，如果修改原始哈希，

```
def self.some_hash(some_key = nil)
  {"foo" => "bar"}
  .tap{|h| h.merge!(some_key => "yucky, long-winded syntax") if some_key}
end 
```

或者，也许你可以用接近你原来的方式来做到这一点：

```
def self.some_hash(some_key = nil)
  {"foo" => "bar"}
  .tap{|h| h[some_key] = "yucky, long-winded syntax" if some_key}
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:21:22.720

我不太喜欢它，但这很简洁（而且令人困惑）

```
def self.some_hash(some_key=nil)
  Hash[[["foo", "bar"], [some_key, "some value"]].select(&:first)]
end 
```

这可能会好*一些*。

```
def self.some_hash(some_key=nil)
  {"foo" => "bar", some_key => "some_value"}.keep_if{ |k, _| k }
end 
```

[哈希#keep_if](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-keep_if)

# iphone - 是否可以在 Interface Builder 中选择性地覆盖布局约束？

> ID：14175960
> 
> 赞同：5
> 
> 时间：2013-01-05T20:14:42.087
> 
> 标签：iphone, objective-c, ios

我正在尝试根据设备是 iPhone 5（高屏幕）还是早期 iPhone 版本（短屏幕）来调整 UIImageView 的大小。下面是我的代码。但是，当我运行该应用程序时，这些说明将被忽略。我怀疑问题是由自动布局约束引起的。如果我关闭这些约束，图像会调整大小，但这会扰乱我的其余布局。无论如何有选择地覆盖自动布局而不是关闭它？

```
CGRect screenBounds = [[UIScreen mainScreen] bounds];
if (screenBounds.size.height == 568) {

    // code for 4-inch screen
    avatarImage.frame = CGRectMake(43, 372, 75, 75);

} else {

    // code for 3.5-inch screen
    avatarImage.frame = CGRectMake(43, 372, 50, 50);

} 
```

编辑

下面是我要解决的问题的图像。我希望头像图像按比例调整大小，直到它适合较小的视图。我想以编程方式将文本字段向上移动到标签的右侧。

![在此处输入图像描述](../Images/072723a2152359d07b240eba7bb93165.png)

![在此处输入图像描述](../Images/64ecb0a7873d520cd2e1720117e053cf.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-05T21:05:45.257

做到这一点的一种方法是以编程方式更改您的约束。您可以通过以下方式做到这一点：

1.  通过选择图像视图，然后在 Xcode 5 中单击![米](../Images/70d5aefa0624d528d444594012adcd7d.png)按钮，为您的图像视图创建高度和宽度约束：

    ![在此处输入图像描述](../Images/5691d84106c963caa17d0fc37bc68fe4.png)

    或者，在 Xcode 的早期版本中，通过单击![中央](../Images/41e12597eed49ce47930e759ab60ff47.png)按钮：

    ![创建约束](../Images/1cb1b613d844ffc6abdc4121fe7b952f.png)

2.  确保更改其他次要约束工作以允许调整图像视图的大小。例如，如果您在此缩略图图像的右侧有一个标签，您需要确保它已设置为标签的宽度将随着图像大小的变化而调整。最重要的是，您要确保在应用程序运行时没有约束冲突，因为如果确实有一些冲突，您可能会收到一条调试消息，提示您必须打破约束才能使应用程序工作，或者更糟的是，约束是不可满足的。

3.  `IBOutlet`为新的高度和宽度约束创建参考。最简单的方法是显示助手编辑器（因此在您操作情节提要时显示关联的 .h 文件），然后`control`从约束 - 拖动到 .h 文件：

    ![创建 IBOutlets](../Images/e8852e44933377e04787ff2356dd755a.png)

4.  然后在您的代码中，您可以更改约束：

    ```
    CGRect screenBounds = [[UIScreen mainScreen] bounds];

    if (screenBounds.size.height >= 568) {
        self.widthConstraint.constant = 75;
        self.heightConstraint.constant = 75;
    } else {
        self.widthConstraint.constant = 50;
        self.heightConstraint.constant = 50;
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T21:11:01.870

在这种情况下，我想说的是，您可能希望将顶部空间限制为超级视图，将底部空间限制为超级视图，而不是指定高度。当superview的高度发生变化时，subview的高度也会随之增长。

将 textView 向上和向右移动而不是向下移动将更具挑战性。您*可能*能够通过不同的约束优先级来实现这种效果，但您最终可能会被激怒。这听起来像是一个不平凡的情况，您最好在运行时以编程方式更新约束。

@Rob 提供了一个不错的观点，即您可以将约束插入 IBOutlets 并稍后以编程方式修改或删除它们。也许这种方法在这种情况下也会结出硕果。

# ruby-on-rails - devise_invitable：只允许管理员邀请用户

> ID：14175961
> 
> 赞同：4
> 
> 时间：2013-01-05T20:14:43.553
> 
> 标签：ruby-on-rails, devise, routes, devise-invitable

我正在使用[`devise_invitable`](https://github.com/scambra/devise_invitable)gem 在我的应用程序中启用邀请以及为 rails 3 应用程序设计。我有一个`User`&`Profile`模型。在`User`中，有一`role`列给出了用户的类型。

现在，我想将创建新邀请的功能限制*在*管理员范围内，方法是将这个范围界定路线限定到`devise/invitations#new`where`user.role=='admin'`并向所有人开放其余路线。像这样的东西

```
MyApp::Application.routes.draw do

devise_for :users, skip: [:registrations, :invitations]

as :user do
 get 'users/edit' => 'devise/registrations#edit', as: 'edit_user_registration'
  put 'users' => 'devise/registrations#update', as: 'user_registration'

# manually define alll devise_invitable routes, except devise/invitations#new

# accept_user_invitation GET /users/invitation/accept(.:format) devise/invitations#edit

# user_invitation POST /users/invitation(.:format) devise/invitations#create

# also the #accept route goes here

end

resource :profile, except: :destroy

authenticated :user, lambda {|u| u.role == "admin"} do

resources :user, controller: "user"

#only allow admin to invite other users

# new_user_invitation GET /users/invitation/new(.:format) devise/invitations#new

end

root to: 'profiles#show'

end 
```

可能的？另外，做同样事情的更好方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T19:05:48.237

一种简单的方法就是覆盖**authenticate_inviter！****ApplicationController**中的方法如下：

```
class ApplicationController < ActionController::Base
  ...
  private
  def authenticate_inviter!
    unless user.role=='admin'
      redirect_to root_url, :alert => "Access Denied"
    end
    super
  end
  ...
end 
```

并将 DeviseInvitable::Inviter 模块包含到您的用户模型中：

```
class User < ActiveRecord::Base
  ...
  include DeviseInvitable::Inviter
  ...
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-06T10:46:18.010

不理会标准路由并在 Invitations 控制器中使用**before_filter**仅检查新操作和创建操作的管理员状态怎么样？

```
class Devise::InvitationsController < DeviseController
    ...
    before_filter :is_admin?, :only => [:new, :create]
    ...
end 
```

看起来 devise_invitable gem 实际上也在内部使用了这个方法：

```
class Devise::InvitationsController < DeviseController
    before_filter :authenticate_inviter!, :only => [:new, :create]
    before_filter :has_invitations_left?, :only => [:create]
    before_filter :require_no_authentication, :only => [:edit, :update]
    ...
end 
```

根据他们的[自述文件](https://github.com/scambra/devise_invitable#configuring-controllers)：

> 要更改控制器的行为，请**创建一个继承自 Devise::InvitationsController 的控制器**。可用的方法有：新建、创建、编辑和更新。在编辑任何这些操作之前，您应该阅读[原始控制器源代码。](https://raw.github.com/scambra/devise_invitable/master/app/controllers/devise/invitations_controller.rb)

我只是复制他们的默认控制器并尝试添加我自己的自定义 is_admin？before_filter 用于新建和创建操作。当然，您还必须定义 is_admin? 过滤器之前调用的方法。

# c# - 为什么“a=a++”操作不增加“a”的值

> ID：14175964
> 
> 赞同：-1
> 
> 时间：2013-01-05T20:15:06.903
> 
> 标签：c#

> **可能重复：**
> [如果 i == 0，为什么 (i += i++) == 0 在 C# 中？](https://stackoverflow.com/questions/13516689/if-i-0-why-is-i-i-0-in-c)

我知道这不是一个逻辑实现，我知道我应该使用前缀 ++，但我对这段代码很好奇：

```
int a = 1;
a = a++;
Console.Write(a); 
```

我希望结果是 2，但事实并非如此。为什么结果是 1？`a`均衡到后`a`，值`a`增加。但似乎 ++ 操作在另一个维度执行:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-05T20:17:02.843

放在`++` *后面*`a`告诉它返回旧*值*，*然后*递增。同时，递增发生*在*赋值之前，因此您丢失了旧值。这是等效的代码：

```
int a = 1;
int temp_old_a = a; //temp_old_a is 1
a = temp_old_a + 1; //increments a to 2, this assignment is from the ++
a = temp_old_a; //assigns the old 1 value thus overwriting, this is from your line's assignment `a =` operator
Console.Write(a); //1 
```

所以你可以看到它最终是如何丢弃增加的值的。另一方面，如果你把`++` *之前*`a`：

```
int a = 1;
a = ++a;
Console.Write(a); //2 
```

它的作用类似于：

```
int a = 1;
int temp_old_a = a;
temp_old_a = temp_old_a + 1;
a = temp_old_a; //assigns the incremented value from the ++
a = temp_old_a; //assigns again as per your original line's assignment operator `a =`
Console.Write(a); //2 
```

在这种情况下，当变量作为表达式的一部分递增时，重新分配变量通常没有意义。你几乎总是只是简单地增加它会更好：

```
int a = 1;
a++; //or ++a, but I find a++ is more typical
Console.Write(a); //2 
```

看到这样的代码通常更标准，而且更容易混淆（正如您所发现的那样）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T20:17:35.357

`a++`是一个*post-increment*，这就是它的工作方式。它的行为*就像在返回变量值**后*递增变量一样。实际上它增加了它的值，然后返回之前的值。

`++a`另一方面是*pre-increment*，它将按照您的意愿行事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T20:17:27.180

因为`a++`是后增量 - 首先返回值然后增加它。在这种情况下，您应该只使用

```
int a=1;
a++;
Console.Write(a); 
```

或者

```
int a = 1;
a = ++a;
Console.Write(a); 
```

`++a`是预增量 - 首先增加值，然后返回增加的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T20:27:53.753

因为用作后缀的 ++ 操作数仅在使用其值后才递增变量。如果使用 ++ 操作数作为前缀，则变量会在使用其值之前递增。

例如：

> ## 案例一：后缀使用
> 
> `int a = 1;`
> 
> `int b;`
> 
> `b = a++;`
> 
> ## 案例2：前缀使用
> 
> `int a = 1;`
> 
> `int b;`
> 
> `b = ++a;`

在“case 1”中，b 变量将被赋值为 1，而在“case 2”中，b 变量将被赋值为 2。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T20:21:39.887

注意：某些语言接受以下语法：

```
a = ++a 
```

这将按照您的建议工作，首先增加一个，然后返回它:)

# python - sentence.split 获取网站页面

> ID：14175970
> 
> 赞同：1
> 
> 时间：2013-01-05T20:16:03.470
> 
> 标签：python, html

我正在尝试创建一个从 tv catchup 网站获取 html 的程序，然后使用 split 函数将所有 html 数据拆分为频道名称和当前在表中的程序，例如：BBC 1 - '程序名称'。如果有人能提供帮助，我只需要关于我在第一次拆分功能后所做的事情的帮助，我将不胜感激。

更新 - 因为这是一个学校项目，我需要使用 sentence.split 函数，如果有人能指出我需要的网站下一阶段的正确方向，我对从这一点开始接下来我会做什么感到困惑分裂等？

```
import urllib2
import string

proxy = urllib2.ProxyHandler({"http" : "http://c99.cache.e2bn.org:8084"})

opener = urllib2.build_opener(proxy)

urllib2.install_opener(opener)

tvCatchup = urllib2.urlopen('http://www.TVcatchup.com')

html = tvCatchup.read()

firstSplit = html.split('<a class="enabled" href="/watch.html?c=')[1:]
for i in firstSplit:
    print i

secondSplit = html.split ('1" title="BBC One"></a></li><li class="v-type" style="color:#6d6d6d;">')[1:]

for i in secondSplit:
    print i 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:13:36.400

您通常会使用[html 解析器](http://docs.python.org/2/library/htmlparser.html)（请参阅[Python HTMLParser](https://stackoverflow.com/questions/7204056/python-htmlparser)以获取示例）来执行此操作。（人们也经常使用[`regex`](http://docs.python.org/2/library/re.html)）。可以使用`split`但有点hacky......我还是这样做了。最初将页面拆分为大段后的下一步是循环遍历它们并将它们拆分为较小的段，以获取所需的信息。

```
big_parts = html.split('href="/watch.html?c=')[1:]
for n, part in enumerate(big_parts):
    small_part = part.split('</a>')[0]
    if n % 2:       # odd numbered segments
        programme = small_part.split('"> ')[1]
        print programme
    else:           # even numbered segments
        smaller_parts = small_part.split('"')
        number = smaller_parts[0]
        channel = smaller_parts[2]
        print number, channel, ':', 
```

它之所以有效，是因为找到介于两者之间的文本，`href="/watch.html?c=`并且`</a>`恰好识别出同时包含频道名称和节目名称的所有片段。`">`然后，您可以使用标识字符序列 (和)分解这些段，`"`以获得所需的确切信息。如果网站完全改变了它的 HTML 样式，这可能会停止工作。

# mysql - 主键是否在 UPDATE 上物理重新排序？

> ID：14175977
> 
> 赞同：1
> 
> 时间：2013-01-05T20:17:00.710
> 
> 标签：mysql, sql-update, primary-key

约翰[向](https://stackoverflow.com/a/14175726/1382306)我展示了主键将根据索引进行物理排序，但它会*重新排序*吗？

如果我`UPDATE`的 PK 在列中取一个值并在以前小于另一个值时使它现在更大，那么 MySQL 会在物理上重新排序这些行吗？原始值会比其他值在物理上“更高”吗？

我知道`UPDATE`ing PK的陷阱，但是如果其他人知道任何限制或限制，请随时添加+1s

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:26:27.200

当您使用 InnoDB 时，引擎在您定义主键时使用聚集索引。然后`clustered index`是指按索引顺序存储的数据，因为索引的叶级是数据本身。当您`UPDATE`PK 时，您会更改数据的物理位置。

# sublimetext2 - Sublime Text 2 控制台输出到文件？

> ID：14175981
> 
> 赞同：0
> 
> 时间：2013-01-05T20:17:20.207
> 
> 标签：sublimetext2

如何让 Sublime Text 2 将控制台的输出写入当前文件？

这对于循环列表以生成重复输出之类的东西可能很有用。这是一个人为的例子：

```
# Console:
>>> pets = ['dog', 'cat', 'bird', 'fish']
>>> print '<ul>\n<li>%s</li>\n</ul>' % '</li>\n</li>'.join(pets) 
```

是否有命令将该输出发送到我正在处理的文件的插入点？

请注意，我不是要在控制台窗口中运行当前文件，而是要从控制台运行一个片段以在当前文件中生成代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:47:12.617

您可以使用`insert`命令：

```
>>> pets = ['dog', 'cat', 'bird', 'fish']
>>> output = '<ul>\n<li>%s</li>\n</ul>' % '</li>\n</li>'.join(pets)
>>> view.run_command("insert", {"characters": output}) 
```

# c# - 类似游戏的黑白棋对角线检测颜色

> ID：14175988
> 
> 赞同：-1
> 
> 时间：2013-01-05T20:18:31.420
> 
> 标签：c#, for-loop, multidimensional-array

我正在重新创建经典的黑白棋游戏，但在尝试正确更改对角线颜色时遇到了麻烦。我有两个 for 循环，但它们无法正常工作，任何人都可以看看我的代码并告诉我我做错了什么。

（请看我的 for 循环）

这张图片说明了我的问题是：

![在此处输入图像描述](../Images/d249cf433dd9af139d58af0e7da4dcc8.png)

这是我的代码：

```
 private void ClickedButton(object sender, EventArgs e)
        {
            Button s = (Button)sender;
            int x = int.Parse(s.Name.Split()[0]);
            int y = int.Parse(s.Name.Split()[1]);

            if (cnt == 0)
            {
                cnt = 1;
                s.BackColor = Color.Black;

                for (int i = 3; i > x; --i)
                {
                    for (int j = 0; j < y; ++j)
                    {
                        if (b[i, j].BackColor == Color.Black)
                        {
                            b[i - 1, j + 1].BackColor = Color.Black;

                        }
                    }
                }
            }
            else
            {
                cnt = 0;
                s.BackColor = Color.Red;
            }

           // MessageBox.Show("you have clicked button: " + x +" "+ y);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:40:43.393

```
 private void ClickedButton(object sender, EventArgs e)
    {
        Button s = (Button)sender;
        int x = int.Parse(s.Name.Split()[0]);
        int y = int.Parse(s.Name.Split()[1]);

        if (b[x, y].BackColor == Color.Red || b[x, y].BackColor == Color.Black)
          return;

        var color = cnt == 1 ? Color.Red : Color.Black;
        cnt = 1 - cnt;
        b[x, y].BackColor = color;

          int len = 4;

          var directions = new[]
          {
            new {x =  0, y =  1}, 
            new {x =  0, y = -1}, 
            new {x =  1, y =  0},
            new {x = -1, y =  0}, 
            new {x = -1, y = -1},
            new {x =  1, y = -1},
            new {x = -1, y =  1},
            new {x =  1, y =  1}
          };
          b[x, y].BackColor = color;

          foreach (var dir in directions)
          {
            for (var i = 1; i < len; ++i)
            {
              var xi = x + i * dir.x;
              var yi = y + i * dir.y;
              if (xi < 0 || xi >= len || yi < 0 || yi >= len)
                break;
              if (b[xi, yi].BackColor != Color.Black && b[xi, yi].BackColor != Color.Red)
                break;
              if (b[xi, yi].BackColor == color)
              {
                for (var j = 1; j < i; ++j)
                  b[x + j * dir.x, y + j * dir.y].BackColor = color;
                break;
              }
            }
          }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:34:19.030

回答

```
private void ClickedButton(object sender, EventArgs e)
        {
            Button s = (Button)sender;
            int x = int.Parse(s.Name.Split()[0]);
            int y = int.Parse(s.Name.Split()[1]);

           // if (b[x, y].BackColor != Color.Red && b[x, y].BackColor != Color.Black)
            //    return;

            var color = cnt == 1 ? Color.Red : Color.Black;
            cnt = 1 - cnt;
            b[x, y].BackColor = color;

            int len = 4;

            var directions = new[]
          {
            new {x =  0, y =  1}, 
            new {x =  0, y = -1}, 
            new {x =  1, y =  0},
            new {x = -1, y =  0}, 
            new {x = -1, y = -1},
            new {x =  1, y = -1},
            new {x = -1, y =  1},
            new {x =  1, y =  1}
          };
            b[x, y].BackColor = color;

            foreach (var dir in directions)
            {
                for (var i = 1; i < len; ++i)
                {
                    var xi = x + i * dir.x;
                    var yi = y + i * dir.y;
                    if (xi < 0 || xi >= len || yi < 0 || yi >= len)
                        break;
                    if (b[xi, yi].BackColor != Color.Black && b[xi, yi].BackColor != Color.Red)
                        break;
                    if (b[xi, yi].BackColor == color)
                    {
                        for (var j = 1; j < i; ++j)
                            b[x + j * dir.x, y + j * dir.y].BackColor = color;
                        break;
                    }
                }
            }
        } 
```

# android - 在android中调用bpel进程

> ID：14175989
> 
> 赞同：3
> 
> 时间：2013-01-05T20:18:42.823
> 
> 标签：android, wsdl, bpel

我有一个 BPEL 流程。我想在android中调用它。但我无法理解 wsdl url、命名空间和方法名称。因为我知道错误是因为这个。我正在发送 wsdl 文件和 xsd 文件。

我的 BPEL 流程 wsdl 文件是：

```
 <definitions name="HelloWorld" targetNamespace="http://xmlns.oracle.com/HelloWorld" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://xmlns.oracle.com/HelloWorld" xmlns:plnk="http://schemas.xmlsoap.org/ws/2003/05/partner-link/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:client="http://xmlns.oracle.com/HelloWorld">
    <types>
        <schema xmlns="http://www.w3.org/2001/XMLSchema">
            <import namespace="http://xmlns.oracle.com/HelloWorld" schemaLocation="HelloWorld.xsd"/>
        </schema>
    </types>
    <message name="HelloWorldRequestMessage">
        <part name="payload" element="tns:HelloWorldProcessRequest"/>
    </message>
    <message name="HelloWorldResponseMessage">
        <part name="payload" element="tns:HelloWorldProcessResponse"/>
    </message>
    <portType name="HelloWorld">
        <operation name="process">
            <input message="tns:HelloWorldRequestMessage"/>
            <output message="tns:HelloWorldResponseMessage"/>
        </operation>
    </portType>
    <binding name="HelloWorldBinding" type="tns:HelloWorld">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="process">
            <soap:operation style="document" soapAction="process"/>
            <input>
                <soap:body use="literal"/>
            </input>
            <output>
                <soap:body use="literal"/>
            </output>
        </operation>
    </binding>
    <service name="HelloWorld">
        <port name="HelloWorldPort" binding="tns:HelloWorldBinding">
            <soap:address location="http://www.sample.com/orabpel/default/HelloWorld/1.0"/>
        </port>
    </service>
  <plnk:partnerLinkType name="HelloWorld">
    <plnk:role name="HelloWorldProvider">
      <plnk:portType name="tns:HelloWorld"/>
    </plnk:role>
  </plnk:partnerLinkType>
</definitions> 
```

我的 xsd 文件是：

```
 <schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://xmlns.oracle.com/HelloWorld" xmlns="http://www.w3.org/2001/XMLSchema">
    <element name="HelloWorldProcessRequest">
        <complexType>
            <sequence>
                <element name="input" type="string"/>
            </sequence>
        </complexType>
    </element>
    <element name="HelloWorldProcessResponse">
        <complexType>
            <sequence>
                <element name="result" type="string"/>
            </sequence>
        </complexType>
    </element>
</schema> 
```

我的安卓代码是：

```
 import org.ksoap2.SoapEnvelope;
    import org.ksoap2.serialization.PropertyInfo;
    import org.ksoap2.serialization.SoapObject;
    import org.ksoap2.serialization.SoapPrimitive;
    import org.ksoap2.serialization.SoapSerializationEnvelope;
    import org.ksoap2.transport.HttpTransportSE;

    import android.R.string;
    import android.app.Activity;
    import android.os.Bundle;
    import android.util.Log;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    public class SOAP_WebService extends Activity
    {
         private final String NAMESPACE = "http://xmlns.oracle.com/HelloWorld";
         private final String URL = "http://http://www.sample.com/orabpel/default/HelloWorld/1.0";
         private final String SOAP_ACTION = "http://xmlns.oracle.com/HelloWorld/process";
         private final String METHOD_NAME = "process";

    public void onCreate(Bundle savedInstanceState) 
    {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.soap_webservice);

         Button btnClick = (Button) findViewById(R.id.btnClick);
         btnClick.setOnClickListener(new OnClickListener()
         {
            @Override
            public void onClick(View v) 
            {
                callWebservice();
            }
        });
    }
    public void callWebservice()
    {
        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
        PropertyInfo weightProp =new PropertyInfo();
        weightProp.setName("input");
        weightProp.setValue("sample");
        weightProp.setType(string.class);
        request.addProperty(weightProp);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

        envelope.dotNet = false;
        envelope.bodyOut = request;
        envelope.setOutputSoapObject(request);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
        try 
        {
            androidHttpTransport.call(SOAP_ACTION, envelope);
            SoapPrimitive response = (SoapPrimitive)envelope.getResponse();
            SoapObject obj1 = (SoapObject)envelope.bodyIn;
            Log.i("myApp", response.toString());

        } 
        catch (Exception e) 
        {
            e.printStackTrace();
            Log.d("Exception Generated", ""+e.getMessage());
        }

    }

} 
```

我收到以下错误：

```
 01-06 00:32:39.572: W/System.err(317): SoapFault - faultcode: 'null:HelloWorld' faultstring: 'Cannot figure out operation name. Bad SOAPAction or wsa:Action.' faultactor: 'http://xmlns.oracle.com/HelloWorld/process' detail: null 01-06
 00:32:39.572: W/System.err(317): at    org.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:141)
 01-06 00:32:39.572: W/System.err(317): at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:140) 01-06
 00:32:39.582: W/System.err(317): at org.ksoap2.transport.Transport.parseResponse(Transport.java:100) 01-06
 00:32:39.582: W/System.err(317): at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:197)
 01-06 00:32:39.582: W/System.err(317): at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:95)
 01-06 00:32:39.582: W/System.err(317): at com.mehul.Web_Service.SOAP_WebService.callWebservice(SOAP_WebService.java:69)
 01-06 00:32:39.582: W/System.err(317): at com.mehul.Web_Service.SOAP_WebService$1.onClick(SOAP_WebService.java:40)
 01-06 00:32:39.582: W/System.err(317): at android.view.View.performClick(View.java:2408) 01-06 00:32:39.582:
 W/System.err(317): at android.view.View$PerformClick.run(View.java:8816) 01-06 00:32:39.582:
 W/System.err(317): at android.os.Handler.handleCallback(Handler.java:587) 01-06
 00:32:39.582: W/System.err(317): at android.os.Handler.dispatchMessage(Handler.java:92) 01-06
 00:32:39.592: W/System.err(317): at android.os.Looper.loop(Looper.java:123) 01-06 00:32:39.592:
 W/System.err(317): at android.app.ActivityThread.main(ActivityThread.java:4627) 01-06
 00:32:39.592: W/System.err(317): at java.lang.reflect.Method.invokeNative(Native Method) 01-06
 00:32:39.592: W/System.err(317): at java.lang.reflect.Method.invoke(Method.java:521) 01-06 00:32:39.592:
 W/System.err(317): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
 01-06 00:32:39.592: W/System.err(317): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 01-06
 00:32:39.592: W/System.err(317): at dalvik.system.NativeStart.main(Native Method) 01-06 00:32:39.592: D/Exception Generated(317): Cannot figure out operation name. Bad
 SOAPAction or wsa:Action. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T11:35:56.227

上面 java 代码中给 soapAction 的值是不正确的。它应该是 private final String SOAP_ACTION = "process";

请检查wsdl中的soapAction。

# postgresql - 更改 PostgreSQL 中表行的顺序

> ID：14175992
> 
> 赞同：16
> 
> 时间：2013-01-05T20:19:04.857
> 
> 标签：postgresql, performance

我在 PostgreSQL 中有一张表。我想根据特定列（不是主键）对行数据进行物理重新排序。在我的情况下，此列类型是`date`. 我该怎么做？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2016-01-10T19:07:48.233

如果您在该列上有索引，则该`CLUSTER`命令将根据该索引对行进行物理“排序”

```
CLUSTER [VERBOSE] table_name [ USING index_name ] 
```

[http://www.postgresql.org/docs/current/static/sql-cluster.html](http://www.postgresql.org/docs/current/static/sql-cluster.html)

请注意，此“订单”不会自动维护，您需要定期手动运行该语句。

* * *

但是，这***不会***保证检索行时的任何特定顺序。即使不涉及连接或聚合，也不会。

即使您所做`select * from the_table`的只是返回行的顺序，仍然不能保证。例如：Postgres 有一个称为“同步 seq 扫描”的功能，这意味着如果一个会话开始 seq 扫描`select * from ...`（是），然后在结果的末尾添加“错过”的行。

保证结果集顺序的唯一***方法*****（真的：唯一**）是提供一个`order by`子句。

* * *

仅当您的服务器中有一个硬盘（**不是***SSD*）时，这才有意义（至少对我而言）。在这种情况下，seq 扫描*可能*会更快，因为所有块*可能*彼此相邻（由于文件系统重用可用空间的方式，这也不能保证）。

在 SSD 或使用带有许多硬盘的 RAID 阵列的适当服务器上，我看不出这有什么好处。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2014-08-22T16:04:59.117

你试过“订购”吗？例如，“SELECT * FROM table_name ORDER BY date ASC;”？如果您希望日期倒序，您可以尝试“DESC”而不是“ASC”。

# java - 如果从其他 JFrame 开始，JFrame 不会绘制任何数字

> ID：14175995
> 
> 赞同：1
> 
> 时间：2013-01-05T20:19:08.643
> 
> 标签：java, swing, jpanel, draw, event-dispatch-thread

我对 Java（C# 程序员）很陌生，我在这里遇到了一个我不明白的问题。对不起糟糕的英语。=)

我正在开发一个简单的 Snake 游戏，我有不同的类、枚举等。我的问题是，如果我使用 Menu 类中的游戏调用 JFrame，它不会做任何事情。我可以通过代码进行调试，但它没有绘制任何东西。如果我直接从 Main 方法启动 Game 类，没有问题。

我认为这是一个简单的错误，我只是愚蠢地看到它。

这里的代码：

鼠标事件：

```
else if (mouseX > 75 && mouseX < 175 && mouseY > 260
                && mouseY < 285) {
            startGame(); 
```

Menu 类中的 startGame 方法：

```
public void startGame(){
    this.setVisible(false);
    game = new Game();
} 
```

游戏构造器：

```
public Game() {
    super("Snake V 0.1");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setSize(940, 620);
    setLocation(200, 200);
    addKeyListener(keyListener);
    setVisible(true);
    //this.createBufferStrategy(2);

    zeichnung.addFigur(new Field(0, 0));
    snake = new Snake(40, 300, 1);
    zeichnung.addFigur(snake);
    zeichnung.addFigur(new Diamond());

    this.getContentPane().add(jpanel);

    this.repaint();

    this.Intervall();
} 
```

间隔：

```
public void Intervall() {
    while (true) {
        try {
            snake.direction = keyListener.getDirection();
            zeichnung.checkCollision(snake);
            snake.move();
            this.repaint();
            Thread.sleep(150);
        } catch (InterruptedException e) {
            // TODO: handle exception
        }
    }
} 
```

正如我之前所说。如果我直接从 Main 方法启动 Game 类（简单的 Game game = new Game();）就没有问题。

我希望我不会忘记任何重要信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T23:32:31.403

它根本不应该在任何 Swing GUI 中工作。

Thread.sleep() 杀死重绘和监听。

有关问题的示例，请参见此处的最终帖子

[http://www.coderanch.com/t/600642/GUI/java/update-getGraphics](http://www.coderanch.com/t/600642/GUI/java/update-getGraphics)

改用摆动计时器

# xcode - 在设置包中设置切换开关以隐藏和显示按钮

> ID：14175996
> 
> 赞同：1
> 
> 时间：2013-01-05T20:19:12.997
> 
> 标签：xcode, uibutton, nsuserdefaults, uiswitch, settings.bundle

我目前有一个使用“if”语句隐藏或取消隐藏一些 UIButtons 的 UISwitch。开关的开/关状态和按钮的隐藏状态都保存在 NSUserDefaults 中。我想知道如何使该开关出现在设置包中。

这是 .m 中的“if”语句代码：

```
- (IBAction)switchTheSwitch:(id)sender {
if (Languages.on) {
    china.hidden = NO;
    japan.hidden = NO;
    french.hidden = NO;
    spanish.hidden = NO;
}

else {
    china.hidden = YES;
    japan.hidden = YES;
    french.hidden = YES;
    spanish.hidden = YES;

}
[self buttonHidden:sender];
} 
```

现在这是我的代码，它将开关的隐藏状态保存在 .m 中：

```
- (void)buttonHidden:(id)sender {

NSUserDefaults *Defaults = [NSUserDefaults standardUserDefaults];
[Defaults setBool:china.hidden forKey:ChinaChanged];
[Defaults setBool:japan.hidden forKey:JapanChanged];
[Defaults setBool:french.hidden forKey:FrenchChanged];
[Defaults setBool:spanish.hidden forKey:SpanishChanged];
[Defaults synchronize];

} 
```

这是我在.m中保存开/关状态的代码：

```
- (IBAction)switchChangedValue:(id)sender {
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
[userDefaults setBool:Languages.on forKey:SwitchChanged];
[userDefaults synchronize];

} 
```

这是我的视图确实加载：

```
- (void)viewDidLoad {

NSUserDefaults *Defaults = [NSUserDefaults standardUserDefaults];
china.hidden = [Defaults boolForKey:ChinaChanged];
japan.hidden = [Defaults boolForKey:JapanChanged];
french.hidden = [Defaults boolForKey:FrenchChanged];
spanish.hidden = [Defaults boolForKey:SpanishChanged];

[super viewDidLoad];

NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
Languages.on = [userDefaults boolForKey:SwitchChanged];

} 
```

如何使设置包中的切换开关替换视图控制器上的开关？

# django - 没有从表单中删除 Django 字段

> ID：14175998
> 
> 赞同：0
> 
> 时间：2013-01-05T20:19:31.393
> 
> 标签：django, forms, field

我有一个定义如下的表格：

```
from django import forms
from django.contrib.auth.models import User
from django.contrib.auth.forms import UserCreationForm as DjangoUserCreationForm

class UserEmailForm(DjangoUserCreationForm):
    email = forms.EmailField(required=True)

    class Meta:
        model = User
        fields = ("email",)

    def save(self, commit=True):
        user = super(UserEmailForm, self).save(commit=False)
        user.email = self.cleaned_data["email"]
        if commit:
            user.save()
        return user 
```

但是当我尝试显示表单时，它显示了四个字段，用户名、电子邮件、密码1、密码2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:30:30.927

这些字段在 UserCreationForm 表单中定义，Meta#fields 不会影响它们

# database - Oracle 自动授予权限

> ID：14175999
> 
> 赞同：2
> 
> 时间：2013-01-05T20:19:45.920
> 
> 标签：database, oracle, database-schema, database-management

我正在尝试分析 DBMS 提供的安全性，以下场景简要描述了我正在寻找的内容。

// 当前连接数据库的用户是“master”

// 1\. 创建新用户的基本步骤

```
CREATE USER slave
IDENTIFIED BY SlavePassword
DEFAULT TABLESPACE SomeTablespace; 
```

// 2\. 为新用户授予基本角色

```
GRANT CONNECT TO slave;
GRANT RESOURCE TO slave; 
```

// 3\. 新用户“slave”现在已连接到数据库

// 用户“slave”创建数据库对象（表、过程等），并授予系统其他用户的权限

如何让创建者“主人”在没有得到“奴隶”用户明确许可的情况下获得所创建的用户“奴隶”拥有或将来将拥有的任何特权？

我知道奴隶可以将他的任何特权授予其他用户，但是是否有特殊特权允许其他用户获得“奴隶”将来拥有的特权？

我正在使用 Oracle，但我不确定其他 DBMS 是否允许这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T14:48:37.987

使用 Database Vault 执行此操作的唯一方法。如果您为“从属”用户创建一个领域并将“主”用户添加到该领域，那么主用户将拥有该架构中所有对象的权限。本教程来自 OTN

[http://apex.oracle.com/pls/apex/f?p=44785:24:0::NO:24:P24_CONTENT_ID,P24_PREV_PAGE:4544,29](http://apex.oracle.com/pls/apex/f?p=44785:24:0::NO:24:P24_CONTENT_ID,P24_PREV_PAGE:4544,29)

引导您创建领域。您只需完成将“master”添加为领域参与者的附加步骤

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T18:22:50.970

您可以使用[代理用户](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_4003.htm#i2058312)来执行此操作。

这将让 MASTER 看到 SLAVE 的对象。但是，当 MASTER 作为 SLAVE 连接时，它不再能看到 MASTER 对象。

```
--Create master user
create user master identified by master;
grant connect, create table to master;

--Create slave user, and grant proxy to master
create user slave identified by slave;
grant connect, create table to slave;
alter user slave grant connect through master;

--Connect as master, create a table
sqlplus master/master@orcl2
create table master_table(a number);
exit;

--Connect as slave, create a table
sqlplus slave/slave@orcl2
create table slave_table(a number);
exit;

--Connect as master, but pretending to be slave
sqlplus master[slave]/master@orcl2

--You can see the slave tables 
select * from slave_table;
    no rows selected

--But you cannot see the master tables
select * from master.master_table;
    ERROR at line 1:
    ORA-00942: table or view does not exist              * 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T00:47:23.933

Oracle 帐户模型无法按照您描述的方式工作。创建用户的用户对该用户创建的对象没有特殊权限。所有用户都出生在手动状态

对象权限只有两个级别：

*   授予个别模式中特定对象的权限
*   授予每个模式中给定类型的所有对象的特权，通过 ANY 特权获得。

第一级是您提到的机制，SLAVE 将其对象的权限授予 MASTER。第二级非常强大，因为它适用于所有用户拥有的所有对象，包括 Oracle DBMS 帐户，例如 SYS。因此，只有 DBA 用户拥有 ANY 级别的权限是正常的。

出现这种情况的原因是 Oracle 使用用户和模式作为控制对数据和功能的访问的机制。在这种情况下，完全由另一个用户拥有的用户没有任何意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T21:31:18.677

我不确定您在这里的要求...如果您希望“主”用户自动访问“从”对象，那么您可以通过授予 dba 主

```
grant dba to master; 
```

如果您打算做其他事情，请用更多细节来澄清您的问题，以帮助您。