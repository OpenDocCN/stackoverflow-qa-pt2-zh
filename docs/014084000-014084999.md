# StackOverflow 问答 14084000-14084999

# function - 在 MATLAB 中从二维数组创建函数（用于 ode45）

> ID：14084001
> 
> 赞同：2
> 
> 时间：2012-12-29T17:11:06.790
> 
> 标签：function, matlab, interpolation

我是第一次使用 MATLAB。我在 MATLAB 中有一个 t vs f 的二维数组。这个二维数组对应一个函数，比如 f(t)。我正在使用 ode45 求解一组微分方程，而 f(t) 是其中一个系数，即我有一组 x'(t)=f(t)x(t) 形式的方程或其变体。我该如何进行？

我需要一种方法将我的 t 与 f 数组转换为可在 ode45 方法中使用的函数。据推测，转换将进行一些线性插值并给我最佳拟合曲线的方程。

或者，如果有另一种方法，我全神贯注！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:01:16.597

这是一个将函数作为参数传递到 ODE 右侧的简单示例。在同一目录下创建文件并运行 main

**主文件**

```
t = 0:0.2:10; f = sin(t);
fun = @(xc) interp1(t, f, xc);

x0=0.5
% solve diff(x, t)=sin(t)  
% pass function as parameter                           
[tsol, xsol] = ode45(@(t, x) diff_rhs(t, x, fun),[0.0 8.0], 0.5);

% we solve equation dx/dt = sin(x), x(0)=x0
% exact solution is x(t) = - cos(t) + x(0) + 1
plot(tsol, xsol, 'x');
hold on
plot(tsol, -cos(tsol) + x0 + 1, '-');
legend('numerical', 'exact'); 
```

**diff_rhs.m**

```
function dx = diff_rhs(t, x, fun)
  dx = fun(t);
end 
```

文档中的参考资料：[interp1](http://www.mathworks.com/help/matlab/ref/interp1.html)和[匿名函数](http://www.mathworks.com/help/matlab/matlab_prog/anonymous-functions.html?s_tid=doc_12b)。

# java - 在 Java 中确定“类型”

> ID：14084003
> 
> 赞同：1
> 
> 时间：2012-12-29T17:11:18.803
> 
> 标签：java, types

我是 Java 新手，Java 中是否有一种方法可以告诉您对象的类型？

例如在 Python 中，如果你输入

`type(34)`它会回来`int`

`type('abc')`会回来`string`

我一直在到处寻找，但我找不到这样做的方法。有什么帮助吗？

非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T17:12:49.240

操作符是进行运行时类型检查的[`instanceof`](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.20.2)最便捷方式：

```
if (someObject instanceof String) {
    // It's a string
} 
```

或者，在任何实例上，您都可以使用[`getClass`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#getClass%28%29)，它为您提供`Class`对象类型的实例。

```
Class c = someObject.getClass(); 
```

该`Class`实例将有一个[`getName`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getName%28%29)方法，您可以调用该方法来获取名称的字符串版本（以及许多其他方便的方法）。

您可以`Class`使用从类型名称获取对象`.class`，例如：

```
Class stringClass = String.class; 
```

正如 Peter Lawrey 在评论中指出的那样，所有这些都假设您正在处理对象引用，而不是原始对象。没有办法对原语进行运行时类型检查，但这没关系，因为与对象引用不同（编译时声明可能在哪里`Object`），由于声明，您总是知道您的原语类型是什么。只有对象类型才会真正出现这种情况。

* * *

如果您发现自己在 Java 代码中进行了大量显式类型检查，则可能表明存在结构/设计问题。在大多数情况下，您不需要在运行时检查类型。（当然也有例外。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-21T10:25:17.963

基本上我们可以通过使用方法覆盖来实现我们的目标

```
 class GetType {
        void printType(byte x) {
            System.out.println(x + " is an byte");
        }
        void printType(int x) {
            System.out.println(x + " is an int");
        }
        void printType(float x) {
            System.out.println(x + " is an float");
        }
        void printType(double x) {
            System.out.println(x + " is an double");
        }
        void printType(char x) {
            System.out.println(x + " is an char");
        }
    } 
    public static void main(String args[]) {
          double doubleVar = 1.5;
          int intVar = 7;
          float floatVar = 1f;

          GetType objType = new GetType();
          objType.printType(doubleVar);
          objType.printType(intVar);
          objType.printType(floatVar);
    } 
```

# python - 如何设计一个键具有多个对应值的Django模型？

> ID：14084005
> 
> 赞同：0
> 
> 时间：2012-12-29T17:11:22.627
> 
> 标签：python, django, orm

例如我有数据：

```
key:     unique value:
value1   672345
value1   823764
value1   478214
value1   123575
value2   866323
value2   967386 
```

存储在一张表中的唯一值，最好不要触碰。此外，可以为多个唯一值分配一个键。另一个表将包含具有唯一键的列。

Django中有什么好的设计方法来表达这种关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:13:37.053

这是演示如何定义模型和字段的简单模型：

```
from django.db import models

class Value(models.Model):
    val = models.IntegerField(unique=True)

class Key(models.Model):
    key = models.CharField(max_length=50)
    value = models.ManyToManyField(Value, related_name='values') 
```

这就是您可以查询模型以获取键及其值的方式：

```
from myApp.models import Key, Value # where myApp is your app name

key = Key.objects.get(key='my_key')
values = key.values.all() 
```

# java - 私有类变量与过多的参数传递

> ID：14084007
> 
> 赞同：4
> 
> 时间：2012-12-29T17:11:32.337
> 
> 标签：java, android, design-patterns, encapsulation

我目前正在开发一个使用大量共享 UI 对象（如 Button 等）的单一活动 Android 应用程序。目前，我将这些 UI 对象声明为私有非静态类变量。对此的替代方法是不断地将对象从方法传递到方法并以这种方式修改它们。我目前还不清楚应该首选哪个选项，因为在我看来，使用最大封装形式会导致我做很多参数传递。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T17:18:08.903

通常，我喜欢将封装视为将数据隐藏在单个类中。如果多个方法在类中访问该对象，那并没有真正违反封装原则。一旦你开始在课堂外泄漏它，就会出现封装问题。

话虽如此，拥有一个私有成员是一个 Button 并且多个方法可以访问该按钮是非常好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:34:05.823

如上所述，杰夫说，您应该在一个活动中传递参数，正如您在问题中提到的那样，封装始终是推荐的第一件事。如果可以的话，我建议您再做一件事：

定义一个将接受颜色代码或颜色类型的函数，并从要更改按钮文本颜色的所有函数中调用此函数。这样，​​代码可以在一个执行相同操作的地方，即更改颜色.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:37:40.703

这取决于您想要作为参数传递的那些私有非静态变量是否真的有意义成为类的属性。如果您认为它有意义并且对它们的更新/修改具有设计控制权，您可以继续并将它们声明为班级成员

# java - 无法通过 JADE 在 android 中接收 ACLMessage

> ID：14084011
> 
> 赞同：1
> 
> 时间：2012-12-29T17:11:52.377
> 
> 标签：java, android, agents-jade

我目前正在使用 JADE 使用基于主题的通信。我可以注册一个 JADE 代理，`jade.core.messaging.TopicManagementFEService`从而连接到同一平台中的主容器。

详情如下：

1.  Main-Container：一个简单的 LAMP/WAMP 服务器，托管 Main-Container。
2.  客户端：用于连接主容器的 Android 模拟器（测试目的）。

目前，

1.  服务器启动主容器
2.  Android 模拟器成功连接到主容器（代理创建并启用主题管理服务）
3.  服务器正在根据特定主题发送消息。

**但是我的Android客户端虽然注册的主题两端是一样的，但是却收不到这个消息！**

你可以看到下面的代码：

`Server Side:`

```
TopicManagementHelper topicHelper = (TopicManagementHelper) getHelper(TopicManagementHelper.SERVICE_NAME);
final AID sensorTopic = topicHelper.createTopic("JADE");
topicHelper.register(sensorTopic);

addBehaviour(new TickerBehaviour(this, TIMER_VALUE_IN_MILLISECONDS) {

private static final long serialVersionUID = -2567778187494378326L;

    public void onTick() {

        ACLMessage msg = new ACLMessage(ACLMessage.INFORM);
        msg.addReceiver(eventTopic);
        msg.setContent(eventValue);
        myAgent.send(msg);
    }
}); 
```

`Android Side:`

```
// Registering on Android Side as well
TopicManagementHelper topicHelper = (TopicManagementHelper) getHelper(TopicManagementHelper.SERVICE_NAME);
topic = topicHelper.createTopic("JADE"); // See, same topic!
topicHelper.register(topic);

behaviour = new myBehaviour(this, TIMER_VALUE_IN_MILLISECONDS, topic);
addBehaviour(behaviour);

private class myBehaviour extends TickerBehaviour {

 private static final long serialVersionUID = 4782913834042415090L;
 AID topic;
 Agent agent;
 MessageTemplate tpl;

   public myBehaviour(Agent a, long period, AID topic) {
    super(a, period);

    this.agent = a;
    this.topic = topic;
   }

   public void onTick() {
    tpl = MessageTemplate.MatchTopic(topic);
    ACLMessage msg = receive(tpl);
    if (msg != null) {
       logger.log(Level.INFO, "Agent "+ agent.getLocalName() + 
                           ": Message about topic "+ topic.getLocalName() +" received. \n" +
                                    "Content is " + msg.getContent());
       data = msg.getContent();

    } else {
       logger.log(Level.INFO, "In here..."); // Always executes only this code!
       block();
    }
  }
} 
```

我在哪里错了？它总是执行`else`Android端的部分，很明显收到的消息是NULL！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T18:39:49.847

在 JADE 中，Android 4.3.0 及以下版本无法正常接收主题消息。Android 可以发送主题消息但无法接收。我通过自己的问题发现了这一点。我已经在我自己关于堆栈溢出的问题中发布了有关它的更多信息。

看一看。 [JADE Leap Android App 无法接收主题消息](https://stackoverflow.com/questions/16754026/jade-leap-android-app-unable-to-receive-topic-messages)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T04:37:21.583

没关系。逻辑是错误的。Android-Agent 没有向 Central-Agent 标识自己。

我设置了本体，以便中央代理能够识别此类消息并相应地发送消息。现在，它正在接收消息！

自助有时有效！;-)

# android - 软键盘不来

> ID：14084014
> 
> 赞同：0
> 
> 时间：2012-12-29T17:12:08.733
> 
> 标签：android, android-edittext, android-softkeyboard

我有一个基于某些条件的编辑文本，我动态地想要执行点击，所以我使用：0`editText.performClick()`

使用这个触发点击事件，我也可以在编辑文本中看到焦点，但软键盘没有出现，我也试过： -

```
((InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE)).showSoftInput(editText,
                    InputMethodManager.SHOW_IMPLICIT); 
```

和

```
((InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE)).showSoftInput(editText,
                    InputMethodManager.SHOW_FORCED); 
```

但是键盘没有出现......任何想法......谢谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:22:51.033

试试 InputMethodManager 的 toggleSoftInput 方法。

# build - 在 64 位机器上安装 32 位 PBC 库

> ID：14084016
> 
> 赞同：2
> 
> 时间：2012-12-29T17:12:23.393
> 
> 标签：build, x86, 32bit-64bit, libraries, configure

我想为我的项目安装 PBC 库。在我的 64 位系统上，配置脚本很容易安装 64 位库。但是我必须使用的代码是建立在 32 位上的。

我试过这个命令（来自这个[问题](https://stackoverflow.com/questions/3261909/build-32bit-on-64-bit-linux-using-a-configure-script)的答案）：

```
./configure --build=i686-pc-linux-gnu "CFLAGS=-m32" "CXXFLAGS=-m32" "LDFLAGS=-m32" 
```

但是当我运行 'make' 时出现此错误：

```
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-field.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-z.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-naivefp.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-fastfp.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-fp.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-fasterfp.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-montfp.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-multiz.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-dlog.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-fieldquadratic.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-poly.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-random.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-init_random.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-darray.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-symtab.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-get_time.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-utils.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-memory.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-extend_printf.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-mpc.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-mnt.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-hilbert.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-curve.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-pairing.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-singular.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-param.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-a_param.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-d_param.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-e_param.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-f_param.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `.libs/libpbc_la-g_param.o' is incompatible with i386 output 
```

'--help' 列出了以下标志：

```
Some influential environment variables:
CC          C compiler command
CFLAGS      C compiler flags
LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a nonstandard directory <lib dir>
LIBS        libraries to pass to the linker, e.g. -l<library>
CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if you have headers in a nonstandard directory <include dir>
CPP         C preprocessor
Use these variables to override the choices made by `configure' or to help it to find libraries and programs with nonstandard names/locations. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:32:48.307

首先，检查：

```
./configure --help 
```

它是否允许覆盖 CFALGS/LDFLAGS？

如果是，请按照帮助信息进行操作。其次，通常，./configure 会生成 makefile，然后您发出“make”命令。您说，您在配置后遇到此错误？

如果您在 make 之后遇到这些错误，那么看起来 ld 正在与旧残基链接。

你试过了吗：

```
make clean;make 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:26:51.243

谢谢@Icarus3。你为我指明了正确的方向。我使用的命令是：

```
./configure --build=i686-pc-linux-gnu "CFLAGS=-m32" "CXXFLAGS=-m32" "LDFLAGS=-m32" 
```

当我跑

```
./configure --help 
```

它没有`CXXFLAGS`。所以我把它改成了`CPPFLAGS=-m32`. 它奏效了。

# php - 在 PHP foreach 循环中使用 jQuery 函数

> ID：14084023
> 
> 赞同：0
> 
> 时间：2012-12-29T17:12:54.543
> 
> 标签：php, javascript, jquery, foreach

我有一个 PHP 元素数组

现在我想为每个数组元素创建一个链接或一个按钮，当单击时，数组值应该出现在特定的 div 内。

这是我的代码：

```
<?php
$array = array('apple', 'banana', 'orange');
foreach($array as $element) {
?>
    <a href="#" onclick="return false;" id="showElement"><?php echo $element; ?></a><br />
    <script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        $("#showElement").click( function() {
            $("#hot").append('<?php echo $element; ?><br />');
        });
    });
    </script>

    <?php
    }
    ?>
    <div id="hot"></div> 
```

这并不像我想要的那样工作。它显示每个数组元素的单独链接，但是当我单击第一个时，它只显示所有三个数组元素，而不仅仅是预期的。其他两个链接什么也不做。

任何帮助将不胜感激，我的方法甚至可能是完全错误的方法，所以请引导我采用正确的方法。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T17:22:03.047

我不知道您实际上想要实现什么，但是您应该分开关注点[即至少不要让 php 直接与 js 混淆]。

考虑通过属性注入你的值`data-*`，然后通过 jQuery 检索它们，如下所示：

```
<?php foreach($array as $element): ?>

    <a href="#" class="yourClass" data-value="<?php echo $element; ?>"><?php echo $element; ?></a>

<?php endforeach; ?>

<div id="target"></div>

<script>

$(function(){

    var $target = $('#target')

    $('.yourClass').click(function(e){

        e.preventDefault()

        $target.append( $(this).data('value') )

    })

})

</script> 
```

请记住，该`id`属性应该是唯一的，并且不能在整个 DOM 中重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:23:01.813

试试这个

```
<?php
$array = array('apple', 'banana', 'orange');
foreach($array as $element) {
?>
    <a href="#" onclick="return false;" id="showElement-<?php echo $element; ?>"><?php echo $element; ?></a><br />
    <script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        $("#showElement-<?php echo $element; ?>").click( function() {
            $("#hot").append('<?php echo $element; ?><br />');
        });
    });
    </script>

    <?php
    }
    ?>
    <div id="hot"></div> 
```

问题是您将相同的 id 绑定到 append 函数。我已经改变了你的身份证名称。您可以使用简单地更改它们

```
$("#showElement-<?php echo $element; ?>") 
```

所以他们无论如何都会得到一个不同的id名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:25:36.970

关于什么：

```
<?php
$array = array('apple', 'banana', 'orange');
$i=0;
foreach($array as $element) {
    echo '<a href="#" class="showElement" id="showElement'.$i.'">'.$element.'</a><br />';
    $i++;
}
?> 
```

然后

```
<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
    var $target = $('#target');
    $(".showElement").click( function(e) {
        e.preventDefault();
        $target.append( $(this).text() );
    });
});
</script> 
```

# asp.net-mvc-4 - 带有扩展名的 url 没有被路由处理

> ID：14084024
> 
> 赞同：14
> 
> 时间：2012-12-29T17:12:56.013
> 
> 标签：asp.net-mvc-4, asp.net-mvc-routing

我一直在遵循[本文中的建议，](http://geekswithblogs.net/jjulian/archive/2012/04/25/adding-robots.txt-to-your-asp.net-mvc-3-applications.aspx)在 asp.net mvc3 中设置 robots.txt 文件以使用控制器处理服务器响应，并且 IIS 8.0 express 返回文件未找到错误，而不是 asp。净误差。

在这些情况下，如何让 IIS 不查找文件？web.config 中有我需要的东西吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-29T17:24:33.857

IIS 试图在这里变得智能。他截取了 url 中的点并认为这是一个静态文件并尝试使用默认`StaticFile`处理程序来提供它。它不会让事件到达托管的 ASP.NET 应用程序。

第一种可能性是在您的 web.config 中添加以下内容

```
<system.webserver>
    <modules runAllManagedModulesForAllRequests="true" /> 
```

但实际上我不建议您这样做，因为这可能会对应用程序的性能产生负面影响，因为现在对静态文件（例如 .js、.css、图像...）的所有请求都将通过托管管道。

推荐的方法是将以下处理程序添加到您的`web.config`(`<handlers>`标记`<system.webServer>`)：

```
<system.webServer>
    <handlers>
        <add name="Robots-ISAPI-Integrated-4.0" path="/robots.txt" verb="GET" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
        ...
    </handlers>
</system.webServer> 
```

请注意我们如何指定此处理程序仅适用于特定的 URL 和 HTTP 动词。

现在，当您 GET 时`/robots.txt`，IIS 将不再使用处理程序处理它，`StaticFile`而是将其传递给托管管道 ASP.NET。然后会被路由引擎拦截，路由到对应的控制器动作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T13:35:20.730

除非您需要动态生成的*robots.txt*文件（这很少需要），否则只需执行以下操作：

*   忽略到 robots.txt 的路由

    routes.IgnoreRoute("robots.txt");

*   将 robots.txt 文件添加到您的根目录

# android - 更改用户和 android 应用程序文件组以复制用户正在遇到的问题

> ID：14084026
> 
> 赞同：5
> 
> 时间：2012-12-29T17:13:22.713
> 
> 标签：android, shell, adb

我在市场上有一个 android 应用程序，我的一个用户报告了一个其他人没有遇到过的问题（至少据我所知）。他们告诉我他们做了什么，他们使用了什么设置以及他们正在使用的 android 版本，所以我试图尽可能多地复制它。

我在更新之前安装了原始应用程序（当一切正常时），并以与用户所说的相同的方式进行设置。然后我进入 shell 并`/data/data/com.mycompany.myapp/`检查`databases`and`shared_prefs`文件夹以检查所有权，两个文件都设置为，用户和组都设置为`app_36`. 然后，我将所有内容拉到我的开发 PC 上，这样我就有了数据库和 prefs 文件。

然后我卸载了原始版本并使用`adb install`com.mycompany.myapp `I then upload the databases and prefs file using`adb push`` 安装了新版本的应用程序，然后使用 adb shell 查看了文件的权限，可以看到它们现在归 root 所有，所以应用程序无法访问那些文件。然后我尝试从 adb shell 执行以下操作：

```
adb shell
cd com.mycompany.myapp/shared_prefs
chown app_36:app_36 prefs.xml 
```

这将在普通 linux 中工作，将用户和组更改为 app_36，但它说没有用户 app_36:app_36。但是，如果我执行 chown app_36 prefs.xml 它会更改所有者，但我无法更改组。

要更改我使用 chgrp app_36 prefs.xml 的组，但它会说 chgrp not found。

如何更改用户和组，以便我可以复制文件并复制我的用户遇到的问题。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T18:21:31.640

使用点作为分隔符：

```
chown app_36.app_36 prefs.xml 
```

# hadoop - Hive - 地图不向自定义地图脚本发送参数？

> ID：14084032
> 
> 赞同：0
> 
> 时间：2012-12-29T17:13:38.507
> 
> 标签：hadoop, hive, elastic-map-reduce

我正在尝试将 map 子句与 Hive 一起使用，但我遇到了语法问题，并且没有找到很多我的用例示例。当我不得不使用外部脚本处理表的列之一时，我使用了 map 子句。

我有一个名为 的 python 脚本`run`，它接受一个命令行参数并输出三个空格分隔的值。所以我只是做了：

```
FROM(MAP
        tablename.columnName
     USING
        'run' AS
        result1, result2, result3
     FROM
        tablename
    ) map_output
    INSERT OVERWRITE TABLE results SELECT *; 
```

现在我有一个 python 脚本，它接收更多的参数，并尝试了一些不起作用的东西，也找不到这方面的例子。我做了很明显的事情：

```
FROM
    (MAP
        numAgents, alpha, beta, burnin, nsteps, thin
     USING
        'runAuthorityMCMC' AS numAgents, alpha, beta, energy, avgDegree, maxDegree, accept
     FROM
        parameters
    ) map_output
INSERT OVERWRITE TABLE results SELECT *; 
```

`A user-supplied transfrom script has exited with error code 2 instead of 0.`但是当我运行时出现错误`runAuthorityMCMC`，从该表中采样了 6 个命令行参数，它运行良好。

在我看来，它试图在根本不传递参数的情况下运行脚本。如果是这种情况，在其中一条错误消息中，我得到了我所期望的输出。做我想做的事情的正确语法是什么？

编辑：

确认 - 这是错误消息的一部分：

```
usage: runAuthorityMCMC [-h]
                        numAgents normalizedBrainCapacity ecologicalPressure
                        burnInSteps monteCarloSteps thiningRatio
runAuthorityMCMC: error: too few arguments 
```

这正是我期望的输出，但论点太少了。脚本应该有六个参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:17:41.237

好的，也许这里的词汇有所不同，但 hive 不会将值作为“参数”发送到脚本。它们是通过标准输入读入的（这与将某些东西作为参数传递不同）。此外，您可以尝试发送数据以`/bin/cat`查看实际发送到蜂巢的内容。如果我没记错的话，这些值是以制表符分隔发送的，并且从脚本发出的结果也应该是制表符分隔的。

尝试从脚本中的 stdout（或 stderr）打印内容，您将在 jobtracker 日志中看到结果。这将帮助您调试。

# google-apps-script - Google CRUD 从 SQL API 迁移到 Fusion Tables API

> ID：14084036
> 
> 赞同：0
> 
> 时间：2012-12-29T17:14:00.743
> 
> 标签：google-apps-script, google-fusion-tables

我使用[了 Google Apps Developer Blog 中的 Ferris Argyle 的 CRUD](http://googleappsdeveloper.blogspot.com/2011/09/using-fusion-tables-with-apps-script.html)，现在必须将此 SQL API 迁移到 Fusion Tables API。完整的代码在[这里](https://sites.google.com/a/ferrisargyle.com/blog-posts/using-fusion-tables-with-apps-script)。到目前为止，我的努力给我留下了代码 404 错误和很多这样的错误：“`<HTML><HEAD><TITLE>`未找到。” 理想情况下，此示例 CRUD 将由 Google 更新，但缺少更新也许有人可以提供指导。

我从迁移指南中更新的内容。

1.  打开 API，删除数字 ID，更新库（对我来说没有），更新 URL 端点。
2.  在查询参数中添加了“&alt=csv”。
3.  添加了'&key= *MyEncriptedAPIKey* '。
4.  我不确定是否必须更新 CRUD 中的 OAuth。
5.  我不确定 API Key 和 OAuth 之间的关系，我需要两者还是其中之一。

任何人都可以查看示例 CRUD 并告诉我我缺少什么吗？我是 Javascripts、Google Apps、OAuth 的新手，因此欢迎提供示例或链接。

谢谢，

斯科特“如果它没有坏就不要修理它”B

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T14:51:26.673

不幸的是，Google Apps 脚本目前没有原生支持 OAuth2 身份验证，这是新的 Fusion Tables API 访问私有数据所必需的。一些用户已经成功地在 Apps 脚本中自己实现了 OAuth2 流程的一部分，但作为新手，这可能不可行。如果您只访问公共数据，那么您应该能够通过使用 API 密钥来获取。

# jquery - jQuery：不过滤

> ID：14084038
> 
> 赞同：2
> 
> 时间：2012-12-29T17:14:41.497
> 
> 标签：jquery, filter

假设我有一个菜单，当我在菜单上悬停特定元素时`#sub`：另一个菜单正在向下滑动`.subnav`。

我怎样才能做到这一点：

当（'.subnav'）向下并且我没有悬停他并且也没有悬停（'#sub'）时，（'.subnav'）将向上滑动。

我试图用 not filter 来做到这一点。

*网页*：

```
<ul class="topnav">
        <li><a href="#">Home</a></li>
        <li id="sub"><a href="#">slide</a>   
            <ul class="subnav">
                <li><a href="#">sub</a></li>
                <li><a href="#">sub</a></li>
                <li><a href="#">sub</a></li>
            </ul>
       </li>
</ul> 
```

*JS*：

```
 $('.topnav #sub').hover(function() {
    $(this).children('.subnav').slideDown('fast');

    $(':not(#sub,#subnav)').hover(function () {
        $('#sub .subnav').slideUp('fast');
    });      
}); 
```

非常感谢（请解释最好的方法）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:20:52.720

### 您实际上可以使用 CSS 来做到这一点

```
<ul class="topnav">
    <li><a href="#">Home</a></li>
    <li id="sub"><a href="#">slide</a>   
        <ul class="subnav">
            <li><a href="#">sub</a></li>
            <li><a href="#">sub</a></li>
            <li><a href="#">sub</a></li>
        </ul>
   </li>
</ul> 
```

### 现在为您的 CSS

```
#sub:hover .subnav {display: block;} 
```

就如此容易。

### 小提琴：http: [//jsfiddle.net/ks22d/](http://jsfiddle.net/ks22d/)

* * *

### 否则，如果您想使用 jQuery 制作动画，只需调整以下代码：

```
$(document)​.ready(function(){
    $("#sub").children('.subnav').hide();
    $("#sub").hover(function(){
        $(this).children('.subnav').slideDown('fast');
    }, function(){
        $(this).children('.subnav').slideUp('fast');
    });
});​ 
```

### 小提琴：http: [//jsfiddle.net/ks22d/1/](http://jsfiddle.net/ks22d/1/)

*ps：受[Jan Dvorak](https://stackoverflow.com/users/499214/jan-dvorak)的回答启发...*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:20:59.073

`$(':not(#sub,#subnav)').hover(function () {`基本上意味着“当任何*不是* `#sub`or的事情时`#subnav`，做某事（此外，您要多次附加处理程序）

你想要的是

```
$("#sub").hover(
  function(){
    $(this).children('.subnav').slideDown('fast');
  },function(){
    $(this).children('.subnav').slideUp('fast');
  }
} 
```

`jQuery#hover`接受一个或两个函数作为参数。如果提供了两个函数，第一个在鼠标进入时调用，第二个在鼠标离开时调用。如果提供了一个函数，则在两种情况下都会调用它。
文档：[http ://api.jquery.com/hover/](http://api.jquery.com/hover/)

请注意，如果`.subnav`悬停，则悬停，`#sub`因此您无需同时检查两者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:23:40.143

***[jsBin 演示 1](http://jsbin.com/osojof/4/edit)***

```
$('.topnav #sub').hover(function() {
    $(this).find('.subnav').stop().slideToggle('fast');
}); 
```

或者，如果您喜欢它；）

***[jsBin 演示 2](http://jsbin.com/osojof/1/edit)***

```
$('.topnav #sub').on('mouseenter mouseleave',function( e ) {
    var slideDir = e.type=='mouseenter' ? 'slideDown' : 'slideUp';
    $(this).find('.subnav').stop()[slideDir]('fast');
}); 
```

# jquery - jquery显示完全错误

> ID：14084040
> 
> 赞同：-4
> 
> 时间：2012-12-29T17:14:57.490
> 
> 标签：jquery, slider

jquery 滑块出现问题，似乎我无法正确处理。

当我在我的电脑上编辑它时，滑块显示正确，但是当我上传网站时它显示完全错误。

我在 CSS 中尝试了不同的东西。但是我完全被卡住了，网站看起来都错了。

请看看[这个](http://www.northwind.cwahi.net)

```
/* Header Scroll */

.nivoSlider { position:relative;}
.nivoSlider img { position:absolute; top:0px; left:0px;}
.nivoSlider a.nivo-imageLink { position:absolute; top:0px; left:0px; width:100%; height:100%; border:0; padding:0; margin:0; z-index:60; display:none;}
.nivo-slice { display:block; position:absolute; z-index:50; height:100%; }
.nivo-caption { position:absolute; left:0px; bottom:0px;  color:#000; width:100%; z-index:89; padding-left: 10px; font-weight: bold}
.nivo-caption p { padding:10px 5px; margin:0;}
.nivo-directionNav a {position:absolute; width:45px; height: 60px; top:45%; z-index:99; cursor:pointer; text-indent:-9999%;}
.nivo-prevNav { background-position: left bottom; left:20px; background:url(images/top_left.png) no-repeat;}
.nivo-nextNav { background-position: left top; right: 0px; background:url(images/top_right.png) no-repeat;}
.nivo-controlNav { bottom:-20px; position:absolute; right:0;}
.nivo-controlNav a { float:left; width:14px; height:14px; display:block; position:relative; z-index:99; cursor:pointer; text-indent:-9999%; background:url(images/scroll_small.png) no-repeat scroll right top;}
.nivo-controlNav a.active { background-position:left top; margin-top:-1px;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:19:51.520

[http://northwind.cwahi.net/lib/jquery.custom.js](http://northwind.cwahi.net/lib/jquery.custom.js) 编码是一团糟。尝试使用不同的文件传输类型重新上传。

**代码**

```
//nivoSlider call ----------------------------------------------------
jQuery(document).ready(function() {
    jQuery('.waveshow').nivoSlider({
        effect:'sliceDown',
        slices:15,
        animSpeed:1000,
        pauseTime:5000,
        directionNav:true, //Next & Prev
        directionNavHide:true, //Only show on hover
        controlNav:false, //1,2,3...
        keyboardNav:true, //Use left & right arrows
        pauseOnHover:true, //Stop animation while hovering
        manualAdvance:false, //Force manual transitions
        captionOpacity:0.8, //Universal caption opacity
        beforeChange: function(){},
        afterChange: function(){},
        slideshowEnd: function(){} //Triggers after all slides have been shown
    });
});

//Wave slider function -------------------------------------------------------------

(function($) {

    $.fn.nivoSlider = function(options) {

        //Defaults are below
        var settings = $.extend({}, $.fn.nivoSlider.defaults, options);

        return this.each(function() {
            //Useful variables. Play carefully.
            var vars = {
                currentSlide: 0,
                currentImage: '',
                totalSlides: 0,
                randAnim: '',
                running: false,
                paused: false,
                stop:false
            };

            //Get this slider
            var slider = $(this);
            slider.data('nivo:vars', vars);
            slider.css('position','relative');
            slider.width('1px');
            slider.height('1px');
            slider.addClass('nivoSlider');

            //Find our slider children
            var kids = slider.children();
            kids.each(function() {
                var child = $(this);
                if(!child.is('img')){
                    if(child.is('a')){
                        child.addClass('nivo-imageLink');
                    }
                    child = child.find('img:first');
                }
                //Don't ask
                var childWidth = child.width();
                if(childWidth == 0) childWidth = child.attr('width');
                var childHeight = child.height();
                if(childHeight == 0) childHeight = child.attr('height');
                //Resize the slider
                if(childWidth > slider.width()){
                    slider.width(childWidth);
                }
                if(childHeight > slider.height()){
                    slider.height(childHeight);
                }
                child.css('display','none');
                vars.totalSlides++;
            });

            //Get initial image
            if($(kids[vars.currentSlide]).is('img')){
                vars.currentImage = $(kids[vars.currentSlide]);
            } else {
                vars.currentImage = $(kids[vars.currentSlide]).find('img:first');
            }

            //Show initial link
            if($(kids[vars.currentSlide]).is('a')){
                $(kids[vars.currentSlide]).css('display','block');
            }

            //Set first background
            slider.css('background','url('+ vars.currentImage.attr('src') +') no-repeat');

            //Add initial slices
            for(var i = 0; i < settings.slices; i++){
                var sliceWidth = Math.round(slider.width()/settings.slices);
                if(i == settings.slices-1){
                    slider.append(
                        $('<div class="nivo-slice"></div>').css({ left:(sliceWidth*i)+'px', width:(slider.width()-(sliceWidth*i))+'px' })
                    );
                } else {
                    slider.append(
                        $('<div class="nivo-slice"></div>').css({ left:(sliceWidth*i)+'px', width:sliceWidth+'px' })
                    );
                }
            }

            //Create caption
            slider.append(
                $('<div class="nivo-caption"><p></p></div>').css({ display:'none', opacity:settings.captionOpacity })
            );          
            //Process initial  caption
            if(vars.currentImage.attr('title') != ''){
                $('.nivo-caption p', slider).html(vars.currentImage.attr('title'));                 
                $('.nivo-caption', slider).fadeIn(settings.animSpeed);
            }

            //In the words of Super Mario "let's a go!"
            var timer = 0;
            if(!settings.manualAdvance){
                timer = setInterval(function(){ nivoRun(slider, kids, settings, false); }, settings.pauseTime);
            }

            //Add Direction nav
            if(settings.directionNav){
                slider.append('<div class="nivo-directionNav"><a class="nivo-prevNav">Prev</a><a class="nivo-nextNav">Next</a></div>');

                //Hide Direction nav
                if(settings.directionNavHide){
                    $('.nivo-directionNav', slider).hide();
                    slider.hover(function(){
                        $('.nivo-directionNav', slider).show();
                    }, function(){
                        $('.nivo-directionNav', slider).hide();
                    });
                }

                $('a.nivo-prevNav', slider).live('click', function(){
                    if(vars.running) return false;
                    clearInterval(timer);
                    timer = '';
                    vars.currentSlide-=2;
                    nivoRun(slider, kids, settings, 'prev');
                });

                $('a.nivo-nextNav', slider).live('click', function(){
                    if(vars.running) return false;
                    clearInterval(timer);
                    timer = '';
                    nivoRun(slider, kids, settings, 'next');
                });
            }

            //Add Control nav
            if(settings.controlNav){
                var nivoControl = $('<div class="nivo-controlNav"></div>');
                slider.append(nivoControl);
                for(var i = 0; i < kids.length; i++){
                    nivoControl.append('<a class="nivo-control" rel="'+ i +'">'+ (i + 1) +'</a>');
                }
                //Set initial active link
                $('.nivo-controlNav a:eq('+ vars.currentSlide +')', slider).addClass('active');

                $('.nivo-controlNav a', slider).live('click', function(){
                    if(vars.running) return false;
                    if($(this).hasClass('active')) return false;
                    clearInterval(timer);
                    timer = '';
                    slider.css('background','url('+ vars.currentImage.attr('src') +') no-repeat');
                    vars.currentSlide = $(this).attr('rel') - 1;
                    nivoRun(slider, kids, settings, 'control');
                });
            }

            //Keyboard Navigation
            if(settings.keyboardNav){
                $(window).keypress(function(event){
                    //Left
                    if(event.keyCode == '37'){
                        if(vars.running) return false;
                        clearInterval(timer);
                        timer = '';
                        vars.currentSlide-=2;
                        nivoRun(slider, kids, settings, 'prev');
                    }
                    //Right
                    if(event.keyCode == '39'){
                        if(vars.running) return false;
                        clearInterval(timer);
                        timer = '';
                        nivoRun(slider, kids, settings, 'next');
                    }
                });
            }

            //For pauseOnHover setting
            if(settings.pauseOnHover){
                slider.hover(function(){
                    vars.paused = true;
                    clearInterval(timer);
                    timer = '';
                }, function(){
                    vars.paused = false;
                    //Restart the timer
                    if(timer == '' && !settings.manualAdvance){
                        timer = setInterval(function(){ nivoRun(slider, kids, settings, false); }, settings.pauseTime);
                    }
                });
            }

            //Event when Animation finishes
            slider.bind('nivo:animFinished', function(){ 
                vars.running = false; 
                //Hide child links
                $(kids).each(function(){
                    if($(this).is('a')){
                        $(this).css('display','none');
                    }
                });
                //Show current link
                if($(kids[vars.currentSlide]).is('a')){
                    $(kids[vars.currentSlide]).css('display','block');
                }
                //Restart the timer
                if(timer == '' && !vars.paused && !settings.manualAdvance){
                    timer = setInterval(function(){ nivoRun(slider, kids, settings, false); }, settings.pauseTime);
                }
                //Trigger the afterChange callback
                settings.afterChange.call(this);
            });
        });

        function nivoRun(slider, kids, settings, nudge){
            //Get our vars
            var vars = slider.data('nivo:vars');
            if(vars.stop) return false;

            //Trigger the beforeChange callback
            settings.beforeChange.call(this);

            //Set current background before change
            if(!nudge){
                slider.css('background','url('+ vars.currentImage.attr('src') +') no-repeat');
            } else {
                if(nudge == 'prev'){
                    slider.css('background','url('+ vars.currentImage.attr('src') +') no-repeat');
                }
                if(nudge == 'next'){
                    slider.css('background','url('+ vars.currentImage.attr('src') +') no-repeat');
                }
            }
            vars.currentSlide++;
            if(vars.currentSlide == vars.totalSlides){ 
                vars.currentSlide = 0;
                //Trigger the slideshowEnd callback
                settings.slideshowEnd.call(this);
            }
            if(vars.currentSlide < 0) vars.currentSlide = (vars.totalSlides - 1);
            //Set vars.currentImage
            if($(kids[vars.currentSlide]).is('img')){
                vars.currentImage = $(kids[vars.currentSlide]);
            } else {
                vars.currentImage = $(kids[vars.currentSlide]).find('img:first');
            }

            //Set acitve links
            if(settings.controlNav){
                $('.nivo-controlNav a', slider).removeClass('active');
                $('.nivo-controlNav a:eq('+ vars.currentSlide +')', slider).addClass('active');
            }

            //Process caption
            if(vars.currentImage.attr('title') != ''){
                if($('.nivo-caption', slider).css('display') == 'block'){
                    $('.nivo-caption p', slider).fadeOut(settings.animSpeed, function(){
                        $(this).html(vars.currentImage.attr('title'));
                        $(this).fadeIn(settings.animSpeed);
                    });
                } else {
                    $('.nivo-caption p', slider).html(vars.currentImage.attr('title'));
                }                   
                $('.nivo-caption', slider).fadeIn(settings.animSpeed);
            } else {
                $('.nivo-caption', slider).fadeOut(settings.animSpeed);
            }

            //Set new slice backgrounds
            var  i = 0;
            $('.nivo-slice', slider).each(function(){
                var sliceWidth = Math.round(slider.width()/settings.slices);
                $(this).css({ height:'0px', opacity:'0', 
                    background: 'url('+ vars.currentImage.attr('src') +') no-repeat -'+ ((sliceWidth + (i * sliceWidth)) - sliceWidth) +'px 0%' });
                i++;
            });

            if(settings.effect == 'random'){
                var anims = new Array("sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade");
                vars.randAnim = anims[Math.floor(Math.random()*(anims.length + 1))];
                if(vars.randAnim == undefined) vars.randAnim = 'fade';
            }

            //Run effects
            vars.running = true;
            if(settings.effect == 'sliceDown' || settings.effect == 'sliceDownRight' || vars.randAnim == 'sliceDownRight' ||
                settings.effect == 'sliceDownLeft' || vars.randAnim == 'sliceDownLeft'){
                var timeBuff = 0;
                var i = 0;
                var slices = $('.nivo-slice', slider);
                if(settings.effect == 'sliceDownLeft' || vars.randAnim == 'sliceDownLeft') slices = $('.nivo-slice', slider).reverse();
                slices.each(function(){
                    var slice = $(this);
                    slice.css('top','0px');
                    if(i == settings.slices-1){
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed, '', function(){ slider.trigger('nivo:animFinished'); });
                        }, (100 + timeBuff));
                    } else {
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed);
                        }, (100 + timeBuff));
                    }
                    timeBuff += 50;
                    i++;
                });
            } 
            else if(settings.effect == 'sliceUp' || settings.effect == 'sliceUpRight' || vars.randAnim == 'sliceUpRight' ||
                    settings.effect == 'sliceUpLeft' || vars.randAnim == 'sliceUpLeft'){
                var timeBuff = 0;
                var i = 0;
                var slices = $('.nivo-slice', slider);
                if(settings.effect == 'sliceUpLeft' || vars.randAnim == 'sliceUpLeft') slices = $('.nivo-slice', slider).reverse();
                slices.each(function(){
                    var slice = $(this);
                    slice.css('bottom','0px');
                    if(i == settings.slices-1){
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed, '', function(){ slider.trigger('nivo:animFinished'); });
                        }, (100 + timeBuff));
                    } else {
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed);
                        }, (100 + timeBuff));
                    }
                    timeBuff += 50;
                    i++;
                });
            } 
            else if(settings.effect == 'sliceUpDown' || settings.effect == 'sliceUpDownRight' || vars.randAnim == 'sliceUpDown' || 
                    settings.effect == 'sliceUpDownLeft' || vars.randAnim == 'sliceUpDownLeft'){
                var timeBuff = 0;
                var i = 0;
                var v = 0;
                var slices = $('.nivo-slice', slider);
                if(settings.effect == 'sliceUpDownLeft' || vars.randAnim == 'sliceUpDownLeft') slices = $('.nivo-slice', slider).reverse();
                slices.each(function(){
                    var slice = $(this);
                    if(i == 0){
                        slice.css('top','0px');
                        i++;
                    } else {
                        slice.css('bottom','0px');
                        i = 0;
                    }

                    if(v == settings.slices-1){
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed, '', function(){ slider.trigger('nivo:animFinished'); });
                        }, (100 + timeBuff));
                    } else {
                        setTimeout(function(){
                            slice.animate({ height:'100%', opacity:'1.0' }, settings.animSpeed);
                        }, (100 + timeBuff));
                    }
                    timeBuff += 50;
                    v++;
                });
            } 
            else if(settings.effect == 'fold' || vars.randAnim == 'fold'){
                var timeBuff = 0;
                var i = 0;
                $('.nivo-slice', slider).each(function(){
                    var slice = $(this);
                    var origWidth = slice.width();
                    slice.css({ top:'0px', height:'100%', width:'0px' });
                    if(i == settings.slices-1){
                        setTimeout(function(){
                            slice.animate({ width:origWidth, opacity:'1.0' }, settings.animSpeed, '', function(){ slider.trigger('nivo:animFinished'); });
                        }, (100 + timeBuff));
                    } else {
                        setTimeout(function(){
                            slice.animate({ width:origWidth, opacity:'1.0' }, settings.animSpeed);
                        }, (100 + timeBuff));
                    }
                    timeBuff += 50;
                    i++;
                });
            }  
            else if(settings.effect == 'fade' || vars.randAnim == 'fade'){
                var i = 0;
                $('.nivo-slice', slider).each(function(){
                    $(this).css('height','100%');
                    if(i == settings.slices-1){
                        $(this).animate({ opacity:'1.0' }, (settings.animSpeed*2), '', function(){ slider.trigger('nivo:animFinished'); });
                    } else {
                        $(this).animate({ opacity:'1.0' }, (settings.animSpeed*2));
                    }
                    i++;
                });
            }
        }
    };

    //Default settings
    $.fn.nivoSlider.defaults = {
        effect:'random',
        slices:15,
        animSpeed:500,
        pauseTime:3000,
        directionNav:true,
        directionNavHide:true,
        controlNav:true,
        keyboardNav:true,
        pauseOnHover:true,
        manualAdvance:false,
        captionOpacity:0.8,
        beforeChange: function(){},
        afterChange: function(){},
        slideshowEnd: function(){}
    };

    $.fn.reverse = [].reverse;

})(jQuery); 
```

# iphone - 无法在 xcode 4.5.1 和 ios 5.1 中使用 testflight 或排灯节安装 ipa 文件

> ID：14084045
> 
> 赞同：0
> 
> 时间：2012-12-29T17:15:25.597
> 
> 标签：iphone, ios, xcode, ios5, testflight

海。

我在 5.1 版和 xcode 4.5.1 中开发了一个 IOS 应用程序。完成应用程序后，当我尝试使用临时分发在设备中运行它时，该应用程序无法安装在设备上。它显示弹出“无法下载应用程序。'此时无法下载'”。

我添加了分发和开发人员证书，直接从 xcode 安装时它不会发出任何此类警报，但仅在从 testflight 安装应用程序时才会出现问题。

有人可以告诉我我在哪里犯了错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:28:19.070

您必须使用您的 AdHoc 分发证书存档应用程序，然后从管理器的存档选项卡中单击分发并再次选择您的 AdHoc 证书。这产生的 .ipa 必须上传到 TestFlight，并且您必须通过 TestFlight 授权您的设备。这里有一些教程会有所帮助：

[创建 IPA 并将其上传到 TestFlight](http://help.testflightapp.com/customer/portal/articles/494413)

[在 TestFlight 上设置分发权限](http://help.testflightapp.com/customer/portal/articles/829819-setting-up-permissions-distribution)

如果您的 IPA 和权限都正确，那么根据[本文](http://help.testflightapp.com/customer/portal/articles/829652-received-an-unable-to-download-application-message-what-does-this-mean-)，错误可能与许多其他因素之一有关：

*   设备存储已满
*   配置文件是开发人员配置文件
*   ad hoc 分发配置文件已损坏，设备出现问题。
*   该设备已从备份中恢复，并导致无线分发冲突
*   网络超时

有关如何在设备上获取控制台日志的详细信息，请参阅参考文章。如果您仍然无法解决问题，请编辑您的问题并包含来自设备的控制台日志的相关部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T15:06:19.890

转到产品 -> 编辑架构 -> 构建配置

将 Debug 更改为 Release 并尝试一下。 ![在此处输入图像描述](../Images/8fb5b85642010eb23e9aeb297d134e7e.png)

# apache - mod_rewrite 问题 - RewriteEngine On 在尝试访问子目录时给出 403

> ID：14084064
> 
> 赞同：0
> 
> 时间：2012-12-29T17:18:02.540
> 
> 标签：apache, mod-rewrite

我有一个在共享主机空间上运行的网上商店（xtCommerce）。

根目录（安装、启动并运行 shop 1 的位置）包含 shop 软件提供的 .htaccess 文件

```
DirectoryIndex index.php

RewriteEngine on
RewriteCond %{REQUEST_URI} !^/media/
RewriteCond %{REQUEST_URI} !^/extAdmin/
RewriteCond %{REQUEST_URI} !^/skin/
RewriteCond %{REQUEST_URI} !^/js/

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule .* index.php 
```

我现在安装了第二个网上商店（也是 xtcommerce），在同一个网站空间中，在 /shop2 包含相同的 .htaccess 文件

```
www.shop1.net -> /
www.shop2.net -> /shop2 
```

-尝试访问 shop2 结果 403
-当我从 /shop2 中的 .htaccess 中删除 RewriteEngine 时，首页显示得很好，但链接似乎已损坏。

我对 mod_rewrite 不太了解，我尝试将 RewriteBase /shop2 添加到第二个 .htaccess 文件中，但失败了。

先感谢您！

编辑：即使我`RewriteRule .* http://google.de`在根目录中使用，并删除 /shop2 中的 .htaccess，我也会不断收到“禁止”。也许问题不在于重写？

**EDIT2：当前状态：**
*.htaccess in /*

```
DirectoryIndex index.php

RewriteEngine on

RewriteCond %{REQUEST_URI} !^/media/
RewriteCond %{REQUEST_URI} !^/extAdmin/
RewriteCond %{REQUEST_URI} !^/skin/
RewriteCond %{REQUEST_URI} !^/js/

RewriteCond %{HTTP_HOST} !shop2\.net$ [NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule .* index.php 
```

*/shop2 中的 .htaccess*（4 个不同的示例）

```
RewriteRule .* index.php # frontpage shop2.net works, any URLs to be rewritten result in 404
RewriteRule .* shop2/index.php # frontpage shop2.net works, any URLs to be rewritten result in 404
RewriteRule .* http://google.de # frontpage shop2.net works, any URLs to be rewritten result in 404
#RewriteRule .* index.php # shop2.net => forbidden 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:35:41.247

您在那里的虚拟主机设置相当奇怪。问题是根目录中的 htaccess 在 /shop2 中的 htaccess 之前执行。根 htaccess 重写根目录下的 index.php 文件。但是因为 shop2.net 的 document_root 是 /shop2，所以 index.php 文件在 document_root 之外，所以 apache 禁止这样做（应该如此）。要解决此问题，请将其放在根 htaccess 中。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !shop2.net$
RewriteCond %{REQUEST_URI} !^/media/
RewriteCond %{REQUEST_URI} !^/extAdmin/
RewriteCond %{REQUEST_URI} !^/skin/
RewriteCond %{REQUEST_URI} !^/js/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule .* index.php 
```

但最好只为 shop2 创建一个单独的文件夹，而不是 shop1 的子文件夹

# android - 如何从 eclipse android 打包中排除文件夹？

> ID：14084066
> 
> 赞同：1
> 
> 时间：2012-12-29T17:18:20.813
> 
> 标签：android, eclipse, apk

我在 Eclipse 上有一个 phonegap android projet，我想知道如何从 android apk 打包中排除一个文件夹？我有一个名为 source 的文件夹，其中包含少 css 和其他来源，我不希望它被打包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:43:57.533

您是否尝试右键单击该文件夹并单击“从构建中排除”选项？

# wpf - 如何将多个侧面图像应用于 WPF 3D 模型？

> ID：14084069
> 
> 赞同：0
> 
> 时间：2012-12-29T17:19:02.623
> 
> 标签：wpf, 3d

我已经有一个行星的 3D 模型和 4 张行星正面（0 度）、左侧（270）、右侧（90）和背面（180）的图片。有没有已知的方法可以将这 4 张照片应用于 3D 模型的纹理？

我考虑将这些图片组合成一个全景视图，然后将其应用到模型中。但这可能是矫枉过正。也许有一种方法可以将 2D 纹理应用于 3D 模型的 2D 视图，如所见即所得。任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:40:40.517

您最好的选择是将图像组合成一个矩形投影，然后使用球面映射将其映射到球体。

假设您的图像是圆形的，第一步是从中创建方形图像。墨卡托投影可能效果最好。

# opengl - OpenGL 旋转和平移正确完成

> ID：14084071
> 
> 赞同：5
> 
> 时间：2012-12-29T17:19:19.340
> 
> 标签：opengl, vertex-shader

当谈到 OpenGL 中的旋转和平移时，我有点卡住了。

我得到了 3 个矩阵、投影、视图和模型。

我的顶点着色器：

```
gl_Position =  projection * model * view * vec4(vertexData, 1); 
```

平移和旋转对象的最佳方法是什么？

将我的模型矩阵与平移和/或旋转矩阵相乘，或者将数据（旋转和平移）传递给着色器和那里的数学？

我还需要知道我的鼠标选择实现的“最终对象位置”。

到目前为止，我所做的是这样的：

```
object.Transformation = Matrix.CreateTransLation(x,y,z) * Matrix.CreateRotation(x,y,z); 
```

...

```
ForEach object to Draw
{
    modelMatrix.Push();

    modelMatrix.Mult(object.Transformation); // this also updates the matrix for the shader

    object.Draw();

    modelMatrix.Pop();
} 
```

这行得通，但感觉不对。最好的方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-29T17:40:25.870

这

> ```
> gl_Position =  projection * model * view * vec4(vertexData, 1); 
> ```

是错的。矩阵乘法不可交换，即运算顺序很重要。顶点位置上的变换，按顺序是：

*   模型
*   看法
*   投影

OpenGL 使用的列向量的矩阵乘法是左结合的，即从右到左。因此，语句 R 侧的表达式应该是

> ```
> gl_Position =  projection * view * model * vec4(vertexPosition, 1); 
> ```

但是，您可以将视图和模型转换收缩为复合模型视图（第一个模型，然后是视图）转换。这节省了一个完整的矩阵乘法

> ```
> gl_Position =  projection * modelview * vec4(vertexPosition, 1); 
> ```

投影应保持独立，因为其他着色步骤可能需要顶点的眼睛空间位置，这是`modelview * position`未应用投影的结果。

顺便说一句：您正在转换顶点位置，而不是数据。顶点包含大量属性（不仅仅是位置），因此称其为“数据”在语义上是错误的。

> 平移和旋转对象的最佳方法是什么？

这些是模型视图转换的一部分。*您应该在 CPU 上只创建一次*转换矩阵并将其传递给 GPU。在着色器中执行此操作将强制 GPU 为每个顶点重做整个计算。你不想这样做。

### 因评论而更新

假设您正在使用我的[→linmath.h](http://github.com/datenwolf/linmath.h)。然后在你的绘图功能中，你已经为你的场景设置了脚手架，即设置视口、构建的投影和视图矩阵

```
#include <linmath.h>

/* ... */

void display(void)
{
     mat4x4 projection;
     mat4x4 view;

     glClear(…),
     glViewport(…);

     mat4x4_frustum(projection, …);

     // linmath.h doesn't have a look_at function... yet
     // I'll add it soon
     mat4x4_look_at(view, …); 
```

然后对于每个对象，您都有一个位置和方向（平移和旋转）。方向最方便地存储在四元数中，但对于处理向量，矩阵表示效果更好。所以我们迭代场景中的对象

```
 for(int i_object = 0; i_object < scene->n_objects; i++) {
         Object * const obj = scene->objects + i;

         mat4x4 translation, orientation, model_view;

         mat4x4_translate(translation, obj->pos.x, obj->pos.y, obj->pos.z);
         mat4x4_from_quat(orientation, obj->orientation);
         mat4x4_mul(model_view, translation, orientation); 
```

`model_view`现在包含模型矩阵。接下来我们将`view`矩阵相乘。请记住，矩阵乘法是从右到左的（mat4x4_mul 可以输出到其输入操作数之一）。

```
 mat4x4_mul(model_view, view, model_view); 
```

现在`model_view`包含完整的复合模型方向和平移和视图矩阵。我们现在需要做的就是绑定用于对象的着色器程序

```
 glUseProgram(obj->shader->program); 
```

设置制服

```
 glUniformMatrix4f(obj->shader->location.projection, 1, GL_FALSE, projection);
         glUniformMatrix4f(obj->shader->location.modelview,  1, GL_FALSE, model_view);
         // and a few others... 
```

并绘制对象

```
 object_draw(obj);
    }

/* ... */

} 
```

# c++ - 如何确定 Seg 故障？

> ID：14084075
> 
> 赞同：1
> 
> 时间：2012-12-29T17:19:42.450
> 
> 标签：c++, graph, segmentation-fault

我有一个有趣的分段错误。它发生在我的代码中的一个未知位置。代码相当简单，两个对象和一个通用函数。该函数应该创建对象图。当我只使用 main 调用该函数来运行代码时，我在 GDB 中得到一个段错误和以下代码行。

> 程序收到信号 SIGSEGV，分段错误。来自/lib/x86_64-linux-gnu/libc.so.6的free()中的0x00007ffff758a02c

当我在函数调用之前的主要内容中添加一行时，它就是 cout << "Check"; 我仍然遇到分段错误，但检查没有出现在输出中。在这里真的迷路了。接下来我应该尝试什么？

编辑：

感谢您对使用冲洗的帮助。我在代码中找到了导致段错误的区域。我正在使用的功能对我来说是新的，所以我还是有点迷茫。有人看到错误吗？

```
const char* inFile = inFileP.c_str();
list<CContinent> world;
CCountry *homeCountry = new CCountry;
CCountry *neighborCountry = new  CCountry;

fstream filestr; 
filestr.open(inFile, fstream::in | fstream::out | fstream::app);
string line; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:22:43.880

从痛苦的经验来看，当 malloc 或 free 发生崩溃时，这是因为堆损坏。任何常见的嫌疑人都可能导致堆损坏 - 分配 10 个字节，写入 11 个 - 空闲，然后写入空闲内存，双重释放，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:53:31.713

Valgrind 是调试程序的有用工具。在第一个视图中，我没有看到世界变量的初始化。

# java - Java 中的同步：StringBuffer vs StringBuilder 和 Vector vs ArrayList

> ID：14084079
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:19:55.717
> 
> 标签：java, synchronization

这是一个被问过很多次的问题，但并非总是如此，Java 初学者（像我一样）可以深入理解给出的答案。

我一直在阅读一些 Java 书籍，在其中一本中我读到 Vector 和 ArrayList 之间的区别在于前者是同步的，而后者不是（与 StringBuffer 与 StringBuilder 相同）。

这本书解释了«如果我们需要它，我们可以将同步“添加”到未同步的代码中»。

在[这篇](https://stackoverflow.com/questions/8132313/stringbuilder-vs-stringbuffer-or-vector-vs-arraylist)文章中，Brian Roach 解释了 « *StringBuffer 和 Vector 的线程同步会增加开销（除非您需要它，但即便如此，也有办法将其添加到较新的类中）* »。

所以，我有三个问题：

1）如果同步增加了开销，但如果我们需要它可以添加到更新的类，为什么不使用 StringBuffer 和 Vector 而不是向 StringBuilder 和 ArrayList 添加同步？

2）我们如何向类添加同步？

3）同步的目的是什么？

对不起我的新手问题（我知道我必须阅读更多的书），但这些概念不是很容易掌握。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:26:15.057

同步有与之相关的开销，并且会不必要地降低性能。考虑以下代码片段：

```
synchronized(this) {
   doSomething();
} 
```

每当一个线程进入一个同步块时，它必须获得一个锁。当它离开块时，它放弃了锁。这就是防止多个线程同时进入代码块的原因。

如果代码不需要同步（因为一次只能由一个线程访问），那么您可以将代码编写为

```
doSomething(); 
```

总而言之 - 您通常不应该使用同步版本，除非您需要它，因为它会增加开销。但是您始终可以使用同步块（和/或锁）添加同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:56:21.017

> 1）如果同步增加了开销，但如果我们需要它可以添加到更新的类，为什么不使用 StringBuffer 和 Vector 而不是向 StringBuilder 和 ArrayList 添加同步？

恕我直言，从来没有一个很好的理由来拥有一个同步的 StringBuffer。我认为这样做只是为了与其他系列保持一致。现在使用它的唯一原因是当你有一个坚持使用它的 API 时。

Vector 更有用，虽然您可以使用 Collection.synchronizedList() 一些 API 需要它。从 Java 5.0 开始，一些并发集合是更好的选择。

> 2）我们如何向类添加同步？

将`synchronized`关键字添加到所有方法（还有更多，但在最简单的情况下，这就是所有需要的）您还可以创建一个同步包装，如 synchronizedList

> 3）同步的目的是什么？

线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:24:38.350

1）因为`Vector`之前引入了java API `ArrayList`。几乎没有充分的理由再使用`Vector`了。`StringBuffer`对于vs也是如此。`StringBuilder`

2）如果需要同步，可以同步访问/修改实例所在的方法（或块）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:27:07.400

**兼容性**。他们不想*改变*已经存在的课程。所以他们添加了一个不会自动同步的变体。您可以`ArrayList`通过将其包装`List<String> list = Collections.synchronizedList(new ArrayList<String>());`到同步列表中来进行同步。

[同步](https://en.wikipedia.org/wiki/Synchronization_%28computer_science%29)在 Wikipedia 中有解释。从那里开始阅读。

简单的同步 ArrayList 示例：

```
 // Class definition
 ArrayList<String> foo;

 void doSomething() {
     synchronized(foo) {
         foo.add("Foobar");
     }
 } 
```

该方法`doSomething`是线程安全的。

# c# - 如何在 C# 中生成时间和日期并为 mysql 格式化？

> ID：14084086
> 
> 赞同：3
> 
> 时间：2012-12-29T17:20:50.893
> 
> 标签：c#, mysql, datetime

我想知道如何在 C# 中生成时间和日期，然后将该值格式化为 Mysql。

Mysql 支持这种格式：`0000-00-00 00:00:00`.

更多信息 - 我正在从 mysql 导入日期时间，并将其作为文本保存在 sqlite 中我想在事件发生时更新 sqlite 中的日期时间，然后我将数据同步回 mysql。

在数据时间的 sqlite 中运行查询的最佳格式是什么？

我想保持相同的格式：`0000-00-00 00:00:00`.

是否需要将其转换为 C# 或 Sqlite 数据库的其他本机数据，然后在同步时转换回 mysql 数据？

只是寻找最好的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:28:57.617

对于第一个问题，您可以使用

```
DateTime time = DateTime.Now;              
    string format = "yyyy-MM-dd HH:mm:ss";   
    var mytime = time.ToString(format); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:54:55.540

如果您想捕获 AM/PM，请尝试使用一行代码执行类似操作

```
string timString = DateTime.Now.ToString("dd.MM.yyyy hh:mm:ss tt"); 
```

> 输出“2012-12-29 11:52:54 AM”

如果您想省略 AM/PM，请执行以下操作

```
string timString = DateTime.Now.ToString("dd.MM.yyyy hh:mm:ss"); 
```

> 输出“2012-12-29 11:52:54”

# tesseract - Tesseract 配置是什么意思？

> ID：14084088
> 
> 赞同：1
> 
> 时间：2012-12-29T17:20:52.983
> 
> 标签：tesseract

我对 Tesseract 有以下问题：

1* 什么是 tesseract 配置？

2* 如果 traindata 可用于语言（例如：arabic），这是否意味着它可以 OCR 语言的任何字体？或者只是 traindata 中指定的字体？

3* 如果我使用 tesseract 的结果很差，我该怎么办？用那种字体或什么制作新的traindata文件？

# python - Python 编码真的减慢了我的应用程序

> ID：14084091
> 
> 赞同：0
> 
> 时间：2012-12-29T17:21:10.223
> 
> 标签：python, encoding, runtime

我正在研究一个非常数据密集型算法，速度是我的首要任务。本质上，它涉及处理非常大的字符串。无需过多详细说明，无需这些代码行，它就可以在眨眼之间工作：

```
html = unicode(strip_tags(html_source), errors='ignore')
html2 = unicode(strip_tags(html_source2), errors='ignore') 
```

如果我不将每个字符串编码为 un​​icode，就会出现以下问题：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 5747: ordinal not in range(128) 
```

我能做些什么来简化这个过程吗？不在 ascii 范围内的少量数据对我来说并不重要。无论如何我可以在不编码整个字符串的情况下忽略所有错误吗？

非常感谢你！（我目前使用的是python2.7.3）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:28:34.777

您可以使用以下命令去除所有非 ASCII 字符`.decode()`：

```
your_string.decode('ascii', errors='ignore') 
```

# java - Java 游戏，背景的矩形正在移动

> ID：14084094
> 
> 赞同：2
> 
> 时间：2012-12-29T17:21:29.767
> 
> 标签：java, awt, java-2d, coordinate-systems, rectangles

我希望标题没有让这篇文章比现在更混乱。如果我确切地告诉你我到目前为止所做的事情，我遇到的问题可能会得到更好的解释：

**游戏**

我做了一个非常简单的 2D 游戏，基本原理是，玩家使用键盘输入（上、下、左、右箭头）在 2D 地图上移动，这个游戏有点像口袋妖怪视图，视图是从顶部看的，只需对每个键盘输入使用以下代码即可设置他的速度：

```
 if(input.isKeyDown(Input.KEY_DOWN)){
    bucky = movingDown;
    buckyPositionY -= 2;
    if(buckyPositionY<-550){//this is used to stop player from leaving the map
        buckyPositionY += 2;}} 
```

其他 3 个键盘输入也是如此。

**问题**

我已经制作了玩家可以四处移动的游戏，但问题是我在地图上有物体，而我的玩家只是穿过它们，所以我需要设置碰撞，我知道如何使用矩形设置碰撞方法，但问题实际上是制作矩形。我知道这是一项简单的任务，但是在这个游戏中，每当我将 Rectangle 向下放置时，它就会在我移动我的播放器时移动，我通过使用以下代码绘制矩形来测试这一点：

```
g.fillRect(0,0,100,100); 
```

那是我地图上障碍物的坐标，当我绘制矩形时，它出现在屏幕的左上角，当我移动播放器时，它会停留在那里（它会一直移动以停留在左上角），现在是对我来说是个大问题，因为如果我的矩形在移动，我的碰撞应该如何工作。我认为发生这种情况的原因是因为我的地图非常大，这意味着我没有显示完整的东西，而是将我的玩家放在屏幕的中心，当他移动屏幕时，屏幕也会随着他移动以显示其余部分地图。

**编码**

这是我的游戏类中的代码，其中包含渲染、初始化和更新等方法，但我认为解决此问题所需的唯一代码是渲染方法和变量，所以它们在这里（如果需要完整代码请告诉我）

*变量*

```
 Animation bucky, movingUp, movingDown, movingLeft, movingRight
Image worldMap;
boolean quit = false;
int[] duration = {200, 200};
int buckyPositionX = 0;
int buckyPositionY = 0;
int shiftX = buckyPositionX + 320;
int shiftY = buckyPositionY + 160; 
```

*渲染方法*

```
public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException{
worldMap.draw(buckyPositionX, buckyPositionY);//position 0,0
bucky.draw(shiftX, shiftY);//makes him appear at center of map

if(quit==true){
    g.drawString("Resume(R)", 250, 100);
    g.drawString("Main(M)", 250, 150);
    g.drawString("Quit Game(Q)", 250, 200);      
    if(quit==false){
        g.clear();
    }}} 
```

很抱歉这个帖子太长了，如果您能花时间帮助我并回答我的问题，我将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:08:13.777

Java 的二维绘图方法相对于屏幕绘制，而不是相对于地图。

[http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Graphics.html#fillRect](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Graphics.html#fillRect)

如果要相对于地图位置进行绘制，则需要根据玩家在地图上的位置偏移矩形的位置。由于您的角色动画始终位于屏幕的中心，因此您需要根据 Bucky 在地图上的位置偏移任何其他动画。所以你的矩形图需要看起来像：

```
g.fillRect(0 + buckyPositionX, 0 + buckyPositionY, 100, 100); 
```

更好的解决方案是在地图上跟踪相机位置，然后绘制与相机相关的所有内容，包括您的角色。这使您可以自由地在游戏过场动画等中进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:50:35.313

正如我所说，矩形（障碍物）正在移动，因为绘图坐标是相对于屏幕定义的，而不是游戏地图。那就是当角色移动并且您重新绘制游戏地图时，矩形仍然绘制在 (0,0) 处，即屏幕的左上角。

这里有一些建议。

*   `Image`为游戏地图使用单独的屏幕外。图像大小将与游戏地图的大小相同。
*   通过使用获取此图像的图形上下文，应在此图像上绘制矩形（障碍物）和不包括字符的其他内容`getGraphics`
*   `drawImage(Image img, int dstx1, int dsty1, int dstx2, int dsty2, int srcx1, int srcy1, int srcx2, int srcy2, ImageObserver observer)`最后，当角色移动时，您使用方法在屏幕上绘制图像的一部分。此方法的说明可[在此处](http://docs.oracle.com/javase/tutorial/2d/images/drawimage.html)获得。您必须从角色的位置计算要绘制图像的哪个部分

要记住的一点是角色只能在屏幕上绘制，而不是在游戏地图上`Image`。绘制游戏地图图像后，应在屏幕上绘制角色。

# android - 从源代码构建android，make vs make sdk

> ID：14084102
> 
> 赞同：1
> 
> 时间：2012-12-29T17:22:33.483
> 
> 标签：android, android-source

我正在从源代码构建 Android。

`make`和有什么区别`make sdk`？为什么它会在此构建之间清理文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T20:31:50.863

对于 android 应用程序，通常关联两个不同的 SDK 编号。有 minSdk 和 targetSdk，两者都显示在 AndroidManifest.xml 文件中。targetSdk 是创建应用程序的 API 级别。这通常是专门测试应用程序的设备的 API 级别。另一方面，minSdk 就是您的应用程序可以安全运行的最低 API 级别。如果您将 minSdk 设置为 8，但使用 Fragments 等类，则任何运行 API 8、9 或 10 的设备都会发生错误，因为直到 API 11 (3.0 Honeycomb) 才引入 Fragments。该应用程序也不能安装在任何 API 低于指定 minSdk 的设备上。

# android - 在 webview 上的网站上设置文本框的内容？

> ID：14084103
> 
> 赞同：0
> 
> 时间：2012-12-29T17:22:40.287
> 
> 标签：android, android-webview

我正在制作一个使用 webview 显示网站的应用程序。

我还设置了一个意图过滤器来接收文本内容。收到该内容后，我想将其放在一个文本框中，该文本框将显示在 webview 中的网页上。

这可能吗，如果可以，我该怎么做？

# java - ConcurrentHashMap returns a weakly consistent iterator, why should we use it anyhow?

> ID：14084104
> 
> 赞同：10
> 
> 时间：2012-12-29T17:22:48.977
> 
> 标签：java, concurrency, concurrent-programming, concurrenthashmap

I am reading the book Java Concurrecny in practice. On page 85 section 5.2.1 it talks about the ConcurrentHashMap and its advantages. However, in one part, the books claims that

> the iterators returned by ConcurrentHashMap is weakly consistent. This means that this iterator can tolerate concurrent modification, traverses elements as they existed when iterator was constructed, and may (but not guaranteed to) reflect modifications to the collection after the construction of the iterator.

From why I understand the whole point of synchronization in concurrent programs is to allow thread accessing a shared resource in a consistent way, where as ConcurrentHashMap is not really fulfilling this. Then why using it at all?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-29T17:25:00.927

The point is to *avoid* synchronization when you don't need it. If you don't mind seeing new elements in some cases and not seeing them in others, using `ConcurrentHashMap`'s iterator can be significantly cheaper than *either* preventing other threads from adding items while you're iterating *or* taking a consistent snapshot when the iterator is created.

So yes, when you need synchronization and a consistent iterator, you'll need an alternative - but when you don't, you can take advantage of the more efficient iterator provided by `ConcurrentHashMap`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:28:06.007

`ConcurrentHashMap` is supposed to be thread-safe, by contract. However, it is not supposed to be *consistent across threads*.

When you iterate over a `ConcurrentHashMap`, the iterator grabs a copy of the hash map at the moment you asked for it (and *this* copy is made in a thread-safe manner) and you iterate over that copy. And yes, nothing guarantees you that *while you are iterating over that copy*, some map entries won't be removed. But the map entries which would be removed in such a manner *woud still exist in your iterator*.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T17:30:14.877

Everything depends on how strong consistency you need. If you need strong one - than mutexes or other subset of operations would provide what you need.

However sometimes you need much weaker requirements but for example you **need** say lock-free property as you need to guarantee the throughput. On the other hand you may not need iterators at all or have much weaker restrictions on them.

So if all you need is map shared across threads `ConcurrentHashMap` (say place in theatre to person booking it) would provide what you need - and it may be much faster if you have many working threads as you avoid mutex synchronization. On the other hand the speed comes at a cost - the view provided by iterator does not necessary corresponds to state of collection at it's creation and it might miss some elements created afterwords (in general in multiprocessor systems `happens-before` relationship is tricky).

**Edit**: As Prince John Wesley pointed out I thought about `ConcurrentSkipListMap` while seeing and writing. `ConcurrentHashMap`. Most of the points still stand except the parts about being lock-free (as well as everything that comes from it like guaranteed throughput etc.).

# c++ - C++ OpenCV cvMAT 回放

> ID：14084109
> 
> 赞同：0
> 
> 时间：2012-12-29T17:23:05.620
> 
> 标签：c++, opencv

我有一个 cvMat 类型的向量，我一直在其中存储从计算机网络摄像头获取的帧。存储 100 帧后，我想回放这些帧。如果记录是我的 cvMats 向量，我认为可以这样做：

```
cvNamedWindow("play-back",CV_WINDOW_AUTOSIZE);
cvMoveWindow("play-back",100,100);
for (vector<Mat>::iterator iter = record.begin(); iter != record.end();++iter) {
   imshow("play-back",*iter);
} 
```

执行时，该程序似乎可以很好地存储 cvMat 并从网络摄像头获取输入，但是当我尝试播放时，该程序似乎非常快速地执行那部分代码——事实上，如此之快，以至于我没有时间欣赏结果。我怎样才能改进这段代码，使播放不那么匆忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:29:59.180

您需要控制 OpenCV 以实际渲染窗口中的每个图像，并在切换到下一个之前将其保持一小段时间。您应该添加对[cvWaitKey](https://stackoverflow.com/questions/5217519/opencv-cvwaitkey)的调用， 延迟时间为 41 毫秒（大约 24 fps）。然后您可以检查 cvWaitKey 的返回值，以便用户可以停止播放。像这样的东西：

```
cvNamedWindow("play-back",CV_WINDOW_AUTOSIZE);
cvMoveWindow("play-back",100,100);
for (vector<Mat>::iterator iter = record.begin(); iter != record.end();++iter) {
   imshow("play-back",*iter);
   if( cvWaitKey(41) == 27 ) // ESC
       break;
} 
```

# android - stackoverflowerror 和清单属性 android:launchmode

> ID：14084116
> 
> 赞同：0
> 
> 时间：2012-12-29T17:23:40.487
> 
> 标签：android, xml, stack-overflow

好的，我已经创建了一个程序，但是当我开始运行它时，我以前没有任何问题。现在我在运行它时得到stackoverflowerror。问题出现在我的选项卡活动中。在我的一个选项卡中，您可以在其中打开活动。仅当我在该选项卡内导航时才会产生该错误。

请你看看我的代码，让我知道我做错了什么。

这是我的清单活动声明的示例：

```
<activity
        android:name=".EarlyStrat"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:label="info2"
        android:noHistory="true"
        android:launchMode="singleInstance"
        android:theme="@android:style/Theme.Dialog" >
    </activity> 
```

这是似乎导致错误的 xml 文件之一的声明：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#000000"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/arrowyes"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#000000"
    android:orientation="horizontal" >

    <ImageView
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:layout_gravity="center"
        android:background="@drawable/backarrow" />

    <TextView
        android:id="@+id/returns"
        android:layout_width="200dp"
        android:layout_height="40dp"
        android:layout_gravity="center"
        android:background="@drawable/newsbutton"
        android:gravity="center"
        android:text="click here to RETURN"
        android:textColor="#FFFFFF"
        android:textSize="15dp" />
</LinearLayout>

<TextView
    android:layout_width="fill_parent"
    android:layout_height="40dp"
    android:layout_gravity="center"
    android:gravity="center"
    android:padding="5dp"
    android:text="Early Strategy"
    android:textColor="#FFFFFF"
    android:textSize="25dp" />

<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/onebgr"
    android:fadeScrollbars="false"
    android:fillViewport="true"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/title1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" > (there is more code after this and it is nested as well)... 
```

xml代码继续......

有什么建议和/或你能指出我在哪里可以找到这些信息吗？

# ruby-on-rails - 使用 JBuilder 在 Rails 中创建嵌套的 JSON 输出

> ID：14084117
> 
> 赞同：7
> 
> 时间：2012-12-29T17:23:42.763
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jbuilder

我正在寻找有关如何使用 JBuilder 创建嵌套 JSON 输出的示例。

我想创建和输出类似于：

```
{
    "name": "John Doe", 
    "reservations": [
        {
            "restaurant": "ABC",
            "reservation_time": "2012/12/01 20:00", 
            "details": {
                "address": "somewhere", 
                "rating": "5"
            }
        }, 
        {
            "restaurant": "CDE",
            "reservation_time": "2012/12/04 20:00", 
            "details": {
                "address": "somewhere else", 
                "rating": "3"
            }
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T18:17:58.127

解决了：

```
json.name user.name

json.array!(@reservations) do |json, reservation|
    json.restaurant reservation.restaurant.name
    json.reservation_time reservation.time

    json.details do 
        json.address reservation.restaurant.address 
        json.rating reservation.restaurant.rating 
    end
end 
```

# html - 如何使用本地存储清除文本区域字段

> ID：14084118
> 
> 赞同：1
> 
> 时间：2012-12-29T17:23:44.560
> 
> 标签：html, local-storage

我想使用以下方法清除我的 textarea 字段。这是我的代码：

```
<form  id="localStorageTest" action="" method="post">
<textarea cols="100000" rows="100000" style="height: 150px; width: 200px;" readonly="readonly" name="hhhh" id="txt1"></textarea>
<textarea cols="1000" rows="100000" style="height: 20px; width: 190px;" name="txtarea" id="txt3" class="stored"></textarea>
<input type="button" name="button" onclick="insertdata(txtarea.value)" value="send"/>
    </form> 
```

我想清除 id txt3 的字段。我已经这样做了如下..

```
 $('#txt3').button(function() {
    localStorage.clear();
}) 
```

但它不起作用。我的代码在哪里或有什么问题。请任何人帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:31:57.223

您的代码将导致错误。不知道你想做什么？单击按钮应清除文本区域。那么为什么要使用 onclick 属性呢？

您应该为您的按钮分配一个 id。选择它更容易

我假设您使用的是 jquery，所以：

**HTML：**

```
<input id="myButton" type="button" name="button" ...> 
```

**JS：**

```
$('#myButton').on('click', function() {
    $('#txt3').value = '';
}); 
```

# linq - 我有一个 linq List Select 问题

> ID：14084121
> 
> 赞同：0
> 
> 时间：2012-12-29T17:24:01.803
> 
> 标签：linq, select

如果您有一个集合/List<> 对象，您如何从该集合/List<> 中选择不同的记录？

例如，我正在执行以下操作，但两者的计数相同：

```
 var list = List<Order>;
 list.add( new Order { Status = "Completed" });
 list.add( new Order { Status = "Completed" });
 list.add( new Order { Status = "Completed" });
 list.add( new Order { Status = "Processing" });

 var = completed = list.Select(x => x.Status == "Completed").Count();
 var = Processing = list.Select(x => x.Status == "Processing").Count(); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:29:54.067

好吧，有两个问题和一个简化：

*   你的变量声明不应该有一个`=`between`var`和变量名
*   对于过滤，您应该使用`Where`而不是`Count`
*   `Count`首先使用谓词的重载会更简单......

所以：

```
var completed = list.Count(x => x.Status == "Completed");
var processing = list.Count(x => x.Status == "Processing"); 
```

或者，您可以创建一个“按状态计数”的字典：

```
var counts = list.GroupBy(x => x.Status)
                 .ToDictionary(g => g.Key, g => g.Count());
var completed = counts["Completed"];
var processing = counts["Processing"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:30:09.040

您将获得相同的计数，因为您正在创建由`true`和`false`值组成的结果，但是当您计算它们时，它们仍然与集合中的项目一样多。

您应该使用`Where`instead of `Select`，或者干脆将条件放在`Count`instead 中：

```
int completed = list.Count(x => x.Status == "Completed");
int processing = list.Count(x => x.Status == "Processing"); 
```

# php - 在“底部”的 CakePHP 布局中加载 Javascript 文件

> ID：14084123
> 
> 赞同：11
> 
> 时间：2012-12-29T17:24:21.610
> 
> 标签：php, cakephp, cakephp-2.2

目前，我有一个带有布局和很多视图的大型 CakePHP 应用程序。在布局中，我在头部加载大多数视图所需的 Javascript 文件。在视图本身中，我要么加载额外的 Javascript 文件（例如，加载仅在那里需要的库文件），要么在脚本标记中添加一些仅与此视图相关的 Javascript 代码，例如，如果我需要单击处理程序。

由于在 HTML head 中加载 Javascript 文件会阻止加载页面是一个众所周知的事实，因此我想在关闭 body 标签之前将它们放在底部。但如果我这样做，我的视图中加载内容的 Javascript 会中断，因为它不知道我加载的 Javascript 文件。我了解加载视图中的 Javascript 代码是在我的文件加载之前执行的。但是我该如何防止呢？

我目前在布局（以及其他任何地方）中使用 HTML Helper 来加载我的 JS 文件，如下所示：

```
<?php echo $this->Html->script('//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'); ?> 
```

我使用 JS Helper 在页面末尾“输出” JS

```
<?php echo $this->Js->writeBuffer(); ?> 
```

有没有办法可以在视图中附加我的 JS 代码，以便在我调用 writeBuffer 时执行它？那能帮我吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-01T00:09:28.583

从 CakePHP 2.1 版开始，您可以使用脚本块：

```
// in your view
$this->Html->script('filename', array('block' => 'scriptBottom'));

// in your layout
echo $this->fetch('scriptBottom'); 
```

这种方法使您可以保留布局，以防您在顶部需要任何脚本`echo $this->fetch('script')`。`<head>`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-29T19:00:46.427

在我看来，这就是我所做的：

```
echo $this->Html->script('filename', array('inline' => false)); 
```

这就是我在布局底部所做的：

```
echo $this->fetch('script'); 
```

# ios - 如何在 Xcode 中使用网络安全颜色

> ID：14084130
> 
> 赞同：1
> 
> 时间：2012-12-29T17:24:52.920
> 
> 标签：ios, xcode, colors

我已经搜索了谷歌，但我找不到任何关于在 xcode 中应用纯网络安全颜色的内容。我找到了一个正是我需要的，但由于某种原因，xcode 不断拒绝它，并出现错误“预期表达式”。我不知道我缺少什么表情。添加颜色不应该像这样简单：

```
[self.label setBackgroundColor:#FF0033]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:30:24.660

我应该那么简单，但是 setBackgroundColor 需要一个 UIColor 对象，而不是像你提供的 RGB ......

您可以使用它来修复它：

```
#define HEXCOLOR(c) [UIColor colorWithRed:((c>>24)&0xFF)/255.0 
 green:((c>>16)&0xFF)/255.0 
 blue:((c>>8)&0xFF)/255.0 
 alpha:((c)&0xFF)/255.0];

// usage:
UIColor* c = HEXCOLOR(0xFF0033FF); 
```

如果您不需要 Alpha，您可以将其设置为 1 并调整位移。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T14:24:19.417

我发现这是我需要的：

```
 [self.label setTextColor:[UIColor colorWithRed:66/255.0
                                     green:33/255.0
                                      blue:33/255.0
                                     alpha:1.0]]; 
```

# javascript - 如何从 Three.js 中的父对象访问子对象？

> ID：14084131
> 
> 赞同：2
> 
> 时间：2012-12-29T17:24:54.437
> 
> 标签：javascript, 3d, webgl, three.js

我使用网格来添加对象，然后我将网格添加到场景中。现在我想从网格中访问对象，以便我可以在相应的网格中执行旋转对象及其子对象。

示例代码，但建议查找 jsfiddle 链接以获取详细知识：http: [//jsfiddle.net/sagh0900/PrVbg/3/](http://jsfiddle.net/sagh0900/PrVbg/3/)

```
mesh = new THREE.Mesh(new THREE.Geometry());
scene.add(mesh);

renderer = new THREE.WebGLRenderer();

renderer.setClearColorHex(0xffffff, 1);
renderer.setSize( width, height );

for ( var i = 0; i <nSize; i++)
{
    var k = i%10,
        j = (i-k)/10;

    j = j*2 - 10;
    k = k*2 - 10;

    cone1 = lc_relationship.sensor1[i].Geometry; 
    mesh.add(cone1);
    cone2 = lc_relationship.sensor2[i].Geometry;
    mesh.add(cone2);
    cone3 = lc_relationship.sensor3[i].Geometry;
    mesh.add(cone3);
    cone1.position.set(j, k, lc_relationship.sensor1[i].z_cordinate);
    cone2.position.set(j, k, lc_relationship.sensor2[i].z_cordinate);
    cone3.position.set(j, k, lc_relationship.sensor3[i].z_cordinate);
} 
```

![在此处输入图像描述](../Images/5745bf72c20fc9a67ff26a58a1d4279c.png)

提前致谢

# php - 上传文件中的str_replace函数

> ID：14084133
> 
> 赞同：-2
> 
> 时间：2012-12-29T17:25:00.173
> 
> 标签：php

如何重命名上传的文件`str_replace function`？我想删除`space`with `_`。有什么帮助吗？我正在使用以下代码上传文件

```
$file1 = 'order_'.$orderId.'_'.$rowsOrder['image_a'];
$file2 = 'order_'.$orderId.'_'.$rowsOrder['image_b'];
$file3 = 'order_'.$orderId.'_'.$rowsOrder['image_c'];
$file4 = 'order_'.$orderId.'_'.$rowsOrder['image_d'];
$path1 = 'http://www.yourdomain.com/'.$file1;
$path2 = 'http://www.yourdomain.com/'.$file2;
$path3 = 'http://www.yourdomain.com/'.$file3;
$path4 = 'http://www.yourdomain.com/'.$file4; 
```

* * *

```
 <tr>";
               if($rowsOrder['image_a'] !=''){
                $message.="<td align='left' style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000;'><a href='http://www.yourdomain.com/files/".$file1."' style='font-family:Times New Roman, Times, serif; font-size:12px; color: #000000; font-weight: normal;' title='http://www.yourdomain.com/'>File1</a></td>";}
                if($rowsOrder['image_b'] !=''){

               $message.= "<td align='left' style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000;'><a href='http://www.yourdomain.com/files/".$file2."' style='font-family:Times New Roman, Times, serif; font-size:12px; color: #000000; font-weight: normal;' title='http://www.yourdomain.com/'>File2</a> </td>";}

             $message.=  "</tr><tr>";

            if($rowsOrder['image_c'] !=''){
                $message.= "<td align='left' style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000;'><a href='http://www.yourdomain.com/files/".$file3."' style='font-family:Times New Roman, Times, serif; font-size:12px; color: #000000; font-weight: normal;' title='http://www.yourdomain.com/'>File3</a></td>";}
                if($rowsOrder['image_d'] !=''){
               $message.= "<td align='left' style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000;'><a href='http://www.yourdomain.com/files/".$file4."' style='font-family:Times New Roman, Times, serif; font-size:12px; color: #000000; font-weight: normal;' title='http://www.yourdomain.com/'>File4</a> </td>";}
               $message.= "</tr><tr>
                        <td colspan='2' align='left' style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000;font-weight: bolder;'><br><br>Thanks,<br><br>
                          <span style='font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000000; font-weight: normal;'><a href='http://www.yourdomain.com/' style='font-family:Times New Roman, Times, serif; font-size:12px; color: #000000; font-weight: normal;' title='http://www.yourdomain.com/'>yourdomain</a></span></td></tr> 
```

* * *

```
$order_image_a='order_'.$orderId.'_'.$filea;
if(!empty($filea)) move_uploaded_file($_FILES['FILE1']['tmp_name'], "../files/$order_image_a");

$order_image_b='order_'.$orderId.'_'.$fileb;
if(!empty($fileb)) move_uploaded_file($_FILES['FILE2']['tmp_name'], "../files/$order_image_b");

$order_image_c='order_'.$orderId.'_'.$filec;
if(!empty($filec)) move_uploaded_file($_FILES['FILE3']['tmp_name'], "../files/$order_image_c");

$order_image_d='order_'.$orderId.'_'.$filed;
if(!empty($filed)) move_uploaded_file($_FILES['FILE4']['tmp_name'], "../files/$order_image_d"); 
```

如果我要上传图片或任何名称中有空格的文件，则应使用 _ 代替 gap 上传（例如 -`you files.doc`应由 上传`you_files.doc`）。可能的 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:51:03.737

```
function convertSpecialChars($str) {
    $str = str_replace( " ", "_", $str );
    return $str;
}

$filea = $this->convertSpecialChars($filea);

$order_image_a='order_'.$orderId.'_'.$filea;
if(!empty($filea)) move_uploaded_file($_FILES['FILE1']['tmp_name'], "../files/$order_image_a"); 
```

# html - 如何做一个 CSS 表格

> ID：14084137
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:25:16.963
> 
> 标签：html, css, seo

我想知道如何用 DIVS 做一个 css 表，并用不同的颜色使行偶数/奇数。如果超过一行的空间，数据列必须是静态的或与内容一起使用。

这些行由从数据库中获取数据的 php 中的 for 自动生成。HTML 表格不适合，因为它对 SEO 不友好。该表中的数据非常重要，我希望它能够很好地被索引。

我还想知道当页面显示为那些 javascript 警报时如何使用验证码弹出窗口，以及这种做法是否有利于 SEO 和索引内容

谢谢

图片的表格代码 [http://i46.tinypic.com/et8vuv.jpg](http://i46.tinypic.com/et8vuv.jpg)

```
 if (count($results1))
 {   echo "CURSURI:";
      echo "<div id='curs'><ul>";
  echo "<li><ui>Nume</ui><ui> Uploader</ui><ui>Tip</ui><ui>Data</ui> </li>";
foreach($results1 as $x) {
 echo "<li><ui>". $i++.". <a href='".$x->link."'>". $x->name. "</a></ui>       <ui>".$x->user."</ui><ui>".$x->ext."</ui><ui>".$x->date."</ui> </li>";}
echo "</ul></div>";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:35:01.120

表格是一个 html 结构，而不是 CSS。您可以使用 CSS 使显示看起来像一个表格，但是如果您希望它看起来像一个表格，那么它很可能是表格数据，因此，出于可访问性和可用性的原因，您最好使用实际的 HTML 表格.

我不确定你为什么认为一张桌子对 SEO 不友好。

# delphi - delphi立方体旋转

> ID：14084143
> 
> 赞同：2
> 
> 时间：2012-12-29T17:25:37.063
> 
> 标签：delphi, 3d, rotation, cube

我想在我的屏幕上围绕它的轴旋转一个立方体。

我在使用 3D 旋转矩阵的 javascript 中找到了这个示例。我试图在我的应用程序中制作类似的东西，但立方体不想旋转，我不知道问题出在哪里。

立方体在不同的位置移动（比如从一个完美的角度观察），但直到那个视图它才显示运动。这有点像从顶部、底部、正面和侧面的视图。

这是我的代码：

```
dimension: Integer = 1;
a: Integer = 0;
b: Integer = 0;
ite: Integer = 27;
ite1: Integer;
ite2: Integer;
ite3: Integer;
x: Integer;
y: Integer;
z: Integer;
u: Integer = 0;
v: Integer = 0;
w: Integer = 0;
u2: Integer = 0;
v2: Integer = 0;
w2: Integer = 0;
c: Integer = 0;
pts: TpointArray;

ite := 0;
a := round(Mouse.CursorPos.X/99);
b := round(Mouse.CursorPos.Y/99);
for x := -dimension to dimension do
begin
  for y := -dimension to dimension do
  begin
    for z := -dimension to dimension do
    begin
      u := x;
      v := y;
      w := z;
      u2 := round(u*cos(a)-v*sin(a));
      v2 := round(u*sin(a)+v*cos(a));
      w2 := w;
      u := u2; v := v2; w := w2;
      u2 := u;
      v2 := round(v*cos(b)-w*sin(b));
      w2 := round(v*sin(b)+w*cos(b));
      u := u2; v := v2; w := w2;
      pts[ite].X := 200+u*(w+2)*30;
      pts[ite].Y := 200+v*(w+2)*30;
      Ellipse(pts[ite].X,pts[ite].Y,pts[ite].X+10,pts[ite].Y+10);
      ite := ite + 1;
    end;
  end;
end;

for ite1 := 0 to 25 do
begin
  for ite2 := 1 to 26 do
  begin
    MoveTo(pts[ite1].X,pts[ite1].Y);
    LineTo(pts[ite2].X,pts[ite2].Y);
  end;
end; 
```

问题出在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T18:35:10.977

您正在使用整数来表示角度。cos 和 sin 函数使用浮点数（弧度）。因此，在您的情况下，旋转角度的变化幅度约为 57 度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T01:26:28.093

解决方案如下所示：

```
a: Double = 0;
b: Double = 0;
ite: Integer = 27;
ite1: Integer;
ite2: Integer;
ite3: Integer;
x: Integer;
y: Integer;
z: Integer;
u: Double = 0;
v: Double = 0;
w: Double = 0;
u2: Double = 0;
v2: Double = 0;
w2: Double = 0;
c: Integer = 0;
pts: TpointArray;

ite := 0;
      a := Mouse.CursorPos.X/99;
      b := Mouse.CursorPos.Y/99;
      for x := -dimension to dimension do
      begin
        for y := -dimension to dimension do
        begin
          for z := -dimension to dimension do
          begin
            u := x;
            v := y;
            w := z;
            u2 := u*cos(a)-v*sin(a);
            v2 := u*sin(a)+v*cos(a);
            w2 := w;
            u := u2; v := v2; w := w2;
            u2 := u;
            v2 := v*cos(b)-w*sin(b);
            w2 := v*sin(b)+w*cos(b);
            u := u2; v := v2; w := w2;
            pts[ite].X := round(200+u*(w+5)*30);
            pts[ite].Y := round(200+v*(w+5)*30);
            Ellipse(pts[ite].X,pts[ite].Y,pts[ite].X+10,pts[ite].Y+10);
            ite := ite + 1;
          end;
        end;
      end;

      for ite1 := 0 to 25 do
      begin
        for ite2 := 1 to 26 do
        begin
           MoveTo(pts[ite1].X,pts[ite1].Y);
           LineTo(pts[ite2].X,pts[ite2].Y);
        end;
      end; 
```

# node.js - node.js 脚本阻塞了一段时间（在 beaglebone 上）

> ID：14084145
> 
> 赞同：0
> 
> 时间：2012-12-29T17:25:41.577
> 
> 标签：node.js, serial-port, socket.io

我使用**node.js (0.8.15)**编写了一个带有基于 Web 的前端的控制器/通信应用程序。**socket.io**执行定期数据交换。

我的后端需要每秒与 3 个嵌入式板通信（通过 19200bps 的 rs232）。这些板在看到更长的通信故障时会触发看门狗。

当我启动我的 node.js 应用程序时，一切都很好，通信正常。**第一次**连接到我的 Web 服务器时，我看到 rs232 通信停止了大约 5-10 秒。

重新加载网页时我没有看到这种效果。使用 http 或 https 没有区别。尝试使用**--nolazy**或**--noopt**或**--noalways_full_compiler**等选项运行节点不会改变任何内容。

以下是我的网络服务器的相关部分：

```
var requests =
[ { method: 'GET', pattern: '/',               type: 'text/html', subst: '/index.html' },
  { method: 'GET', pattern: '/index.html',     type: 'text/html' },
  { method: 'GET', pattern: '/favicon.ico',    type: 'image/x-icon' },
  { method: 'GET', pattern: '/js/[^/]+\.js',   type: 'text/javascript' },
  { method: 'GET', pattern: '/css/[^/]+\.css', type: 'text/css' },
  { method: 'GET', pattern: '/img/[^/]+\.jpg', type: 'image/jpeg' },
  { method: 'GET', pattern: '/img/[^/]+.png',  type: 'image/png' },
];

function response (req, res)
{
  var method = req.method;
  var path = Path.normalize (Url.parse (req.url).pathname);

  console.log (method+' '+path);
  for (i = -1; ++i < requests.length;)
  {
    var r = requests[i];
    if (r.method == method && path.search ('^'+r.pattern+'$') == 0)
    {
      if ('subst' in r)
      {
        path = r.subst;
      };
      if (r.type.match (/^text/))
      {
        Fs.readFile (__dirname+path, 'utf8', function (err, data)
        {
          if (err)
          {
            res.writeHead (500);
            res.end ('Error reading '+path);
          }
          else
          {
            res.writeHead (200, {'Content-Type': r.type});
            res.end (data, 'utf8');
          }
        });
        return;
      }
      else
      {
        Fs.readFile (__dirname+path, function (err, data)
        {
          if (err)
          {
            res.writeHead (500);
            res.end ('Error reading '+path);
          }
          else
          {
            res.writeHead (200, {'Content-Type': r.type});
            res.end (data);
          }
        });
        return;
      }
    }
  };
  console.log ('error 404');
  res.writeHead (404);
  res.end ();
}

var httpServer = Http.createServer (response);
httpServer.listen (47080);
console.log ('http server running at port 47080');
var basic = Auth ({
  authRealm : "controller",
  authFile : __dirname + '/users.htpasswd'
});

function httpsResponse (req, res)
{
  basic.apply (req, res, function (username)
  {
    response (req, res);
  });
}

var options = {
  key: Fs.readFileSync (__dirname + '/controller.pem'),
  cert: Fs.readFileSync (__dirname + '/controller.cert')
};
var httpsServer = Https.createServer (options, httpsResponse);

httpsServer.listen(47443);
console.log ('https server running at port 47443');

function connected (socket)
{
  console.log ('Listener connected');
  theApp.addSocket (socket);
  socket.on ('disconnect', function ()
  {
    theApp.removeSocket (socket);
  });
}

var httpListen = Io.listen (httpServer,   { 'log level':1 });
var httpsListen = Io.listen (httpsServer, { 'log level':1 });
httpListen.sockets.on ('connection', connected);
httpsListen.sockets.on ('connection', connected); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T15:46:09.033

我将我的应用程序重写为两个进程：一个用于 Web 服务器，一个用于串行通信。这改善了事情，但并没有解决问题。

真正的问题似乎是垃圾收集器。

使用 --expose-gc 启动节点并定期显式调用 global.gc() 后，应用程序运行顺利。

# php - ajax表单提交，我哪里出错了？

> ID：14084146
> 
> 赞同：2
> 
> 时间：2012-12-29T17:26:06.573
> 
> 标签：php, ajax

我正在尝试使用 ajax 提交密码更改，以便能够在更改后保持在同一个 ui.tab 页面上，并提供视觉反馈。如果我将 action="change_password_do.php" 留在表单中，我可以更改密码，因此 php 文件有效。如果我将 action="" 放入表单中，我将一无所获。显然我的 ajax 中有一个基本错误，但我找不到它。有人可以指点我正确的方法吗？

```
<script type="text/javascript">
$(document).ready(function() {
    $('#new_password_submit').click(function() {
        $.ajax({
            type: "POST",
            url: "change_password_do.php",
            data: $("form.pw_todo").serialize()
        });
    });
});
</script>                       

<div id="tabs_6" class="tabs">
       <h2 class="tablecaption">Change your password</h2>

       <form id="change_pass" class="pw_todo" method="post" action="">

            <input class="formlogin" type="password" name="password1" placeholder="New Password" title="Type in your New Password"/><br />
            <input class="formlogin" type="password" name="password2" placeholder="Re-enter New Password" title="Re-type your New Password"/><br />
            <input type="submit" id="new_password_submit" value="Submit" class="button"/>

       </form>  
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:33:17.083

您需要通过单击处理程序返回 false 来取消按钮的默认操作：

```
$('#new_password_submit').click(function() {
    $.ajax({
        type: "POST",
        url: "change_password_do.php",
        data: $("form.pw_todo").serialize()
    });
    return false; // <-- That's very important
}); 
```

作为替代方案，您可以像这样取消默认操作：

```
<script type="text/javascript">
$(document).ready(function(evt) {
    $('#new_password_submit').click(function() {
        evt.preventDefault(); // <-- That's very important

        $.ajax({
            type: "POST",
            url: "change_password_do.php",
            data: $("form.pw_todo").serialize()
        });
    });
});
</script> 
```

由于`new_password_submit`是一个提交按钮，如果您在单击按钮时不取消单击处理程序中的默认操作，则将提交表单并且浏览器将重定向离开页面，从而没有时间执行您的 AJAX 请求。

话虽如此，我建议您订阅表单的 .submit 事件，而不是提交按钮的 .click 事件。这样可以保证 AJAX 请求将始终执行。请记住，除了单击提交按钮之外，还可以通过其他方式提交表单。例如，表单可以由用户`Enter`在某个输入字段内按下键来提交。如果他以这种方式提交表单，您的 AJAX 请求将永远不会执行。

所以，这是我推荐的解决方案：

```
$('#change_pass').submit(function(evt) {
    evt.preventDefault(); // <-- That's very important

    $.ajax({
        type: this.method,
        url: this.action,
        data: $(this).serialize()
    });
}); 
```

然后确保你已经在表单上设置了 action 属性：

```
<form id="change_pass" class="pw_todo" method="post" action="change_password_do.php"> 
```

现在，javascript 所做的就是不显眼地 AJAXifying 表单的提交。如果用户禁用了 javascript，您的代码仍然可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:33:40.453

我认为**您不需要使用任何表单或提交按钮**，因为**您已经通过 AJAX**传递值，将值直接传递给数据属性`$.ajax();`并继续您的 AJAX 方法。

```
<script type="text/javascript">
$(document).ready(function() {       
    $('#new_password_submit').click(function(){ 
        $.ajax({
        type: "POST",
        url: "change_password_do.php",
        data: {'password1': $('#password1').val(),
               'password2': $('#password2').val()}
        });
    });
}); 
</script>                       

<div id="tabs_6" class="tabs">
       <h2 class="tablecaption">Change your password</h2>

            <input class="formlogin" type="password" name="password1" placeholder="New Password" title="Type in your New Password" id="password1"/><br />
            <input class="formlogin" type="password" name="password2" placeholder="Re-enter New Password" title="Re-type your New Password" id="password2"/><br />
            <input type="button" id="new_password_submit" value="Submit" class="button"/>

</div> 
```

**注意**：我刚刚添加了 ID `password1`，`password2`为了您的方便

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:34:24.097

您必须取消提交事件，否则表单仍将在 ajax 调用之前正常提交。

```
$('#new_password_submit').click(function(e){
        e.preventDefault();
        $.ajax({
            .... 
```

接下来，您的 ajax 调用中缺少一个成功函数，因此事件如果它有效，您至少不会在视觉上注意到它。

最后，查看[jQuery 表单插件](http://malsup.com/jquery/form/)，它完全符合您的要求。没什么花哨的，但如果你需要它，它很有用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:38:40.370

不要绑定按钮的点击事件，最好绑定表单的提交事件。

```
<script type="text/javascript">

$(function() {
    $('#change_pass').submit(function(e) {

        // this will prevent default form behaviour
        e.preventDefault()

        $.ajax({
            type: "POST",
            url: $(this).attr('action'),
            data: $(this).serialize(),
            success: function(data){

                // consider displaying some message on success

            }
        });
    });
});

</script>

<form id="change_pass" class="pw_todo" method="post" action="change_password_do.php">

...

</form> 
```

# c++ - 如何检查大型 c++ Linux 应用程序中的内存泄漏？

> ID：14084151
> 
> 赞同：6
> 
> 时间：2012-12-29T17:26:26.210
> 
> 标签：c++, linux, memory-management, memory-leaks

我目前正在从事一个大型应用程序项目（用 c++ 编写），该项目是前一段时间从头开始的，我们已经到了必须对内存泄漏进行综合检查的地步。

该应用程序在 Ubuntu Linux 上运行，具有大量多媒体内容，并使用 OpenGl、SDL 和 ffmpeg 用于各种用途，包括 3D 图形渲染、窗口、音频和电影播放。您可以将其视为视频游戏，尽管它不是，但应用程序的职责可以通过将其视为视频游戏来简化。

我目前在确定我们是否仍然存在内存泄漏方面有点无能为力。过去我们已经识别了一些，并删除了它们。不过，这些天来，应用程序几乎完成了，我们运行的测试给了我我无法完全弄清楚的结果。

我做的第一件事是尝试通过 Valgrind 运行应用程序......不幸的是，在 valgrind 环境中运行时应用程序崩溃。“非确定性”的崩溃，因为它在不同的地方崩溃。所以我放弃了使用 Valgrind 来轻松识别潜在泄漏的来源，并最终使用了两个 Linux 命令：free 和 top。

free 用于在应用程序运行时探测系统内存使用情况

top 与“-p”选项一起使用，以在运行时探测应用程序进程的内存使用情况。

输出表单 top 和 free 被转储到文件中以进行后处理。我用问题底部链接的数据制作了两个图表。

测试用例非常简单：一旦应用程序已经启动并等待命令，就会探测有关内存的数据。然后我启动一系列重复执行相同操作的命令。该应用程序预计会将大量多媒体数据加载到 RAM 中，然后下载。

不幸的是，图表并没有向我展示我所期望的。内存使用量通过 3 个不同的步骤增长，然后停止。内存显然从未释放，这暗示我存在巨大的内存泄漏。那会很好，因为这意味着我们很可能没有释放被媒体占用的内存。

但是在前三个步骤之后......内存使用稳定......没有任何更大的步骤......只是轻微的上下移动，对应于预期的数据加载和卸载。这里出乎意料的是，应该加载/卸载的数据占 RAM 的百分之一兆字节，而不是上升和下降仅占几兆字节（比如说 8-10 MB）。

我目前对解释这些数据一无所知。

有人有一些提示或建议吗？我错过了什么？我用来检查是否存在宏观内存泄漏的方法是否完全错误？你知道除了 Valgrind 之外的任何其他（最好是免费的）工具来检查内存泄漏吗？

[系统内存使用图](http://i.stack.imgur.com/wJOCW.png)

[进程内存使用图](http://i.stack.imgur.com/DZM4Z.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T17:34:37.763

与其放弃 Valgrind，不如与他们合作并尝试

*   摆脱你在 Valgrind 中遇到的错误
*   使用更新的 Valgrind 对您的应用进行全面测试和调试。

说你放弃了 Valgrind 这是*解决*你问题的方法并没有真正帮助......

Valgrind 是我们都用来检查 linux 下的内存泄漏和线程问题的工具。

最后，最好花时间弄清楚“为什么 Valgrind 不能与我的应用程序一起使用”，而不是寻找替代解决方案。Valgrind 是一个经过验证和测试的工具，但并不完美。它远远超过了替代方法。

Valgrind 页面说最好将错误提交给 Bugzilla，但实际上最好在[https://lists.sourceforge.net/lists/listinfo/valgrind-users](https://lists.sourceforge.net/lists/listinfo/valgrind-users)上询问是否有人以前看到过此类问题以及在这样的情况下该怎么做情况。最坏的情况——他们会告诉你向 bugzilla 提交错误或自己提交。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T19:34:57.750

首先...

> 我们已经到了必须对内存泄漏进行汇总检查的地步。

这其实是**方法论的问题**。正确性应该是任何软件的*主要目标，而不是事后的想法。*

我会假设您现在意识到了这一点，并且如果您在每次提交时都运行检测单元测试，那么识别问题会容易得多。

* * *

那么，现在该怎么办？

*   运行时检测：

    *   尝试让 Valgrind 工作，你可能有一些环境问题
    *   尝试[ASan](http://clang.llvm.org/docs/AddressSanitizer.html)、[ThreadSan](http://clang.llvm.org/docs/ThreadSanitizer.html)和[MemSan](http://clang.llvm.org/docs/MemorySanitizer.html)；在 Linux 下设置它们并非易事，但令人印象深刻！
    *   尝试检测构建：例如[tcmalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)包括一个[堆检查器](http://goog-perftools.sourceforge.net/doc/heap_checker.html)
    *   ...
*   编译时检测：

    *   打开警告（最好使用`-Werror`）（不是特定于您的问题）
    *   使用静态分析，例如[Clang 的](http://clang-analyzer.llvm.org/)，它可能会发现不成对的分配例程
    *   ...
*   人体检测：

    *   代码审查：确保所有资源都分配在 RAII 类中
    *   ...

*注意：仅使用 RAII 类有助于消除内存泄漏，但无助于悬空引用。值得庆幸的是，检测悬空引用是 ASan 所做的。*

* * *

一旦您修补了所有问题，请确保这成为该过程的一部分。更改应始终进行审查和测试，以便立即剔除臭鸡蛋，而不是让代码库发臭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T17:28:36.933

你可能想看看[valgrind](http://www.valgrind.org)。

您可能只想从非常简单的示例开始，以了解 valgrind 报告的内容可能有些冗长。考虑这个简化的例子，其中 valgrind 究竟缺少了什么和多少：

```
edd@max:/tmp$ cat valgrindex.cpp 

#include <cstdlib>

int main() {
  double *a = new double[100];
  exit(0);
}
edd@max:/tmp$ g++ -o valgrindex valgrindex.cpp 
edd@max:/tmp$ valgrind ./valgrindex
==15910== Memcheck, a memory error detector
==15910== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==15910== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==15910== Command: ./valgrindex
==15910== 
==15910== 
==15910== HEAP SUMMARY:
==15910==     in use at exit: 800 bytes in 1 blocks
==15910==   total heap usage: 1 allocs, 0 frees, 800 bytes allocated
==15910== 
==15910== LEAK SUMMARY:
==15910==    definitely lost: 0 bytes in 0 blocks
==15910==    indirectly lost: 0 bytes in 0 blocks
==15910==      possibly lost: 0 bytes in 0 blocks
==15910==    still reachable: 800 bytes in 1 blocks
==15910==         suppressed: 0 bytes in 0 blocks
==15910== Rerun with --leak-check=full to see details of leaked memory
==15910== 
==15910== For counts of detected and suppressed errors, rerun with: -v
==15910== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
edd@max:/tmp$ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T18:10:17.627

结果来自`free`并且`top`不会对您有帮助。我很遗憾你努力为他们的结果构建图表。我已经很好地解释了为什么它们在此处的类似主题中没有帮助：[Linux 中 C++ 应用程序的内存稳定性](https://stackoverflow.com/questions/14023815/memory-stability-of-a-c-application-in-linux/14024853#14024853)。

我也会同意这里的其他答案，您可能应该优先解决您在 Valgrind 中遇到的崩溃问题。Valgrind 在这一点上被认为非常稳定，我个人运行过相当复杂的多线程多媒体 SDL/OpenGL/等。应用程序通过它没有问题。Valgrind 的运行环境更有可能暴露您的应用程序中可能存在的不稳定性。崩溃听起来像是线程竞争条件崩溃，尽管它也可能是堆/内存损坏。

那么，您可能想要询问的是有关如何调试在 Valgrind 的运行环境中崩溃的应用程序的建议（我不知道答案）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-29T18:15:52.703

free 和 top 的问题是它们可以向您显示问题，但它们在解决问题方面几乎没有帮助。在分配内存的 100 行或 1000 行代码中，哪些是泄漏的？这就是 valgrind 提供帮助的地方。

如果这是针对工具预算有限的公司，您可能会考虑 purify 或其他商业工具。

为了完整起见，我将提到 Boehm 保守的垃圾收集内存分配器（适用于 C 和 C++ 代码）。您可以关闭 GC 并使用 GC_Free() 它成为泄漏检测工具。或者，您可以启用 GC 以在不再使用时自动释放内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T17:41:01.253

这完全取决于您使用的分配器。libc 分配器（malloc、calloc、realloc）和 C++ 分配器（new、delete）可能使用了不将内存释放回操作系统的优化技巧。你看，如果你向 malloc 请求一些内存，使用它，然后释放它，它不一定会被释放回操作系统。相反，如果我向 malloc 请求内存，那么（大多数莉莉）获得更多的内存是必要的（因为页面边界）。这样，下次您需要更多内存时，malloc 就可以将其放在一边。免费也一样。内存可能只是添加到 mallocs 内存池中，您以后的分配正在从中提取。

因此，您的应用程序最初的几个 malloc 会将内存非常高，但随后池足够大以容纳未来的分配。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-29T20:03:36.150

除了使用`valgrind`您还可以考虑使用[Boehm 的保守 GC](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)；您可能想要编译它并将其配置为内存泄漏检测器。

您甚至可能敢于使用 Boehm 的 GC 作为您的主要内存分配器。

顺便说一句，调查`/proc/1234/maps`可以帮助您（其中 1234 是您的进程的 pid）。

# python - 在python中计算月份数

> ID：14084152
> 
> 赞同：-2
> 
> 时间：2012-12-29T17:26:30.500
> 
> 标签：python

例如，我们有

```
date = 29
number_of_week = 52
year = 2012 
```

如何计算月数？本例中为 12。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:31:59.447

```
from datetime import date, timedelta

def get_month(year, week, day):
    january_first = date(year, 1, 1)
    monday_date = january_first + timedelta(days=week * 7 - january_first.weekday())

    for d in range(7):
        weekday_date = monday_date + timedelta(days=d)
        if weekday_date.day == day:
            return weekday_date.month 
```

在这一点上，很明显你需要更好的设计。更大的图景是什么？为什么你需要这一切？

# requirejs - 在页面之间重用 Require.js shim 配置

> ID：14084156
> 
> 赞同：3
> 
> 时间：2012-12-29T17:26:53.247
> 
> 标签：requirejs

我有兴趣为我网站上的所有 JavaScript 代码创建一个单一的配置对象。我找到了[https://github.com/requirejs/example-multipage-shim](https://github.com/requirejs/example-multipage-shim)，这是此设置的一个示例。

> 来自[https://github.com/requirejs/example-multipage-shim](https://github.com/requirejs/example-multipage-shim)（重点是我的）：由于 shim 配置要求依赖项位于页面中，而不是对 page1.html 使用 data-main="js/page1"，此示例内联 HTML 页面中的 require 调用。**如果改为使用 data-main，则 'js/page1' 不能有任何内联依赖**项，而是仍然依赖 'common' 和 'app/main1' 构建层来保存模块，因为 shim 配置位置的限制在构建上。

我不明白加粗的句子。这是否意味着“js/page1”如果存在就不能声明依赖关系？内联依赖是什么意思？内联成什么？HTML 文件还是 JavaScript 文件？

我阅读了有关 shim config 的 API 文档，但它对优化器的限制尚不清楚。

从[https://github.com/requirejs/example-multipage-shim/blob/master/www/page1.html](https://github.com/requirejs/example-multipage-shim/blob/master/www/page1.html)：

```
 <script src="js/lib/require.js"></script>
    <script>
        //Load common code that includes config, then load the app
        //logic for this page. Do the require calls here instead of
        //a separate file so after a build there are only 2 HTTP
        //requests instead of three.
        require(['./js/common'], function (common) {
            //js/common sets the baseUrl to be js/ so
            //can just ask for 'app/main1' here instead
            //of 'js/app/main1'
            require(['app/main1']);
        });
    </script> 
```

为什么以下错误？为什么“app/main1”必须与引导（数据主）代码位于单独的模块中？

```
 <script src="js/lib/require.js"></script>
    <script>
        require(['js/common'], function (common) {
            var underscore = require('underscore');
            // ...
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-11T13:19:09.310

我认为避免复制 shim 的唯一真正解决方案可能是结合服务器端模板和 grunt.js 之类的构建处理器。

如果您想在优化的 require.js 加载和非优化模式之间切换（例如用于开发目的），则只需要服务器端模板部分。

1.  定义一个包含共享 shim 的 JavaScript 文件。
2.  如果使用 grunt.js 使用节点`export`语法来导出您的 shim 和路径。
3.  要求它作为你的 grunt 配置的一部分。要么编写 require.js 配置文件，要么根据 grunt 插件，你可能能够`require`在你的 require.js 构建中重用内存中的 'ed 配置。
4.  作为 grunt 构建的一部分，编写后端架构使用的服务器模板文件。例如，如果您使用的是 django，请编写一个未检入存储库的部分 django 模板。如果您使用 .git，可能在 .gitignore 中包含输出路径。
5.  在您的 index.html 或初始加载部分作为全局变量之前您的 require.js 脚本标记与 data-main 时不使用优化垫片。在您的调用集中或使用您从模板加载到 Javascript`requirejs`的数据扩展您的 requirejs.config 。

一个不太理想但更简单的解决方案可能是简单地设置一个定义执行上下文的全局变量，然后加载一个共享条目`requirejs`脚本，然后根据上下文在运行时使用`switch`上下文变量调用。`require`这可能更难以优化。更糟糕的是，您可能总是需要所有页面所需的一切，并使用此上下文来确定要运行什么而不是需要什么，但显然您总是在加载所有 JavaScript。这可能在浏览器扩展的上下文中起作用，尽管在处理所有不必要的 JavaScript 时仍然可能会减慢速度。

说了这么多，如果 requirejs 提供了一种方法来加载与`requirejs`or`define`调用分开的配置，那将是很好的，只是为了避免在整个地方声明相同的 shims 的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:48:55.833

在单独的 javascript 文件中定义（使用定义）每个模块是一个很好的做法。否则异步加载几个模块是没有意义的，因为它们位于相同的物理位置。在大多数情况下，您只需要使用函数定义。只有在您的引导模块中，您才需要使用函数 require。

当我使用 require.js 时，我有 1 个模块 (bootstrap.js)，其中包含我的 require.config 对象和初始引导。在 html 页面中，您只需要包含 1 个脚本：require.js，其中 bootstrap 作为 data-main 属性值：

**HTML：**

```
<script src="js/lib/require.js" data-main="bootstrap"></script> 
```

**引导程序：**

```
require.config = {
   baseUrl: 'js',
   paths: {
     ...
   },
   shim: {
   }
   ...
};

// initial bootstrap
require(['jquery', 'angular', 'app'], function($, angular) {
   // do bootstrap
}); 
```

**模块：**

```
define(['jquery'], function($) {
   // do sth with app
}); 
```

**编辑：**有点误解了这个问题。

使用 data-main 属性时不能在 html 页面中使用内联依赖项的原因是它可能无法加载它们。哪个代码块将首先执行？数据主引导 js 或内联代码？如果您的引导 js 文件将首先加载并将 设置`baseUrl`为`'js'`，则应使用内联代码`require('common')`而不是`require('js/common')`. 但如果内联代码首先加载，它必须是`require('js/common')`.

在另一个 require 块内的原因`require('app/main1')`是相同的：模块 'common' 会将 baseUrl 更改为`'js'`. *'app/main'*也可能需要来自*'common' 的*一些 shim 配置。这是确保首先加载公共模块（带有 shim 配置）的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T23:09:32.950

当您使用**shim**配置时，为您希望异步加载的每个 shim添加匹配的**路径配置属性：**

```
requirejs.config({
    paths: {
        backbone: 'lib/backbone',
        jquery: 'lib/jquery',
        underscore: 'lib/underscore'
    },
    shim: {
        backbone: {
            deps: ['jquery', 'underscore'],
            exports: 'Backbone'
        },
        underscore: {
            exports: '_'
        },
        jquery: {
            exports: '$'
        }
    }
}); 
```

`define()`然后，shim 模块可以像任何其他真实模块一样用作依赖项。（至少这是我的经验！）

# java - 如何从 zipgroupfileset 中排除？

> ID：14084160
> 
> 赞同：7
> 
> 时间：2012-12-29T17:27:08.883
> 
> 标签：java, ant, jar

我正在使用 ANT 1.7.1，但我收到一个错误，即 zipgroupfileset 目标不支持排除。

我正在尝试执行以下操作-

```
<zipgroupfileset >
                <fileset dir="lib">
                <excludes>
         <exclude>META-INF/*.SF</exclude>
         <exclude>META-INF/*.DSA</exclude>
         <exclude>META-INF/*.RSA</exclude>                                       
                </excludes>

            </fileset>
   </zipgroupfileset> 
```

请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-12-19T16:04:44.953

接受的答案对我不起作用，我做了以下事情：

```
 <zipgroupfileset dir="lib" excludes="<jars containing the signatures>"/>
    <zipfileset src="lib/<jar containing the signatures>" excludes="META-INF/*.SF,META-INF/*.DSA"/> 
```

此解决方案要求您知道哪些 jars 已签名（包含 .SF、*.DSA、* .RSA）文件。您需要为每个罐子提供一个 zipfileset。

zipgroupfileset 无法检查 jar 的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:36:22.170

[Zipgroupfileset](http://ant.apache.org/manual/Tasks/zip.html)已经是一个文件集，所以你只需要这样的东西：

```
<zipgroupfileset dir="lib" excludes="META-INF/*.SF,META-INF/*.DSA,META-INF/*.RSA"/> 
```

# python - python中停用词的实现

> ID：14084163
> 
> 赞同：0
> 
> 时间：2012-12-29T17:28:04.773
> 
> 标签：python

python中的停用词列表更快：

```
 stopwords = ('a','and', 'etc') 
```

或使用文件来调用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:33:33.047

`NLTK`有停用词作为列表。

```
nltk.corpus.stopwords.words('english') 
```

如果这就是您的意思，它比使用文件并在遍历停用词时从中读取要快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:20:14.367

如果您不想下载`nltk`，到处都可以找到停用词文件。他们通常每行列出一个单词，因此很容易将它们放在自己的结构中。

```
stopwords = ()
for line in open('stopwordfile'):
    stopwords += (line,) 
```

但是，比在元组中查找单词更快的是使用字典，可能最好使用默认返回值：

```
stopdict = {w:True for w in stopwords}

for word in text_you_want_to_index:
     if word not in stopdict:          # or: not stopdict.get(word, False): don't know which one more performant
          print word 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:33:19.737

文件操作总是比正常的代码执行慢得多。因此，如果您需要的数据足够小，请不要使用文件。

如果以下任何一项为真，您将使用文件：

*   需要修改输入数据而不改变实际代码
*   需要处理的大量数据
*   数据正在由另一个进程/应用程序提供

如果您只有有限数量的停用词，并且您不需要经常更改它们，那么请始终使用

```
stopwords = ('a','and', 'etc') 
```

# glsl - 使用自定义着色器使粒子“闪烁”

> ID：14084165
> 
> 赞同：1
> 
> 时间：2012-12-29T17:28:15.907
> 
> 标签：glsl, three.js

我正在制作夜空，我希望我的粒子系统中的星星闪烁。

我听说我可以使用噪声纹理来实现随机性，但我不确定从那里去哪里。而且我不确定如何使闪烁顺利进行，即。逐渐变亮，然后变暗。

现在我只是给每个顶点一个随机`rand`属性，然后`twinkleRand`每 200 毫秒左右更换一次制服。如果随机数匹配，则点变大：

```
if (rand == twinkleRand) {
   gl_PointSize = size * abs(sin(js_time) + rand/100.);
}
else {
   gl_PointSize = size;
} 
```

这有点闪烁，但不是一个令人信服的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T11:45:46.223

与其改变点的大小，不如改变颜色——你会得到更自然、更少脉动的外观。并赋予每颗星星独特的持久价值，让它们闪烁，而不是频闪。

```
newColor = starColor * (1.0 - (sin(js_time*starSpeed)+1.0)*starVariance*0.5) 
```

# java - OpenGL（java）更新灯？

> ID：14084167
> 
> 赞同：1
> 
> 时间：2012-12-29T17:28:22.513
> 
> 标签：java, opengl, lwjgl

我目前正在使用 lwjgl 学习 OpenGL。我创建了一个由顶点构建的 Box。我还创建了一个灯光类，它应该设置灯光的参数并最终启用灯光。

我可以让灯工作，但有一个问题。如果我围绕任何轴旋转盒子，灯光不会更新盒子的表面。这意味着：

如果我的灯在我的盒子前面......我的盒子的正面是白色的，我的盒子的背面是黑暗的。如果我将盒子旋转 180°，我的新正面应该是白色的，而我的旧正面（现在是背面）应该是黑色的。但事实并非如此！为什么？每次我再次渲染我的场景时都需要创建灯光吗？

这是我创建灯光的代码：

```
//creating buffers
    FloatBuffer matSpecular = BufferUtils.createFloatBuffer(4);
    matSpecular.put(1.0f).put(1.0f).put(1.0f).put(1.0f).flip(); 

    FloatBuffer lightPosition = BufferUtils.createFloatBuffer(4);
    lightPosition.put(1.0f).put(1.0f).put(1.0f).put(0.0f).flip();   

    FloatBuffer whiteLight = BufferUtils.createFloatBuffer(4);
    whiteLight.put(1.0f).put(1.0f).put(1.0f).put(1.0f).flip();  

    FloatBuffer lModelAmbient = BufferUtils.createFloatBuffer(4);
    lModelAmbient.put(0.5f).put(0.5f).put(0.5f).put(1.0f).flip();

    //-----------------

    GL11.glShadeModel(GL11.GL_SMOOTH);
    GL11.glMaterial(GL11.GL_FRONT, GL11.GL_SPECULAR, matSpecular);
    GL11.glMaterialf(GL11.GL_FRONT, GL11.GL_SHININESS, 50.0f);

    GL11.glLight(GL11.GL_LIGHT0, GL11.GL_POSITION, lightPosition);
    GL11.glLight(GL11.GL_LIGHT0, GL11.GL_SPECULAR, whiteLight);
    GL11.glLight(GL11.GL_LIGHT0, GL11.GL_DIFFUSE, whiteLight);
    GL11.glLightModel(GL11.GL_LIGHT_MODEL_AMBIENT, lModelAmbient);

    GL11.glEnable(GL11.GL_LIGHTING);
    GL11.glEnable(GL11.GL_LIGHT0);

    GL11.glEnable(GL11.GL_COLOR_MATERIAL);
    GL11.glColorMaterial(GL11.GL_FRONT, GL11.GL_AMBIENT_AND_DIFFUSE); 
```

这就是我创建画我的盒子的方式：

```
GL11.glPushMatrix();

    GL11.glLoadIdentity();
    GL11.glTranslatef(_position.x, _position.y, _position.z);
    GL11.glRotatef(_rotation, 0, 0, 1);
    GL11.glRotatef(_rotation, 0, 1, 0);

    GL11.glColor3f(1f, 1f, 1f);

    GL11.glBegin(GL11.GL_TRIANGLES);

    for(int index : cubeIndices)
    {
        Vector3f vertex = _vertices[index];
        GL11.glVertex3f(vertex.x, vertex.y, vertex.z);
    }

    GL11.glEnd();

    GL11.glPopMatrix(); 
```

# objective-c - 向 LocalNotifications 发出振动和声音

> ID：14084175
> 
> 赞同：2
> 
> 时间：2012-12-29T17:29:19.117
> 
> 标签：objective-c, ios, notifications

我如何向 LocalNotifaction 添加振动和声音

代码：

```
UILocalNotification *notification = [[UILocalNotification alloc]init];

NSDate *firedate = settime.date;
[notification setFireDate:firedate];
[notification setAlertBody:@"הלכה יומית"];
[notification setAlertAction:@"הלכה"];

[[UIApplication sharedApplication]scheduleLocalNotification:notification]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:05:04.083

您可以设置声音：

```
notification.soundName = @"yourSound.aiff" ;   // see also UILocalNotificationDefaultSoundName 
```

但是振动不在您的控制范围内：

> 不幸的是，如果您想要声音，除非用户进入常规设置并自行禁用振动，否则您无法禁用振动。 [-沙布兹科](https://stackoverflow.com/a/9451489/1523962)

> UILocalNotification API 允许您设置系统默认声音、选择声音或没有声音，如果您有声音，它会在适当的情况下振动（即用户启用了振动）。但除此之外，您无法控制振动是否发生或持续多长时间。 [-yuji](https://stackoverflow.com/a/9320512/1523962)

# java - 对象为空，尽管已初始化

> ID：14084176
> 
> 赞同：0
> 
> 时间：2012-12-29T17:29:33.210
> 
> 标签：java, arrays, object, null

我有以下代码：

```
public class GameCanvas extends JPanel {

private GridField[][] grid;
private int x, y;
private int fieldSize;

public GameCanvas(int rows, int cols, int fieldSize)
{
    this.grid = new GridField[cols][rows];
    this.x = cols;
    this.y = rows;
    this.fieldSize = fieldSize;
}

...
} 
```

这是 GridField 类的定义：

```
public class GridField {

private FieldType fieldType;    

public GridField() {
    fieldType = FieldType.EMPTY;
}

public FieldType getFieldType() {
    return fieldType;
}

public void setFieldType(FieldType fieldType) {
    this.fieldType = fieldType;
    }
} 
```

问题是，当我尝试访问“网格”对象时，编译器说它为空，尽管我已经在类的构造函数中对其进行了初始化。

我做了一点检查：

```
if(grid[xSize][ySize] == null) {
  System.out.println("Grid[x][y] is null");
} 
```

它打印出我所期望的结果——null。

我从 C# 背景来到 Java，所以我可能错过了一些东西。我相信，这是一个微不足道的错误，但我找不到它。

在此先感谢您的任何提示。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T17:30:41.670

```
this.grid = new GridField[cols][rows]; 
```

上面的代码只初始化了数组。您还需要使用`objects`of初始化每个数组元素`GridField`。

大概是这样的：-

```
for (int i = 0; i < cols; i++) {
    for (int j = 0; j < rows; j++) {
        grid[i][j] = new GridField();
    }
} 
```

> 我从 C# 背景来到 Java，所以我可能错过了一些东西。

这种初始化方式在`C#`. 所以，如果你在 中初始化了这样的数组`C#`，那么你可能也错过了一些东西。注意来自@JonSkeet 的评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:31:41.217

```
this.grid = new GridField[cols][rows]; 
```

这只会初始化数组，但您没有元素。

数组中的元素指向 null

# javascript - Node.js 在写入后保持连接而不关闭

> ID：14084191
> 
> 赞同：1
> 
> 时间：2012-12-29T17:31:05.040
> 
> 标签：javascript, node.js, connection-pooling

我试图解释我的问题：

*   我每个用户都有一个文件连接：*user1.txt*，*user2.txt*（包含javascript代码）
*   我有一个脚本，根据应用程序的发展更新它们
*   每个用户调用一个文件 demo.php：

**客户端 HTML：**

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>demo game</title>
    <script src="/js/jquery-1.8.3.min.js"></script>
    <script src="http://127.0.0.1:8080"></script>
  </head>
  <body>
    <div id="messages"></div>
  </body>
</body>
</html> 
```

**节点 server.js：**

```
 var server = require('http').createServer(function(req, res){

               setInterval(function() {
                    mycode = html.readFileSync(__dirname+'/user1.txt');

                    socket.end(mycode+"\n");
                    console.log('data sent'+mycode);

                }, 1000);

         });

    server.listen(8080); 
```

假设*user1.txt*的内容是：`$("#messages").append("<br> hello");`

发送*user1.txt*的包含，可以并在客户端执行，但是，如果*user1.txt*包含更改，我在 上看到它`console.log('data sent'+mycode);`，我想它发送了什么但没有执行，为什么？

我尝试使用`write()`而不是`end()`，我尝试使用：

```
var net = require('net');
var html = require('fs');
var server = net.createServer({ allowHalfOpen: true},.... 
```

相同的！

再次：如何在客户端发送“实时 javascript 代码”？

预先感谢

丹妮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:24:48.873

浏览器可以在渲染`<div id="messages"></div>`. 在这种情况下，您的代码会执行，但没有任何效果。尝试`user1.txt`像这样更改您的代码：

```
$(function() {
    $("#messages").append("<br> hello");
}); 
```

# sed - grep : 查找 3 个连续字母的出现

> ID：14084192
> 
> 赞同：1
> 
> 时间：2012-12-29T17:31:28.823
> 
> 标签：sed, grep

我想找到我尝试过的 aaa、bbb 等：

```
grep -E [a-z]\{3\} 1.txt 
```

但这甚至打印 abc

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T17:35:41.927

您可以使用对捕获组的引用：

```
[/tmp] cat test.txt                                                            
aaa
bbb
abc
aab
bbc
[/tmp] grep -E "([a-z])\1{2}" test.txt                                         
aaa
bbb 
```

`\1`指的是`([a-z])`（在您的情况下为单个字母）捕获的内容，因此正则表达式会查找单个字母，然后再查找相同的字母两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-27T18:48:45.373

另一种变体：

```
grep '\([a-z]\) *\1\1' fileName 
```

# php - PHP-身份验证代码错误 (isset($_POST['username'])) 总是返回 false，

> ID：14084195
> 
> 赞同：1
> 
> 时间：2012-12-29T17:31:56.403
> 
> 标签：php, html, sql, forms

> 我正在制作这个简单的代码来验证用户。带有表单的页面是：>login.php。使用以下代码。

登录.php：

```
<html>    
<body>  

<div style="position:absolute;left:300px;top:300px;width:300px;height:100px;z-index:9;>  

<form name="form1" method="POST" action="check.php">  
Username:<br />  
  <input type="text" name="Username" />  
  <br /><br />   
  Password:<br />  
  <input type="password" name="Password" />  
  <br /><br /><br/>  
  <input type=button onClick="location.href='check.php'" value='Continue'       name='continue'/>  
  </form>  
</div>  
</body>  
</html> 
```

> 表单字段值在下一个 php 页面中使用，代码如下：

检查.php：

```
<?php
session_start();
$con = mysql_connect("localhost", "root", "");
mysql_select_db("aviation", $con) or die(mysql_error());
if (isset($_POST['continue'])) {
    $userName = $_POST[Username];
    $passWord = $_POST[Password];
    mysql_select_db('aviation');
    $query = "select * from users where Username='" . $userName . "'and     Password='" . $passWord . "'";
    $result = mysql_query($query, $con);
    if (!$result) {
        die('Could not enter data: ' . mysql_error());
    }
    $rows = mysql_num_rows($result);
    if ($rows == 1) {
        $_SESSION['Username'];
        $_SESSION['Password'];
        echo "Successful";
        echo "<BR>";
        echo "You are authorized to update the status of Bays.";
        echo "<BR>";
        $Msg = "Redirecting....";
        echo '<script type="text/javascript">  
         alert("' . $Msg . '");  
  </script>';
        header("location:upbstatus.php");
    } elseif ($userName == "" || $passWord == "") {
        $errorMsg = "Data was not entered <br/> Enter Username and Password";
        echo '<script type="text/javascript">  
         alert("' . $errorMsg . '");  
  </script>';
        else {
            $errorMsg = "Data Does Not Match <br/> Re-Enter Username and Password";
            $errorMsg = "Data was not entered <br/> Enter Username and Password";
            echo '<script type="text/javascript">  
         alert("' . $errorMsg . '");  
  </script>';
        }
    } else {
        echo ("  =============== not SET ===============");
    }
?> 
```

它总是返回： =============== not SET ===============

> 我很困惑为什么会这样。有人可以帮忙吗？将不胜感激。
> 谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:39:24.323

您的 onclick ( `onClick="location.href='check.php'"`) 事件处理程序`check.php`在表单可以发出请求之前发出`POST`请求。单击按钮后，它会重定向到向NOT`check.php`发送 GET 请求的按钮。`check.php``POST`

要修复它，您需要将按钮更改为提交类型的输入。

```
 <input type='submit' value='Continue' name='continue' /> 
```

附加信息：

1.  引用数组索引。喜欢`$_POST['Username']`
2.  使用 . 转义 sql 中的参数`mysql_real_escape_string`。或使用准备好的语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:42:58.400

代码有几个问题：

**奇怪的形式行为**

```
<input type=button onClick="location.href='check.php'" value='Continue'       name='continue'/> 
```

你为什么做这个？这根本不会发送用户名和密码字段，因为浏览器将在提交表单之前重定向。如果要在单击时提交表单，请使用`<input type="submit">`

```
<input type="submit" value="Continue" name="continue" /> 
```

**引用数组索引**

```
$userName = $_POST[Username];  
$passWord = $_POST[Password]; 
```

这会导致在 PHP 中发出通知，因为该常量`Username`不存在。改用这个：

```
$userName = $_POST['Username'];
$passWord = $_POST['Password']; 
```

我不会进入`$_POST['Username']`可能无法设置的场景。

**SQL 中的转义变量**

```
$query = "select * from users where Username='".$userName."'and     Password='".$passWord."'"; 
```

这是危险的；您应该正确转义变量：

```
$query = sprintf("select * from users where Username='%s' and Password='%s'",
    mysql_real_escape_string($userName),
    mysql_real_escape_string($passWord)
); 
```

**不要以纯文本形式存储密码**

以纯文本形式存储密码只是自找麻烦。改为使用 bcrypt 存储密码的哈希值。

另请参阅：[PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

**不要使用`mysql_xx`函数**

不推荐使用此功能，而支持[`PDO`](http://www.php.net/pdo)/[`mysqli`](http://www.php.net/mysqli)和准备好的语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:45:58.007

```
<form name="form1" method="POST" action="check.php">  
Username:<br />  
  <input type="text" name="Username" />  
  <br /><br />   
  Password:<br />  
  <input type="password" name="Password" />  
  <br /><br /><br/>  
  <input type="submit" value="Continue" name="continue"/>  
  </form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:40:23.807

单击提交按钮时删除。当你在你的时候，修正你的报价。

# scheme - 如何在Scheme中列出所有出现的给定原子加倍的列表

> ID：14084205
> 
> 赞同：1
> 
> 时间：2012-12-29T17:33:23.810
> 
> 标签：scheme

这是关于我的问题的一个例子。

```
Example:
atom = a
list2 = (a (b c a (a d)))

output = (a a (b c a a (a a d))) 
```

我该如何在计划中做到这一点，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:23:31.290

这个问题的解决方案并不难编程，只要您清楚地了解用于解决它的一般结构即可。因为这看起来像一个家庭作业，我会让你自己找到解决方案，只需填空：

```
(define (double-atoms lst atm)
  (cond ((null? lst)                            ; if the list is empty
         <???>)                                 ; then return the empty list
        ((not (pair? (car lst)))                ; else if the current element is an atom
         (if (equal? (car lst) atm)             ; if the current element == atm
             (<???> (double-atoms <???> atm))   ; then cons two copies of the current element
             (<???> (double-atoms <???> atm)))) ; else cons one copy of the current element
        (else                                   ; else the current element is a list
         (cons (double-atoms <???> atm)         ; then advance the recursion over the car
               (double-atoms <???> atm)))))     ; also advance the recursion over the cdr 
```

它按预期工作：

```
(double-atoms '(a (b c a (a d))) 'a)
=> '(a a (b c a a (a a d))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:45:30.363

我建议以下食谱：

1.  当您处理没有子列表的平面列表时，您如何解决这个问题？
2.  现在，使用相同的方法处理子列表。最初，您可能希望假设子列表是平坦的，但最终您需要处理子列表的子列表。

您需要考虑如何分别解决每个步骤。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-30T13:59:58.410

```
(define (double-atoms l)
  (cond
    ; nothing to double in an empty list
    [(empty? l) '()]
    ; the first element is a list 
    ; => double atoms in it 
    [(pair? (first l))
     (cons (double-atoms (first l))
           (double-atoms (rest l)))]
    ; the first element is an atom, double it
    [else (cons (first l)
                (cons (first l)
                      (double-atoms (rest l))))])) 
```

# c# - 如何将字符串转换为类（泛型）

> ID：14084212
> 
> 赞同：1
> 
> 时间：2012-12-29T17:34:18.733
> 
> 标签：c#, generics, reflection

> **可能重复：**
> [来自字符串值的通用类型](https://stackoverflow.com/questions/7450958/generic-type-from-string-value)

给定一个场景， `Class Car: Transport`, `Class Bus: Transport`, `Interface Transport`,
`Get(): Generics Method`

有可能做这样的事情吗？

```
Transport t= Get<"Car">(string color);

public T Get<T>(string color)
{
  return new T(color);
} 
```

P/S：有理由将其动态分配为字符串，而不管返回类型如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:44:00.780

如果您想`Get`使用字符串，您有两个选择：添加一个`Get`以 Type 作为参数的非泛型，例如：

`public object Get(Type t)`;

因此您可以传递从字符串创建的类型。第二种选择可能是反射：

```
MethodInfo method = typeof(YourType).GetMethod("Get");
MethodInfo generic = method.MakeGenericMethod(myType); 
```

然后您可以调用泛型，就好像它已关闭类型 myType。

如果我可以建议使用哪个，并且如果您可以重构该`Get`方法，我建议添加该方法的非通用版本。如果您确实无法修改库代码，则反射版本有效。正如您可能猜到的那样，使用反射的缺点是性能：您可以决定是否可以继续使用它。

**编辑**

当然，如果您的方法实际上**只是创建最终对象，则我的讨论****不适用**：

 **在这种情况下，激活器通过传递完整的类型名称来发挥魅力：

```
Activator.CreateInstance(Type.GetType("yourtypename")); 
```

您通常可以仅基于简单名称（Car、Bus 等）创建类型，因为如果类型不是 ExecutingAssembly，您需要使用命名空间和程序集完全限定。在这种情况下，您必须使用一些约定/配置来简化代码的可读性。

**添加**

如果您也需要传递参数，我认为您可以尝试开始使用一个简单的**IoC**（我不会特别推荐一个，选择一个您喜欢的广泛使用的），它可以为您解决所有这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:43:34.277

如果您在编译类型时不知道类的名称，您将无法使用泛型。你可以使用`Activator.CreateInstance`：

```
object obj = Activator.CreateInstance(Type.GetType(assemblyQualifiedTypeName)); 
```

这假定您正在创建的类型具有默认构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:42:00.490

使用反射从类型名称中获取对该类型的引用，然后使用它`Activator.CreateInstance`来创建一个实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:42:49.140

不，不是泛型，因为泛型参数需要在编译时解析。

但是，您当然可以将您的类型作为参数中的字符串传递，并让您的方法返回“动态”。

```
var aCar = Get("Car") as Car;

public dynamic Get(string type)
{
  return Activator.CreateInstance(Type.GetType(type));
} 
```**

# html - 如何使表格单元格缩小宽度以仅适合其内容？

> ID：14084221
> 
> 赞同：20
> 
> 时间：2012-12-29T17:35:29.963
> 
> 标签：html, css, css-tables

我希望表格具有 100% 的宽度，但其中只有一列应该有自由宽度，例如：

```
| A | B | C                                                                  | 
```

所以 A 和 B 列的宽度应该与其内容的宽度相匹配，但是 C 的宽度应该一直持续到表格结束。

好的，我可以以像素为单位指定 A 和 B 的宽度，但问题是这些列的内容的宽度不是固定的，所以如果我设置一个固定的宽度，它不会完全匹配内容:(

PS：我没有使用实际的表格项目，而是包装在 div 中的 DL 列表。div 有 display:table，dl 有 display:table-row，dt/dd display:table-cell ...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-29T18:39:27.327

如果我理解你，你有表格数据，但你想使用`div`元素在浏览器中显示它（AFAIK 表和带有 display:table 的 div 的行为基本相同）。

（这里是一个工作 jsfiddle：http: [//jsfiddle.net/roimergarcia/CWKRA/](http://jsfiddle.net/roimergarcia/CWKRA/)）

标记：

```
<div class='theTable'>
    <div class='theRow'>
        <div class='theCell' >first</div>
        <div class='theCell' >test</div>
        <div class='theCell bigCell'>this is long</div>
    </div>
    <div class='theRow'>
        <div class='theCell'>2nd</div>
        <div class='theCell'>more test</div>
        <div class='theCell'>it is still long</div>
    </div>
</div>​ 
```

和CSS：

```
.theTable{
    display:table; 
    width:95%; /* or whatever width for your table*/
}
.theRow{display:table-row}
.theCell{
    display:table-cell;
    padding: 0px 2px; /* just some padding, if needed*/
    white-space: pre; /* this will avoid line breaks*/
}
.bigCell{
    width:100%; /* this will shrink other cells */
}​ 
```

可悲的是一年前我做不到，当时我真的需要它-_-！

# php - 为什么我不能在 PHP 的 DateTime 类中访问 DateTime->date？

> ID：14084222
> 
> 赞同：101
> 
> 时间：2012-12-29T17:35:35.323
> 
> 标签：php, datetime

使用`DateTime`该类，如果我尝试运行以下代码：

```
$mydate = new DateTime();
echo $mydate->date; 
```

我会回复这个错误信息

> 注意：未定义的属性：DateTime::$date...

这没有任何意义，因为在`var_dump()`变量上运行时`$mydate`，它清楚地表明该属性存在并且可以公开访问：

```
var_dump($mydate);

object(DateTime)[1]
  public 'date' => string '2012-12-29 17:19:25' (length=19)
  public 'timezone_type' => int 3
  public 'timezone' => string 'UTC' (length=3) 
```

这是PHP中的错误还是我做错了什么？我正在使用 PHP 5.4.3。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-12-29T17:42:37.637

这是一个[已知问题](https://bugs.php.net/bug.php?id=49382)。

> 可用日期实际上是`var_dump()`这里支持的副作用 – derick@php.net

出于某种原因，您不应该能够访问该属性，但`var_dump`无论如何都会显示它。如果您真的想以该格式获取日期，请使用该[`DateTime::format()`](http://php.net/manual/en/datetime.format.php)功能。

```
echo $mydate->format('Y-m-d H:i:s'); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-29T17:44:55.600

更新：PHP7.3 中的行为发生了变化，原来的答案不再起作用。要在所有 PHP 版本中获得相同的结果，包括。>=7.3，可以使用以下代码：

```
$dt = new DateTime();
$date = $dt->format('Y-m-d\TH:i:s.v'); 
```

* * *

作为记录，原始答案：

除了调用之外，`DateTime::format()`您还可以使用反射访问该属性：

```
<?php

$dt = new DateTime();
$o = new ReflectionObject($dt);
$p = $o->getProperty('date');
$date = $p->getValue($dt); 
```

这比使用稍微快一些，`format()`因为`format()`格式化已经格式化的时间字符串。特别是如果您在循环中多次执行此操作。

然而，这不是 PHP 的记录行为，它可能随时更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-10T05:58:46.307

DateTime 的日期属性受到保护。

您可以使用格式功能显示日期。

```
<?php

try {
    $time = new DateTime();
    echo($time->format("Y-m-d H:i:s"));
} catch (Exception $e) {
} 
```

或者您可以转换为数组：

```
<?php

try {
    $time = (array) new DateTime();
    var_dump($time["date"]);
} catch (Exception $e) {
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-22T03:26:45.197

正如其他答案所指出的，这是 PHP 的一个问题，截至目前尚未解决，但如果它是`var_dump()`我不太确定的“副作用”。

```
echo ((array) new DateTime())['date']; // Works in PHP 7. 
```

我可以肯定的是，*如果*我们打算使用 where的属性，`DateTime`它将已经可用。但就像许多内部类一样，它们*不是*，你不应该依赖“hacky”或“glitchy”方法来修复你的代码。相反，您应该使用他们的[API](http://php.net/manual/en/class.datetime.php)。

```
echo (new DateTime())->format('Y-m-d H:i:s'); 
```

如果您不满意，您可以扩展该类，或者使用为您扩展它的[Carbon](http://carbon.nesbot.com/docs/)。

```
echo (new Carbon())->toDateTimeString(); 
```

如果您了解如何`var_dump()`创建对象的虚假输出，请查看[`__debugInfo()`](http://php.net/manual/en/language.oop5.magic.php#object.debuginfo)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-04-11T13:06:37.907

如果您在询问属性日期之前只使用**var_Dump一切正常：**

```
$mydate = new DateTime();
var_Dump($mydate);
echo '<br>';
echo $mydate->date; 
```

这提供：

```
object(DateTime)#1 (3) { ["date"]=> string(26) "2017-04-11 08:44:54.000000" ["timezone_type"]=> int(3) ["timezone"]=> string(16) "America/New_York" }
2017-04-11 08:44:54.000000 
```

因此，您会看到即使该对象也存在属性日期。我无法理解这种行为。只需将 var_Dump 注释掉，您将再次收到错误消息。

# facebook - 向所有 Facebook 好友发送自定义消息

> ID：14084228
> 
> 赞同：2
> 
> 时间：2012-12-29T17:36:13.707
> 
> 标签：facebook, api, posting

就像[我们在 2010 年制作的视频](http://www.youtube.com/watch?v=E2aPFdu0FNA)一样，今年我们再次制作了一个包含我们所有 Facebook 和非 Facebook 朋友姓名的新年快乐视频。

2010 年，我们有一个自定义应用程序，用于在我们每个朋友的墙上发布一条自定义消息，例如“亲爱的 XXX，祝你新年快乐，这个视频你出现在 1 分 24 秒。”

今年我们也想做同样的事情，即发布一条自定义消息，向我们的每个朋友显示特定信息，但我们注意到 Facebook 对在墙上和私人消息上发帖有限制。

[http://www.facebook.com/help/326534794098501/](http://www.facebook.com/help/326534794098501/)

我们可能会使用 GreaseMonkey/Javascript 和 Dialog API 脚本来使用我们的应用程序，但我们仍然害怕收到一些安全警告。

那么这个项目可行吗？我们的朋友喜欢我们每年制作的视频。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T08:53:20.623

一个确认：尝试通过直接[发送对话框 API](http://developers.facebook.com/docs/reference/dialogs/send/)仅发送消息（在发送大约 60 条消息之后）从 Facebook 服务器端导致错误（错误 500，甚至是空白页面）。

实现这一目标的工作方法是

1.  尝试通过直接的[Feed Dialog API](http://developers.facebook.com/docs/reference/dialogs/feed/)发送 Feed 消息，
2.  测试它是否可能或完成，
3.  如果不成功（时间线被用户阻止），则通过[发送对话框 API](http://developers.facebook.com/docs/reference/dialogs/send/)发送正常消息。

在所有情况下，`redirect_uri`Dialog URL 都必须有一个参数，该参数必须指向应用程序拥有的 URL。所以`app_id`也是强制性的。

这样，您就不会发送太多“正常”消息，因为没有很多人封锁他们的墙，因此您不会被封锁。

这是一个示例 GreaseMonkey/TamperMonkey 代码：

```
// ==UserScript==
// @name       NameOfYourScript
// @namespace  NamespaceOfYourScript
// @version    VersionOfYourScript
// @description  enter something useful
// @match      https://*/*
// @copyright  2012+, You
// @require     https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js
// @grant       GM_getValue
// @grant       GM_setValue
// @grant       GM_openInTab
// ==/UserScript==
var baseapppage = "<URL of a page owned by your application>";
var baseapppagehost = "apps.facebook.com"; var baseapppagepath = "<path to your app>"; 
//Call baseapppage+"?startfbscript=0" to launch the script
//0 is the index at which you want to start
var appid = "<APP ID of the application>";
var titleofvideo ="<title of video>";

var facebook_ids = [
    //put the list of the people to contact here
{"id":"<facebook id of one person>","":"<other arguments for the message>"},
//...
];
var video_url = "<URL of the video to share>";

var message = "<Template of the message to share, with <placeholders> for the person objects>"+
    "\n\nLink of video:"+
    "\n"+video_url+
    "";
//"feed" or "send" (note that "send" only will block you...)
var default_mode = "feed";
//if you lower this, it will be quicker, but may lead to an error
var temporisation = 5*1000;
//updating placeholders in message
function updatemessage(o) {
    var str = message;
    for (var p in o) {
        str = str.replace(new RegExp("<"+p+">","ig"),o[p])
    }
    return str;
}
var automatic = true;
//http://stackoverflow.com/questions/2090551/parse-query-string-in-javascript
function getQueryVariable(variable) {
    var query = document.location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
        }
    }
    console.log('Query variable %s not found', variable);
}
//creating URLs
function createURL(baseurl,data) {
    var datastr = "";
    for (var k in data) {
        if (datastr.length) datastr += "&";
        datastr += encodeURIComponent(k)+"="+   encodeURIComponent(data[k]);
    }
    var separator = baseurl.lastIndexOf("?") >= 0 ? "&" : "?";
    return baseurl + separator + datastr;
}
//arguments for feed page
var feed_arguments = {
    "app_id":appid,
    "name":titleofvideo,
    "link":video_url,
    "redirect_uri":createURL(baseapppage,{"currentfbscript":"1"}),
    //"":"", //caption, description...
};
//arguments for send page
var send_arguments = {
    "app_id":appid,
    "name":titleofvideo,
    "link":video_url,
    "redirect_uri":createURL(baseapppage,{"currentfbscript":"1"}),
    //"":"",
};
//function to open direct dialog API, in mode "feed" or "send", directed to some facebook id
function relocateto(mode, to) {
    var arguments = mode == "feed" ? feed_arguments : send_arguments;
    var baseurl = mode == "feed" ? "https://www.facebook.com/dialog/feed" : "https://www.facebook.com/dialog/send";
    arguments['to'] = to;
    var new_url = createURL(baseurl,arguments);

    if (parseInt(""+GM_getValue("indice",-1)) % 20 == 0) {
        //note : fake reload in other tab because of Chrome memory "leak".
        //Close finished tags to keep memory low.
        console.log("run 'fake reload'...");
        function fake_reload() {
            console.log("...now");
            GM_openInTab(new_url, {active: false, insert: true});
            // close the current window some ms later to allow the insert magic to detect this' tab position
            //note that it unfortunately doesn't work
            window.setTimeout(window.close, 1);
        }
        window.setTimeout(fake_reload, 3000);
    } else {
        document.location = new_url;
    }
}
//wall post page
if (document.location.host == "www.facebook.com" && document.location.pathname == "/dialog/feed") {
    GM_setValue("mode","feed");
    var indice = parseInt(""+GM_getValue("indice",-1));
    if (indice < 0 || indice >= facebook_ids.length) return;
    if (jQuery("input[name=publish]").length) {
        var mes = updatemessage(facebook_ids[indice]);
        setTimeout(function() {
            jQuery("textarea#feedform_user_message").html(mes).val(mes);
            if (automatic) jQuery("input[name=publish]").click();
        },temporisation);
    } else {
        //impossible to send wall message -> send dialog
        relocateto("send", getQueryVariable("to"));
    }
}
//send post page
if (document.location.host == "www.facebook.com" && document.location.pathname == "/dialog/send") {
    GM_setValue("mode","send");
    var indice = parseInt(""+GM_getValue("indice",-1));
    if (indice < 0 || indice >= facebook_ids.length) return;
    if (jQuery("input[name=publish]").length) {
        var mes = updatemessage(facebook_ids[indice]);
        setTimeout(function() {
            jQuery("textarea#feedform_user_message").html(mes).val(mes);
            if (automatic) jQuery("input[name=publish]").click();
        },temporisation);
    } else {
        //impossible to send normal message -> dialogue
        alert("Impossible to send message... index="+indice+" for "+getQueryVariable("to")+"-"+facebook_ids[indice].id);
    }
}
//start or end page
if (document.location.host == baseapppagehost && document.location.pathname == baseapppagepath) {
    if (getQueryVariable("startfbscript")) {
        GM_setValue("mode",default_mode);
        var i = getQueryVariable("startfbscript")
        GM_setValue("indice",i)
        relocateto(default_mode, facebook_ids[i].id);
    } else if (getQueryVariable("currentfbscript") && GM_getValue("mode","feed") == "feed" && document.location.search.indexOf("post_id") < 0) {
        //it didn't work -> sending normal message
        relocateto("send", GM_getValue("lastname",facebook_ids[0].id));
    } else if (getQueryVariable("currentfbscript") && (
                (GM_getValue("mode","feed") == "feed" && getQueryVariable("post_id"))
                || (GM_getValue("mode","feed") == "send" && getQueryVariable("success")))) {
        //it worked -> next name !
        var indice = parseInt(""+GM_getValue("indice",0));
        indice++;
        GM_setValue("indice",indice)
        if (indice >= facebook_ids.length) {
            jQuery("#pagelet_iframe_canvas_content").html("<br/><br/>Finished!");
            return;
        } else {
            console.log("Next id to send to: "+facebook_ids[indice].id);
            jQuery("#pagelet_iframe_canvas_content").html("<br><br/> Running script : " 
                                                          + indice +"/"+facebook_ids.length 
                                                          +"<br> Next : "
                                                          +facebook_ids[indice].id);
        }
        var nextname = facebook_ids[indice].id;
        //next post
        setTimeout (function (){
            relocateto(default_mode, nextname);
        }, temporisation); 
    } else {
        //why are we here if the script is running ? Problem with facebook...
        if (parseInt(""+GM_getValue("indice",0)) < facebook_ids.length) {
            alert("Impossible to post message. Current index = "+GM_getValue("indice",0)+" for "+facebook_ids[parseInt(""+GM_getValue("indice",0))].id);
        }
    }
} 
```

# virtualization - 如何用 Vagrant box 打包文件？

> ID：14084229
> 
> 赞同：7
> 
> 时间：2012-12-29T17:36:13.490
> 
> 标签：virtualization, virtualbox, provisioning, puppet, vagrant

所以我使用以下命令创建了一个 Vagrant 框：

```
vagrant package --base box_name_here --vagrantfile Vagrantfile --include manifests/ 
```

`manifests/`是一个目录，其中包含一个 puppet 清单和一些子目录，其中包含一些在配置过程中使用的文件。在 Vagrantfile 中调用 Puppet，如下所示：

```
config.vm.provision :puppet do |puppet|
    puppet.manifests_path = "manifests"
    puppet.manifest_file  = "web-dev.pp"
end 
```

当我探索 Vagrant 创建的打包 .box 存档时，我看到位于 .box 的文件夹`box_name_here.box/includes/manifests`。但是，`vagrant up`当我尝试运行它时会出现以下错误：

> 为 Puppet 指定的清单路径不存在：c:/vagrant/manifests

文件在其他地方吗？

我看到了这篇文章：[https ://github.com/mitchellh/vagrant/issues/344](https://github.com/mitchellh/vagrant/issues/344)

但答案有点不透明；我不太清楚如何将 modulepath 响应转换为 manifests_path 问题。

我更改了 vagrantfile 以便该行读取

```
puppet.manifests_path = "./manifests" 
```

...但这并没有解决问题。我仍然收到相同的错误消息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T19:47:51.220

经过一些实验，非常明显的答案是：

```
puppet.manifests_path = File.expand_path("../manifests", __FILE__) 
```

# python - pandas 为每个 DatetimeIndex 条目获取第一个过滤行的有效方法

> ID：14084234
> 
> 赞同：4
> 
> 时间：2012-12-29T17:37:37.670
> 
> 标签：python, numpy, pandas, time-series

我有一个具有以下结构的 DataFrame：

```
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 3333 entries, 2000-01-03 00:00:00+00:00 to 2012-11-21 00:00:00+00:00
Data columns:
open          3333  non-null values
high          3333  non-null values
low           3333  non-null values
close         3333  non-null values
volume        3333  non-null values
amount        3333  non-null values
pct_change    3332  non-null values
dtypes: float64(7) 
```

该`pct_change`列包含百分比变化数据。

从上面的 DataFrame 中给定一个过滤的 DatetimeIndex：

```
<class 'pandas.tseries.index.DatetimeIndex'>
[2000-03-01 00:00:00, ..., 2012-11-01 00:00:00]
Length: 195, Freq: None, Timezone: UTC 
```

我想过滤开始**每个**日期条目并返回`pct_change`列低于 0.015 的第一行。

我想出了这个解决方案，但它很慢：

```
stops = []
#dates = DatetimeIndex
for d in dates:
    #check if pct_change is below -0.015 starting from date of signal. return date of first match
    match = df[df["pct_change"] < -0.015].ix[d:][:1].index

    stops.append([df.ix[d]["close"], df.ix[match]["close"].values[0]]) 
```

关于如何改进这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T21:41:07.680

您可能会发现将索引提取为列并使用[`apply`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.apply.html)and会更快[`bfill`](http://pandas.pydata.org/pandas-docs/dev/basics.html#filling-while-reindexing)。
像这样的东西：

```
df['datetime'] = df.index
df['stops'] = df.apply(lambda x: x['datetime']
                                 if x['pct_change'] < -0.015
                                 else np.nan,
                        axis=1)
df['stops'] = df['stops'].bfill() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T19:58:16.477

这个怎么样：

`result = df[df.pct_change < -0.015].reindex(filtered_dates, method='bfill')`

唯一的问题是，如果一个区间不包含低于 -0.015 的值，它将从未来的区间中检索一个。如果添加包含日期的列，您可以看到每行的来源时间，如果检索到的时间戳超过下一个“bin 边缘”，则将 rows 设置为 NA。

# php - jquery清除ajax并隐藏div对象

> ID：14084236
> 
> 赞同：0
> 
> 时间：2012-12-29T17:37:52.570
> 
> 标签：php, jquery, ajax

不知道发生了什么。我正在尝试通过 AJAX 从`index.html`文件上传用户文件，该文件运行 POST `upload.php`，然后将文件短 url 代码返回给用户。

在我的情况下，一旦用户上传文件，它会提供链接，然后如果他通过 F5 去上传另一个没有完整页面刷新的文件，脚本将重新上传以前的文件，新文件会为以前的文件创建另一个短代码和新文件的新短代码

更不用说由于某种原因，一旦上传新文件，带有返回给用户的链接的实际 div 就不会消失，因此用户会获得旧文件的代码和我不完全想要的新文件的代码。

文件上传完成后，POST 不应再拥有它，一旦用户上传新文件，div 应该只有新文件的短代码，但没有 2 个 div 和 2 个不同代码的旧新文件。

这是jQuery代码

```
(function () {
    var input = document.getElementById("images"), 
        formdata = false;

    function showUploadedItem (source) {
        var list = document.getElementById("image-list"),
            li   = document.createElement("li"),
            img  = document.createElement("img");
            a    = document.createElement("a");
        img.src = source;
        li.appendChild(img);
        list.appendChild(li);
        a.href = source;
    }   

    if (window.FormData) {
        formdata = new FormData();
        document.getElementById("btn").style.display = "none";
    }

    input.addEventListener("change", function (evt) {
        document.getElementById("response").innerHTML = "<div class='uploading'></div>"
        var i = 0, len = this.files.length, img, reader, file;

        for ( ; i < len; i++ ) {
            file = this.files[i];

            if (!!file.type.match(/image.*/)) {
                if ( window.FileReader ) {
                    reader = new FileReader();
                    reader.onloadend = function (e) { 
                        showUploadedItem(e.target.result, file.fileName);
                    };
                    reader.readAsDataURL(file);
                }
                if (formdata) {
                    formdata.append("images[]", file);
                }
            }   
        }

        if (formdata) {
            $.ajax({
                url: "upload.php",
                type: "POST",
                data: formdata,
                processData: false,
                contentType: false,
                success: function (res) {
                    document.getElementById("response").innerHTML = res;                    
                }
            });
        }
    }, false);
}()); 
```

您可以在以下位置测试该站点：[cyogen.com](http://cyogen.com)尝试上传一个文件，然后在获得短链接后再上传另一个文件，您就会明白我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:05:26.833

我访问了您在问题中的 url，我注意到`input`您的表单中实际上启用了[允许上传多个文件](http://www.w3schools.com/html5/att_input_multiple.asp)`multiple`的选项，我认为如果您希望每次只上传一个文件，则需要删除此选项。

# android - 无法转储 meminfo 错误：Android 4.2.1

> ID：14084238
> 
> 赞同：0
> 
> 时间：2012-12-29T17:38:15.410
> 
> 标签：android, database, dump

我的 ACRA 错误报告系统出现了一个奇怪的错误，我无法弄清楚是什么原因造成的。我在互联网上搜索，乍一看几乎没有关于这个问题的信息。错误如下：

```
java.lang.Error: Error copying database 
```

//...

```
Permission Denial: can't dump meminfo from from pid=xx, uid=xx without permission android.permission.DUMP 
```

我的问题是，这是否可以通过编码修复，还是由于 android 系统的版本或其他原因？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T19:58:33.683

请参阅此讨论： [https ://code.google.com/p/acra/issues/detail?id=100](https://code.google.com/p/acra/issues/detail?id=100)

不久 - 从 android 4.0 第三方应用程序不能转储任何系统进程信息，例如 meminfo。

# c++ - C 中等效的 C++ 向量

> ID：14084241
> 
> 赞同：6
> 
> 时间：2012-12-29T17:38:50.323
> 
> 标签：c++, c, vector

我有一个看起来像这样的代码（C++）

```
vector<int> values[10000];

int i, j; 
while (.....) {
    scanf("%d%d", &i, &j);
    values[i].push_back(j);
    values[j].push_back(i);
} 
```

但我想将此代码重写为 C。我该怎么做？

我研究了制作自己的堆栈的机会，但也许有更轻量级的方式来重写这段代码，也许是二维数组。到目前为止我还想不出这个翻拍是怎么做的，我希望有经验的人告诉我怎么做:)

抱歉，伙计们，添加了一个更高级的示例...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T17:44:21.343

而不是自己滚动，您可能想尝试一个 C 容器库，例如[http://code.google.com/p/ccl/](http://code.google.com/p/ccl/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T20:28:50.547

像这样的东西：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct _darray
{
    size_t size;
    size_t actual_size;
    int *content;
} darray;

void darray_create(darray *d)
{

    d->actual_size = d->size = 0;
    d->content = NULL;
}

void darray_append(darray *d, int v)
{
    if (d->size+1 > d->actual_size)
    {
    size_t new_size;
    if (!d->actual_size) 
    { 
        new_size = 1;
    }
    else
    {
        new_size = d->actual_size * 2;
    }
    int *temp = realloc(d->content, sizeof(int) * new_size);
    if (!temp)
    {
        fprintf(stderr, "Failed to extend array (new_size=%zu)\n", new_size);
        exit(EXIT_FAILURE);
    }
    d->actual_size = new_size;
    d->content = temp;
    }
    d->content[d->size] = v;
    d->size++;
}

const int* darray_data(darray *d)
{
    return d->content;
}

void darray_destroy(darray *d)
{
    free(d->content);
    d->content = NULL;
    d->size = d->actual_size = 0;
}

size_t darray_size(darray *d)
{
    return d->size;
}

int main()
{
    int i;
    darray myarray;
    const int *a;

    darray_create(&myarray);

    for(i = 0; i < 100; i++)
    {
    darray_append(&myarray, i);
    }
    a = darray_data(&myarray);
    for(i = 0; i < darray_size(&myarray); i++)
    {
    printf("i=%d, value=%d\n", i, a[i]);
    }
    darray_destroy(&myarray);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:42:39.423

C++ 的粗略等价物`vector`是调整大小的 C 数组（以考虑比可用元素更多的元素）。

因此，向量数组的等价物将是指针数组（由于调整大小限制，数组数组不会削减它）。

```
int* values[1000]; 
```

不过，您需要考虑大小，因此您可以在外部执行此操作，也可以将逻辑包装在结构中。

```
int sizes[1000];
int noElements[1000];
// all sizes and noElements initially 0

for (int i = 0; i < 10; i++) {
    if ( noElements[i] >= sizes[i] )
    {
        // allocate more memory for values[i];
        // copy old contents into the new memory
        // update sizes[i]
    }
    values[i][noElements] = 10;
    noElements++;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-14T18:31:27.663

你可以尝试这样的事情：

```
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct vector
{
    int len;
    int allocated;
    int step;
    int *data;
};

#define INIT_SIZE 1

void init_vector(struct vector *v)
{
    v->len = 0;
    v->allocated = 0;
    v->step = 2;
    v->data = NULL;
}

int append(struct vector *v, int item)
{
    if (!v->data)
    {
        v->data = malloc(INIT_SIZE * sizeof(int));

        if (!v->data)
            return -1;

        v->allocated = INIT_SIZE;
    }
    else
        if (v->len >= v-vallocated)
        {
            int *tmp = realloc(v->data, 
                        v->allocated * v->step * sizeof(int));

            if (!tmp)
                return -1;

            v->data = tmp;
            v->allocated *= v->step;
        }

    v->data[v->len] = item;
    v->len++;

    return 0;
}

int delete(struct vector *v, int index)
{
    if (index < 0 || index >= v->len)
        return -1;

    memmove(v->data + index, v->data + index + 1,
                      (v->len - index - 1) * sizeof(int));
    v->len--;

    return 0;
}

void print(const struct vector *v)
{
    printf("Array:\n");

    for (int i = 0; i < v->len; i++)
        printf("%d ", v->data[i]);

    printf("\n");
}

int main(void)
{
    struct vector v;
    int rc;

    init_vector(&v);

    rc = append(&v, 1);
    assert(rc == 0);

    rc = append(&v, 2);
    assert(rc == 0);

    rc = append(&v, 3);
    assert(rc == 0);

    rc = append(&v, 4);
    assert(rc == 0);

    rc = append(&v, 5);
    assert(rc == 0);

    print(&v);

    rc = delete(&v, 2);
    assert(rc == 0);

    print(&v);

    free(v.data);

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-24T07:51:28.383

你可以使用`Gena`图书馆。它与`stl::vector`pure非常相似`C89`。

你可以在这里查看：

[https://github.com/cher-nov/Gena](https://github.com/cher-nov/Gena)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T17:42:13.250

没有与 c++ 向量等效的 C 标准，尽管您可以基于 c++ 中的向量创建一个结构。该结构将

*   如果数组边界超过最大大小，则调整自身大小
*   执行类似于向量的操作

或者

*   创建一个模拟 C++ 向量的链表堆栈结构

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-16T12:52:13.863

您必须使用[动态内存分配](https://en.wikipedia.org/wiki/C_dynamic_memory_allocation)。这并不难。每次必须插入新项目时，只需使用 realloc。有人认为看起来像这样：

```
#include <cstdlib>

typedef struct { } UserType;

int currentSize = 0;
UserType* values;

/// Add new value to values method
void addValue(const UserType& newValue)
{
    ++currentSize;
    values = static_cast<UserType*>(realloc(values, currentSize));
    if (values == NULL)
        // memory allocation filed, place fix code here
        *(values + currentSize) = newValue;
} 
```

`free`请记住，您必须使用`values`. 此外，如果现在结束工作，您可能不会释放分配的内存。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-10T20:48:41.627

我担心您将不得不以 80 年代的方式在普通 C 中使用堆内存。

```
typedef struct tagArrayDesc {
  int* arr;
  size_t top;
  size_t reserved;
} ArrayDesc;

#define EC(NAME, T) size_t ensure_capacity##NAME##(size_t size,            \
                                                   T** vec,                \
                                                   size_t reserved)        \
{                                                                          \
  size_t new_reserved;                                                     \
  new_reserved = reserved;                                                 \
  if (reserved < size) {                                                   \
    if (reserved != 0) {                                                   \
      new_reserved *= 2;                                                   \
    } else {                                                               \
      new_reserved = 0x10;                                                 \
    }                                                                      \
  }                                                                        \
  if (new_reserved < size) {                                               \
    new_reserved = (size * 4) / 3;                                         \
  }                                                                        \
  if (new_reserved > reserved) {                                           \
    *vec = realloc(*vec, sizeof(**vec) * new_reserved);                    \
    memset((*vec) + reserved, 0, sizeof(T) * (new_reserved - reserved));   \
  }                                                                        \
  return new_reserved;                                                     \
}

EC(_int, int)
EC(_array_desc, ArrayDesc)

int main()
{
  ArrayDesc* rows = NULL;
  size_t rows_size = 0;
  size_t rows_reserved = 0;
  while (true) {
    int i, j;
    scanf("%d%d", &i, &j);
    rows_reserved = ensure_capacity_array_desc(i + 1, &rows, rows_reserved);
    rows[i].reserved = ensure_capacity_int(j + 1, &rows[i].arr, rows[i].reserved);
    rows[i].arr[j] = 42;
  }
  return 0;
} 
```

# php - 导致重复内容的错误消息 URL 参数

> ID：14084249
> 
> 赞同：0
> 
> 时间：2012-12-29T17:39:48.843
> 
> 标签：php, redirect, seo

我已经使用 PHP 制作了一个应用程序，我似乎在 Google 中遇到了一些问题（可能还有其他问题），内容重复，或者至少类似的页面被索引。

我正在使用 URL 参数“错误”来通知用户或警告和错误等，但尽管通知 Google“URL 参数”对网站管理员工具中的内容没有影响，但以下两个页面都被编入索引，而且我结果在 WMT 中获得大量索引状态“未选择”页面。

`http://www.myurl.com/a-topic-on-something?error=some+error http://www.myurl.com/a-topic-on-something`

（以上两个页面都是一样的，只是有一个小错误消息通知用户他们的错误）

Web 应用程序通常如何显示错误消息而不会导致重复的内容问题和被索引的参数版本。我可以使用 POST 而不是 GET，但这样做似乎有点愚蠢，只是为了显示一个简单的错误消息。

这可能不是一个大问题，但如果可以的话，我想摆脱任何重复的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:44:55.993

您可以将错误消息存储为会话变量：

```
SESSION['error'] = 'some error'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:01:47.827

您可以简单地收集数组中的任何错误，然后将它们返回到页面并显示它们。

```
$errors = array();

$errors[]= " this is an error";

if($errors)
 {
   return $errors
 } 
```

# javascript - 滚动页面后的jQuery slideUp错误

> ID：14084251
> 
> 赞同：0
> 
> 时间：2012-12-29T17:40:03.730
> 
> 标签：javascript, jquery, html, css

我在使用 jQuery 的 slideUp 和 slideDown 函数时遇到了一些问题。如果你去这个网站

[www.confide.re/confide](http://www.confide.re/confide)

并单击其中一个框，它通常可以正常工作，但是在您滚动页面并加载更多框后，如果您明白我的意思，则滑动功能会出现错误并无缘无故地执行两次。

这是我在某处做错了什么还是这是一个已知的错误？

谢谢

这是代码：

```
var state = 'down';

$('.overlay').click(function() {

     if(state == 'down') {
         $(this).next().slideDown(155);
         state = 'up';
     } else {
         $(this).next().slideUp(150);
         state = 'down';
} 
```

.overlay 是每个盒子顶部的透明 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:01:17.610

像这样在 ajax 成功回调之外定义您的`click`事件（使用更好的选择器`body`，它仅用于示例）

```
$("body").on("click", ".overlay", function(e){
    $(this).next().slideToggle(150);
    $(this).css('background-color', 'rgba(0,0,0,0)');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:51:48.237

你应该这样做：http: [//jsfiddle.net/chanckjh/Jak6Q/](http://jsfiddle.net/chanckjh/Jak6Q/)

html:

```
<div class="something">
    <div class="bar">

    </div>
</div>​ 
```

jQuery：

```
$(function() {
    $('.something').click(function() {
        $('.bar').slideToggle();
    });
});​ 
```

CSS：

```
.something{
    width: 500px;
    height: 500px;
    border: 1px solid red;
}
.bar{
    display: none;
    width: 500px;
    height: 50px;
    background: blue;
}​ 
```

或者像这样给孩子：http: [//jsfiddle.net/chanckjh/Jak6Q/1/](http://jsfiddle.net/chanckjh/Jak6Q/1/)

```
$(function() {
    $('.something').click(function() {
        $(this).find('.bar').slideToggle();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:59:32.157

您不能`state`在需要记录其特定状态的许多元素之间共享单个变量。相反，您必须保持每个元素的状态。

# ruby-on-rails - Rails 路线和模型的问题

> ID：14084254
> 
> 赞同：2
> 
> 时间：2012-12-29T17:40:08.547
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有 2 个模型 - 用户模型和配置文件模型。我已将关系设置如下：

```
class User
  has_one :profile
end

class Profile
  belongs_to :user
end 
```

我有一个具有 4 个操作的配置文件控制器 - 新创建编辑和更新。一旦用户注册或登录，他就会被重定向到 Profiles 控制器中的 New 操作。从这里我如何为该用户创建个人资料？具体来说，我应该在我的新动作和创建动作中拥有什么。现在新操作的路径只是profiles/new，它没有捕获用户参数。我正在尝试这样做，但它失败了。

配置文件控制器

```
def new
    @user = User.find(params[:id])
    @profile = @user.build_profile
  end

  def create
    @profile = current_user.build_profile(params[:profile])
    if @profile.save
      redirect_to current_user
    else
      render new
    end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:52:40.187

配置文件控制器中的`new`操作不需要`id`从参数中获取用户的。所以你的控制器会是这样的

```
def new
  @user = current_user
  @profile = @user.build_profile
end

def create
  @profile = current_user.build_profile(params[:profile])
  if @profile.save
    redirect_to current_user
  else
    render new
  end
end 
```

实际上将`id`用户的 发送到`new`操作可能是一个安全漏洞，因为我可以发送`id`另一个用户的 并为系统中的其他用户创建配置文件，这是不允许的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:53:00.093

你不应该`User.find(params[:id]`在你的新动作中使用。

就像在下面的创建操作中一样，您应该`User`通过`current_user`.

除了无法正确获取之外，还有更多问题`User`吗？

# iphone - box2d 凹体

> ID：14084255
> 
> 赞同：2
> 
> 时间：2012-12-29T17:40:17.973
> 
> 标签：iphone, ios, cocos2d-iphone, box2d, shapes

我正在为我的 iOS 游戏创建一个 box2d 主体，它由 4 个凸形形状构成。问题是调用init方法时失败。这是我的代码：

```
@implementation Banan
-(void)createBodyAtLocation:(CGPoint)location
{
    int num;
    float density = 1.0f;

    b2BodyDef bodyDef;
    bodyDef.type = b2_dynamicBody;
    bodyDef.position = b2Vec2(location.x/PTM_RATIO/RETSIZE, location.y/PTM_RATIO/RETSIZE);
    body = world->CreateBody(&bodyDef);
    body -> SetUserData(self);

    //first shape
    b2FixtureDef fixtureDef1;
    b2PolygonShape shape1;
    num = 4;
    b2Vec2 verts1[4];
        verts1[0].Set(58.9f / PTM_RATIO, 46.3f / PTM_RATIO);
         verts1[1].Set(63.3f / PTM_RATIO, 41.5f / PTM_RATIO);
        verts1[2].Set(47.4f / PTM_RATIO, 15.6f / PTM_RATIO);
         verts1[3].Set(43.6f / PTM_RATIO, 24.3f / PTM_RATIO);
    shape1.Set(verts1, num);
    fixtureDef1.shape = &shape1;
    fixtureDef1.density = density;

    //second
    b2FixtureDef fixtureDef2;
    b2PolygonShape shape2;
    num = 5;
    b2Vec2 verts2[5];
    verts2[0].Set(42.1f / PTM_RATIO, 21.7f / PTM_RATIO);
    verts2[1].Set(46.6f / PTM_RATIO, -0.1f / PTM_RATIO);
    verts2[2].Set(29.1f / PTM_RATIO, -32.2f / PTM_RATIO);
    verts2[3].Set(2.5f / PTM_RATIO, -45.2f / PTM_RATIO);
    verts2[4].Set(6.8f / PTM_RATIO, -10.4f / PTM_RATIO);
    shape2.Set(verts2, num);
    fixtureDef2.shape = &shape2;
    fixtureDef2.density = density;

    //third
    b2FixtureDef fixtureDef3;
    b2PolygonShape shape3;
    num = 4;
    b2Vec2 verts3[4];
    verts3[0].Set(5.6f / PTM_RATIO, -9.7f / PTM_RATIO);
    verts3[1].Set(-0.3f / PTM_RATIO, -45.7f / PTM_RATIO);
    verts3[2].Set(-32.7f / PTM_RATIO, -41.2f / PTM_RATIO);
    verts3[3].Set(-28.2f / PTM_RATIO, -15.7f / PTM_RATIO);
    shape3.Set(verts3, num);
    fixtureDef3.shape = &shape3;
    fixtureDef3.density = density;

    //fourth
    b2FixtureDef fixtureDef4;
    b2PolygonShape shape4;
    num = 4;
    b2Vec2 verts4[4];
    verts4[0].Set(-28.7f / PTM_RATIO, -14.8f / PTM_RATIO);
    verts4[1].Set(-40.8f / PTM_RATIO, -36.0f / PTM_RATIO);
    verts4[2].Set(-60.5f / PTM_RATIO, -2.4f / PTM_RATIO);
    verts4[3].Set(-58.0f / PTM_RATIO, 2.9f / PTM_RATIO);
    shape4.Set(verts3, num);
    fixtureDef4.shape = &shape4;
    fixtureDef4.density = density;

    //attach to shape
    body->CreateFixture(&fixtureDef1);
    body->CreateFixture(&fixtureDef2);
    body->CreateFixture(&fixtureDef3);
    body->CreateFixture(&fixtureDef4);
}
- (id)initWithWorld:(b2World *)tworld atLocation:(CGPoint)location {
    if ((self = [super init])) {
        world = tworld;
        [self initWithFile:@"Banana.png"];
        [self createBodyAtLocation:location];
    }
    return self;
}

-(void)dealloc
{
    [super dealloc];
}
@end 
```

'-initWithWorld: atLocation:' 方法由 ccTouchBegan 方法调用，然后终止我的应用程序。错误如下：

断言失败：（面积 > 1.19209290e-7F），函数 ComputeCentroid，...

```
-(void)createBananaAtLocation:(CGPoint)location
{
    Banan *ban = [[[Banan alloc] initWithWorld:world atLocation:location] autorelease];//fails at this line when is invoked
    [self addChild:ban];

}
-(BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
    CGPoint touchLocation = [touch locationInView:[touch view]];
    touchLocation = [[CCDirector sharedDirector]
                     convertToGL:touchLocation];
    touchLocation = [self convertToNodeSpace:touchLocation];
    b2Vec2 locationWorld =
    b2Vec2(touchLocation.x/PTM_RATIO, touchLocation.y/PTM_RATIO);

    [self createBananaAtLocation:touchLocation]; //error at this line
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:27:38.037

在您的情况下，顶点是顺时针方向的，而 b2Polygon 要求是逆时针方向的。它导致计算多边形的负面积。您必须更改顶点的顺序。

# android - 在 Android 上获取正确的 Laucher 图标大小

> ID：14084259
> 
> 赞同：2
> 
> 时间：2012-12-29T17:40:36.287
> 
> 标签：android, icons, android-launcher

我正在开发一个能够将快捷方式图标添加到主屏幕的应用程序。Android 平板电脑的正确图标大小是多少？（或者更好地说，如何在运行时获取它？）它似乎与[此](http://developer.android.com/guide/practices/ui_guidelines/icon_design_launcher.html)页面上写的不同。我打开了 DisplayMetrics.densityDpi 并相应地更改了图标大小。但它不适用于所有设备..Gnex 似乎没问题，但我的 Galaxy Tab 正在蜂鸣`DisplayMetrics.DENSITY_MEDIUM`设备仅显示 48x48px 图标（如指南中所示），但通常的启动器图标是 72x72 像素而不是 48x48 - 它与指南不同？它是否可能与 TouchWiz UI 有关，因此与纯 Android 不同？或者问题出在哪里？还需要注意的是，应用程序本身会显示正确的启动器图标（它从 hdpi 文件夹中获取图标），但在运行时它看起来像是 mdpi 设备：/ 谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T21:01:14.900

Android 平板电脑在查找启动器图标时会向上看一个桶。这意味着`mdpi`设备实际上会查看`hdpi`文件夹。此代码为启动器图标返回正确的大小

```
 ActivityManager am = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
 int iconSize = am.getLauncherLargeIconSize(); 
```

答案基于[Nick Butcher 的这篇 g+ 帖子](https://plus.google.com/118292708268361843293/posts/ePQya3KsTjW)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:38:04.887

最好的事情是使用[**android assets studio 工具**](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/icons-launcher.html)来完成这项任务。

它会自动创建正确的尺寸并将它们放在正确的文件夹中。

# 3d - 当鼠标在包含它的 div 内移动时，Img 发生变化

> ID：14084270
> 
> 赞同：1
> 
> 时间：2012-12-29T17:42:28.303
> 
> 标签：3d, mouse, perspective

我有预渲染图像序列 3d 场景，所以我想在 Flash 中创建类似的东西，我希望我的图片改变然后鼠标移动，如果我向左移动，图像编号上升，如果我向右移动图像编号下降，是否有可能Javascript 和 Jquery？

[这个 GIF](http://i.stack.imgur.com/OPLw7.gif)最能说明我的意思

# c# - 动态磁贴有时不显示本地生成的图像，但重新固定时会显示？

> ID：14084271
> 
> 赞同：2
> 
> 时间：2012-12-29T17:42:30.593
> 
> 标签：c#, windows-phone-7, live-tile

我有一个奇怪的问题。我根据天气信息在 BackgroundTask 中生成我的动态平铺图像。有时我看到正在生成图像，但图块仅显示其背景颜色而不显示图像（例如，图块是绿色或红色，并且仅显示标题）。

然后，当我移除活动磁贴并将其重新固定到图像确实显示的开始屏幕时。或者，在 Windows Phone 8 上，当我更改大小（小 => 中 => 宽）时，动态磁贴可以很好地显示图像。它有时会发生在背景图像和背景图像上。即使重新启动手机或打开应用程序似乎也有帮助（但不是 100%）。

这似乎是 Windows Phone 操作系统中的一个小错误。可能是什么问题呢？

这是我的代码：

```
using (IsolatedStorageFile ISF = IsolatedStorageFile.GetUserStoreForApplication())
{
    using (IsolatedStorageFileStream imageStream = new IsolatedStorageFileStream("/Shared/ShellContent/Image.jpg",     System.IO.FileMode.Create, ISF))
    {
        writeableTileFinal.SaveJpeg(imageStream, writeableTileFinal.PixelWidth, writeableTileFinal.PixelHeight, 0, 100);
    }
}

ShellTile appTile = ShellTile.ActiveTiles.First();
if (appTile != null)
{
    StandardTileData tileData = new StandardTileData()
    {
        Title = "Title",
        BackContent = string.Empty,
        BackTitle = string.Empty,
        BackgroundImage = new Uri("isostore:/Shared/ShellContent/Image.jpg", UriKind.Absolute),

    };
    appTile.Update(tileData);
} 
```

![显示我的意思的图像：](../Images/6a2db1d10f49c856cde46c4a1913f29b.png)

**更新：**

我似乎已经通过在磁贴更新之前使用 Thread.Sleep 修复了它（之后没有发生）。：

```
Thread.Sleep(2000);

appTile.Update(tileData); 
```

它有效，但有人知道可能是什么问题吗？

# java - Java 工厂模式

> ID：14084272
> 
> 赞同：-3
> 
> 时间：2012-12-29T17:42:34.437
> 
> 标签：java, factory, factory-pattern

这里是工厂的“内部班”？来自 Java Jung 图形包：

```
 Factory<Graph<String, Integer>> graphFactory = new Factory<Graph<String, Integer>>()
   {
       public Graph<String, Integer> create()
       {
           return new SparseMultigraph<String, Integer>();
       }
   }; 
```

我想知道的是上面的编程语言概念是什么？特别是Java中的这个概念是什么？以上是内部类吗？这显然不是一种方法。对我来说这似乎很奇怪，因为它构造了一个 Factory 对象，然后在末尾有一个带有分号的大括号以及一个创建图形的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:45:49.440

这是一个匿名的内部类。上面的代码创建了类的子`Factory`类（或者实现`Factory`接口的类），覆盖了它的`create()`方法，调用了它的构造函数，并将结果赋给了`graphFactory`变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T17:44:13.983

它是一个**匿名内部类**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T17:54:35.263

这是一个匿名内部类的概念。通俗地说，它也可以称为无名类。关于使用此类反对继承的类一直存在争论。通常，如果有子类的一次性使用要求，那么匿名类比继承类更方便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:41:24.883

根据帖子，您似乎知道您正在谈论的是java中匿名类的概念。现在既然你在问这个：答案是，顾名思义，这个类没有名字，因此在一个单步类声明中，类的实例的创建就完成了。由于这个原因，使用匿名类可以节省创建 .java 文件的时间和精力。:) 通常匿名类必须实现超类或接口中的所有抽象方法，并且应该使用超类的所有默认构造函数。

# r - R调查置信区间图

> ID：14084277
> 
> 赞同：1
> 
> 时间：2012-12-29T17:42:52.947
> 
> 标签：r, survey

与 barplot 和 dotchart （来自调查包）类似，barNest（plotrix 包）旨在动态生成 svyby 对象的图，但也绘制置信区间。然而 barNest.svymean 不再处理调查数据。另一种方法是在调查绘图函数点图顶部绘制置信区间

```
library(survey)
data(api)
dclus1<-svydesign(id=~dnum, weights=~pw, data=apiclus1, fpc=~fpc)
#just one variable        
a<-svyby(~api99, ~stype, dclus1, svymean)
#several variables
b<-svyby(~api99+api00, ~stype, dclus1, svymean)
dotchart(b) 
```

虽然我不确定你会怎么做。如果有人能解决这个问题，那么自动化它会非常好（通过创建一些适用于不同大小的 svyby 对象的代码），甚至可能将其合并到 dotchart.svystat {survey} 中。这将使组之间的图形比较更容易！标准误差可以从 b 或使用 SE(b) 提取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T20:01:35.947

对，所以您尝试在不知道如何处理该类的函数（barNest）中使用对象类（svyby），因为调查包和 plotrix 包不能很好地配合使用。幸运的是 svyby 对象的 dotchart 方法代码不多，所以你可能只想修改它..

```
 # run your code above, then review the dotchart method for svyby objects:
    getS3method( 'dotchart' , 'svyby' ) 
```

`b`..从中您可以了解到，在将对象中包含的数据转换为矩阵之后，除了调用原始 dotchart 函数（即不使用 svyby 对象，只是一个常规的统计数据集合）之外，它实际上并没有太多。现在你剩下要做的就是添加一条置信区间线。

置信区间宽度很容易`SE(b)`通过运行获得（比使用更容易）

```
 confint( b ) 
```

你能提取这些统计数据来构建你自己的`barNest`或`plotCI`调用吗？

如果将置信区间放在点图上很重要，那么主要障碍是正确地达到 y 坐标。在dotchart默认方法中挖掘..

```
 getS3method( 'dotchart' , 'default' ) 
```

..你可以看到y坐标是如何计算的。减少到只是必需品，我认为你可以使用这个：

```
 # calculate the distinct groups within the `svyby` object
    groups <- as.numeric( as.factor( attr( b , 'row.names' ) ) )

    # calculate the distinct statistics within the `svyby` object
    nstats <- attr( b , 'svyby' )$nstats

    # calculate the total number of confidence intervals you need to add
    n <- length( groups ) * nstats

    # calculate the offset sizes
    offset <- cumsum(c(0, diff(groups) != 0))

    # find the exact y coordinates for each dot in the dotchart
    # and leave two spaces between each group
    y <- 1L:n + sort( rep( 2 * offset , nstats ) )

    # find the confidence interval positions
    ci.pos <- 
        rep( groups , each = nstats ) + 
        c( 0 , length( groups ) )

    # extract the confidence intervals
    x <- confint( b )[ ci.pos , ]

    # add the y coordinates to a new line data object
    ld <- data.frame( x )

    # loop through each dot in the dotchart..
    for ( i in seq_len( nrow( ld ) ) ){

        # add the CI lines to the current plot
        lines( ld[ i , 1:2 ] , rep( y[i] , 2 ) )

    } 
```

但这显然很笨拙，因为允许置信区间远离屏幕。暂时忽略`svyby`类甚至整个`survey`包，找到我们`dotchart`很好地实现了该格式的置信区间，我们也许可以为您提供更多帮助。我不认为`survey`包裹是你问题的根源:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T08:31:14.453

在 Anthony 的最后一位（来自 ld<-data.frame(x)）中添加一个新的点图（带有最小值和最大值）可以解决他概述的问题。

```
ld <- data.frame( x )
dotchart(b,xlim=c(min(ld),max(ld)))#<-added
for ( i in seq_len( nrow( ld ) ) ){  
  lines( ld[ i , 1:2 ] , rep( y[i] , 2 ) )
} 
```

但是我同意安东尼的观点：情节看起来不太好。非常感谢 Anthony 分享他的知识和编程技巧。置信区间看起来也不对称（这可能是正确的），尤其是对于 M api00。有人把这个和其他软件比较过吗？confit 是否应该指定一个 df（自由度）？

# matlab - 绘制一对多 SVM 中 10 倍交叉验证的结果（使用 LibSVM）

> ID：14084279
> 
> 赞同：0
> 
> 时间：2012-12-29T17:43:12.527
> 
> 标签：matlab, svm, libsvm, cross-validation

我想`libsvmtrain_ova`在这个链接中绘制结果： [10 fold cross-validation in one-against-all SVM (using LibSVM)](https://stackoverflow.com/questions/14024740/10-fold-cross-validation-in-one-against-all-svm-using-libsvm/14083978#14083978)

，我在里面使用了这段代码，`libsvmtrain_ova`但我认为它不能正常工作。

```
hold off
figure();
for j=1:numLabels
   w = models{j}.SVs' * models {j}.sv_coef;
   b = -models{j}.rho;
   c1 = find(double(labels==1) == 1);
   c2= find(double(labels==2) == 1);
   c3=find(double(labels==3) == 1);
   plot(X(c1,1), X(c1,2), 'ko', 'MarkerFaceColor', 'b'); hold on;
   plot(X(c2,1), X(c2,2), 'ko', 'MarkerFaceColor', 'g');hold on;
   plot(X(c3,1), X(c3,2), 'ko', 'MarkerFaceColor', 'r')
   % Plot the decision boundary
   plot_x = linspace(min(X(:,1)), max(X(:,1)), 30);
   plot_y = (-1/w(2))*(w(1)*plot_x + b);
   plot(plot_x, plot_y, 'k-', 'LineWidth', 2)
end
title(sprintf('SVM Linear Classifier with C = %g', 1), 'FontSize', 12) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:40:49.927

您的代码无法正常工作，您似乎遗漏了许多概念性问题。我假设你明白：

*   虹膜数据（参见[链接问题](https://stackoverflow.com/questions/14024740/10-fold-cross-validation-in-one-against-all-svm-using-libsvm?lq=1)）是 4 维的。该空间中的线性分类器是 4 维的超平面，您不能在 2 维平面中绘制 4 维函数。
*   为 3 个类绘制一对多分类器的结果是三个超平面
*   绘制 10 折交叉验证的结果本身是没有意义的，因为没有一个可绘制的结果，您可以绘制每个中间结果，但距离实现这一目标还很遥远。

我仍然认为这里有一个真正的问题。我将获取虹膜数据的二维并绘制分离的超平面（在本例中为线）。当您拥有[链接代码](https://stackoverflow.com/questions/14024740/10-fold-cross-validation-in-one-against-all-svm-using-libsvm?lq=1)时，您需要做的就是以下几点：

*   选择两个维度，在我的例子中，我选择了虹膜数据的维度 3 和 4。
*   将数据分成两部分，一部分用于训练，一部分用于测试。
*   做一点数学并绘制点和线。

这是代码：

```
S = load('fisheriris');
data = zscore(S.meas);
data = data(:,3:4);
labels = grp2idx(S.species);

opts = '-s 0 -t 2 -c 1 -g 0.25';    %# libsvm training options

indices = crossvalidation(labels, 2); 
testIdx = (indices == 1); trainIdx = ~testIdx;
mdl = libsvmtrain_ova(labels(trainIdx), data(trainIdx,:), opts);
figure(1);
numlabels = numel(unique(labels));
testlabels = labels(testIdx);
testdata = data(testIdx,:);
style = {'b+','r+','g+'};
stylel = {'b-','r-','g-'};
for i=1:numlabels,
    plot(testdata(find(testlabels==i),1),testdata(find(testlabels==i),2),style{i});
    hold on;
    w = mdl.models{i}.SVs' * mdl.models{i}.sv_coef;
    b = -mdl.models{i}.rho;
    x = -2:0.1:2
    y = -(w(1)/w(2))*x - (b/w(2));
    plot(x,y,stylel{i});
end

grid on;
hold off; 
```

这是情节：

![在此处输入图像描述](../Images/8fbb767bbc266550c680e06a765e98bb.png)

每条彩色线应将所述颜色的点与所有其他颜色分开。观察线是通过训练获得的，而点来自我们没有训练的测试数据。

# java - 如何使用我的 JTextArea 将我的 GUI 窗口设置为全屏？

> ID：14084281
> 
> 赞同：-3
> 
> 时间：2012-12-29T17:43:37.243
> 
> 标签：java, swing, user-interface, layout-manager

我有一个带有 GUI 窗口的 Java 完整程序，当我按下最大化按钮以全屏显示我的 JTextArea 更大时，我想设置这个窗口。我在我的 GUI 中使用过

```
public final class Test extends javax.swing.JFrame {

private JLabel label1;
private JLabel label2;
private JLabel label3;
private JLabel label4;
private JLabel label5;

private JTextField field1;
private JTextField field2;
private JTextField field3;

private JButton button1;
private JButton button2;
private JButton button3;
private JButton button4;

private JScrollPane scrollpane;

private JTextArea visualization;
private JComboBox list;

public Program_GUI()
{

    this.initialize_graphic_components();  
}

public void initialize_graphic_components()
{
  this.setTitle("Test Program");
  this.setSize(600,400);
  this.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
  this.setMinimumSize(new Dimension(600,400));
  this.setLayout(null);

  this.label2=new JLabel("Username:");
  this.label2.setBounds(20,50,120,20);
  this.add(label2);

  this.field2=new JTextField("");
  this.field2.setBounds(20,70,120,20);
  this.add(field2);

  this.visualization = new JTextArea(420,250);
  this.visualization.setEditable(false);
  this.scrollpane=new JScrollPane(this.visualization);
  this.scrollpane.setBounds(160, 50, 420, 250);
  this.add(scrollpane);

  ............here is the rest program.........

} 
```

这是我的程序的开始，当我按下最大化按钮时，我希望我的窗口伸展到显示器大小以保持一致。
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:23:51.913

您的问题出在这一行：

```
this.setLayout(null); 
```

您希望您的布局能够灵活响应大小的变化，如果您根本不使用布局，您就不能指望这会起作用。再次根据我近一个小时前发布的评论：

> 这完全取决于您使用的布局管理器，您还没有告诉我们。例如，如果持有 JTextArea 的 JScrollPane 由 BorderLayout 使用容器在 BorderLayout.CENTER 位置持有，那么当容器展开时它将向所有方向展开。

阅读[布局管理器教程](http://docs.oracle.com/javase/tutorial/uiswing/layout/index.html)并使用它们。故事结局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:14:56.753

所有容器组件都有一个与之关联的布局。布局是将组件放置在容器上的方法。

默认`JFrame`有`BorderLayout`. `BorderLayout`默认情况下将容器可见区域划分为 5 个部分。在这五个部分`BorderLayout.CENTER`中，当没有组件添加到这些部分时，倾向于将其他部分推到最小宽度/高度并占用空间。

因此，根据您的要求，您应该将组件放在`BorderLayout.CENTER`部分中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:57:37.567

你需要这样的东西

```
 JFrame frame = new JFrame("Text") ;
 frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
 Box box = Box.createHorizontalBox();
 JTextArea area = new JTextArea(10,10);
 box.add(area);
 frame.add(box); 
```

# c# - C# 自定义 CheckBox + 自定义绑定数据类型

> ID：14084283
> 
> 赞同：5
> 
> 时间：2012-12-29T17:43:52.253
> 
> 标签：c#, winforms, user-controls

我创建了自己的复选框（用户控件）。它有一个名为 ControlSource 的属性，用作绑定源。但是，ControlSource 的数据类型也是自定义类型。玩了一圈之后，

```
 ...
    [System.ComponentModel.Bindable(true), Browsable(true), Category("Behavior")]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    public IMyBool ControlSource
    {
        get { return this.chx.Checked ? IMyBool.True : IMyBool.False; }
        set { this.chx.Checked = value.Value; }
    }
    ... 
```

我在这里尝试了一个接口解决方案：

```
 public interface IMyBool
{
    bool Value { get; set; }

    IMyBool True { get; }
    IMyBool False { get; }
}

public class MyBool
{
    protected bool? _bValue = null;

    protected string _sTrue = String.Empty;
    protected string _sFalse = String.Empty;
    protected string _sNull = String.Empty;

    public MyBool(bool? bValue = null)
    {
        this._bValue = bValue;
    }

    public override string ToString()
    {
        return this._bValue.HasValue ? (this._bValue.Value ? _sTrue : _sFalse) : _sNull;
    }

    public bool Value
    {
        get { return this._bValue.Value; }
        set { this._bValue = value; }
    }
}

public class MyInvoiceBool : MyBool, IMyBool
{
    public static implicit operator MyInvoiceBool(bool? bValue)
    {
        return bValue.HasValue ? (bValue.Value ? True : False) : Null;
    }
    public static implicit operator bool?(MyInvoiceBool ivbValue)
    {
        return ivbValue._bValue;
    }

    public MyInvoiceBool(bool? bValue = null)
    {
        base._sTrue = "Rechnung wird gestellt";
        base._sFalse = "Rechnung wird nicht gestellt";
        base._bValue = bValue;
    }

    public static MyInvoiceBool True
    {
        get { return new MyInvoiceBool(true); }
    }
    public static MyInvoiceBool False
    {
        get { return new MyInvoiceBool(false); }
    }
    public static MyInvoiceBool Null
    {
        get { return new MyInvoiceBool(); }
    }
}

public class MyInvoiceAddressBool : MyBool
{
    public static implicit operator MyInvoiceAddressBool(bool? bValue)
    {
        return bValue.HasValue ? (bValue.Value ? True : False) : Null;
    }
    public static implicit operator bool?(MyInvoiceAddressBool ivbValue)
    {
        return ivbValue._bValue;
    }

    public MyInvoiceAddressBool(bool? bValue = null)
    {
        base._sTrue = "Abweichende Rechnungsadresse";
        base._bValue = bValue;
    }

    public static MyInvoiceAddressBool True
    {
        get { return new MyInvoiceAddressBool(true); }
    }
    public static MyInvoiceAddressBool False
    {
        get { return new MyInvoiceAddressBool(false); }
    }
    public static MyInvoiceAddressBool Null
    {
        get { return new MyInvoiceAddressBool(); }
    }
} 
```

我的目标是我可以使用我自己的 bool 数据类型，它知道 true、false 或 null 的替代字符串表达式。但是，groupbox 控件一般应该进行编码。这就是我想到接口解决方案的原因。但是，它不起作用。我很确定有一个“经常使用”的解决方案，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T05:10:26.150

与其扩展数据类型，不如实现一个 IValueConverter 来生成字符串表示？

[http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T12:01:03.313

最后，我选择了一种解决方法：我继承了复选框并明确地将我的自定义数据类型用于控件源属性。因此，我不需要接口或抽象类......它不是最好的解决方案。

# jquery - 使用shoutcast jquery，从lastfm 获取专辑封面

> ID：14084287
> 
> 赞同：3
> 
> 时间：2012-12-29T17:43:57.630
> 
> 标签：jquery, shoutcast, last.fm

使用 wavestreaming jquery 插件（[https://github.com/Wavestreaming/jquery-shoutcast](https://github.com/Wavestreaming/jquery-shoutcast)），我可以从我的服务器获取歌曲信息，以便现在播放

```
$.SHOUTcast({
   host : 'stardust.wavestreamer.com',
   port : 8062,
   interval : 5000,
   stats : function(){
      $('#songtitle').text(this.get('songtitle'));
   }
}).startStats(); 
```

最近玩过。

```
$.SHOUTcast({
   host : 'stardust.wavestreamer.com',
   port : 8062,
   playedInterval : 20000,
   played : function(tracks){
      $('ul').html('');
      $.each(tracks,function(k,track){
         $('ul').append('<li>'+track.title+'</li>');
          ));
   }
}).startPlayed(); 
```

我如何集成 Last FM track.getinfo JSON 响应

```
http://ws.audioscrobbler.com/2.0/?method=track.getinfo&track=(trackname)&artist=(artist)&user='+settings.username+'&api_key='+settings.apikey+'+'&format=json&callback=? 
```

在 img 标签中显示专辑封面，如果有，如果没有，显示默认艺术品？

# python - 在 Shapely 中向现有多边形添加新点

> ID：14084290
> 
> 赞同：7
> 
> 时间：2012-12-29T17:44:05.577
> 
> 标签：python, shapely

如何修改现有的多边形？首先，我想在它的外部添加一个点。

`poly = Polygon([(0, 0), (1, 1), (1, 0)])`

我一直在寻找这样的东西：

`poly.append_at(idx=3, Point(1, -1))`

但我找不到任何类似的方法来做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-02T22:16:28.083

从 的外部添加或删除点是没有意义`Polygon`的，因为无论如何您都想重新计算`poly.area`,`poly.length`等。`Polygon`相反，从旧多边形的坐标创建一个新实例：

```
coords = poly.exterior.coords[:]
coords[1] = (2.0, 6.0) # coordinate to change

new_poly = Polygon(coords) 
```

请注意，这不考虑`poly.interior`.

# ruby-on-rails - Sunspot/Solr 索引项中有一个 `-`

> ID：14084294
> 
> 赞同：1
> 
> 时间：2012-12-29T17:44:17.987
> 
> 标签：ruby-on-rails, ruby, solr, full-text-search, sunspot

我的一个模型中有一个字符串字段，我想为全文搜索编制索引：

```
class Organization < ActiveRecord::Base

  searchable do
    text :name
  end
end 
```

这几乎适用于所有情况，但是，如果我有`Organization`一个名称中带有 a 的 a `-`，例如`Ashlawn-Highlands`，它会将这个词分成两个不同的术语。

因此，如果我搜索`Ashlawn`它会找到组织，或者如果我搜索`Highlands`它会找到组织，但如果我搜索`Ashlawn-H`if 则什么也不返回。

如何让 Solr 正确标记此字符串，包括`-`?

乔

# sql - 等于操作中“SQL_Latin1_General_CP1_CI_AS”和“Modern_Spanish_CI_AS”之间的排序规则冲突

> ID：14084298
> 
> 赞同：3
> 
> 时间：2012-12-29T17:44:37.863
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, collation

我正在创建从 SQL SERVER 2008 R2 到 WINDOWS AZURE 的这个 SQL 函数，但我不知道如何解决这个问题。

> 消息 468，级别 16，状态 9，过程 GetObjectivesByTest，第 69 行无法解决等于操作中“SQL_Latin1_General_CP1_CI_AS”和“Modern_Spanish_CI_AS”之间的排序规则冲突。

```
CREATE FUNCTION [dbo].[GetObjectivesByTest](@testId smallint)
RETURNS 
@res TABLE 
(
    -- Add the column definitions for the TABLE variable here
    ObjectiveId smallint NOT NULL,
    Name nvarchar(50) NOT NULL,
    Expectations nvarchar(400) NULL,
    [Level] nvarchar(5) NOT NULL,
    ParentId smallint NULL,
    LearningSystem nvarchar(30) NULL,
    [Rank] tinyint NULL
)
AS
BEGIN
DECLARE @string VARCHAR(MAX)
SELECT @string = OBJECTIVES FROM TESTS WHERE TestId = @testId

DECLARE @temp TABLE
(  
  ColumnA NVARCHAR(50),
  ColumnB NVARCHAR(500),
  ID INT IDENTITY(1,1)
)

INSERT INTO @temp (ColumnA, ColumnB) VALUES ('', @string)

DECLARE @idx INT, @cnt INT
SET @idx = 1
SELECT @cnt = COUNT(*) FROM @temp

DECLARE @SplitStr nvarchar(1000),
        @SplitChar nvarchar(5), 
        @Columns VARCHAR(50)
SET @SplitChar = ','

WHILE @idx <= @cnt BEGIN
      SELECT @SplitStr = ColumnB
      FROM @temp
      WHERE id = @idx

      DECLARE @RtnValue table 
      (
        ColumnName VARCHAR(50),
        Data VARCHAR(50)
      ) 

      Declare @Count int
      Set @Count = 1

      While (Charindex(@SplitChar,@SplitStr)>0) Begin
        Insert Into @RtnValue (ColumnName,Data)
        Select @Columns, Data = ltrim(rtrim(Substring(@SplitStr,1,Charindex(@SplitChar,@SplitStr)-1))) 

        Set @SplitStr = Substring(@SplitStr,Charindex(@SplitChar,@SplitStr)+1,len(@SplitStr))
        Set @Count = @Count + 1
      End

      Insert Into @RtnValue (ColumnName,Data)

      Select @Columns,Data = ltrim(rtrim(@SplitStr))
      SET @idx = @idx + 1 
END

INSERT @RES   // here is appointing the error
SELECT C.*
FROM Objectives AS C
INNER JOIN OBJECTIVES AS B ON (C.ParentId = B.ObjectiveId)
INNER JOIN OBJECTIVES AS A ON (B.ParentId = A.ObjectiveId)
where C.Rank = 3 AND B.Rank = 2 AND A.Rank = 1 AND
      A.LearningSystem + ' ' + A.Level + '.' + C.Level IN (SELECT Data FROM @RtnValue)

    RETURN 
END 
```

我不知道这个问题，我该如何解决这个不兼容问题。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T18:16:27.470

数据库排序规则 (@RtnValue.Data) 与 Objectives.LearningSysten 中使用的排序规则之间存在排序规则不匹配。

最快的解决方案可能是在@RtnValue 中显式声明排序规则：

```
DECLARE @RtnValue table
(
    ColumnName VARCHAR(50),
    Data VARCHAR(50) COLLATE [insert required collation name]
) 
```

这是一个快速修复，但是，您应该在数据库和表列级别检查排序规则的正确使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T11:53:39.160

排序规则定义 SQL Server 如何比较字符串值，并在 SQL Server 内的各个级别指定：

1.  服务器默认排序规则：在安装 SQL Server 时指定为一个选项，并定义将用于任何新数据库的排序规则，以及主数据库和临时数据库的排序规则。
2.  数据库默认排序规则：这是在创建新数据库时指定的。如果未指定，将使用服务器默认排序规则。此排序规则用于在数据库中创建的任何字符串值列（CHAR、VARCHAR、NCHAR、NVARCHAR）。此排序规则也用作任何字符串值变量和表值变量中的字符串列的默认值。
3.  列排序规则：这是在列级别指定的，并指定用于特定列的排序规则。

您还应该记住一些事情：

1.  将数据库恢复到新服务器时，服务器不会将数据库的排序规则转换为服务器的排序规则。
2.  使用的默认排序规则在不同的上下文中有所不同：T-SQL 中的表值变量和变量使用数据库默认值，而 TempDB 列使用服务器默认值。

您不能隐式比较具有不同排序规则的字符串值。虽然正确的做法是全面使用正确的排序规则，但有一些简单的解决方法。以下是您的选项，按复杂性递增的顺序排列：

*   如果这是一个孤立的查询，其中临时表字符串列与数据库中的相应值进行比较，或者您很着急并且只想让它工作，您可以在`WHERE`子句中指定排序规则。无论何时将数据库中的字符串值与 T-SQL 查询中的局部变量进行比较，都需要执行此操作：

    ```
    WHERE C.Rank = 3 AND B.Rank = 2 AND A.Rank = 1 
        AND A.LearningSystem + ' ' + A.Level + '.' + C.Level COLLATE SQL_Latin1_General_CP1_CI_AS IN (SELECT Data COLLATE SQL_Latin1_General_CP1_CI_AS FROM @RtnValue) 
    ```

*   您的下一个选项，可能是最好的解决方案，是匹配数据库默认排序规则和数据库中所有字符串列中使用的排序规则。更改数据库排序规则就像调用一样简单`ALTER DATABASE MyDB COLLATE SQL_Latin1_General_CP1_CI_AS`，如 MSDN Technet 文章[设置或更改数据库排序规则中所述](http://msdn.microsoft.com/en-us/library/ms175835.aspx)。但是，它不会为您做的是更改数据库中列的排序规则。但是，您可以使用系统表生成一个脚本来为您执行此操作。我的机器上没有 SQL Server，所以我无法对此进行测试，但这会给你一个大致的想法。运行脚本，将结果复制到 SQL 窗格中，然后运行它。

    ```
    WITH cte AS (SELECT o.name AS TableName, c.name AS ColumnName, t.name AS TypeName, c.max_length AS MaxLen
        FROM sys.objects o INNER JOIN sys.columns c ON o.object_id = c.object_id
            INNER JOIN sys.types t ON t.system_type_id = c.system_type_id
        WHERE o.type = 'U'
        AND t.name IN ('char', 'nchar', 'varchar', 'nvarchar'))
    SELECT 'ALTER TABLE ' + TableName + ' ALTER COLUMN ' + ColumnName + ' ' + TypeName + '('
        + CAST(CASE WHEN SUBSTRING(TypeName, 1, 1) = 'n' THEN MaxLen/2 ELSE MaxLen END AS VARCHAR) + ') COLLATE SQL_Latin1_General_CP1_CI_AS'
    FROM cte 
    ```

请注意，使用此解决方案，您仍然需要为临时表中使用的任何列指定排序规则，无论这些列是在存储过程的上下文中还是在原始 T-SQL 命令的上下文中。但是，这是一个很好的做法，因为如果您将此数据库部署到已经拥有自己的数据库服务器并且他们希望使用同一服务器的客户，您不能期望他们必须更改其服务器的默认排序规则。

*   最后，您还可以更改服务器排序规则以匹配数据库和所有列的排序规则。这很麻烦，但可以使用原始设置媒体集来完成，如 MSDN Technet 站点上的[设置和更改](http://technet.microsoft.com/en-us/library/ms179254%28SQL.100%29.aspx "设置和更改服务器排序规则")MSDN Technet 站点上的服务器排序规则所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:19:36.787

这些是丑陋的。我知道解决此问题的两种方法，但都不是那么优雅：

更改其中一个数据库的排序规则以匹配另一个：http: [//msdn.microsoft.com/en-us/library/ms175835(v=sql. 105).aspx](http://msdn.microsoft.com/en-us/library/ms175835(v=sql.105).aspx)

或者更改查询/表中每个列的排序规则以匹配目标数据库： http: [//msdn.microsoft.com/en-us/library/ms190920 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms190920(v=sql.105).aspx)

# android - 使用 sherloack bar 为所有应用程序设置背景颜色

> ID：14084303
> 
> 赞同：1
> 
> 时间：2012-12-29T17:44:58.667
> 
> 标签：android, user-interface, actionbarsherlock, background-color

我想为我所有活动的背景设置白色。仍然没有找到简单的方法，它会将我的文本颜色更改为黑色。我在我的一些活动中使用了 sherloack bar，我认为这是我的问题。我的清单看起来像这样：

```
<application
        android:icon="@drawable/rss"
        android:label="@string/app_name"
        android:theme="@style/CustomTheme"
         >
        <activity
            android:name=".ListRss"
            android:label="@string/title_activity_listr_rss"
            android:theme="@style/Theme.Sherlock" >
        </activity>
        <activity android:name="RssItem" >
        </activity>
        <activity android:name="editRss.AddNewRss">
        </activity>
        <activity android:name="openRssItem.WebActivity" > 
```

我的风格在哪里

```
 <style name="CustomWindowTitleBackground">
        <item name="android:background">#FFFFFF</item>
    </style>

    <style name="CustomTheme" parent="android:Theme">
         <item name="android:background">#FFFFFF</item>
        <item name="android:windowTitleSize">35dip</item>
        <item name="android:windowTitleBackgroundStyle">@style/CustomWindowTitleBackground</item>
    </style> 
```

例如我的活动

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/BackgroundColor"
android:id="@+id/myScreen">
<LinearLayout 
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"

    >

    <ImageView
        android:id="@+id/image"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:scaleType="centerCrop"
        android:src="@drawable/rss" /> 
```

很高兴收到一个简单的解决方案，将背景颜色解决为白色，将文本解决为黑色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:52:29.913

如果您想使用 ActionBarSherlock，则不能`android:Theme`用作主题的父主题（除非您想覆盖所有内容......）。如果你想拥有浅色主题，你必须使用这个：

```
<style name="CustomTheme" parent="Theme.Sherlock.Light">
[...]
</style> 
```

# php - 有没有一种快速通用的方法来使用 php 转储 mySql 查询结果？

> ID：14084304
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:45:05.773
> 
> 标签：php, mysql

我想编写一个远程接口`php`来控制远程服务器上的 MySQL 数据库。

我的策略是这样的：将 SQL 查询发布到某个 php 文件，然后使用`mysql_query()`查询我的 MySQL db，然后使用 php 显示结果。

我的问题来了：如何快速、一般地显示结果（可以显示各种结果，包括不同的表格和错误信息）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:56:04.300

我通常在项目的初始阶段使用这个小功能进行调试，它将结果集输出为表格：

```
function tableFromRS($rs) {
    echo "<table>";
    for ($i = 0; $i < mysql_num_fields($rs); $i++) {
        $field_info = mysql_fetch_field($rs, $i);
        echo "<th>{$field_info->name}</th>";
    }
    while ($red = mysql_fetch_row($rs)) {

        echo "<tr>";
        foreach ($red as $v) {
            echo "<td>$v</td>";
        }
        echo "</tr>";
    }

    echo "</table>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:43:54.000

就像 moonwave99 指出的那样，如果您的问题是管理任务，请使用 phpmyadmin。phpMyAdmin 是 MySQL 的 GUI。使用 phpmyadmin 它来简单地查询您的数据库以用于临时目的，如果您对命令行不满意。当想要更永久地为您的网站使用结果时，请使用 PHP mysqli_* 函数。不要使用 mysql，因为 mysql_* 函数正在逐步淘汰，很快就会被弃用。

# linux - 提供Node.JS webapp“钥匙在手”

> ID：14084307
> 
> 赞同：8
> 
> 时间：2012-12-29T17:45:24.377
> 
> 标签：linux, node.js, web-applications, packaging

我正在为客户端构建一个简单的 Node.JS 应用程序。webapp 应该很容易在每个服务器实例（即 RedHat EL 6.3）上部署，“关键在手”。

打包 Node.JS 应用程序的最佳方式是什么？基本上，我需要一个“安装程序”或“包”来：

*   安装 Node.JS
*   安装依赖项 ( `npm install`)
*   填充应用程序文件（CSS、JS、HTML 等）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T18:26:01.040

您应该提供一个独立的包裹。请查看伟大的网站[The Twelve-Factor App](http://12factor.net/)，特别是[构建、发布、运行](http://www.12factor.net/build-release-run)部分。该网站体现了许多经验丰富的运营工程师来之不易的智慧。

*   在您的应用程序的存储库中，编写一个可以生成可分发存档的脚本（shell、节点等）
*   RPM 或 tar 存档是您最明智的 2 个选择。tar 更便携、更简单。RPM 可以很好地与基于 RPM 的发行版集成。如果您没有做很多软件打包/管理工作，我建议您从 tar 开始。RPM 比 tar 复杂得多。
*   tar 存档应该在其中嵌入 node.js 文件。这将使您的应用程序易于安装，并避免共享系统范围的节点安装，从而造成人为耦合。如果你走 RPM 路线，你可以在你的 RPM 规范文件中指定 node 作为依赖项（但你可能不应该 - 见下文）。
*   存档也应该嵌入所有的 npm 依赖项。不要`npm install`在包安装时运行。考虑在开发期间使用[npm shrinkwrap](http://blog.nodejs.org/2012/02/27/managing-node-js-dependencies-with-shrinkwrap/)工具来管理您的依赖项，但在部署时它们应该预先捆绑并准备好运行。

具体来说，这些是您应该避免的坏主意：

*   安装过程中不要从 Internet 下载任何内容。这是脆弱、缓慢的，并且可能会给您带来糟糕的惊喜，包括安全问题
*   不要在安装时构建可以在构建时构建的工件。所以发布预构建的 CSS 文件、requirejs 优化文件、预编译的二进制文件等。

至于您的应用程序 RPM 是否应该将 node.js 列为依赖项或将节点嵌入到 RPM 中，这里有几点需要考虑。

*   将 node.js 嵌入到您的 RPM 中
    *   单个`.rpm`文件分发
    *   允许您的应用程序严格控制它使用的节点版本。（见下文）
    *   更高的可靠性。事实上，您的应用程序可能至少与您开发的 node.js 的次要版本（例如 0.8.x）或什至补丁版本（例如 >= 0.8.12 < 0.9）紧密耦合。最好允许 node.js 将您的应用程序与操作系统分离，但不要误以为您的应用程序无需测试和调整即可在不同版本的 node.js 上可靠地运行。现在最常见的情况是操作系统上只有一个应用程序运行，并且应用程序之间共享节点的概念错误地重视磁盘空间的节约，而不是应用程序的适当解耦和操作独立性。
    *   目前尚不清楚 yumland 中是否有任何官方/可靠的预构建 RPM 可以“正常工作”。
*   将 node.js 指定为 PRM 的依赖项
    *   遵循操作系统包管理的一般理念（避免重复、节省磁盘空间等）
    *   RPM 在库存管理、卸载、升级等方面提供了超越 TAR 的功能。既然您在问这个问题，您可能还没有准备好正确解决这些问题，因此您可能希望从 tar 开始，并且一旦您对它有了深入的了解，考虑 RPM 升级脚本等。
    *   一旦您的应用程序开始使用数据库或 3，支持电子邮件、日志聚合器等的守护进程，“分发单个文件”的好点很快就会变得站不住脚。

# php - mysql如何加入获取数据

> ID：14084312
> 
> 赞同：-3
> 
> 时间：2012-12-29T17:45:39.893
> 
> 标签：php, mysql, sql, join

> **可能重复：**
> [SQL 查询如何从多个表中返回数据](https://stackoverflow.com/questions/12475850/how-can-an-sql-query-return-data-from-multiple-tables)

我有 3 张桌子

属性

```
attr_id | attr_name 
1       | oval<
2       | white 
```

产品

```
product_id|product_name 
1         | amazonite 
2         | agate 
```

attr_detail

```
attr_detail_id | attr_id | product_id
1              | 1       | 1
2              | 2       | 1
3              | 1       | 2
4              | 2       | 2 
```

现在我想要椭圆形和白色的产品。如何使用加入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:51:51.513

试试这个：

```
SELECT DISTINCT
  p.product_id, 
  p.product_name 
FROM Product p 
INNER JOIN attr_detail ad ON p.product_id = ad.product_Id
INNER JOIN Attribute a    ON a.attr_id = ad.attr_id
WHERE a.attr_id IN(1, 2); 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/d3fdf/1)

这会给你：

```
| PRODUCT_ID |           PRODUCT_NAME |
---------------------------------------
|          1 |              amazonite |
|          2 |                  agate |
|          3 | Product has only white | 
```

* * *

**请注意：**这将为您提供具有`white`或`oval`形状的产品名称。*但是*，如果您只寻找同时具有这两种形状的产品，则必须像这样修改您的查询：

```
SELECT DISTINCT
  p.product_id, 
  p.product_name 
FROM Product p 
INNER JOIN
(
  SELECT product_id
  FROM attr_detail
  WHERE attr_id IN(1, 2)
  GROUP BY product_id
  HAVING COUNT(DISTINCT attr_id) = 2
) ad ON p.product_id = ad.product_Id; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/d3fdf/5)

这会给你：

```
| PRODUCT_ID | PRODUCT_NAME |
-----------------------------
|          1 |    amazonite |
|          2 |        agate | 
```

* * *

请阅读有关`JOIN`s 的更多信息。在这里您可以找到有关此的有用信息：

*   [**^(从维基百科)**](http://en.wikipedia.org/wiki/Join_%28SQL%29)[**加入（SQL）**](http://en.wikipedia.org/wiki/Join_%28SQL%29)。

*   [**SQL 连接的可视化表示**](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)。

*   [**SQL 连接的另一种可视化解释**](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

*   [**SQL Queries for Mere Mortals(R): A Hands-On Guide to Data Manipulation in SQL**](https://rads.stackoverflow.com/amzn/click/com/0201433362)，一本 SQL 基础知识的好书。

对于我在第二个查询中所做的：

```
 SELECT product_id
  FROM attr_detail
  WHERE attr_id IN(1, 2)
  GROUP BY product_id
  HAVING COUNT(DISTINCT attr_id) = 2 
```

这称为[*关系除法*](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)。

# python - python：“可变向量是不可散列的”错误

> ID：14084317
> 
> 赞同：3
> 
> 时间：2012-12-29T17:46:10.427
> 
> 标签：python, sage

我正在使用用 Python 编写的数学包 SAGE。

我正在尝试操作一些向量集，并且不断收到上述错误消息。我完全不知道它告诉我什么，虽然我明白什么是可变的意思有人可以用相当简单的概念术语解释它告诉我什么是错误的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:37:59.673

我假设你正在寻找类似的东西

```
sage: V = vector([1,2,3])
sage: W = vector([3,4,5])
sage: set([V,W])
<snip>
TypeError: mutable vectors are unhashable
sage: 
```

您可以通过以下方式修复此默认设置。

```
sage: V.set_immutable(); W.set_immutable()
sage: set([V,W])
set([(3, 4, 5), (1, 2, 3)]) 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T17:50:47.973

您只能将可散列对象放在[`set`](http://docs.python.org/2/library/stdtypes.html#set-types-set-frozenset)s 中：

> 集合对象是不同的可[散列](http://docs.python.org/2/glossary.html#term-hashable)对象的无序集合。

对于 Python，这意味着对象必须实现一个`__hash__`方法，以及`__eq__`or `__cmp__`。

可变对象不实现这种方法，也不能存储在`set`. 您可以将不可变序列存储为 a `set`，例如 a`tuple`或`frozenset`。

文档中的另一个引用：

> 如果一个对象的哈希值在其生命周期内永远不会改变（它需要一个`__hash__()`方法），并且可以与其他对象进行比较（它需要一个`__eq__()`or`__cmp__()`方法），那么它就是可哈希的。比较相等的可散列对象必须具有相同的散列值。
> 
> 哈希性使对象可用作字典键和集合成员，因为这些数据结构在内部使用哈希值。
> 
> Python 的所有不可变内置对象都是可散列的，而没有可变容器（例如列表或字典）是可散列的。默认情况下，作为用户定义类实例的对象是可散列的；它们都比较不相等，它们的哈希值是它们的`id()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:52:01.467

这意味着 Python 不能使用“向量”的内容来构建集合，因为“向量对象”只是指向其内容的“指针”：内容不是“固定的”，您可以重新使用相同的内容进行更改向量变量（Python 必须重建该集合以使其正常工作）。

因此，您只能对不可变对象（如元组、字符串、数字）使用“集合”。

例如

```
>>> l1 = [1, 2, 3]
>>> l2 = [3, 4, 5]
>>> set([l1, l2])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list' 
```

这是因为您可以更改 l1 和 l2（例如使用 .append）。

```
>>> t1 = (1, 2, 3)
>>> t2 = (3, 4, 5)
>>> set([t1, t2])
set([(3, 4, 5), (1, 2, 3)]) 
```

在这种情况下，您无法更改 t1 和 t2 的内容。

# javascript - 如何在 Android 上的 WebView 中提高 JS 可拖动菜单的性能

> ID：14084318
> 
> 赞同：16
> 
> 时间：2012-12-29T17:46:22.590
> 
> 标签：javascript, android, performance, webview, iscroll

我们在 Android 上的 WebView 中显示了一个 Web 应用程序，并且我们确实需要处理旧的 Android 平板电脑上的性能问题

*   我们正在使用[iScroll-lite](https://github.com/cubiq/iscroll)进行 javascript 拖动
*   我们将硬件加速设置为 true，将渲染优先级设置为高，WebView 仅允许在 80 毫秒间隔内通过一个 MOVE 触摸事件

我们还能做些什么吗？
是否有比 iScroll-lite 更快的替代方案？

我们不知道究竟是什么让它如此缓慢。例如，它可以在具有 1 GHz、512 MB RAM 和 Android 2.3 的手机上顺利运行，但在平板电脑 Qualcomm 1GHz、512 RAM 和 Android 4.0 上运行时你会拖累，实际上你必须等待才能看到结果。我看到的唯一区别是 Android 版本和屏幕分辨率。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T13:58:40.087

毕竟它可能不是Javascript。Android WebViews 往往会出现非常意想不到的性能问题。

尝试停用所有不必要的 CSS，看看性能是否有所提高。如果是这样，您可以迭代地重新添加 CSS 样式以找到罪魁祸首。

并且不要使用任何类型的动画 GIF。我们的经验是，这（很奇怪）会大大降低性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T02:28:57.173

我的建议是你自己写拖拽。这并不难。代码的关键部分如下所示：

```
var yourDomElement = document.getElementById("demoDrag");
yourDomElement.addEventListener("touchstart", function (e) {
    e.preventDefault();
    //todo
});
yourDomElement.addEventListener("touchmove", function (e) {
    //todo: 
});
yourDomElement.addEventListener("touchend", function (e) {
    //todo
}); 
```

[您可以在此处](http://cordova.codeplex.com/)找到许多示例代码（例如 /assets/www/scripts/novas/framwork/nova.Carousel.js，还有 scroller.js）。您应该阅读示例代码以了解如何编写自己的“拖动”。

如果您仍然不知道，您可以联系[我们的团队](http://www.novasoftware.com/developer/PhoneGap.aspx?utm_source=stackover&utm_medium=phonegap&utm_term=phonegap&utm_content=cordova&utm_campaign=leo)为您完成任务。我们制作的 phonegap 应用程序性能非常好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T03:14:36.980

使用 div 并将溢出设置为 auto 然后应用此修复以便可以滚动元素怎么样

[http://chris-barr.com/index.php/entry/scrolling_a_overflowauto_element_on_a_touch_screen_device/](http://chris-barr.com/index.php/entry/scrolling_a_overflowauto_element_on_a_touch_screen_device/)

简短摘录：

```
function touchScroll(id){
    var el=document.getElementById(id);
    var scrollStartPos=0;

    document.getElementById(id).addEventListener("touchstart", function(event) {
        scrollStartPos=this.scrollTop+event.touches[0].pageY;
        event.preventDefault();
    },false);

    document.getElementById(id).addEventListener("touchmove", function(event) {
        this.scrollTop=scrollStartPos-event.touches[0].pageY;
        event.preventDefault();
    },false);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T03:55:40.750

我们试图让 iScroll 在 iPad (2/3) 上的 phonegap 应用程序中顺利工作，但我们无法做到这一点。尽管所有独立示例都运行得非常流畅，但性能仍接近可接受的水平。我们终于使用`-webkit-overflow-scrolling:touch`了，你研究过那个了吗？我知道你在 Android 上需要这个，所以我不能说它是否像在 iOS6 上一样好，但在 iPad 上它就像一个魅力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-12T01:19:00.230

如果您真的想有所作为，我建议您使用我的方法：

我做了一个 JavaScript 可调用函数来创建另一个 WebView（“子 webview”），我会像 Iframe 一样使用它并填充内容，所以从 JS 应用程序我可以这样做：

```
insertWebView (x,y,w,h,"<div>.......</div>"). 
```

你必须做一些一次性的工作来稳定一种通信两个 webview 的方式，但你明白了。请在下面找到我的 insertWebView 函数的来源以获得灵感。

改进非常棒，因为这些微小的 iframe-webview 不仅表现出色，而且像发光的过度滚动、多点触控（现在它们是不同的 webviews！）等提供了接近原生的体验。

我还做了一个扩展，在 webviews 之间使用原生拖放。

可能它在内存方面效率不高，但就用户体验而言，相信我值得一千次努力。

祝你好运！

```
public void insertWebView(int code, int x0, int y0, int w, int h, String url, int vertical, String initContent, String params, int alpha, int rot, int screenId) {

        PlasmaWebView webview1 = getWebView(code);

        if (webview1 != null) {
            if (Conf.LOG_ON) Log.d(TAG, "WEBVIEW: Reusing  webview " + code + " at " + x0 + "," + y0 + "," + w + "," + h + " vertical " + vertical+", rot="+rot);
            webview1.setVerticalScrollBarEnabled(vertical == 1);
            webview1.setHorizontalScrollBarEnabled(vertical != 1);
            webview1.move(x0, y0, w, h, Funq.this);
            if ((alpha>0) && (alpha<100)) webview1.setAlpha((float)alpha/100);
            webview1.setRotation((float)rot/10);
            webview1.handleTemplateLoad(url, initContent);
            return;
        } 

        if (Conf.LOG_ON) Log.d(TAG, "WEBVIEW: Insert webview " + code + " at " + x0 + "," + y0 + "," + w + "," + h + " vertical " + vertical + " url " + url+" alpha "+alpha+", rot="+rot);

        webview1 = new PlasmaWebView(Funq.this.getBaseContext(), code, vertical==1, useHardware, jvs, screenId);
        if ((alpha>0) && (alpha<100)) webview1.setAlpha((float)alpha/100);
        webview1.setRotation((float)rot/10);

        RelativeLayout.LayoutParams p=webview1.createLayout(x0, y0, w, h, Funq.this);
        layerContainer.addView(webview1, p);
        webview1.handleTemplateLoad(url, initContent);
    } 
```

# c++ - 如何在 MFC 基于对话框的应用程序中关闭主窗口

> ID：14084320
> 
> 赞同：1
> 
> 时间：2012-12-29T17:46:35.500
> 
> 标签：c++, mfc

当我想关闭应用程序本身时，任何人都可以回答如何关闭基于 MFC 对话框的应用程序中的主窗口吗？该应用程序是在 MS VS 2010 中创建的。非常感谢您提前。

尤金。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T17:54:12.793

尝试这个：

```
ASSERT( AfxGetMainWnd()!=NULL );
AfxGetMainWnd()->SendMessage(WM_CLOSE); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T17:52:46.070

您可以将 WM_CLOSE 发送到您的对话框 hwnd。PostQuitMessage 还应该允许结束应用程序执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T20:42:24.937

这取决于您希望作为关闭的一部分进行的处理。如果您只想终止消息循环而不进行任何进一步处理，您可以调用`PostQuitMessage( exitCode )`. 将`exitCode`存储为进程的退出代码。

如果您想调用 OK/Cancel 处理程序，您必须分别调用`OnOK()`或`OnCancel()`。的默认实现`OnOK()`将尝试保存和验证对话数据，并在成功执行时调用`EndDialog( IDOK )`终止消息循环。`OnCancel()`简单调用的默认实现`EndDialog( IDCANCEL )`。两者都不允许您为进程指定退出代码。如果您重写了其中任何一个成员函数，则需要在执行专门的代码后调用基类实现，除非您希望防止关闭。

请记住，`OnOK()`并且`OnCancel()`是受保护的成员`CDialog[Ex]`不能从外部直接访问。如果您需要从对话类外部调用任何一个，则必须公开覆盖它们。您可以使用 获取指向主对话框的指针`CMyDialog* pDlg = dynamic_cast< CMyDialog* >( AfxGetMainWnd() );`。

# perl - 找不到 perlbrew 命令

> ID：14084323
> 
> 赞同：4
> 
> 时间：2012-12-29T17:46:53.593
> 
> 标签：perl, perlbrew

我在我的虚拟机上的 Linux backtrack 上安装了 perlbrew。我在回溯中安装了 perl 5.10.1。但是当我在终端中编写 perlbrew 命令时，它会显示以下消息： perlbrew: command not found

我的系统出了什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-29T17:58:48.513

安装时`perlbrew`，系统会指示您添加类似

```
source ~/perl5/perlbrew/etc/bashrc 
```

到您的 shell 启动脚本 ( `.bashrc`)。看来您没有这样做，或者在这样做之后您没有重新启动 shell。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-09-15T15:33:43.377

`sudo apt install perlbrew`全新 Ubuntu18 安装的标准似乎很糟糕（如果我的记忆没有出现故障，Ubuntu20 也是如此）。并且已经有一段时间了。`source ~/perl5/perlbrew/etc/bashrc`即使我附加到 ~/.bash_profile 和/或 ~/.bashrc 并开始一个新的 bash，我也无法让它工作。而且也做到了`perlbrew init`。

最终对我有用的内容`curl -L https://install.perlbrew.pl | bash`取自[https://perlbrew.pl/](https://perlbrew.pl/)在这`which perlbrew`显示正确`/home/me/perl5/perlbrew/bin/perlbrew`而不是`/usr/bin/perlbrew`. 现在我可以看到可用 perl5 版本的完整列表`perlbrew available`。

# backbone.js - 果酱的 grunt-bbb 问题

> ID：14084324
> 
> 赞同：1
> 
> 时间：2012-12-29T17:46:55.343
> 
> 标签：backbone.js, gruntjs

我最近开始使用 bbb 和 grunt-bbb ，目前我在`bbb jam`选择时遇到了问题。

我已经创建了一个项目`bbb:init`，创建了一个测试模块，现在我想将依赖项添加到 codemirror 项目。所以我`"codemirror": "2.35.1"`在 package.json 文件的依赖项部分添加了这句话。

问题是当我执行 bbb jam upgrade 我得到下一个错误：

```
<WARN> Task "upgrade" not found. Use --force to continue. </WARN>

Aborted due to warnings.

Running "jam" task
Error: TypeError: Cannot call method 'apply' of undefined
    at Object.module.exports (/usr/local/lib/node_modules/bbb/tasks/jam.js:52:10)
    at Object.task.registerTask.thisTask.fn (/usr/local/lib/node_modules/bbb/node_modules/grunt/lib/grunt/task.js:58:16)
    at Task.<anonymous> (/usr/local/lib/node_modules/bbb/node_modules/grunt/lib/util/task.js:343:36)
    at Task.start (/usr/local/lib/node_modules/bbb/node_modules/grunt/lib/util/task.js:359:5)
    at Object.grunt.tasks (/usr/local/lib/node_modules/bbb/node_modules/grunt/lib/grunt.js:143:8)
    at Object.module.exports [as cli] (/usr/local/lib/node_modules/bbb/node_modules/grunt/lib/grunt/cli.js:36:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/bbb/bbb.js:98:7)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32) 
```

但是我也安装了果酱，如果我手动运行果酱升级它可以正常工作。

在最后一句之后，codemirror 项目已下载，vendor/jam/r​​equire.config.js 文件已更新，但“require.js”从未加载该库。

有任何想法吗。谢谢。

# iphone - 将我的应用程序缩放为 3.5 英寸屏幕

> ID：14084325
> 
> 赞同：1
> 
> 时间：2012-12-29T17:46:59.517
> 
> 标签：iphone, xcode

我几乎完成了我的第一个应用程序，并考虑到了 4 英寸 iPhone 屏幕。

它仅适用于肖像模式，并且图形不重。我希望它可以在具有 3.5 英寸屏幕的 iphone 4 和 4s 上工作。现在，当我在模拟器中运行应用程序时，它只是从底部切掉了一点以适应 3.5 英寸的屏幕。

有没有办法让我的所有按钮和标签垂直缩小一点以在 3.5 英寸显示屏上工作？

在这种情况下，最简单和最好的做法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:58:12.293

我处理 3.5 英寸和 4 英寸屏幕的一种方法是制作两个单独的 .xib 文件并使用此检查加载适当的文件：

```
if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
{
    CGSize result = [[UIScreen mainScreen] bounds].size;
    if(result.height == 480)
    {
        //Load 3.5 inch xib
    }
    if(result.height == 568)
    {
        //Load 4 inch xib
    }
} 
```

# php - 如何从 PHP 中的 HTML 列表中提取结构化文本？

> ID：14084327
> 
> 赞同：0
> 
> 时间：2012-12-29T17:47:13.573
> 
> 标签：php, html-parsing

我有这个字符串：

```
<ul>
  <li id="1">Page 1</li>
  <li id="2">Page 2
    <ul>
      <li id="3">Sub Page A</li>
      <li id="4">Sub Page B</li>
      <li id="5">Sub Page C
        <ul>
          <li id="6">Sub Sub Page I</li>
        </ul>
      </li>
    </ul>
  </li>
  <li id="7">Page 3
    <ul>
      <li id="8">Sub Page D</li>
    </ul>
  </li>
  <li id="9">Page 4</li>
</ul> 
```

我想用 PHP 分解每一个信息，让它像：

```
----------------------------------
| ID | ORDER | PARENT | CHILDREN |
----------------------------------
|  1 |   1   |   0   |     0     |
|  2 |   2   |   0   |   3,4,5   |
|  3 |   1   |   2   |     0     |
|  4 |   2   |   2   |     0     |
|  5 |   3   |   2   |     6     |
|  6 |   1   |   5   |     0     |
|  7 |   3   |   0   |     8     |
|  8 |   1   |   7   |     0     |
|  9 |   4   |   0   |     0     |
---------------------------------- 
```

有关更多信息，这就是此列表对我的意义：

ID 1是第1 (第1页)并且有0个父母和0个孩子，

ID 2 是第 2 个（第 2 页）并且有 0 个父母和孩子 ID 3、4、5，

ID 3 是第 1 个（子页面 A）并且有父 ID 2 和 0 个孩子，

ID 4 是第 2 个（子页面 B）并且有父 ID 2 和 0 个孩子，

ID 5 是第 3 个（子页面 C），具有父 ID 2 和子 ID 6，

ID 6 是第 1 个（子页面 I）并且有父 ID 5 和 0 个孩子，

ID 7 是第 3 个（第 3 页）并且有 0 个父母和孩子 ID 8，

ID 8 是第 1 个（子页面 I）并且有父 ID 7 和 0 个孩子，

ID 9 是第 4 个（第 4 页），有 0 个父母和 0 个孩子。

如果这太难了，任何人都可以建议如何使用另一种方法从该字符串中获取该信息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:54:42.977

那不是“字符串”，而是 HTML。您需要使用像[DOMDocument](http://php.net/manual/en/class.domdocument.php)或[simple_html_dom](http://simplehtmldom.sourceforge.net/)这样的 HTML 解析器。

[请参阅http://htmlparsing.com/php.html](http://htmlparsing.com/php.html)中的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:28:15.253

你可以在这里划分问题。一件事是解析 HTML，这很容易用`DOMDocument`and完成`DOMXpath`。那是在另一个 xpath 表达式/查询的结果的上下文中运行一些映射。听起来可能有点复杂，但事实并非如此。在更简化的变体中，您可以在先前对[Get parent element through xpath and all child elements](https://stackoverflow.com/a/14013950/367456)的回答中找到这一点。

在您的情况下，这有点复杂，一些伪代码。我添加了标签，因为它使事情更加明显以用于演示目的：

```
foreach //li ::
    ID       := string(./@id)
    ParentID := string(./ancestor::li[1]/@id)
    Label    := normalize-space(./text()[1]) 
```

如图所示，这仅返回裸数据。你也有骑士团和孩子们。通常不需要儿童列表（无论如何我都保留在这里）。Order 值和 Children 值之间的相似之处在于它们是从上下文中检索的。

例如，`//li`在按文档顺序遍历节点列表时，如果每个 ParentID 都保留一个计数器，则可以对每个子节点的顺序进行编号。

与 Children 类似，就像计数器一样，需要在迭代列表时构建该值。只有在最后，每个列表项的正确值才可用。

所以这两个值在一个上下文中，我以 ParentID: 键控的数组的形式创建该上下文`$parents`。对于每个 ID，它将包含两个条目：0 包含 Order 的计数器，1 包含一个数组以保存 Children 的 ID（如果有）。

> ***注意：****从技术上讲，这并不完全正确。Order 和 Children 也应该可以在纯 xpath 中表达，我只是在这个示例中没有这样做来展示如何添加您自己的非 xpath 上下文，例如，如果您想要不同的 ordering 或 children 处理。*

理论就够了。考虑标准设置：

```
$doc = new DOMDocument();
$doc->loadHTML($html);
$xp = new DOMXPath($doc); 
```

所述映射包括。它的上下文可以写成匿名函数：

```
$parents = [];

$map = function (DOMElement $li) use ($xp, &$parents) {

    $id       = (int)$xp->evaluate('string(./@id)', $li);
    $parentId = (int)$xp->evaluate('string(./ancestor::li[1]/@id)', $li);
    $label    = $xp->evaluate('normalize-space(./text()[1])', $li);

    isset($parents[$parentId][0]) ? $parents[$parentId][0]++ : ($parents[$parentId][0] = 1);
    $order                   = $parents[$parentId][0];
    $parents[$parentId][1][] = $id;
    isset($parents[$id][1]) || $parents[$id][1] = [];

    return array($id, $label, $order, $parentId, &$parents[$id][1]);
}; 
```

如您所见，它首先包含对伪代码中的值的检索，第二部分包含对上下文值的处理。如果 ID / ParentID 不存在，它只是初始化上下文。

需要应用此映射：

```
$result = [];
foreach ($xp->query('//li') as $li) {
    list($id) = $array = $map($li);
    $result[$id] = $array;
} 
```

这将`$result`包含项目列表和`$parents`上下文数据。由于使用了引用，现在需要对 Children 值进行内爆，然后可以删除引用：

```
foreach ($parents as &$parent) {
    $parent[1] = implode(',', $parent[1]);
}
unset($parent, $parents); 
```

这会`$result`产生可以输出的最终结果：

```
echo '+----+----------------+-------+--------+----------+
| ID |     LABEL      | ORDER | PARENT | CHILDREN |
+----+----------------+-------+--------+----------+
';
foreach ($result as $line) {
    vprintf("| %' 2d | %' -14s |  %' 2d   |   %' 2d   | %-8s |\n", $line);
}
echo '+----+----------------+-------+--------+----------+
'; 
```

然后看起来像：

```
+----+----------------+-------+--------+----------+
| ID |     LABEL      | ORDER | PARENT | CHILDREN |
+----+----------------+-------+--------+----------+
|  1 | Page 1         |   1   |    0   |          |
|  2 | Page 2         |   2   |    0   | 3,4,5    |
|  3 | Sub Page A     |   1   |    2   |          |
|  4 | Sub Page B     |   2   |    2   |          |
|  5 | Sub Page C     |   3   |    2   | 6        |
|  6 | Sub Sub Page I |   1   |    5   |          |
|  7 | Page 3         |   3   |    0   | 8        |
|  8 | Sub Page D     |   1   |    7   |          |
|  9 | Page 4         |   4   |    0   |          |
+----+----------------+-------+--------+----------+ 
```

您可以在[此处在线找到演示](http://eval.in/5544)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T21:52:47.367

我留下第二个答案，因为这一次演示了如何使用单个映射（在伪代码中）来做到这一点：

```
foreach //li ::
    ID       := string(./@id)
    ParentID := string(./ancestor::li[1]/@id)
    Label    := normalize-space(./text()[1])
    Order    := count(./preceding-sibling::li)+1
    Children := implode(",", ./ul/li/@id) 
```

因为这可以在每个`li`节点上完成，无论以何种顺序，这可能是一个完美的匹配[`Iterator`](http://php.net/class.Iterator)，这里是当前函数：

```
public function current() {

    return [
        'ID'       => $this->evaluate('number(./@id)'),
        'label'    => $this->evaluate('normalize-space(./text()[1])'),
        'order'    => $this->evaluate('count(./preceding-sibling::li)+1'),
        'parentID' => $this->evaluate('number(concat("0", ./ancestor::li[1]/@id))'),
        'children' => $this->implodeNodes(',', './ul/li/@id'),
    ];
} 
```

完整示例（[Demo](http://eval.in/5545)）输出和代码：

```
+----+----------------+-------+--------+----------+
| ID |     LABEL      | ORDER | PARENT | CHILDREN |
+----+----------------+-------+--------+----------+
|  1 | Page 1         |   1   |    0   |          |
|  2 | Page 2         |   2   |    0   | 3,4,5    |
|  3 | Sub Page A     |   1   |    2   |          |
|  4 | Sub Page B     |   2   |    2   |          |
|  5 | Sub Page C     |   3   |    2   | 6        |
|  6 | Sub Sub Page I |   1   |    5   |          |
|  7 | Page 3         |   3   |    0   | 8        |
|  8 | Sub Page D     |   1   |    7   |          |
|  9 | Page 4         |   4   |    0   |          |
+----+----------------+-------+--------+----------+

class HtmlListIterator extends IteratorIterator
{
    private $xpath;

    public function __construct($html) {

        $doc = new DOMDocument();
        $doc->loadHTML($html);
        $this->xpath = new DOMXPath($doc);
        parent::__construct($this->xpath->query('//li'));
    }

    private function evaluate($expression) {

        return $this->xpath->evaluate($expression, parent::current());
    }

    private function implodeNodes($glue, $expression) {

        return implode(
            $glue, array_map(function ($a) {

                return $a->nodeValue;
            }, iterator_to_array($this->evaluate($expression, parent::current())))
        );
    }

    public function current() {

        return [
            'ID'       => $this->evaluate('number(./@id)'),
            'label'    => $this->evaluate('normalize-space(./text()[1])'),
            'order'    => $this->evaluate('count(./preceding-sibling::li)+1'),
            'parentID' => $this->evaluate('number(concat("0", ./ancestor::li[1]/@id))'),
            'children' => $this->implodeNodes(',', './ul/li/@id'),
        ];
    }
}

print_result(new HtmlListIterator($html));

function print_result($result) {

    echo '+----+----------------+-------+--------+----------+
| ID |     LABEL      | ORDER | PARENT | CHILDREN |
+----+----------------+-------+--------+----------+
';
    foreach ($result as $line) {
        vprintf("| %' 2d | %' -14s |  %' 2d   |   %' 2d   | %-8s |\n", $line);
    }
    echo '+----+----------------+-------+--------+----------+
';
} 
```

# javascript - 需要 Openlayers 指南来满足我的要求

> ID：14084328
> 
> 赞同：1
> 
> 时间：2012-12-29T17:47:16.853
> 
> 标签：javascript, openlayers, postgis, geoserver

我的目标：使用 Openlayers + geoserver + POSTGIS，

1.  显示谷歌地图。
2.  在浏览器中从地理服务器向用户显示图层，
3.  允许用户编辑图层的功能，
4.  将最终用户新添加的特征持久化到 POSTGIS 数据库中

我的状态 ：

1.  我可以显示谷歌地图。
2.  使用 postgis shapefile 导入/导出管理器将 SHAPEFILES(.shp) 加载到 POSTGIS DB
3.  在 GEOSERVER ADMIN CONSOLE 中添加了一个工作区。
4.  在 GEOSERVER ADMIN CONSOLE 中添加了一个 DATASOURCE。

我的问题 ：

1.  无法在浏览器中显示图层。
2.  无法在 EDIT LAYER SCREEN 的“Feature Type Details”下找到 TYPE GEOMETRY。

**参考文献**：

简单 HTML 页面中的 WFS 代码：

```
var wfs = new OpenLayers.Layer.Vector("USACITIES",
{
    strategies: [new OpenLayers.Strategy.Fixed()],
    projection: new OpenLayers.Projection("EPSG:4326"),
    protocol: new OpenLayers.Protocol.WFS({
        version: "1.1.0",
        url: "http://localhost:8080/geoserver/wfs",
        featurePrefix: 'usa', //geoserver worspace name
        featureType: "usa:states", //geoserver Layer Name
        featureNS: "http://usa.opengeo.org", // Edit Workspace Namespace URI
        geometryName: "the_geom" // field in Feature Type details with type "Geometry"
    })
});
map.addLayer(wfs); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T09:16:23.397

我认为您的代码中有一个错误：

```
featureType: "usa:states", //geoserver Layer Name 
```

我认为这应该是

```
featureType: "states", //geoserver Layer Name 
```

因为前缀已经用 featureNS 定义了

至于 Geoserver 中的“特征类型详细信息”：检查 Postgres 如果您的表有“the_geom”或“geom”列并且它的类型是几何。

# javascript - 实现 mediaElement.js 会导致错误

> ID：14084330
> 
> 赞同：0
> 
> 时间：2012-12-29T17:47:25.533
> 
> 标签：javascript, joomla, media-player, media

我正在尝试在我正在开发的 Joomla 网站中实施 mediaElement.js 解决方案，但我遇到了一些问题。以下错误在我的梦中困扰着我：P：

```
Uncaught TypeError: Object [object Object] has no method 'mediaelementplayer' 
```

我会假设 /mediaelement-and-player.min.js 但控制台不显示任何错误，除了已经提到的错误。

我在模板头中添加了以下内容：

```
$this->API->addJS($this->API->URLtemplate() . '/mediaElement/build/mediaelement-and-player.min.js');
$this->API->addJS($this->API->URLtemplate() . '/mediaElement/build/jquery.js'); 
```

这会在页面加载时产生正确的链接，所以我想这不会是问题。

在我的文章正文中，我添加了以下代码：

```
<video id="youtube1" width="640" height="360">
  <source src="http://www.youtube.com/watch?v=nOEw9iiopwI" type="video/youtube" >
</video>

<script>
   jQuery(document).ready(function($) {
      $('#youtube1').mediaelementplayer();
   });

</script> 
```

尽管此代码来自提供的示例，但它会导致前面提到的错误。

对此的任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:55:30.143

我不确定该文件是否被正确包含，因为我看不到该网站，因此请尝试包含**jquery.js**和**mediaelement-and-player.min.js**

```
$document = JFactory::getDocument();
//check to see if jquery is already being loaded
if(!JFactory::getApplication()->get('jquery')){
     JFactory::getApplication()->set('jquery',true);
     $document->addScript(JURI::root() . "templates/template_name/mediaElement/build/jquery.js");
}
$document->addScript(JURI::root() . "templates/template_name/mediaElement/build/mediaelement-and-player.min.js"); 
```

不要忘记在上面的代码中更改该路径中的**template_name 。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:28:35.883

谢谢大家的意见。

我找到了问题和解决方案：D。

从 head.php 中删除这一行

```
$this->API->addJS($this->API->URLtemplate() . '/mediaElement/build/jquery.js'); 
```

解决了我的问题。

我想这是因为我正在使用的模板已经加载了 jQuery。

我希望这将在未来保护其他人。

快乐编码！

# ios - 设备方向更改问题

> ID：14084331
> 
> 赞同：0
> 
> 时间：2012-12-29T17:47:38.617
> 
> 标签：ios, uiviewcontroller

我`viewController1`有一个子视图控制器 ( `viewController2`)。`viewController2.view`是 的视图的子`viewController1`视图。在用户的操作中，我`viewController2`从它的超级视图中删除了视图。过了一会儿，我必须再次将其添加为子视图。

问题是，如果用户在`viewController2`不可见的情况下旋转设备，在再次将其添加到 viewController1 的视图后，它的框架和子视图将被放置，因为设备仍处于旧方向。甚至`viewController2.view.frame`具有高度和互换性。

有人对此有解决方案吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:40:18.183

如果没有看到您的代码，我猜您会保留对视图控制器 2 的引用，即使它不可见。在这种情况下，您需要将视图旋转事件转发给控制器，以便它知道这样的旋转（对您要转发的每个事件执行此操作）：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    [super willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration];

    // Forward to view controller 2 if it is not displayed
    if (!viewController2.view) {
        [viewController2 willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration];
    }
} 
```

更好的设计可能是将视图控制器 2 的视图设置为`hidden`而不是删除它，它仍然会在没有人工干预的情况下获取事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:31:15.380

让我猜猜你的问题。你想根据方向显示不同的 UIView ，对吗？

这是关于更新您`viewController2`以根据方向加载笔尖。您可以根据方向制作横向和纵向笔尖以支持您的不同 UI。试着从这个[答案看](https://stackoverflow.com/a/2734710/696088)

希望对你有帮助

# .net - 我该如何解决？错误：选择不是“System.Collections.Generic.List(Of String)”的成员

> ID：14084333
> 
> 赞同：3
> 
> 时间：2012-12-29T17:47:54.863
> 
> 标签：.net, vb.net, .net-2.0, sorting

不断出现错误：“Select”不是“System.Collections.Generic.List(Of String)”的成员。

我正在渲染 x86 并使用框架 2.0（因为它对于我正在使用的直接播放器来说是不必要的）

我该如何解决？还是有另一种方法可以做到这一点？

此函数的目的只是对数组进行排序。

![在此处输入图像描述](../Images/7b6d5aab12bf12228e853bdb937a9f92.png)

代码：

```
Position15 = Sortlinks(Position15)

    End Sub
    Private Function Sortlinks(ByVal Info As List(Of String))
        Dim order() As Integer = Info.Select(Function(s) If(s.Contains("Facebook.com"), 0, If(s.Contains("Twitter.com"), 1, If(s.Contains("MySpace.com"), 2, If(s.Contains("Youtube.com"), 3, If(s.Contains("Linkedin.com"), 4, -1)))))).ToArray
        Dim temp() As String = Info.ToArray

        Array.Sort(order, temp)
        Info = temp.ToList
        Return Info
    End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:52:54.757

`Select`是一种 LINQ 扩展方法，在 .NET 3.5 中引入，因此不适用于 .NET 2.0。您必须以 .NET Framework 3.5 或更高版本为目标才能使用它。

# opengl-es - OpenGL ES 2.0 - 如何批量绘制具有独特平移、旋转、缩放和 alpha 的粒子？

> ID：14084334
> 
> 赞同：2
> 
> 时间：2012-12-29T17:48:12.370
> 
> 标签：opengl-es, opengl-es-2.0, vertex-array

我已将许多粒子的所有顶点数据组合到一个数组中。我如何以保留其独特翻译的方式批量绘制所有这些粒子？

我很困惑如何做到这一点。我已经在这个问题上创建了两个帖子，但仍然感到困惑。我目前正在使用 OpenGL ES 1.1，但如果这意味着我实际上可以通过独特的平移、旋转等完成粒子的批量渲染，我愿意升级到 2.0。

这两个帖子是：

*   [OpenGL ES - 如何批量渲染 500 多个具有不同 alpha、旋转和缩放的粒子？](https://stackoverflow.com/questions/11787709/opengl-es-how-to-batch-render-500-particles-w-different-alphas-rotations-a)
*   [如何在 iPhone OpenGL ES 粒子系统中绘制 1000 多个粒子（带有独特的旋转、缩放和 alpha）而不减慢游戏速度？](https://stackoverflow.com/questions/7435123/how-do-i-draw-1000-particles-w-unique-rotation-scale-and-alpha-in-iphone-o)

两者都解释了一种高级方法，但我需要知道**如何渲染这批粒子，其中每个粒子的平移、旋转和缩放都会改变每一帧**。如果您的答案是计算 CPU 上的翻译，那么请举一个例子。

我目前在我的实现中使用顶点数组对象。我知道我应该使用 VBO 以获得最佳性能。我将实现 VBO，但首先我想实现批处理。成功完成批处理后，我会将 VAO 更改为 VBO。因此，这个问题的重点是如何使用 VAO 来实现这一点。

这是我在批处理之前的代码，我将在模型视图矩阵中推送一个新矩阵，根据当前正在渲染的 Actor 进行平移、旋转、缩放和 alpha，并绘制当前正在渲染的 Actor 的顶点和纹理坐标：

```
 glPushMatrix();

    glTranslatef(translation.x, translation.y, translation.z);

    // rotation
    glRotatef(rotation.x, 1, 0, 0);
    glRotatef(rotation.y, 0, 1, 0);
    glRotatef(rotation.z, 0, 0, 1);

    // scale
    glScalef(scale.x, scale.y, scale.z);

    // color and alpha
    glColor4f(1.0, 1.0, 1.0, alpha);

    glVertexPointer(2, GL_FLOAT, 0, aSprite.vertices);
    glEnableClientState(GL_VERTEX_ARRAY);

    glTexCoordPointer(2, GL_FLOAT, 0, texturedQuad.textureCoords);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    glDrawArrays(GL_TRIANGLES, 0, 6);

    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glPopMatrix(); 
```

现在，鉴于我已将所有粒子 Actor 的顶点和纹理坐标组合到批处理数组中，我想在模型视图矩阵中推送一个新矩阵，并以适当的平移、旋转、比例绘制这些 Actor 的顶点和纹理坐标，阿尔法等。

所以我的猜测是它看起来像：

```
 static GLFloat verticesBatched[appropriate_length] = ...; // I have a method to populate this array based on the Actors to render

    static GLFloat textureCoordsBatched[appropriate_length] = ...; // I have a method to populate this array based on the Actors to render

    glPushMatrix();

    // perform CPU matrix manipulation to manually translate, rotate, and scale all vertices         

    glVertexPointer(2, GL_FLOAT, 0, verticesBatched);
    glEnableClientState(GL_VERTEX_ARRAY);

    glTexCoordPointer(2, GL_FLOAT, 0, textureCoordsBatched);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    glDrawArrays(GL_TRIANGLES, 0, 6);

    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glPopMatrix(); 
```

一个有效的答案是一个**代码示例**，它清楚地说明了这个问题的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T12:14:48.640

由于所有粒子具有相同的纹理，这将完成工作：

```
float squarevData[12]={
    -1,1,
    1,1,
    -1,-1,
    1,1,
    1,-1,
    -1,-1,
};
float squarevDataSteady[12]={
    -1,1,
    1,1,
    -1,-1,
    1,1,
    1,-1,
    -1,-1,
};

class BatchRenderer
{
public:
    float* partVdata;
    float* partCdata;
    float* partTdata;
    bool isanydrawed;
    int counter1,counter2,counter3;
    int count;
    bool isz;
    bool textured;
    void Innit(int maxTextures,bool iszi)
    {
        isz=iszi;
        if(isz)partVdata=(float*)malloc(maxTextures*18*4);
        else partVdata=(float*)malloc(maxTextures*12*4);

        partCdata=(float*)malloc(maxTextures*24*4);
        partTdata=(float*)malloc(maxTextures*12*4);

        isanydrawed=false;
    }
    void Draw(float x,float y,float z,float scalex,float scaley,float angle,float r,float g,float b,float a)
    {
        isanydrawed=true;

        angle*=0.017453f;
        for(int c2=0;c2<12;c2+=2)
        {
            float x=squarevData[c2]*scalex;
            float y=squarevData[c2+1]*scaley;
            float cos1=cos(angle);
            float sin1=sin(angle);
            squarevDataSteady[c2] = (cos1*x) - ( sin1*y);
            squarevDataSteady[c2+1] = (sin1*x) + ( cos1*y);
        }

        partVdata[counter1++]=x+squarevDataSteady[0];
        partVdata[counter1++]=y+squarevDataSteady[1];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=0;
        partTdata[counter3++]=1;

        partVdata[counter1++]=x+squarevDataSteady[2];
        partVdata[counter1++]=y+squarevDataSteady[3];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=1;
        partTdata[counter3++]=1;

        partVdata[counter1++]=x+squarevDataSteady[4];
        partVdata[counter1++]=y+squarevDataSteady[5];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=0;
        partTdata[counter3++]=0;

        partVdata[counter1++]=x+squarevDataSteady[6];
        partVdata[counter1++]=y+squarevDataSteady[7];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=1;
        partTdata[counter3++]=1;

        partVdata[counter1++]=x+squarevDataSteady[8];
        partVdata[counter1++]=y+squarevDataSteady[9];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=1;
        partTdata[counter3++]=0;

        partVdata[counter1++]=x+squarevDataSteady[10];
        partVdata[counter1++]=y+squarevDataSteady[11];
        if(isz)partVdata[counter1++]=z;
        partCdata[counter2++]=r;
        partCdata[counter2++]=g;
        partCdata[counter2++]=b;
        partCdata[counter2++]=a;
        partTdata[counter3++]=0;
        partTdata[counter3++]=0;

        count++;

    }
    void RenderStart()
    {
        counter1=counter2=count=counter3=0;
    }
    void RenderStop(int textureid)
    {
        if(!isanydrawed)return;

            glEnable(GL_TEXTURE_2D);
            glEnableClientState(GL_COLOR_ARRAY);
            glEnableClientState(GL_TEXTURE_COORD_ARRAY);
            glEnableClientState(GL_VERTEX_ARRAY);
            glBindTexture(GL_TEXTURE_2D, textureid);
            glTexCoordPointer(2, GL_FLOAT, 0, partTdata);
        glColorPointer(4, GL_FLOAT, 0,partCdata );
        if(isz)glVertexPointer(3, GL_FLOAT, 0, partVdata);
        else glVertexPointer(2, GL_FLOAT, 0, partVdata);
        glDrawArrays(GL_TRIANGLES, 0, count*6);
        glDisableClientState(GL_COLOR_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);
        glDisableClientState(GL_VERTEX_ARRAY);

        isanydrawed=false;
    }
}; 
```

**你的代码：**

```
BatchRenderer* br=new BatchRenderer(MAX_TEXTURES_NUM,true);//true since you are drawing 3d
void onParticlesRender()
{
      br->RenderStart();
      for(int c=0;c<PARTICLES_SIZE;c++)
      {
            br->Draw(p[c].pos.x,p[c].pos.y,p[c].pos.z,p[c].scale.x,p[c].scale.y,p[c].angle,p[c].r,p[c].g,p[c].b,p[c].a);
      }
      br->RenderStop(yourTextureID);
} 
```

我现在无法测试代码，所以如果它没有问题，请告诉我

VBO 在批量渲染中没有用，因为您在每一帧中都将新的顶点数据上传到 gpu。

# r - 约束 Newton-Raphson 估计

> ID：14084336
> 
> 赞同：8
> 
> 时间：2012-12-29T17:48:27.420
> 
> 标签：r

我正在尝试使用 Newton-Raphson 算法`R`来最小化我为一个非常具体的问题编写的对数似然函数。老实说，估计方法超出了我的想象，但我知道我所在领域（心理测量学）中的许多人使用 NR 算法进行估计，所以我正在尝试使用这种方法，至少一开始是这样。我有一系列嵌套函数，它们返回一个标量作为特定数据向量的对数似然估计：

```
log.likelihoodSL <- function(x,sxdat1,item) {
  theta <- x[1]
  rho <- x[2]
  log.lik <- 0
  for (it in 1:length(sxdat1)) {
    val <- as.numeric(sxdat1[it])
    apars <- item[it,1:3]
    cpars <- item[it,4:6]
    log.lik <- log.lik + as.numeric(log.pSL(theta,rho,apars,cpars,val))
  }
  return(log.lik)
}

log.pSL <- function(theta,rho,apars,cpars,val) {
  p <- (rho * e.aSL(theta,apars,cpars,val)) + ((1-rho) * e.nrm(theta,apars,cpars,val))
  log.p <- log(p)
  return(log.p)
}

e.aSL <- function(theta,apars,cpars,val) {
  if (val==1) {
    aprob <- e.nrm(theta,apars,cpars,val)
  } else if (val==2) {
    aprob <- 1 - e.nrm(theta,apars,cpars,val)
  } else
    aprob <- 0
  return(aprob)
}

e.nrm <- function(theta,apars,cpars,val) {
  nprob <- exp(apars*theta + cpars)/sum(exp((apars*theta) + cpars))
  nprob <- nprob[val]
  return(nprob)
} 
```

这些函数都按顺序依次调用。调用最高函数如下：

```
max1 <- maxNR(log.likelihoodSL,grad=NULL,hess=NULL,start=x,print.level=1,sxdat1=sxdat1,item=item) 
```

这是输入数据的示例（`sxdat1`在这种情况下我称之为）：

```
> sxdat1
 V1  V2  V3  V4  V5  V6  V7  V8  V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 
  2   1   3   1   3   3   2   2   3   2   2   2   2   2   3   2   3   2 
V19 V20 
  2   2 
```

这是变量`item`：

```
> item
             V1        V2         V3           V4         V5        V6
 [1,] 0.2494625 0.3785529 -0.6280155 -0.096817808 -0.7549263 0.8517441
 [2,] 0.2023690 0.4582290 -0.6605980 -0.191895013 -0.8391203 1.0310153
 [3,] 0.2044005 0.3019147 -0.5063152 -0.073135691 -0.6061725 0.6793082
 [4,] 0.2233619 0.4371988 -0.6605607 -0.160377714 -0.8233197 0.9836974
 [5,] 0.2257933 0.2851198 -0.5109131 -0.044494872 -0.5970246 0.6415195
 [6,] 0.2047308 0.3438725 -0.5486033 -0.104356236 -0.6693569 0.7737131
 [7,] 0.3402220 0.2724951 -0.6127172  0.050795183 -0.6639092 0.6131140
 [8,] 0.2513672 0.3263046 -0.5776718 -0.056203015 -0.6779823 0.7341853
 [9,] 0.2008285 0.3389165 -0.5397450 -0.103565987 -0.6589961 0.7625621
[10,] 0.2890680 0.2700661 -0.5591341  0.014251386 -0.6219001 0.6076488
[11,] 0.3127214 0.2572715 -0.5699929  0.041587479 -0.6204483 0.5788608
[12,] 0.2697048 0.2965255 -0.5662303 -0.020115553 -0.6470669 0.6671825
[13,] 0.2799978 0.3219374 -0.6019352 -0.031454750 -0.6929045 0.7243592
[14,] 0.2773233 0.2822723 -0.5595956 -0.003711768 -0.6314010 0.6351127
[15,] 0.2433519 0.2632824 -0.5066342 -0.014947878 -0.5774375 0.5923853
[16,] 0.2947281 0.3605812 -0.6553092 -0.049389825 -0.7619178 0.8113076
[17,] 0.2290081 0.3114185 -0.5404266 -0.061807853 -0.6388839 0.7006917
[18,] 0.3824588 0.2543871 -0.6368459  0.096053788 -0.6684247 0.5723709
[19,] 0.2405821 0.3903595 -0.6309416 -0.112333048 -0.7659758 0.8783089
[20,] 0.2424331 0.3028480 -0.5452811 -0.045311136 -0.6360968 0.6814080 
```

我想最小化函数的两个参数`log.likelihood()`是 theta 和 rho，我想将 theta 限制在 -3 和 3 之间，将 rho 限制在 0 和 1 之间，但我不知道如何使用当前的设置。有人可以帮帮我吗？我是否需要使用与 Newton-Raphson 方法不同的估计方法，或者有没有办法使用我目前正在使用`maxNR`的包中的函数来实现这一点？`maxLik`谢谢！

`x`编辑：包含参数 theta 和 rho 的起始值的向量只是`c(0,0)`因为这是这些参数的“平均”或“默认”假设（就它们的实质性解释而言）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T19:57:24.693

更方便的数据形式：

```
sxdat1 <- c(2,1,3,1,3,3,2,2,3,2,2,2,2,2,3,2,3,2,2,2)
item <- matrix(c(
0.2494625,0.3785529,-0.6280155,-0.096817808,-0.7549263,0.8517441,
0.2023690,0.4582290,-0.6605980,-0.191895013,-0.8391203,1.0310153,
0.2044005,0.3019147,-0.5063152,-0.073135691,-0.6061725,0.6793082,
0.2233619,0.4371988,-0.6605607,-0.160377714,-0.8233197,0.9836974,
0.2257933,0.2851198,-0.5109131,-0.044494872,-0.5970246,0.6415195,
0.2047308,0.3438725,-0.5486033,-0.104356236,-0.6693569,0.7737131,
0.3402220,0.2724951,-0.6127172,0.050795183,-0.6639092,0.6131140,
0.2513672,0.3263046,-0.5776718,-0.056203015,-0.6779823,0.7341853,
0.2008285,0.3389165,-0.5397450,-0.103565987,-0.6589961,0.7625621,
0.2890680,0.2700661,-0.5591341,0.014251386,-0.6219001,0.6076488,
0.3127214,0.2572715,-0.5699929,0.041587479,-0.6204483,0.5788608,
0.2697048,0.2965255,-0.5662303,-0.020115553,-0.6470669,0.6671825,
0.2799978,0.3219374,-0.6019352,-0.031454750,-0.6929045,0.7243592,
0.2773233,0.2822723,-0.5595956,-0.003711768,-0.6314010,0.6351127,
0.2433519,0.2632824,-0.5066342,-0.014947878,-0.5774375,0.5923853,
0.2947281,0.3605812,-0.6553092,-0.049389825,-0.7619178,0.8113076,
0.2290081,0.3114185,-0.5404266,-0.061807853,-0.6388839,0.7006917,
0.3824588,0.2543871,-0.6368459,0.096053788,-0.6684247,0.5723709,
0.2405821,0.3903595,-0.6309416,-0.112333048,-0.7659758,0.8783089,
0.2424331,0.3028480,-0.5452811,-0.045311136,-0.6360968,0.6814080),
               byrow=TRUE,ncol=6) 
```

使用`maxNR`：

```
library(maxLik)
x <- c(0,0)
max1 <- maxNR(log.likelihoodSL,grad=NULL,hess=NULL,start=x,
              print.level=1,sxdat1=sxdat1,item=item) 
```

`rho`请注意在消极游荡时产生的警告。但是，`maxNR`可以从中恢复并获得位于可行集内部的估计值 (theta=-1, rho=0.63)。 `L-BFGS-B`无法处理非有限的临时结果，但边界使算法远离那些有问题的区域。

我选择使用`bbmle`而不是使用`optim`:来实现这一点，它`bbmle`是（和其他优化工具）的包装器，`optim`它提供了一些特定于似然估计的好特性（分析、置信区间、模型之间的似然比测试等）。

```
library(bbmle)

## mle2() wants a NEGATIVE log-likelihood
NLL <- function(x,sxdat1,item) {
    -log.likelihoodSL(x,sxdat1,item)
} 
```

**编辑**：在早期版本中，我曾经`control=list(fnscale=-1)`告诉优化器我正在传递一个应该最大化而不是最小化的对数似然函数；这得到了正确的答案，但随后使用结果的尝试可能会变得非常混乱，因为包没有考虑这种可能性（例如，报告的对数似然的符号是错误的）。这可以在包中修复，但我不确定它是否值得。

```
## needed when objective function takes a vector of args rather than
##  separate named arguments:
parnames(NLL) <- c("theta","rho")
(m1 <- mle2(NLL,start=c(theta=0,rho=0.5),method="L-BFGS-B",
     lower=c(theta=-3,rho=2e-3),upper=c(theta=3,rho=1-2e-3),
     data=list(sxdat1=sxdat1,item=item))) 
```

这里有几点：

*   开始于`rho=0.5`边界而不是边界
*   将`rho`边界稍微设置在 [0,1] 内（`L-BFGS-B`在计算导数的有限差分近似时，并不总是完全尊重边界）
*   `data`在参数中指定输入数据

在这种情况下，我得到与 相同的结果`maxNR`。

```
 ## Call:
 ## mle2(minuslogl = NLL, start = c(theta = 0, rho = 0.5), 
 ##     method = "L-BFGS-B", data = list(sxdat1 = sxdat1, item = item), 
 ##     lower = c(theta = -3, rho = 0.002), upper = c(theta = 3, 
 ##         rho = 1 - 0.002), control = list(fnscale = -1))
 ## 
 ## Coefficients:
 ##      theta        rho 
 ## -1.0038531  0.6352782 
 ## 
 ## Log-likelihood: -18.11 
```

除非您非常迫切地需要使用 Newton-Raphson 而不是使用基于梯度的“准牛顿”方法，否则我猜这已经足够好了。（听起来你没有很强的技术理由这样做，除了“这就是我所在领域的其他人所做的” - 一个很好的理由，所有其他事情都是平等的，但在这种情况下不足以让我挖掘当类似的方法很容易获得并且工作正常时，可以实施 NR。）

# ios - NSUserDefaults 在 NSNotificationCenter 选择器中返回 null

> ID：14084337
> 
> 赞同：-2
> 
> 时间：2012-12-29T17:48:29.080
> 
> 标签：ios, nsuserdefaults, nsnotificationcenter

我有以下代码来注册观察者：

```
// This logs some value
NSLog(@"%@", [[NSUserDefaults standardUserDefaults] objectForKey:@"myKey"]); 
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(handleNotifications:)
                                             name:SomeNotification
                                           object:nil];

- (void) handleNotifications: (NSNotification *)notification
{
  // This logs null
  NSLog(@"%@", [[NSUserDefaults standardUserDefaults] objectForKey:@"myKey"]); 
} 
```

为什么`myKey`在通知选择器中返回 null？

**编辑**

I'm trying to save a new value when the value does not exists in the selector, however it always appear to return null in the selector after the app is restarted.

```
- (void) handleNotifications: (NSNotification *)notification
{

  if (![[NSUserDefaults standardUserDefaults] objectForKey:@"myKey"])) {
    NSLog(@"Saving");
    [[NSUserDefaults standardUserDefaults] setObject: @"ABC", forKey:@"myKey"]
    [[NSUserDefaults standardUserDefaults] synchronize];
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:18:22.227

简短的回答是，在调用和返回时，显然您没有将任何对象存储到`standardUserDefaults`for 键中。`@"myKey"``-handleNotifications:``[[NSUserDefaults standardUserDefaults] objectForKey:@"myKey"]``nil`

`SomeNotification`您是否在处理除in之外的其他通知`-handleNotifications:`？如果是这样，您可能会在行`-handleNotifications:`前输入

```
// This logs some value
NSLog(@"%@", [[NSUserDefaults standardUserDefaults] objectForKey:@"myKey"]); 
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(handleNotifications:)
                                             name:SomeNotification
                                           object:nil]; 
```

执行。

# php - 散居图像

> ID：14084340
> 
> 赞同：0
> 
> 时间：2012-12-29T17:49:01.417
> 
> 标签：php, javascript, jquery

我做了这个代码：

```

`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<script>
setInterval(function(){chrono('t');},1000);
</script>
<?php
include('function.php');
session_start();
global $list;
$list= captcha_list($_SESSION['id']);
global $i;
$i=0;
?>

<script>
function chrono(id){
inte= parseInt(document.getElementById(id).innerHTML,10);

switch(inte)
{
case 0:
document.getElementById(id).innerHTML='7';

 break;
case 1:
document.getElementById(id).innerHTML='0';
document.getElementById('im').src="<?php echo $list[$i]['captcha'];?>" ;

    break;
  case 2:
document.getElementById(id).innerHTML='1';

    break;
  case 3:
document.getElementById(id).innerHTML='2';
   break;
  case 4:
document.getElementById(id).innerHTML='3';
  break;
  case 5:
document.getElementById(id).innerHTML='4';
   break;
  case 5:
document.getElementById(id).innerHTML='4';
    break;
  case 6:
document.getElementById(id).innerHTML='5';
  break;
  case 7:
document.getElementById(id).innerHTML='6';
<?php $i++; ?>

    break;
default:
    break;
}

};
</script>
<body style="background-image:url(paper_03.png)" >

 <form name="form_2"  style="background-image:url(paper_02.png);position: absolute; top:30px; left: 200px; width: 500px; height: 500px;" >
                    <CENTER>
                        <table style="position: relative; top:30px;" >
                    <tr><td colspan=4><label>Image will be refresh in <label id="t" name="t"> 7 </label>  seconds
                     </label></td><td></td></tr>
                    <tr><td height=200px ><label>Image </label></td><td></td><td height=200px colspan=2><input type="image" id="im" src="<?php echo $list[$i]['captcha'];?>" style=" height=150px" /> </td></tr>
                    <tr><td height=200px><label>Text </label></td><td colspan=3 height=200px><input type="text" name="cap" style="width: 400px" /> </td></tr>
                    <tr><td></td><td><input type="submit" name="answer" value="SUBMIT ANSWER" style="height:200%;background-image:url(paper_03.png)"/> </td><td><input type="submit" name="know" value="DON'T KNOW" style="height:200%; background-image:url(paper_03.png)"/> </td><td><input type="submit" name="pause" value="SUBMIT AND PAUSE" style="height:200%;background-image:url(paper_03.png)"/> </td>
                    </tr>

                </table>

    </CENTER>
</form>     
</body>
<footer>
<?php 
include('header_footer/footer.php');
?>
</footer>
</html>` 

问题是显示的第一个图像是数组中的第二个图像，而第三个图像永远不会显示。变化是当 timer=7 和 timer=0 时。

*   错误在哪里？
*   这是什么原因？
*   我该如何解决？

            回答 #1

赞同：0

时间：2012-12-29T18:02:59.257

这将更改图像 src。这是你想要的吗？

```
var inte = 0;
setInterval(chrono,1000);

function chrono(){
  inte++;
  if(inte > 7) inte = 0;
  document.getElementById('im').src="paper_0" + inte + ".png";
}; 
```

```

# r - 转换数据集（相似度评级）

> ID：14084342
> 
> 赞同：2
> 
> 时间：2012-12-29T17:49:46.450
> 
> 标签：r, database-design

我想转换以下数据格式（简化表示）：

```
 image1 image2 rating
1      1      2      6
2      1      3      5
3      1      4      7
4      2      3      3
5      2      4      5
6      3      4      1 
```

转载：

```
structure(list(image1 = c(1, 1, 1, 2, 2, 3), image2 = c(2, 3, 
4, 3, 4, 4), rating = c(6, 5, 7, 3, 5, 1)), .Names = c("image1", 
"image2", "rating"), row.names = c(NA, -6L), class = "data.frame") 
```

以一种格式，您可以获得一种相关矩阵，其中前两列作为指标，评级是值：

```
 1  2  3  4
1 NA  6  5  7
2  6 NA  3  5
3  5  3 NA  1
4  7  5  1 NA 
```

你们中有人知道 R 中有一个函数可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:54:24.317

我宁愿使用矩阵索引：

```
N <- max(dat[c("image1", "image2")])
out <- matrix(NA, N, N)
out[cbind(dat$image1, dat$image2)] <- dat$rating
out[cbind(dat$image2, dat$image1)] <- dat$rating

#      [,1] [,2] [,3] [,4]
# [1,]   NA    6    5    7
# [2,]    6   NA    3    5
# [3,]    5    3   NA    1
# [4,]    7    5    1   NA 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T18:25:21.760

我不太喜欢`<<-`操作员，但它适用于这个（命名你的结构`s`）：

```
N <- max(s[,1:2])
m <- matrix(NA, nrow=N, ncol=N)
apply(s, 1, function(x) { m[x[1], x[2]] <<- m[x[2], x[1]] <<- x[3]})

 > m
     [,1] [,2] [,3] [,4]
[1,]   NA    6    5    7
[2,]    6   NA    3    5
[3,]    5    3   NA    1
[4,]    7    5    1   NA 
```

不像 Karsten 的解决方案那样优雅，但它不依赖于行的顺序，也不要求所有组合都存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:14:29.037

这是一种方法，`dat`问题中定义的数据框在哪里

```
res <- matrix(0, nrow=4, ncol=4) # dim may need to be adjusted
ll <- lower.tri(res, diag=FALSE)
res[which(ll)] <- dat$rating
res <- res + t(res)
diag(res) <- NA 
```

这仅在行按问题排序时才有效。

# r - 最大似然估计

> ID：14084346
> 
> 赞同：4
> 
> 时间：2012-12-29T17:49:58.480
> 
> 标签：r, regression

我是 R 的新用户，如果我的问题很愚蠢，希望你能容忍我。我想使用 R 中的最大似然估计器来估计以下模型。

```
y= a+b*(lnx-α) 
```

其中 a、b 和 α 是要估计的参数，X 和 Y 是我的数据集。我尝试使用从网上获得的以下代码：

```
library(foreign)
maindata <- read.csv("C:/Users/NUNU/Desktop/maindata/output2.csv")
h <- subset(maindata, cropid==10)
library(likelihood)
modelfun <- function (a, b, x) { b *(x-a)}
par <- list(a = 0, b = 0)
var<-list(x = "x")
par_lo <- list(a = 0, b = 0)
par_hi <- list(a = 50, b = 50)
var$y <- "y"
var$mean <- "predicted"
var$sd <- 0.815585
var$log <- TRUE
results <- anneal(model = modelfun, par = par, var = var,
            source_data = h, par_lo = par_lo, par_hi = par_hi,
            pdf = dnorm, dep_var = "y", max_iter = 20000) 
```

我得到的结果是相似的，尽管数据不同，即即使我改变了作物。同样，生成的预测值是针对 x 而不是 y。我不知道我错过了什么或出了什么问题。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T19:25:09.147

我不确定您的模型公式是否会导致唯一的解决方案，但通常您可以找到具有`optim`函数的 MLE

这是一个使用 optim 进行线性回归的简单示例：

```
fn <- function(beta, x, y) {
a = beta[1]
b = beta[2]

    sum( (y - (a + b * log(x)))^2 ) 
}

# generate some data for testing
x = 1:100

# a = 10, b = 3.5
y = 10 + 3.5 * log(x)

optim(c(0,0,0),fn,x=x,y=y,method="BFGS") 
```

您可以更改函数“ *fn* ”以反映您的模型公式，例如

```
sum( (y - (YOUR MODEL FORMULA) )^2 ) 
```

**编辑**

我只是给出一个使用 optim 的简单示例，以防您有要优化的自定义模型公式。我并不是说从简单的线性回归中使用它，因为这就`lm`足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:57:09.607

我有点惊讶 iTech 使用 optim 来解决参数线性的问题。用他的 x 和 y 数据：

```
> lm(y ~ log(x) )

Call:
lm(formula = y ~ log(x))

Coefficients:
(Intercept)       log(x)  
       10.0          3.5 
```

对于线性问题，最小二乘解是 ML 解。

# image - 在codeigniter中上传图片

> ID：14084347
> 
> 赞同：0
> 
> 时间：2012-12-29T17:50:06.253
> 
> 标签：image, file, codeigniter, upload

一切都很好，但是当我打开上传文件夹时，没有任何图像。

这是控制器“admin_news”。我尝试在 localhost/site/asset/upload 中上传图像文件。但是当我点击提交时，只有信息（标题、新闻和类别）进入数据库，但文件没有上传。

```
 function __construct()
{
    parent::__construct();
    $this->load->helper(array('form', 'html', 'file'));
    $config['upload_path']   = base_url('asset/upload/');
    $config['allowed_types'] = 'gif|jpg|png';
    $this->load->library('upload', $config);
}

public function add_news(){
    $this->load->helper('form');  
    $this->load->model('AddNews');  
    $this->load->view('templates/header', $data);
    $this->load->view('admin/add_news');
    $this->load->view('templates/footer');
    if($this->input->post('submit')){
        if ($this->upload->do_upload('image'))
        {
            $this->upload->initialize($config);
            $this->upload->data();
        }
        $this->AddNews->entry_insert();
        redirect("admin_news/index");
    }
} 
```

该视图只有：

```
 <?php echo form_open_multipart(''); ?>
    <input type="text" name="title" value="Title..." onfocus="this.value=''" /><br /> 
    <input type="file" name="image" /><br /> 
```

……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:21:00.317

这不应该是 URL：

```
$config['upload_path']   = base_url('asset/upload/'); 
```

它应该是您服务器上某处的路径，可以是完整的绝对路径，也可以是相对路径（Codeigniter 中的所有路径都是相对于 index.php）。

使用其中之一：

```
// Full path
$config['upload_path'] = FCPATH.'asset/upload/';

// Relative
$config['upload_path'] = './asset/upload/'; 
```

还有一件事：

```
if ($this->upload->do_upload('image'))
{
    // You don't need this, and besides $config is undefined
    // $this->upload->initialize($config);

    // You don't seem to be doing anything with this?
    $this->upload->data();

    // Move this here in case upload fails
    $this->AddNews->entry_insert();
    redirect("admin_news/index");
}
// Make sure to show errors
else
{
    echo $this->upload->display_errors();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:00:15.550

我认为在您的代码中，问题是您在 do_upload 方法之后声明了配置

```
if ($this->upload->do_upload('image'))
        {
            $this->upload->initialize($config);
            $this->upload->data();
        } 
```

在使用该方法之前应该初始化配置。我认为这就是问题所在。`do_upload`所以你必须在方法之前进行配置

# python - try 块之前的语句等待直到 try 完成才执行

> ID：14084352
> 
> 赞同：2
> 
> 时间：2012-12-29T17:50:36.357
> 
> 标签：python, try-catch

我写了一个简单的 Python (3.2) 脚本来下载一系列文件。它完成了工作，但在文件下载开始之前，try 块之前的第一个打印语句不会执行。我希望看到“Downloading 1...”，然后等待几分钟，然后它会打印“SUCCESS！” 或“失败！” 然后。但是，这一切都是在文件下载后同时发生的。它仍然以正确的顺序打印（即“正在下载 1...成功！”），但我终其一生都无法弄清楚它为什么会挂起。

```
from urllib import request

for i in range(1,35):
    url = "http://example.com/" + str(i) + ".mp4"   
    print("Downloading " + str(i) + "...", end='') #this doesn't happen until after the try
    try:    
        resp = request.urlopen(url)
        local = open(str(i) + '.mp4', 'wb') 
        local.write(resp.read())
        local.close()   
        print("SUCCESS!")
    except:
        print("FAILURE!") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:52:16.890

`try`这与块无关。输出发生得很好，但它被缓冲了。您的终端很可能是行缓冲的，这意味着在相应行完全输出之前您看*不到输出。*您可以显式刷新它：`sys.stdout.flush()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:52:05.300

默认情况下缓冲标准输出，`sys.stdout.flush()`在`print`s 之后调用或使用`python -u script.py`.

# c# - 如何使用 gui 创建线程工作

> ID：14084354
> 
> 赞同：1
> 
> 时间：2012-12-29T17:50:51.523
> 
> 标签：c#, multithreading

我是 C# 程序的新手。我想创建在主 UI 中移动标签而不卡住 UI 的线程，直到移动完成我构建了一些东西但它没有工作告诉我我的问题是什么

```
private void button1_Click(object sender, EventArgs e)
    {
        Thread t = new Thread(Movelb);
        t.IsBackground = true;
        t.Start();enter code here
    }

private void DOsomeThing()
        {
            label2.Visible = true;
            label2.Location = new Point(0, 205);
            for (int i = 0; i < 533; i++)
            {
                label2.Location = new Point(i, 205);
                Thread.Sleep(10);
            }
            label1.Text="false";
        }
private void Movelb()
            {
                if (this.InvokeRequired)
                {
                    threadDel d = new threadDel(DOsomeThing);
                    this.BeginInvoke(d);
                }
                else
                    DOsomeThing();

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:08:11.017

不要使用线程来绘制表单或修改/更新表单内容。Windows 编程中推荐的范例是**每个窗体或窗口一个线程**。如果你想创建从不同线程运行的表单，那么你必须

1.  首先创建新线程
2.  在新线程上创建表单

这样，新线程将充当新表单的消息处理程序。但即便如此，您仍然应该在该线程中对表单进行所有操作（如果表单想要修改在不同线程上运行的另一个表单中的内容，则可能需要一些额外的线程安全通信技巧）。

要为窗口内容设置动画，您应该使用`System.Windows.Forms.Timer`它，它在表单的线程上与其他消息同步执行。不过，您需要将动画重新实现为状态机而不是`for()`循环构造。这意味着标签位置的变量将需要嵌入到 Form 类中，以便可以在 Timer 消息调用中保留更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:00:55.663

您需要先了解事件模型。在 Windows、Android 或 Linux 等事件驱动的环境中……“自动”任务（例如坐标动画或其他属性）通常使用计时器完成，这些计时器不断将事件重新发送回推进动画/进程的处理程序。在您的特定示例中 - 如果您需要移动标签，请使用 Widows.Forms.Timer。阻止处理具有冗长任务的事件的 UI 线程是不合适的，因为 UI 线程将停止并且您的应用程序将冻结或变得生涩。现在，另一方面，在很多情况下，添加额外线程确实有很大帮助，什么时候？不是您的情况，因为与重绘相比，您只更改了与 CPU 无关的标签坐标，因此您使用额外线程的解决方案效率较低且比使用计时器复杂得多。

事件如何运作？

操作系统内部有一个无限循环，它会被键盘、鼠标和其他事件打断，但循环会无限循环，直到您关闭 Windows（或 Android 或 XWidnws...）。在循环结束时，操作系统查看“原始”鼠标/键事件并将它们分派到适当的应用程序队列中。它通过检查每个应用程序窗口列表来了解它，谁在顶部，因此它知道什么窗口/应用程序在某个 X，Y 鼠标坐标下。当事件被分派到您的应用程序时，您的工作是非常快速地处理它并在队列中查找另一个事件（队列绑定到 UI 线程/Windows）。

计时器如何工作？计时器是一种特殊的事件，操作系统可以从其内部“无限循环”定期向您发送。操作系统会跟踪请求通知的应用程序以及通知的频率 - 当时间到来时，它会将 WM_TIMER（在 MS Windows 上）添加到您的 Windows 队列中。这样你就不会阻塞任何东西，而是在你的代码中获得一个每 X 毫秒调用一次的方法。当您使用 .NET Timer 类时 - 它只是 Windows 用户 API 中 CreateTimer() KillTimer() 的包装器（我不记得确切的函数名称）。.NET Timer 也知道如何吞下 WM_TIMER 并为您调用 C# 事件/委托。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:00:35.493

您的代码没有任何用处。它只是启动一个新的后台线程，然后调用一个委托，在同一个 UI 线程上执行，该线程已经启动......后台线程。

换句话说，您不能在工作线程中移动标签，因为移动标签会导致重绘，而这无法从后台线程完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-08T17:15:31.373

我也有一个想法在一个线程中做一些工作 - 虽然这项艰巨的工作已经完成......应该修改 main-gui-form，这样用户就会发现一个进步。做了一些查找并进入“委托”、“事件处理程序”和“非常高级的代码片段”。我花了一些时间来修复，我想出了这个非常简单的例子。看一看。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace ProcessingUI

// You will find a form with "button1": will do some work in a seperate thread, and
//   therefore you are allowed to do action in main-gui-form while this work is done, 
//   due to async. operation.
//   While work is done in seperate thread - the main-gui-form will have a label modified... 
//   having the steps: 1,2,3,0.

// Also found... "button2": will do some work in same thread as gui, and
//   therefore you are not allowed to do action in main-gui-form while this work is done,
//   due to sync. operation (only one thread is established).
//   While work is done in one-and-only-thread - the main-gui-form will have a label modified... 
//   having the steps: 1,2,3,0.

{

    public delegate void UpdateTextDelegate();

    public partial class Form1 : Form
    {

        public delegate void SetStatusText(string statusText);
        public SetStatusText mySetStatusTextDelegate;

        public Form1()
        {
            InitializeComponent();
            mySetStatusTextDelegate = new SetStatusText(SetStatusTextMethod);
        }

        private void button1_Click(object sender, EventArgs e)   // do work from new thread.
        {
            Worker w = new Worker(this);
            Thread thread1 = new Thread(new ThreadStart(w.DoWork));
            thread1.Start();
        }

        private void button2_Click(object sender, EventArgs e)   // do work from local class - form is locked during 1-3 steps.
        {
            SetStatusTextMethod("1");
            Thread.Sleep(3000);

            SetStatusTextMethod("2");
            Thread.Sleep(3000);

            SetStatusTextMethod("3");
            Thread.Sleep(3000);

            SetStatusTextMethod("0");
        }

        public void SetStatusTextMethod(string statusText)
        {
            label1.Text = statusText;
            label1.Refresh();
        }
    }

    public class Worker
    {
        Form1 guiForm;    // holds form where "control-to-be-changes" is found.
        public Worker(Form1 _guiForm)
        {
            guiForm = _guiForm;
        }

        public void DoWork()   // while steps are being done - form can easily be moved around... is not locked!
        {
            // put "1/3" on form.
            guiForm.Invoke(guiForm.mySetStatusTextDelegate, "1");
            Thread.Sleep(3000);

            // put "2/3" on form.
            guiForm.Invoke(guiForm.mySetStatusTextDelegate, "2");
            Thread.Sleep(3000);

            // put "3/3" on form.
            guiForm.Invoke(guiForm.mySetStatusTextDelegate, "3");
            Thread.Sleep(3000);

            guiForm.Invoke(guiForm.mySetStatusTextDelegate, "0");
        }
    }

} 
```

# python - Python：查找中心坐标来自numpy.random数组的圆是否与数组中的其他圆重叠的最有效方法？

> ID：14084355
> 
> 赞同：0
> 
> 时间：2012-12-29T17:50:58.527
> 
> 标签：python, computational-geometry

所以我有一个随机的二维圆的中心点坐标数组，半径为 r。我需要创建一个函数来确定给定圆是否与另一个圆重叠。显然，如果它们在任一维度上的间隔小于 2r，它们就会重叠。我创建了一个函数来执行此操作：

```
 def x_overlap(n,r):
              radius_arr=array([2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r])
              diff_in_x=x-x[n]
              x_touch=radius_arr-diff_in_x
              for item in x_touch:
                  if item<0:
                      return "disk of ” n “ index overlaps with disk of ” x_touch.index(item) “ index in x direction"
                  else:
                      return "no overlaps for disk of ” n “ index in x direction"

          def y_overlap(n,r):
              radius_arr=array([2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r,2*r])
              diff_in_y=y-y[n]
              y_touch=radius_arr-diff_in_y
              for item in y_touch:
                  if item<0:
                      return "disk of “ n “ index overlaps with disk of ” y_touch.index(item) “ index in y direction"
                  else:
                      return "no overlaps for disk of “ n “ index in y direction"
          def overlap(n,r):
              return x_overlap(n,r) + " " + "and" + " " + y_overlap(n,r) 
```

这段代码我遇到了一些问题；首先，它很长。其次，当我运行该函数时，n's 和 y_touch.index(item) 引用不会出现在控制台中。我的代码有什么问题，有更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:58:12.160

检查中心点之间的距离是否小于半径之和：

```
def is_overlap(circle1, circle2):
    distance = ((circle1.x - circle2.x)**2 + (circle1.y - circle2.y)**2)**0.5

    return distance < circle1.r + circle2.r 
```

您的代码不适用于像这样定位的圆圈（您的代码确实将圆圈视为正方形）：

```
 o
o 
```

# visual-studio-2010 - MS Visual Studio.net - 重启后保存的源文件丢失

> ID：14084357
> 
> 赞同：0
> 
> 时间：2012-12-29T17:51:06.160
> 
> 标签：visual-studio-2010

前几天我创建了一个 MS Visual Studio 2010 C# 项目并开始编码。我经常保存源，但我没有选择要保存到的目标（只是按 ctrl+s 并假设源正在保存）。然而，我不得不跑步并将笔记本电脑扔进我的背包里睡觉。不幸的是，这台笔记本电脑（acer aspire 5252 fyi）在睡眠时电池电量耗尽非常快，最终我的电脑关闭了。现在我在任何地方都找不到我的源文件，我快疯了，因为我知道我保存了它，而且这需要几天的工作。

我尝试进行 Windows 搜索，但找不到项目文件。我还做了一个小实验——我创建了一个新项目，但没有保存整个解决方案，我在源文件上按了 ctrl+s。保存成功，但我什至找不到在 IDE 中打开的文件。甚至“打开包含文件夹选项”也是灰色的（见屏幕截图）。

![文件已创建并保存，但它在哪里？](../Images/670537ce0785403001b4d29443236a1e.png)

我真的需要这些源文件。显然是因为我没有保存解决方案，所以源被清除了，但是在保存解决方案之前，源文件临时保存在哪里？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:57:03.987

有一个用于保存项目的**默认位置。**那可能就是您的文件所在的位置。

在 Visual Studio 的菜单上，单击工具 > 选项 > 项目和解决方案 > 常规。有一个“Visual Studio 项目位置”。

在我的 Windows 7 机器上，Visual Studio 2010 的文件夹是

```
C:\Users\<username>\Documents\Visual Studio 2010\Projects 
```

您的未命名项目可能使用默认名称（如 WebSite1）保存。

如果您想[更改该默认位置](http://msdn.microsoft.com/en-us/library/vstudio/34c29fes%28v=vs.100%29.aspx)，这里有一些有关如何执行此操作的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:03:36.857

您正在使用 Visual Studio 对临时项目的支持。快速测试项目（和 SO 答案）的不错功能，但不是确保 VS 退出后您的项目仍然存在的好方法。没有源代码控制的编程同样是不可取的。

工具 + 选项、项目和解决方案、常规。确保勾选“创建时保存新项目”选项，以最大程度地减少您忘记选择解决方案文件夹的可能性。三重检查现在创建一个新项目是否会在对话框中为您提供“位置”属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:14:12.130

[Visual Studio 临时项目](http://msdn.microsoft.com/en-us/library/6yx39k28.aspx)通常位于 ***C:\Users\"User Name"\AppData\Local\Temporary Projects***中。它是一个临时文件夹，在 Visual Studio 启动后立即被删除。

如何从上面的链接保存临时项目：

## 保存临时项目

1.  在解决方案资源管理器中，选择要保存的解决方案或项目。

2.  在菜单栏上，选择文件、保存或另存为。
    保存项目对话框打开。

3.  在名称框中，指定项目的名称。

4.  在“位置”框中，指定要保存项目的位置。

5.  选中为解决方案创建目录复选框。
    注意：此复选框不适用于 Visual Basic Web 项目、Visual C# Web 项目或其他基于目录的项目。

6.  在“新解决方案名称”框中，指定与项目名称不同的名称。

7.  如果要将解决方案添加到版本控制数据库或存储库，请选中添加到源代码控制复选框。

8.  选择确定按钮。

# python - python中的树：递归子创建

> ID：14084367
> 
> 赞同：0
> 
> 时间：2012-12-29T17:52:02.443
> 
> 标签：python, recursion, tree

我有一个名为 rectangle 的类，它有两个参数（SX 和 SZ）。我需要做一个函数，将第一个矩形分成两部分，在更宽的维度上随机放置一条线，然后这两个新矩形将分成两部分，然后是四部分，等等。我使用简单的树结构和像这样的功能：

```
def devide(self):
    if (self.SX>self.SZ):                #check which dimension is bigger
        temp=randint (int(self.SX/4), int(self.SX*3/4))  #generate random from x/4,3x/4           
        left=rectangle(temp, self.SZ)             #create nodes
        right=rectangle(self.SX-temp, self.SZ)
        self.addChild(left) 
        self.addChild(right)
    else:
        temp=randint (int(self.SZ/4), int(self.SZ*3/4))              
        up=rectangle(self.SX, temp)                 
        down=rectangle(self.SX, self.SZ-temp)
        self.addChild(up)
        self.addChild(down)

    for c in self.getChilds():
        while (c.level()<3):     ####why doesn't it work?:(
            c.devide() 
```

还有这个函数`level()`——它应该（但它不）返回根节点和实际节点之间有多少层的值：

```
def level(self): 
    root=self
    a=0
    while root.isRoot()==False: 
        a+=1
        root=root.getParent()
    return a 
```

对我来说重要的事情是：

*   如何限制这些划分（例如，只有 1+2+4+8 个节点）？我的意思是，Python 中没有静态变量，我的函数`level()`无法正常工作。

*   如何访问最小的孩子（例如，将它们放在数组中）

我是编程新手，尤其是 Python。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:34:33.937

也许你正在寻找这样的东西：（它是一个双链（父母知道孩子，孩子知道父母）二叉树）

```
#! /usr/bin/python3.2

import random

class Rectangle:
    def __init__ (self, width, height, parent = None):
        self.width = width
        self.height = height
        self.parent = parent
        self.children = []

    @property
    def level (self):
        return 0 if not self.parent else 1 + self.parent.level

    def split (self):
        if self.children: raise Exception ('Already split')
        ratio = random.random () * .5 + .25 #split between 1/4 and 3/4
        if self.width > self.height:
            width = int (ratio * self.width)
            self.children = [Rectangle (width, self.height, self),
                Rectangle (self.width - width, self.height, self) ]
        else:
            height = int (ratio * self.height)
            self.children = [Rectangle (self.width, height, self),
                Rectangle (self.width, self.height - height, self) ]

    def splitUntilLevel (self, maxLevel):
        if maxLevel <= self.level: return
        self.split ()
        for child in self.children: child.splitUntilLevel (maxLevel)

    def __str__ (self):
        s = '{}{} x {}\n'.format (' ' * (2 * self.level), self.width, self.height)
        for child in self.children: s += str (child)
        return s

r = Rectangle (100, 100)
r.splitUntilLevel (3)
print (r) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:04:35.973

应该是`a += 1`，不是`a = +1`。

此外，调用`divide()`一个对象不会增加它自己的`level`，所以你永远不会跳出循环。您应该检查树的终端叶子的级别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:12:33.370

addChild(up) 和 addChild(down) 是什么？您可以将每个矩形关联到一个包含自身级别的整数，这更容易，如果您想在生成新矩形时限制树的深度，只需评估以下结果：2^h h-> 树的深度。

# php - 有没有办法只使用 glob() 文件？

> ID：14084378
> 
> 赞同：39
> 
> 时间：2012-12-29T17:53:16.677
> 
> 标签：php, glob, directory-browsing

我知道[`glob`](http://php.net/manual/en/function.glob.php)可以查找所有文件或仅查找文件夹内的所有目录：

```
echo "All files:\n";
$all = glob("/*");
var_dump($all);

echo "Only directories\n";
$dirs = glob("/*", GLOB_ONLYDIR);
var_dump($dirs); 
```

但是我没有找到可以有效地仅在一行中查找文件的方法。

```
$files = array_diff(glob("/*"), glob("/*", GLOB_ONLYDIR)); 
```

效果很好，但读取目录两次（即使有[一些优化](http://php.net/manual/en/function.clearstatcache.php)可以使第二次浏览更快）。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-29T17:53:16.677

我终于找到了解决方案：

```
echo "Only files\n";
$files = array_filter(glob("/*"), 'is_file');
var_dump($files); 
```

但请注意，[array_filter](http://fr2.php.net/manual/en/function.array-filter.php)将保留数字键：如果需要重新索引数组，请使用[array_values 。](http://php.net/manual/en/function.array-values.php)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-10T14:20:59.743

您可以使用`GLOB_BRACE`将文档与已知文件扩展名列表进行匹配：

```
$files = glob("/path/to/directory/*.{jpg,gif,png,html,htm,php,ini}", GLOB_BRACE); 
```

见：[http ://www.electrictoolbox.com/php-glob-find-files/](http://www.electrictoolbox.com/php-glob-find-files/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-19T13:41:22.870

有一种更简单的方法，只有一行：

```
$files = glob("/path/to/directory/*.{*}", GLOB_BRACE); 
```

**{*}**表示所有文件结尾，所以每个文件，但没有文件夹！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-23T12:53:29.870

与@AlainTiemblo 的解决方案相比，速度快了 10%，因为它不使用额外的`is_file`检查：

```
$files = array_filter(glob("/*", GLOB_MARK), function($path){ return $path[ strlen($path) - 1 ] != '/'; }); 
```

相反，它使用 inbuild`GLOB_MARK`标志向每个目录添加一个斜线，这样我们就可以通过[array_filter()](https://www.php.net/manual/en/function.array-filter.php)和一个匿名函数删除这些条目。

由于 PHP 7.1.0 支持[负数字索引](https://www.php.net/language.types.string#example-54)，您也可以使用它：

```
$files = array_filter(glob("/*", GLOB_MARK), function($path){return $path[-1] != '/';}); 
```

没有相关的速度增益，但它有助于避免这篇文章中的垂直滚动条^^

作为保留键，您应该考虑使用[array_values()](https://www.php.net/manual/de/function.array-values.php)`array_filter()`重新索引数组：

```
$files = array_values($files); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-05T19:54:06.830

反转正则表达式完成这项工作。

```
preg_grep(
    ';^.*(\\\\|/)$;',
    glob("/*", GLOB_MARK),
    PREG_GREP_INVERT
); 
```

\\\\ 用于 Windows 反斜杠

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-11-30T12:55:32.743

这对我有用。如果这对任何人都有帮助。

```
for file_name in glob.glob('**/*', recursive=True):
    # we get all files and dirs
    if os.path.isfile(file_name):
        # we have only the files 
```

* * *

## 回答 #7

> 赞同：-10
> 
> 时间：2013-04-09T21:54:50.533

```
$all = glob("/*.*"); 
```

这将用“。”列出所有内容。在文件名之后。所以基本上，所有文件。

# python - 自定义小部件仅第一次验证

> ID：14084380
> 
> 赞同：4
> 
> 时间：2012-12-29T17:53:46.867
> 
> 标签：python, django, django-forms, django-widget

我创建了一个自定义小部件`OrderedCheckboxSelectMultiple`，我只是替换`<ul>`并`<ol>`添加一些类到`<label>`,`<li>`等：

```
class OrderedCheckboxSelectMultiple(forms.CheckboxSelectMultiple):

    def render(self, name, value, attrs=None, choices=()):
        if value is None: value = []
        has_id = attrs and 'id' in attrs
        final_attrs = self.build_attrs(attrs, name=name)
        output = [u'<ol class="numeric">']
        # Normalize to strings
        str_values = set([force_unicode(v) for v in value])
        for i, (option_value, option_label) in enumerate(chain(self.choices, choices)):
            # If an ID attribute was given, add a numeric index as a suffix,
            # so that the checkboxes don't all have the same ID attribute.
            if has_id:
                final_attrs = dict(final_attrs, id='%s_%s' % (attrs['id'], i))
                label_for = u' for="%s"' % final_attrs['id']
            else:
                label_for = ''

            cb = forms.CheckboxInput(final_attrs, check_test=lambda value: value in str_values)
            option_value = force_unicode(option_value)
            rendered_cb = cb.render(name, option_value)
            option_label = conditional_escape(force_unicode(option_label))
            output.append(u'<li class="liAll"><label%s class="checkbox inline">%s <span class="spanLabel">%s</span></label></li>' % (
                label_for, rendered_cb, option_label))
        output.append(u'</ol>')
        return mark_safe(u'\n'.join(output)) 
```

我在两个不同领域的表单中使用这个小部件：

```
class SomeForm(forms.Form):
    # more fields here

    alert1 = forms.MultipleChoiceField(choices=[(a.id, a.description) for a in SomeModel.objects.filter(a=True)],
                                             widget=OrderedCheckboxSelectMultiple())
    alert2 = forms.MultipleChoiceField(choices=[(a.id, a.description) for a in SomeModel.objects.filter(b=True)],
                                             widget=OrderedCheckboxSelectMultiple()) 
```

问题是，当我**第一次**提交表单时出现验证错误：

```
Select a valid choice. is not one of the available choices. 
```

然后，当我再次勾选选项时，它会毫无问题地验证。我在这里迷路了。有什么建议么？

**笔记：**

`forms.CheckboxSelectMultiple`如果我将其用作`alert1`and的小部件，也会发生同样的事情`alert2`。

* * *

**编辑：**

~~在调试时，我可以看到它`alert1`并且在我第一次提交时`alert2`不存在。`request.POST`~~

对不起，我犯了一个错误。`alert1`并且`alert2`出现在，但尽管被勾选，`request.POST`但它们都存在。`u''`

* * *

**编辑2：**

使用 Chrome 的“检查元素”，我可以看到表单第一次正确呈现：

```
<ol class="numeric">
    <li class="liAll">
        <label for="id_alert1_0" class="checkbox inline">
            <div class="checker" id="uniform-id_alert1_0">
                <span>
                    <input value="1" type="checkbox" class="check" name="alert1" id="id_alert1_0" style="opacity: 0;">
                </span>
            </div>
        </label>
    </li>
    <li class="liAll">
        <label for="id_alert1_1" class="checkbox inline">
            <div class="checker" id="uniform-id_alert1_1">
                <span>
                    <input id="id_alert1_1" type="checkbox" class="check" value="2" name="alert1" style="opacity: 0;">
                </span>
            </div>
        </label>
    </li>
</ol> 
```

然后再次显示验证消息，但呈现的表单看起来相同：

```
<ol class="numeric">
    <li class="liAll">
        <label for="id_alert1_0" class="checkbox inline">
            <div class="checker" id="uniform-id_alert1_0">
                <span>
                    <input value="1" type="checkbox" class="check" name="alert1" id="id_alert1_0" style="opacity: 0;">
                </span>
            </div>
        </label>
    </li>
    <li class="liAll">
        <label for="id_alert1_1" class="checkbox inline">
            <div class="checker" id="uniform-id_alert1_1">
                <span>
                    <input id="id_alert1_1" type="checkbox" class="check" value="2" name="alert1" style="opacity: 0;">
                </span>
            </div>
        </label>
    </li>
</ol> 
```

我正在使用提交按钮提交帖子：

```
<button type="submit" class="btn btn-primary">Send</button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:22:54.887

我在一个快速的 django 应用程序中复制并粘贴了您的代码。对我来说工作得很好。还有其他可能出错的地方吗？OS x 上的 Django 1.4。

# 视图.py

```
class OrderedCheckboxSelectMultiple(CheckboxSelectMultiple):
    def render(self, name, value, attrs=None, choices=()):
        if value is None: value = []
        has_id = attrs and 'id' in attrs
        final_attrs = self.build_attrs(attrs, name=name)
        output = [u'<ol class="numeric">']
        # Normalize to strings
        str_values = set([force_unicode(v) for v in value])
        for i, (option_value, option_label) in enumerate(chain(self.choices, choices)):
            # If an ID attribute was given, add a numeric index as a suffix,
            # so that the checkboxes don't all have the same ID attribute.
            if has_id:
                final_attrs = dict(final_attrs, id='%s_%s' % (attrs['id'], i))
                label_for = u' for="%s"' % final_attrs['id']
            else:
                label_for = ''

            cb = CheckboxInput(final_attrs, check_test=lambda value: value in str_values)
            option_value = force_unicode(option_value)
            rendered_cb = cb.render(name, option_value)
            option_label = conditional_escape(force_unicode(option_label))
            output.append(u'<li class="liAll"><label%s class="checkbox inline">%s <span class="spanLabel">%s</span></label></li>' % (
            label_for, rendered_cb, option_label))
            output.append(u'</ol>')
        return mark_safe(u'\n'.join(output))

class SomeForm(forms.Form):
    alert1 = MultipleChoiceField(choices=[(a.id, a.name) for a in Widget.objects.filter(a=False)],
                                         widget=OrderedCheckboxSelectMultiple())
    alert2 = MultipleChoiceField(choices=[(a.id, a.name) for a in Widget.objects.filter(a=False)],
                                         widget=OrderedCheckboxSelectMultiple())

def index(request):
    if request.method =="POST":
        form = SomeForm(request.POST)
        print(request.POST.keys())
        if form.is_valid():
            print("trying to save")
    else:
        form = SomeForm()
    return render_to_response('publichome.html', locals(), context_instance=RequestContext(request)) 
```

# python - 在 Python 中导入 RTree 时如何修复“ImportError: No module named index”？

> ID：14084383
> 
> 赞同：2
> 
> 时间：2012-12-29T17:54:05.823
> 
> 标签：python, python-3.x, r-tree

我尝试从 PyPI 安装[Rtree 0.7.0](http://pypi.python.org/pypi/Rtree/)`ImportError: No module named index` ，但是当我尝试使用它时，我不断得到它。[我从下载](http://pypi.python.org/pypi/Rtree/#downloads)页面下载并运行了 Rtree-0.7.0.win32.exe ，一切似乎都已正确安装。

这是我得到的完整错误消息（来自 Python 3.2.2 shell）：

```
>>> from rtree import index
Traceback (most recent call last):
  File "<pyshell#0>", line 1, in <module>
    from rtree import index
  File "C:\Python32\lib\site-packages\rtree\__init__.py", line 1, in <module>
    from index import Rtree
ImportError: No module named index

>>> import rtree
Traceback (most recent call last):
  File "<pyshell#1>", line 1, in <module>
    import rtree
  File "C:\Python32\lib\site-packages\rtree\__init__.py", line 1, in <module>
    from index import Rtree
ImportError: No module named index 
```

错误消息表明没有名为“index”的模块，但是当我查看我的`C:\Python32\lib\site-packages\rtree\`目录时，我看到它在那里。

![RTree 包目录](../Images/820209adc29eeee944db7cfda5653e2e.png)

什么可能导致我仍然收到`ImportError: No module named index`错误消息，我该如何修复它以便我可以使用 RTree 模块？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T18:01:57.713

它似乎依赖于`import foo`做[相对导入](http://www.python.org/dev/peps/pep-0328/)。这是 2.x 中的默认行为（从 2.5 开始，有一个`__future__`指令覆盖它）。Python 3[删除了这个](http://docs.python.org/3/whatsnew/3.0.html#removed-syntax). 所以维护人员可能甚至没有尝试与 3.x 兼容，安装只是偶然。适当地，没有关于 Python 3 兼容性的声明：没有`Programming Language :: Python :: 3`trove 分类器，文档中没有提及，没有使用 2to3`setup.py`等。没有修补`rtree`来解决这个问题，可能还有许多其他问题，你不会让它工作.

# wso2 - 带有非 WSO2 ESB 的 WSO2 API 管理器？

> ID：14084386
> 
> 赞同：5
> 
> 时间：2012-12-29T17:54:18.283
> 
> 标签：wso2, wso2esb, esb, wso2-am

我已经有一个`ESB`（非 WSO2 产品）的工作系统。我现在正在尝试`WSO2 API Manager`为 3rd 方开发人员集成到我的工作系统中。`WSO2 ESB`可以用`API Manage`现有的替换`non-WSO2 ESB`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T22:47:29.630

是的，你可以这么做。

`ESB`无论实现它的底层产品的品牌是什么，该功能都是透明的。API 管理器将存储端点、WSDL 等，这些对于每个 ESB 实现都是相同的。

这就是 SOA 的“美”，它面向服务，而不是面向供应商。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T08:08:16.580

您可以在设置中保留您正在使用的 ESB，并使用 API Manager 发布/订阅/管理 API。它完全是一个有效的场景

问候，/女娲

# c# - 通过 MVC 4 Web API 的“真”REST 路由

> ID：14084387
> 
> 赞同：4
> 
> 时间：2012-12-29T17:54:19.670
> 
> 标签：c#, asp.net, api, rest, asp.net-routing

**TL;DR 摘要：*我可以为 HTTP GET、PUT 和 DELETE 配置 MVC Web API 路由吗？***

我一直在考虑用私有 API 替换我们旧的数据访问层（基于 DataSet 和 TableAdapters 的 DLL），以期在成功时创建公共 API。我已经使用 MVC 4 完成了一些工作来更新我们的前端，并且喜欢使用它，因此在深入研究基于 WS 或 WCF 的库之前探索“Web API”项目类型似乎是明智的。

初始演示允许我很好地返回 XML/JSON，例如：

> //service.url/api/Users

...返回用户列表，而特定用户的详细信息可以通过以下方式访问：

> //service.url/api/Users/99

到目前为止，如此 RESTful。但是，为了真正将 URI 映射到资源，我想对上面列出的 URI执行**HTTP PUT**（新用户）或**HTTP DELETE （删除用户）。**在我为这些项目看到的所有示例中，以及 Visual Studio 中提供的 Scaffolds 中，都遵循以下约定：

> //service.url/api/Users/创建
> 
> //service.url/api/Users/Delete/99
> 
> //service.url/api/Users/Update/99

... 等等。这对我来说就像是在回避这个问题，当那里的东西被很好地组合在一起时，这是一种耻辱！

关于如何最好地解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T18:00:59.720

你想要的是 MVC Web API 中的默认值。我不确定您在看什么，但这是[将 Get/Post/Put/Delete 路由到 actions](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api)的一个很好的示例。

例如，您可能想要：

```
public class UsersController : ApiController
{
  // GET http://service.url/api/Users/1
  [HttpGet]
  public User GetUser(int id);

  // POST http://service.url/api/Users/?name=richard...
  [HttpPost]
  public User AddUser(User model);      

  // PUT http://service.url/api/Users/?id=1&name=Richard...
  [HttpPut]
  public User UpdateUser(User model);

  // DELETE http://service.url/api/Users/1
  [HttpDelete]
  public User DeleteUser(int id);
} 
```

我已经明确设置了这些，但是`GetUser`and`DeleteUser`不需要前缀，因为它们[以匹配的 HTTP method 开头](https://stackoverflow.com/a/10471854/209259)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T21:05:04.130

Erik 提供的链接是一个好的开始，但是当我寻找一个使用 HTTP 动词来执行这些 CRUD 操作的简单 RESTful API 时，我看到它是如何混淆这种情况的。如果您正在寻找使用 GET、PUT、POST 和 DELETE 的 HTTP 动词（可能还有 PATCH，但我在这里不介绍）并且您可以使用约定，那么以下方法将起作用：

```
public class UsersController : ApiController
{
    // GET http://service.url/api/Users
    public User GetAllUsers(){ ... }

    // GET http://service.url/api/Users/1
    public User GetUser(int id){ ... }

    // POST http://service.url/api/Users/
    // User model is passed in body of HTTP Request
    public User PostUser([FromBody]User model){ ... }

    // PUT http://service.url/api/Users/1
    // User model is passed in body of HTTP Request
    public User PutUser(int id, [FromBody]User model){ ... }

    // DELETE http://service.url/api/Users/1
    public User DeleteUser(int id){ ... }
} 
```

请注意，在 Web API 中使用 HTTP 动词操作约定时，不需要方法上的属性。另外，请注意，我在 POST 和 PUT 的 User 参数上使用 [FromBody] 属性来表示正文包含我希望发送的数据。如果您尝试附加到资源，这对于 POST 可能不是最方便的，而且我还没有尝试使用 Web API 通过查询参数创建/修改数据。将您的数据放在正文中肯定会让通话感觉非常干净。“在此资源的正文中发布/放置此内容。”

另外，我在规范中阅读 PUT 的方式很可能是错误的，它充当了替代品。鉴于上面的最后一行，这也是有道理的。我将这个资源放在这个位置，替换已经存在的资源。规范 ( [http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) ) 指出：“如果 Request-URI 指的是已经存在的资源，则封闭的实体应该被视为一个驻留在源服务器上。” 他们使用的术语是“修改过的”，所以我想这为最终用户留下了足够的解释空间。这就是 PATCH 的用武之地（[https://www.rfc-editor.org/rfc/rfc5789](https://www.rfc-editor.org/rfc/rfc5789)），但目前我没有足够的信息对此发表评论。

# asp.net - 选择 ASP.NET RIA 框架进行快速开发？

> ID：14084388
> 
> 赞同：0
> 
> 时间：2012-12-29T17:54:25.740
> 
> 标签：asp.net, telerik, ria, componentone

我们有一个 ASP.NET silverlight 应用程序，它受到安装 Silverlight 的要求的限制。

我想切换到一个新的框架，但不想从头开始构建一个全新的系统。理想情况下，我希望找到一个第三方框架，该框架具有开箱即用的所有基础知识，因此我们可以开始将页面添加到应用程序并使用我们当前的业务逻辑（主要是 WCF 调用）。Telerik 和 ComponentOne 似乎是开始的好地方，但到目前为止，我还没有看到它们中的任何一个都有一个“完整的”应用程序可以用作起点。我错过了什么吗？你能推荐其他框架吗？我真的在寻找能给我们一个很好的起点的东西，以便在尽可能短的时间内开发出丰富的 UI。

我希望看到的一些功能是：

*   用户认证/注册/偏好
*   可定制的站点导航图
*   基于角色的可用页面
*   丰富的 UI 体验（右键加号）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:29:42.567

我可以代表 Telerik，因为我是 Telerik 的传道者之一。Telerik 在 ASP.NET AJAX 前端有 70 多个控件，它们都是 RAD 控件。您只需拖放即可，您可以灵活地使用 GUI 来设置属性或通过 HTML 或通过后面的代码。我们补充了 ASP.NET 必须提供的任何内容，因此不涉及单独的学习曲线。

为了让您感觉完整 - 我建议您查看以下集成示例 - 端到端场景应用程序。

奥运会 - [http://demos.telerik.com/aspnet-ajax/sample-applications/olympic-games/](http://demos.telerik.com/aspnet-ajax/sample-applications/olympic-games/)

图片库 - [http://demos.telerik.com/aspnet-ajax/imagegallery/](http://demos.telerik.com/aspnet-ajax/imagegallery/)

销售仪表板 - [http://demos.telerik.com/aspnet-ajax/salesdashboard/](http://demos.telerik.com/aspnet-ajax/salesdashboard/)

租车 - [http://demos.telerik.com/aspnet-ajax/carrental/](http://demos.telerik.com/aspnet-ajax/carrental/)

时间表生成器 - [http://demos.telerik.com/aspnet-ajax/schedulebuilder/](http://demos.telerik.com/aspnet-ajax/schedulebuilder/)

网络邮件 - [http://demos.telerik.com/aspnet-ajax/webmail/](http://demos.telerik.com/aspnet-ajax/webmail/)

电子商务 - [http://demos.telerik.com/aspnet-ajax/ecommercestore/](http://demos.telerik.com/aspnet-ajax/ecommercestore/)

更重要的是 - 所有这些演示都可以下载，您将获得源代码。因此，您可以直接从这些示例中建立您的项目。

请浏览所有上述集成示例。希望这可以为您的决策过程提供一些见解。

此外，我们确实有一个基于 HTML5 的 JavaScript UI 框架，称为 Kendo UI。这是一个使用 javascript 的完整客户端控件渲染，它将像任何东西一样加速您的应用程序。这可以在 ASP.NET MVC 场景中使用，因为这非常适合这些场景。尽管如此，无论您是否使用 MVC，您仍然可以在任何 Web 应用程序平台上使用作为 Kendo UI 一部分的基于 HTML5 的 JavaScript 小部件。

[http://demos.kendoui.c​​om/web/overview/index.html](http://demos.kendoui.com/web/overview/index.html)

希望这对你有帮助！

# android - 使用 Android 将大量记录从 Excel 文件导入 SQLite

> ID：14084397
> 
> 赞同：0
> 
> 时间：2012-12-29T17:55:00.747
> 
> 标签：android, sqlite

是否有可能使用 Android 将 MS-Excel 文件中的大量记录插入 Sqlite 数据库。如果有人可以，请在此处提供示例代码。因为我在 Excel 中有大约 1100 条记录，我必须在我的应用程序中使用这些记录. 谁能帮我节省我的时间...

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:06:46.977

为自己获取 Sqllite 的 OleDB 提供程序，然后连接到可以使用 ADO（老派）的数据库，或者您可以使用可以通过 CreateObject() 激活的 COM+ dll，一个好的起点是[http://www.sqlite .org/cvstrac/wiki?p=SqliteWrappers](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)和一个我之前实际使用过的[http://dimzon541.narod.ru/sqlitex/](http://dimzon541.narod.ru/sqlitex/)

### 你也可以使用[http://sqliteforexcel.codeplex.com/](http://sqliteforexcel.codeplex.com/)

可能是您可以将 excel 文件转换为 JSON，然后使用 JSON 解析您可以将数据重新输入到 sqlite

# assembly - 如何将单词写为 dword/qword？

> ID：14084399
> 
> 赞同：-3
> 
> 时间：2012-12-29T17:55:19.330
> 
> 标签：assembly, x86

我需要取一个词并将其作为 dword 放在偏移量中。我如何在 86x 汇编中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:13:25.517

听起来您想要一个符号扩展负载，例如`MOVZX`或`MOVSX`（对于零扩展，分别用于无符号或有符号扩展），那么您可以将其用作 32 位位移，例如：

```
MOVSX EAX,AX ;extend 16 bit to 32 bit
MOV EAX,[ESI+EAX] ;load a value using the 32bit displacement 
```

（上面的例子是相当做作的，因为寄存器内扩展还有其他指令，如`CWD`or `CDQ`，请参阅[this](http://sourceware.org/binutils/docs-2.22/as/i386_002dMnemonics.html)）。

# c# - 使 WebView 像 WebControl 工具一样显示在一个框中

> ID：14084402
> 
> 赞同：0
> 
> 时间：2012-12-29T17:55:31.253
> 
> 标签：c#, winforms, panel, awesomium

在 Awesomium 1.7 示例中，展示了如何使用整个窗口来呈现`WebView`输出。我希望它像他们的`WebControl`工具一样位于我的表单中的一个框内（而不是像示例中那样的整个表单，所以我可以有按钮）。我不能直接使用他们的 WebControl Tool，因为我需要模拟键盘输入，而 WebControl 不允许这样做。那么最简单的方法是什么，因为我目前不知道。我在这里问是因为我在 Awesomium 论坛上已经好几个星期没有收到回复了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T22:56:59.103

有两种方法可以做到这一点：

1.  `WebView`您可以在自定义 WinForms中呈现`Control`，而不是在`Form`. 然后将此控件添加到您的表单并相应地放置它。
2.  用户输入 API 在`WebControl`. 成员只是*受到保护*。您可以子类化`WebControl`并自己调用这些方法。

# entity-framework - 实体框架存在部分自动生成的复合键问题

> ID：14084403
> 
> 赞同：0
> 
> 时间：2012-12-29T17:55:32.563
> 
> 标签：entity-framework, sql-server-2008-r2

我一直在寻找一段时间试图弄清楚这一点。我正在尝试使用复合主键创建一个表。键的第一部分也是父表的外键。第二部分是在 SQL Server 上自动生成的。所以，我有一个应该是这样的表：

```
ParentId ChildId
-------- -------
 1        1
 1        2
 1        3
 2        1
 2        2
 2        3
 2        4 
```

ChildId 列仅在 ParentId 的上下文中是唯一的。这些值是使用 INSTEAD OF INSERT 触发器在服务器上自动生成的，因此每个 ChildId 都有自己的序列。

我的问题是，虽然这在 SQL Server 和经典 ADO.NET`SqlCommand`语句中很有效，但 Entity Framework 不想使用它。

如果我将 ChildId 列的 StoreGeneratedPattern 设置为 Identity，则 EF 会生成如下所示的 SQL：

```
insert [dbo].[ChildTable]([ParentId], [Name])
values (@0, @1)
select [ChildId]
from [dbo].[ChildTable]
where @@ROWCOUNT > 0 and [ParentId] = @0 and [Id] = scope_identity() 
```

这只会产生一个错误：

> System.Data.Entity.Infrastructure.DbUpdateConcurrencyException：存储更新、插入或删除语句影响了意外的行数 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。
> ----> System.Data.OptimisticConcurrencyException：存储更新、插入或删除语句影响了意外的行数 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。

但是，如果我使用基于 GUID 的键创建测试表并将 StoreGeneratedPattern 设置为 Identity，则生成的 SQL 如下所示：

```
declare @generated_keys table([Id] uniqueidentifier)
insert [dbo].[GuidTable]([Name])
output inserted.[Id] into @generated_keys
values (@0)
select t.[Id]
from @generated_keys as g join [dbo].[GuidTable] as t on g.[Id] = t.[Id]
where @@ROWCOUNT > 0 
```

并且我的应用程序中的实体使用 SQL Server 生成的 GUID 的值进行更新。

因此，这表明该列不必是 IDENTITY 列，以便实体框架返回值，但是，由于它使用逻辑表`inserted`，因此 ChildId 的值不会是它被更改为的值由触发器。此外，该`inserted`表不能应用 UPDATE 操作以将值推回触发器内（试过了，它说“无法更新逻辑表 INSERTED 和 DELETED。”）

我觉得我已经把自己逼到了一个角落，但在我重新考虑设计之前，有什么办法可以通过实体框架将 ChildId 值返回到应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:39:23.453

我发现这篇文章提供了一个建议：[http ://wiki.alphasoftware.com/Scope_Identity+in+SQL+Server+with+nested+and+INSTEAD+OF+triggers](http://wiki.alphasoftware.com/Scope_Identity+in+SQL+Server+with+nested+and+INSTEAD+OF+triggers)

TL;DR 版本是在最后`INSTEAD OF INSERT`执行 a`SELECT`以返回密钥。这篇文章是针对`SCOPE_IDENTITY()`由于触发器而导致的价值损失，但它也适用于此。

所以，我所做的是：

触发器现在显示为

```
ALTER TRIGGER dbo.IOINS_ChildTable
ON  dbo.ChildTable
  INSTEAD OF INSERT
AS 
BEGIN
SET NOCOUNT ON;
-- Acquire the lock so that no one else can generate a key at the same time.
-- If the transaction fails then the lock will automatically be released.
-- If the acquisition takes longer than 15 seconds an error is raised.
DECLARE @res INT;
EXEC @res = sp_getapplock @Resource = 'IOINS_ChildTable', 
  @LockMode = 'Exclusive', @LockOwner = 'Transaction', @LockTimeout = '15000',
  @DbPrincipal = 'public'
IF (@res < 0)
BEGIN
  RAISERROR('Unable to acquire lock to update ChildTable.', 16, 1);
END

-- Work out what the current maximum Ids are for each parent that is being
-- inserted in this operation.
DECLARE @baseId TABLE(BaseId int, ParentId int);
INSERT INTO @baseId
SELECT MAX(ISNULL(c.Id, 0)) AS BaseId, i.ParentId
  FROM  inserted i
  LEFT OUTER JOIN ChildTable c ON i.ParentId = c.ParentId
  GROUP BY i.ParentId

-- The replacement insert operation
DECLARE @keys TABLE (Id INT);
INSERT INTO ChildTable
OUTPUT inserted.Id INTO @keys
SELECT 
  i.ParentId, 
  ROW_NUMBER() OVER(PARTITION BY i.ParentId ORDER BY i.ParentId) + b.BaseId 
    AS Id,
  Name
FROM inserted i
INNER JOIN @baseId b ON b.ParentId = i.ParentId

-- Release the lock.
EXEC @res = sp_releaseapplock @Resource = 'IOINS_ChildTable', 
  @DbPrincipal = 'public', @LockOwner = 'Transaction'

SELECT Id FROM @keys
END
GO 
```

实体模型的 Id 列`StoreGeneratedPattern`设置为`Identity`。这意味着当实体框架尝试读取时，`SCOPE_IDENTITY()`它将获得`SELECT`触发器中的语句提供的值，而不是它自己`SELECT ... SCOPE_IDENTITY()`提供的值，它现在位于 EF 不期望的下一个结果集中并将忽略。

这有一些明显的问题。

因为触发器现在选择要从触发器返回的数据，这意味着插入一些数据并执行自己的选择的其他代码（例如存储过程）将把来自自己选择的数据推出。因此，如果您的代码只需要一个数据库操作的结果集，那么它现在有一个额外的结果集。

如果您只打算使用实体框架，那么这一切都可以。但是，我不能说未来会怎样，所以我对这个解决方案并不完全满意。

# windows-8 - 添加/删除 AppBar 按钮动画

> ID：14084404
> 
> 赞同：2
> 
> 时间：2012-12-29T17:55:38.627
> 
> 标签：windows-8, winrt-xaml

我有一个 WinRT 应用程序，其中 AppBar 按钮可以是两个按钮之一，具体取决于所选内容。从一个按钮更改为另一个按钮很简单，但是它缺乏我们在 WinRT 中所追求的视觉流畅性。

我正在寻找的视觉行为也可以在 Windows 8 附带的邮件应用程序中看到。如果您选择一条消息并调出底部的 AppBar，点击“标记为已读/未读”按钮会在两个按钮。

有谁知道这是一个预卷动画还是我必须手动实现它（或者更好，是否已经有解决方案）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:43:10.310

可用的过渡位于 Windows.UI.Xaml.Media.Animation 命名空间中。[看看那里有什么](http://msdn.microsoft.com/en-us/library/windows/apps/jj218361.aspx)，如果你没有看到你在找什么，那么你将不得不创建你自己的。

看起来与我最相似的过渡是 AddDeleteThemeTransition，尽管效果仅在添加/删除应用栏项目时出现，而不是在打开应用栏时出现。

这是它的使用示例

```
 <AppBar>
        <Grid>
            <StackPanel x:Name="LeftPanel" Orientation="Horizontal">
                <Button x:Name="Search" Style="{StaticResource SearchAppBarButtonStyle}" />
                <StackPanel.ChildrenTransitions>
                    <TransitionCollection>
                        <AddDeleteThemeTransition/>
                    </TransitionCollection>
                </StackPanel.ChildrenTransitions>
            </StackPanel>
        </Grid>
    </AppBar> 
```

# javascript - TypeScript 和 Socket.io

> ID：14084406
> 
> 赞同：10
> 
> 时间：2012-12-29T17:55:42.263
> 
> 标签：javascript, node.js, web, socket.io, typescript

我想在我的 Typescript 项目中使用 socket.io，但我只找到了用于服务器端 typescript 的 .d.ts 文件。

这是一个很好的例子：[https ://github.com/soywiz/typescript-node-definitions/blob/master/socket.io.d.ts](https://github.com/soywiz/typescript-node-definitions/blob/master/socket.io.d.ts)

它展示了如何将 TypeScript 与 Socket.io 结合使用。但是在客户端，它使用 JavaScript。

我需要的是用于客户端 TypeScript 的 .d.ts 文件，它可以解决此行的错误消息：

```
var socket=io.connect("localhost"); 
```

> 当前范围内不存在名称“io”

我在哪里可以找到合适的定义文件？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2017-02-14T09:48:37.207

现在有@types/socket.io，只需通过运行安装它：

`npm i --save @types/socket.io`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-10-10T12:11:45.453

您应该在客户端使用[socket.io-client](https://github.com/borisyankov/DefinitelyTyped/tree/2d4c4679bc2b509f27435a4f9da5e2de11258571/socket.io-client) d.ts 文件，同时在服务器上使用[socket.io](https://github.com/borisyankov/DefinitelyTyped/tree/40506907409eed93e875064f01056dbf79149f91/socket.io) d.ts 文件。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-12-30T16:55:42.453

我创建了自己的 .d.ts 文件，它很短但效果很好：

```
declare var io : {
    connect(url: string): Socket;
};
interface Socket {
    on(event: string, callback: (data: any) => void );
    emit(event: string, data: any);
} 
```

这个声明文件可以导入到客户端 Typescript 并且 socket.io 标准示例可以工作，这是我的 Typescript 版本：

```
var socket=io.connect("localhost");
socket.on("news",(data:any)=>alert(data));
socket.emit("news","hello"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-15T16:36:14.137

在里面`@types/socket.io-client`，您可以找到以下最适合客户的类型：

```
const client: SocketIOClient.Socket = io('http://localhost'); 
```

# python - 生成 5 张扑克牌

> ID：14084412
> 
> 赞同：0
> 
> 时间：2012-12-29T17:56:45.240
> 
> 标签：python, loops, poker

我一直在尝试为 IRC 制作一个扑克游戏机器人，但我似乎无法处理这些牌。

我知道这个算法效率很低，但这是我使用我目前的 Python 技能所能想到的最好的算法。欢迎任何改进！

玩家是一个字典，其中键是玩家的昵称，值是他们拥有的金额。

当代码运行时，如果只有 1 名玩家，它应该给出 5 张牌。但如果有 2 名玩家，则每人会生成 4 到 6 张牌。我还没有测试更多的玩家。

一些预先初始化的变量：

```
numberOfPlayers = 0 #The numerical value of the amount of players in the game
players = {} #The nickname of each player and the amount of money they have
bets = {} #How much each player has bet
decks = 1 #The number of decks in play
suits = ["C","D","H","S"] #All the possible suits (Clubs, Diamonds, Hearts, Spades)
ranks = ["2","3","4","5","4","6","7","8","9","J","Q","K","A"] #All the possible ranks (Excluding jokers)
cardsGiven = {} #The cards that have been dealt from the deck, and the amount of times they have been given. If one deck is in play, the max is 1, if two decks are in play, the max is 2 and so on...
hands = {} #Each players cards 
```

编码：

```
def deal(channel, msgnick):
    try:
        s.send("PRIVMSG " + channel + " :Dealing...\n")
        for k, v in players.iteritems():
               for c in range(0, 5):
                suit = random.randrange(1, 4)
                rank = random.randrange(0,12)
                suit = suits[suit]
                rank = ranks[rank]
                card = rank + suit
                print(card)
                if card in cardsGiven:
                    if cardsGiven[card] < decks:
                        if c == 5:
                            hands[k] = hands[k] + card
                            cardsGiven[card] += 1
                        else:
                            hands[k] = hands[k] + card + ", "
                            cardsGiven[card] += 1
                    else:
                        c -= 1
                else:
                    if c == 5:
                        hands[k] = hands[k] + card
                        cardsGiven[card] = 1
                    else:
                        hands[k] = hands[k] + card + ", "
                        cardsGiven[card] = 1
            s.send("NOTICE " + k + " :Your hand: " + hands[k] + "\n")
    except Exception:
        excHandler(s, channel) 
```

如果需要任何示例或进一步解释，请询问:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:06:47.943

## `for`循环

```
for c in range(0, 5):

...

    c -= 1 
```

不幸的是，这不是`for`循环在 Python 中的工作方式——递减 c 不会导致循环的另一个复飞。`for`循环遍历在循环开始之前固定的一组项目（例如`range(0,5)`，在循环期间未修改的 5 个项目的固定范围）。

如果你想做你正在做的事情，你需要使用一个`while`循环（它通过一个*可以*在循环期间修改的变量和条件工作）：

```
c = 0
while c < 5:
    c += 1

    ...

    c -= 1 
```

* * *

## `range()`编号

```
if c == 5: 
```

这种情况目前不会被击中，因为会`range(N)`生成一个从`0`to `N-1`- 例如`range(5)`generate的数字序列`0,1,2,3,4`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T18:36:34.290

我会使用`itertools.product`将卡片的可能价值放入列表中，然后将其洗牌并为您想要的每个玩家一次取 5 张卡片。

```
from itertools import product
from random import shuffle

suits = ["C","D","H","S"] 
ranks = ["2","3","4","5","4","6","7","8","9","J","Q","K","A"]

cards = list(r + s for r, s in product(ranks, suits))
shuffle(cards)

print cards[:5], cards[5:10] # change this into a suitable for loop to slice
['4D', 'KC', '5H', '9H', '7D'] ['2D', '4S', '8D', '8S', '4C'] 
```

你可以使用下面的配方`itertools`来获得接下来的 5 张牌，具体取决于玩家人数。

```
def grouper(n, iterable, fillvalue=None):
    from itertools import izip_longest
    "Collect data into fixed-length chunks or blocks"
    # grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx
    args = [iter(iterable)] * n
    return izip_longest(fillvalue=fillvalue, *args)

hand = grouper(5, cards) 
for i in xrange(5): # deal for 5 players...
    print next(hand) # each time we call this, we get another 5 cards

('4D', 'KC', '5H', '9H', '7D')
('2D', '4S', '8D', '8S', '4C')
('AD', '2H', '4S', 'KS', '9S')
('6H', 'AH', '4H', '5S', 'KD')
('6S', 'QD', '3C', 'QC', '8H') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:29:28.770

使用切片来完成此操作的一种简单方法可能是：

```
num_players = 5
num_cards_per_player = 5
remaining_cards = list(range(100)) # Imagine a list backing a Deck object
num_cards_to_deal = num_players * num_cards_per_player
cards_to_deal, remaining_cards = (remaining_cards[0:num_cards_to_deal],
        remaining_cards[num_cards_to_deal:])
cards_for_each_player = [cards_to_deal[player_num::num_players] for
        player_num in range(num_players)]
cards_for_each_player
[[0, 5, 10, 15, 20], [1, 6, 11, 16, 21], [2, 7, 12, 17, 22], [3, 8, 13, 18, 23], [4, 9, 14, 19, 24]] 
```

对于特定类型的卡片组，您可以实现一个卡片组对象并使用上述代码稍作修改以用于方法中。卡组对象将需要处理剩余卡牌不足的情况:)，这可能是您正在玩的游戏所特有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:55:57.637

```
#! /usr/bin/python3.2

import random

players = ['Alice', 'Bob', 'Mallroy']
suits = ["C","D","H","S"]
ranks = ["2","3","4","5","4","6","7","8","9","J","Q","K","A"]
decks = 2
cards = ['{}{}'.format (s, r)
         for s in suits
         for r in ranks
         for d in range (decks) ]

random.shuffle (cards)
for player in players:
    print ('{}\'s hand is {}'.format (player, cards [:5] ) )
    cards = cards [5:] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-19T05:08:02.000

只需使用 Python[`deuces`](https://github.com/worldveil/deuces)库，它是专门为这种用途而构建的：

```
from deuces import Card
from deuces import Deck

# create deck and shuffle it
deck = Deck()
deck.shuffle()

# play a texas hold 'em game with two players
board = deck.draw(5)
player1_hand = deck.draw(2)
player2_hand = deck.draw(2)

# now see which hand won
from deuces import Evaluator
evaluator = Evaluator()
p1handscore = evaluator.evaluate(board, player1_hand)
p2handscore = evaluator.evaluate(board, player2_hand) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-21T05:58:44.080

```
from random import randint

# This code below creates a deck
cards = []
for suit in ["diamond","club","heart","spade"]:
    for card in ['A','2','3','4','5','6','7','8','9','10','J','Q','K']:
        cards.append(card+' '+suit)
# To deal the cards we will take random numbers
for i in range(5):
    a = randint(0,len(cards)-1)
    print cards(a)
    del cards[a] # We will delete the card which drew 
```

首先我们创建一个牌组，然后我们取一个随机数，`randint`然后我们用随机数抽一张牌

我有一个程序来绘制翻牌和手牌

```
def create_card():
    cards = []
    for suit in   [r'$\diamondsuit$',r'$\clubsuit$',r'$\heartsuit$',r'$\spadesuit$']:
        for card in  ['A','2','3','4','5','6','7','8','9','10','J','Q','K']:
            cards.append(card+suit)
    return cards

def create_board_and_hand():
    cards = create_card()
    board = []
    for i in [0,1,2,3,4]:
    a  = randint(0,len(cards)-1)
    board.append(cards[a])
    del cards[a]
    hand = []
    for i in [0,1]:
        a  = randint(0,len(cards)-1)
        hand.append(cards[a])
        del cards[a]
    return board,hand

board,hand = create_board_and_hand() 
```

# c++ - 使用 C++ 在 Linux 中通过 select 读取 ICMP 回复

> ID：14084416
> 
> 赞同：3
> 
> 时间：2012-12-29T17:57:25.780
> 
> 标签：c++, linux, select, icmp

我正在使用 C++ 和原始套接字向路由器发送 ICMP 请求，之后我想读取 ICMP 回复。我的问题是， select() 没有收到重播和超时。我没有收到任何错误（errno 正在返回成功）。路由器正在发送 ICMP 回复，因为我可以使用 Wireshark 看到回复。

[http://i.imgur.com/0Wra1.png](http://i.imgur.com/0Wra1.png) *wireshark 截图*

为了测试我的程序，我使用在 VirtualBox 4.2.6 和 GN3 上运行的 Ubuntu 12.10 作为虚拟网络。

我的源代码：

```
char buffer[IP_MAXPACKET]; // for the received ICMP reply
struct iphdr *ipRec; // ICMP header
timeval tv; // timeout
fd_set mySet; // descriptor set
...
tv.tv_sec = 3; // default time-out 3s
tv.tv_usec = 0;

int retval; // select
...
do {
        FD_ZERO(&mySet);
        FD_SET(mysocket, &mySet);

        retval = select(mysocket+1, &mySet, NULL, NULL, &tv);

        cout << "Errno after select:" << strerror(errno) << endl;

        if(retval == -1) {
            cerr << "select error" << endl;
            break;
        }
        else if (retval) {
            if((length = recvfrom(mysocket, buffer, MAX, 0, result->ai_addr, &(result->ai_addrlen))) == -1) {
                cerr << "Error: while receiving data." << endl;
            }
            else {
                cout << "good" << endl;

                ipRec = (struct iphdr*) buffer;
                icmpRec = (struct icmphdr*) (buffer + ipRec->ihl * 4);

                cout << "the packet." << " PID: " << ntohs(icmpRec->un.echo.id) << " Seq: " << ntohs(icmpRec->un.echo.sequence) << endl;

                if ((icmpRec->type == ICMP_ECHOREPLY) && (ntohs(icmpRec->un.echo.id) == pid) && (ntohs(icmpRec->un.echo.sequence) == (seq - 1))) {
                    minBuff = lengthBuff;
                }
            }
        } else {
            // getting here all the time = select times-out and reads no data

            cout << "mysocket:" << mysocket << endl;
            cout << "retval:" << retval << endl;
            maxBuff = lengthBuff;
            break;
        }
    } while (!((icmpRec->type == ICMP_ECHOREPLY) && (ntohs(icmpRec->un.echo.id) == pid) && (ntohs(icmpRec->un.echo.sequence) == (seq - 1))));

    if (packet)
        delete(packet);
    ... 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:40:09.573

修复了问题。在另一个线程中找到了解决方案：[ICMP 数据包没有被发送 C](https://stackoverflow.com/questions/9688899/icmp-packets-are-not-being-sent-c?rq=1)。将 IPPROTO_RAW 更改为 IPPROTO_ICMP 修复了它。现在是选择读取 ICMP 回复数据包。

# parsing - 是否存在左关联前缀运算符或右关联后缀运算符之类的东西？

> ID：14084421
> 
> 赞同：7
> 
> 时间：2012-12-29T17:57:53.893
> 
> 标签：parsing, language-agnostic

[这个页面](http://www.cs.man.ac.uk/~pjj/cs211/ho/node2.html#SECTION00024000000000000000)说“前缀运算符**通常是**右关联的，而后缀运算符是左关联的”（强调我的）。

是否有左关联前缀运算符或右关联后缀运算符的真实示例？如果不是，假设的会是什么样子，如何解析？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:47:10.627

原则上可以有。例如，考虑前缀一元加减运算符：假设`+`是恒等运算并`-`否定一个数值。

它们“通常”是右结合的，意思`+-1`是等价于`+(-1)`，结果是负一。

假设它们是左结合的，那么表达式`+-1`将等价于`(+-)1`。

因此，语言必须为子表达式赋予意义`+-`。语言“通常”不需要它具有含义并且不赋予它一个含义，但是您可能可以想象一种函数式语言，其中将恒等运算符应用于否定运算符的结果是一个运算符/函数，它具有完全与否定运算符相同的效果。那么对于本例，完整表达式的结果将再次为 -1。

实际上，如果将并列函数/运算符的结果定义为与以从右到左的顺序应用两者具有相同效果的函数/运算符，那么将它们关联的方式*始终*对表达式的结果没有影响. 这些只是定义它的两种不同方式`(f g)(x) == f(g(x))`。但是，如果您的语言定义`+-`为除 之外的其他含义`-`，那么关联性的方向将很重要（而且我怀疑对于习惯于“通常”语言的人来说，该语言将很难阅读……）

另一方面，如果语言不允许并列操作符/函数，那么前缀操作符*必须*是右结合的以允许表达式`+-1`。不允许并列是另一种`(+-)`没有意义的说法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T02:05:35.360

我不知道在真实语言中这样的事情（例如，至少有十几个人使用过的语言）。我怀疑“通常”仅仅是因为证明否定几乎是不可能的，因此通过不做出绝对陈述来避免关于琐事的争论更容易。

至于你理论上如何做这样的事情，似乎有两种可能性。给定两个前缀运算符`@`并且`#`您将其视为左关联，您可以将其解析`@#a`为等价于`#(@(a))`. 至少对我来说，这似乎是一个真正可怕的想法——理论上是可能的，但这种语言即使是他们最大的敌人也不应该希望。

另一种可能性是`@#a`被解析为`(@#)a`. 在这种情况下，我们基本上将`@`and组合`#`成一个运算符，然后将其应用于`a`.

在大多数典型的语言中，这可能不会很有趣（本质上与它们是右结合的含义相同）。另一方面，我可以想象一种面向多线程编程的语言，它规定单个运算符的应用程序始终是原子的 - 当您使用左关联解析将两个运算符组合成一个时，产生的融合运算符仍然是一个单一的原子操作，而仅仅连续应用它们就不会（必然）是。

老实说，即使这有点牵强，但我至少可以想象这是一种可能性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T23:52:52.513

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T22:24:24.323

I hate to shoot down a question that I myself asked, but having looked at the two other answers, would it be wrong to suggest that I've inadvertently asked a subjective question, and that in fact that the interpretation of left-associative prefixes and right-associative postfixes is simply [undefined](http://en.wikipedia.org/wiki/Undefined_behavior)?

Remembering that even notation as pervasive as expressions is built upon a handful of conventions, if there's an edge case that the conventions never took into account, then maybe, until some standards committee decides on a definition, it's better to simply pretend it doesn't exist.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T16:42:28.470

假设的例子。一种语言的前缀运算符**@**和后缀运算符**#**具有相同的优先级。如果两个运算符都是左关联的，则表达式**@x#**将等于**(** **@x)#；**如果两个运算符都是右关联的，则表达式 @x# 将等于 (@x)# 。

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T18:47:13.787

我不记得任何左关联前缀运算符或右关联后缀运算符。但我可以想象两者都可以轻松存在。它们并不常见，因为人们寻找操作员的自然方式是：**更接近身体的方式 - 先申请**。

来自 C#/C++ 语言的简单示例：

`~-3`相等`2`，但 `-~3`相等`4`

这是因为这些前缀运算符是右结合的，因为`~-3`这意味着首先应用 - 运算符，然后将 ~ 运算符应用于前一个结果。这将导致整个表达式的值将等于`2`

假设您可以想象，如果这些运算符是左关联的，那么`~-3`首先应用最左边的运算符`~`，然后应用`-`到前一个的结果。这将导致整个表达式的值将等于`4`

**[编辑]**回答**史蒂夫杰索普**：

史蒂夫说：`the meaning of "left-associativity" is that +-1 is equivalent to (+-)1`

我不同意这一点，并认为这是完全错误的。为了更好地理解左关联性，请考虑以下示例：

假设我有一个带有左关联前缀运算符的假设编程语言：

`@`- 将操作数乘以`3`

`#`- 添加`7`到操作数

比我的语言中的以下构造`@#5`将等于`(5*3)+7 == 22` 如果我的语言是右结合的（如大多数常用语言），我将拥有`(5+7)*3 == 36`

请让我知道，如果你有任何问题。**

# c# - 声明 int 外部逻辑

> ID：14084423
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:58:05.600
> 
> 标签：c#, winforms, visual-studio-2008

昨天我只是问[逻辑，如果其他错误](https://stackoverflow.com/questions/14076171/c-sharp-if-else-logic-error/14076578)。但是当我这样做的时候？**int**，它的错误...

```
 private static void mergeimagefile(string image1path, string image2path)
    {
        //get all the files in a directory
        string jpg1 = @image1path;
        string jpg2 = @image2path;
        string jpg3 = @image2path;

        Image img1 = Image.FromFile(jpg1);
        Image img2 = Image.FromFile(jpg2);

        //int width = img1.Width + img2.Width;
        int width = 640;
        //int height = Math.Max(img1.Height, img2.Height);
        int height = 360;
        int w;

        if (img2.Width > 640) {
            w = 640;
        }
        else if (img2.Width <= 640)
        {
            w = ((width - img2.Width) / 2);
        }
        System.Windows.Forms.MessageBox.Show(w.ToString());

        int h = new int();
        if (img2.Height > 360)
        {
            h = 360;
        }
        else if (img2.Height <= 360)
        {
            h = (height - img2.Height) / 2;
        }

        Bitmap img3 = new Bitmap(width, height);
        Graphics g = Graphics.FromImage(img3);

        g.Clear(Color.Black);
        g.DrawImage(img1, new Point(0, 0));
        //ERROR IN HERE
        g.DrawImage(img2, new Point(w, h));

        g.Dispose();
        img1.Dispose();
        img2.Dispose();

        img3.Save(jpg3, System.Drawing.Imaging.ImageFormat.Jpeg);
        img3.Dispose();

    } 
```

我已经尝试添加, `int?`, `int w = null;`, 并且根据[这个 Msdn Manual](http://msdn.microsoft.com/en-us/library/2cf62fcy.aspx)，它仍然给我错误？

> 错误 1 ​​使用未分配的局部变量 'w' C:\Documents and Settings\admin\My Documents\Visual Studio 2008\Projects\template\template\Form1.cs 68 50 模板

如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:00:36.317

怎么样

```
int w = 0; 
```

那应该处理初始化错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:01:13.033

您需要分配一个值，因此将其初始化为 0。

```
int w = 0; 
```

您需要这样做的原因是，如果您不匹配这些值中的任何一个

```
if (img2.Width > 640)
{
    w = 640;
}
else if (img2.Width <= 640)
{
    w = ((width - img2.Width) / 2);
} 
```

然后`w`将被取消分配。

也以相同的方式分配`h`，因为`int h = new int();`它不是初始化整数的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:10:42.633

`int? w = null; Represents a value type that can be assigned null.`[在此处输入链接描述][1] 为什么不初始化 int w = 0 或

如果你想变得花哨

```
int w = default(int); //this is equiv to saying int w = 0; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:25:32.137

编译器认为语句`w`之后的值可能是未定义的。`if`它的构建不够聪明，无法认识到条件实际上涵盖了所有情况。

第二个`if`陈述是多余的，因为如果第一个条件为假，它总是为真。只需删除第二`if`条语句并将代码放入`else`：

```
if (img2.Width > 640) {
  w = 640;
} else {
  w = ((width - img2.Width) / 2);
} 
```

现在编译器可以很容易地看到变量总是得到一个值。

# ssl - 如何为不同的域模式选择一个通用名称

> ID：14084435
> 
> 赞同：0
> 
> 时间：2012-12-29T17:59:19.773
> 
> 标签：ssl

我的 SSL 密钥的通用名称是`.mydomain.com`. 我应该获得什么通用名称，以便我可以使用和之类的`https://api.mydomain.com`URL `https://api-test.mydomain.com`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:05:06.853

您可以使用 *.mydomain.com 创建通配符证书

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-29T10:47:15.037

不知何故，通配符 ssl 和简单域 ssl 都是相同的。对于您的 SSL 密钥问题，您应该做的唯一更改是通用名称。通配符 ssl 需要 *.yourdomain.tld 的密钥。

PS：所有 SSL CA 都需要 2048 位 CSR 密钥。

在这里，您可以检查它如何产生差异和相似之处。

技术差异：

1.  简单 ssl 和通配符 ssl 带有不同的通用名称。如上所述。
2.  简单 SSL 仅保护 www 和非 www 域名。通配符可以保护无限的子域名。

类似术语：

1.  两者都需要域控制验证过程。每个人都必须通过 DCV 流程来获得 ssl 证书。
2.  两者都支持相同技术的 ssl 加密。
3.  两者都需要 2048 位 CSR 密钥。

# css - 阴影问题

> ID：14084438
> 
> 赞同：0
> 
> 时间：2012-12-29T17:59:35.740
> 
> 标签：css

以下是我试图在桌子上投下阴影的 jsfiddle。问题是阴影落在桌子的底部和右侧，但不在桌子的左侧和顶部，请告诉我如何修改小提琴的 css，以便阴影会落在桌子的所有侧面。谢谢，

[http://jsfiddle.net/7RQtq/](http://jsfiddle.net/7RQtq/)

```
.shadow {
    -moz-box-shadow: 3px 3px 4px #000;
    -webkit-box-shadow: 3px 3px 4px #000;
    box-shadow: 3px 3px 4px #000;
    /* For IE 8 */
    -ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000')";
    /* For IE 5.5 - 7 */
    filter: progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:02:16.387

### 重置 x, y 坐标：

```
-moz-box-shadow: 0px 0px 4px #000;
-webkit-box-shadow: 0px 0px 4px #000;
box-shadow: 0px 0px 4px #000;
border-radius: 5px; 
```

### 解释

第一个选项是`x`坐标，第二个是`y`。因此，将两者重置为`0px`将使您居中。并且，增加传播，第三个值，会给你喜欢 Photoshop。此外，给予一些`border-radius`将准确地显示你想要的方式。

### 截屏

![](../Images/4dd8cf7c6a8f59c072aa603160dd6afd.png)

### 小提琴：http: [//jsfiddle.net/7RQtq/4/](http://jsfiddle.net/7RQtq/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:02:22.927

不了解旧版 IE 过滤器，但对于其他浏览器，您可以使用`box-shadow: 0 0 16px #000;`. 前两个值表示偏移，第三个值表示阴影的模糊。

*   演示：http: [//jsfiddle.net/7RQtq/3/](http://jsfiddle.net/7RQtq/3/)
*   生成器工具：[http ://www.webtutorialplus.com/box-shadow.aspx](http://www.webtutorialplus.com/box-shadow.aspx)
*   规格：[http ://www.w3.org/TR/css3-background/#box-shadow](http://www.w3.org/TR/css3-background/#box-shadow)

> 'box-shadow' 属性将一个或多个阴影附加到盒子上。该属性是一个以逗号分隔的阴影列表，每个阴影由 2-4 个长度值、一个可选颜色和一个可选的“inset”关键字指定。省略的长度为 0；省略的颜色是 UA 选择的颜色。
> 
> 哪里=插图？&& [ {2,4} && ? ]
> 
> 每个组件的解释如下：
> 
> 1.  第一个长度是阴影的水平偏移。正值绘制在框右侧偏移的阴影，向左绘制负长度。
>     
>     
> 2.  第二个长度是垂直偏移。正值抵消阴影向下，负值向上抵消。
>     
>     
> 3.  第三个长度是模糊半径。不允许使用负值。如果模糊值为零，则阴影的边缘很锐利。否则，值越大，阴影边缘越模糊。见下文。
>     
>     
> 4.  第四个长度是传播距离。正值会使阴影形状在所有方向上扩展指定的半径。负值会导致阴影形状收缩。见下文。请注意，对于内部阴影，扩大阴影（创建更多阴影区域）意味着收缩阴影的周边形状。
>     
>     
> 
> 颜色是阴影的颜色。如果颜色不存在，则使用的颜色取自“颜色”属性。

正如您可能想象的那样，您可以使用这些值的组合创建复杂（和精细）的效果，例如：

*   [http://studentwebhosting.com/tutorials/amazing-css3-box-shadow-examples/](http://studentwebhosting.com/tutorials/amazing-css3-box-shadow-examples/)
*   [http://viget.com/inspire/39-ridiculous-things-to-do-with-css3-box-shadows](http://viget.com/inspire/39-ridiculous-things-to-do-with-css3-box-shadows)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:03:39.400

前两个参数是 x（右）和 y（下）平移...将它们设置为 0px 以获得居中的阴影：

[http://jsfiddle.net/7RQtq/1/](http://jsfiddle.net/7RQtq/1/)

```
-moz-box-shadow: 0px 0px 4px #000;
-webkit-box-shadow: 0px 0px 4px #000; 
```

# google-maps - 渲染方向时在高程图上显示距离

> ID：14084439
> 
> 赞同：0
> 
> 时间：2012-12-29T17:59:48.017
> 
> 标签：google-maps, google-maps-api-3

我想在我的应用程序中显示一个高程图，该图还显示了从特定路线起点的距离。

我找到了这个例子，它显示了一条路线的基本海拔图。

[http://www.geocodezip.com/v3_elevation-profile_distance.html](http://www.geocodezip.com/v3_elevation-profile_distance.html)

有没有办法在底部的图表中准确显示沿 x 轴的距离？

google.maps.ElevationResult 不包含距离的事实似乎使这非常困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:13:41.540

这是每个县的行车路线和里程的另一个示例：

[http://maps.forum.nu/v3/gm_directions.html](http://maps.forum.nu/v3/gm_directions.html)

那是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:17:29.317

高程服务结果包含结果的经纬度坐标、高程和分辨率。根据坐标，您可以计算点之间的距离（使用[几何库](https://developers.google.com/maps/documentation/javascript/reference#spherical)computeDistanceBetween 方法）。

# objective-c - NSFetchedResultsController 对象不是最新的

> ID：14084440
> 
> 赞同：0
> 
> 时间：2012-12-29T18:00:20.227
> 
> 标签：objective-c, ios, cocoa-touch, core-data

我有一个带有 tablview 的视图控制器，它显示来自 NSFetchedResultsController 的数据，这很好，它运行良好。

FRC 中的每个对象都代表一个已从服务器下载或尚未从服务器下载的文件。当用户点击一行时，应用程序会检查文件是否已下载，如果没有下载，则更新对象以标记它已下载。当用户再次点击该行时，它应该知道它已被下载，并且只需打开文件。

然而，正在发生的事情是文件已下载，并且对象正在更新，但是当我再次点击该行时，该对象的 FRC 版本尚未更新以反映新的更改，因此它不会认为该文件已被下载，因此再次下载它。

我需要重新获取 FRC 中的数据还是我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:14:25.287

原来这是我自己的错误。我在其他地方遇到了一个问题，导致创建了新对象，因此 FRC 返回了错误的对象。然后当正确的对象被更新时，FRC 并不知道它，因为它引用了错误的对象

# xcode - OSX：如何本地化鼠标飞过扩展坞中的应用程序图标时出现的名称？

> ID：14084449
> 
> 赞同：5
> 
> 时间：2012-12-29T18:01:27.313
> 
> 标签：xcode, macos, localization, internationalization, icons

当用户的鼠标悬停在 Dock 中的应用程序图标上时，应用程序的名称会出现在应用程序图标上。

根据我刚刚执行的测试，它显示的名称对应于项目目标中定义的“产品名称”（在“构建设置”菜单中）。

问题是：当用户将鼠标放在我的应用程序图标上时，如何本地化这个目标产品名称以便让我的应用程序名称使用正确的语言？

或者是否有任何其他方法可以本地化当用户将鼠标放在我的应用程序图标上时出现的应用程序名称？

谢谢 ！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-08-19T10:53:19.027

这么多年后，这个问题仍然困扰着我（可能还有成千上万的其他程序员）一个多小时。

鉴于 Daij-Djan 上面接受的答案中的链接已经失效（更新的链接现在位于[https://kb.applingua.com/2015/10/how-to-localize-app-names/](https://kb.applingua.com/2015/10/how-to-localize-app-names/)），我'我用我添加的案例写了另一个答案。

确保您已完成以下操作：

1.  ~~Info.plist 没有为您的目标打勾~~
2.  Info.plist 将“应用程序具有本地化显示名称”设置为 YES
3.  Info.plist 具有“捆绑名称”（CFBundleName），其值为“$（PRODUCT_NAME）”（不要问我为什么。如果我将其设置为其他值，它将不起作用。）
4.  Info.plist has no entry of "Bundle display name" (CFBundleDisplayName)
5.  InfoPlist.strings is ticked for your target
6.  InfoPlist.strings is ticked for ~~all languages (in my case, Base and English only.)~~ at least the Base language.
7.  InfoPlist.strings has ~~both~~ "CFBundleDisplayName" ~~and "CFBundleName"~~ entries

The above worked for me. I was primarily missing the "$(PRODUCT_NAME)" value part for the past hour.

If that still doesn't work, you should try creating a brand new XCode project and try to name the app into something else by following the above guides. Then, compare the Info.plist and your real project's Info.plist and see what's the difference. That's exactly how I find out about the "$(PRODUCT_NAME)" requirement.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-29T18:03:34.113

有一个 info InfoPlist.strings 文件，其中您已本地化**CFBundleDisplayName**，您还可以本地化 NSHumanReadableCopyrigh 等。

确实需要严格遵循本文中提到的步骤：http: [//kb.applingua.com/2011/10/how-to-localize-app-names/](http://kb.applingua.com/2011/10/how-to-localize-app-names/)

# php - 在 PHP 中从 jQuery 解析数据

> ID：14084450
> 
> 赞同：-2
> 
> 时间：2012-12-29T18:01:27.627
> 
> 标签：php, jquery

我越来越近了。我有一个表单想要提交到 PHP 文件以处理和更新 MySQL 数据库，然后更新 div。我可以将数据发送到我的 PHP 文件并查看它，但不确定如何访问它，所以它很有用。

来自我的 JS

```
var str = $("form").serialize();
xmlhttp.open("GET","concessions_write.php?"+str,true);
xmlhttp.send(); 
```

将此发送到我的 PHP 文件

```
concessions_write.php?btn%5B%5D=button01&itm%5B%5D=Hot+Dog&prc%5B%5D=1.00&id%5B%5D=1&btn%5B%5D=button02&itm%5B%5D=Popcorn&prc%5B%5D=1.00&id%5B%5D=3&btn%5B%5D=button03&itm%5B%5D=Combo&prc%5B%5D=3.50&id%5B%5D=2&btn%5B%5D=button04&itm%5B%5D=Nabs&prc%5B%5D=0.50&id%5B%5D=4&name=&message= 
```

在我的 PHP 文件中

```
print_r($_GET); 
```

给

```
Array (
    [btn] => Array (
        [0] => button01
        [1] => button02
        [2] => button03
        [3] => button04 
    )
    [itm] => Array (
        [0] => Hot Dog
        [1] => Popcorn
        [2] => Combo
        [3] => Nabs
    )
    [prc] => Array (
        [0] => 1.00
        [1] => 1.00
        [2] => 3.50
        [3] => 0.50
    )
    [id] => Array (
        [0] => 1
        [1] => 3
        [2] => 2
        [3] => 4
    )
    [name] =>
    [message] =>
) 
```

这是我需要的信息。每个条目有 4 个部分 - 、`btn`和`itm`我目前有 4 个条目。只是不确定如何将其分解为可用的数组，以便我可以将数据写回数据库。`prc``id`

看看，`parse_str`但似乎无法让它工作。

想法？还知道名称和消息可能来自哪里吗？没有带有这个的表单元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:06:53.560

如果您知道数据的格式，则可以在将 $_GET 作为数组（）收集后执行此操作：

```
$_GET['btn']['0']; 
```

名称和消息必须来自表单输入名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:14:52.597

在我看来，您只需要一个`for`循环：

```
for ($i = 0; $i < 3; $i++) {
    $btn = $_GET['btn'][$i];
    $itm = $_GET['itm'][$i];
    $prc = $_GET['prc'][$i];
    $id = $_GET['id'][$i];

    // Sanitise and save these values here
} 
```

# android - 自定义视图不在自定义视图组中绘制

> ID：14084451
> 
> 赞同：0
> 
> 时间：2012-12-29T18:01:38.793
> 
> 标签：android, android-layout, android-widget

我正在开发一个测试来尝试理解视图和视图组的行为。我创建了一个非常简单的自定义视图组（以下称为 viewgroup1），我已经正确实现了所有重要的方法（onLayout、onMeasure、onSizeChanged）。然后，我创建了一个简单的视图，并将视图从 onclick 事件添加到 viewgroup1。正确显示视图并调用其方法（onSizeChanged、onLayout、onDraw）。

在成功的测试之后，我创建了另一个自定义视图组（以下称为 viewgroup2），这次我将 viewgroup2 添加到了 viewgroup1。然后我将自定义视图从 onclick 事件添加到 viewgroup2。我希望一切都会像第一次测试一样发生，但是当我单击 viewgroup2 时，视图被添加到这个视图中，但是只调用了 viewgroup1 方法（onMeasure，onLayout）。调用不会沿继承树传播。

结果是树结构是正确的，但是尽管我为每个对象调用了 requestLayout、forcelayout 等，但视图没有显示。

树形结构为：viewgroup1---viewgroup2---view。

清单代码：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.yoredevelopment.tests"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="11" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".AndroidTestsActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

布局代码（main.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:custom="http://schemas.android.com/apk/res/com.yoredevelopment.tests"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ff000000"
    android:orientation="vertical" >
        <com.yoredevelopment.tests.TestViewGroup
                android:id="@+id/TestViewGroup"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="#ff00cccc"
                />
</LinearLayout> 
```

活动代码：

```
import android.app.Activity;
import android.os.Bundle;

public class AndroidTestsActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

视图和视图组代码：

```
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Paint.Style;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;

public class TestViewGroup extends ViewGroup {
    public TestViewGroup(Context context, AttributeSet attrs) {
        super(context, attrs);
        TestViewChild tvc = new TestViewChild(context);
        tvc.setLayoutParams(new ViewGroup.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
        tvc.setBackgroundColor(Color.WHITE);
        this.addView(tvc);
    }

    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        if(this.getChildCount() > 0) {
            View child = this.getChildAt(0);
            View p = (View)this.getParent();
            child.layout(20, 20, p.getWidth() - 40, p.getHeight() - 40);
        }
    }

    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
    }

    class TestViewChild extends ViewGroup {
        public TestViewChild(Context context) {
            super(context);
            this.setOnClickListener(new TestClickListener());
        }

        protected void onLayout(boolean changed, int l, int t, int r, int b) {
            if(this.getChildCount() > 0) {
                View child = this.getChildAt(0);
                child.layout(10, 10, 40, 40);
            }
        }

        protected void onSizeChanged(int w, int h, int oldw, int oldh) {
            super.onSizeChanged(w, h, oldw, oldh);
        }
    }

    class TestView extends View {
        private Paint p;
        public TestView(Context context) {
            super(context);
            p = new Paint();
            p.setColor(Color.RED);
            p.setStyle(Style.FILL);
        }

        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            int centerX = this.getWidth() / 2;
            int centerY = this.getHeight() / 2;
            canvas.drawCircle(centerX, centerY, 5, this.p);
        }

        protected void onLayout(boolean changed, int l, int t, int r, int b) {
            super.onLayout(changed, l, t, r, b);
        }

        protected void onSizeChanged(int w, int h, int oldw, int oldh) {
            super.onSizeChanged(w, h, oldw, oldh);
        }
    }

    class TestClickListener implements OnClickListener {
        public void onClick(View v) {
            ViewGroup vg = (ViewGroup)v;
            TestView tv = new TestView(vg.getContext());
            tv.setLayoutParams(new ViewGroup.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            tv.setBackgroundColor(Color.GREEN);
            vg.addView(tv);
            tv.bringToFront();
        }
    }
} 
```

如果我在 ViewGroup2 构造函数中创建视图，则会显示视图，但在从 onclick 事件创建视图时不会发生。

提前致谢，祝您假期愉快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T10:40:54.837

Two things spring to mind from the source code:

1/ You've not provided LayoutParams for any of the Views - you should use them when adding a View as a child.

2/ Your onMeasure code is incorrect in all three cases. You're using super to do the measurement, then getting the size from the spec (which may be 0) and overriding what super measured. Remove them all to let super handle them.

# ios - 关于使用完成块排队

> ID：14084455
> 
> 赞同：1
> 
> 时间：2012-12-29T18:02:02.977
> 
> 标签：ios, core-data, asynchronous, thread-safety, objective-c-blocks

所以，在不久前了解了完成块之后，我非常喜欢使用完成块。我喜欢封闭，我喜欢能够在任何我想要的地方传递任何东西。

作为线程编程的新手，我一直远离 GCD 和 NSOperation——但最近我不得不对 Core Data 的东西进行异步更新，我开始怀疑我的“所有完成块” “ 方法。

所以这是我在质疑自己的一个例子：我有一系列可能相当大的数据（图像、声音、视频，你有什么）要上传到某个地方的服务器。这些数据的元数据存储在 Core Data 中，我有一个时间戳用于决定应该上传哪些对象。所有这些上传都应该按顺序完成。

我编写的代码基本上只是一个带有完成块的函数，它在块的末尾有一个对自身的调用，如下所示：

```
(void)uploadAllAsynchronously {
  ... // First figure out what to upload based on core data
  // Here comes the completion block in question
  void(^blk)(BOOL) = ^(BOOL)uploadSuccess {
    ... // if upload successful, update core data to mark what has been uploaded
    [self uploadAllAsynchronously]; // Recursively calls the function that contains this block.  I actually have a weak self, or if that fails to break a retain cycle, I should be able to pass in a NSManagedObjectContext as an argument.
  }
  [NSURLConnection sendAsynchronousRequest:... queue:... completionHandler:blk];

} 
```

这应该有效，对吧？这里是否有一些完全危险的东西表明我必须使用 GCD 并处理我自己的队列？我问这个是因为我现在有点麻烦，可能其中的数据会出现不同的线程由于异步调用而无法正确更新，尽管不确定我的代码的哪一部分是罪魁祸首。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:51:28.213

是的，这段代码应该可以工作..注意：然后我会重命名该方法.. uploadIfNeeded 也许-因为它并不总是盲目地上传东西...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:29:43.883

您的块类型错误。

作为[文档](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/occ/clm/NSURLConnection/sendAsynchronousRequest%3aqueue%3acompletionHandler%3a)_

```
+ (void)sendAsynchronousRequest:(NSURLRequest *)request queue:(NSOperationQueue *)queue completionHandler:(void (^)(NSURLResponse *, NSData *, NSError *))handler 
```

显示，完成黑色的类型是

```
void (^) (NSURLResponse *, NSData *, NSError *) 
```

不是

```
void (^) (BOOL) 
```

你应该变成`blk`类似的东西

```
void (^blk) (NSURLResponse *, NSData *, NSError *) = ^ (NSURLResponse *response, NSData *data, NSError *error) {
    //...
}; 
```

* * *

写起来会更时髦

```
[NSURLConnection sendAsynchronousRequest:theRequest queue:theQueue completionHandler:^ (NSURLResponse *response, NSData *data, NSError *error) {
    //...
}]; 
```

与方法内联的完成块。

* * *

关于`NSManagedObjectContext`在完成处理程序中对您执行操作的问题：只要`NSOperationQueue`传递`sendAsynchronousRequest:queue:completionHandler:`的对象与创建托管对象上下文的对象相同，就可以了。但作为各州[的文件`NSManagedObjectContext`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html)

> Core Data 使用线程（或序列化队列）限制来保护托管对象和托管对象上下文（请参阅“Core Data 的并发性”）。这样做的结果是上下文假定默认所有者是分配它的线程或队列——这由调用其 init 方法的线程确定。因此，您不应该在一个线程上初始化上下文，然后将其传递给另一个线程。相反，您应该将引用传递给持久存储协调器，并让接收线程/队列创建一个从中派生的新上下文。

如果您传递的队列不是您创建托管对象上下文的队列，则必须执行以下操作之一

1.  调用`-[NSOperationQueue addOperation:]`创建托管对象上下文的队列。

2.  在发生核心数据操作的队列上创建第二个托管对象上下文（具有相同的持久存储协调器）。

3.  在发生核心数据操作的队列上创建第二个托管对象上下文和第二个持久存储协调器。

4.  使用锁定。

[Concurrency with Core Data](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385)的文档清楚地表明您必须使用线程限制（上面的选项 1-3）或使用锁定（上面的选项 4）。

这就是文档对使用锁的看法：

> 如果你选择不使用线程包含模式——也就是说，如果你试图在线程之间传递托管对象或上下文，等等——你必须非常小心锁定，结果你可能会否定你的任何好处否则可能源自多线程。

这就是文档必须说的关于不仅具有每个线程托管对象上下文而且还具有每个线程持久存储协调器的内容：

> 这种方法以更大的复杂性（特别是如果您需要在不同的上下文之间传达更改）和增加的内存使用量为代价提供更大的并发性。

# c++ - struct 构造函数名称优先级

> ID：14084457
> 
> 赞同：1
> 
> 时间：2012-12-29T18:02:08.180
> 
> 标签：c++, c++11

我写了一个这样的结构......在C ++ 11中

```
struct StackOverflow
{
    int x;
    StackOverflow(){}
    StackOverflow(int x) { x = x; }
}; 
```

我知道我应该写后一个构造函数，`StackOverflow(int x) : x(x) {}`但我很高兴在这种情况下我没有写，因为我学到了一些东西：

C++11 编译器没有对语句*做正确的事情*`{x = x;}`。事实上，结构成员`x`甚至没有被初始化（当我调试为什么我的应用程序失败时它有随机值）。而且我没有收到编译器警告。

这不应该奏效吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:03:00.227

您应该使用您似乎已经知道的构造函数初始化列表。所以我想你只是想知道为什么你的代码没有按照你的*意愿*去做。那么问题是编译器不知道你的*意图*，因为它没有在程序中表达。您需要以编程方式表达您的意图：

```
StackOverflow(int x) { this->x = x; } 
```

编译器需要知道哪个`x`是哪个`x`。使用`this->x`，编译器知道你的意图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T18:06:39.937

参数将隐藏数据成员，*除非*在构造函数初始化列表中进行初始化。

在`x = x`中`x`隐藏数据成员，因此它将参数分配给自身。

```
StackOverflow(int x) : x(x) {}
//                     ^ ^
//                     | +-- parameter x
//                     |
//                     +---- data member x

StackOverflow(int x) { x = x; }
//                     ^   ^
//                     |   |
//                     +---+-- parameter x 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T18:04:02.137

不，您引入了一个`x`在隐藏您的成员的构造函数的命名空间中命名的新变量。

编译器*可能*会给你一个警告，但这不是必需的。

有三个选项：

*   重命名参数
*   [使用初始化列表]
*   [将成员限定为`this->x`]

使用第一个，它是最优雅的。对于这个简单的情况，它并没有太大的区别，但是考虑一个更大的构造函数，你必须记住它`x`不引用类成员，并且`this->x`当你想使用类成员时你必须编写。

# iphone - 使用 Core Bluetooth 在后台获取蓝牙 LE 外设广告

> ID：14084461
> 
> 赞同：7
> 
> 时间：2012-12-29T18:02:36.827
> 
> 标签：iphone, objective-c, ios, bluetooth, bluetooth-lowenergy

当我的应用程序在后台运行时，我无法弄清楚如何接收蓝牙 LE 外围设备广告。也就是说，当我的应用程序在后台时，它永远不会到达 didDiscoverPeripheral() 方法——广告所在的位置。有谁知道我需要如何配置我的应用程序，以便在我的应用程序处于背景？当我的应用程序在后台时，这可以通过线程轮询来完成吗？注意：我想从所有 BLE 设备获取广告，而不是定义数量的 BLE 设备。

感谢帮助，

凯西

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T23:22:08.483

我正在从我的应用程序中执行此操作。

在后台模式下，CoreBluetooth 据说比外围设备的广告间隔慢 55 倍。为了加快速度，我对外围设备进行了编程，使其在前 30 秒内每 20 毫秒发布一次广告。

此外，您必须在项目 Targets -> Info 中使用“App 使用 CoreBluetooth 进行通信”定义“需要后台模式”。

应用程序确实需要一段时间才能在后台模式下找到外围设备。

# php - 如果已经存在，则创建新的 PHP

> ID：14084467
> 
> 赞同：1
> 
> 时间：2012-12-29T18:03:25.547
> 
> 标签：php, function, insert, pdo, user-registration

我正在创建一个随机用户 ID，但我想检查该 ID 是否已被使用（不太可能，但有机会），但不知何故这不起作用。当我查看数据库时，字段中没有随机字符串`account_id`。我是否以错误的方式调用函数？

```
function genRandomString() {
    $length = 40;
    $characters = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";    
    for ($p = 0; $p < $length; $p++) {
        $string .= $characters[mt_rand(0, strlen($characters))];
    }
    return $string;
}

function createID() {
    $cl_id = 'h_u_'.genRandomString();
}   

createID();

$sql_query="SELECT * FROM accounts WHERE account_id = :cl_id";
$statement = $conn->prepare($sql_query);
$statement->bindParam(':cl_id', $cl_id, PDO::PARAM_STR);    
if ($statement->execute() && $row = $statement->fetch())
    {
        createID();
    }

$conn->exec("INSERT INTO accounts SET  
            account_id='$cl_id' ,
            name='$_POST[name]' ,
            email='$_POST[email]' "); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:07:21.093

$cl_id 是 createID() 函数中的局部变量，您需要将值返回到全局代码...

```
function createID() {
return $cl_id = 'h_u_'.genRandomString();
} 
```

您需要在主代码中检查 $id

```
$id = createID();
$sql_query="SELECT * FROM accounts WHERE account_id = '".$cl_id."'";
$statement = $conn->prepare($sql_query); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:16:11.537

1\. 您错过了在 createID() 中返回 $c_id。将其更改为：

```
function createID() {
    return 'h_u_'.genRandomString();
}

$cl_id = createID(); 
```

2\. 您可以使用 good old`uniqid()`而不是您的 custom `genRandomString()`。

这将导致更简单的事情，例如：

```
function createID() {
    return 'h_u_'.uniqid();
}

$cl_id = createID(); 
```

3\. 您必须将数据库相关代码中的 if 更改为循环（请看下面的示例）

4\. 您的插入查询使用未经验证的 $_POST 变量。这很容易发生[SQL 注入](https://www.owasp.org/index.php/SQL_Injection)。如果您的数据库库支持**服务器端**准备好的语句，您应该**使用**它们并且您会感到安全，因为数据与查询语法分开。如果您将 PHP 与 MySQL 一起使用，情况就是如此。

如果您没有使用**服务器端**准备好的语句，您应该通过 using`mysql_real_escape_string()`或类似的方式转义查询中使用的任何 $_POST 数据。在下面的示例中，我假设您将 PHP 与 MySQL 一起使用，这就是我使用准备好的语句的原因。

考虑到所有这些可能会导致完成的脚本如下：

```
$sql_query="SELECT * FROM accounts WHERE account_id = :cl_id";
$statement = $conn->prepare($sql_query);
$maxtries = 3; // how many tries to generate a unique id?

for($i = 0; $i < $maxtries; $i++) {
    $cl_id = uniqid(); // create a 'unique' id

    $statement->bindParam(':cl_id', $cl_id, PDO::PARAM_STR);    
    if (!$statement->execute()) {
        die('db error');
    }

    $row = $statement->fetch();
    if($row) {
        continue;
    }
    break;
}

// if a unique id couldn't get generated even
// after maxtries, then pigs can fly too :)
if($i === $maxtries) {
    die('maximum number of tries reached. pigs can fly!');
}

// You should use a prepared statement for the insert to prevent from
// SQL injections as you pass $_POST vars to the query. You should further 
// consider to validate email address and the name!
$name = $_POST['name'];
$email = $_POST['email'];

$insert_query = '
  INSERT INTO accounts SET 
    account_id = :account_id,
    name = :name,
    email = :email'; 

$insert_statement = $conn->prepare($insert_query);
$insert_statement->bindParam(':account_id', $cl_id, PDO::PARAM_STR);
$insert_statement->bindParam(':name', $name, PDO::PARAM_STR);
$insert_statement->bindParam(':account_id', $email, PDO::PARAM_STR);

if (!$insert_statement->execute()) {
    die('db error');
} 
```

# c# - 重新启动应用程序后恢复应用程序设置

> ID：14084473
> 
> 赞同：0
> 
> 时间：2012-12-29T18:03:40.373
> 
> 标签：c#, runtime, settings, restart

我有一个 C# 应用程序，我将某些值存储在设置文件中，如下所示：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
            <section name="VITRIconEvacuationPlan.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false"/>
        </sectionGroup>
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="VITRIconEvacuationPlan.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
        </sectionGroup>
    </configSections>
    <applicationSettings>
        <EvacuationPlan.Properties.Settings>
            <setting name="AssemblyCentre" serializeAs="String">
                <value>False</value>
            </setting>
        </EvacuationPlan.Properties.Settings>
    </applicationSettings>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup><userSettings>
        <EvacuationPlan.Properties.Settings>
            <setting name="SymbolScale" serializeAs="String">
                <value>25</value>
            </setting>
        </EvacuationPlan.Properties.Settings>
    </userSettings>
</configuration> 
```

默认情况下，SymbolScale 属性设置为 25（当我第一次启动应用程序时）我想在运行时更改 SymbolScale 属性，因此我将其放入用户范围。所以我可以说：

```
setting.SymbolScale = 150;
setting.save(); 
```

但是当我关闭我的应用程序时，SymbolScale 的值又是 25。但我希望它从运行时存储我的 chenged 值。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:53:58.180

我在这里找到了解决方案：

[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/ddeaca86-a093-4997-82c9-01bc0c630138/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/ddeaca86-a093-4997-82c9-01bc0c630138/)

我只需要像这样更改并保存我的 SymbolValue：

```
Properties.Settings.Default.SymbolScale = 150;
Properties.Settings.Default.Save();
Properties.Settings.Default.Upgrade();
Properties.Settings.Default.Save(); 
```

我不知道为什么我必须调用 save 函数两次但它有效（并且只有调用它两次）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:13:15.507

您确定您正在检查正确的“user.config”文件吗？通常存储在“C:\Users\xyzuser\AppData\Local\yourcompany\youarpp\version\user.config”中。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:19:46.937

设置如下：`Settings.Default.SymbolScale = 150;`

保存它`Settings.Default.Save();`

# c++ - 用户定义指针的双端队列中的分段错误

> ID：14084475
> 
> 赞同：0
> 
> 时间：2012-12-29T18:03:50.210
> 
> 标签：c++, segmentation-fault, deque

我有一个`deque<rect*> rects`where`rect`是用户定义的类。当我尝试进入它时，我遇到`insert`了`rect*`分段错误。`gdb`将问题追溯到`__memmove_sse3()`我调用`rects.insert(it,new rect([constructor parameters]));` where `it`is a时调用的函数`deque<rect*>::iterator`。什么可能导致此错误？

编辑：这是我的代码片段：

```
for(deque<rect*>::iterator it=rects.begin();it!=rects.end();++it)
        {
            rect r=*r1;
            rect r2=*(*it);
            if(!r2.there)
                continue;
            if(r.down>r2.up || r.up<r2.down || r.right<r2.left || r.left>r2.right)
                continue;
            if(r.left>r2.left)
                rects.insert(it,new rect(r2.left,r2.down,r.left,r2.up,r2.color));
            if(r.right<r2.right)
                rects.insert(it,new rect(r.right,r2.down,r2.right,r2.up,r2.color));
            if(r.up<r2.up)
                rects.insert(it,new rect(max(r.left,r2.left),r.up,min(r.right,r2.right),r2.up,r2.color));
            if(r.down>r2.down)
                rects.insert(it,new rect(max(r.left,r2.left),r2.down,min(r.right,r2.right),r.down,r2.color));
            r2.there=false;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:21:21.183

问题是您插入的项目`std::deque`会使您在`for`循环中递增的迭代器无效：

标准（n3485 草案）在 §23.3.3.4/1（强调我的）中说，

> 效果：双端队列中间的**插入****使所有迭代器**和对双端队列元素的引用无效。在双端队列的任何一端**插入都会使双端队列****的所有迭代器无效**，但不会影响对双端队列元素的引用的有效性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:16:44.950

段错误可以来自任意数量的来源，并且并不总是立即显现。您可能会溢出数组，以无效的方式使用 stl 容器，等等 - 当您损坏您不拥有的可能用于分配记帐的内存区域时，它可以进行未来的分配，释放，移动或任何其他间接访问都会失败。

拿出大炮可能有助于快速解决这个问题！如果您在将运行 valgrind 的系统上，则可以使用[valgrind](http://valgrind.org/)的 memcheck 模块，或者您可以在 Windows 上使用[Application Verifier之类的东西。](http://www.microsoft.com/en-us/download/details.aspx?id=20028)

您的编译器或库可能具有标准库/STL 调试功能——如果您在 IDE 中，请四处寻找可用的选项。对于 libstdc++（通常与 gcc/g++ 一起使用），您可以查看[libstdc++ 调试支持选项](http://gcc.gnu.org/onlinedocs/libstdc++/manual/debug.html)。

这是我之前对讨论此类工具[的堆损坏问题的回答，我](https://stackoverflow.com/questions/1010106/how-to-debug-heap-corruption-errors/1010811#1010811)[列出的您可能想要重载 operator new 和 delete 的原因](https://stackoverflow.com/questions/1152511/any-reason-to-overload-global-new-and-delete/1215807#1215807)还有另一个工具列表。（无耻的自我推销，在这里，但我认为这些都是相当不错的清单！）

* * *

根据您的代码，我会说您使循环迭代器无效。来自[http://www.sgi.com/tech/stl/Deque.html](http://www.sgi.com/tech/stl/Deque.html)：

> deque 的迭代器失效语义如下。插入（包括 push_front 和 push_back）使所有引用双端队列的迭代器无效。在双端队列中间进行擦除会使所有引用该双端队列的迭代器无效。仅当迭代器指向已擦除的元素时，在双端队列（包括 pop_front 和 pop_back）的开头或结尾进行擦除才会使迭代器无效。

# html - 谁能找到这个空白的来源？

> ID：14084476
> 
> 赞同：0
> 
> 时间：2012-12-29T18:03:54.470
> 
> 标签：html, css, image, background, whitespace

我在这里有一些非常基本的html和css，出于某种原因，我用我的css设置的图像作为背景图像没有垂直重复，或者如果它被这个空白区域覆盖，但她的主要问题是从我的图像不再垂直重复的那一点开始，有纯白色空间，我什至尝试设置#content2 的背景颜色，甚至覆盖它的空白。谁能看到我错过了什么？HTML：

```
<!DOCTYPE html>
<head>
<link href="index.css" rel="stylesheet" type="text/css" />
<title></title>
</head>

<body>
<div id="body">
<div id="wrap">

<!--header starts-->
<div id="header">
<div id="name">
<h1>Comp <span>any</span> Name</h1>
</div><!--end name-->   
<div id="nav"><br>
    <ol>
        <li><a href="programs.html">Our Programs</a></li>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="index.html">Home</a></li>
    </ol>
</div><!--end nav-->
</div><!--end header-->
<!--header ends-->

<!--content1 starts-->
<div id="content1">
<img src="images/placeholder.png" width="400" height="323" alt="logo"> 
<div id="imgright">
<h2>What We Do</h2>
<p>"Lorem ipsum dolor sit amet, consectetur adipisicing 
    elit, sed do eiusmod tempor incididunt ut labore et 
    dolore magna aliqua. Ut enim ad minim veniam, 
    quis nostrud exercitation ullamco laboris nisi ut 
    aliquip ex ea commodo consequat. Duis aute irure 
    dolor in reprehenderit in voluptate velit esse 
    cillum dolore eu fugiat nulla pariatur. Excepteur sint 
    occaecat cupidatat non proident, sunt in culpa qui o
    fficia deserunt mollit anim id est laborum."</p>
<div id="button">
<h4>Request A Program</h4>
</div><!--end button-->
</div><!--end imgright-->
</div><!--end content1-->
<!--content1 ends-->

<!--content2 starts-->
<div id="content2">
<div id="one">
  <img src="images/arrow.png" width="16" height="14" alt="arrow1">
  <h3>Contact Us</h3>
  <p>"Lorem ipsum dolor sit amet, 
    consectetur adipisicing elit, sed do 
    eiusmod tempor incididunt ut labore 
    et dolore magna aliqua. Ut enim ad 
    minim veniam"</p> 
</div><!--end one-->

<div id="two">
  <img src="images/arrow.png" width="16" height="14" alt="arrow2"> 
  <h3>About Us</h3>
  <p>"Lorem ipsum dolor sit amet, 
    consectetur adipisicing elit, sed do 
    eiusmod tempor incididunt ut labore 
    et dolore magna aliqua. Ut enim ad 
    minim veniam"</p>
</div><!--end two-->

<div id="three">
  <img src="images/arrow.png" width="16" height="14" alt="arrow3"> 
  <h3> View Our Programs</h3>
  <p>"Lorem ipsum dolor sit amet, 
    consectetur adipisicing elit, sed do 
    eiusmod tempor incididunt ut labore 
    et dolore magna aliqua. Ut enim ad 
    minim veniam"</p>
</div><!--end three-->  
</div><!--end content2-->
<!--content2 ends-->

<!--footer starts-->
<div id="footer">
<h5>Insert some footer information, copyright information also</h5>    
</div>    <!--end footer-->
<!--footer ends-->
</div><!--end wrap-->
</div><!--end body-->
</body>
</html> 
```

CSS：

```
@charset "utf-8";
/* CSS Document */

html, body{
margin:0;
padding:0;
}

#body{
background-image:url(images/background.jpg);
background-repeat:repeat;
margin-top:-25px;
padding:0;  
}
#wrap{
border-width:3px;
border-style:solid;
border-color:white;
width:1024px;
height:100%;
margin:0 auto;
padding-top:5px;
}

#header h1{
font-size:36px;
font-family: Terminal, Verdana, Geneva, sans-serif;
color: white;
}

span{
font-size:100px;
color:black;
font-family:brush script std, Verdana, Geneva, sans-serif;
}

#nav{
margin-top:-110px;
margin-bottom:75px;
margin-right:40px;
}

#nav ol {
margin: 0;
padding: 0;
list-style: none;
line-height: normal;
}

#nav li {
display: block;
float: right;
}

#nav a {
display: block;
float: left;
margin-right: 3px;
padding: 10px 20px;
text-decoration: none;
font: 24px "Trebuchet MS", Arial, Helvetica, sans-serif;
color: white;
}

#nav a:hover { 
text-decoration: none; 
color: black;
}

#content1 img{
margin-left:25px;
}

#imgright{
margin-left:445px;
margin-top:-389px;
}

#button h4{
font-family:"Times New Roman", Times, serif;
font-size:24px;
color:white;
}

h2{
font-family:"Times New Roman", Times, serif;
font-size:48px;
}

#imgright p{
color: white;
font-size:24px;
font-family: "Times New Roman", Times, serif;
margin-top:-30px;
margin-left:20px;
}

#content2{
background-color:#2e3192;
}

#one, #two, #three{width:341.3px;}

#one h3{
font-family:trajan pro, Verdana, Geneva, sans-serif;
color:white;
}
#one p{
font-family:vijaya, Verdana, Geneva, sans-serif;
color:white;
}

#two h3{
font-family:trajan pro, Verdana, Geneva, sans-serif;
color:white;
}
#two p{
font-family:vijaya, Verdana, Geneva, sans-serif;
color:white;
}

#three h3{
font-family:trajan pro, Verdana, Geneva, sans-serif;
color:white;    
}

#three p{
font-family:vijaya, Verdana, Geneva, sans-serif;
color:white;
}

#one{
margin-top:50px;
}

#two{
margin-top:-104px;
margin-left:360px;
}

#three{
margin-top:-408px;
margin-left:720px;
}

#footer{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:17:27.830

整个 CSS 中的负边距是导致此问题的原因：

```
#two {
    margin-top: -104px;
    margin-left: 360px;
} 
```

不要使用大的负边距来移动东西，而是使用浮动：[http](http://www.w3schools.com/cssref/pr_class_float.asp) ://www.w3schools.com/cssref/pr_class_float.asp 。

这是来自 CSS-tricks 的教程： http: [//css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)。

任何使用负边距的地方，都需要用浮点数替换。空白符合预期，您设置的负边距对高度没有贡献。

# iphone - 在 Core Graphics 和 CorePlot 中绘制一条带有“凸起效果”/渐变的线

> ID：14084478
> 
> 赞同：3
> 
> 时间：2012-12-29T18:04:22.417
> 
> 标签：iphone, ios, uikit, core-graphics, core-plot

我想对一条线应用“提升效果”。它看起来类似于：

![在此处输入图像描述](../Images/b0cb40e6f7f63444509967a940d41ff2.png)

起初我想使用渐变填充，但标准渐变填充只会在一个方向上应用渐变，而不管线的方向如何，如下所示：

![在此处输入图像描述](../Images/31781c7bc933c2b611c5947ab1d7451b.png)

这些线实际上是使用 CorePlot 绘制的散点图的一部分，但由于 CorePlot 允许您或多或少地应用您在核心图形中可以做的任何事情，核心图形解决方案应该在这里应用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:41:33.677

您可能能够通过阴影获得可接受的效果。如果这不起作用，请制作几个情节。为每个绘图提供相同的数据点，但改变线宽和颜色以实现 3D 效果。

# c# - 无法使用 Accord.NET

> ID：14084482
> 
> 赞同：1
> 
> 时间：2012-12-29T18:04:47.440
> 
> 标签：c#, accord.net

我已经安装了 Accord.Net。但是当我添加“Accord.Math”作为参考时，它会显示“找不到引用的组件'Accord.Math'。” 我不知道为什么。任何人都可以帮助我为什么要展示这个以及我是如何解决的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:11:27.733

您是否按照[入门](https://code.google.com/p/accord/wiki/GettingStarted)中的说明**添加参考**？您必须在项目中存在 DLL 才能使用它们。

# ios - 具有 UIImage 缩放性能的 UITableViewCell

> ID：14084483
> 
> 赞同：0
> 
> 时间：2012-12-29T18:04:53.367
> 
> 标签：ios, uitableview, uiimageview, uiimage

UITableViewCell 具有要在其中显示的 UIImage。

图像从服务器获取，并作为 NSData 存储在 NSDictionary 中。

此图像使用 UIImageGraphicsBeginImageContext 为非视网膜设备调整大小，如下所示。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

            static NSString *cellID=@"Cell";
            UITableViewCell *cell=[tableView dequeueReusableCellWithIdentifier:cellID];
            NSDictionary *myDictionary=[self.tableObject objectAtIndex:indexPath.row];
            NSData *imgData=[myDictionary objectForKey:@"icon"];
            UIImage *img=[UIImage imageWithData:imgData];
            if(isRetina]){
                cell.iconImageView.image=img;
            }else{
                CGRect imgRect=CGRectMake(0, 0, img.size.width/2.0, img.size.height/2.0);
                UIGraphicsBeginImageContext(imgRect.size);
                [img drawInRect:imgRect];
                UIImage *newImg=UIGraphicsGetImageFromCurrentImageContext();
                UIGraphicsEndImageContext();
                cell.iconImageView.image=newImg;
            }
} 
```

是更好的方法和更少的内存密集型还是应该将其存储在磁盘中，然后从中访问图像并将其分配给 cell.iconImageView.image;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:09:52.080

下载时将其写入磁盘。

这样，操作系统可以懒惰地读取数据，将其缓存，并且您不会一直将图像数据保存在内存中

# php - Apache 和解析的 PHP 缓存

> ID：14084489
> 
> 赞同：2
> 
> 时间：2012-12-29T18:05:36.720
> 
> 标签：php, linux, apache, web

假设我们安装了所有默认设置的 Linux + Apache + PHP。我有一些使用大型第三方 PHP 库的 PHP 网站，比如说 1 Mb 的 PHP 源。这个库很少使用，假设只用于 POST 请求。我不能将这个库的使用移动到单独的 PHP 文件中是有原因的。所以，我必须为每个 HTTP 请求包含这个库，但很少使用它。在这种情况下，我应该担心 PHP 解析所花费的时间吗？让我解释。我可以这样做：

```
<?php
require_once('heavy_library.php');
// do regular stuff
if(we need heavy library)
{
    heavy_library_function();
}
?> 
```

我认为这个解决方案很糟糕，因为在这种情况下，heavy_library.php 会针对每个 HTTP 请求进行解析。我可以将它移到 if 语句中：

```
<?php
// do regular stuff
if(we need heavy library)
{
    require_once('heavy_library.php');
    heavy_library_function();
}
?> 
```

现在据我了解，只有在我们需要库时才会对其进行解析。

现在，回到问题上来。Apache 和 PHP 的默认设置。我应该关心这个问题吗？我应该将 require_once 移到真正使用它的地方，还是可以像往常一样保留它，Apache / PHP 会做某种缓存来阻止解析每个 HTTP 请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:09:25.603

不，Apache 不会进行缓存。您应该保留`require_once`内部，`if`以便仅在需要时使用。

如果您确实想要缓存 PHP，请查看类似[eaccelerator](http://eaccelerator.net/)的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:11:57.687

当你告诉 PHP`require()`某事时，它无论如何都会做；唯一可以防止每次从头开始解析该文件的方法是使用操作码缓存，例如[APC](http://www.php.net/apc)。

在这种情况下，最好有条件地加载文件。如果您担心这些条件会使生活变得更加复杂，请执行一个小型基准测试。

您还可以使用自动加载“按需”自动加载文件；看[`spl_autoload`](http://www.php.net/spl_autoload)

# php - 如何在 PHP 中将“order by”子句添加到 MySQL 查询（意外的 T_Error ...）

> ID：14084494
> 
> 赞同：-4
> 
> 时间：2012-12-29T18:05:57.143
> 
> 标签：php, mysql

我有这个代码...

```
<?
    $sql = "SELECT * FROM products where category =". $ID ;
    $result = @mysql_query($sql);
    while ($row=mysql_fetch_array($result))
    {
?>

        <table width="810" valign="center">
            <tr height="100px">
                <td width="150px"><img src="<?php echo($row['imagethumb']) ?>" width="150" height="100" border="0" /></td>

                <td width="200px"><h3><a href='item.php?id=<?php echo($row['id']) ?>'> <?php echo($row['title']) ?></a></h3></td>

                <td width="200px"><h4>$<?php echo($row['price']) ?></h4>  </td>

                <td><h4><a href="<?php echo($row['cartlink']) ?>"><span class="addtocart"></span></a></h4></td>
            </tr>
        </table>

<?
    }
?> 
```

我想按价格对结果进行排序。到目前为止，我还无法让 ORDER BY 'price' ASC 工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:17:06.393

尝试这个：

```
$sql = "SELECT * FROM products where category ='".$ID."' order by columnname ASC " ; 
```

# symfony - Symfony2 auth denied 和 getToken()->getRoles() 不同于 getToken()->getUser()->getRoles()

> ID：14084495
> 
> 赞同：0
> 
> 时间：2012-12-29T18:06:29.457
> 
> 标签：symfony

我正在使用 FOSUserBundle 来管理用户，现在我正在尝试使用 JMS\SecurityExtraBundle 来保护一些控制器操作。我已经设置`ROLE_SUPER_USER`了我的用户并保护了一个方法，`@Secure(roles="SUPER_ADMIN")`但我无权调用该方法。

在深入研究 Symfony2 的代码之后，我想我已经将问题追溯到`getToken()->getRoles()`仅返回`ROLE_USER`而`getToken()->getUser()->getRoles()`正确返回用户角色的事实，包括`ROLE_SUPER_USER`.

那么那里会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:47:29.580

哈哈

我错过了以下几行：

```
providers:
            main:
                entity: { class: FM\SymSlateBundle\Entity\User, property: username } 
```

在 security.yml 中：

```
security:
    providers:
        main:
            entity: { class: FM\SymSlateBundle\Entity\User, property: username }
        fos_userbundle:
            id: fos_user.user_provider.username 
```

因此，上下文使用的是只有 USER_ROLE 的默认用户类

# c# - 检查是否安装了完整版的.net？

> ID：14084501
> 
> 赞同：5
> 
> 时间：2012-12-29T18:07:16.037
> 
> 标签：c#, .net

我正在构建一个需要完整版 .Net（4.0 或 3.5）的 ExcelDNA 插件（我正在使用 System.Web 的某些部分）。因此，只有客户端版本的用户会遇到错误。

如果只安装了客户端版本，我喜欢在启动时提示用户“获取最新”版本弹出窗口。

有没有万无一失的方法来检查是否安装了完整版？通过谷歌搜索，似乎很多人建议检查注册表，这似乎很容易出错，因为有很多 .Net 版本。在这种情况下，我需要检查哪些路径才能构建：

```
bool IsFullDotNetVersion()
{

} 
```

检查是否存在仅在完整版中可用的功能是否可能/好主意？即是否可以检查 System.Web 是否存在于环境中？（不包含在 .Net 的客户端版本中，对吗？）

作为一个附带问题：如何使用系统上安装的不同 .net 版本轻松测试我的应用程序。有没有.Net切换器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T11:59:29.893

查看 GAC 以查看`System.Web`（或您需要的任何程序集）是否存在。

这是一些[适用于我的机器](http://www.codinghorror.com/blog/2007/03/the-works-on-my-machine-certification-program.html)的代码。

```
private static const string BasePath = @"c:\windows\assembly";

public static bool HasDotNetFullversion()
{
    var gacFolders = new List<string>()
    {
        "GAC", "GAC_32", "GAC_64", "GAC_MSIL",
        "NativeImages_v2.0.50727_32", "NativeImages_v2.0.50727_64"
    };

    var assemblyFolders = from gacFolder in gacFolders
                          let path = Path.Combine(BasePath, gacFolder)
                          where Directory.Exists(path)
                          from directory in Directory.GetDirectories(path)
                          select directory;

    var hasSystemWeb = assemblyFolders.Any(x =>
        x.EndsWith("system.web", StringComparison.InvariantCultureIgnoreCase));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:13:37.643

可能重复。[如何检测安装了哪些 .NET Framework 版本和服务包？](https://stackoverflow.com/questions/199080/how-to-detect-what-net-framework-versions-and-service-packs-are-installed)简短的回答是您需要阅读注册表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T02:15:33.847

我建议您与其尝试检测客户端计算机的 .net 版本，不如将完整的 .net 安装程序捆绑到您的安装程序中。

换句话说，在安装时检测它并采取适当的措施。这是处理可能缺少的框架部分的常用方法。

# sql - PostgreSQL 将列转换为行？转置？

> ID：14084503
> 
> 赞同：35
> 
> 时间：2012-12-29T18:07:30.517
> 
> 标签：sql, postgresql, pivot-table, dynamic-sql, crosstab

我有一个 PostgreSQL 函数（或表），它给了我以下输出：

```
Sl.no    username    Designation    salary   etc..
 1        A           XYZ            10000    ...
 2        B           RTS            50000    ...
 3        C           QWE            20000    ...
 4        D           HGD            34343    ... 
```

现在我想要输出如下：

```
Sl.no            1       2        3       4       ...
 Username        A       B        C       D       ...
 Designation     XYZ     RTS      QWE     HGD     ...
 Salary          10000   50000    20000   34343   ... 
```

这该怎么做？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-30T00:32:26.733

根据表格的表格我的回答：

```
CREATE TABLE tbl (
  sl_no int
, username text
, designation text
, salary int
); 
```

每行都会产生一个要返回的新列。对于像这样的动态返回类型，几乎不可能通过一次调用数据库来使其完全动态化。**通过两个步骤**演示解决方案：

1.  生成查询
2.  执行生成的查询

通常，这受到表可以容纳的最大列数的限制。因此对于超过 1600 行（或更少）的表来说不是一个选项。细节：

*   [PostgreSQL 选择查询中的最大列数是多少](https://stackoverflow.com/questions/12606842/what-is-the-maximum-number-of-columns-in-a-postgresql-select-query)

## Postgres 9.4+

### 动态解决方案`crosstab()`

尽可能使用第一个。击败其余的。

```
SELECT 'SELECT *
FROM   crosstab(
       $ct$SELECT u.attnum, t.rn, u.val
        FROM  (SELECT row_number() OVER () AS rn, * FROM '
                              || attrelid::regclass || ') t
             , unnest(ARRAY[' || string_agg(quote_ident(attname)
                              || '::text', ',') || '])
                 WITH ORDINALITY u(val, attnum)
        ORDER  BY 1, 2$ct$
   ) t (attnum bigint, '
     || (SELECT string_agg('r'|| rn ||' text', ', ')
         FROM  (SELECT row_number() OVER () AS rn FROM **tbl**) t)
     || ')' AS sql
FROM   pg_attribute
WHERE  attrelid = '**tbl**'::regclass
AND    attnum > 0
AND    NOT attisdropped
GROUP  BY attrelid;
```

使用`attnum`而不是实际的列名进行操作。更简单、更快捷。`pg_attribute`再次加入结果或整合列名，如 pg 9.3 示例中的。
生成以下形式的查询：

```
SELECT *
FROM   crosstab(
   $ct$
   SELECT u.attnum, t.rn, u.val
   FROM  (SELECT row_number() OVER () AS rn, * FROM tbl) t
       , unnest(ARRAY[sl_no::text,username::text,designation::text,salary::text]) WITH ORDINALITY u(val, attnum)
   ORDER  BY 1, 2$ct$
   ) t (attnum bigint, r1 text, r2 text, r3 text, r4 text); 
```

这使用了一系列高级功能。简直太多解释了。

### 简单的解决方案`unnest()`

[`unnest()`](https://www.postgresql.org/docs/current/queries-table-expressions.html#QUERIES-TABLEFUNCTIONS)现在可以并行取消嵌套多个数组。

```
SELECT 'SELECT * FROM unnest(
  ''{sl_no, username, designation, salary}''::text[]
, ' || string_agg(quote_literal(ARRAY[sl_no::text, username::text, designation::text, salary::text])
              || '::text[]', E'\n, ')
    || E') \n AS t(col,' || string_agg('row' || sl_no, ',') || ')' AS sql
FROM   tbl; 
```

结果：

```
SELECT * FROM unnest(
 '{sl_no, username, designation, salary}'::text[]
,'{10,Joe,Music,1234}'::text[]
,'{11,Bob,Movie,2345}'::text[]
,'{12,Dave,Theatre,2356}'::text[])
 AS t(col,row1,row2,row3,row4); 
```

[**SQL Fiddle**](http://sqlfiddle.com/#!17/6a115e/5)在 pg 9.6 上运行

## Postgres 9.3 或更高版本

### 动态解决方案`crosstab()`

*   完全动态，适用于任何桌子。**在两个**地方提供表名：

```
SELECT 'SELECT *
FROM   crosstab(
       ''SELECT unnest(''' || quote_literal(array_agg(attname))
                           || '''::text[]) AS col
             , row_number() OVER ()
             , unnest(ARRAY[' || string_agg(quote_ident(attname)
                              || '::text', ',') || ']) AS val
        FROM   ' || attrelid::regclass || '
        ORDER  BY generate_series(1,' || count(*) || '), 2''
   ) t (col text, '
     || (SELECT string_agg('r'|| rn ||' text', ',')
         FROM (SELECT row_number() OVER () AS rn FROM **tbl**) t)
     || ')' AS sql
FROM   pg_attribute
WHERE  attrelid = '**tbl**'::regclass
AND    attnum > 0
AND    NOT attisdropped
GROUP  BY attrelid;
```

可以用单个参数包装到一个函数中......
生成一个形式的查询：

```
SELECT *
FROM   crosstab(
       'SELECT unnest(''{sl_no,username,designation,salary}''::text[]) AS col
             , row_number() OVER ()
             , unnest(ARRAY[sl_no::text,username::text,designation::text,salary::text]) AS val
        FROM   tbl
        ORDER  BY generate_series(1,4), 2'
   ) t (col text, r1 text,r2 text,r3 text,r4 text); 
```

产生所需的结果：

```
col         r1    r2      r3     r4
-----------------------------------
sl_no       1      2      3      4
username    A      B      C      D
designation XYZ    RTS    QWE    HGD
salary      10000  50000  20000  34343 
```

### 简单的解决方案`unnest()`

```
SELECT 'SELECT unnest(''{sl_no, username, designation, salary}''::text[] AS col)
     , ' || string_agg('unnest('
                    || quote_literal(ARRAY[sl_no::text, username::text, designation::text, salary::text])
                    || '::text[]) AS row' || sl_no, E'\n     , ') AS sql
FROM   tbl; 
```

*   对于多于几列的表来说很慢。

生成以下形式的查询：

```
SELECT unnest('{sl_no, username, designation, salary}'::text[]) AS col
     , unnest('{10,Joe,Music,1234}'::text[]) AS row1
     , unnest('{11,Bob,Movie,2345}'::text[]) AS row2
     , unnest('{12,Dave,Theatre,2356}'::text[]) AS row3
     , unnest('{4,D,HGD,34343}'::text[]) AS row4 
```

结果相同。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-12-29T18:34:53.770

```
SELECT
   unnest(array['Sl.no', 'username', 'Designation','salary']) AS "Columns",
   unnest(array[Sl.no, username, value3Count,salary]) AS "Values"
FROM view_name
ORDER BY "Columns" 
```

参考：[**conversionColumnsToRows**](https://stackoverflow.com/questions/10624864/transpose-column-headers-to-rows-in-postgresql/10625294#10625294)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-03-16T18:57:05.847

如果（像我一样）您需要来自 bash 脚本的这些信息，请注意，psql 有一个简单的命令行开关，可以告诉它将表列输出为行：

```
psql mydbname -x -A -F= -c "SELECT * FROM foo WHERE id=123" 
```

该`-x`选项是让 psql 将列输出为行的关键。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-05T17:21:04.913

我有一个比 Erwin 上面指出的更简单的方法，即我使用 Postgres 的那个工人（我认为它应该适用于所有支持 SQL 标准的主要关系数据库）

您可以简单地使用 UNION 而不是交叉表：

```
SELECT text 'a' AS "text" UNION SELECT 'b';

 text
------
 a
 b
(2 rows) 
```

当然，这取决于您要应用它的情况。考虑到您事先知道需要哪些字段，即使查询不同的表也可以采用这种方法。IE：

```
SELECT 'My first metric' as name, count(*) as total from first_table UNION
SELECT 'My second metric' as name, count(*) as total from second_table 

 name             | Total
------------------|--------
 My first metric  |     10
 My second metric |     20
(2 rows) 
```

It's a more maintainable approach, IMHO. Look at this page for more information: [https://www.postgresql.org/docs/current/typeconv-union-case.html](https://www.postgresql.org/docs/current/typeconv-union-case.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T19:00:25.740

在纯 SQL 或 PL/pgSQL 中没有合适的方法来执行此操作。

在从数据库获取数据的应用程序中执行此操作会更好。

# php - HTML 表单、Javascript、PHP 和与 MySQL 的 DB 连接

> ID：14084504
> 
> 赞同：-4
> 
> 时间：2012-12-29T18:07:36.993
> 
> 标签：php, javascript, html, mysql

我有一个表格，填写后，我希望将数据插入数据库。截至目前，数据库有两列，“反馈”和“日期”。但是现在，只有“日期”被插入数据库，而不是“反馈”。

HTML 表单：

```
<form class="form-inline" action="JavaScript:sendFeedback()" method="get">
<textarea name="Feedback" placeholder="Feedback..." rows="5" cols="100"></textarea> 
<button type="submit" class="btn">Tell us</button>
</form> 
```

Javascript：

```
function sendFeedback() {
    _gaq.push(['_trackPageview', 'OutgoingLink=SendFeedback' ]);
    $.get("../php/NewFeedback.php",{Feedback:$('input[name="Feedback"]').val()});
    var element = document.getElementById("FeedbackArea");
    element.innerHTML = "<div class=\"alert alert-success\"> <a class=\"close\" data-dismiss=\"alert\" href=\"#\">×</a>Thanks for your feedback!</div>";
    return false;
} 
```

php:

```
$db = MySql::getInstance(DATABASE_HOST, DATABASE_USER, DATABASE_PASS, DATABASE_NAME);
$Feedback = mysql_real_escape_string($_GET['Feedback']);

//create the sql statement
$sql = "INSERT INTO Feedback VALUES('{$Feedback}', CURDATE());";

//execute the query
$res = $db->query($sql); 
```

就像我说的，如果我在 textarea 中输入一些内容并按下“告诉我们”按钮，数据库将获得一个新条目，但“反馈”属性为空（并且填写了日期）。

为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:09:31.363

您没有名为 Feedback 的输入，您有一个 textarea，因此`$('input[name="Feedback"]').val()`不会为您提供该字段的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:24:36.083

### 更改您的代码：

```
$('textarea[name="Feedback"]').val() 
```

它会起作用。

# android - 实现具有独立行高的多列 ListView

> ID：14084507
> 
> 赞同：8
> 
> 时间：2012-12-29T18:07:45.900
> 
> 标签：android, layout, android-image

我想以“拼贴”方式创建一个包含以下布局的大约 200 个 ImageViews（随机高度）的列表：

![在此处输入图像描述](../Images/91c77ded6ac058f3d5005a3ba68e16f3.png)

通常我会在 ListView 中执行此操作以获得使用适配器获得的性能，但由于我希望图像按列显示，并且根据图片具有不同的高度（参见图片[示例](https://imgur.com/VqNFn)），我不能为此目的使用单个列表视图.

我尝试使用以下方法实现此布局：

*   三个具有同步滚动的 ListView = 慢
*   每行包含三个图像的单个 ListView = 不允许不同的高度
*   GridView = 不允许不同的高度
*   GridLayout = 难以以编程方式实现不同的高度。由于没有适配器，OutOfMemoryErrors 很常见
*   FlowLayout = 因为没有适配器，OutOfMemoryErrors 很常见
*   具有三个 Vertical LinearLayouts 的 ScrollView = 迄今为止最好的解决方案，但 OutOfMemoryErrors 很常见

我最终在 ScrollView 中使用了三个 LinearLayout，但这远非最佳。我宁愿使用带有适配器的东西。

**编辑** 我一直在查看 StaggeredGridView，如下面的回复中所示，但我发现它非常有问题。有没有更稳定的实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T19:47:24.980

我想我有一个适合你的解决方案。

*这里提到的主要文件也位于[http://pastebin.com/u/morganbelford的 PasteBin 上](http://pastebin.com/u/morganbelford)*

我基本上使用一组出色的 LoopJ实现了与提到的 github 项目[https://github.com/maurycyw/StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)`SmartImageViews`的简化等效项。

我的解决方案不像`StaggeredGridView`. 功能上的一大区别是我们总是从左到右排列图像，然后再从左到右排列。我们不会尝试将下一张图片放在最短的列中。这使得视图的底部更加不均匀，但在从 web 初始加载期间产生的移动更少。

主要有三个类，一个 custom `StagScrollView`，其中包含一个 custom `StagLayout`（subclassed `FrameLayout`），它管理一组`ImageInfo`数据对象。

这是我们的**布局**，stag_layout.xml（*1000dp 初始高度无关紧要，因为它将根据图像大小在代码中重新计算*）：

```
// stag_layout.xml
<?xml version="1.0" encoding="utf-8"?>
<com.morganbelford.stackoverflowtest.pinterest.StagScrollView xmlns:a="http://schemas.android.com/apk/res/android"
 a:id="@+id/scroller"
 a:layout_width="match_parent"
 a:layout_height="match_parent" >

  <com.morganbelford.stackoverflowtest.pinterest.StagLayout
    a:id="@+id/frame"
    a:layout_width="match_parent"
    a:layout_height="1000dp"
    a:background="@drawable/pinterest_bg" >
  </com.morganbelford.stackoverflowtest.pinterest.StagLayout>

</com.morganbelford.stackoverflowtest.pinterest.StagScrollView> 
```

这是我们的主要**活动** `onCreate`，它使用布局。`StagActivity`只是基本上告诉使用什么`StagLayout`网址，每个图像之间的边距应该是多少，以及有多少列。为了更加模块化，我们可以将这些参数传递给 StagScrollView（其中包含 StagLayout，但滚动视图无论如何都必须将它们传递给布局）：

```
// StagActivity.onCreate
setContentView(R.layout.stag_layout);

StagLayout container = (StagLayout) findViewById(R.id.frame);

DisplayMetrics metrics = new DisplayMetrics();
((WindowManager)getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay().getMetrics(metrics);  
float fScale = metrics.density;

String[] testUrls = new String[] { 
    "http://www.westlord.com/wp-content/uploads/2010/10/French-Bulldog-Puppy-242x300.jpg", 
    "http://upload.wikimedia.org/wikipedia/en/b/b0/Cream_french_bulldog.jpg",
    "http://bulldogbreeds.com/breeders/pics/french_bulldog_64368.jpg",
    "http://www.drsfostersmith.com/images/articles/a-french-bulldog.jpg",
    "http://2.bp.blogspot.com/-ui2p5Z_DJIs/Tgdo09JKDbI/AAAAAAAAAQ8/aoTdw2m_bSc/s1600/Lilly+%25281%2529.jpg",
    "http://www.dogbreedinfo.com/images14/FrenchBulldog7.jpg",
    "http://dogsbreed.net/wp-content/uploads/2011/03/french-bulldog.jpg",
    "http://www.theflowerexpert.com/media/images/giftflowers/flowersandoccassions/valentinesdayflowers/sea-of-flowers.jpg.pagespeed.ce.BN9Gn4lM_r.jpg",
    "http://img4-2.sunset.timeinc.net/i/2008/12/image-adds-1217/alcatraz-flowers-galliardia-m.jpg?300:300",
    "http://images6.fanpop.com/image/photos/32600000/bt-jpgcarnation-jpgFlower-jpgred-rose-flow-flowers-32600653-1536-1020.jpg",
    "http://the-bistro.dk/wp-content/uploads/2011/07/Bird-of-Paradise.jpg",
    "http://2.bp.blogspot.com/_SG-mtHOcpiQ/TNwNO1DBCcI/AAAAAAAAALw/7Hrg5FogwfU/s1600/birds-of-paradise.jpg",
    "http://wac.450f.edgecastcdn.net/80450F/screencrush.com/files/2013/01/get-back-to-portlandia-tout.jpg",
    "http://3.bp.blogspot.com/-bVeFyAAgBVQ/T80r3BSAVZI/AAAAAAAABmc/JYy8Hxgl8_Q/s1600/portlandia.jpg",
    "http://media.oregonlive.com/ent_impact_tvfilm/photo/portlandia-season2jpg-7d0c21a9cb904f54.jpg",
    "https://twimg0-a.akamaihd.net/profile_images/1776615163/PortlandiaTV_04.jpg",
    "http://getvideoartwork.com/gallery/main.php?g2_view=core.DownloadItem&g2_itemId=85796&g2_serialNumber=1",
    "http://static.tvtome.com/images/genie_images/story/2011_usa/p/portlandia_foodcarts.jpg",
    "http://imgc.classistatic.com/cps/poc/130104/376r1/8728dl1_27.jpeg",

    };
container.setUrls(testUrls, fScale * 10, 3); // pass in pixels for margin, rather than dips 
```

在我们了解解决方案的实质之前，这是我们的简单**`StagScrollView`**子类。他唯一的特殊行为是告诉他的主要孩子（我们的`StagLayout`）当前可见区域是哪个，以便他可以有效地使用尽可能少的已实现子视图。

```
// StagScrollView
StagLayout _frame;

@Override
protected void onFinishInflate() {
    super.onFinishInflate();

    _frame = (StagLayout) findViewById(R.id.frame);

}

@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {
    super.onSizeChanged(w, h, oldw, oldh);
    if (oldh == 0)
        _frame.setVisibleArea(0, h);
}

@Override
protected void onScrollChanged(int l, int t, int oldl, int oldt) {
    super.onScrollChanged(l, t, oldl, oldt);
    _frame.setVisibleArea(t, t + getHeight());
} 
```

接下来就是最重要的课了**`StagLayout`**。

首先，`setUrls`设置我们的数据结构。

```
public void setUrls(String[] urls, float pxMargin, int cCols)
{
    _pxMargin = pxMargin;
    _cCols = cCols;
    _cMaxCachedViews = 2 * cCols;
    _infos = new ArrayList<ImageInfo>(urls.length);  // should be urls.length

    for (int i = 0; i < 200; i++)  // should be urls.length IRL, but this is a quick way to get more images, by using repeats
    {
        final String sUrl = urls[i % urls.length]; // could just be urls[i] IRL
        _infos.add(new ImageInfo(sUrl, new OnClickListener() {

            @Override
            public void onClick(View v) {
                Log.d("StagLayout", String.format("Image clicked: url == %s", sUrl));
            }
        }));
    }

    _activeInfos = new HashSet<ImageInfo>(_infos.size());
    _cachedViews = new ArrayList<SmartImageView>(_cMaxCachedViews);

    requestLayout();  // perform initial layout

} 
```

我们的**主要数据结构**是`ImageInfo`. 它是一种轻量级的占位符，允许我们跟踪每个图像将在什么时候显示在哪里。当我们布局子视图时，我们将使用 ImageInfo 中的信息来确定放置实际视图的位置。将 ImageInfo 视为“虚拟图像视图”的一个好方法。

*有关详细信息，请参阅内联评论。*

```
public class ImageInfo {

private String _sUrl;

// these rects are in float dips
private RectF _rLoaded;  // real size of the corresponding loaded SmartImageView
private RectF _rDefault; // lame default rect in case we don't have anything better to go on
private RectF _rLayout;  // rect that our parent tells us to use -- this corresponds to a real View's layout rect as specified when parent ViewGroup calls child.layout(l,t,r,b)

private SmartImageView _vw;

private View.OnClickListener _clickListener;

public ImageInfo(String sUrl, View.OnClickListener clickListener) {
    _rDefault = new RectF(0, 0, 100, 100);
    _sUrl = sUrl;
    _rLayout = new RectF();
    _clickListener = clickListener;
}

// Bounds will be called by the StagLayout when it is laying out views.
// We want to return the most accurate bounds we can.
public RectF bounds() {
    // if there is not yet a 'real' bounds (from a loaded SmartImageView), try to get one
    if (_rLoaded == null && _vw != null) {
        int h = _vw.getMeasuredHeight();
        int w = _vw.getMeasuredWidth();

        // if the SmartImageView thinks it knows how big it wants to be, then ok
        if (h > 0 && w > 0) {  
            _rLoaded = new RectF(0, 0, w, h);
        }
    }
    if (_rLoaded != null)
        return _rLoaded;

    // if we have not yet gotten a real bounds from the SmartImageView, just use this lame rect
    return _rDefault;
}

// Reuse our layout rect -- this gets called a lot
public void setLayoutBounds(float left, float top, float right, float bottom) {
    _rLayout.top = top;
    _rLayout.left = left;
    _rLayout.right = right;
    _rLayout.bottom = bottom;
}

public RectF layoutBounds() {
    return _rLayout;
}

public SmartImageView view() {
    return _vw;
}

// This is called during layout to attach or detach a real view
public void setView(SmartImageView vw) 
{
    if (vw == null && _vw != null)
    {
        // if detaching, tell view it has no url, or handlers -- this prepares it for reuse or disposal 
        _vw.setImage(null, (SmartImageTask.OnCompleteListener)null);
        _vw.setOnClickListener(null);
    }

    _vw = vw;

    if (_vw != null)
    {
        // We are attaching a view (new or re-used), so tell it its url and attach handlers.
        // We need to set this OnCompleteListener so we know when to ask the SmartImageView how big it really is
        _vw.setImageUrl(_sUrl, R.drawable.default_image, new SmartImageTask.OnCompleteListener() {
            final private View vw = _vw;
            @Override
            public void onComplete() {
                vw.measure(MeasureSpec.makeMeasureSpec(LayoutParams.WRAP_CONTENT, MeasureSpec.UNSPECIFIED), MeasureSpec.makeMeasureSpec(LayoutParams.WRAP_CONTENT, MeasureSpec.UNSPECIFIED));
                int h = vw.getMeasuredHeight();
                int w = vw.getMeasuredWidth();
                _rLoaded = new RectF(0, 0, w, h);
                Log.d("ImageInfo", String.format("Settings loaded size onComplete %d x %d for %s", w, h, _sUrl));
            }
        });
        _vw.setOnClickListener(_clickListener);
    }
}

// Simple way to answer the question, "based on where I have laid you out, are you visible"
public boolean overlaps(float top, float bottom) {
    if (_rLayout.bottom < top)
        return false;
    if (_rLayout.top > bottom)
        return false;

    return true;
}

} 
```

其余的魔法发生在`StagLayout's` `onMeasure`和中`onLayout`。

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

    int width = MeasureSpec.getSize(widthMeasureSpec);

    // Measure each real view that is currently realized. Initially there are none of these
    for (ImageInfo info : _activeInfos)
    {
        View v = info.view();
        v.measure(MeasureSpec.makeMeasureSpec(LayoutParams.WRAP_CONTENT, MeasureSpec.UNSPECIFIED), MeasureSpec.makeMeasureSpec(LayoutParams.WRAP_CONTENT, MeasureSpec.UNSPECIFIED));
    }

    // This arranges all of the imageinfos every time, and sets _maxBottom
    // 
    computeImageInfo(width);  
    setMeasuredDimension(width, (int)_maxBottom);
}

@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {

    // This figures out what real SmartImageViews we need, creates new ones, re-uses old ones, etc.  
    // After this call _activeInfos is correct -- the list of ImageInfos that are currently attached to real SmartImageViews
    setupSubviews();

    for (ImageInfo info : _activeInfos)
    {
        // Note: The layoutBounds of each info is actually computed in onMeasure
        RectF rBounds = info.layoutBounds();  
        // Tell the real view where it should be
        info.view().layout((int)rBounds.left, (int)rBounds.top, (int)rBounds.right, (int)rBounds.bottom);    
    }

} 
```

好的，现在让我们看看我们**实际上是如何安排**所有 ImageInfo 的。

```
private void computeImageInfo(float width)
{
    float dxMargin = _pxMargin; 
    float dyMargin = _pxMargin;

    float left = 0;
    float tops[] = new float[_cCols];  // start at 0
    float widthCol = (int)((width - (_cCols + 1) * dxMargin) / _cCols);

    _maxBottom = 0;

    // layout the images -- set their layoutrect based on our current location and their bounds
    for (int i = 0; i < _infos.size(); i++)
    {
        int iCol = i % _cCols;
        // new row
        if (iCol == 0)
        {
           left = dxMargin;
           for (int j = 0; j < _cCols; j++)
               tops[j] += dyMargin;
        }
        ImageInfo info = _infos.get(i); 
        RectF bounds = info.bounds();
        float scale = widthCol / bounds.width(); // up or down, for now, it does not matter
        float layoutHeight = bounds.height() * scale;
        float top = tops[iCol];
        float bottom = top + layoutHeight;
        info.setLayoutBounds(left, top, left + widthCol, bottom);

        if (bottom > _maxBottom)
            _maxBottom = bottom;
        left += widthCol + dxMargin;
        tops[iCol] += layoutHeight;
    }

    // TODO Optimization: build indexes of tops and bottoms
    //  Exercise for reader

    _maxBottom += dyMargin;
} 
```

而且，现在让我们看看我们如何`SmartImageViews`在`onLayout`.

```
private void setupSubviews()
{

    // We need to compute new set of active views

    // TODO Optimize enumeration using indexes of tops and bottoms

    // NeededInfos will be set of currently visible ImageInfos
    HashSet<ImageInfo> neededInfos = new HashSet<ImageInfo>(_infos.size());
    // NewInfos will be subset that are not currently assigned real views
    HashSet<ImageInfo> newInfos = new HashSet<ImageInfo>(_infos.size());
    for (ImageInfo info : _infos)
    {
        if (info.overlaps(_viewportTop, _viewportBottom))
        {
            neededInfos.add(info);
            if (info.view() == null)
                newInfos.add(info);
        }
    }

    // So now we have the active ones. Lets get any we need to deactivate.    
    // Start with a copy of the _activeInfos from last time
    HashSet<ImageInfo> unneededInfos = new HashSet<ImageInfo>(_activeInfos); 

    // And remove all the ones we need now, leaving ones we don't need any more
    unneededInfos.removeAll(neededInfos);

    // Detach all the views from these guys, and possibly reuse them
    ArrayList<SmartImageView> unneededViews = new ArrayList<SmartImageView>(unneededInfos.size());
    for (ImageInfo info : unneededInfos)
    {
        SmartImageView vw = info.view();
        unneededViews.add(vw);
        info.setView(null); // at this point view is still a child of parent
    }

    // So now we try to reuse the views, and create new ones if needed
    for (ImageInfo info : newInfos)
    {
        SmartImageView vw = null;
        if (unneededViews.size() > 0)
        {
            vw = unneededViews.remove(0); // grab one of these -- these are still children and so dont need to be added to parent
        }
        else if (_cachedViews.size() > 0)
        {
            vw = _cachedViews.remove(0);  // else grab a cached one and re-add to parent
            addViewInLayout(vw, -1, new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        }
        else 
        {
            vw = new SmartImageView(getContext()); // create a whole new one
            FrameLayout.LayoutParams lp = new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
            addViewInLayout(vw, -1, lp);  // and add to parent
        }
        info.setView(vw);  // info should also set its data
    }

    // At this point, detach any unneeded views and add to our cache, up to limit
    for (SmartImageView vw : unneededViews)
    {
        // tell view to cancel
        removeViewInLayout(vw);  // always remove from parent
        if (_cachedViews.size() < _cMaxCachedViews)
            _cachedViews.add(vw);
    }

    // Record the active ones for next time around
    _activeInfos = neededInfos;

} 
```

请记住，每次用户滚动时都会设置 _viewportTop 和 _viewportBottom。

```
// called on every scroll by parent StagScrollView
public void setVisibleArea(int top, int bottom) {

    _viewportTop = top;
    _viewportBottom = bottom;

    //fixup views
    if (getWidth() == 0) // if we have never been measured, dont do this - it will happen in first layout shortly
        return;
    requestLayout();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:38:25.283

你可以看看[https://github.com/maurycyw/StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)

我没有亲自使用它，但你至少可以窃取一些概念。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T16:02:05.913

你知道为什么 3 List View 解决方案很慢吗？

每列有多少种不同的尺寸？我认为，为了有效地回收视图，您需要为每种尺寸的图像创建一个视图类型，然后确保使用[getItemViewType](http://developer.android.com/reference/android/widget/Adapter.html#getItemViewType%28int%29)，以确保您正在回收正确类型的视图。否则，您将不会从回收中获得太多好处。您可能希望能够仅重置图像视图的源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T10:37:22.030

您不能使用包含在自定义列表中的当前解决方案吗？

在每一行的 getView 方法中，膨胀您现有的解决方案（当然检查 converview），即具有三个 Vertical LinearLayouts 的 ScrollView。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T05:47:44.350

我想它可以用三个独立的列表视图来实现，只有你必须这样做才能为 imageview 膨胀布局并将其添加到列表视图中。

在膨胀期间使用以下作为布局参数。

布局宽度：match_parent 布局高度：wrap_content 您可以为所有三个列表视图分配布局权重为 0.3，其中 layout_width 为 0dp，高度为 fill_parent。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-05T08:07:35.123

1.  在布局中创建列表视图。
2.  创建另一个与列表视图背景布局具有相同背景的布局，其中包含三个图像视图（彼此相邻，即彼此右侧），它们的属性水平设置为 Wrap_Content，图像视图所在的整个视图属性设置为 Wrap_Content .
3.  在 listview 适配器的 getview() 方法中膨胀布局。在此您需要在膨胀布局的图像视图中设置 3 组图像。

希望这可以帮助！

# android - Android 转换程序在按钮单击时崩溃

> ID：14084509
> 
> 赞同：2
> 
> 时间：2012-12-29T18:07:54.323
> 
> 标签：android, button

这是我的文件（Conversion.xml、Conversion.java 和 AndroidManifest.xml）。它只是一个项目的一小部分。我能够进入我想要将功率（以瓦特为单位）转换为分贝的屏幕。但是当我输入功率值并单击“转换”按钮时，应用程序崩溃并返回到我的应用程序主屏幕。

**转换.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".ConvertTodB" >

    <EditText
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="Enter the power in Watts"
        android:inputType="number"
        android:text="@string/et1" />

    <Button
        android:id="@+id/bConvert"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/Convert" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="Result in dB"
        android:text="@string/et2" 
        android:textSize="20sp"/>

</LinearLayout> 
```

**转换.java**

```
package com.example.rfconcepts;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

import java.lang.Math;

public class Conversion extends Activity {

    EditText entered_val;
    TextView result_val;
    Button bCon;

    @Override
    protected void onCreate(Bundle convertTodB) {

        super.onCreate(convertTodB);
        setContentView(R.layout.conversion);

        entered_val = (EditText) findViewById(R.string.et1);
        bCon = (Button) findViewById(R.id.bConvert);
        result_val = (TextView) findViewById(R.string.et2);

        bCon.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                if(entered_val.getText() != null && entered_val.getText().length() != 0){
                    result_val.setText(String.valueOf(10 * Math.log10(Double
                            .valueOf(entered_val.getText().toString()))));
                }

            }
        });
    }
} 
```

**AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.rfconcepts"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.rfconcepts.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name="com.example.rfconcepts.Conversion"
            android:label="@string/app_name">
        </activity>
    </application>

</manifest> 
```

我提前感谢您的建议。

PS：

这是我在阅读了针对此处发布的各种问题的大量解决方案后所做的事情的列表。

*   在conversion.xml 中，我没有使用onClickListener，而是添加了属性“android:onClick =”onClickConvert”，并在Activity 类中添加了以下onClickConvert 方法。

```
public void onClickConvert(View v){
        if(entered_val.getText() != null && entered_val.getText().length() != 0){
            result_val.setText(String.valueOf(10 * Math.log10(Double
                    .valueOf(entered_val.getText().toString()))));
        }
    } 
```

*   将 Double.parseDouble() 更改为 Double.valueOf() （虽然，我认为这不是问题）

*   检查 editText 本身是否为空，因此检查 if 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:11:25.067

```
entered_val = (EditText) findViewById(R.string.et1); 
```

你为什么指的是一个字符串？应该是身份证。

您没有为您的 EditTexts 声明 ID。做这样的事情：

```
<EditText
        [...]
        android:id="@+id/MyEditText"
         /> 
```

然后你可以这样引用它：

```
entered_val = (EditText) findViewById(R.Id.MyEditText); 
```

也对您的 TextView 执行相同的操作。

第二个问题： `EditText.getText()`返回一个`Editable`，但你需要一个`String`. 像这样转换它：

```
 if(entered_val.getText().toString() != null && entered_val.getText().toString().length() != 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:16:07.923

您应在您的conversion.xml 的EditText 中创建一个ID，然后在Java 代码中访问它。发布您的 logcat 错误以获得更具体的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:17:20.717

### 您需要在 power 和 result 中将参考 id 添加到 EDITTEXT

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:tools="http://schemas.android.com/tools"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 android:orientation="vertical"
 tools:context=".ConvertTodB" >

<EditText
    android:id="@+id/et1" // add the reference id
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Enter the power in Watts"
    android:inputType="number"
    android:text="@string/et1" />

<Button
    android:id="@+id/bConvert"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/Convert" />

<TextView
    android:id="@+id/et2"// add the reference id
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Result in dB"
    android:text="@string/et2" 
    android:textSize="20sp"/> 
```

### 还在你的java代码中用referenceid连接了那些edittext

```
 entered_val = (EditText) findViewById(R.id.et1); // wired up with the xml id of the component
    bCon = (Button) findViewById(R.id.bConvert);
    result_val = (TextView) findViewById(R.id.et2);// wired up with the xml id of the component 
```

# javascript - 选择标签事件不触发超过 2 次

> ID：14084511
> 
> 赞同：0
> 
> 时间：2012-12-29T18:08:24.820
> 
> 标签：javascript, forms, select

我做了三个下拉月年日{1,2,3 ...}我希望只有有效的日期显示在下拉菜单中。即如果选择 1 月 31 是上限如果选择 2 月 28 或 29 取决于年份（是否闰）

```
var monthselected,yearselected,mtype=0,visited=0;
function reassembleDate(){
if(monthselected==4||monthselected==6||monthselected==9||monthselected==11)
                            {mtype=30;}
                        if(monthselected==2&&isleapyear(yearselected))
                            {mtype=29;}
                        if(monthselected==2&&!isleapyear(yearselected))
                            {mtype=28;}

                        else if(mtype==0){mtype=31;} 
                            removeOptions();
                           addOptions(mtype);}                          
function removeOptions(){
var x=document.getElementById('dayselect');
while(x.length>29)
    { x.remove(x.length-1);}
    }

function addOptions(mtype)
{
//alert('initialising');
var i;
for(i=29;i<=mtype;i++)
{
var x=document.getElementById("dayselect");
    var option=document.createElement("option");

option.text=i;
try
  {//alert('trying');
  // for IE earlier than version 8
  x.add(option,x.options[null]);
  }
catch (e)
  {//alert('catching');
  x.add(option,null);
  }
}
}                           
function isleapyear(year){
        if((year%4)==0)
        {
        if((year%100)!=0)
        {
        return true;
        }
        else return false;
        }
        if((year%400)==0)
            {

            return true;

            }

else return false;
}                       

<td><select  id="month" name="month" class="int" onChange="reassembleDate();"   onBlur="monthselected=document.getElementById('month').value; reassembleDate();"        >
                        <option value="">Month</option>
                        <option value="01" >January</option>
                        <option value="02" >  February</option>
                        <option value="03" >  March</option>
                        <option value="04" >  April</option>
                        <option value="05" >  May</option>
                        <option value="06" >  June</option>
                        <option value="07" >  July</option>
                        <option value="08" >  August</option>
                        <option value="09" >  September</option>
                        <option value="10" >  October</option>
                        <option value="11" >  November</option>
                        <option value="12" >  December</option>
                        </select>

<label id="year-label" class="year int">  Year</label>
  <select class="int" id="year" name="year" onChange="reassembleDate();" onBlur="yearselected=document.getElementById('year').value; reassembleDate();"><option value="0" >YYYY</option>
<?php for($i=2012;$i>1912;$i--){echo "<option value=\"$i\">$i</option>";} ?>            </select>
<label id="day-label" class="day int">Day</label><select id="dayselect" class="int" name="day" >
<option value="0" >  DD</option>
<?php for($i=1;$i<29;$i++){echo "<option value=\"$i\">$i</option>";} ?></select> 
```

当最多有两个更改时，代码可以正常工作，但之后 date{1,2,3...} 的列表没有更改。为什么会发生这种情况？我曾尝试更改 onChange 和 onBlur 等所有事件的日期，但没有帮助。

生成的html

```
Birthday</td><td><select  id="month" name="month" class="int" onChange="reassembleDate();"  onBlur="monthselected=document.getElementById('month').value; reassembleDate();"        >
                        <option value="">Month</option>
                        <option value="01" >January</option>
                        <option value="02" >  February</option>
                        <option value="03" >  March</option>
                        <option value="04" >  April</option>
                        <option value="05" >  May</option>
                        <option value="06" >  June</option>
                        <option value="07" >  July</option>
                        <option value="08" >  August</option>
                        <option value="09" >  September</option>
                        <option value="10" >  October</option>
                        <option value="11" >  November</option>
                        <option value="12" >  December</option>
                        </select>

                        <label id="year-label" class="year int">
  Year</label>
  <select class="int" id="year" name="year" onChange="reassembleDate();" onBlur="yearselected=document.getElementById('year').value; reassembleDate();"><option value="0" >YYYY</option>
                                <option value="2012">2012</option><option value="2011">2011</option><option value="2010">2010</option><option value="2009">2009</option><option value="2008">2008</option><option value="2007">2007</option><option value="2006">2006</option><option value="2005">2005</option><option value="2004">2004</option><option value="2003">2003</option><option value="2002">2002</option><option value="2001">2001</option><option value="2000">2000</option><option value="1999">1999</option><option value="1998">1998</option><option value="1997">1997</option><option value="1996">1996</option><option value="1995">1995</option><option value="1994">1994</option><option value="1993">1993</option><option value="1992">1992</option><option value="1991">1991</option><option value="1990">1990</option><option value="1989">1989</option><option value="1988">1988</option><option value="1987">1987</option><option value="1986">1986</option><option value="1985">1985</option><option value="1984">1984</option><option value="1983">1983</option><option value="1982">1982</option><option value="1981">1981</option><option value="1980">1980</option><option value="1979">1979</option><option value="1978">1978</option><option value="1977">1977</option><option value="1976">1976</option><option value="1975">1975</option><option value="1974">1974</option><option value="1973">1973</option><option value="1972">1972</option><option value="1971">1971</option><option value="1970">1970</option><option value="1969">1969</option><option value="1968">1968</option><option value="1967">1967</option><option value="1966">1966</option><option value="1965">1965</option><option value="1964">1964</option><option value="1963">1963</option><option value="1962">1962</option><option value="1961">1961</option><option value="1960">1960</option><option value="1959">1959</option><option value="1958">1958</option><option value="1957">1957</option><option value="1956">1956</option><option value="1955">1955</option><option value="1954">1954</option><option value="1953">1953</option><option value="1952">1952</option><option value="1951">1951</option><option value="1950">1950</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option><option value="1929">1929</option><option value="1928">1928</option><option value="1927">1927</option><option value="1926">1926</option><option value="1925">1925</option><option value="1924">1924</option><option value="1923">1923</option><option value="1922">1922</option><option value="1921">1921</option><option value="1920">1920</option><option value="1919">1919</option><option value="1918">1918</option><option value="1917">1917</option><option value="1916">1916</option><option value="1915">1915</option><option value="1914">1914</option><option value="1913">1913</option>                                                                            </select>

                        <label id="day-label" class="day int">Day   </label><select id="dayselect" class="int" name="day" >

                                <option value="0" >  DD</option>
                                <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option>                                          </select>

<div id="bday-h" class="helptext int" style="display:inline">Select appropriate values</div>                                                                        </td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:56:46.347

这是工作脚本：

问题：

onchange() 期间不会重新计算月/年的值。用于计算当月天数的检查问题。

* * *

```
var monthselected,yearselected,mtype=0,visited=0;

function reassembleDate(){

    monthselected = parseInt(document.getElementById('month').value);
    yearselected = parseInt(document.getElementById('year').value); 

    if(monthselected == "" || yearselected == "0") {
        return;
    }

    if(monthselected==4||monthselected==6||monthselected==9||monthselected==11)
        {mtype=30;}
    else if(monthselected==2&&isleapyear(yearselected))
        {mtype=29;}
    else if(monthselected==2&&!isleapyear(yearselected))
        {mtype=28;}
    else
        {mtype=31;} 

    removeOptions();
    addOptions(mtype);
}

function removeOptions(){
    var x=document.getElementById('dayselect');
    while(x.length>28)
    { 
        x.remove(x.length-1);
    }
}

function addOptions(mtype) {
    //alert('initialising');
    var i;
    for(i=29;i<=mtype;i++)
    {
        var x=document.getElementById("dayselect");
        var option=document.createElement("option");

        option.text=i;
        try
          {//alert('trying');
          // for IE earlier than version 8
          x.add(option,x.options[null]);
          }
        catch (e)
          {//alert('catching');
          x.add(option,null);
          }
    }
}             

function isleapyear(year){
    if((year%4)==0)
    {
        if((year%100)!=0)
        {
            return true;
        }
        else return false;
    }

    if((year%400)==0)
    {
        return true;
    }

    else return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T21:10:16.370

提供的答案很好，但有一个例外。2000 年返回不是闰年，因为它在您检查年份是否可被 400 整除之前返回真/假。这是一个固定版本。同样，我让它删除所有数字，因为它有时会复制 29。相反，我让它去掉所有的数字，添加一个“--”开头的占位符，然后根据月份完全填充框。希望这可以帮助。:-)

```
<script type="text/javascript">
var monthselected,yearselected,mtype=0,visited=0;

function reassembleDate(){

    monthselected = parseInt(document.getElementById('month').value);
    yearselected = parseInt(document.getElementById('year').value); 

    if(monthselected == "" || yearselected == "0") {
        return;
    }

    if(monthselected==4||monthselected==6||monthselected==9||monthselected==11)
        {mtype=30;}
    else if(monthselected==2&&isleapyear(yearselected))
        {mtype=29;}
    else if(monthselected==2&&!isleapyear(yearselected))
        {mtype=28;}
    else
        {mtype=31;} 

    removeOptions();
    addOptions(mtype);
}

function removeOptions(){
    var x=document.getElementById('dayselect');
    while(x.length>0)
    { 
        x.remove(x.length-1);
    }
}

function addOptions(mtype) {
    //alert('initialising');
    var x=document.getElementById("dayselect");
    var option=document.createElement("option");
    option.text='--';
    try
      {//alert('trying');
      // for IE earlier than version 8
      x.add(option,x.options[null]);
      }
    catch (e)
      {//alert('catching');
      x.add(option,null);
      }
    var i;
    for(i=1;i<=mtype;i++)
    {
        var x=document.getElementById("dayselect");
        var option=document.createElement("option");

        option.text=i;
        try
          {//alert('trying');
          // for IE earlier than version 8
          x.add(option,x.options[null]);
          }
        catch (e)
          {//alert('catching');
          x.add(option,null);
          }
    }
}             

function isleapyear(year){
    if((year%400)==0)
    {
        return true;
    }

    if((year%4)==0)
    {
        if((year%100)!=0)
        {
            return true;
        }
        else return false;
    }

    else return false;
}   
</script> 
```

# objective-c - iOS5 中的错误，但在 iOS6 中工作

> ID：14084519
> 
> 赞同：1
> 
> 时间：2012-12-29T18:10:02.930
> 
> 标签：objective-c

在 iOS5 模拟器中运行时收到此错误：

由于未捕获的异常'NSInvalidArgumentException'而终止应用程序，原因：' *** - [__NSPlaceholderDictionary initWithObjects：forKeys：count：]：尝试从对象[3]中插入零对象'***第一次抛出调用堆栈：（0x1497052 0x1286d0a 0x13d680b 0x13eee39 0xf92d 0x3f49d6 036 0x404743 0x4051f8 0x3f8aa9 0x1d5efa9 0x146b1c5 0x13d0022 0x13ce90a 0x13cddb4 0x13cdccb 0x3f52a7 0x3f6a9b 0xf15d 0x2405）终止调用抛出异常（lldb）

它在启动时崩溃。:@

我一直在使用断点，我认为（不确定）这可能与这一行有关：

```
@property (nonatomic, retain) CLLocationManager *locationManager; 
```

完整的应用委托：

```
#import <UIKit/UIKit.h>
#import "ECSlidingViewController.h"
#import <CoreLocation/CoreLocation.h>
#import "Reachability.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate, CLLocationManagerDelegate> {
    Reachability* internetReach;
}

@property (strong, nonatomic) UIWindow *window;
@property (nonatomic, retain) CLLocationManager *locationManager;
@property (nonatomic, retain) CLLocation *currentLoc;

@end 
```

谢谢，非常感谢帮助！

# c# - 在不使用临时内存的情况下从列表中删除重复项

> ID：14084520
> 
> 赞同：0
> 
> 时间：2012-12-29T18:10:03.797
> 
> 标签：c#, algorithm, windows-phone-7.1, windows-phone-8

我想编写一个函数，该函数采用整数集合并从集合中删除重复项。我不能应用任何排序算法。同样，我不能复制该集合。我需要节省内存并提供一个高效的解决方案，可以处理数百万个项目而不会显着过度使用电池。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:41:09.543

如果您的内存非常不足，最好的解决方案是首先不在列表中包含冗余整数。为此，您可以使用一个布尔数组 [0..65536]（您可以将其“打包”8 x 8 以使其更小），该数组记录已使用的数组。

另一种解决方案是通过在正确的位置插入项目来对列表进行排序，但如果它们已经在这里，则不要插入它们。插入将在每个项目的日志中（到目前为止的唯一项目数），因此它应该是您列表的 *log(n) 时间。

如果您无法控制源，您仍然可以使用布尔数组，如果需要，可能更大，然后初始化它（将所有设置为 false，然后：isUsed[itemList[i]] = true;），然后您可以处理列表，以便再次拥有内存，然后从数组中构建一个新列表。所以输出将被排序。
如果您的整数是 32 位，则数组将是 500 MB 大，所以可能太大了...，但*取决于整数分布*（是否有广泛的可能数字？？），您可能确实能够降低该大小...

请注意，如果您的内存非常不足，您可能会使用对象池来重用对象。
（您甚至可以重新使用刚刚从列表中删除的对象。）

# c# - 仅在具有指定值时编辑 XML 节点内部文本

> ID：14084521
> 
> 赞同：0
> 
> 时间：2012-12-29T18:10:08.390
> 
> 标签：c#, xml, edit, editing

您好，我需要您的超级帮助。我对 C# 不太熟练，我在这上面堆了大约 6 个小时。所以请如果有人知道帮助我。谢谢

我有这样的 XML

```
<COREBASE>
  <AGENT>
    <AGENT_INDEX>1</AGENT_INDEX>
    <AGENT_PORTER_INDEX>
    </AGENT_PORTER_INDEX>
    <AGENT_NAME>John</AGENT_NAME>
    <AGENT_SURNAME>Smith</AGENT_SURNAME>
    <AGENT_MOBILE_NUMBER>777777777</AGENT_MOBILE_NUMBER>
 </AGENT>
  <AGENT>
    <AGENT_INDEX>2</AGENT_INDEX>
    <AGENT_PORTER_INDEX>1
    </AGENT_PORTER_INDEX>
    <AGENT_NAME>Charles</AGENT_NAME>
    <AGENT_SURNAME>Bukowski</AGENT_SURNAME>
    <AGENT_MOBILE_NUMBER>99999999</AGENT_MOBILE_NUMBER>
 </AGENT>
</COREBASE> 
```

而且我需要在 Windows 窗体组合框中按索引选择代理，然后编辑他的属性并将其保存到 xml。我找到了如何编辑和保存它但我不知道为什么但它保存到第一个代理并覆盖他在 XML 中的属性但不是在选定的.. :-(

如有任何帮助，我会很高兴

```
private void buttonEditAgent_Click(object sender, EventArgs e)
{
    XmlDocument AgentBaseEdit = new XmlDocument();
    AgentBaseEdit.Load("AgentBase.xml");

    XDocument AgentBase = XDocument.Load("AgentBase.xml");

    var all = from a in AgentBase.Descendants("AGENT")
              select new
              {
                  agentI = a.Element("AGENT_INDEX").Value,
                  porterI = a.Element("AGENT_PORTER_INDEX").Value,
                  agentN = a.Element("AGENT_NAME").Value,
                  agentS = a.Element("AGENT_SURNAME").Value,
                  agentM = a.Element("AGENT_MOBILE_NUMBER").Value,

              };

    foreach (var a in all)
    {
        if ("" == textBoxEditAgentIndex.Text.ToString())
        {
            MessageBox.Show("You must fill Agent Index field !!", "WARNING");
        }
        else
        {
           // AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_INDEX").InnerText == textBoxEditAgentIndex.Text

            if (a.agentI == textBoxEditAgentIndex.Text.ToString())
            {
                AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_INDEX").InnerText = textBoxEditAgentIndex.Text;
                AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_PORTER_INDEX").InnerText = textBoxEditAgentPorterIndex.Text;
                AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_NAME").InnerText = textBoxEditAgentName.Text;
                AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_SURNAME").InnerText = textBoxEditAgentSurname.Text;
                AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/AGENT_MOBILE_NUMBER").InnerText = textBoxEditAgentMobile.Text;

                AgentBaseEdit.Save("AgentBase.xml");
                ClearEditAgentTxtBoxes();
            }
        }
    }
} 
```

我是在正确的道路上，但我没有看到门还是我完全错了？谢谢大家。巫女

好的，我尝试过这种方式，但它没有改变内部文本

```
string agentIndex = comboBoxEditAgentI.SelectedItem.ToString();

        XmlDocument AgentBaseEdit = new XmlDocument();
        AgentBaseEdit.Load("AgentBase.xml");

        XDocument AgentBase = XDocument.Load("AgentBase.xml");

        var xElemAgent = AgentBase.Descendants("AGENT")
            .First(a => a.Element("AGENT_INDEX").Value == agentIndex);

        xElemAgent.Element("AGENT_MOBILE_NUMBER").Value = textBoxEditAgentMobile.Text;
        xElemAgent.Element("AGENT_SURNAME").Value = textBoxEditAgentSurname.Text;

        AgentBaseEdit.Save("AgentBase.xml"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:28:10.300

如果你使用 Linq2Xml 会更容易。

```
int agentIndex = 2;

XDocument xDoc = XDocument.Load(filename);

var xElemAgent = xDoc.Descendants("AGENT")
                .First(a => a.Element("AGENT_INDEX").Value == agentIndex.ToString());

//or
//var xElemAgent = xDoc.XPathSelectElement(String.Format("//AGENT[AGENT_INDEX='{0}']",agentIndex));

xElemAgent.Element("AGENT_MOBILE_NUMBER").Value = "5555555";

xDoc.Save(fileName) 
```

PS：命名空间：`System.Xml.XPath` `System.Xml.Linq`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:38:13.313

它不起作用，因为您在每个循环中明确选择第一个代理

```
AgentBaseEdit.SelectSingleNode("COREBASE/AGENT/...") 
```

* * *

但是您可以通过阅读和更改同一个 xml 文档来更轻松地完成此操作。我只是更改代理名称并将其替换为“test 1”、“test 2”、...

```
XDocument AgentBase = XDocument.Load("AgentBase.xml");
int i = 0;
foreach (XElement el in AgentBase.Descendants("AGENT")) {
    el.Element("AGENT_NAME").Value = "test " + ++i;
    // ...
}
AgentBase.Save("AgentBase.xml"); 
```

* * *

**更新**

但是，我建议您将涉及 XML 处理的逻辑与表单分开。首先创建一个代理类

```
public class Agent
{
    public string Index { get; set; }
    public string PorterIndex { get; set; }
    public string Name { get; set; }
    public string Surname { get; set; }
    public string Mobile { get; set; }
} 
```

然后创建一个接口，定义代理存储库所需的功能。这个接口的优点是它可以让以后更容易切换到另一种存储库，如关系数据库。

```
public interface IAgentRepository
{
    IList<Agent> LoadAgents();
    void Save(IEnumerable<Agent> agents);
} 
```

然后创建一个处理代理的类。这是一个建议：

```
public class AgentXmlRepository : IAgentRepository
{
    private string _xmlAgentsFile;

    public AgentXmlRepository(string xmlAgentsFile)
    {
        _xmlAgentsFile = xmlAgentsFile;
    }

    public IList<Agent> LoadAgents()
    {
        XDocument AgentBase = XDocument.Load(_xmlAgentsFile);
        var agents = new List<Agent>();
        foreach (XElement el in AgentBase.Descendants("AGENT")) {
            var agent = new Agent {
                Index = el.Element("AGENT_INDEX").Value,
                PorterIndex = el.Element("AGENT_PORTER_INDEX").Value,
                Name = el.Element("AGENT_NAME").Value,
                Surname = el.Element("AGENT_SURNAME").Value,
                Mobile = el.Element("AGENT_MOBILE_NUMBER").Value
            };
            agents.Add(agent);
        }
        return agents;
    }

    public void Save(IEnumerable<Agent> agents)
    {
        var xDocument = new XDocument(
            new XDeclaration("1.0", "utf-8", null),
            new XElement("COREBASE",
                agents.Select(a =>
                    new XElement("AGENT",
                        new XElement("AGENT_INDEX", a.Index),
                        new XElement("AGENT_PORTER_INDEX", a.PorterIndex),
                        new XElement("AGENT_NAME", a.Name),
                        new XElement("AGENT_SURNAME", a.Surname),
                        new XElement("AGENT_MOBILE_NUMBER", a.Mobile)
                    )
                )
            )
        );
        xDocument.Save(_xmlAgentsFile);
    }
} 
```

表单现在可以专注于编辑逻辑。如果您在表单构造函数中注入存储库，表单甚至不需要知道要使用哪种类型的存储库（因为表单构造函数必须声明 type 的参数`IAgentRepository`）：

```
var myAgentForm = new AgentForm(new AgentXmlRepository("AgentBase.xml"));
myAgentForm.Show(); 
```

* * *

**更新#2**

请注意，您不能更改 XML 文件中的单个项目。您必须加载所有代理，进行编辑然后重写整个文件，即使您只编辑了一个代理。

为此，您可以使用我的`LoadAgents`方法，然后从返回的列表中选择一个代理，编辑代理，最后使用我的方法将代理列表写回文件`Save`。您可以使用 LINQ 在列表中找到代理：

```
Agent a = agents
    .Where(a => a.Index == x)
    .FirstOrDefault(); 
```

`null`如果具有所需索引的代理不存在，则返回。由于`Agent`是引用类型，因此您不必将其写回列表。该列表保留对与变量相同的代理的引用`a`。

# iphone - 如何检测响应式设计的屏幕高度

> ID：14084524
> 
> 赞同：0
> 
> 时间：2012-12-29T18:10:22.117
> 
> 标签：iphone, css, responsive-design

我正在建立一个响应式设计的网站。

我有一定的CSS样式如下：

```
/* when viewport height less than 320px */
@media screen and (max-height: 319px) { /* TRIED FOR IPHONE -- CAN'T GET TO WORK YET */

    #footer {
        font-size: 65%;
        line-height: 110%;
        margin-top: 12px;
    }

} 
```

我在 iPhone 上以横向模式对其进行了测试，字体大小没有变为 65%，这 3 种样式中的任何一种都没有生效。这是检测 iPhone 屏幕高度尺寸的有效且正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:45:28.857

您可以尝试使用不同的媒体查询吗？

[http://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

```
@media
    only screen and (-webkit-min-device-pixel-ratio : 1.5),
    only screen and (min-device-pixel-ratio : 1.5) {
} 
```

我从来没有遇到过媒体查询的问题。通过在线 iPhone 模拟器在纵向和横向模式下测试您的网站后，字体大小设置为 65%：

[http://www.testiphone.com/](http://www.testiphone.com/)

但是，如果上面的媒体查询不起作用，您可以尝试更改视口吗？

```
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:38:32.423

**jQuery**

```
$(document).ready(function(){
   if($(document).width() <= 320){
      $("#footer").addClass("newclass")
   }
}) 
```

**CSS**

```
.newclass {
    font-size: 65%;
    line-height: 110%;
    margin-top: 12px;
} 
```

# java-me - 在 J2ME 应用程序中，是否可以将闹钟铃声设置为 MP3 铃声？

> ID：14084526
> 
> 赞同：1
> 
> 时间：2012-12-29T18:10:41.263
> 
> 标签：java-me, ringtone

在 J2ME 应用程序中，我想让用户自由设置自己喜欢的音调，尽管它是具有高比特率和大小的 .mp3 或 .wav 声音。可以在 J2ME 中使用`javax.microedition.media`包吗？

我尝试使用一个大小为 2.52MB 且比特率为 352kpbs 的 .wav 文件来执行此操作，但 Netbeans 向我显示了异常，即

```
java.lang.OutOfMemoryError
    at javax.microedition.lcdui.Display$DisplayAccessor.commandAction(Display.java:1996)
    at javax.microedition.lcdui.Display$DisplayManagerImpl.commandAction(Display.java:2825)
    at com.sun.midp.lcdui.DefaultEventHandler.commandEvent(DefaultEventHandler.java:303)
    at com.sun.midp.lcdui.AutomatedEventHandler.commandEvent(AutomatedEventHandler.java:670)
    at com.sun.midp.lcdui.DefaultEventHandler$QueuedEventHandler.handleVmEvent(+186)
    at com.sun.midp.lcdui.DefaultEventHandler$QueuedEventHandler.run(+57) 
```

那么有什么办法可以做到这一点，或者我必须限制用户使用应用程序提供的音调？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T15:32:03.080

您无法通过 JavaME 更改设备的铃声或闹钟铃声。

您可以制作一个播放自己的音调的应用程序。可以播放哪些格式取决于设备。它们可以有多大，取决于设备上可用的内存量。

如果您希望您的应用程序与大多数可能的设备兼容，您应该使用 MIDI 或 AMR 文件。据我所知，所有较新的设备也支持 mp3 和 wav 文件。

# core-data - NSManagedObjectContext 自动释放问题

> ID：14084534
> 
> 赞同：1
> 
> 时间：2012-12-29T18:12:05.380
> 
> 标签：core-data, nsmanagedobjectcontext, nszombie

我已经为此奋斗了很长时间。我对 Autorelease 的理解是，当它不再需要它时，它会释放它。

我得到了那些邪恶的 EXC_BAD_ACCESS 之一，没有任何细节。它只会崩溃：

```
 int main(int argc, char *argv[])
 {
     @autoreleasepool {
         return UIApplicationMain(argc, argv, nil, NSStringFromClass([Logix_AppDelegate      class]));
     }
 } 
```

启用 Zombies 后，我发现我正在循环写入 CoreData，这是我对 NSManagedObjectContext 的初始化

```
 NSManagedObjectContext *context = [[(MyAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext] autorelease]; 
```

这里有什么想法......有很多代码，所以我不想在这里粘贴大量的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:39:52.897

`autorelease`将一个对象添加到当前的自动释放池中。`release`当当前自动释放池被销毁时，该对象将收到一条消息（并可能被释放）。

*仅当您拥有*该对象时，发送`autorelease`到该对象才有意义。在您的情况下，该方法的名称中没有“new”、“alloc”或“copy”，因此您不拥有返回的对象，也不能调用它。*`managedObjectContext``autorelease`*

 *所以你应该用

```
NSManagedObjectContext *context = [(MyAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext]; 
```

另请参阅“高级内存管理编程指南”中的[内存管理策略：](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)

> **您拥有您创建的任何对象 您**
> 使用名称以“alloc”、“new”、“copy”或“mutableCopy”开头的方法创建对象（例如，alloc、newObject 或 mutableCopy）。...
> 
> **When you no longer need it, you must relinquish ownership of an object you own**
> You relinquish ownership of an object by sending it a `release` message or an `autorelease` message. ...
> 
> **You must not relinquish ownership of an object you do not own***

# jquery - 文本输入值不会回到 0

> ID：14084535
> 
> 赞同：0
> 
> 时间：2012-12-29T18:12:13.693
> 
> 标签：jquery

我在这里有一个 jsfiddle：http: [//jsfiddle.net/aND4g/2/](http://jsfiddle.net/aND4g/2/)我在显示文本输入值时遇到问题。

应该发生的是，如果 Option 是`True or False`or `Yes or No`，则 Number of Answers 文本输入应始终包含值 1（始终，此值不能更改）；如果用户随后从`True or False`或`Yes or No`选项更改为编号选项之一，则文本输入应返回 0。

如果用户将`True or False`or`Yes or No`选项附加到表格行中，但问题是没有打开 、 或 或 的任何答案按钮，`True`然后将`False`选项更改为编号选项之一，而不是显示 0，它仍然是显示值 1。`Yes``No`

但是，如果用户确实打开了 、 或答案按钮之一`True`，然后`False`将选项从或更改为编号选项之一，那么它确实会将文本输入中的值从 更改为。`Yes``No``True or False``Yes or No``1``0`

为什么要这样做，如何解决它，以便每次选择编号选项时，它总是会出现`0`在文本输入中？

我相信问题出在下面但不确定：

```
$(this).closest('.option').siblings('.answer').find('.answers').each(function(index) {
    if (!isNaN(clickedNumber) && index < clickedNumber) {
      $(this).show();
      if (prevButton === 'True or False' || prevButton === 'Yes or No') {
        // show as blank
        $(this).closest('.option').siblings('.numberAnswer').find('.answertxt').val(0).show();
      } else {
        // show but don't change the value
        $(this).closest('.option').siblings('.numberAnswer').find('.answertxt').show();
      }
    } else {
      $(this).hide();
      $(this).removeClass('answerBtnsOn');
      $(this).addClass('answerBtnsOff');
    }
    ....

    function btnclick(btn, iQuestionIndex, bDisableAppend) {
      //var context = $(btn).parent();
      var context = $(btn).parents('tr'); // need to go up one level
      context.add(context.siblings()); // to collect siblings in other rows since the limit in each row is 7
      if (context.length == 0) {
        context = $(btn).parents('tr');
      }
      var $btn = $(btn);
      var value = btn.value;
      var id = $btn.attr('id');
      ....
      updateAnswer(context , iQuestionIndex, bDisableAppend);
      var container = $btn.closest(".optionAndAnswer");
      // here the zero gets assigned
      var answertxt = $(".answertxt", container);
      var numberison = $(".answerBtnsOn", container).length;
      var maxRowValue = $('.gridTxt', container).val();
      if (btn.id == "answerTrueRow" || btn.id == "answerFalseRow")
        return;
      if (maxRowValue === 'True or False' || maxRowValue === 'Yes or No') {
        if (answertxt.val() == 1 && numberison == 0) {
          numberison = 1;
        }
      }
      answertxt.val(numberison);
      return false;
    } 
```

更新：

小提琴只是主应用程序的完整缩短版本。对于附加的每一行，它都算作一个问题，因此第 1 行是问题 1，第 2 行是问题 2，依此类推。在小提琴中，您在顶部选择一个选项类型、答案数量和正确答案，然后将其附加到一行中。如果您想进行更改，您可以在附加行中编辑选项类型、答案数量和正确答案。这就是为什么它被设置为它被设置的方式。

JSFIDDLE 要遵循的步骤：

`True or False`如果上一个选项是或`Yes or No`但没有打开应答按钮，查看会发生什么的步骤：

1.  打开应用程序时，单击`Open Grid`链接并选择按钮`True or False`或`Yes or No`从网格中选择。然后单击`Add Question`按钮，这将在您选择的内容下方附加一行。

2.  您可以在附加行的文本输入中看到 Number of answers 的值为 1，这很好。但是在附加的行中单击`Open Grid`并选择 3 或 4 的数字选项。答案数的文本输入不会像应有的那样更改为 0，它仍然显示 1。

`True or False`如果上一个选项是或`Yes or No`打开了应答按钮，则查看会发生什么的步骤：

1.  从上面重复步骤 1。

2.  重复上面的步骤 2，但在单击`Open Grid`更改选项之前，请选择或/或`Answer`行底部的按钮（取决于您选择的选项），然后将选项更改为数字选项。您会看到该值确实从 1 变为 0。`True``False``Yes``No`

更新：

我的旧代码在这里有一个工作小提琴：http: [//jsfiddle.net/aND4g/50/](http://jsfiddle.net/aND4g/50/)

这是最新的 jsfiddle，它不太工作：http: [//jsfiddle.net/aND4g/53/](http://jsfiddle.net/aND4g/53/)

我发现小提琴和停止它工作的唯一区别是下面的代码：

```
var $tbody = $('#qandatbl_onthefly > tbody');
var $tr = $("<tr class='optionAndAnswer' align='center'>");
var $td = $("<td width='50%' class='extratd'>");
var $options = $("<table class='option'><tbody><tr><td>1\. Option Type:</td></tr></tbody></table>");
var $noofanswers = $("<br /><table class='noofanswers'><tbody><tr><td>2\. Number of Answers:</td></tr></tbody></table>");
var $answer = $("<br /><table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody></table>");
var $questionType = ''; 
```

工作版本包含以下代码：

```
var $tbody = $('#qandatbl_onthefly > tbody');
var $tr = $("<tr class='optionAndAnswer' align='center'>");
var $td = $("<td class='extratd'>");
var $noofanswers = $("<div class='noofanswers'>2\. Number of Answers:<br/></div>");
var $options = $("<div class='option'>1\. Option Type:<br/></div>");
var $answer = $("<div class='answer'>3\. Answer:<br/></div>");
var $questionType = ''; 
```

如果我将`$options`,`$noofanswers`和`$answer`变量从`<table>`标签更改为`<div>`标签，那么它可以工作。但我希望将变量放在`<table>`标签而不是`<div>`标签中。`<table>`那么为什么它在标签中不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:56:22.187

发现问题：jsFiddle：http: [//jsfiddle.net/NhaCN/](http://jsfiddle.net/NhaCN/)

```
var $tbody = $('#qandatbl_onthefly > tbody');
var $tr = $("<tr class='optionAndAnswer' align='center'>");
var $td = $("<td width='50%' class='extratd'>");
var $options = $("<table class='option'><tbody><tr><td>1\. Option Type:</td></tr></tbody></table>");
var $noofanswers = $("<br /><table class='noofanswers'><tbody><tr><td>2\. Number of Answers:</td></tr></tbody></table>");
var $answer = $("<br /><table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody></table>");
var $questionType = ''; 
```

您正在创建一个带有两个标签 a`br`和 a的 jquery 元素`table`。因此，您附加到元素的任何内容都将添加到两个标签中。

**工作代码**

```
var $tbody = $('#qandatbl_onthefly > tbody');
var $tr = $("<tr class='optionAndAnswer' align='center'>");
var $td = $("<td width='50%' class='extratd'>");
var $options = $("<table class='option'><tbody><tr><td>1\. Option Type:</td></tr></tbody></table>");
var $noofanswers = $("<table class='noofanswers'><tbody><tr><td>2\. Number of Answers:</td></tr></tbody></table>");
var $answer = $("<table class='answer'><tbody><tr><td>3\. Answer:</td></tr></tbody></table>");
var $questionType = ''; 
```

如果您需要在元素之间换行，请在此处添加：

```
$tr.append($td);
$td.append($options);
$td.append("<br/>");
$td.append($noofanswers);
$td.append("<br/>");
$td.append($answer);
$tbody.append($tr); 
```

# html - HTML+CSS：如何为图像添加阴影（作为图像）？

> ID：14084542
> 
> 赞同：3
> 
> 时间：2012-12-29T18:13:10.307
> 
> 标签：html, css, image, position, shadow

我正在尝试为我的画廊中的每张图片添加一个阴影。我知道我可以为每个元素添加 CSS 阴影，但我试图在照片下添加的阴影是从 PSD 布局中获取的，并且具有与 CSS 阴影不同的形状。

这是示例，我想要实现的目标： ![在此处输入图像描述](../Images/f36ffccbcf5c488f9627b4b8ec84dc7a.png)

直到现在我所做的：

```
 <div style="padding-left: 15px; position:absolute;">
        <img src="avatar.png" alt="" />
        <img src="shadow.png" alt="" style="margin: 190px 0 0 -191px; width: 187px;" />
      </div> 
```

这是一个糟糕的解决方案，甚至更多，它只在 Chrome 中对我有用。你们能帮我吗，如何在所有浏览器中更有效地执行它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T20:11:12.487

如果您的图像尺寸不规则，那么您正在寻找作为背景图像的 SVG。Adobe Illustrator ($$$) 或 Inkscape (免费) 可用于将形状异常的阴影创建为 SVG 文件。从那里开始，所有需要的就是这个 CSS：

```
.myImage {
    background: url(myShadow.svg) no-repeat;
    background-size: 100% 100%;
    padding: ? ? ? ?; // the values will have to depend on your bg image
} 
```

深入的解释可以在这里找到：http: [//designfestival.com/a-farewell-to-css3-gradients/](http://designfestival.com/a-farewell-to-css3-gradients/)

如果您的图像大小相同，或者您不关心调整大小时可能出现的任何颗粒感，那么将 PNG 作为背景也可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T18:23:47.917

您可以为阴影效果创建一个透明的 PNG，然后将其作为背景图像放在一个 div 中。然后，您可以将图像添加到该 div 中，并使用 css 定位。

这个解决方案适用于所有浏览器，即使是 IE6，如果你让它与透明 png 一起使用。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:19:52.637

这是因为，该特定浏览器不支持该功能。你可能会失踪`vendor-prefix`

> Opera 10.50（目前仅在 Windows 上可用）是第一个没有供应商前缀的网络浏览器，而 Firefox、Safari 和 Google Chrome 目前都需要它。所以，这段代码使它可以在所有这些网络浏览器中工作

```
.shadow {
    -moz-box-shadow: 3px 3px 4px #000; 
    -webkit-box-shadow: 3px 3px 4px #000; 
    box-shadow: 3px 3px 4px #000;
} 
```

此外，您可以参考这些链接

[为所有 Web 浏览器使用 CSS 投影](http://robertnyman.com/2010/03/16/drop-shadow-with-css-for-all-web-browsers/)

[盒子阴影](http://www.css3.info/preview/box-shadow/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-21T18:53:29.057

这是一个更通用的解决方案，但可能对其他人有用。`<head>`我在 HTML 部分添加了以下内容：

```
<style>
img {{box-shadow: 5px 5px 5px #888888; }}
</style> 
```

它非常适合为所有图像添加阴影。

# c++ - 蒙特卡洛（可能模拟退火？）单位球体上 N 个相互排斥点的方法 C++

> ID：14084545
> 
> 赞同：1
> 
> 时间：2012-12-29T18:13:40.050
> 
> 标签：c++, macos, montecarlo, simulated-annealing

我需要在 C++ 中创建一个算法，以使用蒙特卡洛方法模拟球体上的相互排斥点。到目前为止，我所拥有的是：

```
#include <stdio.h> 
#include <string.h>
#include <math.h>
#include <iostream>
#include <iomanip>
#include <fstream>
#include <time.h>
#include <stdlib.h>
using namespace std;

int main()
{

  int a,f,g,n,m,i,j,k,r,s;
  double p,q,Energy,energy,y[101][4],x[101][4],Length,Distance;

 clock_t t1,t2;
  t1=clock();

  /*  set the number of points */
  n=12;

  /* check that there are no more than 100 points */
  if(n>100){
    cout << n << " is too many points for me :-( \n";
    exit(0);
  }

  /* reset the random number generator */
  srand((unsigned)time(0));  

  for (i=1;i<=n;i++){
    x[i][1]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
    x[i][2]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
    x[i][3]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;

    Length=sqrt(pow(x[i][1],2)+pow(x[i][2],2)+pow(x[i][3],2));

    for (k=1;k<=3;k++){
      x[i][k]=x[i][k]/Length;
    }
  }

  /* calculate the energy */
  Energy=0.0;

  for(i=1;i<=n;i++){
    for(j=i+1;j<=n;j++){
      Distance=sqrt(pow(x[i][1]-x[j][1],2)+pow(x[i][2]-x[j][2],2)
                    +pow(x[i][3]-x[j][3],2));

      Energy=Energy+1.0/Distance;
    }
  }

  /* Save Original Points */
  for(i=1;i<=n;i++){
    y[i][1]=x[i][1];
    y[i][2]=x[i][2];
    y[i][3]=x[i][3];
  }

  /* Loop for random points m times*/
  m=10;

  if (m>100){
    cout << "The m="<< m << " loop is inefficient...lessen m \n";
    exit(0);
  }

  a=1;

  while(a<m){

    /* assign random points */
    for (i=1;i<=n;i++){
      x[i][1]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
      x[i][2]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
      x[i][3]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;

      Length=sqrt(pow(x[i][1],2)+pow(x[i][2],2)+pow(x[i][3],2));

      for (k=1;k<=3;k++){
        x[i][k]=x[i][k]/Length;
      }
    }

    /* calculate the energy */
    energy=0.0;

    for(i=1;i<=n;i++){
      for(j=i+1;j<=n;j++){
        Distance=sqrt(pow(x[i][1]-x[j][1],2)+pow(x[i][2]-x[j][2],2)
                      +pow(x[i][3]-x[j][3],2));

        energy=energy+1.0/Distance;
      }
    }

    if(energy<Energy)
      for(i=1;i<=n;i++){
        for(j=1;j<=3;j++){
          Energy=energy;
          y[i][j]=x[i][j];
        }
      }
    else
      for(i=1;i<=n;i++){
        for(j=1;j<=3;j++){
          energy=Energy;
          x[i][j]=y[i][j];
        }
      }

    a=a+1;
  }

  /* Output the best random energy */
  cout << "Energy=" << Energy << "\n";

  m=10;
  a=1;

  while(a<m){
    /* Choose random point to move */
    g=(rand() % n)+1;

    /* Choose a p small to give q in a range -p <= q <= p */
    p=0.1;

    /* q is how much I am moving the random point by */
    q=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0*p;

    /* Move the point by q */
    for(j=1;j<=3;j++){
      x[g][j]=((x[g][j])+q);
    }

    /* Bring it back onto sphere */
    Length=sqrt(pow(x[g][1],2)+pow(x[g][2],2)+pow(x[g][3],2));

    for (k=1;k<=3;k++){
      x[g][k]=x[g][k]/Length;
    }

    /* Calculate the new energy */
    energy=0.0;

    for(i=1;i<=n;i++){
      for(j=i+1;j<=n;j++){
        Distance=sqrt(pow(x[i][1]-x[j][1],2)+pow(x[i][2]-x[j][2],2)
                         +pow(x[i][3]-x[j][3],2));

        energy=energy+1.0/Distance;
      }
    }

    /* Choose best energy and therefore best point */
    if (energy<Energy)
      Energy=energy,x[g][1]=y[g][1],x[g][2]=y[g][2],x[g][3]=y[g][3];
    else
      energy=Energy,y[g][1]=x[g][1],y[g][2]=x[g][2],y[g][3]=x[g][3];

    a=a+1;  

  }

   /* Output the best single shift energy */
  cout << "Energy=" << Energy << "\n";

  /* Set fail count to 0 */
  s=0;
  f=0;
  r=1;
  **p=0.1;**

  /* Maximum distance to move the random point */

  while (**p>0.00001**) {

    /* Number of loops to do */

    while (**r<3000**) {

      g=(rand() % n)+1;

      /* q is how much I am moving the random point by -p<=q<=p*/
      q=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0*p;

      /* Move the point by q */
      for(j=1;j<=3;j++){
        x[g][j]=((x[g][j])+q);
      }

      /* Bring it back onto sphere */
      Length=sqrt(pow(x[g][1],2)+pow(x[g][2],2)+pow(x[g][3],2));

      for (k=1;k<=3;k++){
        x[g][k]=x[g][k]/Length;
      }

      /* Calculate the new energy */
      energy=0.0;

      for(i=1;i<=n;i++){
        for(j=i+1;j<=n;j++){
          Distance=sqrt(pow(y[i][1]-y[j][1],2)+pow(y[i][2]-y[j][2],2)
                        +pow(y[i][3]-y[j][3],2));
          energy=energy+1.0/Distance;
        }
      }

      /* Choose best energy and therefore best point */
      if (energy<Energy)
        Energy=energy,x[g][1]=y[g][1],x[g][2]=y[g][2],x[g][3]=y[g][3],s=s+1;
      else
        energy=Energy,y[g][1]=x[g][1],y[g][2]=x[g][2],y[g][3]=x[g][3],f=f+1;

      r=r+1;

    }

    **/* Calculate percentage fails */

    if ((100.0*(f/r))>50.0)
      p=(p-0.00001);
    else
      p=p;**

    r=0;  

  }

  cout << "Overall Success Rate = " << ((s*1.0)/((s+f)*1.0))*100 << "%" << "\n";
  cout << "Energy=" << fixed << setprecision(10) << Energy << "\n";

  ofstream Bestpointssofar ("Bestpointssofar");
  for(i=1;i<=n;i++){
    Bestpointssofar << y[i][1] << " " <<   y[i][2] << " " << y[i][3] << "\n";
  }
  Bestpointssofar.close(); 

  t2=clock();
    float diff ((float)t2-(float)t1);
    float seconds = diff / CLOCKS_PER_SEC;
    cout << fixed << setprecision(2) << "Run time: " << seconds << "(s)" << "\n";
    return 0;

} 
```

我认为这没问题（注意我本质上是在尝试最小化能量函数），但我想让它更准确/让它运行得更快。为此，我认为我应该更改 p 的值、while 循环条件或如何在代码末尾更改 p。（所有这些都在 * *... **中，因为我试图让他们更大胆地让你清楚我的意思。大约是代码的 3/4）。我已经坐了几个小时试图改变这些条件，但没有任何效果。对于 n=12（球体上的 12 个点），我的能量应该在 49.16525306 处出现，但我只能在 50.5 和 54.0 之间得到它。我知道这相对较好，但我希望它更准确（即使确实需要一段时间）。如果可能的话，我还希望提高成功率（我的整体成功率绝对令人震惊）。

如果有人有任何想法，我将非常感谢您的帮助！

谢谢。

（注意：如果你想运行代码，你必须把双 * 去掉。有四个部分用双 * 包围它们）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T02:14:44.720

**首先**，你看起来像一个聪明的科学家/数学家，正在尝试做一些编程。我是一名物理学家，根据我的经验，这些人是一些最糟糕的程序员；如果可能的话，请从经验丰富的编码人员那里获得一些帮助。

**其次**，看这段代码（重复，见**First**）：

```
/* Move the point by q */
for(j=1;j<=3;j++){
  x[g][j]=((x[g][j])+q);
} 
```

您将*所有三个坐标都修改了相同的量*，这意味着您始终沿 (1,1,1) 射线移动一个点。如果一次修改一个坐标，结果会得到改善。

**第三**，在最后一个循环中（这是花费大部分时间的循环），您的逻辑有点混乱——您修改*x*，然后使用*y*计算能量。结果仍然相当不错，因为在循环结束时您还对 x 和 y 进行了转置，但纠正这一点可以提高结果的准确性。

**第四，这是一个大问题，**当你扰动一个点然后重新计算能量时，你重新计算所有点的贡献；只有一个点发生了变化，这意味着大部分点对没有变化，不需要重新计算。相反，在您选择一个点后，您可以使用以下方式计算该点的贡献：

```
double oldEnergy = 0.0;
  for(i=1;i<=n;i++)
    {
      if(i!=g)
        {
          Distance=myDistance(x[i], x[g]);
          oldEnergy += 1.0/Distance;
        }
    } 
```

然后在扰动后再次计算，并进行比较。这将计算从 O(n ² ) 变为 O(n)，这使其速度更快。

当我进行这些修改（并使 p 收敛快 10 倍，因为我不是很有耐心）**时，我的能量在 49.1652530576 处出现。**

# c++ - C++ 使用 GetEnvironmentVariable() 的完整路径写入文件错误

> ID：14084546
> 
> 赞同：0
> 
> 时间：2012-12-29T18:13:39.963
> 
> 标签：c++, compiler-errors, environment-variables

我是 C++ 的菜鸟，但想学习。`\etc\hosts`我有一个小程序，可以在 Windows 中将一些信息写入我的；我通过 获取`%WINDIR%`变量`GetEnvironmentVariable()`，如果我手动输入完整路径一切正常，但是当我用`WINDIR`变量替换时，我的代码没有编译。我知道我做的不对。

```
#include <windows.h>
#include <ios>
#include <fstream>

char buffer[1000];
int main() {
    GetEnvironmentVariable("WINDIR",(char*)&buffer,sizeof(buffer));
    std::ofstream log;
    log.open("%s\\system32\\drivers\\etc\\hosts", buffer);
    log << "127.0.0.1   domain.com\n" << std::endl;
    return 0;
} 
```

我得到了非常丑陋的错误，例如：

> C:\Documents and Settings\xtmtrx\Desktop\coding\windir.cpp 没有匹配函数调用 ` `std::basic_ofstream<char, std::char_traits<char> >::open(const char[30], char[1000])`'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:25:28.603

`ofstream`无法为您格式化路径。您需要单独执行此操作，例如：

```
#include <windows.h>
#include <ios>
#include <fstream>

char buffer[1000] = {0};
int main() {
    GetEnvironmentVariable("WINDIR",buffer,sizeof(buffer));
    strcat(buffer, "\\system32\\drivers\\etc\\hosts");
    std::ofstream log;
    log.open(buffer, ios_base::ate);
    log << "127.0.0.1   domain.com\n" << std::endl;
    return 0;
} 
```

仅供参考，您应该使用`GetWindowsDirectory()`,或代替. 并且您应该在将路径连接在一起时使用，这样可以确保斜线是正确的。`GetSystemDirectory()``SHGetSpecialFolderPath()``SHGetKnownFolderPath()``GetEnvironmentVariable()``PathCombine()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:20:49.843

您需要像这样将字符串连接在一起：

```
LPTSTR windir[MAX_PATH];
LPTSTR fullpath[MAX_PATH];
GetWindowsDirectory(windir, MAX_PATH);
if(PathCombine(fullpath, windir, _T("system32\\drivers\\etc\\hosts")) != NULL) {
    std::ofstream log;
    log.open(buffer, ios_base::ate);
    log << "127.0.0.1   domain.com\n" << std::endl;
} 
```

首先，您需要使用 PathCombine 连接目录和文件[部分](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773571.aspx)。然后您可以打开文件并写入内容。您还应该注意，您需要管理员权限才能更改此文件，并且某些防病毒程序可能会拒绝访问 hosts 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:23:04.970

`open("%s\\system32\\drivers\\etc\\hosts", buffer);` open 不理解格式字符串..您使用`%s`的没有意义。[在这里](http://forums.debian.net/viewtopic.php?f=8&t=51509)学习

试试这样：

```
GetEnvironmentVariable("WINDIR",buffer,sizeof(buffer));
strcat(buffer, "\\system32\\drivers\\etc\\hosts");
std::ofstream log;
log.open(buffer.str().c_str(), ios_base::ate); 
```

# jquery - 使用 onclick 处理悬停图像的最佳方法？

> ID：14084548
> 
> 赞同：0
> 
> 时间：2012-12-29T18:13:56.607
> 
> 标签：jquery, html, css

我需要一个显示图像的按钮，并在悬停时显示另一个图像。这可以通过 link(a) 和带有 class/onmouseover/onmouseout 事件的常规元素来完成。仅在重定向到 URL 时才使用链接，因此如果我需要使用 OnClick（用于调用函数），我应该使用带有 onmouse 事件的常规元素，对吗？

问题是，当 ajax 调用是沙丘时，我需要更改两个按钮的类/onmouseover/onmouseout，这将是很多 jquery 代码。

那么如何尽可能简单地解决这个问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:18:30.507

你也可以用`a`tag for `onclick`，只给属性`"javascript:void(0)"`，`href`改变类不会是很多jquery代码，它只是几行代码。

```
$("#elementid").attr("class","newclass")
$("#elementid").attr("onmouseover","newvalue")
$("#elementid").attr("onmouseout","newvalue") 
```

**CSS 方式**

HTML：

```
<a href="javascript:void(0)" onclick="function()" id="idAnchor"></a> 
```

CSS：

```
a#idAnchor{
display:block;
width:50px; /*width of your image*/
height:50px; /*height of your image*/
background:url("imagepath");
}

a#idAnchor:hover{
background:url("newimagepath");
} 
```

[在这里演示](http://jsfiddle.net/2QS3M/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T20:00:43.147

我不太确定 AJAX 如何改变任何东西。您是否通过 AJAX 动态生成新按钮？你能告诉我们代码吗？

使用 jQuery 的 AJAX 函数应该不是什么大问题。

```
$.ajax({  type: "POST",  url: "some.php",
data: { name: "John", location: "Boston" }
}).done(function( msg ) {
    // change your button classes here
    $(".button1").addClass("class1");
    $(".button1").removeClass("class2");
}); 
```

如果您只是更改图像，请使用 :hover CSS 伪类。这比通过鼠标悬停事件快得多。

# php - 单选按钮组，更改事件？

> ID：14084549
> 
> 赞同：0
> 
> 时间：2012-12-29T18:13:58.553
> 
> 标签：php, events, cakephp, radio-button

我有一组由 cakephp 生成的单选按钮。

```
<input type="radio" name="data[hexInput]" id="HexInput1" value="h1">
<input type="radio" name="data[hexInput]" id="HexInput2" value="h2">
<input type="radio" name="data[hexInput]" id="HexInput3" value="h3"> 
```

有没有办法检查组中的一个单选按钮是否被选中？通过更改事件或其他什么？

我知道如何使用特定按钮而不是组来执行此操作。对于一个特定的按钮，我使用这个 Js 助手：

```
$this->Js->get('HexInput2')->event('change', $this->Js->request(array(
            'controller' => 'designer',
            'action' => 'test',
                ), array(
            'update' => '#resultDiv',
            'async' => true,
            'method' => 'post',
            'dataExpression' => true,
            'data' => $this->Js->serializeForm(array(
                'isForm' => false,
                'inline' => true
            )) 
       ))
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:27:12.873

只需为每个单选按钮创建一个 onclick。你可以这样做：

```
function update(val) {
    alert("Radio button changed to " + val);
} 
```

然后将其与每个输入绑定，如下所示：

```
<input onclick="update(this.value);" type="radio" name="data[hexInput]" id="HexInput1" value="h1">
<input onclick="update(this.value);" type="radio" name="data[hexInput]" id="HexInput2" value="h2">
<input onclick="update(this.value);" type="radio" name="data[hexInput]" id="HexInput3" value="h3"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:43:24.707

我认为您正在寻找类似 [http://www.java2s.com/Code/JavaScript/Form-Control/FindingtheSelectedButtoninaRadioGroup.htm](http://www.java2s.com/Code/JavaScript/Form-Control/FindingtheSelectedButtoninaRadioGroup.htm)

# asp.net - 将 SQL 和 ASP 代码放在脚本上，而不是放在我的网页上

> ID：14084550
> 
> 赞同：0
> 
> 时间：2012-12-29T18:14:00.807
> 
> 标签：asp.net, html, sql, vb.net, scripting

我正在设计一个网站并尝试一些新概念。我不只是将所有内容编码到网页上，而是使用数据库填充页面的不同区域。例如在新闻页面上，我有一个下拉菜单来选择故事，然后我在页面的不同区域拉入标题、故事、图片和日期，这些都存储在数据库中。一切正常。我唯一想做的就是稍微清理一下代码。我希望所有连接字符串和选择语句都存储在脚本或其他东西的方法中。最好在 HTML 页面上，而不是在 aspx 页面上。

我有相当多的基本 HTML 知识，以及一些使用 Visual Basic.net 和 SQL 编程的经验。我正在使用 Visual Studio 2012，将所有这些都放在 ASPX 页面上。

这是我所写和工作的一个例子。这将根据“NewsDropDown”下拉列表中选择的值显示故事的标题。

```
 <%--  displays the headline  --%>
   <asp:FormView ID="NewsHeadlineText" runat="server" 
      DataSourceID="NewsHeadline" class="hdr" 
      meta:resourcekey="NewsHeadlineTextResource1" >
      <ItemTemplate>
          &nbsp;<asp:Label ID="HeadlineLabel" runat="server" 
              Text='<%# Bind("Headline") %>' meta:resourcekey="HeadlineLabelResource1" />
          <br />
      </ItemTemplate>
  </asp:FormView>

  <asp:SqlDataSource ID="NewsHeadline" runat="server" 
      ConnectionString="<%$ ConnectionStrings:VBallTalksDBConnectionString %>" 
      ProviderName="<%$ ConnectionStrings:VBallTalksDBConnectionString.ProviderName %>" 
      SelectCommand="SELECT [Headline] FROM [News] WHERE ([Headline] = ?)">
      <SelectParameters>
          <asp:ControlParameter ControlID="NewsDropDown" Name="Headline" 
              PropertyName="SelectedValue" Type="String" />
      </SelectParameters>
  </asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-29T18:18:44.917

您可以使用 jQuery 的 AJAX 或常规 AJAX 来查询您在 ASP 中触及数据库的脚本并以 JSON 格式返回处理结果。这样，当它返回时，您可以继续以您选择的编程语言填充您网站的各个部分。在使用 AJAX/Javascript 和 HTML5/CSS3 的 PHP 和 MySQL 中，我过去已经取得了很大的成功，如果你决定在 JSFiddle (http://jsfiddle.net/) 或 JSBin 中有静态模型，请告诉我使用 Javascript 来满足您的需求

# php - .htaccess url 友好重写问题：文件和文件夹名称相同时出错

> ID：14084559
> 
> 赞同：1
> 
> 时间：2012-12-29T18:15:04.507
> 
> 标签：php, .htaccess

我有一个网站，我正在尝试使用 .htaccess 文件实现对 SEO 友好的重写

我的网站具有以下文件夹结构：

```
- root/
    - corporativo/
        - [more stuff...]
    - social/
        - [more stuff...]
    - index.php
    - corporativo.php
    - social.php 
```

index.php 处理我所有的网站功能和路由。我正在使用 GET 变量 'cuerpo' 来确定部分，例如，对于我使用 index.php?cuerpo=social 的社交部分。

我发现的问题之一是 social dir 和 social.php 与名称和重写条件冲突。

请提出处理这种情况的正确方法。

非常感谢你！最好的祝福！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:23:58.180

确保您在 .htaccess 文件中使用了正确的标志：

```
RewriteCond %{REQUEST_FILENAME} !-f [NC] #Not a file
RewriteCond %{REQUEST_FILENAME} !-d [NC] #Not a dir 
```

*编辑：* Lix 提出了一个很好的观点——如果你在 Unix、Linux 等上，你可能不想使用 [NC]，但是，如果你在 Windows 中，例如，你会想要使用 [NC]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:24:52.260

在`.htaccess`文件中，在重写规则之前，可以使用这两个条件 -

```
RewriteCond %{REQUEST_FILENAME} !-f  # Not an actual file
RewriteCond %{REQUEST_FILENAME} !-d  # Not an actual directory 
```

他们规定只有在请求的文件名或文件夹不存在时才适用以下规则。使用它是为了让浏览器仍然能够访问资源而无需路由它们。

[我不是 100% 确定这是你的问题。更有可能是您在`index.php`.]

# android - android中的noSuchMethod错误

> ID：14084561
> 
> 赞同：0
> 
> 时间：2012-12-29T18:15:26.783
> 
> 标签：android, runtime-error, nosuchmethoderror

我使用片段：

```
FragmentManager manager = getFragmentManager(); 
```

但我在日志猫中看到了这个错误：

```
12-30 21:14:05.500: E/AndroidRuntime(395): 
java.lang.NoSuchMethodError:my.com.daily.Sign_upActivity.getFragmentManager 
```

我的活动是：

```
public class sign_upActivity extends Activity implements AlertPositiveListener{

public String fonts="BZar.ttf";
private EditText fname,lname,birthdate,worktitle,company,username,pass,confpass,email,phone,phone1;
private Button signup;
private String gender;
private String education ,regiterDate,howIMF,expdate,active,picpath,deleted , expertise;
private RadioGroup radioGenderGroup;
private RadioButton radioGenderButton;
private Drawable error_indicator;
int position = 0;
int position1 = 0;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sign_up);

    OnClickListener listener = new OnClickListener() {          
        @Override
        public void onClick(View v) {

            FragmentManager manager = getFragmentManager();
            AlertDialogRadio alert = new AlertDialogRadio();
            Bundle b  = new Bundle();
            b.putInt("position", position);
            alert.setArguments(b);
            alert.show(manager, "alert_dialog_radio");

        }
    };      

    Button btn = (Button) findViewById(R.id.education_btn);
    btn.setOnClickListener(listener);
}

@Override
public void onPositiveClick(int position) {
    this.position = position;
    TextView tv1 = (TextView) findViewById(R.id.education_tv);
    tv1.setText(Education.code[this.position]); 
    education = Education.code[this.position];
} 
```

}

谁能告诉我是什么原因？

非常感谢。我的问题在模拟器中解决了，但它在手机中强制关闭！我使用 minSdkVersion="4"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:22:37.673

[FragmentManager](http://developer.android.com/reference/android/app/FragmentManager.html)仅来自 api 级别 11。我猜您正在部署在不支持此功能的旧设备上。

看[教程](http://developer.android.com/guide/components/fragments.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:23:02.147

您正在使用低于版本 11 的最低 API。片段是在 API 11 中添加的，但它们可以通过支持库直到 API 4 获得。但是有一些区别，例如您必须扩展 FragmentActivity 才能访问 FragmentManager：

```
public class sign_upActivity extends FragmentActivity ... 
```

另一个区别是您必须`getSupportFragmentManager()`在支持库中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:34:23.000

您使用的 api 小于 11。由于这些原因，您会遇到错误。FragmentManaget.getFragmentManger(); 在 Api 级别 11 之前不支持该方法。

也没有添加 getFragmentManager() 方法

### 兼容性库

# c# - 无法在 Monotouch 中正确使用通用版本的 EventHandler

> ID：14084569
> 
> 赞同：1
> 
> 时间：2012-12-29T18:16:26.843
> 
> 标签：c#, generics, event-handling, mono, xamarin.ios

这是代码行...非常简单且为大家所熟知...

```
public event EventHandler<TimeSpan> TimeExtended; 
```

在 Visual Studio 中（我的意思是在 Windows 上）它照常工作，但在 MonoTouch 中我不能使用 TimeSpan，因为它不能转换为 EventArgs，我只能使用派生自 EventArgs 的类型。如何在单声道中使用这个通用事件处理程序？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T18:36:06.747

它适用于 Visual Studio，因为您使用的是 .Net 4.5，其中类型约束已被删除。只需定义您自己的类继承自`EventArgs`. 如果您需要其他数据，请同时包含它。

```
public class TimeExtendedEventArgs : EventArgs
{
  public TimeSpan TimeExtended { get; set; }
  public Player Player { get; set; }
}

public event EventHandler<TimeExtendedEventArgs> TimeExtended; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:49:47.547

我做了这个事件处理程序，我猜它正在工作。

```
public delegate void GEventHandler<T>(object sender, T args); 
```

# objective-c - 在视图之间转换的正确方法，以便导航/标签栏的动画效果很好

> ID：14084571
> 
> 赞同：0
> 
> 时间：2012-12-29T18:16:29.170
> 
> 标签：objective-c, ios, uinavigationbar, pushviewcontroller

在我的应用程序中，我有不同颜色的导航栏。此外，我有一些以横向显示的图表，而我的应用程序的其余部分以纵向显示。在某些视图中，我隐藏了我的标签栏。

我在 viewDidLoad 和 viewWillAppear 中更改导航栏颜色。

我的问题是视图之间的过渡效果看起来很奇怪。在导航栏有不同颜色的地方，颜色变化太快，第一个屏幕发生变化。或者您可以看到标签栏被删除。

我究竟做错了什么 ？

这是我使用的一些典型代码。

```
CBViewController *nextController = [[CBViewController alloc] 
      initWithNibName:@"CBView" bundle:nil];
nextController.title = @"CB";   
nextController.hidesBottomBarWhenPushed = YES;
[self.navigationController pushViewController:nextController animated:YES]; 
```

我不是在寻找没有标准的效果，而是看起来并不奇怪的东西。

虽然，我已经看到了滑动效果，从第一个视图到第二个看起来不错。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-30T17:05:45.083

在您发表评论后，我仍然不确定您在寻找什么——我的 iTunes 中没有看到任何导航栏颜色变化（他们经常更新 iTunes，也许我们正在查看不同的版本）。无论如何，以下代码将导致导航栏在转换到新控制器时改变颜色。由于推送动画只有大约 0.3 秒，并且 NSTimer 被限制在大约 0.05 秒的分辨率，我做了六个步骤来从一种颜色到另一种颜色（从绿色到黄色）。

```
-(IBAction)pushWithColorChange:(id)sender {
    UIViewController *nextController = [self.storyboard instantiateViewControllerWithIdentifier:@"Yellow"];
    [self.navigationController pushViewController:nextController animated:YES];
    [NSTimer scheduledTimerWithTimeInterval:.05 target:self selector:@selector(changeColor:) userInfo:nil repeats:YES];
}

-(void)changeColor:(NSTimer *) timer {
    static float i=0.03;
    self.navigationController.navigationBar.tintColor = [UIColor colorWithHue:.34 - i saturation:.5 brightness:.7 alpha:1];
    i += 0.03;
    if (i > .18) {
        [timer invalidate];
    }
} 
```

# java - Java：计算对象中的实例

> ID：14084572
> 
> 赞同：0
> 
> 时间：2012-12-29T18:16:34.300
> 
> 标签：java, for-loop

我有代码：

```
int number;
for (Vartype var : dataset) {
    number++;
} 
```

此代码确实有效，但`var`从未使用过。这段代码怎么写才能让Java不抱怨未使用的变量？“数据集”是一个对象。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T18:18:03.010

Java 不会抱怨未使用的变量，而是您的 IDE。

无需循环遍历该 array/ 中的每个对象`Collection`，您只需使用其大小即可查看其中有多少元素。

```
// if dataset is an array:
int number = dataset.length;

// if dataset is a Collection:
int number = dataset.size(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T18:24:10.133

如果它是集合对象，则根据您的帖子的 for-each 将计算“数据集”中的成员数。您也可以为此使用 for 循环。或者简单地检查对象的大小，如果它是一个集合对象。

# haskell - Haskell 中的通用记忆

> ID：14084574
> 
> 赞同：1
> 
> 时间：2012-12-29T18:16:45.863
> 
> 标签：haskell, memoization

> **可能的重复：**
> [GHC Haskell 中的记忆何时自动？](https://stackoverflow.com/questions/3951012/when-is-memoization-automatic-in-ghc-haskell)

看起来 Haskell 默认不会记住所有函数 - 请注意，我是 Haskell 的新手，所以我可能错了，我可能对“通用记忆”非常天真。这个问题是要了解 Haskell 是否/为什么可以在语言级别上记忆任何功能（可能是一个愚蠢的问题），如果不能，挑战是什么？此外，是否还有其他默认情况下提供“通用记忆”的 FP 语言？

我对此很好奇，因为我最近尝试用 Python 编写这样一个“通用记忆器”，并意识到存在重大挑战：智能管理缓存就是其中之一。但是，在所有情况下都有效地从函数参数中制造密钥可能具有挑战性。在我的应用程序中，看起来手工制作特定于应用程序的缓存键更有效，但这并不总是那么容易。那时我开始怀疑 Haskell，以及 Haskell 是否有内部技巧可以有效地记忆任何函数参数。

只是想了解 memoization、FP 和 Haskell。

# ruby - 将表单字段值发送到参数散列 - rails

> ID：14084580
> 
> 赞同：0
> 
> 时间：2012-12-29T18:17:28.557
> 
> 标签：ruby, ruby-on-rails-3

我有一个部分，我在 layouts/application.html.erb 中调用以显示搜索表单。用户从两个选择字段中选择值；然后，应该按 Enter 以呈现带有搜索结果的视图。

以下是部分内容：

** _search.html.erb：

```
<form name="classic">
<select name="countries" size="1" onChange="updatecities(this.selectedIndex)" style="width: 150px">
<option selected>Select A Brand</option>
<option value="usa">Opel</option>
<option value="canada">Cheverolet</option>
<option value="uk">Scoda</option>
</select>

<select name="cities" size="1" style="width: 150px">
</select>

</form>

<script type="text/javascript">

var countrieslist=document.classic.countries
var citieslist=document.classic.cities

var cities=new Array()
cities[0]=""
cities[1]=["Vectra|vectravalue", "Corsa|corsavalue"]
cities[2]=["Optra|optravalue", "Lanos|lanosvalue"]
cities[3]=["Octavia|octaviavalue", "Fleshia|fleshiavalue"]

function updatecities(selectedcitygroup){
citieslist.options.length=0
if (selectedcitygroup>0){
for (i=0; i<cities[selectedcitygroup].length; i++)
citieslist.options[citieslist.options.length]=new Option(cities[selectedcitygroup][i].split("|")[0],         cities[selectedcitygroup][i].split("|")[1])
}
}

</script> 
```

javascript只是根据第一个选择下拉列表过滤第二个选择下拉列表。我需要做的是将在此表单中选择的值发送到参数哈希的 URL 中，以便我可以在控制器中对其进行操作并显示搜索结果。我可以使用link_to。

如何在 link_to 中包含表单字段中的选定值？

感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:25:31.207

序列化表单并将数据发送到服务器。选择的值作为散列值传递，其中键是选择标签的“id”。

# c# - 如果字段类型没有默认构造函数，如何使用 ValueResolver？

> ID：14084594
> 
> 赞同：5
> 
> 时间：2012-12-29T18:19:13.317
> 
> 标签：c#, .net, automapper

我有财产模型：

```
public class MyModel{
       public SelectList PropertyTypeList { get; set; }
} 
```

我有 ValueResolver

```
public class MyPropertyValueResolver : ValueResolver<ProductProperty, SelectList>
{
    protected override SelectList ResolveCore(ProductProperty source)
    {
        myList = .......;
        return new SelectList(myList, "Value", "Text");
    }
} 
```

然后我配置映射

```
 Mapper.CreateMap<Source, Destination>()
          .ForMember(s => s.PropertyTypeList, opt => opt.ResolveUsing<MyPropertyValueResolver>()); 
```

但它告诉我

```
Type 'System.Web.Mvc.SelectList' does not have a default constructor 
```

我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:37:14.740

您是否考虑过自动映射到一个简单的 Array，然后使用 Get-only 属性将其包装为 SelectList，而不是自动映射到 SelectList？

[这个答案](https://stackoverflow.com/a/2078865/169334)描述了这种方法。

此外，从同一个 SO 问题中，还有[ConstructedBy](http://automapper.codeplex.com/wikipage?title=Custom%20Value%20Resolvers)的想法，以及一种`MapFrom`直接使用的方法。

# c# - 将菜单栏和状态栏锁定为“始终在顶部”

> ID：14084597
> 
> 赞同：-1
> 
> 时间：2012-12-29T18:19:25.380
> 
> 标签：c#, scroll, statusbar, menubar

我有一个 Windows 窗体，其中包括顶部的一个菜单栏和底部的一个状态栏。窗口是可滚动的，但是当我滚动它时，可以说向下滚动，菜单栏保持向上，这样我就看不到它了，如果我向上滚动，状态栏也会发生同样的情况。有什么方法可以让它们始终可见，比如它们随屏幕滚动，或者像往常一样在顶部？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T18:35:20.820

要创建可滚动内容，请执行以下过程：

1.  添加新窗口
2.  添加 MenuStrip 和 StatusStrip
3.  添加**Panel** , 设置`AutoScroll`为`true`,`Dock`到`Fill`
4.  将所有控件附加到面板。

# java - Glassfish 部署时找不到 JNDI 数据源

> ID：14084606
> 
> 赞同：4
> 
> 时间：2012-12-29T18:20:38.063
> 
> 标签：java, jpa, datasource, java-ee-6, glassfish-3

我正在尝试`ear`在 glassfish 中部署一个，但它无法分解它并抱怨它找不到写在`persistence.xml`

在`persistence.xml`DataSource 中配置为`java:app/jdbc/mysqlDS`但它正在寻找`java:app/jdbc/mysqlDS__pm`. 这很奇怪。任何的想法？

**编辑**我创建了以下数据源

*   mysqlDS
*   mysqlDS__pm

**编辑结束**

这里有一些细节：

*   耳应用
*   使用行家
*   应用程序是从 eclipse 部署的

这里是`persistence.xml`

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
  xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="test_pu" transaction-type="JTA">
    <jta-data-source>java:app/jdbc/mysqlDS</jta-data-source>
    <!--
       tried with this too
       <jta-data-source>java:app/jdbc/mysqlDS__pm</jta-data-source>
    -->
  </persistence-unit>
</persistence> 
```

错误日志

```
INFO: SEC1115: Realm [certificate] of classtype [com.sun.enterprise.security.auth.realm.certificate.CertificateRealm] successfully created.
INFO: SEC1011: Security Service(s) Started Successfully
SEVERE: Exception while invoking class org.glassfish.persistence.jpa.JPADeployer prepare method
SEVERE: Exception while invoking class org.glassfish.javaee.full.deployment.EarDeployer prepare method
SEVERE: Exception while preparing the app
SEVERE: Invalid resource : { ResourceInfo : (jndiName=java:app/jdbc/mysqlDS__pm), (applicationName=repro-ear) }
org.glassfish.deployment.common.DeploymentException: Invalid resource : { ResourceInfo : (jndiName=java:app/jdbc/mysqlDS__pm), (applicationName=repro-ear) }
    at org.glassfish.javaee.full.deployment.EarDeployer.prepare(EarDeployer.java:166)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.prepareModule(ApplicationLifecycle.java:870)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:410)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:370)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1067)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:96)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1247)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1235)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:465)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:222)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:168)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:234)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.RuntimeException: Invalid resource : { ResourceInfo : (jndiName=java:app/jdbc/mysqlDS__pm), (applicationName=repro-ear) }
    at com.sun.enterprise.connectors.ConnectorRuntime.lookupDataSourceInDAS(ConnectorRuntime.java:539)
    at com.sun.enterprise.connectors.ConnectorRuntime.lookupPMResource(ConnectorRuntime.java:468)
    at org.glassfish.persistence.common.PersistenceHelper.lookupPMResource(PersistenceHelper.java:63)
    at org.glassfish.persistence.jpa.ProviderContainerContractInfoBase.lookupDataSource(ProviderContainerContractInfoBase.java:71)
    at org.glassfish.persistence.jpa.PersistenceUnitInfoImpl.<init>(PersistenceUnitInfoImpl.java:108)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.loadPU(PersistenceUnitLoader.java:154)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.<init>(PersistenceUnitLoader.java:119)
    at org.glassfish.persistence.jpa.JPADeployer$1.visitPUD(JPADeployer.java:213)
    at org.glassfish.persistence.jpa.JPADeployer$PersistenceUnitDescriptorIterator.iteratePUDs(JPADeployer.java:486)
    at org.glassfish.persistence.jpa.JPADeployer.createEMFs(JPADeployer.java:220)
    at org.glassfish.persistence.jpa.JPADeployer.prepare(JPADeployer.java:166)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.prepareModule(ApplicationLifecycle.java:870)
    at org.glassfish.javaee.full.deployment.EarDeployer.prepareBundle(EarDeployer.java:290)
    at org.glassfish.javaee.full.deployment.EarDeployer.access$200(EarDeployer.java:86)
    at org.glassfish.javaee.full.deployment.EarDeployer$1.doBundle(EarDeployer.java:141)
    at org.glassfish.javaee.full.deployment.EarDeployer$1.doBundle(EarDeployer.java:138)
    at org.glassfish.javaee.full.deployment.EarDeployer.doOnBundles(EarDeployer.java:215)
    at org.glassfish.javaee.full.deployment.EarDeployer.doOnAllTypedBundles(EarDeployer.java:224)
    at org.glassfish.javaee.full.deployment.EarDeployer.doOnAllBundles(EarDeployer.java:250)
    at org.glassfish.javaee.full.deployment.EarDeployer.prepare(EarDeployer.java:138)
    ... 29 more
Caused by: com.sun.appserv.connectors.internal.api.ConnectorRuntimeException: Invalid resource : { ResourceInfo : (jndiName=java:app/jdbc/mysqlDS__pm), (applicationName=repro-ear) }
    at com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl$MyDataSource.validateResource(ConnectorResourceAdminServiceImpl.java:272)
    at com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl$MyDataSource.setResourceInfo(ConnectorResourceAdminServiceImpl.java:253)
    at com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl.lookupDataSourceInDAS(ConnectorResourceAdminServiceImpl.java:243)
    at com.sun.enterprise.connectors.ConnectorRuntime.lookupDataSourceInDAS(ConnectorRuntime.java:537)
    ... 48 more 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T22:40:50.363

您需要修改`jta-data-source`persistence.xml 中的标签以匹配 dataSource JNDI 名称，不带前缀：

```
<jta-data-source>mysqlDS</jta-data-source> 
```

有用的链接：[Java EE 6 教程 - 持久性单元](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html#bnbrj)

# vb.net - 带有 Getter 但没有 Setter 的 VB.NET 接口属性

> ID：14084607
> 
> 赞同：0
> 
> 时间：2012-12-29T18:20:48.253
> 
> 标签：vb.net, .net-4.0, properties, interface, c#-to-vb.net

我想知道如何在 VB.NET 中创建具有只读属性的接口？

在 C# 中，我会执行以下操作：

```
interface ISomething {
    int PropNeeded { get; }
} 
```

但是当我尝试在 VB 中做同样的事情时

```
Interface ISomething
    Property PropNeeded() As Integer
        Get
        End Get
    End Property 
End Interface 
```

我从 Visual Studio 2010 收到此错误消息：*“语句不能出现在界面正文中。假定界面结束。* ”

这似乎是合乎逻辑的，因为这就像我试图为 Property 提供一个实现......但重要的是，Property 没有 Setter 只有一个 Getter。

您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:22:23.847

```
Readonly Property PropNeeded() As Integer 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T18:25:02.947

```
Interface ISomething
      ReadOnly Property PropNeeded() As Integer
End Interface 
```

作为旁注，您可以使用 C# 到 VB 在线代码转换器。[Telerik 代码转换器](http://converter.telerik.com/)

# c# - 需要音频分析库来从音频文件创建实时反馈？

> ID：14084609
> 
> 赞同：6
> 
> 时间：2012-12-29T18:20:51.977
> 
> 标签：c#, c++, audio, frequency-analysis, amplitude

不一定需要实时，但是我正在为我最后一年的项目创建一个游戏，我希望使用音频的力量来创建仅基于正在播放的音乐曲目的动态关卡。我的目标是使用 playstation mobile 和 C# 为 PS Vita 创建这个游戏，但如果我愿意，我可以切换到 C++ 和 PSP。

我可以使用 WAV 文件，并希望提取波形的幅度，并从这些数据中计算其他特征，例如平均频率和近似 BPM，以创建一个电平。

我对尝试使用这些原始数据没有任何疑虑，我只想知道一种方法，我可以首先实际获取这些信息。如果我可以提取样本并断言这些样本的不同特征，我可以存储它们并计算出响度、音高等的变化来创建音符等。

我正在使用 C#，但如果可能的话，我可以使用 p/invoke 或将我的项目切换到另一个使用 C++ 而不是 C# 的设备。

我在这里有点恐慌，因为我真的有点难过。

非常感谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:29:02.167

不幸的是，我认为您无法使用 C# 来执行此操作 - AFAIK，没有针对它的 JIT 编译器。我记得读过一些关于 Mono 的东西，它可以与 C# 一起使用，但我现在不确定。

那就是说-我会使用c ++。如果你这样做，你可以使用大量的音频分析库，比如 CLAM (http://clam-project.org/)。

不要惊慌（想象一下大而友好的信件。）一步一步地设想项目的必要部分，一个一个地解决，你很快就会完成。=)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T20:50:56.863

您在此处描述的问题是音乐/音频*特征提取*之一，并且存在大量您可以借鉴的学术工作。另一个有用的搜索艺术术语是*音乐信息检索 (MIR)*。

研究人员试图从录音中检索到的“特征”列表是庞大而多样的，从诸如音高和键等确定性事物到诸如“能量”之类的情感特征。

其中大多数结果比您想象的要困难，通常只有大约 60-70% 的准确率 - 尽管对于您的要求，这可能就足够了。

一个好的入口点可能是下载[Sonic Visualiser](http://www.sonicvisualiser.org)，其中存在大量特征提取插件，并且是开源的。你至少会感觉到什么是可能的。

更新：另一个有用的艺术术语是*起始检测*- 这通常用于描述节拍检测算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T21:56:38.753

[Aubio](http://aubio.org/)是一个 C/C++ 库，可以进行音高跟踪、起始检测和 bpm 跟踪等。

至于“提取波形的幅度”，波形*就是*幅度，即您可以每n个样本选择绝对值最大的音频样本，并使用该值来进行可视化的“幅度”部分。

[这里有一些代码](http://code.google.com/p/dot-net-wave-reader/source/browse/trunk/WaveReader/WaveReader/WaveReader.cs)可以帮助您开始在 C# 中读取 WAVE 数据。

[以下是有关为](http://www.sdss.jhu.edu/~tamas/bytes/fftwcsharp.html)[FFTW](http://www.fftw.org/)库编写 C# 包装器的一些信息。

# ruby-on-rails - 条纹：检索条纹费用的最后 4 位时未定义的方法“last4” - Rails

> ID：14084610
> 
> 赞同：0
> 
> 时间：2012-12-29T18:20:55.600
> 
> 标签：ruby-on-rails, stripe-payments

我的 rails 应用程序正在使用 Stripe 成功进行付款，但是在尝试从成功的收费中检索信用卡的最后 4 位数字时出现未定义的方法错误。

错误：

```
undefined method `last4' for #<Stripe::Charge:0x007ff2704febc8>

app/models/order.rb:33:in `stripe_retrieve'
app/controllers/orders_controller.rb:54:in `block in create'
app/controllers/orders_controller.rb:52:in `create' 
```

订单控制器.rb

```
def create
if current_user
  @order = current_user.orders.new(params[:order])
else
  @order = Order.new(params[:order])
end
respond_to do |format|
  if @order.save_with_payment
    @order.stripe_retrieve

    format.html { redirect_to auctions_path, :notice => 'Your payment of $1 has been successfully processed and your credit card has been linked to your account.' }
    format.json { render json: @order, status: :created, location: @order }
    format.js
  else
    format.html { render action: "new" }
    format.json { render json: @order.errors, status: :unprocessable_entity }
    format.js
  end
end
end 
```

订单.rb

```
def save_with_payment
if valid?
  customer = Stripe::Customer.create(description: email, card: stripe_card_token)
  self.stripe_customer_token = customer.id
  self.user.update_column(:customer_id, customer.id)
  save!

  Stripe::Charge.create(
      :amount => (total * 100).to_i, # in cents
      :currency => "usd",
      :customer => customer.id
  )
 end
rescue Stripe::InvalidRequestError => e
logger.error "Stripe error while creating customer: #{e.message}"
errors.add :base, "There was a problem with your credit card."
false
end

def stripe_retrieve
charge = Stripe::Charge.retrieve("ch_10U9oojbTJN535")
self.last_4_digits = charge.last4
self.user.update_column(:last_4_digits, charge.last4)
save!
end 
```

这是展示如何检索费用的 Stripe 文档，您可以看到“last4”是正确的，那么为什么它会以未定义的方法出现？

[https://stripe.com/docs/api?lang=ruby#retrieve_charge](https://stripe.com/docs/api?lang=ruby#retrieve_charge)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:27:39.827

响应将返回一张卡片，它本身有一个 last4。所以卡片是它自己的对象。

```
charge.card.last4 
```

这是文档：

```
#<Stripe::Charge id=ch_0ZHWhWO0DKQ9tX 0x00000a> JSON: {
  "card": {
    "type": "Visa",
    "address_line1_check": null,
    "address_city": null,
    "country": "US",
    "exp_month": 3,
    "address_zip": null,
    "exp_year": 2015,
    "address_state": null,
    "object": "card",
    "address_country": null,
    "cvc_check": "unchecked",
    "address_line1": null,
    "name": null,
    "last4": "1111", 
```

# wso2 - BAM 中介和中介统计之间的区别

> ID：14084611
> 
> 赞同：1
> 
> 时间：2012-12-29T18:20:58.447
> 
> 标签：wso2, wso2bam

为什么 ESB 有两种不同的数据代理，BAM 中介和中介统计？它们各自有什么不同和相似之处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:27:52.103

中介统计数据代理用于将 ESB 中中介的累积统计信息发送到 BAM。它定期向 BAM 发送事件。

但 BAM 中介不同。它可以定义为 ESB 中介序列中的任何位置作为中介。甚至多次。每个 BAM 中介可以通过定义的流独立地向 BAM 端发送事件。每次消息通过 BAM 中介时，BAM 中介也会发送事件。

# java - 它说 oracle.jdbc 不存在，无法导入

> ID：14084613
> 
> 赞同：-1
> 
> 时间：2012-12-29T18:21:07.170
> 
> 标签：java, oracle, jdbc

我想将我的 java 程序与 oracle 连接起来。JDK版本是1.7。并且，Oracle 也已安装并且 PATH 和 CLASSPATH 也已正确设置。现在，对于 jdbc，我输入： CLASSPATH

```
D:\app\Ratish\product\11.1.0\db_1\jdbc\lib\ojdbc6.jar 
```

我也尝试将 CLASSPATH 放在系统和用户变量下（在环境变量下）。但是，在 Eclipse 中，我看不到任何要导入 oracle.jdbc 的内容。jdbc 包不存在。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:14:42.477

在项目的构建路径中添加名为 ojdbc6.jar 的 jar，然后检查。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-29T18:23:45.770

javac -cp .;D:\app\Ratish\product\11.1.0\db_1\jdbc\lib\ojdbc6.jar ...

# objective-c - Objective-C 和 Bison 警告：流浪 `@'

> ID：14084614
> 
> 赞同：2
> 
> 时间：2012-12-29T18:21:10.013
> 
> 标签：objective-c, bison, yacc

当我使用 bison 生成解析器时，我收到以下警告：

```
warning: stray `@' 
```

但那是因为我有一些合法的 Objective-C 代码包含`@`，例如这是有警告的规则之一：

```
file : axiom production_rule_list    { NSLog(@"file"); }
     ; 
```

在代码中使用是否有任何风险`@`？如果不是，如何告诉野牛它是合法使用的`@`？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T20:36:51.140

该消息只是一个警告。你可以忽略它。如果您使用的是 Xcode，它甚至不会在问题导航器中向您显示警告。

重命名您的 Bison 输入文件以具有`.ym`扩展名而不是`.y`扩展名。这告诉 Xcode 这是一个带有 Objective-C 动作的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-21T01:26:02.590

如果要抑制警告，可以使用`#define AT @`.

大括号中的代码只是被复制，除了用代码替换 $… 序列以提供相关标记。这似乎适用于 Objective-C，但如果您使用 ARC，您可能需要进行一些挖掘（或只是添加额外的块（在 C 意义上））以确保尽快释放对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:37:17.097

根据[Actions - Bison 2.7](http://www.gnu.org/software/bison/manual/html_node/Actions.html)中的文档，花括号之间的代码似乎应该是 C 代码。因此，我怀疑您可以在那里使用objective-c 构造。

但是，您可以创建一个外部 C 函数来为您完成工作：

```
Logit(char* message)
{
  NSLog(@"%s",message);
} 
```

并在 Bison 动作中使用它

```
file : axiom production_rule_list    { Logit("file"); }
     ; 
```

# mysql - 使用 GROUP BY 更新相关的所有记录

> ID：14084618
> 
> 赞同：1
> 
> 时间：2012-12-29T18:21:42.007
> 
> 标签：mysql, sql, ruby-on-rails, join

我有 2 个表`word_lists`，`memo_words`word_list 有很多 memo_words (1 - n)。

```
TABLE: word_lists
+----+----------+----------------+
| id | name     | average_rating |
+----+----------+----------------+
| 1  | example1 |       ?        |
| 2  | example2 |       ?        |
| 3  | example3 |       ?        |
+----+----------+----------------+
ID is primary

TABLE: memo_words
+----+----------+-------+-------------------+
| id | name     | rating| word_list_id      |
+----+----------+-------+-------------------+
| 1  | random1  |  153  | 1                 |
| 2  | random2  |  158  | 1                 |
| 3  | random3  |  167  | 1                 |
+----+----------+-------+-------------------+
ID is primary 
```

我想为每个 word_lists 记录计算 word_lists.average_rating。平均评分 它是 memo_words.rating 中每个相关的 memo_words 记录的平均值。为了计算平均值，我可以简单地使用这样的东西：

```
 SELECT id, AVG(rating) from memo_words group_by word_list_id; 
```

但是我怎样才能更新 word_lists 记录呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:24:48.500

```
Update word_lists w inner join 
(select AVG(rating) rating,word_list_id from memo_words
 group by word_list_id) m on w.id=m.word_list_id
set w.average_rating=m.rating 
```

试试这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:31:00.870

这是 MySQL 的`UPDATE`语法`JOIN`：

```
UPDATE word_lists w
INNER JOIN
(
   SELECT 
     word_list_id,
     AVG(rating) averageRating
   FROM memo_words 
   GROUP BY word_list_id
) m ON w.Id = m.word_list_id
SET w.average_rating = m.averageRating; 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/2ce0f/1)

这将使您的表格`memo_words`看起来像：

```
| ID |     NAME | AVERAGE_RATING |
----------------------------------
|  1 | example1 |            159 |
|  2 | example2 |         (null) |
|  3 | example3 |         (null) | 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:32:11.510

最简单的方法是：

```
Update word_list
    set average_rating = (select AVG(mw.rating)
                          from memo_words mw
                          where mw.word_list_id = word_list.id
                         ) 
```

# android - 更改服务中可绘制的小部件 ImageButton

> ID：14084619
> 
> 赞同：2
> 
> 时间：2012-12-29T18:21:47.750
> 
> 标签：android

我的应用程序有一个小部件，它是一个简单的切换小部件，当我按下它时它会运行一项服务。该服务完成所有工作并启用 isRunning= true;

当 isRunning 为真时，我希望 ImageButton 具有 drawable_enabled.png

当我停止服务时（它可以通过小部件、应用程序或通知停止）它应该将它的 drawable 更改为 drawable_disabled.png

一切正常，但我不知道如何从服务中更改可绘制对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:53:46.237

您可以将 Intent 发送到您的小部件。`AppWidgetProvider`有`onReceive`方法，你应该覆盖它。

# java - 如何在 JRadioButtons 中使用图像而不是文本

> ID：14084620
> 
> 赞同：1
> 
> 时间：2012-12-29T18:22:02.210
> 
> 标签：java, swing, user-interface, imageicon, jradiobutton

我有一组`JRadioButtons`。我想在我的`JRadioButtons`. 所以我相信我将不得不使用这个：

```
JRadioButton(Icon icon, boolean selected) 
```

现在的问题是我不确定如何创建这个图标。我有想要使用的图像，并且已将图像复制到我的源代码文件夹中。它是 .tiff 格式。我想阅读那个 .tiff 图像（我相信 inputStream）并将其转换为图标，以便我可以拥有我的 JRadioButtons。

请帮助实施这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:35:57.967

假设您将图像放在源文件夹中，在 package`com.foo.bar`中，并且您的构建过程将此文件与您的类一起复制，以便在运行应用程序时它位于类路径中（这是所有 IDE 默认执行的操作），您可以使用

```
new ImageIcon(MyClass.class.getResource("/com/foo/bar/MyImage.png")) 
```

给你一个图标。

我不确定 Java 是否具有对 tiff 格式的本机支持，因此您可能必须将图像转换为另一种支持的格式才能加载它（gif、JPEG 和 PNG 都可以正常工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T20:05:40.440

如果您收到 NullPointerException，这可能意味着图像不在您指示的路径中。

您说您将它直接插入 src 文件夹，所以这应该可以工作：

```
new ImageIcon(getClass().getResource("icon.jpg")) 
```

# jsf - t:inputFileUpload 在提交表单时总是返回 null

> ID：14084626
> 
> 赞同：1
> 
> 时间：2012-12-29T18:23:02.603
> 
> 标签：jsf, file-upload, primefaces, myfaces, tomahawk

```
<h:body>
  <div id="main" align="center" style="width:100%;height: 100%">
    <f:view>
      <h:form id="catform" enctype="multipart/form-data">
        <p:panel styleClass="ui-panel-titlebar"  id="panel1" header="Add New Category" >
          <h:panelGrid columns="3" style="border:0px"  styleClass="ui-panel-content">
            <h:outputText value="Parent Category:"  />
            <h:selectOneMenu id="parentcat" value="#{CategoryMB.selectedCatId}">
              <f:selectItems value="#{CategoryMB.categories}" var="cat" itemLabel="#{cat.categoryName}" itemValue="#{CategoryMB.categoryId}" />
            </h:selectOneMenu>

            <p:message for="parentcat" />

            <h:outputText value="Category Name:" />
            <p:inputText id="catname" value="#{CategoryMB.catName}" required="true" requiredMessage="Category must requried !" />

            <p:message for="catname" />

            <h:outputText value="Category Logo:" />

            <t:inputFileUpload storage="file" id="catImageUpload" value="#{CategoryMB.file}" style="display: inline;vertical-align: baseline;margin-bottom: 10px;"/>

            <h:message for="catImageUpload" />

            <h:outputText value="Description" />

            <p:inputTextarea id="desc" cols="10"  autoResize="false" rows="4" value="#{CategoryMB.description}"></p:inputTextarea>

            <p:message for="desc" id="descmsg" />

            <f:facet name="footer">

              <p:commandButton value="Add Category" update="growl" action="#{CategoryMB.addCategory}" icon="ui-icon-check" />

            </f:facet>
          </h:panelGrid>
        </p:panel>

        <p:growl id="growl" showDetail="true" life="5000" />

      </h:form>
    </f:view> 
```

```
public void UploadImage() { 

    System.out.println("hi");

    UploadedFile myfile = getFile();

    byte[] buffer = null;

    File tempfile=null;

    if(myfile!=null)
    {
        String prefix = FilenameUtils.getBaseName(myfile.getName());
        String suffix = FilenameUtils.getExtension(myfile.getName());

        try
        {

            realPath= FacesContext.getCurrentInstance().getExternalContext().getRealPath("/Resources/CategoryImage");

            tempfile = File.createTempFile(prefix + "_", "." + suffix, new File(realPath));

            OutputStream out = new FileOutputStream(tempfile);

            InputStream in = new BufferedInputStream(myfile.getInputStream());

            this.catImage = tempfile.getName();                

            try {

                buffer = new byte[64 * 1024];

                int count;

                while ((count = in.read(buffer)) > 0)
                    out.write(buffer, 0, count);

            } finally {

                in.close();

                out.close();

            }   

            FacesContext context = FacesContext.getCurrentInstance();  

            context.addMessage(null, new FacesMessage("Successful", "Successfully added category! " + catName));  

        }
        catch(IOException e)
        {   
            e.printStackTrace();
        }   
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:32:05.043

`<p:commandButton>`默认发送ajax请求的，不支持ajax上传文件。为此，您应该`<p:fileUpload mode="advanced">`改用它。

添加`ajax="false"`到`<p:commandButton>`以将其关闭。

```
<p:commandButton ... ajax="false" /> 
```

请注意`<p:fileUpload mode="simple">`，它也可以用来代替 Tomahawk `<t:inputFileUpload>`，也需要这个。

* * *

**与具体问题无关**，将上传的文件写入扩展的 WAR 文件夹是**一个非常糟糕的**主意。原因 #1 是，当您重新部署 WAR 甚至重新启动服务器时，它们都会丢失，原因很简单，它们不包含在原始 WAR 中。将它们存放在其他更永久的位置。另请参阅此相关答案：[Uploaded image only available after refresh the page](https://stackoverflow.com/questions/8885201/uploaded-image-only-available-after-refreshing-the-page/8889096#8889096)。

# javascript - 主干拆分集合

> ID：14084628
> 
> 赞同：2
> 
> 时间：2012-12-29T18:23:20.557
> 
> 标签：javascript, backbone.js

我有一个模型的骨干集合，每个模型都包含一个日期。（这代表日历条目，收藏价值一周）我需要将收藏拆分为按日期分组的多个收藏。（例如：按天对每个日历条目进行分组，但将整周作为一个集合使用）

```
Collection: [M:{dateA, ...},
             M:{dateA, ...},
             M:{dateB, ...},
             M:{dateC, ...}] 
```

拆分为：

```
[
 {Collection1: [M:{dateA, ...},
                M:{dateA, ...}]
 },
 {Collection2: [M:{dateB, ...}]
 },
 {Collection3: [M:{dateC, ...}]
 }
] 
```

我已经使用下划线并找到所有唯一日期并使用它们过滤到集合数组中以一种圆形的方式来解决问题，但我想知道是否有更简单的方法。过滤它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:32:08.007

这个问题似乎已经在这里得到了回答：

[如何在 Backbone.js 中使用 groupBy 对集合进行分组？](https://stackoverflow.com/questions/9954597/how-to-use-groupby-in-backbone-js-to-group-collections)

希望有帮助。

# git - gitignore 服务器上正在更改的文件

> ID：14084629
> 
> 赞同：1
> 
> 时间：2012-12-29T18:23:38.043
> 
> 标签：git

我有一个文件

```
scripts/config.txt 
```

我将此行添加到我的`.gitignore`，但是当它在服务器上更改并拉出时，我看到了冲突。问题是它已经在我的 .gitignore 中，所以当我在本地添加和提交时，它会忽略该文件。

为什么 gitignore 也不忽略远程更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:25:16.160

您需要使用从 repo 中删除资源

```
git rm --cached 
```

这样，它将不被跟踪。

然后您可以再次添加它，它将被忽略。

**编辑**

此外，如果您不想取消跟踪文件，您可以只在本地忽略它，方法是将其添加到`.git/info/exclude`文件中，该文件具有与`.gitignore`文件相同的语法。

# python - python中函数的自适应绘图

> ID：14084634
> 
> 赞同：6
> 
> 时间：2012-12-29T18:23:52.273
> 
> 标签：python, matplotlib, plot

一个简单的问题：我有一个函数 f(t)，它应该在 [0,1] 上的某个点有一些尖峰。一个自然的想法是使用此函数的自适应采样来获得一个漂亮的“自适应”图。我怎样才能在 Python + matplotlib + numpy + 中快速做到这一点？我可以计算 [0,1] 上任何 t 的 f(t)。

似乎 Mathematica 有这个选项，Python 有吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T18:33:51.477

看看我发现了什么：[一维函数的自适应采样，](http://central.scipy.org/item/53/1/adaptive-sampling-of-1d-functions)来自[scipy-central.org](http://central.scipy.org/)的链接。

代码是：

```
# License: Creative Commons Zero (almost public domain) http://scpyce.org/cc0

import numpy as np

def sample_function(func, points, tol=0.05, min_points=16, max_level=16,
                    sample_transform=None):
    """
    Sample a 1D function to given tolerance by adaptive subdivision.

    The result of sampling is a set of points that, if plotted,
    produces a smooth curve with also sharp features of the function
    resolved.

    Parameters
    ----------
    func : callable
        Function func(x) of a single argument. It is assumed to be vectorized.
    points : array-like, 1D
        Initial points to sample, sorted in ascending order.
        These will determine also the bounds of sampling.
    tol : float, optional
        Tolerance to sample to. The condition is roughly that the total
        length of the curve on the (x, y) plane is computed up to this
        tolerance.
    min_point : int, optional
        Minimum number of points to sample.
    max_level : int, optional
        Maximum subdivision depth.
    sample_transform : callable, optional
        Function w = g(x, y). The x-samples are generated so that w
        is sampled.

    Returns
    -------
    x : ndarray
        X-coordinates
    y : ndarray
        Corresponding values of func(x)

    Notes
    -----
    This routine is useful in computing functions that are expensive
    to compute, and have sharp features --- it makes more sense to
    adaptively dedicate more sampling points for the sharp features
    than the smooth parts.

    Examples
    --------
    >>> def func(x):
    ...     '''Function with a sharp peak on a smooth background'''
    ...     a = 0.001
    ...     return x + a**2/(a**2 + x**2)
    ...
    >>> x, y = sample_function(func, [-1, 1], tol=1e-3)

    >>> import matplotlib.pyplot as plt
    >>> xx = np.linspace(-1, 1, 12000)
    >>> plt.plot(xx, func(xx), '-', x, y[0], '.')
    >>> plt.show()

    """
    return _sample_function(func, points, values=None, mask=None, depth=0,
                            tol=tol, min_points=min_points, max_level=max_level,
                            sample_transform=sample_transform)

def _sample_function(func, points, values=None, mask=None, tol=0.05,
                     depth=0, min_points=16, max_level=16,
                     sample_transform=None):
    points = np.asarray(points)

    if values is None:
        values = np.atleast_2d(func(points))

    if mask is None:
        mask = Ellipsis

    if depth > max_level:
        # recursion limit
        return points, values

    x_a = points[...,:-1][...,mask]
    x_b = points[...,1:][...,mask]

    x_c = .5*(x_a + x_b)
    y_c = np.atleast_2d(func(x_c))

    x_2 = np.r_[points, x_c]
    y_2 = np.r_['-1', values, y_c]
    j = np.argsort(x_2)

    x_2 = x_2[...,j]
    y_2 = y_2[...,j]

    # -- Determine the intervals at which refinement is necessary

    if len(x_2) < min_points:
        mask = np.ones([len(x_2)-1], dtype=bool)
    else:
        # represent the data as a path in N dimensions (scaled to unit box)
        if sample_transform is not None:
            y_2_val = sample_transform(x_2, y_2)
        else:
            y_2_val = y_2

        p = np.r_['0',
                  x_2[None,:],
                  y_2_val.real.reshape(-1, y_2_val.shape[-1]),
                  y_2_val.imag.reshape(-1, y_2_val.shape[-1])
                  ]

        sz = (p.shape[0]-1)//2

        xscale = x_2.ptp(axis=-1)
        yscale = abs(y_2_val.ptp(axis=-1)).ravel()

        p[0] /= xscale
        p[1:sz+1] /= yscale[:,None]
        p[sz+1:]  /= yscale[:,None]

        # compute the length of each line segment in the path
        dp = np.diff(p, axis=-1)
        s = np.sqrt((dp**2).sum(axis=0))
        s_tot = s.sum()

        # compute the angle between consecutive line segments
        dp /= s
        dcos = np.arccos(np.clip((dp[:,1:] * dp[:,:-1]).sum(axis=0), -1, 1))

        # determine where to subdivide: the condition is roughly that
        # the total length of the path (in the scaled data) is computed
        # to accuracy `tol`
        dp_piece = dcos * .5*(s[1:] + s[:-1])
        mask = (dp_piece > tol * s_tot)

        mask = np.r_[mask, False]
        mask[1:] |= mask[:-1].copy()

    # -- Refine, if necessary

    if mask.any():
        return _sample_function(func, x_2, y_2, mask, tol=tol, depth=depth+1,
                                min_points=min_points, max_level=max_level,
                                sample_transform=sample_transform)
    else:
        return x_2, y_2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-03T21:47:59.327

看起来[https://github.com/python-adaptive/adaptive](https://github.com/python-adaptive/adaptive)是一种尝试这样做以及更多：

> **自适应**
> 
> 用于数学函数的自适应并行采样的工具。
> 
> `adaptive`是一个开源 Python 库，旨在简化自适应并行函数评估。您只需`adaptive`提供一个函数及其边界，它将在参数空间中的“最佳”点进行评估。只需几行代码，您就可以评估计算集群上的函数，实时绘制返回的数据，并微调自适应采样算法。

这个项目也受到这个问题的另一个答案（或至少一个相关项目）中的代码的启发：

> **学分**
> 
> ...
> 
> *   Pauli Virtanen 的 AdaptiveTriSampling 脚本（自 SciPy Central 宕机后不再在线提供），它为 ~adaptive.Learner2D 提供了灵感。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-29T18:49:28.933

出于绘图目的，不需要*自适应*采样。为什么不以或高于屏幕分辨率进行采样？

```
POINTS=1920

from pylab import *
x = arange(0,1,1.0/POINTS)
y = sin(3.14*x)
plot(x,y)
axes().set_aspect('equal') ## optional aspect-ratio control
show() 
```

如果您想要任意采样密度，或者该函数与矢量化方法不兼容，您可以逐点构建一个 x,y 数组。中间值将由`plot()`函数进行线性插值。

```
POINTS=1980
from pylab import *
ax,ay = [],[]
for x in linspace(0.0,POINTS,POINTS):
   if randint(0,50)==0 or x==0 or abs(x-POINTS)<1e-9:
      y = math.sin(4*2*math.pi*x/POINTS)
      ax.append(x), ay.append(y)
# print(ax,ay)
plot(ax,ay) 
```

# java - 如何为 Hibernate 的查询响应创建对象？

> ID：14084645
> 
> 赞同：0
> 
> 时间：2012-12-29T18:25:15.517
> 
> 标签：java, hibernate

使用扩展 HibernateDaoSupport 的对象，我在这里运行了一个查询：

```
List<Object> trialList2 = getSession().createSQLQuery(trialQuery2).list(); 
```

其中 trialQuery2 只是一些返回单行的查询。我得到了一个列表，上面有一个对象，在 Eclipse 中检查时看起来像这样：

```
[some, random, data] 
```

我想创建一个可以容纳我从查询中返回的对象，但是可以包含这些字段的简单 Javabean 对象似乎不起作用。有谁知道我必须制作什么样的对象才能访问这些值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:26:39.453

实际上`Object[]`不会`Object`

```
List<Object[]> trialList2 
```

根据您的选择查询中的列，您从索引中获取值

让我们说，如果您的查询是`select firstname, lastname from employee;`

`Object[0]`将是名字

`Object[1]`将是姓氏。

根据[文档](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querysql.html)：

> 这些将返回一个对象数组列表 (Object[])，其中包含表中每一列的标量值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:28:59.330

U 可以替换 BEANCLASSNAME 的任何类名

```
List<BEANCLASSNAME> trialList2 = getSession().createSQLQuery(trialQuery2).setResultTransformer(new AliasToBeanResultTransformer(BEANCLASSNAME.class)).list(); 
```

# ruby-on-rails - nil:NilClass 的未定义方法“电子邮件”

> ID：14084651
> 
> 赞同：0
> 
> 时间：2012-12-29T18:25:39.123
> 
> 标签：ruby-on-rails, devise

我正在使用`devise`并试图强制用户登录。在他登录后，我想检查他的电子邮件是否在工作人员表中找到。如果存在，将他重定向到：`/workers`，否则重定向到`/tasksadmins`。

我试过：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :authenticate_user!
  before_filter :is_worker

  def is_worker

     @email = current_user.email
     tag = Worker.where(:email => @email)
     if tag.nil?
        redirect_to '/tasksadmins'
     else
        redirect_to '/workers'
     end
  end
end 
```

但我得到了：

```
undefined method `email' for nil:NilClass 
```

**更新**

我试过：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :authenticate_user!
  before_filter :is_worker

  def is_worker
    if user_signed_in?
       @email = current_user.try(:email)
      if @email && Worker.find_by_email(@email).nil?
        redirect_to '/tasksadmins'
      else
        redirect_to '/workers'
      end
    else
        redirect_to '/users/sign_in' # devise?
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:44:14.157

如果用户未成功验证，则 cuurent_user 将为 nil。假设您正在使用设备进行身份验证，我是否正确？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:55:44.907

好的，抱歉...我刚刚注意到您已更新您的问题

```
#SessionsController

def after_sign_in_path_for(resource)
  return request.env['omniauth.origin'] || session[:user_return_to] || root_path
end

#Your controller

before_filter :user_return_to
before_filter :authenticate_user!
before_filter :is_worker

def is_worker
   @email = current_user.try(:email)
   if @email && Worker.find_by_email(@email).nil?
      redirect_to '/tasksadmins'
   else
      redirect_to '/workers'
   end
end

private

def user_return_to
  session[:user_return_to] = request.fullpath
end 
```

**.find_by_email**等动态查找器返回单个对象（第一个匹配），否则返回**nil**。

但是**.where()**总是返回 AR::Relation ，它可以是空白* (empty*) 并且**永远不会是 nil**。

* *AR::Relation 响应 .blank？和.empty？将这些方法委托给实际上是 Array 的集合。*所以代码：

```
tag = Worker.where(:email => @email)
if tag.nil? 
```

将始终返回**false**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:59:08.337

```
 def is_worker
     render :template => '/login' and return if current_user.nil?
     @email = current_user.email
     tag = Worker.where(:email => @email)
     if tag.nil?
        redirect_to '/tasksadmins'
     else
        redirect_to '/workers'
     end
  end 
```

# sql-server - 尝试连接到 SQL Server 时出错 - localhost

> ID：14084656
> 
> 赞同：1
> 
> 时间：2012-12-29T18:26:16.813
> 
> 标签：sql-server, sql-server-2008

我已经检查了实例名称，自动关闭设置为 true，检查了允许服务器上的远程连接。当我打开 SQL Server 配置管理器时，服务器正在运行。我什至已经重新启动。我以与所有其他人相同的方式创建了这个数据库。我使用实体框架并检查了其中的名称`web.config`并且它们匹配。这是向导中的默认连接字符串 - 我在部署之前用于测试。我只是想不出其他任何东西来检查它为什么无法连接。在 SQL Server 中工作一切都很好。

这是一般错误。

> *与 SQL >Server 建立连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确，并且 SQL Server 已配置为允许远程连接。（提供程序：共享 > 内存提供程序，错误：40 - 无法打开与 SQL Server 的连接）*

配置：

`connectionString="metadata=res://*/Model.csdl|res://*/Model.ssdl|res://*/Model.msl;provider=System.Data.SqlClient;provider connection string='data source=.\SQL_1;attachdbfilename=&quot;C:\Program Files (x86)\Microsoft SQL Server\MSSQL10_50.SQL_1\MSSQL\DATA\A_db.mdf&quot;;integrated security=True;connect timeout=10;user instance=True;multipleactiveresultsets=True;App=EntityFramework'" providerName="System.Data.EntityClient" />`

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T04:02:35.413

让我先说一下这个答案，正确设置 SQL 实例并不像微软希望你用实体框架想象的那么容易。这有点复杂，需要你戴上你的 DBA 帽子。

您遇到的错误表明 Web 实例正在尝试使用 Windows 集成安全性连接到 SQL 服务器。如果 (a) 进程正在运行的 windows 用户（可以在 IIS 中配置）被授权登录到 SQL 服务器并且在数据库中具有有效的登录名，并且 (b) 如果 SQL 服务器与 IIS 服务器在同一台机器上或同一域中。

鉴于此，我建议使用 SQL Server 身份验证。如果您需要知道如何执行此操作，我建议您搜索“SQL Server 身份验证设置” - 这是我发现的一篇文章，它可能会帮助您进行设置。

[http://msdn.microsoft.com/en-us/library/aa337562.aspx](http://msdn.microsoft.com/en-us/library/aa337562.aspx)

一般来说，我建议采取以下措施：

1.  使用 MS SQL Management Studio 连接到 sql 服务器。
2.  永久附加您的数据库，然后在您的连接字符串上使用该[`Initial Catalog`属性](http://msdn.microsoft.com/en-us/library/aa237410%28v=sql.80%29.aspx)，而不是`AttachDbFileName`
3.  然后在 SQL 服务器上设置您的登录用户名和密码，并在数据库中为其创建一个登录名。
4.  确保您的登录名只能执行您希望它执行的存储过程。拒绝它访问正在运行的 sql 语句。

您还需要将用户名和密码添加到连接字符串，并设置 IntegratedSecurity=false。

正确设置 SQL 服务器后，请告诉我们情况如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:00:17.503

此错误意味着您的提供程序代码找不到 SQL Server。如果您检查了服务器实例名称（应该是`<yourLocalServer>\SQL_1`），那么它可能是`attachdbfilename=`参数，因为这是指定要连接的数据库的一种非常不可靠的方式（您应该使用数据库名称，而不是文件名），因为大约有一百个与您的应用程序无关的文件名可能更改的原因。

# objective-c - UIScrollView 仅在底部禁用垂直反弹

> ID：14084657
> 
> 赞同：27
> 
> 时间：2012-12-29T18:26:16.800
> 
> 标签：objective-c, ios

我一直在寻找一种方法来禁用 UIScrollView 的垂直反弹，但仅限于底部。我仍然需要在顶部反弹。

找不到任何东西。这可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-29T18:36:35.607

使用 UIScrollViewDelegate 方法`scrollViewDidScroll`检查滚动视图的内容偏移，或多或少地检查用户是否试图滚动超出滚动视图的底部边界。然后只需使用它来将滚动设置回滚动视图的末尾。它发生得如此之快，以至于您甚至根本无法判断滚动视图反弹或超出其边界。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (scrollView.contentOffset.y >= scrollView.contentSize.height - scrollView.frame.size.height) {
        [scrollView setContentOffset:CGPointMake(scrollView.contentOffset.x, scrollView.contentSize.height - scrollView.frame.size.height)];
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-01-27T22:13:01.537

要在 Swift 中禁用顶部的垂直反弹：

```
func scrollViewDidScroll(scrollView: UIScrollView) {
    if scrollView.contentOffset.y < 0 {
        scrollView.contentOffset.y = 0
    }
} 
```

要在 Swift 中禁用底部的垂直反弹：

```
func scrollViewDidScroll(_ scrollView: UIScrollView) {
    if scrollView.contentOffset.y > scrollView.contentSize.height - scrollView.bounds.height {
        scrollView.contentOffset.y = scrollView.contentSize.height - scrollView.bounds.height
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T19:18:16.700

根据 0x7fffffff 的回答，我创建了一个类：

垂直弹跳控制.h

```
#import <UIKit/UIKit.h>

@interface VerticalBounceControl : NSObject

@property (nonatomic, assign) BOOL bounce;

- (id) initWithScrollView:(UIScrollView*)scrollView bounceAtTop:(BOOL)bounceAtTop bounceAtBottom:(BOOL)bounceAtBottom;

@end 
```

垂直弹跳控制.m

```
#import "VerticalBounceControl.h"

@interface VerticalBounceControl ()
@property (nonatomic, retain) UIScrollView* scrollView;
@property (nonatomic, assign) BOOL bounceAtTop;
@property (nonatomic, assign) BOOL bounceAtBottom;
@end

@implementation VerticalBounceControl

- (id) initWithScrollView:(UIScrollView*)scrollView bounceAtTop:(BOOL)bounceAtTop bounceAtBottom:(BOOL)bounceAtBottom {
    self = [super init];
    if(self) {
        self.bounce = YES;
        self.scrollView = scrollView;
        self.bounceAtTop = bounceAtTop;
        self.bounceAtBottom = bounceAtBottom;
        [self.scrollView addObserver:self forKeyPath:@"contentOffset" options:NSKeyValueObservingOptionNew context:NULL];
    }
    return self;
}

- (void) dealloc {
    [self.scrollView removeObserver:self forKeyPath:@"contentOffset"];
    self.scrollView = nil;
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    if ([keyPath isEqualToString:@"contentOffset"]) {
        if (self.bounce && ((self.scrollView.contentOffset.y<=0 && self.bounceAtTop) || (self.scrollView.contentOffset.y>=self.scrollView.contentSize.height-1 && self.bounceAtBottom))) {
            self.scrollView.bounces = YES;
        } else {
            self.scrollView.bounces = NO;
        }
    }
}

@end 
```

可以在调用者不是这样的代表的情况下使用`UIScrollView`：

```
VerticalBounceControl* bounceControl = [[VerticalBounceControl alloc] initWithScrollView:anyScrollView bounceAtTop:YES bounceAtBottom:NO]; 
```

这样，您可以对`UIScrollView`不想更改其委托的 s 进行这种反弹行为（例如`UIWebView`'s one）。

再次感谢@0x7fffffff 的解决方案！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-05-15T04:55:31.823

**斯威夫特 3：**

这仅在底部禁用垂直反弹：

```
func scrollViewDidScroll(_ scrollView: UIScrollView) {
    if scrollView.contentOffset.y > scrollView.contentSize.height - scrollView.bounds.height {
        scrollView.contentOffset.y = scrollView.contentSize.height - scrollView.bounds.height
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-11T03:30:15.047

让我们禁用`bounces`何时滚动到底部。

```
scrollView.bounces = scrollView.contentOffset.y < scrollView.contentSize.height - scrollView.frame.height 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-26T07:19:10.963

我添加`fabsf()`到 0x7ffffffff♦ 的解决方案中也可以满足负（向下）滚动：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (fabsf(scrollView.contentOffset.y) >= scrollView.contentSize.height - scrollView.frame.size.height) {
        [scrollView setContentOffset:CGPointMake(scrollView.contentOffset.x, scrollView.contentSize.height - scrollView.frame.size.height)];
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-07T10:49:53.450

自从我使用分页以来，我一直在寻找一种解决方案，仅针对 contentSize 宽度比设备更宽的滚动视图禁用底部反弹。这些都不适合我，但我找到了一种方法。我想我应该分享这个，因为我浪费了两天时间来做这个。我正在使用 Swift 4，但如果你知道如何转换它，这适用于目标 c，如果你有这两种方法的经验，这应该很容易。

这适用于以设备屏幕框架为框架的滚动视图。

1.  添加变量以了解滚动视图的当前页面。
    `var currentPage : Int!`

2.  设置初始值
    `currentPage = 0`

3.  `currentPage`滚动后更新
    `public func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) { let width = scrollView.frame.size.width let page = (scrollView.contentOffset.x + (0.5 * width)) / width currentPage = Int(page) }`

4.  过滤底部滚动和更新 contentOffset
    `public func scrollViewDidScroll(_ scrollView: UIScrollView) { if CGFloat(currentPage) * screenWidth < scrollView.contentOffset.x || CGFloat(currentPage) * screenWidth < scrollView.contentOffset.y || (((CGFloat(currentPage) * screenWidth - scrollView.contentOffset.x) >= 0) && scrollView.contentOffset.y > 0){ scrollView.contentOffset.y = 0 } }`

`CGFloat(currentPage) * screenWidth < scrollView.contentOffset.x || CGFloat(currentPage) * screenWidth < scrollView.contentOffset.y`将过滤左下和右下滚动

`(((CGFloat(currentPage) * screenWidth - scrollView.contentOffset.x) >= 0) && scrollView.contentOffset.y > 0)`将过滤底部中间滚动

`scrollView.contentOffset.y = 0`将阻止它滚动

# z3 - 有没有办法通过 API 查询或访问 Z3 表达式的结构

> ID：14084659
> 
> 赞同：2
> 
> 时间：2012-12-29T18:26:26.410
> 
> 标签：z3

我正在从 F# 访问托管 API。我可以使用 ctx.MkFalse、MkImplies、MkMul 等构造 Z3 表达式，但是如何遍历 Z3 表达式以发现其结构？是否有类似 e.Op 或 e.IsFalse、e.IsImplies 等的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T21:20:06.477

您应该查看[Expr.cs](http://research.microsoft.com/en-us/um/redmond/projects/z3/class_microsoft_1_1_z3_1_1_expr.html#a74d5773ff130926bd9a932e974372958)的文档。

这是一个遍历表达式的简单 F# 示例：

```
let traverse (expr: Expr) =
    printfn "num args: %O" expr.NumArgs
    printfn "children: %A" expr.Args
    printfn "1st child: %O" expr.Args.[0]
    printfn "2nd child: %O" expr.Args.[1]
    printfn "operator: %O" expr.FuncDecl
    printfn "op name: %O" expr.FuncDecl.Name 
```

`Expr`该类还公开了所有[术语种类测试，包括 IsTrue、IsAnd、isImplies 等](http://research.microsoft.com/en-us/um/redmond/projects/z3/_expr_8cs_source.html#l00272)，这些测试是发现表达式结构所必需的。在 F# 中，您应该定义一组活动模式：

```
let (|True|_|) (expr: Expr) = if expr.IsTrue then Some() else None
let (|False|_|) (expr: Expr) = if expr.IsFalse then Some() else None

let (|And|_|) (expr: Expr) = if expr.IsAnd then Some expr.Args else None
let (|Or|_|) (expr: Expr) = if expr.IsOr then Some expr.Args else None
let (|Not|_|) (expr: Expr) = if expr.IsNot && expr.NumArgs = 1u 
                             then Some(expr.Args.[0]) else None

let (|Iff|_|) (expr: Expr) = if expr.IsIff && expr.NumArgs = 2u 
                             then Some(expr.Args.[0], expr.Args.[1]) else None
let (|Implies|_|) (expr: Expr) = if expr.IsImplies && expr.NumArgs = 2u 
                                 then Some(expr.Args.[0], expr.Args.[1]) else None 
```

这样您就可以通过模式匹配轻松查询表达式的结构，即使是递归方式：

```
match e with
| True -> (* boolean literal *)
| False -> (* boolean literal *)
| And es -> (* query es; possibly by pattern matching *)
| Or es -> (* query es; possibly by pattern matching *)
| Not e' -> (* query e; possibly by pattern matching *)
| Iff(e1, e2) -> (* query e1, e2; possibly by pattern matching *)
| Implies(e1, e2) -> (* query e1, e2; possibly by pattern matching *)
| _ -> (* Not a boolean expression; do something else *) 
```

# c# - Parallel.ForEach 不当行为

> ID：14084660
> 
> 赞同：11
> 
> 时间：2012-12-29T18:26:30.650
> 
> 标签：c#, parallel-processing, task-parallel-library

> **可能重复：**
> [并行处理期间的 C# 值存储](https://stackoverflow.com/questions/14079158/c-sharp-value-storage-during-parallel-processing)

我今天在我的控制台应用程序中运行了一些性能测试，我偶然发现了一些非常出乎意料的东西。我的代码：

```
int iterations = 1000000;

var mainList = new List<string>();

for (int i = 0; i < iterations; i++)
{
    mainList.Add(i.ToString());
}

var listA = new List<string>();

Parallel.ForEach(mainList, (listItem) =>
                           {
                               if (Int32.Parse(listItem)%2 == 0)
                               {
                                   listA.Add(listItem);
                               }
                           });

Console.WriteLine("Parallel Count: {0}", listA.Count);

var listB = new List<string>();
foreach (var listItem in mainList)
{
    if (Int32.Parse(listItem) % 2 == 0)
    {
        listB.Add(listItem);
    }
}

Console.WriteLine("Sequential Count: {0}", listB.Count); 
```

这导致了一个输出：

并行计数：495939

连续计数：500000

我跑了好几次，并行循环似乎从来没有在适当的时间执行过。谁能解释这种“不当行为”？并行循环是否可信？

PS 我知道在提供的代码示例中发生了很多废话，例如 ToString() 调用整数而不是解析它们，但这只是我在测试时想出的随机代码。提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-29T18:31:20.437

你的问题不在于`Parallel.ForEach`. 您的问题在于`List<int>`- 该类不是线程安全的。我的猜测是您遇到了列表对象的线程安全问题。尝试使用 a[`ConcurrentBag<int>`](http://msdn.microsoft.com/en-us/library/dd381779.aspx)代替，问题可能会消失。

来自 Microsoft 关于[线程安全的`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx#threadSafetyToggle)：

> 要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

# android - 活动生命周期：为什么设置为“暂停”而不是“停止”

> ID：14084661
> 
> 赞同：4
> 
> 时间：2012-12-29T18:26:32.680
> 
> 标签：android, android-lifecycle

为了让我在假期里保持忙碌，我决定学习 Android 开发。

所以我正在关注关于 Activity 生命周期的[教程。](https://developer.android.com/training/basics/activity-lifecycle/pausing.html)在链接的文章中，它说：

> 在正常的应用程序使用过程中，前台 Activity 有时会受到其他可视组件的阻碍，从而导致 Activity 暂停。例如，当一个**半透明的活动**打开时（例如对话框样式的活动），前一个活动会暂停。只要活动仍然**部分**可见但当前不是焦点活动，它就会保持暂停。
> 
> 但是，一旦活动被**完全阻挡**且不可见，它就会停止（在下一课中讨论）。

我下载了示例应用程序。示例应用程序有 3 个活动，每个活动都有用于从`Intent`. 当我单击“开始 B”时，我预计`Activity A`' 的状态应该是“已停止”，因为它现在完全被`Activity B`' 的布局所阻挡。但是，它被设置为“暂停”。

`Activity A`状态变为已停止的唯一时间是当我从`Activity B`的布局中单击“启动 C”时。

为什么会这样？是因为较新的 Android 版本上存在一些优化还是我误解了这篇文章？

![截屏](../Images/226789aab76ce322c6281bbf3d4be662.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T18:57:39.867

这是我通过艰难的方式学到的东西——谷歌的 Android 文档并不完全准确！

有时，系统会优化某些似乎偏离文档的行为。确切地知道某事是如何工作的唯一方法是通过艰苦的方式 - 通过挖掘[源头](https://github.com/android)！

如果您的应用程序依赖于某些系统级别的行为，例如停止和暂停以完全按照广告中的特定顺序工作，那么您将很难过。此行为由系统控制，不提供任何保证。

我发现处理这个问题的最好方法是找出谷歌向开发人员承诺的合同并坚持下去。例如，在这种情况下，合约说如果你遵循规则，在需要的时候实现所需的生命周期回调，那么它就会起作用，你**不需要**确切知道在什么情况下调用`onStop()`, `onSaveInstanceState()`,`onPause()`等。`onDestroy()`

换句话说，如果您通过实现在应用暂停时做了需要做的事情`onPause()`，那么您不需要确切知道您的活动何时会暂停。暂停/恢复由系统控制，并且可能会因版本而异（如果他们选择自定义此行为，甚至可能会因制造商而异）。

希望有人在我开始时告诉我这一点。这会为我节省很多时间和挫败感。希望这可以帮助。

# mysql - Windows上的MySQL主从复制，当将server-id = 1放在master上时它没有启动

> ID：14084663
> 
> 赞同：1
> 
> 时间：2012-12-29T18:26:40.733
> 
> 标签：mysql, database-replication

我正在尝试在我的 MySQL 服务器上进行主从复制，但是在将 server-id=1 放入`my.conf`并停止 mysql 服务器然后从 Windows 中的服务再次启动它之后，它出现错误并且无法启动。

问题是我找不到真正的错误消息，我得到的唯一一个来自无法启动服务的 Windows。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:43:29.303

如果您在启动 MySQL 服务时遇到问题，请检查其错误日志。在 Windows 上，它可能位于`C:\Program Files\MySQL\MySQL Server x.y.z\data\computername.err` （其中*computername*是您的 Windows 服务器的名称）。

几个想法：尝试用下划线而不是破折号拼写配置变量“server_id”。它们应该是可互换的，但我见过它们不适用于特定变量的情况。

搜索配置文件以查看是否有另一行声明了不同的服务器 ID。

您是否同时对配置文件进行了任何其他更改？如果是这样，可能是 server-id 更改没问题，但另一个更改导致了错误。撤消这些更改并一次进行一项更改，每次都重新启动 MySQL 服务。

# python - Python递归函数变量范围

> ID：14084666
> 
> 赞同：1
> 
> 时间：2012-12-29T18:27:10.113
> 
> 标签：python

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我在 Python 中使用 MailSnake，它是 MailChimp API 的包装器。

现在，对于我编写的用于提取我们拥有的订阅者列表的函数，我得到了一些奇怪的行为。这是我正在使用的代码：

```
from mailsnake import MailSnake
from mailsnake.exceptions import *

ms = MailSnake('key here')

def return_members (status, list_id, members = [], start = 0, limit = 15000, done = 0):
    temp_list = ms.listMembers(status=status, id=list_id, start=page, limit=limit, since='2000-01-01 01:01:01')
    for item in temp_list['data']:  # Add latest pulled data to our list
        members.append(item)
    done = limit + done
    if done < temp_list['total']:  # Continue if we have yet to 
        start = start + 1
        if limit > (temp_list['total'] - done):  # Restrict how many more results we get out if are on the penultimate page
            limit = temp_list['total'] - done
        print 'Making another API call to get complete list'
        return_members(status, list_id, members, page, limit, done)
    return members

for id in lists:
    unsubs = return_members('subscribed',id)
    for person in unsubs:
        print person['email']

print 'Finished getting information' 
```

所以这个函数递归运行，直到我们从给定列表中拉出所有成员。

但我注意到的是，变量 unsubs 似乎变得越来越大。当使用不同的列表 ID 调用函数 return_members 时，我得到了迄今为​​止我调用的每个列表的电子邮件的合并（而不仅仅是一个特定的列表）。

如果我调用 return_members('subscribed', id, []) 明确地给它一个新的数组，那就没问题了。但我不明白为什么我需要这样做，就好像我用不同的列表 ID 调用函数一样，它没有递归运行，并且由于我没有指定成员变量，它默认为 []

我认为这可能是 python 的一个怪癖，或者我只是错过了一些东西！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:42:24.050

Martjin 链接的 SO臭名昭著的问题将帮助您理解下划线问题，但要解决这个问题，您可以编写以下循环

```
for item in temp_list['data']:  # Add latest pulled data to our list
    members.append(item) 
```

到更 Pythonic 的版本

```
members = members + temp_list['data'] # Add latest pulled data to our list 
```

这一小改动将确保您使用的实例与作为参数传递给的实例不同`return_members`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:39:35.137

尝试更换：

```
def return_members (status, list_id, members = [], start = 0, limit = 15000, done = 0): 
```

和：

```
def return_members (status, list_id, members = None, start = 0, limit = 15000, done = 0):
    if not members: members = [] 
```

# php - CURL 代理问题

> ID：14084673
> 
> 赞同：1
> 
> 时间：2012-12-29T18:28:18.547
> 
> 标签：php, curl, proxy

我对这段代码有疑问：

```
<html>
<head><title>Son_Of_Diablo's Hit Booster</title>

<script language="JavaScript">
    function onlyNumbers(evt)
    {
    var e = event || evt;
    var charCode = e.which || e.keyCode;

    if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;

    return true;

    }
</script></head>

<body bgcolor="black">
<style type="text/css">
body,td,th {
    color: #00CC00;
}
</style>

<div align=center>
<h1>Son_Of_Diablo's Hit Booster</h1><br />
<form action="" method ="post">
    Site to boost: <br /><input type="text" name="url" style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" /><br /><br />
    Proxy to use: <br /><textarea rows="5" cols="16" type="text" name="proxy" style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" /></textarea><br /><br />
    User Agent to use: <br /><input type="text" name="agent"  style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" /><br /><br />
    Referer from:<br /> <input type="text" name="ref" style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" /><br  /><br />
    How many hits: <br /><input type="text" name="num" onkeypress="return onlyNumbers();" value="1" style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" /><br /><br />
    <input type="submit" value="BOOST" style="border:3px double #00CC00;background-color:#000000;color:#00CC00;" />
</form>
</div>

<?php

function upordown($url, $proxy, $agent, $ref){
    $agents =  array("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1309.0 Safari/537.17", "Mozilla/6.0 (Windows NT 6.2; WOW64; rv:16.0.1) Gecko/20121011 Firefox/16.0.1", "Mozilla/5.0 (compatible; MSIE 10.6; Windows NT 6.1; Trident/5.0; InfoPath.2; SLCC1; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 2.0.50727) 3gpp-gba UNTRUSTED/1.0", "Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25", "Opera/12.80 (Windows NT 5.1; U; en) Presto/2.10.289 Version/12.02");
    $agentsL = count($agents);
    $max = $agentsL;
    $cs = curl_init($url);
    $agentt = rand(0, 5);

    curl_setopt($cs, CURLOPT_NOBODY, true);
    //curl_setopt($cs, CURLOPT_FOLLOWLOCATION, TRUE);
    curl_setopt($cs, CURLOPT_PROXY, $proxy);
    curl_setopt($cs, CURLOPT_USERAGENT, $agent);
    curl_setopt($cs, CURLOPT_REFERER, $ref);
    curl_exec($cs);

    sleep(10);
    curl_close ($cs);
}

if (isset($_POST['url']) == true && empty($_POST['url']) == false){
        $count = 0;
        $num = $_POST['num'];
        $proxy = $_POST['proxy'];
        $proxyE = explode("\n", $proxy);
        $proxyL = count($proxyE);

        while ($count < $num){
        //if($count != $proxyL && $count < $proxyL){
        $url = trim($_POST['url']);
        $agent = $_POST['agent'];
        $agent = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1309.0 Safari/537.17";
        $ref = $_POST['ref'];
        foreach($proxyE as $proxys){
        if(filter_var($url, FILTER_VALIDATE_URL) == true){
            if(upordown($url, $proxys, $agent, $ref) == true){

            }else{
                echo 'Failed to add a hit from <strong>'.$proxys.'</strong><br />';
            }
        }else{
            echo 'Invalid URL';
        }
        $count++;
        /*}else{
        echo "<strong>ERROR:</strong> Not enought proxies!";
        }*/}}
}

?>

<br /><br />
<hr />
<br />
</body>
</html> 
```

我知道这真的很乱。。

所以我的问题是当我使用`curl_setopt($cs, CURLOPT_PROXY, $proxy);`

我不会工作：/但是如果我将其注释掉，它就可以了。

谁能看到我做错了什么？

非常感谢！

# asp.net - 使用标签的 ASP.NET 表单

> ID：14084675
> 
> 赞同：0
> 
> 时间：2012-12-29T18:28:36.223
> 
> 标签：asp.net, forms, label

我必须使用标签创建一个 asp.net 表单。我找到了此任务的示例并尝试运行它，但没有出现预期结果。你知道还应该做些什么来运行它吗？（我还处于 asp.net 的初级阶段。）这是代码：

```
<%@ Page Language="vb" %>
<script runat="server">
Sub submit(Sender As Object, e As EventArgs)
label1.Text=txt1.Text
End Sub
</script>
<html>
<body>
<form runat="server">
Write some text:
<asp:TextBox id="txt1" Width="200" runat="server"/>
<asp:Button id="b1" Text="Copy to Label" OnClick="submit" runat="server"/>
<p><asp:Label id="label1" runat="server"/></p>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:54:02.190

请检查您的函数 (SUB) 的默认访问修饰符。

在 c# 中，我们使用 protected 和来自**[MSDN](http://msdn.microsoft.com/en-us/library/ms173121.aspx)**

> 类成员，包括嵌套类和结构，可以是公共的、受保护的内部的、受保护的、内部的或私有的。默认情况下，类成员和结构成员（包括嵌套类和结构）的访问级别是私有的。不能从包含类型外部访问私有嵌套类型。

因此，请尝试使用 VB.Net 的 Friend 访问修饰符。

# java - Android 预加载启动画面

> ID：14084677
> 
> 赞同：0
> 
> 时间：2012-12-29T18:28:44.663
> 
> 标签：java, android

希望这不是一个愚蠢的问题，但是当我最初单击我的应用程序时，首先会出现几秒钟的初始屏幕，其中只有一个标题栏指示应用程序的名称，没有其他内容 - 然后应用程序按预期加载. 有什么办法可以去掉这个屏幕吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:48:21.707

系统会查看您的 AndroidManifest.xml 以找出主 Activity 的主题。如果您不手动指定它，它将假定应用程序主题，如果您不指定应用程序主题，则使用默认主题。然后，系统仅根据主题创建“启动画面”。

因此，如果要删除它，请创建一个具有透明背景且没有 ActionBar 的主题。在 onCreate() 中，您可能想再次更改主题（或者只是更改背景并显示 ActionBar）。

但最好有一些可见的“启动画面”。否则如果你点击图标，1 - 2 秒内你什么都看不到，这很奇怪，几乎没有应用程序这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:39:26.267

1.  初始化更多资源

    onCreate()

    可能需要一些时间。尽量不要重载Activity的onCreate()方法。

2.  尽量不要在 xml 布局文件中深入 30 层以上。这也可能需要一些时间来初始化。

    setContentView(R.layout.main)

# php - PHP用mysql列的总和填充数组

> ID：14084678
> 
> 赞同：2
> 
> 时间：2012-12-29T18:28:45.773
> 
> 标签：php, mysql, arrays, sum

我是编程的新手。我正在尝试从 MySQL 表创建一个数组，稍后我将使用它在 PHP/Javascript 中创建一个图表。

整个想法是，我想制作一个数组，里面装满代表一年中每周的数据。因此，一个包含 52 个条目的数组（让我们忘记有时会出现的第 53 周）。

我的数据库：

我的数据库中有 1 个用于此目的的表：

```
+--------------+
我生产我
+--------------+
I Shift I（数字） I <-范围从 1 到 3（人们所做的不同转变）
I 线 I（编号）I <-范围为 1-8（不同的“传送带”）
I Products I (number) I <-范围从 0- 很多！（以表格形式输入）
I 第 I 周（数字） I <-范围从 1 到 52
+--------------+

```

现在，我的想法是，我想要一个数组，里面装满了所有产品的总和。SUM(Products) 必须存在以下各项：

每个班次 + 生产线所有产品的总和。

Shift 1, Line 1, 生产 10,000 个产品
Shift 1, Line 2, 生产 15,000 个产品
Shift 1, Line 3, 生产 20,000 个产品（等等）

`SUM(Products)`将是从 1 到 3 班次的所有产品，以及从 1 到 8 班的所有产品。
所以：10,000 + 15,000 + 20,000 等等。

我希望将这个总数放入一个数组中，将“第 1 周”作为我的数组键。

所以第一周你会得到：

```
$array (
    "1" => // SUM(products) of week 1 (which was the 10,000 + 15,000 + 20,000 etc)
    "2" => // SUM(products) of week 2
    "3" => // SUM(products) of week 3
// etc. 
```

我可以通过添加 52 个不同的 MySQL 查询来做到这一点，唯一的区别是 WHERE week='x'？

到目前为止，我只试验了在 interwebz 上找到的代码。

任何帮助将不胜感激！:D

来自荷兰的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:54:17.413

只需取出 WHERE 子句，您就会得到每周的结果。

```
$result = mysql_query("SELECT week, SUM(products) AS total 
  FROM production GROUP BY week"); 
```

结果将作为结果集中的连续行返回，您可以将它们放入数组中：

```
$sum_by_week = array();
while ($row = mysql_fetch_assoc($result)) {
  $sum_by_week[$row["week"]] = $row["total"];
} 
```

PS：你没有要求这个，但你应该知道 mysql_* 函数已被弃用。您应该开始为新的 PHP 应用程序使用 mysqli 函数或 PDO。只有当您只是维护现有应用程序时，才值得继续使用旧的 mysql_* 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:54:32.567

提前为使用 mySQL 而不是另一个扩展而道歉。;-)

```
<?php // RAY_temp_rowan.php
error_reporting(E_ALL);
echo "<pre>";

// CONNECTION AND SELECTION VARIABLES FOR THE DATABASE
$db_host = "localhost"; // PROBABLY THIS IS OK
$db_name = "??";        // GET THESE FROM YOUR HOSTING COMPANY
$db_user = "??";
$db_word = "??";

// OPEN A CONNECTION TO THE DATA BASE SERVER
// MAN PAGE: http://php.net/manual/en/function.mysql-connect.php
if (!$db_connection = mysql_connect("$db_host", "$db_user", "$db_word"))
{
    $errmsg = mysql_errno() . ' ' . mysql_error();
    echo "<br/>NO DB CONNECTION: ";
    echo "<br/> $errmsg <br/>";
}

// SELECT THE MYSQL DATA BASE
// MAN PAGE: http://php.net/manual/en/function.mysql-select-db.php
if (!$db_sel = mysql_select_db($db_name, $db_connection))
{
    $errmsg = mysql_errno() . ' ' . mysql_error();
    echo "<br/>NO DB SELECTION: ";
    echo "<br/> $errmsg <br/>";
    die('NO DATA BASE');
}
// IF WE GOT THIS FAR WE CAN DO QUERIES

// CREATING A TABLE
$sql = "CREATE TEMPORARY TABLE my_table (
        _key INT         NOT NULL AUTO_INCREMENT,
        shift    INT NOT NULL DEFAULT 0,
        line     INT NOT NULL DEFAULT 0,
        products INT NOT NULL DEFAULT 0,
        week     INT NOT NULL DEFAULT 0,
        PRIMARY KEY(_key)  )";
$res = mysql_query($sql);

// IF mysql_query() RETURNS FALSE, GET THE ERROR REASONS
if (!$res)
{
    $errmsg = mysql_errno() . ' ' . mysql_error();
    echo "<br/>QUERY FAIL: ";
    echo "<br/>$sql <br/>";
    die($errmsg);
}

// LOAD UP THE TABLE
mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,2,4000, 1)') or die(mysql_error());
mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,4,4000, 1)') or die(mysql_error());

mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,2,4000, 2)') or die(mysql_error());
mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,4,5000, 2)') or die(mysql_error());

mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,2,4000, 3)') or die(mysql_error());
mysql_query('INSERT INTO my_table (shift, line, products, week) VALUES (1,4,6000, 3)') or die(mysql_error());

// MAKING A SELECT QUERY AND TESTING THE RESULTS
$sql = "SELECT week, SUM(products) as sump FROM my_table GROUP BY week ORDER BY week ASC";
$res = mysql_query($sql);

// IF mysql_query() RETURNS FALSE, GET THE ERROR REASONS
if (!$res)
{
    $errmsg = mysql_errno() . ' ' . mysql_error();
    echo "<br/>QUERY FAIL: ";
    echo "<br/>$sql <br/>";
    die($errmsg);
} // IF WE GET THIS FAR, THE QUERY SUCCEEDED AND WE HAVE A RESOURCE-ID IN $res SO WE CAN NOW USE $res IN OTHER MYSQL FUNCTIONS

// ITERATE OVER THE RESULTS SET TO SHOW WHAT WE SELECTED
while ($row = mysql_fetch_assoc($res))
{
    $out[$row["week"]] = $row["sump"];
}

var_dump($out); 
```

# php - wordpress 在不同的列中输出帖子？

> ID：14084679
> 
> 赞同：0
> 
> 时间：2012-12-29T18:28:47.460
> 
> 标签：php, wordpress

因此，如果我有一个像这样的简单循环：我将如何在不同的列中输出帖子？就像奇数/偶数帖子进入左右列（用于样式目的）。

我可以编写一个过滤器来将类添加到每个连续的帖子中，但是我需要在单个/存档页面上用 css 覆盖它们。我认为在 html 结构中必须有更好的方法来做到这一点。

```
<?php
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
query_posts('posts_per_page=3&paged=' . $paged); 
?>

<?php if (have_posts()) : while ( have_posts()) : the_post(); ?>

<div <?php post_class('clearfix') ?> id="post-<?php the_ID(); ?>">

<span><?php the_time('M jS, Y') ?></span>

<?php echo '<em>Written by </em> <br>'; the_author_posts_link(); ?> 

<?php the_tags('Tags: ', ', ', '<br />'); ?>

<?php comments_popup_link('No Comments', '1 Comment', '% Comments', 'comments-link', ''); ?>

<h2><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h2>

<?php global $more; $more = 0; ?>

<?php the_post_thumbnail(); ?>

<?php the_content('Read on...'); ?>

<?php endwhile; endif; ?> 
```

# php - 为什么我创建的任何新帐户的密码都没有加密进入我的会员数据库？

> ID：14084685
> 
> 赞同：-2
> 
> 时间：2012-12-29T18:29:22.107
> 
> 标签：php, codeigniter, phpmyadmin

我正在尝试创建新帐户并将每个用户的注册详细信息以加密形式输入我的会员数据库 - 目前可以在数据库中看到实际密码。为什么是这样？我正在使用表单验证库，并且已经包含了密码字段的 md5 规则，但它似乎没有产生任何影响。

控制器：

```
 function register()
 {

$this->load->helper(array('form', 'url'));

$this->load->library('form_validation');

$this->form_validation->set_rules('username', 'Username', 'required|callback_usernameTaken|min_length[5]|max_length[12]|trim');
$this->form_validation->set_rules('password', 'Password', 'required|md5|trim');

$username = $this->input->post('username');
$password = $this->input->post('password');

if ( $this->form_validation->run()&& !$this->membership->usernameTaken($username)){

$this->membership->newUser($username, $password);
$this->session->set_userdata('status', 'OK');
$this->session->set_userdata('username', $username);
redirect('home');
 }

else 
   {

    $this->session->set_userdata('status', 'NOT_OK');
    $this->load->view('shared/header');
    $this->load->view('account/signuptitle');
    $this->load->view('account/signupview');
    $this->load->view('shared/footer');

  }

 } 
```

再次感谢您的帮助

模型：

```
 function newUser($username, $password)
{
    $newMember = array ('username' => $username,
                        'password' => $password);
    $insert = $this->db->insert('membership', $newMember);

}

function usernameTaken($username)
{
    $this->db->select('*')->from ('membership')->where('username', $username);
    $query = $this->db->get();
    if ($query->num_rows > 0)
    {
        echo "<p>";
        echo 'username taken';
        echo "</p>";
        return true;
    }

   else{

    return false;

   }    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:40:18.600

表单验证规则验证表单值，它不会更改它们，因此如果要加密密码，则必须在表单通过验证后/将其添加到数据库之前执行此操作。

除此之外，这`md5`不是加密密码的好方法，并且它不返回布尔值（`true`或`false`），它返回一个始终评估为的字符串，`true`因此它在验证函数中没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:11:52.677

您正在分配`$username`并且`$password`在运行验证之前。`set_rules`方法只是设置验证规则。它不运行它。它们在`$this->form_validation->run()`方法上得到验证。所以只需将这些赋值语句放在`if`块中。

最好`trim`在`set_rules`方法中先使用。我把它作为第一条规则。您已经检查`callback_usernameTaken`了 set_rules 方法，因此无需在 if 语句中再次检查它。`usernameTaken`在控制器中比在模型中更好。所以把它移到了那里。最后查看我对 usernameTaken 方法所做的更改。我添加了`$this->form_validation->set_message`方法调用并交换了`true`和`false`.

```
function register()
{

    $this->load->helper(array('form', 'url'));

    $this->load->library('form_validation');

    $this->form_validation->set_rules('username', 'Username', 'trim|required|callback_usernameTaken|min_length[5]|max_length[12]');
    $this->form_validation->set_rules('password', 'Password', 'trim|required|md5');

    if ( $this->form_validation->run() ){

        $username = $this->input->post('username');
        $password = $this->input->post('password');

        $this->membership->newUser($username, $password);
        $this->session->set_userdata('status', 'OK');
        $this->session->set_userdata('username', $username);
        redirect('home');
    }
    else {

        $this->session->set_userdata('status', 'NOT_OK');
        $this->load->view('shared/header');
        $this->load->view('account/signuptitle');
        $this->load->view('account/signupview');
        $this->load->view('shared/footer');
    }
}

function usernameTaken($username)
{
    $this->db->select('*')->from ('membership')->where('username', $username);
    $query = $this->db->get();
    if ($query->num_rows > 0)
    {
        $this->form_validation->set_message('usernameTaken', 'username taken');
        return false;
    }
    else{
        return true;
   }
} 
```

CodeIgniter 的表单验证类提供表单验证和数据准备功能。[http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html)`md5`所以使用in`set_rules`方法 没有错。它将运行`md5`方法并返回加密的字符串。

为了更好地加密，请使用`Mcrypt`扩展名：php.net/manual/en/intro.mcrypt.php 或`crypt`函数：php.net/manual/en/function.crypt.php。

# jquery - 是否可以在同一个按钮上使用 mousedown 和 mouseup 事件？

> ID：14084687
> 
> 赞同：1
> 
> 时间：2012-12-29T18:29:51.187
> 
> 标签：jquery, html, arduino

该项目涉及通过 LAN 控制玩具车。

在我的 html 页面上，有 5 个“按钮”；向上、向下、向左、向右、停止。我的代码是这样工作的：假设用户点击“up”，一个值被发送到一个 php 页面进行处理，处理后的字符串被打印在另一个 php 页面上供 arduino 读取。

为了让汽车停下来，用户必须点击停止。

```
<html>
<head>
</head>

<form name="motorform" action="motorboardprocess.php" method="post">
<tr><p align='center'><font face="BN machine" size="6" color="royalblue">Motor Shield</font></tr>
<tr>
    <input id="forward" type="image" src="up.png" name="forward">
</tr> 
<tr>
    <input id="left" type="image" src="left.png"  name="left">
    <input id="stop"type="image" src="stop.png"  name="stop">
    <input id="right" type="image" src="right.png" name="right">
</tr>
<tr>      
    <input id="backward" type="image" src="down.png" name="backward">
</tr>   
</form>
</body>
</html> 
```

和所说的php ...

```
<?php

if (isset($_POST['forward_x'], $_POST['forward_y'])){
    $myFile = "mtboardcom.php";
    $fh = fopen($myFile, 'w') or die("can't open file");    
    $stringData = "<?php\n";
    fwrite($fh, $stringData);
    $stringData = "echo ".'"<forward>"'."\n";
            fwrite($fh, $stringData);
    $stringData = "?>\n";
            fwrite($fh, $stringData);
    fclose($fh);        
}

else if (isset($_POST['left_x'], $_POST['left_y'])){
    $myFile = "mtboardcom.php";
    $fh = fopen($myFile, 'w') or die("can't open file");    
    $stringData = "<?php\n";
    fwrite($fh, $stringData);
    $stringData = "echo ".'"<left>"'."\n";
            fwrite($fh, $stringData);
    $stringData = "?>\n";
            fwrite($fh, $stringData);
    fclose($fh);        
}
//and so on..... 
```

arduino 内容如下：

```
<?php
    echo "<forward>"
?> 
```

所以问题是，我如何利用 jquery 中的`mousedown`和`mouseup`事件来删除停止“按钮”。

或者另一种场景：用户按住按钮移动汽车，松开按钮停止汽车。

On ， arduino 读取`mousedown`一个字符串。`'forward'`

`mouseup`在同一个按钮上，`'stop'`arduino 读取字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:32:59.177

当然，您可以在 Javascript 中订阅两个不同的事件。只需挂钩事件：

```
var field = document.getElementsById('#idName');

field.onmousedown = function(){

}

field.onmouseup = function(){

} 
```

或者对于 jquery：

```
var field = $('#idName');

field.mousedown(function(){

}).mouseup(function(){

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:54:31.790

是的，您可以同时捕获 mousedown 和 mouseup 事件，但是您需要使用 AJAX 调用将信息发送到服务器，这样您就不会执行重新加载页面的回发。

此外，您不会自动获得与每个 mousedown 事件对应的 mouseup 事件。用户可能会在释放按钮之前将鼠标移到按钮之外，甚至将其移动到不同的按钮。您应该将按下的按钮存储在 Javascript 变量中，并为整个页面而不是按钮捕获 mouseup 事件，如果最后一次单击是在按钮上，则发送停止信号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:36:14.827

使用 jQuery，这非常简单：

```
$('#element').mousedown(function (event) {
    // process mouse down
});
$('#element').mouseup(function (event) {
    // process mouse up
}); 
```

您也可以将它们与

```
$('#element').mousedown(function(event) {
    /* code */
}).mouseup(function (event) {
    /* code */
}); 
```

在这些事件期间，您可以通过呼叫 ping 您的 URL `$.ajax`。但请注意，由于 AJAX 是异步的，如果您不小心，可能会看到竞争条件。因为它们来自 1 个客户，所以您应该没问题，但可能还有其他问题可能导致轻微延迟或响应时间差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:37:09.057

您可以使用以下 jquery 代码。在这里添加了一个[演示](http://jsfiddle.net/j6cBX/2/)

```
 <!DOCTYPE html>
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <div id='btn' style='width:50px;height:30px;background-color:red'>Click</div>
    <div id='log'></div>

<script>
    $("#btn").mouseup(function(){
      $('#log').append('<span style="color:#F00;">Mouse up.</span>');
    }).mousedown(function(){
      $('#log').append('<span style="color:#00F;">Mouse down.</span>');
    });

</script>

</body>
</html> 
```

# eclipse - 为什么将粘贴代码复制到新文件时eclipse错误消失

> ID：14084690
> 
> 赞同：0
> 
> 时间：2012-12-29T18:30:18.613
> 
> 标签：eclipse, buildpath

我最近不得不将我的代码从一台 pc 移动到另一台（奇怪的是一个 windows 终端到一个 linux 桌面）。

幸运的是（至少我认为）我经常使用 eclipse 中的导出功能导出代码，并将副本保存到 USB 密钥中。

因此，我只是将密钥上的代码“导入”到新桌面上的新工作区中。事情看起来很愉快和愉快。显然，我需要解决我使用过的库的路径和位置的一些问题，并对一些 ant 文件进行小幅更新。没什么大不了的。

在完成所有这些之后，我希望我得到的各种构建路径错误将得到解决。不幸的是没有。

在弄乱了文件的各种构建路径后，我决定尝试简单地将文件中的代码复制并粘贴到一个新类中。

所以我重命名了原始类（使用 Eclipse 重构过程将 _old 附加到名称中）。我创建了一个新的 java 类文件，然后将代码从 _old 文件复制/粘贴到新文件中，显然我在途中更改了类的名称和构造函数。

新文件不会抛出任何构建路径错误或任何其他与我有关的问题（我仍然有一些未使用的导入，但当我完成这些库的开发后，我会整理这些）

我的问题是，这是 Eclipse 的问题吗（我仍在使用 indigo，因为我发现 juno 非常慢？），如果是这样，我该如何排除故障以创建合理的错误报告？

还是我在导出/导入中做错了什么？

提前感谢您的任何评论。

大卫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:39:32.860

不知道出了什么问题，因为您显然在“当时”和“现在”之间执行了很多手动步骤。不过有一些提示：

*   您可以根据需要导出/导入所有工作区首选项（文件 -> 导出 -> 常规/首选项）。
*   你知道 Project -> Build Automatically 还是 Project -> Clean？
*   您可以通过项目或工作区首选项 -> Java 编辑器 -> 保存操作自动消除未使用的导入

# c# - P/Invoke C++ 模板 来自 C# 的方法

> ID：14084692
> 
> 赞同：7
> 
> 时间：2012-12-29T18:30:44.150
> 
> 标签：c#, c++, templates, generics, pinvoke

我在 C++ 函数中为外部调用定义了：

```
template<typename T>
void __declspec(dllexport) SwapMe(T *fisrt, T *second)
{
    std::cout << typeid(T).name() << std::endl;

    T temp = *first;
    *first = *second;
    *second = temp;
} 
```

我想在 C# 程序中使用它。我试过这样：

```
unsafe class Program
{
    [DllImport("lib1.dll", EntryPoint = "SwapMe")]
    static extern void SwapMe<T>(T first, T second);

    ...
} 
```

但是，我收到这样的错误：

***泛型方法或泛型类中的方法是内部调用、PInvoke，或者在 COM 导入类中定义。***

似乎是，C# 中的 Generic 是托管类型，它与 C++ 中的非托管模板的体系结构完全不同。

如何在我的 C# 程序中使用模板方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T21:13:30.183

C++ 编译器不会将模板函数烧录到二进制文件中。只发布专门的版本。C++ 编译器在逻辑上克隆模板定义并替换`T`为所需的任何具体类型。

这意味着您必须创建一个专门的包装器：

```
void __declspec(dllexport) SwapMe(int *fisrt, int *second) { //example
{ SwapMe(first, second); } 
```

你可以从 C# 调用这个，但你不能调用模板版本。

C++ 模板和 C# 泛型的工作方式非常不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T10:43:57.477

为了补充上述内容，我们最近完成了这项工作，并使用 T4 (TextTransform.exe) 为 C++ 中的包装器生成模板。

为此，我们在 C++ 项目中包含了一个 T4 文件，并且针对类型 args 的每种组合，围绕 C++ 模板方法生成了一个包装器方法。然后导出包装器方法。

最后在 C# 中，我们也做了同样的事情，使用 T4 为导出的方法生成一个通用包装器。通过这种方式，您可以在 .NET 泛型和 C++ 模板之间架起一座桥梁，同时充分利用 C++ 模板的强大功能

# c++ - 如何实现排序的指针向量？

> ID：14084693
> 
> 赞同：1
> 
> 时间：2012-12-29T18:30:44.247
> 
> 标签：c++, containers

我想实现一个排序的指针向量，如下所示

```
#include <vector>
#include <memory>
#include <algorithm>

//! A random accessed vector with sorted allocated elements.
//! - Elements must be allocated on heap.
//! - The vector manages the memories of its elements.
template<class T, class Compare = std::less<T>>
class SortedPtrVector
{
public:
    SortedPtrVector()   {}

    //! Add an element, return its index.
    int Add(T* element)
    {
        auto position = std::lower_bound(m_vector.begin(), m_vector.end(), 
            element, Compare); // Wrong here due to compare smart pointers
        auto newPosition = m_vector.insert(position, element);
        return newPosition - m_vector.begin();
    }

private:
    std::vector<std::unique_ptr<T>> m_vector;
}; 
```

如何实现添加功能？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:40:35.743

```
auto position = std::lower_bound(m_vector.begin(), m_vector.end(), 
        element, Compare); 
```

这显然是错误的。`Compare`是一个类型，而不是一个对象。

您可以将 lambda 与`Compare`. 所以我认为这应该有效：

```
Compare cmp; 
auto comparer = [&](std::unique_ptr<T> const & a, std::unique_ptr<T> const & b)
                {
                   return cmp(*a, *b); //use cmp here!
                };

std::unique_ptr<T> uniqElem(element); 

auto position = std::lower_bound( m_vector.begin(), 
                                  m_vector.end(), 
                                  uniqElem, //not element!!
                                  comparer); 
```

请注意，当期望 type 的值并且没有从 to 的隐式转换时，您不能像type一样传递`element`to 。此外，出于同样的原因，您不能插入到向量中。插入向量。`std::lower_bound``element``T*``std::lower_bound``std::unique_ptr<T>``T*``std::unique_ptr<T>``element``uniqElem`

我建议您使用参数 as`unique_ptr`而不是`T*`，因为这向用户表明，当对象`SortedPtrVector`超出范围时，添加的项目将被自动删除：

```
int Add(T* element);                 //bad - doesn't say element will be deleted!
int Add(std::unique_ptr<T> element); //good - says element will be deleted! 
```

如果使用`std::unique_ptr<T>`as 参数类型，请注意以下几点：

```
v.Add(new T());                     //will not work
v.Add(std::unique_ptr<T>(new T());  //will work

std::unique_ptr<T> item(new T()); 
v.Add(item);                        //will not work
v.Add(std::move(item));             //will work 
```

这都是因为`std::unique_ptr`不可*复制*，但它是*可移动*的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:37:04.980

`std::less`您可以像这样实现自己的，而不是使用`ptr_less`：

```
template< typename T >
class ptr_less
{
    typedef bool result_type;

    bool operator ()( T const& left, T const& right ) const
    {
        return *left < *right;
    }
}; 
```

一般的实现也必须检查*空指针*。

另一种方法是使用`boost::ptr_vector`而不是`std::vector`.

# rdf - “非语义”Web 应用程序中的 RDF

> ID：14084699
> 
> 赞同：4
> 
> 时间：2012-12-29T18:31:33.230
> 
> 标签：rdf

我们知道 RDF 是*语义网*的基石。所以我们可以使用 RDF 来描述电子图书馆、搜索引擎的内容、网络事件的时间表等。

但是，我们可以将 RDF 模型应用于“非语义”的 Web 应用程序吗？有没有例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T11:02:58.370

您可以在前端和/或后端使用 RDF。

一旦您在前端使用它（HTML 中的 RDFa、单独的 RDF 文件等），您就在语义 Web 中扮演了一个“角色”。*没有不能*使用 RDF 的网站/应用程序。

如果您仅在后端使用它（数据库、RDF 数据的导入等），您不会发布任何 RDF，因此您的站点/应用程序本身没有任何“语义”。它可能会*使用*语义 Web 数据，但不会产生它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T20:45:13.253

我认为一个重要的可能是[RDB2RDF](http://www.w3.org/TR/rdb-direct-mapping/)直接映射。那里有很多“非语义”数据。但实际上，这是一个术语问题。当您提到 RDF 时，您*使用*的是语义 Web 概念。

# java - java中的包导入错误

> ID：14084700
> 
> 赞同：0
> 
> 时间：2012-12-29T18:31:33.850
> 
> 标签：java, scope, package

我在 LibUtil 目录中使用文件 Item.java 打包 LibUtil。在这个文件中我有`public class Item`

```
package LibUtil;
public class Item
{
 static protected int id=0;
 protected int type;
 protected String name;
 protected String category;

public Item(int type,String name,String category)
 {
  id++;
  this.type = type;
  this.name = name;
  this.category = category;
 }

 public int GetId()
 {
  return id;
 }

 public int GetType(){
   return type;
  } 

 public void SetType(int type){
   this.type = type;
  }

 public String GetName(){
   return name;
  }

 public void SetName(String name){
   this.name = name;
  }

 public void SetCategory(){
   this.category = category;
  }
public String getCategory(){
   return category;
  }
} 
```

我从 LibUtil 导入这个类。

```
import LibUtil.Item;
public class Library{
 public static void main(String[] args){
   Item test = new Item(1,"XYZ","Alpha");

    }

} 
```

当我训练编译这个项目编译器产生这样的输出：

```
Library.java:1: LibUtil.Item is not public in LibUtil; cannot be accessed from outside package
import LibUtil.Item;
              ^
Library.java:4: cannot find symbol
symbol  : class Item
location: class Library
   Item test = new Item(1,"XYZ","Alpha");
   ^
Library.java:4: cannot find symbol
symbol  : class Item
location: class Library
   Item test = new Item(1,"XYZ","Alpha");
                   ^
3 errors 
```

如何解决这个问题？

更新：我尝试使用命令重建项目：

```
javac LibUtil/Item.java
javac Library.java 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:41:55.480

在我的源文件中，我找到了 Item.java 的副本。并且在这个重复的类中 Item 没有 public 修饰符。感谢本主题中所有答案的作者

# r - R中逻辑数组的最里面的真值

> ID：14084706
> 
> 赞同：2
> 
> 时间：2012-12-29T18:32:34.833
> 
> 标签：r

如果我有一个看起来像的逻辑数组

```
x = c(TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE) 
```

在上面的示例中，获得最内层 TRUE 的最简单方法是在索引 2 和索引 6 处

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:36:26.557

我不确定您的问题是否明确，但在这种特定情况下，`rle`可以为您提供所需的内容：

```
> rle(x)$lengths[1]
[1] 2
> rle(x)$lengths[1]+rle(x)$lengths[2]+1
[1] 6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:38:59.223

这可能更强大？如果真假切换两次以上，`rle`将不起作用..

```
 # you could try it on the original vector..
    # x <- c(TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE)

    # ..but it also works on a more scattered vector
    x <- c(TRUE, FALSE , TRUE, FALSE, FALSE, FALSE, FALSE , TRUE, TRUE, TRUE)

    # find the position of all TRUEs
    true.positions <- which( x )

    # find the midpoint of the vector
    midpoint <- length( x ) / 2

    # find the smallest distance from the midpoint,
    small.dist <- ( true.positions - midpoint )

    # both above and below
    small.dist.above <- min( small.dist[ small.dist >= 0 ] )
    small.dist.below <- abs( max( small.dist[ small.dist <= 0 ] ) )

    # find the lowest position above the midpoint
    lpa <- which( small.dist.above == true.positions - midpoint )
    # find the highest position below the midpoint
    hpb <- which( small.dist.below == midpoint - true.positions )

    # if both are the midpoint, combine them
    closest.trues <- unique( c( hpb , lpa ) )

    # return the position in the original vector x
    # of the innermost TRUE
    true.positions[ closest.trues ] 
```

# java - 不使用循环从可迭代对象中获取值

> ID：14084707
> 
> 赞同：-4
> 
> 时间：2012-12-29T18:32:56.260
> 
> 标签：java, loops, iterable

在 Java 中，如何在不循环的情况下从可迭代对象中检索元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:37:21.040

鉴于您可以编写 for-each 循环，您的`dataset`is `Iterable<T>`.

```
Vartype var = dataset.iterator().next(); 
```

`dataset`如果为空，它将抛出异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T18:36:12.457

```
if(dataset.size() == 1)
   number = dataset.get(0); //if collections

if(dataset.length == 1)
number = dataset[0];    //if array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:35:47.573

这是一种双刃剑。由于我们不知道它是什么`Vartype`，因此我们无法隐含地告诉您它是否是不可变的。

如果它没有改变，你可以把它当作一个单例并访问它的第一个元素。

```
var.get(0); 
```

如果大小*可以*更改，那么您将希望继续使用增强型。

# java - 以字节数组形式读取文件的最快方法

> ID：14084710
> 
> 赞同：1
> 
> 时间：2012-12-29T18:33:16.033
> 
> 标签：java, android

将文件作为字节数组读取的最快方法是什么（在 Android 上）？该文件大约为 4 MB。它位于资产目录中，这意味着它可能已被压缩。

目前，我正在做这样的事情：

```
byte[] buffer = new byte[4 * 1024 * 1024];
context.getAssets().open(FILE_NAME).read(buffer); 
```

在 Android 上，创建数组大约需要 40 毫秒，读取文件大约需要 120 毫秒。我怀疑 40 ms 主要是用零填充数组。我可以避免这种情况吗？

该文件基本上是一个需要快速搜索的大约 100,000 个项目的列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:03:40.360

[您可以通过使用RandomAccessFile](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/RandomAccessFile.html)类及其[read](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/RandomAccessFile.html#read%28byte%5B%5D%29)方法来避免创建字节数组。android[页面](http://developer.android.com/reference/java/io/RandomAccessFile.html)并没有太大的不同，但也可能很有用。我将 RAF 用于一个项目，以便在需要时从特定文件中存储和检索数据。RAF 对于这些任务非常有用。然而，你读和写的越多，当然会大大增加运行时间。以下是它的用法示例：

```
import java.io.RandomAccessFile;
import java.io.FileNotFoundException;

public class RAFTest {

    public static void main(String[] args) {
        RandomAccessFile raf;
        String metadata = "This is a test file.";

        try {

            raf = new RandomAccessFile(args[0], "rw");
            raf.writeUTF(metadata);
            int[] nums = new int[10];
            for(int i = 0; i < b.length; i++) {
                nums[i] = i;
                raf.writeInt(nums[i].getValue());
            }

            raf.seek(0); // force pointer to beginning

            System.out.println(raf.readUTF());
            int[] c = new int[5];
            int byteJump = 4;
            for(int i = 0; i < c.length; i++) {
                raf.seek(raf.getFilePointer() + byteJump);
                c[i] = raf.readInt();
                System.out.println(c[i]);
            }

        } catch(Exception ex) { }
    }
} 
```

# javascript - 如何从自由格式文本中提取日期时间？

> ID：14084711
> 
> 赞同：13
> 
> 时间：2012-12-29T18:33:16.127
> 
> 标签：javascript, datetime, nlp

我正在尝试提出一些类似于 Google 日历（甚至是一些 gmail 消息）的内容，其中将解析自由格式的文本并将其转换为特定的日期/时间。

一些示例（为简单起见，假设现在是 2013 年 1 月 1 日凌晨 1 点）：

```
"I should call Mom tomorrow to wish her a happy birthday" -> "tomorrow" = "2013-01-02"
"The super bowl is on Feb 3rd at 6:30pm" -> "Feb 3rd at 6:30" => "2013-02-03T06:30:00Z"
"Remind me to take out the trash on Friday" => "Friday" => "2013-01-04" 
```

首先，我会问这个 - 是否有任何已经存在的开源库（或其中的一部分）。如果不是，你认为我应该采取什么样的方法？

我正在考虑几种不同的可能性：

1.  很多正则表达式，我可以为每个不同的用例想出尽可能多的正则表达式
2.  某种贝叶斯网络，它查看 n-gram 并将它们分类为不同的场景，如“相对日期”、“相对星期几”、“特定日期”、“日期和时间”，然后通过规则引擎运行它（也许更多的正则表达式）来确定实际日期。
3.  将其发送到谷歌搜索并尝试从搜索结果中提取有意义的信息（这个可能不现实）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T19:05:04.190

你可以使用这个库：[https ://github.com/wanait/chrono](https://github.com/wanasit/chrono)

演示：

```
inputs = ["I should call Mom tomorrow to with her a happy birthday",
"The super bowl is on Feb 3rd at 6:30pm", "Remind me to take out the trash on Friday"];

for(var i = 0; i < inputs.length; i++) {
    var input = inputs[i];
    var parsed = chrono.parse(input);
    console.log(input + " parsed as: " + JSON.stringify(parsed.map(function(p) { return [p.text, p.startDate]; })));
}
​ 
```

输出：

```
I should call Mom tomorrow to with her a happy birthday parsed as: [["tomorrow","2012-12-31T06:30:00.000Z"]]
The super bowl is on Feb 3rd at 6:30pm parsed as: [["Feb 3rd at 6:30pm","2013-02-03T13:00:00.000Z"]]
Remind me to take out the trash on Friday parsed as: [["Friday","2013-01-04T06:30:00.000Z"]] 
```

[http://jsfiddle.net/TXX3Z/](http://jsfiddle.net/TXX3Z/)

# php - 在 Windows 上安装 PHP Mongo 驱动程序

> ID：14084712
> 
> 赞同：2
> 
> 时间：2012-12-29T18:33:24.873
> 
> 标签：php, windows, mongodb, mongodb-php

我可能在这里做一些愚蠢的事情，但我一直试图在运行 WAMP 的 Windows VM 上安装 mongodb php 客户端一段时间，但我无处可去。

我正在使用 PHP 5.4.3 运行 WAMP 64 位。[我从这里](https://github.com/mongodb/mongo-php-driver/downloads)下载了 1.3.2RC1 zip并将 php_mongo-1.3.2RC1-5.4-vc9.dll 文件解压缩到 wamp/bin/php/php5.4.3/ext 中，然后编辑 php.ini 文件以包含新的扩展名.

我重新启动 WAMP，一切都很好，然后当我尝试使用 php mongo 驱动程序教程中的一些代码时，它说找不到 MongoClient 类：

```
Fatal error: Class 'MongoClient' not found in C:\wamp\www\mongo\test.php ... 
```

代码很简单，但为了完整起见，我将其包括在内：

```
<?php
    $m = new MongoClient("the-connection-string-im-using");
?> 
```

我错过了什么吗？我应该像上面那样创建一个新的 MongoClient 实例还是需要做其他事情？

干杯

詹姆士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:53:59.230

我想通了 - 我使用了错误的 php.ini 文件。我应该一直使用 apache 目录（C:\wamp\bin\apache\apache2.2.22\bin）中的那个。

愚蠢的。

# ios - Cocos2d：图形工具

> ID：14084714
> 
> 赞同：1
> 
> 时间：2012-12-29T18:33:37.390
> 
> 标签：ios, cocos2d-iphone, box2d, box2d-iphone

我开始学习 Cocos2d 开发游戏和 Box2d；我阅读了一些教程，发现使用了两对工具“LevelHelper-SpriteHelper”和“PhysicsEditor-TexturePacker”。

我注意到 LevelHelper-SpriteHelper 更“简单”并且可以很好地组织关卡和物理对象。在使用 PhysicsEditor-TexturePacker 时，我注意到方法不是很清楚的一些困难。那么“LevelHelper-SpriteHelper”和“PhysicsEditor-TexturePacker”之间最好的工具是什么？有什么区别？你能给我解释一下吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T20:29:04.537

这应该回答你的问题：[http ://abitofcode.com/2012/07/cocos2d-useful-tools/](http://abitofcode.com/2012/07/cocos2d-useful-tools/)

物理编辑器是一个程序，可用于围绕不是简单多边形的精灵创建跟踪。例如，它可以追踪汽车的图像，因此当您使用物理引擎（类似于 box2d）检测您的汽车与另一个物体之间的碰撞时，它只记录与汽车的碰撞，而不是汽车周围的正方形. 这是一张图片，向您展示了它的作用：http: [//www.codeandweb.com/physicseditor/features](http://www.codeandweb.com/physicseditor/features)。

Texture-packer 用于将您在游戏中使用的所有精灵放入一个精灵表中。这使您可以最大程度地减少所有精灵占用的内存量。

[http://www.codeandweb.com/texturepacker](http://www.codeandweb.com/texturepacker)这张图片向您展示了它的作用。不必将所有单独的精灵图像添加到游戏中，而是将它们全部放在精灵表上，这会修剪每个图像周围的空间并将其放入 cocos2d 和 iphone 可以使用的文件大小。

这很有帮助，因为 cocos2d 只获取尺寸为 2 次方的图像。(2,4,8,16....) 如果你有一个 50x50 的精灵，它实际上会在你的游戏中占用 64x64 的空间。

这是一个教程，它比我做得更好：[http ://www.raywenderlich.com/2361/how-to-create-and-optimize-sprite-sheets-in-cocos2d-with-texture-packer-和像素格式](http://www.raywenderlich.com/2361/how-to-create-and-optimize-sprite-sheets-in-cocos2d-with-texture-packer-and-pixel-formats)

这是两者都使用的项目：[http ://www.raywenderlich.com/7261/monkey-jump](http://www.raywenderlich.com/7261/monkey-jump)

这是一个带有 levelhelper 和 spritehelper 的：[http ://www.raywenderlich.com/6929/how-to-make-a-game-like-jetpack-joyride-using-levelhelper-spritehelper-part-1](http://www.raywenderlich.com/6929/how-to-make-a-game-like-jetpack-joyride-using-levelhelper-spritehelper-part-1)

有关更多工具的列表，请访问此处"

[http://www.learn-cocos2d.com/2011/06/complete-list-cocos2d-tools/](http://www.learn-cocos2d.com/2011/06/complete-list-cocos2d-tools/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T15:42:44.260

SpriteHelper 与 TexturePacker 本质上是相同的工具。两者都从单个图像创建单个大纹理。

LevelHelper 是一个编辑工具，可以直观地设计您的游戏。它还允许编辑物理世界。

PhysicsEditor 是一个从图像创建物理物体（碰撞）形状的工具。不多也不少。

# .net - 使用 svcutil 生成基于任务的 WCF 服务引用

> ID：14084717
> 
> 赞同：3
> 
> 时间：2012-12-29T18:34:29.990
> 
> 标签：.net, wcf, task, svcutil.exe

我最近阅读了一篇关于在本文中创建基于任务的 WCF 服务引用的[文章](http://www.devcurry.com/2012/12/task-based-wcf-services-in-net-45.html)。

我用来为消费应用程序生成服务引用的机制是在批处理文件中使用 svcutil。

是否可以使用 svcutil 创建基于任务的 wcf 服务引用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:54:49.900

我还没有尝试过，但看起来 svcutil.exe 4.5 版默认包含基于任务的操作。您可以使用“/syncOnly”标志来禁用基于任务的操作。 [来源](http://blogs.msdn.com/b/endpoint/archive/2010/11/13/simplified-asynchronous-programming-model-in-wcf-with-async-await.aspx)

此外，如果要在 Visual Studio 中包含基于任务的操作，则可以在导入 Web 服务时选择该选项。 [来源](http://www.devcurry.com/2012/12/task-based-wcf-services-in-net-45.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-01T19:50:13.613

添加开关`/tcv:version35`。默认情况下，它将生成基于任务的操作（前提是您不应指定`/synconly`开关）。

# menu - 使用模态 Segue 引入时，UINavigationController 中的 MFSideMenu 不起作用

> ID：14084720
> 
> 赞同：2
> 
> 时间：2012-12-29T18:34:43.330
> 
> 标签：menu, uinavigationcontroller, uistoryboard, uistoryboardsegue

我正在尝试将 MFSideMenu 集成到我的项目中，但我不想采用 GitHub 存储库中描述的方法，因为它定义了应用程序委托中的菜单。

我有一个登录屏幕，它将介绍一个导航控制器，其中包含此图片中报告的主页![在此处输入图像描述](../Images/02f5e55f2ddd15c47e0f47549faf8df4.png)

我想使用以下代码在 navigationcontroller 根控制器中添加对 MFSideMenu 的支持：

```
- (id)initWithCoder:(NSCoder *)aDecoder {
    self = [super initWithCoder:aDecoder];
    if (self) {
        // Custom initialization
        self.sideMenuController = [[SideMenuViewController alloc] init];
        UINavigationController *navigationController = self.navigationController;

        MFSideMenuOptions options = MFSideMenuOptionMenuButtonEnabled|MFSideMenuOptionBackButtonEnabled
        |MFSideMenuOptionShadowEnabled;
        MFSideMenuPanMode panMode = MFSideMenuPanModeNavigationBar|MFSideMenuPanModeNavigationController;

        MFSideMenu *sideMenu = [MFSideMenu menuWithNavigationController:navigationController
                                                     sideMenuController:sideMenuController
                                                               location:MFSideMenuLocationLeft
                                                                options:options
                                                                panMode:panMode];

        sideMenuController.sideMenu = sideMenu;

    }
    return self;
} 
```

当我运行应用程序时，菜单按钮出现在我的导航栏中，一切似乎都正常，但是，如果我通过模态 segue 引入导航控制器（即在正确登录的情况下进入导航控制器的登录屏幕）按钮消失。

关于如何解决它的任何想法？

# objective-c - 适用于 iOS 4 的 Xcode 不同视图

> ID：14084722
> 
> 赞同：0
> 
> 时间：2012-12-29T18:34:43.827
> 
> 标签：objective-c, cocoa-touch, ios5, ios4, storyboard

我在我的应用程序中使用情节提要，情节提要需要 iOS 5。

当 iOS 4 设备打开我的应用程序时发生了什么？

我可以将代码放入 iOS 4 设备的 viewDidLoad 中吗？

我想为 iOS 4 创建一个特定的视图，上面写着“需要 iOS 5”这可能吗？

我可以使用这样的东西来检查设备是否运行 iOS 4 或更低版本？：

```
BOOL iOS4 = [[[UIDevice currentDevice] systemVersion] floatValue] <= 5.0; 
```

我可以把这样的东西放进去`viewDidLoad`吗？

```
if(iOS4) {
    // i´m changing view to my "iOS 5 Required" view (XIB File)
} 
```

我没有 iOS 4 设备，这可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:53:54.717

您可以检查 iOS 的版本是否支持故事板：

```
if(NSClassFromString(@"UIStoryboard")) {
    //iOS is supporting storyboards (iOS >= 5.0)

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];  

   //use your storyboard
}else{
    //iOS is not supporting storyboards
    //load viewcontrollers from nib
} 
```

但是，我认为 Apple 不会喜欢这个想法。他们可能会因此拒绝您的应用程序。如果指南中的某些部分告诉您不要这样做，我并不感到惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:44:37.873

您可以使用以下方式获取操作系统版本：

```
[[UIDevice currentDevice] systemVersion] 
```

但是，您应该避免依赖版本字符串作为设备或操作系统功能的指示。通常有一种更可靠的方法来检查特定功能或类是否可用。例如，您可以使用 NSClassFromString 检查 UIPopoverController 在当前设备上是否可用：

```
if(NSClassFromString(@"UIPopoverController")) {
    // Do something
} 
```

一些类，如 CLLocationManager 和 UIDevice，提供了检查设备功能的方法：

```
if([CLLocationManager headingAvailable]) {
    // Do something
} 
```

Apple 在他们的 GLSprite 示例代码中使用 systemVersion，所以我的建议不能是绝对的：

```
// A system version of 3.1 or greater is required to use CADisplayLink. The NSTimer
// class is used as fallback when it isn't available.
NSString *reqSysVer = @"3.1";
NSString *currSysVer = [[UIDevice currentDevice] systemVersion];
if ([currSysVer compare:reqSysVer options:NSNumericSearch] != NSOrderedAscending)
    displayLinkSupported = TRUE; 
```

如果 currSysVer 不高于 reqSysVer，只需执行 else 语句，自动呈现一个新的 modalViewController，上面写着“需要 iOS 5”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:51:11.960

当它需要故事板时，该应用程序将无法在 ios4 下安装......
除非您真的想要它，否则它会显示在应用程序商店中

# android - “selectionArgs”在“selection”查询中不起作用包含“？”

> ID：14084726
> 
> 赞同：1
> 
> 时间：2012-12-29T18:35:13.327
> 
> 标签：android, sqlite

当我`selectionArgs`在查询中使用时，应用程序崩溃 logcat

```
12-30 22:22:05.406: ERROR/AndroidRuntime(532): FATAL EXCEPTION: main
    android.database.sqlite.SQLiteException: near "?": syntax error: , while compiling: DELETE FROM _history WHERE _id in ?
    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:68)
    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:143)
    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:361)
    at android.database.sqlite.SQLiteStatement.acquireAndLock(SQLiteStatement.java:260)
    at android.database.sqlite.SQLiteStatement.executeUpdateDelete(SQLiteStatement.java:84)
    at android.database.sqlite.SQLiteDatabase.delete(SQLiteDatabase.java:1741)
    at ru.sofron.money.db.DataProvider.delete(DataProvider.java:201)
    at android.content.ContentProvider$Transport.delete(ContentProvider.java:213)
    at android.content.ContentResolver.delete(ContentResolver.java:822)
    at ru.sofron.money.activities.HistoryFragment$1.onActionItemClicked(HistoryFragment.java:126)
    at android.widget.AbsListView$MultiChoiceModeWrapper.onActionItemClicked(AbsListView.java:5648)
    at com.android.internal.policy.impl.PhoneWindow$DecorView$ActionModeCallbackWrapper.onActionItemClicked(PhoneWindow.java:2473)
    at com.android.internal.app.ActionBarImpl$ActionModeImpl.onMenuItemSelected(ActionBarImpl.java:757)
    at com.android.internal.view.menu.MenuBuilder.dispatchMenuItemSelected(MenuBuilder.java:735)
    at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:149)
    at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:874)
    at com.android.internal.view.menu.ActionMenuView.invokeItem(ActionMenuView.java:490)
    at com.android.internal.view.menu.ActionMenuItemView.onClick(ActionMenuItemView.java:108)
    at android.view.View.performClick(View.java:3511)
    at android.view.View$PerformClick.run(View.java:14105)
    at android.os.Handler.handleCallback(Handler.java:605)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4424)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

利用

```
String selection = DBColumns.History._ID + " in ?";
                String selectionArgs[] = new String[1];
                selectionArgs[0] = Arrays.toString(mListView.getCheckedItemIds());
                    getActivity().getContentResolver()
                            .delete(DataProvider.HISTORY_URI,
                                    selection,
                                    selectionArgs); 
```

在内容提供者中删除

```
 public int delete(Uri uri, String selection, String[] selectionArgs) {
    int uriType = uriMatcher.match(uri);
    int rowsDeleted;
    switch (uriType) {
        case HISTORY:{
            rowsDeleted = mDb.delete(DBColumns.History.TABLE_NAME, selection,selectionArgs);
        }break;
... 
```

其他查询中也有类似的情况。有人知道问题出在哪里吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T18:45:20.243

您必须`?`为每个值使用一个...

```
String selection = DBColumns.History._ID + " in (?, ?, ?)";
String selectionArgs[] = new String[]{"1","2","3"}; 
```

* * *

[或（来自IN 子句和占位符](https://stackoverflow.com/q/7418849/1267661)中的一个想法）

```
String selectionArgs[] = new String[]{"1","2","3"};
String selection = DBColumns.History._ID + " in (";
for(int i = 0; i < selectionArgs.length; i++)
    selection += "?, ";
selection = selection.substring(0, selection.length() - 2) + ")";
// selection is 'DBColumns.History._ID + " in (?, ?, ?)"' 
```

* * *

> 对不起我的英语

我们都说安卓。:)

# regex - htaccess 问题中的正则表达式

> ID：14084728
> 
> 赞同：0
> 
> 时间：2012-12-29T18:35:21.197
> 
> 标签：regex, .htaccess, uri, expression

我想在我的子域中使用一个短网址，但我有一个问题。它实际上在我的本地主机中运行良好，但是当我将它放在我的在线主机的子域中时，它不起作用。我的子域是这样的：**str.example.com。**所以短网址就像：**str.example.com/h4g784**

我要读取的真实地址是：**str.example.com/url.php?url=h4g784**

**贝娄是我的 htaccess ：**

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule ^(\w+)$ ./url.php?url=$1   
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
```

我不知道为什么会收到 500 内部服务器错误。非常感谢您花时间查看我的代码。

# xampp - 如何在 XAMPP 中使用 PayPal Express Checkout？

> ID：14084731
> 
> 赞同：2
> 
> 时间：2012-12-29T18:35:38.213
> 
> 标签：xampp, localhost, paypal

我正在使用 XAMPP 托管一个网站。该网站使用 PayPal API 进行快速结帐。如果我将网站移动到真正的托管服务器（即 www.website.com），PayPal 结帐系统将正常工作。如果我从 XAMPP (localhost) 使用它，它甚至不会连接到 PayPal。我将如何从我的本地主机上完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:18:56.457

第一步：端口转发。您的路由器有一个公共 IP（不是 127.0.0.1） 配置您的路由器以接受来自互联网的请求。

步骤 2\. 有备用域名吗？配置您的域@您的注册商：将“A”记录指向您新转发的 IP。

步骤 3\. 将伪造的 HTTPS 证书[http://curl.haxx.se/ca/cacert.pem](http://curl.haxx.se/ca/cacert.pem)添加到 XAMPP 安装的根文件夹。

不是最终的一切，比如说，所有的指导方针。棘手，但一个起点。

使用这种方法，您可以测试 Paypal IPN，使用沙箱，所有好东西，以及在您的本地服务器上与所有其他主要供应商的 api 一起玩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:07:52.773

这些链接将对您有所帮助。

[http://demos.ipn-easy.com/Howto/TestEnvironment.aspx](http://demos.ipn-easy.com/Howto/TestEnvironment.aspx)

[我可以从 localhost 测试 paypal api](https://stackoverflow.com/questions/5510995/can-i-test-paypal-apis-from-localhost)

# ajax - 从内部页面进入站点时，jQuery Mobile 哈希导航在多页模板中不起作用

> ID：14084734
> 
> 赞同：3
> 
> 时间：2012-12-29T18:35:49.717
> 
> 标签：ajax, jquery-mobile, navigation

# 概述

我已经使用 jQuery Mobile 建立了一个站点。我遇到的问题是，当我从内部页面（如博客页面）进入网站并单击标题中的导航按钮时，我可以返回主页，但没有基于 ajax/hash 的导航链接有效。在我的标题导航中，我将左侧导航按钮直接与 href 链接，**而不是**使用 data-rel="back"。我不是试图使用按钮来模仿浏览器的后退按钮，而是用于绝对导航。我已经在 Chrome 和 Firefox 的桌面以及在 Mobile Safari 中运行 iOS 5 的 iPhone 上对此进行了测试；所有浏览器的行为都是相同的。

编辑：（注意下面以***粗斜体表示***的具体问题。）

# 什么有效，什么无效

例如，如果您进入内部页面[http://slawson.org/blog/](http://slawson.org/blog/)，然后单击`< Kim`标题中的按钮返回首页，那么您只能进入绝对链接（如博客），但没有基于哈希的链接（“投资组合”和“关于”标题下的其他链接）工作......点击链接不会触发页面转换，而是链接只是闪烁并且什么都不做。

[如果您从主页（ http://slawson.org/](http://slawson.org/)）或主页的子页面之一（如[http://slawson.org/#web](http://slawson.org/#web) ）进入站点，则不会出现此问题。

*   index.html — 包含大多数使用基于哈希的导航的其他页面（**这些不起作用**），例如：

    *   网站
    *   iOS 应用程序
    *   印刷出版物
    *   标志和品牌
    *   ...
*   blog/index.html 和 blog/.../*.html — 通过 JQM 的 ajax 加载器加载的常规页面（**这些工作**）。

# 问题

***从内部页面进入网站时，JQM 和 ajax 导航是否存在问题，或者这可以通过重组事物或在某处添加一些 jQuery 来解决？***我想避免将每个页面分成单独的 html 文件。

# 版本

我正在使用 jQuery 1.8.2 和 jQuery Mobile 1.2.0。

* * *

## 编辑：

我查看了 JQM 多页模板文档和这些相关的 StackOverflow 问题：

*   [jQuery 移动页面导航行为](https://stackoverflow.com/questions/6462686/jquery-mobile-page-navigation-behaviour)
*   [面临 jquerymobile 的多页模板结构中的问题](https://stackoverflow.com/questions/9373680/facing-an-issue-in-jquerymobiles-multi-page-template-stucture?rq=1)
*   [JQuery Mobile - 从外部页面（SinglePage-template）链接到内部页面（MultiPage-template）](https://stackoverflow.com/questions/12828269/jquery-mobile-link-from-external-page-singlepage-template-to-an-internal-pag)

我尝试过的事情：

### 数据网址

我尝试添加`data-url`到 index.html 中的多页，如下所示：

```
<div data-role="page" id="web" data-url="index.html#web" data-title="Kim Slawson | Web Sites" class="shorter-list-items"> 
```

但这没有帮助。

### 数据-rel="外部"

我尝试添加`data-rel="external"`到主页的链接，例如博客页面上导航按钮上的链接：

```
<a href="/" data-rel="external" data-role="button" data-direction="reverse" data-icon="arrow-l">Kim</a> 
```

但这也无济于事。

### 数据-ajax="假"

我尝试添加`data-ajax="false"`到主页的链接，例如博客页面上导航按钮上的链接：

```
<a href="/" data-ajax="false" data-role="button" data-direction="reverse" data-icon="arrow-l">Kim</a> 
```

这有效（即，您可以转到主页，然后所有多页都可以使用）**但是**过渡不会触发到主页。***有没有办法给这个链接添加一个转换，也许是给它一个类，然后使用一些 jQuery 绑定到那个类来触发转换？***或者，还有更好的方法？（值得注意的是，在我将 data-ajax="false" 添加到主页的链接后，后退按钮可以正常工作[。Clement Ho 在这里的回答](https://stackoverflow.com/a/10467124/1821016)暗示添加它会破坏后退按钮，但我没有看到）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:49:58.640

问题是当您单击指向它们的链接时，页面上不存在基于哈希的页面。（`<div data-rolw="page" id="#web">...</div>`不在）

如果您设置了后端框架，则可以在发出非 ajax（初始）请求时返回基于哈希的页面以及请求的页面。然后无论首先加载哪个页面，这些页面都将位于 DOM 中。

另一种选择是，就像你说的，将每一页分成自己的文件。

# java - 在 ListView 上选择选项后如何显示数据？

> ID：14084735
> 
> 赞同：0
> 
> 时间：2012-12-29T18:35:51.193
> 
> 标签：java, android, android-listview

我的 ListView 显示来自数据库的数据，我想要的是，当我单击特定的 ListView 选项时，会启动一个新活动，并在该活动中显示与所选选项相关的数据。

我在打开新活动时没有问题，但无法让该活动知道在 ListView 上选择了哪个选项。

列表视图的代码：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    database = new projectdatabase(ProjectExplorer.this);

    openDatabase();
}

private void openDatabase() {

    database.open();
    cursor = database.getDataforDisplay();
    adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, cursor, new String[] {"project_name"}, new int[] { android.R.id.text1 }, 0);
    setListAdapter(adapter);

}

@Override
public void onListItemClick(ListView parent, View view, int position, long id) {

    super.onListItemClick(parent, view, position, id);

            Intent intent = new intent(this, openactivity.class);
            startActivity(intent);

    //What else to add here?

} 
```

我只想将“project_name”发送到其他活动，以便查询它并检索其他信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:41:54.893

获取`project_name` 列表项单击为：

```
@Override
public void onListItemClick(ListView parent, View view, int position, long id) {

    super.onListItemClick(parent, view, position, id);

      Cursor c = ((SimpleCursorAdapter)parent.getAdapter()).getCursor();
      c.moveToPosition(position);

      // get project name here

      String str_projectname= c.getString(c.getColumnIndex("project_name"));

      Intent intent = new intent(this, openactivity.class);

      intent.putExtra("project_name", str_projectname);

      startActivity(intent);

    //What else to add here?

} 
```

# c - C - (C99) ，如何在不使用 stdlib.h 的情况下创建堆栈结构（不使用 malloc）

> ID：14084742
> 
> 赞同：0
> 
> 时间：2012-12-29T18:36:15.370
> 
> 标签：c, arrays, dynamic, struct, stack

我明天有一个作业，并被要求制作一个动态（可调整大小）堆栈，以节省字符。

这件事一直让我发疯，整天都在做这件事。我使用标准库完成了它，它完成了。但似乎无法弄清楚如何在没有 malloc 的情况下分配内存 .. 帮助将不胜感激。这些是我使用过的一些代码片段（使用 stdlib）：

```
 struct STACK
    {
        int size;
        int capacity;
        char *memory;
        int folder_number;
    };
typedef struct STACK stack; 
```

我的主要开始是这样的：

```
int main()
{
    stack mystack;
    stack_init(&mystack); 
```

初始化栈函数：

```
void stack_init(stack *s)
{
    s->size=1;
    s->capacity=INITIAL_CAPACITY;
    s->memory=malloc(s->capacity);
    s->memory[0]='\0';
    s->folder_number=1;
} 
```

我的程序有各种功能，当我将新字符插入堆栈时，我检查是否已达到最大容量，如果是，我调用以下函数：

```
void double_memory(stack* s)
{
    char *tmp = malloc((s->capacity)*2);

    for (int i=0; i<(s->capacity); i++)
        tmp[i]=s->memory[i];
    free(s->memory);
    s->capacity *= 2;
    s->memory=tmp;
} 
```

现在，我已经连续尝试了至少 6 个小时，试图找出其他方法（不使用 stdlib.h），在谷歌上搜索了很多，但没有成功。任何帮助或建议都是真的！赞赏。

非常感谢您提前。

编辑：我大约 2 个月前开始上大学，我不了解平台..等等，我们学到的最后两件事是指针，以及关于 malloc 的小信息，b4 我们只是了解了函数 hhh ......，在此之前，非常基本的编码..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:30:22.050

使用文件：

```
#include <stdio.h>

struct stack {
        FILE * fp;
        } stack = {NULL} ;
#define ZENAME "zestack"

void stack_init (struct stack *sp);
void stack_exit (struct stack *sp);
void stack_push (struct stack *sp, int ch);
int stack_pop (struct stack *sp);

void stack_init (struct stack *sp)
{
if (sp->fp) fclose(sp->fp);
sp->fp = fopen(ZENAME , "wb+" );
if (!sp->fp) fprintf(stderr, "Fopen(%s) failed\n", ZENAME  );
}

void stack_exit (struct stack *sp)
{
if (sp->fp) fclose(sp->fp);
sp->fp = NULL;
}

void stack_push (struct stack *sp, int ch)
{
fputc(ch, sp->fp);
}

int stack_pop (struct stack *sp)
{
int ch;
long int oldpos, newpos;

if (!sp->fp) return -1;
oldpos = fseek(sp->fp, -1, SEEK_CUR);
if (oldpos < 0) { stack_exit (sp); return EOF; }

ch = fgetc(sp->fp);
newpos = fseek(sp->fp, -1, SEEK_CUR);
fprintf(stderr, "Oldpos = %ld Newpos = %ld\n", oldpos, newpos );
return ch;
}
int main(void)
{

int ch;
stack_init ( & stack);
stack_push ( & stack, '1');
stack_push ( & stack, '2');
stack_push ( & stack, '3');
stack_push ( & stack, '4');

while(1) {

        ch = stack_pop( &stack);
        fprintf(stdout, "Pop = '%c' (0x%x)\n" , ch, (unsigned) ch) ;
        if (ch < 0) break;
        }
return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:46:59.530

`malloc`在大多数符合 POSIX 的平台上，只需在后台使用`mmap`匿名映射......因此您可以调用该函数，而不是使用该`MAP_ANONYMOUS`标志将内存分配到内存池中以供您的堆栈实现使用。这是 LINUX 手册页的链接：http `mmap`: [//www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)

为了有效地使用您分配的内存池，我建议设置某种类型的简单链表内存管理器......换句话说，您想调用`mmap`一次来分配一大块内存，然后使用您自己的用户定义`malloc`并`free`调用管理内存池。

**更新：**根据您的评论，您现在说您不能使用*任何*外部库。因此，您唯一的其他选择是为您的内存池指定一个静态数组，因为在运行时从堆中动态分配内存需要操作系统的干预，而这在没有系统调用的情况下无法完成。

这是一个您可以使用的简单链表内存管理器系统（注意：我还没有调试它，但因为它是家庭作业，那是你的工作:-)

```
static unsigned char heap[MEMORY_POOL_SIZE];

typedef struct memory_block
{
    unsigned long size_bytes;
    unsigned char block[];
} memory_block;

typedef struct free_block
{
    unsigned long size_bytes;
    struct free_block* next;
} free_block;

//initialize our memory pool free-store
static char free_list_initialized = 0;
static free_block* free_list_head = NULL;

void* malloc(unsigned long size_bytes)
{
    //initialize the free-store if it's never been used before
    if (!free_list_initialized)
    {
        free_list_head = (free_block*)&heap[0];
        free_list_head->size_bytes = MEMORY_POOL_SIZE - sizeof(memory_block);
        free_list_head->next = NULL;
        free_list_initialized = 1;
    }

    //search the free-list for a memory block that is at least size_bytes
    free_block* current = free_list_head;
    free_block* prev = NULL;

    while (current != NULL)
    {
        if (current->size_bytes >= (size_bytes + sizeof(free_block)))
            break;

        prev = current;
        current = current->next;
    }

    //did we reach the end of the list without finding anything?
    if (current == NULL)
        return NULL;  //out-of-memory!

    memory_block* temp = NULL;

    //trim the block of memory if the one we found is larger than the requested size
    if (current->size_bytes > (size_bytes + sizeof(free_block)))
    {
        temp = (memory_block*)current;
        current = (free_block*)((unsigned char*)current + size_bytes + sizeof(memory_block));

        current->size_bytes = current->size_bytes - (size_bytes + sizeof(memory_block));
        temp->size_bytes = size_bytes;

        if (prev != NULL)
            prev->next = current;
    }
    else
    {
        prev->next = current->next;
        temp = (memory_block*)current;
    }

    return (void*)&temp->block;
}

void free(void* ptr)
{
    free_block* temp = (free_block*)((unsigned char*)ptr - sizeof(unsigned long));
    temp->next = free_list_head;
    free_list_head = temp;

    return;
} 
```

# asp.net - Web API 模型属性为空

> ID：14084746
> 
> 赞同：5
> 
> 时间：2012-12-29T18:36:33.283
> 
> 标签：asp.net, asp.net-web-api

我的控制器能够创建模型对象，但所有与模型相关并分配给空值的属性

环境：VS 2010，ASP.NET MVC RC 最新，jQuery 1.7.1

以下是 Web API 控制器代码

```
public class Customer
{
    public string Name { get; set; }
    public string City { get; set; }
}
public class UserController : ApiController
{
    public Customer Post(Customer user)
    {
        return user;
    }
} 
```

以下是ajax调用代码

```
$.ajax('/api/user',
{
  ContentType: "application/x-www-form-urlencoded; charset=UTF-8",
  dataType: 'json',
  type: 'POST',
  data: JSON.stringify({ "Name": "Scott", "City": "SC" })
}); 
```

控制器确实创建了模型“客户”对象，但“名称”和“城市”属性均为空。

这里有什么问题？

我在此站点上阅读了许多类似的问题，但找不到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:32:39.870

[This blog](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx) here gives a good idea about how Model Binding differs in ASP.NET Web project and a ASP.NET Web API project.

I was facing a similar issue in the project I was working on and adding a explicit ModelBinding attribute made the property values stick

**Requested Data :**

```
var customer  = { Name : "customer Name", City : "custome City" }

$.ajax({ 
   url : ...
   type: ...
   data : customer
}); 
```

**Request Class:**

```
public class Customer
{
    public string Name { get; set; }
    public string City { get; set; }
} 
```

**Controller :**

```
public class UserController : ApiController
{
    [HttpGet]
    public Customer Get([ModelBinder] Customer user)
    {
        // fetch from whereever
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:19:24.837

我现在正在经历同样的问题。我不是 100% 确定答案，但下面是我的 javascript，我已添加到类 [DataModel] 和属性 [DataMember]。那是：

```
 [DataModel]
    public class Customer
    {
      [DataMember] public string Name { get; set; }
      [DataMember] public string City { get; set; }
    } 
```

还有我的 JavaScript

```
 $(document).ready(function () {
        // Send an AJAX request
        $.getJSON("api/session/GetAll",
        function (data) {
            // On success, 'data' contains a list of products.
            $.each(data, function (key, val) {

                //debugger;

                // Format the text to display.
                //var str = val.Name + ': $' + val.Price;
                var str = 'abcd';

                // Add a list item for the product.
                $('<li/>', { text: str })
                .appendTo($('#products'));
            });
        });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-25T15:21:31.887

下次发生这种情况时，请确保属性设置器上没有“内部”关键字。即：而不是`public string Comment {get; internal set;}` 使用`public string Comment {get; set;}`

这为我修好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-24T06:51:46.853

遇到了类似的问题，我的问题原来是请求正文中的无效 JSON。在其中一个字段之后缺少逗号。因此，如果 JSON 中存在任何语法错误，默认模型绑定器似乎只是绑定 null。

# facebook - Facebook 不会从我博客的帖子 URL 中抓取图片

> ID：14084748
> 
> 赞同：3
> 
> 时间：2012-12-29T18:36:53.157
> 
> 标签：facebook, image, url, facebook-graph-api, facebook-page

我在 Facebook 上有一个博客和同一个博客的粉丝页面。每天，我都会在 Facebook 粉丝页面上手动发布我的博客文章。直到一周前，我所要做的只是粘贴帖子的 URL，然后 Facebook 抓取工具提取与帖子相关的所有图像，以及元数据和帖子摘录。我选择了我喜欢的图片并发布了帖子。

但一周前，当我输入 URL 时，Facebook 总是绘制相同的图片，就好像他无法检测到 URL 中的图像一样。我该如何解决这个问题？任何想法？

我的博客是[http://applediario.com](http://applediario.com)，我的粉丝页面是[https://www.facebook.com/applediario](https://www.facebook.com/applediario)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:20:39.557

您应该在 Open Graph 元标记中添加 og:image 标记。

在这里阅读：

[http://www.hongkiat.com/blog/facebook-open-graph-wordpress/](http://www.hongkiat.com/blog/facebook-open-graph-wordpress/)

# javascript - 将图像显示到动态表中

> ID：14084749
> 
> 赞同：0
> 
> 时间：2012-12-29T18:36:57.677
> 
> 标签：javascript, image, cell

我有一个表格，它是根据用户对表格的输入生成的。这会生成行和列。我希望节点充满图像。我正在获取表格，但节点充满了 [object HTML image element]？我认为这是试图访问图像但失败了？这是我尝试过的。所有帮助表示赞赏。

```
 for (r = 0; r < howOften; r++) {
    row = table.insertRow(-1);

    for (c = 0; c < numDays; c++) {
        col = row.insertCell(-1);
        img=new Image();
        img.src="../www/images/TEST.png";
        col.appendChild(document.createTextNode(img));
    };
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:39:57.647

您只是粘贴图像对象包含的实际文本，这绝对不是您想要做的。尝试类似以下的操作。

```
img.onload = function() { //check to make sure that the image has loaded
    col.appendChild(img);
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:51:01.063

如果您想使用[jQuery](http://www.jquery.com)，这是解决方案之一

在 html 中：

```
<div id="container"></div> 
```

在 js 中：

```
var table = $('<table></table>');

for (r = 0; r < howOften; r++) {
  var row = $('<tr></tr>');
    for (c = 0; c < numDays; c++) {
     row.append('<td><img src="../www/images/TEST.png" /></td>');
    };
    table.append(row);
};

$('#container').append(table); 
```

# java - 无法在 Tomcat 上运行 webapp，错误 51，尽管 java -version 是正确的，Mac OS X

> ID：14084751
> 
> 赞同：0
> 
> 时间：2012-12-29T18:37:00.590
> 
> 标签：java, macos, tomcat, osx-mountain-lion

我在我的 Mac 上安装了 Java 7，编译了一个网络应用程序，现在我正试图在 Tomcat 上运行它。但是，我得到了令人讨厌的`Unsupported major.minor version 51.0`错误。谷歌搜索显示这是因为 Tomcat 使用 Java 6 运行该应用程序，该应用程序是为 Java 7 编译的。

因此，我尝试在“catalina.sh”脚本中设置 Java 7 jre 的路径，但没有帮助。此外，“java -version”返回正确的 java 版本。

```
`dtv$ java -version
java version "1.7.0_10"
Java(TM) SE Runtime Environment (build 1.7.0_10-b18)
Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)`
```

`我怎样才能解决这个问题？`

 `* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:59:43.847

尝试将 JAVA_HOME 环境变量设置为指向您的 JDK 7。Catalina 期望在那里找到 Java。看看这是否告诉它如何获取 JDK 7。`

# installation - 在 CMake 中使用 install() 时保留单个文件的权限

> ID：14084759
> 
> 赞同：12
> 
> 时间：2012-12-29T18:37:30.790
> 
> 标签：installation, cmake

在 KDE 中，我调整了一个宏来编译和安装 Python 文件，但我在保持文件权限方面遇到了问题。

更清楚地说，宏中令人讨厌的行是

```
install(FILES ${SOURCE_FILE} DESTINATION ${DESTINATION_DIR}) 
```

这适用于 99% 的情况。

在一种情况下，虽然我在源目录中有一个标记为可执行文件（+x，我在这里谈论的是 Linux）的 Python 文件，然后它被符号链接到安装的二进制目录。由于 install() 不保留权限，执行位被从中剥离，这会导致以后出现各种问题。

是否可以保留文件的权限，或者读取它们并相应地设置它们？我讨厌使用手动`chmod`命令，因为它不可移植。

编辑：我不想让这个宏安装的所有文件都可执行，因为这毫无意义。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-30T09:21:01.887

`+x`您可以使用许可安装文件

```
install(PROGRAMS ... 
```

命令。

或者，您可以安装保留文件权限的整个目录：

```
install(DIRECTORIES ... USE_SOURCE_PERMISSIONS) 
```

[有关更多信息，请参阅安装命令的文档](http://cmake.org/cmake/help/v2.8.10/cmake.html#command%3ainstall)。

# c++ - 如何打印一堆具有相同格式的整数？

> ID：14084762
> 
> 赞同：3
> 
> 时间：2012-12-29T18:37:51.860
> 
> 标签：c++, c++11, code-duplication, iomanip

`'0'`我想用填充字符在 2 个字段上打印一堆整数。我可以做到，但这会导致代码重复。我应该如何更改代码以便可以排除代码重复？

```
#include <ctime>
#include <sstream>
#include <iomanip>
#include <iostream>

using namespace std;

string timestamp() {

    time_t now = time(0);

    tm t = *localtime(&now);

    ostringstream ss;

    t.tm_mday = 9; // cheat a little to test it
    t.tm_hour = 8;

    ss << (t.tm_year+1900)
       << setw(2) << setfill('0') << (t.tm_mon+1) // Code duplication
       << setw(2) << setfill('0') <<  t.tm_mday
       << setw(2) << setfill('0') <<  t.tm_hour
       << setw(2) << setfill('0') <<  t.tm_min
       << setw(2) << setfill('0') <<  t.tm_sec;

    return ss.str();
}

int main() {

    cout << timestamp() << endl;

    return 0;
} 
```

我试过了

```
std::ostream& operator<<(std::ostream& s, int i) {

    return s << std::setw(2) << std::setfill('0') << i;
} 
```

但它没有用，`operator<<`电话是模棱两可的。

* * *

**编辑**我得到了 4 个很棒的答案，我选择了一个可能是最简单和最通用的答案（也就是说，不假设我们正在处理时间戳）。对于实际问题，我可能会使用[`std::put_time`](http://en.cppreference.com/w/cpp/io/manip/put_time)orthough [`strftime`](http://linux.die.net/man/3/strftime)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2021-03-05T04:40:15.610

在 C++20 中，您将能够以不[`std::format`](https://en.cppreference.com/w/cpp/utility/format/format)那么冗长的方式做到这一点：

```
 ss << std::format("{}{:02}{:02}{:02}{:02}{:02}",
                      t.tm_year + 1900, t.tm_mon + 1, t.tm_mday,
                      t.tm_hour, t.tm_min, t.tm_sec); 
```

使用直接支持格式化[的 {fmt} 库](https://github.com/fmtlib/fmt)更容易：`tm`

```
auto s = fmt::format("{:%Y%m%d%H%M%S}", t); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T19:09:13.393

您需要这样的字符串流代理：

```
struct stream{
    std::ostringstream ss;
    stream& operator<<(int i){
        ss << std::setw(2) << std::setfill('0') << i;
        return *this; // See Note below
    }
} ss; 
```

那么您的格式化代码将是这样的：

```
ss << (t.tm_year+1900)
   << (t.tm_mon+1)
   << t.tm_mday
   << t.tm_hour
   << t.tm_min
   << t.tm_sec;

return ss.ss.str(); 
```

附言。请注意我的 stream::operator<<() 的一般格式，它首先完成它的工作，然后返回一些东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T19:11:55.760

“显而易见”的解决方案是使用操纵器安装一个自定义`std::num_put<char>`方面，该方面只是根据需要格式化`int`s。

上面的陈述可能有点神秘，尽管它完全描述了解决方案。下面是实际实现逻辑的代码。第一个成分是一个特殊的`std::num_put<char>` *方面*，它只是一个派生`std::num_put<char>`并覆盖它的一个`virtual`函数的类。used facet 是一个过滤 facet，它查看与流一起存储的标志（使用`iword()`）以确定它是否应该改变行为。这是代码：

```
class num_put
    : public std::num_put<char>
{
    std::locale loc_;
    static int index() {
        static int rc(std::ios_base::xalloc());
        return rc;
    }
    friend std::ostream& twodigits(std::ostream&);
    friend std::ostream& notwodigits(std::ostream&);

public:
    num_put(std::locale loc): loc_(loc) {}
    iter_type do_put(iter_type to, std::ios_base& fmt,
                     char fill, long value) const {
        if (fmt.iword(index())) {
            fmt.width(2);
            return std::use_facet<std::num_put<char> >(this->loc_)
                .put(to, fmt, '0', value);
        }
        else {
            return std::use_facet<std::num_put<char> >(this->loc_)
                .put(to, fmt, fill, value);
        }
    }
}; 
```

主要部分是`do_put()`决定如何格式化值的成员函数：如果 in 中的标志`fmt.iword(index())`非零，它将宽度设置为`2`并使用填充字符调用格式化函数`0`。无论如何，宽度都会被重置，并且填充字符不会与流一起存储，即不需要任何清理。

通常，代码可能存在于单独的翻译单元中，并且不会在标题中声明。在头文件中真正声明的唯一函数是`twodigits()`并且在这种情况下`notwodigits()`被制成`friend`s 以提供对`index()`成员函数的访问。`index()`成员函数只是分配一个在调用时间时可用的索引，`std::ios_base::iword()`然后它只返回这个索引。*操纵者* `twodigits()`主要设置这个`notwodigits()`索引。如果`num_put`没有为流安装构面，`twodigits()`也会安装构面：

```
std::ostream& twodigits(std::ostream& out)
{
    if (!dynamic_cast<num_put const*>(
             &std::use_facet<std::num_put<char> >(out.getloc()))) {
        out.imbue(std::locale(out.getloc(), new num_put(out.getloc())));
    }
    out.iword(num_put::index()) = true;
    return out;
}

std::ostream& notwodigits(std::ostream& out)
{
    out.iword(num_put::index()) = false;
    return out;
} 
```

`twodigits()`操纵器`num_put`使用`new num_put(out.getloc())`. 它不需要任何清理，因为在`std::locale`对象中安装构面会进行必要的清理。使用 访问原始`std::locale`流`out.getloc()`。它被刻面改变。从理论上讲，`notwodigits`可以恢复原始`std::locale`而不是使用标志。但是，`imbue()`这可能是一项相对昂贵的操作，使用标志应该便宜很多。当然，如果有很多类似的格式化标志，事情可能会变得不同......

为了演示操纵器的使用，下面有一个简单的测试程序。它设置了`twodigits`两次格式化标志，以验证 facet 只创建一次（创建一个`std::locale`s 链来通过格式化有点傻：

```
int main()
{
    std::cout << "some-int='" << 1 << "' "
              << twodigits << '\n'
              << "two-digits1='" << 1 << "' "
              << "two-digits2='" << 2 << "' "
              << "two-digits3='" << 3 << "' "
              << notwodigits << '\n'
              << "some-int='" << 1 << "' "
              << twodigits << '\n'
              << "two-digits4='" << 4 << "' "
              << '\n';
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T21:43:47.280

除了使用[`std::setw`](http://en.cppreference.com/w/cpp/io/manip/setw)/[`std::setfill`](http://en.cppreference.com/w/cpp/io/manip/setfill)或[`ios_base::width`](http://en.cppreference.com/w/cpp/io/ios_base/width)/格式化整数之外[`basic_ios::fill`](http://en.cppreference.com/w/cpp/io/basic_ios/fill)，如果您想格式化日期/时间对象，您可能需要考虑使用[`std::put_time`](http://en.cppreference.com/w/cpp/io/manip/put_time)/[`std::gettime`](http://en.cppreference.com/w/cpp/io/manip/get_time)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T20:11:41.350

为了方便输出格式，您可以使用[`boost::format()`](http://www.boost.org/doc/libs/1_52_0/libs/format/)-like`sprintf`格式选项：

```
#include <boost/format.hpp>
#include <iostream>

int main() {
    int i1 = 1, i2 = 10, i3 = 100;
    std::cout << boost::format("%03i %03i %03i\n") % i1 % i2 % i3; 
    // output is: 001 010 100
} 
```

很少的代码重复，额外的实现工作是微不足道的。

* * *

如果您只想输出时间戳的格式，您显然应该使用[`strftime()`](http://linux.die.net/man/3/strftime). 这就是它的用途：

```
#include <ctime>
#include <iostream>

std::string timestamp() {
    char buf[20];
    const char fmt[] = "%Y%m%d%H%M%S";
    time_t now = time(0);
    strftime(buf, sizeof(buf), fmt, localtime(&now));
    return buf;
}

int main() {
    std::cout << timestamp() << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T18:50:13.153

`operator<<(std::ostream& s, int i)`是“模棱两可的”，因为这样的功能已经存在。

您需要做的就是给该函数一个不冲突的签名。

# c++ - 如何让精神的 qi::as_string 与重复一起工作？

> ID：14084769
> 
> 赞同：2
> 
> 时间：2012-12-29T18:38:33.550
> 
> 标签：c++, c++11, boost-spirit, boost-spirit-qi, boost-spirit-lex

出于某种奇怪的原因，我无法`qi::as_string[]`使用`repeat()[]`.

解析`std::string str = { "{ +100S+++ ;\n }" };`，我得到以下**OUTPUT**

```
PLUS OR MINUS+
THREE PLUS OR MINUS
PARSED FINE
-------------------------
Parsing succeeded
------------------------- 
```

这表明解析是好的，第一个`+`被捕获，但不是随后的三个`+++`。

**注意**我只是想`three_plus_or_minus`连续捕获一到三个优点或缺点作为字符串。不使用的替代解决方案也`as_string[]`将受到赞赏。

对于冗长的清单，我深表歉意，但我需要在我的真实代码中同时使用词法分析器和解析器。

**代码**

```
// --------------  Third Party  --------------
#include <boost/config/warning_disable.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/lex_lexertl.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>

// --------------  C++ stdlib   --------------
#include <iostream>
#include <fstream>
#include <string>

using namespace boost::spirit;
using boost::phoenix::val;

enum token_ids
{
    ID_CONSTANT = 1000,
        ID_INTEGER,
        ID_TAG,
    ID_IDENTIFIER
};

template <typename Lexer>
struct example6_tokens : lex::lexer<Lexer>
{
    example6_tokens()
    {
        identifier = "[a-zA-Z_][a-zA-Z0-9_]*";
        constant   = "[0-9]+";

        tag           = "sl|s|l|tl|SL|S|L|TSL|"    
                                    "z|r|i|Z|R|I|"              
                                    "<>|><|<<>>|>><<|><><|<><>";

        this->self = lex::token_def<>('(') | ')' | '{' | '}' 
            | '=' | ';' | ':' | '+' | '-';

        this->self.add
        (constant,        ID_CONSTANT       )
        (tag,             ID_TAG            )
        (identifier,      ID_IDENTIFIER     )
        ;

        this->self("WS")
            =   lex::token_def<>("[ \\t\\n]+")
                |   "\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\/"
                |   "\\/\\/[^\n]*"
                ;
    }
    lex::token_def<std::string>   identifier, tag;
    lex::token_def<unsigned int>  constant;
};

// ----------------------------------------------------------------------------
template <typename Iterator, typename Lexer>
struct example6_grammar
        : qi::grammar<Iterator, qi::in_state_skipper<Lexer> >
{
    template <typename TokenDef>
    example6_grammar(TokenDef const& tok)
        : example6_grammar::base_type(program)
    {
        using boost::spirit::_val;

        program
            =  +block
               ;

        block
            =   '{' >> *slsltl_stmt >> '}'
                ;

        plus_or_minus
                %=   ( qi::as_string[ qi::lit( '+' ) ] | qi::as_string[ '-' ])
                    [
                 std::cout << val("PLUS OR MINUS") << val( _1 ) << "\n"
                    ]
                        ;

        three_plus_or_minus
                %=   ( qi::as_string[ repeat(1,3)['+'] ] | qi::as_string[ repeat(1,3)['-'] ] )
                    [
                 std::cout << val("THREE PLUS OR MINUS") << val( _1 ) << "\n"
                    ]
                        ;

        slsltl_stmt
        =  (  - plus_or_minus
                    >> token(ID_CONSTANT) 
                    >> token(ID_TAG)
                    >> three_plus_or_minus
                    >> ';'
                )
                        [
                    std::cout << val("PARSED FINE") << "\n"
                        ]
                ;

        expression
            =   tok.identifier [ _val = _1 ]
                |   tok.constant   [ _val = _1 ]
                ;
    }

    typedef boost::variant<unsigned int, std::string> expression_type;

    qi::rule<Iterator, qi::in_state_skipper<Lexer> > program, block;
    qi::rule<Iterator, std::string(), qi::in_state_skipper<Lexer> > 
        plus_or_minus, three_plus_or_minus;
    qi::rule<Iterator, std::string(), qi::in_state_skipper<Lexer> > slsltl_stmt;
    qi::rule<Iterator, expression_type(), qi::in_state_skipper<Lexer> >  expression;
};

int
main( int argv, char* argc[] )
{
    typedef std::string::iterator base_iterator_type;
    typedef lex::lexertl::token<
    base_iterator_type, boost::mpl::vector<unsigned int, std::string>
    > token_type;

    typedef lex::lexertl::lexer<token_type> lexer_type;
    typedef example6_tokens<lexer_type> example6_tokens;
    typedef example6_tokens::iterator_type iterator_type;
    typedef example6_grammar<iterator_type, example6_tokens::lexer_def> example6_grammar;

    example6_tokens tokens;                         // Our lexer
    example6_grammar calc(tokens);                  // Our parser
    std::string str = { "{ +100S+++ ;\n }" };

    std::string::iterator it = str.begin();
    iterator_type iter = tokens.begin(it, str.end());
    iterator_type end = tokens.end();

    std::string ws("WS");
    bool r = qi::phrase_parse(iter, end, calc, qi::in_state(ws)[tokens.self]);
    if (r && iter == end)
    {
        std::cout << "-------------------------\n";
        std::cout << "Parsing succeeded\n";
        std::cout << "-------------------------\n";
    }
    else
    {
        std::cout << "-------------------------\n";
        std::cout << "Parsing failed\n";
        std::cout << "-------------------------\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:06:50.527

尝试

```
 slsltl_stmt %=  /*....*/; 
```

而不是`slsltl_stmt =`. 语义动作的使用禁用自动属性传播。

（我还没有看过你的代码的其余部分。可能有更多的地方需要调整这个/其他的东西）

* * *

**编辑**

我做了更多测试，并认为这符合您的预期：

```
three_plus_or_minus
        =   (qi::as_string[ repeat(1,3)[qi::char_('+')] | repeat(1,3)[qi::char_('-')] ])
            [ std::cout << val("THREE PLUS OR MINUS") << _1 << "\n" ]
                ; 
```

一个开箱即用的问题：你为什么要使用 Lexer？有一个令牌没有意义`+++`吗？

# python - 运行 Pyserial 时出错

> ID：14084770
> 
> 赞同：1
> 
> 时间：2012-12-29T18:38:36.343
> 
> 标签：python, serial-port, arduino, pyserial

我刚刚安装了 Pyserial 2.6 并且我有 Python 2.7.3 不幸的是它要么没有正确安装，要么我没有正确使用它。我使用该行通过终端安装它

```
sudo easy_install pyserial 
```

不幸的是，它给了我两个警告：

```
warning: no files found matching 'examples/miniterm.py'
warning: no files found matching 'test/test_io_lib.py' 
```

除此之外，它似乎安装正确。

当我在 Python 中运行它时，我不断收到更远的错误

```
import serial
serial_input = serial.Serial('/dev/tty/.usbmodem3d241',9600)
while True:
    ser.readline() 
```

错误：

```
Traceback (most recent call last):
  File "/Users/ben/Documents/Arduino_to_Python.py", line 5, in <module>
    serial_input = serial.Serial('/dev/tty/.usbmodem3d241',9600)
  File "build/bdist.macosx-10.7-intel/egg/serial/serialutil.py", line 261, in __init__
    self.open()
  File "build/bdist.macosx-10.7-intel/egg/serial/serialposix.py", line 278, in open
    raise SerialException("could not open port %s: %s" % (self._port, msg))
SerialException: could not open port /dev/tty/.usbmodem3d241: [Errno 20] Not a directory: '/dev/tty/.usbmodem3d241' 
```

无论我尝试什么串行端口，它似乎都无法正常工作。我已经尝试了 Arduino 程序 Tools>Serial Port 中的那些以及[http://pyserial.sourceforge.net/shortintro.html#opening-serial-ports上的所有提示](http://pyserial.sourceforge.net/shortintro.html#opening-serial-ports)

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-28T09:26:45.263

这`serial_input = serial.Serial('/dev/tty/.usbmodem3d241',9600)`应该没有额外`/.`的`/dev/tty`和`usbmodem3d241`。

另外，打开您的控制台并查看是否`ttyusbmodem3d241`存在。`cd /dev`然后在控制台中输入`ls`并查看它是否列出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-19T03:15:36.800

从左上角的菜单转到arduino ide->工具->端口->看看你的端口在串行端口下说什么我说COM3（Arduino.....）在python中serial_input = serial.Serial（'portName'，9600 )

我的是 COM3 serial_input = serial.Serial('COM3',9600)

我知道为时已晚，但还是添加了它。

# matlab - 在 MATLAB GUIDE 中将当前图像写入轴上

> ID：14084775
> 
> 赞同：0
> 
> 时间：2012-12-29T18:39:32.423
> 
> 标签：matlab, matlab-guide, axes

我的 GUI 有问题。在我的打开函数中，我将一个`img_new`变量定义为我存储的图像。

我的 GUI 有两个轴，一个显示原始图像，另一个显示过滤后的图像。我在带有 4 个单选按钮的面板中有 4 个过滤器。在每个代码的末尾都有`img_new`= 通过单选按钮过滤器创建的图像。

这是一些代码：

```
% --- Executes when selected object is changed in uipanel3.
function uipanel3_SelectionChangeFcn(hObject, eventdata, handles)
handles.count = handles.count + 1;

% Change filter orientation depending on which radiobutton is chosen
switch get(eventdata.NewValue,'Tag')
    case 'hte'
        h_te = zeros(handles.rows, handles.colums);

        # code of the filter...

        axes(handles.axes2);
        imshow(h_te);

        handles.img_new = h_te;

    case 'hc'
        h_c = zeros(handles.rows, handles.colums);

        # code of the filter...

        axes(handles.axes2);
        imshow(h_c);

        handles.img_new = h_c;

    case 'vlr'
        v_lr = zeros(handles.rows, handles.colums);

        # code of the filter...

        axes(handles.axes2);
        imshow(v_lr);

        handles.img_new = v_lr;

    case 'vc'
        v_c = zeros(handles.rows, handles.colums);

        # code of the filter...

        axes(handles.axes2);
        imshow(v_c);

        handles.img_new = v_c;

end
guidata(hObject, handles) 
```

这是`imwrite`功能：

```
% --------------------------------------------------------------------
function save_img_ClickedCallback(hObject, ~, handles)
% writing the new image
imwrite(handles.img_new, strcat('filtered_image_', num2str(handles.count), '.png'));
guidata(hObject, handles) 
```

这是将图像获取到`axes1` 原始图像并将其过滤为`axes2`（已过滤）的功能

```
% --- Executes on button press in img2.
function img2_Callback(hObject, ~, handles)
% Read image 2
img = imread('./coimbra_estadio.jpg');
handles.img_d = im2double(img);

% image size
size_img = size(handles.img_d);
handles.colums = size_img(2);
handles.rows = size_img(1);

if rem(handles.rows,2) == 0
    handles.row_0 = ((handles.rows/2)+1);
else
    handles.row_0 = ((handles.rows/2)+0.5);
end

if rem(handles.colums,2) == 0
    handles.colum_0 = ((handles.colums/2)+1);
else
    handles.colum_0 = ((handles.colums/2)+0.5);
end

axes(handles.axes1);
imshow(img);

% Generate eventdata to call the radiobuttons function
eventdata_new.EventName = 'SelectionChanged';
eventdata_new.OldValue = get(handles.uipanel3,'SelectedObject');
eventdata_new.NewValue = get(handles.uipanel3,'SelectedObject');

uipanel3_SelectionChangeFcn(handles.uipanel3, eventdata_new, handles);
guidata(hObject, handles) 
```

如您所见，最后我调用了面板函数，因此在加载图像时会自动过滤并`axes2`更改图像。

问题是当我调用 save 函数时，它会保存旧的`img_new`.

如果我更改单选按钮，`img_new`则会刷新，但如果未更改，则不会刷新。它应该像加载图像自动调用单选按钮功能面板一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:50:08.300

问题是`guidata(hObject,handles);`在`img2_Callback`将旧句柄对象保存为最终 gui 状态时，所做的更新`uipanel3_SelectionChangeFcn`会丢失。您需要`uipannel3_SelectionChangeFcn`通过 put `handles = guidata(hObject,handles);` or调用后手动更新句柄`handles=guidata(hObject);` （忘记了对 guidata 的哪个调用更新句柄，请参阅帮助），或者只是删除`guidata(hObject,handles);`img2_callback 末尾的行（如果代码稍后要更改，则安全性较低，更新处理后`uipannel3_SelectionChangeFcn`是更安全的方法......

# java - 从二维坐标数组创建路径供 AI 遵循

> ID：14084778
> 
> 赞同：1
> 
> 时间：2012-12-29T18:39:39.573
> 
> 标签：java, arrays, artificial-intelligence, path-finding

我正在制作一个简单的塔防游戏，我希望我派出的任何一波单位都跟随地图上的路径，路径由物体组成，并且该物体是路径，塔还是草在地图时决定从文本文件加载。

我用它来填充一个二维数组，其中包含每个“路径”对象的 X 和 Y 坐标，剩余的空间设置为 0。

我的计划是每次加载新关卡时都执行此操作，然后计算出数组中的哪些坐标是从屏幕左侧到右侧的角，如果路径循环返回并说路径的第 7 个角，这将无法正常工作现在更靠近屏幕的左侧，然后是第二个角落，所以现在我卡住了。

我的大脑现在一片空白，任何想法都会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:56:38.077

刚刚有了一个想法，我的所有路径对象都是在从地图文本文件中读取“x”时创建的，所以如果我将地图中的所有角从“x”更改为“1”和“2”等等我仍然可以使它们成为路径对象，同时将每个角从 1 到末尾以正确的顺序添加到数组中，并且数组中所有剩余的空间都可以设置为最后一个角！

希望这可以帮助任何有同样问题的人我回答了我自己的问题：P 但随时添加任何内容

# windows-phone-8 - ContextMenu 的 MenuItem DataContext 返回旧项

> ID：14084779
> 
> 赞同：7
> 
> 时间：2012-12-29T18:39:50.043
> 
> 标签：windows-phone-8, wpftoolkit

我在 LongListSelector 中使用 ContextMenu，以便我可以删除绑定到 LLS 的列表中的一些项目。

我正在按照最近的指南[来](http://www.windowsphonegeek.com/articles/the-new-longlistselector-control-in-windows-phone-8-sdk-in-depth)实现 LLS（尽管我没有使用 JumpList）。我唯一改变的是让基组类扩展 ObservableCollection 而不是 List。

我遇到的问题是，一旦我实现了 ContextMenu 并从那里删除，我可以从可见列表中的同一“位置”删除两次，然后它就会崩溃。调试显示，在第二次删除后，MenuItem 的 Datacontext 返回上一个被删除的项。所以当我在列表中搜索它时，我得到的索引是-1。我可以抓住这一点，但我不知道如何找出真正选择的项目。

我的 contextMenu 的 XAML 部分如下：

```
<phone:LongListSelector.ItemTemplate>
    <DataTemplate>
        <Grid toolkit:TiltEffect.IsTiltEnabled="True">
            <toolkit:ContextMenuService.ContextMenu>
                <toolkit:ContextMenu  x:Name="conmen" Loaded="ContextMenu_Loaded">
                      <toolkit:MenuItem Header="Delete" Click="DeleteItem_Click"/>
                </toolkit:ContextMenu>
            </toolkit:ContextMenuService.ContextMenu>

             <Grid.ColumnDefinitions>
                 <ColumnDefinition Width="Auto"/>
                 <ColumnDefinition Width="*"/>
                 <ColumnDefinition Width="Auto"/>
             </Grid.ColumnDefinitions>

             <Border Grid.Column="0" Background="{StaticResource PhoneInverseBackgroundBrush}" Padding="{StaticResource PhoneTouchTargetOverhang}">
                 <TextBlock Text="{Binding Usr, StringFormat='x{0}'}" FontSize="32" HorizontalAlignment="Left" Width="48"/>
             </Border>

             <Border Grid.Column="1" Background="{StaticResource PhoneInverseBackgroundBrush}" Padding="{StaticResource PhoneTouchTargetOverhang}">
                 <TextBlock Text="{Binding Name}" FontSize="32" HorizontalAlignment="Left" />
             </Border>

             <Border Grid.Column="2" Background="{StaticResource PhoneInverseBackgroundBrush}" Padding="{StaticResource PhoneTouchTargetOverhang}">
                <TextBlock Text="{Binding Type, StringFormat=\{0:C\}}" FontSize="32" HorizontalAlignment="Right" />
             </Border>
        </Grid>
    </DataTemplate>
</phone:LongListSelector.ItemTemplate> 
```

这是删除项目的 delete_click 函数的开始：

```
 private void DeleteItem_Click(object sender, RoutedEventArgs e)
    {            
        var menItem = (MenuItem)sender;
        editCartItem = (Model.Cartitem)menItem.DataContext;

        cartIndex = editCartItem.Id;

        deleteIndex = this.cartList.FindIndex(FindItem); 
```

两次删除后，(Model.Caritem)menItem.DataContext 返回之前删除的项。

我一直在寻找一段时间，并发现了几年前不同框架和场景的类似案例。我想知道在 WP8 中是否有更新的方法来执行此操作。

我已经看到使用 Loaded 或 Opened 事件手动重新分配 ContextMenu 的数据上下文的建议，但 DataContext 仍然依赖于 LLS 中的特定项目。所以我不能只将它的上下文指向 LLS。

我还看到它被指出为带有补丁的错误，[这](http://silverlight.codeplex.com/workitem/7888)似乎与我的问题完全一样，但我不知道如何应用补丁，甚至不知道它是否与我使用 WP8 的情况有关。

我也一直在确保 LLS 的选定项目被清除，并尝试在每次操作后重新分配它的 itemSource 无济于事。

任何朝着正确方向的帮助或建议都会很棒。我在这里看到了一些关于此的帖子，但我相信我已经通过了这些要点（例如简单地获取 menuItem 并使用 ObservableCollection ...）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-26T05:30:41.343

xml:

```
<toolkit:ContextMenu Opened="ContextMenu_Opened">... </toolkit:ContextMenu> 
```

C＃

```
private void ContextMenu_Opened(object sender, RoutedEventArgs e)
{
    var menu = (ContextMenu)sender;
    var owner = (FrameworkElement)menu.Owner;
    if (owner.DataContext != menu.DataContext)
        menu.DataContext = owner.DataContext;
} 
```

您可以看到：[Windows Phone Toolkit 上下文菜单项在删除然后添加项时绑定了错误的对象](https://stackoverflow.com/questions/15181441/windows-phone-toolkit-context-menu-items-have-wrong-object-bound-to-them-when-an)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T11:05:07.133

我刚刚遇到了一个类似的问题：

将项目添加到列表框时，属于新添加项目的菜单项的数据上下文设置不正确。

我最终实施的解决方法是在添加项目后重建列表框：

```
 MyListBox.ItemsSource = null;
        MyListBox.Items.Clear( );
        MyListBox.ItemsSource = theList; 
```

不确定，如果也适用于您的问题...
还应考虑包含许多项目的列表框的性能影响。

# java - 嵌入式 Derby 数据库是否放入 Java jar 中？

> ID：14084786
> 
> 赞同：0
> 
> 时间：2012-12-29T18:40:31.830
> 
> 标签：java, mysql, derby

我正在使用 java 中的项目，我需要同时拥有应用程序和数据库才能在 USB 上。我在想：

1) 在 USB 上安装 MySQL。但是我不知道如何以这种方式连接到我的数据库。我也不知道如何将项目从我的开发环境转移到客户端环境。

或者

2）使用像derby这样的嵌入式数据库。我会将我的应用程序打包在 jar 中并将其提供给客户端。然后，他可以将其保存在 USB 上并从他们那里运行。在这种情况下，数据库将存储在哪里？它会存储在jar文件中吗？如果是这样，在这些情况下如何更新我的数据库？我可以使用 derby 的 ij 工具吗？我对德比比较陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:05:09.823

有关 Derby 及其功能的精彩介绍，请遵循本系列教程：[http ://db.apache.org/derby/docs/10.9/getstart/cgstutorialintro.html](http://db.apache.org/derby/docs/10.9/getstart/cgstutorialintro.html)

# c++ - C++ 将图像保存为 SVG

> ID：14084788
> 
> 赞同：1
> 
> 时间：2012-12-29T18:40:50.270
> 
> 标签：c++, windows, svg

我必须将我的图表保存为 SVG 文件（我的环境`C++`、、、`eclipse C/C++`）`windows 7`。我可以将其保存为图像文件（如下所示），但这还不够。

![在此处输入图像描述](../Images/14cc6db0fd18056909617e7c26d6be74.png)

我试过了：

*   **[gnuplot](http://www.gnuplot.info/)** (`gnuplot_i.hpp`): 不知道如何将图像保存为 SVG 文件
*   **[simple-svg](http://code.google.com/p/simple-svg/)** : 不知道如何不显示黑点
*   **[cairo](http://cairographics.org/)**：我根本无法使用它

你能推荐我一些轻量级且**易于理解和安装的**工具，它可以帮助我绘制图表`C++`并将其**直接**保存为 SVG 文件（所以没有什么像`jpg2svg convertor`:-)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:00:18.380

我知道在命令行 gnuplot 中，可以通过执行以下操作将绘图保存为 SVG：

```
> set term svg
> plot ... 
```

查看[gnuplot_i.hpp](http://code.google.com/p/gnuplot-cpp/source/browse/trunk/gnuplot_i.hpp?r=5)，我建议尝试：

```
Gnuplot myGP;
myGP.set_terminal_std("svg");
myGP.setGNUPlotPath("/your/path/here");
myGP.showonscreen(); 
```

虽然我还没有测试过它（Gnuplot 类中的复杂性可能比我从头文件中看到的要复杂），但总体思路就在那里。将终端设置为 svg，设置输出路径，然后绘图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T06:45:56.637

您究竟是如何获得该图像的？由于 SVG 是一种 XML（文本）文件格式，是否有一些特定的东西阻止您只`fprintf`使用图像？

# iphone - 仪器中的 NSData dataWithContentsOfFile 100% 泄漏

> ID：14084796
> 
> 赞同：3
> 
> 时间：2012-12-29T18:41:45.123
> 
> 标签：iphone, objective-c, ios, ios5, ios6

**更新**

了 为什么`NSData dataWithContentsOfFile`行在仪器中显示泄漏？我正在使用 ARC。部署目标是 iOS 5.0

```
@autoreleasepool
{
    AudioPlayerAV *context = [userInfo valueForKey:@"self"];
    NSString *filepath = [userInfo valueForKey:@"filepath"];
    [context.player stop];

    //check if file is there fetch player from dict
    AVAudioPlayer *_player = nil;
    NSError *error = nil;
    NSData *filedata = [NSData dataWithContentsOfFile:filepath];

    _player = [[AVAudioPlayer alloc]initWithData:filedata error:&error]; 
    context.player = _player;
    NSLog(@"loadAndPlay error : %@",[error description]);
    context.player.numberOfLoops = (context.loop)?-1:0;
    context.player.volume = context.volume;
    [context.player play];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:22:45.017

有时，仪器指向错误的线，我认为这是[AVAudioPlayer](https://stackoverflow.com/questions/12498015/leak-from-nsurl-and-avaudioplayer-using-arc)[中](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)的泄漏。

来自：[使用 ARC 从 NSURL 和 AVAudioPlayer 泄漏](https://stackoverflow.com/questions/12498015/leak-from-nsurl-and-avaudioplayer-using-arc)

> 看起来是 Apple 代码中的泄漏......我尝试使用两者
> 
> -[AVAudioPlayer initWithData:error:] 和 -[AVAudioPlayer initWithContentsOfURL:error:]
> 
> 在第一种情况下，分配的 AVAudioPlayer 实例保留了传入的 NSData。第二种，保留传入的NSURL。
> 
> 可以看到 AVAudioPlayer 对象然后创建了一个 C++ 对象 AVAudioPlayerCpp，它再次保留了 NSData
> 
> 稍后，当 AVAudioPlayer 对象被释放时，NSData 被释放，但从来没有来自关联的 AVAudioPlayerCpp 的释放调用......（您可以从所附图像中看出）

[检查一下，答案](https://stackoverflow.com/a/12659674/672989)中附有一些仪器屏幕截图。

# jquery - Jquery Hover影响所有Divs

> ID：14084799
> 
> 赞同：2
> 
> 时间：2012-12-29T18:42:10.300
> 
> 标签：jquery, css, html

我有这个jquery悬停效果，它的工作原理是有一个不可见的div，当你将鼠标悬停在一个div上时，它会将不可见的div向上滑动，使其可见。当有多个 div 并且您将鼠标悬停在一个 div / box 上时..所有其他不可见的 div 向上滑动，当您悬停的 div 应该向上滑动时。这是我的向上滑动 div 的 jquery：

```
$(function(){
    $(".video-entry-summary").hover(function() {

        $(".videotntitle").stop(true,true).animate({'bottom': '+=211px' },200);

    }, function() {

        $(".videotntitle").stop(true,true).animate({'bottom': '-=211px' },200);

    });
}); 
```

这是演示我的问题的 jsFiddle .. 就像我说的，只有一个 div 应该向上滑动，而不是全部。

[http://jsfiddle.net/Rfs6G/1/](http://jsfiddle.net/Rfs6G/1/)

任何帮助，将不胜感激！！:) ​</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:44:34.857

您可以指定上下文以定位正确的 div ：

```
$(function(){
    $(".video-entry-summary").hover(function() {  
        $(".videotntitle", this).stop(true,true).animate({'bottom': '+=211px' },200);
    }, function() {
        $(".videotntitle", this).stop(true,true).animate({'bottom': '-=211px' },200); 
    });
}); 
```

`$(".videotntitle", this)`搜索`videotntitle`内部具有类的元素`this`（即悬停元素）

[示范](http://jsfiddle.net/DMWhk/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:44:35.577

您的目标是错误的选择器而不是正确的选择器。

你想定位

```
$(this).find('.videotntitle').stop(). etc etc; 
```

[http://jsfiddle.net/Rfs6G/2/](http://jsfiddle.net/Rfs6G/2/)

# api - Camera API（检测好图片，三分法则等）

> ID：14084802
> 
> 赞同：2
> 
> 时间：2012-12-29T18:42:28.827
> 
> 标签：api, camera, webcam

所以我正在开发一个可以拍照的应用程序。我正在使用 OpenCV 来做一些事情，比如检测图片中是否有人。但是，我想做的是检测图片是否“好”。

我不确定如何处理它，但一些想法是：

*   我想检测图片是否遵循三分法。如果没有，它可以调整相机。
*   有不同类型的图片。因此，有时拍摄一组照片，有时拍摄个人照片。

我认为拍摄照片然后尝试裁剪它以满足这些要求之一可能是最简单的？但我想知道是否有任何 api 或对此有帮助的东西？

# wso2 - 在 BAM 中更改端口时无法连接 Cassandra Explorer

> ID：14084804
> 
> 赞同：1
> 
> 时间：2012-12-29T18:43:26.390
> 
> 标签：wso2, wso2bam

当我在 WSO2 BAM 的 repository/conf/carbon.xml 文件中应用端口偏移时，连接到 Cassandra 集群失败。这是一个已知的错误还是我应该更改一些配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:48:05.770

确保输入正确的连接 URL。连接 URL 文本框旁边的示例 URL 仅适用于零端口偏移 BAM 服务器。输入时将端口偏移量添加到示例连接 URL 中提到的端口号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:55:49.337

如果您更改了端口偏移量，则需要使用正确的 Cassandra 端口。新的 Cassandra 端口值将是（9160 + 端口偏移量）。希望这可以帮助。

# android - ADK：从 ADK 读取时设备卡住

> ID：14084806
> 
> 赞同：0
> 
> 时间：2012-12-29T18:43:41.353
> 
> 标签：android, adk

当我何时通过 USB 将消息从电路板发送到 devicersa 时，我遇到了问题。

硬件：

1.  Arduino ADK 2011
2.  三星盖乐世 S3，安卓 4.1.2

问题是 Android 应用程序中的 read 方法永远不会终止并使线程卡住：

```
mFileDescriptor = mUsbManager.openAccessory(accessory);
    if (mFileDescriptor != null) {
        mAccessory  = accessory;
        FileDescriptor fd = mFileDescriptor.getFileDescriptor();
        Log.d(TAG, "openAccessory(): FileDescriptor instanciated. valid " + fd.valid());
        mInputStream = new FileInputStream(fd);
        mOutputStream = new FileOutputStream(fd);

        new Thread(null, new Runnable() {
            @Override
            public void run() {
                int ret = 0;
                byte[] buffer = new byte[255];
                while (ret >= 0 && mInputStream != null) {
                    try {
                        // never terminates
                        ret = mInputStream.read(buffer);
                    } catch (IOException e) {
                        Log.e(TAG, "openAccessory(): Could not read inputStream: " + e);
                        e.printStackTrace();
                        break;
                    }
                } ... 
```

由于我使用了特殊的 USB 库，因此连接工作正常。当我连接设备时，应用程序会很好地自动打开。但是对于日志，我看到它永远不会通过读取命令。Arduino监视器还说：

```
Device addressed... Requesting device descriptor.
found possible device. swithcing to serial mode
device supports protcol 1 or above
found android acessory device
config desc
interface desc
interface desc
2
4
Sending message...
Done
disconnect 
```

ADK 向循环中的设备发送消息（一次）：

```
sntmsg[0] = COMMAND_TEXT;
sntmsg[1] = TARGET_DEFAULT;
sntmsg[2] = 25;
for (int i = 0; i < 25; i++) {
  sntmsg[3 + i] = hello[i];
}
// schreiben (buffer, length)
Serial.println("Sending message...");
acc.write(sntmsg, 3 + 25);
Serial.println("Done");
done = true;
delay(250); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:07:38.437

现在我发现问题可能是断开连接。运行完 Arduiino 代码中的第一个循环后，它会立即打印断开与监视器的连接。AndroidAccessory.cpp 的库中的代码是：

```
bool AndroidAccessory::isConnected(void)
{
    USB_DEVICE_DESCRIPTOR *devDesc = (USB_DEVICE_DESCRIPTOR *) descBuff;
    byte err;

    max.Task();
    usb.Task();

    if (!connected &&
        usb.getUsbTaskState() >= USB_STATE_CONFIGURING &&
        usb.getUsbTaskState() != USB_STATE_RUNNING) {
        Serial.print("\nDevice addressed... ");
        Serial.print("Requesting device descriptor.\n");

        err = usb.getDevDescr(1, 0, 0x12, (char *) devDesc);
        if (err) {
            Serial.print("\nDevice descriptor cannot be retrieved. Trying again\n");
            return false;
        }

        if (isAccessoryDevice(devDesc)) {
            Serial.print("found android acessory device\n");

            connected = configureAndroid();
        } else {
            Serial.print("found possible device. swithcing to serial mode\n");
            switchDevice(1);
        }
    } else if (usb.getUsbTaskState() == USB_DETACHED_SUBSTATE_WAIT_FOR_DEVICE) {
        if (connected)
            Serial.println("disconnect\n");
        connected = false;
    }

    return connected;
} 
```

因此，在第二个循环中，此方法返回 false，即使智能手机仍通过 USB 连接。你知道为什么它认为它在第一次循环迭代后是 dosconnected 吗？

谢谢，佛罗里达州

# javascript - 为什么 AngularJS 教程的第 3 步不起作用？

> ID：14084807
> 
> 赞同：0
> 
> 时间：2012-12-29T18:43:47.547
> 
> 标签：javascript, angularjs, jasmine, frontend

在[AngularJS 教程 AngularJS 教程的第 3 步中，](http://docs.angularjs.org/tutorial/step_03)该示例建议添加另一个 e2e 测试：

```
it('should display the current filter value within an element with id "status"',
    function() {
  expect(element('#status').text()).toMatch(/Current filter: \s*$/);

  input('query').enter('nexus');

  expect(element('#status').text()).toMatch(/Current filter: nexus\s*$/);

  //alternative version of the last assertion that tests just the value of the binding
  using('#status').expect(binding('query')).toBe('nexus');
}); 
```

测试最初失败，将以下内容添加到页面应该使其通过。添加后我的页面是这样的：

```
<!doctype html>
<html lang="en" ng-app ng-controller="PhoneListCtrl">
    <head>
    <meta charset="utf-8">
        <title ng-bind-template="Google Phone Gallery: {{query}}">Google Phone Gallery</title>
        <link rel="stylesheet" href="css/app.css">
        <link rel="stylesheet" href="css/bootstrap.css">
        <script src="lib/angular/angular.js"></script>
        <script src="js/controllers.js"></script>
    </head>
    <body ng-controller="PhoneListCtrl">

        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span2">
                    <!--Sidebar content-->

                    Search:
                    <input ng-model="query">

                    <div id="status">
                        Current filter: {{query}}
                    </div>

                </div>
                <div class="span10">
                    <!--Body content-->

                    <ul class="phones">
                    <li ng-repeat="phone in phones | filter:query">
                        {{phone.name}}
                        <p>
                            {{phone.snippet}}
                        </p>
                    </li>
                </ul>

            </div>
        </div>
    </div>

</body> 
```

最后的断言失败了：`

```
using('#status').expect(binding('query')).toBe('nexus');` 
```

带有以下消息：

```
Chrome 23.0 PhoneCat App Phone list view should display the current filter value within an element with id "status" FAILED
expect select binding 'query' toBe "nexus" 
```

我认为这是因为元素实际上并未绑定到查询，元素的内容使用该绑定，但是，我应该怎么做才能让它通过？

提前致谢

戴夫

编辑：Controllers.js

```
'use strict';

/* Controllers */

function PhoneListCtrl($scope) {
  $scope.phones = [
    {"name": "Nexus S",
     "snippet": "Fast just got faster with Nexus S.",
     "age": 0},
    {"name": "Motorola XOOM™ with Wi-Fi",
     "snippet": "The Next, Next Generation tablet.",
     "age": 1},
    {"name": "MOTOROLA XOOM™",
     "snippet": "The Next, Next Generation tablet.",
     "age": 2}
  ];

  $scope.orderProp = 'age';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T12:54:44.767

我看你用过两次`ng-controller="PhoneListCtrl"`。这很可能会导致问题。去掉`html`标签上的那个。

# mysql - 根据另一个表中的条件更新表，包括函数

> ID：14084812
> 
> 赞同：5
> 
> 时间：2012-12-29T18:44:17.087
> 
> 标签：mysql, select, inner-join, where

我有 2 个 mysql 表，如下例所示：

汽车：

```
RaceID CarID    Dis Grd Date            Time    
8      1    200 A   2010-10-10  20.50
8      2    300 A   2010-10-10  30.50
8      3    200 A   2010-10-10  20.10
9      1    200 A   2010-11-10  20.00
12     1    200 A   2011-12-11  19.50 
```

种族：

```
RaceId  CarID   Dis Grd Date        Exp_Time

10  1   200 A   2011-11-11        
10  2   200 A   2011-11-11        
10  3   200 A   2011-11-11 
```

我想根据 CARS 表中的数据在 Exp_Time 列的 Races 表中添加数据。例如：

```
RACES.Exp_Time=AVG(CARS.Time) 
WHERE
CARS.CarID=RACES.CarID
CARS.Dis=RACES.Dis
CARS.Grd=RACES.Grd
CARS.Date<RACES.Date 
```

这个想法是，预期时间是相同距离和 grd 上之前比赛时间的 AVG。未来的比赛应从计算 AVG 中排除。
问题是从 RACES 表中获取日期条件。我做这个查询：

```
UPDATE `RACES` c
INNER JOIN (
SELECT CARS.CarID, CARS.Dis, CARS.Grd, CARS.Date, AVG(Time) AS `Exp_Time`
FROM CARS
WHERE CARS.Date<'2011-11-11'
GROUP BY CarID, Dis, Grd
)
x ON c.CarID=x.CarID AND c.Dis=x.Dis AND c.Grd=x.Grd
SET c.Exp_Time=x.Exp_Time 
```

当我输入 myseld 日期时它可以工作 - 2011-11-11 我不知道如何从 RACES 表中获取数据。

有人可以帮忙吗？提前致谢！伊万

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:51:48.960

```
UPDATE `RACES` c
INNER JOIN (
SELECT CARS.CarID, CARS.Dis, CARS.Grd, CARS.Date, AVG(Time) AS `Exp_Time`
FROM CARS
WHERE CARS.Date < (SELECT  Date 
                   FROM RACES 
                   WHERE    CARS.Date<RACES.Date 
                        AND CARS.Grd=RACES.Grd 
                        AND CARS.CarID=RACES.CarID
                        AND CARS.Dis=RACES.Dis
                        LIMIT 1 
                )
                GROUP BY CarID, Dis, Grd
)
x ON c.CarID=x.CarID AND c.Dis=x.Dis AND c.Grd=x.Grd
SET c.Exp_Time=x.Exp_Time 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T18:47:44.190

> 2011-11-11 我不知道如何从 RACES 表中获取数据。

您可以将此谓词移动到如下`JOIN`条件：

```
UPDATE `RACES` c
INNER JOIN (
  SELECT 
     CarID, Dis, Grd, Date, AVG(Time) AS `Exp_Time`
  FROM CARS
  GROUP BY CarID, Dis, Grd
)x  ON c.CarID        = x.CarID 
   AND c.Dis          = x.Dis 
   AND c.Grd          = x.Grd
   AND x.DATE(`Date`) < c.DATE(`Date`)
SET c.Exp_Time = x.Exp_Time; 
```

# iphone - 控制资产视频比特率

> ID：14084818
> 
> 赞同：1
> 
> 时间：2012-12-29T18:45:13.173
> 
> 标签：iphone, objective-c, avfoundation, avcapturesession

我正在使用`AVCaptureMovieFileOutput`/`AVCaptureSession`进行视频捕获（基于 AVCam 示例）。
**我的目标操作系统版本是 iOS 4.3**，考虑到这一点，有没有办法通过/控制视频比特率（ `AVVideoAverageBitRateKey`），或者，我应该深入研究 AVAssetsWriter 吗？`AVCaptureMovieFileOutput``AVCaptureSession`

**PS**
我需要对比特率进行精细控制，因此 'AVCaptureSession.sessionPreset' 是不够的，我想直接控制`AVVideoAverageBitRateKey`.

~纳达夫

# objective-c - 如何在 iOS Facebook App 上加载 Facebook 页面链接

> ID：14084824
> 
> 赞同：2
> 
> 时间：2012-12-29T18:45:28.387
> 
> 标签：objective-c, ios, facebook, url, facebook-page

我正在尝试打开 Facebook 链接并使用以下代码将符合 iOS 上的 URL 协议。

```
NSString *url = [self.dataSource getFacebookURL];
url = [url stringByReplacingOccurrencesOfString:@"http://www.facebook.com/" withString:@"fb://profile/"];
NSLog(@"LINK: %@", url);
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]]; 
```

但是当尝试加载个人资料或页面（即组织的）时，它总是将我带到最后打开的屏幕。有没有办法直接链接到页面和个人资料？我按照[此处](https://stackoverflow.com/questions/10416338/open-a-facebook-link-by-native-facebook-app-on-ios)描述的说明进行操作，但没有成功。

我要链接的页面是“ [https://www.facebook.com/junction11](https://www.facebook.com/junction11) ”，如果有帮助的话……

谢谢，马克斯

**使固定**

所以我找到了一个解决方案，首先加载组/人员/页面的图形值，解析它们，然后使用 Facebook-ID 创建一个新的 url。代码有效（不知道效果如何），看起来像这样：

```
// Look at graph page instead of www page
NSString *dataURL = [url stringByReplacingOccurrencesOfString:@"www" withString:@"graph"];
// Load data and parse using JSON parser
NSData *data = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:dataURL]];
NSError *error;
NSDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];

if (!error) { NSLog(@"ERROR: %@", error); return; }

// If no error occurred, make new url and replace the username by the facebook-ID
url = [url stringByReplacingOccurrencesOfString:[dictionary objectForKey:@"username"] withString:[dictionary objectForKey:@"id"]];
// And voilà, it works :]
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]]; 
```

谢谢谷歌和时间...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:39:43.420

```
NSURL *url = [NSURL URLWithString:@"fb://profile/<id>"];
[[UIApplication sharedApplication] openURL:url]; 
```

**计划**

```
fb://profile – Open Facebook app to the user’s profile

fb://friends – Open Facebook app to the friends list

fb://notifications – Open Facebook app to the notifications list (NOTE: there appears to be a bug with this URL. The Notifications page opens. However, it’s not possible to navigate to anywhere else in the Facebook app)

fb://feed – Open Facebook app to the News Feed

fb://events – Open Facebook app to the Events page

fb://requests – Open Facebook app to the Requests list

fb://notes – Open Facebook app to the Notes page

fb://albums – Open Facebook app to Photo Albums list 
```

# c++ - C++：尚未声明

> ID：14084826
> 
> 赞同：5
> 
> 时间：2012-12-29T18:46:38.963
> 
> 标签：c++

我到处都看到过这种类型的错误，虽然我看过答案，但似乎没有任何帮助。

我收到以下代码的以下错误：

错误：“A”尚未声明

乙：

```
#include "A.h"
class B{
    public:
         static bool doX(A *a);
}; 
```

啊：

```
include "B.h"
class A{}; 
```

列出我已经尝试过的事情的清单： - 名称拼写正确 - A 在 Ah - 没有命名空间 - 没有模板 - 没有宏

我有其他班级可以找到A就好了。我唯一能想到的是“静态”导致了问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T18:50:24.457

`include`用前向声明替换：

```
//B.h
class A;
class B{
    public:
         static bool doX(A *a);
}; 
```

仅在必要时才包含文件。

此外，**使用包括警卫**。这将防止其他令人讨厌的问题，例如重新定义等。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-29T18:50:35.890

如果您有两个相互包含的标头，您最终会产生循环依赖，并且由于预处理器的工作方式，这意味着一个将在另一个之前定义。

为了解决这个问题，我会避免在 Bh 中包含 Ah，而只是转发声明：

```
class A;
class B{
    public:
         static bool doX(A *a);
}; 
```

然后您可以在 B.cpp 中包含 Ah

# php - 如何将 PHP 或 JavaScript 变量传递给 Windows cmd.exe

> ID：14084827
> 
> 赞同：1
> 
> 时间：2012-12-29T18:46:40.397
> 
> 标签：php, javascript

我的 Windows 7 机器上有一个 VBScript (.vbs) 文件。要运行该 *.vbs 文件，我必须通过传递参数从 cmd 执行它。例如（*.vbs arg1 arg2 arg3）。

我想从 PHP 或 JavaScript 运行这个 *.vbs 文件。但是参数应该通过变量。Ex ($a=arg1; $b=arg2; $c=arg3;) 然后使用这个变量传递给那个*.vbs。例如（* .vbs $a $b $c）。如何做到这一点，从 JavaScript 或 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:42:44.467

我不知道您是否已经意识到这一点，但是在某些 Windows 服务器上（阅读：所有 Windows 服务器），除非您将 Apache 服务作为实际的可执行文件运行，否则不允许它直接与您的桌面交互。

话虽如此，请使用 exec()，或者简单地将您的查询放在反引号中，如下所示：

```
$query = `cmd.exe`; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:01:46.933

您有几个使用 PHP 的选项。您可以使用 exec() 或 system()。我还建议在传入任何用户输入的值之前使用 escapeshellarg()。

链接： http:
[//php.net/manual/en/function.exec.php](http://php.net/manual/en/function.exec.php)
[http://php.net/manual/en/function.system.php](http://php.net/manual/en/function.system.php)
[http://php.net/manual/en/function。转义shellarg.php](http://php.net/manual/en/function.escapeshellarg.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T14:13:12.800

```
<?php 
$fname="C:/sendemail.vbs";
$id="vkvk1993@gmail.com";
$h="hi";
$s="hhhhhhhhhha";
$q="$fname $id $h $s";
if(exec($q));

echo "Done";

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T06:38:13.240

您可以使用 ：

1.  `exec()`函数并在其中写入命令。

2.  或者将要执行的 cmd 命令包含在**``**（反勾号）运算符中。

例子：

```
$cmd=`xyz.vb $a $b $c` 
```

$cms 变量将具有脚本的输出。

# android - android主题开发时不能使用属性

> ID：14084828
> 
> 赞同：0
> 
> 时间：2012-12-29T18:46:44.233
> 
> 标签：android, themes

我正在研究如何在 android 应用程序中使用自定义主题。在我创建一个 style.xml 后，输入下面的 xml 字符串。

```
 <?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="AppTheme" parent="@android:style/Theme.Light">
        <item name="editTextColor">#00f</item>
    </style>
</resources> 
```

Eclipse 在我运行项目时出错，它找不到属性“editTextColor”，但在 sdkpath\platforms\android-17\data\res\values\themes.xml 中，它确实使用了“editTextColor”属性。

当我更改editTextColor 时，该应用程序可以工作。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="AppTheme" parent="@android:style/Theme.Light">
        <item name="android:editTextColor">#00f</item>
    </style>
</resources> 
```

谁能告诉我为什么？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:51:46.613

在**sdkpath\platforms\android-17\data\res\values\themes.xml**中，它直接引用该值意味着在 android 平台本身内部，但是当您尝试在应用程序中引用它时，您必须使用**android引用它:editTextColor**因为您在 android 平台本身之外使用它并覆盖它的值。希望您有所了解。

# iphone - CellForRowAtIndexPath 返回错误的单元格

> ID：14084833
> 
> 赞同：0
> 
> 时间：2012-12-29T18:47:54.550
> 
> 标签：iphone, ios, uitableview, segue

我遇到了一个问题，其中 cellForRowAtIndexPath 返回错误的单元格，因此，它在错误的单元格上执行其他操作。

我已经构建了很大的自定义单元格，因为我正在安装一些 UIImageViews（+文本 +按钮），所以一个单元格占据了整个屏幕。当您向下滚动并且两个单元格同时在屏幕上时，如果您点击顶部的单元格，它会转到底部单元格的内容（单元格内的按钮操作相同）。

我认为这可能是 IB 特有的，所以我用代码重建了所有内容，但仍然有相同的行为。

有什么办法可以解决这个问题并保持正确的 indexPaths 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:50:27.687

我认为你的观点是错误的。cellForRowAtIndexPath 不会返回错误的单元格。它应该只返回一个新的单元格，如果您使用 dequeueReusableCellWithIdentifier 或类似的，它可能已被回收。在这种情况下，dequeueReusableCellWithIdentifier 将返回任何可能刚刚从顶部滚动的旧单元格。您的工作是获取新单元格（可能是新单元格或回收的单元格）并将正确的值填充到其中的 cellForRowAtIndexPath 中。然后它返回的单元格将是“正确”的单元格，因为您刚刚向它写入了所有正确的值。因此，我会查看您对 cellForRowAtIndexPath 的实现，以确保将您传递的索引路径的正确值填充到 cellForRowAtIndexPath 返回的单元格中。

# php - 在简单的登录方法中与异常混淆。我什至需要它们吗？

> ID：14084837
> 
> 赞同：0
> 
> 时间：2012-12-29T18:48:21.230
> 
> 标签：php, exception

所以基本上今天我决定在一个简单的登录方法中使用一些异常进行测试，因为我已经在很多网站上阅读了一段时间，但是当我开始将它们添加到我的代码中时，它们最终会让我感到困惑，所以今天希望是有一天我会发现我做错了什么。

这是登录方法（只是验证输入部分，没有数据库内容或有意义的消息）：

```
public function login($username, $password) {

    try {
        $this->security->validateInput($username, 'String', array(20, 6), 'username');
    }
    catch(InvalidArgumentException $e) {
        echo $e->getMessage();
    }
    catch(LengthException $e) {
        echo $e->getMessage();
    }
    catch(InvalidFormatException $e) {
        echo $e->getMessage();
    }

} 
```

您可以从 catch 块中看到 validateInput() 方法抛出了哪些异常。

我没有得到的是我也有 $password 变量要验证，但是将它放在 $username 的验证下对我来说没有意义，例如：

```
try {
    $this->security->validateInput($username, 'String', array(20, 6), 'username');
    $this->security->validateInput($password, 'String', array(16, 8), 'password');
} 
```

我是否以完全错误的方式使用异常，也许它们不应该在登录脚本和其他类似脚本中使用？

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:39:03.753

# 定义“需要”

您是否“需要”在特定情况下抛出异常可能是有待商榷的。特别是对于像 PHP 这样的松散类型的语言。如果您对有关何时使用异常的一些论点感兴趣，您可以继续关注[Programmers.SE](https://softwareengineering.stackexchange.com/)，看看他们对这个主题有什么看法。具体来说，您可以查看[Defensive Programming Vs Exception Handling](https://softwareengineering.stackexchange.com/questions/139171/defensive-programming-vs-exception-handling)问题。对于我的其余答案，我将忽略您是否“需要”抛出异常，或者即使这是正确的做法。我将尽我所能将正确性论点放在一边，专注于您的问题。

# 在黑暗中跌跌撞撞

所以让我们检查一下这个问题。您正在尝试使用 OOP 通过 PHP 脚本登录用户。首先，我很抱歉。在我看来，PHP 中的 OOP 很糟糕。但是，如何处理验证确实取决于很多个人偏好和情况。所以，我们先回答几个问题：

*   **其他脚本如何与此交互？** 验证需要考虑的重要一点是其他脚本将如何与之交互。如果您正在为网站编写一个简单的登录表单，并且您的验证只需要在您的登录页面上进行，那么不用担心异常会更容易，而只需将用户显示或重定向到指示存在错误的页面无需登录。另一方面，如果您需要从多个不同的页面或站点与之交互，或者以无法进行简单重定向的方式进行交互，则可能更容易引发错误和让调用代码弄清楚如何处理它。
*   **您想以不同的方式处理所有异常吗？** 出于安全原因，您不应处理带有不同错误消息的用户名和密码。这提供了一种简单的方法来确定用户名是否正确，并且是一个安全问题（大多数情况下）。也不要说他们是否“接近”。但是，这是否意味着您想以相同的方式处理用户名中的无效字符？这是一个异常有用的地方，因为它使您可以灵活地区分错误，同时仍然可以让您在需要时以相同的方式处理它们。它让调用代码做出决定，而不必在验证中这样做。
*   **其他编码员会使用您的代码吗？** 这对我来说很重要。一个描述性的异常和消息可以告诉我我做错了什么假设，作为一个神秘的返回值，或者一个我没想到的简单重定向可能会令人沮丧。如果您尝试创建将在其他地方重用的库或代码，则应抛出描述性异常。另外，有很好的文档:)
*   **您的服务器是如何配置来处理 PHP 异常的？** 如果您正在执行 AJAX 请求或类似的 REST API 请求，那么了解您的服务器如何处理来自 PHP 的错误实际上会很有用。许多配置为仅针对任何未处理的异常抛出“500 服务器错误”。但是有些，特别是如果使用开发设置，会显示遇到的错误并打印消息。这在学习时很有用，但对于实时站点来说是不好的做法。您需要确保您正在处理所有您知道的异常，或者您需要在另一端提供您期望的有用的错误消息。

# 我会怎么做？

对于 OOP，我总是倾向于抛出异常，而不是使用其他方法处理事情。异常允许更轻松地重用事物，因为您无需进入其他代码片段来修改事物。对象应该是独立的，这样您就可以一次又一次地使用您的对象，而不必每次都重写它。这对于登录验证之类的东西特别有用，因为您可以在一个地方解决任何问题，并且随着您了解更多信息，您可以不断改进它。

# html - 格式化列内的文本

> ID：14084839
> 
> 赞同：0
> 
> 时间：2012-12-29T18:48:38.617
> 
> 标签：html, text, formatting

在我的 HTML 表格中，当里面的文本大于列宽时，列的宽度会增加。我可以使用 overflow:hidden 将宽度保持在固定大小；但我想做如下图所示的事情：
![](../Images/126c5eddac0224b35e5cef686635cbce.png)
实际文本是（485 - 帕斯卡的死亡三角形）当它大于列的宽度时，文本将像图像一样显示。我没有手动完成。有什么简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:17:38.590

您可以使用样式表来处理这个问题。您可以设置`text-overflow`为`ellipsis`

有一个现有的 SO 证明了这一点：

[表格单元格中的CSS文本溢出？](https://stackoverflow.com/questions/9789723/css-text-overflow-in-a-table-cell)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T20:10:44.357

有一个名为 ellipsis 的 CSS 属性可以执行此操作...

试试这个...

```
#your_element_id {

text-overflow : ellipsis;
overflow:hidden;
white-space: nowrap;

} 
```

这可能有效...

# matlab - 如何在 matlab GUIDE 中创建坐标轴

> ID：14084840
> 
> 赞同：0
> 
> 时间：2012-12-29T18:48:44.143
> 
> 标签：matlab, matlab-guide

我想使用以下代码实现`matlab GUIDE`：

```
axes(handles.axes1);
imshow(image1);
axes(handles.axes2);
imshow(image2); 
```

由于我对 GUIDE 很陌生，所以我不知道该怎么做。任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:03:26.277

1.  打开指南选择空 gui
2.  将两个坐标区对象拖放到图中的任意位置。右键单击任何坐标区对象并查看其属性可以设置对象的大小、位置和名称。指南始终与包含所有回调函数的 .m 文件并行生成图形文件，其中包括在打开 gui 时调用的函数（就在它可见之前）-您可以将 imshow() 代码放在那里...整个事情是非常直观，对matlab提供的帮助很大。

# javascript - 在一页上显示多个 iFrame 的简单代码？

> ID：14084845
> 
> 赞同：0
> 
> 时间：2012-12-29T18:49:59.713
> 
> 标签：javascript, html, iframe, web

自从我上次编码以来已经有一段时间了，我只是想知道我能把这个小想法变成多么简单。

简单地说，我想在一页上有 4 个输入文本字段，标签和文本字段的示例是：http://www.url.com/[ASpecificLink] 其中 [] 表示文本字段。填写完所有文本字段并单击“确定”后，下一页将列出指定链接的 iFrame，使一页总共有 4 个 iFrame。

我的第一个问题是：我能把这个想法简单到什么程度？我一开始就想到了使用 PHP，理想情况下我想在 iPad 上访问它。

我的第二个问题是：例如，是否可以在 iFrame 中列出特定内容。例如，在我输入的链接中，我想显示的唯一内容是整个页面的 Table 元素中包含的内容（这意味着将排除顶部横幅、导航栏和其他元素）

非常感谢您，并期待有关此想法的其他观点。我的方法可能不是解决此问题的最有效方法，因此我很欣赏一些开箱即用的意见。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:02:35.790

至于第一个问题：这很简单，但你不应该使用 PHP。这可以使用 Javascript 轻松完成：

*   创建一个新的 IFrame 元素
*   将“src”属性设置为文本输入的内容
*   将其附加到页面

浏览器将自行加载 iframe 中的页面。

至于第二个问题：

*   使用 AJAX (Javascript) 加载页面
*   使用 Javascript 从页面中获取所需的元素
*   将它们附加到 IFrame 的 ContentWindow 属性

这里没有代码，因为您似乎只期待实现选项的想法:-)

# javascript - 通过对象属性递增？

> ID：14084852
> 
> 赞同：2
> 
> 时间：2012-12-29T18:50:57.390
> 
> 标签：javascript

是否可以通过对象属性增加（而不是循环）。我知道对象不能保证排序，但我想以任何方式增加它们。

例如，对于一个数组，可以这样做：

```
arr[index++]; 
```

但这不适用于对象：

```
obj[key++]; 
```

因为我不认为 ++ 运算符被定义为用于键。

我不想构建一个复杂的对象结构来存储带有键的索引。我想在本地做。

我很清楚 for-in 结构，但我想根据需要递增，而不是循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:52:11.413

在最近的浏览器中，您可以使用[keys](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys)数组：

```
val = Object.keys(o)[i++]; 
```

详细示例：

```
var keys = Object.keys(o);
for (var i=0; i<keys.length; i++) {
    var key = keys[i];
    console.log(key, o[key]);   
} 
```

要与 IE8 兼容，请使用此构造来迭代 keys ：

```
for (var key in o) {
   console.log(key, o[key]);
} 
```

如果您不想迭代继承的属性，请使用[hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)：

```
for (var key in o) {
    if (o.hasOwnProperty(key) console.log(key, o[key]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:11:22.687

[`++`运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#.2B.2B_.28Increment.29)适用于任何*数字*：它将数字加一。

如果你的对象的属性是数字，你当然可以用它`++`来迭代它们：

```
var obj = { 1: "foo", 2: "bar", 3: "baz" };
var i = 1;
console.log( obj[i++] );
console.log( obj[i++] );
console.log( obj[i++] ); 
```

（当然，这样做的一个问题是，一般来说，不能保证对象的属性，即使是数字，也必须是*连续*的数字。）

现在，dystroy 已经很好地回答了实际问题，所以我不会在这里重复他的回答。我只是想添加这一点来强调这样一个事实，即询问“`++`操作符是否被定义为用于键”是没有意义的：`++`操作符*不知道或不关心*它正在操作的值是数组键还是对象属性名称或[生命、宇宙和一切的答案](http://www.google.com/search?q=answer+to+life+the+universe+and+everything)。它所关心的只是它是否是或是否可以被有意义地解释为一个数字。

# c# - 从 XAML 应用程序打开 Web 浏览器

> ID：14084860
> 
> 赞同：0
> 
> 时间：2012-12-29T18:51:14.910
> 
> 标签：c#, vb.net, xaml, windows-runtime

我想从我的 XAML 应用程序中打开外部网络浏览器，类似于：[想要在 WP7 的外部浏览器中打开链接](https://stackoverflow.com/questions/4779363/want-to-open-link-in-external-browser-of-wp7)

我似乎找不到 WebBrowserTask 对象：

```
Dim wbt As New WebBrowserTask()
wbt.Uri = New Uri("http://xxx.xxx.com/xxx.aspx")
wbt.Show() 
```

WindowsRT/XAML 还有其他方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:02:22.987

您应该使用[Launcher 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.system.launcher.aspx)。

```
Dim uri As New Uri("http://www.bing.com")

Async Sub DefaultLaunch()

   ' Launch the URI
   Dim success = await Windows.System.Launcher.LaunchUriAsync(uri)

   If success Then
      ' URI launched
   Else
      ' URI launch failed
   End If

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:02:23.807

```
await Launcher.LaunchUriAsync(new Uri(uri)); 
```

# android - 安卓数据收集

> ID：14084861
> 
> 赞同：0
> 
> 时间：2012-12-29T18:51:19.043
> 
> 标签：android, logging, sensors, android-sensors

我正在尝试记录 android 传感器数据，然后每 24 小时将其上传到服务器（使用 Parse.com）（为了对其进行测试，我会将其设置为一小时）。我的问题是我知道如何编写将传感器数据保存到本地 txt 文件的方法，但是当 24 小时过去了。如何执行以下操作：

1.  上传 24 小时数据
2.  清除 24 小时数据
3.  继续保存数据

基本上我不明白一个正确的伪代码/或完整的代码方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:09:22.533

只是一个建议。1.编写一个服务，它将继续读取传感器数据并写入数据库/文件。我更喜欢数据库。2.编写一个服务来读取（从数据库或文件）并将这些数据上传到你想要的任何地方。使用 Alarmmanger 安排此服务间隔 1 小时。你会发现很多关于警报管理器的例子，

# javascript - 如何删除除一对一之外的所有列表项（jQuery）

> ID：14084866
> 
> 赞同：-1
> 
> 时间：2012-12-29T18:52:00.567
> 
> 标签：javascript, jquery

因此，我正在寻找一种单击即可删除所有列表项的方法，不是那么难，但是为了给它一些不错的效果，我想让第一个上滑并删除它，一旦第一个被删除，对第二个列表执行相同的操作item 以此类推，直到删除每个列表项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:04:04.333

以下一次按顺序删除列表中的所有项目：

```
$('button').click(function() {
    var $first = $('#list li:first')
    removeItem($first);
})

function removeItem($el) {
    $el.slideUp(function() {

        var $next = $el.next()
        if ($next.length) {
            removeItem($next)
        }
        $(this).remove()
    })
} 
```

演示：http: [//jsfiddle.net/UzPy5/2/](http://jsfiddle.net/UzPy5/2/)

要单独删除可以使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:55:59.183

为所有列表项赋予相同的类，然后调用 $(".yourclass")，它将返回一个数组。然后使用 setInterval (http://www.w3schools.com/js/js_timing.asp) 之类的东西通过该数组，它可以具有您的上滑功能和您的时间。也许您想要滑动（http://api.jquery.com/animate/）或其他一些插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:59:40.280

递归`fadeOut`列表中的每个元素。这可以不用 jQuery，但你需要滚动你自己的动画（或使用 CSS 动画）。

```
function fadeList(list, index) {
  if (index < list.length) {
    list[index].fadeOut(800, function() {
      fadeList(list, i+1);
    });
  }
}

$('#remove-btn').on('click', function(e) {
  fadeList($('#my-list li'),0);
 }); 
```

# sqlite - c语言中的sqlite模式匹配

> ID：14084867
> 
> 赞同：2
> 
> 时间：2012-12-29T18:52:07.493
> 
> 标签：sqlite, pattern-matching

我尝试过的以下查询在使用数据库的 sqlite 管理器中运行时工作正常，但是当我尝试在我的 C 程序中执行相同的查询时，查询没有被执行。

```
Query: "SELECT * FROM Object WHERE Path like ? " 
```

查询执行顺序：

```
sqlite3_prepare_v2
sprintf(buf,"'/%d -%%%%'",objNum); (buf= '/x -%%')
sqlite3_bind_text
sqlite3_step 
```

表中的示例行（对象）

```
Path                  artist        album       genre
/0 - xxxx.mp3         xxxxx        yyyyy        zzzzz
/1 - aaaa.mp3         wwwww        yyyyy        qqqqq 
```

我必须使用路径开头的数字来获取表中的其余详细信息。任何帮助深表感谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:18:26.140

不要对参数字符串使用单引号；参数中的所有数据都是直接获取的，没有任何更改。采用：

```
sprintf(buf, "/%d -%%", objNum); 
```

# php - 新数组中来自php数组的相同值

> ID：14084870
> 
> 赞同：0
> 
> 时间：2012-12-29T18:52:23.627
> 
> 标签：php, arrays

我的数组有问题，没有我的朋友 :)

我有一个这个数组：

```
Array
(
    [0] => 2012163115
    [1] => 2012163115
    [2] => 2012161817
    [3] => 201214321971
    [4] => 201214321971
    [5] => 201214321971
) 
```

我需要这个，所有变量都出现不止一次

```
Array
(
    [0] => 2012163115
    [1] => 201214321971
) 
```

我试试这个

```
foreach ($array as $val) {
                    if (!in_array($val, $array_temp)) {
                        $array_temp[] = $val;
                    } else {
                        array_push($duplis, $val);
                    }
                } 
```

但结果是

```
Array
(
    [0] => 2012163115
    [1] => 201214321971
    [2] => 201214321971
) 
```

我的错误在哪里？感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T18:54:15.167

[`array_unique()`](http://php.net/manual/en/function.array-unique.php)有你吗？

编辑：操作我没有注意到“不止一次”子句，在这种情况下：

```
$yourArray = array('a', 'a', 'b', 'c');

$occurrences = array();

array_walk($yourArray, function($item) use(&$occurrences){

    $occurrences[$item]++;

});

$filtered = array();

foreach($occurrences as $key => $value){

    $value > 1 && $filtered[] = $key;

}

var_dump($filtered); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T19:04:40.850

```
$array = array(
  '2012163115',
  '2012163115',
  '2012161817',
  '201214321971',
  '201214321971',
  '201214321971',
);

$duplication = array_count_values($array);
$duplicates = array();
array_walk($duplication, function($key, $value) use (&$duplicates){
  if ($key > 1)
    $duplicates[] = $value;
});
var_dump($duplicates); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:01:50.680

请参阅[http://php.net/manual/en/function.array-unique.php#81513](http://php.net/manual/en/function.array-unique.php#81513)

这些是为了让 SO 接受帖子而添加的字符！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T19:09:49.173

```
$array_counting = array();
foreach ($array as $val)
    if ( ! in_array($val, $array_counting))
    {
        $array_counting[$val] ++; // counting  
    }

$array_dups = array();
foreach ($array_counting as $key => $count)
{
    if ($count > 1)
        $array_dups[] = $key; // this is more than once
} 
```

# expat-parser - 如何将 expat-parser 与俄语字符集一起使用？

> ID：14084872
> 
> 赞同：0
> 
> 时间：2012-12-29T18:52:45.097
> 
> 标签：expat-parser

我尝试使用 expat 进行 XML 解析，并且我在 XML 文件中有俄语符号，这个符号被 expat 错误地解释了。

我过期了_str：Р В РЎС“РЎРѓРЎРѓР С”Р С'Р в„– РЎвЂљР ВµР С”РЎРѓРЎвЂљ</p>

而不是：Русский текст

这是我的剪切代码：

```
 static int xmlParseStartup(char *buffer, int n, START_UP_T *startUp_sp)
    {
        void *buff;
        XML_Parser parser_p = XML_ParserCreate("UTF-8");

        if (!parser_p)
        {
            DEBUG("Unable to create parser!\n");
            return RES_ERR;
        }
        XML_SetUserData(parser_p, (void *)startUp_sp);
        XML_SetElementHandler(parser_p, startElement, endElement);

        buff = XML_GetBuffer(parser_p, n);

        memcpy(buff, buffer, n);

        if (XML_STATUS_ERROR == XML_ParseBuffer(parser_p, n, TRUE)) 
        {
            DEBUG("%s at line %" XML_FMT_INT_MOD "u\n",
                  XML_ErrorString(XML_GetErrorCode(parser_p)),
                  XML_GetCurrentLineNumber(parser_p));
            return RES_ERR;
        }
        return RES_OK;
    }

static void XMLCALL startElement(void       *userData,
                                 const char *name,
                                 const char **atts)
{
    int i;
    START_UP_T *startUp_sp = (START_UP_T *)userData;
    for (i = 0; i < startUp_sp->depthPtr; i++)
    {
        fprintf(stderr, ".");
    }
    DEBUG("[%d]name: %s\n", startUp_sp->depthPtr, name);

    if (0 == strcmp(name, "response"))
    {
        if (0 == strcmp(atts[i], "result"))
        {
            startUp_sp->result = atoi(atts[3]);
            DEBUG("RESULT: %d\n", startUp_sp->result);
        }
        else if (0 == strcmp(atts[i], "status_str"))
        {
            strcpy(startUp_sp->expired_str, atts[3]);
            DEBUG("EXPIRED_STR: %s\n", startUp_sp->expired_str);
        }
        else if (0 == strcmp(atts[i], "status_width"))
        {
            startUp_sp->status_width = atoi(atts[3]);
        }
    }

    startUp_sp->depthPtr += 1;
}

static void XMLCALL endElement(void       *userData,
                               const char *name)
{
    START_UP_T *startUp_sp = (START_UP_T *)userData;
    startUp_sp->depthPtr -= 1;
} 
```

XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<startup>
    <response name="result" value="0"/>
    <response name="status_str" value="Русский текст"/>
    <response name="status_width" value="120"/>
</startup> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:00:39.727

您得到 UTF-8 char*-typed 字符串的 cp1251 表示，因此 expat 实际上工作正常 - 这是您遇到问题的控制台输出。

如果不是这种情况，请检查 xml 文件开头的 utf8 标记（ASCII 代码中的 239、187、191 字节，或 CP-1251 中不带引号的“п>ї”）。

还有一个：您应该检查 .xml 文件的实际编码，看起来它不是您认为的那样（utf-8）。你用什么编辑器来创建文件？

UTF-8 "Русский текст" 字符串的 CP1251 表示是 "Р С_С_С_РєРёР№ С'РчРєС_С'"。

# android - 列表的共享首选项

> ID：14084875
> 
> 赞同：0
> 
> 时间：2012-12-29T18:53:12.510
> 
> 标签：android, sharedpreferences

作为一个没有经验的 Android 程序员，我需要一些帮助。我正在为需要一个可以记录祈祷请求的活动的教堂设计这个应用程序（类似于制作待办事项列表）。此时我可以在列表中键入项目，但它们似乎没有保存并在使用下面的共享首选项摘录关闭后返回，也环顾这个网站，看起来我可以在没有物理按钮的情况下做到这一点按下保存。

SharedPreferences 祈祷请求 = getPreferences(Activity.MODE_PRIVATE);

```
ListView myListViewa = (ListView)findViewById(R.id.myListView);

SharedPreferences.Editor editor = prayerRequests.edit();

editor.putString("prayers", myListViewa.toString());

editor.apply(); 
```

整个班级都在这里：

```
 package com.direction.investor.prayerjournal;

   import java.util.ArrayList;

   import android.annotation.TargetApi;
   import android.app.Activity;
   import android.os.Build;
   import android.os.Bundle;
   import android.view.KeyEvent;
   import android.view.View;
   import android.widget.ArrayAdapter;
   import android.widget.EditText;
   import android.widget.ListView;
   import android.widget.TextView;
   import android.content.SharedPreferences;
   import android.content.SharedPreferences.Editor;

 public class prayerRequests extends Activity {

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
public void onCreate(Bundle savedInstanceState) 
{ super.onCreate(savedInstanceState);
setContentView(R.layout.prayerrequest);

ListView myListView = (ListView)findViewById(R.id.myListView);
final EditText myEditText = (EditText)findViewById(R.id.myEditText);

final ArrayList<String> prayers = new ArrayList<String> ();

final ArrayAdapter<String> aa;

aa = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, prayers);

myListView.setAdapter(aa);

SharedPreferences prayerRequests = getPreferences(Activity.MODE_PRIVATE);

ListView myListViewa = (ListView)findViewById(R.id.myListView);

SharedPreferences.Editor editor = prayerRequests.edit();

editor.putString("prayers", myListViewa.toString());

editor.apply();

myEditText.setOnKeyListener(new View.OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        if (event.getAction() == KeyEvent.ACTION_DOWN)
            if ((keyCode == KeyEvent.KEYCODE_DPAD_CENTER) ||
                    (keyCode == KeyEvent.KEYCODE_ENTER)) {

                prayers.add(0, myEditText.getText().toString());
                aa.notifyDataSetChanged();
                myEditText.setText("");
                return true;

            }
        return false;
    }
});

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:00:23.233

我建议使用数据库而不是 sharedpreferences

见[http://developer.android.com/guide/topics/data/data-storage.html#db](http://developer.android.com/guide/topics/data/data-storage.html#db)

# jsf-2 - 我可以在 EL 2.2 中使用 Get-Parameter 而不将其写入 Bean 吗？

> ID：14084876
> 
> 赞同：1
> 
> 时间：2012-12-29T18:53:15.380
> 
> 标签：jsf-2, el

我想解析网址

```
title.xhtml?id=1 
```

我在“title.xhtml”中的代码应该看起来像

```
...
<h:outputText value="#{titles.getTitle(${param.id}).id}"></h:outputText>
... 
```

但不幸的是，这不起作用，因为嵌套的“#”和“$”不被接受。所以我的问题是：我可以使用 URL 参数并将其交给 bean 函数，而无需将其单独存储在 bean 中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:29:53.363

那是无效的 EL 语法。您不能也不需要以任何方式嵌套 EL 表达式。甚至嵌套`${}`也是无效的。`#{}`和之间的唯一区别`${}`是它`#{}`也可以执行*设置*操作（如果适用），而`${}`只能执行*获取*操作。

这是有效的 EL 语法：

```
<h:outputText value="#{titles.getTitle(param.id).id}" /> 
```

请注意，这`#{param.id}`是完全合法的 JSF EL 语法。为避免将来出现混淆，最好确保您不再`${}`在 JSF 中使用旧的 JSP EL 语法。另请参阅[JSP EL、JSF EL 和 Unified EL 之间的区别](https://stackoverflow.com/questions/4812755/difference-between-jsp-el-jsf-el-and-unified-el/4812883#4812883)。

# ruby-on-rails - 我应该在哪里存储常用功能？

> ID：14084877
> 
> 赞同：1
> 
> 时间：2012-12-29T18:53:26.497
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller

我有三个模型。

*   users_controllers.rb
*   社区控制器.rb
*   community_tipics_controller.rb

我正在使用名为**check_digit的函数**

```
def checkdigit
 (transaction)
end 
```

我把它放在所有的控制器中。并通过 before_filter 调用它。
但我认为我在浪费，因为我只是将上面完全相同的代码粘贴到所有控制器上。

如果我的控制器共同使用它，我应该把它放在哪里？
我应该把它放在控制器/application_controller.rb 中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:22:16.680

有几种方法可以做到这一点，一些可能的方法是（如果我要这样做）

**第一种方法**

如果这是 application_controller.rb 中的控制器使用的简单方法

```
private
def checkdigit
 (transaction)
end 
```

**第二种方法**

如果您的功能被特定类别使用，（通常我经常这样做），创建一个单独的控制器并让您的所有其他控制器由它继承

例如：如果您的方法仅使用了我的管理员，并假设您还有更多类似的方法

```
class AdminController < ApplicationController
   layout 'admin'

   private
   def checkdigit
     (transaction)
   end

end

and

class UsersController < AdminController

end 
```

**第三种方法**

如果模型/控制器等/将使用您的方法。请考虑将其作为模块

```
module CommonMethods
   def checkdigit
     (transaction)
   end
end

class UsersController < ApplicationController
    include CommonMethods 
end 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:56:34.117

你可以把它放进去`helpers/application_helper.rb`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:56:37.297

你是对的，所有控制器需要的所有常用方法都应该存储在`ApplicationController`.

此外，您还应该在此控制器中的所有控制器之间保持通用逻辑。

**编辑：**
如果他们只是帮手，那么你会把他们放在帮手去的地方，请参阅@simone 的答案。

# android - 使用 SharedPreference 中的 AccessToken - android facebook sdk 3

> ID：14084878
> 
> 赞同：6
> 
> 时间：2012-12-29T18:53:31.287
> 
> 标签：android, facebook

我正在尝试将 Facebook AccessToken 保存在 SheredPreference 中，并稍后使用该令牌登录，但是当我这样做时应用程序崩溃了。

```
package com.fit.android;

import java.sql.Date;
import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import com.facebook.AccessToken;
import com.facebook.AccessTokenSource;
import com.facebook.Request;
import com.facebook.Response;
import com.facebook.Session;
import com.facebook.SessionState;
import com.facebook.model.GraphUser;

public class LoginActivity extends Activity implements OnClickListener {

    Button login;
    Button logout;
    Button loginToken;

    SharedPreferences sp;
    AccessToken token;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login_activity);

        login = (Button) findViewById(R.id.login);
        logout = (Button) findViewById(R.id.logout);

        login.setOnClickListener(this);
        logout.setOnClickListener(this);

        loginToken = (Button) findViewById(R.id.token);
        loginToken.setOnClickListener(this);

        sp = getPreferences(MODE_PRIVATE);

        String access_token = sp.getString("access_token", null);

        String expires = sp.getString("access_expires", null);

        if (access_token != null && expires != null) {
            token.createFromExistingAccessToken(access_token, Date.valueOf(expires), null, 
            AccessTokenSource.TEST_USER, null);
        }
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
    }

    @Override
    public void onClick(View v) {

        switch (v.getId()) {
            case R.id.login:
                if (token != null) {
                    Session.openActiveSessionWithAccessToken(this, token, new Session.StatusCallback() {
                        @Override
                        public void call(final Session session, SessionState state, Exception exception) {
                            if (session.isOpened()) {

                                Request.executeMeRequestAsync(session, new Request.GraphUserCallback() {
                                    @Override
                                    public void onCompleted(GraphUser user, Response response) {
                                        if (user != null) {
                                            TextView welcome = (TextView) findViewById(R.id.textView1);
                                            welcome.setText("Hello " + user.getName());
                                        }
                                    }
                                });
                            }
                        }
                    });
                } else {

                    Session.openActiveSession(this, true, new Session.StatusCallback() {
                        @Override
                        public void call(final Session session, SessionState state, Exception exception) {

                            if (session.isOpened()) {
                                Request.executeMeRequestAsync(session, new Request.GraphUserCallback() {
                                    @Override
                                    public void onCompleted(GraphUser user, Response response) {
                                        if (user != null) {
                                            TextView welcome = (TextView) findViewById(R.id.textView1);
                                            welcome.setText("Hello " + user.getName());

                                            Editor editor = sp.edit();
                                            editor.putString("access_token", session.getAccessToken());
                                            editor.putString("access_expires", session.getExpirationDate().toString());
                                            editor.commit();
                                        }
                                    }
                                });
                            }
                        }
                    });
                }

                break;

            case R.id.logout:
                Session.getActiveSession().closeAndClearTokenInformation();
                break;
        }
    }
} 
```

日志猫：

```
12-29 19:16:32.316: E/AndroidRuntime(1118): FATAL EXCEPTION: main
12-29 19:16:32.316: E/AndroidRuntime(1118): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.fit.android/com.fit.android.Login_activity}: java.lang.IllegalArgumentException
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.os.Looper.loop(Looper.java:137)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at java.lang.reflect.Method.invokeNative(Native Method)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at java.lang.reflect.Method.invoke(Method.java:511)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at dalvik.system.NativeStart.main(Native Method)
12-29 19:16:32.316: E/AndroidRuntime(1118): Caused by: java.lang.IllegalArgumentException
12-29 19:16:32.316: E/AndroidRuntime(1118):     at java.sql.Date.valueOf(Date.java:226)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at com.fit.android.Login_activity.onCreate(Login_activity.java:53)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.Activity.performCreate(Activity.java:5104)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
12-29 19:16:32.316: E/AndroidRuntime(1118):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
12-29 19:16:32.316: E/AndroidRuntime(1118):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T19:55:56.727

这是解决方案：

**1-以这种方式解析日期：**

```
 Date date = null;
    try {
        date = new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(expires);
    } catch (ParseException e) {
        e.printStackTrace();
    } 
```

**2- 初始化访问令牌：**

```
 if (access_token != null  && expires != null){
      token = AccessToken.createFromExistingAccessToken(access_token, date, null, AccessTokenSource.TEST_USER, null);
 } 
```

# php - PHP Sockets：从 php 服务器到 web 客户端

> ID：14084887
> 
> 赞同：1
> 
> 时间：2012-12-29T18:54:47.043
> 
> 标签：php, sockets, websocket, phpwebsocket, php-socket

我有一个 php 套接字服务器，用于处理来自调制解调器的消息。我想创建一个 php websocket 服务器，每当我收到来自调制解调器的消息时，我都会将其发送到 webclient。我尝试了几天但没有成功。

最好的方法是什么？谢谢

.

这是我想做的方式：

```
Modem ------> PHP Socket Server ------> Web Clients
                    v
                 database 
```

但如果你有另一种最好的方法，请告诉我。

再次感谢你。

**编辑：**这是非阻塞套接字中 socket_read 错误的替代方法：http: [//php.net/manual/pt_BR/function.socket-read.php#73509](http://php.net/manual/pt_BR/function.socket-read.php#73509)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:13:43.033

您可以使用**非阻塞套接字**和**长轮询**技术来做到这一点。

工作流程是这样的。

1.  PHP 使用非阻塞套接字连接到调制解调器。
2.  Web 客户端发送一个长轮询 http 请求，该请求在 5 或 10 分钟后超时。
3.  PHP 将传入的客户端连接设为非阻塞。通过这种方式，PHP 将每个客户端添加到队列中。
4.  PHP 遍历每个客户端和调制解调器，并检查是否可以写入或读取某些内容。
5.  如果有东西要从调制解调器读取，它会读取并处理。如有必要，将消息写入 Webclient 套接字。
6.  与第 5 步相同，但从 Web 客户端套接字转到调制解调器套接字。
7.  做任何额外的工作。
8.  转到步骤 3。

几个月前我也遇到过类似的情况。我必须在 PHP 中保留网络会话，并且还有另一台服务器连接了 PHP。没能完成。后来我不得不为此转向 Python。

# html - 无法让 h2 元素和左/右边框对齐

> ID：14084889
> 
> 赞同：0
> 
> 时间：2012-12-29T18:55:30.710
> 
> 标签：html, css, padding, vertical-alignment

我有一个 h2 元素，理想情况下，它应该通过它的垂直中点与它的左右边界对齐。我试过了`padding`，`vertical-align:middle`但似乎没有任何效果。想法？

谢谢你。

[jsfiddle](http://jsfiddle.net/w8bmd/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:08:54.367

我已移动 并向元素`font-size`添加了`line-height`声明，因为该属性受以下属性的影响：`#title``vertical-align`

```
#save-the-date #title {
  padding-left: 80px;
  text-align: center;
  width: 800px;
  font-size: 180%;
  line-height: 150%;
} 
```

您只需要将 h2 声明为内联显示样式，除非您希望固定宽度，在这种情况下使用 inline-block 和宽度：

```
#save-the-date #title h2 {
  display: inline;
} 
```

然后，您可以为两个跨度设置一个规则，我删除了不必要的背景额外声明：

```
#save-the-date #title span {
  display: inline-block;
  background: #333333;
  width: 300px;
  height: 3px;
  vertical-align: middle;
}​ 
```

更新的小提琴：http: [//jsfiddle.net/QjUw2/](http://jsfiddle.net/QjUw2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:06:45.967

尝试使用**行高属性**

```
h2 { line-height: *font-size* } 
```

检查 CSS 行高..

# html - 创建一个仅 CSS 的弹出窗口，带有淡入淡出和效果

> ID：14084896
> 
> 赞同：3
> 
> 时间：2012-12-29T18:56:13.803
> 
> 标签：html, css, css-transitions

我想在没有任何 JavaScript 的情况下创建一个基于 CSS 的弹出窗口（允许 CSS3），具有淡入淡出过渡和缩放效果。类似于 IceCream Sandwitch 和**JellyBean**弹出消息。

我尝试了以下方法：http:
[//jsfiddle.net/OMS_/7UaK4/5/](http://jsfiddle.net/OMS_/7UaK4/5/)

代码的主要部分：

**HTML**

```
<span class="info"> Info </span>
<div class="message">
    <p>
        Content
    </p>
</div>​ 
```

**CSS**

```
.message {
    position: absolute;
    top: 100px;
    left: 0;
    width: 100%;
    text-align: center;
    opacity: 0;
    -webkit-transform: scale(.9, .9);
    -webkit-transition: all .18s ease-in-out;
}
.info:hover + .message {
    opacity: 1;
    -webkit-transform: scale(1, 1);
} 
```

我正在做的是将`opacity`元素的 设置为`0`，并在`hover`兄弟 DOM 元素上将其转换为`1`.
如何将它定位在中心，垂直和水平？
另外，这是制作 CSS3 弹出窗口的正确方法吗？
我可以从 过渡`display: none`到`display: block`吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T19:02:49.753

> 如何将它定位在中心，垂直和水平？

本质上，您会将弹出窗口从顶部和左侧推 50%。但是，您必须向后退一步，因为您必须考虑弹出窗口的宽度和高度。

```
.center-of-screen {
    position: absolute;
    top: 50%;     margin-top:  /* -(height/2) */;
    left: 50%;    margin-left: /* -(width/2) */;
} 
```

*资料来源：* [如何将对象准确地居中？](http://css-tricks.com/quick-css-trick-how-to-center-an-object-exactly-in-the-center/)

***注意：*** `-(height/2)`和`-(width/2)`是元素宽度和高度的一半的负值。例如，如果您的元素是`300px x 200px`代码：

```
.center-of-screen {
    position: absolute;
    top: 50%;     margin-top:  -100px;
    left: 50%;    margin-left: -150px;
} 
```

* * *

> 另外，这是制作 CSS3 弹出窗口的正确方法吗？

是的，如果您正在谈论悬停弹出窗口。

* * *

> 我可以从 display: none 过渡到 display: block 吗？

不，您只会从`display: none`到`display: block`使用`transition`on `opacity`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-29T16:28:27.863

现在可以使用`visibility`：

```
.message {
    visibility: hidden;
    opacity: 0;

    transform: scale(.9);

    transition: transform .18s, opacity .18s, visibility 0s .18s; // delay visibility
}

.info:hover + .message {
    visibility: visible;
    opacity: 1;

    transform: scale(1);

    transition-delay: 0s;
} 
```

# python - getattr() 与 dict 查找，哪个更快？

> ID：14084897
> 
> 赞同：15
> 
> 时间：2012-12-29T18:56:21.327
> 
> 标签：python, performance, getattr, dynamic-attributes

一个有点无聊的最佳实践问题。`object.__dict__[some_key]`我习惯性地使用动态查找对象属性值。现在我想知道哪个更好/更快：我目前的习惯或`getattr(object,some_key)`. 如果一个更好，为什么？

```
>>> class SomeObject:
...     pass
... 
>>> so = SomeObject()
>>> so.name = 'an_object'
>>> getattr(so,'name')
'an_object'
>>> so.__dict__['name']
'an_object' 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-29T18:58:22.303

你最好使用`getattr()`而不是直接进入`__dict__`结构。

不是因为它更快或更慢，而是因为官方 API 在*所有*情况下都有效，包括对于*没有*a 的类`__dict__`（[`__slots__`](http://docs.python.org/2/reference/datamodel.html#slots)例如使用时），或者当对象实现[`__getattr__`](http://docs.python.org/2/reference/datamodel.html#object.__getattr__)or[`__getattribute__`](http://docs.python.org/2/reference/datamodel.html#object.__getattribute__)钩子时，或者当所讨论的属性是[描述符](http://docs.python.org/2/reference/datamodel.html#implementing-descriptors)时（例如 a [`property`](http://docs.python.org/2/library/functions.html#property)）或类属性。

如果您想知道是否有任何一种 Python 语句或技术比另一种更快，请使用该[`timeit`模块](http://docs.python.org/2/library/timeit.html)来*衡量*差异：

```
>>> import timeit
>>> class Foo(object):
...     pass
... 
>>> foo = Foo()
>>> foo.bar = 'spam'
>>> timeit.timeit("getattr(foo, 'bar')", 'from __main__ import foo')
0.2125859260559082
>>> timeit.timeit("foo.__dict__['bar']", 'from __main__ import foo')
0.1328279972076416 
```

您可以看到直接访问`__dict__`速度更快，但`getattr()`工作量更大。

# java - 使用带有java的jquery mobile，有可能吗？

> ID：14084909
> 
> 赞同：1
> 
> 时间：2012-12-29T18:57:14.273
> 
> 标签：java, android, jquery, html, jquery-mobile

我需要知道如何在同一个应用程序中使用 jquery mobile 和 java 编码，这样我就可以合并 jquery 平台中不可用的一些功能来制作一些高级的 android 应用程序。

感谢您的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T19:58:43.670

先别听personne3000，显然他没碰过Phonegap。

如果您将它与 Phonegap 一起使用，则可以使用 jQuery Mobile 来完成。Phonegap，作为 HTML5/JS/CSS 的包装器，可以让您访问本机 JAVA 代码（当然仅限 Android）。Phonegap 将让您访问广泛的手机兼容性，从相机、录音到为您的应用程序创建本机标签栏。

[在这里](http://docs.phonegap.com/en/1.8.1/guide_getting-started_ios_index.md.html)，您将找到 Phonegap/Cordova 的“iOS 入门”教程，[这里](http://docs.phonegap.com/en/2.2.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)是 Android 教程。

[在这里](http://docs.phonegap.com/en/2.2.0/index.html)您可以找到基本的 Phonegap/Cordova API 参考，这只是一个基本列表，更多可以在[此处](https://github.com/phonegap/phonegap-plugins)的 3rd 方插件列表中找到。

如果您找不到所需的功能，您可以创建自己的插件，[在这里](http://www.adobe.com/devnet/html5/articles/extending-phonegap-with-native-plugins-for-android.html)您将找到适用于 Android 平台的 Phonegap 插件教程。如果您要使用旧版本的 Phonegap（Cordova 之前）[，这里](http://phonegap.pbworks.com/w/page/36753494/How%20to%20Create%20a%20PhoneGap%20Plugin%20for%20Android)有一个旧插件创建教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:35:59.377

我不认为您可以直接使用 jQuery mobile 来开发您的应用程序。但是，您可以：

*   [在 HTML5/Javascript 中使用Phonegap](http://phonegap.com/)或 Cordova开发 Android 应用程序，并使用 jQuery mobile，但您将无法访问 Java
*   使用[WebView](http://developer.android.com/reference/android/webkit/WebView.html)显示包含 Javascript 的网页。您可能想查看 addJavascriptInterface 方法。

Javascript 和 Java 不能像在应用程序中那样混合使用：它们的工作方式非常不同。

# cordova - 为什么使用PhoneGap编译移动网站时HTML表格没有样式？

> ID：14084910
> 
> 赞同：0
> 
> 时间：2012-12-29T18:57:32.737
> 
> 标签：cordova, jquery-mobile

我正在使用 jquery mobile 制作一个 HTML5 移动网站。它有五个向导格式的页面，每个页面查询一个 Web 服务以检索数据。最后一页有一个 HTML 表格，该表格在代码中预定义，其中填充了来自 Web 服务的数据。没有动态添加行，只是表格单元格中的占位符填充了数据。

该表在样式表中定义了一些样式，在使用桌面或移动浏览器访问时看起来不错。但是，我也在将带有 PhoneGap“Build”的移动网站编译为适用于 Android、iOS 等的原生应用程序。除了最后一页之外，这也可以正常工作，表格没有采用样式并且完全没有样式。

您可以在此处查看页面：http://m.freebets4all.com（删除空格）。只需通过向导移动到最后一页（选择 Betfred、Qualifying Bet 和任何“计算”按钮。当通过电话差距生成应用程序访问时，最后一页上的绿色表格完全没有样式。

为什么使用 PhoneGap Build 编译时表格没有样式？任何人都可以向我指出一些可以解释这一点的文档，或者有任何在 PhoneGap 下设置 HTML 表格样式的经验吗？

这是有问题的页面，显示了 html 中预定义的表格。

```
 <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="phoneGap.js"></script>
    <link rel="stylesheet" href="Styles/jquery.mobile-1.0.1.min.css" />
    <link rel="stylesheet" href="Styles/site.css" />
    <script type="text/javascript" src="Scripts/jquery-1.6.4.min.js"></script>
    <script type="text/javascript" src="Scripts/jquery.mobile-1.0.1.min.js"></script>
    <script type="text/javascript" src="Scripts/Class.js"></script>
    <script type="text/javascript" src="Scripts/matcher-1.0.js"></script>
</head>
<body>
    <form>
    <div class="main">
        <div data-role="page" id="summary" data-title="Place Your Bets">
            <script>

                $('#summary').live('pagebeforecreate', function (event) {

                    var betSummary = new BetSummary($("#summaryTable"), localStorage.selectedBet);
                    setTimeout(function () { betSummary.displaySummary(); }, 1);
                    setTimeout(function () { $("summary").trigger('create') }, 2000);
                });

            </script>
            <div data-role="header">
                <h1>
                    Place your bets...</h1>
            </div>
            <div data-role="content">
                <div class="content">
                    <div id="betInstructionsContainer" class="content">
                        <table class="matchedBet" data-role="table" id="summaryTable" data-mode="reflow">
                            <caption>
                                <p id="iDateLabel">
                                </p>
                                <p id="iMatchLabel">
                                </p>
                                <p id="iMarketLabel">
                                </p>
                            </caption>
                            <thead>
                                <tr>
                                    <th>
                                    </th>
                                    <th>
                                        Back
                                    </th>
                                    <th>
                                        Lay
                                    </th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <th>
                                    </th>
                                    <td>
                                        <span id="iPlLabel" class="loss"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>
                                    </th>
                                    <td>
                                        <span id="iGainLabel" class="gain"></span>
                                    </td>
                                </tr>
                            </tfoot>
                            <tbody>
                                <tr>
                                    <th>
                                    </th>
                                    <td>
                                        <a id="iBookieLabel" title="" href="">
                                            <img id="iBookieImage" alt="10Bet" src="Images/logos/75x16/10Bet.gif">
                                        </a>
                                    </td>
                                    <td>
                                        <a id="iExchangeLabel" title="Click to go to the BetDaq website" href="http://www.freebets4allstage.co.uk/bookmaker/BetDaq/">
                                            <img id="iExchangeImage" alt="BetDaq" src="Images/logos/75x16/BetDaq.gif">
                                        </a>
                                    </td>
                                </tr>
                                <tr>
                                    <th id="iOddsHeader">
                                        Odds
                                    </th>
                                    <td id="iBackOdds">
                                    </td>
                                    <td id="iLayOdds">
                                    </td>
                                </tr>
                                <tr>
                                    <th id="iStakeLabel">
                                        Stake
                                    </th>
                                    <td id="iBackStake">
                                    </td>
                                    <td id="iLayStake">
                                    </td>
                                </tr>
                                <tr>
                                    <th id="iRiskLabel">
                                        Risk
                                    </th>
                                    <td id="iBackRisk">
                                    </td>
                                    <td id="iLayRisk">
                                    </td>
                                </tr>
                                <tr>
                                    <th id="iProfitLabel">
                                        Win
                                    </th>
                                    <td id="iBackProfit">
                                    </td>
                                    <td id="iLayProfit">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div data-position="fixed" data-role="footer">
                    <p class="gotosite">
                        <a href="http://www.freebets4all.com">Go to full website</a></p>
                    <p id="errorMessage">
                    </p>
                </div>
            </div>
        </div>
    </div>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:47:38.143

您确定该文件夹中的 CSS 文件名为 Styles 而不是样式，它区分大小写。

# c - 使用 putchar() 打印段落

> ID：14084916
> 
> 赞同：1
> 
> 时间：2012-12-29T18:58:08.917
> 
> 标签：c

考虑以下代码：-

```
#include"stdio.h"

void main()
{
  char ch;
  while((ch=getchar())!=EOF)
  {
    putchar(ch);
  }
} 
```

无论我给出什么输入（作为一个句子），在我按下回车键后都会重复。如果我想在最后得到整个段落，我该怎么办？这可以使用`putchar()`因为`putchar()`只能用于返回单个字符来完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:07:22.463

这不起作用，因为`EOF`不适合 `char`. 请注意，正确的返回类型`getchar()`是`int`. 例如参见[本手册页](http://linux.die.net/man/3/getchar)。

如果您想一次读取整行，例如可以使用`fgets()`字符缓冲区。不过，我不确定我是否完全理解您想要实现的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:11:51.733

这段代码可以帮助你吗

```
char *buffer;
    int i = 255;

    buffer = (char *)malloc(i*sizeof(char));

    *buffer = getchar();
    while ( *buffer != '?' )
    {
        buffer++;
        *buffer = getchar();
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T19:32:07.230

尝试将您的字符存储到缓冲区中，并在退出 while 循环时打印缓冲区。试试这个代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main()
{
    int c;
    char *buf = calloc(1,sizeof(char));
    int len;
    while ((c=getchar())!=EOF) {
        len = strlen(buf);
        buf = realloc(buf, len+1);
        buf[len] = (char) c;
        buf[len + 1] = '\0';
    }
    printf("%s",buf);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T19:32:26.267

如果要在结尾处获取整个段落，则应在 EOF 到达时将输入存储在缓冲区中。然后循环打印缓冲区的内容。同样正如 Unwind 先生的[**回答**](https://stackoverflow.com/questions/14084916/printing-a-paragraph-using-putchar/14084991#14084991)所说， make, `ch`variable a `int`, char 是错误的！

```
#include"stdio.h"
#define SIZE 1024

void main()
{
  int buffer[SIZE]
  int ch; 
  int i=0;

  // Read and store in a buffer
  while((ch=getchar())!=EOF)
  {
     buffer[i] = ch;
     i++;
  }
  buffer[i] = EOF;

  // now print using putchar(ch);
  i = 0;
  while((ch = buffer[i])  !=EOF)
  {
    putchar(ch);
    i++;
  }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T19:04:39.417

从文件读取时应使用 EOF，因为文件以特殊的 EOF（文件结尾）字符结尾。您需要在此处使用任何标记来表示输入的结尾。

这个程序没有什么意义，我无法想象在任何地方使用它。所以重新考虑需求并相应地改变逻辑。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-12T21:13:13.263

因为我们在控制台/终端中所做的一切 - 直到我们没有按 Enter/Return/^J/^M shell 才向我们的程序发送行

您可以通过复制和粘贴一些行来获取段落（多于 1 行），因此终端|控制台程序显示 1st u 粘贴然后重复 - u 程序的输出

# c++ - 标准对初始化

> ID：14084919
> 
> 赞同：2
> 
> 时间：2012-12-29T18:58:56.130
> 
> 标签：c++, standard-library, std-pair

这是我第一次与双人合作，完全困惑。如何初始化一对以将其插入地图？
我应该为此包含一些标准库吗？

```
#include <string>
#include <map>
using namespace std;
class Roads
{  
 public:  
  map< pair<string,string>, int > Road_map; 
  void AddRoad( string s, string d )
       { int b = 2 ; Road_map.insert( pair<s,d>, b) ; }  //pair<s,d> is wrong here.

 }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T19:02:13.673

您可以使用`std::make_pair`：

```
Road_map[make_pair(s, d)] = b; 
```

或者，您可以`std::pair`像这样构造：

```
Road_map[pair<string,string>(s,d)] = b; 
```

该`std::make_pair`方法使您不必命名 和 的`s`类型`d`。

请注意，此处的适当函数 is`operator[]`和 not `insert`。`std::map::insert`接受一个`std::pair`包含要插入的键和值的参数。你必须这样做：

```
Road_map.insert(pair<const pair<string,string>, int>(make_pair(s, d), b); 
```

您可以通过以下方式使它更漂亮`typedef`：

```
typedef map<pair<string,string>, int> map_type;
Road_map.insert(map_type::value_type(map_type::key_type(s, d), b)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T19:00:09.650

改为使用`std::make_pair`。像这样：

```
#include <string>
using namespace std;
class Roads
{  
 public:  
    map< pair<string,string>, int > Road_map; 
    void AddRoad( string s, string d )
    { 
        int b = 2 ; 
        Road_map[make_pair(s,d)] = b; 
    }

 }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T19:01:36.997

对于a `map<K, T>`，`value_type`其实是`pair<K const, T>`。但是，访问它的最简单方法是使用 typedef：

```
typedef std::pair<std::string, std::string> string_pair;
typedef std::map<string_pair, int>             map_type;

// ...

Road_map.insert(map_type::value_type(map_type::key_type(s, d), b)); 
```

在 C++11 中，您可以使用更简单的`emplace`接口：

```
Road_map.emplace(map_type::key_type(s, d), b); 
```

# java - java原始包装器的泛型

> ID：14084921
> 
> 赞同：3
> 
> 时间：2012-12-29T18:59:06.560
> 
> 标签：java, generics

> **可能重复：**
> [比较两个通用数字的值](https://stackoverflow.com/questions/2683202/comparing-the-values-of-two-generic-numbers)

我想写一些测试方法`Numbers`（`Long`,`Integer`等），如下所示：

```
public static <T extends Number> boolean isBetween(T min, T max, T number) {
    return min.compareTo(number) <= 0 && max.compareTo(number) >= 0; 
} 
```

但我得到一个编译错误说：

> 类型 T 的 compareTo(T) 方法未定义

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T19:09:38.367

`Number`没有实现`Comparable`（请参阅[Why doesn't java.lang.Number implement Comparable?](https://stackoverflow.com/questions/480632/why-doesnt-java-lang-number-implement-comparable)了解基本原理），但您可以将自己限制在执行以下操作的`Number`s 中：

```
public static <T extends Number & Comparable<T>> boolean isBetween ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:16:48.950

你需要做铸造。以下应该工作

```
return ((Comparable<T>) min).compareTo(number) <= 0 && ((Comparable<T>) max).compareTo(number) >= 0; 
```

# c# - 如何处理 xUnit .net 的 Assert.Throws 中的任务抛出的异常 ?

> ID：14084923
> 
> 赞同：21
> 
> 时间：2012-12-29T18:59:11.723
> 
> 标签：c#, async-await, c#-5.0, xunit.net

以下带有修饰符标记的异步`xUnit.net`测试因报告未引发异常而失败：`lambda``async`

```
 [Theory, AutoWebData]
    public async Task SearchWithNullQueryThrows(
        SearchService sut,
        CancellationToken dummyToken)
    {
        // Fixture setup
        // Exercise system and verify outcome
        Assert.Throws<ArgumentNullException>(async () =>
            await sut.SearchAsync(null, dummyToken));
        // Teardown
    } 
```

为了确保 an`ArgumentNullException`被实际抛出，我明确地使用了一个`try-catch`块。它有效，但是生成的代码不干净（与第一个测试相比）：

```
[Theory, AutoWebData]
public async Task SearchWithNullQueryThrows(
    SearchService sut,
    CancellationToken dummyToken)
{
    // Fixture setup
    var expected = typeof(ArgumentNullException);
    Type actual = null;
    // Exercise system
    try
    {
        await sut.SearchAsync(null, dummyToken);
    }
    catch (ArgumentNullException e)
    {
        actual = e.GetType();
    }
    // Verify outcome
    Assert.Equal(expected, actual);
    // Teardown
} 
```

为什么带有修饰符`Assert.Throws<T>`的`lambda`标记失败？`async`

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-31T16:35:20.940

**更新**

这已在 xUnit 2 中解决，增加了`Assert.ThrowsAsync`.

* * *

我怀疑那`Assert.Throws`是不知道的`async`。我建议向 xUnit 团队提出这个问题，建议`ThrowsAsync`添加一个。

在这种`async`情况下，委托正在返回`Task`or `Task<T>`，并且`ArgumentNullException`不会直接从委托中抛出；相反，它被放置在`Task`( `Task.Exception.InnerException`) 上。`Assert.Throws`期望异常直接从委托中抛出，而不是放在返回值的属性上。

您可以这样创建自己的`AssertEx.ThrowsAsync`：

```
public static async Task ThrowsAsync<TException>(Func<Task> func)
{
  var expected = typeof(TException);
  Type actual = null;
  try
  {
    await func();
  }
  catch (Exception e)
  {
    actual = e.GetType();
  }
  Assert.Equal(expected, actual);
} 
```

可以这样使用：

```
[Theory, AutoWebData]
public async Task SearchWithNullQueryThrows(
    SearchService sut,
    CancellationToken dummyToken)
{
    // Fixture setup
    // Exercise system and verify outcome
    await AssertEx.ThrowsAsync<ArgumentNullException>(async () =>
        await sut.SearchAsync(null, dummyToken));
    // Teardown
} 
```

我在 MSTest 中使用了类似的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-25T09:22:23.147

如果您还需要返回异常来验证它，那么这可能很有用：

```
public static async Task<Exception> AssertThrowsAsync<TException>(Func<Task> func)
    {
        var expected = typeof (TException);
        Exception exception = null;
        Type actual = null;
        try
        {
            await func();
        }
        catch (Exception e)
        {
            actual = e.GetType();
            exception = e;
        }
        Assert.NotNull(exception);
        Assert.Equal(expected, actual);
        return exception;
    } 
```

# javascript - Angularjs ng-show 基于回调

> ID：14084932
> 
> 赞同：8
> 
> 时间：2012-12-29T19:00:16.287
> 
> 标签：javascript, angularjs

我是 Angular 新手，所以也许我遗漏了一些东西。

在我的注册表单上，我需要用户的位置。根据他们是否允许/支持 navigator.geolocation，我想显示一个下拉菜单来选择一个位置。

控制器。

```
$scope.showLoc = true;
if(navigator && navigator.geolocation){
    navigator.geolocation.getCurrentPosition(function(pos){
        $scope.showLoc = false;
    },function(err){
        $scope.showLoc = true;
    });
} 
```

和我的表格：

```
<form class="form-horizontal" name="register"  ng-controller="RegisterCtrl"  ng-submit="registerUser()"> .... 
<div ng-show="showLoc" accesskey="">
    test
</div>
....
 </form> 
```

这种方法对我不起作用。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-29T21:02:19.677

每当您在 angularjs 之外执行某种形式的操作时，例如使用 jquery 进行 ajax 调用，或者像此处的示例一样获取地理位置，您都需要让 angular 知道更新自身。我查看了您的 jsfiddle 并将您的一些代码更改为如下所示：

```
var app = angular.module('myApp', []);
app.controller('RegisterCtrl',function($scope){
     $scope.showLoc = false;   
     navigator.geolocation.getCurrentPosition(function(pos){
             $scope.showLoc = true;
             $scope.$apply();
        },function(err){           
             $scope.showLoc = false;
             $scope.$apply();            
        });
}); 
```

现在 showLoc 在更新时更改为 true。[这是使用 $apply() 方法的文档http://docs.angularjs.org/api/ng.$ro](http://docs.angularjs.org/api/ng.$rootScope.Scope#$apply) ​​otScope.Scope#$apply

**jsFiddle** [http://jsfiddle.net/yLFNP/6/](http://jsfiddle.net/yLFNP/6/)

**编辑：我的答案已被编辑，但我不同意编辑**。虽然您可以将 $apply 方法包装在 $scope.showLoc = false 周围以使其“更短”，但您实际上只保存了 1 个字符（分号）。此外，我更喜欢在一堆逻辑之后使用 $apply 方法，而不是将所有内容都包装在其中。如果我对范围做了更多的事情，你要么必须像这样编写每一个额外的事情：

```
$scope.$apply($scope.var1 = newValue1);
$scope.$apply($scope.var2 = newValue2);
$scope.$apply($scope.var2 = newValue3); 
```

我觉得有点矫枉过正，或者你可以使用函数方法：

```
$scope.$apply(function(){
    $scope.var1 = newValue1;
    $scope.var2 = newValue2;
    $scope.var3 = newValue3;
}); 
```

或者直接在需要“应用”的代码之后：

```
$scope.var1 = newValue1;
$scope.var2 = newValue2;
$scope.var3 = newValue3;
$scope.$apply(); 
```

通过一直使用这种方法，您的代码很容易转移并且非常易读。此外，更少的线条并不总是最好的方法。

# javascript - 为什么这些不需要在这里定义？

> ID：14084942
> 
> 赞同：0
> 
> 时间：2012-12-29T19:01:11.893
> 
> 标签：javascript, jquery, variables, requirejs-define

我正在查看 Google 提供的 API，我需要将它翻译成 jQuery，所以我做到了。在 Google 的代码中，Google 定义了创建的元素，但它可以在没有在 jQuery mobile 中定义它们的情况下工作。我是编程新手，所以我不确定这是否重要？该代码在控制台日志上没有错误，无需定义。

谷歌：

```
google.maps.event.addListener(panoramioLayer, 'click', function(photo) {
    var li = document.createElement('li');
    var link = document.createElement('a');
    link.innerHTML = photo.featureDetails.title + ': ' +
       photo.featureDetails.author;
    link.setAttribute('href', photo.featureDetails.url);
    li.appendChild(link);
}); 
```

jQuery：

```
google.maps.event.addListener(panoramioLayer, 'click', function(photo) {
    $(document.createElement("a")).html("photo.featureDetails.title + ': ' + photo.featureDetails.author");
    $("a").attr("href", photo.featureDetails.url);
    $("li").append("a");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:14:43.083

正确的转换应该是这样的：-

```
google.maps.event.addListener(panoramioLayer, 'click', function(photo) {
    var anchor=$("<a/>").html(photo.featureDetails.title + ': ' + photo.featureDetails.author).attr("href", photo.featureDetails.url);
    $("<li/>").append(anchor);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:18:32.370

像这样的东西应该工作：

```
google.maps.event.addListener(panoramioLayer, 'click', function(photo) 
{
    var $link = $(document.createElement("a")).html(photo.featureDetails.title + ': ' + photo.featureDetails.author);
    $link.attr("href", photo.featureDetails.url);
    $("<li/>").append($link);
}); 
```

您需要存储创建的链接标签，这样您就不会更改所有标签的href

# android - 倾斜地图视图

> ID：14084944
> 
> 赞同：0
> 
> 时间：2012-12-29T19:01:36.327
> 
> 标签：android, google-maps, rotation

我正在尝试找到一种倾斜地图视图的方法。我正在使用 setRotationX，但是如果我还围绕 z 轴旋转（在旋转之前包含视图的部分），则屏幕的一部分会变黑。设置背景无济于事，调整相机距离也无济于事。有人可以给我一些建议吗？这是我到目前为止所拥有的：

```
rotationView.setBackgroundResource(android.R.color.holo_blue_bright);
enhancedMapView.setBackgroundResource(android.R.color.holo_blue_bright);
//Log.i("MapView","Rotating");
rotationView.setPivotX(rotationView.getWidth()/2);
rotationView.setPivotY(rotationView.getHeight()/2);
enhancedMapView.setRotationX(45);
rotationView.setRotationDegrees(45);
enhancedMapView.setCameraDistance(3000); 
```

（地图视图包含在处理 z 轴旋转的视图中，通过调用函数 setRotationDegrees）。

# jquery - 创建超链接文件输入控件

> ID：14084945
> 
> 赞同：0
> 
> 时间：2012-12-29T19:01:36.337
> 
> 标签：jquery, html

有没有办法创建一些 html/jquery 来显示超链接，然后单击它时它的行为就像文件输入控件？

我想拥有这个 html 的功能，但超链接的外观..

```
 <input id="fileToUpload" type="file" size="60" name="fileToUpload" class="input" value="myFile.xml"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T19:29:14.030

将输入的可见性设置为隐藏。单击链接时触发对输入的单击

```
$('#fileLink').click(function(){
    $('#fileToUpload').click()
}) 
```

演示：http: [//jsfiddle.net/mhVtA/](http://jsfiddle.net/mhVtA/)

未在所有浏览器中测试

# javascript - 使用 javascript 更改 onclick 值

> ID：14084951
> 
> 赞同：1
> 
> 时间：2012-12-29T19:01:56.247
> 
> 标签：javascript, html

我对 JS 很陌生，也许这是一个非常平庸的问题，但我仍然无法弄清楚出了什么问题。我有这个简单的 html 代码：

```
<span>1</span>
<input id="check1" type="radio" value="a1"/>
<span>2</span>
<input id="check2" type="radio" value="b2"/>
<span>3</span>
<input id="check3" type="radio" value="c3"/>
<span>4</span>
<input id="check4" type="radio" value="a4"/>
<span>5</span>
<input id="check5" type="radio" value="b5"/>

<input id="red" type="button" value="Go" onclick=""/> 
```

我想要实现的是，根据选中的收音机更改 onclick 属性。例如，如果 check1 和 check2 被选中，则转到 google.com，如果 check1 和 check3 则转到 jsfiddle.net 等等。所以我写了一个简单的Javascript：

```
window.onchange = function redirect(){

  if (document.getElementById('check1').checked && document.getElementById('check2').checked) {
    location.href='www.google.com';
    // document.getElementById('red').onclick="www.google.com"
  }

  else if (document.getElementById('check1').checked &&    document.getElementById('check3').checked) {
    location.href='www.jsfiddle.net';
    // document.getElementById('red').onclick="window.open('www.jsfiddle.net')"
  }
} 
```

[在这里](http://jsfiddle.net/gracedescending/UURj7/46/)你可以找到一个 JS Fiddle。我想做的是像处理图像一样设置 onclick 属性，使用 getElementById 然后设置他的源，所以我写了 document.getElementById('red').onclick="window.open('random page') “但由于某种我无法理解的原因，它不起作用。

**问题：**

1）正如您在我的代码中看到的那样，我写了一个 location.href='address' 显然不等待用户单击按钮，所以这不是一个解决方案，我怎样才能使它工作？

2）有没有办法让这段代码更具可扩展性？我的意思是，将来如果我想添加另一个收音机，我将不得不手动修改代码并插入另一个，如果我想到了类似的东西：

```
var radio = document.getElementByName('radio') //not sure if this is the right getElement
for (var i=1; i<radio.lenght; i++){
   if radio[i].checked{ //is this right?
      for (var n=i+1; n<radio.lenght; n++){
          if radio[n].checked{
             document.getElementById('red').onclick="window.open('random page')"
          }
       }
 } 
```

欢迎对我的代码提出任何建议。

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:34:44.213

在 JS Fiddle 中试试这个。它包含如何监听按钮的 onclick 事件并获取单选按钮的选中值。

HTML部分：

```
 <form action="">
    <input type="radio" name="vehicle" value="Yes" id='yes'>Yes<br>
    <input type="radio" name="vehicle" value="No" id='no'>No
    </form>
    <input id="red" type="button" value="let's go"/> 
```

JS部分：

```
 document.getElementById('red').onclick = function() {
       if (document.getElementById('yes').checked) {
           alert('I have a Vehicle.');
       } else if(document.getElementById('no').checked) {
           alert('I don\'t have a Vehicle.');
       } else {
           alert('No answer.');
       }
   } 
```

如果您使用单选按钮，并且您希望一次只有一个可供用户选择，您必须为它们设置相同的名称属性。

您还可以使用单选按钮的 value 属性来存储重定向 URL。

这是一个对您更有用的示例。

HTML部分：

```
 <form action="">
        <input type="radio" name='redirect' value='https://www.google.com/' id='google'>Google<br />
        <input type="radio" name='redirect' value='http://www.jsfiddle.net/' id='jsFiddle'>JS Fiddle<br />
        <input type="radio" name='redirect' value='https://www.facebook.com/' id='Facebook'>Facebook
    </form>

    <input id="red" type="button" value="let's go"/> 
```

JS部分：

```
 document.getElementById('red').onclick = function() {
       var options = document.getElementsByName('redirect'),
           length = options.length,
           i = 0;

       for (i; i < length; i++) {
           if (options[i].checked) {
               window.open(options[i].value);
           }
       }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:15:37.043

```
if (document.getElementById('check1').checked&&document.getElementById('check2').checked)
{
    document.getElementById('red').onclick=function(){
      window.location.href ='http://www.google.com';
     };
} 
```

此代码将函数绑定到 id='red' 元素的 onclick 事件。因此，只要选中/取消选中任何单选按钮，就添加一堆这样的条件并更改 onclick 绑定。

# php - 使用“GROUP BY”子句时 PHP SQLite PDO 非常慢

> ID：14084953
> 
> 赞同：1
> 
> 时间：2012-12-29T19:02:00.500
> 
> 标签：php, zend-framework, sqlite, zend-db-profiler

我有这个项目在这里玩费城犯罪数据。我正在构建此查询以按类型和警区选择事件。在 PHP 和 Zend 中需要 21 秒，但在命令行中不到 3 秒。

我使用 Zend_Db_Profiler 进行调试，调试输出如下：

> numQueries：2
> 查询：连接
> 经过的秒数：0.0019519329071045
> 查询：选择“事件”。* FROM“事件”在哪里（dc_dist = '15'）和（较低（text_general_code）='凶杀案'）按“location_block”
> 经过的秒数：21.583115816116

如果我将相同的 select 语句复制并粘贴到 sqlite3 命令行客户端，则可能需要 3 秒。

我在这里错过了什么吗？为什么 Zend 需要 21 秒？

**更新：**

仅使用 PDO 运行脚本仍会导致 21 秒的查询：

```
// Create (connect to) SQLite database in file
    $file_db = new PDO('sqlite:../db/crime.db');
    // Set errormode to exceptions
    $file_db->setAttribute(PDO::ATTR_ERRMODE, 
                            PDO::ERRMODE_EXCEPTION);

    $start_time = microtime(true);
    // Select all data from memory db messages table 
    $result = $file_db->query("SELECT 'incident'.* FROM 'incident' WHERE (dc_dist = '15') AND (lower(text_general_code) = 'homicide') GROUP BY 'location_block'");
    $end_time = microtime(true);

    $elapsed_time = $end_time - $start_time;

    print "query took " . $elapsed_time . " seconds\n"; 
```

输出：

> 查询耗时 21.751929998398 秒

**第二次更新**

看起来它是除了 sql 语句之外的组，它把它全部支撑起来。如果我删除它，然后运行 ​​pdo 脚本或 zend 框架应用程序，它会达到与直接从命令行相同的速度：

使用 'GROUP BY' 子句，23 秒：

> numQueries: 2
> query: connect
> elapsed seconds: 0.0007779598236084
> query: SELECT "incident".* FROM "incident" WHERE (dc_dist = '15') AND (lower(text_general_code) = 'homicide') GROUP BY "location_block"
> 经过的秒数：23.092380046844

没有 'GROUP BY' 子句，在一秒钟内：

> numQueries: 2 查询：连接
> 经过的秒数：0.0011060237884521
> 查询：选择“事件”。* FROM “事件”WHERE (dc_dist = '15') AND (lower(text_general_code) = 'homicide')
> 经过的秒数：0.080777883529663

# java - Java Jung 对象实例化

> ID：14084958
> 
> 赞同：0
> 
> 时间：2012-12-29T19:02:26.617
> 
> 标签：java, instantiation, jung

我正在尝试从 Java Jung Graph Package 构建以下内容：[EdmondsKarp Object](http://jung.sourceforge.net/doc/api/index.html)

```
EdmondsKarpMaxFlow<MyNode, MyLink> alg = new EdmondsKarpMaxFlow<MyNode, MyLink>(g, n2, n5, capTransformer, edgeFlowMap, flowEdgeFactory); 
```

我不知道为什么会出现错误，这是来自 NetBeans 的错误消息：
`reason: actual argument org.apache.commons.collections15.Transformer<selfsimilarity.MyLink,java.lang.Double> cannot be converted to org.apache.commons.collections15.Transformer<selfsimilarity.MyLink,java.lang.Number> by method invocation conversion`。

我基本上是在[学习教程](http://www.grotto-networking.com/JUNG/JUNG2-Tutorial.pdf)。

EdmondsKarpMaxFlow 实例位于构造函数的底部。在构造函数之后，我将所有参数的代码提供给 EdmondsKarp 对象。这些参数是图、源节点和汇节点、容量转换器、地图和边缘工厂。

```
public GraphAlgTests()
    {
        g = new DirectedSparseMultigraph<MyNode, MyLink>();
        // Create some MyNode objects to use as vertices
        MyNode n1 = new MyNode(1); MyNode n2 = new MyNode(2); MyNode n3 = new MyNode(3);  
        MyNode n4 = new MyNode(4); MyNode n5 = new MyNode(5); 
        // Add some directed edges along with the vertices to the graph
        g.addEdge(new MyLink(2.0, 48),n1, n2, EdgeType.DIRECTED); // This method
        g.addEdge(new MyLink(2.0, 48),n2, n3, EdgeType.DIRECTED);
        g.addEdge(new MyLink(3.0, 192), n3, n5, EdgeType.DIRECTED); 
        g.addEdge(new MyLink(2.0, 48), n5, n4, EdgeType.DIRECTED); // or we can use
        g.addEdge(new MyLink(2.0, 48), n4, n2); // In a directed graph the
        g.addEdge(new MyLink(2.0, 48), n3, n1); // first node is the source 
        g.addEdge(new MyLink(10.0, 48), n2, n5);// and the second the destination

        EdmondsKarpMaxFlow<MyNode, MyLink> alg = new EdmondsKarpMaxFlow<MyNode, MyLink>(g, n2, n5, capTransformer, edgeFlowMap, flowEdgeFactory);
    }

public class MyNode 
{
    private int id; // good coding practice would have this as private
    public MyNode(int id) 
    {
        this.id = id;
    }
    public String toString() 
    {                        // Always a good idea for debuging
        return "v"+id;       // JUNG2 makes good use of these.
    }        
}

public class MyLink 
{
    double capacity; // should be private 
    double weight;   // should be private for good practice
    int id;
    int edgeCount = 0;

    public MyLink(double weight, double capacity) 
    {
        this.id = edgeCount++; 
        this.weight = weight;
        this.capacity = capacity;
    } 
    public String toString() 
    { // Always good for debugging
        return "E"+id;
    }
}

   Transformer<MyLink, Double> capTransformer = new Transformer<MyLink, Double>()
   //INFO: Gives the capacity of an edge, denoted here as a "link"
   {
       @Override
       public Double transform(MyLink link)
       {
           return link.capacity;
       }
   };

   Map<MyLink, Double> edgeFlowMap = new HashMap<MyLink, Double>();
   Factory<MyLink> flowEdgeFactory = new Factory<MyLink>()
   {
        @Override
        public MyLink create()
        {
            return new MyLink(1.0, 1.0);
        }
   }; 
```

如果还有什么可以帮助的，请告诉我！感谢所有的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:31:09.430

它准确地告诉您该构造函数的[Javadocs](http://jung.sourceforge.net/doc/api/edu/uci/ics/jung/algorithms/flows/EdmondsKarpMaxFlow.html)告诉您什么：

```
public EdmondsKarpMaxFlow(DirectedGraph<V,E> directedGraph,
                          V source,
                          V sink,
                          org.apache.commons.collections15.Transformer<E,Number> edgeCapacityTransformer,
                          Map<E,Number> edgeFlowMap,
                          org.apache.commons.collections15.Factory<E> edgeFactory) 
```

你`Transformer`是`<MyLink, Double>`它需要的时候`<MyLink, Number>`（并且你的`transform()`方法需要被定义为返回 a `Number`）

这可能在 API 中的某个时间点发生了更改，并且您使用的教程已过时。API 现在很可能正在调用您将返回`doubleValue()`的对象。`Number`

你的情况似乎也是如此`edgeFlowMap`。

# python - buildout 真正使用的是什么索引？

> ID：14084959
> 
> 赞同：0
> 
> 时间：2012-12-29T19:02:28.167
> 
> 标签：python, buildout, pypi

我正在尝试使用以下构建配置安装 couchdbkit：

```
[buildout]
parts = eggs
include-site-packages = false
versions = versions

[eggs]
recipe = zc.recipe.egg:eggs
eggs =
    couchdbkit

[versions]
couchdbkit = 0.6.3 
```

它成功安装了软件包，但是*在某些机器上*的安装过程中出现了很多这样的错误：

```
Download error on http://hg.e-engura.org/couchdbkit/: [Errno -2] Name or service not known -- Some packages may not be found! 
```

默认构建应该使用[这个](http://pypi.python.org/simple)索引找到包。但我无法理解这个奇怪主机名的来源。[这里](http://pypi.python.org/simple/couchdbkit/)没有任何东西指向这个位置。

它实际上是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T08:57:59.817

底层代码还从[简单索引](http://pypi.python.org/simple/couchdbkit/)`setuptools`中扫描`homepage`和链接，并且非常积极地执行此操作。`download`

该[`couchdbkit` `setup.py`文件](https://github.com/jeremi/couchdbkit/blob/master/setup.py)`http://hg.e-engura.org/couchdbkit/`作为主页列出，因此`homepage`简单索引链接上的所有链接都在那里。

您可以`zc.buildout`通过设置它*可以*连接到的主机的白名单来防止尝试连接到该主机：

```
[buildout]
# ...

allow-hosts =
   *.python.org
   *.google.com
   *.googlecode.com
   *.sourceforge.net 
```

例如。

# oracle - 使用 when-validate-item 检查唯一项目

> ID：14084960
> 
> 赞同：-3
> 
> 时间：2012-12-29T19:02:33.753
> 
> 标签：oracle, triggers, oracleforms

我想检查我的项目是否在我的数据库中变得唯一，并且数据库中存在的项目必须是明确的（这个项目）。

所以我对这个项目使用触发 when-validate-item 并为表单全局触发 when-timer-expired。

这是我的代码：

//触发when-Validate-item：

```
declare
  i number;    
  vTimer TIMER;
begin
  IF //condition then
      i := show_alert('ERROR');    
      /* Create a timer with a 10 Millisecond delay */
      vTimer :=create_timer('TEMP',10,no_repeat);
  END IF;
end; 
```

//当定时器过期时触发

```
GO_BLOCK ('name_block');    
:name_block.item1:=NULL;
DELETE_TIMER('TEMP'); 
```

但在运行时，我收到此错误：

> FRM-40202 必须输入字段

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T06:05:12.813

1.  要强制唯一性，您应该在表上使用唯一约束。

2.  要清除该项目，您可以在 wvi 触发器中为其分配 NULL，您不需要计时器；但不建议这样做，因为它可能会混淆和激怒您的用户。

3.  您可能会收到 FRM-40202，因为您的计时器试图导航离开标记为必需的项目。

# algorithm - 如何确定 6 + 1 位的最大纠错/检测方法？

> ID：14084965
> 
> 赞同：2
> 
> 时间：2012-12-29T19:02:51.757
> 
> 标签：algorithm, error-correction

对于将从图像中识别的数字，我有以下限制：

*   6位数据
*   1位纠错
*   前 6 位数字不能更改（它们必须是人类可读的）
*   校验位必须保持为数字

目前的纠错方案是基于校验和，使得第7位是前6位和的最后一位。

例如

```
123456 => 1234561
999999 => 9999994
472912 => 4729125
219274 => 2192745 
```

如何确定此方案可以检测/纠正的错误数量和类型，是否有方案可以提供更好的错误检测？（对于我的用例，错误检测比纠错更重要）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T19:07:09.213

您可以尝试[Luhn](http://en.wikipedia.org/wiki/Luhn_algorithm)，它比您描述的要复杂一些，但它会满足您的要求。

来自维基百科的复制粘贴：

> Luhn 算法将检测任何单个数字的错误，以及几乎所有相邻数字的换位。但是，它不会检测两位数序列 09 到 90 的转置（反之亦然）。它将检测 10 个可能的孪生错误中的 7 个（它不会检测到 22 ↔ 55、33 ↔ 66 或 44 ↔ 77）。
> 
> 其他更复杂的校验位算法（例如 Verhoeff 算法和 Damm 算法）可以检测到更多的转录错误。Luhn mod N 算法是支持非数字字符串的扩展。
> 
> 因为该算法以从右到左的方式对数字进行操作，并且零位仅在它们导致位置偏移时才会影响结果，因此在数字字符串的开头填充零不会影响计算。因此，填充到特定位数的系统（例如，通过将 1234 转换为 0001234）可以在填充之前或之后执行 Luhn 验证并获得相同的结果。
> 
> 将 0 添加到奇数长度的数字使您可以从左到右而不是从右到左处理数字，从而将奇数位加倍。
> 
> 该算法出现在用于计算校验和的手持式机械设备的美国专利中。因此要求它相当简单。该设备通过机械方式获取了 mod 10 的总和。替换数字，即 double 和 reduce 过程的结果，不是机械产生的。相反，这些数字是在机器主体上按排列顺序标记的。

# java - Android java utf-8 编码字符串

> ID：14084966
> 
> 赞同：0
> 
> 时间：2012-12-29T19:03:04.650
> 
> 标签：java, android, character-encoding, zbar-sdk, zbar

我正在尝试使用[zbar](http://zbar.sourceforge.net/)库构建一个 Android 应用程序来扫描代码。我生成了 UTF-8 编码的二维码，并正在使用这个 Android 应用程序来扫描它们。我正在编码的文本是“L'étoile”。我尝试了默认的 zbar 测试程序，发现它不能正确显示重音字符。所以我在下面稍微修改了它的代码，以便调试它并理解它为什么不能正确显示字符。

```
byte[] bytes = sym.getDataBytes();
String latin1Result = new String(bytes, "ISO8859-1");
String utf8Result = new String(bytes, "UTF-8");
Log.d("CUSTOM_DEBUG_TAG", "result " + sym.getData() + ", string " + sym.getData().toString() + ". latin1 result " + latin1Result + ". utf8 result " + utf8Result); 
```

从日志中我得到：

```
CUSTOM_DEBUG_TAG(11987): result L'ﾃｩtoile, string L'ﾃｩtoile. latin1 result L'ï¾ï½©toile. utf8 result L'ﾃｩtoile 
```

在字符集和编码方面我有点迷茫，所以请多多包涵。从上面的日志中，我可以确认 zbar 库实际上返回了一个 UTF-8 编码的字符串“L'étoile”吗？如果是这样，它不应该在日志中正确显示吗？

我相信 zbar 使用 iconv 并且默认为 ISO-8859-1。所以我也尝试生成一个带有 iso-8859-1 编码文本的二维码。然后我尝试使用 Android 应用程序读取二维码，日志显示如下：

```
CUSTOM_DEBUG_TAG(11987): result L'騁oile, string L'騁oile. latin1 result L'é¨oile. utf8 result L'騁oile 
```

如您所见，我无法检索重音字符串“L'étoile”。显然，有些概念我无法掌握，希望能有所帮助。

顺便说一句，如果我使用 QR Droid 或 Zxing 等应用程序扫描相同的二维码，我会得到正确显示为“L'étoile”的字符串（因此我放弃了二维码本身可能存在问题的事实）。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-26T17:36:50.930

经过反复试验，zbar 似乎不使用 ISO-8859-1 编码，而是在发现特殊字符时使用 Shift_JIS。这对我有用：

```
byte[] b = sym.getData().getBytes("Shift_JIS");
String value = new String(b, "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:18:16.140

缺少破折号 (-)。

```
String latin1Result = new String(bytes, "ISO-8859-1"); 
```

简单地使用 new String(bytes) 将使用默认平台编码，这会创建一个不太便携的应用程序。

如果这没有帮助，请尝试使用字符串文字来查看问题是否出在输出上。

```
String result = "\u00e9toile"; 
```

# python - 将 html 表单解析为 python / Flask 中的字典列表

> ID：14084967
> 
> 赞同：2
> 
> 时间：2012-12-29T19:03:31.430
> 
> 标签：python, html, forms, flask

我是网络编程的新手，这是我的第一个 SO 问题，所以希望我问的是正确的方法。我正在构建一个简单的调查制作工具（类似于谷歌表格或调查猴子），并且我有一个允许用户向问题添加选项的网络表格。每个选项都有两个字段，“标签”和“值”。表格如下所示：

```
 Option One
           ------------------           ------------------
    Label: |                |   Value:  |                |
           ------------------           ------------------

    Option Two
           ------------------           ------------------
    Label: |                |   Value:  |                |
           ------------------           ------------------
    ...
    ...
    ... // user can "add option" and additional "rows" will appear in the form

[ SUBMIT ] 
```

我使用了这样的基本网络表单：

```
<form class="well form" action="/submitform" method="post">
  <p><input type="text" name="label_1">
     <input type="text" name="value_1"></p>
  <p><input type="text" name="label_2">
     <input type="text" name="value_2"></br></p>
  <p>...   // and so forth, to support n sets of two fields
     ...
     ...
  <button type="submit">Submit</button>
</form> 
```

我成功获得 request.form 并且可以访问字典中的每个变量。但当然它是一个单一的平面字典：

```
[{'label_1': 'labelone', 'value1': 'valueone', 'label_2': 'label two'}] 
```

等等。我想要一个这样的字典列表：

```
[ {'label': 'labelone', 'value': 'valueone'}, {'label': 'labeltwo', 'value': 'valuetwo'}] 
```

我已经想到了几种骇人听闻的方法来做到这一点，但都需要预先了解表单选项的数量和类型。我宁愿找到更灵活的解决方案。

这里有什么最佳实践吗？很多网站都做这样的事情，所以我猜我缺少一个最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:09:54.717

也许是 html 数组？（我不知道它们的正式名称是什么）结合[`getlist`](http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict.getlist)

```
<p><input type="text" name="user_label[0]">
     <input type="text" name="user_value[0]"></p>
  <p><input type="text" name="user_label[1]">
     <input type="text" name="user_value[1]"></br></p> 
```

我在想这可以做类似的事情

```
request.form.getlist('user_label')
request.form.getlist('user_value') 
```

你可以把它们拉在一起，形成一对`lables: values`

我还没有用烧瓶测试过这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:19:37.953

那这个呢？

```
l = [{'label_1': 'labelone', 'value_1': 'valueone', 'label_2': 'label two', 'value_2':'v2'}]

values = int(len(l[0])/2)
dicts = []
for i in range(values):
    label_name = 'label_%s' % (i+1)
    value_name = 'value_%s' % (i+1)
    dicts.append({'label':l[0][label_name], 'value':l[0][value_name]}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-16T22:04:25.520

这对我有用。

在我的 Jinja 模板中，我有以下标记

```
{% for object in objects %}
<div>
<input type="hidden" name="id" value="{{object.id}}">
<input type="text" name="name" value="{{object.name}}">
<input type="text" name="age" value="{{object.age}}">
</div>
{% endfor %} 
```

然后在我的 Flask 应用程序中

```
@app.route("/update/", methods=["POST"])
def update_people():
    ids = request.form.getlist('id')
    names = request.form.getlist('name')
    ages = request.form.getlist('age')
    data = [{'id': ids[k], 'name': names[k], 'age': ages[k]} for k,v in enumerate(ids)]
    # [ {'id': 1, 'name': 'Bob', 'age': 25 }, ... ] 
```

# c++ - getName() 函数未检索名称

> ID：14084970
> 
> 赞同：0
> 
> 时间：2012-12-29T19:03:50.337
> 
> 标签：c++, iterator

我正在处理一个图表，我要做的第一件事就是从数据文件中通过对象的名称以及它们在世界大陆中的位置来查找对象。

我为名为“getName()”的对象创建了一个函数

```
string CCountry::getName()
{
return *name;
} 
```

以下代码循环。它识别出 tempCont 中有 9 个 CCountry，它进入内部循环，在该循环中它没有为国家/地区提取任何名称（我检查过，它们确实有名称），然后进入 seg 错误。

```
for (list<CContinent>::iterator it=world.begin(); it != world.end(); it++)
    {
        list<CCountry> *tempCont = it->getCountries();
        for (list<CCountry>::iterator it2=tempCont->begin(); it2 != tempCont->end(); it2++)
        {   
            cout << it2->getName() << flush;
            if (it2->getName() == homeCountryName)
            {
                *homeCountry = *it2;
            }
        }
    } 
```

# java - VB.Net 服务器和 Java 客户端（套接字）发送和接收文本

> ID：14084978
> 
> 赞同：1
> 
> 时间：2012-12-29T19:04:50.323
> 
> 标签：java, vb.net, sockets, tcp, client

我是 Java 编程新手，我编写了一个简单的服务器（VB.NET）/客户端（Java）程序。来自 Java 的文本已成功发送到 VB.Net，但在 Java 中未收到来自 VB.Net 的响应

我错过了什么吗？

这是我的代码

VB.NET（服务器）

```
Imports System.Net.Sockets, System.Text
Public Class Form1

Dim server As New TcpListener(9999)
Dim client As New TcpClient
Dim stream As NetworkStream

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Me.Text = "Waiting...."
    server.Start()
    client = server.AcceptTcpClient
    'Receive msg'
    stream = client.GetStream()
    Dim r_byt(client.ReceiveBufferSize) As Byte
    stream.Read(r_byt, 0, client.ReceiveBufferSize)
    Dim str As String = Encoding.ASCII.GetString(r_byt)
    Label1.Text = str
    'Send msg'
    Dim s_byt() As Byte = Encoding.UTF8.GetBytes("got it")
    stream.Write(s_byt, 0, s_byt.Length)
    stream.Close()
End Sub

End Class 
```

Java（客户端）

```
import java.io.*;
import java.net.*;

public class frmClient {

public static void main(String[] args) throws Exception{
    frmClient myCli = new frmClient();
    myCli.run();

}

public void run() throws Exception{
    Socket socket = new Socket("192.168.0.100", 9999);
    PrintStream stream = new PrintStream(socket.getOutputStream());
    stream.println("Hello Server...");

    BufferedReader buffer = new BufferedReader(new InputStreamReader(socket.getInputStream()));
    String string = buffer.readLine();
    System.out.println(string);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:46:30.030

好吧，我不确定这里有什么问题，但我建议将字符串拆分为字符，然后将数组的长度写入输出流。然后，Java 中的 for 循环可以从 DataInputStream 中单独读取字符，然后将其组装成字符串

```
DataInputStream dis = new DataInputStream(socket.getInputStream());
String chars = "";
for (int i = 0; i < dis.readInt(); i ++) {
    chars += dis.readChar();
}
System.out.println(chars); 
```

此外，vbs 流不是写行，它只是写字符。尝试在末尾附加一个断线字符“得到它\n”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:03:45.980

你的`Java`客户看起来不错。您只需要确保发送换行符以匹配`BufferedReader.readLine`语句。代替：

```
Dim s_byt() As Byte = Encoding.UTF8.GetBytes("got it") 
```

和

```
Dim s_byt() As Byte = Encoding.UTF8.GetBytes("got it" + vbCr) 
```

在您的服务器中。

* * *

*旁白：*我会在这里看看*线程*服务器，因为它在侦听连接时阻塞了应用程序。这是一个[例子](http://vb.net-informations.com/communications/vb.net_multithreaded_server_socket_programming.htm)

# android - 如何以编程方式在 android 上读取/设置默认安装位置？

> ID：14084979
> 
> 赞同：2
> 
> 时间：2012-12-29T18:07:43.150
> 
> 标签：android

我知道可以通过调用 adb 方法来检索 Android 中应用程序的默认安装位置：

```
adb shell pm getInstallLocation 
```

并且可以使用以下方法进行更改：

```
adb shell pm setInstallLocation 
```

但我的问题是我们如何以编程方式实现这一点（使用 Android API 或 Java 代码）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T21:01:31.527

Android 开发者文档的[应用安装位置](http://developer.android.com/guide/topics/data/install-location.html)页面提供了有关设置应用安装位置和潜在警告的信息。

为此，您需要`installLocation`在清单中指定 ，如下所示：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    android:installLocation="preferExternal"
    ... > 
```

您的选择是：

*   **preferExternal**：尽可能安装在设备的外部存储上（不保证）
*   **auto**：默认为内部存储，但允许用户将其移动到外部存储
*   **internalOnly**：只允许安装在设备的内部存储上。

您不能在应用程序的代码中设置它，因为任何执行应用程序的代码都已经安装。

# java - 获取当前类对象

> ID：14084981
> 
> 赞同：3
> 
> 时间：2012-12-29T19:05:08.767
> 
> 标签：java

我有三个班级.. A，B，C。

1.  在 B 类和 C 类中，我都有一个静态字符串变量“name”，其中包含 B 和 C 的名称，如-

> ```
>  class B
>      {
>      static name;
>      public static void main(String args[])
>      {
>      name="Class B";
>      A.getName();
>      } 
> ```

1.  我从B类和C类调用A类的getName方法。A类如下：

> A类{
> 
> ```
> getName()
> {
> System.out.println(this class called me);
> }
> } 
> ```

C类是：

> ```
>  class C
>      {
>      static name;
>      public static void main(String args[])
>      {
>      name="Class C";
>      A.getName();
>      } 
> ```

现在我的问题是，我应该使用什么代码代替 A 类中的“这个类叫我”，这样我才能得到叫 A 的类的名称！我希望我清楚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:06:16.123

您的`A.getName`方法无法知道哪个类的代码调用了它。您必须将这些信息传递给它。

好的，*严格来说这不是真的*，您可以通过生成堆栈跟踪并检查它来弄清楚。但这将是一个非常糟糕的主意。一般来说，如果一个方法需要知道一些东西，你要么 A) 让它成为实例的一部分，并将该信息作为实例数据，或者 B) 将信息作为参数传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:12:15.467

```
class A {
    getName()
    {
        StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();
        int lastStackElement = stackTraceElements.length-1;
        String callingObjectsName = stackTraceElements[lastStackElement].getClassName();
        System.out.println(callingObjectsName + " called me.");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:15:56.580

```
Modify your code to something like this:

class A 
{
   getName(String className) 
   {
      System.out.println(className);
   }
}

and use it like :

 class B
 {
     static name;
     public static void main(String args[])
     {
       name="Class B";
       A.getName(name);
     }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T20:19:22.133

听起来你真正想要做的是将信息从一个堆栈帧传递到另一个堆栈帧 - 特别是从帧 A 到帧 B，其中 A 调用 B。这是一件容易做的事情，并且我认为你过度设计它。

```
public class B {
    static String name = ...

    public static void main(String[] args) {
        A.getName(name);
    }
}
public class C {
    static String name = ...

    public static void main(String[] args) {
        A.getName(name);
    }
}

public class A {
    public static void getName(String name) {
        System.out.println(name);
    }
} 
```

您的方法需要：

1.  获取堆栈跟踪
2.  使用它来获取调用堆栈帧，它是堆栈跟踪数组中的元素 1
3.  使用它来获取调用方法的类名
4.  用于`Class.forName`获取`Class<?>`对象
5.  调用`getField("name")`该`Class<?>`对象以获取`Field`对象
6.  （可选但推荐）确认`Field`表示 String 类型的静态字段
7.  调用`get(null)`来`Field`获取它的值（`null`代表你想要该字段的对象——因为该字段是静态的，因此不绑定到任何对象，这个参数被忽略），并将这个值转换为`String`

或者，您可以：

1.  只需将名称传递给需要它的函数即可。

您的方法还要求该`name`字段是静态的，因为无法获取调用*实例*（即使您可以获得调用实例的类）。即使`name`是实例字段，更简单的方法也有效。

# php - Mag自定义选项问题

> ID：14084984
> 
> 赞同：1
> 
> 时间：2012-12-29T19:06:24.523
> 
> 标签：php, arrays, magento, loops, csv

我正在使用以下代码来获取和处理自定义选项

```
$orderIncrementId = $order->getIncrementId();
                $orderReal = Mage::getModel('sales/order')->loadByIncrementId($orderIncrementId);    

    $orderItems = $orderReal->getAllItems();   

    $sk = "";
    foreach ($orderItems as $item)
                {
      $options = $item->getProductOptions();      
      foreach ($options as $option) {
       if (is_array($option)) {
       $firstElement = array_shift($option);

   foreach ($option as $firstElement){
           if (isset($firstElement['label']) && isset($firstElement['option_value'])){
         if ($firstElement['label'] == 'Delivery Date') {
             $deliveryDate = $firstElement['option_value'];

                                }
                            }
                        }
                    }   
                  }
                } 
```

我的用法是像这样将其写入CSV

```
if (isset($deliveryDate)) {
    $outputString.= '"'.$deliveryDate.'",'; 
} else {
    $outputString.= '"deliverydate error",'; 
} 
```

现在，我已经确定

*   标签交付日期在数据库“目录产品选项标题表”中可用
*   自定义选项交货日期在“目录产品选项表”中具有值

似乎没有通过脚本访问交货日期，因此我的自定义消息“交货日期错误”保存在 CSV 中

事实上，我正在尝试调试无法正常工作的 mag 扩展......

对我来说，代码还可以，但不知道为什么它不起作用....

有人可以指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T20:30:07.910

虽然这不是完美的解决方案，但假设您的产品自定义选项是“字段”类型，这将返回您订购商品的自定义选项值。

```
foreach ($orderItems as $item) {
  $optionsArray = $item->getProductOptions();
  if(isset($optionsArray['options'])) {
    foreach ($optionsArray['options'] as $option) {
      if($option['label'] == 'Delivery Date') {
        $deliveryDate = $option['value'];
      }
    }
  }
} 
```

# python - 将列表作为默认函数参数的奇怪行为

> ID：14084988
> 
> 赞同：1
> 
> 时间：2012-12-29T19:06:59.923
> 
> 标签：python, list, default-arguments

> **可能重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)
> [列表扩展了奇怪的行为](https://stackoverflow.com/questions/13904039/list-extending-strange-behaviour)
> [Pyramid traversal view lookup using method names](https://stackoverflow.com/questions/14076046/pyramid-traversal-view-lookup-using-method-names)

假设我有这个功能：

```
def a(b=[]):
    b += [1]
    print b 
```

调用它会产生以下结果：

```
>>> a()
[1]
>>> a()
[1, 1]
>>> a()
[1, 1, 1] 
```

当我更改`b += [1]`为`b = b + [1]`时，函数的行为会发生变化：

```
>>> a()
[1]
>>> a()
[1]
>>> a()
[1] 
```

与有何`b = b + [1]`不同？`b += [1]`为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T19:11:05.797

`b += [1]`更改函数默认值（导致最不惊讶的常见问题解答）。`b = b + [1]`采用默认参数`b`- 使用 , 创建一个新列表`+ [1]`并将其绑定到`b`. 一个改变列表 - 另一个创建一个新列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T19:15:54.380

在 Python 中，不能保证`a += b`与`a = a + b`.

对于列表，就地`someList += otherList`修改，基本上等同于，然后将名称重新绑定到同一个列表。 另一方面，通过连接两个列表来构造一个*新*列表，并将名称绑定到该新列表。`someList``someList.extend(otherList)``someList``someList = someList + otherList`*`someList`*

 *这意味着，使用`+=`时，名称最终指向它已经指向的同一个对象，而使用 时`+`，它指向一个新对象。由于函数默认值只评估一次（参见[这个被大量引用的问题](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)），这意味着`+=`操作堆积起来，因为它们都修改了相同的原始对象（默认参数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:27:52.963

当你定义一个函数

```
>>> def a(b=[]):
    b += [1]
    return b 
```

它将所有默认参数保存在一个特殊的地方。它实际上可以通过以下方式访问：

```
>>> a.func_defaults
([],) 
```

第一个默认值是`list`具有 ID：

```
>>> id(a.func_defaults[0])
15182184 
```

让我们尝试调用该函数：

```
>>> print a()
[1]
>>> print a()
[1, 1] 
```

并查看返回值的 ID：

```
>>> print id(a())
15182184
>>> print id(a())
15182184 
```

如您所见，它与第一个默认值的列表的 ID 相同。

`b+=...`函数的不同输出可以通过修改`b`就地而不创建新列表这一事实来解释。并且`b`列表是否保存在默认值的元组中。因此，您对列表的所有更改都保存在那里，并且函数的每次调用都使用不同的`b`.*

# sql - 如何将多行分组为单行

> ID：14084992
> 
> 赞同：0
> 
> 时间：2012-12-29T19:07:25.760
> 
> 标签：sql

我有一个表`emp`有以下数据：

```
id name phone no
---------------------
1 smith 423-422-5226
1 smith 414-255-5252
2 george 511-522-2525
2 george 524-522-2428 
```

我需要输出为：

```
1 smith 423-422-5226, 414-255-5252
2 george 511-522-2525, 524-522-2428 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T19:22:47.807

由于您没有指定您使用的是什么 RDBMS，让我假设您正在使用标签中的 SQL Server。然后你可以使用[`FOR XML`](http://msdn.microsoft.com/en-us/library/ms178107%28v=sql.100%29.aspx)这样做，像这样：

```
SELECT 
  t1.Id,
  t1.name
  STUFF((
    SELECT ', ' + t2.phone_no
    FROM Table1 t2
    WHERE t2.ID   = t1.ID
      AND t2.Name = t1.Name
    FOR XML PATH (''))
  ,1,2,'') AS PhoneNumbers
FROM Table1 t1
GROUP BY t1.Id, 
         t1.Name; 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/9cb15/3)

这会给你：

```
| ID |   NAME |               PHONENUMBERS |
--------------------------------------------
|  1 |  smith | 423-422-5226, 414-255-5252 |
|  2 | george | 511-522-2525, 524-522-2428 | 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T19:14:25.140

这可以做到，

```
**GROUP_CONCAT() for MYSQL,NETEZZA
WM_CONCAT() for ORACLE** 
```

这是您的查询

```
select id,name, group_concat(phoneno) phoneno
from emp 
group by id,name 
```

根据您的数据库使用

[**SQLLiveDemo**](http://sqlfiddle.com/#!2/98a89/1)

样本输出，

```
ID  NAME    PHONENO
1   smith   423-422-5226,414-255-5252
2   george  511-522-2525,524-522-2428 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T19:17:59.850

如果每个名称最多有两行，则可以执行以下操作：

```
select id, name, min(phone_no), max(phone_no)
from emp
group by id, name 
```

如果您有更多电话号码并希望将它们连接到一个字段中，则需要一个聚合字符串连接函数。如何执行此操作取决于您使用的 SQL 方言和版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T19:11:42.310

```
select a.id, a.name, a.phoneno, b.phoneno
from emp a
left join emp b on a.id = b.id and a.name = b.name and a.phoneno <> b.phoneno 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T19:24:47.773

Microsoft 的 Tobias Ternstrom 有一个适用于 sql server2005 及更高版本的解决方法：考虑以下使用 AdventureWorks microsoft 示例数据库的示例：

```
 SELECT 
        soh.OrderDate
        ,(
            SELECT 
                p.Name + ', '
            FROM Production.Product AS p
            INNER JOIN Sales.SalesOrderDetail AS sod ON p.ProductID = sod.ProductID
            WHERE sod.SalesOrderID = soh.SalesOrderID
            FOR XML PATH(''), TYPE
         ).value('/', 'NVARCHAR(max)') AS ProductsOrdered
    FROM Sales.SalesOrderHeader AS soh 
```

看看他们在哪里讨论同样的问题： [字符串聚合函数，类似于数字的 SUM](https://connect.microsoft.com/SQLServer/feedback/details/389883/string-aggregate-function-something-like-sum-for-numbers)

# javascript - JavaScript：clearInterval 不会清除间隔

> ID：14084995
> 
> 赞同：0
> 
> 时间：2012-12-29T19:07:52.430
> 
> 标签：javascript, setinterval, intervals, clearinterval

我有一个不寻常的问题。我正在使用以下脚本来检查使用`navigator.onLine`. 如果有互联网连接，页面将每 15 秒刷新一次。如果没有任何互联网连接，该页面将用于`innerHTML`显示一条消息。

```
<script type="text/javascript">
setInterval(function () {
if (navigator.onLine) {
var myInterval = setInterval(function(){window.location.href = "Tracker.html";},15000);
} else {
clearInterval(myInterval);
var changeMe = document.getElementById("change");
change.innerHTML = "<big><font face='Arial' color='#ffffff' size='2'><center>OFFLINE</big><br>No internet connection</font></center>";
}
}, 250);
</script> 
```

我的问题是，一旦没有互联网连接，就会显示消息，但页面仍然会在最后一次刷新。我试图通过`clearInterval(myInterval);`在代码的`else`一部分中使用来避免这种情况，但是它不起作用。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:11:57.833

每当执行外部间隔回调时，`myInterval`都会创建一个新变量，而前一个变量会丢失（它超出范围，因为回调终止）。

您必须通过在函数外部声明变量来在函数调用之间保持变量的值。如果一个超时已经在运行，您还必须确保没有创建另一个超时。

```
var timeout = null;

setInterval(function () {
    if (navigator.onLine) {
        if (timeout === null) {
            timeout = setInterval(function(){window.location.href = "Tracker.html";},15000);
        }
    } else {
        clearTimeout(timeout);
        timeout = null;
        // ...
   }
}, 250); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T19:17:15.640

要以 15 秒的间隔刷新页面（假设存在连接），请使用：

```
function refresh() {
    if(navigator.onLine)
        window.location.href = "Tracker.html";
    else{
        var changeMe = document.getElementById("change");
        change.innerHTML = "<big><font face='Arial' color='#ffffff' size='2'><center>OFFLINE</big><br>No internet connection</font></center>";
        setTimeout(refresh, 250);
    }
}
setTimeout(refresh, 15000); 
```

在 15 秒结束时，它会检查是否存在连接。如果有，它会刷新页面。如果没有，它会在之后每 250 毫秒检查一次，直到用户重新连接，此时它会刷新页面。

最终结果是脚本在至少 15 秒后尽快刷新页面。

这是一个演示：http: [//jsfiddle.net/JGEt9/show](http://jsfiddle.net/JGEt9/show)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T19:09:27.707

您需要`myInterval`在 if 语句之外声明。您也应该只需要一次刷新代码。像这样的东西：

```
var myInterval = setTimeout(function(){window.location.href = "Tracker.html";},15000);
setInterval(function () {
  if (!navigator.onLine) {
    clearTimeout(myInterval);
    var changeMe = document.getElementById("change");
    changeMe.innerHTML = "<big><font face='Arial' color='#ffffff' size='2'><center>OFFLINE</big><br>No internet connection</font></center>";
  }
}, 250); 
```

在这里您设置刷新间隔并不断检查浏览器是否离线，如果是，则删除计时器并执行清理代码。我还将刷新代码更改为使用 setTimeout 而不是间隔，因为它只发生一次。

另一个问题是您创建`changeMe`但然后尝试使用`change`. `change`不存在。我也在我的例子中解决了这个问题。

**注意：**一旦连接恢复，这将*不会*恢复刷新。请参阅菲利克斯克林的回答。

# css - 元素从标题后面掉落

> ID：14084997
> 
> 赞同：0
> 
> 时间：2012-12-29T19:08:03.357
> 
> 标签：css, jquery-animate, transition

我有一个 .png 格式的横幅，我希望它在单击后从标题后面下降。这是我尝试过的，但在这种情况下，div 又回到了原来的位置。我希望它位于标题后面（隐藏）并在过渡后保持其位置：

```
<!DOCTYPE html>
<html>
<head>
<style> 
div
{
width:100px;
height:100px;
background:red;
position:relative;
animation:myfirst 5s linear 2s;

-webkit-animation:myfirst 5s linear 2s;

}

@keyframes myfirst
{
0%   {background:red; left:0px; top:0px;}
100%  {background:green; left:0px; top:200px;}
}

@-webkit-keyframes myfirst /* Safari and Chrome */
{
0%   {background:red; left:0px; top:0px;}
100%  {background:green; left:0px; top:200px;}
}

</style>
</head>
<body>

 <div></div>

 </body>
 </html> 
```

我也尝试过使用 jQuery 的 slideDown() 但很遗憾，因为它是一个图像，它看起来不够好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:14:34.283

您可以使用**z-index 属性**

```
@keyframes myfirst{  position:absolute; z-index:-1; } 
```

使用 z-index:1 使其可见

检查 CSS z-index 属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:42:11.707

这是一个 jQuery 解决方案，也许有人可以想出一个更优雅的解决方案，但请尝试一下。我希望这是你所追求的行为。

jsFiddle：http: [//jsfiddle.net/fabio_silva/Qhrnd/](http://jsfiddle.net/fabio_silva/Qhrnd/)

***HTML***

```
<div id="header">header</div>
<div id="banner">banner</div> 
```

​</p>

***CSS***

```
div#header
{
    background: #abc;        
    width: 500px;
    height: 100px;
    position: relative;
    z-index: 1;
}
div#banner
{
    width: 500px;
    height: 100px;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 0;
    background: url('http://jsfiddle.net/img/logo.png') no-repeat 50% 50%;
    background-color: #345;
}​ 
```

​</p>

***Javascript/jQuery***

```
var hidden = true;
$(document).ready(function () {
    $("#header").click(function () {
        if (hidden)
        {
            $("#banner").animate({
                top: '+=100',
                display: 'block' //updated

            }, 500);
            hidden=false;
        }
        else
        {
            $("#banner").animate({
                top: '-=100'
                display: 'none' //updated
            }, 500);
            hidden=true;
        }

    });
});​ 
```