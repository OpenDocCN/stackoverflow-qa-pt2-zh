# StackOverflow 问答 13940000-13940999

# ruby-on-rails - 仅当资源具有特定属性时如何过滤搜索集合？

> ID：13940005
> 
> 赞同：0
> 
> 时间：2012-12-18T19:22:55.807
> 
> 标签：ruby-on-rails, ruby, search, elasticsearch, tire

我在搜索中使用**Elastic Search**和**Tire**。

我创建了 Search 类来搜索我的所有模型。

```
class Link < ActiveRecord::Base
  ...
  tire.mapping do
    indexes :id, :type => 'string', :index => :not_analyzed
    indexes :app_id, :type => 'string', :index => :not_analyzed
    indexes :title, analyzer: 'snowball', boost: 100
  end

  def to_indexed_json
    to_json(
      only: [:id, :app_id, :title]
    )
  end    
end

class Search
  def results
    search = Tire.search [:questions, :answers, :links, :events] do
      query { string "#{term}" }
    end
    search.results
  end
end 
```

案例是只返回来自 Apps`12`和`13`.

所以我尝试使用`search.filter :and, must: {term: {app_id: [12, 13]}}`but only过滤所有结果`questions`，`links`并且`answers`有`app_id`属性。我也想全部归还`events`。

好的模式将如何做到这一点？

**编辑：** 现在像下面这样对我有用：

```
multi_search = Tire.multi_search do
  search :without_app, indices: [:events, :past_events, :reviews] do
    query { match :_all, "#{term}" }
  end
  search :with_app, indices: [:questions, :answers, :links, :service_providers] do
    query do
      filtered do
        query { match :_all, "#{term}" }
        filter :terms, app_id: app_ids
      end
    end
  end
end
multi_search.results[:with_app].to_a + multi_search.results[:without_app].to_a 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T08:53:34.100

`multi_search`如果要分割结果，一个好的模式可能是使用该方法：

```
require 'tire'

Tire.index('questions') do
  delete
  store type: 'question', app_id: 1, title: 'Question test 1'
  store type: 'question', app_id: 2, title: 'Question test 2'
  store type: 'question', app_id: 3, title: 'Question test 3'
  refresh
end

Tire.index('links') do
  delete
  store type: 'link', app_id: 1, title: 'Link test 1'
  store type: 'link', app_id: 2, title: 'Link 2'
  store type: 'link', app_id: 3, title: 'Link test 3'
  refresh
end

Tire.index('events') do
  delete
  store type: 'event', title: 'Event test 1'
  store type: 'event', title: 'Event test 2'
  store type: 'event', title: 'Event 3'
  refresh
end

multi_search = Tire.multi_search do
  search :all, indices: [:questions, :links, :events] do
    query { match :_all, 'test' }
  end
  search :rest, indices: [:questions, :links] do
    query do
      filtered do
        query { all }
        filter :terms, app_id: [1, 2]
      end
    end
  end
end

puts "ALL:  " + multi_search.results[:all].map(&:title).inspect
puts '---'
puts "REST: " + multi_search.results[:rest].map(&:title).inspect 
```

# asp.net - 哈希集到数据库

> ID：13940007
> 
> 赞同：0
> 
> 时间：2012-12-18T19:22:58.953
> 
> 标签：asp.net, vb.net

我有 2 个哈希集：

```
Private workMembers As New HashSet(Of String)()
Private clientMembers As New HashSet(Of String)() 
```

根据用户按下的按钮（添加或删除）来添加或删除这些哈希集。

如果删除了一个成员，我需要从我的 MSSQL 数据库中删除一行，如果添加了一个成员，我需要插入一行。

我有两个问题：

有没有办法从哈希集中剩下的内容更新我的数据库？

我需要设计两个单独的函数来处理这两个函数吗？

谢谢！

# asp.net-mvc - 如何在 ASP.NET MVC3 中向 SelectList 添加多个默认值

> ID：13940010
> 
> 赞同：3
> 
> 时间：2012-12-18T19:23:08.367
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-4

我有一个这样填充的 DropDownList：

```
 @Html.DropDownListFor(m => ModelValue, new SelectList(Model.DefaultValues), Model.EditValues[0]) 
```

所以`Model.EditValues[0]`如果我重新加载要编辑的表单，将分配一个默认值。我怎样才能有多个默认值`HTML.ListBox`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T19:31:51.793

```
 @Html.ListBoxFor(m => Model.Value, new MultiSelectList(Model.DefaultValues, Model.EditValues)) 
```

# java - 自定义相机android中的闪光灯

> ID：13940019
> 
> 赞同：1
> 
> 时间：2012-12-18T19:23:34.307
> 
> 标签：java, android, camera

在这个链接[http://store.ovi.com/content/147853?clickSource=search&pos=1](http://store.ovi.com/content/147853?clickSource=search&pos=1)上有一个自定义的相机实现在 android我想知道我们如何在捕获图像时打开闪光灯，我们会这样做吗我们自己 ？或在示例中设置相机模式的任何api？

请帮忙 ！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:38:35.307

您可以使用 将所需的闪光模式设置为您在`Camera`对象中传递的参数的一部分[`setParameters(Camera.Parameters params)`](http://developer.android.com/reference/android/hardware/Camera.html#setParameters%28android.hardware.Camera.Parameters%29)。请参阅参数上的方法，[`setFlashMode(String)`](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#setFlashMode%28java.lang.String%29)提供或。[`FLASH_MODE_ON`](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#FLASH_MODE_ON)[`FLASH_MODE_OFF`](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#FLASH_MODE_OFF)[`FLASH_MODE_AUTO`](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#FLASH_MODE_AUTO)

```
Camera camera = Camera.open();
Camera.Parameters params = new Camera.Parameters();
params.setFlashMode(Camera.Parameters.FLASH_MODE_ON);
// ... set other parameters
camera.setParameters(params); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-05T19:26:00.907

在您拥有一个 Camera 实例之后，这相对容易（Camera.open() 将返回一个 Camera 实例）。

首先，您需要获取相机参数

```
Camera.Parameters params = yourCameraInstance.getParameters(); 
```

接下来，您需要检查正在使用的设备是否能够实现您希望实现的闪存模式，以防万一您试图告诉设备打开闪存而它却不能。这会导致崩溃。

```
 List<String> flashModes = params.getSupportedFlashModes(); 
```

这将返回设备能够以字符串形式支持的所有闪存模式的列表。例如，该列表应包含以下内容：FLASH_MODE_AUTO、FLASH_MODE_ON、FLASH_MODE_OFF 等。

然后执行以下操作：

```
 if (flashModes.contains(Camera.Parameters.FLASH_MODE_AUTO)) {
        params.setFlashMode(Camera.Parameters.FLASH_MODE_AUTO);
    } 
```

最后，将您的新参数设置为您的相机实例，如下所示：

```
yourCameraInstance.setParameters(params); 
```

* * *

同样，您可以以相同的方式检查其他相机功能：

```
 List<String> focusModes = params.getSupportedFocusModes();
    if (focusModes.contains(Camera.Parameters.FOCUS_MODE_AUTO)) {
        params.setFocusMode(Camera.Parameters.FOCUS_MODE_AUTO);
    }
    yourCameraInstance.setParameters(params); 
```

希望这对某人有帮助！

# php - 使用 PHP 将 CSV 加载到 MySQL 表中

> ID：13940020
> 
> 赞同：2
> 
> 时间：2012-12-18T19:23:38.793
> 
> 标签：php, mysql

我正在尝试使用 PHP 脚本将 CSV 导入 MySQL 表。此 SQL 命令成功地将 CSV 文件导入 SQL 表：

```
mysql> LOAD DATA LOCAL INFILE 'property_re_1.csv' 
-> REPLACE INTO TABLE `markers`
-> FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\'
-> LINES TERMINATED BY '\n' IGNORE 1 LINES;
Query OK, 315 rows affected (0.01 sec)
Records: 315  Deleted: 0  Skipped: 0  Warnings: 0 
```

现在我想将此 SQL 命令转换为 PHP 脚本。这是我编写 PHP 脚本的尝试：

```
<?PHP
$dbhost = 'localhost';
$dbuser = 'myusername';
$dbpasswd = 'mypassword';
$db = "db_markers";

$dbh = mysql_connect($dbhost, $dbuser, $dbpasswd) or die("Unable to connect to SQL server");
$my_db = @mysql_select_db($db, $dbh) or die("Unable to select database");

$file = $_SERVER['DOCUMENT_ROOT']."/path/property_re_1.csv";

$result=mysql_query("LOAD DATA LOCAL INFILE '$file' REPLACE INTO TABLE `markers` FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n' IGNORE 1 LINES");   
?> 
```

此脚本导致错误：

> HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到意外情况。

错误日志显示：

```
[18-Dec-2012 12:37:38] PHP Parse error: syntax error, unexpected    T_CONSTANT_ENCAPSED_STRING in /path/testconnect.php on line 13 
```

$Result 变量在第 13 行被调用，所以错误一定在其中。

我不确定这个错误的原因是什么。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:36:22.477

错误的原因是您发送到网络服务器的请求。网络服务器尝试满足请求并执行脚本来执行此操作，在您的情况下是 PHP 脚本。

PHP 脚本现在失败。网络服务器只知道它失败了，但由于网络服务器不知道任何具体的事情，它只会返回所谓的*内部服务器错误*（错误发生在内部），代码 500。确切的错误信息被隐藏了，因为该错误不是预期的内部信息不得外泄。

仅从消息中，没有人能说出发生了什么。您需要查看网络服务器的错误日志并检查内部报告是什么。

在您的情况下，我会假设您的 PHP 脚本有一个致命错误。您还可以启用 PHP 错误显示和日志记录，请参阅[PHP 不显示错误消息](https://stackoverflow.com/q/5680831/367456)。

当您这样做时，您可能会看到更多错误消息。在我们的错误参考中解释了常见的错误消息：[参考 - 这个错误在 PHP 中是什么意思？](https://stackoverflow.com/q/12769982/367456).

如果我猜测一下，我会说你看到这个是因为你的 PHP 文件没有解析。最有可能出现以下错误：

*   [解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE](https://stackoverflow.com/questions/12769982/reference-what-does-this-error-mean-in-php/13935532#13935532)

故障排除快乐！

# .net - 让 TeamCity 读取我的 NUnit 测试配置文件

> ID：13940022
> 
> 赞同：3
> 
> 时间：2012-12-18T19:23:46.653
> 
> 标签：.net, testing, nunit, teamcity

我在 VS 2010 中有一个项目，使用 NUnit 和 C# 来测试我的应用程序。我的项目名为 MyProjectTests，根据 NUnit，我有一个 MyProjectTests.config 文件，其中包含一个连接到我的测试数据库的字符串，如下所示：

```
<?xml version="1.0"?>
<configuration>
<appSettings>

    <add key="defaultConnection" value="MyConnection"/>
</appSettings>
<connectionStrings>
    <add name="MyConnection" connectionString="My_Connection_String_Details" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

但是当我运行我的 TeamCity NUnit 测试时，连接字符串为 Null。如何让 TeamCiry 读取我的连接文件？还有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:26:12.437

您应该将设置文件命名为 App.config，放入测试项目的根目录并包含它。NUnit 和 TeamCity 跑步者都将使用该 app.config 中的设置。

# php - 使用日期函数mysql，设置一个cron作业

> ID：13940028
> 
> 赞同：0
> 
> 时间：2012-12-18T19:24:07.990
> 
> 标签：php, mysql, date, cron

我正在处理会员帐户页面。该页面工作正常，我的表格中有一行显示该人注册的日期。人们将下订单并在他们的帐户页面上显示他们的累积积分。我想写的功能是30天后，积分从0开始。我正在考虑通过我的cPanel为此设置一个cron作业。但我不知道如何使用 date 函数来检查 30 天是否已经过去。这基本上是我到目前为止的想法：

```
`<?php 
//connect to my database and run a query for the date I already have
//set the date to a variable using mysql_fetch_assoc(query)

//now the part where I need help for the function
if(registerdate == (registerdate+30days){
sql = mysql_query("UPDATE members SET accPoints='0' WHERE id='$userid' and username='$username'");
}
?>` 
```

所以请帮我解决这个功能的代码。还有一个快速的问题：是否可以用多个数据填充表格列，然后检索它以进行显示？基本上是把一个人的所有订单都放在Orders一栏，然后搜索一下，显示在他们的会员页面上？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:34:13.430

您应该能够在查询本身中做到这一点：

```
"UPDATE members SET accPoints='0' WHERE id='$userid' and username='$username' AND registerdate + interval 30 DAY < NOW()" 
```

第二个问题：

如果我理解正确，您希望将多条数据与每个用户相关联。为此，您需要创建另一个与 users 表具有多对多关系的表：

> 订单（订单 ID，用户 ID，订单信息，...）

然后，您可以像这样查询用户 1 的每个订单：

```
SELECT o.* FROM users u, orders o WHERE u.user_id = 1 AND o.user_id = u.user_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:38:15.243

你可以做很多不同的事情。[您可以使用strtotime](http://php.net/manual/en/function.strtotime.php)将日期转换为 UNIX 时间戳，并添加秒数以查看您的 cron 作业是否达到阈值或[添加日期](http://php.net/manual/en/datetime.add.php)或使用纯 SQL 根据您的 WHERE 子句返回所有需要“积分”的人。

# c - 如何声明一个不透明的结构指针接口

> ID：13940030
> 
> 赞同：5
> 
> 时间：2012-12-18T19:24:23.487
> 
> 标签：c

我正在尝试构建一些 C 代码，以便 .c 文件和私有 .h 文件定义一个相当复杂的结构，但面向公众的头文件只需要指向该结构类型的指针。我尝试的是这样的：

*公共广播.h*

```
typedef struct _radio Radio;
void radioReceive(Radio *radio, ....); 
```

*私人电台.h*

```
#include <publicRadio.h>
struct _radio {
    ...
    ...
} 
```

*电台.c*

```
#include <publicRadio.h>
#include <privateRadio.h>

void radioReceive(Radio *radio, ....)
{
    ...
} 
```

当我尝试编译它时，我得到了类似的东西

```
radio.c:91:9: error: parameter 'radio' has just a forward declaration
radio.c:90:6: error: conflicting types for 'radioReceive'
publicRadio.h:29:6: note: previous declaration of 'radioReceive' was here 
```

我试图模仿我在其他库中看到的模式，这些库具有面向公众的 API，这些 API 通过函数公开其结构，但隐藏了血淋淋的细节。实现这一目标的秘诀是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:40:56.160

这种模式通常是这样实现的：

*收音机.h*

```
#ifndef RADIO_H
#define RADIO_H

typedef struct _radio Radio;
void radioReceive(Radio *radio, ....);

#endif 
```

*电台.c*

```
#include "radio.h"

struct _radio {
    // _radio struct implementation
};

void radioReceive(Radio *radio, ....) {
    // radioReceive implementation
} 
```

*主程序*

```
#include "radio.h"
.... // use Radio, radioReceive, etc. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T19:53:17.437

好的：以下在 MSVC 和 GCC 上都可以正常工作*。*

**两个重要的错误是：**

*   privateRadio.h 中缺少分号
*   在 radio.c 中包含 publicRadio.h 会导致双重包含。它已经包含在 privateRadio.h 中

这是我使用的代码：

*公共广播.h*

```
 typedef struct _radio Radio;
    void radioReceive(Radio *radio, ....); 
```

*私人电台.h*

```
 #include "publicRadio.h"

    struct _radio {
        ...
        ...
    }; 
```

*电台.c*

```
 #include "privateRadio.h"

    void radioReceive(Radio *radio, ....)
    {
        ...
    } 
```

*主程序*

```
 #include "publicRadio.h"

    void main()
    {
        Radio* radio = ...;
        radioReceive(radio, ....);
    } 
```

# mysql - mysql 触发器示例 - 这可以更有效地完成吗？

> ID：13940033
> 
> 赞同：2
> 
> 时间：2012-12-18T19:24:32.200
> 
> 标签：mysql, triggers

我目前有两个表如下：

数据表

```
+-----+-------------+---------------+
| uri | field1      | field2        |
+-----+-------------+---------------+
|   1 | word        | somethingelse |
|   2 | somethinge  | values        |
|   3 | change_this | test          |
+-----+-------------+---------------+ 
```

日志表

```
+--------+------+----------+-----------+-------------+---------------------+
| log_id | uri  | field_id | old_value | new_value   | modified_date       |
+--------+------+----------+-----------+-------------+---------------------+
|     14 | 3    | field1   | word32    | change_this | 2012-12-18 13:06:27 |
+--------+------+----------+-----------+-------------+---------------------+ 
```

当我更新 field1 或 field2 两个的值时，我会在“日志”表中获得一个条目，说明哪个字段已更改，从什么更改为什么，何时更改，以及更新记录的 uri。

我的问题是关于触发器本身：是否可以，还是可以更有效地完成？老实说，我以前从未编写过触发器，而是根据通过谷歌找到的几个片段拼凑而成的。我欢迎您的想法/反馈。

```
DELIMITER $$
DROP TRIGGER IF EXISTS trig_update $$
CREATE TRIGGER trig_update AFTER UPDATE on data
FOR EACH ROW
BEGIN
DECLARE data_uri VARCHAR(32);
IF (NEW.field1 != OLD.field1) THEN
SET data_uri = (SELECT uri FROM data WHERE field1 = NEW.field1);
INSERT INTO log (uri, field_id, old_value, new_value, modified_date) 
VALUES (data_uri, "field1", OLD.field1, NEW.field1, NOW());
END IF; 
IF (NEW.field2 != OLD.field2) THEN
SET data_uri = (SELECT uri FROM data WHERE field2 = NEW.field2);
INSERT INTO log (uri, field_id, old_value, new_value, modified_date) 
VALUES (data_uri, "field2", OLD.field2, NEW.field2, NOW());
END IF; 
END$$
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:36:29.550

您应该消除冗余查询：

```
DELIMITER $$
DROP TRIGGER IF EXISTS trig_update $$
CREATE TRIGGER trig_update AFTER UPDATE on data
FOR EACH ROW
BEGIN
IF (NEW.field1 != OLD.field1) THEN
  INSERT INTO log (uri, field_id, old_value, new_value, modified_date) 
  VALUES (NEW.uri, "field1", OLD.field1, NEW.field1, NOW());
END IF; 
IF (NEW.field2 != OLD.field2) THEN
  INSERT INTO log (uri, field_id, old_value, new_value, modified_date) 
  VALUES (NEW.uri, "field2", OLD.field2, NEW.field2, NOW());
END IF; 
END$$
DELIMITER ; 
```

# php - 我可以调用另一个 PHP 脚本并传递 $_GET 变量吗？

> ID：13940035
> 
> 赞同：0
> 
> 时间：2012-12-18T19:24:36.013
> 
> 标签：php, jquery

我目前从 javascript 调用 PHP 脚本并返回 json 数据。这对客户很有效。我需要从另一个 PHP 文件中对 PHP 脚本进行相同的调用。这可以做到吗？

我当前的 jquery 调用如下所示：

```
$.post('functions/get_testdata.php?type='+Type, function(data) {
   ....
}); 
```

从我想调用的另一个 PHP 脚本中：

```
'functions/get_testdata.php?type='.$type 
```

我可以将 get_testdata 的内容复制到我的另一个 PHP 页面，但我只想为此维护一个代码块。

有什么想法还是我错过了显而易见的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:30:56.313

是的，您可以使用 cURL 之类的东西来做您想做的事情，但是我建议更好的方法是将该页面上的逻辑封装到一个类或函数中。这样当您调用该页面时，您可能会执行类似的操作

```
$type = $_GET['type'];

$result = your_new_function($type); 
```

然后，您可以从代码中的任何位置调用这个新函数（或类），并将所需的参数传递给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:27:59.420

$_GET 是全局的，因此您可以在所有 php 文件中访问它。您只需要包含另一个文件。

[http://php.net/manual/en/function.include.php](http://php.net/manual/en/function.include.php)

# sql-server - 嵌套 IF ELSE 的可行 T-SQL 替代方案，用于 CASE 失败的比较

> ID：13940036
> 
> 赞同：2
> 
> 时间：2012-12-18T19:24:36.517
> 
> 标签：sql-server, tsql, sql-server-2005, case

在 T-SQL 中是否有一个可行的替代方法来替代嵌套的 IF ELSE 进行比较，其中必须根据比较结果进行不同的逻辑？我的情况是选择一个表示评估条件的 nvarchar 值，并根据条件进行评估。我最初试图在 CASE 声明中实现这一点，如下所示：

```
SELECT
            CASE @condition
            WHEN  '<' THEN

                IF (@processing_time < @threshold_value)
                BEGIN
                    SET @condition_met = 1 --compare threshold_value and processing_time
                END

            WHEN '<=' THEN
                    IF (@processing_time <= @threshold_value)
                    BEGIN
                        SET @condition_met = 1 --compare threshold_value and processing_time
                    END
                WHEN '>' THEN
                    IF (@processing_time > @threshold_value)
                    BEGIN
                        SET @condition_met = 1 --compare threshold_value and processing_time
                    END
                WHEN '>=' THEN
                    IF (@processing_time >= @threshold_value)
                    BEGIN
                        SET @condition_met = 1 --compare threshold_value and processing_time
                    END
                WHEN '=' THEN
                    IF (@processing_time = @threshold_value)
                    BEGIN
                        SET @condition_met = 1 --compare threshold_value and processing_time
                    END
            END -- end case statement 
```

但是，根据我在其他地方看到的情况和我得到的语法错误，case 语句中的 WHEN 子句似乎只能赋值，不能执行评估逻辑。我能想到的唯一选择是使用嵌套的 IF/ELSE 语句执行等效逻辑。有没有更好的办法？重新设计表/数据类型是一种选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:36:11.243

我这里没有数据库来检查这个语法没有错别字但是应该这样做..

```
set @condition_met = (SELECT 
                        CASE WHEN (@condition = '<' AND @processing_time < @threshold_value) OR
                                  (@condition = '<=' AND @processing_time <= @threshold_value) OR
                                  (@condition = '>' AND @processing_time > @threshold_value) OR
                                  (@condition = '>=' AND @processing_time >= @threshold_value) OR
                                  (@condition = '=' AND @processing_time = @threshold_value) 
                             THEN 1 ELSE 0 END) 
```

或者，您可以简单地执行一系列`IF`语句来执行相同的操作，例如

```
SET @condition_met = 0;
IF @condition = "<" AND @processing_time < @threshold_value SET @condition_met = 1;
IF @condition = "<=" AND @processing_time <= @threshold_value SET @condition_met = 1;
etc.. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T19:41:38.017

```
SELECT @Condition_Met = CASE 
            WHEN (@condition = '<' AND @processing_time < @threshold_value) OR
                 (@condition = '<=' AND @processing_time <= @threshold_value) OR
                 (@condition = '>' AND @processing_time > @threshold_value) OR
                 (@condition = '>=' AND @processing_time >= @threshold_value) OR
                 (@condition = '=' AND @processing_time = @threshold_value) 
                 THEN 1 ELSE 0 END 
```

在我看来，您正在尝试编写太多的程序代码，而没有足够的基于集合或声明性的代码。我有一种感觉，这整个事情属于一个更大的查询的一部分，这样你甚至不需要声明其中的一些变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:58:26.397

还要考虑动态 SQL 解决方案。

```
declare @op varchar(5) = '>'
declare @sql nvarchar(max) = 
'declare @condition_met bit
declare @processing_time int = 7
declare @threshold_value int = 6

select @condition_met = case when @processing_time'+@op+'@threshold_value then 1 else 0 end
select @condition_met'
exec (@sql) 
```

如果表达式在`WHERE`子句中并且或者`@processing_time`或者`@threshold_value`是索引列并且您真的想在其上使用索引，则它可能很有用。

# asp.net - 如何从后面的代码访问要呈现给浏览器的文档文本？

> ID：13940037
> 
> 赞同：0
> 
> 时间：2012-12-18T19:24:37.917
> 
> 标签：asp.net, vb.net, webpage

我需要在 Page_Load 后面的代码中的 vb.net 中搜索将呈现给浏览器的完整页面的文本。例如，在 Page_Load 上，我想搜索页面文档中出现的所有单词“test”。“测试”一词可能在页面上的 html 中，甚至在 javascript 块中。我需要搜索完整的文档。我正在使用 .NET 4.0、VS 2010 和网络表单。

提前致谢！鲍勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:14:23.530

在 page_load 中，页面尚未组成。尝试覆盖页面的 Render 方法。您可以在此处获取要呈现的文本

编辑：这是一个关于如何做到这一点的例子：[http ://www.west-wind.com/weblog/posts/2004/Jun/08/Capturing-Output-from-ASPNet-Pages](http://www.west-wind.com/weblog/posts/2004/Jun/08/Capturing-Output-from-ASPNet-Pages)

# javascript - 将当前窗口或页面位置与正则表达式进行比较。jQuery 或 Javascript

> ID：13940042
> 
> 赞同：0
> 
> 时间：2012-12-18T19:25:01.007
> 
> 标签：javascript, jquery, regex, contains

我有两个页面，每个页面都`divs`包含位置信息。每个页面当前显示数据库中的所有位置，但每个页面只需要显示两个城市之一的位置。我需要从两个页面中删除所有不相关的位置。由于我不能在每个页面上放置差异脚本，因此我必须区分页面位置/网址。

两个城市之一是明尼阿波利斯，所以我正在尝试作为正则表达式的一个例子：

```
 new RegExp('^http://([^\.]+)\.domain\.com/contact-us/minneapolis-locations(.*)$'); 
```

我如何编写一个`IF`或其他语句来根据这个正则表达式检查页面位置？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:27:02.500

使用[String#match()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)。如果有匹配，它将返回一个匹配数组，如果不存在则返回 null。

```
var re = new RegExp('^http://([^\.]+)\.domain\.com/contact-us/minneapolis-locations(.*)$');

if(window.location.href.match(re)){
    //do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:30:14.210

不太确定我是否理解你的问题。您想在 if 语句中针对该正则表达式测试当前 url？

```
var reg = new RegExp('^http://([^\\.]+)\\.domain\\.com/contact-us/minneapolis-locations(.*)$');
if (location.href.match(reg))
{
    ...
} 
```

或使用正则表达式文字：

```
var reg = /^http:\/\/([^\.]+)\.domain\.com\/contact-us\/minneapolis-locations(.*)$/;
if (location.href.match(reg))
{
    ...
} 
```

# c++ - 配对堆 - 减少键的实现

> ID：13940044
> 
> 赞同：6
> 
> 时间：2012-12-18T19:25:23.180
> 
> 标签：c++, algorithm, data-structures, pairing-heap

我刚刚实现了配对堆数据结构。Pairing heap 支持在 O(1) 摊销时间内插入、find-min、merge 和在 O(logN) 摊销时间内删除、delete-min。但最显着的操作是减少键，其复杂度为 O(log logN)。有关配对堆的更多信息，请访问[http://en.wikipedia.org/wiki/Pairing_heap](http://en.wikipedia.org/wiki/Pairing_heap)。

我已经实现了插入、合并和删除最小操作，但是维基百科文章没有说明如何减少给定节点的键，所以我无法实现。有人可以告诉我它实际上是如何工作的吗？

这是我的代码：

```
template< class key_t, class compare_t=std::less< key_t > >
struct pairing_heap {
private:
  struct node { 
    key_t key; std::vector< node* > c;
    node( key_t k=key_t() ) : key( k ), c( std::vector< node* >() ) {}
  };
  node *root;
  compare_t cmp;
  unsigned sz;
public:
  typedef key_t value_type;
  typedef compare_t compare_type;
  typedef pairing_heap< key_t, compare_t > self_type;

  pairing_heap() : root( 0 ) {}
  node* merge( node *x, node *y ) {
    if( !x ) return y;
    else if( !y ) return x;
    else {
      if( cmp( x->key, y->key ) ) {
        x->c.push_back( y );
        return x;
      } else {
        y->c.push_back( x );
        return y;
      }
    }
  }
  node* merge_pairs( std::vector< node* > &c, unsigned i ) {
    if( c.size()==0 || i>=c.size() ) return 0;
    else if( i==c.size()-1 ) return c[ i ];
    else {
      return merge( merge( c[ i ], c[ i+1 ] ), merge_pairs( c, i+2 ) );
    }
  }
  void insert( key_t x ) {
    root = merge( root, new node( x ) );
    sz++;
  }
  key_t delmin() {
    if( !root ) throw std::runtime_error( "std::runtime_error" );
    key_t ret=root->key;
    root = merge_pairs( root->c, 0 );
    sz--;
    return ret;
  }
  bool empty() const { return root==0; }
  unsigned size() const { return sz; }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:44:53.640

根据**[关于配对堆的原始论文，第 114 页](http://www.cs.cmu.edu/afs/cs.cmu.edu/user/sleator/www/papers/pairing-heaps.pdf#page=4)**，减少键操作的实现如下。首先，将要减少key的节点的优先级更改为新的优先级。如果它的优先级仍然大于它的父级（或者它是树的根），那么你就完成了。否则，切断从该节点到其父节点的链接，然后使用合并操作将原始堆与刚刚从该树中切断的子树组合起来。

希望这可以帮助！

# multithreading - 在测试自动化项目中使用单例控制器的优缺点是什么

> ID：13940046
> 
> 赞同：1
> 
> 时间：2012-12-18T19:25:25.980
> 
> 标签：multithreading, thread-safety, testng

我正在创建一个测试自动化项目并希望它被 TESTNG 使用。我计划在自动化项目中使用 MVC 架构，并且正在考虑创建控制器单例。因此想知道它的优缺点，因为它将被支持多线程的 TESTNG 访问/使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T09:26:12.883

我无法具体评论 test ng，但我可以推荐这个关于[编写可测试代码](http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf)的有趣文档。特别是它有一个关于单例的部分。以下是一些摘录：

> *   每个使用全局状态的测试都需要它以预期的状态开始，否则测试将失败。但是另一个对象可能在之前的测试中改变了该全局状态。
> *   全局状态通常会阻止测试能够并行运行，这会迫使测试套件运行得更慢。
> *   强制执行自己的“单例”的单例最终会作弊：您经常会在所谓的单例上看到诸如 reset() 或 setForTest() 之类的突变方法，因为您需要在测试期间更改实例。如果您在测试后忘记重置 Singleton，以后的使用将使用陈旧的底层实例，并且可能会以难以调试的方式失败。

底线：如果可以，请避免使用单例，并改用依赖注入。换句话说，而不是：

```
public void someMethod() {
   Controller c = Controller.getInstance();
   c.doSomething();
} 
```

赞成：

```
public void someMethod(Controller c) {
   c.doSomething();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:34:43.697

在测试自动化中，或者通常您应该避免使用单例。尤其是在 java 中，您通常无法为新的测试用例重置单例。这导致了新的 tets 案例使用具有前一个结果的 singelton 的情况。这是不好的！
有人可能会创建特殊的单例，它们有一个 resetSingleton() 或一个 setInstance() 方法，它们只会在测试用例中使用。
此外，您可以通过反射来处理单声道。我已经完成了所有 3 种技术，但是：

最好的办法是完全避免单例。

# ruby-on-rails - Rails Fullcalendar全天拖动不起作用

> ID：13940047
> 
> 赞同：1
> 
> 时间：2012-12-18T19:25:34.977
> 
> 标签：ruby-on-rails, fullcalendar

我在 Rails 应用程序中使用 arshaw.com/fullcalendar/。真的很棒！！

当用户将事件从一天移动（拖动）到另一天时，我正在使用 eventDrop 更新事件表。这适用于拖动具有开始和结束时间的事件。但是，当您拖动全天事件时，它不会更新表格。

这是我的表格更新代码：

```
 eventDrop: (event, dayDelta, minuteDelta, allDay, revertFunc) ->
    updateEvent(event);

  eventResize: (event, dayDelta, minuteDelta, revertFunc) ->
    updateEvent(event);

updateEvent = (the_event) ->
  $.update "/events/" + the_event.id,
    event:
      title: the_event.title,
      starts_at: "" + the_event.start,
      ends_at: "" + the_event.end,
      description: the_event.description 
```

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T14:57:14.800

我解决这个问题的简单方法是使用小技巧（我不喜欢技巧，但我认为这是需要的）。

我所做的是，在 allDay 事件创建时，我以编程方式添加该事件的结束时间（开始后 1 小时），确保所有事件始终具有结束时间：

```
select: function (start, end, allDay, jsEvent, view)
    {
        var title = prompt('event title:');

        if (title)
        {
            var allDay = allDay ? true : false;
            if (allDay)
            {   // this ensures that allDay tasks have end time if they're to be changed to non allDay tasks
                end.setHours(end.getHours() + 1);
            }

            createEvent(
            {
                title: title,
                start: start,
                end: end,
                allDay: allDay
            });
        }
        $calendar.fullCalendar('unselect');
    }, 
```

这是 createEvent 函数：

```
function createEvent(event)
{
    $spinner.show();
    $.create(
        "/tasks",
        {
            "task":
            {
                name: event.title,
                starts_at: "" + event.start,
                ends_at: "" + event.end,
                all_day: event.allDay
            }
        },
        function (response)
        {
            $spinner.hide();
            var id = response.id;
            $calendar.fullCalendar('renderEvent',
            {
                id: id,
                title: event.title,
                start: event.start,
                end: event.end,
                allDay: event.allDay ? true : false
            },
            true // make the event "stick"
            );
        }
    );
} 
```

# regex - 防止sql注入以及在zend中使用正则表达式

> ID：13940050
> 
> 赞同：0
> 
> 时间：2012-12-18T19:26:07.447
> 
> 标签：regex, zend-framework, sql-injection, zend-db

我想防止 sql 注入以及想`REGEXP`在同一个查询中获得类似的结果。我知道我防止像这样的 sql 注入

```
 $this->getAdapter()->fetchAlll("SELECT * FROM $this->_table WHERE email = ? ", array($email)); 
```

现在我有另一个查询，用于`REGEXP`根据前 3 个和后三个字符获得类似的结果。我的查询看起来像这样

```
$this->_adapter->fetchAll("SELECT country_name FROM $this->_name WHERE country_name REGEXP '^$front' OR country_name REGEXP '$end$'"); 
```

在使用时放入`^`开始`REGEXP`意味着您要从开始进行比较，`$`在结束时使用意味着您要从结束进行比较。

所以现在我想问我如何编写上述查询以防止上述查询中的sql注入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:29:19.857

尝试以下

```
$query = "SELECT country_name
              FROM $this->_name
          WHERE country_name REGEXP ? OR
                country_name REGEXP ?";
$this->_adapter->fetchAll($query, array('^'.$front, $end.'$')); 
```

# r - 在逻辑时间序列中找到连续区域的方法

> ID：13940051
> 
> 赞同：1
> 
> 时间：2012-12-18T19:26:11.157
> 
> 标签：r, time-series

是否有一种方便而优雅的现有方法来查找逻辑时间序列中包含值 True 或 1 的连续区域？我正在寻找返回表单的 ts 摘要的东西：

```
Region_id               Start                Stop
        1 YYYY-MM-DD HH:MM:SS YYYY-MM-DD HH:MM:SS
        2 YYYY-MM-DD HH:MM:SS YYYY-MM-DD HH:MM:SS
        ... etc 
```

示例输入 ts：

```
mins <- function (N, from = as.character(Sys.time()), cols = 1, by = 1) 
{
deltas <- seq(from = 0, by = 60 * by, length.out = N)
nacol <- matrix(data = NA, ncol = cols, nrow = N)
xts(x = nacol, order.by = strptime(from, format = "%Y-%m-%d %H:%M") + 
    deltas)
}

d <- mins(N=20,cols=1)
d[,1] <- F; d[5:12,1] <- T; d[14:20,1] <- T
d
                     [,1]
2012-12-18 20:48:00 FALSE
2012-12-18 20:49:00 FALSE
2012-12-18 20:50:00 FALSE
2012-12-18 20:51:00 FALSE
2012-12-18 20:52:00  TRUE
2012-12-18 20:53:00  TRUE
2012-12-18 20:54:00  TRUE
2012-12-18 20:55:00  TRUE
2012-12-18 20:56:00  TRUE
2012-12-18 20:57:00  TRUE
2012-12-18 20:58:00  TRUE
2012-12-18 20:59:00  TRUE
2012-12-18 21:00:00 FALSE
2012-12-18 21:01:00  TRUE
2012-12-18 21:02:00  TRUE
2012-12-18 21:03:00  TRUE
2012-12-18 21:04:00  TRUE
2012-12-18 21:05:00  TRUE
2012-12-18 21:06:00  TRUE
2012-12-18 21:07:00  TRUE

# so far for the _idealized_ input, now the function I am looking for to return data.frame 
# like this for the d object as above:
Region_id               Start                Stop
        1 2012-12-18 20:52:00 2012-12-18 20:59:00
        2 2012-12-18 21:01:00 2012-12-18 21:07:00 
```

这可能是二进制信号处理的常见任务，因此值得搜索。当然，它是理想化的。只是为了开始。现实会更加复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:07:31.287

首先，使用`rle`找到连续的块，然后创建一个指标来分隔每个块。

```
r <- rle(coredata(d)[,1])
ind <- rep(seq_along(r$lengths), r$lengths) 
```

现在您可以使用指标来拆分您的 xts 对象，并在每个连续块上运行最小/最大函数。

```
s <- split(index(d), ind)
l <- lapply(s, function(x) data.frame(start=min(x), stop=max(x))) 
```

然后您可以`rbind`将上述结果放入一个 data.frame 中，创建`region`列，仅对`TRUE`值进行子集化，并获取累积总和。请注意，由于时区差异，我的时间有所不同，但这个概念是正确的。

```
out <- do.call(rbind, l)
out$region <- r$values
out <- out[out$region,]
out$region <- cumsum(out$region)
out
#                 start                stop region
# 2 2012-12-18 20:45:00 2012-12-18 20:52:00      1
# 4 2012-12-18 20:54:00 2012-12-18 21:00:00      2 
```

# c#-4.0 - 如何使用 itextSharp 将“返回顶部”锚点添加到 PDF？

> ID：13940052
> 
> 赞同：1
> 
> 时间：2012-12-18T19:26:12.573
> 
> 标签：c#-4.0, itextsharp

我需要在现有 pdf 中添加一个锚点，以便在单击时将用户返回到页面顶部。我试过这个：

```
 public void Bookmark() {
        PdfReader reader = new PdfReader(new RandomAccessFileOrArray(_fileName), null);
        DeleteFile(); //delete old pdf (_filename)

        _fileName = Setting.Temp + Guid.NewGuid() + ".pdf";

        Document doc = new Document(PageSize.A4, 0, 0, 50, 50);
        PdfWriter writer = PdfWriter.GetInstance(doc, new FileStream(_fileName, FileMode.Create));

        iTextSharp.text.Font link = FontFactory.GetFont("Arial", 12, BaseColor.BLUE);

        doc.Open();

        PdfContentByte pdfContentByte = writer.DirectContent;
        Anchor topAnchor = null;
        PdfImportedPage page = null;
        for (int i = 1; i < reader.NumberOfPages; i++) {
            if (i == 1) {
                topAnchor = new Anchor("");
                topAnchor.Name = "TopAnchor";
                page = writer.GetImportedPage(reader, i);
                doc.NewPage();
                pdfContentByte.AddTemplate(page, 0, 0);
                doc.Add(topAnchor);
            } else {
                page = writer.GetImportedPage(reader, i);
                doc.NewPage();
                pdfContentByte.AddTemplate(page, 0, 0);

                Anchor anchor = new Anchor("Back to Top", link);
                anchor.Reference = "#TopAnchor";
                doc.Add(anchor);
            }

        }

        doc.Close();
    } 
```

该链接将添加到除第一个页面之外的所有页面。但是，当我单击链接时，它什么也不做。

有谁知道如何解决这个问题或更好的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T10:20:44.320

Hi you can use the exact way followed here.

[http://www.mikesdotnetting.com/Article/84/iTextSharp-Links-and-Bookmarks](http://www.mikesdotnetting.com/Article/84/iTextSharp-Links-and-Bookmarks)

# c++ - Qt Creator 错误代码 -1073741819

> ID：13940054
> 
> 赞同：5
> 
> 时间：2012-12-18T19:26:20.690
> 
> 标签：c++, qt, mingw, qt-creator

好的，Qt Creator 也是如此，我尝试在 Projects->Applications->Qt Gui Applications 下创建最基本的应用程序。项目已成功创建。此外，当我编译它时，它似乎工作得很好。

```
11:07:38: Running steps for project Test1...
11:07:38: Configuration unchanged, skipping qmake step.
11:07:38: Starting: "C:\MinGW\bin\mingw32-make.exe" 
C:/MinGW/bin/mingw32-make -f Makefile.Debug
mingw32-make[1]: Entering directory 'C:/Users/User/CProjects/Test1-build-Windows7Desktop-Debug'
mingw32-make[1]: Nothing to be done for 'first'.
mingw32-make[1]: Leaving directory 'C:/Users/User/CProjects/Test1-build-Windows7Desktop-Debug'
11:07:39: The process "C:\MinGW\bin\mingw32-make.exe" exited normally. 
```

但是，当我尝试运行它时，我得到了这个：

```
Starting C:\Users\User\CProjects\Test1-build-Windows7Desktop-Debug\debug\Test1.exe...
The program has unexpectedly finished.
C:\Users\Hunter\User\Test1-build-Windows7Desktop-Debug\debug\Test1.exe exited with code -1073741819 
```

每次。我开始一个新项目，我做任何事情，但我得到了那个错误。现在，我也以调试模式运行。我收到此错误：

```
The inferior stopped because it received a signal from the Operating System.
Signal name: SIGSEGV
Signal meaning: Segmentation fault 
```

有问题的文件`qatomici386.h`位于第 132 行，具体功能如下`QBasicAtomicInt::deref`：

```
inline bool QBasicAtomicInt::deref()
{
        unsigned char ret;
    asm volatile("lock\n"
                 "decl %0\n"
                 "setne %1"
                 : "=m" (_q_value), "=qm" (ret)
                 : "m" (_q_value)
    -->          : "memory");
    return ret != 0;
} 
```

我在第 132 行标出了箭头。我正在运行一台 64 位机器，但我相信我安装了一个 32 位 MinGW ......但老实说，我什至不知道这是否是真正的问题，更不用说如何修复它了. 我对 C++ 和 Qt 很陌生。

根据要求，这是我的代码：mainwindow.cpp：

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

MainWindow::~MainWindow()
{
    delete ui;
} 
```

主.cpp：

```
#include "mainwindow.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    return a.exec();
} 
```

测试1.pro：

```
#-------------------------------------------------
#
# Project created by QtCreator 2012-12-17T23:06:31
#
#-------------------------------------------------

QT       += core gui

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = Test1
TEMPLATE = app

SOURCES += main.cpp\
        mainwindow.cpp

HEADERS  += mainwindow.h

FORMS    += mainwindow.ui 
```

主窗口.h

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private:
    Ui::MainWindow *ui;
};

#endif // MAINWINDOW_H 
```

如果还需要什么，请问。

这是完整的调试回溯：

```
0   QBasicAtomicInt::deref  qatomic_i386.h  132 0x402774    
1   QString::~QString   qstring.h   880 0x402805    
2   WinMain@16  qtmain_win.cpp  93  0x401eab    
3   main            0x402e6b 
```

更新：我运行了示例`toy clock`，它运行良好。但是，当我运行时`calculator form`，它导致了完全相同的错误。我注意到它`calculator form`在正常的项目形式中：它有一个`.pro`, 和 Header、Sources 和 Forms 文件夹。`toy clock`另一方面，只有一个文件`.qmlproject`和一个 qml 文件夹。它也在相同的位置以相同的回溯失败。我实际上对这些事情知之甚少，但希望它能帮助找到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:17:46.510

在安装了整个环境之后，我一直遇到同样的问题。

我一直在四处寻找，Qt 错误跟踪器上似乎有一个错误： [https ://bugreports.qt.io/browse/QTCREATORBUG-7653](https://bugreports.qt.io/browse/QTCREATORBUG-7653)

从页面：

> mingw 有多个二进制不兼容的版本。您需要为 qt 和您的程序使用相同的[1] mingw >version。这意味着要么使用 >mingw 版本自己编译 qt，要么使用与编译二进制 qt 软件包相同的版本。（我不确定，但这可能比[ftp://ftp.qt.nokia.com更新/misc/MinGW-gcc440_1.zip](ftp://ftp.qt.nokia.com/misc/MinGW-gcc440_1.zip) )
> 
> [1] 在 ABI 的意义上相同

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:10:14.843

比较我的一些（继承的）Qt 应用程序和这个[Qt 教程](http://sector.ynet.sk/qt4-tutorial/my-first-qt-gui-application.html)，我注意到`MainWindow`. 这可能只是一个约定，但这些来源显示`MainWindow`直接继承 Ui 类，然后直接调用`setupUi(this);`.

因此，这会将您重新调整`mainwindow.cpp`为：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent)
{
    setupUi(this);
} 
```

您没有包含`mainwindow.h`，但类定义应如下所示：

```
class MainWindow : public QMainWindow, private Ui::MainWindow
{
//... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T12:36:50.273

我也有同样的问题，重启windows就解决了，真的很奇怪，但对我有用。

希望这个帮助！

# python - 正交化矩阵numpy

> ID：13940056
> 
> 赞同：4
> 
> 时间：2012-12-18T19:26:27.607
> 
> 标签：python, numpy, orthogonal

我试图正交化 a`2d-numpy array`并失败了。我使用[了这种](http://en.wikipedia.org/wiki/Orthogonal_matrix#Nearest_orthogonal_matrix)方法并将其翻译成这段代码：

```
def sym(w):
    return w.dot((w.T.dot(w))**(-.5)) 
```

但

```
In [1]: a
Out[2]: 
array([[ 1.1,  0.1],
       [ 0.1,  1.1]])
In [3]: a = sym(a)

In [4]: a
Out[5]: 
array([[ 1.20909392,  2.43574363],
       [ 2.43574363,  1.20909392]])

In [6]: a.dot(a.T)
Out[7]: 
array([[ 7.39475513,  5.89008563],
       [ 5.89008563,  7.39475513]]) 
```

`a.dot(a.T)`应该输出身份。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T20:00:03.820

的工作定义`sym`是：

```
from scipy.linalg import sqrtm, inv

def sym(w):
    return w.dot(inv(sqrtm(w.T.dot(w)))) 
```

这是因为将 numpy 矩阵提高到 -.5 的幂并不等同于取[矩阵平方根](http://en.wikipedia.org/wiki/Square_root_of_a_matrix)然后对其求逆，这是公式所要求的。

# c# - 为什么我必须重建未更改的项目？

> ID：13940057
> 
> 赞同：7
> 
> 时间：2012-12-18T19:26:29.853
> 
> 标签：c#, visual-studio-2010, interop, masm

我有以下 MASM 代码：

```
.386
.model flat, stdcall
option casemap :none

include \masm32\include\masm32rt.inc

.data
    NewLine db  13, 10, 0
.code

LibMain proc instance:dword,reason:dword,unused:dword 
    mov     eax, 1
    ret
LibMain endp

PrintMess proc
    print "Printed from assembly"
    invoke StdOut, addr NewLine
    ret
PrintMess endp

TestReturn proc number:dword
    mov     eax, number
    ret
TestReturn endp

End LibMain 
```

使用一个简单的 .def 文件：

```
LIBRARY MyLib
EXPORTS PrintMess
EXPORTS TestReturn 
```

我正在从 C#调用`PrintMess`和调用：`TestReturn`

```
[DllImport("MyLib")]
static extern void PrintMess();

[DllImport("MyLib")]
static extern int TestReturn(int num);

static void Main(string[] args) {
    Console.WriteLine("Printed from C#");

    PrintMess();

    int value = TestReturn(30);
    Console.WriteLine("Returned: " + value);

    Console.ReadKey(true);
} 
```

我第一次运行它时，它暂停了`Console.ReadKey(true)`，我得到了预期的输出：

```
Printed from C#
Printed from assembly
Returned: 30 
```

如果我然后在我的 C# 项目中进行更改，说`TestReturn(30)`更改为，`TestReturn(50)`那么它的行为会很奇怪。该程序终止没有错误并且不会暂停`Console.ReadKey(true)`（似乎它甚至没有到达该行），这是我的输出：

```
Printed from C#
Printed from assembly 
```

我必须重建装配项目。具体来说，我必须重新构建，如果我进行另一个常规构建，程序会继续出现异常。当我重建时，输出和行为恢复正常并反映输出中的数字变化。我的猜测是 Build 和 Rebuild 之间的某些不同部分破坏了 DLL。

为什么我必须重建以及如何设置它以便我不必重建？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T07:47:26.497

@HansPassant 很可能是正确的，但没有解释为什么必须重建。@jacobaloysious 很接近。

VS 使用所谓的“托管进程”来简化和隔离调试。当您`test.exe`从 VS 调试时，实际上您实际上是在调试`test.vshost.exe`，它会加载您的 exe。停止调试时不会卸载主机可执行文件，因此是您真正的可执行文件。当您在不更改任何内容的情况下构建代码时，VS 实际上只检查文件是否是最新的。VS 认为，如果文件没有改变，那么就没有必要重新加载托管进程。如果您重建，即使您没有更改任何代码，您的真实可执行文件也会更新，这会强制主机进程与您的真实可执行文件一起终止并重新加载。

我认为，这个过程实际上是为了通过预加载汇编代码来加速调试的启动。您可以尝试在项目属性中关闭“启用 Visual Studio 托管进程”。之后，您应该会看到您的项目按预期工作。

在您进一步前进之前，请意识到 @HansPassant 是正确的，并且您的堆栈已损坏，并且随着时间的推移，您的项目将在意想不到的时间以最不愉快的方式以意想不到的方式失败。在大多数情况下，您的应用程序将抛出没有意义的异常，在某些情况下，您的应用程序将消失。

# ofbiz - 如何在 opentaps/OFBiz 中创建计算字段？

> ID：13940062
> 
> 赞同：0
> 
> 时间：2012-12-18T19:26:38.727
> 
> 标签：ofbiz, opentaps

我到处搜索，但没有找到任何解释到目前为止的内容。我想在一个人的年龄中创建计算字段，或者有一个货币字段，它是同一对象中几个其他字段的累积。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T10:04:10.447

你有不同的选择来做到这一点：

1）您可以创建一个视图并计算字段。在一个视图中，您可以使用 group-by 和 function 来计算 min、max、sum、avg、count 等。您可以参考以下链接了解更多信息： http: [//ofbiz.apache.org/docs/entity.html#View_Entity_Modeling](http://ofbiz.apache.org/docs/entity.html#View_Entity_Modeling)

2) 如果您使用的是 opentaps 提供的域驱动架构，您可以将一些代码添加到存储库中。存储库作为数据层的抽象，允许您在将对象返回给调用者之前创建计算和操作

3）您可以使用实体引擎创建一个sql并从数据库中获取计算字段。

阿尔贝托

# sql - sql根据输入查询不同的列

> ID：13940066
> 
> 赞同：0
> 
> 时间：2012-12-18T19:26:45.603
> 
> 标签：sql

我正在使用 MS-SQL 2008。我有一个表，其中包含基于其中位置的不同列，这些列将具有“Y”或 Null 值。该表还包含来自调查结果的位置以外的其他数据。我已经设置了一个临时的@TempLocation 来保存基于一个或全部的位置。我需要根据日期范围内的一个或多个位置行中的“Y”从表中选择行。

```
TableID Northwest Northeast Southwest Southeast Batchno first_choice date_completed
1       Y                   Y         Y         1       A            2012-11-10
2                 Y                   Y         1       SA           2012-19-10       
3       Y         Y                             1       N            2012-07-10
4       Y         Y                   Y         2       A            2012-10-10
5                           Y                   2       A            2012-16-10
6       Y                             Y         2       D            2012-21-10
7                 Y                             NULL    A            2012-19-10
8       Y         Y         Y         Y         3       SA           2012-11-10
9       Y                                       3       A            2012-10-10
10                          Y         Y         3       A            2012-07-10 
```

我已经创建了一条动态 SQL 语句来成功拉取一个位置，但是否可以拉取所有位置？

```
select  ''' + (SELECT * FROM @TempLocation) + ''',
count(batchno),
count(case when first_choice is not null then batchno end),
count(case when t.First_choice =''SD'' then 1 end) ,
count(case when t.First_choice=''D'' then 1 end) ,
count(case when t.First_choice=''N'' then 1 end) ,
count(case when t.First_choice=''A'' then 1 end) ,
count(case when t.First_choice=''SA'' then 1 end) 
from    customer_satisfaction_survey t
where   t.date_completed>= ''' + CAST(@beg_date AS VARCHAR) + '''
and     t.date_completed < ''' + CAST(dateadd(day,1,@end_date) AS Varchar) + '''
and     t.' + (SELECT * FROM @TempLocation) + ' = ''Y''' 
```

All 结果如下所示。

```
Number  Location   Total  Total2  SA  A  N  D  SD
1       Northwest  6      6       1   3  1  1  0
2       Northeast  5      4       2   2  1  0  0
3       Southwest  4      4       1   3  0  0  0
4       Southeast  6      6       2   3  0  1  0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:33:47.080

我不得不认为您以错误的方式处理此问题，因为您的数据未标准化。您应该做的第一件事是使用`UNPIVOT`. 我假设您使用的是 SQL Server，因为您的语法表明了这一点。不过，最好用数据库标记所有问题。

您可以使用以下语句对数据进行反透视：

```
select BatchNo, FirstChoice, DateCompleted, Location
from d
unpivot (val for location in (Northwest, Northeast, Southwest, Southeast)) as unpvt 
```

接下来，将您的临时表设置为每个位置都有一个单独的行。然后，您可以在没有动态 SQL 的情况下进行连接。就像是：

```
with dnorm as (
    THE NORMALIZATION QUERY HERE
)
select dnorm.location, count(*) as total,
       sum(case when dnorm.first_choice is not null then 1 else 0 end) as total2,
       sum(case when dnorm.first_choice = 'SA' then 1 else 0 end) as SA,
       . . .
from dnorm join
     @TempLocation tl
     on dnorm.location = tl.location
where ALL YOUR WHERE CONDITIONS HERE 
```

最终查询类似于：

```
with dnorm as (
    select BatchNo, FirstChoice, DateCompleted, Location
    from d
    unpivot (val for location in (Northwest, Northeast, Southwest, Southeast)) as unpvt
)
select dnorm.location, count(*) as total,
       sum(case when dnorm.first_choice is not null then 1 else 0 end) as total2,
       sum(case when dnorm.first_choice = 'SA' then 1 else 0 end) as SA,
       . . .
from dnorm join
     @TempLocation tl
     on dnorm.location = tl.location
where ALL YOUR WHERE CONDITIONS HERE 
```

动态 SQL 方法非常聪明，但我认为这不是最简单的方法。

# android - 报警管理器 2 次

> ID：13940073
> 
> 赞同：3
> 
> 时间：2012-12-18T19:27:09.280
> 
> 标签：android, alarmmanager, android-pendingintent

我有一个叫做`BroadcastReceiver`“警报工作”的电话。我正在尝试设置重复以在 5:45 和 17:30 触发，但在启动应用程序几秒钟后我看到“警报工作”。为什么会立即发送？`AlarmReceiver``Toast``PendingIntent``AlarmReceiver``PendingIntent`

```
 public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Calendar cal1 = Calendar.getInstance();
        cal1.set(Calendar.HOUR_OF_DAY, 05);
        cal1.set(Calendar.MINUTE, 45);
        cal1.set(Calendar.SECOND, 00);

        Calendar cal2 = Calendar.getInstance();
        cal2.set(Calendar.HOUR_OF_DAY, 17);
        cal2.set(Calendar.MINUTE, 30);
        cal2.set(Calendar.SECOND, 00);

        Intent intent = new Intent(this, AlarmReceiver.class);

        PendingIntent pi = PendingIntent.getBroadcast(getApplicationContext(), 0, intent,      PendingIntent.FLAG_UPDATE_CURRENT);
        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(),cal2.getTimeInMillis(), pi);

        Toast.makeText(this, "Alarm set", Toast.LENGTH_LONG).show();

    }

} 
```

报警接收器：

```
public class AlarmReceiver extends BroadcastReceiver {

        public void onReceive(Context context, Intent intent) {

            Toast.makeText(context, "Alarm worked.", Toast.LENGTH_LONG).show();

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T19:47:13.130

> 但我在我的应用程序启动几秒钟后看到“警报工作”。

我相信你收到第一个警报就好了。

但你相信它不会重复。这个错误，它*会*重复......每**~43年**一次。您使用的第三个参数[`setRepeating`](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)不正确，请尝试：

```
Calendar cal1 = Calendar.getInstance(); // Now
cal1.add(Calendar.SECONDS, 5); // Change to five seconds from now

alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, 
        cal1.getTimeInMillis(), 
        10000, /* Repeat every 10 seconds */ 
        pi); 
```

第三个参数是一个*区间*。此代码创建一个警报，该警报在 5 秒后响起，然后每 10 秒重复一次。通过使用`cal2`，您不小心将间隔设置为近 43 年。

* * *

要设置两个*不同的*警报，请使用：

```
Calendar cal1 = Calendar.getInstance();
cal1.set(Calendar.HOUR_OF_DAY, 05);
cal1.set(Calendar.MINUTE, 45);
cal1.set(Calendar.SECOND, 00);

Calendar cal2 = Calendar.getInstance();
cal2.set(Calendar.HOUR_OF_DAY, 17);
cal2.set(Calendar.MINUTE, 30);
cal2.set(Calendar.SECOND, 00);

// Test if the times are in the past, if they are add one day
Calendar now = Calendar.getInstance();
if(now.after(cal1))
    cal1.add(Calendar.HOUR_OF_DAY, 24);
if(now.after(cal2))
    cal2.add(Calendar.HOUR_OF_DAY, 24);

// Create two different PendingIntents, they MUST have different requestCodes
Intent intent = new Intent(this, AlarmReceiver.class);
PendingIntent morningAlarm = PendingIntent.getBroadcast(getApplicationContext(), 0, intent, 0);
PendingIntent eveningAlarm = PendingIntent.getBroadcast(getApplicationContext(), 1, intent, 0);

// Start both alarms, set to repeat once every day
AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal2.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T19:57:31.093

正如[Sam 的帖子](https://stackoverflow.com/a/13940376/910718)所说，您没有使用正确的`triggerAtMillis`and `intervalMillis`。我认为您是在告诉它在当天凌晨 5 点触发，这很可能在过去，在这种情况下，[文档](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)说

```
Calendar cal1 = Calendar.getInstance();
cal1.add(Calendar.HOUR, 5);
cal1.add(Calendar.MINUTE, 45);

long interval = 17 * 60 * 60 * 1000; // 17 hours converted to milliseconds
interval += 30 * 60 * 1000; // 30 minutes converted to milliseconds

Intent intent = new Intent(this, TestAlarmReceiver.class);
PendingIntent pi = PendingIntent.getBroadcast(getApplicationContext(), 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), interval, pi); 
```

可能是您想要做的。

编辑（更多解释）：

`cal1.add(Calendar.HOUR, 5);`获取当前日期和时间并将其增加 5 小时，因此结果是重复`PendingIntent`将在该日期从当前时间开始 5 小时 45 分钟开始。并且`interval`表示它将`PendingItent`从那时起每 17 小时 30 分钟发送第二个和后续的 s（从现在开始是 5 小时 45 分钟）。

如果您想将开始时间设置为上午 5:45，但不希望立即发送（除非此时恰好是上午 5:45）。那么你将要设置做：

```
cal1.set(Calendar.HOUR, 5);
cal1.set(Calendar.MINUTE, 45);
cal1.set(Calendar.SECOND, 0);

// Current time is after 5:45 am, don't start until tomorrow at 5:45
if (Calendar.getInstance().after(cal1))
    cal1.add(Calendar.DAY_OF_YEAR, 1) 
```

或者，您可以计算从该时间开始的时间间隔，以决定下一次何时触发它，假设它已经在 5:45 开始，但这需要更多的计算工作。

# excel - 地理编码 api 给出错误的十进制值

> ID：13940077
> 
> 赞同：2
> 
> 时间：2012-12-18T19:27:26.907
> 
> 标签：excel, geocoding

我正在尝试使用 Google 的地理编码 api 计算 Excel 中 GPS 航点之间的距离

地理编码 API 将这些航点转换为小数

```
WP1: S25 07 25.9 W57 20 22.1 = -25.1238745,-57.3396070 
WP2: S25 07 02.4 W57 19 15.1 = -25.1162286,-57.3175897 
```

在距离 API 中使用这些坐标总共会产生 2,374 米。

使用[http://transition.fcc.gov/mb/audio/bickel/DDDMMSS-decimal.html](http://transition.fcc.gov/mb/audio/bickel/DDDMMSS-decimal.html)翻译：

```
WP1: S25 07 25.9 W57 20 22.1 = -25.123861, 57.339472
WP2: S25 07 02.4 W57 19 15.1 = -25.117333, 57.320861 
```

在距离 API 中使用这些坐标会导致总共 2,010 米

谁能解释为什么地理编码 API 给出错误的值？

# sql - 使用现有电子表格查询数据

> ID：13940085
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:28:01.667
> 
> 标签：sql, excel

我有一个电子表格，其中列出了客户、他们的主管信息以及在创建报告时在他们的帐户中列出的特殊功能代码。

我需要在此表中添加一列，列出这些代码在客户帐户中填充的最后一个活动日期。

我知道功能上次激活时如何提取信息。但是，我需要根据这些特定的帐户和代码来进行查询。我可以使用哪些 SQL 子句系列来读取这些预先存在的值并返回相应的日期值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:57:04.677

你的问题有点模棱两可。你是如何填充电子表格的？您是在使用 SSIS 之类的 ETL 应用程序，还是从数据库中的 SQL 查询创建 Excel 输出？

如果您正在填充现有的 Excel 电子表格，请在该电子表格中创建一个名为“上次活动日期”的新列，以准备从源中填充它。

如果您从数据库源中提取数据，则可能存在关联的历史记录或存档表，您可以在其中找到预先存在的代码及其相应的日期。在这里，您的数据库管理员和/或开发人员将能够更好地帮助您浏览数据库架构。如果代码在源数据库中不再可用，则没有特殊的 SQL CLAUSE 将提供帮助。您无法检索不存在的内容。

# c++ - 调试断言失败

> ID：13940086
> 
> 赞同：0
> 
> 时间：2012-12-18T19:28:04.963
> 
> 标签：c++, winforms

我不断收到调试断言失败错误，我不知道为什么。运行此代码时出现错误：

```
 private: System::Void txtMessage_KeyDown(System::Object^ sender, System::Windows::Forms::KeyEventArgs^  e) {
         if(e->KeyCode == Keys::Enter && txtMessage->Text != ""){

             char* MESSAGE = new char[txtMessage->Text->Length];
             ZeroMemory(MESSAGE, sizeof(MESSAGE));

             string strMESSAGE = "";

             MarshalString(txtMessage->Text, strMESSAGE);
             memcpy(MESSAGE, strMESSAGE.c_str(), sizeof(strMESSAGE));

             if (send(sConnect, MESSAGE, 256, NULL) != SOCKET_ERROR){
                 txtMessage->Clear();
             }
         }
     } 
```

有时直到我多次使用该代码后才会出现错误，有时我第一次使用它时就会得到它。我真的不知道为什么我会得到这个，我不知道如何解决它。因此，如果有人可以提供帮助，我将不胜感激。

我在该代码期间不断收到的错误是： ![在此处输入图像描述](../Images/ac6e3bc79481a2f71b09a34e725d0c10.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:37:01.277

这是不正确的：

```
char* MESSAGE = new char[txtMessage->Text->Length];
ZeroMemory(MESSAGE, sizeof(MESSAGE)); 
```

因为它只会将`sizeof(char*)`字节归零而不是预期`Length`。

的分配`MESSAGE`也基于`txtMessage`但写入 from `strMessage`。可能是这些字符串对象的长度不相等，可能导致分配的内存不足。

的使用`memcpy()`也不正确：

```
memcpy(MESSAGE, strMESSAGE.c_str(), sizeof(strMESSAGE)); 
```

因为`sizeof(strMESSAGE)`不是`strMESSAGE`. 改为使用`length()`。

调用`send()`还将尝试访问可能大于分配给它不应该访问的内存的`256`字符。`MESSAGE``MESSAGE`

我不确定为什么这个电话`send()`不简单：

```
if (send(sConnect,strMESSAGE.c_str(),strMESSAGE.length(), NULL) != SOCKET_ERROR){ 
```

避免任何动态内存分配或复制。

*只是要注意我不熟悉，`MarshalString()`所以不能评论它的使用。*

# c++ - 根据两种对象类型选择正确的策略

> ID：13940091
> 
> 赞同：0
> 
> 时间：2012-12-18T19:28:29.177
> 
> 标签：c++, design-patterns, dispatch

我不知道如何命名这个问题，所以我会尽量解释清楚。

我希望能够根据两个不同对象的类型切换策略。为了完成这项工作，我正在考虑使用枚举类型标记对象，并拥有这些策略的“注册表”（数组）。理想情况下，正确的策略可以通过一些简单的操作来访问，比如两种类型之间的位运算符。

这个伪代码可能会使我试图解释的内容更容易理解：

```
enum Type { A, B, C }

struct Object {
  Type type;
}

class ActionRunner {
  vector<Strategy> strategies;

  void registerStrategy(type1, type2, strategy) {
    strategies[type1 operator type2] = strategy;
  }

  void runStrategyFor(type1, type2) {
    strategies[type1 operator type2].execute();
  }
} 
```

使用地图很容易解决这个问题，但我想使用数组或向量，因为对于这样的问题，地图似乎有点过头了，而使用数组可能要快得多。

所以问题是我不知道我可以使用什么运算符来选择正确策略的“位置”。我一直在考虑一些组合，但似乎它们最终都会在某些时候与不同的组合发生冲突。

有没有人有任何线索/建议我可以用来做这个？

PS：我知道过早优化不好，但我只是想弄清楚这个问题是否可以通过简单的方式解决。

- - - - 编辑 - - - - - - - - - - - - - - - - - - - - - ------

根据答案，我一直在对这个问题进行一些额外的思考，我得出的结论是，我对这个问题的意图不可能按照我想要的方式。我将尝试使用此问题重新陈述我现在尝试解决的问题。

我想要一个类结构，其中有某种类型的“BaseClass”对象和一个“处理器”对象，该对象采用从“BaseClass”派生的两个对象并为这些对象运行正确的策略。像这样的东西：

```
class Processor {
  void run (DerivedA a, DerivedB b);
}

class BaseClass {}
class DerivedA: public BaseClass {}
class DerivedB: public BaseClass {}

BaseClass a = new DerivedA;
BaseClass b = new DerivedB;

processor.run(a, b) 
```

据我了解，如果作为参数传递给“运行”的是引用，这将不会像我预期的那样工作，这是我宁愿做的。没有太复杂的代码有没有办法做到这一点？（三连发！？）

我想到了双重调度与我认为可以工作的从属（处理器）对象相结合的东西，但这似乎非常复杂，维护和扩展可能很痛苦。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T10:55:40.043

你问题的第二句话为我敲响了警钟：

> 我希望能够根据两个不同对象的类型切换策略。

这听起来像您想要执行[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)。有关如何在 C++ 中实现此功能，请参阅 C++ 中的[Double dispatch/multimethods 中](https://stackoverflow.com/questions/429849/double-dispatch-multimethods-in-c)的问题（特别是问题的答案 ;-)） 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T10:58:18.753

这是使用`map`而不是数组的经典示例。数组实际上是`map`key 定义为整数的私有情况。在您的情况下，键是一个元组，所以一个简单的数组不会这样做，并且您最终会遇到冲突（即使您对特定输入很幸运，您的代码也将非常不健壮）。

您可以有一个介于 simple`array`和`map`:之间的中间解决方案，`2D array`您的 2 种类型用作行和列的索引。

# c# - NET 4.5 应用程序中的 Windows 8 动态磁贴

> ID：13940094
> 
> 赞同：6
> 
> 时间：2012-12-18T19:28:47.410
> 
> 标签：c#, .net, windows-8, visual-studio-2012, microsoft-metro

我创建了一个成功更新其磁贴（动态磁贴）的 Windows 应用商店应用程序。我现在讨厌的事情是，我似乎无法在任何地方安装这个应用程序，除非通过 Windows Store 或使用另一个开发者帐户（[见这个](https://stackoverflow.com/questions/7493090/how-to-distribute-compiled-windows-8-metro-applications-without-windows-store)）。

由于我希望仅支持台式电脑，我可以使用通用 NET 4.5 应用程序中的动态磁贴吗？

或者换一种说法，有没有办法使用/控制来自 Windows Store 应用程序以外的应用程序的动态磁贴？

这对我来说仍然太新了......在网上找到答案，所以什么也没透露。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:34:52.450

Live Tiles 是 Metro 框架的一部分，与 .NET 完全分离。当您为 Windows 应用商店框架进行开发时，您的应用程序是沙盒的。没有人可以访问您的应用程序，您也无法访问其他任何人的应用程序。更新动态磁贴的唯一方法是应用程序更新它自己的动态磁贴。允许任何人更新任何磁贴将是一个巨大的安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:36:23.513

如果您不打算将您的应用程序提交到 Windows 应用商店进行分发 - 您可以查看[此](https://stackoverflow.com/questions/7465517/how-can-a-metro-app-in-windows-8-communicate-with-a-backend-desktop-app-on-the-s)线程，其中讨论了用于在桌面应用程序和 Windows 商店应用程序之间进行通信的方法。

# c# - Autofac 自定义生命周期管理器

> ID：13940100
> 
> 赞同：0
> 
> 时间：2012-12-18T19:29:22.650
> 
> 标签：c#, dependency-injection, autofac, lifetime

我在 Autofac 中没有找到一种可能性。自定义生命周期管理器。例如，在 Windsor.Castle 中，可以编写简单地从`AbstractLifestyleManager`.

```
public class MyCustomLifestyleManager : AbstractLifestyleManager
{
 public overrid object Resolve(CreationContext context)
 {
 ...
 }

} 
```

有人知道如何在autofac中做到这一点吗？我知道标准的终身经理，但问题是可以自己制作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:33:44.320

我认为您想使用自定义生命周期范围，请参阅[Autofac 博客文章](http://nblumhardt.com/2011/01/an-autofac-lifetime-primer/)。

> Autofac 在生命周期范围内满足工作单元的需求。`ILifetimeScope`生命周期范围（
> 
> 在处理工作单元期间解析的组件实例与生命周期范围相关联。通过跟踪实例化顺序并确保依赖关系只能由相同或更长生命周期范围内的组件满足，Autofac 可以在生命周期范围结束时负责处理。

[这个问题](https://stackoverflow.com/questions/9433983/autofac-any-way-to-resolve-the-innermost-scope)提供了示例代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:06:35.417

您想要实现`ILifetimeScopeProvider`诸如[RequestLifetimeScopeProvider](http://code.google.com/p/autofac/source/browse/Core/Source/Autofac.Integration.Mvc/RequestLifetimeScopeProvider.cs)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:06:57.253

除非您在 Web 应用程序中，否则没有简单的方法来实现您自己的自定义生活方式。Web 应用程序具有生命周期范围提供程序（通常用于请求范围），但其他应用程序没有。

正如您所注意到的，根据创建对对象执行自定义操作的方法是使用 OnActivated 或 OnActivating 事件。还有一个 OnRelease 允许您随时运行自己的自定义逻辑。但是您可以自己实现扩展以使该机制在语法上看起来不错。

您还可以将委托表达式（lambdas）注册为依赖项，这样您就可以在那里做一些漂亮的事情。

在所有这些事情之间，你应该能够完成你想做的事情。

# j - 是J联想的火车

> ID：13940103
> 
> 赞同：3
> 
> 时间：2012-12-18T19:29:32.150
> 
> 标签：j, apl, tacit-programming

在编程语言 J 中，一系列动词总是关联的吗？如果是，有证据吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:09:17.583

不，一系列动词不是关联的，这遵循定义。例如，叉子是

```
(f g h) y = (f y) g (h y) 
```

但

```
(f (g h)) y = y f ((g h) y) = y f (y g (h y)) 
```

也可以写成`y f y g h y`。和

```
((f g) h) y = y (f g) (h y) = y f (g (h y)) 
```

也可以写成`y f g h y`。

这三个是完全不同的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:20:05.440

在 J 中训练，`right associative`最小组是 a `fork`。只有当它不能做叉子时，它才会做一个钩子。所以

```
vvvvv = (vv(vvv)), 
```

和

```
vvvv= (v(vvv)). 
```

# ios - performDefaultHandlingForAuthenticationChallenge: 的默认行为是什么？

> ID：13940106
> 
> 赞同：3
> 
> 时间：2012-12-18T19:29:44.147
> 
> 标签：ios

对此的文档只是说：“导致使用系统提供的默认行为。”

系统默认行为是什么？

我想系统会检查服务器的证书，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-30T20:50:46.000

是的，如果挑战是针对服务器证书验证 ( `[challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]`)，系统将执行默认/安全 SSL 证书验证。

# list - Common Lisp：列表中的所有或任何元素都为真

> ID：13940111
> 
> 赞同：17
> 
> 时间：2012-12-18T19:30:07.450
> 
> 标签：list, lisp, common-lisp

在 Python 中有函数[`all`](http://docs.python.org/3/library/functions.html#all)，[`any`](http://docs.python.org/3/library/functions.html#any)如果列表的所有或部分元素分别为真，则它们返回真。Common Lisp 中是否有等价的功能？如果不是，那么写它们的最简洁和惯用的方式是什么？

目前我有这个：

```
(defun all (xs)
  (reduce (lambda (x y) (and x y)) xs :initial-value t))

(defun any (xs)
  (reduce (lambda (x y) (or x y)) xs :initial-value nil)) 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-18T19:34:49.423

在 Common Lisp 中，使用[every](http://www.lispworks.com/documentation/HyperSpec/Body/f_everyc.htm#every)（相当于`all`）和[some](http://www.lispworks.com/documentation/HyperSpec/Body/f_everyc.htm#some)（相当于`any`）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-18T19:44:31.487

您可以将 LOOP 宏与`ALWAYS`和`THEREIS`子句一起使用，如下所示：

```
CL-USER 1 > (loop for item in '(nil nil nil) always item)
NIL

CL-USER 2 > (loop for item in '(nil nil t) always item)
NIL

CL-USER 3 > (loop for item in '(t t t) always item)
T

CL-USER 4 > (loop for item in '(nil nil nil) thereis item)
NIL

CL-USER 5 > (loop for item in '(nil nil t) thereis item)
T

CL-USER 6 > (loop for item in '(t t t) thereis item)
T 
```

# c# - 以其他用户身份登录时丢失会话/cookie

> ID：13940118
> 
> 赞同：3
> 
> 时间：2012-12-18T19:30:48.407
> 
> 标签：c#, asp.net, dotnetnuke, dotnetnuke-module

我正在构建`dnn`允许登录用户以另一个用户身份登录的模块。
但我在这里有一些有线问题。
这就是我注销当前用户并以另一个用户身份登录的方式：

```
UserInfo userInfo = UserController.GetUserById(portalId, userId);
if (userInfo != null)
{                
    DataCache.ClearUserCache(this.PortalSettings.PortalId, Context.User.Identity.Name);

    if (Session["super_userId"] == null)
    {
        Session["super_userId"] = this.UserId;
        Session["super_username"] = this.UserInfo.Username;
    }

    HttpCookie impersonatorCookie = new HttpCookie("cookieName");
    impersonatorCookie.Expires = DateTime.Now.AddHours(1);
    Response.Cookies.Add(impersonatorCookie);

    Response.Cookies["cookieName"]["super_userId"] = this.UserId.ToString();
    Response.Cookies["cookieName"]["super_username"] = this.UserInfo.Username;

    PortalSecurity objPortalSecurity = new PortalSecurity();
    objPortalSecurity.SignOut();

    UserController.UserLogin(portalId, userInfo, this.PortalSettings.PortalName, Request.UserHostAddress, false);

    Response.Redirect(Request.RawUrl, true);
} 
```

在`PageLoad()`我尝试从这个 cookie 中读取值但它没有读取任何内容：

```
try
{
    string super_userId = Request.Cookies["cookieName"]["super_userId"];
    string super_username = Request.Cookies["cookieName"]["super_username"];

    if (!String.IsNullOrEmpty(super_userId))
    {
        this.Visible = true;
        this.lblSuperUsername.Text = Session["super_username"].ToString();
        this.txtPassword.Enabled = true;
        this.btnBackToMyAccount.Enabled = true;
    }
... 
```

我也尝试对 session 做同样的事情，但没有任何效果，我不知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:43:17.290

正如我在[这里](https://stackoverflow.com/questions/5366635/is-it-possible-to-set-a-cookie-during-a-redirect-in-asp-net)发现的那样，在被重定向的请求中设置 cookie 可能会出现问题，并且[这里](http://www.zugiart.com/2011/04/http-redirect-and-cookies/)声明当它们的域不是时，cookie 不会通过重定向设置`/`。

因此，您可以尝试不使用 HTTP 标头重定向，而是显示“登录”页面，而不是包含“主页”链接和[元刷新](http://en.wikipedia.org/wiki/URL_redirection#Refresh_Meta_tag_and_HTTP_refresh_header)或[Javascript 重定向](http://en.wikipedia.org/wiki/URL_redirection#JavaScript_redirects)。

顺便说一句，在 cookie 中设置 UserID 并不是真正可行的方法。如果我将该 cookie 值更改为`1`怎么办？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:18:51.753

我建议您在设置新 cookie 时始终设置`Domain`, 并且可能和`Expires`.

```
Response.Cookies[cookieName].Domain = RootURL;
Response.Cookies[cookieName].Expires = DateTime.UtcNow.AddDays(cDaysToKeep); 
```

域对于没有子域的 url 非常重要，例如只有没有子域，`mydomain.com`因为`www.`如果从 www.mydomain.com 设置 cookie 并且您尝试从 mydomain.com 读取它，反之亦然，那么 cookie 将不被阅读，您可能会丢失/覆盖它。

所以我建议做一个函数，当你设置一个cookie时，你至少设置3个参数，the `Domain`, the `Expires`, and the `Value`。

类似的问题和答案：
[使用相同登录数据库的多个应用程序相互注销](https://stackoverflow.com/questions/2454623/multiple-applications-using-same-login-database-logging-each-other-out/2491686#2491686)
[asp.net forms authentication 在登录到另一个实例时注销](https://stackoverflow.com/questions/8236180/asp-net-forms-authentication-logged-out-when-logged-into-another-instance/8236300#8236300)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T11:13:53.923

Put these two statements

```
Response.Cookies["cookieName"]["super_userId"] = this.UserId.ToString();
Response.Cookies["cookieName"]["super_username"] = this.UserInfo.Username; 
```

after

```
UserController.UserLogin(portalId, userInfo, this.PortalSettings.PortalName, Request.UserHostAddress, false); 
```

May be the UserLogin method is resetting the Session variables. Hope it Helps :)

# django - 在 PostgreSQL 上使用 LIKE 的 Django 原始 SQL 查询

> ID：13940125
> 
> 赞同：3
> 
> 时间：2012-12-18T19:31:23.443
> 
> 标签：django, postgresql, psycopg2, sql-like

我正在尝试使用 Psycopg2 驱动程序在 PostgreSQL 数据库中使用 LIKE 在 Django 中进行原始选择。

我已经测试了很多我在网上找到的东西，但没有任何效果。

情况如下。我需要像这样执行 SELECT：

```
select distinct on (name, adm1.name, adm2.name_local)
gn.geonameid,
case when altnm.iso_language = 'pt' then altnm.alternate_name else gn.name end as name,
adm1.name as zona,
adm2.name_local as municipio
from location_geonameslocal gn
join location_geonameszone adm1 on adm1.code = gn.country || '.' || gn.admin1
join location_geonamesmunicipality adm2 on adm2.code = gn.country || '.' || gn.admin1 || '.' || gn.admin2
left join location_geonamesalternatenames altnm on altnm.geonameid = gn.geonameid
where
(gn.fclass = 'P' or gn.fclass = 'A')
and (altnm.iso_language = 'pt' or altnm.iso_language = 'link' or altnm.iso_language is null or altnm.iso_language = '')
and gn.country = 'PT'
and (gn.name like '%Lisboa%' or altnm.alternate_name like '%Lisboa%')
order by name, adm1.name, adm2.name_local; 
```

SELECT 的重要/问题部分是这个：

```
and (gn.name like '%Lisboa%' or altnm.alternate_name like '%Lisboa%') 
```

我编写了一个简单的视图来测试 SELECT，它看起来像这样：

```
def get_citiesjson_view(request):
    word = "Lisboa"
    term   = "%" + word + "%"

    cursor = connection.cursor()
    cursor.execute("select distinct on (name, adm1.name, adm2.name_local)\
          gn.geonameid,\
          case when altnm.iso_language = 'pt' then altnm.alternate_name else gn.name end as name,\
          adm1.name as zona,\
          adm2.name_local as municipio\
          from location_geonameslocal gn\
          join location_geonameszone adm1 on adm1.code = gn.country || '.' || gn.admin1\
          join location_geonamesmunicipality adm2 on adm2.code = gn.country || '.' || gn.admin1 || '.' || gn.admin2\
          left join location_geonamesalternatenames altnm on altnm.geonameid = gn.geonameid\
          where\
          (gn.fclass = 'P' or gn.fclass = 'A')\
          and (altnm.iso_language = 'pt' or altnm.iso_language = 'link' or altnm.iso_language is null or altnm.iso_language = '')\
          and gn.country = 'PT'\
          and (gn.name like %s or altnm.alternate_name like %s)\
          order by name, adm1.name, adm2.name_local;", [term, term])

    data = cursor.fetchone()

    mimetype = 'application/json'
    return HttpResponse(data, mimetype) 
```

不幸的是，这不起作用，我找不到使它起作用的方法。一些线索？

* * *

**更新**：这种形式实际上是有效的：

```
cursor.execute("... and (gn.name like %s or altnm.alternate_name like %s)... ",  ['%'+term+'%', '%'+term+'%']) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:59:17.397

This form is actually working:

```
cursor.execute("... and (gn.name like %s or altnm.alternate_name like %s)... ",  ['%'+term+'%', '%'+term+'%']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-23T18:23:59.580

您不应该使用默认的 Python 格式来构造带参数的 SQL 查询，要使用原始 SQL LIKE 子句，您可以执行以下操作：

```
sql = 'SELECT id FROM table WHERE 1 = 1'
params = []

if 'descricao' in args.keys():  # your validation
    # build sql query and params correctly
    sql += ' AND descricao LIKE %s'
    params.append('%'+args['descricao']+'%')

with connections['default'].cursor() as cursor:
    cursor.execute(sql, params) 
```

这样您就可以安全地抵御 SQL 注入漏洞

# c# - Asp.net路由Url转换？

> ID：13940128
> 
> 赞同：0
> 
> 时间：2012-12-18T19:31:35.240
> 
> 标签：c#, asp.net, url-rewriting, routing

假设我有这个 sql server 表：

```
id   Name      Band
--------------------
1    John      Beatles
2    Paul      Beatles
3    George    Beatles
4    Ringo     Beatles 
5    Jim       Doors 
```

我想要一个人的详细信息页面，例如：

`http://localhost/Music/Beatles/Paul`

我想对待的是：

`http://localhost/Details.aspx?id=2`

所以-我正在编写这段代码来注册一个简单的路线：

```
void Application_Start(object sender, EventArgs e)
{
    RouteTable.Routes.MapPageRoute("MyRoute", "Music/{Band}/{Name}", "~/Details.aspx");
} 
```

但我不明白：

当 Asp.net 得到`http://localhost/Music/Beatles/Paul`时，他**怎么**知道它知道 Paul 的值是`2`?

你是在告诉我每次asp.net遇到`Paul`他应该去数据库并扫描一个预定义的唯一列（`Name`在这种情况下）并获取它的列`ID`值吗？

**或者我应该**像 SO 那样将 Paul 的价值注入到 url 中：

```
 http://stackoverflow.com/questions/13938994/jquery-conditional-validation-based-on-select-text 
                                       ^
                                       |
--------------------------------------- 
```

在我的情况下：

`http://localhost/Music/Beatles/2/Paul`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:42:13.637

Asp.net 本质上并不知道 Paul 的 ID 是`2`.

您必须自己在某处编写此逻辑。您可以自己编写`RouteHandler`并自己进行路由（这将执行 db 调用以确定正确的 ID）。

就个人而言，我只会让 aspx 页面自己处理信息，而不是假设它被赋予了一个实际的 ID。

这是自定义路由处理程序的代码示例（取自[Friendly URLs for ASP.NET](https://stackoverflow.com/questions/45340/friendly-urls-for-asp-net)）

```
public class CustomRouteHandler : IRouteHandler
{
    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        string virtualPath = "~/path/to/page.aspx";

        int id;

        // this would obviously be some sort of database call
        if (requestContext.RouteData.Values["Name"] == "Paul") 
        {
            id = 2;
        }
        else
        {
            id = 8675309;
        }

        string newPath = string.Format(
            "{0}?id={1}",
            virtualPath,
            id
        );

        HttpContext.Current.RewritePath(newPath);

        return BuildManager.CreateInstanceFromVirtualPath(virtualPath, typeof(Page)) as IHttpHandler;
    }
} 
```

并注册路线

```
RouteTable.Routes.Add("MyCustomRoute", new Route("Music/{Band}/{Name}", new CustomRouteHandler()); 
```

# windows-8 - 如何告诉我的页面应用程序已恢复？

> ID：13940132
> 
> 赞同：2
> 
> 时间：2012-12-18T19:32:08.347
> 
> 标签：windows-8, windows-store-apps, resume, suspend, application-lifecycle

J. Likness 在“使用 C# 和 XAML 构建 Windows 8 应用程序”的第 166 页上谈到 OnResuming 事件时表示：“ *[此事件] 的主要原因是应用程序提供及时数据以刷新其信息。* ”

我的应用中有一个页面包含此类数据；因此，如果用户已恢复应用程序，并且他显式返回或隐式/自动返回到该页面（假设应用程序暂停时他在该页面上），我想刷新数据。但是我怎么知道我的应用程序被暂停/恢复了？

我的想法是设置一个布尔值，数据丰富的页面可以在其 OnNavigatedTo() 事件中询问；如果是真的，我会刷新数据。有没有更好的方法来做到这一点，也许更重要的是：如果用户在该页面上，应用程序被暂停然后恢复，是否会触发 OnNavigatedTo() 事件？或者应用程序是否将页面视为从未离开过，因此它没有被导航回？也许另一个页面级事件会更合适？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T06:18:54.147

我想说您需要确定何时需要刷新感兴趣的页面的阈值；我认为它不像布尔值那么简单。用户可以暂停并几乎立即恢复（例如在 15 秒内），这可能不值得刷新，但同一用户也可以在辅助页面上徘徊，从不暂停，并在 30 分钟后返回页面，在这种情况下页面数据可能非常陈旧。您的布尔值可能需要更多的时间戳。

也就是说， Resuming 事件不会触发[OnNavigatedTo](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.page.onnavigatedto.aspx)。如果您需要知道要返回的页面，则需要在暂停时保存该信息，也许在[LocalSettings](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.localsettings.aspx)中。但是现在考虑一下，如果您在 C#/XAML 中使用[SuspensionManager](http://msdn.microsoft.com/en-us/library/windows/apps/Hh986968.aspx)，这已经代表您发生了，并且如果您考虑一下，您想要的行为与应用程序时应该发生的行为并没有太大的不同（如果有的话）从终止状态返回。

所以以类似的方式，你可以添加一个电话

```
await SuspensionManager.RestoreAsync() 
```

作为您对 Resuming 事件的实现。反过来，这将导致[OnNavigatedTo](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.page.onnavigatedto.aspx)并且您将运行启动该页面的正常逻辑。

从技术上讲，它不再恢复，您只是使用恢复事件来触发整个页面的重新加载。根据页面的性质，这可能有点过头了（例如，可能有很多半静态数据而只有极少的易失性数据——*恢复*不需要恢复静态数据）。您可能想要回拨在“恢复”和“终止”上刷新了多少，但由于 SuspensionManager 是您可以查看和更改的代码，因此您可以控制该粒度级别。也许在这里您介绍了您对布尔值的想法，以区分在通过 Resuming 调用时需要在 LoadStateAsync 中完成的操作与通过其他方式调用时需要完成的操作。

# python - 响应式网页设计，穿插移动检测以实现更好的控制

> ID：13940133
> 
> 赞同：1
> 
> 时间：2012-12-18T19:32:16.657
> 
> 标签：python, web-applications, responsive-design, mobile-website, progressive-enhancement

我刚刚完成了我的第一个网站的构建，并考虑了移动优先的响应式设计过程。该网站在移动设备上看起来和工作都很棒，但桌面体验却相当缺乏。在不影响移动体验的情况下，我没有什么好的方法可以改善桌面体验，即便如此，我还是无法使用纯客户端方法来做一些事情。

我不想管理两个单独的网站（移动、桌面）。我想要做的是让移动检测服务器端更好地控制我何时加载/显示更多数据等。

我想做类似的事情：

```
// in view
...
if not request.mobile: 
    related_posts = post.get_related_posts()
...

// in template
...
{% if not request.mobile and related_posts %} 
    {{ related_post_stream(related_posts) }} 
{% endif %}
... 
```

令人惊讶的是，我没有看到太多关于以这种方式做事的在线讨论。我读过的大多数文章要么推荐纯（移动优先）响应式设计，要么推荐单独的移动网站，尽管这似乎是一个不错的主意。这样做有缺点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:12:24.863

如果您使用的是 Django，则有[django-mobile](https://github.com/gregmuellegger/django-mobile)模块，可让您检查模板中的移动使用情况，如下所示：

```
{% if flavour != "mobile" %}Desktop version{% endif %} 
```

如果您不使用 Django，您仍然可以分析该模块的来源并为您的网站实现类似的东西。

# regex - 在 VIM 中，为什么不必在搜索和替换中添加回 '$'？

> ID：13940134
> 
> 赞同：5
> 
> 时间：2012-12-18T19:32:50.040
> 
> 标签：regex, linux, vim, end-of-line

我一直在学习如何在 VIM 中执行更复杂的搜索和替换功能，并且遇到了这样的用例：

```
:%s/$/|/g 
```

据说这会找到每行的末尾并用垂直管道替换它。不过，当我第一次学习这一点时，我认为您*必须*在替换字符串中添加行尾字符才能获得预期的结果。IE，

```
:%s/$/|$/g 
```

为什么没有它它仍然可以工作并且仍然保留换行符？它不应该用您的字符串替换行的终止字符并在此过程中将其删除吗？

可以用行首字符 . 来询问同样的事情`^`。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-18T19:34:57.627

Anchor`$`不包含换行符。事实上，它是一个*零宽度*标记。它匹配字符串中第一个换行符之前的空字符。因此结果。

同样，匹配字符串中*第*`^`一个字符之前的空字符。

 *有关详细信息，请参阅[http://www.regular-expressions.info/anchors.html 。](http://www.regular-expressions.info/anchors.html)*

# java - 通过组件构造函数自动装配静态成员

> ID：13940140
> 
> 赞同：3
> 
> 时间：2012-12-18T19:33:18.447
> 
> 标签：java, spring, static, dependency-injection

我知道这可以编译，但我的问题是，这是个好主意吗？我很好奇为什么这可能不是一个好主意。更好的是，是否有替代方案，如果`SomeStaticClass`是`@Component`，但它也必须是 的静态成员`MyComponent`。我的理解是，拥有 Spring 自动装配静态成员的设计很糟糕。根据我所阅读的内容，我仍然不太明白为什么。说我有以下内容：

```
@Component
public final class MyComponent {

  private static SomeStaticClass someStaticClass;

  @Autowired
  MyComponent(SomeStaticClass someStaticClass) {
    MyComponent.someStaticClass = someStaticClass;
  }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T19:40:37.580

为什么它是一个糟糕的设计的几个原因：

*   `static`可变字段通常是一个糟糕的设计

*   使测试更难 - 一旦设置了这个字段，它将在下一个测试中保持设置，可能会创建隐藏的相互依赖关系

*   如果你想有两个实例`MyComponent`，每个实例都有不同的`SomeStaticClass`？混乱。

*   您不能通过`static`字段或设置器自动装配注入值，这是明确禁止的。这一定是有原因的。

*   你为什么需要那个？你有`static`方法`MyComponent`吗？为什么？

*   如果上述情况属实，您如何防止`MyComponent.staticMethod()`在构造函数初始化该字段之前调用？Spring 的全部意义在于返回完全填充、安全的 bean

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T19:38:36.500

Spring bean 默认是单例的，所以创建`someStaticClass`一个实例字段，并保持你的代码干净和可测试。没有理由`someStaticClass`保持静止。非最终静态字段是一种气味。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:09:54.373

Despite of the design flaws, if you need to initialize a static variable with context it should be done as soon as possible.

There are several possibilities, some that are compatible with `@Autowired` are:

*   Let class to implement `ApplicationListener` or use an `ApplicationListener` to refresh it.
*   Override `onRefresh()` method and refresh it.
*   Make the bean definition the first one, singleton are instantiated in the same order that registered.
*   Use `depends-on` on on some other early instatiated bean, a MessageSource is a good chance.

Is quite dark, but if you really need it...

Other option is write a BeanFactoryPostProcessor an inject the static field by hand

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T19:56:42.797

这是糟糕的设计，因为生命周期不同。静态变量，一旦初始化，即使关闭应用程序上下文也会继续存在。

另一个不匹配是可能有多个应用程序上下文。如果`SomeStaticClass`是注册表怎么办？正如 Tomasz 指出的那样，这将导致混乱。

也有可能在容器初始化之前访问该变量。机会比你想象的要大：容器中的某些 bean 可能会在其初始化期间调用静态`MyComponent`方法`MyComponent`不知道正确的顺序 - 你必须使用`@DependsOn`注释）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T19:38:35.073

`@Component`基本上意味着你的bean默认是单例的。因此，在其中具有静态依赖关系没有多大意义。但它会按照你说的编译。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-18T19:38:54.700

`static`默认情况下，所有 Spring bean 都是单例的，因此在设计类时不需要在这里。

# python - 设计：“if __name__ == __main__”测试后的代码

> ID：13940144
> 
> 赞同：2
> 
> 时间：2012-12-18T19:33:27.903
> 
> 标签：python

我想听听关于这个问题的意见：之后有很多代码是不是一个坏主意

`if __name__ == '__main__':`

我问这个的原因是，我当前的项目有大约 40000 行代码，并且随着它的增长，我不断在上述语句之后添加行。所以这个程序预计会有大约 3000 行代码，我担心在这个语句之后我会有太多的代码。所以问题是“在这条语句之后编写大量代码是一种好的 Python 方式吗？”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T19:37:18.927

一个简单的替代方法是将您的主要代码添加到一个函数中，然后在检查`main()`后简单地调用它。`__name__`这样，你得到：

*   `__name__`支票的好处
*   功能的好处（可能可重用或不可重用）
*   内省的好处（例如，如果您需要它，很容易自动分析模块的“主要”代码是什么——它只是`main`函数！）。

一个例子：

```
def main():
    # Be awesome here.

if __name__ == '__main__':
    main()  # or sys.exit(main()), if you want to return an exit code 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:37:25.083

如果你想重用你的代码，你不应该在之后保留它`if __name__ == '__main__'`（将它用于函数/类/模块，并从程序的这一部分进行最简单的调用）。让我在这里提一下 Python 之禅（在你的情况下至少有两点）：

> 稀疏比密集好。
> 
> 可读性很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:32:45.650

听起来这里有两个不同的观点：

*   在所有其他条件相同的情况下，最好定义封装由 400 行命令式代码表示的行为的函数，以提高可读性、可测试性、可维护性（可能还有“-ability”的一些其他值）。

*   由 限定的代码`__name__ == '__main__'`仅在直接调用文件*时*执行，而不是作为模块包含在`import`. 所以，像这样的文件

    ```
    def be_awesome():
        pass

    if __name__ == '__main__':
       def be_more_awesome():
            pass 
    ```

`be_more_awesome`只有在作为源参数提供给 python 调用时才会有定义，而不是在导入时。`__name__`因此，作为一般规则，将仅当文件作为脚本直接运行时才应运行的代码准确地放在测试之后是合适的。问自己这些问题

*   “如果我在另一个文件中导入这个模块，这段代码运行会不会很糟糕？”
*   “我直接调用这个文件时需要调用这段代码吗？” （就像封装 400 行的假设`main`函数一样）

如果其中任何一个问题的答案是“是”，则它（可能）属于`__name__`测试之后；如果不是，它（可能）不会。

# javascript - 从页面中删除画布并将其替换为简单的文本消息

> ID：13940145
> 
> 赞同：0
> 
> 时间：2012-12-18T19:33:27.573
> 
> 标签：javascript, html

我正在尝试从页面中删除画布并将其替换为消息。这就是我所拥有的：

```
<div id="1">
<div class="2">
<canvas>
</div>
</div> 
```

我想要做的是移除画布并用一条消息替换它，一条简单的消息，上面写着：“事情已断开连接”。

我在尝试：

$("#1 .2").innerHtml = "我想说的"

但这并没有删除画布，我只是想知道为什么以及是否有更好的方法来做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:35:08.567

纯 JavaScript：

```
document.getElementById("1")
        .getElementsByTagName("div")[0]
        .innerHTML = "What I want to say"; 
```

查询：

```
$("#1 .2").html("What I want to say"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:37:08.457

您正在使用 jQuery，不是吗？

```
$("#1 .2").html("What I want to say"); 
```

# ruby-on-rails - ActionMailer HTML Encoding Hell - 特殊字符替换为垃圾

> ID：13940148
> 
> 赞同：6
> 
> 时间：2012-12-18T19:33:40.997
> 
> 标签：ruby-on-rails, ruby, encoding, utf-8, actionmailer

我有 UTF-8 字符串：`Website • Facebook`
那是中间的子弹`&bull;`或`0xE2 0x80 0xA2`

此值正确存储在数据库中，并使用 Rails 3 和 ruby​​ 1.9.3 使用默认设置正确显示在屏幕上。

我正在尝试通过 HTML 电子邮件发送此邮件，但是当一切都说完后，接收端会看到垃圾：

![在此处输入图像描述](../Images/c333d545d2447377ab6c289ea2c001ff.png)

这背后的代码很简单，我有一个`ActionMailer`子类（默认使用 UTF-8）设置以在布局中发送带有 UTF-8 内容编码的 HTML 电子邮件：

`email.html.erb`布局文件：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=9" />       
    <meta charset="utf-8">
    <%= stylesheet_link_tag "application", :media => "all" %>       
</head>
<body class='email'>
    <%= yield %>                        
</body>
</html> 
```

内容使用与呈现网页相同的视图，重要的一行是：

```
<p><%= simple_format strip_tags(comment.text) %></p> 
```

我已经尝试了许多 , 的排列`force_encoding`，`encode`将冗余的 UTF-8 编码应用于`ActionMailer`子类、视图文件的顶部以及大约十几个其他的东西，但似乎没有任何效果。

通过 Apple Mail[的原始 html 消息](https://gist.github.com/4331131)查看的重要 HTML是：

```
Website =EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD Facebook 
```

如果您查看原始消息（上面链接），这不会出现在纯文本消息上，只有 HTML 消息。

**TL;博士**

`0xE2 0x80 0xA2`
ActionMailer 正在用垃圾替换应该是 UTF-8 项目符号字符：`0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD 0xEF 0xBF 0xBD`

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T10:09:40.440

检查您是否使用 gem 来内联 CSS，例如`premailer-rails3`.

[根据这篇文章](http://pivotallabs.com/users/mbrunsfeld/blog/articles/2344-no-go-on-nogo)，这可能会损坏 ActionMailer 电子邮件中的 UTF-8 字符。

尝试使用 gem 之类的东西移除或替换`actionmailer_inline_css`gem。

# c# - 我应该如何处理这些数据？

> ID：13940149
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:33:41.840
> 
> 标签：c#, windows-phone-7, xaml, c#-4.0

我有一个适用于 Windows Phone Mobile 的应用程序，它将有多个 Mp3 文件。示例：263Mb，03:04:50（播放时间）

我想找到一个免费托管这些数据的解决方案，或者如何在移动环境中正确实施类似的东西。

到目前为止，我想到了：

当应用程序启动时，它会将媒体安装到隔离的存储中，并在访问应用程序内容的整个过程中保持在那里。

此功能不会在每次启动时执行，而是在第一次初始启动时执行。

我是不是看错了，或者你有更好的解决方案？

希望得到一些建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:35:52.650

XAP 包的最大大小为 250 MB，因此您不能将 mp3 文件打包到您的应用程序中。唯一的方法似乎是下载或流式传输。

# objective-c - 建模 CoreData 对象，如 SQL

> ID：13940152
> 
> 赞同：0
> 
> 时间：2012-12-18T19:33:52.403
> 
> 标签：objective-c, core-data

将 CoreData 对象与关系数据库完全一样建模是最佳实践吗？我知道 CoreData 不是关系数据库。

那么我会有以下对象（我知道我不应该在关系中有 id 字段）：

```
Business 
Building (Business has many locations; relationship)
Location (building has a location relationship)
Coord (Locations has a lat/long coord)
Worker (work has relationship to business and to location) 
```

这很崩溃吗？只拥有一个工人并且具有工作地址属性和业务属性会更好吗？建筑物是否应该只有地址、城市、州、邮政编码字段而不是与位置的关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:44:31.820

这里的一个指导原则应该是故障意味着没有内存使用。这通常是非常可取的（事实上，这是您首先使用 Core Data 的主要原因之一）。具有位置关系的建筑物意味着我们不必仅仅为了加载建筑物而加载位置信息；相反，我们会出错，仅在实际需要时才获取位置信息。

但相反的考虑也适用。你应该抵制过度标准化你的模型的诱惑。这不是 SQL 数据库。关系意味着我们无法在没有单独的加载阶段的情况下获取数据。这需要开销和时间。因此，如果您有在访问对象时想要访问的单个事实，它们应该*在*对象中，以便与它们一起加载。

在你的情况下，我会说你过度规范化了。除非你打算用坐标做一些非常有趣的事情，例如，我不明白为什么坐标不应该是位置的一部分。除非您打算将某些位置作为单独的对象进行操作，否则我不明白为什么建筑物不仅有地址。

# delphi - 将数据从 TADOTable 批量移动到 MySQL TMyTable

> ID：13940154
> 
> 赞同：0
> 
> 时间：2012-12-18T19:34:07.853
> 
> 标签：delphi, data-migration, devart

我正在尝试使用 CRBatchMove 使用 Delphi 2007 将旧数据库（MS Access）中的表导入 MySQL 服务器。

该程序通过 ODBC 连接从遗留数据库中获取数据，并使用 TADOTable.SaveToFile() 将其存储在本地硬盘驱动器上。程序的第二部分将该文件读入另一个 TADOTable 并使用 TCRBatchMove 将其传输到 MySQL 服务器（通过 DevArt 的 TMyTable）。在此过程中，由于某种原因，批处理移动似乎非常缓慢。

以下试验中的数据量约为 100,000 条记录，每条记录约 120 个字段。大多数字段是整数和 VARCHAR（每个 VARCHAR 小于 32 个字符）。

我得到的性能数据是：

```
Time taken to bring data to local file over ODBC connection: 17 seconds
Time taken to load data from local file into TADOTable: 3 seconds
Time taken by TCRBatchMove to move data from TADOTable to TMyTable: > 30 minutes 
```

MySQL 服务器在开发机器（i7-2.8GHz）上本地运行，否则数据库非常快速）。

为什么批量移动将数据推送到 MySQL 服务器这么慢。有没有办法加快这项任务？还是有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:36:13.380

不是一个真正的答案，但我的评论空间不足。

MySQL 有一个函数叫做`load data infile`
见：[http ://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

您可以使用它来计算插入数据的最快时间。这将为您提供 MySQL 插入时间的基线，并允许您确定延迟是在 MySQL 中还是在 Delphi 中。如果您有 TMyTable 的源代码，您也可以使用分析器。

另一种选择是在以下位置下载 ZEOS 数据访问组件：http:
[//sourceforge.net/projects/zeoslib/](http://sourceforge.net/projects/zeoslib/)
如果您使用的组件中有一些问题，则更改工具集可能会解决问题。（Devart 的组件通常都很出色）。

在 MySQL 方面，您可以在批量插入之前禁用索引更新并在之后启用索引。如果您有很多插入通常会更快。
请参阅：[https ://stackoverflow.com/a/9524988/650492](https://stackoverflow.com/a/9524988/650492)

```
SET autocommit=0; 
SET unique_checks=0; 
SET foreign_key_checks=0;

your insert here

SET autocommit=1; 
SET unique_checks=1; 
SET foreign_key_checks=1; 
```

# javascript - 在私有函数中调用这个（公共）函数

> ID：13940156
> 
> 赞同：0
> 
> 时间：2012-12-18T19:34:19.093
> 
> 标签：javascript

我有以下 javascript: ( [JSFiddle](http://jsfiddle.net/Mansfield/7XEYD/2/) )

```
$(function () {
    function Cat()
    {  
        this.Meow = function (sound) {
            alert("Meow: " + sound);
        }

        this.Kick = function () {
            MakeNoise();    
        }

        var MakeNoise = function () {
            Meow("noise");
            //Cat.Meow("noise");
            //self.Meow("noise");
            //this.Meow("noise");                      
        }        
    }

    var c = new Cat();
    c.Kick();
});​ 
```

当我调用该`Kick`函数时，我收到错误“未定义喵”（我在`MakeNoise`函数中尝试的四件事中的任何一件）。

我也尝试过这样的原型设计，但这给了我同样的错误：

```
Cat.prototype.Meow = function (sound) {
    return this.Meow(sound);    
} 
```

我确信这有一个非常简单的解决方案，但我不知道如何成功调用`Meow`“Cat”类的函数。我怎样才能做到这一点？

顺便说一句，这种架构是否有意义？我的意图是拥有`Kick`和`Meow`作为公共职能，并`MakeNoise`作为私人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:40:02.420

保存一个引用对象，以便您可以在`MakeNoise`函数中使用它。

```
$(function () {
    function Cat()
    {  
        var self = this;
        this.Meow = function (sound) {
            alert("Meow: " + sound);
        }

        this.Kick = function () {
            MakeNoise();    
        }

        var MakeNoise = function () {
            //Meow("noise");
            //Cat.Meow("noise");
            self.Meow("noise");
            //this.Meow("noise");                      
        }        
    }

    var c = new Cat();
    c.Kick();
});​ 
```

[http://jsfiddle.net/mowglisanu/7XEYD/3/](http://jsfiddle.net/mowglisanu/7XEYD/3/)

# c# - 如何在视图中返回搜索结果？

> ID：13940158
> 
> 赞同：1
> 
> 时间：2012-12-18T19:34:30.250
> 
> 标签：c#, asp.net-mvc, entity-framework, search

我正在使用 asp.net mvc4、simplemembership 和 EF。

实际上我有这个代码来搜索我的数据库中的用户。

家庭控制器：

```
 private UsersContext db = new UsersContext();

        public ActionResult Index(string searchUser)
        {
            var user = from m in db.UserProfiles
                       select m;

            if (!String.IsNullOrEmpty(searchUser))
            {
                user = user.Where(s => s.UserName.Contains(searchUser));
            }

            return View(user);
        } 
```

索引视图：

```
 <div id="searchUser">
            @using (Html.BeginForm("Index", "Home", FormMethod.Get))
            {   
                <p>
                    @Html.TextBox("searchUser")
                    <input type="submit" value="Chercher" />
                </p>     
            }
  </div>
             /********** PART 1 ***********/
        @{
            var db = new UsersContext();
            var list = db.UserProfiles.ToList();

            foreach (var item in list)
            {
                <table>
                    <tr>
                        <td>
                            @Html.DisplayFor(m => item.UserName)
                        </td>
                    </tr>
                </table>

            }
        } 
```

这里的第 1 部分已过时。而不是它，如果他存在，我想返回我搜索的用户的名称，否则我想显示一条消息说他不存在。

实际上，我的请求似乎有效，但视图中没有返回任何内容，有人知道我该如何解决这个问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:00:05.507

试试这样的，

在你的控制器上，你总是应该为你的视图返回相同的类型。

```
private UsersContext db = new UsersContext();

public ActionResult Index(string searchUser = "")
{
    IEnumerable<User> result;

    if (!String.IsNullOrEmpty(searchUser))
    {
        var userFound = (from m in db.UserProfiles
                   where m.UserName.Constains(searchUser)
                   select m).FirstOrDefault(); // to take the first user you have found, but it is still an List.

            result = new List<User>() { userFound };
    }
    else 
    {
        result = (from m in db.UserProfiles
                 select m).ToList();
    }

    return View(result); // return the type for your view
} 
```

并在 Action 上键入相同类型的视图并阅读它以显示表格...

```
// type your view with IEnumerable<User>
@model IEnumerable<User>

<div id="searchUserForm">
    @using (Html.BeginForm("Index", "Home", FormMethod.Get))
    {   
    <p>
        @Html.TextBox("searchUser")
        <input type="submit" value="Chercher" />
    </p>     
    }
</div>

@if (Model.Any()) // Model is an IEnumerable<User>
{
    <table>
        <tr>
            <th>UserName</th>
        </tr>   
    foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(m => item.UserName)
            </td>
        </tr>
    }
    </table>
}
else 
{
    <p> No users to display.</p>
} 
```

# javascript - 在ajax成功时重置所有字段（表单）

> ID：13940160
> 
> 赞同：0
> 
> 时间：2012-12-18T19:34:38.317
> 
> 标签：javascript, jquery, ajax

在 Ajax 成功后，我在尝试清除表单中的所有字段时遇到了麻烦。

这是代码：

```
$.ajax({
            type: "POST",
            url: "form.php",
            data: datos,
            success: function() {
                $('#nombre, #apellidos, #telefono, #asunto, #consulta, #email').val('')
            },
            error: function() {}
        }); 
```

除了清除表单上的字段外，它还有效。我收到了邮件，但没有清除表单的字段。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:38:26.913

您可以尝试使用[reset()](https://developer.mozilla.org/en-US/docs/DOM/form.reset)代替。

```
$('#myForm')[0].reset(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:47:55.477

根据您的描述，选择器是正确的。

这是一个 jsFiddle，显示选择器清除了几个字段。显然，我是在 document.ready 上做的，但同样适用于你的成功回调。

[jsFiddle](http://jsfiddle.net/9d8zh/)

```
$(document).ready(function(){
    $('#nombre,#apellidos,#telefono, #asunto, #consulta, #email').val('');
});
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T19:42:05.590

您能否验证这些 ID 是否已分配给表单字段？例子：

`<input id="email" />`

# java - 通过eclipse从PC上的*.txt文件中读取字符串

> ID：13940164
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:34:47.363
> 
> 标签：java, eclipse

我只想从存储在我的 PC 上的“my_file.txt”中读取整数。我通过的“paramString”是字符串“my_file.txt”。但是myReader.readLine ruturns NULL。不过myReader还是有一定价值的。其实我对FileInputStream或者DataInputStream的使用不是很熟悉……我只是想从我PC上存储的.txt文件中读取一些字符串或者整数。谢谢。

`FileInputStream fstream = new FileInputStream(paramString);`

```
 DataInputStream in = new DataInputStream(fstream);
 BufferedReader myReader = new BufferedReader(new InputStreamReader(in));
    int i = Integer.parseInt(myReader.readLine());` 
```

此外，在 bpn.BackpropagationNet.readConversionFile(BackpropagationNet .java:232) 在 bpn.BPN.main(BPN.java:72)"

已被eclipse报告。

再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:39:47.533

最好使用以下方法读取数据：

```
BufferedReader reader = new BufferedReader(new FileReader(paramString));
int i = Integer.parseInt(myReader.readLine()); 
```

不需要为此使用`DataInputStreamReader`，也不需要转换`Stream`为`Reader`，您可以直接创建阅读器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:38:50.020

由于它是 NumberFormatException 它的可能是因为

```
int i = Integer.parseInt(myReader.readLine()); 
```

线。如果您只是`System.out.println(myReader.readLine());`正确显示文件的行？

# javascript - 替换 dojo/dijit TabContainer 中特定选项卡的内容？

> ID：13940171
> 
> 赞同：1
> 
> 时间：2012-12-18T19:34:59.350
> 
> 标签：javascript, dojo

我需要更改其中一个选项卡的类 - 该面板将从子类`ContentPane`小部件更改为子类`BorderLayout`小部件。

至少我可以从中删除子`TabContainer`项，然后在该被破坏选项卡的位置插入一个具有相同选项卡标题的新子项。但是是否有一个合法的快捷方式来简单地*替换*支持控件而不使选项卡无效？

（Dojo 1.8 - 小部件的编程实例化）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:34:23.633

而不是通过`dijit/layout/ContentPane`将其添加为添加选项卡`dijit/layout/StackPane`。然后使用 StackPane 的方法`addChild(widget)`，`removeChild(widget)`和/或`selectChild(widget)`：

```
var tab1 = registry.byId("tab1"); // dijit/layout/StackContainer

var bc = new BorderContainer();
var cp1 = new ContentPane({
    content: "content pane 1",
    region: "top"        
});
var cp2 = new ContentPane({
    content: "content pane 2",
    region: "center"
});
bc.addChild(cp1);
bc.addChild(cp2);

tab1.addChild(bc);
tab1.selectChild(bc); 
```

在行动中看到它：http: [//jsfiddle.net/phusick/szCb4/](http://jsfiddle.net/phusick/szCb4/)

# php - 为什么我不能在类属性声明中做数学运算？

> ID：13940177
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:35:09.210
> 
> 标签：php, properties

[http://php.net/manual/en/language.oop5.properties.php](http://php.net/manual/en/language.oop5.properties.php)显示了以下示例，但对我来说失败了。

```
class SimpleClass{
   private $var3 = 1+2;
} 
```

`Parse error: syntax error, unexpected '+', expecting ',' or ';'....`

任何想法为什么？

php 版本 5.4.9

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:38:42.727

应该在构造函数中为属性添加默认值。在声明属性时添加默认值只是 PHP 中的一个非面向对象的事情，它使开发人员的生活更容易，但是 - 正如您所看到的 - 它还没有得到很好的支持。

解决方案：

```
class Foo
{
    private $var;

    public function __construct()
    {
        $this->var = 2 + 3
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:38:50.203

该文档从未声明它是有效的属性声明。它特别说明了它是一个*无效*的例子。

直接从您的链接

```
<?php
class SimpleClass
{
   // invalid property declarations:
   public $var1 = 'hello ' . 'world';
   public $var2 = <<<EOD
hello world
EOD;
   public $var3 = 1+2;
   public $var4 = self::myStaticMethod();
   public $var5 = $myVar;

   // valid property declarations:
   public $var6 = myConstant;
   public $var7 = array(true, false);

   // This is allowed only in PHP 5.3.0 and later.
   public $var8 = <<<'EOD'
hello world
EOD;
}
?> 
```

这就是为 PHP 定义语言语法的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:36:43.083

PHP 不支持计算值，即使从技术上讲这两个值在编译时都可以知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T19:37:15.957

只是因为你不能在 PHP 中。您不能在 PHP 中评估属性分配和声明。不知道为什么以这种方式实施。

# .net - 如何删除文件名大小写差异？

> ID：13940179
> 
> 赞同：1
> 
> 时间：2012-12-18T19:35:13.713
> 
> 标签：.net, vb.net, file-io, visual-studio-2012, filepath

我遇到了另一个障碍，需要一些帮助：在 Windows 中，像“A330 amu.jpg”这样的文件名与“a330 amu.jpg”完全相同。在 VB.NET 中，“A330 amu.jpg”与“a330 amu.jpg”不同。有没有办法在 VB.NET 中使 "A330 amu.jpg" = "a330 amu.jpg" 为真？我正在制作一个程序，该程序在程序的 cwd（当前工作目录）中使用 jpg 交叉引用文件夹路径。此外，这不是唯一存在此类差异的实例。还有很多。我也尝试了 str.Contains() 方法，但没有成功。基本上我需要能够像操作系统一样加载文件而不考虑大小写（不区分大小写）。Python 内置了这个。换句话说：我如何让 vb.net 遵守操作系统本身已经内置的文件系统规则？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:37:10.627

您需要指定一个字符串比较类型：

```
"Foo".Equals("foo", StringComparison.CurrentCultureIgnoreCase) 
```

如果您不确定如何在您的代码中使用它，请更新您的问题以包含您进行比较的代码示例。

# eclipse - 404 错误 Apache Tomcat 7 从 Eclipse Juno IDE 运行 JSP 文件

> ID：13940186
> 
> 赞同：0
> 
> 时间：2012-12-18T19:36:07.453
> 
> 标签：eclipse, jsp, tomcat

我在 Eclipse IDE 上使用 Tomcat 7 来运行 JSP 文件。

它在 2 天前工作正常，但现在当我运行我的文件时，出现 404 错误：

```
HTTP Status 404 - /

type Status report
message /
description The requested resource is not available.

Apache Tomcat/7.0.34 
```

我认为服务器工作正常，因为如果它没有响应，它不会给我错误。我用于 Tomcat 的端口是 8089。原因可能是 Eclipse 试图使用另一个端口而不是我为服务器设置的端口？

我该怎么做才能运行我的文件而不会出现此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-22T19:04:35.823

有时，当您测试 webapp 项目时，eclipse 不会将完整路径添加到您要访问的 JSP 页面并尝试连接到 http//localhost:8080/YOURPAGE.jsp，这是有问题的，因为上下文是失踪。

为什么你使用端口 8089 而不是 8080？

可能是tomcat server.xml中缺少上下文，你有类似这样的行吗？

```
<Context docBase="WebProject" path="/WebProject" reloadable="true" source="org.eclipse.jst.jee.server:LoginServlet"/></Host> 
```

# c# - 通过反射从简单类型转换为复杂类型

> ID：13940192
> 
> 赞同：1
> 
> 时间：2012-12-18T19:36:26.650
> 
> 标签：c#, .net, reflection, casting

在这种情况下，我正在研究从 Int32 转换为更复杂的类型。

以下是您如何通过正常方式获得这种复杂类型的实例：

```
OptionSetValue option = new OptionSetValue(90001111); //int value... 
```

现在，我正试图通过反射来做到这一点。这是我的方法：

```
 public static void SetValue(object entity, string propertyName, object value)
    {
        try
        {
            PropertyInfo pi = entity.GetType().GetProperty(propertyName);
            Type t = Nullable.GetUnderlyingType(pi.PropertyType) ?? pi.PropertyType;
            object safeValue = (value == null) ? null : Convert.ChangeType(value, t); //Line where the exception is thrown...
            pi.SetValue(entity, safeValue, null);

        }
        catch
        {
            throw;
        }

        return;
    } 
```

这是我使用它的方式：

```
SetValue(entity, "reason", 90001111); 
```

“原因”是 OptionSetValue 类型实体的属性。当像这样使用它时，在上面提到的行上，我会得到这个异常：

```
Invalid cast from 'System.Int32' to 'Microsoft.Xrm.Sdk.OptionSetValue'. 
```

是因为这两个属性来自不同的程序集吗？如果是这样，甚至有可能做我所追求的吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:43:59.510

我想你回答了你自己的问题。

> “原因”是 OptionSetValue 类型实体的属性

如果是这种情况，那么`pi.PropertyType`是`OptionSetValue`，并且

```
Type t = Nullable.GetUnderlyingType(pi.PropertyType) ?? pi.PropertyType; 
```

返回`OptionSetValue`。

无效演员表来自`Convert.ChangeType(value, t)`. 由于`OptionSetValue`尚未注册转换器，因此运行时不知道如何进行此转换。如果您有兴趣走这条路线，请参阅这篇 MSDN 文章，[了解如何注册。`TypeConverter`](http://msdn.microsoft.com/en-us/library/ayybcxe5.aspx)

请参阅 Eve 的使用`Activator.CreateInstance`来了解如何克服这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:42:59.760

您不能将整数转换为该类。请改用以下代码：

```
object safeValue = (value == null) ? null : Activator.CreateInstance(t, value); 
```

上面的代码所做的是创建一个新实例`OptionSetValue`并将您的值传递给它的构造函数。

# c++ - 编译器如何知道不从锁定/解锁内部优化语句？在 C++ 中使用 boost::spinlocks

> ID：13940193
> 
> 赞同：1
> 
> 时间：2012-12-18T19:36:27.897
> 
> 标签：c++, multithreading, boost, locking, compare-and-swap

从单独的线程调用具有两个重载`operator()`函数的类。请参阅下面代码中的//注释。

优化器是否知道不要`entryadd = mSpread * ENTRY_MULTIPLIER`超过`lock()`?

```
struct Algo1
{   
    boost::detail::spinlock mSpreadLock;

    Algo1() : mSpreadLock() {}

    //called from thread 1 
    inline void operator()(const indata &signal) 
    {
        if ( signal.action() == SEND )
        {
            double entryadd;
            mSpreadLock.lock();
            entryadd = mSpread * ENTRY_MULTIPLIER; //isnt it possible for compiler to optimize this before the lock? 
            mSpreadLock.unlock();
            FunctionCall(entryadd);
        }
    }

    //called from thread2
    inline void operator()(const indata2 &bospread) 
    {
        boost::detail::spinlock::scoped_lock mylock(mSpreadLock);
        mSpread = bospread.spread();
    }
} 
```

那这个呢？

```
{
    mSpreadLock.lock();
    double entryadd = mSpread * ENTRY_MULTIPLIER; 
    mSpreadLock.unlock();
{ 
```

我的定义会`entryadd`移到函数的顶部吗？

除非我错过了一些东西.. 似乎代码块中的锁定和解锁将不起作用。必须使用 scoped_lock。 `boost::detail::spinlock::scoped_lock mylock(mSpreadLock)`，它将在函数调用期间锁定。

当然我可以像这样破解它：（但效率较低）

```
inline void operator()(const indata &signal) 
{
    if ( signal.action() == SEND )
    {
        double entryadd;
        {
            boost::detail::spinlock::scoped_lock mylock(mSpreadLock);
            entryadd = mSpread * ENTRY_MULTIPLIER; 
        }
        FunctionCall(entryadd);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:46:18.637

锁定操作最终将使用执行某种原子操作的编译器内置函数。编译器知道这些操作不能被重新编码并且不会优化“过去”它们。一切都好。

# javascript - 将元数据标签添加到 jsTree 节点？

> ID：13940198
> 
> 赞同：0
> 
> 时间：2012-12-18T19:36:40.953
> 
> 标签：javascript, tags, jstree

我有一个已渲染的[jsTree](http://www.jstree.com/)，它是由 Java REST 端点的 JSON 生成的。

每个节点（大约有 5 个级别）都会有一些与之关联的标签。我将从 java 端点获取标签，但现在我正在尝试提出如何展示它的概念证明。

我希望标签显示在列表中，靠近每个节点，因为只有几个。我在看[jQuery Tag-it！](http://aehlke.github.com/tag-it/)作为一种可能性。标签将是只读的。

我怎样才能在每个节点旁边显示它们？我什至不知道从哪里开始...

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:25:24.777

不确定我是否理解正确，但如果您想显示“元数据标签”，您可以使用[jsTree 网格](https://github.com/deitch/jstree-grid)

# asp.net-mvc - 使用 PagedList 为 ASP MVC3 网站添加分页功能

> ID：13940203
> 
> 赞同：0
> 
> 时间：2012-12-18T19:36:54.497
> 
> 标签：asp.net-mvc, asp.net-mvc-3, pagedlist

我们网站的搜索功能之一返回的结果太多，无法处理一页，因此我尝试添加此处提供的分页功能：[https ://github.com/TroyGoode/PagedList](https://github.com/TroyGoode/PagedList)

该解决方案可以正确构建并且页面也将加载，但是当我尝试进行搜索时，页面的控制器/Index() 方法会抛出“NotSupportedException”：

```
The method 'Skip' is only supported for sorted input in LINQ to Entities. The method 'OrderBy' must be called before the method 'Skip'. 
```

引发此异常时，Visual Studio 2010 指向 return 语句。这只是我在 ASP MVC 中工作的第二天，因此欢迎提出任何建议。谢谢！

```
 case "name":
                //if no comma, do a combined search  by last name and by corporate name.
                searchString = searchString.ToUpper();

                var lastAgents =
                    db.Agent.OrderBy(s => s.LastName).Where(s => s.LastName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification).Include(a => a.SymetraNumberToAgentId);
                //end new code
                var corp2Agents =
                    db.Agent.OrderBy(s => s.CorporateName).Where(s => s.CorporateName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification);
                if ((corp2Agents.Count() == 0) & (lastAgents.Count() == 0)) ViewBag.ErrorMessage = "None found in search for Last Names and Companies beginning with " + search1;
                else ViewBag.Message = "Results of Last Name and Company Name search.  Found " + (corp2Agents.Count() + lastAgents.Count()).ToString();

                pageNumber = (page ?? 1);
                return View(lastAgents.Union(corp2Agents).ToPagedList(pageNumber, pageSize)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T14:38:44.820

尝试在控制器中添加 .OrderBy(s => s.sNumber) ，如下所示：

```
var lastAgents =
                    db.Agent.Where(s => s.LastName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification).Include(a => a.SymetraNumberToAgentId).OrderBy(s => s.sNumber);
                //end new code
                var corp2Agents =
                    db.Agent.Where(s => s.CorporateName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification).OrderBy(s => s.CorporateName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:00:51.837

花了很长时间，但我找到了答案。这两种说法

```
 var lastAgents =
                    db.Agent.OrderBy(s => s.LastName).Where(s => s.LastName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification).Include(a => a.SymetraNumberToAgentId);
                //end new code
                var corp2Agents =
                    db.Agent.OrderBy(s => s.CorporateName).Where(s => s.CorporateName.ToUpper().StartsWith(searchString)).Include(
                        a => a.AgentIdentification); 
```

包含 OrderBy，但是这在 Union 语句中也是必需的。最后的“return”语句如下：

```
return View((lastAgents.Union(corp2Agents)).OrderBy(s => s.sNumber).ToPagedList(pageNumber, pageSize)); 
```

# c++ - 是否存在两次包含相同标题实际上有帮助的情况？

> ID：13940205
> 
> 赞同：8
> 
> 时间：2012-12-18T19:37:01.547
> 
> 标签：c++, c

为我的 h/hpp 文件创建标头保护一直是我的标准做法，但我想知道，为什么甚至可以将同一文件包含两次？是否存在您实际上需要不受保护的标头的情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T19:40:06.377

“参数化”头文件可用于在 C 中模拟 C++ 风格的模板。在这种情况下，头文件将取决于许多宏（“模板参数”）。它将根据这些宏的实际“值”生成不同的代码。

因此，此类标头的典型用法是一系列“模板参数”宏定义，然后是`#include`指令，然后是另一个“模板参数”宏定义序列，然后是相同的`#include`，依此类推。

[https://stackoverflow.com/a/7186396/187690](https://stackoverflow.com/a/7186396/187690)

使用此技术时，您将看到没有任何包含保护的头文件或带有仅覆盖文件一部分的包含保护的头文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-18T19:39:05.250

像 Boost.PP 这样的东西通过多次包含标头来完成很多技巧。它本质上允许原始形式的循环。

此外，[X-Macros](https://en.wikipedia.org/wiki/X_Macro)被设计为包含多次。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-18T19:40:25.043

在 C 中：

```
#undef NDEBUG
#include <assert.h>

...code using active asserts...

#define NDEBUG
#include <assert.h>

...code using disabled asserts... 
```

冲洗并重复。C++ 中的类似物`<cassert>`改为使用标头。

因此，有时有理由两次包含标题。不经常，但有理由这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T19:40:12.787

像这样的情况很少见，当它们确实存在时，无论如何重新设计更适合。我能想到的一个是包含声明的标题：

```
//functions.h
virtual void foo();
virtual void goo();

//classes.h
class A : public Base
{
    #include "functions.h"
};

class B : public Base
{
    #include "functions.h"
}; 
```

如果包含警卫，这将不起作用`functions.h`，但话又说回来，这是非常尴尬的代码......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-22T10:45:30.527

想象一下，您正在为您的微型引擎编写自己的模板数组包装器（元素是指针），其中数组可以是：

*   动态或静态
*   索引/订单是否重要
*   您可以在数组外部或内部删除一个元素（不仅仅是从数组中删除）

所以有了这个，你可以创建一个类来处理所有这些，但它总是会检查我们能做什么或不能做什么。最好是创建单独的类，但是在这里我们在它们之间有很多相同的代码，你可以（如果不小心的话）要么在其中一个函数中出错，而且添加一个新函数会更慢。

所以最好是利用“参数化”头文件（如AnT所述）并简单地创建类

*   Cl_Array_Dy、Cl_Array_DyIn、Cl_Array_DyDel、Cl_Array_DyInDel
*   Cl_Array_St、Cl_Array_StIn、Cl_Array_StDel、Cl_Array_StInDel

代码示例：

// TestDfM.h

```
#ifndef TEST_DFM_H
#   define TEST_DFM_H

    // first we need to make sure neither of these is defined
#   ifdef Df_ARG1
#       undef Df_ARG1
#   endif
#   ifdef Cl_First
#       undef Cl_First
#   endif
#   ifdef Cl_Second
#       undef Cl_Second
#   endif
#   ifdef Df_FIRST
#       undef Df_FIRST
#   endif
#   ifdef Df_SECOND
#       undef Df_SECOND
#   endif
#   ifdef TEST_DF_H
#       undef TEST_DF_H
#   endif

    // we need this
#   define Df_FIRST 1
#   define Df_SECOND 2

    // first class creation
#   define Df_CLASS Df_FIRST
#   define Df_ARRAY Cl_First
#   include "TestDf.h"

    // cleanup (after 1st)
#   undef Df_CLASS
#   undef Df_ARRAY

    // second class creation
#   define Df_CLASS Df_SECOND
#   define Df_ARRAY Cl_Second
#   define Df_ARG1
#   include "TestDf.h"

    // cleanup (after 2st)
#   undef Df_CLASS
#   undef Df_ARRAY
#   undef Df_ARG1

    // so we theoretically cannot include TestDf.h anymore (anywhere)
#   define TEST_DF_H

#endif // TEST_DFM_H 
```

// TestDf.h

```
// nothing to do here if the main header for this was not included
// also we should only call this inside the main header
#if defined(TEST_DFM_H) && !defined(TEST_DF_H)
#   include "../Includes.h"

    class Df_ARRAY {
    public:
        int m_shared;

#   ifndef Df_ARG1
        Df_ARRAY(int in_shared=0) { m_shared= in_shared; }
        void f_info() { printf("out: %d\n", m_shared); }
#   else
        int m_x;
        Df_ARRAY(int in_shared=0, int in_x= 7) { m_shared= in_shared; m_x= in_x; }
        void f_info() { printf("out: %d [also has %d]\n", m_shared, m_x); }
#   endif

#   if Df_CLASS == Df_FIRST
        void f_class() { printf("1st\n"); }
#   elif Df_CLASS == Df_SECOND
        void f_class() { printf("2nd\n"); }
#   endif
    };

#endif // TEST_DFM_H 
```

// Main.cpp

```
#include "Array/TestDfM.h"

int main(int argc, char** argv) {
    Cl_First a(6);
    Cl_Second b(2);
    a.f_class(); // 1st
    b.f_class(); // 2nd
    a.f_info(); // out: 6
    b.f_info(); // out: 2 [also has 7]
    return 0; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-18T19:47:57.677

头文件只是在遇到时以文本形式包含在内。没有任何真正的理由不能多次包含它们。如果标头仅用于声明而没有定义（并且没有使用默认参数的模板声明），那么多次包含它们甚至没有任何问题。

这`<cassert>`就是多次包含文件的典型示例：您可以在一个翻译单元内更改宏的定义`NDEBUG`并获得不同的行为。`assert()`

现在拥有`include_once`一个只包含一次文件的东西并不像人们想象的那么简单。这是一个不清楚`foo.h`应该多久包含一次的示例：

```
#include_once "foo.h"
#include_once "./foo.h"
#include_once "bar/foo.h" 
```

假设`include_once`每个文件只包含一次，应该多久`foo.h`包含一次？所有三个文件都可以很容易地引用同一个物理文件，但这可能不容易看到，例如，因为一个是到另一个的链接。最好将控制权交给程序员如何控制它们最终被使用的频率。

# algorithm - DFS算法遍历

> ID：13940206
> 
> 赞同：6
> 
> 时间：2012-12-18T19:37:08.113
> 
> 标签：algorithm, graph, depth-first-search

![在此处输入图像描述](../Images/9356ee560160369bb8725712147cf1e0.png)

鉴于上图，带有堆栈的 DFS 遍历为我提供了以下路径...

1-2-3-4-5-6

上述路径有效吗？是否存在另一条路径？（我的教科书给了我 1-2-3-6-4-5）

我没有足够的代表在计算机科学堆栈上发布图像，所以我不得不求助于这里，不确定它是否合适；如果不是，我很乐意事后将其删除。

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:41:10.603

您已经列出了图的完全有效的 DFS 遍历，并且教科书为您提供了图的另一个完全合法的 DFS 遍历。同一个图可以有许多深度优先遍历（实际上，它们通常是指数级的），所以如果你没有得到与你的教科书相同的，那不是立即引起警报的原因。

以下是其他一些订购：

```
1 2 5 4 3 6
3 1 6 2 5 4
5 4 2 3 1 6
... 
```

但是，如果有一些关于应该如何访问节点的其他规则（例如，总是以升序或降序访问连接的节点），那么 DFS 搜索将始终产生相同的输出。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:31:41.633

您描述的输出不是路径，而是 DFS 访问节点的顺序。路径是节点列表，其中每个节点都连接到前一个节点和下一个节点。

DFS 遍历的输出也可以看作是 DFS 遍历树，在您的情况下对应于：

```
1 - 2 - 3 - 4 - 5
        |
        6 
```

教科书树是

```
1 - 2 - 3 - 6 
        |
        4 - 5 
```

您可以获得许多不同的 DFS 树，因为在您可以选择的每个点上，您都可以决定先去哪里。在您的示例中，您可以从节点 3 转到节点 4 或节点 6，不同的输出是由于不同的选择。

# php - PHP Move_uploaded_file() 或 ftp_put() 用于 2GB 以下的文件

> ID：13940222
> 
> 赞同：1
> 
> 时间：2012-12-18T19:37:42.650
> 
> 标签：php, file-upload, ftp

我将处理客户将用来上传原始图像/长pdf/等的大文件（最大2GB）。我在网上读到 PHP 不是最好的解决方案，但我不能让每个客户端都下载一个 FTP 程序，让我为他们创建一个用户名/目录，并给他们一个密码，只是为了上传一个文件。

我要问的是什么是更好、更快的功能，还是没关系？ftp_get() 或 move_uploaded_file() ？有没有更好的方法可以使用 PHP 完成此任务？

我在想，因为 ftp 是 ftp，所以 ftp_put 会更快、更可行，但我不确定这就是我问这个问题的原因。

感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:52:15.230

`move_uploaded_file()`上传文件后，您将始终必须使用。这是将文件从临时存储移动到您想要存储它的任何位置（通常是应用程序树中的 uploads/ 目录）。

`ftp_put()`是将该文件再次移出站点到另一个 FTP 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:56:25.573

这不是同一份工作。

第一种情况，您的用户将文件直接上传到您的服务器，然后您使用`move_uploaded_file`.

![在此处输入图像描述](../Images/362d1bf616126b90fc4142e9e0f832d4.png)

*   优点：用户不需要事先在 ftp 服务器上发送文件。
*   缺点：您与通常连接速度较慢的用户直接相关，这要求您允许非常长的连接，这可能是危险的。

第二种情况，您的用户将文件上传到为此类上传而构建的 FTP 服务器。然后，您将下载一个通常位于具有良好带宽和上传速度的远程服务器上的文件。

![在此处输入图像描述](../Images/4ed888d49e414c40d1dafcd01b47ead8.png)

*   优点：你不需要配置你的网络服务器来处理很长的连接和很大的输入，这对安全性更好。下载通常会更快，因此用户会觉得您的服务没有那么慢。
*   缺点：您的用户需要将文件发送到 ftp，这对于甚至不知道它是什么的人来说不是很方便。

更好的解决方案应该是根据文件的大小提供这两个选项。

![在此处输入图像描述](../Images/db641c88ebcd95ebe9820aa256d423cc.png)

而且你把你的 FTP 和 web 的服务器放在同一个服务器上，这样你就可以直接在文件系统中访问文件，而不用`ftp_get`，这应该会更快。

# python - win32api.GetUserNameEx() 转换为 .exe 时不起作用

> ID：13940223
> 
> 赞同：1
> 
> 时间：2012-12-18T19:37:44.977
> 
> 标签：python

为什么当我使用 py2exe 将其转换为 exe 时此代码不起作用？

```
import os,win32api,win32con

user = win32api.GetUserNameEx (win32con.NameSamCompatible)
print user
os.system("PAUSE") 
```

也许我只是在这里遗漏了一些非常明显的东西，但我不明白。

编辑：有人回答了这个问题，效果很好，但不知何故他的帖子被删除了。我只想说... 非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T15:50:20.243

此代码应该可以工作：

```
import os
username=os.getenv('username')
print 
```

# php - curl 请求标头信息而不是页面的内容

> ID：13940228
> 
> 赞同：0
> 
> 时间：2012-12-18T19:38:11.033
> 
> 标签：php, curl, http-headers

我正在编写一个脚本，它将使用 cURL 来检查多个链接。我知道我可以`curl_getinfo()`用来获取 http 状态代码，但我不确定它是请求整个页面还是只请求带有标题的响应。是否有任何 curl 选项或设置可用于仅请求 URL 的标头（即 404 未找到、移动等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:52:00.060

`CURLOPT_NOBODY`您可以通过将选项设置为来指示 cURL 不下载请求的内容（正文）`TRUE`- 请参阅 [CURLOPT_NOBODY 是否仍然下载正文 - 使用带宽](https://stackoverflow.com/questions/3834143/does-curlopt-nobody-still-download-the-body-using-bandwidth)

ps`curl_getinfo()`不发出请求——它从已经执行的请求中获取信息。

# javascript - JavaScript：更长的键会使对象查找变慢吗？

> ID：13940244
> 
> 赞同：7
> 
> 时间：2012-12-18T19:38:52.870
> 
> 标签：javascript, performance, object

问题标题几乎说明了一切：更长的键是否会导致查找速度变慢？是：

```
someObj["abcdefghijklmnopqrstuv"] 
```

慢于：

```
someObj["a"] 
```

另一个子问题是字符串中用作键的字符类型是否重要。字母数字键串更快吗？

我试图做一些研究；网上似乎没有太多关于这个的信息。任何帮助/见解将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:40:27.337

一般来说没有。在大多数语言中，字符串文字是“**实习**的”，它对它们进行散列并使其查找速度更快。一般来说，不同的 javascript 引擎之间可能存在一些差异，但总的来说，如果它们实施得很好（*咳嗽*IE*咳嗽*），它应该是相当平等的。尤其是由于 javascript 引擎在*不断*开发，这（可能）是一件容易优化的事情，并且随着时间的推移情况会有所改善。

然而，一些引擎也限制了被保留的字符串的长度。YMMV 在不同的浏览器上。我们还可以从 jsperf 测试中看到一些见解（在问题的评论中链接）。Firefox 显然做了更积极的实习。

至于字符的类型，无论字符集如何，字符串都被视为一堆字节，因此这可能也无关紧要。引擎*可能会*优化[可以以点表示法使用的键，](http://mothereff.in/js-properties)但我没有任何证据证明这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-18T19:52:25.917

如果我们谈论使用 V8 javascript 引擎的 Chrome，性能是相同的。根据 V8 设计规范，您可以从“[快速属性访问](https://developers.google.com/v8/design#prop_access)”和“[动态机器代码生成](https://developers.google.com/v8/design#mach_code)”中看到，最终这些**键最终被编译为任何其他 c++ 类变量**。

# jpa - JPA 标准 API - 与 Spring Data JPA 规范中的列表匹配

> ID：13940249
> 
> 赞同：25
> 
> 时间：2012-12-18T19:39:07.273
> 
> 标签：jpa, criteria-api, spring-data

我想创建一个将用户对象的组 id 与 id 列表匹配的规范。我正在考虑使用 isMember （就像在代码中一样），但该方法不会占用列表。

```
public static Specification<User> matchCompanyIdsList(final List<Long> groupIds){
  return new Specification<User>() {
    public Predicate toPredicate(Root<User> root, CriteriaQuery<?> query, CriteriaBuilder builder){
      final Path<Group> group = root.<Group> get("group");
      return builder.isMember(company.<Long>get("id"), companyIds);
    }
  };
} 
```

如果我离开了，否则我该怎么办？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-19T08:57:41.940

您是否要创建一个规范来匹配所有具有组 ID 的用户，这些用户位于 groupsIds 列表中？

如果是这样，你可以使用这样的东西（这将使用 SQL IN 子句）：

```
public static Specification<User> matchCompanyIdsList(final List<Long> groupIds){
    return new Specification<User>() {
        public Predicate toPredicate(Root<User> root, CriteriaQuery<?> query, CriteriaBuilder builder){
            final Path<Group> group = root.<Group> get("group");
            return group.in(groupIds);
        }
    };
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-21T20:49:07.100

使用 org.hibernate.jpamodelgen.JPAMetaModelEntityProcessor 生成下划线类的 Lamba 方式

```
 static Specification<User> hasRoles(List<String> roles) {
        return (root, query, cb) -> { 
            query.distinct(true);
             Join<User, Account> joinUserAccount = root.join(User_.account);
             Join<Account, AccountRole> acctRolesJoin = joinUserAccount.join(Account_.accountRoles);
             Join<AccountRole, Role> rolesJoin = acctRolesJoin.join(AccountRole_.role);

             return rolesJoin.get(Role_.name).in(roles);
        };
    } 
```

# jquery - 带有多个切换触发器的表需要由一个 jQuery 控制

> ID：13940254
> 
> 赞同：0
> 
> 时间：2012-12-18T19:39:22.780
> 
> 标签：jquery, triggers, html-table, toggle, show-hide

我有一个我正在 ASP.NET 中处理的表，其中每个主行都有 2 个隐藏行，这些行用于在文本框中添加评论或使用第二个隐藏行中的列表框来使用预先制作的评论填充文本框。将有未知数量的行，因为它基于我们数据库中每个客户端的数据。在主行的最后一列中有一个图像，它是单击触发器，用于显示隐藏在其后面的行。由于某种原因，我正在使用的 click evt 无法正常工作。任何帮助都会很棒。

注意：我还使用 for 循环来计算我的点击事件发生的位置，当表格完成时，for 循环将从后面的代码中的计数器运行，因此“<= 7”仅用于测试目的。

HTML：

```
 <table id="mfCriteriaTable">
                <tr class="whiteBack mfTableBorder">
                    <td class="mfRightCol showCell" width="140px" align="left">Category</td>
                    <td class="colOne" width="600px" align="left">Criteria for achieving this element of service quality is listed here. Additional Detail click info</td>
                    <td width="50px" align="center"><asp:RadioButton ID="mfScoreRad1" runat="server" /></td>
                    <td width="50px" align="center"><asp:CheckBox ID="mfNA1" runat="server" /></td>
                    <td width="50px" align="center"><asp:CheckBox ID="mfND1" runat="server" /></td> 
                    <td width="75px" align="center"><a href="#" id="mfComments1"><img src="Images/blue_info_tag.png" alt="" /></a></td>
                </tr>
                <tr class="whiteBack" id="commentRow1" style="display:none;"><td colspan="6" id="tdComment1" height="30px"><asp:TextBox ID="txtComments1" CssClass="mfTextComments" runat="server" TextMode="MultiLine"></asp:TextBox></td></tr>
                <tr class="whiteBack" id="slTableComments1" style="display:none;">
                     <td colspan="6" height="30px">
                        <asp:ListBox ID="lbComments1" runat="server" Height="20px" ToolTip="Please select a comment from this list or create your own in the text area above.">
                            <asp:ListItem Value="Comment 1">This is where comment number one will be, this is a longer comment just to see how it will all fit together.</asp:ListItem>
                            <asp:ListItem Value="Comment 2">This is a 2nd comment that is a bit shorter but shows usability. </asp:ListItem>
                            <asp:ListItem Value="Comment 3">And this is a 3rd comment so you are almost done.</asp:ListItem>
                        </asp:ListBox>
                    </td> 
                </tr>
                <tr class="whiteBack mfTableBorder">
                    <td class="mfRightCol showCell" width="140px" align="left">Category</td>
                    <td class="colOne" width="600px" align="left">Criteria for achieving this element of service quality is listed here. Additional Detail click info</td>
                    <td width="50px" align="center"><asp:RadioButton ID="mfScoreRad2" runat="server" /></td>
                    <td width="50px" align="center"><asp:CheckBox ID="mfNA2" runat="server" /></td>
                    <td width="50px" align="center"><asp:CheckBox ID="mfND2" runat="server" /></td> 
                    <td width="75px" align="center"><a href="#" id="mfComments2"><img src="Images/blue_info_tag.png" alt="" /></a></td>
                </tr>
                <tr class="whiteBack" id="commentRow2" style="display:none;"><td colspan="6" id="tdComment2" height="30px"><asp:TextBox ID="txtComments2" CssClass="mfTextComments" runat="server" TextMode="MultiLine"></asp:TextBox></td></tr>
                <tr class="whiteBack" id="slTableComments2" style="display:none;">
                     <td colspan="6" height="30px">
                        <asp:ListBox ID="lbComments2" runat="server" Height="20px" ToolTip="Please select a comment from this list or create your own in the text area above.">
                            <asp:ListItem Value="Comment 1">This is where comment number one will be, this is a longer comment just to see how it will all fit together.</asp:ListItem>
                            <asp:ListItem Value="Comment 2">This is a 2nd comment that is a bit shorter but shows usability. </asp:ListItem>
                            <asp:ListItem Value="Comment 3">And this is a 3rd comment so you are almost done.</asp:ListItem>
                        </asp:ListBox>
                    </td> 
                </tr>
            </table> 
```

Javascript：

```
 function assignClickHandlerFor(num) {

            window.console && console.log('#mfComments' + num);
            $('#mfComments' + num).click(function (evt) {
                evt.preventDefault();
                evt.stopPropagation();

                var $aBox = $(evt.currentTarget); 

                $aBox.find('tr#commentRow' + num).toggle;
                $aBox.find('tr#slTableComments' + num).toggle;
            });
    }

    var i;

    for (i = 1; i <= 7; i++) {
        assignClickHandlerFor(i);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T19:59:51.663

为了使选择更容易，请提供所有可点击的图像`class="mfComments"`，然后：

```
$(function() {
    $('.mfComments').click(function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).closest("tr").next("tr").next("tr").andSelf().toggle();
    });
}); 
```

我不确定循环计数器业务。我不明白它应该达到什么目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:52:54.127

`toggle`是一种方法，因此需要`()`它。此外，**在**元素内`find`查找。您不想查看您的.**`td`**

 **```
$('tr#commentRow' + num).toggle();
$('tr#slTableComments' + num).toggle(); 
```

您也可以考虑在这些元素上放置类，然后使用`closest`, `prev`,`next`等来定位适当的元素，而不是这种递增`id`s 的方法。这将需要重新编写，但可能会更干净一些。**

# c# - 一次性处理 Linq 组

> ID：13940256
> 
> 赞同：0
> 
> 时间：2012-12-18T19:39:28.283
> 
> 标签：c#, .net, vb.net, linq

假设我有一个带有公共子对象的自定义对象，看起来像这样：

```
Public Class MyObject
   Public Function ReturnData(StartDate as Date, InputData as List(of string)) As List(Of String)
End Class 
```

然后有另一个看起来像这样的自定义对象：

```
Public Class HoldingObject
   Public MyDate as Date
   Public MyInfo as String
End Class 
```

现在，在另一个班级，我有以下内容：

```
Dim DataList as List(of HoldingObject)
Dim WorkingClass as New MyObject

Datalist looking as follows:
MyDate:         MyInfo:
1/1/2012        a
1/2/2012        b
1/2/2012        c
1/2/2012        d
1/1/2012        e
1/2/2012        f
1/2/2012        g
1/2/2012        h
1/3/2012        i
1/3/2012        j
1/3/2012        k
1/1/2012        l
1/1/2012        m 
```

* * *

我想做的是编写某种 Linq 语句，它会：

1.  按日期分组`Datalist`列表（将是 3 个分组输入 - 2012 年 1 月 1 日；2012 年 1 月 2 日；2012 年 1 月 3 日）
2.  提交每个组`WorkingClass.ReturnData`作为输入并获取返回值

我怎么能通过 Linq / Lambdas 或您认为是最佳编程实践的任何其他方式来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T19:47:30.117

实际上我现在不能自己测试它，但它应该可以工作：

```
Dim result = (From i In DataList
             Group i By date = i.MyDate Into g
             Select WorkingClass.ReturnData(date, g.Select(Function(gi) gi.MyInfo).ToList())).ToList() 
```

# php - 如何从一系列序列号中获取并在溢出后翻转

> ID：13940262
> 
> 赞同：0
> 
> 时间：2012-12-18T19:40:01.330
> 
> 标签：php, mysql

我需要为每笔交易设置一个唯一的号码，范围为 1-99，说，

*   事务1：seq_num = 1；
*   事务2：seq_num = 2；
*   ...
*   交易99：seq_num = 99；
*   事务 100：seq_num = 1；（滚下）

我正在考虑创建一个名为 SEQ_NUM 的 MySQL 表，其中只有一个名为 'id' 的字段，所以每次，我都可以运行以下 sql，

```
Update SEQ_NUM set id = id + 1; 
```

要获得一个 seq_num，如果 seq_num = 100，那么我将设置 seq_num =1 并运行另一个 sql 将 id 重置为，

```
Update SEQ_NUM set id = 1; 
```

但我不确定它是否能保证工作，因为可能有多个事务同时运行，并且在我运行之前

```
Update SEQ_NUM set id = 1; 
```

可能有另一个事务要求一个序列号，并且 101 将被返回。

任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:52:55.533

我认为模数运算符在这里很有用。也许你的基本想法会起作用，但允许 SEQ_NUM 无限增长，当你选择它作为你的序列号时，将它包装在 MOD() 中。

但实际上，我想知道您是否已经有一个可以以这种方式使用的唯一且自动递增的 ID 列（即`SELECT MOD(id, 99) as trans_seq`）...

# visual-studio-2010 - 角色实例的启动时间比预期的要长 - 找不到解决方案是错误吗？

> ID：13940264
> 
> 赞同：1
> 
> 时间：2012-12-18T19:40:07.487
> 
> 标签：visual-studio-2010, debugging, azure, instances, webrole

我看过这篇文章：[角色实例的启动时间比预期的要长 - 这个问题有新的解决方案吗？](https://stackoverflow.com/questions/7051153/role-instances-are-taking-longer-than-expected-to-start-is-there-a-new-solutio)

但是我找不到为什么我收到这个错误的答案，模拟器上周工作正常，但今天我发现它不工作我多次重新启动我的 PC 和 VS，并一直对对话框说是，但没有任何效果，我也尝试了帖子的解决方案，对我没有任何效果，我也删除了最近添加的代码，它仍然是一样的。

我已经开始了一个新项目并尝试调试不成功，所以我可以肯定地说这不是代码问题。

# python - 查看元组中的数字

> ID：13940269
> 
> 赞同：0
> 
> 时间：2012-12-18T19:40:19.397
> 
> 标签：python

现在我的功能没有将列表 coeff 中的数字识别为数字。我正在尝试将两个列表中的项目配对，然后根据 mul 的值将它们排序到不同的列表中。但一切都进入负面清单。我如何确保将 mul 视为进入每个 if 语句的数字。

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive=[]
  negative=[]
  for (mul,el) in data:
    if mul<0:
        negative.append((el,mul))
    if mul>0:
        positive.append((el,mul)) 
```

编辑; 我要最初包括这个 balance_equation(['H2O','A2'],['6','-4'])

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:44:30.710

嗯，第一个问题是你的函数只是返回`None`，只是扔掉了两个列表，所以甚至没有办法看到它是否在做正确的事情。

如果你解决了这个问题，你会发现它*正在*做正确的事情。

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive=[]
  negative=[]
  for (mul,el) in data:
    if mul<0:
        negative.append((el,mul))
    if mul>0:
        positive.append((el,mul))
  return negative, positive

>>> n, p = balance_equation(balance_equation('abcdef', range(-3,3))
>>> n
[('a', -3), ('b', -2), ('c', -1)]
>>> p
[('e', 1), ('f', 2)] 
```

所以，有两种可能：

1.  由于您粘贴的代码显然不是您正在运行的实际代码，因此您可能在重写该错误以将其发布到此处时修复了该错误。
2.  你不是用合理的输入来调用它。例如，如果你向后传递参数，因为`species`可能是字符串的集合，它们最终都会是正数。或者，同样，如果您将系数作为整数的字符串表示形式传递。

如果这是最后一个问题——你正在传递，比如说，`'abcdef', ['-3', '-2', '-1', '0', '1', '2', '3']`并且你想在 balance_equation 中而不是在调用代码中处理它，那很容易。只需在以下内容之前添加此行`zip`：

```
coeff = [int(x) for x in coeff] 
```

或更改`zip`为：

```
data = zip((int(x) for x in coeff), species) 
```

顺便说一句，我假设您使用的是 CPython 2。在 Python 3 中，尝试将字符串与 0 进行比较会引发 a`TypeError`而不是总是返回`True`，而在其他 Python 2 实现中它可能总是返回`False`而不是`True`......</p >

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:52:12.097

你的问题是，在你称之为（`balance_equation(['H2O','A2'],['6','-4'])`）的方式中，它`mul`是一个字符串而不是一个 int（`'6'`或`'-4'`而不是`6`或`-4`）。将您的 if 语句更改为：

```
if int(mul)<0:
    negative.append((el,mul))
if int(mul)>0:
    positive.append((el,mul)) 
```

这`mul`在将其与 0 比较之前转换为整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:50:18.733

我想你有你的答案，但在 Python 中还有一种更简单的方法：

```
for (mul, el) in data:
    append_to = negative.append if mul < 0 else positive.append
    append_to(el) 
```

`0`虽然不确定“应该发生”什么

# python - Python：json.loads 返回以 'u' 为前缀的项目

> ID：13940272
> 
> 赞同：171
> 
> 时间：2012-12-18T19:40:28.163
> 
> 标签：python, json

我将收到来自 Obj-C 的 JSON 编码字符串，并且我正在解码一个虚拟字符串（目前），如下面的代码。我的输出以字符 'u' 为每个项目的前缀：

```
[{u'i': u'imap.gmail.com', u'p': u'aaaa'}, {u'i': u'333imap.com', u'p': u'bbbb'}... 
```

JSON如何添加这个unicode char？删除它的最佳方法是什么？

```
mail_accounts = []
da = {}
try:
    s = '[{"i":"imap.gmail.com","p":"aaaa"},{"i":"imap.aol.com","p":"bbbb"},{"i":"333imap.com","p":"ccccc"},{"i":"444ap.gmail.com","p":"ddddd"},{"i":"555imap.gmail.com","p":"eee"}]'
    jdata = json.loads(s)
    for d in jdata:
        for key, value in d.iteritems():
            if key not in da:
                da[key] = value
            else:
                da = {}
                da[key] = value
        mail_accounts.append(da)
except Exception, err:
    sys.stderr.write('Exception Error: %s' % str(err))

print mail_accounts 
```

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-12-18T19:44:46.197

u- 前缀仅仅意味着你有一个 Unicode 字符串。当您真正使用该字符串时，它不会出现在您的数据中。不要被打印输出抛出。

例如，试试这个：

```
print mail_accounts[0]["i"] 
```

你不会看到你。

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2012-12-18T19:45:07.757

一切都很酷，伙计。'u' 是个好东西，它表示字符串在 python 2.x 中是 Unicode 类型。

[http://docs.python.org/2/howto/unicode.html#the-unicode-type](http://docs.python.org/2/howto/unicode.html#the-unicode-type)

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2015-12-27T10:56:42.800

下面的**`d3`**印刷品是您正在寻找的印刷品（它是转储和装载的组合）:)

**有：**

```
import json

d = """{"Aa": 1, "BB": "blabla", "cc": "False"}"""

d1 = json.loads(d)              # Produces a dictionary out of the given string
d2 = json.dumps(d)              # Produces a string out of a given dict or string
d3 = json.dumps(json.loads(d))  # 'dumps' gets the dict from 'loads' this time

print "d1:  " + str(d1)
print "d2:  " + d2
print "d3:  " + d3 
```

**印刷：**

```
d1:  {u'Aa': 1, u'cc': u'False', u'BB': u'blabla'}
d2:  "{\"Aa\": 1, \"BB\": \"blabla\", \"cc\": \"False\"}"
d3:  {"Aa": 1, "cc": "False", "BB": "blabla"} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-18T19:46:20.023

Unicode 在这里是合适的类型。JSONDecoder 文档描述了 json 字符串对象被解码为 Unicode 对象的转换表和状态

[https://docs.python.org/2/library/json.html#encoders-and-decoders](https://docs.python.org/2/library/json.html#encoders-and-decoders)

```
JSON                    Python
==================================
object                  dict
array                   list
string                  unicode
number (int)            int, long
number (real)           float
true                    True
false                   False
null                    None 
```

“encoding 确定用于解释此实例解码的任何 str 对象的编码（默认为 UTF-8）。”

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-06-30T05:29:01.307

附加到对象的那些“u”字符表示该对象以“unicode”编码。

如果你想从你的对象中删除那些 'u' 字符，你可以这样做：

```
import json, ast
jdata = ast.literal_eval(json.dumps(jdata)) # Removing uni-code chars 
```

让我们从 python shell 结帐

```
>>> import json, ast
>>> jdata = [{u'i': u'imap.gmail.com', u'p': u'aaaa'}, {u'i': u'333imap.com', u'p': u'bbbb'}]
>>> jdata = ast.literal_eval(json.dumps(jdata))
>>> jdata
[{'i': 'imap.gmail.com', 'p': 'aaaa'}, {'i': '333imap.com', 'p': 'bbbb'}] 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-12-18T19:45:31.423

`u`前缀意味着这些字符串是 unicode 而不是 8 位字符串。不显示`u`前缀的最佳方法是切换到 Python 3，其中字符串默认为 unicode。如果这不是一个选项，`str`构造函数将从 unicode 转换为 8 位，因此只需在结果上递归循环并转换`unicode`为`str`. 但是，最好将字符串保留为 unicode。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-08-15T12:18:12.347

在尝试使用 Python`logging`库捕获日志中的 JSON 数据以进行调试和故障排除时，我一直遇到这个问题。`u`当您想要复制文本并将其粘贴到代码中的某个位置时，获取字符是一件非常麻烦的事情。

`json.loads()`正如每个人都会告诉你的那样，这是因为它是一种 Unicode 表示，它可能来自于你曾经从一开始就从字符串加载数据的事实。

如果您想在日志中使用 JSON 表示，不带`u`前缀，诀窍是在将`json.dumps()`其注销之前使用。例如：

```
import json
import logging

# Prepare the data
json_data = json.loads('{"key": "value"}')

# Log normally and get the Unicode indicator
logging.warning('data: {}'.format(json_data))
>>> WARNING:root:data: {u'key': u'value'}

# Dump to a string before logging and get clean output!
logging.warning('data: {}'.format(json.dumps(json_data)))
>>> WARNING:root:data: {'key': 'value'} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-01-22T09:27:54.193

试试这个：

mail_accounts[0].encode("ascii")

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2019-10-10T01:12:26.573

只需将 u' 替换为单引号...

```
print (str.replace(mail_accounts,"u'","'")) 
```

# php - 图片上传 API XML（仅允许在文档开头声明）

> ID：13940273
> 
> 赞同：4
> 
> 时间：2012-12-18T19:40:35.520
> 
> 标签：php, xml, image, upload

我的问题是 PHP 和 XML 问题，我和朋友一起处理图像上传 api，我们在创建 XML 字符串时遇到了问题。

图像.php：

```
$simage = new SimpleImage();
    $xml = new SimpleXMLElement('<bb-upload></bb-upload>');
    if($key == get_key()){
        require 'upload.php';
    }
    else{
        $xml->addChild('error', "102 Fehlerhafter Zugriffs Key");
    }
    header("Content-type:text/xml;charset=utf-8");
    echo $xml->asXML(); 
```

上传.php：

```
if ($_FILES["image"]["error"] > 0) {
$xml->addChild('error', "101 Bilder fehler: " . $_FILES["image"]["error"]);
}
else{
  $data = array(
        'tmp'   => $_FILES["image"]["tmp_name"],
        'save'  => time().'-'.rand(1, 1000).'.jpg',
    );

    $filename = $data['save'];

    $simage->load($data['tmp']);
    $simage->resize(350,300);
    $simage->save("../data/$filename");

    $xml->addChild('error', "0");
    $xml->addChild('src', "http://*******.de/bb-image/data/$filename");
} 
```

问题是如果我们在 XML 上连接一切都可以，但是如果我们上传图片，我们就会变成这样`error: error on line 1 at column 6: XML declaration allowed only at the start of the document`

和这样的输出：

```
?<?xml version="1.0"?>
<bb-upload><error>0</error><src>http://*****.de/bb-image/data/1355858033-712.jpg</src>     </bb-upload> 
```

为什么是一个？在代码中！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:17:02.667

您可能在 XML 文档的开头之前有一些字符。

这通常会导致错误。

在十六进制查看器中打开脚本，这通常会在编辑器中显示通常不可见的字符。删除这些，例如保存没有 BOM 的 PHP 文件（无论如何你都应该这样做）。

# objective-c - UIScrollView 不滚动偏移内容

> ID：13940277
> 
> 赞同：0
> 
> 时间：2012-12-18T19:40:42.277
> 
> 标签：objective-c, uiscrollview, xcode4.5

我有一个带有以下参数的 UIScrollView：

```
[scrollView setPagingEnabled:YES];
[scrollView setContentSize:CGSizeMake(1024 * 2, 768)];
[scrollView setShowsHorizontalScrollIndicator:NO];
[scrollView setShowsVerticalScrollIndicator:NO];
[scrollView setScrollEnabled:NO];
[scrollView setDelegate:self]; 
```

换页：

```
CGRect frame = scrollViewPages.frame;
frame.origin.x = 1024;
[scrollViewPages scrollRectToVisible:frame animated:YES]; 
```

所以这个滚动视图有一个显示内容的双区域。在第一个矩形中，触摸有效，但是当我更改为具有不同大小的其他组件的另一段时，触摸事件不起作用。我读过 UIScrollView 不会将触摸事件应用于隐藏部分。我想知道如何更新视图以获取触摸交互。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:34:47.223

更新：我正在将 UIViews 添加到 UIScrollView 内的另一个 UIVIew 中。现在它可以工作了

# c# - 当子实体有多个路径时如何生成对象？

> ID：13940278
> 
> 赞同：5
> 
> 时间：2012-12-18T19:40:44.070
> 
> 标签：c#, autofixture

我正在开发一个具有与此类似的域模型的应用程序，其中 a`LineItem`既可以从 an`Order`也可以从`Shipment`.

![图表](../Images/37788a640587a0fec7d6eb89c3b83b74.png)

如果我使用 AutoFixture 来生成，我怎样才能对和`Order`使用相同的集合？`LineItems``order.LineItems``order.Shipments*.ItemShipments*.LineItem`

理论上，应该通过以下测试：

```
var fullyShippedOrder = fixture.CreateAnonymous<Order>();
var shippedLineItems = fullyShippedOrder.Shipments
    .SelectMany(o => o.ItemShipment, (s, i) => i.LineItem)
    .Distinct();
Assert.EqualCollection(fullyShippedOrder.LineItems, shippedLineItems); 
```

...虽然我也希望能够根据测试生成部分发货的订单。

（有一个可靠的论点是 Order 上的 line item 和 Shipment 上的 line item 是不同的东西，我不应该使用同一个类来表示它们。但是，我正在使用的数据来自遗留系统，对此无能为力。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T09:52:37.713

正如您所说，您在测试中遇到的摩擦很可能是域模型中设计问题的标志。理想情况下，您应该[*听取您的测试*](http://www.growing-object-oriented-software.com/)并从根本上解决问题。但是，鉴于在这种情况下不可行，这里有一个解决方法。

您可以使用该方法将其配置为始终按固定顺序`Fixture`返回对象。`LineItem``Register<T>(Func<T> creator)`

这是一个打包在自定义项中的示例：

```
public class GenerateLineItemFromFixedSequence : ICustomization
{
    public void Customize(IFixture fixture)
    {
        var items = CreateFixedLineItemSequence(fixture);
        fixture.Register(() => GetRandomElementInSequence(items));
    }

    private static IEnumerable<LineItem> CreateFixedLineItemSequence(IFixture fixture)
    {
        return fixture.CreateAnonymous<LineItem[]>();
    }

    private static LineItem GetRandomElementInSequence(IEnumerable<LineItem> items)
    {
        var randomIndex = new Random().Next(0, items.Count());
        return items.ElementAt(randomIndex);
    }
} 
```

为了在测试的上下文中应用此行为，只需将自定义添加到`Fixture`对象：

```
fixture.Customize(new GenerateLineItemFromFixedSequence()); 
```

同样，您可以创建其他自定义项，以生成`LineItem`处于不同状态的对象的固定序列，例如您提到的部分发货的订单，并在不同的测试中使用它们。

### 观察

有趣的是，这种定制可以是通用的，因为算法本身并没有与正在创建的对象的类型相耦合。这将有效地*将其转化为一种[战略](http://sourcemaking.com/design_patterns/strategy)*。

因此，通过引入通用参数来修改自定义：

```
public class GenerateFromFixedSequence<T> : ICustomization
{
    public void Customize(IFixture fixture)
    {
        var items = CreateFixedSequence(fixture);
        fixture.Register(() => GetRandomElementInSequence(items));
    }

    private static IEnumerable<T> CreateFixedSequence(IFixture fixture)
    {
        return fixture.CreateAnonymous<T[]>();
    }

    private static T GetRandomElementInSequence(IEnumerable<T> items)
    {
        var randomIndex = new Random().Next(0, items.Count());
        return items.ElementAt(randomIndex);
    }
} 
```

将允许您将其用于不同的对象：

```
fixture.Customize(new GenerateFromFixedSequence<LineItem>());
fixture.Customize(new GenerateFromFixedSequence<Order>());
fixture.Customize(new GenerateFromFixedSequence<Shipment>()); 
```

# iphone - iOS 设备硬件修订号列表

> ID：13940280
> 
> 赞同：1
> 
> 时间：2012-12-18T19:40:51.663
> 
> 标签：iphone, ios, ipad

我很惊讶我找不到这个，但是有没有人列出哪些 iOS 设备对应于哪些修订号，例如“iPhone 4,1”等？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:52:05.357

请不要在脆弱的 if 语句中使用它来阻止您的应用程序的功能。

[http://www.everyi.com/by-identifier/ipod-iphone-ipad-specs-by-model-identifier.html](http://www.everyi.com/by-identifier/ipod-iphone-ipad-specs-by-model-identifier.html)

```
苹果设备 | 型号标识符
-------------------------------------------------- ------------
iPad Wi-Fi (原创) | iPad1,1
iPad Wi-Fi/3G/GPS (原创) | iPad1,1
iPad 2（仅限 Wi-Fi）| iPad2,1
iPad 2 (Wi-Fi/GSM/GPS) | iPad2,2
iPad 2 (Wi-Fi/CDMA/GPS) | iPad2,3
iPad 2（仅限 Wi-Fi，iPad2,4）| iPad2,4
iPad 第 3 代（仅限 Wi-Fi）| iPad3,1
iPad 第 3 代（Wi-Fi/蜂窝 AT&T/GPS）| iPad3,3
iPad 第 3 代（Wi-Fi/蜂窝 Verizon/GPS）| iPad3,2
iPad 第 4 代（仅限 Wi-Fi）| iPad3,4
iPad 第 4 代 (Wi-Fi/AT&T/GPS) | 待办的
iPad 第 4 代 (Wi-Fi/Verizon & Sprint/GPS) | 待办的
iPad mini（仅限 Wi-Fi）| iPad2,5
iPad mini (Wi-Fi/AT&T/GPS) | iPad2,6
iPad mini (Wi-Fi/Verizon & Sprint/GPS) | iPad2,7
iPhone (原装/EDGE) | iPhone1,1
iPhone 3G iPhone1,2 1 iPhone 3GS | iPhone2,1
iPhone 3G (中国/无Wi-Fi) | iPhone1,2*
iPhone 3GS (中国/无 Wi-Fi) | iPhone2,1*
iPhone 4 (GSM) | iPhone3,1
iPhone 4 (CDMA/Verizon/Sprint) | iPhone3,3
iPhone 4S | iPhone4,1
iPhone 5 (GSM/LTE 4, 17/北美) | iPhone5,1
iPhone 5 (CDMA/LTE, Sprint/Verizon/KDDI) | iPhone5,2
iPhone 5 (GSM/LTE 1, 3, 5/国际) | iPhone5,1
iPhone 5S | iPhone6,1
iPod（原装/滚轮）| 没有任何
iPod 第二代（触控轮）| 没有任何
iPod 第三代 (10/15/30) | 没有任何
iPod 第三代 (10/20/40) | 没有任何
iPod 第三代 (15/20/40) | 没有任何
iPod 第 4 代 (ClickWheel) | 没有任何
iPod U2 版（第 4 代）| 没有任何
iPod 照片 (30) | 没有任何
iPod 照片 (40/60) | 没有任何
iPod 彩色显示器 | 没有任何
iPod U2 版（彩色） | 没有任何
iPod 第 5 代（带视频）| 没有任何
iPod U2 版第 5 代 | 没有任何
iPod 第 5 代 - 增强 | 没有任何
iPod U2 版第 5 代增强版 | 没有任何
iPod 经典（“原始”/第 6 代）| 没有任何
iPod classic（2008 年末/第 7 代）| 没有任何
迷你iPod | 没有任何
iPod mini (第二代) | 没有任何
iPod 纳米 | 没有任何
iPod nano（第二代）| 没有任何
iPod nano 第 2 代 (RED) | 没有任何
iPod nano（第三代/胖）| 没有任何
iPod nano（第 4 代）| 没有任何
iPod nano（第 5 代/相机）| 没有任何
iPod nano（第 6 代/1.54 英寸多点触控/夹式）| 无
iPod nano（第 7 代/2.5 英寸多点触控）| 无
iPod shuffle（白色） | 没有任何
iPod shuffle 第二代（银色） | 没有任何
iPod shuffle 第 2 代（颜色/2007 年初）| 没有任何
iPod shuffle 第 2 代（2007 年末）| 没有任何
iPod shuffle 第二代（2008 年末）| 没有任何
iPod shuffle 第三代 | 没有任何
iPod shuffle 第 3 代（颜色） | 没有任何
iPod shuffle 第 4 代 (Wheel/VoiceOver) | 没有任何
iPod shuffle 第 4 代 (2012) | 没有任何
iPod touch（原创） | iPod1,1
iPod touch（第二代）| iPod2,1
iPod touch（第 3 代/8 GB）| iPod3,1
iPod touch（第 3 代/32 和 64 GB）| iPod3,1
iPod touch（第 4 代/FaceTime）| iPod4,1
iPod touch（第 4 代，2011 年） | iPod4,1
iPod touch（第 4 代，2012 年）| iPod4,1
iPod touch（第 5 代）| iPod5,1

```

# c# - 如何使用 XAML 在 Windows 商店应用程序的网格视图中表示锦标赛树结构（树视图不可用）

> ID：13940284
> 
> 赞同：1
> 
> 时间：2012-12-18T19:41:07.357
> 
> 标签：c#, xaml, gridview, treeview, windows-store-apps

我目前正在使用**xaml/c#**在 Windows 商店应用程序中实现锦标赛支架抽屉。我本来打算使用树视图，并为树视图锦标赛及其节点想出了一些伪代码，但是一旦我开始实现它，我很快意识到 Windows 商店应用程序中不再允许树视图，这使我的工作无效。我现在打算使用gridview，但是对于我应该如何表示分层数据结构（例如gridview中的树）感到困惑。此示例显示了如何在 asp.net 中执行此操作，这是否可以将 XAML 与 gridview 一起使用？

[锦标赛括号算法](https://stackoverflow.com/questions/1294412/tournament-brackets-algorithm)

# java - 从包生成 QueryDsl Q 类

> ID：13940286
> 
> 赞同：4
> 
> 时间：2012-12-18T19:41:26.940
> 
> 标签：java, maven, querydsl

如何仅通过指定包名称来生成 QueryDsl Q-Class？鉴于源类位于我的目标/生成源文件夹中，因为它们是其他构建插件（WSDL、XSD 等）的产品

我尝试使用以下插件，但找不到正确的配置：

```
<groupId>com.mysema.querydsl</groupId>
<artifactId>querydsl-maven-plugin</artifactId>
<version>2.9.0</version>
<executions>
    <phase>generate-sources</phase>
    <goals>
        <goal>process</goal>
    </goals>
    <configuration>
        <outputDirectory>target/generated-sources</outputDirectory>
        <processor>${com.mysema.query.apt.ProcessorClass}</processor>
    </configuration>
</executions> 
```

和：

```
<groupId>com.mysema.maven</groupId> 
<artifactId>maven-apt-plugin</artifactId> 
<version>1.0.4</version> 
```

我想做的是这样的：

```
<configuration>
    <packageName>com.my.package</packageName>
    <sourceFolder>target/generated-sources</sourceFolder>
    <targetFolder>target/generated-sources/querydsl</targetFolder>
</configuration> 
```

...这将生成类：

*   com.my.package.QFoo.java
*   com.my.package.QBar.java

由于没有通用的 JPA 或 JDO 注释，而且我无权访问源文件，因此我无法将任何`com.mysema.query.apt.*Processor`s 用于 maven-apt-plugin 的`<processor>`.

***编辑 1：**添加了完整的 maven-apt-plugin 配置。*

***编辑 2：*** - 我能够通过 maven 命令行让 maven-apt-plugin 偶尔工作，但不能通过扩展`AbstractQuerydslProcessor`查找`@XmlType`-annotated 类来让 Eclipse/STS 工作。双重代码生成诚然不是一个理想的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T19:22:35.577

答案是使用 Timo 此处概述的策略生成 Q 类：[https ://github.com/mysema/querydsl/issues/196](https://github.com/mysema/querydsl/issues/196)

在我的模块中`package-info.java`：

```
@QueryEntities({ com.remote.module.Foo.class,
    com.remote.module.Bar.class })
package com.my.local.module.querydsl;

import com.mysema.query.annotations.QueryEntities; 
```

Maven POM 中的插件执行：

```
<plugin>
    <groupId>com.mysema.maven</groupId>
    <artifactId>apt-maven-plugin</artifactId>
    <executions>
        <execution>
            <id>apt-maven-plugin-remote-module-QuerydslAnnotationProcessor</id>
            <goals>
                <goal>process</goal>
            </goals>
            <configuration>
                <outputDirectory>target/generated-sources</outputDirectory>
                <showWarnings>true</showWarnings>
                <!-- genereate Q-classes specified in package-info.java -->
                <processor>com.mysema.query.apt.QuerydslAnnotationProcessor</processor>
            </configuration>
        </execution>
    </executions>
    <dependencies>
        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-apt</artifactId>
        </dependency>
    </dependencies>
</plugin> 
```

# c# - regexp 将一个 var 放入另一个 regexp 的值中

> ID：13940287
> 
> 赞同：-2
> 
> 时间：2012-12-18T19:41:30.400
> 
> 标签：c#

如何将我的 var userId 放入正则表达式？

```
string userId = "ololoawd";

string did = Regex.Match(content, @"""dID"":""(.*?)"",""dOF"":true,""dOID"":"" + userId + "",""usS"":").Groups[1].Value; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T19:45:25.573

```
string did = Regex.Match(content, @"""dID"":""(.*?)"",""dOF"":true,""dOID"":" + userId + ",""usS"":").Groups[1].Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:48:55.240

您没有指定您期望的输出。我所看到的只是在连接 userId 之前您没有正确终止第一个字符串。请尝试以下操作：

```
string userId = "ololoawd";
string did = Regex.Match(content, @"""dID"":""(.*?)"",""dOF"":true,""dOID"":""" + userId + @""",""usS"":").Groups[1].Value; 
```

# c# - PsExec 1.98（从 C# 进程产生）在跨域运行 7Zip 时永远不会完成

> ID：13940288
> 
> 赞同：4
> 
> 时间：2012-12-18T19:41:32.950
> 
> 标签：c#, c#-4.0, 7zip, psexec

我正在使用带有代码的 C# .NET 4 进程启动 PsExec

```
var startInfo = new ProcessStartInfo(psExecLocation)
{
    Arguments = string.Format(@"\\{0} -accepteula -u {1} -p {2} {3}", serverName, username, password, command),
    RedirectStandardError = true,
    RedirectStandardOutput = true,
    CreateNoWindow = true,
    StandardErrorEncoding = Encoding.UTF8,
    StandardOutputEncoding = Encoding.UTF8,
    UseShellExecute = false
}; 
```

当我与我的开发机器在同一个域中时，使用 PsExec 可以正常工作（对于我正在进行的所有调用，这不仅仅是我遇到的问题）以及在跨域执行简单的 DOS 命令（rmdir 和 mkdir）时（正如我在这次通话之前所做的那样）。

但是，当我让它运行以下命令时：

C:\7Zip\7za x "C:[文件路径包含空格]\__STAGING__\App01 [Trunk - STAGE_20121217.2].7z" -o"C:[文件路径包含空格]\__STAGING__\" -y -aoa

它永远不会回来。我可以看到它开始返回数据（我正在使用进程重定向输出并开始返回它所做的事情），但随后它突然停止并且什么也不做。调用后它永远不会返回

```
process.WaitForExit(); 
```

奇怪的是它确实成功完成了。我可以 RDP 进入我们正在提取文件的服务器，我可以在那里看到文件，只是 PsExec 没有返回任何内容。我已经尝试删除 -y -aoa 开关并移动事物的顺序，但似乎没有任何效果。仅供参考，我们试图在其中提取此内容的服务器是 Windows Server 2003 版本和 Windows Server 2008 R2 版本。

正如所问的，这正是我使用 PsExec 打开进程所要做的：

```
 try
        {
            using (var process = new Process())
            {
                var startInfo = new ProcessStartInfo(psExecLocation)
                    {
                        Arguments = string.Format(@"\\{0} -accepteula -u {1} -p {2} {3}", serverName, username, password, command),
                        RedirectStandardError = true,
                        RedirectStandardOutput = true,
                        CreateNoWindow = true,
                        StandardErrorEncoding = Encoding.UTF8,
                        StandardOutputEncoding = Encoding.UTF8,
                        UseShellExecute = false
                    };

                process.StartInfo = startInfo;

                var processOutput = "";
                Action<object, DataReceivedEventArgs> action = (obj, eventArgs) =>
                    {
                        if (string.IsNullOrWhiteSpace(eventArgs.Data) == false)
                            processOutput += string.Format("{0}\r\n", eventArgs.Data);
                    };

                process.OutputDataReceived += new DataReceivedEventHandler(action);
                process.ErrorDataReceived += new DataReceivedEventHandler(action);

                process.Start();

                process.BeginOutputReadLine();
                process.BeginErrorReadLine();

                process.WaitForExit();

                // There appears to be a fault in PsExec that has everything go to error even if it is output. This gets around that
                output = "";
                if (string.IsNullOrWhiteSpace(processOutput) == false)
                {
                    output = processOutput;

                    // error code 0 means it worked / succeeded. Any other "error code" means something failed
                    var loweredOutput = processOutput.ToLower().Replace("\r\n", "").Trim();
                    return loweredOutput.EndsWith("error code 0.") || loweredOutput.EndsWith("error code 0");
                }

                // if it got here, psexec didn't return anything. That SHOULD never happen (emphasis on should)
                return false;
            }
        }
        catch (Exception ex)
        {
            Logging.Logger.LogError(ex);
            output = "";
            return false;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:18:54.050

这不是一个真正的答案，但我遇到了一个非常相似的问题。我在同一个域中运行，但看到的结果与描述的相同。

每次我从 C# 代码或 PowerShell 运行 PsExec 时，进程似乎都会挂起。当我查看远程服务器时，我看到 PSEXESVC 进程启动，以及我试图在远程服务器上运行的命令。该命令正常退出，但 PSEXESVC 似乎挂起。

我传递的远程命令是：`cmd /c dir E:\temp`

我已经在 LINQPad 上对此进行了测试，其中 CreateNoWindow 设置为 false 以及重定向设置为 false 并且打开的命令提示符确实返回了预期的输出。一旦我尝试再次捕获输出，该过程就会回到挂起状态。

我知道这曾经在一两年前使用相同的代码在 C# 中工作，所以我不确定是什么改变导致它现在挂起。

# javascript - && 运算符和布尔函数返回 false 时的执行

> ID：13940291
> 
> 赞同：4
> 
> 时间：2012-12-18T19:41:40.657
> 
> 标签：javascript, operators

我不理解 javascript 的行为。

我正在对 jquery ui 对话框进行表单验证。看来这是一个javascript问题，而不是jquery问题。

对于验证，我为每个返回 true 或 false 的字段执行一个函数，并且一个布尔变量接收连续 && 运算符的结果。像这样 ：

```
bValid = checkRegexp(validite, /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/, "Entrez la date de validit\350 sous la forme JJ/MM/AAAA." );
bValid = bValid && checkLength(libelle, "Libell\351", 1, 100 );
bvalid = bValid && checkLength(description, "Description", 1, 250); 
```

以下是验证功能：

```
function checkLength( o, n, min, max ) {
    if ( o.val().length > max || o.val().length < min ) {
        o.addClass( "ui-state-error" );
        if(o.val().length == 0) { textError = textError + "le champ " + n + " est requis !\n"; }
        else { textError = textError + "Taille de " + n + " entre " + min + " et " + max + "caract\350res.\n"; }
        return false;
    } else {
        return true;
    }
}

function checkRegexp( o, regexp, n ) {
     if (!(regexp.test(o.val()))) {
         o.addClass( "ui-state-error" );
         textError = textError + n + "\n";
         return false;
     } else {
         return true;
     }
} 
```

预期的行为是所有函数都被执行，并且所有错误的字段都被错误消息的串联标记为错误。作为信息，bValid 变量包含连续 && 运算符的布尔结果。最后一点有效；没问题。

真正的行为是，当函数 return 时`false`，似乎没有执行以下函数。结果是只有遇到的第一个错误字段被标记为错误。

为什么 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T19:44:57.933

因为`&&`运营商是“短路”的。这意味着由于编译器/解释器/任何东西都知道运算符的两侧操作数`&&`必须为真，如果第一个为假，则第二个不会被执行。

如果您希望您的函数确定执行，只需将操作数的顺序交换为`&&`：

```
bValid = checkRegexp(validite, /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/, "Entrez la date de validit\350 sous la forme JJ/MM/AAAA." );
bValid = checkLength(libelle, "Libell\351", 1, 100 )     && bValid;
bvalid = checkLength(description, "Description", 1, 250) && bValid 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T19:44:29.523

JavaScript 使用[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)。即假并且任何事情总是假的，那么为什么还要进行第二次计算呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T19:44:36.530

因为 Javascript 会简化和“优化”……如果双重`&&`操作的第一个操作数已经是假的，结果肯定是假的，所以它不会执行第二部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T19:45:05.157

这叫短路。可以在逻辑上将其`&&`视为“and-also”语法，如果第一个表达式失败，则不计算第二个表达式。如果您希望处理第二个表达式而不管第一个表达式，您可以考虑颠倒它们的顺序或尝试：

```
bValid = bValid & checkLength(description, "Description", 1, 250); 
```

虽然，这在功能上等同于

```
bValid = checkLength(description, "Description", 1, 250); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T19:44:36.140

让我们用实际输出来改写它：

```
bValid = checkRegexp(validite, /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/, "Entrez la date de validit\350 sous la forme JJ/MM/AAAA." );
bValid = bValid && checkLength(libelle, "Libell\351", 1, 100 );
bvalid = bValid && checkLength(description, "Description", 1, 250);

false = checkRegexp(validite, /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/, "Entrez la date de validit\350 sous la forme JJ/MM/AAAA." );
bValid = false && checkLength(libelle, "Libell\351", 1, 100 );
bvalid = false && checkLength(description, "Description", 1, 250); 
```

一旦它命中假，它将停止执行该条件。

# java - Java上的EL技术

> ID：13940294
> 
> 赞同：1
> 
> 时间：2012-12-18T19:42:03.973
> 
> 标签：java, reflection, pojo

我有兴趣为 POJO 的一些 EL 语言创建自己的服务。例如，我有一些带有内部 POJO 对象的对象结构，例如 A 和 B。所以，我想传递给我的服务字符串，比如“abname”，然后获取这个属性值。

java反射api或第3部分库中是否有任何实用程序？

我可以自己解析这个字符串，然后获取字段和方法，但我认为这是共同的特点。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:47:19.587

也许你应该看看[Spring Expression 语言](http://static.springsource.org/spring/docs/3.0.x/reference/expressions.html)或[Groovy](http://groovy.codehaus.org/Embedding+Groovy)。

Spring EL 是一种功能齐全的表达式语言（您应该能够在不使用框架的其余部分的情况下使用它）。

Groovy 是一种可以轻松集成到 Java 应用程序中的 JVM 语言，它强大的语法对于此类任务非常有用。由于它与 Java 兼容，您可以从 groovy 代码访问和修改您的 Java 对象。

您还可以查看[Jexl](http://commons.apache.org/jexl/)。到目前为止我还没有使用过这个，但它看起来对你的任务很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:55:05.137

以下是一些可用的选项：

*   [OGNL](http://commons.apache.org/ognl/)
*   [MVEL](http://mvel.codehaus.org/)
*   [速度](http://velocity.apache.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:55:08.320

我用过[MVEL](http://mvel.codehaus.org/)

它确实减少了代码。

# ruby-on-rails - 处理时收到红宝石回形针错误..“识别”命令无法识别 - 正在工作

> ID：13940304
> 
> 赞同：1
> 
> 时间：2012-12-18T19:42:46.917
> 
> 标签：ruby-on-rails, paperclip

我最近更新了我的工作网站，回形针停止工作。一些调查在日志中显示了这一点：

```
[paperclip] An error was received while processing:

Paperclip::Errors::NotIdentifiedByImageMagickError: /var/folders/v9/xq0hq0wj4sq3849f_31qbbc80000gn/T/landing-writing20121218-58829-1tc98b3.jpg is not recognized by the 'identify' command. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:42:46.917

许多其他答案涉及回形针路径错误 - 这不是我的情况，因为它在最近的“捆绑更新”/发布之前一直有效。

问题是我已将 Paperclip 锁定到 3.2.0 版（因为他们过去曾发布过一些“破坏性”版本）。Paperclip 依赖于非锁定版本的可卡因，最近从 0.3 升级到 0.4.2。

可卡因 0.4.2 不适用于回形针 3.2。

升级到回形针 3.3.1 解决了这个问题，我假设在我的 gemfile 中强制可卡因到 0.3 也会解决它。

# android - 如何从另一个类获取 FragmentManager 上下文

> ID：13940307
> 
> 赞同：0
> 
> 时间：2012-12-18T19:43:03.270
> 
> 标签：android, android-layout

我正在编写一个应用程序，其中我使用了一个名为 TestActivity 的活动，它扩展了 FragmentActivity。
在这个 TestActivity 的 onResume() 中，我将调用一个不扩展任何 Activity 的类，它的普通类。我需要该类中的 FragmentManager 对象，我将使用该对象执行 FragmentTransactions。我需要从 FragmentActivity 发送到该类以获取引用 FragmentManager。我尝试发送上下文 getApplicationContext()，但无法获取 FragmentManger 引用。谁能帮我解决这个问题？

提前感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:46:30.923

每个 Activity 都有自己的 FragmentManager 来管理其中的 Fragment。您需要将您希望操作的 Activity 中的 FragmentManager 传递给它。

您寻求的上下文只是 TextActivity。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:47:12.117

看完文档后，抓住这个：

```
(Activity Object).getSupportFragmentManager() 
```

并将其传递给您的班级。

[http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html#getSupportFragmentManager()](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html#getSupportFragmentManager%28%29 "获取支持片段管理器（）")

# mysql - MySQL 复制未正确同步

> ID：13940309
> 
> 赞同：1
> 
> 时间：2012-12-18T19:43:15.407
> 
> 标签：mysql, replication

我有 2 个 mysql 服务器，它们之间设置了循环复制。在两台服务器上进行从属状态检查表明一切正常。但是，当对 server1 上的表进行更新时，server2 不会立即同步。有时它会在几分钟后同步。有时它只会在 server2 上的 mysqld 重新启动后才会同步。

我有

> innodb_flush_log_at_trx_commit = 1

和

> 同步二进制日志 = 1

在我的 my.cnf 文件中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:16:45.387

`sync-binlog`可能是主要嫌疑人。

[同步二进制日志上的 MySQL 文档说](http://dev.mysql.com/doc/refman/5.5/en/replication-options-binary-log.html#sysvar_sync_binlog)

> 值 1 是最安全的选择，因为在发生崩溃时，您最多会从二进制日志中丢失一个语句或事务。然而，它也是最慢的选择（除非磁盘有电池支持的缓存，这使得同步非常快）。

我会在 Master 上检查你的磁盘控制器电池

我也建议使用

```
[mysqld]
innodb_flush_method=O_DIRECT 
```

`innodb_flush_method`我在[**DBA StackExchange**](https://dba.stackexchange.com/a/1575/877)中写过[](https://dba.stackexchange.com/a/1575/877)

# css - 强制父级扩展以保存子级内容

> ID：13940310
> 
> 赞同：1
> 
> 时间：2012-12-18T19:43:18.947
> 
> 标签：css

[http://jsfiddle.net/w9E4K/7/](http://jsfiddle.net/w9E4K/7/)

```
<div id="parent">
<div id="left">Left</div>
<div id="right">Right</div>
</div>​

#left {
    display: inline-block;
    width: 75%;
    background-color: blue;
}

#right {
    display: inline-block;
    width: 25%;
    min-width: 100px;
    background-color: red;
}

#parent {
    overflow: auto;
} 
```

​我有两个 div，我正在尝试布局，一个是屏幕的 3/4，另一个是 1/4。但是，如果屏幕太小，我需要设置最小宽度以防止元素移动。

我想知道如何用 CSS 来表达这一点？这个想法是右侧 div 至少需要 100px 并导致父 div 扩大以容纳它。

如果这有帮助，我可以换成使用浮点数而不是内联块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:56:08.540

```
#left {
  overflow: hidden;
  background-color: blue;
}

#right {
  float: right;
  width: 25%;
  min-width: 100px;
  background-color: red;
  margin-top: 5px; // only used to see the left div
                   // actually ending next to the right div
} 
```

和：

```
<div id="parent">
  <div id="right">Right</div>
  <div id="left">Left</div>
</div> 
```

演示：http: [//jsbin.com/akamik/1/](http://jsbin.com/akamik/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:48:40.803

如果你的父容器缩小到小于 400 像素，它就会崩溃，在这种情况下你无能为力。如果您需要左列的最小宽度，您可能应该在父列上设置最小宽度。

# symfony - 如何为存储浮点数、浮点数的 Symfony2 创建自定义表单字段类型？

> ID：13940311
> 
> 赞同：0
> 
> 时间：2012-12-18T19:43:18.773
> 
> 标签：symfony

我需要 hekp 为输入创建自定义表单字段类型，如下所示：

```
"float, float" 
```

我将它作为字符串存储在数据库中，但表单输入必须是“float，float”

我不知道怎么做，我试着在这里查看文档：http: [//symfony.com/doc/2.0/cookbook/form/create_custom_field_type.html](http://symfony.com/doc/2.0/cookbook/form/create_custom_field_type.html)

但我没有解决它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T13:26:47.707

我认为您想要的而不是自定义字段类型是[自定义验证器](http://symfony.com/doc/current/cookbook/validation/custom_constraint.html)与[数据转换](http://symfony.com/doc/2.0/cookbook/form/data_transformers.html)器相结合，该转换器在验证之前转换您的字符串输入。

# jquery-mobile - jQuery移动表单没有第二次提交

> ID：13940313
> 
> 赞同：0
> 
> 时间：2012-12-18T19:43:34.627
> 
> 标签：jquery-mobile

我有一个使用 jQuery 移动框架 V1.2.0 和 jQuery V1.8.2 构建的移动网站。

问题是当我在最新的 iPhone 上访问该网站并再次填写表格时，它没有发送。一旦我输入信息并点击提交，页面就会重新加载一个空白表单。

我对 javascript 的了解非常少，这让我很难调试。

有没有人遇到过这个问题或看到任何可能的原因？

抱歉，如果所有需要的文件都不在这里。我不确定需要什么来帮助我调试它。只要问，我会提供。

谢谢！

**形式：**

```
<?php

    $values = $_POST;

    $full_name = $values['fullname'];
    $email_address = $values['email'];
    $phone_number = $values['phone'];
    $vehicle_type = $values['vehicle_type'];
    $travel_type = $values['travel_type'];
    $occassion = $values['occassion'];
    $departure_date = $values['departure_date'];
    $departure_time = $values['departure_time'];
    $hours_requested = $values['hours_requested'];
    $pickup_location = $values['pickup_location'];
    $dropoff_location = $values['dropoff_location'];
    $notes = $values['notes'];

    //Check if necessary values are set

    if (isset($full_name) && isset($email_address) && isset($vehicle_type) && isset($occassion) && isset($departure_time) && isset($departure_date) && isset($travel_type) && isset($pickup_location) && isset($dropoff_location)){

    // Body:

    $message = '<html><body>';
    $message .= '<h1>New Quote Request</h1>';
    $message .= '<table rules="all" style="border-color: #666;" cellpadding="10">';
    $message .= "<tr><td><strong>Name:</strong> </td><td>" . $full_name . "</td></tr>";
    $message .= "<tr><td><strong>Email:</strong> </td><td>" . $email_address . "</td></tr>";
    $message .= "<tr><td><strong>Phone:</strong> </td><td>" . $phone_number . "</td></tr>";
    $message .= "<tr><td><strong>Vehicle Type:</strong> </td><td>" . $vehicle_type . "</td></tr>";
    $message .= "<tr><td><strong>Departure Date:</strong> </td><td>" . $departure_date . "</td></tr>";
    $message .= "<tr><td><strong>Departure Time:</strong> </td><td>" . $departure_time . "</td></tr>";
    $message .= "<tr><td><strong>Travel Type:</strong> </td><td>" . $travel_type . "</td></tr>";
    $message .= "<tr><td><strong>Occassion:</strong> </td><td>" . $occassion . "</td></tr>";
    $message .= "<tr><td><strong>Hours Requested:</strong> </td><td>" . $hours_requested . "</td></tr>";
    $message .= "<tr><td><strong>Pickup Location:</strong> </td><td>" . $pickup_location . "</td></tr>";
    $message .= "<tr><td><strong>Dropoff Location:</strong> </td><td>" . $dropoff_location . "</td></tr>";
    $message .= "<tr><td><strong>Notes:</strong> </td><td>" . $notes . "</td></tr>";
    $message .= "</table>";
    $message .= "</body></html>";

    $headers  = "From: $email_address\r\n"; 
    $headers .= "Content-type: text/html\r\n"; 

    $to = 'me@mysite.com';
    $subject = 'New Quote Request';

    //If mail successfully sent
    if (mail($to, $subject, $message, $headers)){

         header('Location: sent.html');
    }
}

?>
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Get a Quote</title>
<link href="css/styles.css" rel="stylesheet" type="text/css">

<!--jQuery-->
<link href="css/jquery-ui-1.8.23.custom.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css/premier.css" />
<link rel="stylesheet" href="css/jquery.mobile.structure-1.2.0.min.css" />
<script src="js/jquery-1.8.2.min.js"></script>
<script src="js/jquery.validate.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.8.23.custom.min.js"></script>
<script src="js/jquery.mobile-1.2.0.min.js"></script>
<script src="js/main.js" type="text/javascript"></script>
<!--jQuery-->

<script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'My Code']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script>

</head>

<body>

<div id="wrapper">

    <div id="body">

        <div id="header">

            <div id="logo">
                <a href="index.html"><img src="images/logo.png" alt="My Logo" width="132" height="25" border="0"></a>
            </div>

            <div id="menu">
                <a href="#popupmenu" data-rel="popup" data-position-to="window" data-transition="fade">MENU</a>
            </div>

            <div id="call">
                <a href="tel:MY Number" title="Click to Call"></a>
            </div>

        </div>

        <div id="spacer-91"></div>

        <div data-role="popup" data-overlay-theme="a" data-transition="fade" id="popupmenu">
            <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
            <ul>
                <li><a href="fleet.html" class="popupmenu-fleet" title="Fleet of Vehicles">Fleet</a></li>
                <li><a href="services.html" class="popupmenu-services" title="Our Services">Services</a></li>
                <li><a href="quote.php" class="popupmenu-quote" title="Free Quote" rel="external">Free Quote</a></li>
                <li><a href="flight-tracker.html" class="popupmenu-flight-tracker" title="Flight Tracker">Flight Tracker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a href="contact.html" class="popupmenu-contact" title="Contact Us">Contact</a></li>
            </ul>
        </div>

        <div id="quote" data-role="content" data-theme="b">

            <h1>Free Quote</h1>

            <p>Fillout the form below to receive a complimentary quote</p>

            <p><strong>Need help? Call</strong> <a href="tel:MY Number" title="MY Number">MY Number</a>

            <div>

                <form action="quote.php" id="travel_form" method="post">

                    <input type="text" name="fullname" id="fullname" value="" placeholder="Name" class=""/>
                    <input class="" type="text" name="email" id="email" value="" placeholder="Email"/>
                    <input type="text" name="phone" id="phone"value="" placeholder="Phone (optional)"/>

                    <br/>

                    <select name="vehicle_type" id="vehicle_type" class="">
                        <option value="">Vehicle Type</option>
                        <option value="Rolls-Royce Phantom">Rolls-Royce Phantom</option>
                        <option value="BMW 750Li">BMW 750Li</option>
                        <option value="Lexus LS 460L">Lexus LS 460L</option>
                        <option value="Mercedes S550">Mercedes S550</option>
                        <option value="Executive Sedan">Executive Sedan</option>
                        <option value="MKT Town Car">MKT Town Car</option>
                        <option value="Luxury SUV">Luxury SUV</option>
                        <option value="Stretch Limousine 6 Passenger">Stretch Limousine 6 Passenger</option>
                        <option value="Stretch Limousine 8 Passenger">Stretch Limousine 8 Passenger</option>
                        <option value="Expedition Limousine">Expedition Limousine</option>
                        <option value="Navigator Limousine">Navigator Limousine</option>
                        <option value="Hummer Limousine">Hummer Limousine</option>
                        <option value="Pinky Limousine">Pinky Limousine</option>
                        <option value="Executive Van">Executive Van</option>
                        <option value="Passenger Van">Passenger Van</option>
                        <option value="Limo Bus 10 Passenger">Limo Bus 10 Passenger</option>
                        <option value="Limo Bus 22 Passenger">Limo Bus 22 Passenger</option>
                        <option value="Limo Bus 26 Passenger">Limo Bus 26 Passenger</option>
                        <option value="Limo Bus 28 Passenger">Limo Bus 28 Passenger</option>
                        <option value="Shuttle Bus 28 Passenger">Shuttle Bus 28 Passenger</option>
                        <option value="Mini Coach 29 Passenger">Mini Coach 29 Passenger</option>
                        <option value="Mini Coach 32 Passenger">Mini Coach 32 Passenger</option>
                        <option value="Mini Coach 40 Passenger">Mini Coach 40 Passenger</option>
                        <option value="Coach Bus 56 Passenger">Coach Bus 56 Passenger</option>
                        <option value="Coach Bus 57 Passenger">Coach Bus 57 Passenger</option>
                    </select>

                    <br/>

                    <select name="occassion" id="occassion" class="">
                        <option value="">Occassion</option>
                        <option value="Airport Transportation">Airport Transportation</option>
                        <option value="Casino">Casino</option>
                        <option value="Corporate Travel">Corporate Travel</option>
                        <option value="Nationwide Service">Nationwide Service</option>
                        <option value="Night On The Town">Night On The Town</option>
                        <option value="Pier &amp; Cruise">Pier &amp; Cruise</option>
                        <option value="Prom">Prom</option>
                        <option value="Special Occassion">Special Occassion</option>
                        <option value="Sports Event">Sports Event</option>
                        <option value="Wedding">Wedding</option>

                    </select>

                    <br/>

                    <input type="text" name="departure_date" id="departure_date"  placeholder="Departure Date (MM/DD/YYYY)" value="" class="" />

                    <br/>

                    <select name="departure_time" id="departure_time" class="">
                        <option value="">Departure Time</option>
                        <option value="12:00AM">12:00AM</option>
                        <option value="12:15AM">12:15AM</option>
                        <option value="12:30AM">12:30AM</option>
                        <option value="12:45AM">12:45AM</option>
                        <option value="1:00AM">1:00AM</option>
                        <option value="1:15AM">1:15AM</option>
                        <option value="1:30AM">1:30AM</option>
                        <option value="1:45AM">1:45AM</option>
                        <option value="2:00AM">2:00AM</option>
                        <option value="2:15AM">2:15AM</option>
                        <option value="2:30AM">2:30AM</option>
                        <option value="2:45AM">2:45AM</option>
                        <option value="3:00AM">3:00AM</option>
                        <option value="3:15AM">3:15AM</option>
                        <option value="3:30AM">3:30AM</option>
                        <option value="3:45AM">3:45AM</option>
                        <option value="4:00AM">4:00AM</option>
                        <option value="4:15AM">4:15AM</option>
                        <option value="4:30AM">4:30AM</option>
                        <option value="4:45AM">4:45AM</option>
                        <option value="5:00AM">5:00AM</option>
                        <option value="5:15AM">5:15AM</option>
                        <option value="5:30AM">5:30AM</option>
                        <option value="5:45AM">5:45AM</option>
                        <option value="6:00AM">6:00AM</option>
                        <option value="6:15AM">6:15AM</option>
                        <option value="6:30AM">6:30AM</option>
                        <option value="6:45AM">6:45AM</option>
                        <option value="7:00AM">7:00AM</option>
                        <option value="7:15AM">7:15AM</option>
                        <option value="7:30AM">7:30AM</option>
                        <option value="7:45AM">7:45AM</option>
                        <option value="8:00AM">8:00AM</option>
                        <option value="8:15AM">8:15AM</option>
                        <option value="8:30AM">8:30AM</option>
                        <option value="8:45AM">8:45AM</option>
                        <option value="9:00AM">9:00AM</option>
                        <option value="9:15AM">9:15AM</option>
                        <option value="9:30AM">9:30AM</option>
                        <option value="9:45AM">9:45AM</option>
                        <option value="10:00AM">10:00AM</option>
                        <option value="10:15AM">10:15AM</option>
                        <option value="10:30AM">10:30AM</option>
                        <option value="10:45AM">10:45AM</option>
                        <option value="11:00AM">11:00AM</option>
                        <option value="11:15AM">11:15AM</option>
                        <option value="11:30AM">11:30AM</option>
                        <option value="11:45AM">11:45AM</option>
                        <option value="12:00PM">12:00PM</option>
                        <option value="12:15PM">12:15PM</option>
                        <option value="12:30PM">12:30PM</option>
                        <option value="12:45PM">12:45PM</option>
                        <option value="1:00PM">1:00PM</option>
                        <option value="1:15PM">1:15PM</option>
                        <option value="1:30PM">1:30PM</option>
                        <option value="1:45PM">1:45PM</option>
                        <option value="2:00PM">2:00PM</option>
                        <option value="2:15PM">2:15PM</option>
                        <option value="2:30PM">2:30PM</option>
                        <option value="2:45PM">2:45PM</option>
                        <option value="3:00PM">3:00PM</option>
                        <option value="3:15PM">3:15PM</option>
                        <option value="3:30PM">3:30PM</option>
                        <option value="3:45PM">3:45PM</option>
                        <option value="4:00PM">4:00PM</option>
                        <option value="4:15PM">4:15PM</option>
                        <option value="4:30PM">4:30PM</option>
                        <option value="4:45PM">4:45PM</option>
                        <option value="5:00PM">5:00PM</option>
                        <option value="5:15PM">5:15PM</option>
                        <option value="5:30PM">5:30PM</option>
                        <option value="5:45PM">5:45PM</option>
                        <option value="6:00PM">6:00PM</option>
                        <option value="6:15PM">6:15PM</option>
                        <option value="6:30PM">6:30PM</option>
                        <option value="6:45PM">6:45PM</option>
                        <option value="7:00PM">7:00PM</option>
                        <option value="7:15PM">7:15PM</option>
                        <option value="7:30PM">7:30PM</option>
                        <option value="7:45PM">7:45PM</option>
                        <option value="8:00PM">8:00PM</option>
                        <option value="8:15PM">8:15PM</option>
                        <option value="8:30PM">8:30PM</option>
                        <option value="8:45PM">8:45PM</option>
                        <option value="9:00PM">9:00PM</option>
                        <option value="9:15PM">9:15PM</option>
                        <option value="9:30PM">9:30PM</option>
                        <option value="9:45PM">9:45PM</option>
                        <option value="10:00PM">10:00PM</option>
                        <option value="10:15PM">10:15PM</option>
                        <option value="10:30PM">10:30PM</option>
                        <option value="10:45PM">10:45PM</option>
                        <option value="11:00PM">11:00PM</option>
                        <option value="11:15PM">11:15PM</option>
                        <option value="11:30PM">11:30PM</option>
                        <option value="11:45PM">11:45PM</option>
                    </select>

                    <br/>

                    <fieldset data-role="controlgroup" data-type="horizontal" id="travelTypeControls">
                        <legend>
                        <div onClick="document.getElementById('tt1').style.display='block'" onMouseOut="document.getElementById('tt1').style.display='none'" class="questionMark">
                            Travel&nbsp;type:&nbsp;<img src="images/question-mark.png" width="14" height="14" alt="What's This?">
                            <div id="tt1" class="toolTip">
                                A <strong>Point to Point</strong> reservation is a one way trip that is based on a flat fee. An <strong>Hourly Rental</strong> is a fixed rate that is billed according to the number of hours the vehicle is reserved for.
                            </div>
                        </div>
                        </legend>
                        <input type='radio' id="radio-choice-1" class="pointtopoint" name='travel_type' value='pointtopoint'>
                        <label class="" for="radio-choice-1">Point to Point</label>
                        <input type='radio' id="radio-choice-2" class="hourly" name='travel_type' value='hourly'>
                        <label class="" for="radio-choice-2">Hourly</label>
                    </fieldset>

                    <br/>

                    <select name="hours_requested" id="hours_requested" class="">
                        <option value="">Hours Requested</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="24 Plus">24+</option>
                    </select>

                    <br/>

                    <input type="text" name="pickup_location" id="pickup_location" value="" placeholder="Pick-up Location" class="" />

                    <input type="text" name="dropoff_location" id="dropoff_location" value="" placeholder="Drop-off Location" class="" />

                    <br/>

                    <textarea name="notes" id="notes" placeholder="Special Instructions"></textarea>

                    <br/>

                    <div id="submit_button">
                        <input  type="submit" value="Submit" name="submit" />
                    </div>

                </form>

            </div>

        </div>

        <div id="footer" data-role="footer" data-position="fixed" data-tap-toggle="false">

            <div class="left">
                &copy; 2012 MY Site
            </div>

            <div class="right">
                <a href="http://www.mysite.com" title="View Full Site">View Full Site</a>
            </div>

        </div>

    </div>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:32:41.153

添加`data-ajax="false"`可能会解决问题。这通过表单操作提交表单。此外，JQM 建议为表单操作输入完整的 url。

因此，例如，您的表单标签应如下所示开始

```
<form action="http://www.example.com/quote.php" data-ajax="false" id="travel_form" method="post"> 
```

# php - Linux 返回 CPU 使用率

> ID：13940315
> 
> 赞同：2
> 
> 时间：2012-12-18T19:43:43.247
> 
> 标签：php, jquery, linux, web

我目前正在为一个显示当前 CPU 使用率的网站设计一个图形系统，你可以在这里看到我正在进行的工作 - [http://nereus.rikkuness.net/admin/cpu2.php](http://nereus.rikkuness.net/admin/cpu2.php)

它目前完全按照我的意愿工作，但问题是我目前轮询 CPU 使用率的方式是

```
sar 1 | sed -n '5p' | awk '{ print $8; }' 
```

这工作正常，但需要大约一秒钟左右的时间来回复 CPU 使用率，这使得图表不会像我期望的那样在浏览器中更新。

任何可以为我提供相同信息但速度更快的命令的帮助将不胜感激。

非常感谢，

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:49:45.107

您可以简单地使用`sar 0`. `sar 1`这将立即返回结果，而不是像使用.\那样等待 1 秒的时间间隔。

请注意，这只会返回一个时间点值，因此您可能需要使用 javascript 来跟踪以前的值（即向数组添加新值并弹出旧值）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:50:49.100

使用 PHP 的内部`sys_getloadavg`函数怎么样？[http://php.net/manual/en/function.sys-getloadavg.php](http://php.net/manual/en/function.sys-getloadavg.php)

此外，为了获得当前负载，以下几行可能就足够了：

`<?php
$output = shell_exec('cat /proc/loadavg');
$loadavg = substr($output,0,strpos($output," "));
?>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:48:25.733

如果您可以在 html5 上进行中继，您可以使用[网络套接字](http://en.wikipedia.org/wiki/WebSocket)来完成您的任务。

> WebSocket 是一种通过单个 TCP 连接提供全双工通信通道的 Web 技术。W3C 正在对 WebSocket API 进行标准化，而 IETF 已将 WebSocket 协议标准化为 RFC 6455。

由于您使用的是 linux，我想这不是问题，因为 Firefox 和 chrome 都支持它们（http://caniuse.com/#feat=websockets）。

# c++ - 重新审视浮点比较

> ID：13940316
> 
> 赞同：26
> 
> 时间：2012-12-18T19:43:45.920
> 
> 标签：c++, floating-point, language-lawyer, ieee-754

这个话题在 StackOverflow 上出现过很多次，但我相信这是一个新的尝试。是的，我已经阅读了[Bruce Dawson 的文章](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm)和[What Every Computer Scientist Should Know About Floating-Point Arithmetic](https://www.ualberta.ca/~kbeach/phys420_580_2010/docs/ACM-Goldberg.pdf)以及[这个不错的答案](https://stackoverflow.com/a/10335601/768469)。

据我了解，在典型系统上比较浮点数是否相等时有四个基本问题：

1.  浮点计算不准确
2.  是否`a-b`“小”取决于规模`a`和`b`
3.  是否`a-b`“小”取决于`a`and的类型`b`（例如float、double、long double）
4.  浮点通常具有 +-infinity、NaN 和非规范化表示，其中任何一个都可能干扰朴素的公式

[这个答案](https://stackoverflow.com/a/3423299/768469)——又名。“谷歌方法”——似乎很流行。它确实处理了所有棘手的情况。它确实非常精确地扩展了比较，检查两个值是否在彼此固定数量的[ULP内。](http://en.wikipedia.org/wiki/Unit_in_the_last_place)因此，例如，一个非常大的数字将“几乎等于”与无穷大进行比较。

然而：

*   在我看来，这非常混乱。
*   它不是特别便携，严重依赖内部表示，使用联合从浮点数中读取位等。
*   它只处理单精度和双精度 IEEE 754（特别是没有 x86 long double）

我想要类似的东西，但使用标准 C++ 并处理长双精度数。“标准”是指 C++03（如果可能）和 C++11（如果需要）。

这是我的尝试。

```
#include <cmath>
#include <limits>
#include <algorithm>

namespace {
// Local version of frexp() that handles infinities specially.
template<typename T>
T my_frexp(const T num, int *exp)
{
    typedef std::numeric_limits<T> limits;

    // Treat +-infinity as +-(2^max_exponent).
    if (std::abs(num) > limits::max())
    {
        *exp = limits::max_exponent + 1;
        return std::copysign(0.5, num);
    }
    else return std::frexp(num, exp);
}
}

template<typename T>
bool almostEqual(const T a, const T b, const unsigned ulps=4)
{
    // Handle NaN.
    if (std::isnan(a) || std::isnan(b))
        return false;

    typedef std::numeric_limits<T> limits;

    // Handle very small and exactly equal values.
    if (std::abs(a-b) <= ulps * limits::denorm_min())
        return true;

    // frexp() does the wrong thing for zero.  But if we get this far
    // and either number is zero, then the other is too big, so just
    // handle that now.
    if (a == 0 || b == 0)
        return false;

    // Break the numbers into significand and exponent, sorting them by
    // exponent.
    int min_exp, max_exp;
    T min_frac = my_frexp(a, &min_exp);
    T max_frac = my_frexp(b, &max_exp);
    if (min_exp > max_exp)
    {
        std::swap(min_frac, max_frac);
        std::swap(min_exp, max_exp);
    }

    // Convert the smaller to the scale of the larger by adjusting its
    // significand.
    const T scaled_min_frac = std::ldexp(min_frac, min_exp-max_exp);

    // Since the significands are now in the same scale, and the larger
    // is in the range [0.5, 1), 1 ulp is just epsilon/2.
    return std::abs(max_frac-scaled_min_frac) <= ulps * limits::epsilon() / 2;
} 
```

我声称此代码 (a) 处理所有相关情况，(b) 与 Google 实现的 IEEE-754 单精度和双精度实现相同，并且 (c) 是完全标准的 C++。

这些主张中的一项或多项几乎肯定是错误的。我会接受任何证明这一点的答案，最好是修复。一个好的答案应该包括以下一项或多项：

*   特定输入的差异超过`ulps`最后位置的单位，但此函数返回 true（差异越大越好）
*   特定输入的差异最多为`ulps`最后位置的 Units，但此函数返回 false（差异越小越好）
*   我错过的任何案例
*   此代码依赖于未定义行为或中断的任何方式取决于实现定义的行为。（如果可能，请引用相关规范。）
*   修复您发现的任何问题
*   任何在不破坏代码的情况下简化代码的方法

我打算在这个问题上放一个不平凡的赏金。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-18T20:57:27.963

## “几乎等于”不是一个好函数

**4 不是一个合适的值：**您指出的答案是“因此，4 应该足以满足日常使用”，但没有任何依据。事实上，在普通情况下，通过不同方式以浮点计算的数字可能会因许多 ULP 不同而不同，即使如果通过精确数学计算它们会相等。因此，容差不应有默认值；应该要求每个用户提供他们自己的，希望基于对其代码的彻底分析。

作为为什么默认 4 ULP 不好的示例，请考虑`1./49*49-1`. 数学上精确的结果为 0，但计算结果（64 位 IEEE 754 二进制）为 2 ^(-53)，误差超过精确结果的 10 ^(307) ULP 和计算结果的几乎 10 ^(16) ULP。

**有时，没有合适的值：**在某些情况下，容差不能与被比较的值相关，既不是数学上精确的相对容差，也不是量化的 ULP 容差。例如，FFT 中几乎每个输出值都受到几乎每个输入值的影响，并且任何一个元素的误差都与其他元素的大小有关。必须为“几乎等于”例程提供额外的上下文，其中包含有关潜在错误的信息。

**“几乎等于”的数学性质很差：**这显示了“几乎等于”的缺点之一：缩放会改变结果。下面的代码打印 1 和 0。

```
double x0 = 1.1;
double x1 = 1.1 + 3*0x1p-52;
std::cout << almostEqual(x0, x1) << "\n";
x0 *= .8;
x1 *= .8;
std::cout << almostEqual(x0, x1) << "\n"; 
```

另一个失败是它不是传递的。`almostEqual(a, b)`并不`almostEqual(b, c)`意味着`almostEqual(a, c)`。

## 极端情况下的错误

`almostEqual(1.f, 1.f/11, 0x745d17)`错误地返回 1。

1.f/11 是 0x1.745d18p-4（十六进制浮点表示法，表示 1.745d18 [16] •2 ^(-4)）。从 1（即 0x10p-4）中减去它，得到 0xe.8ba2e8p-4。由于 1 的 ULP 是 0x1p-23，即 0xe.8ba2e8p19 ULP = 0xe8ba2e.8/2 ULP（移位 20 位并除以 2，净 19 位）= 0x745d17.4 ULP。这超出了 0x745d17 的指定容差，因此正确答案为 0。

此错误是由四舍五入引起的`max_frac-scaled_min_frac`。

摆脱这个问题的一个简单方法是指定`ulps`必须小于`.5/limits::epsilon`。然后`max_frac-scaled_min_frac`只有当差异（即使四舍五入）超过时才会发生舍入`ulps`；如果差值小于这个值，则减法是精确的，根据 Sterbenz 引理。

有一个关于使用`long double`来纠正这个问题的建议。但是，`long double`不会更正这一点。考虑将 1 和 -0x1p-149f 与`ulps`设置为 进行比较`1/limits::epsilon`。除非您的有效位有 149 位，否则减法结果会舍入为 1，即小于或等于`1/limits::epsilon`ULP。然而，数学上的差异显然超过了 1。

## 小注

该表达式`factor * limits::epsilon / 2`转换`factor`为浮点类型，这会导致`factor`无法精确表示的大值的舍入错误。很可能，例程不打算用于如此大的值（在 中的数百万 ULP `float`），因此应该将其指定为例程的限制而不是错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:03:38.153

**简化：**您可以通过首先完全丢弃非有限情况来避免 my_freexp ：

```
if( ! std::isfinite(a) || ! std::isfinite(b) )
    return a == b; 
```

似乎 isfinite 至少在 C++11 中

**编辑**但是，如果打算`limits::infinity()`在 1 ulp 之内，`limits::max()`
则上述简化不成立，但 my_frexp() 不应该返回`limits::max_exponent+1`in `*exp`，而不是 max_exponent+2 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:58:59.293

**未来证明**：如果您将来想将此类比较扩展到十进制浮点[http://en.wikipedia.org/wiki/Decimal64_floating-point_format](http://en.wikipedia.org/wiki/Decimal64_floating-point_format)，并假设 ldexp() 和 frexp() 将使用正确的基数处理此类类型，然后严格来说， 0.5 in`return std::copysign(0.5, num);`应该替换为`T(1)/limits::radix()`-`std::ldexp(T(1),-1)`或其他东西......（我在 std::numeric_limits 中找不到方便的常量）

**编辑**正如 Nemo 评论的那样，ldexp 和 frexp 将使用正确的 FLOAT_RADIX 的假设是错误的，他们坚持使用 2...

所以未来证明便携版本也应该使用：

*   `std::scalbn(x,n)`代替`std::ldexp(x,n)`

*   `exp=std::ilogb(std::abs(x)),y=std::scalbn(x,-exp)`代替`y=frexp(x,&exp)`

*   现在上面的 y in 是 [1,FLOAT_RADIX) 而不是 [T(1)/Float_Radix,1)，`copysign(T(1),num)`对于 my_frexp 的无限情况，返回而不是 0.5，并测试`ulps*limits::epsilon()`而不是 ulps*epsilon()/2

这也需要标准 >= C++11

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-11T22:10:12.750

您的方法的两个缺点是您的实现依赖于几个函数，`<cmath>`这些函数显然只适用**于标准中的浮点数**，遗憾的是目前**不能保证是`constexpr`**（虽然使用 GCC `constexpr`，您的函数的一个版本将编译它不会与大多数其他编译器一起使用）。

Google 方法相对于您的方法的优势在于，在 C++20 中，您可以将GoogleTest 版本中的`union`(或 a ) 替换为**function**。此外，通过检查和使用新引入的方法，您应该能够确保假定的内部表示是正确的。通过引入**两个自定义特征**，您可以获得很大的灵活性，允许您将函数扩展到**非标准浮动类型**：`reinterpret_cast`[`std::bit_cast`](https://en.cppreference.com/w/cpp/numeric/bit_cast)**`constexpr`**`std::numeric_limits<T>::is_iec559`[`std::endian`](https://en.cppreference.com/w/cpp/types/endian)

 *****   **确定等长无符号整数的**一个特征（在我的代码中称为）：通过这种方式，您可以通过添加专门化（例如并使用[GCC](https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html)或[Boost Multiprecision](https://www.boost.org/doc/libs/1_67_0/libs/multiprecision/doc/html/boost_multiprecision/tut/ints/cpp_int.html)`UIntEquiv` ）将代码扩展为任意长度的浮点数。`template<> class UIntEquiv<16>`[`__uint128_t`](https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html)
*   另一个用于实际**浮点类型**（在我的代码中称为`FloatTrait`），它的符号、尾数和指数掩码，以及无穷大和 NaN 的表示。通过这种方式，您可以将比较扩展到非 C++ 标准浮点数，例如[`float256`](https://www.boost.org/doc/libs/1_65_1/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/float128.html)通过添加另一个专业化。

我从下面的[Gist](https://gist.github.com/2b-t/02daa85ea5d83fc2cb96bfcf0570ab71)中插入了代码：

```
#include <bit>
#include <concepts>
#include <cstdint>
#include <limits>
#include <type_traits>

namespace detail {
  // Trait for excluding incomplete types: See https://stackoverflow.com/a/44229779/9938686
  template <typename T, std::size_t = sizeof(T)>
  std::true_type is_complete(T *);

  std::false_type is_complete(...);
}

template <typename T>
using is_complete = decltype(detail::is_complete(std::declval<T*>()));

template <typename T>
static constexpr bool is_complete_v = is_complete<T>::value;

namespace detail {

  // Class for determining the corresponding unsigned integer type with equal length
  template <std::size_t N>
  class UIntEquiv {
    protected:
      UIntEquiv() = delete;
      UIntEquiv(UIntEquiv const&) = delete;
      UIntEquiv(UIntEquiv&&) = delete;
      UIntEquiv& operator= (UIntEquiv const&) = delete;
      UIntEquiv& operator= (UIntEquiv&&) = delete;

      template<std::size_t M, typename std::enable_if_t<(M==sizeof(std::uint8_t))>* = nullptr>
      static constexpr std::uint8_t determineUIntEquivalent() noexcept;
      template<std::size_t M, typename std::enable_if_t<(M==sizeof(std::uint16_t))>* = nullptr>
      static constexpr std::uint16_t determineUIntEquivalent() noexcept;
      template<std::size_t M, typename std::enable_if_t<(M==sizeof(std::uint32_t))>* = nullptr>
      static constexpr std::uint32_t determineUIntEquivalent() noexcept;
      template<std::size_t M, typename std::enable_if_t<(M==sizeof(std::uint64_t))>* = nullptr>
      static constexpr std::uint64_t determineUIntEquivalent() noexcept;

    public:
      using type = decltype(determineUIntEquivalent<N>());
  };

  // Potentially add specialisation of UIntEquiv for longer unsigned integer types here
  // e.g. GCC's __uint128_t: https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html
  // or Boost: https://www.boost.org/doc/libs/1_67_0/libs/multiprecision/doc/html/boost_multiprecision/tut/ints/cpp_int.html

  template <std::size_t N>
  using UIntEquiv_t = typename UIntEquiv<N>::type;

  // You can provide specialisations of this trait for proprietary floating types
  // e.g. Boost float128: https://www.boost.org/doc/libs/1_65_1/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/float128.html)
  template <typename T>
  class FloatTrait;

  // Specialised trait for floating point number types according to IEEE754
  template <typename T>
  requires std::is_floating_point_v<T> && std::numeric_limits<T>::is_iec559 && (std::endian::native == std::endian::little)
  class FloatTrait<T> {
    public:
      static constexpr std::size_t number_of_bytes {sizeof(T)};
      static constexpr std::size_t number_of_bits {number_of_bytes*std::numeric_limits<std::uint8_t>::digits};
      using Bytes = UIntEquiv_t<number_of_bytes>;

      static constexpr std::size_t number_of_sign_bits {1};
      static constexpr std::size_t number_of_fraction_bits {std::numeric_limits<T>::digits-1};
      static constexpr std::size_t number_of_exponent_bits {number_of_bits - number_of_sign_bits - number_of_fraction_bits};

      static constexpr Bytes sign_mask {Bytes{1} << (number_of_bits - 1)};
      static constexpr Bytes fraction_mask {~Bytes{0} >> (number_of_exponent_bits + 1)};
      static constexpr Bytes exponent_mask {~(sign_mask | fraction_mask)};

      static constexpr bool isNan(T const t) noexcept {
        auto const bytes {std::bit_cast<Bytes>(t)};
        auto const exponent_bytes {extractExponent(bytes)};
        auto const fraction_bytes {extractFraction(bytes)};
        return (exponent_bytes == exponent_mask) && (fraction_bytes != 0);
      }

      static constexpr bool isPosInf(T const t) noexcept {
        return isPos(t) && isInf(t);
      }

      static constexpr bool isNegInf(T const t) noexcept {
        return isNeg(t) && isInf(t);
      }

      static constexpr bool isNeg(T const t) noexcept {
        auto const bytes {std::bit_cast<Bytes>(t)};
        auto const sign_bytes {extractSign(bytes)};
        return sign_bytes != 0;
      }

      // Optional helper functions
      static constexpr bool isPos(T const t) noexcept {
        auto const bytes {std::bit_cast<Bytes>(t)};
        auto const sign_bytes {extractSign(bytes)};
        return sign_bytes == 0;
      }

      static constexpr bool isInf(T const t) noexcept {
        auto const bytes {std::bit_cast<Bytes>(t)};
        auto const exponent_bytes {extractExponent(bytes)};
        auto const fraction_bytes {extractFraction(bytes)};
        return (exponent_bytes == exponent_mask) && (fraction_bytes == 0);
      }

      static constexpr Bytes extractSign(Bytes const bytes) noexcept {
        return bytes & sign_mask;
      }

      static constexpr Bytes extractExponent(Bytes const bytes) noexcept {
        return bytes & exponent_mask;
      }

      static constexpr Bytes extractFraction(Bytes const bytes) noexcept {
        return bytes & fraction_mask;
      }

    protected:
      FloatTrait() = delete;
      FloatTrait(FloatTrait const&) = delete;
      FloatTrait(FloatTrait&&) = delete;
      FloatTrait& operator= (FloatTrait const&) = delete;
      FloatTrait& operator= (FloatTrait&&) = delete;
  };

  template <typename T>
  requires is_complete_v<FloatTrait<T>> && is_complete_v<UIntEquiv_t<sizeof(T)>>
  class FloatView {
    public:
      using Trait = FloatTrait<T>;
      using Bytes = UIntEquiv_t<sizeof(T)>;

      explicit constexpr FloatView(T const t) noexcept
        : value{t} {
        return;
      }
      FloatView() = default;
      FloatView(FloatView const&) = default;
      FloatView(FloatView&&) = default;
      FloatView& operator= (FloatView const&) = default;
      FloatView& operator= (FloatView&&) = default;

      constexpr bool isNearlyEqual(FloatView const rhs, std::uint8_t const max_distance = 4) const noexcept {
        if (Trait::isNan(value) || Trait::isNan(rhs.value)) {
          return false;
        // Forces infinity to only be equal to inifinity and not also to very large numbers
        } else if (Trait::isNegInf(value) != Trait::isNegInf(rhs.value)) {
          return false;
        } else if (Trait::isPosInf(value) != Trait::isPosInf(rhs.value)) {
          return false;
        }
        return computeDistance(value, rhs.value) <= max_distance;
      }

    protected:
      T value;

      static constexpr Bytes signMagnitudeToBiased(T const t) noexcept {
        auto const b {std::bit_cast<Bytes>(t)};
        if (Trait::isNeg(t)) {
          return ~b + Bytes{1};
        } else {
          return Trait::sign_mask | b;
        }
      }

      static constexpr Bytes computeDistance(T const a, T const b) noexcept {
        auto const biased1 = signMagnitudeToBiased(a);
        auto const biased2 = signMagnitudeToBiased(b);
        return (biased1 >= biased2) ? (biased1 - biased2) : (biased2 - biased1);
      }
  };

}

template <typename T>
constexpr bool isNearlyEqual(T const lhs, T const rhs, std::uint8_t const max_distance = 4) noexcept {
  detail::FloatView<T> const a {lhs};
  detail::FloatView<T> const b {rhs};
  return a.isNearlyEqual(b, max_distance);
} 
```

[在这里试试](https://wandbox.org/permlink/Aa8kEfoArsO8yX3Z)****

# matlab - 如何从单元格中制作结构字段名称

> ID：13940318
> 
> 赞同：0
> 
> 时间：2012-12-18T19:43:49.743
> 
> 标签：matlab

我有一个需要读入matlab的文本文件。我想使用结构在 Matlab 中实现类似 java LinkedHashMap 的东西。我的文本文件是这样的

3-1 33.33 37.58

3-1 66.67 20.47

3-2 33.33 41.64

3-2 66.67 24.42

我将整个文件读入数组`[a,x,y]`，其中 a 是包含 3-1 ad 3-2 的单元格数组

我需要结构的字段名称为 a(1) 或 a(2) 但不幸的是 matlab 给了我错误。原因是我需要检查例如 a(1) 是否已经是结构字段名称，我将值连接到以前的值；如果没有，请使用尊重的值创建一个新的字段名称。代码是：

```
[a,x,y]=textread('mytxt.txt', '%q%f%f','commentstyle','matlab');

s.a(1)=[x(1),y(1)];

for j=2:length(a)

    if isfield(s,a(1))==0

        s.a(j)=[x(j),y(j)];

     else

        temp = s.a(j);

        C = concat(1,temp,[x(j),y(j)];

        s.a(j) = C

    end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:36:20.020

大概您希望将*s*作为具有字段*3-1, 3-2, ..., 3-n*的结构。我还认为您想使用 MATLAB 的[动态字段名称](http://www.mathworks.com/help/matlab/matlab_prog/generate-field-names-from-variables.html)进行创建。

要通过单元格数组*a*中的单元格动态访问字段，您需要执行以下操作：

```
s.(a{j}) = [x(j), y(j)]; 
```

*记下括号()*和大括号*{}*的不同用法。括号用于指示动态字段名称，如*s.(str)*其中*str*是字符数组。大括号用于对单元格数组*a*进行索引，因为*a{j}给出了 a 中第 j 个单元格**的*字符数组。

最后，您建议的字段名称（*3-1、3-2、...*等）不是合法的 MATLAB 字段名称，因为连字符“-”并且它们不以字母开头，*[a-zA-Z ]* . 因此，您需要将连字符替换为另一个字符，例如下划线，并将一个字母附加到建议的字段名称的开头。

1.  使用*strrep*替换连字符，如

    a=strrep(a,'-','_');

2.  在字段名称的开头附加一个字母

    a=cellfun(@(str) ['a_' str],a,'uniformoutput',0)

这项工作可以在您将文件读入矩阵*a*、*x*和*y后立即完成*

# python - 查找路径的根

> ID：13940319
> 
> 赞同：8
> 
> 时间：2012-12-18T19:43:55.547
> 
> 标签：python, regex

我有一条路径：

```
path = foo/bar/baz 
```

我想确定基础是什么。在这个例子中，它应该返回*"foo"*。

我尝试了几种方法：

```
root = re.search('(.+?)/(.+)', path).group(1)

paths = path.split('/')[0]
root = paths[0] if paths[0] or len(paths) <= 1 else '/'.join(paths[0:2])

def rootname(path):
  head,tail = os.path.split(path)
  if head != '':
   return rootname(head)
  else:
   return path
root = rootname(path) 
```

是否有更“Pythonic”的方式来访问根目录？

IE

```
root = os.path.''rootname''(path) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-08T02:17:09.023

```
>>> import os
>>> path = '/foo/bar/baz'
>>> path = path.lstrip(os.sep)  # Get rid of leading "/" if any
>>> root = path[:path.index(os.sep)] if os.sep in path else path
>>> root
'foo' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T23:13:43.320

如果您正在寻找完全符合您要求的内置或 stdlib 函数，那么没有。

如果您正在寻找第三方库，请尝试搜索 PyPI 和 ActiveState。您会发现路径操作库，如[`pathlib`](http://pypi.python.org/pypi/pathlib/0.7)（自 Python 3.4 以来已包含）[`Unipath`](http://pypi.python.org/pypi/Unipath/0.2.1)和[`forked-path`](https://github.com/Singletoned/forked-path)（均基于较早的库，其修改版本被考虑但从未接受包含在 Python 2 中）等等。（或者，如果您使用的是`twisted`or之类的框架`PyQt`，它可能内置了一个。）

使用这样的库，您通常可以在一行中获取根路径，例如：

```
pathlib.Path(mypath).parts[0]
Unipath.Path(mypath).split_root()[0]
Unipath.Path(mypath).components()[0]
path.path(mypath).splitall()[0] 
```

他们对“根”的定义可能与您的不完全相同。（正如 JF Sebastian 指出的那样，我们实际上并不确切知道您对“根”的定义是什么，所以很难猜测它是否会匹配......）所以，您*可能*仍然需要这种代码：

```
components = path.path(mypath).splitall()[0]
return components[0] if len(components[0]) > 1 else components[0]/components[1] 
```

但无论如何，它会比进行正则表达式和字符串操作更好。

（事实上​​，即使你*不*使用第三方库，你也应该尝试用`os.path`函数而不是字符串函数来构建所有东西——那样，当你明年在 Windows 上尝试它时，很有可能它会开箱即用，如果不是，它可能只需要很小的更改，而不是绝对保证它不会工作并且可能需要完全重写。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T21:12:25.300

要获取路径所属的 root 的子目录 - “基本”目录：

```
p = os.path
unc, rest = getattr(p, 'splitunc', lambda s: ('', s))(p.abspath(path))
drive, rest = p.splitdrive(rest)
basedir = p.join(unc, drive, p.sep, rest and rest.split(p.sep, 2)[1]) 
```

在 Unix 上，代码可以简化：`splitunc()`,`splitdrive()`可以省略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T20:17:02.740

如果我了解要求，您希望该目录脱离根目录，除非它是相对路径，否则您希望该目录脱离您的相对位置？你不会找到一个内置函数来处理类似的事情。但是，如果这**确实**是您需要的，请使用类似于您的第二种“方式”的方法。不过，我会使用 os.path.sep 而不是 '/'。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-27T11:18:39.110

类似于彼得的回答：

```
root = path.lstrip(os.sep).split(os.sep)[0] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-05T14:37:00.333

单线`os.path.splitdrive(checkedpath)[0]`

# html - HTML：导航栏

> ID：13940321
> 
> 赞同：0
> 
> 时间：2012-12-18T19:44:02.350
> 
> 标签：html, css

我正在实现一个网页，它在右侧面板上有一个导航栏，然后左侧面板将显示详细信息（就像 facebook 一样）。

基本上，我很困惑如何绘制垂直线来划分导航面板和显示面板。

我用谷歌搜索了这个，但本教程的大部分内容只展示了如何构建一个类似标签的导航栏。

谁能给我一些关于如何实现这个的想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:47:07.390

`border-left`在右侧面板上设置 a - 或在`border-right`左侧面板上设置 a。使用`margin`和`padding`调整位置。

# ios - 有没有办法创建自定义设置包？

> ID：13940322
> 
> 赞同：2
> 
> 时间：2012-12-18T19:44:02.283
> 
> 标签：ios, iphone-privateapi

我正在寻找一种创建自定义视图并将其显示在“设置”中的方法。

我知道公共 API 不允许这样做，它将被 AppStore 拒绝（如果可能的话）。我正在开发企业应用程序，所以这不是问题。 [设置包的自定义视图控制器？](https://stackoverflow.com/questions/951051/custom-view-controller-for-settings-bundle)

我的问题是是否有一些私有 API 或私有 plist 配置可用于创建自定义设置包视图？我正在寻找可以在监狱（非越狱设备）上工作的东西。

**更新 1**

我认为一些定制是可能的。我看着我的 iPad，看到 Twitter 和 Facebook 的合理复杂设置。它们都有“安装”、“登录”、“创建新帐户”按钮和一些功能。看起来很多预安装的设置包都超出了简单的配置。

**更新 2**

看起来 Twitter 和 Facebook 有独立的捆绑包。它可能位于/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.1.sdk/System/Library/PreferenceBundles/TwitterSettings.bundle/

我仍然不确定设置应用程序中是否有一些特殊支持，这将允许 Twitter 和 Facebook 进行更复杂的设置，或者是否可以在设置中使用 3rd 方自定义视图，但只是没有记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:34:28.163

如果没有越狱，这是不可能的（据我所知）。设置中显示的选项对应于您为正在修改的变量设置的值类型（即布尔值是开关等）。要访问设置，您需要越狱访问权限。

# c# - 如何使用 Free 3 of 9 制作小尺寸条码

> ID：13940325
> 
> 赞同：1
> 
> 时间：2012-12-18T19:44:17.337
> 
> 标签：c#, barcode

```
public class Barcode
    {
        public Bitmap CreateBarcode(string data)
        {
            string barcodeData = "*" + data + "*";
            Bitmap barcode = new Bitmap(1, 1);
            // less than size 40, my barcode reader can not read it.
            Font threeOfNine = new Font("Free 3 of 9", 40,
                                        System.Drawing.FontStyle.Regular,
                                        System.Drawing.GraphicsUnit.Point);

            Font arial = new Font("Arial", 15,
                                  System.Drawing.FontStyle.Regular,
                                  System.Drawing.GraphicsUnit.Point);

            Graphics graphics = Graphics.FromImage(barcode);
            SizeF dataSize = graphics.MeasureString(barcodeData, threeOfNine);
            dataSize.Height = 70;

            barcode = new Bitmap(barcode, dataSize.ToSize());
            graphics = Graphics.FromImage(barcode);

            graphics.Clear(Color.White);
            graphics.TextRenderingHint = TextRenderingHint.SingleBitPerPixel;

            graphics.DrawString(barcodeData, threeOfNine, new SolidBrush(Color.Black), 0, 0);

            graphics.DrawString(data, arial, new SolidBrush(Color.Black), 50, 40);

            graphics.Flush();

            threeOfNine.Dispose();
            graphics.Dispose();

            return barcode;
        }
    } 
```

我正在使用上面的代码使用 Free 3 of 9 生成条形码。但如果我看到小于 40 的尺寸，我的条形码阅读器无法读取该代码。40 码对我的应用来说太大了，有什么办法可以减小条码的大小吗？

```
Font threeOfNine = new Font("Free 3 of 9", 30,
                            System.Drawing.FontStyle.Regular,
                            System.Drawing.GraphicsUnit.Point); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-05T19:18:35.537

要正确扫描条码，必须满足以下两个条件之一：

*   每个条码特征的宽度（以设备像素为单位）必须很大

*   每个条码特征的宽度（以设备像素为单位）必须是精确整数

如果渲染一个基本特征宽度为 1/72" 的代码 39 条码并尝试在 101.6dpi 设备上打印它，一些应该是 1/72" 宽的特征将打印为 1 个像素宽，而另一些则打印为 2 个像素宽像素。应该是 2/72" 的特征通常会打印为三个像素宽，但有时会打印为两个像素。看到两个像素宽的扫描仪将无法知道它是否是一个比平时更窄的宽特征，或打印得比平时更宽的狭窄特征。

如果条码尺寸被缩小以匹配输出设备的分辨率，那么在扫描仪看来，2 像素宽的东西将是 1 像素宽的东西的两倍。即使条形码会更小，它们也更有可能被阅读。或者，如果输出设备分辨率增加（例如到 300dpi），那么单宽特征将是 4-5 像素，而双宽特征将是 8-9 像素。即使打印为 5 像素宽的窄特征后面跟着打印为 8 的宽特征（尺寸比略低于“正确的”2:1），扫描仪也应该可以轻松读取它。

请注意，虽然某些格式仅使用两种宽度的条和空格，但其他格式（如 Code 128）使用更多。可靠的扫描要求能够区分单宽、双宽、三宽和四宽特征。如果单宽度特征的宽度在 3 到 4 像素之间（因此它们有时显示为 3，有时显示为 4），扫描仪可能难以确定打印为 12 像素宽的特征是否是打印宽度大于 3 像素的三宽度特征。名义上的，或更窄的四边形特征。大多数扫描仪可能会做出必要的推断来弄清楚它，但是对于单宽、双宽、三重和四宽特征具有一致的宽度将大大提高可读性。

# vbscript - .VBS 是否支持 Hold-Wait 程序范例？

> ID：13940326
> 
> 赞同：0
> 
> 时间：2012-12-18T19:44:25.623
> 
> 标签：vbscript

下面的编程结构是否可以在 VBScript 中实现。ProgA 将在哪里开始，在执行一些行之后，它将产生两个进程，即 ProgB 和 ProgC。当这些子 .vbs 完成时，父程序 ProgA 将继续执行并将完成任务

```
 ProgA.VBS
                                        |
                 -------------------------------------------------
                 |                                               |
            ProgB.VBS                                        ProgC.VBS 
```

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T19:58:00.443

Read about then [.Run](http://msdn.microsoft.com/en-us/subscriptions/d5fk67ky%28v=vs.80%29.aspx) and [.Exec](http://technet.microsoft.com/de-de/subscriptions/index/ateytk4a%28v=vs.80%29.aspx) methods of the WshShell object (`CreateObject("Wscript.Shell")`). Make sure you pay attention to the `bWaitOnReturn` parameter to .Run and the **.Status** (and **.Exitcode**) properties of the [WshScriptExec](http://technet.microsoft.com/de-de/subscriptions/index/2f38xsxe%28v=vs.80%29.aspx) object. [This answer](https://stackoverflow.com/a/13929920/603855) contains sample code for .Run and .Exec.

**Update:**

a.vbs (not production quality code!):

```
Option Explicit

Const WshFinished = 1

Dim goWSH : Set goWSH = CreateObject("WScript.Shell")

Dim sCmd, nRet, oExec

sCmd = "cscript .\b.vbs"
WScript.Echo "will .Run", sCmd
nRet = goWSH.Run(sCmd, , True)
WScript.Echo sCmd, "returned", nRet

sCmd = "cscript .\c.vbs"
WScript.Echo "will .Exec", sCmd
Set oExec = goWSH.Exec(sCmd)
Do Until oExec.Status = WshFinished : WScript.Sleep 100 : Loop
WScript.Echo sCmd, "returned", oExec.ExitCode

WScript.Echo "done with both scripts"
WScript.Quit 0 
```

.Runs b.vbs:

```
MsgBox(WScript.ScriptName)
WScript.Quit 22 
```

and .Execs c.vbs:

```
MsgBox(WScript.ScriptName)
WScript.Quit 33 
```

output:

```
cscript a.vbs
will .Run cscript .\b.vbs
cscript .\b.vbs returned 22
will .Exec cscript .\c.vbs
cscript .\c.vbs returned 33
done with both scripts 
```

The MsgBoxes will prove that a.vbs waits for b.vbs and c.vbs.

**Update II - VBScript's MultiProcessing ((c) @DanielCook):**

ax.vbs:

```
Option Explicit

Const WshFinished = 1

Dim goWSH : Set goWSH = CreateObject("WScript.Shell")

' Each cmd holds the command line and (a slot for) the WshScriptExec
Dim aCmds : aCmds = Array( _
    Array("cscript .\bx.vbs", Empty) _
  , Array("cscript .\cx.vbs", Empty) _
)
Dim nCmd, aCmd
For nCmd = 0 To UBound(aCmds)
    ' put the WshScriptExec into the (sub) array
    Set aCmds(nCmd)(1) = goWSH.Exec(aCmds(nCmd)(0))
Next
Dim bAgain
Do
    WScript.Sleep 100
    bAgain = False ' assume done (not again!)
    For Each aCmd In aCmds
        ' running process will Or True into bAgain
        bAgain = bAgain Or (aCmd(1).Status <> WshFinished)
    Next
Loop While bAgain
For Each aCmd In aCmds
    WScript.Echo aCmd(0), "returned", aCmd(1).ExitCode
Next

WScript.Echo "done with both scripts"
WScript.Quit 0 
```

.Execs bx.vbs

```
Do
  If vbYes = MsgBox("Tired of this rigmarole?", vbYesNo, WScript.ScriptName) Then Exit Do
  WScript.Sleep 300
Loop
WScript.Quit 22 
```

and cx.vbs:

```
Do
  If vbYes = MsgBox("Tired of this rigmarole?", vbYesNo, WScript.ScriptName) Then Exit Do
  WScript.Sleep 500
Loop
WScript.Quit 33 
```

Don't do this at work without a lot of further effort invested in error handling.

# ajax - 从 JMS 侦听器类以编程方式更新某些视图

> ID：13940334
> 
> 赞同：2
> 
> 时间：2012-12-18T19:44:43.843
> 
> 标签：ajax, jms, push, listener, openxava

我能够集成 ActiveMQ 并在我的 OpenXava 应用程序中创建一个 JMS 使用者。现在，我需要使用消息中接收到的数据更新某些瞬态视图，这有几个问题需要考虑，例如...如何从 JMS 侦听器 java 类中去并将更改推送到当前视图？...并假设特定视图是当前视图！！！，但当前视图可以是整个应用程序中的几种可能视图中的任何一种！！！... 所以？所以？...然后我确实认为，我会将 JMS 消息持久化到某个实体中（作为数据库中的临时存储），即使这会导致性能低下，但在那之后......我将如何推动最近的变化如果某个用户正在查看瞬态视图。

我习惯于使用启用 ajax 的一些 JSF 实现来构建我的 webapps，然后我可以在 JMS 侦听器中接收消息，然后获取 jsf 托管 bean 引用并使用 Ajax 推送来刷新可以由一个或几个用户查看应用程序，所以这总是产生一种实时应用程序，它更新任何打开的视图（如果视图是用户正在观看的视图）。

那么，有没有办法在我的 OX 应用程序中使用 JMS 侦听器类来实现这一点？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T13:00:50.800

一个选项可以是使用 JavaScript 定期调用以了解是否在表中添加了新记录或其他内容，以及是否刷新大小写。

如果您是 liferay，您可以使用 JavaScript 代码在该页面中创建一个 portlet。此代码可以使用 DWR 进行调用，如果有新数据，它可以直接调用“CRUD.refresh”操作。

像这样的东西：

```
refreshData = function() {
   openxava.executeAction('YourApplication', 'YourModule', '', false, 'CRUD.refresh')
   setTimeout('refreshData()', 5000);
}
setTimeout('refreshData()', 5000); 
```

我没有测试这段代码，所以它肯定不能按原样工作。把它当作一个想法。

真的，这是一个肮脏的把戏。理想的情况是 OpenXava 将直接支持 Comet，您只需调用服务器中的方法即可完成此操作。你认为为 OX 添加彗星支持值得吗？

# mysql - 显示 MySQL 中的所有记录

> ID：13940339
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:44:54.250
> 
> 标签：mysql, perl, filter

我正在尝试显示 MySQL 表中的所有记录。

我可以做`select * from table`，但这不是我想做的。

我想做这样的事情

```
select app_id, app_name from app where app_sendto = '%' 
```

我已经尝试了上述方法，但没有显示任何内容。

我想按如下方式运行上述查询

```
$get_app = "select app_id, app_name from app where app_sendto = ?";
$sth = $dbh->prepare($get_app); 
$sth->execute('people') or die "Cannot execute sth: $DBI::errstr"; 
```

谁能帮我解决这个问题。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-12-18T19:58:02.770

Just got the solution, the query should be

```
select app_id, app_name from app where app_sendto like '%' 
```

# c# - 从文件到屏幕绘制骨架动画

> ID：13940341
> 
> 赞同：3
> 
> 时间：2012-12-18T19:44:55.470
> 
> 标签：c#, kinect, frame-rate, drawingcontext

我基本上想做的是使用 C# 和 Kinect SDK（完成）将 kinect 骨架帧数据（关节位置）写入文件，然后在外部处理这些数据（完成），然后将数据读回我的应用程序（完成）并逐帧将数据绘制为光点步行者（骨架关节），以便我看到动画。（问题）

我的问题是：如何使用 C#（及其 DrawingContext 类）绘制这个 30fps 动画？

我想使用 DrawingContext，因为我在录制时已经将它用于 SkeletonFrames 的实时输出。就像这样简单地完成，类似于“Skeleton Basics”SDK 示例：

```
this.sensor.SkeletonFrameReady += this.SensorSkeletonFrameReady;
...

private void SensorSkeletonFrameReady(object sender, SkeletonFrameReadyEventArgs e)
    {
        ...

        using (DrawingContext dc = this.drawingGroup.Open())
        {
        ...
           dc.DrawEllipse(drawBrush, null, 2Dpoint, JointThickness, JointThickness);

        }
    } 
```

所以 kinect 为我提供了大约 30fps 使用事件，我只是绘制数据。

但是当没有 kinect 但数据是从文件/内存中读取时，我该如何绘制呢？（目前使用的是 2DArray [Frame, Joint]）

我想过让一个线程以 30fps 运行（使用睡眠来实现帧率），然后发送一个类似的事件或直接绘制。但是我试图让这个工作完全失败。例如，我没有将事件发送到主线程进行绘图。

问题可能是我缺乏对 C# 的理解（我对它完全陌生）......

关于如何设置和工作的任何提示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:28:29.880

[Kinect 工具箱](http://kinecttoolbox.codeplex.com/)已经提供了一种保存和重放流数据的方法（三者中的任何一个）。它可能会填补您需要的空白。

如果您选择自己滚动，您将希望保存一个从零开始的时间戳，并将每个骨架保存到文件中。然后，当您希望重播它时，您可以使用`DispatcherTimer`或`Timer`从零计数到任何时候——当您的计时器达到下一个骨架的正确时间戳值时，显示它。

正如你所指出的，Kinect 会给你*大约。*30 帧/秒。您不想假设它以 30 fps 的速度运行。使用时间戳以便在应该播放的时候播放它（无论是 30 fps 还是 15 fps）

# jquery - AJAX 数据数组向下钻取

> ID：13940352
> 
> 赞同：0
> 
> 时间：2012-12-18T19:45:39.463
> 
> 标签：jquery, ajax

曾几何时，我使用 PHP 来显示我的所有数据。现在我想使用 AJAX。

我曾经在 PHP 中获取数据的地方：

```
<?php 
    $array = $this->disparray;

    foreach($array as $key => $value){
        $mlsnum = $value['1'];
        echo "<div>" . $mlsnum . "</div>";
    }
?> 
```

`$this->disparry`joomla 中将数据放入数组的函数在哪里。它的结构看起来像

```
array (

    0 => array (
        0 => data1,
        1 => data2,
    );,

    1 => array (
        0 => data1,
        1 => data2,
    );,

); 
```

现在我有一个可以工作的 AJAX 函数（或者至少返回一个`alert`.

```
var results = $('#hidden').serialize();

var url = 'index.php?option=com_mls&view=list&format=raw&' + results;

$.ajax({
    url: url,
    success: function(data){
        $('#test').html(data);
        alert(data);
    },
    error: function(){
        alert('There was an error loading your request.  <br />Please try again later.');
    }
}); 
```

警报中没有写入任何内容，`#test`也没有显示任何内容（即使警报发生）。为什么？我应该得到一大堆数组数据，但我什至没有得到一块煤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:10:30.790

确保在回显之前对 php 数组进行编码，以便 jQuery 可以解析它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-18T19:51:31.323

你能在ajax调用中声明url变量吗？看起来它不在 ajax 函数的范围内

这应该可以，如果您需要在外面声明，请尝试不使用 var

```
 $.ajax({
      url:'function to call url',
...
...

}); 
```

# cocos2d-iphone - 视差层未显示在 GameScene 中

> ID：13940355
> 
> 赞同：0
> 
> 时间：2012-12-18T19:46:07.467
> 
> 标签：cocos2d-iphone, parallax

通常我采取行动 layer.m 并在其 init 方法中添加对视差方法的调用，例如：

```
 [self addScrollingBackgroundWithParallax]; 
```

该方法是：

```
-(void)addScrollingBackgroundWithParallax {
CGSize screenSize = [[CCDirector sharedDirector] winSize];
CGSize levelSize = [[GameManager sharedGameManager]
                    getDimensionsOfCurrentScene];

// 1\. Create image (sprite node)
CCSprite *BGLayer1 = [CCSprite spriteWithFile:@"chap9_scrolling4.png"];

// 2\. Create Parallax Node, Position it 
parallaxNode = [CCParallaxNode node];
[parallaxNode setPosition:ccp(levelSize.width/2.0f,screenSize.height/2.0f)];
float xOffset = 0;
// 3\. Add image node to parallax node
[parallaxNode addChild:BGLayer1 z:1 parallaxRatio:ccp(1.0f,1.0f) positionOffset:ccp(0.0f,0.0f)];
xOffset = (levelSize.width/2) * 0.3f;
// 4\. Add parallax node to layer
[self addChild:parallaxNode z:1]; 
```

}

这工作正常。所以我试图做一些不同的事情。在游戏场景类中，我初始化以下内容：

```
-(id)init{
self = [super init];
if (self != nil) {
    // The scene will start out by running layer1
    _layer = [PlaneLevel node];
    [self addChild:_layer z:1];

    //Add eye candy
    layer2 = [Scene2EyeCandy node];
    [self addScrollingBackgroundWithParallax];

}
return self; 
```

}

一个gamelayer和一个eyecandy层。我将游戏层添加到场景中，但是我没有将 eyecandy 层添加到场景中，而是调用了 addScrollingBackgroundWithParallax 方法来执行此操作：

```
-(void)addScrollingBackgroundWithParallax {
CGSize screenSize = [[CCDirector sharedDirector] winSize];
CGSize levelSize = [[GameManager sharedGameManager] getDimensionsOfCurrentScene];
// 1\. Creates the parallax node
CCParallaxNode *parallaxNode = [CCParallaxNode node];
// 2\. Positions it
[parallaxNode setPosition:ccp(levelSize.width/2.0f,screenSize.height/2.0f)];

float xOffset = 0;
// 3\. Adds the eyecandy layer to the parallax node 
[parallaxNode addChild:layer2 z:40 parallaxRatio:ccp(1.0f,1.0f) positionOffset:ccp(0.0f,0.0f)];

xOffset = (levelSize.width/2) * 0.3f;
// 4\. Finally add the parallax node to the scene.
[self addChild:parallaxNode z:1]; 
```

}

但是当我运行游戏时，我根本没有得到眼睛糖果层。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T06:01:44.340

当然，你不知道。你的代码：

```
//Add eye candy
layer2 = [Scene2EyeCandy node];
[self addScrollingBackgroundWithParallax]; 
```

那么在哪里

```
[self addChild: layer2]; 
```

?

# c - 为什么使用 -fPIC -shared 编译的共享对象文件的反汇编会引入像“call 4”和“add 2”这样的虚拟地址？

> ID：13940358
> 
> 赞同：1
> 
> 时间：2012-12-18T19:46:21.983
> 
> 标签：c, linux, assembly

考虑以下代码：

```
$ cat foo.c
static int foo = 100;

int function(void)
{
    return foo;
} 
```

我了解libfoo.so的反汇编

```
$ gcc -m32 -fPIC -shared -o libfoo.so foo.c
$ objdump -D libfoo.so

000004cc <function>:
 4cc:   55                      push   %ebp
 4cd:   89 e5                   mov    %esp,%ebp
 4cf:   e8 0e 00 00 00          call   4e2 <__x86.get_pc_thunk.cx>
 4d4:   81 c1 c0 11 00 00       add    $0x11c0,%ecx
 4da:   8b 81 18 00 00 00       mov    0x18(%ecx),%eax
 4e0:   5d                      pop    %ebp
 4e1:   c3                      ret    

000004e2 <__x86.get_pc_thunk.cx>:
 4e2:   8b 0c 24                mov    (%esp),%ecx
 4e5:   c3                      ret    
 4e6:   66 90                   xchg   %ax,%ax
...

000016ac <foo>:
    16ac:   64 00 00                add    %al,%fs:(%eax) 
```

在`function`地址中`foo`计算为 0x4d4（`ecx`调用后的值`__x86.get_pc_thunk.cx`）+ $0x11c0 + 0x18 = 0x16ac。0x16ac 是`foo`.

但是我不明白的拆卸

```
$ gcc -m32 -fPIC -shared -c foo.c
$ objdump -D foo.o
00000000 <function>:
   0:   55                      push   %ebp
   1:   89 e5                   mov    %esp,%ebp
   3:   e8 fc ff ff ff          call   4 <function+0x4>
   8:   81 c1 02 00 00 00       add    $0x2,%ecx
   e:   8b 81 00 00 00 00       mov    0x0(%ecx),%eax
  14:   5d                      pop    %ebp
  15:   c3                      ret    

00000000 <foo>:
   0:   64 00 00                add    %al,%fs:(%eax)

00000000 <__x86.get_pc_thunk.cx>:
   0:   8b 0c 24                mov    (%esp),%ecx
   3:   c3                      ret 
```

为什么`call 4 <function+0x4>`和为什么`add $0x2,%ecx`？

**更新：（**将 -r 标志添加到 objdump，-R 标志会产生错误`not a dynamic object, Invalid operation`。

```
$ objdump -D -r foo.o
00000000 <function>:
   0:   55                      push   %ebp
   1:   89 e5                   mov    %esp,%ebp
   3:   e8 fc ff ff ff          call   4 <function+0x4>
        4: R_386_PC32   __x86.get_pc_thunk.cx
  8:    81 c1 02 00 00 00       add    $0x2,%ecx
        a: R_386_GOTPC  _GLOBAL_OFFSET_TABLE_
  e:    8b 81 00 00 00 00       mov    0x0(%ecx),%eax
        10: R_386_GOTOFF    .data
 14:    5d                      pop    %ebp
 15:    c3                      ret 
```

现在`4`在 中是有意义的`call 4 <function+0x4>`，因为该指令在文本部分的偏移量是 4。我仍然不知道为什么`0x2`在 中`add $0x2,%ecx`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T03:07:40.820

链接器将执行重定位，使得`final value`= `symbol`+ `offset`- `PC`。请注意，`PC`此公式中的 是重定位本身的地址，而不是指令的地址，因为链接器不知道指令边界。然而，汇编器知道它们并且可以创建适当的偏移量。

让我们看看它是如何`call __x86.get_pc_thunk.cx`工作的。在 x86 上，该`call`指令使用相对寻址，但 的值`PC`已经递增以指向下一条指令。您可以在第一次转储中验证这一点：

```
 4cf:   e8 0e 00 00 00          call   4e2 <__x86.get_pc_thunk.cx>
 4d4:   81 c1 c0 11 00 00       add    $0x11c0,%ecx 
```

注意指令中的偏移量是`0e`。已经增加`PC`的`4d4`肯定是跳转的目标`4e2`= `4d4`+ `0e`（所有数字均为十六进制）。

现在对于带有重定位的版本：

```
 3:   e8 fc ff ff ff          call   4 <function+0x4>
        4: R_386_PC32   __x86.get_pc_thunk.cx 
```

它使用`R_386_PC32`但那是在指令的第二个字节，而`call`需要从更新的偏移量，`PC`这显然是`4`更多的字节。这意味着正确的结果`4`更少，因此指令包含`fffffffc`which is `-4`。请注意，无论 的地址`call`是什么，此偏移量始终为`-4`。反汇编程序会自动将其添加到更新`PC`的内容中，在本例中是`8`这样，因此它`call 4`通过做`8-4`。

好的，进入`R_386_GOTPC`.

```
 3:   e8 fc ff ff ff          call   4 <function+0x4>
        4: R_386_PC32   __x86.get_pc_thunk.cx
  8:    81 c1 02 00 00 00       add    $0x2,%ecx
        a: R_386_GOTPC  _GLOBAL_OFFSET_TABLE_ 
```

该`__x86.get_pc_thunk.cx`函数只是将堆栈中的返回地址加载到寄存器`ecx`中。在这种情况下，这个返回地址是`8`。实现的目标是拥有`_GLOBAL_OFFSET_TABLE_`in的地址`ecx`。我们需要知道它与`PC`已有参考的`ecx`距离并添加该距离。为此，`R_386_GOTPC`使用了重定位，但这将给出地址的偏移量，`0a`因为那是重定位条目所在的位置。与地址的偏移量`8`当然会`2`更多。这`2`是指令中编码的内容。

**总结**：指令中存储的重定位偏移量是重定位地址和所需参考点的差：`offset`= `PC`- `reference`。在第一种情况下，这个参考点是`4`更高的字节，在第二种情况下，`2`更低的字节分别给出`-4`和的偏移量`2`。

# php - php中的自定义跨域度量跟踪系统实现

> ID：13940362
> 
> 赞同：3
> 
> 时间：2012-12-18T19:46:43.917
> 
> 标签：php, javascript, cross-domain, pixel, metrics

我需要设计一个网站系统，用户可以在其中创建帐户、注册他们的网站并获取显示图像/链接的自定义跟踪代码。我很想听听一些想法。

该代码段需要能够执行以下操作：

a) 跟踪网站获得的独特印象的数量。

b）跟踪用户访问持续时间（这需要以秒为单位精确到用户离开网站/域）

c）让跟踪代码段代码显示可点击的图像（我应该能够根据显示代码段的站点更改此图像）。

d) 能够更改访问者点击图片后将去往的网址/链接。（当访问者访问该站点时，该片段需要显示我选择的图像和我选择的链接）。

e) 跟踪此图像的点击次数。

我阅读了有关像素跟踪的信息，但这种设计和我需要的指标有点不同。似乎我可以通过`<img src="http://www.mydomain.com/getImage.php?id=5123" />`在我的 php 脚本中包含和处理一些信息来做一些事情，但我想确保没有更好的方法/更有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T19:46:54.213

您要做的是让您的用户嵌入一段来自您的服务器的 javascript。例子：

端点 trackingCode.php 将执行一些跟踪工作，然后输出一个 javascript 将执行一些其他跟踪任务。

a) 跟踪独特印象 您可以在服务器端的 trackingCode.php 中立即执行此操作

b) 跟踪用户访问持续时间 一种方法是从 javascript 向服务器上的端点发送定期 ajax 轮询。通过这种方式，您可以大致了解用户在页面上停留的时间。

c) 显示可点击的图片您的 javascript 将使用 document.createElement （或等效的）将图片添加到主机网站

d) 能够更改访问者的网址/链接当您在服务器上动态生成 javascript 时，您可以根据收到的 id 参数为每​​个网站生成不同的 javascript。您可以利用它在上面步骤 c 中添加到网站的图像中拥有不同的图像源和点击 URL。

e) 跟踪图像上的点击 与在上面的步骤 c 中创建带有子元素的元素不同，您可以创建一个 onclick 事件处理程序并将其附加到它。事件处理程序将做两件事 - 向您的服务器发送一个额外的跟踪 ajax 请求并重定向到所需的点击 URL。

另一种方法是创建一个带有 child 的元素，并在您的服务器上的一个 url 处具有该点的 href 属性（类似于[https://www.mydomain.com/clickThrough.php?id=5134](https://www.mydomain.com/clickThrough.php?id=5134)）。这将执行跟踪并返回 302 http 状态（暂时移动），这将导致用户被重定向到实际所需的点击 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:49:49.880

> b）跟踪用户访问持续时间（这需要以秒为单位精确到用户离开网站/域）

不可能。用户离开网站的时间点*是不确定*的，并且`a secret of the user`.

服务器只知道用户开始访问网站的时间点和最后一次请求的时间点。但这两个精确到第二个。

因此，用户访问持续时间可以在最少的秒数内获得，但不能获得确切的持续时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:38:35.883

完成您要完成的工作的最常见方法是制作一个 JavaScript 片段，该片段将呈现标签，并将图像的 src 属性设置为动态字符串，其中包含 JavaScript 可以从客户端收集的所有信息（而服务器端的 PHP 不是能够）。

关于访问持续时间，这需要的不仅仅是网页上的图像和链接，它应该是大量的 javascript。

如果我们谈论登录页面，那么从窗口的“卸载”事件处理程序运行 ajax 请求是很正常的。任何其他通用发布者可能不会同意放置这样的代码，因为这是一种“灰色”技术。

另一种方法是在客户端停止移动鼠标后向您的跟踪服务器发送请求。这会更好，因为如果用户只是在被跟踪网站打开的情况下离开他的 PC，这不会计算时间，并且当用户移动鼠标关闭窗口时不会计算时间。因此，您会看到有效会话的长度。

但无论哪种方式，您都不应该期望精度级别太高，因为某些跟踪会话会因为驻留在被跟踪网站上的其他 javascript 代码而失败。

# android - 如何根据 Galaxy 设备上的联系人应用程序制作幻灯片效果？

> ID：13940363
> 
> 赞同：0
> 
> 时间：2012-12-18T19:46:49.803
> 
> 标签：android, slide, android-contacts, galaxy

似乎很奇怪，我找不到任何信息：

在三星 Galaxy 设备上的联系人应用程序中有一个不错的功能，它允许用户滑动联系人列表项以进行快速呼叫和发送快速 SMS 消息，如此[**处所示**](http://www.youtube.com/watch?feature=player_detailpage&v=7HgDlQLc258#t=93s)。

我的问题是：

1.  有没有简单的方法来做到这一点？也许是第三方图书馆？
2.  如果没有，您将如何实施这样的事情？
3.  是否允许将此功能添加到我的应用程序（专利问题）？

# mysql - 触发具有已定义值的插入

> ID：13940368
> 
> 赞同：0
> 
> 时间：2012-12-18T19:47:02.677
> 
> 标签：mysql

我是触发器的新手，但我认为我的案例需要代码一：

```
CREATE TABLE `events` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `device_id` varchar(15) DEFAULT NULL,
  `event_type` varchar(15) DEFAULT NULL,
  `event_value` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4987 DEFAULT CHARSET=utf8$$

CREATE TABLE `sequence` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `device_id` varchar(15) DEFAULT NULL,
  `values_sum` varchar(15) DEFAULT NULL,
  `event_value` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4987 DEFAULT CHARSET=utf8$$ 
```

我需要在插入一行事件表时，检查 event_type 是 1 还是 2

如果 1 我需要在第二个表中复制第一个数据并添加每个 1 事件，直到下一次插入 event_type 将是 2..

我不知道怎么做，欢迎任何帮助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:56:30.140

下面是一些示例语法，可以帮助您入门。

您需要弄清楚要在表格的`values_sum`列中存储什么`sequence`。

此外，下面的触发器是将`id`事件表中的值复制到序列表中，如果其他一些进程在表中插入并生成新的 id 值，这将是一个问题（即重复键异常）`sequence`。

```
DELIMITER $$

CREATE TRIGGER `trg_events_ai` 
  AFTER INSERT ON `events`
  FOR EACH ROW
  BEGIN
    IF NEW.event_type = 1 THEN
      INSERT INTO `sequence` (`id`, `device_id`, `values_sum`, `event_value`)
      VALUES NEW.id, NEW.device_id, NULL, NEW.event_value);
    END IF;
  END$$

DELIMITER ; 
```

此示例触发器将在插入事件表后“触发”。对于插入到 event_type 列为 1 的事件表的任何行，此触发器将针对序列表发出相应的 INSERT。应该足以让你开始。

# javascript - Backbone & Underscore 是未定义的，加载的思想

> ID：13940369
> 
> 赞同：2
> 
> 时间：2012-12-18T19:47:04.010
> 
> 标签：javascript, backbone.js, underscore.js

我目前正在尝试学习 BackboneJS 和随之而来的东西，但我无法真正让它发挥作用。我的问题是，一旦我尝试使用 Backbone 对象，我就会遇到麻烦。所以我试图记录他们两个，给予。

```
undefined main.js:23
undefined main.js:24 
```

代码如下。

```
// RequireJS configuration.
require.config({
  paths: {
    // Major dependecies.
    jquery: 'libs/jquery/jquery-1.8.3.min',
    underscore: 'libs/underscore/underscore-min',
    backbone: 'libs/backbone/backbone-min',

    // Template dir.
    templates: '../templates'
  },

  // Append query string, to avoid browser caching, while in dev.
  urlArgs: "bust=" +  (new Date()).getTime()
});

// Start application.
require([
  'underscore',
  'backbone'
//  'router'
], function(_, backbone) {
  console.log(backbone);
  console.log(_);
//  Router.initialize();
}); 
```

如您所见，我尝试在路由器中使用 Backbone 对象，但没有成功。然后我尝试了我的 main.js，同样的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:51:31.737

您需要使用 require shim，因为 Backbone 和 Underscore 不支持 AMD 开箱即用。

require shim 允许您加载非 AMD 模块（请参阅[此处](http://gregfranko.com/blog/require-dot-js-2-dot-0-shim-configuration/)）。请注意，`exports`对象是将用作模块的对象的名称。

```
paths: {
      // Major dependecies.
      jquery: 'libs/jquery/jquery-1.8.3.min',
      underscore: 'libs/underscore/underscore-min',
      backbone: 'libs/backbone/backbone-min',

      // Template dir.
      templates: '../templates'
},
shim: {
    backbone: {
        deps: ["underscore", "jquery"],
        exports: "Backbone"
    },

    underscore: {
        exports: "_"
    }
} 
```

另一种方法是将脚本直接包含在您的 HTML 中。

```
<script src="libs/jquery/jquery.js"></script>
<script src="libs/underscore/underscore.js"></script>
<script src="libs/backbone/backbone.js"></script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T19:51:27.557

就我个人而言，我发现将 Backbone（以及下划线和 jQuery）从 Require 中移除要容易*得多。*您可以以正常方式（通过脚本标签）加载它们，然后在此之后执行所有 Require 加载，一切都会完美运行。您将拥有一些全局变量（$、_ 和 Backbone），但除此之外，我现在发现这种方法的缺点。

或者，您可以浪费大量时间玩 shims 之类的东西来正确地将 Backbone 带入 Require-land ...但是如果您不必这样做，为什么还要浪费时间呢？另外，如果你这样做，你必须在你拥有的每个文件的定义调用中包含 jQuery/Backbone/Underscore，这有点浪费时间/精力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:53:07.727

我怀疑这是您通过 require.js 引用文件的方式的错误（或者骨干不能很好地与 require 配合使用）。检查浏览器的开发人员工具并确保您确实在下载文件。“控制台”或“网络”选项卡应指示您是否成功获取文件（HTTP 代码 200），或者它没有找到它们（HTTP 代码 404），或者它甚至没有尝试（“网络”中没有行完全）。

此外，尝试将 require.js 完全排除在循环之外，并使用标准`<script>`标签将文件直接加载到页面上。这样您就知道您的文件和变量按预期工作。

# haskell - 尾递归是否一定需要累加器？

> ID：13940377
> 
> 赞同：9
> 
> 时间：2012-12-18T19:47:13.800
> 
> 标签：haskell, recursion, tail-recursion

例如，由于下面的函数没有累加器，它仍然是尾递归的吗？

```
belong:: (Ord a) => a -> [a] -> Bool
belong a [] = False
belong a (h:t) 
    | a == h = True
    | otherwise = belong a t 
```

函数中的所有计算都是在递归调用之前处理的，是否认为是尾递归的充分条件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T19:50:56.533

尾递归不一定需要累加器。累加器用于尾递归，作为通过递归调用链向下传递部分结果的一种方式，而无需在递归的每个级别使用额外的空间。例如，规范尾递归阶乘函数需要一个累加器来传播到目前为止建立的部分乘积。但是，如果您不需要从递归调用向下传递任何信息到其子调用，则不需要累加器。

您提供的函数确实是尾递归的，但它不需要或使用累加器。在列表中搜索元素时，递归不需要记住到目前为止它查看的所有元素都不等于正在搜索的特定元素。它只需要知道要查找的元素和要搜索的列表。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:51:22.360

[尾递归](http://en.wikipedia.org/wiki/Tail_call)不一定需要累加器。但是，经常使用蓄能器。提示，在维基百科文章中搜索“累加器”。

# .net - URL 中的百分比编码字符会导致浏览器出错

> ID：13940381
> 
> 赞同：0
> 
> 时间：2012-12-18T19:47:32.333
> 
> 标签：.net, html, url-encoding, idn

我遇到了包含特殊字符的 URL 的问题。如果我使用，呈现的 HTML`NavigateUrl='Eval("website")'`是这样的：

```
<a href="http://www.v%c3%a4rnamo.nu">www.värnamo.nu</a> 
```

如果我尝试像这样对其进行编码，`NavigateUrl='<%# HttpUtility.HtmlEncode(Eval("website")) %>'`我会得到这个输出，这也不起作用。

```
<a href="http://www.v&/"288;rnamo.nu">www.värnamo.nu</a> 
```

我尝试将元标记中的字符集设置为`UTF-8`and `iso-8859-1`，但没有帮助，我认为这也与此无关。

尝试单击此链接：[http://www.v%c3%a4rnamo.nu](http://www.v%c3%a4rnamo.nu)，您将得到相同的响应。

还有什么我可以尝试的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:52:57.227

您可以尝试 punycode，它提供[http://www.xn--vrnamo-bua.nu](http://www.xn--vrnamo-bua.nu)。我使用[http://www.charset.org/punycode.php](http://www.charset.org/punycode.php)制作了这个，它声称提供 PHP 代码来进行这种转换，如果有帮助的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:57:55.747

尝试使用`HttpUtility.HtmlDecode(Eval("website"))`而不是`HtmlEncode`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:16:50.453

我现在真的让这个工作了。我在这个[LINK使用了代码](http://blog.tjitjing.com/index.php/2008/06/punycode-in-vbnet-for-idn-domains.html)

在我的 aspx 页面中，我在 NavigateUrl 属性中使用它：

```
NavigateUrl='<%# idnMapping(Convert.ToString(Eval("website"))) %>' 
```

调用函数：

```
public static string idnMapping(string text) {
    System.Globalization.IdnMapping idn = new System.Globalization.IdnMapping();
    return idn.GetAscii(text);
} 
```

现在当我查看我看到的 html

```
<a href="http://xn--vrnamo-bua.nu">www.värnamo.nu</a> 
```

单击此链接将正确打开页面。

# regex - 与主页/索引页面匹配的 URL 的正则表达式

> ID：13940386
> 
> 赞同：1
> 
> 时间：2012-12-18T19:47:47.453
> 
> 标签：regex, url

我正在尝试提出一个正则表达式，该表达式将指示提供的 url 是否是网站的索引页面。这意味着它必须匹配 domain.com、domain.com/ 和 domain.com/index.php 而不是 domain.com/page.php

这是我想出的用于测试的列表。由于 www/nonwww、http/https、斜杠等导致的排列如此之多。

它应该匹配这些：

*   [http://site.com/index.php](http://site.com/index.php)
*   [http://site.com/](http://site.com/)
*   [http://site.com](http://site.com)
*   [http://site.com/index.php?var=X](http://site.com/index.php?var=X)
*   [http://site.com/?var=X](http://site.com/?var=X)
*   [http://site.com?var=X](http://site.com?var=X)
*   [https://site.com/index.php](https://site.com/index.php)
*   [https://site.com/](https://site.com/)
*   [https://site.com](https://site.com)
*   [https://site.com/index.php?var=X](https://site.com/index.php?var=X)
*   [https://site.com/?var=X](https://site.com/?var=X)
*   [https://site.com?var=X](https://site.com?var=X)
*   [http://www.site.com/index.php](http://www.site.com/index.php)
*   [http://www.site.com/](http://www.site.com/)
*   [http://www.site.com](http://www.site.com)
*   [http://www.site.com/index.php?var=X](http://www.site.com/index.php?var=X)
*   [http://www.site.com/?var=X](http://www.site.com/?var=X)
*   [http://www.site.com?var=X](http://www.site.com?var=X)
*   [https://www.site.com/index.php](https://www.site.com/index.php)
*   [https://www.site.com/](https://www.site.com/)
*   [https://www.site.com](https://www.site.com)
*   [https://www.site.com/index.php?var=X](https://www.site.com/index.php?var=X)
*   [https://www.site.com/?var=X](https://www.site.com/?var=X)
*   [https://www.site.com?var=X](https://www.site.com?var=X)

它不应该匹配这些

*   [http://site.com/page.php](http://site.com/page.php)
*   [http://site.com/page.php?var=X](http://site.com/page.php?var=X)
*   [http://site.com/page](http://site.com/page)
*   [http://site.com/page/](http://site.com/page/)
*   [http://site.com/page/index.php](http://site.com/page/index.php)
*   [http://site.com/page?var=X](http://site.com/page?var=X)
*   [http://site.com/page/?var=X](http://site.com/page/?var=X)
*   [https://site.com/page.php](https://site.com/page.php)
*   [https://site.com/page.php?var=X](https://site.com/page.php?var=X)
*   [https://site.com/page](https://site.com/page)
*   [https://site.com/page/](https://site.com/page/)
*   [https://site.com/page/index.php](https://site.com/page/index.php)
*   [https://site.com/page?var=X](https://site.com/page?var=X)
*   [https://site.com/page/?var=X](https://site.com/page/?var=X)
*   [http://www.site.com/page.php](http://www.site.com/page.php)
*   [http://www.site.com/page.php?var=X](http://www.site.com/page.php?var=X)
*   [http://www.site.com/page](http://www.site.com/page)
*   [http://www.site.com/page/](http://www.site.com/page/)
*   [http://www.site.com/page/index.php](http://www.site.com/page/index.php)
*   [http://www.site.com/page?var=X](http://www.site.com/page?var=X)
*   [http://www.site.com/page/?var=X](http://www.site.com/page/?var=X)
*   [https://www.site.com/page.php](https://www.site.com/page.php)
*   [https://www.site.com/page.php?var=X](https://www.site.com/page.php?var=X)
*   [https://www.site.com/page](https://www.site.com/page)
*   [https://www.site.com/page/](https://www.site.com/page/)
*   [https://www.site.com/page/index.php](https://www.site.com/page/index.php)
*   [https://www.site.com/page?var=X](https://www.site.com/page?var=X)
*   [https://www.site.com/page/?var=X](https://www.site.com/page/?var=X)

（还有其他我遗漏的组合吗？？）

到目前为止，我想出的是：

> site.com(/|index.php|)

这显然是不正确的，因为它也匹配 /page 值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T19:53:13.750

这**有效**

```
^https?://[^/]+(/(\?.*|index\.php(\?.*)?)?)?$ 
```

请注意，这是一个通用的正则表达式。为了符合您的口味，您可能需要逃跑。

在这里运行一个简单的测试后，`egrep`结果是

```
$ while read x 
>       do 
>           if  echo $x | egrep '^https?://[^/]+(/(\?.*|index\.php(\?.*)?)?)?$' > /dev/null
>           then  
>               echo MATCH $x
>           else 
>               echo NOT MATCH $x 
>           fi
>       done < data
MATCH http://site.com/index.php
MATCH http://site.com/
MATCH http://site.com
MATCH http://site.com/index.php?var=X
MATCH http://site.com/?var=X
MATCH http://site.com?var=X
MATCH https://site.com/index.php
MATCH https://site.com/
MATCH https://site.com
MATCH https://site.com/index.php?var=X
MATCH https://site.com/?var=X
MATCH https://site.com?var=X
MATCH http://www.site.com/index.php
MATCH http://www.site.com/
MATCH http://www.site.com
MATCH http://www.site.com/index.php?var=X
MATCH http://www.site.com/?var=X
MATCH http://www.site.com?var=X
MATCH https://www.site.com/index.php
MATCH https://www.site.com/
MATCH https://www.site.com
MATCH https://www.site.com/index.php?var=X
MATCH https://www.site.com/?var=X
MATCH https://www.site.com?var=X
NOT MATCH http://site.com/page.php
NOT MATCH http://site.com/page.php?var=X
NOT MATCH http://site.com/page
NOT MATCH http://site.com/page/
NOT MATCH http://site.com/page/index.php
NOT MATCH http://site.com/page?var=X
NOT MATCH http://site.com/page/?var=X
NOT MATCH https://site.com/page.php
NOT MATCH https://site.com/page.php?var=X
NOT MATCH https://site.com/page
NOT MATCH https://site.com/page/
NOT MATCH https://site.com/page/index.php
NOT MATCH https://site.com/page?var=X
NOT MATCH https://site.com/page/?var=X
NOT MATCH http://www.site.com/page.php
NOT MATCH http://www.site.com/page.php?var=X
NOT MATCH http://www.site.com/page
NOT MATCH http://www.site.com/page/
NOT MATCH http://www.site.com/page/index.php
NOT MATCH http://www.site.com/page?var=X
NOT MATCH http://www.site.com/page/?var=X
NOT MATCH https://www.site.com/page.php
NOT MATCH https://www.site.com/page.php?var=X
NOT MATCH https://www.site.com/page
NOT MATCH https://www.site.com/page/
NOT MATCH https://www.site.com/page/index.php
NOT MATCH https://www.site.com/page?var=X
NOT MATCH https://www.site.com/page/?var=X 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:12:41.927

假设您在 PHP 中执行此操作。您应该使用`parse_url()`(http://php.net/manual/en/function.parse-url.php) 然后查看路径元素。

```
<?php
$url = "http://example.com/index.php?page=1";
$path = parse_url($url, PHP_URL_PATH);
print "path=$path\n";
?> 
```

运行它，你得到

```
path=/index.php 
```

一旦你有了 in 中的路径`$path`，就只是匹配到`/`or`/index.php`或其他什么的问题。不需要正则表达式。

# c# - 如何使用 Ninject 扫描泛型类型的所有实现

> ID：13940390
> 
> 赞同：5
> 
> 时间：2012-12-18T19:48:07.660
> 
> 标签：c#, ninject

我们正在使用领域事件模式并依靠我们的 IoC 容器来定位特定类型事件的处理程序：

```
public interface IHandleEvent<TEvent> where TEvent : IEvent
{
    void Handle(TEvent evnt);
} 
```

使用 StructureMap 我们可以扫描并注册所有实现上述接口的类型，如下所示：

```
Scan(cfg =>
{
    cfg.TheCallingAssembly();
    cfg.ConnectImplementationsToTypesClosing(typeof(IHandleEvent<>));
}); 
```

Ninject 有没有等价物？

目前我必须像这样单独绑定每个处理程序：

```
kernel.Bind<IHandleEvent<SomeEvent>>().To<EventHandler1>();
kernel.Bind<IHandleEvent<SomeEvent>>().To<EventHandler2>();
kernel.Bind<IHandleEvent<SomeOtherEvent>>().To<EventHandler3>(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T13:46:50.530

Ninject Conventions Extensions 包正是我所需要的。工作代码如下：

```
kernel.Bind(x => x
    .FromThisAssembly()
    .SelectAllClasses().InheritedFrom(typeof(IHandleEvent<>))
    .BindSingleInterface()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-18T20:47:43.500

尝试[Ninject 约定扩展](https://github.com/ninject/ninject.extensions.conventions)。它为 Ninject 提供了一个约定俗成的配置。wiki 中有相当不错的文档。

# apache - 端口转发出现问题

> ID：13940391
> 
> 赞同：0
> 
> 时间：2012-12-18T19:48:13.587
> 
> 标签：apache, networking, webserver, portforwarding

我试图在我的电脑上的 8888 端口上运行一个眩晕服务器（HTTP Web 服务器），但我一直失败。我使用 TCPView 程序来查看我在此端口上是否有活动，结果是否定的。这个端口是免费使用的。但不知何故，眩晕说相反。在图片中，消息是关于端口 80 的，但我确定将其正确更改（我在其他电脑上做过很多次）到 8888。

![在此处输入图像描述](../Images/a1c8993ed2793af9163350700ab5ce96.png)

我也尝试禁用防火墙，结果是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T11:32:51.930

您使用的是什么版本的 VertrigoServ？我在 2.29 版遇到了同样的问题，但回滚到[2.28 版](http://sourceforge.net/projects/vertrigo/files/VertrigoServ/2.28/Vertrigo_228.exe/download)解决了我的问题。

# sql - 将多行中的值汇总为一行

> ID：13940397
> 
> 赞同：14
> 
> 时间：2012-12-18T19:48:38.437
> 
> 标签：sql, sql-server, tsql, sql-server-2012

在 SQL Server 2012 中，我有一个包含和`my_table`列的表。`state, month, ID``sales`

我的目标是将具有相同内容的不同行合并`state, month, ID`为一行，同时将`sales`这些选定行的列汇总到合并行中。

例如：

```
state    month    ID    sales
-------------------------------
FL       June     0001   12,000
FL       June     0001    6,000
FL       June     0001    3,000
FL       July     0001    6,000
FL       July     0001    4,000  
TX       January  0050    1,000
MI       April    0032    5,000
MI       April    0032    8,000
CA       April    0032    2,000 
```

这是我应该得到的

```
state    month    ID    sales
-------------------------------
FL       June     0001   21,000
FL       July     0001   10,000  
TX       January  0050    1,000
MI       April    0032   13,000
CA       April    0032    2,000 
```

我做了一些研究，发现自我加入应该做一些类似于我应该得到的事情。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-18T19:51:40.677

除非我在要求中遗漏了一些东西，否则为什么不直接使用带有 a 的聚合函数`GROUP BY`：

```
select state, month, id, sum(sales) Total
from yourtable
group by state, month, id
order by id 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!6/fd49e/4)

结果是：

```
| STATE |   MONTH | ID | TOTAL |
--------------------------------
|    FL |    July |  1 | 10000 |
|    FL |    June |  1 | 21000 |
|    CA |   April | 32 |  2000 |
|    MI |   April | 32 | 13000 |
|    TX | January | 50 |  1000 | 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T18:01:05.647

考虑到 column 应该有一个索引`id`，这个查询将是一个更好的解决方案：

```
select state, month, id, sum(sales) Total
from yourtable
group by id, state, month
order by id 
```

# cakephp - CakePHP - FormHelper 和 DATETIME 字段 UI

> ID：13940402
> 
> 赞同：0
> 
> 时间：2012-12-18T19:48:56.830
> 
> 标签：cakephp, user-interface

CakePHP FormHelper 非常有用地为输入表单中的 DATETIME 字段设置了许多选择框，从而可以选择精确的 DATETIME。但是，就质量用户界面而言，它并没有真正为我做这件事。

有没有办法让这个看起来更漂亮，更容易操作？而不是选择 5 个选择字段？也许像内置的时间选择器工具之类的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:09:08.333

您可以使用`'type' => 'text'`输入，然后添加您喜欢的任何 javascript 日期选择器。谷歌上有数百个。快速搜索，您应该立即拥有一个。

# memcached - 将所有 memcached 密钥转储到文件中的最简单方法是什么？

> ID：13940404
> 
> 赞同：16
> 
> 时间：2012-12-18T19:49:21.917
> 
> 标签：memcached

这仅来自具有大约 20M 键（没有过期）和大约 2G 数据的单个 memcached 服务器。

将所有键/值对转储到平面文件中的最简单方法是什么？我首先查看了 java net.spy.memcached.MemcachedClient，但是这个客户端不支持获取所有密钥（我认为）。如果我有一个所有键的列表（我没有），我可以很容易地使用这个客户端来获取所有的值。

我知道我可以使用一些 telnet 命令（例如 telnet localhost 11211; stats items; stats cachedump ）获取所有密钥，但我不清楚如何稳健地自动化这个。

编辑：这是我在我的机器上的玩具 memcached 服务器上所做的工作。它似乎有效，但我只在 memcached 中放了两个键，所以希望这种方法可以正常扩展：

外壳命令：

```
sudo yum install memcached
sudo /etc/init.d/memcached restart # maybe unnecessary
sudo yum install php
sudo yum install php-pecl-memcache
sudo service httpd reload 
```

php 脚本，基于[此](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html)：

```
<?php
$memcache = new Memcache();
$memcache->connect('127.0.0.1', 11211) or die ("Could not connect");
$list = array();
$allSlabs = $memcache->getExtendedStats('slabs');
$items = $memcache->getExtendedStats('items');
foreach($allSlabs as $server => $slabs) {
    foreach($slabs AS $slabId => $slabMeta) {
        if (!is_int($slabId)) {
            continue;
        }
        $cdump = $memcache->getExtendedStats('cachedump', (int) $slabId, 100000000);
        foreach($cdump AS $server => $entries) {
            if ($entries) {
                foreach($entries AS $eName => $eData) {
                    print_r($eName);
                    print_r(":");
                    $val = $memcache->get($eName);
                    print_r($val);
                    print_r("\n");
                }
            }
        }
    }
}
?> 
```

EDIT2：上面的脚本似乎没有返回所有的映射。如果我插入该行`count($entries)`，即使将限制参数设置为 100M，它也只返回 50k 多一点，但从`stats items`telnet 执行显示超过 5M 条目。有谁知道为什么会这样？

EDIT3：此[链接](http://code.google.com/p/memcached/wiki/NewProgrammingFAQ)表明 cachedump 不会从 memcached 获取所有密钥。我已经达到了大约 50k 键的限制，这些键由 cachedump、此 PHP 脚本或类似于 Zach Bonham 提供的链接中的一个 perl 脚本返回。有没有办法解决？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-18T21:21:44.967

*免责声明：我不知道我在做什么，只是听起来像一个有趣的问题。*

你看到这篇文章了吗？ [Lars Windolf 的“如何从 Memcache 中转储密钥”](https://lzone.de/blog/How-to%20Dump%20Keys%20from%20Memcache)。

来自文章：

> Memcache 本身提供了进入数据峰值的方法。该协议提供了命令以使按平板组织的数据达到峰值（给定大小范围的数据类别。但存在一些重大限制：
> 
> *   您只能转储每个平板类的密钥（内容大小大致相同的密钥）
> *   每个slab类只能转储一页（1MB数据）
> *   这是一项非官方功能，可能随时会被删除。

实际上，它需要一些关于 memcache 如何在内存中存储数据的知识（我没有）。您需要找到每个“板”，然后您可以转储该板的键，然后最终转储这些键的值。

文章中有一个工具部分，它使用各种语言至少转储键，但只有 perl 脚本转储键和值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-09T18:01:21.750

### 关注

这是我用来将所有对象转储到相应文件中的脚本：

```
while read -r key; do
    [ -f "$key" ] || echo "get $key" | nc localhost 11211 > "$key.dump";
done < <(memcdump --server localhost) 
```

它使用`memcdump`的命令应该是 memcached utils 的一部分。

对于压缩对象，请参阅：[如何从 Memcache 转储给定键的压缩对象？](https://stackoverflow.com/q/49077688/55075)

### 内存转储

要从服务器转储密钥列表，请使用`memcdump`/`memdump`工具，例如

```
memcdump --servers=localhost | tee my_keys.lst 
```

要打印一项的值，请使用`netcat`：

```
echo "get 13456_-cache-some_object" | nc localhost 11211 
```

通过`memcdump`/`memdump`和将所有对象转储到屏幕中`netcat`：

```
memcdump --servers=localhost | xargs -L1 -I% sh -c 'echo "get %" | nc localhost 11211' 
```

### 内存缓存工具

在最新版本中`memcached`还有**`memcached-tool`**命令，例如

```
memcached-tool localhost:11211 dump | less # dumps keys and values 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-14T07:29:08.517

平板转储的硬编码限制为 2MB。除非您重写 do_item_cachedump，否则您将无法取出所有密钥。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-23T13:59:07.680

我使用了这个 bash 脚本

```
#!/bin/sh
MESSAGE=`memdump --servers="127.0.0.1"`
while read -r line; do
    echo $line
    VALUE=`echo "get $line" | nc 127.0.0.1 11211`
    echo $VALUE
done <<< "$MESSAGE" 
```

如有必要，只需更换 IP / 端口

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-25T09:24:41.300

### 重击

使用 Bash 并保存到文件中：

```
exec {memcache}<>/dev/tcp/localhost/11211
printf "stats items\nquit\n" >&${memcache}
cat <&${memcache} > myfile.txt 
```

相关：[用纯 bash 编写 Redis 客户端](http://milhouseonsoftware.com/2015/07/27/writing-a-redis-client-in-pure-bash-part-1/)（它是 Redis，但方法非常相似）

# mongodb - MongoDB空查询异常

> ID：13940405
> 
> 赞同：2
> 
> 时间：2012-12-18T19:49:26.677
> 
> 标签：mongodb

查看以下查询：

```
 db.models.findOne({ "value.userId": { $ne: null } }, { "value.userId":1}).value.userId == null 
```

这说：

1.  查找具有非空用户 ID 字段的记录
2.  在结果中返回用户 ID
3.  将该值与 null 进行比较

由于我们只返回没有 null 值的记录，因此将结果与 null 进行比较应该总是返回 false。但是，这*始终*返回 true。

如果我只是执行 .findOne(...) 并打印它而不是进行比较，我会得到：

```
{ "_id": 4, "value": { "userId": null } 
```

有人知道这里发生了什么吗？

编辑：该字段的“类型”显然是 6 - 而不是 10，这*应该*是 null。EDIT2：显然类型 6 是“未定义” - 不知道为什么它打印空......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:39:05.343

这里的问题是当您尝试打印一个`undefined`值时，MongoDB 会打印`null`而不是向您发出错误。

看这个例子： -

```
> db.foo.save({"amount": undefined})
> db.foo.find({"amount": {$ne: null}})
{ "_id" : ObjectId("50d0d3a1511dd1035f01c636"), "amount" : null } 
```

因此，正如您所说， is 的类型`userId`是`6`for `undefined`，所以它会打印`null`。此外，它是`$ne: null`，所以它也匹配。

请参阅此链接： -http: [//realprogrammer.wordpress.com/2012/11/04/null-undefined-nan-and-missing-property-goto-considered-harmful-part-2/](http://realprogrammer.wordpress.com/2012/11/04/null-undefined-nan-and-missing-property-goto-considered-harmful-part-2/)

* * *

但是，如果您看到与 相同的行为`null`，您将获得所需的结果：-

```
> db.foo.save({"amount": null})
> db.foo.findOne({"amount": {$ne: null}}) 
null 
```

# c# - 我可以在同一个程序中运行多个 sqldependency 实例吗

> ID：13940406
> 
> 赞同：2
> 
> 时间：2012-12-18T19:49:42.587
> 
> 标签：c#, multithreading, sqldependency

我有两个线程，每个线程都针对同一数据库上的不同表运行 sql 依赖项。单独地，两个监听器工作正常，当我同时运行它们时，只有一个监听器工作。有什么想法吗？谢谢！

# visual-studio-2010 - 添加 Web 参考 阅读并生成文档

> ID：13940412
> 
> 赞同：0
> 
> 时间：2012-12-18T19:49:55.427
> 
> 标签：visual-studio-2010, soap, wsdl.exe

Visual Studio 2010 中是否有会为生成的代理代码生成注释的设置？

例如，我有一个带有以下内容的 SOAP Web 服务：

```
<s:complexContent> -<s:extension base="s0:Criteria"> -<s:sequence> -<s:element name="GroupId" type="s:long" minOccurs="0"> -<s:annotation> <s:documentation>Unique group identifier. Can be used to get a specific group and/or a list of users for a group</s:documentation> </s:annotation> </s:element> -<s:element name="GroupName" type="s:string" minOccurs="0"> -<s:annotation> <s:documentation>Name of the group to find</s:documentation> </s:annotation> </s:element> </s:sequence> </s:extension> </s:complexContent> </s:complexType> 
```

这包含**注释**和**文档**元素，但它们的内容未在 Visual Studio 2010 中导入或使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:24:11.030

ASMX Web 服务没有此功能。

另请注意，ASMX 是一项遗留技术，所有新开发都应使用 WCF。

# c# - 滚动时保持菜单项固定，而不是之前

> ID：13940417
> 
> 赞同：1
> 
> 时间：2012-12-18T19:50:24.817
> 
> 标签：c#, javascript, asp.net, .net, webforms

我在 JavaScript 中查找了多个示例。但结果仍然是负面的。这是情况。

我有一个有顶部导航的网站。根据按下的导航按钮，左侧的菜单会出现在页面上，其中包含更多选项。

例子：你有`Home | Products | Crew | About`

用户单击“产品”，它会打开一个新页面，左侧显示一个菜单

```
Desktops
Laptops
Notebooks
eReaders
Mp3 Players
Tablets
Phones 
```

当用户完全向上滚动到顶部时，我希望左侧的菜单距离顶部大约 420 像素。当他向下滚动时，它将滚动到顶部。一旦它到达显示页面的顶部，它就会固定在顶部位置。

顶部的导航栏被硬编码到母版页中。左侧的菜单是母版页中的 ContentPlaceHolder，内容会根据正在查看的页面而变化。

我尝试使用 JavaScript 代码：

```
<script type="text/javascript">
    $(document).on('scroll', function () {
        if ($('#bar')[0].offsetTop < $(document).scrollTop()) {
            $("#bar").css({ position: "fixed", top: 0 });
        }
        if ($(document).scrollTop() < $("#position-saver")[0].offsetTop) {
            $("#bar").css({ position: "static", top: 0 });
        }
    });
</script> 
```

但它不起作用。我不知道为什么。这是母版页代码。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.Master.cs" Inherits="StasisGamerLounge.Site1" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">`
    <meta charset="utf-8" />
    <title>Stasis Gamer Group - <%: Page.Title %></title>
    <asp:PlaceHolder ID="PlaceHolder1" runat="server">     
          <%: Scripts.Render("~/bundles/modernizr") %>
    </asp:PlaceHolder>  
    <webopt:BundleReference ID="BundleReference1" runat="server" Path="~/Content/css" /> 
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta name="viewport" content="width=device-width" />
    <asp:ContentPlaceHolder runat="server" ID="HeadContent" />
    <script type="text/javascript">
        $(document).on('scroll', function () {
            if ($('#bar')[0].offsetTop < $(document).scrollTop()) {
                $("#bar").css({ position: "fixed", top: 0 });
            }
            if ($(document).scrollTop() < $("#position-saver")[0].offsetTop) {
                $("#bar").css({ position: "static", top: 0 });
            }
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
        <div class="float_right">
        <section id="login">
                    <asp:LoginView ID="LoginView1" runat="server" ViewStateMode="Disabled">
                        <AnonymousTemplate>
                                <a id="registerLink" runat="server" href="~/Account/Register.aspx">Register </a> | 
                                <a id="loginLink" runat="server" href="~/Account/Login.aspx"> Log in</a>
                                <br />
                        </AnonymousTemplate>
                        <LoggedInTemplate>
                        <p>
                            Greetings, <a id="A1" runat="server" class="username" href="~/Account/Manage.aspx" title="Manage your account">
                                <asp:LoginName ID="LoginName1" runat="server" CssClass="username" /></a>!
                            <asp:LoginStatus ID="LoginStatus1" runat="server" LogoutAction="Redirect" LogoutText="Log off" LogoutPageUrl="~/" />
                        </p>
                    </LoggedInTemplate>
                </asp:LoginView>
            </section>
        </div>
    <div class="bodywrapper">
        <div class="logo">
        </div>
        <div class="header">
        </div>
        <div class="topnav">
            <ul id="navbar">
                <li><asp:HyperLink runat="server" ID="home" NavigateUrl="~/Default.aspx">Home</asp:HyperLink></li>
                <li><asp:HyperLink runat="server" ID="games" NavigateUrl="~/Games.aspx">Games</asp:HyperLink></li>
               <% if (Page.User.Identity.IsAuthenticated ) { %> <li><asp:HyperLink runat="server" ID="myFiles" NavigateUrl="~/Drive.aspx">My Files</asp:HyperLink></li>
                <li><asp:HyperLink runat="server" ID="events" NavigateUrl="~/Events.aspx">Events</asp:HyperLink></li> <% } %>
                <li><asp:HyperLink runat="server" ID="about" NavigateUrl="~/About.aspx">About</asp:HyperLink></li>                    
            </ul>
        </div>
        <div class="contentwrapper">
        <div class="leftMenu" id="bar">
            <h3>Menu</h3>
            <asp:ContentPlaceHolder ID="MenuContent" runat="server">

            </asp:ContentPlaceHolder>
        </div>` 
```

我把 Javascript 放错了，还是这里发生了什么？在 ASP.Net 中是否有不同的方法来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:13:13.857

这是一个基本的通用实现：http: [//jsfiddle.net/SwHqk/](http://jsfiddle.net/SwHqk/)

我注意到您使用的是 jQuery，所以为了简单起见，我使用了它。

```
$(window).scroll(function(e){
    var top = $(window).scrollTop();

    if (top > 200) // this would be the "normal" position of the menu
        $("#floating-box").addClass("fixed");
    else
        $("#floating-box").removeClass("fixed");
});​ 
```

CSS（提炼到重要的部分）

```
#floating-box{
    margin-top:200px;
    position:absolute;
    margin-left:5px;
}
#floating-box.fixed{
    position:fixed;
    top:0;
    margin-top:5px; /* you could use top instead of margin-top for both stationary/fixed */
} 
```

# c# - 敌人碰撞检测

> ID：13940420
> 
> 赞同：-2
> 
> 时间：2012-12-18T19:50:36.760
> 
> 标签：c#, collision

使用这些变量，我将如何将 pacman 与 munchie 碰撞？我已经有了动作，而且它确实发送的天花板必须得到代码，更像是解释我必须做什么。

```
Pacman variables
private Point frameSize = new Point(32, 32);    // Pacman image size
private Point currentFrame = new Point(1, 0);   // Start frame
private Point sheetSize = new Point(2, 4);      // Spritesheet size
private Vector2 pacmanPos;                      // Pacman position in pixels
private int pacmanSpeed = 8;                    // Pacman movement speed in pixels

// Game
SpriteBatch spriteBatch;
Texture2D munchie1, munchie2, pacman;

// Sounds
SoundEffect collisionSound;

// Random number generator
Random rand = new Random();

// Total number of munchies 
private int noOfMunchies = 5;

Vector2[] munchiePos;
private int munchieSize;
private int[] munchieAnimationCount;

private int timeSinceLastFrame = 0;
private int milliSecondsPerFrame = 500; // 2 Frames Per Second (fps) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:01:07.983

既然你已经定义了`munchieSize`但`pacmanSize`我想你正在考虑你的演员一个点。在这种情况下，假设 pacman 和 munchies 的坐标是相对于同一个系统的，如果 pacman 的位置向量包含在任何 munchies 的边界框中，则在每一帧或碰撞测试迭代中检查就足够了。

您可以这样做，考虑到我的代码只是一个参考，您应该使用自己的类型来实现结果。

```
var munchies = new PointF[5];
const int munchySize = 10;
var pacmanPos = new PointF();
var collidesWith = munchies.
    Where(m => new RectangleF(m, new SizeF(munchySize, munchySize)).Contains(pacmanPos));
var collisionHappened = collidesWith.Any(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:57:59.077

天真地；

```
foreach mPos in munchiePos
{
    if (pacmanPos == mPos )
    {
        // Collision
    }
} 
```

您可能还想添加为每个 pacman 和 munchie 绘制的“字符”的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:23:30.893

顺便说一句，您可能需要考虑将代码结构化为类，这样可以更清晰、更容易使用。
如果您不确定如何执行此操作，请考虑以下教程：[MSDN Tutorial on Classes](http://msdn.microsoft.com/en-us/library/vstudio/x9afc042.aspx)。
这向您展示了在代码中使用类的核心概念，甚至可能向您介绍面向对象的编程（如果这是第一次使用 OO 编程）。

# jquery - 如何让 jQueryUI 拖放与触摸设备一起工作

> ID：13940421
> 
> 赞同：42
> 
> 时间：2012-12-18T19:50:47.837
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-droppable

这是我希望有人回复告诉我我是个白痴的一种情况。但我仍然对 jQueryUI 拖放无法在触摸设备上使用感到惊讶。我还没有测试过它们，但我在去年尝试过 iphone\ipad\android 2、3&4 并且什么都没有。刚刚在新的 Android 上尝试了最新版本。依然没有。不信，只需访问移动设备上的演示页面并尝试使用拖放示例。没有。

这里是否存在技术问题或核心不兼容？一个如此简单以至于不值得写的修复？jQuery 开发人员不使用移动设备吗？我在 Stack Overflow 周围到处都看到过“修复”，但它们都是“黑客”，我尝试过的所有方法都不起作用。

我很困惑。有人可以阐明这个问题吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-12-18T20:06:00.130

如果您只想让当前的 jQuery UI 代码处理触摸事件，您可以使用[jQuery UI Touch Punch](https://github.com/furf/jquery-ui-touch-punch)猴子补丁。

唯一的“技术问题或核心不兼容”是 jQuery UI [(1.x)](https://stackoverflow.com/questions/13940421/how-to-get-jqueryui-drag-drop-working-with-touch-devices#13940713)仅侦听鼠标事件，而不是触摸事件（有关历史原因，请参阅 @ScottGonzales 的响应）。上面的 jQuery touch punch 做出了这种改变。您甚至可以尝试该页面上的一些 jQuery UI 示例，它们都可以工作。通常，使用触控打孔是目前公认的解决方案。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-12-18T20:11:15.870

jQuery UI 不支持触​​摸设备的原因由来已久，但归结为 Touch Event 是一个非标准的 WebKit 特定实现。当时，未来看起来很凄凉。苹果拥有无人愿意接近的专利；结果，Mozilla 使用从未流行的流实现了自己的触摸事件系统。目前尚不清楚微软和 Opera 会做什么。Paul Bakaus（jQuery UI 的创建者）[希望在 4 年前获得对 iPhone 的支持](http://bugs.jqueryui.com/ticket/4143)。我想等待官方标准。

时间过去了，Mozilla 放弃了他们的触摸事件，微软实现了他们自己的指针事件系统。W3C 成立了一个工作组来标准化触控事件并调查 Apple 专利。触摸事件工作组已发布建议并解散。微软最终提交了一个标准化指针事件的提案，现在有一个 W3C 指针事件工作组。

我们目前正在对所有 jQuery UI 交互进行与[设备无关的重写](https://github.com/jquery/jquery-ui/blob/interactions/ui/jquery.ui.interaction.js)，这将成为 jQuery UI 2.0 的一部分。在此之前，您可以使用[jQuery UI Touch Punch](http://touchpunch.furf.com/)。

今年早些时候，我写了一些关于触控事件的历史，以及为什么指针事件提供了一个更美好的未来。[您可以在jQuery 博客](http://blog.jquery.com/2012/04/10/getting-touchy-about-patents/)上了解它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:59:34.370

查看[jQTouch](http://www.jqtouch.com/)

它是一个 jQuery 插件，有助于弥合桌面和触摸设备之间的事件差距。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-10T05:06:13.490

使用 jQuery UI Touch Punch 似乎是最好的方法。

```
<script src="../jquery-ui-1.13.0/external/jquery/jquery.js"></script>
<script src="../jquery-ui-1.13.0.custom/jquery-ui.min.js"></script>
<script src="../jquery-ui-1.13.0/jquery-ui.min.js"></script>
<script src="../jquery-ui-touch-punch/jquery.ui.touch-punch.min.js"></script>

<link href="../bootstrap-5.1.1/css/bootstrap.min.css" rel="stylesheet" />

<script>
    $(function () {
        $("#sortable").sortable();
    });
</script>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <ul id="sortable" class="list-group">
                <li class="list-group-item active">Item 1</li>
                <li class="list-group-item">Item 2</li>
                <li class="list-group-item">Item 3</li>
                <li class="list-group-item">Item 4</li>
                <li class="list-group-item">Item 5</li>
                <li class="list-group-item">Item 6</li>
                <li class="list-group-item">Item 7</li>
                <li class="list-group-item">Item 8</li>
            </ul>
        </div>
    </div>
</div> 
```

[https://jsfiddle.net/igorkrupitsky/cw5n0xku/1/](https://jsfiddle.net/igorkrupitsky/cw5n0xku/1/)

# php - 如何在 PHP 中发送电子邮件之前验证 SMTP 凭据？

> ID：13940424
> 
> 赞同：4
> 
> 时间：2012-12-18T19:50:54.053
> 
> 标签：php, smtp, phpmailer

由于很难找到答案，我认为这可能是不可能的。如果是这样，我想确认这是不可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T22:30:22.767

[使用最新版本的PHPMailer](https://code.google.com/a/apache-extras.org/p/phpmailer/)有一种非常简单的方法。

```
require_once 'phpmailer/class.phpmailer.php';
require_once 'phpmailer/class.smtp.php';

$mail = new PHPMailer(true);
$mail->SMTPAuth = true;
$mail->Username = 'email@example.com';
$mail->Password = 'my_awesome_password';
$mail->Host = 'smtp.example.com';
$mail->Port = 465;

// This function returns TRUE if authentication
// was successful, or throws an exception otherwise
$validCredentials = $mail->SmtpConnect(); 
```

您可能需要根据目标 SMTP 服务更改端口号并启用 SSL。例如，Gmail*需要*SSL 连接。

要启用 SSL，请添加`$mail->SMTPSecure = 'ssl';`

* * *

**注意**：PHPMailer在失败时**抛出异常。**例如，用户名/密码不匹配可能会触发异常。为避免错误消息被打印在整个页面上，请将函数包装在 try/catch 块中。

```
$validCredentials = false;

try {
    $validCredentials = $mail->SmtpConnect();
}
catch(Exception $error) { /* Error handling ... */ } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:55:32.967

这并非不可能。

您可以自己对 SMTP 交互进行编程，并检查 SMTP 协议中的凭据是否被接受的确认。对于这种方法，您必须与 SMTP 服务器进行套接字级别的通信（例如，使用 [PHP Sockets] 服务[1](http://php.net/manual/en/book.sockets.php)）。

要了解 SMTP 协议的工作原理，请尝试使用 Telnet 手动进行一次。

[http://technet.microsoft.com/en-us/library/aa995718(v=exchg.65).aspx](http://technet.microsoft.com/en-us/library/aa995718(v=exchg.65).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:58:55.197

PHP[邮件](http://php.net/manual/en/function.mail.php)功能不支持 SMTP 认证。

您可以考虑第三方库，例如

[http://swiftmailer.org/](http://swiftmailer.org/)

[http://pear.php.net/package/Mail](http://pear.php.net/package/Mail)

或者你可以试试[这里的脚本](http://support.webecs.com/KB/a390/php-mail-script-with-smtp-authentication.aspx)

# html - 使用链接更改 CSS 边框颜色

> ID：13940426
> 
> 赞同：0
> 
> 时间：2012-12-18T19:51:02.220
> 
> 标签：html, css

我试图让我的链接周围的边框改变链接的颜色。我已经设置好了，所以`a.hover`稍微改变了颜色，并想让它也改变边框颜色。是否可以仅使用 CSS 和 HTML 来做到这一点？

这是我的 HTML 代码：

```
<h1>
    <a class="border" href="http://example.com">Home</a>
    <a class="border" href="http://example.com/forum">Forum</a>
</h1> 
```

这是我的CSS：

```
h1 {
text-align: center;
color:#00F;

}
a:link {
color: #00F;
text-decoration: none;
}
a:visited {
text-decoration: none;
color: #00F;
}
a:hover {
text-decoration: none;
color: #006;
}
a:active {
text-decoration: none;
color: #000;
}
a.border {
border-style: solid;
border-color: #00F;
border-width: 5px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:37:55.580

我清理代码：

```
<h1>
    <a href="http://example.com">Home</a>
    <a href="http://example.com/forum">Forum</a>
</h1>​

    h1 {
  text-align: center;
  color:#00F;
}
a:link, a:visited {
  color: #00F;
  text-decoration: none;
  border: 5px solid #00F;
}
a:hover {
  text-decoration: none;
  color: #006;
  border: 5px solid #006;
}
a:active {
  text-decoration: none;
  color: #000;
  border: 5px solid #000;
}​ 
```

使用边框，我在标签 html 中删除了类。

[http://jsfiddle.net/SUMEk/](http://jsfiddle.net/SUMEk/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T19:52:44.097

你想`border: 5px solid #000000;`在你的里面添加`a:hover{}`我认为

*   除非您删除标签`border`上的类或在其中添加以上内容，否则这将不起作用- 请阅读评论以获取解释。`<a>``a.border:hover{}`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T19:56:27.707

您正在寻找 CSS 属性“边框”。以下代码将在您悬停时添加边框：

```
a.border:hover {
    text-decoration: none;
    color: #006;
    border-style: solid;
    border-color: red;
    border-width: 5px;
} 
```

您的 a.border 比您的 a:hover 选择器更具体。因此，您不会看到边界。

JS 小提琴：http: [//jsfiddle.net/vJ2fJ/2/](http://jsfiddle.net/vJ2fJ/2/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-18T20:49:21.657

你唯一需要的是：

```
a.border:hover {
    border-color: red;
} 
```

其他样式已经继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-18T20:06:47.933

如果您希望在用户将鼠标移过您的项目时更改样式，请使用 ":hover" 伪选择器。你的 CSS 应该是这样的：

```
a:hover {
    border:5px solid #00F;
} 
```

当您悬停任何链接时，您将看到效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-18T20:36:54.213

```
a.border:hover{
    border-color: #006; /*Or whatever*/
} 
```

我建议阅读[http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

# scala - 在 Scalate 模板中动态包含变量

> ID：13940428
> 
> 赞同：4
> 
> 时间：2012-12-18T19:51:08.710
> 
> 标签：scala, scalate, scaml

我正在使用 Scalate（特别是 scaml，但格式有点不重要），并且我有许多跨多个模板定义的值。 **这些变量在编译时并不总是已知的。** 我的目标是在一个共享模板中定义它们，我将其作为其他模板的一部分（某种模板继承）。我还希望这些值被延迟实例化。所以我想要的是这样的：

globals.scaml：

```
- import mylib.DataProvider._

- lazy val name = get("name")
- lazy val address = get("address) 
```

模板.scaml：

```
= include("globals.scaml")
The address for #{name} is #{address} 
```

我已经搞砸了各种方案，包括将其反转，以便 globals.scaml 在传递一些变量的同时加载正确的模板，如下所示：

globals.scaml：

```
-@ val template: String
- import mylib.DataProvider._

- val data = Map("name" -> get("name"), "address" -> get("address))
- render(template, data) 
```

但这仅在我实际上也在模板中声明 val 时才有效，如下所示：

```
-@ val name:String
-@ val address:String

The address for #{name} is #{address} 
```

问题是这实际上比在每个模板中重复自己更糟糕，因为我仍然必须声明所有的 val，而且我没有得到懒惰的评估。

有没有办法（无需编写我自己的预解析器）在 Scalate 中执行此操作？

# objective-c - UIImage 在单独的线程中调整大小

> ID：13940433
> 
> 赞同：0
> 
> 时间：2012-12-18T19:51:32.533
> 
> 标签：objective-c, uiimage, grand-central-dispatch

我有以下类别用于调整 UIImage 对象的大小：

```
// UIImage+TSResize.h

#import <UIKit/UIKit.h>

/**
    This is a UIImage category that allows for the resizing of UIImages. The code for the main function (imageWithImage:scaledToFillSize:withScaleFactor: was obtained at: http://stackoverflow.com/questions/2658738/the-simplest-way-to-resize-an-uiimage
 */
@interface UIImage (TSResize)

/**
    Returns a resized UIImage that will fill the area provided.
    @param image The image to resize.
    @param size The size for the new image.
    @param scaleFactor The scale factor to apply to the image. This is 2.0 for retina display device. If 0.0 is specfied, it will select the scale factor for the current device.
    @returns The resized image.
 */
+ (UIImage *)imageWithImage:(UIImage *)image scaleToFillSize:(CGSize)size withScaleFactor:(CGFloat)scaleFactor;

/**
    Returns a aspect resized UIImage that will fit within the size provided.
    @param image The image to resize.
    @param size The size that the new image should fit within.
    @param scaleFactor The scale factor to apply to the image. This is 2.0 for retina display device. If 0.0 is specfied, it will select the scale factor for the current device.
    @returns The resized image.
 */
+ (UIImage *)imageWithImage:(UIImage *)image scaleAspectFitSize:(CGSize)size withScaleFactor:(CGFloat)scaleFactor;

/**
    Returns a aspect resized UIImage that will fill size provided. This image has not been cropped to remain within the size provided if the aspect ratios are different.
    @param image The image to resize.
    @param size The size that the image should fill.
    @param scaleFactor The scale factor to apply to the image. This is 2.0 for retina display device. If 0.0 is specfied, it will select the scale factor for the current device.
    @returns The resized image.
 */
+ (UIImage *)imageWithImage:(UIImage *)image scaleToAspectFillSizeWithoutCropping:(CGSize)size withScaleFactor:(CGFloat)scaleFactor;

@end 
```

&

```
// UIImage+Resize.m

#import "UIImage+TSResize.h"

@implementation UIImage (TSResize)

+ (UIImage *)imageWithImage:(UIImage *)image scaleToFillSize:(CGSize)size withScaleFactor:(CGFloat)scaleFactor {
    UIGraphicsBeginImageContextWithOptions(size, NO, scaleFactor);
    [image drawInRect:CGRectMake(0, 0, size.width, size.height)];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return newImage;
}

+ (UIImage *)imageWithImage:(UIImage *)image scaleAspectFitSize:(CGSize)size withScaleFactor:(CGFloat)scaleFactor {
    // Find the smallest scaling factor of the two sides.
    CGFloat scalingFactor = 0.0;

    CGFloat heightScalingFactor = size.height / image.size.height;
    CGFloat widthScalingFactor = size.width / image.size.width;

    if (heightScalingFactor < widthScalingFactor) {
        scalingFactor = heightScalingFactor;
    } else {
        scalingFactor = widthScalingFactor;
    }

    CGSize scaledSize;

    scaledSize.height = image.size.height * scalingFactor;
    scaledSize.width = image.size.width * scalingFactor;

    return [self imageWithImage:image scaleToFillSize:scaledSize withScaleFactor:scaleFactor];
}

+ (UIImage *)imageWithImage:(UIImage *)image scaleToAspectFillSizeWithoutCropping:(CGSize)size withScaleFactor:(CGFloat)scaleFactor {
    // Find the largest scaling factor of the two sides.
    CGFloat scalingFactor = 0.0;

    CGFloat heightScalingFactor = size.height / image.size.height;
    CGFloat widthScalingFactor = size.width / image.size.width;

    if (heightScalingFactor > widthScalingFactor) {
        scalingFactor = heightScalingFactor;
    } else {
        scalingFactor = widthScalingFactor;
    }

    CGSize scaledSize;

    scaledSize.height = image.size.height * scalingFactor;
    scaledSize.width = image.size.width * scalingFactor;

    return [self imageWithImage:image scaleToFillSize:scaledSize withScaleFactor:scaleFactor];
}

@end 
```

我想知道的是在主线程以外的线程中使用这些函数是否安全。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:58:14.073

是的，这些函数是线程安全的。

[文档](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html)

> 在 iOS 4 及更高版本中，您可以从应用程序的任何线程调用此函数。

# c# - 获取 NEF 格式图像的拍摄日期

> ID：13940436
> 
> 赞同：4
> 
> 时间：2012-12-18T19:51:49.697
> 
> 标签：c#, image, image-processing

我有一个函数可以获取 JPEG 格式图片的拍摄日期值。我遇到了 NEF Nikon raw 格式的问题。在 Windows 8 中，如果我将列添加到 Windows 资源管理器详细信息视图，我可以看到 Date Taken 值。

执行以下操作时收到的错误是“此编解码器不支持指定的属性”。

```
public string GetDate(FileInfo f)
        {
            string date;

            using (FileStream fs = new FileStream(f.FullName, FileMode.Open, FileAccess.Read, FileShare.Read))
            { 
                BitmapSource img = BitmapFrame.Create(fs);
                BitmapMetadata md = (BitmapMetadata)img.Metadata;
                date = md.DateTaken;
            }

            return date;
        } 
```

我尝试了类似 SO 答案中引用的[本文](http://www.developerfusion.com/article/84474/reading-writing-and-photo-metadata/)中的建议，使用 BitmapMetadata 的 GetQuery 方法，但返回了相同的错误，这是我使用的代码：

```
public string GetDate(FileInfo f)
        {
            string date;

            using (FileStream fs = new FileStream(f.FullName, FileMode.Open, FileAccess.Read, FileShare.Read))
            { 
                BitmapSource img = BitmapFrame.Create(fs);
                BitmapMetadata md = (BitmapMetadata)img.Metadata;
                object t = Mdata.GetQuery("System.Photo.DateTaken");
            }

            return date;
        } 
```

我将此部署到 Windows 8 PC，所以我不介意仅使用 Windows 8 或 .NET 4.5 的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:14:06.940

我终于解决了这个问题，我不得不在我的电脑上安装[尼康 NEF 编解码器。](http://www.nikonimglib.com/nefcodec/)我感到困惑的是，Windows 8 能够开箱即用地显示 NEF 图像并提供来自 EXIF 的元数据，例如拍摄日期。我的直觉告诉我，有一个可以使用的 Windows 或 .NET 库，我可以在不安装编解码器的情况下获得相同的信息。不幸的是，我时间紧迫，没有时间深入研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-07T05:46:42.293

Java 在这里有一个更通用的开源库：[元数据提取器](https://github.com/drewnoakes/metadata-extractor)

我刚刚导入了他们的库，它就像文件的魅力一样`NEF`，而且它支持更多的文件扩展名。

# python - *.py 中未指定服务器参数

> ID：13940443
> 
> 赞同：3
> 
> 时间：2012-12-18T19:52:06.400
> 
> 标签：python, google-app-engine, python-2.7

我收到消息：

```
'server' parameter not specified in *.py 
```

做之后：

```
appcfg.py update *.py 
```

在终端。当我在应用程序的仪表板中查看当前版本列时显示“未部署”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:27:29.347

当您从终端运行命令时，您希望指向`appcfg.py`包含应用程序文件的文件夹。此文件夹将包含您的`app.yaml`. 假设调用`my_project`了该文件夹，您将从应用程序上方的文件夹中执行以下操作：

```
python appcfg.py update my_project 
```

这里的区别在于您将整个应用程序提供给`appcfg`，而不是任何`.py`文件（如您所见将不起作用）。

# python - 使用 TideSDK 在 Python 中流式传输音频

> ID：13940449
> 
> 赞同：0
> 
> 时间：2012-12-18T19:52:29.320
> 
> 标签：python, html, tidesdk

我正在尝试在我的 TideSDK 应用程序中流式传输音频，但这似乎很困难。HTML5 音频对我不起作用，视频标签也不起作用。播放器只是继续加载。我已经测试并确认我的代码可以在许多其他浏览器中运行。

我的下一个尝试是通过 Python 绑定的 VLC。但是在没有任何确认的情况下，我相信您需要安装 VLC 才能使 vlc.py 文件正常工作？

基本上，我想做的是以复杂的方式播放音频（可能通过 Python）并将其包装在我的 TideSDK 应用程序中。我希望它开箱即用——我的最终用户无需安装任何东西。

顺便说一句，我对整个 python 的东西都很陌生，但我学得很快，所以我很想看到一些关于如何开始的例子！

也许一个非常古怪的方法是使用闪光灯，但我不想这样做。

对于那些不熟悉 TideSDK 的人来说，它是一种使用 HTML、CSS、Python、Ruby 和 PHP 构建桌面应用程序的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T08:21:52.880

当前版本的 webkit 非常旧，因此缺乏对 HTML5 的支持。windows目前不支持音频和视频标签，因为底层的webkit实现（wincairo）不支持它。Wa 正在开发第一部分以使用最新的 webkit。一旦完成，我们还计划在 Windows 上支持音频/视频。

# ravendb - RavenDB 问题：范围、查询、摘要视图

> ID：13940452
> 
> 赞同：0
> 
> 时间：2012-12-18T19:52:37.207
> 
> 标签：ravendb

我有一个使用 EF4 和 SQL Server 并托管在 AppHarbor 的现有网站。我需要制作一个独立版本，个人可以在没有 Internet 连接的情况下在本地运行。我正在考虑删除 SQL 并用 RavenDB 替换它。我认为数据结构很适合这一点。

从高层次的角度来看，这就是结构

```
User
 - Elections
   - People
   - Locations
     - Ballots
       - Votes 
```

该网站的每个用户都可以创建多个“选举”。每次选举都是完全独立的，只有创建它的用户以及他们与之共享的任何“访客”用户知道。

以下是一些我还没有找到答案的问题：

1.  如何隔离仅访问当前选定的“选举”？每个 linq 语句是否需要包含一个“where”子句来限制选举范围，或者我可以让选举“加载”并在“内部”工作？我必须使用`db.Query<Person>().Where(p=>p.Election==currentElection)`还是可以做类似的事情`election.Query<Person>()`？

2.  每个人最多有六个字段：我要搜索的“名字”、“姓氏”、“其他名字”、“额外信息”等。我需要经常快速地搜索选举中的每个人以寻找部分匹配项在所有这些领域。我也想要“soundex”类型的匹配。索引会有用吗，还是我只是使用“蛮力”并遍历所有人？如果有 50,000 人参加选举，我可以得到亚秒级的响应吗？

3.  我如何构建文档以便每个用户都可以获取和使用他们的选举列表？查看他们的选举列表时，我想显示每次选举的摘要信息。应该将其“预存储”在用户对象中吗？或者，在显示列表时，我是否必须加载每个选举的部分内容以获取详细信息（例如人数、选举的某些属性等）。

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:07:40.747

1) 是的，您需要添加 where 子句。`election.Query<Person>()`如果您添加自己的扩展方法，您可以这样做。2）您想使用索引。你会得到这样的速度和更多。您可能想阅读有关订单搜索的信息：http: [//ayende.com/blog/152833/orders-search-in-ravenb](http://ayende.com/blog/152833/orders-search-in-ravendb) 3) 您可以查询或存储它，具体取决于太多因素。

# iphone - 如何在 iOS 中使用 OpenGL ES 2.0 绘制矩形？

> ID：13940453
> 
> 赞同：2
> 
> 时间：2012-12-18T19:52:38.967
> 
> 标签：iphone, objective-c, ios, opengl-es

几年来我一直在学习和使用 Objective-C 和 cocos2d（iOS 游戏引擎），所以我决定从 iOS 设备上的 OpenGL ES 开始。我已经开始阅读一本涵盖这个主题的书，但是我在这方面的背景很少，我不得不承认我有点迷茫。我是一个非常实际的人，我只通过自己做事来学习。这本书确实给出了一些很好的例子，但不幸的是大部分都涵盖了三角形。

**所以，我有几个关于 OpenGL 的问题：**

*   顶点真的需要以逆时针顺序声明以防止剔除吗？
*   OpenGL 真的会根据三角形绘制所有形状吗？
*   如果是这样，我将如何绘制一个矩形？

如果有人可以编写一个快速的顶点数组示例来说明如何在屏幕上绘制矩形，我将不胜感激。不需要缓冲区或任何东西，实际上只是矩形的顶点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:11:37.353

OpenGL ES 2.0 支持以下渲染类型：GL_POINTS、GL_LINE_STRIP、GL_LINE_LOOP、GL_LINES、GL_TRIANGLE_STRIP、GL_TRIANGLE_FAN 和 GL_TRIANGLES。

如果您忽略绘制点和线的那些，您可以在[三角形带](http://en.wikipedia.org/wiki/Triangle_strip)、[三角形扇形](http://en.wikipedia.org/wiki/Triangle_fan)和简单三角形之间进行选择。要绘制一个矩形，您可以轻松地使用两个三角形。

要指定面部剔除的顺序，您可以使用[glFrontFace](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glFrontFace.xml)。然而，它的常见做法（据我所知）使用逆时针排序。

如果您在为 ios 找到好的 opengl es 2.0 教程时遇到问题，您可能应该在某些平台上寻找一些教程。WebGL 和 Android 也在使用 opengl es 2.0，并且（除了语法）代码看起来几乎相同。

# machine-learning - Perl / Moose 中的朴素贝叶斯计算

> ID：13940460
> 
> 赞同：0
> 
> 时间：2012-12-18T19:52:56.547
> 
> 标签：machine-learning, classification, naivebayes

这是我编写的一些代码，用于使用朴素贝叶斯分类器计算关于某些观察到的特征的标签概率。这旨在计算朴素贝叶斯公式而不进行平滑处理，并且旨在计算实际概率，因此请使用通常省略的分母。我遇到的问题是，对于示例（如下），“好”标签的概率> 1。（1.30612245）谁能帮我理解那是什么？这是天真的假设的副产品吗？

```
package NaiveBayes;

use Moose;

has class_counts => (is => 'ro', isa => 'HashRef[Int]', default => sub {{}});
has class_feature_counts => (is => 'ro', isa => 'HashRef[HashRef[HashRef[Num]]]', default => sub {{}});
has feature_counts => (is => 'ro', isa => 'HashRef[HashRef[Num]]', default => sub {{}});
has total_observations => (is => 'rw', isa => 'Num');

sub insert {
    my( $self, $class, $data ) = @_;
    $self->class_counts->{$class}++;
    $self->total_observations( ($self->total_observations||0) + 1 );
    for( keys %$data ){
        $self->feature_counts->{$_}->{$data->{$_}}++;
        $self->class_feature_counts->{$_}->{$class}->{$data->{$_}}++;
    }
    return $self;
}

sub classify {
    my( $self, $data ) = @_;
    my %probabilities;
    my $feature_probability = 1;
    for my $class( keys %{ $self->class_counts } ) {
        my $class_count = $self->class_counts->{$class};
        my $class_probability = $class_count / $self->total_observations;
        my($feature_probability, $conditional_probability) = (1) x 2;
        my( @feature_probabilities, @conditional_probabilities );
        for( keys %$data ){
            my $feature_count = $self->feature_counts->{$_}->{$data->{$_}};
            my $class_feature_count = $self->class_feature_counts->{$_}->{$class}->{$data->{$_}} || 0;
            next unless $feature_count;
            $feature_probability *= $feature_count / $self->total_observations;
            $conditional_probability *= $class_feature_count / $class_count;
        }
        $probabilities{$class} = $class_probability * $conditional_probability / $feature_probability;
     }
     return %probabilities;
}

__PACKAGE__->meta->make_immutable;
1; 
```

例子：

```
#!/usr/bin/env perl

use Moose;
use NaiveBayes;

my $nb = NaiveBayes->new;

$nb->insert('good' , {browser => 'chrome'   ,host => 'yahoo'    ,country => 'us'});
$nb->insert('bad'  , {browser => 'chrome'   ,host => 'slashdot' ,country => 'us'});
$nb->insert('good' , {browser => 'chrome'   ,host => 'slashdot' ,country => 'uk'});
$nb->insert('good' , {browser => 'explorer' ,host => 'google'   ,country => 'us'});
$nb->insert('good' , {browser => 'explorer' ,host => 'slashdot' ,country => 'ca'});
$nb->insert('good' , {browser => 'opera'    ,host => 'google'   ,country => 'ca'});
$nb->insert('good' , {browser => 'firefox'  ,host => '4chan'    ,country => 'us'});
$nb->insert('good' , {browser => 'opera'    ,host => '4chan'    ,country => 'ca'});

my %classes = $nb->classify({browser => 'opera', host => '4chan', country =>'uk'});

my @classes = sort { $classes{$a} <=> $classes{$b} } keys %classes;

for( @classes ){
    printf( "%-20s : %5.8f\n", $_, $classes{$_} );
} 
```

印刷：

```
bad                  : 0.00000000
good                 : 1.30612245 
```

我不太担心 0 的概率，但更担心好的 > 1 的“概率”。我相信这是经典朴素贝叶斯定义的实现。

```
p(C│F_1 ...F_n )=(p(C)p(F_1 |C)...p(F_n |C))/(p(F_1)...p(F_n)) 
```

这怎么可能> 1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T10:59:09.743

自从我正确使用 Perl 以来，我能够调试它已经太久了，但我想我可以看到问题出在哪里。特征向量 p(f_1 ... f_n) 的边际概率不是按照您看起来的方式计算的，这是作为具有单独参数的单独计算。相反，如果您有具有先验 p(c_1) 和 p(c_2) 的类 c_1 和 c_2，以及似然项 p(f | c_1) 和 p(f | c_2)，那么 f 的边际概率是：

p(c_1)*p(f|c_1) + p(c_2)*p(f|c_2)

这就是为什么分母经常被删除的原因：它只涉及您已经使用的数量的总和。您想知道的有关相对概率的任何信息都可以计算为非归一化分数的比率，因此计算比例常数只有在您明确想要一个介于 0 和 1 之间的数字时才有用。

# django - Django：尽管在导入时使用了完整的模块路径，但引用了错误的模型

> ID：13940465
> 
> 赞同：1
> 
> 时间：2012-12-18T19:53:09.010
> 
> 标签：django, django-models

我有 2 个 django 项目

*   帝王猎鹰
*   系统模型

在每个项目中，我都有一个“数据源”应用程序：

*   regalbeagle/数据源
*   系统模型/数据源

在每个数据源应用程序中，

*   regalbeagle/数据源/models.py
*   system_models/datasources/models.py

我有一个“数据源”模型：

```
 class Datasource(models.Model):
    fullname = models.CharField(max_length=100)
    url = models.URLField()
    source_type = SmallIntegerField(default=1)
    icon = models.CharField(max_length=255)

    def __unicode__(self):
        return self.fullname 
```

我将在一秒钟内了解为什么我在不同项目中的同名应用程序中有两个相同的模型，但首先我想确定我看到的奇怪行为。我已经使用 python setup.py install 将 system_models 项目安装到全局 python lib 目录中。但是，当从 regalbeagle 项目中运行 python manage.py shell 时，即使使用完全限定的路径，我也无法访问 system_models 的数据源模型。

```
from system_models.datasources.models import Datasource as SystemDatasource
from regalbeagle.datasources.models import Datasource 
```

当我使用 python 检查模块查看正在加载的文件时，我看到以下内容：

```
inspect.getfile(SystemDatasource)
'/Users/george/svn/regalbeagle/trunk/regalbeagle/../regalbeagle/datasources/models.pyc'

inspect.getfile(Datasource)
'/Users/george/svn/regalbeagle/trunk/regalbeagle/../regalbeagle/datasources/models.pyc' 
```

但是，如果我在 system_models 中创建一个没有相应 regalbeagle 类的虚拟模型，则路径似乎已被识别：

```
from system_models.datasources.models import DummyClass
inspect.getfile(DummyClass)
'/Library/Python/2.6/site-packages/system_models/datasources/models.pyc' 
```

所以我的问题是，即使我使用完整路径导入，Django 如何神奇地将 system_models 中的 Datasource 类交换为 regalbeagle 中的那个？如果 django 不喜欢有两个同名的应用程序，为什么我的 DummyClass 似乎工作正常？

最简单的修复似乎是将 system_models 模型名称显式更改为 SystemDatasource，但这似乎违背了模块/打包的目的。

所以我的问题是：

是否有一些我可以指定的附加信息，以便 Django 允许这些模型共存？还是我是 SOL？

正如所承诺的，我为什么需要这两个版本的数据源的解释：

我有一个后端抓取过程，需要能够将数据写入数据库，出于性能原因，我希望这个数据库与我的 Web 应用程序分开。因此，我创建了一个 systemdb 并针对此同步了我的 system_models 项目。我的 Web 应用程序能够查看后端进程抓取的数据的聚合统计信息，并且执行此操作的信息位于 regalbeagle 数据库中。有一些查询需要在 regalbeagle 中加入数据源表，因为无法跨 dbs 加入，所以 regalbeagle 有自己的数据源副本。但我还需要能够更新与爬网相关的信息，我正在通过 regalbeagle 的管理界面进行更新。这意味着我也需要访问那里的表的 system_models 版本。

添加完整模型定义：

regalbeagle/datasources/models.py：

```
from django.db import models

class LanguageManager(models.Manager):
    def filter_by_datasources(self, exclude_datasource_id_list=None):
        qs = self.get_query_set().filter(datasource__isnull=False)
        if exclude_datasource_id_list:
            qs = qs.exclude(datasource__in=exclude_datasource_id_list)
        return qs.distinct()

class Language(models.Model):
    name = models.CharField(max_length=128)

    objects = LanguageManager()

    class Meta:
        ordering = [ 'name' ]

    def __unicode__(self):
        return "[%s] %s" % (self.id, self.name)

class DataSourceManager(models.Manager):
    def get_query_set(self):
        return super(DataSourceManager, self).get_query_set() \
            .extra(select={ 'lower_fullname': 'lower(fullname)' }) \
            .filter(is_inactive__isnull=True) \
            .order_by('lower_fullname')

class DataSource(models.Model):
    fullname = models.CharField(max_length=100)
    url = models.URLField()
    icon = models.URLField(null=True)
    language = models.ManyToManyField(Language, null=True)

    objects = DataSourceManager()

    def __unicode__(self):
        return "[%s] %s, %s" % (self.id, self.fullname, self.url)

class DataSourceInactive(models.Model):
    datasource = models.OneToOneField(DataSource, null=True, related_name='is_inactive')

    def __unicode__(self):
        return self.datasource.__unicode__() 
```

system_models/datasources/models.py：

```
from django.db import models

# DataSource -- these are the different places that we import data
# from.  
class DataSource(models.Model):
    fullname = models.CharField(max_length=100)
    url = models.URLField()
    source_type = SmallIntegerField(default=1)
    icon = models.CharField(max_length=255)

    def __unicode__(self):
        return self.fullname 
```

# php - PHP 多标签搜索

> ID：13940468
> 
> 赞同：1
> 
> 时间：2012-12-18T19:53:16.683
> 
> 标签：php, search, tags

让这个脚本部分工作，但如果 1 个视频上有 3 个标签，并且我输入了所有 3 个标签，视频会返回 3 次，不知道如何纠正这个问题。

```
$search = sanitize($_GET['search']);
$array = explode(" ", $search);
foreach($array as $mySearch)
{
  $query = mysql_query("SELECT * FROM `videos`");
  while($mad = mysql_fetch_array($query))
  {
    if(strpos($mad['tags'], $mySearch))
    {
      // show results
      echo "<div class='comment_1'>$mad[title]</div>";
    }
  }
} 
```

任何帮助总是非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:55:35.057

您可以对其进行一些更改并执行以下操作：

```
$search = mysqli_real_escape_string($_GET['search']);
$search = preg_replace('/\s+/m', '|', $search);
$query = mysqli_query("SELECT * FROM `videos` where tags regexp '{$search}'");
while($mad = mysqli_fetch_array($query))
{
   // show results
   echo "<div class='comment_1'>{$mad['title']}</div>";
   break;
} 
```

请注意，我将您的`mysql_*`函数更改为`mysqli_*`等效函数，因为它们已被弃用。我还将您的代码减少到只有一个循环，并将搜索词添加到您的查询中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T19:58:55.930

这应该工作

```
$search = sanitize($_GET['search']);
$array = explode(" ", $search);

$query = mysql_query("SELECT * FROM `videos`");
while($mad = mysql_fetch_array($query)) {
    foreach($array as $mySearch) {
        if(strpos($mad['tags'], $mySearch)) {
            // show results
            echo "<div class='comment_1'>$mad[title]</div>";
            continue 2;
        }   
    }   
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:01:59.903

您可能在这里采取了一些倒退的方法。您应该在查询中使用您的搜索标签，因此您不需要返回整个表格。您可能还应该将您的标签规范化为一个标签表和一个表示它们之间的多对多关系的视频标签表。然后你会像这样搜索：

```
SELECT * FROM
videos
INNER JOIN videos_tags ON videos.video_id = videos_tags.video_id
INNER JOIN tags ON videos_tags.tag_id = tags.tag_id
WHERE tags.tag_text IN ('tag 1', 'tag 2', etc.) 
```

随着应用程序的增长，这将使您的模型更具可持续性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T19:59:51.120

> 让这个脚本部分工作

好吧，不过，脚本就像怀孕一样：没有部分。一个系统要么工作要么不工作，两行之间没有太多关系。

您在这里遇到了一个逻辑问题，这是由于您的控制结构的处理顺序错误造成的。

正常程序是：

1.  验证和处理输入数据。
2.  处理数据，转换它。在您的情况下，使用它从数据库中获取数据。
3.  输出从存储中获取的数据。

在您的脚本中，您将所有这三件事混合在一起，而不是一个接一个地做：

```
$tags_array = get_tags_array_from_input();

$result = mysql_query_result_based_on_tags_array($tags_array);

display_results($result);

/**
 * exemplary only
 */
function mysql_query_result_based_on_tags_array(array $tags)
{
    $mask = "SELECT * FROM videos WHERE tags REGEXP '%s'";
    $sql  = sprintf($mask, implode('|', $tags));

    return mysql_query($sql);
} 
```

# android - OnClickListener - Android Eclipse

> ID：13940469
> 
> 赞同：0
> 
> 时间：2012-12-18T19:53:35.853
> 
> 标签：android, onclicklistener

简单的问题，但我被卡住了:-(我完全按照教程进行操作时能够完成这项工作，但是当我尝试重新创建它时，我的按钮不起作用。没有错误。只是当我没有任何反应时点击按钮。有什么想法吗？

```
public void listener() {

    Button btnReset = (Button) findViewById(R.id.bl);
    btnReset.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            resetCounter(v);
            count = 0;
        }

    });

} 
```

* * *

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".Counter" >

    <TextView
        android:id="@+id/tvCounter"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" />

    <Button
        android:id="@+id/bl"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:text="@string/btnReset"
        android:textSize="20sp" />

</RelativeLayout> 
```

* * *

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:01:08.670

你必须调用`listener()`你的`OnCreate()`方法。

# android - animationDrawable 没有在 Actionbar 中播放？

> ID：13940472
> 
> 赞同：1
> 
> 时间：2012-12-18T19:53:45.873
> 
> 标签：android

我正在使用开发人员指南 ( [http://developer.android.com/guide/topics/graphics/drawable-animation.html](http://developer.android.com/guide/topics/graphics/drawable-animation.html) ) 创建一个动画记录按钮，对操作栏菜单项而不是 imageView 进行小的更改。当我调用 onStart 时它不播放？

这是我使用的代码

```
RecordButton.setIcon(R.drawable.recordbutton);
recordAnimation = (AnimationDrawable) RecordButton.getIcon();
recordAnimation.start(); 
```

有谁知道为什么不播放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-17T09:30:45.963

对我来说，在下一个*周期*中调用**start()**

 *```
new Handler().post(new Runnable() {
    @Override
    public void run() {
        animationDrawable.start();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T15:26:43.473

我有同样的问题。我可以通过使用此处描述的操作栏提供程序来解决它：http: [//developer.android.com/guide/topics/ui/actionbar.html#ActionProvider](http://developer.android.com/guide/topics/ui/actionbar.html#ActionProvider)

跳过 ShareActionProvider 并创建一个自定义的。这使您可以为操作栏项目（在本例中为 ImageView）使用自定义布局，您可以按照指向可绘制动画指南的链接中的说明进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-18T21:26:33.393

我要告诉可能会在这里结束的人：在我的应用程序中，我只是尝试使用相同的方法使用 AnimationDrawable 更改 ActionBar 按钮的图标，并且它可以工作。

* * *

我的 AnimationDrawable `ic_action_recording_active`：

```
<animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:oneshot="false" >
    <item android:drawable="@drawable/ic_action_recording_active0" android:duration="200" />
    <item android:drawable="@drawable/ic_action_recording_active1" android:duration="200" />
    <item android:drawable="@drawable/ic_action_recording_active2" android:duration="200" />
</animation-list> 
```

我在按下图标后调用此方法（我在 中处理它们`onOptionsItemSelected`）：

```
public void changeMenuIcon(MenuItem item) {
    if (isRecording) {
        item.setIcon(R.drawable.ic_action_recording_active);
        AnimationDrawable icon = (AnimationDrawable) item.getIcon();
        icon.start();
    } else {
        item.setIcon(R.drawable.ic_action_recording);
    }
} 
```

**编辑：**我刚刚看到使用`icon.start()`in 并`onCreateOptionsMenu`没有真正开始动画......

我最终打电话`changeMenuIcon`给`onWindowFocusChanged`*

# facebook - 无法使用用户访问令牌访问私人的公共事件

> ID：13940473
> 
> 赞同：1
> 
> 时间：2012-12-18T19:53:46.480
> 
> 标签：facebook, facebook-graph-api

我获取一些页面的事件。我使用了应用访问令牌，但由于酒精和其他限制，我切换到了用户访问令牌（我自己的 Facebook 帐户）。现在我可以访问这些事件。

**但是当它们是由私人组织时，我无法访问它们**，而不是粉丝专页。这些活动是公开的，当我使用 Facebook 时，我可以毫无问题地看到它们。但是当我使用我的访问令牌时，不会返回任何事件（不在图形 api 资源管理器中，不在 php sdk 中）。**这是为什么？我需要一些许可还是有其他限制？**

重现：

1.  选择组织公共活动的人（但不是主页） - 使用您的帐户查看这些活动。例如[https://www.facebook.com/alexandra.pajewska](https://www.facebook.com/alexandra.pajewska)（她创建了这个事件[http://graph.facebook.com/452665288126076](http://graph.facebook.com/452665288126076) - 我可以在使用我的访问令牌时看到它的详细信息）。

2.  运行 graph api explorer 并使用您的访问令牌来获取这些事件，例如 1544945688/events

你应该看到这个：

```
{
 "data": [
 ]
 } 
```

* * *

编辑：可能与权限无关。我在图形 api 资源管理器中启用了所有这些，但仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T01:18:31.473

[该页面](https://developers.facebook.com/docs/reference/api/event/)说明了一切：

> 要读取`the /events`用户的连接，您需要：
> 
> *   `user_events`当前用户的权限
> *   `friends_events`当前用户好友的权限

您需要一个权限来读取**当前用户**的事件，而另一个权限来读取**朋友**的事件。这绝对意味着我们只能访问应用程序用户及其朋友的事件，并且**不允许我们获取随机用户的事件**。

# c# - C#轮询监视文件夹

> ID：13940474
> 
> 赞同：0
> 
> 时间：2012-12-18T19:53:48.367
> 
> 标签：c#

> **可能重复：**
> [C# 循环遍历文件夹，直到找到正确的文件](https://stackoverflow.com/questions/13918550/c-sharp-to-loop-through-folder-until-it-finds-the-correct-files)

是否可以使用 c# 轮询来监视文件夹中的“必需”文件？我正在运行一个批处理文件，它需要某些文件位于文件夹中。如果文件不存在并且批处理作业会自动取消。我只是想知道我是否可以使用 ploling 来监视文件夹，一旦它们可用，我希望批处理文件继续。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T19:55:39.737

您可以轮询文件夹（通过[Directory.EnumerateFiles](http://msdn.microsoft.com/en-us/library/system.io.directory.enumeratefiles.aspx)和类似方法）以查找文件是否存在。

但是，您可能需要考虑使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)。它允许您在从文件夹中添加或删除文件时直接接收事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:57:07.483

您可以使用后台工作人员并使用以下方法检查文件是否存在：

```
 if (!System.IO.File.Exists("FullAddressFileName"))
                {
                    //stop batch 

                } 
```

# google-tv - 谷歌电视模拟器没有皮肤和控制，推送App时没有响应

> ID：13940476
> 
> 赞同：1
> 
> 时间：2012-12-18T19:54:28.850
> 
> 标签：google-tv

我在我的 Ubuntu 12.04 桌面（启用 KVM）上安装了最新的 Android SDK 4.2（API 17）、Google TV 插件当我从命令行启动 Emulator 时，它没有皮肤和硬件控制，如此链接所示[https://developers .google.com/tv/android/docs/gtv_emulator#TVKeys](https://developers.google.com/tv/android/docs/gtv_emulator#TVKeys) 它只有一个谷歌电视标志和全黑背景。

将简单的 Hello world 程序推送到 Emulator 时，Ecipse 控制台显示 ok

```
[2012-12-18 13:37:18 - hellow] Android Launch!
[2012-12-18 13:37:18 - hellow] adb is running normally.
[2012-12-18 13:37:18 - hellow] Performing com.example.hellow.MainActivity activity launch
[2012-12-18 13:37:18 - hellow] Automatic Target Mode: Unable to detect device compatibility. Please select a target device.
[2012-12-18 13:37:21 - hellow] Uploading hellow.apk onto device 'emulator-5554'
[2012-12-18 13:37:22 - hellow] Installing hellow.apk...
[2012-12-18 13:37:22 - hellow] Success!
[2012-12-18 13:37:22 - hellow] Starting activity com.example.hellow.MainActivity on device emulator-5554 
```

但谷歌电视模拟器什么也没显示。仍然只是徽标如果我将 AVD 更改为 Nexus 等其他设备，我可以在 Nexus AVD 上成功运行 Hello。

以下是 Google TV AVD 的终端输出

```
emulator: Android virtual device file at: /home/qinghui/.android/avd/GoogleTV.ini
emulator: virtual device content at /home/qinghui/.android/avd/GoogleTV.avd
emulator: virtual device config file: /home/qinghui/.android/avd/GoogleTV.avd/config.ini
emulator: using core hw config path: /home/qinghui/.android/avd/GoogleTV.avd/hardware-qemu.ini
emulator: Found AVD target API level: 12
emulator: 'magic' skin format detected: 720x1280
emulator: autoconfig: -skin 720x1280
emulator: autoconfig: -skindir (null)
emulator: keyset loaded from: /home/qinghui/.android/default.keyset
emulator: found SDK root at /usr/GoogleTV/sdk
emulator: trying to load skin file '/usr/GoogleTV/sdk/tools/lib/emulator/skins/dynamic//layout'
emulator: loaded dynamic skin width=720 height=1280 bpp=16

emulator: autoconfig: -kernel /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//kernel-qemu
emulator: autoconfig: -ramdisk /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//ramdisk.img
emulator: Using initial system image: /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//system.img
emulator: autoconfig: -data /home/qinghui/.android/avd/GoogleTV.avd/userdata-qemu.img
emulator: autoconfig: -initdata /home/qinghui/.android/avd/GoogleTV.avd/userdata.img
emulator: autoconfig: -cache /home/qinghui/.android/avd/GoogleTV.avd/cache.img
emulator: Physical RAM size: 1024MB

Content of hardware configuration file:
  hw.cpu.arch = x86
  hw.ramSize = 1024
  hw.screen = touch
  hw.mainKeys = no
  hw.trackBall = no
  hw.keyboard = no
  hw.keyboard.lid = no
  hw.keyboard.charmap = qwerty2
  hw.dPad = no
  hw.gsmModem = yes
  hw.gps = yes
  hw.battery = yes
  hw.accelerometer = yes
  hw.audioInput = yes
  hw.audioOutput = yes
  hw.sdCard = no
  disk.cachePartition = yes
  disk.cachePartition.path = /home/qinghui/.android/avd/GoogleTV.avd/cache.img
  disk.cachePartition.size = 66m
  hw.lcd.width = 720
  hw.lcd.height = 1280
  hw.lcd.depth = 16
  hw.lcd.density = 320
  hw.lcd.backlight = yes
  hw.gpu.enabled = no
  hw.camera.back = none
  hw.camera.front = none
  vm.heapSize = 64
  hw.sensors.proximity = yes
  hw.sensors.magnetic_field = yes
  hw.sensors.orientation = yes
  hw.sensors.temperature = yes
  kernel.path = /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//kernel-qemu
  kernel.parameters =  androidboot.hardware=goldfish clocksource=pit android.checkjni=1
  disk.ramdisk.path = /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//ramdisk.img
  disk.systemPartition.initPath = /usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//system.img
  disk.systemPartition.size = 200m
  disk.dataPartition.path = /home/qinghui/.android/avd/GoogleTV.avd/userdata-qemu.img
  disk.dataPartition.size = 200m
  avd.name = GoogleTV
.
QEMU options list:
emulator: argv[00] = "./emulator-x86"
emulator: argv[01] = "-android-hw"
emulator: argv[02] = "/home/qinghui/.android/avd/GoogleTV.avd/hardware-qemu.ini"
Concatenated QEMU options:
 ./emulator-x86 -android-hw /home/qinghui/.android/avd/GoogleTV.avd/hardware-qemu.ini
emulator: registered 'boot-properties' qemud service
emulator: nand_add_dev: system,size=0xc800000,initfile=/usr/GoogleTV/sdk/add-ons/addon-google_tv_addon-google-12/images/x86//system.img
emulator: mapping 'system' NAND image to /tmp/android-qinghui/emulator-8hHMHn
emulator: rounding devsize up to a full eraseunit, now c810000

emulator: nand_add_dev: userdata,size=0xc800000,file=/home/qinghui/.android/avd/GoogleTV.avd/userdata-qemu.img
emulator: rounding devsize up to a full eraseunit, now c810000

emulator: registered 'boot-properties' qemud service
emulator: Adding boot property: 'dalvik.vm.heapsize' = '64m'
emulator: Adding boot property: 'qemu.sf.lcd_density' = '320'
emulator: Adding boot property: 'qemu.hw.mainkeys' = '0'
emulator: Adding boot property: 'qemu.sf.fake_camera' = 'none'
emulator: nand_add_dev: cache,size=0x4200000,file=/home/qinghui/.android/avd/GoogleTV.avd/cache.img
emulator: Initializing hardware OpenGLES emulation support
emulator: KVM mode auto-enabled!
emulator: Kernel parameters: qemu.gles=0 qemu=1 console=ttyS0 android.qemud=ttyS1 androidboot.hardware=goldfish clocksource=pit android.checkjni=1 ndns=1
emulator:     trying to find: /usr/GoogleTV/sdk/tools/bios.bin

emulator:     trying to find: /usr/GoogleTV/sdk/tools/lib/pc-bios/bios.bin

emulator:     trying to find: /usr/GoogleTV/sdk/tools/vgabios-cirrus.bin

emulator:     trying to find: /usr/GoogleTV/sdk/tools/lib/pc-bios/vgabios-cirrus.bin

emulator: autoconfig: -scale 0.800781
emulator: Could not open file: (null)/system/build.prop: No such file or directory
emulator: control console listening on port 5554, ADB on port 5555
emulator: sent '0012host:emulator:5555' to ADB server
emulator: ping program: /usr/GoogleTV/sdk/tools/ddms
emulator: ping command: /usr/GoogleTV/sdk/tools/ddms ping emulator 21.0 "Tungsten Graphics, Inc" "Mesa DRI Intel(R) Sandybridge Desktop x86/MMX/SSE2" "3.0 Mesa 8.0.2"
goldfish_fb_get_pixel_format:167: display surface,pixel format:
  bits/pixel:  16
  bytes/pixel: 2
  depth:       16
  red:         bits=5 mask=0xf800 shift=11 max=0x1f
  green:       bits=6 mask=0x7e0 shift=5 max=0x3f
  blue:        bits=5 mask=0x1f shift=0 max=0x1f
  alpha:       bits=0 mask=0x0 shift=0 max=0x0 
```

从日志看来 KVM 已成功启用？任何帮助为什么没有皮肤和猫应用程序没有显示任何内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T16:25:09.037

这里有几件事。

1.  Google TV 目前仅支持 Android API Level 12 和 13（任何更高的都无法使用）

2.  模拟器输出日志中似乎有错误

    '模拟器：无法打开文件（空）/system/build.prop：没有这样的文件或目录'

3.  您更关心模拟器皮肤还是模拟器中没有运行的应用程序？

作为旁注 - 很快就会有一个新的模拟器版本（应该在新年之前）

# r - 如何在 for 循环中重命名数据框

> ID：13940478
> 
> 赞同：19
> 
> 时间：2012-12-18T19:54:32.527
> 
> 标签：r, for-loop

我对使用 R 编程非常陌生，但我正在尝试读取一个目录的多个文件，并为每个文件指定一个唯一的名称。我正在阅读使用 R 中的 Dendrochronology 程序库（包 dpIR）和`read.tucson`函数的文件。虽然我使用的是特定的包，但我认为我的问题相当笼统：

在循环中，我想通过将 a`"t"`与每个单独的文件名连接来创建文件。因此，如果我的目录中有一个名为的文件`"2503"`，我想在 R 中创建一个名为`"t2503"`. 接下来，我想使用该`r.tucson`函数将数据读取到每个数据帧。我没有将读入的数据分配给数据帧，而是用数据覆盖连接。有人可以帮我弄清楚我错过了什么步骤吗？

这是我尝试使用的代码：

```
#set to appropriate directory
setwd("C:/work")

#get a list of files in the directory
files <- list.files()
numfiles <- length(files)

for (i in 1:numfiles)
{
    name<-paste("t",files[i],sep="")
    name<-read.tucson(files[i],header=NULL)
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-18T20:30:12.353

我想你自己给出了答案：你必须使用`?assign`.

尝试这样的事情：

```
for (i in 1:5) {
  assign(paste0("DF", i), data.frame(A=rnorm(10), B=rnorm(10)))
} 
```

这循环从 1 到 5 的整数并创建五个 data.frames “DF1”到“DF5”。对于您的示例，您应该只替换

```
name<-read.tucson(files[i],header=NULL) 
```

和

```
assign(name, read.tucson(files[i],header=NULL)) 
```

但是请注意，这`name`是 R 中的基本函数，因此我将使用另一种命名约定或跳过第一行：

```
assign(paste("t",files[i],sep=""), read.tucson(files[i],header=NULL)) 
```

我希望这就是你要找的。

# android - 制作一个可以在两个安卓设备之间建立连接的安卓应用

> ID：13940479
> 
> 赞同：0
> 
> 时间：2012-12-18T19:54:36.207
> 
> 标签：android

我是android开发的新手。我想制作一个可以将我的android智能手机连接到我的android平板电脑的应用程序。我希望能够在两种设备之间发送/接收一些东西，例如来自android手机的实时视频源到平板电脑，从手机到平板电脑的 GPS 坐标等等。我希望通过 WiFi、蓝牙或 3G 进行连接。我想知道这样的应用程序是否可行，在积极的情况下，我应该从哪里开始实现我的目标？感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:02:06.797

对的，这是可能的。

您可以从查看[此](http://developer.android.com/training/basics/firstapp/index.html)开始。

希望对你有帮助

# javascript - 如何获得代码的“输出”以保持在同一页面上？HTML 表单？

> ID：13940481
> 
> 赞同：0
> 
> 时间：2012-12-18T19:54:55.357
> 
> 标签：javascript, html, screen

我是 JavaScript 和 HTML 的初学者。

我正在用 JavaScript 编写将“中缀转换为后缀”的代码。

用户将他们“想要的数学表达式”输入到一个表单（由 html 制作）中，然后按下一个按钮来评估中缀表达式的解决方案。

但是程序在编写解决方案之前会清除页面。

我不希望解决方案出现在已清除的页面上。我希望它出现在原始页面、文本框或其他任何内容中。但我无法让文本框“输出”任何东西。

请帮忙？最感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T19:58:15.307

要将文本插入现有文本框，您需要做两件事。

1.  您需要获取文本框的 DOM 元素。
2.  您需要在文本框上设置正确的属性才能将值放入其中。

有很多方法可以获取文本框的 DOM 元素。 `document.getElementById()`是最简单的。您在文本框 HTML 上放置一个 id="whatever" 属性，然后用于`document.getElementById("whatever")`获取 DOM 元素。

这是最简单的例子：

HTML：

```
<textarea id="mytext"></textarea>​ 
```

Javascript：

```
var element = document.getElementById("mytext");
element.value = "This is my text"; 
```

​ 工作演示：http: [//jsfiddle.net/jfriend00/b4mNP/](http://jsfiddle.net/jfriend00/b4mNP/)

* * *

请勿`document.write()`在文档加载完成后尝试使用。这只会清除现有文档并开始编写新文档。

您还必须确保您没有正在提交表单的表单（因为这也会清除页面）并且您没有单击将转到 href 的链接。

# entity-framework - Entity Framework 5 在选择时排除属性

> ID：13940484
> 
> 赞同：2
> 
> 时间：2012-12-18T19:55:05.750
> 
> 标签：entity-framework, asp.net-mvc-4

找不到任何匹配的解决方案。让我们切入正题：MVC4 应用程序、EF 和 CodeFirstSharpMembership 提供程序。
有实体

```
 public class User
{
    ...
    public virtual ICollection<Role> Roles { get; set; }
} 
```

和标准角色实体：

```
public class Role
{
    ...
    public virtual ICollection<User> Users { get; set; }
} 
```

当然，当我尝试使用 FK 为用户创建自己的实体时

```
public class MyEntity
{
    ...
    public virtual User Developer { get; set; }
} 
```

我总是得到自引用循环，因为用户引用角色，角色引用用户。
然后我试着

```
Context = new DataContext();
Context.Configuration.LazyLoadingEnabled = false; 
```

为了避免选择任何外键，并在选择某些东西之后

```
var Developers = Context.MyEntities; 
```

当然，我的 IQueryable 没有“开发人员”字段。
然后我尝试：

```
var Developers = Context.MyEntities.Include("Developer"); 
```

当然还有自引用循环。

如何继续选择 FKey 并从用户中排除“角色”字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:40:35.450

除非您使用无法处理自引用的方法（如序列化），否则自引用实体应该没有问题。如果您遇到序列化问题（我不得不猜测，因为您没有提供任何您试图生成错误消息的内容，很可能是序列化或数据绑定，我根本不知道）所以我建议：

[关闭 DbContext 上的代理对象创建。](https://stackoverflow.com/a/9577852/209259)

```
DbContext.Configuration.ProxyCreationEnabled = false; 
```

通常这种情况是因为应用程序正在使用 POCO 对象（T4 生成或代码优先）。当实体框架想要跟踪未内置于 POCO 对象中的对象中的更改时，就会出现问题。为了解决这个问题，EF 创建了缺少 POCO 对象中的属性且不可序列化的代理对象。

我还要补充一点，你有一个[XY 问题](https://meta.stackexchange.com/a/66378)。您在问如何排除一个属性（Y 问题），因为您认为它会解决一个问题（X 问题），它可能会也可能不会。实际上，您需要说明源问题（X），因为很可能存在根本不需要（Y）的解决方案（如我所描述的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:32:07.867

我的应用程序中有一个非常相似的结构，它也有用户和角色。我为我的应用程序所做的（这可能是你的答案）是我有第三个对象，UserRole，它在用户表和角色表之间建立了一个链接表。UserRole 对象中的唯一项目是 User 和 Role 表的 FK。然后将 User 切换为拥有 a `List<UserRole> Roles`，您可以从 Role 对象中删除 User 引用。

让我知道这是否有效。

编码：

```
public class UserRole
{
    [Key, ForeignKey("User"), ColumnAttribute(Order=0)]
    public int UserID { get; set; }

    [Key, ForeignKey("Role"), ColumnAttribute(Order = 1)]
    public int RoleID { get; set; }

    public virtual GaiaUser User { get; set; }

    public virtual Role Role { get; set; }
} 
```

# wordpress - 包装器 div 不显示内容。Firefox中的wordpress

> ID：13940487
> 
> 赞同：0
> 
> 时间：2012-12-18T19:55:16.770
> 
> 标签：wordpress, firefox, wrapper

我想我通过标题对它进行了很多解释，但我会尝试更多地解释它。

我有一个我制作的 Wordpress 主题。它在 chrome 和 IE8 中运行良好，但是当我在 Firefox 上使用它时，'wrapper' div 中的所有内容都不会显示，并且 wrapper 中的所有内容（页脚和'top' div）都会显示。

这是我的模板页面之一，结构重新组合在一起：

```
 <!DOCTYPE html>
            <html>
            <head>
                <title><?php bloginfo('name'); ?><?php wp_title(); ?></title>
                <link rel='stylesheet' href='<?php bloginfo('stylesheet_url'); ?>' type='text/css' media='screen'/>

                <link href='http://fonts.googleapis.com/css?family=Playfair+Display+SC' rel='stylesheet' type='text/css'>

                <link rel='shortcut icon' type='image/x-icon' href='<?php bloginfo('template_url'); ?>/images/icon.ico' />

                <?php wp_head(); ?>
            </head>

            <body>
            <div id='top'></div>
            <div id='wrapper'>
                <div id='header'>
                    <div id='logo' class=''><p>Niagara Islamic School</p></div>
                    <ul id='navigation' class='f-right'>
                        <?php wp_list_pages('title_li='); ?>
                        <li><div id='nav-border'></div></li>
                    </ul>
                </div>
                <div id='pre-content' class=''>
                        <div id='introduction' class=''>
                            <h2>Introduction</h2>
                                <?php query_posts('category_name=Introduction'); if(have_posts()) : the_post(); ?>
                                <?php the_content(); ?>
                                <?php endif; ?>
                        </div>
                        <div id='current' class=''>
                            <div id='slider' class=''><?php if ( function_exists( 'soliloquy_slider' ) ) soliloquy_slider( '61' );?></div>
                        </div>
                </div>
                <div id='content' class=''>
                        <div id='news' class=''>
                            <h2>News/ Updates</h2>
                            <?php query_posts('category_name=News'); if(have_posts()) : the_post(); ?>
                            <h4>Posted on <?php the_time('F jS, Y') ?></h4>
                                <?php the_content(); ?>
                            <?php endif; ?>
                        </div>
                        <?php get_sidebar(); ?>
                </div>
            </div>
            <div id='footer' class=''>
                <div id='inside-footer' class=''>
                    <ul id='sitemap' class='footer-head'>
                                    <li class='sidebar-head'><h4><?php _e('Navigation'); ?></h4></li>
                                    <?php wp_list_pages('title_li='); ?>

                    </ul>
                    <ul id='quick-links' class='footer-head'>
                                    <li class='sidebar-head'><h4><?php _e('Quick Links'); ?></h4></li>
                                    <?php wp_get_linksbyname('Quick Links','orderby=name&show_description=0&show_updated=1') ?>
                                    <li class=''><a href='#' class=''>Coming Soon</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>

                    </ul>
                    <ul class='footer-head'>
                                    <li class='sidebar-head'><h4><?php _e('Other Links'); ?></h4></li>
                                    <?php wp_get_linksbyname('Other Links','orderby=name&show_description=0&show_updated=1') ?>
                                    <li class=''><a href='#' class=''>Coming Soon</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                                    <li class=''><a href='#' class=''>link here</a></li>
                    </ul>

                    <div id='right-footer'>
                        <a href='#top' id='back-up'>top ^</a>
                        </br>
                        </br>
                        </br>
                        <h4>Call us at:</h4>
                        <label class='phone'>905-295-4845</label></br>
                        <label class='phone'>905-295-0268</label>
                    </div>
                </div>

            </div>
            <div id='footer-bottom'></div>

            </body>
            </html> 
```

谢谢你。

**编辑 CSS**

```
#wrapper{
position: relative;width: 94%; margin: 0 auto; overflow: hidden;
}
#content{
width: 100%; min-height: 600px; float: left; padding: 0px;
}
#news{
width: 50%; min-height: 600px; margin: 0 15px 100px 0; padding: 15px; background: #FAFAFA;
} #news h2{text-transform: capitalize; color: #dd771c; text-decoration: underline;}
#news h5{
padding: 5px 0 5px 0;text-transform: capitalize; color: #dd771c;
}
#news p{
text-align: justify;} #news h4{padding-bottom: 50px; text-align: left;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:46:43.343

哈哈，你是对的**janw**，它是 CSS。

我不得不从#wrapper 中删除溢出属性。

谢谢你。

# firefox - Firefox 扩展包括引导程序和内容

> ID：13940488
> 
> 赞同：0
> 
> 时间：2012-12-18T19:55:18.053
> 
> 标签：firefox, firefox-addon, xul

我想使用 bootstrap 和 chrome/content 创建 Firefox 扩展。当我第一次安装这个扩展时，firefox 忽略了组件和覆盖。然后我关闭并打开了 boostrap 功能，扩展运行良好。我在这里读到[https://developer.mozilla.org/en-US/docs/Extensions/Bootstrapped_extensions](https://developer.mozilla.org/en-US/docs/Extensions/Bootstrapped_extensions)这是正常的。但我不明白如何同时使用这两种功能进行扩展。

对不起，我的英语不好。如果你愿意，我会尽力解释得更好。任何帮助将不胜感激

ps 正如我在这里读到的[https://stackoverflow.com/a/11031908/1735150](https://stackoverflow.com/a/11031908/1735150)没有办法同时使用引导程序和覆盖。但它为什么有效？以及如何在引导程序中包含 js 文件？

## **回答**

[如何更改Firefox插件上的脚本位置？](https://stackoverflow.com/questions/13279883/how-to-change-script-location-on-firefox-addon)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:15:58.427

您需要手动执行叠加层的操作`bootstrap.js`，即在 UI 中动态创建、添加和修改元素。

但是为什么要保持与无重启和非重启的兼容性呢？对于旧版本的 Firefox？恐怕这将是一场维护噩梦......

# json - IE8 上的主干获取响应失败

> ID：13940490
> 
> 赞同：0
> 
> 时间：2012-12-18T19:55:28.330
> 
> 标签：json, google-app-engine, backbone.js, fetch

我有一个骨干项目，它正在调用返回 JSON 数据的 Google App Engine 上的服务。没有调用主干集合“解析”，也没有在主干中收到错误...这个问题似乎仅限于 IE8，因为 IE7 和 IE9 确实有效。Chrome、Firefox 等……都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:26:19.157

这原来是 IE8 中的跨域问题。我通过将 XDomainRequest 添加到我的主干集合中的初始化来修复它。

```
initialize: function(){
            $this = this;

            //fix for IE8 and IE9
            if ($.browser.msie && parseInt($.browser.version, 10) <= 9 && window.XDomainRequest) {
                var xdr = new XDomainRequest();

                xdr.open("get", "http://localhost:8080/service");
                xdr.onload = function(){
                    $this.parse($.parseJSON(xdr.responseText));
                };
                xdr.send();
            }
        }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T15:29:24.633

对于任何未来的用户，我建议查看这个插入式脚本来扩展 Backbone 的 ajax 功能并自动添加对旧 IE 浏览器的支持。与 OP 的答案类似，因为它添加了 xDomainRequests，但对您的工作较少。:-)

[https://github.com/victorquinn/Backbone.CrossDomain](https://github.com/victorquinn/Backbone.CrossDomain)

# ruby-on-rails - Rails 3.2.9 接受_nested_attributes_for 混淆

> ID：13940494
> 
> 赞同：0
> 
> 时间：2012-12-18T19:55:38.600
> 
> 标签：ruby-on-rails, associations, belongs-to

我有一个模型事件和一个模型 Serie。它们的定义如下：

```
在事件.rb

所属：系列
接受嵌套属性：系列
attr_accessible ：系列

在 serie.rb

has_many :事件

```

事件表具有 serie_id 键。

在活动表格中，我几乎有以下内容：

```
form_for @event 做 |f|
   ...
   ...
   f.fields_for @event.serie 做 |serie_f|
     ……
   结尾
 结尾

```

对控制器的请求是这样的：

```
... "事件"=>{...., "serie"=>{"..."=>"19/12/2012", ....}, ...}...

```

在 events_controller 的创建操作中，我有：

```
定义创建
  @event = current_user.events.new(params[:event])
  ……

```

在这一行中，我收到以下错误：

```
ActiveRecord::AssociationTypeMismatch (Serie(#134112340) 预期，得到 ActiveSupport::HashWithIndifferentAccess(#92663620))

```

不确定问题是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:05:29.677

您应该检查这个问题：[ActiveRecord::AssociationTypeMismatch 尝试在 Rails 中保存嵌套属性时](https://stackoverflow.com/questions/5011022/activerecordassociationtypemismatch-when-attempting-to-save-nested-attributes)。
我认为你只需要在你的模型中替换`attr_accessible :serie`为。 在您看来，尝试而不是`attr_accessible :serie_attributes`
`f.fields_for :serie do |serie_f|``f.fields_for @event.serie do |serie_f|`

# c# - 如何在 C# 中获取 Java Web 服务请求

> ID：13940496
> 
> 赞同：1
> 
> 时间：2012-12-18T19:55:42.253
> 
> 标签：c#, web-services

> **可能重复：**
> [如何查看我的客户端应用程序发送的 SOAP 数据？](https://stackoverflow.com/questions/439430/how-to-see-soap-data-my-client-application-sends)

我正在使用来自 C# Windows 窗体应用程序的 Java Web 服务，但 Web 服务抛出错误，因此我需要检查请求 XML 以验证我发送到 Web 服务的数据。

在 C# 中，有没有办法获取或查看此 XML 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:00:25.230

我建议为此使用[Fiddler](http://www.fiddler2.com/fiddler2/)工具。Fiddler 允许您监控从您的机器发送的请求/响应。

# hive - 如何为所有会话创建配置单元 UDF

> ID：13940498
> 
> 赞同：2
> 
> 时间：2012-12-18T19:55:57.443
> 
> 标签：hive

我可以创建一个 UDF 并使用`CREATE TEMPORARY FUNCTION`. 有没有办法做到这一点，并让这个功能可用于所有用户的所有未来会话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:55:34.803

要使用 UDF，您需要 2 个步骤：

1.  使 UDF jar 可用于集群中的所有节点。这通常是通过以下命令将其添加到集群的分布式缓存中来完成的`ADD JAR my_jar.jar`
2.  注册您的 UDF，以便 Hive 可以识别它。这基本上将 UDF 的名称（例如 from_unixtime）与 UDF 的类（org.apache.hadoop.hive.ql.udf.FromUnixTime）联系起来。这通常由类似的命令完成`CREATE TEMPORARY FUNCTION from_unixtime AS 'org.apache.hadoop.hive.ql.udf.FromUnixTime';`

因此，为了让所有用户都可以使用 UDF，您必须执行上述 2 个步骤。对于 #1，您可以`export HIVE_AUX_JARS_PATH = <path to the folder>`在 hive-env.sh 中执行类似的操作，以使 jar 可用。

获得 #2 很棘手，最好的方法是在 Hive 元存储中支持 UDF 名称和类名称之间的链接。然而，目前情况并非如此。因此，没有真正的好方法可以做到这一点。

我建议使用 .hiverc 文件，它同时执行上面的 #1 和 #2。将它放在你的主目录或 hive bin 目录中（尽管一个补丁正在工作中以从 hive conf 目录中获取它）。唯一的问题是它仅在用户通过 CLI 访问 hive 时才有效。如果您使用的是 JDBC，则必须在 Hive 会话开始时手动获取该文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-18T07:45:27.850

您能否在以下位置找到 .hiverc 文件：$HIVE_HOME/bin/.hiverc 和 $HOME/.hiverc？如果你找到一个然后打开文件并在那里添加你的 CREATE TEMPORARY FUNCTION 命令。然后每次启动 hive 时都会加载此 .hiverc 文件，因此您的 UDF 将被注册用于所有 HIVE 会话。

阿秋

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-25T01:40:07.503

Expanding on the above answers: in order to truly make UDF's available to all users/sessions it is required:

*   add the UDF to the hive libs/ directory and/or HIVE_AUX_JARS_PATH
*   add the function to the **FunctionRegistry** class and recompile hive. Yes. not so fun ;)

From the Hive Bible (Programming Hive):

```
Here is an example change to FunctionRegistry where the new nvl() function is added
to Hive’s list of built-in functions:
...
registerUDF("parse_url", UDFParseUrl.class, false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-14T18:29:11.060

[如何在 hive 中添加永久功能](https://stackoverflow.com/questions/20043448/how-to-add-a-permanent-function-in-hive)的答案之一？指出自 Hive 13 以来，CREATE FUNCTION 功能可用于永久功能，如[https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-PermanentFunctions](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-PermanentFunctions)所述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-16T08:21:34.347

从 hive 0.13 开始，UDF 可以存储在 Metastore 中，并且可以在查询中引用

```
CREATE FUNCTION [db_name.]function_name AS class_name
  [USING JAR|FILE|ARCHIVE 'file_uri' [, JAR|FILE|ARCHIVE 'file_uri'] ]; 
```

例子 ：

```
CREATE FUNCTION woy AS 'com.udf.hive.WOYUDF' USING JAR 'hdfs:///user/root/udfhive-1.0-SNAPSHOT.jar'; 
```

# javascript - 谷歌地图 api 不断在 Firefox 上加载

> ID：13940500
> 
> 赞同：3
> 
> 时间：2012-12-18T19:55:58.740
> 
> 标签：javascript, google-maps-api-3

我在上面使用谷歌地图的页面一直在 Firefox 上加载，上面写着“等待 maps.googleapis.com ..”地图显示正确，但网站上的其他一些内容（如 youtube 视频）未加载，因为此地图未完成加载

使用的代码是

```
var is_init = false;
var map;
function map_init() {
    var latlng = new google.maps.LatLng(-33.65578083204094, 138.9385986328125);
    var myOptions = {
        zoom: 9,
        center: latlng,
        scrollwheel: false,
        panControl: false,
        zoomControl: true,
        mapTypeControl: false,
        scaleControl: true,
        streetViewControl: true,
        overviewMapControl: false,
        mapTypeId: google.maps.MapTypeId.HYBRID     };
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    var marker;
    var latlng;

            is_init = true;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T16:30:19.657

确保在 onload 事件中初始化地图。

如果您使用 jQuery：

```
$(window).load(map_init); 
```

这解决了我的问题。

# android - Android 应用程序在启动时崩溃

> ID：13940501
> 
> 赞同：1
> 
> 时间：2012-12-18T19:56:00.107
> 
> 标签：android, string, crash, android-edittext, logcat

我已经做了这个应用程序，但是当我尝试吃午饭时，它立即关闭。这是我的 Principale.java：

```
package com.gabriele.progetti;

import android.R.string;
import android.os.Bundle;
import static java.lang.Math.*;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;

public class Principale extends Activity 
{
    private EditText edittext1, edittext2, edittext3;
    private TextView textview1;
    int A,B,C;

protected void onCreate(Bundle savedInstanceState)  // Sarebbe come il main
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_principale);

    Calcoliamo();

}
// ;)

public void Calcoliamo()
{
    edittext1 = (EditText) findViewById(R.id.editText1);
    edittext2 = (EditText) findViewById(R.id.editText2);
    edittext3 = (EditText) findViewById(R.id.editText3);

    A = Integer.parseInt(edittext1.getText().toString());
    B = Integer.parseInt(edittext2.getText().toString());
    C = Integer.parseInt(edittext3.getText().toString());

    int Delta = (B * B)*4*(A * C);
    double RadiceDelta = sqrt(Delta);
    String Risultato = String.valueOf(RadiceDelta);

    textview1.setText("Il risultato del deltà è:" + Risultato);
            setContentView(textview1);
}       
} 
```

这是我的activity_principale.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".Principale" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="35dp"
        android:layout_marginTop="18dp"
        android:text="Inserisci a" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView1"
        android:layout_below="@+id/textView1"
        android:ems="10"
        android:inputType="numberSigned" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText1"
        android:layout_below="@+id/editText1"
        android:text="Inserisci b" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView2"
        android:layout_below="@+id/textView2"
        android:ems="10"
        android:inputType="numberSigned" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText2"
        android:layout_below="@+id/editText2"
        android:text="Inserisci c" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView3"
        android:layout_below="@+id/textView3"
        android:ems="10"
        android:inputType="number" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/textView3"
        android:layout_below="@+id/editText3"
        android:layout_marginTop="46dp"
        android:text="" />

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText3"
        android:layout_alignTop="@+id/textView4"
        android:text="TextView" />

</RelativeLayout> 
```

当我启动它时，LogCat 说：

```
12-18 20:50:12.278: D/AndroidRuntime(326): Shutting down VM
12-18 20:50:12.278: W/dalvikvm(326): threadid=1: thread exiting with uncaught exception (group=0x40015560)
12-18 20:50:12.288: E/AndroidRuntime(326): FATAL EXCEPTION: main
12-18 20:50:12.288: E/AndroidRuntime(326): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.gabriele.progetti/com.gabriele.progetti.Principale}: java.lang.NullPointerException
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.os.Handler.dispatchMessage(Handler.java:99)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.os.Looper.loop(Looper.java:123)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread.main(ActivityThread.java:3683)
12-18 20:50:12.288: E/AndroidRuntime(326):   java.lang.reflect.Method.invokeNative(Native Method)
12-18 20:50:12.288: E/AndroidRuntime(326):   java.lang.reflect.Method.invoke(Method.java:507)
12-18 20:50:12.288: E/AndroidRuntime(326):   com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-18 20:50:12.288: E/AndroidRuntime(326):   com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-18 20:50:12.288: E/AndroidRuntime(326):   dalvik.system.NativeStart.main(Native Method)
12-18 20:50:12.288: E/AndroidRuntime(326): Caused by: java.lang.NullPointerException
12-18 20:50:12.288: E/AndroidRuntime(326):   com.gabriele.progetti.Principale.Calcoliamo(Principale.java:45)
12-18 20:50:12.288: E/AndroidRuntime(326):   com.gabriele.progetti.Principale.onCreate(Principale.java:24)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-18 20:50:12.288: E/AndroidRuntime(326):   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
12-18 20:50:12.288: E/AndroidRuntime(326):  ... 11 more 12-18
20:50:14.208: I/Process(326): Sending signal. PID: 326 SIG: 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:01:08.467

`textview1`调用时没有设置`textview1.setText()`，你需要做

```
texttext1 = (TextView) findViewById(R.id.textView1); 
```

为了防止其他错误，最好在使用前检查 findViewbyId 的结果以确保它们不为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T19:59:29.393

在将其解析为 Integer 之前，您需要先检查 EditText 是否为 Null 或 Empty：

```
 if(edittext1.getText().toString()!=null &&
         edittext1.getText().toString().length() !=0){
    A = Integer.parseInt(edittext1.getText().toString());
     }
    else{
            // set default value here
              A=0;
      }
   if(edittext1.getText().toString()!=null && 
           edittext1.getText().toString().length() !=0){
       B = Integer.parseInt(edittext2.getText().toString());
      }
    else{
            // set default value here
             B=0;
      }
   if(edittext1.getText().toString()!=null && 
       edittext1.getText().toString().length() !=0){
      C = Integer.parseInt(edittext3.getText().toString());
    }
    else{
            // set default value here
              C=0;
      }
  //your code here 
```

# mysql - SQL中如何获取频繁的时间间隔？

> ID：13940503
> 
> 赞同：1
> 
> 时间：2012-12-18T19:56:05.137
> 
> 标签：mysql, logging, login

请原谅我这个简单的问题，但我不是 MySQL 方面的专家。我需要从名为 `detailed_log`. 问题是我不知道如何列出经常*出现登录错误*的用户（比如少于 5 分钟）。

在这里我按顺序列出我们拥有的内容（我按时间简要排序并删除了不必要的列）

```
SELECT user_name, 
time, 
SUBSTR(status, 1, 8) AS status 
FROM detailed_log 
WHERE (status LIKE '%LOGINERR%' OR status LIKE '%LOGINOK%') 
ORDER BY time 
```

这就是结果

![结果](../Images/99129c1ecb004963fa28e98e4d1a8b6c.png)

**那么谁能说我如何列出间隔<5分钟的每个用户的登录错误？**
**编辑：**为了澄清我添加了以下示例：

![在此处输入图像描述](../Images/fb09542cc271e2a13941b458c8f49f12.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:36:37.127

通过将表连接到自身，您可以获得不到 5 分钟前还有另一个 LOGINERR 的 LOGINERR。

```
SELECT l1.user_name, l1.time
FROM detailed_log AS l1
JOIN detailed_log AS l2 ON l2.user_name = l1.user_name
WHERE l1.status LIKE 'LOGINERR' AND l2.status LIKE 'LOGINERR'
AND l1.time > l2.time
AND l1.time < (l2.time + INTERVAL 5 MINUTE) 
```

一些分组，你可以得到一个总结：

```
SELECT l1.user_name, MAX(l1.time) AS latest, COUNT(DISTINCT l1.time) AS tries
FROM detailed_log AS l1
JOIN detailed_log AS l2 ON l2.user_name = l1.user_name
WHERE l1.status LIKE 'LOGINERR' AND l2.status LIKE 'LOGINERR'
AND l1.time > l2.time
AND l1.time < (l2.time + INTERVAL 5 MINUTE)
GROUP BY l1.user_name 
```

# c++ - iarcs WORDLIST 运行时分段错误

> ID：13940510
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:56:54.680
> 
> 标签：c++, runtime, segmentation-fault

**为什么以下给出了 IARCS 报告的分段错误？**

我在 Codeblocks 中编写了程序，它编译并运行良好。但是 g++ 报告运行时段错误。为什么会这样？问题是 ：

在这个问题中，输入将由多行英文文本组成，其中包括英文字母、标点符号 '（撇号）、. (句号), , (逗号), ; （分号）、:（冒号）和空白字符（空格、换行符）。您的任务是以字典顺序（即字典顺序）打印文本中的单词。每个单词都应该在您的列表中出现一次。您可以忽略大小写（例如，“The”和“the”将被视为同一个单词。）输出中不应有大写字母。

例如，考虑输入文本的以下候选： 这是用于说明此问题的示例文本。

相应的输出将显示为：

一个说明是一块问题示例文本这个到

输入格式

输入的第一行包含一个整数 N，表示输入的行数。接下来是 N 行输入文本。

输出格式

输出的第一行包含一个整数 M，表示给定文本中不同单词的数量。接下来的 M 行按字典顺序列出了这些单词。

测试数据

您可以假设 N ≤ 10000 并且每行最多有 80 个字符。您还可以假设给定文本中最多有 1000 个不同的单词。

例子

我们现在使用上面的例子来说明输入和输出格式。

样本输入

2

这是一个示例文本来说明这一点

问题。

样本输出

10

一个

阐明

是

的

片

问题

样本

文本

这个

至

```
#include <iostream> 
#include <cstring> 
#include <cstdlib> 
using namespace std;

int intcompare(const void *i, const void *j)
{
    return (strcmp(*(char **)i, *(char **)j));
}

void strToLower(char *str)
{
    int i, count=0;
    for (i = 0; *str != '\0'; i++)
    {
        *str = (char)tolower(*str);
        str++;
        count++;
    }

    while((count--)!=0) str--;
}

int main()
{
    int noOfLines, maxCharPerLine=80;
    char delim[]= {'\'', '.', ',', ';', ':', '\n', ' '};
    char line[maxCharPerLine+1];

    cin>>noOfLines;
    cin.get(); 
    char *tokens[maxCharPerLine+1];
    char *temp; 
    int tokcount=-1;

    int flag;
    for(int i=1; i<=noOfLines; i++) 
    {

       cin.getline(line, maxCharPerLine+1); /
        flag=0;
        temp=strtok(line, delim);
        strToLower(temp);
        tokens[++tokcount]=(char *)malloc(maxCharPerLine+1);
        strcpy(tokens[tokcount], temp);
        while(temp!=NULL) 
        {

            strToLower(temp);
            if(flag==1)
            {
                if((char *)bsearch(&temp, tokens, tokcount+1, sizeof(tokens[0]), intcompare)==NULL) {
                    tokens[++tokcount]=(char *)malloc(maxCharPerLine+1);
                    strcpy(tokens[tokcount], temp);
                    qsort(tokens, tokcount+1, sizeof(tokens[0]), intcompare);
                }
            }
            temp= strtok(NULL, delim);
            flag=1;
        }
    }
    cout<<tokcount+1<<endl;
    for(int i=0; i<=tokcount; i++)
    {
        cout<<tokens[i]<<endl;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:12:37.530

每当您看到 SEGFAULT 时，下一步（除非您立即知道自己做错了什么）是启动 GDB 或其他调试器。如果您使用 GCC 并且没有使用 -ggdb 标志编译您的程序，那么现在就这样做。然后在 GDB 下启动你的程序并“运行”它。当发生段错误时，发出命令“bt”（回溯），它应该向您显示当前的调用链，这是程序段错误时您所在位置的路线图。通常这会指出你正确的问题。如果没有，至少您知道在哪里进行更多调试。

# python - 在 Ruby 中使用高阶函数

> ID：13940515
> 
> 赞同：5
> 
> 时间：2012-12-18T19:57:21.640
> 
> 标签：python, ruby, function

在学习 Python 之后，我现在正在尝试学习 Ruby，但我无法将此代码转换为 Ruby：

```
def compose1(f, g):
    """Return a function h, such that h(x) = f(g(x))."""
    def h(x):
        return f(g(x))
return h 
```

我必须使用块翻译吗？或者 Ruby 中是否有类似的语法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T20:10:11.083

您可以在 Ruby 中使用 lambdas 执行此操作（我在这里使用 1.9 stabby-lambda）：

```
compose = ->(f,g) { 
  ->(x){ f.(g.(x)) }  
} 
```

`compose`返回另一个函数的函数也是如此，如您的示例所示：

```
f = ->(x) { x + 1 }
g = ->(x) { x * 3 }

h = compose.(f,g)
h.(5) #=> 16 
```

请注意，函数式编程并不是 Ruby 的真正强项——它可以完成，但在我看来它看起来有点混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:04:24.980

可以说`f`是`g`以下方法：

```
def f(x)
  x + 2
end

def g(x)
  x + 3
end 
```

我们可以定义`compose1`为：

```
def compose1(f,g)
  lambda { |x| send(f, send(g, x) ) }
end 
```

为此，我们需要将 h 定义为：

`h = compose1(:f, :g)`

您需要将方法名称作为字符串/符号`send`传递才能工作。然后，你可以做

`h.call 3 # => 8`. 更多信息可以在[这里找到](http://www.ruby-forum.com/topic/54433)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T20:11:01.430

使用 lambda

```
def compose1(f,g)
  return lambda{ |x| f.call(g.call(x)) }
end 
```

跑步的例子

```
compose1(lambda{|a| a + 1}, lambda{|b| b + 1}).call(1) 
```

# php - 防止电子邮件进入垃圾邮件

> ID：13940517
> 
> 赞同：3
> 
> 时间：2012-12-18T19:57:32.657
> 
> 标签：php, html, email, html-email, spam

所以我正在使用 PHP 的 mail() 命令向人们发送电子邮件，但它最终会出现在他们的垃圾文件夹中......

我知道垃圾邮件会过滤电子邮件的主题/正文以获得可疑的标题/正文，但是在撰写我的主题/正文时有哪些指导方针，以使它们不会被发送到垃圾邮件？

目前这里是我的主题/正文

主题：

```
New object request 
```

身体：

```
<p>A new object request has been submitted</p>
<p>Object Info</p>
<ul>
  <li>Category: Cat</li>
  <li>Object Name: Legitimate Object</li>
  <li>Street Address: Legitimate Address</li>
  <li>City: Awesome City</li>
  <li>State/Country: Country</li>
  <li>ZIP/Postal Code: 10001</li>
  <li>Website: </li>
  <li>Comment: </li>
</ul>
<p>User Info</p>
<ul>
  <li>Name: vjaklfjsd2795 cvkljasdfl</li>
  <li>Email: vlkafjlsdf@sdafsaf.com31784</li>
  <li>UID: 48482</li>
</ul> 
```

使用 php 的 mail() 并且消息被移动到垃圾文件夹......我的消息有什么问题，我能做些什么来改进它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:12:06.593

垃圾邮件过滤器的内部运作是一个严密保密的秘密——如果垃圾邮件发送者知道不该做什么，他们就可以绕过垃圾邮件过滤器。

然而，你的邮件正文似乎避免了明显的迹象——你没有提出扩大任何内容，或者让我们变得富有。

以下是一些链接：

*   [http://kb.mailchimp.com/article/how-spam-filters-think](http://kb.mailchimp.com/article/how-spam-filters-think) - 主要是关于要避免的词。
*   [http://en.wikipedia.org/wiki/Anti-spam_techniques](http://en.wikipedia.org/wiki/Anti-spam_techniques)（尤其是[http://en.wikipedia.org/wiki/Anti-spam_techniques#PTR.2Freverse_DNS_checks](http://en.wikipedia.org/wiki/Anti-spam_techniques#PTR.2Freverse_DNS_checks) - 鉴于您的邮件内容，我认为更有可能一个DNS的东西）
*   [http://www.emaildeliveryjedi.com/dns-configuration.php](http://www.emaildeliveryjedi.com/dns-configuration.php) - 关于 DNS 的更多信息

# java - 在 gwt 中放置图像的位置？

> ID：13940518
> 
> 赞同：4
> 
> 时间：2012-12-18T19:57:42.770
> 
> 标签：java, gwt

我正在尝试在 GWT 中加载一个简单的图像。但它永远找不到。

```
 import com.google.gwt.user.client.ui.Image;

    public class ImageTest implements EntryPoint {
        Image image = new Image("test.png");
    } 
```

结果：

```
[WARN] 404 - GET /test.png (127.0.0.1) 1394 bytes
   Request headers
      Host: 127.0.0.1:8888
      User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0
      Accept: image/png,image/*;q=0.8,*/*;q=0.5
      Accept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3
      Accept-Encoding: gzip, deflate
      Connection: keep-alive
      Referer: http://127.0.0.1:8888/ImageTest.html?gwt.codesvr=127.0.0.1:9997
   Response headers
      Content-Type: text/html; charset=iso-8859-1
      Content-Length: 1394 
```

`test.png`放置在与类相同的目录中`ImageTest`。我也试着把它放在`src/main/resources`. 同样的错误。

图像必须位于何处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T20:02:17.810

您需要将它们放在您的`webapp`目录中（在 GWT 设置中指定为 WAR 目录，靠近您的`index.html`文件）。

否则，您需要指定相对路径，例如`resources/images/yourimg.png`for `src/main/webapp/resources/images/yourimage.png`。

另一种方法是使用 Client Bundle：

```
public interface AppBundle extends ClientBundle {

    @Source("image.png")
    ImageResource myImage();

    AppBundle INSTANCE = GWT.create(AppBundle.class);

} 
```

然后在您的代码中：

```
AppBundle.INSTANCE.myImage(); 
```

在这种情况下，您的图像应该与您的 AppBundle 类放在同一个包中。

# r - 更新 data.table 的多个列

> ID：13940525
> 
> 赞同：11
> 
> 时间：2012-12-18T19:57:58.940
> 
> 标签：r, data.table

是否可以在同一语句中更新超过 1 列的 data.table？

就像是

```
dt[,onecol:=1 anothercol:=2] 
```

我看过一些他们做的例子

```
dt[,c("onecol","anothercol"):=1] 
```

但我不知道如何为每一列分配不同的公式

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T20:15:08.767

是的，从 1.8.4 版本开始就可以做到这一点：

```
library(data.table)
dt <- data.table(a=1:4, b=4:1)
dt[,c("a", "b") := list(min(a), max(b))]
# dt
#    a b
# 1: 1 4
# 2: 1 4
# 3: 1 4
# 4: 1 4 
```

或者，以更易读的方式做同样的事情：

```
dt <- data.table(a=1:4, b=4:1)
dt[,`:=`(a = min(a),
         b = max(a))]
dt
#    a b
# 1: 1 4
# 2: 1 4
# 3: 1 4
# 4: 1 4 
```

[在当前 data.table NEWS 文件](https://r-forge.r-project.org/scm/viewvc.php/pkg/NEWS?view=markup&root=datatable)中搜索“Multiple LHS”以查看这也适用于`by=`参数。

# google-drive-api - Permission Settings Ignored when creating file

> ID：13940528
> 
> 赞同：0
> 
> 时间：2012-12-18T19:58:02.823
> 
> 标签：google-drive-api

I am using Application Owned Accounts to create a file. However, I would like the ownership of the file to be transfered to other users. The code below works but permission settings are ignored, so I am not the owner of the file. File ownership stays with the Application Owned Account, so files cannot be deleted permanently.

```
public File uploadEmptyFile(String title, String subFolderName, String mimetype) throws GDriveAccessException {
    File fileMetadata = new File();
    fileMetadata.setTitle(title);
    fileMetadata.setMimeType(mimetype);
    Permission newPermission = new Permission();

    newPermission.setValue("xxx@xyz.com");
    newPermission.setType("user");
    newPermission.setRole("owner");

    fileMetadata.setUserPermission(newPermission);
    if (subFolderName==null){
        fileMetadata.setParents(Arrays.asList(new ParentReference().setId(FOLDER_ID)));
    }else{
        fileMetadata.setParents(Arrays.asList(new  ParentReference().setId(getFileIdByFolderNName(null,subFolderName))));
    }

    File faux=null;
    try {
        faux= getDrive().files().insert(fileMetadata).execute();
        return faux;
    } catch (IOException e1) {
    throw new GDriveAccessException(e1);
    }

  } 
```

Any help in identifying why the permission settings are being ignored would be welcome.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:51:39.100

好吧，首先，我发现问题在于无法更改常规谷歌应用程序帐户的所有权。您需要拥有高级许可证才能转移文件所有权。

其次，我发现我真正需要的是模仿：

```
public static Drive getDrive() throws GDriveAccessException {
    if(drive == null) {
        HttpTransport httpTransport = new UrlFetchTransport();
        JacksonFactory jsonFactory = new JacksonFactory();
        GoogleCredential credential;
            credential = new GoogleCredential.Builder()
                  .setTransport(httpTransport)
                  .setJsonFactory(jsonFactory)
                  .setServiceAccountId(SERVICE_ACCOUNT_EMAIL)
                  .setServiceAccountPrivateKey(getPrivateKey())
                  .setServiceAccountScopes(DriveScopes.DRIVE)
                  .setServiceAccountUser("xxx@xyz.com")// Use this property for impersonation
                  .build();
      Drive service = new Drive.Builder(httpTransport, jsonFactory, null)
          .setHttpRequestInitializer(credential).build();
      drive=service;
      return service;
    }
    return drive;
} 
```

如果有关于这个功能的更好的文档，谷歌会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:42:47.190

You need to use [permissions.insert](https://developers.google.com/drive/v2/reference/permissions/insert) as outlined in the [sharing and permissions](https://developers.google.com/drive/manage-sharing) documentation.

# process - 探索 Windows Phone 8 设备的进程/线程？

> ID：13940530
> 
> 赞同：2
> 
> 时间：2012-12-18T19:58:08.123
> 
> 标签：process, windows-phone, windows-phone-8

是否有适用于 Windows Phone 8 设备的类似 Process Explorer 的应用程序？我们正在尝试调试我们认为与流程相关的错误，但很难尝试解决它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:44:37.303

不，您无法访问 Windows Phone 8 上应用程序沙箱之外的进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T01:53:19.920

这仅适用于内部工具，不适用于第 3 方开发人员。相反，请在 MSConnect 或 MSDN 论坛上报告您的疑虑（并提供一个可重现的示例）。

# php - ucfirst () with accent without mbstring enable

> ID：13940541
> 
> 赞同：0
> 
> 时间：2012-12-18T19:58:53.860
> 
> 标签：php

I'm trying to use ucfirst () to capitalize the first letter of a string but when the string contains éàçîô... it won't change it.

String

> GÉNIE CIVIL

Should return

> Génie civil

but return instead

> GÉnie civil

As you can see, it ignored the second letter "É" to be lowercased. I know it's some king of encoding (I'm using UTF-8). Does anyones know how to fix this ?

**Edit**

I don't have mbstring enable, any other solutions ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T00:19:02.157

首先 ucfirst() 做它所说的，它大写第一个字符。因此第二个字符和其他字符不会像你想要的那样调整。您需要 strtolower() 另一个字符（这样做时可能会遇到特殊字符的类似问题，但请进一步看，我在示例中也为您提供了答案）。

现在对于将使用本机 php 函数（如果存在）或模拟它的 mb_ucfirst()，您可以在它们不存在时定义自己的 mb_strtoupper() 和 mb_substr()，但对于这个问题，我将所有内容都包装在一个函数中。

所以我推荐的功能是：

```
<?php 
if (!function_exists('mb_ucfirst'))
{
    function mb_ucfirst($string)
    {
        if (function_exists('mb_strtoupper') && function_exists('mb_substr'))
        {
            return mb_strtoupper(mb_substr($string, 0, 1), 'UTF-8').mb_substr($string, 1);
        }
        else
        {
            // Credit to Quicker at http://php.net/manual/en/function.ucfirst.php
            // If it does not work, replace it with another utf8 ucfirst function
            if ($string{0} >= "\xc3")
            {
                return ($string{1} >= "\xa0"
                        ? ($string{0}.chr(ord($string{1})-32))
                        : ($string{0}.$string{1})).substr($string, 2);
            }
            return ucfirst($string);
        }
    }
}
?> 
```

**补充说明**

您可能还对该库感兴趣：[https](https://github.com/fluxbb/utf8) ://github.com/fluxbb/utf8——大多数编码函数在 /core/native.php 中，在 /functions 中有 ucfirst() 和其他函数。那个可能比我的更受考验，甚至认为我喜欢我的小号只满足你的需要。

**具有许多不同功能的完整示例**

警告：如果您没有 mb_string 模块，您可能需要稍微调整一下代码。

```
<?php
mb_internal_encoding('UTF-8'); // make sure internal encoding is in UTF-8

function escape_html($string)
{
    $charset = 'UTF-8';
    return htmlspecialchars($string, ENT_QUOTES, $charset);
}
/*
function mb_ucfirst($str)
{
    $currentEncoding = mb_internal_encoding();
    mb_internal_encoding('UTF-8');
    preg_match_all("~^(.)(.*)$~u", $str, $arr);
    $str = mb_strtoupper($arr[1][0]).$arr[2][0];
    mb_internal_encoding($currentEncoding);
    return $str;
}*/
if (!function_exists('mb_ucfirst'))
{
    function mb_ucfirst($string)
    {
        if (function_exists('mb_strtoupper') && function_exists('mb_substr'))
        {
            return mb_strtoupper(mb_substr($string, 0, 1), 'UTF-8').mb_substr($string, 1);
        }
        else
        {
            // Credit to Quicker at http://php.net/manual/en/function.ucfirst.php
            // If it does not work, replace it with your favorite utf8 ucfirst function
            if ($string{0} >= "\xc3")
            {
                return ($string{1} >= "\xa0"
                        ? ($string{0}.chr(ord($string{1})-32))
                        : ($string{0}.$string{1})).substr($string, 2);
            }
            return ucfirst($string);
        }
    }
}
$testTexts = array(
    'GÉNIE CIVIL',
    'gÉnie civil',
    'Génie civil',
    'GENIE CIVIL',
    'Epinard',
    'ÉPinard',
    'épinard',
    'epinard',
    'é',
    'Ç',
    'ç',
);

// Credit to leha_grobov php.net/strtolower, I inverted it ;-)
function strtoupper_utf8($string)
{ 
  $convert_from = array( 
    "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", 
    "v", "w", "x", "y", "z", "à", "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í", "î", "ï", 
    "ð", "ñ", "ò", "ó", "ô", "õ", "ö", "ø", "ù", "ú", "û", "ü", "ý", "а", "б", "в", "г", "д", "е", "ё", "ж", 
    "з", "и", "й", "к", "л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "ч", "ш", "щ", "ъ", "ы", 
    "ь", "э", "ю", "я" 
  ); 
  $convert_to = array( 
    "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", 
    "V", "W", "X", "Y", "Z", "À", "Á", "Â", "Ã", "Ä", "Å", "Æ", "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", 
    "Ð", "Ñ", "Ò", "Ó", "Ô", "Õ", "Ö", "Ø", "Ù", "Ú", "Û", "Ü", "Ý", "А", "Б", "В", "Г", "Д", "Е", "Ё", "Ж", 
    "З", "И", "Й", "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц", "Ч", "Ш", "Щ", "Ъ", "Ъ", 
    "Ь", "Э", "Ю", "Я" 
  ); 

  return str_replace($convert_from, $convert_to, $string); 
} 

// Credit to leha_grobov php.net/strtolower, I twicked it ;-)
function ucfirst_utf8_1($string)
{ 
  $convert_from = array( 
    "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", 
    "v", "w", "x", "y", "z", "à", "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í", "î", "ï", 
    "ð", "ñ", "ò", "ó", "ô", "õ", "ö", "ø", "ù", "ú", "û", "ü", "ý", "а", "б", "в", "г", "д", "е", "ё", "ж", 
    "з", "и", "й", "к", "л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "ч", "ш", "щ", "ъ", "ы", 
    "ь", "э", "ю", "я" 
  ); 
  $convert_to = array( 
    "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", 
    "V", "W", "X", "Y", "Z", "À", "Á", "Â", "Ã", "Ä", "Å", "Æ", "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", 
    "Ð", "Ñ", "Ò", "Ó", "Ô", "Õ", "Ö", "Ø", "Ù", "Ú", "Û", "Ü", "Ý", "А", "Б", "В", "Г", "Д", "Е", "Ё", "Ж", 
    "З", "И", "Й", "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц", "Ч", "Ш", "Щ", "Ъ", "Ъ", 
    "Ь", "Э", "Ю", "Я" 
  );

  return str_replace($convert_from, $convert_to, mb_substr($string, 0, 1)).mb_substr($string, 1); 
} 

// Credit to Quicker at http://php.net/manual/en/function.ucfirst.php
function ucfirst_utf8_2($stri)
{ 
    if($stri{0}>="\xc3")
    {
        return (($stri{1}>="\xa0")
            ? ($stri{0}.chr(ord($stri{1})-32))
            : ($stri{0}.$stri{1})).substr($stri,2);
    }
    return ucfirst($stri);
}

?>
<!DOCTYPE html>
<html>
<head>
<title>Test ucfirst()</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style>
table {
    border-collapse: collapse;
}
td, th {
    border: 1px solid black;
    padding: 5px;
}
</style>
</head>
<body>
<table>
        <tr>
            <th>$t</th>
            <th>ucfirsdt($t)</th>
            <th>ucfirst(strtolower($t)</th>
            <th>mb_ucfirst($t)</th>
            <th>strtoupper_utf8($t)</th>
            <th>ucfirst_utf8_1($t);</th>
            <th>ucfirst_utf8_2($t);</th>
        <tr>
    <?php foreach ($testTexts as $t): ?>
        <tr>
            <td><?php echo escape_html($t); ?></td>
            <td><?php echo escape_html(ucfirst($t)); ?></td>
            <td><?php echo escape_html(ucfirst(strtolower($t))); ?></td>
            <td><?php echo escape_html(mb_ucfirst($t)); ?></td>
            <td><?php echo escape_html(strtoupper_utf8($t)); ?></td>
            <td><?php echo escape_html(ucfirst_utf8_1($t)); ?></td>
            <td><?php echo escape_html(ucfirst_utf8_2($t)); ?></td>
        </tr>
    <?php endforeach; ?>    
</table>
</body>
</html> 
```

# mysql - Node.js as webserver with MySQL

> ID：13940544
> 
> 赞同：-1
> 
> 时间：2012-12-18T19:59:00.450
> 
> 标签：mysql, linux, node.js

I am looking to create a webserver, with the lightest possible setup. Is it possible to run a webserver with node.js, MySQL on a 512MB RAM server.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:05:58.097

你可以打

> $ npm 安装 mysql

然后包括

```
var _mysql = require('mysql');

var HOST = 'localhost';
var PORT = 3306;
var MYSQL_USER = 'nodehacker';
var MYSQL_PASS = 'lulwut';
var DATABASE = 'nodedb';
var TABLE = 'gadgets';

var mysql = _mysql.createClient({
    host: HOST,
    port: PORT,
    user: MYSQL_USER,
    password: MYSQL_PASS,
});

mysql.query('use ' + DATABASE); 
```

# sharepoint - 是否可以使用插件将 CRM 与 SharePoint 集成？

> ID：13940545
> 
> 赞同：1
> 
> 时间：2012-12-18T19:59:00.057
> 
> 标签：sharepoint, sharepoint-2010, dynamics-crm-2011, crm

我的任务是创建一个连接到 SharePoint 在线网站的 CRM 2011 在线插件。该插件用于在 CRM 中发生特定操作后创建新的文档集。

我知道所有插件都必须在 CRM 2011 online 中进行沙盒处理。考虑到沙盒的限制，我不确定这个项目是否可行。我也不能 100% 确定是否可以使用 SharePoint Web 服务创建文档集。

有没有人做过类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T05:15:30.813

当然，您可以使用 Sharepoint API 或 Web 服务在 Sharepoint 中创建文档，并且可以在 MS CRM 插件中使用相同的内容。

参考：[http ://crmconsultancy.wordpress.com/2011/10/27/crm-2011-integration-with-sharepoint-custom-document-management/](http://crmconsultancy.wordpress.com/2011/10/27/crm-2011-integration-with-sharepoint-custom-document-management/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:25:25.357

如果我正确理解你的情况，那么是的。这是可能的。创建插件时，您使用 C# 编写代码，并且可以调用 Web 服务。事实上，明天，我将编写一个对外部 Web 服务的调用来更新某些实体的状态，所以我最好在这个上做对。

您以前创建过插件吗？

# java - GPS和网络位置android

> ID：13940548
> 
> 赞同：1
> 
> 时间：2012-12-18T19:59:11.723
> 
> 标签：java, android, networking, gps, location

我正在创建一个应用程序，在我想出这个之前，我已经完成了所有事情。我已经阅读了很多关于 GPS 和网络位置的信息，但我仍然有点困惑。我的应用程序将每隔 X 分钟在后台启动一次（从 0 到 120 分钟，具体取决于用户），并将获取当前位置（我仍然不知道是 GPS 还是网络）。我的目标是获得相对较好的电池，但我需要至少 100 米（350 英尺）的精度，任何 5-100 米的精度都是完美的。此外，如果无法提高精度，则放弃测量并再等待 X 分钟。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:27:13.093

查找 GPS 定位的 DOP（精度稀释）值：它会根据用于计算位置的 GPS 卫星的数量告诉您位置的精确度。顺便说一句，用于计算位置的卫星数量很重要。

因此，一旦您的应用程序启动，轮询 GPS 以获取位置，直到 DOP 值低于给定阈值（3.0 的 DOP 非常精确，大约 20 米）。如果您在指定的时间内没有得到这样的值，则使用您收到的最佳位置。

几乎所有 GPS 芯片现在都使用 A-GPS，尤其是在 android 上，因此您可以很快得到修复（不到 30 秒）。如果您的 A-GPS 信息已过期（通过 Internet 连接下载 A-GPS 文件），您的第一次修复将需要更长的时间：当 GPS 不知道它在哪里时，最多可能需要 6 分钟才能获得可用的修复位于。

所以要尽量减少电池使用量：等待第一次修复。如果 6 分钟内没有修复，请关闭应用程序，因为您将没有任何位置。完成第一次修复后，轮询 GPS 2 或 3 分钟。如果 DOP 低于阈值（3.0 是一个不错的猜测，但请自己尝试），停止轮询。如果 DOP 不低于阈值，则使用具有最低 DOP 的位置。

请注意，您等待的时间越长，定位的精度就越高，并且 DOP 取决于所有可见卫星的位置，有时可见卫星不够多，或者它们没有以最佳方式放置以获得精确位置。

如果 DOP 不可用（我不知道 Android Location API 的细节），用于计算位置的卫星数量可能是不精确但仍然有用的信息（小于 3，放弃位置，3 很糟糕, 超过 4 是平均的，10 是相当好的）。

[在此处](http://en.wikipedia.org/wiki/Dilution_of_precision_%28GPS%29)阅读有关 DOP的更多信息。在此处阅读有关 A-GPS 的更多信息，并在[此处](http://en.wikipedia.org/wiki/Assisted_GPS)阅读有关 GPS 的一般[信息](http://en.wikipedia.org/wiki/Global_Positioning_System)。

of course android is able to locate your device without any GPS signal by using informations from the GSM network or surrounding Wifi networks, but then i can't tell you how to know how precise your position is.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T02:03:04.923

The simplest thing would be to use the `Location.getAccuracy()` method. On interpreting the result see: [How is location accuracy measured in Android?](https://stackoverflow.com/questions/3052517/how-is-location-accuracy-measured-in-android)

# .net - 延迟数据库查找？

> ID：13940552
> 
> 赞同：0
> 
> 时间：2012-12-18T19:59:38.443
> 
> 标签：.net, vb.net, infragistics

我有一个用 VB.NET 编写的应用程序，它生成一个 Infragistics `UltraGrid`，其中包含我从 SQL 数据库获得的公司信息。当用户单击一行时，将`AfterRowActivate`触发该事件，并在屏幕的下半部分为用户显示更多信息。它已经完成并且运行良好。这是被调用的方法：

```
Private Sub grdCompany_AfterRowActivate(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles grdCompany.AfterRowActivate

    If (Not grdCompany.ActiveRow.IsGroupByRow) Then
        If (grdCompany.ActiveRow.Cells("Company_id").Text <> "") Then

            FillCompanyAddressGrid()
            FillCompanyDetail()
            FillChildCompanyGrid()
            FillPropertiesGrid()

        End If
    End If
End Sub 
```

用户倾向于使用箭头键快速滚动网格。因此，该`AfterRowActivate`事件每次都会被触发，并且会对数据库进行不必要的查询。我想实现一个延迟，以便在程序开始在数据库中查找更多信息之前，该行必须突出显示大约半秒。但我很难做到这一点。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:11:57.920

在表单上创建计时器 在网格 AfterRowActive 函数中，重置计时器：

```
Private Sub grdCompany_AfterRowActivate(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles grdCompany.AfterRowActivate

    If (Not grdCompany.ActiveRow.IsGroupByRow) Then
        If (grdCompany.ActiveRow.Cells("Company_id").Text <> "") Then
            Timer1.Enabled = False
            Timer1.Enabled = True
        End If
    End If
End Sub 
```

在您的 Timer 事件中运行代码：

```
Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick  
    FillCompanyAddressGrid()  
    FillCompanyDetail()  
    FillChildCompanyGrid()  
    FillPropertiesGrid()  
    Timer1.Enabled = False  
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:04:57.790

取一个在 500 毫秒后触发的计时器（我个人认为这会变得相当长，我建议尝试在 100 到 200 毫秒范围内的时间），每次用户选择一行时，您只需重置计时器。

500 毫秒后，计时器引发一个事件，然后您获取数据。如果用户不断选择不同的行，您会不断重置计时器，并且在选择一行至少 500 毫秒之前它不会引发任何事件。

# c# - 如何在 C Sharp 中使用 DLL

> ID：13940557
> 
> 赞同：-4
> 
> 时间：2012-12-18T19:59:46.970
> 
> 标签：c#, c, dll

我想在 C# 应用程序中提取 ACPI 表。有英特尔的开源代码可以使用 C 编写的 ACPI 和 BIOS。这是[链接](https://www.acpica.org/)。我想我可以从 C 代码构建 DLL，然后在 C 语言中使用它。但是我很困惑，因为我不知道该怎么做。

我的案例是否有好的文章或指南或起点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:05:45.927

您可以从[平台调用教程](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)开始。

# haskell - 在 ErrorT 之上为变压器定义 MonadPlus 实例

> ID：13940558
> 
> 赞同：3
> 
> 时间：2012-12-18T19:59:46.733
> 
> 标签：haskell, monads, monad-transformers, monadplus

我想定义一个 monad 转换器，除其他外，它赋予基本 monad 错误功能。如果基本 monad 是，则转换后的 monad 应该是 MonadPlus 的一个实例，但我不知道如何定义 MonadPlus 实例，以便 ErrorT 转换器返回多个答案（如果有多个答案）。我的两次尝试都在下面的代码中。在代码的末尾，有一个语句显示如果基本 monad 是 monad 转换器应该如何表现`[]`。谢谢。

```
import Control.Monad.Error
import Control.Monad.Trans.Class

data MyTrans m a = MyTrans {runMyTrans :: ErrorT String m a}

instance Monad m => Monad (MyTrans m) where
    return  = MyTrans . lift . return
    m >>= f = MyTrans $ do x <- runMyTrans m
                           runMyTrans (f x)

instance MonadTrans MyTrans where
    lift m = MyTrans $ lift m

instance MonadPlus m => MonadPlus (MyTrans m) where
    mzero = MyTrans $ lift mzero
    -- Attempt #1 (Only reveals the first element)
    m `mplus` n = MyTrans $ (runMyTrans m) `mplus` (runMyTrans n)
    -- Attempt #2 (Incomplete: see undefined statements)
--     m `mplus` n = MyTrans $
--                   lift $ do a <- runErrorT $ runMyTrans m
--                             b <- runErrorT $ runMyTrans n
--                             case a of
--                               Right r 1
--                               Left _ -> undefined
--                                   -> case b of
--                                        Left _ -> undefined
--                                        Right t -> return r `mplus` return t

type MyMonad = MyTrans []

x = return 1 :: MyMonad Int
y = MyTrans $ throwError "Error" :: MyMonad Int

z = x `mplus` y

main = do
  print $ (runErrorT $ runMyTrans z) -- should be [Right 1, Left "Error"] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T22:07:09.477

```
instance MonadPlus m => MonadPlus (MyTrans m a) where
    mzero = MyTrans (ErrorT mzero)
    MyTrans (ErrorT m) `mplus` MyTrans (ErrorT n) = MyTrans (ErrorT (m `mplus` n)) 
```

**注意**：我只验证了这具有您要求的行为，并没有检查它是否符合`MonadPlus`法律。很有可能它违反了其中的部分或全部！使用风险自负。

# c# - 可以手动打开和查看文件，但以编程方式得到 UnauthorizedAccessException

> ID：13940559
> 
> 赞同：0
> 
> 时间：2012-12-18T19:59:48.750
> 
> 标签：c#, file-permissions, unauthorizedaccessexcepti

我正在使用 StreamReader 类来读取文件，但这样做会获得未经授权的访问异常。我可以手动打开文件并阅读它。程序运行的权限是否低于我的用户帐户的权限？我正在使用 VS 2010 创建一个 C# 控制台应用程序。我的用户帐户没有管理员权限，但足以让我读取和写入包含此文件的文件夹。此外，我尝试读取的文件是由另一个用户生成的，但我的帐户具有读取和执行和读取权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:08:18.470

发布此消息后不久，我意识到我正在以读/写访问权限而不是只读访问权限打开文件。我修改了我的代码来执行 File.OpenRead 而不是 File.Open 现在它可以工作了

# javascript - 替换与正则表达式匹配的单元格的内部 html

> ID：13940562
> 
> 赞同：1
> 
> 时间：2012-12-18T19:59:52.647
> 
> 标签：javascript, jquery

嗨，我有一个带有列的表格，其中所有单元格都有一个“.imgURL”类

我需要根据正则表达式检查具有该类的单元格的内容并替换单元格中的内容。

我有这段代码来遍历所有单元格并检查 reguar exreassion。

```
var items = [];

    $('.imgURL').each(function (i, e) {

    items.push($(e).text());
    });

    for(x=0; x<items.length; x++){
        var $img = items[x];
        var isMatch = /^graphics$/.test($img);

        if(/^graphics/.test($img)){
            console.log($img);
        } 
```

我卡住的地方是，如何替换当前单元格的内容，而不是所有单元格都具有“.imgURL”类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:03:48.920

您可以将回调传递给`.text()`或`.html()`返回要放入单元格中的值：

```
$('.imgURL').text(function (idx, str) {
    if (/^graphics/.test(str)) {
        return ''; // empty the cell
    } else {
        return str;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:03:56.623

尝试这个

```
$('.imgURL').each(function() {
   // this refers to the current .imgURL element
   $(this).text($(this).text().replace(/^graphics$/, "whateverYouWantToReplaceItWith"));
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-18T20:06:12.207

您想使用 JavaScript[`replace`](http://www.w3schools.com/jsref/jsref_replace.asp)方法：

```
$img.replace(/^graphics$/, 'replacement string'); 
```

# .htaccess - htaccess重写规则不起作用

> ID：13940567
> 
> 赞同：3
> 
> 时间：2012-12-18T20:00:08.127
> 
> 标签：.htaccess

我创建了一个站点的子域。子域指向根目录上的文件夹。

由于某些原因，以下重写规则不起作用。两个细分网址正在工作。一个不工作，两个以上不工作。请参阅下面的网址。

*   `subdomain.domain.com/register`（不工作）
*   `subdomain.domain.com/temp/register`（在职的）

当我动态创建两个段时，它们不起作用。

*   `subdomain.domain.com/dynamic1/dynamic2`（不工作）

.

```
Options +FollowSymlinks
RewriteEngine   On
RewriteBase     /
RewriteCond     %{HTTPS} on
RewriteRule     (.*) http://%{HTTP_HOST}%{REQUEST_URI}

#FOR REPLACING .HTML EXTENSION (WORKS FINE)
RewriteCond     %{REQUEST_FILENAME}     !-f
RewriteCond     %{REQUEST_FILENAME}     !-d
RewriteCond     %{REQUEST_FILENAME}\.html -f
RewriteRule     ^(.*)$ $1.html

#FOR REPLACING .PHP EXTENSION (NOT WORKING)
RewriteRule     ^([a-zA-Z0-9_-]+)$ $1.php
RewriteRule     ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)$ $1.php 
```

如果你不明白这个问题，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:25:07.660

就像 Michael Berkowsk 建议的那样，您可能希望在`L`规则的末尾添加标志，以便在应用规则时结束重写。除此之外，您拥有的 2 段规则仅使用第一个作为反向引用，我假设您想同时使用两者？尝试将规则更改为如下所示：

```
Options +FollowSymlinks
RewriteEngine   On
RewriteBase     /

# the HTTP redirect
RewriteCond     %{HTTPS} on
RewriteRule     (.*) http://%{HTTP_HOST}%{REQUEST_URI} [L,R]

#FOR REPLACING .HTML EXTENSION (WORKS FINE)
RewriteCond     %{REQUEST_FILENAME}     !-f
RewriteCond     %{REQUEST_FILENAME}     !-d
RewriteCond     %{REQUEST_FILENAME}\.html -f
RewriteRule     ^(.*)$ $1.html [L]

#FOR REPLACING .PHP EXTENSION 
RewriteCond     %{REQUEST_FILENAME}     !-f
RewriteCond     %{REQUEST_FILENAME}     !-d
RewriteCond     %{REQUEST_FILENAME}\.php -f
RewriteRule     ^(.*)$ $1.php [L]

RewriteCond     %{REQUEST_FILENAME}     !-f
RewriteCond     %{REQUEST_FILENAME}     !-d
RewriteRule ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)$ location.php?li_id=$1&lid=$2 [L] 
```

# svn - 告诉 SVN 只将特定文件类型导入存储库？

> ID：13940570
> 
> 赞同：0
> 
> 时间：2012-12-18T20:00:21.557
> 
> 标签：svn, tortoisesvn

与其将全局忽略模式设置为忽略特定文件类型，我认为只告诉它只包含特定文件类型会更容易。这可能吗？

例如，我只想要版本控制下的 .java 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:00:55.273

然而，这似乎并不直接可能：

1.  在提交 'svn add *.java' 之前并简单地忽略 'svn st' 等中的任何其他文件。人。（最简单，但有点丑）；
2.  编写一个 pre-commit 钩子，如果任何文件不以 .java 结尾，则提交失败（有点丑陋，如果你改变主意，你必须改变钩子）；
3.  设置ignore=*，然后记住在添加任何新文件时*必须*'svn add *.java'（如果你忘记了，很丑而且容易丢失数据）。

如果您决定采用全局路线，请考虑在您的项目目录或目录上设置 svn:ignore 属性。这样，其他类型项目中的非 *.java 文件将继续正常运行。

# youtube-api - YouTube 分析 - 视频指标

> ID：13940574
> 
> 赞同：1
> 
> 时间：2012-12-18T20:00:40.477
> 
> 标签：youtube-api

有一个关于查询按视频过滤的频道报告的问题。如果我在没有视频过滤器的情况下进行查询，我是否可以假设频道所有上传视频的指标总和等于指标？

换句话说，如果我对 2012 年 1 月 1 日到 2012 年 2 月 1 日之间的频道的“观看次数”进行报告查询，我会得到该频道的总观看次数，比如 X。现在，如果我在同一日期之间进行查询范围，并按一个视频过滤，我只获得该视频的观看次数。如果我为该频道的“上传”播放列表中的每个视频都执行此操作并将观看次数相加，这是否等于 X？

我认为它应该但想要确认。

谢谢！

# java - Reader 中的多个标记

> ID：13940581
> 
> 赞同：6
> 
> 时间：2012-12-18T20:01:20.243
> 
> 标签：java, groovy, bufferedreader

我找不到用 Java（或 Groovy）编写以下代码的功能

```
reader.mark();   //(1)
reader.read();   //reads 'a'
reader.mark();   //(2)
reader.read();   //reads 'b'
reader.reset();  //back to (2)
reader.read();   //reads 'b'
reader.reset();  //back to (1)
reader.read();   //reads 'a'
reader.read();   //reads 'b' 
```

`Reader.mark(int)`是一个不错的方法，但它不会堆叠标记，它只包含最近的标记..

Java库的任何支持还是我一个人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T16:41:37.450

所以我自己写的-.-

```
class CharReader {
    private Stack marks;
    private RandomAccessFile reader;

    CharReader(File file) {
        this.marks = new Stack();
        this.reader = new RandomAccessFile(file, 'r');
    }

    void mark() {
        long mark = reader.getFilePointer();
        marks.push(mark);
    }

    void reset() {
        if (marks.size() <= 0)
            return

        long mark = marks.pop();
        reader.seek(mark);
    }

    char peek() {
        mark();
        char nextChar = next();
        reset();
        return nextChar;
    }

    char next() {
        int nextChar;
        if ((nextChar = nextInt()) >= 0) {
            return (char) nextChar;
        }
        throw new IllegalStateException("Reader empty");
    }

    private int nextInt() {
        return reader.read();
    }
} 
```

足以满足我的需要。仅支持单字节`char`s ;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T15:26:41.237

您可以尝试在 a 周围实现一些东西[`PushBackReader`](http://docs.oracle.com/javase/7/docs/api/java/io/PushbackReader.html)，它有一种`unread`方法可以让您将不需要的字符推入回推缓冲区。

```
char a, b;         // reader holds "ab"
a = reader.read(); // reader holds "b"
b = reader.read(); // reader holds ""
reader.unread(b);  // reader holds "b"
b = reader.read(); // reader holds ""
reader.unread(b);  // reader holds "b"
reader.unread(a);  // reader holds "ab"
a = reader.read(); // reader holds "b"
b = reader.read(); // reader holds "" 
```

对于可能解析应用程序，这种工具足以满足您的需求。

另一种选择是对于需要标记的每个嵌套层，以`Reader`在它们传递的层之上构造一个新的层，并改为标记那个层。

# ios - rangeOfMisspelledWordInString 查找随机字母作为有效单词

> ID：13940582
> 
> 赞同：0
> 
> 时间：2012-12-18T20:01:21.057
> 
> 标签：ios

任何人都可以复制这个结果吗？我正在测试`rangeOfMisspelledWordInString`(in `iOS`) 以查找拼写错误的单词，并且一些随机字母返回一个有效单词，如下所示。

```
UITextChecker* pSpellChecker = [[[UITextChecker alloc] init] autorelease];
NSRange rangeWord = NSMakeRange(0, 8);
NSRange rangeCheck = [_pSpellChecker rangeOfMisspelledWordInString:@"lhpcjeuw"
                                                             range:rangeWord
                                                        startingAt:0
                                                              wrap:NO
                                                          language:@"en_US"];
if (rangeCheck.location == NSNotFound) {
   NSLog(@"Valid Word:");
} 
```

以下是一些根据 rangeOfMisspelledWordInString 也有效的单词：顺便说一句，我确保在测试之前将以下单词转换为小写。

```
LD
THY
THE
THECA
TD
HL
HT
YD
YLEQXXH
DV
DVX
DVXX
DVXXD
DVXXDX
DVXXX
DVHXG
DVHEJWCP
DH
DH
DPJLEHHY 
```

很奇怪。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:33:56.300

我认为“the”和“thy”可能是有效的词；）

除此之外，我最好的猜测是文本系统无法为单词提供猜测，因此完全忽略了它——“拼写错误的单词”的语义含义可能不包括“无法想象拼写错误的字母串”一个字。” 我注意到当我将这些字符串输入系统文本字段（例如在消息中）时，我没有得到任何替换建议。

您还可以确保您的 UITextChecker 实例未设置为忽略这些特定单词；看看[`ignoredWords`物业](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextChecker_Class/Reference/Reference.html#//apple_ref/occ/instm/UITextChecker/ignoredWords)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:43:10.533

是的，我可以重现它，我称之为错误。如果我输入您的测试词@“lhpcjeuw”，它会将其视为有效词。但是，如果我使用 @"lahpcjeuw"（在第二个位置添加了一个“a”），它会捕获它。我注意到蒂姆做了同样的事情——在写这个答案时，拼写检查器在我输入的时候强调了第二个而不是第一个。

# vim - 如何以不区分大小写的方式从vim打开文件

> ID：13940585
> 
> 赞同：8
> 
> 时间：2012-12-18T20:01:52.397
> 
> 标签：vim

假设您`ExAMplE.java`在当前目录中有一个文件，并且您正在使用 vim 编辑同一目录中的其他文件。我会使用 vim 打开一个文件，`:e fileName`但由于这个文件的名称都很糟糕，有没有办法让 vim 编辑命令建议你输入文件`ExAMple.java`名`exam<tab>`。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-18T20:06:00.647

```
set wildignorecase 
```

见`:h 'wildignorecase'`。

# javascript - Angular 和 MongoDB，安全性？

> ID：13940587
> 
> 赞同：2
> 
> 时间：2012-12-18T20:02:05.220
> 
> 标签：javascript, mongodb, authentication, angularjs, mlab

因此，我正在使用 AngularJS 在我的公司编写一个供内部使用的快速小应用程序，我的项目基本上是基于 AngularJS 网站上的“项目”：http: [//angularjs.org/#project-js](http://angularjs.org/#project-js)

我已经设置了视图/模型/控制器，并且能够从数据库中写入和读取。问题是，即使要写入数据库的表单落后于身份验证，这个项目也将被其他开发人员使用。如果我认识他们，每个人都会做的第一件事就是跳转到一个 javascript 控制台并尝试写入数据库。

我在这里错过了某种身份验证吗？当使用连接到 mongodb 的 api 方法（如示例 url 中）时，有没有办法阻止任何人写入数据库，或者这只是使用客户端连接到数据库的危险？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:54:03.717

您的客户端（浏览器）不应将数据直接发布到数据存储区。它应该通过中间件，例如 rails api 或将运行服务器端验证然后保存到数据存储区的东西。如果您的 javascript 直接将内容发布到数据库，那么不仅会暴露凭据，而且黑客也可以绕过验证并保留不应保存的值。

PS：您的 Rails 应用程序应该添加它自己的身份验证层。这样，正在执行 CRUD 的表单是安全的。

# delphi - 如何在所有其他应用程序之上监控键盘，然后将其他键发送给它们

> ID：13940590
> 
> 赞同：2
> 
> 时间：2012-12-18T20:02:12.577
> 
> 标签：delphi, keyboard-events, delphi-2006

我正在基于运行 Win7 的旧计算机构建多媒体控制台。

我想用数字键盘控制玩家。我不能使用常见的媒体控制设备，因为它们只响应 windows 媒体播放器。我将使用 KVM Player、Winamp 等。所以每个人都有自己的一套键盘快捷键，用于播放、暂停、转发、音量等。

为此，我正在考虑构建一个 Delphi 应用程序来检测前台应用程序并从数据库中获取该应用程序使用的快捷方式。

当我使用数字键盘（普通遥控器的大小）并按下播放时，如果我使用 Winamp 或Media Player Classic `5`，我的应用程序可以检测到它并将密钥发送到操作系统。`P``Space`

**我应该使用哪些功能来首先抓住按下的键，然后发送不同的键？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:18:29.960

部分解决方案可以使用键盘挂钩 ( [WH_KEYBOARD_LL](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms644985%28v=vs.85%29.aspx) ) 来捕获特殊组合键或单个键，然后使用[keybd_event](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646304%28v=vs.85%29.aspx)函数发送（替换）另一个击键。

试试这个拦截 `VK_UP`密钥并发送一个示例代码`S`

```
var
 hhk: HHOOK;

function CBT_FUNC(nCode: Integer; wParam: WPARAM; lParam: LPARAM): LRESULT; stdcall;

type
  PKBDLLHOOKSTRUCT = ^TKBDLLHOOKSTRUCT;
  TKBDLLHOOKSTRUCT = record
    vkCode: cardinal;
    scanCode: cardinal;
    flags: cardinal;
    time: cardinal;
    dwExtraInfo: Cardinal;
  end;
  PKeyboardLowLevelHookStruct = ^TKeyboardLowLevelHookStruct;
  TKeyboardLowLevelHookStruct = TKBDLLHOOKSTRUCT;

var
 LKBDLLHOOKSTRUCT: PKeyboardLowLevelHookStruct;
begin
   case nCode of
     HC_ACTION:
     begin
       LKBDLLHOOKSTRUCT := PKeyboardLowLevelHookStruct(lParam);
        if (LKBDLLHOOKSTRUCT^.vkCode = VK_UP)  then
        begin

          if (wParam=WM_KEYUP) or (wParam=WM_SYSKEYUP)then
           keybd_event( Ord('S'), 0, KEYEVENTF_KEYUP, 0)
          else
           keybd_event( Ord('S'), 0, 0, 0);

          Exit(1); //eat the key
        end;
     end;
   end;
  Result := CallNextHookEx(hhk, nCode, wParam, lParam);
end;

Procedure InitHook();
begin
  hhk := SetWindowsHookEx(WH_KEYBOARD_LL, @CBT_FUNC, 0, 0);
  if hhk=0 then RaiseLastOSError;
end;

Procedure KillHook();
begin
  if (hhk <> 0) then
    UnhookWindowsHookEx(hhk);
end;

initialization
  InitHook();

finalization
  KillHook();
end. 
```

在使用这种钩子之前记得阅读文档，特别是[备注](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms644985%28v=vs.85%29.aspx)部分。

# jquery - 如何在 JQuery 中绑定、取消绑定和重新绑定（单击）事件

> ID：13940591
> 
> 赞同：13
> 
> 时间：2012-12-18T20:02:15.053
> 
> 标签：jquery, bind, unbind

两周前[在这里](https://stackoverflow.com/questions/13729681/jquery-rebind-disable-events-for-a-specific-time-then-rebind-them)问了同样的问题后，我终于找到了“解决方案”。这就是为什么我要回答我自己的问题。;)

**如何在 JQUERY 中绑定、取消绑定和重新绑定事件？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-18T20:02:15.053

这是完美的解决方案。（至少对我来说。）

```
$(document).on('click', 'a#button', function(){
    $(this).after('<span> hello</span>');
    $('span').fadeOut(1000);
});

$('a#toggle').toggle(
    function(){
        $(this).text('rebind');
        $('a#button').on('click.disabled', false);
    },
    function(){
        $(this).text('unbind');
        $('a#button').off('click.disabled');
    }
); 
```

“.on()”做到了。注意：像在第一行看到的那样绑定事件很重要！它不适用于 .click() 或 ...！

请参阅[文档](http://api.jquery.com/on/)！

这是一个尝试并尝试它[的小提琴！](http://jsfiddle.net/RAcGD/)

享受！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-07T21:54:44.150

一个更简单且简短的解决方案是，如果要取消绑定，则向对象添加一个类，然后删除该类以重新绑定 ex；

```
$('#button').click( function(){
   if($(this).hasClass('unbinded')) return;
   //Do somthing
 });

$('#toggle').click(function(){
    $('#button').toggleClass('unbinded');
 }); 
```

# c++ - borland developer studio 的开源替代方案

> ID：13940595
> 
> 赞同：7
> 
> 时间：2012-12-18T20:02:49.230
> 
> 标签：c++, c++builder

Borland developer studio 2006 是否有任何开源替代方案？

我需要这个是因为，我有一个带有开发人员工作室项目（bdsproj）文件（旧的）的 c++ 项目，我需要做一个逆向工程'种类'的东西。

或任何其他方式来实现这一点。喜欢（将 bdsproj 转换为 c++ Proj（Visual Studio 项目））

非常感谢您的想法/评论。

-拉贾

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:39:54.703

C++ builder 使用 Borland 组件。它被称为 VCL - 可视化组件库。[http://en.wikipedia.org/wiki/Visual_Component_Library](http://en.wikipedia.org/wiki/Visual_Component_Library)

一个开源替代品是 LCL - Lazarus 组件库。

我认为这是你能得到的最好的：[http ://en.wikipedia.org/wiki/Lazarus_%28software%29#Lazarus_Component_Library](http://en.wikipedia.org/wiki/Lazarus_%28software%29#Lazarus_Component_Library)

希望它不仅限于 Free Pascal。我认为从 C++ 调用这些组件有一个特殊的技巧。它的工作原理与 C++ builder 调用的 Delphi 组件相同。

将来，它应该可以在没有任何技巧的情况下工作。[http://www.freepascal.org/future.html](http://www.freepascal.org/future.html)

这里有更多信息：[http ://www.lazarus.freepascal.org/index.php?topic=80.0](http://www.lazarus.freepascal.org/index.php?topic=80.0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:45:29.697

不适用于 Studio 的 C++ 部分，不。对于 Delphi 部分，有[FreePascal](http://freepascal.org)编译器和[Lazarus](http://lazarus.freepascal.org) IDE。

# c++-cli - 我如何在程序运行的do while循环中放置条件

> ID：13940599
> 
> 赞同：1
> 
> 时间：2012-12-18T20:03:00.073
> 
> 标签：c++-cli

我遇到了这个问题，我试图解决它，但我不能请我需要你的帮助..这是我的代码：

```
#pragma endregion
private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
    y=Convert::ToInt16(textBox1->Text);
    c=Convert::ToInt16(textBox3->Text);
    a=Convert::ToDouble(rand() % y);
    b=Convert::ToDouble(rand() % c);
    textBox2->Text = Convert::ToString(a);
    textBox4->Text = Convert::ToString(b);

    x1=0;
    x2=0;

    do
    {
        trafficlight(a,b,1,2);
    }while(i==0);//here is my problem i need condition to make the while loop working while the program is running 
```

如果我确实单击了按钮，它只会在没有前面的代码的情况下跳转到 while 循环，我需要前面的代码才能工作，并且条件使 while 循环在程序运行时工作..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:55:05.497

我不是 100% 确定你在问什么，但我认为问题在于你停留在 UI 线程的 while 循环中。

相反，让按钮处理程序启动[Thread](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)或[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)或类似的东西，并在那里完成工作。

如果该`trafficlight`方法执行 UI 访问，请确保[Invoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx)回到 UI 线程。

# cuda - cudaMalloc 总是内存不足

> ID：13940600
> 
> 赞同：5
> 
> 时间：2012-12-18T20:03:01.683
> 
> 标签：cuda, out-of-memory

我面临一个简单的问题，我对 cudaMalloc 的所有调用都失败了，给了我一个内存不足的错误，即使它只是我分配的一个字节。

cuda 设备可用，并且还有大量可用内存（通过相应调用检查机器人）。

知道问题可能是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T08:49:33.603

请尝试在代码本身的开头调用 cudaSetDevice()、cudaDeviceSynchronize() 和 cudaThreadSynchronize()。

cudaSetDevice(0) 如果只有一个设备。默认情况下，CUDA 运行时将初始化设备 0。

```
cudaSetDevice(0);
cudaDeviceSynchronize();
cudaThreadSynchronize(); 
```

请回复您的观察。如果仍然失败，请指定操作系统、架构、CUDA SDK 版本、CUDA 驱动程序版本。如果可能，请提供失败的代码/代码片段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T11:44:07.927

谢谢大家的帮助。

问题不在于 cudaMalloc 本身，但它掩盖了真正的问题，这是由于 cuda 的初始化似乎失败了。

因为第一次调用 cuda 是在一个单独的线程中，所以我没有可用的 GLContext，导致失败。在初始化上下文之后，我需要确保在主线程中通过虚拟 malloc 初始化了 cuda。

# php - 如何为本地主机上的应用程序使用两个或多个不同的 Web 服务器

> ID：13940603
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:03:10.843
> 
> 标签：php, webserver

我正在使用 XAMPP 在 PHP 中开发我的应用程序。

很多时候，我发现一个 Web 应用程序/站点正在使用 2/3 不同的 Web 服务器，例如`apache/nginx/varnish`在实时站点上使用（基于附加组件的信息，例如 wapplyzer），我只是想知道我是否可以同时使用这些我的本地服务器也是如此。

Memcache 也是我现在正在尝试研究的，它是否也可以在本地实现以检查功能？

如果可能的话，让我知道如何配置它或在哪里应用更改。

系统建立部分不好，所以如果有什么不正常的地方请原谅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:38:28.927

Varnish 不是一个 Web 服务器，它是一个 Web 应用程序加速器。维基百科解释了所有...

> Varnish 是专为内容繁重的动态网站设计的 HTTP 加速器。与其他 HTTP 加速器相比，例如 Squid，它最初是作为客户端缓存，或 Apache 和 nginx，主要是源服务器，Varnish 被设计为 HTTP 加速器。Varnish 专注于 HTTP，不像其他代理服务器通常支持 FTP、SMTP 和其他网络协议。

至于在端口 80 上运行 Apache 和 nginx，您可能想要这样做是有原因的，但请记住，它们本身就是成熟的 Web 服务器。

即使您选择让 Apache 在系统上运行，使用 nginx 作为主要的前端网络服务器也可以提高性能。nginx 最大的优势之一是它服务静态内容的能力。它的效率比 Apache 高得多，而且内存或处理成本也很低。因此，通常会发现 nginx 处理图像和其他静态组件，而将动态的“繁重工作”留给 Apache。

人们想要在他们的开发服务器上执行此操作的唯一原因是为了尽可能地从他们的生产实例中维护一个无缝的环境。

这是一篇解释设置的文章……如果您使用 Google，还有更多……

[在 Ubuntu Server 上的 Apache2 前面设置 Nginx](http://hybridlogic.co.uk/2011/07/setting-up-nginx-in-front-of-apache2-on-ubuntu-server/)

# c# - long.tryparse 和负值

> ID：13940604
> 
> 赞同：0
> 
> 时间：2012-12-18T20:03:17.873
> 
> 标签：c#

我正在编写一个自定义 JavascriptConverter 并且我正在测试接收到的密钥是否是这样的类型：

```
if (dictionary.ContainsKey("SomeID"))
{
if (long.TryParse(serializer.ConvertToType<string>(dictionary["ContactID"]), out TheTableID))
{...} 
```

我只想要大于或等于 0 的数字。我是否还需要测试它是否为负数，或者 TryParse 是否测试负数？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:05:23.117

您要么必须测试`>= 0`，要么`ulong.TryParse()`改用（这实际上不是一回事，但仍可能满足您的需求）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:05:10.060

`TryParse`显然不检查负数。毕竟`-1234567890`是有效的`long`。

相反，您可以添加`&& TheTableID >= 0`或使用`ulong.TryParse`。

* * *

请注意，最好打电话`dictionary.TryGetValue`而不是单独`ContainsKey()`检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:05:11.980

`TryParse`不测试负数，它只测试数字是否*有效*`long`。解析后，您需要单独检查以确定它的符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T20:06:26.747

是的，如果您只想要正数，您还需要测试是否为负数。TryParse 不测试极性。 [http://msdn.microsoft.com/en-us/library/zc2x2b1h.aspx](http://msdn.microsoft.com/en-us/library/zc2x2b1h.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T20:12:14.630

不确定这是否正确，但这也可以基于**显式转换为您工作**

```
long myLong = -22;
uint myUint = (uint)myLong;  // OK: explicit conversion
//yields 4294967274 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T20:19:44.647

[TryParse](http://msdn.microsoft.com/en-us/library/2zbx0k66.aspx)有一个重载，您可以在其中指定什么是有效数字。

```
if (long.TryParse(str, NumberStyles.None, CultureInfo.InvariantCulture, out value)
   Console.WriteLine("Long with only digits, no sign, blanks or separators"); 
```

[在此处查找](http://msdn.microsoft.com/en-us/library/system.globalization.numberstyles.aspx)可能的 NumberStyles 标志的描述

# wso2 - 运行 WSF-CPP 示例

> ID：13940607
> 
> 赞同：0
> 
> 时间：2012-12-18T20:03:23.893
> 
> 标签：wso2

我正在尝试运行 WSO2 WSF-CPP 附带的 Echo 示例，但出现以下错误：

> [2012 年 12 月 18 日星期二 14:26:51] [错误] dep_engine.c(1008) 找不到 Axis2 配置文件名 [2012 年 12 月 18 日星期二 14:26:51] [错误] dep_engine.c(872) axis2.xml 是在客户端回购中不可用。[2012 年 12 月 18 日星期二 14:26:51] [错误] conf_init.c(201) 为客户端存储库加载部署引擎失败。[2012 年 12 月 18 日星期二 14:26:51] [关键] ServiceClient.cpp(223) 无法创建服务客户端

我按照[1](http://wso2.org/library/tutorials/dummys-guide-writing-web-service-clients-wso2-wsf-c#Running_Your_First_Web_Service_Client_with_WSO2_WSF_CPP)中的安装步骤，我没有任何问题，但我认为有一些遗漏。

提前致谢，

ü。

[1](http://wso2.org/library/tutorials/dummys-guide-writing-web-service-clients-wso2-wsf-c#Running_Your_First_Web_Service_Client_with_WSO2_WSF_CPP) [http://wso2.org/library/tutorials/dummys-guide-writing-web-service-clients-wso2-wsf-c#Running_Your_First_Web_Service_Client_with_WSO2_WSF_CPP]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T14:54:58.663

将环境变量 WSFCPP_HOME 设置为您的 WSO2 CPP 安装路径。似乎您的路径设置不正确，这就是您看到此错误的原因。（我可以在 linux 中运行示例）

# javascript - 如何查询所有可用的开放徽章？

> ID：13940609
> 
> 赞同：1
> 
> 时间：2012-12-18T20:03:26.050
> 
> 标签：javascript, ruby-on-rails, mozilla, openbadge

我正在尝试制作一个 Challenge Board rails 应用程序，它本质上是一个开放徽章的搜索引擎。

我需要汇总所有可获得的公开徽章。

我一直在查看[Github 上的 Open Badge 代码](https://github.com/mozilla/openbadges)，我发现了这个：

```
Badge.finders = {
  email: function (value, callback) {
    var query = "SELECT * FROM `badge` WHERE `user_id` = (SELECT `id` FROM `user` WHERE `email` = ?)";
    mysql.client.query(query, [value], callback);
  }
}; 
```

（位于[https://github.com/mozilla/openbadges/blob/development/models/badge.js](https://github.com/mozilla/openbadges/blob/development/models/badge.js)）

那么，我可以只使用该查询来获得我想要的吗？也许这是做事情的错误方式。有谁知道获得所有可用开放徽章的方法？我查看了[Displayer API](https://github.com/mozilla/openbadges/wiki/Displayer-API)，但它看起来只是用于显示特定用户的公共徽章。

我考虑编写一个机器人，将[电子邮件发送到 Open-Badge 转换器](http://beta.openbadges.org/displayer/convert/email)，然后获取每封有效的电子邮件（附加到真实用户的电子邮件）并存储它的 ID 代码。然后我可以通过这些 ID 循环到 JSON 查询，如下所示：http://beta.openbadges.org/displayer/[id]/groups.json，然后保留所有不同徽章的哈希。但是，我不想制作机器人。此外，该系统不会添加可用的徽章，但还没有人获得徽章。

任何人都知道一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T20:29:14.683

没有用于查询 Mozilla 背包中所有可用徽章的 API，因为背包是放置徽章的地方。它实际上并没有提供它们。Mozilla 正在开发一种徽章目录服务，以汇总来自不同徽章发行者的可用开放徽章，但它仅处于原型阶段。我们希望它在未来 6 个月内可用。

# linux - 传输文件！！！从 Unix 服务器到 linux 服务器

> ID：13940610
> 
> 赞同：-5
> 
> 时间：2012-12-18T20:03:29.307
> 
> 标签：linux, file, unix, copy, scp

我使用 scp -prv 命令将目录/文件（/usr/local/scripts）从 unix 服务器复制到 linux 服务器。复制工作，但是，它在脚本中创建了另一个目录（/usr/local/scripts/scripts）。我如何制作它，我要删除什么，所以它只保留 /usr/local/scripts？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:05:06.437

```
 cd /usr/local/scripts/scripts
 cp -r * ../.
 //Check to make sure it looks good
 rm -r /usr/local/scripts/scripts 
```

这是超级基本的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:06:21.457

`scp -prv /usr/local/scripts host:/usr/local/`为了正确复制，康斯坦丁所说的清理。

# c# - 将 Visual Studio 与 Web 服务器连接

> ID：13940612
> 
> 赞同：0
> 
> 时间：2012-12-18T20:03:39.897
> 
> 标签：c#, sql, visual-studio-2010, windows-phone-7.1, microsoft-sync-framework

我在托管服务上注册了帐户，他们给了我 sql 用户名、密码和主机名……然后我创建了数据库，创建了表并插入了一些数据。现在我想通过使用 Microsoft Sync Framework 将它连接到我的程序（Windows Phone 7.1）。有人可以帮我吗？

当我转到数据库资源管理器并按添加连接时，我看到了这些选项，但不知道该使用哪个：

*   Microsoft Access 数据库文件
*   微软 SQL Server 精简版 3.5
*   Microsoft SQL Server 数据库文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:08:15.687

这应该可以帮助你：

[http://blogs.msdn.com/b/wriju/archive/2011/08/01/windows-phone-7-using-local-database-for-application.aspx](http://blogs.msdn.com/b/wriju/archive/2011/08/01/windows-phone-7-using-local-database-for-application.aspx)

您对移动平台的思考就像是 Windows 7，移动平台以不同的方式处理数据，该博客文章应该可以帮助您理解。

Wp7.0 = 隔离存储 Wp7.1 = 数据库，该数据库通过 Linq 访问。

# ios - touchesEnded 或 touchesCancelled 并不总是被调用

> ID：13940615
> 
> 赞同：4
> 
> 时间：2012-12-18T20:03:53.477
> 
> 标签：ios, touch, uigesturerecognizer

我认为这个问题值得提出自己的问题。使用附加到我的[另一个问题](https://stackoverflow.com/questions/13813969/not-quite-understanding-touchesbegan-and-touchesended)的解决方案的代码，我发现了此处描述的问题。

我将主视图控制器设置为 UIGestureRecognizerDelegate，并且我实现了`touchesBegan`、`touchesMoved`、`touchesEnded`，并对`touchesCancelled`我的解决方案进行了编程，假设对于每个带有事件的触摸对象，同一个对象`touchesBegan`都会有一个`touchesEnded`或`touchesCancelled`事件。不过，我发现情况并非如此。

场景：以下事件按此顺序发生。

*   用户开始手势 1，触摸屏幕并滑动手指。

*   用户开始手势 2，在不同位置触摸屏幕。

*   用户继续在屏幕的相应部分滑动两个手指。

*   用户将手指从屏幕上抬起以执行手势 2。

*   用户继续手势 1。

*   用户将手指从屏幕上抬起以执行手势 1。

使用`NSLog`捕获触摸事件的细节，我发现手势1和手势2使用了一个单独的触摸对象。但是手势1都调用了while `touchesBegan`、、`touchesMoved`和，而手势2只调用了和。事件不是要求它。`touchesEnded``touchesBegan``touchesMoved``touchesCancelled`

`touchesEnded`那么，如果`touchesCancelled`没有调用手势 2，我如何判断手势 2 何时结束？

编辑：我发现[另一篇](https://stackoverflow.com/questions/12122603/why-are-uiviewcontroller-touchesbegan-touchesmoved-touchesended-only-being-ca?rq=1)有类似症状的帖子。不过，我的大多数子视图都是以编程方式创建的。我会尝试那里为其他人建议的。不过，我怀疑这是同一个问题，因为在我的测试中，触摸位置不在其他视图附近。

另一个编辑：按照我之前编辑中发布的链接中的建议，我查看了子视图，其中一个检查了用户交互。取消选中后，行为略有不同。现在，在任何触摸事件中都不会注意到第二次触摸。我一定缺少一些基本的东西。顺便说一下，主视图和检查用户交互的视图都占用相同的空间（一个封装另一个）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:00:15.090

你把这样的东西放在你的 touchesMoved 方法中怎么样

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    NSArray* touchData = @[touches,event];
    [self.timer invalidate];
    self.timer = [NSTimer scheduledTimerWithTimeInterval:0.1 target:self
                  selector:@selector(touchesFinishedWithoutCallback:) userInfo:touchData
                  repeats:NO];
    [self.timer fire];
} 
```

touchesFinishedWithoutCallback: 方法只会在 touchesMoved*停止*被调用时被调用。

需要详细说明多点触控，但可以作为解决方案吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T04:06:30.970

我最初的假设是，每次触摸都有自己的对象，该对象以 or 开头`touchesBegan`和结尾，`touchesEnded`或者`touchesCancelled`我认为是正确的。无论如何，它与我当前的实现有关。我最初没有看到第二次触摸，因为没有为我正在使用的视图启用多点触摸。根据评论中的建议，我启用了该功能。在那之后，我能够看到第二次触摸的一些，但不是所有的触摸事件。我有时看不到第二次触摸的原因是因为我有一个启用了用户交互的子视图。显然，它在控制触摸。我取消选中它，然后能够看到触摸对象。

然后，我将通过坐标跟踪触摸切换为触摸 ID，并能够跟踪所有触摸的完整生命周期。通过坐标跟踪不起作用，因为我发现对于第二次触摸，`touchesEnded`坐标与最后一个相同，`touchesMoved`而不是与第一次触摸`touchesEnded`匹配 touchLocation 时的前一个位置相同。`touchesMoved`如果这听起来令人困惑，只需通过触摸 ID 而不是坐标来跟踪触摸。

# javascript - 如何改进我的代码以实现“return false”？

> ID：13940618
> 
> 赞同：3
> 
> 时间：2012-12-18T20:04:14.300
> 
> 标签：javascript, jquery

在条件语句失败后，我试图返回 false。

我有

```
$('#btn').click(function() {
    $('.title').each(function() {
        if (id == $(this).attr('id')) {
            alert('The name already exists.')
            return false; //I hope my codes would stop here if condition is true
        }
    })
    // my codes still call the doSomething function even if the conditional         
    //statement is true
    doSomething();
})​ 
```

我只想在以下`doSomething`情况下调用该函数`id != $(this).attr('id).`

下面的代码给了我想要的东西，但看起来很难看。

```
$('#btn').click(function() {
    var nameExist = false
    $('.title').each(function() {
        if (id == $(this).attr('id')) {
            alert('The name already exists.')
            nameExist = true;
            return false; //I hope my codes would stop here if condition is true
        }
    })
    if (!nameExist) {
        doSomething();
    }
})​ 
```

有人对此有更好的方法吗？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:14:07.610

切换到基本的 for 循环。

```
$('#btn').click(function() {
    var elements = $(".title");
    for (var i = 0; i < elements.length; i++) {
        if (id == elements[i].id) {
            alert('The name already exists.')
            return false; //I hope my codes would stop here if condition is true
        }
    }

    doSomething();
})​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:13:53.617

如果不介意提前退出循环，可以使用 jQuery`filter`

```
$('#btn').click(function(){
    var itensWithSameName = $('.title').filter(function(){
      return id == $(this).attr('id');
    })

    if(itensWithSameName.size() > 0)
        alert('The name already exists.');
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T20:12:55.893

**你不需要遍历元素**，你可以通过 id 和 class 来获取它，例如，`#myId.myClass`。

```
$('#btn').click(function() {
    if($('#' + id + '.title').length) {
        alert('The name already exists.');
    } else {
        doSomething();
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T20:07:52.823

我认为你所拥有的很好，但这避免了额外的条件：

```
var func = doSomething;
...
if (id == $(this).attr('id')) {
   func = $.noop;
...

func(); 
```

# ios - iOS快速枚举时需要修改一个预加载数据的NSMutableArray

> ID：13940620
> 
> 赞同：0
> 
> 时间：2012-12-18T20:04:18.070
> 
> 标签：ios, nsmutablearray, enumeration, fast-enumeration

我有一个包含对象列表的 NSMutableArray。我想要做的是遍历这个对象列表，并为我要插入的对象找到匹配的对象。一旦找到匹配的对象，我就想简单地用我要插入的对象替换当前列表中的对象。我正在尝试使用快速枚举来做到这一点：

```
TestResult *result = [[TestResult alloc] init];
    [result setName:name];
    [result setScore:score];
    [result setDateStamp:date];

    for (TestResult *checkTest in [DataModel sharedInstance].testResultList) {

        NSInteger indx = [[DataModel sharedInstance].testResultList indexOfObjectPassingTest:^BOOL(TestResult *obj, NSUInteger idx, BOOL *stop) {
            return [obj.name isEqualToString:name];
        }];

        if (indx != NSNotFound) {

            [[DataModel sharedInstance].testResultList replaceObjectAtIndex:indx withObject:result];

        }

    } 
```

不幸的是，当我运行上面的代码时，我收到以下错误：

```
*** Terminating app due to uncaught exception 'NSGenericException', reason: '*** Collection <__NSArrayM: 0x9624820> was mutated while being enumerated.' 
```

谁能看到我做错了什么，如何解决这个问题，同时实现我上面描述的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:14:20.170

首先，崩溃是不言自明的。您实际上是在变异（也就是替换数组中的一个对象），而快速枚举仍在进行中，这是不允许的。

如果您要采用您的设计，解决方案将是实际捕获对象的索引，打破快速枚举并替换快速枚举之外的对象。

但是，您正在做的事情是不正确的。使用 indexOfObjectPassingTest 的方法是这样的：

```
NSInteger indx = [[DataModel sharedInstance].testResultList indexOfObjectPassingTest:^BOOL(TestResult *obj, NSUInteger idx, BOOL *stop) {
    return [obj.name isEqualToString:name];
}];

if (indx != NSNotFound) {

    [[DataModel sharedInstance].testResultList replaceObjectAtIndex:indx withObject:result];

} 
```

您不需要手动枚举数组的所有元素。该函数在内部为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:08:30.560

正如错误消息所说，您无法编辑正在枚举的数组。你需要有一个不同的数组，然后你可以这样做。

以下会起作用，

```
TestResult *result = [[TestResult alloc] init];
[result setName:name];
[result setScore:score];
[result setDateStamp:date];

NSArray *array = [NSArray arrayWithArray:[DataModel sharedInstance].testResultList];    

for (TestResult *checkTest in array) {

    NSInteger indx = [[DataModel sharedInstance].testResultList indexOfObjectPassingTest:^BOOL(TestResult *obj, NSUInteger idx, BOOL *stop) {
        return [obj.name isEqualToString:name];
    }];

    if (indx != NSNotFound) {
        [[DataModel sharedInstance].testResultList replaceObjectAtIndex:indx withObject:result];
    }
} 
```

**更新：** 根据 Lefteris 的评论，如果您使用`indexOfObjectPassingTest`方法，则不需要遍历数组。

你可以简单地使用，

```
TestResult *result = [[TestResult alloc] init];
[result setName:name];
[result setScore:score];
[result setDateStamp:date];

NSInteger indx = [[DataModel sharedInstance].testResultList indexOfObjectPassingTest:^BOOL(TestResult *obj, NSUInteger idx, BOOL *stop) {
    return [obj.name isEqualToString:name];
}];

if (indx != NSNotFound) {
    [[DataModel sharedInstance].testResultList replaceObjectAtIndex:indx withObject:result];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T20:09:49.120

正如错误消息所说，您无法修改 foreach bucle 中使用的数组。将您的代码更改为：

```
TestResult *result = [[TestResult alloc] init];
[result setName:name];
[result setScore:score];
[result setDateStamp:date];

NSInteger indx = NSNotFound;
for (TestResult *checkTest in [DataModel sharedInstance].testResultList) {

    indx = [[DataModel sharedInstance].testResultList indexOfObjectPassingTest:^BOOL(TestResult *obj, NSUInteger idx, BOOL *stop) {
        return [obj.name isEqualToString:name];
    }];
}
if (indx != NSNotFound) {
    [[DataModel sharedInstance].testResultList replaceObjectAtIndex:indx withObject:result];                            
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T20:14:50.127

枚举时不能替换、删除或插入数组中的元素。但是您可以将元素的所有属性更改`idxn`为`result`. 这样对象就保留了。

希望这可以帮助！

# python - 将行从文件复制到列表

> ID：13940623
> 
> 赞同：0
> 
> 时间：2012-12-18T20:04:18.663
> 
> 标签：python

我需要编写一个从文件中读取的函数，并将每一行作为一个单元格放入列表中。我需要将 1 到 2 和 2 之间的行复制到末尾，并将它们中的每一个放在列表中的不同单元格中，而不包含包含数字和空行的行。我不知道如何让它工作。

文件：

```
; 1

####
# .#
#  ###
#*@  #
#  $ #
#  ###
####

; 2

######
#    #
# #@ #
# $* #
# .* #
#    #
###### 
```

我的代码：

```
def loader(filename):
    levels=[[]]
    f=open(filename, "r")
    x=[]
    for line in f:
        if ";" not in line:
            x.append(line)
        else:
            levels.append(x)
    f.close()
    return levels 
```

输出：单元格 1：

```
####
# .#
#  ###
#*@  #
#  $ #
#  ###
#### 
```

单元格 2：

```
######
#    #
# #@ #
# $* #
# .* #
#    #
###### 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:19:08.467

最终最佳解决方案：

如果你使用`re`，你可以从

```
; 1
```

至

```
; 2
```

这是代码：

```
import re
levels = [x[2:].strip() for x in re.split(';\s*\d', open(filename).read()) if x != ''] 
```

较旧：（补偿数字，并完全摆脱空行）

```
levels = [x[2:].strip() for x in open(filename).read().split(';') if x != ''] 
```

或者

```
levels = [x[1:].strip() for x in open(filename).read().split('; ') if x.strip() != ''] 
```

要打印输出：

```
for level in levels:
    print level 
```

或单独：

```
print levels[0]
print levels[1] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:19:13.477

试一试：

```
def loader(filename):
  levels,x = [],[]
  for line in open(filename,'r'):
    line = line.strip('\n').strip()

    # Skip blank lines
    if line == '':
      continue

    # Assuming that lines containing ';' mark a new cell, so save the old cell
    if ';' in line:
      if x != []:
        levels.append(x)
      x = []

    # If the line doesn't contain ';', it is part of the current cell
    else:
      x.append(line)

  # Save the last cell, if there was one
  if x != []:
    levels.append(x)
  return levels

cells = loader("testfile") 
```

您可以使用以下命令构建第 N 个单元的输出`cell_output = '\n'.join(cell[n-1])`：

`print '\n'.join(cells[0])`从上方打印您的“输出单元格 1”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T20:38:54.157

```
from itertools import groupby as gb

with open(file,'r') as f:
   [list(g) for k,g in gb(f.readlines(),lambda x:';'in x or x=='\n') if not k] 
```

出去：

```
[[u'####\n',
  u'# .#\n',
  u'#  ###\n',
  u'#*@  #\n',
  u'#  $ #\n',
  u'#  ###\n',
  u'####\n'],
 [u'######\n',
  u'#    #\n',
  u'# #@ #\n',
  u'# $* #\n',
  u'# .* #\n',
  u'#    #\n',
  u'######\n']] 
```

# android - Android Google Maps API v2 显示路线

> ID：13940625
> 
> 赞同：13
> 
> 时间：2012-12-18T20:04:25.150
> 
> 标签：android, google-maps

> **可能重复：**
> [如何在谷歌地图中显示两个地理坐标之间的路线？](https://stackoverflow.com/questions/2643993/how-to-display-a-route-between-two-geocoords-in-google-maps)

我正在寻找一种方法来使用 Google Maps API v2 获取地图中显示的 2 个点之间的路线。我在 SO 中进行了搜索，但找不到此示例。也许有人可以通过链接或示例帮助我。

非常感谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T01:20:29.403

在 Maps API 的 v2 中，路线只是[PolyLine](https://developers.google.com/maps/documentation/mapview-tt/reference/com/google/android/gms/maps/model/Polyline)。恕我直言，比老式覆盖更方便/易于使用。

来自[Google Maps API V2 文档](https://developers.google.com/maps/documentation/android/lines#geodesic_and_non-geodesic_lines)：

```
Polyline line = map.addPolyline(new PolylineOptions()
                   .add(new LatLng(-37.81319, 144.96298), 
                        new LatLng(-31.95285, 115.85734))
                   .geodesic(true)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:41:11.677

距离计算是 GLatLng 对象的一种方法。

你可以使用这样的东西：

距离 = markerOne.getPoint().distanceFrom(markerTwo.getPoint());

[https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/LatLng](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/LatLng)

# php - 使用php将表单输入转换为文件中的文本

> ID：13940631
> 
> 赞同：0
> 
> 时间：2012-12-18T20:05:14.357
> 
> 标签：php, html, fputs

我有一个包含以下内容的 HTML 表单：

```
<form method="POST" action="/subscribe/subscribe.php">
<p><input type="text" name "Email" value="your@email.com" onfocus="if(!this._haschanged){this.value=''};this._haschanged=true;"></p>
<p><input type="submit" value="Submit" name="Submit"></p>
</form> 
```

我有`subscribe.php`包含以下代码的文件：

```
# CONTENT
$email = $_POST['Email'];

# SAVE A COPY
$mailcopyfile = 'mailcopyfile.txt';
$fp = fopen($mailcopyfile, "a"); 
fputs($fp, $now . $email . ", ");
fclose($fp); 
```

但是在我的 mailcopyfile.txt 中，我得到的只是每个新表单提交的逗号，例如：

```
, , , , , 
```

我究竟做错了什么？为什么邮件不显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:13:35.400

您的表单/输入行中有错误：

```
<p><input type="text" name "Email" value="your@email.com" onfocus="if(!this._haschanged){this.value=''};this._haschanged=true;"></p> 
```

name 参数后没有等号。所以我认为这就是为什么你的文本文件没有价值的问题。

```
<p><input type="text" name="Email" value="your@email.com" onfocus="if(!this._haschanged){this.value=''};this._haschanged=true;"></p> 
```

# javascript - Array() 中的变量未定义

> ID：13940633
> 
> 赞同：0
> 
> 时间：2012-12-18T20:05:25.887
> 
> 标签：javascript, padleft

我遇到了未定义变量错误的问题。这是我的代码：

```
window.sys.Bash = {};
window.sys.Bash.version = "";
window.sys.Bash.version.major = 0;
window.sys.Bash.version.minor = 1;
window.sys.Bash.version.build = 1;
window.sys.Bash.version.release = "beta";
window.sys.Bash.printing = false;
window.sys.Bash.queue = Array();
window.sys.Bash.span = bash;
window.sys.Bash.span.input = input;

window.sys.Bash.version = ""
    + window.sys.Bash.version.major + "."
    + window.sys.Bash.version.minor + "."
    + Array(2-window.sys.Bash.version.build.toString().length+1).join('0')
    + window.sys.Bash.version.build + "-"
    + window.sys.Bash.version.release + " "
    + "(x86_64-" + window.sys.platform + ")";

delete bash; delete input; 
```

我的 Web 控制台说，window.sys.Bash.version.build 在这一行没有定义：

```
 + Array(2-window.sys.Bash.version.build.toString().length+1).join('0') 
```

[我从这里](https://stackoverflow.com/a/5367656/1137334)复制了代码，所以我不太了解它，但它应该可以工作，对吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:07:49.877

您定义`version`为原始的，而不是对象。尝试这个：

```
window.sys.Bash.version = {};
window.sys.Bash.version.major = 0;
window.sys.Bash.version.minor = 1;
window.sys.Bash.version.build = 1; 
```

向基元添加属性不是错误，但属性将被添加到一个临时对象，然后该对象会丢失。基本上，这发生了：

```
window.sys.Bash.version = "";
new String(window.sys.Bash.version).major = 0;
new String(window.sys.Bash.version).minor = 1;
new String(window.sys.Bash.version).build = 1; 
```

这在[这里](http://www.ecma-international.org/ecma-262/5.1/#sec-8.7.2)描述：

> 令 O 为 ToObject(base)。

这实际上与 相同`Object(str)`，实际上与 相同`new String(str)`

# iphone - 特殊字符 iPad Monotouch

> ID：13940636
> 
> 赞同：1
> 
> 时间：2012-12-18T20:05:31.693
> 
> 标签：iphone, ios, ipad, xamarin.ios

我为支持多种语言的 iPad 编写了一个单点触控应用程序。当我在 iPad 上安装 adhoc 时，我的一个按钮显示为“Múltiple”。当这里的另一个人在具有相同操作系统版本的 iPad 上安装相同的 adhoc 时，相同的按钮会显示“M?ltiple”。它用标准问号代替了特殊的“u”。再次 - 完全相同的临时二进制文件。有什么想法吗？我们似乎在我们的设备上都有相同的语言设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:14:59.970

我们的翻译来自服务器，而本地数据库不知何故损坏了。

# java - 如何在 Java 中加入两个可空集

> ID：13940638
> 
> 赞同：3
> 
> 时间：2012-12-18T20:05:39.177
> 
> 标签：java, map, set

我有两个地图，其中一个 String 作为键，Set 作为它的值。这两个映射可以共享相同的键。如果两个地图具有相同的键，我正在尝试将两个 Set 值合并在一起。问题是，第二个映射可能为空，并且由于并非所有键都在两个映射之间共享，因此集合也可能为空。我想出了几个选项，但它们看起来都很乱。想知道是否有人有更有效/更漂亮的方法。这是我到目前为止所拥有的：

`Set<String> mergedSet = (firstMap.containsKey(commonKey)) ? firstMap.get(commonKey) : new HashSet<String>();`

`mergedSet.addAll(secondMap != null && secondMap.containsKey(commonKey) ? secondMap.get(commonKey) : new HashSet<String>());`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:21:51.437

我会使用 Guava 的[HashMultimap](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/HashMultimap.html)而不是`Map<String, Set<String>>`. 它具有以下优点：

*   为给定键添加多个值的快捷方法，而不关心该键是否已存在 Set
*   调用时总是返回一个非空的 Set `get(key)`，即使没有为此键存储任何内容。

所以你的代码会变成：

```
Set<String> mergedSet = Sets.union(firstMultimap.get(commonKey),
                                   secondMultimap.get(commonKey)); 
```

该集合将只是两个集合的视图，这避免了复制每个元素。但是如果你想要一个副本，那就做

```
Set<String> mergedSet = Sets.newHashSet(Sets.union(firstMultimap.get(commonKey),
                                                   secondMultimap.get(commonKey))); 
```

如果您不想使用外部库，那么您的代码就可以了。我会使用`Collections.singletonSet()`第二个后备集，以避免不必要的空集创建。请注意：您的代码修改了第一组。它不会复制它。所以最后，第一张地图的每一组实际上都是一个合并的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:37:01.430

在某种程度上，这更多是风格问题，但有几点需要评论。首先，`containsKey`and`get`方法的成本相等，因此调用`get`和检查 null 返回值更有效。其次，在您的示例中，您将设置设置为`mergedSet`，`firstMap.get(commonKey)`这意味着您正在修改集合，`firstMap`它将是合并的集合。我猜你不想修改`firstMap`. 我建议使用更长的时间：

```
Set<String> mergedSet = new HashSet<String>();

Set<String> firstSet = firstMap.get(commonKey);
if (firstSet != null)
{
    mergedSet.addAll(firstSet);
}

if (secondMap != null)
{
    Set<String> secondSet = secondMap.get(commonKey);
    if (secondSet != null)
    {
        mergedSet.addAll(secondSet);
    }
} 
```

# php - 在 PHP 中实现 DSL

> ID：13940641
> 
> 赞同：9
> 
> 时间：2012-12-18T20:05:44.373
> 
> 标签：php, dsl

我有个主意。我想通过编写一些简单的代码，让我们的客户能够根据许多变量指定定价：

```
if customer.zip is "37208"
   return 39.99
else
   return 59.99 
```

在我的代码中，我会做这样的事情：

```
try {
   $variables = array('customer' => array('zip' => '63901'));
   $code = DSL::parse(DSL::tokenize($userCode))
   $returnValue = DSL::run($code, $variables);
} catch (SyntaxErrorException $e) {
   ...
} 
```

我想我想要的是在 PHP 中创建一个简单的 DSL，它允许我们的客户在设置定价方面有很大的灵活性，而不必让我们对每个案例都进行编码。

这是基本思想：

1.  我会提供一组变量和客户编写的代码。
2.  解析器将评估用户使用提供的变量编写的代码，并将客户返回的值返回给我。它会为任何语法错误等引发异常。
3.  然后我会在应用程序的正常逻辑中使用返回的值。

那么你知道在 PHP 中构建简单 DSL 的任何资源或框架吗？任何想法从哪里开始？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T20:30:45.297

抛开技术限制不谈，你可能真的要三思而后行，将这种编程能力赋予（我认为）非程序员。他们可能会以完全不可预测的方式搞砸，而您将成为必须清理混乱的人。至少要通过大量测试来保护它。也可能是法律术语。

但是你问了一个问题，所以我会试着回答这个问题。内部风格的 DSL（大多数人使用 DSL 一词时的意思）和外部风格的 DSL（更像是一种迷你语言）之间存在区别。Ruby 以拥有适合内部风格 DSL 的语法而闻名。另一方面，PHP 在这方面相当糟糕。

也就是说，您仍然可以在 PHP 中做一些事情——最简单的可能就是编写一个函数库，然后让您的客户使用该库以纯 PHP 编写代码。当然，您必须审核代码，但它会提供使用现有运行时的所有好处。

如果这还不够花哨，您将不得不深入研究沉重的东西。首先你需要一个解析器。如果你知道如何，它们可以很容易地手写，但除非你在学校被迫写一个，或者你有一个奇怪的爱好，只是为了好玩而写那种东西（我愿意），它可能会带你一个一点工作。解析器的基本组件是标记器和某种自动机（状态机），它将标记排列成树形结构（AST）。

一旦你有你的解析结构，你需要评估它。由于这是一个 DSL，特性的数量是有限的，性能可能不是你最关心的问题，你可以围绕 AST 编写一些面向对象的代码，然后就这样。否则，您可以选择编写某种解释器或将其交叉编译成另一种格式（PHP 将是一个明显的选择）。

整个过程中最棘手的部分主要是处理边缘情况，例如语法错误并向用户报告有意义的内容。再说一次，只要给 PHP 的一个子集的访问权限，就可以免费为您提供，所以请先考虑这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-19T21:43:18.597

如果其他人正在寻找另一种选择 - 考虑使用 Twig 创建集成到 Pico CMS ( [http://pico.dev7studios.com/#](http://pico.dev7studios.com/#) )的 DSL/解析 ( [http://twig.sensiolabs.org/](http://twig.sensiolabs.org/) ) .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-08T22:01:53.157

构建 DSL 解析器的标准方法是使用解析器生成器，也就是[编译器-编译器](https://en.wikipedia.org/wiki/Compiler-compiler)来完成繁重的工作。这允许开发人员以抽象的[BNF](https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)式语法表达 DSL，而不必深入解析和词法分析的本质。

示例包括C 中的[Yacc](https://en.wikipedia.org/wiki/Yacc)、Perl 中的[Regexp::Grammars和针对 Java 和其他几种语言的](http://search.cpan.org/~dconway/Regexp-Grammars-1.038/lib/Regexp/Grammars.pm)[ANTLR](http://www.antlr.org/)等。PHP 选项似乎是[PHP-PEG](https://github.com/hafriedlander/php-peg)。

# php - PHP 项目相对路径和 url

> ID：13940646
> 
> 赞同：1
> 
> 时间：2012-12-18T20:06:08.023
> 
> 标签：php, relative-path

我正在做一个项目。它是管理网站的控制面板。文件夹结构是这样的：

*   根
    *   图片
    *   css
    *   js
    *   模块
        *   用户
        *   类别
        *   ETC..
    *   索引.php
    *   配置文件

我在配置文件中设置了一些设置，其中一些是：

```
$site_url = $_SERVER['SERVER_NAME'];
define ('ABSPATH', 'http://'.$site_url.'/cpanel'); 
```

所以，我的问题是：如何加载相对于`ABSPATH`常量和所有`<a>`标签的所有资源（图像、css、js）？

有了这个，我可以将“cpanel 项目”移动到另一个目录级别，它仍然可以工作。像 Wordpress 博客一样，只设置博客 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:10:10.213

你不会在你的 php 视图中做这样的事情吗？

```
<script type="text/javascript" src="<?= ABSPATH ?>/my_js_file.js"></script>
<link rel="stylesheet" type="text/css" href="<?= ABSPATH ?>/my_css_file.css">

<img src="<?= ABSPATH ?>/my_image_file.jpg" /> 
```

这样，您可以将目录移动到 docroot 中的任何位置，只需更改`ABSPATH`配置文件中的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:21:21.847

您可能最好定义几个不同的变量，因为拥有 URL 对包含等目的没有用处。你可以这样做：

```
DEFINE(HOST_NAME, $_SERVER['SERVER_NAME']);
DEFINE(WEB_SERVER_ROOT, $_SERVER['DOCUMENT_ROOT']);
DEFINE(APP_ROOT, __DIR__);
DEFINE(URI_BASE, str_replace(WEB_SERVER_ROOT, '', APP_ROOT);
if ($_SERVER['HTTPS'] == 'on') {
    DEFINE(PROTOCOL, 'http');
} else {
    DEFINE(PROTOCOL, 'https');
}
DEFINE(URL_BASE, PROTOCOL . '://' . URI_BASE); 
```

对于包含，您可以执行以下操作：

```
include(APP_ROOT . '/modules/somefile.php'); 
```

对于输出图像、javascript、css 等链接，您可以使用以下内容：

```
<img src="<?php echo URL_BASE; ?>/images/someimage.jpg" />
<a href="<?php echo URL_BASE; ?>/somepage">Some Page</a>
<script type="text/javascript" src="<?php echo URL_BASE; ?>/js/somejs.js" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:09:36.357

有几种方法可以做到你所说的，但最简单的一种方法是使用 BASE 标签。

```
<head>
<base href="http://www.yoursitewithimages.com/folder-with-files/" target="_blank">
</head> 
```

然后你可以使用

```
<img src="img/image.jpg"> 
```

它会被读作

```
<img src="http://www.yoursitewithimages.com/folder-with-files/img/image.jpg"> 
```

更多信息在这里[http://www.w3schools.com/tags/tag_base.asp](http://www.w3schools.com/tags/tag_base.asp)或在这里[http://www.w3.org/TR/html-markup/base.html](http://www.w3.org/TR/html-markup/base.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-28T18:13:52.497

这是基于 Mike Brant 解决方案的替代方案。

```
//APP_ROOT and APP_BASE assumes that the current location of this 
//script is located in the root of your application.  
//Also assumes that the HOST_NAME is what you want in the URL.  
//See https://php.net/manual/en/reserved.variables.server.php for reference 
define('HOST_NAME', $_SERVER['HTTP_HOST']);
(empty($_SERVER['HTTPS'])) ? define('PROTOCOL', 'http') : define('PROTOCOL', 'https');
define('WEB_SERVER_ROOT', $_SERVER['DOCUMENT_ROOT']);
define('APP_ROOT', __DIR__);
$appBase = str_replace(pathinfo(__FILE__, PATHINFO_BASENAME), '', $_SERVER['SCRIPT_NAME']);
define('URL_BASE', PROTOCOL . '://' . HOST_NAME . $appBase); 
```

# java - 通过 Http 从 XML 读取

> ID：13940657
> 
> 赞同：-3
> 
> 时间：2012-12-18T20:06:42.307
> 
> 标签：java, xml, http

我正在尝试学习如何通过 Java 中的 Http 从 XML 文件中读取（从 url 获取），并且对于我应该从哪里开始感到非常困惑。我知道如何解析 XML 文档并将与元素关联的文本打印到屏幕上以及类似的基本操作，但我试图更进一步。

如果有人可以为我提供开始的地方或任何提示，将不胜感激。如果需要，我很乐意提供更多细节。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:31:44.267

似乎您已经知道如何处理 XML，您只是在询问如何通过 HTTP 获取 XML。这段代码应该可以工作。

```
URLConnection connection = new URL(urlThatReturnsXml).openConnection();
InputStream is = connection.getInputStream();
String responseAsString = org.apache.commons.io.IOUtils.toString(is); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:14:31.577

`java.net.URL`从 url 字符串创建一个对象并调用[`openStream()`](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#openStream%28%29)它。您现在有一个 InputStream 可供读取。那应该让你继续前进。

# c++ - 无法让#include 工作

> ID：13940666
> 
> 赞同：4
> 
> 时间：2012-12-18T20:07:41.130
> 
> 标签：c++, header-files, codeblocks

我正在学习 C++ 中的斯坦福课程 cs106b，但我被卡住了，我似乎无法正确理解。对于知道这类东西的人来说，这可能是一个非常容易解决的问题。我有三个文件，一个 main.cpp 和一个 randword.h 和 randword.cpp。在 randword.h 我有 #include "simpio.h" 这是一个定义 GetLine() 的斯坦福图书馆。我可以让 GetLine() 在 main.cpp 文件中工作，但是当我尝试编译时，我在 randword.cpp 中得到“对 'GetLine()' 的未定义引用”。

我使用代码块，并且使用了“添加文件...”功能。

这是 main.cpp 的代码：

```
 #include "randword.h"

  /* Private function prototypes */

  /* Main program */
  randword rw;
  int main() {
  rw.initDictionary();

} 
```

随机数.h：

```
 #ifndef RANDWORD_H_INCLUDED
   #define RANDWORD_H_INCLUDED

   #include <iostream>
   #include <fstream>
   #include <stdio.h>

   #include "simpio.h"
   #include "strutils.h"

   using namespace std;

   class randword{
       public:
       void initDictionary();
       string chooseRandomWord();
       string strArray[];
       private:

   };

   #endif // RANDWORD_H_INCLUDED 
```

随机.cpp：

```
 #include "randword.h"

   using namespace std;

   void randword::initDictionary(){
       string fileName;
       ifstream infile;
       fileName = GetLine();
       infile.open(fileName.c_str());
       if(infile.fail()) cout << "Couldn't read file.";
       return;
   }

   string randword::chooseRandomWord(){
   string st1;
   return st1;

   } 
```

任何帮助将非常感激！我怀疑这个问题已经发布了，但我找不到。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:26:07.290

尝试使用代码块手动添加库

*   打开你的项目
*   右键单击您的项目并选择构建选项..
*   选择调试器
*   转到链接器设置
*   在链接库下单击“添加”
*   找到您的 lib 文件，选择它并保留为相对路径
*   你的项目应该运行，如果不在这里回复（因为我解释错了）

* * *

randword.cpp 没有需要使用的库文件`GetLine`，您可能已将其包含在头文件中，但这不会延续到 randword.cpp。您需要像在任何其他文件中一样包含库文件才能访问它的功能。

```
//randword.cpp
#include <iostream>
#include "simpio.h" //include again!!!

//code here.... 
```

# jquery - jQuery 无限缩略图库

> ID：13940670
> 
> 赞同：3
> 
> 时间：2012-12-18T20:07:50.383
> 
> 标签：jquery, thumbnails, carousel, image-gallery, infinite-scroll

我正在寻找一个 jQuery 插件来制作像这样在 Flash 中制作的画廊：

[http://flash.tutfactory.com/interface/infinite-sliding-gallery/](http://flash.tutfactory.com/interface/infinite-sliding-gallery/)

我向谷歌查询了“jquery 无限画廊”、“jquery 滚动画廊”等，但找不到类似的东西。它返回的只是当您向下滚动页面时由 Ajax 加载的无限滚动画廊。您知道任何实现此类功能的插件吗？免费或付费对我来说并不重要。有趣的是，我发现了这个线程：[https](https://stackoverflow.com/questions/13874677/looking-for-jquery-infinite-carousel-with-mouseover-activation) ://stackoverflow.com/questions/13874677/looking-for-jquery-infinite-carousel-with-mouseover-activation有类似的问题，几天前就关闭了，我希望我的不会. 我在 jQuery 中发现的最接近的东西是： [http ://manos.malihu.gr/tuts/jquery_thumbnail_scroller_horizo​​ntal_full_light.html#](http://manos.malihu.gr/tuts/jquery_thumbnail_scroller_horizontal_full_light.html#) 但我不知道如何根据鼠标与边缘的接近程度以及如何使其平滑循环来实现各种滚动速度。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:23:08.800

如果你想增加或减少滚动的速度，你可以创建一个透明的 div，它会放在你想让鼠标悬停的地方。然后运行一个函数：

```
$("div").mouseover(function(){
    //increase here your speed
}).mouseout(function(){
    //decrease here your speed
}); 
```

在这里你有一个教程如何编写一个无限的轮播画廊： [http ://www.queness.com/resources/html/carousel/index.html](http://www.queness.com/resources/html/carousel/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:26:50.950

至于使用鼠标来控制滚动，这里有一些代码是从我做的一个有鼠标滚动的网站中提取的，但它适用于特定大小的画廊 - 不是无限的。正如 adamb 在评论中所说，您可能必须自己构建它，但这可以作为一些启动代码来检测鼠标位置。基本上，您必须通过在图像滚动到视野之外时移动图像来创建无限远的错觉。如果他们滚动左侧，则在滚动时将图像向右移动，反之亦然。

```
 $(function() {
buildThumbs();

function buildThumbs() {
    $('div.portfolio_gallery').each(function() {
        var width = 0;

        var wrapper = $(this).find('.gallery'); 
        wrapper.find('.scroller a').each( function() {
            width += $('.single_img').outerWidth(true);
        });

        var thumbs = $(this).find('.scroller');
        thumbs.css('width', width + 'px');

        makeScrollable(thumbs, wrapper);
    });
}
   function makeScrollable(thumbs, wrapper) {
    var width = wrapper.innerWidth();

    wrapper.scrollLeft(0);

    var leftBuffer = 100;
    var rightBuffer = 100;

    //When user move mouse over menu
    wrapper.unbind('mousemove').bind('mousemove', function(e) {
        var xPos = e.pageX - wrapper.offset().left - leftBuffer;
        var xMax = wrapper.innerWidth() - rightBuffer;
        if(xPos > 0 && xPos < xMax) {
            var perc = xPos / (xMax - leftBuffer);
            var scrollAmt = thumbs.outerWidth(true) - wrapper.innerWidth();
            wrapper.scrollLeft(perc * scrollAmt);
        }
    });
   }
 }); 
```

# c# - 关闭连接时出现 WindowsRT StreamSocket 异常

> ID：13940673
> 
> 赞同：2
> 
> 时间：2012-12-18T20:07:58.463
> 
> 标签：c#, sockets, async-await

所以我已经收到这个异常大约一个星期了，我终于设法把它变成了一个可以轻松阅读的代码片段。

作为背景，我正在为 Windows RT 编写应用程序，并且正在尝试使用基本套接字。

为了测试，我创建了一个本地套接字侦听器来充当服务器。服务器和客户端都需要能够在套接字上读/写。

客户端和服务器都不能（或不应该）知道有多少数据将通过网络（如果有的话）。这是一个绝对的要求。服务器应该能够按需处理任意数量的数据。

这是一个例子。它以单元测试的形式呈现，仅仅是因为那是我一直遇到错误的地方。从此示例中删除任何单行都会导致错误消失：

```
 [TestMethod]
    public async Task TestSomething()
    {
        //  Setup local server
        //
        StreamSocketListener listener = new StreamSocketListener();
        listener.ConnectionReceived += async (sender, args) =>
        {
            DataReader serverReader = new DataReader(args.Socket.InputStream);
            await serverReader.LoadAsync(4096);   //  <-- Exception on this line
        };

        await listener.BindServiceNameAsync("10181");

        //  Setup client
        //
        using (StreamSocket socket = new StreamSocket())
        {
            await socket.ConnectAsync(new HostName("localhost"), "10181");

            DataReader reader = new DataReader(socket.InputStream);
            Task readTask = Listen(reader);
        }
    }

    public async Task Listen(DataReader reader)
    {
        await reader.LoadAsync(4096);
    } 
```

异常发生在服务器调用的那一行，`LoadAsync(...)`当单元测试退出时抛出异常。

例外是（看似）简单的：

> 现有连接被远程主机强行关闭。（来自 HRESULT 的异常：0x80072746）

任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:46:31.790

使用新的 WinRT 套接字类型，正确编程套接字比以往任何时候都容易，但不要搞错：它们仍然是复杂的野兽。

“强制关闭”（WSAECONNRESET / 10054）错误是当远程端（在这种情况下，客户端）中止其连接时，它通过处置其`StreamSocket`. 这被报告为错误，但并不少见，应妥善处理。即，如果服务器已经发送了它的所有数据并且只是等待接收更多（可选）数据，那么它应该将 WSAECONNRESET 视为常规关闭。

提示：如果你传递[`Exception.HResult`](http://msdn.microsoft.com/en-us/library/system.exception.hresult%28v=vs.110%29.aspx)到[`SocketError.GetStatus`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.sockets.socketerror.getstatus.aspx)，你应该看到它是[`SocketErrorStatus.ConnectionResetByPeer`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.sockets.socketerrorstatus.aspx)。这样你就可以避免错误处理代码中的魔法值。

PS 我有[一篇博](http://nitoprograms.blogspot.com/2009/05/error-handling.html)文描述了一些更常见的套接字错误和一般的套接字错误处理。

# sql - 不同实例的 SQL 到实体框架查询

> ID：13940677
> 
> 赞同：0
> 
> 时间：2012-12-18T20:08:12.787
> 
> 标签：sql, entity-framework-4

我需要将以下查询从 SQL 转换为实体框架查询。任何人都可以请帮忙。

```
 var query3 = string.Format(@"
                    SELECT DISTINCT
                        Boxes.BoxName,
                        Employees.EmployeeNumber,
                        Boxes.Port,
                        Boxes.SerialNumber
                    FROM
                        Eventlog

                        INNER JOIN Boxes 
                            ON Eventlog.SerialNumber = Boxes.SerialNumber

                        INNER JOIN Employees 
                            ON Eventlog.EmployeeId = Employees.EmployeeId

                    WHERE
                        ActionId = {4}
                        AND Boxes.Deactivated = 0
                        AND ( ('*' = '{0}')
                            OR (Boxes.SerialNumber = '{0}') )
                        AND ( (-1 = {1})
                            OR (Employees.EmployeeId = '{1}') )
                        AND EventTime >= '{2}'
                        AND EventTime <= '{3}'
                    ", boxFilter3, ReportEmployeeIdFilter, ReportStartDate, ReportEndDate, actionFilter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:36:00.220

像这样的东西应该工作：

```
var query = (from log in context.Eventlog
             join box in context.Boxes 
                on log.SerialNumber equals box.SerialNumber
             join employee in context.Employees 
                on log.EmployeeId equals employee.EmployeeId
             where log.ActionId == actionFilter 
             && box.Deactivated == 0
             && (boxFilter3 == "*" || box.SerialNumber == boxFilter3)
             && (ReportEmployeeIdFilter == -1 || employee.EmployeeId == ReportEmployeeIdFilter)
             && log.EventTime >= ReportStartDate
             && log.EventTime <= ReportEndDate
             select new
             {
                box.BoxName,
                employee.EmployeeNumber,
                box.Port,
                box.SerialNumber
             })
             .Distinct(); 
```

# python - 当我尝试将 python 版本定义为 2.7 时，为什么 virtualenv 会抛出错误？

> ID：13940680
> 
> 赞同：0
> 
> 时间：2012-12-18T20:08:17.990
> 
> 标签：python, python-2.7, virtualenv

我尝试使用它创建一个新的 virtualenv 目录，`sudo virtualenv curdir -p /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7`但它引发了以下错误：

```
Running virtualenv with interpreter /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7
Traceback (most recent call last):
  File "/usr/local/bin/virtualenv", line 9, in <module>
    load_entry_point('virtualenv==1.6.4', 'console_scripts', 'virtualenv')()
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages/virtualenv.py", line 785, in main
    popen = subprocess.Popen([interpreter, file] + sys.argv[1:], env=env)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/subprocess.py", line 741, in __init__
    restore_signals, start_new_session)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/subprocess.py", line 1356, in _execute_child
    raise child_exception_type(errno_num, err_msg)
OSError: [Errno 13] Permission denied 
```

我知道我不被允许这样做，但为什么呢？python 2.7 位于那里，我想使用它。有没有办法在我的 virtualenv 中使用它？

我希望这不是一个太基本的问题。我对 Unix 命令行还是很陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:33:38.070

你必须指向 python 可执行文件，你在这里没有做。它位于`/Library/Frameworks/Python.framework/Versions/2.7/bin/python`。运行这个

```
 sudo virtualenv curdir -p /Library/Frameworks/Python.framework/Versions/2.7/bin/python 
```

# c# - 使用 foreach 读取列表得到另一个结果

> ID：13940683
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:08:40.233
> 
> 标签：c#

为什么我会得到这个结果？

代码：

```
List<int> samba = new List<int>(new int[]
            {1,2,0,0,0,0,3,2,1,
             0,0,0,0,0,0,0,0,0,
             });
  foreach (int i in samba)
            {
                label1.Text += samba[i];
            } 
```

结果：

```
1201111002111111111 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T20:12:50.787

也许您并不是要在当前项目的索引处打印项目，而是要打印当前项目：

```
List<int> samba = new List<int>(new int[]
{1,2,0,0,0,0,3,2,1,
    0,0,0,0,0,0,0,0,0,
    });
foreach (int i in samba)
{
    label1.Text += i;
} 
```

第一次通过循环时，您将打印出 position 的项目`1`，即`2`. 您第二次在位置打印出项目`2`，即`0`。然后你打印出`0`四次位置的项目，那就是`1`，等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:10:16.060

你可能想要的：

```
label1.Text = string.Join("", samba);
label1.Text += string.Join("", samba); // if the leading 1 is correct 
```

你在做什么：

```
对于 samba 中的每个值 n
  在 samba 中附加 index=n 处表示的值

```

虽然我不确定前导 1 （我`201111002111111111`在运行你的代码时得到），但我猜它是在`label1.Text`此代码执行之前。

# jquery - 是否有规范化浏览器键码的 jQuery 插件？

> ID：13940684
> 
> 赞同：1
> 
> 时间：2012-12-18T20:08:45.307
> 
> 标签：jquery, keycode

是否有一个 jQuery 插件可以跨浏览器规范关键代码？意思是，如果您按下某个键，那么您可以保证为您测试的每个浏览器获得相同的键代码？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T20:11:20.583

不，但是，它是内置在 jQuery 中的！

```
$("element").on("keypress",function(e){
    console.log(e.which);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:12:10.433

事件对象的`which`属性是为大多数浏览器中的键和鼠标事件定义的，但不是 IE < 9。不过，jQuery 规范了这种支持：[e.which](http://api.jquery.com/event.which/)（感谢@RocketHazmat 指出这一点）

```
$(this).keyup(function(e) {
    var code = e.which;
    ...
} 
```

# jquery - 在表格元素上使用属性时无法将 HTML 表格导出到 Excel

> ID：13940685
> 
> 赞同：1
> 
> 时间：2012-12-18T20:08:47.507
> 
> 标签：jquery, html, excel, html-table

我正在尝试使用我在互联网上找到的这个简单功能将 HTML 表格导出到 Excel：

```
$("#btnExport").click(function(e) {
    window.open('data:application/vnd.ms-excel,' + $('#tabla_datos').html());
    e.preventDefault();
});​ 
```

它工作得很好，但是当我向表中的任何元素添加属性时，例如 rowspan 或 colspan，Excel 无法正确导出。

这是HTML：

```
<div id="tabla_datos">
<table>
    <tr>
        <th>Columna 1</th>
        <th>Columna 2</th>
        <th>Columna 3</th>
    </tr>
    <tr>
        <td colspan='2'>Dato 1</td>
        <td>Dato2</td>
   </tr>
   <tr>
        <td>Dato 3</td>
        <td>dato 4</td>
        <td>Dato5</td>
   </tr>
</table>
</div>

<input type="button" id="btnExport" value=" Export Table data into Excel " />​ 
```

这是 jsfiddle：http: [//jsfiddle.net/WAR2v/](http://jsfiddle.net/WAR2v/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T19:21:48.680

有点晚了，但你有没有尝试对你的 URI 进行编码？

这段代码对我有用：

```
$("#btnExport").click(function(e) {
    window.open('data:application/vnd.ms-excel,' + encodeURIComponent($('#tabla_datos').html()));
    e.preventDefault();
}); 
```

# sql - 将行值转换为列

> ID：13940686
> 
> 赞同：0
> 
> 时间：2012-12-18T20:08:47.577
> 
> 标签：sql, sql-server-2008, pivot

我有一张桌子：

```
CREATE TABLE StatusStats (
    UserID      VARCHAR(50),
    StatusCategory  VARCHAR(50),
    StatusDuration  INT
) 
```

这包含，对于每个用户，他们有多少时间（StatusCategory）

*   富有成效的
*   非生产性
*   未知

（仅供参考...状态持续时间以秒为单位）

这些是仅有的 3 个值。

为了在使用 JOIN 到其他表的报告中使用此数据，我需要将该数据复制到此表中：

```
CREATE TABLE StatusStatsByUser (
    UserID      VARCHAR(50),
        Productive      INT,
        NonProductive   INT,
        Unknown         INT
) 
```

这将在每一列中包含 StatusDuration 列中对应于 StatusCategory 列中的值的值。

我不知道如何使用 SQL Server 2008R2 编写 SQL 代码来做到这一点。非常感激你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:14:18.487

也许是这样的：

```
INSERT INTO StatusStatsByUser
SELECT  UserId ,
        SUM(CASE WHEN StatusCategory = 'Productive' THEN StatusDuration
                 ELSE 0
            END) AS Productive ,
        SUM(CASE WHEN StatusCategory = 'NonProductive' THEN StatusDuration
                 ELSE 0
            END) AS NonProductive ,
        SUM(CASE WHEN StatusCategory = 'Unknown' THEN StatusDuration
                 ELSE 0
            END) AS Unknown
FROM StatusStats
GROUP BY UserId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:18:21.120

无需将此数据存储在表中，您可以轻松地创建一个视图，`PIVOT`将数据存储到您需要的列中：

```
CREATE VIEW yourPivotedView
AS 
select userid, Productive, NonProductive, Unknown
from 
(
    select userid, StatusCategory, StatusDuration
    from StatusStats 
) src
pivot
(
    sum(StatusDuration)
    for StatusCategory in (Productive, NonProductive, Unknown)
) piv 
```

一旦它出现在视图中，您就可以将其与其他表连接起来：

```
select *
from yourtable t1
inner join yourPivotedView p
  on t1.userid = p.userid 
```

但是，如果您必须将其插入到新表中，您可以使用：

```
insert into StatusStatsByUser (userid, Productive, NonProductive, Unknown)
select userid, Productive, NonProductive, Unknown
from 
(
    select userid, StatusCategory, StatusDuration
    from StatusStats 
) src
pivot
(
    sum(StatusDuration)
    for StatusCategory in (Productive, NonProductive, Unknown)
) piv 
```

# android - Android获取联系人电话图像

> ID：13940687
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:08:57.710
> 
> 标签：android, android-contacts, android-4.2-jelly-bean

嘿，我有一个程序员在让我的手机图像显示在应用程序中时遇到了一些麻烦。以下代码是他用来获取联系人图片的代码：

```
private long getContactIdFromNumber(String number) {
    Cursor c = null;
    try {
        String[] projection = new String[] { Contacts.Phones.PERSON_ID };
        Uri contactUri = Uri.withAppendedPath(
                Contacts.Phones.CONTENT_FILTER_URL, Uri.encode(number));
        c = getContentResolver().query(contactUri, projection, null, null,
                null);

        if (c.moveToFirst()) {
            long contactId = c.getLong(c
                    .getColumnIndex(Contacts.Phones.PERSON_ID));
            return contactId;
        }
    } finally {
        c.close();
    }
    return -1;
}

private boolean initPhoto() {
    boolean result = true;
    try {
        contactPhoto = People.loadContactPhoto(getApplicationContext(),
                ContentUris.withAppendedId(People.CONTENT_URI,
                        getContactIdFromNumber(phoneNumber)),
                R.drawable.header, null);
    } catch (Exception e) {
        result = false;
    }
    return result;
}

if (initPhoto()) {
   contact1.setImageBitmap(contactPhoto);
   contact2.setImageBitmap(contactPhoto);
   contact3.setImageBitmap(contactPhoto);
} 
```

我联系了我的电话号码和图片，但它从未加载到应用程序中。他应该在我上面发布的代码中寻找什么，以确保它获取正确的电话号码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T13:03:58.410

原来数字格式不正确。它正在寻找 xxxxxxxxxx，而电话中的号码是这样的 (xxx)xxx-xxxx，所以它永远不会匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:20:36.743

您是否必须使用联系人而不是 ContactsContract？API 级别 5 中已弃用联系人。

如果您尝试为电话号码加载照片，请使用 ContactsContract.PhoneLookup。android.provider.ContactsContract.PhoneLookup 的参考文档中有一个示例。查询该表将返回联系人的 LOOKUP_KEY。使用它来查询 ContactsContract.Contacts.Photo。

# r - 在 Linux 上从本地 .tar.gz 文件安装软件包

> ID：13940688
> 
> 赞同：17
> 
> 时间：2012-12-18T20:09:02.083
> 
> 标签：r

我想将`plyr`.tar.gz 文件中的包安装到我在 linux 机器上的 R 包库中。我该怎么做呢？我只是将它放在库目录中吗？如果我没有写权限怎么办？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-18T20:28:22.853

在命令行中：

```
R CMD INSTALL <package-name>.tar.gz 
```

或在 R 中：

```
install.packages(<pathtopackage>, repos = NULL, type="source") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-18T20:27:56.510

从命令行，

```
R CMD INSTALL plyr_x.y.z.tar.gz 
```

如果您无权写入标准库目录并且无法使用`sudo`覆盖，则可以通过以下方式将其安装在其他位置

```
R CMD INSTALL -l <user_lib> plyr_x.y.z.tar.gz 
```

`<user_lib>`您可以写入的目录在哪里。您可能需要`lib.loc`在随后加载包时指定，如果`<user_lib>`不在`.libPaths`（请参阅@DWin 的答案）。

有关更多信息，请参阅[http://cran.r-project.org/doc/manuals/R-admin.html](http://cran.r-project.org/doc/manuals/R-admin.html)；`R CMD INSTALL --help`也可能有用，尽管很简洁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T20:31:31.260

如果您没有默认安装的库的权限，您可以添加到 R 使用的搜索路径，`.libPaths`“获取/设置在其中查找包的库树”。

```
.libPaths()  # will display all current libraries
?.libPaths 
```

`install.packages`（在文件名之后）的第二个参数`plyr.version.tar.gz`可以是用户控制的库目录。

```
?install.packages 
```

我有点困惑，首先询问从 CRAN 安装，然后询问安装 tar.gz 文件，我从中形成了您已经下载该文件并希望安装它的印象。

# visual-studio - Sitefinity 5.3：如何将小部件放入我的 Visual Studio 模板中？

> ID：13940690
> 
> 赞同：2
> 
> 时间：2012-12-18T20:09:26.497
> 
> 标签：visual-studio, sitefinity, sitefinity-5

我是 Sitefinity 和在 Visual Studio 中构建模板的新手。我要做的是构建一个模板，该模板将自动包含可重用的组件（即页眉、导航、页脚等）。这样，当内容编辑器进入添加项目时，他不必手动添加应该已经在每个页面上的所有元素。

如何将导航小部件添加到我在 Visual Studio 中构建的模板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T02:27:27.497

模板最好在 Sitefinity 管理后端的设计菜单下的页面模板中创建。

您可以在 Visual Studio 中为非常基本的布局创建单个母版页，然后使用页面模板在该母版页上创建模板。然后，您可以将元素（导航、页脚等）添加到这些模板中，并基于这些模板创建页面。

您甚至可以嵌套模板，以便拥有基础（仅使用母版页）然后是两列、三列等布局。

这是一个视频，其中包含有关页面模板的更多信息：[http ://www.sitefinity.com/documentation/gettingstarted/design/create-your-first-sitefinity-template](http://www.sitefinity.com/documentation/gettingstarted/design/create-your-first-sitefinity-template)

我希望这是有帮助的！

# c# - 如何使用 XMLReader 读取特定节点元素下方的元素数量？

> ID：13940694
> 
> 赞同：2
> 
> 时间：2012-12-18T20:09:39.320
> 
> 标签：c#, .net, xmldocument, xmlreader, xelement

假设您有以下无法替换的 xml 约定：
每个类都由`<Class>`HashCode 属性表示。`<Class>`类的名称就在标签的正下方。

```
<?xml version="1.0" encoding="utf-8"?>
<Class HashCode="1">
  <Person>
    <Class HashCode="-3">
      <FullName>
        <FirstName>Dan</FirstName>
        <LastName>K</LastName>
      </FullName>
    </Class>
    <Age>20</Age>
    <Class HashCode="4">
      <Address>
        <Street>abc</Street>
        <City>new york</City>
        <ZipCode>30500</ZipCode>
        <PhoneNumber>1245</PhoneNumber>
      </Address>
    </Class>
 </Person> 
```

**问题**：我如何使用`XMLReader`object 来读取给定元素之后的 Node 元素的数量，直到我到达一个元素标签，该标签后面没有`<Class>`标签。

**例如**：
Starting at`<FullName>`将自动停止在`<LastName>`（因为在没有标签之前有一个`<Class>`标签）并返回它们之间的元素数，我猜是 1。

**假设：** 假设您有开始标签的`Hashcode`值和名称，它们当然会在`<Class Hashcode=>`标签之后出现。

我尝试了很多`XMLReader`方法并变得复杂，试图转换为`XMLDocument`with`XMlReader.ReadSubtree()`但似乎`XMLDocument`也没有帮助我。

# java - Hibernate：两个 OneToMany 属性，由具有不同列的同一实体映射

> ID：13940696
> 
> 赞同：4
> 
> 时间：2012-12-18T20:09:52.360
> 
> 标签：java, hibernate, one-to-many

我知道这可以通过 HQL 查询轻松解决，但是我更喜欢让 Hibernate 使用一些 OneToMany 属性来处理这个问题。

让我演示一下我希望我的域模型在伪代码中的样子：

```
Game
  Long GameID
  Team HomeTeam
  Team AwayTeam
  @OneToMany(mappedBy="team")
  Set<TeamPlay> HomeTeamPlays
  @OneToMany(mappedBy="team")
  Set<TeamPlay> AwayTeamPlays 
```

表结构类似，Game 表上有两个外键都指向 Team 表。显然，如果只有一个外键，那么它将代表真正的一对多关系，但实际上我想要的是同一实体子类型的两个双向一对多属性。

我不相信使用 @Where 注释会起作用，因为它需要一个常量，并且这里不允许使用 @JoinColumn。如果不可能，那没关系，我只是想从别人那里得到它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T01:19:52.560

我敢打赌，您并不真正了解 mappedBy 的用法。

您可以参考我在[https://stackoverflow.com/a/13812047/395202中的其他答案](https://stackoverflow.com/a/13812047/395202)

简而言之，mappedBy 是双向关系“对面”中的属性名称。

对于你的情况，它可能看起来像：

```
class TeamPlay {
    @ManyToOne
    Team homeTeam;

    @ManyToOne
    Team awayTeam;
}

class Team {
    @OneToMany(mappedBy="homeTeam")
    Set<TeamPlay> homeTeamPlays;

    @OneToMany(mappedBy="awayTeam")
    Set<TeamPlay> awayTeamPlays;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:31:48.330

您的代码没有任何问题。我已经在 TeamPlay 类上使用 @ManyToOne 对其进行了测试，并且效果很好。按预期在 TeamPlay 表上创建连接列。没有什么不寻常的

# c# - 命名空间 System.Configuration 中不存在 configurationManager

> ID：13940697
> 
> 赞同：55
> 
> 时间：2012-12-18T20:09:54.390
> 
> 标签：c#, sql-server, visual-studio-2005

我使用以下命名空间将我的项目连接到 sql server：

```
using System.Configuration; 
```

并且还使用了

```
string str=System.Configuration.ConfigurationSettings.AppSettings["myconnection"];
SqlConnection oconnection = new SqlConnection(str);
oconnection.Open(); 
```

当我运行程序时，发生错误并显示消息

> 'System.Configuration.ConfigurationSettings.AppSettings' 已过时。此方法已过时，已被 'System.Configuration! System.Configuration.ConfigurationManager.AppSettings '

但我在该命名空间中没有找到 ConfigurationManager 并且`oconnection.Open();`消息是

> 无效操作异常

未处理。

我能做些什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-12-18T20:20:50.637

转到引用，并添加对`System.Configuration`

完成此操作后，您应该可以参考`System.Configuration.ConfigurationManager`.

```
string str = System.Configuration.ConfigurationManager.AppSettings["myconnection"];
SqlConnection oconnection = new SqlConnection(str);
oconnection.Open(); 
```

来自 MSDN：`ConfigurationManager`该类使您能够访问机器、应用程序和用户配置信息。此类替换`ConfigurationSettings`已弃用的类。

[http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)

* * *

**编辑：附加信息**

在参考`InvalidOperationException`. 这是在连接字符串未指定数据源或服务器时引起的。我猜你的连接字符串是空的。

在您的 web.config 中检查连接字符串的位置。如果它属于该元素，那么您需要将代码更改为 search`ConnectionStrings`而不是`AppSettings`。

```
string str = System.Configuration.ConfigurationManager.
    ConnectionStrings["myconnection"].ConnectionString; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-02-19T15:27:26.930

如果解决方案中有多个项目，则必须添加对`System.Configuration`每个项目的引用才能`ConfigurationManager`在其中任何一个中工作。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-01-25T11:30:34.153

在您的项目中添加 System.Configuration.dll 的引用，然后 ConfigurationManager 将可用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-02T13:50:37.313

从 nuget 包安装 System.Configuration。然后添加参考。

# php - 如何从返回的数组对象中访问日期成员变量

> ID：13940708
> 
> 赞同：0
> 
> 时间：2012-12-18T20:10:44.373
> 
> 标签：php, sql-server, datetime

我正在尝试使用 PHP 从 SQL 2008 数据库服务器获取当前日期/时间。当我对返回变量进行转储时，我看到以下内容 -

```
array (size=1) <br />
  'current_date_time' =>  <br />
    object(DateTime)[1] <br />
      **public 'date' => string '2012-12-18 15:01:35' (length=19)** <br />
      public 'timezone_type' => int 3 <br />
      public 'timezone' => string 'UTC' (length=3) <br /> 
```

问题：如何仅访问“日期”变量？我尝试了以下但没有奏效：

`return $row["current_date_time"]->date`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:27:31.263

```
$row["current_date_time"]->format('Y-m-d H:i:s'); 
```

应该做你需要的。它看起来像是`$row["current_date_time"]`一个[DateTime](http://nz1.php.net/manual/en/class.datetime.php)对象。

# python - 返回“builtins.AttributeError：'NoneType'”的Python方法（用户定义）

> ID：13940709
> 
> 赞同：1
> 
> 时间：2012-12-18T20:10:52.853
> 
> 标签：python, class, methods, python-3.x, nonetype

我有这个大学项目，我在老师提供的测试文件中遇到了几个错误。

他们中的大多数都与此有关。例如，执行以下操作：

```
caminho(posicao(0,0)).caminho_junta_posicao('este').caminho_origem() 
```

返回：

```
Traceback (most recent call last):
  File "<string>", line 1, in <fragment>
builtins.AttributeError: 'NoneType' object has no attribute 'caminho_origem' 
```

但是，这样做：

```
c1 = caminho(posicao(0,0))
c1.caminho_junta_posicao('este')
c1.caminho_origem() 
```

不返回任何错误，而是返回预期的位置。

我不知道为什么会这样。Bellow 是定义示例中两个类的代码，因为我与其他人的问题非常相似。任何帮助将不胜感激。谢谢。

```
class posicao:
    def __init__(self,l,c):
        self.posicao=(l,c)
    def posicao_linha(self):
        return self.posicao[0]
    def posicao_coluna(self):
        return self.posicao[1]
    def posicao_igual(self,p2):
        return self.posicao[0] == p2.posicao_linha() and self.posicao[1]\
               == p2.posicao_coluna()
    def posicao_relativa(self,d):
        if d=='norte':
            return posicao(self.posicao_linha()-1,self.posicao_coluna())
        elif d=='sul':
            return posicao(self.posicao_linha()+1,self.posicao_coluna())
        elif d=='este':
            return posicao(self.posicao_linha(),self.posicao_coluna()+1)
        elif d=='oeste':
            return posicao(self.posicao_linha(),self.posicao_coluna()-1)

class caminho:
    def __init__(self,p):
        self.caminho = [p]
    def caminho_junta_posicao(self,d):
        p = self.caminho[-1]
        self.caminho = self.caminho + [p.posicao_relativa(d)]
    def caminho_origem(self):
        return self.caminho[0]
    def caminho_destino(self):
        return self.caminho[-1]
    def caminho_antes_destino(self):
        return self.caminho[:-1]
    def caminho_apos_origem(self):
        return self.caminho[1:]
    def caminho_comprimento(self):
        return len(self.caminho)
    def caminho_contem__ciclos(self):
        for p in range(len(self.caminho)):
            for p2 in self.caminho[p:]:
                if p2.posicao_igual(self.caminho[p]):
                    return True
        return False 
    def caminho_elimina_ciclos(self):
        caminho = self.caminho
        if self.caminho_contem_ciclos():
            for p in caminho:
                for p2 in caminho[caminho.index(p):]:
                    if p.posicoes_iguas(p2):
                        caminho = caminho[:index(p)]+caminho[index(p2):] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:25:31.810

您希望工作（但不工作）的代码不起作用，因为您的方法`caminho_junta_posicao()`没有显式返回值，这意味着它返回 None，从而导致您看到的错误。

你所说的代码确实有效（你的第二个例子），当我尝试它时实际上并没有工作（Python 3.1.3）——我得到了和以前一样的错误。

这是预期的，因为行为是一致的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:26:25.263

这种方法：

```
def caminho_junta_posicao(self,d):
    p = self.caminho[-1]
    self.caminho = self.caminho + [p.posicao_relativa(d)] 
```

没有明确`return`的任何东西，所以调用它的结果是`None`. 所以，

```
 caminho(posicao(0,0)).caminho_junta_posicao('este') 
```

将给出`None`，并且`None`没有`caminho_origem()`方法，因此您的错误。

Python 约定通常是就地执行的方法（如`.append`, `.extend`，这里是你的`.caminho_junta_posicao`） return `None`，这使得像这样的链接是不可能的。另一方面，它会导致意外地修改链中的原始对象，而您认为在副本上工作会变得更加困难。不过，有时链接确实会派上用场（`pandas`例如，请参阅库，它广泛使用它以获得巨大的好处。）

我不建议这样做，但如果你修改了`self`最后返回的方法，即

```
def caminho_junta_posicao(self,d):
    p = self.caminho[-1]
    self.caminho = self.caminho + [p.posicao_relativa(d)]
    return self 
```

那么结果`caminho(posicao(0,0)).caminho_junta_posicao('este')`将是你的（现在修改的）`caminho`对象，你可以按照你尝试的方式链接它。

# seo - 在robot.txt中禁止：/搜索是什么意思？

> ID：13940711
> 
> 赞同：0
> 
> 时间：2012-12-18T20:11:10.603
> 
> 标签：seo, blogger

我在我的 root.txt 文件中找到了这个

禁止：/搜索

这是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:15:00.843

如果您谈论的是 robots.txt 文件，那么它会向网络爬虫表明他们要避免进入该主机上以 /search 开头的 URL。您的 robots.txt 文件与[机器人排除标准](http://en.wikipedia.org/wiki/Robots_exclusion_standard)相关。

您在问题标题中提到“robot.txt”，在正文中提到“root.txt”。如果这确实是robots.txt文件，则需要将其命名为“robots.txt”，否则根本没有作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T13:04:21.923

它指示机器人/爬虫/蜘蛛他们不应访问该文件夹中的任何内容或该 URL 的变体，例如以下示例：

```
/search
/search?term=x
/search/page/
/search/category=y&term=x
/search/category-name/term/ 
```

关于上面关于这如何影响*索引*的评论（搜索引擎或其他实体是否会对 URL 进行编目），没有一个是完全正确的。

应该注意的是 robots.txt 文件中的指令是*抓取*指令，而不是*索引*指令。虽然合规机器人会在请求 URL 之前读取 robots.txt 文件并确定是否允许它们抓取该文件，但不允许规则不会阻止索引（甚至在不合规机器人的情况下，也不会阻止访问/爬行/刮）。

您会定期在 Google 中看到搜索结果的实例，其中的元描述暗示该页面已被包含但无法访问；类似于“我们无法显示描述，因为我们不允许抓取此页面”。这通常发生在 Google（或 w/e）遇到不允许的 URL 时，但认为该 URL 仍应被编目 - 在 Google 的情况下，这通常发生在高度链接和/或权威 URL 被禁止时。

为了防止索引，您最好使用页面元标记，甚至是 x-robots http 标头（对非页面资源特别有用，例如 PDF 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-22T20:13:19.237

**“禁止：/search”**告诉搜索引擎机器人不要索引和抓取那些包含“ **/search** ”的链接，例如如果链接是[http://yourblog.blogspot.com/search.html/bla-bla-bla](http://yourblog.blogspot.com/search.html/bla-bla-bla)那么机器人不会抓取和索引此链接。

# php - 长期访问令牌照片发布错误

> ID：13940712
> 
> 赞同：0
> 
> 时间：2012-12-18T20:11:13.390
> 
> 标签：php, facebook, facebook-graph-api

我使用长寿命`access_token`（2 个月）在 Facebook 粉丝页面上发布内容。

所以我使用以下内容发布文本（成功）：

```
$params = array(
                'access_token' => 'token',
                'message'=> ":-) <3",
                'image' => '@' . $image['file']
);

$post_id = $facebook->api('/'.$page_id.'/feed','post',$params); 
```

这个代码用于在相册中发布照片

```
$facebook->setFileUploadSupport(true);
$image['file'] = 'images/rezultate/facebook_photo_170439606380900.jpg';
$args = array( 'access_token' => 'token', 'message' => ':-) <3', 'no_story' => 0);
$args['image'] = '@' . $image['file'];
$target_url = "https://graph.facebook.com/356048711158011/photos";

$ch = curl_init(); 
curl_setopt ($ch,CURLOPT_URL,$target_url); 
curl_setopt ($ch, CURLOPT_POST, 1); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER,1); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $args);
curl_exec($ch);
curl_close ($ch); 
```

问题是：为什么使用**长寿命访问令牌我不能发布照片**？只有文字，但如果我使用**2 小时（短期）访问令牌，我可以发布照片**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T05:38:30.100

您必须使用从该extended_user_token 收到的页面令牌。从头开始执行以下步骤：

1.  转到[图形 API 资源管理器](https://developers.facebook.com/tools/explorer)
2.  在最右上角的应用程序菜单上选择您的应用程序
3.  获取访问令牌（短期令牌）。
4.  使用以下令牌从上述令牌生成长期访问令牌（2 个月）：

    ```
     graph.facebook.com/oauth/access_token?client_id=APP_ID& client_secret=APP_SECRET& grant_type=fb_exchange_token& fb_exchange_token=EXISTING_ACCESS_TOKEN 
    ```

5.  现在使用**这个**访问令牌并调用“/me/accounts”
6.  结果，复制与您的页面对应的访问令牌
7.  [通过Debugger](https://developers.facebook.com/tools/debug)检查此令牌的有效性。此页面令牌永远不会过期。

将此令牌与您的代码一起使用。

# c++ - 我的头文件和 .cpp 文件出错

> ID：13940716
> 
> 赞同：0
> 
> 时间：2012-12-18T20:11:35.127
> 
> 标签：c++, compiler-errors, multimap

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

嘿，我在我的游戏中遇到了这个错误。我有一个问题的标题和 .cpp 文件，所以很明显。但我一直在查看标头和 .cpp 文件，但找不到问题。这是错误：

```
Error   1   error LNK2019: unresolved external symbol "public: __thiscall Questions::Questions(void)" (??0Questions@@QAE@XZ) referenced in function "void __cdecl `dynamic initializer for 'questions''(void)" (??__Equestions@@YAXXZ)  C:\Users\Conor\Documents\College\DKIT - Year 2 - Repeat\DKIT - Year 2 - Semester 1 - Repeat\Games Programming\Millionaire\Millionaire\Main.obj  Millionaire 
```

以下是文件：

```
Questions.h
#ifndef QUESTIONS_H
#define QUESTIONS_H
#include <string>
#include <algorithm>
#include <map>
using namespace std;

class Questions
{
public:
    Questions();
    Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3);
    void shuffle(string *array, int n);
    string getQuestion();
    string getCorrectAnswer();
    string* getAnswers();
    bool checkAnswer(string answer);
    void questionStore();
    void addQuestion(int level, Questions *question);
    Questions* printQuestion(int level);

private:
    string question;
    string correctAnswer;
    string* pAnswers;
    multimap<int,Questions*> map;

};

#endif

Questions.cpp
#include "Questions.h"
using namespace std;

Questions::Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3)
{
    this->question = question;
    this->pAnswers = new string[4];
    this->pAnswers[0]=wrongAnswer1;
    this->pAnswers[1]=wrongAnswer2;
    this->pAnswers[2]=wrongAnswer3;
    this->pAnswers[3] =correctAnswer;
    this->shuffle(this->pAnswers,4);
    this->correctAnswer = correctAnswer;
}

void Questions::shuffle(string *array, int n)
{
    random_shuffle(&this->pAnswers[0],&this->pAnswers[4]);
}

string Questions::getQuestion()
{
    return this->question;
}

string Questions::getCorrectAnswer()
{
    return this->correctAnswer;
}

string* Questions::getAnswers()
{
    return this->pAnswers;
}

bool Questions::checkAnswer(string answer)
{
    if(this->correctAnswer.compare(answer)==0)
    {
        return true;
    }
    return false;
}

void Questions::questionStore()
{
    Questions *q1 = new Questions("Whats the oldest known city in the world?", "Sparta" , "Tripoli" , "Rome", "Demascus");
    Questions *q2 = new Questions("What sport in the olympics are beards dissallowed?", "Judo", "Table Tennis" , "Volleyball", "Boxing");
    Questions *q3 = new Questions("What does an entomologist study?", "People" , "Rocks" , "Plants", "Insects");
    Questions *q4 = new Questions("Where would a cowboy wear his chaps?", "Hat" , "Feet" , "Arms", "Legs");
    Questions *q5 = new Questions("which of these zodiac signs is represented as an animal that does not grow horns?", "Aries" , "Tauris" , "Capricorn", "Aquarius");
    Questions *q6 = new Questions("Former Prime Minister Tony Blair was born in which country?", "Northern Ireland" , "Wales" , "England", "Scotland");
    Questions *q7 = new Questions("Duffle coats are named after a town in which country?", "Austria" , "Holland" , "Germany", "Belgium");
    Questions *q8 = new Questions("The young of which creature is known as a squab?", "Horse" , "Squid" , "Octopus", "Pigeon");
    Questions *q9 = new Questions("The main character in the 2000 movie ""Gladiator"" fights what animal in the arena?", "Panther" , "Leopard" , "Lion", "Tiger");

    addQuestion(1,q1);
    addQuestion(1,q2);
    addQuestion(1,q3);
    addQuestion(2,q4);
    addQuestion(2,q5);
    addQuestion(2,q6);
    addQuestion(3,q7);
    addQuestion(3,q8);
    addQuestion(3,q9);
}

void Questions::addQuestion(int level, Questions *question)
{
    map.insert(pair<int,Questions*>(level,question));
}

Questions* Questions::printQuestion(int level)
{
    multimap<int, Questions*>::iterator it;
    pair<multimap<int, Questions*>::iterator,multimap<int, Questions*>::iterator> ret;

    ret = map.equal_range(level);
    if(ret.first != ret.second)
    {
    size_t sz = distance(ret.first, ret.second);
    size_t idx = rand() % sz;
    advance(ret.first, idx);
    it =ret.first;
    return (*it).second;
    }
    else
    {
        return NULL;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:12:58.210

您正在声明`Questions::Questions()`但没有定义它。

它需要一个默认构造函数吗？您是否使用默认构造函数？它需要任何具体的实现吗？

在 C++11 中，您可以编写

```
Question() = default; 
```

在类定义中。在 C++03 中，您可以提供一个空实现：

```
Question() { } 
```

# php - 使用php偏移谷歌静态地图中心

> ID：13940719
> 
> 赞同：1
> 
> 时间：2012-12-18T20:11:41.633
> 
> 标签：php, google-maps

我正在使用谷歌地图来显示静态地图。

居中位于我使用 php 打印纬度和经度的位置。

例如 $latlng = 54.749920,-1.345552

这里的问题是静态图像将该位置放在图像的中心（就像它应该的那样）

我想要做的是稍微向下移动中心。为此，我需要将 200 添加到第一个值。54.749920 将变为 54.750120。

使用php可以做到这一点吗？我认为这与使用数组拆分两个值然后将 +200 添加到第一个值有关，然后再将它们重新组合在一起。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:45:08.173

我假设您将初始`$latlng`值作为字符串值...您提供的示例将在不带引号的情况下引发错误。所以如果你有一个字符串，下面的代码就可以解决问题：

```
$latlng = "54.749920,-1.345552";
$coords = split(',', $latlng);
$coords[0] = strval(doubleval($coords[0]) + 0.0002);
$latlng = implode(',', $coords);
//$latlng is now "54.750120,-1.345552" 
```

请注意，代码不会检查`$latlng`格式是否正确，如果不是，可能会引发错误。

# sql-server-2005 - SQL 服务器计算

> ID：13940720
> 
> 赞同：0
> 
> 时间：2012-12-18T20:11:41.883
> 
> 标签：sql-server-2005

我有 3 个表，如下所述

**MonthlyOrder 表 4 列** CustomerID DateID（以整数表示，并作为月份的第一天 = 20121201） OrderCount - INT

**HoursSpend Tbale 有 4 列** CustomerID DateID 函数 - VARCHAR() -- 函数是 Reporting、Admin 和 Sales call Hours - INTEGER -- 每个月花费在每个函数上的小时数

**Rates 表有 3 列** CustomerID AccountRate -- Money (如果 NULL 则默认为 $50) OperationRates - Money

我需要从这个表中实现的计算是 (LoadCount*AccountRate) + ((HoursSpend 表中的报告函数小时数 + Amin 的小时数 + 销售电话的小时数) * **Rates**表中的 OperationRates)

请告知实现此计算的最佳方法 **MonthlyOrder**
CustomerID DateID OrderCount
1 20121201 20
1 20121202 10
2 20121210 100
**HoursSpend**
CustomerID DateID Function Hours
1 20121201 Reporting 2
1 20121201 Admin 3
1 20121201 Sales Calls 5
1 1
**Rates**
Customer AccountRID2 5 1
1客户帐户RID201 18 美元 50 美元

**计算**- > (OrderCount*AccountRate) + ((Reporting Hours + Admin Hours + Sales Calls Hours) * OperationRates)
**customerID 1 on 20121201 的示例**-> (20*18) + ((2+3+5) * 50) = 860 美元
** 请注意，培训时间不包括在内，因为我关心的唯一时间是报告 + 管理员 + 销售电话

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:37:52.977

假设以下列组合是唯一的：MonthlyOrder[CustomerID,DateID], HoursSpend[CustomerID,DateID,Function], Rates[CustomerID] 你可以使用类似的东西：

```
select mo.CustomerID, mo.DateID, mo.OrderCount*max(AccountRate) +
        (sum(rep.hours)+sum(adm.hours)+sum(sc.hours))*max(rt.OperationRates)
from MonthlyOrder as mo
  join Rates as rt                on rt.CustomerID = mo.CustomerID
  left join HoursSpend as rep     on rep.CustomerID = mo.CustomerID and
                                     rep.DateId = mo.DateId and
                                     rep.Function = 'Reporting'
  left join HoursSpend as adm     on adm.CustomerID = mo.CustomerID and
                                     adm.DateId = mo.DateId and
                                     adm.Function = 'Admin'
  left join HoursSpend as sc      on sc.CustomerID = mo.CustomerID and
                                     sc.DateId = mo.DateId and
                                     sc.Function = 'Sales Calls'
group by mo.CustomerID, mo.DateID, mo.OrderCount 
```

# ruby-on-rails - 用关联保存对象的 Rails 方法是什么？

> ID：13940730
> 
> 赞同：1
> 
> 时间：2012-12-18T20:12:29.127
> 
> 标签：ruby-on-rails

我有几个具有通常一对多关系的类，例如：

```
class Blog < ActiveRecord::Base
  has_many :posts
end

class Post < ActiveRecord::Base
  belongs_to :blog
  validates :blog_id, presence: true
end 
```

当我建立一个博客并向其中添加一堆帖子时：

```
blog = Blog.new
blog.posts = [Post.new, Post.new] 
```

我不能只保存博客，如下所示：

```
blog.save 
```

因为帖子中的 blog_id 是空白的，所以帖子的验证失败。我认为 Rails足够*聪明*，可以检查对象的 id 或存在，但事实并非如此。

解决这个问题的正确 Rails 方法是什么？比：

```
saved = true
Blog.transaction do
  saved &&= @blog.save
  if saved && params[:blog][:posts].responds_to?(:each)
    params[:blog][:posts].each do |post|
      p = Post.new({blog: @blog}, without_protection: true)
      saved &&= p.save
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:15:06.460

你可以通过两种方式做到这一点

```
blog.posts.create(attributes_of_new_post) 
```

或者

```
blog.posts << Post.new(attributes_of_new_post) 
```

并将您的 has_many 更改为

```
has_many :posts, :inverse_of => :blog 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T10:09:39.610

到目前为止，我的解决方案是将验证行从：

```
validates :blog_id, presence: true 
```

至

```
validate { errors.add(:blog, "can't be blank") if blog_id.blank? && blog.blank? } 
```

这让我想知道，为什么 Rails 不为关联做这件事？这样做有什么危险吗？

# php - PHP关联键数组与数字键数组

> ID：13940731
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:12:35.393
> 
> 标签：php, mysql

> **可能重复：**
> [向数组键添加前缀的最快方法？](https://stackoverflow.com/questions/2607595/fastest-way-to-add-prefix-to-array-keys)

我有一个这样的数组：

```
0 => value 1,
1 => value 2, 
```

我想这样做：

```
keyname1 => value 1,
keyname2 => value 2, 
```

在 mySQL 数据库中，所有列都有名称，但数组使用数字而不是名称。是否有 PHP 或 mySQL 命令告诉它如何编写密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:15:09.287

```
array_walk($array, function($value, &$key){ $key = 'prefix' . $key;}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:17:11.330

获取结果集后，使用循环遍历它，并将列名添加`keys`到数组中。这是一个例子，

```
foreach($resultset as $k => $v)
 $array[$k] = $v; 
```

我假设这`$resultset`是一个数组。

**注意：**不推荐使用 Mysql_* 扩展。尝试改用 Mysqli_* 或 PDO 扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:43:16.903

回应您的评论：

您正在从 mySQL 数据库中检索数据，因此您可以将数据作为关联数组获取：

*PDO：*

```
//just as an example
$stmt = $pdo->prepare('SELECT foo, bar from foobar.foobaz WHERE xyz = :xyz');
$stmt->execute(array(':xyz' => $someValue));
$results = array();
while($row = $stmt->fetch(PDO::FETCH_ASSOC))
{
    array_push($results, $row);
} 
```

那应该这样做。当然，有`mysql_fetch_assoc`，但由于`mysql_*`扩展已弃用，我不会为此烦恼，只需切换到 PDO，如果您还没有。

如果您出于某种原因对 PDO 不满意，请查看`mysqli_*`，在这种情况下，循环如下所示：

```
while($row = $stmt->fetch_assoc())
{//using OO api
    array_push($results, $row);
}
//or
while($row = mysqli_fetch_assoc($result))
{//using OO api
    array_push($results, $row);
} 
```

完整示例 [在文档页面上](http://www.php.net/mysqli_fetch_assoc

# linux - 更改本地操作系统时间会影响数据库吗？

> ID：13940734
> 
> 赞同：2
> 
> 时间：2012-12-18T20:12:48.117
> 
> 标签：linux, oracle, oracle11g

目前我们的独立 11g R2 Oracle 数据库的时间错误，因为本地操作系统服务器（Linux redhat）也有错误的时间（关闭几分钟）。

我可以要求系统管理员将操作系统时间更改几分钟吗？这会影响数据库吗？更改本地操作系统时间后是否需要重新启动数据库？执行此操作时是否需要关闭数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:28:27.700

更改操作系统时间不会影响 Oracle 数据库本身，也不需要任何停机时间。

但是，更改操作系统时间可能会影响 Oracle 数据库中运行的应用程序。您需要与这些应用程序的所有者交谈，以确定是否真的会产生影响。例如，如果应用程序依赖于`DATE`指示插入和/或修改行的顺序的某个列，则将时钟向后移动几分钟可能会导致应用程序出现数据问题，其中行在插入之前已被修改，或者最后一次更新实际上并不是最后一次更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:02:50.360

您最好的选择可能是获得一个中断窗口，关闭 Oracle，设置 NTP，然后重新启动 Oracle。

# javascript - 将 VB 变量传递到后端脚本 'Response.Write("window.open(<%= linkLeft %>,'_blank')")

> ID：13940740
> 
> 赞同：0
> 
> 时间：2012-12-18T20:12:57.463
> 
> 标签：javascript, vb.net

我很好奇您是否可以将 vb 变量传递给后端 javascript。我有一个页面，用户可以上传图片和该图片的链接。我正在执行一个阅读器以从数据库中提取链接并将一个变量声明为 string = 给阅读器。当我尝试使用此代码将其传递给脚本时

```
Response.Write("<script>")
Response.Write("window.open(<%= linkLeft %>,'_blank')")
Response.Write("</script>") 
```

它只是作为我的 url/linkLeft 返回，而不仅仅是数据库中链接的 url。有没有办法将此变量传递到脚本中？我真的没有遇到任何事情来做到这一点。我使用它是因为我希望链接在新窗口中打开，所以我相信 response.redirect 是不可能的？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:19:40.077

我不知道`linkLeft`它是什么或在哪里定义，所以语法可能略有不同，但它会是这样的：

```
Response.Write("window.open('" & linkLeft & "','_blank')") 
```

# ruby-on-rails-3 - 调试 ActiveMerchant；需要完整的请求和响应。如何？

> ID：13940744
> 
> 赞同：5
> 
> 时间：2012-12-18T20:13:17.220
> 
> 标签：ruby-on-rails-3, paypal, activemerchant

Rails 3.0.10 和 activemerchant gem 1.29.3

我的应用程序在沙盒中运行良好，但生产模式下的事务因“安全标头无效”、“错误代码”=>“10002”而失败

在审查了所有配置参数一百万次之后，我们向贝宝发起了支持请求，他们认为我们遇到了错误的端点。他们要求对交易进行完整跟踪，包括标头等，所以我试图弄清楚如何做到这一点。我找到[了这篇文章](https://groups.google.com/forum/?fromgroups=#!topic/activemerchant/aehsn9_y9Z0)

建议将其添加到配置块

```
ActiveMerchant::Billing::PaypalGateway.wiredump_device = File.new(File.join([Rails.root, "log", "paypal.log"]), "a") 
```

但这只会导致日志为空；什么都没有倾倒它。

那么，如果可能的话，如何从 GATEWAY 对象中获取此信息？这是生产配置，其格式与 staging env 中使用的格式相同。

```
::GATEWAY = ActiveMerchant::Billing::PaypalGateway(
      :login => 'me_api1.blah...',
      :password => 'string...',
      :signature => 'longer string...'
    ) 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:07:40.473

需要添加的附加行如下：

```
ActiveMerchant::Billing::PaypalGateway.wiredump_device.sync = true 
```

在环境中的同一配置块内

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-12-19T00:13:05.027

在您使用的类库中的某个地方应该有一个函数可以为您输出它（如果它是一个构建良好的库，那就是。）

但是，即使没有这个，您也应该能够查看该 PaypalGateway 函数以查看它在何处/如何设置端点。它要么对值进行硬编码，要么根据您在类中其他位置配置的某些沙箱选项设置不同的端点。

如果不查看您正在使用的实际类库，很难告诉您更多信息，但我同意它必须是不正确的凭据或不正确的端点。当它不仅仅是无效的凭据时，我从未见过安全标头错误，这意味着您的值不正确或者您访问了错误的端点。

如果您想发布整个函数（或者甚至可能从其他函数设置整个库作为端点），我可以看一下并为您找到问题。

# jquery - jquery简单的正则表达式搜索包含的子字符串

> ID：13940745
> 
> 赞同：2
> 
> 时间：2012-12-18T20:13:22.743
> 
> 标签：jquery, regex, substring

我正在尝试一个非常简单的正则表达式，我的问题是我只需要确保 if is 在`data-title`my中找到以下术语之一`div`，然后警报会这样说：`Person Name, Email, Title`还有一些字符串。

我使用了一些组合，但我无法做到......所以我在这里做了一个小提琴：[jsfiddle](http://jsfiddle.net/aLdWD/)，我刚刚删除了我的正则表达式尝试除了`|`，所以我只留下了我想抓住的主要短语。有人可以帮忙吗？我知道可以使用 substring 或 indexOf 来完成，但我想用正则表达式来完成。

JS：

```
title = $('#me').attr('data-title');
alert(title);

if (title.match((Person Name) | (Email) | (Message) | (Company) | (Mobile) | (Title))) alert("It matched!");​ 
```

HTML：

```
<div id='me' data-title='en_Person name'>MY NAME IS FOO</div> 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:17:31.130

尝试在您的论点中使用适当的正则表达式`String.match`：

```
if (title.match(/Person Name|Email|Message|Company|Mobile|Title/)) {
    alert("It matched!");
}​ 
```

[http://jsfiddle.net/mblase75/aLdWD/3/](http://jsfiddle.net/mblase75/aLdWD/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:17:50.127

[http://jsfiddle.net/aLdWD/2/](http://jsfiddle.net/aLdWD/2/)

您需要将正则表达式包装在`/`分隔符中；你所拥有的只是一个语法错误。您还需要使用`i`修饰符来忽略大小写（标题中有“人名”，而表达式中有“人名”）。括号不添加任何内容。

# javascript - 无法将值从一个 javascript 函数发送到另一个

> ID：13940748
> 
> 赞同：0
> 
> 时间：2012-12-18T20:13:43.977
> 
> 标签：javascript, jquery

我正在尝试将参数值从一个 javascript 函数传递给另一个。

从下面的代码：我在函数之间传递两个值`formatLink`。`openDialog`但只有第一个值（`cellvalue`）正确传递，但发送值（`para`）没有传递。为什么我没有传递给函数 openDialog？请帮我

```
 <script type="text/javascript">

    function formatLink(cellvalue, options, rowObject)
    {
         var para=image.jpg; 
         return "<a style='cursor:pointer;' onClick='javascript:openDialog("+cellvalue+"),("+para+")'><img width='63' height='25' src='<s:url action='ImageAction' namespace='/myimage/secure'></s:url>" + "?imageId="+para+ "'></a>";
      }

    function openDialog(cellvalue,para) { 
        alert(para);//this is coming as undefine
            alert(cellvalue);//& this values is coming correctly

         //below diaologbox id is given to open
             $("#employees_details").load("<s:property value="loadformurl"/>?themeid="+employee);
            $("#employees_details").dialog('open');
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:17:12.813

在生成的函数调用中有一些额外的括号：

改变

```
return "<a style='cursor:pointer;' onClick='javascript:openDialog("+cellvalue+"), ("+para+")'><img width='63' height='25' src='<s:url action='ImageAction' namespace='/myimage/secure'></s:url>" + "?imageId="+para+ "'></a>"; 
```

至

```
return "<a style='cursor:pointer;' onClick='openDialog(\'"+cellvalue+"\', \'"+para+"\')'><img width='63' height='25' src='<s:url action='ImageAction' namespace='/myimage/secure'></s:url>" + "?imageId="+para+ "'></a>"; 
```

请注意，我删除了 onClick 处理程序中的结束和开始括号并修复了一些引号：

```
onClick='openDialog(\'"+cellvalue+"\', \'"+para+"\')' 
```

**更新**

答案最好在这个小提琴中显示：http: [//jsfiddle.net/sHQEn/](http://jsfiddle.net/sHQEn/)

# android - Android：Http 请求在 4.0 上不起作用

> ID：13940751
> 
> 赞同：0
> 
> 时间：2012-12-18T20:13:50.253
> 
> 标签：android, httpwebrequest, compatibility, android-compatibility

我测试了这段代码，它在 2.2 和 2.3.3 上运行良好，但在 4.0 上崩溃了。

问题似乎出在http请求上。任何想法为什么？

```
public class Rezultat extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity);

    //http post
    InputStream is=null;
    try{

            String url="http://google.com";
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(url);
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();
    }catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
    }
    //convert response to string
    try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
            }
            is.close();

            result=sb.toString();

    }catch(Exception e){
            Log.e("log_tag", "Error converting result "+e.toString());
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:16:17.460

e.printstacktrace() 会告诉你：

[http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)

> 当应用程序尝试在其主线程上执行网络操作时引发的异常。
> 
> 这仅针对面向 Honeycomb SDK 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。请参阅文档设计响应性。

```
private class DownloadFromUrlTask extends AsyncTask<String, Void, Bitmap> {

    protected void onPreExecute() {
        mDialog = ProgressDialog.show(ChartActivity.this,"Please wait...", "Retrieving data ...", true);
    }

    protected String doInBackground(String... urls) {
        //All your network stuff here.
        return result
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:15:51.923

您正在主线程上执行（可能很慢）网络操作。如果您的目标 SDK 是 11 或更高版本，则会抛出`NetworkOnMainThreadException`，因为此行为可能会阻塞 UI 并导致应用程序无响应。

您可以使用 an[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)来解决这个问题，将数据加载到其`doInBackground(..)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:16:07.103

您通常应该在询问崩溃时发布您的堆栈跟踪，但在这种情况下，您是在主 UI 线程上执行网络操作。不建议这样做，现在会引发异常。而是在另一个线程中执行它，可能通过 AsyncTask。

# python - 算术和对齐具有相同列、不同索引级别的 DataFrame

> ID：13940753
> 
> 赞同：5
> 
> 时间：2012-12-18T20:13:53.643
> 
> 标签：python, pandas

我有两个 pandas DataFrames -在列`weight`上有一个简单的索引`Land Use`。在和`concentration`上有一个 MultiIndex 。`Land Use``Parameter`

```
import pandas
from io import StringIO

conc_string = StringIO("""\
Land Use,Parameter,1E,1N,1S,2
Airfield,BOD5 (mg/l),0.418,0.118,0.226,1.063
Airfield,Ortho P (mg/l),0.002,0.001,0.001,0.002
Airfield,TSS (mg/l),1.773,11.47,0.862,0.183
Airfield,Zn (mg/l),0.001,0.001,4.95E-05,0.001
"Commercial",BOD5 (mg/l),0.036,0.0419,,0.315
"Commercial",Cu (mg/l),4.37E-05,7.34E-05,,0.00039
"Commercial",O&G (mg/l),0.0385,0.127,,0.263
Open Space,TSS (mg/l),0.371,3.01,1.209,0.147
Open Space,Zn (mg/l),0.0127,0.0069,0.0132,0.007
"Parking Lot",BOD5 (mg/l),0.924,0.0668,2.603,3.19
"Parking Lot",O&G (mg/l),1.02,0.149,1.347,1.88
"Rooftops",BOD5 (mg/l),0.135,1.00,0.0562,0.310""")

weight_string = StringIO("""\
Land Use,1E,1N,1S,2
Airfield,0.511,0.0227,0.0616,0.394
Commercial,0.0005,0.1704,0,0.1065
Open Space,0.0008,0.005,0.0002,0.0004
"Parking Lot",0.33,0.514,0.252,0.171
Rooftops,0.081,0.028,8.50E-05,0.003""")

concentration = pandas.read_csv(conc_string, index_col=[0,1])
weight = pandas.read_csv(weight_string, index_col=0) 
```

在这种情况下，列（1E、1N、1S 和 2）是流域。

我想做的是将所有浓度除以`Parameter`盆地（列名）和`Land Use`.

我在这里运气不太好。`concentration / weight`肯定行不通。我没有太多运气堆叠数据框并加入

```
wstk = pandas.DataFrame(weight.stack())
wstk.index.names = ['Land Use', 'Basin']
wstk.rename(columns={0:'weight'}, inplace=True)

cstk = pandas.DataFrame(concentration.stack())
cstk.index.names = ['Land Use', 'Parameter', 'Basin']
cstk.rename(columns={0:'concentration'}, inplace=True)

wstk.join(cstk, on=['Land Use', 'Basin']) # fails 
cstk.join(wstk, on=['Land Use', 'Basin']) # fails 
```

`on`当我离开kwarg时，最后两行不会引发错误，而是返回`NaN`连接列的结果。如果我将索引放在两个堆叠的 DataFrame 上，它们也会失败（例如，`wstk.reset_index(inplace=True)`在连接之前执行）。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T20:41:08.023

使用 DataFrame`div`方法并为要广播的多索引传递 matchkey：

从文档中`div`：

```
level : int or name
    Broadcast across a level, matching Index values on the
    passed MultiIndex level

In [39]: concentration.div(weight, level='Land Use')
Out[39]:
                                    1E          1N           1S           2
Land Use    Parameter
Airfield    BOD5 (mg/l)       0.818004    5.198238     3.668831    2.697970
            Ortho P (mg/l)    0.003914    0.044053     0.016234    0.005076
            TSS (mg/l)        3.469667  505.286344    13.993506    0.464467
            Zn (mg/l)         0.001957    0.044053     0.000804    0.002538
Commercial  BOD5 (mg/l)      72.000000    0.245892          NaN    2.957746
            Cu (mg/l)         0.087400    0.000431          NaN    0.003662
            O&G (mg/l)       77.000000    0.745305          NaN    2.469484
Open Space  TSS (mg/l)      463.750000  602.000000  6045.000000  367.500000
            Zn (mg/l)        15.875000    1.380000    66.000000   17.500000
Parking Lot BOD5 (mg/l)       2.800000    0.129961    10.329365   18.654971
            O&G (mg/l)        3.090909    0.289883     5.345238   10.994152
Rooftops    BOD5 (mg/l)       1.666667   35.714286   661.176471  103.333333 
```

# solr - 禁用 lengthNorm（长度标准化）

> ID：13940761
> 
> 赞同：0
> 
> 时间：2012-12-18T20:14:36.163
> 
> 标签：solr

我想在 Solr 中禁用 lengthNorm。有人建议使用 omitNorms=true。但我不能使用它，因为我也想做索引时间提升。“omitNorms=true”似乎禁用了索引时间提升。我在网上找到的另一种方法是覆盖 DefaultSimilarty 中的 lengthNorm 方法。但看起来这种方法在 Solr 4.0 中不再使用。还有其他方法吗？

```
public float lengthNorm(String fieldName, int numTerms) {
    return numTerms > 0 ? 1.0f : 0.0f;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T04:12:24.893

您可以检查4.0的[DefaultSimilarity的来源](http://fossies.org/dox/apache-solr-4.0.0-src/DefaultSimilarity_8java_source.html)

```
@Override
public void computeNorm(FieldInvertState state, Norm norm) {
    final int numTerms;
    if (discountOverlaps)
        numTerms = state.getLength() - state.getNumOverlap();
    else
        numTerms = state.getLength();
    norm.setByte(encodeNormValue(state.getBoost() * ((float) (1.0 / Math.sqrt(numTerms)))));
} 
```

您可以创建一个 numTerms 等于 1 的自定义类，或者删除计算`((float) (1.0 / Math.sqrt(numTerms)))`以消除 lengthNorm 效应。

# php - php自动加载项目

> ID：13940764
> 
> 赞同：1
> 
> 时间：2012-12-18T20:14:56.933
> 
> 标签：php, include, project, require, autoload

我有一个这样的项目：

![项目](../Images/3e9e9c6570eb2a2636403f6f11f720fe.png)

现在我想自动加载文件夹类和子文件夹中的所有 php 文件。

我可以这样做：

```
$dirs = array(
   CMS_ROOT.'/classes',
   CMS_ROOT.'/classes/layout',
   CMS_ROOT.'/classes/layout/pages'
);
foreach( $array as $dir) {
  foreach ( glob( $dir."/*.php" ) as $filename ) {
    require_once $filename;
  }
} 
```

但我不喜欢这个。例如。

> “布局/页面/a.php”扩展了“布局/页面/b.php”

现在我收到一个错误，因为首先加载了 a.php。你们是如何加载项目文件的？上课？

解决了 ：）

这是我现在的代码：

```
spl_autoload_register('autoloader');
function autoloader($className) {
    $className = str_replace('cms_', '', $className);
    $className = str_replace('_', '/', $className);

    $file = CLASSES.'/'.$className.'.php';
    if( file_exists( $file ) ) {
    require_once $file;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:21:33.843

你应该试试这个

```
<?php

spl_autoload_register('your_autoloader');

function your_autoloader($classname) {
    static $dirs = array(
      CMS_ROOT.'/classes',
      CMS_ROOT.'/classes/layout',
      CMS_ROOT.'/classes/layout/pages'
   );
   foreach ($dirs as $dir) {
      if (file_exists($dir . '/'. $classname. '.php')) {
          include_once $dir . '/' . $classname . '.php';
      }
   }
} 
```

注册后`your_autoloader`，`spl_autoload_register()`每次访问一个类时，php解释器都会调用它：

*   尚未加载`require_once()`或`include_once()`

*   不是 PHP 内部的一部分

# python - Python：同时调用多个递归

> ID：13940765
> 
> 赞同：1
> 
> 时间：2012-12-18T20:14:57.727
> 
> 标签：python, recursion

我收到此错误：

类型错误：+ 不支持的操作数类型：“int”和“NoneType”

对于此代码：

```
def a(n):
    if n < 0:
        return 0
    if n == 1:
        return 1
    if n > 1:
        return a(n-1) + a(n-2) + a(n-3) 
```

我应该如何调用多个递归？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:16:12.327

您缺少条件： - `1 > n >= 0`。因此，如果您的 and ，您不会返回任何`n >= 0`值`n < 1`。

可能是您的第一个条件应该是：-

```
if n < 1:
    return 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:19:25.523

详细说明 Rohit 的回答：如果一个 python 函数到最后没有返回任何东西，那么它会隐式返回 None。所以`a(0.5)`会回来`None`。如果你调用 eg `a(1.5)`，那么你最终会得到`a(0.5)+a(-0.5)+a(-1.5)`which 评估 to `None+0+0`which 给你你描述的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T20:22:42.523

问题是当n = 0时，没有if语句来处理这个，所以python函数隐式返回一个NoneType对象，改成这样：

```
def a(n):
    if n <= 0:
        return 0
    if n == 1:
        return 1
    if n > 1:
        return a(n-1) + a(n-2) + a(n-3) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T20:23:37.880

尝试这个：

```
def a(n):
    if n <= 0:
        return 0
    elif n == 1:
        return 1
    else:
        return a(n-1) + a(n-2) + a(n-3) 
```

诀窍是，您*必须*涵盖所有可能的值。你没有覆盖`n == 0`，最后一个条件应该是 an `else`，所以很明显不能有其他选择。

请注意，错误`unsupported operand type(s) for +: 'int' and 'NoneType'`发生在之前，因为如果不满足任何条件（例如，何时`n == 0`），则`None`返回，并且在递归中的某个时刻将 an`int`添加到 中`None`，从而导致错误。这就是为什么在覆盖递归中的所有可能性时非常详尽非常重要，确保考虑到所有可能的情况。

顺便说一句：有件事告诉我你漏掉了一个案子。如果 n == 2 会发生什么？应该还有另一种情况来处理这个问题。

# javascript - 当窗口宽度大于 769px 时，使用 jquery 追加和删除元素

> ID：13940772
> 
> 赞同：0
> 
> 时间：2012-12-18T20:15:10.563
> 
> 标签：javascript, html, jquery, append

当窗口宽度减小和扩大时，我正在尝试一些与幻灯片不同的东西。我在 slideshows.html 中有两个幻灯片的 html 代码。幻灯片标记为：

```
<div class="slideshow-mobile">... </div>

<div class="slideshow-desktop">... </div> 
```

当窗口宽度大于 769 像素时，我想将位于 slideshow.html 中的“.slideshow-desktop”附加到位于 index.html 页面的“#featured”div 中。

当窗口宽度小于 769px 时，我想从现有幻灯片中删除代码，'.slideshow-desktop'，然后在#featured 中附加'.slideshow-mobile'。换句话说，当窗口宽度小于 769 像素时，我只想将 '.slideshow-desktop' 替换为 '.slideshow-mobile'。

我希望这是从那时起。有谁知道，或者有关于如何做到这一点的线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:11:24.870

我推荐使用 Adapt.js ( [http://adapt.960.gs/](http://adapt.960.gs/) )，它有一个回调函数，你可以根据宽度添加/删除元素。

# java - 以速度遍历字符串

> ID：13940776
> 
> 赞同：1
> 
> 时间：2012-12-18T20:15:24.527
> 
> 标签：java, string, iterator, velocity

乍一看，我面临着一项相当微不足道的任务，但在一天之内，我并没有以某种方式取得进展。我需要在速度模板中处理一个字符串。该字符串具有这样的视图：

```
 Maj - [at552] - asdfghjkksfgh <br /> Avg - [at553] - asdfghjkksfgh <br /> etc 
```

我需要用以下文本替换 [ ] 符号中的文本：

```
 <a href="http://someaddress/at522">at522</a> (at522 is specific for 
    each [ ] block) 
```

我尝试了很多方法，但都没有奏效，所以我什至不知道我可以在这里发布哪些代码片段。一个重要的细节是我无法访问应用程序的 java 部分，只能访问传入速度模板的对象。我不能使用 JavaScript，因为这是一个电子邮件模板。我真的很感激每一个建议。

更新这是第一次出现 [ ] 时可以正常工作的代码

```
#set ($scopeComment = $issue.getCustomFieldValue("customfield_10201").replaceAll("\n", "<br />"))
#set ($start = $scopeComment.indexOf("["))
#set ($end = $scopeComment.indexOf("]"))
#set ($substr = $scopeComment.substring($start, $end))
#set ($scopeComment = $scopeComment.replace($substr, "<a href=\"localhost/$substr\">$substr</a>")) 
```

但我不能让它在所有 [] 块的循环中工作这是我正在尝试的方法之一

```
#foreach ($index in [0..$scopeComment.length()])
    #set($nextIndex = $index.index+1)
    #set($curChar = $scopeComment.substring($index.index, $nextIndex))
    #if ($curChar.equals("["))
        #set ($start = $count+1)
        #set ($end = $scopeComment.indexOf("]", count))
        #set ($sub = $scopeComment.substring($start, $end))
        $sub <br/>
    #end
#end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T01:32:42.597

在这种情况下，RegExp 将起作用：

```
#set ($var = $var.replaceAll('\[([a-z0-9]*)\]', '<a href="http://someaddress/$1">$1</a>')) 
```

请注意，我使用了**单**引号和**单反斜杠**。与 Java 不同，Velocity 在使用双引号或单引号时表现不同。

您的代码中有很多错误。例如，`$index.index`应该是什么？`$index`是一个整数，所以你应该只`$index`在你的检查中使用。此外，您使用`$count`但未在任何地方定义的，您可能`$index`也意味着。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T08:03:37.773

尝试正则表达式：

```
#set($var= $var.replaceAll("\\[([a-z0-9]*)\\]", "<a href="http://someaddress/$1">$1</a>")) 
```

[工作正则表达式示例](http://regexr.com?336aa)

# android - 确定屏幕大小——Android Eclipse

> ID：13940778
> 
> 赞同：0
> 
> 时间：2012-12-18T20:15:27.243
> 
> 标签：android, eclipse, scope, screen-size

这个问题的答案对我来说可能太高级了，但我还是想试一试。我能够在一个方法中确定和设置屏幕大小的值，但它没有该方法之外的范围。我的问题是，我如何在整个班级内赋予它范围？也在整个项目里面？谢谢。这是我用来确定屏幕尺寸的方法，但它只适用于单一方法：

```
 DisplayMetrics metrics = this.getResources().getDisplayMetrics();
    int width = metrics.widthPixels;
    int height = metrics.heightPixels; 
```

* * *

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:48:19.160

> 我的问题是，我如何在整个班级内赋予它范围？也在整个项目里面？

如果您只想设置一次这些值，那么扩展`Application`类可能是一个好的开始。

```
public class MyApplication extends Application {
    private Point mDimensions;

    @Override public void onCreate() {
        // this will only get run on app startup
        DisplayMetrics metrics = this.getResources().getDisplayMetrics();
        int width = metrics.widthPixels;
        int height = metrics.heightPixels;
        mDimensions = new Point(width, height);
    }

    public int getWidth() {
        return mDimensions.x;
    }

    public int getHeight() {
        return mDimensions.y;
    }
} 
```

要访问 getter 方法，`android:name`请在项目清单中的应用程序标记上设置属性：

```
<application android:name="com.myname.MyApplication" ... ></application> 
```

然后，您可以转换 any 的结果`getApplication()`并`getApplicationContext()`调用`MyApplication`和调用方法；例如

```
int width = ((MyApplication) getApplication()).getWidth(); 
```

请注意，由于宽度和高度值仅初始化一次，因此它们**不会**在屏幕方向更改时更改。如果你也想考虑到这一点，一个简单的 util 方法接受一个上下文实例（可以是一个`Activity`or `Service`）可能是一个更直接的解决方案。

```
public static Point getDimensions(Context context) {
    DisplayMetrics metrics = context.getResources().getDisplayMetrics();
    int width = metrics.widthPixels;
    int height = metrics.heightPixels;
    return new Point(width, height);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:28:44.923

并用方法返回结果，你可以使方法公开，或者使用任何getter方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:26:45.130

在您的方法中声明`int width`and `int height`，然后将它们更改为 nessecary。要从不同的方法访问它们，只需将它们声明为公共的，例如`public int width`

或者，如果您要将它们设为私有，那么您可以使用 getter 和 setter 方法。

# java - 如何在 jDev 中“连接”不同的用户界面

> ID：13940782
> 
> 赞同：1
> 
> 时间：2012-12-18T20:16:00.647
> 
> 标签：java, user-interface, uml

我有个问题。我正在为 UML 模型创建用户界面。

当我执行我的用户界面（应用程序）时，我首先想要一个“主菜单”框架弹出，给我 3 个不同的选择（要按下的按钮）。

* * *

例如，我希望“主菜单”- 框架向我展示：

```
 Customer(button1)

                     Product(button2)

                     Order(button3) 
```

* * *

例如，当我单击“客户”按钮时，我希望它访问“客户”框架，这是一个单独的框架，其中会有其他按钮、文本字段等。

请记住，我是 Java 的菜鸟，这是学校的第一个学期。

我怎样才能做到这一点？

# assembly - ARM 程序集加载 ASCII 内存地址

> ID：13940784
> 
> 赞同：4
> 
> 时间：2012-12-18T20:16:08.400
> 
> 标签：assembly, arm, ascii

我正在尝试学习 ARM 汇编，我的计算机生成的 .s 文件中有几行让我感到困惑，主要是这个块：

```
.L6:
   .word    .LC0-(.LPIC8+4)
   .word    .LC1-(.LPIC10+4
   .word    .LC0-(.LPIC11+4) 
```

以及它与这个块的关系：

```
.LCFI0:
     ldr r3, .L6

.LPIC8:
     add r3, pc 
```

我最好的猜测告诉我，这是将我的 ascii 字符串（开头）的内存地址加载到 r3 中，但我很困惑这是如何发生的。.LC0-(.LPIC8+4) 是调用 add r3, pc 的位置与字符串所在位置之间的差异。将 pc 添加到该差异应该以字符串结尾，但为什么不直接调用

```
ldr r3, .LC0 
```

而不是拥有这些 .word 东西和这个尴尬的 ldr/add 对？这是编译器处理此问题的唯一或最佳方法，还是只是编译器用于生成此类代码的某些通用算法的结果？

还有，什么是

```
 @ sp needed for prologue 
```

这听起来像是在提醒编译器将堆栈指针处理添加到序言中。但我觉得那应该已经发生了，那不是序幕所在的地方。

下面是大部分汇编代码以及我希望正确的注释（最后有一些调试内容，但包含的时间太长。

任何人都可以提供的任何帮助将不胜感激！

```
 .arch armv5te
    .fpu softvfp
.eabi_attribute 20, 1
.eabi_attribute 21, 1
.eabi_attribute 23, 3
.eabi_attribute 24, 1
.eabi_attribute 25, 1
.eabi_attribute 26, 2
.eabi_attribute 30, 2
.eabi_attribute 18, 4
.code   16
.file   "helloneon.c"
.section    .debug_abbrev,"",%progbits
.Ldebug_abbrev0:
    .section    .debug_info,"",%progbits
.Ldebug_info0:
    .section    .debug_line,"",%progbits
.Ldebug_line0:
    .text
.Ltext0:
    .section    .text.main,"ax",%progbits
    .align  2
    .global main
    .code   16
    .thumb_func
    .type   main, %function
main:
    .fnstart
.LFB4:
    .file 1 "jni/helloneon.c"
    .loc 1 4 0
    .save   {r4, lr}
    push    {r4, lr}
.LCFI0:
    .loc 1 4 0
    ldr r3, .L6             ; r3 = char* hello, first position
.LPIC8:
    add r3, pc              ; pc = program counter, r3 += pc?
    .loc 1 3 0
    mov r1, r3              ; r1 = r3
    add r1, r1, #127        ; r1 += 127
.L2:
    .loc 1 10 0             ; r2 = holding an item in char* hello. r3 = pointer to location in hello
    ldrb    r2, [r3]        ; r2 = r3 load next char
    sub r2, r2, #32         ; r2 -=32 subtract 32 to char in register
    strb    r2, [r3]        ; r3 = r2 put uppercase char 
    add r3, r3, #1          ; r3 += 1
    .loc 1 8 0
    cmp r3, r1              ; compare r3, r1
    bne .L2                 ; if not equal, goto L2
    .loc 1 13 0
    ldr r0, .L6+4           ; r0 = 
    ldr r1, .L6+8           ; r1 = 
    .loc 1 16 0
    @ sp needed for prologue
    .loc 1 13 0
.LPIC10:
    add r0, pc              ; r0 += pc
.LPIC11:
    add r1, pc              ; r1 += pc
    bl  printf              ; goto printf
    .loc 1 16 0
    mov r0, #0              ; r0 = 0
    pop {r4, pc}            ; epilogue
.L7:
    .align  2
.L6:
    .word   .LC0-(.LPIC8+4)     ; 
    .word   .LC1-(.LPIC10+4)    ; 
    .word   .LC0-(.LPIC11+4)    ; 
.LFE4:
    .fnend
    .size   main, .-main
    .section    .rodata.str1.4,"aMS",%progbits,1
    .align  2
.LC0:
    .ascii  "helloworldthisismytestprogramtoconvertlowcharstobig"
    .ascii  "charsiamtestingneonandineedaninputofonehundredandtw"
    .ascii  "entyeightcharactersinleng\000"
.LC1:
    .ascii  "%s\000"
    .section    .debug_frame,"",%progbits
.Lframe0:
    .4byte  .LECIE0-.LSCIE0
.LSCIE0:
    .4byte  0xffffffff
    .byte   0x1
    .ascii  "\000"
    .uleb128 0x1
    .sleb128 -4
    .byte   0xe
    .byte   0xc
    .uleb128 0xd
    .uleb128 0x0
    .align  2 
```

这是c代码：

```
#include <stdio.h>

int main()
{
    char* hello = "helloworldthisismytestprogramtoconvertlowcharstobigcharsiamtestingneonandineedaninputofonehundredandtwentyeightcharactersinleng"; // len = 127 + \0
    int i, size = 127;

    for (i = 0; i < size; i++)
    {
        hello[i] -= 32;
    }

    printf("%s", hello);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:09:57.273

`ldr r3, .L6`是伪指令。它实际转换为类似于LDR 指令和它试图加载的值的位置之间的内存距离`ldr r3,[pc, #offset]`。`offset`ARM 处理器的固定宽度指令意味着您只有这么多位可用于 LDR/STR 指令中的偏移量，这反过来意味着通过 PC 相对加载加载的值必须存储在与相应加载指令相当接近的位置。

`.LC0`与 完全不同的部分`.LPIC8`，因此很可能超出 PC 相关负载的范围。

一些 ARM 汇编器提供了一个[.LTORG](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0041c/Chedgddh.html)指令，可用于将文字“池”分散到与代码相同的部分。例如，这个：

```
LDR r3,=.LC0   ; note the '='
....
.LTORG 
```

在这样的汇编程序中会翻译成这样的东西：

```
LDR r3,[pc,#offset_to_LC0Value]
....
LC0Value: .word .LC0 
```

在问题中显示的汇编代码中，不仅仅是与 PC 相关的负载；正在加载的值也是 PC 相关的。这样做的原因是获得位置无关代码。如果加载并使用绝对地址，则除非从特定的虚拟地址执行代码，否则代码将失败。通过与当前 PC 相关的地址访问所有相关数据可以打破这种依赖关系。

# linq - 索引（从零开始）必须大于或等于零且小于 ef 5.0 查询中参数列表的大小

> ID：13940787
> 
> 赞同：0
> 
> 时间：2012-12-18T20:16:16.597
> 
> 标签：linq, linq-to-entities, code-first, .net-4.5, entity-framework-5

我有以下实体的基于代码的上下文：

```
public class City : IEquatable<City>
{

    public City()
    {
        Posts = new List<Post>();
    }

    public City(string cityName) : this()
    {
        Name = cityName;
    }

    public virtual ICollection<Post> Posts { get; private set; }

    public int Id { get; set; }

    public string Name { get; private set; }

    protected string  LoweredName 
    {
        get { return Name.ToLower(CultureInfo.CurrentCulture); }
    }

    public override bool Equals(object obj)
    {
        bool equals = false;
        var city = obj as City;
        if (city != null)
            equals = Equals(city);
        return equals;
    }

    public override int GetHashCode()
    {
        int idHash = Id.GetHashCode();
        int nameHash = LoweredName.GetHashCode();

        var hashCode = idHash ^ nameHash;
        return hashCode;
    }

    public bool Equals(City other)
    {
        return Id == other.Id && LoweredName == other.Name.ToLower(CultureInfo.CurrentCulture);
    }
}
public class Post : IEquatable<Post>
{
    public Post()
    {
        Addresses = new List<PostalAddress>();
    }

    public virtual ICollection<PostalAddress> Addresses { get; private set; }
    public virtual City City { get; set; }

    public int Id { get; set; }

    public string ZipCode { get; set; }
    protected string LoweredZipCode { get { return ZipCode.ToLower(CultureInfo.CurrentCulture); } }

    public bool Equals(Post other)
    {

        return Id == other.Id && City.Equals(other.City) && LoweredZipCode == other.ZipCode.ToLower(CultureInfo.CurrentCulture);
    }
} 
```

DbContext 在方法 OnModelCreating 中定义了这些实体：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    modelBuilder.Configurations.Add(new CityMap());
    modelBuilder.Configurations.Add(new PostMap());
}

public class CityMap : EntityTypeConfiguration<City>
{
    public CityMap()
    {
        // Primary Key
        HasKey(t => t.Id);

        // Properties
        // Table & Column Mappings
        ToTable("City");
        Property(t => t.Id).HasColumnName("Id");
        Property(t => t.Name)
            .HasColumnName("Name")
            .HasMaxLength(450);
    }
}
public class PostMap : EntityTypeConfiguration<Post>
{
    public PostMap()
    {
        // Primary Key
        HasKey(t => t.Id);

        // Properties
        // Table & Column Mappings
        ToTable("Post");
        Property(t => t.Id)
            .HasColumnName("Id");
        Property(t => t.ZipCode)
            .HasColumnName("ZipCode")
            .HasMaxLength(450);

        // Relationships
        HasRequired(t => t.City)
            .WithMany(t => t.Posts)
            .Map(map => map.MapKey("CityId"));
    }
} 
```

我已经将一些数据作为 POCO 对象读取并将它们插入到 List 集合中

```
public class PostImportObject : IEquatable<PostImportObject>
    {

        private string _city;
        private string _loweredCity;

        public string City
        {
            get { return _city; }
            set
            {
                _city = value.CapitalizeFirstLetter();
                _loweredCity = value.ToLower(CultureInfo.CurrentCulture);
            }
        }

        public string ZipCode
        {
            get { return _zipValue; }
            set { _zipValue = value.ToLower(CultureInfo.CurrentCulture); }
        }

        protected string LoweredCity
        {
            get { return _loweredCity; }
        }

        public override bool Equals(object obj)
        {
            bool equals = false;
            var postImport = obj as PostImportObject;
            if (postImport != null)
            {
                equals = Equals(postImport);
            }
            return equals;
        }

        public override int GetHashCode()
        {
            int ziphash = ZipCode.GetHashCode();
            int cityHash = LoweredCity.GetHashCode();

            var hashCode = ziphash ^ cityHash;
            return hashCode;
        }

        public bool Equals(PostImportObject other)
        {
            bool equals = _loweredCity == other.City.ToLower(CultureInfo.CurrentCulture) && ZipCode == other.ZipCode;
            return equals;
        }
    } 
```

如果我也在导入列表和数据库中查询数据，我的以下查询将返回相同的异常：

```
using(var db = new DbContext())
{
    var query1 = from post2 in db.Posts.Include("City")
                                    join mergedPost in mergedPosts on new PostImportObject() {City = post2.City.Name, ZipCode = post2.ZipCode} equals new PostImportObject() {City = mergedPost.City, ZipCode = mergedPost.ZipCode} into joinedPosts
                                    from joinedPost in joinedPosts.DefaultIfEmpty()
                                    where joinedPosts==null
                                    select post2;

            var query2= from city1 in db.Cities
                            join postImportObject in mergedPosts on city1.Name equals postImportObject.City
                            join post1 in db.Posts on city1 equals post1.City
                            select post1;
} 
```

在查询 query1 或 query2 的 Any() 方法时，我会得到以下异常： **索引（从零开始）必须大于或等于零且小于参数列表的大小**

很抱歉，我创建了另一个主题相同的主题，但我在其他主题中没有找到解决我的问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:15:07.893

查看堆栈跟踪，我猜`ELinq_UnsupportedConstant`资源的翻译版本有问题。此错误消息的英文版本是：*无法创建类型为“{0}”的常量值。此上下文仅支持原始类型 ('{1}')。*

我认为你有两个问题：

1.  对于 a `join`，复合键需要是匿名类型；你不能用你的`PostImportObject`作为加入键`query1`；

2.  您不能将数据库表连接到本地列表；

我认为您需要`.AsEnumerable()`先将整个列表拉入内存，然后才能加入本地列表：

```
var query = from post in context.Posts.Include(p => p.City).AsEnumerable()
            join mergedPost in mergedPosts 
               on new { City = post.City.Name, post.ZipCode } 
               equals new { mergedPost.City, mergedPost.ZipCode } 
               into joinedPosts
           from joinedPost in joinedPosts.DefaultIfEmpty()
           where joinedPost == null
           select post; 
```

# linux - apache https配置问题

> ID：13940796
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:17:06.547
> 
> 标签：linux, apache, ssl, https, virtualhost

我在配置我的 RHEL 机器以接受 HTTPS 连接时遇到问题。这是我到目前为止所拥有的：

我的 RHEL 机器位于 IP 上的 DMZ 中：172.16.0.3 - 我通过在浏览器中输入 IP 来访问该网站。我没有为此设置 DNS 条目：

我在用户目录上设置了一个虚拟主机：

```
/home/mywebapp 
```

我在这里创建了一个文件夹，我在其中创建了我的证书文件。

```
/home/mywebapp/application/certs/ 
```

我已使用此命令创建证书：

```
openssl req -new -x509 -days 365 -keyout 172.16.0.3.key -out 172.16.0.3.crt -nodes -subj  ‘/O=My Web App/OU=My Web App IT Dept/CN=172.16.0.3’ 
```

在 httpd.conf 中，我在 443 上启用了命名虚拟主机：

```
NameVirtualHost *:80
NameVirtualHost *:443 
```

我已按如下方式配置了我的虚拟主机：

```
<VirtualHost *:80>
 ServerName 172.16.0.3
 ServerAlias 172.16.0.3 *.172.16.0.3
 DocumentRoot /home/mywebapp/public_html
 <Directory "/home/mywebapp/public_html">
     allow from all
     Options +Indexes
 </Directory>
 <Location />
     RewriteEngine on
     RewriteCond %{HTTPS} off
     RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R]
 </Location>
 </VirtualHost>

<VirtualHost *:443>
 ServerName 172.16.0.3
 ServerAlias 172.16.0.3 *.172.16.0.3
 DocumentRoot /home/mywebapp/public_html
 <Directory "/home/mywebapp/public_html">
     allow from all
     Options +Indexes
 </Directory>
 SSLEngine On
 SSLCertificateFile /home/mywebapp/application/certs/172.16.0.3.crt
 SSLCertificateKeyFile /home/mywebapp/application/certs/172.16.0.3.key   
</VirtualHost> 
```

从服务器浏览器（例如“https://localhost”）访问该站点时，这似乎可以正常工作，但是尝试通过“https://172.16.0.3”从客户端浏览器连接时无法连接。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:01:02.873

1.  检查`iptable`防火墙
2.  `SELinux`如果可以，请禁用
3.  检查端口 80/443 是否正在监听使用`netstat -natp | grep -e 80 -e 443`
4.  使用`telnet 172.16.0.3 80`来自客户端的命令来检查它是否允许建立连接。

# c# - HttpLisenter Start 方法在 Windows 服务启动时失败

> ID：13940800
> 
> 赞同：0
> 
> 时间：2012-12-18T20:17:23.503
> 
> 标签：c#, windows-services, httplistener

我一直在玩弄在以下位置找到的 HttpListenter 东西：

[http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)

它在标准控制台应用程序上运行良好，但我正试图让它作为 Windows 服务运行。应用程序日志显示，当服务启动时，它在 HttpListener.Start() 方法上失败。我很困惑为什么会发生这种情况。

这是课程（这里是概念质量证明：）

```
public class Server
{
    public Server()
    {
        var thread = new Thread((Start));
        thread.Start();
    }

    public static void Start()
    {
        while(Listen())
        {
        }
    }

    private static bool Listen()
    {
        var prefixes = new[] {"http://192.168.0.7/"};

        if (!HttpListener.IsSupported)
        {
            Console.WriteLine ("Windows XP SP2 or Server 2003 is required to use the HttpListener class.");
            return false;
        }
        // URI prefixes are required, 
        // for example "http://contoso.com:8080/index/".
        if (prefixes == null || prefixes.Length == 0)
          throw new ArgumentException("prefixes");

        // Create a listener.
        HttpListener listener = new HttpListener();

        // Add the prefixes. 
        foreach (string s in prefixes)
        {
            listener.Prefixes.Add(s);
        }

        listener.Start();   //THIS FAILS IN WINDOWS SERVICE AS LOCAL SYSTEM

        //Console.WriteLine("Listening...");
        //// Note: The GetContext method blocks while waiting for a request. 
        //HttpListenerContext context = listener.GetContext();
        //HttpListenerRequest request = context.Request;
        //// Obtain a response object.
        //HttpListenerResponse response = context.Response;
        //// Construct a response. 
        //string responseString = "<HTML><BODY> " + DateTime.Now + "</BODY></HTML>";
        //byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseString);
        //// Get a response stream and write the response to it.
        //response.ContentLength64 = buffer.Length;
        //System.IO.Stream output = response.OutputStream;
        //output.Write(buffer,0,buffer.Length);
        //// You must close the output stream.
        //output.Close();
        //listener.Stop();

        return true;
    }

} 
```

相关日志：错误：

```
Application: Stout.Workers.Service.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.Net.HttpListenerException
Stack:
   at System.Net.HttpListener.Start()
   at Stout.Workers.Service.Server.Listen()
   at Stout.Workers.Service.Server.Start()
   at System.Threading.ThreadHelper.ThreadStart_Context(System.Object)
   at System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
   at System.Threading.ThreadHelper.ThreadStart() 
```

错误：

```
Faulting application name: Stout.Workers.Service.exe, version: 0.0.0.0, time stamp: 0x50d0cd99
Faulting module name: KERNELBASE.dll, version: 6.2.9200.16451, time stamp: 0x50988950
Exception code: 0xe0434352
Fault offset: 0x00014b32
Faulting process id: 0x1e70
Faulting application start time: 0x01cddd5bb3e8500b
Faulting application path:     C:\Users\Chad\Dropbox\Personal\Projects\Stout\Stout\Workers\Service\bin\Debug\Stout.Workers.Service.exe
Faulting module path: C:\Windows\SYSTEM32\KERNELBASE.dll
Report Id: f1aa9986-494e-11e2-be9b-685d43b0551c
Faulting package full name: 
Faulting package-relative application ID: 
```

信息：

```
Fault bucket , type 0
Event Name: CLR20r3
Response: Not available
Cab Id: 0

Problem signature:
P1: stout.workers.service.exe
P2: 0.0.0.0
P3: 50d0cd99
P4: System
P5: 4.0.30319.18016
P6: 505702c9
P7: 206c
P8: 5c
P9: System.Net.HttpListenerException
P10: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:51:59.210

我猜你正试图接受你的听众的多个请求。如果您仔细阅读代码，您会发现您正在实例化无限数量的侦听器，而不是创建单个侦听器来处理多个调用。

您实际得到的异常是 StackOverflowException（唯一不能用`try-catch`块捕获的异常）无论您做什么，应用程序都会中断。

删除您的`while`循环（只需调用一次 Listen）并尝试在您的 Listen 方法中使用以下方法。

```
HttpListener listener = new HttpListener();
//add your prefixes here
listener.Start();
AsyncCallback processRequest = delegate(IAsyncResult result)
{
    //set the listener to listen for next request
    listener.BeginGetContext(processRequest, listener);
    HttpListenerContext context = listener.EndGetContext(result);
    //Your code to handle the request here
}

listener.BeginGetContext(processRequest, listener); 
```

这将创建您正在寻找的循环`HttpListener`

希望这可以帮助

**更新**：如果您取消注释请求处理代码，您会注意到异常不会发生，因为您在调用时阻塞线程`listener.GetContext()`并且侦听器挂起，直到它收到请求并且 Listen 方法不返回。通过调用`listener.Start()`which inmediatelly 返回然后返回true，你正在以非常快的速度循环创建许多听众。

您的代码可能以这种方式工作，但效率低下，因为您必须为每个请求创建一个侦听器。最好让单个侦听器异步处理所有请求，因为如果您的一个请求需要 10 秒来执行，那么在您响应请求客户端之前，您的循环不会创建另一个侦听器。

# vb.net - 如何设置 DataGridView 行标记

> ID：13940806
> 
> 赞同：3
> 
> 时间：2012-12-18T20:17:42.560
> 
> 标签：vb.net, winforms, datagridview, tags

我在 listview 上使用双击事件，它将向 datagridview 添加三列。我不确定如何在“selectedText”变量上设置“Tag”属性。

```
Private Sub lwArticles_DoubleClick(sender As Object, e As System.EventArgs) Handles lwArticles.DoubleClick
    Dim selectedText = lwArticles.SelectedItems(0).SubItems.Item(0).Text 'Article No
    Dim selectedDesc = lwArticles.SelectedItems(0).SubItems.Item(1).Text 'Description
    Dim currRowNo As String = ""
    Dim alreadyExists = False

    For i As Integer = 0 To dgvDetail.Rows.Count - 1
        currRowNo = dgvDetail.Rows(i).Cells(0).Value
        If currRowNo = selectedText Then
            alreadyExists = True
            dgvDetail.Rows(i).Cells(2).Value += 1
            Exit For
        End If
    Next

    'If the entry doesn't exist, add it
    If Not alreadyExists Then
        dgvDetail.Rows.Add(New String() {selectedText, selectedDesc, 1})
    End If

End Sub 
```

在此之后，我循环浏览该行的标签以查看文章编号。它将在我的 dgvDetail.Rows.Add() 附近，我应该将 Tag 属性设置为等于 selectedText ...有人知道该怎么做吗？

编辑：正在填充的 datagridview 列是：“文章编号”、“描述”和“数量”。数量是在循环中设置的，基本上如果我双击同一个东西两次，它会将第三列（Cell（2））增加一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T22:00:18.263

DataGridView 控件的添加“函数”返回网格中行的索引，因此您可以尝试使用它来引用该行：

```
Dim rowIndex As Integer
rowIndex = dgvDetail.Rows.Add(New String() {selectedText, selectedDesc, 1})
dgvDetails.Rows(rowIndex).Tag = selectedText 
```

# meteor - 从 Meteor 集合中检索数据

> ID：13940807
> 
> 赞同：10
> 
> 时间：2012-12-18T20:17:45.573
> 
> 标签：meteor

我在尝试从 Meteor Collection 获取数据时遇到了一些问题，我需要一些建议。

该集合已成功定义、发布和订阅。如果我将数据发送到模板，它会显示正常：

```
Template.Lists.Projects = function(){
    return Projects.find();
}; 
```

但我试图在显示数据之前使用它，这就是我遇到问题的地方。首先，我发现 find() 和 findOne() 之间有些不一致。find(selector) 工作正常并返回一个游标，但 findOne(selector) 返回“未定义”。我真的只是在寻找 1 个条目，所以 find() 似乎没有必要。

返回 LocalCollection.Cursor：

```
var find = Projects.find({_id: "3fd33eed-9735-4376-860e-3be383beae2f"});
console.log(find); 
```

返回未定义：

```
var find = Projects.findOne({_id: "3fd33eed-9735-4376-860e-3be383beae2f"});
console.log(find); 
```

在 LocalCollection.Cursor 上使用 .fetch() 时会出现下一个问题。它返回一个空数组。

```
var find = Projects.find({_id: "3fd33eed-9735-4376-860e-3be383beae2f"});
var fetch = find.fetch();
console.log(fetch); 
```

所有这些返回都是以下行：

[ ]

当我尝试从要显示的数组中指定特定键时，例如：

```
var find = Projects.find({_id: "3fd33eed-9735-4376-860e-3be383beae2f"});
var fetch = find.fetch();
console.log(fetch.name); 
```

它返回未定义。

我仍然熟悉 Meteor 并且从未使用过 MongoDB（或 minimongo），所以我可能只是犯了一些愚蠢的错误。如果有人可以向我指出，我会很激动！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T09:19:52.073

您对 find() 和 findOne() 的结果是一致的。基本上，Mongo 或 minimongo 根本找不到与该 _id 匹配的文档。FindOne() 与 find(selector, options).fetch()[0] 完全一样。

您的 Lists.Projects 模板可能需要一个可以迭代的集合、数组或哈希。您不能退回一份特定的文件。如果您使用的是 {{#each Projects}}，则必须为模板提供某种方式来迭代而不仅仅是单个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T23:37:59.300

我最近遇到了同样的问题，集合 find() 从`query.observe`.

问题是`subscribe`集合的顺序。

例如，如果您有一个名为的集合`Lists`和一个名为的集合`Projects`，

如果您通过观察列表上的查询来获取项目，并且您有：

```
Meteor.subscribe('Lists');
Meteor.subscribe('Projects'); 
```

发生的情况是调用了查询观察触发器，但尚未从服务器获取项目。所以 Projects.find().fetch().length = 0。

要修复它，只需执行

```
Meteor.subscribe('Projects');    
Meteor.subscribe('Lists'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:37:08.107

如果您删除了自动发布，如果您在不使用发布名称的情况下将集合发布给所有用户怎么办？

```
Meteor.publish null, ->
    Products.find {} 
```

你在哪里订阅你的收藏？

模板助手

```
Handlebars.registerHelp = 'products', (id) ->
    Product.find _id: Session.get 'productId' 
```

就像我们对每种产品都有价格一样。模板部分看起来像......

```
<template name="products-list">
    <div class="products-list">
        {{#each products}}
            {{> product-item}}
        {{/each}}
    </div>
</template>

<template name="product-item">
    <div class="product-item">
        {{price}}
    </div>
</template> 
```

js部分，我会用coffeescript ...

```
Template['product-item'].price = ->
    console.log @ # @ is this as it is product itself, if we have product inserted.
    console.log this
    return 'the price is: ' + @price 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-22T09:29:48.157

试试这个方法

```
Meteor.subscribe('testData', function() {
  var document = Documents.find();
  console.log(document); 
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-24T10:23:39.070

您正在为客户端工作，但您永远不知道客户端何时获得了您需要的所有数据。当集合为空或仍未完成同步时，可以触发您的函数。因此，您必须向您的 minimongo 发出延迟请求（当所有数据都在本地可用时）

是的，当它没有通过或其他方式在 DOM 中呈现时，您无法访问内容，`getElementById()`但在您的情况下，您尝试从 minimongo（浏览器中的本地 mongodb 版本）而不是 DOM 访问数据，因此您的模板在这里并不重要。

只需等到您的订阅准备就绪，您的 minimongo 就会`onReady`在订阅调用中通过回调拥有所有数据并触发您的函数。

[https://docs.meteor.com/api/pubsub.html#Meteor-subscribe](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe)

> **回调**（函数或对象）。
> 
> 可选的。可能包括**onStop**和**onReady** 回调。如果有错误，它会作为参数传递给 onStop。如果传递的是函数而不是对象，则将其解释为 onReady 回调。

# javascript - jQuery悬停 - div不显示

> ID：13940819
> 
> 赞同：1
> 
> 时间：2012-12-18T20:19:04.887
> 
> 标签：javascript, jquery

我有这个 jQuery 代码：

```
$("#people td, #list td").hover(function() {
    $(this).stop().animate({
        backgroundColor: "#444"
    }, "fast");
    $(this).find(".controls").stop().fadeIn("fast");
}, function() {
    $(this).stop().animate({
        backgroundColor: "#333"
    }, "fast");
    $(this).find(".controls").stop().fadeOut("fast");
});

$("#list .controls").hide(); 
```

`.controls`是一个 div，其中包含一些与条目一起使用的链接（例如，页面上有 10 个条目）。直到这一刻一切都有效，现在它不再有效了。当我打开页面时，`.controls`隐藏 - 没关系。但是当我将鼠标悬停在`td`, css 动画上时，fadeIn 没有。第二个函数中的 fadeOut 也是如此（当触发 mouseleave 事件时）。

HTML如下：

```
<td>
    <div class="icons">

</div>
<div class="profile">
    <div class="info">
    <div class="name">

            </div>
        </div>
        <div class="controls">
    <a href="http://...">Link</a>
            <a href="http://...">Link</a>
        </div>
        <div class="clear"></div>
</div>
</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:40:11.990

这很奇怪。我在 .find(".controls") 之后删除了 .stop() ，现在它可以工作了。小问题是，当您将鼠标悬停进出几次时，动画会再运行几次。

# regex - 如何在 Vim 语法中突出显示以“@”开头的单词？

> ID：13940823
> 
> 赞同：7
> 
> 时间：2012-12-18T20:19:18.597
> 
> 标签：regex, vim, syntax

我有一个非常简单的 Vim 语法文件用于个人笔记。我想突出显示人们的名字，我选择了类似 Twitter 的语法`@jonathan`。

我试过：

```
syntax match notesPerson "\<@\S\+" 
```

意思是：以至少一个非空白字符开头`@`并具有至少一个非空白字符的单词。问题是这`@`似乎是 Vim 正则表达式中的一个特殊字符。

我试图逃避`\@`并用方括号括起来`[@]`，这是通常的技巧，但这没有用。我可以尝试类似`(^|\s)`（行或空格的开头），但这正是 word-boundary 试图解决的问题。

突出显示适用于简化的正则表达式，因此这更多的是找到正确的正则表达式而不是其他任何问题。我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-18T20:43:05.623

`@`仅当您通过`\v`在该模式之前的某个位置启用“非常神奇”模式时，它才是一个特殊字符`@`。

你这里还有一个问题：`@`不开始一个新词。`\<`不仅仅是像 perl/PCRE 那样的“单词边界” `\b`，而是“<em>left word boundary”（在帮助中：“单词的开头”）意味着`\<`必须跟一些关键字字符。由于`@`通常不是关键字字符，因此模式`\<@`永远不会匹配。（即使它是这样 `\b`的，它也会匹配这样的结构`abc@def`，由于上述原因，这绝对不是你想要的。）

您应该`\k\@<!@\k\S*`改用：`\k\@<!`确保`@` 前面没有任何关键字字符，`\k\S*`确保名称的第一个字符是关键字（您可能也可以使用`@\<\S\+`）。

还有另一种解决方案：包含 `@`到`'iskeyword'`选项中并保持正则表达式不变：

```
:setlocal iskeyword+=@-@ 
```

请参阅此处使用`:help 'isfname'`的解释`@-@`。（该`'iskeyword'`选项具有完全相同的语法，实际上会将您重定向到那里以获得解释。）

# calculator - 早期抵押贷款收益计算器背后的逻辑？

> ID：13940824
> 
> 赞同：0
> 
> 时间：2012-12-18T20:19:22.157
> 
> 标签：calculator, finance, pseudocode, computational-finance, amortization

我一直在寻找抵押贷款收益计算器，看起来可用的主要是商业的。有谁知道它是否已经以可以翻译成另一种语言的脚本形式存在？

如果没有，是否有人对不介意草拟伪代码的逻辑足够熟悉？一旦布局完成，我将能够将所有内容编写在一起，但到目前为止我所做的所有搜索都只显示了创建抵押（而非支付）计算器的结果。

除了明显的实用性之外，希望把这个逻辑放在那里可以帮助人们更好地了解他们的抵押贷款是如何计算的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T05:05:19.157

[http://www.r-bloggers.com/mortgage-calculator-and-amortization-charts-with-r/](http://www.r-bloggers.com/mortgage-calculator-and-amortization-charts-with-r/)

摊销向您显示与支付金额相同的剩余本金。

# bash - 在 Bash 中，我如何判断我当前是否在终端中

> ID：13940825
> 
> 赞同：5
> 
> 时间：2012-12-18T20:19:23.057
> 
> 标签：bash, gnome

我想创建自己的个人日志文件，不仅在我登录和注销时记录，而且在我锁定/解锁屏幕时记录。有点像类固醇上的 /var/log/wtmp。

为此，我决定在登录 Ubuntu 时运行一个脚本，该脚本在后台运行，直到我退出。我的计划是在脚本中添加脚本`.bashrc`，使用`./startlogging.sh &`和在我将`trap`用来捕获信号的脚本中。太好了，除了`.bashrc`每次我打开一个新终端时都会运行，这不是我想要的记录器。

有没有办法在 Bash 中告诉当前登录是 gnome 登录？或者，是否有某种`.gnomerc`我可以用来运行我的脚本？

**编辑：**这是我的脚本：

**编辑 2：**删除了脚本，因为它与问题无关。我将重新发布我的另一个问题，而不是重新利用这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:24:15.880

您是否正在寻找一种方法来检测它是什么类型的终端？

尝试：

```
echo $TERM 
```

来自[维基百科](http://en.wikipedia.org/wiki/Environment_variable)：

> TERM（类Unix）- 指定正在使用的计算机终端或终端仿真器的类型（例如，vt100 或dumb）。

另请参阅：[终端仿真器列表](http://en.wikipedia.org/wiki/List_of_terminal_emulators)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:59:22.043

对于 bash 使用：~/.bash_logout

这将在您注销时执行，这听起来像您正在尝试做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:25:29.250

好吧，对于bash ，你想要的是`.bash_login`/`.bash_logout`在你的主目录（而不是`.bashrc`或其他网络登录）。这些不是为在您创建的终端窗口中运行而创建的 bash 进程运行的（因为它们不是登录 shell），因此在您打开新终端时不会运行。

问题是，如果您使用不涉及终端的某种机制登录（例如在控制台上运行 gdm 以启动 gnome 或 kde 或统一会话），则没有登录 shell，因此 .bash_login/logout 永远不会运行。对于这种情况，最简单的方法可能是在您的 . 中放置一些东西`.xsessionrc`，它会在您每次启动 X 会话时运行（对于任何这些 GUI 环境都会发生这种情况，无论您运行哪个环境）。不幸的是，当 X 会话结束时没有运行标准脚本。

# transform - Gnuplot 在绘图中转换 x 轴数据

> ID：13940828
> 
> 赞同：0
> 
> 时间：2012-12-18T20:19:27.240
> 
> 标签：transform, gnuplot

我有这种格式的数据

```
apple 1

bananna 3

ornage 5

fig 4 
```

我希望 x 轴数据出现在图中，而不是在轴中。此外，它们是文字而不是数字。

请问我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T13:51:43.847

这个问题有点不清楚。您希望标签显示在哪里？这是一个示例，我将标签“apple”放在点 (0,1)，标签“banana”放在点 (1,3)，依此类推（每个标签在 x 轴下方移动 1 个单位):

```
plot 'data.dat' using (column(0)):2:1 with labels 
```

您还可以放置与之关联的点：

```
plot 'data.dat' using (column(0)):2 w p,\
             '' using (column(0)):2:1 w labels 
```

在这里，标签直接位于点的顶部。这可能不是你想要的——你可以添加一个偏移量：

```
plot 'test.dat' u (column(0)):2:1 w labels offset character 0,1,\
             '' u (column(0)):2 w p 
```

从文档 ( `help labels`) 看来，您的标签的外观应该可以通过您可以传递给的几乎任何选项进行修改`set label`。

> 打印文本的字体、颜色、旋转角度和其他属性可以指定为附加命令选项（请参阅“设置标签”）。

# java - Apache FOP - 如何查找将在哪个页面上打印哪些数据

> ID：13940829
> 
> 赞同：2
> 
> 时间：2012-12-18T20:19:36.647
> 
> 标签：java, apache, apache-fop

我在零售项目中使用 Apache FOP 从 XSLT 生成 PDF，然后打印 PDF。一项新的要求是在收据的每一页的页脚中打印运行总计。

我不确定如何实现这一点，因为除非我们将 XSL 转换为 PDF，否则我们不知道它将打印在哪个页面上，或者有什么我不知道的吗？

例子：

PDF 第 1 页：

项目 1 10

项目 2 20

## 总计 30

第2页：

项目 3 20

项目 4 10

## 总计 60

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T01:04:07.143

我做了一些谷歌，终于找到了可以在 XSLT 本身中完成的解决方案。

参考[http://www.java4less.com/apache/fop.php?info=xslfosubtotals](http://www.java4less.com/apache/fop.php?info=xslfosubtotals)

仅在其他人需要时添加此答案。

# javascript - 如何在 Mouseover 事件中使用 Hover

> ID：13940832
> 
> 赞同：2
> 
> 时间：2012-12-18T20:19:44.540
> 
> 标签：javascript, jquery, drag-and-drop

我正在尝试在**不**使用HTML5 拖放功能的情况下为我的网站创建**拖放功能。**我已经**弄清楚了拖动部分**，但我**无法将它们拖放到**特定的放置区域。这是我的代码：**`jQuery UI`**

 ********HTML**

```
<ul id="grid">
     <li class="drop">
          <div class="drag" id="el_1"><div>
     </li>
     <li class="drop">
          <div class="drag" id="el_2"><div>
     </li>
     <li class="drop">
          <div class="drag" id="el_3"><div>
     </li>
     <li class="drop"></li>
     <li class="drop"></li>
     <li class="drop"></li>
</ul>
<script>
     $(function() {
          $('.handle').mousedown(drag_and_drop);
     });
</script> 
```

**CSS**

```
#grid{
     position:relative;
     width:360px;
     height:auto;
}
.drop{
     width:100px;
     height:100px;
     margin:10px;
}
.drag{
     position:absolute;
     width:100px;
     height:100px;
}
#el_1{ top:10px; left:10px}
#el_2{ top:10px; left:130px}
#el_3{ top:10px; left:250px} 
```

**脚本**

```
function drag_and_drop(e){
        var drag = $(this);
        var drop = drag.parent();

        drag.addClass('draggable');

        drag_h = drag.outerHeight(),
        drag_w = drag.outerWidth(),
        pos_y = drag.offset().top + drag_h - e.pageY,
        pos_x = drag.offset().left + drag_w - e.pageX;

        $('.draggable').css('z-index', 9000).mousemove(function(e) {

/*

IN THIS MOUSEMOVE FUNCTION IS THERE ANY WAY TO DETECT IF THE DRAGGABLE DIV IS "HOVERING" OVER THE li.drop ELEMENTS?

*/

            $('.draggable').offset({
                top: e.pageY + pos_y - drag_h,
                left: e.pageX + pos_x - drag_w

            }); 
        }).mouseup(function() {
            drag.removeClass('draggable');
        });   
    e.preventDefault(); // stops the browser default drag method    
}; 
```

有没有什么方法可以让我开始拖动一个对象，它可以检测到它是否在一个特定的 li.drop 上——我可以从中将它放入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:11:45.937

您可以使用以下内容获取当前鼠标位置并编写另一个函数来查看该位置是否在可放置的 div 范围内。好文章在这里：

[http://docs.jquery.com/Tutorials:Mouse_Position#How_do_I_find_the_mouse_position.3F](http://docs.jquery.com/Tutorials:Mouse_Position#How_do_I_find_the_mouse_position.3F)******

# asp.net-mvc - 编写具有无限个匹配参数的自定义属性

> ID：13940833
> 
> 赞同：1
> 
> 时间：2012-12-18T20:19:46.660
> 
> 标签：asp.net-mvc, validation, asp.net-mvc-2, data-annotations, custom-attributes

我编写了一个 If-IsRequired 自定义属性来验证一个属性是否包含一个值，具体取决于模型中其他一些属性的值。由于我想让这个属性适用于尽可能多的情况，我想允许开发人员选择利用该属性来提供无限数量的匹配参数。最后，我希望能够强制所有参数都正确匹配。

这是我迄今为止所写的。虽然我目前正在使用字符串数组，但我很乐意使用某种无法工作的集合。此外，我现在需要支持当前的属性定义并创建一个包含比较运算符的新重载。除了假设所有比较都使用等于完成的原始定义之外，这将允许我进行小于、大于和不相等的比较。

```
 /// <summary>
    /// A custom attribute that checks the value of other properties passed to it in order to
    /// determine if the property this attribute is bound to should be required.
    /// </summary>
    [AttributeUsage(AttributeTargets.Property, AllowMultiple = true, Inherited = true)]
    public class IsPropertyRequiredAttribute : ValidationAttribute
    {
        private const string DefaultErrorMessage = "{0} is required.";

        public string[] _selectionContextNames { get; private set; }
        public string[] _expectedValues { get; private set; }

        /// <summary>
        /// Creates a new instance of the IsPropertyRequriedAttribute.
        /// </summary>
        /// <param name="SelectionContextNames">The name of the other property in the view model to check the value of.</param>
        /// <param name="ExpectedValues">The expected value of the other property in the view model in order to determine if the current property the attribute is bound to should be required.</param>
        public IsPropertyRequiredAttribute(string[] SelectionContextNames, string ExpectedValues)
            : base(DefaultErrorMessage)
        {

            _selectionContextNames = SelectionContextNames;
            _expectedValues = ExpectedValues;
        }

        public override bool IsValid(object value)
        {
            if (_selectionContextNames == null || _expectedValues == null)
            {
                if (_selectionContextNames != null || _expectedValues != null)
                {
                    string paramName;
                    if (_selectionContextNames == null)
                    {
                        paramName = "ExpectedValues";
                    }
                    else
                    {
                        paramName = "SelectionContextNames";
                    }

                    throw new ArgumentException("Key/Value pairs need to match for IsPropertyRequired.", paramName);
                }
            }
            else if (_selectionContextNames.Length != _expectedValues.Length)
            {
                string paramName;
                if (_selectionContextNames.Length < _expectedValues.Length)
                {
                    paramName = "ExpectedValues";
                }
                else
                {
                    paramName = "SelectionContextNames";
                }

                throw new ArgumentException("Parameter element counts need to match for IsPropertyRequired.", paramName);
            }

            bool paramsValid = true;

            if (_selectionContextName!= null)
            {
                for (int i = 0; i < _selectionContextName.Length; i++)
                {
                    string paramValue = HttpContext.Current.Request[_selectionContextName[i]];

                    if (_expectedValue[i] != paramValue)
                    {
                        paramsValid = false;
                    }
                }

                if (paramsValid == true)
                {
                    return (value != null);
                }
                else
                {
                    return true;
                }
            }
            else
            {
                return true;
            }
        }

        public override string FormatErrorMessage(string name)
        {
            return String.Format(DefaultErrorMessage, name);
        }
    } 
```

虽然使用属性来装饰属性将取决于属性的定义方式，这是我目前实现的（也可能会改进）：

```
[IsPropertyRequired(new string[] {"prop1", "prop2", "prop3", "prop4"}, new string[] {"1", "2", "3", "4"})]
public string SomeText { get; set; } 
```

另外，我想尽可能地防止以下装饰的发生：

```
[IsPropertyRequired(new string[] {"prop1", "prop2", "prop3", "prop4", "prop5withoutvalue"}, new string[] {"1", "2", "3", "4"})]
public string SomeOtherText { get; set; } 
```

并且使用包含比较运算符作为参数的新重载，我们现在可以拥有：

```
[IsPropertyRequired(new string[] {"prop1", "prop2", "prop3", "prop4"}, new string[] {"==", ">", "!=", "<="}, new string[] {"1", "2", "3", "4"})]
public string SomeComparisonText { get; set; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T01:33:28.807

[如MSDN](http://msdn.microsoft.com/en-us/library/aa664615%28v=vs.71%29.aspx)中所述，.NET 中的属性在您可以指定的允许类型方面非常有限。如果您想指定更复杂的数据，我建议您编写属性来为更丰富的数据结构指定备用位置。

例如，想象一个具有以下语法的属性：

```
[ValidationRules(typeof(MyValidationRuleInfo, "MyRuleSet")]
public int SomeProperty { get; set; }

...

public static class MyValidationRuleInfo {
    public static Dictionary<string, ValidationRule> MyRuleSet {
        get {
            return new { ... rules go here ... }
        }
} 
```

该属性将在目标类上查找属性并在那里获取所有规则。实现所有规则的所有逻辑仍然取决于您，但您可以避免使用属性汤，也可以避免笨拙的数据结构。

实际上，xUnit.NET 单元测试库对其`Theory`和`PropertyData`属性做了类似的事情，如下[所示](http://www.tomdupont.net/2012/04/xunit-theory-data-driven-unit-test.html)。

# autocomplete - UITextView 的默认自动完成建议发生了什么？

> ID：13940835
> 
> 赞同：0
> 
> 时间：2012-12-18T20:19:57.550
> 
> 标签：autocomplete, uitextview

我曾经在界面构建器中启用 set Correction = YES 以获得实时自动完成建议。现在，当我这样做时，文本会自动完成，而不会让我从以前的任何建议中进行选择。事实上，它迫使我写我不想写的词。有人可以告诉我发生了什么吗？我如何获得旧的建议？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T18:24:26.643

我遇到了同样的问题，但是代码在 UITextView 之后有 resignFirstResponder 然后成为FirstResponder。我不知道为什么会在那里，但删除它可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:39:52.513

在 UITextView TextViewDidChange 中，我创建了一个更改光标位置的线程。这当然发生在文本视图更改之后。光标位置的变化触发了自动完成，甚至没有让我看到有建议。

# drupal - 带有查询参数的 Drupal 7 path_save

> ID：13940836
> 
> 赞同：0
> 
> 时间：2012-12-18T20:20:06.990
> 
> 标签：drupal, drupal-7, drupal-path-aliases

我已经到处搜索了这个例子，但我没有找到任何例子。我正在尝试为包含查询参数的路径创建别名，例如 profile?arg1=113。

如果我提供`path_save()`路径的纯字符串表示形式，或者我是否提供`url()`.

```
url('profile', array('query' => array('arg1' => $uid))) 
```

无论哪种方式，*？*和*=*在 URL 别名管理页面上显示为转义字符，这自然意味着找不到路径。

我怎样才能保持？和=被逃脱？

**2012 年 12 月 19 日编辑 1：**更大的背景是我试图在保存[Profile2](http://drupal.org/project/profile2)配置文件时设置别名（即在 mymodule_profile2_presave() 中）——那时我将拥有我需要的所有信息以编程方式设置别名。

**2012 年 12 月 19 日编辑 2：**我刚刚意识到问题不在于插入端 - url_alias 表中实际上有未转义的字符。问题是 Drupal 在使用它之前不会对路径进行 urldecode ......

**2012 年 12 月 20 日编辑 3：**找到使用[重定向](http://drupal.org/project/redirect)而不是路径别名的解决方案。重定向正确解码查询字符串！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T08:18:00.737

您不能将查询字符串附加到别名的目的地。从[drupal_path_initialize()](http://api.drupal.org/api/drupal/includes!path.inc/function/drupal_path_initialize/7)执行的代码没有正确处理查询字符串。

该函数包含以下代码。

```
$_GET['q'] = drupal_get_normal_path($_GET['q']); 
```

假设您有“example”作为指向“node/93?uid=1”的路径别名；该代码将设置`$_GET['q']`为`'node/93?uid=1'`，而您期望`$_GET['q']`得到`'node/93'`，并`$_GET['uid']`设置为`1`。

您可以做的是使用类似于以下代码的代码实现[hook_inbound_alter() 。](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_url_inbound_alter/7)

```
function mymodule_url_inbound_alter(&$path, $original_path, $path_language) {
  list ($path, $query) = explode('?', $path);
  $_GET += drupal_get_query_array($query);
} 
```

# python - matplotlib 中相同大小的箭头

> ID：13940838
> 
> 赞同：6
> 
> 时间：2012-12-18T20:20:17.627
> 
> 标签：python, matplotlib

我想用 matplotlib 绘制箭头，这样每个箭头的大小都相同，而不管实际箭头的大小。

例子：

*   当前箭头：
    ![1](../Images/69e946c9b6fdbdcbcb5d749b646d623b.png)
*   所需的箭头：
    ![2](../Images/c3126883a826094856fc27063b978234.png)

使用以下方法绘制箭头`matplotlib.pyplot.Arrow()`：

```
# p is the point of origin, pdiff the direction        
arr = plt.Arrow(p[0], p[1], pdiff[0], pdiff[1], fc=color, width=0.4)
plt.gca().add_patch(arr) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T21:29:50.657

您在`pylab.arrow`（或`FancyArrow`）之后，然后您可以指定`head_width`，`head_length`因此它们与箭头的大小无关。这是一个例子：

```
import math
import pylab

pylab.plot(range(11), range(11))

opt = {'head_width': 0.4, 'head_length': 0.4, 'width': 0.2,
        'length_includes_head': True}
for i in xrange(1, 360, 20):
    x = math.radians(i)*math.cos(math.radians(i))
    y = math.radians(i)*math.sin(math.radians(i))

    # Here is your method.    
    arr = pylab.Arrow(4, 6, x, y, fc='r', alpha=0.3)
    pylab.gca().add_patch(arr)

    # Here is the proposed method.
    pylab.arrow(4, 6, x, y, alpha=0.8, **opt)

pylab.show() 
```

产生：

![在此处输入图像描述](../Images/14fb68874e0aafd3b63fdc368dc61a6f.png)

# c - Realloc() 在内存可用时返回 NULL - C

> ID：13940839
> 
> 赞同：1
> 
> 时间：2012-12-18T20:20:21.187
> 
> 标签：c, directory, realloc

*   操作系统：Windows Vista(x86)
*   编译器：代码::块

我目前正在编写一个打开指定目录并读取其内容的程序。而不是在找到文件名后立即使用 printf() 显示文件名。我将它们保存在内存中并稍后显示它们。我使用以下 if 语句来触发内存重新分配。我还包括了相关变量的声明。

```
//Represents what the new index will be after the current file name is added
//to 'stack.ptr'
#define NEW_INDEX (stack.index+(strlen(ptr_dirent->d_name)))

//Contains the pointer that points to the directory's contents 'stack.ptr',
//the size of 'stack.ptr' which is 'stack.size', and the current index
//'stack.index'
struct stack
{
  int index;
  char *ptr;
  int size;
};struct stack stack;

//Sets the index to 0 and allocates 256 bytes of memory for 'stack.ptr'
stack.index = 0; stack.size = 256;
stack.ptr = malloc(sizeof(char)*stack.size);

if(NEW_INDEX > stack.size)
{
  char *temp; stack.size *= 2;
  temp = realloc(stack.ptr, sizeof(char)*stack.size);
  if (temp == NULL)
  {
    printf("ERROR: %i Bytes of memory could not be allocated.\n", stack.size);
    free(stack.ptr); closedir(dirp); return '\000';
  }
  else {stack.ptr = temp;}
} 
```

该程序运行良好，直到我将“stack.size”（这是数组大小）的初始值设置为 2 而不是 256（以便程序必须重新分配内存）。我的程序崩溃了，因为 realloc() 返回 NULL 但我有足够的可用内存。我知道 realloc() 确实工作了几次，因为“stack.size”在崩溃时为 16（每次重新分配内存时“stack.size”加倍）。我尝试将“stack.size”设置为几个不同的值，我发现将“stack.size”设置为 1 或 2 会导致崩溃，并且总是在“stack.size”达到 16 时发生。谁能向我解释一下? 我担心即使我将 'stack.size' 设置为 256，如果目录大到足以触发内存重新分配，我的程序可能会崩溃。同样在不相关的注释中，我读到了 openddir("."); 将打开当前目录，我发现它确实如此，但由于某种原因，当前目录中的所有文件并非都在 'stack.ptr' 和 . 当我将'stack.ptr'的内容输出到标准输出时，会显示和..。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:36:43.120

您没有向我们展示包含错误的行。它可能看起来像：

```
strcpy(stack.ptr+stack.index, ptr_dirent->d_Name); 
```

这里的问题是`strcpy()`复制`strlen() + 1`字节。您正在编写超出分配数组末尾的终止 NUL 字符。

# ruby-on-rails - 为 RSpec 和 Rails-API 设置 Content-Type 标头

> ID：13940840
> 
> 赞同：13
> 
> 时间：2012-12-18T20:20:22.980
> 
> 标签：ruby-on-rails, rspec, ruby-on-rails-3.2, rails-api

我正在使用[rails-api](https://github.com/rails-api/rails-api) gem 来构建 Web 服务，并希望使用 RSpec 测试我的 API。无论 HTTP 方法如何，我发出的每个请求都将`CONTENT_TYPE`标头设置为“application/x-www-form-urlencoded”。在我尝试在控制器中使用[wrap_parameters](http://api.rubyonrails.org/classes/ActionController/ParamsWrapper/ClassMethods.html#method-i-wrap_parameters)并且它对 params 哈希没有任何影响之前，这并不是真正的问题：

```
class ApplicationController < ActionController::API
  include ActionController::ParamsWrapper
end

class ProjectsController < ApplicationController
  wrap_parameters :project, include: [:name]
  # ...
end 
```

[这个 hack](https://stackoverflow.com/questions/4036748/specifying-content-type-in-rspec)不再有效（@request 为零），我发现的其他 Stack Overflow 帖子也没有工作。

如果我在我的 RSpec 测试中提出以下请求：

```
put "/projects/1.json", {name: 'Updated Project 1'} 
```

并在我的控制器中放置一个调试器，我得到：

```
(rdb:1) p params
    { "name"=>"Updated Project 1",
  "action"=>"update",
  "controller"=>"projects",
  "id"=>"5539bbd9-010c-4cfb-88d3-82dadbc99507",
  "format"=>"json"
}

(rdb:1) p request.content_type
"application/x-www-form-urlencoded" 
```

我期待在 params 哈希中看到类似这样的内容（注意添加了项目密钥）：

```
{ "name"=>"Updated Project 1",
  "action"=>"update",
  "controller"=>"projects",
  "id"=>"5539bbd9-010c-4cfb-88d3-82dadbc99507",
  "format"=>"json",
  "project" => {"name" => "Updated Project 1"}
} 
```

**是否可以仅使用 RSpec 设置内容类型标头？还是我必须为此功能使用机架/测试？**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-26T01:48:56.473

很多挫折和变化，这对我有用。 **导轨 3.2.12 Rspec 2.10**

```
 @request.env["HTTP_ACCEPT"] = "application/json"
 @request.env["CONTENT_TYPE"] = "application/json"
 put :update, :id => 1, "email" => "bing@test.com" 
```

wrap_parameters 似乎正在以这种方式声明

```
wrap_parameters User, format: :json 
```

用于`User`模型

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-22T20:06:45.180

This worked for me **Rails 4.0.3** and **Rspec 2.14.1** if anyone is looking for more recent versions.

```
put '/projects/1.json', {name: 'Updated Project 1'}, {
  'HTTP_ACCEPT' => 'application/json',
  'CONTENT_TYPE' => 'application/json'
} 
```

and

```
wrap_parameters Project, format: :json 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-09T22:23:23.510

使用新的 Rails v5.0.x API only 设置，我发现 Rails 将所有内容默认为的这个`"application/x-www-form-urlencoded"`问题对于使用 RSpec-Rails 请求进行测试仍然存在问题

这是我为解决问题所做的工作：

在以下位置创建支持文件`./spec/support/json_requests.rb`

将其编辑为类似这样以覆盖所有仅 API JSON 请求的行为：

```
module JsonRequests
  def get(*args)
    super(*json_args(*args))
  end

  def post(*args)
    super(*json_args(*args))
  end

  def update(*args)
    super(*json_args(*args))
  end

  def patch(*args)
    super(*json_args(*args))
  end

  def put(*args)
    super(*json_args(*args))
  end

  def delete(*args)
    super(*json_args(*args))
  end

  def json_args(path, params = {}, headers = {})
    [path, params.to_json, headers.merge('CONTENT_TYPE' => 'application/json')]
  end
end

RSpec.configure do |config|
  config.include JsonRequests, type: :request
end 
```

请记住，这将覆盖其中的所有规范，`./spec/requests`因此如果您需要使用`"application/x-www-form-urlencoded"`，您也可以`include`根据需要在`Describe 'something' do`块中手动使用此模块。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-04-02T15:37:22.580

Rails 5没有黑客：

```
put(:update,
    params: {project_id: 1},
    body: {name: 'Updated Project 1'}.to_json,
    as: :json) 
```

这设置`content_type`正确。在控制器`params`中将同时保存参数和正文。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-03-23T04:09:27.133

它的 2021 年，Rails 6.1，我不得不用它`as: :json`来修复参数中哈希数组的这种奇怪的修改。

```
put(:update, params: the_params_hash, as: :json) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-16T19:08:11.117

如果您使用的是 Rails 4（和 rspec ~3.7）并且不想使用内联语法：

```
request.headers["CONTENT_TYPE"] = "application/json" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-25T09:05:14.110

导轨 5

```
headers = { 'CONTENT_TYPE' => 'application/json' }
params = { user_type: 'tester' } 
```

在那个请求之后

```
post '/api/v1/users/test', params.to_json, headers 
```

并`.to_json`从请求路线中删除

# java - println 的非静态替换

> ID：13940842
> 
> 赞同：2
> 
> 时间：2012-12-18T20:20:32.873
> 
> 标签：java, static, non-static

简单的问题是我可以使用其他函数来代替 println，因为我想将非静态变量输出到文件 usig out.println();

这是我的代码：

```
import java.io.*;

public class main {

String outputString ="Math.sqrt(25);" ;
static String outputPath ="src/output.txt";
/**
 * @param args
 */
public static void main(String[] args) throws IOException {
    File f;
    f= new File (outputPath);
        //file creation
        if(!f.exists()){
            f.createNewFile();
            System.out.println("File has been created");
        }else{
            f.delete();
            System.out.println("1\. File has been deleted");
            f.createNewFile();
            System.out.println("2\. File has been created");
        }
        //adding string(text) to file
        try{
            FileWriter outFile = new FileWriter(args[0]);
            PrintWriter out = new PrintWriter(outFile);

            out.println(outputString);
            out.close();

        }catch(IOException e){
                 e.printStackTrace();
            }
    }

} 
```

如果那是不可能的，也许还有另一种方法可以绕过它。我的主要问题是我想在代码中创建一个字符串。但这似乎很难做到:)对此有任何帮助:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T20:23:41.047

问题与`println()`. 这与以下事实有关，即 non-`static`与您的类的*实例*`outputString`相关联，并且您的代码不会创建此类实例。

 *要么制作`outputString`静态，要么创建一个实例`main`：

```
public void doit(String[] args) throws IOException {
    ...
    PrintWriter out = ...;
    out.println(outputString);
    ...
}

public static void main(String[] args) throws IOException {
    new main().doit(args);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:28:01.567

该`println`函数可以打印静态和非静态变量。问题是您试图`outputString`从静态上下文（您的`main`方法）中访问非静态变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:52:58.990

`println`是类的非静态方法`PrintStream`。，也是一个类，有一个名为类型`System`的静态*成员*，您可以通过调用检索该成员。该成员在 java 启动时被初始化。`out``PrintStream``System.out`

请注意，这绝不意味着这不是`Object`type的常规，`PrintStream`只是它是一个单例，可以方便地从 System.*

# javascript - 从现有的获取 subGrid 数据

> ID：13940843
> 
> 赞同：0
> 
> 时间：2012-12-18T20:20:38.240
> 
> 标签：javascript, jquery, json, jqgrid, subgrid

我是 jquery 新手，特别没有使用 jqGrid 及其子网格的经验。

我有简单的网格工作，但我真的需要一个子网格。我在网格中显示“联系人”，每个联系人都有相关的“操作”。我需要“动作”出现在子网格中。

以下是返回视图的 json，它具有“联系人”和关联的“操作”。“Contact”对象有一个“Action”对象列表。

```
{
 "total" : "10",
 "page" : "1",
 "records" : "78",
 "rows" : [ {
   "comment" : null,
   "givenName" : "Contact A",
   "familyName" : "A",
   "actionSet" : [ {
      "actionID" : 1,
      "actionDueDate" : "2012-12-08",
      "actionNote" : "Action 1"
     }, {
      "actionID" : 2,
      "actionDueDate" : "2012-12-08",
      "actionNote" : "Action 2"
   } ],
   "contactID" : 1,
   "streetName" : null,
   "city" : null,
   "streetAddress" : null,
   "postalCode" : null
}    ...] 
```

}

Grid 有一个 url 可以获取 JSON，这很好。

```
jq("#grid").jqGrid({
url:'/getrecords.do',
datatype: 'json',
mtype: 'GET', 
```

我感到困惑的地方是如何从现有的 JSON 中获取 subGrid 的数据（因为与每个“联系人”关联的“动作”在 json 中返回），而不是像..

```
subGridRowExpanded: function(subgrid_id, row_id) { 
 var subgrid_table_id, pager_id; 
 subgrid_table_id = subgrid_id+"_t"; 
 pager_id = "p_"+subgrid_table_id; 
 $("#"+subgrid_id).html("<table id='"+subgrid_table_id+"' class='scroll'></table><div id='"+pager_id+"' class='scroll'></div>"); 
 jQuery("#"+subgrid_table_id).jqGrid({ 
        url:"/getrecords.do"+row_id, 
        datatype: "xml", 
```

任何帮助将不胜感激。

关于阿多福。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:39:37.323

在对 jqGrid 的调用中，您需要传递选项“subGrid: true”以及带有不适当参数的“subGridModel”选项来进行映射。

```
jq("#grid").jqGrid({
    url:'/getrecords.do',
    datatype: 'json',
    mtype: 'GET',
    subGrid: true,
    subGridModel: {
        // Your Mapping Here
    }
.
.
. 
```

取自这里：[http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:subgrid](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:subgrid)

# wordpress - mod_rewrite 与身份验证冲突

> ID：13940844
> 
> 赞同：0
> 
> 时间：2012-12-18T20:20:46.637
> 
> 标签：wordpress, apache, .htaccess

我是托管许多站点的服务器管理员。其中之一是运行 wordpress。如果通过 cPanel 密码保护 wp-admin/，当浏览到 site0.com/wp-admin 时，它会陷入重定向循环。

我发现这种行为是因为 wp-admin 重定向到`wp-login.php`如果未登录并且如果受密码保护，`.htaccess`wp-admin 中的身份验证规则以某种方式与全局（在 public_html 中）中的重写规则冲突，`.htaccess`因此重定向无限。然后，如果我评论 rewriterule(s)，登录就会出现，但是 WordPress 的内页不再起作用。

public_html/.htaccess：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.php$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.php [L]
</IfModule> 
```

public_html/wp-admin/.htaccess：

```
AuthUserFile "/home/paraf/.htpasswds/public_html/wp-admin/passwd"
AuthName "wp-admin"

<Files admin-ajax.php>
  Order allow,deny
  Allow from all
  Satisfy any 
</Files>

AuthType Basic
require valid-user 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T11:18:10.717

我认为通过 htaccess 保护 wp-admin 是不必要的，所以也许你正在解决不存在的问题。您仍然可以直接访问 wp-login.php。

# sql - 不同时区的营业时间

> ID：13940850
> 
> 赞同：1
> 
> 时间：2012-12-18T20:21:10.003
> 
> 标签：sql, c#-4.0, sql-server-2008-r2, timezone

我在这里发布了一个类似的问题：[https ://stackoverflow.com/questions/13923598/department-hours-of-operation-for-different-time-zones-in-sql-server](https://stackoverflow.com/questions/13923598/department-hours-of-operation-for-different-time-zones-in-sql-server)

我想我在帖子中添加了太多信息:)

我想做的是显示不同时区的营业时间。我很难弄清楚如何在其他时区显示周一至周五：上午 630 点至下午 630 点（UTC -07:00 亚利桑那州）之类的内容。我会到达一个点（在另一个时区），星期一不再是星期一......我似乎无法弄清楚如何识别变化。

如何将日期列表（星期一、星期二等）和时间转换为每隔一个时区并找到要使用的正确日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:22:36.263

时区都是相对的。澳大利亚东部标准时间为 UTC+10，东部夏令时间为 UTC+11。美国东部标准时间是 UTC-5，东部夏令时间是 UTC-4。从 09:00 2012 年 12 月 21 日澳大利亚 EDT 到美国东部标准时间很简单`DATEADD(h, -16, '09:00 21 Dec 2012')`。唯一真正的诀窍是知道每个区域的夏令时何时开始和停止，以及它适用于哪些司法管辖区（例如，昆士兰州没有实行夏令时）。

时区的谷歌搜索将为您提供确定它们相对于世界时 (UTC) 所处位置所需的信息。

System.Globilization 命名空间拥有您可能需要的一切。datetime 类也有很多方法。

# html - 为网站创建横幅 [网页设计/CSS]

> ID：13940855
> 
> 赞同：0
> 
> 时间：2012-12-18T20:21:27.930
> 
> 标签：html, css, web, photoshop

我一直在试图弄清楚标准方法是什么，或者什么可以被认为是“良好的 Web 开发标准”，但是网站通常如何实现他们的横幅？

例如，我知道您可以使用 CSS 为其创建背景，并将图像和文本放置在 CSS 背景之上以创建横幅，但假设您想要放置一个周围有空白区域的徽标。您将如何摆脱空白以匹配背景 CSS？这是否需要额外的软件，还是人们通常使用 CSS hack 来解决这个问题？

或者对于另一种方法，您可以使用 Photoshop 设计整个横幅并调整图像大小，使其与网站的标题相匹配。

通过横幅，我的意思是网站顶部的导航栏，例如 [http://www.springsource.org/](http://www.springsource.org/)

Web 开发人员使用什么方法，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:59:10.940

这是一个太笼统的问题，无法得到一个好的、全面的答案，但我要做的是首先考虑标记，而不是关注网站的外观。（请注意，您链接到的网站根本不遵循这种方法）。

### HTML

```
<h1 class="title">Spring Source Community</h1>
<ul class="navigation">
  <li><a href="/features">Features</a></li>
  <li><a href="/get_started">Get Started</a></li>
  <li><a href="/get_involved">Get Involved</a></li>
  <li><a href="/news">News & Events</a></li>
  <li><a href="/subscribe">Subscribe</a></li>
</ul> 
```

这为您提供了一个非常简单的标题，然后是链接的项目符号列表。虽然这可能与您在页面上看到的外观不一样，但*实际上*它包含相同的内容并且功能相同。它也很容易被搜索引擎和屏幕阅读器理解。

然后，您将使用[图像替换技术](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)将文本与图片交换。

# iphone - Objective-C：单词到 NSNumber

> ID：13940858
> 
> 赞同：4
> 
> 时间：2012-12-18T20:21:37.113
> 
> 标签：iphone, objective-c, ios

我想将单词转换为 数字`Ninety Nine to 99` `Second to 2nd`等`Two to 2`

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T20:38:35.640

Apple 没有用于这种目的的 API。即使只是针对一种语言，词典分析也很困难。将数字表示为单词可能相对简单，但从单词到数字需要处理许多特殊情况。

蛮力方法是拥有一个包含所有各种可能组合的数据库。一种更聪明的方法可能会分析单个单词并推理出这可能意味着什么数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:27:19.550

~~你正在寻找这个，[NSNumberFormatterStyle](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSNumberFormatterStyle)。它有一个选项为`NSNumberFormatterSpellOutStyle`.~~

根据苹果文档，

> **NSNumberFormatterSpellOutStyle：**指定拼写格式；例如，“23”变成“二十三”。

 ~~看起来您想**从 Word 转换为 Number 而不是 Number 到 Word**。我误读了你的问题。

您可能必须手动执行此操作，因为 Apple 没有可用的 API。你可以检查[NSNumberFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html)看看你是否能找到一些有用的东西。

正如 jlehr 提到的，`NSLog(@"%@", [formatter numberFromString:@"one hundred forty-three"]);`将给出数字`143`。但它可能不是一个适用于所有可能组合的完美解决方案。~~

# c# - 如何使 BitmapImage 一次性

> ID：13940868
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:22:14.267
> 
> 标签：c#, .net-4.5, windows-store

我需要`BitmapImage`在`using`语句中使用 a ，这怎么做？

```
using (BitmapImage bitmap = new BitmapImage())
{
    ... 
```

我猜测这样做的方法是扩展，`IDisposable`但我以前从未这样做过。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:27:58.693

实现的原因`IDisposable`是当您不再需要引用该对象时释放该对象中的非托管资源。您不需要包装`BitmapImage`并实现，`IDisposable`因为没有任何与`BitmapImage`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:26:23.150

你不能这样做。`BitmapImage`是密封的，所以你不能从中获得。此外，我不知道您为什么要`IDisposable`在 .NET Framework 类中实现。您最多可以做一个包装类，其中包含您的`BitmapImage`, 和实现`IDisposable`.

例子：

```
class DisposableBitmapImageWrapper : IDisposable
{
    public BitmapImage Bitmap { get; private set; }

    public DisposableBitmapImageWrapper(BitmapImage bitmap)
    {
        Bitmap = bitmap;
    }

    public void Dispose()
    {
        //Do something with the BitmapImage
    }
} 
```

# c# - 如何让用户域创建主体上下文 asp.net

> ID：13940870
> 
> 赞同：0
> 
> 时间：2012-12-18T20:22:21.840
> 
> 标签：c#, dns, principalcontext

使用 .Net 4.0 创建 PrincipalContext 的代码行是：

```
PrincipalContext context = new PrincipalContext(ContextType.Domain, "domain"); 
```

不久前，我看到一个代码片段，您不必指定域名，而是使用系统或 httpcontext 变量来传递域名。它类似于 user.logondomain 但我再也找不到它了。它没有从 user.identity.name 中剥离域。

这是在 ASP.NET Web 应用程序中使用 Windows 身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:31:34.740

这应该有效：

```
string domain = "defaultDomain";
string[] splittedAuth = Request.ServerVariables["LOGON_USER"].Split('\\');
domain = (splittedAuth.Count() > 1) ? splittedAuth[0] : domain;
PrincipalContext context = new PrincipalContext(ContextType.Domain, domain); 
```

如果您指的是[Environment.UserDomainName 属性](http://msdn.microsoft.com/en-us/library/system.environment.userdomainname.aspx)，这绝对**不是**您需要的，因为它将返回执行代码的帐户的域，这不是 ASP.NET 的场景。

# node.js - 如何追踪导致超时的原因？

> ID：13940871
> 
> 赞同：7
> 
> 时间：2012-12-18T20:22:22.613
> 
> 标签：node.js, coffeescript, mocha.js

我正在使用 Mocha 运行许多测试。当我进行一组特定的测试时：

```
describe "Results Summaries", ->
    before (done) ->
        Testing.use("surveyplanet_test")
        Testing.initialUsers -> Testing.clearResultData ->
            done()

    beforeEach (done) ->
        Testing.redis.flushdb -> done()

    describe "Multiple Choice", ->

        describe "Standard Choice Selection", ->
            before (done) ->
                Testing.clearResultData ->
                    Testing.loadQuestion "standardMC", ->
                        Testing.loadExportData
                            data: summarydata.standardMC
                            onComplete: done

            describe "Pre-Summarization", ->
                before (done) ->
                    answer_data = {}
                    Testing.getMultipleTables
                        tables: ["answers_main"]
                        onComplete: (data) ->
                            answer_data = data
                            done() 
```

它抛出错误：

> 结果总结 1）“首先”钩子
> 
> ✖ 340 次测试中有 1 次失败：
> 
> 1) 结果摘要“首先”钩子：错误：对象超过 2000 毫秒的超时。(/usr/local/lib/node_modules/mocha/lib/runnable.js:142:14) 在 Timer.list.ontimeout (timers.js:101:19)

有什么方法可以获取引发错误的*代码段的堆栈跟踪吗？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T22:47:33.517

I'd try changing your reporter. I use

`mocha --compilers coffee:coffee-script *.coffee --ui bdd -d --watch -R Nyan` and get traces about 20 lines long when I have a failure.

Timeouts usually mean (I've never seen it otherwise) that your `done()` is not getting hit. I suspect one of these two:

`Testing.initialUsers -> Testing.clearResultData ->`

is not calling its callback.

# windows-phone-7 - SkyDrive API for Windows Phone 应用程序的登录问题

> ID：13940872
> 
> 赞同：1
> 
> 时间：2012-12-18T20:22:24.000
> 
> 标签：windows-phone-7, windows-phone, onedrive, live-sdk

我正在创建一个带有 SkyDrive 访问权限的 WP7 应用程序。我正在使用 SkyDrive API。当我尝试登录时，它显示“无效请求”错误。谁能告诉我我的代码有什么问题？

```
 private void login_Click()
    {
        LiveAuthClient auth = new LiveAuthClient("signInButton1.ClientId");
        auth.LoginCompleted +=
        new EventHandler<LoginCompletedEventArgs>(MoreScopes_LoginCompleted);
        auth.LoginAsync(new string[] { "wl.signin", "wl.basic", "wl.skydrive", "wl.skydrive_update " });
    }

    void MoreScopes_LoginCompleted(object sender, LoginCompletedEventArgs e)
    {

        if (e.Status == LiveConnectSessionStatus.Connected)
        {
            LiveConnectSession session = e.Session;
            LiveConnectClient client = new LiveConnectClient(session);
            infoTextBlock.Text = "Signed in.";
        }
        else if (e.Error != null)
        {
            infoTextBlock.Text = "Error signing in: " + e.Error.ToString();
        }
    }

    private void signInButton1_SessionChanged(object sender, Microsoft.Live.Controls.LiveConnectSessionChangedEventArgs e)
    {
        login_Click();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T07:45:24.597

```
检查这个：

    LiveAuthClient auth = new LiveAuthClient("signInButton1.ClientId");

它应该是：

    LiveAuthClient auth = new LiveAuthClient(signInButton1.ClientId);

```

# android - 如何捕捉新意图而不是旧意图？

> ID：13940874
> 
> 赞同：2
> 
> 时间：2012-12-18T20:22:26.180
> 
> 标签：android, android-intent

我将我的活动注册为 Intent 过滤器（明文），并且在接收多个 Intent 时遇到问题。这是我的情况：

1.  我打开电子邮件客户端->标记一些文本->按“共享按钮”并选择正确列出的我的活动（因为它已注册为此类操作的意图过滤器）
2.  我的活动打开，我可以清楚地看到意图在其 EXTRA_TEXT 中具有正确的值（来自电子邮件的标记文本）
3.  到目前为止一切顺利......但是现在，如果我按下 HOME 按钮（关闭我的 Activity 并似乎调用 onStop()）-> 然后我再次打开电子邮件客户端 -> 标记一些不同的文本 -> 按“共享按钮”，然后突然我的活动打开（我希望可以再次选择可用活动的列表）并且收到的意图包含原始文本，而不是其EXTRA_TEXT中新标记的文本。

我在这里想念什么？如何通过这种方式通过意图接收新内容？我是否需要以某种方式使以前的意图无效？

我不得不说使用“BACK”而不是“HOME”按钮可以正常工作，并且新意图包含预期的新标记文本。这里有什么区别？

我这样得到我的意图：

```
 intent = getIntent();
    intentAction = intent.getAction();
    if (intentAction.equals(Intent.ACTION_SEND) && intent.hasExtra(Intent.EXTRA_TEXT)) {
        Bundle bundle = intent.getExtras(); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:35:31.297

尝试将您的活动启动模式设置为“singleTop”，然后实施...

```
@Override
protected void onNewIntent (Intent intent) {
    ...
} 
```

传入该`Intent`方法的应该是新的。

请参阅[onNewIntent的文档](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)

**编辑：**对于未来的读者 - 根据下面的评论，似乎文档可能不正确，launchMode 应该是“singleTask”而不是“singleTop”。

# c# - 如何在 mousemove 事件中检查键盘键状态

> ID：13940875
> 
> 赞同：3
> 
> 时间：2012-12-18T20:22:38.373
> 
> 标签：c#, visual-studio, events

我希望能够使用空格键来修改鼠标按住时的行为。在不知道更好的情况下，我想象它涉及两个（或三个）事件处理程序之间的某种协调 - `mousemove`、`keydown`和`keyup`. 但我想知道是否有某种方法可以完全在一个事件处理程序中处理它 - `mousemove`.

示例代码让我了解我希望能够做什么......

```
 private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button == MouseButtons.Left)
            {
                if (Keyboard.KeyDown == Keys.Space)
                {
                    /* Do modified behavour for left mouse being held down while 
                    space is also held down */
                }
                else
                {
                    // Do normal behavour for left mouse being held down
                }

            }
        } 
```

这样的事情是否可能，或者我是否必须使用 keydown 事件处理程序将空格键的状态保存到类变量并使用鼠标移动处理程序进行检查？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T20:47:08.620

IT 可以使用 Control.ModifierKeys 和 Control.MouseButtons 来完成。但仅适用于 shift、ctrl 和 alt 等键。

```
 private void Form1_MouseMove(object sender, MouseEventArgs e)
    {

        if ((Control.ModifierKeys & Keys.Shift) != 0)
        {
            if ((Control.MouseButtons & MouseButtons.Left) != 0)
            { // here you go

            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:26:57.087

您应该在 KeyDown-Event 中设置一个变量并在 MouseEvent 中检查它：

```
bool buttonpressed = false;
private void KeyDown_Event(object s, System.Windows.Forms.KeyEventArgs e)
{
   if(e.KeyCode == KeyCode.Space)
      buttonpressed = true;
   else
      buttonpressed = false;
}

private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button == MouseButtons.Left)
            {
                if (buttonPressed)
                {
                    /* Do modified behavour for left mouse being held down while 
                    space is also held down */
                }
                else
                {
                    // Do normal behavour for left mouse being held down
                }

            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:30:15.907

我有一个变量来跟踪何时`Keys.Space`处于`Pressed`状态，然后用`KeyUp`和`KeyDown`事件触发它

```
 private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
      // Check if Key.Space pressed
      if(SpacePressed) {
           // Do something
      }
 }

 private void KeyPressed_Event(object sender, KeyEventArgs e) {
      // Check if Key.Space pressed
      if(e.Key == Key.Space) {
           SpacePressed = true;
      }
 }

 private void KeyRelease_Event(object sender, KeyEventArgs e) {
      // Check if Key.Space pressed
      if(e.Key == Key.Space) {
           SpacePressed = false;
      }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T21:41:10.060

您可以使用 PInvoke在 User32.dll中调用[GetKeyState 。](http://pinvoke.net/default.aspx/user32/GetKeyState.html)

# ruby-on-rails - Rails 在控制器中计算并设置字段值

> ID：13940882
> 
> 赞同：0
> 
> 时间：2012-12-18T20:23:12.667
> 
> 标签：ruby-on-rails

我有一个包含 start_at 和 ends_at 的事件表。它也有一个布尔值用于全天。

如果事件是全天，则用户输入一个名为小时的字段。但是，如果他们输入 start_at 和 ends_at，我想计算并保存在小时字段中。

英语（不是 Ruby）：

```
If event.allday = > true
  hours = ends_at - starts_at 
```

这样，我就不必在我拥有的所有不同显示页面中计算它，并且更容易求和。

或者——这个逻辑会进入模型吗？

谢谢！

更新 - - - - - -

我尝试将其放入模型中：

```
 before_save :calculate_hours

  def calculate_hours
    if self.allday != true
      self.hours = ((self.ends_at - self.starts_at)/ 3600).to_f.round(2)
    end
 end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:26:18.163

业务逻辑始终属于模型。

```
class Event < ActiveRecord::Base
  before_validation :set_hours

  private
    def set_hours
      if allday?
        self.hours = ends_at - starts_at
      end
    end
end 
```

# css - 如何将 CSS 引用添加到 .NET SyndicationFeed？

> ID：13940887
> 
> 赞同：4
> 
> 时间：2012-12-18T20:24:01.500
> 
> 标签：css, xslt, rss, atom-feed, syndication-feed

我创建了一个包含许多 SyndicationItems 的简单 SyndicationFeed。每个 SyndicationItem 都有 HtmlContent。HtmlContent 是一个表格。这显示正常，但现在我需要在桌子上进行最少的样式/填充。我相信我需要添加一个样式表参考，例如

```
<?xml-stylesheet type="text/css" href="http://you.com/rss.css" ?> 
```

但我看不到如何使用 .NET 4.5 SyndicationFeed 或 Atom10FeedFormatter 类来做到这一点。

这是由 WCF 服务生成的（伪）代码。

```
var feed = new feed(......);
var xqn = new XmlQualifiedName( "mysys" , "http://www.w3.org/2000/xmlns/" );
feed.AttributeExtensions.Add( xqn , myuri );
feed.ElementExtensions.Add( "creator" , "sys" , teaminfo );
feed.Authors.Add( new SyndicationPerson( emailaddr) );
feed.Categories.Add( new SyndicationCategory( mycategory ) );
feed.Description = new TextSyndicationContent( feedDesc );
feed.Copyright = SyndicationContent.CreatePlaintextContent(copyr);
feed.Language = "en-us";
feed.ImageUrl = new Uri( myuri + "/logo" );
var dbitems = GetListFromDb(key);
var syndItems = new List<synitem>();
foreach (var item in dbitems)
{
    var htmlContent =
        SyndicationContent.CreateHtmlContent( MakeHtmlFromStuff(item) );
    var itemUri = new Uri( myuri + itemuri );
    var synitem = new synitem( item.code , htmlContent , itemUri , item.key , DateTimeOffset.UtcNow );
    syndItems.Add( synitem);
}
feed.Items = syndItems;
return new Atom10FeedFormatter(feed); 
```

希望不要遗漏一些明显的东西。所有想法都表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:55:04.273

> 我相信我需要添加一个样式表参考，例如
> 
> ```
> <?xml-stylesheet type="text/css" href="http://you.com/rss.css" ?> 
> ```
> 
> 但我看不到如何使用 .NET 4.5 SyndicationFeed 或 Atom10FeedFormatter 类来做到这一点。

**这是一个完整的代码示例如何执行此操作：**

```
using System;
using System.Collections.Generic;
using System.ServiceModel.Syndication;
using System.Xml;

namespace FeedProcessing
{
    class FeedProcessing
    {
        static void Main(string[] args)
        {
            FeedProcessing fp = new FeedProcessing();
            fp.CreateFeed();
        }
        public void CreateFeed()
        {
            SyndicationFeed feed = new SyndicationFeed("Feed Title", "Feed Description", new Uri("http://Feed/Alternate/Link"), "FeedID", DateTime.Now);
            // Add a custom attribute.
            XmlQualifiedName xqName = new XmlQualifiedName("CustomAttribute");
            feed.AttributeExtensions.Add(xqName, "Value");

            SyndicationPerson sp = new SyndicationPerson("jesper@contoso.com", "Jesper Aaberg", "http://Jesper/Aaberg");
            feed.Authors.Add(sp);

            SyndicationCategory category = new SyndicationCategory("FeedCategory", "CategoryScheme", "CategoryLabel");
            feed.Categories.Add(category);

            feed.Contributors.Add(new SyndicationPerson("lene@contoso.com", "Lene Aaling", "http://lene/aaling"));
            feed.Copyright = new TextSyndicationContent("Copyright 2007");
            feed.Description = new TextSyndicationContent("This is a sample feed");

            // Add a custom element.
            XmlDocument doc = new XmlDocument();
            XmlElement feedElement = doc.CreateElement("CustomElement");
            feedElement.InnerText = "Some text";
            feed.ElementExtensions.Add(feedElement);

            feed.Generator = "Sample Code";
            feed.Id = "FeedID";
            feed.ImageUrl = new Uri("http://server/image.jpg");

            TextSyndicationContent textContent = new TextSyndicationContent("Some text content");
            SyndicationItem item = new SyndicationItem("Item Title", textContent, new Uri("http://server/items"), "ItemID", DateTime.Now);

            List<SyndicationItem> items = new List<SyndicationItem>();
            items.Add(item);
            feed.Items = items;

            feed.Language = "en-us";
            feed.LastUpdatedTime = DateTime.Now;

            SyndicationLink link = new SyndicationLink(new Uri("http://server/link"), "alternate", "Link Title", "text/html", 1000);
            feed.Links.Add(link);

            XmlWriter atomWriter = XmlWriter.Create("atom.xml");
            atomWriter.WriteProcessingInstruction("xml-stylesheet", 
                                                  "type='text/css' href='http://you.com/rss.css'");
            Atom10FeedFormatter atomFormatter = new Atom10FeedFormatter(feed);
            atomFormatter.WriteTo(atomWriter);
            atomWriter.Close();

            XmlWriter rssWriter = XmlWriter.Create("rss.xml");
            rssWriter.WriteProcessingInstruction("xml-stylesheet",
                                                 "type='text/css' href='http://you.com/rss.css'");
            Rss20FeedFormatter rssFormatter = new Rss20FeedFormatter(feed);
            rssFormatter.WriteTo(rssWriter);
            rssWriter.Close();
        }
    }
} 
```

**执行此程序时，会创建两个文件**：

*原子.xml*：

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/css' href='http://you.com/rss.css'?>
<feed xml:lang="en-us" CustomAttribute="Value" xmlns="http://www.w3.org/2005/Atom">
    <title type="text">Feed Title</title>
    <subtitle type="text">This is a sample feed</subtitle>
    <id>FeedID</id>
    <rights type="text">Copyright 2007</rights>
    <updated>2012-12-28T19:50:18-08:00</updated>
    <category term="FeedCategory" label="CategoryLabel" scheme="CategoryScheme" />
    <logo>http://server/image.jpg</logo>
    <author>
        <name>Jesper Aaberg</name>
        <uri>http://Jesper/Aaberg</uri>
        <email>jesper@contoso.com</email>
    </author>
    <contributor>
        <name>Lene Aaling</name>
        <uri>http://lene/aaling</uri>
        <email>lene@contoso.com</email>
    </contributor>
    <generator>Sample Code</generator>
    <link rel="alternate" href="http://feed/Alternate/Link" />
    <link rel="alternate" type="text/html" title="Link Title" length="1000" href="http://server/link" />
    <CustomElement xmlns="">Some text</CustomElement>
    <entry>
        <id>ItemID</id>
        <title type="text">Item Title</title>
        <updated>2012-12-28T19:50:18-08:00</updated>
        <link rel="alternate" href="http://server/items" />
        <content type="text">Some text content</content>
    </entry>
</feed> 
```

和*rss.xml*：

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/css' href='http://you.com/rss.css'?>
<rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0">
    <channel CustomAttribute="Value">
        <title>Feed Title</title>
        <link>http://feed/Alternate/Link</link>
        <description>This is a sample feed</description>
        <language>en-us</language>
        <copyright>Copyright 2007</copyright>
        <managingEditor>jesper@contoso.com</managingEditor>
        <lastBuildDate>Fri, 28 Dec 2012 19:50:18 -0800</lastBuildDate>
        <category domain="CategoryScheme">FeedCategory</category>
        <generator>Sample Code</generator>
        <a10:contributor>
            <a10:name>Lene Aaling</a10:name>
            <a10:uri>http://lene/aaling</a10:uri>
            <a10:email>lene@contoso.com</a10:email>
        </a10:contributor>
        <image>
            <url>http://server/image.jpg</url>
            <title>Feed Title</title>
            <link>http://feed/Alternate/Link</link>
        </image>
        <a10:id>FeedID</a10:id>
        <a10:link rel="alternate" type="text/html" title="Link Title" length="1000" href="http://server/link" />
        <CustomElement>Some text</CustomElement>
        <item>
            <guid isPermaLink="false">ItemID</guid>
            <link>http://server/items</link>
            <title>Item Title</title>
            <description>Some text content</description>
            <a10:updated>2012-12-28T19:50:18-08:00</a10:updated>
        </item>
    </channel>
</rss> 
```

**说明**：

每当[**`XmlWriter`**](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)创建实例时，但在调用之前：

```
atomFormatter.WriteTo(atomWriter); 
```

或者：

```
rssFormatter.WriteTo(rssWriter); 
```

**[`WriteProcessingInstruction()`](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.writeprocessinginstruction.aspx)**在相应的 XmlWriter 实例上调用该方法，将两个必需参数传递给它——PI 的名称（在本例中`"xml-stylesheet"`）和 PI 的文本（在本例中`"type='text/css' href='http://you.com/rss.css'"`）。

# android - 安卓 | AddTextChangedListener 与单选按钮

> ID：13940889
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:24:10.360
> 
> 标签：android, radio-button, android-edittext, converter

我正在尝试将添加文本更改侦听器添加到我的代码中，因此当我编辑文本时，它会自动将货币转换为选定的单选按钮（美元、欧元），而无需按下其中一个单选按钮使其显示在文本视图中回答。

我不知道该怎么做我是新的编程在谷歌搜索没有找到答案

```
package com.gardana.superh;

public class ConvertActivity extends Activity {
TextView mResult;
EditText mToConvert;
RadioGroup mRadioGroup;
RadioButton mDollar, Meuro;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_convert);

    mResult = (TextView) findViewById(R.id.result);
    mToConvert = (EditText) findViewById(R.id.toConvert);
    mRadioGroup = (RadioGroup) findViewById(R.id.radioG);
    mDollar = (RadioButton) findViewById(R.id.dollar);
    Meuro = (RadioButton) findViewById(R.id.euro);

    mRadioGroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener()
    {
        public void onCheckedChanged(RadioGroup mradRadioGroup, int checkedId)
        {

            switch (checkedId)
            {

            case R.id.dollar:
            Double dollarConvert = Double.valueOf(mToConvert.getText().toString()); //convert the string to int
            double price = dollarConvert * 3.76;
            mDollar.setChecked(true);
            Meuro.setChecked(false);
            mResult.setText("$"+price);

            break;

            case R.id.euro:

                Double euroConvert = Double.valueOf(mToConvert.getText().toString()); //convert the string to int
                double value = euroConvert * 5;
                mDollar.setChecked(false);
                Meuro.setChecked(true);

                mResult.setText("€" + value);
                Meuro.setChecked(false);

                break;

                default:;
            }
        }
    });

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:23:14.047

我建议您分解代码以使其更容易执行。首先，您需要添加两个侦听器，以便在需要时执行转换。

```
mToConvert.addTextChangedListener(new TextWatcher() {

    @Override
    public void afterTextChanged(Editable s) {
        convertCurrentAmount();
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {                
    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {                
    }

});
mRadioGroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
    public void onCheckedChanged(RadioGroup mradRadioGroup, int checkedId)
    {
        convertCurrentAmount();
    }
}); 
```

因为你基本上要在两个地方做同样的工作，我建议你创建一个为你执行计算的方法。然后，只要您想更新转换，就可以调用它。

```
 public void convertCurrentAmount() {
        int exchangeRate = -1;
        String exchangeSymbol;
        switch (mRadioGroup.getCheckedRadioButtonId()) {
            case R.id.dollar:
                exchangeRate = 3.76;
                exchangeSymbol = "$";
                break;

            case R.id.euro:
                exchangeRate = 5;
                exchangeSymbol = "€";
                break;
        }

        if (exchangeRate > 0 && exchangeSymbol != null) {
            // Perform Calculation
        }
    } 
```

我还在上面提供了一个关于如何重新设计开关/案例以减少代码重复的建议，因为重复编写相同的东西是没有意义的。

# scala - 在scala中减去两个数组的最快方法是什么

> ID：13940892
> 
> 赞同：7
> 
> 时间：2012-12-18T20:24:18.393
> 
> 标签：scala, micro-optimization, scala-2.9

我有两个数组（我已经从矩阵中提取出来（Array[Array[Int]]），我需要从另一个中减去一个。

目前我正在使用这种方法，但是，当我分析它时，它是瓶颈。

```
def subRows(a: Array[Int], b: Array[Int], sizeHint: Int): Array[Int] = {
   val l: Array[Int] = new Array(sizeHint)
   var i = 0
   while (i < sizeHint) {
     l(i) = a(i) - b(i)
     i += 1
   }
   l
 } 
```

我需要这样做数十亿次，所以速度的任何改进都是一个加分项。

我曾尝试使用 a`List`而不是 an`Array`来收集差异，它要快得多，但是当我将它转换回`Array`.

我确实修改了下游代码以`List`查看是否有帮助，但我需要无序访问列表的内容，因此再次失去任何收益。

似乎将一种类型转换为另一种类型都很昂贵，我想知道是否有某种方法可以更快地使用地图等。

有没有更好的办法？

* * *

## 编辑

不知道我第一次做了什么！？

所以我用来测试它的代码是这样的：

```
def subRowsArray(a: Array[Int], b: Array[Int], sizeHint: Int): Array[Int] = {
  val l: Array[Int] = new Array(sizeHint)
  var i = 0
  while (i < sizeHint) {
    l(i) = a(i) - b(i)
    i += 1
  }
  l
}

def subRowsList(a: Array[Int], b: Array[Int], sizeHint: Int): List[Int] = {
  var l: List[Int] = Nil
  var i = 0
  while (i < sizeHint) {
    l = a(i) - b(i) :: l
    i += 1
  }
  l
}

val a = Array.fill(100, 100)(scala.util.Random.nextInt(2))
val loops = 30000 * 10000

def runArray = for (i <- 1 to loops) subRowsArray(a(scala.util.Random.nextInt(100)), a(scala.util.Random.nextInt(100)), 100)

def runList = for (i <- 1 to loops) subRowsList(a(scala.util.Random.nextInt(100)), a(scala.util.Random.nextInt(100)), 100)

def optTimer(f: => Unit) = {
  val s = System.currentTimeMillis
  f
  System.currentTimeMillis - s
} 
```

我认为我第一次这样做时得到的结果完全相反......我一定是误读或混淆了方法。

我很抱歉问了一个不好的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T22:23:52.557

该代码是您可以使用标准 JVM 管理单线程的最快代码。如果您认为`List`更快，那么您要么在自欺欺人，要么实际上没有告诉我们您在做什么。将 an`Int`放入`List`需要创建两个对象：一个创建列表元素，另一个将整数装箱。对象创建的时间大约是数组访问时间的 10 倍。因此，以任何其他方式来做这件事真的不是一个成功的提议。

如果你真的，真的需要更快，并且必须保持单线程，你可能应该切换到 C++ 或类似的，并明确使用 SSE 指令。例如，请参阅[这个问题](https://stackoverflow.com/questions/5008831)。

如果你真的，真的需要更快并且可以使用多个线程，那么最简单的方法就是打包一大块这样的工作（即需要减去的合理数量的向量对 - 可能至少几百万每个块的元素）放入一个列表中，只要你机器上的处理器数量，然后调用`list.par.map(yourSubtractionRoutineThatActsOnTheChunkOfWork)`.

最后，如果你可以具有破坏性，

```
a(i) -= b(i) 
```

在内循环中当然更快。同样，如果您可以重用空间（例如使用`System.arraycopy`），那么您比必须继续分配空间要好。但这会改变您所显示的界面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T03:02:20.350

您可以使用[Scalameter](http://axel22.github.com/scalameter/)对至少需要运行 JRE 7 update 4 和 Scala 2.10 的两个实现进行基准测试。我使用了 scala 2.10 RC2。

用 编译`scalac -cp scalameter_2.10-0.2.jar RangeBenchmark.scala`。

运行`scala -cp scalameter_2.10-0.2.jar:. RangeBenchmark`。

这是我使用的代码：

```
import org.scalameter.api._

object RangeBenchmark extends PerformanceTest.Microbenchmark {
  val limit = 100
  val a = new Array[Int](limit)
  val b = new Array[Int](limit)
  val array: Array[Int] = new Array(limit)
  var list: List[Int] = Nil
  val ranges = for {
    size <- Gen.single("size")(limit)
  } yield 0 until size

  measure method "subRowsArray" in {
    using(ranges) curve("Range") in {
      var i = 0
      while (i < limit) {
        array(i) = a(i) - b(i)
        i += 1
      }
      r => array
    }
  }

  measure method "subRowsList" in {
    using(ranges) curve("Range") in {
      var i = 0
      while (i < limit) {
        list = a(i) - b(i) :: list
        i += 1
      }
      r => list
    }
  }
} 
```

结果如下：

```
::Benchmark subRowsArray::
Parameters(size -> 100): 8.26E-4

::Benchmark subRowsList::
Parameters(size -> 100): 7.94E-4 
```

你可以得出你自己的结论。:)

堆栈因更大的值而爆炸`limit`。我猜这是因为它多次测量性能。

# objective-c - 不了解 UIActivityIndi catorView 如何与 NSTimer 一起使用

> ID：13940894
> 
> 赞同：0
> 
> 时间：2012-12-18T20:24:22.817
> 
> 标签：objective-c, ios, uiwebview, nstimer, uiactivityindicatorview

我错过了一些关于如何`UIActivityIndicatorView`一起`NSTimer`工作的东西。

我`UIActivityIndicatorView`在 Interface Builder 中添加了这个，设置如下：

![UIActivityIndi​​catorView](../Images/be59f4b62ac9f7c034cf588a3f254679.png) ![UIActivityIndi​​catorView 设置](../Images/2b3eacd000026c776d433e680abb7da8.png)

被`UIWebView`实例化为`self.webV`和`UIActivityIndicatorView`as `self.indicator`。

我在实现文件中有以下代码：

```
-(void)viewDidLoad
{
    [super viewDidLoad];

    //Create UIWebView.
    if (!self.webV)
    {
        self.webV = [[UIWebView alloc] init];
}
    self.webV.delegate = self;

//Load web page.

    NSString *baseURLString = @"myURL.com";
    NSString *urlString = [baseURLString stringByAppendingPathComponent:@"myURL.com"];

    self.timer = [NSTimer scheduledTimerWithTimeInterval:1.0/2.0 target:self selector:@selector(timerLoad) userInfo:nil repeats:YES];

    [self connectWithURL:urlString andBaseURLString:baseURLString];
}

-(void)timerLoad
{
    if (!self.webV.loading)
    {
        [self.indicator stopAnimating];
    }
    else
    {
        [self.indicator startAnimating];
    }
} 
```

但是当`UIWebView`加载时，没有活动指示器出现。我做错了什么或遗漏了什么？

谢谢你们的帮助，伙计们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:08:11.863

如果您反复调用它的启动/停止，我真的不确定它的行为`UIActivityIndicatorView`应该是什么。我有理由确定它不应该那样使用:)

因此，即使您的问题是特定于`NSTimer`and`UIActivityIndicatorView`的，了解您应该以不同的方式处理您的解决方案可能会有所帮助。

您应该使用 webview 委托方法来切换打开和关闭`[self.indicator startAnimating]`，而不是使用每半秒重复调用一次的计时器。`UIActivityIndicatorView`

```
 -(void)viewDidLoad
        {
            [super viewDidLoad];

            //Create UIWebView.
            if (!self.webV)
            {
                self.webV = [[UIWebView alloc] init];
            }
            self.webV.delegate = self;

        //Load web page.

            NSString *baseURLString = @"myURL.com";
            NSString *urlString = [baseURLString stringByAppendingPathComponent:@"myURL.com"];

            //self.timer = [NSTimer scheduledTimerWithTimeInterval:1.0/2.0 target:self selector:@selector(timerLoad) userInfo:nil repeats:YES];

            [self connectWithURL:urlString andBaseURLString:baseURLString];
        }

- (void)webViewDidStartLoad:(UIWebView *)webView{
      //start animating
      [self.indicator startAnimating];
 }

- (void)webViewDidFinishLoad:(UIWebView *)webView{
         //stop animating
         [self.indicator stopAnimating];
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:09:35.000

可能有几个原因。它可能加载得如此之快以至于加载已经完成，或者它根本没有加载，因为 URL 有问题。

这不是您的问题的原因，但您永远不会使您的计时器无效，您应该这样做。

我还打算指出你应该使用委托方法而不是计时器，但是 pdriegen 打败了我。

# javascript - 从 iframe 到父窗口打开颜色框（组图像）

> ID：13940897
> 
> 赞同：0
> 
> 时间：2012-12-18T20:24:35.200
> 
> 标签：javascript, iframe, colorbox

我计划在 iframe 环境中使用 Colorbox (http://www.jacklmoore.com/colorbox)，如何从 iframe 中启动查看器？

下面的链接适用于 iframe 内容/youtube，但我想使用群组图片。所以它可以点击下一个/上一个图像。 [http://blog.svnlabs.com/open-colorbox-from-iframe-to-parent-window/](http://blog.svnlabs.com/open-colorbox-from-iframe-to-parent-window/)

无论如何都可以解决这个问题吗？

# vb.net - Linq 按错误分组

> ID：13940898
> 
> 赞同：1
> 
> 时间：2012-12-18T20:24:37.293
> 
> 标签：vb.net, linq

我在这里做错了什么？

我定义了以下对象：

```
Public Class MyClass
    Public Var1 As String
    Public StartDate As Date
    Public EndDate As Date
End Class 
```

在我的主子中，我有：

```
Dim x as New List(Of MyClass) 
```

现在，我想对它进行分组，以便所有组都具有匹配的开始日期和结束日期的信息。我认为应该这样做：

```
From Req In x
Group Req By strtdt = Req.StartDate, enddt = Req.EndDate Into grp
Select ... 
```

现在，我尝试了几种不同的方式，每次都会得到不同的错误：

* * *

1)

```
From Req In x
Group Req By strtdt = Req.StartDate, enddt = Req.EndDate Into grp
Select ... 
```

错误：`Definition of method 'grp' is not accessible in this context`（grp() 下划线）

* * *

2)

```
From Req In x
Group Req By New With {strtdt = Req.StartDate, enddt = Req.EndDate} Into grp
Select ... 
```

错误：（`Type or 'With' expected`第一个大括号加下划线）

* * *

我究竟做错了什么？？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:48:28.257

像这样的东西应该可以工作：

```
 Dim y = From Req In x _
        Group Req By key = New With { .strtdt = Req.StartDate, .enddt = Req.EndDate } Into Group _
        Select Item = key, DateGroup = Group 
```

# javascript - 使用Javascript将多个数据从文本框中抓取到文本框中

> ID：13940901
> 
> 赞同：0
> 
> 时间：2012-12-18T20:24:45.320
> 
> 标签：javascript, dom-events

我的代码适用于文本框的单行输入。例如：`name:adam`

但我想要的是，在我将数据输入文本框时获取名称和类。像这样的东西：

例子：

```
name:adam   
class:8th grade 
```

* * *

```
<script>
function myFunction()
{
    var x = document.getElementById("tarea");
    document.getElementById("name").value = x.value.substring(5);
}
</script> 
```

在 HTML 部分，我有这个：

```
<textarea rows="4" cols="50" id="tarea" onblur="myFunction()"></textarea>

name: <input type="text" id="name"></br>
class: <input type="text" id="class"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:33:29.667

你应该根据换行符分割你的文本区域。就像是

```
function myFunction()
{

var x = document.getElementById("tarea"),
    nameInput = document.getElementById('name'),
    classInput = document.getElementById('class');

var lines = x.value.split('\n');
var name = lines[0].substring(5);
var grade = lines[1].substring(6);

nameInput.value = name;
classInput.value = grade;   

} 
```

小提琴：http: [//jsfiddle.net/MVWAD/](http://jsfiddle.net/MVWAD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:53:37.280

假设 name 总是在文本框的第一行，class 总是在第二行：

```
function myFunction(){
   var x=document.getElementById("tarea").value;
   var values = x.split("\n");
   document.getElementById('name').value = values[0].substr(5,values[0].length);
   document.getElementById('class').value = values[1].substr(6,values[1].length);
} 
```

# php - Wordpress：在 wp_nav_menu 中将自定义 ID 添加到 ul

> ID：13940914
> 
> 赞同：2
> 
> 时间：2012-12-18T20:25:29.050
> 
> 标签：php, wordpress

我正在尝试更改 wp_nav_menu 以输出 html，如下例所示。

```
<div class="menu">
<ul id="menu"> 
```

原始输出

```
<div class="menu">
<ul> 
```

我不能用 jQuery 或 javascript 来做，它必须是 php 代码

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:39:37.747

[`wp_nav_menu`](http://codex.wordpress.org/Function_Reference/wp_nav_menu)接受`menu_id`其选项数组中的键。将其设置为您想要的 ID，例如：

```
wp_nav_menu(array(
    'menu_id' => 'menu'
)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T17:47:00.353

您可以通过定义在 html 中显式设置 id `items_wrap`，并确保`walker`未设置为某些自定义函数：

```
wp_nav_menu( array(
    'theme_location' => 'main-menu'
    'items_wrap'     => '<ul id="menu" class="%2$s">%3$s</ul>',
    'walker'         => '',
)); 
```

这是不完整的信息；第一次尝试使用：

```
'fallback_cb'     => false, 
```

如果您的菜单没有出现，这意味着您还没有创建任何菜单，这意味着它采用后备功能会照顾到这一点。

所以先去创建一个菜单。:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:38:16.067

给 ul 一个与其容器的类相同的 id 是自找麻烦，但这应该可行：

```
<?php

function showMenu(){
$args = array(
  'menu_id' => 'menu'
);

wp_nav_menu($args);

}

showMenu();
?> 
```

WordPress Codex 有一个页面详细介绍了 wp_nav_menu() 函数的所有选项：http: [//codex.wordpress.org/Function_Reference/wp_nav_menu](http://codex.wordpress.org/Function_Reference/wp_nav_menu)

# ember.js - 无法弄清楚视图渲染（它们在 /body 之前添加）

> ID：13940927
> 
> 赞同：1
> 
> 时间：2012-12-18T20:27:02.440
> 
> 标签：ember.js

首先我很抱歉：我对 ember.js 很陌生，到目前为止还很挣扎。

我编写了一个非常基本的应用程序，并且一直将其用作主要指南：[http ://trek.github.com/](http://trek.github.com/)

我现在最大的问题是弄清楚如何处理视图，特别是渲染的 HTML 以及它在 DOM 中的出现位置。看来，至少在我目前的应用程序中，DOM 元素被创建并插入到页面中，但就在 /body 之前。因此，所有内容都加载在我的主要网站设计的页脚下方。

脚本模板的位置与页面相关的位置似乎无关紧要，或者类似的东西？

有没有办法将视图呈现到现有的容器 div 或其他东西？我想错了吗？我习惯使用 jsRender 来设置模板，但它们通常呈现为内存中的字符串，然后我需要将其插入到现有容器中，例如 $('#containerDiv').html(myRenderedHtmlFromATemplate);

感谢您对此的任何帮助或指导！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:40:49.763

Ember 将希望其视图在 DOM 中是分层的，因此它可以依赖事件传播。您可能注意到`<div class="ember-application">`注入了一个，然后您的所有视图都在其中呈现。

您可以在创建应用程序时指定[rootElement 。](http://emberjs.com/api/classes/Ember.Application.html#property_rootElement)应用程序将在该元素内创建，而 DOM 的其余部分保持不变。如果您不指定，则 Ember 将在您观察到`rootElement`的之前插入自身。`</body>`

例子：

```
window.MyApp = Ember.Application.create({
  rootElement: "#containerDiv"
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T15:32:49.040

tuxedo25 有最好的解决方案。如果您正在使用`StateManager`，您还可以使用以下内容：

```
App.StateManager = Ember.StateManager.create({
    rootElement: '.content',
    initialState: 'initial',
    initial: Ember.ViewState.create({
        route: 'initial',
        view: Ember.View.create({ templateName: 'initial' })
    })
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:56:05.223

如果没有看到代码，并不完全清楚到底发生了什么，但是，我没有看到你提到任何关于网点的事情，所以我认为这可能是你的问题。

在网点上查看此网址：http: [//emberjs.com/guides/outlets/](http://emberjs.com/guides/outlets/)

# asp.net - 如何在服务器启动时使用配置设置自动启动 WCF Windows 服务

> ID：13940928
> 
> 赞同：2
> 
> 时间：2012-12-18T20:27:03.797
> 
> 标签：asp.net, wcf, windows-services, app-config

我正在寻找使用配置文件中的任何设置自动启动 WCF Windows 服务的解决方案。提前感谢您的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:32:59.107

在配置文件中添加一个条目不会使任何程序自动启动。与服务本身或任何程序不同的其他东西需要检查配置文件中的值并确定是否应该启动服务。

或者，您可以将服务配置为始终自动启动，如果配置文件中存在某个值，则继续运行，否则自行关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:37:35.373

使用配置文件不会解决您的问题。相反，您应该使用 InstallUtil 命令将 WCF Windows 服务安装为 Windows 服务。然后，您可以在 services.msc 中将您的服务标记为自动启动一项

# c# - 什么时候返回延迟的 IEnumerable 是不好的形式

> ID：13940930
> 
> 赞同：12
> 
> 时间：2012-12-18T20:27:12.970
> 
> 标签：c#, .net, linq

我很好奇是否有人有任何经验法则或最佳实践，什么时候返回延迟或在从函数返回之前`IEnumerable<T>`调用它是有意义的。`ToArray()`

例如，作为 API 的使用者，我认为我更喜欢在调用它时`IEnumerable<Widget> GetWidgets()`抛出一个方法`HttpException`，而不是在我枚举结果时抛出它。

```
public IEnumerable<Widget> GetWidgets(IEnumarable<int> widgetIds) {
    return widgetIds.Select(id => GetWidgetFromWidgetWebService(id));
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T20:32:38.740

`IEnumerable<T>`当延迟没有明显的副作用时，我总是更喜欢返回延迟。例如，如果可枚举基于可能会更改的内部集合，我宁愿先评估它。

但是，如果正在计算可枚举等，那么我通常会推迟它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:41:49.163

如果实际上可以预期您的可枚举对象会抛出，请热切地评估它（如果可能的话）。您不希望错误发生在与错误原因无关的远程位置。您希望错误出现在它发生的地方。

毕竟，该方法并没有完成它的名字所宣传的内容，所以它应该抛出。

在这种情况下，我通常将返回类型更改为`IList<T>`以记录它急切地执行。

# javascript - 选择页面后更改锚标记的 CSS - 单页网站

> ID：13940934
> 
> 赞同：0
> 
> 时间：2012-12-18T20:27:30.033
> 
> 标签：javascript, jquery, html, css

我有一个单页网站，分为 5 个页面（部分），每个部分填满屏幕，当用户单击导航时，它会平滑地向下滚动到该部分。

选择该页面后，我无法弄清楚如何在上部导航中为锚元素加下划线。我只是希望它提醒用户他们在哪个页面上，即使用户使用滚动条导航到该部分，我也需要它进行更改。

页面的每个部分都有一个从导航链接的 id。如果每个部分都是它自己的页面，但当它是一个单页站点时，我知道如何做到这一点。

请问有jQuery插件或纯CSS方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:38:45.220

jQuery 将是你最好的选择。当用户滚动页面时，这将自动更改导航元素。如果每个部分具有相同的高度，则此方法效果最佳，但可以稍作更改以使用多个部分高度。可能需要稍作改动才能完全适合您的网站。

```
//activates every time user scrolls
$(window).scroll(function () {

    //gets the current scroll height
    scroll = $(document).scrollTop()

    //gets section height -- this is where the editing will have to be done if
    //each section is a different height
    H = $('.section_class_name').height()

    //get the number of sections down
    place = (scroll) / H;
    place = Math.floor(place) - 1;

    if($(document).scrollTop() >= H) {
        //all other nav items have no background
        $('#menu_ul li').css('background', '');

        //the corresponding nav element has this background
        $('#menu_ul li').eq(place).css({'background':'#505080','border-radius':'9px'});
    }
}) 
```

# oauth - 如何使用 Consumer Key/Secret 从 WSO2 获取 OAuth 令牌？

> ID：13940936
> 
> 赞同：1
> 
> 时间：2012-12-18T20:27:44.610
> 
> 标签：oauth, wso2

我对 WSO2 非常陌生，并且仍在评估它——主要是通过 Fiddler。据我了解，我应该能够通过调用 WSO2 的登录 API 来获取 OAuth 令牌。我尝试了各种 URL（在 Fiddler 中）：

// 基于博客文章： http: [//lalajisureshika.blogspot.com/2012/11/generate-application-tokens-user-tokens.html](http://lalajisureshika.blogspot.com/2012/11/generate-application-tokens-user-tokens.html)

```
http://localhost:8280/login?grant_type=password&username=admin&password=admin&scope=PRODUCTION
Authorization: Basic cFNET0lab1RnMHRBODRCWmQ4bTRBbnp1c0RZYTpZREIzZzh3RXhQOV92ZTdZX1drYVhieWx5ZlVh 
```

当我执行上述 URL 时，我收到**(403) No matching resource found in API for the given request**。

我可以使用“访问令牌”（通过 Bearer 标签）并且 API 工作。我只是不知道如何获取 OAuth 令牌以供实际运行时使用。

任何指针/想法？

--- 谢谢，杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-28T14:08:40.443

1.  设置身份服务器 [ `domain:9443`]
2.  创建 OAuth2 应用，并获取客户端 ID + 消费者密钥
3.  获取 clientId:consumerKey 的 Base64 编码 - 将其替换为 Authorization Basic xxxxx
4.  替换 REST 端点以生成令牌 - 您应该在管理控制台上的 oauth 应用程序中获取此信息 [在我们的案例中`https://domain:9443/oauth2/token`]

而下面的 curl 命令应该会给你响应

```
curl -k -d "grant_type=password&username=sasikumar@domain.com&password=xxxx1234" -H "Authorization" -H "Authorization: Basic X2dhWllidkN6TDNQY2ZqSmVBQ1lsNlg2SFdRYTpSQVlSMmxOZzQ0enU5ZXVGSDRDVXdOUWRudlVh, Content-type=application/x-www-form-urlencoded"  https://domain:9443/oauth2/token 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T10:39:23.353

您可以直接访问 OAuth2 REST Web 服务来访问令牌。这是使用 curl 访问令牌的方法

```
curl --user ConsumerKey:ConsumerSecret  -k -d "grant_type=password&username=admin&password=admin" -H "Content-Type:application/x-www-form-urlencoded" https://localhost:9443/oauth2endpoints/token 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T13:45:42.727

设置身份服务器 [domain:9443] 创建 OAuth2 应用程序，并获取客户端 ID、消费者密钥和 url。

使用带有以下详细信息的“海报”处理发布请求，

URL :- 从 oauth 应用程序获取

内容类型：- application/x-www-form-urlencoded

正文：- grant_type=password&username=你的用户名&password=你的密码&client_id=你的客户端ID&client_secret=你的客户端密码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-12T10:09:57.287

下面是一个默认使用 linux 中可用的 cURL 工具的示例（您可以为 windows 显式安装 cURL）

curl -v 4 -X POST -H "Content-Type: application/x-www-form-urlencoded;charset=UTF-8" -k -d "grant_type=password&username=**&密码=**&client_id=**&client_secret=**" https://**:9443/oauth2/令牌**********

 ******要获取 client_secret 和 client_id，您必须在 wso2is 中注册一个应用程序。

有免费工具可用于构造上述请求或直接使用上述参数并获取令牌。******

# vb.net - 如何将 IBM 数据库格式化为命令提示符窗口，使其可读（对人类而言）？

> ID：13940937
> 
> 赞同：1
> 
> 时间：2012-12-18T20:27:53.703
> 
> 标签：vb.net

好的，这是我的代码：

```
Imports IBM.Data.DB2.iSeries

Module ConsoleData1
Sub Main()

    'program identifier (to verify that you're using the right module)
    Console.WriteLine("ConsoleData1.vb")

    'create the connection object to the IBM i
    Using cn As New iDB2Connection("DataSource=xxxxxxxxxxxxx")
        Try
            cn.Open()
        Catch ex As iDB2Exception
            Console.WriteLine("An error occurred on cn.Open()")
            Exit Sub
        End Try

        'create a command object, initialize to valid SQL statement
        Using cmd As New iDB2Command("select * from testlib.finishk", cn)

            'create a command object, initialize to valid SQL statement
            Console.Write("Enter the Color Code!==>")
            Dim baldue = Console.ReadLine()

            Dim sql As String = "Select * from testlib.finishk where FINCOD >=" & FINCOD

            Using cmdx As New iDB2Command(sql, cn)
            End Using

            'create a data reader object, fill by executing the command
            Try
                Using dr As iDB2DataReader = cmd.ExecuteReader

                    'display data in a table
                    Console.Write("FINCOD" & vbTab)
                    Console.Write("FINDES" & vbTab)

                    While dr.Read()
                        Console.Write("{0}{1}", dr("FINCOD"), vbTab)
                        Console.Write("{0}{1}", dr("FINDES"), vbTab)
                    End While
                End Using

            Catch ex As iDB2Exception
                Console.WriteLine("An error occurred on cmd.ExecuteReader()")
                Exit Sub
            End Try
        End Using
    End Using
    Console.WriteLine("Press ENTER to end")
    Console.ReadLine()
End Sub

Sub HandleError(ByVal errorOccurred As String, ByVal ex As iDB2Exception)

    Console.WriteLine(errorOccurred)
    Console.WriteLine("Source: {0}", ex.Source)
    Console.WriteLine("SQLState: {0}", ex.SqlState)
    Console.WriteLine("Message: {0}", ex.Message)
    Console.WriteLine("MessageCode: {0}", ex.MessageCode)
    Console.WriteLine("MessageDetails: {0}", ex.MessageDetails)
    Console.ReadLine()
End Sub

Private Function Screen() As Object
    Throw New NotImplementedException
End Function

End Module 
```

现在，我将如何做到这一点，以便我可以将 cmd 窗口调整为更大并且仍然保持表结构的完整性？如果我调整 cmd 窗口的大小，它最终看起来就像有人只是将值随机放置到一个窗口中。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:48:20.160

您需要两件事：每条记录之间的换行符和格式字符串中的长度信息（拍摄固定宽度的列）。

```
'You can play the -30 numbers here to get different spacing, based on the nature of your data
Dim recordFormat As String = "{0,-30} {1,-30}"

Console.WriteLine(recordFormat, "FINCOD","FINDES")
While dr.Read()
    Console.WriteLine(recordFormat, dr("FINCOD"), dr("FINDES"))
End While 
```

最后，我对 DB2 不熟悉，但请告诉我有没有比字符串连接更好的方法来将用户的 FINDCOD 值添加到 sql 语句中？你正在做的事情非常不安全，令人无法原谅。如果我将文本`0;DROP TABLE testlib.finishk;--`放入您的系统而不是 FINDCOD 会怎样？任何理智的代码都会为此使用参数化查询。

# objective-c - GHUnit : 测试魔法记录代码

> ID：13940944
> 
> 赞同：1
> 
> 时间：2012-12-18T20:28:10.563
> 
> 标签：objective-c, tdd, restkit, magicalrecord, gh-unit

我想测试使用 MagicalRecord 框架的存储库。

我正在执行以下操作（来自这篇文章：[http](http://www.cimgf.com/2012/05/15/unit-testing-with-core-data/) ://www.cimgf.com/2012/05/15/unit-testing-with-core-data/ ）：

```
@interface OMSTests : GHTestCase
@end

@implementation OMSTests

- (void)setUp;
{
[MagicalRecord setDefaultModelFromClass:[self class]];
[MagicalRecord setupCoreDataStackWithInMemoryStore];

}

- (void)tearDown;
{
[MagicalRecord cleanUp];
}

-(void)testXXX {
    NSManagedObjectContext * context = [NSManagedObjectContext defaultContext];

    [context save]; // context is not set 0x000000000000 

    OMSPointsEventEntity * entity = [OMSPointsEventEntity createEntity];

}
@end 
```

创建实体时出现以下错误消息：

```
Name: NSInternalInconsistencyException
File: Unknown
Line: Unknown
Reason: [RKManagedObjectStore defaultObjectStore] cannot be nil 
```

任何人都可以帮助我找到为什么我没有实例化的上下文？我没有找到有关此问题的有用文档...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:36:38.427

看起来您正在尝试同时使用 RestKit 和 MagicalRecord。您可能希望单独设置 RestKit 的托管对象上下文和/或基于 MagicalRecord 提供的默认上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:19:31.927

Oups 我意识到#define MR_SHORTHAND（允许我调用 [context save] 而不是 [context MR_save]）不起作用，所以这是我的问题....

# javascript - Firefox 忽略选择的选项，总是在下拉列表中显示最后一项

> ID：13940946
> 
> 赞同：2
> 
> 时间：2012-12-18T20:28:19.227
> 
> 标签：javascript, jquery, firefox

因此，我编写了一些代码来对我网站的所有选择菜单进行排序，并且它在我们支持的所有浏览器中都能完美运行……除了 Firefox。

[http://jsfiddle.net/vkjAC/6/](http://jsfiddle.net/vkjAC/6/)

我的代码接受选择元素的选项，对它们进行排序并返回它们。在那里的某个地方，选择元素上的 selectedIndex 更改为最后一项。

我检查选择了哪些值/defaultSelected：

```
for(k=0; k<options.length; k++)
{
    if(options[k].defaultSelected == true)
    {
        sel = k;
        break;
    }
}
if(sel === null)
{
    for(k=0; k<options.length; k++)
    {
        if(options[k].selected == true)
        {
            sel = k;
            break;
        }
    }
}
if(sel === null)
    { options[0].selected = true; }
else
    { options[sel].selected = true; } 
```

但是我不能从这个函数中设置 selectedIndex 因为我没有传入整个选择对象，只是选项列表。

我尝试查找类似的问题，但我看到的每个其他线程都说这是一个缓存问题，或者我需要添加 autocomplete="off"，但这些都不起作用。我认为它与我的代码有关，但我没有在任何地方修改 selectedIndex 属性。

有什么建议么？我正在失去理智（而且时间不多了！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:40:33.533

我以前有过这个。这与删除选项然后再次添加的事实有关。您必须在排序后重新选择值。例如：

```
var ops = $('#mass').find('option');
$('#mass').prepend(sortDropDown(ops)).val($("#mass > option[selected]").val()); 
```

# php - 如何单击 php DomDocument 中的按钮？

> ID：13940950
> 
> 赞同：1
> 
> 时间：2012-12-18T20:28:22.487
> 
> 标签：php, dom

我需要单击使用 loadHTMLFile 加载的远程页面中的按钮，就像在 javascript 中一样。有可能的？就像是：

```
$domObject->getElementById('clickableButton')->click(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:32:56.960

当您在 DOM 中加载页面时，它只是一堆分成对象的字符串。所以答案是否定的——PHP 中的 DOM 无法解析和运行 javascript 代码。

但是，如果您尝试提交表单，您可以向表单元素的 action 属性中给出的 URL 发出 GET/POST 请求。尝试使用 cURL，或者只是`file_get_contents`可以做到这一点。

# php - 如何更改会话的值？

> ID：13940953
> 
> 赞同：0
> 
> 时间：2012-12-18T20:28:34.860
> 
> 标签：php, html, session, variables

我想知道如何更改会话键中的值。

我有两页：

第 1 页更改设置：

```
<?php       
session_start();

if (isset($_POST['one']) ){
    $_SESSION['pref_lang'] = 'one';
}
if (isset($_POST['two']) ){
    $_SESSION['pref_lang'] = 'two';
}
?> 
```

的HTML：

```
<form action="<?php echo $_SERVER['PHP_SELF']?>" method="post">     
    <input type="submit" id='one' name='one' value="one"/>
    <input type="submit" id='two' name='two' value="two"/>
</form> 
```

第 2 页将仅显示会话：

```
<?php
session_start();
print_r($_SESSION);
?> 
```

甚至三分之一来破坏会话。

问题是当我调用第一页来更改会话值时，它不会更改它。如果有人能说出这有什么问题，我真的很感激。

更新：

好吧，好像我在第 2 页做错了什么。当在第 1 页回显 print_r Session 时，我放置表单的那个页面 - 一切正常。但是当调用第 2 页时，它通常应该告诉我会话中的内容，它只会显示会话的内容。奇怪的是，我在调用第 3 页以销毁会话时，在第 1 页上会显示会话为空，但在第 2 页上它不会改变任何内容。即使我将更改第 1 页上的值，它也不会在第 2 页上更改它，但它会在第 1 页上显示更改？？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:33:51.653

表单将发布它们包含的所有字段。所以基本上你覆盖了会话。如果你要尝试这样的事情：

```
<form action="<?php echo $_SERVER['PHP_SELF']?>" method="post">     
    <input type="submit" id='one' name='one' value="one"/>
</form>

<form action="<?php echo $_SERVER['PHP_SELF']?>" method="post">     
    <input type="submit" id='two' name='two' value="two"/>
</form> 
```

您将看到您的第二个表单将如何覆盖会话变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:33:33.730

在您的表单中，您发送了两个值（$_POST['one'] 和 $_POST['two']）。

将其更改为我在下面的内容：

```
<form action="<?php echo $_SERVER['PHP_SELF']?>" method="post">     
    <input type="submit" id='one' name='one' value="one"/>
</form>    

<form action="<?php echo $_SERVER['PHP_SELF']?>" method="post">     
   <input type="submit" id='two' name='two' value="two"/>
</form> 
```

以上只是将表单分成两份，并单独发送值。考虑修改您的程序或使用单选按钮来辨别每个选择。 [http://www.w3schools.com/html/html_forms.asp](http://www.w3schools.com/html/html_forms.asp)

# c - Flex 给出“致命的扫描仪内部错误——缓冲区结束丢失”

> ID：13940954
> 
> 赞同：3
> 
> 时间：2012-12-18T20:28:37.293
> 
> 标签：c, bison, yacc, flex-lexer

我正在尝试对不断填充和重新填充的缓冲区使用 flex 。

我有多个线程使用它们自己独立的缓冲区副本。

在我的主程序中，它看起来像这样：

```
while(forever)
{
-fill buffer buf-
buf[length+1] = '\0';
buf[length+2] = '\0';
yy_scan_bytes(&buf, length+2);
yylex();
} 
```

其中多个线程正在运行该循环，并且都拥有它们的 buf 副本。

我的 lex 文件中有一条规则，如下所示：

```
<<EOF>> {yyterminate(); yy_delete_buffer(YY_CURRENT_BUFFER);} 
```

试图在缓冲区运行后进行清理。

我不确定我这样做是否正确，因为这是我第一次尝试将 flex 扫描仪与另一个程序结合使用。在 flex 中进行所有缓冲区处理，并将其与主程序中的 extern 声明链接起来会更好吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T22:48:23.827

问题是 flex 的默认扫描器不是可重入的——它将一堆信息（包括要读取的当前缓冲区）存储在全局变量中，所以如果你尝试让多个线程同时扫描东西，它们会遍地都是。

您需要使用`%option reentrant`创建一个可重入扫描器，然后`yyscan_t`为每个要使用的线程创建一个单独的扫描器，您使用它进行初始化，`yylex_init`然后将其作为额外参数传递给两者`yylex`和`yy_scan_bytes`。

此外，`yyterminate`扫描仪会立即返回，因此您`yy_delete_buffer`永远不会拨打电话。您需要在扫描仪返回后调用它：

```
yyscan_t local;
yylex_init(&local);
while(forever)
{
    -fill buffer buf-
    buf[length+1] = '\0';
    buf[length+2] = '\0';
    YY_BUUFER_STATE bs = yy_scan_bytes(&buf, length+2, local);
    yylex(local);
    yy_delete_buffer(bs, local);
} 
```

# ruby - 如何使用本机扩展重新打包 ruby gem

> ID：13940957
> 
> 赞同：5
> 
> 时间：2012-12-18T20:28:48.730
> 
> 标签：ruby, gem, package

我需要在没有安装任何开发工具的生产服务器上安装一些 ruby​​ gem（全部带有 C 扩展）。我想先在开发服务器上构建 gem，然后在生产服务器上重新打包并安装生成的本机 gem。

然而，似乎没有标准的方法来打包**带有本机扩展**的 gem 以进行重新分发。我知道 rake-compiler，但没有一个相关的 gem 可以开箱即用。具体来说，我正在使用 json-1.7.5、rb-inotify-0.8.8 和 ffi-1.2.1 gems。

任何有关如何执行此任务的指示或有关该主题的文档都将受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:05:14.810

使用 Jordan Sissel 的[fpm](https://github.com/jordansissel/fpm)，您可以获取各种输入档案（包括 gem）并将它们编译和打包为（以及其他）DEB 或 RPM。

将 json gem 编译成 deb 包[的示例如下：](https://github.com/jordansissel/fpm/wiki/ConvertingGems)

```
cd /tmp
fpm -s gem -t deb json 
```

这将下载最新版本的 json gem 并创建一个`rubygem-json-1.5.7-1.amd64.deb`存档`/tmp`，您可以在其中安装在您的服务器上。请注意，编译框和最终服务器需要完全相同。至少分布和位数、ruby 版本及其文件布局以及可用的可加载库应该是相同的。基本上，您的上游发行版处理的所有约束......

也就是说，从长远来看，我发现在目标服务器上安装编译器并在服务器上使用 rbenv 或 rvm 要容易得多。对于大多数中小型安装，它更容易处理，因为您不需要预编译并将所有内容发送到您的服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-12T23:18:02.723

嗨，您可以使用：gem-compiler

您需要告诉 RubyGems 您要编译的 gem 的文件名：

```
$ gem compile yajl-ruby-1.1.0.gem 
```

上面的命令将解压缩，编译找到的任何现有扩展并将所有内容重新打包为二进制 gem：

```
Unpacking gem: 'yajl-ruby-1.1.0' in temporary directory...
Building native extensions.  This could take a while...
Successfully built RubyGem
Name: yajl-ruby
Version: 1.1.0
File: yajl-ruby-1.1.0-x86-mingw32.gem 
```

它在这里有很好的文档： [https](https://github.com/luislavena/gem-compiler) ://github.com/luislavena/gem-compiler 。我正在使用它，我们也有自己的 gem 服务器。只是必须小心分发，因为在 wheezy 上编译的一些 gem 不适用于 jessie 等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:32:18.263

您将不得不在*几乎完全相同*的系统上构建它们才能正常工作。如果您要链接位于不同位置或版本略有不同的共享库，则它可能根本不起作用。有时你有一些松弛，它可以与一系列版本一起使用，但这不能保证。

由于这个原因，无法使用本机扩展进行打包，库的可能组合太多了。

您还需要确保使用相同的体系结构，包括需要的 32 位或 64 位。

有时您会很幸运，并且有一个适用于您的操作系统的软件包可以为您安装这些，但这些不适用于`rvm`or `rbenv`。

# ruby-on-rails-3 - 用于用户文件的 Rails 公共/系统

> ID：13940959
> 
> 赞同：3
> 
> 时间：2012-12-18T20:29:13.470
> 
> 标签：ruby-on-rails-3, dragonfly-gem

Rails gems **DragonFly**和**Paperclip**都使用 public/system 文件夹来存储上传的文件。

据我所知，每个人都可以访问这个文件夹——至少是根文件、404.html 或其他文件。

如何保护这些上传的文件？有没有可用的配置选项？

我需要处理从用户上传生成的转码视频文件，并通过一些权限检查使它们可用。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T09:35:35.870

不确定dragonfile，但您可以更改回形针文件上传选项。

您可以改用 Amazon S3 吗？

将以下内容添加到您的环境中：

```
config.paperclip_defaults = {
  :storage => :s3,
  :s3_credentials => {
    :bucket => ENV['AWS_BUCKET'],
    :access_key_id => ENV['AWS_ACCESS_KEY_ID'],
    :secret_access_key => ENV['AWS_SECRET_ACCESS_KEY']
  }
} 
```

通过将其添加到您的 gemfile 中，确保您已经安装了 s3 gem：

```
gem 'aws-sdk' 
```

这有帮助还是您需要将它们保留在您的服务器上进行处理？

- 编辑 -

显然，如果您不能使用 s3，heroku 建议使用临时文件。阅读这篇文章：

[如何将heroku上回形针的上传目录更改为/ tmp？](https://stackoverflow.com/questions/3136773/how-can-i-change-the-upload-directory-for-paperclip-on-heroku-to-tmp)

# sql - 在sql server子查询中使用if else

> ID：13940961
> 
> 赞同：0
> 
> 时间：2012-12-18T20:29:22.370
> 
> 标签：sql, sql-server

我不确定为什么以下子查询在 SQL Server 中不起作用，当我自己运行子查询时它工作得很好，但是只要我添加

```
Select * from ([subquery]) as table1 
```

查询没有运行，SQL Server 返回一个错误，说我在关键字“if”附近有不正确的语法，这里存在什么语法错误，否则它怎么会正常工作？

任何指针？

```
select * from (

    if datepart(MONTH, getdate()) >= MONTH('1/February/0000') 
    --after february we want the next years semesters, 

        begin
        select top 3 sem_name from semester_dates
         where datepart(year, start_date) < datepart(YEAR, getdate()) and sem_name not like 'summer%'
        end

    else 
        begin
        select top 3 sem_name from semester_dates  sd
        where datepart(year, start_date) >= datepart(YEAR, getdate()) and sem_name not like 'summer%' 
        end

    ) table1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:39:25.047

您可能需要考虑将 if/else 逻辑移动到表值函数中。可能是这样的。注意，我没有检查你的逻辑，我只是​​重新使用了这个。您可能需要相应地调整以下代码：

```
CREATE FUNCTION SemesterNames
(
  @ReferenceDate datetime
)
RETURNS @dates table 
(
  sem_name nvarchar(50) --check the data type
)
AS
BEGIN
  if datepart(MONTH, @ReferenceDate) >= MONTH('1/February/0000') 
    --after february we want the next years semesters, 
    INSERT INTO @dates (sem_name)
    select top 3 sem_name from semester_dates
     where datepart(year, start_date) > datepart(YEAR, @ReferenceDate) and sem_name not like 'summer%'
    end
else 
    INSERT INTO @dates (sem_name)
    select top 3 sem_name from semester_dates  sd
    where datepart(year, start_date) >= datepart(YEAR, @ReferenceDate) and sem_name not like 'summer%' 
END;
GO

SELECT * FROM SemesterNames(GETDATE()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:40:54.013

使用 CASE 而不是 IF 尝试以下操作。

```
SELECT *
FROM
(SELECT 
    CASE 
        WHEN datepart(MONTH, getdate()) >= MONTH('1/February/0000')
            THEN
                (SELECT TOP 3 sem_name 
                 FROM semester_dates
                 WHERE datepart(year, start_date) > datepart(YEAR, getdate()) and sem_name not like 'summer%')
        ELSE
                (SELECT TOP sem_name 
                FROM semester_dates
                WHERE datepart(year, start_date) >= datepart(YEAR, getdate()) and sem_name not like 'summer%')
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:49:21.690

据我所知，您的条件逻辑的唯一影响是 datepart(year, start_date) 严格大于或大于或等于。所以你可以用这样一个简单的查询来替换整个事情：

```
 select top 3 sem_name from semester_dates
    where datepart(year, start_date) >= datepart(YEAR, getdate()) 
    and sem_name not like 'summer%'
    and (
         datepart(MONTH, getdate()) > MONTH('1/February/0000') or 
         datepart(year, start_date) = datepart(YEAR, getdate()
    ) 
```

换句话说， start_date 的年份严格 > year(getdate()) 除非，如果月份 > 二月，那么年份可以等于它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T20:49:15.137

对于这个特定的查询，您能否在 WHERE 子句中使用带有 February 条件的单个 SELECT 来获得所需的结果？

```
SELECT TOP 3
    Sem_Name
FROM
    semester_dates
WHERE
    sem_name not like 'summer%'
    and 
    (
        (datepart(month, getdate()) >= 2 AND datepart(year, start_date) < datepart(YEAR, getdate()))
        OR
        (datepart(month, getdate()) < 2 AND datepart(year, start_date) >= datepart(YEAR, getdate()))
    ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T20:32:15.883

If/else 结构不应该在 Select 查询中起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-01T07:02:10.833

```
select * from
(select datepart(MONTH, getdate()) >= MONTH('1/February/0000'))
    as department,
(select top 3 sem_name from semester_dates
    where datepart(year, start_date) < datepart(YEAR, getdate()) 
        and sem_name not like 'summer%') 
    as sem_name,
(select top 3 sem_name from semester_dates sd
    where datepart(year, start_date) >= datepart(YEAR, getdate())
        and sem_name not like 'summer%') 
    as top 3 sem_name 
) table 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-05T07:43:12.377

CASE WHEN batch.PropertyId 为 NULL THEN (SELECT count( *) FROM vw_UtilMan_InspectionBatchAreaPropertyMeterStatistic WHERE BatchId = batch.Id) ELSE (SELECT COUNT(* ) AS NumberOfMeters FROM UtilMan_Properties prop INNER JOIN AssMan_Assets Meter ON Meter.UtilMan_PropertyId = prop.Id and Meter.IsDeleted = 0 WHERE prop.IsDeleted = 0 和 prop.Id = batch.PropertyId) END

# wpf - 为自定义属性 WPF 设置触发器

> ID：13940964
> 
> 赞同：0
> 
> 时间：2012-12-18T20:29:49.963
> 
> 标签：wpf, vb.net, wpf-controls

我创建了一个自定义按钮，上面有一个布尔标志来说明它是否被选中。如果它被选中，我想更改按钮的背景颜色，以让用户快速知道他们正在查看的控件。问题是我无法让触发器正常工作。我在这里看到的所有内容，我都尝试过，但在代码的 InitializeComponent 部分仍然出现错误。

这是我正在处理的属性

```
Private mIsSelected As Boolean = False
Public Property IsSelected() As Boolean
    Get
        Return mIsSelected
    End Get
    Set(ByVal value As Boolean)
        mIsSelected = value
    End Set
End Property

Public Shared ReadOnly MyBackgroundProperty As DependencyProperty = DependencyProperty.Register("MyBackground",
                                                                                                GetType(LinearGradientBrush), GetType(RentAdjButtons),
                                                                                                    New PropertyMetadata(New LinearGradientBrush(ColorConverter.ConvertFromString("#3366CC"), ColorConverter.ConvertFromString("#0000FF"), New System.Windows.Point(0.5, 0), New System.Windows.Point(0.5, 1))))

Private mMyBackground As New LinearGradientBrush
Public Property MyBackground() As LinearGradientBrush
    Get
        Return mMyBackground
    End Get
    Set(ByVal value As LinearGradientBrush)
        mMyBackground = value
    End Set
End Property 
```

这是我的 XMAL

```
 <Style TargetType="Com:RentAdjButtons">
            <Setter Property="MyBackground" Value="{StaticResource DefaultBackground}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="MyBackground" Value="{StaticResource SelectedButton}" />
                </Trigger>
            </Style.Triggers>
       </Style> 
```

目前我得到的错误是“触发时属性不能为空”

预先感谢您的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:10:09.290

您可以使用默认具有此属性的 ToggleButton。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:07:24.950

`Trigger.Property`必须是触发器`DependencyProperty`才能工作。有关文档，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.trigger.property.aspx)。您需要将您的类属性更改`IsSelected`为`DependencyProperty`.

此外，您的 MyBackground 的 getter/setter 应按照[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-3)中的文档使用`SetValue`和定义`GetValue`：

```
 Public Property State() As Boolean
      Get
          Return CType(Me.GetValue(StateProperty), Boolean)
      End Get
      Set(ByVal value As Boolean)
          Me.SetValue(StateProperty, value)
      End Set
    End Property
    Public Shared ReadOnly StateProperty As DependencyProperty = 
      DependencyProperty.Register("State", GetType(Boolean), GetType(MyStateControl),
      New PropertyMetadata(False)) 
```

# android - 结合 localbroadcastmanager sendorderedbroadcast 发送广播

> ID：13940970
> 
> 赞同：7
> 
> 时间：2012-12-18T20:30:28.910
> 
> 标签：android, service, broadcastreceiver, commonsware

我想实现 CommonsWare 在这篇博文中描述的内容：[http](http://commonsware.com/blog/2010/08/11/activity-notification-ordered-broadcast.html) ://commonsware.com/blog/2010/08/11/activity-notification-ordered-broadcast.html 。这篇文章很有意义，我可以在这里浏览示例源：[https](https://github.com/commonsguy/cw-advandroid/tree/master/Broadcast) ://github.com/commonsguy/cw-advandroid/tree/master/Broadcast 。

我很好奇的是`LocalBroadcastManager.getInstance(UnzipService.this).sendBroadcast(broadcast);`，服务内部的调用是否仍会被您在清单中定义的类型的广播接收器接收。

万一我问的不清楚，我想做的是使用 LocalBroadcastManager 因为来自我的服务的广播不一定需要在系统范围内看到，如果可能的话，我宁愿将它们保密，但如果用户关闭我的应用程序并且服务仍在运行，我也想显示通知。有没有一种方法可以结合这两种功能而无需在服务内部发送两次广播？

（我不想做的）喜欢： `LocalBroadcastManager.getInstance(UnzipService.this).sendBroadcast(broadcast); sendOrderedBroadcast(broadcast);`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-18T20:38:55.903

> 我很好奇是否调用 LocalBroadcastManager.getInstance(UnzipService.this).sendBroadcast(broadcast); 服务内部仍然会被您在清单中定义的类型的广播接收器接收。

不，仅适用于在单例本身`LocalBroadcastManager`注册的接收器。`LocalBroadcastManager`而且，`LocalBroadcastManager`不支持有序广播，上次我查了一下。

> 我想做的是使用 LocalBroadcastManager 因为来自我的服务的广播不一定需要在系统范围内看到，如果可能的话我宁愿将它们保密

只要您没有`<intent-filter>`在`BroadcastReceiver`清单中使用 an ，因此使用显式`Intent`作为广播本身，您的广播只会被您自己和管理广播的操作系统的位看到。其他应用程序将无法监视它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-04T21:52:28.023

如果您只有 2 个可能处理您的广播的对象（在您的情况下是一个 Activity 和一个通知控制器），您可以仅使用 LocalBroadcastManager 实现有序广播的行为。

总体思路是：

1.  设置您的服务，以便在您想要显示结果时通过特定操作向您的 Activity 广播 Intent
2.  在您的 Activity 中创建一个处理您的服务结果 Intent 的 BroadcastReceiver，并使用步骤 1 中的操作在 LocalBroadcastManager 上使用 IntentFilter 注册它
3.  在您的服务中，当结果可用时，尝试使用 LocalBroadcastManager.getInstance(Context).sendBroadcast(Intent) 发送结果 Intent，此方法返回一个布尔值，指示广播是否已发送到至少一个接收器。如果此布尔值为 false，则表示您的 Activity 没有处理您的广播，您应该改为显示通知。

在您的服务中：

```
public UnzipService extends IntentService {

  public static final String ACTION_SHOWRESULT = UnzipService.class.getCanonicalName() + ".ACTION_SHOWRESULT";

  @Override
  protected void onHandleIntent(Intent intent) {
    Thread.sleep(500); // Do the hard work

    // Then try to notify the Activity about the results
    Intent activityIntent = new Intent(this, YourActivity.class);
    activityIntent.setAction(ACTION_SHOWRESULT);
    activityIntent.putExtra(SOME_KEY, SOME_RESULTVALUE); // Put the result into extras

    boolean broadcastEnqueued = LocalBroadcastManager.getInstance(this).sendBroadcast(activityIntent);

    if (!broadcastEnqueued) { // Fallback to notification!
      PendingIntent pendingIntent = PendingIntent.getActivity(this, (int) System.currentTimeMillis(), activityIntent, PendingIntent.FLAG_UPDATE_CURRENT);
      ((NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE))
        .notify(SOME_ID, new NotificationCompat.Builder(this)
          .setContentIntent(pendingIntent)
          .setTicker("results available")
          .setContentText("results")
          .build());
    }
  }
} 
```

在您的活动中：

```
public YourActivity extends Activity {
  private BroadcastReceiver resultReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
      processResult(intent); // Results Intent received through local broadcast
    }
  }
  private IntentFilter resultFilter = new IntentFilter(UnzipService.ACTION_SHOWRESULT);

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate();
    Intent intent = getIntent();
    if (UnzipService.ACTION_SHOWRESULT.equals(intent.getAction())) {
      // The Activity has been launched with a tap on the notification
      processResult(intent); // Results Intent contained in the notification PendingIntent
    }
  }

  @Override
  protected void onResume() {
    super.onResume();
    LocalBroadcastManager.getInstance(this)
      .registerReceiver(resultReceiver, resultFilter);
  }

  @Override
  protected void onPause() {
    LocalBroadcastManager.getInstance(this)
      .unregisterReceiver(resultReceiver);
    super.onPause();
  }

  private void processResult(Intent intent) {
    // Show the results from Intent extras
  }
} 
```

这应该是一个完整的工作示例。

我希望这对尝试使用支持库中的 LocalBroadcastManager 实现有序广播的人有所帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:44:40.040

我了解您希望实现以下目标：

“我有一个在后台发生的事件。如果活动在屏幕上，我想更新我的活动。否则，我想发出通知。” （@TheCommonsBlog）

您可以通过实现 ResultReceiver 来实现此行为。示例[Restful API 服务](https://stackoverflow.com/questions/3197335/restful-api-service/3197456#3197456)和 [http://itekblog.com/background-processing-with-intentservice-class/](http://itekblog.com/background-processing-with-intentservice-class/)

您基本上所做的是在您的 Activity 中实例化一个 ResultReceiver 并通过意图将其像 Parcelable 参数一样传递给服务。然后，每次您的服务更新 UI 时，服务都会验证 ResultReceiver 对象是否为 NULL。如果不为 NULL，则通过 onReceiveResult 接口更新 Ui。否则，您提出通知。当您的活动关闭时，请确保将服务上的 ResultReceiver 设置为 NULL。

希望能帮助到你。

PS：IMO，广播工作量太大，难以控制。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-18T21:10:00.000

使用 LocalBroadcastManager，广播变得易于使用。

如果后台发生事件，我不赞成更新 Activity。用户可能已经在 Activity 中执行其他操作。在我看来，通知就足够了；它始终可见并一直存在，直到用户将其关闭。Gmail 和 Gcal 是这样工作的；如果有新邮件进来，Gmail 不会更新当前屏幕。如果您想知道当用户已经在应用程序中时如何处理处理通知的任务流程，请参阅[Notifications](http://developer.android.com/guide/topics/ui/notifiers/notifications.html) API 指南以及 [Notifying The用户[2](http://developer.android.com/training/notify-user/index.html)培训班。

# matlab - LaTeX、XTickLabel 中的 Matlab 数字

> ID：13940973
> 
> 赞同：2
> 
> 时间：2012-12-18T20:30:56.767
> 
> 标签：matlab, latex

我想将我的图形包含在 LaTeX 文档中，但有以下问题。

1.  将数字打印为 EPS 不起作用。图被错误地裁剪。请看下图。

2.  如何使用句柄在循环中打印多个图形？

我的数据：

```
str=[...
    '15.12.2012 11:27'
    '15.12.2012 11:12'
    '15.12.2012 10:57'
    '15.12.2012 10:42'
    '14.12.2012 10:27'
    '14.12.2012 10:12'
    '14.12.2012 09:57'
    '14.12.2012 09:42'
    '14.12.2012 09:27'
    '14.12.2012 09:12'
    '14.12.2012 08:57'
    '13.12.2012 08:42'
    '13.12.2012 08:27'
    '13.12.2012 08:12'
    '13.12.2012 07:57'
    '13.12.2012 07:42'
    '13.12.2012 07:27'
    '12.12.2012 07:12'
    '12.12.2012 06:57'
    '12.12.2012 06:42'
    '12.12.2012 06:27'
    '12.12.2012 06:12'
    '11.12.2012 05:57'
    '11.12.2012 05:42'
    '10.12.2012 05:27'
    '10.12.2012 05:12'
    '10.12.2012 04:57'];

Col1=[...
0.9884753
1.670642
1.14455
1.0301446
0.99031037
1.0459388
0.97192177
0.8925
0.8985693
0.955
0.95103529
0.95203444
0.955
0.95970876
0.95929422
0.95578656
0.955
0.955
0.95342687
0.955
0.955
0.95930485
0.95530825
0.96452381
0.9675
0.98778061
1.3];
Col2=rand(27,1).*(Col1);
Col3=Col1+Col2;
% find first occurrence of dates
[y,m,d,h,mn] = datevec(str,'dd.mm.yyyy HH:MM');

dn = datenum(y,m,d);
[~,ind] = unique(dn,'first');
ind = sort(ind);
% plot it nicely
plot(Col1);
hold all
plot(Col2);
hold all
plot(Col3);
leg_h=legend('bus','Car', 'truck','Location','NorthEastOutside');
set(leg_h,'Interpreter','latex','fontsize',14)
xlabel('time $t$','Interpreter','latex','fontsize',12);
ylabel('speed $m$','Interpreter','latex','fontsize',12);
ax = gca;
dstr = cellstr(datestr(dn,'dd.mm.yyyy'));
set(ax, 'XTick',ind, 'XTickLabel',dstr(ind), 'Position',[0.1,0.15,0.8,0.75]);
ylim([-20 20]); 

% plot something...
print -deps epsFig 
```

乳胶代码：

```
\begin{figure}
\centering
\includegraphics[width=0.9\textwidth, angle=0]{epsFig.eps}
\caption{Insert caption}
\end{figure} 
```

![在此处输入图像描述](../Images/a6bd0cce78d20df24f627fd629aa77fe.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:15:37.743

1.  试试[datetick](http://www.mathworks.com/help/matlab/ref/datetick.html)。使用“keepticks”，我发现它对于日期时间图的效果要好得多。无论如何，这是 Matlab 方面，而不是 Latex 方面。
2.  我已经开始使用[export_fig](http://www.mathworks.com/matlabcentral/fileexchange/23629-exportfig)并取得了巨大的成功。
3.  创建一个图（不知道为什么代码部分不起作用）

    句柄=图；

    ..生成情节..

    export_fig（句柄，....）

# node.js - 我应该使用 process.nextTick

> ID：13940974
> 
> 赞同：3
> 
> 时间：2012-12-18T20:31:15.557
> 
> 标签：node.js, asynchronous

我试图弄清楚何时使用 process.nextTick。下面我使用异步库来控制我的代码流，并且想知道我是否应该在结束回调中调用 nextTick。

```
async.parallel([
    function (callback) {
        // do something
        callback(data);
    },
    function (callback) {
        // do something
        callback(data);        
    }
], 
// callback
function (data) {
    process.nextTick(function () {
        // do something
    });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:48:07.550

在不确切知道您的“做某事”是什么的情况下，我看不出您`nextTick`在这种情况下需要使用的任何理由。当您`nextTick`有理由将函数的执行推迟到事件循环的下一次迭代时使用。您可能想阅读[理解`process.nextTick`](http://howtonode.org/understanding-process-next-tick)以获取更多详细信息。

另外，请注意异步的`parallel`任务完成回调需要参数`err, data`，所以你应该这样做：

```
async.parallel([
    function (callback) {
        // do something
        callback(null, data);
    },
    function (callback) {
        // do something
        callback(null, data);        
    }
], 
// callback
function (err, data) {
    if (err) throw err;
    // do something
}); 
```

主要区别在于，如果其中一个并行任务返回错误（`callback`使用真实的第一个参数调用），则会立即调用最终回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-30T06:11:12.250

我的经验是，要让 for`async.parallel`和其他类似功能正常工作，您**需要**使所有任务绝对异步；我喜欢异步库，它是我对承诺等的第一选择，但如果你不强制任务异步，可能会出现一些奇怪的行为。

见这里： [https ://github.com/caolan/async#common-pitfalls-stackoverflow](https://github.com/caolan/async#common-pitfalls-stackoverflow)

所以应该是：

```
async.parallel([

function(cb){
   process.nextTick(function(){
          doSomePotentiallySyncThing(cb);
   });
},

function(cb){
   process.nextTick(function(){
          doSomePotentiallySyncThing(cb);
   });
},
function(cb){

     definitelyAsync(cb);  // if it's **definitely** async, then we don't need process.nextTick

}
], function complete(err, results){

    // we are in the final callback

}); 
```

我对此有 99% 的把握。

# javascript - 获取超链接的 ALT 属性的属性值

> ID：13940976
> 
> 赞同：5
> 
> 时间：2012-12-18T20:31:28.890
> 
> 标签：javascript, jquery

我的 a-tag（链接）包含 innerHTML，它是这样的图像：

```
.innerHTML = <img alt="hello world" src="/Content/Images/test.png"> 
```

如何`alt`使用 JQuery 获取属性的文本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T20:40:23.720

你真的不需要 jQuery。如果你有 a 元素，你可以这样做：

```
// lets call the anchor tag `link`
var alt = link.getElementsByTagName('img')[0].alt; // assuming a single image tag 
```

记住属性映射到属性（大多数），除非属性或属性发生更改，否则两者应该反映相同的数据（这有一些极端情况，但可以逐个处理）。

如果您确实需要该属性

```
var alt = link.getElementsByTagName('img')[0].getAttribute('alt'); 
```

最后一种情况是，如果您只有图像标签作为字符串。

```
var str = '<img alt="hello world" src="/Content/Images/test.png">';
var tmp = document.createElement('div');
tmp.innerHTML = str;
var alt = tmp.getElementsByTagName('img')[0].alt; 
```

如果您必须使用 jQuery（或者只是更喜欢它），那么 Alexander 和 Ashivard 提供的其他答案将起作用。

注意：我的答案是为了完整性和更多选项而提供的。我意识到 OP 要求 jQuery 解决方案而不是本机 js。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-18T20:34:57.357

成为`$a`你的`<a/>`元素。

使用 jQuery，您可以执行以下操作：

```
$("img", $a).first().attr("alt"); 
```

* * *

或者，使用纯 JavaScript：

```
var $img = $a.getElementsByTagName("img")[0];
console.log($img.alt); 
```

[**在这里**](http://jsfiddle.net/xnkjn/)看[](http://jsfiddle.net/xnkjn/)

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:33:48.140

用这个。

```
var altName=$('a img').attr('alt'); 
```**

# c# - 获取路径中的所有文件（递归）

> ID：13940980
> 
> 赞同：0
> 
> 时间：2012-12-18T20:31:42.643
> 
> 标签：c#

我写了一个方法，需要查找路径中的所有文件，并且我想使用递归来获取所有文件。这是我目前的方法：

```
public void doStart(DirectoryInfo dir, string filePattern)
        {
            try
            {
                foreach (FileInfo fileInfo in dir.GetFiles(filePattern))
                {
                    if (fileFound != null)
                    {
                        fileFound(fileInfo);
                    }
                }
            }
            catch (Exception)
            {

            }

            try
            {
                foreach (DirectoryInfo dirInfo in dir.GetDirectories())
                {
                    doStart(dirInfo, filePattern);
                }
            }
            catch (Exception)
            {

            }
        }

        public void Start(string path, string filePattern)
        {
            doStart(new DirectoryInfo(path), filePattern);
        } 
```

有没有更好的方法来编写这种递归还是足够好？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T20:36:49.973

尝试这样的事情：

```
string[] filePaths = Directory.GetFiles(@dir, "*.filetype", SearchOption.AllDirectories); 
```

这将递归地查看目录，查找具有特定文件类型（'.filetype'）的所有文件并返回包含所有找到的文件的字符串数组。

另外，我建议不要使用空的 catch 块，因为如果出现问题，您的应用程序不会让您知道。要么显示一个消息框（或类似的东西），要么将其记录到数据库或其他东西。

此外，如果子目录中有子目录，您的 DoStart() 方法会做什么？从我所看到的，我会说它只搜索 1 个子级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:37:27.387

1.  不要吞下所有的例外。如果你需要忽略特定的异常，抓住那些但让其他人冒泡
2.  （风格）方法应该是 PascalCased（例如`DoStart`和 `FileFound'
3.  （风格）创建一个`OnFileFound`方法而不是直接调用`FileFound`（我假设`fileFound`是一个事件处理程序？）

除此之外，它对我来说看起来不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T20:49:16.133

这是一个真正的递归的例子。与 Directory.GetFiles SearchOption.AllDirectories 不同，这将搜索直到找不到更多子目录。您可以修改它以将搜索过滤器添加为参数。

```
public IEnumerable<string> GetFilesRecursive(string ParentDirectory)
{
    string[] subDirectories = Directory.GetDirectories(ParentDirectory);
    foreach (string file in Directory.GetFiles(ParentDirectory))
    {
        yield return file;
    }

    foreach (string subDirectory in subDirectories)
    {
        foreach (string file in GetFilesRecursive(subDirectory))
        {
            yield return file;
        }
    }
} 
```

# html - 从 URL (PATH) 下载 - iPhone

> ID：13940981
> 
> 赞同：0
> 
> 时间：2012-12-18T20:31:44.240
> 
> 标签：html, objective-c, ios, url, path

我有一个小问题。

我正在开发一个应用程序，为此我必须下载一个包含 CSS 和图像的 HTML 文件。是的，有一个 API（`ASIHTTPRequest`），但我不想将我的应用程序发布到 App Store，也不想使用第 3 方 API。并且解析 HTML 代码有点困难 :(

如果我可以下载 URL 的整个路径，它也对我有用。

例如：我有这个网址：`http://example.org/smthg/`.

在这条路上我有：

-index.html

-logo.png

-style.css

我想自动下载所有这些文件，而不是每个文件。但是我不认为，您可以找出服务器上的文件，对吗？（没有蛮力）。

我希望你知道我的意思:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:51:00.347

使用 3rd 方框架并没有错，只要它们是高质量的框架并且您正确使用它们。; ) 毕竟，Apple 只是为您提供了制作应用程序的起点，而使用开源代码确实可以加快您的项目速度。

话虽如此，`ASIHTTPRequest`有点过时并且维护得不好。相反，我推荐`AFNetworking`它，它支持异步下载、后台下载和块。请参阅[https://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)。

但是，关于您下载某些文件的具体问题，您可以尝试在服务器上创建一个**plist（**如果它是您的，或者可能捆绑在应用程序中），其中将列出所有需要的文件及其下载地点。

但是，您希望快速面对的问题 - 即使您的应用程序已经下载了所有需要的文件，它仍然必须了解如何处理它们。如果它只是 HTML 内容、样式等，也许你可以在`UIWebView`? 但是，请确保您的应用程序除了作为 Web 浏览器之外还添加了一些有用的功能......（当然，除非您正在制作增强的 Web 浏览器......；）

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:39:58.057

您可以使用 UIWebView 下载该位置的内容并保留 WebView。如果您想将内容保存为未格式化并且您拥有资源的 URL，您还可以使用 NSURLConnection 下载 URL 上的内容。

# jquery - jquery div仅在向上滚动时定位

> ID：13940982
> 
> 赞同：1
> 
> 时间：2012-12-18T20:31:50.397
> 
> 标签：jquery, html, positioning

我有这个 jquery

[http://jsfiddle.net/4Ns44/5/](http://jsfiddle.net/4Ns44/5/)

这个想法是始终在视口中打开 div 的扩展视图。这工作正常。而且我想坚持这种方法（没有固定位置的div）。但是当窗口滚动时，我希望扩展窗口在用户向上滚动时向上移动，但如果用户向下滚动，它不应该向下滚动。

在小提琴中，如果用户在向上滚动后向下滚动，则展开 div 将向下滚动直到它最初打开的位置。

`margin-top`任何人都可以在滚动中添加一些光线和定位吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:43:57.487

试试这个：http: [//jsfiddle.net/4Ns44/6/](http://jsfiddle.net/4Ns44/6/)

每次滚动时它都会更新`expandY`变量，并且不会让它从以前的页面向下移动。

要记住的一件事：您应该使用`e.preventDefault()`来阻止链接被跟踪，而不是`return false`. `preventDefault()`仍将允许其他事件触发，同时`return false`将停止其轨道中的事件执行。如果您要添加其他点击处理程序等，可能会导致混淆。

# c# - 如何通过几个点绘制贝塞尔曲线？

> ID：13940983
> 
> 赞同：9
> 
> 时间：2012-12-18T20:31:53.673
> 
> 标签：c#, .net, canvas, bezier

我有几点，我尝试使用下面的代码绘制贝塞尔曲线

```
 PathFigure pf = new PathFigure(points.From, ps, false); //ps - list of Bezier segments
    PathFigureCollection pfc = new PathFigureCollection();
    pfc.Add(pf);
    var pge = new PathGeometry();
    pge.Figures = pfc;
    Path p = new Path();
    p.Data = pge;
    p.Stroke = new SolidColorBrush(Color.FromRgb(244, 111, 011)); 
```

我的贝塞尔曲线看起来像这样

*   1,2,3 点 - 第一段
*   3,4,5分 - 第二
*   5,6,7.. ..

但我得到了这条奇怪的曲线（这里是 3 个大（节点）和 7 个小椭圆（是我的观点））：

![在此处输入图像描述](../Images/36be996141830747154ea50260e9ad9c.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-19T08:14:54.050

你得到的线是三个不同的贝塞尔曲线的联合——每组三个点一个。（每个“贝塞尔线段”一个？）

如果您想要一条平滑曲线，则需要将 9 个（或更多）点作为单个点集合（单个“贝塞尔线段”？）传递，而不是作为三个点的组。

编辑：显然[`BezierSegment`](http://msdn.microsoft.com/en-us/library/system.windows.media.beziersegment.aspx)只*支持*三点，所以难怪这不起作用。即使是[“PolyBezierSegment”](http://msdn.microsoft.com/en-us/library/ms558605.aspx)也只是给出了贝塞尔线段的集合，而不是一个平滑的贝塞尔曲线......

所以由于 WPF 没有给你任何有用的东西，我在[这里](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Recursive_definition)使用数学把一些东西拼凑在一起。这是一个数字解决方案，但即使有足够多的点看起来很漂亮和平滑，它似乎也很高效：

```
PolyLineSegment GetBezierApproximation(Point[] controlPoints, int outputSegmentCount)
{
    Point[] points = new Point[outputSegmentCount + 1];
    for (int i = 0; i <= outputSegmentCount; i++)
    {
        double t = (double)i / outputSegmentCount;
        points[i] = GetBezierPoint(t, controlPoints, 0, controlPoints.Length);
    }
    return new PolyLineSegment(points, true);
}

Point GetBezierPoint(double t, Point[] controlPoints, int index, int count)
{
    if (count == 1)
        return controlPoints[index];
    var P0 = GetBezierPoint(t, controlPoints, index, count - 1);
    var P1 = GetBezierPoint(t, controlPoints, index + 1, count - 1);
    return new Point((1 - t) * P0.X + t * P1.X, (1 - t) * P0.Y + t * P1.Y);
} 
```

使用这个，

```
private void Grid_Loaded(object sender, RoutedEventArgs e)
{
    Point[] points = new[] { 
            new Point(0, 200),
            new Point(0, 0),
            new Point(300, 0),
            new Point(350, 200),
            new Point(400, 0)
        };
    var b = GetBezierApproximation(points, 256);
    PathFigure pf = new PathFigure(b.Points[0], new[] { b }, false);
    PathFigureCollection pfc = new PathFigureCollection();
    pfc.Add(pf);
    var pge = new PathGeometry();
    pge.Figures = pfc;
    Path p = new Path();
    p.Data = pge;
    p.Stroke = new SolidColorBrush(Color.FromRgb(255, 0, 0));
    ((Grid)sender).Children.Add(p);
} 
```

给

![在此处输入图像描述](../Images/bb2c802535ee0d96a1200370b966ef23.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-19T09:08:39.110

由于每条曲线都有一个控制点（影响曲线但不一定在曲线上的点），因此您使用的是二次贝塞尔曲线。

如果要绘制共享端点的两条二次曲线，并且希望关节看起来平滑，则共享端点每侧的控制点必须与端点共线。也就是说，两个控制点和它们之间的端点必须都在一条直线上。例子：

![具有光滑关节的二次方程](../Images/4f38f8a29ad024dd219fe026986901e7.png)

实心黑色圆盘是端点。空心圆圈是控制点。黑色实线是曲线。虚线显示每个端点与任一侧的控制点共线（在一条直线上）。

# jsf - 我在 Java 中有 ac:set 变量。我想对 Rich:dataTable 中的值 +1，这可能吗？

> ID：13940991
> 
> 赞同：1
> 
> 时间：2012-12-18T20:32:12.723
> 
> 标签：jsf, richfaces, jstl, jsf-1.2

我在 Java 中有 ac:set 变量。我想对 a 中的值 +1 `rich:dataTable`，这可能吗？

```
 <h:form id="webstoreSettings" styleClass="edit">
        <c:set var="_count" value="0" scope="page" />
        <rich:panel>
            <rich:simpleTogglePanel label="Store Properties"
                switchType="client" rendered="true">
                <div style="margin: 7px 0px;">
                    <rich:dataTable id="webListsTable"
                        value="#{storeHome.webPropertiesVars}" var="_var">
                        <h:column id="webstoreVarCol">
                            <h:outputLabel id="webstoreVar_#{_count}" value="#{_var.webstoreVar}" />
                            <c:set var="_count" value="#{_count + 1}" scope="page" />
                        </h:column>
                    </rich:dataTable>
                </div>
            </rich:simpleTogglePanel>
        </rich:panel>
    </h:form> 
```

所有的 id="webstoreVar_0" 都是一样的 :(

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:34:58.520

这是不可能的。JSTL 标记在视图构建期间运行，而不是在视图呈现期间运行。`<rich:dataTable var>`仅在视图渲染期间可用。

我不确定你为什么需要`<h:outputLabel id>`这样的东西。这没有道理。只需从`id`属性中删除 EL。JSF 已经在它前面加上数据表的行索引。

```
<h:outputLabel id="webstoreVar" ... /> 
```

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

# jquery - 一个部分上的浮动导致的视差滚动抖动

> ID：13940993
> 
> 赞同：1
> 
> 时间：2012-12-18T20:32:16.390
> 
> 标签：jquery, wordpress, parallax

在我公司的网站上工作，似乎找不到解决方案。这是一个视差滚动网站。在画廊部分，当该部分进入视野时，会有轻微的抽搐和犹豫。这是由于图片库的缩略图是 li 向左浮动的。当我摆脱左浮动时，它会在没有抽搐的情况下进入视野。即使我将 inline-block 分配给 li，它仍然会做混蛋。不知道为什么会这样。我将循环插件用于画廊幻灯片放映，将 simple.carousel.js 用于缩略图轮播。

该网站的链接是[http://westendvillage.ram.wpengine.com](http://westendvillage.ram.wpengine.com)。

如果有人可以帮助或引导我朝着正确的方向前进，将不胜感激

# javascript - 如何使用分辨率相关的css文件？

> ID：13940995
> 
> 赞同：0
> 
> 时间：2012-12-18T20:32:19.167
> 
> 标签：javascript, html, css, screen-resolution

我有一个网站，根据分辨率应该有不同的风格。

[到目前为止我的代码](http://jsfiddle.net/bkBZr/)。

我想在`window.innerWidth`我的文档加载时检查并在宽度小于**1024px时使用****small.css**。否则我想使用**large.css**。

 ****有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:34:28.673

媒体查询。

```
/* your "big screen" CSS here */
@media all and (max-width:1024px) {
  /* your "small screen" CSS here
} 
```

如果浏览器不支持媒体查询，您也可以将其反转，具体取决于您要考虑哪个“默认”：

```
/* your "small screen" CSS here */
@media all and (min-width:1024px) {
  /* your "big screen" CSS here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:34:05.847

通过您的 Javascript 代码动态加载所需的 CSS 文档。

编辑：更详细的源代码：

```
var srcURL;

if(resolution1)
     srcURL = "path/small.css";
else
     srcURL = "path/large.css";

var style = document.createElement("link")
style.setAttribute("rel", "stylesheet")
style.setAttribute("type", "text/css")
style.setAttribute("href", srcURL)

document.getElementByTagName("head")[0].appendChild(style); 
```****