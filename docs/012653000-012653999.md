# StackOverflow 问答 12653000-12653999

# iphone - 在 applicationDidBecomeActive 上刷新 ios UIViewController

> ID：12653004
> 
> 赞同：2
> 
> 时间：2012-09-29T13:16:46.450
> 
> 标签：iphone, ios, uiviewcontroller, uiapplication

`UIViewController`我需要在我的 iOS 应用程序中重新创建我当前的`applicationDidBecomeActive`. 在我的代码中，我在屏幕上添加了很多运行时图形，所以我认为最好的方法是完全重新创建它。

我需要解决 2 个任务：

1.  确定当前显示哪个 UIViewController（我使用**presentModalViewController**命令更改视图控制器）。
2.  完全重新粉刷它。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T13:31:22.607

可能对你有帮助:)

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{  
   UIViewController* root = _window.rootViewController;
   UINavigationController* navController = (UINavigationController*)root;
   YourViewController * mycontroller = (YourViewController *)[[navController viewControllers] objectAtIndex:0];
   [mycontroller reloadInputViews];
} 
```

# ios - 为结构存储对象

> ID：12653005
> 
> 赞同：0
> 
> 时间：2012-09-29T13:16:52.963
> 
> 标签：ios, object, struct

只是好奇，我如何将此结构存储到属性中

```
void CGContextAddCurveToPoint (
   CGContextRef c,
   CGFloat cp1x,
   CGFloat cp1y,
   CGFloat cp2x,
   CGFloat cp2y,
   CGFloat x,
   CGFloat y
); 
```

喜欢

```
@property (strong, nonatomic) void ?? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:50:34.877

您在问题中提出的不是 a`struct`它是`method`.

但可以执行以下操作。首先声明一个结构：

```
typedef struct 
{
   CGContextRef c;
   CGFloat cp1x;
   CGFloat cp1y;
   CGFloat cp2x;
   CGFloat cp2y;
   CGFloat x;
   CGFloat y;
} yourStruct; 
```

然后声明一个属性，其类型规范为`yourStruct`

例如：`@property yourStruct yourPropertyName;`

# html - HTML按钮提交在IE中不起作用

> ID：12653009
> 
> 赞同：0
> 
> 时间：2012-09-29T13:17:57.147
> 
> 标签：html, internet-explorer

我的 HTML 代码如下。

```
 <form action="index.php" method="post" enctype="multipart/form-data">
        <input type="text" name="file2" id="FileField" value="( .xls / .xlsx )" />
        <input type="file" id="file1" name="file1" style="visibility:hidden;width: 0" onchange="getElementById('FileField').value = this.value;" />
        <input type="button"  id ="browse" onclick="document.getElementById('file1').click()" />
        <input id="scan" type="submit" value="click" />
    </form> 
```

当我点击 IE 中的“点击”按钮时，什么也没有发生。但是相同的代码在所有其他浏览器中都可以使用。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-24T15:04:47.183

我找到了以下解决方案：

HTML：

```
<input type="text" id="attachmentFileText" readonly="readonly" value="" />

<div style="overflow: hidden; vertical-align: middle; height: 20px; width: 72px; margin-right: 15px;" class="button" title="Select file">
    Browse
    <input type="file" name="attachmentFile" id="attachmentFile" size="1" style="margin-top: -50px; margin-left:-410px; -moz-opacity: 0; filter: alpha(opacity=0); opacity: 0; font-size: 150px; height: 100px;" onchange="checkFileName();"/>
</div> 
```

javascript:

```
function checkFileName() {
var fullPath = document.getElementById('attachmentFile').value;
var fileName = fullPath.split(/(\\|\/)/g).pop();
document.getElementById("attachmentFileText").value = fileName; 
```

}

“INPUT”元素“attachmentFileText”将显示我们的文件名。“div”元素 - 它是我们要显示的按钮元素，而不是原始输入。

# html-email - 在 localhost 上创建和使用 SMTP 服务器

> ID：12653020
> 
> 赞同：0
> 
> 时间：2012-09-29T13:19:17.733
> 
> 标签：html-email

我有兴趣开始一个电子邮件营销活动，我需要知道如果我在 LOCALHOST 上创建一个 SMTP 服务器并从我的计算机无限制地发送电子邮件会发生什么。

这可以做到吗？电子邮件会到达目标吗？他们会进入收件箱吗？这是一个好主意还是我应该更好地使用 GOOGLE 的 SMTP 服务器？

我需要一些有经验的人的建议。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T13:25:51.047

我希望你不会发送垃圾邮件。

当然，您可以在本地计算机上安装 SMTP 服务器（对于不同的平台，有很多可用的 SMTP 服务器），它应该可以工作。

但是，如果您要发送大量电子邮件，您的 ISP 或收件人的 SMTP 服务器可能会阻止您。

如果您想发送大量包含营销和广告的电子邮件，我认为使用 3-rd 方服务的最佳且简单的方法。

例如，我们有使用[http://www.unisender.com/en/](http://www.unisender.com/en/)的经验。每个月，我们都会向 100 000 多个客户的地址发送公司通讯。

# sql - SQL 语句 - 我如何在活动记录中执行此操作？

> ID：12653023
> 
> 赞同：1
> 
> 时间：2012-09-29T13:19:30.393
> 
> 标签：sql, database, codeigniter, activerecord

我正在努力创建一个活动记录语句来做我想做的事，这是我目前的尝试：

```
$this->db
            ->select('*')
            ->from('item_entries')
            ->where('is_pick', 'y')
            ->join('item_categories_rel', 'item_categories_rel.item_id = item_entries.item_id')
            ->join('item_categories', 'item_categories.cat_id = item_categories_rel.cat_id')
            ->join('ratings_total', 'ratings_total.item_id = item_entries.item_id')
            ->where('item_categories.cat_id', $cat_id)
            ->or_where('parent_id', $cat_id)
            ->or_where('gparent_id', $cat_id)
            ->order_by("item_name", "desc");  
        $query2 = $this->db->get();
        if(is_object($query)){return $query2->result_array();}else{return $query2;} 
```

这转换为以下 sql：

```
SELECT *
FROM (`item_entries`)
JOIN `item_categories_rel` ON `item_categories_rel`.`item_id` = `item_entries`.`item_id`
JOIN `item_categories` ON `item_categories`.`cat_id` = `item_categories_rel`.`cat_id`
JOIN `ratings_total` ON `ratings_total`.`item_id` = `item_entries`.`item_id`
WHERE `is_pick` =  'y'
AND `item_categories`.`cat_id` =  '3'
OR `parent_id` =  '3'
OR `gparent_id` =  '3' 
```

现在，我想要的（虽然我知道我不能在活动记录中做临时表）是这样的：

```
SELECT *
FROM (
    SELECT *
    FROM (`item_entries`)
    JOIN `item_categories_rel` ON `item_categories_rel`.`item_id` = `item_entries`.`item_id`
    JOIN `item_categories` ON `item_categories`.`cat_id` = `item_categories_rel`.`cat_id`
    JOIN `ratings_total` ON `ratings_total`.`item_id` = `item_entries`.`item_id`
    WHERE `is_pick` =  'y'
    AS T
)
WHERE `item_categories`.`cat_id` =  '3'
OR `parent_id` =  '3'
OR `gparent_id` =  '3' 
```

如何在活动记录中检索此结果？

请注意 - 我没有检查上面的 SQL，所以它可能有点错误，但希望你能得到我想要做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T16:30:52.697

CodeIgniter Active Record 无法做到这一点。这不是故意的。您可以使用[此库](https://github.com/NTICompass/CodeIgniter-Subqueries)作为解决方法。

# css - div定位的CSS问题

> ID：12653025
> 
> 赞同：0
> 
> 时间：2012-09-29T13:19:57.247
> 
> 标签：css

嗨，我的网站的边距自动存在问题，我有一个宽度设置为 1000 像素的包装器 div，顶部和底部边距为 0，左右边距为自动。我在侧边栏中有一个导航菜单，我在其中使用 java 脚本将相同的 div 替换为不同的表。当我单击菜单中的链接时，包装器会向右移动一些 px 并返回原始位置，我不希望该操作是静态的，并且不会随时变化。我怎样才能做到这一点。

当我将边距设置为 0 时，定位出现问题。但我希望包装器居中。

这是演示：

[http://techiedreams.com/projects/test/new/admin/index.php](http://techiedreams.com/projects/test/new/admin/index.php)

这是我的CSS代码：

```
body {
background-color:#E2E3E4;
color:#333;
font-size: 12px;
}

#wrapper {
background-color:#ffffff;
width:1000px;
margin:0 auto;
margin-bottom:10px;
}

#content {
width:780px;
float:right;
}

#sidebar {
width:150px;
margin-top:15px;
margin-left:10px;
float:left;
border-right:1px solid #EDE9DE;
margin-bottom:25px;
}

#footer {
clear:both;
margin:0 auto;
width:1000px;
height:44px;
border-top:1px solid #EDE9DE;
} 
```

请检查 HTML 的演示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T18:23:11.283

恕我直言，这个问题应该被关闭，因为 HTML/CSS 中没有任何内容导致报告的问题。OP 看到了由垂直滚动条的正常外观引起的变化。

一种典型的解决方法是强制垂直滚动条始终可见，即使在不需要时也是如此。这与某些较旧的浏览器不兼容。

```
html { overflow-y: scroll; } 
```

[存在滚动条时绝对 div 移动](https://stackoverflow.com/questions/5463200/absolute-div-shifts-when-scrollbar-is-present)

我强烈倾向于不做任何修复，只允许浏览器正常运行，正如大多数访问者所期望的那样。

# python - Python谈自动控制与嵌入式开发

> ID：12653026
> 
> 赞同：0
> 
> 时间：2012-09-29T13:20:31.313
> 
> 标签：python, embedded

大家好~我只是对嵌入式开发感兴趣，众所周知，C是嵌入式开发中最流行的编程语言。但是我更喜欢使用Python，Python是否适合做任何关于嵌入式开发或自动控制的任务？有没有一些关于这方面的书值得推荐？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T16:09:00.427

C（和 C++）在嵌入式系统中流行的原因是它们是系统级语言，对运行时环境的要求最低，可以独立运行（裸机）、使用简单的 RTOS 内核或在完整的 OS 环境中运行. 两者也几乎无处不在，可用于大多数 8、16、32 和 64 位架构。例如，您可以用 C 或 C++ 编写引导程序和 OS 代码，而 Python 需要这两种代码才能运行。

另一方面，Python 是一种解释性语言（尽管可以编译它，但您还需要交叉编译工具或可以支持自托管开发的嵌入式目标），以及大量系统级代码（通常和操作系统）以及解释器本身需要支持它。所有这些都排除了在 C 甚至 C++ 可以交付的非常小的系统上的部署。

此外，Python 可能不适合硬实时系统，因为它本质上执行速度较慢，并且在内存管理方面具有不确定性。

如果您的嵌入式系统碰巧运行的是 Linux，那么当然可以使用 Python，但它适用的应用程序数量可能有限，而且由于 Linux 本身有点资源消耗，您可能不会部署它是唯一的原因是能够运行 Python。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-29T13:31:41.707

OOP 一般不适合嵌入式开发。这是因为嵌入式硬件的内存有限，而 OOP 无法预测内存使用情况。这是可能的，但是您被迫进入静态对象的方法以具有任何可靠性。

# google-chrome - 我可以创建自己的谷歌浏览器安装程序吗？

> ID：12653028
> 
> 赞同：3
> 
> 时间：2012-09-29T13:20:38.480
> 
> 标签：google-chrome, google-chrome-extension

我想知道，是否可以创建自己的 google chrome 安装程序？使用自己的扩展搜索引擎。就像在Mozilla中一样。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:53:51.763

[您可以使用Google Omaha](http://code.google.com/p/omaha/)创建自己的安装程序，这是用于 Chrome 的免费下载器/安装程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T13:26:58.057

**[Chromium](http://www.chromium.org/)**项目是一个基于 WebKit 和 Chrome 背后的开源浏览器项目。
我没有验证 Chrome 许可证，但我怀疑任何人都有权修改此程序或设置除 Google 之外的其他搜索引擎，尽管扩展包是不同的东西并且是可能的。

# javascript - 如何在 Jquery UI 对话框中检查复选框值

> ID：12653030
> 
> 赞同：1
> 
> 时间：2012-09-29T13:20:45.990
> 
> 标签：javascript, jquery, html, jquery-ui

我试图在 JQuery UI 对话框中调用 changeShowTips() 方法，但是该方法总是返回“未检查！！！”

似乎是什么问题？

```
 <div id="dialog-tip">
        <div>
            <input type="checkbox" name="showTips" value="showTips" checked="checked" onclick="changeShowTips();"/>Show tips on start up
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            showTips()
        });

        function showTips() {
            $("#dialog-tip").dialog({
                height: 520,
                width: 515,
                modal: true,
            }).parents('.ui-dialog:eq(0)').wrap('<div class="black-tie"></div>');             
        }

        function changeShowTips() {
            if (showTips.checked == true) {
                alert('checked!!!');
            }
            else {
                alert('NOT checked!!!');
            }
        }

    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:32:45.320

那是因为在您的代码`showTips`中指的是您的函数而不是目标元素。

```
<input type="checkbox" 
       name="showTips" 
       value="showTips" 
       checked="checked" 
       onclick="changeShowTips(this);"
/> Show tips on start up 
```

```
function changeShowTips(showTips) {
     if (showTips.checked) {
         alert('checked!!!');
     }
     else {
         alert('NOT checked!!!');
     }
} 
```

[http://jsfiddle.net/n74JG/](http://jsfiddle.net/n74JG/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T13:27:48.050

你有一些乱七八糟的 jQuery

```
 <div id="dialog-tip">
    <div>
        <input type="checkbox" name="showTips" value="showTips" checked="checked"/>Show tips on start up
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        showTips()

        $('input', '#dialog-tip').click(changeShowTips()); // do not have inline js, bind it here
    });

    function showTips() {
        $("#dialog-tip").dialog({
            height: 520,
            width: 515,
            modal: true,
        }).parents('.ui-dialog').eq(0).wrap('<div class="black-tie"></div>');       
        // it is faster for sizzle to use a standard css selector to modify the jquery object and then use a jquery specific selector 'eq' separately
        // instead of combining css/jquery selectors in one statement      
    }

    function changeShowTips() {
        if ($('input', '#dialog-tip').is(':checked')) { // there is jQuery for this - you should also compare and not assign
            alert('checked!!!');
        }
        else {
            alert('NOT checked!!!');
        }
    }

</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T13:23:54.783

试试这个...

给输入一个 showTips 的 id 以及名称然后......

```
 function changeShowTips() {
        if ($('#showTips').is(':checked')) {
            alert('checked!!!');
        }
        else {
            alert('NOT checked!!!');
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T13:29:22.533

从语法上看，您似乎正在尝试使用 vanilla JS 而不是 jQuery 来检查复选框。

一个 jQuery 选择器看起来像这样 $([...])，通常你用它来选择类 $(".someclass") 或 ids $("#someid")。如果您真的不想为输入字段提供 ID，请查看文档：[http ://api.jquery.com/attribute-equals-selector/](http://api.jquery.com/attribute-equals-selector/)

然后你可以使用 $([...]).prop("checked") 来确定它是否被选中。

# php - 使用 CakePHP hasAndBelongsToMany 关系中的数据

> ID：12653039
> 
> 赞同：0
> 
> 时间：2012-09-29T13:21:49.757
> 
> 标签：php, cakephp

我有一个 CakePHP 应用程序，它允许用户与其他用户成为朋友。这是使用用户表上的 HABTM 关系通过好友表进行连接来完成的。

朋友表有：id、user_id、friend_id 和状态字段。

关系模型如下所示：

```
public $hasAndBelongsToMany = array(
        'User'=>array(
            'className'              => 'User',
            'joinTable'              => 'friends',
            'with'                   => 'Friend',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'friend_id'
        )
    ); 
```

因此，例如，如果我想列出登录用户的朋友，我有以下内容：

```
$user = $this->User->find('first', array('conditions' => array('User.id' => $this->Auth->user('id'))));

        $friends = $this->User->find('first', 
            array(
                'conditions'=>array(
                   'User.id'=>$user['User']['id']
                ),
                'contain'=>array(
                    'User'=>array(
                        'conditions'=>array(
                            'Friend.status'=>1
                        )
                    )
                )
            )
        );

    $this->set('friends', $friends); 
```

现在我遇到的问题是在尝试显示此列表时，获取朋友信息！

如果我对 $friends 进行调试，我会得到：

```
array(
    'User' => array(
        'password' => '*****',
        'id' => '6',
        'username' => 'test',
        'email' => 'test@test.com',
        'firstname' => 'Test',
        'lastname' => 'User',
        (int) 0 => array(
            'password' => '*****',
            'id' => '8',
            'username' => 'johndoe',
            'email' => 'john@doe.com',
            'firstname' => 'John',
            'lastname' => 'Doe',
            'Friend' => array(
                'id' => '1',
                'user_id' => '6',
                'friend_id' => '8',
                'created' => '0000-00-00 00:00:00',
                'status' => '1'
            )
        )
    )
) 
```

那么如何显示好友列表呢？正如我所做的那样：

```
<?php foreach ($friends as $friend) : ?>

        <li><?php echo $this->Html->link($friend['User']['firstname']. ' '. $friend['User']['lastname'], array('controller'=>'users','action'=>'view','userName'=>$friend['User']['username'])); ?></li>

    <?php endforeach; ?> 
```

但我只是得到：`Undefined index: User [APP/View/Friends/index.ctp, line 44]`

任何想法我做错了什么？我假设这与视图中未正确使用数组有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:03:39.190

我认为你应该尝试一下：

```
$friends = $this->User->find('first', array(
    'conditions' => array('User.id' => $this->Auth->user('id')),
    'contain' => array('Friend' => array(
        'conditions' => array('Friend.status' => 1)
    ))
)); 
```

你会：

```
array(
    'User' => array(
        'password' => '',
        'id' => '',
        'username' => '',
        'Friend' => array(
            0 => array(),
            1 => array(),
            2 => array()
        )
    )
) 
```

在您看来：

```
<?php foreach ($friends['User']['Friend'] as $friend): ?>

    <li><?php echo $this->Html->link($friend['User']['firstname']. ' '. $friend['User']['lastname'], array('controller'=>'users','action'=>'view','userName'=>$friend['User']['username'])); ?></li>

<?php endforeach; ?> 
```

希望这可以帮助。

**编辑**

使用可包含：

```
$this->User->Behaviors->load('Containable');

$this->User->contain('Friend' => array(
    'conditions' => array('Friend.status' => 1),
    'User'
));

$user = $this->User->read(null, $this->Auth->user('id'));

$this->User->Behaviors->unload('Containable'); 
```

# objective-c - 仅设备上的链接器错误

> ID：12653040
> 
> 赞同：1
> 
> 时间：2012-09-29T13:22:21.787
> 
> 标签：objective-c, ios, xcode, linker-errors, dropbox

为我的设备编译时出现以下错误

`File is universal (3 slices) but does not contain a(n) armv7s slice: /Users/xxx/Desktop/xxxxxxx/DropboxSDK.framework/DropboxSDK for architecture armv7s clang: error: linker command failed with exit code 1 (use -v to see invocation)`

我检查了所有 .m 文件是否已链接并且一切正常，为什么它只在设备上执行此操作，编译器想要阻止它抱怨什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T14:00:14.113

“armv7s”是 iPhone 5 中新的 ARM 处理器支持的指令集。Xcode 4.5 默认为 armv7 和 armv7s 生成二进制文件。

链接器错误意味着您的应用程序是针对 armv7 和 armv7s（以及针对模拟器的 i386）编译的，但链接到不包含 armv7s 代码的 DropboxSDK 框架。

因此，您有以下选择：

*   下载并安装最新的 DropboxSDK 框架。根据[CHANGELOG](https://www.dropbox.com/static/developers/CHANGELOG-objc.txt)，增加了对 iPhone 5 的支持。
*   仅为“armv7”编译您的应用程序。这是在目标的“构建设置”的“架构”中配置的。

您说“没有引用 Dropbox 的库”。但是必须有对该库的引用，否则链接器不会抱怨。您可以在目标设置的“构建阶段”选项卡的“将二进制文件与库链接”部分中进行检查。

# flash - Playframework + Flash 策略文件

> ID：12653044
> 
> 赞同：1
> 
> 时间：2012-09-29T13:22:47.247
> 
> 标签：flash, playframework-2.0, netty

我知道 playframework 2 依赖于 netty，并且 github 上有几个项目为 netty 提供此功能，例如：[https ://github.com/cgbystrom/netty-tools](https://github.com/cgbystrom/netty-tools)

但是我不知道在哪里实现这个，我以前从来没有用netty开发过，谁能提供一些关于我如何允许播放框架提供闪存策略文件的指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T06:47:48.230

这个答案不涉及游戏框架。但是要查看提供 Flash 策略文件的 netty 代码，请查看这个使用 Flash 策略服务器[的基于 netty 的 java 游戏服务器。](https://github.com/menacher/java-game-server)相关类是 org.menacheri.jetserver.server.netty.FlashPolicyServer。它还提供基于[as3](https://github.com/menacher/java-game-server/tree/master/jetclient-as3)的客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T03:32:57.370

我查看了很多不同的选项来修改 netty，但最后，最终运行了一个单独的服务器，基于：github.com/waywardmonkeys/netty-flash-crossdomain-policy-server

这一切似乎都不起作用。

但是对于未来，如果有人知道我如何允许 playframework 自己在端口 843 上提供策略文件，那将不胜感激。

# javascript - 在 CSS 中调用 JavaScript 变量

> ID：12653047
> 
> 赞同：0
> 
> 时间：2012-09-29T13:23:27.257
> 
> 标签：javascript, html, css

我知道关于这个主题有各种各样的主题。但我想知道我的方法是否完全不正确。我正在尝试根据浏览器大小设置包装器的高度。到目前为止，我有这个返回屏幕高度和宽度的 JavaScript 函数。

```
<script language="JavaScript">
var screenW = 640, screenH = 480;
if (parseInt(navigator.appVersion)>3) {
 screenW = screen.width;
 screenH = screen.height;
}
else if (navigator.appName == "Netscape" 
    && parseInt(navigator.appVersion)==3
    && navigator.javaEnabled()
   ) 
{
 var jToolkit = java.awt.Toolkit.getDefaultToolkit();
 var jScreenSize = jToolkit.getScreenSize();
 screenW = jScreenSize.width;
 screenH = jScreenSize.height;
}
</script> 
```

`<div id="wrapper" style = "height: valuepx; screenHwidth: screenWpx;>`我希望稍后以类似于 PHP 回显的方式调用这些变量的值 。

我应该如何接近调用变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:28:52.070

您必须从 Javascript 分配样式：

```
var wrapper=document.getElementById("wrapper");
wrapper.style.height = screenH;
wrapper.style.width = screenW; 
```

或使用 jQuery：

```
$("#wrapper").css({
  width:screenW, 
  height:screenH
}) 
```

# javascript - 从垂直和水平方向居中对齐图像

> ID：12653049
> 
> 赞同：-1
> 
> 时间：2012-09-29T13:23:36.307
> 
> 标签：javascript, html, css

我需要帮助来使用 CSS 使图像中心水平和垂直对齐。

考虑下面的代码，其中容器是主体中唯一可用的元素。我希望内部图像从左、右、上和下位于容器的中间。

```
<body>
<div class="container">
 <img name="img.png" width="100" height="100" />
</div>enter code here
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:33:21.683

您必须将宽度设置为百分比：

```
<div id="responsive-img">
<img src="yourimage.jpg">
</div>

#responsive-img {
    width:50%;
}

#responsive-img img {
    max-width:100%;
} 
```

高度会自动调整。[检查此演示](http://jsfiddle.net/gionaf/WmcaE/)并调整窗口大小。

那也是跨浏览器;-)

# url - 防止在 MediaWiki 中的链接中对字符进行 URL 编码

> ID：12653058
> 
> 赞同：0
> 
> 时间：2012-09-29T13:24:16.250
> 
> 标签：url, escaping, mediawiki

即：**如何在 MediaWiki 链接中使用其 html 实体来抑制字符的替换/替换？**

我需要在`|`MediaWiki 文章中插入一个看起来像这样的链接，包括管道 ( )：

```
http://www.somesite.asdf/#|param1|param2|param3 
```

目标站点不接受`%7C`或`&#124;`作为其 URL 中的管道替代品。因此，以下 URL 无效：

```
http://www.somesite.asdf/#%7Cparam1%7Cparam2%7Cparam3
http://www.somesite.asdf/#&#124;param1&#124;param2&#124;param3 
```

* * *

当我在 MediaWiki 文章中键入链接时，例如：

```
http://www.somesite.asdf/#|param1|param2|param3 
```

...它会产生一个指向：

```
http://www.somesite.asdf/#%7Cparam1%7Cparam2%7Cparam3 
```

，这是无效的。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T09:30:11.943

这不是一个有效的 URI；根据[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986#section-2)，URI 由字符组成`ALPHA / DIGIT / "-" / "." / "_" / "~" / ":" / "/" / "?" / "#" / "[" / "]" / "@" / "!" / "$" / "&" / "'" / "(" / ")" / "*" / "+" / "," / ";" / "="`；其他所有内容都必须进行百分比编码。MediaWiki 会自动更正无效的 URL（可能与任何其他 CMS 一样），因此，如果此 wiki 归他人所有，那么您就不走运了。如果是你的，你可以使用一些方法来避免内置的 HTML 处理（例如启用`<html>`标签）；确保您知道自己在做什么，这通常会带来安全后果。

# matlab - 如果 AB = C，给定 A，B，C 是矩阵，我如何使用 Matlab 从 B 和 C 计算 A？

> ID：12653061
> 
> 赞同：2
> 
> 时间：2012-09-29T13:24:33.550
> 
> 标签：matlab, math

A、B 和 C 是矩阵。

`A*B = C`

现在我想做一个反向操作，即使用 B 和 C 计算 A。我该怎么做？Matlab 说 B 应该是一个方阵来计算它的逆。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:53:01.030

如果存在唯一的解决方案，那么最好使用 pinv 来找到它。使用 schwarz 提出的示例...

```
A = [2 3 4];
B = [11 11 11; 12 12 12; 13 13 13];
C = A*B;

Ahat = C*pinv(B)
Ahat =
        2.788       3.0415       3.2949 
```

问题是，B 是单数的。所以可能有无限多的解决方案。

```
B = magic(3)
B =
     8     1     6
     3     5     7
     4     9     2
A = [2 3 4];
C = A*B
C =
    41    53    41

Ahat = C*pinv(B)
Ahat =
            2            3            4

Ahat = C/B
Ahat =
     2     3     4 
```

看到 pinv 和 slash 都产生相同的解决方案，因为 B 是非奇异的并且它是条件良好的。

但是，如果我们尝试一些条件不太好的东西呢？在下一个示例中，我将使用一个并不是那么糟糕的矩阵。

```
>> A = [2 3 4];
>> B = [1 1 1;1 2 3;2 3 4.00001]
B =
    1              1              1
    1              2              3
    2              3        4.00001 
```

嗯，它有一个相当大的条件数，但这个矩阵不是我所说的数字奇异矩阵。

```
cond(B)
ans =
           2865128.4655819

C = A*B
C =
                        13                        20                  27.00004 
```

现在让我们尝试几种不同的解决方案。

```
format long g
Ahat1 = C*pinv(B)
Ahat1 =
     2     3     4 
```

pinv 做得很好。

```
Ahat2 = C/B
Ahat2 =
          2.00000000017764          3.00000000017764          3.99999999982236

Ahat3 = C*inv(B)
Ahat3 =
          1.99999999953434          2.99999999953434          4.00000000046566 
```

slash 和 inv 都不错，尽管在这种情况下显然更糟。对于这个问题，pinv 解决方案似乎更稳定一些。

我们也不妨对此进行 QR 分解。使用旋转解决方案以获得最佳稳定性。请注意，当您的系统几乎是单一的时，我们仍然会遇到问题。

```
[Q,R,P] = qr(B); 
```

您可以通过检查 R 来发现问题。最后一个对角线元素与其余元素相比很小。这将导致解决方案出现问题，放大任何噪声。

```
R
R =
         -5.09902735824196         -2.35339392337313         -3.72620671848107
                         0         0.679365175314723         0.339681455393392
                         0                         0     -2.88675134520189e-06 
```

QR 因子具有 Q*R*P' = B 的性质。所以我们可以在这里求解 A：

```
Ahat4 = ((C*P)/R)*Q'
Ahat4 =
          2.00000000076851           3.0000000007685           3.9999999992315 
```

请注意，我已将括号安排得尽可能高效，因为 MATLAB 将使用 R 的属性作为三角矩阵来简单地进行反向求解。我们不希望 MATLAB 分解已经分解的矩阵。

但是现在让我们看一下vahid提出的一个：

```
Ahat5 = C*B'*(inv(B*B'))
Ahat5 =
              1.9970703125               2.998046875              4.0029296875 
```

然而，vahid 提出的解决方案简直太糟糕了。不要使用最后一种形式。请。人们告诉你不要这样做是有原因的，或者他们应该告诉你！是的，我知道有一群人不知道所涉及的数学，他们一直在传播它。你甚至可以在一些不知情的教科书中找到它。

pinv 的好处是它适用于任何矩阵，无论是否为单数。如果存在解决方案，它会找到一个。如果解决方案是唯一的，它将起作用。如果解决方案不是唯一的，那么您期望什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T13:29:08.060

您可以使用反斜杠运算符：

```
% if A*C = B
C = A\B 
```

我不认为非矩形 A 的解决方案是独一无二的......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-29T13:44:34.233

首先将两边乘以`A*B=C`（`B'`B的转置）：

```
A*B*B'=C*B' 
```

让`D=B*B'`（D是方阵）：

```
A*D=C*B' 
```

现在将上述等式的两侧乘以`inv(D)`：

```
A*D*inv(D)=C*B'*inv(D) 
```

`D*inv(D)=I`， 所以：

```
A=C*B'*inv(D) 
```

# ruby - Ruby 1.8.7 世界可写检查？File.world_writable？只有 1.9.x

> ID：12653065
> 
> 赞同：3
> 
> 时间：2012-09-29T13:25:18.107
> 
> 标签：ruby, macos

我需要检查一个特定的文件，看看它是否是世界可写的。在 1.9.x 中，有[一个方便的检查 this](http://www.ruby-doc.org/core-1.9.3/File.html#method-c-world_writable-3F)，但这个检查在 1.8.7 中不存在。出于兼容性原因，我需要在 1.8.7 中编写此脚本。

在 1.8.7 中是否有一种很好的方法可以在我遗漏的情况下进行此检查，或者我是否需要使用 stat 滚动我自己的方法？

*编辑* 这是我到目前为止想出的。有点hacky和坏，但它有效：

```
def world_writable?(file)
  write_bit = Integer(sprintf("%o", File.stat(file).mode)[-1,1])
  if [2, 3, 6, 7].include?(write_bit)
    return true
  else
    return false
  end
end

if world_writable?('/Users/nate/Desktop/scriptrunnertest/test1.sh')
  puts "World writable"
else
  puts "Not World Writable"
end 
```

我对红宝石很陌生，所以要温柔。

*edit2*没关系，这甚至不起作用。

*edit3*修复了它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:29:22.253

您可以获取`stat`文件的对象，并检查其`mode`成员...

```
world_writable = File.stat("testfile").mode == 0x100777 
```

您应该可以将其添加到`File`...

```
class File
    def self.world_writable? path
        permissions = File.stat(path).mode
        permissions == 0x100777 && permissions || nil
    end
end 
```

[红宝石小提琴](http://rubyfiddle.com/riddles/07619)。

# java - 选择不带图标的searchview android

> ID：12653076
> 
> 赞同：1
> 
> 时间：2012-09-29T13:26:57.197
> 
> 标签：java, android, searchview

我有这样的看法：

```
<LinearLayout
    android:id="@+id/searchPart"
    android:layout_width="fill_parent"
    android:layout_height="90dp"
    android:background="@drawable/moviesearch"
    android:gravity="center"
    android:weightSum="100" >

    <SearchView
        android:id="@+id/query"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:layout_weight="90"
        android:background="@android:color/background_light"
        android:queryHint="Enter query :" >
    </SearchView>
</LinearLayout> 
```

但是要选择使用 searchview 小部件进行搜索，我们必须点击搜索图标，而不是其他任何地方。有没有办法通过粘贴整个框架来绕过它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-09T12:06:36.507

有点晚了，但我希望它可以帮助某人。

要显示 SerchView 始终打开，请在布局文件中添加：

```
android:iconifiedByDefault="false" 
```

如果您想以编程方式设置它，请尝试以下操作：

```
YourSearchView.setIconifiedByDefault(false); 
```

否则，`true`用作参数值。

# java - 是否有一个带有引用变量的 for-each 循环的 Java 等价物？

> ID：12653081
> 
> 赞同：1
> 
> 时间：2012-09-29T13:27:33.690
> 
> 标签：java, foreach

在 C++ 中，可以在 for-each 语句中使用引用变量，例如`for (int &e : vec)`where`&e`是对 的值的引用`e`。这使人们能够更改在 for-each 循环中与之交互的元素的值。Java中是否有等效的构造？

下面是一个如何在 C++ 的 for-each 循环中使用引用变量的示例。

```
#include <iostream>
#include <vector>

int main()
{
    // Declare a vector with 10 elements and initialize their value to 0
    std::vector<int> vec (10, 0); 

    // e is a reference to the value of the current index of vec
    for (int &e : vec)
        e = 1;

    // e is a copy of the value of the current index of vec
    for (int e : vec)
        std::cout << e << " ";

    return 0;
} 
```

如果在第一个循环中没有使用引用运算符 ，`&`则对 1 的赋值将仅对作为`e`的当前元素的副本（而不是引用）的变量进行赋值，`vec`即使一个变量`&`不仅可以从向量中读取，而且还在 for-each 循环中写入向量。

例如，下面的 Java 代码不会修改原始数组，而只是一个副本：

```
public class test {

    public static void main(String[] args) {
    test Test = new test();

    int[] arr = new int[10];

    for (int e : arr)   // Does not write to arr
        e = 1;

    for(int e : arr)
        System.out.print(e + " ");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T13:38:15.360

不，没有。无论如何，如果您在迭代它们时修改它们，大多数集合都会抛出 ConcurrentModificationException。

但是，没有什么可以禁止您修改集合中包含的对象：

```
for (Customer c : customers) {
    c.setActive(false);
} 
```

对于列表，您可以在迭代时使用 ListIterator 替换当前元素。请参阅[http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html](http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T13:42:13.053

在 Java 中，对象是通过引用传递的，而所有其他类型都是通过值传递的。

换句话说，没有办法`e`在你的循环中修改，因为它是一个`int`（即你正在写入一个值副本）

但是，如果您要遍历对象集合，则没有什么可以阻止您修改它们，只要它们公开了修改它们所需的方法。您仍然仅限于更改它们的值，而不是它们的引用（即您可以修改对象本身，但不能将其更改为另一个对象）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T13:42:02.950

java中没有像C++那样的参考。

如果要修改列表对象，则必须以老式方式处理向量：

```
for (int = 0; i < vector.size(); i++) {
Object oldObject = vector.get(i);
vector.set(i, newObject);
} 
```

但是如果你想修改对象的内容，一个 foreach 就可以了：

```
for (SomeObject o : list) {
o.setName("foo");
} 
```

# android - 如何拆分Android上任何应用程序的显示屏幕？

> ID：12653082
> 
> 赞同：0
> 
> 时间：2012-09-29T13:27:37.170
> 
> 标签：android, screen

我正在寻找一种方法将我的 android 屏幕拆分为我下载的应用程序上的两个相同（或不同）部分，但我无法访问其中的源代码。基本上，无论您在手机上走到哪里，都会看到分屏。

在主屏幕上应用一个转换矩阵是完美的，但我找不到任何 API 来做这样的事情。我发现这个应用程序可以进行着色：

[https://play.google.com/store/apps/details?id=com.kovit.p.filteryourscreen](https://play.google.com/store/apps/details?id=com.kovit.p.filteryourscreen)

如果他们使用转换矩阵来做到这一点，则意味着可以随心所欲地旋转、模糊或拆分屏幕。

你认为有可能吗？如果有人能指导我实现这一目标的总体方向，那将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:42:08.037

> 基本上，无论您在手机上走到哪里，都会看到分屏。

这是不可能的，除非：

*   下载安卓源代码
*   对操作系统进行大量修改，假设一次只能有一个活动可以从输入的角度来看*前景*
*   根据修改后的源代码创建修改后的 ROM
*   在您的设备上安装修改后的 ROM

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:02:54.283

您提到的应用程序使用`DISPLAY SYSTEM-LEVEL ALERTS`允许他们显示始终在所有其他窗口前面的特殊类型的窗口的权限。

我想，它们跨越了这样一个窗口全屏，使其或多或少透明并添加配置的过滤器并将所有触摸事件等“通过”窗口传递给后面的窗口。

但是他们不会修改后面的窗口，因此它与您试图实现的目标完全不同，而根据 CommonsWare 的说法，这是不可能的。

# asp.net - 从下拉列表中获取值到 Ajax 自动完成事件

> ID：12653083
> 
> 赞同：1
> 
> 时间：2012-09-29T13:27:42.413
> 
> 标签：asp.net, ajax

我在下拉列表中有国家/地区列表，我想将表名与文本框的自动完成事件绑定，如下所示：

```
[System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] sql(string prefixText, int count, string contextKey)
    {

        SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["conx"].ConnectionString);
        con.Open();
        DataSet ds = new DataSet();
        SqlDataAdapter ad = new SqlDataAdapter("SELECT [city_name]FROM [pinfo].[dbo].["+ddl_country.selecteditem.text+"]", con);
        ad.Fill(ds, "data");
        con.Close();
        string[] main= new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count-1; i++)
        {
            if (ds.Tables[0].Rows[i].ItemArray[0].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main,main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[0].ToString();
                if (main.Length == 20)
                    break;
            }

        }
        Array.Sort(main);
        return main;

        //return default(string[]);
    } 
```

尤其

这条线

```
 SqlDataAdapter ad = new SqlDataAdapter("SELECT [city_name]FROM [pinfo].[dbo].["+ddl_country.selecteditem.text+"]", con); 
```

我想要上面字符串中的下拉值。

# c++ - 计算帕斯卡三角形中一行的总数？

> ID：12653087
> 
> 赞同：4
> 
> 时间：2012-09-29T13:28:27.290
> 
> 标签：c++, math, pascals-triangle

我一直在尝试在 C++ 中计算帕斯卡三角形中的第 1500 行。

我尝试了来自整个网络的超过 6 个不同的代码片段。

他们中的一些人在第 10 排之前坠毁，一些人发疯了等等。

如何计算帕斯卡三角形中第 1500 行的数字总数。

我认为必须有一个公式来找到一行而不迭代每一行，因为迭代会导致程序崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T13:35:01.520

任何行中的数字之和等于行的`2 ^ n`位置`n`（从 0 开始）。所以在你的情况下，它只是`1 << 1499`.

![在此处输入图像描述](../Images/ac8ea10387c58f24427b7de28b65fed9.png)

您的回答如下：

> 17537331055217019373813793980140428996762007940165414412037899012395481925281661101828540443292484630826575203397718758699647274470734979877085519459002350423944978242664548632243401355791731473268341092170069314725677729132473171262691809694657480322332526275875721167754624586680565177898054854942790337156977105108828923716313380366502376637658596066837351781686391648520996613526331666834254976000087526677764529440217091269193357761841856604274688

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T13:34:25.477

谷歌搜索从 wiki 显示：

> 帕斯卡三角形第 n 行的元素之和是 2 的 n 次方。

因此，您必须计算 2^1500 而不是尝试遍历所有行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T13:35:03.510

帕斯卡三角形的行和是`1<<n`n 是行号（从零开始）。您的最终值为`1<<1499`.

所以你的程序需要显示一个 1500 位的整数，这应该是主要问题。要产生二进制输出，请使用

```
printf("1"); 
for (int i=1;i<1500;i++) printf("0");
printf("\n"); 
```

# php - 如何创建动态“$stop1=$_POST['stop1'];” 用于在表中插入数据的变量和 mysql 查询

> ID：12653093
> 
> 赞同：0
> 
> 时间：2012-09-29T13:28:57.950
> 
> 标签：php, phpmyadmin

```
if(isset($_POST['id'])) {
    $id=$_POST['id'];
    echo $id;

    $busnumber=$_POST['busnumber'];
    $status=$_POST['status'];
    $startpoint=$_POST['startpoint'];
    $stop1=$_POST['stop1'];
    $stop2=$_POST['stop2'];
} 
```

我想创建动态`$stop2=$_POST['stop2'];`和 mysql 查询：

```
$sql = mysql_query("
   UPDATE fromto 
   SET busNumber='$busnumber', status='$status', startPoint='$startpoint', 
     stop1='$stop1', stop2='$stop2', stop3='$stop3', stop4='$stop4', 
     stop5='$stop5', stop6='$stop6', stop7='$stop7'............... 
   WHERE id=$id
"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:37:00.510

您需要评估所有变量以检查哪些是有效的 SQL 字段。在最一般的情况下，您可能拥有不同的 POST 名称和 SQL 名称。

那时您甚至不需要设置变量。

我加了一张`escape`支票，因为有人寄给你，比如说，

```
'; -- 
```

作为 的值`busNumber`，您的查询将变为：

```
UPDATE table SET busNumber=''; --', status=... 
```

并且由于“--”开始注释，MySQL 会看到：

```
UPDATE table SET busNumber=''; -- *all the rest ignored* 
```

然后会*在整个表中*`busNumber`破坏该列。你不希望这种情况发生。PDO 是有助于防止此类问题的功能的一个很好的替代方案。*`mysql_*`*

 *无论如何，你使用`mysql_*`，所以：

```
$id = (int)$_POST['id'];

$fields = array( // ALL FIELDS EXCEPT ID
   'status' => 'status',
   ...
);

$update = array();
// Since we're not using PDO we have to do a small check ourselves
foreach($fields as $sql => $post)
{
    if (!isset($_POST[$post]))
        $value = 'NULL';
    else
    {
        // If you want to set the variable:
        // ${$post} = $value;
        // or
        // ${$sql} = $value;

        $value = mysql_real_escape($_POST[$post]);
        if (!is_numeric($value))
            $value = "'$value'";
    }
    $update[] = "$sql = $value";
}

$query = "UPDATE table SET " . implode(',', $update) . " WHERE id=$id";

mysql_query($query); 
```

`stop*`此外，通过删除列并将它们放在另一个表中来规范化模式可能很有用（性能方面和维护方面） ：

```
CREATE TABLE busStops {
    id_bus    integer,
    active    boolean,
    seq_no    integer,
    name      varchar(200)
}; 
```

甚至

```
CREATE TABLE busStops {
    id        integer not null primary key auto_increment,
    name      varchar(200)
    // other geographical information
};

CREATE TABLE bus_has_stop {
    id_bus    integer,
    id_stop   integer,
    sequenc   integer,
} 
```

因此，如果您例如将站点从“Street 1 and Street 2”重命名为“Streets 1-2”，重命名将自动影响所有在此停靠的公交车，依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T13:31:33.077

您可以使用***[extract](http://php.net/manual/en/function.extract.php)***， `extract($_POST)`提供您想要的一切。

```
if(isset($_POST['id'])) {
  extract($_POST);
  // ... 
```

但不要忘记转义用户输入。

```
if(isset($_POST['id'])) {
  extract(array_map('mysql_real_escape_string', $_POST));
  // ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T13:41:36.140

你可以试试

```
$_POST['stop1'] = "xx";
$_POST['stop2'] = "vv";
$_POST['stop3'] = "33v";
$_POST['stop555'] = "55";
$_POST['stop777'] = "77";

$busnumber = $status = $startpoint = $id = 33;

$sql = "UPDATE fromto SET busNumber='$busnumber', status='$status', startPoint='$startpoint'";
$sql .= getStop();
$sql .= "WHERE id=$id";

echo $sql; 
```

输出

```
UPDATE fromto SET busNumber='33', status='33', startPoint='33'stop1 = 'xx' ,stop2 = 'vv' ,stop3 = '33v' ,stop555 = '55' ,stop777 = '77' WHERE id=33 
```

使用的功能

```
function getStop() {
    $stop = array_filter($_POST, function ($var) {
        return strpos($var, "stop") == 0;
    });
    array_walk($stop, function (&$var, $key) {
        $var = mysql_real_escape_string($var);
        $var = $key . " = '$var' ";
    }, $stop);
    return implode(",", $stop);
} 
```*

# sencha-touch - 如何搜索嵌套列表

> ID：12653096
> 
> 赞同：1
> 
> 时间：2012-09-29T13:29:14.227
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我正在尝试将搜索栏添加到嵌套列表中。当我使用 console.log 尝试它时，添加了搜索栏并且工作正常它找到了我正在寻找的记录，但我无法弄清楚如何“刷新”嵌套列表以仅显示搜索结果。如果我使用“mystore.load()”，它会将我带回根节点。

```
Ext.define('Sencha.controller.FileList', {
       extend: 'Ext.app.Controller',
       requires: [
                  'Ext.MessageBox'
                  ],
config: {
       refs: {
            homeBtn: 'button[iconCls=home]',
            searchField: 'searchbar'
       },

       control: {
            'button[iconCls=home]': {
                tap: 'onbtnHomeTap'
            },
            'searchField' : {
                    action : 'onKeyUp'
            }         
       }
},

       onbtnHomeTap: function () {
       console.log('bthome tapped');
        //reloads the list! 
            Ext.getCmp('myList').getStore().load();
       console.log(Ext.getCmp('searchfield').getValue());
       },
       onKeyUp: function(field) {
              console.log('inside searchbar_event');
               /* this.doFilter({
                     q: field.getValue()
                });*/

             Ext.getStore('NestedListStore').findRecord('text', field.getValue());

       },

       /**
        * @private
        * Listener for the 'filter' event fired by the listView set up in the 'list' action. This simply
        * gets the form values that the user wants to filter on and tells the Store to filter using them.
        */
       doFilter: function(values) {
       var store = Ext.getStore('NestedListStore'),
       filters = [];

       Ext.iterate(values, function(field, value) {
                   filters.push({
                                property: field,
                                value   : value
                                });
                   });

       store.clearFilter();
       store.filter(filters);
       store.load();
       }
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:33:02.153

好的人们，我回答了我自己的问题：

一个简单的

```
Ext.getCmp('yourNestedListID').goToNode( Ext.getStore('NestedListStore').findRecord('text', field.getValue())); 
```

成功了希望这对其他人有帮助。

# php - 在 Symfony2（2.1 分支）中嵌入图像集合的实体的表单和控制器问题

> ID：12653097
> 
> 赞同：0
> 
> 时间：2012-09-29T13:29:17.093
> 
> 标签：php, forms, symfony

自上周以来，我一直在尝试解决这个奇怪的问题，但我仍然没有找到任何解决方案，所以我决定在这里提问。

为了更好地理解，我将简要介绍我的模型：

我有一个名为 Ruta 的实体，它有一组图像。Ruta 中的每个图像都称为 ImagenRuta，它具有一些属性，包括拥有 ImagenRuta 的实体 Ruta。（一对多关系）

你可以在这里看到我的实体 Ruta：[https ://gist.github.com/b0ae0daaeebe4b6323d0](https://gist.github.com/b0ae0daeaebe4b6323d0)

我的实体 ImagenRuta 在这里： [https ://gist.github.com/9064fb2b5f4138423471](https://gist.github.com/9064fb2b5f4138423471)

我的问题是，我无法从控制器更新任何 Ruta，而不会丢失有关 Ruta 拥有的 ImagenRuta 集合中的项目的信息。特别是 ImagenRuta 的属性“imagen”设置为空。其他属性（如 ImagenRuta 的 id 或 Ruta 的 id）不会丢失。

我认为问题可能与 ImagenRuta 形式的“imagen”类型文件有关。因为如果我将该字段设置为文本，实体 ImagenRuta 的属性“imagen”不会丢失在我要更新的 Ruta 具有的集合的任何 ImagenRuta 中。

这是我的 ImagenRuta 的表格：[https ://gist.github.com/0409c630b8c9b3b08068](https://gist.github.com/0409c630b8c9b3b08068)

和我的 Ruta 表格： http: [//gist.github.com/74db6231a2b238995fff](http://gist.github.com/74db6231a2b238995fff)

这是我为注意文本字段问题而编写的代码：

```
class ImagenRutaType extends AbstractType {        
    public function buildForm(FormBuilderInterface $builder, array $options) {          
        $builder->add('imagen', 'text', array('required' => true));    
    }        
} 
```

我使用下面的句子来恢复实体 Ruta 中的原始 ImagenRuta 集合，然后通过执行使用表单信息修改该实体`$form->bindRequest($request)`：

```
$anterior = $editForm->getData(); // get ruta entity in form    
$originalImages = $anterior->getImagenes(); // get ImagenRuta collection 
```

然后我将 $originalImages 与 $editForm 包含的 ImagenRuta 集合合并

```
$entity = $em->getRepository('RutasBundle:Ruta')->find($id);    
$editForm = $this->createForm(new RutaType(), $entity);    
$editForm->bind($request);    
$imagenesNuevas = $entity->getImagenes()    
// Merge $imagenesNuevas with $originalImages to not to lose any image 
```

问题是我无法恢复 Ruta 之前的 ImagenRuta 集合，因为当我执行时：

```
$originalImages  = $ anterior-> getImagenes() 
```

在`$originalImages`我有这个集合，是的，但是那个集合中的所有 ImagenRuta 都将“imagen”字段设置为 null（其他没有），我不知道为什么。正如我上面所说，我认为它可能与 ImagenRuta 表单中的“imagen”字段是“文件”类型有关，因为当这种情况发生时，我没有从表单修改的每个 imagenRuta 都会通过“imagen”字段集到达控制器为空。

请参阅我的控制器中的 updateAction 以获取更多详细信息：[https ://gist.github.com/46e6d0d2f9e188f44030](https://gist.github.com/46e6d0d2f9e188f44030)

我已经阅读了很多教程、博客、论坛和官方食谱文档，但我没有找到任何解决方案。我希望有人能帮助我。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:46:43.557

您的问题是您使用实体的单个属性来保存保存到数据库的图像的值和在表单中上传的文件对象。您应该有两个不同的属性，一个持久化到数据库并保存您的图像文件名或路径，另一个不持久化的属性将用于您的表单文件字段。请参阅此食谱条目以获取更多信息：

[http://symfony.com/doc/current/cookbook/doctrine/file_uploads.html](http://symfony.com/doc/current/cookbook/doctrine/file_uploads.html)

# tcl - 使用 TCL 从文件中替换无法识别的字符

> ID：12653100
> 
> 赞同：3
> 
> 时间：2012-09-29T13:29:23.903
> 
> 标签：tcl

我正在编写一个脚本来读取文件并替换一些包含无法识别字符的字符，例如

```
"^H^H^H^H^H^H^H^H^H" 
```

实际上这个文件是通过重定向 telnet 会话的控制台输出生成的。我想删除这个字符。我必须从文件中删除**“---More---”**。

我尝试使用替换它们

```
set fileID [open "bar" r]
set temp [open "temp.txt" w+]
while {[eof $fileID] != 1} {
    gets $fileID lineInfo
    regsub -all "More" $lineInfo "" lineInfo
    regsub -all "--More--" $lineInfo "" lineInfo  #This is not working
    puts $temp $lineInfo
} 
```

我可以删除“更多”，但无法删除“--More--”。有人可以解释一下吗？

我也试过喜欢

```
regsub -all "^H^H^H^H^H^H^H^H^H" $lineInfo "" lineInfo  #This is also not working 
```

这也行不通。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T15:07:10.657

我建议`:print:`在您的正则表达式中使用字符类来匹配所有“合理”字符——请参阅[`re_syntax`手册页](http://www.tcl.tk/man/tcl8.5/TclCmd/re_syntax.htm#M31)。

结果调用`regsub`应该用空字符串替换所有不可打印的字符，所以我们使用否定字符类（via `^`），所以正确的咒语应该是这样的：

```
set lineInfo [regsub -all {[^[:print:]]} $lineInfo ""] 
```

至于删除“--More--””——我有两个假设：

*   `regsub``--More--`当它以破折号开头时，将其视为开关感到困惑。这可以通过在所有开关之后传递到来轻松修复`--`-`regsub`请参阅[手册页](http://www.tcl.tk/man/tcl8.5/TclCmd/regsub.htm#M12)。
*   您在文件中出现的“--More--”并不是真正的实心字符串，并且其中嵌入了某些不可打印的字符。调试此类情况的常用方法是使用 HEX 转储`xxd`器或 HEX 编辑器/查看器检查文件。

# sql - APPLY - 加入函数时是否专门使用

> ID：12653102
> 
> 赞同：4
> 
> 时间：2012-09-29T13:29:32.683
> 
> 标签：sql, sql-server

操作员`APPLY`不是我有任何使用经验的操作员，我担心我会错过某些可能性。

[Alexander Kuznetsov 的这篇文章给出了一个很好的例子](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2012/06/06/yet-another-use-of-outer-apply-in-defensive-programming.aspx)

在亚历山大的例子中，他用来`APPLY`加入函数的返回 - 是否有其他情况`APPLY`，`CROSS`或者`OUTER`应该是我使用的第一件事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:33:04.807

`APPLY`可以加入任意结果集。`TOP 1`我发现通过一些排序返回行特别有用：

```
select *
from T
cross apply (
 select top 1 * from T2 order by DateTime desc
) x 
```

`APPLY`可以做任何加入可以和更多。但它不能使用连接提示。

基本上，如果一个连接就足够了，你想使用一个连接。如果您需要更多，请使用 apply，因为它使用起来有点麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T13:44:07.847

APPLY 是一个逐行运算符，它允许您`APPLY`将先前表的每一行用于函数或子查询。因此，它在以下情况下非常有用

1.  您需要 A 中每条记录中 B 的最新/最大/最小记录
2.  您需要对 A 中的每条记录运行表值函数

是的，它可以替代 JOIN，但它会在正常 JOIN 可以工作的地方表现得非常糟糕，因为您强制 SQL Server 使用逐行运算符而不是基于集合的 JOIN。

CROSS APPLY 和 OUTER APPLY 的区别与 INNER JOIN 和 OUTER JOIN 的区别一样。基本上，如果应用它的函数/子查询返回 0 条记录，则 CROSS APPLY 将删除源记录。OUTER APPLY 保留源记录。

阅读更多：[使用应用 (msdn)](http://msdn.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T16:16:57.180

基本上连接用于组合两个结果集，但 CROSS APPLY 的行为类似于循环，它获取外部表结果，然后将每一行作为参数传递给驱动表或表值函数以生成结果集。Apply CROSS APPLY 和 OUTER APPLY 有两种形式。CROSS APPLY t 只返回与驱动表或表值函数匹配的行，并且 OUTER APPLY 结果所有外部表记录和驱动表匹配尽量避免使用 apply，因为它的慢查询然后连接

# java - 无法在android上将txt文件写入手机内存

> ID：12653103
> 
> 赞同：0
> 
> 时间：2012-09-29T13:29:47.677
> 
> 标签：java, android, fileoutputstream, android-file

我试图将一个txt文件写入手机的内存。

我使用这段代码：

```
FileOutputStream out3 = null;
try { 
    out3 = new FileOutputStream(
        Environment.getRootDirectory() + "/a_directory/b.txt");
} catch (FileNotFoundException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

但我得到一个错误。它说`out3`是`null`。为什么？

当我使用`Environment.getExternalStorageDirectory()`它时它正在工作，但我想写入手机内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:20:32.270

尝试以下代码：

```
 File myExternalFile = new File(getExternalFilesDir(filepath), "file.txt");

                     try {
        FileOutputStream fos = new FileOutputStream(myExternalFile);
          OutputStreamWriter osw = new OutputStreamWriter(fos);
          osw.append(text.getEditableText().toString());
          osw.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T13:40:06.907

没有root你不能写入内存，Android OS是这样写的，以保护操作系统。取而代之的是，在用于铃声和其他个性化数据的主存储器上，有一个格式化的空间量，就像一个 sd 卡。所有机器人都被格式化为拥有或使用 SD 卡，即使 Galaxy Nexus 也有内部 SD 卡。将文件写入卡将影响更大的设备阵列。否则，您将需要 root 访问权限，并且只有 10% 的 android 设备是 root 的。

# python - 如何制作一个接受 numpy 数组、可迭代或标量的 numpy 函数？

> ID：12653120
> 
> 赞同：12
> 
> 时间：2012-09-29T13:31:56.410
> 
> 标签：python, arrays, numpy

假设我有这个：

```
def incrementElements(x):
   return x+1 
```

但我想对其进行修改，使其可以采用 numpy 数组、可迭代对象或标量，并将参数提升为 numpy 数组并将每个元素加 1。

我怎么能那样做？我想我可以测试参数类，但这似乎是个坏主意。如果我这样做：

```
def incrementElements(x):
   return numpy.array(x)+1 
```

它适用于数组或可迭代对象，但不适用于标量。这里的问题是，`numpy.array(x)`对于标量 x 会产生一些奇怪的对象，这些对象包含在一个 numpy 数组中，但不是“真正的”数组；如果我向其添加标量，则结果将降级为标量。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T13:38:00.060

你可以试试

```
def incrementElements(x):
    x = np.asarray(x)
    return x+1 
```

`np.asarray(x)`等价于`np.array(x, copy=False)`，意味着标量或可迭代对象将转换为 a `ndarray`，但如果`x`已经是 a `ndarray`，则不会复制其数据。

如果您传递一个标量并想要一个`ndarray`作为输出（不是标量），您可以使用：

```
def incrementElements(x):
    x = np.array(x, copy=False, ndmin=1)
    return x 
```

该`ndmin=1`参数将强制数组至少具有一维。`ndmin=2`至少用于 2 个维度，依此类推。您也可以使用它的等价物`np.atleast_1d`（或`np.atleast_2d`2D 版本...）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-20T00:00:56.427

只要您的函数专门使用 ufunc（或类似的东西）来隐式循环输入值，Pierre GM 的答案就很好。如果您的函数需要*迭代*输入，那么`np.asarray`就做得不够，因为您不能迭代 NumPy 标量：

```
import numpy as np

x = np.asarray(1)
for xval in x:
    print(np.exp(xval))

Traceback (most recent call last):
  File "Untitled 2.py", line 4, in <module>
    for xval in x:
TypeError: iteration over a 0-d array 
```

如果您的函数需要遍历输入，则可以使用`np.atleast_1d` 和`np.squeeze`（请参阅[数组操作例程 — NumPy 手册](https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html)）。我包含了一个`aaout`("Always Array OUT") 参数，因此您可以指定是否希望标量输入产生单元素数组输出；如果不需要，它可以被丢弃：

```
def scalar_or_iter_in(x, aaout=False):
    """
    Gather function evaluations over scalar or iterable `x` values.

    aaout :: boolean
        "Always array output" flag:  If True, scalar input produces
        a 1-D, single-element array output.  If false, scalar input
        produces scalar output.
    """
    x = np.asarray(x)
    scalar_in = x.ndim==0

    # Could use np.array instead of np.atleast_1d, as follows:
    # xvals = np.array(x, copy=False, ndmin=1)
    xvals = np.atleast_1d(x)
    y = np.empty_like(xvals, dtype=float)  # dtype in case input is ints
    for i, xx in enumerate(xvals):
        y[i] = np.exp(xx)  # YOUR OPERATIONS HERE!

    if scalar_in and not aaout:
        return np.squeeze(y)
    else:
        return y

print(scalar_or_iter_in(1.))
print(scalar_or_iter_in(1., aaout=True))
print(scalar_or_iter_in([1,2,3]))

2.718281828459045
[2.71828183]
[ 2.71828183  7.3890561  20.08553692] 
```

当然，对于求幂，您不应该像这里那样显式迭代，但是使用 NumPy ufunc 可能无法表达更复杂的操作。如果您*不需要*迭代，但希望对标量输入是否产生单元素数组输出进行类似控制，则函数的中间部分可能更简单，但返回必须处理`np.atleast_1d`：

```
def scalar_or_iter_in(x, aaout=False):
    """
    Gather function evaluations over scalar or iterable `x` values.

    aaout :: boolean
        "Always array output" flag:  If True, scalar input produces
        a 1-D, single-element array output.  If false, scalar input
        produces scalar output.
    """
    x = np.asarray(x)
    scalar_in = x.ndim==0

    y = np.exp(x)  # YOUR OPERATIONS HERE!

    if scalar_in and not aaout:
        return np.squeeze(y)
    else:
        return np.atleast_1d(y) 
```

我怀疑在大多数情况下，该`aaout`标志不是必需的，并且您总是希望标量输出和标量输入。在这种情况下，回报应该是：

```
 if scalar_in:
        return np.squeeze(y)
    else:
        return y 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-03T00:37:52.543

这是一个老问题，但这是我的两分钱。

尽管 Pierre GM 的答案效果很好，但它具有将标量转换为数组的——可能是不受欢迎的——副作用。如果那是您想要/需要的，请停止阅读；否则，继续。虽然这可能没问题（并且可能有利于`lists`返回`iterables`a `np.array`），但可以说对于标量它应该返回一个标量。如果这是所需的行为，为什么不遵循 python 的[EAFP](https://docs.python.org/2/glossary.html#term-eafp)哲学。这是我通常做的（我更改了示例以显示`np.asarray`返回“标量”时可能发生的情况）：

```
def saturateElements(x):
    x = np.asarray(x)
    try:
        x[x>1] = 1
    except TypeError:
        x = min(x,1)
    return x 
```

我意识到它比 Pierre GM 的回答更冗长，但正如我所说，如果传递了一个标量，这个解决方案将返回一个标量，或者 a`np.array`是一个数组或传递了 iterable。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-03T00:16:33.867

现有的解决方案都有效。这是另一种选择。

```
def incrementElements(x):
    try:
        iter(x)
    except TypeError:
        x = [x]
    x = np.array(x)
    # code that operators on x 
```

# perl - 多级 perl 哈希

> ID：12653127
> 
> 赞同：0
> 
> 时间：2012-09-29T13:32:51.670
> 
> 标签：perl, hash

当我使用 Dumper 时，我有一个如下所示的哈希。我想遍历每个级别并单独打印所有内容。

```
$VAR1 = {
          'TP144' => {
                          'LNDN CDR' => [
                                            'NAME   XYZ
                        FNAME   ABC
                        STATUS  MARIED
                        TEST   "THIS IS TEST"
                        TEMP!VALUE   0'
                                        ], 
```

它看起来是这样的：L2 的值本身就是一个数组。

```
$VAR1{L1}{L2}=>ARRAY 
```

任何帮助表示赞赏。

提前致谢

编辑：谢谢马特，我在那个链接中找到了答案。这就是我的做法。

```
foreach $L1 ( sort keys %VAR1 ) {
     print "$L1: { ";
     for $L2 ( sort keys %{ $VAR1{$L1} } ) {
         foreach  (@{$VAR1{$L1}{$L2}})
         {
             print $_."\n";
         }

     }
     print "}\n";
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:17:26.113

最简单的方法是递归地这样做。

*   检查您对递归子的输入。

    *   如果您的输入是标量，请打印

    *   如果您的输入是 n arrayref，则遍历每个元素并使用您的子递归打印该元素

    *   如果您的输入是 hashref，则循环遍历每个键并使用您的 sub 递归地打印该键的值。

完毕

# gwt - 测试异步 rpc

> ID：12653132
> 
> 赞同：2
> 
> 时间：2012-09-29T13:33:36.097
> 
> 标签：gwt, testing, proxy, sync, rpc

这里有人使用 GWT SyncProxy 吗？
我尝试测试一个异步rpc，但是onFailure和onSuccess下的代码没有测试。不幸的是，没有错误日志，但也许有人可以帮助我。该示例来自此页面：[http ://code.google.com/p/gwt-syncproxy/](http://code.google.com/p/gwt-syncproxy/)

编辑：
我希望测试失败。所以我添加了'assertNull(result);'。奇怪的是控制台给出的结果首先是“异步好”，然后是“异步坏”。所以函数运行了两次？！Junit 给出了绿色的结果。

```
public class Greeet extends TestCase {
@Test
public void testGreetingServiceAsync() throws Exception {
      GreetingServiceAsync rpcServiceAsync = (GreetingServiceAsync) SyncProxy.newProxyInstance(
        GreetingServiceAsync.class, 
        "http://127.0.0.1:8888/greettest/", "greet");

      rpcServiceAsync.greetServer("SyncProxy", new AsyncCallback<String>() {
        public void onFailure(Throwable caught) {
          System.out.println("Async bad " );
        }
        public void onSuccess(String result) {
          System.out.println("Async good " );
          assertNull(result);
        }
      });

      Thread.sleep(100); // configure a sleep time similar to the time spend by the request
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T12:20:30.920

为了使用 gwt-syncproxy 进行测试：

1.  你必须启动 gwt 服务器：'mvn gwt:run' 如果你使用的是 maven，或者'project -> run as -> web app' 在你使用 eclipse 的情况下。
2.  您必须设置服务的 url，通常是 'http://127.0.0.1:8888/your_module'。请注意，在您的示例中，您使用的是应用程序 html 的 url。
3.  如果您测试异步，则必须等到调用完成，因此在您的情况下，您需要在方法结束时使用 Thread.sleep(sometime) 。
4.  如果您测试同步，则不需要睡眠。

这是两个示例测试用例：

*同步测试*

```
public void testGreetingServiceSync() throws Exception {
  GreetingService rpcService = (GreetingService)SyncProxy.newProxyInstance(
     GreetingService.class, 
    "http://127.0.0.1:8888/rpcsample/", "greet");
  String s = rpcService.greetServer("SyncProxy");
  System.out.println("Sync good " + s);
} 
```

*异步测试*

```
boolean finishOk = false;
public void testGreetingServiceAsync() throws Exception {
  GreetingServiceAsync rpcServiceAsync = (GreetingServiceAsync) SyncProxy.newProxyInstance(
    GreetingServiceAsync.class, 
    "http://127.0.0.1:8888/rpcsample/", "greet");

  finishOk = false;
  rpcServiceAsync.greetServer("SyncProxy", new AsyncCallback<String>() {
    public void onFailure(Throwable caught) {
      caught.printStackTrace();
    }

    public void onSuccess(String result) {
      assertNull(result);
      finishOk = true;
    }
  });

  Thread.sleep(100);
  assertTrue("A timeout or error happenned in onSuccess", finishOk);
} 
```

# asp.net-mvc-4 - 如何将umbraco与mvc4集成

> ID：12653133
> 
> 赞同：2
> 
> 时间：2012-09-29T13:33:35.653
> 
> 标签：asp.net-mvc-4, umbraco

我目前正在 IIS7.5 上使用 MVC4 开发电子商务应用程序。

我想在应用程序中集成一个 CMS。通过研究众多的 CMS，我决定最适合我需要的是 Umbraco。我想使用这个 CMS 主要管理网站上的登录页面。

我对 Umbraco 的经验很少，所以需要一些帮助。将 Umbraco 集成到 MVC4 应用程序的最佳方法是什么？有教程或类似的东西可以帮助我吗？

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T10:52:03.820

Umbraco 中的 MVC 支持一直在改进，并且似乎是正在进行的项目工作的重点（根据我最近参加的二级培训课程）。目前，您可以使用[MVC Bridge](http://our.umbraco.org/projects/developer-tools/mvcbridge) Umbraco 插件集成 MVC 和 Umbraco，也可以滚动您自己的集成。

使用 MVC Bridge，您可以通过选择将 Umbraco 宏添加到模板作为“MVCRenderAction”类型并设置适当的“Action”和“Controller”属性来渲染 MVC 视图。

我认为 MVCBridge 是权宜之计 - 并且愿意等待全力支持，但您的时间表可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T07:13:55.947

我通常将 MVC 应用程序连接到 Umbraco 以呈现局部和控件。主要是 MVC 2 保持语法相同，因为我仍然更喜欢 webforms，但任何 MVC 版本都可以。

要走的路是依赖注入和 IoC。这意味着您将在 Umbraco 站点内将 MVC 应用程序作为应用程序运行。

要连接需要 Unity 容器的应用程序，我更喜欢 Microsoft Unity。

我可以写一篇 10 页长的文章，但 SO 的一些 OP 不喜欢这样，所以我将链接到博客文章（不是我的博客），它包含您需要的大部分内容。

[http://weblogs.asp.net/shijuvarghese/archive/2010/05/07/dependency-injection-in-asp-net-mvc-nerddinner-app-using-unity-2-0.aspx](http://weblogs.asp.net/shijuvarghese/archive/2010/05/07/dependency-injection-in-asp-net-mvc-nerddinner-app-using-unity-2-0.aspx)

# subdomain - 子域有什么好处？例如：uploads.mysite.com——我为什么要使用它？

> ID：12653134
> 
> 赞同：-1
> 
> 时间：2012-09-29T13:33:58.793
> 
> 标签：subdomain

我正在考虑是否应该为以下内容设置子域：api.mysite.com uploads.mysite.com

但我的问题是：我为什么要这样做，而不是将文件存储在某些文件夹中，如 /api 或 /uploads？

反馈？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:39:14.723

使用子域，您可以将不同的 IP 地址分配给在不同机器上运行的不同主机。使用相同主机名下的 URL 路径是可能的，但更难。

# android - 通过 Accessbility Service 从通知中获取意图 - Android

> ID：12653138
> 
> 赞同：1
> 
> 时间：2012-09-29T13:34:28.253
> 
> 标签：android, service, android-intent, notifications

我创建了一个无障碍服务，这样我就可以获得某些通知并将它们显示在我的应用程序中。这很好用，我使用 event.getPackageName() 来确定我是否想要显示该事件（即它是 gtalk ms​​g 等）。

但是，我也希望能够获得该通知的意图，以便我可以在我的应用程序中使用它，例如，如果它是谷歌谈话消息，点击通知通常会将我带到谈话线程。

反正有没有从通知中得到那个意图？我已经用谷歌搜索并查看了这里但没有发现任何类似的东西，我还查看了我在事件中的选项，getParceable 看起来如果可能的话它可能是我需要的，但我不确定如何处理.

任何帮助，将不胜感激。谢谢。

抢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:41:47.510

```
Notification n = (Notification) event.getParcelableData();
n.contentIntent.send(); 
```

请注意，在此示例中，事件必须是一个`Notification`事件，如果您得到任何其他事件，那么您将获得一个`ClassCastException`.

# solr - 使用 Solr 在边界框内进行地理空间搜索

> ID：12653144
> 
> 赞同：2
> 
> 时间：2012-09-29T13:35:03.473
> 
> 标签：solr, lucene, gis, geospatial

我想在边界框中搜索地图，该地图的东北点和西南点的纬度/经度可用。我有`lat`并`lng`索引为类型`TrieDoubleField`和类型。在框内搜索（而不是像 in 那样的半径）的原因是因为搜索是在矩形地图上可见的所有区域上完成的，并且我得到了地图 4 个角的坐标。`latlng``solr.LatLonType``geofilt`

**问题：**`lat`执行 2 个范围查询，一个 for和一个 for会不会效率低下`lng`？如下图所示，需要搜索很多不必要的范围。

`http://127.0.0.1:8080/solr/select?q=*:*fl=id&fq=lat:[42.2823890429 TO 42.4224427748] AND lng:[-71.3345718384 TO -70.7612228394]`

如果是这样，有没有更好的方法？

`fq={!bbox}&sfield=latlng&pt=45.15,-93.85&`**`d=5`**将不起作用，因为我无法计算`d`匹配地图边界的值。

![在此处输入图像描述](../Images/d6f2dfa230b69657fcb0abc5fa44c1a0.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T18:26:48.237

Solr 4 具有一组新的空间字段类型，您可以在其中指定经纬度边界框。这里有一些我打算在本周末更新[的信息。](http://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4)

如果您使用的是 Solr 3，那么可以，您可以像现在一样进行数字范围查询。如果您想处理日期线交叉，那么它会有点棘手，因为经度需要两对范围查询。而且“不”，正如您所问的那样，这种方法并不是低效的。顺便说一句，您不需要单独索引纬度和经度，因为 LatLonType 已经这样做了，您可以使用它的字段。查看模式浏览器，您应该会看到一个以 __x 和 __y 结尾的字段（如果我记得的话）。

# android - 仅将一项设置为列表视图的适配器

> ID：12653145
> 
> 赞同：0
> 
> 时间：2012-09-29T13:35:23.880
> 
> 标签：android, listview, arraylist, android-arrayadapter

我只想从我的自定义 ArrayList 中向适配器发送一项。活动开始时，我只发送一项。然后我想为我的 Activity 实现gestureListener，如果我检测到向上或向下滑动动作，我会向适配器发送另一个项目。我该如何实施？

我有我的自定义 ArrayAdapter，我在其中传递了我的列表。但我只想发送一件物品：

```
public class InteractionsAdapter extends  ArrayAdapter<Message>{

  Context context; 
int layoutResourceId;    
List<Message> messages = null;
private Activity activity;
public InteractionsAdapter(Context context,  int layoutResourceId,List<Message> messages) {
    super(context, layoutResourceId, messages);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.messages = messages;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    InteractionHolder holder = null;

    if(row == null)
    {

        (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        LayoutInflater inflater = (LayoutInflater)this.context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        row = inflater.inflate(R.layout.interactions_item, parent, false);

        holder = new InteractionHolder();
        holder.interactionId= (TextView)row.findViewById(R.id.interactionId);
        holder.interactionAbove = (TextView)row.findViewById(R.id.interactionAbove);
        holder.interactionBelow = (TextView)row.findViewById(R.id.interactionBelow);
        holder.interactionMessage = (TextView)row.findViewById(R.id.interactionMessage);
        holder.interactionDate = (TextView)row.findViewById(R.id.interactionDate);

        row.setTag(holder);
    }
    else
    {
        holder = (InteractionHolder)row.getTag();
    }

    Message message = messages.get(position);
    Log.i("in doinbackground",Integer.toString(messages.size()));

        Log.i("position",Integer.toString(position));

        holder.interactionId.setText(Integer.toString(message.getMessageId()));
        holder.interactionAbove.setText(Integer.toString(position));
        holder.interactionBelow.setText(Integer.toString(messages.size()-position-1));
        holder.interactionMessage.setText(message.getMessageBody());
        holder.interactionDate.setText(message.getMessageDate().toString());

    return row;
}

static class InteractionHolder
{
    TextView interactionId;
    TextView interactionDate;
    TextView interactionAbove;
    TextView interactionBelow;
    TextView interactionMessage;

}

} 
```

我试图用 ArrayAdapter 来做，只传递一项，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T07:53:00.090

我解决了我的问题，只需添加一个

```
@Override
public int getCount() {
    return 1;
} 
```

它工作正常。

# c# - 如何从另一个类构造一个类中的对象

> ID：12653146
> 
> 赞同：1
> 
> 时间：2012-09-29T13:35:26.500
> 
> 标签：c#, wpf, c#-4.0, object, c#-3.0

我在“FileData.cs”文件中声明了属性。我想为另一个类“PdfMergerViewModel.cs”中的每个属性分配值。

文件数据.cs

```
 public class FileData
        {
        private BatchData _batch;
        public FileData(BatchData batch)
        {
            this._batch = batch;
        }

        public string FileName { get; set; }
        public string VersionNormalizedFileName { get; set; }
        public string OrderNumber { get; set; }
        public DateTime OrderDate { get; set; }

        public string Metadata { get; private set; }
        public bool IsDeleted { get; set; }
        public string FilePath { get; set; }

        public string Centerpoint { get; set; }
        public string BatchID { get; set; }
        public string RegionalPrefix { get; set; }
        public string City { get; set; }
        public string FunctionLocation { get; set; }
        public string KeyMap { get; set; }
        public string State { get; set; }
        public string StreetNumber { get; set; }
        public string StreetName { get; set; }
        public string UnitNumber { get; set; }
        public string SendToGIS { get; set; }
        public string PipeBeforeFilename { get; set; }

        public IList<FileData> VersionFiles
        {
            get
            {
                return _batch.Files.Where(x => x.VersionNormalizedFileName == FileName && !x.IsDeleted).ToList();
            }
            private set { }
        } 
```

PdfMergerViewModel.cs

```
 FileData fd = new FileData(new BatchData());
        void createOutputBackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
        {
            using (StreamReader sr = File.OpenText("D:/data.txt"))
            {
                String input;

                while ((input = sr.ReadLine()) != null)
                {
                    string[] stringArray = input.Split(',');
                    for (int i = 0; i < stringArray.Count() - 1; i++)
                    {

                    }
                }
            }
        } 
```

我需要将“fd”对象放在 for 循环中，并为“FileData.cs”中的每个属性分配值。我不知道如何分配价值。给我一个解决方案。谢谢。

“Data.Txt”文件中存在多行。“Data.txt”文件中的一行如下所示：

```
"Centerpoint - Arkansas (Fixed)","Centerpoint SO - Arkansas","{$DOCUMENT ID}","61||","{$BATCH ID}","32601","{$REGIONAL PREFIX}","E","CITY","CUSHING","DATE","05/25/1945","FUNCTION LOCATION","X-SVCS","KEY MAP","","ORDER NUMBER","","STATE","AR","STREET NUMBER","819","STREET NAME","E BROADWAY","UNIT NUMBER","","SEND TO GIS","X","{$PIPE BEFORE FILENAME}","||","\\HOUKOFAX01\Client\Centerpoint Arkansas\7_9_2012\32601\819 E BROADWAY.pdf" 
```

以前使用“字典”。现在我们正在转向面向对象的方法。当存在字典项时使用以下代码。现在，我需要使用面向对象的方法来分配“FileData.cs”类中的值，而不是字典。使用字典项的代码：

```
 Dictionary<string, string> item = new Dictionary<string, string>();
            for (int i = 0; i < stringArray.Count() - 1; i++)
            {
                item.Add(RemoveQuote(stringArray[i]), RemoveQuote(stringArray[i + 1]));
                i++;
            } 
```

我需要分配值而不是字典“fd”对象。我不知道如何分配价值。给我一个解决方案。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:51:20.610

好吧，假设您在文本文件中有属性的名称和值，您可以尝试使用反射：

```
PropertyInfo propertyInfo = fd.GetType().GetProperty(propertyName);
propertyInfo.SetValue(fd, Convert.ChangeType(propertyValue, propertyInfo.PropertyType), null); 
```

**编辑：**

如果您没有属性的名称，那么它至少应该以已知的顺序组织，否则无法动态设置属性。

如果它的顺序已知，您可以检索 FileData 属性并操作它们以适应与文本文件相同的顺序。

```
PropertyInfo[] propertyInfos = typeof(FileData).GetProperties(BindingFlags.Public);

//Possible Sort

foreach (PropertyInfo propertyInfo in propertyInfos)
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:12:03.030

```
FileData fd = new FileData(new BatchData());
void createOutputBackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    using (StreamReader sr = File.OpenText("D:/data.txt"))
    {
       String input;    
       while ((input = sr.ReadLine()) != null)
       {
            string[] stringArray = input.Split(',');
            PropertyInfo[] props = typeof (FileData).GetProperties();
            for (int i = 0; i < stringArray.Count() - 1; i++)
            {
                  props[i].SetValue(fd, stringArray[i]);
            }
       }
   }
} 
```

PS 不要忘记添加对`System.Reflection`.

///////////////////////////////////////// ///////////////// 编辑 ///////////////////////// //////////////////////////////////

好吧，我认为最正确的解决方案是首先检查您的属性是什么类型，然后再进行分配。您可以使用`if`声明：

```
...
for (int i = 0; i < stringArray.Count() - 1; i++)
{
    if(props[i].GetValue(m) is DateTime)
    {
        props[i].SetValue(m, DateTime.Parse(stringArray[i]));
    }
    else
    {
        if(props[i].GetValue(m) is bool)
        {
            props[i].SetValue(m, stringArray[i].Equals("true", StringComparison.OrdinalIgnoreCase));
        }
        else
        {
             props[i].SetValue(m, stringArray[i]);
        }
    }
}
... 
```

或者更优雅，特别是如果您的班级中有超过 3 种不同的类型，则`switch`：

```
...
for (int i = 0; i < stringArray.Length; i++)
{
    object type = props[i].PropertyType;
    switch(type.ToString())
    {
         case "System.String": props[i].SetValue(m, stringArray[i]); break;
         case "System.DateTime": props[i].SetValue(m, DateTime.Parse(stringArray[i])); break;
         case "System.Boolean": props[i].SetValue(m, stringArray[i].Equals("true", StringComparison.OrdinalIgnoreCase));break;
     }
}
... 
```

注意：如您所见，您应该使用`type.ToString()`语句，因为`switch`期望整数类型的值，`props[i].GetType()`或者`props[i].PropertyType`不是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:16:57.973

首先，您需要一个 List(Of FileData) 来保存从文件转换的每一行，而不仅仅是一个 FileData 对象。然后，您应该找到从 data.txt 中读取和滑动的行与 FileData 的单个属性之间的映射。

```
 List<FileData> listOfData = new List<FileData>();
    void createOutputBackgroundWorker_DoWork(object sender, DoWorkEventArgs e) 
    { 
        using (StreamReader sr = File.OpenText("D:/data.txt")) 
        { 
            String input; 

            while ((input = sr.ReadLine()) != null) 
            { 
                FileData fd = new FileData(new BatchData()); 
                string[] stringArray = input.Split(','); 
                for (int i = 0; i < stringArray.Length - 1; i+=2) 
                { 
                     switch(stringArray[i])
                     {
                          case "{$BATCH ID}":
                             fd.BatchID = stringArray[i+1];
                             break;
                          // Other properties follow ..... 
                          case ......
                     }
                } 
                listOfData.Add(fd);
            } 
        } 
    } 
```

# html - 无法在codeigniter中加载css文件

> ID：12653147
> 
> 赞同：1
> 
> 时间：2012-09-29T13:35:30.887
> 
> 标签：html, css, codeigniter

我是 codeigniter 的新手并试图学习它，但我无法加载或使用我的 css 样式表进行布局。我加载CSS文件的方法是我在互联网上找到的，但没有奏效。请提出一些建议。

**这是我的代码**：

```
<html>

<head>
<title>homePage</title>

 <!--[if lte IE 6]>
    <style type="text/css">
    img, div { behavior: url(http('<?php echo $base_url; ?>images') }
    </style>
<![endif]-->

<!--[IF lte IE 6]>

<link rel="stylesheet" href="<?php echo $base_url; ?>/css/homestyle.css" type="text/css" />

<![endif]-->
</head>

 <body >

 <div id="page">
 <div id="menulinks">
    <a class="active" href="#"><span>Home</span></a>
    <a href="#"><span>Services</span></a>
    <a href="#"><span>About Us</span></a>
    <a href="#"><span>Contact Us</span></a>
</div>
<div id="header">

</div>
          <div class="active" id="contentarea">
  <br>
 <br> 
 </div>

 </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:42:49.767

```
<!--[IF lte IE 6]>
<link rel="stylesheet" href="<?php echo $base_url; ?>/css/homestyle.css" type="text/css" />
<![endif]--> 
```

这是一条注释，大多数浏览器不会解析里面的内容。只能在 IE 下使用。你需要把`<link>`评论放在外面：

```
<link rel="stylesheet" href="<?php echo $base_url; ?>/css/homestyle.css" type="text/css" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T18:15:14.147

包含的 HTML`<!--[if lte IE 6]>`只会被 IE6 和更早版本解析 - 这对您的行为属性非常有用，但可能对`homestyle.css`. 尝试这个：

```
 <head>
    <title>homePage</title>
    <base href="<?= $base_url;?>">
    <!--[if lte IE 6]>
        <style type="text/css">
            img, div {
                behavior: url(images);
            }
        </style>
    <![endif]-->
    <link rel="stylesheet" href="css/homestyle.css" type="text/css" />
</head> 
```

## 评论后编辑：

好吧，我假设您已经从您的问题中定义了该变量。进入`config/autoload.php`并将`'url'`密钥添加到`$autoload['helper']`数组中：

例如：`$autoload['helper'] = array('url', 'file', 'your_other_helpers...');`

然后将上面的 HTML 更改为`<base href="<?= site_url();?>">`

# php - 如何在php的prepare语句中绑定参数？

> ID：12653149
> 
> 赞同：0
> 
> 时间：2012-09-29T13:35:47.453
> 
> 标签：php, mysqli, prepared-statement, sqlbindparameter

我想在准备语句中发送数组值，但它不起作用

我的代码是：

```
for($bb=0; $bb<sizeof($subject_temp_array)-1; $bb++)
 {
    $sql ="select * from tbl_subjects where sub_id = ?";
    if ($result = $mysqli->prepare($sql)) 
    {
       $subject_id = $subject_temp_array[$bb];
       $result -> bind_param("i",$subject_id); 
       $result->execute();
       $result->store_result();
       $rows1 = $result->num_rows;
     }
  } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-29T13:44:50.187

为什么不使用foreach？另外，您是否遇到任何错误消息？试试这个代码：

```
error_reporting(-1);
ini_set('display_errors', 1);

foreach($subject_temp_array as $subject_id)
{
    $sql = "select * from tbl_subjects where sub_id = ?";
    if ($result = $mysqli->prepare($sql)) 
    {
       $result->bind_param("i", $subject_id); 
       $result->execute();
       $result->store_result();
       $rows1 = $result->num_rows;
     } else {
         throw new Exception("Error preparing query.");
     }
} 
```

# ios - 更新托管应用程序和 App Lock Payload

> ID：12653150
> 
> 赞同：3
> 
> 时间：2012-09-29T13:35:52.777
> 
> 标签：ios, ipad, ios6, mdm

一个新的[iOS6 配置文件参考](http://developer.apple.com/library/ios/#featuredarticles/iPhoneConfigurationProfileRef/Introduction/Introduction.html)定义了一个新的**App Lock Payload**。它允许将 iPad 锁定到单个应用程序（信息亭模式）。

是否可以使用移动设备管理 (MDM) 即时更新此类应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T22:49:22.603

我会说不。App Lock 旨在限制对操作系统其余部分的访问。允许用户接受升级他们被锁定的应用程序的提示可能会给他们访问权限（如果升级失败怎么办？如果应用程序需要很长时间才能下载怎么办？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T13:03:10.433

Jamf 正是通过他们的 Casper Focus 产品（和他们的 JSS MDM）做到了这一点，所以答案是肯定的。有关详细信息，请参见此处：[http ://www.jamfsoftware.com/products/casper-focus](http://www.jamfsoftware.com/products/casper-focus)

我能看到的唯一缺点是，如果 Apple 的推送通知服务 (APNS) 出现故障，设备将保持锁定在应用程序中。如果应用程序只需要在特定时间段内锁定，您可以通过在配置文件中设置到期日期（使用 RemovalDate 或 DurationUntilRemoval 键）来避免这个难题，以确保在某个时候解除锁定。

# php - Magento 货运跟踪

> ID：12653153
> 
> 赞同：3
> 
> 时间：2012-09-29T13:36:19.617
> 
> 标签：php, magento

我是 Magento 的新手。

我想以 CSV 格式从订单表中导出以下数据。在我的示例数据库中，我没有 Shipment Tracking number 的记录，所以不知道它存储在哪个表中

请给一些建议。

要导出的数据是

1.  订单号
2.  收件地址
3.  航运城
4.  装运状态
5.  运输邮编
6.  电话号码
7.  追踪号码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T16:05:08.630

你可以试试[这个免费的扩展](http://www.magentocommerce.com/magento-connect/blue-jalappeno-order-export-7914.html)，它导出的比你需要的多，但任何电子表格都可以在之后轻松删除列。

如果您更喜欢直接使用数据库，那么您可能会使用以下内容：

```
SELECT orders.increment_id, address.street, address.city, address.region,
       address.postcode, address.telephone, track.track_number
-- prior to 1.6 `track_number` should be `number`
FROM sales_flat_order AS orders
JOIN sales_flat_order_address AS address ON address.parent_id = orders.entity_id
JOIN sales_flat_shipment_track AS track ON track.order_id = orders.entity_id
WHERE address.address_type = 'shipping' 
```

# android - 根据textivew的大小调整图片大小

> ID：12653155
> 
> 赞同：3
> 
> 时间：2012-09-29T13:36:44.577
> 
> 标签：android, android-image

我有一个`TextView`我正在设置图像的地方`drawableLeft`

```
<TextView
   android:id="@+id/imgChooseImage"
   android:layout_width="fill_parent"
   android:layout_height="0dp"
   android:layout_weight="3"
   android:background="@drawable/slim_spinner_normal"
   android:drawableLeft="@drawable/ic_launcher"/> 
```

我只想知道我应该用java代码写什么来动态替换新图像，这样图像就不会超过`TextView`可绘制的左图像中看起来不错的图像。

我应该使用`scalefactor`什么？

```
int scaleFactor = Math.min(); 
```

下面是java代码

```
BitmapFactory.Options bmOptions = new BitmapFactory.Options();
// If set to true, the decoder will return null (no bitmap), but
// the out... fields will still be set, allowing the caller to
// query the bitmap without having to allocate the memory for
// its pixels.
bmOptions.inJustDecodeBounds = true;
int photoW = hListView.getWidth();
int photoH = hListView.getHeight();

// Determine how much to scale down the image
int scaleFactor = Math.min(photoW / 100, photoH / 100);

// Decode the image file into a Bitmap sized to fill the View
bmOptions.inJustDecodeBounds = false;
bmOptions.inSampleSize = scaleFactor;
bmOptions.inPurgeable = true;
Bitmap bitmap = BitmapFactory.decodeResource(getResources(), Const.template[arg2],bmOptions);

Drawable draw = new BitmapDrawable(getResources(), bitmap);

/* place image to textview */
TextView txtView = (TextView) findViewById(R.id.imgChooseImage);
txtView.setCompoundDrawablesWithIntrinsicBounds(draw, null,null, null);
position = arg2; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:38:35.953

您正在寻求一种计算`TextView`布局后精确高度的方法，以便您可以调整`drawableLeft`属性的位图大小。这个问题因几个问题而复杂化：

1.  如果文本换行为多行，则高度可能会发生巨大变化。
2.  根据设备硬件屏幕密度，Bitmap 的渲染大小会发生变化，而与您缩放/渲染的 Bitmap 的确切大小无关，因此在计算时必须考虑屏幕密度`scaleFactor`。
3.  最后，`scaleFactor`不提供确切尺寸的图像请求。它仅将位图的大小限制为与您的请求相同或更大的最小可能图像，以节省内存。您仍然需要将图像大小调整为您计算的确切高度。

该`drawableLeft`方法无法克服上述问题，我认为有更好的方法来实现您的预​​期布局，而无需使用 Java 代码调整大小。

我相信您应该将 TextView 替换为`LinearLayout`包含 an`ImageView`和 a的水平方向`TextView`。将 TextView 的高度`"WRAP_CONTENT"`设置`scaleType`为并将 ImageView 的高度设置为“中心”，如下所示：

```
android:scaleType="center" 
```

LinearLayout 将具有 TextView 中文本的高度，而 ImageView`scaleType`将强制位图在布局期间自动调整大小。这里是可用 scaleTypes 的参考：[ImageView.ScaleType](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)。

当然，您必须在 XML 中为 LinearLayout、ImageView 和 TextView 调整布局参数，以便它们以您想要的精确方式居中、对齐和定向。但是，至少你只会做一次。

看起来您将从应用程序资源中将照片加载到 ImageView 中，您可能知道图像不是很大，因此您可以直接打开 Bitmap，或使用`inSampleSize = scaleFactor = 1`. 否则，如果图像特别大或出现`OutOfMemoryError`异常，则计算`scaleFactor`如下：

```
int inSampleSize = 1;
if (height > reqHeight || width > reqWidth) {
    if (width > height) {
        inSampleSize = Math.round((float) height / (float) reqHeight);
    } else {
        inSampleSize = Math.round((float) width / (float) reqWidth);
    }
} 
```

# ios - dlopen 有没有办法在 iOS 上重新加载 dylib 文件？

> ID：12653167
> 
> 赞同：7
> 
> 时间：2012-09-29T13:38:26.073
> 
> 标签：ios, dylib, dlopen

正如标题所说...我感兴趣`dlopen()`。我知道应用商店不允许这样做，但我对 iOS 上的这一点很好奇。

我遇到的问题是我可以创建一个 .dylib 文件，并且可以在运行时使用以下代码加载该文件

```
char *dylibPath = "/Applications/myapp.app/mydylib2.dylib";

void *libHandle = dlopen(dylibPath, RTLD_NOW);
if (libHandle != NULL) {
    NSString * (*someMethod)() = dlsym(libHandle, "someMethod");
    if (someMethod != NULL)  {
        NSLog(someMethod());
    }
    dlclose(libHandle);
} 
```

这是取自[这里](https://stackoverflow.com/questions/4733847/can-you-build-dynamic-libraries-for-ios-and-load-them-at-runtime/10509453#10509453)。

我遇到的问题是，如果我更改 mydylib2.dylib，`dlopen`则不会加载重新编译的 .dylib 文件。相反，它解析了旧版本的函数`someMethod`。

例如，如果`someMethod`first 返回`@"Hello"`并且我将其更改为`@"Hello World"`并重新编译，则上面的代码将始终返回`@"Hello"`，直到我在模拟器中重新启动应用程序。

有谁知道为什么会这样？并建议一种解决方法，以便可以在运行时重新加载这个 .dylib？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:03:34.510

查看[手册页](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dlclose.3.html)`dlclose`似乎有几个原因导致库不会被卸载。

> 有一些动态库永远不会被卸载的情况：1）针对它的主要可执行链接，2）使用不支持卸载的 API（例如 NSAddImage()）来加载它或其他一些动态库这取决于它，3）动态库在dyld的共享缓存中。

我怀疑您的问题是“dyld 共享缓存”。您可以尝试运行：

```
sudo update_dyld_shared_cache -force 
```

在您更换了图书馆之后（不确定这是否在 iOS 上可用）。

你检查过返回值`dlclose`是成功还是失败？

# trigger.io - iOS6 和 XCode 4.5 - 无法将应用上传到应用商店

> ID：12653168
> 
> 赞同：2
> 
> 时间：2012-09-29T13:38:41.293
> 
> 标签：trigger.io, forge

我做了一些更改并准备将我的应用程序的更新版本上传到我使用 trigger.io 构建的应用程序商店

应用程序加载器显示此错误消息：

“iPhone/iPod Touch：应用程序可执行文件缺少所需的架构。必须至少存在以下架构之一：armv6”

也许答案就在这里：[验证 iPhone 应用程序存档](https://stackoverflow.com/questions/10540848/validating-an-iphone-app-archive)？

我过去曾成功地将应用程序提交到 Apple 应用商店……但是，自从升级到 iOS6 后，我不能。我究竟做错了什么？这是 trigger.io 的构建设置问题吗？

这是一个屏幕截图：![在此处输入图像描述](../Images/28621bef794892026a0b768c3789823e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T06:23:33.573

Xcode 4.5 支持`armv7 and armv7s`架构。

所以，请

```
1\. select your Build architecture as Standard (armv7 &armv7s)
2\. select deployment target as IOS 4.3 and 
3\. add the following variable in the `info.plist`:-
    Required Device capabilities with Item0 values as armv7\. 
```

这会帮助你..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T01:31:41.827

从我们的 v1.4.16 平台开始，此问题已修复：http: [//docs.trigger.io/en/v1.4/release-notes.html#v1-4-16](http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-16)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-29T14:03:55.590

看看你的构建设置。

在架构下，您可能会在列表中看到 armv6。

但是，Xcode4.5 不再为 armv6 构建二进制文件。因此，尽管您的设置表明它们正在构建，但它们不是。Application Loader 失败是因为您缺少 armv6 构建，即使您说您正在生产它。

如果您从列表中删除 armv6 并重建，此问题就会消失。

# primefaces - Primefaces跳过按钮上的表单验证

> ID：12653177
> 
> 赞同：4
> 
> 时间：2012-09-29T13:40:12.477
> 
> 标签：primefaces, validation

我正在使用 primefaces 开发向导，向导的最后一步是可选的。但是，如果他们确实希望填写最后一步，则需要一些字段。

我给了用户 2 个按钮，1 个用于保存，包括最后一步，1 个按钮用于保存前面的步骤并忽略最后一步。

所以我需要在点击第二个按钮时跳过验证。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T13:40:12.477

解决方案是添加`process="@this"`到第二个按钮。

# javascript - 一键填写多个输入字段

> ID：12653178
> 
> 赞同：0
> 
> 时间：2012-09-29T13:40:13.670
> 
> 标签：javascript, jquery

这是我的问题......我只需单击一下即可填充多个文本字段。需要点击的链接放在一个用php生成的td中，数据来自一个MySQL db（血腥的JS初学者！）。

下面的代码只是我的问题的一个简短示例。

提前致谢

```
<script type='text/javascript'>
$(function(){
    $('.click').live('click', function() {
        $("#brand").val($(this).html());
        $("#color").val('I need the color here');
        $("#size").val('and here the size');
    });
});
</script>

<label for="brand">Brand:</label><input autocomplete="off" id="brand" type="text" name="brand" />
<label for="color">Color:</label><input autocomplete="off" id="color" type="text" name="color" />
<label for="size">Size:</label>
<select id="size" name="size">
    <option>M</option>
    <option>L</option>
    <option>XL</option>
</select>

<table>
    <tr>
        <th>brand</th>
        <th>color</th>
        <th>size</th>
    </tr>
    <tr>
        <td><a href="#" class="click">nike</a></td>
        <td>red</td>
        <td>45</td>
    </tr>
    <tr>
        <td colspan="3">...more rows here...</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:10:16.353

首先，我建议更改您的标记，为颜色和大小表格单元格提供类，如下所示：

```
<tr>
    <td><a href="#" class="click">nike</a></td>
    <td class="color">red</td>
    <td class="size">L</td>
</tr> 
```

此外，要更改下拉列表的值，您需要包含每个选项的值，如下所示：

```
<select id="size" name="size">
    <option value="M">M</option>
    <option value="L">L</option>
    <option value="XL">XL</option>
</select> 
```

然后，在填充输入字段的 javascript 函数中，您可以将大小和颜色的值分配给变量。因为 .click 元素是表格单元格元素的子元素，它是大小和颜色单元格的同级元素，所以我们需要选择 .click 的父元素，然后选择同级元素：

```
var color = $(this).parent().siblings('.color').text();
var size = $(this).parent().siblings('.size').text();
$("#color").val(color);
$("#size").val(size); 
```

这样做。然后，您只需使用相同的标记填写其余行，如下所示：

```
<tr>
  <td><a href="#" class="click">adidas</a></td>
  <td class="color">blue</td>
  <td class="size">XL</td>
</tr> 
```

# android - 连接到 URL

> ID：12653185
> 
> 赞同：0
> 
> 时间：2012-09-29T13:41:00.207
> 
> 标签：android, url

我想使用以下代码读取 URL 的内容：

```
 myUrl=new URL(url);
        stream=myUrl.openStream(); 
```

但是第二行代码触发了“android.os.NetworkOnMainThreadException”，没有任何其他解释。

我在 Androïd 4 下工作，我可以添加此代码用于与 Androïd 2.3.3 一起工作。

任何的想法？

提前感谢您花时间帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:42:15.193

所以问题是应用程序试图在主线程上执行网络操作，这是不允许的。

为了您的目标，我建议`AsyncTask`您在后台使用并完成您的工作`Thread`。

这是我的小应用程序的示例：

```
protected InputStream doInBackground(String... params) {

            int contentLength = 0;
            int buffLength = 0;
            int progress = 0;
            InputStream inputStream = null;
            try {

                URL url = new URL(params[0]);
                HttpURLConnection urlConntection = (HttpURLConnection) url.openConnection();
                urlConntection.setRequestMethod("GET");
                urlConntection.setAllowUserInteraction(false);
                urlConntection.setInstanceFollowRedirects(true);
                urlConntection.connect();
                if (urlConntection.getResponseCode() == HttpURLConnection.HTTP_OK) {
                    contentLength = urlConntection.getContentLength();
                    progressDialog.setMax(contentLength);
                    inputStream = urlConntection.getInputStream();

                    while ((buffLength = inputStream.read(MAX_BUFFER)) != -1) {
                        try {
                            Thread.sleep(1);
                            progress += buffLength;
                            DataTransmitted data = new DataTransmitted(progress, contentLength);
                            publishProgress(data);
                        }
                        catch (InterruptedException ex) {
                            Log.e(this.getClass().getName(), ex.getMessage());
                        }
                    }

                }
                else {
                    throw new IOException("No response.");
                }

            }
            catch (MalformedURLException ex) {
                Log.e(this.getClass().getName(), ex.getMessage());
            }
            catch (IOException ex) {
                errorDialog.show();
            }
            return inputStream;
        } 
```

或者这里是类似的主题：

*   [`Download a file with Android, and showing the progress in a ProgressDialog`](https://stackoverflow.com/questions/3028306/download-a-file-with-android-and-showing-the-progress-in-a-progressdialog)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T13:46:19.277

来自 Android 开发者的网站：

> > 当应用程序尝试在其主线程上执行网络操作时，会引发 NetworkOnMainThreadException。

您需要将代码放在单独的线程或 AsyncTask 中。

Android 3.0 及以上版本对 UI 线程的滥用**更加严格**[阅读本文了解更多详情](http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:06:24.983

您现在需要使用 AsyncTask，这是一个简单的示例，希望对您有所帮助：

```
public class SimpleWebGrab extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    grabURL("http://android.com");
}

public void grabURL(String url) {
    new GrabURL().execute(url);
}

private class GrabURL extends AsyncTask<String, Void, Void> {
    private final HttpClient Client = new DefaultHttpClient();
    private String Content;
    private String Error = null;
    private ProgressDialog Dialog = new ProgressDialog(SimpleWebGrab.this);

    protected void onPreExecute() {
        Dialog.setMessage("Downloading source..");
        Dialog.show();
    }

    protected Void doInBackground(String... urls) {
        try {
            HttpGet httpget = new HttpGet(urls[0]);
            ResponseHandler<String> responseHandler = new BasicResponseHandler();
            Content = Client.execute(httpget, responseHandler);
        } catch (ClientProtocolException e) {
            Error = e.getMessage();
            cancel(true);
        } catch (IOException e) {
            Error = e.getMessage();
            cancel(true);
        }

        return null;
    }

    protected void onPostExecute(Void unused) {
        Dialog.dismiss();
        if (Error != null) {
            Toast.makeText(SimpleWebGrab.this, Error, Toast.LENGTH_LONG).show();
        } else {
            Toast.makeText(SimpleWebGrab.this, "Source: " + Content, Toast.LENGTH_LONG).show();
        }
    }

}
} 
```

并且请：称它为 Android，而不是 Androïd，这听起来很法国。

# javascript - 用javascript剥离其余的价值？

> ID：12653186
> 
> 赞同：1
> 
> 时间：2012-09-29T13:41:11.530
> 
> 标签：javascript, jquery

所以让我们假设我使用 javascript 检索页面标题，值类似于

`FrontPage | Website.com`

我只需要这个的第一个词，所以就像`FrontPage`没有**任何**空格一样。我知道如何用 PHP 做到这一点，但我将如何用 javascript 做到这一点？

我需要这个片段：

```
$(document).ready(function() {
     $("[title='"' + strippedtitle + '"']").addClass("valittu");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T13:44:57.293

你可以使用`split()`方法。

```
var str = 'FrontPage | Website.com';
var whatYouNeed = str.split(' ')[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T13:45:12.020

试试这个，

**[现场演示](http://jsbin.com/iremin/1/edit)**

```
$(document).ready(function() {
    var title1 = "FrontPage | Website.com";

    var strippedtitle = $.trim(title1.split('|')[0]);

    alert(strippedtitle);   
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T13:45:22.520

你可以使用 JavaScript `split`,

```
var str = 'FrontPage | Website.com';     
var firstWord = str.split(" ")[0].replace(/\s/g,''); 
```

# java - 交换数组中的元素

> ID：12653198
> 
> 赞同：2
> 
> 时间：2012-09-29T13:42:17.077
> 
> 标签：java, arrays, indexing, swap

我一直在努力解决这个问题：

假设我有一个数组：

```
int[] n = {0, 0, -1, 1, 0, 1, 1, -1, 1}; 
```

我需要能够对数组进行排序，如果前面有一个零和一个非零，那么它们应该被交换。

例如：`0, 0, -1, 1, 0, 1, 1, -1, 1`

会变成：`0, 0, -1, 0, 1, 1, 1, -1, 1`

我一直在尝试使用没有运气的`for`循环和`if`语句来做到这一点。有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:46:33.870

试试这个：

```
for (int i = 1 ; i < n.length ; i++)
    if (n[i] == 0 && n[i - 1] != 0) {
        int tmp = n[i - 1];
        n[i - 1] = n[i];
        n[i] = tmp;
    } 
```

您认为您需要一个在其主体中`for`包含语句的循环是正确的。`if`我们在这里所做的只是从元素 1 开始循环遍历数组。然后我们检查我们当前所在的元素是否是`0` *并且*前一个元素不是`0`：即`if (n[i] == 0 && n[i - 1] != 0)`。如果这个条件为真，我们交换这两个元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T13:50:38.767

```
for(int i=0; i < length; i++)
{
    if(i > 0 && arr[i] == 0 && arr[i-1] != 0)
    {
        int temp = arr[i-1];
        arr[i-1] = arr[i];
        arr[i] = temp;
    }
} 
```

应该管用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T13:47:12.120

如果不使用位旋转，您将需要一个临时变量来交换两个对象。例子：

```
int[] n = {...};
int temp = n[3]; // swaps n[3] and n[4]
n[3] = n[4];
n[4] = temp; 
```

你可以在你的循环中粘贴这样的东西来完成你所描述的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-12T06:13:07.800

```
public class Swaparray 
{
     public static void main(String []args)
     {
        int [] arr={0,1,2,3,4,5,6,7};
         Swaparray.displayArray(arr);
         for(int i=1;i<arr.length;i++)
         {
         while(arr[i]%2!=0)
         {
        int tmp = arr[i - 1];
        arr[i - 1] = arr[i];
        arr[i] = tmp;
        }
        }
        Swaparray.displayArray(arr);
                     }
   static void displayArray(int[]arr)
   {
       System.out.print("Array elements are: ");
       for(int i=0;i<arr.length;i++) {
           System.out.print(arr[i]+" "); }
       System.out.println();
       }
} 
```

o/p 数组元素为：0 1 2 3 4 5 6 7 数组元素为：1 0 3 2 5 4 7 6

交换数组中的两个连续元素

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-22T07:35:22.347

```
 int arr[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
 int length = arr.length;
 int temp;
 for (int i = 0; i < length/2; i++)
   {
    temp = arr[i];
    arr[i] = arr[length - i - 1];
    arr[length - i - 1] = temp;
   }

 for (int element:arr)
  {
    System.out.println (element);
  } 
```

# cordova - Phonegap 本地存储未定义

> ID：12653199
> 
> 赞同：0
> 
> 时间：2012-09-29T13:42:25.637
> 
> 标签：cordova

使用 phonegap 2.0 我无法弄清楚为什么 window.localstorage 返回未定义。Window.device 完美运行，但是当我执行 window.localstorage 的 console.log 时，它是未定义的，我不知道为什么。我确保我将插件添加到 xml（我正在使用 Android）。任何帮助深表感谢。我觉得这很简单，但我只是没有看到它。

这是 index.html 文件的代码片段

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name = "format-detection" content = "telephone=no"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <link href="css/styles.css" rel="stylesheet">
        <script src="phonegap/android.js"></script>
        <script src="js/childbrowser.js"></script>
        <script>        

            document.addEventListener('touchmove', function(e){
                e.preventDefault();
            }, false);

            document.addEventListener('deviceready', function(){

                alert(window.localstorage);

            }, false);

        </script>
    </head>
    <body>

        <!-- DEVELOPMENT -->
        <script src="libs/zepto.js"></script>
        <script src="libs/underscore.js"></script>
        <script src="libs/backbone.js"></script>
        <script src="libs/iscroll.js"></script>
        <script src="js/app.js"></script>   
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:11:29.920

我编写了几个函数，我几乎在所有应用程序中都使用了这些函数，从而在处理用户首选项时变得更容易......

```
function getPref(iKey, iDefault){
    try{
        var R = window.localStorage.getItem(iKey);
        if (R==null || R=='') {return iDefault;} else {return R;}
    }catch(e){return iDefault;}     
}

function setPref(iKey, iData){
    window.localStorage.setItem(iKey, iData);
} 
```

用法：

```
// on load user preferences procedure
$('#GPSCheckbox').val(getPref('UseGPS','off'));
$('#WiFiCheckbox').val(getPref('WiFiOnly','on'));

// on save user preferences procedure
setPref('UseGPS',$('#GPSCheckbox').val());
setPref('WiFiOnly',$('#WiFiCheckbox').val()); 
```

我希望这对您的情况有所帮助...

# spring - 这个Spring控制器怎么调用

> ID：12653215
> 
> 赞同：0
> 
> 时间：2012-09-29T13:44:52.737
> 
> 标签：spring, spring-mvc, spring-3

如何使用 http 帖子调用以下方法。是否有必要使用 JSON 和 @Requestbody。我也不习惯使用弹簧形式。

如果没有 JSON 帖子，我看不到任何方法来实现这一点。html 表单会是什么样子？

```
@Requestmapping(value="/post", method=RequestMethod.POST)
public void post(List<MyCustomObject> myList, AnotherCustom object){
    System.out.println("POST")
} 
```

这就是我到目前为止的时间。这适用于如何从 ahtml 创建集合？

控制器

```
@RequestMapping(value="/post" , method=RequestMethod.POST)
public String post(Person person){
    System.out.println(person);
    return "home";
} 
```

我的表格

```
<form method="post" action="/application/post">
    <input name="firstName"> <input name="lastName"> 
    <input type="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T11:11:34.487

按照以下 URL 获取将数据传递给控制器​​（HTML 表单）和单元测试控制器的示例代码。

[https://github.com/ffazil/SpringMVC](https://github.com/ffazil/SpringMVC)

# django - 当我在服务器上删除数据库时，Heroku 不会删除数据库（Django 应用程序）

> ID：12653219
> 
> 赞同：1
> 
> 时间：2012-09-29T13:45:43.893
> 
> 标签：django, heroku

我在 Heroku 的服务器上登录了我的应用程序目录：

```
Heroku run bash -app appname 
```

然后我删除了我的数据库：

```
Rm -r dev.db 
```

但是，当我尝试同步我的数据库时，它不会创建新表。当我去生产站点时，它仍然具有所有数据库内容并让我登录等。

任何洞察我做错了什么？我想完全重新创建数据库。

注意：我有一个 Django 应用程序

更新：这是我的数据库设置

```
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3", # Add "postgresql_psycopg2", "postgresql", "mysql", "sqlite3" or "oracle".
        "NAME": PROJECT_ROOT + os.sep + "dev.db",                       # Or path to database file if using sqlite3.
        "USER": "",                             # Not used with sqlite3.
        "PASSWORD": "",                         # Not used with sqlite3.
        "HOST": "",                             # Set to empty string for localhost. Not used with sqlite3.
        "PORT": "",                             # Set to empty string for default. Not used with sqlite3.
    }
} 
```

然后我有这个 Heroku 的注入代码：

```
import dj_database_url
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T00:13:58.910

Heroku 默认为您提供 Postgres 数据库。要完全删除它，请运行：

```
heroku addons:remove heroku-postgresql:dev 
```

然后创建一个新的：

```
heroku addons:add heroku-postgresql:dev 
```

如果它没有自动将其提升到您的主数据库（如果是这样，您应该使用 config var DATABASE_URL）然后运行：

```
heroku pg:promote HEROKU_POSTGRESQL_COLORHERE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-18T12:40:04.387

或者，您可以通过 Heroku 附加组件选项卡中的 UI 来完成。您只需删除附加组件，DATABASE_URL 将是可编辑/可删除的。

# javascript - 允许一个元素继承另一个元素的所有事件

> ID：12653226
> 
> 赞同：0
> 
> 时间：2012-09-29T13:46:44.343
> 
> 标签：javascript, jquery

例如，假设我有 2 个链接，A 和 B。如果用户将鼠标悬停在 A 上，将触发 B 的悬停事件。与所有其他事件类似，如 onlick、mouseover 等。

我不想像这样手动添加事件：

```
$('a#A').click(function(){
  $('a#B').trigger('click');
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:57:33.200

您可以使用多个事件执行此操作，如下所示：

```
$('a#A').on('click mouseenter mouseleave', function(e){
  $('a#B').trigger(e.type);
}); 
```

这将触发绑定在 上的任何指定事件`#B`，例如：

```
$("#B").on({
    mouseenter: function() {
        this.style.color = "#B4B4B4";
    },
    mouseleave: function() {
        this.style.color = "#000";
    }

}); 
```

[小提琴](http://jsfiddle.net/u4h2B/1/)

现在让这变得非常低效，让我们将所有事件绑定到`#B`并使用以下命令触发它们`#A`：

```
$("#B").on({
    mouseenter: function() {
        this.style.color = "#B4B4B4";
    },
    mouseleave: function() {
        this.style.color = "#000";
    }

});

var events = [];
$.each($._data($("#B").get(0), "events"), function(i, e) {
    events.push(i); //gets all events currently bound to #B
});

$('a#A').on(events.join(' '), function(e){  //and triggers them with #A
  $('a#B').trigger(e.type);
}); 
```

[**小提琴**](http://jsfiddle.net/u4h2B/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T13:50:10.720

```
$('linkDiv').each( function() {
  $('a#A').click( function() {
    $('a#B').trigger('click');}
  }); 
```

使用 foreach/each() jQuery 函数来指定您希望这两个事件发生在每个事件上，`<div class="linkDiv">`或者`<a class="linkDiv">`您想要这个事件发生。您的页面中的链接将如下所示：

```
<div class="linkDiv">
  <a class="link" id="A" href="foo.html">Foo</a>
  <a class="link" id="B" href="fap.html">Fap</a>
</div> 
```

# c# - DevExpress MVC 控制每个页面加载生成 2mb 的 javascript

> ID：12653237
> 
> 赞同：2
> 
> 时间：2012-09-29T13:48:41.067
> 
> 标签：c#, javascript, asp.net-mvc, devexpress, onload

我们已经开始使用 DevExpress MVC 控件，这需要在我们的 Site.Master 中添加以下代码：

```
<% Html.DevExpress().RenderScripts(Page,
       new Script { ExtensionSuite = ExtensionSuite.GridView },
       new Script { ExtensionSuite = ExtensionSuite.HtmlEditor },
       new Script { ExtensionSuite = ExtensionSuite.Editors },
       new Script { ExtensionSuite = ExtensionSuite.NavigationAndLayout },
       new Script { ExtensionSuite = ExtensionSuite.Chart },
       new Script { ExtensionSuite = ExtensionSuite.Report }
 ); %> 
```

但这会通过一个名为 DXR.axd 的处理程序呈现一个巨大的 2mb javascript 文件。使用 Firefox 时，此 javascript 太大，并将页面的加载时间从 ~500 毫秒增加到 ~5,000 毫秒（我在之前和之后对其进行了计时）。

使用 Chrome 加载时间约为 750 毫秒

这是一个严重的性能损失，并在页面呈现时导致非常明显的暂停。Firefox 报告说 DOMContentLoaded 事件需要 5 秒才能触发（因为加载和解析 2mb 的 javascript 需要很长时间）

我能做些什么来解决这个问题？

我注意到他们自己的网站[http://mvc.devexpress.com](http://mvc.devexpress.com)有完全相同的问题：如果您查看源代码并查找“DXR.axd”然后下载该文件更大，为 2.6mb，而且他们也有Firefox 的加载速度非常慢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T12:47:22.250

我想他们创建一个动态 js 文件而不是使用静态 js 文件只是为了避免人们可能会复制他们的 js 文件。然而，市场上还有其他控件没有这个问题。如果您需要一个可以在那里找到的特定控件...那么您必须在这个问题中生存下来...否则请更改为另一个控件套件。但是，考虑到更多的控件是“开箱即用”并且只需编写一些代码即可使用，您的性能会更高......下降，因为每个控件都带有几个您实际上不需要的功能.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:06:14.793

我不知道如何修复它，但我在当前项目中使用 DX 组件已经一年多了，所以只想告诉你一件事：它是第 3 方组件，所以你必须忍受它，没有其他方法。我项目中的组件也生成了大量的脚本，我个人认为你应该只用它来解决一个特定的问题（在我们的例子中是 pivotgrid），性能不佳是一种权衡。我自己在他们的组件中发现了几个错误，其中一些是低级实现，他们不能随便修复它，至少现在是这样。

# c - 如何在 linux mint 上编译 c 程序时修复异常错误？

> ID：12653238
> 
> 赞同：0
> 
> 时间：2012-09-29T13:48:55.473
> 
> 标签：c, linux, gcc, cross-platform

我写了一个C程序。它可以在 Windows 7 上的 DevC 上编译并正常工作。但是当我在 Linux mint 上编译它（使用“gcc main.c”命令）时，它不会编译并给出错误。在 Windows 7 上编译时不会显示这些错误。所以在 Linux 上也一定没有错！如何在 Linux 上通过 编译它`gcc`？

C代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
   char command[100];

   printf("Enter the command:");
   scanf("%[^\t\n]", &command);
   printf("%s\n", command);
   strchr(command, '&');

   printf("%i", strchr(command, '&'));

   system("PAUSE"); 

   return 0;
} 
```

错误：

```
mint@mint ~ $ gcc ass1/main.c
ass1/main.c: In function 'main':
ass1/main.c:8:5: warning: format '%[^   
' expects argument of type 'char *', but argument 2 has type 'char (*)[100]' [-Wformat]
ass1/main.c:11:3: warning: incompatible implicit declaration of built-in function 'strchr' [enabled by default]
ass1/main.c:13:5: warning: format '%i' expects argument of type 'int', but argument 2 has type 'char *' [-Wformat] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:59:18.573

> 在 Windows 7 上编译时不会显示这些错误。所以在 linux 上也一定没有错！

这是一个错误的结论。在这种情况下，Windows 上的编译器要比 gcc 宽松得多。

gcc 警告您有关您的错误/错误，在

```
scanf("%[^\t\n]", &command); 
```

你传递`command`你应该传递第一个字节的地址的地址`command`，或者`command`与自动数组到指针的转换一样，或者明确地作为`&command[0]`.

您`strchr`在未声明的情况下使用它，这是 C 的非古代版本中的一个错误，但以前允许使用，其中 use 隐式声明一个函数返回一个`int`. `strchr`但是，返回一个`char*`.

在您的`printf`通话中，您使用了错误的格式，`%i`.

gcc 在这里是完全正确的。

请注意，这些是*警告*，（不幸的是）不是*错误*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:01:29.837

这些不是错误，而是警告。您的代码应该仍然编译。

第一个警告是因为您正在传递`&command`to `scanf`，它是 type `char (*)[100]`，并且说明符`%s`需要一个 type 的参数`char *`。您只需要传递`command`给`scanf`（不带`&`），因为当传递给函数时，`char`数组将衰减为 a 。`char*`

您可能会发现代码仍然有效，`command`并且`&command`两者都引用相同的地址 ( `printf("%p %p", command, &command);`)。

第二个警告是由于您忘记包含`<string.h>`声明`strchr`。由于编译器找不到声明，它会隐式生成一个，结果与真实的不匹配。

最后，`strchr`返回 a `char*`，说明符`%i`旨在用于`int`s。如果要使用 打印地址`printf`，请使用说明`%p`符。

您还应该避免`system("PAUSE");`（这在 Linux 上不起作用），并将其替换为等待用户输入的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:05:09.453

整合前面的答案，将在 Linux 上编译并运行的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h> // use this header to include strchr(command, '&');

int main(int argc, char *argv[])
{
   char command[100];

   printf("Enter the command:");
   scanf("%s", command);
   printf("%s\n", command);
   strchr(command, '&');

   printf("%p", strchr(command, '&')); 
   /* strchr(command, '&') returns a pointer so you need to tell printf you are printing one. */

   system("PAUSE"); 

   return 0;
} 
```

输出：

```
oz@Linux:~$ gcc -Wall test.c
test.c: In function ‘main’:
test.c:12:4: warning: statement with no effect [-Wunused-value]
oz@Linux:~$ ./a.out 
Enter the command:doSomething
doSomething
sh: 1: PAUSE: not found 
```

代替

```
 system("PAUSE"); 
```

使用： printf("按 'Enter' 继续：..."); 而 ( getchar() != '\n') {
i=1; } getchar(); 返回0；

# c# - 手动将数据发送到 Google Analytics

> ID：12653239
> 
> 赞同：18
> 
> 时间：2012-09-29T13:48:57.207
> 
> 标签：c#, google-analytics

我想知道是否可以通过发送自定义 URL 请求将谷歌分析跟踪数据发送给谷歌。我假设我可以构建自己的 URL 并发出请求以获取跟踪的事件，如下所示：`http://google.com/analytics-endpoint?id=UA-34900236-1&event=some_event`，但我还没有找到任何关于此的文档，并且想知道这是否可能？如果是这样，有人可以指出我正确的文件吗？

感兴趣的人的背景：我目前正在尝试将谷歌分析支持添加到 Mono for Android 应用程序。我无法编译任何 c# google 分析库，因为 Mono for Android 中缺少必需的 .net 库。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-05T12:10:14.623

作为@PT 回答的补充，我想指出谷歌现在发布了一个官方 API 来将数据发送到谷歌分析。这是[谷歌分析测量协议](https://developers.google.com/analytics/devguides/collection/protocol/v1/)。这可能是最安全的解决方案，因为它是一个“官方”且记录在案的 API。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-23T19:42:49.560

受[@i.amniels answer](https://stackoverflow.com/a/16939621/177710)的启发，我围绕[Google Analytics Measurement Protocol](https://developers.google.com/analytics/devguides/collection/protocol/v1/devguide)编写了一个小包装器，用于跟踪我们 Web 应用程序服务器端的事件。

这是您可以开始学习的课程[的要点。](https://gist.github.com/0liver/11229128)它只是包装了向 Google Analytics 测量协议端点发送 POST 请求的样板代码。

使用该包装器，您将能够编写以下代码：

```
GoogleAnalyticsApi.TrackEvent("Video", "Play", "Vacation 2014") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-30T02:59:26.320

是的，您可以直接向 Google Analytics 发出 HTTP 请求以跟踪任意应用程序。例如，现有的 Android GA 库就是这样做的（它使用一组非常具体的 URL 参数发出 HTTP_GET 请求）。

没有关于使用底层 HTTP API 作为客户端的官方文档，但考虑到网络上存在大量古老的 JavaScript 片段，以及编译到现有 Android 应用程序中的固定库代码，您可以依赖它相当稳定。[GIF 参数故障排除](https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting#gifParameters)文档解释了分析数据的编码方式。

这是一个为纯 Java 应用程序提供客户端库的现有项目： [http ://code.google.com/p/jgoogleanalytics/](http://code.google.com/p/jgoogleanalytics/)

如果你想在 C# 中重新实现它，魔法似乎都在这里：[http ://code.google.com/p/jgoogleanalytics/source/browse/trunk/src/main/java/com/boxysystems/ jgoogleanalytics/GoogleAnalytics_v1_URLBuildingStrategy.java](http://code.google.com/p/jgoogleanalytics/source/browse/trunk/src/main/java/com/boxysystems/jgoogleanalytics/GoogleAnalytics_v1_URLBuildingStrategy.java)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-29T10:35:15.427

受@Oliver 回答的启发，我更新了 C# 代码，以便在发送 POST 数据时更加及时：

```
namespace Helpers
{
    using System.Collections.Generic;
    using System.Net.Http;
    using System.Threading.Tasks;

    // More information about API - see https://developers.google.com/analytics/devguides/collection/protocol/v1/devguide
    public class GoogleAnalyticsHelper
    {
        private readonly string endpoint = "https://www.google-analytics.com/collect";
        private readonly string googleVersion = "1";
        private readonly string googleTrackingId; // UA-XXXXXXXXX-XX
        private readonly string googleClientId; // 555 - any user identifier

        public GoogleAnalyticsHelper(string trackingId, string clientId)
        {
            this.googleTrackingId = trackingId;
            this.googleClientId = clientId;
        }

        public async Task<HttpResponseMessage> TrackEvent(string category, string action, string label, int? value = null)
        {
            if (string.IsNullOrEmpty(category))
              throw new ArgumentNullException(nameof(category));

            if (string.IsNullOrEmpty(action))
              throw new ArgumentNullException(nameof(action));

            using (var httpClient = new HttpClient())
            {
                var postData = new List<KeyValuePair<string, string>>()
                {
                    new KeyValuePair<string, string>("v", googleVersion),
                    new KeyValuePair<string, string>("tid", googleTrackingId),
                    new KeyValuePair<string, string>("cid", googleClientId),
                    new KeyValuePair<string, string>("t", "event"),
                    new KeyValuePair<string, string>("ec", category),
                    new KeyValuePair<string, string>("ea", action)
                };

                if (label != null)
                {
                    postData.Add(new KeyValuePair<string, string>("el", label));
                }

                if (value != null)
                {
                    postData.Add(new KeyValuePair<string, string>("ev", value.ToString()));
                }

                return await httpClient.PostAsync(endpoint, new FormUrlEncodedContent(postData)).ConfigureAwait(false);
            }
        }
    }
} 
```

可以在[GitHub Gist上找到](https://gist.github.com/ashkue/8b497a3b77b588e3b57c83cc61710aa1)

用法：

```
var helper = new GoogleAnalyticsHelper("UA-XXXXXXXXX-XX", "555");
var result = helper.TrackEvent("Orders", "Order Checkout", "OrderId #31337").Result;
if (!result.IsSuccessStatusCode)
{
    new Exception("something went wrong");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-29T13:56:44.193

是的，这是可能的。因为 Google Analytics 会存储它所在的每个 URL 页面请求。这些在左侧菜单的内容选项卡下可见，然后找到 URL 或页面内容。您可以看到列出的每个页面请求。因此，如果您因为`<a href="more.php?id=8&event=sales">LINK</a>`Analytics 之类的链接而将其关闭，则会存储完整的 URL。

但是，没有通过您提供的 URL 直接访问您的 Google Analytics（分析）帐户的路径，希望得到类似的答案：我认为这是您能做的最好的事情。

您可以制作一个在每个页面上都有跟踪代码的页面。这样，谷歌分析将捕获所有正在发生的事情。然后，您可以将您的“事件”添加到页面上每个链接的末尾，这样当用户单击链接时，它将重定向到您网站上的相应页面，但它也会记录（在来自链接的href）在Google Analytics上，因为GA可以看到页面内发生的一切，包括链接href值的完整URL。因此，如果您的链接看起来像这样，Google Analytics 会记录整个 URL，您可以稍后检索：

```
<a href="page2.php?id=4492&event=clickedCatalog&preference=yellow">Link!</a> 
```

...将`page2.php?id=4492&event=clickedCatalog&preference=yellow`在 GA 中记录完整的 URL（

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-20T14:42:41.070

除了@pavel-morshenyuk 回答之外，如果您想将事件与对其进行操作的用户相关联，下面的代码会将请求映射到 google 客户端 ID。

```
 string clientId = Guid.NewGuid().ToString();

 if (Request != null && Request.Cookies != null && Request.Cookies.Get("_ga") != null && Request.Cookies.Get("_ga").Value != null)
 {
    clientId = Request.Cookies.Get("_ga").Value;
    clientId = clientId.Replace("GA1.2.", "");
    clientId = clientId.Replace("GA1.1.", "");
 } 
```

请注意，如果 GA 更改其内部 cookie 跟踪，则可能需要对其进行调整。

# php - $this->{$spec} 和 $this->$spec 之间的 id 有什么区别？

> ID：12653242
> 
> 赞同：2
> 
> 时间：2012-09-29T13:49:07.020
> 
> 标签：php

还有这两行：

```
$subForm = $this->{$spec}
$subForm = $spec;

public function prepareSubForm($spec)

{
    if (is_string($spec)) {
        $subForm = $this->{$spec};
    } elseif ($spec instanceof Zend_Form_SubForm) {
        $subForm = $spec;
    } else {
        throw new Exception('Invalid argument passed to ' .
                __FUNCTION__ . '()');
    }
    $this->setSubFormDecorators($subForm)
    ->addSubmitButton($subForm)
    ->addSubFormActions($subForm);
    return $subForm;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:08:03.623

在文档的[变量变量](http://php.net/manual/en/language.variables.variable.php)部分中说：

> 也可以使用花括号来明确界定属性名称。在访问包含数组的属性中的值时，当属性名称由多个部分组成时，它们最有用

在这段代码中，没有与语法相关的理由来`$this->{$spec}`代替`$this->$spec`.

但：

*   第一种形式对某些团队来说可能更易读*（= 由代码约定强制执行）*

*   例如，过去这里可能有一个表达式（如`$this->{'_' . $spec}`）。如果您尝试使用表达式作为“变量属性名称”，则需要使用曲线大括号对其进行分隔。

至于 和 之间的区别`$spec`，`$this->$spec`就更清楚了。此方法可以使用两种类型的单个参数：

*   如果`$spec`是`String`类型，则被视为属性的名称；该属性是稍后将被处理（装饰）的；

*   如果`$spec`是`Zend_Form_SubForm`对象，则该对象将被装饰。

# php - 与同一模型有多个 HABTM 关系

> ID：12653244
> 
> 赞同：0
> 
> 时间：2012-09-29T13:49:27.037
> 
> 标签：php, cakephp

在我的 Cake 应用程序中，我在用户模型上与自身建立了多种关系，例如喜欢、认可、友谊等。

然而，Cake 似乎不喜欢我这样做的方式，因为我在数组中多次重复了“用户”。那我该怎么做呢？

```
public $hasAndBelongsToMany = array(
        'User'=>array(
            'className'              => 'User',
            'joinTable'              => 'friends',
            'with'                   => 'Friend',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'friend_id'
        ),
        'User'=>array(
            'className'              => 'User',
            'joinTable'              => 'endorsements',
            'with'                   => 'Endorsement',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'endorsed_id'
        ),
        'Interest' => array('with' => 'InterestUser')
    ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:29:32.577

好吧，您不能在 php 中重复数组键，CakePHP 对此无能为力。为第二个关联使用不同的**别名。**简而言之，您的第二个关联使用不同的键，例如“User2”。您可以在手册中获取有关模型别名的更多信息。

# html - 并排定义列表，无需换行太长

> ID：12653246
> 
> 赞同：5
> 
> 时间：2012-09-29T13:49:42.183
> 
> 标签：html, css, css-float

我有一个`<dl>`包含短`<dt>`文本和可能长`<dd>`文本。在我使用它们的布局中，我希望它们并排显示：

```
/==============\
|DT  DD........|
|DT  DD........|
|DT  DD........|
\==============/ 
```

但是，如果 DD 的内容太长，我只想将其截断（`overflow: hidden`在 DL 上）。一种简单的方法是给 DD 一个最大宽度，以避免它变得太大而无法与固定大小的 DT 放在一行中。但是，由于容器的宽度已经固定并且可以通过媒体查询进行更改，因此我更喜欢不需要在 DD 中指定固定宽度点的解决方案。对 DT 和 DD 都使用百分比也不是一个解决方案，因为如果容器很大，这会浪费 DT 中的空间。

小提琴显示问题：http: [//jsfiddle.net/ThiefMaster/fXr9Q/4/](http://jsfiddle.net/ThiefMaster/fXr9Q/4/)

当前的 CSS：

```
dl { border: 1px solid #000; margin: 2em; width: 200px; overflow: hidden; }
dt { float: left; clear: left; width: 50px; color: #f00; }
dd { float: left; color: #0a0; white-space: nowrap; } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T13:57:39.550

更新：我应该先阅读你的整个问题。

脱掉`float:left;`_`<dd>`

[http://jsfiddle.net/fXr9Q/26/](http://jsfiddle.net/fXr9Q/26/)

> 初学者使用这个属性的一个可能的问题（正如我在上面已经提到的）是他们假设在一个元素上设置 whitespace: nowrap 将防止该元素下降到下一行，如果它是一组浮动框的一部分。然而，white-space 属性仅适用于它所应用的元素内部的内联元素，不会影响块元素或元素本身的间距。

[http://www.impressivewebs.com/css-white-space/](http://www.impressivewebs.com/css-white-space/)

* * *

老的

`dl`当您在and上设置宽度时`dt`，将其*添加*到`dd`：

```
dd{
    overflow: hidden;
    text-overflow: ellipsis;
    width: 150px;
} 
```

[http://jsfiddle.net/fXr9Q/15/](http://jsfiddle.net/fXr9Q/15/)

请注意 - 这是 CSS3 - 不适用于旧版浏览器 - 由您来评估这是否是一个问题 - 大多数时候我不介意旧版浏览器选择稍差的样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:15:27.823

您不需要在 DT 和 DD 上设置宽度。

只需给 DT 一个宽度，然后向左浮动。将 DD 的溢出属性设置为隐藏，将使其适合所有可用的剩余空间。

然后空格：nowrap; 和文本溢出：省略号；每当文本太长时，都会让它喜欢添加省略号。

这是要走的路：http: [//jsfiddle.net/fLPej/](http://jsfiddle.net/fLPej/)

# algorithm - 如何将一系列整数映射到颜色空间？

> ID：12653247
> 
> 赞同：0
> 
> 时间：2012-09-29T13:49:51.957
> 
> 标签：algorithm, colors

我需要将一系列正整数（例如 1 - 15'000）映射到颜色空间，使最小值为绿色，最大值为红色。即我需要一个算法，我可以给出一个整数（也许是最小值，最大值）作为输入，并接收一个 RGB 值作为输出。

我知道离散色彩空间的可能性，但我更喜欢不需要的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:28:31.203

这应该让你开始：

```
 ​function getColourFromInt(int){
      var num = Math.abs(int);

      var b2 = Math.floor(num % 16);
      var temp = num / 16;

      var b1 = Math.floor(temp % 16);
      var temp2 = temp / 16;

      var g2 = Math.floor(temp2 % 16);
      var temp3 = temp2 / 16;

      var g1 = Math.floor(temp3 % 16);
      var temp4 = temp3 / 16;

      var r2 = Math.floor(temp4 % 16);
      var temp5 = temp4 / 16;

      var r1 = Math.floor(temp5 % 16);

     var values = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"]

     r1 = values[r1]
     r2 = values[r2]
     g1 = values[g1]
     g2 = values[g2]
     b1 = values[b1]
     b2 = values[b2]

     var rgb = r1 + r2 + g1 + g2 + b1 + b2;

     document.getElementById('colour').innerHTML = rgb;

 }

 getColourFromInt(Math.floor(Math.random() * 16*16*16*16*16*16))​ 
```

[http://jsfiddle.net/pxSMb/](http://jsfiddle.net/pxSMb/)

# objective-c - 在导航栏中的默认“后退”按钮附近添加按钮

> ID：12653248
> 
> 赞同：0
> 
> 时间：2012-09-29T13:50:00.173
> 
> 标签：objective-c, uinavigationcontroller, uitabbaritem

我正在构建并使用`webView's`. 通过选择一些选项卡，我还显示了一些**非 webView**视图。我的导航控制器有问题

我在我的`Ncontrolls`类中设置我的 navigationController 有下一个代码：

```
- (void)push{
   UIViewController myVC = [[UIViewController alloc] init];
    myVC.view.frame = currentNC.view.frame;
    UIImageView *logo = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"house.png"]];    
    UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc] initWithCustomView:logo ];
    [myVC.navigationItem setLefttBarButtonItem:buttonItem];
    [currentNC pushViewController:myVC animated:NO]; 
```

每次我想使用后退按钮时，当我在 UIWebView 中更改页面时，我都会调用下一个代码并使用`push`，并添加后退按钮

```
UIViewController *VC1 = [[UIViewController alloc] init];
[[AppDelegate sharedInstance].currentNC pushViewController:VC1 animated:NO]; 
```

我有一些视图，我想在后退按钮附近添加另一个按钮，而不是替换它，而是添加附近。我正在寻找在某些视图中设置我的按钮靠近后退按钮的选项。

此代码添加一个按钮：

```
UIBarButtonItem *button1 = [[UIBarButtonItem alloc] initWithCustomView:trView];
    [VC1.navigationItem setLefttBarButtonItem:button1 ];
    [currentNC pushViewController:dummyVC animated:NO]; 
```

当我要进入下一个视图并出现后退按钮时，我的`button1`消失了。此时我如何将它添加**到后退按钮附近**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:53:40.770

我认为，导航控制器顶部的一侧不可能有两个按钮。但是，你可以把按钮放在右边。

```
self.navigationItem.rightBarButtonItem = buttonItem; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T10:55:51.000

您可以通过以下方法添加它：

首先：您应该构建自己的后退按钮和新按钮并在那里定义动作，然后创建一个名为“LargeButton”的大按钮，没有动作，并在其中添加两个按钮：

> [大按钮 addSubview:backbtn];
> [大按钮 addSubview:myButton];

然后将右侧导航栏按钮设置为大按钮：

> self.navigationItem.leftBarButtonItem = 大按钮；

在这种方法中，您将在导航栏的右侧获得一个两个按钮。

# c++ - 模板类中的 C++ 非法成员初始化

> ID：12653250
> 
> 赞同：1
> 
> 时间：2012-09-29T13:50:22.633
> 
> 标签：c++, templates

我已经查看了一些关于 c++ 中非法成员初始化的类似问题，同样的错误 C2614，但似乎与我的问题不一样。
我有一个模板类“Mat2D”：

```
#pragma once

#include <iostream>
#include <iomanip>
#include <assert.h>
template<class T>
class Mat2D
{
private:
    int _rows;
    int _cols;
    T** _data;

public:
    Mat2D()
        :_rows(0), _cols(0), _data(NULL)
    {

    }

    Mat2D(const Mat2D<T>& rhs)
        :_rows(rhs._rows), _cols(rhs._cols)
    {
        cloneData(rhs._data);
    }

    Mat2D(int rows, int cols)
    {
        _rows = rows < 1 ? 1 : rows;
        _cols = cols < 1 ? 1 : cols;
        allocateData();
    }

    Mat2D(int rows, int cols, const T& initValue)
        :Mat2D(rows, cols) //--> error C2614:  'Mat2D<T>' : illegal member initialization: 'Mat2D<int>' is not a base or member 

    {
        all(initValue);
    }

    ~Mat2D()
    {
        for(int i = 0; i < _rows; i++)
            delete _data[i];
        delete _data;
    }
//...
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T13:55:31.320

```
Mat2D(int rows, int cols, const T& initValue)
    :Mat2D(rows, cols) 
```

这可能不起作用，因为初始化列表仅适用于变量。尝试

```
Mat2D(int rows, int cols, const T& initValue)
    :_rows(rows), _cols(cols) 
```

或复制`Mat2D(int cols, int rows)`此函数中构造函数的内容。

# android - 该应用程序声音媒体在后台运行如何解决？

> ID：12653260
> 
> 赞同：-1
> 
> 时间：2012-09-29T13:52:13.363
> 
> 标签：android, flash, audio

> **可能重复：**
> [当我退出应用程序时，声音在后台运行](https://stackoverflow.com/questions/12652133/when-i-exit-an-application-the-sound-runs-on-the-background)

当我单击主页按钮或返回按钮时，音频/声音仍在运行，音频的来源是 swf（flash），那么我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:00:47.217

您必须覆盖 onPause 方法并在那里停止音频。

```
player.pause(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:04:26.107

您应该在or中暂停并释放播放器并在`onPause`or中`onStop`初始化。Android 开发者网站对此进行了[**培训**](http://developer.android.com/training/basics/activity-lifecycle/stopping.html)。您应该在您的活动中添加此代码`onStart``onResume`[](http://developer.android.com/training/basics/activity-lifecycle/stopping.html)

 **```
 @Override
public void onPause() {
    super.onPause();  // Always call the superclass method first

    // Release the mPlayer because we don't need it when paused
    // and other activities might need to use it.
// You change this part to your implement. Stop your player
        if (mPlayer != null) {
            mPlayer .release()
            mPlayer = null;
        }
//
} 
```

再次初始化`onResume`

```
 @Override
public void onResume() {
    super.onResume();  // Always call the superclass method first

    // Get the mPlayer instance as the activity achieves full user focus
    if (mPlayer == null) {
        initializePlayer (); // Local method to handle mPlayer init
    }
} 
```**

# c++ - 在第 1500 行的帕斯卡三角形中找到每个数字？

> ID：12653264
> 
> 赞同：0
> 
> 时间：2012-09-29T13:52:31.880
> 
> 标签：c++, math, pascals-triangle

我刚刚问了另一个关于帕斯卡三角形的问题，关于找到第 1500 行的总和。我很高兴人们这么快回答，但不幸的是后来我意识到，我需要第 1500 行的每个单独的数字。

在这里，我找到了一种简单的方法来计算帕斯卡三角形上的任何数字，但是当我尝试在我的代码中使用公式时，程序在启动时崩溃。

```
#include"stdio.h"
int factorial(int);

int main()
{
    int i=0;
    for(i=0; i<1501; i++)
    {
       printf("%d \n" , (factorial(1500)/factorial(1500-i))/factorial(i) );
    }
}
int factorial(int x)
{
    if(x<2)
    return 1;
    else
    {
        return x*factorial(x-1);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T13:57:39.067

对阶乘使用线性算法，而不是通过递归堆栈溢出：

```
int factorial(int x) {
    if (x < 2) return 1;

    int result = x;

    while (--x) {
        result *= x;
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T15:05:03.770

您需要一个大整数库来获取结果，因为

```
binom(1500,750) = 722462892448930217028116073228485295944376343040546523665632913653613596406381727723198055046187955623124069093412562720869577867557610868874271130828359513282184417776042792372322074253393127328396528996120053749558122610911178218582669317535346728464707661495135518682519172221470420360910320792434869988224466647627642393919250205687942318888922893189087379790541907686956429837978631252775258630376332505697937034877619012586751274240109457111424 
```

甚至超出了通常的`double`范围。

但是有了这样的类型，关系

```
binom(n,k+1) = binom(n,k)*(n-k)/(k+1) 
```

允许一个简单、相对有效的实现：

```
bigint value = 1;
int numerator = 1500 + 1, denominator = 0;
for(; denominator <= 1500; --numerator, ++denominator, value = value*numerator/denominator)
{
    output(value);
} 
```

`output`图书馆提供的任何输出方法在哪里。

如果库不提供用于乘法/除法 biginteger 和 normal s 的`value = value*numerator/denominator`重载，则需要调整该部分。`int`

# javascript - 使用 $.get 方法从 asmx 页面获取 xml 数据

> ID：12653265
> 
> 赞同：1
> 
> 时间：2012-09-29T13:52:31.297
> 
> 标签：javascript, jquery, xml, web-services, asmx

我正在尝试使用 $.get 方法从该 Web 服务获取 xml 数据： [http ://www.webservicex.net/currencyconvertor.asmx?op=ConversionRate](http://www.webservicex.net/currencyconvertor.asmx?op=ConversionRate)

当我尝试获取数据时出现错误。

示例代码：

```
var FromCurrency = "USD";
var ToCurrency = "JMD";
var url = "www.webservicex.net/currencyconvertor.asmx/ConversionRate?FromCurrency="+FromCurrency+"&ToCurrency="+ToCurrency;
var jqXHR;

alert(url);
jqXHR = $jQuery.get(url,function(data){
    alert(data);
})
.success(function() { alert("second success"); })
.error(function() { alert("error"); })
.complete(function() { alert("complete"); });

// Do something here

// Set another completion function for the request above
jqXHR.complete(function(){ alert("second complete"); }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:26:57.293

经典[的同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。

您可以使用此 jsFiddle 查看此处重现的错误：http: [//jsfiddle.net/AWW2S/1/](http://jsfiddle.net/AWW2S/1/)

# animation - 如何在三次贝塞尔方法上禁用 css3 过渡鼠标离开效果？

> ID：12653270
> 
> 赞同：1
> 
> 时间：2012-09-29T13:53:15.727
> 
> 标签：animation, css, hover, transition, mouseleave

我有一个`rotate` `transform`带有的 CSS3 `cubic-bezier` `transition-timing-function`，它在鼠标悬停时工作正常，但我想禁用 mouseleave 动画。我准备了一个简单的[**jsFiddle**](http://jsfiddle.net/nyMbm/3/)给你看。

```
img {
    transition : all 1s cubic-bezier(0.680,-0.550,0.265,1.550);
}

img:hover {
    transform: rotate(360deg);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T19:05:11.713

你的意思是当你悬停时你不希望它转换回来？您可以为此使用“无限”（实际上非​​常大） （这是[速记](https://developer.mozilla.org/en-US/docs/CSS/transition)[**`transition-delay`**](https://developer.mozilla.org/en-US/docs/CSS/transition-delay)中的第二个时间值）。

像这样：

# [*演示*](http://jsfiddle.net/nyMbm/5/)

**CSS**：

```
img {
    transition: 0s 99999s; /* transition when mouse leaves */
}
img:hover {
    transform: rotate(360deg);

    /* transition on mouseover */
    transition: 1s cubic-bezier(0.680,-0.550,0.265,1.550);
} 
```

请注意，这将使图像仅在第一次悬停时旋转。

* * *

如果你想让它在每次悬停时旋转，那么你必须使用[*关键帧动画*](https://developer.mozilla.org/en-US/docs/CSS/@keyframes)。像这样：

# [*演示*](http://dabblet.com/gist/3804996)

**CSS**（没有前缀，你必须添加它们）：

```
img:hover {
    animation: rot 1s cubic-bezier(0.680,-0.550,0.265,1.550);
}
@keyframes rot {
    to {
        transform: rotate(360deg);
    }
} 
```

* * *

另外，我注意到您首先编写了无前缀属性-您应该始终将其放在最后。尤其是现在，即将到来的 IE、Firefox 和 Opera 版本是无前缀转换。

# flash - Playframework 2 使用 websockets 进行二进制传输

> ID：12653271
> 
> 赞同：0
> 
> 时间：2012-09-29T13:53:19.533
> 
> 标签：flash, websocket, playframework-2.0, amf

我想将 websockets 与 playframework 2 一起使用。我的一个客户将使用 flash。在 playframework 2 中，如何使用带有二进制数据 (amf) 的 websocket。

有人可以指出一些实现这一点的代码，或者至少是一篇讨论这一点的文章。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:51:27.420

这是带有 Play 2.0 的二进制 Websocket 的一个示例：[http ://www.smartjava.org/content/binary-websockets-play-20-and-scala-and-bit-op-javacvopencv/](http://www.smartjava.org/content/binary-websockets-play-20-and-scala-and-bit-op-javacvopencv/)

它是 Scala 代码，它使用[Iteratees](http://www.playframework.org/documentation/2.0.3/Iteratees)。

# mysql - MySQL 非常长的数字数据类型

> ID：12653273
> 
> 赞同：1
> 
> 时间：2012-09-29T13:53:38.007
> 
> 标签：mysql, database, types, sqldatatypes, bigint

我应该使用哪种数据类型在 MySQL 数据库中存储像“10196385171799537224”（21 位）这样的数字（ID）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T13:57:00.573

您可以将其存储为`numeric(21,0)`

**[请参阅 SQL Fiddle 演示](http://sqlfiddle.com/#!2/f04e1/1)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:01:58.057

根据[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html)，您需要一个`NUMERIC(21,0)`.

但是，这是一个不可行的大 ID。以每微秒一个的速度添加条目，需要超过 300,000 年才能达到这个数字。您可能需要重新考虑您的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T13:59:12.997

我想，这个问题对你有帮助

[如果我需要一个非常大的自动增量 ID 怎么办？](https://stackoverflow.com/questions/5762327/mysql-what-if-i-need-a-very-very-big-autoincrement-id)

我认为，如果您真的需要将这些数字存储在数据库中，最好将它们分成两列或更多列。

# python - 使用 Python 对固定日期进行线性插值

> ID：12653277
> 
> 赞同：1
> 
> 时间：2012-09-29T13:54:02.637
> 
> 标签：python, linear-interpolation

例如，我有一组日期和一组以不同间隔拍摄的日期。

只是为了说明起见，假设数字是从今天（9 月 29 日）到现在（12 月 29 日）三个月后的每天，从三个月后到两年后的每月一次，从两年到 10 年的每季度一次，再过 50 年之后的每年一次年。

现在的要求是，我们仍然遵循所有日期间隔“模式”，但时间序列应该从每个季度末开始（所以 3 月 31 日、6 月 30 日、9 月 30 日和 12 月 31 日），数字线性插值在-之间。因此，使用上面的示例，我的新系列应该是从 9 月 30 日（第一季度末）到 12 月 31 日的每日数字，从 2012 年 12 月 31 日到 2014 年 12 月 31 日的每月数字，从 2014 年 12 月 31 日到 2022 年 12 月 31 日的每季度以及之后的每年，新时间序列中所有不在旧时间序列中的价格都是使用线性插值计算的）。

有什么方法可以有效地做到这一点，有没有我可以使用的代码示例？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T00:27:58.380

这是一种仅使用`datetime`and的方法`calendar`。不过篇幅*较长*，请注意。

## **首先，我们需要一种方法来制作所需的时间序列**

月份和季度有点棘手，例如，哪个日期是 1 月 31 日之后的一个月？但方法可能如下所示：

为了测试，我包括生成属于日期的随机值。

```
from datetime import datetime, timedelta, date
import calendar
from random import random

def makeseries(startdate):
    datesA = [startdate] # collect the dates in this list
    valsA = [random()]   # and the randomly generated 'data' in this one
    date = startdate    

    # add days
    step = timedelta(1)
    while date - startdate <= timedelta(91):
        date += step
        datesA += [date]
        valsA += [random()]

    # add months
    step = timedelta(30)
    while date - startdate <= timedelta(2*365):
        if date.month in [1,3,5,7,8,10,12]:
            date += timedelta(1)
        elif date.month == 2:
            date -= timedelta(2)
        date += step
        datesA += [date]
        valsA += [random()]

    # add quarters
    step = timedelta(91)
    while date - startdate <= timedelta(int(365*10)):
        date += step
        if date.year % 4 == 0:
            date += timedelta(1)
        datesA += [date]
        valsA += [random()]

    # add years
    step = timedelta(365)
    while date - startdate <= timedelta(int(365*50)):
        date += step
        if date.year % 4 == 0:
            date += timedelta(1)
        datesA += [date]
        valsA += [random()]

    return datesA, valsA 
```

## **然后，一个简单的方法在一系列日期中找到与给定日期最近的日期**

```
def findIndexOfNearest(series, D):
    # returns the index of the date in series that is closest to, but greater than D
    for i, date in enumerate(series):
        if date > D:
            return i
    return None 
```

## **生成两个时间序列**，加上第一个序列的一些模拟日期

```
thisyear = datetime.today().year
quarterEndMonth = (datetime.today().month+2)//3*3
quarterEndDay = calendar.monthrange(thisyear, quarterEndMonth)[1]

d1,v1 = makeseries(date.today())
d2,_ = makeseries(date(thisyear,quarterEndMonth, quarterEndDay))
v2 = [] 
```

## **使用 timedeltas**进行插值并打印插值

```
for d in d2: 
    i = findIndexOfNearest(d1, d)
    if i:
        prev = d1[i-1]
        next = d1[i]
        prevRatio = 1-(d-prev).total_seconds()/(next-prev).total_seconds()
        nextRatio = 1-(next-d).total_seconds()/(next-prev).total_seconds()
        interp = prevRatio*v1[i-1] + nextRatio*v1[i]
        v2 += [interp]
        print("%s = %.2f * %s + %.2f * %s" % (d, prevRatio, prev, nextRatio, next))
        print("%17.2f * %10.2f + %.2f * %10.2f = %.2f" % \
               (prevRatio, v1[i-1], nextRatio, v1[i], interp))
    else: # date to be interpolated is past last original date
        v2 += [v1[-1]]
        print("%s = 1.00 * %s = %24.2f" % (d,d1[-1],v1[-1])) 
```

## **一些示例输出：**

在这里，原始系列刚刚切换到 3 个月的间隔，一个日期在 11 月，另一个日期在明年 2 月。我们插值的日期是 12 月。

```
 original           original
                      date                date
                        v                   v
2014-12-02 = 0.69 * 2014-11-04 + 0.31 * 2015-02-03
     ^       0.69 *       0.95 + 0.31 *       0.10 = 0.69
     |         ^           ^       ^           ^       ^
     |         |        original   |       original   interpolated 
date from      |         value     |         value       value
2nd series   weight              weight 
```

# php - 使用带有数据源和 3d 数组 php/SQL 查询的 jQuery UI 自动完成

> ID：12653281
> 
> 赞同：0
> 
> 时间：2012-09-29T13:54:17.873
> 
> 标签：php, jquery, mysql, user-interface, autocomplete

我想使用 jQuery UI Autocomplet 使表单字段自动完成，从数据库中获取值：http: [//jqueryui.com/demos/autocomplete/#remote](http://jqueryui.com/demos/autocomplete/#remote)

我已经复制了代码，但是示例（鸟类）是一个关联数组。

```
$items = array(
"Great Bittern"=>"Botaurus stellaris",
"Little Grebe"=>"Tachybaptus ruficollis",
"Black-necked Grebe"=>"Podiceps nigricollis",
"Little Bittern"=>"Ixobrychus minutus"); 
```

等等等等

我想用两个字段 id 和 author 查询我的数据库。但是，查询返回一个多维数组，其中从数据库返回的每一行都是一个数组。

```
e.g.  ( [0] => Array ( [ID] => 1 [Author] => Higgins ) ) ( [0] => Array ( [ID] => 2     [Author] => Darl) )( [0] => Array ( [ID] => 3 [Author] => Lewis) ) 
```

如何返回查询，使其格式为：

```
"1=>Higgins,
2=>Darl,
3=>etc etc," 
```

这样我就可以使用脚本了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:06:02.143

鉴于您的数据库数组是`$dbresult`，您可以这样做：

```
foreach($dbresult as &$arr) {
    $completearray[$arr['ID']] = $arr['Author'];
}

var_dump($completearray); 
```

上面将输出以下数组：

```
1=>Higgins
2=>Darl
3=>Lewis 
```

**更新**：我已经更新了上面的代码，因此结果数组由 ID 字段索引。

# python - 在内存数据库中的 SQLite 中哪个更快：没有索引、加载到索引表中或在加载后构建索引？

> ID：12653282
> 
> 赞同：1
> 
> 时间：2012-09-29T13:54:24.450
> 
> 标签：python, sqlite, memory, indexing

我正在使用 SQLite 将大约 9Gb 的大数据集加载到“：memory：”数据库中。现在，我有一个 python 脚本，可以从 .csv 文件中加载数据（逐行执行一些其他操作）。然后我需要在两张大桌子上做一些连接。如果数据库在内存中，索引我要加入的列会有所不同吗？如果是这样，在将数据加载到表之前创建带有索引的表，还是在连接之前构建索引更好？最后，如果我为列指定类型，它会在速度方面有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:16:30.213

索引将有所帮助：搜索表的所有记录仍然比使用二进制搜索在索引中查找要慢。

如果在加载数据之前创建索引，则必须为每个插入的记录更新索引。

[在 SQLite 中，除了类型 affinity](http://www.sqlite.org/datatype3.html#affinity)之外，列类型无关紧要 。没有声明列类型将与拥有正确类型一样快；仅当您设法为列声明错误类型时，您才会获得类型转换的额外费用。

# java - 侦听器和验证/重绘

> ID：12653283
> 
> 赞同：1
> 
> 时间：2012-09-29T13:54:30.323
> 
> 标签：java, swing, validation, listeners, program-flow

所以我有这个问题。我有一个创建和加载文件的程序。

当我将文件加载到我的程序中时，我依靠一个组件侦听器来告诉我特定组件何时“满”，然后根据它移动所有组件。

我在顶部添加每个组件，然后在父组件“填充”时注册侦听器并将底部组件移动到它也创建的新父级。可以把它想象成在一个百页的 MSWord 文档的开头添加一个新的文本行。

该侦听器还依赖于 GUI 设置 - 如果内存中的所有内容都没有绘制到屏幕上，它会抓取错误的组件高度（通常为 0）并在计算中使用它们，然后结果就会出错，一切都会变得一团糟。

这是我的程序那部分的流程图：

（everytning 发生在 JFrame 中的 JPanel 上）

```
trigger opening method:
{
    repeat this x (lets say e.g. 100) times:
    {
        trigger addComponent method
        {
            add component
            {
                adding component triggers the component listner 8if there is no more room in parent)
                {
                    move all of the components one place down, move the ones out of bounds to next "page"
                    repaint and revalidate whole JFrame (inside listener)
                }
            }
            repaint and revalidate whole JFrame (part of addComponent method)
        }
        repaint and revalidate whole JFrame(part of opening methid, after component addition)       
    }
    repaint and revalidate whole JFrame (as a part of opening method, final repaint/validate)
} 
```

这样做的原因可能是重绘/验证是 addComponent 方法以及侦听器具有其他功能，并且在其他地方被调用，而这是重绘/验证的唯一（最佳）位置。

问题是 JFrame 在 opeoning 方法中的最后一次（最终）验证/重绘调用之前不会被重绘。我尝试将 Thread.sleep(1000) 添加到代码中的几个位置（在验证/重绘之后）来证明这一点。

另外，据我所知，当触发组件侦听器时，它会停在触发它的行，然后执行自身，然后从该行继续，对吗？

我该如何解决？在添加每个新组件之后，如何强制我的程序重新绘制/验证，然后在监听器完成它的工作之后再次？

**回复前两条评论**：首先，Thread.sleep(1000) 只是为了诊断问题。就在 Thread.sleep(1000) 方法是 repaint/validate 方法之前，所以我想如果我在调用 reapint() 之后立即暂停程序，每次暂停后，GUI 都会重新绘制广告，我会看到添加了新元素，这不是案子。

其次，对于冗长的计算，这些计算并没有那么长（使用 20 个组件执行此操作会得到暂时的结果，尽管不是所需的结果）。此外，该计算需要经常（每 10-20 行）向 GUI 中删除和添加组件，因此将 SwingWorker 纳入其中几乎是不可能的，也不需要。

第三，我认为你没有抓住重点。执行时间不是这里真正的问题，也不是 GUI 的冻结（这并没有真正发生，无论如何都不足以引起注意）。问题是每个组件在循环中调用了 repaint/validate 总共 3-4 次（如果我打开一个包含 20 个组件的文件，cca. 60-80 次），我唯一看到它被执行的时间是最后一次调用它，在循环之后......

我什至在重绘/验证之前和之后放置了 System.out.println("something") 方法。它两次打印出“某事”，但从未发生过重新绘制/验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:00:13.177

*   我可以看到容器中 /e / JComponents 的[任何`add`问题`remov`（`modify`--](https://stackoverflow.com/a/6989230/714968)`JFrame` > `JPanel`ei）

*   取决于容器（`JPanel`ei）是否放置在`JScrollPane`

*   取决于您是否需要在容器中调用`pack()`/ `add`e `remov`/ `modify` `JComponent`s，然后`JFram`在屏幕上更改 e 的大小（例如）

# objective-c - 以线程安全的方式从环形缓冲区复制目标 C 中的数据

> ID：12653284
> 
> 赞同：1
> 
> 时间：2012-09-29T13:54:39.317
> 
> 标签：objective-c, c, multithreading, thread-safety, circular-buffer

我对这段代码的结果感到困惑：

在一个线程中，我正在写入环形缓冲区（请参阅[此处](http://www.snoize.com/Code/PlayBufferedSoundFile.tar.gz)的环形缓冲区实现）：

```
- (void)appendToRingBuffer:(Packet *)packet
{
    int32_t length = ((PacketAudioBuffer *)packet).totalSize;

    void *writePointer;
    bytesAvailableToWrite = [ringBuffer lengthAvailableToWriteReturningPointer:&writePointer];
    memcpy(writePointer, [((PacketAudioBuffer *)packet).audioBufferData bytes], length);
    [ringBuffer didWriteLength:length];   //updates ring buffer head pointer
 } 
```

在另一个线程中，我正在读取它（并将数据复制到 NSData 变量）：

```
-(BOOL)readFromRingBuffer
{ 
    void *readPointer;
    allBytesAvailable = [ringBuffer lengthAvailableToReadReturningPointer:&readPointer];

    ringBufferReadData = [NSData dataWithBytes:readPointer length:allBytesAvailable];
    [ringBuffer didReadLength:allBytesAvailable];    // purges read data from ring buffer

    // do something with ringBufferReadData
} 
```

尽管我通过`[NSData:dataWithBytes:length]`并将 ringBufferReadData 声明为`@property (nonatomic, copy) NSData *ringBufferReadData;`.将值复制到 ringBufferReadData线程缓冲区.. 然而.. 事实证明，在将数据复制到 ringBufferReadData 之后，另一个线程写入环形缓冲区的值会发生变化.. 知道如何/为什么以及如何确保不会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T13:51:05.380

事实证明，问题出在代码中的其他地方。 [NSData dataWithBytes:length] 确实创建了一个新的 NSData 对象，如 Martin R 所述

# java - 如何从头开始创建 Apple Keynote 演示文稿？

> ID：12653288
> 
> 赞同：8
> 
> 时间：2012-09-29T13:55:28.607
> 
> 标签：java, xml, dom, keynote

我正在尝试编写一个创建 Apple Keynote Slide 的程序。我希望找到一些关于使用 Java 从头开始​​创建苹果的 xml 格式 (apxl) 的答案。我发现了一些与旧版本的 Keynote 相关的文档，这些文档允许使用 Java DOM 进行此类创建，但就最新版本的 Keynote 而言，我运气不佳。（顺便说一句，我知道 .key 文件是一个包，并且 apxl 文件是压缩的 .gz）

我已经阅读了以下文件：

[1] [https://developer.apple.com/appleapplications/keynote-apxl.html](https://developer.apple.com/appleapplications/keynote-apxl.html)

[2] [http://www.xml.com/pub/a/2004/01/07/keynote.html](http://www.xml.com/pub/a/2004/01/07/keynote.html)

...和许多其他人。（stackoverflow 只会让我以新人的身份发布两个链接）

谷歌搜索会告诉你，在 2004 年之后没有太多文档。

我的问题是，这里有没有人成功地用 Java 编写了一些东西来创建或添加到 apxl 文件以用于主题演讲？如果是这样，您能否向我指出您使用的文档、教程或示例代码？

我不是在寻找您的代码，只是在任何地方都找不到可行的指令集。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:44:12.413

我的同事使用下一种方法来生成大型 MS .xls/.doc 2003 文档。他的目标是使报告包含 >10^6 行。他只是制作了 xml 并制作了 zip 文件——就像 MS Word/Excel 一样。

xml 的格式可以简单地从示例文档中检索：例如，如果您想知道如何进行文本格式化 - 只需使用它创建简单的文档并分析输出文件。当然，我们只有很少的能力，但实现了基本的文本格式和布局标记。

我不确定您需要多少功能。但是您可以在对每个格式化功能进行单独调查后实现相同的 xml 生成过程。

# javascript - 如何在 JavaScript 中使用 innerhtml？

> ID：12653292
> 
> 赞同：11
> 
> 时间：2012-09-29T13:55:41.023
> 
> 标签：javascript, html, innerhtml

我的问题是我不知道如何显示我的表单的 innerhtml。

该表格就像一个调查表格，一旦您单击提交按钮，我回答的所有内容都会显示为摘要页面......

```
function displayResult() {
    var first = document.getElementById("first").value;

    var middle = document.getElementById("middle").value;

    var last = document.getElementById("last").value;

    alert("oh");
    var maincontent = document.getElementById("content").innerHTML;
    maincontent = "<p>" + first;

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-29T14:00:21.053

```
var maincontent = document.getElementById("content").innerHTML;
maincontent = "<p>" + first; 
```

在第二行，您要覆盖变量，而不是设置`.innerHTML`. 这就是你想要的：

```
var maincontent = document.getElementById("content");
maincontent.innerHTML = "<p>" + first; 
```

此外，您必须确保 id 为“first”、“middle”和“last”的元素确实存在，否则可能会导致`TypeError`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T14:18:29.913

试试这个：

但是，您应该首先拥有 id。并且您应该需要 html 部分中的内容 div。

```
<script>
function displayResult() {
    var first = document.getElementById("first").value;

    var maincontent = "";
    maincontent = "<p>" + first + "</p>";
    document.getElementById("content").innerHTML = maincontent;

}
</script>
<body>
<input type="text" id="first" value="good">
<button onclick="displayResult();">Click me!!!</button>
<div id="content"></div>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T13:59:56.443

而不是这个：

```
var maincontent = document.getElementById("content").innerHTML;
maincontent = "<p>" + first;` 
```

试试这个：

```
document.getElementById("content").innerHTML = "<p>" + first; 
```

您可能还想使用 .innerHTML 来获得“第一”，而不是 .value？我不确定“第一”是什么样的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T14:13:15.253

你的 id 为 "contend" 的元素是什么，一个 div？td？tr? 或者 ？它应该是这样的

```
 <div id='content'> 
   </div> 
```

然后这是javascript代码

```
document.getElementById("content").innerHTML = "<p>" + first + middle + last + "</p>" 
```

# php - PHP 中奇怪的 $_SESSION 行为

> ID：12653294
> 
> 赞同：0
> 
> 时间：2012-09-29T13:56:11.350
> 
> 标签：php, javascript, jquery

> **可能重复：**
> [如何使 php 脚本并行运行？](https://stackoverflow.com/questions/6618026/how-to-make-php-scripts-run-in-parallel)

我目前对PHP 中的[`$_SESSION`超全局有一个（在我看来）奇怪的问题。](http://php.net/manual/en/reserved.variables.session.php)

在页面 unload( `$(window).unload`) 上，jQuery 向`save.php`.

它包含一些应保存在`$_SESSION["data"]`. 当当前页面仍然显示时，我可以获取对象并显示其中包含的`jqXHR`一些测试字符串。但在下一页上，这些数据尚不可用。我只需要重新加载，一切都很好。`responseText``alert()`

在我看来，我的浏览器（Firefox/Chrome）在发布请求尚未完成时在后台加载下一页。还是有问题`$_SESSION`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:07:03.790

可能将事件附加到`window.unload`不是一个好主意。浏览器可能会先获取下一页然后调用事件，在这种情况下，您的看到没有改变（还）。因此，您可以附加到导致导航的事件，而不是附加到卸载事件

例如：

*   附加到链接单击，取消默认行为，调用您的 ajax save.php 脚本，然后使用手动导航`window.location.href`
*   附加到表单帖子，取消帖子，调用ajax然后发布表单......

希望有所帮助

# ruby-on-rails-3 - Active Model、Active Record 和 Active Resource 的区别

> ID：12653296
> 
> 赞同：67
> 
> 时间：2012-09-29T13:56:55.827
> 
> 标签：ruby-on-rails-3, rails-activerecord, activemodel, activeresource

有没有人可以通过定义 Active Model、Active Record 和 Active Resource 之间的确切区别来帮助我。我已经做了足够的谷歌搜索以找到确切的区别，但没有得到任何具体的东西可以说明它们之间的确切区别。现在他们在我看来都一样。所以请给我一些具体点的适当答案。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-10-07T01:54:54.890

Rails 3 在设计时考虑了模块化。每个模块都有自己的用途和功能。

**ActiveModel**：该组件是在 Rails 3 中创建的。他们将所有与 Rails 2 ActiveRecord 数据库无关的模型相关部分移到 ActiveModel 中。所以 ActiveModel 包括验证之类的东西。更多信息：[http ://www.rubyinside.com/rails-3-0s-activemodel-how-to-give-ruby-classes-some-activerecord-magic-2937.html](http://www.rubyinside.com/rails-3-0s-activemodel-how-to-give-ruby-classes-some-activerecord-magic-2937.html)

**ActiveRecord**：这是将类关联到数据库的组件。这将为类提供一些功能，例如使从数据库中提取记录变得容易的方法（一个例子是 find 方法）。

**ActiveResource**：类似于 ActiveRecord。但是，ActiveResource 对象不是由数据库支持，而是由另一个应用程序通过 Web 服务 API 支持。更多信息： http: [//ofps.oreilly.com/titles/9780596521424/activeresource_id59243.html](http://ofps.oreilly.com/titles/9780596521424/activeresource_id59243.html)

（无法弄清楚 ActiveBase ......你从哪里听到的？）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-12-13T11:02:58.853

我的理解：

ActiveModel + 数据库支持 = ActiveRecord

通过 WebService API 的 ActiveModel = ActiveResource

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-10-10T01:30:40.177

**ActiveModel** [https://github.com/rails/rails/tree/master/activemodel](https://github.com/rails/rails/tree/master/activemodel)

想想一个不断需要验证的**超级模特。**

ActiveModel 可用于许多事情，但主要用于向模型/数据库记录添加验证支持。

* * *

**ActiveRecord** [https://github.com/rails/rails/tree/master/activerecord](https://github.com/rails/rails/tree/master/activerecord)

将**记录**视为表格记录。

在数据库中的新类和现有表之间建立映射。

在应用程序的上下文中，这些类通常称为模型。模型也可以连接到其他模型；这是通过定义关联来完成的。

```
 class Firm < ActiveRecord::Base
    has_many   :clients
    has_one    :account
    belongs_to :conglomerate
  end 
```

在后台，rails 使用 ActiveRecord 进行模式管理和定义记录的属性，充当 ORM（对象关系映射器）：

> “ **ORM：**在数据库表或视图中包装一行、封装数据库访问并在该数据上添加域逻辑的对象。”

架构概述了记录的属性。

* * *

**活动资​​源** [https://github.com/rails/activeresource](https://github.com/rails/activeresource)

想想像**URL**中的 R 或为许多 Rails 后端提供支持的**资源路由之类的资源。**

允许您通过 HTTP执行创建、**检索**、更新**或**删除**(** **CRUD ) 等操作。**

 ******```
 tyler = Person.find(1) 
```

当对资源路由发出请求时，RESTful 请求会映射其相应的 HTTP 动词及其数据库交互

```
 GET    => Person.find(1)
  POST   => Person.new(:name => 'Tyler', :favorite_page => 'stackoverflow') 
  PUT    => tyler.save
  DELETE => tyler.destroy 
```******

# javascript - 将对象（几乎）拖动到窗口外时，如何使窗口自动朝该方向滚动？

> ID：12653300
> 
> 赞同：5
> 
> 时间：2012-09-29T13:57:24.840
> 
> 标签：javascript, jquery, drag-and-drop, scroll

我使用 html5 来实现“拖放” [http://www.w3schools.com/html/html5_draganddrop.asp](http://www.w3schools.com/html/html5_draganddrop.asp)。

但是我的droppable box比较多，不能全部显示在窗口的显示区域。因此，当我将一个元素拖到超出显示范围的窗口的（例如）底部可放置框时，如何使窗口自动滚动？

像下面的网页一样，我想将图像拖放到底部矩形（第五个），它超出了显示区域的范围。当我将图像拖到窗口末尾时，如何使窗口自动滚动到底部？

```
<!DOCTYPE HTML>
<html>
<head>
<style type="text/css">
#div1,#div2,#div3,#div4,#div5
{
    width:350px;
    height:200px;
    padding:10px;
    border:1px solid #aaaaaa;
}     
</style>     
<script>     
function allowDrop(ev)     
{     
    ev.preventDefault();     
}     

function drag(ev)     
{     
    ev.dataTransfer.setData("Text",ev.target.id);     
}     

function drop(ev)     
{     
    ev.preventDefault();     
    var data = ev.dataTransfer.getData("Text");     
    ev.target.innerHTML += data+"droppedHere"+"<br/>";     
}     
</script>     
</head>     
<body>
<p>Drag the W3Schools image into the rectangle:</p>     
<img id="drag1" src="http://www.w3schools.com/html/img_logo.gif" draggable="true" ondragstart="drag(event)" width="336" height="69" />     

<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div3" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div4" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div5" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<br>     
</body>
</html> 
```

（您可以将上面的代码复制到左列[http://www.w3schools.com/html/tryit.asp?filename=tryhtml5_draganddrop](http://www.w3schools.com/html/tryit.asp?filename=tryhtml5_draganddrop)，并在右侧检查结果。我想在 jsfiddle 中显示，但不知道为什么代码在那里不起作用）

我注意到 Chrome 可以自动执行此操作，但不适用于 safari 等其他浏览器。

我还找到了相关的解决方案，例如“滚动功能”或“检测鼠标超出窗口”。但我只是无法根据他们的代码得到我想要的东西。如果有人可以提供更详细/完整的解决方案版本，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:50:36.750

我刚刚发现的是（至少在 Chrome 中）当拖动事件发生时，所有“mousemove”事件都被推迟，然后在放置（或取消）发生后一起触发。这扼杀了一个想法，但还有其他几个想法。这是一个：在视口底部添加一个高度为 40-50 px 的绝对定位的 div（所以它是粘性的），然后有一个 dragenter 事件来检测鼠标位置并滚动窗口（以及一个在顶部课程）：

```
<!DOCTYPE HTML>
<html>
<head>
<style type="text/css">
#div1,#div2,#div3,#div4,#div5
{
    width:350px;
    height:200px;
    padding:10px;
    border:1px solid #aaaaaa;
}     
#scrollBottomDetect { position: fixed; bottom: 0; height: 40px; width: 100%; border: 1px solid red; }
#scrollTopDetect { position: fixed; top: 0; height: 40px; width: 100%; border: 1px solid red; }
</style>     
<script>     
function allowDrop(ev)     
{     
    ev.preventDefault();     
}     

function drag(ev)     
{     
    ev.dataTransfer.setData("Text",ev.target.id);     
}     

function drop(ev)     
{     
    ev.preventDefault();     
    var data = ev.dataTransfer.getData("Text");     
    ev.target.innerHTML += data+"droppedHere"+"<br/>";     
}     

function scrollPage(diff) {
    window.scrollTo(window.scrollX, (window.scrollY + diff));
}

</script>     
</head>     
<body>
<div id="scrollTopDetect" ondragover="scrollPage(-10)"></div>
<p>Drag the W3Schools image into the rectangle:</p>     
<img id="drag1" src="http://www.w3schools.com/html/img_logo.gif" draggable="true" ondragstart="drag(event)" width="336" height="69" />     

<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div3" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div4" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<div id="div5" ondrop="drop(event)" ondragover="allowDrop(event)"></div>     
<br>     
<div id="scrollBottomDetect" ondragover="scrollPage(10)"></div>
</body>
</html> 
```

# ruby-on-rails - 使用 pg_search gem 在 Rails 上搜索子字符串的 PG 全文搜索

> ID：12653301
> 
> 赞同：4
> 
> 时间：2012-09-29T13:57:27.093
> 
> 标签：ruby-on-rails, postgresql, full-text-search, pg-search

我正在使用 Pg 全文搜索进行搜索。当我在 Rails 上使用 Ruby 时，我正在使用 pg_search gem。我如何将它配置为也对子字符串产生影响。

```
pg_search_scope :search_by_detail, 
              :against => [
                   [:first_name,'A'],
                   [:last_name,'B'],
                   [:email,'C']
              ],                  
              :using => {
                :tsearch => {:prefix => true}
              } 
```

现在，如果子字符串在开头，它会命中，但如果子字符串在中间，它不会命中

示例 它对 sdate@example.com 进行了命中，但对 example.com 没有命中

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T18:30:07.207

我是 pg_search 的作者和维护者。

不幸的是，默认情况下 PostgreSQL 的 tsearch 不会拆分电子邮件地址并允许您匹配部分。但是，如果您打开`:trigram`搜索，它可能会起作用，因为它匹配出现在可搜索文本中任何位置的任意子字符串。

```
pg_search_scope :search_by_detail,
                :against => [
                  [:first_name,'A'],
                  [:last_name,'B'],
                  [:email,'C']
                ],
                :using => {
                  :tsearch => {:prefix => true},
                  :trigram => {}
                } 
```

我通过在 psql 中运行以下命令确认了这一点：

```
grant=# SELECT plainto_tsquery('example.com') @@ to_tsvector('english', 'name@example.com');
 ?column? 
----------
 f
(1 row) 
```

我知道解析器确实检测到电子邮件地址，所以我认为它一定是可能的。但这将涉及在 PostgreSQL 中构建一个[文本搜索字典](http://www.postgresql.org/docs/9.2/static/textsearch-dictionaries.html)，该字典将正确地将电子邮件地址拆分为令牌。

以下是文本搜索解析器知道它是电子邮件地址的证据：

```
grant=# SELECT ts_debug('english', 'name@example.com');
                                  ts_debug                                   
-----------------------------------------------------------------------------
 (email,"Email address",name@example.com,{simple},simple,{name@example.com})
(1 row) 
```

# java - 在不同的内部框架中为 jTables 创建不同的数据模型

> ID：12653309
> 
> 赞同：1
> 
> 时间：2012-09-29T13:58:30.913
> 
> 标签：java, swing, jtable, jinternalframe, defaulttablemodel

首先，让我指出我是 Java 桌面 GUI 编程的新手。我创建了一个可以容纳多个 JInternalFrames 的桌面窗格。目前，每个 JinternalFrame 都包含相同的 GUI 组件，并且可以通过单击菜单项来创建新的 jInternalFrame（此处称为内部框架）。

每个内部 Frame 上的元素如下：3 个 Jlabels、3 个 JTextFields、一个 Jbutton 和一个 Jtable。渲染第一个内部框架后，我用信息填充 3 个文本字段，然后单击按钮，一个新行被添加到表中。该行包含用于填充文本字段的信息。

打开第二个内部框架在视觉上给了我第一个的确切界面。我以同样的方式填充这个框架，点击按钮，瞧，第二个框架中的表格被填充了。

当我返回之前的内部框架时，问题就出现了。我可以毫无问题地输入文本字段，但单击填充表格的按钮会导致填充第二个内部框架中的表格。**我怀疑我正在共享一个数据模型，但不确定如何在每个框架的 GUI 相同时为 jInternalFrame jTables 创建不同的数据模型**。

下面是代码（因为我是 Java Desktop GUI 开发的新手，所以我遵循了 Oracle How-To 之一来呈现内部框架本身 - 非常简单的示例）：

```
public class InternalFrames extends JFrame 
                        implements ActionListener  {
private static final long serialVersionUID = 1L;
JDesktopPane desktop;

JLabel label1;
JLabel label2;
JLabel label3;
JLabel label4;

JTextField text1;
JTextField text2;
JTextField text3;

JTable table1;

public InternalFrames(){
    super("Practice Internal Frames");

    int inset = 50;
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    setBounds(inset,inset,screenSize.width - (inset*2),screenSize.height - (inset*2));
    desktop = new JDesktopPane();

    createFrame();
    setContentPane(desktop);

    setJMenuBar(setMenuBar());

}

protected JMenuBar setMenuBar(){

    JMenuBar menuBar = new JMenuBar();
    JMenu menu = new JMenu("Document");
    menu.setMnemonic(KeyEvent.VK_D);
    menuBar.add(menu);

    JMenuItem menuItem = new JMenuItem("New");
    menuItem.setMnemonic(KeyEvent.VK_N);
    menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_D, ActionEvent.ALT_MASK));
    menuItem.setActionCommand("New");
    menuItem.addActionListener(this);
    menu.add(menuItem);

    menuItem = new JMenuItem("Quit");
    menuItem.setMnemonic(KeyEvent.VK_Q);
    menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_Q, ActionEvent.ALT_MASK));
    menuItem.setActionCommand("Quit");
    menuItem.addActionListener(this);
    menu.add(menuItem);

    return menuBar;
}

public void actionPerformed(ActionEvent e){
    if ("New".equals(e.getActionCommand())){
        createFrame();
    } else if ("Quit".equals(e.getActionCommand())){

    }

}

protected void createFrame(){
    InternalFrame internalFrame = new InternalFrame();

    label1 = new JLabel("Name");
    label2 = new JLabel("Email Address:");
    label3 = new JLabel("Mobile Number:");
    label4 = new JLabel("Test Frames");

    label1.setSize(100,10);
    label2.setSize(100,10);
    label3.setSize(100,10);
    label4.setSize(200,10);

    text1 = new JTextField(40);
    text2 = new JTextField(40);
    text3 = new JTextField(40);

    internalFrame.setLayout(new MigLayout());
    internalFrame.getContentPane().add(label1);
    internalFrame.getContentPane().add(text1, "wrap");
    internalFrame.getContentPane().add(label2);
    internalFrame.getContentPane().add(text2, "wrap");
    internalFrame.getContentPane().add(label3);
    internalFrame.getContentPane().add(text3,"wrap");
    internalFrame.getContentPane().add(label4, "span 2, wrap");
    internalFrame.getContentPane().add(new JScrollPane(createTable()), "span 2 2, wrap");
    internalFrame.getContentPane().add(createButton());

    internalFrame.setVisible(true);
    desktop.add(internalFrame);

    try {

        internalFrame.setSelected(true);

    } catch (java.beans.PropertyVetoException pve){ }

}

protected JTable createTable(){
    DefaultTableModel dModel = new DefaultTableModel();
    table1 = new JTable(dModel);
    dModel.addColumn("Name");
    dModel.addColumn("Email Address");
    dModel.addColumn("Mobile Number");

    return table1;
}

protected JButton createButton(){
    JButton button1 = new JButton("Add New List Member");
    button1.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent e)
        {
            //Execute when button is pressed
            System.out.println("You clicked the button");
            populateTable(table1);
        }
    });
    return button1;
}

protected void populateTable(JTable theTable){

    if (validateEntry() == 0)
    {
        ListMembers listMember = new ListMembers();
        listMember.setName(text1.getText());
        listMember.setEmailAddress(text2.getText());
        listMember.setMobilePhone(text3.getText());
        Object[] data = {listMember.getName(),listMember.getEmailAddress(),listMember.getMobilePhone()};
        DefaultTableModel dm = (DefaultTableModel) table1.getModel();
        dm.addRow(data);

    }

}

private static void createAndShowGUI(){
    JFrame.setDefaultLookAndFeelDecorated(true);
    InternalFrames internalFrame = new InternalFrames();
    internalFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    internalFrame.setVisible(true);

}

public static void main(String[] args) {
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            createAndShowGUI();
        }
    });

}
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:05:27.663

Each time you create a new frame, you initialize a single field (`table1`) with this newly created table. And the listener of every button you create populates the table referenced by this unique `table1` variable. The same goes for your text fields, etc.

Either only use local variables, and pass them between methods (for example, you need to pass the table you just created to the method creating the button, in order for this button to populate this table. Or you extract all the code to a new class, `MyInternalFrame` (choose a better name), make the table, textfields and buttons instance fields of this new class, and create a new instance of this MyInternalFrame class each time you need a new one.

This second solution looks like the best one to me.

# php - 如何从数组中输出单个值？

> ID：12653313
> 
> 赞同：0
> 
> 时间：2012-09-29T13:59:02.063
> 
> 标签：php, sql, arrays

我有一些 SQL 进行标准搜索，然后在控制器 (INDEX.PHP) 中将这些结果存储到一个数组中。摘录如下所示：

INDEX.PHP 提取

```
 foreach ($s as $row)
    {
        $results[] = array(
                            'id' => $row['id'],
                            'name' => $row['name'],
                            'gender' => $row['gender'], 
                            'county' => $row['county'], 
                            'constituency' => $row['constituency'], 
                            'qualifications' => $row['qualifications'],
                            'bio' => $row['bio'],
                            'monday' => $row['monday'],
                            'tuesday' => $row['tuesday'],
                            'wednesday' => $row['wednesday'],
                            'thursday' => $row['thursday'],
                            'friday' => $row['friday'],
                            'saturday' => $row['saturday'],
                            'sunday' => $row['sunday'],
                            'filename' => $row['filename'],
                            'mimetype' => $row['mimetype']
                            );
    }
    include 'profiles-small.html.php';
    exit(); 
```

然后在“profiles.html.php”页面中，我使用 foreach 循环输出我的结果，如下所示：

PROFILES-SMALL.PHP 提取

```
 <?php if (isset($results)): ?>

    <?php foreach ($results as $result): ?>

    <h1 class="margin-top">Search Results for <span class="red"><?php htmlout($result['constituency']); ?></span></h1>

    <ol class="small-profile">

    <img class="small-img" src="<?php if (!empty($result['filename'])) echo('?action=view&id=' . $result['id']); else echo "/img/profile_coming_soon.jpg" ?>" width="100" height="100" />

    <li><?php htmlout($result['name']); ?></li>

    <!--<li class="list-left2">Constituency:</li>-->
    <li><?php htmlout($result['constituency']); ?></li>

    <li><?php htmlout($result['qualifications']); ?></li>

    </ol>

    <form action="?" method="post">

    <div id="buttons">

    <input type="hidden" name="id" value="<?php htmlout($result['id']); ?>">

    <a href="?more&id=<?php htmlout($result['id']); ?>">View full profile</a>

    <!--<input type="submit" name="action" value="Edit" class="buttons">
    <input type="submit" name="action" value="Delete" class="deletebutton">-->

    </div>
    </form>

    <?php endforeach; ?>

    <?php endif; ?> 
```

现在在上面的摘录中，有一个 h1 标签，应该只在页面顶部显示一次。

我知道因为它在 foreach 循环中，所以对于每个结果，这个 h1 标签也将被输出。

问题是，我知道它可能非常简单，但我不确定如何在循环上方输出这个值，所以它只显示一次。

该值在一个名为 $results 的数组中，所以我想我可以使用以下内容：

```
<?php htmlout($results['constituency']); ?> 
```

现在看这个，我可以看到这没有意义，因为 $results 数组可能包含几个选区结果。

即使返回了几个结果，它们都将包含相同的选区值，所以我想我正在寻找类似的东西：

*   返回唯一值的循环（不要认为存在）
*   控制器 (INDEX.PHP) 中将此选区存储为我输出的变量的一种方式。

第二种选择可能是要走的路，但是我对此有另一个问题。

到目前为止我所学的 PHP 总是将结果输出到一个数组中。所以我会有类似的东西：

```
 $sql = "SELECT * FROM pt";

$s = $pdo->query($sql); 
```

然后我会使用如上所示：

```
foreach ($s as $row)
{
    $results[] = array(......... 
```

如何将查询结果存储到变量中？例如

```
$constituency = "SELECT name from constituency WHERE id = $constituencyid";

$s = $pdo->query($constituency);

    $result = $s (Not allowed as this is a PDO object but hopefully you can see what I am thinking) 
```

好的，非常感谢任何人都可以在这方面给我的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:31:48.233

使用以下函数获取数组`constituency`

```
$constituencies  = array_map(function($val){
  return $val['constituency'];
}, $results); 
```

使用以下代码获取`constituency`变量

```
$sql = "SELECT name from constituency WHERE id = ".$pdo->quote($constituencyid);
$stmt = $pdo->query($sql);
$row  = $stmt->fetch();
$constituency = $row['name']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:03:17.213

实际上，有一个叫做 PHP 的函数，`array_unique()`你应该看看 PHP 手册： http: [//php.net/manual/en/function.array-unique.php](http://php.net/manual/en/function.array-unique.php)

# html - CSS，HTML标签问题

> ID：12653325
> 
> 赞同：-1
> 
> 时间：2012-09-29T14:00:10.883
> 
> 标签：html, css, twitter-bootstrap

我有一个问题

```
<ul class='nav'>            
        <li>
          <a class='' href='index.html'> Home </a>
        </li>

        <li>
            <li class="dropdown">
            <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="#">Dropdown <b class="caret"></b></a>
            <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
              <li><a tabindex="-1" href="#">Action</a></li>
              <li><a tabindex="-1" href="#">Another action</a></li>
              <li><a tabindex="-1" href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a tabindex="-1" href="#">Separated link</a></li>
            </ul>
          </li>
        </li>
        </ul> 
```

用于此的 CSS 代码

```
 .topbar div>ul a,  .nav a
  {display:block;float:none;outline: 0;padding:8px 6px 6px;line-height:12px;text-    decoration:none;border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  border-top-left-radius:5px;
  border-top-right-radius:5px;} 
```

我只希望这些属性带有 Home 和 DropDown 按钮，我不想让这些属性用于我的选项卡按钮，即 Action、Another Actions 按钮。但是每当我尝试编辑它时，整个事情都会变得一团糟。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:06:22.520

试试这个代码：

```
 <li>
      <a class='dropdown-toggle' href='index.html'> Home </a>
    </li>

    <li>
        <li class="dropdown">
        <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="#">Dropdown <b class="caret"></b></a>
        <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
          <li><a tabindex="-1" href="#">Action</a></li>
          <li><a tabindex="-1" href="#">Another action</a></li>
          <li><a tabindex="-1" href="#">Something else here</a></li>
          <li class="divider"></li>
          <li><a tabindex="-1" href="#">Separated link</a></li>
        </ul>
      </li>
    </li>
    </ul>

.dropdown-toggle
{
    display:block;
    float:none;outline: 0;
    padding:8px 6px 6px;
    line-height:12px;
    text-decoration:none;
    border-bottom-left-radius:5px;
    border-bottom-right-radius:5px;
    border-top-left-radius:5px;
    border-top-right-radius:5px;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:32:24.650

你的 html 看起来不对。一次翻倍`<li>`。

但这里是 CSS：

```
a{
    outline: 0;
}
ul.nav a{
    display:block;
    padding:8px 6px 6px;
    line-height:12px;
    text-decoration:none;
    border-radius:5px;
}
ul.nav ul a{
    padding:8px 6px 6px;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T14:04:57.503

将选择器更改为： .topbar div>ul li.dropdown > a, .nav a

# ios - 如何从沙盒中完全下载应用内购买进行测试

> ID：12653332
> 
> 赞同：0
> 
> 时间：2012-09-29T14:00:33.983
> 
> 标签：ios, in-app-purchase

我想知道如何从沙盒中完全下载应用内购买进行测试。我知道如何按照此处的说明使用屏幕截图方法测试产品有效性。[https://developer.apple.com/library/ios/#qa/qa2009/qa1329.html](https://developer.apple.com/library/ios/#qa/qa2009/qa1329.html)

但是我如何测试它以便应用内购买实际上进入我的手机以便我可以查看它，我真的需要上传二进制文件吗？

# c# - 3 位数字的订货单

> ID：12653335
> 
> 赞同：1
> 
> 时间：2012-09-29T14:01:02.717
> 
> 标签：c#, list

我有一个带有对象的 List<> ，其中包含多个字段，这些字段主要是数字。我想按这些数字中的 3 个对这个列表进行排序。我试过这个：

```
list = list.OrderBy(x => x.Val3).ThenBy(x => x.Val2)
                                .ThenBy(x => x.Val1).ToList(); 
```

效果很好，但仅适用于前两个订单/thenbys。第三个似乎根本没有运行。我可以对其中两个值的任意组合进行排序，但总是忽略第三个。

我还没有尝试过非 LINQ 方法，因为我只是好奇这里的问题出在哪里。你不能对 3 个值进行排序吗？这里有什么问题？万一这很重要，3 是 ushort，而 2 和 1 是 uint。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:26:27.303

我不确定是否有更好的解决方案。如果我是你，我会通过乘以一个大值来加权 value2。就像：

```
list = list.OrderBy(x => x.Val3).ThenBy(x => x.Val2 * 10000 + x.Val1).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:04:15.900

这并不能解决问题，因为它可以正常工作。但是，也许您可​​以将您的代码与此进行比较，看看它有何不同？

```
public class Foo
{
    public string Name { get; set; }
    public uint Val1 { get; set; }
    public uint Val2 { get; set; }
    public ushort Val3 { get; set; }
}

    static void Main(string[] args)
    {
        OrderFoos();

        Console.WriteLine("Press any key to end.");
        Console.ReadKey();
    }

    private static void OrderFoos()
    {
        List<Foo> list = new List<Foo>();
        list.Add(new Foo() { Name = "2nd", Val1 = 2, Val2 = 1, Val3 = 1 });
        list.Add(new Foo() { Name = "1st", Val1 = 1, Val2 = 1, Val3 = 1 });
        list.Add(new Foo() { Name = "3rd", Val1 = 1, Val2 = 2, Val3 = 1 });
        list.Add(new Foo() { Name = "4th", Val1 = 2, Val2 = 1, Val3 = 2 });
        list.Add(new Foo() { Name = "6th", Val1 = 4, Val2 = 1, Val3 = 3 });
        list.Add(new Foo() { Name = "5th", Val1 = 3, Val2 = 1, Val3 = 3 });            

        list = list.OrderBy(x => x.Val3).ThenBy(x => x.Val2).ThenBy(x => x.Val1).ToList();

        list.ForEach(x => Console.WriteLine(x.Name));
    } 
```

![在此处输入图像描述](../Images/a9a40253ea12add2697f5b5e3a3a9810.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:36:27.913

我想你可以试试这个黑客：

```
 list = list.OrderBy(x => x.Val2).OrderBy(x => x.Val3).ThenBy(x => x.Val1).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T14:47:51.907

[ThenBy](http://msdn.microsoft.com/en-us/library/bb534743.aspx)的文档说

> “这种设计使您能够通过应用任意数量的 ThenBy 或 ThenByDescending 方法来指定多个排序标准。”

因此，您作为示例代码提供的内容应该可以工作。在没有指定比较器的情况下，ThenBy 使用[默认比较器](http://msdn.microsoft.com/en-us/library/azhsac5f.aspx)。您确定 val1 可以使用默认比较器进行排序吗？

* * *

编辑：哇！刚刚看到“我可以对其中两个值的任意组合进行排序，但总是忽略第三个。” 所以似乎 val1 可以通过默认比较器排序。

@Bob Horn 的文档和答案表明您的示例应该有效。您可以添加您订购的对象的更多详细信息吗？

# google-chrome - chrome中的神秘布局错误

> ID：12653339
> 
> 赞同：0
> 
> 时间：2012-09-29T14:01:31.140
> 
> 标签：google-chrome, layout

对不起图片，但是这个bug随机出现，我无法提供jsFiddle代码，因为我不知道如何重现它。

这是我的网站的一部分，在主要浏览器中看起来不错： ![有效布局](../Images/96530d347fde3ad21ba3e43631b03269.png)

通常它在 Chrome 中看起来不错，但有时我会得到这样的布局：

![布局无效](../Images/152a9f95a4272a21cbb15de584d11c97.png)

此错误出现在所有站点页面上，而不仅仅是此示例页面。

当我尝试打开开发工具并更改某些布局时，错误最终会在整个站点上消失，并且在重新加载几次浏览器之前我无法重现它。

我也知道它是旧的 Chrome 错误，它至少存在一年，所以我相信有人已经知道如何解决它。

请帮助我，任何帮助表示赞赏。

PS我有“干净”的浏览器，没有扩展。其他人也看到了这个错误，不仅仅是我:)。

PPS 如果有人想重现此错误 - 您可以关注您在图片上看到的~~**站点**~~（应请求删除链接），但正如我之前所说的 - 它有时会出现，如果没有出现，请关闭并打开浏览器并重试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:13:16.273

我怀疑当最终下载此菜单使用的字体并可用时，最终重排未纠正 FOUC。

项目的样式使用“SignikaNegativeBold”字体。此字体`@font-face`在第三个 CSS 文件中加载。已经很晚了，尝试在任何图像或其他资源之前尽快加载它，在第一个 CSS 文件的开头。在此之前只`@import`应编写声明，否则将无法正常工作。

还可以尝试只加载一个 CSS 文件，将不同的 CSS 文件合并为一个（您应该继续处理许多 CSS 文件，只需将服务器上的它们合并为一个可供用户下载的新文件）。

无关：您声明`<html lang="ru" (...)>`但它对我来说显示为英语，我看不懂西里尔文；）您应该在多语言网站中动态更改声明的语言。`en`英文页面，`ru`俄文页面等

# type-conversion - 将 big.Int 的最后 8 位放入 uint8

> ID：12653340
> 
> 赞同：2
> 
> 时间：2012-09-29T14:01:35.780
> 
> 标签：type-conversion, go

我正在尝试编写密码生成器。它要求字符采用 ASCII 表示，但我正在尝试使用`crypto/rand`. 不过，这提供了`big.Int`格式的数字，我需要将相关的低 8 位转换为可在字符串中使用的形式。到目前为止，我已经尝试从`big.Int`to转换为没有运气。`uint8`

有没有一个好的和简单的方法来做到这一点？我已经看到了涉及 using `encoding/binary`to convert from `int64`to 的答案`[8]uint8`，但对于我的目的来说，这些似乎不必要地复杂。任何指导都将不胜感激:)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:57:31.117

```
package main

import (
        "fmt"
        "math/big"
)

func main() {
        mpInt := big.NewInt(0x123456789abcdef0)
        b := byte(mpInt.Int64())
        fmt.Printf("%02x", b)
} 
```

* * *

```
f0 
```

在行动：[http ://play.golang.org/p/92PbLdiVsP](http://play.golang.org/p/92PbLdiVsP)

* * *

编辑：Evan Shaw 在下面的评论中正确地指出，对于超出`int64`限制的大整数，上述代码实际上是不正确的。而不是从中提取它`big.Bytes`（这会复制代表`big.Int`IIRC 的所有位），使用它可能更高效`big.And`：

* * *

```
package main

import (
        "fmt"
        "log"
        "math/big"
)

func lsB(n *big.Int) byte {
        var m big.Int
        return byte(m.And(m.SetInt64(255), n).Int64())
}

func main() {
        var mpInt big.Int
        if _, ok := mpInt.SetString("0x123456789abcdef012342", 0); !ok {
                log.Fatal()
        }

        fmt.Printf("%02x", lsB(&mpInt))
} 
```

游乐场：[http ://play.golang.org/p/pgkGEFgb8-](http://play.golang.org/p/pgkGEFgb8-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T23:40:43.630

如果您想从中获取字节`crypto/rand`，我会完全跳过使用`big.Int`and`rand.Int()`并使用`rand.Read()`or `rand.Reader`：

```
package main

import (
    "crypto/rand"
    "fmt"
    "io"
)

// If you want just a byte at a time ...
// (you could change 'byte' to int8 if you prefer)    
func secureRandomByte() byte {
    data := make([]byte, 1)
    if _, err := rand.Read(data); err != nil {
        // handle error
        panic(err)
    }
    return data[0]
}

// If you want to read multiple bytes at a time ...
func genPassword(len int) (string, error) {
    data := make([]byte, len)
    if _, err := io.ReadFull(rand.Reader, data); err != nil {
        // handle error
        return "", err
    }
    for i := range data {
        // XXX quick munge into something printable
        data[i] &= 0x3F
        data[i] += 0x20
    }
    return string(data), nil
}

func main() {
    b := secureRandomByte()
    fmt.Printf("%T = %v\n", b, b)
    fmt.Println(genPassword(16))
} 
```

# asp.net-mvc - OutputCache 不允许更改站点语言

> ID：12653343
> 
> 赞同：1
> 
> 时间：2012-09-29T14:01:54.973
> 
> 标签：asp.net-mvc, asp.net-mvc-3, caching, localization, outputcache

我想使用 OutputCache 快速打开页面。

我在控制器中写道：

```
public class HomeController : Controller
{
[OutputCache(Duration=3600,VaryByParam="none", VaryByCustom="lang")]
public ActionResult Index()
{
   //........
 }

public ActionResult ChangeCulture( string lang, string returnUrl )
{
  Session["Culture"] = new CultureInfo( lang );
  return Redirect( returnUrl );
}
} 
```

在 Layout.cshtml 中：

```
<a href="@Url.Action( "ChangeCulture", "Home", new { lang = "en", returnUrl = this.Request.RawUrl } )">Eng</a>
<a href="@Url.Action( "ChangeCulture", "Home", new { lang = "az", returnUrl = this.Request.RawUrl } )">Az</a> 
```

在 Global.asax 中：

```
protected void Application_AcquireRequestState( object sender, EventArgs e )
{
//It's important to check whether session object is ready
if ( HttpContext.Current.Session != null )
{
CultureInfo ci = ( CultureInfo )this.Session["Culture"];

//Checking first if there is no value in session and set default language this can happen for first user's request
if ( ci == null )
{
//Sets default culture to english invariant
string langName = "az";

//Try to get values from Accept lang HTTP header
if ( HttpContext.Current.Request.UserLanguages != null &&
HttpContext.Current.Request.UserLanguages.Length != 0 )
{
//Gets accepted list 
langName = HttpContext.Current.Request.UserLanguages[0].Substring( 0, 2 );
}
ci = new CultureInfo( langName );
this.Session["Culture"] = ci;
}
//Finally setting culture for each request
Thread.CurrentThread.CurrentUICulture = ci;
Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture( ci.Name );
}
}

public override string GetVaryByCustomString( HttpContext context, string value )
{
if ( value.ToLower() == "lang" )
{
return Thread.CurrentThread.CurrentUICulture.Name;
}
return base.GetVaryByCustomString( context, value );
} 
```

但我无法更改网站语言。例如，我将语言切换为英语，它改变了，但后来想返回阿塞拜疆语言，它没有改变。我的错误是什么？（抱歉英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T12:41:33.370

我解决了自己，改变了

```
<globalization culture="en" uiCulture="en" /> 
```

至

```
 <globalization culture="auto" uiCulture="auto" /> 
```

在配置文件中。然后它起作用了。

# javascript - 等待动画完成，然后在 jQuery 中继续

> ID：12653345
> 
> 赞同：0
> 
> 时间：2012-09-29T14:01:57.797
> 
> 标签：javascript, jquery

无论如何要等待 jQuery 动画完成，然后再继续执行另一个命令？

例如，我想淡出/向上滑动一个元素，更改元素内的一些项目，然后将它们淡入/向下滑动。

如果我将语句一个接一个地放置，您可以在动画完成之前看到项目发生变化。

```
$('#item').fadeOut();
$('#item').html('Changed item');
$('#item').fadeIn(); 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:03:55.657

您可以在`fadeIn/fadeOut`. [jQuery 文档](http://api.jquery.com/fadeOut/)

```
$('#item').fadeOut('slow', function(){

     $('#item').html('Changed item');
     $('#item').fadeIn();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:05:35.060

您可以使用从中调用的*回调*`.fadeOut`方法，例如

```
$('#item').fadeOut('fast', function() {
    $(this).html('Changed item').fadeIn();
}); 
```

或使用底层*Deferred 对象*

```
$('#item').fadeOut('slow').promise().done(function() {
    $(this).html('Changed item').fadeIn();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:03:13.993

将回调函数传递给`fadeOut`.

```
$("#item").fadeOut(function() { 
                       $(this).html("changed").fadeIn();
                   }); 
```

这是你将在基本的 jQuery 教程中学到的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T14:04:54.397

```
$('#item').fadeOut('slow', function() { // do your stuff here }); 
```

欲了解更多信息：[http ://docs.jquery.com/Effects/fadeOut#speedcallback](http://docs.jquery.com/Effects/fadeOut#speedcallback)

# python - 如何在python中创建悬空指针（在堆栈或堆中）

> ID：12653346
> 
> 赞同：4
> 
> 时间：2012-09-29T14:02:08.370
> 
> 标签：python, python-3.x, pointers, heap-memory, stack-memory

我想知道有没有办法在 python 中创建一个悬空指针？我想我们必须手动删除一个对象，然后该对象的引用将指向一个对程序没有意义的位置。[我在这里](http://docs.python.org/library/weakref.html#example)找到了这个例子

```
import weakref
class Object:
    pass

o = Object()    #new instance
print ("o id is:",id(o))
r = weakref.ref(o)
print ("r id is:",id(r))
o2 = r()
print ("o2 id is:",id(o2))
print ("r() id is:",id(r()))
print (o is o2)         

del o,o2
print (r(),r)   #If the referent no longer exists, calling the reference object returns None

o = r()         # r is a weak reference object
if o is None:
    # referent has been garbage collected
    print ("Object has been deallocated; can't frobnicate.")
else:
    print ("Object is still live!")
    o.do_something_useful() 
```

在这个例子中，哪一个是悬空指针/引用？是 o 还是 r？我很困惑。是否也可以在堆栈中创建悬空指针？如果你愿意，给我一些简单的例子，这样我就可以理解它是怎么回事。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T20:41:06.963

所有 Python 对象都存在于堆上。堆栈仅用于函数调用。

调用弱引用对象会取消引用它并为您提供对该对象的强引用，如果该对象仍然存在的话。否则，你得到`None`. 在后一种情况下，您可以将弱引用称为“悬空”（`r`在您的示例中）。

然而，Python 没有任何与 C 相同的“悬空指针”的概念。`ctypes`创建一个引用已删除对象的名称（强引用）是不可能的（除非 Python 中的错误、错误的扩展模块或滥用类似 的模块），因为根据定义，强引用使它们的引用保持活动状态。另一方面，弱引用并不是真正的悬空指针，因为`None`如果它们的引用被删除，它们会自动解析为。

请注意，`ctypes`滥用可能会创建一个“真正的”悬空指针：

```
import ctypes
a = (1, 2, 3)
ctypes.pythonapi.Py_DecRef(ctypes.py_object(a))
print a 
```

当你`print a`现在未定义时会发生什么。它可能会使解释器崩溃、打印`(1, 2, 3)`、打印其他元组或执行随机函数。当然，这只是因为你滥用了`ctypes`; 这不是你应该*做的*事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:16:48.417

除非 Python 中的错误或扩展，否则无法引用已释放的对象。只要对象还活着，弱引用就会引用该对象，而不有助于保持它活着。在对象被释放的那一刻，弱引用评估为无，所以你永远不会得到悬空对象。（即使是在对象已经被释放并且弱引用取消引用到 None*之后调用弱引用的回调，所以你也不能复活它。）*

如果你可以引用一个真正的释放对象，Python 很可能会在第一次访问时崩溃，因为该对象之前持有的内存将被重用，并且该对象的类型和其他插槽将包含垃圾。Python 对象永远不会在堆栈上分配。

如果您有一个用例为什么需要使用悬空对象，您应该以问题的形式呈现该用例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:07:10.800

如果你创建一个弱引用，当被引用的对象被删除时（当它的引用计数达到零，或者是没有被其他任何东西引用的对象的封闭循环的一部分时），它就会变成“悬空”。这是可能的，因为`weakref`不会增加引用计数本身（这是弱引用的重点）。

发生这种情况时，每次您尝试“取消引用”弱引用对象（调用它）时，它都会返回`None`.

重要的是要记住，在 Python 中变量实际上是**名称**，指向对象。它们实际上是“强引用”。例子：

```
import weakref

class A:
    pass

# a new object is created, and the name "x" is set to reference the object,
# giving a reference count of 1
x = A() 

# a weak reference is created referencing the object that the name x references
# the reference count is still 1 though, because x is still the only strong
# reference
weak_reference = weakref.ref(x)

# the only strong reference to the object is deleted (x), reducing the reference
# count to 0 this means that the object is destroyed, and at this point
# "weak_reference" becomes dangling, and calls return None
del x

assert weak_reference() is None 
```

# php - drupal 7 Wysiwyg 添加另一个项目问题

> ID：12653347
> 
> 赞同：1
> 
> 时间：2012-09-29T14:02:16.093
> 
> 标签：php, drupal, drupal-7, drupal-modules

我正在使用带有“所见即所得编辑器 tinyMCE”的最新版本的 drupal 7

我创建了 1 个内容类型“列表”，因为我正在使用“所见即所得编辑器 tinyMCE”和无限项。

Drupal 7 使用“添加另一个项目”显示正确的表单

但是当我填写该字段并单击“添加另一个项目”时，填充的值是绝望的并显示“字段为空错误消息”

我有很多调试，我发现当drupal请求ajax调用时，提交字段值为空。意味着 druapl wysiwyg 模块启用以捕获编辑器值。

这不仅适用于 tinyMCE，也适用于其他编辑器。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T08:31:04.180

我有同样的问题，我找到了解决方法。（这有点傻，但它有效）

在添加其他项目或重新订购项目之前，只需单击`Disable rich-text`链接。这不会导致您的文字消失。

希望它对你有用，就像对我一样……穆罕默德。

# c# - 将 C# 与 C 函数互操作的性能损失

> ID：12653348
> 
> 赞同：0
> 
> 时间：2012-09-29T14:02:18.937
> 
> 标签：c#, c, interop, profiling

除非对我的代码进行实际性能测试（我正处于设计阶段），将 C 代码连接到 C# 的普遍共识是什么？什么时候这样做会有成果，什么时候没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:11:14.000

没有简单的答案。

大多数情况下，将参数编组到方法中和从方法中返回的开销可以忽略不计，并且通常远低于函数内部完成的处理（如果它不是一个微不足道的函数）。但是，在紧密的、性能关键的循环中执行此操作可能会违反您的性能限制。

开销本身很大程度上取决于参数的类型和方法的返回值。编组整数比包含包含许多字符串的结构的数组便宜。

如果不了解您的用例，就无法判断。

# ruby-on-rails - 如何预填充嵌套表单域

> ID：12653350
> 
> 赞同：0
> 
> 时间：2012-09-29T14:02:41.293
> 
> 标签：ruby-on-rails

我有一个使用“nested_form”gem 的简单嵌套表单。

它看起来像这样：

```
<%= nested_form_for @user do |f| %>

  <%= f.text_field :username, :size => 25 %>

<%= f.fields_for :teams do |team_form| %>
  <%= team_form.label :team_name, 'Name of your team' %>

<% end %>
<%= f.submit :value =>'submit' %>
<% end %> 
```

现在我想在我的新动作中预填充字段。虽然填充用户名字段很容易，但`@user.username = "someone"`我不知道如何访问嵌套“team_form”中的第一个嵌套字段“team_name”。

在 html 中，该字段如下所示：

```
<input id="user_teams_attributes_0_team_name" type="text" name="user[teams_attributes][0][team_name]"> 
```

任何想法如何预填充这个嵌套字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:36:06.667

通常`build`可以在您的控制器中用于此*（因为它不会导致对象`save`上的a `@user`）*`Team` ，将新实例附加到对象`:teams`上的集合中`@user`。在你的行动中

```
@user = User.new
@user.teams = [ Team.build(...) ] 
```

其中`...`包含`@user.teams.first`将在嵌套表单中显示的默认属性。

# javascript - 如何在浏览器窗口最小化以及通知来自服务器时播放通知警报声音

> ID：12653370
> 
> 赞同：1
> 
> 时间：2012-09-29T14:05:05.653
> 
> 标签：javascript, jquery, html, chat, google-talk

我有一个要求，只有在浏览器窗口最小化时才需要播放通知声音，类似于 GTalk 所做的。

我已经使用 JQuery 的 $(window).blur() 尝试过它，但它只在我手动模糊它时播放，而不是在通知到来并且窗口模糊时播放。

这是我尝试过的小提琴：http: [//jsfiddle.net/zfUnm/](http://jsfiddle.net/zfUnm/)

实际上这是一个聊天通知，只有在浏览器最小化时我才需要播放。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:53:37.760

我认为他们在最小化时不会播放它。每次收到新通知时他们都会调用它，但是当窗口处于活动状态时，他们会禁用声音。

```
var isactive = false;

function playSound(){
    if (isactive) return;
    playWav...;
}

onNotificaitonComes = playSound;

$(window).focus(function(){
    isactive = true;
}).blur(function(){
    isactive = false;
}); 
```

你可以在这里找到更多方法[有没有办法检测浏览器窗口当前是否处于活动状态？](https://stackoverflow.com/questions/1060008/is-there-a-way-to-detect-if-a-browser-window-is-not-currently-active)

# spring - hibernate @ManyToOne 没有表关系

> ID：12653373
> 
> 赞同：1
> 
> 时间：2012-09-29T14:05:28.307
> 
> 标签：spring, hibernate, querydsl

目前使用：

*   休眠 4.0.1.Final
*   Spring-data-jpa：1.0.3.RELEASE
*   查询DSL：2.3.0
*   MySQL 5.x

我有一个有趣的问题，我还没有找到答案或线索。我有两个没有外键或其他关系的表。但是为了尝试解决这个问题，我添加了一个。我希望我的用户实体持有它的用户角色。这种模式在整个数据库中重复出现，但这是最容易描述的。
这是我的表：

**用户**

```
userId           bigint(20) PK
password         varchar(255)
status           int(11)
userName         varchar(255)
userRoleId       long

CONSTRAINT `FK_USERROLE` FOREIGN KEY (`userRoleId`) REFERENCES `UserRole` (`userRoleId`) 
```

**用户角色**

```
userRoleId       bigint(20) PK
userRoleDescription varchar(255)
userRoleDescriptionShort varchar(255) 
```

这是我的课程： **User.java**

```
import javax.persistence.ElementCollection;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Transient;
import javax.xml.bind.annotation.XmlRootElement;
@Entity
@XmlRootElement(name = "User")
public class User  {
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long userId;
private String password;
private int status;
private String userName;

@ManyToOne
@JoinColumn(name = "userRoleId")
private UserRole userRole;
public UserRole getUserRole() {
    return userRole;
}

public void setUserRole(UserRole userRole) {
    this.userRole = userRole;
} 
```

**用户角色.java**

```
@Entity
@XmlRootElement(name = "userRole")
public class UserRole {
private Long userRoleId;
private String userRoleDescription;
private String userRoleDescriptionShort;

@ElementCollection
@OneToMany(mappedBy = "userRole")
private List<User> users;

public UserRole() {...}

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
public Long getUserRoleId() {...    }

@OneToMany(mappedBy = "userRole")
public List<User> getUsers() {...} 
```

因此，您可以看到我试图将 UserRole.userRoleId 与用户相关联的位置。我想也许 Hibernate 会在用户更新时构建映射并检索/关联 UserRole。

我已经回去并编辑了这篇文章以在表之间使用外键，但是在应用服务器启动时我得到了这个：

```
Caused by: org.hibernate.MappingException: Could not determine type for: java.util.List, at table: UserRole, for columns: [org.hibernate.mapping.Column(users)]
at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:304)
at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:288)
at org.hibernate.mapping.Property.isValid(Property.java:216)
at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:467)
at org.hibernate.mapping.RootClass.validate(RootClass.java:268)
at org.hibernate.cfg.Configuration.validate(Configuration.java:1287)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1729)
at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:84)
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904) 
```

我查找了该错误，该错误似乎与 JPA 和瞬态变量有关，但此处并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:30:45.643

如果我是你，我会先清理注释，禁止在同一个实体中同时注释 getter 和字段，这可能会导致意想不到的结果......

```
@ElementCollection
@OneToMany(mappedBy = "userRole")
private List<User> users;

@OneToMany(mappedBy = "userRole")
public List<User> getUsers() {...} 
```

应简化为：

```
@ElementCollection
@OneToMany(mappedBy = "userRole")
public List<User> getUsers() {...} 
```

# algorithm - ACM MIPT - 图形存在之谜 - 示例不清楚

> ID：12653374
> 
> 赞同：0
> 
> 时间：2012-09-29T14:05:28.960
> 
> 标签：algorithm

这是参考“图形存在”问题 - [http://acm.mipt.ru/judge/problems.pl?problem=110](http://acm.mipt.ru/judge/problems.pl?problem=110)。有人可以解释为什么示例 1 中没有树但示例 2 中有树吗？在这两个示例中，顶点 0、1、2 和 3 相互连接。以下是问题陈述和示例供您参考：

```
你会得到一个图表中的距离矩阵。
您应该检查此图是否可能是一棵树或一组树（森林）。
边长为 0 或正整数。

输入：第一行包含顶点数 N。
接下来的 N 行包含矩阵（仅矩阵的左下三角形）。
距离 -1 对应于无限距离。

输出：输出YES或NO。如果是，那么下一行应该包含边列表
树（具有给定距离矩阵的任何树（森林））。
每条边都由其末端的两个标识符编码。
顶点标识符是数字 0、1、...、N-1。

输入#1
4
0
1 0
1 1 0
1 1 1 0

输出#1
不

输入#2
5
0
1 0
2 1 0
3 2 1 0
-1 -1 -1 -1 0

输出#2
是的
0 1
1 2
2 3

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:16:12.760

这个问题不是很好地从它的[俄语原文](http://acm.mipt.ru/judge/problems.pl?problem=110&lang=ru)翻译过来的。

给定的矩阵不是人们可能得出的结论的图中边的矩阵，而是一个距离矩阵。每条边~~的权重可能为 1，但我不完全确定~~是否有非负权重。必须检查矩阵是否**可以**通过一棵树或一片森林来实现。

也就是说，在第一个示例中所有顶点都是连接的，但第二个示例可以实现图形如下所示：

```
 Example 2:
    (0) - (1) - (2) - (3)  (4) 
```

示例 1 中的图形是

```
 Example 1:
    (0) - (1) - (2) - (3)
     |_____|_____|     |     
     |     |___________|
     |_________________| 
```

# opengl-4 - 延迟着色和背景颜色

> ID：12653378
> 
> 赞同：1
> 
> 时间：2012-09-29T14:06:09.227
> 
> 标签：opengl-4

我实现了一个简化的延迟着色（我不计算点光源的边界），在填充 g-buffer 之后，我只使用一个全屏四边形来计算光照。我在第二阶段使用混合 (glBlendFunc(GL_ONE, GL_ONE)) 来处理多个灯光。然后 glClearColor 中的 rgb 值应设置为 0，以获得正确的结果。填充 g 缓冲区时，glClearColor 可以是任何颜色（某些颜色可能只改变最终图像中的背景颜色）。现在我想知道如何在最终图像中设置背景颜色。一种方法是在填充 g 缓冲区期间使用 glClearColor(0,0,0)，然后在片段着色器中使用以下 if 语句：

```
if((normal.x == 0.0) && (normal.y == 0.0) && (normal.z == 0.0))
{
    fragColor = vec4(1, 0, 0, 1); // here we can set a background color
}
else
{
    fragColor = computeLighting(worldPos, normal, diffM, specM, specMS);
} 
```

它工作正常，但 if 语句可能会导致一些性能损失。这是设置背景颜色的唯一方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T06:17:36.940

不确定我是否理解问题所在，但这里有一些带有很多假设的想法。

你正在考虑做这样的事情吗？：

*   使用您想要的背景颜色清除 gbuffer 中的漫反射附件（但是……您不想使用此值清除其他纹理，例如法线！）
*   填充 gbuffer 后，几何体未覆盖的任何内容仍应具有背景颜色（在您的漫反射附件中）
*   如果没有为片段定义法线，则在最后阶段手动编写硬编码颜色。

我假设您的渲染器正在执行以下操作：

*   填充 gbuffer（带有多个附件的 FBO 中的漫反射、法线、深度等）
*   对于每个灯光，您将全屏四边形叠加混合渲染到单独的 FBO（灯光累积缓冲区）。
*   最后，将 gbuffer 中的漫反射附件与光累积缓冲区结合起来，将最终结果渲染到屏幕上。

您的着色器确实没有理由像这样负责编写背景颜色。我实际上也会渲染背景中的内容，并始终使用 0 值清除 gbuffer。我想当你在最后一个阶段结合漫反射和光时，事情可能会出错，所以使用进一步解释的模板方法可能更简单。我个人将材质索引存储在漫反射颜色的 alpha 通道中，然后将所有材质属性上传到纹理中。

在我的材料中，我有两个标量（以及更多......）：

*   环境重量
*   轻的

结合漫反射缓冲区和光缓冲区时（大大简化）：

```
FinalColor = Diffuse * AmbientWeight + Diffuse * Light * LightWeight 
```

如果您的背景使用材质 0 且 AmbientWeight = 1 和 LightWeight = 0，则 FinalColor 将始终是漫反射缓冲区中的原始值。

许多简单的延迟渲染器只是这样计算最终结果：

`FinalColor = Diffuse * Light`（来自漫反射缓冲区的片段 * 来自光缓冲区的片段）

在您的情况下，这当然会导致您的背景颜色消失，因为这些片段永远不会被点亮。（`Diffuse * 0`始终是结果）您可以使用漫反射缓冲区中的 alpha 通道作为 AmbientWeight 以获得一些快速结果。

```
FinalColor = Diffuse * Diffuse.a + Diffuse * Light 
```

在性能方面：

这真的很难预测。跳过着色器中的最终光照计算可能会给您带来一些好处，但在您到达此阶段之前，您已经完成了所有 gbuffer 读取和解包。无论着色器返回什么，您最终都会通过混合操作影响整个灯光缓冲区，并且您会读取每个灯光的整个 gbuffer。检查法线缓冲区中的所有组件是否为 0 只会触发没有几何图形的区域。当每盏灯使用全屏四边形时，您将遇到很多瓶颈。

从读取位置缓冲区（或从深度缓冲区重建位置）开始，然后确定您的点光是否无法到达片段并在执行任何其他操作之前将其丢弃可能会有所帮助。对于较小的灯光，您最终不会从每个片段的 gbuffer 中读取所有内容。这实际上取决于您的 gbuffer 的大小、渲染的内容、灯光的大小以及渲染的灯光数量。

动态分支也可以降低性能，但有时可能是“较小的邪恶”。我尽量避免。

额外的 ：

当谈到“背景颜色”时，我个人使用模板缓冲区用天空盒或类似的东西填充背景。在编写漫反射缓冲区时构建模板蒙版，在使用反向蒙版渲染背景时，只有背景片段受到影响（没有深度测试或深度写入）。如果我的整个场景都被几何体覆盖，那么就不会写入任何片段。这假设您正在将最终结果写入使用与 gbuffer 相同深度附件的第三个 FBO。（Depth24 + Stencil8 缓冲区）

除了使用全屏四边形（带有混合）绘制每个灯光之外，您还可以使用带有灯光信息的 UBO 发送数组。然后用一个全屏四边形绘制所有点光源。您最终会进行相同数量的光计算，但读写量始终是恒定的。（不过 UBO 仍然有大小限制）

您可能还会发现感兴趣的 Tiled Deferreed Shading 作为潜在的下一步： [http](http://www.cse.chalmers.se/~olaolss/main_frame.php?contents=publication&id=tiled_shading) ://www.cse.chalmers.se/~olaolss/main_frame.php ?contents=publication&id=tiled_shading （您只从 gbuffer 中读取一次并且只写入一个用于光通道的片段）

论文：[http ://www.cse.chalmers.se/~uffe/tiled_shading_preprint.pdf](http://www.cse.chalmers.se/~uffe/tiled_shading_preprint.pdf)

# css - 时尚的 CakePHP 表单按钮

> ID：12653384
> 
> 赞同：0
> 
> 时间：2012-09-29T14:07:07.017
> 
> 标签：css, cakephp

我正在尝试分配一个类来形成结束按钮，但是当我尝试通过调用 css 文件中的类来设置它的样式时，它不会产生任何效果。

表单按钮：

```
echo $this->form->end('Sign Up', array('class' => 'forminput')); 
```

CSS：

```
.forminput
{
width: 292px;
height: 32px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T14:24:18.867

用于`$this->Form->submit()`创建带有所需选项的提交按钮，然后在不使用`$this->Form->end()`任何参数的情况下简单地关闭表单标签。

# python - python：如何用字符串列表替换字符串列表中的字符串？

> ID：12653385
> 
> 赞同：1
> 
> 时间：2012-09-29T14:07:07.883
> 
> 标签：python, list

好的，这是示例：

```
data = ['This', 'is', 'a', 'test', 'of', 'the', 'list']
replaceText = 'test'
replaceData =['new', 'test'] 
```

我做了 data.replace(replaceText, replaceData) 但它不起作用。如何用字符串列表替换字符串列表中的字符串？任何帮助将不胜感激。

编辑：确切的条件是替换或拆分包含“s”的单词，所以我在其中放置了一个循环。所以最终结果将打印 data = ['Thi', 'i', 'a', 'te','t', 'of', 'the', 'li','t']

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:09:31.550

在一个列表中，用 找到文本的位置`.index()`，然后使用切片赋值进行替换：

```
pos = data.index(replaceText)
data[pos:pos+1] = replaceData 
```

这将一次只*替换*一次`replaceText`。演示：

```
>>> data = ['This', 'is', 'a', 'test', 'of', 'the', 'list']
>>> replaceText = 'test'
>>> replaceData =['new', 'test']
>>> pos = data.index(replaceText)
>>> data[pos:pos+1] = replaceData 
```

要替换*所有*出现，请使用`pos`加上长度`replaceData`来跳过上一个匹配项的搜索：

```
pos = 0
while True:
    try:
        pos = data.index(replaceText, pos)
    except ValueError:
        break
    data[pos:pos+1] = replaceData
    pos += len(replaceData) 
```

如果您在修改时需要循环`data`，请改用副本：

```
for n in data[:]:
    # maniplate data 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:13:10.760

您可以使用 list 的[`index()`](http://docs.python.org/tutorial/datastructures.html)方法来查找 的`p`位置`replaceText`：

```
p = data.index(replaceText) 
```

然后使用构造

```
data[start:end] = another_list 
```

将元素从 p 替换为 p+1（不包括结尾）`replaceData`：

```
data[p:p+1] = replaceData 
```

注意`index()`throws `ValueError`if`replaceText`不存在于`data`：

```
try:
  p = data.index(replaceText)
  data[p:p+1] = replaceData
except ValueError:
  # replaceText is not present in data, handle appropriately. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:45:09.660

> 是的，实际情况需要我替换或拆分任何包含字符's'的字符串，比如'test'将被'te'和't'替换到列表中

```
from itertools import chain
data = ['This', 'is', 'a', 'test', 'of', 'the', 'list']
>>> filter(None, chain.from_iterable(el.split('s') for el in data))
['Thi', 'i', 'a', 'te', 't', 'of', 'the', 'li', 't'] 
```

# javascript - jquery悬停li显示段落内？

> ID：12653388
> 
> 赞同：0
> 
> 时间：2012-09-29T14:07:37.133
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

仅在悬停 LI 时显示段落的简单 jquery 代码

```
<ol id="sortme">
<li>this content <p class="edit">first hidden content</p></li>
<li>this content <p class="edit">second hidden content</p></li>
<li>this content <p class="edit">third hidden content</p></li>
</ol> 
```

jQuery

```
$(".edit").hide;
$('#sortme li').hover(
                function () {
                  $(".edit").show();
                },
                function () {
                  $(".edit").hide();
                 }
              ); 
```

我的问题是，当悬停任何 li 所有段落出现时，我需要一个接一个地执行，因此当悬停第一个 li 时，“第一个隐藏内容”出现，悬停第二个 li 时，“第一个隐藏内容”消失，“第二个隐藏内容”

等等列表的其余部分

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:08:56.263

您可以`this`通过将其作为第二个参数提供到上下文中进行搜索`$()`：

```
$(".edit").hide;
$('#sortme li').hover(
    function () {
        $(".edit", this).show();
    },
    function () {
         $(".edit", this).hide();
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:09:48.960

做这个 -

```
$('#sortme li').hover( function () {
     $(this).find(".edit").show();
   },
   function () {
     $(this).find(".edit").hide();
   }); 
```

或者

```
 $('#sortme li').hover(function () {
   $(this).find(".edit").toggle();
 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:12:50.857

您需要将 show hide 应用到`children of current`li 有类`edit` `instead`应用到`every element`有类`edit`

**[现场演示](http://jsbin.com/ahepeq/1/edit)**

```
$(".edit").hide;
$('#sortme li').hover(
   function () {
         $(this).find('.edit').show();
    },
    function () {
         $(this).find('.edit').hide();
    }
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T14:30:35.830

您可以仅使用 CSS 实现相同的效果。 [http://jsfiddle.net/LNsaa/](http://jsfiddle.net/LNsaa/)

```
#sortme p {
    display: none;
}

#sortme li:hover > p {
    display: block;
}​ 
```

然后，您可以应用 CSS3 过渡以获得一些漂亮和平滑的效果。

# vim - gvim 配色方案以匹配 xterm 中的 vim

> ID：12653389
> 
> 赞同：2
> 
> 时间：2012-09-29T14:07:42.667
> 
> 标签：vim, color-scheme

我和将[GVim 颜色方案更改为类似于命令行 Vim有同样的问题](https://stackoverflow.com/questions/4100195/change-gvim-color-scheme-to-be-like-command-line-vim/4100241#4100241)

我特别喜欢 vim 上的“深蓝”方案（通过腻子）。是否有一些脚本可以更改 darblue 配色方案并更改 guibg 和 guifg 以匹配 ctermbg 和 ctermfg 中的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:50:28.893

首先，您必须知道，也许您是，大多数终端仿真器都具有让用户定义 16 色默认调色板的能力。如果没有明确激活 256 色支持，大多数（如果不是全部）终端仿真器将默认使用这 16 种颜色。

因为每个终端仿真器都有自己的默认颜色，并且用户可以修改这些颜色，所以无法判断`DarkRed`甚至不实际*查看*终端仿真器`Black`的配置文件或首选项窗口的值。

 *假设您没有在 256 色模式下运行，您应该找到在终端仿真器中定义默认/自定义颜色的位置并记下它们的十六进制值。

这是我自己的配色方案，在 Gnome 终端中：

![我的配色方案](../Images/e1ee17a361fbb3f0d45dc70086c9c3eb.png)

获得所有值后，您可以制作颜色方案的副本：

```
$ cp /usr/share/vim/vim7x/colors/darkblue.vim ~/.vim/colors/darkblue.vim 
```

并将所有 和 更改`guibg`为`guifg`您之前提到的值。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T23:04:19.137

[Vivify](http://bytefluent.com/vivify)提供了*通常*同时支持终端 vim 和 gvim 的配色方案。尝试在那里下载您的方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:21:30.390

你可以用这种方式...

**:colorscheme 深蓝**

这是在 gvim 和 xterm 中工作的。如果你想改变命令行 vim 你可以使用这个方法。这和 gvim 一样。首先你可以输入 :colorscheme 然后按下选项卡它会提供更多的配色方案。你可以设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-23T20:00:42.697

我很惊讶这不在这里。有一个名为[csapprox](https://github.com/godlygeek/csapprox)的插件可以做到这一点。最酷的事情是它无需配置即可完成。只需在 vimrc 中设置颜色方案，它就会自动在终端 vim 中正确加载颜色。将其添加到 Vundle：

```
Bundle 'godlygeek/csapprox' 
```

并重新启动 Vim。我发现的唯一问题是采购 vimrc 会破坏它。每次你想用`:so ~/.vimrc`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-29T16:35:21.930

我不会尝试将 GVIM 颜色*降级*为有限的终端颜色集，而是（假设您有一个支持 256 种颜色的“现代”终端仿真器）使用[CApprox 插件](http://www.vim.org/scripts/script.php?script_id=2390)在控制台中获得 GVIM 颜色的非常接近的再现，即*升级*终端颜色。*

# javascript - 将对象数组转换为对象

> ID：12653391
> 
> 赞同：3
> 
> 时间：2012-09-29T14:07:44.330
> 
> 标签：javascript, node.js

在我的节点 REST 应用程序中，我有一个函数可以查询数据库中的多条记录并返回一个对象数组。
因为我希望它返回一个 JSON 对象，所以我需要一种将对象数组转换为包含所有记录的单个对象的方法。
不幸的是，我在互联网上找不到这样的例子。
任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T14:09:14.407

你为什么想这么做 ？将JSON字符串化一个项目数组完全可以，你会得到一个像

```
"[{},{},{},...]" 
```

这甚至可能是一个优势，因为您可以保证物品的*顺序*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:17:26.123

参见 underscore.js 的[对象函数](http://underscorejs.org/#object)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:25:15.340

假设您有一个具有以下形式的对象数组：

```
log {
    name: "foo",
    log: "bar"
 } 
```

你可以这样做：

```
var logs,//Array of logs
    logObj = {}

for(i=0, i<logs.Length i++) {
    logObj[logs[i].Name] = logs[i].log;
 } 
```

循环后 logObj 应该是：

```
logObj {
  foo: bar,
  nextName: cool comment,
  etc.
} 
```

# c++ - c++ 使用指针的奇怪 std::cout 行为

> ID：12653393
> 
> 赞同：4
> 
> 时间：2012-09-29T14:07:57.240
> 
> 标签：c++, iostream, cout

> **可能重复：**
> [cout << c++ << c; 的正确答案是什么？](https://stackoverflow.com/questions/10782863/what-is-the-correct-answer-for-cout-c-c)

当我突然注意到时，我刚刚输出了文本。

```
#include <iostream>
int main()
{    
 int array[] = {1,2,3,4};                 
 int *p = array;

    std::cout << *p << "___" << *(p++) << "\n";
    // output is  1__1\. Strange, but I used  brackets! it should be at
    // first incremented, not clear.
    p = array;

   std::cout << *p << "___" << *(++p) << "\n";
   // output is 2_2   fine, why first number was affected? I didn't intend 
   // to increment it, but it was incremented
   p=array;

   std::cout << *p << "___" << *(p + 1) << "\n";
   // output is 1_2 - as it was expected
   p = array;

 return 0;
} 
```

这种行为对我来说很奇怪，为什么会这样？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-29T14:12:47.813

您正在导致[未定义的行为](https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior)，因此任何事情都可能发生，因此猜测原因毫无意义。

表达方式

```
std::cout<<*p<<"___"<<*(p++)<<"\n" 
```

举个例子：之间所有事物的评估顺序`<<`是未指定的，因此`*p`和`*(p++)`彼此之间没有顺序（即编译器不需要先做任何一个）。[您不允许修改变量然后在没有修改和使用顺序的情况下使用它](https://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points)，因此这会导致未定义的行为。

同样的事情适用于该程序中的所有其他地方，其中变量被修改并在同一表达式中单独使用无序。

# objective-c - 为客户事件处理 (iOS) 解析和映射类似 REST 的格式化 URI

> ID：12653394
> 
> 赞同：1
> 
> 时间：2012-09-29T14:07:58.243
> 
> 标签：objective-c

我需要实现一个自定义事件处理程序，它应该例如处理 URI，例如： - SomeAppName://SomeDomainClassName/ID 从数据库表中获取记录或 - SomeAppName://SomeControllerName/PushView/SomeAdditionalOptions 来推送视图控制器和设置附加选项，例如这可能是一个日历视图，它应该专注于在某个日期显示日历。

我一直在寻找现有的 REST 框架，但到目前为止，我还没有弄清楚任何现有的框架如何允许我定义 URI 的格式并将它们映射到本地类、操作，无论它是什么。

我如何 1) 定义和解释类似 URI 的 REST 以及 2) 将它们映射到本地操作或对象，而无需重新发明轮子（例如从 RESTKit 继承）？还是我应该最终编写自己的解析器？在这种情况下，欢迎指向良好 REST 的指针，例如 URI lex/flex。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T16:32:25.710

我一直在寻找的是 Ruby 世界中的 URL 路由器。Objective C 也有一些，或多或少有用。

我最终编写了一个自定义 URL 路由器，就像 ruby​​ URL 路由器基本上分为两个组件（路由器和路由）。对于路由器部分（可以说是映射器和 URL 调度程序），我查看了 TTURLMap，它是 Three20 的一部分，但丢弃了 90% 的代码并更改了操作处理以满足我的需要。它有很多样板代码，但基本上是我获得路由器想法所需要的。

对于特定的路由处理，我使用 SOCKit，它看起来很棒并且有经过良好测试的代码。

例如，现在我可以有一个本地函数 hello，它需要两个参数来显示一些作为 URL 传递的值：

```
Roter *router = [[Router alloc] init];
[router map:@"soc://:ident/:saySomething" toInstance:self with:@selector(hello:sayWhat:)];
[router dispatch:@"soc://3/hi"]; 
```

我也会添加块，但在大多数情况下，选择器工作得很好，因为 SOCKit 将基本参数类型的实际值传递给它们（无需使用来自 URL 的值来解析字典）。

# php - getCategories 方法调用自己？

> ID：12653396
> 
> 赞同：0
> 
> 时间：2012-09-29T14:08:07.303
> 
> 标签：php, magento

我对这里发生的事情有点困惑，在我看来，它就像一个方法正在调用自己？我正在尝试了解 Magento 的模型。我正在从一个助手（目录/类别）回来，我接到了这个方法“GetCategories”的电话。我不知道这里发生了什么。如果有人能阐明这个代码片段，我将不胜感激。

```
 getCategories ( $parent,
          $recursionLevel = 0,
          $sorted = false,
          $asCollection = false,
          $toLoad = true     
              ){
                  $categories = $this->getResource()
                   ->getCategories($parent, $recursionLevel, $sorted, $asCollection,  $toLoad);
                   return $categories;
                  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:45:58.357

没有太多可以添加到@hakra 的答案。只是 Magento 特定逻辑的一部分。因此，要使用 Magento 模型，您应该知道，Magento 有 2 种类型的模型：普通模型和资源模型（我们也可以将分配块称为模型，作为视图模型 - 但这更多地连接到**V**部分MVC)。

*资源*模型被创建为仅包含与数据库相关的逻辑的数据库适配器，并且通常连接到某个数据库表，因此包含对该表进行 CRUD 操作的逻辑。所以你会经常看到这样的东西——因为简单`someMethod`是普通模型的一部分，但由于它包含与数据库相关的逻辑，所以方法的所有实现都移到了*资源*模型中，所以`someMethod`在普通模型中的主体会是这样的：

```
public function someMethod($args)
{
    return $this->getResource()->someMethod($args);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:12:49.480

您发布的代码很难说。即使两个方法共享相同的名称 ( `getCategories`)，也不一定意味着它们属于同一类甚至是对象。

如果你想知道你需要比较：

```
 var_dump($this === $this->getResource()); 
```

除此之外，在递归编程中，方法调用自身也很常见，因此递归。但是对于那段代码，它会碰壁。

所以从技术上讲，我会假设在你的例子中这*不是*完全相同的对象方法。

请注意，这个答案是独立于 Magento 的，这就是 PHP 的一般工作方式。

# c# - 如何检查字符串是否有两个单词，它们之间有连字符？

> ID：12653397
> 
> 赞同：0
> 
> 时间：2012-09-29T14:08:26.337
> 
> 标签：c#

我有以下代码：

```
var hyphens = myString.Split('-');
topTitle = hyphens[0].Replace("_", " ");
subTitle = hyphens[1].Replace("_", " "); 
```

这是有效的，但如果 myString 没有两个带有连字符的单词，我会收到错误消息。如果 myString 仅包含一个单词，那么如何让 topTitle 获取该单词而 subTitle 获取“n/a”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T14:11:20.940

您应该`if (hyphens.Length == 2)`在拆分后检查。2 以外的任何长度都意味着您没有两个单词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:13:05.950

您可以使用正则表达式，但稍微更改您的代码也有帮助。

```
var hyphens = myString.Split('-');
topTitle = hyphens[0].Replace("_", " ");
subTitle = hyphens.Length > 1 ? hyphens[1].Replace("_", " ") : "n/a"; 
```

只需检查`Length`，如果少于一个，请按照您的意愿显示“n/a”。

# facebook - 如何存储 FB 应用程序的用户数据？

> ID：12653401
> 
> 赞同：0
> 
> 时间：2012-09-29T14:09:13.237
> 
> 标签：facebook, flash

比如说，我为 Facebook 编写了一个 Flash 游戏，我希望用户能够查看他的游戏历史（日期、积分、高分......）。我是否必须为此建立自己的数据库？还有其他选择吗？我的意思是，任何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:34:33.537

您可以将您的应用程序发布分数发布到 Facebook，并从 API 中读取它们：[https ://developers.facebook.com/docs/scores/](https://developers.facebook.com/docs/scores/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:11:47.347

Facebook 会提供一些关于你的应用程序的一般统计数据（比如查看次数），但如果你想要点数和高分统计数据这样的具体数据，你就必须使用自己的数据库。

# c# - 访问 Amazon Mechanical Turk 的最简单示例是什么？

> ID：12653405
> 
> 赞同：4
> 
> 时间：2012-09-29T14:09:51.437
> 
> 标签：c#, mechanicalturk

我正在寻找一个使用 C# 访问 Amazon Mechanical Turk Web 服务的简单示例。我知道有一个用于 C# 的 SDK，但我想在使用它之前了解基本机制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:09:51.437

这是我想出的用于访问 Mechanical Turk 的最简单的代码示例。它创建签名并调用 GetAccountBalance 操作。

```
using System;
using System.Globalization;
using System.IO;
using System.Net;
using System.Security.Cryptography;
using System.Text;

namespace TurkTest {
    class Program {

        static void Main(string[] args) {
            const string SERVICE_NAME = "AWSMechanicalTurkRequester";  // requester service for MTurk
            const string TIMESTAMP_FORMAT = "yyyy-MM-ddTHH:mm:ss.fffZ";

            // Modify these with your values.
            const string operation = "GetAccountBalance";
            const string accessKey = "<Your access key>";
            const string secretAccessKey = "<Your secret access key>";

            // Millisecond values in the timestamp string can result in intermittent BadClaimsSupplied errors.
            // Get the current UTC time and use that to create a new time with milliseconds set to zero to avoid this case.
            DateTime now = DateTime.UtcNow;
            now = new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute, now.Second, 0, DateTimeKind.Utc);
            string timeStamp = now.ToString(TIMESTAMP_FORMAT, CultureInfo.InvariantCulture);

            // Create the hash-based messaged authentication algorithm (SHA1) using our secret access key as the key.
            var hmac = new HMACSHA1(Encoding.UTF8.GetBytes(secretAccessKey));

            // Combine the service name, operation and timestamp and then hash them to produce the signature.
            var dataBytes = Encoding.UTF8.GetBytes(SERVICE_NAME + operation + timeStamp);
            string signature = Convert.ToBase64String(hmac.ComputeHash(dataBytes));

            // Build the URL to send to Amazon
            string url =
                @"https://mechanicalturk.amazonaws.com/?Service=AWSMechanicalTurkRequester&AWSAccessKeyId={0}&Version=2012-03-25&Operation={1}&Signature={2}&Timestamp={3}";
            url = string.Format(url, accessKey, operation, signature, timeStamp);

            // Send a request and write the response to the console.
            using (WebClient client = new WebClient()) {
                using (StreamReader reader = new StreamReader(client.OpenRead(url))) {
                    Console.WriteLine(reader.ReadToEnd());
                }
            }

            Console.Read();
        }
    }
} 
```

# c++ - 运行时值到类型映射

> ID：12653407
> 
> 赞同：6
> 
> 时间：2012-09-29T14:10:06.073
> 
> 标签：c++, networking

我有一个可以通过网络发送的类型列表，举个例子：

```
enum types {
    E_T1,
    E_T2,
    E_T3,
    E_T4
}; 
```

现在我有一个对应于每种类型的类列表，假设每个都被声明为`class E_T1 {...}`,`class E_T2 {...}`等。

它们**不是从公共基类派生的**，也不可能这样做。每个类都有一个验证方法，我需要调用通过网络发送的数据。客户端发送数据`D`和对应于消息类型的 id。我需要掌握与类型相对应的对象。如果需要，我可以使用 C++0x 功能。

到目前为止，我尝试的是为 . 使用专门的模板，`types`为与之相关的对象保存一个 typedef。这显然是一个愚蠢的想法，因为模板参数需要是编译时间常数，所以`getType<data.id()>::type`不可能做一些事情。

然后我尝试使用 Boost.Variant 来获得一个像这样的常见可返回类型（使用 mpl 向量在运行时迭代注册的类型以进行调试）：

```
template <typename C>
struct getType() {
    typedef C type;
}

typedef boost::mpl::vector<
    getType<E_T1>,
    getType<E_T2>,
    getType<E_TX>...
> _types;

typedef boost::make_variant_over<_types>::type _type;

//use a map to store each type <-> id
boost::unorderd_map<types, _type> m;
m[E_T1] = getType<E_T1>();

m[data.id()]::type x; //<- access type, can now call x.validate(data) 
```

这样做的问题是，每个变体默认限制为 20 个条目。这可以被覆盖，但据我了解，应该考虑每种类型的开销，我们在这里讨论的是几千种类型。

还尝试了 boost.any 但它不包含任何类型信息，所以这又是不可能的。有没有人有什么好主意如何优雅地解决这个问题？寻找我在处理类型时不必编写 1k switch 语句的东西。

所有类型现在都处于编译类型，它们对应的 ID 也是如此。Id -> 类型解析需要在运行时进行。

在此先感谢，罗宾。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T14:32:43.783

**外部多态性**(*)

这是一个广为人知的习语，但它被广泛使用：我在`shared_ptr`实现中第一次遇到它，它在我的工具箱中非常有用。

这个想法实际上是为所有这些类型创建一个基类。但不要让它们直接从中派生。

```
class Holder {
public:
    virtual ~Holder() {}

    virtual void verify(unsigned char const* bytes, size_t size) const = 0;

}; // class Holder

template <typename T>
class HolderT: public Holder {
public:
     HolderT(): _t() {}

     virtual void verify(unsigned char const* bytes, size_t size) const {
         _t.verify();
     }

private:
    T _t;
}; // class HolderT

template <typename T>
std::unique_ptr<Holder> make_holder() {
    return std::unique_ptr<Holder>(new HolderT<T>());
} 
```

因此，这是添加新的间接级别的经典策略。

现在，您显然**确实**需要一个从价值到类的转换。或者也许……一张地图？

```
using maker = std::unique_ptr<Holder> (&)();
using maker_map = std::unordered_map<types, maker>;

std::unique_ptr<Holder> select(types const E) {
    static maker_map mm;
    if (mm.empty()) {
        mm.insert(std::make_pair(E_T1, make_holder<EC_T1>));
        // ...
    }

    maker_map::const_iterator it = mm.find(E);

    if (it == mm.end()) { return std::unique_ptr<Holder>(); }

    return (*it->second)();
 } 
```

现在您可以多态地处理它们：

```
void verify(types const E, unsigned char const* bytes, size_t size) {
    std::unique_ptr<Holder> holder = select(E);
    if (not holder) { std::cerr << "Unknown type " << (int)E << "\n"; return; }

    holder->verify(bytes, size);
} 
```

当然，欢迎您根据自己的需要制定策略。例如，将地图移出`select`以便您可以动态注册您的类型（如插件）。

(*) 至少这是我的名字，我很高兴发现它已经被命名了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:36:51.863

我假设您有一种处理消息的通用方法，例如重载函数：

```
void handle_message(const E_T1& msg);
void handle_message(const E_T2& msg);
//... 
```

现在，您实际上并不需要获取对象的类型。给定未解码的消息，您所需要的只是一种处理该类型消息的方法。

因此，我建议您填充工厂函数的映射：

```
std::unordered_map<types, std::function<void (unsigned char const* bytes, size_t size)> handlers;
handlers[E_E1] = [](unsigned char const* bytes, size_t size) { handle_message(E_T1(bytes, size)); };
// ... 
```

然后，一旦您解码了类型，您就可以使用它`handlers[type](bytes, size)`来解码和处理消息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T14:52:01.903

尝试可变参数模板和您已经定义的 getType 类：

```
enum types { T1_ID, T2_ID, .... };
class T1; class T2; class T3; ....

template <types t> struct getType;
template <> struct getType<T1_ID> { typedef T1 type; };  
template <> struct getType<T2_ID> { typedef T2 type; };
... 
```

并且操作验证：

```
template <types...>
struct type_operation;

template <types t1, types... rest> 
struct type_operation<t1, rest...>
{
   void verify(types t)
   {
      if (t == t1) 
      { 
         typename getType<t1>::type a; 
         a.verify(); // read from network and verify the rest of data....
      }
      else type_operation<rest...>::verify(t, data);
   }
};

template <> 
struct type_operation<>
{
   void verify(types t)
   {
      ostringstream log; log << "not suppoted: " << t;
      throw std::runtime_error(log.str()); // 
   }
}; 
```

用法：

```
typedef type_operation<T1_ID, T2_ID, T3_ID, ,,.., TN_ID> type_mapping;
types id;
readFromNetwork(id);
type_mapping::verify(id); 
```

# java - Netty - NioWorker 池和工作线程池的关系

> ID：12653414
> 
> 赞同：1
> 
> 时间：2012-09-29T14:11:11.717
> 
> 标签：java, multithreading, netty

上下文是 Netty 3.5.x。

创建or`NioWorker`时，s的个数和工作线程池中的线程个数是什么关系？Netty 的设计是否规定线程池中可用的线程至少应与 的数量一样多？如果线程池中的线程数少于s 的数量会怎样？`NioServerSocketChannelFactory``NioClientSocketChannelFactory``NioWorkers``NioWorker`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T09:58:47.777

是的，关系是1：1。因此，您至少需要拥有与 NioWorkers 一样多的线程。如果你有更少，它会在创建 *SocketChannelFactory 时抛出一个“挂起”的异常，具体取决于 Executor 实现。

# c# - 为什么我不能在我的表单中嵌入这些应用程序？

> ID：12653418
> 
> 赞同：1
> 
> 时间：2012-09-29T14:11:44.760
> 
> 标签：c#, winapi, process, embed, handler

## 意图

使用以下代码，我设法在我的 Windows 窗体中加载了一些应用程序。

## 代码

这个函数的作用是...

*   陈述一个过程
*   将流程嵌入到我的表单面板中
*   最大化嵌入式过程
*   向面板添加调整大小事件处理程序以更新面板调整大小时嵌入进程的大小
*   向表单添加关闭的事件处理程序以在表单关闭时终止嵌入式进程

用途

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Windows.Forms; 
```

常数

```
const int   GWL_STYLE   = -16;
const long  WS_VISIBLE  = 0x10000000,
            WS_MAXIMIZE = 0x01000000,
            WS_BORDER   = 0x00800000,
            WS_CHILD    = 0x40000000; 
```

功能

```
IntPtr LoadExtern(Control Panel, string Path)
{
    try
    {
        Process Process = Process.Start(Path);
        Process.WaitForInputIdle();
        IntPtr Handle = Process.MainWindowHandle;
        SetParent(Handle, Panel.Handle);
        SetWindowLong(Handle, GWL_STYLE, (int)(WS_VISIBLE+(WS_MAXIMIZE|WS_BORDER)));

        MoveWindow(Handle, 0, 0, Panel.Width, Panel.Height, true);

        Panel.Resize += new EventHandler(
             delegate(object sender, EventArgs e)
             {
                  MoveWindow(Handle, 0, 0, Panel.Width, Panel.Height, true);
             }
        );

        this.FormClosed += new FormClosedEventHandler(
             delegate(object sender, FormClosedEventArgs e) {
                  SendMessage(Handle, 83, 0, 0);
                  Thread.Sleep(1000);
                  Handle = IntPtr.Zero;
             }
        );

        return Handle;
    }
    catch (Exception e) { MessageBox.Show(this, e.Message, "Error"); }
    return new IntPtr();
} 
```

DLL 导入

```
[DllImport("user32.dll")]
static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);

[DllImport("user32.dll")]
static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);

[DllImport("user32.dll")]
static extern bool MoveWindow(IntPtr Handle, int x, int y, int w, int h, bool repaint);

[DllImport("user32.dll")]
static extern IntPtr SendMessage(IntPtr Handle, int Msg, int wParam, int lParam); 
```

## 结果

此代码适用于某些应用程序，例如 Windows 记事本。记事本已启动并包含在我的表单面板中。没有标题，也没有边界，因为它应该是。

```
LoadExtern(panel1, "notepad.exe"); 
```

关闭表单后，嵌入式进程会按预期终止。

## 问题

不幸的是，我的代码不适用于其他一些（更大的）应用程序，如 firefox 或 sublimetext。

```
LoadExtern(panel2, @"C:\Program Files (x86)\Mozilla Firefox\firefox.exe"); 
```

发生的事情是我的表单启动并且 firefox 启动，但是在它自己的窗口中。你能帮我在我的应用程序中包含 sublimetext 或 firefox 吗？

## 部分解决方案

感谢盛江的回答，我让它适用于更多的应用程序。我所做的是等待主窗口句柄。

```
Process.WaitForInputIdle();
IntPtr Handle = new IntPtr();
for (int i = 0; Handle == IntPtr.Zero && i < 300; i++)
{
     Handle = Process.MainWindowHandle;
     Thread.Sleep(10);
} 
```

但我仍然无法嵌入 Windows 资源管理器之类的应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T16:06:27.213

巧合的是，您的代码运行良好。

*   WaitForInputIdle 不需要等待 UI 线程。例如，由其他程序创建的输入法或挂钩可能会创建一个简单的线程，该线程在 UI 线程仍在忙于初始化时变得空闲。
*   MainWindowHandle 搜索第一个可见的顶级窗口。它不会返回逻辑主窗口
    *   主窗口不是创建的第一个可见窗口（例如，首先创建登录对话框）
    *   主窗口不是以可见样式创建的（考虑一个在系统托盘的通知区域中只有一个图标的程序）
    *   根本没有创建主窗口（例如，某些应用程序在现有实例中打开新文档/url，如浏览器和 Windows 资源管理器）
    *   没有一个主窗口，而是多个具有相同状态的顶级窗口。想想 IE6/Outlook/Word。

即使主窗口是可见创建的，实际上是新进程中的第一个可见窗口，您仍然可能遇到问题。

从 SetParent 的文档中：

应用程序可以使用 SetParent 函数来设置弹出窗口、重叠窗口或子窗口的父窗口。

它并没有说您可以重新设置顶级窗口。事实上，顶层窗口提供了许多程序可能依赖的服务，例如

*   作为衡量工具来确定全屏请求是否完整（与您要求新程序需要出现在面板中的要求相冲突）
*   当新的 DDE 对话开始时、活动窗口/程序更改时、新硬件到达时、系统设置更改时、用户注销时、Windows 资源管理器启动时、用户在嵌套上按 Enter 键时收到通知对话框等。仅发送到顶级窗口的窗口消息列表太长，无法在此处列出，
*   如果程序选择，则充当模态对话框的默认所有者窗口（并且如果您也在程序中显示模态对话框，请[注意崩溃](http://blogs.msdn.com/b/oldnewthing/archive/2005/02/23/378866.aspx)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T20:45:01.123

此代码适用于大多数应用程序。我仅在表单上使用 webbrowser 控件嵌入了文件资源管理器，并将其 url 设置为文件位置。然后，Internet Explorer 控件神奇地变成了文件浏览器。

这是我的最终代码，请随意将其用于您自己的项目。

```
IntPtr EmbedProcess(Control Panel, string Path)
{
    string Name = NameFromPath(Path);

    foreach (Process Task in Process.GetProcesses())
    {
        if (NameFromPath(Task.ProcessName).Contains(Name))
        {
            try { Task.Kill(); }
            catch (Exception e) {  }
        }
    }

    try
    {
        Process Task = Process.Start(Path);
        Task.WaitForInputIdle();
        IntPtr Handle = new IntPtr();
        for (int i = 0; Handle == IntPtr.Zero && i < 10; i++) { Handle = Task.MainWindowHandle; Thread.Sleep(100); }
        SetParent(Handle, Panel.Handle);
        SetWindowLong(Handle, GWL_STYLE, (int)(WS_VISIBLE + (WS_MAXIMIZE | WS_BORDER)));

        MoveWindow(Handle, 0, 0, Panel.Width, Panel.Height, true);

        Panel.Resize += new EventHandler(delegate(object sender, EventArgs e) { MoveWindow(Handle, 0, 0, Panel.Width, Panel.Height, true); });

        this.FormClosed += new FormClosedEventHandler(delegate(object sender, FormClosedEventArgs e)
        {
            SendMessage(Handle, 83, 0, 0);
            Thread.Sleep(100);
            Handle = IntPtr.Zero;
        });

        return Handle;
    }
    catch (Exception e) { MessageBox.Show(this, e.Message, "Error"); }
    return new IntPtr();
} 
```

我有人对用于将窗口进程和控制台进程嵌入到表单中的洞 C# 类感兴趣，请查看[此 github 存储库](https://github.com/pfisrik/ConsoleDevelopmentEnvironment/tree/master/ConsoleDevelopmentEnvironment/Classes)。

# c# - EF 5 工会没有按预期工作

> ID：12653422
> 
> 赞同：0
> 
> 时间：2012-09-29T14:12:03.690
> 
> 标签：c#, linq-to-entities, entity-framework-5

我有一个涉及以下 3 个实体的 linq 查询：

```
public class LandPoint
{
    ...
    public OlsonTimeZone TimeZone { get; set; }
}

public class OlsonTimeZone : TimeZone
{
    ...
    public virtual ICollection<WindowsTimeZone> Windows { get; set; }
}

public class WindowsTimeZone : TimeZone
{
    ...
    public virtual ICollection<OlsonTimeZone> Olson { get; set; }
} 
```

所以一个 LandPoint 有一个 OlsonTimeZone，它有零个或多个 WindowsTimeZone。

如果OlsonTimeZone 有任何WindowsTimeZones 或OlsonTimeZone 名称（以'Olson:' 为前缀）作为后备以及有关点本身的信息，我想要做的是获取WindowsTimeZone 名称（以'Windows:' 为前缀）。

我写的是：

```
 return db.LandPoints.Where(x => x.GeoNameID == ID).Take(1).Select(x => new LandPoint
        {
            TimeZone = x.TimeZone
                            .Windows.Select(t => "Windows:" + x.Name)
                            .Union(new[] { "Olson:" + x.TimeZone.Name })
                            .FirstOrDefault()
        }).First(); 
```

理论上哪个应该做我想要的。除了我测试它的给定点（我知道与 WindowsTimeZone 相关联）它返回 OlsonTimeZone 而不是 WindowsTimeZone。如果对于相同的 ID，我写以下内容：

```
return db.LandPoints.Where(x => x.GeoNameID == ID).Take(1).Select(x => new LandPoint
        {
            TimeZone = x.TimeZone
                            .Windows.Select(t => "Windows:" + x.Name)
                            .FirstOrDefault()
        }).First(); 
```

我得到了 WindowsTimeZone。

我确信我可以使用 CASE 语句重写它，但我觉得这更优雅。由于它的行为方式有点违反直觉并且理解它为什么这样做会帮助我更好地了解 linq 查询如何转换为 sql，我决定在这里发布一个问题。

**那么它为什么要这么做呢？上面的代码是否有一些补充可以使它工作（维护 UNION 语句）？**

提前感谢约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:48:37.680

这是因为 union 不保证排序。您不能在不订购的情况下根据物品的顺序提出任何特殊的期望。但是您的代码应该触发`NotSupportedException`，因为这是不允许的：`db.LandPoints.Select(x => new LandPoint ...`

如果您有`LandPoint`实体框架映射的实体，则无法在 Linq-to-entities 中投影到此类型。

# php - 使用 PHP 和 Cpanel 创建子域 - 为什么此脚本不起作用？

> ID：12653427
> 
> 赞同：0
> 
> 时间：2012-09-29T14:12:44.387
> 
> 标签：php, http, cpanel

我正在尝试使用 php 动态创建子域。当用户以 html 形式输入子域名时，应创建一个该名称的子域。我有那个脚本。

但是当我运行它时，我得到空白页，没有创建目录。有人告诉我哪里出错了

php 代码是这样的 **create.php**

```
<?php
if(isset($_POST['subdomain_name']))
{

//$subDomain = $_POST['subdomain_name'];
    function create_subdomain($subDomain,$cPanelUser,$cPanelPass,$rootDomain) {
 echo $rootDomain;
    $buildRequest = "/frontend/x3/subdomain/doadddomain.html?rootdomain=" . $rootDomain . "&domain=" . $subDomain . "&dir=public_html/subdomains/" . $subDomain;

    $openSocket = fsockopen('localhost',2082);
    if(!$openSocket) {
    echo "error";
        return "Socket error";
        exit();
    }

    $authString = $cPanelUser . ":" . $cPanelPass;
    $authPass = base64_encode($authString);
    $buildHeaders  = "GET " . $buildRequest ."\r\n";
    $buildHeaders .= "HTTP/1.0\r\n";
    $buildHeaders .= "Host:localhost\r\n";
    $buildHeaders .= "Authorization: Basic " . $authPass . "\r\n";
    $buildHeaders .= "\r\n";

    fputs($openSocket, $buildHeaders);
    echo $openSocket;
    while(!feof($openSocket)) {
    echo $opensocket;
    fgets($openSocket,128);
    }
    fclose($openSocket);

    $newDomain = "http://" . $subDomain . "." . $rootDomain . "/";
 echo "new domain";
 echo $newDomain;
//  return "Created subdomain $newDomain";

}
    $cpaneluser = "username";
    $cpanelpass = "password";
    $cpanel_skin = "x3";
    $subd = $_POST['subdomain_name'];
    $request = "/frontend/$cpanel_skin/subdomain/doadddomain.html?rootdomain=$domain&domain=$subd";
    $result = create_subdomain($_POST['subdomain_name'],$cpaneluser,$cpanelpass,'ecommerce24.in');
    $show = strip_tags($result);
    if(strpos($show,"has been created!"))
    {
        echo "Subdomain Created!";
    }
}
?> 
```

我的html表单

```
<form action="create.php" method="post">
          New Subdomain Name : <input name="subdomain_name" type="text" /><br />
          <input type="submit" name="submit" value="Submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:16:31.927

尝试将其放在脚本的 biginning 中：

```
error_reporting (E_ALL | E_STRICT);
ini_set ('display_errors', '-1'); 
```

它可能会使 php 向您显示一条错误消息，从而导致解决方案。

# asp.net - 将模型传递给 MVCMailer 视图

> ID：12653431
> 
> 赞同：3
> 
> 时间：2012-09-29T14:12:50.627
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, mvcmailer

我有一个控制器，它将模型 (ovw.ToList()) 传递给视图：

```
 //
    // GET: /Clinic/Overview/
    public ActionResult Overview()
    {
        IEnumerable<Clinic> ovw = from c in db.Clinics
                                  select c;
        return View(ovw.ToList());
    } 
```

看法：

```
@model IEnumerable<ttp.Models.Clinic>

@foreach (var item in Model)
{        
<div>@item.ClinicName</div>

   @foreach (var item2 in item.Properties)
         {
         <div>@item2.Address</div> 
```

这在屏幕上工作得很好。

但是，在使用 MVCMailer 时，如果我想在电子邮件中显示相同的布局，如何将 ovw.ToList() 传递给邮件程序视图，以便我可以通过这种方式引用相同的模型：

（我被困在视图中第一行的内容）：

```
@model IEnumerable<ttp.Models.Clinic>
@foreach (var item in Model) 
```

谢谢你的帮助，

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:29:32.150

您应该在本指南的“将数据传递给 Mailer 视图”部分中找到答案：[https ://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide](https://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide)

要将模型与视图一起传递给 MVCMailer，您需要使用 ViewData：

```
var comment = new Comment {From = me, To = you, Message = "Great Work!"};
ViewData = new ViewDataDictionary(comment); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T14:40:18.487

在我的项目中，我这样做如下

我在我的索引视图中显示我的所有类别列表

在我的模特课上

```
public List<CategoryDetails> CategoryData { get; set; } 
```

我也在创建 CategoryDe​​tails 类并像这样为我的所有字段创建一个属性

```
public int CatID { get; set; }
[Required(ErrorMessage = "Enter Category Name")]
public string CatName { get; set; }
public string CatImage { get; set; } 
```

并像这样在我的主模型类中创建一个函数

```
public void LoadCategory()
        {
            CategoryData = (from con in dbData.Categorys
                            select new CategoryDetails()
                            {
                                CatID = con.CatID,
                                CatName = con.CatName,
                                CatImage = con.CatImage,
                            }).ToList();
        } 
```

在我的控制器中，我创建了一个这样的动作

创建我的模型类对象并将我的模型函数传递给操作

```
public ActionResult Index()
        {
           CategoryModel categorymodel = new CategoryModel();
            categorymodel.LoadCategory();
            return View(categorymodel);
        } 
```

在我看来

```
@model PMS.Models.CategoryModel
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>
    Index</h2>
<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            Category Name
        </th>           
        <th>
        </th>
    </tr>
    @foreach (var item in Model.CategoryData)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.CatName)
            </td>                             

        </tr>
    }
</table> 
```

我想这会对你有所帮助

# sql - Ruby on Rails - SQL 查询计数

> ID：12653434
> 
> 赞同：1
> 
> 时间：2012-09-29T14:13:07.293
> 
> 标签：sql, ruby, ruby-on-rails-3, sqlite

我需要计算状态等于**new**的图像的所有微帖子。

```
<% for column in @images %>
  <%= column.id %>
  <%= column.microposts.count() %>
<% end %> 
```

我试过这条线，但它不起作用：

```
<%= column.microposts.count(" WHERE status='new' ") %> 
```

有没有办法可以添加条件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:16:23.193

```
column.microposts.where(:status => 'new').count 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:18:55.100

```
column.microposts.find_all_by_status('new').count 
```

# java - 在 ArrayList 中获取 Random 有 java.lang.IllegalArgumentException 错误：n 必须为正

> ID：12653442
> 
> 赞同：0
> 
> 时间：2012-09-29T14:15:07.317
> 
> 标签：java, arraylist

在我的 ArrayList 中，我从 ArrayList 中获得了一个随机项目，用于装备方法。

每当我使用我的测试仪时，`java.lang.IllegalArgumentException: n must be positive`当我尝试调用随机尺寸时，终端窗口就会打印出来。

我试图将 totalElements 的值更改为元素的整数大小，然后错误将是`OutOfBoundsExeption`

```
import java.util.*;
import java.util.Scanner;
import java.util.Random;
public class GameMaster {

    private int turn, totalElements;
    private boolean winner;
    private Avatar x1;
    private Avatar x2;
    private ArrayList<Item> inventory;

    public GameMaster(Avatar a1, Avatar a2)
    {

    x2 = a1;
    x1 = a2;
    turn = 1;
    winner = false;
    inventory = new ArrayList<Item>();
    totalElements = 0;

    }

    private void fillInventory()
    {

    inventory.add( new Item( "Zealot Blades", true, 8 ) );
    inventory.add( new Item( "BFG", true, 13 ) );
    inventory.add( new Item( "Synthetic Cloth", false, 7 ) );
    // more items 

    inventory.add( new Item( "Gauss Rifle", true, 9 ) );
    inventory.add( new Item( "Flight Unit", false, 6 ) );

    totalElements = inventory.size();

    }

    public String equip()
    {
    Avatar w;
    String a;
    if (turn%2==1)
            w=x2;
    else 
            w=x1;

    if (w.beltIsFull())
    {

            a = w.getName() + "'s belt is full. \n";
    }

    else
    {
            turn++;
            Random generator = new Random();  
            Item rand = inventory.get(generator.nextInt(totalElements));
            //terminal window in blueJ: java.lang.IllegalArgumentException: n must be positive              

            a = w.getName()+" is equiped with "+rand.getName()+".";

    }
    return a;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:19:59.267

例外是告诉您`totalElements`小于或等于零。我认为那是因为你还没有初始化它。（我可以看到该`fillInventory`方法，但我看不到您的代码在哪里调用它......）

# module - Lua：“local var = require("my lib") 的问题

> ID：12653443
> 
> 赞同：2
> 
> 时间：2012-09-29T14:15:12.643
> 
> 标签：module, lua, require

> **可能重复：**
> [为什么将全局 Lua 函数设为本地？](https://stackoverflow.com/questions/9198677/why-make-global-lua-functions-local)

在社区的许多 lua 脚本中，我看到类似向脚本添加模块的内容：

```
local module = require("module") 
```

但是根据[lua-manual](http://lua-users.org/wiki/ModuleDefinition)，这不是加载模块的方式。模块本身在里面有它们的模块名称，所以

```
require("module") 
```

使用这样的模块就足够了：module.myfunction()。具有本地定义的第一个示例只是将“true”写入模块变量 - 表示模块已成功加载。

奇怪的是，我在网络上到处都能看到这种加载“local module = require("module")”。由于这个错误，来自 lua-community 的大多数脚本我都无法正常工作。我也想知道为什么我还没有在网上发现任何关于此的问题。

接下来是，实际上加载模块有时也会导致奇怪的错误。例如：我有一个脚本

```
require("purexml.lua") 
```

比我得到这个错误：

```
no field package.preload['purexml.lua']
no file './purexml/lua.lua'
no file '/usr/local/share/lua/5.1/purexml/lua.lua'
no file '/usr/local/share/lua/5.1/purexml/lua/init.lua'
no file '/usr/local/lib/lua/5.1/purexml/lua.lua'
no file '/usr/local/lib/lua/5.1/purexml/lua/init.lua'
no file './purexml/lua.so'
no file '/usr/local/lib/lua/5.1/purexml/lua.so'
no file '/usr/local/lib/lua/5.1/loadall.so'
no file './purexml.so'
no file '/usr/local/lib/lua/5.1/purexml.so'
no file '/usr/local/lib/lua/5.1/loadall.so' 
```

但这样做很好：

```
require("purexml") 
```

我在这里错过了一些非常明显的东西吗？顺便说一句，我使用 Lua 5.1.4...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:47:21.317

在 Lua 5.2 中，表现良好的模块不再像在 Lua 5.1 中那样导出全局变量。

除了**局部**变量提供的速度提升外，`local module = require "module"` *还应*使用 using 以兼容最新的 Lua 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T14:20:07.670

`local module = require("module")`除了默认的**全局**变量外，还创建一个包含模块的**局部**变量（当然，局部变量会影响全局变量）。在 Lua 中，Locals 的访问速度要快得多，因此性能很可能是使用它的原因。

 **而且你得到的错误很明显，你不能在加载模块时添加文件扩展名。**

# javascript - Javascript：加载同一页面但阻止刷新内容

> ID：12653449
> 
> 赞同：0
> 
> 时间：2012-09-29T14:15:27.427
> 
> 标签：javascript, javascript-events

我不知道我在下面打印的代码有什么问题：

```
    窗口顶部位置 = 窗口顶部位置；

```

我以为它只会在同一个窗口中加载同一个页面，但它实际上是在刷新页面。

可以做些什么来防止刷新？我想要的只是页面在同一个窗口中再次加载但不刷新（以防止服务器资源）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:18:27.080

你应该设计你的应用程序来做到这一点 - 更新`window.location`将发出一个完整的页面重新加载。

检查客户端模板或[pjax](http://pjax.heroku.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:21:32.237

好吧，您始终可以使用 cookie 来持久化数据[http://www.tutorialspoint.com/javascript/javascript_cookies.htm](http://www.tutorialspoint.com/javascript/javascript_cookies.htm)

但是我可以问一下这个用例吗？如果您只想上传页面的一部分，则应该使用 ajax，因为更新整个页面既慢又浪费服务器带宽。

[编辑：一些关于AJAX 入门的](https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started)好教程

# javascript - android到javascript之间的接口？

> ID：12653452
> 
> 赞同：2
> 
> 时间：2012-09-29T14:15:52.497
> 
> 标签：javascript, android, interface, webview

我正在开发一个应用程序，我需要将一个方法请求从 javascript 发送到 android native，并且需要在 native 端实现代码。我的 javascript 文件包含以下内容。

```
 function _CBSubscribeForNative( eventName, Message, Data ) {
            try {                                                  
               Android.CallFromJavaScript(eventName,Message.data);                    
               }//... 
```

在 Main.java 文件中，我使用以下代码。

```
 {
    WebView wv = (WebView)  findViewById(R.id.webView1);        
    WebSettings webset = wv.getSettings();        
    webset.setJavaScriptEnabled(true);   
    wv.loadUrl("file:///android_asset/DocApt/DocApt/DocAptApp/72/index.html");
    wv.addJavascriptInterface(new AndroidBridge(), "Android");
   }//oncreate

  private class AndroidBridge {
    @SuppressWarnings("unused")
    public void CallFromJavaScript(final String arg , final String arg1) {
        System.out.println("222222222");
    handler.post(new Runnable() {
    public void run() {
        String requestfrmjs = arg.toString();
        Toast.makeText(getApplicationContext(), "received request is " + requestfrmjs, Toast.LENGTH_SHORT).show();
    }       
    });
    }
    } 
```

根据我的代码，我无法烤面包。我的代码有什么问题吗？

谁能帮我这个..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:24:50.107

第二个参数是您将在 javascript 上下文中访问您在第一个参数中传递的对象的名称。

所以是的，如果您想从 javascript 代码中调用该对象的某些方法或属性，您将需要稍后使用该名称。

请参阅[**addJavascriptInterface()**](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)的文档。

# c# - C# Youtube 评论投票 HttpWebRequest

> ID：12653471
> 
> 赞同：2
> 
> 时间：2012-09-29T14:17:27.700
> 
> 标签：c#, api, youtube, httpwebrequest, comments

```
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("http://www.youtube.com/comment_voting?");
request.Method = "POST";
request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:14.0) Gecko/20100101 Firefox/14.0.1";
request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
request.AllowAutoRedirect = false;
request.Host = "www.youtube.com";
request.Referer = "http://www.youtube.com/all_comments?v=XMb63nsvQMo";
request.Method = "POST";
request.ContentType = "application/x-www-form-urlencoded; charset=UTF-8";
string postData = "a=-1&id=ElmOl_qgg14TOf2QjsVeF92YakgUMR8CTnKEbN8Rmqg&video_id=XMb63nsvQMo&old_vote=0";
byte[] postBuffer = UTF8Encoding.UTF8.GetBytes(postData);
using (Stream postStream = request.GetRequestStream())
{
    postStream.Write(postBuffer, 0, postBuffer.Length);
}
HttpWebResponse response = request.GetResponse() as HttpWebResponse; 
```

我正在处理 youtube 视频中的投票评论。Youtube API 不支持该投票评论，因此我将为此使用 webrequesting。我使用这段代码来完成这项工作，但它不起作用。没有错误，但没有任何反应。我的这段代码有什么问题？您可以在 URL 中看到视频 ID 和评论 ID。

# javascript - 覆盖内容周围的可点击区域

> ID：12653473
> 
> 赞同：1
> 
> 时间：2012-09-29T14:17:52.817
> 
> 标签：javascript, jquery, html, overlay

这可能是一个简单的解决方案，但我无法理解它。我想要做的是制作一个带有可点击子层的覆盖层，而不为子层分配任何交互。像这样——

```
<div class="overlay">
    <div class="content">Lorem ipsum dolor.</div>
</div> 
```

jQuery 示例函数：

```
$('.overlay').click(function() {
    $(this).hide();
}); 
```

这里发生的是，即使我单击子层，该函数也会运行。我应该如何设置，以便只有孩子周围的区域受到影响？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:23:20.347

您可以通过以下方式检查点击目标`e.target`

```
$('.overlay').click(function(e) {
    if (!$(e.target).is('.content')) {
        $(this).hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:23:06.520

尝试使用[**e.stopPropagation();**](http://api.jquery.com/event.stopPropagation/) -

```
$('.content').click(function(e) {
    e.stopPropagation();
    alert('child');
}); 
```

[**JSFiddle**](http://jsfiddle.net/cDnud/1/) ​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:27:11.300

创建示例，单击内容防止隐藏操作 [示例](http://jsfiddle.net/wQVg4/1/)

# ios - 如何处理 UITableViewCell 变得不可见？

> ID：12653474
> 
> 赞同：3
> 
> 时间：2012-09-29T14:18:05.547
> 
> 标签：ios, uitableview

`UITableViewCell`当我失去可见的矩形时，我需要释放一些资源。`prepareForReuse`当`UITableViewCell`需要重用时发送消息，但我需要另一个......我有`UITableViewCell`子类，并且可以覆盖一些消息......

这正是我需要的：[tableView:didEndDisplayingCell:forRowAtIndexPath:](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView%3adidEndDisplayingCell%3aforRowAtIndexPath%3a)

但这是 iOS6+ 唯一的解决方案。我需要 iOS4.3+ 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:25:43.440

当单元格被隐藏时，它会从`UITableView`. 因此，您可以在`UITableViewCell`派生类方法中覆盖`willMoveToSuperview`：

```
- (void)willMoveToSuperview:(UIView *)newSuperview
{
    [super willMoveToSuperview:newSuperview];
    NSLog(@"%p willMoveToSuperview: %p", self, newSuperview);
    if(newSuperview == nil) {
        // release some resources here
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:51:28.670

这正是我需要的：[tableView:didEndDisplayingCell:forRowAtIndexPath:](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView%3adidEndDisplayingCell%3aforRowAtIndexPath%3a)

但这是 iOS6+ 唯一的解决方案。我需要 iOS4.3+ 解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T09:17:42.567

`UITableView`继承自`UIScrollView`。

因此，一种可能的方法应该是实现该`scrollViewDidScroll`方法并检查那里`UITableViewCell`是可见的。

这也应该有帮助： [检查 UITableViewCell 是否完全可见的最佳方法](https://stackoverflow.com/questions/9831485/best-way-to-check-if-uitableviewcell-is-completely-visible)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-22T05:23:26.550

添加一个 else 解决了我的问题。我在哪里重置了对单元格所做的任何更改。

```
if (! self.cell) {
self.cell = [[LanguageCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
self.cell.accessoryType = UITableViewCellAccessoryNone;
}
else
{ 
self.cell.checkImage.image = NO;

} 
```

# javascript - 为什么 v8 将原生 javascript 的源代码保存在生成 的二进制文件中？

> ID：12653479
> 
> 赞同：5
> 
> 时间：2012-09-29T14:18:44.493
> 
> 标签：javascript, v8, embedded-v8

我一直在研究 v8 源代码，特别是“mksnapshot”工具如何在 v8 二进制文件中包含本机 javascript 文件（runtime.js、json.js...）的编译图像，并注意到它还包含一个（有点）源的缩小版本。例如，在检查 d8 可执行文件的内容时，我看到以下代码段：

```
var $JSON=global.JSON;

function Revive(a,b,c){
var d=a[b];
if((%_IsObject(d))){
if((%_IsArray(d))){
var g=d.length; 
```

在“src/json.js”的开头，我看到：

```
var $JSON = global.JSON;

function Revive(holder, name, reviver) {
  var val = holder[name];
  if (IS_OBJECT(val)) {
    if (IS_ARRAY(val)) {
      var length = val.length; 
```

显然这两个片段是等价的，但第二个在编译过程中被转换为第一个。

如果包含原始代码以使用“toString”进行检查，我会理解，但是当我在 d8 中输入“JSON.stringify”时，我看到的只是“function stringify() { [native code] }”，那么重点是什么这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T16:41:50.860

实际上快照不包括编译形式的所有内置函数。

V8 通常更喜欢惰性编译以节省空间和时间。如果您编译不使用的东西，则会浪费内存用于生成的代码（非优化编译器生成的代码非常“冗长”）和时间（如果我们谈论的是快照，则在编译或反序列化时）。

所以它可以延迟编译的所有东西 V8 都会延迟编译，这包括内置函数。因此，快照实际上并不包含所有函数的编译版本，并且需要源来编译 rest。

当源存在时，另一件可能的事情是优化：V8 必须有权访问源以应用其自适应优化管道。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T14:22:09.833

可能是因为缓存二进制文件使 v8 变得如此之快：它的构建速度非常快。因此，他们采取了极端措施来加快速度。本机代码的预生成二进制文件消除了客户端的思考，使其运行得更快。整个 v8 都有这样的优化。:)

# python - 如何在 Python 中播放声音？

> ID：12653484
> 
> 赞同：0
> 
> 时间：2012-09-29T14:19:11.793
> 
> 标签：python

我想知道无论如何我可以在不导入像pygame这样的外部库的情况下播放声音。像这样的东西：

```
import os    
import sound

mysound = sound.load("mysound.mp3") # gets the sound "mysound.mp3"

while True:    
        input("Press enter to play sound")    
        sound.play(mysound) # plays the sound mysound        
        os.system('cls') # clears the console 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:20:13.813

你不能。你需要一些图书馆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T16:22:42.600

标准库有一些播放`.wav`文件的功能（参见[`winsound.PlaySound`](http://docs.python.org/library/winsound.html#winsound.PlaySound)Windows 和稍微过时[`ossaudiodev`](http://docs.python.org/library/ossaudiodev.html)的 Linux），但 AFAIK 没有加载`.mp3`文件的方法。

[这个问题](https://stackoverflow.com/questions/307305/play-a-sound-with-python)有几个答案，列出了用于播放声音的各种第三方模块。

# windows-phone-7 - WP 7.5 和 WP8 开发有什么区别？

> ID：12653486
> 
> 赞同：0
> 
> 时间：2012-09-29T14:19:50.797
> 
> 标签：windows-phone-7, mobile

我正在尝试开始一些移动开发冒险。Windows Phone 在我看来很有前途。但我不想走错路。

**那么，从开发者的角度来看**，WP7.5 和 WP8 有什么区别呢？

WP7.5 的技能组是否仍适用于 WP8？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T17:06:43.750

区别？真的没什么。IDE 现在是 VS2012，您需要 Windows 8。模拟器运行 Hyper-V，速度要快得多。

如果您制作游戏，则必须学习 DirectX 而不是 XNA。但是对于常规应用程序，开发没有区别。

如果您愿意，您当然可以现在使用 C++/CX，但实际上一切仍然是 C# 5 和 XAML。

我的建议是继续学习 WP7、C# 和 XAML。阅读 C# 5 中的新功能，特别是异步编程，并了解它如何增强您的开发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:32:34.413

目前我们还不知道确切的细节（除非有权访问预览版 SDK 的人可以对此进行扩展），但基本情况不太可能发生太大变化。

当前的标准 WP7.5 应用程序应该在 WP8 上运行——微软表示他们将集中调整应用程序以实现这种兼容性。

# c - 如何访问C中联合内的结构成员？

> ID：12653500
> 
> 赞同：10
> 
> 时间：2012-09-29T14:21:34.440
> 
> 标签：c, unions, structure

我有以下工会：

```
union employee
{
    char key;

    struct manager
    {
        short int age;
        float shares;
        short int level;
    };

    struct worker
    {
        short int age;
        short int skill;
        short int department;
    };

} company[10]; 
```

如何访问联合内部结构的成员`employee`？我试图以这种方式访问​​结构的`age`成员`manager`：

`company[i].manager.age`

但我明白了`error C2039: 'manager' : is not a member of 'employee'`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-29T14:23:35.653

在标签声明之后添加一些东西。也许：

```
struct manager
{
    short int age;
    float shares;
    short int level;
} manager; 
```

* * *

旁注：您没有使用联合权。关键，即告诉您是与经理打交道还是与普通工人打交道的字段应该位于**union 之外的**封闭对象中。也许：

```
struct employee {
    char key;

    union {
        struct manager ...;
        struct worker ...;
    } u;
}; 
```

正如[dasblinkenlight 所](https://stackoverflow.com/users/335858/dasblinkenlight)指出的，您可以在工会之外声明您的经理/工人标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T17:51:50.457

匿名结构/联合不是 C 标准的一部分，而是一个不太广泛的 GNU 扩展。

在您的特定示例中，一些编译器（主要是 GCC）将允许您通过例如`company[i].shares`or访问管理器和工作人员的唯一变量`company[i].department`，但`company[i].age`它是模棱两可的，编译器将不知道是哪一个。您的方法类似于尝试定义

```
 union {
      int num;
      float num;
 } union_number; 
```

这甚至不是有效的 C.

有两种方法可以解决这个问题。

a）将共享属性移到结构之外（邪恶的 GNU 方式，请不要这样做，我知道 icc 甚至不编译它）

```
union employee
{
    char key;

    struct person {
        short int age;

        union {
            struct manager
            {
                float shares;
                short int level;
            };

            struct worker
            {
                short int skill;
                short int department;
            };
        }
    };

} company[10]; 
```

b）或更简洁的标准化方式来命名您的结构：

```
union employee
{
    char key;

    struct manager
    {
        short int age;
        float shares;
        short int level;
    } manager;

    struct worker
    {
        short int age;
        short int skill;
        short int department;
    } worker;

} company[10]; 
```

在这种情况下，您将能够通过 访问结构元素`company[i].manager.age`，`company[i].worker.skill`依此类推。

请注意，在运行时无法测试您的 union 是否包含密钥、经理或工人。这必须提前知道。

另一件事：我不确定这是否是有意的，但在您的声明中，您不能将密钥与经理或工人一起保存。您的工会仅包含**关键**、经理或工人之一

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-06T05:06:22.543

此错误是因为您试图通过结构本身的名称来访问结构元素，这是无效的。为了访问结构的元素，首先应该为它创建一个对象。

在下面的代码中，manage 和 work 分别是结构体 manager 和 worker 的对象。

工会雇员 { char key;

```
struct manager
{
    short int age;
    float shares;
    short int level;
}manage;

struct worker
{
    short int age;
    short int skill;
    short int department;
}work; 
```

} 公司[10];

现在要访问会员，您可以使用“company[i].manage.age”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-11T14:10:30.820

您可以访问成员，您尝试的方式（但联合内部的结构应该有唯一的成员）但是您应该确保在编译代码时**gcc**应该知道您正在尝试这样，

命令：**`gcc -fms-extensions file_name.c`**从 c11 支持。

像 ：

```
union employee
{
char key;

struct manager
{
    short int age;
    float shares;
    short int level;
};

struct worker
{
    short int age;
    short int skill;
    short int department;
};
} company[10]; 
```

这基本上会产生编译错误，因为它发现经理和工人的成员之间存在歧义。

因此，如果您将代码更改为：

```
union employee
{
char key;

struct manager
{
    short int age;
    float shares;
    short int level;
};

struct worker
{
    short int age1;
    short int skill;
    short int department;
};

} company[10]; 
```

否则你可以直接在工会下。

除非您**`-fms-extensions`**在编译时未指定，否则会出现编译时错误。

# spring - RMI 服务导出器和 HttpInvoker 之间的区别？

> ID：12653501
> 
> 赞同：3
> 
> 时间：2012-09-29T14:21:47.753
> 
> 标签：spring, rmi, spring-remoting

RMI 服务导出器和 HttpInvoker 有什么区别？

我知道 RMI 使用 RMI 作为底层通信技术和调用者标准 http post。还有其他值得注意的区别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T14:39:03.733

RMI 是一种标准的 Java 技术，原则上是可移植的。您可以轻松地与其他 Java 应用程序进行交互。

Spring HTTP 调用程序是一项专有技术。它们和 RMI 一样，使用 Java 序列化，但使用标准 HTTP 协议作为底层网络层。一方面，由于您仅限于其他 Spring 应用程序，因此可移植性较差。另一方面，与二进制 RMI 协议相比，使用标准 HTTP 协议可能被视为*更具*可移植性。

## 选择：

*   **RMI**，如果您需要跨 Java 应用程序的可移植性

*   **HTTP 调用程序**，如果您需要透明的网络传输、与防火墙良好配合等。

*   **SOAP/REST** Web 服务，如果您的 API 应该跨不同平台/客户端工作并且它需要使用标准 HTTP 协议工作

*   [](http://thrift.apache.org/)**如果您需要高效且可移植的二进制协议，请使用[**Thrift**](http://thrift.apache.org/)或[**protobuf**](http://code.google.com/p/protobuf/)**

# c# - 画到画笔

> ID：12653502
> 
> 赞同：1
> 
> 时间：2012-09-29T14:21:49.297
> 
> 标签：c#, wpf

我做了一个继承TextBox的控件，我正在尝试给一个笔记本网格：

![笔记本页面](../Images/e5c84c2e895e34c4915e021cc7705f6d.png)

我已经有代码可以指定在何处绘制包括所有网格特征的线条，但我不确定将其绘制到什么位置。我用谷歌搜索了很多，并搜索了一个画笔，它可以让我拥有与 DrawingContext 相同的界面（所以我可以调用 drawingContext.DrawLine() 等），或者一些熟悉的东西，但我找不到任何东西！

**那么我怎样才能获得我的网格背景呢？**

*PS 我无法创建静态 bmp 文件并加载它，因为网格颜色和间距肯定会改变*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:09:55.903

您可以尝试使用[`DrawingVisual`](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx)让您的[`DrawingContext`](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.aspx)然后创建一个[`VisualBrush`](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx)分配给您的`Background`. 像这样的东西。

```
DrawingVisual dv = new DrawingVisual();
DrawingContext dc = dv.RenderOpen();

dc.DrawLine( new Pen(Brushes.Red,5),new Point(0,0),new Point(50,50));
dc.Close();

VisualBrush vb = new VisualBrush(dv);
textBox1.Background = vb; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:29:26.667

您可以拦截`Paint`事件以供您控制。你得到一个`PaintEventArgs`参数，其中包括一个`ClipRectangle`和一个`Graphics`对象。

查看[Control.Paint 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.paint%28v=vs.71%29.aspx)。

一旦你有了你的`Graphics`对象，你就可以直接调用`DrawLine`它`FillRectangle`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:30:39.950

您正在寻找自定义绘制的控件。您需要覆盖控件类的 OnPaint 方法并在该方法中绘制背景。这是一个关于如何做到这一点的例子：http: [//msdn.microsoft.com/en-us/library/b818z6z6 (v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/b818z6z6%28v=vs.90%29.aspx)

要绘制背景，请在第一次调用基本 OnPaint 方法后获取绘图上下文并绘制背景：

```
protected override void OnPaint(PaintEventArgs pe)
{
   // Call the OnPaint method of the base class.
   base.OnPaint(pe);

   // Declare and instantiate a new pen.
   System.Drawing.Pen myPen = new System.Drawing.Pen(Color.Aqua);

   // Draw an aqua rectangle in the rectangle represented by the control.
   pe.Graphics.DrawRectangle(myPen, new Rectangle(this.Location, this.Size));
} 
```

**编辑：** 由于您使用的是 WPF，因此您可以在此处查看有关自定义设计的完整示例：[WPF .NET 3.5 Drawing Customized Controls and Custom UI Elements](http://www.codeproject.com/Articles/22003/WPF-and-NET-3-5-Drawing-Customized-Controls-and-Cu)

# python - 使用正则表达式在 '/?user=hello&user=man&user=' 中查找 'hello'、'man' 和 ''

> ID：12653503
> 
> 赞同：2
> 
> 时间：2012-09-29T14:21:52.460
> 
> 标签：python, regex, string

我想从字符串中提取任何`'user='`字符串`'/?user=hello&user=man&user='`。在这种情况下，我会得到`'hello'`,`'man'`和`''`。

**我被困在这里：**

```
>>> import re

>>> s = '/?user=hello&user=man&user='
>>> re.findall("user=(.*)",s)
['hello&user=man&user='] 
```

`user=`如果最后出现的也以 结尾，我将能够找到我想要的`&`，但是有人知道如何`['hello', 'man', '']`在这个字符串中找到吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-29T14:26:08.937

我会放弃`re`并使用用于此目的的工具：

```
from urlparse import urlsplit, parse_qs

s = '/?user=hello&user=man&user='
parse_qs(urlsplit(s).query, keep_blank_values=True)
{'user': ['hello', 'man', '']} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T14:25:34.093

尝试以下操作：

```
>>> s = '/?user=hello&user=man&user='
>>> re.findall(r"user=([^&]*)", s)
['hello', 'man', ''] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:26:24.650

是的，您需要制作一个不“贪婪”的正则表达式，并将最后一个`user=`作为您正在测试的 (.*) 的出现抢夺。使其更具体`user=(.*)?user=(.*)?user=(.*)`将仅匹配数据的第一次出现，而不是每个字符的大块。那是什么？运算符在正则表达式中执行。

# c# - 在 Metro 中，如何获取所有国家/地区的列表？

> ID：12653504
> 
> 赞同：3
> 
> 时间：2012-09-29T14:21:56.793
> 
> 标签：c#, windows-8, microsoft-metro

在 Metro 中，该`CultureInfo.GetCultures`方法不再存在。如果我要检索包含所有可用国家/地区的完整字符串列表，有哪些替代方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T14:28:24.390

请试试这个：

```
 public class LocalesRetrievalException: Exception
    {
       public LocalesRetrievalException(string message): base(message)
       {
       }
    }

    #region Windows API

    private delegate bool EnumLocalesProcExDelegate(
       [MarshalAs(UnmanagedType.LPWStr)]String lpLocaleString,
       LocaleType dwFlags, int lParam);

    [DllImport(@"kernel32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    private static extern bool EnumSystemLocalesEx(EnumLocalesProcExDelegate pEnumProcEx,
       LocaleType dwFlags, int lParam, IntPtr lpReserved);

    private enum LocaleType : uint
    {
       LocaleAll = 0x00000000,             // Enumerate all named based locales
       LocaleWindows = 0x00000001,         // Shipped locales and/or replacements for them
       LocaleSupplemental = 0x00000002,    // Supplemental locales only
       LocaleAlternateSorts = 0x00000004,  // Alternate sort locales
       LocaleNeutralData = 0x00000010,     // Locales that are "neutral" (language only, region data is default)
       LocaleSpecificData = 0x00000020,    // Locales that contain language and region data
    }

    #endregion

    public enum CultureTypes : uint
    {
       SpecificCultures = LocaleType.LocaleSpecificData,
       NeutralCultures = LocaleType.LocaleNeutralData,
       AllCultures = LocaleType.LocaleWindows
    }

    public static IReadOnlyCollection<CultureInfo> GetCultures(
       CultureTypes cultureTypes)
    {
       List<CultureInfo> cultures = new List<CultureInfo>();
       EnumLocalesProcExDelegate enumCallback = (locale, flags, lParam) =>
       {
          try
          {
             cultures.Add(new CultureInfo(locale));
          }
          catch (CultureNotFoundException)
          {
             // This culture is not supported by .NET (not happened so far)
             // Must be ignored.
          }
          return true;
       };

       if (EnumSystemLocalesEx(enumCallback, (LocaleType)cultureTypes, 0, 
          (IntPtr)0) == false)
       {
          int errorCode = Marshal.GetLastWin32Error();
          throw new LocalesRetrievalException("Win32 error " + errorCode + 
             " while trying to get the Windows locales");
       }

       // Add the two neutral cultures that Windows misses 
       // (CultureInfo.GetCultures adds them also):
       if (cultureTypes == CultureTypes.NeutralCultures || 
          cultureTypes == CultureTypes.AllCultures)
       {
          cultures.Add(new CultureInfo("zh-CHS"));
          cultures.Add(new CultureInfo("zh-CHT"));
       }

       return new ReadOnlyCollection<CultureInfo>(cultures);
    } 
```

参考：[.NET Windows Store 应用程序中 CultureInfo.GetCultures 的替换](https://stackoverflow.com/questions/12485626/replacement-for-cultureinfo-getcultures-in-net-windows-store-apps)

# css - Rspec + Capybara：用它的css类检查标签的存在

> ID：12653506
> 
> 赞同：8
> 
> 时间：2012-09-29T14:22:09.640
> 
> 标签：css, rspec, capybara

我将 Capybara 与 Rspec 一起使用，并在我的页面上有以下代码：

```
<div class="pagination pagination-centered">
  <ul>
    // ...
    <li class="last">
      <a href="/en/articles?page=2">Last »</a>
    </li>
  </ul>
</div> 
```

我想检查是否存在`div`具有“分页分页中心”类的请求。我试过这个：

```
it "should have pagination" do
  page.should have_selector('div#pagination pagination-centered')
end 
```

和这个：

```
it "should have pagination" do
  page.should have_selector('div', :class => 'pagination pagination-centered')
end 
```

两者都不起作用。我应该如何解决问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-29T14:59:41.057

好的，我找到了解决方案。我应该使用`have_css`方法：

```
it "should have pagination" do
  page.should have_css('div.pagination.pagination-centered')
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-12-22T10:04:00.610

```
expect(page).to have_selector :css, 'nav li.active' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-27T18:19:38.587

关于OP：

感谢您分享您的想法、烦恼和解决方案，ExiRe - 它帮助我找到了解决自己问题的方法。虽然我自己使用 Rspec，而不是 Capybara，但我的一项测试产生了假阴性：

> 它{应该有_选择器（'div.pagination'）}

但是，在我的浏览器中检查 html 会告诉我：

> < div class="分页" >

我将测试更改为（有点）类似于您最初的两个实验中的后者：

> 它 { 应该有_selector('div', :class => 'pagination') }

现在它通过了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-10T02:42:52.650

在尝试（并且测试失败）本页上的早期示例之后，这最终对我有用（也将 Capybara 与 Rspec 一起使用）：

```
 it { should have_selector('div', 'pagination.pagination-centered') } 
```

# nhibernate - Fluent NHibernate 不调用我的 ClassMap 班级

> ID：12653508
> 
> 赞同：0
> 
> 时间：2012-09-29T14:22:21.247
> 
> 标签：nhibernate, fluent-nhibernate

我将 NHibernate 用于可以动态加载其模块的动态网站，因此当我想构建 sessionFactory 时，我使用一种方法来查找所有程序集并使用它们的依赖项对它们进行排序，我将它们添加到我创建的配置实例中有用。现在我想将配置类型从 hbm.xml 文件更改为流畅，我添加了以下代码：

```
 sessionFactory =
    Fluently
    .Configure()
    .Database(
        FluentNHibernate.Cfg.Db.MsSqlConfiguration.MsSql2008.ConnectionString(
            c =>  c.FromAppSetting("connectionString")
        )
    )
    .Mappings(
        m => m.AutoMappings.Add(
            AutoMap.Assemblies(
                new FarayanConfig(),
                assembliesArray
            )
        )
   ).BuildSessionFactory(); 
```

FarayaConfig 是：

```
class FarayanConfig : DefaultAutomappingConfiguration
{
    public override bool ShouldMap(Type type)
    {
        return type.Name.EndsWith("Entity");
    }
    public override bool IsVersion(FluentNHibernate.Member member)
    {
    return member.Name == "Version";
    }
} 
```

我还在程序集中有一个类，该类将由此代码加载（注意程序集未引用，将动态加载），其中包含一个名为 ControlEntity 的类和另一个类：

```
public class ControlEntityMap : ClassMap<ControlEntity>
{
    public ControlEntityMap()
    {
        HasMany(x => x.Properties).Component(c => {
            c.Map(v => v.Culture);
            c.Map(v => v.Name);
            c.Map(v => v.Value);
        });
    }
} 
```

现在的问题是 ControlEntityMap 的构造函数不会执行！我应该做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:29:06.400

因为您正在尝试使用 AutoMap。你可以使用这样的东西：

```
.Mappings(m => m.FluentMappings.AddFromAssembly(Assembly.Load("your assembly name"))) 
```

**更新：**

对于这种情况，您通过 ovverride DefaultAutomappingConfiguration 做得对，但您也尝试自动映射所有以“实体”结尾的类，而您想要从 AutoMap 忽略它的类也以“实体”结尾。我认为你可以在不同的命名空间中分离你的类并在你的 ShouldMap 属性中声明它。

FluentNhibenate Wiki 中有一些信息：

> 您可以通过简单地将它们从您的 ShouldMap(Type) 方法中排除来忽略基本类型，这有时是最干净的选择；但是，如果您想更明确一点，可以使用 IgnoreBase 方法。
> 
> 在 AutoMap.AssemblyOf() 之后，我们需要更改自动映射器使用的约定，以便它可以识别我们的基类。
> 
> AutoMap.AssemblyOf(cfg) .IgnoreBase();
> 
> 我们添加了 IgnoreBase 调用，它只是指示自动映射器忽略 Entity 类；您可以根据需要多次链接此调用。

# java - IBM Websphere JSP 调度程序呈现为重定向

> ID：12653509
> 
> 赞同：0
> 
> 时间：2012-09-29T14:22:24.007
> 
> 标签：java, jakarta-ee, websphere, websphere-7

当我只想从我的spring mvc控制器呈现JSP时，有没有办法**配置websphere**不**重定向到JSP页面？**

例如，视图 ( JSP ) 页面中的**request.getCurrentURL()**返回 JSP 页面的 url，而不是为呈现它而命中的控制器和操作。

这会导致 sitemesh 出现问题，例如在尝试匹配要装饰的 url 时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T11:47:04.510

回答 ：

```
<!-- Resolves view names to protected .jsp resources within the /WEB-INF/views directory -->
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    ... 
    <property name="alwaysInclude" value="true"/>        
</bean> 
```

将始终包含添加到内部视图解析器的属性中

# c++ - c/c++ 的 netbeans 说“没有找到编译器”

> ID：12653510
> 
> 赞同：0
> 
> 时间：2012-09-29T14:22:24.310
> 
> 标签：c++, netbeans-7, netbeans-plugins

我已经尝试过本[教程](http://netbeans.org/community/releases/70/cpp-setup-instructions.html)，但它并没有帮助我。我已经安装了 Cygwin 并在我的环境变量中添加了它的 C:\cygwin\bin 路径，但什么也没发生，仍然是同样的错误。它甚至不承认 cout。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:37:40.850

[配置页面](http://netbeans.org/community/releases/70/cpp-setup-instructions.html#compilers_windows)列出了所需的 cygwin 包：

*   海合会
*   g++（gcc-g++ 包）
*   数据库
*   制作

通过重新运行 Cygwin 安装程序并在 Select Packages 步骤中检查这些包，确保安装了这些包。在“开发”类别下查找或在“搜索”字段中搜索包。

如果软件包被标记为“跳过”，那么它们没有被安装。单击跳过的包，直到出现“跳过”的版本号。

然后，单击下一步，让 Cygwin 安装任何依赖项，然后再次单击下一步以下载并安装软件包。

# php - ASP 是否允许您从 PHP 之类的脚本标签中逃脱？

> ID：12653515
> 
> 赞同：0
> 
> 时间：2012-09-29T14:23:28.087
> 
> 标签：php, asp-classic

你能像 PHP 如何退出解析模式那样逃避进出 ASP 标记吗？例如，在 PHP 中，您可以在代码块的中间退出，如果您想显示长的 HTML 代码块，这很有用。

```
<?php if ($expression == true) { ?>

    <h1>This will show if the expression is true.</h1>
    <p>I can put lots of HTML code here.</p>

<?php } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:28:01.400

你可以。

```
 <% if (expression) then %>
     <h1>This will show if the expression is true.</h1>  
     <p>I can put lots of HTML code here.</p>  
 <% end if %> 
```

这可能造成的那种像意大利面条一样的混乱是经典 ASP 的主要缺陷之一，除非人们努力保持代码的可管理性。

不过，我不确定您为什么要使用经典的 ASP。（或php，就此而言）

# c# - 可以用显式等待替换最后一个等待吗？

> ID：12653517
> 
> 赞同：0
> 
> 时间：2012-09-29T14:23:31.287
> 
> 标签：c#, .net, asynchronous, .net-4.5, async-await

我还在学习`async`/ `await`，所以如果我问一些明显的问题，请原谅。考虑以下示例：

```
class Program  {

    static void Main(string[] args) {
        var result = FooAsync().Result;
        Console.WriteLine(result);
    }

    static async Task<int> FooAsync() {

        var t1 = Method1Async();
        var t2 = Method2Async();

        var result1 = await t1;
        var result2 = await t2;

        return result1 + result2;

    }

    static Task<int> Method1Async() {
        return Task.Run(
            () => {
                Thread.Sleep(1000);
                return 11;
            }
        );
    }

    static Task<int> Method2Async() {
        return Task.Run(
            () => {
                Thread.Sleep(1000);
                return 22;
            }
        );
    }

} 
```

这符合预期并在控制台中打印“33”。

如果我用明确的等待替换**第二个......** `await`

```
static async Task<int> FooAsync() {

    var t1 = Method1Async();
    var t2 = Method2Async();

    var result1 = await t1;
    var result2 = t2.Result;

    return result1 + result2;

} 
```

...我似乎得到了同样的行为。

这两个例子完全等价吗？

如果在这种情况下它们是等价的，是否还有其他情况可以用`await`显式等待替换最后一个会产生影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:44:08.047

您的替换版本会阻塞等待任务完成的调用线程。很难在这样的控制台应用程序中看到明显的差异，因为您故意在 Main 中阻塞，但它们绝对不是等效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:46:30.483

它们不是等价的。

`Task.Result`阻塞，直到结果可用。正如我在博客中解释的那样，如果您有一个需要独占访问的上下文（例如，UI 或 ASP.NET 应用程序） ，这[可能会导致死锁。](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)`async`

此外，`Task.Result`会将任何异常包装在 中`AggregateException`，因此如果您同步阻塞，则错误处理会更加困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T20:28:58.510

好的，我想我想通了，所以让我总结一下，希望能比迄今为止提供的答案更完整的解释......

## 简答

用显式等待替换第二个`await`对控制台应用程序没有明显影响，但会在等待期间阻塞 WPF 或 WinForms 应用程序的 UI 线程。

此外，异常处理略有不同（如 Stephen Cleary 所述）。

## 长答案

简而言之，这样`await`做：

1.  如果等待的任务已经完成，它只是检索其结果并继续。
2.  如果没有，它会将延续（在 之后的方法的其余部分）[发布](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.post.aspx)`await`到[当前](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.current.aspx)同步上下文（如果有的话）。从本质上讲，`await`是试图让我们回到我们开始的地方。
    *   如果没有当前上下文，它只使用原始的[TaskScheduler](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.aspx)，通常是线程池。

第二个（和第三个等等......）也是如此`await`。

由于控制台应用程序通常没有同步上下文，延续通常由线程池处理，因此如果我们在延续中阻塞也没有问题。

另一方面，WinForms 或 WPF 在其消息循环之上实现了同步上下文。因此，`await`在 UI 线程上执行（最终）也会在 UI 线程上执行其延续。如果我们碰巧在 continuation 中阻塞，它将阻塞消息循环并使 UI 无响应，直到我们解除阻塞。OTOH，如果我们只是`await`，它将巧妙地发布延续，最终在 UI 线程上执行，而不会阻塞 UI 线程。

在下面的 WinForms 表单中，包含一个按钮和一个标签，使用`await`始终保持 UI 响应（注意`async`点击处理程序前面的）：

```
public partial class Form1 : Form {

    public Form1() {
        InitializeComponent();
    }

    private async void button1_Click(object sender, EventArgs e) {
        var result = await FooAsync();
        label1.Text = result.ToString();
    }

    static async Task<int> FooAsync() {

        var t1 = Method1Async();
        var t2 = Method2Async();

        var result1 = await t1;
        var result2 = await t2;

        return result1 + result2;

    }

    static Task<int> Method1Async() {
        return Task.Run(
            () => {
                Thread.Sleep(3000);
                return 11;
            }
        );
    }

    static Task<int> Method2Async() {
        return Task.Run(
            () => {
                Thread.Sleep(5000);
                return 22;
            }
        );
    }

} 
```

如果我们将第二个替换为`await`，`FooAsync`它`t2.Result`会在按钮单击后继续响应约 3 秒，然后冻结约 2 秒：

*   第一个之后的继续`await`将礼貌地等待轮到在 UI 线程上安排，这将在`Method1Async()`任务完成后发生，即大约 3 秒后，
*   此时`t2.Result`将粗暴地阻塞 UI 线程，直到`Method2Async()`任务完成，大约 2 秒后。

如果我们删除`async`前面的`button1_Click`并用它替换`await`它`FooAsync().Result`会死锁：

*   UI线程将等待`FooAsync()`任务完成，
*   它将等待其继续完成，
*   这将等待 UI 线程变为可用，
*   它不是，因为它被`FooAsync().Result`.

Stephen Toub的文章[“Await、SynchronizationContext 和控制台应用程序”对我理解这个主题非常宝贵。](http://blogs.msdn.com/b/pfxteam/archive/2012/01/20/10259049.aspx)

# html - 无法水平滚动表格

> ID：12653526
> 
> 赞同：0
> 
> 时间：2012-09-29T14:25:10.050
> 
> 标签：html, css

我正在尝试将表格的每一列设为页面宽度的 25%。当我有超过四列时，我希望能够水平滚动表格以查看其他列。

所以我将所有单元格的宽度设置为固定数量的像素（等于我固定页面宽度的 25%）。我尝试设置`overflow-x`为两者`scroll`然后`auto`. 但是在这两种情况下，列宽都被压缩了，因此表格宽度永远不会超过页面的宽度。

似乎我的单元格宽度被完全忽略了！如何告诉浏览器尊重我的列宽并让表格变得足够宽以容纳它们？

*注意：我正在使用 ASP.NET MVC 以编程方式构建页面。我不知道会有多少列。但是我在构建 HTML 时确实知道列数。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:00:14.980

鉴于问题：

```
body {
    width: 100%;
}
#percent {
    width: 100%;
}
#percent td {
    width: 25%;
    background: #cdd;
}​

<p>Percent only</p>
<table id="percent">
<tbody>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
</tbody>
</table> 
```

[http://jsfiddle.net/userdude/3SKwP/](http://jsfiddle.net/userdude/3SKwP/)

表格的宽度不会超出`body`元素的宽度，因为两者都设置为`100%`.

为了弥补缺少定义`width`来强制`body`溢出，您可以`min-width`在`td`元素上使用：

```
#percent,
#fixed {
    width: 100%;
}
#percent td,
#fixed td {
    width: 25%;
    background: #cdd;
}
#fixed td {
    min-width: 150px;
}​

<p>min-width: 150px</p>
<table id="fixed">
<tbody>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
</tbody>
</table>​ 
```

[http://jsfiddle.net/userdude/3SKwP/1/](http://jsfiddle.net/userdude/3SKwP/1/)

这样做的缺点，如果你想这样称呼它，就是 IE7 不支持`min-width`. 因此，如果您需要支持它，则必须为它填充一些东西。但除此之外，这对你来说应该很好。

# ruby - 如何在 ruby 中创建非阻塞 TCP 服务器和 TCP 套接字，只有以下更改有所不同？

> ID：12653532
> 
> 赞同：3
> 
> 时间：2012-09-29T14:25:41.483
> 
> 标签：ruby, sockets, tcp, nonblocking

就像在客户端套接字中

```
 socket = Socket.new(AF_INET, SOCK_STREAM, 0) 
     sockaddr = Socket.pack_sockaddr_in(2200, 'localhost') 
     socket.connect_nonblock(sockaddr)
     server_msg = socket.recv_nonblock(3058)
                   vs
     clientSession = TCPSocket.new( "localhost",2200)
     server_msg = socket.recv(3058) 
```

就像在服务器中

```
 socket = Socket.new(AF_INET, SOCK_STREAM, 0)
      sockaddr = Socket.sockaddr_in(6212, 'localhost')
      socket.bind(sockaddr)
      socket.listen(5)
                    vs
      server = TCPServer.new("localhost",3000) 
```

在语法上是不同的还是在逻辑上我们应该使它们成为非阻塞的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T13:15:45.500

也许你可以使用超时？

如果没有响应，我们使用以下代码让 ruby​​ 套接字客户端超时：

```
@socket = TCPSocket.new(host, port)

timeout=30.0
ready = IO.select([@socket], nil, nil, timeout)

if ready
  response = @socket.recv(SOCKET_READ_SIZE)
else
  message = "Socket communications timed out after #{timeout} seconds"
  logger.error message
  @socket.close if @socket.present?
  raise message
end 
```

# php - 拆分和合并文件

> ID：12653540
> 
> 赞同：0
> 
> 时间：2012-09-29T14:26:36.923
> 
> 标签：php, split, fopen, fseek

我有一种解决方案的“开始”。我写了这个函数（对不起间距）：

```
<?php
set_time_limit(0);

// Just to get the remote filesize

function checkFilesize($url, $user = "", $pw = ""){

 ob_start();

 $ch = curl_init($url);

 curl_setopt($ch, CURLOPT_HEADER, 1);

 curl_setopt($ch, CURLOPT_NOBODY, 1);

 if(!empty($user) && !empty($pw)){

  $headers = array('Authorization: Basic ' .  base64_encode("$user:$pw"));

  curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

 }

 $ok = curl_exec($ch);

 curl_close($ch);

 $head = ob_get_contents();

 ob_end_clean();

 $regex = '/Content-Length:\s([0-9].+?)\s/';

 $count = preg_match($regex, $head, $matches);

 return isset($matches[1]) ? $matches[1] : "unknown";

}

// Split filesize to threads

function fileCutter($filesize,$threads){

 $calc = round($filesize / count($threads));

 $count = 0;

 foreach($threads as $thread){

  $rounds[$count] =  $calc;

  $count++;

 }

 $count = 0;

 foreach($rounds as $round){

  $set = $count + 1;

  if($count == 0){

   $from = 0;

  } else {

   $from = ($round * $count);

  }

  $cal = ($round * $set);

  $final[$count] = array('from'=>$from,'to'=>$cal);

  $count++;

 }

 // Correct the "Rounded" result

 $end = end($final);

 $differance = $filesize - $end['to'];

 if (strpos($differance,'-') !== false) {} else {$add = '+';}

 $end_result =  ($end['to'].$add.$differance);

 $value=eval("return ($end_result);");

 $end_id = end(array_keys($final));

 $final[$end_id]['to'] = $value;

 // Return the complete array with the corrected result

 return $final;

}

$threads = array(
 0=>'test',
 1=>'test',
 2=>'test',
 3=>'test',
 4=>'test',
 5=>'test',
);

$file  = 'http://www.example.com/file.zip';

$filesize = checkFilesize($file);

$cuts = fileCutter($filesize,$threads);

print_r($cuts);

?> 
```

（再次，对不起。:)）

它给出了将文件拆分为特定字节的“方向”。我试图做这样的事情：

```
foreach($cuts as $cut){
$start = $cut['from'];
$finish = $cut['to'];
$f = fopen($file, "rb");
fseek($f, $start, SEEK_SET);
while(!(ftell($f) > $finish)){
  $data = fgetc($f);
}
fclose($f); 
```

但它会陷入无限循环。问题是什么？或者，PHP 中是否有另一种解决方案来拆分和合并文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:30:15.380

而不是手动和逐字节读取文件，您可以使用[`file_get_contents()`](http://php.net/file_get_contents)相应的参数`$offset`和`$maxlen`：

```
//                             $incp  $ctx  $offset  $maxlen
$data = file_get_contents($fn, FALSE, NULL, $start, $finish-$start); 
```

这将为您完成寻找和切割。

# php - 在两个奇数日期选择中查找 NOW()

> ID：12653543
> 
> 赞同：0
> 
> 时间：2012-09-29T14:26:54.340
> 
> 标签：php, mysql, mysqli

我过去使用过许多日期功能，但我需要有关特定功能的帮助...

是否有一个功能可以让我分配两个未知日期并且系统知道我在这两个日期内的位置？让我解释：

我们的月薪从每个月的 23 日到下个月的 22 日。因为收入按小时计算，所以我的老板想知道一个月内的任何地方的累积工资。例如，工资期从 2012 年 9 月 23 日开始，我们现在是 29 日，我希望我的查询能够知道我们在当前工资期的位置。

如您所知，几个月过去了，因此我的脚本必须自动知道我们现在处于哪个时期以及那个时期的哪个位置。

我可以围绕这个进行查询，我只需要知道用于分配这个数组的日期函数......

任何帮助将不胜感激 - Thanx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:33:44.353

您可以使用 PHP 的[DateTime](http://php.net/datetime)类很容易地做到这一点：-

```
$periodStart = new DateTime('23rd September');
$now = new DateTime();
$interval = $now->diff($periodStart);
echo "We are {$interval->d} days into the payment period"; 
```

输出：

> 我们进入付款期 6 天。

我更喜欢为这种事情扩展 DateTime 类，所以一切都在同一个地方：-

```
class MyDateTime extends DateTime
{
    public function elapsedDays(DateTime $since = null)
    {
        if ($since === null) {
            $since = new DateTime();
        }
        $interval = $since->diff($this);
        return (int) $interval->d;
    }
}

$periodStart = new MyDateTime('23rd September');
echo "We are {$periodStart->elapsedDays()} days into the payment period"; 
```

给出相同的输出。

然后，您可以创建周期和间隔并对其进行迭代以聚合总和，例如：

```
$datePeriodStart = new DateTime('23rd September');
$datePeriodEnd   = clone $datePeriodStart;
$datePeriodEnd->add(new DateInterval('P1M'));

$dateToday = new DateTime();
$interval1 = $dateToday->diff($datePeriodStart);
$interval2 = $dateToday->diff($datePeriodEnd);

echo "We are {$interval1->d} day(s) into the payment period, {$interval2->d} day(s) left.\n";

$period = new DatePeriod($datePeriodStart, new DateInterval('P1D'), $dateToday);
$days = new IteratorIterator($period);

$totalSalary = 0;
$totalDays = 0;
foreach($days as $day)
{
    $salary = get_salary_for_day($day);

    $totalSalary += $salary;
    $totalDays++;

    printf("#%d: %s %s\n", $totalDays, $day->format('Y-m-d'), number_format($salary));
}

printf("Total Salary for %d day(s): %s\n", $totalDays, number_format($totalSalary)); 
```

示例输出：

```
We are 6 day(s) into the payment period, 23 day(s) left.
#1: 2012-09-23 12,500
#2: 2012-09-24 12,500
#3: 2012-09-25 12,500
#4: 2012-09-26 12,500
#5: 2012-09-27 12,500
#6: 2012-09-28 12,500
#7: 2012-09-29 12,500
Total Salary for 7 day(s): 87,500 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:28:43.540

您可以简单地使用 TIMESTAMP 值（自纪元以来的秒数，也称为“unix 时间戳”），然后测试 unix 时间戳中的当前日期是否介于第一个和最后一个 unix 时间戳日期之间。

从本质上讲，这样您只需将日期转换为一个大整数（自 1969/70 以来的秒数），并且算术和测试函数变得更容易处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:46:03.730

获取 FROM 和 TO 日期：

```
$to = new DateTime();
$from = new DateTime($to->format('Y-m-23'));
if ($to->format('j') < 23) {
    $from->modify('-1 month');
} 
```

var_dump：

```
var_dump($from->format('Y-m-d')); # 2012-09-23
var_dump($to->format('Y-m-d')); # 2012-09-29 
```

SQL

```
$sql = "
    SELECT ...
    FROM ...
    WHERE some_time BETWEEN '" . $from->format('Y-m-d') . "' AND '" . $to->format('Y-m-d') ."'
"; 
```

# tornado - GridFS 元素不遵循 Document 元素

> ID：12653548
> 
> 赞同：0
> 
> 时间：2012-09-29T14:27:11.157
> 
> 标签：tornado, pymongo, gridfs

这看起来很奇怪，但是当删除文档中的元素并尝试从 GridFS 中删除 _id（删除产品 + 其图像）时，它给了我一个错误，因为删除的图片不是元素的图片！`id`我使用`name of the user`+制作的图片`time.time`

这是代码：

```
class VentesHandler(BaseHandler):
    @tornado.web.authenticated
    def get(self):
        user = self.get_secure_cookie("mechtari")
        info = tornado.escape.json_decode(user)
        email = info["personnel"]["email"]
        try:
            produits = self.db.users.find({"personnel.email":email}, {"produit_up":1,"_id":0}).distinct("produit_up")
            renderer = self.fs
            print str(self.db.users.find({"personnel.pseudo":"alucaard"}).distinct("produit_up"))
            print str(self.fs.list())
        except (errors.AutoReconnect, errors.ConnectionFailure):
            print "hopla"
            self.redirect("/error")
    try:
        self.render("ventes.html", produits=produits, renderer=renderer)
    except gridfs.errors.NoFile, e:
        self.write(str(e))

class Supprimer(BaseHandler):
    @tornado.web.authenticated
    def post(self):
        debut = time.clock()
        prod = self.get_arguments("supprime")
        produ = prod[0][:]
        idd = self.db.users.find_one({"produit_up.spec.id":produ})["produit_up"][0]["avatar"]["photo"]
        print idd
        try:
            self.db.users.update({"produit_up.spec.id":produ}, {"$pull":{"produit_up"{"spec.id":produ}}})
            self.fs.delete(ObjectId('{0}'.format(idd)))
            print str(self.db.users.find({"personnel.pseudo":"alucaard"}).distinct("produit_up"))
            print str(self.fs.list())
        except (errors.AutoReconnect, errors.ConnectionFailure):
            self.redirect("/error")
    print time.clock() - debut
    self.redirect("/ventes") 
```

模板：

```
{% for produit in produits %}
<div class="produit">
<span class="nom">Le nom du produit: {{produit["spec"]["namep"]}}</span>
{% if produit["spec"]["nombre"] != 0 %}
<span class="quantite">Le nombre de produits disponible: {{produit["spec"]["nombre"]}}   </span>
        {% else %}
        <span class="quantite"><em>RUPTURE DE STOCK!</em></span>
        {% end %}
        <span class="prix">Son prix: {{produit["spec"]["prix"]}} DA ({{produit["spec"]["prix"]*100}} Centimes)</span>
        <span class="description">Description: {{produit["spec"]["description"]}}</span>
        <span class="date">Publi&eacute; le {{produit["spec"]["date"]}}</span>
        <span class="site"><a href="{{produit["spec"]["id"]}}">Page du Produit</a></span>
        {% from bson import ObjectId %}
        {% if produit["avatar"]["orientation"]=="portrait" %}
        <span><img src="/{{renderer.get(ObjectId(produit["avatar"]["photo"])).filename}}" height="250px" class="imag">
        {% else %}
        <span><img src="/{{renderer.get(ObjectId(produit["avatar"]["photo"])).filename}}" width="250px"class="imag">
        {% end %}
        <div class="supprimer" >
            <form name="supprimer" class="supprimer" method="post" action="/supprimer">
                {% raw xsrf_form_html() %}
                <input type="hidden" value="{{produit["spec"]["id"]}}" name="supprime"/>
                <script>function miaw()
                {
                return confirm("Voulez-Vous vraiment SUPPRIMER le produit DÉFINITIVEMENT!")
                }
                </script>                   
                <input type="submit" value="SUPPRIMER!" onclick="return miaw()"/>
            </form>
        </div>
</div>{% end %}{% end %} 
```

这是结果，没有删除，所以，在代码的第一次执行中：

```
[{u'spec': {u'description': u'vend nokia 3310  du top', u'tags': [u'nokia', u'portable', u'solide'], u'vendu': False, u'prix': 1000, u'abus': 0, u'namep': u'nokia 3310', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859865997'}, u'avatar': {u'photo': ObjectId('5061fb833a5f3a09f4be0e22'), u'avctype': u'image/jpeg', u'orientation': u'portrait'}}, {u'spec': {u'description': u'iphone foooooooort', u'tags': [u'iphone', u'apple', u'3g'], u'vendu': False, u'prix': 20000, u'abus': 0, u'namep': u'iphone 3gs', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859872247'}, u'avatar': {u'photo': ObjectId('5061fbc23a5f3a09f4be0e24'), u'avctype': u'image/jpeg', u'orientation': u'portrait'}}, {u'spec': {u'description': u'bajoooooooot', u'tags': [u'206', u'hdi', u'peugeot'], u'vendu': False, u'prix': 500000, u'abus': 0, u'namep': u'peugeot 206', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859875565'}, u'avatar': {u'photo': ObjectId('5061fbe33a5f3a09f4be0e26'), u'avctype': u'image/jpeg', u'orientation': u'paysage'}}]

[u'134859845728-nopic.jpg', u'134859865997-nokia.jpg', u'134859872247-apple-iphone-3-gs.jpg', u'134859875565-peugeot.jpg'] 
```

仅删除列表中的第一个元素时（添加的最新元素，此处为 NokIa 3310）：

代码：

```
print str(self.db.users.find({"personnel.pseudo":"alucaard"}).distinct("produit_up")) 
```

给出：

```
[{u'spec': {u'description': u'iphone foooooooort', u'tags': [u'iphone', u'apple', u'3g'], u'vendu': False, u'prix': 20000, u'abus': 0, u'namep': u'iphone 3gs', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859872247'}, u'avatar': {u'photo': ObjectId('5061fbc23a5f3a09f4be0e24'), u'avctype': u'image/jpeg', u'orientation': u'portrait'}}, {u'spec': {u'description': u'bajoooooooot', u'tags': [u'206', u'hdi', u'peugeot'], u'vendu': False, u'prix': 500000, u'abus': 0, u'namep': u'peugeot 206', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859875565'}, u'avatar': {u'photo':ObjectId('5061fbe33a5f3a09f4be0e26'), u'avctype': u'image/jpeg', u'orientation': u'paysage'}}] 
```

和代码：

```
print str(self.fs.list())

[u'134859845728-nopic.jpg', u'134859872247-apple-iphone-3-gs.jpg', u'134859875565-peugeot.jpg'] 
```

但是当试图删除不是第一个的产品时，这里还有 2 个产品，iphone 和 peugeot，所以让我们删除 peugeot：

```
[{u'spec': {u'description': u'iphone foooooooort', u'tags': [u'iphone', u'apple', u'3g'], u'vendu': False, u'prix': 20000, u'abus': 0, u'namep': u'iphone 3gs', u'date': u'2012-09-25', u'nombre': 1, u'id': u'alucaard134859872247'}, u'avatar': {u'photo': ObjectId('5061fbc23a5f3a09f4be0e24'), u'avctype': u'image/jpeg', u'orientation': u'portrait'}}]

[u'134859845728-nopic.jpg', u'134859875565-peugeot.jpg'] 
```

错误是：

```
no file in gridfs collection Collection(Database(Connection('localhost', 27017), u'essog'), u'fs.files') with _id ObjectId('5061fbc23a5f3a09f4be0e24') 
```

如您所见，它似乎没有删除正确的图片！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:48:38.157

解决了！

我是这样做的：

```
 list(db.users.find({"produit_up.spec.id":"alucaard134859872247"}).distinct("produit_up.spec"))

Out[13]: 
[{u'abus': 0,
u'date': u'2012-09-25',
u'description': u'vend nokia 3310  du top',
u'id': u'alucaard134859865997',
u'namep': u'nokia 3310',
u'nombre': 1,
u'prix': 1000,
u'tags': [u'nokia', u'portable', u'solide'],
u'vendu': False},

{u'abus': 0,
u'date': u'2012-09-25',
u'description': u'iphone foooooooort',
u'id': u'alucaard134859872247',
u'namep': u'iphone 3gs',
u'nombre': 1,
u'prix': 20000,
u'tags': [u'iphone', u'apple', u'3g'],
u'vendu': False},

{u'abus': 0,
u'date': u'2012-09-25',
u'description': u'bajoooooooot',
u'id': u'alucaard134859875565',
u'namep': u'peugeot 206',
u'nombre': 1,
u'prix': 500000,
u'tags': [u'206', u'hdi', u'peugeot'],
u'vendu': False}]

  list(db.users.find({"produit_up.spec.id":"alucaard134859872247"}).distinct("produit_up.spec.id"))

Out[14]: [u'alucaard134859865997', u'alucaard134859872247', u'alucaard134859875565'] 
```

所以解决方案是替换：

```
idd = self.db.users.find_one({"produit_up.spec.id":produ})["produit_up"][0]["avatar"]["photo"] 
```

经过

```
idd = self.db.users.find_one({"produit_up.spec.id":produ})["produit_up"][0]["avatar"]["photo"] 
```

对不起 :D

所以这就是为什么我在删除第一个元素时没有出错！

# ajax - 在触发 ajax 更新之前使用 oncomplete 属性加载数据表对象列表

> ID：12653550
> 
> 赞同：0
> 
> 时间：2012-09-29T14:27:29.153
> 
> 标签：ajax, jsf, file-upload, primefaces, managed-bean

我有一个包含文件信息的数据表，首先用户上传文件，然后将文件添加到数据库中，并且文件信息出现在数据表中，这是我的代码：

```
 <p:fileUpload fileUploadListener="#{projectTestManagementMB.handleFileUpload}"  

      oncomplete="projectTestManagementMB.loadFamilyAttachemtsList()"    
       update="familyAttachmentDt" />  

       <p:dataTable id="familyAttachmentDt" var="familyAttachment" value="#
           {projectTestManagementMB.familyAttachmentsList}">  
                                      <p:column headerText="Name">  
                                        <h:outputText value="#{familyAttachment.name}" 
                          />  
                                      </p:column>  

                                        <p:column headerText="Size">  
                                          <h:outputText value="#
                                      {familyAttachment.size}" />  
                                        </p:column>  

                                        <p:column headerText="Creation Date">  
                                          <h:outputText value="#
                                   {familyAttachment.date}" />  
                                       </p:column>  

                                       <p:column headerText="Options">  

                                      </p:column>  
                                  </p:dataTable> 
```

我想刷新数据表，所以我使用指向数据表的更新属性和 oncomplete 属性来调用 loadFamilyAttachemtsList() 方法：

```
 public void loadFamilyAttachemtsList(){
   System.out.println("loadFamilyAttachemtsList");
   Family family= (Family) selectedNode.getData();
   DataModel.setCurrentFamily(family);
   familyAttachmentList=DataModel.initSelectedFamilyAttachements(family);

     } 
```

但是这个方法永远不会被调用

任何 ida 将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:11:15.437

oncomplete 属性用于调用客户端 javascript 函数，而不是服务器端的任何方法。

因此，只需在最后调用您的 handleFileUpload 方法中的 loadFamilyAttachemtsList 方法即可。

# php - 我不知道这行代码会起作用。关于这样的实现，我应该知道什么吗？

> ID：12653558
> 
> 赞同：1
> 
> 时间：2012-09-29T14:28:20.130
> 
> 标签：php, function, inline

我不知道这样的东西（javascript-esque 内联函数）会在 PHP 中工作。作为一个花费大量时间编写 javascript/jquery 的人，当我的“我想知道这是否可行”的尝试实际上奏效时，我感到非常震惊。

```
usort($inbox_messages, function($a, $b){
    return strtotime($b["date"]) - strtotime($a["date"]);
}); 
```

现在，关于这样的实现，我应该知道什么吗？性能问题、向后兼容性、范围等。

这是常见的做法，还是糟糕的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:30:14.763

如果您需要分发代码以在不同的环境中运行，则向后兼容性可能是一个问题。*PHP 5.3之前不*支持匿名[函数。](http://php.net/manual/en/functions.anonymous.php)较旧的托管平台和企业服务器安装通常仍停留在 5.2.x 上，并带有供应商支持的 Linux 发行版等。

 *在过去的一年里，这种情况发生了迅速的变化，但随着这些旧装置的支持周期到期，几年后仍将是一个需要考虑的问题。

有关变量范围和`use`关键字的问题，请查看[匿名函数的链接文档](http://php.net/manual/en/functions.anonymous.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:36:42.083

这个特性被称为[匿名函数](http://php.net/manual/en/functions.anonymous.php)，它从 PHP 5.3 开始可用：

> 匿名函数，也称为闭包，允许创建没有指定名称的函数。它们作为回调参数的值最有用，但它们还有许多其他用途。

他们的范围分辨率也有（轻微的）差异：

> 闭包也可以从父作用域继承变量。任何此类变量都必须在函数头中声明。**从父作用域继承变量与使用全局变量不同。**

所以，在这个例子中：

```
$total = 0.00;
$callback = function ($quantity, $product) use ($tax, &$total)
{
    $pricePerItem = constant(__CLASS__ . "::PRICE_" . strtoupper($product));
    $total += ($pricePerItem * $quantity) * ($tax + 1.0);
};
array_walk($this->products, $callback); 
```

...从该文档页面中，`$tax`并且在不使用关键字`$total`的情况下有效地注入`closure`($callback) 范围。`global`

匿名函数实际上是[Closure](http://php.net/manual/en/class.closure.php)类的对象。而且它不仅仅是一个实现特性：因为（从 PHP 5.4 起）这些函数可以使用`$this`对象（类似于 JavaScript 中的上下文对象），有一些有用的方法可以改变这个上下文（[Closure::bind](http://php.net/manual/en/closure.bind.php)，[Cl​​osure::bindTo](http://php.net/manual/en/closure.bindto.php) -例如，将它们与[Function.bind](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)进行比较）。

`map`更具体地说，在/ -ing 集合时使用匿名函数实际上是一个好习惯`filter`，因为这些函数不会进入全局范围。但是，当然，如果您需要您的代码在 PHP 5.2 上运行，这不是一个解决方案。*

# asp.net - Aspx Listbox 行匹配计数问题

> ID：12653560
> 
> 赞同：1
> 
> 时间：2012-09-29T14:28:27.797
> 
> 标签：asp.net

将项目添加到列表框时，我遇到了一个奇怪的问题。我希望它调整它的大小以匹配它的计数。当添加 1 一切正常时，添加第二个并且行变为 4，然后在我们有超过 4 个之后一切正常。另一件事是列表框顶部的位置也向上移动了几个像素 - 奇怪。这是一个错误吗？这是添加它们的按钮事件代码。更新！

```
Dim s As String = tbTest.Text
If Not s = "" Then
  Dim li As New ListItem(s)
  If Not lsbTest.Items.Contains(li) Then
    lsbTest.Items.Add(li)
    Dim i As Integer = lsbTest.Items.Count
    lsbTest.Rows = i
    lsbTest.Height = i * 22
  End If
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:43:47.270

不要使用 Rows 属性。通过将 CSS 高度设置为包含 div 的 100% 来让它拉伸。

更新：

看看这个解决方案（谷歌搜索）：

[允许列表框垂直增长....](http://www.access-programmers.co.uk/forums/showthread.php?t=185977)

# xcode - Xcode - 意外的连接关闭

> ID：12653567
> 
> 赞同：1
> 
> 时间：2012-09-29T14:29:06.580
> 
> 标签：xcode, icloud

我正在尝试使用我正在开发的新应用程序同步设备。同步正在使用 iCloud。我可以将数据同步到 iPod 4 和 iPad 3。使用 iPhone 4S 时，我看到活动指示器在旋转，但会收到以下重复的控制台消息：

```
9/29/12 10:21:02.650 AM iTunes[271]: _NotificationSocketReadCallbackGCD (thread 0x7fff79ae8180): Unexpected connection closure...
9/29/12 10:21:02.650 AM Xcode[3204]: Result for ‘/SourceCache/DTDeviceKit/DTDeviceKit-1883/DTDeviceKitBase/DTDeviceKitBase_Utilities.m’ at 783 : 0xE8000084
9/29/12 10:21:02.650 AM Xcode[3204]: _NotificationSocketReadCallbackGCD (thread 0x1152c5000): Unexpected connection closure... 
```

此设备不同步。有谁知道他们的意思？如何解决问题？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:52:09.113

我不知道是什么导致了问题，但我通过使用 iTunes 恢复功能解决了它。

# python - 没有名为 pyopencl (Py2exe) 的模块

> ID：12653568
> 
> 赞同：5
> 
> 时间：2012-09-29T14:29:12.293
> 
> 标签：python, py2exe, pyopencl

尝试从 Py2Exe 制作 .exe 时，我遇到了 PyOpenCL 模块的一些问题。Py2Exe 会按照应有的方式生成 .exe（此处没有“ImportError：没有名为 pyopencl 的模块”），但是当我运行 .exe 时，它​​说没有名为 pyopencl 的模块。

我正在尝试制作 Phoenix Miner 的 .exe。

我的 setup.py：

```
from distutils.core import setup
import py2exe, sys, os, pyopencl

sys.argv.append('py2exe')

setup(
    options = {'py2exe': {'bundle_files': 1,
                          "includes":["pyopencl","twisted",
                                      "zope","QueueReader",
                                      "numpy"]}},
    console=[{'script' : 'phoenix.py'}],
    data_files=["C:\\Users\\Nicklas\\Desktop\\Phoenix-Miner\\kernels\\poclbm\\kernel.cl"],
    zipfile = None,
) 
```

我发现有人和我有同样的问题[http://bytes.com/topic/python/answers/848048-py2exe-module-error](http://bytes.com/topic/python/answers/848048-py2exe-module-error)但没有解决方案。

**更新：我找到了导致此错误的原因。在 pyopencl`__init__`中有一个名为 _find_pyopencl_include_path 的函数，它的作用是不言自明的。长话短说：imp 模块找不到 pyopencl 模块。为了解决这个问题，我注释掉了该行并将路径名设置为 pyopencls 包含目录的路径。可能不是一个好的修复。但这很容易解决。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T14:41:46.647

我找到了导致此错误的原因。在 pyopencl`__init__`中有一个名为 的函数`_find_pyopencl_include_path`，它的作用是不言自明的。长话短说：`imp`模块找不到`pyopencl`模块。为了解决这个问题，我注释掉了该行并将路径名设置为 pyopencls 包含目录的路径。可能不是一个好的修复。但这很容易解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-05T03:17:41.927

还有一种最简单的方法是使用`auto-py-to-exe`模块使python脚本可执行，可以使用安装，在python命令行终端中`pip install auto-py-to-exe`安装write后`auto-py-to-exe`会出现一个窗口，选择脚本位置并选择OneFile而不是OneDirectory，供参考我在这里粘贴`auto-py-to-exe`窗口截图 转换“打开输出文件夹”选项后，[![在此处输入图像描述](../Images/a6fed5bc0b762e2c9ab416c7aed979eb.png)](https://i.stack.imgur.com/TTnob.png) 您将在其中获得 Python 脚本的 .exe 文件。这个 .exe 文件可以在任何系统上运行，无需使用 python。

# magento - magento 属性值和产品图像存储在哪里？

> ID：12653572
> 
> 赞同：3
> 
> 时间：2012-09-29T14:29:32.637
> 
> 标签：magento, magento-1.6

我需要创建一个 SQL 查询来以 XML 格式导出我的 Magento 站点产品。

我不知道属性值和产品图像存储在哪里。

现在我的查询是这样的：

```
SELECT cpe.entity_id, cpe.sku, csi.qty, eav_color.value, eav_talla.value
FROM catalog_product_entity AS cpe
JOIN cataloginventory_stock_item AS csi ON csi.product_id = cpe.entity_id
JOIN catalog_product_entity_int AS eav_color ON eav_color.entity_id = cpe.entity_id
AND eav_color.attribute_id =85
JOIN catalog_product_entity_int AS eav_talla ON eav_talla.entity_id = cpe.entity_id
AND eav_talla.attribute_id =127
WHERE csi.qty >0
AND csi.is_in_stock
AND cpe.type_id =  'simple'
LIMIT 0 , 30 
```

但我正在获取属性 ID（我认为）。我的查询返回这个：

```
entity_id           sku                 qty value   value
6000            0121011000-RED-L    2.0000     66       5 
```

我得到 66 作为列属性的值和 5 的“talla”属性值。但这些值必须是“RED”和“L”。我不明白在哪个表中存储了这些值。

另一方面，我需要获取产品图片，但我无法确定表格的存储位置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T18:47:49.080

虽然图像有 EAV 属性，但它实际上存储在两个表中。

第一个是`catalog_product_entity_media_gallery`列：

*   value_id - 当前表的 id
*   attribute_id -`eav_attribute`表中属性的 id
*   `catalog_product_entity`entity_id -表中产品的 id
*   value - 文件的路径

第二个是`catalog_product_entity_media_gallery_value`列：

*   `catalog_product_entity_media_gallery`value_id -行的 id
*   store_id - 商店的 id
*   label - 图像的标签
*   position - 图像列表中的位置
*   disabled - 禁用商店的图像

因此`catalog_product_entity_media_gallery`为产品定义图像并`catalog_product_entity_media_gallery_value`处理不同商店视图的设置。

# java - getRequestCycle().urlFor not working in panel

> ID：12653573
> 
> 赞同：0
> 
> 时间：2012-09-29T14:29:48.777
> 
> 标签：java, web-applications, wicket

我需要检票口中组件的 URL。当我使用页面时它可以正常工作，但是当我使用面板时它不起作用。

```
public final class ImageP extends Panel {

    public ImageP(String id) {
        super(id);
        List<Mapp> list = Mapp.loadall(); //load image from database
        final Mapp asr = list.get(0);
        ByteArrayResource resource = new ByteArrayResource("image/jpeg", asr.getImage());
        Image image = new Image("img", resource);
        add(image);
        System.out.println(getRequestCycle().urlFor(image, IResourceListener.INTERFACE));
    }
} 
```

此代码不起作用并引发异常，但是当我使用页面而不是面板`getRequestCycle().urlFor(image, IResourceListener.INTERFACE)`时，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T08:49:41.730

我敢打赌你有以下例外：

```
java.lang.IllegalStateException: No Page found for component [Component id = img] 
```

这是因为 RequestCycle 对象在内部调用组件的 getPage() 方法，该组件是 urlFor() 方法的第一个参数，具有以下签名：

```
urlFor(Component component, RequestListenerInterface interface) 
```

如果在面板的构造函数中调用方法 urlFor() ，则无法获取面板子项的页面，因为面板尚未附加到页面。所以 Wicket 抛出“一个很好的例外”。

要解决这个问题，您只需将代码移动到面板的 onBeforeRender() 方法即可。像这样的东西：

```
@Override
protected void onBeforeRender() {
    //
    // ... init resource ...
    //

    Image image = new Image("img", resource);
    addOrReplace(image);
    System.out.println(getRequestCycle().urlFor(image, IResourceListener.INTERFACE));

    super.onBeforeRender();
} 
```

PS 我还假设您使用的是 Wicket 1.4 或更早版本，因为 Wicket 1.5 及更高版本中没有 RequestCycle.urlFor(component, listener) 方法。所以我认为在这种情况下，你的问题和我的回答都没有意义。

# c# - 为什么使用 LINQ 表达式？

> ID：12653576
> 
> 赞同：3
> 
> 时间：2012-09-29T14:30:05.413
> 
> 标签：c#, linq, code-readability

我使用 Resharper，当我编写如下几行代码时：

```
foreach (var posCombination in possibleCombinations)
{
    if (posCombination .Count == combo.Count && posCombination .Select((l, i) => combo.Contains(l)).All(b => b))
    {
        return true;
    }
}

return false; 
```

它会问我是否要将其转换为 LINQ 表达式：

```
return possibleCombinations.Any(possibleCombination => 
     possibleCombination.Count == combo.Count 
  && possibleCombination.Select((l, i) => combo.Contains(l)).All(b => b)); 
```

我有很多人告诉我，他们很难阅读 LINQ 语句中发生的事情......那么，如果它使我的代码可读性降低，我为什么要将它转换为 LINQ 表达式呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:38:49.383

这完全取决于您：如果您的代码的读者（包括您自己）更喜欢更冗长的风格，请务必保留它：难以阅读的聪明代码在程序员的时间上比在 CPU 时间上要昂贵得多。毕竟，这只是 ReSharper 的提示：关注或忽略它完全取决于您。

随着时间的推移，阅读 LINQ 代码会变得更容易（我知道这对我来说确实变得容易多了，但是编写 LINQ 代码并查看其他团队成员编写的 LINQ 代码需要花费大量时间）。我们发现特别有用的一件事是注释：一个 LINQ 表达式可以在短短的代码行中包含惊人数量的信息，因此一旦我偶然发现我写的一行代码，用简单的英语拼出意图有助于弄清楚含义几个月前。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T16:02:16.253

您已经在使用 LINQ 表达式，即代码的这一部分：

```
posCombination.Select((l, i) => combo.Contains(l)).All(b => b) 
```

所以你也许可以回答你自己的问题。为什么你决定在那里使用 LINQ 表达式？

我相信这更多的是 ReSharper 建议的问题，而不是 LINQ 表达式本身。正如其他人所说，它们只是建议，由您决定如何处理它们。我相信这个特别的建议只需要清理一下，然后它会让你的代码更具可读性。首先，应缩短 lamda 表达式的参数名称，因为您可以从调用集合中推断出它是什么。其次，您原来的 LINQ 表达式可以简化为：

```
posCombination.All(x => combo.Contains(x)) 
```

这是生成的 LINQ 表达式：

```
return possibleCombinations.Any(p => p.Count == combo.Count && 
                                     p.All(x => combo.Contains(x))); 
```

现在它是一个简洁但描述性的代码行，不需要您检查循环的内部结构。当然，这仍然只是一个建议。如果您愿意，您可以使用更具描述性的参数名称、将可读性较差的部分提取到方法中、添加注释或坚持使用您的原始代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:14:31.463

> 我有很多人告诉我，他们很难阅读 LINQ 语句中发生的事情......那么，如果它使我的代码可读性降低，我为什么要将它转换为 LINQ 表达式呢？

问题是现有代码看起来可读，因为开发人员已经习惯了很长时间。LINQ 语法相对较新（数据库查询除外）。

最初我什至连简单的 LINQ 表达式都难以理解，但通过练习我很喜欢它。不否认某些 LINQ 表达式只是晦涩难懂的事实（例如[Aggregate](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aggregate.aspx)）现在我可以轻松编写复杂的查询。

为什么要使用 LINQ 表达式？它简化了代码（减少了 LOC），并提供了强大的结构（如排序、过滤、分组、延迟加载）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T14:35:00.573

你可以设置 Resharper 来给你提示。您不必遵循它提出的每一个建议，老实说，这可能很烦人。

```
return possibleCombinations.Any(possibleCombination => possibleCombination.Count == combo.Count && possibleCombination.Select((l, i) => combo.Contains(l)).All(b => b)); 
```

是一个关于何时不应接受 Resharper 建议的示例。不是每个人都是 Linq 大师，我在和一些实习生一起工作时就知道这一点。他们一直问我的 Linq 代码是做什么的，甚至我的导师也不喜欢它。最好保持代码简单易读，从而易于维护。

当您想要完成的任务非常明显时，请使用 Linq。

如果您厌倦了，如何[配置Resharper。](http://www.jetbrains.com/resharper/webhelp/Code_Analysis__Configuring_Warnings.html)

# c# - 将 C# 与 javascript 一起使用

> ID：12653579
> 
> 赞同：0
> 
> 时间：2012-09-29T14:30:16.793
> 
> 标签：c#, javascript, asp.net

我想设置一个属性宽度javascript，然后在c#中使用它实际上我想创建一个包含评论的页面，当用户单击回复时，评论文本框上方的文本更改为“回复XXX”，然后单击发送ID为父评论保存在数据库中的评论是否有任何解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:39:08.897

您应该在页面中创建一个隐藏字段，并且每当用户单击回复时，将该隐藏字段的值设置为用户正在回复的问题的 id。这样，当用户发布表单时，它将同时发布他/她回复的内容的 ID 以及他/她自己的评论。

要查找隐藏字段，请使用 findcontrolbyid 函数。

确保提供隐藏字段的客户端 ID（不是您通过 Visual Studio IDE 分配的，而是由 asp.net 实际渲染的。您可以通过查看渲染页面的源来检查它。-asp.net 分配动态 id到所有服务器端控件。）

# object - 检查树枝中 for 循环内是否存在对象

> ID：12653587
> 
> 赞同：0
> 
> 时间：2012-09-29T14:31:31.497
> 
> 标签：object, twig

我试图弄清楚如何在树枝中执行 for 循环时检查对象的存在。

这就是我的代码的样子。

```
{% for topic in topics %}
    {% set id = topic.id %}
    {% set ratings = authRatings.id %}

    {% if ratings is defined %}
    {% else %}
    {% endif %}
{% endfor %} 
```

topic.id 是针，而 authRatings 是根据其 topic_id 命名的不同对象的大海捞针。如果对象与 topic.id 匹配，则应定义评级。

```
object
(stdClass)[76]
  public '24' => 

object
(stdClass)[77]
      public 'topic_id' => string '24' (length=2)
      public 'user_id' => string '2' (length=1)
      public 'likes' => string '0' (length=1)
      public 'dislikes' => string '1' (length=1)
      public 'time' => string '1348927295' (length=10)
  public '15' => 

object
(stdClass)[78]
      public 'topic_id' => string '15' (length=2)
      public 'user_id' => string '2' (length=1)
      public 'likes' => string '1' (length=1)
      public 'dislikes' => string '0' (length=1)
      public 'time' => string '1348927363' (length=10) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T22:02:28.160

您可以编写一个自定义函数来完成这项工作。像这样的东西：

```
$twig = new Twig_Environment($loader);
$twig->addFunction('searchRatings', new Twig_Function_Function('twig_search_ratings'));
function twig_search_ratings($topic_id, $ratings) {
   /* do the search in php */
} 
```

# forms - 从 URL 中删除 index.php (CodeIgniter)

> ID：12653589
> 
> 赞同：3
> 
> 时间：2012-09-29T14:31:35.567
> 
> 标签：forms, codeigniter, rewrite

我已经通过这段代码删除了 index.php：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|assets|robots\.txt)
RewriteRule ^(.*)$ /leet/index.php/$1 [L] 
```

但是当我提交表单`<?=form_open('signup');?>`并且页面刷新时，url 将其值更改为`localhost/ci/index.php/signup`.

是否可以删除它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-29T14:52:39.797

您必须检查 application\config 目录中的 config.php，如您所见，找到您的

```
$config['index_page'] = 'index.php'; 
```

将其更改为

```
$config['index_page'] = ''; 
```

我希望它有帮助！

# drop-down-menu - 下拉菜单、Brootstrap、菜单中心、文本左侧

> ID：12653591
> 
> 赞同：1
> 
> 时间：2012-09-29T14:31:52.873
> 
> 标签：drop-down-menu, twitter-bootstrap

我确信有人已经发布了这样的问题，但我找不到解决方案。

我正在使用 Ruby on Rails、Brootstrap，我想成为页面中间的下拉菜单（整个），但下拉菜单中的文本（如 We、What we do 等链接）应该是左侧。

我该怎么做？

```
 <div class="btn-toolbar">
      <div class="btn-group">

    <button id="action-btn" class="btn dropdown-toggle" data-toggle="dropdown">
      About us
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
      <li>
        <a href="del">
           <strong> We</strong>
         </a>
      </li>
      <li>

        <div class="mcol">
          <ul class ="sub">
            <div class ="subcolumns menuactivity">
              <a href="details"> What we do </a>
            </li>

      <a href="edit"> Countries </a>
    </div>
  </ul>
  <li>
    <a href="del">
      <strong>References </strong>
    </a>
  </li>
  </ul>

  <div class="btn-group">
    <button id="action-btn" class="btn dropdown-toggle" data-toggle="dropdown">
      News & Events
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
      <li>
        <a href="del">
          <strong>Calender</strong>
        </a>
      </li>
      <ul class ="sub">
        <div class ="subcolumns menuactivity">
          <li>
            <a href="details"> News archive</a>
          </li>
        </ul>
    </div>

  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T09:28:34.037

我已经找到了另一种解决方案。只需在css中放入以下代码：

```
.dropdown-menu {
  text-align: left;
   }

.btn-toolbar{
  text-align: center;
  padding-bottom:40px;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:35:12.380

如果您默认使用引导程序，则可以在下面尝试

```
 <a class="pull-left" href="details"> What we do </a> 
```

我已经更新了一个例子。

[http://jsfiddle.net/acc8t/](http://jsfiddle.net/acc8t/)

我通过使用下面的 css 做到了这一点

```
.sub{margin-left:0px;} 
```

# html - .htaccess url 重写不起作用

> ID：12653593
> 
> 赞同：0
> 
> 时间：2012-09-29T14:32:05.530
> 
> 标签：html, .htaccess, url

所以我试图重写：

url.com/edit_note.php?noteid=243

至

url.com/n/243

我正在使用这个：

```
RewriteEngine On 
RewriteRule /n/(.*)$ /edit_note.php?noteid=$1 
```

关于为什么这不起作用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:34:04.723

尝试这个：

```
RewriteEngine On
RewriteRule ^n/([^/]*)$ /edit_note.php?noteid=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:34:14.380

利用：

```
RewriteEngine On 
RewriteRule ^n/(.*)$ /edit_note.php?noteid=$1  [L] 
```

# html - twitter bootstrap下拉菜单弹出元素

> ID：12653598
> 
> 赞同：0
> 
> 时间：2012-09-29T14:33:04.103
> 
> 标签：html, css, layout, twitter-bootstrap

您可以在此屏幕截图中看到，每行包含“hi”的菜单在 body 元素下方以及屏幕上的按钮下方弹出。

![突然出现](../Images/2846164cb80bfa8e8d51f1a36d37aff5.png)

dom 结构如下所示：

![dom结构](../Images/79cc2f55aa9029cb694359d114d550de.png)

打开时下拉元素的计算样式为：

```
background-color: transparent;
color: #999;
display: block;
font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
font-size: 14px;
height: 20px;
line-height: 20px;
margin-bottom: 0px;
margin-left: 0px;
margin-right: 0px;
margin-top: 0px;
overflow-x: visible;
overflow-y: visible;
position: relative;
width: 1425px; 
```

这是弹出“超过”下拉菜单的计算样式的项目之一：

```
box-sizing: border-box;
color: white;
cursor: pointer;
display: inline-block;
height: 22px;
line-height: 17px;
list-style-image: none;
list-style-position: outside;
list-style-type: none;
overflow-x: visible;
overflow-y: visible;
vertical-align: middle;
width: 74px;
word-spacing: 0px; 
```

我似乎无法使用正确的 dom 和 css 魔法来使这项工作正常进行。在下拉 div 的导航栏中，我一直在玩 dom 层次结构中的位置。我也在下拉菜单、下拉菜单和弹出的元素上使用 z-index。

我觉得有点像我在这里没有看到的一些基本的东西。有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T03:15:30.593

我遇到了类似的问题。我可以通过从 nav-collapse 元素中删除 'collapse' 类来修复它。

我并没有真正深入研究这个问题，但这为我解决了问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T14:56:37.290

想通了，问题是我在导航栏上有一个 transform3d：

```
-webkit-transform: translate3d(0, 0, 0); 
```

删除它修复了它。我注意到当我删除 translate3d 时，导航栏的计算样式会导致 z-index 从 0 变为 auto。

不确定这是否是预期行为？

希望这对其他人有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T14:49:02.740

这是一个 z-index 问题。

确保导航栏高于其他元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-14T21:15:16.370

我发现我的类似问题是由于父元素的不透明度设置为低于 1。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-29T10:49:57.373

将css添加到父元素

```
overflow:visible; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-22T03:57:09.870

使用此处发布的答案，我执行了以下操作....在我的 _Layout.cshtml 上，我添加了

style="位置：相对；z-index：999；" 到我的容器主体内容 div（就在 RenderBody() 之前），所以它看起来像这样：

```
<div class="container body-content" style="position: relative; z-index: 999; ">
        @RenderBody() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-25T09:27:03.247

诚然，正如 arnirpc 提出的

```
-webkit-transform: translate3d(0, 0, 0); 
```

这麻烦。但是我不得不使用它，因为 Bootstrap Dynamic Pills 和 Tabs 也带有下拉菜单。在这里看到：[带有下拉菜单的药丸](https://getbootstrap.com/docs/4.1/components/navs/#pills-with-dropdowns)

因此，删除翻译会将下拉框移动到 Dropdown 按钮上方 - 这就是您不想要的。

但默认情况下，Bootstrap 4 药丸的下拉菜单甚至不起作用，因为下拉菜单隐藏在 TAB 内容后面，无论它是 H1、文本还是图像都无关紧要。

所以我在 LI、UL、容器等的许多内容上尝试了 z-index 的东西。什么都没有。

**我的解决方案：** 在这种情况下，它只是在内部内容上放置一个 z-index-minus-1（或任何具有 z-index：-1 的类）。

```
<div class="tab-content" id="pills-tabContent">
        <div class="tab-pane p-3 fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">

            <div class="row">
                <div class="col-sm-4 z-index-minus-1"> <!-- HERE --> 
```

# php - 如何让我自己的 Facebook 更新显示在我的网站上？

> ID：12653608
> 
> 赞同：0
> 
> 时间：2012-09-29T14:34:17.547
> 
> 标签：php, facebook

我正在尝试从 facebook 获取我最后的帖子以存储在数据库或数组中。我试图通过这样做来获取自己的更新：

```
<?

    require_once("src/facebook.php");

    $config = array();
    $config['appId'] = 'appId';
    $config['secret'] = 'secretId';
    $config['fileUpload'] = false; // optional

    $facebook = new Facebook($config);

    $feed = $facebook->api('/myUserId/feed');

    print_r($feed);

?> 
```

但它只返回我的个人信息，而不是我的更新，类似于：

```
Array ( [data] => Array ( [0] => Array ( [id] => ################## [from] => Array ( [name] => My Name [id] => My Id ) [story] => My Name likes a photo. [story_tags] => Array ( [0] => Array ( [0] => Array ( [id] => myId [name] => My Name [offset] => 0 [length] => 13 [type] => user ) ) ) [type] => status [application] => Array ( [name] => Likes [id] => ######## ) [created_time] => 2012-09-27T13:31:52+0000 [updated_time] => 2012-09-27T13:31:52+0000 [comments] => Array ( [count] => 0 ) ) ) [paging] => Array ( [previous] => https://graph.facebook.com/#######/feed?limit=25&since=1348752712&__previous=1 [next] => https://graph.facebook.com/#########/feed?limit=25&until=1348752711 ) ) 
```

我错过了什么？？

# android - AndEngine HUD 和场景

> ID：12653612
> 
> 赞同：0
> 
> 时间：2012-09-29T14:34:57.323
> 
> 标签：android, andengine

是否可以将精灵从 HUD 拖到 AndEngine 中的场景中？基本上，我的游戏提供了一个可能项目的“工具栏”，供用户从 HUD 拖动并作为静态物体放置在屏幕上，但我不知道该怎么做。

我对 AndEngine 完全陌生，所以如果你能给我任何提示、想法，或者为我指点这类事情的一些教程，那将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T08:55:19.493

这取决于你打算如何做事。HUD 只是主场景之上的另一个场景，因此拖动 Sprite 应该像往常一样工作。当您释放触摸时，只需将 Sprite 从 HUD 中分离出来并将其附加到场景中，就这么简单。

关于物理体，您应该同时创建它。我不知道如果您创建一个连接到附加到 HUD 的 Sprite 的 Body 会发生什么。再一次，创造身体是平常的事。

# mysql - sql求和行并放入select的列中

> ID：12653613
> 
> 赞同：1
> 
> 时间：2012-09-29T14:34:57.037
> 
> 标签：mysql, sql

我有一张桌子，基本上有：

```
person  activity-code  activity-value 
```

每人有多个活动代码（大约 17 个）和活动值。例如：

```
A  1   10
A  1   12
A  2   4
B  1   5
B  2   3
B  2   8 
```

我想要的是一个返回如下内容的选择语句：

```
A   22 4
B   5  11 
```

所以*第一列*是`person`. 第二*列*是那个人的总和`activity-values for the activity-code 1`。第三*列*是那个人的总和`activity-values for the activity-code 2`。ETC...

最后，我想这样做并在其中使用 OUTFILE 命令，因为我想将总数转储到要导入到 excel 文件中的文件中。

似乎那里有一个子查询，但我还不够先进，无法弄清楚。

任何帮助将不胜感激。如果这会有所帮助，我可以添加细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:37:27.270

对你来说不幸的是，Mysql 缺少`pivot`其他数据库中存在的命令，这使得这种事情变得轻而易举。你被困在类似的东西上

```
 select
      person,
      sum(case activitycode when 1 then activityvalue else 0 end),
      sum(case activitycode when 2 then activityvalue else 0 end),
      ....
 from 
      yourtable
 group by
      person 
```

# batch-file - 显示多个文件夹内容的批处理脚本

> ID：12653615
> 
> 赞同：0
> 
> 时间：2012-09-29T14:35:00.960
> 
> 标签：batch-file

我正在使用一个批处理脚本，该脚本会将文本文件中列出的特定文件夹的内容显示到另一个文本文件中。

例如：

包含文件夹名称的文本文件将如下所示：

SMPL505
SMPL520
SMPL590

将包含输出的文本文件 - 每个文件夹中的文件列表：

SMPL505 SMPL505.JPG SMPL505.TXT ...
SMPL520 SMPL520.JPG SMPL520.TXT ...
SMPL590 SMPL590.JPG SMPL590.TXT ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T21:44:28.400

这是一个脚本（需要进行一些清理），但它会给您请求的输出到文件 results.txt，因为所有完整的文件夹名称（例如：C:\users\desktop\folder）都在文件 test 中。文本。

```
@echo off

FOR /F "tokens=* delims=" %%a in (test.txt) do (
cd %%a
dir /b >>temp.txt

FOR /F "tokens=* delims=\" %%a in (temp.txt) do (
echo %%~nxa >>temp2.txt
type temp2.txt | findstr /V "temp.txt temp2.txt" > temp3.txt
move temp3.txt C:\Users\Desktop
del temp.txt temp2.txt
cd C:\Users\Desktop
type temp3.txt >>results.txt
del temp3.txt
) 
```

# javascript - javascript倒计时口吃

> ID：12653617
> 
> 赞同：0
> 
> 时间：2012-09-29T14:35:05.457
> 
> 标签：javascript, countdown

我有一个这样的倒计时：

```
var countdown = {
    startInterval: function() {
        var count = 600
        var countorig = 600;
        var currentId = setInterval(function() {
            var min = (count - (count % 60)) / 60;
            var sec = count % 60;
            if (sec < 10) {
                $('#timer').html(min + ':0' + sec);
            } else {
                $('#timer').html(min + ':' + sec);
            }
            $('#time').val(countorig - count);
            if (count == 0) {
                $('#form').submit();
            }--count;
        }, 1000);
        countdown.intervalId = currentId;
    }
}; 
```

有用。但是，如果我加载页面，倒计时开始，但它不像时钟那样“圆”。

[JSF](http://jsfiddle.net/NerCD/)中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:40:54.717

`setInterval`不准确。您应该使用`Date`s 来获得准确的时间，然后选择小于一秒的间隔以获得更平滑的时钟。[这是一个演示！](http://jsfiddle.net/XX75f/)

```
var countdown = {
    startInterval: function() {
        var count = 600;
        var start = new Date(); // The current date!

        var currentId = setInterval(function() {
            var difference = Math.max(0, count - (new Date() - start) / 1000 | 0);
            var min = difference / 60 | 0;
            var sec = difference % 60;

            $('#timer').text(min + ':' + (sec < 10 ? '0' : '') + sec);
            $('#time').val(difference);

            if(count === 0) {
                $('#form').submit();
            }
        }, 200);

        countdown.intervalId = currentId;
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:41:24.677

假设您的计时器是准确的，这绝不是一个好主意。相反，使用增量计时。

```
var startTime = new Date().getTime();
setInterval(function() {
    var elapsed = new Date().getTime()-startTime;
    console.log("Been running for "+Math.floor(elapsed/1000)+" seconds");
},25); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:40:38.257

那是因为 setInterval 并不意味着是一个高分辨率计时器。它不会每 1000 毫秒命中一次。您可能会在任一方向上摆动多达 20 到 30 毫秒，从而导致时钟关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T17:52:01.837

使用`Date.now()`，这是一个倒计时函数的快速示例（`x`以毫秒为单位）

```
function countdown(x){
    var o = {future: Date.now()+x, last:-1, i:null}; // object so we can pass by-ref if req.

    o.i = setInterval( function() { // use o.i so we can clear interval
        var remain = o.future - Date.now(),
            secs = Math.floor( remain / 1000 ),
            mins = 0;

        if( remain < 0 ){ // finished, do whatever
            return clearInterval(o.i); // then clear & exit
        }

        if( secs === o.last ) return; // skip this iteration if it's not been a second
        o.last = secs; // else update last time

        // do whatever you want for this new second
        if( secs > 59 ) mins = Math.floor( secs / 60 ), secs = secs % 60;
        console.log(
            (mins < 10 ? '0'+mins : mins) + ':' +
            (secs < 10 ? '0'+secs : secs) + ' remain.'
        );
    }, 100);
} 
```

如果您知道它**不会**在 IE 中使用，请考虑将`o`其作为参数添加到区间中的回调函数中，并作为最后一个参数`setInterval`（因此它作为第一个 arg 传递给回调），这意味着闭包是独立的 => 回调可以在任何地方定义。

# wpf - WPF xaml中的相对定位

> ID：12653621
> 
> 赞同：5
> 
> 时间：2012-09-29T14:35:31.273
> 
> 标签：wpf

是否可以在 XAML 定义中相对于另一个控件定位控件？
例如，如果我想将一个控件恰好放在另一个更宽的控件的中间。
如果是这样 - 如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T14:54:43.513

如果要使控件居中，可以将它们包装在网格中：

```
<Grid>
    <TextBox Height="132"   Width="229" VerticalAlignment="Center" HorizontalAlignment="Center" />
    <Button Content="Button" Height="23" Width="75" VerticalAlignment="Center" HorizontalAlignment="Center" />
</Grid> 
```

其他定位可以通过 StackPanel 等其他面板来完成。网格是最灵活的选择。

编辑：用网格和列更新以控制位置：

```
<Grid Height="50" Width="200">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="50*" />
        <ColumnDefinition Width="20*" />
        <ColumnDefinition Width="75*" />
    </Grid.ColumnDefinitions>
    <TextBox Grid.Column="0" Background="Red" />
    <Button Content="Button"  Grid.Column="2"   />
</Grid> 
```

# ruby - 逐行解析远程csv

> ID：12653624
> 
> 赞同：1
> 
> 时间：2012-09-29T14:35:55.907
> 
> 标签：ruby, parsing, csv

我有一个每隔几个小时更新一次的远程 CSV，它有 1m+ 行，我正在尝试确定是否可以逐行下载文件并解析它（我只对前 500,000 行感兴趣）而不是而不是必须下载整个文件然后处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:36:18.363

你可以试试这样的...

```
require 'csv'
require 'open-uri'

def read(url)
  open(url) do |f|
    f.each_line do |l|
      CSV.parse(l) do |row|
        p [row] 
      end
    end 
  end
end 
```

# asp.net-mvc - 首先在 mvc auto db 中自定义设置器

> ID：12653625
> 
> 赞同：0
> 
> 时间：2012-09-29T14:36:07.667
> 
> 标签：asp.net-mvc, entity-framework

我有一个使用实体框架在我的 MVC 应用程序中自动生成 DB-First 的用户模型

```
User
  +Username
  +Password 
```

我想修改`"Password"`字段的设置器，以便在将其存储在数据库中之前对其进行 SHA256 加密。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T04:01:10.763

我为codefirst看到的是将setter设为私有并添加一个名为SetPassword的方法。我不确定这对于 Db First 是否可行。考虑到您应该在更新用户密码盐的同时将其作为方法而不是属性设置器是有意义的。

# java - GAE/J 低级数据存储 API 和 DataNucleus JDO 之间拥有的一对多关系的区别

> ID：12653629
> 
> 赞同：0
> 
> 时间：2012-09-29T14:36:36.083
> 
> 标签：java, google-app-engine, datanucleus

在 Java 中创建拥有的一对多关系时，我注意到使用低级 Datastore API 和 DataNucleus JDO 之间的结果记录存在差异。不确定这是故意的还是任何解决方法。

例如，

如果以下链接中有员工的多个地址：

[https://developers.google.com/appengine/docs/java/datastore/entities#Ancestor_Paths](https://developers.google.com/appengine/docs/java/datastore/entities#Ancestor_Paths)

使用如下低级数据存储 api，员工记录不显示地址列（即属性）：

```
Entity employee = new Entity("Employee");
datastore.put(employee);

Entity address_home = new Entity("Address", employee.getKey());
datastore.put(address_home);

Entity address_mailing = new Entity("Address", employee.getKey());
datastore.put(address_mailing); 
```

使用 JDO，员工记录显示一个地址列（即属性）：

```
@PersistenceCapable
public class Employee {
    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Key key;

    @Persistent(mappedBy = "employee")
    private List<Address> addresses;

    List<Address> getAddresses() {
        return addresses;
    }
    void setAddresses(List<Address> addresses) {
        this.addresses = addresses;
    }

    // ...
}

@PersistenceCapable
public class Address {
    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Key key;

    @Persistent
    private Employee employee;

    @Persistent
    private String Street;

    ...
 } 
```

额外的财产是无害的。但是，为什么这对 JDO 来说是必需的？

我在开发服务器上使用带有 DataNucleus v2 的 GAE/J 1.7.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T06:21:00.640

GAE JDO 插件的最新存储版本会将对象中的所有关系作为属性存储，因此 Employee 类将具有它存储的地址的属性。这是一种比 GAE JDO 用来存储东西的方式更合乎逻辑的存储方式（它最初试图模拟外键，使用对方的所有权）。将 List 存储在所有者中具有将元素加载到集合中的优势，以及允许元素多次出现在 List 中（而对于较旧的存储版本，这是不可能的）。

所有版本的 GAE JDO 直到并包括 2.1.1 都将索引位置存储在列表中的每个地址中，而实际上它们现在不需要存储，因为 Employee 中的“地址”属性提供了这一点 - 这是从早期遗留下来的需要它的版本以这种方式存储。2.1.2 及以后的版本不会将该列表索引属性添加到元素中。

# php - 创建一个唯一的对话号码

> ID：12653632
> 
> 赞同：1
> 
> 时间：2012-09-29T14:36:48.960
> 
> 标签：php, mysql, sql

我正在开发一个私人消息系统，我想分配一个唯一的对话号码，以便我可以识别是否有多个用户参与了同一个对话。我正在考虑像这样分配发送消息的人的用户 ID + `microtime()` ：

```
$conversation_number =  md5($_POST['user_id']+microtime()); 
```

此代码是否始终源自唯一编号，或者也可能意外地为后续消息生成相同的编号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:38:19.897

您可以使用[**uniqid**](http://php.net/manual/en/function.uniqid.php)，它用于生成唯一 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:38:43.013

为什么不使用[UniqId()](http://php.net/manual/en/function.uniqid.php)函数？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:39:26.420

我认为php`uniqid`就足够了

来自 PHP 文档

> 如果设置为 TRUE，uniqid() 将在返回值的末尾添加额外的熵（使用组合的线性同余生成器），这增加了结果唯一的可能性

尝试

```
 uniqid('id', true) 
```

但是，在 32 位十六进制值 (16^32) 中大约有 3.402823669209387e+38 个不同的值，`md5`您的几率非常小，以至于会有相同的重复

# icalendar - iCal 提要和日期范围

> ID：12653634
> 
> 赞同：5
> 
> 时间：2012-09-29T14:36:59.217
> 
> 标签：icalendar, rfc2445, rfc5545

我试图了解 iCal 提要和 iCalendar 客户如何处理过去和未来的大量事件。iCalendar 客户端是否可以通过任何方式将日期范围传送到 iCalendar 提要 - 这样就不会不必要地向用户发送当前日期范围之外的事件。

如果不是，iCalendar 提要如何决定发送事件的日期范围？如果一个人继续通过网络发送**所有**数据，那么在某些时候它会变得无法管理，无论是提要还是客户端。如果提要没有在过去和很远的将来发送数据，客户端如何处理数据中的这些“漏洞”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T16:21:08.817

您需要区分作为事件提要的应用程序端和“只是”标准的 icalendar (rfc5545)

> 用于表示和交换日历和日程安排信息的数据格式

换句话说，从 icalendar 文件格式将只携带服务器已编程放入其中的任何信息。rfc5545 中的日历提要没有预定义的行为。

对于事件提要，如果您不控制服务器，可以安全地假设提要仅显示即将发生的事件，并且您的问题可能与： [如何获取 RSS 提要上的所有旧项目？](https://stackoverflow.com/q/576552/1167333)

如果您的用户有一个用例可以返回并列，如何跟踪历史记录。在这种情况下，唯一的选择是让您的客户保留历史记录并将新的 .ics 与旧的 .ics 进行比较以显示最全面的历史记录。

但是，如果您还拥有服务器/提要端，您可以决定特定的 REST API 为客户端提供更大的灵活性（即指定提要的日期范围）

# asp.net - 使用VB在根页面ASP.NET上检测当前页面

> ID：12653635
> 
> 赞同：0
> 
> 时间：2012-09-29T14:36:59.883
> 
> 标签：asp.net, css

我当前的代码如下。如果您访问我网页的根目录[http://evanparsons.net/](http://evanparsons.net/)，您会注意到当前页面没有突出显示，但是当您访问一个页面时，它可以工作。出于测试目的，我让它返回“myPage”值以查看它为什么不工作......它仍然返回 index.aspx。

```
 Dim pageName As String = System.IO.Path.GetFileName(System.Web.HttpContext.Current.Request.Url.AbsolutePath)
            While DBReader.Read()

            _link = _link + "<li><a href='" + (DBReader("source")) + "'"
            If ((pageName) = (DBReader("source"))) Then

                _link = _link + "class='current' "

            End If

            _link = _link + pageName

            _link = _link + ">-" + (DBReader("name")) + "-  </a></li>"

            End While 
```

基本上，我的导航来自一个扫描我的数据库的母版页，当它循环浏览它时，我想添加一个名为 current 的 css 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T16:06:06.947

您是否尝试过将它们转换为小写？

```
If (pageName.ToLower() = (DBReader("source")).ToLower()) Then 
```

# c# - C# XNA 多线程 SpriteBatch.End() “对象引用未设置为对象的实例”

> ID：12653637
> 
> 赞同：1
> 
> 时间：2012-09-29T14:37:08.057
> 
> 标签：c#, multithreading, exception, xna, spritebatch

我是多线程的新手，所以暂时搁置所有其他问题。我无法解决如何解决我的精灵批处理被更快的线程和下一个线程导致“对象引用未设置为对象的实例”的问题。

哦，如果您发现我的代码有任何其他问题，请随时让我觉得自己像个白痴^^

```
spriteBatch.Begin();

// Draw Particles
List<Thread> threads = new List<Thread>();
for (int i = 0; i < CPUCores; i++)
{
    int tempi = i; // This fixes the issue with i being shared
    Thread thread = new Thread(() => DrawParticles(tempi + 1, CPUCores));
    threads.Add(thread);
    thread.Start();
}
foreach (var thread in threads)
{
    thread.Join();
}

// ..More Drawing Code..

spriteBatch.End(); // <-- This is where the program crashes 
```

PS 谁认为使用 4 个空格来表示代码而不是 [code] [/code] 是个好主意？¬_¬

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T11:48:52.340

您的问题来自`SpriteBatch`不是线程安全的事实。通过从多个线程写入一个精灵批次，您正在破坏它。

`SpriteBatch`（`Immediate`模式除外）有点像`List`精灵（你不会从多个线程访问其中一个，对吗？）或精灵缓冲区。因此，一个可能的解决方案是`SpriteBatch`为每个线程设置一个。`Draw`通过在该线程内部调用来填充每个精灵批次“缓冲区” 。

然后，因为你只能在主线程上绘制东西（即：你只能`GraphicsDevice.Draw*`在主线程上调用，这是`SpriteBatch.End`内部调用的），等待你的工作线程完成每个批次的填充，然后`End`从它们中调用它们中的每一个主线程。这会将精灵绘制到屏幕上。

当然，如果您想绘制大量粒子，更好的技术可能是将所有内容卸载到 GPU 上。[这是一个答案](https://stackoverflow.com/a/3138075/165500)，可为您提供有关如何执行此操作的粗略指南。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:08:13.713

Graphics Device 一次只能被一个线程访问，并且 SpriteBatch 不是线程安全的，所以你的绘图调用应该从主线程发送。

如果您想优化代码以绘制更多对象，DrawInstancedPrimitives 会更干净

[http://blogs.msdn.com/b/shawnhar/archive/2010/06/17/drawinstancedprimitives-in-xna-game-studio-4-0.aspx](http://blogs.msdn.com/b/shawnhar/archive/2010/06/17/drawinstancedprimitives-in-xna-game-studio-4-0.aspx)

[http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.graphicsdevice.drawinstancedprimitives.aspx](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.graphicsdevice.drawinstancedprimitives.aspx)

# vb.net - 试图在 VB 中编写一个简单的程序，它将检查系统的时间值（现在），如果它是午夜，那么它会增加一个数字

> ID：12653638
> 
> 赞同：0
> 
> 时间：2012-09-29T14:37:24.443
> 
> 标签：vb.net, powerpoint-2010

我有兴趣使用 powerpoint 创建一个幻灯片，如果有新的一天或时间（午夜），它将只在形状中显示一个新数字。我知道 java 编程，但已经 6 年多没有做过编程了。我从来没有真正使用过VB。

```
Dim CurrentTime = TimeValue(now)

Sub If CurrentTime.Now = TimeValue(24:00:00)
 Then updateNum;
      i = i+1

'Then I would like to display 'i' in a shape on powerpoint.

End Sub 
```

正在考虑进行连续循环，因为文件将始终打开并且永远不会关闭。

或者我应该使用计时器来倒计时一天中的秒数然后增加数字吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T16:18:36.377

与 Excel 不同，PowerPoint 没有在`OnTimer`此有用的内容。

仅仅做一个循环将导致 100% 的处理器消耗。你可能不想要那个。

在每次迭代中调用[`Sleep()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)将保留处理器时间，但会使应用程序不负责任。你可能也不想要。

所以你真的应该设置一个计时器。如果您可以编写 VSTO 插件，则只需使用 Timer 类，否则自己在 VBA 中创建一个：

```
Option Explicit

Private Declare Function SetTimer Lib "user32.dll" (ByVal hwnd As Long, ByVal nIDEvent As Long, ByVal uElapse As Long, ByVal lpTimerFunc As Long) As Long
Private Declare Function KillTimer Lib "user32.dll" (ByVal hwnd As Long, ByVal nIDEvent As Long) As Long

Private hTimer As Long
Private PrevDate As Date

Public Sub StartTimer()
  If hTimer = 0 Then
    hTimer = SetTimer(0, 0, 1000, AddressOf TimerProc)
  End If
End Sub

Public Sub StopTimer()
  KillTimer 0, hTimer
  hTimer = 0
End Sub

Private Sub TimerProc(ByVal hwnd As Long, ByVal uMsg As Long, ByVal nIDEvent As Long, ByVal dwTime As Long)
  Dim CurDate As Date

  CurDate = Date
  If CurDate > PrevDate Then
    PrevDate = CurDate
    'Put your display code here
  End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T14:41:39.740

您可以将其包含在演示文稿的模块中。在幻灯片放映期间，它会在每次幻灯片更改时触发：

```
Sub OnSlideShowPageChange(ByVal SSW As SlideShowWindow)
  MsgBox (SSW.View.Slide.SlideIndex)
End Sub 
```

显然，将 MsgBox 语句替换为代码以使用当前日期/时间更新您的文本。

这适用于 PPT 2010，并且应该可以追溯到 Office 97，但没有记录/支持，因此 MS 可能会在他们一时兴起时将其删除。我不知道它是否适用于Mac上的PPT。

# c# - 创建具有由子实现的抽象字段的基类

> ID：12653642
> 
> 赞同：0
> 
> 时间：2012-09-29T14:37:54.077
> 
> 标签：c#, c#-4.0, inheritance, polymorphism, type-conversion

我正在为一个稀有数据库的驱动程序编写一个包装器。具体来说，我正在实现原始查询代码，所以我自然需要尽可能快的速度。这将在大型电子商务解决方案中实施。

这让我远离了动态类型和强制转换。我想直接访问实际的数据类型。

我需要的功能是有一个带有通用字段的基本参数类，以及一系列子类，每个子类都有一个特定类型的字段（每个数据库类型一个，它们是 int、long、double、string、byte[]、object、和列表，加上每种类型的列表）。C# 类型应与数据库类型匹配。

这并不简单，因为在我的实现中，调用代码需要查看基本类型，但基本类型看不到子字段。

这是我到目前为止的代码：

```
private abstract class GlobalQueryParam
{
    public readonly string Low;
    // Val must be correctly typed
    public abstract object Val; // requires casting; don't want, but works
    protected string dbVal = "";        

    public string GetDBVal()
    {
        return this.dbVal;
    }

    public abstract bool SetDBVal(string value);

    public GlobalQueryParam(string low)
    {
        this.Low = low;
    }
}

public class GlobalQueryParamInt : GlobalQueryParam
{
    /// <summary>
    /// Represents the current literal value. Used in traversal actions.
    /// </summary>
    public override int Val;

    public int Parse(string dbVal)
    {
        return (this.Val = int.Parse(dbVal));
    }

    public override bool SetDBVal(string value)
    {
        if (value != "")
        {
            this.dbVal = value;
            return int.TryParse(value, out this.Val);
        }

        return false;
    }

    public GlobalQueryParamInt(string low = "") : base(low) { }
} 
```

在我的实现中，我必须声明一个基类的数组，这会在工作中抛出一个扳手。

我确信有更好的方法来做到这一点。我查看了接口，但它们也需要类型，并且由于基类型数组共享一个公共类型，我无法让泛型工作。

如果我更改上述数组，我会引入其他本质上是循环的复杂性。

实现我正在寻找或尽可能接近它的最有效方法是什么？

**编辑** 实现（不适用于泛型）：

```
 GlobalQueryParam[] trail = new GlobalQueryParam[dataPos+1]; // DOESN'T WORK
    trail[0] = new GlobalQueryParamInt((this.TestParams[0].QueryLow - 1).ToString());
    trail[1] = new GlobalQueryParamInt((this.TestParams[1].QueryLow - 1).ToString());
    trail[2] = new GlobalQueryParamInt((this.TestParams[2].QueryLow - 1).ToString());
    trail[3] = new GlobalQueryParamInt((this.TestParams[3].QueryLow - 1).ToString());
    trail[4] = new GlobalQueryParamInt((this.TestParams[4].QueryLow - 1).ToString());
    trail[5] = new GlobalQueryParamInt((this.TestParams[5].QueryLow - 1).ToString());
    trail[6] = new GlobalQueryParamInt((this.TestParams[6].QueryLow - 1).ToString());
    trail[7] = new GlobalQueryParamInt((this.TestParams[7].QueryLow - 1).ToString()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T14:52:29.883

你想使用泛型

```
public abstract GlobalQueryParam{}

public abstract class GlobalQueryParam<TValue>: GlobalQueryParam where TValue : struct
{
    public readonly TValue Low;
    public TValue Val; 
    protected TValue dbVal = default(TValue);

    public TValue GetDBVal()
    {
        return  dbVal;
    }

    public abstract bool SetDBVal(TValue value);

    public abstract TValue Parse(string dbVal);

    public GlobalQueryParam(TValue low)
    {
        this.Low = low;
    }
}

public class GlobalQueryParamInt : GlobalQueryParam<int>
{

    public int Parse(string dbVal)
    {
        return (this.Val = int.Parse(dbVal));
    }

    public override bool SetDBVal(int value)
    {

        return true;
    }

    public GlobalQueryParamInt(int low = 0) : base(low) { }
} 
```

**编辑**：为此创建一个基类和一个基于此帖子 [泛型类型集合的集合类](https://stackoverflow.com/questions/3215402/collection-of-generic-types)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:18:15.143

使用您需要的方法/属性创建一个接口：

```
public interface IGlobalQueryParam { 

  string ToString();

  . . . 

} 
```

然后使用 damdum answer 中的泛型类，实现接口：

```
private abstract class GlobalQueryParam<TValue> : IGlobalQueryParam where TValue : struct {   
  public readonly TValue Low;   
  public TValue Val;    
  protected TValue dbVal = default(TValue);   

  public TValue GetDBVal()   
  {   
    return  dbVal;   
  }   

  public override string ToString()
  {
    return Val.ToString();
  } // ToString

  . . . implement IGlobalQueryParam . . .

}  

public class GlobalQueryParamInt : GlobalQueryParam<int> {

  . . . 
} 
```

然后创建和使用接口的数组（或列表等）：

```
IGlobalQueryParam[] trail = new IGlobalQueryParam[dataPos+1];
trail[0] = new GlobalQueryParamInt((this.TestParams[0].QueryLow - 1).ToString());    
trail[1] = new GlobalQueryParamInt((this.TestParams[1].QueryLow - 1).ToString());    
trail[2] = new GlobalQueryParamInt((this.TestParams[2].QueryLow - 1).ToString());    
trail[3] = new GlobalQueryParamInt((this.TestParams[3].QueryLow - 1).ToString());    
trail[4] = new GlobalQueryParamInt((this.TestParams[4].QueryLow - 1).ToString());    
trail[5] = new GlobalQueryParamInt((this.TestParams[5].QueryLow - 1).ToString()); 
```

仍然不可能在不装箱的情况下访问每个项目的基础值（即`IGlobalQueryParam`返回属性`object`），但是可以创建接口的方法和属性，在不装箱的情况下对基础值执行所需的操作 - 例如如上例所示，将值转换为字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T01:00:55.713

最后，我恢复到我的原始代码，它将值转换和装箱到对象。泛型没有添加任何内容，因为对象继承实现了所需的类型。删除泛型后，接口什么也没有添加。

# highcharts - 更改 HighCharts 中成交量列（高/低）的颜色

> ID：12653644
> 
> 赞同：7
> 
> 时间：2012-09-29T14:38:10.100
> 
> 标签：highcharts, highstock

我有一个简单的图表，显示烛台下方的交易量列：http: [//jsfiddle.net/T83Xy/](http://jsfiddle.net/T83Xy/)

基本上，我想根据收盘价是否高于开盘价，对列使用黑色和红色。我通过推 Y: data, color: '#000000' 作为参数看到了一些示例。问题是我正在推送日期和卷号。我试图推送 X: date, Y: data, color: '#000000' 但它抛出错误并且没有给我预期的结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T05:08:38.120

首先，如果您有大量积分，您需要将[series.turboThreshold设置为 0。](https://api.highcharts.com/highcharts/plotOptions.series.turboThreshold)这将禁用输入数据格式检查。

然后，要根据蜡烛应用列颜色，我建议您使用这段代码：

```
Highcharts.seriesTypes.column.prototype.pointAttribs = (function(func) {
    return function(point, state) {
      var attribs = func.apply(this, arguments);

      var candleSeries = this.chart.series[0]; // Probably you'll need to change the index
      var candlePoint = candleSeries.points.filter(function(p) { return p.index == point.index; })[0];

      var color = (candlePoint.open < candlePoint.close) ? '#FF0000' : '#000000'; // Replace with your colors
      attribs.fill = state == 'hover' ? Highcharts.Color(color).brighten(0.3).get() : color;

      return attribs;
    };
}(Highcharts.seriesTypes.column.prototype.pointAttribs));
```

请小心，因为此代码会影响当前页面上的所有图表。但是您可以轻松添加一些条件以仅在特定图表上运行它。[这](https://jsfiddle.net/1Lxc4h3f/)是带有上述代码的默认 Highstock 演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-13T06:38:52.970

这对我来说非常有效：

```
$(function () {
jQuery.getJSON('https://www.highcharts.com/samples/data/jsonp.php?filename=aapl-ohlcv.json&callback=?', function (data) {

    // split the data set into ohlc and volume
    var volumeColor = '';
    var ohlc = [],
        volume = [],
        dataLength = data.length,
        // set the allowed units for data grouping
        groupingUnits = [[
            'week',                         // unit name
            [1]                             // allowed multiples
        ], [
            'month',
            [1, 2, 3, 4, 6]
        ]],

        i = 0;

    for (i; i < dataLength; i += 1) {
        ohlc.push([
            data[i][0], // the date
            data[i][1], // open
            data[i][2], // high
            data[i][3], // low
            data[i][4] // close
        ]);
         if (i==0) {
        volumeColor = '#CCCCCC';
         } else {         
            if (data[i][1] >= data[i-1][1]) {
               volumeColor = '#006633';
            } else {
               volumeColor = '#CC0033';
            }
         }

        volume.push({
            x: data[i][0], // the date
            y: data[i][5],
            color: volumeColor
        });
    }

    // create the chart
    $('#container').highcharts('StockChart', {

        rangeSelector: {
            selected: 1
        },

        title: {
            text: 'AAPL Historical'
        },

        yAxis: [{
            labels: {
                align: 'right',
                x: -3
            },
            title: {
                text: 'OHLC'
            },
            height: '60%',
            lineWidth: 2
        }, {
            labels: {
                align: 'right',
                x: -3
            },
            title: {
                text: 'Volume'
            },
            top: '65%',
            height: '35%',
            offset: 0,
            lineWidth: 2
        }],

        series: [{
            type: 'candlestick',
            name: 'AAPL',
            data: ohlc,
            dataGrouping: {
                units: groupingUnits
            }
        }, {
            type: 'column',
            name: 'Volume',
            data: volume,
            yAxis: 1,
            turboThreshold: Number.MAX_VALUE,
            dataGrouping: {
                enabled: false,
                units: groupingUnits
            }
        }]
    });
});
});
```

```
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<div id="container" style="height:400px;min-width:310px"></div>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-16T22:56:42.937

当前（HighCharts 7+）解决方案，不需要覆盖任何方法，是`color`根据当前烛台点的开盘价和收盘价之间的比较简单地设置交易量点的属性：green if `<`, red if `>`,如果相等，则为黄色。

这是一个最小的例子。

```
// Return a color matching the candle by comparing the open (1) and close (4)
function volumeBarColor(point) {
  if (point[1] < point[4])
    return 'green';
  if (point[1] > point[4])
    return 'red';
  return 'yellow';
}

Highcharts.getJSON('https://www.highcharts.com/samples/data/aapl-ohlcv.json', data => {

  // Split the data set into ohlc and volume
  const ohlc = [],
      volume = [];

  for (let i = 0; i < data.length; i += 1) {
    ohlc.push([
      data[i][0], // the date
      data[i][1], // open
      data[i][2], // high
      data[i][3], // low
      data[i][4], // close
    ]);

    volume.push({
      x: data[i][0], // the date
      y: data[i][5], // the volume
      color: volumeBarColor(data[i]),
    });
  }

  // Create the chart
  Highcharts.stockChart('container', {

    title: {
      text: 'AAPL Historical'
    },

    yAxis: [{
      labels: {
        align: 'right',
        x: -3
      },
      height: '60%',
    }, {
      labels: {
        align: 'right',
        x: -3
      },
      top: '65%',
      height: '35%',
      offset: 0,
    }],

    series: [{
      type: 'candlestick',
      name: 'AAPL',
      data: ohlc,
    }, {
      type: 'column',
      name: 'Volume',
      data: volume,
      yAxis: 1,
    }]
  });
});
```

```
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/data.js"></script>

<div id="container"></div>
```

# google-search - 谷歌搜索：在这种情况下如何使用 inurl？

> ID：12653658
> 
> 赞同：0
> 
> 时间：2012-09-29T14:40:02.260
> 
> 标签：google-search

我想使用一个查询从 Google 搜索结果中排除所有包含 "news" 、 "daily" 的链接。

例子：

> site.com/path
> 
> site2.com/news/path
> 
> site3.com/daily/path

我只需要

> site.com/path

我尝试这样做：

> 查询 -inurl：新闻 -inurl：每日
> 
> 查询 -inurl:news 或 -inurl:daily
> 
> 查询 -inurl:news AND -inurl:daily

但没有任何工作。

在这种情况下我应该使用什么查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:19:57.697

您说以下内容不起作用，但对我来说效果很好：

```
query -inurl:news -inurl:daily 
```

你能发布一个具体的例子来说明这不起作用吗？

# php - 带数组的 PHP 数组

> ID：12653661
> 
> 赞同：-3
> 
> 时间：2012-09-29T14:40:31.127
> 
> 标签：php, arrays, tree

我在 PHP 中制作自动数组树有问题。前任。我的数组中有数字：2、3、3，我可以手动制作树。

```
<?
$source_arr = array(2,3,3);

for($x=0; $x<$source_arr[0]; $x++){ // level 0: 2 loops

for ($xx=0; $xx<$source_arr[1]; $xx++) {  // level 1: 3 loops

    for ($xxx=0; $xxx<$source_arr[2]; $xxx++) {  // level 2: 3 loops

        $new[] = "$x$xx$xxx";

   }    
    }
}   

echo "<pre>";
print_r($new);
echo "</pre>";

?> 
```

结果：

```
大批
(
    [0] => 000
    [1] => 001
    [2] => 002
    [3] => 010
    [4] => 011
    [5] => 012
    [6] => 020
    [7] => 021
    [8] => 022
    [9] => 100
    [10] => 101
    [11] => 102
    [12] => 110
    [13] => 111
    [14] => 112
    [15] => 120
    [16] => 121
    [17] => 122
)

```

但我想自动化它，我有不同数量的具有不同值的级别数组，如下所示： 11 个级别：

```
$source_arr = array(8,5,10,12,5,8,12,5,6,10,8); 
```

我想建立自动大树。PHP array_walk 或 array_walk_recursive 是否有可能？我发现了有关构建递归类别树的帖子，但我无法调整这些代码。

编辑：我不想做无穷大数组并实现内存耗尽。我的数组计数永远不会超过 15 个项目，值范围：3-16。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T15:07:39.677

遍历树必须递归地完成。没有选择，因为树的深度是无限的，但你的循环嵌套级别是固定的。您不是在构建树，但您的列表的构建确实是树遍历。您的递归函数必须具有以下参数：

*   当前节点的标识，在这里，我们可以只使用节点的级别和从其父节点构建的前缀字符串；
*   树的每个级别的大小，可以从您的数组 source_arr 列表和已提供的当前级别中检索；
*   正在构建的数组

结果也可以通过 return 和 merge 产生，但不会更简单，效率也会更低。

```
<?php

function build(array &$sizes, array &$result, $prefix, $level)
{
  if ($level == count($sizes)) {
    $result[] = $prefix;
  }
  else {
    for ($i = 0 ; $i < $sizes[$level] ; $i++) {
      build($sizes, $result, $prefix . $i, $level + 1);
    }
  }
}

$sizes = array(8,5,10,12);
$result = array();
build($sizes, $result, '', 0);

echo "<pre>";
print_r($result);
echo "</pre>";

?> 
```

请注意，您请求的树很大，PHP 将在能够打印结果之前耗尽内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T16:44:11.623

这是另一个似乎有效的解决方案。这不是很干净，我知道。但是，嘿！没有递归！;)

```
<?php

function generate(array $a) {
  $multArray = function($mult, $e) {
    return $mult * $e;
  };

  $finalSize = array_reduce($a, $multArray, 1);

  $res = array();
  $aReverse = array_reverse($a);
  for ($i = 0; $i < $finalSize; $i++) {
    $tmpReverseRes = array();
    foreach ($aReverse as $k => $v) {
      $mult = array_reduce(array_slice($aReverse, 0, $k), $multArray, 1);
      $tmpReverseRes[] = (int)($i / $mult) % $v;
    }
    $res[] = join('', array_reverse($tmpReverseRes));
  }

  return $res;
}

$a = array(2, 3, 3);

print_r(generate($a)); 
```

**更新：**

我们也可以用一个类来实现它：

```
<?php
class StrangeGenerator {
  private $a = null;
  private $aReverse = null;
  private $combinationsCount = null;

  public function __construct(array $array) {
    $this->a = $array;
    $this->aReverse = array_reverse($array);
    $this->combinationsCount = array_reduce($array, 'self::multArray', 1);
  }

  public function getCombinationFor($index) {
    $this->checkRange($index);

    $revRes = array();
    foreach ($this->aReverse as $k => $v) {
      $mult = array_reduce(array_slice($this->aReverse, 0, $k), 'self::multArray', 1);
      $revRes[] = (int)($index / $mult) % $v;
    }
    return join('', array_reverse($revRes));
  }

  public function getCombinationsCount() {
    return $this->combinationsCount;
  }

  protected function checkRange($index) {
    if ($index < 0 || $index >= $this->combinationsCount) {
      throw new RangeException('Out of range');
    }
  }

  protected static function multArray($mult, $e) {
    return $mult * $e;
  }
}

$a = array(2, 3, 3);

$g = new StrangeGenerator($a);

$count = $g->getCombinationsCount();

for ($i = 0; $i < $count; $i++) {
  $res = $g->getCombinationFor($i);
  echo "$res\n";
} 
```

顺便说一句，此类不会将所有组合保留在内存中。它们是按需计算的。

# android - 通过服务在android中录制音频

> ID：12653666
> 
> 赞同：1
> 
> 时间：2012-09-29T14:41:00.997
> 
> 标签：android, android-service, audio-recording

是否可以在服务中在后台录制音频，如果可能，请提供提示以及如何停止录制/服务和保存文件。此过程将在接收到开始录制短信和停止录制短信时启动。

# android - 在destroy() android上删除观察者

> ID：12653668
> 
> 赞同：3
> 
> 时间：2012-09-29T14:41:11.613
> 
> 标签：android, observer-pattern, android-annotations

我正在使用 android 注释为 android 开发。我有一个单例可观察对象，我想为其添加活动作为观察者。如下所示：

```
@EActivity(R.layout.myActivity)
public class MyActivity extends SherlockActivity implements Observer { 

    @Bean //has singleton scope
    protected Observerable o;

    @Override
    public void onCreate() {
        o.registerObserver(this);
    }

    @Override
    public void onDestroy() {
        o.unregisterObserver(this);
    }

    //more code 
```

我的问题在于 on destroy 方法。是否会出现android在停止或暂停状态下杀死活动*而不*调用的情况`onDestroy()`？如果是这种情况，我`Observerable`可能会保留对系统不再使用的活动的实时引用，这不好。还是不是这样？如果我的假设是在我的注册观察者列表中保留对我所有活动的弱引用，那么它们可以自动取消注册。这是一个好的解决方案还是不需要？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:11:56.933

操作系统可以在不调用 onDestroy 的情况下终止您的进程，否则您可以依赖 onDestroy 被调用。因此，只要您的 Observable 与活动处于同一进程中，就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T14:57:16.977

根据[Android 文档](http://developer.android.com/reference/android/app/Activity.html)中 Activity 的生命周期，如果必须启动其他应用程序并且系统没有足够的内存，则可能会发生这种情况。

编辑：好吧，在这种情况下，系统似乎仍会调用此方法。我不太确定工作流程了...

# python - 带有 if 条件的列表理解

> ID：12653670
> 
> 赞同：2
> 
> 时间：2012-09-29T14:41:37.377
> 
> 标签：python, optimization, coding-style

下面一行 Python 代码

```
values = ", ".join(["\"%s\"" % x for x in row]) 
```

获取 "row" 中的元素列表以创建逗号分隔的字符串 "values"，同时将每个值放在双引号中，例如："New York"、"5"、""、"3.2"

但是，由于结果是 mysqldump 文件的一部分，因此空字段 ("") 应变为 NULL（不带双引号）。

因此，我想学习如何更改该表达式，以便检查 x 是否为空（“”），在这种情况下，应将 NULL 附加到值字符串。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T14:44:29.747

```
values = ", ".join('"%s"' % x if x else 'NULL' for x in row) 
```

例如：

```
>>> row = ["foo", "", "bar"]
>>> values = ", ".join('"%s"' % x if x else 'NULL' for x in row)
>>> values
'"foo", NULL, "bar"' 
```

感谢 DSM 指出，将列表推导式更改为[生成器表达式](http://docs.python.org/reference/expressions.html#generator-expressions)当然更好——这使得它更快，因为不再需要构造一个随后将立即丢弃的列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T14:45:53.453

```
values = ", ".join(["NULL" if x == "" else "\"%s\"" % x for x in row]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:22:55.837

为了使它更健壮一点，我将利用该`csv`模块来处理嵌入式字段和字符串分隔符......（只是一个临时示例）

```
from StringIO import StringIO
import csv

csvrec = StringIO()
csvout = csv.writer(csvrec, quoting=csv.QUOTE_ALL)
items = [1, 'hello, there, how are you?', 3.2, 'it\'s a "cat" I say!', '', '']
csvout.writerow([col or '\t' for col in items]) # maybe col != '' ?
print csvrec.getvalue().replace('"\t"', 'NULL').strip()
# "1","hello, there, how are you?","3.2","it's a ""cat"" I say!",NULL,NULL 
```

# objective-c - 试图将 XML 元素 NSMutableString 添加到 NSMutableArray .. 不工作

> ID：12653671
> 
> 赞同：0
> 
> 时间：2012-09-29T14:41:37.353
> 
> 标签：objective-c, ios, xcode, arrays, nsmutablearray

我正在尝试将特定名称的元素添加到 NSMutableArray，这是我从 XML 文件中获取的。我追求元素。这里的第一个 NSLog 正确输出：

```
Found an element named: image with a value of: http://media.giantbomb.com/uploads/1/10353/2320941-untitledb_tiny.jpg 
```

第二个 NSLog 正确输出：

```
I'm about to try adding a game called Bayonetta 2 to the array 
```

第三个 NSLog 总是告诉我数组中有零个条目。我没有收到任何错误`[_listOfGameNames addObject: element];`，所以我不知道为什么它没有将它添加到数组中。

对我有什么想法吗？这是完整的代码：

```
- (void) searchWithString: (NSString *)string {
    NSString *searchString = [NSString stringWithFormat: @"http://api.giantbomb.com/search/?api_key=MYKEY12345BLAHBLAH&resources=game&format=xml&query=%@", string];
    NSURL *searchURL = [NSURL URLWithString: searchString];
    parser = [[NSXMLParser alloc] initWithContentsOfURL: searchURL];
    [parser setDelegate:self];
    [parser parse];
    // NSLog(@"XMLParser just reached the end of its initWithString method. The string was %@",  searchURL);
    NSLog(@"There are %u elements in the List Of Game Names array", [_listOfGameNames count]);
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict {
    element = [NSMutableString string];
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {
    NSLog(@"Found an element named: %@ with a value of: %@", elementName, element);
    if ([elementName isEqualToString:@"name"]) {
        NSLog(@"I'm about to try adding a game called %@ to the array", element);
        [_listOfGameNames addObject: element];
        NSLog(@"I added an element to the array, making a total of %u", [_listOfGameNames count]);
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    if(element == nil) element = [[NSMutableString alloc] init];
    [element appendString:string];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:11:32.013

答：没有初始化可变数组！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:37:54.893

您需要初始化数组。你可以实现Getter。

```
-(NSMutableArray *) listOfGameNames
{
    if(!_listOfGameNames){
        _listOfGameNames = [[NSMutableArray alloc] init];
    }

    return _listOfGameNames;
} 
```

# c# - 当我拥有 AppFabric 中的缓存锁时如何增加超时

> ID：12653672
> 
> 赞同：3
> 
> 时间：2012-09-29T14:41:58.163
> 
> 标签：c#, appfabric, appfabric-cache

现在我正在尝试锁定 AppFabric 缓存中的一个项目，并且我想持有锁定直到我的工作完成，所以我需要告诉 AppFabric 在我已经拥有锁定时不要让我的锁定超时。我的解决方案是定期锁定同一个项目，即使我已经拥有了锁。

```
while (true)
{
    try
    {
        String value = cacheClient.GetAndLock("key1", TimeSpan.FromSeconds(10), out lockHandle, true) as String;
        Console.WriteLine(value);
    }
    catch (DataCacheException e)
    {
        switch (e.ErrorCode)
        {
            case DataCacheErrorCode.KeyDoesNotExist:
                Console.WriteLine("Key not found");
                break;
            case DataCacheErrorCode.ObjectLocked:
                Console.WriteLine("Object Locked");
                break;
            default:
                Console.WriteLine("Others " + e.ErrorCode);
                break;
        }
    }
    Thread.Sleep(1000);
} 
```

然而有一个问题。代码抛出 DataCacheException 并且 ErrorCode 是 ObjectLocked。这使我无法知道我是否还有锁，因为如果锁由另一个客户端拥有，则异常与当前的相同。有没有人有解决问题的方法？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T10:09:42.983

在悲观并发模型中，客户端显式锁定对象以执行操作。当对象被锁定时，锁定句柄作为输出参数返回，并且是解锁对象所必需的。每个锁定的对象只有一个唯一的句柄。

**缓存中的锁定对象仍然可以使用Put**方法被任何缓存客户端替换，并且您可以使用**Get**获取项目。启用缓存的应用程序*负责*始终将**PutAndUnlock**用于使用悲观并发模型的项目。

因此，在您的情况下，如果您想增加锁定对象的锁定超时，您可以简单地再次放置具有相同超时的相同对象（由同一个客户端，“储物柜”）

# javascript - 使用 jQuery 定位动态 HTML

> ID：12653673
> 
> 赞同：3
> 
> 时间：2012-09-29T14:42:03.007
> 
> 标签：javascript, jquery, wordpress, dynamic, filter

我正在开发一个 WordPress 主题，并使用 JS 来根据切换的类别项目实时过滤帖子结果。类别链接是刚刚创建的`wp_list_categories();`，帖子列表是用`WP_Query();`

目前我在 JS 中设置了唯一的帖子 ID 来完成这项工作，但要让其他人使用主题，我不希望他们每次添加新类别时都必须编辑 JS。基本上，无论添加多少类别，我都希望拥有 JS 功能和过滤帖子。

我当前的标记是这样的：

```
<section id="sidebar">
    <ul>
        <li class="cat-item cat-item-1"></li>
        <li class="cat-item cat-item-2"></li>
        <li class="cat-item cat-item-3"></li>
    </ul>
</section>

<section id="postlist">
    <div class="1post apost"></div>
    <div class="2post apost"></div>
    <div class="3post apost"></div>
</section> 
```

我的JS如下：

```
$(".cat-item-1").click( function() {
    $('.1post').toggle('slow');
});

$(".cat-item-2").click( function() {
    $('.2post').toggle('slow');
});

$(".cat-item-3").click( function() {
    $('.3post').toggle('slow');
}); 
```

当我每次为每个类别和帖子 ID 明确键入它时，这工作正常，但我试图完成类似的事情：

```
$(".cat-item-" + (dynamic cat ID)).click( function() {
    $("." + (dynamic post ID that matches cat ID) + "post").toggle('slow');
}); 
```

这是可能吗？当谈到 JS 时，我不是世界上最有经验的人，所以如果解决方案让我眼前一亮，我深表歉意！我在这里添加了这个作为小提琴：http: [//jsfiddle.net/davemcnally/5QZcw/](http://jsfiddle.net/davemcnally/5QZcw/) - 提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T14:53:42.650

看看我的解决方案：http: [//jsfiddle.net/EP96x/](http://jsfiddle.net/EP96x/)

```
$('.cat-item').click(function () {
    $('.apost').eq($(this).index()).toggle();
}); 
```

它计算`cat-item`您单击的具有类的元素（第一个、第二个等...），然后使用该类切换相应的元素`apost`。

编辑：正如评论中指出的那样，元素出现故障存在一定的风险。如果是这种情况，则需要使用正则表达式以将链接与正确的元素匹配：

[http://jsfiddle.net/HKkq5/](http://jsfiddle.net/HKkq5/)

```
$('.cat-item').click(function () {
    var num = $(this).attr('class').match(/cat-item-(\d+)/)[1];
    $('.' + num + 'post').toggle();
}); 
```

# python-3.x - 检测模式中的位置并移位

> ID：12653675
> 
> 赞同：0
> 
> 时间：2012-09-29T14:42:26.957
> 
> 标签：python-3.x

简单地说，当用户输入为 6 时，我希望使用 for 或 while 循环实现以下目标。

```
z....z
.z..z.
..zz..
..zz..
.z..z.
z....z

zz....
..z..z
...zz.
...zz.
..z..z
zz....

.zz...
z..z..
....zz
....zz
z..z..
.zz... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T16:12:07.530

```
#!/usr/bin/env python3

def create_pattern(pattern_size):
    # Create our list that'll be storing this info
    pattern = []

    # first_x and last_x are "memory" so we know where to place the Xes.
    first_x = 0
    last_x = pattern_size - 1

    # Next, create an inner list for each line
    for level in range(0, pattern_size):

        # start our new line
        pattern.append([])

        # Now place the Xes where they belong
        for x in range(0, pattern_size):
            if x == first_x or x == last_x:
                pattern[level].append("x")
            else:
                pattern[level].append(".")

        # Move the Xes to the new positions
        first_x += 1
        last_x -= 1
    return pattern

# see 'help(list.pop)' and 'help(list.insert)' for more details
def right_shift(line):
    buf = line.pop()
    line.insert(0, buf)
    return line

# This function just acts upon each line of a pattern
def shift_pattern(pattern):
    for line in range(0, len(pattern)):
        line = right_shift(pattern[line])
    return pattern

if __name__ == "__main__":
    original = create_pattern(7)
    for j in range(len(original)):
        if j != 0:
            original = shift_pattern(original)
        for i in range(len(original)):
            print("".join(original[i]))

        print() 
```

这个问题很巧妙。你需要的是右移。所以我所做的是使用列表将模式分解为行和字符。可能有一种更有效的方法来做到这一点，但它似乎是最直接的方法，因为 Python 字符串是不可变的，而列表是可变的。

`create_pattern()`只需设置我们的“输入模式”，它会`print()`在第一次编辑后被操纵。

对我来说最有趣（也是最重要）的部分是`right_shift()`. 我的第一次尝试是在程序上设置列表索引。该方法成功了一半，但容易出错。然后我想起来了`pop()`。快速`help(list)`向我透露，我可以简单地从列表中弹出最后一个元素并将其放在开头以“伪造”右移。结果？

```
x.....x
.x...x.
..x.x..
...x...
..x.x..
.x...x.
x.....x

xx.....
..x...x
...x.x.
....x..
...x.x.
..x...x
xx.....

.xx....
x..x...
....x.x
.....x.
....x.x
x..x...
.xx....

..xx...
.x..x..
x....x.
......x
x....x.
.x..x..
..xx...

...xx..
..x..x.
.x....x
x......
.x....x
..x..x.
...xx..

....xx.
...x..x
x.x....
.x.....
x.x....
...x..x
....xx.

.....xx
x...x..
.x.x...
..x....
.x.x...
x...x..
.....xx 
```

这是一个有趣而有趣的问题。享受。:)

注意：将 7 in 更改`create_pattern()`为另一个数字以产生其他模式。

# mysql - Concat 中的 Group_Concat 不能使用 NULL 值

> ID：12653678
> 
> 赞同：8
> 
> 时间：2012-09-29T14:43:10.797
> 
> 标签：mysql, group-concat

我有一张桌子

```
CREATE TABLE IF NOT EXISTS `dept` (
  `did` int(11) NOT NULL,
  `dname` varchar(50) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

INSERT INTO `dept` (`did`, `dname`) VALUES
(1, 'Hi'),
(2, NULL),
(3, 'Hello'); 
```

然后我有一个查询

```
select group_concat(concat(did,"','",dname) separator '),(') as Result from dept 
```

它产生的结果为`1','Hi'),('3','Hello`

**问题：**我怎样才能从上面的查询中得到结果`1','Hi'),('2','NULL'),('3','Hello`

它缺少具有 NULL 值的行，但我需要获取所有

[**问题的 SQL Fiddle 演示链接**](http://sqlfiddle.com/#!2/158d5/1)

**更新：**如果我有多个列或所有列允许 NULL，是否有某种方法可以一次性应用 COALESCE 或者必须在每个列上单独应用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T14:45:20.673

试试这个，使用`COALESCE`

```
.., COALESCE(dname, 'NULL'),.. 
```

使其`NULL`字符串可见。[**SQLFIDDLE 演示**](http://sqlfiddle.com/#!2/0d82b/4)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T14:45:18.087

从[MySQL 聚合函数文档](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)：

> 除非另有说明，否则组函数会忽略 NULL 值。

用于[`COALESCE()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)用字符串替换空值，因为它们会被聚合函数消除。例如`COALESCE(dbname, 'NULL')`将返回*字符串* `NULL`if `dbname IS NULL`。它的目的是返回你给它的参数的第一个*非空值*，因此可以返回一个默认值。

```
SELECT
  GROUP_CONCAT(CONCAT(did,"','", COALESCE(dname, 'NULL')) SEPARATOR "'),('") AS Result
FROM dept 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T14:55:21.330

希望以下查询能达到您的目的

```
SELECT GROUP_CONCAT(
IF(dname IS NOT NULL, CONCAT(did,"','",dname), CONCAT(did,"','NULL")) 
SEPARATOR '),(') AS Result FROM dept 
```

# c# - 检索到无线适配器的连接时间

> ID：12653681
> 
> 赞同：2
> 
> 时间：2012-09-29T14:43:37.860
> 
> 标签：c#, time, wlanapi

我写是因为我在互联网上找不到任何答案。我正在用 C# 在 WLAN 上编写一个项目（使用托管 C++）。考虑连接到网络的给定接口（网卡），有没有办法知道接口连接到网络多长时间？

换句话说，我想知道您在 Windows 7 中的连接信息中看到的时间（trayicon -> 打开网络和共享中心）。

我希望我很清楚，我为我糟糕的英语道歉。

[http://imageshack.us/photo/my-images/39/immaginenrz.png/](http://imageshack.us/photo/my-images/39/immaginenrz.png/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:59:12.070

可能是您正在寻找 Windows 的[getiftable()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365943%28v=vs.85%29.aspx)函数。它是一个 winapi 函数，提供与特定网络接口相关的所有信息

[这](http://www.geekpage.jp/en/programming/iphlpapi/interface-info.php)是一个很好的例子

[这](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366836%28v=vs.85%29.aspx)是整个结构的解释

根据msdn

dwLastChange

```
Type: DWORD

The length of time, in hundredths of seconds (10^-2 sec), starting from the last computer restart, when the interface entered its current operational state. 
```

连接后，它会给你时间，因为它是如此 - 即处于连接状态。

这是这个函数在c#中的声明

```
public static extern uint GetIfTable(IntPtr pIfTable, ref uint pdwSize, bool bOrder);

Declare Function GetIfTable Lib "iphlpapi.dll" (TODO) As TODO

        IPHelperTraslation.GetIfTable(IntPtr.Zero, ref size, false);

        IPHelperTraslation.GetIfTable(buf, ref size, false); 
```

您可以使用[pinvoke.net](http://www.pinvoke.net/)获得有关声明的进一步帮助。

.Net 框架中似乎有一种简单的方法，但不如预期

[http://msdn.microsoft.com/en-us/library/system.net.networkinformation.operationalstatus.aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.operationalstatus.aspx)

查看他们实施网络状态检测的方式。我的假设是，您必须在申请中记录自上次状态更改以来的时间。

我还实际测试了 getifrow 函数，令我失望的是，它在 Win7 上总是返回零，不知道其他平台。

# jquery - 使用 JQuery 在 HTML 页面中访问 Java REST WebServices

> ID：12653683
> 
> 赞同：0
> 
> 时间：2012-09-29T14:43:51.267
> 
> 标签：jquery, ajax, json, web-services, rest

我对 RESTFul 网络服务有一个大问题。

这是我的架构：

*   服务器端：我使用 EJB3 + RESTFul 网络服务。
*   客户端：我使用 bootstrap twitter + JQuery 1.8 和 Ajax 方法来访问我的 web 服务。

我在服务器端创建了一个 JSP 来测试我的 web 服务，然后再将其提交给客户端开发人员。当我使用这个 JSP 时，我所有的 web 服务都运行良好！然后我尝试从 html 页面（远程）访问这些网络服务，但我的`$.ajax`请求不起作用。

我写了很多关于这个的帖子，有些人谈到`callback=?`在 URL 末尾添加 JSONP 或使用`dataType='jsonp'`

我能做的最好的事情是在我的浏览器资源中看到该对象，但只调用错误回调。我有一个错误，例如：`ParserError : Error: jQuery18207595316471997648_1348928429983 was not called.`

当我尝试使用`dataType='text json'`（如某些帖子中所述）时，没有任何反应，但仍然调用错误回调！

问题是，当我将 GET url 直接放在我的网络浏览器中时，我可以看到相应 JSON 对象的字符串，所以它似乎不是来自我的网络服务。

这是此 JSON 字符串的示例：

```
{"member1":[{"email":"romain@gmail.com","firstname":"Romain","idMember":"4","lastname":"Dev","login":"romain","password":"5026bc63b5418ffdb54f238db245ec01"},{"email":"productowner@gmail.com","firstname":"Product","idMember":"7","lastname":"Owner","login":"prodowner","password":"f5bf48aa40cad7891eb709fcf1fde128"}]} 
```

这是我的 ajax 请求的示例：

```
$.ajax({
    url:'http://localhost:8080/myresource/all',
    type:'GET',     
    success: function(reponse) {        
        renderList(reponse);
    },  
    error:function (xhr, status, error){        
        alert('Error :'+xhr.responseText+' ('+status+' - '+error+')');  
    },  
    dataType: 'json'

  }); 
```

我使用 Glassfish 服务器 3.1.2，我能看到的唯一日志是：

```
INFO: Couldn't find JAX-B element for class javax.ws.rs.core.Response 
```

但是为什么它会在我的 JSP 中而不是在我的 HTML 页面中工作？

我真的被困住了，我真的需要你的帮助！:)

非常感谢您提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:52:17.183

你可以试试这个功能：

```
function sendRequest(success_callback,failure_callback,data,ws_url,asynchronous){
$.ajax({ 
    async: asynchronous,
    type: "GET",
    crossDomain: true,//if cross domain req 
    dataType: "json",
    Accept : "application/json",
    contentType: "application/json",
    url:"url",
    data:  data,
    success:success_callback,
    error: failure_callback
}); 
```

}

```
function success_callback(msg){ 
```

}

```
function failure_callback(msg){ 
```

}

# android - 在 Activity 及其 Fragment 中创建 ActionItems

> ID：12653687
> 
> 赞同：0
> 
> 时间：2012-09-29T14:45:02.220
> 
> 标签：android, actionbarsherlock

我的 Android 应用程序有一个 SherlockFragmentActivity，其中包含一个 ViewPager 和三个 SherlockListFragment。知道我想在 ActionBar 中显示不同的 ActionItem。例如，在所有三个 Fragment 上都有一个 SettingsItem，在每个 Fragment 上都有一个独特的 ActionItem，例如不同的排序类型。现在我在我的片段中使用这段代码：

```
@Override
public void onCreateOptionsMenu( Menu menu, MenuInflater inflater )
{
    super.onCreateOptionsMenu( menu, inflater );

    inflater.inflate( R.menu.sort_menu, menu );
} 
```

我的活动中的这段代码：

```
@Override
public boolean onCreateOptionsMenu( Menu menu )
{       
    menu.add( Menu.NONE, PREFERENCES_ID, Menu.NONE, getString( R.string.menu_preferences ) )
        .setIcon( R.drawable.ic_menu_settings_dark )
        .setShowAsAction( MenuItem.SHOW_AS_ACTION_ALWAYS );

    return super.onCreateOptionsMenu( menu );
} 
```

问题是，如果我启动我的应用程序，第一个选项卡上不会出现 ActionItems。如果我滑动到另一个选项卡，然后再次返回 ActionItems 出现。有时我只看到一个 ActionItem，例如由父 Activity 创建的设置项。知道任何人都有一个很好的解决方案，可以在每个选项卡上显示一些 ActionItems，并为每个选项卡显示一些独特的 ActionItems。我不想将代码复制到每个选项卡。

**编辑** 选项卡的位置并不重要。在第一个应用程序启动时，我在实际选项卡上看不到 ActionItems。

# extjs - 如何使用 Compass/Saas 在 Extjs 中自定义工具栏按钮？

> ID：12653692
> 
> 赞同：4
> 
> 时间：2012-09-29T14:45:43.323
> 
> 标签：extjs, sass, compass-sass

我想使用 Compass/Sass 在 Extjs 中自定义工具栏按钮主题，以消除渐变效果。

```
@include extjs-button-ui(
        'my_button',

        $background-gradient:null,
        $background-gradient-over:null,
        $background-gradient-focus:null,
        $background-gradient-pressed:null,
        $background-gradient-disabled: null 
); 
```

但它返回指南针编译错误：

```
WARNING: @theme-background-image: Theme image not found: ../images/btn/btn-topbar_button-corners.gif
         on line 18 of /Users/user/Documents/workspace/sihalon/war/extjs/resources/themes/stylesheets/ext4/default/mixins/_theme-background-image.scss

WARNING: @theme-background-image: Theme image not found: ../images/btn/btn-topbar_button-sides.gif
         on line 18 of /Users/user/Documents/workspace/sihalon/war/extjs/resources/themes/stylesheets/ext4/default/mixins/_theme-background-image.scss

    error my-ext-theme.scss (Line 693 of _button.scss: Invalid null operation: "null plus 4px".)
overwrite ../css/my-ext-theme.css 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T07:30:32.980

Shuold 使用 none 表示没有渐变；

例如：

```
@include extjs-button-ui(
        'my_button',

        $background-gradient:none,
        $background-gradient-over:none,
        $background-gradient-focus:none,
        $background-gradient-pressed:none,
        $background-gradient-disabled: none
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T22:34:15.057

你必须把

```
$icon-size:16px, 
```

例如：

```
@include extjs-button-ui(
'yellow',
$background-color:yellow,
$icon-size:16px,
$font-size:18px
); 
```

# layout - ExtJS 4 中的自定义溢出处理程序实现

> ID：12653701
> 
> 赞同：6
> 
> 时间：2012-09-29T14:47:26.797
> 
> 标签：layout, extjs, extjs4, extjs4.1

我有两个面板`toolbars`。如何实现使用 as 的自定义类`overflowHandler`，它将在第一个工具栏溢出时将组件移动到第二个工具栏？

我尝试使用 的代码`Ext.layout.container.boxOverflow.Menu`，但我的第二个工具栏只是隐藏了。

这是我的代码，它与分布式的`toolbar overflow`示例混合在一起。`ExtJS 4`

```
Ext.require(['Ext.window.Window', 'Ext.toolbar.Toolbar', 'Ext.menu.ColorPicker', 'Ext.form.field.Date']);
Ext.onReady(function(){

    /**
     * Override for implementing tbar2 
     */
    Ext.override(Ext.panel.Panel, {
        bridgeToolbars : function () {
            var toolbar;
            this.callParent(arguments);
            if (this.tbar2) {
                if (Ext.isArray(this.tbar2)) {
                    toolbar = {
                        xtype : 'toolbar',
                        items : this.tbar2
                    };
                }
                else if (!toolbar.xtype) {
                    toolbar.xtype = 'toolbar';
                }
                toolbar.dock = 'top';
                toolbar.isTbar2 = true;
                this.dockedItems = this.dockedItems.concat(toolbar);
                this.tbar2 = null;
            }
        },
        onRender       : function () {
            this.callParent(arguments);
            var topBars = this.getDockedItems('toolbar[dock="top"]'),
                i,
                len;
            for (i = 0, len = topBars.length; i < len; i++) {
                if (topBars[i].isTbar2) {
                    this.tbar2 = topBars[i];
                    break;
                }
            }
        },
        /**
         * Lazy creates new toolbar and returns it
         * @param {Ext.panel.Panel} panel
         * @param {String} position
         * @return {Ext.toolbar.Toolbar}
         */
        getDynamicTBar : function (position) {
            var panel = this,
                params,
                tb;
            position = position || 'top';
            if (position === 'tbar2') {
                tb = panel.tbar2;
                params = {dock : 'top', isTbar2 : true};
            }
            else {
                tb = panel.getDockedItems('toolbar[dock="' + position + '"]');
                params = {dock : position};
                if (tb.length > 0) {
                    tb = tb[0];
                }
            }
            if (!tb) {
                console.log('created tb at ' + position);
                tb = Ext.create('Ext.toolbar.Toolbar', params);
                panel.addDocked(tb);
            }
            return tb;
        }
    });

    Ext.define('Ext.layout.container.boxOverflow.TBar2', {
        extend : 'Ext.layout.container.boxOverflow.None',

        constructor : function () {
            this.tbar2Items = [];
            return this.callParent(arguments);
        },

        beginLayout : function (ownerContext) {
            this.callParent(arguments);
            this.clearOverflow(ownerContext);
        },

        beginLayoutCycle : function (ownerContext, firstCycle) {
            this.callParent(arguments);
            if (!firstCycle) {
                this.clearOverflow(ownerContext);
                this.layout.cacheChildItems(ownerContext);
            }
        },

        getOverflowCls : function () {
            return Ext.baseCSSPrefix + this.layout.direction + '-box-overflow-body';
        },

        _asLayoutRoot : { isRoot : true },

        clearOverflow : function () {
            if (this.tbar2) {
                this.tbar2.suspendLayouts();
                this.tbar2.hide();
                this.tbar2.resumeLayouts(this._asLayoutRoot);
            }
            this.tbar2Items.length = 0;
        },

        handleOverflow : function (ownerContext) {

            var me = this,
                layout = me.layout,
                owner = layout.owner,
                names = layout.getNames(),
                startProp = names.x,
                sizeProp = names.width,
                plan = ownerContext.state.boxPlan,
                available = plan.targetSize[sizeProp],
                childItems = ownerContext.childItems,
                len = childItems.length,
                childContext,
                comp, i, props,
                tbarOwner = owner.ownerCt;
            owner.suspendLayouts();
            // Hide all items which are off the end, and store them to allow them to be restored
            // before each layout operation.
            me.tbar2Items.length = 0;
            for (i = 0; i < len; i++) {
                childContext = childItems[i];
                props = childContext.props;
                if (props[startProp] + props[sizeProp] > available) {
                    comp = childContext.target;
                    me.tbar2Items.push(comp);
                    owner.remove(comp, false);
                }
            }
            owner.resumeLayouts();
            if (!me.tbar2 && (tbarOwner instanceof Ext.panel.Panel)) {
                me.tbar2 = tbarOwner.getDynamicTBar('tbar2');
            }
            me.tbar2.suspendLayouts();
            me.tbar2.show();

            Ext.each(me.tbar2Items, function(item, index) {
                me.tbar2.add(item);
            });
            me.tbar2.resumeLayouts(me._asLayoutRoot);
        }

    });

    var handleAction = function(action){
        Ext.example.msg('<b>Action</b>', 'You clicked "' + action + '"');
    };

    var colorMenu = Ext.create('Ext.menu.ColorPicker', {
        handler: function(cm, color){
            Ext.example.msg('Color Selected', '<span style="color:#' + color + ';">You choose {0}.</span>', color);
        }
    });

    var showDate = function(d, value) {
        Ext.example.msg('<b>Action date</b>', 'You picked ' + Ext.Date.format(value, d.format));
    };

    var fromPicker = false;

    Ext.create('Ext.window.Window', {
        title: 'Standard',
        closable: false,
        height:250,
        width: 500,
        bodyStyle: 'padding:10px',
        contentEl: 'content',
        autoScroll: true,
        tbar: Ext.create('Ext.toolbar.Toolbar', {
            layout: {
                overflowHandler: 'TBar2'
            },
            items: [{
                xtype:'splitbutton',
                text: 'Menu Button',
                iconCls: 'add16',
                handler: Ext.Function.pass(handleAction, 'Menu Button'),
                menu: [{text: 'Menu Item 1', handler: Ext.Function.pass(handleAction, 'Menu Item 1')}]
            },'-',{
                xtype:'splitbutton',
                text: 'Cut',
                iconCls: 'add16',
                handler: Ext.Function.pass(handleAction, 'Cut'),
                menu: [{text: 'Cut menu', handler: Ext.Function.pass(handleAction, 'Cut menu')}]
            },{
                text: 'Copy',
                iconCls: 'add16',
                handler: Ext.Function.pass(handleAction, 'Copy')
            },{
                text: 'Paste',
                iconCls: 'add16',
                menu: [{text: 'Paste menu', handler: Ext.Function.pass(handleAction, 'Paste menu')}]
            },'-',{
                text: 'Format',
                iconCls: 'add16',
                handler: Ext.Function.pass(handleAction, 'Format')
            },'->', {
                fieldLabel: 'Action',
                labelWidth: 70,
                width: 180,
                xtype: 'datefield',
                labelSeparator: '',
                enableKeyEvents: true,
                listeners: {
                    expand: function(){
                        fromPicker = true;
                    },
                    collapse: function(){
                        fromPicker = false;  
                    },
                    change: function(d, newVal, oldVal) {
                        if (fromPicker || !d.isVisible()) {
                            showDate(d, newVal);
                        }
                    },
                    keypress: {
                        buffer: 500,
                        fn: function(field){
                            var value = field.getValue();
                            if (value !== null && field.isValid()) {
                                showDate(field, value);
                            }
                        }
                    }
                }
            }, {
                text: 'Sell',
                iconCls: 'money-down',
                enableToggle: true,
                toggleHandler: function(button, pressed) {
                    Ext.example.msg('<b>Action</b>', 'Right ToggleButton ' + (pressed ? 'Buy' : 'Sell'));
                    button.setText(pressed ? 'Buy' : 'Sell')
                    button.setIconCls(pressed ? 'money-up' : 'money-down')
                }
            }, {
                text: 'Choose a Color',
                menu: colorMenu // <-- submenu by reference
            }]
        })
    }).show();
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T07:24:46.373

我们需要为工具栏布局实现overflowHandler，它会添加第二个工具栏，并在因为工具栏容器的宽度不够而无法显示时将组件从第一个工具栏包装到第二个工具栏。首先，我们需要重写 Ext.panel.Panel：

```
Ext4.override(Ext4.panel.Panel, {
    bridgeToolbars: function () {
        var toolbar;
        this.callParent(arguments);
        if (this.tbar2) {
            if (Ext4.isArray(this.tbar2)) {
                toolbar = {
                    xtype: 'toolbar',
                    items: this.tbar2
                };
            } else if (!toolbar.xtype) {
                toolbar.xtype = 'toolbar';
            }
            toolbar.dock = 'top';
            toolbar.isTbar2 = true;
            this.dockedItems = this.dockedItems.concat(toolbar);
            this.tbar2 = null;
        }
    },
    onRender: function () {
        this.callParent(arguments);
        var topBars = this.getDockedItems('toolbar[dock="top"]'),
            i,
            len;
        for (i = 0, len = topBars.length; i < len; i++) {
            if (topBars[i].isTbar2) {
                this.tbar2 = topBars[i];
                break;
            }
        }
    },
    /**
     * Creates, if not exists, and returns toolbar at passed position
     * @param {Ext.panel.Panel} panel
     * @param {String} position
     * @return {Ext.toolbar.Toolbar}
     */
    getDynamicTBar: function (position) {
        var panel = this,
            params,
            tb;
        position = position || 'top';
        if (position === 'tbar2') {
            tb = panel.tbar2;
            params = {
                dock: 'top',
                isTbar2: true,
                layout: {
                    overflowHandler: 'Scroller'
                }
            };
        } else {
            tb = panel.getDockedItems('toolbar[dock="' + position + '"]');
            params = {
                dock: position
            };
            if (tb.length > 0) {
                tb = tb[0];
            }
        }
        if (!tb) {
            tb = Ext4.create('Ext4.toolbar.Toolbar', params);
            panel.addDocked(tb);
            if (position === 'tbar2') {
                panel.tbar2 = tb;
            }
        }
        return tb;
    }
}); 
```

接下来，我们需要创建 Ext4.layout.container.boxOverflow.TBar2 类（它的名字很长，因为 ExtJS 在硬编码的 Ext4.layout.container.boxOverflow 命名空间中搜索 handleOverflow（它是 String 的实例））。

```
/**
 * @class Ext4.layout.container.boxOverflow.TBar2
 * Class for using as overflowHandler
 * @extends Ext.layout.container.boxOverflow.None
 */
Ext4.define('Ext4.layout.container.boxOverflow.TBar2', {
    extend: 'Ext4.layout.container.boxOverflow.None',

    /**
     * @private
     * @property {Boolean} initialized
     */
    initialized: false,

    constructor: function () {
        /**
         * @private
         * @property {Array} tbar2Items
         * List of moved components
         */
        this.tbar2Items = [];
        return this.callParent(arguments);
    },

    beginLayout: function (ownerContext) {
        if (!this.initialized) {
            this.layout.owner.ownerCt.on('afterlayout', this.createTBar2, this);
            this.initialized = true;
        }
        this.callParent(arguments);
        this.clearOverflow(ownerContext);
    },

    beginLayoutCycle: function (ownerContext, firstCycle) {
        this.callParent(arguments);
        if (!firstCycle) {
            this.clearOverflow(ownerContext);
            this.layout.cacheChildItems(ownerContext);
        }
    },

    getOverflowCls: function () {
        return Ext4.baseCSSPrefix + this.layout.direction + '-box-overflow-body';
    },

    /**
     * @private
     * @property {Object} _asLayoutRoot
     */
    _asLayoutRoot: {
        isRoot: true
    },

    clearOverflow: function () {
        // If afterlayout is not processing and tbar2 already created,
        // we can to move components from tbar2 to first toolbar, because now
        // there isn't any overflow
        if (!this.processing && this.tbar2) {
            this.tbar2.items.each(function (item) {
                this.tbar1.add(item);
                // change ui from saved property, or CSS will be incorrect
                item.ui = item.origUI;
            }, this);
            this.tbar2.removeAll(false);
            this.tbar2.hide();
        }
        this.tbar2Items.length = 0;
    },

    /**
     * @private
     * Creates tbar2 and does other routines
     */
    createTBar2: function () {
        // if afterlayout event is still processing,
        // or we don't need to handle toolbar overflow, just return from function
        if (this.processing || !this.doTbar2) {
            return;
        }
        this.processing = true;
        this.doTbar2 = false;
        var me = this,
            ownerContext = this.mOwnerContext,
            layout = me.layout,
            owner = layout.owner,
            names = layout.getNames(),
            startProp = names.x,
            sizeProp = names.width,
            plan = ownerContext.state.boxPlan,
            available = plan.targetSize[sizeProp],
            childItems = ownerContext.childItems,
            len = childItems.length,
            childContext,
            comp, i, props,
            tbarOwner = owner.ownerCt;

        me.tbar1 = owner;
        // save components which will be moved
        owner.suspendLayouts();
        me.tbar2Items.length = 0;
        for (i = 0; i < len; i++) {
            childContext = childItems[i];
            props = childContext.props;
            if (props[startProp] + props[sizeProp] > available) {
                comp = childContext.target;
                me.tbar2Items.push(comp);
                // save original ui property
                comp.origUI = comp.ui;
                owner.remove(comp, false);
            }
        }
        owner.resumeLayouts();

        // add tbar2 to the layout cycle (you can see very similar code in clearOverflow
        // method of Ext.layout.container.boxOverflow.Menu)
        tbarOwner.suspendLayouts();
        me.tbar2 = tbarOwner.getDynamicTBar('tbar2');
        me.tbar2.show();
        // moving components
        Ext4.each(me.tbar2Items, function (item, index) {
            me.tbar2.insert(index, item);
            item.ui = item.origUI;
        });
        tbarOwner.resumeLayouts(this._asLayoutRoot);
        this.processing = false;
    },

    handleOverflow: function (ownerContext) {
        // set flag and store context for later using
        this.doTbar2 = true;
        this.mOwnerContext = ownerContext;
    }

}); 
```

请注意我使用 ExtJS 4 引导（因为在我的网络应用程序中也有 ExtJD 2.3），所以在你的代码中你可能必须使用`Ext.`而不是`Ext4.`

# java - 要使用反射还是面向方面的编程？

> ID：12653703
> 
> 赞同：3
> 
> 时间：2012-09-29T14:47:55.580
> 
> 标签：java

我在 Java 中开发了一个 Web 服务，其中包含大约 30 个操作。除了 2-3 行之外，每个操作都有完全相同的代码。以下是代码草图

```
public Response operation1(String arg1, String arg2)
{
   initialze(); // this line will be different for each operation with different arguments
   authorizeSession();
   Response res;

   if (authorized)
   {
       try 
       {
          Object result = callMethod1(arg1, arg2); // This line is different for each operation
          res = Response.ok(result).build();
       }
       catch( MultipleExceptions ex)
       {
          res = handleExceptions();
       }
       finally
       {
           logInDatabase();
       }

   }
   return res;
} 
```

我应该遵循什么方法，这样我就不必在每个操作中编写相同的代码？

1.  我应该使用反射吗？
2.  我听说过面向方面的编程……这里可以使用 AOP 吗？
3.  我应该使用普通的旧 switch case 语句和一种方法来决定根据操作调用哪个方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-29T14:55:52.757

这看起来很适合[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)。定义一个包含主要方法（final）的抽象类，它将特定部分委托给受保护的抽象方法。

在您的 Web 服务的每个方法中，实例化这个抽象类的一个子类，它只覆盖两个特定的抽象方法，并调用这个子类实例的主方法。

```
public abstract class Operation {
    public final Response answer(String arg1, String arg2) {
        authorizeSession();
        Response res;

        if (authorized) {
            try {
                Object result = executeSpecificPart(arg1, arg2);
                res = Response.ok(result).build();
            }
            catch (MultipleExceptions ex) {
                res = handleExceptions();
            }
            finally {
                logInDatabase();
            }
        }

        return res;
    }

    protected abstract Object executeSpecificPart(String arg1, String arg2);
}

...

    public Response operation1(final String arg1, final String arg2) {
        initialize();
        Operation op1 = new Operation() {
            protected Object executeSpecificPart(String arg1, String arg2) {
                ...
            }
        };
        return op1.answer();
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T14:56:23.140

# 模板方法模式和/或策略模式

每个方法都创建自己的`Callable`实例并将其传递给一个通用`run()`方法：

```
public Response operation1(String arg1, String arg2)
{
    initialze(); // this line will be different for each operation with different arguments
    return run(new Callable<Object> {
        public Object call() {
            return callMethod1(arg1, arg2); // This line is different for each operation
        }
    });
}

private Response run(Callable<Object> method) {
   authorizeSession();
   if (authorized)
   {
       try 
       {
          Object result = method.call();
          return Response.ok(result).build();
       }
       catch( MultipleExceptions ex)
       {
          return handleExceptions();
       }
       finally
       {
           logInDatabase();
       }
   }
   return null;
} 
```

~~如果 Java 有 lambda，它会更容易读写。~~

# AOP

面向方面的编程在这里不是最好的工具，因为您必须在方法*内部*截取一些东西。AOP 最适合您需要在方法之前或之后调用某些东西（或当它抛出某些东西时）。这同样适用于反射。

但是 AOP 将显着改进错误处理。然后您的代码可以简化为：

```
public Response operation1(String arg1, String arg2)
    {
    initialze(); // this line will be different for each operation with different arguments
    authorizeSession();

    if (authorized)
    {
        Object result = callMethod1(arg1, arg2); // This line is different for each operation
        return Response.ok(result).build();
    }
    return null;
    } 
```

和catch of`MultipleExceptions`和`finally`block 可以放在`AfterThrowing`and`After`通知中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T14:52:48.763

在这种情况下，您可以只提取私有方法中的代码。

1.) 反思会使理解和维护变得更慢、更难。

2.) 当一个关注点横切另一个关注点时，应该使用 AO 技术。实际情况并非如此，因为`initialize`和`callMethod1`是整个算法的一部分，不能单独存在。

3.) switch 语句是正确的思维方式，但却是“多态恐惧症”的标志。

你可以这样做：

```
private static interface CallMethodHelper {
    Object callMethod() throws MultipleExceptions;
}

public Response operation1(final String arg1, final String arg2) {
    initialze(); 
    return operationHelper(new CallMethodHelper() {
        @Override
        public Object callMethod() throws MultipleExceptions {
            return callMethod1(arg1, arg2);
        }
    });
}

private Response operationHelper(CallMethodHelper helper) {
    authorizeSession();
    Response res = null;

    if (authorized) {
        try {
            Object result = helper.callMethod();
            res = Response.ok(result).build();
        } catch (MultipleExceptions ex) {
            res = handleExceptions();
        } finally {
            logInDatabase();
        }

    }
    return res;
} 
```

请注意，您必须使参数成为最终的，并且您当然可以使用泛型来更改结果和异常类型。

# sql-server - SQL Server 2008 r2 创建触发器

> ID：12653706
> 
> 赞同：0
> 
> 时间：2012-09-29T14:48:12.153
> 
> 标签：sql-server, triggers, sql-server-2008-r2

我是触发器的新手，并且遇到了一些困难我正在尝试创建一个触发器，当有人登录我们的 WMS 时，它会记录用户登录 WMS 的时间以及他们空闲了多长时间。我最初创建了一个存储过程，它工作得很好，但是当我试图把它变成一个触发器时，它要么什么都不做，要么返回一个错误。

我尝试将整个代码放入触发器中，并将触发器指向存储过程。

这是我当前的代码，即使已满足基本标准，也没有任何反应。

```
Use WMS;
Go

Create Trigger ExpiredUsersRmv
On LogFile
For Insert
As

--Total Users before stored procedure runs
Declare @TtlUsers Int
Set @TtlUsers = '7';
--Idle time limit
Declare @iTime DateTime
Set @iTime = '00:05:00';

If 
(
Select COUNT(USERID)
From dbo.LogFile
)>= @TtlUsers

Begin

  Insert Into dbo.ExpiredIdleUsersRmvd
  Select Working, e.USERID, e.CMPNYNAM, USRCLASS, tTime, iTime, LoginDatestamp, GETDATE() As cTime
  From dbo.ExpiredTime e Join inserted i on e.USERID = i.USERID
  Where iTime >= @iTime;

End 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:56:06.680

我想到了几件事。其中一些是基于您发布的程序的推论，所以如果我在那里做出了不正确的假设，请提前接受我的道歉。

首先，根据代码中的“If”块，只有在 LogFile 中插入超过 7 条记录时，您的触发器才会触发，所以您确定这就是您想要的吗？

其次，我认为您可能会尝试以某种与其意图交叉的方式使用 DateTime。看起来您正试图将其用作“经过时间”的持有者，而实际上它试图持有特定的时间点，例如 2004 年 5 月 23 日上午 12:31:11。如果你想测量经过的时间，我希望看到一些 DateDiffs ......但仅仅依靠日期的时间部分会让我挑起眉毛作为一个可能的问题。您的查询条件“其中 iTime >= iTime”看起来很像您试图说“他们的空闲时间超过五分钟”，但实际上将寻找从完整值推断出的日期之后@iTime。

您可能需要考虑声明“LastActivityDate”，然后执行 DateDiff(seconds, LastActivityDate, GetDate)> 300 以捕获一定数量的空闲时间。

再次，如果我误解了您的需求，我深表歉意。

祝你好运。

**编辑：更多信息**

哦，天哪，我认为您已经在视图查询中覆盖了该字段。您正在将该 datediff 结果转换为字符串，这会给您带来各种困难。我会推荐以下内容：

*   修改 iTime 的视图以返回从 last_batch 到现在经过的秒数，例如 datediff(second, p.last_batch,getdate())。将它作为一个普通的旧整数返回。
*   在您的删除测试查询中，只需将 iTime 与您希望用于已用时间标准的秒数进行比较。根据您的样本，这是 5 分钟 -> 300 秒。这消除了您所做的所有冒险的日期时间/字符串比较，我认为这是您问题的根源。

试一试，看看会发生什么。

# asp.net - SQLServer 会话状态管理在应用程序池回收时丢失

> ID：12653708
> 
> 赞同：3
> 
> 时间：2012-09-29T14:48:39.550
> 
> 标签：asp.net, sql-server-2008, session-state

我有一个应用程序一直存在会话丢失问题，我几乎可以肯定它与应用程序池回收太频繁有关。

我想尝试一个进程外解决方案并配置了 SQLServer sessionState，但是当我回收工作进程时，我的会话仍然被吹走。这是我的 web.config

```
<sessionState cookieless="false" stateConnectionString="tcpip=localhost:42424"  mode="SQLServer" sqlConnectionString="Data Source=(local;User ID=user;Password=password" timeout="180" /> 
```

我已经运行了适当的 sql 脚本来设置数据库，并且可以看到会话已创建并存储在数据库中，但是如果我更改 web.config 或手动回收工作进程，我的会话将丢失。我究竟做错了什么？？

旁注，我收到与 StateServer 模式完全相同的行为。我似乎正确配置它，我可以看到登录时状态服务内存占用变大....我尝试将非序列化对象推送到并收到错误....但是当我回收应用程序池或更改web.config 我失去了会话....

我还尝试设置可以在这里找到的 Memcached 会话提供程序（这是我真正想使用的）：http: [//memcachedproviders.codeplex.com/releases/view/10468](http://memcachedproviders.codeplex.com/releases/view/10468)

它也在做同样的事情！我可以看到正在数据库中创建会话，当我尝试与非序列化对象交互时，我会收到与序列化有关的错误......但是当应用程序池被回收时我会丢失会话。
启用一些日志记录后，我在事件查看器中看到： **事件代码：1003 事件消息：应用程序编译正在启动**

没有人？？我真的需要摆脱进程会话状态的工作......帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T14:12:07.857

检查机器密钥的设置（假设 IIS 7.5）。如果您的 Web 服务器设置为自动生成机器密钥，则它可能会在您的应用程序回收时生成一个新密钥，这会导致您丢失会话。

请在此处查看此链接，以轻松为您的 Web 应用程序生成唯一的机器密钥。您应该能够在 Web 服务器或 Web 应用程序级别生成它们。

[http://blogs.msdn.com/b/amb/archive/2012/07/31/easyest-way-to-generate-machinekey.aspx](http://blogs.msdn.com/b/amb/archive/2012/07/31/easiest-way-to-generate-machinekey.aspx)

此外，FWIW，SQL Server 会话状态管理器与数据库*非常健谈。*它可以工作，但是您将使用该 Session 提供程序为每个请求访问数据库。

# solr - Solr *:* 和 2 个过滤器查询 VS。1 查询 1 过滤查询

> ID：12653711
> 
> 赞同：2
> 
> 时间：2012-09-29T14:49:21.753
> 
> 标签：solr, lucene, gis, geospatial

有什么区别（特别是在性能方面）：

1.  **使用一个`*:*`查询和 2 个过滤查询**

*例子：* `http://127.0.0.1:8080/solr/select?q=*:*fl=id&fq=lat:[42.2823890429 TO 42.4224427748] AND lng:[-71.3345718384 TO -70.7612228394]`

1.  **使用 1 个查询和 1 个过滤查询**

*例子：* `http://127.0.0.1:8080/solr/select?q=lat:[42.2823890429 TO 42.4224427748]&fl=id&fq=lng:[-71.3345718384 TO -70.7612228394]`

结果将根据时间戳进行排序，为简单起见，上述示例查询中未包含该时间戳。对于一个预计会增长的小数据集，我分别获得了 37 和 32 的查询时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:04:15.510

这完全是关于 lucene 过滤器和查询之间的区别。过滤器是可缓存的，因此速度更快。此外，过滤器不会影响文档的分数。通常，查询是用户在全文搜索框中键入的查询，而所有其他优化搜索的方法几乎都是预先定义的并用作过滤器。经验法则是：尽可能使用过滤器！

# excel - 需要使用 VBA 在 Excel 中返 回表中的行值。可以是工作表上不能使用 activecell 的任何表格

> ID：12653713
> 
> 赞同：3
> 
> 时间：2012-09-29T14:49:29.077
> 
> 标签：excel, rows, vba

在 Excel 中使用 VBA：

我有很多表有多个表。这些表的唯一共同点是 ProductID 列和 LotNumber 列。Products ID 列中的数据需要验证和/或操作。我需要一种方法来获取当前选定单元格的当前表的表行索引号。我不能使用 ActiveCell 引用，因为表格行与工作表行不匹配。我无法使用在列中查找最后使用的单元格，因为还有其他表格。

我需要能够在许多不同的工作簿中使用这个子。

这是我到目前为止的代码。

```
Const tblUNLABELED As String = "tblUnLabel"

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    StopAppEvents
    Dim ws As Worksheet

    Set ws = ActiveSheet
    Dim intRow As Integer
    Dim strTest As String
    If Not Intersect(ActiveCell, _
                     ActiveSheet.Range(tblUNLABELED & "[LotNumber]")) Is Nothing Then
        'go to the product entered in this table row and Ucase(ProductID)
        strTest = ws.ListObjects(tblUNLABELED).Range(intRow, "[ProductID]")
        ws.ListObjects(tblUNLABELED).Range(intRow, "[ProductID]") = UCase(strTest)
    End If

    RestartAppEvents

End Sub 
```

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T15:21:25.117

这使用 Range 的 ListObject 属性来告诉您 ActiveCell 所在的表的列名和行号。如果 ActiveCell 不在表中，您会收到一条消息。行号 0 表示 ActiveCell 位于表的标题行中：

```
Sub PrintActiveCellTableData()

    Dim cell As Excel.Range
    Dim lo As Excel.ListObject
    Dim loCol As Excel.ListColumn
    Dim loRowNum As Long

    Set cell = ActiveCell
    If cell.ListObject Is Nothing Then
        Debug.Print "No ActiveCell ListObject"
        Exit Sub
    End If

    Set lo = cell.ListObject
    With lo
        Set loCol = .ListColumns(cell.Column - (.HeaderRowRange.Cells(1).Column) + 1)
        loRowNum = cell.Row - .HeaderRowRange.Row
    End With

    Debug.Print "Table Name: "; lo.Name; "  ListColumn: "; loCol.Name; "  Row:"; loRowNum

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:11:30.507

如果所选单元格在您的一个表格内，并且您的表格以空单元格为界，则 ActiveCell.CurrentRegion 应该为您提供一个包含表格的范围，您可以从那里开始工作。

ActiveCell.Row - ActiveCell.CurrentRegion.Row + 1

为您提供当前表中活动单元格的（基于 1 的）行号

# java - 对具有相同类别的条形图中的条形进行聚类

> ID：12653715
> 
> 赞同：0
> 
> 时间：2012-09-29T14:49:36.190
> 
> 标签：java, jakarta-ee, jfreechart

我的问题与此 SO 链接中提出的问题非常相似

[使用 jfreechart 与同一类别的条形图一起创建条形图](https://stackoverflow.com/questions/2025590/create-barchart-using-jfreechart-with-bars-of-same-category-together)

如果我运行下面的示例，我将图表作为图像，（附图像）

```
DefaultCategoryDataset dataset = new DefaultCategoryDataset();
dataset.setValue(2, "Lesson-1", "27-sep-2012");
dataset.setValue(7, "Lesson-2", "27-sep-2012");
dataset.setValue(4, "Lesson-3", "27-sep-2012");

JFreeChart chart = ChartFactory.createBarChart(
    "BarChart using JFreeChart", "Student sample", "Marks sample", dataset,
    PlotOrientation.VERTICAL, true, true, false);
chart.setBackgroundPaint(Color.yellow);
chart.getTitle().setPaint(Color.blue);
CategoryPlot plot = chart.getCategoryPlot();

BarRenderer br = (BarRenderer) plot.getRenderer();
br.setItemMargin(0.7);
try {
    ChartUtilities.saveChartAsJPEG(new File(
        "D:/jfreeimages/sample.jpeg"), chart, 500, 300);
} catch (IOException e) {
    e.printStackTrace();
} 
```

![运行此处提到的代码后得到的图像](../Images/0891d07c0f483ea6ea756419d91d7a0b.png)

对于 2012 年 9 月 27 日的日期，我需要对所有条形图进行聚类并无间隙地显示。他们中的许多人建议我减少 barRenderer 的保证金（下面的代码）

```
BarRenderer br =(BarRenderer) plot.getRenderer() ;
br.setItemMargin(0.0); 
```

但这会使条形图的大小变得非常大，我只想要所附图像中的条形图大小。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T07:41:59.637

除了`setItemMargin(0)`在渲染器中，您还可以调整轴边距和面板大小以获得所需的效果。

![图片](../Images/8e258d685726adce3ed449e7e7270162.png)

```
import java.awt.Color;
import java.awt.Dimension;
import javax.swing.JFrame;
import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.CategoryAxis;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.renderer.category.BarRenderer;
import org.jfree.data.category.DefaultCategoryDataset;

/**
 * @see http://stackoverflow.com/a/12659576/230513
 */
public class StudentSample {

    public static void main(String[] args) {
        DefaultCategoryDataset dataset = new DefaultCategoryDataset();
        dataset.setValue(2, "Lesson-1", "27-sep-2012");
        dataset.setValue(7, "Lesson-2", "27-sep-2012");
        dataset.setValue(4, "Lesson-3", "27-sep-2012");

        JFreeChart chart = ChartFactory.createBarChart(
            "BarChart using JFreeChart", "Student sample", "Marks sample",
            dataset, PlotOrientation.VERTICAL, true, true, false);
        chart.setBackgroundPaint(Color.yellow);
        chart.getTitle().setPaint(Color.blue);
        CategoryPlot plot = chart.getCategoryPlot();
        BarRenderer br = (BarRenderer) plot.getRenderer();
        br.setItemMargin(0);
        CategoryAxis domain = plot.getDomainAxis();
        domain.setLowerMargin(0.25);
        domain.setUpperMargin(0.25);

        JFrame f = new JFrame("TreeEditorDemo");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        ChartPanel cp = new ChartPanel(chart){

            @Override
            public Dimension getPreferredSize() {
                return new Dimension(300, 300);
            }
        };
        f.add(cp);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);

        //try {
        //    ChartUtilities.saveChartAsJPEG(
        //        new File("temp.jpg"), chart, 300, 300);
        //} catch (IOException e) {
        //    e.printStackTrace();
        //}
    }
} 
```

# vba - 在 VBA for Word 2010 中创建富文本控件字段

> ID：12653716
> 
> 赞同：0
> 
> 时间：2012-09-29T14:49:39.990
> 
> 标签：vba, word-2010

我有一个控制字段，可以在其中动态添加某些文本。到目前为止效果很好。问题是在一个文本中我有一个输入字段，用户可以在其中输入文本。

我需要将表单文本输入字段硬编码到 VBA 代码中。这是如何实现的？或者有人可以指出我正确的方向吗？

在以下代码片段中，我需要将 替换`[InputField]`为 VBA 输入字段。

```
ActiveDocument.SelectContentControlsByTitle("Bottom").Item(1).Range.Text = _
"Some Text" & vbNewLine & _
"Some Text" & vbNewLine & _
"Some Text" & vbNewLine & _
"Text [InputField] Text" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:09:10.937

我不确定您所说的 VBA 输入字段是什么意思。我想你的意思是“表单输入字段”？如果是这样，那可能是您问题的解决方案：

```
Sub TestInsertContentControl()
    Dim m_objRange                      As Range
    Dim m_objRangeInsertTextInput       As Range
    Dim m_objFormField                  As FormField

    Set m_objRange = ActiveDocument.SelectContentControlsByTitle("Bottom").Item(1).Range
    m_objRange.Text = "Some Text" & vbNewLine & _
    "Some Text" & vbNewLine & _
    "Some Text" & vbNewLine & _
    "Text  "

    Set m_objRangeInsertTextInput = m_objRange
    m_objRangeInsertTextInput.Start = m_objRange.End - 1
    m_objRangeInsertTextInput.End = m_objRange.End

    Set m_objFormField = m_objRangeInsertTextInput.FormFields.Add(Range:=m_objRange, Type:=wdFieldFormTextInput)

    m_objRangeInsertTextInput.Start = m_objFormField.Range.End
    m_objRangeInsertTextInput.End = m_objFormField.Range.End
    m_objRangeInsertTextInput.Text = " Some more Text"
End Sub 
```

# css - HTML/CSS 字体：不同的浏览器/操作系统不同的结果

> ID：12653720
> 
> 赞同：2
> 
> 时间：2012-09-29T14:49:55.993
> 
> 标签：css, cross-browser, font-face

我一直在我的网站上工作，我正在使用字体松鼠为网站生成一些网络字体，但目前我有这个区别：

**谷歌浏览器 OSX** ![谷歌浏览器 OSX](../Images/605975d729de23556d2ebb17ee423db4.png)

**谷歌浏览器窗口** ![谷歌浏览器窗口](../Images/a5eb22ec016d350857930097a596f346.png)

**火狐 OSX**

![火狐 OSX](../Images/09ca4a56af5c0ecdcd81d4ba0eaedd1e.png)

**火狐视窗** ![火狐视窗](../Images/bcd01b4da6f63e051c3284135c65ca89.png)

**IE浏览器** ![IE浏览器](../Images/f2d14ae731657fde849fa9e7d7e1a6b6.png)

有没有办法我可以“破解”windows下的字体，这样它们看起来更像OSX下的字体？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T14:51:42.493

这里的主要区别不是浏览器之间，而是操作系统之间，这是非常标准的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T17:44:44.120

不同的系统以不同的方式呈现字体。您几乎无能为力。你可以忍受它：检查主要系统（Windows、Mac、Linux，也许还有一些移动系统）上的渲染是*接受*的。它们不能也不必相同。但是，如果您在某些平台上得到不可接受的结果，请更改字体（尽管有时只是更改字体大小，甚至可能大 1 像素，可能会有所帮助）。

该问题在 http://www.owlfolio.org/htmletc/legibility-of-embedded-web-fonts/ 上进行了描述，在[http://www.smashingmagazine.com/2012](http://www.smashingmagazine.com/2012/04/24/a-closer-look-at-font-rendering/)[上](http://www.owlfolio.org/htmletc/legibility-of-embedded-web-fonts/)进行了更详细（和技术上更详细）的描述[/04/24/a-closer-look-at-font-rendering/](http://www.smashingmagazine.com/2012/04/24/a-closer-look-at-font-rendering/)

但是，原则上，差异也可能是由不同的印刷设置引起的。现在的 Firefox 默认应用字距调整和通用连字，其他浏览器则不这样做。但是您可能不会看到这样的效果，原因有两个：免费字体通常没有连字或字距调整对，并且 Lorem ipsum 文本通常不包含重要的字符对（例如，“fi”或“To”或“Va”）。无论如何，使用 CSS 属性（或者，更确切地说，具有各种浏览器前缀的属性）*可以*在很大程度上影响排版设置。`font-feature-settings`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T15:07:42.170

我认为这个问题没有破解，因为浏览器与浏览器在实际渲染文本的外观上存在巨大差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T15:16:37.117

请注意，Windows 也有 ClearType。更改其设置也会产生影响（在 Windows 7 中，它是一个 4 步向导）。

我提到这一点的原因是 Windows 有一种改变字体外观的本机方式，每个人都会根据他们的 ClearType 设置以不同的方式看到它。我认为浏览器变化不大，但操作系统肯定会发生变化。然后还有显示器和分辨率......

不要过分痴迷于让每个系统上的东西看起来都一样。无论您尝试什么，您都无法做到这一点，而且完全没有必要。

# php - 如何动态改变上传路径

> ID：12653723
> 
> 赞同：0
> 
> 时间：2012-09-29T14:50:31.493
> 
> 标签：php

我试图制作一个文件上传系统，每当上传文件时，文件都会进入上传文件夹设置，如上传/2012/09/{randomhash}/。

为此，我尝试了下面的代码。

```
$hash   = RandomString(20);
$upload_path = '../../uploads/'.$year.'/'.$month.'/'.$hash.'/';
if (!is_dir($upload_path))
{
    mkdir($upload_path, 0777);
} 
```

由于某种原因它不起作用，我不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T14:52:40.230

因为 apache（mkdir() 函数在创建目录时尝试使用的用户）对您尝试更改的目录没有正确的权限？这是我的猜测，没有您提供更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:53:34.673

[mkdir()](http://php.net/manual/en/function.mkdir.php)有第三个参数叫做`$recursive`. 将其设置为`true`。

# c++ - 两阶段初始化的用例

> ID：12653724
> 
> 赞同：5
> 
> 时间：2012-09-29T14:50:43.227
> 
> 标签：c++, oop

我见过很多使用的两阶段初始化。理由是从辅助构造函数调用虚函数。但是，我从未见过任何需要这样做的用例。有吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:10:18.390

在不支持异常的平台上，或者由于异常处理导致代码大小增加是不可接受的，两阶段初始化允许您将可能失败的活动放在辅助构造函数中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T15:54:26.397

不，这从来都不是不可避免的。

在最坏的情况下，这只是调用一个构建器函数（它可以由运行时机制选择）返回一个围绕对象的可选包装器。

在 C++11 中，使用可移动类型，甚至不需要动态分配，只需返回 a`boost::optional<T>`就足够了。

当然，它确实从直接调用构造函数变为调用构建器函数/工厂。但我更喜欢额外的负担，而不是任何一天的两阶段初始化。**因为那样我没有得到任何*部分对象*！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:10:21.490

我看到从其他语言的构造函数中调用的虚函数的一种方式是：

```
class AController
{
};

class A
{
private:
    // This is only a raw pointer that never gets freed for simplicity
    // The real code does ensure it gets freed when appropriate
    AController *controller;
protected:
    virtual AController *CreateController()
    {
        return new AController();
    }
public:
    A()
    {
        controller = CreateController();
    }
};

class BController : public AController
{
};

class B : public A
{
protected:
    virtual AController *CreateController()
    {
        return new BController();
    }
}; 
```

`A`是一个复杂的对象，有几个类似`Controller`的子对象（我只包括了一个），每个子对象都可以独立地派生自（如果合适的话）。在 C++ 中，`CreateController`必须在构造函数完成后调用 -like 函数，否则`BController`将永远不会创建 -like 对象。

可以避免要求显式调用`Initialize()`方法，但`Initialize()`方法（从也执行 的辅助函数调用`new A()`）是更简单的方法之一。

# python - App Engine logging.debug 未在服务器上记录

> ID：12653725
> 
> 赞同：0
> 
> 时间：2012-09-29T14:50:50.857
> 
> 标签：python, django, google-app-engine, logging

出于某种原因，当我使用该功能时，我在**生产服务器**上看不到调试日志消息。`logging.debug`,`logging.info`和函数工作`logging.warning`得`logging.error`很好。我在应用程序引擎上使用 django 并在我的`settings.py`文件中有以下设置：

```
def config_logging(in_dict):
    import logging
    logging.basicConfig(
        level = logging.DEBUG,
        format = '%(asctime)s %(levelname)s %(message)s',
    )

LOGGING_CONFIG = "settings.config_logging" 
```

另请注意，当我`--debug`在开发服务器上使用该标志时，会显示正确的日志。

我不知道为什么没有记录调试日志。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T18:27:39.077

I don't know if something in django differs for this, but you need to include `--debug` as a flag when you start the server to see debug-level log messages in a non-django app.

# php - mysql php 数据库将共享一个成员表，但仅此而已？

> ID：12653726
> 
> 赞同：2
> 
> 时间：2012-09-29T14:50:53.727
> 
> 标签：php, mysql

我正处于创建 php mysql 数据库的设计阶段，其中组需要共享一个成员表，但需要有自己的表来存储其他数据，如消息、设置、出勤等。

我在想我可以在一个数据库中创建所有表，并为每个表提供一个 group_id，这样您就可以按该组进行过滤并仅显示该数据。这可能存在安全问题，并且数据库可能会变大。

我正在考虑的另一种方法是使用带有 group_id 的成员表创建一个数据库，然后为每个组创建单独的数据库。这更难可视化并且更难正确查询。

我的问题是，有没有更好的方法来做到这一点，或者是这两种方法之一，如果是这样，你会推荐一个吗？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:54:53.803

安全问题是程序员的错，而不是数据库的错。

数据库本来就是要变*大*的——瓶颈通常在于糟糕的 php 代码，或者由于资源处理不佳而导致的错误 HTTP 有效负载 [没有缓存、无用的请求、错误的标记]。

只需坚持使用一个数据库，并使用精心设计的表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:57:17.217

为什么组要拥有自己的带有消息的表？那是非常低效的。

您所描述的结构是一种称为 1:n 或 1 对多的关系。

只需创建一个消息表，其中的字段指向消息所属的组：

```
CREATE TABLE `Groups` (
  `GroupId` int(11) NOT NULL AUTO_INCREMENT,
  `Name` varchar(64) NOT NULL,
  PRIMARY KEY (`GroupId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Messages` (
  `MessageId` int(11) NOT NULL AUTO_INCREMENT,
  `GroupId` int(11) NOT NULL,
  `Message` text NOT NULL,
  PRIMARY KEY (`MessageId`),
  KEY `FK_Group` (`GroupId`),
  CONSTRAINT `FK_GroupMessage` FOREIGN KEY (`GroupId`) REFERENCES `Groups` (`GroupId`),
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

# ruby-on-rails - Ruby on Rails + PostGIS 模型自定义初始化和自定义 JSON 输出

> ID：12653727
> 
> 赞同：2
> 
> 时间：2012-09-29T14:50:53.887
> 
> 标签：ruby-on-rails, activerecord, postgis

我正在使用 PostgreSQL + PostGIS 来处理空间数据，并且我还使用这个 gem [activerecord-postgis-adapter](https://github.com/dazuma/activerecord-postgis-adapter)来保持编写代码的轻松。我有这个模型

```
class Device < ActiveRecord::Base
  attr_accessible :location
  self.rgeo_factory_generator = RGeo::Geos.factory_generator
end 
```

其中 :location 应该是 PostGIS POINT。要创建 Device 的新实例（例如在控制器的 create 方法中），我可以这样做：

```
params = { location: "POINT (-26 -43)" }
@device = Device.new(params) 
```

其中“POINT (-26 -43)”是 WKT（众所周知的文本）格式中纬度 -26 和经度 -43 的点。我希望能够隐藏此实现细节并使其可以编写：

```
params = { latitude: -26, longitude: -43 }
@device = Device.new(params) 
```

也许我可以通过覆盖我的设备类中的 after_initialize 方法来实现这一点。我还可以做些什么？

还有一件事..我还需要以 JSON 格式输出这个对象。现在我得到

```
{ "location": "POINT (-26 -43)" } 
```

但是，我想要类似的东西

```
{ "location": { "latitude": -26, "longitude": -43 } } 
```

对此的快速解决方案是覆盖 as_json 方法。还有其他建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-31T21:31:13.167

您需要做的就是在**Device**类中**覆盖方法****as_json**以将位置键替换为所需的键：

 ****```
class Device < ActiveRecord::Base
  ...
  def as_json(options = {})
    json = super(options)
    json.merge(location_as_formatted_hash)
  end

  private

  def location_as_formatted_hash
    { location: { latitude: location.lat, longitude: location.lon } }
  end
end 
```

有了这个，你将拥有下一个：

```
Device.first.to_json
{ \"location\": { \"latitude\": -26, \"longitude\": -43 } } 
```

而不是这个：

```
Device.first.to_json
{ \"location\": \"POINT (-26 -43)\" } 
```****

# php - PHP上传具有不同文件名但公共文件夹的多个文件

> ID：12653729
> 
> 赞同：0
> 
> 时间：2012-09-29T14:51:32.043
> 
> 标签：php, html, mysql

我正在尝试一次上传多个文件，但有一个单独的表单字段来定义将定义画廊名称的列的名称......我尝试了不同的脚本和方法，但我唯一成功的就是这个一，除了我必须在每个中输入画廊的名称，有没有办法做到这一点？

这是我的 HTML 表单

```
 <form action="php_multiple_upload2.php" method="post" name="form1" enctype="multipart/form-data">
        <input type="text" name="galnom1"><input type="file" name="fileUpload1" ><br>
        <input type="text" name="galnom2"><input type="file" name="fileUpload2"><br>
        <input type="text" name="galnom3"><input type="file" name="fileUpload3"><br>
        <input type="text" name="galnom4"><input type="file" name="fileUpload4"><br>
        <input name="hdnLine" type="hidden" value="4">
        <input name="btnSubmit" type="submit" value="Submit">
    </form> 
```

这是PHP代码

```
 <?php
    include("../../cnf/cnctr.php");

    for($i=1;$i<=(int)($_POST["hdnLine"]);$i++)
    {
    if($_FILES["fileUpload".$i]["name"] != "")
      {
      if(copy($_FILES["fileUpload".$i]["tmp_name"],"img/".$_FILES["fileUpload".$i]["name"]))
        {
          $strSQL = "INSERT INTO galeria ";
          $strSQL .="(galnom,ttl) VALUES ('".$_POST["galnom".$i]."','".$_FILES["fileUpload".$i]["name"]."')";
          mysqli_query($fsn,$strSQL);
          echo "Copy/Upload ".$_FILES["fileUpload".$i]["name"]." completed.<br>";
        }
      }
    }
    echo "<br><a href='php_multiple_upload6.php'>View file</a>";
    mysqli_close($fsn);
    ?> 
```

这就是我设想我的 html 表单的方式：

```
 <form action="php_multiple_upload2.php" method="post" name="form1" enctype="multipart/form-data">
      <input type="text" name="gallery_name"><br> <!-- Just one field to name the gallery -->
      <input type="file" name="fileUpload1" ><br>
      <input type="file" name="fileUpload2"><br>
      <input type="file" name="fileUpload3"><br>
      <input type="file" name="fileUpload4"><br>
      <input name="hdnLine" type="hidden" value="4">
      <input name="btnSubmit" type="submit" value="Submit">
    </form> 
```

一如既往地感谢您的帮助:)

最好的祝福

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:10:54.517

您可以按照您的设想使用该表格。

换线就行了

```
$strSQL .="(galnom,ttl) VALUES ('".$_POST["galnom".$i]."','".$_FILES["fileUpload".$i]["name"]."')"; 
```

用这条线：

```
$strSQL .="(galnom,ttl) VALUES ('".$_POST["gallery_name"]."','".$_FILES["fileUpload".$i]["name"]."')"; 
```

以防万一：请注意，您的 SQL 代码对 SQL 注入完全不安全

# php - 如何知道 curl_multi_exec 中哪个 URL 失败？

> ID：12653731
> 
> 赞同：6
> 
> 时间：2012-09-29T14:51:50.360
> 
> 标签：php, curl, curl-multi

我编写了一个类来更轻松地使用多 cURL 请求，当我收到 404 错误或任何其他错误时，我想记录错误。我已经`CURLOPT_FAILONERROR`设置为true。

我目前正在使用`curl_multi_info_read()`.

这是我的代码：

```
$active = null;
    do {
        $multi_exec = curl_multi_exec($this->_multi_handle, $active);
    } while ($multi_exec == CURLM_CALL_MULTI_PERFORM);

    while ($active && $multi_exec == CURLM_OK) {
        if (curl_multi_select($this->_multi_handle) != -1) {
            do {
                $multi_exec = curl_multi_exec($this->_multi_handle, $active);
                $info = curl_multi_info_read($this->_multi_handle);
                if ( $info['result'] != 0 ) {
                    $this->_errors[] = $info; // currently storing the whole array
                }
            } while ($multi_exec == CURLM_CALL_MULTI_PERFORM);
        }
    } 
```

错误的结果是这样的数组：

```
Array
(
    [0] => Array
        (
            [msg] => 1
            [result] => 22 // on success this is 0
            [handle] => Resource id #4 // does this help in finding the url if I have the handle ID ?
        ) 
```

那么如何获取发生错误的 URL 呢？这只会给我句柄资源 ID

并提前感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T14:55:12.740

根据您的实际需要，您可以将此句柄传递给[curl_error](http://php.net/manual/en/function.curl-error.php)或[curl_errno](http://php.net/manual/en/function.curl-errno.php)函数以检查错误，您可以使用[curl_getinfo](http://php.net/manual/en/function.curl-getinfo.php)从该句柄中提取 URL：

```
curl_getinfo($info['handle'], CURLINFO_EFFECTIVE_URL); 
```

# ios - 如何在我的应用中显示应用内购买

> ID：12653732
> 
> 赞同：0
> 
> 时间：2012-09-29T14:51:51.313
> 
> 标签：ios, in-app-purchase

我想知道如何在我的应用中显示我的应用内购买。我正在制作一本杂志，并希望在我的应用程序中有一个杂志列表。当有人购买该杂志时，它会提示进行应用内购买，我已经完成了所有这些，但是我不明白的是，它如何显示从那时起下载的应用内购买，以及如何下载后，我会从我的主应用程序链接到下载的 mag 吗？

# c# - 如何将 Telerik RadFileExplorer 中的路径设置为只读？

> ID：12653733
> 
> 赞同：1
> 
> 时间：2012-09-29T14:51:59.130
> 
> 标签：c#, asp.net, html, web-services, telerik

现在，我在我的网站上设置了 Telerik 的 RadFileExplorer。我选择了一堆文件并对它们执行各种操作。其中一项操作是客户端事件，其中任何已“翻译”的文件都被移动到子目录中。

我希望我的客户能够查看此子目录，但不再对其中的文件进行操作。所以，澄清一下。他们可以对一个文件夹中的文件进行操作，但不能对该文件夹中的文件夹进行操作。

我在 Telerik 的论坛上找不到任何文档或帮助。

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T13:18:16.593

文件夹权限继承自您在 ViewPaths、DeletePaths 和 UploadPaths 属性中设置的权限。为了将它们更改为子文件夹，您需要一个自定义内容提供程序来为您提供所需的功能。您可以在以下资源中找到如何实现的示例：

[http://www.telerik.com/support/kb/aspnet-ajax/fileexplorer.aspx](http://www.telerik.com/support/kb/aspnet-ajax/fileexplorer.aspx)

[http://www.telerik.com/community/code-library/aspnet-ajax/file-explorer.aspx](http://www.telerik.com/community/code-library/aspnet-ajax/file-explorer.aspxa)

更准确地说是这个：

[http://www.telerik.com/support/kb/aspnet-ajax/fileexplorer/physical-paths-and-different-content-types.aspx](http://www.telerik.com/support/kb/aspnet-ajax/fileexplorer/physical-paths-and-different-content-types.aspx)

这篇文章更详细地解释了薄：

[http://www.telerik.com/help/aspnet-ajax/fileexplorer-custom-filebrowsercontentprovider.html](http://www.telerik.com/help/aspnet-ajax/fileexplorer-custom-filebrowsercontentprovider.html)

# c++ - 套接字认证和加密

> ID：12653741
> 
> 赞同：3
> 
> 时间：2012-09-29T14:52:40.850
> 
> 标签：c++, sockets, authentication, encryption

这包括多个问题，但由于它们有些相关，我想将它们一起发布。

我在做什么：我正在编写一个服务器客户端应用程序，用户必须登录才能与服务器通信。现在我正在使用 udp（是的，我确定我想使用 udp）并进行了一些小的修改。

**第一部分：**

存储用户连接的最佳方式是什么？

我的想法：

1.  创建一个容器，存储所有允许连接的客户端的所有地址（成功登录后）
2.  创建一个存储所有会话 ID 的容器（会话 ID 将与每个数据包一起发送）

其他想法表示赞赏（特别是如果它们已经被使用）

我的担忧：

1.  有人可以更改数据包发件人的地址吗？（我假设是的）
2.  会话 ID 可能会被嗅出。（我记得一些大公司的名字有这个问题）

**第二部分：**

不过，我必须加密我的数据包。在 (2) 的情况下，加密可能与会话 ID 相关，因此只有来自用户的数据包可以使用与该客户端对应的正确会话密钥解密（类似 AES，仅提供示例）。

这将需要一个适当的快速算法（可能有 30-50 个数据包，每秒从单个客户端发送 256 个字节）

1.  哪种算法适合这个（RSA 似乎有点太慢了）？
2.  这个算法将如何工作？（只是一个非常简短的摘要，但感谢提供更多信息的来源）
3.  它会加密数据包以使其与原始数据包一样大，还是会更大以至于我必须在服务器端编写某种缓存机制来组装这些数据包？

哦，顺便说一句。我不需要关于公钥/私钥、握手等的解释。知道我会在商业产品中使用这个算法（许可方面）可能很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T07:06:56.797

如果没有考虑到特定的应用程序，这很难回答，但我会尝试给出一些通用的提示：

> 创建一个容器，存储所有允许连接的客户端的所有地址（成功登录后）

由于 NAT，这根本行不通，遗憾的是，由于 IPv4 耗尽，它仍在使用，实际上甚至增加了。你至少需要 src-ip+src-port。即便如此，考虑到移动用户，您可能永远不想使用 IP 作为会话 ID。普通智能手机会很容易地在蜂窝网络和 WiFi 网络之间切换，通常会导致 IP 堆栈完全重启，因此无法将新流量与之前的流量关联起来。这可能是也可能不是问题，但除非您可以控制 IP 地址，否则我永远不会使用这种方法。

> 创建一个存储所有会话 ID 的容器（会话 ID 将与每个数据包一起发送）

这实际上是通用解决方案，您的第一个解决方案只是一个特定的实现，您使用源 IP 作为会话 ID。如果您担心会话 ID 管理，只需使用[UUID](https://en.wikipedia.org/wiki/UUID)，会话 ID 之间发生冲突的几率非常低。或者，当使用公钥/私钥加密时，您可以使用用户的公钥作为会话 ID。

这里的一个重要部分是如何协商会话 ID。你可能想让用户选择，你可能想用一个“特殊的”会话ID（例如0）来让服务器选择。什么是最好的取决于您的应用程序。

> 有人可以更改数据包发件人的地址吗？（我假设是的）

当然，这被称为[中间人攻击](https://en.wikipedia.org/wiki/Man_in_the_middle_attack)（如果对传输中的数据包进行）或[IP 地址欺骗](https://en.wikipedia.org/wiki/IP_address_spoofing)（如果发送带有假 IP 的数据包），并且对于大多数最终用户来说是无法检测到的。尽管许多网络对此都有保护，例如使用[反向路径转发](https://en.wikipedia.org/wiki/Reverse_path_forwarding)。

> 会话 ID 可能会被嗅出。（我记得一些大公司的名字有这个问题）

如果加密：也许（见下文）。如果没有加密：当然。

那么关于你的加密问题的整个部分：

一般来说，您走在正确的轨道上，您通常希望对常规流量使用对称密钥加密方案。AES 是一个不错的选择，但还有其他的，去研究一下吧。

但是，您在设置加密时遇到了问题。通常，您需要安全地获取双方的加密密钥，而无需人们嗅探它们。您可以尝试通过航空邮件发送密钥，但我怀疑大多数用户会发现这对用户很友好，即使这样也不是很安全。

这就是非对称密钥加密方案的用武之地。您通常会使用 RSA 之类的东西来协商初始连接（会话 id、加密密钥，也许是一些记帐，...），并让对称密钥接管实际流量。一个流行的方案是[Diffie-Hellman 密钥交换](https://en.wikipedia.org/wiki/Diffie-hellman)，但同样还有更多。

话虽如此，您可以很好地保护您的频道，但中间人攻击始终是一个问题。事实证明，实际上您几乎无法真正防止这种情况发生，因为您无法控制其中一方（客户端），如果它是受感染的机器，则所有赌注都关闭：

1.  为每个用户使用唯一的、预分配的私钥，您可以使用传入会话进行验证。如果他们没有以其他方式获得该密钥，这将使 mitm 攻击更加困难，但非自动生成的私钥通常难以与用户友好性相结合。您在如何分发它们（该死，我如何在那里处理 mim？）、如何将它们存储给用户（哦，他使用笔记本电脑、iPhone 和 iPad）、如果丢失时如何恢复它们、. ..
2.  Make sure that all traffic is initiated by the client and encrypted immediately with the server's public key. This is easier as you don't have to distribute a private key. However, a hacker can still replace your server's public key with it's own key, but it's a lot harder and if done right almost comes down to installing a virus on the client computer.
3.  Do some sanity checks in your client application. For example, make sure you're connecting to a known pool of server IP's, check if the DNS query is correct, etc etc. It's far from fail-safe but it are simple verification that will discourage potential hackers.
4.  Educate your users. This is what many banks do (at least where I live), let them do a regular anti-virus check, only use trusted WiFi-networks, verify the DNS servers, ... . Of course some things are harder to teach then others, but a little common sense gets you a long way.

Oh and finally I do actually want to comment on the UDP part: are you really really sure? Because almost everything of this scheme and even a lot more is covered by [TLS](https://en.wikipedia.org/wiki/Transport_Layer_Security), which is integrated in [boost asio](http://www.boost.org/doc/html/boost_asio.html). If your traffic is that low-rate I can hardly imagine it's an application that needs the advantages that UDP offers, unless you want to secure voip, which is done already, don't reinvent the wheel.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T06:34:07.290

所有加密系统都需要加密密钥。必须先交换此密钥，然后才能开始加密传输。当您在加密之前通过未加密的网络连接发送此密钥时，攻击者可能会截获此密钥并嗅探连接。当攻击者能够更改密钥时，他也可以操纵传输。防止这种情况发生的唯一方法是不通过网络而是在不同的介质上交换密钥，或者使用由受信任的机构签署的加密证书。

几个google关键词：密码证书；公钥密码学；SSL；TSL；中间人攻击

大多数加密算法（如 AES）都是分组密码。这意味着它们以固定大小的块（如 256 或 512 字节）加密消息。当消息不适合块大小时，将在加密前用零填充。当您发送大量短消息时，这可能会产生大量开销。

也有不需要填充的流密码，但它们的发展不如分组密码先进。密码学专家认为它们中的大多数还不是非常强大和可靠。

# azure - 将 Team Project Build 从 TFSPreview 部署到 Azure 时，如何指示要部署的 Web 应用程序？

> ID：12653742
> 
> 赞同：0
> 
> 时间：2012-09-29T14:52:40.170
> 
> 标签：azure, deployment, tfs, azure-devops, continuous-deployment

我有一个团队项目的 TFSPreview 帐户，并且有一个构建定义，它构建解决方案，其中我有一个 Web 应用程序。

我已将其链接到 Azure 以实现持续部署（构建定义使用“AzureContinuousDeployment.11.xaml”工作流）。

一切正常。我不明白，如果有几个Web App，它如何选择部署哪个Web App？我找不到这方面的任何设置。

upd：我在我的解决方案中添加了第二个 Web 应用程序项目。第一个仍在部署中。第二个没有。我仍然找不到要部署的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:14:30.347

[设置 TFS 发布时](https://www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-tfs/#header-2)需要选择项目：

![在此处输入图像描述](../Images/efa9ab669c5044e715b8281898cdbda7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:19:19.617

编辑构建定义文件。（转到团队资源管理器并右键单击正在使用的构建）在选择模板的下方的流程选项卡上，第1 节**。必**选选择要构建的解决方案

# python - Celery 动态任务 / 在接口后面隐藏 Celery 实现

> ID：12653745
> 
> 赞同：4
> 
> 时间：2012-09-29T14:52:59.003
> 
> 标签：python, interface, celery, encapsulation

我试图弄清楚如何用 Celery 实现我的异步作业，而不是将它们与 Celery 实现联系起来。

如果我有一个接受要调度的对象的接口，例如可调用对象（或包装可调用对象的对象）：

```
ITaskManager(Interface):
    def schedule(task):
        #eventually run task 
```

我可能会使用踩踏模块来实现它：

```
ThreadingTaskManager(object)
    def schedule(task):
        Thread(task).start() # or similar 
```

但似乎这不能用芹菜来完成，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T16:01:26.430

也许一个，虽然很丑，解决方案可能是定义一个 celery 任务，它动态加载作为参数传递的任务对象：

```
@celery.task
def taskrunner(taskname):
    taskModule = __import__(taskname)
    taskModule.run()

CeleryTaskManager(object)
    def schedule(task):
        taskrunner.delay(task.__file__)

from mytask import run

CeleryTaskManager().schedule(run) 
```

# java - Java/Android：虚拟调度、switch-case 或数组访问

> ID：12653748
> 
> 赞同：0
> 
> 时间：2012-09-29T14:53:19.973
> 
> 标签：java, android, arrays, performance, switch-statement

我知道“在你的应用程序中测试它”是必须的。尽管如此，我也想要求一个分析的见解。

我有一个应用内指令队列（作为一个`Array`），它的元素是按顺序处理的。细节无关紧要。（将“指令”视为虚拟指令，即仅根据我的应用程序对其进行解释——就像一个小型内部虚拟机）。

实际的问题是：处理队列元素哪个更快——Java 提供的虚拟调度，还是`switch-case`?

1.  在第一种情况下，`Array`由一个自己的对象的后代组成`Operation`（或者只是`Runnable`——你明白了）。在这种情况下，指令执行只是调用`Operation.run()`对象的覆盖。虚拟调度将完成其余的工作——`run()`将调用具体实例的。

2.  这`Array`是一个原始`int`数组，每个元素都是一个指令代码，它来自一个连续的范围（例如，`int`介于 0..65535 之间）。指令处理意味着指令代码被解释：（A）通过`switch-case`语句，或（B）通过使用由指令代码直接索引的`Array`（对象）。`Operation`

在第二种情况下，我想`switch-case`现在已经足够优化（特别是因为我使用的是连续范围），所以我们可以忘记这个`Array`选项。

总结一下，哪个更快？将解释代码添加到 的分支`switch-case`，还是使用虚拟调度？

我想它可以分解为：`switch-case`更快还是虚拟调度？我读到 a`switch-case`可以优化为分支表或跳转指令，我想在这种情况下这是可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T18:55:15.810

由于您的 switch 语句是“密集的”，我的感觉是它应该比多重继承方案更快。很可能编译器会将其优化为基于整数索引的表查找。再次只是我的感觉是，编译器更不可能在（内部）解决您的继承方案以便在第二种选择中执行“invokevirtual”操作码......特别是如果基类已被继承在许多变体中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:32:00.993

我认为 swtich-case 较慢（并且不那么可读），因为它基本上与级联 if/elseif/... 相同，因此在找到正确的 case-branch 之前，您将在这里进行很多比较，而与直接访问，正确的指令应该可以直接访问。（希望我理解你的问题，所有这些假设和理论的东西）

# php - 来自 Post 的 PHP 数据

> ID：12653759
> 
> 赞同：0
> 
> 时间：2012-09-29T14:55:21.380
> 
> 标签：php, html, http-post

我有一个从 a 返回 json 编码响应的函数`$_POST`：

```
function getdatafrompost(){
    $raw  = '';     
    $httpContent = fopen('php://input', 'r');
    while ($kb = fread($httpContent, 1024))
        $raw .= $kb;        
    fclose($httpContent);      
    $params = array();
    parse_str($raw, $params);
    if (isset($params['data'])) 
        $retdata = json_decode(stripslashes($params['data']));
    else
        $retdata = json_decode(stripslashes($raw)); <====Returns Null
    return $retdata;
} 
```

正在读取的原始数据是：

```
{"recordid":"099ac8aa-0a43-11e2-860f-0016177c526f","ntsdataid":"","trkdataid":"5628af8e-08db-11e2-860f-0016177c526f","activitydate":"2012-09-29","activitytime":"10:36:21","activityname":" from S. Interrante","activitynote":"<i><font color=\"99CC00\" size=\"4\"><b><font face=\"verdana\">fgsdfgsdgsdfgsdgsdgsdfg</font>\u200b</b></font></i>"} 
```

问题`$retdata`是返回null。这似乎在包含 HTML 的“activitynote”字段中。当“activitynote”不包含 HTML 时，数据会被正确解析。有没有更好的方法来解析数据？我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:05:47.503

你不应该使用`stripslashes`，它会影响json文档的有效性来修复这个错误你应该替换

```
json_decode(stripslashes($raw)) 
```

和

```
json_decode($raw); 
```

例子

```
$raw = '{"recordid":"099ac8aa-0a43-11e2-860f-0016177c526f","ntsdataid":"","trkdataid":"5628af8e-08db-11e2-860f-0016177c526f","activitydate":"2012-09-29","activitytime":"10:36:21","activityname":" from S. Interrante","activitynote":"<i><font color=\"99CC00\" size=\"4\"><b><font face=\"verdana\">fgsdfgsdgsdfgsdgsdgsdfg</font>\u200b</b></font></i>"}' ;
var_dump(json_decode($raw)); 
```

输出

```
object(stdClass)[1]
  public 'recordid' => string '099ac8aa-0a43-11e2-860f-0016177c526f' (length=36)
  public 'ntsdataid' => string '' (length=0)
  public 'trkdataid' => string '5628af8e-08db-11e2-860f-0016177c526f' (length=36)
  public 'activitydate' => string '2012-09-29' (length=10)
  public 'activitytime' => string '10:36:21' (length=8)
  public 'activityname' => string ' from S. Interrante' (length=19)
  public 'activitynote' => string '<i><font color="99CC00" size="4"><b><font face="verdana">fgsdfgsdgsdfgsdgsdgsdfg</font>â€‹&lt;/b></font></i>' (length=105) 
```

# c# - 调用 Web 服务时服务器端内存泄漏

> ID：12653765
> 
> 赞同：2
> 
> 时间：2012-09-29T14:56:26.940
> 
> 标签：c#, web-services, memory-leaks, server-side

我有两个非常简单的 Web 服务方法，我使用 json 每秒调用一次 IIS 中存在内存泄漏，w3wp 进程每秒占用 300-400k 可以做些什么来阻止泄漏？

方法如下：

```
[WebMethod]
[ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)]
public List<StationStatus> GetAllStationsValues(string networkID ,string stationIDs)
{
    List<StationStatus> stationStats = new List<StationStatus>();
    foreach (string stationID in stationIDs.Split(','))
    {
        if (Application[networkID + "-" + stationID] != null)
        {
            string[] vals = (string[])Application[networkID + "-" + stationID];

            stationStats.Add(new StationStatus() { NetworkID = networkID, StationID = stationID, ComponentName = vals[0].Split(':')[0], LatestValue = vals[0].Split(':')[1], Status = "0" });////////
        }
    }

    return stationStats;
}

[WebMethod]
[ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)]
public string GetValue(string networkID, string stationID)
{
    int sec = DateTime.Now.Second;

    if (Application[networkID + "-" + stationID] == null)
    {
        return "";
    }

    string[] compValues = (string[])Application[networkID + "-" + stationID];

    string returnValue = "";

    foreach (string compValue in compValues)
    {
        returnValue += compValue + ",";
    }

    return returnValue.TrimEnd(',');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:59:30.200

尝试使用[StringBuilder](http://msdn.microsoft.com/en-us/library/2839d5h5%28v=vs.71%29.aspx)类附加到您的 returnValue 字符串。

# screen - 屏幕抓取工具

> ID：12653768
> 
> 赞同：0
> 
> 时间：2012-09-29T14:56:58.083
> 
> 标签：screen, screen-scraping, ocr, tessnet2

我使用过 Screen Scraper Studio，它有一个互操作 dll，允许您传入坐标，它会抓取该区域，我实际上只是想抓取一个 4 位数字，但是这个应用程序需要相当昂贵的开发人员许可证。是否有其他开箱即用的程序，只需要很少的编码，我可以在其中传递一些坐标？我不想使用 TESSnet2 ocr 包，因为它需要使用 C# 进行相当多的设置。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T09:17:34.193

您是否正在寻找屏幕刮板工作室的替代品？您到底要从哪里刮取什么？几个月前我也遇到过类似的情况，我使用了一个简单的拖放工具来抓取数据。如果那是你正在寻找的，我可以给你一些信息。

# url-rewriting - 没有扩展名的 URL，例如 http://store.apple.com/us

> ID：12653769
> 
> 赞同：0
> 
> 时间：2012-09-29T14:57:03.937
> 
> 标签：url-rewriting

我怎样才能使用这个结构。这是我的意思的一个例子：![例子](../Images/754ae88872810a005f8dfb8e39f94c2e.png)

它的末尾没有 .html 或 .php 或“/”。

我一直在使用这种结构：[http ://s0ulp1xel.x10.mx/?p=home](http://s0ulp1xel.x10.mx/?p=home)

URL 类型叫什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:58:40.117

您正在寻找 URL*别名*：

[Apache - 将 url 映射到静态内容的本地路径](https://stackoverflow.com/questions/6736786/apache-mapping-url-to-local-path-for-static-content)

[https://httpd.apache.org/docs/2.2/urlmapping.html](https://httpd.apache.org/docs/2.2/urlmapping.html)

[http://httpd.apache.org/docs/2.2/mod/mod_alias.html#alias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#alias)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:02:21.010

URL 不一定引用特定文件。例如，在 Node.js 中，您可以创建一个响应任何页面的服务器：

```
http.createServer(function(request, response) {
    response.writeHead(200, {'Content-Type': 'text/plain'});
    response.end('You’ve reached the Node.js server!');
}).listen(80, '0.0.0.0'); 
```

……但是在带有 Apache 的 PHP 中，您可能正在寻找别名和/或重写！例如：

```
RewriteEngine On
RewriteRule ^page/(\d+)$ page.php?id=$1 
```

会重写一个 URL，`http://example.com/page/5`比如`http://example.com/page.php?id=5`.

在这种特殊情况下，您可以使用目录结构`/us/index.php`

# php - .crx 文件中的 CRX_ZREO_SIGNTURE_LENGTH 失败

> ID：12653773
> 
> 赞同：0
> 
> 时间：2012-09-29T14:57:18.367
> 
> 标签：php

我发现这篇文章[Create Google Chrome Crx file with PHP](https://stackoverflow.com/questions/5013263/create-google-chrome-crx-file-with-php) to create a .crx file vith my ZIP archive。但是当我尝试运行它时，我得到了 $signtrue = 0 的长度，但我不知道为什么......我的 .pem 文件已找到且有效，还有我的 .pub 密钥文件，但它仍然返回给我签名中的零长度...

```
$fp = fopen("/public_html/apps/chrome/nsii.pem", "r");
$priv_key = fread($fp, filesize($fp));
fclose($fp);

$pkeyid = openssl_get_privatekey($priv_key);
openssl_sign(file_get_contents("$name.zip"), $signature, $pkeyid, 'sha1');
openssl_free_key($pk);

# decode the public key

$key = base64_decode(file_get_contents('extension_public_key.pub'));

$fh = fopen("$name.crx", 'wb');
fwrite($fh, 'Cr24');             // extension file magic number
fwrite($fh, pack('V', 2));       // crx format version
fwrite($fh, pack('V', strlen($key)));            // public key length
fwrite($fh, pack('V', strlen($signature)));      // signature length
fwrite($fh, $key);               // public key
fwrite($fh, $signature);         // signature
fwrite($fh, file_get_contents("$name.zip")); // package contents, zipped
fclose($fh); 
```

**更新：**

原代码如下：

```
<?php
# make a SHA1 signature using our private key
$pk = openssl_pkey_get_private(file_get_contents('/public_html/apps/chrome/nsii.pem'));
openssl_sign(file_get_contents('/public_html/apps/chrome/extGoogle.zip'), $signature, $pk, 'sha1');
openssl_free_key($pk);

# decode the public key
$key = base64_decode(file_get_contents('/public_html/apps/chrome/extension_public_key.pub'));

# .crx package format:
#
#   magic number               char(4)
#   crx format ver             byte(4)
#   pub key lenth              byte(4)
#   signature length           byte(4)
#   public key                 string
#   signature                  string
#   package contents, zipped   string
#
# see http://code.google.com/chrome/extensions/crx.html
#
$fh = fopen('extension.crx', 'wb');
fwrite($fh, 'Cr24');                             // extension file magic number
fwrite($fh, pack('V', 2));                       // crx format version
fwrite($fh, pack('V', strlen($key)));            // public key length
fwrite($fh, pack('V', strlen($signature)));      // signature length
fwrite($fh, $key);                               // public key
fwrite($fh, $signature);                         // signature
fwrite($fh, file_get_contents('/public_html/apps/chrome/extGoogle.zip')); // package contents, zipped
fclose($fh); 
```

似乎也不能正常工作...问题是为什么？...如果我使用 CLI 编译它，一切正常...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T22:01:59.217

您的问题原样不会留下任何迹象*，究竟出了什么*问题。

但是我可以看到没有太多的错误检查。我建议 - 因为它对于编写良好的代码很常见 - 首先为返回值添加一些测试。此外，您可能需要启用错误报告并跟踪错误日志以查看一些问题。

*   关于[错误处理和记录的章节](http://php.net/manual/en/book.errorfunc.php)

让我们稍微回顾一下代码并添加注释。它不完整，只是一些指针。从上面的这三行开始：

```
$fp = fopen("/public_html/apps/chrome/nsii.pem", "r");
$priv_key = fread($fp, filesize($fp));
fclose($fp); 
```

您已经知道（至少您以后会使用它），有方便的功能`file_get_contents`。它可以替换这三行，我添加了更多行以使代码更具说服力：

```
$privateKeyPemFile = "/public_html/apps/chrome/nsii.pem";
$privateKey = file_get_contents($privateKeyPemFile);
if (false === $privateKey) {
    throw new UnexpectedValueException(
        sprintf("Unable to read private key file %s", $privateKeyPemFile)
    );
} 
```

接下来使用`file_get_contents`它实际上是验证打开文件是否成功工作。如果不是，[`UnexpectedValueException`](http://php.net/UnexpectedValueException)则会抛出一个错误消息，告诉您发生了什么。异常的名称并不重要，对于初学者来说，您可以直接抛出一个`Exception`并继续。

在这里抛出异常实际上会告诉消息，以防万一失败。

如您所见，您需要验证函数的返回值并检查错误情况。请参阅您在手册中使用的 PHP 函数，并查看记录了哪些返回值以及它们的含义。通常会出现错误情况，例如此处的[`file_get_contents`](http://php.net/file_get_contents).

然后你特别关心零长度`$signature`。让我们看看，对于每个函数，我们是否可以检查返回值并获取一些错误信息：

```
$keyResource = openssl_pkey_get_private($privateKey); 
```

The`openssl_get_privatekey`实际上是 的别名[`openssl_pkey_get_private`](http://php.net/openssl_pkey_get_private)，所以这里已经改变了。我还重命名了变量名，这样更方便，我们有足够的空间，不需要复杂的缩写。

同样，我们在这里有一个返回值，它是`false`在发生错误的情况下。在非错误条件下，它是关键资源，因此我相应地命名了返回值。让我们再次添加错误检查：

```
if (false === $keyResource) {
    throw new UnexpectedValueException("Unable to parse and prepare private key");
} 
```

所以到下一行，首先保持不变：

```
openssl_sign(file_get_contents("$name.zip"), $signature, $pkeyid, 'sha1'); 
```

`file_get_contents`显然，对 zip 文件没有错误检查。相反，我们需要更多的代码行来保证这个安全：

```
$zipFile     = "$name.zip";
$zipContents = file_get_contents($zipFile);
if (false === $zipContents) { 
    throw new ... 
} 
```

由于这只是为了加载数据，所以[`openssl_sign`](http://php.net/openssl_sign)需要采用调用：

```
$signatureAlgorithm = OPENSSL_ALGO_SHA1;
$result = openssl_sign($zipContents, $signature, $keyResource, $signatureAlgorithm);
if (!$result) {
    throw new ...
} 
```

也许第一个区别是您使用了字符串`'SHA1'`，而手册告诉我正在使用常量。也许它具有相同的值，我不能告诉你，我在这里使用了记录的常量（可能不是文档总是正确的，但是如果你不知道发生了什么，我首先建议遵循文档，然后查看）。

同样，正在检查函数的返回值是否存在错误情况。假设您的代码可能在该功能上失败了，我们只会知道它失败了，而不是出了什么问题。

PHP 手册显示有一个被调用的函数[`openssl_error_string`](http://php.net/openssl_error_string)可以返回 (peu-a-peu) 错误字符串。因为它一个接一个地返回，所以你需要循环来获取所有（最近的第一个），这可以通过一个公共[`for`循环](http://php.net/for)来完成：

```
for ($buffer = ''; $string = openssl_error_string(); $buffer .= $string, "\n"); 
```

所以我们可以将它添加到异常中。可能在某种函数中使用它也很有用，做你需要的。

```
if (!$result) {
    $buffer = sprintf(
        "Failed to sign zip contents (%d); Openssl error(s):\n", strlen($zipContents)
    );
    for (; $string = openssl_error_string(); $buffer .= $string, "\n");
    throw new UnexpectedValueException($buffer);
} 
```

因此，您的代码是检查错误条件并显示不同函数/库有不同方式发出故障信号以及如何获取有关信息的地方的完美示例。

如果您以安全的方式编写代码，它具有所有前置条件和后置条件检查，这意味着您不仅要检查返回值，还要在使用值之前检查它们。一个例子是 zipfile 的文件名。在打开文件之前检查文件是否存在并且可读：

```
$zipFile = "$name.zip";
if (!is_readable($zipFile)) {
    throw new Exception(sprintf("Zipfile is not readable %s", $zipFile));
}
$zipContents = file_get_contents($zipFile);
... 
```

这只是一个示例，为失败而设计（在这种情况下，它可能有点过头了，因为它`file_get_contents`也会告诉我们我们无法读取文件以防万一，但有时这些前置条件检查更有价值。

到目前为止的代码立即进行审查，将参数变量移到顶部：

```
$privateKeyPemFile  = "/public_html/apps/chrome/nsii.pem";
$zipFile            = "$name.zip";
$signatureAlgorithm = OPENSSL_ALGO_SHA1;

$privateKey = file_get_contents($privateKeyPemFile);
if (false === $privateKey) {
    throw new UnexpectedValueException(
        sprintf("Unable to read private key file %s", $privateKeyPemFile)
    );
}

$keyResource = openssl_pkey_get_private($privateKey);
if (false === $keyResource) {
    $buffer = sprintf(
        "Unable to parse and prepare private key (%d) %s; Openssl error(s):\n"
        , strlen($privateKey), $privateKeyPemFile
    );
    for (; $string = openssl_error_string(); $buffer .= $string, "\n") ;
    throw new UnexpectedValueException($buffer);
}

if (!is_readable($zipFile)) {
    throw new Exception(sprintf("Zipfile is not readable %s", $zipFile));
}
$zipContents = file_get_contents($zipFile);
if (false === $zipContents) {
    throw new UnexpectedValueException(
        sprintf("Failed to open zipfile %s", $zipFile)
    );
}

$result = openssl_sign($zipContents, $signature, $keyResource, $signatureAlgorithm);
if (!$result) {
    $buffer = sprintf(
        "Failed to sign zip contents (%d); Openssl error(s):\n"
        , strlen($zipContents)
    );
    for (; $string = openssl_error_string(); $buffer .= $string, "\n") ;
    throw new UnexpectedValueException($buffer);
} 
```

将变量放在顶部可以让您预先查看随后代码的输入参数，并为您提供更好的概览。

在处理过程中检查返回值可以让您尽早发现问题。

读出 openssll 错误将为您提供有用的信息来解决问题。

您可以在 PHP 手册中找到几乎所有这方面的信息。此答案可能无法解决您的具体问题，但应该为您提供更好地解决问题本身以及您在代码中可能遇到的未来问题所需的工具。

它只花费你几行代码，但你的代码会更好地工作。想象一下，您将您的脚本复制到一个新的服务器上，并且情况可能有所不同，您不想盲目飞行。

调试愉快。如您所见，我只介绍了您的代码的前半部分，您应该知道我没有运行您的代码。因此，此示例是出于最佳意图完成的，但不能保证它立即适用于您的场景。但我认为我想展示的东西是可见的。如果您对其余代码应用类似的检查，您应该能够了解到底出了什么问题，这是解决方案的一半。

# html - 如何从存储在变量中的 HTML 标记中获取值？

> ID：12653778
> 
> 赞同：1
> 
> 时间：2012-09-29T14:58:19.427
> 
> 标签：html, xml, google-apps-script

我想获取域中所有用户的日历详细信息。我正在尝试通过使用 UrlFetchApp 并将获取请求发送到服务器来做到这一点。

```
var urlFetch = UrlFetchApp.fetch(url, fetchArgs); 
```

我为此传递了所有必需的参数。但它给出了**302 Moved Temporarily**服务器错误。有时它的工作，但并非总是如此。要消除此问题，我必须再次向服务器发送具有相同内容和参数的 get 请求。当发送第一个获取请求时，它返回一个 url，一个会话 id 被附加到它上面。所以我需要用这个新的 url 发送一个请求。

我为此使用了以下代码：

```
function getCalender(){
    var users = UserManager.getAllUsers(); 
     var scope = 'https://www.google.com/calendar/feeds/';
     var fetchArgs = googleOAuth_('calender', scope);

     for(i=0;i<users.length;i++ ){
          var url ='https://www.google.com/calendar/feeds/'+users[i].getEmail()+'/private/full';

          try{
          var urlFetch=UrlFetchApp.fetch(url,fetchArgs)

         }
          catch(err){
            Logger.log(err)

          }
      }
}

function googleOAuth_(name,scope) {
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey("");
  oAuthConfig.setConsumerSecret("");
  return {oAuthServiceName:name, 
  oAuthUseToken:"always",
  content:'application/atom+xml', 
  method:"GET",
  Authorization:'GoogleLogin auth=?'};
} 
```

当我打印错误值时，它给出：

```
Exception: Request failed for  returned code 302\. Server response: <HTML>
<HEAD>
<TITLE>Moved Temporarily</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Moved Temporarily</H1>
The document has moved <A HREF="https://www.google.com/calendar/feeds/<email-id>/private/full?gsessionid=y1oQCjGH3LqTKJgyh9BlhA">here</A>.
</BODY>
</HTML> 
```

我想让这个移动的 id 发送一个带有新 url 的新请求。请给我任何想法来解决这个问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T11:10:49.410

This would be done by converting server response in a string, then split the string to get special text from the paragraph.

# git - git 并行分支

> ID：12653783
> 
> 赞同：4
> 
> 时间：2012-09-29T14:58:52.513
> 
> 标签：git, merge, branch

我的场景是我有两个分支`master`，`feature_swap`我想与这两个分支并行工作，它们具有不同的基本功能。有时我可能会在 master 中更新一些我想用另一个分支测试的实用程序类。如果我得到预期的输出，我什至可以在另一个分支中进行相同的更改。

我已经创建了两个分支。并更新了 master，在`util`. 我想用`feature_swap`. （不合并）

最好的方法是什么？或者我应该怎么做？

如果我只是这样做`git pull feature_swap`，它会以错误的方式自动合并。我想要的是 feature_swap 的基本功能（在报告之前交换一些数据）将保持原样。更改时可能会更改所有其他`master`实现

## 更新

我是一个菜鸟:(第一次做分支。我的项目在bitbucket上。有一个比较分支的工具。如果我把master放在左边和`feature_swap`右边。它显示

```
$ git checkout feature_swap
$ git merge remotes/user_name/project_name/master 
```

但我认为如果我这样做，它将合并`master`-> `feature_swap`（我错了）。但我想要这些变化，但要保持`feature_swap`并行发展。

`feature_swap`即使我从合并流程中并行发展也是一个问题`master`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:47:13.490

```
rebase --interactive 
```

这听起来像是交互式变基可能会有所帮助的情况。它为您提供了更多的控制权，让您可以更好地控制 rebase 中包含的内容和遗漏的内容，甚至可以帮助您更改或压缩旧的提交。有很多帖子可以参考这个话题，比如[这个](https://stackoverflow.com/questions/3022409/cherrypicking-versus-rebasing)。它是挑选您想要的所有实用程序提交的替代方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:24:15.047

`git pull --rebase master`
将使您的自定义更改保持在主更改之上，并让您有机会在合并之前更正它们。

`git pull --no-commit --no-ff master`
将拉动更改并让您在合并之前解决任何冲突。

`git cherry-pick COMMIT-ID`
将让您将一个提交从一个分支带到另一个分支。

希望其中一种方法会有所帮助。

# ios - xcode 4.5，在界面生成器中无法编辑视图大小

> ID：12653786
> 
> 赞同：11
> 
> 时间：2012-09-29T14:59:16.237
> 
> 标签：ios, xcode, interface-builder

我从 xcode 4.4 开始我的项目，并且我已经创建了几个带有界面生成器的视图控制器（带有 xib 文件）。几天前，我将xcode升级到了4.5版。今天突然发现可以在interface builder中修改view size了。这是 xcode 4.5 的预期功能还是 xcode 4.5 的错误？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-29T15:04:31.810

视图在其 Simulated Metrics 面板（在 Attributes 检查器中）有一个 Size 弹出菜单；将其设置为自由形式，视图将手动调整大小。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-15T22:41:49.410

第一次尝试调整视图大小时，我也有同样的印象。您只需要转到**INSPECTOR : Simulated Metrics ：**并将“Size”更改为“ **FreeForm** ”，您就可以根据需要调整视图的大小！希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T13:23:33.863

而在 XCode 5.x 中，它被完全删除了……

...不是真的，但是...

...查看窗口下方，您会发现 4 个匿名图标，您可以在其中调整视图行为等。

我确实花了一段时间才找到，但现在我知道去哪里找了……

# optimization - GHC 可以可靠地执行哪些优化？

> ID：12653787
> 
> 赞同：192
> 
> 时间：2012-09-29T14:59:16.683
> 
> 标签：optimization, haskell, ghc

GHC 有很多可以执行的优化，但我不知道它们都是什么，也不知道它们执行的可能性有多大以及在什么情况下执行。

我的问题是：我可以期望它每次或几乎都应用哪些转换？如果我看到一段将被频繁执行（评估）的代码，我的第一个想法是“嗯，也许我应该优化它”，在这种情况下，我的第二个想法应该是，“别想了， GHC 得到这个”？

我正在阅读论文[Stream Fusion: From Lists to Streams to Nothing at All](http://metagraph.org/papers/stream_fusion.pdf)，他们使用的将列表处理重写为不同形式的技术，GHC 的正常优化随后将可靠地优化为简单的循环，这对我来说是新颖的。我如何判断我自己的程序何时有资格进行这种优化？

GHC 手册中有[一些信息，但它只是回答问题的一部分。](http://www.haskell.org/ghc/docs/latest/html/users_guide/options-optimise.html)

编辑：我开始赏金了。我想要的是一个低级转换的列表，例如 lambda/let/case-floating、类型/构造函数/函数参数专业化、严格性分析和拆箱、worker/wrapper，以及我遗漏的其他任何重要的 GHC 转换，以及输入和输出代码的解释和示例，以及理想情况下的总效果大于其部分总和的情况说明。理想情况下，会提及何时*不会进行转换*发生。我不期望对每个转换都进行新颖的解释，几句话和内联的单行代码示例就足够了（或者一个链接，如果不是二十页的科学论文），只要大局是到最后就清楚了。我希望能够查看一段代码，并能够很好地猜测它是否会编译成一个紧密的循环，或者为什么不编译，或者我必须改变什么来实现它。（我对像流融合这样的大型优化框架不太感兴趣（我刚刚读过一篇关于此的论文）；更多的是*编写*这些框架的人所拥有的知识。）

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-09-30T01:44:27.377

[这个 GHC Trac 页面](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Compiler/HscMain)也很好地解释了通行证。[这个页面](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Compiler/OptOrdering)解释了优化顺序，但是，就像大多数 Trac Wiki 一样，它已经过时了。

具体来说，最好的办法可能是查看特定程序是如何编译的。查看正在执行哪些优化的最佳方法是使用`-v`标志详细编译程序。以我可以在我的计算机上找到的第一部分 Haskell 为例：

```
Glasgow Haskell Compiler, Version 7.4.2, stage 2 booted by GHC version 7.4.1
Using binary package database: /usr/lib/ghc-7.4.2/package.conf.d/package.cache
wired-in package ghc-prim mapped to ghc-prim-0.2.0.0-7d3c2c69a5e8257a04b2c679c40e2fa7
wired-in package integer-gmp mapped to integer-gmp-0.4.0.0-af3a28fdc4138858e0c7c5ecc2a64f43
wired-in package base mapped to base-4.5.1.0-6e4c9bdc36eeb9121f27ccbbcb62e3f3
wired-in package rts mapped to builtin_rts
wired-in package template-haskell mapped to template-haskell-2.7.0.0-2bd128e15c2d50997ec26a1eaf8b23bf
wired-in package dph-seq not found.
wired-in package dph-par not found.
Hsc static flags: -static
*** Chasing dependencies:
Chasing modules from: *SleepSort.hs
Stable obj: [Main]
Stable BCO: []
Ready for upsweep
  [NONREC
      ModSummary {
         ms_hs_date = Tue Oct 18 22:22:11 CDT 2011
         ms_mod = main:Main,
         ms_textual_imps = [import (implicit) Prelude, import Control.Monad,
                            import Control.Concurrent, import System.Environment]
         ms_srcimps = []
      }]
*** Deleting temp files:
Deleting: 
compile: input file SleepSort.hs
Created temporary directory: /tmp/ghc4784_0
*** Checking old interface for main:Main:
[1 of 1] Compiling Main             ( SleepSort.hs, SleepSort.o )
*** Parser:
*** Renamer/typechecker:
*** Desugar:
Result size of Desugar (after optimization) = 79
*** Simplifier:
Result size of Simplifier iteration=1 = 87
Result size of Simplifier iteration=2 = 93
Result size of Simplifier iteration=3 = 83
Result size of Simplifier = 83
*** Specialise:
Result size of Specialise = 83
*** Float out(FOS {Lam = Just 0, Consts = True, PAPs = False}):
Result size of Float out(FOS {Lam = Just 0,
                              Consts = True,
                              PAPs = False}) = 95
*** Float inwards:
Result size of Float inwards = 95
*** Simplifier:
Result size of Simplifier iteration=1 = 253
Result size of Simplifier iteration=2 = 229
Result size of Simplifier = 229
*** Simplifier:
Result size of Simplifier iteration=1 = 218
Result size of Simplifier = 218
*** Simplifier:
Result size of Simplifier iteration=1 = 283
Result size of Simplifier iteration=2 = 226
Result size of Simplifier iteration=3 = 202
Result size of Simplifier = 202
*** Demand analysis:
Result size of Demand analysis = 202
*** Worker Wrapper binds:
Result size of Worker Wrapper binds = 202
*** Simplifier:
Result size of Simplifier = 202
*** Float out(FOS {Lam = Just 0, Consts = True, PAPs = True}):
Result size of Float out(FOS {Lam = Just 0,
                              Consts = True,
                              PAPs = True}) = 210
*** Common sub-expression:
Result size of Common sub-expression = 210
*** Float inwards:
Result size of Float inwards = 210
*** Liberate case:
Result size of Liberate case = 210
*** Simplifier:
Result size of Simplifier iteration=1 = 206
Result size of Simplifier = 206
*** SpecConstr:
Result size of SpecConstr = 206
*** Simplifier:
Result size of Simplifier = 206
*** Tidy Core:
Result size of Tidy Core = 206
writeBinIface: 4 Names
writeBinIface: 28 dict entries
*** CorePrep:
Result size of CorePrep = 224
*** Stg2Stg:
*** CodeGen:
*** CodeOutput:
*** Assembler:
'/usr/bin/gcc' '-fno-stack-protector' '-Wl,--hash-size=31' '-Wl,--reduce-memory-overheads' '-I.' '-c' '/tmp/ghc4784_0/ghc4784_0.s' '-o' 'SleepSort.o'
Upsweep completely successful.
*** Deleting temp files:
Deleting: /tmp/ghc4784_0/ghc4784_0.c /tmp/ghc4784_0/ghc4784_0.s
Warning: deleting non-existent /tmp/ghc4784_0/ghc4784_0.c
link: linkables are ...
LinkableM (Sat Sep 29 20:21:02 CDT 2012) main:Main
   [DotO SleepSort.o]
Linking SleepSort ...
*** C Compiler:
'/usr/bin/gcc' '-fno-stack-protector' '-Wl,--hash-size=31' '-Wl,--reduce-memory-overheads' '-c' '/tmp/ghc4784_0/ghc4784_0.c' '-o' '/tmp/ghc4784_0/ghc4784_0.o' '-DTABLES_NEXT_TO_CODE' '-I/usr/lib/ghc-7.4.2/include'
*** C Compiler:
'/usr/bin/gcc' '-fno-stack-protector' '-Wl,--hash-size=31' '-Wl,--reduce-memory-overheads' '-c' '/tmp/ghc4784_0/ghc4784_0.s' '-o' '/tmp/ghc4784_0/ghc4784_1.o' '-DTABLES_NEXT_TO_CODE' '-I/usr/lib/ghc-7.4.2/include'
*** Linker:
'/usr/bin/gcc' '-fno-stack-protector' '-Wl,--hash-size=31' '-Wl,--reduce-memory-overheads' '-o' 'SleepSort' 'SleepSort.o' '-L/usr/lib/ghc-7.4.2/base-4.5.1.0' '-L/usr/lib/ghc-7.4.2/integer-gmp-0.4.0.0' '-L/usr/lib/ghc-7.4.2/ghc-prim-0.2.0.0' '-L/usr/lib/ghc-7.4.2' '/tmp/ghc4784_0/ghc4784_0.o' '/tmp/ghc4784_0/ghc4784_1.o' '-lHSbase-4.5.1.0' '-lHSinteger-gmp-0.4.0.0' '-lgmp' '-lHSghc-prim-0.2.0.0' '-lHSrts' '-lm' '-lrt' '-ldl' '-u' 'ghczmprim_GHCziTypes_Izh_static_info' '-u' 'ghczmprim_GHCziTypes_Czh_static_info' '-u' 'ghczmprim_GHCziTypes_Fzh_static_info' '-u' 'ghczmprim_GHCziTypes_Dzh_static_info' '-u' 'base_GHCziPtr_Ptr_static_info' '-u' 'base_GHCziWord_Wzh_static_info' '-u' 'base_GHCziInt_I8zh_static_info' '-u' 'base_GHCziInt_I16zh_static_info' '-u' 'base_GHCziInt_I32zh_static_info' '-u' 'base_GHCziInt_I64zh_static_info' '-u' 'base_GHCziWord_W8zh_static_info' '-u' 'base_GHCziWord_W16zh_static_info' '-u' 'base_GHCziWord_W32zh_static_info' '-u' 'base_GHCziWord_W64zh_static_info' '-u' 'base_GHCziStable_StablePtr_static_info' '-u' 'ghczmprim_GHCziTypes_Izh_con_info' '-u' 'ghczmprim_GHCziTypes_Czh_con_info' '-u' 'ghczmprim_GHCziTypes_Fzh_con_info' '-u' 'ghczmprim_GHCziTypes_Dzh_con_info' '-u' 'base_GHCziPtr_Ptr_con_info' '-u' 'base_GHCziPtr_FunPtr_con_info' '-u' 'base_GHCziStable_StablePtr_con_info' '-u' 'ghczmprim_GHCziTypes_False_closure' '-u' 'ghczmprim_GHCziTypes_True_closure' '-u' 'base_GHCziPack_unpackCString_closure' '-u' 'base_GHCziIOziException_stackOverflow_closure' '-u' 'base_GHCziIOziException_heapOverflow_closure' '-u' 'base_ControlziExceptionziBase_nonTermination_closure' '-u' 'base_GHCziIOziException_blockedIndefinitelyOnMVar_closure' '-u' 'base_GHCziIOziException_blockedIndefinitelyOnSTM_closure' '-u' 'base_ControlziExceptionziBase_nestedAtomically_closure' '-u' 'base_GHCziWeak_runFinalizzerBatch_closure' '-u' 'base_GHCziTopHandler_flushStdHandles_closure' '-u' 'base_GHCziTopHandler_runIO_closure' '-u' 'base_GHCziTopHandler_runNonIO_closure' '-u' 'base_GHCziConcziIO_ensureIOManagerIsRunning_closure' '-u' 'base_GHCziConcziSync_runSparks_closure' '-u' 'base_GHCziConcziSignal_runHandlers_closure'
link: done
*** Deleting temp files:
Deleting: /tmp/ghc4784_0/ghc4784_1.o /tmp/ghc4784_0/ghc4784_0.s /tmp/ghc4784_0/ghc4784_0.o /tmp/ghc4784_0/ghc4784_0.c
*** Deleting temp dirs:
Deleting: /tmp/ghc4784_0 
```

从第一个`*** Simplifier:`到最后，所有优化阶段都发生在这里，我们看到了很多。

首先，简化器在几乎所有阶段之间运行。这使得编写许多遍更容易。例如，在实施许多优化时，他们只需创建重写规则来传播更改，而不必手动执行。简化器包含许多简单的优化，包括内联和融合。我知道的主要限制是 GHC 拒绝内联递归函数，并且必须正确命名事物才能使融合工作。

接下来，我们会看到执行的所有优化的完整列表：

*   专精

    特化的基本思想是通过识别调用函数的位置并创建非多态函数的版本来消除多态性和重载——它们特定于调用它们的类型。您还可以使用编译指示告诉编译器执行此操作`SPECIALISE`。以阶乘函数为例：

    ```
    fac :: (Num a, Eq a) => a -> a
    fac 0 = 1
    fac n = n * fac (n - 1) 
    ```

    由于编译器不知道要使用的乘法的任何属性，它根本无法优化它。但是，如果它发现它用于`Int`，它现在可以创建一个新版本，仅在类型上有所不同：

    ```
    fac_Int :: Int -> Int
    fac_Int 0 = 1
    fac_Int n = n * fac_Int (n - 1) 
    ```

    接下来，下面提到的规则可以触发，你最终会得到一些在 unboxed `Int`s 上工作的东西，这比原来的要快得多。另一种看待专业化的方法是对类型类字典和类型变量的部分应用。

    这里的[源代码](https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.6.2/src/Specialise.html#specProgram)中有很多注释。

*   浮出水面

    编辑：我之前显然误解了这一点。我的解释已经完全改变了。

    其基本思想是将不应重复的计算移出函数。例如，假设我们有这个：

    ```
    \x -> let y = expensive in x+y 
    ```

    在上面的 lambda 中，每次调用函数时，`y`都会重新计算。浮动产生的更好的功能是

    ```
    let y = expensive in \x -> x+y 
    ```

    为了促进该过程，可以应用其他变换。例如，发生这种情况：

    ```
     \x -> x + f 2
     \x -> x + let f_2 = f 2 in f_2
     \x -> let f_2 = f 2 in x + f_2
     let f_2 = f 2 in \x -> x + f_2 
    ```

    同样，节省了重复计算。

    在这种情况下，[源代码](https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.6.2/src/FloatOut.html#floatOutwards)非常易读。

    目前，两个相邻 lambda 之间的绑定没有浮动。例如，这不会发生：

    ```
    \x y -> let t = x+x in ... 
    ```

    即将

    ```
     \x -> let t = x+x in \y -> ... 
    ```

*   向内浮动

    引用源代码，

    的主要目的`floatInwards`是浮动到一个案例的分支中，这样我们就不会分配东西，将它们保存在堆栈中，然后发现它们在所选分支中不需要。

    例如，假设我们有这个表达式：

    ```
    let x = big in
        case v of
            True -> x + 1
            False -> 0 
    ```

    如果`v`计算结果为`False`，那么通过分配`x`，这可能是一些很大的麻烦，我们浪费了时间和空间。向内浮动解决了这个问题，产生了这个：

    ```
    case v of
        True -> let x = big in x + 1
        False -> let x = big in 0 
    ```

    , 随后被简化器替换为

    ```
    case v of
        True -> big + 1
        False -> 0 
    ```

    [这篇论文](http://research.microsoft.com/pubs/67060/float.ps.gz)虽然涵盖了其他主题，但给出了相当清晰的介绍。请注意，尽管它们的名称，浮动和浮动不会进入无限循环，原因有两个：

    1.  浮点数中的浮点数允许进入`case`语句，而浮点数处理函数。
    2.  传球的顺序是固定的，所以它们不应该无限交替。

*   需求分析

    需求分析或严格性分析与其说是一种转换，不如说更像是一种信息收集通道。编译器找到总是评估其参数（或至少其中一些）的函数，并使用按值调用而不是按需要调用来传递这些参数。由于您可以避免 thunk 的开销，因此这通常要快得多。Haskell 中的许多性能问题要么是由于此传递失败，要么是代码不够严格。`foldr`一个简单的例子是使用,`foldl`和之间的区别`foldl'`对整数列表求和-第一个导致堆栈溢出，第二个导致堆溢出，最后一个由于严格性而运行良好。这可能是所有这些中最容易理解和最好记录的。我相信多态性和 CPS 代码经常会打败这一点。

*   Worker Wrapper 绑定

    worker/wrapper 转换的基本思想是在一个简单的结构上做一个紧密的循环，在末端转换到该结构并从该结构转换。例如，使用这个函数，它计算一个数字的阶乘。

    ```
    factorial :: Int -> Int
    factorial 0 = 1
    factorial n = n * factorial (n - 1) 
    ```

    使用`Int`GHC 中的定义，我们有

    ```
    factorial :: Int -> Int
    factorial (I# 0#) = I# 1#
    factorial (I# n#) = I# (n# *# case factorial (I# (n# -# 1#)) of
        I# down# -> down#) 
    ```

    注意代码是如何被`I#`s 覆盖的？我们可以这样做删除它们：

    ```
    factorial :: Int -> Int
    factorial (I# n#) = I# (factorial# n#)

    factorial# :: Int# -> Int#
    factorial# 0# = 1#
    factorial# n# = n# *# factorial# (n# -# 1#) 
    ```

    虽然这个具体的例子也可以由 SpecConstr 完成，但是工人/包装器的转换在它可以做的事情上是非常普遍的。

*   公共子表达式

    这是另一个非常简单但非常有效的优化，例如严格性分析。基本思想是，如果您有两个相同的表达式，它们将具有相同的值。例如，如果`fib`是一个斐波那契数计算器，CSE 将转换

    ```
    fib x + fib x 
    ```

    进入

    ```
    let fib_x = fib x in fib_x + fib_x 
    ```

    这将计算量减半。不幸的是，这有时会妨碍其他优化。另一个问题是两个表达式必须在同一个地方，并且它们在*语法上*必须相同，而不是值相同。例如，如果没有一堆内联，CSE 不会在以下代码中触发：

    ```
    x = (1 + (2 + 3)) + ((1 + 2) + 3)
    y = f x
    z = g (f x) y 
    ```

    但是，如果您通过 llvm 编译，您可能会得到其中的一些组合，因为它的全局值编号传递。

*   解放案

    除了它可能导致代码爆炸之外，这似乎是一个非常有记录的转换。这是我找到的小文档的重新格式化（并略微重写）版本：

    这个模块走过去`Core`，寻找`case`自由变量。标准是：如果在`case`到递归调用的路径上有一个自由变量，则递归调用被展开替换。例如，在

    ```
    f = \ t -> case v of V a b -> a : f t 
    ```

    内部`f`被替换。使

    ```
    f = \ t -> case v of V a b -> a : (letrec f = \ t -> case v of V a b -> a : f t in f) t 
    ```

    注意阴影的需要。简化，我们得到

    ```
    f = \ t -> case v of V a b -> a : (letrec f = \ t -> a : f t in f t) 
    ```

    这是更好的代码，因为`a`在内部是免费的`letrec`，而不是需要从`v`. 请注意，这处理*自由变量*，与 SpecConstr 不同，后者处理已知形式的*参数。*

    有关 SpecConstr 的更多信息，请参见下文。

*   SpecConstr - 这会转换程序，如

    ```
    f (Left x) y = somthingComplicated1
    f (Right x) y = somethingComplicated2 
    ```

    进入

    ```
    f_Left x y = somethingComplicated1
    f_Right x y = somethingComplicated2

    {-# INLINE f #-}
    f (Left x) = f_Left x
    f (Right x) = f_Right x 
    ```

    作为一个扩展示例，采用以下定义`last`：

    ```
    last [] = error "last: empty list"
    last (x:[]) = x
    last (x:x2:xs) = last (x2:xs) 
    ```

    我们首先将其转换为

    ```
    last_nil = error "last: empty list"
    last_cons x [] = x
    last_cons x (x2:xs) = last (x2:xs)

    {-# INLINE last #-}
    last [] = last_nil
    last (x : xs) = last_cons x xs 
    ```

    接下来，简化器运行，我们有

    ```
    last_nil = error "last: empty list"
    last_cons x [] = x
    last_cons x (x2:xs) = last_cons x2 xs

    {-# INLINE last #-}
    last [] = last_nil
    last (x : xs) = last_cons x xs 
    ```

    请注意，程序现在更快了，因为我们没有重复装箱和拆箱列表的前面。另请注意，内联是至关重要的，因为它允许实际使用新的、更有效的定义，并使递归定义更好。

    SpecConstr 由许多启发式方法控制。论文中提到的那些是这样的：

    1.  lambdas 是显式的，arity 是`a`.
    2.  右侧是“足够小”，由旗帜控制。
    3.  该函数是递归的，并且在右侧使用了可特化的调用。
    4.  该函数的所有参数都存在。
    5.  至少其中一个参数是构造函数应用程序。
    6.  该论点在函数的某处进行了案例分析。

    然而，启发式方法几乎肯定发生了变化。事实上，该论文提到了另一种第六启发式：

    `x`仅当`x`仅由 a 审查并且未传递给普通函数或作为结果的一部分返回*时才*专门处理参数。`case`

这是一个非常小的文件（12 行），因此可能没有触发那么多优化（尽管我认为它完成了所有优化）。这也没有告诉你它为什么选择这些传球以及为什么将它们按顺序排列。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-09-30T14:22:17.510

**懒惰**

这不是“编译器优化”，而是语言规范保证的东西，所以你总是可以指望它发生。从本质上讲，这意味着在您对结果“做某事”之前不会执行工作。（除非你做了几件事中的一件来故意关闭懒惰。）

显然，这本身就是一个完整的主题，SO 已经有很多关于它的问题和答案。

以我有限的经验，让你的代码太懒或太严格会比我要谈论的任何其他事情产生更大的性能损失（在时间和空间*上*）*......*

**严格性分析**

懒惰是指避免工作，除非有必要。如果编译器可以确定“总是”需要给定结果，那么它就不会费心存储计算并在以后执行它；它会直接执行它，因为这样更有效。这就是所谓的“严格性分析”。

很明显，问题在于编译器不能*总是*检测到什么时候可以变得严格。有时您需要给编译器一些提示。（除了涉足核心输出之外，我不知道有任何简单的方法可以确定严格性分析是否完成了您认为的工作。）

**内联**

如果您调用一个函数，并且编译器可以判断您正在调用哪个函数，它可能会尝试“内联”该函数 - 即用函数本身的副本替换函数调用。函数调用的开销通常非常小，但内联通常可以实现其他不会发生的优化，因此内联可能是一个巨大的胜利。

仅当函数“足够小”（或者如果您添加专门要求内联的编译指示）时，函数才会被内联。此外，只有在编译器可以判断您正在调用的函数时，才能内联函数。编译器可能无法分辨出两种主要方式：

*   如果您调用的函数是从其他地方传入的。例如，`filter`编译函数时，不能内联过滤谓词，因为它是用户提供的参数。

*   如果您正在调用的函数是类方法*并且*编译器不知道所涉及的类型。例如，当`sum`函数被编译时，编译器不能内联`+`函数，因为`sum`它与几种不同的数字类型一起工作，每一种都有不同的`+`功能。

在后一种情况下，您可以使用`{-# SPECIALIZE #-}`pragma 生成硬编码为特定类型的函数版本。例如，将为该类型`{-# SPECIALIZE sum :: [Int] -> Int #-}`编译一个硬编码版本，这意味着可以在此版本中内联。`sum``Int``+`

但请注意，我们的新特殊`sum`函数只会在编译器知道我们正在使用`Int`. 否则，原始的多态`sum`会被调用。同样，实际的函数调用开销相当小。内联可以实现的额外优化是有益的。

**公共子表达式消除**

如果某个代码块两次计算相同的值，编译器可能会用相同计算的单个实例替换它。例如，如果你这样做

```
(sum xs + 1) / (sum xs + 2) 
```

那么编译器可能会将其优化为

```
let s = sum xs in (s+1)/(s+2) 
```

您可能希望编译器*总是*这样做。然而，显然在某些情况下，这可能会导致性能更差，而不是更好，因此 GHC 并不*总是*这样做。坦率地说，我不太了解这背后的细节。但最重要的是，如果这种转换对您很重要，那么手动进行并不难。（如果它不重要，你为什么要担心它？）

**案例表达式**

考虑以下：

```
foo (0:_ ) = "zero"
foo (1:_ ) = "one"
foo (_:xs) = foo xs
foo (  []) = "end" 
```

前三个等式都检查列表是否为非空（除其他外）。但是三次检查同一件事是浪费的。幸运的是，编译器很容易将其优化为几个嵌套的 case 表达式。在这种情况下，类似

```
foo xs =
  case xs of
    y:ys ->
      case y of
        0 -> "zero"
        1 -> "one"
        _ -> foo ys
    []   -> "end" 
```

这不太直观，但更有效。因为编译器可以轻松地进行这种转换，所以您不必担心。只需以最直观的方式编写您的模式匹配即可；编译器非常擅长重新排序和重新排列它以使其尽可能快。

**融合**

用于列表处理的标准 Haskell 习惯用法是将获取一个列表并生成一个新列表的函数链接在一起。典型的例子是

```
map g . map f 
```

不幸的是，虽然懒惰保证跳过不必要的工作，但中间列表的所有分配和释放都会降低性能。“融合”或“森林砍伐”是编译器试图消除这些中间步骤的地方。

问题是，这些函数中的大多数都是递归的。如果没有递归，内联将所有函数压缩到一个大代码块中，在其上运行简化器并生成真正优化的代码而没有中间列表，这将是一项基本的练习。但是由于递归，这行不通。

您可以使用`{-# RULE #-}`编译指示来解决其中的一些问题。例如，

```
{-# RULES "map/map" forall f g xs. map f (map g xs) = map (f.g) xs #-} 
```

现在，每次 GHC 看到`map`应用于 时`map`，它都会将其压缩成单次遍历列表，从而消除中间列表。

麻烦的是，这仅适用`map`于`map`. 还有很多其他的可能性——`map`后面是`filter`，`filter`后面是`map`，等等。发明了所谓的“流融合”，而不是为它们中的每一个手动编写解决方案。这是一个比较复杂的技巧，这里不再赘述。

总而言之：这些都是*程序员*编写的特殊优化技巧。GHC 本身对聚变一无所知。它都在列表库和其他容器库中。因此，发生什么优化取决于您的容器库的编写方式（或者，更实际地，您选择使用哪些库）。

例如，如果您使用 Haskell '98 数组，不要期望任何类型的融合。但我了解该`vector`库具有广泛的融合功能。都是关于图书馆的；编译器只提供`RULES`编译指示。（顺便说一句，这非常强大。作为库作者，您可以使用它来重写客户端代码！）

* * *

元：

*   我同意人们所说的“代码第一，配置第二，优化第三”。

*   我也同意人们所说的“对于给定的设计决策有多少成本有一个心理模型很有用”。

平衡所有事物，以及所有...

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-05T14:43:01.543

如果 let 绑定 v = rhs 仅在一个地方使用，您可以指望编译器内联它，即使 rhs 很大。

一个例外（在当前问题的上下文中几乎不是一个例外）是 lambdas 冒着重复工作的风险。考虑：

```
let v = rhs
    l = \x-> v + x
in map l [1..100] 
```

内联 v 将是危险的，因为一个（句法）使用将转化为 rhs 的 99 次额外评估。但是，在这种情况下，您也不太可能希望手动内联它。所以基本上你可以使用规则：

如果您考虑内联一个只出现一次的名称，编译器无论如何都会这样做。

作为一个愉快的推论，简单地使用 let 绑定来分解一个长语句（希望获得清晰）本质上是免费的。

这来自 community.haskell.org/~simonmar/papers/inline.pdf，其中包含更多关于内联的信息。

# jquery - jquery 无法获取选择元素上的更改事件

> ID：12653788
> 
> 赞同：0
> 
> 时间：2012-09-29T14:59:21.050
> 
> 标签：jquery, jquery-selectors

我有这段代码 jquery 代码从未被触发 没有任何脚本被触发：

```
 $('select[name=privileges]').change(function(){
      alert("id");
            var id = $(this).find(':selected')[0].id;
            alert(id);
        $('#changevalue').val(id);
      }) 
```

或这个：

```
 $("#privileges_select").change(function() {
        alert($('#privileges_select option:selected').html());
     });

  <form method="GET" action="create_new_user.php">          
         user:<input  type="text" size="40"   name="user_name"/> 
         password:<input  type="text" size="40"   name="password"/>       
          <select name=privileges  id="privileges_select">
          <option name='opt_1'>admin</option>
              <option name='opt_2'>ordinary</option>            
             </select>
         <input type="hidden" name="item_options_id" value="" id="changevalue" />

          <input type="submit" value ="create" />
          <input type="reset" />

       </form> 
```

最后，我喜欢以 get 的形式发送选定的选项 id

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:04:04.260

您是否为 jquery 添加了脚本引用？

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

<script type="text/javascript">

.....

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:09:28.357

尝试将名称 attr 放在引号中`<select name="privileges" id="privileges_select">`

`.change()`并且可能用分号终止该行；

基本上它似乎在这里工作正常 - [http://jsfiddle.net/N6bua/](http://jsfiddle.net/N6bua/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:34:46.983

代码重要的顺序。必须在页面包含 select 元素之后安装更改​​事件侦听器，否则它会静默失败。

尝试用`$(function() { ... install handler here ... });`

# php - 将数据添加到现有控件

> ID：12653790
> 
> 赞同：0
> 
> 时间：2012-09-29T14:59:33.847
> 
> 标签：php

我有一个在应用程序启动时填充的管道尺寸下拉框。

当我在另一个下拉框中选择管道类型时，我希望它能够动态改变。我已经设法制作了 ajax 功能，其中根据选择的管道绘制了所有尺寸的 html 表格。所以我只想将此功能嵌入到同一个文件中。

下面的代码创建了一个带有尺寸的新下拉框。但我已经有一个（id=dimensions）。

如何填充现有的而不创建新的？

```
echo "<select id='dimensions'>";

while ($row = mysql_fetch_array($result2)) {
   echo "<option value='" . $row['nominalsize'] ."'>" . 
    $row['nominalsize'] ."</option>";
}

echo "</select>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:05:36.587

要在页面加载后填充控件，您需要一些技术，例如 AJAX：

这是一个基本的工作流程：

1.  使用以下信息创建响应（HTML o AJAX）
2.  在页面调用来自 javascript 的 HTTP 请求（我推荐 jQuery 来完成这个任务）
3.  在请求的回调中构建

例子

选项.php

```
<?php
// http://localhost/options.php
// /var/www/options.php
$options = array(
   1 => 'Cat',
   2 => 'Dog'
);

header('Cache-Control: no-cache, must-revalidate');
header('Content-type: application/json');

return json_enconde($options); 
```

脚本.js

```
// script.js in your page
$(document).ready(function(){
  var $select = $('#id-select);
  $.ajax({
    url: '/options.php',
    dataType: 'json',
    success: function(data) {
       $.each(data, function(i, e) { 
          $select.append($('<option value=' + i + '>' + e + '</option>'));
       });
    }
  });
}); 
```

以前只是示例，但您可以想出一个主意

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:29:17.680

> 如何填充现有的而不创建新的？

这很简单，但应该这样做：在发送 AJAX 请求之前，`<select id='dimensions'>`从 DOM 中删除现有的。然后您可以稍后安全地插入它。

为了缩短时间，您也可以在插入之前将其移除。所以在你得到 AJAX 响应的时候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:40:06.400

如果您有一个数据库表，其大小值在您自己的网页使用中定义，则：

```
<?php 
// Assume that $nominalsize already exists with real value 

$sql = "SELECT * FROM table WHERE nominalsize='$nominalsize'"; 
$res = mysql_query($sql) or die(mysql_error()); 

if (mysql_num_rows($res) > 0) 
{ 
  // There is already a row with the specified $nominalsize
} 
else 
{ 
  // Not exist, then ... INSERT
} 
```

如果没有，并且您喜欢从另一个页面检索信息，则需要 CURL 或 DOM，并提取标签。

# google-apps-script - 通过主机名的 Google Apps 脚本 JDBC 连接已损坏

> ID：12653792
> 
> 赞同：1
> 
> 时间：2012-09-29T14:59:57.470
> 
> 标签：google-apps-script

最近几天，Google Apps Script JDBC Connection 似乎存在问题，通过主机名的连接失败，但指定 IP 有效。

错误：无法建立数据库连接。检查连接字符串、用户名和密码。

我们上周四首先注意到了这一点。

下面的代码已经完美运行了 18 个月左右。

```
var conn = Jdbc.getConnection("jdbc:mysql://myhost.com:3306/dbname","myuser","mypass"); 
```

现在需要改用 IP。

```
var conn = Jdbc.getConnection("jdbc:mysql://10.20.30.40:3306/dbname","myuser","mypass"); 
```

希望 GAS 团队中的一位可以发表评论。

抢 Google Apps GPF TC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T18:07:08.110

您可以在我们的问题跟踪器上关注此问题的进展：[http ://code.google.com/p/google-apps-script-issues/issues/detail?id=1856](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1856)

# c++ - 在 scons 中创建 SConscript 对象

> ID：12653798
> 
> 赞同：0
> 
> 时间：2012-09-29T15:00:36.477
> 
> 标签：c++, scons

我在 json 文件中指定了我的项目目标（二进制文件和库）。

我可以毫无问题地为指定目标创建环境。现在我正在尝试支持特定的构建目录。

我对 scons 的了解仍然非常基础，但似乎正确的方法是使用 SConscript 和 VariantDir。但是我已经在 json 中指定了我的目标，并且为每个目标创建一个 SConscript 文件将是多余的（加上维护成本）。

所以我的问题是：是否可以在运行时动态创建一个 SConscript 对象？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T10:12:20.943

VariantDir 不适用于 SConscturct 文件（可能我错了，但我没有找到任何方法）。只需使用变体目录创建 SConscript 文件并执行您需要的操作。

```
#SConsruct
env = CreateEnvironment()
SConscript('SConscript', variant_dir = 'mybuilddir', exports = 'env', duplicate = 0)

# Do all work in SConscript
Import('env')
env.Program(...)
env.SharedLibrary(...)
... 
```

此外，您可以将您的流程分成两种状态。状态 1 - 生成的 SConscript 文件。状态 2 - 运行生成的 SConscript 文件。

```
if 'generate' in COMMAND_LINE_TARGETS:
  # your code to generated SConscript from json
  Exit(0)

sconscriptFiles = getSconscriptFiles() # some code to get your sconscript, by mask for example
if len(sconscriptFiles) < 1:
    print "You need to generate files at first: scons generate"
    Exit(1)
for file in sconscriptFiles :
   SConscript(file, variant_dir = 'build' + file, duplicate = 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T19:30:18.167

[您可以使用VariantDir()](http://www.scons.org/doc/production/HTML/scons-user/x3436.html)函数或作为 SConscript() 调用的一部分指定构建目录。[这里](http://www.scons.org/doc/production/HTML/scons-user/c3361.html)讨论了所有不同的选项。考虑到您不想使用多个 SConstruct 文件，您应该只使用 VariantDir() 函数，如此处更详细描述的[那样](http://www.scons.org/doc/production/HTML/scons-user/a11700.html#f-VariantDir)。

这是一个简单的例子：

    env = 环境（）

```
# It may be as simple as setting src_dir='.', but set accordingly
# duplicate=0 tells SCons NOT to copy source files to variantDir, set accordingly
# VariantDir() can be called multiple times so as to change dirs per builder call
VariantDir(variant_dir = 'pathToBuildDir', src_dir = 'pathToSource', duplicate=0)
# Now call the builders here 
```

目前还不清楚为什么要将 json 与 SCons 混合使用。除非您有一些非常令人信服的理由这样做，否则我建议将其全部保存在 SCons 中，即 Python。

**编辑：** 我刚刚意识到你问的是创建一个 SConscript 对象，而不是一个文件。

我查看了 SCons 编程 API 并没有找到任何可以让您创建 SConscript 对象的东西。实际上，我认为不存在 SConscript 对象的概念，因为它只是将 SConscript() 函数的调用视为需要打开和处理的文件，并且几乎将它们视为 SConstruct 的扩展。

因此，总结一下：您要么必须创建附属的 SConscript 文件，要么使用对 VariantDir() 的调用。根据您的项目目录结构，可能不需要创建 SConscript 文件。你可以从根 SConstruct 做所有事情。SConscript 文件不是必需的，它们只是帮助更好地组织构建脚本。

# mysql - Mysql Group concat 然后根据结果查询

> ID：12653800
> 
> 赞同：0
> 
> 时间：2012-09-29T15:00:54.627
> 
> 标签：mysql

大家好，我有一个表业务，它有很多多对多的关系。建议我先执行一个组 concat 以从 many 表中获取想法，然后查看这些 id 以从 many 表中获取值

在下面的实例中，好的，我可以看到我通过 GROUP_CONCAT(DISTINCT ba.announcement_id) 作为“公告”获得公告 ID 列表，我如何从这里设置

SELECT * from notice where id IN( ***_* __ *_* __ *_*** )

其中 in 表示从 group_concat 返回的内容

身份证

开始

```
/* Business Information and Categories */
SELECT 
    b.alias_title, b.title, b.premisis_name, 
    a.address_line_1, a.address_line_2, a.postal_code,tvc.town_village_city,spc.state_province_county, c.country,
    GROUP_CONCAT(DISTINCT be.event_id) as 'event',
    GROUP_CONCAT(DISTINCT ba.announcement_id) as 'announcement', 
    GROUP_CONCAT(DISTINCT bd.document_id) as 'document',
    GROUP_CONCAT(DISTINCT bi.image_id) as 'image',
    GROUP_CONCAT(DISTINCT bprod.product_id ) as 'product',
    GROUP_CONCAT(DISTINCT bt.tag_title_id) as 'tag'
    FROM business AS b
    INNER JOIN business_category bc_1 ON b.primary_category = bc_1.id
    INNER JOIN business_category bc_2 ON b.secondary_category = bc_2.id
    LEFT OUTER JOIN business_category bc_3 ON b.tertiary_category = bc_3.id
    INNER JOIN address a ON b.address_id = a.id
    LEFT OUTER JOIN town_village_city tvc ON a.town_village_city_id = tvc.id
    LEFT OUTER JOIN state_province_county spc ON a.state_province_county_id
    INNER JOIN country c ON a.country_id = c.id
    LEFT OUTER JOIN geolocation g ON b.geolocation_id = g.id
    LEFT OUTER JOIN business_event be ON b.id = be.event_id
    LEFT OUTER JOIN business_announcement ba ON b.id = ba.announcement_id
    LEFT OUTER JOIN business_document bd ON b.id = bd.business_id
    LEFT OUTER JOIN business_image bi ON b.id = bi.business_id
    LEFT JOIN business_property bp ON b.id= bp.business_id
    LEFT JOIN business_product bprod ON b.id= bprod.business_id 
    LEFT JOIN business_tag bt ON b.id = bt.business_id
    WHERE b.id= in_business_id;

    SELECT * from announcement 
    where 

END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:39:32.430

在您的第一个选择语句中，您可以将announcementId 分配给一个变量，然后使用它来获取第二个查询中的所有公告：

```
set @announcementIds = '';
select ...........,
@announcementIds:= GROUP_CONCAT(DISTINCT announcement_id) as 'announcement',
...........;

Select * from announcement 
where announcement_id REGEXP REPLACE(@announcementIds,',','|'); 
```

一些链接：

*   [替换功能](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)
*   [正则表达式](http://dev.mysql.com/doc/refman/5.0/en/regexp.html#operator_regexp)

# c# - ASP NET C#：带有队列和线程工作者的单例

> ID：12653804
> 
> 赞同：-2
> 
> 时间：2012-09-29T15:01:32.360
> 
> 标签：c#, asp.net, multithreading, design-patterns, c#-4.0

我需要在管理进程队列的 Web 应用程序中创建一个类实例。此类内部有多个线程，用于查找队列并使用它。这样做的最佳理由是什么？

我已经应用了单例设计模式，但我不明白是否必须在其中创建静态或普通队列。有人可以给我一个例子吗？

**解决方案**

好的谢谢！这是我的单身课程：

```
 public sealed class MyWorkingSingletonClass
    {

    private static readonly ILog LOG = LogManager.GetLogger(typeof(MyWorkingSingletonClass));
    private static MyWorkingSingletonClass instanza;
    private static readonly object lockObject = new object();
    private static ConcurrentQueue<Process> syncCoda = new ConcurrentQueue<Process>();

    private MyWorkingSingletonClass()
    {
    }

    public static MyWorkingSingletonClass Instanza
    {
        get
        {
            lock (lockObject)
            {
                if (instanza == null)
                    instanza = new PdfDucumentConverter();
                return instanza;
            }
        }
    }

    public void AddProcess(Process p)
    {
        syncCoda.Enqueue(p);
    }

    public void Start()
    {
        Task.Factory.StartNew(WorkerTask2);
    }

    public static void WorkerTask2()
    {

        do
        {
            try
            {
                Process p;
                if (syncCoda.TryDequeue(out p))
                {
                    p.Start();
                    p.PriorityClass = ProcessPriorityClass.High;
                    p.WaitForExit();
                }
            }
            catch (Exception ex)
            {
                LOG.Error(ex);
            }
        } while (true);
    }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:06:49.690

您需要实现新的*单例类*，它继承[并发队列](http://msdn.microsoft.com/en-us/library/dd267265.aspx)类，这是线程安全的队列，以确保它可以在多线程环境中工作：

```
public class SingletonConcurrentQueue<T> : ConcurrentQueue<T>
{
    private static readonly SingletonConcurrentQueue<T> 
                                   _instance = new SingletonConcurrentQueue<T>();

    static SingletonConcurrentQueue(){}
    private SingletonConcurrentQueue(){}

    public static SingletonConcurrentQueue<T> Instance
    {
        get { return _instance; }
    }
} 
```

# c - 函数返回 1 而不是正确的值

> ID：12653809
> 
> 赞同：0
> 
> 时间：2012-09-29T15:02:28.117
> 
> 标签：c, function, return

我对 C 函数的返回值有疑问。

我有一个主函数，我以这种方式调用函数“发送”；

```
int go_On;
go_On = send(VOTE_REQUEST, 1); 
```

“发送”函数的组成如下：

```
int send(int msg, int flag) {

  // inizialization of some parameters;

  if (msg == VOTE_REQUEST) {

    // Do some operations...

    result = send(VOTE_COMMIT, 1);
  }
  else if (msg == VOTE_COMMIT) {

    // Do some other operations...

    return 10;
  }
} 
```

其中 VOTE_REQUEST 和 VOTE_COMMIT 是在文件开头声明的常量。

问题是返回值 go_On 是 1 而不是 10。我认为问题的出现是因为我在其内部调用了“发送”函数。事实上，如果我把

```
return 10; 
```

行前

```
result = send(VOTE_COMMIT, 1); 
```

go_On 假定正确的值是 10。调用内部的“发送”函数是问题的根源吗？如何解决它，使返回值变为 10？

感谢所有会帮助我的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T15:04:38.083

您需要从 recusive 调用中返回值。
如果您将其他内容发送到函数中`VOTE_REQUEST`或发送`VOTE_COMMIT`到函数中，您应该返回一个错误值，例如`-1`：

```
int send(int msg, int flag) {

  // inizialization of some parameters;

  if (msg == VOTE_REQUEST) {

    // Do some operations...

    return send(VOTE_COMMIT, 1);
  }
  else if (msg == VOTE_COMMIT) {

    // Do some other operations...

    return 10;
  }

  return -1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:04:21.810

问题似乎是您`return`在函数的第一个分支中从未有过声明。这是*未定义的行为*。

也许你的意思是：

```
if (msg == VOTE_REQUEST)
{
    return send(VOTE_COMMIT, 1);
}
else if (msg == VOTE_COMMIT)
{
    return 10;
}

return -1;    // default 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:05:34.003

在你的函数 send() 中，你没有返回任何值

```
msg == VOTE_REQUEST... 
```

尝试添加返回值...

```
int send(int msg, int param2)
{
    if(msg == VOTE_REQUEST)
        return send(VOTE_COMMIT, 1);
    else if(msg == VOTE_COMMIT)
        return 10;
    else
        return -1;
} 
```

# math - 是否可以从头开始编写语音识别引擎？

> ID：12653811
> 
> 赞同：2
> 
> 时间：2012-09-29T15:02:35.290
> 
> 标签：math, speech-recognition, speech

不过，使用一些现有的数学库。关键是，我的语言（格鲁吉亚语）在这个领域几乎没有研究。那可能吗？我要花多长时间？我知道这也取决于技能，但还是？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T16:33:39.487

也在回答

[非英语语言的语音到文本转换](https://stackoverflow.com/questions/30045889/speech-to-text-conversion-for-non-english-language)

> 是否可以从头开始编写语音识别引擎？

您不需要从头开始编写引擎，已经有很多引擎可用，您可以选择一个像 CMUSphinx

[http://cmusphinx.sourceforge.net](http://cmusphinx.sourceforge.net)

如果你只是对支持Georgian感兴趣，训练Georgian模型只是一个任务，你不需要自己实现引擎。语音识别引擎不依赖于语言。

> 关键是，我的语言（格鲁吉亚语）在这个领域几乎没有研究。

幸好有很多英文。

> 我要花多长时间？

为 CMUSphinx 的新语言创建数据库大约需要一个月的时间。有关更多详细信息，请参阅文档：

[http://cmusphinx.sourceforge.net/wiki/tutorial](http://cmusphinx.sourceforge.net/wiki/tutorial)（教程）

[http://cmusphinx.sourceforge.net/wiki/tutorialam](http://cmusphinx.sourceforge.net/wiki/tutorialam)（声学模型训练教程章节）

# php - mysql更新字段没有先选择

> ID：12653812
> 
> 赞同：1
> 
> 时间：2012-09-29T15:02:35.650
> 
> 标签：php, mysql

我想更新一个字段，但应该保留以前输入的内容。有没有办法通过一个查询来解决这个问题而无需先选择内容。

示例我有一个按名称**协议**的字段，其中包含条目 exmpl。

1.  > 这是以前的条目

比更新应该看起来像

1.  > 这是以前的条目
2.  > 这是一个较新的条目

而不是这个更好的解决方法

```
SELECT protocol FROM my_table WHERE id = 1
 than I should add the new entry to my field and make the update

UPDATE my_table
SET protocol=new value
WHERE id=1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:08:05.647

我想你想[连接](http://en.wikipedia.org/wiki/Concatenation)现有的和新的字符串。该函数在 MySQL中称为[CONCAT ：](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)

```
UPDATE MyTable SET protocol = CONCAT(protocol, "\n", "new entry"); 
```

# java - 从地理点的距离获取位置

> ID：12653818
> 
> 赞同：0
> 
> 时间：2012-09-29T15:03:55.440
> 
> 标签：java, android, location, distance

我正在开发一个 Android 应用程序，我有一个地理点的纬度和经度，我想从 X 米（北）和 Y 米（西）获取该地点的坐标。GeoPoint 没有实现这种功能，所以我必须自己找到一种方法......

我进行了一些搜索，但没有发现任何有趣的东西，您知道如何进行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:12:37.760

棘手，因为两个整经度之间的距离取决于纬度，而距离还取决于海拔高度......

为简单起见，我会尝试猜测经度和纬度，并检查猜测与原点之间的距离。这更容易，因为已经完成[了两点之间的距离。](https://stackoverflow.com/questions/2741403/get-the-distance-between-two-geo-points)

从一个轴开始，进行一种二分搜索，直到找到向北 X 米的位置。然后对另一个轴做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T17:22:34.400

使用以下方法，您将获得添加到原始位置的纬度和经度以到达最终位置。请记住，这只适用于相对较小的距离，因为它忽略了地球曲率。

```
private static final float GAP_LAT_LON = 0.00005f; //aprox 5 meters
private float results[] = new float[1];

private PointF getGaps(Location initial, float distanceX, float distanceY, PointF gaps){
    Location.distanceBetween(initial.getLatitude(), initial.getLongitude(), initial.getLatitude(), initial.getLongitude() + GAP_LAT_LON, results);
    double factorX = GAP_LAT_LON / results[0];
    Location.distanceBetween(initial.getLatitude(), initial.getLongitude(), initial.getLatitude() + GAP_LAT_LON, initial.getLongitude(), results);
    double factorY = GAP_LAT_LON / results[0];
    if(gaps == null)
        gaps = new PointF();
    gaps.set((float)(distanceX * factorX), (float)(distanceY * factorY));
    return gaps;
}

//to use
private void teste(){
    PointF gaps = null;
    Location initial = new Location("");

    initial.setLatitude(23.5);
    initial.setLongitude(13.2);

    //100 meters West/East and 300 meters North/South
    getGaps(initial, 100, 300, gaps);

    //gaps.x returns x offset to add/subtract to initial latitude
    //gaps.y returns y offset to add/subtract to initial longitude
} 
```

祝你好运

# ruby-on-rails - 如何在 gmaps4rails 中更改地图样式

> ID：12653823
> 
> 赞同：0
> 
> 时间：2012-09-29T15:04:21.453
> 
> 标签：ruby-on-rails, styles, gmaps4rails

我正在使用 gmaps4rails，想知道是否有办法在 gmaps4rails 中更改地图样式（特征、颜色等）。我必须为此使用json吗？

谢谢你，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T11:27:42.140

```
<%= gmaps( :map_options => {:raw => "{styles: myStyle}" }, 
           :markers     => { "data" => @json, "options" => {"draggable" => true, "list_container" => "markers_list" } }) %>

<script type="text/javascript" charset="utf-8">
var myStyle = [ 
  { featureType: "all", stylers: [{ "hue": "#ff1a00" } ]} 
];
</script> 
```

# python - 在 SQLAlchemy 中删除父级后删除子级

> ID：12653824
> 
> 赞同：3
> 
> 时间：2012-09-29T15:04:29.207
> 
> 标签：python, sqlalchemy

我的问题如下：

我有这两个模型`Entry`，并`Tag`通过 SQLAlchemy 中的多对多关系链接。现在我想删除删除后`Tag`没有任何对应的所有内容。`Entry``Entry`

*举例说明我想要什么：*

*   `Entry 1`带标签`python`，`java`

*   `Entry 2`带标签`python`，`c++`

有了这两个条目，数据库就包含了标签`python`、`java`和`c++`。如果我现在删除`Entry 2`，我希望 SQLAlchemy 自动`c++`从数据库中删除标签。是否可以在`Entry`模型本身中定义这种行为，或者是否有更优雅的方式？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:01:31.543

不久前有人问过这个问题：[在 SQLAlchemy 关系上设置 delete-orphan 会导致 AssertionError: This AttributeImpl is not configured to track parents](https://stackoverflow.com/questions/9234082/setting-delete-orphan-on-sqlalchemy-relationship-causes-assertionerror-this-att/9264556#9264556)

这就是“多对多孤儿”问题。jadkik94 很接近，因为您应该使用事件来捕获它，但我尝试建议不要在映射器事件中使用 Session，尽管它在这种情况下有效。

下面，我从另一个 SO 问题中逐字回答，并将“角色”一词替换为“条目”：

```
from sqlalchemy.ext.associationproxy import association_proxy
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import event
from sqlalchemy.orm import attributes

Base= declarative_base()

tagging = Table('tagging',Base.metadata,
    Column('tag_id', Integer, ForeignKey('tag.id', ondelete='cascade'), primary_key=True),
    Column('entry_id', Integer, ForeignKey('entry.id', ondelete='cascade'), primary_key=True)
)

class Tag(Base):

    __tablename__ = 'tag'
    id = Column(Integer, primary_key=True)
    name = Column(String(100), unique=True, nullable=False)

    def __init__(self, name=None):
        self.name = name

class Entry(Base):
    __tablename__ = 'entry'

    id = Column(Integer, primary_key=True)
    tag_names = association_proxy('tags', 'name')

    tags = relationship('Tag',
                        secondary=tagging,
                        backref='entries')

@event.listens_for(Session, 'after_flush')
def delete_tag_orphans(session, ctx):
    # optional: look through Session state to see if we want
    # to emit a DELETE for orphan Tags
    flag = False

    for instance in session.dirty:
        if isinstance(instance, Entry) and \
            attributes.get_history(instance, 'tags').deleted:
            flag = True
            break
    for instance in session.deleted:
        if isinstance(instance, Entry):
            flag = True
            break

    # emit a DELETE for all orphan Tags.   This is safe to emit
    # regardless of "flag", if a less verbose approach is
    # desired.
    if flag:
        session.query(Tag).\
            filter(~Tag.entries.any()).\
            delete(synchronize_session=False)

e = create_engine("sqlite://", echo=True)

Base.metadata.create_all(e)

s = Session(e)

r1 = Entry()
r2 = Entry()
r3 = Entry()
t1, t2, t3, t4 = Tag("t1"), Tag("t2"), Tag("t3"), Tag("t4")

r1.tags.extend([t1, t2])
r2.tags.extend([t2, t3])
r3.tags.extend([t4])
s.add_all([r1, r2, r3])

assert s.query(Tag).count() == 4

r2.tags.remove(t2)

assert s.query(Tag).count() == 4

r1.tags.remove(t2)

assert s.query(Tag).count() == 3

r1.tags.remove(t1)

assert s.query(Tag).count() == 2 
```

两个几乎相同的 SO 问题使这成为手头上的东西，所以我将它添加到[http://www.sqlalchemy.org/trac/wiki/UsageRecipes/ManyToManyOrphan](http://www.sqlalchemy.org/trac/wiki/UsageRecipes/ManyToManyOrphan)的 wiki 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T18:01:57.083

我会让代码为我说话：

```
from sqlalchemy import create_engine, exc, event
from sqlalchemy.orm import sessionmaker
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import func, Table, Column, Integer, String, Float, Boolean, MetaData, ForeignKey
from sqlalchemy.orm import relationship, backref

# Connection
engine = create_engine('sqlite:///', echo=True)
Base = declarative_base(bind=engine)
Session = sessionmaker(bind=engine)

# Models
entry_tag_link = Table('entry_tag', Base.metadata,
    Column('entry_id', Integer, ForeignKey('entries.id')),
    Column('tag_id', Integer, ForeignKey('tags.id'))
)

class Entry(Base):
    __tablename__ = 'entries'
    id = Column(Integer, primary_key=True)
    name = Column(String(255), nullable=False, default='')

    tags = relationship("Tag", secondary=entry_tag_link, backref="entries")

    def __repr__(self):
        return '<Entry %s>' % (self.name,)

class Tag(Base):
    __tablename__ = 'tags'
    id = Column(Integer, primary_key=True)
    name = Column(String(255), nullable=False)

    def __repr__(self):
        return '<Tag %s>' % (self.name,)

# Delete listener
def delete_listener(mapper, connection, target):
    print "---- DELETING %s ----" % (target,)
    print '-' * 20
    for t in target.tags:
        if len(t.entries) == 0:
            print ' ' * 5, t, 'is to be deleted'
            session.delete(t)
    print '-' * 20

event.listen(Entry, 'before_delete', delete_listener)

# Utility functions
def dump(session):
    entries = session.query(Entry).all()
    tags = session.query(Tag).all()

    print '*' * 20
    print 'Entries', entries
    print 'Tags', tags
    print '*' * 20

Base.metadata.create_all()

session = Session()

t1, t2, t3 = Tag(name='python'), Tag(name='java'), Tag(name='c++')

e1, e2 = Entry(name='Entry 1', tags=[t1, t2]), Entry(name='Entry 2', tags=[t1, t3])

session.add_all([e1,e2])
session.commit()

dump(session)

raw_input("---- Press return to delete the second entry and see the result ----")

session.delete(e2)
session.commit()

dump(session) 
```

上面的代码使用 SQLAlchemy ORM 事件的[after_delete](http://docs.sqlalchemy.org/en/rel_0_7/orm/events.html#sqlalchemy.orm.events.MapperEvents.before_delete)事件。这条线很神奇：

```
event.listen(Entry, 'before_delete', delete_listener) 
```

这表示要监听一个`Entry`项目的所有删除，并调用我们的监听器，它会做我们想要的。但是，文档不建议更改事件中的会话（请参阅我添加的链接中的警告）。但据我所知，它有效，所以由您决定这是否适合您。

# html - 以百分比设置宽度的“位置：固定”侧边栏？

> ID：12653827
> 
> 赞同：9
> 
> 时间：2012-09-29T15:04:43.520
> 
> 标签：html, css, sass, susy-compass

我已经成功地使用了漂亮的[Susy 网格系统](http://susy.oddbird.net/)来创建一个[类似于 WebDesignerWall.com 的响应式布局： ![在此处输入图像描述](../Images/16498dc4dc2a31e82cac8b0f44bc8370.png)](http://webdesignerwall.com/tutorials/setting-breakpoints-in-responsive-design)

我未能实现的是`position:fixed`侧边栏。

当页面滚动并停留在同一位置时，这样的侧边栏不会滚动。这非常方便（无论如何，您实际上不能将更多内容放入侧边栏中，因为它会使页面顶部在一个狭窄的窗口中变得混乱）。

每当我应用于`position:fixed`列时，我的布局都会变得疯狂： ![在此处输入图像描述](../Images/173e533fe205be8192f870953f30ec5e.png) 彩色块被声明为三列宽，但在`position:fixed`应用于侧边栏时会进一步拉伸..

我认为问题在于侧边栏的宽度是相对的，即以百分比设置。由于`position:fixed`，宽度是根据浏览器窗口的宽度测量的，而不是它的容器（尽管我将容器设置为`position:relative`）。

问题是：**如何将列固定在窗口上，同时根据容器而不是视口测量其宽度**？

也许可以用 JS 固定元素的位置？

PS我已经尝试过[`width: inherit`解决方案](https://stackoverflow.com/questions/5873565/position-fixed-relative-to-parent-div)，但这对我的情况没有任何帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-30T05:22:06.287

这样做的方法是使用第二个容器。我不知道您的确切代码，但这是一个示例。假设您的结构是这样的：

```
<div class="page">
  <header class="banner">
    <h1>header</h1>
  </header>
  <nav class="navigation">
    <ul class="nav-inner">
      <li>navigation link</li>
    </ul>
  </nav>
  <article class="main">
    <h2>main content</h2>
  </article>
  <footer class="contentinfo">
    <p>footer</p>
  </footer>
</div> 
```

我在那里做出的唯一重要假设是确保在导航侧边栏周围有一个额外的包装。我有`<nav>`标签和`<ul>`标签可以使用。您可以使用任何您想要的标签，只要侧边栏有两个可用于结构 - 外部用于固定容器，内部用于侧边栏本身。CSS 看起来像这样：

```
// one container for everything in the standard document flow.
.page {
  @include container;
  @include susy-grid-background;
}

// a position-fixed container for the sidebar.
.navigation {
  @include container;
  @include susy-grid-background;
  position: fixed;
  left: 0;
  right: 0;
  // the sidebar itself only spans 3 columns.
  .nav-inner { @include span-columns(3); }
}

// the main content just needs to leave that space open.
.main { @include pre(3); }

// styles to help you see what is happening.
header, article, .nav-inner, footer {
  padding: 6em 0;
  outline: 1px solid red;
} 
```

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:31:56.787

> 也许可以用 JS 固定元素的位置？

是的，但这会很乏味并且不是理想的解决方案。

相反，使用 JavaScript 计算适当的宽度并分配它，而不是直接在 CSS 中使用百分比。这是一个基本的大纲：

```
function updateSize() {
    var outer = document.getElementById("outercontainer"); //get the container that contains your sidebar
    var navcol = document.getElementById("navcol"); //get the sidebar (which is supposed to have position: fixed;)
    navcol.style.width = Math.floor(outer.offsetWidth * 45/100) + "px"; //or whatever your percentage is
}
updateSize();
window.onresize = updateSize; /*make sure to update width when the window is resized*/ 
```

**注意：**上面使用的 ID 只是占位符——您需要修改它们以适合您的实际页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T15:08:57.200

你不能，固定位置的元素从它们的容器中分离出来，`position: relative`或者没有`position: relative`. 只需将其宽度设置为绝对值 - 看起来您的内容总是 760 像素宽，对吧？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-29T17:04:25.060

`position:fixed`像`position:absolute`这样工作，它没有相对于它的容器定位。它只是浮动到您的文档中。快速修复将是这样的：

```
<div id="fixed-element" style="width:30%"> /* 30% of the document width*/
lorem ipsum dolor sit amet
</div>

<div id="faux-sidebar" style="width:30%; display:block"> /* 30% of the document, leave it empty, so it acts like a placeholder for the fixed element*/
&nbsp;
</div>

<div id="the-rest" style="width:70%"> /* the rest of the website goes here */
more lorem ipsum than ever before
</div> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-29T17:00:50.993

为什么不直接用数学？=)

示例 html：

```
 <div class="container">
    <div class="col">
        <div class="fixed">This is fixed</div>
    </div>
</div> 
```

CSS

```
.container {
    width: 80%;
    margin: 0 auto;
}

.col {
   float: left;
    width: 33.3333333333%;
}

.fixed {
    position: fixed;
    width: 26.666666666%; /* .container width x .col width*/
} 
```

# node.js - Mongo 索引 - Nodejs

> ID：12653829
> 
> 赞同：0
> 
> 时间：2012-09-29T15:04:44.963
> 
> 标签：node.js, mongodb, mongoose

我使用以下架构和代码在 Mongo 中创建集合以及索引器并插入数据。请注意，该集合是根据 categoryName 动态创建的。

```
var employeeSchema = new mongoose.Schema({

      categoryId              : {type: String, required: true },

      loc                     : {type: {lon: Number,  lat: Number}, index: '2d'},

     // createdBy             : {type: String, required: true },
      createDate              : {type: Date, default: Date.now}
});

exports.register = function   (objEmployee , callback)
{
            var emp = db.model(objEmployee.categoryName, employeeSchema );

            var objSchema = new emp(objEmployee);          
            objSchema.save(function (err) {
            if (err) return callback(err);
            console.info ('Data inserted successfully.');
            return callback(null);
            });

}; 
```

我能够插入数据，但是当我基于radius运行查询时，运行时出现以下错误。

```
Sat Sep 29 20:21:24 uncaught exception: error: {
    "$err" : "can't find special index: 2d for: { loc: { $within: { $center: [ [ 50.9393925139, -114.0 ], 2.0 ] } } }",
    "code" : 13038 
```

我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T15:19:59.597

我认为您对 loc 的架构定义是错误的。它应该是

```
loc: {
  lon: Number,
  lat: Number
} 
```

在您的架构定义之后添加索引

```
employeeSchema.index({
  loc: "2d"
}); 
```

# java - 在我的 JSP 中实现 Map 的 Bean 不调用 getter

> ID：12653833
> 
> 赞同：1
> 
> 时间：2012-09-29T15:05:07.927
> 
> 标签：java, jsp

我制作了一些实现 Map 接口的自定义 bean，以便轻松访问我的 JSP 中的任意数据。

例子：

```
${person["cellPhoneNumber"]} 
```

这些额外的数据可能会或可能不会添加到后端，因此 Map 似乎是一种很好的灵活存储方式。

当我尝试在我的 bean 上使用 getter 时，问题就出现了。我的 Person 类有一个`getName()`方法。在我的 JSP 中使用以下内容时，将`Map.get()`调用该方法而不是我的方法。

```
${person.name} 
```

有没有办法绕过这个对 Map 的`get("name")`调用并`getName()`改为调用？

这是我的基本（精简）Java 类：

```
class Person implements Map
{
    private HashMap<String, Object> myMap;
    private String name;
    public Object get(Object key)
    {
        return myMap.get(key);
    }
    public String getName()
    {
        return this.name;
    }
} 
```

使用 JSTL 1.1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T15:15:39.377

看起来 servlet 容器将每个实现`Map`接口的类视为一个映射并完全丢弃其他方法，退回到按键查找。我看到两个解决方案：

1)`get(Object key)`应注意正常属性：

```
class Person implements Map
{
    private HashMap<String, Object> myMap;
    private String name;
    public Object get(Object key)
    {
        switch(key) {
            case "name": return getName();
            default: myMap.get(key)
        }
    }
    public String getName()
    {
        return this.name;
    }
} 
```

这有点笨拙，而且不是很可扩展。此外，使用反射并自动查找所有字段或将 bean 转换为映射可能更容易（请参阅：[如何将 Java 对象（bean）转换为键值对（反之亦然）？](https://stackoverflow.com/questions/739689)）。更糟。

2）将您的地图公开为特殊的bean属性：

```
class Person
{
    private HashMap<String, Object> optional;
    private String name;
    public Map<String, Object> getOptional()
    {
        return optional;
    }
    public String getName()
    {
        return this.name;
    }
} 
```

然后你的 EL 表达式如下所示：

```
${person.optional['cellPhoneNumber']} 
```

这是一种更好的方法，因为：

*   它更快，更具可扩展性
*   更好地代表您的意图
*   这是一个更好的设计（正如*duffymo*在评论中强调的那样） -`Person` *具有*可选属性，如手机号码。`Person` *不是*可选属性的“映射”。

# hadoop - DataNode 不在其中一个从属设备中启动

> ID：12653837
> 
> 赞同：0
> 
> 时间：2012-09-29T15:05:41.967
> 
> 标签：hadoop, hdfs

我正在尝试用 5 个从站配置 hadoop。在主节点中运行 start-dfs.sh 后，只有一个从节点不运行 DataNode。我尝试在该节点中的配置文件中寻找一些差异，但我没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T01:50:57.933

配置文件有区别！在 core-site.xml 中，hadoop.tmp.dir 变量设置为无效目录，因此在启动 DataNode 时无法创建它。经验教训：查看日志（感谢 Chris）

# jquery - 将流沙与非固定高度/宽度容器一起使用

> ID：12653843
> 
> 赞同：1
> 
> 时间：2012-09-29T15:06:10.830
> 
> 标签：jquery, html, css, quicksand, jquery-easing

有没有办法将流沙插件 (http://razorjack.net/quicksand/) 与设置为百分比尺寸而不是固定的容器一起使用？它运行良好，但动画无法正常工作。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T02:00:24.067

我遇到了同样的问题，并使用了一些 jQuery 根据屏幕上的尺寸来修复尺寸

```
 var thumbHeight = $('.project-thumb').height(),
    thumbWidth = $('.project-thumb').outerWidth();                  

    $('.project-thumb').css({'max-width':thumbWidth, 'max-height':thumbHeight}); 
```

# google-chrome - Chrome、搜索和 iframe

> ID：12653848
> 
> 赞同：0
> 
> 时间：2012-09-29T15:07:17.753
> 
> 标签：google-chrome, search, iframe

据我所知，Chrome 中的 Ctrl+F 不会搜索 iframe 内容。

有什么办法可以解决这个问题，还是我必须自己控制搜索？

# asp.net-mvc - 带有更新/插入方法的 VB .NET MVC LinqToSql 异常

> ID：12653856
> 
> 赞同：1
> 
> 时间：2012-09-29T15:08:33.350
> 
> 标签：asp.net-mvc, vb.net, linq-to-sql

第一次发帖。我一直在玩这个，似乎没有人遇到和我一样的问题。

当我尝试使用 Linq to SQL 更新/或插入对象时，这些方法可以正常工作，但是当它遇到 Save() 方法时出现以下异常

```
 System.ArgumentNullException was caught
    Message="Value cannot be null. Parameter name: source"
    ParamName="source"
    Source="System.Data.Linq"
    StackTrace:
     at System.Data.Linq.ChangeProcessor.SendOnValidate(MetaType type, TrackedObject item, ChangeAction changeAction)
   at System.Data.Linq.ChangeProcessor.ValidateAll(IEnumerable`1 list)
   at System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode)
   at System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
   at System.Data.Linq.DataContext.SubmitChanges()
   at ilaTraining.TrainingRepository.Save() in C:\Users\kevin\Documents\Visual Studio 2008\Projects\ilaTraining\ilaTraining\Models\TrainingRepository.vb:line 394
   at ilaTraining.AdminController.CreateCourseTitle(t_courseTitle title) in C:\Users\kevin\Documents\Visual Studio 2008\Projects\ilaTraining\ilaTraining\Controllers\AdminController.vb:line 433 
```

我传递给 insertOnSubmit 或 updateOnSubmit 方法的对象已完全形成，据我所知不会破坏参照完整性。所有非空值都被填充等。

我认为它可能是连接字符串或类似的东西，但如果我手动将信息放入数据库，应用程序可以检索它。只是不要改变它。

这让我发疯了，所以如果有任何善良的灵魂希望让我摆脱痛苦，那么请这样做。感谢您的任何/所有帮助并向任何版主道歉，我可能因将其发布在错误的位置而感到不安。

谢谢

# php - 将日期/时间字符串分解为关联数组

> ID：12653859
> 
> 赞同：0
> 
> 时间：2012-09-29T15:09:00.150
> 
> 标签：php, arrays, date

我有一个从 DB 选项返回的字符串，它允许用户设置她/他的日期格式：

```
F j, Y 
```

这将（今天）然后在我的函数中返回以下值`get_date()`：

```
string 'September 24, 2012' (length=18) 
```

现在我需要一个关联数组来拆分该字符串：

```
array( 
    'day'   => 24,
    'month' => 'September',
    'year'  => 2012
) 
```

由于不知道用户如何设置她/他的日期，我有一个我不能简单地说的问题`F = month, j = day, Y = year`。[php`date()`函数](http://php.net/manual/de/function.date.php)允许的一切，在系统中都是允许的。

> **问题：**我怎样才能“匹配”那些？是否有一些我监督过的本机功能，它告诉我某事是否是月/日/年/小时/...？

**编辑：**最大。我可以使用的 PHP 版本是 PHP 5.2.1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:13:28.007

如果您有 PHP 5.3 或更高版本，请使用[`DateTime::createFromFormat`](http://php.net/manual/en/datetime.createfromformat.php)：

```
$date = DateTime::createFromFormat($inputFormat, $gotDate);

$result = array(
    'day' => (int)$date->format('j'),
    'month' => $date->format('F'),
    'year' => (int)$date->format('Y')
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:13:02.067

在我看来，您不应该首先将该字符串存储在数据库中，而应使用时间戳。

如果你这样做，你可以使用类似的东西：

```
$dateTime = new DateTime($theTimestamp);
$date = array(
    'day' => $dateTime->format('j'),
    'month' => $dateTime->format('F'),
    'year' => $dateTime->format('y'),
); 
```

如果你想灵活地处理你想要的数组，你可以创建一个函数，如：

```
function buildDateArray($theTimestamp, $elements) {
    $dateTime = new DateTime($theTimestamp);
    $date = array();
    foreach($elements as $key => $format) {
        $date[$key] = $dateTime->format($format);
    }
}

$theArray = buildDateArray($theTimestamp, array(
    'day' => 'j',
    'month' => 'F',
    'year' => 'y',
)); 
```

*注意：从`DateTime`5.2.0 开始可用*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T18:32:45.480

正如您现在所写的那样，您手头没有 PHP 5.3（真的很遗憾），因此您需要“手动”解析字符串。在 PCRE 正则表达式旁边，还有`sscanf`. 例子：

```
$date = 'September 24, 2012';
$result = sscanf($date, '%s %2d, %4d', $month, $day, $year);
$parsed = array(
    'day'   => $day,
    'month' => $month,
    'year'  => $year
);
var_dump($parsed); 
```

输出：

```
array(3) {
  'day' =>
  int(24)
  'month' =>
  string(9) "September"
  'year' =>
  int(2012)
} 
```

这将已经根据您的格式解析输入日期字符串。如果您需要更灵活，则需要动态构建模式，并将值与结果数组相关联。

我已经编译了另一个执行此操作的示例。它可能有点脆弱（我已经添加了一些注释），但它确实有效。自然地，我会将其包装到一个函数中以更好地处理错误情况，但我保留了原始代码，以便更好地显示它是如何工作的：

```
// input variables:
$date = 'September 24, 2012';
$format = 'F j, Y';

// define the formats:
$formats = array(
    'F' => array('%s',  'month'),  # A full textual representation of a month, such as January or March
    'j' => array('%2d', 'day'),    # Day of the month, 2 digits with or without leading zeros
    'Y' => array('%4d', 'year'),   # A full numeric representation of a year, 4 digits
    # NOTE: add more formats as you need them
);

// compile the pattern and order of values
$pattern = '';
$order = array();
for($l = strlen($format), $i = 0; $i < $l; $i++) {
    $c = $format[$i];

    // handle escape sequences
    if ($c === '\\') {
        $i++;
        $pattern .= ($i < $l) ? $format[$i] : $c;
        continue;
    }

    // handle formats or if not a format string, take over literally
    if (isset($formats[$c])) {
        $pattern .= $formats[$c][0];
        $order[] = $formats[$c][1];
    } else {
        $pattern .= $c;
    }
}

// scan the string based on pattern
// NOTE: This does not do any error checking
$values = sscanf($date, $pattern);

// combine with their names
// NOTE: duplicate array keys are possible, this is risky,
//       write your own logic this is for demonstration
$result = array_combine($order, $values);

// NOTE: you can then even check by type (string/int) and convert
//       month or day names into integers

var_dump($result); 
```

在这种情况下，结果是：

```
array(3) {
  'month' =>
  string(9) "September"
  'day' =>
  int(24)
  'year' =>
  int(2012)
} 
```

照顾好笔记。在我写它之前，我已经检查了 PHP 手册中的用户注释，但是那里提供的函数只用于解析一个特定的模式，而这个变体应该在一定程度上是可扩展的。如果你只有那一种格式，你自然可以非动态地创建 sscanf 字符串。

另请参阅：[date_create_from_format 等效于 PHP 5.2（或更低版本）](https://stackoverflow.com/questions/2621433/date-create-from-format-equivalent-for-php-5-2-or-lower)

还要注意，因为这是 wordpress，所以可能会翻译月份名称。

而且我很确定您也可以以时间戳格式获取帖子的日期。对于插件而言，仅根据帖子 ID 获取该值而不是解析某些字符串可能会更轻松。

最后一点：只有 Wordpress 有最低 PHP 版本，这并不意味着您的插件也需要这个最低版本。特别是在您概述的情况下，PHP 5.2 不再获得任何支持（它已经死了），您可以帮助您的插件用户告诉他们应该更新他们的 PHP 版本。

看起来 Wordpress 仍然没有给出关于 PHP 版本的警告，它们以某种方式停止使用浏览器和他们自己的软件；）没有必要模仿这种糟糕的做法。告诉您的用户他们处于危险之中并把他们吓跑（或者做闪亮的弹出气泡以一种不那么具有威胁性的方式传达信息。为您的用户提供善意的服务，那么双方都会有所收获双方，做一些优雅的后备来展示你的好态度）。

另请参阅：[是否有与 PHP 5.3 不兼容的 Wordpress 版本？](https://wordpress.stackexchange.com/questions/28603/is-there-a-wordpress-version-that-is-incompatible-with-php-5-3)

如果您有兴趣，您可以在 PHP.net 上找到当前 PHP 的发布周期：[https ://wiki.php.net/rfc/releaseprocess。](https://wiki.php.net/rfc/releaseprocess)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T15:14:09.627

已经在原生 php 类中找到答案的第一部分`DateTime`：只需使用[`date_parse( get_date() );`](http://php.net/manual/en/function.date-parse.php). *自 PHP 5.2 起可用*

```
// @example
'year' => int 2012
'month' => int 9
'day' => int 24
'hour' => boolean false
'minute' => boolean false
'second' => boolean false
'fraction' => boolean false
'warning_count' => int 0
'warnings' => 
   array
   empty
'error_count' => int 0
'errors' => 
   array
   empty
'is_localtime' => boolean false 
```

这个答案仍然没有解决问题，我不知道如何映射`j`到`day`，`F`to`month`等。

# gwt - 多模块 Maven POM

> ID：12653860
> 
> 赞同：2
> 
> 时间：2012-09-29T15:09:04.433
> 
> 标签：gwt, maven, pom.xml

我有一个带有 2 个 maven 模块的父项目，一个简单的 Java 应用程序（使用 maven-archetype-quickstart 生成）和一个 GWT 应用程序（使用 gwt-maven-plugin 生成）。

我正在尝试将两个模块的输出目录设置为父 /target/ 文件夹，但是当应用程序编译没有错误时，当我尝试在 tomcat [with `mvn tomcat:run`] 中运行它时，我收到以下错误：

```
[ERROR] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Compilation failure
Failure executing javac, but could not parse the error:
javac: directory not found: /null/null/WEB-INF/lib
Usage: javac <options> <source files>
use -help for a list of possible options 
```

三个 pom.xml 文件如下：

## 父 POM

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>gr.veltisto</groupId>
    <artifactId>ennovation</artifactId>
    <version>0.1.1</version>
    <packaging>pom</packaging>      

    <modules>
        <module>core</module>
        <module>gwt</module>
    </modules>
</project> 
```

## java模块POM

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<groupId>gr.veltisto.ennovation</groupId>
<artifactId>core</artifactId>
<version>0.1.1</version>
<packaging>jar</packaging>
<name>Veltisto Core Maven Module</name> 

<parent>
    <groupId>gr.veltisto</groupId>
    <artifactId>ennovation</artifactId>
    <version>0.1.1</version>
</parent>

<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<dependencies>
    (...)
</dependencies>

<build>
    <outputDirectory>/${project.parent.build.directory}/${project.parent.build.finalName}/WEB-INF/lib</outputDirectory>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.5.1</version>
            <configuration>
                <compilerVersion>1.6</compilerVersion>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

## GWT 模块 POM

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

<!-- POM file generated with GWT webAppCreator -->
<modelVersion>4.0.0</modelVersion>
<groupId>gr.veltisto.ennovation</groupId>
<artifactId>gwt</artifactId>
<packaging>war</packaging>
<version>0.0.1</version>
<name>Veltisto GWT Maven Module</name>

<parent>
    <groupId>gr.veltisto</groupId>
    <artifactId>ennovation</artifactId>
    <version>0.1.1</version>
</parent>

<properties>
    <!-- Convenience property to set the GWT version -->
    <gwtVersion>2.5.0-rc1</gwtVersion>
    <!-- GWT needs at least java 1.5 -->
    <webappDirectory>/${project.parent.build.directory}/${project.parent.build.finalName}</webappDirectory>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<dependencies>
    <dependency>
        <groupId>com.google.gwt</groupId>
        <artifactId>gwt-servlet</artifactId>
        <version>${gwtVersion}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>com.google.gwt</groupId>
        <artifactId>gwt-user</artifactId>
        <version>${gwtVersion}</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.7</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
        <classifier>sources</classifier>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>com.github.gwtbootstrap</groupId>
        <artifactId>gwt-bootstrap</artifactId>
        <version>2.0.4.0</version>
    </dependency>
</dependencies>

<build>
    <!-- Generate compiled stuff in the folder used for developing mode -->
    <outputDirectory>${webappDirectory}/WEB-INF/classes</outputDirectory>

    <plugins>

        <!-- GWT Maven Plugin -->
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>gwt-maven-plugin</artifactId>
            <version>2.5.0-rc1</version>
            <executions>
                <execution>
                    <goals>
                        <goal>compile</goal>
                        <goal>test</goal>
                        <goal>i18n</goal>
                        <goal>generateAsync</goal>
                    </goals>
                </execution>
            </executions>
            <!-- Plugin configuration. There are many available options, see gwt-maven-plugin 
                documentation at codehaus.org -->
            <configuration>
                <runTarget>gwt.html</runTarget>
                <hostedWebapp>${webappDirectory}</hostedWebapp>
                <i18nMessagesBundle>gr.veltisto.ennovation.client.Messages</i18nMessagesBundle>
            </configuration>
        </plugin>

        <!-- Copy static web files before executing gwt:run -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.1.1</version>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <goals>
                        <goal>exploded</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <webappDirectory>${webappDirectory}</webappDirectory>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <source>1.5</source>
                <target>1.5</target>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

PS。当我运行时`mvn compile`，输出目录已正确创建。只有当我跑步时，我`mvn tomcat:run`才会得到`/null/null/WEB-INF/lib`参考

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:29:39.130

不如将 GWT 模块用作 webapp 模块中的覆盖层？

请参阅[https://github.com/tbroyer/gwt-maven-archetypes](https://github.com/tbroyer/gwt-maven-archetypes)（我刚刚添加了 tomcat-maven-plugin 支持，有一些调整和解决方法可以使其工作）

# iphone - 无法让 facebook 示例正常工作 - 名为“Feed Dialog”的示例。

> ID：12653870
> 
> 赞同：2
> 
> 时间：2012-09-29T15:10:17.763
> 
> 标签：iphone, facebook, facebook-graph-api

有没有人可以上传/分享一个可以工作的 xcode 项目？我很难让这个工作干净而没有错误。

该示例位于此处。

[https://developers.facebook.com/docs/howtos/feed-dialog-using-ios-sdk/][1]

我的项目工作到这个程度 -

主视图控制器显示有一个按钮，允许用户向 facebook 发送帖子。单击时，facebook 表示用户已经授权该应用程序发布到他们的页面。他在 facebook 消息上单击“确定”，然后用户会看到“共享”对话框，并被允许为他的帖子输入文本。

当共享对话框呈现给用户时，我在控制台中收到此警告

```
2012-09-29 11:04:25.190 gw_fakeapp[8016:fe03] FBConditionalLog: handleOpenURL should not be called once a session has closed 
```

当用户单击“共享”时，我的问题出现了，我收到错误消息：

```
2012-09-29 11:04:32.217 gw_fakeapp[8016:fe03] *** Terminating app due to uncaught exception 'com.facebook.sdk:InvalidOperationException', reason: 'FBSession: an attempt was made reauthorize permissions on an unopened session'
*** First throw call stack:
(0x14c9022 0xfe2cd6 0x14c8ee1 0x171d1 0x14367 0x3ad8 0x14cae99 0x14814e 0x386a0e 0x14cae99 0x14814e 0x1480e6 0x1eeade 0x1eefa7 0x1ee266 0x16d3c0 0x16d5e6 0x153dc4 0x147634 0x1da9ef5 0x149d195 0x1401ff2 0x14008da 0x13ffd84 0x13ffc9b 0x1da87d8 0x1da888a 0x145626 0x28ed 0x2815)
terminate called throwing an exception(lldb) 
```

有没有人有一个可以与我比较的工作项目？

谢谢！

菲尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T17:11:47.203

您可以从 developer.apple.com 下载描述 Facebook 帖子发布的代码示例。

这是链接：[https ://github.com/downloads/facebook/facebook-ios-sdk/FacebookSDK-3.1.pkg](https://github.com/downloads/facebook/facebook-ios-sdk/FacebookSDK-3.1.pkg)

# ios - 如何从 Xcode 4.5 卸载 iOS 5.0 模拟器

> ID：12653876
> 
> 赞同：3
> 
> 时间：2012-09-29T15:11:10.257
> 
> 标签：ios, xcode, simulator

我已经安装了 Xcode 4.5，因为我写应用程序是为了好玩，我不打算支持旧的 iOS 版本，为了节省 500 GB iMac 的空间，有没有办法删除它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:17:12.097

Тry 从 Xcode 包中支持的平台中删除 iPhone/iPhoneSimulators：/Applications/Xcode.app/Contents/Developer/Platforms

# mysql - 错误：SQLSTATE [42000]：cakePHP 的语法错误或访问冲突

> ID：12653879
> 
> 赞同：2
> 
> 时间：2012-09-29T15:11:23.533
> 
> 标签：mysql, sql, cakephp

我正在为我的应用程序使用框架 cakePHP。我使用 xampp 在 localhost 上对其进行了编程，现在尝试将其上传到我的网站上。它在本地主机上没有任何问题。现在只有这一页，在新服务器上不起作用。其他站点（也使用数据库连接）工作正常。

对于这一站点，将显示以下消息：

> 错误：SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“添加”附近使用正确的语法
> 
> SQL 查询：添加

函数 add() 看起来像这样。

```
public function add() { 
      //$this->create();
      $word_id = $this->Word->getWord_id();
      $save = $this->save(array('word_id' => $word_id, 'text' => $this->getText($word_id), 'mistake' => 0));
      return $save['Game']['id']; 
   } 
```

在本地主机上，我使用了 MySQL-Client-Version: mysqlnd 5.0.8-dev - 20102224 - $Revision: 310735 $ 和 PHP 版本 5.3.8。

在服务器上，我使用 MySQL-Client-Version: 5.1.62 和 PHP Version 5.3.17。

非常感谢您的帮助！

编辑：模型“游戏”：

```
class Game extends AppModel {
   public $name = 'Game';
   public $belongsTo = 'Word';
   public $searchedWord = '';

   public function addGame() { // Create new game
      $word_id = $this->Word->getWord_id();
      $save = $this->save(array('word_id' => $word_id, 'text' => $this->getText($word_id), 'mistake' => 0));
      return $save['Game']['id']; // Build the hangman
    }
} 
```

当我调试 $this->Game 时，输出是：

```
object(AppModel) {
        useDbConfig => 'default'
        useTable => 'games'
        id => null
        data => array()
        schemaName => null
        table => 'games'
        primaryKey => 'id'
        validate => array()
        validationErrors => array()
        validationDomain => null
        name => 'Game'
        alias => 'Game'
        tableToModel => array(
            'games' => 'Game'
        )
        cacheQueries => false
        belongsTo => array()
        hasOne => array()
        hasMany => array()
        hasAndBelongsToMany => array()
        actsAs => null
        Behaviors => object(BehaviorCollection) {
            modelName => 'Game'
            defaultPriority => (int) 10
        }
        whitelist => array()
        cacheSources => true
        findQueryType => null
        recursive => (int) 1
        order => null
        virtualFields => array()
        __backAssociation => array()
        __backInnerAssociation => array()
        __backOriginalAssociation => array()
        __backContainableAssociation => array()
        findMethods => array(
            'all' => true,
            'first' => true,
            'count' => true,
            'neighbors' => true,
            'list' => true,
            'threaded' => true
        )
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T16:27:04.610

通常，如果发生此错误，您没有模型实例，而是您处理的应用程序模型实例。app模型实例没有add()方法，直接用add()查询db。

所以请确保您的模型正确包含在内。由于您没有向我们展示如何调用该方法的代码（以及如何使控制器可以使用该模型），但我无法提供任何具体建议。

如果您手动包含它：

```
$this->ModelName = ClassRegistry::init('ModelName'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:20:52.133

**add**是 MySQL 中的保留字，您可能在没有“转义”的 SQL 查询中使用它。

检查您的数据库中是否有任何名为**add的字段。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-15T20:40:49.663

我刚遇到这个错误，我觉得很愚蠢。我敢肯定这个问题很久以前就已经解决了，但万一其他人遇到它......

使用您的示例，我将基本上展示我在 Controller 中也愚蠢地做了什么，以及它如何导致您遇到的相同类型的错误：

```
 public function index($gameid = null, $letter = null) {
      if ($gameid == null) {
           // New game
           $gameid = $this->Game->addGame();
      }
 } 
```

由于您已经拥有实例（控制器类）并且您没有调用`addGame`此处的 Model 方法，而是调用 Controller 的方法，您只需`Game->`从单行命令中删除 。

```
 $gameid = $this->addGame(); 
```

简单易行的监督。也就是说，如果您将 addGame 方法移至您的 Model 类，它可能会按预期工作。:)

# c - 使用 scanf 时 getchar 不会停止

> ID：12653884
> 
> 赞同：8
> 
> 时间：2012-09-29T15:11:31.120
> 
> 标签：c, getchar

我很难理解`getchar()`。在以下程序`getchar`中按预期工作：

```
#include <stdio.h>

int main()
{
    printf("Type Enter to continue...");
    getchar();
    return 0; 
} 
```

但是，在以下程序中，`getchar`不会产生延迟并且程序结束：

```
#include <stdio.h>

int main()
{
    char command[100];
    scanf("%s", command );
    printf("Type Enter to continue...");
    getchar();
    return 0; 
} 
```

我有以下奇怪的解决方法，它有效，但我不明白为什么：

```
#include <stdio.h>

int main()
{
    char command[100];
    int i;
    scanf("%s", command );
    printf("Type Enter to continue...");
    while ( getchar() != '\n') {
      i=0; 
    }
    getchar();
    return 0;    
} 
```

所以我的问题是：
1\. 在`scanf`做什么？为什么这样`scanf`做？
2\. 为什么我的工作围绕着工作？
3.模拟以下Python代码的好方法是什么：

```
raw_input("Type Enter to continue") 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-29T15:13:17.273

输入仅在您输入换行符后发送到程序，但是

```
scanf("%s", command ); 
```

将换行符留在输入缓冲区中，因为`%s`^((1))格式在某个非空白字符之后遇到第一个空白字符时停止，`getchar()`然后立即返回该换行符并且不需要等待进一步的输入。

您的解决方法有效，因为它在再次调用之前清除了输入缓冲区中的换行符`getchar()`。

要模拟该行为，请在打印消息之前清除输入缓冲区，

```
scanf("%s", command);
int c;
do {
    c = getchar();
}while(c != '\n' && c != EOF);
if (c == EOF) {
    // input stream ended, do something about it, exit perhaps
} else {
    printf("Type Enter to continue\n");
    getchar();
} 
```

^((1))请注意，使用`%s`in`scanf`非常不安全，您应该将输入限制为缓冲区可以容纳的字段宽度，`scanf("%99s", command)`最多会将 99 ( `sizeof(command) - 1)`) 个字符读入`command`，为 0 终止符留出空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T15:36:15.707

空白是 5y3 %s 格式说明符的分隔符，*换行符*被视为空白，因此它保持缓冲。控制台输入通常是面向行的，因此对 getchar() 的后续调用将立即返回，因为“行”仍处于缓冲状态。

```
scanf("%s", command );
while( getchar() != '\n' ){ /* flush to end of input line */ } 
```

同样，如果您使用 getchar() 或 %c 获取单个字符，您通常需要刷新该行，但在这种情况下，输入的字符本身可能是*换行符*，因此您需要稍微不同的解决方案：

```
scanf("%c", ch );
while( ch != '\n' && getchar() != '\n' ){ /* flush to end of input line */ } 
```

对于 getchar() 类似：

```
ch = getchar();
while( ch != '\n' && getchar() != '\n' ){ /* flush to end of input line */ } 
```

当然，明智的做法是将这些解决方案包装到独立的专用输入函数中，您可以重复使用这些函数，也可以将其用作放置通用输入验证和错误检查代码的地方（如 Daniel Fischer 的答案中明智地检查 EOF -您通常希望避免在任何地方重复这些检查和错误处理）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T19:09:45.083

我宁愿先使用`fgets`然后使用`sscanf`来解析输入。我一直在做这样的事情很长一段时间，并且这种行为比使用 plain 更可预测`scanf`。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-09-20T16:51:24.957

好吧，我有一些更简单的事情：添加另一个`getchar()`......问题解决了！

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-09-29T15:21:55.610

接受命令输入后刷新标准输入。

```
fflush(stdin); 
```

但是刷新输入流会导致未定义的行为（尽管 Microsoft 的 C 库将行为定义为扩展）。

# javascript - 在 Mobile Safari 上执行操作（经过一段时间后）

> ID：12653887
> 
> 赞同：1
> 
> 时间：2012-09-29T15:11:59.003
> 
> 标签：javascript, html, ios, mobile-safari, dom-events

我正在 Mobile Safari (iOS 6) 中使用 HTML5。我想在一段时间后执行 JavaScript 代码。例如在 60 秒后重定向到另一个页面。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:20:15.707

这将在 60 秒后仅执行一次您的代码：

```
setTimeout(function() {
        /* your code here */
},60000);​ 
```

虽然这

```
setInterval(function() {
        /* your code here */
},60000);​ 
```

**将每**60 秒执行一次您的代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T05:56:14.720

你试过[https://github.com/paulirish/jquery-idletimer/](https://github.com/paulirish/jquery-idletimer/)吗？

# linux - 如何解决没有根权限的“缺少共享对象”

> ID：12653889
> 
> 赞同：0
> 
> 时间：2012-09-29T15:12:03.467
> 
> 标签：linux, object, shared

最近想在我们的Linux服务器上运行一个统计软件SCILAB。我下载了软件并运行了二进制文件（软件手册说不需要安装），但我收到了以下错误消息：

“scilab-bin：加载共享库时出错：libXss.so.1：无法打开共享对象文件：没有这样的文件或目录”

我在服务器上没有 root 权限，我认为管理员不会为我安装缺少的软件包。有没有办法解决这个问题？服务器似乎在运行 Fedora 或 RedHat，并且有“yun”“rpm”。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:29:43.503

如果你可以在你的账户下的系统上获得兼容的 libXss.so，尝试将它添加到你的库路径中

```
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path/to/solib 
```

并尝试运行应用程序。

# lua - Lua 5.x 中 upvalue 的 % 是否被删除

> ID：12653890
> 
> 赞同：1
> 
> 时间：2012-09-29T15:12:18.493
> 
> 标签：lua, closures

我正在从一本有点旧的书中学习Lua。我试过在网上搜索，但由于`#`在我的搜索中使用了符号，我得到了非常令人困惑的结果。

它说要使用 upvalue，您需要使用`%`符号。

但是当我在我的代码中编写它时，我得到了一个错误。

```
Account.new = function (starting_balance)
  local self = {}
  local balance = starting_balance

  self.withdraw = function (v)
    %balance = %balance - v;
  end
  return self
end 
```

错误是：`unexpected symbol near '%'`

在 Lua 5.x 中是否有一种新的方法来处理 upvalues ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T15:39:03.363

自 Lua 5.0 起，不再有“升值符号”之类的东西。上值是声明函数的环境的局部变量，因此可以像任何其他局部变量一样简单地访问。

在您的情况下：只需使用`balance`而不是`%balance`.

从 Lua 5.1 开始，`%`用作模运算符。

一本不错但稍微过时的书是在线可用版本的[《Lua 编程》](http://www.lua.org/pil/)，当然还有[参考手册](http://www.lua.org/manual/5.2/manual.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T04:19:02.930

应该是很老的书了！在`%`Lua 5.0 中删除了 as upvalue 表示法。（2003 年发布）

从 5.0 开始，Lua 有了词法作用域；也就是说，upvalues 是自动的：

```
do
    local balance = 0
    function deposit ( v )
        balance = balance + v
        return balance
    end
end
print ( deposit ( 5 ) ) 
```

输出：

```
5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:42:50.897

我会选择关闭[http://www.lua.org/pil/6.1.html#closures](http://www.lua.org/pil/6.1.html#closures)

# epoll - 建立连接后如何在epoll ET模式下立即发送数据

> ID：12653891
> 
> 赞同：0
> 
> 时间：2012-09-29T15:12:26.430
> 
> 标签：epoll

我的服务器需要在客户端连接到它时发送数据。我正在使用 Epoll ET 模式。但是怎么做呢？谁能给我一个简单的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T04:28:28.197

假设您正在侦听您的套接字 ( `socket`, `bind`, `listen`)，并将其描述符添加到 epoll (`epoll_create`和`epoll_ctl`)，然后`epoll_wait`会告诉您何时有新的连接需要接受。

首先，您接受连接（`sockfd`是您正在侦听的套接字的描述符，`efd`是 epoll 实例）并将其添加到您的 epoll 实例中：

```
int connfd = accept4(sockfd, NULL, 0, SOCK_NONBLOCK);

struct epoll_event ev;
ev.events = EPOLLOUT | EPOLLET;
ev.data.fd = connfd;
epoll_ctl(efd, EPOLL_CTL_ADD, connfd, &ev) 
```

然后你回到你的主循环并`epoll_wait`再次调用。它会告诉你套接字何时准备好写入，而你只是高兴`write`或`sendfile`离开。

添加大量错误检查，可能`TCP_CORK`你就完成了。[github.com/grahamking/netshare/](https://github.com/grahamking/netshare/blob/master/share.c)上有一个工作示例。

我希望这能给你足够的信息来开始。

# boost - Boost.Build 和 可执行文件的功能

> ID：12653901
> 
> 赞同：2
> 
> 时间：2012-09-29T15:14:02.207
> 
> 标签：boost, boost-build, bjam

`<link>static`当我在构建可执行文件时将功能传递给需求部分时，这到底意味着什么？

```
exe main
       : main.cpp
         /libs//my_library
       : <library>/boost//thread
         <link>static
       ; 
```

这是否意味着两者都`/libs//my_library`必须`<library>/boost//thread` **使用**静态链接构建？

如果我的目标`/libs//my_library`具有`<link>static`要求集（仅使用此功能构建），如果我省略`<link>static`依赖于该库的所有目标的要求（就像上面的那个），是否会引发错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T17:06:18.043

> `<link>static`当我在构建可执行文件时将功能传递给需求部分时，这到底意味着什么？

这意味着静态构建（并链接到）依赖库。

> ```
> exe main
>        : main.cpp
>          /libs//my_library
>        : <library>/boost//thread
>          <link>static
>        ; 
> ```
> 
> 这是否意味着两者都`/libs//my_library`必须`<library>/boost//thread` 使用静态链接构建？

是的。

> 如果我的目标`/libs//my_library`具有`<link>static`要求集（仅使用此功能构建），如果我省略`<link>static`依赖于该库的所有目标的要求（就像上面的那个），是否会引发错误？

不，没关系。如果您的库有`<link>static`要求，那么无论如何它都会静态构建，并且没有必要`<link>static`仅仅为了这个库而在依赖目标中拥有。

请注意，可以请求静态构建特定的依赖库而不影响其他依赖库，如下所示：

`exe e : /libs//mylib/<link>static /libs//otherlib /libs//someotherlib`

上述内容`<link>static`不影响`otherlib`and `someotherlib`，它仅适用于`mylib`。

# java - Apache Derby 中未找到数据库错误

> ID：12653905
> 
> 赞同：2
> 
> 时间：2012-09-29T15:14:13.143
> 
> 标签：java, netbeans, jdbc, derby, javadb

首先，这是我第一次使用 Apache Derby。我正在使用netbeans，愿意使用嵌入式apache derby，并且我按照以下教程配置和安装数据库

[http://netbeans.org/kb/docs/ide/java-db.html#starting](http://netbeans.org/kb/docs/ide/java-db.html#starting)

附图将在 netbeans 中显示我的数据库状态 ![在此处输入图像描述](../Images/df0590916f94e0df097d2ac76c9f61d2.png)

我的数据库名称是“联系人”。表名是“朋友”。

以下是我的测试代码

**数据库连接器.java**

```
import java.sql.*;

public class DataBaseConnector
{
    private Connection con;

    public DataBaseConnector()
    {

    }

    private void createConnection()
    {
        try
        {
            Class.forName("org.apache.derby.jdbc.EmbeddedDriver");
            con = DriverManager.getConnection("jdbc:derby:contact","yohan","xyz");
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }

    private void closeConnection()
    {
        try
        {
            con.close();
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }

    public void insertData(int id, String firstName, String lastName)
    {
        createConnection();
        try
        {
            PreparedStatement ps = con.prepareStatement("insert into FRIENDS values(?,?,?)");
            ps.setInt(1, id);
            ps.setString(1, firstName);
            ps.setString(2, lastName);

            int result = ps.executeUpdate();

            if(result>0)
            {
                System.out.println("Data Inserted");
            }
            else
            {
                System.out.println("Something happened");
            }
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
        finally
        {
            closeConnection();
        }
    }

} 
```

**数据库UI.java**

```
import java.awt.event.*;
import javax.swing.*;
import java.awt.*;

public class DatabaseUI extends JFrame
{
    private JLabel firstName, id, lastName;
    private JTextField idTxt, firstNameTxt, lastNameTxt;
    private JButton ok;

    public DatabaseUI()
    {
     firstName = new JLabel("First Name: ");
     lastName = new JLabel("Last Name: ");
     id = new JLabel("ID: ");

     firstNameTxt = new JTextField(10);
     lastNameTxt = new JTextField(10);
     idTxt = new JTextField(10);

     ok = new JButton("OK");
     ok.addActionListener(new OKAction());

     JPanel centerPanel = new JPanel();
     centerPanel.setLayout(new GridLayout(4,2));
     centerPanel.add(id);
     centerPanel.add(idTxt);
     centerPanel.add(firstName);
     centerPanel.add(firstNameTxt);
     centerPanel.add(lastName);
     centerPanel.add(lastNameTxt);
     centerPanel.add(new JPanel());
     centerPanel.add(ok);

     getContentPane().add(centerPanel,"Center");

     this.pack();
     this.setVisible(true);

    }

    private class OKAction implements ActionListener
    {
        public void actionPerformed(ActionEvent ae)
        {
            DataBaseConnector db = new DataBaseConnector();

            int id = Integer.parseInt(idTxt.getText());

            db.insertData(id, firstNameTxt.getText().trim(), lastNameTxt.getText().trim());
        }
    }

    public static void main(String[]args)
    {
        new DatabaseUI();
    }
} 
```

但是，当我尝试将数据插入数据库时​​，它给了我以下错误

```
run:
java.sql.SQLException: Database 'contact' not found.
    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.handleDBNotFound(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection40.<init>(Unknown Source)
    at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)
    at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)
    at org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)
    at java.sql.DriverManager.getConnection(DriverManager.java:579)
    at java.sql.DriverManager.getConnection(DriverManager.java:221)
    at DataBaseConnector.createConnection(DataBaseConnector.java:17)
    at DataBaseConnector.insertData(DataBaseConnector.java:40)
    at DatabaseUI$OKAction.actionPerformed(DatabaseUI.java:52)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)
Caused by: java.sql.SQLException: Database 'contactDB' not found.
    at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)
    ... 53 more
java.lang.NullPointerException
    at DataBaseConnector.insertData(DataBaseConnector.java:43)
    at DatabaseUI$OKAction.actionPerformed(DatabaseUI.java:52)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)
java.lang.NullPointerException
    at DataBaseConnector.closeConnection(DataBaseConnector.java:29)
    at DataBaseConnector.insertData(DataBaseConnector.java:65)
    at DatabaseUI$OKAction.actionPerformed(DatabaseUI.java:52)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90) 
```

请帮我。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T15:31:08.470

连接 URL “jdbc:derby:contact” 指定应该在进程的当前工作目录中找到“联系人”数据库​​，但这可能不是它的实际位置。当您的 Java 程序运行时，当前工作目录可能已设置在其他位置。您可以通过在程序开始时打印出当前工作目录来确认这一点。

为了暂时解决这个问题，您可以指定数据库的完整路径：“jdbc:derby:/path/to/my/db/contact”。

如果这能让您走得更远，那么您可以继续前进，但在某些时候，您必须更多地考虑您希望数据库永久位于何处以及如何在程序中指定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:22:30.717

请查看您的 derby/jdbc 连接，此行在这里：

```
con = DriverManager.getConnection("jdbc:derby:contact","yohan","xyz"); 
```

检查它是否类似于：

```
"jdbc:derby://localhost:1527/contact" 
```

或者，正如我所见，您的数据库名称是 ContactDB ...请检查...

谢谢...

# javascript - 在可变位置添加一个类到列表

> ID：12653910
> 
> 赞同：0
> 
> 时间：2012-09-29T15:14:42.390
> 
> 标签：javascript, jquery

我有一个变量集，它代表列表中的一个项目。

我也有清单：

```
<ul>
    <li class="mylist"><a href="#">Item 1</a></li>
    <li class="mylist"><a href="#">Item 2</a></li>
    <li class="mylist"><a href="#">Item 3</a></li>
    <li class="mylist"><a href="#">Item 4</a></li>
    <li class="mylist"><a href="#">Item 5</a></li>
    <li class="mylist"><a href="#">Item 6</a></li>
</ul> 
```

我需要做的是将一个css类添加到变量值位置的列表中。

例如：

```
If myVariable = '1' then list will look like this:

<ul>
    <li class="mylist"><a href="#" class="myclass">Item 1</a></li>
    <li class="mylist"><a href="#">Item 2</a></li>
    <li class="mylist"><a href="#">Item 3</a></li>
    <li class="mylist"><a href="#">Item 4</a></li>
    <li class="mylist"><a href="#">Item 5</a></li>
    <li class="mylist"><a href="#">Item 6</a></li>
</ul>

If myVariable = '3' then list will look like this:

<ul>
    <li class="mylist"><a href="#">Item 1</a></li>
    <li class="mylist"><a href="#">Item 2</a></li>
    <li class="mylist"><a href="#" class="myclass">Item 3</a></li>
    <li class="mylist"><a href="#">Item 4</a></li>
    <li class="mylist"><a href="#">Item 5</a></li>
    <li class="mylist"><a href="#">Item 6</a></li>
</ul> 
```

等等。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:16:20.830

您可以使用`eq`jQuery 中的方法按索引选择元素：

```
const myVariable = 3;
$('.mylist').eq(myVariable - 1).find('a').addClass('myClass'); 
```

请注意，`eq`假设您的索引是基于 0 的（这意味着第一个是 0 而不是 1）。这就是它的原因`myVariable - 1`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T15:17:42.850

```
var value = 3;
$('ul li.mylist a').filter(function () {

    return $(this).text() === 'Item ' + value;

}).addClass('myclass'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T15:16:55.680

```
$("li.mylist").eq(position -1).find("a").addClass("myClass") 
```

# c# - 如何在 SslStream.AuthenticateAsClient 方法中使用证书回调？

> ID：12653911
> 
> 赞同：3
> 
> 时间：2012-09-29T15:14:59.923
> 
> 标签：c#, ssl, certificate, x509certificate

当我在 IE（工具/Internet 选项/内容/证书）中手动导入证书时，我的 C#.NET SSL 连接有效，但是如何通过代码加载证书？这是我的代码：

```
TcpClient client = new TcpClient(ConfigManager.SSLSwitchIP, Convert.ToInt32(ConfigManager.SSLSwitchPort));

SslStream sslStream = new SslStream(
                client.GetStream(),
                false,
                new RemoteCertificateValidationCallback(ValidateServerCertificate),
                null
                );
sslStream.AuthenticateAsClient("Test"); 
```

如果我在 Internet Explorer 中手动导入我的证书文件，上面的代码可以正常工作。但是，如果我从 IE 中删除我的证书并改用以下代码，我会得到身份验证异常：

```
sslStream.AuthenticateAsClient("Test", GetX509CertificateCollection(), SslProtocols.Default, false); 
```

这是'GetX509CertificateCollection'方法：

```
public static X509CertificateCollection GetX509CertificateCollection()
        {
            X509Certificate2 certificate1 = new X509Certificate2("c:\\ssl.txt");
            X509CertificateCollection collection1 = new X509CertificateCollection();
            collection1.Add(certificate1);
            return collection1;
        } 
```

我应该怎么做才能动态加载我的证书？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-28T00:31:14.243

为了建立 owlstead 的答案，以下是我如何在验证回调中使用单个 CA 证书和自定义链来避免 Microsoft 的商店。

我还*没有*弄清楚如何`chain2`默认使用这个链（下面），这样就不需要回调了。也就是说，将它安装在 ssl 套接字上，连接将“正常工作”。而且我还*没有*弄清楚如何安装它以便将其传递给回调。也就是说，我必须为回调的每次调用构建链。我认为这些是 .Net 中的架构缺陷，但我可能会遗漏一些明显的东西。

函数的名称无关紧要。下面，`VerifyServerCertificate`是与 相同的回调`RemoteCertificateValidationCallback`。您也可以将它用于`ServerCertificateValidationCallback`in `ServicePointManager`。

```
static bool VerifyServerCertificate(object sender, X509Certificate certificate,
    X509Chain chain, SslPolicyErrors sslPolicyErrors)
{
    try
    {
        String CA_FILE = "ca-cert.der";
        X509Certificate2 ca = new X509Certificate2(CA_FILE);

        X509Chain chain2 = new X509Chain();
        chain2.ChainPolicy.ExtraStore.Add(ca);

        // Check all properties
        chain2.ChainPolicy.VerificationFlags = X509VerificationFlags.NoFlag;

        // This setup does not have revocation information
        chain2.ChainPolicy.RevocationMode = X509RevocationMode.NoCheck;

        // Build the chain
        chain2.Build(new X509Certificate2(certificate));

        // Are there any failures from building the chain?
        if (chain2.ChainStatus.Length == 0)
            return true;

        // If there is a status, verify the status is NoError
        bool result = chain2.ChainStatus[0].Status == X509ChainStatusFlags.NoError;
        Debug.Assert(result == true);

        return result;
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex);
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T19:29:30.533

[`SslStream`](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.aspx)一个快速的谷歌向我指出了微软课堂上的一段文字。

> 身份验证由安全支持提供程序 (SSPI) 通道提供程序处理。客户端有机会通过 [`RemoteCertificateValidationCallback`](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx)在创建 SslStream 时指定委托来控制服务器证书的验证。服务器还可以通过提供 [`RemoteCertificateValidationCallback`](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx)委托来控制验证。委托引用的方法包括远程方的证书和 SSPI 在验证证书时遇到的任何错误。请注意，如果服务器指定了委托，则无论服务器是否请求客户端身份验证，都会调用委托的方法。如果服务器没有请求客户端身份验证，则服务器的委托方法会收到一个空证书和一个空的证书错误数组。

所以只需实现委托并自己进行验证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T06:38:31.183

在尝试通过 SSLStream 对象作为客户端进行身份验证之前，我编写了另一种方法来将我的证书添加到**受信任的根证书颁发机构（根）：**

```
public static void InstallCertificate()
    {
        X509Store store = new X509Store(StoreName.Root, StoreLocation.LocalMachine);
        store.Open(OpenFlags.ReadWrite);
        string fileName = "sslcert.pem";
        X509Certificate2 certificate1;
        try
        {
            certificate1 = new X509Certificate2(fileName);
        }
        catch (Exception ex)
        {
            throw new Exception("Error loading SSL certificate file." + Environment.NewLine + fileName);
        }

        store.Add(certificate1);
        store.Close();
    } 
```

接着：

```
InstallCertificate();
sslStream.AuthenticateAsClient("Test"); 
```

它工作正常，没有任何警告或错误。但基本问题仍未解决：

**如何使用证书作为客户端进行身份验证而不将其安装在 Windows 中？**

# java - Java Socks 代理套接字错误

> ID：12653912
> 
> 赞同：1
> 
> 时间：2012-09-29T15:15:22.360
> 
> 标签：java, sockets, proxy, socks

我正在尝试通过 Java 中的 SOCKS (v4 / v5) 代理创建 http 请求。在 WikiPedia 上阅读 socks 通信协议后，我将这段代码放在一起：

```
Socket sock = new Socket();
InetSocketAddress remoteProxyAddress = new InetSocketAddress(proxy ip, proxy port);
sock.connect(remoteProxyAddress, connTimeout);

InputStream in = sock.getInputStream();
OutputStream out = sock.getOutputStream();

out.write(0x04);
out.write(0x01);
out.write((endpoint.getPort() >> 8) & 0xff);
out.write((endpoint.getPort() >> 0) & 0xff);
out.write(endpoint.getAddress().getAddress());
out.write(0x0);
out.flush(); 
```

这是我从代理服务器读取的部分。问题是响应总是“-1”。

我已经在 Firefox 上尝试过代理，它运行良好。所以...问题出在我的应用程序中。

谁能帮我？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:36:56.027

你不觉得你连接的服务器只支持 Socks v5 协议吗？

您的连接请求一切正常。如果服务器启用了 v4，您的代码应该可以正常工作。我使用非常相似的实现绝对成功。

您还应该看看这个[Socket()](http://docs.oracle.com/javase/7/docs/api/java/net/Socket.html#Socket%28java.net.Proxy%29)构造函数 - 它可能足以满足您的需要。它存在于 JRE 1.6 和 JRE 1.7 中

# javascript - 函数式编程的第一个变量值？

> ID：12653913
> 
> 赞同：-1
> 
> 时间：2012-09-29T15:15:30.563
> 
> 标签：javascript

```
(function() {

    var sample = "sample1";

    (function() {

        // set sample variable 
        sample = "sample2";

        (function() {

            // set sample variable
            sample = "sample3";
        }());
    }());

    console.log(sample); // "sample3"
}()); 
```

所以; 样本名称@variable console.log 结果“sample3”；我如何获得第一个变量？“样品1”？？

```
console.log(sample); // --> "sample1" ?? 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:16:30.300

声明你的变量而不是分配给外部变量？

```
var sample = "sample2"; 
```

还有，*为什么*？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T15:27:45.220

赋值*会更改*您存储在变量中的值。无法恢复旧值。

## 引用变量

每当你引用一个变量——读取或写入它，即——JavaScript 将沿着[作用域](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work) [链](https://stackoverflow.com/questions/1484143/scope-chain-in-javascript)向上移动，直到找到该名称的变量，否则它将在最顶层的作用域中创建它：`window`，即全局作用域。

## 声明变量

`var`在当前范围内声明一个新变量。如果您要将每个分配添加到`sample`with `var`，则变量会[影响](https://stackoverflow.com/questions/5373278/variable-shadowing-in-javascript)外部变量。为什么？让我们回想一下，当您引用变量时，JavaScript 会沿着作用域链向上传播。显然，它会首先在嵌套作用域中找到那些，阻止它在父作用域中进一步查找。

## 你的代码本质上是做什么的

请记住，当您引用变量时会发生什么，我们可以将您的代码转换为此，这在语义上是等效的（即，这*正是*您的代码所做的）：

```
var sample = "sample1";
sample = "sample2";
sample = "sample3";
console.log(sample); 
```

显然，它会被打印出来`sample3`，你不能神奇地让旧值重新出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T15:50:35.393

您可以在每个范围内声明一个自`sample`变量：

```
(function() {

    var sample = "sample1";

    (function() {

        // set sample variable 
        var sample = "sample2";

        (function() {

            // set sample variable
           var sample = "sample3";
        }());
    }());

console.log(sample); // "sample1"
}()); 
```

[在这里试试。](http://jsfiddle.net/nz9jZ/1/)

# c# - c#减法即使使用小数也不准确？

> ID：12653916
> 
> 赞同：-4
> 
> 时间：2012-09-29T15:16:18.940
> 
> 标签：c#, math

我正在学习 TDD，并决定创建一个 Calculator 类来开始。我先做了基本的，现在我在平方根函数上。

我正在使用这种方法来获取根[http://www.math.com/school/subject1/lessons/S1U1L9DP.html](http://www.math.com/school/subject1/lessons/S1U1L9DP.html) 我用很少的数字对其进行了测试，而且我总是得到准确的答案。很容易理解。

现在我遇到了一个奇怪的问题，因为有一些数字，我得到了正确的答案，而有一些，我没有。

我调试了代码，发现当我使用减法时我没有得到正确的答案。

我使用小数来获得最准确的结果。

当我做：

```
18 / 4.25 
```

我目前得到：`4.2352941176470588235294117647`

什么时候应该：（ `4.2352941176470588235294117647059`使用 Windows 计算器）

在路的尽头，这是我最接近的根源`18`：

```
4.2426406871192851464050688705 ^ 2 = 18.000000000000000000000022892 
```

我的问题是：

我可以更准确吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T15:31:32.423

`4.2352941176470588235294117647`包含 29 位数字。

[`decimal`](http://msdn.microsoft.com/en-us/library/364x0z75.aspx)定义为具有 28-29 位有效数字。您无法将更准确的数字存储在`decimal`.

您在哪个工程或科学领域工作，第 30 位或更多位对整体计算的*准确性很重要？*

（如果您显示更多实际代码，它也可能会有所帮助。您显示的唯一代码是`18 / 4.25`，它不能是代码中的实际表达式，因为第二个数字是`double`文字，您可以'不要将此表达式的结果分配给`decimal`没有强制转换的a）。

* * *

如果您需要任意精度，则没有标准的“BigRational”类型，但有一个[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx). 如果需要，可以使用它来构造`BigRational`类型（将分子和分母存储为两个单独的整数）。为什么还没有标准类型的一种猜测是，关于*何时*规范化这些有理数的决定可能会影响性能或相等比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T15:19:02.433

浮点计算不准确。小数可以提高精度，因为它们是 128 位长，但它们仍然是浮点数。

比较两个浮点数不是用 来完成的`==`，而是：

```
static bool SameDecimal(decimal a, decimal b)
{
    return Math.Abs(a-b) < 1e-10;
} 
```

这种方法将允许您比较两位小数（我假设 1e-10 对您来说是一个足够小的差异，它应该是日常使用的）。

# c# - 如何将菜单项的方向设置为向右？

> ID：12653918
> 
> 赞同：1
> 
> 时间：2012-09-29T15:16:26.027
> 
> 标签：c#, .net, wpf, menu

如何将某个菜单项的水平对齐设置为如下所示？

![在此处输入图像描述](../Images/c0e23a06ad9891f59f91f3c443b396b4.png)

在 XAML 中设置 Horizo​​ntalAlignment="Right" 不是答案。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:25:23.573

这个布局对你有帮助吗？

```
 <Menu Height="20" >
                <Menu.ItemsPanel>
                    <ItemsPanelTemplate>
                        <DockPanel HorizontalAlignment="Stretch"/>
                    </ItemsPanelTemplate>
                </Menu.ItemsPanel>
                <MenuItem Header="File">
                    <MenuItem Header="three"/>
                </MenuItem>
                <MenuItem Header="Edit">
                    <MenuItem Header="two"/>
                </MenuItem>
                <MenuItem Header="Tools">
                    <MenuItem Header="one"/>
                </MenuItem>
                    <MenuItem Header="Help" HorizontalAlignment="Right">
                        <MenuItem Header="zero"/>
                    </MenuItem>
            </Menu> 
```

看起来像你的例子。

# c++ - 从模板类继承的非模板类的部分特化

> ID：12653922
> 
> 赞同：1
> 
> 时间：2012-09-29T15:16:59.207
> 
> 标签：c++, templates, inheritance, partial-specialization

## 示例 1

如果我们有`Base`和`Derived`类

```
class Base
{};
class Derived : public Base
{}; 
```

和一个模板类

```
template <class T, class Enabler=void>
class Partialy
{
public:
    void say()
    {
        std::cout << "Partialy Default" << std::endl;
    }
}; 
```

我们可以用下面的方式写一个偏特化：

```
template <class T>
class Partialy<T, typename std::enable_if<std::is_base_of< Base, T >::value>::type>
{
public:
    void say()
    {
        std::cout << "Partialy special" << std::endl;
    }
}; 
```

**示例 1**可以正常工作。（完整代码：http: [//ideone.com/4FyrD](http://ideone.com/4FyrD)）

## 示例 2

如果我只制作`Base`一个类模板：

```
template <class T>
class BaseTpl
{};
class DerivedTpl : public BaseTpl<int>
{}; 
```

下一个部分专业化不起作用：

```
template <class T, class Ta>
class Partialy<T, typename std::enable_if<std::is_base_of< BaseTpl<Ta>, T >::value>::type>
{
public:
    void say()
    {
        std::cout << "Partialy special with TPL" << std::endl;
    }
}; 
```

**示例 2**无法编译编译器抛出错误`"template parameters not used in partial specialization:"`（完整代码：http: [//ideone.com/gZ6J2](http://ideone.com/gZ6J2)）

## 问题

***所以问题是。有什么方法可以编写适用于所有派生自`BaseTpl`.***

专业化工作的类列表：

```
class A1 : public BaseTpl<int>
class A2 : public BaseTpl<std::string>
class A3 : public BaseTpl<vector<int> >
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:31:57.687

按照你的方式，编译器不可能匹配`Ta`任何类型。想象一下你有这个：

```
class DerivedTpl : public BaseTpl<int>, public BaseTpl<char>
{}; 
```

`Ta`尝试匹配时会是什么类型？

对于您的特定问题，一种解决方案是在上面引入一个包罗万象的基类`BaseTpl`：

```
class BaseNonTpl {};

template <class T>
class BaseTpl : BaseNonTpl
{}; 
```

然后，修改部分特化以查找该基类。

```
template <class T>
class PartialyTpl<T, typename std::enable_if<std::is_base_of< BaseNonTpl, T >::value>::type> 
```

这样，编译器就不必尝试找出您打算使用的基类。

# sql - 使存储过程通用

> ID：12653925
> 
> 赞同：-2
> 
> 时间：2012-09-29T15:17:40.470
> 
> 标签：sql, stored-procedures

我必须使我用 SQL 编写的存储过程具有通用性，以便它们可以在不同版本的 SQL 中使用（如果可能，也可以在 MySQL 中使用）。我认为如果脚本是按照 ANSI 标准编写的，就可以做到。但我必须转换大程序。没有直接转换的工具。是否有任何可以遵循的规则来执行此转换？

我找到了一个工具来验证脚本@ [http://developer.mimer.com](http://developer.mimer.com)

但这将非常耗时，因为我有大型 SP，而且我认为通过使用一些规则书，这项任务可以在更短的时间内完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T16:35:47.450

没有通用的存储过程语言。

如果您需要跨数据库平台工作，您最好在代码中实现 SP 功能，使用 ANSI 标准 SQL 进行数据库访问。

# java - java swing：在paintComponent方法中如何知道要重绘什么？

> ID：12653927
> 
> 赞同：3
> 
> 时间：2012-09-29T15:17:42.487
> 
> 标签：java, swing

我的组件比屏幕大，它的一部分没有显示（我将使用滚动条）。
当我接到一个电话时，`paintComponent(g)`我怎么知道我应该画什么区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-15T19:43:42.983

您可以通过查询对象的剪辑边界来找出实际必须绘制的区域`Graphics`。

对于这种方法，JavaDoc 似乎有点过时了：它说它可能会返回一个`null`剪辑。然而，这显然不是这种情况（并且其他 Swing 类也依赖于剪辑从不存在`null`！）。

以下[MCVE](https://stackoverflow.com/help/mcve)说明了使用剪辑或绘制整个组件之间的区别：

![剪辑演示](../Images/131589fb13d2b703e19f9cda4a3e27a0.png)

它包含一个`JPanel`大小为 800x800 的滚动窗格。面板绘制一组矩形，并打印已绘制的矩形数量。

可以使用“使用剪辑边界”复选框来启用和禁用剪辑。使用剪辑时，仅重绘面板的*可见*区域，矩形的数量要少得多。（注意这里测试一个矩形是否必须被绘制比较简单：它只执行矩形与可见区域的相交测试。对于实际应用程序，可以*直接*使用剪辑边界来找出哪些矩形必须画）。

这个例子还展示了滚动窗格的一些棘手的内部结构：当闪烁关闭并且滚动条被移动时，人们可以看到——尽管整个可见区域发生了变化——实际上只有一个很小的区域需要重新绘制（即由于滚动而变得可见的区域）。另一部分简单地按原样移动，通过 blitting 先前的内容。可以使用[JViewport.html#setScrollMode](http://docs.oracle.com/javase/8/docs/api/javax/swing/JViewport.html#setScrollMode-int-)修改此行为。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JCheckBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class PaintRegionTest
{
    public static void main(String[] args) throws Exception
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                createAndShowGUI();
            }
        });
    }

    private static void createAndShowGUI()
    {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final PaintRegionPanel paintRegionPanel = new PaintRegionPanel();
        paintRegionPanel.setPreferredSize(new Dimension(800, 800));

        final Timer timer = new Timer(1000, new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                paintRegionPanel.changeColor();
            }
        });
        timer.setInitialDelay(1000);
        timer.start();

        JScrollPane scrollPane = new JScrollPane(paintRegionPanel);
        frame.getContentPane().setLayout(new BorderLayout());
        frame.getContentPane().add(scrollPane, BorderLayout.CENTER);

        JPanel controlPanel = new JPanel(new FlowLayout());

        final JCheckBox blinkCheckbox = new JCheckBox("Blink", true);
        blinkCheckbox.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                if (blinkCheckbox.isSelected())
                {
                    timer.start();
                }
                else
                {
                    timer.stop();
                }
            }
        });
        controlPanel.add(blinkCheckbox);

        final JCheckBox useClipCheckbox = new JCheckBox("Use clip bounds");
        useClipCheckbox.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                paintRegionPanel.setUseClipBounds(
                    useClipCheckbox.isSelected());
            }
        });
        controlPanel.add(useClipCheckbox);

        frame.getContentPane().add(controlPanel, BorderLayout.SOUTH);

        frame.setPreferredSize(new Dimension(400, 400));
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
}

class PaintRegionPanel extends JPanel
{
    private Color color = Color.BLACK;
    private boolean useClipBounds = false;

    void setUseClipBounds(boolean useClipBounds)
    {
        this.useClipBounds = useClipBounds; 
    }

    void changeColor()
    {
        if (color == Color.BLACK)
        {
            color = Color.RED;
        }
        else
        {
            color = Color.BLACK;
        }
        repaint();
    }

    @Override
    protected void paintComponent(Graphics gr)
    {
        super.paintComponent(gr);
        Graphics2D g = (Graphics2D)gr;

        g.setColor(color);

        Rectangle clipBounds = g.getClipBounds();
        Rectangle ownBounds = new Rectangle(0,0,getWidth(),getHeight());

        System.out.println("clipBounds: " + clipBounds);
        System.out.println(" ownBounds: " + ownBounds);

        Rectangle paintedRegion = null;
        if (useClipBounds)
        {
            System.out.println("Using clipBounds");
            paintedRegion = clipBounds;
        }
        else
        {
            System.out.println("Using ownBounds");
            paintedRegion = ownBounds;
        }

        int counter = 0;

        // This loop performs a a simple test see whether the objects 
        // have to be painted. In a real application, one would 
        // probably use the clip information to ONLY create the
        // rectangles that actually have to be painted:
        for (int x = 0; x < getWidth(); x += 20)
        {
            for (int y = 0; y < getHeight(); y += 20)
            {
                Rectangle r = new Rectangle(x + 5, y + 5, 10, 10);
                if (r.intersects(paintedRegion))
                {
                    g.fill(r);
                    counter++;
                }
            }
        }
        System.out.println("Painted "+counter+" rectangles ");
    }

} 
```

顺便说一句：对于许多应用案例，几乎不需要这样的“优化”。无论如何，绘制的元素与剪辑相交，因此可能不会获得太多性能。当“准备”要绘制的元素在计算上很昂贵时，可以将其视为一种选择。（在示例中，“准备”是指创建`Rectangle`实例，但可能有更复杂的模式）。但在这些情况下，可能还有比手动检查剪辑边界更优雅、更简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:55:49.583

我不确定这是否是您的意思，但问题是您每次接到电话`repaint()`时都必须拨打电话，否则更新将在.`JScrollPane``paintComponent(Graphics g)``JPanel``JPanel``JScrollPane`

我还看到您想使用`JScrollBar`（或者您可能混淆了术语）？我推荐一个`JScrollPane`

我做了一个小例子，它`JPanel`有一个网格，每 2 秒改变一次颜色（从红色变为黑色，反之亦然）。/ `JPanel`Grid 大于`JScrollPane`; 无论我们必须调用实例`repaint()`，`JScrollPane`否则网格不会改变颜色：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class Test {

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().createAndShowUI();
            }
        });
    }

    private void createAndShowUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        initComponents(frame);
        frame.setPreferredSize(new Dimension(400, 400));
        frame.pack();
        frame.setVisible(true);
    }

    private void initComponents(JFrame frame) {
        JScrollPane jsp = new JScrollPane();
        jsp.setViewportView(new Panel(800, 800, jsp));
        frame.getContentPane().add(jsp);
    }
}

class Panel extends JPanel {

    private int across, down;
    private Panel.Tile[][] tiles;
    private Color color = Color.black;
    private final JScrollPane jScrollPane;

    public Panel(int width, int height, JScrollPane jScrollPane) {
        this.setPreferredSize(new Dimension(width, height));
        this.jScrollPane = jScrollPane;
        createTiles();
        changePanelColorTimer();//just something to do to check if its repaints fine
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        for (int i = 0; i < across; i++) {
            for (int j = 0; j < down; j++) {
                g.setColor(color);
                for (int k = 0; k < 5; k++) {
                    g.drawRect(tiles[i][j].x + k, tiles[i][j].y + k, tiles[i][j].side - k * 2, tiles[i][j].side - 2 * k);
                }
            }
        }
        updateScrollPane();//refresh the pane after every paint
    }

    //calls repaint on the scrollPane instance
    private void updateScrollPane() {
        jScrollPane.repaint();
    }

    private void createTiles() {
        across = 13;
        down = 9;
        tiles = new Panel.Tile[across][down];

        for (int i = 0; i < across; i++) {
            for (int j = 0; j < down; j++) {
                tiles[i][j] = new Panel.Tile((i * 50), (j * 50), 50);
            }
        }
    }

    //change the color of the grid lines from black to red and vice versa every 2s
    private void changePanelColorTimer() {
        Timer timer = new Timer(2000, new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                if (color == Color.black) {
                    color = Color.red;
                } else {
                    color = Color.black;
                }
            }
        });
        timer.setInitialDelay(2000);
        timer.start();
    }

    private class Tile {

        int x, y, side;

        public Tile(int inX, int inY, int inSide) {
            x = inX;
            y = inY;
            side = inSide;
        }
    }
} 
```

在`Panel`课堂上，如果我们评论该行`updateScrollPane();`，`paintComponent(Graphics g)`我们不会看到网格改变颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-15T18:34:11.667

所有的答案都是错误的。所以我决定回答这个问题，尽管这个问题已经有两年了。

我相信正确的答案是在方法`g.getClipBounds()`内部调用`paintComponent(Graphics g)`。它将返回控件坐标系中无效且必须重绘的区域的矩形。

# build - 以编程方式生成 OpenType 字体：请求 HOWTO

> ID：12653932
> 
> 赞同：2
> 
> 时间：2012-09-29T15:18:52.600
> 
> 标签：build, fonts, svg, automation, opentype

背景：Adobe 在 GitHub 上发布了他们的第一个开源字体。Repos 由许多具有不同语法的文件组成，其中一些是二进制文件。参见例如[https://github.com/adobe/source-sans-pro](https://github.com/adobe/source-sans-pro)

在相应的 README 文件中，构建过程概述如下：

*> 构建 OTF 或 TTF 字体的关键是`makeotf`，它是 AFDKO 工具集的一部分。*
*> 在此存储库中，所有必要的文件都已准备好构建 OTF 和 TTF 字体。*

它有效，但无助于我对字体创建过程的理解。我找到了一些格式的规格，但很少了解它们的作用。一个好的 HOWTO 会有很大帮助。

主要问题是，**我有 SVG**（或任何其他矢量）格式的字形和每个字形的必要指标。为了简单起见，我们还假设字距调整现在不是问题。

**如何**使用这些自动构建 OTF（或 TTF）字体文件？

我对编程和阅读 f. 手册，只是不知道从哪里开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T20:36:19.857

据我所知，您可以使用支持从命令行编写脚本的[FontForge](http://fontforge.org)来做到这一点。[这里](http://tinkerhouse.net/log/python-fontforge-is-definitely-a-godsend/)有一些关于使用 FontForge Python 脚本从 svg 创建字体的教程。

# android - sdk 管理器不显示包

> ID：12653935
> 
> 赞同：0
> 
> 时间：2012-09-29T15:19:14.647
> 
> 标签：android

我已经从developers.android.com 安装了android sdk，并下载了一个名为installer_r20.0.3-windows.exe 的文件。在我运行这个文件 android sdk 后安装。但是当我在它之后运行 sdk 管理器时，它没有显示任何包。它只是显示安装的工具。

![sdk 管理器的快照如下](../Images/759987b729fc2aa0dd37e74b4bc32ae0.png)

我在这个网站上搜索过，我们很多人写的解决方案是设置代理设置，但是我在我的笔记本电脑中使用无线家庭网络，并且在我的互联网选项中没有指定任何代理设置...... …………

任何人都可以帮我解决这个问题......我只是停留在这一点......

请告诉我问题是什么以及如何解决它。

提前谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T10:01:32.280

`SDK manager`在-> `tools`-> `options`->下设置代理设置`port:8080`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T07:44:02.760

“我们可以在 SDK 管理器中设置代理。在工具 -> 选项中。”

如果您使用代理... 设置代理和端口，如（控制面板 -> Internet 选项 -> 连接）中所示

有用的链接：

[防火墙：](https://stackoverflow.com/questions/13819106/android-sdk-failed-to-fetch-url)

[代理和端口：](https://stackoverflow.com/questions/8613317/android-sdk-installation-failed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:28:16.540

尝试清除缓存（工具 > 选项，然后单击清除缓存），然后重新加载（包 > 重新加载）。

![对话框右侧中心的清除缓存按钮](../Images/4fb9dcd7c52f7a456a1b25f4f2c3c995.png)

# c++ - 通过套接字发送二进制文件。文本文件工作，没有其他工作？

> ID：12653936
> 
> 赞同：0
> 
> 时间：2012-09-29T15:19:22.717
> 
> 标签：c++, sockets, file-io

我可以发送非常大的文本文件没问题。我尝试发送 jpg 等，但它不会工作。文件大小正确。我不知道我错过了什么。我通过在发送到 temp.foo 文件之前写入数据来检查我的读写功能。我检查它，它可以处理任何事情。

我这样发送

```
for(vector< .... >::iterator it = v.begin(); it!=v.end(); ++it ){
    pair<...> p=*it;
    send(s,p.first,p.second,0);
} 
```

然后另一个程序读取它

```
 for(i = 0; i < size; i+=max){
    b= 0;
    while (b== 0) {
        if ((b = recv(s, buf, max, 0)) == -1) {
            perror("recv");
            exit(1);
        }
}
    stringstream ss;
    ss << buf;
    char * out = (char*)malloc(b); 
    memcpy(out,buff,numbytes);// Perhaps my error is here?
}
// write function call here 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T15:24:52.230

关于处理二进制数据的一些一般要点：

1.  确保以二进制模式打开输入和输出文件，例如使用[`ios::binary`](http://www.cplusplus.com/doc/tutorial/files/)标志或[“rb”](http://www.cplusplus.com/reference/clibrary/cstdio/fopen/)或[“wb”](http://www.cplusplus.com/reference/clibrary/cstdio/fopen/)格式。默认为文本模式，它将破坏二进制文件中的行尾字符。

2.  二进制文件可以有 NUL 字节 ( `\0`)，这意味着您不能使用处理 NUL 终止字符串的字符串处理函数。C 字符串不是 NUL 安全的。例如，此代码将无法`ss`正确填写，因为它解释`buf`为以 NUL 结尾的字符串：

    ```
    stringstream ss;
    ss << buf; 
    ```

另外，在你指出的那一行，是`buff`有两个`f`sa 错字吗？在其他行中，您`buf`使用 one引用`f`。

```
memcpy(out,buff,numbytes);// Perhaps my error is here? 
```

# asterisk - 接听电话后无法获取通道变量。（星号）

> ID：12653937
> 
> 赞同：1
> 
> 时间：2012-09-29T15:19:31.907
> 
> 标签：asterisk

我正在使用 Asterisk 和 dot net 发送将播放预先录制的消息的呼叫。有人建议我在拨号计划中使用拨号命令。我的拨号方案

```
[cpc_sendcall]
exten => _X.,1,Set(CHANNEL(userfield)=${actionid})
same => n,NoOp(RecordCall: ${dorec})
same => n,GotoIf($[${dorec}=1]?record:norecord)
same => n(record),mixmonitor(${recfile}.gsm)
same => n(norecord),dial(SIP/${EXTEN}@${carrier},45,G(cpc_doamd,s,1))
same => n,hangup
same => n,CELGenUserEvent(CPC-Failed,${myactionid},HC:${HANGUPCAUSE},DS:${DIALSTATUS})

[cpc_doamd]
exten => s,1,answer
same => n,AMD
same => n,GotoIf($[${AMDSTATUS}=HUMAN]?humn:mach)
same => n(humn),CELGenUserEvent(CPC-LiveAnswer,${myactionid})
same => n,WaitForSilence(500)
same => n,NoOp(ProductLA: ${myproductla})
same => n,goto(${myproductla},s,1)
same => n,Hangup
same => n(mach),CELGenUserEvent(CPC-AnsweringMachine,${myactionid})
same => n,NoOp(ToneDigit: ${mytonedigit})
same => n,goto(cpc_tonevmdigit,${mytonedigit},1)
same => n,NoOp(ProductAM: ${myproductam})
same => n,goto(${myproductam},s,1)
same => n,Hangup

[cpc_tonevmdigit]
exten => _X,1,senddtmf(${EXTEN})
same => n,return
exten => 10,1,senddtmf(*)
same => n,return
exten => 11,1,senddtmf(#)
same => n,return
exten => 12,1,WaitForSilence(2000,1,120)
same => n,WaitForSilence(200,2,1)
same => n,return 
```

和起源命令

```
Action: Originate
Channel: local/7062675733@cpc_sendcall
Exten: 7062675733
Context: gp_playintro
Async: 1
Priority: 1
Timeout: 60000
ActionID: GNE-1-1-1-0-0-1-7062675733-40304
Variable: assignmentid=ff830065-2419-4134-be89-36873d99e7c3,dorec=0,tonedigit=12,predigits=-1,postdigits=-1,playcompanygreeting=0,pin=-1,dosvr=0,playSurveyNotice=0,dolat=0,playlatnotice=0,playcompanytrailer=0,productam=gpstart,productla=gpstart,actionid=GNE-1-1-1-0-0-1-7062675733-40304,carrier=excel
CallerId: 4053084474
Account: G1 
```

我想知道这是拨打这个电话的正确方法吗？接听电话后，如何访问我设置的频道变量？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T15:30:34.923

使用 sip 调用时，您必须使用本地频道。一旦频道被挂断，vars就消失了。您可以通过使用本地频道来解决此问题。

这是一个很好的资源：

[https://blogs.reucon.com/asterisk-java/originate-using-asterisk-local-channels-566/](https://blogs.reucon.com/asterisk-java/originate-using-asterisk-local-channels-566/)

# php - 我无法在 php 中运行客户端/服务器程序

> ID：12653941
> 
> 赞同：2
> 
> 时间：2012-09-29T00:43:20.923
> 
> 标签：php, sockets, client-server

这是我要运行的程序：

```
$host = "127.0.0.1";
$port = 25003;
// don't timeout!
set_time_limit(0);
// create socket
$socket = socket_create(AF_INET, SOCK_STREAM, 0) or die("Could not create socket\n");
// bind socket to port
$result = socket_bind($socket, $host, $port) or die("Could not bind to socket\n");
// start listening for connections
$result = socket_listen($socket, 3) or die("Could not set up socket listener\n");

// accept incoming connections
// spawn another socket to handle communication
$spawn = socket_accept($socket) or die("Could not accept incoming connection\n");
// read client input
$input = socket_read($spawn, 1024) or die("Could not read input\n");
// clean up input string
$input = trim($input);
echo "Client Message : ".$input;
// reverse client input and send back
$output = strrev($input) . "\n";
socket_write($spawn, $output, strlen ($output)) or die("Could not write output\n");
// close sockets
socket_close($spawn);
socket_close($socket); 
```

我在 WAMP 中启用了 PHP_socket 选项，但仍然出现无法绑定等错误。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:25:48.307

为我工作。

可能出现的问题：

1) 有另一个程序副本正在运行并锁定端口。

2) 客户端尝试连接到“localhost”而不是“127.0.0.1”。在 Windows 上，我注意到它们不一定相同。根据您的网络安装，“localhost”可能映射到`::1`IPv6，而`127.0.0.1`IPv4。

**测试**

```
$ php -q test.php &
[1] 2855

# Now we try again a SECOND copy...
$ php -q test.php

PHP Warning:  socket_bind(): unable to bind address [98]: Address already in use in test.php on line 9
Could not bind to socket

$ telnet 127.0.0.1 25003
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
HELLO WORLD.
Client Message : HELLO WORLD..DLROW OLLEH
Connection closed by foreign host. 
```

# asp.net - 无法从 asp.net 发送电子邮件

> ID：12653942
> 
> 赞同：1
> 
> 时间：2012-09-29T15:20:34.093
> 
> 标签：asp.net, .net

它适用于特定的电子邮件地址，但其余电子邮件不起作用..出现以下错误：

```
Server Error in '/RealTimeArsenicDataVisualizer' Application.
Mailbox name not allowed. The server response was: From address not verified - see http://help.yahoo.com/l/us/yahoo/mail/original/manage/sendfrom-07.html 
```

我的代码：

```
 System.Net.Mail.SmtpClient client = new System.Net.Mail.SmtpClient("smtp.mail.yahoo.co.in", 587);

        client.UseDefaultCredentials = false;
     client.Credentials = new System.Net.NetworkCredential(emailid, password);

            client.Port = 587;

            client.Host = "smtp.mail.yahoo.co.in";

            client.EnableSsl = false;

            object userstate = msg;

            client.Send(msg); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:30:27.983

将您的代码更改为以下内容：

```
client.Port = 465;

client.Host = " smtp.mail.yahoo.com";
client.EnableSsl = true; 
```

# build - 使用VS 2012构建WebKit后，MiniBrowser无法运行。找不到 msvcr80.dll

> ID：12653946
> 
> 赞同：0
> 
> 时间：2012-09-29T15:21:10.937
> 
> 标签：build, webkit, visual-studio-2012

最近，我尝试用 VS2012 构建 WebKit。这花了我很多时间来修复错误。构建成功后，MiniBrowser 无法正常运行。

构建环境：MSVS 2012 Windows 8 x64

我已经修复了它提醒我的所有错误，但是在调试模式下构建后，MiniBrowser 无法运行。它只是提醒以下内容：

程序无法启动，因为您的计算机缺少 MSVCR80.dll。尝试重新安装程序以解决此问题。

但是当我在发布模式下构建它时，MiniBrowser 只是正常运行，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T16:03:45.090

一旦我遇到了这个问题。检查以下链接，这可能会对您有所帮助。

[http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/6d16ecce-f92b-4c53-a45b-40119c4566a6/](http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/6d16ecce-f92b-4c53-a45b-40119c4566a6/)

# javascript - setTimeOut 代码不适用于 jQuery

> ID：12653948
> 
> 赞同：0
> 
> 时间：2012-09-29T15:21:48.527
> 
> 标签：javascript, jquery

我有这段代码，但它只执行一次......

```
$('.' + container).hover(function() {   
        t = setTimeout( function(elem){
            //this should be executed as long as I hover, 
            //with interval declared in viewSpped variable
            $(elem).find('img').first().appendTo('.' + container).fadeOut(500);
            $(elem).find('img').first().fadeIn(800);    

        }(this), viewSpeed);

    }... 
```

知道我做错了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T15:23:42.683

`setTimeout`不带参数调用它的回调。所以`elem`不会传递给你的回调。如果您尝试执行自调用函数，那么您所做的就是立即调用您的函数，而不是将回调传递给`setTimeout()`.

我不知道您期望`elem`是什么，但如果您希望它成为悬停的项目，您可以这样做：

```
$('.' + container).hover(function() {   
    var self = $(this);
    t = setTimeout( function(){
        //this should be executed as long as I hover, 
        //with interval declared in viewSpped variable
        self.find('img').first().appendTo('.' + container).fadeOut(500);
        self.find('img').first().fadeIn(800);    

    }, viewSpeed);
}... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T15:22:44.667

[setTimeout](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)只调用一次回调，这很正常。

如果您希望函数定期执行，也许您需要[setInterval 。](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

而且，顺便说一句，您的代码中还有另一个错误：您可能想要

```
t = setInterval( function(elem){
        //this should be executed as long as I hover, 
        //with interval declared in viewSpped variable
        $(elem).find('img').first().appendTo('.' + container).fadeOut(500);
        $(elem).find('img').first().fadeIn(800);    
    }, viewSpeed, this); 
```

回调传递`setInterval`或传递`setTimeout`给回调的参数在持续时间之后。

或者，为了更加兼容（请注意，我提供的链接也提供了 IE 的解决方法）：

```
var $elem = $(this);
t = setInterval( function(){
         $elem.find('img').first().appendTo('.' + container).fadeOut(500);
         $elem.find('img').first().fadeIn(800);    
}, viewSpeed); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T15:24:06.460

您正在立即调用该函数，而不是将其用作回调（无论如何它都不起作用，因为您需要传递一个参数），我认为您的意思也是`setInterval`.

```
var elem = $(this);
var container = $('.' + container);

t = setInterval(function() {
        elem.find('img').first().appendTo(container).fadeOut(500);
        elem.find('img').first().fadeIn(800);
    }, viewSpeed); 
```

# ruby-on-rails-3 - 如何在 Heroku 上运行延迟作业的排队任务？

> ID：12653950
> 
> 赞同：1
> 
> 时间：2012-09-29T15:21:57.800
> 
> 标签：ruby-on-rails-3, heroku, automation, delayed-job

我目前正在使用delayed_job gem 在我的应用程序中排队和运行后台任务。在本地系统中，我只能使用它`rake jobs:work`来运行排队的任务。但是，当我将我的应用程序部署到 Heroku 上时，我不想继续使用 rake 命令。相反，我希望自动调用 rake 命令。有没有办法做到这一点，而无需支付 Heroku 的工人费用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T07:30:12.370

前面说您需要工人是正确的，但是您确实有免费的工人时间。每月有 750 个免费小时[http://www.heroku.com/pricing#1-0](http://www.heroku.com/pricing#1-0)。假设一个月 31 天是 744 小时，那么您每个月至少有 6 个免费工作小时可供使用。

如果您使用无工作 gem [https://github.com/lostboy/workless](https://github.com/lostboy/workless)这将仅在需要时启动工作人员（即在延迟作业中等待的工作），然后再次将其关闭。非常适合我的应用程序，每月 6 小时的后台处理时间足以满足我的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:26:53.067

我使用[cron](https://devcenter.heroku.com/articles/scheduler)没有问题（使用 django）。您所需要做的就是将您可以在命令之后执行的相同命令配置为任务`heroku run`。

请记住，cron 时间计算为工作时间，请确保命令结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T17:08:18.120

不，没有工人你做不到。

# php - 通过 iTunes 附属计划链接到特定曲目

> ID：12653952
> 
> 赞同：3
> 
> 时间：2012-09-29T15:22:13.573
> 
> 标签：php, ios, itunes, dynamic-linking, affiliate

我的 iPhone 应用程序通过 linkshare 附属程序链接到 iTunes 商店中的歌曲，到目前为止，我一直在手动创建链接——虽然这很耗时，但我之前没有遇到任何问题。该应用程序每天都有新歌曲，手动创建链接已经失控。但是，在阅读了所有会员计划文档后，我找不到链接到商店中特定曲目的方法 - 不使用链接构建器。我拥有的歌曲的唯一数据是曲目名称、艺术家姓名和专辑名称。

显然我可以使用搜索 api，但这似乎无法启用附属链接 - 所以我无法从销售中受益。

```
http://itunes.apple.com/search?term='.$tracksearch.'&country=gb&media=music&entity=musicTrack&attribute=musicTrackTerm&limit=1 
```

所以我的问题是，我将如何根据我拥有的三条数据通过 linkshare 联盟计划链接到特定轨道？

（我正在使用 PHP 进行任何基本的数据交互 - 以防万一有人提供任何编码方法 - 请记住，我想在服务器上生成链接，以便我的应用程序可以简单地从那里获取数据。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T20:37:05.983

> 显然我可以使用搜索 api，但这似乎无法启用附属链接 - 所以我无法从销售中受益。

Search API 正是您想要使用的工具。API 将返回您需要的链接，您可以在获得该信息后对链接进行关联编码。

编码过程可以在此处的文档中找到：http: [//www.apple.com/itunes/affiliates/resources/documentation/linking-to-the-itunes-music-store.html](http://www.apple.com/itunes/affiliates/resources/documentation/linking-to-the-itunes-music-store.html)

# php - PHP 将变量存储在数组中

> ID：12653953
> 
> 赞同：1
> 
> 时间：2012-09-29T15:22:23.947
> 
> 标签：php, arrays

我正在尝试将变量 score 保存在 $chartdata[0] 数组中。如果我输入一个常规值，比如说“20”，我没有问题。但是，当我尝试引用 $score 变量时，值不会存储在数组中。如果我使用随机函数，它工作得很好，即使我回显分数，我也可以看到我的值很好。我究竟做错了什么？

```
while ($i < 5) {
  $date=mysql_result($result,$i,"date");
  $score=mysql_result($result,$i,"rating_score");
  echo $score;
  $chartData[0][] = $score;
  $chartData[1][] = rand(250,4000);
  $chartData[2][] = rand(250,4000);
  $categories[$i] = 'Label-' . $i;
  $i++;
} 
```

该页面在这里：[http ://www.thelocalgolfer.com/chart/](http://www.thelocalgolfer.com/chart/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:24:53.720

并不是说我完全理解您的代码的意义（因为您只是一直覆盖`$chartData`，所以循环完成后剩下的是最后一个条目分数和 rands），而是回答您的问题：而不是

```
$chartData[0][] = $score;
$chartData[1][] = rand(250,4000);
$chartData[2][] = rand(250,4000); 
```

做这个

```
$chartData[0][] = $score;
$chartData[0][] = rand(250,4000);
$chartData[0][] = rand(250,4000); 
```

当您在使用数组时迷失方向时，`print_r()`通常`var_dump()`有助于查看内部的真正内容（`print_r()`如果我不关心内容，我更喜欢由于格式设置）

# concurrency - 在 VS Express 但不是专业的 Windows 8 应用程序中获取 WinRT 并发异常

> ID：12653957
> 
> 赞同：1
> 
> 时间：2012-09-29T15:23:01.197
> 
> 标签：concurrency, windows-runtime

我一直在使用 DirectX 11 和 XAML 编写我的 XNA 教程的一个版本，并且在总体上做得很好。

今天，VS 2012 Professional 的试用版过期了，所以我安装了 Express Edition，以确保到目前为止我所做的一切都能正常构建/运行。事实证明它不是。

在我加载顶点/像素着色器的代码部分中，我正在使用并发任务。使用 Visual Studio 2012 Professional，这一切都很好，但是当我尝试使用 Express Edition 运行同一个项目时，我得到以下异常：

Demo.exe 中 0x76BA4B32 (KernelBase.dll) 处的第一次机会异常：0x40080201：WinRT 发起错误（参数：0x800700A1、0x00000075、0x0299DA88）。这是有问题的代码块：

```
auto loadVSTask = DX::ReadDataAsync(m_vertex).then([=](const Platform::Array<byte>^ bytecode) {
    DX::ThrowIfFailed(
        device->CreateVertexShader(
            bytecode->Data,
            bytecode->Length,
            nullptr,
            &m_vertexShader
        )
    );

    DX::ThrowIfFailed(
        device->CreateInputLayout(m_layout, m_layoutElements, bytecode->Data, bytecode->Length, &m_inputLayout)
    );
});

// Function that reads from a binary file asynchronously.
inline Concurrency::task<Platform::Array<byte>^> ReadDataAsync(Platform::String^ filename)
{
    using namespace Windows::Storage;
    using namespace Concurrency;

    auto folder = Windows::ApplicationModel::Package::Current->InstalledLocation;

    return create_task(folder->GetFileAsync(filename)).then([] (StorageFile^ file) 
    {
        return FileIO::ReadBufferAsync(file);
    }).then([] (Streams::IBuffer^ fileBuffer) -> Platform::Array<byte>^ 
    {
        auto fileData = ref new Platform::Array<byte>(fileBuffer->Length);
        Streams::DataReader::FromBuffer(fileBuffer)->ReadBytes(fileData);
        return fileData;
    });
} 
```

使用文件加载的非异步版本可以正常工作，并且一切运行良好。重申一下，这只发生在 Visual Studio 2012 Express 中，不会发生在专业版中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T18:34:19.273

这个问题似乎与我使用的目录分隔符有关。在文件路径中将它们从 / 更改为 \\ 可以在所有版本中工作。不知道 / 以前是如何工作的，没有问题，也不知道为什么在 Express 和 Professional 之间很重要。

# autocomplete - $this 的 PHPStorm 自动补全

> ID：12653958
> 
> 赞同：0
> 
> 时间：2012-09-29T15:23:05.440
> 
> 标签：autocomplete, phpstorm

我的“问题”相当简单，但我无法弄清楚 - 当我开始输入“$th”而不是提供“$”时，有没有办法让 PHPStorm 提供“$this->”作为自动完成选项这个”（没有箭头）？是否有其他我不知道的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T09:53:15.223

您不能使用自动完成功能，因为它事先不知道您是在键入 '$this' 作为函数参数、作为返回变量还是您需要的任何情况。自动完成将循环当前范围内可用的变量 - 并且“this”总是在类函数的闭包内。

正如 LazyOne 所说，请改用自定义模板，请参阅：

[http://www.jetbrains.com/phpstorm/webhelp/creating-and-editing-template-variables.html](http://www.jetbrains.com/phpstorm/webhelp/creating-and-editing-template-variables.html)

# mysql - 来自php的嵌套sql插入

> ID：12653966
> 
> 赞同：2
> 
> 时间：2012-09-29T15:24:26.093
> 
> 标签：mysql, select, nested

我在 php 中有一个嵌套数组，并且只有在不存在重复项时才尝试将数据插入到 mysql 表中。副本应该只检查与 sensor_serial 和 dates 字段的匹配。我对 DUPLICATE 没有运气，因为无论其他字段如何，id 都是唯一的。这是表格布局：

```
CREATE TABLE IF NOT EXISTS `temps_test` (
    `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
   `sensor_serial` varchar(64) COLLATE latin1_general_ci DEFAULT NULL,
    `temp_c` float DEFAULT NULL,
    `dates` datetime DEFAULT NULL,
    PRIMARY KEY (`id`),
    KEY `date` (`dates`)
) 
```

这是我的非工作代码。我似乎无法完全正确。

```
foreach ($output as $k => &$v) {
    $sql = "INSERT INTO temps_test (sensor_serial,temp_c,dates) VALUES ('$v[7]','$v[3]','$v[5]') WHERE NOT EXISTS (SELECT * FROM temps_test WHERE sensor_serial='$v[7]' AND dates='$v[5]')";
    $go = mysql_query($sql) or die( mysql_error() );
} 
```

可以这样做还是我的方法完全关闭？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:30:55.827

尝试使用[`ON DUPLICATE KEY UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

```
INSERT INTO temps_test (sensor_serial,temp_c,dates)
VALUES ('val1','val2','val3') 
ON DUPLICATE KEY UPDATE sensor_serial=sensor_serial; 
```

确保在字段上添加约束`sensor_serial`，例如

```
CREATE TABLE IF NOT EXISTS `temps_test`
(
    `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
   `sensor_serial` varchar(64) COLLATE latin1_general_ci DEFAULT NULL,
    `temp_c` float DEFAULT NULL,
    `dates` datetime DEFAULT NULL,
    PRIMARY KEY (`id`),
    KEY `date` (`dates`),
    CONSTRAINT t_uq INIQUE (`sensor_serial`)     -- <== this one
) 
```

# algorithm - 六边形中有 6 个等边三角形，给定 x,y 坐标，如何确定坐标在哪个等边三角形中？

> ID：12653970
> 
> 赞同：0
> 
> 时间：2012-09-29T15:25:15.483
> 
> 标签：algorithm, geometry, polygon

我正在 3D 虚拟世界中创建游戏。我使用编号为 t1、t2、t3、t4、t5、t6 的 6 个等边三角形创建了一个六边形。

给定六边形内的 x,y 坐标，我可以使用什么公式来确定该点在哪个三角形中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T15:36:53.503

您可以将 (x,y) 坐标转换为极坐标。

您的六边形中有 6 个等边三角形，因此每个“三角形边界”都由 Pi/3 弧度分隔。所以当你有你的θ角时，你可以猜出你在哪个三角形中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T15:38:58.500

如果您知道该点在六边形内部，并且您知道三角形的方向，则可以计算该点相对于中心的角度：

```
atan2((y-yc)/(x-xc)). 
```

如果`x == xc`角度是 +90 或 -90 度（PI/2 或 -PI/2 弧度），取决于 y。

（如果没有`atan2`，则需要手动检查象限：请参阅

[http://en.wikipedia.org/wiki/Polar_coordinate_system#Converting_between_polar_and_Cartesian_coordinates](http://en.wikipedia.org/wiki/Polar_coordinate_system#Converting_between_polar_and_Cartesian_coordinates)）

Point-inside-triangle 测试（A、B 和 C 是三角形的顶点，表示为 (x,y)）：

```
// Compute vectors        
v0 = C - A             // Which means v0[x] = C[x] - A[x], v0[y] = C[y] - A[y]
v1 = B - A             // etc.
v2 = P - A

// Compute dot products
dot00 = dot(v0, v0)    // dot(a,b) is a[x]*b[x]+a[y]*b[y]
dot01 = dot(v0, v1)
dot02 = dot(v0, v2)
dot11 = dot(v1, v1)
dot12 = dot(v1, v2)

// Compute barycentric coordinates (faster using inverse, but clearer this way)

denom = (dot00 * dot11 - dot01 * dot01)
u = (dot11 * dot02 - dot01 * dot12) / Denom
v = (dot00 * dot12 - dot01 * dot02) / Denom

// Check if point is in triangle
return (u >= 0) && (v >= 0) && (u + v < 1)

from http://www.blackpawn.com/texts/pointinpoly/default.html 
```

请记住，通过保存计算可以节省 50-66% 的时间：所有三角形都有两个共同的顶点。当然，您也只能测试其中的*五个*：-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T15:38:04.277

您可以通过检查该点是否位于形成一个三角形的线的同一侧来做到这一点。继续检查你的六个三角形并找到合适的。

找到形成三角形的直线方程，并在每个方程中检查点的坐标（确保每个方程的'x'具有相同的符号）。如果结果值有 2 个相同符号和 1 个不同符号，则该点位于三角形内部。

实际上，在您的情况下，您将有 9 个直线方程。如果你在你的六边形的中心取原点，这条线的方程会很容易。只需找到这 9 个值并搜索满足上述条件的 3 个这样的值。这三个值的父方程构成了三角形。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T16:08:45.913

直观地说，该点应该在三角形内部，其顶点平均接近该点。

中心顶点可以忽略，因为它由所有三角形共享。

如果您有剩余的顶点按到该点的距离排序（总共 6 个，因为它们由相邻的三角形共享），那么您要查找的三角形是在按升序遍历的列表中首先找到最远顶点的三角形。

# drupal - 我想要我网站标题区域中的 questions/start_ask 页面

> ID：12653972
> 
> 赞同：0
> 
> 时间：2012-09-29T15:25:43.807
> 
> 标签：drupal

我启用了 Answers 模块并且非常喜欢“questions/start_ask”页面。这是我的问题

1.  我无法识别此页面是什么 - 视图、自定义表单或某些面板模板 -
2.  我如何在标题区域中使用它作为小部件或自定义块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T16:20:39.860

您是否安装了[开发](http://drupal.org/project/devel)和[主题开发](http://drupal.org/project/devel_themer)模块？如果没有，得到他们。当它们打开时，您可以单击任何页面左下角的“主题信息”，然后将鼠标悬停在页面上的任何内容上，以了解为创建它而调用的函数、视图和模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T06:43:01.983

`<?php print drupal_render(drupal_get_form('answers_start_ask_form')); ?>`已修复 - 通过在 page.tpl 中添加一个新区域，然后+ 一些 css 来定位和着色事物，我让表单在我的标题中工作 。你可以在这里看到它工作[www.onlinedoctors.in](http://www.onlinedoctors.in)

# android - 使用 android jar 文件中的 R 资源

> ID：12653974
> 
> 赞同：0
> 
> 时间：2012-09-29T15:25:56.223
> 
> 标签：android, jar, resources

这已经被讨论过几次，成功的状态各不相同，但我能找到的大多数答案都是几年前的事了。

本质上，我有一个应用程序已经转移到不与客户共享的地步。客户希望扩展应用程序，但我们不希望他们访问原始代码——在所有这些上保护 IP。

布局、图像等......好吧，我们不太关心这些，只关心java代码。我可以轻松地将 java 代码编译成 jar 并分发它，但这只是答案的一半。java代码仍然引用了一大堆内部资源。

我正在使用的场景是 jar 文件包含以下内容：

在 Jar 文件中 - MyActivity 扩展 Activity - MyActivity 中的 onCreate() 将 contentView 设置为 jar 文件中的 R 引用布局。

在客户端应用程序中 - MyClientActivity 扩展 MyActivity

当它运行时，我在 MyClientActivity 上得到一个 ClassNotFoundException。

我注意到的事情： - 如果我将 jar 代码作为库而不是 jar 文件附加，它可以工作。- 如果我在 MyActivity 的 onCreate() 中删除 R 引用并重新制作我的 jar 文件，它就可以工作。

因此，显然，如前所述，R 引用是死的/不可访问的。问题是，这*显然*可以工作，不是吗？如果您创建一个 Android 应用程序并查看自动包含的 API，则 android.jar 文件有一个 R 文件，其中包含内部布局/字符串/等...，这些都是从其代码中引用的。

正如其他人之前所说，这似乎是一种非常基本且明显的使用模式。它看似不起作用的事实令人难以置信，以至于让人相信它确实起作用，只是没有以明显的方式完成。

有没有人真正让它工作？

非常感谢，

-绳索

# python - 在语句中添加括号

> ID：12653979
> 
> 赞同：1
> 
> 时间：2012-09-29T15:26:40.063
> 
> 标签：python, regex, string, parsing

我在解析字符串并在 Python 中为其添加括号时遇到问题。我的问题之一是字符串可能以完全带括号的方式输入（即`(01U(1U0))`），也可能根本没有输入（即`01U1U0`）。我似乎无法拆分的语法是：

```
A -> e* | (eUe)
e -> any combination of chars from the grammar 
```

的`e*`优先级高于 和`U`。

希望这是有道理的。任何人都知道如何解析和检查括号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T07:41:26.593

从 LL 语法编写解析器的最简单方法可能是每个非终结符号都有一个函数。这个函数应该吃掉输入字符串中对应于规则缩减的字符。下面是语法对应的解析器

```
A -> e+ | '(' A 'U' A ')'
e -> '0' | '1' 
```

这不完全是您想要的语法，但与您提供的示例更相关。语法是 LL(1)，你只需要读一个字符就知道如何进行。以下解析器为这两个非终结符号定义了两个函数 A() 和 e() ：

```
class MySyntaxError(Exception):
  def __init__(self, text, index):
    self.text = text 
    self.index = index
  def __str__(self):
    return "Syntax error at index " + repr(self.index) + ": " + self.text

def parse(input):
  global index
  index = 0

  def eat_char(set):
    global index
    if index < len(input) and input[index] in set:
      index += 1
    else:
      raise MySyntaxError("expected char in " + repr(set), index)

  def e():
    eat_char(['0', '1'])

  def A():
    global index
    if index == len(input): # Successfully parsed
      return
    elif input[index] in ['0', '1']:
      while (input[index] in ['0', '1']):
        e()
    elif input[index] is '(':
      eat_char(['('])
      A()
      eat_char(['U'])
      A()
      eat_char([')'])
    else:
      raise MySyntaxError("expected char '0', '1' or '('", index)

  A()
  if index != len(input): # Parsing didn't reach the end of the string
    raise MySyntaxError("parsing ended before the end of the input", index)

def test(string):
  try:
    parse(string)
    print "The string " + string + " have been successfully parsed"
  except MySyntaxError as e:
    print "The string " + string + " can't be parsed:"
    print e

test("(01U(1U0))")
test("(01U(1U0)") # Missing parenthesis, syntax error
test("(01U(1U0)))") # Too many parenthesis, syntax error
test("01U(1U0)") # No parenthesis, syntax error 
```

请注意，使用 e* 而不是 e+ 会使空归约为 A，这会使解析器复杂化。

下推自动机隐藏在解析器中。o 从语法构建自动机并不是那么简单。在这里，PDA 只有一种状态。我们可以这样描述自动机：

```
from state [1]
  read a '0' or a '1' and loop into state [1]
  read a '(', push the parenthesis and loop into state [1]
  read a 'U', when there is an open parenthesis on the top of stack, push the 'U' and loop into state [1]
  read a ')', when there is a 'U' on the top of the stack, pop the 'U', pop the opend parenthesis following, and loop into state[1] 
```

有一种直接的方法可以用 Python 编写这个自动机。通常，你需要一个 goto 来编写一个自动机。每个状态都绑定到一个标签，从一个状态到另一个状态是通过 goto 完成的。不幸的是，Python 中没有 goto。但是，由于您只有一个状态，因此没有必要，并且可以使用循环：

```
def parse(input):
  index = 0
  stack = [];

  def top():
    if len(stack) > 0:
      return stack[len(stack)-1]
    else:
      return None

  while index < len(input):
    if input[index] in ['0', '1']:
      pass
    elif input[index] is '(':
      stack.append('(')
    elif input[index] is 'U' and top() == '(':
      stack.append('U')
    elif input[index] is ')' and top() == 'U':
      stack.pop()
      stack.pop()
    else:
      raise MySyntaxError("Unexpected char '" + input[index] + "'", index)
    index += 1

  if len(stack):
    raise MySyntaxError("unterminated input", index) 
```

这是一个带有显式堆栈的 PDA。前面的解析器使用了程序栈而不是隐式栈，并且记住了递归调用次数中读取的括号次数。当您要检查字符串的有效性时，第二个解析器很有用。但是当你想生成输入的表示时，它就很不方便，比如抽象语法树：它们通常是从语法构建的，因此更容易从第一个解析器生成。第一个也更容易阅读，因为您无需计算自动机即可理解它。

# java - Java 进程 - 无法解压缩 zip 文件

> ID：12653982
> 
> 赞同：0
> 
> 时间：2012-09-29T15:26:56.543
> 
> 标签：java, multithreading, process, zip

我正在尝试解压缩一些 zip 文件，它大约有 65 兆。下面的代码片段：

这个方法实际上解压了一个文件：

```
public synchronized void execute(Path zipFile) {
    final ProcessBuilder builder = new ProcessBuilder("/bin/unzip",zipFile.toAbsolutePath().toString(), "-d", dir.toAbsolutePath().toString());
    FutureTask<Integer> task = new FutureTask<Integer>(new Callable<Integer>() {
        @Override public Integer call() {
            try {
                System.out.println("started and waiting");
                int status = builder.start().waitFor();
                System.out.println("status: " + status);
                return status;
            } catch (InterruptedException e) {
            } catch (IOException e) {
            }
            return 0;
        }
    });

    List<FutureTask<Integer>> tasks = new ArrayList<FutureTask<Integer>>();
    tasks.add(task);
    System.out.println("task added");
    ExecutorService executor = Executors.newCachedThreadPool();
    for (FutureTask<Integer> t : tasks) {
        executor.submit(t);
        System.out.println("submitted");
    }
    executor.shutdown();
    System.out.println("shutdown");
} 
```

那个执行者/未来的东西只是为了确保我做得正确。这个方法在类 Finder 中被调用，它在目录中找到 zip 文件并尝试解压它。它基于此代码[http://docs.oracle.com/javase/tutorial/essential/io/walk.html](http://docs.oracle.com/javase/tutorial/essential/io/walk.html)

所以具体来说：

```
@Override
public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) {
    if (find(file)) {
        synchronized(Finder.class) {
            executor.execute(file);
        }
    }
    return CONTINUE;
} 
```

现在的问题。这真的很有趣。每当我通过此代码提取某些内容时，zip 文件实际上会被解压缩，但只有一些目录被解压缩，而其他目录则没有。例如，我有一个包含 temp foo 和 bar 目录的 zip 文件，但解压缩后，只有 temp 和 foo 目录，并且 bar 没有被提取。

输出是：

```
task added
submitted
started and waiting
shutdown 
```

为什么没有“status = something”输出？

我不明白为什么会这样。当我手动解压缩时，它会正确解压缩。

// 编辑

这成功了

```
@Override
public synchronized void execute(String file, String dest) {
    ProcessBuilder pb = new ProcessBuilder("/bin/unzip","-qq", file, "-d", dest);
    pb.redirectErrorStream(true);

    try {
        Process p = pb.start();
        InputStream is = p.getInputStream();
        InputStreamReader r = new InputStreamReader(is);
        BufferedReader in = new BufferedReader(r);
        String line;
        while ((line = in.readLine()) != null) {
            // because of the -qq option, it does actually write out nothing
            System.out.println(line);
        }
    } catch (IOException ex) {
        System.err.println(ex.getMessage());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:34:38.583

该`unzip`命令将它正在解压缩的文件的详细信息打印到其标准输出，因此您需要在 Java 程序中阅读它（通过`Process.getInputStream`）。如果您没有及时读取输出，则进程可能会在其缓冲区满时阻塞 - 这在 Process 的 javadoc 中有详细说明。

我建议您打电话`builder.redirectErrorStream(true)`，然后确保您从流程流中读取所有数据。您还可以从向`-qq`unzip 调用添加参数中受益，以最大限度地减少它首先创建的输出量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T17:20:02.743

我认为问题是由于超时限制。

您可以尝试下面的代码来执行过程

```
Runtime runtime = Runtime.getRuntime();
Process process = runtime.exec(commandLine); 
```

我认为它会起作用。

# android - Android中样式和主题的优先级是什么？

> ID：12653988
> 
> 赞同：1
> 
> 时间：2012-09-29T15:27:49.023
> 
> 标签：android, android-layout

我有一个难以调试的问题，我想要一个布局文件，其中的按钮完全来自 Activity 代码的样式。因为不能由主题设置，需要`android:layout_width`在布局文件中设置，所以一切都变成了意大利面条。`android:layout_height``style="@style/myButton"`

底线是我不能使用主题来完全控制`Activity`代码中的样式。但是在代码中完全生成布局`Activity`是很痛苦的，因为您无法`Graphical Layout View`轻松预览更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:27:49.023

从[这篇精彩的博客文章](http://growingupwithandroid.blogspot.co.il/2010/03/order-precedence-in-styling.html)中，我发现为时已晚。

1.  小部件的内联属性，它覆盖...
2.  styles.xml 文件中的样式，它覆盖 ...
3.  小部件的默认样式，它覆盖 ...
4.  主题指定样式

# c++ - 如何使用 CUDA 生成随机排列

> ID：12653995
> 
> 赞同：6
> 
> 时间：2012-09-29T15:28:29.553
> 
> 标签：c++, algorithm, cuda, thrust

我可以使用哪些并行算法从给定集合生成随机排列？特别是适合 CUDA 的论文的建议或链接会很有帮助。

一个顺序版本将是 Fisher-Yates 洗牌。

例子：

令 S={1, 2, ..., 7} 为源索引集。目标是并行生成 n 个随机排列。n 个排列中的每一个都只包含每个源索引一次，例如 {7, 6, ..., 1}。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-05T20:30:50.610

Fisher-Yates shuffle 可以并行化。例如，4 个并发工作人员只需要 3 次迭代即可对 8 个元素的向量进行混洗。在第一次迭代中，它们交换 0<->1, 2<->3, 4<->5, 6<->7; 在第二次迭代 0<->2, 1<->3, 4<->5, 6<->7; 最后一次迭代 0<->4, 1<->5, 2<->6, 3<->7。

![并行FisherYates](../Images/c0f82568e38f953f7ef2ba603c1dba1e.png)

这可以很容易地实现为 CUDA`__device__`代码（受标准[min/max reduction](http://developer.download.nvidia.com/compute/cuda/1.1-Beta/x86_website/projects/reduction/doc/reduction.pdf)启发）：

```
const int id  = threadIdx.x;
__shared__ int perm_shared[2 * BLOCK_SIZE];
perm_shared[2 * id]     = 2 * id;
perm_shared[2 * id + 1] = 2 * id + 1;
__syncthreads();

unsigned int shift = 1;
unsigned int pos = id * 2;  
while(shift <= BLOCK_SIZE)
{
    if (curand(&curand_state) & 1) swap(perm_shared, pos, pos + shift);
    shift = shift << 1;
    pos = (pos & ~shift) | ((pos & shift) >> 1);
    __syncthreads();
} 
```

这里省略了 curand 初始化代码，方法`swap(int *p, int i, int j)`交换值`p[i]`和`p[j]`.

请注意，上面的代码具有以下假设：

1.  排列的长度是 2 * BLOCK_SIZE，其中 BLOCK_SIZE 是 2 的幂。
2.  2 * BLOCK_SIZE 整数适合`__shared__`CUDA 设备的内存
3.  BLOCK_SIZE 是 CUDA 块的有效大小（通常在 32 到 512 之间）

要生成多个排列，我建议使用不同的 CUDA 块。如果目标是排列 7 个元素（正如在原始问题中提到的那样），那么我相信在单线程中完成它会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T23:18:11.747

如果 s = s_L 的长度，可以在推力中实现一个非常粗略的方法：

[http://thrust.github.com](http://thrust.github.com)。

首先，创建一个长度为 s_L xn 且重复 sn 次的向量 val。

创建一个向量 val_keys 将 n 个重复 s_L 次的唯一键与 val 的每个元素相关联，例如，

```
 val = {1,2,...,7,1,2,...,7,....,1,2,...7}
  val_keys = {0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,...., n,n,n} 
```

现在有趣的部分。创建一个长度为 s_L xn 的向量均匀分布的随机变量

```
 U  = {0.24, 0.1, .... , 0.83} 
```

然后你可以在 val,val_keys 上做 zip 迭代器并根据 U 对它们进行排序：

[http://codeyarns.com/2011/04/04/thrust-zip_iterator/](http://codeyarns.com/2011/04/04/thrust-zip_iterator/)

val 和 val_keys 都会到处都是，所以你必须使用推力::stable_sort_by_key() 将它们重新组合在一起，以确保 val[i] 和 val[j] 都属于 key[k] 和 val [i] 在随机排序之后在 val[j] 之前，那么在最终版本中 val[i] 仍然应该在 val[j] 之前。如果一切按计划进行，val_keys 应该看起来和以前一样，但 val 应该反映改组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-05T02:19:22.320

对于大型集合，在随机键向量上使用排序原语可能足以满足您的需求。首先，设置一些向量：

```
const int N = 65535;
thrust:device_vector<uint16_t> d_cards(N);
thrust:device_vector<uint16_t> d_keys(N);
thrust::sequence(d_cards.begin(), d_cards.end()); 
```

然后，每次你想洗牌 d_cards 调用这对：

```
thrust::tabulate(d_keys.begin(), d_keys.end(), PRNFunc(rand()*rand());
thrust::sort_by_key(d_keys.begin(), d_keys.end(), d_cards.begin());
// d_cards now freshly shuffled 
```

随机密钥是从使用种子（在主机代码中评估并在启动时复制到内核）和密钥编号（列表在线程创建时传入）的仿函数生成的：

```
struct PRNFunc
{
  uint32_t seed;
  PRNFunc(uint32_t s) { seed = s; }
  __device__ __host__ uint32_t operator()(uint32_t kn) const
  {
    thrust::minstd_rand randEng(seed);
    randEng.discard(kn);
    return randEnd();
  }
}; 
```

我发现如果我能弄清楚如何缓存thrust::sort_by_key 在内部执行的分配，性能可以提高（可能提高30%）。

欢迎任何更正或建议。

# css - IE9 中 img 标签的 css 属性高度的默认值是什么

> ID：12653997
> 
> 赞同：1
> 
> 时间：2012-09-29T15:28:37.363
> 
> 标签：css, twitter-bootstrap, internet-explorer-9

我将 Twitter Bootstrap 用于我的网站，还使用 ​​AD Gallery 作为图像库 (http://coffeescripter.com/code/ad-gallery/)。

我的页面上有几个用引导程序制作的标签，画廊在第二个标签上。我发现 IE 9（它适用于 Firefox 和 Chrome）存在问题，无法在图库中显示图像。

我对此进行了调试，发现这是由于 Bootstrap 重置中的 css 命令造成的：

```
img {
    height: auto;
} 
```

如果我删除这一行，在 IE9 中一切正常。

我不想完全删除这一行，而是在我自己的 CSS 中为这个特定的画廊 div 覆盖它。有趣的是，“auto”已经是这个属性的默认值。

那么，如果我在 Bootstrap 中注释掉这一行，如何将其重置为“未设置”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:33:32.397

检查 IE9 默认样式表确认 img 高度未设置为任何值，这对我来说意味着自动，所以这很奇怪。

`height:inherit`行得通吗？编辑：不，它没有。

# java - Java：如何以通用方式将元信息添加到多种图像类型

> ID：12653998
> 
> 赞同：1
> 
> 时间：2012-09-29T15:28:43.087
> 
> 标签：java, image-processing, metadata, javax.imageio, jai

## 需要做什么

我需要将**自定义元信息**添加到**图像文件**。
支持的类型需要是：JPEG、GIF、BMP、TIF、PNG

## 它是如何完成的

我决定使用 imageio[标准元数据](http://docs.oracle.com/javase/6/docs/api/javax/imageio/metadata/doc-files/standard_metadata.html)，以便为所有文件类型提供通用解决方案。
我也在使用 Java Advanced Imaging 库，因为并非所有文件类型都受通用 api 支持。

这是添加元数据的核心函数的代码片段：

```
 public static byte[] writeCustomMetaInformation(byte[] imageByteArray, String contentType) throws IOException {
    ImageWriter writer = null;

    String formatName = "javax_imageio_1.0";

    ImageOutputStream stream = null;
    if (contentType.toLowerCase().contains("gif")) {
        IIORegistry registry = IIORegistry.getDefaultInstance();
        registry.registerServiceProvider(new GIFImageWriterSpi());
        writer = ImageIO.getImageWritersByFormatName("gif").next();

    } else if (contentType.toLowerCase().contains("png")) {
        writer = ImageIO.getImageWritersByFormatName("png").next();

    } else if (contentType.toLowerCase().contains("bmp")) {
        IIORegistry registry = IIORegistry.getDefaultInstance();
        registry.registerServiceProvider(new BMPImageWriterSpi());
        writer = ImageIO.getImageWritersByFormatName("bmp").next();

    } else if (contentType.toLowerCase().contains("tif")) {
        IIORegistry registry = IIORegistry.getDefaultInstance();
        registry.registerServiceProvider(new TIFFImageWriterSpi());
        writer = ImageIO.getImageWritersByFormatName("tif").next();

    } else { //by default jpeg
        writer = ImageIO.getImageWritersByFormatName("jpeg").next();
    }

    BufferedImage bufferedImage = ImageIO.read(new ByteArrayInputStream(imageByteArray));

    ImageWriteParam writeParam = writer.getDefaultWriteParam();
    ImageTypeSpecifier typeSpecifier = ImageTypeSpecifier.createFromBufferedImageType(BufferedImage.TYPE_INT_RGB);

    /*
     * Add metadata to the file
     * See http://docs.oracle.com/javase/6/docs/api/javax/imageio/metadata/doc-files/standard_metadata.html
     * for reference on default image metadata DTD
     */
    IIOMetadata metadata = writer.getDefaultImageMetadata(typeSpecifier, writeParam);

    IIOMetadataNode root = new IIOMetadataNode(formatName);

    //Add RGB tag, otherwise BMP writing throws NPE
    IIOMetadataNode chroma = new IIOMetadataNode("Chroma");
    IIOMetadataNode colorSpaceType = new IIOMetadataNode("ColorSpaceType");
    colorSpaceType.setAttribute("name", "RGB");
    chroma.appendChild(colorSpaceType);
    root.appendChild(chroma);

    IIOMetadataNode text = new IIOMetadataNode("Text");
    IIOMetadataNode textEntry = new IIOMetadataNode("TextEntry");
    textEntry.setAttribute("keyword", "metainformation");
    textEntry.setAttribute("value", "This is some custom meta information!");
    textEntry.setAttribute("encoding", "UTF-8");
    textEntry.setAttribute("language", "EN");
    textEntry.setAttribute("compression", "none");
    text.appendChild(textEntry);

    root.appendChild(text);

    metadata.mergeTree(formatName, root);

    // writing the data
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    stream = ImageIO.createImageOutputStream(baos);

    writer.setOutput(stream);

    IIOImage img = new IIOImage(bufferedImage, null, metadata);
    writer.write(metadata, img, writeParam);
    stream.close();

    return baos.toByteArray();
} 
```

## 结果是什么

我使用[ImageMagick](http://www.imagemagick.org/)的*identify -verbose*查看添加元信息的结果。

1.  JPG、PNG 和 GIF 文件添加了元信息
2.  BMP 和 TIF 要么没有添加元信息，要么 ImageMagick 无法读取它。

那么，有谁知道为什么添加到 BMP 和 TIF 的元信息似乎没有生效？标准元数据 DTD 是否不适用于他们？我应该改用 BMP/TIF 元数据吗？

如果您想测试行为，这里是一个[完整设置项目](https://www.dropbox.com/sh/1uifmpwgc3rmxlh/NrIuYttCgz/Metadata.zip)的链接， 它演示了转换及其问题。