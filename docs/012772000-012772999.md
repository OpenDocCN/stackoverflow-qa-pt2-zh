# StackOverflow 问答 12772000-12772999

# java - Java add and set functions

> ID：12772001
> 
> 赞同：0
> 
> 时间：2012-10-07T19:18:05.113
> 
> 标签：java, python

I'm a python programmer, but currently I'm reading through Java code to get some ideas. I have no programming experience at all with Java and I don't know how it's possible, but I couldn't get any information using Google about these functions.

```
if(pv.size() -2 < j)
     pv.add(j+1, localpv.get(j));
else
     pv.set(j+1, localpv.get(j)); 
```

This is the piece of code I need to decypher. `pv` and `localpv` are both vectors (I believe they are equivalent to lists in python?), and something is added to them. I can guess that one of them is adding them to a vector at a certain position (`j+1`), but then I have no idea what the other one does.

Can you please explain those two lines for me and maybe telling what are they equivalent to in python?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T19:22:17.010

[add](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Vector.html#add%28int,%20java.lang.Object%29) 在指定位置**插入指定元素**

[set](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Vector.html#set%28int,%20java.lang.Object%29) **替换**指定位置的元素

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T19:21:35.670

签出 JavaDocs [http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html)

add 在将所有其他对象向后移动的位置插入一个对象。set 覆盖该位置的当前对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T19:23:54.890

您可以在[API 参考中查找](http://docs.oracle.com/javase/6/docs/api/)*所有*Java 方法的定义。

[`Vector.add(int index, E element)`](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html#add%28int,%32E%29)

> 在此 Vector 中的指定位置插入指定元素。

[`Vector.set(int index, E element)`](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html#set%28int,%32E%29)

> 将此 Vector 中指定位置的元素替换为指定元素。

等效的 Python 代码是

```
if len(pv) - 2 < j:
     pv.insert(j+1, localpv[j])
else:
     pv[j+1] = localpv[j] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T19:20:30.130

第一个在 j+1'st 位置添加一个新元素，另一个将现有 j+1'st 位置的值设置为给定值。

我猜作者想确保他不会尝试设置列表（向量）中不存在的元素的值。

# mercurial - Mercurial：没有 ~/.hgrc 文件

> ID：12772004
> 
> 赞同：22
> 
> 时间：2012-10-07T19:18:26.947
> 
> 标签：mercurial

我正在尝试[阅读本教程](https://confluence.atlassian.com/pages/viewpage.action?pageId=270827678)，其中说：

* * *

**为 Mercurial 启用 SSH 压缩**

编辑 Mercurial 全局配置文件 (~/.hgrc)。将以下行添加到 UI 部分：

`ssh = ssh -C`

* * *

但是我的系统中没有那个文件。HG当然是安装的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-07T19:27:59.953

默认情况下它不存在。你不需要它存在——它*可以*存在来定制你如何使用 mercurial。你只需要`hgrc`在你的主目录中创建一个文件就可以了。

这是一篇很棒的介绍文章 [http://hgtip.com/tips/beginner/2009-09-30-configuring-mercurial](https://web.archive.org/web/20120824162725/http://hgtip.com/tips/beginner/2009-09-30-configuring-mercurial/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-01-20T21:42:19.443

从[https://www.selenic.com/mercurial/hgrc.5.html](https://www.selenic.com/mercurial/hgrc.5.html)的手册页中获取。

> **文件**
> 
> Mercurial 从多个文件中读取配置数据（如果存在）。 *这些文件默认不存在，您必须自己创建适当的配置文件：*
> 
> 本地配置被放入 per-repository /.hg/hgrc 文件中。
> 
> 像用户名设置这样的全局配置通常被放入：
> 
> ```
> %USERPROFILE%\mercurial.ini
> $HOME/.hgrc 
> ```
> 
> 这些文件的名称取决于安装 Mercurial 的系统。单个目录中的 *.rc 文件按字母顺序读取，后面的文件会覆盖前面的文件。在下面给出多个路径的情况下，早期路径的设置会覆盖后面的路径。
> 
> 在 Unix 上，参考以下文件：
> 
> *   /.hg/hgrc（每个存储库）
> *   $HOME/.hgrc（每个用户）
> *   /etc/mercurial/hgrc（每次安装）
> *   /etc/mercurial/hgrc.d/*.rc（每次安装）
> *   /etc/mercurial/hgrc（每个系统）
> *   /etc/mercurial/hgrc.d/*.rc（每个系统）
> *   /default.d/*.rc（默认值）
> 
> 在 Windows 上，参考以下文件：
> 
> *   /.hg/hgrc（每个存储库）
> *   %USERPROFILE%.hgrc（每个用户）
> *   %USERPROFILE%\Mercurial.ini（每个用户）
> *   %HOME%.hgrc（每个用户）
> *   %HOME%\Mercurial.ini（每个用户）
> *   HKEY_LOCAL_MACHINE\SOFTWARE\Mercurial（每次安装）
> *   \hgrc.d*.rc（每次安装）
> *   \Mercurial.ini（每次安装）
> *   /default.d/*.rc（默认值）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-29T08:31:10.883

对于最新版本的 mercurial，您应该使用[XDG](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html)兼容位置。除非您明确设置`XDG_CONFIG_HOME`设置应该进入文件：

```
~/.config/hg/hgrc 
```

在您的主目录中减少杂乱，`~/.config/hg/`也可以用于像普通文件这样的文件`hgignore`

# ios - Cell text overlapping on scrolling

> ID：12772005
> 
> 赞同：1
> 
> 时间：2012-10-07T19:18:28.480
> 
> 标签：ios, objective-c, iphone, uitableview

When I scroll my tableview, the text gets all mashed up from the cells below. It's probably cause I recreate the UILabels every time cellForRow gets loaded, but I wouldn't know how to fix it:

```
 (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSInteger row = [indexPath row];

    NSDictionary *currentRowDictionary = nil;
    if (tableView == [[self searchDisplayController] searchResultsTableView])
        currentRowDictionary = [[self searchResults] objectAtIndex:row];
    else
        currentRowDictionary = [[self tableData] objectAtIndex:row];

    NSString *voornaam = [currentRowDictionary objectForKey:@"voornaam"];
    NSString *achternaam = [currentRowDictionary objectForKey:@"achternaam"];
    NSString *tussenvoegsel = [currentRowDictionary objectForKey:@"tussenvoegsel"];

    voornaamLbl = [[[UILabel alloc] initWithFrame:CGRectMake(5, 10, 300, 40)] autorelease];
    voornaamLbl.font = [UIFont fontWithName:@"TrebuchetMS-Bold" size:19];
    voornaamLbl.text = voornaam;
    voornaamLbl.numberOfLines = 0;
    [voornaamLbl sizeToFit];

    tussenvoegselLbl = [[[UILabel alloc] initWithFrame:CGRectMake(voornaamLbl.frame.size.width + 10, 10, 300, 40)] autorelease];
    tussenvoegselLbl.text = tussenvoegsel;
    tussenvoegselLbl.numberOfLines = 0;
    [tussenvoegselLbl sizeToFit];

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil)
    {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }

    [cell.contentView addSubview:voornaamLbl];
    if ([tussenvoegsel length] != 0)
    {
        [cell.contentView addSubview:tussenvoegselLbl];
        achternaamLbl = [[[UILabel alloc] initWithFrame:CGRectMake(voornaamLbl.frame.size.width +
                                                                tussenvoegselLbl.frame.size.width + 15, 10, 300, 40)] autorelease];

    } else {
        achternaamLbl = [[[UILabel alloc] initWithFrame:CGRectMake(voornaamLbl.frame.size.width + 10, 10, 300, 40)] autorelease];
    }

    achternaamLbl.text = achternaam;
    achternaamLbl.numberOfLines = 0;
    [achternaamLbl sizeToFit];

    [cell.contentView addSubview:achternaamLbl];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T19:36:14.417

每次使用单元格时，您都分配并初始化新标签。单元格在滚动过程中被重复使用，因此您每次都会增加标签。

最好的方法是创建一个单独的 UITableViewCell 子类，在加载时创建标签，然后在 cellForRowAtIndexPath 中使用新的单元格子类并设置标签文本

本教程的结尾可以帮助处理单元子类[http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# java - Java 组合函数有少量数量的限制。如何使用数学大整数？

> ID：12772007
> 
> 赞同：0
> 
> 时间：2012-10-07T19:19:25.840
> 
> 标签：java, combinations, biginteger

这些天我自己在学习java。该功能是计算组合。但是，我发现这个函数中 n 和 k 的数量有一个非常小的限制。每次如果我输入一个大的 n 或 k，例如 100，它就会给我

```
Exception in thread "main" java.lang.ArithmeticException: / by zero
at Combination.combination(Combination.java:29)
at Combination.main(Combination.java:47) 
```

或者给我一个负数...

有没有办法让它适用于像 10000 这样的大数字？

谢谢！

```
import java.util.HashMap; import java.util.Map;

public class Combination {

private Map<Long,Long> factorialMap = new HashMap<Long,Long>();

public Long getFactorial(int number) {
    Long val = factorialMap.get(number);
    if(val != null) {
        return val;
    } else {
        val = getFactorialRecursive(number);
        factorialMap.put((long) number, val);
        return val;
    }
}

public Long getFactorialRecursive(int number) {
    if(number == 1 || number == 0) {
        return 1L;
    } else {
        return number * getFactorialRecursive(number-1);
    }
}

public Long combination(int fromVal, int chooseVal) {
    return getFactorial(fromVal)/(getFactorial(chooseVal)*getFactorial(fromVal-chooseVal));
}

public static void main(String[] args) {
    int   n, k;
    Combination comb = new Combination();
    java.util.Scanner console = new java.util.Scanner(System.in);

    while (true)  // will break with k > n or illegal k or n
    {  System.out.print ("Value for n:  ");
       n = console.nextInt();
       if ( n < 0 ) break;
       System.out.print ("Value for k:  ");
       k = console.nextInt();;
       if ( k > n || k < 0 )
          break;
       System.out.print(n +" choose " + k + " = ");
       System.out.println(comb.combination(n,k));
    }
    console.nextLine();    // Set up for "Press ENTER...

} } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:22:50.613

您应该使用该`BigInteger`对象：[http ://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)

特别是你的问题是21！即使很长时间也太大，因此会溢出。另一种选择是使用双精度，但这会失去精度，所以如果你需要整数精度`BigInteger`是要走的路。

使用`BigInteger`您需要将整数转换为`BigInteger`：

```
BigInteger bi = new BigInteger(intVal+""); 
```

然后使用`add`, `multiply`, `divide`and `subtract`（以及其他）来操纵您的值（例如）：

```
bi = bi.add(bi2); 
```

然后您可以使用该方法`longValue()`取回该值（假设它适合很长）：

```
return bi.longValue(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T19:34:57.787

我建议您考虑默认情况下Java不会递归超过大约10,000次，并且您不需要首先计算如此大的阶乘。

例如 1000!/999! 是 1000

如果您使用循环，您可以更早地停止。

```
public static BigInteger combination(int n, int r) {
    if (r * 2 > n) r = n - r;
    BigInteger num = BigInteger.ONE;
    BigInteger nr = BigInteger.valueOf(n - r);
    for (int i = n; i > r; i--) {
        num = num.multiply(BigInteger.valueOf(i));
        while (nr.compareTo(BigInteger.ONE) > 0 && num.mod(nr).equals(BigInteger.ZERO)) {
            num = num.divide(nr);
            nr = nr.subtract(BigInteger.ONE);
        }
    }
    while (nr.compareTo(BigInteger.ONE) > 0) {
        num = num.divide(nr);
        nr = nr.subtract(BigInteger.ONE);
    }
    return num;
} 
```

`Long`顺便说一句，当我打算使用`long`效率较低时，我不会使用它。

为了比较，我使用 long 包含了相同的代码。

```
public static long combination2(int n, int r) {
    if (r * 2 > n) r = n - r;
    long num = 1;
    int nr = n - r;
    for (int i = n; i > r; i--) {
        num *= i;
        while (nr > 1 && num % nr == 0) {
            num /= nr--;
        }
    }
    while (nr > 1)
        num /= nr--;
    return num;
} 
```

# javascript - IE8 中的“'localStorage' 为空或不是对象”错误

> ID：12772010
> 
> 赞同：1
> 
> 时间：2012-10-07T19:19:52.117
> 
> 标签：javascript, html, internet-explorer-8, local-storage

我有这个字符串，我正在尝试存储并获取到 localStorage，并从中检索它以便显示。这是我的代码：

```
var datas = new Array;
if (navigator.appName !== 'Microsoft Internet Explorer'){
    var qsVal = document.getElementsByClassName("val");
}
else{
    var qsVal = document.querySelectorAll('.val');
}
if (navigator.appName !== 'Microsoft Internet Explorer'){
    var qsKey = document.getElementsByClassName("key");
}
else{
    var qsKey = document.querySelectorAll('.key');
}
var storedPlays;
var stuff = document.getElementById("stuff");

function pushArray(){
    for (var i=0, len = qsVal.length; i < len; i++){
    thisValue = qsVal[i].value;
    thisKey = qsKey[i].value;
    datas.push([thisValue,thisKey]);
    }
localStorage.setItem('datas', JSON.stringify(datas));
}

function showStuff(){
    storedPlays = JSON.parse(localStorage.getItem('datas'));
    document.getElementById("stuff").innerHTML = storedPlays;
} 
```

它适用于 FF 和 Chrome，但是当我调用 'showStuff' 时 IE8 返回“'localStorage' 为 null 或不是对象”。

有趣的是，当我调用“pushArray”时它*不会给我一个错误，它也使用“localStorage”。*

我也试过使用“window.localStorage”而不是“localStorage”，它返回了同样的错误......

根据 Microsoft 和 W3 的说法，IE8 应该支持 localStorage，所以有人知道问题出在哪里吗？太感谢了！

**编辑**-[这](http://jsfiddle.net/yrhdN/)是代码的 jsfiddle。出于某种原因，它并没有那么好，只是为了让你感觉一下代码......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T07:03:17.183

据我了解，IE8 只为有效域提供存储。尝试将您的示例放在某个 Web 服务器中，它应该可以解决问题。

当我将它作为一个单独的文件进行测试时，我遇到了同样的问题，但是当我将它放在服务器中（在我的例子中是 Tomcat）时，它工作得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-07T19:22:48.900

检查您是否实际上处于 IE 8 模式 - 而不是怪癖或 IE 7 模式。最快的方法是按 F12 以调出开发工具，浏览器模式列在该选项卡的右上角。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T19:24:12.043

我会使用**window.localStorage**作为镜头。请参阅IE[的 Web 存储简介](http://msdn.microsoft.com/en-us/library/cc197062%28v=vs.85%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T19:45:39.173

你能在 IE 中打开开发者工具并检查那个 typeof json。stringify 和 json.parse 是函数，也是本地存储。我不确定 IE 上是否存在原生 JSON。

另外，为什么要将对象设置在循环内，不应该在循环之外？

**[编辑]** 为您的代码[jsfiddle.net/yrhdN/2](http://jsfiddle.net/yrhdN/2)添加了这个小提琴，一切似乎都运行良好。我在IE8兼容模式下测试过IE9）

**[编辑]** 关于这段代码的另一件事，似乎 showStuff() 中的 innerHtml 不适用于段落。将 html 从 p 更改为 div 并使用 innerText 会使事情变得更好：

```
<div id="stuff">
</div>

function showStuff(){
    var storedPlays    = JSON.parse(localStorage.getItem('datas'));
    document.getElementById("stuff").innerText = storedPlays;
} 
```

这似乎只发生在 IE 中。这是一个更新的小提琴：http: [//jsfiddle.net/yrhdN/7/](http://jsfiddle.net/yrhdN/7/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-23T06:19:41.973

如果您不希望任何本地服务器应用程序拍摄网页，请尝试此操作。

*   在您的脚本中查找代码： `window['localStorage'] !== null`
*   将其更改为：`window['localStorage'] != null`

它在我的情况下有效。

# sql-server - 查询空间索引无响应

> ID：12772012
> 
> 赞同：3
> 
> 时间：2012-10-07T19:19:56.777
> 
> 标签：sql-server, tsql, spatial-index

我有一个位于 SQL Server 2008 上的数据库，其中包含约 120 亿行，所有行都包含纬度、经度和相应的地理字段。我最近需要添加对地理字段的查询功能。我添加了空间索引，处理超过 4TB 的数据需要 6 天。

```
CREATE SPATIAL INDEX IX_Location_Geo ON Location
(
    Geo
) USING  GEOGRAPHY_GRID 
WITH (
    GRIDS =(LEVEL_1 = MEDIUM,LEVEL_2 = MEDIUM,LEVEL_3 = MEDIUM,LEVEL_4 = MEDIUM), 
    CELLS_PER_OBJECT = 16, PAD_INDEX  = OFF, SORT_IN_TEMPDB = OFF, 
    DROP_EXISTING = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON PRIMARY
GO 
```

使用这样的查询添加预期......

```
SELECT TOP 100 
    ci.LocationID, ci.Geo.STDistance(@g)  
FROM Location ci WITH(INDEX(IX_Location_Geo))
WHERE ci.Geo.Filter(@region) = 1 
ORDER BY ci.Geo.STDistance(@g) 
```

这是估计的执行计划......

![执行计划](../Images/4fb3416e4d24830377c98d6809014f8c.png)

我在 100 个轧机行的样本集上测试了这个查询，它工作得非常好。但是在 12 个账单行上，查询在约 4 小时后没有响应，最后由于磁盘写入错误而失败，这很奇怪，因为磁盘有 5TB 未使用。

```
Msg 1101, Level 17, State 10, Line 4 Could not allocate a new page 
for database 'TEMPDB' because of insufficient disk space in filegroup 
'DEFAULT'. Create the necessary space by dropping objects in the filegroup, 
adding additional files to the filegroup, or setting autogrowth on for 
existing files in the filegroup. 
```

希望有人可能会看到我的明显疏忽。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:36:59.083

与其使用*垂直*可扩展性（添加更多内存、CPU、硬盘空间 - 制作一台强大的机器），不如考虑使用*水平*可扩展性（在许多商品服务器之间拆分负载）。任何操作都需要时间和空间。Big-O 表示法描述了，对于任何花费超过 的计算`O(N)`，你注定要计算*这样*的体积。这就是为什么从高层次来看，您会遇到错误并且需要大量时间来完成查询。

**可能的解决方案**

改变数据访问的模式。使用分片 - 将数据拆分成更小的块。广泛使用`WHERE`子句和`Skip/Take`分页模式（我不确定 T-SQL 中的正确语法）。也`Map-Reduce`有引起轰动的图案。简而言之，停止以*该*音量垂直缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T10:47:01.143

您发布的错误消息说磁盘空间已用完`tempdb`，而不是您的主数据库。因此，您可以为其腾出可用空间，但 SQL Server 首先应该会消耗这么多空间！所以这不是一个解决方案。

请张贴预计的执行计划（因为您无法获得实际的执行计划）。我将用我对计划的想法更新这个答案。

作为一般评论：调试查询性能问题通常从计划开始，因为它告诉您 SQL Server 在执行时做了什么。

# php - 递归 Yii 查询

> ID：12772015
> 
> 赞同：0
> 
> 时间：2012-10-07T19:20:31.143
> 
> 标签：php, web-applications, yii, recursive-query, yii-relations

我对 Yii 还很陌生，并且遇到了相关模型的障碍。我怀疑其他初学者也会不时遇到这个问题，即使只是为了指出我正确的方向，我也会感谢任何输入，因为我在这个问题上找不到任何东西。

我有三个相关的模型-

*   帖子
*   回应
*   评论

帖子有_很多回复和回复有_很多评论-

发表->回复->评论

我想在 Post 控制器中运行一个查询，针对返回关联响应及其关联评论的特定帖子。我的印象（正确/错误）可以使用 find 方法结合以下一些变体来完成 -

```
Post::model()->with('responses','comments')->findAll(); 
```

显然这是行不通的。有人知道解决这个问题的方法或方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T04:39:06.877

Yii 以更好的方式完成你正在寻找的事情。我希望这将解决您的问题。

```
Post::model()->with('responses','responses.comments')->findAll(); 
```

但是他们的一件事应该是响应模型与评论模型的关系评论。

# c# - 检测未选中但单击了 C# windows 窗体应用程序的标签页

> ID：12772016
> 
> 赞同：1
> 
> 时间：2012-10-07T19:20:39.727
> 
> 标签：c#, windows, forms, tabcontrol

我正在尝试在 Windows 表单应用程序中构建 Web 浏览器。我在上下文菜单中添加了关闭选项卡的选项。我不希望在右键单击时选择标签页，只需要出现上下文菜单。这很好用。问题是当我单击关闭选项卡时，前一个选项卡关闭，而不是当前选项卡，因为上一个选项卡是被选中的选项卡。我试图通过获取标签页的矩形位置来解决这个问题，但对于所有标签来说似乎都是一样的。请帮忙！

```
 //this is my event handler for closing the tab
    private void closeToolStripMenuItem_Click(object sender, EventArgs e)
    {
        this.tabControlBrowser.TabPages.Remove(this.tabControlBrowser.SelectedTab);   
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T19:41:15.157

是的，您是正确的，那是因为您正在使用

```
this.tabControlBrowser.TabPages.Remove(this.tabControlBrowser.SelectedTab); 
```

这将删除当前选定的选项卡，但不会删除您单击的选项卡页。

请尝试以下代码，希望它能帮助您继续前进

```
TabPage _ClickedTab;
    public Form1()
    {
        InitializeComponent();
        this.tabControl1.MouseClick += new MouseEventHandler(tabControl1_MouseClick);

    }

    void tabControl1_MouseClick(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Right)
        {
            this.contextMenuStrip1.Show(this.tabControl1, e.Location);

            Rectangle r2 = this.tabControl1.GetTabRect(0);

            foreach (TabPage item in this.tabControl1.TabPages)
            {
                Rectangle r = this.tabControl1.GetTabRect(tabControl1.TabPages.IndexOf(item));
                if (r.X < e.Location.X && e.Location.X < r.X + r.Width && r.Y < e.Location.Y && e.Location.Y < r.Y + r.Height)
                {
                    _ClickedTab = item;
                }

            }

        }
    }

    private void toolStripMenuItem3_Click(object sender, EventArgs e)
    {
        this.tabControl1.TabPages.Remove(_ClickedTab);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:01:42.080

您可以针对 TabControl#GetTabRect 返回的矩形测试鼠标的位置

# ruby-on-rails - git repository move rails application code to live to test repository

> ID：12772021
> 
> 赞同：1
> 
> 时间：2012-10-07T19:20:56.930
> 
> 标签：ruby-on-rails, github, environment, git-merge

您好，我在 Github 上有两个用于 Rails 应用程序的分支。

一个是测试，另一个是现场。

问题是 Live 分支上有最新的更改，而测试没有最新的更改。

所以我想将代码从 Live 转移到 github 上进行测试。

环境都具有不同的数据库名称和具有不同的 deploy.rb 文件与他们的环境。

所以我关心的是如何在不更改数据库和 deploy.rb 文件的情况下使用实时环境代码更新测试环境代码。

请帮我。
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T06:47:07.857

您可以放置​​一个**[合并驱动程序](https://stackoverflow.com/questions/1910444/git-merge-s-theirs-needed-but-i-know-it-doesnt-exist/1910479#1910479)**，该驱动程序将始终保留这两个文件（`deploy.rb`和`database.yml`）的本地版本。

参见示例“[我如何告诉 git 始终选择我的本地版本以在特定文件上进行冲突合并？](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s) ”。
您可以在文件中声明该合并驱动程序`.gitattributes`，这意味着它将从上游存储库发布到上游存储库（与 git config 解决方案相反，它纯粹是您的存储库本地的）

# google-apps-script - UrlFetchApp 中的缓存

> ID：12772033
> 
> 赞同：1
> 
> 时间：2012-10-07T19:21:47.203
> 
> 标签：google-apps-script

在 Google App Script 中，我`UrlFetchApp()`用来引入一些从外部主机提供的代码。我对该主机上提供的代码进行了更改，但这些并没有出现在脚本运行的代码中。

我的服务器日志显示有时会请求（并提供）期望，但它没有显示在脚本中。

我`optAdvancedArgs`在 UrlFetchApp 调用中使用，传入`{"headers" : {"Cache-Control": "no-cache"}`

但这没有帮助。

是否有某种由 获得的资源缓存`UrlFetchApp()`，如果有，我该如何关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:09:49.367

将标头 Cache-Control 设置为 max-age=1 似乎可以解决问题。

该讨论提供了一些有用的上下文：[https ://developers.google.com/speed/docs/best-practices/caching](https://developers.google.com/speed/docs/best-practices/caching)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-18T21:06:49.467

像这样动态设置您的 URL：

```
var url = "https://yoururl.com/?" + Math.floor(Math.random() * 1000000000);
var responseUrl = UrlFetchApp.fetch(url).getContentText(); 
```

# asp.net-mvc - Google App Engine Python 用 webapp2 做 ASP.NET MVC 路由

> ID：12772037
> 
> 赞同：2
> 
> 时间：2012-10-07T19:21:57.827
> 
> 标签：asp.net-mvc, google-app-engine, asp.net-mvc-routing, webapp2

我希望能够以与 ASP.net MVC 类似的方式路由我的请求。

例如地址 /Home/Index/query-string/ 应该将请求映射到 HomeController 并调用 Index 方法。

我为此做了一个实现并且它有效，但我想知道一个更好的方法来做到这一点。我刚开始第一次使用 Google App Engine 和 Python，我没有太多开发网站和 Web 应用程序的经验。

这是我的实现

Yaml 文件：

```
- url: /.*
script: router.app 
```

路由配置：

```
def StartUp():
    sys.path.append(os.path.join(os.getcwd(), 'System'))
    sys.path.append(os.path.join(os.getcwd(), 'Controllers'))
    sys.path.append(os.path.join(os.getcwd(), 'Models'))
    app.run()

app = webapp2.WSGIApplication([webapp2.Route('/', handler=Router, name='Default', defaults={'handler': 'home', 'method': 'index', 'query': ''}, build_only=False, handler_method='map'),
                            webapp2.Route('/<query>', handler=Router, name='DefaultC', defaults={'handler': 'home', 'method': 'index'}, build_only=False, handler_method='map'),
                            webapp2.Route('/<handler>/', handler=Router, name='DefaultCS', defaults={'method': 'index', 'query': ''}, build_only=False, handler_method='map'),
                            webapp2.Route('/<handler>/<query>', handler=Router, name='DefaultCA', defaults={'method': 'index'}, build_only=False, handler_method='map'),
                            webapp2.Route('/<handler>/<method>/', handler=Router, name='DefaultCAS', defaults={'query': ''}, build_only=False, handler_method='map'),
                            webapp2.Route('/<handler>/<method>/<query>', handler=Router, name='DefaultAll', build_only=False, handler_method='map'),
                            webapp2.Route('/<handler>/<method>/<query>/', handler=Router, name='DefaultAllS', build_only=False, handler_method='map')],
                            debug=True)

if __name__ == '__main__':
    StartUp() 
```

路由器

```
class Router(webapp2.RequestHandler):

    def getControllerName(self, handler):
            handler = handler.lower()
            if(len(handler) == 0):
                    """ Error - redirect to error page """
                    return webapp2.redirect('/Error/')
            if len(handler) == 1:
                    handler = handler[0].capitalize()
            else:
                    handler = handler[0].capitalize() + handler[1:]

            handler = handler + 'Controller'

            return handler

    def getActionName(self, method):
            method = method.lower()
            if(len(method) == 0):
                    """ Error - redirect to error page """
                    return webapp2.redirect('/Error/')
            if len(method) == 1:
                    method = method[0].capitalize()
            else:
                    method = method[0].capitalize() + method[1:]

            requestType = self.request.method.lower()
            requestType = requestType[0].capitalize() + requestType[1:]

            return method

    def loadController(self, controllerName):
            """ Load the controller """
            try:
                    fileName, pathName, description = imp.find_module(controllerName, None)
                    module = imp.load_module(controllerName, fileName, pathName, description)

                    # Add checking if class was found
                    controllerRef = getattr(module, controllerName)
                    return controllerRef

            except ImportError, args:
                    logging.error('Error importing controller. ' + pprint.saferepr(args))
            except Exception, args:
                    logging.error('Exception. ' + pprint.saferepr(args))
            finally:
                    fileName.close()

    def loadAction(self, controller, actionName):
            try:
                    actionRef = getattr(controller, actionName)
            except Exception, args:
                    logging.error('Exception. ' + pprint.saferepr(args))
            return actionRef

    def callController(self, controllerName, actionName, query):
            try:
                    """ Load the controller """
                    controllerRef = self.loadController(controllerName)
                    controller = controllerRef(self, query)
                    actionRef = self.loadAction(controller, actionName)
                    actionRef()
            except Exception, args:
                    logging.error('Exception. ' + pprint.saferepr(args))

    def map(self, handler, method, query):
            query = query.lower()
            """ Create Names for Controller and Action"""
            controllerName = self.getControllerName(handler)
            actionName = self.getActionName(method)

            self.callController(controllerName, actionName, query) 
```

这是我的家庭控制器：

```
class HomeController(MVC.Controller):

    def Index(self):

            path = os.path.join(os.path.dirname('Views/Home/'), 'home.html')
            self.Request.response.out.write(template.render(path, None)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T10:26:22.710

使用这种方法，我找不到更好的方法。

另一种方法是在类和方法上使用装饰器来指定路由（不确定实现这样的特性有多容易）。

```
 @RouteFor('/SomePath')
  class HomeController(MVC.Controller):
        @RouteFor('/SomePath/Index')
        def Index(self):
                path = os.path.join(os.path.dirname('Views/Home/'), 'home.html')
                self.Request.response.out.write(template.render(path, None)) 
```

# php - file_get_contents 获取 PHP 文件的部分

> ID：12772038
> 
> 赞同：1
> 
> 时间：2012-10-07T19:21:58.957
> 
> 标签：php, file-get-contents

我有以下代码：

```
<?php 
$path=$_SERVER['HTTP_HOST'].$_SERVER[REQUEST_URI];
$test=file_get_contents('http://www.domain.com/test.php?i='.$path);
echo $test;
?> 
```

我想根据 $path 变量（访问 test.php 文件的 URL）获取并插入 test.php 文件的特定部分。

我该怎么做呢？我在正确的轨道上吗？我不知道如何设置我的 text.php 文件，以便该函数回显访问它的网页的正确部分。我该怎么做呢？或者，还有更好的方法？（test.php 不是本地文件）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:24:10.910

在我看来，您正试图根据访问它的任何脚本在 test.php 上显示动态信息（例如 html 或文本）。从那里，您想从 test.php 获取信息并通过提取源代码并回显它来将其传递回 index.php？如果我错了，请纠正我。

这可以使用 $_GET 变量来实现。`?i=`通过添加到 URL 的末尾，您已经朝着正确的方向前进。

这样的事情应该可以帮助您大致实现您想要的：（test.php）

```
if (isset($_GET['i]') {
    switch ($_GET['i']) {   
        case 'http://www.domain2.com/index.php':
            echo 'You\'re on domain2.com';
            break; 
        case 'http://www.domain3.com/index.php':
            echo 'You\'re on domain3.com';
            break;
    }
} 
```

index.php 应该可以正常工作，除非变量中存储的有关您当前所在页面的路径的数据不正确。

# ruby - Ruby：方法查找器 gem 示例

> ID：12772046
> 
> 赞同：3
> 
> 时间：2012-10-07T19:22:54.087
> 
> 标签：ruby

我发现了这个很棒的 gem 'method finder'，我试图用它来帮助提高我对 Ruby 的理解，问题是我并没有真正理解它。它从文档中给出了这个例子。'unknown' 方法应该替换任何会在周围代码中给出结果的方法，但是这个例子告诉我们什么？

```
>> 10.find_method { |n| n.unknown(3) == 1 }
=> ["Fixnum#%", "Fixnum#<=>", "Fixnum#>>", "Fixnum#[]", "Integer#gcd", "Fixnum#modulo", "Numeric#remainder"] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T19:29:50.463

它准确地告诉您您的要求：传递时`10`返回的所有方法：`1``3`

```
>> 10 % 3
 => 1 
>> 10 <=> 3
 => 1 
>> 10 >> 3
 => 1 
>> 10[3]
 => 1 
>> … 
```

# android - Android：使用布局充气器时不显示按钮状态

> ID：12772051
> 
> 赞同：0
> 
> 时间：2012-10-07T19:23:22.860
> 
> 标签：android, android-softkeyboard, android-xml, android-theme, layout-inflater

## 问题陈述

我正在尝试按照示例“softkeyboard”实现我自己的虚拟键盘，该示例位于 android-sdk 的示例文件夹中。

在 onCreateInputView() 视图中使用布局充气器创建，如下所示：

```
@Override
public View onCreateInputView() {
    mContainerView = getLayoutInflater().inflate(R.layout.my_keyboard, null);
    return mContainerView;
} 
```

在我漂亮的虚拟键盘 gui 定义 (my_keyboard.xml) 中，我添加了一些像这样的按钮。

```
<Button
    android:id="@+id/my_button1"
    android:onClick="onMyButton1Pressed"
    android:text="@string/my_button1_text" /> 
```

现在，如果我运行程序，Button 似乎正在工作： onMyButton1Pressed() 被调用 OK。问题是按钮状态图（按下时橙色突出显示）不起作用。

**编辑 1：**问题与 ToggleButton 相同：按下时，不会出现橙色突出显示。但是绿色的“选中”标记有效。如果我在正常活动中使用这些，按下按钮时会出现橙色突出显示。

## 到目前为止，我的发现可能有用或没有......

我一直在尝试 google，并阅读 android 文档。在某处我读到使用带有空根元素的膨胀，不会将主题/样式/背景可绘制/任何东西（正确的术语是什么？）应用于膨胀的层次结构。这是问题所在，为什么按钮状态不显示？

现在当我创建虚拟键盘时，根元素是什么，在哪里添加了键盘？

我还找到了另一种充气方法：

```
public View inflate (int resource, ViewGroup root, boolean attachToRoot)

    resource = ID for an XML layout resource to load (e.g., R.layout.main_page)
    root = Optional view to be the parent of the generated hierarchy (if attachToRoot is true), or else simply an object that provides a set of LayoutParams values for root of the returned hierarchy (if attachToRoot is false.)
    attachToRoot = Whether the inflated hierarchy should be attached to the root parameter? If false, root is only used to create the correct subclass of LayoutParams for the root view in the XML. 
```

我可以通过它可以从中提取布局参数的一些“虚拟”视图组吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T08:48:48.610

我按照芒果的建议尝试了背景可绘制+选择器xml，它可以工作。因此，这是一种可能的解决方法：

1.添加背景可绘制按钮

```
<Button
    android:id="@+id/my_button1"
    android:onClick="onMyButton1Pressed"
    android:text="@string/my_button1_text" 
    android:background="@drawable/my_button_drawable
/> 
```

2.在/res/drawable/中创建my_button_drawable.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true"
          android:drawable="@drawable/btn_default_pressed" />
    <item android:state_enabled="false"
          android:drawable="@drawable/btn_default_transparent_normal" />
    <item android:drawable="@drawable/btn_default_normal" />
</selector> 
```

3.寻找按钮背景图片：ANDROID_SDK_FOLDER/platforms/android-8/data/res/drawable-hdpi/

*   btn_default_normal.9.png（用于正常状态）
*   btn_default_pressed.9.png（用于按下状态）
*   btn_default_transparent_normal.9.png（用于禁用状态）

并将这些图像添加到可绘制文件夹中。

现在，如果我按下按钮，它会变成橙色突出显示，并且禁用状态看起来也不错。我不需要焦点或选定状态，因此我没有将它们包含在选择器中。

# java - 如何在eclipse中将服务器证书添加到java应用程序中

> ID：12772053
> 
> 赞同：2
> 
> 时间：2012-10-07T19:23:24.140
> 
> 标签：java, ssl, ssl-certificate, keytool, jsse

我有一个服务器应用程序，它使用：

```
import javax.net.ssl.SSLServerSocket;
import javax.net.ssl.SSLServerSocketFactory;
import javax.net.ssl.SSLSocket; 
```

这是一个 java 应用程序，它本身就是一个服务器 - 我没有使用任何虚拟服务器，它不是一个 Web 应用程序。它应该从客户端应用程序接收连接并处理它们的请求。客户端应用程序和数据库之间的中间层。

在启动时它会运行，但会不断发送垃圾邮件（因为 while (true) {}）这个错误：

```
javax.net.ssl.SSLException: No available certificate or key corresponds to the SSL cipher suites which are enabled.
    at com.sun.net.ssl.internal.ssl.SSLServerSocketImpl.checkEnabledSuites(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLServerSocketImpl.accept(Unknown Source) 
```

因此，我查阅了一些 SSL 证书创建指南并使用以下命令制作了证书：

```
keytool -genkey -alias serverprivate -keystore servestore -keyalg rsa -keysize 2048
keytool -export -alias serverprivate -keystore servestore -rfc -file server.cer 
```

并将其导入到我的本地证书存储中，因此我可以使用我的客户端应用程序对其进行测试：

```
keytool -import -alias trustservercert -file server.cer -keystore clienttruststore 
```

所有这些都是在我的 $JAVA_HOME\bin 目录中完成的。我还更新了我的 eclipse.ini 文件

```
-vm
$JAVA_HOME\bin\javaw.exe 
```

所以eclipse将使用我的jdk7虚拟机来运行应用程序。

同时，我尝试将文件复制到 $ECLIPSE_HOME 和应用程序主目录中`server.cer`。`servestore`

结果是：同样的错误信息。它不会阻止应用程序运行，但它仍然存在。

非常感谢这里的一些帮助。我究竟做错了什么？也许有一个很酷、详细、对新手友好的关于使用 SSL 创建应用程序的指南，但我找不到？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T07:35:49.270

您必须将这些参数添加到您的 jvm 启动中。

```
-Djavax.net.ssl.trustStore="<path to truststore>"
-Djavax.net.ssl.trustStorePassword=password 
```

如果您需要有关 Java 和 SSL 的更多详细信息，请查看[此](http://stilius.net/java/java_ssl.php)。

# c# - 我在这个 C# 合并排序算法中做错了什么？

> ID：12772054
> 
> 赞同：2
> 
> 时间：2012-10-07T19:23:29.777
> 
> 标签：c#, algorithm, mergesort

对于学校作业，我必须实施归并排序。

我用这段代码来做到这一点：

```
static int[] MergeSort(int[] C)
    {
        int left = 0;
        int right = C.Length;
        int middle = (left + right) / 2;
        int[] A, B;
        A = new int[middle];
        B = new int[middle];

        if (C.Length == 0 || C.Length == 1)
        {
            return C;
        }
        else
        {
            for (int i = left; i < middle; i++)
            {
                A[i] = C[i];
                B[i] = C[middle + i];
            }

            MergeSort(A);
            MergeSort(B);
            return Merge(A, B, C);
        }
    }

    static int[] Merge(int[] A, int[] B, int[] C)
    {
        int i, j, k;
        i = j = k = 0;
        int n = A.Length;
        int m = B.Length;
        int c = C.Length;
        int middle = C.Length / 2;

        while (i < n && j < m)
        {
            if (A[i] < B[j])
            {
                C[k] = A[i];
                i++;
            }
            else
            {
                C[k] = B[j];
                j++;
            }
            k++;

            if (i == n)
            {
                for (int b = i; b < B.Length; b++)
                {
                    C[middle + b] = B[b];
                }
            }
            else
            {
                for (int a = i; a < A.Length; a++)
                {
                    C[middle + a] = A[a];
                }
            }
        }

        return C;
    } 
```

但它不适用于许多不同的行。我已经调试并检查了约束是否有问题，但我似乎找不到问题。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T19:35:30.540

我发现的第一件事是您如何将数组分成两部分：

```
A = new int[middle];
B = new int[middle]; 
```

如果长度不均匀，您将省略最后一项。你应该有：

```
A = new int[middle];
B = new int[right - middle]; 
```

然后你会为它们使用单​​独的循环，因为它们的长度可能不同：

```
for (int i = left; i < middle; i++) {
  A[i - left] = C[i];
}
for (int i = middle; i < right; i++) {
  B[i - middle] = C[i];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T23:02:57.067

除了 Guffa 答案之外，您还应该像这样编辑 Merge 方法的代码：

```
 while (i < n && j < m)
    {
        if (A[i] < B[j])
        {
            C[k] = A[i];
            i++;
        }
        else
        {
            C[k] = B[j];
            j++;
        }
        k++;
    }
    if (i == n)
    {
        for (int b = j; b < B.Length; b++)
        {
            C[k++] = B[b];
        }
    }
    else
    {
        for (int a = i; a < A.Length; a++)
        {
            C[k++] = A[a];
        }
    } 
```

While 循环块应该在 k++ 之后立即结束，并且在第一个 for 循环中，您应该用 j 而不是 i 初始化 b。另外，注意 C 数组的下一个元素的索引，它是 k，不一定是中间 + a 或 b。

# geocoding - 如何确定日落/日出，包括地形阴影。

> ID：12772055
> 
> 赞同：2
> 
> 时间：2012-10-07T19:23:35.133
> 
> 标签：geocoding, google-earth, google-earth-plugin, geo

在 Google 地球中，您可以使用“阳光”图层查看地形在任何给定日期时间投射的阴影：http: [//i.stack.imgur.com/YFGMj.png](http://i.stack.imgur.com/YFGMj.png)

但是，我无法找到从 API 访问阳光/亮度/阴影/等值的任何方法。

我正在寻找一种方法来提供 Lat、Long 和 DateTime 以确定一个区域是否处于阳光下（考虑到地形阴影，有无数的服务可以提供简单的日出和日落时间，但这些不考虑地形） . 这可以使用 Google 地球手动完成，但我正在寻找一种编程方法。

感谢您的任何想法，想法，线索...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-28T11:25:28.263

我意识到这是一个老问题，但它出现在我刚刚做的谷歌搜索中，我喜欢这个焦点。

由于您正在寻找一种编程方式来确定地球上由经度和纬度元组给出的点是否在给定时间暴露在阳光下，所以我现在无法帮助您。但是，如果我们看到这是许多人需要的功能，我可以很容易地设置这样的 API。在 suncurves.com，我们根据地形计算日出和日落时间。到目前为止，我们设置的解决方案是一个 Web 界面，用户可以在其中搜索地址或将图标拖放到地图上，以获取该地点一年中的日出和日落时间，并考虑地形。我们想为我们的数据创建一个 API，但我们还没有明确说明这个 API 的范围。您的要求要求我们需要：

1.  从经度和纬度的视点计算视地平线。这意味着在您的点周围 30-50 公里的搜索半径内扫描地形数据。
2.  计算指定时间的太阳位置。
3.  计算指定时间的太阳位置。根据您的点周围的地形（考虑到大气折射），确定太阳是在地平线之下还是在地平线之上。

这是法国夏蒙尼的一个例子，那里常见的平坦地形版本的日出，日落时间非常不值钱。

[http://suncurves.com/v/7/](http://suncurves.com/v/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:18:32.407

我不确定确定 AOI 在某个时间是在阳光下还是在阴凉处，但是您可以通过使用在 API 中将 SUN 设置为打开或关闭

[GESun.setVisibility](https://developers.google.com/earth/documentation/reference/interface_g_e_sun)

编辑：

使用 GE 插件，创建一个[具有所需 AOI 纬度/经度的 LookAt，其中视图在正上方直视下方](https://developers.google.com/earth/documentation/camera_control)。根据您实际 AOI 的大小，我会尽可能地保持视野低至地面。

然后捕获屏幕截图/图像 - 我认为这不可能通过 GE 实现（如果有人知道我想找出的方法），所以也许使用 javascript 来获取它 - 我[在 SO 上找到了这个 Q](https://stackoverflow.com/questions/60455/take-a-screenshot-of-a-webpage-with-javascript)提供了一些见解。

在 GESun.setVisibility 设置为 ON 的情况下截取一个屏幕截图，然后在另一个设置为 OFF 的情况下截取屏幕截图

比较两个图像的黑暗/明亮或其他东西，并确定您的 AOI 是否在阴影中。您可能会发现最好将您的 AOI 包围在某种多边形中，以帮助您的程序将其与图像的其余部分区分开来 - 取决于 LookAt 的高度等等......

我对如何比较图像没有任何想法，但是再次搜索 SO 导致了[这个](https://stackoverflow.com/questions/3270929/compare-2-images-in-php)（我假设在 PHP ImageMagick 中找到 COLOR_BLACK 的值）和[这个](https://stackoverflow.com/questions/23931/algorithm-to-compare-two-images)（颜色桶的想法）。根据您选择的方法，在进行比较之前将图像更改为黑白可能会有所帮助。

# python - 如何使用 Python 格式化 ISO 中的日期？

> ID：12772057
> 
> 赞同：5
> 
> 时间：2012-10-07T19:23:39.240
> 
> 标签：python, date, iso

我有一些日期格式`d/m/yyyy`（例如 1987 年 2 月 28 日）。我想要 ISO 格式：1987-02-28

我认为我们可以这样做，但它似乎有点沉重：

```
str_date = '2/28/1987'
arr_str = re.split('/', str_date)
iso_date = arr_str[2]+'-'+arr_str[0][:2]+'-'+arr_str[1] 
```

有没有另一种方法可以用 Python 做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-07T19:27:24.020

您可以使用该[`datetime`模块](http://docs.python.org/library/datetime.html)：

```
datetime.datetime.strptime(str_date, '%m/%d/%Y').date().isoformat() 
```

或者，作为运行代码：

```
>>> import datetime
>>> str_date = '2/28/1987'
>>> datetime.datetime.strptime(str_date, '%m/%d/%Y').date().isoformat()
'1987-02-28' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-07T19:27:28.927

我会使用该`datetime`模块来解析它：

```
>>> from datetime import datetime
>>> date = datetime.strptime('2/28/1987', '%m/%d/%Y')
>>> date.strftime('%Y-%m-%d')
'1987-02-28' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T19:27:13.100

你所拥有的几乎是我写它的方式，我可以建议的唯一主要改进是使用普通的 old`split`而不是`re.split`，因为你不需要正则表达式：

```
arr_str = str_date.split('/') 
```

如果您需要做任何更复杂的事情，我会推荐[`time.strftime`](http://docs.python.org/library/time.html#time.strftime)，但这比字符串抨击要贵得多*。*

# macos - NS-3 编译错误

> ID：12772061
> 
> 赞同：1
> 
> 时间：2012-10-07T19:24:07.477
> 
> 标签：macos, compiler-errors, ns-3

我正在尝试在 MAC Mountain Lion 上使用[NS-3.15](http://www.nsnam.org/ns-3-15)，但是当我编译时出现以下错误：

```
source not found: 'model/itu-r-1411-nlos-over-rooftop-propagation-loss-model.cc' in bld(features=['cxx', 'cxxshlib', 'ns3module'], ns3_dir_location='src/propagation', pcfilegen=bld(features='ns3pcfile', idx=2, meths=[], prec=defaultdict(<type 'list'>, {}), _name='', source='', module='ns3-propagation', mappings={}, path=/Users/user/Desktop/nsam.org/ns-allinone-3.15/ns-3.15/src/propagation, target='') in /Users/user/Desktop/nsam.org/ns-allinone-3.15/ns-3.15/src/propagation, use=['ns3-network', 'ns3-mobility'], mappings={}, uselib='', meths=['set_macosx_deployment_target', '_add_test_code', 'apply_bundle', 'process_rule', 'process_source', 'apply_link', 'apply_objdeps', 'apply_uselib_local', 'process_use', 'propagate_uselib_vars', 'apply_incpaths', 'apply_implib', 'apply_vnum'], prec=defaultdict(<type 'list'>, {}), source=['model/propagation-delay-model.cc', 'model/propagation-loss-model.cc', 'model/jakes-propagation-loss-model.cc', 'model/jakes-process.cc', 'model/cost231-propagation-loss-model.cc', 'model/okumura-hata-propagation-loss-model.cc', 'model/itu-r-1411-los-propagation-loss-model.cc', 'model/itu-r-1411-nlos-over-rooftop-propagation-loss-model.cc', 'model/kun-2600-mhz-propagation-loss-model.cc'], test=False, is_ns3_module=True, install_path='${LIBDIR}', module_deps=['network', 'mobility'], includes='.', dependencies=['network', 'mobility'], path=/Users/user/Desktop/nsam.org/ns-allinone-3.15/ns-3.15/src/propagation, vnum=None, posted=True, is_static=False, target='../../ns3.15-propagation-debug', idx=1, _name='ns3-propagation') in /Users/user/Desktop/nsam.org/ns-allinone-3.15/ns-3.15/src/propagation 
```

如果我理解正确，我认为这意味着它找不到这些依赖项，但我无法弄清楚如何添加它们或者它们应该在哪里，有人可以帮我吗？我正在关注[本教程](http://www.nsnam.org/docs/release/3.15/tutorial/ns-3-tutorial.pdf)。

我知道这本身不是一个编程问题，但我还没想好在哪里问，所以如果你知道更好的地方，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T20:56:54.527

您的安装不干净。尝试按照这个安装教程[http://www.nsnam.org/wiki/index.php/Installation](http://www.nsnam.org/wiki/index.php/Installation)

询问 NS3 问题的最快响应地点是他们的 NS3 用户组邮件列表[https://groups.google.com/forum/#!forum/ns-3-users](https://groups.google.com/forum/#!forum/ns-3-users)

# list - Haskell：列表理解

> ID：12772068
> 
> 赞同：2
> 
> 时间：2012-10-07T19:24:39.843
> 
> 标签：list, function, haskell, list-comprehension

我有一个接收列表的函数，如果列表中有 2 个相同且连续的数字，并且如果列表中的其他地方有一个数字 x，那么我想将 x 更改为 0 和返回列表。

```
twoAdjThenThirdZero (x:y:xs) = [if x == y && x `elem` xs then 0 else x | x <- xs] 
```

出于某种原因，每次我尝试运行它时都会忽略列表中的前两个元素。

```
*Main> twoAdjThenThirdZero [2,3,4,1,2,0,2,3,3] 
```

[4,1,2,0,2,0,0]

此外，上述情况与我想要的相反。我想将两个 3 保留在列表的末尾，并使第二个元素，即 3，为 0。但它被调换了。

```
*Main> twoAdjThenThirdZero [2,2,3,1,2,4] 
```

[3,1,0,4]

有人知道为什么是这样吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:27:51.340

试试这个：

```
adjToZero = adjToZero' (allDoubles xs) 

adjToZero' ds [] = []
adjToZero' ds [x] = [x]
adjToZero' ds (x:y:xs) = if (x/=y) && (x `elem` ds) then 0:(adjToZero' ds (y:xs))
                                                    else x:(adjToZero' ds (y:xs))

allDoubles [] = []
allDoubles (x:y:xs) = if (x==y) then x:(allDoubles xs)
                                else allDoubles (y:xs) 
```

例子：

```
> adjToZero [1,2,1,1]
[0,2,1,1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T19:37:59.003

我在这里看到了多个问题。首先解构函数声明中的参数列表`twoAdjThenThirdZero (x:y:xs)`。如果你想继续得到每一步的x和y，你必须递归。相反，您切换到使用列表推导和 x 的副本。在列表推导中，您将通过 xs，它是函数参数的所有元素，除了前两个（x 和 y）。

如果您大声阅读列表理解，我认为您可以弄清楚。

“如果 x 等于 y 并且 x 是 xs 的一个元素，则对于 xs 中的每个 x，否则 x 为零”。但是您希望为 x+y+xs 中的每个 x 完成它！您还以两种方式使用名称“x”，既是在函数参数的解构中，也是作为列表推导中的变量。

编辑：

现在我明白你的意思了。您只需将该显式递归添加到您已有的内容中。

```
twoAdjThenThirdZero [] = []
twoAdjThenThirdZero [x] = [x]
twoAdjThenThirdZero (x:y:xs) 
  | x == y && x `elem` xs = x : y : twoAdjThenThirdZero [if z == x then 0 else z | z <- xs]
  | otherwise             = x : twoAdjThenThirdZero (y:xs) 
```

我希望这对您有意义，如果没有，我会尝试进一步解释！

编辑：

phynfo 发布了我所写内容的稍微简单的版本！

# yii - Yii 识别时间戳列

> ID：12772069
> 
> 赞同：1
> 
> 时间：2012-10-07T19:24:53.923
> 
> 标签：yii

我正在使用 giix 来扩展模型（和 crud）行为。在此，我想专门处理时间戳类型的列（在我的模型中已经存在），就像处理自动增量字段一样。（即被忽略且未显示。）但是，没有属性`$column->isTimestamp`。我想在某个地方添加这个，但我很茫然，最好的地方是什么。我是把它放在某个地方的 giix 中，还是我必须扩展列基类？

编辑：我想从每个视图中忽略它们，对于每个表。由于这是很多工作，而且这是我一直想要的，所以我想自动化它。调整生成器似乎最有意义，但我不确定最好的方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:44:34.390

您将需要查询列模式，我没有使用 giix 但找到它在哪里生成视图，它应该循环通过模型属性或基础表模式。

如果它在模式中循环：

```
//you can also ask Yii for the table schema with Yii::app()->db->schema->getTable[$tableName];
if ('timestamp' === $tableSchema->columns[$columnName]->dbType)
  continue; //skip this loop iteration 
```

如果它遍历属性：

```
$dbType = Yii::app()->db->schema->getTable[$model->tableName]->columns[$modelAttribute]->dbType;
if ('timestamp' === $dbType)
  continue; //skip this loop iteration 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T15:37:02.337

这是过程：

1.  扩展你的数据库模式，如果你在 MySQL 上，它是 CMysqlSchema。
2.  扩展 CMysqlColumnSchema 并添加一个“isTimestamp”属性。
3.  在您的 CMysqlSchema 子类中扩展 createColumn 并测试时间戳，您会看到 Yii 在此处进行简单的字符串比较以设置它自己的标志。在此处的 CMysqlColumnSchema 中设置“isTimestamp”。
4.  告诉 Yii 在配置的组件部分中像这样使用您的模式驱动程序：

> ```
> 'db' => array(
>   'connectionString' => 'mysql:host=localhost;dbname=database',
>   'username' => '',
>   'password' => '',
>   'driverMap' => array('mysql' => 'CustomMysqlSchema'),
> ), 
> ```

# air - Adobe Air Mac App Store 收据验证

> ID：12772073
> 
> 赞同：1
> 
> 时间：2012-10-07T19:25:39.600
> 
> 标签：air, mac-app-store

我们有一个基于 Adob​​e Air 的应用程序，我们已成功为 Mac 部署该应用程序，但希望将其带到 Mac App Store。按照此处的说明[http://pigsels.com/2012/04/air-app-store-publishing-guide/](http://pigsels.com/2012/04/air-app-store-publishing-guide/)以及该页面上提到的沙盒部分的 Adob​​e 论坛主题；我们似乎有一个能够部署在商店中的构建。

此后成为问题的是为我们的航空应用程序实施商店收据 DRM。mac商店在下载.app包时会在.app包中放置一个收据文件，这可以按照Apple在此处提供的说明进行验证[http://developer.apple.com/library/mac/#releasenotes/General/ValidateA](http://developer.apple.com/library/mac/#releasenotes/General/ValidateA) ppStoreReceipt /_index.html。

但是，由于我们无法从 Air 播放器中获取系统 GUID，因此我创建了一个单独的可执行文件来验证收据，然后 Air 主应用程序将其作为本机进程调用并进行验证。在 Mac Store 要求收据检查可执行文件被沙盒化并且无法再访问收据文件之前，这一直很好用。

在 mac 商店中对 Air 应用进行收据验证的正确方法是什么？

# c - Boomerang：无法加载 libQtGUI

> ID：12772074
> 
> 赞同：10
> 
> 时间：2012-10-07T19:25:48.547
> 
> 标签：c, linux, gdb, boomerang

我在 Fedora 17 上安装了回旋镖，在执行 ./boomerang-gui 时我得到：

```
./boomerang-gui: error while loading shared libraries: libQtGui_debug.so.4: cannot open shared object file: No such file or director 
```

我做了一个“sudo yum install qt-x11”，但已经安装了 QT。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-10-11T15:52:01.777

从错误：

```
./boomerang-gui: error while loading shared libraries: libQtGui_debug.so.4: cannot open shared object file: No such file or directory 
```

看起来`boomerang-gui`已经与 Qt 库的调试版本链接。所以创建一个像下面这样的符号链接是可行的。

```
sudo ln -s /usr/lib/i386-linux-gnu/libQtGui.so.4 /usr/lib/libQtGui_debug.so.4 
```

和

```
sudo ln -s /usr/lib/i386-linux-gnu/libQtCore.so.4 /usr/lib/libQtCore_debug.so.4 
```

或者，您可以从 ubuntu synaptic 包管理器安装 Qt 库的调试版本。( `libqt4-dbg`)

# c++ - C++ 中的 << 运算符是什么？

> ID：12772076
> 
> 赞同：2
> 
> 时间：2012-10-07T19:25:59.403
> 
> 标签：c++, function, operators

我来自 C# 和 Java 背景进入 C++，我试图了解`>>`&`<<`运算符，例如

```
std::cout << "Hello World"; 
```

我在这里无法理解的是`<<`操作员的用途。我尝试声明我自己的简单函数，它总是返回整数`5`，我可以像在 C# 中那样调用它，

```
int x = MyFunction(); 
```

这变成`x`了`5`，但为什么我需要使用`std::cout`with `<<`？另外，如果您帮助我了解两者的用途，我将不胜`>>`感激`<<`。

感谢大家帮助我理解这一点。实际上让我想到的是 std::cout 是和对象的事实:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-07T19:31:12.943

您没有准确地拼写出来，但我相信您的困惑在于您认为这`std::cout`是一个函数，并且您想知道为什么不这样称呼它：

```
std::cout("Hello World"); 
```

嗯，`std::cout`不是函数。该语句中的函数是`operator<<`。

```
std::cout << "Hello World"; 
```

或者，更具体地说，函数是`std::ostream::operator<<(const char*)`。

您需要了解的是，运算符只是具有替代调用语法的函数。 `operator<<`被重载为 的成员函数`std::ostream`，并且`std::cout`是 的对象`std::ostream`。所以这：

```
std::cout << "Hello World"; 
```

是另一种调用方式：

```
std::cout.operator<<("Hello World"); 
```

请注意，这`operator<<`是一个二元运算符，这意味着如果它被声明为自由函数，则它需要两个参数，如果它被声明为成员函数，则需要一个参数。当您使用替代调用语法时，左边的对象是第一个参数，右边的对象是第二个参数。在它被声明为成员函数的情况下，就像在这种情况下一样，左边的对象是调用对象，右边的对象是参数。

如果它被声明为自由函数，它会是什么样子：

```
operator<<(std::cout, "Hello World"); 
```

但是，无论是声明为成员还是自由函数，您仍然可以使用相同的替代调用语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T19:29:17.710

在 I/O 流的情况下，`<<`and`>>`运算符被重载以表示位移以外的东西。例如，[std::ostream::operator<<](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/)对许多类型都进行了重载，您也可以为自己的类型添加重载。例如：

```
#include <string>
#include <iostream>

class my_type {
public:
    my_type(const std::string &name) : _name(name) { }
    const std::string &get_name() const { return _name; }
private:
    std::string _name;
};

std::ostream& operator<< (std::ostream& out, const my_type &foo ) {
    return out << foo.get_name();
}

int main() {
    my_type m("foo");
    std::cout << m;   // prints "foo"
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T19:31:04.210

`<<`是左移运算符，`>>`是右移运算符，就像它们在 Java 和 C# 中一样。

但是，*另外*,`<<`被重载以提供一种将值输出到流的方式。流`std::cout`通常是指启动程序的终端，向该流`<<`写入内容会将其写入终端。`>>`类似地重载以从流中读取，并且在流的情况下`std::cin`从终端读取程序已启动。

这种事情在 C++ 中有效，因为您为用户定义的类型定义了运算符的行为。在 Java 中，运算符仅对内置类型进行操作 -如果并且是您自己的类的实例，则编写`a + b`是错误的。在 C++ 中，*如果*类定义了合适的 operator ，这是允许的。`a``b`*`+`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-07T19:28:37.650

一般来说，`<<`和`>>`运算符具有相同的含义。但是，在您给出的情况下，它们分别是流写入和读取运算符。具体来说，`<<`是写操作符（认为它指向流）和`>>`读操作符（指向远离流）。

它们是通过重载`<<`and`>>`运算符来处理的。特别是，C++ 范式是分别为s 和`<<`s添加重载来处理输入和输出。C++ 没有像 Java 和 C# 那样的内置范例。`>>``ostream``istream``ToString()`

最后，`std::cout`和`std::cin`分别是和`std::cerr`的实例`ostream`，这就是它们获得和重载的原因。`istream``ostream``<<``>>`

例如，以下代码输出`Hello World`到标准输出流。

```
std::cout << "Hello World" << std::endl; 
```

最后， std::endl 是一个特殊`ostream`的添加换行符并刷新流的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-07T19:29:24.867

据我记得，c++ 有流
<< 是一个运算符，它是一个用于将数据“附加”到流的运算符，
而 >> 用于从流中提取数据。
当然，您可以使用不仅仅是流的类来实现这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-07T19:34:22.530

在 C 和 C++ 中，<< 运算符的意思是“左移”。在 C++ 中，当使用标准模板库时，<< 和 >> 运算符被重载以实现流式 API。

对象 std::cout 确实重载了 << 运算符以将其用作转换函数（在本例中为打印到控制台的字符串）。

其实这个：

```
int x = myFunction();
std::cout << x; 
```

还有这个：

```
std::cout << myFunction(); 
```

在功能上是相同的（除了临时变量 x 的定义）。*

# java - 传递参数以从 mysql java 中检索数据的方法

> ID：12772080
> 
> 赞同：1
> 
> 时间：2012-10-07T19:26:40.903
> 
> 标签：java, mysql, methods

我想在将值传递给参数时创建一个方法，它将传递给 sql 语句。这是我尝试过的：

```
import java.sql.*;
import java.util.*;
import java.text.*;

public class cobadatabase{
    protected String sn,fn,ln;
    private Connection conn;
    private PreparedStatement st; 
    public cobadatabase(String studentnumber)
    { 

        try{
            Class.forName("com.mysql.jdbc.Driver");
            conn = DriverManager.getConnection("jdbc:mysql://localhost/studentrecords","root","");
            st = conn.prepareStatement("SELECT * FROM student WHERE Student_Number=?");
            ResultSet rs = st.executeQuery();

            while (rs.next()){

                sn = rs.getString(1);
                fn = rs.getString(2);
                ln = rs.getString(3);
                SimpleDateFormat ft = new SimpleDateFormat("kk:mm:ss");
                ft.format(rs.getTime("Total Time").getTime());

            }
        }
        catch(Exception e){
            e.printStackTrace();

        } 
```

我不知道我的代码有什么问题。我只想检索数据以进行打印

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:27:44.093

我猜你的意思是这样的：

```
public String Func (String par1, String par2) throws SQLException {
     String query;
     query ="SELECT ... WHERE COLUMN_NAME between  +"'"+par1+"'"+" AND " +"'"+par2+"'"+..."; 

    rs = st.executeQuery(query);   // get data or just Execute without getting results 
```

请注意，在字符串之间应该有一个`" '' "`（非双引号），而数值不应该。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:27:59.863

你还没有设置**参数**`prepareStatement`

```
st = conn.prepareStatement("SELECT * FROM student WHERE Student_Number=?");
// You need to set the parameter for `?`
st.setString(1, studentnumber);  // Add this code in between..
ResultSet rs = st.executeQuery(); 
```

实际上这不是一种方法..那是`Constructor`您正在使用的方法..而且您将其用于错误的目的..

从技术上讲，构造函数的唯一目的是初始化正在创建的对象的属性，或者初始化环境以供使用。

对于使用`database query`或执行任何其他类型的任务，您应该使用一个方法，并调用它..

# jquery - 激活多个 Twitter 引导折叠元素

> ID：12772081
> 
> 赞同：1
> 
> 时间：2012-10-07T19:26:47.790
> 
> 标签：jquery, tabs, twitter-bootstrap, collapse

我对 JQuery 比较陌生，所以如果这个问题看起来微不足道，请原谅。我有一个页面，如下面的 HTML 所述，其中包含三个选项卡元素，每个选项卡元素中可能包含未指定数量的可折叠元素。我正在使用一个名为'groupings'的python字典从服务器传递数据，它的结构如下：

```
groupings = {tab1: [[group, [(key, value), ...]], ...], ...} 
```

我使用 Twitter Bootstrap 作为前端框架，使用 Jinja2 作为模板引擎，后端使用 Python 2.7。我无法使用以下代码来激活可折叠元素。我猜想需要一些与 Bootstrap 文档中介绍的不同的 JQuery。我已经尝试了那里列出的激活函数的各种排列，但是因为我还不是很精通 JQuery 的使用，所以没有成功。这样做的任何帮助将不胜感激。

```
 <section id="tabs">
        <div class="page-header">
          <h1>Togglable tabs <small>bootstrap-tab.js</small></h1>
        </div>
        <div class="row">
          <div class="span9 columns">
            <ul id="myTab" class="nav nav-tabs">
              <li class="active"><a href="#tab1" data-toggle="tab">tab1 title</a></li> 
              <li><a href="#tab2" data-toggle="tab">tab2 title</a></li> 
              <li><a href="#tab3" data-toggle="tab">tab3 title</a></li> 
            </ul>
          <div id="myTabContent" class="tab-content">
          {% for category in ['tab1', 'tab2', 'tab3'] %}
            {% if category == 'tab1' %}
              <div class="tab-pane fade in active" id="{{category}}">  
            {% else %}
              <div class="tab-pane fade" id="{{category}}">  
            {% endif %}
                <div class="span8">
                  <div class="accordion" id="accordion2">
                    {% for group in groupings[category] %}
                    <div class="accordion-group">
                      <div class="accordion-heading">
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#{{group[0]}}">
                          {{group[0]}}
                        </a>
                      </div>
                      <div id="{{group[0]}}" class="accordion-body collapse in">
                        <div class="accordion-inner">
                          {% for key, value in group[1] %}
                            <dl class="dl-horizontal">
                              <dt>{{key}}:</dt>
                              <dd>{{value}}</dd>
                            </dl>
                          {% endfor %}
                        </div>
                      </div>  <!-- .accordion body collapse in -->
                    </div>
                  {% endfor %}
                </div>       <!--  .accordion -->                
              </div>   
            </div>
            {% endfor %}
          </div>    <!-- .tab content -->
        </div>
      </div>   <!-- row -->
    </section>   <!-- tabs --> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T21:09:17.043

标准`$('.collapse').collapse();`折叠激活将适用于您的情况，但您已经在使用`data-toggle="collapse"`. 你不应该同时使用两者。

正如在[这个演示 (jsfiddle)](http://jsfiddle.net/Sherbrow/gqEDm/)中看到的，它可以工作。

有一件事可能会导致意外行为：手风琴 ID 不是唯一的。循环中的任何 ID 元素都应该是唯一的：

```
<div class="accordion" id="accordion_{{category}}">
  <!-- ... -->
    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_{{category}}" href="#{{group[0]}}">...</a>
  <!-- ... -->
</div> 
```

# java - 如何让 ace 编辑器为协作工作工作

> ID：12772082
> 
> 赞同：0
> 
> 时间：2012-10-07T19:26:51.920
> 
> 标签：java, servlets, ace-editor

我正在做我的学术项目。它现在被称为 Cloud-IDE 我正处于初始阶段，我正在制作一个 Web 应用程序，它将接受来自用户的代码，编译它并且输出将在浏览器中显示给用户。现在假设有多个人在远程处理相同的代码，我如何提供一个文档（包含代码）之类的东西，它将显示给所有人。任何人都可以为它做出贡献，或者至少可以实时查看更改。

我正在将 ace-editor 用于代码编辑器，有什么方法可以提供协作工作。

服务器端：java servlet 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T01:09:52.993

您可以使用[Firebase](http://www.firebase.com)。

[Scratchpad](http://scratchpad.io)使用这种技术。

# php - “PHP 通知：未定义的属性”

> ID：12772083
> 
> 赞同：7
> 
> 时间：2012-10-07T19:27:00.883
> 
> 标签：php

我收到了这个奇怪的错误。你会说：“为什么奇怪？你只是没有这样的属性”。不，问题是*有财产*。

我得到了一个错误。

```
// PHP Notice:  Undefined property: stdClass::$roles in
$canWrite = $this->session->isLoggedIn() ? $this->page->canWrite($this->session->user->roles) : false; 
```

这是课堂。

```
class User {
    protected $roles;

    function getRoles() {
        if (!$this->roles)
        {
            // Get them!
        }

        return $this->roles;
    }
} 
```

因此，当我尝试访问此行中的属性时，将调用*此方法。*一切正常，但我不想增加我的错误日志。发生了什么？

# UPD1

`$this->user->session`是一个`User`对象

```
function getUser() {
    if (!$this->user) {
        $u = new User();
                    // Logic
        $this->user = $u;
    }
    return $this->user;
} 
```

```
User Object
(
    [roleId:protected] => 1
    [roles:protected] => Array
        (
            [root] => Role Object
                (
                    [id:protected] => 1
                    [hrefname:protected] => root
                )

        )
) 
```

# UPD2

所有属性都可以通过魔法访问`__get()`

```
public function __get($var) {
    if ($this->__isset($var)) {
        $method = 'get'.ucfirst($var);
        if (method_exists($this, $method)) {
            return $this->$method();
        } else {
            return $this->$var;
        }
    }
    throw new Exception("Unrecognized attribute '$name'");
} 
```

# UPD3

`var_dump($this->session->user)`

```
object(User)#370 (30) {
  ["roles":protected]=>
  array(1) {
    ["root"]=>
    object(Role)#372 (2) {
      ["id":protected]=>
      string(1) "1"
      ["hrefname":protected]=>
      string(4) "root"
    }
  }
} 
```

# 解释

在一个地方，我不小心写在尚未创建`$this->session->user->id = $user->id`的地方。原来`$this->session->user`如此。好吧，*谢谢你，PHP*。`null->id``(new stdClass())->id`

 ** * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T19:35:29.210

因为它说未定义的属性是 in `stdClass`，这意味着有问题的对象实际上不是`User`您认为的类。

这通常意味着创建对象时出现了问题。因此，导致此错误的代码中的实际错误在程序中比您给我们的代码行更早。

查找创建对象的位置。这就是问题所在。

如果没有看到其余的代码，我无法提供比这更多的帮助，但希望能有所帮助。

**[编辑]**

引发错误的对象是`$this->session->user`（这是您尝试访问其`->roles`属性的对象）。

尽管您想说它绝对是一个`User`对象，但事实是 PHP 另有说明。在错误之前立即执行`var_dump($this->session->user)`，您应该能够看到我在说什么。

至于为什么不是你所期望的，我仍然无法给出更好的答案。使用像[xDebug](http://xdebug.org/)这样的调试器一次一行地跟踪程序可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T19:33:51.803

显而易见的解释是该属性已定义，但受到保护。这意味着它只能被这个类和扩展类访问。

但是，错误消息确实暗示了其他一些错误。该类是一个`User`类，但错误表明它是`stdClass`.*

# android - Gcm phone_registration_error

> ID：12772086
> 
> 赞同：3
> 
> 时间：2012-10-07T19:27:06.673
> 
> 标签：android, google-cloud-messaging

我正在尝试设置一个与 gcm 一起使用的应用程序，但每次根据 Gcm 文档收到 phone_registration_error 错误时，此错误意味着：

```
Incorrect phone registration with Google. 
This phone doesn't currently support GCM. 
```

但我不明白为什么我的它不受支持，我在一个真正的 android 设备和一个带有 google api 的模拟器上测试了这个

我的主要活动：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    checkNotNull(SENDER_ID, "SENDER_ID");

    GCMRegistrar.checkDevice(this);
    GCMRegistrar.checkManifest(this);

    final String regId = GCMRegistrar.getRegistrationId(this);
    Log.i(TAG,  "registration id =====  "+regId);
    if(regId.equals("")){
        GCMRegistrar.register(this, SENDER_ID);

    } else {
        Log.v(TAG, "Already Registred");
    }

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

} 
```

我的清单：

[pastebin 上的清单](http://pastebin.com/vqfDYSvC)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-03T07:04:48.080

我遇到了同样的问题，在互联网上搜索了很多天后，我在谷歌群组（[https://groups.google.com/forum/#!topic/cerberus-support-forum/eJxOsYqkTxo](https://groups.google.com/forum/#!topic/cerberus-support-forum/eJxOsYqkTxo)）中注意到了这一点并尝试了它并它对我来说完美无缺。

您的 Google 帐户有问题。请试试这个：

*   转到设置 -> 应用程序 -> 管理应用程序 -> 全部

或者

转到设置-> 应用程序-> 全部（在较新版本上）

*   为“Google Play 服务”和“Google 服务框架”选择“清除数据”
*   重启手机

然后从您的应用中检查 GCM id。

如果它仍然不起作用，请从手机中删除您的所有谷歌帐户并重新启动手机并再次添加该帐户。

它对我有用（在实施了我通过搜索互联网获得的许多解决方案之后。）

希望能帮助到你！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T09:58:59.703

GCM 仅适用于运行 android 2.2 或更新版本的设备。此外，GCM 仅在为设备安装了 google 帐户时才有效。这也是 google 建议`<uses-permission android:name="android.permission.GET_ACCOUNTS" />`在清单中使用的原因，因此您可以确定设备具有 google 帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-30T08:59:44.297

我查看了您的清单，但您忘记传递 GooglePlay 服务元数据。

1.  验证您是否已将 GooglePlay 服务库链接到您的项目

2.  尝试将此添加到您的

`<meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version"/>`

它对我很有效。

然后重新编译并重试。希望能帮助到你。

# linux - 为什么在linux命令（iostat）中每秒读取（r / s）一直为零？

> ID：12772088
> 
> 赞同：5
> 
> 时间：2012-10-07T19:27:14.093
> 
> 标签：linux, bash, profiling, iostat

我运行一个 java 代码，它产生大量的读写文本文件。程序源代码非常简单，在一个循环中，我在一个测试文件中写入了 2000 行，然后我再次读取它们，只是为了生成大量的磁盘读写操作。但是当程序运行时，我通过“iostat -d -x 1”**监控磁盘**，我发现**第二个“r/s”的读取没有变化，但“w/s”按我的预期增加了！！！** 这是 iostat 命令的示例输出：

```
Device: rrqm/s wrqm/s  r/s   w/s    rsec/s wsec/s   avgrq-sz avgqu-sz await svctm  %util
sda     0.00   913.00  0.00  82.00  0.00   7872.00   96.00    0.58    7.09   7.11  58.30

Device: rrqm/s wrqm/s  r/s   w/s   rsec/s  wsec/s  avgrq-sz  avgqu-sz  await  svctm  %util
sda     0.00   869.00  0.00  79.00  0.00   7584.00    96.00   0.57    7.11   7.18  56.70

Device: rrqm/s wrqm/s  r/s   w/s   rsec/s  wsec/s  avgrq-sz avgqu-sz   await  svctm  %util
sda     0.00   847.00  0.00  77.00  0.00   7392.00   96.00   0.57      7.42   7.43  57.20

Device: rrqm/s wrqm/s  r/s   w/s   rsec/s  wsec/s   avgrq-sz avgqu-sz  await  svctm  %util
sda     0.00  1221.00  0.00  113.00  0.00  10760.00  95.22    0.84     7.47   7.32  82.70 
```

如图所示，所有“r/s”都为零！但是在Java程序中，我读的和我写的一样多？！当我运行 Java 代码时，每秒写入次数增加，但“r/s”没有变化！这是我在监控磁盘时运行的 java 代码：

```
import java.io.*;

public class Test {

    public static void main(String [] args) throws IOException{

    String fileName = "/scratch/dump_file.txt";
    File f = new File(fileName);
    // Attempt to delete it
    boolean success = f.delete();
    int j=0;
    while(j<20000)
    {
        ++j;
        Writer output = null;
        String text = "A test content";
        File file = new File(fileName);
        output = new BufferedWriter(new FileWriter(file));

        int i=1;
        while(i<2000)
        {
            //Here we start writing 2000 lines into file line by line
            output.write("j==="+Integer.toString(j)+text+Integer.toString(i)+"\n");
            ++i;
        }
        output.close();
        System.out.println("Your file has been written");  

        String line = null;
        try {
            // FileReader reads text files in the default encoding.
            FileReader fileReader = new FileReader(fileName);
            BufferedReader bufferedReader = 
            new BufferedReader(fileReader);
            i=1;
            while((line = bufferedReader.readLine()) != null) {
                //Here we start reading from file line by line and show the result on screen
                ++i;
                System.out.println(line);
            }   
            // Always close file
            bufferedReader.close();         
        }
        catch(FileNotFoundException ex) {
            System.out.println(
                "Unable to open file '" + 
                fileName + "'");                
        }
        catch(IOException ex) {
            System.out.println(
                "Error reading file '" 
                + fileName + "'");                  
            // Or we could just do this: 
            // ex.printStackTrace();
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T19:30:24.783

最有可能的是，操作系统正在将文件缓存在 RAM 中。由于它已经缓存在内存中，当您在 Java 中读取时，操作系统不需要实际从磁盘读取 - 它只是为您提供它已经缓存的副本。这比实际从磁盘读取要快得多；但是请注意，由于`iostat`只报告*实际*的磁盘读取和写入，因此您的缓存读取不会显示在那里。

# internet-explorer - 基于 IE 问题的 href

> ID：12772092
> 
> 赞同：1
> 
> 时间：2012-10-07T19:27:20.957
> 
> 标签：internet-explorer, href, base

我使用`<base href="/">`mod_rewrite 使我的网站正常运行，它在除 Internet Explorer 之外的所有浏览器上都能完美运行。没有加载 css 样式和 javascripts。我该如何处理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T19:37:33.810

我不知道这是否会解决您的问题，但`base`标签应该包含绝对路径，您指定的是相对路径。

绝对路径类似于：

```
<base href="http://example.com/" /> 
```

来自[http://www.w3.org/TR/html4/struct/links.html#h-12.4](http://www.w3.org/TR/html4/struct/links.html#h-12.4)

这些其他问题可能会对您有所帮助：

*   [我们应该使用 <base href="" /> 吗？](https://stackoverflow.com/questions/4362258/should-we-use-base-href)
*   [在 IE9 中忽略基本 href](https://stackoverflow.com/questions/10758366/base-href-ignored-in-ie9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T07:04:02.853

正如 Nathan 所说 - 使用 IE 的绝对路径是必要的（不知道为什么，但它的行为与其他浏览器不同..惊喜惊喜..）

您甚至可能会发现以下链接很有帮助： http://notes.minty.org/cgi-bin/wiki.pl? [Fixing_Base_Href_Javascript_Document.Location_For_Internet_Explorer](http://notes.minty.org/cgi-bin/wiki.pl?Fixing_Base_Href_Javascript_Document.Location_For_Internet_Explorer)

# objective-c - iOS NSDateFormatter 时区

> ID：12772095
> 
> 赞同：1
> 
> 时间：2012-10-07T19:27:42.810
> 
> 标签：objective-c, ios, xcode, nsdate, nsdateformatter

我有一些代码需要一个字符串，将其转换为日期，重新格式化，然后将其作为另一个字符串吐出：

```
[formatter setDateFormat:@"YYYY'-'MM'-'DD','HH:mm:ss','ZZZ"];
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"America/New_York"]];
NSDate *date = [formatter dateFromString:combinedString];
[formatter setDateStyle:NSDateFormatterLongStyle];
NSString *finishedString = [formatter stringFromDate:date]; 
```

基本上，除了时区外，它工作正常。所有输入字符串都在时区 -0400 中，我希望重新格式化的字符串也处于该时区，但重新格式化的字符串会继续向前转换 4 小时，即使在我添加了该`setTimeZone:`行之后也是如此。基本上，我根本不想改变时间，我只想重新格式化它，我不明白我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:50:14.707

这取决于日期来源指定的格式。大多数时候我处理[Unix/POSIX](http://en.wikipedia.org/wiki/Unix_time)格式的日期。然后我使用以下两行代码：

```
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]];
[formatter setLocale:[[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"] autorelease]]; 
```

无论如何，我建议您查看 Apple Developers 网站的以下问答：http: [//developer.apple.com/library/ios/#qa/qa1480/_index.html](http://developer.apple.com/library/ios/#qa/qa1480/_index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T16:54:13.580

在**斯威夫特**：

```
 // Formatter configuration
    let formatter: NSDateFormatter = NSDateFormatter()
    let posix: NSLocale = NSLocale(localeIdentifier: "en_US_POSIX")
    formatter.locale = posix
    formatter.dateFormat = "d.M.y"
    formatter.timeZone = NSTimeZone(name: "UTC")!

    // String to date
    let dateString: String = "1.1.2013"
    let defaultDate: NSDate = formatter.dateFromString(dateString)!
    println("defaultDate: \(defaultDate)")

    self.dateOfBirthUIDatePicker.date = defaultDate 
```

# c# - 如何在 c# 中在 asp.net 中播放视频文件？

> ID：12772096
> 
> 赞同：0
> 
> 时间：2012-10-07T19:27:43.967
> 
> 标签：c#, asp.net, html, visual-studio-2010, video

[例如](http://www.youtube.com)，我想播放没有任何安装插件的视频文件。文件扩展名包括 .mov、.flv、.avi 或其他。我怎样才能播放视频文件，但我不会用户必须安装 Flash 播放器，以及如何在 C# 中的 Asp.net 中播放 mp3 文件？我安装了 Visual Studio 2010 Ultimate。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T19:37:51.890

你有两个选择：

*   HTML5 视频

    > ```
    >  <video src="movie.avi" controls>
    >      <!-- The msg if browser doesn't have HTML5 video support -->
    >   </video> 
    > ```

*   `<object>`适用于 Windows 媒体播放器/QuickTime 等。

第一个选项可以让您很好地嵌入视频，但会限制用户群（不到一半的浏览器支持 HTML 5）。第二个选项强制用户下载应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:50:04.090

这就是你想要的：[使用 C# 在 asp.net 中播放视频](http://lesson8.blogspot.com/2012/03/html5-video-player-aspnet-c.html)

# ruby-on-rails - 在 Rails 应用程序中使用 watir-webdriver 的多个无头 Firefox 实例

> ID：12772101
> 
> 赞同：0
> 
> 时间：2012-10-07T19:28:04.593
> 
> 标签：ruby-on-rails, watir, headless, xvfb

我有一个简单的 Rails 应用程序，用于**抓取**网页。控制器调用**刮板**实用程序，我在其中使用 watir-webdriver 在无头模式下使用 firefox。该应用程序正常工作并返回结果。我调用应用程序的方式是这样的：

[http://somedomain.com:3000/scrapers.json?session=1349426645_562&l=test](http://somedomain.com:3000/scrapers.json?session=1349426645_562&l=test)

它返回一个 json 字符串。

**刮板**完成大约需要 15 秒。当一个请求正在进行时，当我尝试启动另一个请求时，该请求会排队等待前一个请求完成。我不确定它是对 Rails 应用程序端还是对使用 Xvfb 的 watir-webdriver 或无头 gem 的限制。

任何指针都会有所帮助。

谢谢， 斯里达尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:08:35.467

有更好的屏幕抓取库，例如机械化。事实上，有一些应用程序只是为了抓取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T14:16:46.443

我发现我可以使用 CGI 模块来完成我的工作。由于我不需要 Rails 应用程序，所以我使用 ruby​​ CGI 调用 ruby​​ 脚本并通过 URL 传递参数。我还可以使用这种方法以非阻塞方式启动多个实例。为了做到这一点，我不得不将我的控制器重新编写为一个独立的 ruby​​ 程序。

# c - 如何将 OpenSSL SHA-512 哈希转换为 GMP 编号以用于 RSA 加密方法

> ID：12772102
> 
> 赞同：0
> 
> 时间：2012-10-07T19:28:09.293
> 
> 标签：c, rsa, gmp, sha512

```
SHA1(data, length, hash);
unsigned char *labelPtr;

labelPtr = hash;
mpz_set_str (encrypted, labelPtr, 16);
gmp_printf("hashed= %Zd\n", encrypted); 
```

`encrypted`等于0？我需要从此哈希中获取一个整数，以便执行 RSA 加密。我在调试时看到了哈希，但似乎无法将其转换为`int`. 它是 SHA-512 所以 512 位？奇怪的字符也`printf("%s",hash);` `atoi`给出了 0，我是否必须按字符分解散列？我认为那会奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:42:01.027

`mpz_set_str`第二个参数必须是字符串。

`hash`您传递给函数的参数`SHA1`可能不是字符串。在将其传递给`mpz_set_str`函数之前将其转换为字符串格式。

# c++ - 对（函数）c ++的未定义引用

> ID：12772103
> 
> 赞同：11
> 
> 时间：2012-10-07T19:28:11.313
> 
> 标签：c++, function, reference, header, undefined

> **可能重复：**
> [未定义的引用](https://stackoverflow.com/questions/5293021/undefined-reference-to)

我已经对这一组错误消息猛烈抨击了大约 4 个小时，但我似乎无法弄清楚。我以前没有在这里发帖，所以如果它不在正确的区域或者我做错了什么，我提前道歉。无论如何，我收到的错误消息是：

```
main.cpp|28|undefined reference to `LinkedSortedList<Employee>::LinkedSortedList()'|
   main.cpp|52|undefined reference to `empPrint(LinkedSortedList<Employee>&)'|
   main.cpp|58|undefined reference to `empSave(LinkedSortedList<Employee>&, std::string)'|
   main.cpp|65|undefined reference to `empLoad(LinkedSortedList<Employee>&, std::string)'|
   main.cpp|70|undefined reference to `LinkedSortedList<Employee>::~LinkedSortedList()'|
   main.cpp|70|undefined reference to `LinkedSortedList<Employee>::~LinkedSortedList()'|

   obj\Debug\main.o||In function `Z9empSearchR16LinkedSortedListI8EmployeeE':|
   main.cpp|109|undefined reference to `LinkedSortedList<Employee>::getHead()'| 
```

我的 main.cpp 如下：

```
#include <iostream>
#include <string>
#include <stdio.h>
#include <fstream>
#include "SortedList.h"
#include "LinkedSortedList.h"
#include "Employee.h"
#include "LinkedNode.h"

using namespace std;

void newEmp(LinkedSortedList <Employee>& empList);
void empSearch(LinkedSortedList <Employee>& empList);
void empPrint(LinkedSortedList <Employee>& empList);
void empSave(LinkedSortedList <Employee>& empList, string file);
void empLoad(LinkedSortedList <Employee>& empList, string file);

int main()
{
    //int empID;
    bool menuFinish = false;
    LinkedSortedList<Employee> empList;
    char selection;

    while (!menuFinish)

        //simple menu system through cout, the selection is read in through cin
        //and converted to upper case for simplicity during the conditionals
        cout << "Menu" << endl;
        cout << "(I)nsert new record" << endl;
        cout << "(E)mployee ID search" << endl;
        cout << "(P)rint employee info" << endl;
        cout << "(S)ave database to a file" << endl;
        cout << "(L)oad database from file" << endl;
        cout << "(Q)uit" << endl;
        cout << "Enter selection " << endl;
        cin >> selection;
        selection = toupper(selection);

        //menu selections are compared with their functions
        if (selection == 'I')
            newEmp(empList);
        else if (selection == 'E')
            empSearch(empList);
        else if (selection == 'P')
            empPrint(empList);
        else if (selection == 'S')
            {
                string fileName;
                cout << "Enter a filename to save the database to " << endl;
                cin >> fileName;
                empSave(empList, fileName);
            }
        else if (selection == 'L')
            {
                string fileName;
                cout << "Enter the filename to load the database from " << endl;
                cin >> fileName;
                empLoad(empList, fileName);
            }
        else if (selection == 'Q')
            menuFinish = true;
        else
            cout << "Incorrect choice " << endl;
}

//function creates a new employee
void newEmp(LinkedSortedList <Employee>& empList)
{
    string firstName;
    string lastName;
    int empID = -1;

    cout << "Please enter the first name " << endl;
    cin >> firstName;
    cout << "Please enter the last name " << endl;
    cin >> lastName;
    while (empID > 9999999 || empID < 0)
        {
        cout <<"Please enter the employee ID " << endl;
        cin >> empID;

        }
    //puts the employee in the db unless they're already found, then outputs an
    //error on the screen
    Employee emp(firstName, lastName, empID);
    bool findEmp = empList.find(emp);

    if (!findEmp)
        empList.insert(emp);
    else
        cout << "Emlpoyee ID " << empID << " already in use " << endl;
}

//function to search for an employee based on their employee ID
void empSearch (LinkedSortedList <Employee>& empList)
{
    int empID;
    int sizeOfList = 0;
    bool noEmp = true;

    cout << "Enter employee ID " << endl;
    cin >> empID;

    LinkedNode <Employee>* temp = empList.getHead();
    while (sizeOfList < empList.size() && noEmp)
    {
        sizeOfList++;
        if (empID == temp->value.getEmpID())
            {
                cout << "Searched " << sizeOfList << "employees " << endl;
                cout << "Found record: " << temp->value;
                noEmp = false;
            }
            temp = temp->next;
    }
    if (noEmp)
    cout << "Search of " << sizeOfList << " employees.  Employee not found" << endl;

}

//function used to print the first and last five employees from the db
void empPrint (LinkedSortedList <Employee>& empList)
{
    if (empList.size() <= 10)
        {
            empList.print();
        }

        else
        {
            LinkedNode<Employee>* temp = empList.getHead();
            cout << "First five employees: " << endl;

            for (int i = 0; i < 5; i++)
                {
                cout << temp->value << endl;
                i++;
                temp = temp->next;
                }

            int midList = empList.size()-5;
            for (int i = 0; i < midList; i++)
                {
                     temp = temp->next;
                }

            cout << "Last five employees: " << endl;
            for (int i = 0; i < 5; i++)
                {
                    cout << temp->value << endl;
                    i++;
                    temp = temp->next;
                }
        }
}

//function used to save the employee information from the db to a file
void empSave(LinkedSortedList<Employee>& empList, string fileName)
{
    string lastName;
    string firstName;
    //int empID;
    ofstream output;
    output.open(fileName.c_str());
    if (!output)
        {
            cout << "File not saved" << endl;
        }
    else
    {
        LinkedNode<Employee>* temp = empList.getHead();
        int i = 0;
        while (i < empList.size())
        {
            output << temp->value.getLastName() << " " << temp->value.getFirstName() << " " << temp->value.getEmpID() << endl;
            i++;
            temp = temp->next;
        }
    }
    output.close();
}

//function used to load the employee information from a file to the db
void empLoad(LinkedSortedList<Employee>& empList, string fileName)
{
    if (empList.size() > 0)
    {
        empList.clear();
    }

    ifstream input;
    input.open(fileName.c_str());

    if (!input)
    {
        cout << "No file exists" << endl;
    }

    else
    {
        int empID;
        string firstName;
        string lastName;
        string delimiter;

        while(input.good());
        {
            getline(input, delimiter, '\n');
            getline(input, lastName, ' ');
            getline(input, firstName, ' ');
            input >> empID;

            Employee emp(lastName, firstName, empID);

            bool empFound = empList.find(emp);

            if(!empFound)
            {
                empList.insert(emp);
            }
            else
            cout << "Employee already exists" << endl;
        }
    }
} 
```

我的 LinkedSortList.cpp 是：

```
#ifndef _LinkedSortedList_
#define _LinkedSortedList_

#include "Employee.h"
#include "LinkedSortedList.h"
#include "SortedList.h"
#include "LinkedNode.h"

#include <iostream>
#include <fstream>
#include <string>

using namespace std;

//default constructor
//sets head to null and makes the size of the list 0
template <class Elem>
LinkedSortedList<Elem>::LinkedSortedList()
{
    head = NULL;
    listSize = 0;
}

//destructor, clears list THEN deletes the head so memory leaks are
//stopped
template <class Elem>
LinkedSortedList<Elem>::~LinkedSortedList()
{
    clear();
    delete head;
}

//clears the list, freeing memory and stopping leaks and resets the
//list size
template <class Elem>
void LinkedSortedList<Elem>::clear()
{
    LinkedNode<Elem> *indexPtr = head;

    while (head != NULL)
    {
        head = head->next;
        delete indexPtr;
        indexPtr = head;
    }
    listSize = 0;
}

//finds a search value in the list... if it finds it then it returns true,
//otherwise it returns false
template <class Elem>
bool LinkedSortedList<Elem>::find(Elem searchValue) const
{
    LinkedNode<Elem>* indexPtr = head;
    while (indexPtr != NULL)
    {
        if (indexPtr->value == searchValue)
        {
            return true;
        }
        indexPtr = indexPtr->next;

    }
    return false;
}

//gets and DELETES first value in the list - if it finds nothing then
//return false, otherwise true
template <class Elem>
bool LinkedSortedList<Elem>::getFirst(Elem &returnValue)
{
    LinkedNode<Elem>* indexPtr = head;
    if (indexPtr == NULL)
        return false;
        else
        {
            head = head->next;
            returnValue = indexPtr->value;
            delete indexPtr;
            listSize--;
            return true;
        }
        returnValue = indexPtr->value;
}

//prints the list to cout or prints a warning if the list contains
//no values
template <class Elem>
void LinkedSortedList<Elem>::print() const
{

    if (head == NULL)
    {
         cout << "No elements in the list" << endl;
    }
        else
        {
            LinkedNode<Elem>* indexPtr = head;
            while (indexPtr != NULL)
            {
                cout << indexPtr->value << endl;
                indexPtr = indexPtr->next;
            }
        }
}

//returns the size of the list to the caller
template <class Elem>
int LinkedSortedList<Elem>::size() const
{
    return listSize;
}

//inserts a value into the list where it should go, if the list is empty it will
//say there are no existing nodes
template <class Elem>
bool LinkedSortedList<Elem>::insert(Elem newValue)
{
    LinkedNode<Elem>* indexPtr = head;
    LinkedNode<Elem>* newNode;
    //newNode->value = newValue;

     try
    {
        newNode = new LinkedNode<Elem>(newValue);
    }
    catch(exception e)
    {
        cout<<"Exception reached: " << e.what() << endl;
        return false;
    }

    //checks to see if the list is empty, if it is then it makes the newNode
    //the head
    if (head == NULL)
        {
            cout << "No existing nodes" << endl;
            head = newNode;
            cout << "First node is now " << head->value << endl;
            listSize++;
            return true;
        }

        /*looks to see if the value of the newNode is less than or equal to the
        index, if it is then it sets the point of the newNode equal to the head
        then makes the head the newNode and increments the listSize by one to keep
        track of the size of the list and returns true*/
        else if (newNode->value <= head->value)
        {
            newNode->next = head;
            head = newNode;
            listSize++;
            return true;
        }

        /*if the newNode value is greater than the index, then:*/
        else
        {
            while(indexPtr->next != NULL && newNode->value > indexPtr->next->value)
                {
                    indexPtr = indexPtr->next;
                }

            if (indexPtr->next == NULL)
            {
                indexPtr->next = newNode;
                listSize++;
                return true;
            }
            else
            {
                newNode->next = indexPtr->next;
                indexPtr->next = newNode;
                listSize++;
                return true;
            }

        }
}
//added for project 2 to return the head of the LL
template <class Elem>
LinkedNode<Elem>* LinkedSortedList<Elem>::getHead()
{
    return head;
}

#endif 
```

Employee.cpp 是：

```
#ifndef _Employee_
#define _Employee_

#include "Employee.h"
#include "LinkedSortedList.h"
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

//blank default constructor
Employee::Employee()
{
}

//constructor that takes 3 parameters and sets them
Employee::Employee(string lastName, string firstName, int eID)
{
    this->lastName = lastName;
    this->firstName = firstName;
    this->empID = eID;
}

//blank deconstructor
Employee::~Employee()
{
}

//overloaded equality operator
bool Employee::operator==(Employee &nextEmployee)
{
    if (this->empID == nextEmployee.empID)
            return true;
        else
            return false;
}

//overloaded less than or equal to operator
bool Employee::operator <= (Employee &nextEmployee)
{
    if (this->empID <= nextEmployee.empID)
            return true;
        else
            return false;
}

//overloaded greater than or equal to operator
bool Employee::operator >= (Employee &nextEmployee)
{
    if (this->empID >= nextEmployee.empID)
            return true;
        else
            return false;
}

//overloaded less than operator
bool Employee::operator < (Employee &nextEmployee)
{
    if (this->empID < nextEmployee.empID)
            return true;
        else
            return false;
}

//overloaded greater than operator
bool Employee::operator > (Employee &nextEmployee)
{
    if (this->empID > nextEmployee.empID)
            return true;
        else
            return false;
}

// overloaded output stream operator
ostream& operator<<(ostream& os, const Employee empl)
{
    os << "Last: " << empl.lastName << endl;
    os << "First: " << empl.firstName << endl;
    os << "Employee ID: " << empl.empID << endl;
    return os;
}

#endif 
```

我的头文件 LinkedSortedList.h：

```
#ifndef _LinkedSortedListClass_
#define _LinkedSortedListClass_

#include "SortedList.h"
#include "LinkedNode.h"

#include <iostream>
#include <fstream>
#include <string>

//using namespace std;

template <class Elem>
class LinkedSortedList : public SortedList< Elem >
{
public:
    LinkedSortedList();
    ~LinkedSortedList();
    virtual void clear();
    virtual bool insert(Elem newValue);
    virtual bool getFirst(Elem &returnValue);
    virtual void print() const;
    virtual bool find(Elem searchValue) const;
    virtual int size() const;
    LinkedNode<Elem>* getHead(); //added for project 2

private:
    LinkedNode<Elem>* head;
    int listSize;
};
#endif 
```

最后（哇！）我的 Employee.h 在这里：

```
#ifndef _EmployeeClass_
#define _EmployeeClass_

#include <iostream>
#include <fstream>
#include <string>

using namespace std;

class Employee
{
    public:
        Employee();
        ~Employee();
        Employee(string, string, int);
        bool operator == (Employee& nextEmployee);
        bool operator <= (Employee &nextEmployee);
        bool operator >= (Employee &nextEmployee);
        bool operator < (Employee &nextEmployee);
        bool operator > (Employee &nextEmployee);
        friend ostream& operator<<(ostream& os, const Employee empl);
        string getLastName(){return lastName;}
        string getFirstName(){return firstName;}
        int getEmpID(){return empID;}
    private:
        string lastName;
        string firstName;
        int empID;
};

#endif 
```

我只是没有看到这里的问题，我已经和我的助教、帮助室工作人员和其他学生谈过了。我还没有收到教授的回复，但我怀疑这个周末我会不会收到她的来信。非常感谢您提供的任何见解。我需要一些泰诺。-乔什

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-07T19:31:33.597

你是如何编译你的代码的？如果您使用的是 Microsoft Visual C++ 等 IDE，请务必创建一个项目并将所有 .cpp 文件（而不是 .h 文件）添加到其中。如果您使用的是命令行，请务必将所有文件名包含为命令行参数。如果这仍然没有帮助。请包括对您用于编译程序的步骤的描述。

**编辑：**

您的代码有几个问题：

1.  `#ifndef ... #define...`包含警卫适用于将出现`#include`在其他文件的指令中的文件。通常这些只是`.h`文件，因为强烈建议不要使用`#include` `.cpp`文件。

2.  使用模板的类必须都在一个 .h 文件中，而不是分成一个`.h`and`.cpp`文件。（阅读：如果我说得不够清楚，您的`LinkedSortedList`课程必须全部在一个 .h 文件中。）

3.  您的`main.cpp`文件声明了几个以后没有定义的函数。如果您还不想花时间实现这些功能，您至少需要为它们添加空存根。

4.  请务必使用 IDE 中的项目或使用正确的命令行参数来编译和链接所有源文件。这就是我在上面的原始答案中所描述的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-07T19:32:09.010

为了让模板自动实例化，编译器需要在使用时查看定义。如果您不想使模板定义可见，则需要使用显式实例化。经常回答如何做这些中的任何一个。

顺便说一句，请不要使用为 C++ 编译器及其标准库的实现保留的名称作为包含保护：以下划线后跟大写字母开头的名称在 C++ 实现的所有上下文中都是保留的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T19:34:49.463

> 我的 LinkedSortList.cpp 是...

这就是你大部分问题的根源。做你所做的没有意义。您需要在头文件 LinkedSortedList.h 中定义这些*内联。*这涵盖了您的大部分问题，其他问题，您在哪里定义`empPrint(LinkedSortedList<Employee>&)`？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-07T19:36:03.800

C++ 模板方法和函数在编译器运行到对具有特定类型的函数的调用之前不会转换为机器代码。但这意味着定义模板方法的代码，例如所有的 LinkedSortedList.cpp，实际上在编译器看到它时根本不会产生任何代码。

您需要将所有代码从 LinkedSortedList.cpp 移动到 LinkedSortedList.h（对于其他模板类也是如此），以便编译器可以在调用这些方法时为它们生成代码。例如，当在 main.cpp 中调用 LinkedSortedList::LinkedSortedList() 时，编译器将生成代码，但前提是**它**已经在头文件中看到了此方法的定义。

您的另一个选择是使用“显式实例化”来强制将特定方法的特定版本编译成目标代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-07T19:34:39.933

首先，我看不到这三个的定义：-

```
void empPrint (LinkedSortedList <Employee>& empList);
void empSave (LinkedSortedList <Employee>& empList, string file);
void empLoad (LinkedSortedList <Employee>& empList, string file); 
```

希望实施它们将减少错误。

# sql-server - sql server中的表分区 - 你如何确保它赢得查询的死锁？

> ID：12772109
> 
> 赞同：1
> 
> 时间：2012-10-07T19:29:32.040
> 
> 标签：sql-server, tsql, deadlock, partitioning

我存在的祸根是表分区上的 MERGE 死锁并最终失败。

我尝试将 deadlock_priority 设置为高。

我有预先杀死每个查询表的代码，但有时我仍然在这些毫秒内得到一个查询。

我不知所措。有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T15:44:24.440

您必须使用提示来锁定由合并语句 -xlock,holdlock 使用的对象。我的建议是使用事件死锁图启动 sql Profiler 并尝试使用工具（我使用此[工具](http://www.datamanipulation.net/sqlquerystress/)）重现死锁，然后找出它发生的原因。[将此](https://stackoverflow.com/questions/528303/what-are-common-reasons-for-deadlocks)作为初始信息阅读。

# javascript - 在 D3.js 中舍入日期刻度的最简单方法

> ID：12772110
> 
> 赞同：2
> 
> 时间：2012-10-07T19:29:37.757
> 
> 标签：javascript, d3.js

我在 d3 中有一个日期刻度，我希望将 x.domain()[0] 限制为该月的第一天，并将 x.domain()[1] 限制为该月的最后一天。假设数据集类似于

```
data : [
{date: '2011-12-31', amount: 200},
{date: '2012-01-01', amount: 100},
{date: '2012-01-02', amount: 300},
{date: '2012-01-03', amount: 400},
{date: '2012-02-01', amount: 400}
] 
```

这是一个人为的例子，但基本上在这种情况下，将域限制在 1 月份。寻找一个简单的 d3esque 解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:37:48.150

我认为您正在寻找的是`.nice()`使域以不错的值开始和结束的功能（在您的情况下，是一个月的第一天和最后一个月）。您仍然需要过滤您的数据，我认为在这种情况下自动确定您想要显示 1 月与 12 月或 2 月并没有什么魔力。

```
var data = [
    {date: new Date(2011,11,31), amount: 200},
    {date: new Date(2012,0,1), amount: 100},
    {date: new Date(2012,0,2), amount: 300},
    {date: new Date(2012,0,3), amount: 400},
    {date: new Date(2012,1,1), amount: 400}
];

var month = data.filter(function (d) { return d.date.getMonth() === 0; });

var x = d3.time.scale()
    .domain(d3.extent(month, function(d) { return d.date; }))
    .range([0, width])
    .nice(d3.time.month); 
```

[你可以在http://bl.ocks.org/3849376](http://bl.ocks.org/3849376)看到一个例子。

# asp.net - 带有下拉列表的 ASP.NET C# DetailsView 编辑

> ID：12772117
> 
> 赞同：0
> 
> 时间：2012-10-07T19:30:24.317
> 
> 标签：asp.net

更新了...因为我无法解决问题，并且我可能发布了完整的代码（太多）并且没有人会阅读它...

# xcode - Xcode，为每个视图播放每个声音

> ID：12772125
> 
> 赞同：0
> 
> 时间：2012-10-07T19:31:31.203
> 
> 标签：xcode, image, audio, views

我是 Xcode 和编程的新手。我正在设计一个有多个图像的幼儿应用程序，每个视图一个图像。点击屏幕时，应播放一种声音。滑动到下一页后，会出现另一个带有不同图像的视图。当点击这个新图像时，会播放新的声音。
实现 AVfoundation 套件以便它为每个图像播放一个声音的最佳方法是什么？

提前致谢。

杜安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:41:35.790

查看 UIViews，尤其是如何获取当前视图。所有必要的信息都可以在[这里](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.htm)找到。如果用户从视图中切换，则应该切换到声音。您可以通过实现一个检查视图是否已切换的方法来完成此操作。然后，如果发生这种情况，您可以将声音 ivar 的值切换为不同的值。

# jquery - 在 div 中迭代所有子 div 并获取他们的名字

> ID：12772129
> 
> 赞同：0
> 
> 时间：2012-10-07T19:31:49.057
> 
> 标签：jquery

基本上我想计算除一个之外的所有子 div 高度是我的代码

```
 var allChildDivHeight = 0;
            this.children().each(function (e) {
                //alert($(this).attr('id'));
                if ($(this).attr('id') != 'BlindBox') {
                    allChildDivHeight = allChildDivHeight + $(this).outerHeight();
                }
            }); 
```

我想计算除一个子 div 名称“BlindBox”之外的所有子 div 高度。我的代码不起作用。问题是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T19:39:10.160

如果 this 不是 jQuery 对象，则取决于执行 this 的上下文，您需要选择它。还将孩子限制为仅 div-s：

```
 var allChildDivHeight = 0;
        $(this).children('div').each(function (e) {
            //alert($(this).attr('id'));
            if ($(this).attr('id') != 'BlindBox') {
                allChildDivHeight = allChildDivHeight + $(this).outerHeight();
            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:39:13.940

除了评论中提出的建议外，代码看起来还不错。您是否检查过以确保您是从文档就绪事件中调用它的？如果不是，则在您进行调用时元素不会被渲染。

这是一个例子：

```
$(document).ready(function() {
    // Your code here
}); 
```

但是，这是首选的简写形式：

```
$(function() {
    // Your code here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T19:48:35.360

如果您想计算`div`页面中除“BlindBox”之外的所有高度，请尝试以下操作

```
 var allChildDivHeight = 0;
    $('div').each(function (e) {
        if ($(this).attr('id') != 'BlindBox') {
            allChildDivHeight = allChildDivHeight + $(this).outerHeight();
        }
    }); 
```

# java - 写入文件时代码抛出 java.lang.IndexOutOfBoundsException

> ID：12772134
> 
> 赞同：0
> 
> 时间：2012-10-07T19:32:42.267
> 
> 标签：java, android, apache-httpcomponents

嗨，我正在使用以下代码在 android 的服务器端处理文件上传。我已经用 jsp 对其进行了测试，它按预期工作，但在 android 上它抛出异常 java.lang.IndexOutOfBoundsException: Arguments out of bounds on this line . 刚刚发现小于100 kb的文件正在成功上传。知道可能是什么原因。当文件很大时，它也会随机抛出内存不足异常。

```
fileOut.write(dataBytes, startPos, (endPos - startPos)); 
```

有人可以建议解决这个问题吗？谢谢

相关代码：

```
 String contentType;
        byte[] dataBytes =null ;
        try {
            dataBytes = EntityUtils.toByteArray(entity);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        contentType=String.valueOf(request.getFirstHeader("Content-Type"));
        DataInputStream in=new DataInputStream(new ByteArrayInputStream(dataBytes));
        int formDataLength=dataBytes.length;
        int byteRead = 0;
        int totalBytesRead = 0;
        while (totalBytesRead < formDataLength)
        {
            try {
                byteRead = in.read(dataBytes, totalBytesRead,
                        formDataLength);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            totalBytesRead += byteRead;
        }
        String file = new String(dataBytes);
        String saveFile =file.substring(file.indexOf("filename=\"") + 10);
        saveFile = saveFile.substring(0, saveFile.indexOf("\n"));
        saveFile = saveFile.substring(saveFile.lastIndexOf("\\") + 1,
                saveFile.indexOf("\""));
        int lastIndex = contentType.lastIndexOf("=");
        String boundary = contentType.substring(lastIndex + 1,
                contentType.length());
        int pos=0;
        pos = file.indexOf("filename=\"");
        pos = file.indexOf("\n", pos) + 1;
        pos = file.indexOf("\n", pos) + 1;
        pos = file.indexOf("\n", pos) + 1;

        int boundaryLocation = file.indexOf(boundary, pos) - 4;
        int startPos = ((file.substring(0, pos)).getBytes()).length;
        int endPos = ((file.substring(0,boundaryLocation)).getBytes()).length;

        FileOutputStream fileOut = new
                FileOutputStream("/sdcard/"+saveFile);

        fileOut.write(dataBytes, startPos, (endPos - startPos));//exception thrown here
        fileOut.flush();
        fileOut.close();
        JSONArray ja=new JSONArray();
        JSONObject jo=new JSONObject();
        try{
            jo.put("name", saveFile);
            jo.put("size", formDataLength);
            jo.put("url","ok"); 
            jo.put("thumbnail_url","");
            jo.put("delete_url", "");
            jo.put("delete_type","DELETE");
            ja.put(jo);
        }
        catch(JSONException je){
            je.printStackTrace();
        }
        StringEntity se=new StringEntity(ja.toString());
        response.setEntity(se);
        response.setHeader("Content-Type","application/json");
        response.setStatusCode(HttpStatus.SC_OK); 
```

Logcat index.out of bounds 异常输出：

```
10-07 21:39:11.197: E/AndroidRuntime(897): Uncaught handler: thread Thread-13 exiting due to uncaught exception
10-07 21:39:11.207: E/AndroidRuntime(897): java.lang.IndexOutOfBoundsException: Arguments out of bounds
10-07 21:39:11.207: E/AndroidRuntime(897):  at java.io.FileOutputStream.write(FileOutputStream.java:288)
10-07 21:39:11.207: E/AndroidRuntime(897):  at com.xlnc.webapp.FileListHandler.handle(FileListHandler.java:168)
10-07 21:39:11.207: E/AndroidRuntime(897):  at org.apache.http.protocol.HttpService.doService(HttpService.java:243)
10-07 21:39:11.207: E/AndroidRuntime(897):  at org.apache.http.protocol.HttpService.handleRequest(HttpService.java:187)
10-07 21:39:11.207: E/AndroidRuntime(897):  at com.xlnc.webapp.WebServer$WorkerThread.run(WebServer.java:140) 
```

Logcat 内存不足：

```
 10-07 21:35:36.587: E/AndroidRuntime(867): Uncaught handler: thread Thread-28 exiting due to uncaught exception
10-07 21:35:36.587: E/AndroidRuntime(867): java.lang.OutOfMemoryError
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.CharArrayBuffer.<init>(CharArrayBuffer.java:43)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.ReadWriteCharArrayBuffer.<init>(ReadWriteCharArrayBuffer.java:47)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.BufferFactory.newCharBuffer(BufferFactory.java:84)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.CharBuffer.allocate(CharBuffer.java:57)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.charset.CharsetDecoder.allocateMore(CharsetDecoder.java:293)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:250)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.nio.charset.Charset.decode(Charset.java:768)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.lang.String.<init>(String.java:238)
10-07 21:35:36.587: E/AndroidRuntime(867):  at java.lang.String.<init>(String.java:193)
10-07 21:35:36.587: E/AndroidRuntime(867):  at com.xlnc.webapp.FileListHandler.handle(FileListHandler.java:141)
10-07 21:35:36.587: E/AndroidRuntime(867):  at org.apache.http.protocol.HttpService.doService(HttpService.java:243)
10-07 21:35:36.587: E/AndroidRuntime(867):  at org.apache.http.protocol.HttpService.handleRequest(HttpService.java:187)
10-07 21:35:36.587: E/AndroidRuntime(867):  at com.xlnc.webapp.WebServer$WorkerThread.run(WebServer.java:140) 
```

# c# - 如何在 C# 中测试变量是否属于变量类型？

> ID：12772138
> 
> 赞同：2
> 
> 时间：2012-10-07T19:33:13.857
> 
> 标签：c#, reflection

我想在 C# 中执行以下操作：

```
public bool ValidType(Type type)
{
    return _someVar is type;
} 
```

不过，C# 似乎不支持这种语法；“is”右侧的项目似乎必须是绝对类型名称，而不是对类型的引用。

我发现以下代码似乎有效：

```
return _someVar.GetType().IsInstanceOfType(type) ||
    _someVar.GetType().IsSubclassOf(type) ||
    _SomeVar.GetType().IsAssignableFrom(type); 
```

我不明白做什么`IsAssignableFrom`，除了在某些类型比较中似乎需要它并且似乎`IsInstanceOfType`不能`IsSubclassOf`正确匹配所有情况。

这真的是测试变量的最佳方法是由另一个变量引用的类型，还是我错过了更简单的语法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T19:35:48.460

`IsAssignableFrom`就足够了，不需要其他两个测试，但是您将其称为错误的方式。这是正确的方法：

```
public bool ValidType(Type type)
{
    return type.IsAssignableFrom(_someVar.GetType());
} 
```

> 我不明白 IsAssignableFrom 的作用

实际上，它完全按照名字告诉你的那样做：它测试给定类型的变量是否可以从另一种类型的值中赋值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T19:37:33.917

正如 Konrad 所提到`IsAssignableFrom`的，对于您的测试来说已经足够了。

**确定是否可以从指定类型的实例分配当前类型的实例。**

[http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)

您不需要其他两项检查，因为在这些情况下，`IsAssignableFrom`这也是正确的。

# android - 操作栏，如果单击某个选项卡，如何隐藏操作栏（该选项卡单击的全屏）

> ID：12772140
> 
> 赞同：1
> 
> 时间：2012-10-07T19:33:41.367
> 
> 标签：android, android-actionbar

我正在阅读有关 Android 中的操作栏（它如何具有选项卡）的信息。我的问题是，假设每个标签点击都有它的片段，我怎样才能让最后一个标签（比如第三个标签）占据整个屏幕？我的意思是，如果有人单击 tab3 小部件，而不是仅在操作栏下显示内容，我希望此片段成为全屏（在操作栏屏幕上展开）。

请帮帮我谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T19:40:50.530

使用[`getActionBar().hide()`](http://developer.android.com/reference/android/app/ActionBar.html#hide%28%29)（或者`getSupportActionBar().hide()`如果您使用的是兼容性包）隐藏操作栏。当您切换到第三个选项卡时，您应该调用此方法。

请记住，如果您隐藏操作栏，您也可能会隐藏所有其他导航选项。您可能希望给用户留一些出路。

# asp.net - 缓存、清单文件的 ASP.NET MVC4 路由问题

> ID：12772146
> 
> 赞同：3
> 
> 时间：2012-10-07T19:33:58.363
> 
> 标签：asp.net, asp.net-mvc, routing

我想自动生成 cache.manifest 文件。因此，我创建了一个控制器和一个可由 /OfflineSupport/Manifest 访问的操作。一切正常。内容正确传递。

现在我想在调用 cache.manifest 时注册这个动作。这就是为什么我添加了一条新路线。我的 RegisterRoutes 方法如下所示：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new {controller = "Home", action = "Index", id = UrlParameter.Optional}
    );

    routes.MapRoute("cache.manifest", "cache.manifest", new { controller = "OfflineSupport", action = "Manifest" });
} 
```

我的网站在 localhost:7365/ 下运行。当我调用 localhost:7365/cache.manifest 时，我得到一个 404.0，其中包含以下详细信息：模块：IIS Web Core，消息：MapRequestHandler，处理程序：StaticFile，错误代码：0x80070002。

并且永远不会调用该操作。有什么建议可以更改以获得正确的路由吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T05:40:14.140

可以修改 web.config 以包括：

```
<modules runAllManagedModulesForAllRequests="true"/> 
```

这将允许在路由和非查询字符串定义 ( `?`) 参数中使用句点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:45:47.427

定义的路线的顺序也很重要。

尝试将您的自定义路由移到默认路由声明之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T13:34:53.143

似乎周期是问题所在。每当我映射到包含句点的路由时，ASP.NET MVC 都会尝试查找物理文件。当我删除期间一切正常。所以似乎不可能做我想做的事，我将映射到未来没有一段时间的路线。

# emacs - 使用带有 mediawiki.el 的 Emacs 编辑 MediaWiki 实例时出错

> ID：12772147
> 
> 赞同：1
> 
> 时间：2012-10-07T19:34:14.857
> 
> 标签：emacs, mediawiki

使用带有 mediawiki.el 的 Emacs 编辑 Mediawiki 实例时出现一些错误

软件版本：

操作系统：Mac
Emacs：GNU Emacs 24.2 (x86_64-apple-darwin10.8.0, NS apple-appkit-1038.36)
mediawiki-el: 注释文本说“2.2.3”，函数定义说 2.2.4（不一致？）

```
...
;; Version: 2.2.3
;; Created: Sep 17 2004
;; Keywords: mediawiki wikipedia network wiki
;; URL: http://launchpad.net/mediawiki-el
;; Last Modified: <2012-05-27 22:06:10 mah>

(defconst mediawiki-version "2.2.4"
  "Current version of mediawiki.el")
... 
```

当我尝试连接到 mediawiki 站点时，我收到错误

```
Posting to: http://en.wikipedia.org/api.php
Contacting host: en.wikipedia.org:80
xml-parse-tag: XML: (Not Well-Formed) Invalid end tag (expecting link) at pos 3712 
```

我在 .emacs 中有以下内容

```
'(mediawiki-site-alist (quote (("Wikipedia" "http://en.wikipedia.org/" "foobar" "" "XXX")))) 
```

知道如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T04:19:37.430

似乎这是[`mediawiki.el`2.2.4](https://launchpadlibrarian.net/106282214/mediawiki.el)和 GNU Emacs 24.* 之间的兼容性问题，至少是通过 Mac Ports 安装在 port 下的问题`emacs-app @24.1_0`。我怀疑这是因为如果我回滚到`emacs-app @23.4.1`，问题会立即消失。

通过 Mac 端口回滚到早期版本的 Emacs：

```
$ sudo port installed emacs-app
The following ports are currently installed:
  emacs-app @23.3_3
  emacs-app @23.3_4
  emacs-app @23.4_0
  emacs-app @23.4_1
  emacs-app @24.1_0
  emacs-app @24.2_0+fullscreen+inline+patches
  emacs-app @24.2_1+fullscreen+inline+patches (active)
$ sudo port activate emacs-app @23.4_1
--->  Computing dependencies for emacs-app
--->  Deactivating emacs-app @24.1_0
--->  Cleaning emacs-app
--->  Activating emacs-app @23.4_1
--->  Cleaning emacs-app
$ sudo port activate emacs-app @24.1_0
--->  Computing dependencies for emacs-app
--->  Deactivating emacs-app @23.3_4
--->  Cleaning emacs-app
--->  Activating emacs-app @24.1_0
--->  Cleaning emacs-app 
```

使用 Emacs 编辑 Mediawiki 实例会掩盖实践吗？似乎如果一个人使用 Emacs 并足够频繁地编辑任何 Mediawiki 页面，那么将两者放在一个地方将是一种直觉需求。

# google-chrome - 有没有一种简单的方法可以强制将文件缓存在 chrome 中？

> ID：12772152
> 
> 赞同：1
> 
> 时间：2012-10-07T19:34:48.697
> 
> 标签：google-chrome, browser-cache

我大学的无线登录页面很慢，因为它有一个阻塞的 js 文件，有时会出错。通常，您必须等待两个超时时间，因为它们将用户名输入和密码输入分开。

我想知道是否有一种简单的方法可以强制 chrome 缓存一个空文件。我想我可以通过暂时将该域重定向到我的本地机器、请求相同的文件并发送缓存标头来做到这一点。我真的很想知道它是否可以通过 javascript 完成……可能是一个书签。很高兴能够将其分发给其他学生。

作为记录，我确实通知了他们这个问题，他们可以简单地将文件向下推，但得到一个罐头回应，他们没有解决方案。

# twig - 树枝和车把如何包含模板

> ID：12772154
> 
> 赞同：3
> 
> 时间：2012-10-07T19:34:50.953
> 
> 标签：twig

首先我知道`{% raw %}`。我的问题是我在前端使用主干并使用了很多 Handlebars 模板。在我的主要树枝模板上，我有：

```
{% block templates %}

<script id="element" type="text/template">
    {% include "ticket/element.html.twig" %}
</script>
{% endblock %} 
```

然后我得到了模板票/element.html.twig：

```
<ul>
  <li class="ref_code">{{ ref_code }}</li>
  <li class="names">{{ firstname}} {{ lastname}}</li>
  <li class="email">{{ email }}</li>
<ul> 
```

我的问题是：是否可以将等价物`{%raw%}`直接放在包含声明中。例如：`{% include "ticket/element.html.twig" | raw %}` 那太好了，因为它可以让我在后端和前端使用 ticket/element.html.twig 作为模板。

这是一个有点愚蠢的问题，但我只是想知道......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T03:42:10.343

我知道无法过滤包含，但我不是 Twig 专家。把它`{% raw %}`放在你的内部模板中怎么样？

```
<ul>
{% raw %}
  <li class="ref_code">{{ ref_code }}</li>
  <li class="names">{{ firstname}} {{ lastname}}</li>
  <li class="email">{{ email }}</li>
{% endraw %}
<ul> 
```

# java - log4j - 代码中的日志语句未重定向到控制台

> ID：12772156
> 
> 赞同：0
> 
> 时间：2012-10-07T19:34:56.803
> 
> 标签：java, log4j

我正在使用 Spring 学习 Hibernate，并正在使用 JSF 2.0 创建一个应用程序。我正在尝试在我的应用程序中配置日志记录，但我的代码中的日志语句似乎没有发送到输出（在我的例子中是控制台）。

我可以看到 Hibernate 日志记录语句：|

以下是我的项目结构：

[![结构快照](../Images/03ef582678df4a916ef013e93c6f9282.png)](https://i.stack.imgur.com/tnDZH.png)

还有我的**log4j.properties**：

```
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n

log4j.rootLogger=debug, stdout

log4j.logger.org.hibernate=info
log4j.logger.org.springframework=warn
log4j.logger.org.hibernate.hql.ast.AST=info
log4j.logger.org.hibernate.SQL=debug
log4j.logger.org.hibernate.type=info
log4j.logger.org.hibernate.tool.hbm2ddl=warn
log4j.logger.org.hibernate.hql=info
log4j.logger.org.hibernate.cache=info
log4j.logger.org.hibernate.jdbc=info 
```

这是上下文侦听器类的代码：

```
import org.apache.log4j.Logger;
...
...
...

public class HibernateListener implements ServletContextListener 
{
   private static final String CFG_PATH = "/WEB-INF/hibernate.cfg.xml";

   private static final Logger LOGGER = Logger.getLogger(HibernateListener.class);

   @Override
   public void contextDestroyed(ServletContextEvent event) {
      HibernateUtil.getSessionFactory().close();
   }

   @Override
   public void contextInitialized(ServletContextEvent event) {
      URL configFile = null;
      try {
         configFile = event.getServletContext().getResource(CFG_PATH);
         HibernateUtil.buildSessionFactory(configFile);
         LOGGER.info("Context initialization successful");
         System.out.println("Context initialization successful");
      }
      catch (MalformedURLException e) {
         System.err.println("Could not load hibernate configuration file - " + configFile);
      }
   }
} 
```

我看不到 INFO 语句，也看不到 sysout ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T15:39:35.283

似乎应用服务器启动存在问题，因此代码从未到达 LOG 语句。创建应用程序服务器的新实例后问题已解决...

# javascript - 如何避免切换“嵌入式”HTML 元素？

> ID：12772159
> 
> 赞同：0
> 
> 时间：2012-10-07T19:35:11.263
> 
> 标签：javascript, jquery, html

我有以下 HTML-Java 代码：

```
<div id="div_id" style="cursor: pointer;">
  <a id="a_id" href="...">...</a>

  <script type="text/javascript">
    $('#a_id').click(function(event) {
      event.preventDefault();
      alert('...');
    });
  </script>
</div>

<div id="details_id" style="display: none;">
  Some text to be displayed!

  <script type="text/javascript">
    $('#div_id').click(function(event) {
      event.preventDefault();
      $('#details_id').toggle();
    });
  </script>
</div> 
```

当（在我的浏览器中）我单击 HTML`div#div_id`时，它会切换`div#details_id`. 但是，当我单击 HTML 时也会发生切换`a#a_id`。我想实现该行为，以便当我单击 HTML`a#a_id`时它不会切换`div#details_id`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T19:37:47.663

做就是了：

```
$('#div_id').click(function(event) {
    if (event.target != $('#a_id')[0]) {
      event.preventDefault();
      $('#details_id').toggle();
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T19:37:43.980

要阻止`click`事件触发两个处理程序，请停止元素上的[事件冒泡：](http://www.quirksmode.org/js/events_order.html#link3)`a`

```
event.preventDefault();
event.stopPropagation(); 
```

或更简洁地说：

```
// Your code

return false; 
```

**演示：http: [//jsfiddle.net/jfzU2/2/](http://jsfiddle.net/jfzU2/2/)**

# ruby-on-rails - Authlogic :remember_me 选项不适用于用户

> ID：12772168
> 
> 赞同：0
> 
> 时间：2012-10-07T19:36:11.360
> 
> 标签：ruby-on-rails, ruby, authlogic

有这样`user_session`的模型：

```
class UserSession < Authlogic::Session::Base

  logout_on_timeout true # default if false

  find_by_login_method :find_by_login_or_email
  remember_me_for 2.weeks
  logged_in_timeout = 16.minutes # default is 10.minutes
  #logged_in_timeout = 2.hours { :if self.record. }
  #remember_me true
  after_create :update_user_activity 
```

尝试创建用户会话时`:remember_me=>true`

```
UserSession.create(:login => "login", :password => "my password", :remember_me => true) 
```

用户会话已创建，但用户在 16 分钟后退出（无论 `:remember_me`设置为`true`或`false`）

此外，如果`logout_on_timeout`设置为`false`，则即使在 16 分钟后用户会话也不会结束。

如何使`:remember_me`选项起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:38:52.693

在[https://github.com/binarylogic/authlogic/pull/308](https://github.com/binarylogic/authlogic/pull/308)找到此问题的解决方案

# jsf-2 - 删除后不刷新

> ID：12772171
> 
> 赞同：0
> 
> 时间：2012-10-07T19:36:47.000
> 
> 标签：jsf-2, primefaces

我在我的 Web 应用程序中使用**JSF**和**Primefaces 。**

我正在使用primefaces 的**p:datatable id="jobEditTable"**组件。

在此我可以选择删除一些行。

在数据表中，我在单击该按钮时有一个删除按钮，我正在显示一个 **p:dialog id="deleteJob"然后我在****p:dialog** 中填写一些删除的原因，然后我单击**p:dialog**中的一个命令链接然后它调用我正在清除**数据列表并再次创建的一个动作侦听器。**

并且 onClick 该命令链接我正在更新 jobEditTable 并隐藏该 p:dialog。

```
 <p:datatable id="jobEditTable" value="#{mastersBean.dataList}"..../>
 . . .. . . .  . . .
    <p:commandLink  actionListener="#{tableBean.deleteRow}" update="jobEditTable"  oncomplete="deleteJob.hide()">
               <p:graphicImage value="/images/delete_button.png" />
                 <f:attribute name="model" value="#{tableBean.delCode}"></f:attribute>
                </p:commandLink> 
```

一切正常，数据表也令人耳目一新。

**但是** ，如果我们在删除和执行该过程之前搜索一些工作，则数据表不会刷新。**为什么？？**

意思是，如果我不使用任何过滤器而不搜索，则数据表正在刷新如果我删除了某些行，则数据表正在刷新，但在搜索和删除数据表后不刷新..

**为什么会这样？？**

我的 bean 在**视图范围内**。

这是我**的名为 MastersBean 的 ManagedBean**

```
 public void deleteDetails(ActionEvent e)
    {
        String id=(String)e.getComponent().getAttributes().get("param");
        ........deleting data from database according to id.........
            dataList.clear();

      ..........updating datalist again....................
        FacesContext context = FacesContext.getCurrentInstance();  

        context.addMessage(null, new FacesMessage("Successfully Deleted"));  

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-22T11:50:45.130

我认为从数据库中删除项目后，您需要从数组列表中删除所选项目，例如：`myArrayList.remove(selectedItem);`，不要再次从数据库中重新加载所有数据！. 我遇到了这个问题，现在它运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:50:07.340

尝试在 ajax 更新中更新 dataTable 周围的表单：

```
<h:form id="form1">
....
    <p:datatable id="jobEditTable" ..../>
</h:form>

<p:commandLink ... update=":form1"...></p:commandLink> 
```

结果是您在支持 bean 中缓存的数据表上显示的结果吗？你能发布你的支持bean的来源吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-20T20:27:32.880

我建议使用`ListIterator<Object>`：

```
void delete(Object object) {
    ListIterator<Object> iter = myArrayList.listIterator()

    while (iter.hasnext) {
        if (current element == object) {
            ------dataBase call here to delete object----
            iter.remove();
        }
    }
} 
```

# ruby-on-rails - Ad hoc Mongoid 模型

> ID：12772172
> 
> 赞同：0
> 
> 时间：2012-10-07T19:36:57.553
> 
> 标签：ruby-on-rails, runtime, mongoid, field

我想创建一个 Mongoid 模型，它具有基于任意结构的运行时临时字段。

使用动态字段不会削减它，因为我需要使用验证、自定义类型和嵌入到模型中。

通过ing`after_initialize`在模型的块中定义新字段和验证确实有效。`class_eval`但是，由于`class_eval`.

如果字段是在实例级别而不是类级别定义的，我有一种预感，你可以让它工作。

喜欢就这个问题得到一些指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T23:18:04.103

恕我直言，因为 ActiveModel 验证的工作方式，您将无法完成此操作。但是，您可以做的是定义基类的临时子类，并在那里定义验证逻辑。无论如何，整个事情看起来很hacky。您想描述问题的领域吗？

# algorithm - 将几个 IF 语句组合成一个（matlab）？

> ID：12772183
> 
> 赞同：0
> 
> 时间：2012-10-07T19:37:51.720
> 
> 标签：algorithm, matlab, matrix

是否有一种方法可以组合几个 if 语句以按以下相同的顺序执行：

```
X = [1 2 3 4; 5 4 6 7; 2 8 9 2];
X

n = length(X(1,:))-1;

for i=1:n,     
    if length(X(1,:)) == n,
    .........
    end

    if length(X(1,:)) == n-1,
    .........
    end

    if length(X(1,:)) == n-2,
    .........
    end
end 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:20:40.260

从您提供的代码以及您给 Theodros 的评论来看，我认为这是一个[代码异味](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)的案例。换句话说，我有一种预感，您的方法存在更深层次的问题，如果您披露您的全部问题，我们可能会改进这些问题。

现在，话虽如此：如果您要针对每种情况执行的操作不同，那么显然，您不能将它们组合成一个语句。如果每个块中有多个相同过程的副本，则可以使用逻辑 OR：

```
if length(X(1,:)) == n || length(X(1,:)) == n-1
    ...
end

if length(X(1,:)) == n-2 || length(X(1,:)) == n-4
    ...
end 
```

`switch`正如@TheodrosZelleke 建议的那样，如果您使用该语句，代码会看起来更好（并且会稍微快一些） 。组合案例是这样的：

```
switch length(X(1,:))

    case {1 2}  %# length == 1 OR length == 2
        ...
    case {3 4}  %# length == 3 OR length == 4
        ...
end 
```

# vba - 调用 BuiltInDocumentProperties(wdPropertyTitle) 返回空字符串

> ID：12772184
> 
> 赞同：0
> 
> 时间：2012-10-07T19:37:52.453
> 
> 标签：vba, ms-word

我有一个旧的 Word 宏，它应该通过调用来获取文档标题

```
DocTitle = ActiveDocument.BuiltInDocumentProperties(wdPropertyTitle) 
```

或者

```
 Set oBuiltInProps = ActiveDocument.BuiltInDocumentProperties
    strValue = oBuiltInProps.Item("Title").Value 
```

在新文档上，这是在调用 SaveAs（我也尝试过 SaveAs2）后完成的，该调用用于确保文档的第一句填充了 Documenttitle 属性。然而，这似乎不再起作用，我只是得到一个空白字符串。

这是在我的开发机器上，所以它可能有一个我没有设置的 word 设置，但我不记得了。

有谁知道我如何强制保存文档以创建 DocumentTitle？

我正在使用 Word 2010

（我有一个使用 Word 2010 的单独工作安装，但最初是为 Word 97 编写的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T09:05:11.157

如果我理解正确并且您正在寻找一种方法来简单地获取 Word 2010 中的文档标题，您可以使用以下宏：

```
Dim Title As String
Title = ActiveDocument.Name
MsgBox (Title) 
```

# ios - 适用于 iOS 的 ffmpeg（armv6 和 armv7）

> ID：12772186
> 
> 赞同：2
> 
> 时间：2012-10-07T19:38:01.860
> 
> 标签：ios

我在这里尝试了许多解决方案来为 iOS 构建 ffmpeg。最值得注意的是，我尝试的最后一个是在这里：[ffmpeg won't ./configure in iOS5.1](https://stackoverflow.com/questions/9982528/ffmpeg-wont-configure-in-ios5-1?s=e50c8c43-362d-436e-bdfb-ba6dc701890d#new-answer)

当我尝试建议的解决方案，然后在其中一个输出库上运行“lipo -info”时，我得到：

输入文件 armv7/libavcodec.a 不是胖文件 非胖文件：armv7/libavcodec.a 是架构：i386

这是在为 amrv7 构建的文件上运行“lipo -info”的预期结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T06:34:01.693

很可能您没有安装 gas-preprocessor.pl 。请参阅此答案如何安装： [https ://stackoverflow.com/a/5307801/1597017](https://stackoverflow.com/a/5307801/1597017)

在我的项目中，我使用 rake 为带有 Xcode 4.5.1 (sdk 6.0) 的 iOS 配置和构建 ffmpeg 链接：[https ://github.com/kolyvan/kxmovie/blob/master/Rakefile](https://github.com/kolyvan/kxmovie/blob/master/Rakefile)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T00:07:50.003

您是否可能为模拟器 i386 而不是 armv7 构建。

此外，如果您使用 Xcode 4.4，那么在构建设置中包含 armv7s 或删除 armv7s 拱门非常重要。

# xcode - 如何部署 Mac 命令行工具

> ID：12772187
> 
> 赞同：12
> 
> 时间：2012-10-07T19:38:05.610
> 
> 标签：xcode, release, command-line-tool

我使用 Xcode OS X 命令行工具项目模板创建了一个控制台应用程序。

当一切都说完了，我的机器上实际的“发布”二进制文件在哪里？搜索后，我发现在哪里可以找到“调试”二进制文件：

~/Library/Developer/Xcode/DerivedData/Project/Build/Products/Debug

我在哪里可以找到“发布”二进制文件？或者在 Xcode 中是否需要额外的设置来输出这些二进制文件以便我可以分发控制台应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:19:22.850

方案设置确定是否构建 Debug 或 Release 版本。默认方案构建调试。如果您在 Product 菜单中选择 Archive 选项，Xcode 将默认构建 Release 版本。作为归档过程的一部分，您选择要放置构建产品（可执行文件）的位置。

通过编辑默认方案，您还可以指导普通构建操作来创建发布版本。您还可以添加自己的自定义方案。

# objective-c - 当前存在超过 10 个 ADBannerView 或 ADInterstitialView 实例：使用 ARC

> ID：12772188
> 
> 赞同：1
> 
> 时间：2012-10-07T19:38:15.533
> 
> 标签：objective-c, automatic-ref-counting, iad, xcode4.5

我正在使用带有 ARC 的 Xcode 4.5 并使用 iAd 收到以下消息：

> 警告：当前存在超过 10 个 ADBannerView 或 ADInterstitialView 实例。这是对 iAd API 的滥用，广告效果将因此受到影响。

我读过这篇文章：[Iad 警告：超过 10 个 ADBannerView 实例，](https://stackoverflow.com/questions/12669989/objective-c-iad-warning-more-than-10-instances-of-adbannerview)但该代码看起来没有 ARC，我有。

我的代码：

```
-(AppDelegate *) appdelegate {
return (AppDelegate *) [[UIApplication sharedApplication]delegate];
}

-(void) viewWillAppear:(BOOL)animated {
_UIiAD = [[self appdelegate]UIiAD];
_UIiAD.delegate = self;
adView = [[ADBannerView alloc]initWithFrame:CGRectZero];
adView.frame = CGRectOffset(adView.frame, 0, 460.0);
adView.requiredContentSizeIdentifiers = [NSSet setWithObject: ADBannerContentSizeIdentifierPortrait];
[self.view addSubview:adView];
adView.delegate = self;
self.bannerIsVisible = NO;
}

- (void) viewWillDisappear:(BOOL)animated {
_UIiAD.delegate = nil;
_UIiAD = nil;
[_UIiAD removeFromSuperview];
}

-(void)bannerViewDidLoadAd:(ADBannerView *)banner {

if(!self.bannerIsVisible) {
    [UIView beginAnimations:@"animateAdBannerOn" context:NULL];
    //banner is invisible now and moved out of the screen
    banner.frame = CGRectMake(0.0, 5.0, banner.frame.size.width, banner.frame.size.width);
    [UIView commitAnimation];
    self.bannerIsVisible = YES;

    NSLog(@"bannerViewDidLoadAd is working!");
}
}

-(void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error {
if (self.bannerIsVisible) {
    [UIView beginAnimations:@"animateAdBannerOff" context:NULL];
    //banner is visible and we move it out of the screen due to connection issues
    banner.frame = CGRectMake(0.0, -50.0, banner.frame.size.width, banner.frame.size.width);
//        [UIView commitAnimation];
    self.bannerIsVisible = NO;

    NSLog(@"didFailtoReceiveWithError is working");
}
}

-(BOOL)bannerViewActionShouldBegin:(ADBannerView *)banner willLeaveApplication:(BOOL)willLeave {
NSLog(@"Banner view is beginning an ad action");

BOOL shouldExecuteAction = YES;
if (willLeave && shouldExecuteAction) {
    // stop all interaction process in the app. Use this to stop sounds or video so the ad can display properly
    // [video pause];
    // [sound pause];
}
return shouldExecuteAction;
}

-(void)bannerViewActionDidFinish:(ADBannerView *)banner {
// resume everything you've stopped
// [video resume];
// [audio resume];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:00:57.893

因为您首先从 ivar 中清除广告，所以您永远不会从超级视图中删除广告。尝试重写如下：

```
- (void) viewWillDisappear:(BOOL)animated {
[_UIiAD removeFromSuperview];
_UIiAD.delegate = nil;
_UIiAD = nil;
} 
```

# python - urllib“模块对象不可调用”

> ID：12772190
> 
> 赞同：6
> 
> 时间：2012-10-07T19:38:18.707
> 
> 标签：python, python-3.x, urllib

这是我的第三个 python 项目，我收到了一条错误消息：`'module object' is not callable`.

我知道这意味着我错误地引用了一个变量或函数。但是反复试验无法帮助我解决这个问题。

```
import urllib

def get_url(url):
    '''get_url accepts a URL string and return the server response code, response headers, and contents of the file'''
    req_headers = {
        'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.A.B.C Safari/525.13',
        'Referer': 'http://python.org'}

    #errors here on next line
    request = urllib.request(url, headers=req_headers) # create a request object for the URL
    opener = urllib.build_opener() # create an opener object
    response = opener.open(request) # open a connection and receive the http response headers + contents

    code = response.code
    headers = response.headers # headers object
    contents = response.read() # contents of the URL (HTML, javascript, css, img, etc.)
    return code , headers, contents

testURL = get_url('http://www.urlhere.filename.zip')
print ("outputs: %s" % (testURL,)) 
```

我一直在使用此链接作为参考： [http ://docs.python.org/release/3.0.1/library/urllib.request.html](http://docs.python.org/release/3.0.1/library/urllib.request.html)

**追溯：**

```
Traceback (most recent call last):
  File "C:\Project\LinkCrawl\LinkCrawl.py", line 31, in <module>
    testURL = get_url('http://www.urlhere.filename.zip')
  File "C:\Project\LinkCrawl\LinkCrawl.py", line 21, in get_url
    request = urllib.request(url, headers=req_headers) # create a request object for the URL
TypeError: 'module' object is not callable 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-07T19:41:10.400

在 python 3 中，`urllib.request`对象是一个模块。您需要调用此模块中*包含的对象。*这是 Python 2 的一个重要变化，如果您使用的是示例代码，则需要考虑到这一点。

例如，创建`Request`对象和开瓶器：

```
request = urllib.request.Request(url, headers=req_headers)
opener = urllib.request.build_opener()
response = opener.open(request) 
```

仔细阅读[文档。](http://docs.python.org/py3k/library/urllib.request.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-07T19:41:24.517

[`urllib.request`](http://docs.python.org/release/3.0.1/library/urllib.request.html)是一个模块。[`urllib.request.Request`](http://docs.python.org/release/3.0.1/library/urllib.request.html#urllib.request.Request)是一类。像您当前所做的那样调用模块会引发错误。您可能想调用该类，如下所示：

```
request = urllib.request.Request(url, headers=req_headers)  # create a request object for the URL 
```

您可能还想使用[`build_opener`](http://docs.python.org/release/3.0.1/library/urllib.request.html#urllib.request.build_opener)of[`urllib.request`](http://docs.python.org/release/3.0.1/library/urllib.request.html)而不仅仅是`urllib`：

```
opener = urllib.request.build_opener()  # create an opener object 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-25T05:14:38.670

如果您通过使用 @property 注释将返回方法声明为属性方法，也会发生这种情况。

# javascript - 在目标页面上执行 javascript 的 XML HTTP 请求

> ID：12772192
> 
> 赞同：0
> 
> 时间：2012-10-07T19:38:20.000
> 
> 标签：javascript, ajax, include, xmlhttprequest, execute

我正在使用 XMLHttpRequest 函数从通过 javascript 函数选择的外部页面获取数据，然后将结果返回到 DIV 容器，该容器可以正常工作，直到目标页面内部有 Javascript 函数 - 未执行。

基本功能的代码在这里：

```
function haha(url) {
var NRL = url+".php";
var target = "InnerContent";
  document.getElementById(target).innerHTML = ' Fetching page...';
  if (window.XMLHttpRequest) {
    req = new XMLHttpRequest();
  } else if (window.ActiveXObject) {
    req = new ActiveXObject("Microsoft.XMLHTTP");
  }
  if (req != undefined) {
  evalScripts:true
    req.onreadystatechange = function() {hahaDone(NRL);};
    req.open("GET", NRL, true);
    req.send("");
  }

}  

function hahaDone(url) {
var target = "InnerContent";
var ExtraText = '';
  if (req.readyState == 4) { // only if req is "loaded"
    if (req.status == 200) { // only if "OK"
    evalScripts:true
      document.getElementById(target).innerHTML = req.responseText+ExtraText;
    } else {
      document.getElementById(target).innerHTML=" AJAX Error:\n"+ req.status + "\n"+req.statusText;
    }

 }
} 
```

如何修改此函数以在目标页面上执行 javascript 加载？我真的不想开始使用 Jquery 或类似的东西，因为这个当前的代码是可以理解的，而且我已经定制了它以适用于当前的站点，该站点预计将在几个小时内上线。

提前致谢。

# ios - iOS 6/7 中“没有重复使用表格单元的索引路径”消息是什么意思？

> ID：12772197
> 
> 赞同：58
> 
> 时间：2012-10-07T19:38:58.813
> 
> 标签：ios, ios6, uitableview, ios7

自从开始使用 iOS 6（以及 iOS 7）编译我的应用程序以来，我已经开始看到此消息。我知道 UITableViews 管理单元格的方式在 iOS 6 中有所不同，但我不需要修改我的代码以使其继续工作。但我担心此消息可能会指出一些我尚未看到的潜在问题。任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2013-09-12T16:10:16.507

从 iOS 7 beta 5 开始，我开始在日志中出现这个错误，包括在 iOS 7 GM/Release 版本中，而在我的 iOS 6 或更早的 iOS 7 beta 中的应用程序中从未发生过。经过大量的实验，我找到了原因：

我正在为我的部分标题视图使用`UITableViewCell`对象并将它们返回到`tableView:viewForHeaderInSection:`. 这似乎是一种常见的做法，尤其是自 iOS 5 以来，当使用 Interface Builder 将节标题视图设计为 StoryBoard 中的原型表视图单元格变得很容易时。

当我将应用程序更改为仅对`UIView`节标题视图使用常规子类时，错误消失了，更重要的是，我的表格视图停止随机删除节标题！

看起来（自 iOS 7 beta 5 起）`UITableView`在内部维护`UITableViewCell`其视图层次结构中所有对象及其各自索引路径的映射。由于节标题（或页脚的表视图标题）没有索引路径，如果您为这些视图使用对象，则表视图在找到没有索引路径`UITableViewCell`的 a 时会感到困惑`UITableViewCell`，导致“没有重复使用表格单元格的索引路径”错误，如果你不走运，在表格视图中显示故障：

**更新**：如果您可以访问 Apple 开发论坛，这里是关于它的主题（我开始的）：[https ://devforums.apple.com/message/882042#882042](https://devforums.apple.com/message/882042#882042)

正如该线程中所建议的，如果您不想重构太多，您可以`UIView`在您的周围创建一个包装器`UITableViewCell`并将其作为节标题视图返回。

```
UIView *view = [[UIView alloc] initWithFrame:[cell frame]];
[view addSubview:cell];

return view; 
```

但是请注意，这种“包装器”`UIView`方法不适用于 AutoLayout 和设备旋转，因此我建议您使用`UIView`页眉和页脚单元格的子类，而不是`UITableViewCell`答案主要部分中解释的子类。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-12-10T17:12:54.320

我会返回 UITableViewCell 的 contentView 而不是创建包装器.. 在 storybord 中固定约束-jabble

```
return cell.contentView; 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-12-31T02:45:22.140

我遇到了同样的问题，我花了几个小时来解决这个问题。原来我是`[textField becomeFirstResponder]`在设置单元格时调用的（这里的 textField 是自定义 tableviewcell 的一部分）；`[textField becomeFirstResponder]`依次发布keyboardWillShow通知，这反过来导致tableview过早地加载自身，从而导致臭名昭著的“*没有重复使用表格单元的索引路径*”消息。一旦我删除了那个调用，问题就消失了。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-03-31T01:47:16.660

除了接受的答案（mluisbrown）之外，我还需要在标题单元格中添加一个 autoresizingMask，因为我的包含一个多行标签，即

```
UIView *view = [[UIView alloc] initWithFrame:[cell frame]];
cell.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
[view addSubview:cell];
return view; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-10-07T21:39:32.873

这是一个内部 UIKit 错误 - 正如 Apple 自己的开发论坛中提到的那样。据说它已在较新版本的 xcode 中修复，尽管我无法找到有关哪个版本修复此问题的信息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-07T23:32:04.783

作为对我之前文章的补充（其中我提到这显然是 UIKit 的一个错误），我能够找到针对我的特定情况的解决方法（其中消息与桌子上的一些奇怪的可视化故障有关）。

显然，我的自定义单元格被覆盖`-(void)setEditing:animated:`需要很长时间才能返回。

我之前的代码是：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{   
    [super setEditing:editing animated:animated];
    [self someAdditionalCode];
} 
```

我能够通过将其更改为来修复它：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{   
    [super setEditing:editing animated:animated];

    // DRM: we want to perform the actions from this block in the main thread, but
    // asynchronously to avoid excessive delays which were causing issues.
    //
    dispatch_async(dispatch_get_main_queue(), ^void()
    {
        [self someAdditionalCode];
    });
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-01T18:44:31.907

出现错误消息时我遇到了同样的问题。据我所知，这是由于从文本字段调用的函数重新加载表视图引起的，作为其委托协议的一部分。即 textFieldDidEndEditing -> [controller.tableview 重新加载...]

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-19T08:25:25.780

在 resignfirstresponder 解决我的问题后做我的 endupdates（在我的自定义单元格中有一个 UITextFIeld）

```
-(void)textfieldEditDone
{
....

    [textField resignFirstResponder];
    [self.tableView endUpdates]; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-15T19:32:21.343

作为记录，我在 iOS 6 下运行时也遇到了此消息。似乎继承或导入的某些代码具有以下内容：

```
(NSInteger)tableView:(UITableView *)tv numberOfRowsInSection:(NSInteger)section {
    NSInteger rows = 0;
    if ([delegate respondsToSelector:@selector(numberOfItemsInSection:)]) {
        rows = [delegate numberOfItemsInSection:section];

        [tableView beginUpdates];
        [tableView endUpdates];
    }
} 
```

当 beginUpdate:/endUpdate: 序列被删除后，问题就神奇地消失了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-02T00:04:07.983

这显然是一个老问题，但希望这可以帮助在 iOS8+ 中仍然遇到此问题的任何人，因为这仍然是针对此特定错误消息提出的首要问题。

我正在使用 PINRemoteImage 将图像异步下载到自定义 UITableViewCell 内的 UIImageView。

为了在图像加载后正确调整行的大小（使用自动布局的动态高度单元格），我调用了：

```
self.tableView beginUpdates;
self.tableView endUpdates; 
```

然后我收到“没有重复使用表格单元的索引路径”消息，应用程序崩溃了。我原以为 PINRemoteImageManagerResult 块在主线程上，但事实证明它不是 - 因此确保在主线程上调用开始/结束更新解决了这个问题。

```
dispatch_async(dispatch_get_main_queue(), ^(void){
                            [self.tableView beginUpdates];
                            [self.tableView endUpdates];
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-04-09T11:16:52.493

好吧，我只是利用一天中的大部分时间试图弄清楚这一点，所以希望这种替代解释可以为其他人节省一些时间。

*我有一个 tableview有时会*在加载时给出这个消息。事实证明，这是由在加载视图时触发 Core Data 对象的 KVO 通知引起的。（在观察到变化时，我的控制器尝试在有问题的 tableview 上调用 reloadData。通过在视图完成加载之前不观察对象来修复（以前，一旦通过访问器分配对象，我就开始观察对象）

TLDR：检查您是否正在尝试从主线程以外的其他地方重新加载数据。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-04-17T07:13:04.323

也许这对某人有帮助：我曾经在刷新单个表格视图单元格时遇到此错误。我的意思是做类似的事情

```
NSIndexPath *reloadRow = [NSIndexPath indexPathForRow:1 inSection:2];
[self._mainTableView reloadRowsAtIndexPaths:@[reloadWebViewRow]
                           withRowAnimation:UITableViewRowAnimationFade]; 
```

但不小心，我输入了

```
NSIndexPath *reloadRow = [NSIndexPath indexPathForItem:1 inSection:2]; 
```

注意两个索引路径的区别：一个是用`indexPathForItem`（错误）创建的，另一个是用`indexPathForRow`（正确）创建的。这一切都导致了 tableView 的非常奇怪的行为和标题中的错误消息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-01-16T04:52:31.563

似乎我的问题是在我尝试在作为网络调用回调的部分代码中更新 UI 时触发的。我通过强制 UI 更新在主线程上进行解决。我使用了这样的代码。

```
void runOnMainQueueWithoutDeadlocking(void (^block)(void)){
    if ([NSThread isMainThread])
    {
        block();
    }
    else
    {
        dispatch_sync(dispatch_get_main_queue(), block);
    }
} 
```

我在后台网络调用的成功块内按如下方式调用它。

```
runOnMainQueueWithoutDeadlocking(^{
    [self.tableView beginUpdates];
    [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:1] withRowAnimation:UITableViewRowAnimationAutomatic];
    [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:2] withRowAnimation:UITableViewRowAnimationAutomatic];
    [self.tableView endUpdates];
}); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-10-20T15:04:33.690

**还有一个条件...**

这发生在我不想要标题时，我返回了`nil`.

**使固定：**

```
func tableView(tableView: UITableView,
               titleForHeaderInSection section: Int) -> String? {
    return ""
} 
```

# c# - Visual Studio 2010 和创建本地数据库连接导致 regkey 错误

> ID：12772198
> 
> 赞同：2
> 
> 时间：2012-10-07T19:39:02.170
> 
> 标签：c#, visual-studio-2010, registry

我正在尝试为我的第一个 Visual Studio 项目创建本地数据库，当我尝试在服务器资源管理器中打开数据库连接时出现此错误

![在此处输入图像描述](../Images/8237b45ab2af55dff61ac46e7b1240ef.png)

问题似乎是 url 中 Visual Studio 和 VSTSDB 之间缺少 \ 。

我已经阅读了其他线程，但它们在 Visual Studio 2008 中都有这个问题，因此例如在这个线程中没有给出任何解决方案[如何修复“无法添加数据连接。IVsDataConnectionDialog 无法初始化”错误?](https://stackoverflow.com/questions/976542/how-do-i-fix-a-unable-to-add-data-connection-the-ivsdataconnectiondialog-could) 对我有用，我都试过了。

上面给定 url 中给出的 reg 键路径不起作用，我猜是因为我在 Windows 7 和 Visual Studio 2010 中，并且线程更老。

我已在此处本地化此 url 的 reg 键

```
HKEY_CURRENT_USER/Software/Microsoft/VisualStudio/10.0_Config/DataProviders/{91510608-8809-4020-8897-FBA057E22D54}/TSDataViewExtensions 
```

它有价值

> E:\Program\Visual StudioVSTSDB\Microsoft.VisualStudio.Data.Schema.SEExtensions.xml

如您所见，Visual Studio 和 VSTSDB 之间的 url 中缺少 \，但是每次我更改它并重新启动时，Visual Studio 只是在我尝试创建本地数据库并导致崩溃时将其更改回旧 url...再次。

有什么方法可以永久修复这个 reg 密钥或我能做的其他事情吗？

谢谢，斯特凡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:07:27.897

我使用了 Visual Studio 2010 卸载实用程序 [http://archive.msdn.microsoft.com/vs2010uninstall](http://archive.msdn.microsoft.com/vs2010uninstall)

现在它神奇地起作用了。我不知道该说什么，除了我之前把它安装在 E: 上，现在我把它安装在 C:\Program Files\Microsoft Visual Studio 10.0

我认为这出于某种原因有所不同。很抱歉答案不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-11T07:40:43.130

重新检查记事本中的 D:\Windows\System32\drivers\etc\host 并添加以下行： 127.0.0.1 localhost Corrected ！

# jquery - jQuery 使脚本等待操作完成

> ID：12772199
> 
> 赞同：0
> 
> 时间：2012-10-07T19:39:03.763
> 
> 标签：jquery, callback, wait, appendto

是否有可能让 jQuery 等到这段代码完成它的工作？

```
if (hrefs[arrayCounter]) {
    $('<li>').append($('<img>', {
        src: hrefs[arrayCounter]
    }).css({
        "height": windowHeight
    })).appendTo(ul)
}​ 
```

在此之后图像滚动，我需要在滚动之前计算出宽度。换句话说，当图像仍在加载时，它就太快了。据我所知， appendTo() 不会接受回调，所以我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:02:46.403

在使用此代码之前，请注意**图像的 onload 事件存在几个跨浏览器问题**。[它们在 jQuery`.load`方法的文档中进行了描述。](http://api.jquery.com/load-event/)

您需要构建一个 Deferred 对象并根据每个图像的 onload 函数对其进行管道传输。

```
$.when.apply($,$.map(hrefs, function(href) {
    var imgLoad = $.Deferred(),
        $img = $('<img>').css('height',windowHeight);
    ul.append($('<li>').append($img));
    $img.load($.proxy(imgLoad.resolve,imgLoad));
    $img.attr('src',href);
    return imgLoad;
})).done(function(){
    // all images are loaded when this executes
}) 
```

此代码用于`jQuery.map`将 href 数组转换为 Deferred 对象数组。在循环和附加图像时，每个图像都有自己的 Deferred 对象，其`.resolve`方法绑定到`.load`图像上的处理程序。当图像加载时，Deferred 将解析。

这个 Deferreds 数组作为参数应用到`jQuery.when`，它返回一个 Promise，当它的所有参数都解析时解析——在这种情况下，这意味着所有图像都已加载！然后我们将`.done`回调附加到该 Promise。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:56:45.597

我制作了[这个 jsFiddle](http://jsfiddle.net/mpzRs/)，它基本上坚持图像的 .load() 事件来触发新代码。这仅适用于[可加载的内容](http://api.jquery.com/load-event/)，但我理解的内容似乎符合您的需求。

基本上，您必须将要触发的代码绑定到`.on('load',handler)`图像事件。

希望这会有所帮助。

# wpf - 以横向打印 WPF 视觉对象，打印机仍以纵向尺寸剪辑

> ID：12772202
> 
> 赞同：3
> 
> 时间：2012-10-07T19:39:16.990
> 
> 标签：wpf, printing

我编写了一个以编程方式创建视觉效果的小应用程序，我试图将其打印在横向页面上（它以纵向剪辑）。当我打印时，它确实以横向显示，但我的视觉仍然被剪裁，因为它仅限于纵向。

这是我的代码：

```
StackPanel page = new StackPanel();
// ... generate stuff to the page to create the visual

PrintDialog dialog = new PrintDialog(); // System.Windows.Controls.PrintDialog
bool? result = dialog.ShowDialog();
if(result.HasValue && result.Value)
{
    dialog.PrintTicket.PageOrientation = PageOrientation.Landscape;
    Size pageSize = new Size { Width = dialog.PrintableAreaWidth, 
        Height = dialog.PrintableAreaHeight };
    // pageSize comes out to {1056, 816}, which is the orientation I expect
    page.Measure(pageSize); 
    // after this, page.DesiredSize is e.g. {944, 657}, wider than portrait (816).
    page.UpdateLayout();
    dialog.PrintVisual(page, "Job description");
} 
```

执行此操作后，打印的内容排列正确，但似乎仍被剪裁为 816 的宽度，切断了大量内容。我已经通过将另一张纸放在打印的纸上来检查这一点，它完全适合里面。

在测量和安排控件方面我做错了什么吗？如何让我的打印机使用横向的全部空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T07:13:49.143

[Steve Py 的回答](https://stackoverflow.com/a/12775020/25071)对于描述核心问题是正确的（PrintVisual 不尊重所使用的 PrintTicket 设置）。然而，在我尝试使用 XpsDocumentWriter 和一个新的 PrintTicket 之后，我遇到了同样的问题（如果我将新的 PrintTicket 的方向设置为横向，它仍然被剪裁了）。

相反，我通过设置 LayoutTransform 将内容旋转 90 度并以纵向模式打印来解决此问题。我的最终代码：

```
StackPanel page = new StackPanel();
// ... generate stuff to the page to create the visual
// rotate page content 90 degrees to fit onto a landscape page
RotateTransform deg90 = new RotateTransform(90);
page.LayoutTransform = deg90;

PrintDialog dialog = new PrintDialog();
bool? result = dialog.ShowDialog();
if (result.HasValue && result.Value)
{
    Size pageSize = new Size { Height = dialog.PrintableAreaHeight, Width = dialog.PrintableAreaWidth };
    page.Measure(pageSize);
    page.UpdateLayout();
    dialog.PrintVisual(page, "Bingo Board");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T03:44:11.313

横向视觉打印存在一个已知问题。这应该提供有关如何解决它的详细信息。

[http://social.msdn.microsoft.com/Forums/en/wpf/thread/56fb78b1-efc2-4ff7-aa2c-73c198a790b4](http://social.msdn.microsoft.com/Forums/en/wpf/thread/56fb78b1-efc2-4ff7-aa2c-73c198a790b4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-22T03:32:51.907

尝试

```
PrintDialog printDlg = new PrintDialog();
PrintTicket pt = printDlg.PrintTicket;
pt.PageMediaSize = new PageMediaSize(PageMediaSizeName.ISOA5Rotated); 
```

# arrays - 为什么列表应该从 0 而不是 1 开始？

> ID：12772205
> 
> 赞同：2
> 
> 时间：2012-10-07T19:39:44.293
> 
> 标签：arrays, list

我不认为有很好的理由让列表和数组从索引 0 开始。我认为让它们从 1 开始更自然，如`L[1],...,L[length(L)]`. 也有使用 1 而不是 0 的语言，比如 Matlab，但是很少见。

有人有理由从零开始列表中的索引吗？

PD：我已经阅读了 Dijkstra 参数和 C 中的指针参数，它们讨论了指针的内存偏移。我不觉得他们很有说服力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:48:25.593

在编程的早期，大多数面向内存的事情和程序员不得不在地址方面遭受很多痛苦。引入基于 1 的索引可能会为处理系统编程的程序的地址计算造成另一次破坏（计算开销）。这是一个非常将数组和指针保持为彼此类似表示的充分理由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T19:48:56.337

可以公平地观察到，对后数组集合使用基于 0 的索引本身并不是必需的，但是拥有两个索引系统是一件麻烦事（我在想 VB6 集合与数组），而且使用单个索引系统有助于同时处理这两个原语和复杂的集合类型一致（甚至通常取决于所讨论的语言）。因此，鉴于根据类型有选择地使用基于 1 和 0 的索引充其量没有任何好处，并且至少使用基于 0 的索引有一些好处，我猜这就是它持续存在的原因。

# java - 为什么java if语句以分号结尾时会失败

> ID：12772221
> 
> 赞同：12
> 
> 时间：2012-10-07T19:42:03.433
> 
> 标签：java

我在开发应用程序时犯了一个编码错误，这是对空引用的测试。我花了几个小时才发现问题所在，但我不明白为什么代码会这样。

```
String name = null;
String value = null;

if(name != null && value != null);
{
    System.out.println("Values not null");
} 
```

if 语句以 , 结尾`;`，那是我的错误，`Values not null`即使很明显两个值都为空，它也被打印出来了。谁能解释为什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-07T19:44:08.223

这个分号结束一个语句（一个空的），所以你的代码被编译器翻译成这样的东西：

```
if(name != null && value != null)
{
  //nothing here
}
{
  System.out.println("Values not null");
} 
```

In other words, if `if` expression is `true`, it executes empty block of code. Then no matter whether `if` was true or not, the runtime proceeds and runs the block containing `System.out`. Empty statement is still a statement, so the compiler accepts your code.

Another place where such a mistake can happen:

```
for(int i = 0; i < 10; ++i);
{
  System.out.println("Y U always run once?");
} 
```

or even worse (infinite loop):

```
boolean stop = false;
while(!stop);
{
  //...
  stop = true;
} 
```

> It took me hours to discover what the issue was

Good IDE should immediately warn you about such statement as it's probably never correct (like `if(x = 7)` in some languages).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-07T19:44:45.487

`;` terminates the statement.

```
if(name != null && value != null); 
```

is equivalent to:

```
if(name != null && value != null)
{
} 
```

And the following code is simply a block of code.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T19:43:53.210

```
if(name != null && value != null);
{
    System.out.println("Values not null");
} 
```

相当于：

```
if(name != null && value != null){}

{
    System.out.println("Values not null");
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-07T19:44:08.363

```
if(name != null && value != null); 
```

Here your if statement got finished due to semi-colon...

So, it is just like an `empty` if block: -

```
if(name != null && value != null) {} 
```

So your next code becomes an **Initializer block**: -

```
{
    System.out.println("Values not null");
} 
```

Since it is an **initializer block**.. It will be executed always no matter what your `if` condition evaluated to..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-07T19:44:24.380

It's the standard grammar rules. Semicolons terminate statements, but statements may be empty, so these lines:

```
if (...);
{
} 
```

are equivalent to:

```
if (...) /* do nothing */ ;

{
    ...
} 
```

The following `{ ... }` statement just looks like any other code block, and will always be executed, because the `if` statement is done with by then.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-07T19:44:38.670

Your code is equivalent to:

```
if(name != null && value != null) {
   // empty code block
}

System.out.println("Values not null"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-07T19:45:16.877

The semi-colon ends the statement, and thus detaches the if from the following block.

Note that blocks can be arbitrary.

```
{
System.out.println("This is some code");
} 
```

`if(true);` This is valid, and it does nothing. The language allowing this is pretty stupid, although IDEs should catch these issue with warnings and the like.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-07T19:46:34.360

One bare `;` is a whole empty statement. After the if there has to be exactly one statement that will be executed when `if` is true. The one statement that is executed in your case is the empty statement. You can combine more statements to one with `{statement; statement;...}`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-07T19:47:52.257

Understand that conditional statements needn't always follow with opening and closing braces. Most languages will allow you to simply emit the braces if you only want to execute a single statement when the terms of the condition are met.

Meaning that the following is completely valid, for instance:

```
if (var1 == true && var2 == true) var3 = 'both true';
{
    //block here, this is always executed regardless of the statements outcome
} 
```

Essentially, your code does exactly this. Except your single statement is determined to be `;` (yes, this is considered a statement).

What you wrote is the same as:

```
if(name != null && value != null) {
    // do nothing
}

System.out.println("Values not null"); 
```

# c# - 无法从媒体库中检索批量图像

> ID：12772224
> 
> 赞同：1
> 
> 时间：2012-10-07T19:42:21.793
> 
> 标签：c#, windows-phone-7, windows-phone-7.1, windows-phone

我正在尝试从媒体库中检索图像，当图像很少像 20 25 时它可以正常工作，但是我认为 34 正好我得到了这个异常 System.OutOfMemoryException 未处理

我正在使用此代码

```
 foreach (Picture p in cameraRoll.Pictures)
           {
               BitmapImage b = new BitmapImage();
               b.SetSource(p.GetImage());
               flib.Add(new fromlibrary() { bmp = b, name = p.Name });
               b = null;
           } 
```

其中cameraRoll 是PictureAlbum 而flib 是一个列表<> 也随着图像增加加载时间增加我能做些什么呢？？？所有的加载都是在 BackgroundWorker Dowork 中完成的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:54:16.073

我发现我只需要使用 p.GetThumbnail() 显示出峰值内存消耗的惊人差异...... GetThumbnail()--28.01Mb GetImage()--128Mb

# c++ - 多线程全局对象访问

> ID：12772227
> 
> 赞同：0
> 
> 时间：2012-10-07T19:42:51.340
> 
> 标签：c++, windows, multithreading

好的，我有一个应用程序，它有两个额外的线程。

线程一访问对象 O 并将数据插入到作为对象 O 的一部分的双端队列中并增加一个计数器变量。

线程二访问对象 O 并从双端队列中取出并删除数据并递减计数器变量。

事实证明，这会产生意想不到的结果，因为一个线程告诉我双端队列中有 x 个元素，而另一个线程告诉我没有元素。我想我必须使用某种同步。我尝试使用信号量，但我一定误解了它，因为它不起作用（[http://msdn.microsoft.com/en-us/library/windows/desktop/ms686946(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686946%28v=vs.85%29.aspx)）。

所以我想知道如何从两个线程访问一个全局对象。请注意，对全局对象 O 的访问经常发生，因为访问是在一个 while 循环内，这会导致继续插入和轮询。（可能的解决方案会阻止其他线程访问对象并因此阻止 while 循环吗？）

到目前为止，我只知道信号量和互斥量，但从未使用过它们，请多多指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:51:00.050

最简单的方法是以排他方式使用`EnterCriticalSection`/`LeaveCriticalSection`围绕您要使用的代码：

```
CRITICAL_SECTION critSect;

// Later in the code
EnterCriticalSection(&critSect);
// Do stuff with O
LeaveCriticalSection(&critSect); 
```

您当然会在两个线程中使用它。一次只能有一个线程在进入/离开区域内。将`EnterCriticalSection`阻塞，直到其他线程调用`LeaveCriticalSection`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:55:08.123

当从多个线程访问对象时，一次访问可能会更改对象，您需要一些同步。对于所描述的场景，您可能希望有一个队列类来执行必要的线程保护和信令。这是一个简单的实现：

```
#include <mutex>
#include <condition_variable>
#include <deque>

template <typename T>
class queue
{
private:
    std::mutex              d_mutex;
    std::condition_variable d_condition;
    std::deque<T>           d_queue;
public:
    void push(T const& value) {
        {
            std::unique_lock<std::mutex> lock(this->d_mutex);
            d_queue.push_front(value);
        }
        this->d_condition.notify_one();
    }
    T pop() {
        std::unique_lock<std::mutex> lock(this->d_mutex);
        this->d_condition.wait(lock, [=]{ return !this->d_queue.empty(); });
        T rc(std::move(this->d_queue.back()));
        this->d_queue.pop_back();
        return rc;
    }
}; 
```

该代码使用 C++ 2011 结构，但可以轻松更改以避免使用它们，而改为使用 C++ 2003 结构，除非这些结构不是标准化的。

关键点是：

1.  A`std::mutex`用于确保一次只有一个线程访问队列。
2.  当将某些东西放入队列时，会获取互斥锁上的锁并将对象插入队列中。插入对象后，锁会自动释放，并发出条件变量信号。
3.  当从队列中提取某些东西时，会获取互斥锁上的锁，并且线程使用条件变量等待队列非空：如果队列中已经有东西，则条件将`true`立即`wait()`返回，否则线程进入睡眠状态，直到它收到一个信号，此时重新评估条件。请注意，条件可能会被多次评估，因为条件变量可能会被虚假唤醒。
4.  lambda 通过值捕获其上下文：它真正捕获的只是`this`; 成员变量不能直接被捕获，因为它们不是本地上下文的一部分。
5.  结果 from`pop()`是按值返回的：在锁被释放的那一刻，容器可能会发生变化，使得无法通过引用返回对象，即使它们被放置在合适的位置。

这有点像一个玩具示例的主要原因是它没有关闭系统的好方法：如果一个线程在队列中被阻塞，它会等待直到有另一个对象。一个真正的实现会有某种方式来表明是时候关闭了，可能会从`pop()`. 此外，有时使用不强制阻塞提取对象的队列很有用。相反，它会有一个`try_pop()`获取锁的函数，检查队列是否为非空，并根据结果提取和对象或信号失败。不过，这样的功能很容易实现。

# bash - 如何使用 Bash 查找 gid ！= 固定 uid 的文件？

> ID：12772230
> 
> 赞同：1
> 
> 时间：2012-10-07T19:43:35.443
> 
> 标签：bash, comparison, find

我确信这是非常基本的，但我还没有弄清楚——你将如何使用 Bash 来查找文件 gid 与其 uid 不同的目录中的所有文件？我试过了...

```
find $dir -user $uid -group !=$uid 
```

......当它不起作用时并不感到惊讶。我还没有尝试过使用 Bash 的单个命令，但也许是时候了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T19:52:04.937

您可以尝试以下方法：

```
find . \( -uid $UID -a ! -group $UID \) -type f -ls 
```

# sql - 在 SQL 表中移动数据

> ID：12772233
> 
> 赞同：4
> 
> 时间：2012-10-07T19:43:56.950
> 
> 标签：sql, stored-procedures, shift

我有一个包含列的表

```
ID,
Variant (INT), 
A1.....A20 (VARCHAR(16)) 
```

谁能推荐将列中的数据从 X 开始向右移动的最佳方法，其中 X 是参数，列 Variant 等于 Y（第二个参数）。

因此，我将不胜感激任何有关以 X 和 Y 作为参数并将数据从 Ax 开始的列中向右移动的存储过程的帮助，其中 Variant 等于 Y。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T19:51:17.507

你可以 ：

1.  从现有表创建一个新表，列移动：

    CREATE TABLE my_new_table AS SELECT A20,19... FROM original_Table;

2.  丢掉原来的

3.  将这个新的重命名为原始表名

# python - 如何在 Python 中播放矢量？

> ID：12772235
> 
> 赞同：2
> 
> 时间：2012-10-07T19:44:01.630
> 
> 标签：python, matlab, audio, vector

> **可能重复：**
> [从存储在数组中的波形播放声音](https://stackoverflow.com/questions/8707967/playing-a-sound-from-a-wave-form-stored-in-an-array)

我正在尝试在 Python 中生成一个包含正弦波的向量（或类似的数据结构）并在不将任何内容记录到磁盘的情况下播放它。

有点像下面的 MATLAB 代码：

```
t = 0:1/8000:1;              % Generate a 1 second vector at a sampling rate of 8000 Hz
wave = sin(2*pi*440*t);      % Store a 440 Hz sine wave
sound(wave, 8000);           % Play the waveform 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T22:12:48.253

您可以使用内置`map`函数创建波形；

```
import math
t = range(8001)
wave = map(lambda x: math.sin(2 * math.pi * 440 * x), t) 
```

对于播放声音，我建议使用[ossaudiodev](http://docs.python.org/library/ossaudiodev.html)或[winsound](http://docs.python.org/library/winsound.html)，具体取决于您的平台。

您可能必须将`wave`数组缩放为 bytearray 或合适类型的 numpy 数组，以便音频设备可以消化它。

# android - 确定 Android 设备的相机高度和宽度

> ID：12772243
> 
> 赞同：2
> 
> 时间：2012-10-07T19:44:26.097
> 
> 标签：android, android-camera

我试图考虑一个解决方案，即应用程序的屏幕尺寸在不同屏幕尺寸的设备上是灵活的。我想到了获取设备的相机高度和宽度。是否有我们可以在 Java 中调用的函数来获取设备相机的高度和宽度，并且返回的值将分配给变量 CAMERA_WIDTH 和 CAMERA_HEIGHT？或有什么方法吗？除了用实数分配它。谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T20:50:08.037

这是一种方式：

```
Camera.Parameters params = mCamera.getParameters(); // mCamera is a Camera object
List<Camera.Size> sizes = params.getSupportedPreviewSizes();

// position: variable where you choose between different supported resolutions, 
// this varies from phone to phone, even the order can be different, 
// ex. ascending or descending order.

mFrameWidth = (int) sizes.get(position).width;
mFrameHeight = (int) sizes.get(position).height;

params.setPreviewSize(mFrameWidth, mFrameHeight);
mCamera.setParameters(params); 
```

# ios - 获取从 NSInvocationOperation 返回的结果

> ID：12772246
> 
> 赞同：1
> 
> 时间：2012-10-07T19:44:34.960
> 
> 标签：ios, nsinvocation, nsinvocationoperation

```
- (void)viewDidLoad
{        
    NSOperationQueue *operationQueue = [[NSOperationQueue alloc]init];        
    NSInvocationOperation *downloadImageOperation = [[NSInvocationOperation alloc] initWithTarget:[ImageDownloader getInstance]
                                                                            selector:@selector(downloadImageSync:)
                                                                              object:@"image url"];
    [operationQueue addOperation:downloadImageOperation];        
    UIImage *imag = [downloadImageOperation result]; // image is always nil here
    imageVIEW.image = imag;
} 
```

**返回调用或方法的结果。- (id)result 返回值 方法返回的对象，如果不是对象，则返回包含返回值的 NSValue 对象。如果方法或调用未完成执行，则此方法返回 nil。**

我总是得到`nil`图像。上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:19:31.447

对 a 的操作在`NSOperationQueue`单独的线程上执行。调用时操作尚未执行完毕`[downloadImageOperation result]`，因此结果为`nil`.

例如，您可以在`downloadImageSync:`方法结束时分配图像视图，但必须在主线程上完成：

```
dispatch_async(dispatch_get_main_queue(), ^{
    imageVIEW.image = imag;
}); 
```

# ios - 当两者都显示在同一图表中时，如何将散点图放在条形图的前面

> ID：12772247
> 
> 赞同：0
> 
> 时间：2012-10-07T19:44:35.540
> 
> 标签：ios, ipad, core-plot

我在IOS上使用coreplot。我在同一张图中显示了散点图和条形图。当它们显示时，条形图位于屏幕顶部，因此我无法真正看到后面的散点图。我想将散点图放在前景中。

我怎样才能做到这一点？

见我下面的代码。任何帮助将不胜感激

```
 // Create barChart from theme
barChart = [[CPTXYGraph alloc] initWithFrame:CGRectZero];
CPTTheme *theme = [CPTTheme themeNamed:kCPTDarkGradientTheme]; //  
[barChart applyTheme:theme];

theHostingView.hostedGraph = barChart;

// Border
barChart.plotAreaFrame.borderLineStyle = nil;
barChart.plotAreaFrame.cornerRadius    = 0.0f;

// Paddings
barChart.paddingLeft   = 0.0f;
barChart.paddingRight  = 0.0f;
barChart.paddingTop    = 0.0f;
barChart.paddingBottom = 0.0f;

// Offset pour placer les coordoonees du graph
barChart.plotAreaFrame.paddingLeft   = 70.0;
barChart.plotAreaFrame.paddingTop    = 20.0;
barChart.plotAreaFrame.paddingRight  = 15.0;
barChart.plotAreaFrame.paddingBottom = 35.0;

// Graph title
[self configureTitle];

// Add plot space for horizontal bar charts
_plotSpace = (CPTXYPlotSpace *)barChart.defaultPlotSpace;

float minAxis = 0.0;
if ([_theKPI.unit isEqualToString:@"%"]) {
    float intervalSize = ((_maxValue - minAxis)/100.0)/4;

    minAxis = _minValue - intervalSize;
    if (minAxis <= 0) {
        minAxis = 0.0;
    }

    _plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(minAxis/100.0) length:CPTDecimalFromFloat((_maxValue - minAxis)/100.0)];

} else {

    if (_minValue >= 0) {
        _plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0) length:CPTDecimalFromFloat(_maxValue)];
    } else {
        _plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0) length:CPTDecimalFromFloat(_minValue)];
    }
}

CPTXYAxis* xAxis = [[CPTXYAxis alloc] initWithFrame:CGRectZero];
CPTXYAxis* yAxis = [[CPTXYAxis alloc] initWithFrame:CGRectZero];
xAxis.plotSpace = _plotSpace;
yAxis.plotSpace = _plotSpace;

[self configureXAxis:xAxis min:minAxis plotSpace:_plotSpace];
[self configureYAxis:yAxis min:minAxis];

CPTXYPlotSpace* secondPlotSpace = [[CPTXYPlotSpace alloc] init];
secondPlotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0) length:CPTDecimalFromFloat(50.0)];
[self configurePlotSpace:secondPlotSpace];

[barChart addPlotSpace:secondPlotSpace];

CPTXYAxis* yRightAxis = [[CPTXYAxis alloc] initWithFrame:CGRectZero];
yRightAxis.plotSpace = secondPlotSpace;
[self configureYRightAxis:yRightAxis];

barChart.axisSet.axes = [NSArray arrayWithObjects:xAxis, yAxis, yRightAxis, nil];

// Configure the Scatter Plot
_plot = [[CPTScatterPlot alloc] init];
_plot.dataSource = self;
_plot.identifier = @"mainplot";

CPTMutableLineStyle *lineStyle = [CPTMutableLineStyle lineStyle];
lineStyle.lineColor = [CPTColor whiteColor];
lineStyle.lineWidth = 3.0f;
_plot.dataLineStyle = lineStyle;

CPTPlotSymbol* greenCirclePlotSymbol = [CPTPlotSymbol ellipsePlotSymbol];
greenCirclePlotSymbol.fill = [CPTFill fillWithColor:[CPTColor blueColor]];
greenCirclePlotSymbol.size = CGSizeMake(5.0, 5.0);
_plot.plotSymbol = greenCirclePlotSymbol;

// Configure the Bar Plot
_barPlot = [CPTBarPlot tubularBarPlotWithColor:[CPTColor blueColor] horizontalBars:NO];
_barPlot.baseValue  = CPTDecimalFromString(@"0");
_barPlot.dataSource = self;
_barPlot.delegate = self;
_barPlot.barOffset  = CPTDecimalFromFloat(-0.25f);
_barPlot.identifier = @"Bar Plot 1";

[barChart addPlot:_plot toPlotSpace:secondPlotSpace];
[barChart addPlot:_barPlot]; 
```

赛博。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T13:01:52.847

最后添加到图表中的图将显示在前面：

```
[barChart addPlot:_barPlot];
[barChart addPlot:_plot toPlotSpace:secondPlotSpace]; 
```

# c++ - C++ 从文件读取到链表给出 EXC_BAD_ACCESS

> ID：12772251
> 
> 赞同：-3
> 
> 时间：2012-10-07T19:44:53.847
> 
> 标签：c++, linked-list, exc-bad-access, getline

大家好，我正在尝试将旧代码从 C 传输到 C++ 以进行分配……我必须手动实现一个链表，所以我不能使用 STL 容器，否则我已经完成了这个……

这是我的链接列表：

```
#include <iostream> 
#include <string>
#include <fstream>
using namespace std;

struct Video { 
char video_name[1024];      //  video name
int ranking;                // Number of viewer hits
char url[1024];             //  URL
Video *next;  // pointer to Video structure
}  *head = NULL;        // EMPTY linked list 
```

这是读入的代码：

```
void load()
{
struct Video *temp;
temp = (Video*)malloc(sizeof(Video)); //allocate space for node 
temp = head;
ifstream myfile ("Ranking.dbm");
if (myfile.is_open())
{
    string line;
    while ( myfile.good() )
    {

        myfile.getline(temp->video_name,1024);
        myfile >> temp->ranking;
        getline(myfile, line); // need to skip 'ranking's
                                // unread new-line
        myfile.getline(temp->url,1024);
        temp = temp->next; 

    }
    head = NULL;
    myfile.close();
}

else cout << "Unable to open file"; 

return ;

} 
```

它正在从如下所示的文本文件中读取`Ranking.dbm`：

```
bagheera
20
bagheera.com
sushi
60
sushi.com
wicket
99
wicket.com
teek
100
teek.com 
```

基本上每组 3 行都应该加载到一个`Video`结构中，该结构将成为链表中的一个新节点。

由于我无法控制的情况，我在这个项目中使用 XCode。我的问题是为什么我会收到这个错误。我认为 EXC_BAD_ACCESS 主要是一个 Objective-C 错误......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:04:53.597

在您的 load() 函数中，您分配一个节点，读取数据以填充节点，然后分配`temp = temp->next`. 但是，`temp->next`没有初始化，所以很可能指向一个随机地址。

# c - Linux内核编码风格

> ID：12772253
> 
> 赞同：23
> 
> 时间：2012-10-07T19:45:13.493
> 
> 标签：c, linux, coding-style, linux-kernel

我是内核编程的新手，所以我想知道哪种编码风格更容易接受。例如，在错误处理的情况下，以下哪个更好？

这个：

```
/* some stuff */
if(error) {
    /* error handling */
    return -(errorcode);
}
/* normal actions */ 
```

或者这个：

```
/* some stuff */
if(!error) {
    /* normal actions */
} else {
    /* error handling */
    return -(errorcode);
} 
```

我在哪里可以找到任何关于内核编码标准的文档？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-07T19:50:05.453

Linux 内核有一个编码风格指南：

[https://www.kernel.org/doc/Documentation/process/coding-style.rst](https://www.kernel.org/doc/Documentation/process/coding-style.rst)

[更好的格式化版本](https://www.kernel.org/doc/html/latest/process/coding-style.html)

关于你的例子，我个人更喜欢第一种风格。使用第二种风格，你很快就会违反这个 Linux 内核风格规则（内核风格有 8 个字符的缩进）：

> 如果您需要超过 3 级的缩进，那么无论如何您都搞砸了，应该修复您的程序。

从上到下（而不是水平）编写代码有时被称为*duffing*。我可以建议您阅读有关该主题的出色读物：

[从上到下阅读代码](http://iq0.com/notes/deep.nesting.html)

# javascript - AngularJS：使用 Shared Service(with $resource) 在控制器之间共享数据，但是如何定义回调函数？

> ID：12772255
> 
> 赞同：7
> 
> 时间：2012-10-07T19:45:24.223
> 
> 标签：javascript, angularjs

注意：我还在 AngularJS 邮件列表中发布了这个问题：[https ://groups.google.com/forum/#!topic/angular/UC8_pZsdn2U](https://groups.google.com/forum/#!topic/angular/UC8_pZsdn2U)

大家好，

我正在构建我的第一个 AngularJS 应用程序，并且对 Javascript 不是很熟悉，因此非常感谢任何指导:)

我的应用程序有两个控制器，ClientController 和 CountryController。在 CountryController 中，我从使用 $resource 对象的 CountryService 检索国家列表。这很好用，但我希望能够与 ClientController 共享国家/地区列表。经过一番研究，我读到我应该使用 CountryService 来存储数据并将该服务注入两个控制器。

这是我之前的代码：

国家服务：

```
services.factory('CountryService', function($resource) {
    return $resource('http://localhost:port/restwrapper/client.json', {port: ':8080'});
}); 
```

国家控制器：

```
//Get list of countries         
//inherently async query using deferred promise
$scope.countries = CountryService.query(function(result){       
        //preselected first entry as default
    $scope.selected.country = $scope.countries[0];  
}); 
```

在我更改之后，它们看起来像这样：

国家服务：

```
services.factory('CountryService', function($resource) {
    var countryService = {};

    var data;
    var resource = $resource('http://localhost:port/restwrapper/country.json', {port: ':8080'});

    var countries = function() {
        data = resource.query();
        return data;
    }

    return {
        getCountries: function() {
            if(data) {
                console.log("returning cached data");
                return data;
            } else {
                console.log("getting countries from server");
                return countries(); 
            }

        }
    };
  }); 
```

国家控制器：

```
$scope.countries = CountryService.getCountries(function(result){
        console.log("i need a callback function here...");
}); 
```

* * *

问题是我以前能够使用 $resource.query() 中的回调函数来预选默认选择，但是现在我已经将 query() 调用移到了 CountryService 中，我似乎失去了什么.

解决这个问题的最佳方法是什么？

谢谢你的帮助，肖恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T21:34:43.157

好的..所以看起来我通过将回调函数一直传递到 resource.query() 调用解决了这个问题。仍然不确定这是否是最好的方法。

作为参考，这就是我所做的：

国家控制器：

```
$scope.countries = CountryService.getCountries(function(){
    //preselected default
    $scope.selected.country = $scope.countries[0];  
}); 
```

国家服务：

```
//Country Service. Will contain all relevant rest methods here
services.factory('CountryService', function($resource) {
    var countryService = {};

    var data;
    var resource = $resource('http://localhost:port/restwrapper/country.json', {port: ':8080'});

    var countries = function(callback) {
        data = resource.query(callback);
        return data;
    }

    return {
        getCountries: function(callback) {
            if(data) {
                console.log("returning cached data");
                return data;
            } else {
                console.log("getting countries from server");
                return countries(callback); 
            }

        }
    };
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T14:50:48.107

你应该看看[$q 服务](http://docs.angularjs.org/api/ng.%24q)，你可以这样做：

```
promise.then(callback); 
```

从 1.1.3 开始，您可以使用 访问 Promise `$then`，例如`resource.query().$then(callback);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T10:39:52.000

在这个新场景中，您可以使用 $scope.$watch。您使用它的方式如下。

```
$scope.countries = CountryService.getCountries();

$scope.$watch('countries',function(newValue){
//need to check if newValue has a value because 
//the first time watch fires it will be undefined.
    if(newValue && newValue.length > 0 ){
        $scope.selected.country = $scope.countries[0];
    }
}); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-28T20:43:02.650

AngularJS 有它自己的缓存查询方式，你应该使用它。至于回调，将查询分配给变量是没有用的，因为无论如何都会返回一个承诺。你应该总是期待一个承诺，并在成功或最终传递你的回调。

# android - Android 预取 Webview

> ID：12772262
> 
> 赞同：0
> 
> 时间：2012-10-07T19:45:46.267
> 
> 标签：android, performance, webview, prefetch

我正在为 Android 创建一个“每日 ....”应用程序。（比方说“每日鲜花”）这个想法是：你每天都会收到一个通知，当你点击它时，它会向你显示一张鲜花的图片+一些文字。我想从一个网站分发这个。

我可以使用执行 loadUrl 的 WebView 创建一个通知和一个 Intent 到一个活动。但是，这太慢了！（需要 1 到 5 秒，具体取决于网络。）

所以我想预取“整个站点”（1 个 HTML 文件，1 个图像），然后创建通知，以便应用程序可以快速显示每日鲜花。

这可以轻松完成吗？我可以用 HttpClient 等硬方式做到这一点，但我宁愿使用 WebView.saveState 之类的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T09:57:24.107

我尝试了 saveState 并将生成的包存储到一个文件中。效果不好，因为它只保存元状态（历史、加载的 url 等）而不是实际内容（html、图像）。

我最终使用的解决方案是服务器端 hack：将所有图像作为 base64 编码实体包含在 html 文件中。这样您就可以使用 downloadManager 并在 WebView 中显示下载的文件。当然，这仅在您也可以完全控制服务器时才有效。

# ios - UILabel 在向左滑动时调整大小（使用自动布局和代码）

> ID：12772264
> 
> 赞同：1
> 
> 时间：2012-10-07T19:45:51.780
> 
> 标签：ios, uitableview, ios6, autolayout

当我滑动删除`UITableCell`子类（`ExpenseCell`）时，我正在调整大小：

![截屏](../Images/17ab513f05814a7260871bb2117670b9.png)

`UILabels`这是我用来根据内容调整大小的一段代码：

```
-(void)layoutSubviews{
    [super layoutSubviews];

    NSInteger leftMargin = 0;

    if (![descriptionLabel.text isEqualToString:@""]){
        leftMargin = 15;
    }

    CGSize descriptionLabelSize = [descriptionLabel.text sizeWithFont:descriptionLabel.font];
    CGRect descriptionLabelRect = CGRectMake(descriptionLabel.frame.origin.x,
                                         descriptionLabel.frame.origin.y,
                                         descriptionLabelSize.width,
                                         descriptionLabelSize.height);
    descriptionLabel.frame = descriptionLabelRect;

    CGSize categoryLabelSize = [categoryLabel.text sizeWithFont:categoryLabel.font];
    CGRect categoryLabelRect = CGRectMake(descriptionLabel.frame.origin.x + descriptionLabel.frame.size.width + leftMargin,
                                      categoryLabel.frame.origin.y,
                                      categoryLabelSize.width,
                                      categoryLabelSize.height);
    categoryLabel.frame = categoryLabelRect;
} 
```

如果我评论上面的代码，我没有这个问题，但我失去了 autoresizing `UILabels`。

你们是否知道如何`AutoLayout`通过在现有代码上添加约束或更改现有代码来解决此问题？

提前致谢！

# android - Android VM 作为开发模拟器

> ID：12772267
> 
> 赞同：3
> 
> 时间：2012-10-07T19:46:24.910
> 
> 标签：android, eclipse, virtualbox, virtual-machine

我已经下载了 Android VM (http://osxdaily.com/2010/08/27/download-android-os-to-run-in-a-virtual-machine/) 并在 VirtualBox 中运行它。
这工作正常。

我想在 Eclipse 中编写我的应用程序，当我必须对其进行测试时，我希望您使用 Android VM 作为我的模拟器，而不是默认的模拟器。

当我启动 Android VM 时，我的互联网正在工作，但我现在的问题是如何将 Eclipse 附加到 Android VM？

基本上：
Eclipse > 运行应用程序 > 在 Android VM 中启动（而不是 Android AVD）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T19:59:40.803

您需要通过打开终端并键入以下命令将其连接到 adb（位于 android SDK 的平台工具文件夹中）：

```
adb connect <ip_address_of_the_vm> 
```

要找出 VM 的 IP 地址，请在 android VM 上安装终端模拟器并键入：

```
ifconfig 
```

# c# - 如何在 C# 中为构造函数使用多线程

> ID：12772269
> 
> 赞同：1
> 
> 时间：2012-10-07T19:46:27.683
> 
> 标签：c#, multithreading, constructor

我有一个应用程序，它基本上做 2 个工作：

> a) 解析 XML（大量内容）并序列化/反序列化为类对象，并对获得的数据进行一些数学运算
> 
> b) 通过解析多个文件/目录来填充 UI。

两者都是独立的任务。由于这里的执行时间很长，我想在我的表单中使用多线程，在这里我调用另一个类的构造函数（执行 XML 解析和操作）。你能指导如何做到这一点吗？

```
public partial class Form1: Form
{
public Binarylist bList = new Binarylist(); //parses the XML and does multiple operations
........
.......
private Form1_Load(object sender, EventArgs e)
{
........ //populates UI by parsing files & directories
} 
```

我的问题在这里 - 我如何多线程 Binarylist 构造函数，以便我也在主线程上并行执行 form1_load？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T19:56:19.053

使用后台工作者。

将构造的列表传递给 Completed 事件并将其分配给那里的 formclass 字段。

`bList == null`确保在适当的时候检查表格的其余部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:24:58.163

您可以按照以下步骤在后台线程上生成 BinaryList：

1.  创建一个调用 BinaryList 构造函数的方法

    ```
    private void getBinaryList()
    {
    bList = new BinaryList();
    } 
    ```

2.  在执行任何其他操作之前在表单开始加载时启动新线程执行：

    ```
    private Form_Load(object sender, EventArgs e)
    {
    Thread t = new Thread(new ThreadStart(getBinaryList));
    t.Start();

    // do your stuff

    t.Join();
    //this ensures both threads complete before event execution finishes
    } 
    ```

如果这两项工作都很耗时，我建议不要锁定 UI 线程，因为您的应用程序将变得无响应，因此我将在后台线程上执行并在之后更新您的 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T06:22:01.143

最简单的解决方案是使用[任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)：

```
public partial class Form1: Form
{
    private readonly Task<Binarylist> bList = 
        Task.Factory.StartNew(() => new Binarylist());

    private Form1_Load(object sender, EventArgs e)
    {
        // Get the result of the task when needed
        var constructedList = bList.Result;

        // ...
    }
} 
```

访问[`Task.Result`](http://msdn.microsoft.com/en-us/library/dd321468.aspx)将等待构造完成，然后为您提供完全构造的对象。可以说，您的`Binarylist`班级可以使用任务来进行昂贵的初始化。

# android - actionbar 和 tabhost/tabactivity 有什么区别

> ID：12772270
> 
> 赞同：8
> 
> 时间：2012-10-07T19:46:31.367
> 
> 标签：android, android-tabhost, android-actionbar

快速提问，actionbar 和 tabhost 有什么区别。我曾经使用 tabhost 并向其添加标签。

然后我被要求使用操作栏并阅读它，这似乎只是另一种使用选项卡的方式。那么什么时候使用每个？有什么不同

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-07T19:57:38.853

很简单：ActionBar 是自 Android 3.0 以来 TabHost 的替代品。

此外，ActionBar 可以比 TabHost 做更多的事情（比如作为按钮的徽标、微调器、操作按钮……）。

查看有关 Android 设计指南的[ActionBar 文档。](http://developer.android.com/design/patterns/actionbar.html)

# android - 指定的孩子已经有父母

> ID：12772273
> 
> 赞同：0
> 
> 时间：2012-10-07T19:47:26.500
> 
> 标签：android, android-fragments, android-actionbar, android-tabs

这个问题已经在这里被问过很多次了，但是我找不到任何帮助。我正在编写一个 android 应用程序，并且似乎在 ActionBar 上创建选项卡时遇到了问题。我一直在寻找问题几个小时，但似乎找不到解决方案，但我想我确实找到了根源。我什至清空了实现只是为了获得一些结果并在它们的基础上进行构建，但可惜我什么也没找到。

这是选项卡片段的创建并插入到操作栏

```
 // put ActionBar to nav. mode
    ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    // init "YES" tab
    Fragment yesTabFragment = Fragment.instantiate(this, YesTabFragment.class.getName());
    FlowTabListener yesTabListener = new FlowTabListener(yesTabFragment);
    ActionBar.Tab yesTab = actionBar.newTab().setText("YES").setTabListener(yesTabListener);
    actionBar.addTab(yesTab); 
```

这是该类的 onCreateView 方法

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
{
    _fragmentView =  inflater.inflate(R.layout.yes_fragment, container);    
} 
```

这是片段 XML 布局

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          xmlns:tools="http://schemas.android.com/tools"
          android:layout_width="match_parent"
          android:layout_height="match_parent"
          android:orientation="vertical" >

    </LinearLayout> 
```

正如你所看到的，实现是空的，我没有在这个时间之前（而不是之后）实例化这个片段但是我得到这个错误：

```
E/AndroidRuntime(2995): FATAL EXCEPTION: main
E/AndroidRuntime(2995): java.lang.RuntimeException: Unable to start activity ComponentInfo{activities.MainActivity}:    
java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the child's parent first. 
```

我认为这与将选项卡添加到操作栏有关，因为当我注释掉`actionBar.addTab()`应用程序确实运行时（显然没有选项卡）

我真的很想知道如何解决这个问题。

谢谢各位大佬

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T19:52:32.347

的第二个参数`inflate()`是默认父级：

```
_fragmentView =  inflater.inflate(R.layout.yes_fragment, container); 
```

将此行更改为：

```
_fragmentView =  inflater.inflate(R.layout.yes_fragment, null); 
```

# ruby-on-rails - 是否有验证或方法来检查并只允许两个实体使用一个值？

> ID：12772274
> 
> 赞同：-1
> 
> 时间：2012-10-07T19:47:42.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, ruby-on-rails-3.2

是否有验证来检查该实体是否已经存在值。如果有，那么它不会让用户在不破坏前一个值的情况下保存另一个值。

我可以显示一条消息，用户必须在创建新值之前销毁以前的值。这不是问题。

问题是**是否有验证或方法来检查并只允许两个实体使用一个值**？

我有两个字段长度和宽度，我只希望有一个长度值和一个宽度值。

非常感谢您阅读这个问题。我很感激我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:44:43.287

前面的答案将确保 :field1 和 :field2 值的组合是唯一的。我很难理解这个问题，但我认为 abhishek 实际上是在寻找一个更简单的答案。

我相信他想确保只有一个长度值和一个宽度值。

是长宽关联吗？还是属性？无论哪种情况，您可能都不需要打电话`destroy`来更换它们。只需更改属性或关联内的值，然后保存。

你能澄清一下吗？

* * *

好的，所以根据您的 Grid 模型，这些字段的值永远不会超过一个。您可以在初始成功验证后将[记录标记为只读。](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#method-i-readonly-21)然后，无论何时用户尝试更新该值，都会出现验证错误。您将需要编写一些简单的逻辑来覆盖 readonly 标志以满足您的需要。

现在，如果您总是想在存在值的情况下触发验证错误，那么您可以执行以下操作：

```
validate :error_if_length_exists, :if 'length.present?'
validate :error_if_breadth_exists, :if 'breadth.present?'

def error_if_length_exists
  errors.add(:length, "already exists, are you sure you want to update?")
end

def error_if_breadth_exists
  errors.add(:breadth, "already exists, are you sure you want to update?")
end 
```

* * *

我想你想使用`unless`：

```
def is_it_square
  unless (length == breadth)
     errors.add(:length, "Latest research and our experience shows that a rectangular region is more effective for this kind of mission.")
  end  
end 
```

您还可以像这样确定验证范围： `validates :length, :breadth, :presence_of => true, :on => :create`仅在`presence_of`首次创建记录时应用检查。

似乎您可能希望对 :create 与 :update 进行不同的验证。

* * *

我想我肯定误解了您要解决的问题。几个建议。

1.  我认为您不应该要求用户输入两个值，如果您要在它们不同时简单地添加一个错误。可用性的解决方案是在输入附近添加错误文本（'我们发现正方形是最佳形状......'），让用户输入一个属性（如果你真的不需要长度和宽度，如果它们总是代表相同的值），并将您的计算更改为该值的平方，而不是乘以长度 * 宽度。
2.  如果您需要长度/宽度，您能否更清楚地解释问题。假设您有一个表单或接口，它记录了给定模型的 :length 和 :breadth 属性。您还没有模型的实例。这是用户第一次与您的系统交互。输入作为请求的一部分发送到您的控制器，然后您创建一个具有有效 :length 和 :breadth 值的对象。随后，用户想要更改:length 和:breadth。您想创建一个包含 :length/:breadth 的模型的新实例，还是要更新现有模型实例的 :length/:breadth 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:04:30.390

您可以使用[`validates_uniqueness_of`](http://ar.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#M000086)内置验证，并带有以下`:scope`选项：

```
validates_uniqueness_of :length, :scope => :breadth 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T20:04:58.847

如果我理解正确，您需要提供 2 个字段的唯一性组合。

然后以`users`表格为例

**模型.rb**

```
validates :field1, uniqueness: { :scope => :field2} 
```

**安慰**

```
rails generate migration add_index_for_field1_and_field2_to_users 
```

**编辑迁移**

```
class AddIndexFoField1AndField2ToUsers < ActiveRecord::Migration
  def change
    add_index :users, [:field1, :field2], unique: true
  end
end 
```

运行迁移

```
rake db:migrate 
```

瞧！

**更新**

如何检查您是否正确。

**安慰**

```
Model.create!(field1:"foo",field2:"bar") # true
Model.create!(field1:"foo",field2:"bar") # ActiveRecord::RecordInvalid: Validation failed: Field1 has already been taken 
```

**sql数据库**：

```
insert into table(field1, field2) values ("foo","bar") # true
insert into table(field1, field2) values ("foo","bar") # ERROR: diplicate key value violates unique constraint "index_table_on_field1_and_field2" 
```

# php - 如果输入值为数字/数字则显示图像，如果输入值不是数字则显示文本，如果输入值为 0 则不显示

> ID：12772278
> 
> 赞同：0
> 
> 时间：2012-10-07T19:47:59.430
> 
> 标签：php, input, user-input

我一直在尝试为此定制一部分 PHP 脚本。

如果输入值是数字（1、3、20、99 等），我希望它显示图像。否则，如果输入值是文本（lorem、randomtext 等），我希望它显示文本。如果值为 0，我希望它不显示任何内容。

但我一直弄错。无论输入值是什么，它总是显示文本。

这是PHP代码：

```
if ( $topic['topic_icon']     = $topic['icon_id']  ) {
                if (is_numeric($topic['icon_id'])) {
                "<img src='".$ibforums->vars['img_url']."/icon{$topic['icon_id']}.gif' alt='{$topic['icon_id']}' />";
                } else {
                "<span class='text-icon {$topic['icon_id']}'>{$topic['icon_id']}</span>";
                }
            } else {
             "";
             } 
```

这是 HTML 的一部分，用户可以在其中输入值（它带有单选按钮，`<form />`不包括标签，因为它是大量代码的一部分）：

```
<input type="radio" class="radiobutton" name="iconid" value="15" />&nbsp;&nbsp;<img src="{$ibforums->vars['img_url']}/icon15.gif"  align='middle' alt='' />
<input type="radio" class="radiobutton" name="iconid" value="16" />&nbsp;&nbsp;<img src="{$ibforums->vars['img_url']}/icon16.gif"  align='middle' alt='' />
<input type="radio" class="radiobutton" name="iconid" value="17" />&nbsp;&nbsp;<img src="{$ibforums->vars['img_url']}/icon17.gif"  align='middle' alt='' /><br />
<input type="radio" class="radiobutton" name="iconid" value="SPRING" />&nbsp;&nbsp;<span class='text-icon SPRING'>SPRING</span>
<input type="radio" class="radiobutton" name="iconid" value="SUMMER" />&nbsp;&nbsp;<span class='text-icon SUMMER'>SUMMER</span>
<input type="radio" class="radiobutton" name="iconid" value="AUTUMN" />&nbsp;&nbsp;<span class='text-icon AUTUMN'>AUTUMN</span>
<input type="radio" class="radiobutton" name="iconid" value="WINTER" />&nbsp;&nbsp;<span class='text-icon WINTER'>WINTER</span><br />
<input type="radio" class="radiobutton" name="iconid" value="0" checked="checked" />&nbsp;&nbsp;[ Use None ] 
```

MySQL 表中使用的列 (it's `icon_id`) 设置为`varchar(64)`.

我为长标题道歉...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T19:50:55.900

您的初始 IF 条件包含一个 =，这不是比较运算符，但应该是 ==

```
if ( $topic['topic_icon'] == $topic['icon_id']  ) { 
```

然后你似乎错过了 echo 命令：

```
 if (is_numeric($topic['icon_id'])) {
            echo "<img src='".$ibforums->vars['img_url']."/icon{$topic['icon_id']}.gif' alt='{$topic['icon_id']}' />";
            } else {
            echo "<span class='text-icon {$topic['icon_id']}'>{$topic['icon_id']}</span>";
            }
} else {
        echo  "";
         } 
```

您没有指定如何设置 $topic 数组的内容。可能的错字是单选按钮名称`iconid`，但`$topic['icon_id']`（带 _）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:04:30.643

好吧，我知道我不应该在困倦时尝试编码......这纯粹是我的愚蠢。

这是原始代码：

```
$topic['topic_icon']     = $topic['icon_id']
                          ? "<img src='".$ibforums->vars['img_url']."/icon{$topic['icon_id']}.gif' alt='{$topic['icon_id']}' />&nbsp;&nbsp;"
                          : ""; 
```

我应该先取消快捷方式。如果没有三元运算符快捷方式，它应该写成这样：

```
if ( $topic['icon_id'] ) {
                $topic['topic_icon'] =  "<img src='".$ibforums->vars['img_url']."/icon{$topic['icon_id']}.gif' alt='{$topic['icon_id']}' />&nbsp;&nbsp;";
        } else {
                $topic['topic_icon'] = "";
        } 
```

然后，为了实现我所需要的，它只需要一点额外的`IF`：

```
if ( $topic['icon_id'] ) {
            if (is_numeric($topic['icon_id'])) {
                $topic['topic_icon'] =  "<img src='".$ibforums->vars['img_url']."/icon{$topic['icon_id']}.gif' alt='{$topic['icon_id']}' />&nbsp;&nbsp;";
            } else {
                $topic['topic_icon'] =  "<span class='text-icon {$topic['icon_id']}'>{$topic['icon_id']}</span>";
            }
        } else {
                $topic['topic_icon'] = "";
        } 
```

达达，就像一个魅力。不确定这是否是最佳实践（我觉得可以做得更好）。但它仍然有效。

感谢@jtheman，因为他的回答暗示了我做错了什么，特别感谢@JohnT（[https://stackoverflow.com/a/1080257](https://stackoverflow.com/a/1080257)）让我意识到我做错了什么。

# android - android：如何从设备获取唯一的联系人，而不是谷歌联系人或 Facebook 联系人

> ID：12772279
> 
> 赞同：3
> 
> 时间：2012-10-07T19:48:07.360
> 
> 标签：android, contact

我正在做一个从电话和 SIM 卡中获取所有联系人的程序。可以选择仅获取电话上的联系人而不是 Google 联系人（或类似联系人）。

我试过了`ContactsContract.Contacts.CONTENT_URI;`。这可行，但同时获取所有联系人以及 Google 联系人和 Facebook 联系人。

我该怎么做？

# matlab - 线性方程的错误解，或者为什么 A*(A\B) 不等于 B？

> ID：12772281
> 
> 赞同：4
> 
> 时间：2012-10-07T19:48:23.107
> 
> 标签：matlab, octave, linear-algebra, numerical-methods, least-squares

下面的结果怎么可能`A*(A\D)`不等于`D`？

![在此处输入图像描述](../Images/542a1c0232eccf3a4cd1e51a0495269c.png)

它应该产生`D`- 这是 Octave 文档的摘录：

> 线性方程组在数值分析中无处不在。要求解线性方程组 Ax = b，请使用左除法运算符 '\'：x = A \ b

以下是想要尝试的人的代码：

```
A = [1,1,1;0,0,0;2,1,2;2,1,2;3,5,6]
D = [1;2;3;4;5]
% A is of rank 3:
rank(A)
% therefore the system Ax=D has a unique solution
x = A\D
% but Octave has not given the good solution:
A*x 
```

有人说我 Matlab 产生完全相同的结果。

**编辑 2012 年 10 月 10 日：**在阅读完答案后，让我指出我犯了一个严重错误的地方：声称*“A 等级为 3，因此系统 Ax=D 具有唯一解”*是绝对错误的！顺便说一句，上面显示的文档非常令人不安。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T10:20:30.333

`A`有 5 行，`D`. 它们都有 3 列。因此，您有一个由 5 个方程和 3 个变量组成的超定系统。在大多数情况下，这意味着您无法准确求解方程，因为您有太多约束。

一旦你这样做

```
x = A\D; 
```

你得到最小二乘解。

```
 0.8333
-1.5000
 1.6667 
```

这是什么解决方案？这是一种最小化误差平方和的解决方案。让我们计算误差：

```
 r = A*x-D;
  totalError = sum( r.^2); 
```

这意味着您将无法找到任何具有较小错误的`x`此类。`sum(sqr(A*x-D))`

小备注：在您的情况下，您还有一行零 - 这导致方程式的实际数量变为 4

让我们再看看`A*(A\D)`：

```
>> A* (A\D)

ans =

    1.0000
         0
    3.5000
    3.5000
    5.0000 
```

这看起来很熟悉！非常接近 [1;2;3;4;5]。第一行和最后一行是相同的。第二个是零，因为你放了一行零。在第 3 行和第 4 行中，A 中的行完全相同，但 B 中的值不同，对应于

```
2*x+ 1*y + 2*z  = 3;
2*x+ 1*y + 2*z  = 4; 
```

你已经得到了他们的平均水平！这是有道理的，因为平均值是将距离总和最小化为 3 和 4 的值。

* * *

这是一个更简单的示例，假设您要求解以下方程组：

```
 x = 1;
   x = 2; 
```

显然，`x`不能`1`同时`2`。最小化误差平方和的解是`1.5`

```
 A = [1;1];
   b = [1;2];
   A\b
   ans =
    1.5000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T10:20:20.740

您的系统`A`是超定的（A 是矩形），因此您[不能完全解决您的系统](http://www.mathworks.se/help/matlab/math/systems-of-linear-equations.html)：

> **矩形矩阵** 如果 A 是矩形，则 mldivide 返回最小二乘解。MATLAB 使用 QR 分解解决超定系统（请参阅 qr）。对于欠定系统，MATLAB 返回具有最大数量的零元素的解。

# matlab - 确定文件是否在matlab中编译（在exe'中）

> ID：12772284
> 
> 赞同：4
> 
> 时间：2012-10-07T19:48:37.793
> 
> 标签：matlab, exe, matlab-deployment, matlab-compiler

所以我有一段 MATLAB 代码，我在 exe 中编译。此 exe 文件供未安装 MATLAB 的人使用。但是原始的 m 文件也被一些高级用户使用。有些功能我无法在编译的 exe 版本中提供。我的问题是我想为 exe 和 m 原始代码维护相同的代码。为了做到这一点，我希望我的代码能够自动检测正在运行的文件是 exe 还是 m 文件，以便我可以简单地使用 if 语句禁用 exe 版本的某些功能。有没有办法做到这一点？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-07T19:53:32.280

我认为您正在寻找[isdeployed](http://www.mathworks.com/help/compiler/isdeployed.html)功能

# ruby-on-rails - 缺少 spree gem，无法安装

> ID：12772285
> 
> 赞同：3
> 
> 时间：2012-10-07T19:48:41.477
> 
> 标签：ruby-on-rails, rubygems, spree

我已经克隆了一个项目的 git 存储库，它正在使用 spree，我想在 localhost 上运行它。

但正如我在一篇文章中所说，我无法安装 spree gem：

```
$ rake gems:install
Missing the Spree 0.10.2 gem. Please `gem install -v=0.10.2 spree`, update your SPREE_GEM_VERSION setting in config/environment.rb for the Rails version you do have installed, or comment out SPREE_GEM_VERSION to use the latest version installed.

$ gem install -v=0.10.2 spree
Successfully installed spree-0.10.2
1 gem installed
Installing ri documentation for spree-0.10.2...
Installing RDoc documentation for spree-0.10.2...

$ script/server
Missing the Spree 0.10.2 gem. Please `gem install -v=0.10.2 spree`, update your SPREE_GEM_VERSION setting in config/environment.rb for the Rails version you do have installed, or comment out SPREE_GEM_VERSION to use the latest version installed.

$ gem list

*** LOCAL GEMS ***

actionmailer (2.3.5)
actionpack (2.3.5)
activemerchant (1.5.1)
activemodel (3.2.8)
activerecord (3.2.8, 2.3.5)
activerecord-tableless (0.1.0)
activeresource (2.3.5)
activesupport (3.2.8, 2.3.5)
arel (3.0.2)
authlogic (3.1.3)
authlogic-oid (1.0.4)
builder (3.0.3)
bundler (1.2.1)
chronic (0.2.3)
faker (0.3.1)
highline (1.5.1)
hoe (3.1.0)
i18n (0.6.1)
less (1.2.20)
multi_json (1.3.6)
mutter (0.5.3)
paperclip (2.3.1.1)
polyglot (0.3.3)
rack (1.1.0, 1.0.1)
rails (2.3.5)
rake (0.9.2.2)
rubygems-bundler (1.1.0)
rvm (1.11.3.5)
searchlogic (2.3.5)
spree (0.10.2)
state_machine (0.8.0)
stringex (1.0.3)
treetop (1.4.10)
tzinfo (0.3.33)
whenever (0.3.7)
will_paginate (2.3.11) 
```

我试图用谷歌搜索这个问题，发现这样的分支：

[https://groups.google.com/forum/?fromgroups=#!topic/spree-user/Fhn_PgFQ6i8](https://groups.google.com/forum/?fromgroups=#!topic/spree-user/Fhn_PgFQ6i8)

但是该解决方案对我不起作用。

这是我的系统：

*   Ubuntu 12.04

*   ruby 1.8.7 (2012-06-29 补丁级别 370) [x86_64-linux]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:38:53.123

你在那里使用的是一个古老版本的 Spree。我们建议使用最新的。请遵循[入门指南](http://guides.spreecommerce.com/getting_started.html)。

# c# - 通过服务方法进行自定义身份验证？

> ID：12772286
> 
> 赞同：0
> 
> 时间：2012-10-07T19:48:49.493
> 
> 标签：c#, .net, wcf, security, authentication

对于客户端-服务器应用程序，我想开发一个主要由应用程序本身使用的 Web 服务（目前不打算供第三方使用）。

然而，从长远来看，将 WebService 公开为某种 API 通常是可取的。因此，我已经在考虑选择一种允许“RESTifing”（可怕的词创建，我知道 ;-)）在以后轻松实现 Web 服务的技术。
WCF 似乎就在这里，因为它提供了 webHttpBinding 以及其他允许利用 LAN 和 .NET 客户端的绑定。

我现在遇到的问题是关于身份验证：WCF 提供的所有身份验证措施似乎都发生在实际服务的“外部”。但是，我想要一个`Login`方法（或者更“RESTful”的方法，如[第 2 点](https://stackoverflow.com/a/2022938/232175)所示）。

例如，我想像这样写一个服务：

```
[ServiceContract]
public interface IUserService
{
   [ServiceMember]
   [WebInvoke(Method = "POST", WebUri="/Session")]
   public void Login(string username, string password);

   [ServiceMember]
   [WebInvoke(Method = "POST", WebUri="/Users")]
   public void Register(RegisterUserParameter parameter);
} 
```

如何将此服务集成到 WCF 中，以便这些方法最好在我的服务项目中的多个子服务上工作？

使用内置 WCF 身份验证时，我需要在进行任何服务调用之前提供用户名和密码。因此，调用其中一个`Register`或`Login`将失败，因为我没有经过身份验证。

以及如何告诉 WCF 记住当前使用我的服务方法登录的用户？是否有可能在客户端的 WCF 会话中存储诸如会话 cookie 之类的东西？

或者以我尝试的方式在 WCF 下实现身份验证通常是一个坏主意？

我是否应该以一种更复杂的方式与客户端应用程序中的服务通信为代价直接选择 WebAPI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:11:56.013

我认为如果您依赖外部身份验证，例如 FormsAuthentication，您可以轻松实现您的目标。

这个想法是用**PrincipalPermission**属性保护你的所有方法，只有一个例外 - **Login**方法应该将 Forms cookie 附加到响应中。

一些技术细节可以在我的一篇博文中找到：

[http://netpl.blogspot.com/2010/04/aspnet-forms-authentication-sharing-for.html](http://netpl.blogspot.com/2010/04/aspnet-forms-authentication-sharing-for.html)

尽管我在那里提到 Silverlight 作为客户端，但该解决方案是通用的，适用于任何客户端技术。此外，博客文章中没有提到**Login**方法，但其唯一目的是将 Forms cookie 附加到响应中。

这样，您的客户的控制流程将首先调用您的**Login**方法，然后使用问题 cookie 调用所有其他方法。

请注意，这仅适用于 Http 绑定，因此这不是任何可能的 Wcf 绑定的通用解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T11:41:24.830

You can try the following:

1.  Create Login service with WCF login-password authentication. It will use e.g. subclass of UserNamePasswordValidator to validate username-password against DB etc. If validation is successful, return a token (e.g. GUID).

2.  All other service calls will be made by the client together with this token. Token verification can be made centrally, without modifying each service. To do so:

    *   Pass your token in the header of your request
    *   implement IDispatchMessageInspector, in its AfterReceiveRequest read token from header and validate it. If validation is successful, workflow will go inside your WCF service, if not you throw FaultException
    *   attach your MessageInspector to services that need validation:

        ...

# django - 我的视图不会呈现到我的模板

> ID：12772288
> 
> 赞同：2
> 
> 时间：2012-10-07T19:48:58.793
> 
> 标签：django, django-templates, django-views

我已经在这个圈子里跑了很长一段时间了。我遇到了模板无法呈现我的活动场地的问题。我只得到 {% else %} 语句。任何帮助是极大的赞赏。谢谢！

**楷模：**

```
class Shows(models.Model):
    event_date = models.DateField("Date of event")
    venue = models.CharField(max_length=100)

    def __unicode__(self):
        return u'%s' % (self.venue) 
```

**意见：**

```
from django.shortcuts import render_to_response, get_object_or_404
from django.template import RequestContext

from events.models import Shows

def show_results(request):
    """
    Events - this is the events section.
    """
    events = Shows.objects.all()

    return render_to_response("events/events.html", {
        "events": events,
    }, context_instance=RequestContext(request)) 
```

**模板：**

```
<h2>These are events for this month</h2>
{% if events %}
    {% for e in events %}
       <ul>
            <li>{{ e.venue }}</li>
        </ul>
    {% endfor %}
{% else %}
    <p>There are no events at this time.</p>
{% endif %} 
```

**文件结构：**

```
/myapp
    /deploy
    /events
        /templates
            /events
                events.html
        admin.py
        models.py
        urls.py
        views.py
    /requirements
    /static
    /templates
    manage.py
    settings.py
    urls.py 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:13:49.023

您的模板正在尝试迭代`events`，就好像它是一个`Shows`实例列表一样。但是，`get_object_or_404`返回单个对象。现在，您可能在数据库中只有一条记录，因此`get_object_or_404`不会引发异常。

为了`events`存储对象列表而不是单个实例，您可以替换`get_object_or_404`为：

```
events = Shows.objects.all() 
```

这将返回所有`Shows`实例的列表。

# delphi - Delphi XE2 winapi.urlmon.CoInternetSetFeatureEnabled 未找到？

> ID：12772289
> 
> 赞同：1
> 
> 时间：2012-10-07T19:49:09.303
> 
> 标签：delphi, winapi, audio, twebbrowser, urlmon

> **可能重复：**
> [Delphi2010 中的 CoInternetIsFeatureEnabled](https://stackoverflow.com/questions/4702285/cointernetisfeatureenabled-in-delphi2010)

我正在尝试禁用 twebbrowser 控件中导航声音的恼人点击，但我似乎看不到 winapi.urlmon。CoInternetSetFeatureEnabled 在任何地方？

# php - Kohana 将值编辑到数据库中

> ID：12772299
> 
> 赞同：0
> 
> 时间：2012-10-07T19:50:26.437
> 
> 标签：php, forms, kohana

我正在尝试编辑数据库中的值，但出现以下错误：

```
Call to a member function values() on a non-object 
```

控制器

```
public function action_options() {

    $this->template->styles = array(
        'style' => 'style',
        'acp' => 'acp'
    );

    $options = ORM::factory('option')->find_all()->as_array('option_name','option_value');

    $this->template->content = View::factory('default/admin/options')
        ->bind('options', $options);
}

    public function action_savesettings() {

    $options = ORM::factory('option')->find_all()->as_array('option_name','option_name');

    $options->values($this->request->post());

    $errors = array();

    try {

        $options->save();

        $this->request->redirect('acp/options');

   } catch (ORM_Validation_Exception $ex) {

       $errors = $ex->errors('validation');

   }

    $this->template->content = View::factory('default/admin/options')
        ->bind('options', $options)
        ->bind('errors', $errors);
} 
```

看法

```
<?php $errors = isset($errors) ? $errors : array(); ?>
<?php echo Form::open('acp/savesettings'); ?>
Site Name: <?php echo Form::input('site_name', $options['site_name'], array('id' => 'acp-sitename')); ?><br />
<?php echo Form::submit('submit', 'Submit', array('id' => 'acp-submit')); ?>
<?php echo Form::close(); ?> 
```

我的桌子是这样的：

```
option_id   option_name     option_value 
```

我不确定如何处理这个问题，因为我正在使用 $options[''] 访问和编辑这些值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:00:21.897

您试图不在`Model`类实例上而是在数组上设置值。`var_dump($options);`您可以在设置值之前看到它。

`values()`方法是`ORM`类的方法。

另外要获取`ORM`类实例，您应该调用`find()`方法，也不`find_all()`.

`find()`返回`ORM`类实例并将数据库中的一条记录加载到其中。然后你可以通过调用给它赋值`values()`。

`find_all()`返回`Database_Result`类实例 - 它是找到的记录的集合。在 Kohana 中，您可以将它们视为一个数组。

这是你需要写的

```
$option = ORM::factory('option')->find();

$option->values($this->request->post()); 
```

请注意，您只更改了一个数据库记录。要在一个数据库请求中更改多条记录，您需要为每条记录调用此代码或使用`DB:update()`方法来创建查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T07:26:22.857

如我所见，您想修改站点设置。因此，您的代码应如下所示：

```
// search for changing option 
$option = ORM::factory('option')->where('option_name', '=', 'site_name')->find();
// set new value
$option->set('option_value', $this->request->post('site_name'));
// update value, handle validation errors, etc
try {...} 
```

如果你想更新一些记录，你应该使用 Query Builder 或者`DB::query()`一个特殊的[多重查询](https://stackoverflow.com/questions/3432/multiple-updates-in-mysql)。

# html - HTML 类声明

> ID：12772304
> 
> 赞同：0
> 
> 时间：2012-10-07T19:50:58.600
> 
> 标签：html

我正在使用 html 并且一切正常。所以在保留 ID 时，我有 div Class="xxx"

但我在一些示例文件中看到：

```
div class="xxx yyy zzz"; 
```

当它像这样定义时，id是什么？怎么读这个？如果您也可以向我指出文档，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T19:52:08.837

假设我正确理解了您的问题，那只是一个`div`具有三个单独的类名，“xxx”、“yyy”和“zzz”。一个元素可以有尽可能多的类名。

来自[属性的](http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#classes)[HTML5 规范`class`](http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#classes)：

> 该属性（如果指定）必须具有一个值，该值是一组以空格分隔的标记，表示该元素所属的各种类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T19:54:44.403

看看[这里](http://webdesign.about.com/od/css/qt/tipcssmulticlas.htm)，它解释了多个类。

我似乎不明白你问题的 id 部分，你能详细说明一下吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T19:55:11.317

div 没有 id。它分配了 3 个类：xxx、yyy 和 zzz。 [W3Schools - CSS Id 和 Class](http://www.w3schools.com/css/css_id_class.asp)将是一个很好的资源

# php - 如何填充复合消息并作为 SoapServer 响应 XML 返回？

> ID：12772307
> 
> 赞同：3
> 
> 时间：2012-10-07T19:51:34.343
> 
> 标签：php, xml, web-services, soap, soapserver

我正在设置一个 SOAP Web 服务，它应该返回一个复合消息。
此消息的有效实例如下：

```
<dl190Response xmlns="http://pse/">
    <cdhead cisprik="5563167"/>
    <mvts>
        <mvts_S att="a1">
            <x>x1</x>
            <w>w1</w>
        </mvts_S>
        <mvts_S>
            <x>x2</x>
            <w>w2</w>
        </mvts_S>
    </mvts>
</dl190Response> 
```

所有这些都在 wsdl 中整齐地定义：

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions
    xmlns="http://schemas.xmlsoap.org/wsdl/"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tns="http://pse/"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    name="PSE"
    targetNamespace="http://pse/">
    <types>
        <xs:schema xmlns="http://pse/" targetNamespace="http://pse/">
            <xs:complexType name="cdhead_T">
                <xs:attribute name="cisprik" type="xs:long"/>
            </xs:complexType>
            <xs:complexType name="mvts_T">
                <xs:sequence>
                    <xs:element name="mvts_S" type="mvts_S_T" minOccurs="0" maxOccurs="unbounded"/>
                </xs:sequence>
            </xs:complexType>
            <xs:complexType name="mvts_S_T">
                <xs:sequence>
                    <xs:element name="x" type="xs:string"/>
                    <xs:element name="w" type="xs:string"/>
                </xs:sequence>
                <xs:attribute name="att" type="xs:string" use="optional"/>
            </xs:complexType>
        </xs:schema>
    </types>
    <message name="DL190Req">
        <part name="cdhead" type="tns:cdhead_T"/>
    </message>
    <message name="DL190Res">
        <part name="cdhead" type="tns:cdhead_T"/>
        <part name="mvts" type="tns:mvts_T"/>
    </message>
    <portType name="DLPortType">
        <operation name="dl190">
            <input message="tns:DL190Req"/>
            <output message="tns:DL190Res"/>
        </operation>
    </portType>
    <binding name="DLBinding" type="tns:DLPortType">
        <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="dl190">
            <soap:operation soapAction="http://www.testServer.com/test_soap.php#dl190"/>
            <input>
                <soap:body use="literal" namespace="http://pse/"/>
            </input>
            <output>
                <soap:body use="literal" namespace="http://pse/"/>
            </output>
        </operation>
    </binding>
    <service name="PSE">
        <port name="DLPortType" binding="tns:DLBinding">
            <soap:address location="http://www.testServer.com/test_soap.php"/>
        </port>
    </service>
</definitions> 
```

我一直在服务器端 test_soap.php 无休止地工作以使其正确，但我没有成功。在返回 XML 之前正常工作的部分内容如下：

```
<?php
    class PSE {
        function dl190 ($arg) {
            //I don't need to extract the input data just now

            mysql_connect('127.0.0.1:3306', 'user', 'password');
            mysql_select_db('myDatabase');

            $xml = new SimpleXMLElement('<dl190Res/>');
            $xml -> addChild('cdhead');
            $mvts = $xml -> addChild('mvts');

            $rows = mysql_query('select * from trx');
            while($data = mysql_fetch_assoc($rows)) {
                $mvts_S = $mvts -> addChild('mvts_S'); 
                foreach($data as $key => $value) {
                    if ($key == 'att') { $mvts_S -> addAttribute($key, $value);}
                    else    {$mvts_S -> addChild($key, $value);}
                }
            };

            $dom = dom_import_simplexml ($xml) -> ownerDocument;

            // now respond to the request and return the XML
        }

    };
    ini_set( "soap.wsdl_cache_enabled", "0");
    $server = new SoapServer ("test.wsdl");
    $server -> setClass ('PSE');
    $server -> setObject (new PSE());
    $server -> handle();    
?> 
```

我几乎尝试了我能想到的所有方法来得到正确的响应，但我没有成功。我能够对之前仅包含一个部分的消息执行相同的操作（请参阅我最近的问题+答案）。
但是在这里，有两个消息部分，我没有成功。

$xml 内容的调试表明它正是我希望看到的返回，当然，在让肥皂服务器将其包装到 Envelope+Body 之后。

实际上，这种情况与只有一个消息部分的情况不同：只要我先剥离 XML 声明，然后返回它，我就可以从一个部分创建一个新的 SoapVar。在这里我不能这样做，因为返回值由两部分组成。

所以我想知道我现在应该做什么：

1.  为响应消息声明一个类并填充并返回它
2.  使用 SoapVar 和/或 SoapParam 执行一些魔术（请注意，我已经尝试了很多）
3.  使用数组和 SoapVar 执行一些魔术（已经尝试了很多）
4.  不知何故（如何？）向wsdl寻求帮助
5.  完全不同的东西
6.  用 SoapServer 退出整个噩梦，从头开始创建我自己的 http 响应

我感谢所有的帮助，所以所有的肥皂专家，不要犹豫，试着回答这个问题！

**添加**

作为临时解决方法，我编辑了 WSDL，将响应消息更改为只有一个部分。这允许我将预期的消息作为预期的两个部分的串联传递（或任何其他消息，因为 SoapVar 没有对返回的值进行消息定义的结构 WSDL 检查）：

```
$xml1 = new SimpleXMLElement('<cdhead/>');
$xml1 -> addAttribute ('xmlns', 'http://pse/');
$xml1 -> addAttribute ('cisprik', $newCisprik);

$xml2 = new SimpleXMLElement('<mvts/>');

$rows = mysql_query('select * from trx');
while($data = mysql_fetch_assoc($rows)) {
    $mvts_S = $xml2 -> addChild('mvts_S'); 
    foreach($data as $key => $value) {
        if ($key == 'att') { $mvts_S -> addAttribute($key, $value);}
        else    {$mvts_S -> addChild($key, $value);}
    }
};

$dom1 = dom_import_simplexml ($xml1) -> ownerDocument;
$dom2 = dom_import_simplexml ($xml2) -> ownerDocument;
$part1 = $dom1 -> saveXML($dom1 -> documentElement);
$part2 = $dom2 -> saveXML($dom2 -> documentElement);

$result = new SoapVar ($part1 . $part2, XSD_ANYXML); 
```

对此的特殊之处在于，连接当然不是有效的 XML，缺少周围的根元素，但 SoapVar 无论如何都能解析它。

就是这样：任何对 SoapVar 和 SoapParam / SoapServer 有详细了解的人都可以解释是否有可能返回两个消息部分？
并解释如何做到这一点？
或者，提供有关如何在其他 SOAP 设置中执行此操作的详细信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T18:25:56.933

我尝试并设置了您的最小 SoapServer，这就是我所做的：

1.  将您的 wsdl 和 PHP 脚本复制到一个文件夹中。
2.  更改 wsdl 位置引用以指向 php 脚本。
3.  将 WSDL 导入[SoapUI](http://www.soapui.org/) - 强烈推荐它，它是免费的！
4.  试图调用服务。

这是我的呼叫请求：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:pse="http://pse/">
   <soapenv:Header/>
   <soapenv:Body>
      <pse:dl190>
         <cdhead cisprik="0"/>
      </pse:dl190>
   </soapenv:Body>
</soapenv:Envelope> 
```

由于您对数据库的调用，它最初没有工作，但我知道您真的只需要一个如何在肥皂层上正确响应的解决方案，您会弄清楚其余的。

这是简单的解决方案：

```
<?php
class PSE
{
    public function dl190($arg)
    {
        //var_dump($arg) is:
        //object(stdClass)#3 (1) {
        //   ["cisprik"]=> int(0)
        //}

        $fakeResult = array();

        $fakeResult[0] = new stdClass();
        $fakeResult[0]->cisprik = 23;

        $fakeResult[1] = array();

        $fakeResult[1][0] = new stdClass();
        $fakeResult[1][0]->att = "a1";
        $fakeResult[1][0]->x = "x1";
        $fakeResult[1][0]->w = "w1";

        $fakeResult[1][1] = new stdClass();
        //$fakeResult[1][1]->att = "a1";
        $fakeResult[1][1]->x = "x2";
        $fakeResult[1][1]->w = "w2";

        return $fakeResult;
    }
}

//ini_set("soap.wsdl_cache_enabled", "0");

$server = new SoapServer ("wsdl.xml");
$server->setObject(new PSE());
$server->handle(); 
```

请注意，PHP 基本上只在请求参数中发出 stdClass 和数组的混合（我将您得到的内容作为评论转储在顶部）。这是一件可悲的事情，但我相信在同一级别上做出响应是公平的事情，而不是通过使用 XML 来让事情变得更糟。

如果您针对此代码执行上述请求，您将得到以下 soap 响应：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://pse/">
   <SOAP-ENV:Body>
      <ns1:dl190Response>
         <cdhead cisprik="23"/>
         <mvts>
            <mvts_S att="a1">
               <x>x1</x>
               <w>w1</w>
            </mvts_S>
            <mvts_S>
               <x>x2</x>
               <w>w2</w>
            </mvts_S>
         </mvts>
      </ns1:dl190Response>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

然而，还有改进的余地。PHP SoapServer（以及 SoapClient）有一个名为 classmap 的功能，我强烈建议您使用它。如果您的 IDE 支持任何类型的 PHPDoc 自动补全，那么您几乎可以在任何处理正确设置值的地方利用它。

这是我的带有类映射定义的版本。请注意，我为它们都添加了“PSE”前缀，以强调类名不需要以 WSDL 中的 complexTypes 命名的事实。

```
<?php
class PSE
{
    public function dl190(PSE_cdhead_T $arg)
    {
        //  var_dump($arg) is:
        //  object(PSE_cdhead_T)#3 (1) {
        //      ["cisprik"]=> int(0)
        //  }

        $fakeResult = array();
        $fakeResult[0] = new PSE_cdhead_T();
        $fakeResult[0]->cisprik = 23;

        $fakeResult[1] = array();

        $fakeResult[1][0] = new PSE_mvts_S_T();
        $fakeResult[1][0]->att = "a1";
        $fakeResult[1][0]->x = "x1";
        $fakeResult[1][0]->w = "w1";

        $fakeResult[1][1] = new PSE_mvts_S_T();
        //$fakeResult[1][1]->att = "a1";
        $fakeResult[1][1]->x = "x2";
        $fakeResult[1][1]->w = "w2";

        return $fakeResult;
    }
}

class PSE_cdhead_T {
    /**
     * @var int
     */
    public $cisprik;
}

class PSE_mvts_S_T {
    /**
     * @var string
     */
    public $att;

    /**
     * @var string
     */
    public $x;

    /**
     * @var string
     */
    public $w;
}

//ini_set("soap.wsdl_cache_enabled", "0");

$classmap = array(
    'cdhead_T' => 'PSE_cdhead_T',
    'mvts_S_T' => 'PSE_mvts_S_T',
);

$serverOptions = array(
    'encoding' => 'utf-8',
    'classmap' => $classmap,
    'features' => SOAP_SINGLE_ELEMENT_ARRAYS,
);

$server = new SoapServer ("wsdl.xml", $serverOptions);

$server->setObject(new PSE());
$server->handle(); 
```

不幸的是，一个恼人的问题没有解决：在您的响应中，您不能使用一个类，而必须使用一个数组，而没有任何关于哪个索引参数映射到哪个 xml 结果的提示。这真的很糟糕，但要改变它，你必须改变 WSDL。

我很遗憾地报告说我不是创建 WSDL 文件的专家。我尝试添加一个复杂类型作为响应中的唯一元素。如果您查看我的第二个版本中的转储，您会看到您获得了一个类 PSE_cdhead_T，它是请求消息的唯一部分的映射 complexType。

因为响应消息有两部分，SoapServer 必须将它们放入一个数组中。没有可能的命名引用。我建议您在此处添加一个新的 complexType，并在地图中相应地创建一个新类，如下所示：

```
class PSE_DL190_Response
{
    /**
     * @var PSE_cdhead_T
     */
    public $cdhead;
    /**
     * @var PSE_mvts_S_T[]
     */
    public $mvts;
} 
```

然后您可以更轻松地准备响应：

```
$fakeResult = new PSE_DL190_Response();
$fakeResult->cdhead = new PSE_cdhead_T(); // Set the one cdhead structure
$fakeResult->mvts[] = new PSE_mvts_S_T(); // Add one mvts structure; 
```

这很可能会导致您的 XML 响应发生变化——不过，我无法评估其影响。

最后一个想法：有一些 PHP 的 WSDL 代码生成器，您可以尝试一下。他们将自动生成类映射所需的类。上次我尝试它们时，它们似乎可以工作，但不适用于我测试的所有 WSDL 文件。Soap 的定义似乎太复杂了，无法做到这一点。但如果它有效，那么它是值得的，而不是手动创建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T21:20:20.797

我不是 SOAP 专家，但是不得不在一些项目上使用 SOAP 来与 3rd 方服务器交互是一场噩梦，部分原因是服务器实现不太好，而且我自己作为菜鸟无知。但我记得在尝试按原样使用[PHP SOAP](http://php.net/manual/en/book.soap.php)类时遇到了很多问题，然后我改用[NuSOAP 工具包](http://nusoap.sourceforge.net/)，它更容易完成工作并解决了我遇到的许多奇怪问题。所以我的建议是使用像 NuSOAP 这样的工具包，看看事情是否更有意义。

[SOAP 是一个旧规范](http://www.w3.org/TR/soap/)，还不错，但我认为它不再被研究了（[WG 于 2009-07-10 关闭](http://www.w3.org/2000/xp/Group/)）而且它很脏而且使用起来很痛苦。[Microsoft SOAP 工具包](http://download.cnet.com/SOAP-Toolkit/3000-10250_4-10730985.html)甚至已被弃用和停用。所以，是的，如果你能走另一条路，那就去做吧，我会的。

就像走[RESTful](http://en.wikipedia.org/wiki/Representational_state_transfer)路线一样。

> REST 通过允许不同服务之间的松散耦合来促进 Web 服务器之间的事务。REST 的类型没有它的对应物 SOAP 强。REST 语言基于名词和动词的使用，并强调可读性。与 SOAP 不同，REST 不需要 XML 解析，也不需要往返于服务提供者的消息头。这最终会使用更少的带宽。REST 错误处理也不同于 SOAP 使用的错误处理。

# c# - TextBlock 上的 StrikeThrough 效果

> ID：12772308
> 
> 赞同：6
> 
> 时间：2012-10-07T19:51:36.247
> 
> 标签：c#, .net, xaml, microsoft-metro, windows-store-apps

在 Windows 应用商店应用程序中，有什么方法可以对 TextBlock 的内容应用 StrikeThrough 效果？如果没有，RichTextBlock 或任何类似的控件都可以。它是通过 XAML 还是以编程方式 (C#) 都没有关系，但我更喜欢通过 XAML，这样它就会显示在设计器中。

我在微软的文档中找到了这个，但我不知道如何使用它：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.ui.text.itextcharacterformat.strikethrough.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.text.itextcharacterformat.strikethrough.aspx)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-07T21:03:43.080

Windows 应用商店应用拥有自己的控件命名空间 (System.Ui.Xaml.Controls)。您会看到适用于 Windows 应用商店应用的 TextBlock 没有 TextDecoration 属性：[TextBlock 文档](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.textblock.aspx)。

“完整”的 .Net 4.5 TextBlock 确实具有 TextDecoration 属性：[.Net 4.5 WPF TextBlock Documentation](http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock.aspx)。

您可以像这样以“hacky”方式执行此操作：

```
 <Grid Height="30">
        <TextBlock Text="This is a test" FontSize="22" Height="34" HorizontalAlignment="Center" Foreground="White"   />
        <Line Stretch="Fill" Stroke="white" StrokeThickness="2 " X1="1" Width="120" VerticalAlignment="Center"  HorizontalAlignment="Center"   />
    </Grid> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-07T20:43:47.350

看来这毕竟是不可能的：

> “我们将无法为 Windows 8 的 XAML 框架的最终实现包含 TextDecoration 类。这意味着您将无法使用删除线功能，但您仍然可以通过 Underline 类为文本添加下划线。 "

（[http://social.msdn.microsoft.com/Forums/en-CA/winappswithcsharp/thread/cba0c363-60da-4e4e-9fc1-93f7c3658aff](http://social.msdn.microsoft.com/Forums/en-CA/winappswithcsharp/thread/cba0c363-60da-4e4e-9fc1-93f7c3658aff)）

但是，微软正在努力解决这个问题：

> “这是 Windows 8 开发人员预览版中 XAML 文本故事的一个已知限制。从好的方面来说，这是一个计划在不久之后进行改进的领域，我们希望解决这个问题。”

（[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/d5362fe2-48f6-448d-92ae-25216345c46d](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/d5362fe2-48f6-448d-92ae-25216345c46d)）

# java - 将 GUI 组件声明为字段是否有特定的原因？ActionListener 也应该是匿名的吗？

> ID：12772309
> 
> 赞同：3
> 
> 时间：2012-10-07T19:51:35.133
> 
> 标签：java, swing, jframe, actionlistener, windowbuilder

有几个关于如何制作简单 GUI 的示例。我的问题是什么被认为是这样做的正确方法，以及这样做的理由是什么？

我一直在 Eclipse 下使用 Window Builder Pro，并检查正在生成的代码。显然 Window Builder 更喜欢在可视类的 main 方法中将组件（按钮等）声明为局部变量。但是，Window Builder 中有一个按钮可以转换为字段。我遇到的大多数示例似乎更喜欢字段声明。

还有许多例子表明最好创建一个单独的扩展类`JFrame`。Window Builder 只是`JFrame`在类中声明为一个字段。

我还应该为许多事件或多个处理程序提供一个处理程序。Window Builder 为每个事件声明匿名处理程序。

我只是想弄清楚首选方法是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-07T19:56:06.617

> 将 GUI 组件声明为字段是否有特定的原因？

我想说的是，如果您需要在程序中的某处引用该组件，您只需要这样做。例如，大多数普通 JLabel 通常不是这种情况，因此这些可能最好在使用现场声明和使用。然而，许多 JButtons 和 JTextComponents 将需要在其他地方使用，并且最好将它们声明为私有类字段。

> ActionListener 也应该是匿名的吗？

只有在有意义的情况下这样做。澄清一下，许多/最快速的一次性 ActionListener 应该是匿名的，但较大的应该是私有内部类，而复杂的较大的应该是单独的独立类。除了感觉和经验，我知道没有简单的测试可以区分这些。

> 我一直在 Eclipse 下使用 Window Builder Pro，并检查正在生成的代码......

如果您是一名学徒 Swing 编码器，您可能希望将这个工具放在一边，直到您非常熟悉创建 Swing GUI，因为如果您不太熟悉 GUI 构建器，则使用起来可能会很棘手。底层库。否则，如果您是熟练工，当然如果您是专家 Swing 程序员，那么请继续使用它。

> 还有许多例子表明，最好创建一个扩展 JFrame 的单独类。Window Builder 只是将 JFrame 声明为类中的一个字段。

我认识的大多数 Swing 领域的专家建议，通常最好不要扩展 JFrame，而是在需要时创建和使用 JFrame 对象。这有几个原因，但第一个是避免意外的副作用，例如在没有意识到的情况下覆盖关键方法。当我重写 JComponent 并提供它`int getX()`和`int getY()`方法时，这发生在我身上。该组件永远不会停留在它应该位于的位置！

> 我还应该为许多事件或多个处理程序提供一个处理程序。Window Builder 为每个事件声明匿名处理程序。

我认识的大多数人都使用单个处理程序来处理单一类型的操作。例如，如果您正在创建一个计算器，那么创建一个供所有数字按钮共享的处理程序是有意义的，并且可能为不同类型的操作创建多个处理程序：一个处理程序用于基本的数学运算，例如 +、- , *, /, 一个用于内存操作，一个用于更复杂的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:09:15.653

@HovercraftFullOfEels 已经为您的问题提供了很好的答案。我只想在这个基础上加一点：

> 我还应该为许多事件或多个处理程序提供一个处理程序。Window Builder 为每个事件声明匿名处理程序。

我假设您在问是否应该为多个按钮设置一个处理程序，在`ActionEvents`. 我的一般经验法则是避免切换 if-else 语句来检测单击了哪个按钮。如果每个按钮做的事情完全不同，那么我通常为每个按钮创建单独的匿名内部类。

# javascript - Javascript翻转图像

> ID：12772323
> 
> 赞同：1
> 
> 时间：2012-10-07T19:53:13.747
> 
> 标签：javascript, image, flip

有谁知道是否有任何用于图像翻转的 JavaScript 库。我不想要 css3 效果，我想像在图像编辑器上那样在右变为左时实际翻转图像。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-07T19:55:07.137

翻转图像的一种简单方法是使用 CSS3。我假设您所说的“CSS3 效果”是指动画，但这*并没有*做到这一点。

```
img {
    transform: scale(-1, 1);
    -moz-transform: scale(-1, 1);
    -webkit-transform: scale(-1, 1);
    -o-transform: scale(-1, 1);
    -khtml-transform: scale(-1, 1);
    -ms-transform: scale(-1, 1);
} 
```

这是通过在 X 轴上将图像缩放 -1（沿该轴翻转）和在 Y 轴上缩放 1（什么都不做）来实现的。如果你想在 Y 轴而不是 X 轴上翻转，你可以在 X 和 Y 周围切换。

如果需要，CSS3 变换也可用于旋转。而不是`scale(-1, 1)`你可以使用类似`rotate(90deg)`顺时针旋转 90 度的东西。

* * *

对于 Internet Explorer 支持，您可以使用以下`filter`属性：

```
img {
    filter: fliph;
    /* all of the transforms above */
} 
```

# android - Facebook获取具有分页限制的状态

> ID：12772331
> 
> 赞同：3
> 
> 时间：2012-10-07T19:54:38.527
> 
> 标签：android, facebook, api

我正在开发一个 iphone/android 应用程序，该应用程序需要将客户端每日 fb 状态消息显示到应用程序中。身份验证会发生这种情况并且工作正常（与 PHP FB SDK API 连接），现在我需要显示来自该用户墙的所有状态消息（现在它默认只提供 20 个雕像）。

我能够看到上一页/下一页 URL 链接

```
[previous] => https://graph.facebook.com/user_id/statuses?date_format=U&limit=25&since=1328969556&__paging_token=10150777962697519&__previous=1

[next] => https://graph.facebook.com/user_id/statuses?date_format=U&limit=25&until=1264999321&__paging_token=327111876040 
```

但不确定如何调用它来获取下一组状态消息列表。

当我直接调用 URL 时，它会以 json 格式显示此错误消息

> 请求此资源需要访问令牌。

所以我向这个 URL 添加了访问令牌（由 FB 返回），就像

[https://graph.facebook.com/user_id/statuses?date_format=U&limit=25&until=1264999321&__paging_token=327111876040&access_token=returned_access_token_string](https://graph.facebook.com/user_id/statuses?date_format=U&limit=25&until=1264999321&__paging_token=327111876040&access_token=returned_access_token_string)

它返回空数据 json，但该用户的墙上有 1000 多个雕像。我如何通过限制访问 fb 状态。

# c# - C# FiddlerCore API 捕获数据

> ID：12772332
> 
> 赞同：2
> 
> 时间：2012-10-07T19:54:41.393
> 
> 标签：c#, .net, proxy, fiddler

我成功地使用 C# 中的 FiddlerCore API 来拦截来自特定 Web 主机的 Web 响应并捕获 JSON 数据。

当我的应用程序正在运行和捕获数据时，FiddlerCore API 似乎阻止了 Chrome、IE 等中的任何其他 Web 浏览。我知道 FiddlerCore 创建了一个代理来捕获流量，但想知道是否可以阻止 FiddlerCore 更改浏览器中的 LAN 设置以通过代理引导流量？

我目前正在使用以下代码启动我的 Fiddler 实例：

```
 Fiddler.FiddlerApplication.Startup(8877, true, true); 
```

我在以下事件中拦截了我的 winforms 应用程序中的数据包

```
 FiddlerApplication.AfterSessionComplete 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:40:26.467

我认为您正在将提琴手作为系统代理启动。要在没有这个的情况下启动它，您不能将 FiddlerCoreStartupFlags.RegisterAsSystemProxy 作为启动标志之一传递。

> FiddlerApplication.Startup(0,
> FiddlerCoreStartupFlags.Default &
> ~FiddlerCoreStartupFlags.RegisterAsSystemProxy);

# grails - 如何正确映射两个域之间的两个单向关系？

> ID：12772345
> 
> 赞同：0
> 
> 时间：2012-10-07T19:56:36.993
> 
> 标签：grails, grails-orm

我有两个域类，我希望彼此之间存在*单向关系：*

```
class User {
    HistoryEntry lastFooEntry

    static constraints = {
        lastFooEntry(nullable: true)
    }
}
class HistoryEntry {
    String name
    User createdBy
} 
```

根据[grails 文档](http://grails.org/doc/latest/guide/GORM.html#manyToOneAndOneToOne)（据我所知），这是这样做的方法。指定`belongsTo`将创建一个双向关系（我不想要的），并且`hasOne`无论如何只适用于双向关系。

上述建模的问题是，以下代码仅在`entryName=='foo'`. 对于任何其他值，断言为假：

```
def addHistoryEntry(Long id, String entryName) {
    def user = User.get(id)
    if(!user) {
        user = new User(id: id).save()
    }
    def entry = new HistoryEntry(createdBy: user, name: entryName).save()
    if(entryName=='foo') {
        user.lastFooEntry = entry
        user.save()
    } else {
        assert user.lastFooEntry!=entry
    }
} 
```

我可以通过指定来解决这个问题

```
static mappedBy = [createdBy:''] 
```

在`HistoryEntry`. 但根据 IntelliJ IDEA 和[grails 文档](http://grails.org/doc/latest/guide/GORM.html#oneToMany)，这只能与空字符串结合使用，`hasMany`而且我从未见过它带有*空*字符串。

所以问题是：这样做的正确方法是什么？还是它是一个未记录的功能/错误，到目前为止我的解决方法很好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:29:59.893

如果您没有在关系的另一端指定字段，则关系在 JVM 方面将保持单向 - 即您的示例已经足够，您不需要更多。`hasOne`in`User`或/和`belongsTo`in`HistoryEntry`也可以。

该示例可能缺少某些内容，因为断言不能为假：`entry`刚刚创建，并且从未分配给任何东西，因此该`User`对象或任何其他对象都无法引用它。此外，`entry`尚未保存或刷新。

关系数据库中的 1:1 关系是 1 向还是 2 向更多的是一个解释问题：通常您只有一端有外键，但也可以计算另一种方式。

所以不用担心，Grails 永远不会在关系的另一端自动添加引用字段，除非您明确声明该字段。

# macos - 10.5 Leopard 上支持 Retina 的 .icns 图标文件（大小限制？）

> ID：12772346
> 
> 赞同：3
> 
> 时间：2012-10-07T19:56:44.093
> 
> 标签：macos, cocoa, png, icns, iconutil

我正在尝试创建我的应用程序图标的视网膜就绪版本。该应用程序的目标是 10.5+。我正在使用 Uli Kusterer 的[oldiconutil](https://github.com/uliwitness/oldiconutil)在 10.8 上使用 iconutil 对我从 .iconset 制作的 .icns 文件进行后期处理。问题是，如果我包含一个 1024x1024 图标（“icon_512x512@2x.png”），则该图标不会显示在 10.5 上。Finder 不显示图标，当它在 10.5 的 Icon Composer 中打开时，它似乎是空白/空的。如果我删除这个最大尺寸，图标会在 10.5 上正确显示。有趣的是，如果我用更小的文件大小（~300K 而不是~1MB）替换一个完全不同的、更简单的 1024x1024 图像，该图标在 10.5 上仍然可以正常工作。因此，似乎整个 .icns 文件和/或 .icns 文件中的单个图像块的文件大小可能存在一些限制，当超出时会破坏与 Leopard 的兼容性。

[使用TinyPNG](http://tinypng.org)压缩 1024x1024 图像不足以解决问题。在通过 oldiconutil 运行它之前，它确实导致了一个小得多的 .icns 文件，但 oldiconutil 的最终 JPEG2000 压缩输出仍然比使用更简单的替代图像的变体大得多，大概是因为更复杂的图像根本不那么可压缩。

有没有其他人遇到过这个问题？你找到解决办法了吗？如果我无法找到解决方案，我将不得不省略一个视网膜就绪应用程序图标，直到我放弃对 10.5 的支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T07:58:51.893

使用 TinyPNG 是正确的想法，但是当您使用 oldiconutil 创建 .icns 文件时，它会将它们转换为更大的 JP2 并导致问题。

通过使用十六进制编辑器，您可以找到各个图标并将特定的 JP2 版本替换为 TinyPNG 版本。您还需要为您换出的任何图标编辑 icns 标头中的文件长度字节（字节 5-8）以及图标图像长度字节（ic## 类型之后的 4 个字节）。

我建议您只替换视网膜图标（ic10、ic11、ic12、ic13、ic14），因为旧版操作系统可能无法使用 PNG 图像。

如果您的大小刚刚超过 1MB，则可以仅替换最大的图标以低于限制。这将使大多数图标保持更兼容的 JP2 格式，只有 PNG 中的 512@2x (ic10) 图标。

希望这可以帮助。

# asp.net-mvc - MVC4 - 显示有关错误的更多信息

> ID：12772351
> 
> 赞同：1
> 
> 时间：2012-10-07T19:56:50.117
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我们正在使用“HttpResponseExpection”来抛出异常消息。在异常情况下，尝试显示错误内容和 ReasonPhrase，但它只显示错误状态代码。发布了我用来显示消息的代码。

```
 var resp = new HttpResponseMessage(HttpStatusCode.NotFound)
                {
                    Content = new StringContent(string.Format("No Product with ID = {0}", id)),
                    ReasonPhrase = "Product ID Not Found",
                    StatusCode = HttpStatusCode.Forbidden

                }; throw new HttpResponseException(resp); 
```

来自 index.cshtml 的代码

```
 function find() {

        clearStatus();

        var id = $('#productId').val();

        $.getJSON(API_URL + id,
        function (data) {
            viewModel.Name(data.Name);
            viewModel.Category(data.Category);
            viewModel.Price(data.Price);
        })
    .fail(
        function (jqXHR, textStatus, err) {
            $('#status').html('Error: ' + err );
        });

    } 
```

非常感谢任何帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T07:14:41.503

对象的`responseText`属性`jqXHR`将包含错误消息（`Content`属性）：

```
.fail(function (jqXHR, textStatus, err) {
    alert(jqXHR.responseText);
}); 
```

如果您想获取`ReasonPhrase`属性，请使用`err`参数：

```
.fail(function (jqXHR, textStatus, err) {
    alert(err);
}); 
```

还要确保您在 API 控制器上使用正确的状态代码 404 ( `HttpStatusCode.NotFound`) 而不是 403 ( )：`HttpStatusCode.Forbidden`

```
var resp = new HttpResponseMessage(HttpStatusCode.NotFound)
{
    Content = new StringContent(string.Format("No Product with ID = {0}", id)),
    ReasonPhrase = "Product ID Not Found",
    StatusCode = HttpStatusCode.Forbidden
}; 
throw new HttpResponseException(resp); 
```

# c++ - 抛弃 const，这是明确定义的行为吗？

> ID：12772357
> 
> 赞同：3
> 
> 时间：2012-10-07T19:57:11.357
> 
> 标签：c++

> **可能重复：**
> [const_cast 安全吗？](https://stackoverflow.com/questions/357600/is-const-cast-safe)

显然我永远不会编写这段代码，但它是一个非常简单的例子，它是在一个真实的程序中出现的东西。

```
#include <iostream>

void change(const int& data)
{
    int& data2 = const_cast<int&>(data);
    data2 = 100;
}

int main()
{
    int thing = 123;
    change(thing);

    std::cout << thing << "\n";
} 
```

这是明确定义的行为，这会改变所引用的数据，还是允许编译器假设因为它传递了一个`const int&`函数不能更改传入的值并相应地生成代码？

编辑：我在输出更改后的值 100 时尝试过的所有编译器。

***这似乎与[Can C++ 编译器假设 const bool & value 不会改变？](https://stackoverflow.com/questions/5128639/can-c-compiler-assume-a-const-bool-value-will-not-change)所以我很高兴关闭这个。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:00:07.010

除非您知道原始值是否为常数，否则这不是明确定义的行为。它将在您给出的确切示例中起作用。但是，如果您传入一个 const 变量，它可能会导致内存访问冲突。这是因为编译器将 const 变量放在只读内存页上。

# c# - 获取 Unicode 字母的类别

> ID：12772365
> 
> 赞同：1
> 
> 时间：2012-10-07T19:58:08.077
> 
> 标签：c#, unicode, char

[如此处](http://msdn.microsoft.com/en-us/library/yyxz6h5w.aspx)所述：

`Char.IsLetter() determines whether a Char is a member of any category of Unicode letter.`

是否有可能获得Unicode 字母本身的**类别**`Char.IsLetter()`，什么时候`true`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:00:37.503

当然 - 我想你想要[`CharUnicodeInfo.GetUnicodeCategory(char)`](http://msdn.microsoft.com/en-us/library/h6sx68ke.aspx)或[`Char.GetUnicodeCategory(char)`](http://msdn.microsoft.com/en-us/library/hz49h034.aspx)。

请参阅文档以了解差异 - 建议您使用`CharUnicodeInfo`, 以获取*当前*Unicode 标准中的值。

# javascript - 不了解 Jquery 悬停

> ID：12772369
> 
> 赞同：0
> 
> 时间：2012-10-07T19:59:09.897
> 
> 标签：javascript, jquery, jquery-ui, hover, jquery-hover

我环顾四周，基本上住在 Jquery API 页面上，但我似乎无法理解如何触发某个悬停事件。

是）我有的：

```
<div class="profile profile-inner">
<div class="profile-footer">
<ul class="profile-actions"> 
```

我想要的是：

ul 类是隐藏的。然后，一旦 div 类“profile profile-inner”悬停，我希望 ul 类可见。

笔记：

据我所知，我将不得不使用`this`，因为有很多 div 类`profile profile-inner`（因为该特定页面上有许多不同成员的个人资料）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T20:06:45.147

[`.hover()`](http://api.jquery.com/hover/)有两个参数：一个函数在转换到“悬停状态”时调用，另一个函数在离开“悬停状态”时调用：

```
$('.profile.profile-inner').find('ul').hide();
$('.profile.profile-inner').hover(function() {
  $(this).find('ul').show();
}, function() {
  $(this).find('ul').hide();
}); 
```

我不建议这样做：根据您页面的布局，使用 Javascript 检测悬停可能不可靠，并且您可能会“陷入”某种状态。这可能会惹恼用户，幸运的是，您可以单独使用 CSS 来做您想做的事情：

```
.profile.profile-inner ul { display: none; }
.profile.profile-inner:hover ul { display: block; } 
```

如果您的外部元素是`<a>`标签，这甚至可以在 MSIE6 中使用。

如果你想进一步向后兼容，我建议创建一个[行为](http://msdn.microsoft.com/en-us/library/ms531018.aspx)-shim 来补充基于 CSS 的方法，而不是使用 jQuery 的悬停。此方法一直有效到 MSIE4。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:11:00.973

```
 $(document).ready(function()
 {
    $(".profile-actions").hide();

    $(".profile-inner").hover(function()
    {
        $(".profile-actions").show();   
    }, function()
        {
          $(".profile-actions").hide();
        });     
}); 
```

应该做的工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T20:20:29.153

您不需要 JavaScript（或 jQuery），只需使用 css：

```
profile-inner:hover .profile-actions{ display:block; } 
```

[现场演示](http://jsfiddle.net/s997f/9/)

# ios - iPad：点击导航栏中的按钮时关闭弹出窗口

> ID：12772370
> 
> 赞同：2
> 
> 时间：2012-10-07T19:59:18.307
> 
> 标签：ios, ipad, uipopovercontroller, popover

我有一个包含多个按钮的导航栏，包括一个后退按钮、一个编辑按钮和一个打开弹出框的按钮。

当弹出框打开并且用户点击任何其他按钮时，我希望弹出框关闭。如果弹出窗口打开，我可以尝试检测所有按钮上的每次点击并拦截操作，但我认为可能有更优雅的选择。它适用于点击不在导航栏中的所有项目，只有导航栏中的按钮不会关闭弹出框。

有什么建议么？

我的问题非常类似于[UIPopoverController 在单击 NavigationBar 时不会关闭，](https://stackoverflow.com/questions/6136792/uipopovercontroller-does-not-dismiss-when-clicking-on-the-navigationbar)但我似乎没有办法询问作者是否解决了问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T07:15:54.590

我知道这可能有点晚了，但对其他人来说：

出现此问题的原因是，如果 popoverController 在单击导航栏上的按钮时出现，则导航控制器默认存在于 popoverController 的[passthroughViews中。](http://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html#//apple_ref/doc/uid/TP40009306-CH1-SW8)

要解决这个问题，只需将 passthroughViews 的引用设为 nil。

因此，**在**呈现 popoverController 之后添加这一行：

```
popoverController.passthroughViews = nil; 
```

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:34:51.313

将每个按钮的选择器分配给相同的方法，首先，检查弹出框是否打开，然后关闭它，然后将每个按钮重定向到它的方法。

```
-(IBAction) navButtons:(UIBarButtonItem *)sender {
     if(![popoverController isPopoverVisible] && sender.tag == 1){//assume that just one button will open the popover
         //present the popover
     } else {
         //dismiss the popover
     }

     switch (sender.tag) {
        case 1:
             [self button1Handler];
             break;
        case 2:
             [self button2Handler];
             break;
        /*...
          ...
          ...*/
        default:
             break;
    }
} 
```

我认为这是您可以使用的最佳解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-21T04:43:16.560

导航栏上的项目将自动添加到 popoverViewController 的 passthroughViews。它发生在弹出窗口出现之后。所以你需要在那之后清除 passthroughViews 。

而对于 iOS 8，我们可以从 UIViewController.popoverPresentationController 中获取 popoverController，在此之前，我们可以从 UIStoryboardPopoverSegue 中获取 popoverController。

请参阅以下链接以获取代码示例：

[https://stackoverflow.com/a/27054252/2919070](https://stackoverflow.com/a/27054252/2919070)

# c++ - 在对象的动态数组上调用 delete [] 不会释放内存？

> ID：12772371
> 
> 赞同：2
> 
> 时间：2012-10-07T19:59:22.327
> 
> 标签：c++, memory-management, dynamic-allocation

在以下代码中：

```
int main(int argc,char * argv[]){
  int * ptr;
  ptr = 0; // tried also with NULL , nothing changes
  ptr = new int[10]; // allocating 10 integers
  ptr[2] = 5;
  ptr[15] = 15;  // this should cause error (seg fault) - but it doesn't

  cout << ptr[2] << endl;
  cout << ptr[15] << endl;  // no error here

  delete [] ptr;

  cout << ptr[2] << endl;   // prints the value 5
  cout << ptr[15] << endl;  // prints the value 15
} 
```

执行的结果是：

> ```
> 5        
> 15        
> 5        
> 15 
> ```

1.  如果我只分配 10，索引号为 15 的元素怎么可能存在？
2.  为什么整个数组被释放后指针仍然有值？

我尝试使用这样的单一分配删除：

```
int * ptr;
ptr = 0;
ptr = new int;
*ptr = 5;
cout << *ptr << endl;
delete ptr ;
cout << *ptr << endl; 
```

结果正常：

> ```
> 5        
> 0 
> ```

在 fedora 17 和另一个平台（SLC5 - red hat based linux）上使用 gcc 4.7.2 和 gcc 4.1.2 进行了测试，以确保它不依赖于编译器。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-07T20:02:25.040

1.  超出数组预期大小的元素存在，因为那里的内存恰好存在。用它做任何事情都是非法的，会导致黑暗的未知。

2.  释放意味着不再为您分配内存。这并不意味着有人去那里清理它。但是访问你剩下的东西是非法的，并且会导致黑暗的未知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:02:33.030

您正在访问不属于该数组的内存。它的工作原理是纯粹的运气。如果程序没有崩溃，则意味着您正在覆盖属于您自己的应用程序的部分内存，因此您在某处破坏了某些东西，并且无法再保证您的程序正常运行。

大多数情况下，您会遇到分段错误，因为您访问了其他应用程序的内存。这一次，你只是“幸运”。或者正如我所说的“不幸”，因为您无法立即从执行中判断您的程序存在内存错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T20:06:10.860

取消引用已删除的指针是 C++ 标准定义的未定义行为。这就是*未定义的行为*。你可能会崩溃，你可能会得到 0，你可能会得到以前的东西，或者 42。根据定义，此时没有“正常”行为。

# c++ - C ++：具有指向函数的指针作为属性的类

> ID：12772372
> 
> 赞同：2
> 
> 时间：2012-10-07T19:59:26.287
> 
> 标签：c++, function, parameters, function-pointers

我有一个按钮类：

```
class Button : public Component {

private:
    SDL_Rect box;
    void* function;

public:
    Button( int x, int y, int w, int h, void (*function)() );
    ~Button();
    void handleEvents(SDL_Event event);

}; 
```

我想`Button::function`在方法中执行`Button::handleEvents`：

```
void Button::handleEvents(SDL_Event event) {
    int x = 0, y = 0;
    // If user clicked mouse
    if( event.type == SDL_MOUSEBUTTONDOWN && event.button.button == SDL_BUTTON_LEFT) {
            // Get mouse offsets
            x = event.button.x;
            y = event.button.y;

            // If mouse inside button
            if( ( x > box.x ) && ( x < box.x + box.w ) && ( y > box.y ) && ( y < box.y + box.h ) )
            {
                this->function();
                return;
            }
    }

} 
```

当我尝试编译时，出现以下错误：

```
Button.cpp: In the constructor ‘Button::Button(int, int, int, int, void (*)(), std::string)’:
Button.cpp:17:18: error: invalid conversion from ‘void (*)()’ to ‘void*’ [-fpermissive]
Button.cpp: In the function ‘virtual void Button::handleEvents(SDL_Event)’:
Button.cpp:45:19: error: can't use ‘((Button*)this)->Button::function’ as a function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:02:03.797

在您的类变量声明中，您有

```
void* function; 
```

这声明了一个名为的变量`function`，它是一个指向`void`. 要将其声明为函数指针，您需要与参数列表中的语法相同：

```
void (*function)(); 
```

这现在是一个指向返回函数的指针`void`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:04:10.850

您的私有部分中的函数指针未按应有的方式声明。

它应该是 ：

```
void (*functionPtr)(); 
```

查看[这个](https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work)问题以获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T20:22:53.330

我建议`std::function<void()>`这种目的：

```
#include <functional>

class Button : public Component
{
private:
    SDL_Rect box;
    std::function<void()> function;

public:
    Button( int x, int y, int w, int h, std::function<void()> f);
    ~Button();
    void handleEvents(SDL_Event event);
};

void Button::handleEvents(SDL_Event event)
{
    int x = 0, y = 0;
    // If user clicked mouse
    if( event.type == SDL_MOUSEBUTTONDOWN && event.button.button == SDL_BUTTON_LEFT)
    {
        // Get mouse offsets
        x = event.button.x;
        y = event.button.y;
        // If mouse inside button
        if( ( x > box.x ) && ( x < box.x + box.w ) && ( y > box.y ) && ( y < box.y + box.h ) )
        {
            function();
            return;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T20:04:08.927

您可能会更改字段声明，

```
void * function; // a void ptr
void (*function)(); // a ptr to function with signature `void ()` 
```

或使用演员表：

```
((void (*)())this->function)(); 
```

# c# - 如何链接到 Windows Phone 应用程序中的特定系统设置？

> ID：12772374
> 
> 赞同：1
> 
> 时间：2012-10-07T19:59:26.973
> 
> 标签：c#, silverlight, windows-phone-7

我想知道是否可以将按钮连接到特定设置..

例如： 1\. 用户启动使用 GPS 的应用程序。2\. GPS 已关闭。将出现一个消息框，其中包含一条消息，说明 GPS 已关闭和一个按钮。3\. 用户点击按钮，“位置设置”正在启动。4\. 用户可以打开GPS，返回APP。

这将是一种更方便的更改设置的方法，并且可以为用户节省一些时间。

我想我在一个应用程序中看到了它，但我不确定是哪一个。它可能是诺基亚地图或诺基亚驱动器，但作为 OEM，诺基亚能够操纵某些系统设置。

这可能吗？

亲切的问候，尼尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:39:45.427

是也不是，因为 Mango 有一种访问设置的方法，在这里找到它：[windows phone 7 如何导航到设置菜单](https://stackoverflow.com/questions/6668496/windows-phone-7-how-to-navigate-to-settings-menu) msdn 链接：http: [//msdn.microsoft.com/en-us/library/hh394011%28VS.92 %29.aspx](http://msdn.microsoft.com/en-us/library/hh394011%28VS.92%29.aspx)

使用：

```
ConnectionSettingsTask connectionSettingsTask = new ConnectionSettingsTask();
connectionSettingsTask.ConnectionSettingsType = ConnectionSettingsType.WiFi;
connectionSettingsTask.Show(); 
```

似乎只在这里：

无线上网

蓝牙

蜂窝

飞行模式

可用。 [http://msdn.microsoft.com/en-us/library/microsoft.phone.tasks.connectionsettingstype(v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/microsoft.phone.tasks.connectionsettingstype(v=vs.92).aspx)

# properties - 未使用复合应用程序为此命名空间定义属性

> ID：12772377
> 
> 赞同：0
> 
> 时间：2012-10-07T19:59:45.840
> 
> 标签：properties, namespaces, wsdl, xpages, composite-component

我创建了一个包含视图和 xpage 的复合应用程序。当用户选择一个文档时，我将所选文档的 unid 发布到 xpage。使用组件可以正常工作。

现在，除此之外，当我在视图中单击一个操作时，我想将另一个 unid 值发布到 xpage。所以我使用 Lotusscript 和以下代码来执行此操作。

```
Dim s As New NotesSession
Dim pb As NotesPropertyBroker
Set pb = s.GetPropertyBroker()
Call pb.setPropertyValue("Unid","Test")
Call pb.Publish() 
```

当我运行此代码时，出现以下错误

“未为此工作区定义属性”

![在此处输入图像描述](../Images/61ccb7beecbb3b6978faa9d900e1b3ba.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:32:26.993

您需要在 WSDL 文件中创建该属性。幸运的是，Domino Designer 中的编辑器使您免于复杂性。它们是复合应用程序 - 电线属性。

视图发布的是继承。您发布的内容需要定义为 Wire 属性。

# javascript - 在 div 中更改和图像但不能给它和 javascript 变量 id

> ID：12772378
> 
> 赞同：0
> 
> 时间：2012-10-07T19:59:55.943
> 
> 标签：javascript, jquery

我以为这很简单。我正在更改 div 中的图像，但似乎无法设置 div 图像的 id。

```
 var my_html = "<img src=\"/img/lock.png\" id=\"" + json_obj.ITEM_VALUE_ID "+  \" />"
     $("#up-down-icons-"+id+"-"+level).html( my_html  ); 
```

我明白了

```
 <img id=" + json_obj.ITEM_VALUE_ID + " src="/img/lock.png"> 
```

json_obj.ITEM_VALUE_ITEM 已定义。谁能看到我做错了什么？我想我只需要第二双眼睛。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:04:01.443

您的 javascript 语法有错误，这是一个好方法：

```
var my_html = "<img src='/img/lock.png' id='" + json_obj.ITEM_VALUE_ID + "' />";
$("#up-down-icons-"+id+"-"+level).html(my_html); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:11:52.120

应该是这个

```
var my_html = "<img src=\"/img/lock.png\" id=\"" + json_obj.ITEM_VALUE_ID +  "\" />" 
```

你只是放错了加号的位置

# asp.net-mvc - 如何在 Mono Apache MVC 应用程序中提供静态内容

> ID：12772383
> 
> 赞同：1
> 
> 时间：2012-10-07T20:00:22.480
> 
> 标签：asp.net-mvc, apache, jquery-ui, jqgrid, mono

ASP.NET MVC 应用程序页面包含订单标题和订单行。使用了 jquery、jqgrid、jqueru ui 和一些 jqueru ui 插件。所有 js 文件都编译为单个缩小文件 default.js

资源从 ASP .NET MVC 应用程序树中的 ASP.NET 标准脚本、内容和主题子目录加载。

在 Chrome 浏览器中运行审核提出了使静态资源可缓存且不使用 cookie 的建议。

对于第一个审计问题，Mono 似乎禁用了缓存控制。响应标头如下所示：

```
Cache-Control:private
Connection:Keep-Alive
Date:Sun, 07 Oct 2012 19:38:15 GMT
Keep-Alive:timeout=15, max=97
Server:Apache 
```

对于第二个问题，浏览器似乎为 css 文件和图像发送 cookie：

```
Connection:keep-alive
Cookie:ASP.NET_SessionId=8E6FF8F8BAE86246BF49C1C5; .MyAuth=fDmFg9sG5ZfQBCwcgOpdrgSH/OcY5+xVyL9XJko1SwObAZcMQbZyNYz4JZ7fTZLBNVhjw23LuKrBiYqM5G0lccXUxkK/S37rToQfmBR4JfmlVTBT; .MyRoles= 
```

如何解决这些问题？最好保留 ASP.NET 应用程序目录结构并提供应用程序子目录中的所有文件

Chrome 审核结果为：

```
Leverage browser caching (16)
The following resources are explicitly non-cacheable. Consider making them cacheable if possible:

Detail
jquery-ui-1.8.12.custom.css
ui.jqgrid.css
Site.css
default.js
ui-bg_inset-hard_100_fcfdfd_1x100.png
ui-bg_flat_55_fbec88_40x100.png
ui-bg_glass_95_fef1ec_1x400.png
ui-bg_gloss-wave_55_5c9ccc_500x100.png
DokG.png
ui-bg_inset-hard_100_f5f8f9_1x100.png
ui-bg_glass_85_dfeffc_1x400.png
ui-icons_6da8d5_256x240.png
ui-bg_flat_0_aaaaaa_40x100.png
ui-icons_d8e7f3_256x240.png
ui-icons_469bdd_256x240.png

Serve static content from a cookieless domain (14)
2.53KB of cookies were sent with the following static resources. Serve these static resources from a domain that does not set cookies:

jquery-ui-1.8.12.custom.css
ui.jqgrid.css
Site.css
ui-bg_inset-hard_100_fcfdfd_1x100.png
ui-bg_flat_55_fbec88_40x100.png
ui-bg_glass_95_fef1ec_1x400.png
ui-bg_gloss-wave_55_5c9ccc_500x100.png
DokG.png
ui-bg_inset-hard_100_f5f8f9_1x100.png
ui-bg_glass_85_dfeffc_1x400.png
ui-icons_6da8d5_256x240.png
ui-bg_flat_0_aaaaaa_40x100.png
ui-icons_d8e7f3_256x240.png
ui-icons_469bdd_256x240.png 
```

# ruby-on-rails - NoMethodError：minitest 和 mocha 的未定义方法“模拟”

> ID：12772384
> 
> 赞同：0
> 
> 时间：2012-10-07T20:00:31.550
> 
> 标签：ruby-on-rails, minitest, ruby-mocha

我正在为 Rails 3 开发一个 gem，在 travis-ci.org 在 Ruby 1.8.7 下运行它时遇到了一个错误：

```
/home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:874:in `_run_suite': undefined method `run' for #<TestActivist:0xb6936dd4> (NoMethodError)
69  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:866:in `map'
70  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:866:in `_run_suite'
71  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:853:in `_run_suites'
72  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:853:in `map'
73  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:853:in `_run_suites'
74  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:826:in `_run_anything'
75  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:1015:in `run_tests'
76  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:1002:in `send'
77  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:1002:in `_run'
78  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:1001:in `each'
79  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:1001:in `_run'
80  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:990:in `run'
81  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/minitest-3.5.0/lib/minitest/unit.rb:748:in `autorun'
82  from /home/travis/.rvm/gems/ruby-1.8.7-p370/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:21
83rake aborted!
84Command failed with status (1): [/home/travis/.rvm/rubies/ruby-1.8.7-p370/b...] 
```

这是失败工作的链接：[https ://travis-ci.org/#!/pokonski/public_activity/jobs/2586051](https://travis-ci.org/#!/pokonski/public_activity/jobs/2586051)

在 Ruby > 1.8.7 中一切正常。

我的 .gemspec 的相关部分：

```
 s.add_dependency 'activerecord', '>= 3.0.0'
  s.add_dependency 'activesupport', '>= 3.0.0'
  s.add_dependency 'actionpack', '>= 3.0.0'
  s.add_dependency 'i18n', '>= 0.5.0'

  if RUBY_VERSION == "1.8.7"
    s.add_development_dependency 'minitest', '>= 3.2.0'
  else
    s.add_development_dependency 'simplecov', '>= 0.6.4'
  end

  s.add_development_dependency 'bundler', '>= 1.1'
  s.add_development_dependency 'rake', '>= 0.9'
  s.add_development_dependency 'sqlite3'
  s.add_development_dependency 'mocha', '>= 0.12.1'
  s.add_development_dependency 'rails', '>= 3.0.0' # generators test 
```

和宝石文件：

```
source :rubygems

gemspec

gem 'yard' 
```

有趣的是，当使用 ruby​​-1.8.7-p370 在本地运行测试时，使用不同的缺失方法会出现错误：

```
test_resolving_values(TestCommon):
NoMethodError: undefined method `mock' for #<TestCommon:0x7ffdc8a79388>
    /home/piotrek/projekty/public_activity/test/test_common.rb:85:in `test_resolving_values' 
```

失败行的更多源代码：[https ://github.com/pokonski/public_activity/blob/master/test/test_common.rb#L85](https://github.com/pokonski/public_activity/blob/master/test/test_common.rb#L85)

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T21:26:01.340

原来是因为 test_generators.rb 使用了 Rails::Generators::TestCase，而后者又继承自 TestUnit。

因此，Mocha 错误地修补了 Test::Unit 而不是 MiniTest。解决方案是`test_helper`在 test_generators.rb 中要求并将 MiniTest gem 强制为 3.2.0 版本。

此提交中的完整解决方案：[https ://github.com/pokonski/public_activity/commit/731e953068297c7aa6f6f7e2b2251c79843943a1](https://github.com/pokonski/public_activity/commit/731e953068297c7aa6f6f7e2b2251c79843943a1)

# ruby-on-rails - 如何重构这段 Rails 代码？

> ID：12772387
> 
> 赞同：1
> 
> 时间：2012-10-07T20:00:50.600
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

只是出于好奇：

这个（相当丑陋的）Rails 代码如何被美化/重构：

```
def section_link(name, path)    
  link = link_to(name, path) 
  if name != controller.controller_name.titlecase
    link
  else
    link_to(name, path, :class => 'current')
  end
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:04:44.463

```
def section_link(name, path)
  options = {}
  options[:class] = 'current' if name == controller_name.titlecase
  link_to name, path, options
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-07T20:10:08.820

我会写：

```
def section_link(name, path)
  is_current = (name == controller.controller_name.titlecase)
  link_to(name, path, :class => ('current' if is_current))
end 
```

理由： 1) 变量`is_current`使代码更具声明性。2）`link_to`假设这`nil` 意味着空类（我们在这里想要的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T20:10:31.303

你可以这样做：

```
def section_link(name, path)
  link_to(name, path, class: name == controller.controller_name.titlecase ? "current" : nil)
end 
```

但这有点难以阅读。我会将班级确定拆分为另一种方法：

```
def section_link(name, path)
  link_to(name, path, class: class_for(name) )
end

def class_for(name)
  name == controller.controller_name.titlecase ? "current" : nil
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T20:03:09.560

```
def section_link(name, path)     
  if name != controller_name.titlecase
    link_to(name, path)
  else
    link_to(name, path, :class => 'current')
  end
end 
```

或类似的东西

```
def section_link(name, path)
  link_to(name, path, :class => "#{"current" if name == controller_name.titlecase }")
end 
```

不要认为它真的需要重构，如果它有效......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-07T20:11:35.907

```
def section_link(name, path)    
  link_to(name, path,
  *({class: "current"} if name == controller.controller_name.titlecase))
end 
```

# python - Python：max 不接受关键字参数

> ID：12772400
> 
> 赞同：0
> 
> 时间：2012-10-07T20:02:18.947
> 
> 标签：python

我正在尝试打印两个列表中的最大值：

```
print max([3,4,5,0]), max([3,4,-5,0], key = abs) 
```

我得到了错误`"max() takes no keyword arguments"`

我正在使用 Python 2.4.3

这是怎么回事？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-07T20:03:07.667

您正在使用 Python 2.4 尚不支持的 Python 功能。从[`max()`文档](http://docs.python.org/library/functions.html#max)中：

> 在 2.5 版更改: 添加了对可选键参数的支持。

您必须使用 python 列表理解来使用装饰、未装饰模式：

```
max([(abs(i), i) for i in [3,4,-5,0]])[1] 
```

# objective-c - 子视图控制器关闭后重新加载根视图控制器

> ID：12772409
> 
> 赞同：0
> 
> 时间：2012-10-07T20:03:22.310
> 
> 标签：objective-c, ios

我有这个结构：

根视图控制器->视图控制器（语言选择）由模态segue呈现。

是否可以使用委托来重新加载根视图控制器，以新选择的语言值呈现它。我通过 localize.strings 条目使用运行时语言选择。问题是，尽管语言更改后，子语言以新语言显示，但根视图仍以旧语言显示。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T04:44:17.087

获得委托或块后，您必须加载本地化的 nib，并从中获取字符串。`NSLocalizedString`将从用户默认值加载首选语言，然后更改仅在重新启动应用程序后生效。这就是您自己手动加载适当的 lproj 的原因。

您可以在[此处查看演示应用程序](https://github.com/volonbolon/localizedVC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T21:30:55.677

是的，使用委托方法或块。当在 rootViewController 中触发任何一个时，关闭子视图并进行更改。

# r - ggplot2：在单个条形图中混合简单和分组条形

> ID：12772411
> 
> 赞同：3
> 
> 时间：2012-10-07T20:03:47.390
> 
> 标签：r, ggplot2

我有一个`data.frame`：

```
df <- structure(list(sample = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 
2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L), .Label = c("A", 
"B", "C"), class = "factor"), replicate = c(1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L), 
    treatment = structure(c(1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L, 1L, 
    2L, 3L, 4L, 1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L), .Label = c("V0", 
    "V2", "V4", "V6"), class = "factor"), mean = c(72.5, 66.4, 
    60.3, 56.3, 90.7, 86.9, 68.8, 64.6, 73.3, 69.8, 62.3, 68.7, 
    77.1, 73.6, 65.9, 65.3, 75.7, 73.8, 65.9, 66.8), sd = c(5.4, 
    6.1, 3.5, 4.7, 1.2, 4.9, 8.4, 6.1, 7.3, 3.5, 5.9, 2.2, 3.2, 
    3, 3.1, 4.2, 4.2, 2.4, 2.2, 2.6)), .Names = c("sample", "replicate", 
"treatment", "mean", "sd"), class = "data.frame", row.names = c(NA, 
-20L)) 
```

对于某些样本，我进行了复制，而对于其他样本，我没有：

```
> head(df, 15)
   sample replicate treatment mean  sd
1       A         1        V0 72.5 5.4
2       A         1        V2 66.4 6.1
3       A         1        V4 60.3 3.5
4       A         1        V6 56.3 4.7
5       B         1        V0 90.7 1.2
6       B         1        V2 86.9 4.9
7       B         1        V4 68.8 8.4
8       B         1        V6 64.6 6.1
9       C         1        V0 73.3 7.3
10      C         1        V2 69.8 3.5
11      C         1        V4 62.3 5.9
12      C         1        V6 68.7 2.2
13      C         2        V0 77.1 3.2
14      C         2        V2 73.6 3.0
15      C         2        V4 65.9 3.1 
```

我想在每个`sample`值的多面条形图中绘制均值。当重复> 1时，我想获得分组条形图。 ggplot2 可以吗？

到目前为止我得到了什么：

```
g <- ggplot(df, aes(x=treatment, y=mean, fill=sample)) 
g <- g + geom_bar(position="dodge")
g <- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position="dodge")
g <- g +  facet_grid(. ~ sample)

g 
```

![条形图](../Images/6952d3508537d93bb1738c2f103262f1.png)

**编辑**

按照@Tyler Rinker 的建议，我得到：

```
g <- ggplot(df, aes(x=treatment, y=mean, fill=replicate))
g <- g + geom_bar(position="dodge", stat="identity")
g <- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position="dodge", width=0.25)
g <- g +  facet_grid(. ~ sample) 
```

![测试2](../Images/a8fe8762590a9b8f5d73f1029353ebae.png)

但是，我希望并排显示“C”样本复制的条形图。

**EDIT2**非常接近...

只需添加`group`= `replicate`：

```
g <- ggplot(df, aes(x=treatment, y=mean, group=replicate, fill=replicate))
g <- g + geom_bar(position="dodge", stat="identity")
g <- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position="dodge", width=0.25)
g <- g +  facet_grid(. ~ sample) 
```

![测试3](../Images/d8b83da244afd69fa11669709a27c8bf.png)

然而，误差线的位置还有一个问题。我想我必须玩躲闪？但是不知道怎么...

**EDIT3**最终......感谢@joran

```
dodge <- position_dodge(width = 0.9) 
```

我检查了 0.9 以外的其他值并没有导致错误条的正确定位

```
g <- ggplot(df, aes(x=treatment, y=mean, group=replicate, fill=replicate))
g <- g + geom_bar(position="dodge", stat="identity") 
g <- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position=dodge, width=0.25, color="black")
g <- g +  facet_grid(. ~ sample) 
```

![测试4](../Images/4c7b4c89418105fab988895f711f8df6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T21:39:14.200

试试这个并尝试一下：

```
dodge <- position_dodge(width = 0.9)

g <- ggplot(df, aes(x=treatment, y=mean, group=replicate, fill=replicate))
g <- g + geom_bar(position=dodge, stat="identity")
g <- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position = dodge,width = 0.25)
g <- g +  facet_grid(. ~ sample)
g 
```

我认为每个面板中不同的闪避会混淆宽度设置。我必须阅读一些关于躲闪的细节（这些部分周围有几个人可能比我自己更容易权衡......）但我*认为*当你“本地”设置躲避时在每个几何图形中，ggplot 分别根据每一层中的信息来决定宽度。所以这里的技巧似乎是确保“全局”闪避设置。

# iphone - iOS - 如何使用占位符文本创建 UITextView？

> ID：12772413
> 
> 赞同：3
> 
> 时间：2012-10-07T20:04:00.130
> 
> 标签：iphone, ios, cocoa-touch, ipad

> **可能重复：**
> [UITextView 中的占位符](https://stackoverflow.com/questions/1328638/placeholder-in-uitextview)

我对 iOS 比较陌生，我不知道如何用英语称呼它，但我想创建一些`UITextViews`包含说明或预填充文本的内容，例如“在此处输入您的姓名”或“输入您的手机”等，用浅色文本编写，但当用户选择文本视图开始输入时，它们包含的提示消失了。

是否有任何示例/教程等。我可以关注以了解更多信息？

我如何在 iOS 中做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-07T20:09:01.957

有很多方法可以做到这一点。

方法 #1： UITextView 没有占位符的属性，因此您必须将 text 属性设置为您想要的说明，然后在用户点击 UITextView 时将其清除。

方法 #2 有一个[UITextView 的子类，](https://github.com/gcamp/GCPlaceholderTextView)它添加了一个 Placeholder 属性

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-07T20:19:57.830

也许您正在寻找 UITextField。

UITextFields 更适合这种方法。然后您可以使用“占位符”属性来更改灰显的文本。

# html - 用于 Webfont 或自托管的 Google 服务器？

> ID：12772418
> 
> 赞同：9
> 
> 时间：2012-10-07T20:04:18.907
> 
> 标签：html, css

我在我的网站上使用 Google Webfont。我应该让字体托管在 Google 的服务器上并从我的服务器上引用所需的样式表，`<head>`还是应该下载字体并将它们上传到我的服务器上并使用`@font-face`.

哪种方法会增加我的服务器负载并使我的网站变慢。

字体大小为 40KB。但是，当我使用 Pingdom 的 Pagespeed 工具时，下载的字体大小以几个字节显示。

[![Pingdom 截图](../Images/72cc98527a40262665fba3a978abf686.png)](https://i.stack.imgur.com/imqLG.png)

但是，当字体托管在我的服务器上时，我认为客户端会下载完整的 40KB 文件。为什么会这样？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-05-25T01:27:25.090

我不使用谷歌的网络字体托管的最大个人动机是它恰好在中国被封锁。如果在中国加载对您来说很重要，那么自托管绝对值得。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-07T20:24:32.923

将它们保存在 Google 的服务器上。

您看到 Google 提供的小文件的原因是您的浏览器已经下载并缓存了该文件。当您上传到自己的服务器时，您的浏览器必须再次下载它，因为它认为它是一个新来源。

这也是您应该参考 Google 字体的原因之一，因为您网站的访问者可能已经从另一个使用 Google 相同字体的网站下载了这些字体。

自己托管它们自然会给您的服务器带来额外的负载。让谷歌托管他们可以让他们处理这些负载。

此外，通过从谷歌引用你让谷歌处理维护，例如更新字体以及为字体本身提供服务的语法。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-04-15T12:33:55.130

好吧，这是另一种方法：将它们托管在您的服务器上！

晚上睡得更好，尤其是如果您是 Web 开发人员。

原因。

1.  它更强大，特别是对于连接速度较慢/不太可靠的访问者。访问者可能会解析您的域，但无法解析 Google 的域，因此最终会出现大量延迟或没有字体文件，这当然是必不可少的。

2.  它更安全。还记得谷歌阅读器吗？谷歌完全取消了它。谷歌应用程序？谷歌在没有免费计划的情况下付费，甚至没有提供很小的免费计划。所以基本上，你永远不知道谷歌字体什么时候会被关闭或付费。如果您是 Web 开发人员，则这会乘以您开发的网站数量。当这种情况发生时，您愿意在几年内处理 10 个或 20 个或更多愤怒的客户吗？

是的，自我托管需要更多的工作，但我认为这是值得的。特别是对于第 2 点。

干杯。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-08T15:56:23.337

Adobe 和 Google 还有一个新选项：[https](https://edgewebfonts.adobe.com/fonts) ://edgewebfonts.adobe.com/fonts可能值得一看 :-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-07T21:03:36.090

除非您使用的是高质量、低延迟的专用服务器，否则请使用 Google 作为您的主机。而不仅仅是网络字体。Google 也托管 jQuery 和许多其他项目。

# regex - 正则表达式匹配主域名

> ID：12772423
> 
> 赞同：5
> 
> 时间：2012-10-07T20:05:01.033
> 
> 标签：regex

我需要能够识别任何子域的域名。

例子：

对于所有这些，我只需要匹配`example.co`/ `example.com`/ `example.org`/ `example.co.uk`/ `example.com.au`/`example.gov.us`等等

```
www.example.co
www.first.example.co
first.example.co
second.first.example.co
no.matter.how.many.example.co
first.example.co.uk
second.first.example.co.uk
no.matter.how.many.example.co.uk
first.example.org
second.first.example.org
no.matter.how.many.example.org
first.example.gov.uk
second.first.example.gov.uk
no.matter.how.many.example.gov.uk 
```

我整天都在玩正则表达式，整天都在谷歌搜索，但似乎还是找不到。

**Edit2：我更喜欢一个正则表达式，它可能会在 t.co 等非常奇怪的情况下失败，然后列出所有 TLD 并列出我没有列出但可能被预测失败并匹配更多的那些。这不是你会选择的选项吗？**

更新：使用选择的答案作为指导，我构建了这个为我完成工作的正则表达式。

`/([0-9a-z-]{2,}\.[0-9a-z-]{2,3}\.[0-9a-z-]{2,3}|[0-9a-z-]{2,}\.[0-9a-z-]{2,3})$/i`

*它可能并不完美，但到目前为止我还没有遇到过失败的情况。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:12:38.393

这将匹配：

```
([0-9A-Za-z]{2,}\.[0-9A-Za-z]{2,3}\.[0-9A-Za-z]{2,3}|[0-9A-Za-z]{2,}\.[0-9A-Za-z]{2,3})$ 
```

只要：

1.  每行末尾没有多余的空格
2.  所有使用的域代码都很短，有两个或三个字母长。不适用于 .info 等长域代码。

基本上它的作用是匹配以下两者中的任何一个：

1.  两个字母或更长的单词：**点**：两个或三个字母单词：**点**：两个或三个字母单词：**行尾**
2.  两个字母或更长的单词：**点**：两个或三个字母单词：**行尾**

简洁版本：

```
(\w{2,}\.\w{2,3}\.\w{2,3}|\w{2,}\.\w{2,3})$ 
```

如果您希望它只匹配整行，请在开头添加 ^

这就是我测试它的方式：

![在此处输入图像描述](../Images/edd56b884426835efdf6d3e8e0249dff.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-07T20:11:59.733

如果你想要一个绝对正确的匹配器，正则表达式不是要走的路。

为什么？

*   因为这两个都是有效的域 + TLD：`goo.gl`, `t.co`.

*   因为这些都不是（它们只是 TLD）：`com.au`, `co.uk`.

您可能创建的任何能够正确处理上述所有情况的正则表达式都只是列出了有效的 TLD，这首先会破坏使用正则表达式的目的。

相反，只需创建/获取当前 TLD 的列表并查看其中存在哪一个，然后在其前面添加第一个段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-15T20:37:06.913

这可能有任何用处。这将它们分成点符号。然后，拆分它是一个简单的问题。
`[^/:"]*\.[^/:"]*`

# visual-studio-2010 - 如何指定 $(TargetPath) 在 (cs|vb|fs)proj.user？

> ID：12772428
> 
> 赞同：1
> 
> 时间：2012-10-07T20:06:07.540
> 
> 标签：visual-studio-2010, msbuild

我有一个 Visual Studio 项目，其启动操作设置为在 PowerShell 中加载 DLL，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition="'$(Platform)' == 'Debug|x86'">
    <StartAction>Program</StartAction>
    <StartProgram>C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</StartProgram>
    <StartArguments>-NoProfile -NoExit -Command Add-Type -Path  "Foo.dll" -PassThru | Select FullName</StartArguments>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x86'">
    <StartAction>Program</StartAction>
    <StartProgram>c:\windows\system32\windowspowershell\v1.0\powershell.exe</StartProgram>
    <StartArguments>-NoProfile -NoExit -Command Add-Type -Path  "Foo.dll" -PassThru | Select FullName</StartArguments>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x64'">
    <StartProgram>C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</StartProgram>
    <StartArguments>-NoProfile -NoExit -Command Add-Type -Path  "Foo.dll" -PassThru | Select FullName</StartArguments>
    <StartAction>Program</StartAction>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x64'">
    <StartProgram>c:\windows\system32\windowspowershell\v1.0\powershell.exe</StartProgram>
    <StartArguments>-NoProfile -NoExit -Command Add-Type -Path  "Foo.dll" -PassThru | Select FullName</StartArguments>
    <StartAction>Program</StartAction>
  </PropertyGroup>
</Project> 
```

我将文件手动编辑为以下内容以消除冗余：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup '$(Platform)' == 'x86'">
    <StartProgram>C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</StartProgram>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)' == 'AnyCPU' or Condition="'$(Platform)' == 'x64'">
    <StartProgram>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</StartProgram>
  </PropertyGroup>
  <PropertyGroup>
    <StartAction>Program</StartAction>
    <StartArguments>-NoProfile -NoExit -Command Add-Type -Path  "Foo.dll" -PassThru | Select FullName</StartArguments>
  </PropertyGroup>
</Project> 
```

现在我想用“$(TargetPath)”之类的东西替换硬编码的“Foo.dll”。但是，计算结果为空字符串。以下也解析为空字符串：

*   $(程序集名称)
*   $(TargetName)$(TargetExt)
*   $(目标文件名)

设置值`<StartArguments>-NoProfile -NoExit -Command Add-Type -Path "$(Platform)" -PassThru | Select FullName</StartArguments>`确实会创建命令行`"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -NoExit -Command Add-Type -Path "x64" -PassThru | Select FullName`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T06:46:09.120

在所有 Import 指令之后移动您的属性声明，例如`<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />`

$(TargetPath) 最初是在 Microsoft.Common.targets 中定义的，因此在将该文件导入脚本之前，它不会包含任何值。如果您的属性在导入之前（以及在导入的属性出现之前）定义 - 在自上而下的属性评估阶段，未定义的属性将被解析为空字符串。

注意：我错误地没有注意到您的意思是 proj* *.user* * 文件，而不是原始 .proj 文件。我不知道 Visual Studio 何时加载 .user 文件以及加载期间设置的上下文。您可以尝试使用原始 .targets 文件中的定义。这就是在 Microsoft.common.targets 中定义 TargetDir 的方式： `<TargetDir Condition="'$(OutDir)' != ''">$([MSBuild]::Escape($([System.IO.Path]::GetFullPath(`$([System.IO.Path]::Combine( `$(MSBuildProjectDirectory)`, `$(OutDir)`))`))))</TargetDir>`

如果 .user 文件在没有任何先前构建上下文的情况下加载 - 它仍然无法正确解析 $(OutDir)。所以这仍然是您问题的不完整答案=（

# c#-4.0 - 部分 POCO 类上的计算属性阻止 DbContext 上的 linq 查询

> ID：12772433
> 
> 赞同：0
> 
> 时间：2012-10-07T20:06:49.110
> 
> 标签：c#-4.0, linq-to-entities, entity-framework-5, partial-classes

使用 EF 5.0（又名 4.3）**我将我的一个 pocos**（我从反向生成我的数据库中获得）**转换为一个部分类**，以便使用与我的数据库无关但在我的应用程序中的计算属性**来扩展它**.

虽然，当我通过 DBContext 查询 poco 时，

```
var Categories = context.CATEGORY.ToList(); 
```

它抛出一个**System.Data.SqlClient.SqlException**说：**“无效的列名'Computed_property'。”** . 因为当然 'Computed_property' 在数据库中不存在。

所以我想知道，是否有可以在属性上使用的提示或属性来避免这个问题？就像是

```
[IgnorePropertyInDB] 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T09:01:11.227

是的，`[NotMapped]`有用于此目的的属性。

# groovy - Groovy Postbuild Script Jenkins - 终止进程

> ID：12772440
> 
> 赞同：0
> 
> 时间：2012-10-07T20:07:32.583
> 
> 标签：groovy, jenkins, kill

我试图在 Jenkins 的 Groovy postbuild 脚本中启动一个新进程之前杀死所有 ruby​​ 进程。它看起来像这样：

```
def command_kill = "kill -9 `pidof ruby`"
def proc_kill = command_kill.execute()
proc_kill.waitFor() 
```

这导致

> KILL：stderr：错误：垃圾进程 ID“ruby`”。

这里有什么问题？这适用于同一服务器上的 Debian 终端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T12:18:10.650

尝试这个。

```
def procId = "pidof ruby".execute()
def killProc = "kill ${procId.in.text}".execute() 
```

# java - Java 线程检查访问

> ID：12772442
> 
> 赞同：5
> 
> 时间：2012-10-07T20:07:59.103
> 
> 标签：java, android

我在琢磨，玩弄一些代码。我在 Thread 类中遇到了以下方法：`checkAccess()`.

文档（字面意思）说*“什么都不做”。*如果它什么都不做，为什么它可能在 Thread 类中？- 我们是否可能与开发者巨魔打交道？

截屏：

![在此处输入图像描述](../Images/8e38122bccd3b2c3a2563ed79eaeb164.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:34:00.253

`Thread.checkAccess()`来自核心 Java API，所以这也是它存在的原因`Android`，但是它没有实现。

Android 的[java.lang.Thread.checkAccess()](http://developer.android.com/reference/java/lang/Thread.html#checkAccess%28%29)不提供此实现，因为它不信任[SecurityManager](http://developer.android.com/reference/java/lang/SecurityManager.html)。

> > 安全管理器不提供执行不受信任代码的安全环境。在 Dalvik VM 中无法安全地隔离不受信任的代码。

这就是`Thread.checkAccess`OpenJDK 内部的实现方式。

```
public final void checkAccess() {
    SecurityManager security = System.getSecurityManager();
    if (security != null) {
        security.checkAccess(this);
    }
} 
```

# java - 如何在java中更改ArrayList元素的值

> ID：12772443
> 
> 赞同：69
> 
> 时间：2012-10-07T20:08:01.317
> 
> 标签：java, arraylist

请帮助我使用以下代码，即使更改值后我也会得到相同的输出

```
import java.util.*;

class Test {
    public static void main(String[] args) {
        ArrayList<Integer> a = new ArrayList<Integer>();

       // added 0-9 to ArrayList        
          for(int i=0;i<9;i++)
            a.add(new Integer(i));

        // initialize the Iterator
        Iterator<Integer> i = a.iterator();

        // changed the value of first element in List
        if(i.hasNext()) {
            Integer x = i.next();
            x = Integer.valueOf(9);
        }

        // initialized the iterator again and print all the elements
        i = a.iterator();
        while(i.hasNext())
            System.out.print(i.next());
    }
}    

//Output : 012345678 
```

值 9 未更新。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-10-07T20:14:03.717

该列表正在维护对存储在列表中的原始值的对象引用。因此，当您执行此行时：

```
Integer x = i.next(); 
```

两者`x`和列表都存储对同一对象的引用。但是，当您执行时：

```
x = Integer.valueOf(9); 
```

列表中没有任何变化，但`x`现在存储了对不同对象的引用。名单没有改变。您需要使用一些列表操作方法，例如

```
list.set(index, Integer.valueof(9)) 
```

注意：正如其他人所暗示的那样，这与 的不变性*无关。*`Integer`这只是基本的 Java 对象引用行为。

* * *

这是一个完整的示例，以帮助解释这一点。请注意，这使用了[`ListIterator`](http://docs.oracle.com/javase/7/docs/api/java/util/ListIterator.html)支持在迭代中删除/设置项目的类：

```
import java.util.*;

public class ListExample {

  public static void main(String[] args) {

    List<Foo> fooList = new ArrayList<Foo>();
    for (int i = 0; i < 9; i++)
      fooList.add(new Foo(i, i));

    // Standard iterator sufficient for altering elements
    Iterator<Foo> iterator = fooList.iterator();

    if (iterator.hasNext()) {
      Foo foo = iterator.next();
      foo.x = 99;
      foo.y = 42;
    }

    printList(fooList);    

    // List iterator needed for replacing elements
    ListIterator<Foo> listIterator = fooList.listIterator();

    if (listIterator.hasNext()) {
      // Need to call next, before set.
      listIterator.next();
      // Replace item returned from next()
      listIterator.set(new Foo(99,99));
    }

    printList(fooList);
  }

  private static void printList(List<?> list) {
    Iterator<?> iterator = list.iterator();
    while (iterator.hasNext()) {
      System.out.print(iterator.next());
    }
    System.out.println();
  }

  private static class Foo {
    int x;
    int y;

    Foo(int x, int y) {
      this.x = x;
      this.y = y;
    }

    @Override
    public String toString() {
      return String.format("[%d, %d]", x, y);
    }
  }
} 
```

这将打印：

```
[99, 42][1, 1][2, 2][3, 3][4, 4][5, 5][6, 6][7, 7][8, 8]
[99, 99][1, 1][2, 2][3, 3][4, 4][5, 5][6, 6][7, 7][8, 8] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-10-15T20:43:13.317

使用 set 方法将旧值替换为新值。

```
list.set( 2, "New" ); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-10-07T20:11:51.270

你说你正在改变第一个元素的值；

```
x = Integer.valueOf(9); 
```

您正在更改`x`为指向一个全新的 Integer，但不再使用它。您不会以任何方式更改集合。

由于您正在使用 ArrayList，因此如果您想要一个允许您*更改*元素的迭代器，则可以使用 ListIterator，这是需要更改的代码片段；

> //初始化迭代器
> **ListIterator** <Integer> i = a. **列表迭代器（）**；
> 
> //改变List中第一个元素的值
> if(i.hasNext()) {
>     i.next();
>     **i.set(Integer.valueOf(9));**     // 改变迭代器当前所在的元素
> }
> 
> // 新建迭代器，并打印所有元素
> Iterator iter = a.iterator();
> while(iter.hasNext())
>     System.out.print(iter.next());
> 
> >> 912345678

遗憾的是，不能将其扩展到其他集合，如 Set<T>。实现细节（例如，作为哈希表实现的 HashSet 并更改对象可能会更改哈希值并因此更改迭代顺序）使 Set<T> 成为“仅添加新/仅删除”类型的数据结构，并更改内容在迭代它时根本不安全。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-12T17:29:35.070

我认为问题在于您认为该声明...

```
x = Integer.valueOf(9); 
```

... 导致 '9' 的值被“存储”到（！） x 所引用的对象中。

但那是错误的。

相反，该语句会导致类似的事情，就好像你会打电话一样

```
x = new Integer(9); 
```

如果您查看 java 源代码，您将详细了解发生了什么。

以下是“Integer”类中“valueOf(int i)”方法的代码：

```
public static Integer valueOf(int i) {
    assert IntegerCache.high >= 127;
    if (i >= IntegerCache.low && i <= IntegerCache.high)
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
} 
```

此外，每当第一次使用 IntegerCache 类时，都会调用以下脚本：

```
static {
        // high value may be configured by property
        int h = 127;
        String integerCacheHighPropValue =
            sun.misc.VM.getSavedProperty("java.lang.Integer.IntegerCache.high");
        if (integerCacheHighPropValue != null) {
            int i = parseInt(integerCacheHighPropValue);
            i = Math.max(i, 127);
            // Maximum array size is Integer.MAX_VALUE
            h = Math.min(i, Integer.MAX_VALUE - (-low) -1);
        }
        high = h;

        cache = new Integer[(high - low) + 1];
        int j = low;
        for(int k = 0; k < cache.length; k++)
            cache[k] = new Integer(j++);
    } 
```

您会看到在 valueOf 方法中使用“new Integer(i)”创建了一个新的 Integer Object ... ... 或者返回了对存储在 IntegerCache 中的 Integer Object 的引用。

在这两种情况下，x 都将引用一个新对象。

这就是为什么当您调用...时列表中对 Object 的引用会丢失的原因。

```
x = Integer.valueOf(9); 
```

而不是这样做，结合 ListIterator 使用......

```
i.set(Integer.valueOf(9)); 
```

...在您获得要更改的元素之后...

```
i.next(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-07T20:57:44.310

我同意 Duncan ...我已经尝试使用可变对象但仍然遇到相同的问题...我有一个简单的解决方案...使用 ListIterator 而不是 Iterator 并使用 ListIterator 的 set 方法

```
ListIterator<Integer> i = a.listIterator();
//changed the value of first element in List
Integer x =null;
        if(i.hasNext()) {
            x = i.next();
            x = Integer.valueOf(9);
        }
    //set method sets the recent iterated element in ArrayList
    i.set(x);
        //initialized the iterator again and print all the elements
        i = a.listIterator();
        while(i.hasNext())
        System.out.print(i.next()); 
```

但这限制了我只能将它用于可以使用 ListIterator 的 ArrayList ......我对任何其他 Collection 都会有同样的问题

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-07T20:12:30.723

您正在尝试更改列表中的值，但您所做的只是更改 x 的引用。执行以下操作只会更改 x，而不是集合中的任何内容：

```
x = Integer.valueOf(9); 
```

此外，`Integer`它是不可变的，这意味着您无法更改 Integer 对象内的值（无论如何这都需要不同的方法）。这意味着您需要替换整个对象。没有办法用一个`Iterator`（不添加你自己的拳击层）来做到这一点。请改为执行以下操作：

```
a.set(0, 9); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-03T04:40:24.173

将其更改为`for(int i=0;i<=9;i++)`

# java - 添加 到上一个 Queue 类的对象

> ID：12772444
> 
> 赞同：0
> 
> 时间：2012-10-07T20:08:04.717
> 
> 标签：java, object, linked-list, queue

我已经编写了一个 ObjectQueue 类来处理对象，但我也希望能够处理 LinkedList 类型，这样我将拥有一个使用链表的对象队列。这甚至可能吗？

基本上我想要类似的东西

```
ArrayList<LinkedList <Job> > data 
```

除了：`ObjectQueue<LinkedList <Job> > data`

我怎么能修改我的班级：

```
public class ObjectQueue {
      private Object[] item;
      private int front;
      private int rear;
      private int size;

    public ObjectQueue() {
        size = 100;
        item = new Object[size];
        front = size-1;
        rear  = size-1;
    }

    public ObjectQueue(int max) {
        size = max;
        item = new Object[size];
        front = size-1;
        rear  = size-1;
    }

    public boolean isEmpty() {
        return front == rear;
    }

    public boolean isFull() {
       return rear == size-1 ? front == 0 : front == rear+1;
    }

    public void clear() {
        front = size-1;
        rear  = size-1;
    }

    public void insert(Object x) {
        if (isFull()) {
            System.out.println("Insert Runtime Error: Queue Overflow");
            System.exit(1);
        }
        if (rear == size-1)         // or rear = (rear+1) % size;
            rear = 0;
        else
            rear++;
        item[rear] = x;
    }

    public Object remove() {
        if (isEmpty()) {
            System.out.println("Remove Runtime Error: Queue Underflow");
            System.exit(1);
        }
        if (front == size-1)            // or front = (front+1) % size;
            front = 0;
        else
            front++;
        return item[front];
    }

    public Object query() {
        if (isEmpty()) {
            System.out.println("Query Runtime Error: Queue Underflow");
            System.exit(1);
        }
        if (front == size-1)
            return item[0];
        else
            return item[front+1];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:40:28.520

您需要使您的类通用：

```
public class ObjectQueue<T> {
    ...
    public void insert(T x) {
        ...
    }
    public T remove() {
        ...
    }
    ...
} 
```

# cuda - cuda适用于数组过滤吗

> ID：12772450
> 
> 赞同：1
> 
> 时间：2012-10-07T20:09:32.403
> 
> 标签：cuda

我正在优化时间复杂度为 O(N^7) 的程序。我有一个字符串数组，表示为 32 位整数，其中每个位对应于输入字符串中的特定字符。工作是找到输入字符串的所有组合，其中每个字符只出现一次，并且所有字符都出现。简单的解决方案需要 7 层递归，每一层迭代整个列表。这很快就会变得非常缓慢。

所以我想知道我是否可以使用 cuda 来加快这个过程，通过为 GPU 提供一个可能的字符串数组和一个不应该匹配的位掩码，然后返回一个过滤列表，这样我就可以加快递归步骤有点。

那么问题来了：这种过滤适合并行处理吗？

下面描述了我现在在 C 中所做的事情。

```
void recursive_search (unsigned int used, unsigned int *list, int listlen,
                       int start,unsigned int * stack, int reclevel) {
  int index, newindex;
  newindex = 0;

  for (index=0; index< listlen; index++) {
    if (!list[index] & used) {
      newlist[newindex++] = list[index];
    }
  }      

  if ((newindex == 1 && (used | newlist[0])) == 0xffffffff) {
    /* Hooray! We have a match */
    stack[reclevel] = newlist[0];
    report_match(stack);
    return;
  }

  for (index = 0;index < newindex; index++) {
    recursive_search (used | newlist[index], newlist, newindex,
                      index, stack, reclevel + 1);
  }
} 
```

我希望这能让我的问题更清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T12:37:02.013

1.  不要尝试将完整的算法转换为单个内核。尝试一步一步并行化。

下面的这段代码可以转换为 copy_if 语句。

```
for (index=0; index< listlen; index++) {
    if (!list[index] & used) {
        newlist[newindex++] = list[index];
    }
} 
```

声明就像

```
thrust::copy_if(list.begin(), list.end(), newlist.begin(), predicate()); 
```

因此，您将轻松实现新列表。

您可以在 GPU 上生成可能的字符串数组吗？

关于递归：

*   因为您将在 GPU 中激活许多线程，所以可能有多个结果/匹配。返回第一个匹配项或所有匹配项可能是个问题。
*   如果递归是必须的，您可以通过每次将部分进度存储在全局内存中来多次调用内核。
*   正如@harrism 所指出的，您可以将递归部分转换为更简单的流程，并让并行处理每种情况。

# c# - C# 从 MP4 流中提取位图

> ID：12772455
> 
> 赞同：6
> 
> 时间：2012-10-07T20:09:59.733
> 
> 标签：c#, dll, bitmap, stream, mp4

最近，我在互联网上搜索了很多用于从 MP4 视频中提取位图的好 C# 库，我发现了与此代码类似的东西，但与 MP4 不同：

```
 VideoStream stream = aviManager.GetVideoStream(@"C:\Users\User\Desktop\video.mp4");
        //the video.mp4 is usually .avi or .mpeg
        for (int n = 0; n < stream.CountFrames; n++)
        {
            Bitmap bmp = new Bitmap(stream.GetBitmap(Position));
            bmp.Save(@"C:\Users\Nehoray\Desktop\Something.png");
            bmp.Dispose;
        } 
```

谁能给我一个像这样简单代码的库，只用于 MP4？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T20:47:16.083

我已将 Expression Encoder SDK 用于类似的任务。他们[声明](http://social.expression.microsoft.com/Forums/en-US/encoder/thread/3eabf903-b49f-4f92-b508-f28a795d6c90)支持 MP4。看一下[AudioVideoFile.GetThumbnail](http://msdn.microsoft.com/en-us/library/microsoft.expression.encoder.audiovideofile.getthumbnail%28v=expression.40%29.aspx)方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:35:22.697

对于avi，我曾经写过这样的东西：

```
string filename = "file.avi";
string storagepath = @"temp\";
static int counter = 0;
MediaDetClass memde;

private void button1_Click(object sender, EventArgs e)
{
    if (openFileDialog1.ShowDialog() == System.Windows.Forms.DialogResult.OK)
    {
        // Create the subfolder
        System.IO.Directory.CreateDirectory("temp");

    // Some properities
        counter = 0;
        memde = new MediaDetClass();
        Image img;
        memde.Filename = openFileDialog1.FileName;
        memde.CurrentStream = 0;
        int len = (int)memde.StreamLength;
        float percent = 0.002f;//how far do u want for a single step

        for (float i = 0.0f; i < len; i = i + (float)(percent * len))
        {

            counter++;
            string fbitname = storagepath + counter.ToString();
            memde.WriteBitmapBits(i, 850, 480, fbitname + ".bmp");
            //img = Image.FromFile(fbitname + ".bmp");
            //img.Save(fbitname + ".bmp", ImageFormat.Bmp);
            //img.Dispose();
            //System.IO.File.Delete(i + fbitname + ".bmp");
        }
} 
```

使用的库是：`Interop.DexterLib.dll`，我现在不确定您是否可以在 C# 资源中找到它。如果你愿意，我可以分享链接。

* * *

[GitHub Repo](https://github.com/mmokrzycki/Libs)只需下载 RAW 文件（在 C# 文件夹中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-23T15:17:42.483

对于在这篇文章中运行的其他任何人，请查看此答案：[Get thumbnail image of video file in C#](https://stackoverflow.com/questions/15702031/get-thumbnail-image-of-video-file-in-c-sharp)

其中一篇文章提到了一个名为[NReco.VideoConverter](http://www.nuget.org/packages/NReco.VideoConverter/)的 NuGet 包。这使您可以很容易地从 MP4 文件创建缩略图：

```
var ffMpeg = new NReco.VideoConverter.FFMpegConverter();
ffMpeg.GetVideoThumbnail(pathToVideoFile, pathToNewThumbnail, locationInSeconds); 
```

# javascript - 如何获取具有表 ID 的 dhtmlx 表对象？

> ID：12772461
> 
> 赞同：1
> 
> 时间：2012-10-07T20:10:43.473
> 
> 标签：javascript, dhtmlx

在一个页面上，如果有十几个 dhtmlx 网格，是否可以使用表 ID 获取网格对象？

我需要它将表格与其 PDF/Excel 生成按钮相关联。一种方法是将对象存储在数组中。还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T14:09:54.617

如果要从表中初始化 dhtmlxgrid，则可以使用表的 name 属性

```
<table name="mygrid1">
...
<input onlclick='mygrid1.toPDF(some)'> 
```

# java - 在发布模式下测试应用

> ID：12772465
> 
> 赞同：0
> 
> 时间：2012-10-07T20:11:10.863
> 
> 标签：java, android

如何在发布模式下测试应用程序？我试过`ant release test`了，但它给出了这个错误

```
test:
 [echo] Running tests ...
 [exec] INSTRUMENTATION_STATUS: id=ActivityManagerService
 [exec] INSTRUMENTATION_STATUS: Error=Unable to find instrumentation info for: ComponentInfo{com.kizbit.speedyreader.tests/android.test.InstrumentationTestRunner}
 [exec] INSTRUMENTATION_STATUS_CODE: -1
 [exec] android.util.AndroidException: INSTRUMENTATION_FAILED: com.kizbit.speedyreader.tests/android.test.InstrumentationTestRunner 
```

我已经将密钥库复制到了测试项目。

我想在发布模式下进行测试，因为它可以节省很多状态。如果我在调试模式下重新安装，那么我必须卸载并重新安装它，这会删除所有状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:53:23.667

好的，我找到了方法。请务必检查测试包的 AndroidManifest.xml 中的包名称和测试类的路径。由于某种原因，清单中的包名称是 com....tests，而类不在 /tests 目录中。我不知道它是如何工作的，但它曾经用于正常调试。

要让它在发布模式下进行测试，您必须使用`ant release install test`. 我忘记安装了。此外，`test`将始终构建您的应用程序的调试版本，因此您必须手动转到真正的应用程序项目目录，然后运行`ant release install`，这将安装发布版本。然后，转到测试项目目录并运行`ant release install test`. 这将给出一个错误

```
Failure [INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES] 
```

当它尝试安装实际应用程序时，因为它已经使用发布密钥安装。你可以忽略这个。此外，您必须删除测试项目的调试版本，`adb uninstall com........tests`以确保在尝试安装测试的发布版本时它不会出现此错误。

此外，您必须将实际项目目录中的 release.keystore 文件复制到测试项目目录中，如果您将密钥保存在 ant.properties 中，您还必须将这些条目复制到测试 ant.properties 中

```
key.store=release.keystore
key.alias=mykey
key.store.password=password
key.alias.password=password 
```

然后它将使用发布版本进行测试！

请记住，由于它不会安装实际的应用程序，因此如果您要更改内容，则必须从应用程序目录手动重新编译并重新安装发布版本。也许有一种方法可以通过修改 build.xml 来自动构建和安装发布版本，但我还没有检查过。

# javascript - 用于 jQuery 不同尺寸的 Kwicks

> ID：12772474
> 
> 赞同：0
> 
> 时间：2012-10-07T20:12:01.403
> 
> 标签：javascript, jquery, kwicks

我正在为 jQuery 使用 Kwicks 进行垂直下拉：http: [//www.jeremymartin.name/projects.php? project=kwicks](http://www.jeremymartin.name/projects.php?project=kwicks)

看一下标记：

```
<ul class="kwicks">
    <li id="kwick1">
        <div class="title">Title 1</span>
        <div class="item"><b>Item 1</b> Description 1</div>
        <div class="item"><b>Item 2</b> Description 2</div>
        <div class="item"><b>Item 3</b> Description 3</div>
        <div class="item"><b>Item 4</b> Description 4</div>
    </li>
    <li id="kwick2">
        <div class="title">Title 2</span>
        <div class="item"><b>Item 1</b> Description 1</div>
        <div class="item"><b>Item 2</b> Description 2</div>
        <div class="item"><b>Item 3</b> Description 3</div>
        <div class="item"><b>Item 4</b> Description 4</div>
        <div class="item"><b>Item 5</b> Description 5</div>
        <div class="item"><b>Item 6</b> Description 6</div>
    </li>
    <li id="kwick3">
        <div class="title">Title 3</span>
        <div class="item"><b>Item 1</b> Description 1</div>
        <div class="item"><b>Item 2</b> Description 2</div>
    </li>
    <li id="kwick4">
        <div class="title">Title 4</span>
        <div class="item"><b>Item 1</b> Description 1</div>
        <div class="item"><b>Item 2</b> Description 2</div>
        <div class="item"><b>Item 3</b> Description 3</div>
        <div class="item"><b>Item 4</b> Description 4</div>
    </li>
</ul> 
```

Javascript：

```
$().ready(function() {
    $('.kwicks').kwicks({
        min : 15,
        spacing : 9,
        isVertical : true,
        sticky : true,  
        event : 'click' 
    });
}); 
```

在这里看到它：http: [//jsfiddle.net/6xL5M/3/](http://jsfiddle.net/6xL5M/3/)

如您所见，它们具有不同的内容大小，并且默认情况下，jQuery 的 Kwicks 都以相同的大小显示，难道没有办法让每个人都有自己的高度吗？

非常感谢提前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T22:06:07.567

我只是花时间浏览 Kwicks 并在我自己的沙箱上处理代码，以便弄清楚如何为每个 li 制作一个具有不同高度的列表（当不处于活动状态时）。

不幸的是，答案是 kwicks 库不支持。我想出了两种不同的方式。首先我查看了 API --- 这个设置没有配置。其次，我尝试在 Kwicks 之上使用 CSS 获得结果，但是 Kwicks 库在其计算中不考虑我的任何 CSS，因此元素最终位于其他元素之上（错误）。

如果你想要那种类型的功能，你要么必须扩展 Kwicks 库，要么只编写自己的代码来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T14:51:04.160

@richardaday 的答案是正确的（我是 Kwicks 的作者，所以......相信我：p）。

仅供参考，我今天将 Kwicks 搬到了新家：http: [//devsmash.com/projects/kwicks](http://devsmash.com/projects/kwicks)。您最有可能使用的旧版本的文档位于[http://devsmash.com/projects/kwicks/1.5.1](http://devsmash.com/projects/kwicks/1.5.1)。不过，我强烈建议更新到最新版本 - 1.5.x 中存在已知错误，而 2.x 的整体体验应该会更好。

请注意，虽然尚不支持可变大小的面板，但这似乎不是一个不合理的添加功能。随意打开一个功能请求，我可以开始研究它的可行性：[https ://github.com/jmar777/kwicks/issues](https://github.com/jmar777/kwicks/issues)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T01:14:14.050

这是我解决这个问题的方法：http: [//jsfiddle.net/6xL5M/5/](http://jsfiddle.net/6xL5M/5/)

我没有为此使用 Kwicks 插件，只是简单的 jQuery，基本上是：

```
$(".kwicks #kwick1").click(function() { 
    $(this).animate({height: 4 * itemsize + titlesize +'px'}, 600, 'easeOutQuint');
    $(this).siblings().animate({height: titlesize +'px'}, 750, 'easeOutQuint');
}); 
```

其中**4 个**引用者表示它有多少个项目，**itemsize**是每个项目的高度，**titlesize**是标题的高度。它还将兄弟姐妹重置为标题的高度。

也许它可以帮助某人。

谢谢你的支持！

# django - Django：如何设置 jQuery-Raty 的静态设置？

> ID：12772478
> 
> 赞同：2
> 
> 时间：2012-10-07T20:12:27.853
> 
> 标签：django, raty

我正在尝试让[jquery.raty](http://www.wbotelhos.com/raty/)与 Django 一起工作。我已经完美地设置了静态文件的服务，但是毕竟找到评级图像文件似乎有问题。

这就是我的设置方式：

**base.html（这里的静态加载很好）**

```
<script src="{{ STATIC_URL }}raty/js/jquery.raty.min.js"></script> 
```

**模板：**

```
<div id="star"></div> 
```

**js**

```
$('#star').raty({
      cancel    : true,
      cancelOff : 'cancel-off-big.png',
      cancelOn  : 'cancel-on-big.png',
      half      : true,
      size      : 24,
      starHalf  : 'star-half-big.png',
      starOff   : 'star-off-big.png',
      starOn    : 'star-on-big.png'
    }); 
```

但我看到的不是星星，而是替代文本数字：

![在此处输入图像描述](../Images/231bb031175683899377272aa4ec65c2.png)

这是我在刷新页面时从服务器收到的消息：

```
[07/Oct/2012 21:03:48] "GET /contact/add/img/star-off-big.png HTTP/1.1" 200 9941 
```

我不明白为什么它会查看当前位置（[http://127.0.0.1:8000/contact/add/](http://127.0.0.1:8000/contact/add/)）并附`/img/xxx.png`加到`/contact/add/`.

如何使用 STATIC_URL 路径设置 javascript 中图像的路径？

非常感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:19:09.350

Raty的默认`path`值为“img”。尝试`path`作为绝对 URL 传递：

```
$('#star').raty({
    cancel    : true,
    cancelOff : 'cancel-off-big.png',
    cancelOn  : 'cancel-on-big.png',
    half      : true,
    size      : 24,
    starHalf  : '../raty/img/star-half-big.png',
    starOff   : 'star-off-big.png',
    starOn    : 'star-on-big.png',
    path      : '{{ STATIC_URL }}img' // <-- or wherever your raty images are
}); 
```

**编辑：**

一种使用 jQuery“命名空间”变量`STATIC_URL`在其他外部 javascript 文件中使用的方法。这将在`<head>`您的模板中定义，*在*包含 jQuery 之后但*在*任何使用定义变量的脚本之前。

```
<script type="text/javascript">  
    $.myproject = {} // namespace
    $.myproject.STATIC_URL = '{{ STATIC_URL }}';
</script> 
```

然后，您的其他脚本可以`$.myproject.STATIC_URL`在需要静态资产的绝对 URL 时使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-17T15:54:31.307

最简单的方法是全局设置路径，以防您要使用多个评级，这样您就不需要到处重复了。

```
<script type="text/javascript" src="{{ STATIC_URL }}raty/jquery.raty.min.js"></script>
<script type="text/javascript">
    $.fn.raty.defaults.path = '{{ STATIC_URL }}raty/img';
</script> 
```

# matlab - 键入几个可变参数

> ID：12772483
> 
> 赞同：5
> 
> 时间：2012-10-07T20:13:05.653
> 
> 标签：matlab, matrix, variadic-functions

我有一个使用 varargin 作为输入的函数，但是当我必须调用这个函数时，我创建了几个矩阵，并且在命令窗口中键入所有这些矩阵非常低效。

首先，我使用一个函数来创建例如 50 个 2x2 矩阵。而当我必须使用这个其他功能时，我必须一一调用，例如：`rich(A(:,:,1), A(:,:,2), (...), A(:,:,50))`

有没有一种最简单的方法来调用这些矩阵而无需一一键入？类似的东西`rich(A(:,:,1:50) or rich(A(:,:,1):A(:,:,50))`（我知道这是不可能的，但我一直在寻找这样的东西......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:23:32.527

试试这个：

```
%# random matrix of size 2x2x50
A = rand(2,2,50);

%# split by slices along the third dimension: AA = {A(:,:,1); ...; A(:,:,50)}
AA = mat2cell(A, 2, 2, ones(1,size(A,3)));
AA = AA(:);

%# call function, expanding into a comma-separated list
rich(AA{:}) 
```

# java - 如何找到已打印的元素并再次跳过它们打印？

> ID：12772484
> 
> 赞同：1
> 
> 时间：2012-10-07T20:13:09.030
> 
> 标签：java, arrays, adt, repeat, bag

有问题的方法如下。这个方法应该接受一个字符串并使用 bag adt 返回一个项目的频率。我让它工作，但是如果我（例如）输入“测试”，它将显示输出 T、S 和 T 及其各自的（尽管是正确的）频率。但是，我希望输出只是 T，S 和它们的频率。

```
 public int getFrequency(String str){
        int index=0;
        char[] nArray = new char[sArray.length];

        for(int i=0;i<sArray.length; i++){
            char a = sArray[i];
            String s = Character.toString(a);
            index = consonants.getFrequencyOf(s);
            if(index != 0 && consonants.contains(s)==true){
                for(int x=0;x<nArray.length;x++){
                    if(nArray[i] == sArray[x]){
                        continue;
                    }
                    else{
                        System.out.print(s + ": ");
                        System.out.println(index);
                        nArray[i] = sArray[i];
                        break;
                    }       
                }
            }
        }
        return index;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:23:50.340

您应该使用`HashMap`, 来存储具有相应频率的字符：-

```
public Map<Character, Integer> getFrequency(String str){

    String vowels = "aeiouAEIOU";
    Map<Character, Integer> freqMap = new HashMap<Character, Integer>();

    for(int i=0;i<str.length(); i++) {

        char ch = str.charAt(i);

        // If character is a not consonant.. continue with next iteration

        if (vowels.contains(ch)) {
            continue;
        }

        Integer val = freqMap.get(ch);

        if (val != null) {
            // Put new entry in Map.. With character and count = 1

        } else {
            // Increment val by 1, and update the map for this character
        }

    }
    return freqMap;
} 
```

**只是对您的代码的确认：-**

```
index = consonants.getFrequencyOf(s);
if(index != 0 && consonants.contains(s)==true){ 
```

第二个条件对我来说看起来很模糊。因为如果`index !=0`，那么它意味着`consonants`包含`s`.. 那为什么还要检查呢？

或者，`getFrequencyOf(s)`除了检查收容措施之外，您还在做其他我们看不到的事情？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:49:53.957

我认为问题出在 else 块中。无论如何你都会得到它。但是只有在循环结束时才需要得到它。您应该像这样重写内部循环：

```
 public int getFrequency(String str){
                    char[] sArray = str.toCharArray();
                    char[] nArray = new char[sArray.length];
                    int[] fArray = new int[sArray.length];

                    for(int i=0; i < sArray.length; i++){
                        char a = sArray[i];
                        String s = Character.toString(a);

                        if(consonants.contains(s)==true){        

                            for(int x=0; x <= i; x++){
                                if(nArray[x] == sArray[i]){
                                    fArray[x]++;

                                    break;
                                }

                                if (x == i){
                                    nArray[i] = sArray[i];
                                    fArray[i] = 1;
                                }       
                            }                
                        }
                    }        

                    for (int k = 0; k < fArray.length; ++k){
                       if (nArray[k] == 0){
                           continue;
                       }

                       System.out.println(String.valueOf(sArray[k]) + ": " + String.valueOf(fArray[k]));
                    }

                    return fArray[fArray.length - 1];
                } 
```

# sql-server-2008 - 网站管理工具：在应用程序配置中未找到连接名称“LocalSqlServer”或连接字符串为空

> ID：12772486
> 
> 赞同：0
> 
> 时间：2012-10-07T20:13:44.943
> 
> 标签：sql-server-2008, asp.net-membership, website-admin-tool

我正在尝试使用网站管理工具为我的服务器上的网站配置成员资格。我已经在我的本地 SQL Server 副本上创建了一个 aspnetdb 数据库，并且通过 WSAT，我设法添加了几个角色，并锁定了服务器上的几个目录。

但是，当我尝试管理用户时，出现以下错误：

> 在应用程序配置中找不到连接名称“LocalSqlServer”或连接字符串为空。在 System.Web.Util.SecUtility.GetConnectionString(NameValueCollection config) 在 System.Web.Security.SqlMembershipProvider.Initialize(String name, NameValueCollection config) 在 System.Web.Configuration.ProvidersHelper.InstantiateProvider(ProviderSettings providerSettings, Type providerType)

显然，LocalSqlServer 连接字符串*是*可以的，否则我将无法添加角色，例如。

web.config的相关部分如下：

```
 <connectionStrings>
        <clear />
        <remove name="LocalSqlServer"/>
        <add name="LocalSqlServer" connectionString="Data Source=(local);Initial Catalog=aspnetdb;User Id=LoginUser;Password=password;" providerName="System.Data.SqlClient"/>
  </connectionStrings>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880" defaultUrl="~/admin/admin.aspx" />
    </authentication>
        <membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="15">
            <providers>
                <clear />
                <add
          name="SqlProvider"
          type="System.Web.Security.SqlMembershipProvider"
          connectionStringName="LocalSqlServer"
          applicationName="myapp" />
            </providers>
        </membership>
    <profile>
      <providers>
        <clear />
                <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="LocalSqlServer" applicationName="myapp" />
      </providers>
    </profile>
    <roleManager enabled="true">
      <providers>
        <clear />
                <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="LocalSqlServer" applicationName="myapp" />
      </providers>
    </roleManager>
  </system.web> 
```

据我了解，清除/删除元素应该覆盖任何其他配置文件，但无论如何，我尝试将相同的连接字符串添加到相关的 machine.config，但无济于事。

有任何想法吗？

作为替代方案，是否有任何理由不能直接调用 Membership DB 存储过程？有谁知道任何支持文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T06:46:56.853

经过一番研究，我为您找到了可能的解决方案。我想您可能已经阅读了我找到的一些主题，但我试图指出与您向我们展示的版本的不同之处。

## 在角色管理器标签中，

您尚未设置`defaultProvider`可能导致问题的选项。

```
<roleManager enabled="true" defaultProvider="AspNetSqlRoleProvider"> 
```

有关更多详细信息，请参阅[此链接](http://aspnet.4guysfromrolla.com/articles/121405-1.aspx)。这也是我的参考。

## 我也注意到了

在你`connectionString`的“d”里面`User ID`不是大写的。不确定它是否区分大小写。

此外，有些线程似乎是`Integrated Security=`根据自己的需要设置的，在 中`connectionString`，您可能会尝试这样做。

请参阅[此链接](https://support.winhost.com/KB/a813/parser-error-message-connection-name-localsqlserver.aspx)。

## 显然，

> 默认情况下，成员资格/角色提供程序使用“localSQLServer”连接字符串，该字符串 [...] 设置为从根 web.config 指向本地 SQL Express 数据库。在大多数情况下，服务器没有安装 SQL express，你会得到这个错误。
> 
> 通过清除连接字符串应该可以揭示这些错误。
> 
> [参考](http://forums.asp.net/t/1483981.aspx/1)

但我相信您已经在`</clear>`各处使用该标签，这是正确的。

## 更多参考资料

您可能还想看看[aspnet 论坛](http://forums.asp.net/search)，因为这是他们的技术。我输入了你的错误信息，实际上得到了很多结果。

## 最后

如果这些建议中的任何一个都没有解决您的问题，我建议从“从头开始”重新开始，一个一个地添加每个配置。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:33:45.863

我尽可能多地放弃了最初的尝试，然后重新开始。这次我创建了一个新的、单独的会员数据库，并从 machine.config 中注释掉了所有角色和会员提供者元素......

这并没有解决问题，但在此过程中，我意识到即使我修改了 machine.config，WSAT 仍在从*某个地方*获取角色提供程序配置。这导致我点击了 x86 machine.config，这反过来又让我回到了应用程序池——应用程序池被设置为启用 32 位应用程序。

将此重置为 false 使我能够克服我的错误，尽管会出现不同的错误 - 但是，我将单独调查此问题并在必要时创建一个新帖子。

我不确定为什么 32 位应用程序池会导致问题 - 我仍然希望我的 web.config（带有`<clear />`项目）应该替换从 machine.config 继承的所有适当设置 - 无论它可能是哪个版本是。因此，我的“重建”的其他部分可能也做出了贡献；很难说。

恐怕不是我希望的最终解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-08T07:42:34.397

这对我有用：

1.  在 Visual Studio 中，转到服务器资源管理器并附加 aspnetdb
2.  右键单击aspnetdb - 修改连接
3.  如果连接测试有效，请单击“高级”并在窗口按钮处复制连接字符串
4.  在您的 web.config/ConnectionStrings/ApplicationServices/ConnectionString 中替换此连接字符串

# c# - Union 或 Concat 中的类型不能用层次结构构造

> ID：12772489
> 
> 赞同：1
> 
> 时间：2012-10-07T20:14:09.367
> 
> 标签：c#, asp.net, linq

我正在尝试运行与以下非常相似的查询：

```
(from bs in DataContext.TblBookShelf
join b in DataContext.Book on bs.BookID equals b.BookID
where bs.BookShelfID == bookShelfID 
select new BookItem
{
        Categories = String.Join("<br/>", b.BookCategories.Select(x => x.Name).DefaultIfEmpty().ToArray()),
    Name = b.Name,
ISBN = b.ISBN,
BookType = "Shelf"
}).Union(from bs in DataContext.TblBookShelf
join bi in DataContext.TblBookInventory on bs.BookID equals bi.BookID
    select new BookItem
    {
          Categories = String.Join("<br/>", bi.BookCategories.Select(x => x.Name).DefaultIfEmpty().ToArray()),
          Name = bi.Name,
      ISBN = bi.ISBN,
      BookType = "Inventory"
}); 
```

语句执行后，我收到“不能使用层次结构构建联合​​或 Concat 中的类型”，我需要能够获得要与每本书一起显示的类别列表。如果有人能对可能的解决方案有所了解，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:35:20.160

问题是您在合并的查询中选择一个子序列（即`b.BookCategories`）。这是 LINQ 2 SQL 限制。它无法将其转换为 SQL（因为它很难做到，所以我猜团队选择不支持它）。

摆脱子序列选择。在这种情况下，最简单的解决方法可能是执行联合客户端。执行两个服务器端查询并合并结果。

无论如何，性能都会很糟糕，因为如果序列子选择。您可能想研究如何以有效的方式使用 L2S 获取树。

# unity3d - Unity - 如何在触发器输入时获得碰撞角度？

> ID：12772491
> 
> 赞同：2
> 
> 时间：2012-10-07T20:14:12.860
> 
> 标签：unity3d, collision, angle

我正在尝试构建一个破砖游戏，我想根据球击中球拍的位置来瞄准球。例如，如果球击中桨的右边缘，它应该向右（向上）。假设桨有一个盒子（或胶囊）对撞机，而球有一个球对撞机，我该怎么做？谢谢你的帮助！

我也想得到垫子的速度。下面的代码返回0，有什么想法吗？

```
function OnTriggerEnter(other:Collider)
{
    if(other.rigidbody){
    V_pad=other.rigidbody.velocity;
    //Here it returns (0,0,0) , also tried other.attachedRigidbody
    }    

    if(other.name=="Pad"){
    rigidbody.velocity = 
Vector3(rigidbody.velocity.x, Mathf.Abs(rigidbody.velocity.y + V_pad),0); 
//this part executes but with V_pad.y=0
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T08:36:24.320

当 Unity 中的两个碰撞器接触时，该[`OnCollisionEnter`](http://docs.unity3d.com/Documentation/ScriptReference/Collider.OnCollisionEnter.html?from=Collision)方法将在您添加到同一个 GameObject 的任何组件中调用。如果您使用[`Collision`](http://docs.unity3d.com/Documentation/ScriptReference/Collision.html)参数定义该方法，您将获得包括两个对撞机之间的接触点的信息。您可以使用此信息来计算出您的球触及球棒的位置。

请注意，从球的角度来看，这将始终是球体“底部”的一个点。您可能还需要考虑球速度的角度。

**编辑：**另一种方法（根据您的评论）可能是使用[`Collider.ClosestPointOnBounds`](http://docs.unity3d.com/Documentation/ScriptReference/Collider.ClosestPointOnBounds.html). 如果你使用类似的东西`bat.ClosestPointOnBounds(ball)`，你会得到`Vector3`最接近球的球棒上的点 - 对于球形球来说，这将是碰撞点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T08:29:48.830

或者也为桨使用球体对撞机。您可以将对撞机的中心移动到桨后面一点，然后缩放对撞机以满足您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T01:46:05.170

尝试使用 Vector3D 类来查找球的方向，然后根据它应该击中的表面来更改向量的该分量。使用 Unity [Vector3D API](http://docs.unity3d.com/Documentation/ScriptReference/Vector3.html)获得更多帮助。祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-13T18:02:42.890

您需要取消选中对撞机中的 Is Trigger 设置，并使用 OnCollision 而不是 OnTrigger。在 OnCollision 中，您可以使用类似的方法来计算输出方向。

var direction = Vector3.Reflect(lastFrameVelocity.normalized, collision.contacts[0].normal);

# vb.net - VB中大于X小于Y怎么办？

> ID：12772492
> 
> 赞同：2
> 
> 时间：2012-10-07T20:14:16.837
> 
> 标签：vb.net, visual-studio, visual-studio-2012

这是我尝试过的……我认为这是完全错误的，因为它不起作用。

```
If ProgressBar1.Value > 5 < 20 Then
    Label8.Text = "Hello"
End If 
```

非常感谢所有帮助！谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:15:15.847

```
If ProgressBar1.Value > 5 AndAlso ProgressBar1.Value < 20 Then
    Label8.Text = "Hello"
End If 
```

是一种方式。

`AndAlso`表示如果第一个值评估为假，则条件将“短路”。因此，如果 ProgressBar1.Value 不 > 5 - 它不会费心检查其余的条件。

您也可以使用`And`

```
If ProgressBar1.Value > 5 And ProgressBar1.Value < 20 Then
    Label8.Text = "Hello"
End If 
```

它会评估这两种情况。在这种特殊情况下，它不会有太大的区别，但我通常更喜欢 AndAlso/OrElse 而不是 And/Or

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:17:03.157

你必须使用“And”行来做一个 and 语句。它应该看起来像这样

```
If ProgressBar1.Value > 5 And ProgressBar1.Value < 20 Then
    Label8.Text = "Hello"
End If 
```

此外，如果您只希望其中一个为真，则可以使用“或”语句。

# javascript - 如何在Javascript中获得变量的相反布尔值

> ID：12772494
> 
> 赞同：29
> 
> 时间：2012-10-07T20:14:32.940
> 
> 标签：javascript

```
var a = true; 
```

如何获得`a`（假）的相反值，反之亦然？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-10-07T20:15:19.710

```
>>> a = true;
true
>>> !a;
false 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-10-07T20:15:52.017

使用[逻辑 NOT](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Logical_NOT_(!))运算符：

```
!a 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-09-18T22:05:04.410

这会容易得多

```
var b = !a 
```

这将使真为假，假为真

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-03-25T13:46:53.530

尝试以下操作：

```
var a = !a; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-07T20:17:13.213

使用“非”运算符

```
var a = true;
alert(!a); //=>false 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-07T20:17:28.133

也许是这样的；

```
function toggleFlag(value){
   var toggle = value ? false : true;
   return toggle;
}

var a = true;

a = toggleFlag(a); 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2019-01-08T10:03:55.273

尝试如下

```
var Boolify = require('node-boolify').Boolify;
var opp_var = !Boolify(myVar); 
```

参考[node-boolify](https://www.npmjs.com/package/node-boolify)

# python - 将熊猫（python）数据帧序列化为二进制格式

> ID：12772498
> 
> 赞同：3
> 
> 时间：2012-10-07T20:15:34.180
> 
> 标签：python, dataframe, pandas

这篇文章包括我的问题，但实际上是关于另一个问题：[Pandas DataFrame serialization](https://stackoverflow.com/questions/9189425/pandas-dataframe-serialization)

熊猫数据帧是否有像 numpy.savez 这样的序列化例程？我知道我可以使用 hdf5，但我希望避免这种情况，因为 hdf5 是一个额外的安装，而且我无法在我需要的所有平台上启动并运行 h5py。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:35:37.197

Arg，DataMatrix 与 DataFrame 相同。有一个“加载”和一个“保存”功能似乎可以工作......我想搜索文档的最佳方法是使用 ipython 的交互式提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T14:18:01.203

您能否让 PyTables（[安装](http://pytables.github.com/usersguide/installation.html)）在与您相关的所有平台上运行？

在这种情况下，您可以直接使用 Pandas 中的[HDFStore 类](http://pandas.pydata.org/pandas-docs/dev/io.html#hdf5-pytables)将面板和数据帧（可能带有压缩）序列化为 HDF5。

# mysql - SQL 表自定义 AVG

> ID：12772499
> 
> 赞同：-1
> 
> 时间：2012-10-07T20:15:35.957
> 
> 标签：mysql, sql, average

我必须创建一个特定的评论系统，我应该在查询中做很多 AVG，所以我想问是否可以在 SQL 中创建一个表，在其中自动更新这些平均值？

mysql 5.5.24-0ubuntu0.12.04.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:36:28.153

是的，有两种方法可以做到这一点：

*   您可以创建一个“视图”，它就像一个表，只是它的记录来自 SQL 查询（通常来自其他表）而不是直接存储。请参阅[http://dev.mysql.com/doc/refman/5.6/en/create-view.html](http://dev.mysql.com/doc/refman/5.6/en/create-view.html)。
*   您可以创建一个“触发器”，它是在以指定方式修改指定表时运行的程序代码。在您的情况下，您将创建一个触发器，该触发器在修改一个表时运行，并重新生成辅助表。请参阅[http://dev.mysql.com/doc/refman/5.6/en/create-trigger.html](http://dev.mysql.com/doc/refman/5.6/en/create-trigger.html)。

# iphone - 将视图扩展到超级视图的底部

> ID：12772504
> 
> 赞同：0
> 
> 时间：2012-10-07T20:16:00.283
> 
> 标签：iphone, objective-c, ios, xcode

我想为 ViewController 中的视图设置动画，有点像 iPhone 上的通知中心。

如何使用 x,y 和/或高度值扩展子视图来做到这一点？因为我希望它同时兼容 3.5 英寸和 4 英寸的屏幕，所以最好不要使用特定的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:25:57.077

我刚刚在自己的项目中对此进行了测试，并确认它适用于不同的屏幕尺寸。

```
UIView *slidingview = [[UIView alloc] initWithFrame:CGRectOffset(self.view.frame, 0, -self.view.frame.size.height)];
slidingview.backgroundColor = [UIColor whiteColor];
[self.view addSubview:slidingview];
[UIView animateWithDuration:1 animations:^{
    slidingview.center = CGPointMake(self.view.frame.size.width/2, self.view.frame.size.height/2);
}]; 
```

要实现这一点，只需替换`slidingview`为要向下滑动的视图。但是，您必须使用我提供的框架声明您自己的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:40:26.757

这样的事情怎么样？

```
CGRect currentFrame = self.view.bounds;
UIView * slidingView = [UIView alloc] initWithFrame:(CGRect){currentFrame.origin, currentFrame.size.width, 0};
[self.view addSubview:slidingView];
[UIView animateWithDuration:0.5f animations:^{
    slidingView.frame = currentFrame;
}]; 
```

您可能需要使用`delay`版本`animateWithDuration...`才能使动画生效。

# javascript - 有没有办法测量页面的加载内容并显示它的百分比？

> ID：12772508
> 
> 赞同：2
> 
> 时间：2012-10-07T20:16:49.223
> 
> 标签：javascript

我的意思是页面预加载器，您可以在其中看到加载页面的百分比。它只是伪造的还是真的是与整个页面大小相关的刚刚加载页面的大小？是否可以用javascript测量它？开发商是怎么做到的？这里的例子似乎有点[http://www.ultranoir.com/en/#!/home/](http://www.ultranoir.com/en/#!/home/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T20:25:58.117

看看[jPreLoader jQuery 插件](http://www.inwebson.com/demo/jpreloader-v2/)

使用它非常简单：

```
$(document).ready(function() {
  $('body').jpreLoader();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:32:27.173

大多数网站都在伪造它。我前段时间也在搜索，只找到了像这个插件这样的解决方案：在这里查看实际操作[http://www.inwebson.com/demo/jpreloader/](http://www.inwebson.com/demo/jpreloader/)

```
<script type="text/javascript" src="js/jpreLoader.js"></script>
<script type="text/javascript">// <![CDATA[
  $(document).ready(function() {
  $('body').jpreLoader();
    });
// ]]></script> 
```

也看看这个解决方案，它可能是最接近真实的东西： [http ://www.seabreezecomputers.com/tips/progress.htm](http://www.seabreezecomputers.com/tips/progress.htm)

# emacs - Elisp 中的高阶函数

> ID：12772510
> 
> 赞同：10
> 
> 时间：2012-10-07T20:16:56.257
> 
> 标签：emacs, elisp, higher-order-functions, dynamic-binding

我创建了一个在 Elisp 中返回函数的函数：

```
(defun singleton-set (elem)
  (defun f (n) (= n elem))
  f) 
```

我尝试在 IELM 中运行它，但它失败了：

```
ELISP> (singleton-set 5)
*** Eval error ***  Symbol's value as variable is void: f
ELISP> ((singleton-set 5) 5)
*** Eval error ***  Invalid function: (singleton-set 5) 
```

由于[Lisp-1 和 Lisp-2 之间有什么区别？](https://stackoverflow.com/q/4578574/596361)我将代码更改为

```
(defun singleton-set (elem)
  (defun f (n) (= n elem))
  #'f) 
```

并调用`(funcall (singleton-set 5) 5)`，但现在错误是

`*** Eval error *** Symbol's value as variable is void: elem`

我从[elisp: capture variable from inner function](https://stackoverflow.com/q/5020009/596361)了解到这是由于 Emacs Lisp 的动态绑定。

如何在 Emacs Lisp 中使函数返回函数成为可能？这种机制与 Python、Scala 或 Clojure 等其他语言不同的原因是什么？

相关问题：

*   [elisp 函数作为参数和返回值](https://stackoverflow.com/q/661490/596361)
*   [Elisp 交互函数名称](https://stackoverflow.com/q/5372055/596361)
*   [如何在 Emacs Lisp 中创建临时函数](https://stackoverflow.com/q/2657326/596361)
*   [在 elisp 中，如何将函数放入变量中？](https://stackoverflow.com/q/9942675/596361)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-07T20:55:46.557

从`NEWS`Emacs 24 开始：

> Emacs 24.1 中的 Lisp 变化
> 
> *   代码现在可以默认使用词法范围而不是动态范围。该`lexical-binding`变量启用局部变量的词法范围。它通常通过文件第一行中的文件局部变量设置，在这种情况下，它适用于该文件中的所有代码。

因此，在 Emacs 24 中：

```
(setq lexical-binding t)
(defun singleton-set (elem) (lambda (n) (= n elem)))
(mapcar (singleton-set 1) '(0 1 2 3))
    ===> (nil t nil nil) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-07T20:32:44.600

> 如何在 Emacs Lisp 中使函数返回函数成为可能？

使用[假闭包](http://www.emacswiki.org/emacs/FakeClosures)，和`lexical-let`.

> 这种机制与 Python、Scala 或 Clojure 等其他语言不同的原因是什么？

Richard Stallman在不久前写的一篇论文中[回答了这个问题。](http://www.gnu.org/software/emacs/emacs-paper.html#SEC17)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-07T20:30:16.340

```
(defun singleton-set (elem)
  `(lambda (n) (= n ,elem)) 
```

参见：[elisp 函数作为参数和返回值](https://stackoverflow.com/q/661490/596361)

# sql - 查询选择一条记录并插入它的3条副本记录，每3条记录在序号列中递增Max +1

> ID：12772511
> 
> 赞同：1
> 
> 时间：2012-10-07T20:17:01.790
> 
> 标签：sql, db2

需要在 3 个新行中复制 1 行，并且在每个新行中增加序列号 +1

```
insert into t1 (column1,column2,column3,sequencecolumn)
(  **row1
select *from t1 (column1,'101',column3,sequencecolumn)
(select max (sequencecolumn)+1 where column1 ='abc')
where column1 = 'abc'
)  
(   ***row2
select *from t1 (column1,'102',column3,sequencecolumn)
(select max (sequencecolumn)+1 where column1 ='abc')
where column1 = 'abc'
)
(  ***row3
select *from t1 (column1,'103',column3,sequencecolumn)
(select max (sequencecolumn)+1 where column1 ='abc')
where column1 = 'abc'
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:58:48.157

我可能会尝试这样的事情（如果我有一个方便的 DB2 安装）：

```
INSERT INTO t1 (
  column1,
  column2,
  column3,
  sequencecolumn
)
SELECT
  t.column1,
  v.column2,
  t.column3,
  MAX(t.sequencecolumn) + v.rn
FROM t1 t
CROSS JOIN (VALUES (1, '101'), (2, '102'), (3, '103')) v (rn, column2)
GROUP BY
  t.column1,
  t.column3,
  v.column2,
  v.rn
WHERE t.column1 = 'abc'
; 
```

# php - PHP - 从多个文件中添加数字

> ID：12772513
> 
> 赞同：0
> 
> 时间：2012-10-07T20:17:12.180
> 
> 标签：php, addition

我一直遇到 PHP 问题 - 我对它*很*陌生。主要是使用其他来源的代码片段来做我想做的事。

无论如何，情况就是这样。假设我在单独的目录中有 4 个单独的文本文件。每个文本文件只包含一个数字。我可以在 PHP 中做些什么来将所有这些数字加（+）在一起，并将输出写入另一个 .txt 文件？

原始 4 个文本文档中的数字会定期更新（每 2-8 秒），因此如果需要指定添加脚本经常更新，那就太好了。

谢谢， - 科瓦契奇

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:35:38.180

```
$sum = 0;
foreach (array('/path1/1.txt', '/path2/2.txt', '/path3/3.txt', '/path4/4.txt') as $f)
    $sum += intval(trim(file_get_contents($f)));

echo $sum, PHP_EOL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:27:52.923

你可以做一个

```
$filename = 'abs/path/to/first/file';
$fh = fopen($filename,'r');
$firstNumber = fread($fh,filesize($filename));
fclose($fh); 
```

并重复所有 4 个文件

```
$sum = $firstNumber+$second+$third+$fourth;
$filename = 'abs/path/tofile';
$fh = fopen('abs/path/tofile','w');
fwrite($fh,$sum);
fclose($fh); 
```

最后将所有代码放入无限循环中

```
while(true){
    // do some code to calculate some or function call
    sleep(5);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T21:12:47.497

要将四个文件中的数字相加并将它们写入一个新文件，您可以使用

```
file_put_contents(
    '/path/to/sum.txt',
    array_sum(
        array_merge(
            file('/path/to/a/file.txt'),
            file('/path/to/b/file.txt'),
            file('/path/to/c/file.txt'),
            file('/path/to/d/file.txt')
        )
    )
); 
```

不确定您所说的*“如果需要指定添加脚本经常更新，那就太好了”。*

# eclipse - 我在哪里可以找到对给出错误的链接的引用？

> ID：12772516
> 
> 赞同：1
> 
> 时间：2012-10-07T20:17:19.610
> 
> 标签：eclipse, gwt, libgdx

使用 libgdx 并试图获得基本设置的 HTML 版本让我发疯。我收到这个错误

加载模块 com.me.mygdxgame.GwtDefinition [错误] 无法在您的类路径上找到“com/me/mygdxgame/GwtDefinition.gwt.xml”；可能是拼写错误，或者您忘记包含源的类路径条目？[错误] shell 在 doStartup 方法中失败

除非我真正将我的应用命名为 com.me.mygdxgame，否则会发生这种情况

我在任何 .xml 文件中的任何位置都找不到任何提及此链接（com.me.mygdxgame）的内容，也不知道 eclipse 从哪里得到它。它在加载 index.html 文件时出现该错误，但即使在其中链接也是正确的。任何帮助，将不胜感激。我刚刚在工作区的所有文件中搜索了任何提及 mygdxgame 并返回 0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:44:21.513

好的，发现它是什么。战争目录不知何故与同名游戏交叉链接，所以无论我重做了多少次，它都会链接到我以前拥有的旧文件夹。因此，即使属性中的所有目录看起来都正确，war 文件夹也是错误的。要修复它，我必须从属性的 |Google|Web 应用程序选项卡中取消选中“此项目有一个 war 文件夹”应用它，然后我尝试将它作为 web 应用程序运行它告诉我我没有 war 目录所以它不会运行。那部分可能不是必需的，但是当我重新选中该框并重新选择唯一的战争文件夹时，它会让我。下次我运行时，我必须从完整目录中重新选择 war 文件夹，而不仅仅是我的项目目录。这解决了问题。

只是为了澄清 Eclipse 似乎通过包含项目的文件夹的名称来保存战争文件夹信息在我的情况下发生的事情是我创建了一个名为 MyGame 的文件夹，我在其中存储了一个名为 com.me.mygdxgame 的默认项目使用 libgdx。后来我重命名了那个文件夹 MyGame_old 并从一个新的 MyGame 文件夹重新开始，我在其中命名了项目其他任何东西都没有关系关键是当我第一次运行它时它从来没有问我战争文件夹，它只是假设不知何故，我正在使用现在在 MyGame_old 中的旧版本，不知道它是如何找到它的，但它确实找到了。所以它正在读取带有错误链接的旧文件。

希望这可以帮助其他人解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T03:29:13.267

我也遇到了这个错误，但是您建议的修复方法对我不起作用。经过一番调查，这是我让它运行的方法：打开项目的“运行配置”，然后单击“参数”选项卡。删除参数中对 com.me.mygdxgame.GwtDefintion 的任何引用。

在此之后，项目运行无错误。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T00:35:06.887

在阅读了一些帖子后，很明显这个问题是由 GWT 引起的。这个问题的一个主要原因是您不断地重用同一个端口，而 GWT 正在重用旧的属性。对此有非常简单的解决方法。

右键单击-html 项目。运行-> 运行配置。转到服务器选项卡。检查自动选择一个未使用的端口。

按申请和

# r - 附加到 R 中的列表会导致复制吗？

> ID：12772522
> 
> 赞同：24
> 
> 时间：2012-10-07T20:17:56.397
> 
> 标签：r, list, append

假设我在 R 中创建了一个列表并将其追加如下：

```
x = list(10)
x[[2]] = 20 
```

这是否等同于

```
x = list(10)
x = list(10, 20) 
```

? 我对 R 如何处理内存中的列表的具体细节不是很有经验，但我有限的理解是它往往是复制快乐的；对我来说理想的是第一个选项本质上不涉及在内存中创建另一个列表，而只是导致在内存中为附加值留出一个新位置。本质上，如果我有一个很大的列表，我不想让 R 制作另一个副本，如果我只想在它上面附加一些东西。

如果我想要的行为不是这里给出的，有没有其他方法可以获得预期的效果？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-07T20:35:12.937

我相当有信心答案是“不”。我使用以下代码仔细检查：

```
Rprof(tmp <- tempfile(), memory.profiling = TRUE)

x <- list()
for (i in 1:100) x[[i]] <- runif(10000)

Rprof()
summaryRprof(tmp, memory = "stats")
unlink(tmp) 
```

输出：

```
# index: runif
#      vsize.small  max.vsize.small      vsize.large  max.vsize.large 
#            76411           381781           424523          1504387 
#            nodes        max.nodes     duplications tot.duplications 
#          2725878         13583136                0                0 
#          samples 
#                5 
```

相关部分是`duplications = 0`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-07T22:25:10.653

Matthew Dowle[在这里](https://stackoverflow.com/questions/7033106/why-has-data-table-defined-rather-than-overloading)的回答以及提高内存效率背后的基本原理是阻止大量在幕后通过`<-`、`[<-`和`[[<-`其他基本`R`操作（`names`等）进行复制

`[[<-`将复制整个`x`. 请参阅下面的示例

```
x <- list(20)
 tracemem(x)
#[1] "<0x2b0e2790>"
 x[[2]] <- 20
# tracemem[0x2b0e2790 -> 0x2adb7798]: 
```

你的第二个案例

```
x <- list(10,20) 
```

并没有真正附加原始内容`x`，而是替换`x`为恰好是`x`带有附加值的原始对象的对象。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-08T14:35:18.180

为了帮助我弄清楚修改列表是否会产生深拷贝或浅拷贝，我设置了一个小实验。如果修改列表会产生深层复制，那么当您修改包含大对象的列表时，与包含小对象的列表相比，它应该会更慢：

```
z1 <- list(runif(1e7))
z2 <- list(1:10)

system.time({
  for(i in 1:1e4) z1[1 + i] <- 1L
})
#  user  system elapsed
# 0.283   0.034   0.317
system.time({
  for(i in 1:1e4) z2[1 + i] <- 1L
})
#  user  system elapsed
# 0.284   0.034   0.319 
```

我的计算机上的时间基本相同，这表明复制列表会产生浅拷贝，复制指向现有数据结构的指针。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-07T20:51:14.230

接受了弗洛德尔的回答，但蔡斯的建议很好，所以我确认我使用他的建议使用`tracemem()`. 这是第一个示例，我们只是附加到列表中：

```
x = list(10)
tracemem(x[[1]])
# [1] "<0x2d03fa8>" #(likely different on each machine)
x[[2]] = 20
tracemem(x[[1]])
# [1] "<0x2d03fa8>" 
```

这是第二个示例的结果，我们在其中创建了两个列表：

```
x = list(10)
tracemem(x[[1]])
# [1] "<0x2d03c78>"
x = list(10, 20)
tracemem(x[[1]])
# [1] "<0x2d07ff8>" 
```

所以第一种方法似乎给出了所需的行为。

# ajax - 在 Grails 2 中使用 ajax 原型时缺少插件？

> ID：12772523
> 
> 赞同：1
> 
> 时间：2012-10-07T20:18:11.997
> 
> 标签：ajax, prototype, grails-plugin, grails-2.0, grails-controller

你好..我正在使用 Grails 2 并尝试实现从 gsp 页面到我的控制器的 ajax 调用..首先 grails 2 中缺少库原型我使用命令 grails install-plugin prototype 解决了这个问题..现在这个错误不是来但不工作，不同的错误来了..

在这里，我附上了代码..如果我更改第一个，我正在尝试简单的更新第二个选择框

我还在 Config.groovy 中添加了 grails.views.javascript.library = "prototype" 这一行

```
<code>
     //Controller<br>
        def ajaxgetStrudents() {

            def college=College.get(params.id)
            render college?.students as JSON

        }
        //GSP<br>
        javascript library="prototype" plugin="prototype"<br>
        <g:select id="name" name="name" from="${collegeNames.name }"  
        onChange="${ remoteFunction(controller:'College', action:'ajaxgetStrudents', 

        , onComplete: 'updateStudent(e)',params   :'\'id=\'+this.value '        

            )}
`</code> 
```

我编写了 javascript 代码来填充学生选择框..此代码不起作用..控制台错误如下

`` Error 2012-10-08 01:16:57,933 [http-bio-8083-exec-6] ERROR [/SampleGrails].[default] - Servlet.service() for servlet [default] in context with path [/SampleGrails] threw exception Message: It looks like you are missing some calls to the r:layoutResources tag. After rendering your page the following have not been rendered: [defer] Line | Method ->> 1110 | runWorker in java.util.concurrent.ThreadPoolExecutor`

 `* * *` 

`| 603 | run in java.util.concurrent.ThreadPoolExecutor$Worker ^ 722 | run . . . in java.lang.Thread ``

首先我想运行这段代码..??

接下来，即使我安装了未添加到我的项目插件文件夹中的原型插件..但它显示在 grails list-plugin -installed 命令中..为什么它是..？？

谢谢..，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T05:29:47.767

我认为您只是错过了 remoteFunction 调用中的“***更新***”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:20:24.667

在 grails 2.x 中安装插件的正确方法是在 BuildConfig.groovy 中放置一个条目，而不是“安装插件”命令。

为了排除故障，您可以在 Firefox 中尝试“Firebug”并查看原型脚本是否正在加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T04:41:25.810

## 标题 ## - 列表项

我对原型有同样的问题，无法在我的 grails 应用程序中包含prototype.js。基本上我同时使用 jquery 和原型，并使用以下代码片段包含库。

`

问题是 gsp 无法加载原型插件，因为我的原型 ajax 无法正常工作并出现以下异常。

呈现您的页面后，尚未呈现以下内容： [defer] Line | 方法->> 1110 | java.util.concurrent.ThreadPoolExecutor 中的 runWorker

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T09:54:13.103

1.  从 Grails 2.1.0 开始，原型已被删除（不确定 2.0.3）

代替

```
<g:javascript library="prototype" plugin="prototype" /> 
```

和

```
<g:javascript library="prototype" plugin="prototype" />
<r:layoutResources/> 
```

希望有帮助。始终参考可用的文档。这是升级 grails 的链接，虽然[Grails 2.1.x有很多信息](http://grails.org/doc/latest/guide/upgradingFromPreviousVersionsOfGrails.html)

# vb.net - 根据 groupbox 中的 checkbox.checkstate 更改复选框文本和功能

> ID：12772526
> 
> 赞同：0
> 
> 时间：2012-10-07T20:18:39.117
> 
> 标签：vb.net

我正在尝试自学 VB .net，作为我的第一个项目，我正在尝试设计一种功能与 Gmail 中的复选框非常相似的表单。一组中的大量复选框和一个位于组外的复选框以选择/取消选择其中的复选框。

我已经足够让那个主复选框做它的事情了，但是我真的很想在用户检查组框中的任何内容时通知表单，然后自动更改其文本和功能。我想出的用于更改文本的代码有效，但我不知道该放在哪里：

```
For Each ctrl As CheckBox In GroupBox1.Controls
        If ctrl.CheckState = 1 Then
            CheckBox1.Text = "Deselect All"
        End If
    Next 
```

我可以将代码链接到按钮推送或复选框更改，但我希望它是自动的，因为让用户单击某些东西来运行检查会破坏目的。我尝试双击组框并将代码放在那里，但它什么也没做。还尝试双击表单背景，但它在那里也没有任何作用。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T22:37:27.360

您可能已经注意到，您可能需要在几个不同的地方执行此操作。要重用某个功能，请创建一个完成该工作的新方法。双击表单，并将其放在 End Class 之前：

```
''' <summary>Update each of the CheckBoxes that in the same GroupBox</summary>
''' <param name="sender">The CheckBox that was clicked.</param>
''' <param name="e"></param>
''' <remarks>It is assumed that only checkboxed that live in a GroupBox will use this method.</remarks>
Public Sub UpdateCheckBoxState(ByVal sender As System.Object, ByVal e As System.EventArgs)

    'Get the group box that the clicked checkbox lives in 
    Dim parentGroupBox As System.Windows.Forms.GroupBox = DirectCast(DirectCast(sender, System.Windows.Forms.CheckBox).Parent, System.Windows.Forms.GroupBox)

    For Each ctrl As System.Windows.Forms.Control In parentGroupBox.Controls
        'Only process the checkboxes (in case there's other stuff in the GroupBox as well)
        If TypeOf ctrl Is System.Windows.Forms.CheckBox Then

            'This control is a checkbox.  Let's remember that to make it easier.
            Dim chkBox As System.Windows.Forms.CheckBox = DirectCast(ctrl, System.Windows.Forms.CheckBox)

            If chkBox.CheckState = 1 Then
                chkBox.Text = "Deselect All"
            Else
                chkBox.Text = "Select All"
            End If

        End If  ' - is CheckBox
    Next ctrl

End Sub 
```

现在您有了一个可以做您想做的事情的方法，您需要将它连接到您要管理的每个 CheckBox。通过在 Form_Load 事件中添加以下代码来执行此操作：

```
 AddHandler CheckBox1.CheckedChanged, AddressOf UpdateCheckBoxState
    AddHandler CheckBox2.CheckedChanged, AddressOf UpdateCheckBoxState
    ... 
```

因此，现在相同的方法将处理所有已连接复选框的 ClickChanged 方法。

除了用户单击它时，您还可以通过调用可能在 Form_Load 或其他地方的方法`UpdateCheckBoxState(`*CheckBoxThatYouWantToProgramaticallyUpdate来更新复选框。*`, Nothing)`

# unit-testing - 如何在 Visual Studio 2012 中禁用测试资源管理器

> ID：12772528
> 
> 赞同：3
> 
> 时间：2012-10-07T20:18:42.263
> 
> 标签：unit-testing, visual-studio-2012, test-runner, test-explorer

我使用 ReSharper 在 Visual Studio 2012 中运行单元测试。

在运行单元测试时，我不时不小心调用了内置的测试资源管理器，而不是 ReSharper 测试运行器。

如何在 Visual Studio 2012 中禁用测试资源管理器，这样我就不会意外调用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-08-17T12:12:04.667

转到窗口 --> 重置窗口布局

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-08T01:20:27.550

不确定是否有一种机制可以解耦和/或停用内置测试运行器。最终，这取决于您如何“意外”调用内置的测试运行程序。作为起点，您应该考虑取消绑定键盘快捷键。

# image - AForge.NET 图像颜色处理

> ID：12772529
> 
> 赞同：0
> 
> 时间：2012-10-07T20:18:54.383
> 
> 标签：image, filter, bitmap, aforge

几天前，我带着一个目标发现了 AForge。我希望能够操纵图像的颜色。但是，在尝试了几种不同的方法后，我一直无法找到解决方案。我仔细查看了他们提供的文档，但这对我没有任何帮助。我一直在使用的文档的具体部分是： [http ://www.aforgenet.com/framework/docs/html/3aaa490f-8dbe-f179-f64b-eedd0b9d34ac.htm](http://www.aforgenet.com/framework/docs/html/3aaa490f-8dbe-f179-f64b-eedd0b9d34ac.htm)

他们给出的例子：

```
// create filter
YCbCrLinear filter = new YCbCrLinear( );
// configure the filter
filter.InCb = new Range( -0.276f, 0.163f );
filter.InCr = new Range( -0.202f, 0.500f );
// apply the filter
filter.ApplyInPlace( image ); 
```

我为按钮单击事件复制了它，但未指定它的“图像”部分。我将图片框中的图像转换为位图，然后在最后一行引用它，认为它会起作用。但这完全没有影响。我的代码如下：

```
private void ColManButton_Click(object sender, EventArgs e)
{
Bitmap newimage = new Bitmap(pictureBox1.Image);
YCbCrLinear filter = new YCbCrLinear();
filter.InCb = new Range(-0.276f, 0.163f);
filter.InCr = new Range(-0.202f, 0.500f);
filter.ApplyInPlace(newimage);
} 
```

我的问题本质上是，对于任何熟悉或愿意帮助这个框架的人，我如何在按钮的单击事件下使用 AForge 的 YCbCrLinear 类来获取我的图像并操纵它的颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-30T23:34:31.577

请记住在应用过滤后设置图片框图像。

```
private void ColManButton_Click(object sender, EventArgs e)
{
    Bitmap newimage = new Bitmap(pictureBox1.Image);
    YCbCrLinear filter = new YCbCrLinear();
    filter.InCb = new Range(-0.276f, 0.163f);
    filter.InCr = new Range(-0.202f, 0.500f);
    filter.ApplyInPlace(newimage);

    pictureBox1.Image = newimage;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-06T19:07:36.207

在 aforge 网站上，您可以下载示例过滤器应用程序的源代码，您尝试过吗？

# c++ - 如何使用#include 在 Mac 上使用 g++？

> ID：12772533
> 
> 赞同：4
> 
> 时间：2012-10-07T20:19:26.520
> 
> 标签：c++, include, g++

我正在尝试编译我从别人那里得到的 c++ 程序。它是在 windows 上开发的，g++ 给出了一些编译错误。其中之一是与

```
#include <random> 
```

这给出了以下错误：`CandidateSolution.cpp:2:18: error: random: No such file or directory`。我试图找到可以从中获取 error.h 文件的位置，但我找不到它。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-07T20:21:45.463

该标头对 C++11 来说是新的。尝试使用`-std=c++11`或`-std=c++0x`。此外，请确保您的编译器是最新的。

# algorithm - 具有给定开始和结束时间而不是成本的关键路径

> ID：12772536
> 
> 赞同：0
> 
> 时间：2012-10-07T20:19:48.673
> 
> 标签：algorithm, project-management

我无法计算活动网络的关键路径。我必须使用的数据与我在网络上的简单示例中看到的数据略有不同。那就是我有每个活动的开始和结束时间，我从中推断出长度。我一直在使用该算法来计算每个活动的最早和最晚开始和结束时间：

“要找到最早的开始时间，从没有前任的活动开始，说从零开始。然后反复找一个前任的开始时间都被填满的活动，并将开始时间设置为前任的最大完成时间。

要查找最新的开始时间，请向后运行前面的算法。从没有继任者的活动开始。将他们的完成时间设置为上一阶段的最大完成时间。反复寻找其继任者都被评估过的前任。将其完成时间设置为最早的后继者的开始时间。

现在评估 slack = 最新开始 - 最早开始是微不足道的。一些事件链的松弛时间为零；这是关键路径。”

来源：[https ://stackoverflow.com/questions/6368404/find-the-critical-path-and-slack-time](https://stackoverflow.com/questions/6368404/find-the-critical-path-and-slack-time)

我的代码有时会正确识别构成关键路径的关键活动，但由于我拥有的数据，它有时会失败。我发现它什么时候发生：当活动的给定时间（从中扣除成本）不尊重计算的早期和最近时间。现在我只考虑每个活动的成本，但显然这还不够，因为在下图中的情况下，计算的关键路径不准确： http: [//imageshack.us/ 以上算法的一个失败案例a/img688/2420/casemp.png](http://imageshack.us/a/img688/2420/casemp.png)

显然活动 B 是关键的（如果它的结束时间发生了变化，项目的结束也发生了变化）但是算法计算出 1 的 slack...

我不知道如何更改算法以使其适用于上述情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:07:58.327

我找到了一些简单的方法来从我拥有的数据中识别关键活动。对于每个活动，我模拟一秒延迟（在结束时间上增加一秒）并将该延迟传播给所有后续活动，并测试它是否影响最后一个活动的时间。如果是这样，那么这项任务至关重要。

这种方式效果很好，我现在有一个所有关键活动的列表，但在某些情况下，它可能需要几秒钟（450 个活动需要 23 秒，有很多依赖！）。所以还在努力寻找更好的方法。

# android - ColorMatrixColorFilter 不影响小于 255 的 alpha 值

> ID：12772537
> 
> 赞同：0
> 
> 时间：2012-10-07T20:19:51.760
> 
> 标签：android, colormatrix, colorfilter

我有一个采用位图和颜色的方法，并将位图上的所有像素转换为该颜色，同时保持原始的 alpha 值。此外，该方法被编写为随着传入的颜色变暗，Bitmap 变得更透明而不是更暗。如果传入的颜色是完全黑色的，那么位图应该完全透明而不是黑色。

```
public static Bitmap colorImage(Bitmap img, int red, int green, int blue) {
    int max = blue;
    if (red >= green && red >= blue)
        max = red;
    else if (green >= red && green >= blue)
        max = green;
    double scale = 255.0 / max;
    red = (int)(scale * red);
    green = (int)(scale * green);
    blue = (int)(scale * blue);
    Bitmap resultBitmap = img.copy(Bitmap.Config.ARGB_8888, true);
    float[] colorTransform = {
            0, 0, 0, 0, red, 
            0, 0, 0, 0, green,
            0, 0, 0, 0, blue, 
            0, 0, 0, (float) (1f / scale), 0};

    ColorMatrix colorMatrix = new ColorMatrix(colorTransform);
    ColorMatrixColorFilter colorFilter = new ColorMatrixColorFilter(colorMatrix);

    Paint paint = new Paint();
    paint.setColorFilter(colorFilter);   

    Canvas canvas = new Canvas(resultBitmap);
    canvas.drawBitmap(resultBitmap, 0, 0, paint);
    return resultBitmap; 
```

}

使位图透明存在问题。

如果我将颜色矩阵设置为如下所示，

```
float[] colorTransform = {
            0, 0, 0, 0, red, 
            0, 0, 0, 0, green,
            0, 0, 0, 0, blue, 
            0, 0, 0, 0, 0}; 
```

整个位图应该完全透明。但是，这只有在原始位图根本没有透明度时才能正常工作。如果位图的所有像素只有 255 的 alpha 值，则结果是完全透明的。但是，如果位图有任何 alpha 值小于 255 的像素，则最终图像将不是透明的，但将具有与原始图像相同的 alpha 值。

谁能告诉我为什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T22:55:22.377

默认情况下，位图具有黑色背景。将位图的背景设置为透明可解决此问题。

这可以通过在声明`resultBitmap.eraseColor(Color.argb(0, 0, 0, 0));`之后添加`resultBitmap`，更改`canvas.drawBitmap(resultBitmap, 0, 0, paint);`为`canvas.drawBitmap(img, 0, 0, paint);`.

# django - 跟踪 Django 中的下载次数

> ID：12772541
> 
> 赞同：1
> 
> 时间：2012-10-07T20:20:37.373
> 
> 标签：django

我有一个网站，允许人们下载文件，例如他们可以重复使用的 Powerpoint 模板。

我在模型中添加了一个列，用于存储这些文件的信息和位置，称为“下载”，在该列中，我想用它作为计数器来跟踪文件下载了多少次。

我该怎么办？它会是页面上的 GET 请求吗？基本上我只是提供一个指向文件的链接，下载会自动开始，所以不确定如何将链接被点击回模型的事实传达给模型。

非常感谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:31:24.793

您有几种方法可以做到这一点：

*   创建一个自定义视图，“代理”所有文件，同时跟踪下载
*   创建一个与上面几乎相同的中间件，过滤要记录的请求
*   ..但如果您想计算收集的静态文件的下载量，上述任何一项都不适用，这些文件将由您的 http 服务器直接提供，而不通过 django。在这种情况下，我会从网络服务器日志中检索下载计数；看看您的网络服务器是否允许将日志存储到数据库，否则我会创建一个 cron 运行脚本来解析日志文件并将计数存储到 db，可从您的 django 应用程序访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:24:04.040

如果您创建一个处理 GET 请求的视图，您可以将更新代码放在该视图中。如果您的 Django 应用程序本身不处理上传，您可以在更新数据库中的计数器后创建一个简单地重定向到下载链接的视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T22:16:08.480

就像 redShadow 说的你可以创建一个代理视图。此视图可以通过[mod_xsendfile](https://tn123.org/mod_xsendfile/)提供文件（如果您使用 apache 作为网络服务器）并为下载设置一个计数器。

# android - 将 android 示例导入 Eclipse 时出错。

> ID：12772543
> 
> 赞同：2
> 
> 时间：2012-10-07T20:21:12.087
> 
> 标签：android, sdk, themes, sample

我已将 Android SDK 中的 Support4Demos 项目（从目录 extras/android/support/samples/Support4Demos/）导入到 eclipse 中。

最初我收到了 800 多个错误。添加 android-support-v4.jar 库构建路径后仍然存在 100 多个错误。可能所有这些都有相同的原因 - 由于 XML 文件中的错误，没有生成 R 类。

`error: Error retrieving parent for item: No resource found that matches the given name 'android:Theme.Holo'.`

据我了解 - Holo 主题丢失..

项目按“原样”导入 - 未进行任何修改。所以我希望这应该有效。

*   Holo 主题在哪里？它不是 Android SDK 的一部分吗？
*   我应该将哪个文件复制到哪个目录？
*   或者我应该添加一些参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:29:05.670

问题很可能是 Holo 主题适用于 Android SDK 4.x 及更高版本，并且您在项目中使用了一些较旧的 SDK。您可能正在从最近的 API 导入示例，而您的项目正在使用旧的 API。

解决方案是（解决方案好坏的降序）：

*   导入针对您希望使用的 SDK 的示例。

或者

*   更改示例的主题。

或者

*   使用更新的 Android API（例如 +4.x）设置您的项目。

你也可以检查这个问题：[Trying to use holo theme in Android not working](https://stackoverflow.com/q/11130313/1085483)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:27:11.513

问题解决了……我的意思是。

将项目导入 eclipse 时，会创建 project.properties 文件。我的 Eclipse 创建了里面有**target=8**的文件。可能它是安装的最低版本。但我不确定。

Holo 主题不是 Android 支持库的一部分，因此项目编译时应将*项目构建目标*设置为包含 Holo 主题（3.0 或更高版本 - API 11 或更高版本）的平台版本。可以通过 eclipse 菜单**Project->Properties->Android**或直接在 project.properties 文件中完成。eclipse 自动更新对正确版本的 android.jar 平台库的引用。请注意，AndroidManifest.xml 中的 targetSdkVersion 无效（或？）。我在 AndroidManifest.xml 中有这条未更改的行：

`<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="13" />`

我已经安装了版本 8、10、13 和 16 的平台。由于 AndroidManifest.xml 中的另一个兼容性问题，无法使用 API 级别 13 编译项目。

所以我只能使用平台版本 4.1（API 级别 16）成功构建项目 - 换句话说，在 project.properties 文件中使用**target=16 。**

运行应用程序的小问题 - eclipse 仅显示 Android 4.1 AVD（其他被认为不兼容并被隐藏。我的三星 Galaxy Y Duos 也显示为不兼容，但应用程序可以在其上运行。

# ruby-on-rails - 将所有 .html 文件与 Rails 中的高压匹配

> ID：12772544
> 
> 赞同：0
> 
> 时间：2012-10-07T20:21:15.660
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, ruby-on-rails-3.2, static-html

如何在 Rails 中将所有`.html`文件与[High Voltage](https://github.com/thoughtbot/high_voltage)的控制器匹配，以便最后带有的任何 url在我的视图目录中`.html`打开相应的文件？`pages/<page>.html.erb`当然，我可以用高压的`page_path`命名路线来引用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T14:57:32.740

我认为这是不可能的，或者至少是微不足道的。URL 的“后缀”部分映射到请求的格式，例如 /pages/document.html、/pages/document.json、/pages/document.xml、/pages/document.csv 等。是 Rails 路由的基础，而 .html 是默认格式，因此 /pages/document 默认会返回 HTML。可能可以创建一条路线，例如：

```
match '*.html' => 'high_voltage/pages#show', as: :static 
```

我还没有测试过。

如果将匹配项放在底部，则即使传入的 url 上有 .html，它也可能会匹配之前的其他内容。相反，如果你把它放在顶部，它可能会匹配所有没有后缀的东西。应该很容易让你测试它。

我的高压路线：

```
get '/:id' => 'high_voltage/pages#show', as: :static 
```

在我的路线的底部，就在根 url 之前，所以它基本上是全部。只要我的静态 html 文件路径与我的 RESTful 路由不同，它就可以正常工作。

否则，如果这些静态 URL 可以接受重定向（永久），您可以将匹配项放在上游 HTTP 服务器中，如 nginx 或 apache，并将其重定向到已知的高压路径，如 /pages。

# opengl-es - GLSL：用 2D 纹理模拟 3D 纹理

> ID：12772545
> 
> 赞同：3
> 
> 时间：2012-10-07T20:21:34.817
> 
> 标签：opengl-es, glsl, textures, 3d-texture

我想出了一些代码，使用包含瓷砖的大 2D 纹理来模拟 3D 纹理查找。3D贴图为128x128x64，大2D贴图为1024x1024，分为64个128x128的贴图。

片段着色器中的查找代码如下所示：

```
#extension GL_EXT_gpu_shader4 : enable

varying float LightIntensity;
varying vec3 pos;

uniform sampler2D noisef;
vec4 flat_texture3D()
{
    vec3 p = pos;
    vec2 inimg = p.xy;

    int d = int(p.z*128.0);
    float ix = (d % 8); 
    float iy = (d / 8);
    vec2 oc = inimg + vec2(ix, iy);
    oc *= 0.125;

    return texture2D(noisef, oc);
}

void main (void)
{
    vec4 noisevec = flat_texture3D();
    gl_FragColor = noisevec;
} 
```

平铺逻辑似乎工作正常，这段代码只有一个问题。它看起来像这样：

![它看起来像什么](../Images/fb6d32a5cd88f5c245c6d9a94d66a5ac.png)

体素层之间有奇怪的 1 到 2 像素宽的条纹。`d`更改时，条纹仅出现在边界处。
我已经为此工作了 2 天，但仍然不知道这里发生了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:55:58.313

这看起来像一个纹理过滤器问题。想一想：当您靠近边界时，双线性过滤器将考虑相邻的纹素，在您的情况下：来自另一个“深度层”。

为避免这种情况，您可以钳制纹理坐标，使它们永远不会超出矩形定义的平铺最外侧纹素*中心*（类似于 GL_CLAMP_TO_EDGE，但基于每个平铺）。但是你应该知道，使用 mipmapping 时问题会变得更糟。您还应该知道，目前您无法像真正的 3D 纹理那样在 z 方向上进行过滤。当然，您可以在着色器中手动模拟。

但实际上：为什么不只使用 3D 纹理呢？硬件可以为您完成所有这些工作，而且开销要少得多......

# android - MediaMetadataRetriever.getFrameAtTime() 仅返回第一帧

> ID：12772547
> 
> 赞同：30
> 
> 时间：2012-10-07T20:22:01.403
> 
> 标签：android, video, bitmap, save

我使用 MetadataRetriever 从视频中提取帧，并将所有图像存储在`ArrayList<Bitmap>`. 我想将它们全部存储在 SD 卡上（仅用于测试目的）。

但是当我从模拟器中拉出一个文件夹并查看保存的图像时，所有图像都只是视频的第一帧。

这就是我从视频中提取帧的方式：

```
File videoFile=new File(Environment.getExternalStorageDirectory().getAbsolutePath()+"/videos","sample_mpeg4.mp4");

Uri videoFileUri=Uri.parse(videoFile.toString());

MediaMetadataRetriever retriever = new MediaMetadataRetriever();
retriever.setDataSource(videoFile.getAbsolutePath());
ArrayList<Bitmap> rev=new ArrayList<Bitmap>();

//Create a new Media Player
MediaPlayer mp = MediaPlayer.create(getBaseContext(), videoFileUri);

int millis = mp.getDuration();
for(int i=0;i<millis;i+=100){
   Bitmap bitmap=retriever.getFrameAtTime(i,OPTION_CLOSEST_SYNC);
   rev.add(bitmap);
} 
```

这就是我保存它们的方式（我正在调用此方法并传递位图 ArrayList）：

```
public void saveFrames(ArrayList<Bitmap> saveBitmapList) throws IOException{
    Random r = new Random();
    int folder_id = r.nextInt(1000) + 1;

    String folder = Environment.getExternalStorageDirectory()+"/videos/frames/"+folder_id+"/";
    File saveFolder=new File(folder);
    if(!saveFolder.exists()){
       saveFolder.mkdirs();
    }

    int i=1;
    for (Bitmap b : saveBitmapList){
       ByteArrayOutputStream bytes = new ByteArrayOutputStream();
        b.compress(Bitmap.CompressFormat.JPEG, 40, bytes);

        File f = new File(saveFolder,("frame"+i+".jpg"));

        f.createNewFile();

        FileOutputStream fo = new FileOutputStream(f);
        fo.write(bytes.toByteArray());

           fo.flush();
           fo.close();

        i++;
    }
    Toast.makeText(getApplicationContext(),"Folder id : "+folder_id, Toast.LENGTH_LONG).show();

} 
```

当我拉出一个文件夹查看所有帧时，所有图像都是视频的第一帧。有人可以向我解释发生了什么吗？

**更新：**

我试过用另一个视频。我发现我没有得到空白图像，但它总是只返回第一帧。

`MediaMetadataRetriever.getFrameAtTime(long timeUS)`只返回第一帧，但我想检索所有帧。我应该做出哪些改变？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-27T20:44:13.973

`MediaMetadataRetriever`的`getFrameAt`方法需要微秒（1/1000000 秒）而不是毫秒，所以在你的情况下它总是向下舍入到第一帧。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-06-19T13:18:55.470

只需将毫秒转换为微，因为 getFrameAt 以毫秒为单位获取数据

```
1 miliseconds have 1000 microseconds..

for(int i=1000000;i<millis*1000;i+=1000000){
   Bitmap bitmap=retriever.getFrameAtTime(i,OPTION_CLOSEST_SYNC);
   rev.add(bitmap);
} 
```

那么你的问题就解决了。。

我根据需要创建了它。

```
public class MainActivity extends Activity
{
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        File videoFile=new File(Environment.getExternalStorageDirectory().getAbsolutePath()+"/screenshots/","myvideo.mp4");

        Uri videoFileUri=Uri.parse(videoFile.toString());

        MediaMetadataRetriever retriever = new MediaMetadataRetriever();
        retriever.setDataSource(videoFile.getAbsolutePath());
        ArrayList<Bitmap> rev=new ArrayList<Bitmap>();

        //Create a new Media Player
        MediaPlayer mp = MediaPlayer.create(getBaseContext(), videoFileUri);

        int millis = mp.getDuration();

        for(int i=1000000;i<millis*1000;i+=1000000)
        {
           Bitmap bitmap=retriever.getFrameAtTime(i,MediaMetadataRetriever.OPTION_CLOSEST_SYNC);
           rev.add(bitmap);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-03-11T10:02:13.507

`getFrameAt`替代Android 方法的替代解决方案`MediaMetadataRetriever`。**AV_FrameCapture**使用 MediaCodec 解码视频帧，`OpenGL`并将视频帧转换为 RGB 位图。由于 Android`MediaMetadataRetriever`不保证调用时返回结果`getFrameAtTime`，因此`AV_FrameCapture`可以使用此方法**准确**提取一帧视频。

> **按照以下步骤实现 AV_FrameCapture**

**1\. 将以下类添加到您的项目中。**

类列表：`AV_GLHelper.java`, `AV_GLUtil.java`, `AV_TextureRender.java`, `AV_FrameCapture.java`, `AV_VideoDecoder.java`,`AV_BitmapUtil.java`

**2\. 如何使用**

我们以两种方式提供了视频的捕获快照。如果你想使用`MediaMetadataRetriever`然后使用捕获`USE_MEDIA_META_DATA_RETRIEVER = true`；否则它将使用`OpenGL`.

最后用, & ,调用`captureFrame`函数。它将自动捕获该帧的屏幕截图。`VIDEO_FILE_PATH``SNAPSHOT_DURATION_IN_MILLIS``SNAPSHOT_WIDTH``SNAPSHOT_HEIGHT`

```
 private AV_FrameCapture mFrameCapture = null;
    boolean USE_MEDIA_META_DATA_RETRIEVER = false;

    private void captureFrame(String VIDEO_FILE_PATH, long SNAPSHOT_DURATION_IN_MILLIS, int SNAPSHOT_WIDTH, int SNAPSHOT_HEIGHT) {

        // getFrameAtTimeByMMDR & getFrameAtTimeByFrameCapture function uses a micro sec 1millisecond = 1000 microseconds

        Bitmap bmp = USE_MEDIA_META_DATA_RETRIEVER ? getFrameAtTimeByMMDR(VIDEO_FILE_PATH, (SNAPSHOT_DURATION_IN_MILLIS * 1000))
                : getFrameAtTimeByFrameCapture(VIDEO_FILE_PATH, (SNAPSHOT_DURATION_IN_MILLIS * 1000), SNAPSHOT_WIDTH, SNAPSHOT_HEIGHT);

        String timeStamp = new SimpleDateFormat("ddMMyyyy_HHmmss", Locale.getDefault()).format(new Date());
        if (null != bmp) {
            AV_BitmapUtil.saveBitmap(bmp, String.format("/sdcard/read_%s.jpg", timeStamp));
        }

        if (mFrameCapture != null) {
            mFrameCapture.release();
        }
    }

    private Bitmap getFrameAtTimeByMMDR(String path, long time) {
        MediaMetadataRetriever mmr = new MediaMetadataRetriever();
        mmr.setDataSource(path);
        Bitmap bmp = mmr.getFrameAtTime(time, MediaMetadataRetriever.OPTION_CLOSEST);
        mmr.release();
        return bmp;
    }

    private Bitmap getFrameAtTimeByFrameCapture(String path, long time, int snapshot_width, int snapshot_height) {
        mFrameCapture = new AV_FrameCapture();
        mFrameCapture.setDataSource(path);
        mFrameCapture.setTargetSize(snapshot_width, snapshot_height);
        mFrameCapture.init();
        return mFrameCapture.getFrameAtTime(time);
    } 
```

> 类列表。

**1\. AV_GLHelper.java**

```
public class AV_GLHelper {

    private static final int EGL_RECORDABLE_ANDROID = 0x3142;
    private static final int EGL_OPENGL_ES2_BIT = 4;

    private SurfaceTexture mSurfaceTexture;
    private AV_TextureRender mTextureRender;

    private EGLDisplay mEglDisplay = EGL14.EGL_NO_DISPLAY;
    private EGLContext mEglContext = EGL14.EGL_NO_CONTEXT;
    private EGLSurface mEglSurface = EGL14.EGL_NO_SURFACE;

    public void init(SurfaceTexture st) {
        mSurfaceTexture = st;
        initGL();

        makeCurrent();
        mTextureRender = new AV_TextureRender();
    }

    private void initGL() {
        mEglDisplay = EGL14.eglGetDisplay(EGL14.EGL_DEFAULT_DISPLAY);
        if (mEglDisplay == EGL14.EGL_NO_DISPLAY) {
            throw new RuntimeException("eglGetdisplay failed : " +
                    GLUtils.getEGLErrorString(EGL14.eglGetError()));
        }

        int[] version = new int[2];
        if (!EGL14.eglInitialize(mEglDisplay, version, 0, version, 1)) {
            mEglDisplay = null;
            throw new RuntimeException("unable to initialize EGL14");
        }

        // Configure EGL for pbuffer and OpenGL ES 2.0\.  We want enough RGB bits
        // to be able to tell if the frame is reasonable.
        int[] attribList = {
                EGL14.EGL_RED_SIZE, 8,
                EGL14.EGL_GREEN_SIZE, 8,
                EGL14.EGL_BLUE_SIZE, 8,
                EGL14.EGL_RENDERABLE_TYPE, EGL_OPENGL_ES2_BIT,
                EGL_RECORDABLE_ANDROID, 1,
                EGL14.EGL_NONE
        };

        EGLConfig[] configs = new EGLConfig[1];
        int[] numConfigs = new int[1];
        if (!EGL14.eglChooseConfig(mEglDisplay, attribList, 0, configs, 0, configs.length,
                numConfigs, 0)) {
            throw new RuntimeException("unable to find RGB888+recordable ES2 EGL config");
        }

        // Configure context for OpenGL ES 2.0.
        int[] attrib_list = {
                EGL14.EGL_CONTEXT_CLIENT_VERSION, 2,
                EGL14.EGL_NONE
        };
        mEglContext = EGL14.eglCreateContext(mEglDisplay, configs[0], EGL14.EGL_NO_CONTEXT,
                attrib_list, 0);
        AV_GLUtil.checkEglError("eglCreateContext");
        if (mEglContext == null) {
            throw new RuntimeException("null context");
        }

        // Create a window surface, and attach it to the Surface we received.
        int[] surfaceAttribs = {
                EGL14.EGL_NONE
        };
        mEglSurface = EGL14.eglCreateWindowSurface(mEglDisplay, configs[0], new Surface(mSurfaceTexture),
                surfaceAttribs, 0);
        AV_GLUtil.checkEglError("eglCreateWindowSurface");
        if (mEglSurface == null) {
            throw new RuntimeException("surface was null");
        }
    }

    public void release() {
        if (null != mSurfaceTexture)
            mSurfaceTexture.release();
    }

    public void makeCurrent() {
        if (!EGL14.eglMakeCurrent(mEglDisplay, mEglSurface, mEglSurface, mEglContext)) {
            throw new RuntimeException("eglMakeCurrent failed");
        }
    }

    public int createOESTexture() {
        int[] textures = new int[1];
        GLES20.glGenTextures(1, textures, 0);

        int textureID = textures[0];
        GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, textureID);
        AV_GLUtil.checkEglError("glBindTexture textureID");

        GLES20.glTexParameterf(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_MIN_FILTER,
                GLES20.GL_NEAREST);
        GLES20.glTexParameterf(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_MAG_FILTER,
                GLES20.GL_LINEAR);
        GLES20.glTexParameteri(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_WRAP_S,
                GLES20.GL_CLAMP_TO_EDGE);
        GLES20.glTexParameteri(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_WRAP_T,
                GLES20.GL_CLAMP_TO_EDGE);
        AV_GLUtil.checkEglError("glTexParameter");

        return textureID;
    }

    public void drawFrame(SurfaceTexture st, int textureID) {
        st.updateTexImage();
        if (null != mTextureRender)
            mTextureRender.drawFrame(st, textureID);
    }

    public Bitmap readPixels(int width, int height) {
        ByteBuffer PixelBuffer = ByteBuffer.allocateDirect(4 * width * height);
        PixelBuffer.position(0);
        GLES20.glReadPixels(0, 0, width, height, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, PixelBuffer);

        Bitmap bmp = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
        PixelBuffer.position(0);
        bmp.copyPixelsFromBuffer(PixelBuffer);

        return bmp;
    }
} 
```

**2\. AV_GLUtil.java**

```
public class AV_GLUtil {
    /**
     * Checks for EGL errors.
     */
    public static void checkEglError(String msg) {
        boolean failed = false;
        int error;
        while ((error = EGL14.eglGetError()) != EGL14.EGL_SUCCESS) {
            Log.e("TAG", msg + ": EGL error: 0x" + Integer.toHexString(error));
            failed = true;
        }
        if (failed) {
            throw new RuntimeException("EGL error encountered (see log)");
        }
    }   
} 
```

**3\. AV_TextureRender.java**

```
class AV_TextureRender {
    private static final String TAG = "TextureRender";

    private static final int FLOAT_SIZE_BYTES = 4;
    private static final int TRIANGLE_VERTICES_DATA_STRIDE_BYTES = 5 * FLOAT_SIZE_BYTES;
    private static final int TRIANGLE_VERTICES_DATA_POS_OFFSET = 0;
    private static final int TRIANGLE_VERTICES_DATA_UV_OFFSET = 3;
    private final float[] mTriangleVerticesData = {
        // X, Y, Z, U, V
        -1.0f, -1.0f, 0, 0.f, 1.f,
         1.0f, -1.0f, 0, 1.f, 1.f,
        -1.0f,  1.0f, 0, 0.f, 0.f,
         1.0f,  1.0f, 0, 1.f, 0.f,
    };

    private FloatBuffer mTriangleVertices;

    private static final String VERTEX_SHADER =
            "uniform mat4 uMVPMatrix;\n" +
            "uniform mat4 uSTMatrix;\n" +
            "attribute vec4 aPosition;\n" +
            "attribute vec4 aTextureCoord;\n" +
            "varying vec2 vTextureCoord;\n" +
            "void main() {\n" +
            "  gl_Position = uMVPMatrix * aPosition;\n" +
            "  vTextureCoord = (uSTMatrix * aTextureCoord).xy;\n" +
            "}\n";

    private static final String FRAGMENT_SHADER =
            "#extension GL_OES_EGL_image_external : require\n" +
            "precision mediump float;\n" +      // highp here doesn't seem to matter
            "varying vec2 vTextureCoord;\n" +
            "uniform samplerExternalOES sTexture;\n" +
            "void main() {\n" +
            "  vec2 texcoord = vTextureCoord;\n" +
            "  vec3 normalColor = texture2D(sTexture, texcoord).rgb;\n" +
            "  normalColor = vec3(normalColor.r, normalColor.g, normalColor.b);\n" + 
            "  gl_FragColor = vec4(normalColor.r, normalColor.g, normalColor.b, 1); \n"+ 
            "}\n";

    private float[] mMVPMatrix = new float[16];
    private float[] mSTMatrix = new float[16];

    private int mProgram;
    private int muMVPMatrixHandle;
    private int muSTMatrixHandle;
    private int maPositionHandle;
    private int maTextureHandle;

    public AV_TextureRender() {
        mTriangleVertices = ByteBuffer.allocateDirect(
            mTriangleVerticesData.length * FLOAT_SIZE_BYTES)
                .order(ByteOrder.nativeOrder()).asFloatBuffer();
        mTriangleVertices.put(mTriangleVerticesData).position(0);

        Matrix.setIdentityM(mSTMatrix, 0);
        init();
    }

    public void drawFrame(SurfaceTexture st, int textureID) {
        AV_GLUtil.checkEglError("onDrawFrame start");
        st.getTransformMatrix(mSTMatrix);

        GLES20.glClearColor(0.0f, 1.0f, 0.0f, 1.0f);
        GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);

        if (GLES20.glIsProgram( mProgram ) != true){
            reCreateProgram();
        }

        GLES20.glUseProgram(mProgram);
        AV_GLUtil.checkEglError("glUseProgram");

        GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
        GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, textureID);

        mTriangleVertices.position(TRIANGLE_VERTICES_DATA_POS_OFFSET);
        GLES20.glVertexAttribPointer(maPositionHandle, 3, GLES20.GL_FLOAT, false,
            TRIANGLE_VERTICES_DATA_STRIDE_BYTES, mTriangleVertices);
        AV_GLUtil.checkEglError("glVertexAttribPointer maPosition");
        GLES20.glEnableVertexAttribArray(maPositionHandle);
        AV_GLUtil.checkEglError("glEnableVertexAttribArray maPositionHandle");

        mTriangleVertices.position(TRIANGLE_VERTICES_DATA_UV_OFFSET);
        GLES20.glVertexAttribPointer(maTextureHandle, 3, GLES20.GL_FLOAT, false,
            TRIANGLE_VERTICES_DATA_STRIDE_BYTES, mTriangleVertices);
        AV_GLUtil.checkEglError("glVertexAttribPointer maTextureHandle");
        GLES20.glEnableVertexAttribArray(maTextureHandle);
        AV_GLUtil.checkEglError("glEnableVertexAttribArray maTextureHandle");

        Matrix.setIdentityM(mMVPMatrix, 0);
        GLES20.glUniformMatrix4fv(muMVPMatrixHandle, 1, false, mMVPMatrix, 0);
        GLES20.glUniformMatrix4fv(muSTMatrixHandle, 1, false, mSTMatrix, 0);

        GLES20.glDrawArrays(GLES20.GL_TRIANGLE_STRIP, 0, 4);
        AV_GLUtil.checkEglError("glDrawArrays");
        GLES20.glFinish();
    }

    /**
     * Initializes GL state.  Call this after the EGL surface has been created and made current.
     */
    public void init() {
        mProgram = createProgram(VERTEX_SHADER, FRAGMENT_SHADER);
        if (mProgram == 0) {
            throw new RuntimeException("failed creating program");
        }
        maPositionHandle = GLES20.glGetAttribLocation(mProgram, "aPosition");
        AV_GLUtil.checkEglError("glGetAttribLocation aPosition");
        if (maPositionHandle == -1) {
            throw new RuntimeException("Could not get attrib location for aPosition");
        }
        maTextureHandle = GLES20.glGetAttribLocation(mProgram, "aTextureCoord");
        AV_GLUtil.checkEglError("glGetAttribLocation aTextureCoord");
        if (maTextureHandle == -1) {
            throw new RuntimeException("Could not get attrib location for aTextureCoord");
        }

        muMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
        AV_GLUtil.checkEglError("glGetUniformLocation uMVPMatrix");
        if (muMVPMatrixHandle == -1) {
            throw new RuntimeException("Could not get attrib location for uMVPMatrix");
        }

        muSTMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uSTMatrix");
        AV_GLUtil.checkEglError("glGetUniformLocation uSTMatrix");
        if (muSTMatrixHandle == -1) {
            throw new RuntimeException("Could not get attrib location for uSTMatrix");
        }
    }

    private void reCreateProgram() {
        mProgram = createProgram(VERTEX_SHADER, FRAGMENT_SHADER);
        if (mProgram == 0) {
            throw new RuntimeException("failed creating program");
        }
        maPositionHandle = GLES20.glGetAttribLocation(mProgram, "aPosition");
        AV_GLUtil.checkEglError("glGetAttribLocation aPosition");
        if (maPositionHandle == -1) {
            throw new RuntimeException("Could not get attrib location for aPosition");
        }
        maTextureHandle = GLES20.glGetAttribLocation(mProgram, "aTextureCoord");
        AV_GLUtil.checkEglError("glGetAttribLocation aTextureCoord");
        if (maTextureHandle == -1) {
            throw new RuntimeException("Could not get attrib location for aTextureCoord");
        }

        muMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
        AV_GLUtil.checkEglError("glGetUniformLocation uMVPMatrix");
        if (muMVPMatrixHandle == -1) {
            throw new RuntimeException("Could not get attrib location for uMVPMatrix");
        }

        muSTMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uSTMatrix");
        AV_GLUtil.checkEglError("glGetUniformLocation uSTMatrix");
        if (muSTMatrixHandle == -1) {
            throw new RuntimeException("Could not get attrib location for uSTMatrix");
        }
    }

    private int loadShader(int shaderType, String source) {
        int shader = GLES20.glCreateShader(shaderType);
        AV_GLUtil.checkEglError("glCreateShader type=" + shaderType);
        GLES20.glShaderSource(shader, source);
        GLES20.glCompileShader(shader);
        int[] compiled = new int[1];
        GLES20.glGetShaderiv(shader, GLES20.GL_COMPILE_STATUS, compiled, 0);
        if (compiled[0] == 0) {
            Log.e(TAG, "Could not compile shader " + shaderType + ":");
            Log.e(TAG, " " + GLES20.glGetShaderInfoLog(shader));
            GLES20.glDeleteShader(shader);
            shader = 0;
        }
        return shader;
    }

    private int createProgram(String vertexSource, String fragmentSource) {
        int vertexShader = loadShader(GLES20.GL_VERTEX_SHADER, vertexSource);
        if (vertexShader == 0) {
            return 0;
        }
        int pixelShader = loadShader(GLES20.GL_FRAGMENT_SHADER, fragmentSource);
        if (pixelShader == 0) {
            return 0;
        }

        int program = GLES20.glCreateProgram();
        AV_GLUtil.checkEglError("glCreateProgram");
        if (program == 0) {
            Log.e(TAG, "Could not create program");
        }
        GLES20.glAttachShader(program, vertexShader);
        AV_GLUtil.checkEglError("glAttachShader");
        GLES20.glAttachShader(program, pixelShader);
        AV_GLUtil.checkEglError("glAttachShader");
        GLES20.glLinkProgram(program);
        int[] linkStatus = new int[1];
        GLES20.glGetProgramiv(program, GLES20.GL_LINK_STATUS, linkStatus, 0);
        if (linkStatus[0] != GLES20.GL_TRUE) {
            Log.e(TAG, "Could not link program: ");
            Log.e(TAG, GLES20.glGetProgramInfoLog(program));
            GLES20.glDeleteProgram(program);
            program = 0;
        }
        return program;
    }
} 
```

**4\. AV_FrameCapture.java**

```
public class AV_FrameCapture {
    final static String TAG = "AV_FrameCapture";

    private HandlerThread mGLThread = null;
    private Handler mGLHandler = null;
    private AV_GLHelper mGLHelper = null;

    private int mDefaultTextureID = 10001;

    private int mWidth = 1920;
    private int mHeight = 1080;

    private String mPath = null;

    public AV_FrameCapture() {
        mGLHelper = new AV_GLHelper();
        mGLThread = new HandlerThread("AV_FrameCapture");

        mGLThread.start();
        mGLHandler = new Handler(mGLThread.getLooper());
    }

    public void setDataSource(String path) {
        mPath = path;
    }

    public void setTargetSize(int width, int height) {
        mWidth = width;
        mHeight = height;
    }

    public void init() {
        mGLHandler.post(new Runnable() {
            @Override
            public void run() {
                SurfaceTexture st = new SurfaceTexture(mDefaultTextureID);
                st.setDefaultBufferSize(mWidth, mHeight);
                mGLHelper.init(st);
            }
        });
    }

    public void release() {
        mGLHandler.post(new Runnable() {
            @Override
            public void run() {
                mGLHelper.release();
                mGLThread.quit();
            }
        });
    }

    private Object mWaitBitmap = new Object();
    private Bitmap mBitmap = null;

    public Bitmap getFrameAtTime(final long frameTime) {
        if (null == mPath || mPath.isEmpty()) {
            throw new RuntimeException("Illegal State");
        }

        mGLHandler.post(new Runnable() {
            @Override
            public void run() {
                getFrameAtTimeImpl(frameTime);
            }
        });

        synchronized (mWaitBitmap) {
            try {
                mWaitBitmap.wait();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        return mBitmap;
    }

    @SuppressLint("SdCardPath")
    public void getFrameAtTimeImpl(long frameTime) {
        final int textureID = mGLHelper.createOESTexture();
        final SurfaceTexture st = new SurfaceTexture(textureID);
        final Surface surface = new Surface(st);
        final AV_VideoDecoder vd = new AV_VideoDecoder(mPath, surface);
        st.setOnFrameAvailableListener(new OnFrameAvailableListener() {
            @Override
            public void onFrameAvailable(SurfaceTexture surfaceTexture) {
                Log.i(TAG, "onFrameAvailable");
                mGLHelper.drawFrame(st, textureID);
                mBitmap = mGLHelper.readPixels(mWidth, mHeight);
                synchronized (mWaitBitmap) {
                    mWaitBitmap.notify();
                }

                vd.release();
                st.release();
                surface.release();
            }
        });

        if (!vd.prepare(frameTime)) {
            mBitmap = null;
            synchronized (mWaitBitmap) {
                mWaitBitmap.notify();
            }
        }
    }
} 
```

**5\. AV_VideoDecoder.java**

```
public class AV_VideoDecoder {
    final static String TAG = "VideoDecoder";
    final static String VIDEO_MIME_PREFIX = "video/";

    private MediaExtractor mMediaExtractor = null;
    private MediaCodec mMediaCodec = null;

    private Surface mSurface = null;
    private String mPath = null;
    private int mVideoTrackIndex = -1;

    public AV_VideoDecoder(String path, Surface surface) {
        mPath = path;
        mSurface = surface;

        initCodec();
    }

    public boolean prepare(long time) {
        return decodeFrameAt(time);
    }

    public void startDecode() {
    }

    public void release() {
        if (null != mMediaCodec) {
            mMediaCodec.stop();
            mMediaCodec.release();
        }

        if (null != mMediaExtractor) {
            mMediaExtractor.release();
        }
    }

    private boolean initCodec() {
        Log.i(TAG, "initCodec");
        mMediaExtractor = new MediaExtractor();
        try {
            mMediaExtractor.setDataSource(mPath);
        } catch (IOException e) {
            e.printStackTrace();
            return false;
        }

        int trackCount = mMediaExtractor.getTrackCount();
        for (int i = 0; i < trackCount; ++i) {
            MediaFormat mf = mMediaExtractor.getTrackFormat(i);
            String mime = mf.getString(MediaFormat.KEY_MIME);
            if (mime.startsWith(VIDEO_MIME_PREFIX)) {
                mVideoTrackIndex = i;
                break;
            }
        }
        if (mVideoTrackIndex < 0)
            return false;

        mMediaExtractor.selectTrack(mVideoTrackIndex);
        MediaFormat mf = mMediaExtractor.getTrackFormat(mVideoTrackIndex);
        String mime = mf.getString(MediaFormat.KEY_MIME);
        try {
            mMediaCodec = MediaCodec.createDecoderByType(mime);
        } catch (IOException e) {
            e.printStackTrace();
        }

        mMediaCodec.configure(mf, mSurface, null, 0);
        mMediaCodec.setVideoScalingMode(MediaCodec.VIDEO_SCALING_MODE_SCALE_TO_FIT_WITH_CROPPING);
        mMediaCodec.start();
        Log.i(TAG, "initCodec end");

        return true;
    }

    private boolean mIsInputEOS = false;

    private boolean decodeFrameAt(long timeUs) {
        Log.i(TAG, "decodeFrameAt " + timeUs);
        mMediaExtractor.seekTo(timeUs, MediaExtractor.SEEK_TO_PREVIOUS_SYNC);

        mIsInputEOS = false;
        CodecState inputState = new CodecState();
        CodecState outState = new CodecState();
        boolean reachTarget = false;
        for (; ; ) {
            if (!inputState.EOS)
                handleCodecInput(inputState);

            if (inputState.outIndex < 0) {
                handleCodecOutput(outState);
                reachTarget = processOutputState(outState, timeUs);
            } else {
                reachTarget = processOutputState(inputState, timeUs);
            }

            if (true == reachTarget || outState.EOS) {
                Log.i(TAG, "decodeFrameAt " + timeUs + " reach target or EOS");
                break;
            }

            inputState.outIndex = -1;
            outState.outIndex = -1;
        }

        return reachTarget;
    }

    private boolean processOutputState(CodecState state, long timeUs) {
        if (state.outIndex < 0)
            return false;

        if (state.outIndex >= 0 && state.info.presentationTimeUs < timeUs) {
            Log.i(TAG, "processOutputState presentationTimeUs " + state.info.presentationTimeUs);
            mMediaCodec.releaseOutputBuffer(state.outIndex, false);
            return false;
        }

        if (state.outIndex >= 0) {
            Log.i(TAG, "processOutputState presentationTimeUs " + state.info.presentationTimeUs);
            mMediaCodec.releaseOutputBuffer(state.outIndex, true);
            return true;
        }

        return false;
    }

    private class CodecState {
        int outIndex = MediaCodec.INFO_TRY_AGAIN_LATER;
        BufferInfo info = new BufferInfo();
        boolean EOS = false;
    }

    private void handleCodecInput(CodecState state) {
        ByteBuffer[] inputBuffer = mMediaCodec.getInputBuffers();

        for (; !mIsInputEOS; ) {
            int inputBufferIndex = mMediaCodec.dequeueInputBuffer(10000);
            if (inputBufferIndex < 0)
                continue;

            ByteBuffer in = inputBuffer[inputBufferIndex];
            int readSize = mMediaExtractor.readSampleData(in, 0);
            long presentationTimeUs = mMediaExtractor.getSampleTime();
            int flags = mMediaExtractor.getSampleFlags();

            boolean EOS = !mMediaExtractor.advance();
            EOS |= (readSize <= 0);
            EOS |= ((flags & MediaCodec.BUFFER_FLAG_END_OF_STREAM) > 0);

            Log.i(TAG, "input presentationTimeUs " + presentationTimeUs + " isEOS " + EOS);

            if (EOS && readSize < 0)
                readSize = 0;

            if (readSize > 0 || EOS)
                mMediaCodec.queueInputBuffer(inputBufferIndex, 0, readSize, presentationTimeUs, flags | (EOS ? MediaCodec.BUFFER_FLAG_END_OF_STREAM : 0));

            if (EOS) {
                state.EOS = true;
                mIsInputEOS = true;
                break;
            }

            state.outIndex = mMediaCodec.dequeueOutputBuffer(state.info, 10000);
            if (state.outIndex >= 0)
                break;
        }
    }

    private void handleCodecOutput(CodecState state) {
        state.outIndex = mMediaCodec.dequeueOutputBuffer(state.info, 10000);
        if (state.outIndex < 0) {
            return;
        }

        if ((state.info.flags & MediaCodec.BUFFER_FLAG_END_OF_STREAM) != 0) {
            state.EOS = true;
            Log.i(TAG, "reach output EOS " + state.info.presentationTimeUs);
        }
    }
} 
```

**6\. AV_BitmapUtil.java**

```
public class AV_BitmapUtil {
    public static void saveBitmap(Bitmap bmp, String path) {
        try {
            FileOutputStream fos = new FileOutputStream(path);
            bmp.compress(CompressFormat.JPEG, 100, fos);
            fos.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static Bitmap flip(Bitmap src) {
        Matrix matrix = new Matrix();
        matrix.preScale(1.0f, -1.0f);
        return Bitmap.createBitmap(src, 0, 0, src.getWidth(), src.getHeight(), matrix, true);
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-05T06:36:10.913

```
long time;

    String formattedFileCount;
    FileOutputStream fos;
    BufferedOutputStream bos;

    NumberFormat fileCountFormatter = new DecimalFormat("00000");
    int fileCount = 0;
    File jpegFile;
    ArrayList<Bitmap> bArray = null;
    Bitmap lastbitmap = null; 
    bArray = new ArrayList<Bitmap>(); 
```

我以微秒为单位获取时间，并从 Mediaplayer 获取持续时间，例如：

```
time = mp.getDuration()*1000;
Log.e("Timeeeeeeee", time);

                bArray.clear();
                MediaMetadataRetriever mRetriever = new MediaMetadataRetriever();
                mRetriever.setDataSource(path);
                int  j=0; 
```

我的帧速率是 12 帧/秒，所以我除以 1/12 = 0.083333，这是一帧的第二部分，然后我将帧秒转换为微秒，所以它变成 83333

```
 for (int i = 833333; i <= time; i=i+83333) {
                    bArray.add(mRetriever.getFrameAtTime(i, MediaMetadataRetriever.OPTION_CLOSEST_SYNC));

                    formattedFileCount = fileCountFormatter.format(fileCount); 
                    lastbitmap = bArray.get(j);
                    j++;
                     // image is the bitmap
                        jpegFile = new File(Environment.getExternalStorageDirectory().getPath() + "/frames/frame_" + formattedFileCount + ".jpg");
                        fileCount++;

                        try {
                            fos = new FileOutputStream(jpegFile);
                            bos = new BufferedOutputStream(fos);
                            lastbitmap.compress(Bitmap.CompressFormat.JPEG, 15, bos);

                            bos.flush();
                            bos.close();
                        } catch (FileNotFoundException e) {

                            e.printStackTrace();
                        } catch (IOException e) {

                            e.printStackTrace();
                        }

                }

            } catch (Exception e) {

            } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-04T18:19:33.337

在你的 for/loop 上试试这个：

```
Bitmap bitmap = retriever.getFrameAtTime(
    TimeUnit.MICROSECONDS.convert(i, TimeUnit.MILLISECONDS), 
    retriever.OPTION_CLOSEST_SYNC); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-04T11:05:56.543

使用 MetaMediaRetriever 我能够获得视频的截图

[https://code.google.com/p/android/issues/detail?id=35794](https://code.google.com/p/android/issues/detail?id=35794)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-03T23:02:17.003

**@Navneet 克里希纳**

视频具有关键帧（有时称为“同步”帧）。问题可能是：当您使用时，第一帧是**最接近的同步**`OPTION_CLOSEST_SYNC`帧......

尝试替换此行：

```
Bitmap bitmap=retriever.getFrameAtTime(i,OPTION_CLOSEST_SYNC); 
```

有了这个（它会在给定时间获得最接近的可用帧）：

```
Bitmap bitmap=retriever.getFrameAtTime(i,OPTION_CLOSEST); 
```

阅读：[`CLOSEST`](https://developer.android.com/reference/android/media/MediaMetadataRetriever#OPTION_CLOSEST)& [`CLOSEST_SYNC`](https://developer.android.com/reference/android/media/MediaMetadataRetriever#OPTION_CLOSEST_SYNC)。

下面的代码未经测试，但是是*“如何...”*的一般概念，所以如果对您有帮助，现在让我...
结果应该是视频持续时间每秒一张图片。用短视频进行测试。

```
//Create a new Media Player
MediaPlayer mp = MediaPlayer.create(getBaseContext(), videoFileUri);

int millis = mp.getDuration();

for (int i = 0; i < millis; i += 1000) 
{
    Bitmap bmp = retriever.getFrameAtTime( i * 1000, MediaMetadataRetriever.OPTION_CLOSEST );
    if (bmp != null) { rev.add( bmp ); }
}

retriever.release (); 
```

# android - 无法在android上将项目添加到数据库

> ID：12772548
> 
> 赞同：1
> 
> 时间：2012-10-07T20:22:06.463
> 
> 标签：android, sqlite

我正在尝试将这些项目添加到我的数据库中，但无法理解为什么它的添加量超过了我写的添加量，以及为什么它没有删除想要的表，因为 CursorDb.getCount() 的计数总是增长。

通用代码：

```
DBAdapter dbAdper=new DBAdapter(this);
        dbAdper.open();
        Cursor CursorDb =dbAdper.getAllTitles();

        //dbAdper.dropTable();
        dbAdper.insertTitle("rsstitle", "here need to be link");
        dbAdper.insertTitle("rsstitle2", "here need to be link2");
        dbAdper.insertTitle("rsstitle3", "here need to be link3");

        int n=CursorDb.getCount();
        do
        {
            String s= CursorDb.getString(CursorDb.getColumnIndex("RssTitle"));
            list.add(s);

        }while(CursorDb.moveToNext());
        CursorDb.close(); 
```

和 db 的类

```
public class DBAdapter {

    private static final int DATABASE_VERSION = 1;

    private static final String DATABASE_CREATE =
            "create table titles (_id integer primary key autoincrement, "
                    + "link text not null, RssTitle text not null);";

    private final Context context; 

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public DBAdapter(Context ctx) 
    {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper 
    {
        DatabaseHelper(Context context) 
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) 
        {
            db.execSQL(DATABASE_CREATE);
        }

public void dropTable() throws SQLException 
    {
        //DROP TABLE IF EXISTS mydatabase.myTable
        db.execSQL("DROP TABLE IF EXISTS "+DATABASE_NAME+"."+DATABASE_TABLE);
    }
//---insert a title into the database---
public long insertTitle(String insertLink, String title) 
{
    ContentValues initialValues = new ContentValues();
    initialValues.put(link, insertLink);
    initialValues.put(RssTitle, title);

    return db.insert(DATABASE_TABLE, null, initialValues);
}

//---retrieves all the titles---
public Cursor getAllTitles() 
{
    return db.query(DATABASE_TABLE, new String[] {
            KEY_ROWID, 
            link,
            RssTitle,
    }, 
    null, 
    null, 
    null, 
    null,
    null
            );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:51:49.840

如果删除表格，则没有表格可以插入标题。你当时有没有报错？logcat 里有什么？如果你的光标是打开的，我认为，表删除应该失败。你当时有没有发现任何错误？

解决方案是设计一个干净的实验，在好的地方插入足够的日志记录语句/断点，卸载，重建，运行几次。每次都分析日志（查找 SQLException 之类的错误！）并将您期望的内容与实际得到的内容进行比较。如果仍然不清楚，请发布您的计划和您得到的结果。

PS。此外，您需要在光标上调用 moveToFirst()。插入后？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T14:04:43.350

如果错误，错误是''，只需要这样做：

```
db.execSQL("DROP TABLE IF EXISTS '" + DATABASE_TABLE + "'"); 
```

# php - 在处理 XSS 攻击预防时，什么构成“用户输入”？

> ID：12772551
> 
> 赞同：0
> 
> 时间：2012-10-07T20:22:28.117
> 
> 标签：php, security, xss

我希望保护我的代码免受 XSS 攻击，但我一直在阅读的所有示例都涉及直接用户输入验证（例如在联系表单或登录中）。

如果无法直接输入（即我的网站只是从数据库中读取而不是写入），我是否需要保护我的代码，我有点困惑？我仍然认为我需要这样做，因为我将我的数据库归类为外部源，并且回显的变量中的数据仍然来自其他地方。

我是否认为读取的任何数据仍然构成用户输入并应进行相应处理？此外，如果我随后添加了一个联系表格，我是否需要在每个页面中验证/清理/转义从我的数据库中提取的每条信息，还是只在表格本身处理它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T20:53:58.910

忘掉“用户输入”这个词，用“未知字符串”来思考。任何你不*知道*它所包含的事实的东西在正确的**上下文**中都是潜在的危险或破坏性的。

同样重要的是要记住，没有适用于所有情况的单一解决方案。例如，这些都可能需要不同类型的消毒或转义：

*   HTML 属性：`<a href="$unknown">`
*   HTML文本内容：`<p>$unknown</p>`
*   javascript:`<script>var B = $unknown;</script>`
*   SQL：`SELECT * from $unknown`
*   CSS：`.myClass { color:$unknown; }`

一般来说，您应该（如果可能）避免在 HTML 属性、CSS 或 Javascript 中使用未知数据——因为这些地方可能会变得复杂。在大多数情况下，只需转义 HTML 字符即可。

这里的关键词是**context**，这就是为什么你不想“清理” *input*而是 output 的原因之一。相同的数据可以在不同的上下文中使用，并且需要不同的转义或过滤措施。

我强烈建议使用 OWASP 作为学习 XSS 和一般安全性的资源：[https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:27:24.950

> 我是否认为读取的任何数据仍然构成用户输入并应进行相应处理？

一般来说 - 是的。大多数数据库主要包含纯文本和数字。

不过也有例外。例如，如果您在其中显式存储 HTML，并确保在输入时它是安全的（或至少是可信的），那么当您提取数据时，您无需担心保护自己免受 XSS 攻击。这方面的一个例子是允许用户在文章中输入 HTML 的 CMS（例如 Wordpress）。

> 此外，如果我随后添加了一个联系表格，我是否需要在每个页面中验证/清理/转义从我的数据库中提取的每条信息，还是只在表格本身处理它？

该表格允许输入来自系统外部的数据。当您将数据放在任何地方时，您需要采取任何适合的措施。如果将其放入 SQL 字符串中，则需要将其转义为 SQL。如果将其放入电子邮件主题中，则需要为此进行转义。如果将其放入 HTML 文档中，则需要为此进行转义。（等等）。

# apache - Varnish — 仅在后端关闭时从缓存发送

> ID：12772553
> 
> 赞同：1
> 
> 时间：2012-10-07T20:22:44.317
> 
> 标签：apache, caching, varnish

是否可以将清漆配置为如下行为？

*   当 apache 启动时——直接从 apache 提供内容（即使对象被缓存在 varnish 中）并且还缓存所有内容。类似于 return(pass) 但带有缓存的东西。
*   当 apache 关闭时——从缓存中提供所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:30:45.870

Varnish 是一个缓存服务器，所以只有在出现问题时才使用它对我来说有点奇怪。

您可能可以使用一些 VCL 来实现您想要的，但我认为这将意味着为每个请求缓存一个新对象，在我看来，这太过分了。

我建议你缓存任何你想要缓存的东西，即使 TTL 很低，并使用[Grace 和 Saint 模式](https://www.varnish-cache.org/docs/3.0/reference/vcl.html#grace-and-saint-mode)来满足你的第二点，用户会很高兴，你也会很高兴（我希望 :)）。

# python - 芹菜任务链取消？

> ID：12772556
> 
> 赞同：10
> 
> 时间：2012-10-07T20:22:54.503
> 
> 标签：python, celery, delayed-execution

我发现 celery 支持任务链：[http](http://celery.readthedocs.org/en/latest/userguide/canvas.html#chains) ://celery.readthedocs.org/en/latest/userguide/canvas.html#chains 。

问题是：**如何停止链在任务中的执行？**

例如，我们得到一个包含 N 个项目的链（N > 2）。在第二个任务中，我们意识到我们不需要执行所有其余的任务。该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-12T22:14:32.620

在较新版本的 celery (3.1.6) 中，您可以通过简单地遍历链并依次撤销每个项目来撤销整个链。

```
# Build a chain for results
from tasks import addd
from celery import chain

def revoke_chain(result):
    while result:
        result.revoke()
        result = result.parent

# independent tasks (with immutable signatures)
c = chain(*tuple(add.si(i,i) for i in xrange(50)))
h = c()

# some time later ...
revoke_chain(h)

# dependant task
c = add.s(1,1) | add.s(2) | add.s(3)
h = c()

# some time later ...
revoke_chain(h) 
```

# ruby-on-rails - 向设计注册添加自定义操作..未知操作错误

> ID：12772557
> 
> 赞同：1
> 
> 时间：2012-10-07T20:22:55.330
> 
> 标签：ruby-on-rails, devise

在到处搜索有关如何解决此问题后，我决定发布一个问题。我正在尝试将自定义操作“create_pro”添加到设计注册控制器，以便我可以创建一个具有附加字段的用户（专业用户）。此表单与用户的设计创建操作位于同一页面上。

提交表单后，我不断收到以下错误：

> 未知动作
> 
> 找不到 Devise::RegistrationsController 的操作“create_pro”

*我怎样才能解决这个问题？*

**路线**

```
 devise_for :users,:controllers => { :registrations => "registrations" }
  devise_scope :user do
    post "gopro", :to => "devise/registrations#create_pro"
  end 
```

**注册控制器**

```
class RegistrationsController < Devise::RegistrationsController
  before_filter :authenticate_user!, :only => :token

  def new
    super
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:notice] = "Welcome to Banking Analytics."
      redirect_to '/mybank'
    else
      render :action => :new
    end
  end

  def create_pro
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:notice] = "Welcome to Banking Analytics."
      redirect_to '/mybank'
    else
      render :action => :new
    end
  end
end 
```

**看法**

```
<div class="signup_form_basic">
<%= simple_form_for @user, :url => url_for(:controller => 'registrations', :action => 'create_pro') do |f| %>
  <%= f.error_notification %>
    <%= f.input :email, :required => true, :autofocus => true, :label => 'Username ( Your Email )', :placeholder => 'Email Address' %>
    <%= f.input :password, :required => true, :autofocus => true, :label => 'Password', :placeholder => 'Password' %>
    <%= f.input :password_confirmation, :required => true, :autofocus => true, :label => 'Confirm Password', :placeholder => 'Password Confirmation' %>
    <%= f.button :submit, "Sign Up  >>", class: 'btn btn-inverse' %>
<% end %>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:42:04.453

对于您面临的“未知操作错误”，我没有答案，但我认为当前的解决方案是次优的。

由于您的目标是拥有以下两类用户

1.  专业用户，和
2.  普通（非专业）用户，

最好遵循[如何：自定义用户注册页面的路径](https://github.com/plataformatec/devise/wiki/How-To%3a-Customize-routes-to-user-registration-pages)并为两种类型的用户设置并行结构中的建议。

这将更符合两类用户之间的关系。

# asp.net - 一些 在一个列表视图中

> ID：12772558
> 
> 赞同：0
> 
> 时间：2012-10-07T20:23:00.427
> 
> 标签：asp.net, listview, itemtemplate

我看到了很多使用 ListView 的示例，但找不到在一个 ListView 中使用两个（或更多）ItemTemplate 的简单易懂的示例（如果可能的话）。我想在 .aspx 页面上定义它们或以编程方式制作，并且，根据我的需要选择其中之一（不同绑定数据的不同模板）。知道吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T22:13:59.360

我希望这能帮助你实现你想要的？ [http://blogs.msdn.com/b/mikeormond/archive/2008/07/26/dynamically-loading-listview-templates.aspx](http://blogs.msdn.com/b/mikeormond/archive/2008/07/26/dynamically-loading-listview-templates.aspx)

还可以通过这篇文章获得一些见解 [http://forums.asp.net/t/1699218.aspx/1?ListView+ItemCommand+event+not+working+with+Dynamic+Templates](http://forums.asp.net/t/1699218.aspx/1?ListView+ItemCommand+event+not+working+with+Dynamic+Templates)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-24T19:35:08.850

您可以在其中制作一个`<ItemTemplate>`包含多个面板的面板，然后在代码中只使其中一个可见。

# ios - MKMapView 没有通过调用 setRegion:animated 来更新

> ID：12772560
> 
> 赞同：1
> 
> 时间：2012-10-07T20:23:25.653
> 
> 标签：ios, mkmapview, ios6, ios6-maps

我正在尝试学习如何使用 MKMapView 并为此创建了一个示例应用程序；但是，在我的代码中，我正在调用以`setRegion:animated`更改中心点和跨度，但地图永远不会更新。我在 StackOverflow (SO) 上运行了几个线程，其他人提到了类似的问题并尝试实施他们的解决方案无济于事。

我确保根据我发现的其他 SO 线程在我的代码中尝试的事情：

*   确保我用框架初始化了 MKMapView
*   尝试`setRegion:animated`在主线程上运行方法调用

我在下面包含了我的代码，任何人都可以解释为什么我的 MKMapView 实例不会更新它的视图吗？

编辑：正确的代码如下所示： **MK_ViewController.h**：

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface MV_ViewController : UIViewController {
    IBOutlet MKMapView *myMapView;
    MKCoordinateRegion defaultRegion;
    CLLocationCoordinate2D defaultCenter;
    MKCoordinateSpan defaultSpan;
}

@end 
```

**MK_ViewController.m**：

```
#import "MV_ViewController.h"

@interface MV_ViewController ()

@end

@implementation MV_ViewController

- (void)viewDidLoad {

    [super viewDidLoad];

    // initialize default map view properties
    defaultCenter = CLLocationCoordinate2DMake(33.732894,-118.091718);
    defaultSpan = MKCoordinateSpanMake(0.028270, 0.0465364);

    // Setup MapView's inital region
    defaultRegion = MKCoordinateRegionMake(defaultCenter, defaultSpan);

    // create the map view
    CGRect screenRect = [[UIScreen mainScreen] bounds];
    myMapView = [[MKMapView alloc] initWithFrame:screenRect];

}

- (void)viewWillAppear:(BOOL)animated {

    [super viewWillAppear:animated];

    // update map's initial view
    [myMapView setRegion:defaultRegion animated:YES];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

**MK_ViewController+MKMapViewDelegate.m**：

```
#import "MV_ViewController.h"

@implementation MV_ViewController (MKMapViewDelegate)

- (void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated {
    MKCoordinateRegion region = mapView.region;
    CLLocationCoordinate2D center = region.center;
    MKCoordinateSpan span = region.span;

    NSLog(@"Center (lat,lon): (%f,%f)",center.latitude,center.longitude);
    NSLog(@"Span (lat,lon): (%f,%f)",span.latitudeDelta,span.longitudeDelta);
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-09T14:27:59.673

我通过从 NIB 中删除 MKViewMap 对象解决了这个问题，而是使用 MK_ViewController.m 文件中的以下代码添加它：

```
[self.view addSubView:myMapView]; 
```

问题是NIB 没有正确连接到视图控制器，并且视图控制器正在创建它自己的地图视图。

感谢@Jason Cabot 为我指明了正确的方向。

# c++ - 在 C++11 中检查字符串是否为 T 类型

> ID：12772561
> 
> 赞同：1
> 
> 时间：2012-10-07T20:23:27.127
> 
> 标签：c++, string, types

是否有标准库函数来检查字符串 S 是否属于 T 类型，因此可以转换为 T 类型的变量？

我知道有一个 istringstream STL 类，它可以使用 operator>> 用从字符串转换的值填充 T 类型的变量。但是，如果字符串内容不是 T 类型的格式，它将被无意义地填充。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:31:12.500

正如@Cameron 评论的那样，您能做的最好的事情就是尝试并失败：

```
#include <string>
#include <sstream>
#include <boost/optional.hpp>

template <typename T>
boost::optional<T> convert(std::string const & s)
{
    T x;
    std::istringstream iss(s);
    if (iss >> x >> std::ws && iss.get() == EOF) { return x; }
    return boost::none;
} 
```

或者，没有提升：

```
template <typename T>
bool convert(std::string const & s, T & x)
{
    std::istringstream iss(s);
    return iss >> x >> std::ws && iss.get() == EOF;
} 
```

用法：

*   第一个版本：

    ```
    if (auto x = convert<int>(s))
    {
        std::cout << "Read value: " << x.get() << std::endl;
    }
    else
    {
        std::cout << "Invalid string\n";
    } 
    ```

*   第二个版本：

    ```
    {
        int x;
        if (convert<int>(s, x))
        {
            std::cout << "Read value: " << x << std::endl;
        }
        else
        {
            std::cout << "Invalid string\n";
        }
    } 
    ```

请注意，这`boost::lexical_cast`基本上是一个更聪明的版本，它声称非常有效（可能比我们在这里所做的无条件使用 iostreams 更有效）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T20:29:56.917

没有标准库函数。要查看它是否成功，您应该检查来自`operator>>`：

```
std::istringstream iss(mystring);

// if you want trailing whitespace to be invalid, remove std::ws
if((iss >> myT >> std::ws) && iss.eof())
{
   // success
}
else
{
   // failed
} 
```

# c++ - 将二维数组转换为 std::map？

> ID：12772564
> 
> 赞同：4
> 
> 时间：2012-10-07T20:23:34.533
> 
> 标签：c++, arrays, map, vector

`std::vector`数组可以轻松有效地转换为：

```
template <typename T, int N>
vector<T> array_to_vector(T(& a)[N]) {

  return vector<T>(a, a + sizeof(a) / sizeof(T));

} 
```

是否有类似的方法可以将二维数组转换为 a`std::map`而无需遍历成员？这看起来像是一个不寻常的函数签名，但在我的特殊情况下，这些映射中的键和值将属于同一类型。

```
template <typename T, int N>
map<T, T> array_to_map(T(& a)[N][2]) {

  // ...?

} 
```

这是我为这个问题整理的测试代码。它将按原样编译和运行；目标是让它与未注释的块注释一起编译`main`。

```
#include <iostream>
#include <string>
#include <vector>
#include <map>

using namespace std;

template <typename T, int N>
vector<T> array_to_vector(T(& a)[N]) {

  return vector<T>(a, a + sizeof(a) / sizeof(T));

}

template <typename T, int N>
map<T, T> array_to_map(T(& a)[N][2]) {

  // This doesn't work; members won't convert to pair 

  return map<T, T>(a, a + sizeof(a) / sizeof(T));

}

int main() {

  int a[] = { 12, 23, 34 };

  vector<int> v = array_to_vector(a);

  cout << v[1] << endl;

  /*
  string b[][2] = {
    {"one", "check 1"},
    {"two", "check 2"}
   };

  map<string, string> m = array_to_map(b);

  cout << m["two"] << endl;
  */
} 
```

同样，我不是在寻找迭代数组每个成员的代码的答案......我可以自己写。如果不能以更好的方式完成，我会接受它作为答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:45:32.107

以下对我来说很好：

```
template <typename T, int N>
map<T, T> array_to_map(T(& a)[N][2]) 
{
    map<T, T> result;
    std::transform(
        a, a+N, std::inserter(result, result.begin()),
        [] (T const(&p)[2]) { return std::make_pair(p[0], p[1]); }
        );

    return result;
} 
```

如果你有 C++03，你可以使用

```
template <typename T>
static std::pair<T, T> as_pair(T const(&p)[2]) {
    return std::make_pair(p[0], p[1]);
}

template <typename T, int N>
map<T, T> array_to_map(T(& a)[N][2]) {
    map<T, T> result;
    std::transform(a, a+N, std::inserter(result, result.begin()), as_pair<T>);
    return result;
} 
```

### 完整演示[http://liveworkspace.org/code/c3419ee57fc7aea84fea7932f6a95481](http://liveworkspace.org/code/c3419ee57fc7aea84fea7932f6a95481)

```
#include <iostream>
#include <string>
#include <vector>
#include <map>
#include <algorithm>
#include <iterator>

using namespace std;

template <typename T, int N>
vector<T> array_to_vector(T const(& a)[N]) {
  return vector<T>(a, a + sizeof(a) / sizeof(T));
}

template <typename T>
static std::pair<T, T> as_pair(T const(&p)[2])
{
    return std::make_pair(p[0], p[1]);
}

template <typename T, int N>
map<T, T> array_to_map(T const(& a)[N][2]) 
{
    map<T, T> result;

    // C++03: std::transform(a, a+N, std::inserter(result, result.begin()), as_pair<T>);
    std::transform(
        a, a+N, std::inserter(result, result.begin()),
        [] (T const(&p)[2]) { return std::make_pair(p[0], p[1]); }
        );

    return result;
}

int main() {

  int a[] = { 12, 23, 34 };
  vector<int> v = array_to_vector(a);
  cout << v[1] << endl;

  const string b[][2] = {
    {"one", "check 1"},
    {"two", "check 2"}
   };

  map<string, string> m = array_to_map(b);

  cout << m["two"] << endl;
} 
```

# javascript - 将多个变量传递给函数以添加/删除类 Jquery/Javascript

> ID：12772567
> 
> 赞同：2
> 
> 时间：2012-10-07T20:24:05.293
> 
> 标签：javascript, jquery, forms, variables

我试图首先清除所有类`options`，然后使用相应的字母将一个类添加到选项中。这是我的功能：

```
function setAnswer(b, c){
      $('#'+b+' .option').removeClass("answer");
      $('#'+b+' .option'+c).addClass("answer");  
  } 
```

和表格

```
 <div id="belh" class="options">
                <label>a.</label><input class="option optiona"><input onClick="setAnswer(this.parentnode.id, this.classname)" type="radio" class="a" name="answer">&nbsp;
                <label>b.</label><input class="option optionb"><input onClick="setAnswer(this.parentnode.id, this.classname)" type="radio" class="b" name="answer">
                <div class="clear"></div>
                <label>c.</label><input class="option optionc"><input onClick="setAnswer(this.parentnode.id, this.classname)" type="radio" class="c" name="answer">&nbsp;
                <label>d.</label><input class="option optiond"><input onClick="setAnswer(this.parentnode.id, this.classname)" type="radio" class="d" name="answer">
                </div> 
```

div 的 id`belh`动态变化，所以我传递给函数中的`this.parentnode.id`变量`b`，所以我可以这样做：

```
 $('#'+b+' .option').removeClass("answer"); 
```

从所有选项元素中删除类
现在我传递`this.classname`给`c`所以我可以在这里使用字母 (a,b,c,d)：

```
$('#'+b+' .option'+c).addClass("answer"); 
```

因此，如果单击带有类的单选框，则 div中具有类`c`的所有字段都将丢失类答案（如果有的话）。然后带有类的字段将添加类。（因为：）。出于某种原因，我的功能不起作用。我想我以错误的方式传递变量。`option``belh``optionc``answer``$('#'+b+' .option'+c).addClass("answer");`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T20:32:53.960

您应该编码`this.className`and `this.parentNode.id`，您还可以使用 jQuery`change`事件方法和`prev`方法来选择单击输入的上一个兄弟：

```
$('#belh input[name=answer]').change(function(){
    $('input.option').removeClass('answer');
    $(this).prev().addClass('answer')
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:35:01.677

您是否尝试过切换类名？[http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

# jquery - 在 django 模板中使用带有隐藏表行的 jQuery 可排序

> ID：12772569
> 
> 赞同：1
> 
> 时间：2012-10-07T20:24:15.610
> 
> 标签：jquery, django, django-templates, jquery-ui-sortable

我有一个显示在表格元素中的待办事项列表：

```
<table class="table table-condensed>
    <thead>
        <tr class="table_header">
            <th>Task Name</th>
        </tr>
    </thead>
    <tbody class="sortable">
        {% for action in actions %}
            <tr class="item_row" id = "action_{{ action.id }}">
                <td>{{ action }}</td>
            </tr>
            <tr class="detailed_row" id = "detail_{{ action.id }}">
                <td>{{ action.notes }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table> 
```

我在表格每一行的动作名称和动作注释之间交替。当页面加载时，我隐藏了所有的 detail_rows，以便用户只能看到操作名称。如果用户单击名称行，我会显示该操作的注释行（使用切换）。

```
$(document).ready(function() {
    $(".detailed_row").hide();  
}); 

$(function($) { 
    $(".item_row").click(function() {
        if( $(this).next().is(':hidden') ) {
            $(".detailed_row").hide();
            $(this).next().toggle('fast');
        } else {
            $(".detailed_row").hide();
        }
    }); 
}); 
```

我希望用户能够通过拖动操作名称行来对待办事项列表进行排序。我正在使用 jQuery 的可排序：

```
$(".sortable").sortable().disableSelection(); 
```

让我们暂时忽略动作音符行的移动。如果用户拖动一个注释行，或者在另一个名字和一个注释行之间放置一个名字行，它会弄乱切换逻辑。我已经通过在移动注释行时移动名称行来解决这个问题，反之亦然，这样对总是以正确的顺序排列。

我遇到的问题是注释行中注释的大小。如果注释只有几行，则排序行为表现得很好。但是，如果注释足够长，排序似乎效果不佳，即使注释已折叠。

例如，如果我将 {{ action.notes }} 替换为实际文本，则效果很好：

```
<table class="table table-condensed>
    <thead>
        <tr class="table_header">
            <th>Task Name</th>
        </tr>
    </thead>
    <tbody class="sortable">
        {% for action in actions %}
            <tr class="item_row" id = "action_{{ action.id }}">
                <td>{{ action }}</td>
            </tr>
            <tr class="detailed_row" id = "detail_{{ action.id }}">
                <td>Test text data</td>
            </tr>
        {% endfor %}
    </tbody>
</table> 
```

但这不会：

```
<table class="table table-condensed>
    <thead>
        <tr class="table_header">
            <th>Task Name</th>
        </tr>
    </thead>
    <tbody class="sortable">
        {% for action in actions %}
            <tr class="item_row" id = "action_{{ action.id }}">
                <td>{{ action }}</td>
            </tr>
            <tr class="detailed_row" id = "detail_{{ action.id }}">
                <td>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus elementum imperdiet convallis. Nam ac nunc at magna pretium rhoncus eget ac neque. Nullam tempus feugiat euismod. Nunc posuere est consectetur nunc dignissim at faucibus mi convallis. Integer mattis nisi sit amet ante malesuada ut sagittis nulla congue. Pellentesque bibendum pulvinar mattis. Duis lorem libero, commodo hendrerit tincidunt quis, sodales eget nunc. Proin mauris mi, placerat quis pharetra eu, vestibulum vel mi. Vivamus luctus condimentum tortor ut accumsan. Fusce scelerisque, neque vel sollicitudin porta, ipsum lorem tempus mauris, et consequat nibh ipsum ut tortor. Aenean ut ante id justo pellentesque convallis. Etiam eu risus leo. Suspendisse potenti. Maecenas blandit, lectus sit amet suscipit viverra, enim velit bibendum nulla, sed aliquet arcu est quis justo. Sed sed est mi.
                    Morbi vel tortor iaculis sapien accumsan ullamcorper at id justo. Nulla facilisi. Nam adipiscing tellus a metus blandit quis vestibulum metus scelerisque. Nam risus tortor, pharetra vel condimentum lobortis, venenatis in tortor. Proin sit amet erat nulla, a dignissim lectus. Nullam dapibus ullamcorper justo, in imperdiet turpis egestas eget. Etiam dignissim faucibus ipsum. Nunc at diam risus, non rhoncus lectus. Praesent eget dolor vel ipsum blandit sagittis quis at ligula. Nunc euismod orci non felis scelerisque hendrerit. Quisque imperdiet lobortis erat, a tempus enim condimentum vitae. Proin rutrum ligula odio. Praesent nec magna lectus, quis congue augue. Nullam vestibulum tempus elit id sollicitudin. Nullam a nibh nisi, vitae tristique sem.
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table> 
```

动作名称行的移动变得不稳定，它不知道将自己放置在哪里，其他行没有正确移位，等等。

我该如何解决这种行为？我希望系统假装动作注释行基本上不存在，尽管那里可能有很多文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T20:51:20.103

我最终[将详细信息和项目行放入同一行](https://stackoverflow.com/questions/12786759/css-when-combining-tables-divs-and-spans)，然后折叠详细信息部分。这样我可以在表格行周围拖动，它不会认为它是整个细节部分的高度

# java - 无效的整数：“”？

> ID：12772572
> 
> 赞同：2
> 
> 时间：2012-10-07T20:24:55.357
> 
> 标签：java, android

我正在尝试保存我的应用程序的状态，我认为这一切看起来都不错，但我不断收到此错误：

```
10-07 15:18:35.386: E/AndroidRuntime(1818): Caused by: java.lang.NumberFormatException: Invalid int: "" 
```

它不断突出显示我的代码：

```
textView(something) = Integer.parseInt(textView(something).getText().toString()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:27:32.237

您的一个 TextViews 是空白的。空白字符串不能转换为`int`. 您能否将其缩小到导致问题的哪一个（或众多之一）？

**编辑：**

这很可能是因为您正在使用`Activity`'s`onCreate()`方法做所有事情，而系统没有机会`TextView`用它们的文本初始化 s 。这么长的`onCreate()`方法向我表明了设计问题。我强烈建议将您的代码分成一个或多个类。例如，您可能想要创建一个`Hero`代表游戏中用户角色的类。这可以存储与角色相关的所有统计信息。一个`Monster`类也可以代表怪物的统计数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:23:16.987

把这个放在前面`Integer.parseInt`。然后检查 LogCat`text="", len=0`

```
String str = textView(something).getText().toString();
Log.i("app", "text=\"" + str + "\", len=" + str.length);
textView(something) = Integer.parseInt(textView(something).getText().toString()); 
```

# javascript - 如何优化字符串到 DOM 的转换？

> ID：12772575
> 
> 赞同：0
> 
> 时间：2012-10-07T20:25:13.493
> 
> 标签：javascript, dom, optimization, element

当我尝试填充用`div`JavaScript 创建的时，我遇到了一点不方便的“滞后”：

```
var el = document.createElement("div");
el.innerHTML = '<insert string-HTML code here>' 
```

但是，由于 HTML 代码的范围，这是很自然的；有时它的长度超过 300,000 个字符，它是从 GM_xmlHttpRequest 派生的，有时需要 1000 毫秒（[给或取](http://ejohn.org/blog/accuracy-of-javascript-time/)）才能完成，加上 DOM 化导致的额外 500 毫秒。

我试图摆脱大量的文本使用`substr`（授予不是我可能想到的最好的想法），它在大多数情况下令人惊讶地工作，但在某些时候元素将无法接受 HTML 代码（可能是无与伦比的<*.?>)。

我只需要访问存储在其中的极少量文本；正则表达式是[不可能](https://stackoverflow.com/a/1732454/1188585)的，并且认为这将是最好的方法。

编辑：我倾向于提到我对解析 DOM 的定义被低估了，我的意思是说这个“文本”是我修改的很多元素的文本内容。因此，正则表达式不是一种选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:05:57.343

虽然其他分析者专注于猜测您的愿望（解析 DOM 而不进行字符串操作）是否有意义，但我将把这个答案专门用于比较合理的 DOM 解析方法。

为了公平比较，我假设我们需要`<body>`解析 DOM 的元素（作为根容器）。我在[http://jsperf.com/domparser-vs-innerhtml-vs-createhtmldocument](http://jsperf.com/domparser-vs-innerhtml-vs-createhtmldocument)创建了一个基准。

```
var testString = '<body>' + Array(100001).join('<div>x</div>') + '</body>';

function test_innerHTML() {
    var b = document.createElement('body');
    b.innerHTML = testString;
    return b;
}
function test_createHTMLDocument() {
    var d = document.implementation.createHTMLDocument('');
    d.body.innerHTML = testString;
    return d.body;
}
function test_DOMParser() {
    return (new DOMParser).parseFromString(testString, 'text/html').body;
} 
```

第一种方法是您当前的方法。它在所有浏览器中都得到很好的支持。
尽管第二种方法有创建完整文档的开销，但它比第一种方法有很大的好处：***不*****加载****资源（图像）***。与第一个文档的潜在网络流量相比，文档的开销是微不足道的。*

 *最后一种方法在写作时仅在 Firefox 12+ 中受支持（没问题，因为您正在编写 GreaseMonkey 脚本），并且是这项工作的特定工具（具有与前一种方法相同的优点）。顾名思义，它是一个 DOM 解析器。

[基准](http://jsperf.com/domparser-vs-innerhtml-vs-createhtmldocument)测试显示原始方法最快^(4.64 Ops/s)，其次是 DOMParser 方法^(4.22 Ops/s)。最慢的方法是[`createHTMLDocument`](https://developer.mozilla.org/en-US/docs/DOM/DOMImplementation.createHTMLDocument)3.72 ^(Ops/s)方法。虽然差异很小，所以[`DOMParser`](https://developer.mozilla.org/en-US/docs/DOM/DOMParser)出于前面所述的原因，我绝对推荐。

* * *

我知道您正在使用它`GM_xmlhttprequest`来获取数据。但是，如果您能够`XMLHttpRequest`改用，我建议尝试以下方法：您可以获取[文档作为响应，而不是获取纯文本作为响应](https://developer.mozilla.org/en-US/docs/HTML_in_XMLHttpRequest)：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://www.example.com/');
xhr.responseType = 'document';
xhr.onload = function() {
    var bodyElement = xhr.response.body; // xhr.response is a document object
};
xhr.send(); 
```

如果 Greasemonkey 脚本在单个页面上长时间处于活动状态，您仍然可以将此功能用于不支持 CORS 的其他域：在域等于其他域（例如`http://example.com/favicon.ico`）的文档中插入 iframe，并将其用作代理（也为此页面激活 GM 脚本）。插入 iframe 的开销很大，因此此选项不适用于一次性请求。

对于同源请求，此选项可能是最好的选项（尽管没有进行基准测试，但可以争辩说直接返回文档而不是中间字符串操作会带来性能优势）。与`DOMParser`+text/html 方法不同，`responseType="document"`更多浏览器支持：Chrome 18+、Firefox 11+ 和 IE 10+。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:49:09.380

我你有大量的 HTML，并且需要很长时间才能放入 DOM，而你只想要其中的一小部分，加快速度的方法是：

1.  让您的服务器只提供您真正想要的 HTML 部分。这将节省网络传输时间和 DOM 解析时间。

2.  如果您无法修改服务器，那么您需要手动解析一些 HTML 以消除您不想要的部分，这样就不会将那么多部分放入 DOM 中。正则表达式是搜索巨型字符串的较慢方法之一，因此`.indexOf()`如果可能的话，最好使用类似的方法来识别您所定位的一般区域。如果有唯一的 id 或类，并且您知道 HTML 的一般形式，则可以使用更快的算法来识别目标区域。但是，如果您不披露要解析的实际 HTML，我们无法提供比这更多的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T20:39:06.097

我们需要更多地了解您的应用程序，但是当您处理如此多的 HTML 内容时，您可能只想使用`iframe`. 它是异步的，不会拖延 JS 代码，也不会引入过多的潜在调试问题。

使用来自 的原始 HTML 填充元素可能很危险`xmlhttprequest`，主要是由于潜在的 XSS 漏洞和几乎不可能修复的 HTML 故障。如果可能，请考虑使用模板（我相信 JQuery 提供了某种模板解决方案）并加载少量 XML/JSON/等。只有在使用 an`iframe`是不可能的情况下才这样做。*

# c++ - main.obj：错误 LNK2019

> ID：12772576
> 
> 赞同：-1
> 
> 时间：2012-10-07T20:25:15.683
> 
> 标签：c++

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我不断得到

> 错误 LNK2019：函数 _main 中引用了无法解析的外部符号“public：void __thiscall DynamicArray::put(double)”(?put@?$DynamicArray@N@@QAEXN@Z)。

我唯一一次得到这个错误是当我从 DynamicArray 类中调用“put”函数时

动态数组.h

```
#ifndef DYNAMICARRAY_H
#define DYNAMICARRAY_H
#include <new>
#include <cstdlib>
using namespace std;

template <class T>
class DynamicArray
{
    private:
        T *origin;
        T *allocator;
        int size;
        int current;

    public:
        DynamicArray();
        DynamicArray(int);
        DynamicArray(const DynamicArray&);
       ~DynamicArray();
        void add(int);
        void erase(int);
        void empty();
        void put(T);
        void remove();
        int getSize();
        T &operator[](const int&);
        const T operator=(const DynamicArray&);
        void put(T&);
};
template <class T>
DynamicArray<T>::DynamicArray()
{
    origin = new T[5];
    allocator = NULL;
    size = 5;
    current = 0;
}

template <class T>
DynamicArray<T>::DynamicArray(int s)
{
    size = s;

    try
    {
        origin = new T[s];
        allocator = NULL;
    }
    catch(bad_alloc)
    {
        cout << "Error: Bad memery allocation\n";
        exit(EXIT_FAILURE);
    }
}

template <class T>
DynamicArray<T>::DynamicArray(const DynamicArray& obj)
{
    empty();
    for(int counter = 0; counter < obj.size - 1; counter++)
    {
         origin[counter] = obj.origin[counter];
    }
}

template <class T>
DynamicArray<T>::~DynamicArray()
{
    delete [] origin;
    delete [] allocator;
    size = NULL;
}

template <class T>
void DynamicArray<T>::add(int size)
{
    allocator = new T[size];
    for(int counter = 0; counter < this-> size - 1; counter++)
    {
        allocator[counter] = origin[counter];
    }
    origin = NULL;
    origin = new T[size];
    this->size = this->size + size;

    for(int counter = 0; counter < size - 1; counter++)
    {
         origin[counter] = allocator[counter];
    }
    allocator = NULL;
}

template <class T>
void DynamicArray<T>::erase(int ammount)
{
    if(ammount - size > size)
        throw "\nnegetive memory location error\n";

    allocator = new T[size - ammount];

    for(int counter = 0; counter < this-> size - ammount - 1; counter++)
    {
        allocator[counter] = origin[counter];
    }

    origin = NULL;
    size = size - ammount;
    origin = new T[size];

    for(int counter = 0; counter < size - 1; counter++)
    {
        origin[counter] = allocator[counter];
    }
    allocator = NULL;
}

template <class T>
void DynamicArray<T>::empty()
{
    if(size >= 0)
        delete [] origin;
}

template <class T>
void DynamicArray<T>::remove()
{
     erase(1);
}

template <class T>
int DynamicArray<T>::getSize()
{
     return size;
}

template <class T>
T &DynamicArray<T>::operator[](const int &index)
{
    return origin[index];
}

template <class T>
const T DynamicArray<T>::operator=(const DynamicArray &obj)
{
    size = obj.size;
    delete [] origin;

    origin = new T[size];

    for(int counter = 0; counter < size; counter++)
        *(origin + counter) = *(obj.origin + counter);

    return *origin;
}

template <class T>
void DynamicArray<T>::put(T &obj)
{
    if(current == size - 1)
    {

        add(1);
        origin[size - 1] = obj;
        ++current; 
    }
    else
    {
        origin[current] = obj;
        ++current;
    }
}

#endif // !DYNAMICARRAY_H 
```

主文件

```
#include <iostream>
#include "DynamicArray.h"

using namespace std;

int main()
{
    DynamicArray<double> a(5);

    a.put(1);

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:29:14.840

你的头文件说`void put(T);`，但没有定义过这样的函数。（有一个类似的，`void put(T&);`但关闭不计入链接器。）

# c++ - 从 sql 类型 decimal(20,8) 转换为 c++ double

> ID：12772578
> 
> 赞同：1
> 
> 时间：2012-10-07T20:25:36.947
> 
> 标签：c++, double, decimal, mysql-connector

我如何从 sql 十进制类型转换为 double 而无需像这个[答案](https://stackoverflow.com/questions/6746010/convert-decimal-sql-to-double-c)所建议的那样使用查询强制转换底层数据库。我在 MySQL 上并从十进制（20,8）转换为实际导致错误。我正在使用 mysql-connector c++，它可以很好地加载和运行 queires，但我无法将 mysql-connector 格式的数据转换为 c++ 格式的数据。

我正在使用托管在 linux 上的 mysql 5.1.63，同时也从不同的 linux 机器上运行代码 c++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:11:18.013

我没有任何使用 MySQL 标准 C++ 驱动程序（MySQL 连接器/C++）的经验。但是，我使用了 MySQL++ 驱动程序。

MySQL 连接器/C++ 的文档非常缺乏。但是，它似乎试图坚持使用 JDBC API。

您可以在 Oracle 站点上查看[JDBC 文档。](http://docs.oracle.com/javase/7/docs/api/java/sql/package-summary.html)

我猜将值转换为 double 相当简单：

```
sql::Connection* con;

//connection code, etc.

sql::Statement* stmt = con->createStatement();
sql::ResultSet* res = stmt->executeQuery("SELECT big_dec FROM test");

vector<double> results;

while (res->next()) 
{
    //Allow the driver to convert it to double for you.
    double res_double = res->getDouble("big_dec");
    // You can use either numeric offsets...
    cout << "num: " << res_double << endl;

    results.push_back(res_double);
} 
```

编辑：

现在您说`double`正在正确转换，但没有正确插入`vector<double>`。

循环后直接尝试以下操作：

```
for (vector<double>::iterator it = results.begin(); it != results.end(); it++)
{
    cout << *it << endl;
} 
```

编辑：

`for`循环成功打印所有内容。所以我们知道双打被`vector<double>`正确地添加了。

听起来您正在尝试复制您的`vector<double>`某个地方，但没有正确执行。

你是从函数中返回这个吗？

编辑：

问题现在解决了。问题在`vector`别处。

# ios - ios - UIViewController 不显示 UIWebView 不在 iPad 屏幕上显示，但在 iphone 上显示

> ID：12772581
> 
> 赞同：0
> 
> 时间：2012-10-07T20:25:57.877
> 
> 标签：ios, ios5

我刚刚用模拟器制作并测试了一个 UIWebView，我将它附加到一个显示 html 页面的控制器上。

但是当我对 iPad 模拟器做同样的事情时，它并没有呈现 html。

我确实将 iPad 和 iPhone 版本都连接到同一个控制器上。在控制器中，这里是我呈现 html 的方式：

```
- (void)viewDidAppear:(BOOL)animated
{  
    NSString *htmlFile = [[NSBundle mainBundle] pathForResource:@"premium" ofType:@"html"];    
    NSURL *url = [NSURL fileURLWithPath:htmlFile];
    NSURLRequest *rq = [NSURLRequest requestWithURL:url];
    [theWebView loadRequest:rq];
} 
```

那么在 iPad 上，我是否必须从情节提要拖到 .h 文件并注册另一个与 iPhone 分开的 IBOutlet UIWebView？

我感到困惑的原因是，我之前制作了一些类似这样的应用程序页面，这些页面在 iphone 和 ipad 中工作，只有一个注册的 IBOutlet UIWebView - 但我忘记了我是如何设法让它工作的:)

非常感谢任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:30:06.263

对于您在 iPhone Storyboard 中链接到 IBOutlet 的任何元素，您必须将其 iPad Storyboard 对应项链接到相同的 IBOutlet。

# parsing - haskell 很高兴 - “无法匹配预期的类型”

> ID：12772583
> 
> 赞同：1
> 
> 时间：2012-10-07T20:26:31.910
> 
> 标签：parsing, haskell, parser-generator, happy

我有一些问题要理解为 haskell 高兴的解析器生成器系统的错误消息。

例如这段代码

```
{
module Test_parser where

import System.IO
import Test_lexer

}

%name parse

%tokentype { Token }
%error { parseError }

%token

    true                { TokenTrue posn }
    false               { TokenFalse posn }
    number              { TokenInteger posn $$ }

%%

LiteralExpr :
        true            {LiteralTrue ()}
    | false         {LiteralFalse ()}
    | number        {LiteralInteger () $1}

{

data Expression n =
    LiteralTrue n
    | LiteralFalse n
    | LiteralInteger n Integer
        deriving (Eq, Show)

parseError xs = error "Parse error"

main = do 
  inStr <- getContents
  let parseTree = parse (alexScanTokens inStr)  
  putStrLn $ show(parseTree)
} 
```

工作正常。

但如果我做这样的事情

```
....

LiteralExpr :
    true            {LiteralTrue ()}
    | false         {LiteralFalse ()}
    | Inte          {$1}

Inte :
    number          {LiteralInteger () $1}

{

data Expression n =
    LiteralTrue n
    | LiteralFalse n
    | Inte n
        deriving (Eq, Show)

data Inte n =
    LiteralInteger n Integer
        deriving (Eq, Show)

.... 
```

我会收到一条巨大的错误消息。因此，如果您能帮助我理解它，那将是非常好的。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:36:37.053

似乎您在混淆数据构造函数和类型构造函数。`Inte`in是一个数据构造函数，它恰好与您在下面定义`Expression`的数据类型具有相同的名称（并且与之无关） 。`Inte`

你应该有类似的东西

```
data Expression n =
    LiteralTrue n
    | LiteralFalse n
    | LiteralInt (Inte n) 
```

并适当地修改您的代码（`LiteralInt`在需要的地方添加）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T08:15:32.180

好的，这就是它的方式：

```
...
LiteralExpr :
    true            {LiteralTrue ()}
    | false         {LiteralFalse ()}
    | Inte          {LiteralInt $1}

Inte :
    number          {LiteralInteger () $1}
... 
```

和

```
...
data Expression n =
    LiteralTrue n
    | LiteralFalse n
    | LiteralInt (Inte n)
        deriving (Eq, Show)

data Inte n =
    LiteralInteger n Integer
        deriving (Eq, Show)
... 
```

# c++ - 在 Mac OS X 上使用现代 OpenGL

> ID：12772593
> 
> 赞同：3
> 
> 时间：2012-10-07T20:27:42.047
> 
> 标签：c++, macos, opengl

有没有人幸运地启动了一个窗口。自从狮子出来以来，我一直在努力让它发挥作用。在此之前，我使用的是 linux/windows。

我过去所做的所有现代 openGL 一直在使用非官方的 glsdk，但是让它在 mac 上工作是一场噩梦。在 windows/linux 上，它只是预先制作和制作，然后你就设置好了。

现在我已经构建了 GLFW 和 glload，然后将它们包含到 Xcode 项目中（标题搜索路径）。我在构建它时收到构建错误通知，但左下角没有输出。代码主体中没有任何内容被标记为有问题。

源文件只是来自 glsdk 的 simple_glfw 文件。如果需要，我可以添加它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:11:13.090

这是我在 XCode 中创建 GLFW 项目时所做的：

*   构建 GLFW（如 GLFW 用户手册中所述）
*   使用 GLFW 示例创建了一个新的 XCode 项目（命令行工具）。
*   在构建设置中，将 /usr/local/include（或 glfw 的包含文件夹）添加到“标题搜索路径”
*   在构建阶段 -> 与库链接添加 OpenGL.framework、Cocoa.framework 和 libglfw.dylib（浏览找到这个）

我附上了一个运行小型 OpenGL 3.2 Core Profile 示例的 XCode 项目。您可能需要调整 glfw 的位置。

[https://dl.dropbox.com/u/6024335/glfwtest.zip](https://dl.dropbox.com/u/6024335/glfwtest.zip)

# haskell - 有人知道如何在 Haskell 中生成网格吗？

> ID：12772599
> 
> 赞同：1
> 
> 时间：2012-10-07T20:28:11.693
> 
> 标签：haskell

而不是像这样的二维列表：

`[[1,2],[3,4]]`

我想知道是否有任何方法可以：

```
[1, 2]
[3, 4] 
```

或者以类似的方式在行之间进行硬输入，我可以将列表中的元素称为索引 i 和 j？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T20:38:19.737

有很多方法可以做到这一点，但如果你目前正在做

```
print grid 
```

尝试将其替换为

```
mapM_ print grid 
```

分别打印每一行。

# php - 在 PHP 中为逗号分隔的字符串添加引号

> ID：12772602
> 
> 赞同：9
> 
> 时间：2012-10-07T20:29:07.790
> 
> 标签：php, string, comma, delimited, quotation-marks

我有一个表单，它是一个选择多个输入的表单，它会像这样发布值：`option1,option2,option3`等等。

如何将其转换为`'option1','option2','option3'`等的最佳方法...

目前我正在这样做，但感觉不对？？

```
$variable=explode(",", $variable);
$variable=implode("','", $variable); 
```

我这样做的原因是因为我想使用表单在使用 IN 的 SQL 查询中选择多个输入。

```
SELECT * FROM TABLE WHERE some_column IN ('$variable') 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-07T20:48:43.903

您可以将任何代码包装在一个函数中，以使“感觉不对”的感觉消失。例如：

```
function buildSqlInClauseFromCsv($csv)
{
        return "in ('" . str_replace(",", "','", $csv) . "') ";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-06-28T03:42:49.357

如果 $variable = "option1,option2,option3"

您可以使用：

“SELECT * FROM TABLE WHERE FIND_IN_SET(some_column, '$variable')”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-04T06:41:48.030

我们知道 implode 将数组转换为字符串，我们需要提供分隔符，然后数组如下所示，这里我们有 (coma ,) 作为分隔符。Implode 使用给定的分隔符打破数组的每个元素，我自负 '（单引号）与分隔符。

```
 $arr = array();
    $arr[] = "raam"; 
    $arr[] = "laxman"; 
    $arr[] = "Bharat"; 
    $arr[] = "Arjun"; 
    $arr[] = "Dhavel"; 
    var_dump($arr);

    $str = "'".implode("','", $arr)."'";
    echo $str; 
```

**输出：** 'raam'，'laxman'，'Bharat'，'Arjun'，'Dhavel'

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-07T01:30:27.087

这是我使用的：

```
WHERE  column IN ('".str_replace(",", "','", $_GET[stringlist])."') 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-07T20:57:35.100

为 SQL 转义字符串只有一种正确的方法——**使用数据库 api 提供的函数为 SQL 转义字符串**。同时`mysyl_*`提供`mysql_real_escape_string()`：

```
$choices = explode(",", $variable);

foreach($choices as &$choice)
    $choice = "'".mysql_real_escape_string($choice)."'";

$choices = implode(",", $choices); 
```

PDO 提供了一种同时添加引号的方法：

```
$choices = explode(",", $variable);

foreach($choices as &$choice)
    $choice = $pdoDb->quote($choice);

$choices = implode(",", $choices); 
```

^(请注意， PDO::prepare在这里[实际上不起作用](https://stackoverflow.com/questions/920353/php-pdo-can-i-bind-an-array-to-an-in-condition))

# c# - context.SaveChanges() 在添加时给出错误

> ID：12772603
> 
> 赞同：3
> 
> 时间：2012-10-07T20:29:13.810
> 
> 标签：c#, entity-framework, entity-framework-5

使用此代码我没有错误

```
 public static void kirisekle(string kirisadi, int genislik, int derinlik, int uzunluk, int katid)
    {
        Beam newbeam = new Beam { Kirisadi = kirisadi, Genişlik = genislik, Derinlik = derinlik, Uzunluk = uzunluk, KatID = katid };
        using (pehkEntities context = new pehkEntities())
        {

            context.Beams.Add(newbeam);
            context.SaveChanges();
        }
    } 
```

但是，使用此代码时出现“dbupdateexception 未处理”错误

```
public static void dosemeekle(string dosemeadi, int en, int boy, int kalinlik, int katid)
    {
        Slab newslab = new Slab { DosemeAdi = dosemeadi, En = en, Boy = boy, Kalınlık = kalinlik, KatID = katid };
        using (pehkEntities context = new pehkEntities())
        {

            context.Slabs.Add(newslab);
            context.SaveChanges();
        }
    } 
```

我应该如何找到这个错误的原因并修复它？

我正在使用这段代码来查看内部异常：

```
context.Slabs.Add(newslab);
        try
        {
            context.SaveChanges();
        }
        catch( System.Data.Entity.Infrastructure.DbUpdateException ex)
        {
            MessageBox.Show(ex.InnerException.Message);

        } 
```

但是，它显示一个消息框说“更新条目时发生错误。有关详细信息，请参阅内部异常。” 只要。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-07T20:37:46.903

尝试查看 SQL 中的表定义：

*   代码中是否提供了所有非空字段？

*   发生异常时超出字符串长度

*   您是否使用数据库中已经存在的主键？

如果没有连接问题，这些很可能是异常的原因。我假设是这样，因为第一种方法有效。

# scala - Scala - 带管道的 shell 命令

> ID：12772605
> 
> 赞同：5
> 
> 时间：2012-10-07T20:29:41.987
> 
> 标签：scala

我是 Scala 初学者，我正在编写一个用于调用 shell 命令的包装器。目前我正在尝试使用来自指定目录的管道调用 shell 命令。

为了实现这一点，我编写了简单的实用程序：

```
def runCommand(command: String, directory: File): (Int, String, String) = {

  val errbuffer = new StringBuffer();
  val outbuffer = new StringBuffer();

  //run the command
  val ret = sys.process.Process(command, directory) !
  //log output and err
  ProcessLogger(outbuffer append _ + "\n", outbuffer append _ + "\n");

  return (ret, outbuffer.toString(), errbuffer.toString());
} 
```

但是，使用此实用程序我不能使用管道，例如：

```
runCommand("ps -eF | grep -i foo", new File(".")); 
```

首先我认为管道是 shell 的功能，所以我尝试了“/bin/sh -c ps -eF | grep -i foo”，但似乎管道右侧的表达式被忽略了。

我还尝试使用 ! 语法（sys.process._ 包），但我不知道如何从指定目录调用命令（不使用“cd”）。

你能告诉我，如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-07T20:32:38.163

改变

```
val ret = sys.process.Process(command, directory) ! 
```

到

```
val ret = sys.process.stringSeqToProcess(Seq("/bin/bash", "-c", "cd " + directory.getAbsolutePath + ";" + command)) 
```

或者你可以直接使用 Scala 提供的魔法：

```
import.scala.sys.process._
val ret = "ps -ef" #| "grep -i foo" ! 
```

# bdd - BDD 场景是专有的吗？

> ID：12772608
> 
> 赞同：2
> 
> 时间：2012-10-07T20:29:58.070
> 
> 标签：bdd, scenarios

如果两种情况可以同时发生，那（总是/永远）是否构成第三种情况？

我目前的想法是它们不一定是排他的（取决于场景）。如果您有两个可能同时发生的场景，如果 Given/When/Then 步骤没有隐式合并或者如果一个场景优先于另一个场景，则它们只需要第三种场景。

这个问题是在考虑本质上是一种注入形式的场景时出现的，其中对象集合被注入另一个对象（[https://github.com/jameskennard/mockito-collections](https://github.com/jameskennard/mockito-collections)）。因此，给定两种情况“*被测对象类有一个协作者列表*”和“*被测对象类有一个协作者集*”。两者都可能同时发生，因此第三种情况可能是“*被测对象的类别有一个列表和一组合作者*”。但这感觉不对，太冗长了，我认为 Given/When/Then 步骤会被视为隐式合并。（有一种不好的感觉，我可能刚刚回答了我自己的问题）

有人有什么不同的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T09:39:15.057

目前，您上面的句子描述的是*状态*而不是*行为*。

在每种不同的情况下，您会得到什么不同的结果？我会期待这样的事情：

```
Given my CUT has five collaborators
When I do my thing with the class
Then it should use each collaborator in turn.

Given my CUT has five collaborators
And the fourth and fifth collaborators are identical
When I do my thing with the class
Then it should only use the fourth collaborator once. 
```

这将说明列表（有序）和集合（无重复）的不同*行为*。

如果这两个元素真正独立地有益，那么是的，它们是两个不同的场景。如果它们都必须存在才能使课程具有任何价值，我会将它们合并为一个：

```
Given my CUT has five collaborators
And the fourth and fifth collaborators are identical
When I do my thing with the class
Then it should use each collaborator in turn
And it should only use the fourth collaborator once. 
```

两个同时发生的好处的一个例子可能是从 ATM 中取出现金，其中现金被交付并且账户也被借记。你不能独立完成其中任何一个。为交易提供收据将是一个单独的好处，因为ATM*不需要*发生它就有价值。希望这有助于区分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T16:07:11.800

我认为这里的关键是行为。您询问的潜在第三种情况（*“被测对象类有一个列表和一组合作者”*）当然是真实的，但其他两种情况已经涵盖了这种行为，所以我会说没有需要写另一个场景。

如果给定的组合会导致不同的行为，那么肯定会有第三种情况，但我相信你所拥有的两种情况涵盖了你想要定义的行为。

# iphone - 创建一个 iPhone 应用 + Rails 应用 + 设计认证

> ID：12772614
> 
> 赞同：4
> 
> 时间：2012-10-07T20:31:13.733
> 
> 标签：iphone, ruby-on-rails, devise, restkit, http-authentication

我目前有一个使用 Devise 的 rails 应用程序，并且可以通过浏览器登录。我现在想创建一个使用这个 rails 应用程序作为后端的原生 iPhone 应用程序。我想要什么：

*   当用户第一次打开 iOS 应用程序时，他们会看到一个登录屏幕。
*   他们输入信息，应用程序会尝试登录。如果成功，它会列出 rails 应用程序的用户（目前）。否则会提示登录错误。
*   然后，用户可以单击用户的姓名并显示用户的个人资料等。应用程序需要能够执行所有 CRUD 操作，就好像它们在站点本身上一样。

现在我正在为 iPhone 应用程序使用 Devise 和 RestKit。我在我的 Rails 应用程序中启用了 http_auth，我可以设置用户名/密码并从我的 /users 页面获取响应（以 JSON 格式列出我的用户）。

导轨：

```
class UsersController < ApplicationController

before_filter :authenticate_user!

def index
    @users = User.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @users }
    end
end

end 
```

iPhone（使用 Restkit）：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    RKClient *client = [RKClient clientWithBaseURL:@"http://192.168.1.105:3000" username:@"xxxx" password:@"xxxx"];

    [[RKClient sharedClient] get:@"/users.json" delegate:self];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)request:(RKRequest*)request didFailLoadWithError:(NSError *)error {
    NSLog(@"error");
}

- (void)request:(RKRequest*)request didLoadResponse:(RKResponse*)response {
    NSLog(response.bodyAsString);
} 
```

我不确定从这里做什么或如何处理它。

1.  如何处理登录屏幕？好的，我可以使用 http 基本身份验证执行 'http://localhost:3000' GET 并获取用户列表，但是我应该如何测试用户的凭据是否输入正确？有什么方法可以让登录时返回 OK 或 NOT OK 响应？
2.  与 rails 应用程序交互的最佳方式是什么？可以使用 RestKit 做 GET /users/2 之类的事情吗？还是我需要构建某种 api？我不知道从哪里开始这样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T18:36:02.987

如果您有设计，为什么要使用基本的 http auth？使用设计，您可以在 json 哈希中返回身份验证错误，并将其显示在登录屏幕上。

以经典的 REST 方式构建您的应用程序，它对于 Web 客户端和移动客户端都非常舒适。

您还可以尝试使用 Rabl [https://github.com/nesquena/rabl](https://github.com/nesquena/rabl)之类的东西在 Rails 应用程序中构建智能 JSON API。

# windows - 为什么我的 Delphi 6 程序仅在少数 Windows 7 系统 (InnoSetup) 上安装时触发管理员权限请求？

> ID：12772615
> 
> 赞同：2
> 
> 时间：2012-10-07T20:31:17.930
> 
> 标签：windows, delphi, inno-setup, uac, user-permissions

我有一个 Delphi 6 程序，对于大多数用户来说，它在没有管理员权限的用户帐户下运行时安装得很好。但是，在某些系统上，它会触发对管理员权限的请求。不幸的是，我的不是其中之一，所以我很难诊断出这个问题。我使用 InnoSetup 5.1.9 来构建我的安装程序。

我怎样才能弄清楚我需要更改我的安装程序配置以消除某些人系统上对管理员权限的需求？它给我的系统带来了麻烦，因为在安装过程中，某些程序数据文件被复制到*管理员*帐户的应用程序数据文件夹中。然后，当我的程序在*用户*帐户下启动时，找不到这些文件，因为它们不在预期的*用户帐户应用程序文件夹中。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-07T20:38:35.973

这是由于默认[`PrivilegesRequired`](http://jrsoftware.org/ishelp/topic_setup_privilegesrequired.htm)指令值而发生的，即默认配置为需要管理员提升。如果您不需要这个，只需在 InnoSetup 脚本中将此指令的值显式更改为如下所示：

```
[Script]
PrivilegesRequired=lowest 
```

从参考：

> 当**PrivilegesRequired**设置为**最低**时，安装程​​序将不会请求运行管理权限，即使它是由管理员组的成员启动的。此外，卸载信息根键将始终为 HKEY_CURRENT_USER，并且 Shell 文件夹常量的“通用”形式映射到“用户”形式，即使管理权限可用。

# c# - 我的 MVC4 路由、参数、构造函数有什么问题？

> ID：12772618
> 
> 赞同：1
> 
> 时间：2012-10-07T20:31:47.417
> 
> 标签：c#, visual-studio, routes, asp.net-mvc-4, visual-studio-2012

我正在编写的一个小应用程序有问题。现在要么我的错误出现在我的控制器类中，要么出现在 Routes 中。请参阅下面的图片。

控制器类。

![这是我要执行的控制器](../Images/ffbac4a947edf1a591bcca86b71dc665.png)

这是我拥有的默认路线。

![路由配置文件](../Images/0b6c952103413a3cdc87aa0b05e0fdea.png)

这是我运行时遇到的错误。图片不是很清楚，但上面写着：

**参数字典包含“GlobalUnited.WebUI.Controllers.PlayerController”中方法“System.Web.Mvc.ActionResult Detail(Int32)”的不可空类型“System.Int32”的参数“playerId”的空条目。可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数**

![错误](../Images/05561156a7f0ea82e67f06e93e014118.png)

我在这里阅读了一些帖子，特别是： [类似链接](https://stackoverflow.com/questions/2863776/the-parameters-dictionary-contains-a-null-entry-for-parameter)

当 Daniel Renshaw 说：

**首先，我建议您使用 MVC 对参数的自动处理，而不是自己将它们从 Request 中提取出来。您的控制器操作有一个似乎被忽略的 id 参数 - 使用它并添加其他类似的参数来获取输入参数。**

无论如何，在阅读了那篇文章后，我将 RouteConfig 文件更改为：

![改变路线](../Images/94742dbaedc6f68287a84ed589f1cd4e.png)

我仍然得到这个错误。它说：

**名为“DefaultApi”的路由已在路由集合中。路由名称必须是唯一的。参数名称：名称**

![路线](../Images/0113c68bd81404d1ab0e33dd0bd49eee.png)

我什至尝试将我的 Detail 操作参数更改为：注意 int？宣言 ![方法](../Images/4b4fb7fd38a6201d6f5d916dd6cecfd6.png)

更改后出现此错误：

![在此处输入图像描述](../Images/7796c0d235f1cc66719671314a63dd8e.png)

我可以做些什么来解决这个问题，不那么复杂的东西吗？所有帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T20:38:14.277

您的参数名称 playerID 会导致此处出现问题。ASP.NET MVC 只能使用默认路由为您提供名为 id 的参数。在您的情况下，它无法将请求映射到您的操作，因为 playerID 不可为空或可选。将参数名称更改为 id 将解决问题。

```
public ActionResult Detail(int id) 
```

由于您已经有一个名为“DefaultApi”的路由，因此您会收到路由注册的第二个错误。如果您更改参数名称（也已在其他地方注册），则不需要此路由。

第三个错误是尝试使用空值进行查询。ASP.NET MVC 无法将 URL 中的值映射到您的参数，并且您获得默认值 null。由于没有具有空值的行，您会得到一个空序列，因此 Single() 方法会引发异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:43:10.403

当您的参数被调用`playerId`时，您必须将其作为路由值传递给`Detail`操作方法，然后检查它是否为空。这将解决您在问题中显示的最后一个错误：*Sequence contains no element*。

在 action 方法中执行此操作：

```
public ActionResult Detail(int? playerId)
{
   if(playerId.HasValue)
   {
       var model = _dataSource.Players.Single(p => p.PlayerId == playerId);

       return View(model);
   }

   // Handle the other possibility where playerId is NULL
} 
```

要让 ASP.NET MVC 知道如何进行正确的参数绑定，您必须以这种方式调用上述操作方法，例如：

```
@Html.ActionLink("Player Details", "Detail", new { playerId = 1 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T21:10:15.270

除了重复路由错误之外，您的错误与 DefaultApi 路由无关。您会得到一个重复的路由，因为该路由是在 App_Start\WebApiConfig.cs 中配置的

您的第一个问题是您告诉 MVC 您有一个名为 playerId 的强制性 Route 参数，但您没有在您使用的 URL 中提供此路由参数。为了使其工作，您需要更改路线以将 id 更改为 playerId，或将 playerId 查询字符串参数添加到您的 url。如果您更改路线，则需要一个类似`http://my.site/Player/Detail/1`（如果您更改路线）或`http://my.site/Player/Detail?playerId=1`.

另一种选择是更改参数，`public ActionResult Detail(int id)`然后将使用现有的默认路由，该路由采用一个名为 id 的参数，并从以`/1`.

您也可以使用该方法`Detail(int? id)`，但是您需要在您的 linq 查询周围放置一个空保护（因为如果您没有在 URL 上传递 ID，它就无法查找空记录）所以您必须添加这个：

```
if (id.HasValue) {
    // execute linq query
} 
```

或者，您可以将查询更改为 return`SingleOrDefault()`而不是`Single()`.

# ruby-on-rails - Rails 在登录时设计了成功的路线

> ID：12772623
> 
> 赞同：1
> 
> 时间：2012-10-07T20:32:09.887
> 
> 标签：ruby-on-rails, devise, controller, routes

在使用设计成功登录后，我仍然不明白如何路由到用户个人资料页面。我已经阅读了其他问题，谷歌搜索并浏览了设计文档，但我仍然无法让它工作/理解。

在我的路线中

```
 get '/:id', to: 'profiles#show' 
```

我只希望该页面（用户 id 为 myapp.com/profilename）成为用户在登录时被重定向到的页面。我认为这将是一个快速修复，但我在这方面花费了过多的时间问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:48:23.730

您可以使用设计路线助手：

```
authenticated :user do
  root :to => "profiles#show"
end 
```

然后，您将使用`current_user`而不是`params[:id]`来确定要显示的配置文件。

# python - 使用 simplejson 在 Python 中从 Twitter 解码 JSON 文件

> ID：12772626
> 
> 赞同：2
> 
> 时间：2012-10-07T20:32:25.537
> 
> 标签：python, json, twitter

我的 JSON 文件的一小部分如下所示。它通过了一个 JSON 验证器。（我添加了 cl

```
{
"next_page": "?page=2&max_id=210389654296469504&q=cocaine&geocode=40.665572%2C-73.923557%2C10mi&rpp=100",
"completed_in": 0.289,
"max_id_str": "210389654296469504",
"since_id_str": "0",
"refresh_url": "?since_id=210389654296469504&q=cocaine&geocode=40.665572%2C-73.923557%2C10mi",
"results": [
    {
        "iso_language_code": "en",
        "to_user_id": 486935435,
        "to_user_id_str": "486935435",
        "profile_image_url_https": "https://si0.twimg.com/profile_images/1561856049/Zak_W_Photo_normal.jpg",
        "from_user_id_str": "82389940",
        "text": "@Bill__Murray cocaine &gt; productivity! Last night I solved the euro crisis and designed a new cat. If I could only find that napkin.",
        "from_user_name": "Zak Williams",
        "in_reply_to_status_id_str": "210319741322133504",
        "profile_image_url": "http://a0.twimg.com/profile_images/1561856049/Zak_W_Photo_normal.jpg",
        "id": 210389654296469500,
        "to_user": "Bill__Murray",
        "source": "&lt;a href=&quot;http://twitter.com/#!/download/iphone&quot; rel=&quot;nofollow&quot;&gt;Twitter for iPhone&lt;/a&gt;",
        "in_reply_to_status_id": 210319741322133500,
        "to_user_name": "Bill Murray",
        "location": "Brooklyn",
        "from_user": "zakwilliams",
        "from_user_id": 82389940,
        "metadata": {
            "result_type": "recent"
        },
        "geo": "null",
        "created_at": "Wed, 06 Jun 2012 15:16:17 +0000",
        "id_str": "210389654296469504"
    }
]
} 
```

当我尝试通过键入以下代码在 Python 中加载它时，我收到以下错误。

**代码**

```
 import simplejson as json
 testname = 'test.txt'
 record = json.loads(testname) 
```

**错误**

```
 raise JSONDecodeError("No JSON object could be decoded", s, idx)
 simplejson.decoder.JSONDecodeError: No JSON object could be decoded: line 1 column 0 (char 0) 
```

我究竟做错了什么？实际上，我通过使用生成了文件`simplejson.dump`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:34:44.230

该函数从*string*`json.loads()`加载 JSON 数据，而您只是给它一个文件名。该字符串不是有效的 JSON 字符串。尝试以下方法从文件加载 JSON 数据：*`test.txt`*

 *```
with open(testname) as f:
    record = json.load(f) 
```

（如果您使用的是不支持该`with`语句的旧版本的 Python（如您使用 old 可能表明的那样`simplejson`），那么您必须自己打开和关闭文件。）*

# python - Python：确定作为函数参数传递的列表中的元素数量

> ID：12772635
> 
> 赞同：0
> 
> 时间：2012-10-07T20:33:48.383
> 
> 标签：python, testing

我有一些功能`foo(list)`

我想

```
assert foo(list with one element) == that one element

assert foo(list with 100 elements) == foo(list) 
```

在不知道列表本身是什么的情况下，最好只使用断言语句，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:38:16.477

```
if len(x) == 1:
    assert foo(x) == x[0]
elif len(x) == 100:
    assert foo(x) == x 
```

或者，如果您希望确定`foo`的返回值始终具有上述属性，您可以这样做：

```
def foo(x):
    # compute return value `retval` based on `x`
    if len(x) == 1:
        assert retval == x[0]
    elif len(x) == 100:
        assert retval == x
    return retval 
```

# linux - 如何使用导入的库获取关联的函数名称

> ID：12772638
> 
> 赞同：3
> 
> 时间：2012-10-07T20:34:00.963
> 
> 标签：linux, elf

如果我有一个 ELF 文件，如何获取从库文件“.so”导入的每个函数，显示与该函数关联的共享库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:07:02.347

这对我很有效：

```
nm -uC test 
```

例如，在我刚刚写的[这个其他答案的代码上：](https://stackoverflow.com/a/12772722/85371)

```
g++ -O0 -I ~/custom/boost/ test.cpp -o test 
nm -uC test 
```

输出是

```
 w _Jv_RegisterClasses
 U _Unwind_Resume@@GCC_3.0
 U std::string::compare(std::string const&) const@@GLIBCXX_3.4
 U std::allocator<char>::allocator()@@GLIBCXX_3.4
 U std::allocator<char>::~allocator()@@GLIBCXX_3.4
 U std::ostream::operator<<(std::ostream& (*)(std::ostream&))@@GLIBCXX_3.4
 U std::ostream::operator<<(int)@@GLIBCXX_3.4
 U std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&)@@GLIBCXX_3.4
 U std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(std::string const&)@@GLIBCXX_3.4
 U std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string()@@GLIBCXX_3.4
 U std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()@@GLIBCXX_3.4
 U std::ios_base::Init::Init()@@GLIBCXX_3.4
 U std::ios_base::Init::~Init()@@GLIBCXX_3.4
 U std::__throw_bad_alloc()@@GLIBCXX_3.4
 U std::_Rb_tree_decrement(std::_Rb_tree_node_base const*)@@GLIBCXX_3.4
 U std::_Rb_tree_decrement(std::_Rb_tree_node_base*)@@GLIBCXX_3.4
 U std::_Rb_tree_increment(std::_Rb_tree_node_base const*)@@GLIBCXX_3.4
 U std::_Rb_tree_increment(std::_Rb_tree_node_base*)@@GLIBCXX_3.4
 U std::_Rb_tree_insert_and_rebalance(bool, std::_Rb_tree_node_base*, std::_Rb_tree_node_base*, std::_Rb_tree_node_base&)@@GLIBCXX_3.4
 U std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&)@@GLIBCXX_3.4
 U std::basic_ostream<char, std::char_traits<char> >& std::operator<< <char, std::char_traits<char>, std::allocator<char> >(std::basic_ostream<char, std::char_traits<char> >&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)@@GLIBCXX_3.4
 U operator delete(void*)@@GLIBCXX_3.4
 U operator new(unsigned long)@@GLIBCXX_3.4
 U __cxa_atexit@@GLIBC_2.2.5
 U __cxa_begin_catch@@CXXABI_1.3
 U __cxa_end_catch@@CXXABI_1.3
 U __cxa_rethrow@@CXXABI_1.3
 w __gmon_start__
 U __gxx_personality_v0@@CXXABI_1.3
 U __libc_start_main@@GLIBC_2.2.5
 U memmove@@GLIBC_2.2.5
 w pthread_cancel 
```

我有点意识到这并没有说明哪个共享对象应该满足依赖关系的缺陷，但我想`nm`这些库的输出上的一点连接应该会让你走很长一段路。

*删除`-C`标志以防止名称拆解。如果您打算对数据进行交叉引用，这可能非常有效。如果`c++filt`您想以用户友好的方式显示名称，请稍后用于对名称进行解码*

# python - 设置 GAE Web App Handler 函数的 Trace

> ID：12772639
> 
> 赞同：1
> 
> 时间：2012-10-07T20:34:16.493
> 
> 标签：python, google-app-engine

我习惯于使用以下范例来设置和结束 python 函数的跟踪：

```
sys.settrace(traceFunction)
someFunction()
sys.settrace(None) 
```

如果 someFunction() 是在通过 google 应用程序引擎生成 Web 应用程序的处理程序中定义的函数（例如 post()），则此模型似乎失败。因为所述函数从未在代码中具体实例化，所以我不确定如何在其上设置跟踪。谁能告诉我在这种情况下可以达到与上述模型相同结果的方法吗？

# c - 错误：预期标识符或 '(' 在 'TOKEN' 之前

> ID：12772644
> 
> 赞同：-3
> 
> 时间：2012-10-07T20:34:45.143
> 
> 标签：c

基本上这是一个程序，我获取一个带有一些代码的文本文件，并获取每个字符并将其设为令牌或使包含在其中的其他字符成为像变量一样的令牌。我知道那部分有效，因为我已将此代码用于另一个项目，而我只是在重用。问题是当我试图获取scanner.c创建的令牌并将其返回到另一个文件时，它说我有一个错误“错误：预期的标识符或'（'在'TOKEN'之前”。我不知道在哪里错误是 这是我的scanner.c 文件，我还发布了定义令牌的.h 文件。

```
#include <stdio.h>
#include <string.h>
#include "parser.h"

*TOKEN parseString(char *token);
*TOKEN parseChar(char token);

*TOKEN scan(FILE *input_file)
{    
   int stateTable[3][122];
   int i = 0;
   int j = 0;
   for( i=0; i < 3; i++)//init to 0
   {
      for ( j=0; j < 122; j++)
      {
         stateTable[i][j] = 0;
      }
   }

   for( i=48; i < 57; i++)//all numbers [0-9]
   {
      stateTable[1][i] = 3;
      stateTable[3][i] = 3;
   }

   for( i=97; i < 122; i++)//all alpha [a-z]
   {
      stateTable[1][i] = 2;
      stateTable[2][i] = 2;
   }

   stateTable[1][10] = 1;// \n
   stateTable[1][32] = 1;// space
   stateTable[1][40] = 1;// (
   stateTable[1][41] = 1;// )
   stateTable[1][42] = 1;// *
   stateTable[1][43] = 1;// +
   stateTable[1][45] = 1;// -
   stateTable[1][47] = 1;// /
   stateTable[1][59] = 1;// ;
   stateTable[1][61] = 1;// =

   int state = 0;
   int index = 0;
   char temp[20];
   char token;

      token = fgetc(input_file);
      state = stateTable[1][(int) token];

      if (state == 2 || state == 3)//num or alpha
      {
         temp[index] = token;
         index++;
          scan(input_file);
      }
      else if (state = 1)
      { 
            if (index >= 1)//digit or identifier
            {
                temp[index] = '\0';
                return parseString(&temp[0]);
                temp[0] = '\0';
            }   
            else
               return parseChar(token);

            if(token == ';' ||token == ')')
                return parseChar(token);

            index = 0;
      }

}

*TOKEN parseString(char *token)
{
    TOKEN *temp = malloc(sizeof(TOKEN));
    if(strcmp("repeat",token) == 0)
        &temp.type = 4;
    else if(strcmp("print",token) == 0)
        &temp.type = 5;
    else if(isdigit(token[0]))
    {
        &temp.type = 12;
        &temp.attribute = token[0];
    }
    else if(strcmp(token, "") != 0)
    {
        &temp.type = 10;
        &temp.attribute = token;
    }

    return temp;
}

*TOKEN parseChar(char token)
{   
    TOKEN *temp = malloc(sizeof(TOKEN));
    if(token == '+' || token == '-')
    {
        &temp.type = 14;
        &temp.attribute = token;

    }
    else if(token == '/' || token == '*' || token == '%')
    {
        &temp.type = 13;
        &temp.attribute = token;
    }
    else if(token == '=')
        &temp.type = 3;
    else if(token == ';')
        &temp.type = 17;
    else if(token == '(')
        &temp.type = 15;
    else if(token ==')')
        &temp.type = 16;

    return temp;

} 
```

这是其中描述了 TOKEN 的 parser.h 文件。

```
#ifndef _parser_h
#define _parser_h

typedef enum token_type
{
    Id,
    keyword,
    num,
    addOp,
    multOp,
    assignment,
    semicolon,
    lparen,
    rparen

}TOKEN_TYPE;

typedef struct token{
    TOKEN_TYPE type;
    char* attribute;
}TOKEN;

typedef enum node_type
{
    PROGRAM,
    statement,
    assignStmt,
    repeatStmt,
    printStmt,
    exp,
    term,
    factor
}NODE_TYPE;

#endif 
```

它只是一直说我在哪里声明了我在 TOKEN 之前缺少一个 '(' 的函数名。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:38:35.277

应该是 TOKEN* parseChar(char token) 而不是 *TOKEN parseChar(char token)

和 temp->type = 4; 而不是 &temp.type = 4;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:43:44.897

如前所述：应该是`TOKEN*`。

但是您还必须解决其他一些问题。

```
TOKEN *temp ; 
```

`temp->type`或`(*temp).type`代替`(&temp).type`

# underscore.js - 使用 .countBy 汇总数据

> ID：12772645
> 
> 赞同：7
> 
> 时间：2012-10-07T20:34:45.947
> 
> 标签：underscore.js

我试图弄清楚如何使用[UnderscoreJS](http://underscorejs.org/)[`_.countBy()`](http://underscorejs.org/#countBy)中的方法总结以下数据。我有以下数据：

```
var data =
[
    {"id":"338b79f07dfe8b3877b3aa41a5bb8a58","value":{"country":"United States"}},
    {"id":"338b79f07dfe8b3877b3aa41a5bb983e","value":{"country":"Norway"}},
    {"id":"338b79f07dfe8b3877b3aa41a5ddfefe","value":{"country":"Hungary"}},
    {"id":"338b79f07dfe8b3877b3aa41a5fe29d7","value":{"country":"United States"}},
    {"id":"b6ed02fb38d6506d7371c419751e8a14","value":{"country":"Germany"}},
    {"id":"b6ed02fb38d6506d7371c419753e20b6","value":{"country":"Hungary"}},
    {"id":"b6ed02fb38d6506d7371c419755f34ad","value":{"country":"United States"}},
    {"id":"b6ed02fb38d6506d7371c419755f3e17","value":{"country":"Germany"}},
    {"id":"338b79f07dfe8b3877b3aa41a506082f","value":{"country":"United Kingdom"}},
    {"id":"9366afb036bf8b63c9f45379bbe29509","value":{"country":"United Kingdom"}}
] 
```

我想这样总结：

```
{ 
    United_States: 3,
    Norway: 1,
    Hungary: 2,
    Germany: 2,
    United_Kingdom: 2
} 
```

我如何将它传递`_.countBy()`给 Underscore.js 提供的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-07T20:46:58.580

试试这个：

```
var data =
[
    {"id":"338b79f07dfe8b3877b3aa41a5bb8a58","value":{"country":"United States"}},
    {"id":"338b79f07dfe8b3877b3aa41a5bb983e","value":{"country":"Norway"}},
    {"id":"338b79f07dfe8b3877b3aa41a5ddfefe","value":{"country":"Hungary"}},
    {"id":"338b79f07dfe8b3877b3aa41a5fe29d7","value":{"country":"United States"}},
    {"id":"b6ed02fb38d6506d7371c419751e8a14","value":{"country":"Germany"}},
    {"id":"b6ed02fb38d6506d7371c419753e20b6","value":{"country":"Hungary"}},
    {"id":"b6ed02fb38d6506d7371c419755f34ad","value":{"country":"United States"}},
    {"id":"b6ed02fb38d6506d7371c419755f3e17","value":{"country":"Germany"}},
    {"id":"338b79f07dfe8b3877b3aa41a506082f","value":{"country":"United Kingdom"}},
    {"id":"9366afb036bf8b63c9f45379bbe29509","value":{"country":"United Kingdom"}}
];

var countData = _.countBy(data, function(obj){
    return obj.value.country.replace(" ", "_");
}); 

console.log(countData); 
```

JSFiddle：http: [//jsfiddle.net/hyDv7/1/](http://jsfiddle.net/hyDv7/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-03T02:32:33.657

“干净的js”：

```
var t = {};
for(var i = 0, l = data.length; i < l; i++){
    t[data[i].value.country] = !t[data[i].value.country] ? 1 : t[data[i].value.country] + 1;
} 
```

结果：

```
Germany 2
Hungary 2
Norway 1
United Kingdom 2
United States 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-04T11:26:32.000

1 班轮使用[减少](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)

```
var countData = data.reduce(function (a, x) {a[x.country] = (a[x.country] ? a[x.country] : 0) + 1; return a;}, {}); 
```

# jquery - JQuery动画滚动到div的顶部

> ID：12772648
> 
> 赞同：4
> 
> 时间：2012-10-07T20:35:11.253
> 
> 标签：jquery, jquery-animate

我有一个隐藏的 div，.model-detail-panel 在单击 .span 时会显示出来。

```
$('[class*="span"]').on('click', function () {
        $(this).parent().next('.model-detail-panel').slideToggle()
    }); 
```

我想将 .animate() 合并到此代码中以滚动屏幕，以便显示的 div 的顶部位于窗口的顶部。

我怎样才能做到这一点？

提前致谢..

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-07T20:44:05.407

您可以使用[Position](http://api.jquery.com/position/)，如下所示：

```
$("body, html").animate({
    scrollTop: $(".model-detail-panel").position().top
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T09:25:24.850

将@michele-bertoli 建议的代码稍微更改为

```
$('html, body').animate({scrollTop: $(".model-detail-panel").offset().top
            }, 500); 
```

已经为我工作了..

感谢发帖的人。。

# spotify - 最新的曲目没有在嵌入式 Spotify 播放列表中排在首位？

> ID：12772655
> 
> 赞同：1
> 
> 时间：2012-10-07T20:36:04.433
> 
> 标签：spotify, playlist

当我嵌入 Spotify 播放列表时，最旧的曲目会排在最前面。有什么办法可以让最新的曲目排在首位吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:56:13.223

好吧，播放按钮（我假设您正在使用）按播放列表的顺序显示播放列表 - 如果用户手动将曲目拖到顶部，它们将位于顶部。

这里的问题是，默认情况下，Spotify 客户端会将新曲目添加到播放列表的末尾。改变这一点需要改变 Spotify 客户端，这显然超出了这个问题的范围。

# c++ - pthreads 中的内存模型规范

> ID：12772656
> 
> 赞同：4
> 
> 时间：2012-10-07T20:36:10.430
> 
> 标签：c++, c, multithreading, pthreads, shared-memory

是否可以保证一个线程中的内存写入何时在使用`pthread`s 的其他线程中变得可见？

与 Java 相比，Java 语言规范有一个[部分指定锁和内存的交互，](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4)这使得编写可移植的多线程 Java 代码成为可能。

是否有相应的 pthreads 规范？

当然，你总是可以让共享数据变得易变，但这不是我想要的。

如果这取决于平台，是否有事实上的标准？还是应该使用另一个线程库？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-07T23:46:27.310

POSIX 在[4.11 Memory Synchronization](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_11)中指定了内存模型：

> 应用程序应确保多个控制线程（线程或进程）对任何内存位置的访问受到限制，以便没有控制线程可以读取或修改内存位置，而另一个控制线程可能正在修改它。使用同步线程执行以及相对于其他线程同步内存的函数来限制此类访问。以下函数相对于其他线程同步内存：
> 
> *   叉（）
> *   pthread_barrier_wait()
> *   pthread_cond_broadcast()
> *   pthread_cond_signal()
> *   pthread_cond_timedwait()
> *   pthread_cond_wait()
> *   pthread_create()
> *   pthread_join()
> *   pthread_mutex_lock()
> *   pthread_mutex_timedlock()
> *   pthread_mutex_trylock()
> *   pthread_mutex_unlock()
> *   pthread_spin_lock()
> *   pthread_spin_trylock()
> *   pthread_spin_unlock()
> *   pthread_rwlock_rdlock()
> *   pthread_rwlock_timedrdlock()
> *   pthread_rwlock_timedwrlock()
> *   pthread_rwlock_tryrdlock()
> *   pthread_rwlock_trywrlock()
> *   pthread_rwlock_unlock()
> *   pthread_rwlock_wrlock()
> *   sem_post()
> *   sem_timedwait()
> *   sem_trywait()
> *   sem_wait()
> *   semctl()
> *   semop()
> *   等待（）
> *   等待进程（）
> 
> pthread_once() 函数应为给定 pthread_once_t 对象的每个线程中的第一次调用同步内存。
> 
> 如果互斥锁类型为 PTHREAD_MUTEX_RECURSIVE 并且调用线程已经拥有互斥锁，则 pthread_mutex_lock() 函数不需要同步内存。如果互斥锁类型为 PTHREAD_MUTEX_RECURSIVE 并且互斥锁的锁计数大于 1，则 pthread_mutex_unlock() 函数不需要同步内存。
> 
> 除非另有明确说明，否则如果上述函数之一返回错误，则未指定调用是否导致内存同步。
> 
> 应用程序可能允许多个控制线程同时读取一个内存位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:54:43.417

我不知道 POSIX 线程提供了这样的保证。他们没有对线程共享对象进行原子访问的模型。如果是针对 POSIX 线程，唯一可以保证修改可见性的是使用某种锁。

现代 C、C11（可能还有 C++11）有一个模型来解决这类问题。当您假设一个线程所做的修改对另一个线程可见时，它具有线程和原子（栅栏和所有这些东西）为您提供确切的规则。

C11 的线程接口是 POSIX 线程的简化版本，功能较少。不幸的是，该线程接口的语义规范还很松散，基本上很多地方都缺少语义。但是 C11 接口和 POSIX 线程语义的组合可以让您很好地了解现代系统中的工作方式。

*编辑：*因此，如果您想保证内存同步，请使用 POSIX 提供的锁接口或进行原子操作。所有现代编译器都有提供这些的扩展，gcc 和家族（icc、opencc、clang）有例如一系列内置函数`__sync...`。Clang 它的最新版本也已经支持新的 C11`_Atomic`功能。还有一些可用的包装器为您提供接近`_Atomic`.

# python - 在没有 root 访问权限的情况下安装 nltk

> ID：12772658
> 
> 赞同：3
> 
> 时间：2012-10-07T20:36:18.213
> 
> 标签：python, nlp, nltk

我遇到了[这个](https://stackoverflow.com/questions/12166819/use-nltk-without-installing)页面，回答者建议我可以在没有root访问权限的机器上使用nltk。我正在尝试遵循那里的建议，但我做错了。

[我从这里](http://pypi.python.org/pypi/setuptools)下载了源代码（名为 setuptools-0.6c11.tar.gz 的文件），然后将其解压缩到名为 nltk 的文件夹中。

现在从该链接上的第三个答案，我应该能够通过从提取内容的一个文件夹中运行 Python 来导入 nltk 对吗？

所以我尝试从以下目录运行python，然后导入nltk：

```
~/nltk/
~/nltk/setuptools/
~/nltk/setuptools.egg-info/
~/nltk/setuptools/command/
~/nltk/setuptools/tests/ 
```

但我无法从任何地方导入模块。我是 Python 菜鸟。谁能告诉我我做错了什么？

我实际上需要将 nltk 用于大学项目，并且我没有访问这些项目将在其上运行的大学计算机的 root 访问权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:51:38.830

首先，从您的问题来看，您似乎正在尝试解压缩*setuptools*并从中导入*nltk*。这是两个完全不同的项目。

其次，如果您想轻松地从源代码构建 nltk 并以普通用户身份运行它，您可能希望从使用[virtualenv](http://pypi.python.org/pypi/virtualenv)开始。在 debian 上，您可以使用`apt-get install python-virtualenv`.

安装 virtualenv 后，您可以执行以下操作

```
virtualenv nltk_env --system-site-packages 
```

创建一个部分隔离的环境，您可以在其中安装 nltk 而不会弄乱您的系统安装。然后就做

```
source nltk_env/bin/activate
pip install nltk
python
>>> import nltk 
```

并且您已成功导入本地 nltk 安装。

还有其他选项可以在本地安装而不使用 virtualenv，例如`pip install --user nltk`，但如果您不知道自己在做什么，它们可能会更加混乱。

# ruby-on-rails - 在 rails 3.2.8 中将自定义类定义放在 /app 下是否有意义？

> ID：12772662
> 
> 赞同：0
> 
> 时间：2012-10-07T20:36:56.310
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我们想在我们的 rails 3.2.8 应用程序中为用户权限定义一个类。每当应用程序访问数据库以确定用户是否具有访问权限时，都会调用此权限类。如果我们为用户权限类创建一个新的子目录如sys_class下`/app`，是否有意义？或者最好在 application.rb 下创建 sys_class`/lib`并包含`config.autoload_paths += %W(#{config.root}/lib/sys_class)`在 application.rb 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T23:35:48.793

扩展 Fernando 的回答——允许哪些用户在您的应用程序中执行哪些操作是业务逻辑的一部分，这意味着它确实是您的模型的一部分。所以这个类应该放在下面的某个地方`app/models`。如果您出于某种原因想将其与其他模型对象分开，您可以将其放在该子目录中。

应用程序中的模型对象不必直接映射到数据库表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:51:30.043

在 CanCan 中，这个类被命名为 Ability 并在 app/models 中创建

[https://github.com/ryanb/cancan/#1-define-abilities](https://github.com/ryanb/cancan/#1-define-abilities)

# iphone - 调用函数“didUpdateToLocation”而不进行更改

> ID：12772672
> 
> 赞同：1
> 
> 时间：2012-10-07T20:38:12.090
> 
> 标签：iphone, ios, location, mkmapview, cllocationmanager

我以这种方式初始化 locationManager：

```
if (!self.locManager) 
{
    self.locManager = [[CLLocationManager alloc] init];
    self.locManager.delegate = self;
    [locManager startMonitoringSignificantLocationChanges];
} 
```

我的设备没有移动，并且每次仍然调用“didUpdateToLocation”。可能是什么问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T21:28:21.347

`didUpdateToLocation`由于多种原因可能会更新，处理此问题的一个好策略是根据时间戳逐渐过滤结果，然后要求准确性。

Apple 在[LocateMe 示例应用程序](http://developer.apple.com/library/ios/#samplecode/LocateMe/Listings/Classes_GetLocationViewController_m.html#//apple_ref/doc/uid/DTS40007801-Classes_GetLocationViewController_m-DontLinkElementID_8)中提供了一个很好的示例：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    // test the age of the location measurement to determine if the measurement is cached
    // in most cases you will not want to rely on cached measurements
    NSTimeInterval locationAge = -[newLocation.timestamp timeIntervalSinceNow];
    if (locationAge > 5.0) return;

    // test that the horizontal accuracy does not indicate an invalid measurement
    if (newLocation.horizontalAccuracy < 0) return;

    // test the measurement to see if it is more accurate than the previous measurement
    if (self.bestEffortAtLocation == nil || self.bestEffortAtLocation.horizontalAccuracy > newLocation.horizontalAccuracy)
    {
        // store the location as the "best effort"
        self.bestEffortAtLocation = newLocation;

        // test the measurement to see if it meets the desired accuracy
        //
        // IMPORTANT!!! kCLLocationAccuracyBest should not be used for comparison with location coordinate or altitidue 
        // accuracy because it is a negative value. Instead, compare against some predetermined "real" measure of 
        // acceptable accuracy, or depend on the timeout to stop updating. This sample depends on the timeout.
        //
        if (newLocation.horizontalAccuracy <= locationManager.desiredAccuracy) {
            // we have a measurement that meets our requirements, so we can stop updating the location
            // 
            // IMPORTANT!!! Minimize power usage by stopping the location manager as soon as possible.
            //
            [self stopUpdatingLocation:NSLocalizedString(@"Acquired Location", @"Acquired Location")];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:42:38.843

你检查位置差异吗？当其他属性（如准确性、航向或速度）发生变化时，CoreLocation 也会调用回调

`startMonitoringSignificantLocationChanges`应该给你一个初步的修复，然后你会得到“重大变化”的回调（蜂窝塔变化等）

# regex - 正则表达式不匹配

> ID：12772683
> 
> 赞同：1
> 
> 时间：2012-10-07T20:40:20.620
> 
> 标签：regex

我有以下正则表达式：

```
"\[(\d+)\].?\s+(\S+)\s+(\/+?)\\r\n" 
```

我对正则表达式很陌生。我有这个正则表达式和一个字符串，我想看看它是否匹配。我相信它应该匹配它，但我的程序说它不匹配，并且在线分析器说它们不匹配。我很确定我错过了一些小东西。这是我的字符串：

```
[1]+ Stopped    sleep 60 
```

但是，当使用这个在线工具检查匹配时（我的程序说它们不相等），为什么下面的表达式与上面的正则表达式不匹配？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:45:42.687

您似乎在 \r 之前逃脱了 \ 导致它搜索字母 r

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T20:44:10.353

尝试使用这种模式：

```
\[\d+\]\+\s*\w+\s*\w+\s*\d+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T21:22:47.470

RegExp 解释和允许的字符随实现而略有不同，因此您应该提供执行上下文，但这可能足够通用。

分解你的正则表达式给出

```
\[     - an open bracket character. 
(\d+)  - one or more digits; save this as capture group 1 ($1).
\]     - a close bracket character.
.?     - 0 or 1 character, of any kind
\s+    - 1 or more spaces.
(\S+)  - 1 or more non-space characters; save this as $2
\s+    - 1 or more spaces
(\/+?) - 1 or more forward-slash characters, optional as $3
         (not sure about this, this is an odd construct)
\\r\n" - an (incorrectly specified) end of line sequence, I think. 
```

首先，如果要匹配行尾，请使用$，而不是\r\n。在大多数情况下，这应该与行尾相匹配。^ 匹配一行的开头。

其次，我无法从您的正则表达式中看出您在“已停止”一词之后要捕获的内容，所以我假设您希望将其余部分作为一个块，包括内部空间。一个与你基本相同的正则表达式就可以了。

```
"\[(\d+)\].?\s+(\S+)\s+(.+)\s*$" 
```

这捕获

```
$1 = 1,
$2 = Stopped
$3 = sleep 60 
```

除了结尾之外，这与您的基本相同，它在“停止”之后将所有内容作为单个捕获组抓取到行尾，$3，除了前导和尾随空白。如果要进行其他解析，请根据需要替换 (.+)。请注意，“停止”之后必须至少有 1 个非空白字符才能匹配。如果即使没有字符串 $3 也希望它匹配，请使用`\s*(.*)\s*$`而不是`\s+(.+)\s*$`

# c - 如何将Mac字符串转换为C中的字节地址

> ID：12772685
> 
> 赞同：13
> 
> 时间：2012-10-07T20:40:30.793
> 
> 标签：c

我想从命令行获取 MAC 地址，所以我把它作为字符串......我如何将这个 17 字节 MAC 字符串（如“00:0d:3f:cd:02:5f”）转换为 C 中的 6 字节 MAC 地址

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-07T20:44:08.690

在符合 C99 的实现上，这应该有效

```
unsigned char mac[6];

sscanf(macStr, "%hhx:%hhx:%hhx:%hhx:%hhx:%hhx", &mac[0], &mac[1], &mac[2], &mac[3], &mac[4], &mac[5]); 
```

否则，您将需要：

```
unsigned int iMac[6];
unsigned char mac[6];
int i;

sscanf(macStr, "%x:%x:%x:%x:%x:%x", &iMac[0], &iMac[1], &iMac[2], &iMac[3], &iMac[4], &iMac[5]);
for(i=0;i<6;i++)
    mac[i] = (unsigned char)iMac[i]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-23T13:27:13.650

没有内置函数和简单的错误处理：

```
unsigned char mac[6];
for( uint idx = 0; idx < sizeof(mac)/sizeof(mac[0]); ++idx )
{
    mac[idx]  = hex_digit( mac_str[     3 * idx ] ) << 4;
    mac[idx] |= hex_digit( mac_str[ 1 + 3 * idx ] );
} 
```

输入实际上是 3*6 字节，带有`\0`.

```
unsigned char hex_digit( char ch )
{
    if(             ( '0' <= ch ) && ( ch <= '9' ) ) { ch -= '0'; }
    else
    {
        if(         ( 'a' <= ch ) && ( ch <= 'f' ) ) { ch += 10 - 'a'; }
        else
        {
            if(     ( 'A' <= ch ) && ( ch <= 'F' ) ) { ch += 10 - 'A'; }
            else                                     { ch = 16; }
        }
    }
    return ch;
} 
```

# python - django - 加载 MySQLdb 模块时出错：没有名为 MySQLdb 的模块

> ID：12772687
> 
> 赞同：4
> 
> 时间：2012-10-07T20:40:56.150
> 
> 标签：python, django, mysql-python

我在 Win7 上使用 Django 1.4.1 和 Active Python 2.7。我已经使用`pypm install mysql-python`.

数据库引擎是`django.db.backends.mysql`.

**`import MySQLdb`在交互式外壳中工作。**

**`.\manage.py syncdb`创建表没有问题。**

**但是，当我在浏览器中打开该站点时，我得到`Error loading MySQLdb module: No module named MySQLdb`**：

```
Environment:

Request Method: GET
Request URL: http://whatever/

Django Version: 1.4.1
Python Version: 2.7.2
Installed Applications:
('django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "C:\Python27\lib\site-packages\django\core\handlers\base.py" in get_response
  89\.                     response = middleware_method(request)
File "C:\Python27\lib\site-packages\django\contrib\sessions\middleware.py" in process_request
  10\.         engine = import_module(settings.SESSION_ENGINE)
File "C:\Python27\lib\site-packages\django\utils\importlib.py" in import_module
  35\.     __import__(name)
File "C:\Python27\lib\site-packages\django\contrib\sessions\backends\cached_db.py" in <module>
  6\. from django.contrib.sessions.backends.db import SessionStore as DBStore
File "C:\Python27\lib\site-packages\django\contrib\sessions\backends\db.py" in <module>
  3\. from django.db import IntegrityError, transaction, router
File "C:\Python27\lib\site-packages\django\db\__init__.py" in <module>
  40\. backend = load_backend(connection.settings_dict['ENGINE'])
File "C:\Python27\lib\site-packages\django\db\__init__.py" in __getattr__
  34\.         return getattr(connections[DEFAULT_DB_ALIAS], item)
File "C:\Python27\lib\site-packages\django\db\utils.py" in __getitem__
  92\.         backend = load_backend(db['ENGINE'])
File "C:\Python27\lib\site-packages\django\db\utils.py" in load_backend
  24\.         return import_module('.base', backend_name)
File "C:\Python27\lib\site-packages\django\utils\importlib.py" in import_module
  35\.     __import__(name)
File "C:\Python27\lib\site-packages\django\db\backends\mysql\base.py" in <module>
  16\.     raise ImproperlyConfigured("Error loading MySQLdb module: %s" % e)

Exception Type: ImproperlyConfigured at /
Exception Value: Error loading MySQLdb module: No module named MySQLdb 
```

会话和消息应用程序的设置是：

```
SESSION_ENGINE = "django.contrib.sessions.backends.cached_db"
MESSAGE_STORAGE = "django.contrib.messages.storage.cookie.CookieStorage" 
```

这怎么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:09:35.583

问题是 MySQLdb 安装在我的主目录`C:\Users\alexei\AppData\Roaming\Python\Python27\site-packages\`中，而该目录不在 Python 的路径中。所以我卸载了它，`pypm uninstall mysql-python`然后使用**全局**`pypm -g install mysql-python`重新安装它（注意`-g`选项）。

另一种方法是将该路径添加到列表`sys.path.append("...path...")`中`wsgi.py`

因此，如果其他人想知道，您可以像这样找出 MySQLdb（或任何其他模块）的安装位置：

```
import MySQLdb
print MySQLdb.__file__ 
```

确保该路径位于 Django 错误消息中提供的 Python 路径列表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-24T08:59:57.450

如果您使用的是虚拟环境。你必须跑

```
cd virtualEnvPath
pip install MySQL-Python 
```

不要忘记在您的虚拟环境中定位。/bin PATH，使用本地 pip。问候！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-02T15:58:01.543

我通过以下方式配置了带有 mysql 的 djando：

1）`DJANGO_SETTINGS_MODULE`在 .bashrc 中设置环境变量并获取它

2）像这样（对于mysql）更改此env_var和local_settings.py（如果有）指向的settings.py：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql', 
        'NAME': 'DB_NAME',
        'USER': 'DB_USER',
        'PASSWORD': 'DB_PASSWORD',
        'HOST': 'localhost',   # Or an IP Address that your DB is hosted on
        'PORT': '3306',
    }
} 
```

3）安装mysql dev库和头文件，确保mysql在PATH

```
sudo apt-get install libmysqlclient-dev 
```

4）为mysql安装python包

```
sudo pip install MySQL-python 
```

5）测试django对你的mysql db的访问：

```
python manage.py dbshell 
```

或者

```
django-admin dbshell 
```

6) 使用你的 django 应用程序将 django 从 dir 同步到 mysql

```
python manage.py syncdb 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-22T15:43:12.870

我也遇到了这个问题，然后我在我的系统中安装了 python mysql

> 点安装 mysql-python

然后它的工作 **看到这个**--> **在我的系统中工作 >>
$ python manage.py syncdb;**
创建表 ...
创建表 django_admin_log
创建表 auth_permission
创建表 auth_group_permissions
创建表 auth_group
......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-28T04:31:46.240

最简单的方法是从二进制安装 MySQLdb： [http ://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python](http://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python)

# php - 返回对象而不是 json_encode

> ID：12772689
> 
> 赞同：0
> 
> 时间：2012-10-07T20:41:47.537
> 
> 标签：php, jquery, ajax, json, webmethod

所以，我发现将我的 WebMethod 作为对象，返回字典而不是作为字符串，返回 JavaScriptSerializer.Serialized() 将 JSON 的大小减少了 ~ 20%。

是的，我知道这对于您（过去）为消费者服务的传统 web 应用程序来说没什么大不了的，几 kb 会很大，但对于您试图为您的客户服务的 B2B 来说，这是巨大的AJAXd jQuery 页面在传输动态表时数据传输要少得多，速度更快，动态表在动态化之前可能为 100mb，id 列表约为 1-2mb，但我离题了。

从我在其他帖子中读到的内容来看，看起来 json_encode 做了同样的事情，向 JSON 添加了不必要的内容。有没有办法简单地将数组输出为对象或从多个数组构建一个对象并将其导出？

1）打印（及其家族）是唯一的输出方式吗？

2) json_encode (和它的家族) 是必要的吗？毕竟，如果我在 jQuery 级别正确输出，我不必解码。

我是速度和效率的忠实粉丝。随着 AJAX/jsLibs 的接管，数据变得越来越大，而这些笨拙的服务器端脚本被搁置了，看起来下一个逻辑目标（除了标准化推送到客户端）是保持 JSON 的大小尽可能小可能的。

如何使用 AJAX/PHP 将垃圾减少到最低限度？如何直接将数组导出为对象？

谢谢你陪我。我的词汇量很糟糕。我希望我想做的事情相对来说足够清楚。

与往常一样，提前感谢您，感谢您成为我的大脑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T18:31:04.413

我在使用 .net webmethod 时遇到的问题是，`javascriptserializing`在将其发送出去之前，我是我的输出`<ScriptMethod(ResponseFormat:=ResponseFormat.Json)>`。这就是将额外数据添加到我的 json 输出的原因。

可以使用 json_encode 原样导出数组，这就是所有需要的。

# asp.net-mvc - MVC，实体框架，使用 HTML.DropDownFor 时外键数据设置为 null

> ID：12772691
> 
> 赞同：1
> 
> 时间：2012-10-07T20:42:24.397
> 
> 标签：asp.net-mvc, entity-framework-4.1, html.dropdownlistfor

我正在使用 MVC4 和 EF5 代码优先。我有一个问题，即在引用具有外键的行创建新数据记录时，外键行的字段设置为空。

这是一个简化的场景：

```
public class Person
{
  string name { get; set; }
  Color color { get; set; }
}

public class Color
{
  int id { get; set; }
  string name { get; set; }
} 
```

视图模型：

```
public class PersonViewModel
{
    public Person Person { get; set; }
    public IEnumerable<SelectListItem> Colors { get; set; }

    public PersonViewModel()
    {
        Context db = new Context();
        Colors = db.Colors.ToList().Select(t => new SelectListItem() { Text = t.Name, Value = t.Id.ToString() });
    }
} 
```

控制器：

```
public ActionResult Create()
{
    return View(new PersonViewModel);
}

[HttpPost]
public ActionResult Create(PersonViewModel personViewModel)
{
    if (ModelState.IsValid)
    {   
        db.Person.Add(personViewModel.Person);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    return View(personViewModel);
} 
```

最后，创建视图：

```
@model PersonViewModel
@using (Html.BeginForm())
{   
    @Html.ValidationSummary(true)

    @Html.LabelFor(model => model.Person.Name) 
    @Html.EditorFor(model =>  model.Person.Name)

    @Html.LabelFor(model => model.Person.Color)
    @Html.DropDownListFor(model => model.Person.Color.Id, this.Model.Colors)

    <input type="submit" value="Create" title="Create ticket" />
} 
```

假设我在数据中有两种颜色：1\. 红色 2\. 蓝色

当通过视图创建一个新人并选择蓝色作为颜色时，该人将被正确创建，但颜色表中 ID 为 2 的“蓝色”将保持其 ID（为 2），但其名称将设置为空。

我确定这里发生了绑定问题？这应该作为框架中的标准支持还是我需要创建自己的模型绑定器？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:26:38.543

当下拉列表将其值发布到控制器时，它只发布值，而不是名称。因此，该名称将无法绑定。

您将不得不查找该值，或创建一个包含名称和值的值，然后在回发时对其进行解析以将两者分开（可能值为“2：Blue”，然后执行 string.Split () 在回发上就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T20:57:31.467

所以事实证明我没有正确遵循实体框架约定。通过显式定义外键列，实体框架可以正确识别关系并按我的预期工作。因此，新的数据模型（添加显式外键列）

```
public class Person
{
  string Name { get; set; }

  int ColorId { get; set; }     
  Color color { get; set; }
}

public class Color
{
  int ColorId { get; set; }
  string name { get; set; }
} 
```

和更新的视图（绑定在新的外键列上）：

```
@model PersonViewModel
@using (Html.BeginForm())
{   
    @Html.ValidationSummary(true)

    @Html.LabelFor(model => model.Person.Name) 
    @Html.EditorFor(model =>  model.Person.Name)

    @Html.LabelFor(model => model.Person.Color)
    @Html.DropDownListFor(model => model.Person.ColorId, this.Model.Colors)

    <input type="submit" value="Create" title="Create ticket" />
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-18T03:01:55.893

我知道您使用的是 EF 5，但在 EF 6 中，您必须将这些导航属性声明为“虚拟”，并使用 DataAnnotations 来标记外键：

```
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

public class Person
{
    public string Name { get; set; }
    public int ColorId { get; set; }  

    [ForeignKey("ColorId")]
    public virtual Color color { get; set; }
}

public class Color
{
    int ColorId { get; set; }
    string name { get; set; }
} 
```

如果您有多种颜色，则必须在以下内容中添加这两行`public class Person`：

```
public Person
{
    Colors = new HashSet<Color>();
}

public virtual ICollection<Color> Colors { get; set; } 
```

这允许您通过`Person`, 使用`model.color.name`, if`Person`是您视图上的模型而不是`PersonViewModel`. （出于这样的原因，如果我不必使用视图模型，我更喜欢使用实体模型本身而不是视图模型。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T21:01:37.973

您应该在帖子中发现 model.Person.Color 被设置为一个新的 Color 实例，其 id 设置正确。标准模型绑定器已经完成了它的工作，但实际上您希望它与数据库中的某些内容相关联。

从内存中，您缺少外键属性，或者您可能使用流利的 api 设置了它。

最简单的选项是您执行 db.Color.Find(model.Person.Color.Id) 并将其分配给 model.Person.Color。

这还有一个额外的优势，即进行参考检查以确保没有人通过注入一个带有不存在颜色的 Id 的 post 值来作弊。

# ruby-on-rails - DreamHost 共享主机上的 rails 3.2.8 ruby 1.9.3 fcgi RMagic 问题

> ID：12772696
> 
> 赞同：4
> 
> 时间：2012-10-07T20:42:49.033
> 
> 标签：ruby-on-rails, rmagick, dreamhost, fastcgi

使用以下指南

[http://spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-dreamhost-server/](http://spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-dreamhost-server/)

我设法让我的 Rails 3.2.8 应用程序和 Ruby 1.9.3 使用 fcgi 在 Dreamhost 共享主机上运行（我知道这不是最好的解决方案，但我不想将我的应用程序降级到 3.0，而且我缺乏技能和 VPS 的钱）。

遵循 DH wiki 上的指南：

[http://wiki.dreamhost.com/RMagick](http://wiki.dreamhost.com/RMagick)

[http://wiki.dreamhost.com/Image_Magick#Compiling_ImageMagick_on_your_DreamHost_account](http://wiki.dreamhost.com/Image_Magick#Compiling_ImageMagick_on_your_DreamHost_account)

我将自己的 ImageMagic 和 RMagic 版本安装为本地 gem。

但是，当我尝试使用 RMagic 功能运行应用程序时，我在 error.log 中收到以下错误：

'脚本头过早结束：dispatch.fcgi'。

当我在上传器中取消注释以下行时，我发现它正在发生：

```
include CarrierWave::RMagick 
```

从 shell运行`dispatch.fcgi`不会报告任何错误。

我认为问题可能是由`LD_LIBRARY_PATH`其他 env 变量（列在 DH wiki 中）引起的，但尝试将它们包含在我的中`.bashrc`，但没有效果。`.bash_profile``dispatch.fcgi`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T06:55:13.823

此解决方案自 2013 年 3 月 7 日起有效。我只是用它来部署一个新的应用程序到 DH。

在您的宝石文件中...

```
gem 'paperclip' 
```

然后从您的应用程序目录运行“捆绑安装”。

在您的 public/dispatch.fcgi...复制下面的代码并将 APPNAME 替换为 config/application.rb 模块中列出的名称，将 USER 替换为您的 DH 用户名，并将 RUBY 替换为“which ruby”在您的 DH ssh 会话的命令行上。

```
#!/home/USER/.rvm/rubies/RUBY/bin/ruby

ENV['RAILS_ENV'] ||= 'production'
ENV['HOME'] ||= `echo ~`.strip
ENV['GEM_HOME'] = File.expand_path('~/.rvm/gems/RUBY')
ENV['GEM_PATH'] = File.expand_path('~/.rvm/gems/RUBY') + ":" +
File.expand_path('~/.rvm/gems/RUBY@global')

require 'fcgi' 
require File.join(File.dirname(__FILE__), '../config/environment.rb')

class Rack::PathInfoRewriter
def initialize(app)
@app = app
end

def call(env)
env.delete('SCRIPT_NAME')
parts = env['REQUEST_URI'].split('?')
env['PATH_INFO'] = parts[0]
env['QUERY_STRING'] = parts[1].to_s
@app.call(env)
end
end

Rack::Handler::FastCGI.run  Rack::PathInfoRewriter.new(APPNAME::Application) 
```

假设您安装了有效的 RVM，则无需特殊处理即可使回形针正常工作。除了我上面提到的细节（特别是 dispatch.fcgi 略有改变），你可以按照这个指南，[http://spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-梦想主机服务器/](http://spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-dreamhost-server/) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T14:43:54.380

RMagick 和 ImageMagick 因存在编译/运行时问题而臭名昭著。我建议放弃 RMagick 以支持 MiniMagick 之类的东西。看起来 CarrierWave 有一个您可以使用的 MiniMagick 处理器：[https ://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/processing/mini_magick.rb](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/processing/mini_magick.rb)

MiniMagick 只是直接输出到 ImageMagick 进程，这样您就可以避免链接到已编译二进制文件的问题。过去，RMagick 也被认为是内存泄漏等的来源。

此外，您应该认真考虑 Heroku 进行部署。一个测功机是免费的，我敢打赌你的体验会好很多。

# iphone - 在 UINavigationController 内的 UIViewController 之间切换

> ID：12772697
> 
> 赞同：2
> 
> 时间：2012-10-07T20:42:51.027
> 
> 标签：iphone, ios, xcode

所以我遇到了一个看起来很简单但很适合我的小问题。

基本上，我已经设置了这种东西：

(1)-->(2)-->(3)

我深入到一个表中，一旦我到达 (3)，我希望能够在两个不同的视图之间滑动，同时保持层次结构完整。像这样：

(1)-->(2)-->(3a)/(3b) 其中 3a 和 3b 可以来回滑动。我还想在两个视图上保留 (2) 的后退箭头，以便用户可以返回。

我遇到的问题是 3a 和 3b 需要单独调用 JSON 数据，所以它不仅仅是加载两个图像。我真的需要完全加载每个......

知道从哪里开始吗？我有经验，但这似乎完全令人困惑。我现在是使用故事板的 N2Deep。非常感谢您的帮助！

我推动新视图的通常方式就像我在下面所做的那样。这显然在这种情况下不起作用......

```
if (!self.objTomorrowDetailViewController) { self.objTomorrowDetailViewController = [[TomorrowDetailViewController alloc] initWithNibName:@"TomorrowDetailViewController" bundle:nil]; } 
[self.navigationController pushViewController:self.objTomorrowDetailViewController animated:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:40:22.130

用于`navigationController.viewControllers`获取当前视图堆栈，基于它创建一个新视图堆栈（通过可变或新语法`@[oldVCs[0],oldVCs[1],newVC]`）。将其设置为新堆栈`[navigationController setViewControllers:newVCArray animated:YES]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T06:41:29.433

我认为最好的方法是使用自定义容器控制器作为您的控制器 3。当您从 2 进行推送时，它会加载您可以设置为显示两个之一的自定义容器（或更多，如果您愿意）其子控制器。滑动手势将在容器控制器的 2 个子控制器之间切换，您仍然可以从任一视图返回到 2。

# ruby-on-rails - 载波 + 亚马逊 s3 套接字错误

> ID：12772705
> 
> 赞同：0
> 
> 时间：2012-10-07T20:44:00.170
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-s3, carrierwave

我的问题与这个问题非常相似： [rails + carrierwave + fog + S3 socket error](https://stackoverflow.com/questions/12100909/rails-carrierwave-fog-s3-socket-error) 我正在尝试区域但没有运气。

我正在尝试使用 wiki 上描述的carrierwave + fog + amazon s3 以及stackoverflow 上的几个类似问题。所以，这是我的文件：

**配置/初始化程序/carrierwave.rb**

```
CarrierWave.configure do |config|
  config.fog_directory  = 'folder_name_here' # my bucket name

  config.fog_credentials = {
    :provider               => 'AWS', 
    :aws_access_key_id      => 'access_key_here', # copied from amazon
    :aws_secret_access_key  => 'secret_key_here', # copied from amazon
    :region                 => 'eu-west-1' # my bucket has region set to Ireland
  }
end 
```

我的上传器有一个`storage`参数设置为`:fog`.

现在，当我尝试保存模型时，出现以下错误：

> getaddrinfo：名称或服务未知（SocketError）

你知道我可能做错了什么吗？如果需要任何进一步的信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T23:04:43.133

添加carrierwave和fog gem时是否重新启动了服务器？

# php - 在同一页面上加载结果

> ID：12772710
> 
> 赞同：0
> 
> 时间：2012-10-07T20:44:20.390
> 
> 标签：php, html, mysql, ajax

这个没有太多代码，

我有一个数据库，我将所有名称和 ID 加载到我的页面中，我怎样才能让用户能够单击其中一个并加载描述以与标题一起加载，而无需刷新页面。

到目前为止，我...

```
 echo "<div id=\"t".$row['Films_ID']."\"><a href=\"#\">".$film_name."</a></div>"; 
```

这是一个循环遍历表中所有行的循环，当按下该链接时，我如何将 $film_information 加载到单独的 div 中？

谢谢你们的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:48:20.267

在此链接上使用“onclick”事件，该事件将在 Javascript 中加载一个函数，该函数连接到用 php 编写的其他页面并从中获取数据。为了在不刷新页面的情况下执行此操作，您必须使用一种称为 Ajax 的技术。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:46:45.277

像这样...

JavaScript：

```
function LoadDescription(){

    var row = $(this).attr("id").substring(1); // removes the 't' from the ID leaving the value of 'Films_ID' for that row.

    $("#information").load("url/of/page/to/load.php?ID="+row+"");

} 
```

PHP：

```
$row = $_GET['ID'];

// mysql query to select information related to the ID.

// echo the info etc... 
```

注意：链接不是必需的；这将被分配给 div 的 onClick。

# iphone - iPhone iOS在呈现图表时如何处理Core Data中的时间间隔？

> ID：12772712
> 
> 赞同：1
> 
> 时间：2012-10-07T20:44:22.333
> 
> 标签：iphone, objective-c, ios, core-data, graph

如果序列之间存在时间间隔，我遇到了如何在单个图表上显示核心数据实体序列的问题。

我得到了一个固定长度的条形图（由 UITableView 支持），每个条形由一个核心数据实体表示，所有实体都带有时间戳并相互跟随，因此对此类数据进行排序会产生如下图。这种图表的好处是`NSFetchedResultsController`可以用来动态更新表格视图以响应添加的新事件。结果是在用户看来，随着时间的推移，新的条形图会添加到左侧。 ![睡眠周期图](../Images/2f02ec4897cd265e37e96f9843a1d28d.png)

我的问题是**我想扩展这个图表，让它 24 小时长并且可以左右滚动。**在这种情况下，**将出现应用程序中不存在任何数据的情节**。最终结果是，如果我在数据存在间隙时依赖 NSFetchedResultsController，并且我想为丢失的数据显示空白单元格。

我对你将如何解决这个问题感兴趣。

我看到了两个潜在的解决方案：

1) 放弃使用 的方法`NSFetchedResultsController`，而是手动计算 a 中的条数`UITableView`。每个条形图由开始日期和结束日期定义。然后我可以使用`NSFetchRequest`with predicate 来查询每个 bar 的数据。如果有一个事件的时间戳在条形的日期范围内，则显示一个条形，否则显示一个空白。

方法 #1 的问题在于它很慢，虽然它确实允许滚动整个数据集，但它很慢而且滞后，因为每个获取请求都是针对每个新柱执行的。此外，我需要手动刷新表以响应添加的新数据，这很难正确实现。

2）也许我可以用空白事件预先填充数据集，然后在数据可用时“填充”它们。这将允许我使用获取的结果控制器保留表格视图，从而实现更平滑的滚动，但代价是显着增加了应用程序使用的持久存储（因为将在应用程序使用之间创建空白实体）。

**如果有我没有想到的其他方法，我会徘徊。您将如何创建一个可在应用程序的持久数据存储中允许“间隙”的侧滚动条形图？**

谢谢您的意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:45:01.113

您的问题确实与 Core Data 或 NSFetchedResultsController 没有（或不应该）任何关系。您的图表视图如何绘制它给出的数据完全取决于图表视图。没有理由不能编写使用 NSFetchedResultsController*并*适当处理数据间隙的图形视图，但 UITableView 从未打算处理丢失/空单元格。

**问题不在于您使用的是 Core Data 或 NSFetchedResultsController。问题是你在滥用 UITableView。**

绘制条形图非常简单——它只是在适当位置绘制的一系列矩形。您可以为您的视图提供一个获取的结果控制器，并让它查看`fetchedObjects`属性以获取当前的对象列表。然后，它可以根据需要渲染尽可能多的对象，并且可以使用每个对象的开始和结束日期来定位图形上的绘图。将您的图表放在 UIScrollView 中，这样您就不必担心滚动。如果图形可以变大，添加平铺以便您只绘制用户正在查看的部分，就像 UITableView 一样。

看起来您目前也在表格视图上方绘制一些内容。如果您创建自己的图表视图，您可能会考虑同时绘制额外的内容（红线、红色和绿色气泡、高 REM 概率的东西）。这样做可以很容易地确保所有内容都正确地位于图表上（这对于您当前的方案可能有点麻烦）。

# database-design - 关于设置功能依赖的困惑

> ID：12772713
> 
> 赞同：1
> 
> 时间：2012-10-07T20:44:28.747
> 
> 标签：database-design, primary-key, normalization, functional-dependencies, 3nf

鉴于下表定义：

卡车（TruckNum、TruckType、TypeDesc、TruckMiles、DatePurchased、TruckSerialNum、BaseCity、BaseState、BaseNum、BaseManagerName、ManagerPhone、BasePhone）

我需要设置功能依赖项列表。

到目前为止，我有：

```
FDs = {TruckNum ->  TruckType, TypeDesc, TruckMiles, DatePurchased, TruckSerialNum, BaseNum

     BaseNum -> BaseCity, BaseState,  BasePhone

     BaseManagerName -> ManagerPhone} 
```

> 我还得到了以下注意事项/限制：
> 
> 1.  卡车位于单个基地。
>     
>     
> 2.  一个基地可以是许多卡车的基地。

无论如何，我的问题实际上非常简单并且（可能）完全是新手。让我困惑的是BaseNum。

注意我有这个：

TruckNum -> (...) BaseNum

进而

基数 -> (...)

看看我如何使用 BaseNum 两次？这是允许的吗？

1NF 的定义是表不应该有任何重复的组。但这不只是针对表定义（而不是 FD）吗？我很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:06:48.633

我从来没有将数据库作为计算机科学学科的正式课程，但 1NF 的实际定义是，在表格的单元格中，您不能有任何逗号分隔的值列表。这就对了。

因此，您可以拥有 OP 中描述的功能依赖关系。只要您将 trackNums（或其他实体）存储在某个表的单独行中，而不是以逗号分隔的列表中，它将符合 1NF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:08:15.277

根据我对您的情况的了解/理解，您正朝着正确的方向前进。

您有一个属性列表，并且在规范化时（您实际上比 1NF 更领先），您使用 BaseNum 作为 Trucks tbl 中的属性非常好。

Your Functional Dependencies would easily be converted into PK/FK pairs. From that perspective, you are also going in the right direction.

# python - Qt4 Designer 小部件错误

> ID：12772716
> 
> 赞同：0
> 
> 时间：2012-10-07T20:44:53.190
> 
> 标签：python, qt4, pyqt4, qt-designer

我使用 Qt4Designer 设计了一个应用程序 UI。我这样做了，但是当我`.py`通过 pyuic4 将其转换为文件时，如下所示：

```
pyuic4 myui.ui > myui.py 
```

我面对一个错误，上面写着：`Error: Q3Support widgets are not supported by PyQt4.`

这个错误的原因是什么？

我们可以使用放置在设计器中的所有小部件吗？例如`KDatePicker`，`Q3Table`等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T23:49:55.557

这些`Q3Support`类仅用于帮助将**Qt3**应用程序移植到 Qt4。绝对*没有理由*在新代码中使用它们。而且无论如何，对于 Qt5（现在不远），它们将被完全删除。

关于您收到的错误消息，没有什么可补充的，因为它几乎不可能更清楚。`Q3Support`PyQt4 不支持这些小部件。也就是说，PyQt4 根本不包装任何那些特定的 Qt 类。

至于 KDE 小部件：PyQt 也不直接支持它们。

要将它们与 python 一起使用，您需要[PyKDE4](http://techbase.kde.org/Development/Languages/Python) - 并且需要使用[pykdeuic4](http://api.kde.org/pykde-4.3-api/designer.html)编译 ui 文件。

# php - 如何在.htaccess 中制定正确的 mod_rewrite 规则

> ID：12772717
> 
> 赞同：0
> 
> 时间：2012-10-07T20:44:54.900
> 
> 标签：php, .htaccess, mod-rewrite

我正在尝试制定重写规则，将这个长网址重写为对 SEO 友好的网址。但是，我的规则不起作用，目标 url 变成了 404 页面。我会很感激任何帮助。谢谢！

**这是原始 URL 的示例**

[http://www.mydomain.com/index.php?module=product&pId=102&id=14495&category=computer/DELL&start=0/](http://www.mydomain.com/index.php?module=product&pId=102&id=14495&category=computer/DELL&start=0/)

**这是我的重写规则**

RewriteRule ^module/([^/] *)/pId/([^/]* )/id/([^/] *)/category/([^/]* )/start/([^/]*)$ /index .php?module=$1&pId=$2&id=$3&category=$4&start=$5 [L]

**这是转换后的 URL**

[http://www.mydomain.com/index/module/product/pId/102/id/14495/category/computer/DELL/start/0/](http://www.mydomain.com/index/module/product/pId/102/id/14495/category/computer/DELL/start/0/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T20:51:47.520

乍一看，您正在匹配`/start/[^/]*$`. 但是您的 URL 包含一个尾部正斜杠`start/0/`，您的正则表达式将其排除在外。

因此，最好是允许使用备用斜线，`/?`或者更确切地说，通过允许所有内容使最后一个匹配模式完全不可感知`/start/(.*)$`。

但无论如何，仅仅删除文件扩展名并用与号和等号交换正斜杠并不能获得更好或用户友好的 URL。目标应该是参数合并以提高可读性。现代搜索引擎并不真正关心 GET 参数。

# c# - 连接字符串格式不正确

> ID：12772719
> 
> 赞同：1
> 
> 时间：2012-10-07T19:25:57.703
> 
> 标签：c#, asp.net

我遇到了一些问题。每次我进入调试模式并点击“创建用户”按钮时，我都会抛出一个异常，这是由于连接字符串的语法错误或错误。

使用 Visual Studio 2010，项目是带有 SQL 2008 Express 的 .NET 3.5。

这只是一个我正在测试其他东西的个人项目，我知道这通常不是推荐的格式，但对于个人小型项目，我不认为以任何其他方式这样做有什么意义。我正在测试的东西确实有效:)

```
Data Source=.\SQLEXPRESS;AttachDbFilename=|Data Directory|ASPAppDatabase.mdf;Integrated Security=True;User Instance=True 
```

那是行不通的。

```
Data Source=.\SQLEXPRESS;AttachDbFilename="|Data Directory|ASPAppDatabase.mdf";Integrated Security=True;User Instance=True 
```

那也不行。

```
Data Source=.\SQLEXPRESS;AttachDbFilename='|Data Directory|ASPAppDatabase.mdf';Integrated Security=True;User Instance=True 
```

再说一次，那也不是：/

但是，如果我使用本地数据库文件的完整路径，而不是使用“|数据目录|”，它可以正常工作并且不会引发异常，并且我可以根据需要进行读写。

只是为了涵盖我的所有基础，这里是创建用户的按钮单击事件。

```
 protected void btnAddUser_Click(object sender, EventArgs e)
        {
            Membership.CreateUser(txtUserName.Text, txtPassword.Text);
            btnLogin_Click(sender, e);
        } 
```

那么，关于|数据目录|，我缺少什么？

这是上述无法正常工作的示例。直接取自 web.config。

```
<add name="ASPAppDatabaseConnection" connectionString='Data Source=.\SQLEXPRESS;AttachDbFilename=|Data Directory|ASPAppDatabase.mdf;Integrated Security=True;User Instance=True'/> 
```

编辑：这是完整的路径连接字符串：

```
Data Source=.\SQLEXPRESS;AttachDbFilename="Full Path to DB\ASPAppDatabase.mdf";Integrated Security=True;User Instance=True 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:48:29.543

您的项目中有 App_Data 文件夹吗？App_Data 是“数据目录”。您可以在 Visual Studio 中右键单击您的解决方案并添加一个。

# ios - 在 OpenGL ES 中复制 UIView drawRect

> ID：12772723
> 
> 赞同：1
> 
> 时间：2012-10-07T20:45:32.697
> 
> 标签：ios, opengl-es, uiview, drawrect

我的 iOS 应用程序使用 Core Graphics 绘制位图（与我的视图大小相同）。我想将位图的更新区域推送到屏幕上。（我使用了标准的 UIView drawRect 方法，但我有一些充分的理由切换到 OpenGL）。

我只想在 OpenGL 视图中复制与 UIView/CALayer drawRect 相同的行为。本质上，我想更新我的 OpenGL 视图上的脏矩形。而已。

到目前为止，我已经能够创建一个 OpenGL ES 1.1 视图，并在每次更新位图时使用单个四边形（顶点数组上的纹理）将我的整个位图推送到屏幕上。当然，这是非常低效的，因为我只需要刷新脏矩形，而不是整个视图。

在 OpenGL ES 中最有效的方法是什么？我应该使用四边形格子并更新与脏矩形相交的四边形的纹理吗？（如果我要使用那个方法，我应该使用 VBO 吗？）有没有更好的方法来做到这一点？

仅供参考（以防万一），我不需要旋转，但需要缩放整个 OpenGL 视图。

更新：这种方法确实有效。但是，在视网膜显示设备上的 iOS5.x 中存在一个错误，该错误会在使用单缓冲时产生伪影。该问题已在 iOS6 中得到修复。我还没有解决办法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:45:25.800

您可以简单地使用 TexSubImage 更新纹理的一部分，然后重绘您的标准全屏四边形，但将剪刀矩形蜂设置 (glScissor) 设置为“脏”部分。然后 GL 将不会在该矩形之外绘制任何片段。

为此，您当然必须使用单缓冲。

# apache - 为现有网站重写 URL

> ID：12772725
> 
> 赞同：1
> 
> 时间：2012-10-07T20:46:18.473
> 
> 标签：apache, url-rewriting

我希望这不是一个非常愚蠢的问题。我必须重写现有网站的网址。我以前从来没有这样做过，所以我有点困惑。我已经编写了一些规则，通过仅输入不带 .php 扩展名的 faq 也可以访问像 faq.php 这样的页面，但是当我将鼠标移到 faq 图标上时，页面 fap.php 仍然可以访问并且在页脚中浏览器中显示的链接是 faq.php。要使浏览器显示 faq 而不是 faq.php 我必须手动更改页面中的 href 链接还是有其他方法？例如：在本网站（stackoverflow）中，当您将鼠标移到问题、标签、用户或其他链接上时，浏览器仅显示 /questions（或其他）而不显示 .php（或他们用于构建网站的任何内容）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:55:56.143

您在状态栏中看到的是您的服务器发送到浏览器的内容。

要从您那里删除`.php`，`faq.php`必须要么

*   仅发送`faq`(PHP) 或
*   替换`href`客户端 (JavaScript) 上的属性内容。

# php - Wamp 错误：#2002。我无权访问 myphpadmin。

> ID：12772726
> 
> 赞同：0
> 
> 时间：2012-10-07T20:46:40.543
> 
> 标签：php, wamp

> **可能重复：**
> [打开 phpMyAdmin 时拒绝访问](https://stackoverflow.com/questions/11702051/access-denied-when-opening-phpmyadmin)

**#2002 - 由于目标机器主动拒绝，无法建立连接。服务器没有响应（或本地服务器的套接字未正确配置）。**

我刚刚安装了 wamp，当我尝试访问“myphpadmin”时它给了我这个错误。

下面是我的配置文件 config.inc.php 来自 C:\wamp\apps\phpmyadmin3.5.1

```
<?php

/* Servers configuration */
$i = 0;

/* Server: localhost [1] */
$i++;
$cfg['Servers'][$i]['verbose'] = 'localhost';
$cfg['Servers'][$i]['host'] = 'localhost';
$cfg['Servers'][$i]['port'] = '';
$cfg['Servers'][$i]['socket'] = '';
$cfg['Servers'][$i]['connect_type'] = 'tcp';
$cfg['Servers'][$i]['extension'] = 'mysqli';
$cfg['Servers'][$i]['auth_type'] = 'config';
$cfg['Servers'][$i]['user'] = 'root';
$cfg['Servers'][$i]['password'] = '';
$cfg['Servers'][$i]['AllowNoPassword'] = true;

/* End of servers configuration */

$cfg['DefaultLang'] = 'en-utf-8';
$cfg['ServerDefault'] = 1;
$cfg['UploadDir'] = '';
$cfg['SaveDir'] = '';

/* rajk - for blobstreaming */
$cfg['Servers'][$i]['bs_garbage_threshold'] = 50;
$cfg['Servers'][$i]['bs_repository_threshold'] = '32M';
$cfg['Servers'][$i]['bs_temp_blob_timeout'] = 600;
$cfg['Servers'][$i]['bs_temp_log_threshold'] = '32M';

?> 
```

提前致谢。

# ruby-on-rails - 编写脚本来填充 database.yml 文件并需要正则表达式来识别特定的留置权

> ID：12772727
> 
> 赞同：3
> 
> 时间：2012-10-07T20:46:53.883
> 
> 标签：ruby-on-rails, regex, bash, shell

我的情况与[这篇文章](https://stackoverflow.com/questions/5723464/sed-change-values-of-properties-of-an-environment-in-a-yml-file)中的人非常相似。我正在尝试编写一个在 database.yaml 文件中填充值的脚本。问题是......我完全不明白作为解决方案发布的那个正则表达式中发生了什么。

我想要做的是传递密码变量。

如果我有一个如下所示的数据库 yml 文件：

```
development:
  database: sample_development
  password:
  # etc...

test:
  database: sample_test
  password:
  # etc... 
```

那么如何创建一个找到“密码：”的正则表达式，以便我可以用“密码：$new_password”替换它？

对于设置开发密码的脚本部分，我猜正则表达式会开始

```
/^development: 
```

但是我不知道如何抓住下一行'密码：'。

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:09:53.823

我只会使用 YAML 库来读取/写入 yaml 文件：

```
require 'yaml'
database_config = YAML.load(File.open("<some path>/config/database.yml")) 
```

然后修改一些值，写回fs：

```
database_config['some_key'] = "some_value"
File.open("<some path>/config/database.yml", "w") {|f| f.write(database_config.to_yaml) } 
```

您可以创建一个 ruby​​ 脚本，该脚本将接受参数来设置密码、主机名等。除此之外，您可以在 YAML 文件中使用 ruby​​ 使其动态化，yaml 本身可以读取配置文件或环境变量并使用它们设置密码、主机名等。

```
host: <%= SERVER_CONFIG["dev_host"] %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:01:22.647

您可以使用 sed 脚本：

```
#!/bin/sed -f

: restart
/^development/ {
    : loop
    s/\(password:\).*/\1 new_password/
    t stop
    n
    /^[ \t]/ b loop
    i\  password: new_password
    b restart
} 
: stop 
```

这里我们有一个 sed 脚本，当它找到以“development”开头的行时，它将启动主要的命令块。在解释命令的作用之前，我认为解释标签是个好主意。标签是用`:`命令定义的，它们为脚本中的某些位置命名。我们定义了 3 个标签。

1.  `restart`用于回到脚本的开头。
2.  `loop`用于遍历`development`块内的行。
3.  `stop`当我们对密码执行更改时使用它，然后我们转到脚本的末尾，这实际上允许脚本在下一个输入行重新启动。

在主块中，我们首先尝试使用`s`替代命令应用密码更改。如果它有效，则随后的测试命令将跳转到脚本的末尾，以便在找到另一个块`t`的情况下继续执行。`development`

如果替代命令不成功，则该`t`命令不执行任何操作，我们继续执行`n`下一个命令。此命令将下一个输入行加载到模式空间（即 sed 的工作缓冲区）中。然后我们检查它是否以空格或制表符开头，如果是，我们跳转到“循环”标签，让我们看看这个新行是否是包含密码字段的行。

如果它不是以空格字符开头，我们已经到达了块的末尾。插入命令是可选的`i`，但是我们可以在未找到时在块末尾添加密码行。

最后，由于我们到达了块的末尾，我们必须重新开始执行。我们可以让执行读取脚本的结尾，但是由于我们已经加载了一个不以空格字符开头的新行，因此我们必须手动跳转到开头以防止 sed 在重新启动之前加载另一行。

然后，您可以使用以下命令运行此脚本（假设它被称为`chg_passwd.sed`）：

```
./chg_passwd.sed database.yml 
```

希望这会有所帮助=)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T23:55:05.417

这可能对您有用：

```
database=foo newpassword=bar
sed '/^'"${database}"'/,/^\s*$/s/password:/&'"${newpassword}"'/' file 
```

# android - Android Toast 保持在屏幕上直到响应

> ID：12772732
> 
> 赞同：0
> 
> 时间：2012-10-07T20:47:53.437
> 
> 标签：android, notifications, wait, toast

我正在编写一个 android 应用程序，它将向 GSM 模块发送一条短信，该模块将做一些事情（究竟是什么无关紧要）。

这个应用程序会做一些事情，比如选择某些设备是打开还是关闭。

问题是我想制作一个按钮，它将带有问题的 SMS 发送到特定设备。然后我想弹出一个通知（“等待设备响应”）。

我想将此通知保留在屏幕上，直到收到短信回复。

我如何让吐司在回复到来之前逗留？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:03:24.827

> 我如何让吐司在回复到来之前逗留？

你没有。由于用户无法摆脱 a `Toast`，它们的寿命是有限的，因此用户不会对人们无限期地弄乱屏幕感到恼火。

由于您显然有一个活动（“我想制作一个按钮”），您可以在活动的 UI 中显示您的消息，或弹出一个对话框。

# java - 在 Java 中使用泛型映射的问题

> ID：12772733
> 
> 赞同：2
> 
> 时间：2012-10-07T20:47:58.670
> 
> 标签：java, generics, maps

我有一个类，我试图用它来测试 HashMap 和 TreeMap，如下所示；

```
public class TestMap<KeyType, ValueType>
{
private Map<KeyType, ValueType> internalMap;

/*
 * Entry point for the application
 */
public static void main( String [ ] args )
{
    TestMap<String, Integer> testHashMap = new TestMap<String,Integer>(new HashMap<String, Integer>());
    testHashMap.test();

    TestMap<String, Integer> testTreeMap = new TestMap<String,Integer>(new TreeMap<String, Integer>());
    testTreeMap.test();
}    

/*
 * Constructor which accepts a generic Map for testing
 */
public TestMap(Map<KeyType, ValueType> m)
{
    this.internalMap = m;
}   

public void test()
{
    try
    {
        //put some values into the Map
        this.internalMap.put("Pittsburgh Steelers", 6);

        this.printMap("Tested Map", this.internalMap);  
    }
    catch (Exception ex)
    {

    }
} 
```

}

在尝试调用 put() 方法时，我收到以下错误消息；

> 类型 Map 中的 put(KeyType, ValueType) 方法不适用于参数 (String, int)

我没有收到任何其他警告，我不明白为什么会收到这个？这不是泛型的全部意义吗？通用定义和具体实现？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T20:55:12.037

该`test()`方法是`TestMap`类的一部分。在任何`TestMap`方法中，您只能引用泛型类型，而不是任何特定类型（因为这取决于单个实例）。但是，您可以这样做：

```
public static void main( String [ ] args )
{
    TestMap<String, Integer> testHashMap = new TestMap<String,Integer>(new HashMap<String, Integer>());
    testHashMap.internalMap.put("Pittsburgh Steelers", 6);

    TestMap<String, Integer> testTreeMap = new TestMap<String,Integer>(new TreeMap<String, Integer>());
    testTreeMap.internalMap.put("Pittsburgh Steelers", 6);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-07T20:51:18.863

问题是您的整个类是通用的，但是您正在尝试使用一组特定的类型对其进行测试。尝试将测试方法移出对象并在`TestMap<String, int>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T20:57:40.963

另一种选择是从您的 TestMap 对象中删除泛型。他们目前似乎没有做任何事情。

```
public class TestMap {
    private Map<String, Integer> internalMap;

    /*
     * Entry point for the application
     */
    public static void main( String [ ] args )
    {
        TestMap testHashMap = new TestMap(new HashMap<String, Integer>());
        testHashMap.test();

        TestMap testTreeMap = new TestMap(new TreeMap<String, Integer>());
        testTreeMap.test();
    }

    /*
     * Constructor which accepts a generic Map for testing
     */
    public TestMap(Map<String, Integer> m)
    {
        this.internalMap = m;
    }   

    public void test()
    {
        try
        {
            //put some values into the Map
            this.internalMap.put("Pittsburgh Steelers", 6);

            this.printMap("Tested Map", this.internalMap);  
        }
        catch (Exception ex)
        {

        }
    }
} 
```

# objective-c - NSURLConnection 返回旧数据，尽管 NSURLRequestReloadIgnoringLocalAndRemoteCacheData

> ID：12772734
> 
> 赞同：1
> 
> 时间：2012-10-07T20:47:59.573
> 
> 标签：objective-c, ios, xcode, nsurlconnection

我有一个严重的问题。在我的应用程序中，我正在使用 NSURLConnection 下载 XML 文件。到目前为止，一切都很好。但是有时，NSURLConnection 会返回请求文件的旧版本，尽管我将 cachePolicy 设置为 NSURLRequestReloadIgnoringLocalAndRemoteCacheData。该错误真正令人作呕的部分是，连接总是返回旧版本的文件，直到我激活然后停用飞行模式或重新启动设备。

另一个有趣的事实是：当我激活 Wifi 并调用应用程序重新加载文件时，会返回文件的正确和实际版本。但是关闭 Wifi 后，旧版本会再次重新调整。

我真的对这个问题感到绝望，希望有人能帮助我吗？

这是我班上的代码，下载文件：

```
#import "HTTPReciever.h"
#import "Constants.h"

@interface HTTPReciever ()
@property (strong, nonatomic) NSMutableData *receivedData;
@property (strong, nonatomic) NSString *directoryPath;
@property (strong, nonatomic) NSString *filename;
@property (assign, nonatomic) BOOL storeData;
@end

@implementation HTTPReciever
@synthesize receivedData = _receivedData;
@synthesize delegate = _delegate;
@synthesize directoryPath = _directoryPath;
@synthesize filename = _filename;

- (BOOL)recieveDataFromURL:(NSURL *)url
      storeAtDirectoryPath:(NSString *)directoryPath
                  withName:(NSString *)name
{
    [self setDirectoryPath:directoryPath];
    [self setFilename:name];
    [self setStoreData:YES];
    return [self recieveDataFromURL:url];
}

- (BOOL)recieveDataFromURL:(NSURL *)url
{
    NSURLRequest *theRequest = [[NSURLRequest alloc] initWithURL:url
                                                     cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData
                                                 timeoutInterval:cDefaultHTTPTimeOutInterval];

    self.receivedData = nil;
    self.receivedData = [[NSMutableData alloc] initWithLength:0];
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:theRequest
                                                                  delegate:self
                                                          startImmediately:NO];
    if ([NSURLConnection canHandleRequest:theRequest] && connection) {
        [connection start];
        return YES;
    } else {
        return NO;
    }
}

#pragma mark - NSURLConnectionDelegate protocol
- (void)connection:(NSURLConnection *)connection
     didReceiveData:(NSData *)data
{
    [self.receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection
didReceiveResponse:(NSURLResponse *)response
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    [self.receivedData setLength:0];
    if ([response isKindOfClass:[NSHTTPURLResponse self]]) {
        NSDictionary *headers = [(NSHTTPURLResponse *)response allHeaderFields];
        NSString *modified = [headers objectForKey:@"Last-Modified"];
        if (modified) {
            // not yet used
        }
    }
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;

    if (self.storeData) {
        [[NSFileManager defaultManager] createDirectoryAtPath:self.directoryPath
                                  withIntermediateDirectories:YES
                                                   attributes:nil
                                                        error:nil];
        [self.receivedData writeToFile:[NSString stringWithFormat:@"%@%@", self.directoryPath, self.filename]
                            atomically:YES];
    }

    [self.delegate receiver:self
       didFinishLoadingData:self.receivedData
                lastVersion:YES];
}

- (void)connection:(NSURLConnection *)connection
  didFailWithError:(NSError *)error
{
    [self.delegate receiverFailedLoadingData:self];
}

- (NSCachedURLResponse *)connection:(NSURLConnection *)connection
                  willCacheResponse:(NSCachedURLResponse *)cachedResponse
{
    return nil;
}

@end 
```

# javascript - 从闭包编译器重构代码

> ID：12772743
> 
> 赞同：0
> 
> 时间：2012-10-07T20:49:37.803
> 
> 标签：javascript, canvas, compiler-construction, google-closure-compiler

我有两个不同版本的 javascript 文件：一个工作正常，另一个执行较慢。我在这两个文件上都尝试了 Closure Compiler，但是......因为我是个白痴，几个月后我很高兴地注意到好的版本的原始源文件丢失了。不仅来自我的硬盘，甚至来自我的记忆（我不记得我做了哪些更改）。

所以现在我有：

1.  *   *正常*工作文件的压缩代码
2.  *   *坏*工作文件的压缩代码
3.  *   *坏*工作文件的未压缩代码

我需要重建运行良好的源文件，很高兴这两个压缩版本之间确实存在一些差异。

这是我需要你帮助的地方。

我在运行**良好**的压缩代码中发现了这一点

```
(function () {
// same stuff here      
})();

requestAnimFrame(O); 
```

在**糟糕**的工作压缩代码中是这样的

```
B.onload = function () {
// same stuff here
};
requestAnimFrame(O) 
```

那么，闭包编译器究竟如何声明一个没有名字的函数呢？`();`函数声明末尾的那些是什么？这是如何在未压缩的代码中实现的？如果它可能有帮助，这就是未压缩的坏版本（我希望修复）中的样子：

```
function init() {
// same stuff here
}

B.onload = function(){
start()
}

function start() {
init()
requestAnimFrame(0);
} 
```

如果您想自己测试差异，[这是使用好代码时](http://pulsewave.net/issue/good.html) 的[结果，这是使用坏代码时的结果](http://pulsewave.net/issue/slow.html)

尝试单击徽标：立方体在第一个链接中滑动得更快，如果您有一个好的 CPU，它不应该在运行视觉效果时被杀死。相反，第二个链接似乎使 cpu 过载并且在动画中进行时有不同的显示（我已经发现了代码中的差异并记住了我所做的更改，从而解决了第二个问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:00:37.787

> *“那么，闭包编译器究竟如何声明一个没有名字的函数呢？”*

因为 JavaScript 支持匿名函数。在分配事件处理程序时，您可能经常使用它们。

> *`();`“函数声明末尾的那些是什么？”*

他们在完成*任何*功能后都会做同样的事情。他们调用它。虽然它不是一个函数“声明”。因为函数被括在括号中，所以它是一个匿名函数*表达式*。

> *“这是如何在未压缩的代码中实现的？”*

这将取决于未压缩的代码。人们在他们的正常代码中经常使用这种模式。它创建了一个局部变量范围，代码可以在其中执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T22:16:34.167

看起来不同的是，坏的在做“同样的事情”之前正在等待 B 加载，而好的则立即执行。

# javascript - 在选择更改功能中使用 jQuery 处理选项变量

> ID：12772745
> 
> 赞同：0
> 
> 时间：2012-10-07T20:49:49.277
> 
> 标签：javascript, jquery, onchange

我尝试编写一些 jQuery 函数来在选择选择项的选项时更改一些变量值（如果选择了选项，则添加某个值，如果不再选择选项，则减去该值），但它以非常奇怪的方式。这是我为 javascript 编写的代码（改编自以前用于复选框的代码）：

```
var pds1=0;
var pds2=0;
var pds3=0;
var pdstot=0;

$(document).ready(function() {
  $('#perk1').html(pds1);
  $('#perk2').html(pds2);
  $('#perk3').html(pds3);
  $('#perktot').html(pdstot);

  $("#blabla").change(
    function() {
      if ($("option#5:selected").length)
      {
        pds1=pds1+10;
        pdstot=pdstot+10;
      }
      else if(pds1>0)
      {
        pds1=pds1-10;
        pdstot=pdstot-10;
      }

      if ($("option#3:selected").length)
      {
        pds2=pds2+10;
        pdstot=pdstot+10;
      }
      else if(pds2>0)
      {
        pds2=pds2-10;
        pdstot=pdstot-10;
      }

      if ($("option#4:selected").length)
      {
        pds3=pds3+10;
        pdstot=pdstot+10;
      }
      else if(pds3>0)
      {
        pds3=pds3-10;
        pdstot=pdstot-10;
      }
      //option 6 adds 10 to variable pds1 and pds2
      if ($("option#6:selected").length)
      {
        pds1=pds1+10;
        pds2=pds2+10;
        pdstot=pdstot+10;
      }
      else if(pds1>0)
      {
        pds1=pds1-10;
        pds2=pds2-10;
        pdstot=pdstot+10;
      }

      $('#perk1').html(pds1);
      $('#perk2').html(pds2);
      $('#perk3').html(pds3);
      $('#perktot').html(pdstot);
    });
}); 
```

这是html

```
<select id='blabla' multiple='multiple'>
<option id='5'>Name5</option>
<option id='3'>Name3</option>
<option id='4'>Name4</option>
<option id='6'>Name6</option>
</select>

<span id="perk1"></span>
<span id="perk2"></span>
<span id="perk3"></span>
<span id="perk4"></span> 
```

有人可以解释一下这个函数是如何处理变量的吗？奇怪的行为示例：单击选项 5 不会将 10 加到 pds1，而是将 10 减到 pds2；我想要发生的事情是将 10 添加到 pds1 而对 pds2 不执行任何操作。我认为问题在于，在这种情况下，它在“option#6:selected”下的“else if”中，但为什么呢？这不是唯一的奇怪行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T23:00:01.340

很容易看出为什么你会得到你得到的结果。使用当前代码和 #5 示例遍历每个`if`语句。由于选择了 #5，因此`pds1`添加了 10。由于没有选择 #6 并且 pds1 增加了 #5，因此`else`减去了刚刚添加到 pds1 的内容。

您可以通过每次简单地将变量重置为零来简化整个逻辑，然后只添加需要的内容。

```
/* utilty function to avoid repeated lines */
function showValues(pds1, pds2, pds3) {

    var pdstot = pds1 + pds2 + pds3
    $('#perk1').html(pds1);
    $('#perk2').html(pds2);
    $('#perk3').html(pds3);
    $('#perk4').html(pdstot);
}

$(document).ready(function() {
    showValues(0, 0, 0);

    $("#blabla").change(

    function() {
        var num_selected = $(this).find(':selected').length;

        var pds1 = 0;
        var pds2 = 0;
        var pds3 = 0;                     

        if ($("option#5:selected").length) {
            pds1 = pds1 + 10;
        }    
        if ($("option#3:selected").length) {
            pds2 = pds2 + 10;
        }    

        if ($("option#4:selected").length) {
            pds3 = pds3 + 10;
        }

        //option 6 adds 10 to variable pds1 and pds2
        if ($("option#6:selected").length) {
            pds1 = pds1 + 10;
            pds2 = pds2 + 10;    
        }

        showValues(pds1, pds2, pds3);

    });
}); 
```

演示：http: [//jsfiddle.net/f9UEC/](http://jsfiddle.net/f9UEC/)

# objective-c - 仅支持一个视图的不同方向 iOS 6

> ID：12772749
> 
> 赞同：29
> 
> 时间：2012-10-07T20:50:13.293
> 
> 标签：objective-c, ios, xcode

我只想将我的应用程序中的一个视图旋转到横向左侧或横向右侧。我所有其他视图都处于纵向模式，并且我已将我的应用程序设置为仅支持纵向模式。随着 iOS 6 中方向的改变，我不知道该怎么做。我已经尝试了下面发布的以下内容。谁能告诉我我做错了什么？谢谢！

```
-(BOOL)shouldAutorotate {
return YES;
}

-(NSUInteger)supportedInterfaceOrientations {
return UIInterfaceOrientationMaskLandscapeLeft | UIInterfaceOrientationMaskLandscapeRight;
}

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{

return UIInterfaceOrientationMaskLandscapeRight | UIInterfaceOrientationMaskLandscapeLeft;
} 
```

我也试过：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(didRotate:)
                                            name:UIDeviceOrientationDidChangeNotification
                                           object:nil];
return YES;//UIInterfaceOrientationMaskLandscapeRight | UIInterfaceOrientationMaskLandscapeLeft;
} 

 -(void)didRotate:(NSNotification *)notification {
 UIDeviceOrientation orientation = [[notification object] orientation];

if (orientation == UIDeviceOrientationLandscapeLeft) {
    [theImage setTransform:CGAffineTransformMakeRotation(M_PI / -2.0)];
    [self.view setTransform:CGAffineTransformMakeRotation(M_PI / 2.0)];
} else if (orientation == UIDeviceOrientationLandscapeRight) {
    [theImage setTransform:CGAffineTransformMakeRotation(M_PI / -2.0)];
    [self.view setTransform:CGAffineTransformMakeRotation(M_PI / -2.0)];
} else if (orientation == UIDeviceOrientationPortraitUpsideDown) {
    [theImage setTransform:CGAffineTransformMakeRotation(M_PI / -2.0)];
    [self.view setTransform:CGAffineTransformMakeRotation(M_PI / -2.0)];
} else if (orientation == UIDeviceOrientationPortrait) {
    [theImage setTransform:CGAffineTransformMakeRotation(M_PI / 2.0)];
    [self.view setTransform:CGAffineTransformMakeRotation(M_PI / 2.0)];
}
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-23T18:30:08.220

这对我[有用 How to force a UIViewController to Portrait orientation in iOS 6](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6)

从覆盖旋转方法的 UINavigationController 创建一个新类别：

```
-(BOOL)shouldAutorotate
{
    return [self.topViewController shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [self.topViewController supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [self.topViewController preferredInterfaceOrientationForPresentation];
}

@end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-07T22:11:43.087

iOS 6 在处理视图旋转方面有一些变化。**仅**支持在应用程序中定义的方向`Info.plist`。即使您要退回其他人。

尝试选择项目支持的所有方向。

> **处理视图旋转**
> 
> 在 iOS 6 中，您的应用程序支持在您的应用程序`Info.plist`文件中定义的界面方向。视图控制器可以覆盖该`supportedInterfaceOrientations`方法以限制支持的方向列表。一般情况下，系统只会在窗口的根视图控制器或呈现为填满整个屏幕的视图控制器上调用该方法；子视图控制器使用其父视图控制器为它们提供的窗口部分，并且不再直接参与有关支持哪些旋转的决策。应用程序的方向掩码和视图控制器的方向掩码的交集用于确定视图控制器可以旋转到哪些方向。
> 
> 您可以覆盖`preferredInterfaceOrientationForPresentation`旨在以特定方向全屏显示的视图控制器。
> 
> 在 iOS 5 和更早版本中，`UIViewController`该类仅以纵向模式显示视图。要支持其他方向，您必须重写该`shouldAutorotateToInterfaceOrientation:`方法并为您的子类支持的任何方向返回 YES。如果您的视图的自动调整大小属性配置正确，那么您可能只需要这样做。但是，`UIViewController`该类提供了额外的钩子供您根据需要实现额外的行为。通常，如果您的视图控制器打算用作子视图控制器，它应该支持所有界面方向。
> 
> 当可见视图控制器发生旋转时，会在旋转期间调用`willRotateToInterfaceOrientation:duration`: `willAnimateRotationToInterfaceOrientation:duration:`、 和`didRotateFromInterfaceOrientation:`方法。`viewWillLayoutSubviews`在视图由其父级调整大小和定位后，也会调用该方法。如果在方向更改发生时视图控制器不可见，则永远不会调用旋转方法。但是，`viewWillLayoutSubviews`当视图变得可见时调用该方法。您对此方法的实现可以调用该`statusBarOrientation`方法来确定设备方向。

(C)[苹果文档：UIViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-08T05:33:56.070

请按照以下步骤操作

*   创建覆盖旋转方法的 UINavigationController 的子类。
*   在 AppDelegate 中，创建一个 BOOL *islandscape*属性。
*   当视图被推送/弹出/呈现/关闭时，调整此 BOOL 值。

## 示例项目

我为此创建了一个示例项目，该项目运行良好。下载并集成到您的项目中：[https ://www.dropbox.com/s/nl1wicbx52veq41/RotationDmeo.zip?dl=0](https://www.dropbox.com/s/nl1wicbx52veq41/RotationDmeo.zip?dl=0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-13T01:16:23.677

我有一个：

> TabbarController -> NavigationController -> ViewController -> ViewController

我子类化`UITabBarController`并添加....

```
-(NSUInteger)supportedInterfaceOrientations{
    if (self.selectedIndex >= 0 && self.selectedIndex < 100) {
        for (id vC in [[self.viewControllers objectAtIndex:(unsigned long)self.selectedIndex] viewControllers]) {
            if ([vC isKindOfClass:[CLASS_WHICH_SHOULD_ALLOW class]]) {
                return UIInterfaceOrientationMaskPortrait + UIInterfaceOrientationMaskLandscape;
            }
        }
    }

    return UIInterfaceOrientationMaskPortrait;
}
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-31T11:47:19.983

我一直在寻找解决方案几个小时！

因此，在到处实施所需的方法之后。`shouldAutorotate`不需要设置，`YES`因为它已经设置为默认值：

```
- (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskPortrait;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
     return UIInterfaceOrientationPortrait;
} 
```

当需要显示`UIViewController`哪个需要与其他视图不同的方向时，我在`UIStoryboardSegue`内部创建了一个具有此实现的：

```
#import "Showing.h"

@implementation Showing

- (void)perform{
    NSLog(@"Showing");
    UIViewController *sourceVC = self.sourceViewController;
    UIViewController *presentingVC = self.destinationViewController;

    [sourceVC.navigationController presentViewController:presentingVC 
                                                animated:YES 
                                              completion:nil];
}

@end 
```

在里面，`UIStoryboard`我将视图与这个 segue 连接起来（**显示**）：

![在此处输入图像描述](../Images/72628265d8fb2afd3798a9c2201751b8.png)

这很重要，您正在使用

```
presentViewController:animated:completion: 
```

**并不是**

```
pushViewController:animated: 
```

否则将无法再次确定方向。

* * *

我一直在尝试像

```
[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait]; 
```

**或者**这个在方向应该改变的地方，我也试着在我的自定义之前`UIViewController`调用它：`UIStoryboardSegues``presentingViewController``dismissViewController`

```
[UIViewController attemptRotationToDeviceOrientation]; 
```

**或者**

```
NSNumber *numPortrait = [NSNumber numberWithInt:UIInterfaceOrientationPortrait];
[[UIDevice currentDevice] setValue:numPortrait forKey:@"orientation"]; 
```

但没有一个人工作。当然最后一个例子不应该是一个选项，因为如果苹果会改变他们的任何 api 这可能会导致你的应用程序内部出现问题。

我也尝试使用该`AppDelegate`方法，并在寻找`UIInterfaceOrientation`实际的正确方向后始终确定该方法内部的方向，`visibleViewController`但有时在从一个方向切换到另一个方向时会发生崩溃。所以我仍然想知道为什么它变得如此复杂，而且似乎也没有任何文档可以正确解释它。即使遵循[这部分也对我没有帮助](http://bit.ly/supportMultiInterfaceOrientation)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-02T08:34:18.837

UIViewController+OrientationPermissions.h

```
@interface UIViewController (OrientationPermissions)
   + (void)setSupportedOrientations:(UIInterfaceOrientationMask)supportedOrientations;
   + (UIInterfaceOrientationMask)supportedOrientations;
@end 
```

UIViewController+OrientationPermissions.m

```
@implementation UIViewController (OrientationPermissions)
static UIInterfaceOrientationMask _supportedOrientations;

+ (void)setSupportedOrientations:    (UIInterfaceOrientationMask)supportedOrientations {
    _supportedOrientations = supportedOrientations;
}

+ (UIInterfaceOrientationMask)supportedOrientations {
    return _supportedOrientations;
}

@end 
```

在您的 UIApplication 委托中

```
- (UIInterfaceOrientationMask)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window {
    return [UIViewController supportedOrientations];
} 
```

然后在所需的视图控制器上执行类似的操作

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [UIViewController setSupportedOrientations:UIInterfaceOrientationMaskAll];
} 
```

在离开这个视图控制器之前不要忘记重置掩码

请注意，如果您使用的是 UINavigationController 或 UITabBarController，请参阅[https://stackoverflow.com/a/28220616/821994](https://stackoverflow.com/a/28220616/821994)如何绕过它

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-01-31T07:06:14.960

挑战工作请尝试。2天后解决

//AppDelegate.m - 不幸的是，此方法在 iOS6 之前不可用

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window{
NSUInteger orientations = UIInterfaceOrientationMaskAllButUpsideDown;

if(self.window.rootViewController){
    UIViewController *presentedViewController = [[(UINavigationController *)self.window.rootViewController viewControllers] lastObject];
    orientations = [presentedViewController supportedInterfaceOrientations];
}

return orientations;
} 
```

//MyViewController.m - 返回你想为每个 UIViewController 支持的任何方向

```
- (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskPortrait;
} 
```

# assembly - IDA Pro 变量声明

> ID：12772753
> 
> 赞同：1
> 
> 时间：2012-10-07T20:50:28.280
> 
> 标签：assembly, reverse-engineering, ida

我对 x86 汇编和逆向工程非常陌生，并且对我通过 IDA 获得的这段代码有疑问：

```
; LRESULT __stdcall WndProc(HWND, UINT, WPARAM, LPARAM, UINT_PTR, DWORD_PTR)
WndProc proc near

Rect= tagRECT ptr -34h
var_24= dword ptr -24h
var_20= dword ptr -20h
var_1C= dword ptr -1Ch
var_18= dword ptr -18h
prc= RECT ptr -14h
var_4= dword ptr -4
hWnd= dword ptr  8
uMsg= dword ptr  0Ch
wParam= dword ptr  10h
lParam= dword ptr  14h 
```

我是否正确 var_18、var_1C 和 var_20 实际上指向 prc.top、prc.right 和 prc.bottom？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:52:01.663

不; 如果`prc`是一个`RECT`实例，则它占用*以下*16 个字节的内存（因此偏移量 -14 到 -5 包括在内，四个 32 位字）。

# iphone - iOS - 类中的这个声明是否正确？

> ID：12772755
> 
> 赞同：4
> 
> 时间：2012-10-07T20:50:59.003
> 
> 标签：iphone, ios, cocoa-touch, ipad

假设我正在创建一个名为 myTextView 的 UITextView 子类。我将使该课程成为自己的代表。所以，我需要实现委托方法，比如

```
- (void)textViewDidBeginEditing:(UITextView *)textView { 
```

我应该像这样还是这样声明这个方法？

```
- (void)textViewDidBeginEditing:(myTextView *)textView { 
```

在我看来它像递归，因为我在 myTextView 类中，定义了一个引用自身的委托......

什么是正确的方法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T21:01:47.687

只是为了澄清，最好实现协议中定义的方法：

```
 - (void)textViewDidBeginEditing:(UITextView *)textView 
```

如果您使用自定义类类型或任何类类型实现协议方法，这些方法仍将被调用，因为没有执行类型检查。该参数实际上是您的自定义子类。无论如何，再次澄清一下，如果您想处理自定义子类的 ivars，我建议进行内部演员表：

```
- (void)textViewDidBeginEditing:(UITextView *)textView {
    MyTextView * myTextView = (MyTextView *)textView;
    ...
} 
```

# sed - 通过applescript中的sed用撇号文本替换文本

> ID：12772757
> 
> 赞同：3
> 
> 时间：2012-10-07T20:51:05.700
> 
> 标签：sed, applescript, replace

我有一个applescript 来查找和替换一些字符串。前段时间我遇到了一个包含 & 的替换字符串的问题，但可以通过将 \& 放在替换属性列表中来解决它。然而，撇号似乎更烦人。

使用单个撇号会被忽略（替换不包含它），使用 \' 会产生语法错误（预期为“””但发现未知标记。）并且使用 \' 会再次被忽略。（顺便说一句，您可以继续这样做，偶数被忽略 不均匀得到语法错误）

我尝试用双引号替换实际 sed 命令中的撇号（sed "s..." 而不是 sed 's...'），这在命令行中有效，但在脚本中出现语法错误（预期行尾等. 但找到了标识符。）

单引号与 shell 混淆，双引号与 applescript 混淆。

[我还尝试了这里](http://www.linuxquestions.org/questions/linux-general-1/sed-matching-an-apostrophe-439625/)建议的 '\'' 和[这里](https://stackoverflow.com/questions/8002981/using-sed-to-replace-a-string-with-another-string)的 '"'"' 。

获取错误类型的基本脚本：

```
set findList to "Thats.nice"
set replaceList to "That's nice"
set fileName to "Thats.nice.whatever"
set resultFile to do shell script "echo " & fileName & " | sed 's/" & findList & "/" & replaceList & " /'" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T00:18:35.767

尝试：

```
set findList to "Thats.nice"
set replaceList to "That's nice"
set fileName to "Thats.nice.whatever"
set resultFile to do shell script "echo " & quoted form of fileName & " | sed \"s/Thats.nice/That\\'s nice/\"" 
```

或坚持你的例子：

```
set findList to "Thats.nice"
set replaceList to "That's nice"

set fileName to "Thats.nice.whatever"
set resultFile to do shell script "echo " & quoted form of fileName & " | sed \"s/" & findList & "/" & replaceList & "/\"" 
```

## 解释：

sed 语句通常用单引号括起来，如下所示：

```
set myText to "Hello"
set xxx to do shell script "echo " & quoted form of myText & " | sed 's/ello/i/'" 
```

但是，在此示例中，您可以完全排除单引号。

```
set myText to "Hello"
set xxx to do shell script "echo " & quoted form of myText & " | sed s/ello/i/" 
```

一旦包含空格，未引用的 sed 语句就会分解。

```
set myText to "Hello"
set xxx to do shell script "echo " & quoted form of myText & " | sed s/ello/i there/"
--> error "sed: 1: \"s/ello/i\": unterminated substitute in regular expression" number 1 
```

由于您不能在单引号语句中包含撇号（即使您将其转义），您可以将 sed 语句括在双引号中，如下所示：

```
set myText to "Johns script"
set xxx to do shell script "echo " & quoted form of myText & " | sed \"s/ns/n's/\"" 
```

编辑 Lauri Ranta 提出了一个很好的观点，即如果您的查找或替换字符串包含转义的双引号，我的答案将不起作用。她的解决方案如下：

```
set findList to "John's"
set replaceList to "\"Lauri's\""
set fileName to "John's script"
set resultFile to do shell script "echo " & quoted form of fileName & " | sed s/" & quoted form of findList & "/" & quoted form of replaceList & "/" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T19:25:37.750

我也会使用文本项目分隔符。如果以后不使用，您不必包含`AppleScript's`在默认范围内或将属性设置回来。

```
set input to "aasearch"
set text item delimiters to "search"
set ti to text items of input
set text item delimiters to "replace"
ti as text 
```

如果它们可以包含将由 sed 解释的内容，则没有简单的方法可以逃避搜索或替换模式。

```
set input to "a[a"
set search to "[a"
set replace to "b"

do shell script "sed s/" & quoted form of search & "/" & quoted form of replace & "/g <<< " & quoted form of input 
```

如果你必须使用正则表达式，像 Ruby 这样的脚本语言有从字符串创建模式的方法。

```
set input to "aac"
set search to "(a+)"
set replace to "\\1b"

do shell script "ruby -KUe 'print STDIN.read.chomp.gsub(Regexp.new(ARGV[0]), ARGV[1])' " & quoted form of search & " " & quoted form of replace & " <<< " & quoted form of input without altering line endings 
```

# ruby-on-rails - 难以理解神经网络

> ID：12772758
> 
> 赞同：4
> 
> 时间：2012-10-07T20:51:06.923
> 
> 标签：ruby-on-rails, ruby, algorithm, neural-network, fann

我正在尝试使用神经网络来解决问题。我从 Coursera 上提供的机器学习课程中了解到它们，并且很高兴地发现 FANN 是神经网络的 Ruby 实现，因此我不必重新发明飞机。

但是，我真的不明白为什么 FANN 会给我这样奇怪的输出。根据我在课堂上学到的知识，

我有一组匹配结果的训练数据。给玩家一个数字，给他们的对手一个数字，结果是 1 为赢，0 为输。由于不安，数据有点嘈杂，但并非如此。我的目标是找出哪些评分差距更容易引起不安——例如，我的直觉告诉我，评分较低的比赛往往会带来更多的不安，因为评分不太准确。

所以我得到了一个包含大约 100 个示例的训练集。每个示例都是（评级，增量）=> 1/0。所以这是一个分类问题，但我认为它并不适合逻辑回归类型的图表，神经网络似乎更正确。

我的代码开始

```
training_data = RubyFann::TrainData.new(:inputs => inputs, :desired_outputs => outputs) 
```

然后我用

```
network = RubyFann::Standard.new(
  :num_inputs=>2, 
  :hidden_neurons=>[8, 8, 8, 8], 
  :num_outputs=>1) 
```

在课堂上，我了解到一个合理的默认设置是让每个隐藏层具有相同数量的单元。由于我真的不知道如何工作或我正在做什么，所以我选择了默认设置。

```
network.train_on_data(training_data, 1000, 1, 0.15) 
```

最后，我以增量方式检查了一组样本输入评级，并且在每次增量时，增加 delta 直到结果从 > 0.5 切换到 < 0.5，我认为它是大约 0 和大约 1，尽管实际上它们是更像是 0.45 和 0.55。

当我运行一次时，每个输入都给了我 0。我用相同的数据再次运行了两次，得到了负数的减少趋势和正数的增加趋势，与预测完全相反。

我想也许我没有包含足够的功能，所以我添加了 (`rating**2`和`delta**2`)。不幸的是，然后我开始为每次输入获取我的起始增量或最大增量。

我真的不明白为什么我会得到如此不同的结果或 Ruby-FANN 告诉我什么，部分原因是我不了解库，但我怀疑，因为我刚刚开始学习神经网络并且遗漏了一些东西大而明显。我是否没有足够的训练数据，是否需要包含更多功能，问题是什么，我该如何解决它或学习如何做得更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T08:55:02.373

玩一点参数怎么样？起初我强烈推荐只有两层......应该有数学证明它足以解决许多问题。如果你有太多的神经元，你的 NN 将没有足够的时期来真正学习一些东西..所以你也可以玩一些时期以及 gama ..我认为在你的情况下它是 0.15 ..如果你使用更大一点值你的 NN 应该学得快一点（不要害怕尝试 0.3 甚至 0.7），正确的 gama 值通常取决于权重的间隔或输入标准化。

您的 NN 显示出如此不同的结果很可能是因为在每次运行中都有新的初始化，然后有完全不同的网络，它将以与前一个不同的方式学习（不同的权重将具有更高的值，因此 NN 的不同部分将学习相同事物）。

我对这个库不熟悉，我只是在写一些 NN 的经验。希望这些东西会有所帮助..

# python - raw_input 占位符？

> ID：12772766
> 
> 赞同：2
> 
> 时间：2012-10-07T20:51:54.557
> 
> 标签：python

> **可能重复：**
> [显示默认值以在 Python 输入上进行编辑可能吗？](https://stackoverflow.com/questions/2533120/show-default-value-for-editing-on-python-input-possible)

我想`raw_input`要求确认某事。有没有办法在用户输入任何内容之前“输入”文本？例如：

```
>>> x = raw_input('1 = 2\. Correct or incorrect? ', 'correct')
1 = 2\. Correct or incorrect? correct 
```

这可以与`<imput type="text" value="correct">`HTML 相比。文本将自动为用户键入，但如果他们愿意，他们可以添加或删除全部/部分文本。这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:14:24.170

* * *

## **示例 1：**

```
def make_question(question, *answers):
    print question
    print
    for i, answer in enumerate(answers, 1):
        print i, '-', answer

    print
    return raw_input('Your answer is: ') 
```

**测试代码：**

```
answer = make_question('Test to correctness:', 'correct', 'not correct')
print answer 
```

**输出：**

```
Test to correctness:

1 - correct
2 - not correct

Your answer is: correct
correct 
```

* * *

## 示例 2：

```
input = raw_input('Are you sure?: [Y]') # [Y] - YES by default
if input.lower() in ['n', 'no']:
    exit() # or return... 
```

* * *

## **示例 3（更复杂）：**

```
import termios, fcntl, sys, os

def prompt_user(message, *args):
    fd = sys.stdin.fileno()
    oldterm = termios.tcgetattr(fd)
    newattr = termios.tcgetattr(fd)
    newattr[3] = newattr[3] & ~termios.ICANON & ~termios.ECHO
    termios.tcsetattr(fd, termios.TCSANOW, newattr)
    oldflags = fcntl.fcntl(fd, fcntl.F_GETFL)
    fcntl.fcntl(fd, fcntl.F_SETFL, oldflags | os.O_NONBLOCK)

    sys.stdout.write(message.strip())
    sys.stdout.write(' [%s]: ' % '/'.join(args))

    choice = 'N'
    lower_args = [arg.lower() for arg in args]
    try:
        while True:
            try:
                c = sys.stdin.read(1)
                if c.lower() in lower_args:
                    sys.stdout.write('\b')
                    sys.stdout.write(c)
                    choice = c

                if c == '\n':
                    sys.stdout.write('\n')
                    break

            except IOError: 
                pass
    finally:
        termios.tcsetattr(fd, termios.TCSAFLUSH, oldterm)
        fcntl.fcntl(fd, fcntl.F_SETFL, oldflags)

    return choice 
```

用法：

```
print prompt_user('Are you sure?', 'Y', 'N', 'A', 'Q') 
```

在 Unix/Linux 控制台中工作（不是来自 IDE）

# google-app-engine - Rot 13 文本区域

> ID：12772768
> 
> 赞同：1
> 
> 时间：2012-10-07T20:52:12.280
> 
> 标签：google-app-engine

```
import webapp2
import cgi

def escape_html(s):
    return cgi.escape(s, quote = True)

def rot13(s):
    rot13Text = []
    for i in s:
        if ord(i) <= ord('M') or ord(i) <= ord('m'):
            rot13Text.append(chr(ord(i)+13))
        else:
            rot13Text.append(chr(ord(i)-12))
    return rot13Text

form = """
<form method="post">
    What is your birthday?
    <br>
    <label>
        Month
        <input type="text" name="month" value="%(month)s">
    </label>
    <label>
        Day
        <input type="text" name="day" value="%(day)s">
    </label>
    <label>
        Year
        <input type="text" name="year" value="%(year)s">
    </label>
    <div style="color: red">%(error)s</div>
    <br><br>
    <input type="submit">
</form>
"""

rot13Form = """
    <textarea method="post" name = "text" value="%(text)s"></textarea>
    <input type="submit">
"""

months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August',
                        'September', 'October', 'November', 'December']

def valid_day(day):
        if(day and day.isdigit()):
                day = int(day)
        if(day < 32 and day > 0):
                return day

def valid_month(month):
        if(month):
                month = month.capitalize()
        if(month in months):
                return month

def valid_year(year):
        if(year and year.isdigit()):
                year = int(year)
        if(year < 2020 and year > 1980):
                return year

class MainPage(webapp2.RequestHandler):
    def write_form(self, error="", month="", day="", year=""):
        self.response.out.write(form %{"error": error,
                                       "month": escape_html(month),
                                       "day": escape_html(day),
                                       "year": escape_html(year)})

    def get(self):
        self.write_form()

    def post(self):
        user_month = self.request.get('month')
        user_day = self.request.get('day')
        user_year = self.request.get('year')

        month = valid_month(user_month)
        day = valid_day(user_day)
        year = valid_year(user_year)

        if not(month and day and year):
            self.write_form("That doesn't look valid to me, friend.", user_month, user_day, user_year)
        else:
            self.redirect("/thanks")

class ThanksHandler(webapp2.RequestHandler):
    def get(self):
        self.response.out.write("Thanks! That's a totally valid day!")

class Rot13Handler(webapp2.RequestHandler):
    def writeForm(self, text = ""):
        self.response.out.write(rot13Form % {"text" : escape_html(text)}) 
    def get(self):
        self.writeForm()

    def post(self):
        userText = self.request.get('text')
        self.writeForm(rot13(userText))

app = webapp2.WSGIApplication([('/', MainPage),
                              ('/thanks', ThanksHandler),
                              ('/rot13', Rot13Handler)],
                             debug=True) 
```

我正在尝试 rot13 文本区域中的一些文本。我不知道为什么当我点击提交时文本没有改变

# heroku - Heroku 上的 Redis

> ID：12772771
> 
> 赞同：0
> 
> 时间：2012-10-07T20:53:09.247
> 
> 标签：heroku, redis, redistogo

我在 Heroku 上将 Redis 对象与 Redis 一起使用。我在模型上有一个计数器，如下所示：

```
class Performance < ActiveRecord::Base
 include Redis::Objects

 counter :tickets_sold, start: 0
end 
```

从 Heroku 控制台访问这个值也很有效。

```
irb(main):002:0> Performance.last.tickets_sold.value
 Performance Load (3.9ms)  SELECT `performances`.* FROM `performances` ORDER BY `performances`.`id` DESC LIMIT 1
=> 0 
```

我确认 Redis.current 存在：

```
irb(main):003:0> Redis.current 
=> # Redis client v2.2.2 connected to redis://ray.redistogo.com:9023/0 (Redis v2.4.11) 
```

但是，从网站上的模板访问相同的计数器会遇到 Errno::ECONNREFUSED 错误。

```
Connection refused - Unable to connect to Redis on 127.0.0.1:6379 
```

为什么它试图连接到本地 Redis url？在网站上检查 Redis.current 也因上述连接错误而失败。考虑到同样的命令在 Heroku 控制台上运行得很好，我对这里发生的事情有点困惑。我希望有人以前见过这个并且知道如何解决它......

# security - 登录表单中的 CSRF 保护

> ID：12772773
> 
> 赞同：2
> 
> 时间：2012-10-07T20:53:20.043
> 
> 标签：security, symfony, login, csrf

我正在使用 Symfony 2.1 构建一个带有一点登录表单的网站。我正在关注[此](http://symfony.com/doc/current/book/security.html#book-security-form-login)链接上的教程，但我没有看到任何有关 CSRF 保护的部分。但是，[这里](http://symfony.com/doc/current/reference/configuration/security.html)有登录安全性的所有选项，最后我可以清楚地看到应该支持这种类型的保护。我不明白如何使用它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:09:55.320

[在这里](http://symfony.com/doc/current/book/forms.html#csrf-protection)您可以阅读 2.1 版本中有关 CSRF 保护的详细信息

* * *

如果您不为表单使用表单类，则可以简单地使用`csrf_token`函数（不要忘记在那里传递您的意图字符串，默认情况下为空）：

```
<input type="hidden" name="token" value="{{ csrf_token('') }}"> 
```

它[在此处](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Extension/FormExtension.php#L71)定义，默认情况下将执行[此方法](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/FormRenderer.php#L77-84)。

* * *

这些答案可能对您也有用：

[https://stackoverflow.com/a/12054712/970721](https://stackoverflow.com/a/12054712/970721)
[https://stackoverflow.com/a/11632713/970721](https://stackoverflow.com/a/11632713/970721)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T06:22:00.130

没有什么能阻止您创建用于登录的表单类。您需要做的就是告诉登录控制器生成的字段的名称：

```
form_login:
    username_parameter: login[username]
    password_parameter: login[password]
    csrf_parameter:     login[_token] 
```

并将表单的 CSRF 意图设置为`authenticate`：

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults([
        'intention' => 'authenticate',
    ]);
} 
```

# jquery - 将背景图像更改为来自特定父 div 的多个 div

> ID：12772776
> 
> 赞同：3
> 
> 时间：2012-10-07T20:53:35.837
> 
> 标签：jquery

我需要有关 DIV 背景问题的帮助。我想创建一个包含 6 列的价格表脚本：

```
<div id="col1">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
<div>
<div id="col2">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
<div>
.
.
.
.
<div id="col6">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
<div> 
```

我想将背景图像更改为所有带有悬停父级的 div。如果我悬停`div "col6"`，我希望它的所有 div 更改背景图像。请注意，我对所有列使用相同的类，我只需要更改悬停的主 div 中的类。

我找到了这个代码片段，但我不知道如何调整它以适应我的情况（因为我的 javascript 知识非常低）：

```
 $(function() {
    $('.parent').hover( function(){
       $(this).children("div").css('background-color', 'gray');
    },
     function(){
       $(this).children("div").css('background-color', 'red');
    });
 }); 
```

谢谢你，希望一切都有意义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T20:59:21.290

由于您的容器元素没有类属性，您可以使用`attribute starts with`选择器：

```
$(function() {
    $('div[id^=col]').hover(function() {
         $(this).children("div").css('background-image', 'url("heaven.png")');
    }, function() {
         $(this).children("div").css('background-image', 'url("hell.png")');
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T20:59:57.017

您可以使用 CSS 执行此操作，如下所示：

```
#col6:hover div
{
    background-color:#000;
} 
```

请看小提琴：http: [//jsfiddle.net/nTAzk/](http://jsfiddle.net/nTAzk/)

然后你可以给所有的父类添加一个类（比如 .parent-class）并为每一列做一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T21:05:19.453

首先，您需要正确关闭“div”元素：

```
<div id="col6">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
<div> <-- HERE NEED TO BE "</div>" 
```

其次，您可以添加一个类（因此，如果您更改`col[N]`为`foo[N]`您不需要编辑任何脚本。

```
<div id="col1" class="sample-class">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
</div>
<div id="col2" class="sample-class">
  <div class="header"></div>
  <div class="first_line"></div>
  <div class="second_line"></div>
  <div class="footer"></div>
</div> 
```

第三，使用以下代码：

```
$(document).ready(function() {
    $('.sample-class').hover(function(){
        $(this).children('div').css('backgroundColor', 'gray');
    }, function(){
        $(this).children('div').css('backgroundColor', 'red');
    });
}); 
```

见[http://jsfiddle.net/4g2Kj/](http://jsfiddle.net/4g2Kj/)

# ruby-on-rails - RoR：创建测试对象

> ID：12772777
> 
> 赞同：0
> 
> 时间：2012-10-07T20:53:54.807
> 
> 标签：ruby-on-rails, testing

我是 Rails 测试的新手，我有一个问题：假设我的控制器中有一个简单的场景：

```
class UsersController < ApplicationController

  def create
    @user = User.create(params[:user])
    if params[:user][:birth_date]
      Birthday.create(:title => "#{user.first_name} #{user.last_name}'s Birthday!", :date => params[:user][:birth_date].to_date, :user_id => @user.id)
    end
  end

  def update
    @user = User.find(params[:id])
    @user.update_attributes(params[:user])
    if params[:user][:birth_date]
      @birthday = Birthday.find_by_user_id(@user.id)
      @birthday.update_attributes(:date => params[:user][:birth_date].to_date) if @birthday
    end
  end
end 
```

我想测试每次创建用户时都会创建生日事件并且它的属性设置正确。在我的特定（真实）案例中，当创建（或更新）另一个对象时创建（或更新）一个新对象，并且计算并自动设置了许多属性。我需要测试它们是否设置正确。我该如何测试它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:21:42.477

如果您使用的是 Test::Unit 或 RSpec，您可以通过“assigns”方法访问全局变量。例如，您可以使用以下内容：

```
post :update, :id => 1, :user => {:birthdate => '1/1/2000'}
assert_equal Date.new(2000, 1, 1), assigns(:user).birthday.date 
```

您还可以测试数据库是否已正确更新：

```
user = User.find(1)
assert_equal Date.new(2000, 1, 1), user.birthday.date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:09:05.653

### 测试正确的对象

您想测试填充用户数据的对象，或者可能是用户模型中的回调。这通常不是控制器问题，特别是如果您遵循“胖模型，瘦控制器”范例。

在您的特定情况下，您的控制器正在调用生日#update_attributes，但真正的变化发生在其他地方，所以我会在那里测试它们。对于这个特定控制器，唯一真正有用的测试是确保在创建或更新模型数据时不会引发任何问题，但这更像是集成测试而不是单元测试。

# jquery - Jquery ajax返回空白响应

> ID：12772779
> 
> 赞同：-1
> 
> 时间：2012-10-07T20:54:10.283
> 
> 标签：jquery, ajax

此代码返回空白数组。我正在使用代码发布到 PHP 脚本。

PHP：

```
<?php
var_dump($_REQUEST);
?> 
```

jQuery代码：

```
jQuery(document).ready(function($) {
        // --------------------------------------------------------------
        // Submit danasnji dan
        // --------------------------------------------------------------
        $("a#danasnji-submit").click(function(event){
            event.preventDefault();
            var lokacija = $("input#base-url").val()+"/uporabnik/umakniRezervacije";
            var podatki = $("table#danasnji-dan tbody tr.clicked");
            var izbrano = new Array();
            if(confirm("Ali ste prepričani?")){
                podatki.each(function(){
                    izbrano.push($(this).data());
                });
                $.ajax({
                    type : 'POST',
                    url  : lokacija,
                    data : izbrano,
                    success : function(vrnjeno){
                        alert(vrnjeno);
                        $("table#danasnji-dan tbody tr.clicked").each(function(){
                            $(this).fadeOut();
                        });
                    }
                });

            }
        });
    }); 
```

我究竟做错了什么。请问，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:51:18.643

好的，我找到了问题所在。由于我发布到 PHP，脚本必须按名称检索该值。你不能只发布一个没有变量保存的值。

所以，解决方案是这样的。键值对

```
data : {
  'Varible' : 'Value'
} 
```

无论如何感谢您的帮助，
干杯

# javascript - 页面加载时始终打开可折叠菜单

> ID：12772786
> 
> 赞同：2
> 
> 时间：2012-10-07T20:55:54.870
> 
> 标签：javascript, drop-down-menu

我正在使用附加到 HTML 菜单的以下脚本，但它在页面上完全打开加载。单击标题时，整个菜单树会折叠，并按预期打开。

谁能告诉我这里是否有问题？

```
function toggleMenu(objID) {
    if (!document.getElementById) return;
    var i = 1;
    while (document.getElementById('menu' + i)) {
        var ob = document.getElementById('menu' + i).nextSibling;
        ob = ob.style ? ob.style : ob.nextSibling.style;
        if (objID == 'menu' + i) ob.display = (ob.display == 'block') ? 'none' : 'block';
        else ob.display = 'none';
        i++;
    }
}
var i = 1;
while (document.getElementById('menu' + i)) {
    document.getElementById('menu' + i).onclick = new Function("toggleMenu('menu" + i + "')");
    i++
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:24:12.843

您可以使用非 JavaScript 解决方案吗？

像这样：http: [//jsfiddle.net/kboucher/nrAPu/](http://jsfiddle.net/kboucher/nrAPu/)

# c - 阴影三角形上的颜色错误

> ID：12772794
> 
> 赞同：1
> 
> 时间：2012-10-07T20:58:32.327
> 
> 标签：c, colors, geometry, sdl, gfx

我试图画一个阴影三角形，但我得到了错误的颜色。这是我得到的例子，如果我用红色、绿色和蓝色调用一个函数：

![在此处输入图像描述](../Images/3ee2cf89338a9dcee57cc01ee8965448.png)

它应该是左上角的红色，右上角的绿色和底部的蓝色。但正如你所看到的，颜色不是那样的。我应该得到这样的东西：

![在此处输入图像描述](../Images/ca2ce375d4f43a0ee4f433711a9ebc2c.png)

这是代码：

```
unsigned RGB(unsigned char R, unsigned char G, unsigned B){
    return  (R << 16) | (G << 8) | B;
}

    float get_dist(int x1, int y1, int x2, int y2){
            int xproj = x2-x1;
            int yproj = y2-y1;
            float dist = sqrt(pow(xproj, 2) + pow(yproj, 2));
            return dist;
    }
    unsigned char getR(unsigned c){
            return (c >> 16) & 0xFF;
    }
    unsigned char getG(unsigned c){
            return (c >> 8) & 0xFF;
    }
    unsigned char getB(unsigned c){
            return c & 0xFF;
    }
    void draw_ftriangle(SDL_Surface * s, int x0, int y0, unsigned c0, int x1, int y1, unsigned c1, int x2, int y2, unsigned c2){
            int x;
            signed d0, d1, d2;
            unsigned R, G, B, color;
            int ymin = min(y0, min(y1, y2));
            int xmin = min(x0, min(x1, x2));
            int ymax = max(y0, max(y1, y2));
            int xmax = max(x0, max(x1, x2));
            draw_line(s, x0, y0, x1, y1, color);
            draw_line(s, x1, y1, x2, y2, color);
            draw_line(s, x0, y0, x2, y2, color);
            for(; ymin < ymax; ymin++)
                    for(x=xmin; x < xmax; x++)
                            if(ptintr(x, ymin, x0, y0, x1, y1, x2, y2)){
                                    d0 = get_dist(x, ymin, x0, y0);
                                    d1 = get_dist(x, ymin, x1, y1);
                                    d2 = get_dist(x, ymin, x2, y2);
                                    R = d0+d1+d2 == 1 ? getR(c0)*d0 + getR(c1)*d1 + getR(c2)*d2 :
                                                                             (getR(c0)*d0 + getR(c1)*d1 + getR(c2)*d2)/(d0+d1+d2);
                                    G = d0+d1+d2 == 1 ? getG(c0)*d0 + getG(c1)*d1 + getG(c2)*d2 :
                                                                            (getG(c0)*d0 + getG(c1)*d1 + getG(c2)*d2)/(d0+d1+d2);
                                    B = d0+d1+d2 == 1 ? getB(c0)*d0 + getB(c1)*d1 + getB(c2)*d2 :
                                                                            (getB(c0)*d0 + getB(c1)*d1 + getB(c2)*d2)/(d0+d1+d2);
                                    color = RGB(R, G, B);
                                    put_pixel(s, x, ymin, color);
                            }
    } 
```

我像这样调用函数drraw_ftriangle：

draw_ftriangle(表面, 100, 100, RGB(255, 0, 0), 235, 150, RGB(0, 255, 0), 4, 254, RGB(0, 0, 255));

我不确定，但我认为问题应该在这里：

```
R = (d0+d1+d2) == 1 ? getR(c0)*d0 + getR(c1)*d1 + getR(c2)*d2 :
                      (getR(c0)*d0 + getR(c1)*d1 + getR(c2)*d2)/(d0+d1+d2); 
```

与 G 和 B 变量相同...

我希望其他人解释我，问题出在哪里，因为我整天都在寻找它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:03:46.467

您的函数的`R`and`G`参数是，并且您不会在转移之前将它们转换为。这意味着，您正在移动一个 8 位数字。你知道会发生什么...`RGB``unsigned char``unsigned int`

因此，`unsigned int`在移位之前将参数转换为或强制转换值。

PS：不管你做什么，如果你把所有三个参数都设置成相同的类型就好了！

正如在评论中，原来是这样的：

> 所以我不认为你的 (x,y) 坐标在 get_dist 函数中被标准化。你计算连接这两个向量的斜边的长度，但你没有给它任何基本长度来标准化。

# c# - 未渲 染的 3d 对象

> ID：12772795
> 
> 赞同：9
> 
> 时间：2012-10-07T20:58:41.070
> 
> 标签：c#, wpf, 3d

我有一个具有主窗口的 WPF 应用程序。在那我有一个框架，框架内容是一个页面。

现在页面中有 4 个 viewport3D，其中包含 Viewport2DVisual3D 并且我有图像元素。

**问题：**在某些 PC 上，我的应用程序运行良好，但在某些 PC 上，我的应用程序不渲染 viewport3d 或不渲染框架。不知道，但它在主窗口中没有显示任何内容。

该问题发生在 Acer 笔记本电脑[型号](http://www.acer.co.uk/ac/en/GB/content/model/LX.RAZ02.097)上。

渲染： ![真实影像](../Images/995ef35e9882dffb3177520c5a02be69.png)

未渲​​染： ![在此处输入图像描述](../Images/e55e39db000fb3f9b38335b007585b6e.png)

编辑：当我将框架放在网格中时，再次出现此问题。（我在一个框架中显示此页面，该框架是我窗口的主要内容：当我将框架放置在网格中时，它没有显示对象）似乎这发生在具有共享图形的笔记本电脑上

编辑2：

```
<Page x:Class="MainPage"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              Loaded="Page_Loaded_1"
        x:Name="myMainPage" FlowDirection="RightToLeft"  >

    <Page.Resources>

        <Style  TargetType="ContentControl" x:Key="MenuItemsStyle">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>

                        <Viewport3D VerticalAlignment="Stretch" HorizontalAlignment="Stretch" ClipToBounds="False">
                            <Viewport3D.Camera>
                                <PerspectiveCamera x:Name="myCam" FieldOfView="90" Position="{Binding ElementName=myMainWindow, Path=CameraHeight}" NearPlaneDistance="1" FarPlaneDistance="10"/>
                            </Viewport3D.Camera>

                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <Model3DGroup>
                                        <DirectionalLight Color="#FFFFFFFF" Direction="0,0,-1"/>
                                    </Model3DGroup>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>

                            <Viewport2DVisual3D x:Name="V2d3d">

                                <Viewport2DVisual3D.Transform>
                                    <Transform3DGroup>
                                        <RotateTransform3D >
                                            <RotateTransform3D.Rotation>
                                                <AxisAngleRotation3D Axis="0,1,0" Angle="0" x:Name="aar3D"/>
                                            </RotateTransform3D.Rotation>
                                        </RotateTransform3D>
                                    </Transform3DGroup>
                                </Viewport2DVisual3D.Transform>

                                <Viewport2DVisual3D.Material>
                                    <DiffuseMaterial Viewport2DVisual3D.IsVisualHostMaterial="True" Brush="White"/>
                                </Viewport2DVisual3D.Material>
                                                              <Viewport2DVisual3D.Geometry>
                                    <MeshGeometry3D Positions="{Binding   ElementName=myMainWindow, Path=MeshPosions}"
                            TextureCoordinates="0,0 0,1 1,1 1,0" TriangleIndices="0 1 2 0 2 3"/>
                                </Viewport2DVisual3D.Geometry>
                                <Border Name="mainBorder" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderThickness" Value="1.2"/>
                                            <Setter Property="Background" >
                                                <Setter.Value>
                                                    <SolidColorBrush Color="Transparent"/>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="BorderBrush" >
                                                <Setter.Value>
                                                    <SolidColorBrush Color="Transparent"/>
                                                </Setter.Value>
                                            </Setter>
                                                                              </Style>
                                    </Border.Style>
                                    <ContentPresenter VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                                                      Content="{TemplateBinding ContentControl.Content}">
                                        <ContentPresenter.Triggers>
                                            <EventTrigger RoutedEvent="ContentPresenter.MouseLeftButtonDown">
                                              // Axis Animation
                                            </EventTrigger>
                                        </ContentPresenter.Triggers>
                                    </ContentPresenter>
                                </Border>
                            </Viewport2DVisual3D>
                        </Viewport3D>

                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <EventTrigger RoutedEvent="ContentControl.MouseLeftButtonDown" >
                  //Axis Animation
                </EventTrigger>
                <EventTrigger RoutedEvent="ContentControl.MouseEnter">
                   //ScaleAnimation
                               </EventTrigger>
                <EventTrigger RoutedEvent="ContentControl.MouseLeave">
                   //ScaleAnimation
                </EventTrigger>
            </Style.Triggers>
        </Style>

    </Page.Resources>

    <Page.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            //Load Object Scale And Fade In
        </EventTrigger>
    </Page.Triggers>

    <Grid Name="MainGrid">

                 <Canvas Name="MainCanvas" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" FlowDirection="LeftToRight">
            <ContentControl Opacity="0" Name="MenuItem1" Style="{StaticResource MenuItemsStyle}" 
                            MouseDown="MenuItem1_MouseDown" Panel.ZIndex="1" >
                <Image Source="/IsargaranProject;component/Images/isargari.jpg"/>
                <ContentControl.RenderTransform>
                    <ScaleTransform ScaleX="0.7" ScaleY="0.7"  x:Name="MenuItem1ST"/>
                </ContentControl.RenderTransform>
            </ContentControl>
        </Canvas>

    </Grid>
</Page> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T13:24:49.543

如果您使用的是 OPENGL 或 DirectX3D，请查看未渲染的笔记本电脑，将缺少一些插件，例如 DirectX 3D 不会安装或 OpenGL，您可以尝试这两个 3D 渲染工具。我试过这个过去我制作了一个图形程序，它遇到了同样的问题，但是当我安装 OPENGL 和 DirectX3D 时它工作正常！

# android - andengine - 我怎样才能得到场景的孩子？

> ID：12772802
> 
> 赞同：0
> 
> 时间：2012-10-07T20:59:24.517
> 
> 标签：android, andengine

我需要让我的场景的孩子。我正在使用 andengine 并且试图以某种方式保存游戏状态，但我真的不想将我的对象放入数组中，在创建关卡时，我想在需要时获取这些项目。所以 - 问题是 - 有什么办法，我可以得到场景的孩子吗？如果是这样，该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T22:50:27.813

你可以使用`yourScene.getChildCount()`和`yourScene.getChildByIndex()`遍历事物

# content-type - mod_proxy 覆盖内容类型标头

> ID：12772807
> 
> 赞同：2
> 
> 时间：2012-10-07T20:59:56.610
> 
> 标签：content-type, apache, mod-proxy

我正在尝试在 tomcat (6.0.35) 实例前使用 mod_proxy (apache 2.2)。我的 apache 配置中有这个：

ProxyPass /Touchpad/ ajp://10.10.6.1:8010/Touchpad/

客户端正在尝试发布多部分表单，我看到正确的标题出现在 apache 端，但它被重写为 text/plain。

我确实将 DefaultType 设置为全局文本/纯文本，但不明白为什么这可能会覆盖来自客户端的真实内容类型。

有任何想法吗？

# c# - XNA C# 可破坏地形

> ID：12772808
> 
> 赞同：2
> 
> 时间：2012-10-07T21:00:10.603
> 
> 标签：c#, xna, 2d, textures, terrain

我目前正在开发一款玩家可以破坏地形的游戏。`SetData`不幸的是，在我的地形纹理上使用该方法后，我得到了这个异常：

> 在 GraphicsDevice 上主动设置资源时，您不能在资源上调用 SetData。在调用 SetData 之前从设备取消设置它。

现在，在有人说这个问题还有其他主题之前，我已经看过所有这些了。他们都说要确保不要在 中调用该方法`Draw()`，但`Update()`无论如何我只使用它。这是我目前用来破坏地形的代码：

```
public class Terrain
{
    private Texture2D Image;

    public Rectangle Bounds { get; protected set; }

    public Terrain(ContentManager Content)
    {
        Image = Content.Load<Texture2D>("Terrain");
        Bounds = new Rectangle(0, 400, Image.Width, Image.Height);
    }

    public void Draw(SpriteBatch spriteBatch)
    {

        spriteBatch.Draw(Image, Bounds, Color.White);

    }

    public void Update()
    {
        if (Globals.newState.LeftButton == ButtonState.Pressed)
        {
            Point mousePosition = new Point(Globals.newState.X, Globals.newState.Y);

            if(Bounds.Contains(mousePosition))
            {
                Color[] imageData = new Color[Image.Width * Image.Height];
                Image.GetData(imageData);

                for (int i = 0; i < imageData.Length; i++)
                {
                    if (Vector2.Distance(new Vector2(mousePosition.X, mousePosition.Y), GetPositionOfTextureData(i, imageData)) < 20)
                    {
                        imageData[i] = Color.Transparent;

                    }
                } 
            Image.SetData(imageData);   
            }
        }
    }

    private Vector2 GetPositionOfTextureData(int index, Color[] colorData)
    {
        float x = 0;
        float y = 0;

        x = index % 800;
        y = (index - x) / 800;

        return new Vector2(x + Bounds.X, y + Bounds.Y);
    }
} 
```

}

每当鼠标点击地形时，我想将图像中 20 像素半径内的所有像素更改为透明。`GetPositionOfTextureData()`所做的只是返回一个包含`Vector2`纹理数据中像素位置的值。

所有帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:13:43.287

您必须通过调用以下方法将您的纹理与 GraphicsDevice 解除绑定：

```
 graphicsDevice.Textures[0] = null; 
```

在尝试通过 SetData 写入之前。

# php - 遍历数组，在数组内做一些计算，然后创建新数组并合并回原来的数组

> ID：12772809
> 
> 赞同：0
> 
> 时间：2012-10-07T21:00:21.850
> 
> 标签：php, multidimensional-array, foreach

尝试这样做有一些困难。我正在获取所有提交的数组，它们以这样的数组返回：

```
Array
(
    [0] => Array
        (
            [Submission] => Array
                (
                    [user_id] => 2
                    [title] => This is a test, only a test
                    [source] => http://www.testing.com
                    [slug] => this-is-a-test-only-a-test
                    [category] => misc
                    [created] => 2012-10-05 03:43:11
                    [id] => 110
                )

            [SubmissionsVote] => Array
                (
                    [0] => Array
                        (
                            [id] => 336
                            [user_id] => 2
                            [submission_id] => 110
                            [vote_type] => up
                        )

                )
                (
                    [1] => Array
                        (
                            [id] => 337
                            [user_id] => 4
                            [submission_id] => 110
                            [vote_type] => down
                        )

                )
        )
) 
```

我的意图是遍历返回的数组，并通过`vote_type`==`up`和`vote_type`==获取所有 SubmissionsVote `down`。

然后我想计算一个分数（这个例子将返回一个分数，`0`它只是：`up`- `down`。有了这个，我想将该分数放入一个数组中并将其附加到原始数组的末尾，因此它看起来像：

```
Array
(
    [0] => Array
        (
           [Submission] => Array
                (
                    [user_id] => 2
                    [title] => This is a test, only a test
                    [source] => http://www.testing.com
                    [slug] => this-is-a-test-only-a-test
                    [category] => misc
                    [created] => 2012-10-05 03:43:11
                    [id] => 110
                )

            [SubmissionsVote] => Array
                (
                    [0] => Array
                        (
                            [id] => 336
                            [user_id] => 2
                            [submission_id] => 110
                            [vote_type] => up
                        )

                )
                (
                    [1] => Array
                        (
                            [id] => 337
                            [user_id] => 4
                            [submission_id] => 110
                            [vote_type] => down
                        )

                )
        [SubmissionScore] => Array
        (
             [0] => 0
        )
        )
) 
```

这是我没有成功的做法：

```
 $votes = array();
    $totalScore = array();

    foreach ($submissions as $submission) {
        $vote = $submission['SubmissionsVote'];
        array_push($votes, $vote);
    }   

    for ($i = 0; $i < count($votes); $i++) {
        $downVotes = 0;
        $upVotes = 0;

        if ($votes[$i]['vote_type'] == 'down') {
            $downVotes += 1;
        } else if ($votes[$i]['vote_type'] == 'up') {
            $upVotes += 1;
        }   

        $score = $upVotes - $downVotes;
        $totalScore = array_push($totalScore, $score);
    } 
```

很想在这里朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:32:28.000

试试这个：

```
$newSubmissions = array();

foreach ($submissions as $submission) {
    $SubmissionsVote = $submission['SubmissionsVote'];

    foreach($SubmissionsVote as $votes) {
        $score = 0;
         if ($votes['vote_type'] == 'down') {
            $score -= 1;
        } else if ($votes['vote_type'] == 'up') {
            $score += 1;
        }   
        $submission['SubmissionScore'] = array($score);
    }
    $newSubmissions[] = $submission;

}

$submissions = $newSubmissions; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T21:29:40.067

您正在循环内初始化 $downVotes 和 $upVotes，这意味着您每次遍历数组时都会覆盖值。

无论如何，您可以简化这一点。

```
foreach ($submissions as $index => $submission) {
    $up = 0;
    $down = 0;
    foreach ($submission['SubmissionsVote'] as $vote) {
        if ($vote['vote_type'] == 'up') {
            $up++;
        } else {
            $down++;
        }
    }
    $submissions[$index]['SubmissionScore'] = $up - $down;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T21:29:52.953

我在您的代码中看到至少两个错误：

*   你从来没有`SubmissionScore`在你的数组中设置`$totalScore`值。
*   即使你添加一个`$votes[$i]['SubmissionScore'] = $totalScore`，那也不起作用，在 PHP 中只有对象是通过引用传递的，所以`$votes`只会包含副本。

有多种解决问题的可能性，但[在 foreach 中的参考](http://php.net/manual/en/control-structures.foreach.php)是一个不错的选择：

```
foreach ($submissions as &$submission) {
    $totalScore = 0;
    foreach ($submission['SubmissionsVote'] as $vote) {
        if ($vote['vote_type'] == 'down') {
            $totalScore--;
        } else if ($vote['vote_type'] == 'up') {
            $totalScore++;
        }
    }
    $submission['SubmissionScore'] = $totalScore;
} 
```

现在，每个提交都会有一个`SubmissionScore`基于赞成/反对的投票。

# c - C中的分段错误，malloc数组

> ID：12772811
> 
> 赞同：1
> 
> 时间：2012-10-07T21:00:39.980
> 
> 标签：c

我的学校项目有问题，正在测试此构建的服务器返回此错误：

```
./__runscript: line 2: 489 Segmentation fault ./a.out < __input 
```

编译是可以的，但是刚开始运行时就会显示这个错误。但是，如果我在带有 Visual Studio 10 的 Windows 7 上运行它，一切都很好。我认为错误可能出在 insert() 函数中。

```
POSTUP *insert(POSTUP *first)
{
    POSTUP* current,*pom;
    current=(POSTUP*)malloc(sizeof(POSTUP));
    pom=(POSTUP*)malloc(sizeof(POSTUP));
    int i,count_of_elements;

    scanf("%d", &count_of_elements);

    if(first==NULL)
    {
        first=current;
        first->array= (int*)malloc(count_of_elements*sizeof(int));
        for(i=0; i<count_of_elements; i++)
        {
            scanf("%d",&first->array[i]);
        }
        first->elements=count_of_elements;
        first->next=NULL;
        return first;
    }
    else
    {
        pom->array= (int*)malloc(count_of_elements*sizeof(int));
        for(i=0; i<count_of_elements; i++)
        {
            scanf("%d",&pom->array[i]);
        }
        pom->next=NULL;
        pom->elements=count_of_elements;
        current=first;
        while(1)
        {
            if(current->next==NULL)
            {
                current->next=pom;
                return first;
            }   
        }
    }
    return 0;
}
int main(void)
{
    int count, i;
    POSTUP* first,*current;
    first= (POSTUP*)malloc(sizeof(POSTUP));
    first=NULL;

    scanf("%d",&count);
    for(i=0; i<count; i++)
    {
        first=insert(first);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:30:52.497

此代码在`main()`：

```
POSTUP *first, *current;
first = (POSTUP*)malloc(sizeof(POSTUP));
first = NULL;

scanf("%d", &count);
for (i = 0; i < count; i++)
{
    first = insert(first);
} 
```

显然是有问题的。您分配空间并将唯一指向它的指针存储在`first`; 然后你覆盖指针，泄漏内存。您应该正式检查分配不为空。但是您的`insert()`代码可以处理空指针作为输入，因此 main 中的内存分配是多余的。

在`insert()`中，您分配内存而不检查是否成功；这是一个麻烦的秘诀，尽管通常是迟到而不是早。

您的代码从不检查`scanf()`;的结果 这意味着如果数据中存在格式错误，您可能会将垃圾放入系统中。

**崩溃的可能原因：**在“if (first == NULL) `block in`insert()”中，您有：

```
 for(i=0; i<count_of_elements; i++)
    {
        scanf("%d", &prvy->array[i]);
    } 
```

您显示的代码中看不到声明`prvy`；`&first->array[i]`无论如何，它几乎肯定是指的。这很容易导致崩溃。否则，您已经小心地将数据存储在与您想象的不同的内存集中，因此数组 for`first`是未初始化的乱码。

相同的代码不使用`pom`，因此您在这部分代码中泄漏了内存。

在 中的主要`else`子句中`insert()`，您用 覆盖`current`（其中包含内存分配）`first`，从而也在那里泄漏内存。

在您将要使用它之前不要分配内存。

# python - 如何自定义这个扭曲的代码？

> ID：12772812
> 
> 赞同：2
> 
> 时间：2012-10-07T21:00:47.480
> 
> 标签：python, twisted

我是 python 的新手，甚至是 twisted 的新手。我正在尝试使用twisted 来下载几十万个文件，但在尝试添加错误反馈时遇到了麻烦。如果下载失败，我想打印错误的 url。为了抛出错误，我故意拼错了我的一个网址。但是，我刚刚挂起的代码并且 python 没有完成（如果我删除 errback 调用，它会很好地完成）。

另外，如何单独处理每个文件？据我了解，当一切完成时，就会调用“完成”。我想在下载每个文件时对其进行 gzip 压缩，以便将其从内存中删除。

这是我所拥有的：

```
 urls = [
 'http://www.python.org', 
 'http://stackfsdfsdfdsoverflow.com', # misspelled on purpose to generate an error
 'http://www.twistedmatrix.com', 
 'http://www.google.com',
 'http://launchpad.net',
 'http://github.com',
 'http://bitbucket.org',
]

def finish(results):
    for result in results:
        print 'GOT PAGE', len(result), 'bytes'
    reactor.stop() 
def print_badurls(err):
    print err # how do I just print the bad url????????

waiting = [client.getPage(url) for url in urls]
defer.gatherResults(waiting).addCallback(finish).addErrback(print_badurls)

reactor.run() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T23:18:39.777

欢迎来到 Python 和 Twisted！

您粘贴的代码存在一些问题。我会一次过一个。

首先，如果您确实想下载数千个 url，并且`urls`列表中有数千个项目，那么这一行：

```
waiting = [client.getPage(url) for url in urls] 
```

会引起问题。您想尝试同时下载列表中的每个页面吗？默认情况下，一般情况下，您在 Twisted 中执行的操作是同时发生的，因此此循环会`urls`立即开始下载列表中的每个 URL。这很可能是行不通的。您的 DNS 服务器将丢弃一些域查找请求，您的 DNS 客户端将丢弃一些域查找响应。TCP 连接尝试到您返回的任何地址都将竞争任何仍然可用的网络资源，其中一些会超时。其余的连接将全部流淌，在数十个甚至数百个不同的下载之间共享可用带宽。

相反，您可能希望将并发程度限制为一次下载 10 或 20 次。不久前，我在我的博客上写了[一种方法。](http://as.ynchrono.us/2006/05/limiting-parallelism_22.html)

其次，`gatherResults`返回 a `Deferred`，只要任何*一个* `Deferred`传递给它就会触发失败并触发。因此，一旦任何一个`client.getPage(url)`失败 - 可能是因为我上面提到的问题之一，或者可能是因为域已过期，或者 Web 服务器恰好关闭，或者只是因为不幸的瞬态网络状况，将`Deferred`返回`gatherResults`失败。 `finish`将被跳过，`print_badurls`并将被调用，并带有描述单个失败`getPage`调用的错误。

要处理来自单个 HTTP 请求的失败，请将回调和 errbacks 添加到调用`Deferred`返回的 s 中`getPage`。添加这些回调和 errbacks 后，您可以使用`defer.gatherResults`等待所有下载*和*下载结果的处理完成。

第三，您可能需要考虑为此使用更高级别的工具[——scrapy](http://scrapy.org/)是一个网络爬虫框架（基于 Twisted），它为此类应用程序提供了许多很酷且有用的助手。

# java - Java - 如何将对象异步保存到数据库？

> ID：12772819
> 
> 赞同：2
> 
> 时间：2012-10-07T21:01:51.950
> 
> 标签：java, database, asynchronous, persistence

> **可能重复：**
> [Java：异步数据库写入的任务执行器？](https://stackoverflow.com/questions/5288759/java-taskexecutor-for-asynchronous-database-writes)

我在内存中有一个数据对象映射，我需要能够非常快速地对其进行读写。我希望这些对象在进程重新启动时保持不变，因此我希望将它们存储在数据库中。

由于我不希望任何数据库插入或更新会减慢我的运行时间，因此我希望它们立即在内存中完成，然后与数据库异步完成。（如果进程崩溃并且丢失了一点数据，我什至可以接受。）

是否有“开箱即用”具有这种能力的 Java 工具（最好是开源的）？这可以用 Hibernate 轻松完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T22:00:13.853

正如我在评论中所说，如果您需要异步写入并且不想使用休眠或 ehcache：

1.  **Runnable**：在 Java 中实现异步处理的唯一方法是通过扩展 Runnable 的简单类：

    ```
    public class AsyncDatabaseWriter implements Runnable {
         private LinkedBlockingQueue<Data> queue = ....
         private volatile boolean terminate = false;
         public void run() {
             while(!terminate) {
                Data data = queue.take();
                // write to database
             }
         }
         public void ScheduleWrite(Data data) {
             queue.add(data);
         }
     } 
    ```

    还在这里说明：[Java：用于异步数据库写入的任务执行器？](https://stackoverflow.com/questions/5288759/java-taskexecutor-for-asynchronous-database-writes)

2.  **分布式工作人员**：如果您想在系统中引入更多移动部件，那么您可以尝试 java 替代分布式任务队列，如[celery](http://celeryproject.org/)：[hazelcast](https://github.com/hazelcast/hazelcast/)或[octobot](https://github.com/cscotta/Octobot)。这将需要一个消息层，其间将充当队列，并且工作人员将为您完成写入数据库的任务。这看起来有点矫枉过正，但又取决于您的用例和您想要使用应用程序的规模。我做了一些非常相似的事情，我有一个用例以异步方式写入 DB，所以我选择了 celery (python)。示例实现可以在这里找到：[artemis](https://github.com/utkarsh2012/artemis)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:08:34.137

考虑使用缓存后写入，例如在[EhCache](http://ehcache.org/documentation/recipes/writebehind)中：

> [...] 将数据写入缓存，而不是将数据同时写入数据库，后写缓存将更改的数据保存到队列中，并让后端线程稍后进行写入。因此，缓存写入过程可以在不等待数据库写入的情况下继续进行，从而更快地完成。任何已更改的数据最终都可以持久化到数据库中。同时，从缓存中读取的任何内容仍将获得最新数据。

不幸的是，我不知道 write behind 如何以及是否与 Hibernate 集成（不这么认为）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T21:10:51.280

在hibernate中，您选择何时将数据持久化到数据库中，您主要使用`proxy`对象（您可以在内存中保存和操作），并且`save`每当您想在数据库中插入或更新时调用方法。

# java - 如何在 Java 中为 MVC 模型实现撤消/重做？

> ID：12772821
> 
> 赞同：2
> 
> 时间：2012-10-07T21:02:18.680
> 
> 标签：java, swing, model-view-controller, undo-redo

我无法理解使用 UndoManager 的撤消/重做功能，并将其与 MVC 模型集成。

我不确定将各种方法放在哪里（在模型、视图或控件中），我仍然不确定如何使用撤消管理器。

我的控件类实现 UndoableEditListener 它创建：

```
private UndoManager manager = new UndoManager(); 
```

并在：

```
public void actionPerformed(ActionEvent e) {
   if (e.getActionCommand().equals("Undo")) {    
      try {
          manager.undo();   
      } catch (CannotUndoException ex) { 
          ex.printStackTrace(); 
      }
   }
} 
```

* * *

我理解到这里，但其余的我不知道该怎么做。我知道我必须在模型和视图类中添加更多内容，但不确定在哪里。我必须有以下课程吗？

```
public class UndoAction extends AbstractAction {}

public void undoableEditHappened(UndoableEditEvent e) { 
```

我只是在文本字段中放置一个整数，然后我希望能够撤消它。我在视图类的文本字段中设置了数字。我想以最简单的方式实现这一点，没有花哨的编码！这是我 assg 的一小部分，但我就是不能让它工作！！

==================================================== ======== 这是我的代码的更详细描述，也许它会有所帮助：

我有一个模型、视图和控制包。

控制有：ButtonGUIControl.java，它实现了两者

```
 ActionListener and 
    UndoableEditListener.

    final UndoManager manager = new UndoManager(); 
```

在 actionPerformed 方法中，它调用

```
 if (e.getActionCommand().equals("Undo")){

             try {

                    manager.undo();
                } 
```

并在：

```
 public void undoableEditHappened(UndoableEditEvent evt) {
          manager.addEdit(evt.getEdit()); 
```

}

在视图中：扩展 JTextField 的 Grid.java 将在需要在 GUI 上显示数字的任何位置添加以下内容：（模型只是我的模型类的一个实例）

```
 getDocument().addUndoableEditListener(new ButtonGUIControl(model)); 
```

可能是因为 UndoManager 是在不同的包中创建的吗？我真的不知道如何调试这个了！！

如果有帮助，我可以发布我的整个代码。我想我不确定如何将它与我的 mvc 模型结构集成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:55:30.970

退后一秒。这里的整个想法是用户将使用您的应用程序并对某些内容进行一系列更改。文本编辑器就是一个很好的例子。您可以插入字符和行，再次删除它们，用其他文本替换文本，滚动文本等。为了使用 MVC 支持这一点，您有一个保存状态的模型和一个显示状态的视图。

您的第一直觉可能是让视图直接访问模型，然后在每次用户进行更改时刷新视图，但是使用该实现撤消这些更改非常困难。相反，您可以在能够执行该更改并且以后可以撤消该更改的类中对用户可以进行的每种更改进行编码。

例如，插入文本的操作将由一个知道插入点的字符偏移量和要插入的字符串的类来实现。执行操作将在偏移处插入字符串，撤消操作将删除该插入点之后正确数量的字符。您将有一个不同的类来处理删除，另一个类来处理滚动等。

每次用户采取一些行动时，视图都会构造这些 UndoableEdit 类之一，并告诉实例自行运行（redo()）。执行后，您将 UndoableEdit 放在 UndoableEdit 实例列表的末尾，这些实例代表用户到目前为止已采取的所有操作。这个列表可以很容易地支持任何顺序的撤消请求、重做请求和实际的编辑操作（导致更多的 UndoableEdit 被放在列表中）。

所以回到你的问题。如果您的应用需要支持撤消和重做，那么您需要实现一个 UndoManager，它只管理 UndoableEdit 的列表并根据需要执行撤消和重做。您还必须实现一大堆 UndoableEdits，一个用于您的用户将对 UI 执行的每种操作。至于听众，我看不出你真的需要这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:39:41.043

1.  如果您只需要简单的撤消/重做，则可以按原样使用[UndoManager](http://docs.oracle.com/javase/6/docs/api/javax/swing/undo/UndoManager.html)，无需以任何方式对其进行子类化或自定义。
2.  JTextField（更具体地说，它的模型，[Document](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/Document.html)）具有一些内置的撤消支持，这意味着您也不需要编写[UndoableEdit](http://docs.oracle.com/javase/6/docs/api/javax/swing/undo/UndoableEdit.html)实现，UndoableEdit 对象将自动为您创建（实际上[AbstractDocument.DefaultDocumentEvent](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/AbstractDocument.DefaultDocumentEvent.html)实现 UndoableEdit）。
3.  完整的简单工作示例在[这里](http://www.exampledepot.com/egs/javax.swing.undo/UndoText.html)

# javascript - Javascript 内存使用管理

> ID：12772822
> 
> 赞同：14
> 
> 时间：2012-10-07T21:02:23.937
> 
> 标签：javascript, jquery, javascript-events

我正在构建使用大量 javascript 的大型网站，我的所有内容都在加载`ajax`，它与 facebook 非常相似，并且由于有很多不同的页面我需要很多 javascript，所以我想到的是划分我的脚本分成几个部分，每个页面都有它自己的脚本文件。

现在加载很简单，我只为每个页面加载一个新文件，但我担心的是如果用户浏览 100 个不同的页面并加载 100 个不同的脚本文件会发生什么？

目前我的网站没有那么多页面，但我很确定它会在未来某个时候增长到近 100 个独特的页面。

那么计算机速度较慢的用户会发生什么？我猜它会开始放慢很多，因为没有刷新。根据我的阅读，不可能以任何简单的方式从加载的脚本文件中卸载所有事件和数据，如果我尝试这样做可能会花费我很多时间和精力。

所以我的问题是，我应该保持原样还是尝试做点什么？我目前使用`jquery`的插件很少，如果我不得不猜测平均文件将是大约 50-200 行代码，其中大部分是`click`事件和`ajax`调用。

注意，每个页面对象对每个类都有自己的前缀，例如`home_header`：`login_header`

`onClick`所以事件监听器和类似的东西之间不应该有任何冲突。

**编辑**我在这个问题上设置赏金，我想听听更多的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T10:59:47.777

仅仅因为您使用 AJAX 并不意味着就内存使用敲响了警钟……您应该更担心导致内存泄漏的事物，并确保正确地破坏和构造事物：

*   [http://javascript.crockford.com/memory/leak.html](http://javascript.crockford.com/memory/leak.html)
*   [http://nesj.net/blog/2012/04/javascript-memory-leaks/](http://nesj.net/blog/2012/04/javascript-memory-leaks/)
*   [http://www.ibm.com/developerworks/web/library/wa-memleak/](http://www.ibm.com/developerworks/web/library/wa-memleak/)

*   [什么是 JavaScript 垃圾回收？](https://stackoverflow.com/questions/864516/what-is-javascript-garbage-collection)

通常，在任何大型系统中，我倾向于创建一个辅助构造函数来跟踪我可能希望在以后销毁或在页面卸载时销毁的所有项目*（事件侦听器、大型属性或对象结构），*所有这些项目都由命名空间索引. 然后，当我完成了一个特定的部分或实体时，我会要求帮助系统——我称之为 GarbageMonkey :)——清除一个特定的命名空间。

1.  对于事件它解除绑定
2.  对于它未设置的属性
3.  对于数组/对象，它会扫描并取消设置每个键，也可以对子元素这样做
4.  对于元素，它会尽可能地删除和清理内容

显然，要使上述方法起作用，您需要小心不要留下变量，这些变量可以保留对您希望删除的数据的引用。所以这意味着要知道什么是[垃圾收集](https://stackoverflow.com/questions/864516/what-is-javascript-garbage-collection "垃圾收集")，什么是[闭包](http://en.wikipedia.org/wiki/Closure_%28computer_science%29 "关闭")；以及它们之间如何使变量永远存在！..或者至少在浏览器/标签被破坏之前。这也意味着使用对象结构而不是 vars，因为您可以删除任何有权访问该对象的范围内的键，但您不能对 vars 这样做。

所以这样做：

```
var data = {}, methods = {}, events = {};

methods.aTestMethod = function(){
  /// by assigning properties to an object, you can easily remove them later
  data.value1 = 123;
  data.value2 = 456;
  data.value3 = 789;
} 
```

而不是这个：

```
var value1, value2, value3;

var aTestMethod = function(){
  value1 = 123;
  value2 = 456;
  value3 = 789;
} 
```

原因是因为在上面您可以稍后执行此操作：

```
var i;
for( i in methods ){ delete methods[i]; }
for( i in data ){ delete data[i]; } 
```

但你不能这样做：

```
delete value1;
delete value2;
delete value3; 
```

现在显然上述内容不会保护您免受直接指向`methods`or的子元素的引用`data`。但是，如果您只在代码中传递`methods`and`data`对象，并且在将方法附加为事件侦听器方面保持整洁，那么即使您最终得到一个流氓引用，它也应该只指向一个空对象*（在您删除之后它的内容是）*。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-07T23:57:48.813

如果您回收变量并且不污染全局范围，那么您就在正确的轨道上；但至于你的问题，你应该先弄清楚它是否是一个实际问题。

这可以使用分析器进行检查和监控 -[开箱即用的 Chrome 非常适合它](http://dev.chromium.org/memory-usage-backgrounder)，只需输入`about:memory`URL，它就会为您提供每个选项卡的细分，甚至可以让您比较浏览器之间的内存使用情况。如果您设置了一些自动化测试场景（或愿意手动浏览 100 个页面），则此类分析将告诉您您的网站是否存在重大问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T14:31:37.193

有 2 件不同的事情需要照顾：

-内存使用情况

-内存泄漏

对于长时间运行的 Web 应用程序，应绝对避免内存泄漏，否则用户会遇到浏览器崩溃的情况。要监控内存使用情况，您可以下载进程资源管理器： [http ://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

禁用所有浏览器插件，然后使用您的应用程序并执行重复性任务。如果内存使用量增加，就会出现泄漏。IE7 - IE8 确实比现代浏览器更容易泄漏，并且更难调试，因此了解什么是最小化浏览器兼容性很有用。

对于内存使用，有几件事可以帮助减轻应用程序的重量：

*   与其循环遍历 dom 元素并附加事件处理函数，不如使用事件委托。ED在这里真的是一把金枪。

*   对于 IE 7 / 8 var 无效化是必要的，我认为它仍然有助于现代浏览器（需要一些测试）。为此，您还需要命名您的函数，以便您可以将它们从内存中删除。（有关更多详细信息，请参见 pebbl 答案）

*   保持对dom大小的控制。当为一个特性添加节点时，当这个特性不再使用时，它们也应该被删除。

*   向所有组件添加一些处理卸载的 teardown() 方法。

好的，对不起，我在这里有点太快了，但很高兴知道：

1.  你的最低浏览器是什么

2.  如果您检测到泄漏

3.  如果 ED 是一个充分的解决方案（通常是）

# google-app-engine - App Engine 上是否仍禁用 Clojure 并发支持？

> ID：12772824
> 
> 赞同：6
> 
> 时间：2012-10-07T21:02:57.340
> 
> 标签：google-app-engine, clojure

在最近的[一篇博](http://www.adrianmouat.com/bit-bucket/2012/08/clojure-and-google-app-engine/)文中，Adrian Mouat 表示 App Engine 不支持 Clojure 并发，例如代理。但是，[GAE Java](http://code.google.com/p/googleappengine/wiki/SdkForJavaReleaseNotes)从 App Engine 1.6.4 版本开始支持线程。

App Engine 是否完全支持 Clojure 并发模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T22:02:16.783

我知道必须使用他们的[线程管理器 API](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/ThreadManager)来创建线程。对于 appengine 前端，每个创建的线程仍将绑定到当前请求。在 appengine 后端，您可以让后台线程在处理请求后持续存在。我不知道其他库，但 appengine-magic 自 Google App Engine SDK 1.6.3.1 发布以来一直没有更新，分支上的活动很少，但将其更新到最新的 appengine api 是[2012 年代码项目提案的夏天](http://dev.clojure.org/display/community/Google+Summer+of+Code+2012#GoogleSummerofCode2012-appengine-magicenhancementsforGoogleAppEngine)。

# c++ - C++ 重载提取运算符 - 错误无法访问类中声明的私有成员

> ID：12772825
> 
> 赞同：5
> 
> 时间：2012-10-07T21:02:59.710
> 
> 标签：c++, operator-overloading, private-members, ostream

我正在做一些作业并收到最奇怪的错误。希望你能提供帮助。我收到此错误：

> 无法访问班级中的私人成员

**注意**：我显然还没有写完，但我会尝试测试错误。非常感谢您的任何意见！

```
// Amanda 
// SoccerPlayer.cpp : main project file.
// October 6, 2012
/* a. Design a SoccerPlayer class that includes three integer fields: a player's jersey     number,
number of goals, and number of assists. Overload extraction and insertion operators for     the class.
b. Include an operation>() function for the class. One SoccerPlayer is considered greater
than another if the sum of goals plus assists is greater.
c. Create an array of 11 SoccerPlayers, then use the > operator to find the player who   has the
greatest goals plus assists.*/

#include "stdafx.h"
#include<conio.h>
#include<iostream>
#include<string>

class SoccerPlayer
{
    friend std::ostream operator<<(std::ostream, SoccerPlayer&);
//  friend std::istream operator>>(std::istream, SoccerPlayer&);
private:
    int jerseyNum;
    int numGoals;
    int numAssists;
public:
    SoccerPlayer(int, int, int);

};

SoccerPlayer::SoccerPlayer(int jersey, int goal, int assist)
{
    jerseyNum = jersey;
    numGoals = goal;
    numAssists = assist;
} 

std::ostream operator<<(std::ostream player,  SoccerPlayer& aPlayer)
{
    player << "Jersey #" << aPlayer.jerseyNum <<
        " Number of Goals " << aPlayer.numGoals << 
        " Number of Assists " << aPlayer.numAssists;
    return player ;
};

int main()
{
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:06:46.947

您想通过引用传递和返回流：您不能复制 IOStream 对象。此外，在写入的情况下，您可能想要传递一个`SoccerPlayer const&`. 通过这些更改，您的代码应该编译（尽管在输出运算符的定义之后还有一个多余的分号）。

也就是说，您的输出运算符应声明为

```
std::ostream& operator<< (std::ostream&, SockerPlayer const&) 
```

（在其定义和`friend`声明中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:07:18.133

`std::ostream`不可复制。您需要传递一个引用，并返回一个引用：

```
friend std::ostream& operator<<(std::ostream&, const SoccerPlayer&);

....
std::ostream& operator<<(std::ostream& player,  const SoccerPlayer& aPlayer) { /* as before */ } 
```

另请注意，没有理由不将其`SoccerPlayer`作为`const`参考传递。

在与错误完全无关的注释中，您应该更喜欢使用构造函数初始化列表，而不是为构造函数主体中的数据成员赋值：

```
SoccerPlayer::SoccerPlayer(int jersey, int goal, int assist) 
: jerseyNum(jersey), numGoal(goal), numAssists(assist) {} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T21:08:19.143

您应该将 ostream 对象的引用发送给您的朋友函数。所以它`friend std::ostream& operator<<(std::ostream &, SoccerPlayer&);` 在原型和定义上都类似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T21:06:48.883

`std::ostream operator<<(std::ostream player, SoccerPlayer& aPlayer)`必须是班级的朋友或班级成员才能访问`private`和`protected`字段。

# solr - Solr NGram 过滤不匹配搜索词

> ID：12772826
> 
> 赞同：1
> 
> 时间：2012-10-07T21:03:19.350
> 
> 标签：solr

我为要编制索引的关键字字段启用了 NGram 过滤，其中包含以下逗号分隔的术语：

wwwdebenhams.com、ebenhams.com、dbenhams.com、deenhams.com、debnhams.com、debehams.com、debenams.com、debenhms.com、debenhas.com、debenham.com、debenhams.ocm、debenhams.con、debenhams。 comn, debenhams.copm, debenhams.comm, debenhams.coom, debenhams.xom, debenhams.cpm, ebenhams.com, dbenhams.com, deenhams.com, debnhams.com, debehams.com, debenams.com, debenhms.com, debenhas.com, debenham.com,

核心架构如下所示：

```
<?xml version="1.0" ?>

<schema name="merchant" version="1.0">
    <types>
    <!--
          Default numeric field types. For faster range queries, consider the           tint/tfloat/tlong/tdouble types.
        -->
        <fieldType name="int" class="solr.TrieIntField" precisionStep="0"     positionIncrementGap="0"/>

        <fieldType name="text_lowercase_ngram" class="solr.TextField"     termPositions="false" omitNorms="true">
        <analyzer type="index">
               <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.WordDelimiterFilterFactory"
                    splitOnCaseChange="0"
                    splitOnNumerics="0"
                    stemEnglishPossessive="0"
                    generateWordParts="1"
                    generateNumberParts="1"
                    catenateWords="0"
                    catenateNumbers="0"
                    catenateAll="0"
                    preserveOriginal="1"
                    types="wdfftypes.txt"
                    />
            <filter class="solr.NGramFilterFactory" minGramSize="3" maxGramSize="20"/>
        </analyzer>
        <analyzer type="query">
            <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.WordDelimiterFilterFactory"
                    splitOnCaseChange="0"
                    splitOnNumerics="0"
                    stemEnglishPossessive="0"
                    generateWordParts="1"
                    generateNumberParts="1"
                    catenateWords="0"
                    catenateNumbers="0"
                    catenateAll="0"
                    preserveOriginal="1"
                    types="wdfftypes.txt"
                    />
            <filter class="solr.NGramFilterFactory" minGramSize="3" maxGramSize="20"/>
        </analyzer>
    </fieldType>

    <fieldType name="text_exact" class="solr.TextField">
        <analyzer>
            <tokenizer class="solr.KeywordTokenizerFactory"/>
        </analyzer>
    </fieldType>
</types>

<fields>
    <!-- Merchant Fields -->
    <field name="id" type="int" indexed="true" stored="true" required="true"/>
    <field name="site_id" type="int" indexed="true" stored="true" required="true"/>
    <field name="title" type="text_lowercase_ngram" indexed="true" stored="true"/>
    <field name="url" type="text_exact" indexed="true" stored="true"/>
    <field name="keywords" type="text_lowercase_ngram" indexed="true" stored="true" />
    <field name="description" type="text_lowercase_ngram" indexed="true" stored="true" />
    <field name="type" type="int" indexed="true" stored="true"/>
    <field name="popularity" type="int" indexed="true" stored="true"/>
    <field name="category" type="text_exact" indexed="true" stored="true" multiValued="true"/>
</fields>

<!-- field to use to determine and enforce document uniqueness. -->
<uniqueKey>id</uniqueKey>

<!-- field for the QueryParser to use when an explicit fieldname is absent -->
<defaultSearchField>title</defaultSearchField>

<!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
<solrQueryParser defaultOperator="OR"/> 
```

搜索“deb”会返回得分为 6.4406505 的匹配文档。搜索“debe”、“deben”、“debenh”和“debenha”不会返回任何结果。搜索“debenham”返回得分为 41.740173 的匹配文档，搜索“debenhams”返回得分为 111.30711 的文档。

我已经尝试使用查询分析器来显示上述每个查询的匹配项，但我没有看到结果中返回的匹配文档。有没有一种方法可以返回所有具有相应分数的文档，无论它们是否是正匹配，以便更好地理解为什么它们没有被返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T07:36:32.983

首先，您应该在查询时删除 NGramFilterFactory。您真的不需要对查询进行 ngram，这可能会弄乱您的结果。另外，您是否可能只查看前十个结果？Solr 使用默认`rows=10`参数；您可以使用参数增加它或切换页面`start`。查看`numFound`查询返回的结果，其中包含结果总数，即使您没有看到所有结果。

# sql-server-2008 - 无法更新数字命名列

> ID：12772828
> 
> 赞同：1
> 
> 时间：2012-10-07T21:03:28.883
> 
> 标签：sql-server-2008, tsql

我正在尝试在 SQL Server 中执行一个简单的任务并收到一个错误。我有一张名为 World.Internet_CountryYear 的表。该表有年份列（即 1960、1965 等），字段中有数字数据，但列的数据类型是 varchar(max)。目前，没有数据的字段中有“”，我想用0.00替换。所以，我尝试运行一个简单的更新命令，如下所示：

```
UPDATE World.Internet_CountryYear
SET 1960 = '0.00'
WHERE 1960 = '""' 
```

出于某种原因，我收到一条错误消息，提示“'1960' 附近的语法不正确”

这个表的DDL有问题吗？我在这里想念什么？我也尝试过指定 World.Internet_CountryYear.1960，但仍然收到类似的错误：'.1960' 附近的语法不正确

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:06:04.950

使用方括号将列名括起来（使用关键字时需要使用方括号，列名中的特殊字符）

尝试这个：

```
UPDATE World.Internet_CountryYear
SET [1960] = '0.00'
WHERE [1960] = '""' 
```

# php - jquery滑动滚动.animate div一直在页脚信息的顶部走得太远

> ID：12772830
> 
> 赞同：0
> 
> 时间：2012-10-07T21:03:41.817
> 
> 标签：php, jquery, css, jquery-animate

提前感谢您的帮助。我有一个带有 jquery .animate 的滑动 div，div 设置为绝对位置，当滑动 div 到达页面上的某个点时，我需要停止滑动 div，因为它只是不断地越过页脚 div。为了增加难度，还有另一个可扩展的 div，因为页面上有带有“查看更多”“更少”按钮的隐藏 div。我可能需要从页面底部滑动 div 停止 800px 之类的东西，这意味着它会停止滑动并从页面顶部右下方离开。希望这是有道理的。 [这是一个测试域上的页面](http://esdaledesigns.com/christmas-menu-lunch-dinner.php)这不是真正的网站，所以如果您在将来的任何时候阅读这个不起作用，它将在[Stockwell](http://thestockwellcolchester.com/)上。

```
 $().ready(function() {
    var $scrollingDiv = $("#right");

    $(window).scroll(function(){            
        $scrollingDiv
                            .stop()
            .animate({"marginTop": ($(window).scrollTop() + -20) + "px"}, "slow" );         
    });
}); 
```

再次感谢任何人的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:08:28.783

你可以简单地做

```
$().ready(function() {
    var $scrollingDiv = $("#right");

    $(window).scroll(function(){   
        if ($(window).scrollTop() < limit) {
            $scrollingDiv.stop()
            .animate({"marginTop": ($(window).scrollTop() + -20) + "px"}, "slow" );    
        }     
    });
}); 
```

您可以根据需要设置限制。

# sockets - 使用带有“选择”功能的非阻塞套接字有什么好处？

> ID：12772836
> 
> 赞同：6
> 
> 时间：2012-10-07T21:04:20.660
> 
> 标签：sockets, unix, network-programming

我正在 Linux 中编写一个服务器，它必须支持来自多个客户端的同时读/写操作。我想使用*select*功能来管理读/写可用性。

我不明白的是：假设我想等到套接字有数据可供读取。*select*的文档声明它会阻塞，直到有数据可供读取，并且 read 函数不会阻塞。

所以如果我使用 select 并且我知道 read 函数不会阻塞，为什么我需要将我的套接字设置为非阻塞？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-07T21:12:58.950

在某些情况下，套接字被报告为就绪，但当您检查它时，它会更改其状态。

一个很好的例子是接受连接。当一个新的连接到达时，一个监听套接字被报告为准备好读取。当您调用 accept 时，连接可能在发送任何内容之前和我们调用之前被另一方关闭`accept`。当然，这种情况的处理是依赖于操作系统的，但它可能`accept`会简单地阻塞直到建立新的连接，这将导致我们的应用程序无限期地等待阻止其他套接字的处理。如果您的侦听套接字处于非阻塞模式，则不会发生这种情况，您会得到`EWOULDBLOCK`或其他一些错误，但`accept`无论如何都不会阻塞。

一些内核曾经（我希望现在已经修复）一个有趣的 UDP 和`select`. 当数据报到达`select`时，通过套接字唤醒，数据报被标记为准备好读取。数据报校验和验证被推迟到用户代码调用`recvfrom`（或其他一些能够接收 UDP 数据报的 API）。当代码调用`recvfrom`并且验证代码检测到校验和不匹配时，数据报被简单地丢弃并`recvfrom`最终被阻塞，直到下一个数据报到达。可以在[此处](http://permalink.gmane.org/gmane.linux.kernel.commits.head/44781)找到修复此问题的补丁程序之一（以及问题描述） 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-08T08:04:14.400

除了其他人提到的内核错误之外，选择非阻塞套接字（即使使用轮询循环）的另一个原因是它允许快速到达数据的更高性能。想想当阻塞套接字被标记为“可读”时会发生什么。您不知道有多少数据已到达，因此您只能安全地读取一次。然后你必须回到事件循环让你的轮询器检查套接字是否仍然可读。这意味着对于套接字的每次读取或写入，您必须至少执行两个系统调用：`select`告诉您读取是安全的，以及读取/写入调用本身。

With non-blocking sockets you can skip the unnecessary calls to `select` after the first one. When a socket is flagged as readable by `select`, you have the option of reading from it as long as it returns data, which allows faster processing of quick bursts of data.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T21:10:39.720

好处之一是它会捕获您犯的任何编程错误，因为如果您尝试读取通常会阻止您的套接字，您将获得 EWOULDBLOCK。对于套接字以外的对象，确切的 api 行为可能会改变，请参阅[http://www.scottklement.com/rpg/socktut/nonblocking.html](http://www.scottklement.com/rpg/socktut/nonblocking.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-08T00:30:49.240

这听起来很刺耳，但事实并非如此。使它们成为非阻塞的最佳理由是不要阻塞。

想想看。 `select()`告诉你有东西要读，但你不知道有多少。可能是 2 个字节，可能是 2,000。在大多数情况下，在返回`select`. 所以你进入一个while循环来阅读

```
while (1)
{
    n = read(sock, buffer, 200);
    //check return code, etc
} 
```

当没有什么要读的时候，最后一次读会发生什么？如果套接字不是非阻塞的，您将阻塞，从而（至少部分地）击败`select()`.

# c# - Setting Charm 会触发哪些事件？

> ID：12772838
> 
> 赞同：2
> 
> 时间：2012-10-07T21:04:35.740
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

当设置 Charm 关闭时，页面是否会收到事件？

谢谢 EitanB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T22:06:03.757

关闭窗格时没有事件 - 根据您的特定实现，您可以依赖[CommandRequested -](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.commandsrequested)**在选择特定项目时**触发，或者依赖于弹出窗口中的独立处理程序（可能显示特定设置选项）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:02:30.703

```
Windows.UI.ApplicationSettings.SettingsPane.GetForCurrentView().CommandsRequested 
```

# c# - 可以在visual c++/cli windows应用程序表单项目中使用c#自定义控件吗？

> ID：12772839
> 
> 赞同：-4
> 
> 时间：2012-10-07T21:04:58.220
> 
> 标签：c#, forms, c++-cli, controls

如果你用c#创建一个自定义控件项目并将其编译为dll，你能在Visual c++ windows应用程序窗体项目中使用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T07:21:21.893

creata a custom control as a COM/ActiveX wrapper and make it comvisible true. create a .tbl file from it and use it vc++ apps.

please see ... [http://www.simple-talk.com/dotnet/visual-studio/build-and-deploy-a-.net-com-assembly/](http://www.simple-talk.com/dotnet/visual-studio/build-and-deploy-a-.net-com-assembly/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-07T21:11:26.760

不，你不能使用它。C# 代码编译成 IL 代码（需要 .NET 虚拟机），而 C++ 代码编译成二进制代码。

# jquery - dashcode：如何添加/删除列表中的项目？列表不会在视觉上刷新

> ID：12772843
> 
> 赞同：2
> 
> 时间：2012-10-07T21:05:18.943
> 
> 标签：jquery, dashcode

我正在研究一些小部件。它不使用任何网络服务作为数据源。我使用 jQuery 从普通网页解析一些数据，并希望将这些数据显示为 dashcode 列表。我遵循了 Dashcode 中的 listDataSource 示例代码。

```
var listDataSource = {
  _rowData: ['Item 1', 'Item 2', 'Item 3'],
  numberOfRows: function() {
      alert("Row data now is: "+this._rowData);
      alert("number of rows: "+this._rowData.length);
      return this._rowData.length;
},
prepareRow: function(rowElement, rowIndex, templateElements) {
    if (templateElements.rowLabel) {
        templateElements.rowLabel.innerText = this._rowData[rowIndex];
    }
    rowElement.ondblclick = function(event) {
        // Do something interesting
        alert("Row "+rowIndex);
    };
}
}; 
```

在属性检查器中，我选择了动态数据类型并选择了这个 listDataSource 作为数据源。然后，我以这种方式向 listDataSource 的 _rowData 添加一项：

```
listDataSource._rowData.push("New Item 4"); 
```

并以这种方式重新加载我的列表：

```
var mylist = document.getElementById("list").object;    
mylist.reloadData(); 
```

我知道，函数 numberOfRows 和 prepareRow 在我添加新项目后被调用（通过警报消息）。警报打印 _rowData 并按预期添加了新项目。但是我的小部件中的列表不会刷新！为什么？我实在想不通。是否有一些功能 reloadUI() 或什么？如果您现在可以解决我的问题，请让我上路。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T22:11:36.567

自己发现了一个丑陋的黑客。如果 reloadData() 被调用两次 - UI 中的列表按预期刷新。

另一种解决方案是使用 global var 并在 reloadData() 之前设置它

```
var myData['Item 1', 'Item 2', 'Item 3'];

var listDataSource = {
  _rowData: myData,
  numberOfRows: function() {
  alert("Row data now is: "+this._rowData);
  alert("number of rows: "+this._rowData.length);
  return this._rowData.length;
},
prepareRow: function(rowElement, rowIndex, templateElements) {
if (templateElements.rowLabel) {
    templateElements.rowLabel.innerText = this._rowData[rowIndex];
}
rowElement.ondblclick = function(event) {
    // Do something interesting
    alert("Row "+rowIndex);
};
}
}; 
```

然后

```
myData.push("Item 4"); 
```

并将新数据数组设置为列表，然后重新加载：

```
var mylist = document.getElementById("list").object;    
mylist.setDataArray(myData);
mylist.reloadData(); 
```

但此解决方案禁用 rowElement 上的回调函数

```
alert("Row "+rowIndex); 
```

设置新dataArray后不起作用，所以我选择双重reloadData hack：

```
var mylist = document.getElementById("list").object;    
mylist.reloadData();
mylist.reloadData(); 
```

# air - 将外部 cli 与桌面版 AIR 3.2 捆绑在一个软件包安装程序中

> ID：12772844
> 
> 赞同：1
> 
> 时间：2012-10-07T21:05:34.140
> 
> 标签：air, command-line-interface

我的 AIR 项目是 3.2 for Desktop。是否可以将外部 cli 程序捆绑到已发布的本机安装程序？我的空中应用程序需要调用外部 cli 程序来制作屏幕截图，但我不希望用户必须单独获取 cli 程序。我想将 cli 程序与我的 air 应用程序捆绑为一个完整的包，因此用户不需要指令来单独获取所需的 cli 程序。

# actionscript-3 - 在构造函数之前调用成员函数

> ID：12772845
> 
> 赞同：0
> 
> 时间：2012-10-07T21:05:34.167
> 
> 标签：actionscript-3, flash, constructor, initialization, member-functions

在 AS3 中，您可以通过调用成员函数来初始化成员变量（或常量）。这发生在调用构造函数之前。与此同时，**'this'**关键字在初始化成员函数中是完全可访问的，即使尚未发出构造函数。

这听起来像是一颗定时炸弹。任何人都可以评论上述做法吗？

编辑 ：

```
...
private var member:Sprite = getSprite(); // called before constructor
...
private function getSprite():Sprite {
    var spr:Sprite = new Sprite();
    this.addChild(spr); // 'this' used before constructor
    return spr;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:41:12.733

据我了解，这很好（如果不是真的很好和可读）。调用 new 时会发生什么：

1.  为实例分配内存（`this`变为可用）
2.  所有成员都被初始化（无论是默认值还是指定的）
3.  构造函数被调用
4.  `new`返回`this`

危险在于你必须确保没有任何`getSprite()`东西需要在构造函数中初始化的东西（包括父构造函数，如果它被调用）。我会避免它，而只是初始化构造函数中的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:36:37.787

你真的不能按照你说的去做。如果尚未构造实例，您可能无法访问实例上的非静态方法。至于 Jonatan 关于调用 super 的构造函数的评论，如果您不在构造函数主体中调用 super()，它会自动出现在方法的顶部，这是隐式完成的。当您在面向对象的语言中构造一个对象时，您正在为该类的所有成员分配内存。

如果你说：

```
var myVar:MyObject;
myVar.doSomething(); //this line creates a null pointer exception because myVar is null 
```

相反，如果您要说：

```
var myVar:MyObject = MyObject.createInstance(); // assuming createInstance is a static method that returns an instance of MyObject
myVar.doSomething(); //assuming createInstance() didn't return null then this works 
```

But in this second case you can't reference "this" keyword from within the static method createInstance().

If you show a full example that refutes what I'm stating then I'll run it and delete my post, but I'm pretty sure I'm right here.

# php - $_SERVER['REQUEST_URI'] 在捕获查询字符串时有多可靠？

> ID：12772846
> 
> 赞同：6
> 
> 时间：2012-10-07T21:05:39.693
> 
> 标签：php, query-string

从我读过的内容来看，似乎`$_SERVER['REQUEST_URI']`并不*总是能*正确返回查询字符串，但有人对成功率有很好的了解吗？它在大多数情况下对普通客户有用吗？

如果有的话，什么会导致`REQUEST_URI`不填充或不包含查询字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-07T21:17:50.613

您询问：

> 如果有的话，什么会导致 REQUEST_URI 不被填充？

我能想到的答案：

1.  Web 服务器`$_SERVER`向 PHP 提供所有值，因此如果服务器不提供它们，则不会设置它们。这对于任何体面的 Web 服务器来说都是极不可能的，但这是可能的。

2.  如果从命令行运行 PHP 程序，它不会有任何`$_SERVER`值。（如果您不担心这一点，请记住单元测试通常是从命令行运行的，因此您是否遵循最佳实践并编写单元测试很重要）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T21:28:16.617

> 如果有的话，什么会导致 REQUEST_URI 不被填充？

谷歌搜索似乎表明 IIS 就是这种情况（但当时是真的，现在可能不是）：

```
https://bugs.launchpad.net/xibo/+bug/654536 
```

（有一篇关于 IIS 修复的文章：http: [//davidwalsh.name/iis-php-server-request_uri](http://davidwalsh.name/iis-php-server-request_uri)）

以及“服务器”不是您的*标准*Web 服务器的其他情况（例如调试服务器插件等）。

它被注意到**但被认为是**不太为人所知或旧版本的 Web 服务器（lighthttpd、iPlanet Web Server 7.0）中的一个错误。

所以我相信你可以合理地确定变量总是会被填充。当然，明智的做法是尽早准备一个非常小的测试脚本在客户的站点上运行，以便得到预警。

# android - 使简单的重复文本更新无限期地继续

> ID：12772847
> 
> 赞同：1
> 
> 时间：2012-10-07T21:05:43.937
> 
> 标签：android, date, textview, recurrence

我在活动中有一个非常实用的函数，它在过去采用静态日期，将其格式化为相对字符串，使用`DateUtils.getRelativeDateTimeString`(所以它变成类似 "3 minutes ago" 并将其设置为 a `TextView`。但是，我希望它`TextView`保持更新只要活动保持开放。

如何制作一个连续运行（无限循环）或在短时间内运行的连续任务 - 就像每秒一样。如何在不进入后台服务等的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:43:59.470

这是使用 AsyncTask 的示例

```
private class BackgroundCoversionTask extends AsyncTask< String, String, Void >{

    @Override
    protected Void doInBackground( String... params ) {

        while( !isCancelled() ){
            try {
                Thread.sleep( 1000 );
            } catch ( InterruptedException e ) {
                break;
            }

            //DateUtils.getRelativeDateTimeString( MainActivity.this, time, minResolution, transitionResolution, flags )
            // Do something right here
            publishProgress( Long.toString( System.currentTimeMillis() ) );

        }

        return null;
    }

    @Override
    protected void onProgressUpdate( String... values ) {
        super.onProgressUpdate( values );

        mTextView.setText( values[0] );
    }

} 
```

然后如果你想取消任务，调用`cancel()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:16:34.493

只需在单独的线程上运行它。

```
Thread thread = new Thread()
{
    @Override
    public void run() {
        try {
            while(true) {
                sleep(1000);
                //Do your date update here
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
};

thread.start(); 
```

请参阅：[如何在 Android 中运行 Runnable 线程？](https://stackoverflow.com/questions/1921514/how-to-run-a-runnable-thread-in-android)

使用线程请确保当应用程序暂停或恢复时，您适当地暂停或恢复您的线程。为了处理您可能需要的任何数据，在活动生命周期结束时自行结束它们也是一个好主意

# javascript - 选择框动态添加选项在firefox3.6中不起作用

> ID：12772856
> 
> 赞同：0
> 
> 时间：2012-10-07T21:06:51.767
> 
> 标签：javascript, html

我有下面的代码来动态填充选择框。这在除 FireFox 3.6 之外的所有浏览器中都可以正常工作

```
var option25 = document.createElement("option");
option25.text = '25 miles';
option25.value = 25;
if(rad == '25')
{
    option25.selected = 'selected';
}
var combo = document.getElementById('ddlProximity_' + controlId);
combo.add(option25); //not working in FF3.6 
```

有什么建议么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T22:01:22.340

选择元素的`add`方法在 Gecko 7 之前的版本（[MDN](https://developer.mozilla.org/en-US/docs/DOM/HTMLSelectElement#add%28%29)）中采用两个参数。

在 IE 中，它只需要一个参数，或者如果它是 IE 8 标准模式下的 IE 8 或[MSDN](http://msdn.microsoft.com/en-us/library/ie/ms535921%28v=vs.85%29.aspx)则需要两个参数。

如果我们`add`在 Firefox 3.6.28、Firefox 15.0.1 和 IE 9 中调用 krg 的代码并在调用它之前检查它的数量：

```
if (typeof combo.add === 'function') {
    if (combo.add.arity === 1) {
        combo.add(option25);
    } else {
        combo.add(option25, null);
    }
} else if (typeof combo.appendChild === 'function') {
    combo.appendChild(option25);
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:13:47.643

假设组合是一个选择菜单，请参见这个[jsFiddle](http://jsfiddle.net/7Cbtx/2/)示例。

```
if (typeof combo.add === 'function') {
    combo.add(option25);
} else if (typeof combo.appendChild === 'function') {
    combo.appendChild(option25);
} 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T21:23:03.203

如果您想确保您的 JS 代码适用于各种浏览器，我会使用 jQuery 等 JavaScript 框架来执行 DOM 操作。JS 框架已经解决了大部分跨浏览器问题并将它们的处理抽象化，因此您不必担心编写代码来解决特定浏览器中的问题。这是 jQuery 的网站：http: [//jquery.com/](http://jquery.com/)。

现在要完成您的示例在 jQuery 中所说的内容，您将执行以下操作：

```
var option25 = $('<option>').val(25).text('25 miles');
if (rad == '25') {
    option25.attr('selected', 'selected');
}

var combo = $('#ddlProximity_' + controlId);
combo.append(option25); // Will work in all browsers supported by jQuery 
```

如果您真的想在没有任何 JS 框架的情况下执行此操作，我会在这里查看：http: [//www.w3schools.com/jsref/met_select_add.asp](http://www.w3schools.com/jsref/met_select_add.asp)。add 方法应该可以工作，但是在 8 之前的 IE 版本中有一些警告，并且您的页面必须具有正确的 DOCTYPE 声明。您也可以尝试 appendChild，但我会在一些浏览器中对其进行测试，看看是否能满足您的需求。

# .net - 无法加载文件或程序集“Microsoft.WindowsAzure.Diagnostics”或其依赖项之一

> ID：12772858
> 
> 赞同：11
> 
> 时间：2012-10-07T21:06:56.473
> 
> 标签：.net, azure, azure-diagnostics

我的系统几天前崩溃了，从那时起，当我尝试调试本地 Azure 环境时，我收到此错误“无法加载文件或程序集 'Microsoft.WindowsAzure.Diagnostics' 或其依赖项之一”。

我重新安装了以下内容（适用于 MS VS 2012 的 Windows Azure 工具 2012 年 6 月 sp1，Windows Azure 模拟器 - 2012 年 6 月，适用于 .net 的 Windows Azure Librarires - 2012 年 6 月）。

还是一样的问题，求建议。

```
=== Pre-bind state information ===
LOG: User = ...........
LOG: DisplayName = Microsoft.WindowsAzure.Diagnostics
(Partial)
WRN: Partial binding information was supplied for an assembly:
WRN: Assembly Name: Microsoft.WindowsAzure.Diagnostics | Domain ID: 2
WRN: A partial bind occurs when only part of the assembly display name is provided.
WRN: This might result in the binder loading an incorrect assembly.
WRN: It is recommended to provide a fully specified textual identity for the assembly,
WRN: that consists of the simple name, version, culture, and public key token.
WRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.
LOG: Appbase = file:///C:/Projects/Client/Connection Intelegence/CICloud/CIWebRole/
LOG: Initial PrivatePath = C:\Projects\Client\Connection Intelegence\CICloud\CIWebRole\bin
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Projects\Client\Connection         Intelegence\CICloud\CIWebRole\web.config
LOG: Using host configuration file: C:\Program Files\IIS Express\config\templates\PersonalWebServer\aspnet.config
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/9cc4e65f/1fb72ae3/Microsoft.WindowsAzure.Diagnostics.DLL.
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/9cc4e65f/1fb72ae3/Microsoft.WindowsAzure.Diagnostics/Microsoft.WindowsAzure.Diagnostics.DLL.
LOG: Attempting download of new URL file:///C:/Projects/Client/Connection Intelegence/CICloud/CIWebRole/bin/Microsoft.WindowsAzure.Diagnostics.DLL.
LOG: Using application configuration file: C:\Projects\Client\Connection Intelegence\CICloud\CIWebRole\web.config
LOG: Using host configuration file: C:\Program Files\IIS Express\config\templates\PersonalWebServer\aspnet.config
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config.
LOG: Post-policy reference: Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35

[FileLoadException: Could not load file or assembly 'Microsoft.WindowsAzure.Diagnostics' or one of its dependencies. The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG))]
[FileLoadException: Could not load file or assembly 'Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG))]
System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +210
System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection) +242
System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +17
System.Reflection.Assembly.Load(String assemblyString) +35
System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +122
[ConfigurationErrorsException: Could not load file or assembly 'Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG))]
System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +12761078
System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +503
System.Web.Configuration.AssemblyInfo.get_AssemblyInternal() +142
System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +334
System.Web.Compilation.BuildManager.CallPreStartInitMethods(String preStartInitListPath) +203
System.Web.Compilation.BuildManager.ExecutePreAppStart() +152
System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +1151

[HttpException (0x80004005): Could not load file or assembly 'Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG))]
System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +12881540
System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +159
System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +12722601 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T12:06:21.393

当您的应用程序启动时，这似乎正在发生。看看你的 web.config，你有指向**Microsoft.WindowsAzure.Diagnostics**程序集的跟踪侦听器吗？这可能是您的应用程序无法运行的原因。

首先，查看您的程序集引用并删除**Microsoft.WindowsAzure.Diagnostics**（以确保我们不使用旧版本）。然后，添加对**Microsoft.WindowsAzure.Diagnostics**的引用，但请确保这是版本 1.7.0.0。

您应该在以下位置找到此程序集的正确版本：**C:\Program Files\Microsoft SDKs\Windows Azure.NET SDK\2012-06\ref**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-10-26T14:21:00.353

我知道这是一个老话题，但它仍然是“无法加载文件或程序集 Microsoft.WindowsAzure.Diagnostics”的最佳 Google 结果，所以这就是我所做的：

Azure SDK 2.7.1 和 Visual Studio 2013 发生在我身上。在升级到 Windows 10 和 Azure SDK 2.7 之间的某个地方，有些东西没有正确安装。我尝试重新安装 Azure SDK，升级到 Visual Studio 2015，但都没有成功。我终于不得不在我的 app.config 中更改以下行：

```
 <system.diagnostics>
    <trace>
        <listeners>
            <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=2.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
                <filter type="" />
            </add>
        </listeners>
    </trace>
</system.diagnostics> 
```

至

```
 <system.diagnostics>
    <trace>
        <listeners>
            <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=2.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
                <filter type="" />
            </add>
        </listeners>
    </trace>
</system.diagnostics> 
```

注意从“2.7.0.0”到“2.5.0.0”的变化。对我来说，Microsoft.WindowsAzure.Diagnostics 2.7.0.0 DLL 不存在。恢复到 2.5.0.0 工作正常。我仍然想找到根本原因，但我还有更重要的事情要做。希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-12T16:17:49.620

添加到 Sandrinio 的答案（对不起，我没有特权）我有一个类似的错误，其中 1.7.0.0 被引用，但我的 web.config 中的这一部分指向版本 1.0.0.0

```
<system.diagnostics>
<trace>
  <listeners>
    <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
      name="AzureDiagnostics">
      <filter type="" />
    </add>
  </listeners>
</trace> 
```

我把它注释掉了，问题就解决了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-05T18:06:16.540

我查看了参考资料，发现角色使用了 Microsoft.WindowsAzure.Diagnostics。就我而言，角色使用的是 2.8.0.0。然后我打开每个角色的 app.config 并将 Microsoft.WindowsAzure.Diagnostics 的添加设置为相同的版本。

```
 <system.diagnostics>
    <trace>
      <listeners>
        <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=2.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
          <filter type="" />
        </add>
      </listeners>
    </trace>
  </system.diagnostics> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-04T18:52:32.360

最好检查 Microsoft.WindowsAzure.Diagnostics 的属性以查看您使用的版本。当我将它插入上面 Dan 和 Taylor 提到的 Web.config 元素时，我的说 2.8.0.0 有效。2.7.0.0 对我不起作用 2.8.0.0 对我有用，但明天可能会不一样；-)。

# java - java枚举，但喜欢公共静态最终int？

> ID：12772859
> 
> 赞同：3
> 
> 时间：2012-10-07T21:07:01.250
> 
> 标签：java

我想要一个常量列表，例如与整数 1、2、3 相关的 A、B、C

我知道你可以这样做

```
class Example {
    public static final int A = 1;
    etc...
} 
```

和

```
enum Example {
    A(1), ... etc;
    some initialization of an integer
} 
```

但是有没有办法像 public static final 但像枚举一样简洁？当我使用 A 并且我的意思是 1 时，我不想调用 Example.A.value 或类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:30:48.037

一种方法是使用接口，其中变量默认是公共的、静态的和最终的：

```
interface Example {
    int A = 1;
    int B = 2;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:22:19.093

如果我理解你的要求正确，你想做这样的事情：

```
enum Example {
    A = 1,
    B = 2,
    ....
} 
```

没有很好的简单语法。

您要么必须写出一些常量：

```
public interface Example {
    public static final int A = 1;
    public static final int B = 2;
    ....
} 
```

`value`...或者您可以在枚举中添加一些其他内容：

```
public enum Example {
    A(1),
    B(2)
    ....

    private final int val;

    public Example (int val) {
        this.val = val;
    }

    public int getValue() {
        return val;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T21:14:55.770

我认为最短的解决方案是：

```
public static final int A = 1, B = 2, C = 3; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T21:19:58.440

如果你真的想使用枚举，那么你可以在你的枚举中重写**toString()**方法，以在你打印你的枚举实例时获取打印的值：-

```
enum Example {
    A(1), B(2);

    private int val;

    private Example(int val) {
        this.val = val;
    } 

    @Override
    public String toString() {
           switch (this) {
             case A:
                  return String.valueOf(val);

             case B:
                  return String.valueOf(val);

            }
            return super.toString();
    }
}

public class D {
    public static void main(String[] args) {    

        Example a = Example.A;
        Example b = Example.B;

        System.out.println(a);  // Prints 1
        System.out.println(b);  // Prints 2
    }
} 
```

**理想情况下，您的上述枚举就像下面的类：-**

```
class Example {
    public static final int A = 1;
    public static final int B = 2;
} 
```

所以，我不认为使用枚举的必要性..

# java - JDialog 状态的动作监听器

> ID：12772861
> 
> 赞同：2
> 
> 时间：2012-10-07T21:07:02.017
> 
> 标签：java, swing, jbutton, actionlistener, jdialog

当我单击 JButton 时，我想更改 JDialog 中标签的文本，因为标签位于另一个类上，我不知道如何从框架类访问它。所以我想出了一个检查对话框状态的动作监听器的想法。- 当 JDialog 可见时，检索此数据并将此数据设置为标签。这可能吗？

这是我的房间类的代码。

```
public void rooms()
    {
        bh = new ButtonHandler();
        presidentialRoom = new JButton[presidentialRoomNo.length];      
        deluxeRoom = new JButton[deluxeRoomNo.length];
        classicRoom = new JButton[classicRoomNo.length];
        for(int x = 0;x<classicRoomNo.length;x++){
            //classic rooms
            ImageIcon imageC = new ImageIcon("C:\\Users\\John\\workspace" +
                    "\\SystemTest\\src\\Images\\classicRooms.JPG"); // image
            classicRoom[x] = new JButton(classicRoomNo[x],imageC);
            classicRoom[x].setBackground(Color.WHITE);
            classicRoom[x].setBorder(new CompoundBorder(BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY),
                    BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY)));
            classicRoom[x].addActionListener(bh);
            classicSubPanel.add(classicRoom[x]);
            //deluxe rooms
            ImageIcon imageD = new ImageIcon("C:\\Users\\John\\workspace" +
                    "\\SystemTest\\src\\Images\\deluxeRooms.JPG"); // image
            deluxeRoom[x] = new JButton(deluxeRoomNo[x],imageD);
            deluxeRoom[x].setBackground(Color.WHITE);
            deluxeRoom[x].setBorder(new CompoundBorder(BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY),
                    BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY)));
            deluxeRoom[x].addActionListener(bh);
            deluxeSubPanel.add(deluxeRoom[x]);
            //presidential rooms
            ImageIcon imageP = new ImageIcon("C:\\Users\\John\\workspace" +
                    "\\SystemTest\\src\\Images\\presidentialRooms.JPG"); // image
            presidentialRoom[x] = new JButton(presidentialRoomNo[x],imageP);
            presidentialRoom[x].setBackground(Color.WHITE);
            presidentialRoom[x].setBorder(new CompoundBorder(BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY),
                    BorderFactory.createEtchedBorder(Color.WHITE,Color.GRAY)));
            presidentialRoom[x].addActionListener(bh);
            presidentialSubPanel.add(presidentialRoom[x]);

        }
    } 
```

这里的每个按钮都访问 RoomProfile 类

```
public class ButtonHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent e)
        {       
            RoomProfile rooms = new RoomProfile();
                room.setVisible(true);
        }
    } 
```

这是 RoomProfile 中的一段代码：

```
public void createLabels()
    {
        labels = new JLabel[topTextLabels.length];
        inputLabels = new JLabel[topTextLabels.length];
        for(int x = 0; x<topTextLabels.length;x++)
        {
            labels[x] = new JLabel(topTextLabels[x]);
            labels[x].setForeground(Color.WHITE);
            inputLabels[x] = new JLabel("test");
            inputLabels[x].setForeground(Color.WHITE);
        }
    } 
```

当单击房间类中的按钮时，我要更改的文本是“ inputLabels []”，我想让用户查看该房间的配置文件。

输入标签将显示来自数据库的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:23:07.537

在制作自定义对话框窗口时，我通常会扩展 JDialog，然后按照 AKJ 的建议添加我需要的任何功能。

通常，对话框中需要显示的内容应在显示之前确定。对话框通常是模态的（意味着当可见时，用户界面的任何其他部分都不能使用）。您可以将其设为非模态，但它们通常是模态的这一事实说明了对话框通常的使用方式。用户选择了一些选项，点击确定，对话框就消失了。如果对话框要保持可见并且是用户界面的主要组件，那么我认为使用 JFrame 而不是 JDialog 更有意义。

要检查对话框是否可见，请使用 `if(yourDialog.isVisible())`

下面是我写的一个非模态对话框的例子：

```
/**
 * This class allows for some plain text (a note) to be placed into a ScrollPane inside
 * a dialog.  The dialog is non-modal.
 * @author L. LaSpina
 */
public class NoteViewDialog extends javax.swing.JDialog {

    int returnValue;
    public static final int OKPRESSED = 1;
    public static final int CANCELPRESSED = 2;

    /** Creates new form NoteDialog */
    public NoteViewDialog(java.awt.Frame parent, String note) {
        super(parent, false);
        initComponents();
        this.setTitle("Faculty Assignment Summary");
        setLabel("Error List");
        setNote(note);
        setSize(500,300);       
    }

    public void setNote(String s) {
        textArea.setText(s);
    }
    public String getNote() {
        return textArea.getText();
    }

    public void setLabel(String s) {
        headingLabel.setText(s);
    }

    public int getReturnValue() {
        return returnValue;
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        scrollPane = new javax.swing.JScrollPane();
        textArea = new javax.swing.JTextArea();
        buttonPanel = new javax.swing.JPanel();
        okButton = new javax.swing.JButton();
        headingLabel = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        textArea.setColumns(20);
        textArea.setLineWrap(true);
        textArea.setRows(5);
        textArea.setWrapStyleWord(true);
        scrollPane.setViewportView(textArea);

        getContentPane().add(scrollPane, java.awt.BorderLayout.CENTER);

        okButton.setText("Close");
        okButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                okButtonActionPerformed(evt);
            }
        });
        buttonPanel.add(okButton);

        getContentPane().add(buttonPanel, java.awt.BorderLayout.PAGE_END);

        headingLabel.setText("Error Report");
        getContentPane().add(headingLabel, java.awt.BorderLayout.PAGE_START);

        pack();
    }// </editor-fold>                        

    private void okButtonActionPerformed(java.awt.event.ActionEvent evt) {                                         
        this.dispose();
    }                                        

    // Variables declaration - do not modify                     
    private javax.swing.JPanel buttonPanel;
    private javax.swing.JLabel headingLabel;
    private javax.swing.JButton okButton;
    private javax.swing.JScrollPane scrollPane;
    private javax.swing.JTextArea textArea;
    // End of variables declaration                   
} 
```

# ruby-on-rails - 连接到 PostgreSQL 数据库时出现 Rails 问题

> ID：12772864
> 
> 赞同：7
> 
> 时间：2012-10-07T21:07:41.450
> 
> 标签：ruby-on-rails, macos, postgresql

试图让 Rails 在 mac osx 10.8 上运行 postgresql 以部署到 heroku。我是mac的新手。

在安装 PostgrSQL 时遇到了很多麻烦，所以我可能会尝试在该主题上搜索所有可能的解决方案时搞砸一些东西。这主要是权限和现有的 OSX 安装。对于这个问题，我注意到一些事情让我认为存在一些我不确定如何解决的基本目录或版本冲突。但我可能是错的，这是另一回事！任何方向表示赞赏。

检索如下错误：

```
$ rake db:create:all
could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

我不确定它在哪里以及为什么要查找 var 目录，但 ~/var 似乎是 /private/var 的链接（别名）（它有空的 pgsql_socket 和 pgsql_socket_alt 目录）， /usr/local/var 没有有 pgsql_socket 目录但有一个 postgres 目录。这两个目录我的管理员用户都具有从查找器获取信息对话框中读取和写入权限。

显示的上述错误之后是 gems 1.8 目录中的一个长堆栈，并以此结束：

```
Couldn't create database for {"pool"=>5, "database"=>"blog_development", "password"=>nil, "username"=>"USERNAME", "encoding"=>"unicode", "adapter"=>"postgresql"} 
```

所以检查：

```
 $ which psql
/usr/bin/psql 
```

我记得在安装 postgresql 后我这样做了：

```
 initdb /usr/local/var/postgres -E utf8 
```

确认的：

```
$ ps aux | grep postgres
username           346   0.0  0.1  2479616   7724   ??  S     3:08PM   0:00.03 /usr/local/bin/postgres -D /usr/local/var/postgres -r /usr/local/var/postgres/server.log 
```

捆绑显示产量：pg（0.14.1）

```
$ postgres --version
postgres (PostgreSQL) 9.2.1 
```

echo $PATH 没有显示对 posgresql 的任何引用。此应用位于 /Users/USERNAME/SUBDIR/APP 中。

安迪关于我在哪里搞砸了以及如何让这些东西启动并运行的想法？我会很感激任何方向。我将继续处理堆栈溢出和谷歌讨论；虽然我的愚蠢可能是独一无二的！

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-26T09:28:45.280

添加

```
host: localhost 
```

到数据库.yml

# jquery - 命名数据 var 通过 jQuery 方法 $.post 传递

> ID：12772872
> 
> 赞同：1
> 
> 时间：2012-10-07T21:08:46.397
> 
> 标签：jquery, post, scope

我正在写一个`jQuery plugin`可以通过方法发送数据的地方`$.post`，我想设置通过`ajax`对象[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)传递的 var 名称的名称：

```
$('#selector').pluginName({url:'url.com/searches', var_name:'myVarName'}); 
```

我的问题是我无法通过设置名称，`var_name`因为它是作为 var name 本身传递的

```
var name = settings.var_name;
$.post(settings.url, {name:next_search}, settings.callback); 
```

如果我发送此示例，我发送`{'name':'data'}`而不是`{'myVarName':'data'}`.

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:15:34.357

jquery Ajax 方法只需要一个数组作为数据参数，并且有很多方法可以创建该数组。

如果要添加键位于变量中的项目，则可以直接添加。

```
var data = {};
data[settings.var_name] = next_search;
$.post( settings.url, data, settings.callback ); 
```

# jquery - 如何为此添加缓动？“酷”滚动。jQuery ScrollTo

> ID：12772879
> 
> 赞同：0
> 
> 时间：2012-10-07T21:09:54.323
> 
> 标签：jquery, easing

此代码用于向下/向上导航页面。一切正常，我只想让它更轻松一些。一些看起来更好一点的动画。有任何想法吗？？

```
<script type="text/javascript"> 
```

$（函数（）{

```
function scroll(direction) {

    var scroll, i,
            positions = [],
            here = $(window).scrollTop(),
            collection = $('.part');

    collection.each(function() {
        positions.push(parseInt($(this).offset()['top'],10));
    });

    for(i = 0; i < positions.length; i++) {
        if (direction == 'next' && positions[i] > here) { scroll = collection.get(i); break; }
        if (direction == 'prev' && i > 0 && positions[i] >= here) { scroll = collection.get(i-1); break; }
    }

    if (scroll) {
        $.scrollTo(scroll, {
            duration: 350       
        });
    }

    return false;
}

$("#next,#prev").click(function() {        
    return scroll($(this).attr('id'));        
});

$(".scrolltoanchor").click(function() {
    $.scrollTo($($(this).attr("href")), {
        duration: 350
    });
    return false;
}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:20:09.823

试试这个： http: [//gsgd.co.uk/sandbox/jquery/easing/](http://gsgd.co.uk/sandbox/jquery/easing/)

# jquery - jquery - onmouseover 和 onmouseout

> ID：12772882
> 
> 赞同：0
> 
> 时间：2012-10-07T21:10:21.563
> 
> 标签：jquery

当鼠标悬停/移出时，我试图显示/隐藏上一个/下一个按钮。但它似乎没有工作。我的代码有什么问题吗？

这是我的代码。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
      <html xmlns="http://www.w3.org/1999/xhtml">
      <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <title>Portfolio</title>
      <link rel="stylesheet" href="css/global.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/slides.jquery.js"></script>
  <script>

       $('.eachImage').on( "mouseover", function() {
         $('#prevButton').show();
       });
        </script>

      </head>

      <body bgcolor="#FFFFFF">

        <div id="container">
    <div id="example">
        <div id="slides">
            <div class="slides_container">
                <img src="imgs/test.png" width="800" height="456" class="eachImage">
            </div>
            <div id="prevButton"><a href="#" class="prev"><img src="imgs/arrow-prev.png" width="24" height="43" alt="Arrow Prev"></a></div>
            <div id="nextButton"><a href="#" class="next"><img src="imgs/arrow-next.png" width="24" height="43" alt="Arrow Next"></a></div>
        </div>
    </div>
        </div></body>
      </html> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T23:51:48.913

这是要使用的功能

```
 $(document).ready(function(){
     $('.eachImage').mouseover(function(){
    $('#prevButton').toggle();
    });
     }); 
```

我还包括一个 jsfiddle

[http://jsfiddle.net/joseluisrod/XwMzh/3/](http://jsfiddle.net/joseluisrod/XwMzh/3/)

关键是每个按钮都有 style="display:block"

# iphone - 程序在设备上安装应用程序时收到信号 SIGBART

> ID：12772885
> 
> 赞同：0
> 
> 时间：2012-10-07T21:10:45.523
> 
> 标签：iphone, objective-c, xcode, user-interface

我正在尝试在 iPhone 上运行以下示例，但出现错误`Program received signal SIGBART when installing app on device`。这就是`RootViewController`：

```
#import <UIKit/UIKit.h>
@interface RootViewController : UITableViewController {
}
@end 
```

以及`.m`-file中的以下内容

```
#import "RootViewController.h"
@implementation RootViewController
#pragma mark -
#pragma mark View lifecycle

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    NSDate *date = [NSDate date];
    // [...]
} 
```

这是控制台上的错误：

```
2012-10-07 22:51:25.319 TestLoopPerformance[1790:207] *** -[UIWindow setRootViewController:]: unrecognized selector sent to instance 0x118f40
2012-10-07 22:51:25.336 TestLoopPerformance[1790:207] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[UIWindow setRootViewController:]: unrecognized selector sent to instance 0x118f40'
2012-10-07 22:51:25.346 TestLoopPerformance[1790:207] Stack: ( 
```

但是，代码在模拟器上运行良好，但在设备上运行良好。可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T22:23:09.533

`setRootViewController:`in`UIWindow`从 iOS 4.0 开始可用

如果您想支持运行 iOS 3.x 的设备，您必须更改在 AppDelegate 中创建 viewController 的函数……这可能不是您需要进行的唯一更改。

# visual-c++ - DirectShow，捕捉静止图像

> ID：12772890
> 
> 赞同：2
> 
> 时间：2012-10-07T21:11:08.933
> 
> 标签：visual-c++, video, webcam, directshow

我没有 Windows 编程经验，我尝试使用 DirectShow 从网络摄像头捕获静止图像。我写了一个基于 CommandCam.cpp 的小应用程序，可以在这里找到：

[http://batchloaf.wordpress.com/commandcam/](http://batchloaf.wordpress.com/commandcam/)

我基本上添加了可以在这里找到的代码：

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd318622%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318622%28v=vs.85%29.aspx)

但是对 pBuilder->FindPin(pCap, PINDIR_OUTPUT, &PIN_CATEGORY_STILL, ... 的调用失败，我无法获取静止图像的 Pin。

我怀疑因为使用其他网络摄像头程序我可以从我的 Microsoft LifeCam Studio 中获得静止图像。

我想知道我做错了什么？我尝试将呼叫放在应用程序的不同位置，但从未成功。

感谢您的任何提示，托斯滕。

代码的相关部分是这样的： // 获取视频输入设备名称 hr = pMoniker->BindToStorage(0, 0, IID_PPV_ARGS(&pPropBag)); VariantInit(&var); hr = pPropBag->Read(L"FriendlyName", &var, 0); fprintf(stderr, "捕获设备: %ls\n", var.bstrVal); 变体清除(&var);

```
// Create capture filter and add to graph
hr = pMoniker->BindToObject(0, 0, IID_IBaseFilter, (void**)&pCap);
if (hr != S_OK) exit_message("Could not create capture filter", 1);

// Add capture filter to graph
hr = pGraph->AddFilter(pCap, L"Capture Filter");
if (hr != S_OK) exit_message("Could not add capture filter to graph", 1);

// Create sample grabber filter
hr = CoCreateInstance(CLSID_SampleGrabber, NULL,
    CLSCTX_INPROC_SERVER, IID_IBaseFilter,
    (void**)&pSampleGrabberFilter);
if (hr != S_OK)
    exit_message("Could not create Sample Grabber filter", 1);

// Query the ISampleGrabber interface of the sample grabber filter
hr = pSampleGrabberFilter->QueryInterface(
        DexterLib::IID_ISampleGrabber, (void**)&pSampleGrabber);
if (hr != S_OK)
    exit_message("Could not get ISampleGrabber interface to sample grabber filter", 1);

// Enable sample buffering in the sample grabber filter
hr = pSampleGrabber->SetBufferSamples(TRUE);
if (hr != S_OK)
    exit_message("Could not enable sample buffering in the sample grabber", 1);

// Set media type in sample grabber filter
AM_MEDIA_TYPE mt;
ZeroMemory(&mt, sizeof(AM_MEDIA_TYPE));
mt.majortype = MEDIATYPE_Video;
mt.subtype = MEDIASUBTYPE_RGB24;
hr = pSampleGrabber->SetMediaType((DexterLib::_AMMediaType *)&mt);
if (hr != S_OK)
    exit_message("Could not set media type in sample grabber", 1);

// Add sample grabber filter to filter graph
hr = pGraph->AddFilter(pSampleGrabberFilter, L"SampleGrab");
if (hr != S_OK)
    exit_message("Could not add Sample Grabber to filter graph", 1);

// Create Null Renderer filter
hr = CoCreateInstance(CLSID_NullRenderer, NULL,
    CLSCTX_INPROC_SERVER, IID_IBaseFilter,
    (void**)&pNullRenderer);
if (hr != S_OK)
    exit_message("Could not create Null Renderer filter", 1);

// Add Null Renderer filter to filter graph
hr = pGraph->AddFilter(pNullRenderer, L"NullRender");
if (hr != S_OK)
    exit_message("Could not add Null Renderer to filter graph", 1);

// Connect up the filter graph's capture stream
hr = pBuilder->RenderStream(
    &PIN_CATEGORY_CAPTURE, &MEDIATYPE_Video,
    pCap,  pSampleGrabberFilter, pNullRenderer);
if (hr != S_OK)
    exit_message("Could not render capture video stream", 1);

hr = pBuilder->RenderStream(
        &PIN_CATEGORY_PREVIEW, &MEDIATYPE_Video,
        pCap, NULL, NULL);
if (hr != S_OK && hr != VFW_S_NOPREVIEWPIN)
    exit_message("Could not render preview video stream", 1);

// Get media control interfaces to graph builder object
hr = pGraph->QueryInterface(IID_IMediaControl,
                (void**)&pMediaControl);
if (hr != S_OK) exit_message("Could not get media control interface", 1);

// Run graph
while(1)
{
    hr = pMediaControl->Run();

    // Hopefully, the return value was S_OK or S_FALSE
    if (hr == S_OK) break; // graph is now running
    if (hr == S_FALSE) continue; // graph still preparing to run

    // If the Run function returned something else,
    // there must be a problem
    fprintf(stderr, "Error: %u\n", hr);
    exit_message("Could not run filter graph", 1);
}

Sleep(2000);

// get the StillImage Pin
hr = pCap->QueryInterface(IID_IAMVideoControl, (void**)&pAMVidControl);
if (hr != S_OK) exit_message("Could not get IAMVideoControl", 1);

hr = pBuilder->FindPin(pCap, PINDIR_OUTPUT, &PIN_CATEGORY_STILL, NULL, FALSE, 0, &pPin);
if (hr != S_OK)
        exit_message("Could not get Pin of category StillImage", 1);

hr = pAMVidControl->SetMode(pPin, VideoControlFlag_Trigger);
if (hr != S_OK) exit_message("Could set mode VideoControlFlag_Trigger", 1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:25:46.063

一些视频捕获设备源过滤器不暴露静态图像捕获引脚。

您是否尝试使用 EnumPins 方法来查找它是否真的有一个，或者是否只有一个预览图钉？

您还可以使用 GraphEdit 查看过滤器的引脚。

如果设备只有一个预览图钉，您将不得不使用它来抓取您的图像。您可以使用[Smart Tee 过滤器](http://msdn.microsoft.com/en-us/library/windows/desktop/dd377612%28v=vs.85%29.aspx)将图形拆分为预览和捕获。

# algorithm - 如何在范围搜索中使用 Morton Order？

> ID：12772893
> 
> 赞同：7
> 
> 时间：2012-10-07T21:11:16.507
> 
> 标签：algorithm, search, range, bit-manipulation, z-order-curve

如果我有一个数据集，其中键是 3D 点，由 3 个有符号 64 位整数表示。而且我想使用（排序的）键值存储来存储它们，其中键只是字节数组（但我可以指定一个比较器）。我想我可以通过使用位交错将所有这些点变成一个字节数组，就像[如何计算 3D Morton 数中的 Z/Morton 顺序一样](https://stackoverflow.com/questions/1024754/how-to-compute-a-3d-morton-number-interleave-the-bits-of-3-ints)

除了获取单个点（可以在没有 Morton 排序的情况下更简单地完成）之外，我还想做范围搜索，在与轴对齐的框中进行搜索。我将 A 和 B 分别定义为所有坐标最低的框角，以及所有坐标最高的对角。

现在我的问题是：

1.  对于逻辑上介于 A 和 B 之间的任何点 C，C 的莫顿数是否也在 A 和 B 的莫顿数之间？（这不是莫顿命令的重点吗？）

2.  如果 1 为否，A 和 B 是否可以“四舍五入”到保证包含 C 的值？

3.  假设 1 或 2 是可能的，搜索返回是否也指向该框之外，我必须“后过滤”它？“错误集”有多大（它取决于搜索的大小或位置）？

4.  整数有符号的事实是否会导致问题？如果是这样，是否有解决方法？

回顾一下，使用 Morton Numbers 只是实际问题的一种可能解决方案：当 3D 点必须映射到一维值时，如何在 3D 整数空间中有效地进行范围搜索？*我想通过在数据库中执行单个范围选择*，使用最小键和最大键来获得 A 和 B 之间的所有点，理想情况下，在框外获得尽可能少的点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T20:01:19.650

4) 是的，这个标志会引起问题，但解决起来很简单。

**在创建莫顿数之前，只需将 x、y 和 z 的符号位与 1 异或即可。**

为什么这样做（使用一维有符号字节代替）：

二进制中的 -1 是 11111111

二进制中的 0 是 00000000

二进制中的 1 是 00000001

你想要的顺序是-1、0、1，但是当前的二进制顺序是0、1、-1。

-1 异或 10000000 = 01111111

0 异或 10000000 = 10000000

1 异或 10000000 = 10000001

现在你的二进制顺序是正确的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T07:04:56.567

看来我必须自己回答我的问题。答案将与 z 阶曲线有关，这正是我真正要求的。这是据我所知：

1.  是的。它总是像 z 阶曲线那样工作。
2.  无关紧要，因为 1) 是真的。
3.  这取决于该区域有多大以及它在哪里，但最坏的情况是当您实际包括空间的中心时，而不是当您远离它时。对于任何维度，如果您在每个维度中使用深度为 N 位的索引，则存在特殊情况，其中 z 阶曲线为您提供精确匹配，您只能在搜索框中获得点。当满足以下条件时会发生这种情况：
4.  搜索区域在所有维度上都是相同的大小，并且是 2 的幂，2^M，其中 0 <= M <= N。
5.  搜索区域是一个与所有轴对齐的超立方体。
6.  搜索区域超立方体角的所有坐标都是 2^M 的倍数。当所有这些条件都满足时，搜索区域与子树节点完全对应，因此完全匹配。但是，在一般情况下，您能做的最好的事情是找到将容纳所有所需点的最小节点，并将其递归地细分为提供部分匹配的较小节点，达到某个最大所需深度，以获得更好的匹配使用多个查询的成本。找到包含该区域所有角的最小树节点，相当于找到所有角的 Morton 码的公共前缀。而单次查询时，返回的区域外的点数为所查询的那个节点的体积减去搜索区域的体积。
7.  我很确定这是一个问题，但我还没有找到这方面的信息。

好像我说的不太清楚，所以我会做一点 ASCII ART ......

2D 中的基本 Z 阶（莫顿阶）曲线如下所示（路径为 A、B、C、D）：

```
x  0   1

0  A → B
     ↙
1  C → D 
```

所以，A = (0,0) B = (0,1) C = (1,0) D = (1,1)

现在，2D 中的基本希尔伯特曲线如下所示（路径为 A、B、C、D）：

```
x  0   1

0  A   D
   ↓   ↑
1  B → C 
```

所以，A = (0,0) B = (1,0) C = (1,1) D = (0,1)

使用 Z 顺序（莫顿顺序），曲线将从最低点 A (0,0) 开始，并以最高点 D (1,1) 结束，同时覆盖其间的所有点。这使得范围搜索变得容易，并且它也可以在 3D 中工作。3D 盒子 (0,0,0) 到 (1,1,1) 中的所有点都在 (0,0,0) 和 (1,1,1) 的 Morton 订单代码之间。

使用希尔伯特曲线，您从 (0,0) 开始并在 (0,1) 结束（在 3D 中可能相似）。因此，执行从 (0,0) 到 (1,1) 的希尔伯特码的范围查询不会找到所有点。

因此，如果我要使用希尔伯特曲线来执行我对 3D 框 (0,0,0) 到 (1,1,1) 的范围查询（作为单个 DB 查询），我需要一个函数来告诉我什么我应该使用点作为第一点，我应该使用什么点作为最后一点，因为 (0,0,0) 和 (1,1,1)*不起作用*。

那么，是否有这样的函数，您可以在其中提供 8 个（用于 3D）框坐标，并返回要在范围查询中使用的第一个和最后一个点？没有它，我就无法使用希尔伯特曲线来解决我的问题。

或者，在伪 SQL 中：

莫顿查询：

```
SELECT key,data FROM table WHERE (key >= Morton(lowest(box))) AND (key <= Morton(highest(box))) 
```

希尔伯特查询：

```
SELECT key,data FROM table WHERE (key >= Hilbert(XXX(box))) AND (key <= Hilbert(YYY(box))) 
```

所以我需要 XXX() 和 YYY()。

[编辑] 这个答案的一部分是针对其他一些告诉我使用希尔伯特曲线的答案，但后来删除了他们的答案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-12T12:47:52.603

尝试将 3 维减少到 1 维通常不会有太多期望。你可以尝试什么：找到主轴（即通过你的点做一条线），然后将点投影到线上。这为您提供了每个点的请求一维值。当您将框的角投影到线上并取这些值的封闭间隔时，您将获得搜索范围。

# css - Django：是否可以将媒体文件（css、javascript 等）附加到视图类？

> ID：12772902
> 
> 赞同：1
> 
> 时间：2012-10-07T21:12:47.193
> 
> 标签：css, django, templates, view, django-staticfiles

我无法找到有关如何在以下视图中定义 css 或 javascript 文件的任何信息：

类我的视图（视图）： ....

类媒体：css = {'all'：'mystyle.css'}

如果你有一个表格，你可以这样做： class MyForm(ModelForm): ....

类媒体：css = {'all'：'mystyle.css'}

然后在模板中您可以打印文件，例如；{{ form.media.css }}

我非常喜欢这种语法，我喜欢将特定于视图的 css 文件保留在应用程序目录中。

有谁知道这是否可能？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:36:08.843

我想你应该能够在你的视图中设置一个带有 css 文件名/位置的变量，如果你将该变量传递给渲染/响应，你应该能够在你的模板中访问它。

看看[https://docs.djangoproject.com/en/dev/ref/templates/api/#variables-and-lookups](https://docs.djangoproject.com/en/dev/ref/templates/api/#variables-and-lookups)

例子：

```
def my_view(request):
    stylesheet = {"css": "my_view.css"}
    return render(request, 'myapp/templatename.html', stylesheet,
                  content_type="application/xhtml+xml") 
```

他们 templatename.html 将是

```
<link rel="stylesheet" type="text/css" 
href="{{ MEDIA_URL }}{{ stylesheet["css"] }}"  media="screen"/> 
```

# c# - C# 从 WebBrowser 控件中抓取 Cookie 值？

> ID：12772904
> 
> 赞同：2
> 
> 时间：2012-10-07T21:13:00.280
> 
> 标签：c#, cookies, webbrowser-control

我没有使用 webbrowser 控制的经验我正在尝试执行以下操作：导航到网站并抓取它返回的 cookie 值（特定于正则表达式）。我试图在这里搜索这个&谷歌没有关于这个的信息，网络浏览器控件是否连接到 IE？这将无法读取值对吗？有什么方法可以捕获cookie？喜欢 CookieContainer？

我有一个与 httpwebrequest 一起使用的代码，它可以作为我尝试使用 webbrowser 控制的一个示例：

```
 List<string> cookieValues = new List<string>();
            foreach (Cookie cookie in agent.LastResponse.Cookies)
            {
                cookieValues.Add(cookie.Value);
            }
  foreach (string i in cookieValues)
            {
                Match match2 = Regex.Match(i, @"bert=([\w]*)",
                   RegexOptions.IgnoreCase);

                // Ensure match
                if (match2.Success)
                {
                    // Finally, we get Group value and display it.
                    key2 = match2.Groups[1].Value;

                } 
```

感谢您一如既往的帮助！

# java - 多态 EJB 客户端

> ID：12772905
> 
> 赞同：0
> 
> 时间：2012-10-07T21:13:03.743
> 
> 标签：java, jakarta-ee, ejb-3.1

我正在使用 EJB 3.1 和球衣作为 restapi。我想要一个`SuperResource`如下，然后由下面的实际剩余资源继承。我现在拥有它的方式，我的`@EJB`对象是空的。有谁知道如何解决这一问题？

```
@Stateless
public class SuperResource {
    @EJB
    protected GenericDao<DomainObject> dao;
    . . .
}

public class MyResource extends SuperResource{     
    public String doGet(){
       return dao.get(...);
   }
} 
```

`@Stateless`我已经尝试了and`@Local`和`SuperResource`and之间的整个真值表`MyResource`。这些排列似乎都不起作用。

我不知道这是否重要，我的服务器是 Glassfish 3.1.2

编辑添加细节：

我不这么认为，但似乎这里可能需要更多细节：

我的应用程序的结构：

```
@Local
public interface GenericDao<T extends DomainObject> {…}

public interface LoginDao  extends GenericDao<Login>{...}

@Stateless
public class GenericDaoImpl<T extends DomainObject> implements GenericDao<T> {…}

@Stateless
public class LoginDaoImpl extends GenericDaoImpl<Login> implements LoginDao {…}

@Entity
public class Login implements java.io.Serializable, DomainObject {…} 
```

什么有效：

```
@Stateless
@Path("mypath")
public class MyResource{   
@EJB
private LoginDao dao;  
  public String doGet(){
    return dao.get(...);
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:33:48.127

`MyResource`也必须是一个 EJB bean，通过注释它`@Stateless`：

```
@Stateless
public class MyResource extends SuperResource{     
    public String doGet(){
       return dao.get(...);
   }
} 
```

如果您只需要注入的 DAO，则可以选择使用 CDI 将 JAX-RS 资源注入该 DAO。如果您的资源变成了无状态 bean，那么这会产生您需要注意的某些后果（例如为每个方法启动的事务，除非您明确禁用它等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T09:29:13.277

它看起来像 EJB 注入问题。根据服务器，您需要玩转 mappedName/name/beanName

我可以确认的是，以下代码适用于 JBoss 7.1.1。

```
 @Local
        public interface HelloWorldLocal {
            public String sayHello();
        }

        @Stateless
        public class HelloWorldBean implements HelloWorldLocal {
            public String sayHello(){
                return "Hello..............................................................................";
            }
        }

        @Remote
        public interface BaseRemote {
            public String test();
        }

        @Stateless
        public class BaseBean implements BaseRemote{
            @EJB
            HelloWorldLocal bean;
            public String test() {
                return "Base Bean";
            }
        }

        @Remote
        public interface DerivedRemote {
            String test();
        }

        @Stateful
        public class DerivedBean extends BaseBean implements DerivedRemote{
            public String test() {
                return bean.sayHello();
            }
        } 
```

# perl - 构造 DBIx::Class 对象和相关对象但稍后保存

> ID：12772906
> 
> 赞同：0
> 
> 时间：2012-10-07T21:13:06.863
> 
> 标签：perl, orm, dbix-class

我想构造一个 DBIx::Class 对象及其相关对象，但推迟保存对象，`insert`稍后在对象上调用该方法，然后一次保存所有内容。

这是基于 DBIx::Class 文档（艺术家、cd 等）中的示例的示例代码。

```
use MyApp::Schema;
use Data::Dumper ;

sub make_artist_from_some_other_object
{
  my ($object, $schema) = @_ ; 

  my $artist = $schema->resultset('Artist')->new({});
  $artist->name($object->firstname() . ' ' . $object->lastname()) ;

  $artist->new_related('cds', {'title' => $object->firsttitle(), 
                               'year'  => $object->firstyear()}) ;
  $artist->new_related('cds', {'title' => $object->secondtitle(), 
                               'year'  => $object->secondyear()}) ;
  $artist->new_related('cds', {'title' => $object->thirdtitle(), 
                               'year'  => $object->thirdyear()}) ;
  return $artist ;
}

my $schema = MyApp::Schema->connect('dbi:SQLite:dbname=/tmp/abcd.sqlite');
$artist = make_artist_from_some_other_object($some_object, $schema) ;
$artist->insert() ;
# The insert does _not_ save cd information. 
```

我意识到有一些方法可以解决这个问题，例如，保留相关对象然后单独保存它们，但我正在寻找的是一种内置的 DBIx::Class 方法来预先完成所有对象构造，然后进行单个插入一段时间以后。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:04:30.440

目前没有办法做到这一点。您只能使用 insert 创建单独的对象`new_result`并在以后插入它们。通常主键是由数据库分配的，因此在此之前它们不可用。您可以尝试填充关系缓存以实现您想要的。您不立即插入所有行的原因是什么？

# windows-8 - 数据绑定到 Page.BottomAppBar 中的 ElementName

> ID：12772907
> 
> 赞同：4
> 
> 时间：2012-10-07T21:13:37.130
> 
> 标签：windows-8, windows-runtime, winrt-xaml

我正在尝试将 BottomAppBar 内的元素绑定到它之外的元素。

下面是一个用于说明的示例 XAML：

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <TextBox x:Name="text" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>
</Grid>
<Page.BottomAppBar>
    <AppBar>
        <StackPanel Orientation="Horizontal">
            <Button Content="{Binding Text, ElementName=text}" Click="Button_Click_1"></Button>
            <Button Content="{Binding Text, ElementName=text2}" Click="Button_Click_1"></Button>
            <TextBox x:Name="text2" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>
        </StackPanel>
    </AppBar>
</Page.BottomAppBar> 
```

第一个按钮永远不会更新（它绑定到的文本框在 BottomAppBar 之外），但是，第二个按钮会按照您的预期更新。如何使页面对 BottomAppBar 可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-21T17:21:39.277

我没有胆量说它是错误，尽管我相信它就是这样，但我解决了这个问题，这个问题让我像一个星期一样：

**第一：**这不只是针对`BottomAppBar`，`TopAppBar`遭受同样的问题。

**第二：**问题是`ElementName`绑定仅在您的源元素是位于其中一个 AppBars 内的元素时才有效，这意味着：

*   从`BottomAppBar`（目标）到`TopAppBar`（源）：*有效*
*   从`BottomAppBar`（目标）到`BottomAppBar`（源）：*有效*
*   从`TopAppBar`（目标）到`BottomAppBar`（源）：*有效*
*   从`TopAppBar`（目标）到`TopAppBar`（源）：*有效*
*   从`TopAppBar`（目标）到`two AppBars`（源）之外的东西：*不起作用*
*   从`BottomAppBar`（目标）到`two AppBars`（源）之外的东西：*不起作用*

**例子 ：**

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <TextBox x:Name="text" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>
</Grid>
<Page.TopAppBar>
    <AppBar>
        <StackPanel Orientation="Horizontal">
            <Button Content="{Binding Text, ElementName=text}" Click="Button_Click_1"></Button>
            <Button Content="{Binding Text, ElementName=text2}" Click="Button_Click_1"></Button>
            <TextBox x:Name="text3" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>
<TextBox x:Name="text3" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>

        </StackPanel>
    </AppBar>
</Page.TopAppBar>
<Page.BottomAppBar>
    <AppBar>
        <StackPanel Orientation="Horizontal">
            <Button Content="{Binding Text, ElementName=text}" Click="Button_Click_1"></Button>
            <Button Content="{Binding Text, ElementName=text3}" Click="Button_Click_1"></Button>
            <TextBox x:Name="text2" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>
<TextBox x:Name="text3" MinWidth="200" MinHeight="40" VerticalAlignment="Center" HorizontalAlignment="Center"/>

        </StackPanel>
    </AppBar>
</Page.BottomAppBar> 
```

两个 AppBars 中第一个按钮的内容不会显示任何内容，但是两个 AppBars 的第二个按钮将正确显示。

我发现 AppBar 从外部看到的唯一内容是`DataContext`根`Page`元素，因此考虑在 DataContext 中使用支持属性来处理所有这些，这对我来说很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-06T20:28:17.050

它不起作用，因为“文本”文本框与按钮位于不同的可视树中，所以按钮不知道“文本”。这种绑定是不可能直接进行的，但有解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-08T04:53:40.440

你能试试这个

```
<Button Content="{Binding Path=text.Text}" Click="Button_Click_1"></Button> 
```

# linux - list_head 结构如何用于内核中的调度

> ID：12772908
> 
> 赞同：2
> 
> 时间：2012-10-07T21:13:41.373
> 
> 标签：linux, linux-kernel, kernel

我已经阅读了一些内容，从中可以看出，与其使用调度策略来调度任务，不如使用调度策略来调度实体。优点是您可以使用相同的调度策略来调度许多事情。因此，为两个调度策略（CFS 和 RT）定义了两个实体，即 as`sched_entity`和`sched_rt_entity`。CFS 实体的代码是（从 v3.5.4 开始）

```
struct sched_entity {
    struct load_weight  load;       /* for load-balancing */
    struct rb_node      run_node;
    struct list_head    group_node;
    unsigned int        on_rq;

    u64         exec_start;
    u64         sum_exec_runtime;
    u64         vruntime;
    u64         prev_sum_exec_runtime;

    u64         nr_migrations;

#ifdef CONFIG_SCHEDSTATS
    struct sched_statistics statistics;
#endif

#ifdef CONFIG_FAIR_GROUP_SCHED
    struct sched_entity *parent;
    /* rq on which this entity is (to be) queued: */
    struct cfs_rq       *cfs_rq;
    /* rq "owned" by this entity/group: */
    struct cfs_rq       *my_q;
#endif
}; 
```

对于 RT（实时）实体是

```
struct sched_rt_entity {
     struct list_head run_list;
     unsigned long timeout;
     unsigned int time_slice;

     struct sched_rt_entity *back;
     #ifdef CONFIG_RT_GROUP_SCHED
     struct sched_rt_entity  *parent;
     /* rq on which this entity is (to be) queued: */
     struct rt_rq            *rt_rq;
     /* rq "owned" by this entity/group: */
     struct rt_rq            *my_q;
     #endif
}; 
```

这两个都使用`list_head`定义的结构`./include/linux/types.h`

```
struct list_head {
     struct list_head *next, *prev;
}; 
```

老实说，我不明白如何安排这样的事情。谁能解释这是如何工作的。

**PS**：

此外，我真的很难理解数据成员名称的含义。任何人都可以建议阅读理解内核结构的好书，以便我可以轻松地弄清楚这些事情。我花费的大部分时间都浪费在搜索数据成员的含义上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T22:19:14.743

为了实现组调度，引入了调度实体，以便 CFS（或 RT 调度程序）将为单个任务提供公平的 CPU 时间，同时也为任务组提供公平的 CPU 时间。调度实体可以是一个任务或一组任务。

`struct list_head`只是实现链表的Linux方式。在您发布字段的代码中， `group_node`并`run_list`允许创建`struct sched_entity`和的列表`struct sched_rt_entity`。更多信息可以在[这里](http://isis.poly.edu/kulesh/stuff/src/klist/)找到。

使用这些`list_heads`调度实体存储在某些与调度程序相关的数据结构中，例如，`cfs_rq.cfs_tasks`如果实体是使用[`account_entity_enqueue()`](http://lxr.free-electrons.com/source/kernel/sched/fair.c#L780).

始终可以在其源代码中找到 Linux 内核的最新文档。在这种情况下，您应该检查[这个](http://www.mjmwired.net/kernel/Documentation/scheduler)目录，尤其是[这个](http://www.mjmwired.net/kernel/Documentation/scheduler/sched-design-CFS.txt)描述 CFS 的文件。还有对任务组[的解释](http://www.mjmwired.net/kernel/Documentation/cgroups/cgroups.txt)。

**编辑：** `task_struct`包含一个`se`类型的字段`struct sched_entity`。然后，`sched_entity`使用`container_of`宏获得对象的地址，就可以检索`task_struct`对象的地址，请参阅[`task_of()`](http://lxr.free-electrons.com/source/kernel/sched/fair.c#L256)。（对象地址- in =对象地址的`sched_entity`偏移量）这是我在此答案前面提到的列表的实现中也使用的非常常见的技巧。`se``task_struct``task_struct`

# java - 如何在 C++ 中使用 JNI 来使用 Java 类？

> ID：12772910
> 
> 赞同：0
> 
> 时间：2012-10-07T21:13:46.790
> 
> 标签：java, xcode, architecture, jvm, java-native-interface

所以我正在尝试使用 JNI 在 C++ 中调用我的 Java 类，并且在我尝试运行它之前一切看起来都很好。在 Xcode 我得到错误

```
Undefined symbols for architecture x86_64: "_JNI_CreateJavaVM", referenced from: 
```

我认为这与架构有关，但不知道如何解决这个问题，有什么帮助吗？

我用来初始化 Java VM 的代码是

```
JNI_CreateJavaVM(&internal::gJVM, 
(void**)&internal::gEnv, &vm_args); 
```

我在mac上，如果您有任何想法，请发布mac解决方案，我试图避免在运行时加载库。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:17:03.197

这听起来像你错过了一个图书馆。如果您使用 gcc，请检查您所有`-l`的 . 如果您使用的是 VS，请检查 Config->Linker->Input 下的“Additional Dependancies”选项。

还要检查您是否拥有必要库的 x86_64 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:57:42.217

在我看到的所有示例中，它们通过从不直接调用该函数来避免问题，因此它永远不必链接，因此没有错误。诀窍是在运行时查找函数并通过函数指针调用。这是在 Windows 上执行此操作的方法。不知道在其他操作系统上执行此操作的语法。

[免责声明 - 我从几个函数中复制/粘贴了代码，并且可能引入了编译器错误。这可能会或可能不会编译，但它应该让你开始]

首先为指向函数的指针创建自己的 typedef

```
typedef jint (JNICALL* JvmCreateProcTypeDef)(JavaVM **, void **, void); 
```

[使用LoadLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)查找 JVM dll 。由您的应用程序决定在哪里可以找到 JVM DLL。在我们的例子中，我们分发了第 3 方 JRE，并且知道在哪里可以找到 DLL。

```
HMODULE jvmDll = LoadLibrary(jvmDllPath); 
```

接下来使用[GetProcAddress从 JVM dll 中查找函数的地址](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683212%28v=vs.85%29.aspx)

```
JvmCreateProcTypeDef jvmCreateProc = (JvmCreateProcTypeDef) GetProcAddress(jvmDll,"JNI_CreateJavaVM"); 
```

现在将直接调用该函数的代码替换为以下通过函数指针调用它的代码：

```
jvmCreateProc(&internal::gJVM, (void**)&internal::gEnv, &vm_args); 
```

这应该可以让您通过所有编译链接错误。现在您所要做的就是在您的代码找不到 DLL 时处理运行时错误 :)

希望这可以帮助！

# android - 无法使用 FragmentPagerAdapter 设置标签

> ID：12772911
> 
> 赞同：1
> 
> 时间：2012-10-07T21:13:51.627
> 
> 标签：android, fragment

我怎么能在使用`setTag`时。任何建议`Fragment``FragmentPagerAdapter`

```
public class MainFragmentAdapter extends FragmentPagerAdapter {
 public Fragment getItem(int arg0) {
            switch (arg0) {
            case 0:
                SettingsFragment fr = new SettingsFragment(); 
```

~~fr.setTag();~~

```
return fr;
        ...
    ....
    ...

            } 
```

# c++ - 使用 boost 在文件中查找正则表达式

> ID：12772912
> 
> 赞同：2
> 
> 时间：2012-10-07T21:13:51.563
> 
> 标签：c++, regex, file, boost

我想做这样的事情：

```
boost::regex re("tryme");
ifstream iss;
iss.open("file.txt");
istream_iterator<string> eos;     
istream_iterator<string> iit (iss);

find(iit,eos,bind2nd(boost::regex_match),re)); 
```

错误如下：

> 找不到匹配 'bind2nd<_Fn2,_Ty>(bool (*) (BidiIterator,BidiIterator,match_results &,const basic_regex &,unsigned long))'
> 
> 找不到匹配的 'find(istream_iterator,int>,istream_iterator,int>,undefined,regex)'

你能帮我正确地做吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T21:41:56.603

第一个问题是`std::find()`尝试匹配值，即您需要替换`std::find()`为`std::find_if()`. 这很简单。

下一个问题是它`boost::regex_match`不是一个函数，而是一系列函数。`std::bind2nd()`不知道你想匹配这个家庭的哪个成员。此外，您显然想要使用的函数重载需要三个而不是两个参数：类型的最后一个参数`boost::match_flag_type`是默认的。我让它`std::bind()`使用这个：

```
std::bind(static_cast<bool (*)(std::string const&,
                               boost::regex const&,
                               boost::match_flag_type)>(&boost::regex_match),
         std::placeholders::_1, re); 
```

如果你真的想使用`std::bind2nd()`它可能是最简单的创建一个简单的转发函数：

```
bool my_regex_match(std::string s, boost::regex const& r) {
    return boost::regex_match(s, r);
}

void f() {
    boost::regex re("tryme");
    std::ifstream iss(file.txt);
    std::find_if(std::istream_iterator<std::string>(iss),
             std::istream_iterator<std::string>(),
             std::bind2nd(std::ptr_fun(&my_regex_match), re));
} 
```

`std::bind2nd()`模板不能真正使用原始函数指针。这就是为什么`std::ptr_fun()`需要使用。通常，当`*_fun()`需要使用任何被调用的标准函数时，乐趣实际上就停止了：这些函数无法处理通过引用获取参数的函数。因此，按值`my_regex_match()`获取参数：否则将尝试创建一个函数对象，以引用引用作为参数。这是您可能想要使用or的另一个原因。`std::string``std::bind2nd()``std::bind()``boost::bind()`

# c# - 打开 PDF 文档并向其添加书签

> ID：12772913
> 
> 赞同：2
> 
> 时间：2012-10-07T21:14:01.440
> 
> 标签：c#, vb.net, pdf, itextsharp, itext

我想打开一个 PDF 文档并添加一些书签。我有书签的标题，以及与之关联的页码（单击书签将转到文档中的指定页面）。

转到指定页面时，不应更改当前缩放*级别*。

VB.Net 示例会很棒，但也欢迎使用 C#。

我使用 iTextSharp 5.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:03:45.443

作为一个 java 资源，我不会在你想要的确切代码中为你提供太多帮助，但通用算法也适用。对于没有孩子的单个书签（iText 使用术语孩子我认为你可以在 iTextSharp 中找到它）如下

```
private static List<HashMap<String, Object>> manipulatePdfBookMarkUtil(SortedMap<Integer, String> pgTtl, Rectangle rct) {
    List<HashMap<String, Object>> mpBkMrkLst = null;
    int itrCnt = 0;
    if (pgTtl != null && !pgTtl.isEmpty()) {
        mpBkMrkLst = new ArrayList<HashMap<String, Object>>();
        for (Map.Entry<Integer, String> itrTtlPg : pgTtl.entrySet()) {
            HashMap<String, Object> retMap = new HashMap<String, Object>();
            retMap.put("Title", itrTtlPg.getValue());
            retMap.put("Action", "GoTo");
            retMap.put("Page", itrTtlPg.getKey() + " FitH " + rct.getTop());
            mpBkMrkLst.add(itrCnt, retMap);
            itrCnt++;
        }
    }
    return mpBkMrkLst;
    } 
```

List> Object-->List> 等等。我用过 iText(2.1.4)。我使用页码的排序映射作为键（itrTtlPg.getKey()）和书签标题作为值（itrTtlPg.getValue()）。Title-->是你想要的书签标题。Action-->simply 这是你想要采取的行动（正如价值“Go To”所暗示的那样）。"Page", pageNum + "FitH" + position;所以这意味着当您单击指定字符串（标题）的书签时，它将定位由pageNum指定的页面并在您提到的位置水平适应整个区域（这里的矩形对象是页面大小，所以顶部意味着它将水平放置在顶部）。FitV 也在那里，以垂直放置它，以便整个页面可以以窗口大小显示。另一件要提到的事情是你提到的保持缩放级别不变，你必须使用 FitH。

# php - android：当我将 jsonobject 发送到服务器 php 返回错误 400

> ID：12772916
> 
> 赞同：0
> 
> 时间：2012-10-07T21:14:23.010
> 
> 标签：php, android, json

我有一个小问题，我必须将所有联系人从电话发送到服务器。此代码在发送具有 20 或 40 个联系人的 JSONObject 时有效，但当我发送 400 个联系人时返回此错误

```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
 <title>400 Bad Request</title>
 </head><body>
 <h1>Bad Request</h1>
 <p>Your browser sent a request that this server could not understand.<br />
Size of a request header field exceeds server limit.<br />
  <pre>
  json
 </pre>/n</p>
  <hr>
  <address>Apache Server at default Port 80</address>
 </body></html> 
```

**这是代码的工作原理**

```
public String postData(String url,JSONObject obj) {
        // Create a new HttpClient and Post Header

        HttpParams myParams = new BasicHttpParams();
        HttpConnectionParams.setConnectionTimeout(myParams, 10000);
        HttpConnectionParams.setSoTimeout(myParams, 10000);
        HttpClient httpclient = new DefaultHttpClient(myParams);
        String json=obj.toString();

        try {

            HttpPost httppost = new HttpPost(url.toString());
            httppost.setHeader("json", obj.toString());

           StringEntity se = new StringEntity(obj.toString()); 
           se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
            httppost.setEntity(se); 

            HttpResponse response = httpclient.execute(httppost);
            String temp = EntityUtils.toString(response.getEntity());
            Log.i("post_data2 - popolo", temp);

             return temp;

        } 
```

感谢您的回复

/ ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ****

我自己解决了。我希望它可以帮助某人。我为此更改了函数 postData。

```
public void postinsert(String url,String unico_id) {

        try{
            unico_id = URLEncoder.encode("unique_id", "UTF-8") + "=" + URLEncoder.encode(unico_id, "UTF-8");
            URL url1 =new URL(url);
              URLConnection con = (URLConnection) url1.openConnection();
              con.setDoOutput(true);
              OutputStreamWriter wr = new OutputStreamWriter(con.getOutputStream());
              wr.write(unico_id);
              wr.flush();
              BufferedReader recv = new BufferedReader(new InputStreamReader(con.getInputStream()));
              //Los mostramos por pantalla
               s = recv.readLine();
              while(s!=null){
                      System.out.println(s);
                      s=recv.readLine();
                    }
           }catch (Exception e){
               System.out.println(e.getMessage());
           }

        } 
```

# excel - 出现错误 91

> ID：12772920
> 
> 赞同：1
> 
> 时间：2012-10-07T21:14:44.487
> 
> 标签：excel, vba

我对类和对象有一个普遍的理解问题。我想做的很简单，但我遇到了错误。在下面的代码示例中，有时“Call tables.MethodInCTables”行运行良好，有时会产生错误 91，未设置对象。在所有情况下，我都可以“看到”前面类型中的方法，因此我知道代码可以识别“表”实例并“看到”MethodInCTables。但是后来我得到了运行时错误。

```
Sub MainSub() 
Dim tables as New CTables 
Call tables.MethodInCTables 
End Sub 
```

----类模块=CTables

```
Sub MethodInCTables()
 ...do something 
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:43:09.200

您需要初始化 CTables 类型：

```
Sub MainSub()
    Dim tables As New CTables 
    Call tables.MethodInCTables
End Sub 
```

或者：

```
Sub MainSub()
    Dim tables As CTables
    Set tables = New CTables
    Call tables.MethodInCTables
End Sub 
```

# java - 在java中的首选项中更改true false

> ID：12772925
> 
> 赞同：3
> 
> 时间：2012-10-07T21:15:13.267
> 
> 标签：java, android

我正在尝试使用视图类中的按钮来关闭应用程序的声音。（即：静音）当用户按下框时，我希望代码检查值是否已经为真或闪烁，然后使用名为“静音”的 ID 设置为相反。我想我有 IF 部分设置，只需要轻松地将 SharedPreferences 从 true 更改为 flase ，反之亦然......

这是我正在测试的代码框架（之前）：

```
SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
boolean cmute = getPrefs.getBoolean("mute", defValue);
if (cmute == true){                     

}
if (cmute == false){

} 
```

我已经尝试了各种解决方案的发现，但对于我认为这个简单的需求来说，大多数都太复杂了。

这是我在发布建议后的返工：

```
if (cmute == false){

                    Editor editor = getPrefs.edit();
                    editor.putBoolean("mute", true);
                    editor.commit();
                    Editor editor2 = getPrefs.edit();
                    editor.putBoolean("notice", true);
                    editor.commit();

                }
                if (cmute == true){

                    Editor editor = getPrefs.edit();
                    editor.putBoolean("mute", false);
                    editor.commit();
                    Editor editor2 = getPrefs.edit();
                    editor.putBoolean("notice", false);
                    editor.commit();

                } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T21:28:51.183

这可以通过[`Editor`](http://developer.android.com/reference/android/content/SharedPreferences.Editor.html)接口实现：

> 用于修改 SharedPreferences 对象中的值的接口。您在编辑器中所做的所有更改都是批处理的，并且在您调用 commit() 或 apply() 之前不会复制回原始 SharedPreferences

这应该对你有用：

```
SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
boolean cmute = getPrefs.getBoolean("mute", defValue);
Editor editor = getPrefs.edit();
editor.putBoolean("mute", !cmute);
editor.commit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T12:36:57.747

评论您的 AFTER 建议版本：无需创建`editor2`，您甚至不使用它，您`editor`在后续行中引用。也无需调用两次提交。并且通过使用`!`platzhirsch 已经建议的 not 运算符，您不再需要`if(cmute...`

```
Editor editor = getPrefs.edit(); 
editor.putBoolean("mute", !cmute);
editor.putBoolean("notice", !cmute); 
editor.commit(); 
```

# .net - 延迟加载嵌套集

> ID：12772926
> 
> 赞同：0
> 
> 时间：2012-10-07T21:15:21.550
> 
> 标签：.net, entity-framework, lazy-loading

我正在使用带有 Code First 的实体框架来保存我的数据。

有一个带有嵌套列表的类：

```
public class AgeGroup
{
    public BindingList<WeightGroup> WeightGroups { get; set; }
} 
```

数据库上下文包括

```
public DbSet<AgeGroup> AgeGroups { get; set; } 
```

我正在创建一个窗口，用户可以在其中修改`AgeGroup`s 及其根据`WeightGroup`s。为了将 a`ListBox`的`ItemsSource`属性`AgeGroups`绑定到 ，我加载它们并绑定到`Local`集合：

```
ctx.AgeGroups.Load();
vm.AgeGroups = ctx.AgeGroups.Local; 
```

到目前为止，`WeightGroups`还没有加载它们，因为它们不是必需的。到目前为止，一切都很好。

当用户选择一个`AgeGroup`进行修改时，它`WeightGroups`必须被加载。到目前为止，我这样做（在`SelectedAgeGroup`属性的设置器中）：

```
value.WeightGroups = (from age in ctx.AgeGroups
                      where age.Id == value.Id
                      select age.WeightGroups).Single(); 
```

但是，这似乎有点笨拙。首先，因为设置了一个新列表而不是填充现有列表。此外，还有一些不受欢迎的行为。这包括例如以下内容：

*   如果 a`WeightGroup`被修改并被`SaveChanges()`调用，旧组仍然存在，另外还有一个具有修改值的新组。
*   `SelectedAgeGroup.WeightGroups.Remove(...)`如果用户使用和删除实体`SaveChanges()`，则删除的行仍然存在。

我认为，上面列出的重量组的重新加载是造成这种情况的原因。

在这种情况下，正确的延迟加载会是什么样子？理想情况下，`WeightGroups`框架会自动加载必要的内容。我阅读了有关使用 an`IQueryable`而不是属性`BindingList`的信息。`WeightGroups`但是这个接口没有插入和删除实体的方法。此外，如果我只是交换类型，甚至根本不会`AgeGroups`加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T21:27:16.477

您应该能够通过将 WeightGroups 设为虚拟来解决此问题，至少如果您使用的是 EF 4.1 或更高版本...

```
public class AgeGroup
{
    public virtual BindingList<WeightGroup> WeightGroups { get; set; }
} 
```

您还必须在上下文中包含一个 DbSet ...

```
public DbSet<WeightGroup> WeightGroups { get; set; } 
```

然后，当您触摸该属性时，它将自动加载，例如将其显示在列表中。

# image - 以 Sphinx（重组文本）格式指定在线图像

> ID：12772927
> 
> 赞同：11
> 
> 时间：2012-10-07T21:15:27.690
> 
> 标签：image, python-sphinx, restructuredtext, directive

关于在使用 Sphinx 记录时如何参考在线图像的任何想法？

这不起作用：

```
.. image:: http://www.mysite.com/images/someimage.png 
```

给我：

```
/home/user/proj/2010/11/08/the_forever_war.rst:11: WARNING: nonlocal image URI found: http://www.mysite.com/images/someimage.png 
```

谢谢...

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2015-02-28T06:40:17.233

从 sphinx 1.4 开始，您可以`docs/conf.py`像这样从文件中“猴子补丁”sphinx：

```
import sphinx.environment
from docutils.utils import get_source_line

def _warn_node(self, msg, node, **kwargs):
    if not msg.startswith('nonlocal image URI found:'):
        self._warnfunc(msg, '%s:%s' % get_source_line(node), **kwargs)

sphinx.environment.BuildEnvironment.warn_node = _warn_node 
```

此答案的先前版本提供了一个与最新的 sphinx 1.4 版本不兼容的补丁 [1]。此外，下一个版本的 sphinx 应该支持这个配置选项[2]：

```
suppress_warnings = ['image.nonlocal_uri'] 
```

这将排除“找到非本地图像 URI”的任何警告。

我发现这是必要的，因为我希望在`sphinx-build -W`我的测试和构建基础架构中发出“错误警告”，以确保文档中没有错误——我非常清楚我正在使用非本地图像 URI，而且我没关系，但我不想忽略其他警告。

[1] [https://github.com/sphinx-doc/sphinx/issues/2429#issuecomment-210255983](https://github.com/sphinx-doc/sphinx/issues/2429#issuecomment-210255983)

[2] [https://github.com/sphinx-doc/sphinx/issues/2466](https://github.com/sphinx-doc/sphinx/issues/2466)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-27T18:41:32.880

我为此使用原始 html 代码，例如：

```
.. raw:: html

   <p style="height:22px">
     <a href="https://travis-ci.org/aio-libs/aiozmq" >
       <img src="https://travis-ci.org/aio-libs/aiozmq.svg?branch=master"/>
     </a>
   </p> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-07T21:46:48.533

真是太丢人了……

正如德尔南在他的评论中提到的那样，我只会收到警告。

在我的辩护中，我在确定图像指令之前尝试了一些非常复杂的原始指令，我只是在查看 Sphinx 的输出而不是在渲染的页面上。当我看到 Sphinx 的长输出时，我以为我又遇到了另一个错误。

尽管如此，我应该受到责备......图像加载正常。

# c# - 在 Mono 上测试文件权限

> ID：12772930
> 
> 赞同：4
> 
> 时间：2012-10-07T21:15:45.617
> 
> 标签：c#, mono, file-permissions

我正在使用 Mono 开发跨平台应用程序。我想检查运行应用程序的用户的 RW 访问权限。在 NT 上，我可以使用 .GetAccessControl 方法（在 Mono 上抛出 PlatformNotSupported 异常），但如何处理 *nix 和 MacOS？是否有任何跨平台解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T21:32:46.663

Mono.Unix 具有 UNIX 特定的实现：

```
var ufi = new UnixFileInfo("/tmp/test.cpp");
ufi.CanAccess(AccessModes.F_OK); // is a file/directory
ufi.CanAccess(AccessModes.R_OK); // accessible for reading
ufi.CanAccess(AccessModes.W_OK); // accessible for writing
ufi.CanAccess(AccessModes.X_OK); // accessible for executing
FileSpecialAttributes sa = ufi.FileSpecialAttributes; //setuid, setgid and sticky bits
FileAccessPermissions fa = ufi.FileAccessPermissions; 
```

FileAccessPermissions 定义为：

```
[Flags ()]
public enum FileAccessPermissions {
    UserReadWriteExecute,
    UserRead,
    UserWrite,
    UserExecute,
    GroupReadWriteExecute,
    GroupRead,
    GroupWrite,
    GroupExecute,
    OtherReadWriteExecute,
    OtherRead,
    OtherWrite,
    OtherExecute,
    DefaultPermissions,
    AllPermissions
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T21:18:31.487

尝试打开 RW 文件并查看它是否成功如何？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T21:59:50.930

`File.GetAttributes(path)`

[http://msdn.microsoft.com/en-us/library/system.io.fileattributes.aspx](http://msdn.microsoft.com/en-us/library/system.io.fileattributes.aspx)

没有那么多的信息`.GetAccessControl`，但你可以确定文件是否`ReadOnly`

# gwt - stackpanel 和 stacklayoutpanel 的区别

> ID：12772935
> 
> 赞同：0
> 
> 时间：2012-10-07T21:16:39.560
> 
> 标签：gwt

我无法理解两者之间的区别。

在什么情况下应该使用哪一个？

有什么利弊吗？

代码[http://gwt.google.com/samples/Showcase/Showcase.html#!CwStackPanel](http://gwt.google.com/samples/Showcase/Showcase.html#!CwStackPanel)和 stacklayoutpanel 和描述看起来一样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:19:46.553

如果您阅读[javadocs](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/StackPanel.html)，您会发现 StackPanel 仅适用于 quirks 模式，而 StackLayoutPanel 仅适用于标准模式。它们在功能上是相同的，但您需要根据应用程序运行的模式来选择其中一种。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:02:27.940

我一直主张，在了解了 GWT Java 的怪癖之后，在编写 GWT Java 时，你需要承担你实际上是在用 Javascript 编程的态度，...

学习 GWT 时要理解的第一个概念是理解 ProvidesResize/RequiresResize 接口的用途和功能。

[使用 GWT 在 DisclosurePanel 中调整大小布局面板](https://stackoverflow.com/questions/12284139/resizelayoutpanel-inside-disclosurepanel-using-gwt/12292171#12292171)

[是否适用于企业应用程序的 GWT](https://stackoverflow.com/questions/11407649/gwt-or-not-for-enterprise-apps/11410872#11410872)

StackLayoutPanel 属于 ProvidesResize/RequiresResize 框架。

如果您使用像 StackPanel 这样的非布局面板，您将不得不编写自己的调整大小框架，或者至少尝试在其中实现这对接口，这可能涉及调度和去抖动操作，以便为用户提供愉快的体验。

如果您的 UI 很简单并且不包含复杂而深入的面板和小部件层次结构，则可以使用非布局面板。

为了允许布局面板的功能，您需要将托管页面置于标准模式。因此，说布局面板和非布局面板之间的区别是标准模式并不准确，因为您需要知道拥有 ProvidesResize/RequiresResize 接口背后的动机。

[https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels#Resize](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels#Resize)

我猜怪癖模式是允许浏览器页面以过时的怪异模式运行，在这种模式下，每个人都试图取悦每个人关于 HTML 应该如何表现的古怪个人主义想法（微软是 HTML 怪癖的最好战的实践者）。

什么是标准模式：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels#Standards](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels#Standards)

# table-footer - 页脚问题

> ID：12772936
> 
> 赞同：0
> 
> 时间：2012-10-07T21:16:45.647
> 
> 标签：table-footer

我目前正在尝试向我的页脚添加链接，以便它们在页脚内从左到右显示。目前，它们正显示在页面下方的列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-16T06:24:07.270

尝试 ol 而不是 li。这应该这样做。

# java - Java在一个long中存储两个整数

> ID：12772939
> 
> 赞同：35
> 
> 时间：2012-10-07T21:17:13.420
> 
> 标签：java, bit-manipulation, primitive

我想长期存储两个整数（而不是`Point`每次都创建一个新对象）。

目前，我试过这个。它不起作用，但我不知道它有什么问题：

```
// x and y are ints
long l = x;
l = (l << 32) | y; 
```

我得到这样的 int 值：

```
x = (int) l >> 32;
y = (int) l & 0xffffffff; 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-10-07T21:22:23.377

`y`在第一个片段中进行符号扩展，这将覆盖`x`为.`-1``y < 0`

在第二个片段中，转换`int`为在班次之前完成，因此`x`实际上获得了 的值`y`。

```
long l = (((long)x) << 32) | (y & 0xffffffffL);
int x = (int)(l >> 32);
int y = (int)l; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-08-06T22:03:40.753

这是另一个使用字节缓冲区而不是按位运算符的选项。速度方面，它更慢，大约是速度的 1/5，但更容易看到发生了什么：

```
long l = ByteBuffer.allocate(8).putInt(x).putInt(y).getLong(0);
//
ByteBuffer buffer = ByteBuffer.allocate(8).putLong(l);
x = buffer.getInt(0);
y = buffer.getInt(4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-28T18:15:18.460

如果要将两个（32 位）浮点值存储为单个长整型值（64 位）。您可以将浮点值的位转换为整数值的位，然后转换为与前面的答案相同。

```
// first method using floatToIntBits 
long method1(float x, float y) {

    int xInt = java.lang.Float.floatToIntBits(x);
    int yInt = java.lang.Float.floatToIntBits(y);

    return (((long)xInt) << 32) | (yInt & 0xffffffffL);
}

// second method using ByteBuffer
long method2(float x, float y) {
    return ByteBuffer.allocate(java.lang.Long.BYTES).putFloat(x).putFloat(y).getLong(0);
} 
```

# c# - Facebook Connect 需要 30 多秒才能获得 access_token

> ID：12772940
> 
> 赞同：0
> 
> 时间：2012-10-07T21:17:15.023
> 
> 标签：c#, .net, facebook, oauth, facebook-access-token

我正在尝试设置 Facebook Connect 身份验证，但拉回访问令牌需要 30 秒或更长时间。当我通过网络浏览器浏览到生成的 URL 时，它会在不到 1 秒的时间内返回。花了这么长时间的代码行是`using (StreamReader sr = new StreamReader(request.GetResponse().GetResponseStream()))`我尝试替换`WebRequest`为`WebClient`希望它会更快，但没有这样的运气。一旦我有了令牌，下一个`WebRequest`实际提取用户数据的速度就非常快了。我知道这不是正常行为，因为我已经看到很多网站非常快速地进行此身份验证。任何建议将不胜感激。这是我正在使用的代码：

```
public ActionResult FBLogin()
{
    string uri = string.Format("http://{0}{1}/Shared/FBLogin", Request.Url.Host, Request.UrlIsDefaultPort ? string.Empty : string.Format(":{0}", Request.Url.Port));

    string code = Request["Code"];
    string state = Request["State"];

    if (Request["Code"].IsNullOrEmptyTrim())
    {
        state = MD5.GetMD5String(Guid.NewGuid().ToString());

        Session["State"] = state;

        string redirectUrl = string.Format("https://www.facebook.com/dialog/oauth?client_id={0}&redirect_uri={1}&scope=email&state={2}", Settings.FacebookAppID, uri, state);

        return Redirect(redirectUrl);
    }
    else
    {
        if (state.Equals(Session["State"]))
        {
            Session["State"] = null;

            string tokenUrl = string.Format("https://graph.facebook.com/oauth/access_token?client_id={0}&redirect_uri={1}&client_secret={2}&code={3}", Settings.FacebookAppID, uri, CryptoProvider.DecryptString(Settings.FacebookSecretKey), code);
            string token = null;

            WebRequest request = WebRequest.Create(tokenUrl);

            using (StreamReader sr = new StreamReader(request.GetResponse().GetResponseStream()))
            {
                token = ParseQueryString(sr.ReadToEnd())["access_token"];
            }

            if (token != null)
            {
                string userUrl = string.Format("https://graph.facebook.com/me?access_token={0}", token);

                request = WebRequest.Create(userUrl);

                dynamic user;

                using (StreamReader sr = new StreamReader(request.GetResponse().GetResponseStream()))
                {
                    JavaScriptSerializer serializer = new JavaScriptSerializer();
                    user = serializer.DeserializeObject(sr.ReadToEnd());
                }

                if (user != null)
                {
                    // handle login
                }
            }
        }

        return Redirect(Request.Cookies["LastURL"].Value);
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T05:03:30.290

结果证明代码是正确的。它只是突然自己加速了。我最好的猜测是，Facebook 上新创建的应用程序可能需要几天时间才能通过其服务器完全传播，导致它需要一段时间才能定位。

# javascript - 在没有 jQuery 的情况下获取画布中的光标位置

> ID：12772943
> 
> 赞同：4
> 
> 时间：2012-10-07T21:18:22.480
> 
> 标签：javascript, html, canvas, position, mouse-cursor

我正在尝试学习如何使用 HTML 画布元素，当然，我正在制作一个绘图应用程序。因此，我为应用程序的实际绘图和动画部分设置了代码，但我不确定如何获取鼠标光标的位置。

我真的不想使用 jQuery，因为我不想学习它的所有功能并且必须经历设置它的过程。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-07T21:26:44.340

```
 function getMousePos(canvas, evt) {
    var rect = canvas.getBoundingClientRect(), root = document.documentElement;

    // return relative mouse position
    var mouseX = evt.clientX - rect.left - root.scrollLeft;
    var mouseY = evt.clientY - rect.top - root.scrollTop;
    return {
      x: mouseX,
      y: mouseY
    };
  }

  window.onload = function() {
    var canvas = document.getElementById('myCanvas');
    var context = canvas.getContext('2d');

    canvas.addEventListener('mousemove', function(evt) {
      var mousePos = getMousePos(canvas, evt);
      var message = "Mouse position: " + mousePos.x + "," + mousePos.y;
      alert(message);
    }, false);
  }; 
```

[资源](http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:19:16.090

当使用它在画布上绘图时，我更喜欢这段代码：

```
 function getMousePos(canvas, event)
{
    var mouseX = event.pageX - canvas.offsetLeft;
    var mouseY = event.pageY - canvas.offsetTop;
    return {
        x: mouseX,
        y: mouseY };
} 
```

这是我用来避免滚动、定位和获取鼠标正确位置时遇到的其他问题的代码。

# angularjs - 检查 angularjs 中选择的下拉选项

> ID：12772948
> 
> 赞同：0
> 
> 时间：2012-10-07T21:18:32.827
> 
> 标签：angularjs

我的页面中有一个表单，它通过角度模型映射到 JSON，不幸的是，当页面加载时，我无法知道选择元素是 null、零还是有值。

在页面加载时检查选择值的更简单方法是什么，以便我可以确定下一步操作。

正如您在小提琴中看到的那样，我有一个“状态”下拉菜单，在页面加载时我需要检查是否有任何选项被标记为选中，如果是，我需要提取选中的选项并执行ajax 调用它。

我想利用 $pristine 但这仅用于输入，我认为它不适用于选择元素，对吗？

出于说明目的，我将一段 json 复制到小提琴上，这样您就可以看到我在加载页面时看到的内容。

第二个问题类似，但对于输入元素，json 可能会返回（基于预加载的数据），其中包含 null、零或某个值。那么如何检查该字段的页面加载并查看值是什么？

json 在后端调用数据库后由服务器传递给我，所以我不知道传入的是什么类型的值。

这是小提琴：http: [//jsfiddle.net/jorgecas99/S8gMr/](http://jsfiddle.net/jorgecas99/S8gMr/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:13:54.127

从你的小提琴中仍然不太清楚并质疑你需要什么，但我玩了你的小提琴并制作了一些我期望它做的东西:-)

[http://jsfiddle.net/Td2NZ/](http://jsfiddle.net/Td2NZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-08T10:54:06.530

使用 angularjs 检查下拉列表

[http://jsfiddle.net/nimeshvaghasiya/f9fGD/](http://jsfiddle.net/nimeshvaghasiya/f9fGD/)`enter code here`

# python - cv2.cameraCalibration 使用 python

> ID：12772950
> 
> 赞同：5
> 
> 时间：2012-10-07T21:19:00.833
> 
> 标签：python, opencv, python-2.7

我正在尝试学习如何使用 openCV 和 python 进行 3D 和立体相机校准。使用 8x6 棋盘（7x5 内角）的 3 个摄像机视图，我能够`cv.calibrateCamera()`正常工作，但在使用 cv2 时完全卡住了。步骤之一是找到棋盘角。将角点作为点列表返回，而`cv.findChessboardCorners()`cv2 使用 numpy 数组，并将点作为 (35,1,2) numpy 数组返回。cv2.calibrateCamera() 的参数是`object_points`、`image_points`和`image_size`。我在 numpy 数组中提供对象点，在`(3,35,3)`numpy 数组中提供图像点`(3,35,2)`。图像大小为`(1632, 1224)`. 谁能告诉我问题是什么？我得到的错误不是很有用：

```
Traceback (most recent call last):
  File "H:/pyCV/locv_book/ch11/calCamera2a.py", line 46, in <module>
  cv2.calibrateCamera(opts,ipts,size)
error: ..\..\..\src\opencv\modules\calib3d\src\calibration.cpp:3173: error: (-215) ni >= 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T18:56:23.947

点需要为 float32，矩阵形式为 (N,2) 和 (N,3)。您可以通过以下方式转换为 float32：

```
points32 = np.array(points,dtype=np.float32) 
```

# c# - 数据绑定和 WPF

> ID：12772957
> 
> 赞同：3
> 
> 时间：2012-10-07T21:20:18.037
> 
> 标签：c#, wpf, data-binding, .net-4.5

在开始使用 WPF 框架时，我遇到了一个有趣的情况。

我有以下代码来创建**Foo类型的 ObservableCollection**

```
ObservableCollection<Foo> myFoo; 
```

Foo 具有以下属性：

*   字符串名称
*   字符串文件夹
*   ObservableCollection 项

Name 和 Folder 都实现了 OnPropertyChanged 事件（Items 已经使用 ObservableCollection 所以我相信不需要额外的实现工作）。

对于 myFoo 中的每个项目，我想显示以下内容：

*   姓名
*   文件夹
*   Items 中 FileInfo.FullName 的每个值。

例如

*   测试名称 1
*   测试文件夹 1
*   档案A.JPG
*   文件B.JPG
*   文件C.PNG

*   测试名称 2

*   测试文件夹 2
*   文件D.JPG
*   文件E.JPG
*   文件F.JPG

我已经实现了 Name 和 Folder 属性的绑定，但是我不太确定应该如何实现绑定每个 Items.FileInfo.FullName 出现的值。

我需要实现一个转换器吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:32:38.140

你需要调查一下[`HierarchicalDataTemplate`](http://msdn.microsoft.com/en-us/library/system.windows.hierarchicaldatatemplate.aspx)。也许从[这个问题](https://stackoverflow.com/questions/310666/recursive-hierarchicaldatatemplate-wpf)开始。

# .htaccess - RewriteEngine 导致错误 500

> ID：12772961
> 
> 赞同：0
> 
> 时间：2012-10-07T21:21:36.167
> 
> 标签：.htaccess, mod-rewrite, httpd.conf

我正在尝试编写一个重写引擎。所以我在 .htaccess 文件中写了这个：

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule     ^(.+)$ index.php?url=$1 [QSA, L] 
```

我收到 500 错误消息。

我检查了 httpd.conf 文件和这一行

```
LoadModule setenvif_module modules/mod_setenvif.so 
```

没有被注释掉。。

我还尝试像这样从 .htaccess 文件中注释掉所有这些行，

```
#RewriteEngine on

#RewriteCond %{REQUEST_FILENAME} !-d
#RewriteCond %{REQUEST_FILENAME} !-f
#RewriteCond %{REQUEST_FILENAME} !-l

#RewriteRule     ^(.+)$ index.php?url=$1 [QSA, L] 
```

但我仍然收到 500 错误。我还能看什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T22:09:16.363

我找到了解决方案——它必须以 unix 格式而不是 dos 格式保存。

打开notpad++->编辑->EOL转换->unix格式

# java - 为什么 Eclipse 不会将这些文件检测为我的文件夹的一部分？

> ID：12772963
> 
> 赞同：5
> 
> 时间：2012-10-07T21:21:43.273
> 
> 标签：java, eclipse

我有一堆 Java 项目的类文件，但它没有将它们检测为文件夹的一部分。

查找器：http: [//i.imgur.com/u1sMJ.png](http://i.imgur.com/u1sMJ.png)

日食：http: [//i.imgur.com/EOXwG.png](http://i.imgur.com/EOXwG.png)

我似乎无法访问它们，这很烦人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-07T21:24:16.237

右键单击该项目，然后单击“刷新”。那应该解决它。您还可以转到首选项并在“常规”>“工作区”中启用“通过本机挂钩或轮询刷新”和“访问时刷新”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:15:15.077

如果您通过 Finder（或 Windows 资源管理器）将文件复制到项目文件夹中，则默认情况下您需要刷新 Eclipse 以将其同步到底层文件系统。或者，您可以避免将文件复制到 Eclipse 之外的项目中，而是使用 Eclipse 的 Navigator（类似于 Finder）或 Package Explorer 视图——例如，您可以从文件系统拖放到 Navigator 视图中。

在 Eclipse > Preferences > General > Workspace 中还有几个刷新选项可能有助于自动同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T06:30:00.377

如果您想在 Eclipse 中更改某些内容，则永远不要尝试在文件系统上执行某些操作。Eclipse 有自己的世界观，也就是所谓的工作空间。只有那个工作空间很重要。

因此，请在 Eclipse 中创建一个新的 Java 项目，然后使用 File -> Import -> General -> File System 将现有的 Java 文件导入到 Java 项目的源文件夹中。

# scala - scala中的二叉树遍历

> ID：12772964
> 
> 赞同：2
> 
> 时间：2012-10-07T21:21:52.573
> 
> 标签：scala, binary-tree

给定 bin 树 defn ：

```
// a binary tree node
 case class Node( var data:(Int), 
     left:Option[Node],
     right:Option[Node] 
       ) 
```

我需要得到二叉树的顺序树遍历。例如：

```
val testtree = Node( (3),
                     None,
                     Some(Node( (5),
                                Some(Node( (1),
                                     None,
                                     None )),
                             Some(Node( (9),
                                      None,
                                      Some(Node( (15), 
                                                 None,
                                                 None )) ))  ))  ) 
```

为了这棵树 shd 是：3,5,1,9,15

我试过的代码：

```
 def inOrder(t: Node): Unit ={  
   def print(data:Int,t:Option[Node]):Unit={
      if(t!=None)
                    {
                        print(data,t.left)
            Console.print(data)
            print(data,t.right)
        }      
   }
   print(t.data,t)  
 } 
```

但它不工作。有人可以帮我吗。

完整代码：

```
 case class Node( var data:(Int), 
         left:Option[Node],
         right:Option[Node] 
           )

object Ch15 {

  def main( args:Array[String] ) = {
   val tree =Node( (3), None,Some(Node( (5), Some(Node( (1), None, None )), Some(Node( (9), None,Some(Node( (15), None, None )) )) )) )    
   inOrder( tree ) 
  }

  def inOrder(t: Node): Unit ={  
   def print(data:Int,t:Option[Node]):Unit={
      if(t!=None)
      {
            print(data,t.left)
            Console.print(data)
            print(data,t.right)
        }      
   }
   print(t.data,t)  
 }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-01-31T10:52:19.703

```
case class Branch(node: Int, left: Option[Branch] = None, right: Option[Branch] = None)

object TreeTraverse extends App {
  val branch = Branch(1, Some(Branch(2, Some(Branch(4)), Some(Branch(5)))), Some(Branch(3, Some(Branch(6)), Some(Branch(7)))))

  def preOrder(branch: Branch): Unit = {
    print(branch.node)
    if (branch.left.isDefined) preOrder(branch.left.get)
    if (branch.right.isDefined) preOrder(branch.right.get)
  }

  def inOrder(branch: Branch): Unit = {
    if (branch.left.isDefined) inOrder(branch.left.get)
    print(branch.node)
    if (branch.right.isDefined) inOrder(branch.right.get)
  }

  def postOrder(branch: Branch): Unit = {
    if (branch.left.isDefined) postOrder(branch.left.get)
    if (branch.right.isDefined) postOrder(branch.right.get)
    print(branch.node)
  }

  println("  -> PreOrder" + preOrder(branch))
  println("  -> InOrder " + inOrder(branch))
  println("  -> PostOrder " + postOrder(branch))
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T18:42:35.870

首先，我认为按顺序遍历会导致 3,1,5,9,15 而不是 OP 的 3,5,1,9,15。而且，对不起，我无法让您的代码按原样编译。此外，正如保罗所建议的，您混淆了“t”。

这是我对实现的看法：

```
object Ch15 {
  def main( args:Array[String] ) = {
   val tree =Node( (3), None,Some(Node( (5), Some(Node( (1), None, None )), Some(Node( (9), None,Some(Node( (15), None, None )) )) )) )    
   inOrder( tree ) 
  }

  def inOrder(t: Node): Unit ={  
    def printNode(node:Option[Node]):Unit={
      node match {
        case Some(aliveNode) => {
          printNode(aliveNode.left)
          Console.print(aliveNode.data + ", ")
          printNode(aliveNode.right)
        }
        case None => {}
      }
    }
    printNode(Option(t))  
  }
} 
```

# facebook-javascript-sdk - 如何在 window 或 self 上创建新函数（已通过 lib.d.ts 分配接口 Window）？

> ID：12772979
> 
> 赞同：1
> 
> 时间：2012-10-07T21:24:02.313
> 
> 标签：facebook-javascript-sdk, web-worker, typescript

显然我正在尝试让 facebooks 异步初始化工作。这样做，我需要在对象窗口上创建一个名为“fbAsyncInit”的函数。我在编写网络工作者时遇到了类似的问题，因为我想使用 self.postMessage 但 self 再次作为其界面界面 Window。但是我尝试这样做，typscript 编译器不满意我向窗口添加一个未在 Window 界面中指定的字段。一开始我试着这样做：

```
interface WindowFB extends Window { 
    fbAsyncInit: ()=>any;
}

declare var window: WindowFB; 
```

这没有帮助，所以我尝试了其他一些方法并设法让类型检查器满意，但它似乎只是被窃听了（因为对于解决方案，它不是 100% 满意）。有谁知道这可能是什么正确的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:36:47.040

“窗口”界面打开。你可以写：

```
interface Window {
    fbAsyncInit: () => any;
}

window.fbAsyncInit(); 
```

由于 lib.d.ts 周围的一些错误，这在 TypeScript Playground 中不太适用，但命令行编译器应该能够接受这一点。

# java - Math.max 和 Math.min 输出允许的最高和最低值

> ID：12772980
> 
> 赞同：3
> 
> 时间：2012-10-07T21:24:05.800
> 
> 标签：java

所以我正在尝试制作一个输出总和、平均值以及最小值和最大值的程序。除了最小和最大值输出 2147483647 和 -2147483647 之外，我基本上已经弄清楚了所有内容，我相信它们是 Java 将计算的绝对最小值和最大值。无论如何，我想计算用户输入的数字，所以这显然是不正确的。

这是我的课。我认为 addValue 方法出了点问题。

```
public class DataSet
{
private int sum;
private int count;
private int largest;
private int smallest;
private double average;

public DataSet()
{
    sum = 0;
    count = 0;
    largest = Integer.MAX_VALUE;
    smallest = Integer.MIN_VALUE;
    average = 0;
}

public void addValue(int x)
{
    count++;
    sum = sum + x;
    largest = Math.max(x, largest);
    smallest = Math.min(x, smallest);
}

public int getSum()
{
    return sum;
}

public double getAverage()
{
    average = sum / count;
    return average;
}

public int getCount()
{
    return count;
}

public int getLargest()
{
    return largest;
}

public int getSmallest()
{
    return smallest;
}

 } 
```

这是我的这个项目的测试器类：

```
 public class DataSetTester {
 public static void main(String[] arg) {
     DataSet ds = new DataSet();
     ds.addValue(13);
     ds.addValue(-2);
     ds.addValue(3);
     ds.addValue(0);
       System.out.println("Count: " + ds.getCount());
       System.out.println("Sum: " + ds.getSum());
       System.out.println("Average: " + ds.getAverage());
     System.out.println("Smallest: " + ds.getSmallest());
       System.out.println("Largest: " + ds.getLargest());
 }
 } 
```

除最小和最大数字外，所有内容都正确输出（计数、总和、平均值）。如果有人能指出我做错的正确方向，那就太好了。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-07T21:26:02.443

反转您的`largest`&`smallest`初始值，`Math.max`&`Math.min`将相应地选择正确的值：

```
largest = Integer.MIN_VALUE;
smallest = Integer.MAX_VALUE; 
```

作为`Integer.MIN_VALUE`整数的最小可能值，语句：

```
largest = Math.max(x, largest); 
```

`x`将在第一次调用时产生该值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:25:56.327

认为您在初始化时的意思是：

```
largest = Integer.MIN_VALUE;
smallest = Integer.MAX_VALUE; 
```

# objective-c - SCREEN A -> 按下按钮 > 10s 操作 -> 需要显示 SCREEN B（我使用 Storyboard）

> ID：12772988
> 
> 赞同：0
> 
> 时间：2012-10-07T21:25:03.320
> 
> 标签：objective-c, ios, uistoryboard

我使用 a 创建了一个 UI `storyboard`，并在我的一个屏幕上开始执行一项耗时的操作（此时正在显示等待对话框），完成此操作后，我需要显示另一个屏幕来获取结果。

在这种情况下我应该使用什么：

1.  在中声明一个新屏幕`Storyboard`并使用`SEGUE`
2.  动态创建`nib`-file
3.  其他？

**编辑：**

问题是 - 在执行耗时的操作（我使用情节提要）后，如何从一个屏幕移动到另一个屏幕。似乎如果我使用笔尖 - 我应该只更改 rootViewControoler

**屏幕 A -> 按下按钮 > 10 秒操作 -> 需要显示屏幕 B（我使用情节提要）。我该怎么做？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T21:31:32.857

在这种情况下，您可以做很多事情。

听起来您想以模态方式呈现等待视图。一个常用的第 3 方类是[MBProgressHUD](https://github.com/jdg/MBProgressHUD)，它允许您在执行长时间运行的任务期间以模态方式在视图中呈现平视显示器。

随着`MBProgressHUD`您在视图中显示 HUD 的实例，并在任务完成后将其移除。它不需要笔尖加载等。

只有一种选择。这取决于您要呈现给用户的内容。

编辑：看来 OP 最感兴趣的是如何在 Storyboards 下进行冗长的操作后转换到新的视图控制器。我认为解决方案是`performSegueWithIdentifier:sender:`。因此，在 Storyboard 中设置感兴趣的 segue 并调用`performSegueWithIdentifier:sender:`正在执行长时间运行任务的视图控制器。

# c++ - fstream 奇怪的行为

> ID：12772991
> 
> 赞同：1
> 
> 时间：2012-10-07T21:25:29.893
> 
> 标签：c++, serialization, fstream

我正在尝试序列化我班级的一些私有属性：

```
class Task {
    public:
        enum Status { COMPLETED, PENDIENT };
        // BLAH BLAH BLAH
        // CLASS GETTERS SETTERS ETC...
        const std::fstream serializeObject( std::fstream &stream );
    private:
        void setID();
        static int sCount;
        int id;
        std::string text;
        Status status;
        tm timestamp;
}; 
```

serializeObject 的定义如下：

```
const std::fstream Task::serializeObject( std::fstream &stream ) {
    stream.write((char *) &id, sizeof(int));
    stream.write((char *) &text, sizeof(std::string));
    stream.write((char *) &status, sizeof(Status));
    stream.write((char *) &timestamp, sizeof(tm));
    return stream;
} 
```

GCC 返回很多错误：

```
In file included from /usr/include/c++/4.4/ios:39,
                 from /usr/include/c++/4.4/ostream:40,
                 from /usr/include/c++/4.4/iostream:40,
                 from task.cpp:1:
/usr/include/c++/4.4/bits/ios_base.h: In copy constructor ‘std::basic_ios<char, std::char_traits<char> >::basic_ios(const std::basic_ios<char, std::char_traits<char> >&)’:
/usr/include/c++/4.4/bits/ios_base.h:790: error: ‘std::ios_base::ios_base(const std::ios_base&)’ is private
/usr/include/c++/4.4/iosfwd:47: error: within this context
/usr/include/c++/4.4/iosfwd: In copy constructor ‘std::basic_fstream<char, std::char_traits<char> >::basic_fstream(const std::basic_fstream<char, std::char_traits<char> >&)’:
/usr/include/c++/4.4/iosfwd:87: note: synthesized method ‘std::basic_ios<char, std::char_traits<char> >::basic_ios(const std::basic_ios<char, std::char_traits<char> >&)’ first required here 
/usr/include/c++/4.4/streambuf: In copy constructor ‘std::basic_filebuf<char, std::char_traits<char> >::basic_filebuf(const std::basic_filebuf<char, std::char_traits<char> >&)’:
/usr/include/c++/4.4/streambuf:770: error: ‘std::basic_streambuf<_CharT, _Traits>::basic_streambuf(const std::basic_streambuf<_CharT, _Traits>&) [with _CharT = char, _Traits = std::char_traits<char>]’ is private
/usr/include/c++/4.4/iosfwd:78: error: within this context
/usr/include/c++/4.4/iosfwd: In copy constructor ‘std::basic_fstream<char, std::char_traits<char> >::basic_fstream(const std::basic_fstream<char, std::char_traits<char> >&)’:
/usr/include/c++/4.4/iosfwd:87: note: synthesized method ‘std::basic_filebuf<char, std::char_traits<char> >::basic_filebuf(const std::basic_filebuf<char, std::char_traits<char> >&)’ first required here 
task.cpp: In member function ‘std::fstream Task::serializeObject(std::fstream&)’:
task.cpp:104: note: synthesized method ‘std::basic_fstream<char, std::char_traits<char> >::basic_fstream(const std::basic_fstream<char, std::char_traits<char> >&)’ first required here 
```

我究竟做错了什么？我按照[这个](http://www.java2s.com/Code/Cpp/File/SerializeobjectDemo.htm)例子。复制了商店功能并稍作调整。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T21:28:38.570

的返回值`Task::serializeObject()`是一个`fstream`，而不是一个`fstream&`：这是试图制作一个副本，`stream`并且流是不可复制的。来自[`std::ios_base::ios_base`](http://en.cppreference.com/w/cpp/io/ios_base/ios_base)：

> 复制构造函数被删除：流不可复制

改成：

```
std::fstream& Task::serializeObject( std::fstream &stream ) 
```

注意我已经放弃了，`const`因为我不确定为什么需要这样做。

另外，这个：

```
stream.write((char *) &text, sizeof(std::string)); 
```

不会做你想的。A`std::string`将包含一个指向实际数据的指针，并且使用它不会写入实际数据`stream`。使用[`std::string::c_str()`](http://en.cppreference.com/w/cpp/string/basic_string/c_str), 可能[`std::string::length()`](http://en.cppreference.com/w/cpp/string/basic_string/size)在重新阅读时知道字符串的长度。

# django - DEBUG 为 False 时无静态文件

> ID：12772992
> 
> 赞同：4
> 
> 时间：2012-10-07T21:25:31.690
> 
> 标签：django, django-templates, django-admin

我在将应用程序部署到生产服务器时遇到了一些问题。如果我在 settings.py 中设置

```
DEBUG = True
TEMPLATE_DEBUG = DEBUG 
```

那么一切正常，但如果我将设置更改为：

```
DEBUG = False
TEMPLATE_DEBUG = DEBUG 
```

然后我的应用程序坏了。我没有看到静态文件（js、css、...），并且在管理面板中我无法添加/编辑我的注册模型。你有什么建议我该如何解决这个问题？

我的环境：

*   Python 2.7.3
*   Django 1.4.1
*   Nginx 1.2.3
*   uwsgi 1.3

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-07T21:36:54.487

您应该阅读：[在生产中提供静态文件。](https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-in-production)

至少听起来您依赖于`staticfiles_urlpatterns()`contrib.staticfiles 中的帮助视图，该视图仅用于开发：

> 这仅在 DEBUG 为 True 时有效。
> 
> 那是因为这种观点非常低效并且可能不安全。这仅用于本地开发，绝不能在生产中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-31T10:03:24.093

Mee也有这个问题，我解决了。

试试看嘛

在 settings.py

```
DEBUG = False 
```

然后加

```
DEBUG404 = True 
ALLOWED_HOSTS = ['*'] # it works but not secure, so use

ALLOWED_HOSTS = ['localhost', 'IP adrs'] #if you are running locally, then run with python manage.py runserver --insecure.You can give your webserver here. 
```

然后在 urls.py 中添加

```
import os
if settings.DEBUG404:
    urlpatterns += patterns('',
    (r'^static/(?P<path>.*)$', 'django.views.static.serve',
    {'document_root': os.path.join(os.path.dirname(__file__), 'static')} ),
    ) 
```

# php - 极慢的锂查询，在 MongoDB 中很快

> ID：12772994
> 
> 赞同：3
> 
> 时间：2012-10-07T21:25:44.823
> 
> 标签：php, performance, mongodb, lithium

所以，我现在一直在尝试 php 框架锂，它似乎是一个非常好的框架，但我有一个小问题。我在一个只有 6k+ 文档的集合上运行的查询从 php 运行速度非常慢，但当我从终端运行它时却非常快。

集合中的一个文档可能如下所示：

```
{
    "_id" : ObjectId("504c9a3b6070d8b7ea61938e"),
    "startDate" : "Jan 2011",
    "episodes" : [
        {
            "title" : "Series 1, Episode 1",
            "airdate" : ISODate("2011-01-20T00:00:00Z"),
            "epnum" : "1",
            "prodnum" : null,
            "seasonnum" : "01",
            "link" : "http://www.tvrage.com/10_OClock_Live/episodes/1065007783"
        },
        {and maybe 20 more},
    ],
    "runTime" : "60 min",
    "endDate" : "Apr 2012",
    "network" : "Channel 4",
    "numberOfEpisodes" : "25 eps",
    "title" : "10 O'Clock Live",
    "directory" : "10OClockLive",
    "country" : "UK",
    "tvrage" : "27363"
} 
```

我想获取本月存在的所有剧集。所以在终端（我使用假值和一个多月）我使用以下查询：

```
db.series.find({'episodes.airdate': {$gt: ISODate('2012-09-07 00:00:00'), $lt: ISODate('2012-11-01')}}) 
```

和wham，它只是非常快。即使我对查询执行了 explain() ，它也会告诉我它很快：

```
{
    "cursor" : "BtreeCursor episodes.airdate_1",
    "isMultiKey" : true,
    "n" : 382,
    "nscannedObjects" : 1620,
    "nscanned" : 1620,
    "nscannedObjectsAllPlans" : 1620,
    "nscannedAllPlans" : 1620,
    "scanAndOrder" : false,
    "indexOnly" : false,
    "nYields" : 0,
    "nChunkSkips" : 0,
    **"millis" : 181**,
    "indexBounds" : {
        "episodes.airdate" : [
            [
                ISODate("2012-09-07T00:00:00Z"),
                ISODate("292278995-01--2147483647T07:12:56.808Z")
            ]
        ]
    },
    "server" : "example:27017"
} 
```

但是当我在 php 和锂中使用查询时，伙计，它需要很长时间：

```
$series = Series::find('all', array(
                'fields' => array('title', 'episodes.title', 'episodes.airdate'),
                'conditions' => array('episodes.airdate' => array('$gt' => new MongoDate(strtotime(date('Y-m-01'))), '$lt' =>  new MongoDate(strtotime(date('Y-m-t')))))
            )); 
```

**如果我什至尝试循环遍历它，那么在超过**30 秒的执行时间后情况会更糟。尽管如此，我认为我有内存泄漏，因为我不得不添加它`ini_set('memory_limit', '-1');`而没有获得“最大使用量”或其他任何东西。

谁能给我一个关于为什么会发生这种情况的答案？有什么办法可以提高查询速度？我不知道为什么它这么慢，如果有人能指出我正确的方向，我会非常高兴。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T15:27:04.427

问题是 Lithium 将所有数据打包在对象中，对于大型查询来说，这可能会占用大量内存，因此速度很慢。如果您不需要针对该特定查询的任何 ActiveRecord 功能，则可以传递一个选项，您可以将`find()`其传递给`MongoDb::read()`（因此请检查文档`MongoDb::read()`），该选项允许您取回原始数组或实际的数据库游标可以手动迭代。

另一种选择是等到我实现流式迭代，这将解决内存问题。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T05:41:07.093

我不确定为什么这对你来说很慢。我在[这里](https://gist.github.com/3850852)有一个要点，其中一个类将记录从锂发出的插入、读取和更新 mongo 命令。您可能可以添加某种类型的计时器来获取每个查询的长度。然后你至少可以知道问题是在等待 mongo 还是代码的其他部分。

这是一些用于迭代一段`DocumentSet`时间的代码，丢弃从`MongoCursor`循环中检索到的每个文档。

```
$docs = SomeModel::all();
while ($docs->valid()) {
    $key = $docs->key();
    $doc = $docs->current();
    unset($docs[$key]);
    $docs->rewind();

    if (!$docs->valid()) {
        $docs->next();
    }

    // ... do stuff with $doc here ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T19:34:24.857

我刚刚解决了一个页面加载时间超过 65 秒的问题。原来这个特定用户的用户记录有一个包含 152 条记录的数组，每个数组项都非常大，所以这个帐户可能超过了 mongodb 记录的 65,000 个字符的限制。当我从用户帐户中删除大数组时，页面突然以 4.5 秒加载。

问题是 - 正在加载的页面上的内容与此用户记录无关，因此我们正在处理该内容的查询以尝试加快速度。然后我们发现该错误与所有这些完全无关，并且是由于另一个问题造成的。

因此，请确保您的记录不要太大。

# javascript - 每条路由上的骨干路由器

> ID：12772996
> 
> 赞同：2
> 
> 时间：2012-10-07T21:25:53.920
> 
> 标签：javascript, backbone.js

我的问题是：

所有的 HTML 都在一个`<div id="application">`容器中，默认情况下是`0`不透明的。这是因为 JavaScript 做了一些 DOM 定位，所以当这一切都完成后，我只需在 中添加一个`class="rendered"`，`<div id="application>"`然后页面就会出现。

所以问题是，对于我的主干路由器中的每条路由，我都需要在实际路由之前或每条路由上总是触发的东西，这可能吗？

感谢帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-07T21:44:06.493

`Backbone.Router`当路由触发时发出事件，因此您可以绑定到特定事件或`all`捕获所有有效的路由更改。event 参数将包含路由回调名称：

```
var MyRouter = Backbone.Router.extend({
    routes: {
        "foo": "bar"
    },

    initialize: function() {
        this.on('all', function(routeEvent) {
            // If you had clicked #foo, routeEvent would contain
            // `route:bar`. You can trigger your CSS changes here.
        });
    }
}); 
```

我觉得这种代码在视图中会更好，但这应该可以满足您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:29:22.967

您可以在路由器中定义一种带有参数的方法。然后对于每条路由，调用该方法并传入一个参数，该参数将用于确定要渲染的视图。在方法的开始，您可以定义您想要发生的任何“在每个路由器呼叫”逻辑。

例如：

```
routes:
    "": "renderPage"
    ":page": "renderPage"

renderPage: (page) ->
// check if page is defined, if not render index, if it is, render that page 
```

# web-services - 将 asmx Webservice 升级到 .net 4 Crystal 报告 2011 sp4。仅 CR2008 参考可用

> ID：12772998
> 
> 赞同：1
> 
> 时间：2012-10-07T21:26:00.570
> 
> 标签：web-services, .net-4.0, crystal-reports

我正在准备一个较旧的 Web 服务，以便部署到运行 .net 4 和 CR 运行时版本 13_4 (CR2011SP4) x64 运行时的新服务器。

我已经从这里安装了 VS2010 的 CR 扩展：http: [//downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_redist_install_64bit_13_0_4.zip](http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_redist_install_64bit_13_0_4.zip)

我已在 Project->Properties->Compile->Advanced Compile Options 中将项目 .net 运行时更改为 4.0。

当我将 CrystalDecisions.CrystalReports.Engine 和 CrystalDecisions.Shared 替换为现在应该可用的新版本时，我找不到它们。这些库的唯一版本是 12.0.2000.0。根据此页面，它们应该是 14.0.4xxx.x [http://victoriayudin.com/2009/05/25/crystal-reports-service-packs-and-versions/](http://victoriayudin.com/2009/05/25/crystal-reports-service-packs-and-versions/)

所以我不确定这是 CR SDK 安装问题、项目配置问题还是完全出乎意料的问题。

有没有人有想法或链接可以帮助我深入了解这一点？