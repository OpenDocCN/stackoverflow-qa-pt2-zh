# StackOverflow 问答 13147000-13147999

# ruby-on-rails - 获取实际对象 Rails

> ID：13147000
> 
> 赞同：0
> 
> 时间：2012-10-30T20:19:59.513
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, actionview

在我的新视图中，我有两种形式，一种是针对产品的，另一种是针对照片的。当我上传带有 select.file 字段的照片时，这些是由文件 create.js.erb 的 Ajax 调用创建的，然后当我将其他字段填充到产品中时，我有另一个按钮来创建它。所以我有两种形式和一种方法来创建每一个。

问题是 ID，我找到的解决方案是在用户进入新视图之前创建一个对象，所以我有这个代码：

产品控制器：

```
def new
      @product = current_user.products.create
end 
```

它创建了一个对象 nil，现在我可以为该对象创建我的 Foto，如下所示：

绘画控制器：

```
def create
   @product = Product.last
   @painting = @product.paintings.create(params[:painting])
end 
```

问题是“@product = Product.last”行，我知道这不是正确的解决方案，因为当我尝试编辑操作时，当我尝试创建新对象时，它会转到最后一个产品而不是实际的编辑产品。

如何在我的新操作中找到当前产品？？？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:08:10.467

构建一个新对象（真正显示新表单，因为 #new 是一个 GET 请求，不应进行破坏性更改）

```
 def new
    @product = current_user.products.build
  end 
```

创建一个新对象

```
def create
  @product = current_user.products.build(params[:product])
  if @product.save
    redirect_to @product
  else
    render :new
  end
end 
```

显示对象的编辑表单

```
def edit
  @product = current_user.products.find(params[:id])
end 
```

更新现有产品

```
def update
  @product = current_user.products.find(params[:id])
  if @product.update_attributes(params[:product])
    redirect_to @product
  else
     render :edit
  end
end 
```

您会注意到 GET 请求（新的和编辑的）不会对数据库进行任何更改。

用于（更新/创建）的两个破坏性请求（PUT 和 POST）对数据库进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:30:03.007

通常，您所做的事情很尴尬，并且可能不是使用控制器新操作的最佳方式。

要回答您的问题，您需要在参数中传递产品的 ID。

根据您提交绘画表单的方式，您需要在请求正文或 url 中添加参数。这样你就可以做类似的事情

**绘画控制器**

```
def create
  @product = Product.find(params[:product_id]
  @painting = @product.paintings.create(params[:painting])
end 
```

如果您添加视图/表单的代码片段，我可能会更好地帮助您。

# visual-studio-2010 - 在 VS2010 中将项目属性编辑为文本

> ID：13147003
> 
> 赞同：0
> 
> 时间：2012-10-30T20:20:11.367
> 
> 标签：visual-studio-2010

我想知道是否有办法将项目属性编辑为文本，而不是在单击 Project->Properties 后显示的对话框中。可能吗？

# java - guice servlet 不是单例

> ID：13147010
> 
> 赞同：2
> 
> 时间：2012-10-30T20:20:49.790
> 
> 标签：java, servlets, dependency-injection, guice, guice-servlet

可怕的事情正在发生

我的项目中有 2 个 servlet - 其中一个只是有一个 post 方法并负责处理文件上传。我最近添加了另一个 - 它有一个 get 和一个 post 方法。

这是第二个 servlet 代码

```
@Singleton
@WebServlet("/Medical_Web")
public class XXXDetailsServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Inject
    private Provider<XXXPersistenceManager> persistenceManager;

    @Inject
    private Provider<XXXChain> chainProvider;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
        System.out.println("servlet address = " + this);
        final String xxx= request.getParameter("xxx");
        String json = "";
        try {
            final XXXBean xxxBean = persistenceManager.get().find(xxx);
            json = new GsonBuilder().create().toJson(xxxBean);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        request.setAttribute("json", json.trim());
        getServletContext().getRequestDispatcher("/XXX.jsp").forward(request, response);
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
        System.out.println("servlet address = " + this);
        final String xxx = request.getParameter("xxx");
        try {
            final XXXChain chain = chainProvider.get();
            chain.getContext().setAttribute(XXX_TYPE, XXXType.DELETE);
            final XXXBean xxxBean = persistenceManager.get().find(xxx);
            final List<XXXBean> xxxList = new ArrayList<XXXBean>();
            xxxList.add(xxxBean);
            chain.process(xxxList);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

现在 - 这就是让我

出于某种原因——即使这被标记为@Singleton——servlet 地址肯定会以不同的方式返回。当我在我的 post 方法中点击一个空指针时，我最初注意到了这一点——每当我调用 get 方法时，我返回的 servlet 实例都会填充所有字段。每当我调用 post 方法时，我返回的 servlet 实例（它是一个不同的实例）没有填充字段（只是 null，似乎它们没有被注入）。

我真的很难弄清楚这里发生了什么。似乎这个 servlet 的一个实例是在 guice 上下文之外创建的。如果重要的话——我们使用的是 JBoss 7.1

（对不起所有的XXX，不知道我是否可以发布真实姓名）

* * *

这是我的 guice 设置的其余部分

```
public class XXXServletContextListener extends GuiceServletContextListener {

    @Override
    protected Injector getInjector() {
        return Guice.createInjector(new XXXUploadModule(), new XXXServletModule());
    }
} 
```

这是servlet模块

```
public class XXXServletModule extends ServletModule {

    @Override
    protected void configureServlets() {
        serve("/xxx1").with(XXXDetailsServlet.class); // this one fails on post
        serve("/xxx2").with(XXXUploadServlet.class);  // this one works 
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T00:18:15.593

我不熟悉 Guice servlet 集成的工作原理，但是拥有`@WebServlet("/Medical_Web")`注释意味着您的 Web 容器还将实例化该 servlet 以服务请求。实际上，它们的一个池，它没有单例的概念。

我的猜测是你只需要删除注释并让`ServletModule`控制 servlet 生命周期。

# postgresql - 将 OpenStreetMap 数据导入 PostgreSQL 数据库

> ID：13147018
> 
> 赞同：2
> 
> 时间：2012-10-30T20:21:23.550
> 
> 标签：postgresql, postgis, openstreetmap, postgresql-9.2

我正在尝试使用 like 调用将以下 OpenStreetMap 映射[1](https://dl.dropbox.com/u/11776689/2012_10_30_postgres/artyom.osm.bz2)、[2](https://dl.dropbox.com/u/11776689/2012_10_30_postgres/artyom.xml)、[3](https://dl.dropbox.com/u/11776689/2012_10_30_postgres/map.osm)之一导入 PostgreSQL 数据库`call osmosis.bat --read-xml file="map.osm" --write-pgsimp user="ccp-web-user" database="ccp-web2" password="ccp-web-password"`，但我总是遵循错误消息。

```
SCHWERWIEGEND: Thread for task 1-read-xml failed
org.openstreetmap.osmosis.core.OsmosisRuntimeException: Unable to read the schema version from the schema info table.
        at org.openstreetmap.osmosis.pgsimple.common.SchemaVersionValidator.validateDBVersion(SchemaVersionValidator.java:90)
        at org.openstreetmap.osmosis.pgsimple.common.SchemaVersionValidator.validateVersion(SchemaVersionValidator.java:50)
        at org.openstreetmap.osmosis.pgsimple.v0_6.PostgreSqlWriter.initialize(PostgreSqlWriter.java:183)
        at org.openstreetmap.osmosis.pgsimple.v0_6.PostgreSqlWriter.process(PostgreSqlWriter.java:773)
        at org.openstreetmap.osmosis.xml.v0_6.impl.BoundsElementProcessor.end(BoundsElementProcessor.java:84)
        at org.openstreetmap.osmosis.xml.v0_6.impl.OsmHandler.endElement(OsmHandler.java:107)
        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
        at org.apache.xerces.parsers.AbstractXMLDocumentParser.emptyElement(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanStartElement(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.SAXParserImpl.parse(Unknown Source)
        at javax.xml.parsers.SAXParser.parse(Unknown Source)
        at org.openstreetmap.osmosis.xml.v0_6.XmlReader.run(XmlReader.java:111)
        at java.lang.Thread.run(Unknown Source)
Caused by: org.postgresql.util.PSQLException: FEHLER: Relation ╗schema_info½ existiert nicht Position: 21
        at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
        at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
        at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:374)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:254)
        at org.openstreetmap.osmosis.pgsimple.common.SchemaVersionValidator.validateDBVersion(SchemaVersionValidator.java:71)
        ... 19 more
30.10.2012 23:06:56 org.openstreetmap.osmosis.core.Osmosis main
SCHWERWIEGEND: Execution aborted.
org.openstreetmap.osmosis.core.OsmosisRuntimeException: One or more tasks failed
.
        at org.openstreetmap.osmosis.core.pipeline.common.Pipeline.waitForCompletion(Pipeline.java:146)
        at org.openstreetmap.osmosis.core.Osmosis.run(Osmosis.java:92)
        at org.openstreetmap.osmosis.core.Osmosis.main(Osmosis.java:37)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchStandard(Launcher.java:329)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:239)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
        at org.codehaus.classworlds.Launcher.main(Launcher.java:47) 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T01:38:17.640

[您需要按照此处](http://wiki.openstreetmap.org/wiki/Osmosis/Detailed_Usage#PostGIS_Tasks_.28Simple_Schema.29)所述初始化 PostGIS 简单模式。

> 模式创建脚本可以在 osmosis 发行版的脚本目录中找到。
> 
> 这些脚本是：
> 
> *   pgsimple_schema_0.6.sql - 构建最小模式。
> *   pgsimple_schema_0.6_action.sql - 添加可选的“action”表，允许派生表在应用差异时保持最新。
> *   pgsimple_schema_0.6_bbox.sql - 将可选的 bbox 列添加到路表中。
> *   pgsimple_schema_0.6_linestring.sql - 将可选的线串列添加到路表中。
> *   pgsimple_load_0.6.sql - 适用于加载由 --write-pgsimp-dump 任务创建的 COPY 文件的示例数据加载脚本。

如果您使用的是 PgAdmin3，请打开这些文件并执行它们。或者使用`psql`命令。当然 PostGIS 应该安装在您的数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-06T04:52:42.290

```
osmosis.bat --read-xml file="map.osm" --write-pgsimp validateSchemaVersion=no user="ccp-web-user" database="ccp-web2" password="ccp-web-password" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-15T11:21:38.863

我刚遇到这个问题，并在 Ubuntu 上为自己找到了解决方案。

[如果您认为您已经通过 psql 命令执行了https://wiki.openstreetmap.org/wiki/Osmosis/PostGIS_Setup](https://wiki.openstreetmap.org/wiki/Osmosis/PostGIS_Setup)上的步骤，但仍然遇到错误，那么执行 psql 时可能存在用户权限问题Linux 终端上的命令，例如在创建 postgis 和 hstore 扩展时，以及在执行 pgsnapshot 模式时。

我做了什么： - 在终端上创建数据库后 - 我使用 PgAdmin，转到数据库（例如 pgsnapshot）并执行创建扩展 postgis 和 hstore 的步骤。然后在该 PgAdmin 查询工具中执行模式创建脚本之一（例如 pgsnapshot_schema_0.6.sql）。- 之后，返回终端执行命令（eg: osmosis --read-pbf ....）

这些步骤解决了我的问题。

# unit-testing - 用于 java 单元测试的对象缓存

> ID：13147020
> 
> 赞同：0
> 
> 时间：2012-10-30T20:21:33.023
> 
> 标签：unit-testing, junit

我不确定我正在考虑的测试场景的正确技术术语是什么；但这是我希望在 mu 单元测试期间能够执行的功能：

1.  我想要一个框架来存储（序列化到磁盘）我可以传递给我的单元测试方法的对象，而不是去数据库。

2.  我应该能够从数据库源创建这些对象并将它们保存以供以后在我的 UNIT 测试用例中使用。

3.  对象存储应该是可移植的（比如我可以在系统之间移动的基于 hsqldb 文件的数据库）。

是否有针对此类要求的框架/库的技术术语？对象数据库/对象存储等？请注意，我不是在尝试安装/配置整个数据库，而是希望能够重新创建已经创建的复杂对象结构并将其传递给 junit 测试方法。

# jquery - 父类中的jquery索引

> ID：13147021
> 
> 赞同：5
> 
> 时间：2012-10-30T20:21:39.743
> 
> 标签：jquery, css, count, indexing, element

我需要一种方法来查找一个子元素的索引号。

这是它的CSS

```
<div class="parent">
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
</div>

<div class="parent">
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
    <div class="son"></div>
</div> 
```

我的jquery代码是这样的

```
var number = $(".son").index(this); 
```

当我使用这段代码时，它会将儿子视为一个整体。例如，当我单击第二个父类中的第二个子元素时，它会给我一个 var 编号 7。我希望子类总是从零开始计数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T20:26:36.157

试试这个：

```
$(this).parent().find('.son').index(this) 
```

正如其他成员提到的：

```
$(this).index() 
```

完成这项工作，因为没有参数的 index() 返回元素相对于其兄弟元素的位置。

文档：

> 如果没有参数传递给 .index() 方法，则返回值是一个整数，指示 jQuery 对象中的第一个元素相对于其兄弟元素的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:27:03.880

这应该这样做：

`$(this).index()`

在这里试试：

[http://jsfiddle.net/uKa7d/](http://jsfiddle.net/uKa7d/)

# c# - 如何订购字典 通过值内的子字符串？

> ID：13147022
> 
> 赞同：4
> 
> 时间：2012-10-30T20:21:39.040
> 
> 标签：c#, string, dictionary, substring, csv

我有一个`Dictionary <string, string>`where 值是用 a 分隔的子字符串的串联`:`。例如，`123:456:Bob:Smith`。

我想按最后一个子字符串（史密斯）升序对字典进行排序，最好是这样：

```
orderedDictionary = unordered
                        .OrderBy(x => x.Value)
                        .ToDictionary(x => x.Key, x => x.Value); 
```

因此，我需要以某种方式将其`x.Value`视为 a`string`并通过提取第四个子字符串进行排序。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T20:28:15.130

```
var ordered = unordered.OrderBy(x => x.Value.Split(':').Last())
                       .ToDictionary(x => x.Key, x => x.Value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:26:01.240

尝试

```
orderedDictionary = unordered.OrderBy(x => x.Value.Substring(x.Value.LastIndexOf(":"))).ToDictionary(x => x.Key, x => x.Value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T20:27:05.937

看一下`OrderBy`Method of `IDictionary`，特别是这个[http://msdn.microsoft.com/en-us/library/bb549422.aspx](http://msdn.microsoft.com/en-us/library/bb549422.aspx)注意`comparer`参数。那应该为您指明正确的方向，我认为您会发现学习其余的好处。

# javascript - 在 Safari 6 中禁用 JIT 以解决严重的 Javascript JIT 错误

> ID：13147026
> 
> 赞同：21
> 
> 时间：2012-10-30T20:21:54.097
> 
> 标签：javascript, safari, jit, safari6

我们发现仅在 iOS 5/Safari 6（当时的 iPad 版本）上出现的 Javascript 代码解释存在严重问题，我们认为这是由于 Safari 中的 Just in Time JS 编译器中的严重错误造成的。（有关更多受影响的版本和现在似乎包含修复的版本，请参阅下面的**更新）。**

我们最初在我们库的在线[演示](http://www.yworks.com/en/products_yfileshtml_about.html)中发现了这个问题：演示或多或少随机崩溃，但这只会在第二次（甚至更晚）执行相同的代码时发生。即，如果您运行该部分代码一次，一切正常，但随后的运行会使应用程序崩溃。

有趣的是，在 iOS 版 Chrome 中执行相同的代码时，问题并没有显示出来，我们认为这是由于 iOS 版 Chrome 中使用的 Webview 缺少 JIT 功能。

经过大量的摆弄，我们终于认为我们至少找到了一段有问题的代码：

```
 var a = 0; // counter for index
  for (var b = this.getStart(); b !== null; b = b.getNext()) // iterate over all cells
    b.$f = a++; // assign index to cell and then increment 
```

本质上，这是一个简单的 for 循环，它为链表数据结构中的每个单元分配其索引。这里的问题是循环体中的后增量操作。当前计数分配给字段并在计算表达式后更新，与首先分配 a 然后将其递增 1 基本相同。

这在我们测试的所有浏览器和前几次 Safari 中都可以正常工作，然后突然之间似乎计数器变量 a 先递增然后分配结果，就像预递增操作一样。

我创建了一个在这里显示问题的小提琴：http: [//jsfiddle.net/yGuy/L6t5G/](http://jsfiddle.net/yGuy/L6t5G/)

在带有 iOS 6 的 iPad 2 上运行示例并且所有更新结果都可以，在我的情况下，前 2 次运行结果正常，在第三次相同的运行中，列表中的最后一个元素突然分配了一个值，该值被 1 关闭（输出当您单击“单击我”按钮时，从“从 0 到 500”变为“从 0 到 501”）

有趣的是，如果您切换选项卡或稍等片刻，可能会突然出现两次或更多运行的结果是正确的！似乎 Safari 有时会重置 JIT 缓存。

因此，由于我认为 Safari 团队可能需要很长时间才能修复此错误（我尚未报告），并且可能还有其他类似的错误潜伏在 JIT 中，同样难以找到，我想知道是否有办法在 Safari 中禁用 JIT 功能。当然，这会减慢我们的代码（这已经是 CPU 密集型的），但比崩溃要慢。

**更新**：毫不奇怪，受影响的不仅是后递增运算符，还有后减运算符。不那么令人惊讶和更令人担忧的是，如果值被赋值并没有什么区别，因此在现有代码中寻找赋值是不够的。例如，下面的代码`b.$f = (a++ % 2 == 0) ? 1 : 2;`未分配变量值但仅用于三元运算符条件也“失败”，因为有时选择了错误的分支。目前看来，只有在完全不使用 post 运算符的情况下才能避免该问题。

**更新**：同样的问题不仅存在于 iOS 设备中，而且**在 Mac OSX**的 Safari 6 和最新的 Safari 5 上也存在：这些已经测试并发现受到该错误的影响：Mac OS 10.7.4、Safari 5.1.7 Mac OS X 10.8.2、WebKit Nightly r132968：Safari 6.0.1（8536.26.14、537+）。有趣的是，这些似乎没有受到影响：iPad 2 (Mobile) Safari 5.1.7 和 iPad 1 Mobile Safari 5.1 *。*我已向 Apple 报告了这些问题，但尚未收到任何回复。

**更新**：该错误已报告为 Webkit 错误[109036](https://bugs.webkit.org/show_bug.cgi?id=109036)。Apple 仍然没有回复我的错误报告，iOS 和 MacOS 上的所有当前（2013 年 2 月）Safari 版本仍然受到该问题的影响。

**2013 年 2 月 27 日更新**： Webkit 团队似乎已经**修复**[了](http://trac.webkit.org/changeset/144137)这个错误！确实是 JIT 和 post-operators 的问题！评论表明可能有更多代码受到该错误的影响，因此可能是修复了更多神秘的 Heisenbugs，现在！

**2013 年 10 月更新**：该修复程序最终将其变为生产代码：至少在 iPad2 上的 iOS 7.0.2 似乎不再受此错误的影响。不过，我没有检查所有中间版本，因为我们很久以前就解决了这个问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T17:38:40.670

Try-catch 块似乎禁​​用了 Lion 上 Safari 6 上直接在`try`块内的部分的 JIT 编译器（[此代码在 Safari 6.0.1 7536.26.14 和 OS X Lion 上对我有用](http://jsfiddle.net/L6t5G/22/)）。

```
// test function
utility.test = function(){
    try {
        var a = 0; // counter for index
        for (var b = this.getStart(); b !== null; b = b.getNext()) // iterate over all cells
            b.$f = a++; // assign index to cell and then increment
    }
    catch (e) { throw e }
    this.$f5 = !1; // random code
}; 
```

这至少是当前版本的 Google V8 的记录行为（请参阅 V8 上的[Google I/O 演示文稿](http://v8-io12.appspot.com/#71)），但我不知道 Safari。

如果您想为整个脚本禁用它，一种解决方案是编译您的 JS 以使用[burrito](https://github.com/substack/node-burrito)之类的工具将每个函数的内容包装在 try-catch 中。

使这个可重现的工作做得很好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-11T20:14:11.183

IMO，正确的解决方案是将错误报告给 Apple，然后在您的代码中解决它（当然使用单独的`a = a + 1;`语句会起作用，除非 JIT 比您想象的更糟！）。不过确实很烂。下面列出了一些常见的东西，你也可以尝试将其放入函数中以使其去优化而不使用 JIT：

*   例外
*   'with' 语句
*   使用 arguments 对象，例如 arguments.callee
*   评估（）

问题在于，如果 Javascript 引擎在修复该错误之前已针对 JIT 进行了优化，那么在这种情况下，您又会再次崩溃。所以，报告和解决方法！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-23T16:19:40.977

实际上，在 iPhone 4 和 iPad 2 的 iOS 7.0.4 上的 Safari 中，FOR 循环错误仍然存​​在。循环失败可能比上图简单得多，并且它会通过多次遍历代码才能命中。更改为 WHILE 循环允许正确执行。

失败代码：

```
function zf(num,digs) 
{ 
var out = ""; 
var n = Math.abs(num); 
for (digs;  digs>0||n>0; digs--)
{ 
    out = n%10 + out; 
    n = Math.floor(n/10); 
}  
return num<0?"-"+out:out; 
} 
```

成功代码：

```
function zf(num,digs) 
{ 
var out = ""; 
var n = Math.abs(num); 
do 
{ 
    out = n%10 + out; 
    n = Math.floor(n/10); 
} 
while (--digs>0||n>0) 
return num<0?"-"+out:out; 
} 
```

# java - 动态创建树形图并在其周围走动

> ID：13147030
> 
> 赞同：2
> 
> 时间：2012-10-30T20:22:12.070
> 
> 标签：java, graph-theory

我有一个将使用外部源提供的图表。到目前为止，大致的结构是这样的：

![TreeGraph，以这种方式显示以适合](../Images/5ec5939968cc6cb7e8742367609772a0.png) . 在那里，红线代表节点的兄弟姐妹，这可能是依赖关系，但不是父母身份本身。它可能存在也可能不存在。

目前，我对每个节点都有这个代码：

```
 public class TreeNode {    
        private int id;
        private int container; 
        private int status;
        private int value;  
        private boolean visited;
        private String node_name;       
        private ArrayList children = new ArrayList();
        private ArrayList siblings = new ArrayList();
        private ArrayList parents = new ArrayList();

        public TreeNode()
        {
            this.id = 0;
            this.status = 0;
            this.visited = false;
            this.node_name="";
        }
        //Getters and setters below.    
        //parents/siblings/children are added through addParent(treeNode);
    } 

```

然后，我有这段代码来设置值：

```
 public class TreeSetter {

        public static void main(String[] args) {

            TreeNode A = new TreeNode();        
            TreeNode B = new TreeNode();
            TreeNode C = new TreeNode();
            TreeNode D = new TreeNode();        
            TreeNode E = new TreeNode();
            TreeNode F = new TreeNode();
            TreeNode G = new TreeNode();
            TreeNode H = new TreeNode();

            A.setId(1);
            A.setNode_name("A");
            A.setStatus(1);
            A.addParent(null);

            B.setId(2);
            B.setNode_name("B");
            B.setStatus(1);
            B.addParent(A);
            A.addChildren(B);

            C.setId(3);
            C.setNode_name("C");
            C.setStatus(1);
            C.addParent(A);
            A.addChildren(C);

            D.setId(4);
            D.setNode_name("D");
            D.setStatus(1);
            D.addParent(A);
            A.addChildren(D);

            E.setId(5);
            E.setNode_name("E");
            E.setStatus(1);
            E.addParent(B);
            E.addParent(C);
            E.addParent(D);
            B.addChildren(E);
            C.addChildren(E);
            D.addChildren(E);
            E.addSiblings(F);
            E.addSiblings(G);
            E.addSiblings(H);       

            F.setId(6);
            F.setNode_name("F");
            F.setStatus(1);
            F.addParent(B);
            F.addParent(C);
            F.addParent(D);
            B.addChildren(F);
            C.addChildren(F);
            D.addChildren(F);
            F.addSiblings(E);
            F.addSiblings(G);
            F.addSiblings(H);

            G.setId(7);
            G.setNode_name("G");
            G.setStatus(1);
            G.addParent(B);
            G.addParent(C);
            G.addParent(D);
            B.addChildren(G);
            C.addChildren(G);
            D.addChildren(G);
            G.addSiblings(E);
            G.addSiblings(F);
            G.addSiblings(H);

            H.setId(8);
            H.setNode_name("H");
            H.setStatus(1);
            H.addParent(B);
            H.addParent(C);
            H.addParent(D);
            B.addChildren(H);
            C.addChildren(H);
            D.addChildren(H);
            H.addSiblings(E);
            H.addSiblings(F);
            H.addSiblings(G);
            //Set all other nodes

            //Set all node values.  
        }    
    } 

```

所以，我需要的是，假设给定 H，我需要知道：

*   H -> I -> L (H+I+L) 的值是多少
*   如果 H 发生变化，谁会受到影响。H -> B,C,D -> A
*   H的依赖关系是什么？F、G、E。

鉴于此，我的麻烦是：

*   如何动态创建树？例如，假设您有 1000 个节点，而不是 12 个节点。使用我的代码，我需要很多行来设置值和关系，因为我是手动创建每个对象。我应该使用反射、工厂范式来创建 1000 个对象吗？

*   我怎么走树？例如，给定 D，移动 D->H->I->L（依此类推）。我知道递归将是最简单和最干净的方法，但我不知道如何实现它:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:02:10.040

**如何动态创建树：**

```
public class Tree {

    private class Node {
        public int value;
        public List<Node> = new children ArrayList<Node>();
        public List<Node> = new parents ArrayList<Node>();
        public static final INFINITY = Integer.MAX_VALUE;

        public void addChild(Node n) {
            children.add(n);
        }

        public void addParent(Node n) {
            parents.add(n);
        }

        public int getValue() {return value;}

        //What is the value from H -> I -> L (H+I+L):
        int getValueToNode(Node Destination, HashSet<Node> s) {
           int minValue = INFINITY;
           int value = 0;

           if(s.contains(this)) return INFINITY; //we already checked this
           s.add(this);
           if(this.equals(Destination)) return Destination.value();

           for(int i = 0; i < children.size(); i++) {
               Node c = children.get(i);
               int value = c.getValueToNode(Destination);
               if (value != Integer.MAX_VALUE && value < minValue) {
                   minValue = value + this.getValue();
               }
           }

           for(int i = 0; i < parents.size(); i++) {
               Node p = parents.get(i);
               value = p.getValueToNode(Destination);
               if (value != Integer.MAX_VALUE && value < minValue) {
                   minValue = value + this.getValue();
               }
           }
           return minValue;
        }

        //Who will be affected if H changes. H -> B,C,D -> A
        public int getDependency(ArrayList<Node> affected) {
          for(int i = 0; i < children.size(); i++) {
               Node c = children.get(i);
               affected.add(c);
           }

           for(int i = 0; i < parents.size(); i++) {
               Node p = parents.get(i);
               affected.add(p);
           }
        }

        //What are the dependencies of H? F, G, E.
        List<Node> getDependency() {
           List<Node> dependency = new ArrayList<Node>();
           for(int i = 0; i < parents.size(); i++) {
               Node p = parents.get(i);
               for(int j= 0 ; j < p.children.size(); j++) {
                   Node c = p.children.get(i);
                   if(!c.equals(this)) dependency.add(c);
               }
           }
           return dependency;
        }
    }

    //data here.
    private Map<String, Node> mapping = new HashMap<String, Node>();

    public connectParentToChild(String parent, String child) {
        Node p = getNode(parent);
        Node c = getNode(child);
        p.addChild(c);
        c.addParent(p);
    }

    public int getValue(String first, String second) {
        a = getNode(first);
        b = getNode(second);
        HashSet<Node> s = new HashSet<Node>();
        return a.getValueToNode(b, s);
    }

    private Node getNode(String s) {
        if(!mapping.containsKey(s)) {
           mapping.put(s, new Node(...));
        }
        return mapping.get(s);
    }

    //members here.
} 
```

这是一种动态添加节点的简单方法。

```
public static void main(String[] args) {
    Tree t;
    t.connectParentToChild("A", "D");
    t.connectParentToChild("A", "B");
    t.connectParentToChild("A", "C");
    t.connectParentToChild("B", "C");
    t.connectParentToChild("B", "H");
    t.connectParentToChild("B", "F");
    t.connectParentToChild("B", "E");
    //Set all other nodes
    t.getValue("H", "L");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T13:04:00.360

```
public void printWholeNode(Node root) {
    if (root.getChildren().size() == 0) {
        if (root.visited == false) {
            System.out.println(root.name);
            root.visited = true;
        }
        return ;
    } else {
        System.out.println(root.name);
        root.visited = true;
        for (Node childNode : root.getChildren()) {
            printWholeNode(childNode);
        }
    }
} 
```

# vb.net - 将两个相似的表单作为相同类型传递并且仍然能够访问其对象

> ID：13147031
> 
> 赞同：0
> 
> 时间：2012-10-30T20:22:12.147
> 
> 标签：vb.net, winforms, visual-studio, parameters

我正在尝试将另一种形式实施到已经完成的例程中。基本上所有的代码都在那里，我需要做的就是以不同的方式操作数据。

例如，我有一个看起来像这样的例程。这是一个释义示例：

```
Private Sub getReportValues(ByRef fr As frmCustomReport, ByRef ReportInfo As ReportValues)
            ReportInfo.eHeaderColor = Microsoft.Win32.Registry.CurrentUser.CreateSubKey("Software\FE Jupiter\MSSMonitor").GetValue("Report Equipment Header Color", "DCDCDC") 'Gainsboro
            ReportInfo.mHeaderColor = Microsoft.Win32.Registry.CurrentUser.CreateSubKey("Software\FE Jupiter\MSSMonitor").GetValue("Report Monitor Header Color", "FFF8DC")   'Cornsilk

fr.btnEquipColor.PickedColor = System.Drawing.ColorTranslator.FromHtml("#" & Microsoft.VisualBasic.Conversion.Hex("&HFF" & ReportInfo.eHeaderColor)) 
```

问题在于（fr as frmCustomReport）我想把它变成一个 system.windows.forms.form 但是我会失去使用它的对象的能力。我还应该提到 fr 是一个模态对话框，我不希望为此使用一个非常老套的 controlcollection。有人对此有好的方向吗？

另请注意！！！我想在两种表单上访问的控件几乎相同。唯一的区别是布局和一些附加功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:54:02.233

没有更多的信息，很难给出一个具体的例子。这将取决于您需要进行的交互量。创建一个接受基类作为参数的子例程，查看 Name 值并基于条件逻辑使用 CType 将 Form 转换为正确的类型。

```
Private Sub clickOtherFormsButton(Value As Form)

    If Value.Name = "Form3" Then
        Dim formObject As Form3 = CType(Value, Form3)
        formObject.Button1.PerformClick()
    ElseIf Value.Name = "Form2" Then
        Dim formObject As Form2 = CType(Value, Form2)
        formObject.Button1.PerformClick()
    End If

End Sub 
```

# android - Android异常损坏的垫块

> ID：13147033
> 
> 赞同：0
> 
> 时间：2012-10-30T20:22:23.663
> 
> 标签：android, exception, encryption, aes

嗨，我的 android 应用程序有问题。我编写了使用 tcp 和 udp 的客户端。数据由 AES 加密。但是当我尝试接收数据报时，我的应用程序返回异常。这是我的代码：

```
protected Void doInBackground(Void... params) 
     {
         try
            {

             udp = new DatagramSocket(2500);

                 boolean flagaBYE = true;

                 String w = "";
                while(flagaBYE)
                {
                            byte[] receiveData= new byte[1024];

                                DatagramPacket pakiet = new DatagramPacket(receiveData, receiveData.length);
                                udp.receive(pakiet);

                    String wiadomosc = new String(pakiet.getData(),"utf-8");
                                publishProgress(wiadomosc);
                               String szyfr = main.preferences.getString("SZYFR_TCP", "");
                               if(!szyfr.equals("1"))
                               {
                                   Encryptor enc = new Encryptor(getKeyBytes(key), getCode());
                                   wiadomosc = enc.decrypt(wiadomosc);

                               } 
```

我的例外是垫块损坏我生成这样的密钥：

```
 String key = "tojestkluczwlasnie"; 
```

然后将字符串解析为 byte[]

```
public static byte[] getKeyBytes(String key) throws UnsupportedEncodingException{
        byte[] keyBytes= new byte[16];
        byte[] parameterKeyBytes= key.getBytes("UTF-8");
        System.arraycopy(parameterKeyBytes, 0, keyBytes, 0, Math.min(parameterKeyBytes.length, keyBytes.length));
      return keyBytes;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T08:15:16.580

您不应将字节视为 UTF-8 字符串，并且不应将密码视为键。在数据格式（编码/解码）之间的转换过程中，您可能会丢失信息。

# firefox - css3 带一个圆角的三角形

> ID：13147034
> 
> 赞同：5
> 
> 时间：2012-10-30T20:22:25.823
> 
> 标签：firefox, google-chrome, css, safari

![在此处输入图像描述](../Images/e1c2ae58ef314fe6c90d15f0154a55b0.png)

我正在尝试实现这个对话框而不恢复使用右上角的图像。以下是我的实现。

```
.box{
    -webkit-border-radius: 6px 6px;
    -moz-border-radius: 6px / 6px;
    -khtml-border-radius: 6px / 6px;
    border-radius: 6px / 6px;
    width:33%;
    border: 1px solid #DDD;
    display: inline-block;
    margin-right:10px;
    margin-bottom: 10px;
    max-width: 290px;
    padding: 10px;
}

.triangle-topright { 
    width: 0; 
    height: 0; 
    border-top: 50px solid #fafad6; 
    border-left: 50px solid transparent;
    -webkit-border-top-right-radius: 6px 6px;
    -moz-border-radius-topright: 6px / 6px;
    -khtml-border-top-right-radius: 6px / 6px;
    border-top-right-radius: 6px / 6px;
    float: right;
    margin-top: -10px;
    margin-right: -10px;
}

<div class="box">
   <div class="triangle-topright"></div>
   <h3>title</h3>
   <p>stuff</p>  
</div> 
```

问题是这适用于 safari，但对于 chrome，-webkit-border-top-right-radius: 6px 6px; 似乎会引起冲突。当它被激活时，右上角会变圆，但三角形会消失。

![在此处输入图像描述](../Images/79e1825f86997de657bcef039c2ebbe4.png)

![在此处输入图像描述](../Images/d4c787cddc86e7af4ac4b22aa1b95e44.png)

有解决方法吗？还是有更好的方法来做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T21:07:42.133

一种似乎有效的解决方案（在 Chrome、Safari、Firefox 中测试）是从`.triangle-topright`

```
-webkit-border-top-right-radius: 6px 6px;
-moz-border-radius-topright: 6px / 6px;
-khtml-border-top-right-radius: 6px / 6px;
border-top-right-radius: 6px / 6px; 
```

而是简单地添加`overflow: hidden;`到`.box`css。

演示：http: [//jsfiddle.net/BcrKH/](http://jsfiddle.net/BcrKH/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T22:27:37.050

我认为您在 CSS 中创建三角形的想法是过度思考问题。CSS 渐变似乎是这里更简单的解决方案。

可以创建只是颜色突然变化的渐变，您也可以将它们制作成对角线，因此它似乎可以提供您所追求的解决方案。

现在我们已经为这个问题建立了不同的思路，我们可以参考类似这样的其他问题作为参考：[如何制作一个对角 css 渐变而不使颜色混合在一起（颜色急剧变化），向右偏移 70%？](https://stackoverflow.com/questions/7048562/how-to-make-a-diagonal-css-gradient-without-the-colors-blending-togethera-sharp)

CSS 渐变的唯一问题是旧版本的 IE 不支持它们。不过这可以解决。IE6/7/8 确实有自己`filter`的创建渐变的方法可以解决问题，但我更喜欢使用[CSS3Pie](http://css3pie.com/)，它允许您即使在旧的 IE 版本中也可以使用标准的 CSS3 渐变。

希望有帮助。

# shell - 检查参数是否是 shell 脚本中的数字

> ID：13147038
> 
> 赞同：4
> 
> 时间：2012-10-30T20:22:54.050
> 
> 标签：shell

> **可能重复：**
> [如何测试变量是否为 bash 中的数字？](https://stackoverflow.com/questions/806906/how-do-i-test-if-a-variable-is-a-number-in-bash)

我尝试通过 shell 脚本编写斐波那契序列，例如，如果用户`5`在命令行中的脚本名称之后输入，则脚本需要从开头打印出 5 个斐波那契数，它们是：

```
0 1 1 2 3 
```

我已经完成了脚本，但是我需要检查用户输入是否是正数，这表明我在这部分有问题。在命令行中，用户应该调用脚本，然后输入一个正数

```
./script number 
```

这是我的代码：

```
#!/bin/sh
[ $# -ne 1 ] && { echo "enter a number please" ; exit 1 ; } 
[ ! echo $1 | egrep -q '^[0-9]+$' &&  $1 -lt 0  ] && { echo "negative" ; exit 1 ; }

f0=0
f1=1
counter=2
if [ $1 -eq 0 ] ; then
echo -n "0"
elif [ $1 -ge 1 ] ; then
    echo -n "0 1" 
fi
    while [ $counter -le $1 ] && [ $1 -gt 1 ] ; do
        echo -n "$fn "      
        fn=`expr $f0 + $f1`
        f0=$f1
        f1=$fn
        counter=`expr $counter + 1`
    done 
echo "" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:01:06.730

```
if [ $1 -ge 0 2>/dev/null ] ; then 
```

它适用于等于或大于 0 的正数

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-30T20:42:21.703

看看这个：

[http://www.bashguru.com/2010/12/how-to-validate-integer-input-using.html](http://www.bashguru.com/2010/12/how-to-validate-integer-input-using.html)

显然有人编写了多个 shell 脚本来做到这一点。

# java - 如何在程序的正确位置包含“和”

> ID：13147040
> 
> 赞同：5
> 
> 时间：2012-10-30T20:23:14.093
> 
> 标签：java, conditional-statements, currency

像往常一样，我只是另一个绝望的高中生，经过大量的谷歌搜索后才提出这个问题。

我正在研究其中一个可以在现实生活中应用的程序（但从来没有）。在这种情况下，找零计数器总结了硬币、五分钱、四分之一和剩余美分的数量，并在一个句子中显示它们。

**我的问题是，我需要制作一个正确的句子格式，最后使用逗号和“and”，以我目前非常有限的知识无法管理。**

*   任何你看到货币划分的地方都是一个代表它的变量（美分、角钱等）
*   backupInput 是保存用户选择的美分数量的变量（1-100 之间的任何值）

我的程序中与我想问的部分有关的是：

```
 System.out.print(backupInput + ": ");

    // Outputting the quarters
    if (quarters > 0)
    {
      if (quarters == 1)
        System.out.print("one quarter, ");
      else
        System.out.print(quarters + " quarters, ");
    }

    // Outputting the dimes
    if (dimes > 0)
    {
      if (dimes == 1)
        System.out.print("one dime, ");
      else
        System.out.print(dimes + " dimes, ");
    }  

    // Outputting the nickels
    if (nickels > 0)
    {
      if (nickels == 1)
        System.out.print("one nickel, ");
      else
        System.out.print(nickels + " nickels ");
    }

    // Outputting the cents
    if (cents > 0)
    {
      if (cents == 1)
        System.out.print(" one cent");
      else
        System.out.print(cents + " cents ");
    } 
```

问题是，任何这个输出都会给出类似的结果

```
7: 1 dime, 2 cents 
```

虽然它应该是，但根据给出的示例格式：

```
7: 1 dime and 2 cents
65: 2 quarters, 1 dime and one nickel
66: 2 quarters, 1 dime, 1 nickel, and one cent 
```

请记住，我几乎尝试了所有我能想到的东西，但在我所有的尝试中，它的效率太低了，甚至在所有情况下都不起作用。我不是想从这里的工作中拯救自己。我只是想了解正确操作背后的概念。

就是这样。该程序的其余部分运行良好且花花公子。如果你们中的任何人可以帮助我，请让像我这样的新手容易理解答案，以便更容易掌握这个概念:) 谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:30:35.423

有时更容易将问题分解一下。我可能会创建一个字符串数组：[“2 Quarters”，“1 dime”，“1 Nickel”，“one cent”]

然后查看我有多少（有效）数组元素并遍历 N 元素中的 N-1 个，输出以逗号分隔的行。然后（假设有多个数组元素）输出“and”，后跟最后一个数组元素。

还有其他“更高效”的方式，但我已经在这个行业工作了 40 年，任何一天我都会认为“易于理解和工作”而不是“高效”。

（当然，这不是给这只猫剥皮的唯一方法，可能还有其他同样简单的方法，但那是你和其他人发明的。）

（请注意，避免必须在每个`if`语句之间决定是否插入“and”的代码至关重要。当您一遍又一遍地重复相同的逻辑时，您往往会增加错误并造成维护噩梦。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:27:19.807

您当前的方法是计算硬币类型的计数，然后立即打印结果。

相反，如果您首先计算所有硬币的计数而不进行任何打印，那么您可以看到哪个是具有非零计数的最小硬币（因此是最后一个在输出中命名的硬币）。使用它，我认为您可以弄清楚如何将计数粘合在一起并打印所需的文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T20:26:53.720

由于您正在学习Java，因此我不会给您完整的解决方案，但这里有一些方向：

*   将您的输出存储在一个`String`变量中，而不是`System.out.print`一点一点地处理它
*   在那`String`，删除尾随逗号，如果有的话（仅在情况下`cents == 0`或`nickels > 1`，但后者可能是你的错误）
*   用 替换最后一个逗号（`" and"`如果有）
*   输出`String`

如果您仍然完全陷入困境，请告诉我们，我相信有人会提出现成的解决方案（如果还没有的话）。

# iphone - 以编程方式将内容添加到音乐库

> ID：13147044
> 
> 赞同：6
> 
> 时间：2012-10-30T20:23:39.563
> 
> 标签：iphone, objective-c, ios, audio, export

我开发了一个应用程序，将某些声音存储在其 Documents 目录中。
是否可以将这些声音导出或存储到用户的 iPod 库中？如果重要，它们是 .caf 格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:33:28.477

只有当应用程序适用于越狱设备时才有可能。在这种情况下，您可以使用我的[libipodimport](http://github.com/H2CO3/libipodimport)库将音乐和音频文件导入 iPod 媒体库。

如果应用程序是通过 AppStore 分发的，那么很遗憾，这是不可能的，您仍然可以尝试使用私有 API：私有框架中的`SSDownload`,`SSDownloadQueue`和`SSDownloadMetadata`类（[此处为类转储标头](http://developer.limneos.net/?framework=StoreServices.framework&header=SSDownload.h)）启用它 - 您*可能*能够获得**如果您设法隐藏它们，则**通过 AppStore 使用这些，但这**是极不可能的。**`StoreServices`

# android - 在android中将FloatBuffer作为二进制文件读写

> ID：13147045
> 
> 赞同：1
> 
> 时间：2012-10-30T20:23:49.683
> 
> 标签：android, opengl-es, buffer, floatbuffer

我正在玩 OpenGL ES 2 和 FloatBuffers。实际上，我尝试将处理顶点数据的 FloatBuffer 保存到二进制文件中。它似乎有效，但是在读取浮点数并将它们一起放回 FloatBuffer 之后，对象就搞砸了。

为了从我的缓冲区中保存浮点数据，我使用以下代码：

```
for(int i = 0; i < bufferSize; i++)
 outStream.writeFloat(floatBuffer.get(i)); 
```

阅读：

```
for(int i = 0; i < bufferSize; i++)
  if(inStream.available() != 0)
    tmpFloat[i] = inStream.readFloat(); 
```

FloatBuffers 是这样创建的：

```
FloatBuffer VertexBuffer = ByteBuffer.allocateDirect(VertexFloatArray.length * mBytesPerFloat).order(ByteOrder.nativeOrder()).asFloatBuffer();
VertexBuffer.put(VertexFloatArray).position(0); 
```

有谁知道为什么会这样？

更新：我已经比较了写入和读取的数据，它们是相等的。问题仍然存在，这更加令人困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T13:44:35.613

好吧，我没有解决问题，但我尝试编写一个打包缓冲区（包含顶点、纹理坐标、法线等），而不是只将顶点缓冲区写入文件，这非常有效。我不知道为什么这会起作用，而单个缓冲区却不起作用，但为了我的需要，这个问题得到了回答。

# c# - 使用 Web 服务 HTTP Post

> ID：13147048
> 
> 赞同：2
> 
> 时间：2012-10-30T20:24:07.937
> 
> 标签：c#, http-post, servicestack

我正在使用[ServiceStack](http://servicestack.net)使用网络服务。预期的标题是：

```
POST /SeizureWebService/Service.asmx/SeizureAPILogs HTTP/1.1
Host: host.com
Content-Type: application/x-www-form-urlencoded
Content-Length: length

jsonRequest=string 
```

我正在尝试使用以下代码来使用它：

```
public class JsonCustomClient : JsonServiceClient
{
    public override string Format
    {
        get
        {
            return "x-www-form-urlencoded";
        }
    }

    public override void SerializeToStream(ServiceStack.ServiceHost.IRequestContext requestContext, object request, System.IO.Stream stream)
    {
        string message = "jsonRequest=";
        using (StreamWriter sw = new StreamWriter(stream, Encoding.Unicode))
        {
            sw.Write(message);
        }
        // I get an error that the stream is not writable if I use the above
        base.SerializeToStream(requestContext, request, stream);
    }
}

public static void JsonSS(LogsDTO logs)
{    
    using (var client = new JsonCustomClient())
    {
        var response = client.Post<LogsDTOResponse>(URI + "/SeizureAPILogs", logs);
    }
} 
```

我不知道如何`jsonRequest=`在序列化 DTO 之前添加。我该怎么做呢？

**基于神话的答案的解决方案**：

添加了我如何为将来遇到相同问题的人使用 Mythz 的答案 - 享受吧！

```
public static LogsDTOResponse JsonSS(LogsDTO logs)
{
    string url = string.Format("{0}/SeizureAPILogs", URI);
    string json = JsonSerializer.SerializeToString(logs);
    string data = string.Format("jsonRequest={0}", json);
    var response = url.PostToUrl(data, ContentType.FormUrlEncoded, null);
    return response.FromJson<LogsDTOResponse>();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:51:33.830

这是使用自定义服务客户端发送`x-www-form-urlencoded`数据的一种非常奇怪的用法，我认为尝试这样做有点雄心勃勃，因为 ServiceStack 的 ServiceClients 旨在发送/接收相同的内容类型。即使您的类被调用`JsonCustomClient`，它也不再是 JSON 客户端，因为您已经覆盖了该`Format`属性。

The issue your having is likely using the `StreamWriter` in a using statement which would close the underlying stream. Also I expect you calling the base method to be an error since you're going to have an illegal mix of Url-Encoded + JSON content-type on the wire.

Personally I would steer clear of the ServiceClients and just use any standard HTTP Client, e.g. ServiceStack has some [extensions to WebRequest](https://github.com/ServiceStack/ServiceStack/wiki/Http-Utils) that wraps the usual boilerplate required in making HTTP calls with .NET, e.g:

```
var json = "{0}/SeizureAPILogs".Fmt(URI)
           .PostToUrl("jsonRequest=string", ContentType.FormUrlEncoded);

var logsDtoResponse = json.FromJson<LogsDTOResponse>(); 
```

# c# - 如何对 LINQtoSQL 结果应用过滤器？

> ID：13147049
> 
> 赞同：2
> 
> 时间：2012-10-30T20:24:09.013
> 
> 标签：c#, linq-to-sql, attributes, system.reflection

使用 ListBox 控件，可以为其提供一个 DataSource，命名一个 DisplayMember 和一个 ValueMember，并且通过一些魔术，它会显示来自 DataSource 的一个字段并返回一个选定的 ValueMember。它可以处理 linq-to-sql 结果，甚至不知道它所提供的表的任何具体信息。

反射和属性不是在做一些魔术吗？它是如何工作的！我需要做类似的事情，但我不知道从哪里开始。我是 LINQtoSQL 的初学者。

这就是我想做的。我有一个要过滤的源表。源表可以是任何东西，但来自某些 DataContext。

```
var MySourceTable =
    from MyRecord in Context.GetTable<MySourceTable>()
    select new
    {
        Value = MyRecord.ID,
        Display = MyRecord.Name,
        FilterValue = MyRecord.Value
    }; 
```

在我的控制中，我希望能够根据某个给定值过滤 MySourceTable。控件不知道使用的是什么表（上面示例中的 MySourceTable），并且控件只知道它应该使用的记录中字段的三个名称、ID、名称和值。

过滤器查询应该类似于下面的示例。

```
var MyTable
    from Record in MySourceTable
    where FilterValue == GivenValue
    select new
    {
        Value = Record.ID,
        Display = Record.Name,
    }; 
```

有人可以告诉我从哪里开始吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:10:14.583

看起来您缺少的是查询的 where 条件。它应该如下所示：

```
var MyTable = 
    from Record in MySourceTable
    where Record.FilterValue == GivenValue
    select new
    {
        Value = Record.ID,
        Display = Record.Name,
    }; 
```

GivenValue 可能是一个局部变量或属性，其中包含您想要比较 FilterValue 的任何内容。但 FilterValue 是您在创建 MySourceTable 的第一个查询中创建的匿名类型的属性。在您的第二个查询中，Record 是该匿名类型的一个实例，您必须在查询的所有其他部分中使用对该实例的引用来引用您正在检查 where 子句或为 select 子句选择的实例。如果您只是将 FilterValue 放在那里，那么它不知道您的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T20:51:04.387

我编写了一个过滤器引擎，它将属性和值作为字符串接收，并且能够将其用作 where 子句。

```
IQueryable<T> FilterFunction<T>(IQueryable<T> query)
{
    ParameterExpression p = Expression.Parameter(typeof(T), "notused");

    Expression<Func<T, bool>> wherePredicate =
      Expression.Lambda<Func<T, bool>>(
          Expression.Equal(
            Expression.Call(Expression.Property(p, FilterProperty), "ToString", new Type[0]),
            Expression.Constant(FilterValue)), p);

    return query.Where(wherePredicate);
} 
```

您应该能够以`Expression<Func<T, TResult>>`类似的方式将内置传递给`query.Select()`

如果我正确理解您的问题，我相信这将起作用：

```
string DisplayProperty = "Name";
string ValueProperty = "ID";

IQueryable<Record> SelectRecordProperties<T>(IQueryable<T> query)
{
    ParameterExpression p = Expression.Parameter(typeof(T), "notused");

    MethodInfo ctorMethod = typeof(Record).GetMethod("Create");

    Expression<Func<T, Record>> selectPredicate =
      Expression.Lambda<Func<T, Record>>(
        Expression.Call(ctorMethod,
            Expression.PropertyOrField(p, DisplayProperty),
            Expression.PropertyOrField(p, ValueProperty)), p);

    return query.Select(selectPredicate);
}
class Record
{
    public static Record Create(string display, string value)
    {
        return new Record() { Display = display, Value = value };
    }
    public object Display { get; set; }
    public object Value { get; set; }
} 
```

因此，对于您的全部功能，您需要结合这两个想法，以便您的过滤工作。

顺便说一句，有很多可能的方法可以为此构建表达式树，我曾经发现一些工具可以向您展示我认为的表达式树，因此您可以手动编写 linq 查询并查看. Net 构建表达式，然后修改此代码以在此基础上构建它，以获得更有效的表达式树。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T20:00:08.533

我找到了一种方法，它有效，但不是一个完全令人满意的方法。

“问题”（与我原来的问题相比）是它不使用 linq-to-sql 来过滤源。但它有效，目前对我来说很好。

回顾：在高级模块中，我准备了一个 LINQtoSQL 语句，该语句将产生一些 IQueriable<Object>，实际上是一个 IQueriable 对象。该对象与三个名称一起提供给较低级别​​的模块，一个用于ID，一个用于显示，一个用于过滤。当我需要对源进行更多控制时，例如对于会产生巨大结果的未过滤数据或复杂的 LINQtoSQL 查询，我将使用委托函数。这将给我所有我想要的控制权。

在低级别，我有一个 IQueriable<Object> 并且对对象一无所知，除了 wat Reflection 可以告诉我。我生成了一个我想以特定于控件的格式使用的结果表。（记录类）。对于我的标准代码无法处理的更复杂的事情，我提供了一个委托，该委托必须产生一些对象列表，其中对象必须至少具有一个名为“Display”的属性和一个名为“Value”的属性。其他属性是可能的，但不会使用。

这是我最终开始工作的解决方案：

```
public partial class MySelector : UserControl
{
    class Record
    {
        public object Display { get; set; }
        public object Value { get; set; }
    }

    ....

    public string MyDisplayMember { get; set; }
    public string MyValueMember { get; set; }
    public string MyExternalMember { get; set; }

    ....

    static Object Filter(MySelector sender, Object criterium)
    {
        IQueryable source = sender.MySource as IQueryable;
        if (source == null) return null;

        List<Record> result = new List<Record>();

        // drawback: this foreach loop will trigger a unfiltered SQL command.
        foreach (var record in source)
        {
            MethodInfo DisplayGetter = null;
            MethodInfo ValueGetter = null;
            bool AddRecord = false;

            foreach (PropertyInfo property in record.GetType().GetProperties())
            {
                if (property.Name == sender.MyDisplayMember) 
                {
                    DisplayGetter = property.GetGetMethod();
                }
                else if (property.Name == sender.MyValueMember)
                {
                    ValueGetter = property.GetGetMethod();
                }
                else if (property.Name == sender.MyExternalMember)
                {
                    MethodInfo ExternalGetter = property.GetGetMethod();
                    if (ExternalGetter == null)
                    {
                        break;
                    }
                    else
                    {
                        object external = ExternalGetter.Invoke(record, new object[] { });
                        AddRecord = external.Equals(criterium);
                        if (!AddRecord)
                        {
                            break;
                        }
                    }
                }
                if (AddRecord && (DisplayGetter != null) && (ValueGetter != null))
                {
                    break;
                }
            }
            if (AddRecord && (DisplayGetter != null) && (ValueGetter != null))
            {
                Record r = new Record();
                r.Display = (DisplayGetter == null) 
                    ? null 
                    : DisplayGetter.Invoke(record, new object[] { });
                r.Value = (ValueGetter == null) 
                    ? null 
                    : ValueGetter.Invoke(record, new object[] { });
                result.Add(r);
            }
        }
        return result;
    }
} 
```

# django - django：查询ManyToMany属性调用多表继承

> ID：13147057
> 
> 赞同：0
> 
> 时间：2012-10-30T20:25:04.380
> 
> 标签：django, inheritance, orm, many-to-many, generics

我已经阅读[了一些](https://stackoverflow.com/questions/4147749/django-orm-inheritance-with-manytomany-field)[相关](https://stackoverflow.com/questions/933092/generic-many-to-many-relationships)的[问题](https://stackoverflow.com/questions/1393622/django-model-inheritance-filtering-models)，但是对于我的案例来说，最好的做法不是很清楚。我是一个试图学习的数据库 n00b，所以耐心等待。我的情况如下：

*   3 种类型的公司：制造商、经销商、ServiceNRepair（共享大约 10 个属性）
*   5 种产品：StuffedAnimals、自行车、芭比娃娃（也共享一些属性）

所以为了保持干燥，我尝试了多表继承：

```
# company.models.py

class GenericCompany(models.Model):
    name, description, address, etc

class Manufacturer(GenericCompany): #can manufacture different things
    stuff_specific_to_manufacturers
    product = models.ManyToMany(GenericProduct)

class Reseller(GenericCompany): #can sell different things
    stuff_specific_to_manufacturers
    product = models.ManyToMany(GenericProduct)

etc for ServiceNRepair 
```

同样对于产品，

```
# product.models.py

class GenericProduct(models.Model):
    name, price, color, etc

class StuffedAnimal(GenericProduct):
    fluffyness, ears_or_not, etc

class Bicycle(GenericProduct):
    wheel_diameter, weight, etc

etc for Barbies 
```

现在我需要执行如下查询

*   显示所有红色的产品（这很简单）
*   这家制造商生产什么产品？
*   查找经销商 X 销售的所有自行车

但是我可以用 M2M 做到这一点吗？`Manufacturer.objects.filter(product_icontains ='something')`这样的事情是行不通的。所以，我完全走错了路吗？使用 ContentTypes 的典型解决方案是什么？我只是想知道下一步该研究什么来解决这个问题，这肯定很普遍。任何提示表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:17:54.617

您可以执行类似`Manufacturer.objects.filter(product__name__icontains='something')`的操作，只需在 Product 中添加字段名称即可。

# c# - 将列表转换为数据透视表

> ID：13147059
> 
> 赞同：5
> 
> 时间：2012-10-30T20:25:07.760
> 
> 标签：c#, .net, pivot

我有一个清单：

```
IList<PIData> list = new List<PIData>() 
```

这会返回一个像这样的列表：

```
Timestamp        | End              | HeaderTitle | Value
=========================================================
12/12/2012 00:00 | 12/12/2012 00:01 | Test1       | 0.23
12/12/2012 00:00 | 12/12/2012 00:01 | Test2       | 0.34
12/12/2012 00:00 | 12/12/2012 00:01 | Test3       | 0.556 
```

这种情况一直持续下去，有时我会有 50-100 个不同的 HeaderTitles

我需要能够对此进行旋转并最终将其写入 CSV，其中 Row 是标题。我知道如何将对象转换为 CSV，但我很难旋转列表并希望有人能提供帮助。

这是我想要的样子：

```
Timestamp        | End              | Test1 | Test2 | Test3 | etc
==================================================================
12/12/2012 00:00 | 12/12/2012 00:01 | 0.23  | 0.34  | 0.556
12/12/2012 00:01 | 12/12/2012 00:02 | 0.23  | 0.34  | 0.556
12/12/2012 00:02 | 12/12/2012 00:03 | 0.23  | 0.34  | 0.556 
```

有人可以帮我完成这项工作吗？我真的只需要能够将我的列表转换为一个最终将成为 CSV 文件的新列表......我知道如何在 SQL 中执行此操作，但在这种情况下我无法使用 SQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:43:31.133

这是我最终做的对我有用的事情：

```
namespace ConsoleApplication3
{
class Program
{

    internal class PiData
    {
        public string HeaderName { get; set; }
        public DateTime TimeStamp { get; set; }
        public DateTime End { get; set; }
        public double Value { get; set; }
    }

    static void Main(string[] args)
    {
        var PD = new List<PiData>()
        {
            new PiData() { HeaderName="Test1", End = DateTime.Now.AddSeconds(15), TimeStamp = DateTime.Now, Value = 0.01 },
            new PiData() { HeaderName="Testf2", End = DateTime.Now.AddSeconds(15), TimeStamp = DateTime.Now, Value = 0.51 },
            new PiData() { HeaderName="Testff3", End = DateTime.Now.AddSeconds(15), TimeStamp = DateTime.Now, Value = 0.71 },
            new PiData() { HeaderName="Testfsd4", End = DateTime.Now.AddSeconds(15), TimeStamp = DateTime.Now, Value = 0.41 },
            new PiData() { HeaderName="Test1", End = DateTime.Now.AddSeconds(30), TimeStamp = DateTime.Now.AddSeconds(15), Value = 0.01 },
            new PiData() { HeaderName="Testf2", End = DateTime.Now.AddSeconds(30), TimeStamp = DateTime.Now.AddSeconds(15), Value = 0.51 },
            new PiData() { HeaderName="Testff3", End = DateTime.Now.AddSeconds(30), TimeStamp = DateTime.Now.AddSeconds(15), Value = 0.71 },
            new PiData() { HeaderName="Testfsd4", End = DateTime.Now.AddSeconds(30), TimeStamp = DateTime.Now.AddSeconds(15), Value = 0.41 },
        };

    var result2 = PD.Pivot(emp => emp.TimeStamp, emp2 => emp2.HeaderName, lst => lst.Sum(a => a.Value));
    StringBuilder sb = new StringBuilder();

    List<string> columns = new List<string>();
    columns.Add("TimeStamp");
    columns.Add("End");
    foreach (var item in PD.Select(a => a.HeaderName).Distinct())
    {
        columns.Add(item);
    }
    foreach (var item in columns)
    {
        sb.Append(item + ",");
    }
    sb.Remove(sb.Length - 1, 1);
    sb.AppendLine();
    foreach (var row in result2)
    {
        sb.Append(row.Key + "," + row.Key.AddSeconds(10).ToString() + ",");
        foreach (var column in row.Value)
        {
            sb.Append(column.Value + ",");
        }
        sb.Remove(sb.Length - 1, 1);
        sb.AppendLine();
    }
    Console.WriteLine(sb.ToString());
    Console.WriteLine("----"); 

    }
}

public static class LinqExtenions
{

    public static Dictionary<TFirstKey, Dictionary<TSecondKey, TValue>> Pivot<TSource, TFirstKey, TSecondKey, TValue>(this IEnumerable<TSource> source, Func<TSource, TFirstKey> firstKeySelector, Func<TSource, TSecondKey> secondKeySelector, Func<IEnumerable<TSource>, TValue> aggregate)
    {
        var retVal = new Dictionary<TFirstKey, Dictionary<TSecondKey, TValue>>();

        var l = source.ToLookup(firstKeySelector);
        foreach (var item in l)
        {
            var dict = new Dictionary<TSecondKey, TValue>();
            retVal.Add(item.Key, dict);
            var subdict = item.ToLookup(secondKeySelector);
            foreach (var subitem in subdict)
            {
                dict.Add(subitem.Key, aggregate(subitem));
            }
        }

        return retVal;
    }
}

} 
```

# regex - 正则表达式 mod_rewrite ?-mark 导致错误的符号

> ID：13147061
> 
> 赞同：0
> 
> 时间：2012-10-30T20:25:17.033
> 
> 标签：regex, .htaccess, mod-rewrite

我正在尝试将旧式链接从旧网站重定向到 php 中的新式链接。

我正在使用：

```
RewriteEngine on
    RewriteBase /
    RewriteRule s\.cfm?id=5$ http://mysite.com/article5.php [B,L,R=301]
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L] 
```

但是，如果我只使用**s.cfm？** 一切正常并重定向到 article5.php。但是如果我尝试重定向 id=5 部分，我会找不到页面。

我只尝试了**s.cfm?id** ，它导致了 htaccess 错误。所以你在问号后面放的任何东西？...都会导致问题，我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:30:32.053

您无法匹配 a 中的查询字符串`RewriteRule`，只能通过规则本身发送 URI 路径。如果您需要匹配查询字符串，请`%{QUERY_STRING}`在 a 中使用 var `RewriteCond`：

```
RewriteCond %{QUERY_STRING} ^id=5$
RewriteRule ^/?s\.cfm$ http://mysite.com/article5.php [L,R=301] 
```

其他一切都很好。

# ajax - Rails 3：redirect_to with :remote => true

> ID：13147070
> 
> 赞同：6
> 
> 时间：2012-10-30T20:26:23.533
> 
> 标签：ajax, ruby-on-rails-3, redirect

我有一个远程调用的删除链接：

```
<%= link_to image_tag("trash.png"), [current_user, bookcase], method:  :delete, :remote => true, confirm: "You sure?", title:   bookcase.image %> 
```

在我的控制器中，我通过重定向结束删除功能：

```
def destroy
  @bookcase.destroy
  redirect_to current_user
end 
```

这可行，除了它将用户重定向到“user/show.html.erb”文件而不是“user/show.js.erb”文件。如何重定向用户，指定使用哪种格式？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-05-02T16:38:31.620

不知道这是否回答了这个特定问题，但有些人可能会发现以下内容有帮助：

```
module AjaxHelper
  def ajax_redirect_to(redirect_uri)
    { js: "window.location.replace('#{redirect_uri}');" }
  end
end

class SomeController < ApplicationController
  include AjaxHelper

  def some_action
    respond_to do |format|
      format.js { render ajax_redirect_to(some_path) }
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-30T20:34:14.427

我很确定您可以像这样在 redirect_to 中指定格式

`redirect_to current_user, format: 'js'`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-07T13:35:25.583

我很确定这段代码会起作用。

```
render :js => "window.location = '/jobs/index' 
```

您可以在操作 /controller_name/action name/ 中使用此代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-20T18:52:59.077

我尝试了接受的答案，但对我不起作用（RAILS 6），对我有用的是：

```
format.js { redirect_to current_user } 
```

希望这对某人有帮助

# javascript - 了解 AngularJS 的 $resource

> ID：13147071
> 
> 赞同：3
> 
> 时间：2012-10-30T20:26:34.033
> 
> 标签：javascript, angularjs, ngresource

我不太明白如何正确使用 AngularJS 的 $resource。例如，我有一个 REST API，它返回如下数据：

```
{
    "status": "success",
    "data": {
        "expand": "schema,names",
        "startAt": 0,
        "maxResults": 10,
        "total": 38,
        "issues": [{ ... }, { ... }, {...}, ...]
    }
} 
```

现在我想弄清楚的是如何在 AngularJS 中使用 $resource，其中 data.issues 中的每个对象都作为资源返回（因此在这种情况下，获取 10 个资源的数组/集合）但它看起来并不真正就像我可以从我找到的有限资源中使用 AngularJS 的 $resource 来做到这一点，或者我可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T20:41:43.037

$resource 需要一个经典的“RESTful”API 源。这意味着您将拥有一个端点，其中 GET、PUT、POST、DELETE 方法都会影响给定的资源类型，并且这些消息的主体将仅包含资源，而不包括资源和一堆元数据。

对于您正在尝试做的事情，如果这是您坚持使用的 API，您可能必须使用 $http 来滚动您自己的，因为它看起来像它响应的 JSON 包含一堆元数据$resource 不会在意。

唯一的其他选择是编写某种 httpInterceptor ，它将您从 Web 服务返回的内容转换为 $resource 可以更无缝地处理的内容。

虽然从语义上讲，您的 Web 服务可能通常是“RESTful”，但在当前的经典标准中它不是 RESTful。

更多关于 REST的信息在[这里](https://stackoverflow.com/questions/671118/what-exactly-is-restful-programming)

* * *

编辑：在上述信息之外，如果没有看到您的 Web API 的签名或不知道您要做什么，就很难更详细地回答您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-02T18:51:38.410

使用较新版本的 Angular，您可以为将绕过外部包装器的资源操作提供回调。

```
$resource('', {}, {
    query: {
        method: 'GET',
        isArray: true,
        transformResponse: function(response) {
            return JSON.parse(response).data.issues;
        }
    }
}); 
```

然后在你的资源回调函数中

```
Issue.query({
    //query params
}, function(issues) {
    //issues will be an array of your issues that you can process
    //or just add to the scope to be iterated over              
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T17:01:44.973

查看代码，blesh 是正确的，所以我所做的是修改基本 $resource 代码以支持自定义编码器/解码器，以使 $resource 能够使用任何可能具有自定义格式的 REST API。向 angularjs hopping 提出了拉取请求，他们将包含它，所以我不必维护这个单独的分叉：[https ://github.com/angular/angular.js/pull/1514](https://github.com/angular/angular.js/pull/1514)

# css - CSS 可以选择具有特定内容的元素吗？- 未发布答案

> ID：13147073
> 
> 赞同：0
> 
> 时间：2012-10-30T20:26:38.650
> 
> 标签：css

> **可能重复：**
> [CSS 可以选择具有特定内容的元素吗？](https://stackoverflow.com/questions/9170940/can-css-select-elements-with-specific-content)

我看到了@sackbot14 建议找到答案的[帖子。](https://stackoverflow.com/questions/9170940/can-css-select-elements-with-specific-content)不幸的是，答案没有贴在里面。

有机会唤醒熊吗？

基本上，我想在页面上/在 div 中找到特定文本，并仅使用 HTML 和 CSS 突出显示它或其他内容[没有 JS、没有 PHP、没有 JQuery 等]。欢迎使用技巧！

非常感谢！

# c# - 当使用 2 层架构将 UseEmbeddedHttpServer 设置为 true 时，如何使我的 RavenDB 应用程序正确执行？

> ID：13147077
> 
> 赞同：51
> 
> 时间：2012-10-30T20:26:55.797
> 
> 标签：c#, web-applications, asp.net-mvc-4, asp.net-web-api, ravendb

我在我的应用程序中使用**了 RavenDB-Embedded 2.0.2230**，并在不同的程序集中与 ASP .Net Web API 交互。

当我`UseEmbeddedHttpServer = true`在文档存储上设置时，第一次向 RavenDB 发送请求时，它会正确执行，但是当我第二次尝试时，我的应用程序会显示 Raven Studio。

当我删除`UseEmbeddedServer`设置时，我的应用程序运行没有任何问题。

我的 RavenDB 在数据层配置了以下代码：

```
this.documentStore = new EmbeddableDocumentStore
{
    ConnectionStringName = "RavenDB",
    UseEmbeddedHttpServer = true
}.Initialize(); 
```

并`Web.config`在服务层中实现这些设置：

```
<connectionStrings>
    <add name="RavenDB" connectionString="DataDir=~\App_Data\RavenDatabase" />
</connectionStrings> 
```

有没有我错过的设置？

是否需要应用任何设置才能将 Raven Studio 指向不同的端口？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T16:35:36.627

我可以重现您描述的体验的唯一方法是故意制造端口冲突。默认情况下，RavenDB 的 Web 服务器托管在端口 8080 上，因此如果您不更改 raven 的端口，那么您必须将 WebApi 应用程序托管在端口 8080 上。如果不是这种情况，请在评论中告诉我，但我会假设原来如此。

更改 Raven 使用的端口所需要做的就是在调用`Initialize`方法之前修改端口值。

将此`RavenConfig.cs`文件添加到您的`App_Startup`文件夹：

```
using Raven.Client;
using Raven.Client.Embedded;

namespace <YourNamespace>
{
    public static class RavenConfig
    {
        public static IDocumentStore DocumentStore { get; private set; }

        public static void Register()
        {
            var store = new EmbeddableDocumentStore
                        {
                            UseEmbeddedHttpServer = true,

                            DataDirectory = @"~\App_Data\RavenDatabase", 
                            // or from connection string if you wish
                        };

            // set whatever port you want raven to use
            store.Configuration.Port = 8079;

            store.Initialize();
            this.DocumentStore = store;
        }

        public static void Cleanup()
        {
            if (DocumentStore == null)
                return;

            DocumentStore.Dispose();
            DocumentStore = null;
        }
    }
} 
```

然后在您的`Global.asax.cs`文件中，执行以下操作：

```
protected void Application_Start()
{
    // with your other startup registrations
    RavenConfig.Register();
}

protected void Application_End()
{
    // for a clean shutdown
    RavenConfig.Cleanup();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T13:58:42.563

当您在 EmbeddableDocumentStore 中启用 HttpServer 时，ravenDB 会“劫持”Web 应用程序并开始在应用程序正在运行的同一端口上侦听。

> Oren Eini：当您从 IIS 内部使用 UseEmbeddedHttpServer 时，它会从 IIS 获取端口。您需要再次设置该值

在[https://groups.google.com/forum/?fromgroups=#!topic/ravendb/kYVglEoMncw](https://groups.google.com/forum/?fromgroups=#!topic/ravendb/kYVglEoMncw)

防止它的唯一方法是关闭 raven http-server 或将其分配给不同的端口

```
int ravenPort = 8181;
NonAdminHttp.EnsureCanListenToWhenInNonAdminContext(ravenPort);
var ds = new EmbeddableDocumentStore {
   DataDirectory = [DataFolder],    
   UseEmbeddedHttpServer = true,    
   Configuration = {Port = ravenPort}
}; 
```

# c# - 网页有时对回发没有响应

> ID：13147081
> 
> 赞同：0
> 
> 时间：2012-10-30T20:27:06.203
> 
> 标签：c#, asp.net, ajax

我正在 VS 2010 上开发一个 ASP.NET 项目，该项目到目前为止完全是本地的，并且不断出现一个我似乎无法解释的奇怪问题。

本质上，有时当我执行导致某种回发事件的操作时（例如，更改下拉列表的选择，该下拉列表根据下拉列表选择重新填充网格视图），页面会像正常回发一样“闪烁”，但随后导致空白页。

由于这种情况很少发生，我决定暂时忽略它并专注于项目的其他方面。但是，在我使用 AJAX 实现部分回发之后，我想我可能已经发现发生了什么。

对于部分回发，页面现在不会在每次回发时重新加载，而且我注意到偶尔执行一个应该导致回发的操作绝对没有任何作用。

所以我的假设是，不知何故，触发的事件会导致回发，然后在某个地方挂断？我对网络编程相当陌生，所以在这一点上我很茫然。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:05:37.123

您似乎有一个间歇性错误，影响了您网站的大部分内容，而没有给您任何错误或日志记录。这被通俗地称为“一个巨大的头痛”。

您可以采取以下几个步骤来获得有关该问题的更多信息：

*   在您的浏览器/客户端上，安装一个开发者插件，例如 Firebug，它允许您在进行调用时单步执行您的 AJAX/javascript。注意任何看起来很奇怪或可能暗示您未能解决对回发至关重要的信息的情况。Javascript 的健壮性意味着它经常可以做一些逻辑上无意义的事情，并且不会像 C# 这样的更特殊的语言所期望的那样出现信息错误的巨大崩溃。

*   在连接上，安装 Fiddler 并记录所有通过线路发出的请求和响应。当您设法重现错误时，请仔细检查发送到服务器的请求，看看它是否与其他请求不同。如果你得到回应，也要调查一下。

*   在服务器端，尝试将一个 Visual Studio 调试器放到 Web 服务器实例中，这样您就可以了解什么时候被击中，什么时候没有被击中。如果你能做到这一点，你至少可以看看当它失败时它是否会一直进入你的代码。

询问您的办公室/工作空间最近是否存在任何已知的硬件问题也可能会有所帮助。这听起来不太可能，因为其他一切都在工作，但是在处理这样的问题时，检查所有基础是个好主意。

# c# - 如何在 C# 中将数组的一部分设置为随机值？

> ID：13147084
> 
> 赞同：2
> 
> 时间：2012-10-30T20:27:16.657
> 
> 标签：c#, arrays, random, numbers

我是编程新手，所以请多多包涵！

我正在尝试将数组的各个部分设置为随机值，但是每当我运行程序时，它会将数组的所有部分设置为相同的值。我希望他们都与众不同。

这是我的代码：

```
int[] hello_array = new int[10];
        Console.WriteLine("Here");

        Random rndm = new Random();

        for (int j = 0; j < hello_array.Length; j++)
        {
            hello_array[j] = rndm.Next(99);
        }

        Console.WriteLine("Now Here");

        for (int i = 0; i < hello_array.Length; i++)
        {
            Console.WriteLine("hahahaha look at this " + hello_array[0]); 
```

我可能完全错过了它，但我不知道我的代码有什么问题！有人可以告诉我如何使数组的所有十个部分生成不同的随机数吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T20:28:59.573

改变这个：

```
 Console.WriteLine("hahahaha look at this " + hello_array[0]); 
```

对此：

```
 Console.WriteLine("hahahaha look at this " + hello_array[i]); 
```

您在每个循环中都在数组中打印相同的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:50:25.037

使用相同的行数，您可以使用一些较新的 C# 功能来完成相同的结果（但没有所有杂乱的细节）。

您将定义一个带有两个参数的[泛型方法](http://msdn.microsoft.com/en-us/library/twcad0zb%28v=vs.110%29.aspx)：一个[*lambda 表达式*](https://stackoverflow.com/q/167343/1106367)（例如`() => random.Next(99)`）和要生成的元素数。在方法内部，您将使用[`yield`](http://msdn.microsoft.com/en-us/library/9k7k7cf0%28v=vs.110%29.aspx)关键字返回工厂生成的新元素。

```
Random random = new Random();
foreach (var element in Generate(() => random.Next(99), 10))
{
    Console.WriteLine(element);
} 
```

* * *

```
public static IEnumerable<T> Generate<T>(Func<T> factory, int elements)
{
    for (int generated = 0; generated < elements; generated++)
    {
        yield return factory();
    }
} 
```

# wpf - WPF ToggleButton.IsChecked 绑定不起作用

> ID：13147086
> 
> 赞同：6
> 
> 时间：2012-10-30T20:27:19.757
> 
> 标签：wpf, data-binding, togglebutton

.NET 3.5 中的 ToggleButton 上的 IsChecked 属性的两种方式绑定是否存在问题？

我有这个 XAML：

```
 <ToggleButton 
                    Name="tbMeo"
                    Command="{Binding FilterOnSatelliteTypeCmd}" 
                    IsChecked="{Binding ShowMeoDataOnly, Mode=TwoWay}"
                    ToolTip="Show MEO data only">
                    <Image Source="../images/32x32/Filter_Meo.png" Height="16" />
                </ToggleButton> 
```

我有一个具有以下属性的 ViewModel：

```
 private bool _showMeoDataOnly;
    public bool ShowMeoDataOnly
    {
        get { return _showMeoDataOnly; }
        set
        {
            if (_showMeoDataOnly != value)
            {
                _showMeoDataOnly = value;
                RaisePropertyChangedEvent("ShowMeoDataOnly");
            }
        }
    } 
```

如果我单击 ToggleButton，则 ShowMeoDataOnly 的值会相应设置。但是，如果我从后面的代码中将 ShowMeoDataOnly 设置为 true，则 ToggleButton 的视觉状态不会更改以指示 IsChecked 为 true。但是，如果我手动设置 ToggleButton 的 IsChecked 属性，而不是在后面的代码中将 ShowMeoDataOnly 设置为 true，则按钮的视觉状态会相应更改。

不幸的是，现在不能切换到 .NET 4/4.5，因此我无法确认这是否是 .NET 3.5 问题。

我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:49:15.820

使用 .NET 3.5 项目对此进行测试，绑定似乎对我有用。您是否在 ViewModel 上实现了 INotifyPropertyChanged 并在设置 ShowMeoDataOnly 时适当地使用它？您没有发布所有代码，因此很难判断 ViewModel 在做什么。

这就是我所做的工作。当我运行应用程序时，该按钮被选中。那是因为`ViewModelBase`实现`INotifyPropertyChanged`，我`base.OnPropertyChanged("ShowMeoDataOnly")`在设置属性时会这样做。

**主窗口.xaml**

```
<Window x:Class="ToggleButtonIsCheckedBinding.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ToggleButtonIsCheckedBinding"
        Title="MainWindow" Height="350" Width="525">
    <Window.DataContext>
        <local:MainWindowViewModel />
    </Window.DataContext>
    <Grid>
        <ToggleButton IsChecked="{Binding ShowMeoDataOnly, Mode=TwoWay}">
            Show Meo Data Only
        </ToggleButton>
    </Grid>
</Window> 
```

**MainWindowViewModel.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ToggleButtonIsCheckedBinding
{
    class MainWindowViewModel : ViewModelBase
    {
        bool _showMeoDataOnly;
        public bool ShowMeoDataOnly {
            get
            {
                return _showMeoDataOnly;
            }

            set
            {
                _showMeoDataOnly = value;
                base.OnPropertyChanged("ShowMeoDataOnly");
            }
        }

        public MainWindowViewModel()
        {
            ShowMeoDataOnly = true;
        }
    }
} 
```

**ViewModelBase.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.ComponentModel;

namespace ToggleButtonIsCheckedBinding
{
    /// <summary>
    /// Base class for all ViewModel classes in the application.
    /// It provides support for property change notifications 
    /// and has a DisplayName property.  This class is abstract.
    /// </summary>
    public abstract class ViewModelBase : INotifyPropertyChanged, IDisposable
    {
        #region Constructor

        protected ViewModelBase()
        {
        }

        #endregion // Constructor

        #region DisplayName

        /// <summary>
        /// Returns the user-friendly name of this object.
        /// Child classes can set this property to a new value,
        /// or override it to determine the value on-demand.
        /// </summary>
        public virtual string DisplayName { get; protected set; }

        #endregion // DisplayName

        #region Debugging Aides

        /// <summary>
        /// Warns the developer if this object does not have
        /// a public property with the specified name. This 
        /// method does not exist in a Release build.
        /// </summary>
        [Conditional("DEBUG")]
        [DebuggerStepThrough]
        public void VerifyPropertyName(string propertyName)
        {
            // Verify that the property name matches a real,  
            // public, instance property on this object.
            if (TypeDescriptor.GetProperties(this)[propertyName] == null)
            {
                string msg = "Invalid property name: " + propertyName;

                if (this.ThrowOnInvalidPropertyName)
                    throw new Exception(msg);
                else
                    Debug.Fail(msg);
            }
        }

        /// <summary>
        /// Returns whether an exception is thrown, or if a Debug.Fail() is used
        /// when an invalid property name is passed to the VerifyPropertyName method.
        /// The default value is false, but subclasses used by unit tests might 
        /// override this property's getter to return true.
        /// </summary>
        protected virtual bool ThrowOnInvalidPropertyName { get; private set; }

        #endregion // Debugging Aides

        #region INotifyPropertyChanged Members

        /// <summary>
        /// Raised when a property on this object has a new value.
        /// </summary>
        public event PropertyChangedEventHandler PropertyChanged;

        /// <summary>
        /// Raises this object's PropertyChanged event.
        /// </summary>
        /// <param name="propertyName">The property that has a new value.</param>
        protected virtual void OnPropertyChanged(string propertyName)
        {
            this.VerifyPropertyName(propertyName);

            PropertyChangedEventHandler handler = this.PropertyChanged;
            if (handler != null)
            {
                var e = new PropertyChangedEventArgs(propertyName);
                handler(this, e);
            }
        }

        #endregion // INotifyPropertyChanged Members

        #region IDisposable Members

        /// <summary>
        /// Invoked when this object is being removed from the application
        /// and will be subject to garbage collection.
        /// </summary>
        public void Dispose()
        {
            this.OnDispose();
        }

        /// <summary>
        /// Child classes can override this method to perform 
        /// clean-up logic, such as removing event handlers.
        /// </summary>
        protected virtual void OnDispose()
        {
        }

#if DEBUG
        /// <summary>
        /// Useful for ensuring that ViewModel objects are properly garbage collected.
        /// </summary>
        ~ViewModelBase()
        {
            string msg = string.Format("{0} ({1}) ({2}) Finalized", this.GetType().Name, this.DisplayName, this.GetHashCode());
            System.Diagnostics.Debug.WriteLine(msg);
        }
#endif

        #endregion // IDisposable Members
    }
} 
```

（注意：ViewModelBase 是从这个项目中提取的：http: [//msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T20:32:33.567

验证您的 DataContext 是否设置正确。

```
DataContext = this; 
```

...在您的 MainWindow.xaml.cs 构造函数中是最简单的方法，假设我们正在查看的代码在 MainWindow 类中。

# java - 使用“dist”指定 Play 2.0 端口

> ID：13147089
> 
> 赞同：6
> 
> 时间：2012-10-30T20:27:40.790
> 
> 标签：java, playframework, sbt

我正在使用创建打包项目`dist`并尝试修改生成的`start`脚本以在 port 上运行应用程序`9001`。

这是生成的内容：

```
exec java $* -cp "`dirname $0`/lib/*" play.core.server.NettyServer `dirname $0` 
```

这是我尝试过的，这似乎不起作用。

```
exec java $* -Dhttp.port=9001 -cp "`dirname $0`/lib/*" play.core.server.NettyServer `dirname $0` 
```

有任何想法吗？

我也尝试过指定`http.port=9001`in`application.conf`无济于事。在 Play 1.2.X中**很容易**做到这一点，似乎倒退了一步。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T20:47:52.527

运行`play dist`并解压缩生成的包后，您可以通过运行以下命令在不同的端口上启动 Play 2：

```
./start -Dhttp.port=5432 
```

或者，如果您更愿意编辑`start`脚本，您可以将其更新为：

```
#!/usr/bin/env sh

exec java $* -Dhttp.port=5432 -cp "`dirname $0`/lib/*" play.core.server.NettyServer `dirname $0` 
```

然后运行：

```
./start 
```

# for-loop - 如何简化 Javascript 中的简单循环？

> ID：13147090
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:27:44.380
> 
> 标签：for-loop

我现在正在尝试一段时间并让它变得完美。我正在尝试简化我创建的这个*for 循环*并使其实际工作，没有任何数组，只有最基本的基本 JavaScript。

```
for (var x=0;x<=1;x++) { 
    if (secondInput == luckyNumber || secondInput == luckyNumber2 || secondInput == luckyNumber3) { 
        if (thirdInput == luckyNumber || thirdInput == luckyNumber2 || thirdInput == luckyNumber3) {
            if (firstInput == luckyNumber || firstInput == luckyNumber2 || firstInput == luckyNumber3) {
                while (firstInput !== secondInput){
                    while(firstInput !== thirdInput){while(secondInput !== thirdInput) {
                        alert('Congratulations! You got all 3 numbers correct. You\'ve won £1,000!');
                    }
                }
            }
        }
    }
} 
```

这段代码有意义还是我做错了什么？我有一种感觉，我什至可以离开循环，但这是我认为它是正确的唯一方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:30:22.317

编写一个函数，接受输入，将其与幸运数字进行比较，并返回一个布尔值和结果。

`if`在您的子句中调用该函数。

我不太明白你想用`while`循环做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:39:13.957

您可以尝试使用这个想法来帮助：

```
[1, 3, 2].sort() 
```

（将您的问题和答案存储在数组中，然后对两者进行排序然后比较。当然，检查 javascript 数组是否相等是一个有趣的新项目 :)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T00:46:35.813

干得好。你说你希望它简化。

```
for (var x = 0; 1 >= x; x++) {
if (!(secondInput != luckyNumber && secondInput != luckyNumber2 && secondInput != luckyNumber3 || thirdInput != luckyNumber && thirdInput != luckyNumber2 && thirdInput != luckyNumber3 || firstInput != luckyNumber && firstInput != luckyNumber2 && firstInput != luckyNumber3)) {
    while (firstInput !== secondInput) {
        while (firstInput !== thirdInput) {
            while (secondInput !== thirdInput) {
                alert("Congratulations! You got all 3 numbers correct. You\'ve won £1,000!");
            }
        }
    }
}
} 
```

# expressionengine - 使用 Matrix 的营业时间

> ID：13147093
> 
> 赞同：11
> 
> 时间：2012-10-30T20:27:55.740
> 
> 标签：expressionengine

我正在建立一个企业目录，不仅要发布营业时间列表，还要发布企业当前是否营业。

在一个矩阵中，我有 7 行，其中 row_1 代表周六的周日 row_7。所以我有两个问题。

1.  这和代码一样简洁还是有更好的方法？
2.  判断企业当前是否营业的条件是否存在缺陷？它现在似乎可以工作，但没有经过很好的测试。

    ```
    {!-- Hours of Operation --}  
    {exp:stash:set name="hours-of-operation"}
    The Current time is: {current_time format="%g:%i%a"}<br/>
       {hours_of_operation}
       {if row_count=="1"}Sunday{/if}
       {if row_count=="2"}Monday{/if}
       {if row_count=="3"}Tuesday{/if}
       {if row_count=="4"}Wednesday{/if}
       {if row_count=="5"}Thursday{/if}
       {if row_count=="6"}Friday{/if}
       {if row_count=="7"}Saturday{/if}
       {open_time format="%g:%i%a"} - {close_time format="%g:%i%a"}<br/>
       {/hours_of_operation}
    {/exp:stash:set} 
    {!-- Hours of Operation --}

    {!-- Are we open? --}
    {exp:stash:set name="are-we-open"}
    {exp:mx_calc expression='{current_time format="%w"}+1'}
        {!-- matrix --}
        {hours_of_operation}                
            {if row_count=="{calc_result}"}
                Today is: {current_time format="%l"}<br/>
        <strong>
                {if '{open_time format="%H%i"}' <= '{current_time format="%H%i"}' && '{close_time format="%H%i"}' <= '{current_time format="%H%i"}'}    
                We are currently open!{if:else}We are currently closed.
            {/if}
            </strong><br/>
                Today's Hours are:<br/> <strong>{open_time format="%g:%i%a"} - {close_time format="%g:%i%a"}</strong><br/>              
            {/if}   
        {/hours_of_operation} 
        {!-- matrix --}
    {/exp:mx_calc}
    {/exp:stash:set}
    {!-- Are we open? --} 
    ```

![在此处输入图像描述](../Images/a63ecfb354fa68039e980c2ebbf9ab83.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T00:30:47.737

这对我来说看起来不错，我唯一要更改的是在矩阵左侧添加另一列并将其称为星期几，并通过下拉菜单允许客户选择日期。然后在您的代码中，您可以摆脱所有这些条件并将其替换为 {day_of_week}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:08:52.653

这个逻辑不应该起作用：

```
{if '{open_time format="%H%i"}' <= '{current_time format="%H%i"}' && '{close_time format="%H%i"}' <= '{current_time format="%H%i"}'} 
```

您正在检查关闭时间和打开时间是否都小于`current_time`，而不是检查这`current_time`两个值之间。如果业务是开放的，那么`close_time`应该*超过*，而不是`current_time`更少。逻辑应该是：

```
{if 
    '{open_time format="%H%i"}' <= '{current_time format="%H%i"}' && 
    '{close_time format="%H%i"}' > '{current_time format="%H%i"}'
} 
```

* * *

另外，如果我们很挑剔，如果人们必须为一周中完全关闭的一天或多天的企业输入数据，他们会怎么做？如果是我，我会在“全天关闭”列中添加一个[PT Switch字段，默认为否。](http://pixelandtonic.com/divebar)它只需要对您现有的逻辑进行一些小的调整：

```
{if
    '{open_time format="%H%i"}' <= '{current_time format="%H%i"}' && 
    '{close_time format="%H%i"}' > '{current_time format="%H%i"}' && 
    '{closed_all_day}' != 'y'
}    
    We're currently open!
{if:else} 
```

然后在`{hours_of_operation}`循环中：

```
{if closed_all_day != 'y'}
    {open_time format="%g:%i%a"} - {close_time format="%g:%i%a"}<br/>
{else}
    Closed<br/>
{/if} 
```

# oracle - Oracle Clob 保存复杂的 XML；如何使用 Xquery 选择特定数据

> ID：13147095
> 
> 赞同：2
> 
> 时间：2012-10-30T20:27:59.917
> 
> 标签：oracle, plsql, xml-parsing, xquery

我正在尝试从存储在商业应用程序的 CLOB 字段中的复杂 XML 数据集中提取特定数据。我无法更改 XML 格式（命名空间等），也无法将 CLOB 更改为 XMLType。

xml 数据如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Calculation>
  <ProcessUnitModelScenario Id="1265319" EntityId="10030" EntityName="Chaco Plant" ProcessUnitId="10225" ProcessUnitName="Turbine - Unit 37" EmissionModelId="10000" EmissionModelName="Emissions" ScenarioId="10053" ScenarioName="GHG_Comb_Run_Time" EffectiveDate="1/1/2012 12:00:00 AM" EndDate="2/1/2012 12:00:00 AM" ActiveDate="1/1/2008 12:00:00 AM" ProductionUnitId="10031" ProductionUnitName="Default Production Unit - Month" ProductionScheduleId="13541" OperatingPercentage="100" LinkLevel="1">
    <EmissionModel Id="10935" EffectiveDate="1/1/2012 12:00:00 AM" EndDate="2/1/2012 12:00:00 AM">
      <EmissionModelMaterial Id="13250" OutputType="Air Emissions" OutputTypeId="1" Media="Vapor" MediaName="Air" MaterialId="83" EquationId="10096" EquationName="GHG Combustion: Run time" EquationUnit="lb/hr" EquationUnitName="lb/hr" EquationBaseUnit="lb/hr" EquationBaseUnitName="lb/hr" SpeciationOption="StandardSpeciation" SpeciationOptionName="Standard Speciation" UseComponentVaporPressureMethods="False" VaporPressureOptionName="Material's vapor pressure methods">
        <Material Id="83" Name="Methane" EffectiveId="10082" EffectiveDate="1/1/1990 12:00:00 AM" ComponentBasis="Vapor" MolecularWeight="16.043" LiquidDensity="1.34687732957939" VaporPressureMethod="Riedels" RiedelA="39.205" RiedelB="-1324.4" RiedelC="-3.4366" RiedelD="3.1E-05" RiedelE="2" UseDefinedComposition="False">
          <CalculationPeriod StartDate="1/1/2012 12:00:00 AM" EndDate="2/1/2012 12:00:00 AM">
            <EquationVariable Id="11079" Name="HeatRating" Order="10" BaseUnit="BTU/sec" EquationUnit="MMBtu/hr" Type="System" TypeName="System Variable" SystemCalculationType="ProcessUnitProperty" SystemCalculationName="Process Unit Property" SystemParameterProcessPropertyId="10005" SystemParameterModelOutputTypeId="1" TimeDependent="False" Value="116" EnteredValue="116" EnteredUnit="MMBtu/hr" />
            <EquationVariable Id="11077" Name="GHGEF" Order="20" BaseUnit="lb/BTU" EquationUnit="kg/MMBTU" Type="GlobalEmissionFactor" TypeName="Global Emission Factor" TimeDependent="True" Value="0.001" EnteredValue="0.001" EnteredUnit="kg/MMBTU" />
            <EquationVariable Id="11078" Name="RunHrs" Order="30" BaseUnit="hr" Type="Parameter" TypeName="Parameter" ParameterLevel="ProcessUnit" ParameterLevelName="Process Unit" ParameterId="10044" ParameterName="RunHrs - " TimeDependent="True" Value="612" EnteredValue="612" EnteredUnit="hr" />
            <EquationVariable Id="11080" Name="kgtolb" Order="40" BaseUnit="lb" Type="GlobalConstant" TypeName="Global Constant" GlobalConstantId="10007" TimeDependent="False" Value="2.20462" />
            <EquationVariable Id="11081" Name="OpHrs" Order="45" BaseUnit="hr" EquationUnit="hr" Type="System" TypeName="System Variable" SystemCalculationType="OperatingHours" SystemCalculationName="Operating Hours" TimeDependent="True" Value="744" />
            <EquationVariable Id="11082" Name="EmissionRate" Order="46" BaseUnit="lb/hr" Type="FinalResult" TypeName="Final Expression" Formula="(HeatRating*GHGEF)*RunHrs*kgtolb/OpHrs" TimeDependent="True" Value="0.210363418064516" />
            <Emission EffectiveDate="1/1/2012 12:00:00 AM" EndDate="2/1/2012 12:00:00 AM" BaseUnit="lb/hr" BaseUnitName="lb/hr" EmissionAmount="0.210363418064516" Unit="lb/hr" UnitName="lb/hr" ResultValue="0.210363418064516" LinkType="Unabated" LinkTypeName="" OperatingHours="744" EmissionMass="156.51038304" EmissionMassUnit="lb" MaterialId="83" EffectiveMaterialId="10082" MaterialName="Methane" MaterialEffectiveDate="1/1/1990 12:00:00 AM" />
          </CalculationPeriod>
        </Material>
        <Material  etc...>
        </Material>
      </EmissionModelMaterial>
      <EmissionModelMaterial  etc...>
      </EmissionModelMaterial>
    </EmissionModel> 
    <EmissionModel  etc...> 
    </EmissionModel> 
  <ProcessUnitModelScenario  etc...>
  </ProcessUnitModelScenario>
</Calculation> 
```

我需要从元素中返回某些属性值，以指定 [ProcessUnitModelScenario/@ProcessUnitId]、[ProcessUnitModelScenario/@ScenarioId] 和 [Material/@Id] 的组合。

XML 数据保存在 Air_Calc_Log 表的 Verbose_Xml CLOB 字段中。

在我的 PL/SQL 中，我（错误？）使用以下选择：

```
 SELECT 
  XMLType(l.verbose_xml).extract(
  'for $scen in  /Calculation/ProcessUnitModelScenario
  where ($scen/@ScenarioId="10053")
  return $scen/* ')
      FROM air_calc_log l
   WHERE l.vld_site_id = 10030 -- pVldSite
       AND l.start_date = To_Date('01/01/2012','mm/dd/yyyy')  -- pStartDate
       AND  l.End_Date = To_Date('04/01/2012','mm/dd/yyyy') 
```

无论我使用 FLOWR 语法的 XQuery/XPath 组合，我总是收到以下错误消息：

```
ORA-31011: XML parsing failed
ORA-19202: Error occurred in XML processing
LPX-00601: Invalid token in: 'for $scen in  /Calculation/ProcessUnitModelScenario
  where ($scen/@ScenarioId="10053")
  return $scen/* '
ORA-06512: at "SYS.XMLTYPE", line 111 
```

有人可以帮助指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:52:47.167

试试这样：

```
SELECT 
  XMLType(l.verbose_xml).extract(
  '/Calculation/ProcessUnitModelScenario[@ScenarioId="10053"]')
      FROM air_calc_log l
WHERE l.vld_site_id = 10030 -- pVldSite
       AND l.start_date = To_Date('01/01/2012','mm/dd/yyyy')  -- pStartDate
       AND  l.End_Date = To_Date('04/01/2012','mm/dd/yyyy') 
```

[这](http://www.sqlfiddle.com/#!4/78301/5)是一个小提琴（请注意，我必须更改您的 XML 才能做到`well-formed`）

# javascript - Javascript：显示多个条件语句

> ID：13147096
> 
> 赞同：0
> 
> 时间：2012-10-30T20:28:09.043
> 
> 标签：javascript, html, forms, if-statement

我正在制作一个表单，询问三个不相关的问题，这些问题在单击提交按钮后显示文本。

所有三个问题都包含一个 if-else 语句；两个问题是文本输入，一个是选择框，然后是提交按钮。

我可以显示表单，但是当我输入数据并提交数据时，会返回一个空白表单而不是我想要的文本（我不是要显示“警报”消息）。

这是我到目前为止所拥有的：

```
<!DOCTYPE HTML>
<html>
  <head>
  <title>Questions</title>

    <script type="text/javascript"> 

      function questions()
    {
    var hours, age, timeday;
    hours = document.form1.workhours.value;
    hours = pasrseInt(hours);
    age = document.form1.years.value;
    age = parseInt(age);
    timeday = document.form1.dayofweek.value;
    }

        if (hours >= 40)
        {
            document.write("Wow, what a hard worker!<br>");
        }
        else
        {
            document.write("Better work harder!<br>");
        }
        if (  age >= 65)
        {
            document.write("You are Eligible for retirement benefits<br>");
        }
        else
        {
            document.write("Sorry, no benefits yet.<br>");
        }
        if (day == "Sunday");
        {
            document.write("No need to pay the meter!<br>");
        }
        else
        {
            document.write("Better get some quarters!<br>");
        }

</script>
</head>
<body>
<form name="form1">
    How many hours have you worked? <input type="text" name="workhours"><br>
    How old are you? <input type="text" name="years"><br>
    What day is it today? 

    <select name="dayofweek">
    <option value="???">-Select a Day-</option>
    <option value="Sunday">Sunday</option>
    <option value="Monday">Monday</option>
    <option value="Tuesday">Tuesday</option>
    <option value="Wednesday">Wednesday</option>
    <option value="Thursday">Thursday</option>
    <option value="Friday">Friday</option>
    <option value="Saturday">Saturday</option>
    </select></br>
<p>
</p>
    <input type="submit" value="Submit" onClick="questions()">
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:32:26.340

您遇到的问题是您没有取消表单提交，因此页面正在刷新。将 return false 添加到 onclick。

```
<input type="submit" value="Submit" onClick="questions(); return false;"> 
```

在页面加载后使用 document.write 替换页面内容。您应该使用 innerHTML 向页面添加文本。

# c# - Windows 窗体无法正确关闭

> ID：13147098
> 
> 赞同：0
> 
> 时间：2012-10-30T20:28:15.613
> 
> 标签：c#, winforms, refactoring, add-in

我正在为 Outlook 2010 开发一个加载项。
基本上，我的功能区上有一个按钮，用于获取选定的电子邮件，并将其保存到文本文件中。如果电子邮件包含某个主题，则会自动保存到硬编码文件路径。如果没有，则会打开一个 Windows 窗体，要求用户输入文件路径。

当用户选择了一条路径并单击“确定”时，将进行保存，然后表单关闭......但随后它重新打开......它似乎正在创建它的新实例或其他东西......如果我单击“取消”或“X”它会关闭，但我不明白为什么它第一次没有正确关闭。

下面是我的代码

```
//This is myRibbon.cs
private void btn_SaveFile_Click(object sender, RibbonControlEventArgs e) 
{
   //other code
   if (subject = "xyz") 
   {
      //other code
      textFile.Save();
   }
   else
   {
      MyPopup popup = new MyPopup();
      popup.ShowDialog();
   }
}

//This is MyPopup.cs
private void btnOK_Click(object sender, EventArgs e) 
{
   var filePath = txtFilePath.Text;
   if (!string.IsNullOrWhiteSpace(filePath)) 
   { 
       SaveEmailToText(filePath); 
      this.Close(); 
   }
   else 
   { //show message box with error }
   this.Close(); 
}

private static void SaveEmailToText(string filePath) 
{
    //other code
    textFile.Save();
} 
```

我已经简化了很多，所以它更容易阅读。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:07:04.743

*   考虑使用`OpenFileDialog`而不是您的弹出表单
*   仅使用您的弹出窗口（或文件对话框）来获取文件名
*   将电子邮件保存代码保存在一个地方（否则您将有重复的代码）
*   `DialogResult`在进一步处理之前验证对话形式
*   表格是一次性的 -`using`声明将自动处理它们
*   不要关闭对话框表单 -`DialogResult`改为设置它的属性

这是重构的代码：

```
private void btn_SaveFile_Click(object sender, RibbonControlEventArgs e) 
{
   string filePath = defaultPath;

   if (subject != "xyz") 
   {
      using(MyPopup popup = new MyPopup())
      {
         // user can close popup - handle this case
         if (popup.ShowDialog() != DialogResult.OK)
             return;
         filePath = popup.FilePath;
      }
   }       

   SaveEmailToText(filePath);
}

private void SaveEmailToText(string filePath) 
{
   //other code
   textFile.Save();
} 
```

还有你的弹出窗口，应该替换为`OpenFileDialog`：

```
private void btnOK_Click(object sender, EventArgs e) 
{
    if (string.IsNullOrWhiteSpace(FilePath))
    { 
        //show message box with error
        DialogResult = DialogResult.Cancel;
        return;
    }

    // you can assign default dialog result to btnOK in designer
    DialogResult = DialogResult.OK;
}

public string FilePath
{
    get { return txtFilePath.Text; }
} 
```

# jvectormap - 为 jvectormap 区域颜色创建比例键

> ID：13147104
> 
> 赞同：1
> 
> 时间：2012-10-30T20:28:42.783
> 
> 标签：jvectormap

我想为我的地图创建一个键，显示与不同颜色相关的值，如图底部所示：

![在此处输入图像描述](../Images/b76b44829380598186bf9814778bf895.png)

我可以很容易地制作一系列盒子。有没有一种方法可以在某处输入一个值来获取地图将用于该值的颜色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:56:37.337

首先你需要一个地图对象。如果您已经使用`jvm.WorldMap`构造函数创建了一个地图，那么您已经拥有它，否则如果您使用 jQuery 包装器创建了一个地图，您可以执行以下操作：

```
var map = $('#map').vectorMap('get', 'mapObject'); 
```

然后要将值转换为颜色，请执行以下操作：

```
var color = map.series.regions[0].scale.getValue(someValue); 
```

# thrift - Apache Thrift 使检查卡住

> ID：13147105
> 
> 赞同：2
> 
> 时间：2012-10-30T20:28:51.303
> 
> 标签：thrift

我正在尝试安装 Apache Thrift。期间`make`我收到一条消息：

> 尝试在启用 C 扩展的情况下进行编译时发生错误。现在尝试在没有扩展的情况下构建

但在那之后，它确实完成了构建而没有出现错误。

然后我跑了`make check`。测试似乎卡住了重复的消息：

> 超时警报过期；试图解除交通阻塞

我在 Ubuntu 上运行它，没什么特别的，但我找不到任何关于它的文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T10:30:31.793

这不是一个完整的回复，但你应该知道我昨天在 Linux Mint 上构建和运行测试时得到了同样的结果，但我取消了并且一直在使用 Thrift。我认为这是一个小问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-01T02:01:53.743

我得到了同样的信息。但正如您在下面看到的，检查测试在多次退休后继续进行。只需要给它某个时间:-)

```
*** No errors detected
PASS: AllProtocolsTest
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport
Timeout alarm expired; attempting to unblock transport

*** No errors detected
PASS: TransportTest 
```

# java - 根据关键字将一组字符串复制到局部变量

> ID：13147106
> 
> 赞同：0
> 
> 时间：2012-10-30T20:28:52.520
> 
> 标签：java, image, href

我需要从一组文本信息中提取 http 链接。具有图像扩展名的特定短语（.jpg，.png）

比如我要一个人“ [http://www.mywedding.com/blog/wp-content/gallery/p_867/bridal-party-white-flowers-40306.jpg](http://www.mywedding.com/blog/wp-content/gallery/p_867/bridal-party-white-flowers-40306.jpg) ”

从下面的一组东西

```
 <p><a href="http://www.mywedding.com/blog/wp-content/gallery/p_867/bridal-party-white-flowers-40306.jpg" target="_blank"><a href="http://www.mywedding.com/blog/wp-content/gallery/p_867/bridal-party-white-flowers-40306.jpg">http://www.mywedding.com/blog/wp-content/gallery/p_867/bridal-party-white-flowers-40306.jpg</a></a> (from <a href="http://cameroningalls.com/emily-meeko-tiburon/" target="_blank">this wedding by Cameron Ingalls</a>)</p> 
```

如果这些是 img 标签，我可以从简单的方法中得到它

```
String s="<img src="https://i.stack.imgur.com/SUSRH.jpg"/> 

s=s.replace("<img src=", "");
s=s.replace("/>", ""); 
```

但是我很困惑第一个场景，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:51:03.820

你可以使用正则表达式来匹配它。

(https?://)?([\da-z.-]+).([az.]{2,6})([/\w .-] *)*

如果您需要知道如何使用它并了解正则表达式，请使用提供的链接 darkpbj。很强大的东西。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:34:11.800

您是否已经在单个字符串中拥有原始信息？这看起来像是正则表达式的经典工作。我会检查这个网站，

9：HTML标签正则表达式模式 [http://www.mkyong.com/regular-expressions/10-java-regular-expression-examples-you-should-know/](http://www.mkyong.com/regular-expressions/10-java-regular-expression-examples-you-should-know/)

这里有一个很好的解释如何使用它： [http ://www.mkyong.com/regular-expressions/how-to-extract-html-links-with-regular-expression/](http://www.mkyong.com/regular-expressions/how-to-extract-html-links-with-regular-expression/)

# ruby-on-rails - 所有带有 Ruby on Rails 应用程序的 Windows 浏览器上的 Typekit 和 @fontface 问题，尤其是 Chrome

> ID：13147107
> 
> 赞同：33
> 
> 时间：2012-10-30T20:28:58.273
> 
> 标签：ruby-on-rails, windows, google-chrome, font-face

我的 Ruby on Rails 应用讨厌自定义字体，我不知道为什么。以下是我经历的一些错误和故障排除。

首先，只有在 PC 上的 Google Chrome 上才会出现毁灭性的显示错误。文本将重叠，同一 div 中的段落将具有不同的宽度，按钮将具有缩短的宽度，副本将在页面上向右移动......到某些站点无法使用的地步。我终于发现浏览器似乎没有正确理解字体。如果我使用像 Arial 和 Georgia 这样的网络安全字体，问题就会消失。所以我想我服务器上的@font-face 字体可能已经损坏了。Chrome 问题似乎也只发生在更高版本的 Chrome（20 及更高版本）上。关于这一点最奇怪的部分是它只是*间歇性地发生*. 有时页面显示正常，有时看起来很疯狂。这已在多台计算机上发生，并且缓存清除似乎不会影响该错误。

然后，我集成了 Adob​​e 的 Typekit，而不是从他们的服务器提供字体。现在显示错误消失了，但所有 Windows 浏览器都会忽略 typekit 字体并显示备用字体。那就是 Windows 上的 IE、Firefox 和 Chrome，各种版本。

该站点部分是 Ruby on Rails，部分是 PHP (WordPress)，这些问题只发生在 Ruby on Rails 页面上。我认为损坏的字体文件与在网站的 PHP 端运行良好的字体文件相同。

以下是服务器托管字体的初始 Chrome 问题的一些屏幕截图。

该站点当前拥有服务器托管的字体（带有 Chrome 错误）。发生这种情况的网站页面：http: [//levoleague.com/jobs](http://levoleague.com/jobs)

关于为什么我的应用拒绝字体的任何想法？

![超出页面的段落](../Images/b00886858301bf5f1055f57d2dce4a3d.png)

![文字重叠](../Images/ea9de113ffd4fa082bf22ffbe86751e0.png)

![Tds 重叠](../Images/8624c7a2ce94721b4d5492f9a0815837.png)

![下拉列表中的废话字符](../Images/e651de92ae0948878aad435ac2706c69.png)

# java - 十进制到八进制转换

> ID：13147109
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:29:02.850
> 
> 标签：java, decimal, octal

> **可能重复：**
> [十进制转换错误](https://stackoverflow.com/questions/13142977/decimal-conversion-error)

我正在为一个班级编写一个程序，并且无法弄清楚如何将八进制数转换为十进制数。到目前为止，这是我一直在尝试做的事情：

```
 import java.util.Scanner;

public class test   
{ 
public static void main ( String args[])
{
    Scanner input = new Scanner(System.in);

    System.out.print("Enter number: ");
    int oct  = input.nextInt();
    int d2count = 0;
    int result=0;
    int d3count = 0;
    int d3 = 0;
    int d2 = 0;

    d3 = oct;
    d2 = oct;

    if(oct < 1000){
    while ( d3 >= 100){
    d3 = d3 - 100;
        d3count++;
    }}

    if (oct < 100){
    while ( d2 >= 10){
    d2 = d2 - 10;
        d2count++;
    }}

    result = (d3count * 64)+(d2count * 8) + d2;
System.out.printf("%d\n",result);
}
} 
```

所以基本上我需要一种方法将数字减少到个位数（即 1337 到 1、3、3、7）。我真的很想用我现在拥有的东西来做，但是我的做事方式似乎有一些我看不到的错误。如果我输入一个小于 100 的数字，它实际上可以工作，但是当我输入一个大于 100 的数字时，转换会在某处搞砸。我是java新手，所以技术越基础越好，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:35:37.057

以下将十进制转换为八进制，

导入 java.util.Scanner；

```
public class test { 
    public static void main ( String args[]) {
        Scanner input = new Scanner(System.in);
        System.out.print("Enter number: ");
        int oct  = input.nextInt();
        String result= Integer.toString(oct,8);
        System.out.println(result);
    }
} 
```

以下将八进制转换为十进制，

```
public static void main ( String args[]) {
     Scanner input = new Scanner(System.in);
     System.out.print("Enter number: ");
     String oct  = input.next();
     int result= Integer.parseInt(oct,8);
     System.out.println(result);
 } 
```

以下是从八进制转换为十进制的更算法的方式，

```
 public static int convert(String oct) {
         int i= 0;  
         for(int j = 0; j < oct.length(); j++) { 
                char num = oct.charAt(j);           
                num -= '0';     
                if(num<0||num>7) {          
                    sysout("invalid number");
                    return -1;
                }
                i *= 8;                          
                i += num;                      
            }
            return i;
        }
     } 
```

以下是用于将十进制转换为八进制，

```
public static int convert(int OctalNumber){
   int counter=0;
   int result = 0;
   while(OctalNumber !=0) {
        int temp = (int) ((OctalNumber%8) * Math.pow(10, counter));
        counter++;
        result += temp;
        OctalNumber /= 8;
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:41:11.723

首先，您的代码将八进制转换为十进制。

其次，你有

```
if(oct < 1000){ 
```

和

```
if (oct < 100){ 
```

但是您没有`if`声明来处理输入数字大于 1000 的情况。

编辑：我刚刚意识到这真的不是问题。当您开始计算 d2 时，您需要在减去 100 多次后使用 d3的*最终值。*所以在第二个之前，如果你需要一个

```
d2 = d3; 
```

不过，您仍然需要处理大于 1000 的输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T20:44:11.383

使用班次功能。而不是使用 <1000 等。

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T20:57:46.547

您可以使用一些更好的算法，该算法允许任何合理长度的十进制数（即不会导致溢出）：

```
public int octalToDecimal(int octal)
{         
   int numDigits = Integer.toString(octal).length();
   int decimalResult = 0;
   int mask = 0x00000007;
   for(int i = 0; i < numDigits; i++)
   {
      int octalDigit = octal & mask;
      octal = octal >> 3;    
      decimalResult += octalDigit * Math.pow(8, i);
   }

   return decimalResult;
} 
```

# php - 每个 API 的 PHP cUrl 速率限制

> ID：13147110
> 
> 赞同：1
> 
> 时间：2012-10-30T20:29:05.247
> 
> 标签：php, api, curl, limit, throttling

我正在开发各种流行 API 的 PHP 混搭，并希望实现速率限制以确保我玩​​得很好。

我做了一些研究并查看了 CURLOPT_MAXCONNECTS 和 CURLOPT_TIMEOUT 但我对它们的功能有些困惑。

据我了解，可能是错误的：

```
CURLOPT_MAXCONNECTS
---
  Each script that calls a cUrl request opens a connection.  
  When the MAXCONNECTS limit is reached, then the server delays the request.

CURLOPT_TIMEOUT
---
  The amount of time that the server will wait to make a connection.  
  Working with MAXCONNECTS, does that mean that cUrl will make the listed 
  number of connections and then wait up to TIMEOUT for an open thread? 
```

所以——显然，我对 cUrl 如何使用这些参数实际运行感到非常困惑。我正在开发的应用程序需要针对我正在调用的每个 API 将 cUrl 请求限制在不同的限制。据我了解，cUrl 选项是服务器范围的吗？是否有某种方法可以将令牌附加到特定的 cUrl 调用并以这种方式应用每个 API 的限制？我需要使用一些全局/共享内存魔法吗？

你真的很困惑，萨曼莎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:31:01.523

CURLOPT_MAXCONNECTS 只是同时请求的最大数量。CURLOPT_TIMEOUT 是在没有应答的情况下 cURL 在中止请求之前等待的时间。

您必须手动限制您的工作

# mysql - MySQL将多个（变量）行组合成一行，多列

> ID：13147111
> 
> 赞同：0
> 
> 时间：2012-10-30T20:29:13.110
> 
> 标签：mysql

我正在寻找一个查询，它会将我的几行返回到列中，但事先不知道行数。我已经搜索过，我发现的唯一解决方案涉及知道有多少行。

这是一个示例表：

```
parentID    colA       colB
2           aaaaaa     1000.00
2           bbbbbb     1500.00
3           cccccc     500.00
3           dddddd     700.00
3           eeeeee     2000.00 
```

我需要它看起来像：

```
parentID    colA(n)      colB(n)     colA(n+1)     colB(n+1)     colA(n+2)     colB(n+2)
2           aaaaaaa      1000.00     bbbbbb        1500.00       NULL          NULL
3           cccccc       500.00      dddddd        700.00        eeeeee        2000.00 
```

我意识到这应该在 PHP 中完成，但我需要它在 mysql 中用于我正在使用的第三方 excel 导出器插件。

编辑：如果我知道我需要的最大列数，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:38:28.457

在不知道列数的情况下，您无法在 SQL 中进行查询。

SELECT 列表的列必须在解析查询时固定。您要求的是数据的状态（在查询执行之前不知道）决定了列数。这不是 SQL 的工作方式。

要完成数据透视类型的操作或数据确定列的任何查询，您有两种选择：

*   执行预备查询以发现您想要获取多少不同的组，并使用它来构建具有匹配数量的列的查询。

*   查询行中的所有数据，将其取回您的应用程序，然后在代码中的数据结构（即数组）中完全转换结果集。

无论哪种方式，您都需要在获取数据之前或之后编写应用程序代码。

* * *

回复您的评论：您是对的，这不是传统的支点，但相似之处在于数据驱动列数。也就是说，您需要的列数是最大组中行数的 2 倍。但它们不会全部被填满，因为每组的行数各不相同。您没有每组固定数量的行，因此您不能填充每组固定数量的列。

我真的建议您使用后一种策略：将数据作为行获取，因为它们存储在数据库中。然后在您的应用程序代码中对其进行后处理。当您从数据库中获取行时，循环遍历结果集并逐步构建您的数据结构。

例如，在 PHP 中：

```
while ($row = $stmt->fetch()) {
  $data[$row['parentID']][] = $row['colA'];
  $data[$row['parentID']][] = $row['colB'];
} 
```

# string - 如何比较序言中的字符串

> ID：13147112
> 
> 赞同：0
> 
> 时间：2012-10-30T20:29:31.087
> 
> 标签：string, prolog, swi-prolog

我想在序言中编写一个比较两个字符串或字符串列表的程序。我想实现以下目标：

```
if StringList A == StringList B
   {
     do this
   }
else
   do something else 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:50:39.220

你是什​​么意思`do this`？在 Prolog 中很难实现`doing somewhat`，因为你所拥有的只是事实和谓词。

```
?- (string1 = string2, X=1); (string1 \= string2, X=2).
X = 2. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:47:48.457

以下是您如何在一行中执行此操作：

```
...
(A = B -> do this ; do something else)
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-04T09:16:29.493

```
 /*SWI prolog code*/
string1(progga).
string2(ikra).

go:-
write("Enter your name"),
nl,
read(X),nl,
string1(Y),
X=@=Y,nl, write("Matched");
write("not Matched"),go2.

/*Another way to*/
go2:-                
string1(A),
string2(B),
A=@=B,nl, write("Matched");
write("not Matched"). 
```

# java - 使用 javax.servlet 2.5 设置 httponly cookie

> ID：13147113
> 
> 赞同：23
> 
> 时间：2012-10-30T20:29:52.520
> 
> 标签：java, cookies, cookie-httponly, servlet-2.5

这是一个设置 cookie 的函数：

```
public void addCookie(String cookieName, String cookieValue, Integer maxAge, HttpServletResponse response) {
    Cookie cookie = new Cookie(cookieName, cookieValue);
    cookie.setPath("/mycampaigns");
    cookie.setSecure(isSecureCookie);
    cookie.setMaxAge(maxAge);
    response.addCookie(cookie);
} 
```

我相信 servlet 3.0，有办法直接做到这一点。不幸的是，我的组织使用 2.5，此时升级不是一种选择。

有没有办法使用响应来设置cookie？这是我在网上找到的一个例子

```
response.setHeader("SET-COOKIE", "[SOME STUFF]" +"; HttpOnly") 
```

如果这是做我想做的唯一方法，我会用什么替换“[SOME STUFF]”，这样我就不会丢失我的函数当前存储在 cookie 中的任何数据？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-21T02:51:56.753

你是对的，手动设置标题是实现目标的正确方法。

您还可以使用 javax.ws.rs.core.NewCookie 或任何其他具有有用 toString 方法的类将 cookie 打印到标头以使事情更简单。

```
public static String getHttpOnlyCookieHeader(Cookie cookie) {

    NewCookie newCookie = new NewCookie(cookie.getName(), cookie.getValue(), 
            cookie.getPath(), cookie.getDomain(), cookie.getVersion(), 
            cookie.getComment(), cookie.getMaxAge(), cookie.getSecure());

    return newCookie + "; HttpOnly";
} 
```

以及用法：

```
response.setHeader("SET-COOKIE", getHttpOnlyCookieHeader(myOriginalCookie)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-05T14:26:24.353

此代码无需使用即可工作`response.setHeader()`：

```
public void addCookie(String cookieName, String cookieValue, Integer maxAge, HttpServletResponse response) {  
    Cookie cookie = new Cookie(cookieName, cookieValue);
    cookie.setPath("; HttpOnly;");
    cookie.setSecure(isSecureCookie);
    cookie.setMaxAge(maxAge);
    response.addCookie(cookie);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-27T16:42:39.173

对于 JEE 6 之前的 Java Enterprise Edition 版本，比如 Servlet 2.5，您可以在 OWASP 上找到解决[方法](https://www.owasp.org/index.php/HttpOnly#Using_Java_to_Set_HttpOnly)。下面是一个例子：

```
 /**
     * Issue a cookie to the browser
     * 
     * @param response
     * @param cookieName
     * @param cookieValue
     * @param cookiePath
     * @param maxAgeInSeconds
     */
    public static void issueCookieHttpOnly(HttpServletResponse response, 
            String cookieName, 
            String cookieValue, 
            String cookiePath, 
            long maxAgeInSeconds) {

        Date expireDate= new Date();
        expireDate.setTime (expireDate.getTime() + (1000 * maxAgeInSeconds));
        // The following pattern does not work for IE.
        // DateFormat df = new SimpleDateFormat("dd MMM yyyy kk:mm:ss z");

        // This pattern works for Firefox, Chrome, Safari and Opera, as well as IE.
        DateFormat df = new SimpleDateFormat("EEE, dd-MMM-yyyy kk:mm:ss z");
        df.setTimeZone(TimeZone.getTimeZone("GMT"));
        String cookieExpire = df.format(expireDate);

        StringBuilder sb = new StringBuilder(cookieName);
        sb.append("=");
        sb.append(cookieValue);
        sb.append(";expires=");
        sb.append(cookieExpire);
        sb.append(";path=");
        sb.append(cookiePath);
        sb.append(";HttpOnly");

        response.setHeader("SET-COOKIE", sb.toString());
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-25T15:17:29.640

如果您不想使用：

```
response.addHeader("Set-Cookie","name=value; HttpOnly"); 
```

*那么您可以在servlet 2.5*中使用以下代码。它将在*chrome*、*firefox*和*IE11*中完美运行。

```
Cookie cookie = new Cookie(cookieName, cookieValue);

cookie.setPath(";Path=/;HttpOnly;");
cookie.setSecure(isSecureCookie);
cookie.setMaxAge(maxAge);

response.addCookie(cookie); 
```

*注意：如您所知，我们在**servlet 2.5*版本中没有`setHttpOnly()`方法，因此您可以使用以下方法代替：

 *```
setPath(";Path=/;HttpOnly;"); 
```

它将使用路径“ */* ”创建一个 cookie，并将*Cookie*设置为*HttpOnly*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-01-18T16:24:34.673

对于 Servlet API 2.5，您可以使用

```
response.addHeader("Set-Cookie","name=value; HttpOnly"); 
```

使用 response.setHeader() 时要小心，因为它会删除所有其他 cookie，例如 JSESSIONID cookie。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-18T06:46:18.613

如果您不想硬编码`HttpOnly;`或不喜欢添加标头，请像这样使用[apache shiro](https://shiro.apache.org/)：

```
void addCookie(javax.servlet.http.Cookie httpCookie,
               HttpServletRequest request,
               HttpServletResponse response) {
    org.apache.shiro.web.servlet.Cookie cookie =
                 new org.apache.shiro.web.servlet.SimpleCookie(httpCookie.getName());

    cookie.setValue(httpCookie.getValue());
    cookie.setPath(httpCookie.getPath());
    // set other stuff from the original httpCookie
    cookie.setHttpOnly(true);

    cookie.saveTo(request, response);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-03T09:57:38.933

Spring 使用反射来做到这一点，而不会破坏 servlet 2.5 容器。

```
Method setHttpOnlyMethod = ReflectionUtils.findMethod(Cookie.class, "setHttpOnly", boolean.class);
if (setHttpOnlyMethod != null) {
    ReflectionUtils.invokeMethod(setHttpOnlyMethod, cookie, Boolean.TRUE);      
} 
```

但是 setHttpOnly 方法仅适用于 Servlet 3.0 及更高版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-26T08:58:55.900

@Yuci 给响应头添加cookie的例子在我的环境中有一些失败。主要是日期格式错误，如果您`addHeader`不删除其他 cookie，如`setHeader`. 所以这是我使用 Servlet API 2.5 设置`HttpOnly`和`Secure`cookie 的工作代码：

```
public static void addHttpOnlyCookie(HttpServletResponse response,
                                     String cookieName,
                                     String cookieValue,
                                     String cookiePath,
                                     long maxAgeInSeconds) {

    Date expireDate = new Date();
    expireDate.setTime(expireDate.getTime() + 1000L * maxAgeInSeconds);
    DateFormat df = new SimpleDateFormat("EEE, dd-MMM-yyyy HH:mm:ss z", Locale.ENGLISH);
    df.setTimeZone(TimeZone.getTimeZone("GMT"));
    String cookieExpire = df.format(expireDate);

    StringBuilder sb = new StringBuilder(cookieName);
    sb.append("=");
    sb.append(cookieValue);
    sb.append("; Expires=");
    sb.append(cookieExpire);
    sb.append("; Path=");
    sb.append(cookiePath);
    sb.append("; Secure; HttpOnly");

    response.addHeader("SET-COOKIE", sb.toString());
} 
```

请注意，这些`setPath`黑客绝对**行不通**。不要这样做，它们不适用于 Safari `cookie.setPath(";HttpOnly;");`：. <= 错误

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-02-09T09:09:37.423

```
Cookie cookie = new Cookie("JSESSIONID", session.getId());
cookie.setPath("/");
cookie.setMaxAge(-1);
response.addCookie(cookie); 
```

实际上在我的情况下，这段代码不能完全正常工作。
路径值不是`"/"`

但是添加这个`cookie.setComment("; HttpOnly;");`效果很好！*

# r - 用简单漂亮的代码在绘图中插入公式

> ID：13147116
> 
> 赞同：2
> 
> 时间：2012-10-30T20:30:01.733
> 
> 标签：r, symbols

Gnu R 提供了一种非常奇怪的方式来记录公式和符号。它经常[在此处讨论](https://stackoverflow.com/a/5294214/1749675)并在 R 帮助页面中提及`?plotmath`。对于曾经`LaTeX`在 R 中编写过简单公式代码的人来说，这些代码看起来不可读并且容易出错。

有没有更好的方法来用公式进行注释？有没有这样的函数`tex2r("x_2")`会生成奇怪的代码？

## 编辑：

我正在寻找没有 TikZdevice 的解决方案，因为 TikZdevice 仍然非常脆弱，打印输出看起来并不完全相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T20:45:54.283

使用[**tikzDevice**包](http://cran.r-project.org/web/packages/tikzDevice/index.html)（目前只能从 CRAN 档案中获得），您可以使用直接的 LaTeX 标记来注释您的绘图。（该包装带有一个漂亮的小插图，可以让您启动并运行）。

下面的示例直接[来自此页面](http://www.texample.net/tikz/examples/tikzdevice-demo/)，该页面还显示了它生成的图形：

```
require(tikzDevice)

tikz('normal.tex', standAlone = TRUE, width=5, height=5)

# Normal distribution curve
x <- seq(-4.5,4.5,length.out=100)
y <- dnorm(x)

# Integration points
xi <- seq(-2,2,length.out=30)
yi <- dnorm(xi)

# plot the curve
plot(x,y,type='l',col='blue',ylab='$p(x)$',xlab='$x$')
# plot the panels
lines(xi,yi,type='s')
lines(range(xi),c(0,0))
lines(xi,yi,type='h')

#Add some equations as labels
title(main="$p(x)=\\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}$")
int <- integrate(dnorm,min(xi),max(xi),subdivisions=length(xi))
text(2.8, 0.3, paste("\\small$\\displaystyle\\int_{", min(xi),
    "}^{", max(xi), "}p(x)dx\\approx", round(int[['value']],3),
    '$', sep=''))

#Close the device
dev.off()

# Compile the tex file
tools::texi2dvi('normal.tex',pdf=T) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-18T20:06:50.027

我刚刚找到了一个完全符合 OP 要求的包：`latex2exp`并且在里面有`TeX`.

例如：

```
library(latex2exp)
library(berryFunctions)
set.seed(1)
milk <- data.frame(Datum = as.Date(rep(seq(17500, 18460, by = 30), each = 30), origin = "1970-01-01"),
                   Milch = abs(rnorm(990, mean = 20, sd = 8)))
X11(width = 12, height = 7)
par(mar = c(3,5.5,3,1))
with(milk, plot(Datum, Milch, pch = "-", cex=1.5, col = rgb(red = 0, green = 0.5, blue = 0.5, alpha = 0.7),
                xaxt = "n", xlab = "", ylab = "",
                main = "Milchleistung am Wolkenhof"))
title(ylab = TeX("Milchmenge $\\,$ $\\left[\\frac{\\mathrm{kg}}{\\mathrm{Kuh} \\cdot \\mathrm{Tag}}\\right]$"), line = 2.5)
monthAxis() 
```

产量：

[![生乳](../Images/56da0135993593d5b532ae85b0eec11f.png)](https://i.stack.imgur.com/3DxRb.jpg) **编辑：**现在“Milchmenge”和左括号“[”之间有一个空格，但我不想因此上传新图片。

# java - 从 onclicklistener 访问变量

> ID：13147120
> 
> 赞同：2
> 
> 时间：2012-10-30T20:30:09.737
> 
> 标签：java, android

所以我有一个用于获取传入参数“int position”的列表视图的onItemLongClickListener。在里面，我有一个alertDialogBu​​ilder，它有两个按钮。我有另一个用于按钮的 onclickListener。我需要从第二个侦听器内部访问该位置。有没有办法做到这一点而不使其成为全球性的？

```
 public boolean onItemLongClick(AdapterView parent, View itemView, int position, long id){

    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(BookFace.this);
    alertDialogBuilder.setTitle("Choose an option.");
    alertDialogBuilder
    .setMessage("What would you like to do?")
    .setCancelable(true)
    .setPositiveButton("Edit", new DialogInterface.OnClickListener(){

        @Override
        public void onClick(DialogInterface dialog, int which) {
            Intent intent = new Intent();
            intent.putExtra("position", position); //Can't access this variable
            intent.setClass(SomeClass.this, EditActivity.class);
            startActivity(intent);
    } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:33:33.347

如果您将位置更改为最终位置，那么它应该允许您从 onClick 方法中访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:32:20.407

在 Java 中，只有首先将外部变量声明为`final`. 所以你可以添加：

```
final int selectedPosition = position; 
```

到你的方法的顶部并在你的额外中使用该值，即

```
intent.putExtra("position", selectedPosition); 
```

# objective-c - NSBundle pathForResource 不起作用

> ID：13147124
> 
> 赞同：2
> 
> 时间：2012-10-30T20:30:23.647
> 
> 标签：objective-c, ios, nsbundle

在 iOS 6 上，这段代码可以正常工作：

```
- (NSString*)cLocalImageName
{
     [self willAccessValueForKey:@"cLocalImageName"];
     NSString*pathToImage;
     if ([self.cIsUserCreated boolValue]) {
         pathToImage =  [self primitiveValueForKey:@"cLocalImageName"];
     }else{
         pathToImage = [[NSBundle mainBundle] pathForResource:[self primitiveValueForKey:@"cLocalImageName"] ofType:@".png"];
     }
     [self didAccessValueForKey:@"cLocalImageName"];
     return pathToImage;
} 
```

即这一行总是返回正确的文件路径：

```
 pathToImage = [[NSBundle mainBundle] pathForResource:[self primitiveValueForKey:@"cLocalImageName"] ofType:@".png"]; 
```

但是，在 iOS 5 上，该行总是返回 nil，而我必须调用：

```
 pathToImage = [[[NSBundle mainBundle] bundlePath] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.png",[self primitiveValueForKey:@"cLocalImageName"]]]; 
```

谁能告诉我为什么这是 iOS 5 上的问题？

我已经排除的事情：

• [self primitiveValueForKey:@"cLocalImageName"] 没有返回零。

• 构建应用程序后，.png 对象实际上存在于已编译的.app 包中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-30T21:15:42.550

这行不应该：

```
pathToImage = [[NSBundle mainBundle] pathForResource:[self primitiveValueForKey:@"cLocalImageName"] ofType:@".png"]; 
```

是这样的：

```
pathToImage = [[NSBundle mainBundle] pathForResource:[self primitiveValueForKey:@"cLocalImageName"] ofType:@"png"]; 
```

?

# javascript - FIrefox 16.0.2 错误：TypeError：父级未定义

> ID：13147128
> 
> 赞同：0
> 
> 时间：2012-10-30T20:30:37.387
> 
> 标签：javascript, firefox, fckeditor

我在我的网站上有这个功能，我得到了错误错误：TypeError：父未定义

有没有另一种方法来定位父框架这工作正常，直到升级

```
function MyClass() {
    this.UpdateEditorFormValue = function()  {
        for ( i = 0; i < parent.frames.length; ++i )
            if ( parent.frames[i].FCK )
                parent.frames[i].FCK.UpdateLinkedField();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:56:39.340

不应该`window.parent`吗？只是`parent`会寻找一个名为 的变量`parent`，而不是父框架。

# php - mysql搜索引擎

> ID：13147129
> 
> 赞同：0
> 
> 时间：2012-10-30T20:30:49.943
> 
> 标签：php, mysql, search, database-design

我需要您的意见...我正在 PHP 和 MYSQL（AZURE 环境）中开发应用程序。我在 MYSQL 中为该应用程序编写了一个搜索引擎。搜索引擎应该索引页面。每个页面都被“拆分”为单词，并且为每个单词创建一个包含该单词出现的所有地址的表。

例如，如果客户端查找单词“tablet”，应用程序会访问一个名为“tablet”的表，并将提取表中的所有地址。如果您正在搜索这两个词，则检索两个相关表的所有地址并执行切割每个地址。

问题是至少 10 000 个单词，即 10 000 个表。DATABASE中是否存在大量表的问题？使用微软的云服务器（AZURE）是否改善了这种情况？DATABASE 是在写入分配云中的表还是只是让它们和云处理这个并为我安排它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:56:17.640

您正在做的是复制倒排索引模式已经做的事情。您应该查看 Lucene (java) 或 lucene.net (.net) 以获得非常成熟的索引实现，它是开源的。

正如上面提到的，每个单词都有一个表格（在 lucene 中称为一个术语）是不可扩展的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:00:59.070

您应该考虑为您进行索引的解决方案。Apache Lucene 就是其中之一[http://lucene.apache.org/core/](http://lucene.apache.org/core/)如果您使用的是 PHP，也有这种语言的实现（framework.zend.com）

我还建议使用 Sphinx Search [http://sphinxsearch.com](http://sphinxsearch.com)。这是一个很棒的工具，可以为你做索引。它将索引数据库中的数据，并提供一个可以在 ANSI SQL 中查询的接口。

# c# - .Net 4.5 中的 Active Directory 组成员资格检查

> ID：13147132
> 
> 赞同：7
> 
> 时间：2012-10-30T20:30:56.473
> 
> 标签：c#, .net, asp.net-mvc, security, active-directory

我有一个使用 Windows 身份验证的 ASP.Net MVC 应用程序，并且我正在检查组成员身份以了解控制器操作的安全性。

听起来很简单，但我发现没有其他问题可以解决我遇到的问题。

### 第一次尝试：[授权]

经典的方法是简单地`Authorize`在控制器动作上打一个数据注释属性然后去城里：

```
[Authorize(Roles = @"domain\groupName1")] 
```

没有骰子。系统提示我输入凭据。通常这意味着 Windows 身份验证配置有问题，但设置正常：(1)`HttpContext.User`是一个`WindowsPrincipal`对象，(2) 我确认另一个已知的组名有效。

### 第二次尝试：IsInRole()

下一步是走一条更老式的路线并使用`IPrincipal.IsInRole()`，再次，一个返回`false`，另一个`true`。

```
var wp = (WindowsPrincipal)User;

// false
var inGroup1 = wp.IsInRole(@"domain\groupName1");
// true
var inGroup2 = wp.IsInRole(@"domain\groupName2"); 
```

难住了......所以我找了我的系统书呆子，我们仔细检查了一切。用户是组成员？是的。组名拼写正确？是的。下一步是抓住 SID。

### 第三次尝试：搜索身份的组集合

在我的控制器中，我检查`WindowsIdentity`并查看有问题的组的 SID 的组集合：

```
var wi = (WindowsIdentity)wp.Identity;
var group = wi.Groups.SingleOrDefault(g => g.Value == "group1-sidValue"); 
```

`group`变量是`SecurityIdentifier`对象。因为它不为空，所以我们可以确定这个当前用户是该组的成员，`[Authorize()]`或者`IsInRole()`尝试都无法确认。

### 第四次尝试：DirectoryServices.AccountManagement

在这一点上，我要发疯并添加对 AccountManagement API 的引用。`GroupPrincipal`我通过名称和 SID在域上下文中搜索：

```
 var pc = new PrincipalContext(ContextType.Domain, "domain");
   var gp1byName = GroupPrincipal.FindByIdentity(pc, "groupName1")
   var gp1bySid = GroupPrincipal.FindByIdentity(pc, IdentityType.Sid, "group1-sidValue"); 
```

两个组主体变量都具有相同的对象，并且我通过监视变量验证主体的`Members`集合包含与当前on`UserPrincipal`具有相同 SID 的对象。`WindowsPrincipal``HttpContext`

### 问题：

我到底错过了什么？当通过对象探索清楚地表明用户是该给定组的有效成员时，为什么两种角色检查方法都会失败？

一组检查正常而另一组检查的事实在这一点上似乎不是最奇怪的部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T19:21:31.640

### 回答：

本质上它是`WindowsIdentity`和`NTAccount`（这两个 System.Security.Principal）之间的转换问题，最后是实际的 Active Directory 条目。

在`WindowsIdentity`针对 AD 验证时，如果您想使用 Sam 或 Sid 以外的任何内容，则需要使用`System.DirectoryServices.AccountManagement`.

*警告：在 .Net 4.5 中，安全主体包括声明，但这与上下文无关。*

* * *

### 长解释：

在 Windows Authenticated Web 应用程序中，`HttpContext.User`是一个`WindowsPrincipal`包装底层`WindowsIdentity`.

`WindowsIdentity`对于大多数意图和目的，只有两个属性可以识别经过身份验证的用户：`Name`和`User`.

这些属性转换为身份对应的 AD 帐户条目上的两个属性：

`WindowsIdentity.Name`=`SamAccountName`

`WindowsIdentity.User`=`SID`

过滤器`[Authorize]`属性最终调用`IsInRole(string role)`基础主体......并且`IsInRole()`字符串重载实例化`NTAccount`带有`role`（AD条目中的“SamAccountName”）。

这解释了上面 #1 和 #2 中的失败。

要授权`HttpContext.User`除他/她的 Sid 或 SamAccountName 之外的任何内容，您将需要`DirectoryServices.AccountManagement`或经典 LDAP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-21T20:45:28.490

我有一个使用 Windows 身份验证的 ASP.Net MVC 应用程序，并且我正在检查组成员身份以了解控制器操作的安全性。听起来很简单，但我发现没有其他问题可以解决我遇到的问题。我花了很多时间才找到一些东西 [http://www.c-sharpcorner.com/uploadfile/scottlysle/test-for-user-group-membership-in-Asp-Net-C-Sharp/](http://www.c-sharpcorner.com/uploadfile/scottlysle/test-for-user-group-membership-in-Asp-Net-C-Sharp/)

我检查用户是否属于 AD 组的代码：

```
foreach (System.Security.Principal.IdentityReference group in System.Web.HttpContext.Current.Request.LogonUserIdentity.Groups)
{
     if (String.Equals(group.Translate(typeof(System.Security.Principal.NTAccount)).ToString(), @"your_domain_name\your_group_name", StringComparison.InvariantCultureIgnoreCase))
     {
         // the user belongs to a group 
     }
} 
```

这就是我`<authentication mode="Windows"/>`在 Web.config 文件中所需要的

# php - 如何制作手风琴菜单并在 cookie 中保存位置（包括代码）

> ID：13147133
> 
> 赞同：1
> 
> 时间：2012-10-30T20:30:56.107
> 
> 标签：php, javascript, jquery, cookies, nodes

PHP：

```
function renderCategories($parent, $categories, $expand_by_button, $expand_by_text){
    if (count($categories) > 0){
        if (is_expanded($parent)){
            echo '<ul class="main_menu" ' . ($parent ? 'style="padding-left:12px;"' : '') . 'id="category_'.$parent['id'].'">';
        } else {
            echo '<ul style="display:none;' . ($parent ? 'padding-left:12px;"' : '') . '" id="category_'.$parent['id'].'">';
        }
        foreach ($categories as $category){

            if ((count($category['children']) > 0) && ($expand_by_button)){
                echo '<li>';
                if (is_expanded($category)){
                    echo '<img current="1" src="/catalog/view/theme/default/image/btn-collapse.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-'.$category['id'].'">';
                } else {
                    echo '<img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-'.$category['id'].'">';
                }
            } else {
                echo '<li style="padding-left:12px">';
            }

            if ($category['is_current']) 
            {
                if($category['thumble'])
                {
                    $image = '<img src="image/'.$category['thumble'].'" />';
                }
                else
                {
                    $image = '';
                }
                echo $image.'<b current="1" class="category_button" id="image-'.$category['id'].'" style="cursor: pointer;">';
            }

            if (count($category['children']) > 0){
                if ($expand_by_text){
                    echo '<a class="category_id" style="cursor:pointer;margin-top:-14px; padding-left:12px; display: inline-block" href="#" title="'.$category['alt'].'" alt="'.$category['alt'].'" id="button-'.$category['id'].'">'.$category['name'].'</a>';
                } else if ($expand_by_button){
                    if ($category['is_current']){
                        echo $category['name'];
                    } else {
                        echo '<a class="category_button" id="button-'.$category['id'].'" href="'.$category['href'].'" title="'.$category['alt'].'" alt="'.$category['alt'].'">'.$category['name'].'</a>';
                    }
                } else {
                    echo '<a class="category_id category_button" style="cursor:pointer" href="#" title="'.$category['alt'].'" alt="'.$category['alt'].'" id="button-'.$category['id'].'">'.$category['name'].'</a>';
                }
            } else {
                if ($category['is_current']){
                    echo $category['name'];
                } else {
                    echo '<a href="'.$category['href'].'" title="'.$category['alt'].'" alt="'.$category['alt'].'">'.$category['name'].'</a>';
                }
            }

            if ($category['is_current']) echo '</b>';

            renderCategories($category, $category['children'], $expand_by_button, $expand_by_text);
            echo '</li>';
        }
        echo '</ul>';
    }

} 
```

HTML：

```
<div class="box">
  <div class="box-heading"><?php echo $heading_title; ?></div>
  <div class="box-content">
    <div id="shoputils_category" class="middle"><?php renderCategories(null, $categories, $expand_by_button == 1, $expand_by_text == 1) ?></div>
  </div>
</div> 
```

javascript:

```
 if(!Array.indexOf){
        Array.prototype.indexOf = function(obj){
            for(var i=0; i<this.length; i++){
                if(this[i]==obj){
                    return i;
                }
            }
            return -1;
        }
    }
    function categoryAdd(id) {
        var ids = new String($.cookie('expanded')).split(',');
        if (ids.indexOf(id) == -1){
            ids.push(id);
            $.cookie('expanded', ids.join(','), {path: '/'});
        }
    }
    function categoryRemove(id) {
        var ids = new String($.cookie('expanded')).split(',');

        // bug #7654 fixed
        while (ids.indexOf(id) != -1) {
            ids.splice(ids.indexOf(id), 1);
        }
         $.cookie('expanded', ids.join(','), {path: '/'});
    }

    $('.category_button').click(function(e){

        var change = '<?= $change; ?>';
        var current = $(this).attr('current');

        var id = $(this).attr('id').split('-')[1];

        toggleMenu(e,id)

    });

function toggleMenu(e, id)
{

            var button = $('#image-'+ id);
            if ($('#category_'+id).css('display') == 'none'){
                button.attr('src', 'catalog/view/theme/default/image/btn-collapse.png');
                categoryAdd(id);
            } else {
                button.attr('src', 'catalog/view/theme/default/image/btn-expand.png');
                categoryRemove(id);
            }
                $('#category_'+id).toggle(200);

} 
```

描述：

现在我有一个菜单，当我点击菜单中的某个类别时，该类别打开，然后保存到 cookies ，如果用户刷新页面，菜单将保存与以前相同的位置，如您所见在javascript中：-我有一个变量`$change`，该变量指示是否可以一次打开所有菜单类别或一次可以打开一个类别菜单或其称为“手风琴”，如何实现此代码隐藏的可能性当我单击某个类别打开然后将其保存到 cookie 时，所有其他类别，所以这是生成的 html：

正如您所看到的，每个`<ul>`标签都是一个有 id 的类别，问题是：如何在打开一个类别时隐藏所有其他类别，然后将其保存到 cookie 中，就像上面的代码一样。

```
<ul class="main_menu" style="padding-left:12px;" id="category_256"><li style="padding-left:12px"><a href="http://training/dom_textile/navolochki/" title="Наволочки" alt="Наволочки">Наволочки <sup>5</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pledy/" title="Пледы" alt="Пледы">Пледы <sup>3</sup></a></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-257"><b current="1" class="category_button" id="image-257" style="cursor: pointer;">Полотенца <sup>19</sup></b><ul style="display:none;padding-left:12px;" "="" id="category_257"><li style="padding-left:12px"><a href="http://training/dom_textile/polotence/polotence_bannoe/" title="Банные полотенца" alt="Банные полотенца">Банные полотенца <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/polotence/kuhonnie_polotenca/" title="Кухонные полотенца" alt="Кухонные полотенца">Кухонные полотенца <sup>19</sup></a></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-59"><a class="category_button" id="button-59" href="http://training/dom_textile/pokrivala/" title="Покрывала" alt="Покрывала">Покрывала <sup>26</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_59"><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-99"><a class="category_button" id="button-99" href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/" title="по цвету" alt="по цвету">по цвету <sup>15</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_99"><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_begh/" title="беж" alt="беж">беж <sup>3</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_belyj/" title="белый" alt="белый">белый <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_blu/" title="блю" alt="блю">блю <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokrivalo_color_bordovyj/" title="бордовый" alt="бордовый">бордовый <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_braun/" title="браун" alt="браун">браун <sup>5</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_vinograd/" title="виноград" alt="виноград">виноград <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_grafit/" title="графит" alt="графит">графит <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_grin/" title="грин" alt="грин">грин <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_ghins/" title="джинс" alt="джинс">джинс <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_kakao/" title="какао" alt="какао">какао <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_kirpich/" title="кирпич" alt="кирпич">кирпич <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_kremovii/" title="крем" alt="крем">крем <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_lavanda/" title="лаванда" alt="лаванда">лаванда <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_lajt/" title="лайт" alt="лайт">лайт <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_malahit/" title="малахит" alt="малахит">малахит <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_med/" title="мёд" alt="мёд">мёд <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_mix/" title="микс" alt="микс">микс <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_pion/" title="пион" alt="пион">пион <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_roza/" title="роза" alt="роза">роза <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_red/" title="рэд" alt="рэд">рэд <sup>6</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_serebro/" title="серебро" alt="серебро">серебро <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_terra/" title="терра" alt="терра">терра <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_fresh/" title="фреш" alt="фреш">фреш <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_cvetu/pokryvalo_color_chokolad/" title="шоколад" alt="шоколад">шоколад <sup>4</sup></a></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-88"><a class="category_button" id="button-88" href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/" title="по названию" alt="по названию">по названию <sup>26</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_88"><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/argentina/" title="Аргентина" alt="Аргентина">Аргентина <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/viola/" title="Виола" alt="Виола">Виола <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/zelenyj_chaj/" title="Зелёный чай" alt="Зелёный чай">Зелёный чай <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/irlandia/" title="Ирландия" alt="Ирландия">Ирландия <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/kantri/" title="Кантри" alt="Кантри">Кантри <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/kokos/" title="Кокос" alt="Кокос">Кокос <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/lajt/" title="Лайт" alt="Лайт">Лайт <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/marsel/" title="Марсель" alt="Марсель">Марсель <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/mexsika/" title="Мексика" alt="Мексика">Мексика <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/pion/" title="Пион" alt="Пион">Пион <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/radughnoe/" title="Радужное" alt="Радужное">Радужное <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/rivera/" title="Ривьера" alt="Ривьера">Ривьера <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/russkij_folk/" title="Русский Фолк" alt="Русский Фолк">Русский Фолк <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/smart/" title="Смарт" alt="Смарт">Смарт <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/tradicija/" title="Традиция" alt="Традиция">Традиция <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/flauers/" title="Флауэрс" alt="Флауэрс">Флауэрс <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/fughen/" title="Фьюжен" alt="Фьюжен">Фьюжен <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_nazvaniu/jamajka/" title="Ямайка" alt="Ямайка">Ямайка <sup>1</sup></a></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-86"><a class="category_button" id="button-86" href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/" title="по размеру" alt="по размеру">по размеру <sup>26</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_86"><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/150x200/" title="150x200" alt="150x200">150x200 <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/160%D1%85220/" title="160х220" alt="160х220">160х220 <sup>14</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/200x220/" title="200x220" alt="200x220">200x220 <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/200x240/" title="200x240" alt="200x240">200x240 <sup>9</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/220%D1%85240/" title="220х240" alt="220х240">220х240 <sup>1</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_razmeru/240%D1%85240/" title="240х240" alt="240х240">240х240 <sup>1</sup></a></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-124"><a class="category_button" id="button-124" href="http://training/dom_textile/pokrivala/pokryvala_po_risunku/" title="по рисунку" alt="по рисунку">по рисунку <sup>26</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_124"><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_risunku/pokryvala_v_kletku/" title="в клетку" alt="в клетку">в клетку <sup>3</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_risunku/pokryvala_v_polosku/" title="в полоску" alt="в полоску">в полоску <sup>10</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_risunku/pokryvala_odnotonnye/" title="однотонные" alt="однотонные">однотонные <sup>13</sup></a></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-87"><a class="category_button" id="button-87" href="http://training/dom_textile/pokrivala/pokryvala_po_plotnosti/" title="по плотности" alt="по плотности">по плотности <sup>26</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_87"><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_plotnosti/270_gr_m/" title="270 гр/м" alt="270 гр/м">270 гр/м <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_plotnosti/340_gr_m/" title="340 гр/м" alt="340 гр/м">340 гр/м <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_plotnosti/350_gr_m/" title="350 гр/м" alt="350 гр/м">350 гр/м <sup>2</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/pokrivala/pokryvala_po_plotnosti/370_gr_m/" title="370 гр/м" alt="370 гр/м">370 гр/м <sup>20</sup></a></li></ul></li></ul></li><li><img current="1" src="/catalog/view/theme/default/image/btn-collapse.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-128"><a class="category_button" id="button-128" href="http://training/dom_textile/postel_belio/" title="Постельное бельё" alt="Постельное бельё">Постельное бельё <sup>68</sup></a><ul class="main_menu" style="padding-left:12px;" id="category_128"><li><img current="1" src="/catalog/view/theme/default/image/btn-expand.png" class="category_button" style="cursor:pointer; padding-right:2px;" id="image-136"><a class="category_button" id="button-136" href="http://training/dom_textile/postel_belio/kpb_po_plotn/" title="по плотности ткани" alt="по плотности ткани">по плотности ткани <sup>68</sup></a><ul style="display:none;padding-left:12px;" "="" id="category_136"><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kpb_po_plotnost_105/" title="105 гр/м" alt="105 гр/м">105 гр/м <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kpb_po_plotnost_110/" title="110 гр/м" alt="110 гр/м">110 гр/м <sup>0</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kpb_po_plotnost_115/" title="115 гр/м" alt="115 гр/м">115 гр/м <sup>6</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kbp_po_plotn_120/" title="120 гр/м" alt="120 гр/м">120 гр/м <sup>4</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kpb_plotn_125/" title="125 гр/м" alt="125 гр/м">125 гр/м <sup>27</sup></a></li><li style="padding-left:12px"><a href="http://training/dom_textile/postel_belio/kpb_po_plotn/kpb_po_plotnost_130/" title="130 
```

...和更多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T02:10:00.660

尝试将打开的菜单的DOM id保存到cookie中，刷新页面后，检查你的cookie，然后获取上次保存的菜单的DOM id并使用jquery模拟点击调用

```
$('#id').click(); 
```

# javascript - 获取完整路径，包括 Node.js 中的井号 (#)

> ID：13147140
> 
> 赞同：0
> 
> 时间：2012-10-30T20:31:09.153
> 
> 标签：javascript, node.js

我正在使用 Express 在基于 Node.js 的服务器上工作。

用例：用户应该能够通过使用以下 URL 进行 HTTP GET 从服务器检索他的个人内容：`http://192.168.1.88:3000/content/[userID]`

我已经定义了这样的路线：

```
app.get('/content/:userID', content.MyHandler); 
```

**在“ MyHandler** ”中，我能够读取用户 ID并将适当的数据返回给用户。

问题是当“ **userID** ”包含井号 (#) 时，我只能得到 MyHandler 中 # 之前的内容，因此我无法找到用户。

因此，如果**用户 ID**为“123456”，则一切正常。但是如果**用户 ID**是“1234#567”，我在 MyHandler 中只得到“1234”。

MyHandler 看起来像这样：

```
exports.MyHandler = function(req, res){
  ...
  var pathChunk = req.url.split("/");
  // sys.puts("--> Path in chunks: " + sys.inspect(pathChunk));
  // Nothing after # sign
  var userID = pathChunk[2];  // Will be incomplete if contains #
}; 
```

有没有办法在 MyHandler 中检索完整的**用户 ID**值，而不管井号 (#) 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:33:46.467

浏览器不会将哈希和之后的所有内容发送到服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:45:56.017

您需要对用户 ID 进行 URL 编码，以将字符串编码为可以在 URL 行上传递的格式。

这在 javascript 中类似于：

```
var userId_encoded = encodeURIComponent(userId);
```

# java - Java 和 MySQL 插入语句

> ID：13147143
> 
> 赞同：1
> 
> 时间：2012-10-30T20:31:24.507
> 
> 标签：java, mysql, jdbc, insert

我刚从 JBDC 开始。我需要创建一个 Java/MySQL 插入语句，该语句插入 null、字符串和解析为 int 的字符串（作为用户使用 Scanner 的输入）。我尝试了很多可能性，但到目前为止没有任何效果。编写这样的插入语句的正确方法是什么，或者我应该考虑其他推荐的方法？谢谢你的帮助！

```
import java.util.ArrayList;
import java.util.Scanner;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class AddBook {

    static Scanner keyboard = new Scanner(System.in);

    static InvMenu invmenu = new InvMenu();
    static MainMenu mainmenu = new MainMenu();

    static boolean b = true;
    static int x;
    static double y;
    static double z;
    static String choice;
    static char letter;

    public static void addBook(){

        Connection conn = null;
        Statement stmt = null;
        ResultSet rs = null;

        System.out.println("+----------------+");
        System.out.println("| Add a Book     |");
        System.out.println("+----------------+\n");

        System.out.print("\nEnter ISBN number: "); 
        String isbn = keyboard.next();

        System.out.print("Enter Book Title: "); 
        String title = keyboard.next();

        System.out.print("Enter Author's name: "); 
        String author = keyboard.next();

        System.out.print("Enter Publisher's name: "); 
        String publisher = keyboard.next();

        System.out.print("Enter The Date the Book is Added to the Inventory (MM/DD/YYYY): "); 
        String dateAdded = keyboard.next();

        do{

            b = true;
            System.out.print("Enter The Quantity of Book Being Added: ");
            String qtyOnHand = keyboard.next();

            try {

                x = Integer.parseInt(qtyOnHand);

            }

            catch(NumberFormatException nFE) {

                b = false;
                System.out.println();
                System.out.println("--------------------------------------------------------");
                System.out.println(" !!!   You did not enter a valid value. Try again   !!!");
                System.out.println("--------------------------------------------------------");
                System.out.println();

            }

        }while(b == false);

        do{

            b = true;
            System.out.print("Enter The Wholesale Cost of the Book: ");
            String wholesale = keyboard.next();

            try {

                y = Double.parseDouble(wholesale);

            }

            catch(NumberFormatException nFE) {

                b = false;
                System.out.println("--------------------------------");
                System.out.println(" !   Wrong Value. Try again   !");
                System.out.println("--------------------------------\n");

            }

        }while(b == false);

        do{

            b = true;
            System.out.print("Enter The Retail Price of the Book: ");
            String retail = keyboard.next();

            try {

                z = Double.parseDouble(retail);

            }

            catch(NumberFormatException nFE) {

                b = false;
                System.out.println("--------------------------------");
                System.out.println(" !   Wrong Value. Try again   !");
                System.out.println("--------------------------------\n");

            }

        }while(b == false);

        System.out.println("-------------------------------------------");
        System.out.println("ISBN number: " + isbn);
        System.out.println("Book Title: " + title);
        System.out.println("Author's name: " + author);
        System.out.println("Publisher's name: " + publisher);
        System.out.println("The Date the Book is Added to the Inventory (MM/DD/YYYY): " + dateAdded);
        System.out.println("The Quantity of Book Being Added: " + x);
        System.out.printf("The Wholesale Cost of the Book: $ %6.2f\n", y);
        System.out.printf("The Retail Price of the Book: $ %6.2f\n", z);
        System.out.println("-------------------------------------------\n");

        try {

            Class.forName("com.mysql.jdbc.Driver").newInstance();

            String connectionUrl = "jdbc:mysql://localhost:3306/serendipity";
            String connectionUser = "root";
            String connectionPassword = "password";
            conn = DriverManager.getConnection(connectionUrl, connectionUser, connectionPassword);
            stmt = conn.createStatement();

            stmt.executeUpdate("INSERT INTO books(book_id, isbn, title, author, publisher, dateAdded, qtyOnHand, wholesale, retail) VALUES ('"+null+ "','"  +isbn+ " ','" +title+ " ',' "  +author+ " ',' " +publisher+ " ',' " +dateAdded+ " ',' " +x+ " ',' " +y+ " ',' " +z+" ')");

        } 

        catch (Exception e) {

            e.printStackTrace();

        } 

        finally {

            try { 

                if (rs != null) rs.close(); 

            } 

            catch (SQLException e) { 

                e.printStackTrace(); 

            }

            try { 

                if (stmt != null) stmt.close(); 

            } 

            catch (SQLException e) { 

                e.printStackTrace(); 

            }

            try { 

                if (conn != null) conn.close(); 

            } catch (SQLException e) { 

                e.printStackTrace(); 

            }

                System.out.println("+------------------------------------+");
                System.out.println("| The Book is Added to the Inventory |");
                System.out.println("+------------------------------------+\n"); 

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:32:36.397

您可能需要考虑使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)并使用[setNull()](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)插入 null。

原始 SQL 语句容易受到 SQL 注入攻击。

请参阅此[示例](http://www.java2s.com/Code/Java/Database-SQL-JDBC/DemoPreparedStatementSetNullforintvaluecolumn.htm)以了解有关如何使用 setNull 的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:42:01.890

您确保连接正常吗？然后，您可以考虑使用`preQueryStatement`

这是一个小例子：

```
 cnnct = getConnection();
    String preQueryStatement = "INSERT  INTO  CUSTOMER  VALUES  (?,?,?,?)";
    pStmnt = cnnct.prepareStatement(preQueryStatement);
    pStmnt.setString(1, CustId);
    pStmnt.setString(2, Name);
    pStmnt.setString(3, Tel);
    pStmnt.setInt(4, Age); 
```

# c++ - C++ 找到一个或多个多重定义的符号

> ID：13147144
> 
> 赞同：1
> 
> 时间：2012-10-30T20:31:31.450
> 
> 标签：c++

我有以下结构来管理相机状态

```
 struct keyState
 {
    float x_rotation, y_rotation, z_rotation;
    float x_rotation_rad, y_rotation_rad, z_rotation_rad;
    float x_pos, y_pos, z_pos;
 } state_manager; 
```

这个结构位于我的 WalkingCameraManipulator.h 类中。WalkingCameraManipulator 在WalkingCameraManipulator.cpp 中实现，我的主类中有一个#include "WalkingCameraManipulator"。

**错误 1 ​​错误 LNK2005: "struct keyState state_manager" (?state_manager@@3UkeyState@@A) 已在 main.obj 中定义 错误 2 错误 LNK1169: 找到一个或多个多重定义的符号**

但是，我正在处理以下错误消息，需要为我的结构找到最佳位置。关于我可以在这里做什么的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:32:59.680

尾随`state_manager`定义一个实例。在标题中。这是错误的。我建议您将代码重构为：

```
struct keyState
 {
    float x_rotation, y_rotation, z_rotation;
    float x_rotation_rad, y_rotation_rad, z_rotation_rad;
    float x_pos, y_pos, z_pos;
 } ;

extern keyState state_manager;

//somecppfile.cpp
keyState state_manager; 
```

该`extern`部分是一个声明，定义现在在一个单独的实现文件中。这模仿了您的预期行为，**但**可能不是您真正想要的。你**真的**想要一个全局实例`keyState`吗？如果没有，请将其全部删除：

```
struct keyState
 {
    float x_rotation, y_rotation, z_rotation;
    float x_rotation_rad, y_rotation_rad, z_rotation_rad;
    float x_pos, y_pos, z_pos;
 } ; 
```

# javascript - JS：处理缺少/可选数据的表单

> ID：13147146
> 
> 赞同：0
> 
> 时间：2012-10-30T20:31:50.510
> 
> 标签：javascript

前言：我不是程序员，甚至不是网络开发人员。我是一名印刷设计师，只有足够的信息是危险的。所以，请不要以为我知道一些基本的东西;-)

我正在制作一个内部表单，为我们办公室的非 HTML 人员生成 HTML。它只是一个基本的表单，它接受数据输入并将其连接到适当的 HTML 中。

问题不是所有的字段条目都是必需的。但是，它目前的工作方式只是假设数据存在。

希望这是一个基本问题。但是，我需要在忽略空字段的 javascript 的连接部分中插入一些逻辑。

这是我正在谈论的工作片段：

[http://devtest.host.org/testing/sample-form.html](http://devtest.host.org/testing/sample-form.html)

当然，实际的表单有 25 个左右的字段。但是，我在这里对其进行了简化以说明我的观点：假设在表格中只输入了一个项目符号。我需要能够告诉变量“文本”省略第二组

```
<LI> </LI> 
```

标签，因为没有第二个项目符号数据。

如果有人对如何解决这个问题有一些建议，我将不胜感激。

谢谢。

[编辑：添加代码块]

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Parent Category HTML Generator</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
* {
margin:0;
padding:0;
}
body {
background-color:white;
}
label, textarea {
display:block;
}
</style>
<script type="text/javascript">
window.onload=function() {
document.getElementById('product').onsubmit=function() {
 var Main_Image=document.getElementById('Main_Image').value;
 var Bullet1=document.getElementById('Bullet1').value;
 var Bullet2=document.getElementById('Bullet2').value;

var text="<img src=\"assets/images/"+Main_Image+"\"><br><ul><li>"+Bullet1+"</li><li>"+Bullet2+"</li></ul>";
document.getElementById('code').value=text;
return false;
 }
}
</script>
</head>
<body>

<form id="product" action="#">
Filename: <INPUT TYPE="TEXT" TABINDEX="1" size="40" id="Main_Image"><BR>
Bullet 1: <INPUT TYPE="TEXT" TABINDEX="3" size="50" id="Bullet1"><BR>
Bullet 2: <INPUT TYPE="TEXT" TABINDEX="4" size="50" id="Bullet2"><BR>
<BR>

<input type="submit">
</form>
<BR><BR>

<p>HTML:</p>
<textarea rows="20" cols="80" id="code"></textarea>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:02:01.910

`<li></li>`一个基本的解决方案是添加后处理并从您的文本变量中删除空节点（例如）。但它不适用于更复杂的情况（例如您的图像）。

我建议您将字符串分成多个步骤，如下所示：

```
var text=(Main_Image?"<img src=\"assets/images/"+Main_Image+"\"><br>":"")+
         "<ul>"+
         (Bullet1?"<li>"+Bullet1+"</li>":"")+
         (Bullet2?"<li>"+Bullet2+"</li>":"")+
         "</ul>"; 
```

(condition?choice1:choice2) 如果条件为真则选择choice1，否则选择choice2。在您的情况下，条件只是知道字符串是否不为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:13:16.807

我会采取这种方法：

```
var Main_Image_present = Main_Image.length > 0;
var Bullet1_present = Bullet1.length > 0;
var Bullet2_present = Bullet2.length > 0;
var text= '';
if(Main_Image_present)
  text += '<img src="assets/images/'+Main_Image+'"><br>';
if(Bullet1_present || Bullet2_present) {
  text += '<ul>';
  if(Bullet1_present)
    text += '<li>'+Bullet1+'</li>';
  if(Bullet2_present)
    text += '<li>'+Bullet2+'</li></ul>';
  text += '</ul>';
} 
```

基本上这只是检查输入值的长度。如果值存在（或长度 > 0），它只会添加必要的 HTML。

# xna - XNA 同时播放多个音乐曲目

> ID：13147156
> 
> 赞同：1
> 
> 时间：2012-10-30T20:32:26.737
> 
> 标签：xna, background-music

我正在寻找通过分层添加自适应音乐到我在 XNA Game Studio 中开发的游戏。

例如，有一种怪异的弦乐器在缓慢地演奏。那么也许当你接近敌人时，打击乐音轨的音量会增加。

我可以通过时间等计算出细节，但是我读到不可能同时播放多个音乐曲目。我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T16:01:29.900

你是对的。XNA 的 MediaPlayer 不能同时播放多首歌曲。XACT 是一个能够做到这一点并且与 XNA 很好地集成的选项。

以下是一些可能对您有所帮助的链接：

1.  [基础教程](http://msdn.microsoft.com/en-us/library/bb203895%28v=xnagamestudio.20%29.aspx)
2.  [指定背景音乐](http://msdn.microsoft.com/en-us/library/dd231916%28v=xnagamestudio.30%29.aspx)
3.  [改变声音的音量](http://msdn.microsoft.com/en-us/library/bb195052%28v=xnagamestudio.20%29.aspx)
4.  [使用全局变量更改音量](http://www.luminance.org/blog/code/2009/07/23/simple-dynamic-music-with-xact)

您要做的是在流式波形库中创建一些声音并将它们指定为音乐。为不同的声级创建全局变量可能是个好主意，但这是可选的。

# java - 制作简单的纸牌游戏需要什么语言/课程？

> ID：13147160
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:32:41.537
> 
> 标签：java, c++

我应该如何制作一个简单的纸牌游戏？（例如纸牌）我熟悉 java 和 c/c++ 中的终端程序，但我不熟悉图形方面。对于简单的纸牌游戏来说，openGL 是否过于复杂？我想最终我会问我从哪里开始？我需要什么语言和功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:35:26.683

JavaFX 2 或 Qt 非常容易上手，只需查看教程即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:43:20.127

Netbeans 预装了一个 GUI Builder。如果您喜欢拖放并且可以在其后面编写自己的 java 侦听器，那么这不是一个坏选择。

[http://netbeans.org/features/java/swing.html](http://netbeans.org/features/java/swing.html)

# java - 在Java中读取文件错误

> ID：13147161
> 
> 赞同：0
> 
> 时间：2012-10-30T20:32:43.207
> 
> 标签：java, io

嘿，每当我尝试阅读此文件时，我都会得到

```
java.io.FileNotFoundException 
```

不知道我做错了什么

```
Scanner inFile = new Scanner(new FileReader("data.txt")); 
```

我确定文件在正确的位置，但仍然无法正常工作...花了很多时间查看此文件，但不确定我做错了什么，我敢打赌这个错误就在我的眼皮底下...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:44:50.683

尝试以下操作以打印出 Java 正在使用的工作目录：

```
 System.out.println("Working Directory = " + System.getProperty("user.dir")); 
```

如果这不是包含您的文件的目录，那么您已经找到了问题！

Java 将尝试`data.txt`从*工作目录*开始查找，而不一定从您的程序的位置开始。

您可能从另一个目录运行程序，或者因为这是控制台的当前目录，或者是调用 Java 的脚本的位置，或者因为 IDE 中的设置（这取决于您运行程序的方式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:44:00.393

我会改用这段代码：

```
Scanner x = new Scanner(new File("data.txt")); 
```

希望这可以帮助！

# android - Android：我的应用程序突然崩溃

> ID：13147164
> 
> 赞同：2
> 
> 时间：2012-10-30T20:32:53.677
> 
> 标签：android, classcastexception

我一直在调整我的主要 xml 布局，调整不同视图在我的相对布局中的位置，突然当我在模拟器上启动它时，它崩溃并显示消息：ClassCastException

我的 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center" >

 <com.example.bingbong.Render
    android:id="@+id/render"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:background="@color/pattern5"
    android:clickable="true" />

<TextView
    android:id="@+id/fps"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:text="fpasds"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView
    android:id="@+id/score_top"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:text="asd"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView
    android:id="@+id/score_bot"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_alignParentBottom="true"
    android:text="asfa"
    android:textAppearance="?android:attr/textAppearanceLarge" />
</RelativeLayout> 
```

错误日志：

```
10-30 20:25:33.266: E/AndroidRuntime(269): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.bingbong/com.example.bingbong.Main_Activity}: java.lang.ClassCastException: android.widget.TextView
...
10-30 20:25:33.266: E/AndroidRuntime(269): Caused by: java.lang.ClassCastException: android.widget.TextView
10-30 20:25:33.266: E/AndroidRuntime(269):  at com.example.bingbong.Main_Activity.onCreate(Main_Activity.java:26) 
```

Main_Activity - 第 26 行是：

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                                WindowManager.LayoutParams.FLAG_FULLSCREEN);

        setContentView(R.layout.main_layout);
        r = (Render) findViewById(R.id.render);   // <--- Line 26.
        r.setView((TextView)findViewById(R.id.fps),(TextView)findViewById(R.id.score_top),(TextView)findViewById(R.id.score_bot));
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:38:15.927

如果我在视图中移动或更改视图类型（即，将 TextView 更改为 Button 或类似的东西），我偶尔会遇到这种情况。通常为我解决它的是做一个干净的构建。

在 Eclipse 的“项目”菜单中，选择“清理...”并执行所有项目或选择该特定项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:54:31.987

你需要清理项目，我经常收到这个错误

# android - Whetstone CPU 性能算法

> ID：13147168
> 
> 赞同：1
> 
> 时间：2012-10-30T20:33:08.417
> 
> 标签：android, performance, cpu, benchmarking, cpu-speed

我将开发一个使用 whitstone 算法来测量 CPU 性能的 android 应用程序。我选择了 Whetstone 算法，因为我的研究告诉我，它是衡量功能较弱的 cpu 性能的合适方法。

我有磨刀石算法的源代码和伪代码（来自甜蜜的 60 年代），到目前为止一切都很好。但是整个磨刀石算法似乎有点秘密，很难找到有用的信息。所以我的问题是：

*   为什么 Whetstone 算法适合测量功能较弱的 CPU 的性能？
*   简而言之，谁能告诉我究竟是什么让 CPU 性能算法成为磨刀石算法？
*   谁能简单地解释一下 Whetstone 算法的伪代码？

真的很感激回答这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T22:56:57.280

早在开发 Whetstone 时，处理器性能以 KWIPS 为单位进行测量，其中 K 代表“千”，取决于您询问的对象，它是 1000 或 1024。

最近的 Core i7 基准测试将最现代的 CPU 性能置于 GWIPS 中，其中 G 的意思是“千兆”，大约是 10 亿，是公斤的 100 万倍。

考虑到手机处理器比 60 年代和 70 年代的处理器强大得多，但不如酷睿 i7 强大，我认为它非常适合。

至于对 Whetstone 实际作用的解释：它是编造的。它的目的是执行许多指令以查看处理器的强大程度。没有输入数据，没有计算输出，什么都没有。它在运行时实际上并没有做任何有用的事情。Whetstone 的用处在于您可以测量执行所需的时间，从而确定处理器的速度。

[http://www.roylongbottom.org.uk/whetstone.htm](http://www.roylongbottom.org.uk/whetstone.htm)

[http://www.guru3d.com/articles_pages/core_i7_3770k_and_3750_review_with_z77,15.html](http://www.guru3d.com/articles_pages/core_i7_3770k_and_3750_review_with_z77,15.html)

# c - __attribute__((always_inline)) 失败

> ID：13147170
> 
> 赞同：4
> 
> 时间：2012-10-30T20:33:13.563
> 
> 标签：c, gcc

我想知道是否有人可以对此有所了解。我得到了一个包含几个`always_inline`方法的头文件，其中包含几个地方。由于我使用更新版本的 gcc 4.7.1 升级了操作系统（Debian Wheezy），因此我收到了大量关于内联失败的警告。我能够在 gcc 4.4.5 (Debian Squeezy) 上成功编译它。我正在使用的编译命令是

```
gcc -g -Wall -O0 -o [prog_name] [sources].c -l[link libraries] 
```

代码：

```
#ifndef __MCIDSHEADER_H__
#define __MCIDSHEADER_H__

#include <stdlib.h>

/* C functions */
#ifdef __cplusplus
extern "C" {
#endif

    /* Constructor and destructor */
    mcidsheader* mcidsheader_new(mcidsheader* obj, sqlite3* ids, crSettings* settings);
    void mcidsheader_delete(mcidsheader* obj);

/* set schedule number */
__attribute__ ((always_inline)) static int mcidsheader_set_schedno(mcidsheader* obj, unsigned int var)
{
    MC_CHK_OBJ(obj);
    obj->var_sched_no = var;
    /* memset schedule number */
    memset(obj->var_sched, 0, MCIDSHEADER_SCHEDNUM_SZ);
    /* copy to local */
    sprintf(obj->var_sched, "%i", var);
    obj->var_flg = 0;
    return 0;
}

/* Get schedule number */
__attribute__ ((always_inline)) static const char* mcidsheader_get_schedno(const mcidsheader* obj)
{
    MC_CHK_OBJ_PTR(obj);
    return obj->var_sched;
}

/* set job number */
__attribute__ ((always_inline)) static int mcidsheader_set_jobnumber(mcidsheader* obj, const char* var)
{
    MC_CHK_OBJ(obj);

    /* memset buff */
    memset(obj->var_jobnumber, 0, MCIDSHEADER_JOBNUMBER_SZ);
    MC_CHK_OBJ(var);
    /* copy to local */
    strcpy(obj->var_jobnumber, var);
    obj->var_flg = 0;
    return 0;
}

/* get job number */
__attribute__ ((always_inline)) static const char* mcidsheader_get_jobnumber(const mcidsheader* obj)
{
    MC_CHK_OBJ_PTR(obj);
    return obj->var_jobnumber;
}

/* set project */
__attribute__ ((always_inline)) static int mcidsheader_set_project(mcidsheader* obj, const char* var)
{
    MC_CHK_OBJ(obj);

    /* memset buff */
    memset(obj->var_project, 0, MCIDSHEADER_PROJECT_SZ);
    MC_CHK_OBJ(var);

    /* copy to local */
    strcpy(obj->var_project, var);
    obj->var_flg = 0;
    return 0;
}

/* Get project name */
__attribute__ ((always_inline)) static const char* mcidsheader_get_project(const mcidsheader* obj)
{
    MC_CHK_OBJ_PTR(obj);
    return obj->var_project;
}

/* Set client */
__attribute__ ((always_inline)) static int  mcidsheader_set_client(mcidsheader* obj, const char* var)
{
    MC_CHK_OBJ(obj);

    /* memset buff */
    memset(obj->var_client, 0, MCIDSHEADER_CLIENT_SZ);
    MC_CHK_OBJ(var);

    /* copy to local */
    strcpy(obj->var_client, var);
    obj->var_flg = 0;
    return 0;
}

/* get client */
__attribute__ ((always_inline)) static const char* mcidsheader_get_client(const mcidsheader* obj)
{
    MC_CHK_OBJ(obj);
    return obj->var_client;
}

/* set date */
__attribute__ ((always_inline)) static int mcidsheader_set_date(mcidsheader* obj, const char* var)
{
    MC_CHK_OBJ(obj);
    /* memset buff */
    memset(obj->var_date, 0, MCIDSHEADER_DATE_SZ);
    MC_CHK_OBJ(var);
    /* copy to local */
    strcpy(obj->var_date, var);
    obj->var_flg = 0;
    return 0;
}

/* get date */
__attribute__ ((always_inline)) static const char* mcidsheader_get_date(const mcidsheader* obj)
{
    MC_CHK_OBJ_PTR(obj);
    return obj->var_date;
}

/* Get struct size */
__attribute__ ((always_inline)) static unsigned int mcidsheader_get_size(const mcidsheader* obj)
{
    if(!obj) return 0;
    return obj->var_size;
}

#ifdef __cplusplus
}
#endif

#endif /* __MCIDSHEADER_H__ */ 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T04:38:15.143

从[GCC 手册](https://gcc.gnu.org/onlinedocs/gcc/Inline.html)：

> GCC 在不优化时不会内联任何函数，除非您指定`always_inline`函数的属性，如下所示：
> 
> ```
> /* Prototype.  */
> inline void foo (const char) __attribute__((always_inline)); 
> ```

因此，要解决此问题，您必须`inline`在属性之前添加一个。

# c# - 从文本框中提取数字

> ID：13147171
> 
> 赞同：-5
> 
> 时间：2012-10-30T20:33:13.747
> 
> 标签：c#, textbox, picturebox

我必须为学校制作一个程序，一个 D-FlipFlop。要输入 D 和 e/clock，我想使用 2 个文本框。（我还必须制作一个具有 3 个端口的程序，其中包含 AND、NAND、OR、NOR、XOR 端口，但这已经可以了）。

输入`D`可以是：`000001111100000111111100000011`

输入`E`可以是：`000111000111000111000111000111`

from 的值`textbox1`必须转到 a `picturebox`。这样你就可以画一条线并使触发器可视化`0`。`1`from 的值`textbox2`需要去`picturebox2`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:35:22.737

这个有可能。您实际上需要转换`000001111100000111111100000011`或`000111000111000111000111000111`将其视为`string`字节数组`byte[]`。为此，我们将使用`Convert.ToByte(object value, IFormatProvider provider)`

```
string input = "BINARY GOES HERE";
int numOfBytes = input.Length / 8; //Get binary length and divide it by 8
byte[] bytes = new byte[numOfBytes]; //Limit the array
for (int i = 0; i < numOfBytes; ++i)
{
     bytes[i] = Convert.ToByte(input.Substring(8 * i, 8), 2); //Get every EIGHT numbers and convert to a specific byte index. This is how binary is converted :)
} 
```

这将声明一个新字符串`input`，然后将其编码为字节数组 ( `byte[]`)。我们实际上需要 this as a`byte[]`才能将其用作 a`Stream`然后将其插入到我们的`PictureBox`. 为此，我们将使用`MemoryStream`

```
MemoryStream FromBytes = new MemoryStream(bytes); //Create a new stream with a buffer (bytes) 
```

最后，我们可以简单地使用这个流来创建我们的`Image`文件并将文件设置为我们的`PictureBox`

```
pictureBox1.Image = Image.FromStream(FromBytes); //Set the image of pictureBox1 from our stream 
```

**例子**

```
private Image Decode(string binary)
{
    string input = binary;
    int numOfBytes = input.Length / 8;
    byte[] bytes = new byte[numOfBytes];
    for (int i = 0; i < numOfBytes; ++i)
    {
        bytes[i] = Convert.ToByte(input.Substring(8 * i, 8), 2);
    }
    MemoryStream FromBinary = new MemoryStream(bytes);
    return Image.FromStream(FromBinary);
} 
```

例如，通过使用它，您可以随时调用，`Decode(000001111100000111111100000011)`它会为您将其转换为图像。然后，您可以使用此代码`Image`设置`PictureBox`

```
pictureBox1.Image = Decode("000001111100000111111100000011"); 
```

**重要通知：**`ArgumentException was unhandled: Parameter is not valid.`由于二进制代码无效，您可能会收到这种情况。

谢谢，
我希望你觉得这有帮助:)

# php - 使用正则表达式转换带有非拉丁字符的字符串中的链接

> ID：13147172
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:33:13.613
> 
> 标签：php, regex

我正在使用此函数在字符串中查找链接并将它们转换为 html 链接

```
function makeClickableLinks($s) {
  return preg_replace('@(https?://([-\w\.]+[-\w])+(:\d+)?(/([\w/_\.#-]*(\?\S+)?[^\.\s])?)?)@', '<a href="$1" target="_blank">$1</a>', $s);
} 
```

问题是它不能使用像这样的非拉丁字符的网址 `https://www.facebook.com/pages/Celebração/123434584839`

结果是 `https://www.facebook.com/pages/Celebra��ão/123434584839`

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:35:57.323

尝试使用正则表达式模式

```
(?:(^)|(?<=(.)))((?<!^)https?://.*?(?=\1)|https?://.*?(?=\s|$)) 
```

有**网址**_`$2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:03:12.640

要匹配拉丁字符，您应该使用 unicode 友好的正则表达式。像这样的东西应该工作：

```
@(https?://([-\pL\.]+[-\pL])+(:\pN+)?(/([\pL/_\.#-]*(\?\S+)?[^\.\s])?)?)@u 
```

# android - Android - 创建和运行快捷方式

> ID：13147174
> 
> 赞同：4
> 
> 时间：2012-10-30T20:33:17.683
> 
> 标签：android, android-intent, shortcut

这真的是两个问题。

**1.**我想为您启动一个菜单来创建一个快捷方式，就像下面的代码如何启动一个菜单，您可以以正常方式创建一个快捷方式

```
Intent pickIntent = new Intent(Intent.ACTION_CREATE_SHORTCUT); 
startActivityForResult(pickIntent, 5); 
```

唯一的问题是当我使用上面的代码并检查数据时，它似乎不包含数据。我不确定我是否需要以下权限，但无论如何我已将其放入清单中：

```
<uses-permission> android:name="com.android.launcher.permission.INSTALL_SHORTCUT" /> 
```

我想将用于运行快捷方式的数据保存在文件中，以便可以从我的应用程序运行快捷方式。

**2.**我将如何运行快捷代码，它基本上就像运行带有额外标志的意图等

我看到一个应用程序可以执行我刚才所说的操作，并且我设法查看了它保存在我的 SD 卡上的一个文件：

以下是我发现的一个示例：

```
Intent;action=com.sonyericsson.android.camera.action.FRONT_STILL_IMAGE_CAMERA;
component=com.sonyericsson.android.camera/.CameraActivity;
S.com.sonyericsson.camera.intent.extra.CAPTURING_MODE=front_normal;
end{[SName}]Front camera 
```

我肯定上面运行了一个快捷方式，可以打开相机应用程序，准备好从前置摄像头拍照，但不知道如何运行它。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T15:07:47.703

经过大量搜索后，我找到了我想要的东西：

1.  [http://www.jp-z.jp/changelog/2011-07-12-1.html](http://www.jp-z.jp/changelog/2011-07-12-1.html) - 将向您展示如何启动快捷方式到达那里

2.  有了意图后，您可以执行以下操作：

隐蔽到字符串：

```
String uri = intent.toURI().ToString() 
```

将其保存在您希望的任何位置、文件、sqlite 等

要取回它并运行意图，然后执行

```
try {
startActivity(Intent.getIntent(uri));
} catch (URISyntaxException e) {
// TODO Auto-generated catch block
e.printStackTrace();
} 
```

在此处找到如何操作：[在设置中保存 Intent 的任何解决方法？](https://stackoverflow.com/questions/2812650/any-workaround-to-save-an-intent-in-settings)

所以下面的样子

```
Intent;action=com.sonyericsson.android.camera.action.FRONT_STILL_IMAGE_CAMERA;
component=com.sonyericsson.android.camera/.CameraActivity;
S.com.sonyericsson.camera.intent.extra.CAPTURING_MODE=front_normal;
end{[SName}]Front camera 
```

运行时应该是这样的：

```
try {startActivity(Intent.getIntent("#Intent;action=com.sonyericsson.android.camera.action.FRONT_STILL_IMAGE_CAMERA;component=com.sonyericsson.android.camera/.CameraActivity;S.com.sonyericsson.camera.intent.extra.CAPTURING_MODE=front_normal;end"));
} catch (URISyntaxException e) {
// TODO Auto-generated catch block
e.printStackTrace();
} 
```

# joomla - 如何从控制器传递值以在 Joomla 2.5 中查看？

> ID：13147177
> 
> 赞同：0
> 
> 时间：2012-10-30T20:33:27.200
> 
> 标签：joomla, joomla2.5

我尝试了两个选项（可以在互联网上找到）但没有进展：

```
//in controller
$show_all = TRUE;
$view->assignRef('show', $show_all);
//in default.php and viev.html.php
$this->show;
//result
Notice: Undefined property: componentViewcomponent::$show

//in controller
$show_all = TRUE;
$view->assign('show', $show_all);
//in default.php and viev.html.php
$this->get('show');
//result
NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:19:38.993

```
$model  = $this->getModel('mymodel'); //get the model
$data_list = $model->getSomeData();//get data from the model
$view = $this->getView('view_name', 'html'); // get the view
$view->assignRef('data_list', $data_list); // set the data to the view
$view->display(); // show the view 
```

这是我过去 1 年一直在使用的，它总是对我有用。

# jquery - 如何通过按 Enter 键触发输入类型按钮

> ID：13147178
> 
> 赞同：3
> 
> 时间：2012-10-30T20:33:28.450
> 
> 标签：jquery, jquery-ui, button, jsf-1.2

在 JSF 1.2 中，我正在使用 h:commandButton type="button" 但是当我点击它并按 enter 时按钮不会触发。我尝试使用`onkeypress="keyEnter(event)"`

```
 function keyEnter(eve){
         if (eve.keyCode == 13) {
              document.getElementById(eve.target.id).click();
          }
          return false;
      } 
```

并在按下回车键时触发按钮。现在这是我的问题，我有许多带有按钮类型的 h:commandButton 元素，我该怎么做才能对按钮类型的所有元素实现 keyEnter(eve)？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T20:35:35.517

试试这个

**完整代码**

```
function keyEnter(eve){
    var key = eve.keyCode || eve.which;
     if (key == 13) {
         document.getElementById(eve.target.id).click();
     }
      return false;
}; 
```

绑定所有你可以这样做

```
$('input[type="button"]').on("keyenter",function(eve){
     var key = eve.keyCode || eve.which;
     if (key == 13) {
          $(this).click();
      }
      return false;        
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:35:10.573

要绑定侦听器，请使用`on`

```
$(document).on("keyup","button", function(eve){
      if (eve.keyCode == 13) {
          $("#" + eve.target.id).trigger("click");
      }
      return false;        
}); 
```

**还，**

使用 jQuery，您可以使用以下[`trigger()`](http://api.jquery.com/trigger/)功能：

```
$("#" + eve.target.id).trigger("click") 
```

或通过使用[`.click()`](http://api.jquery.com/click/)（这是上述的快捷方式），如下所示：

```
$("#" + eve.target.id).click() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T20:35:45.187

您可以使用将事件处理程序[`on()`](http://api.jquery.com/on/)绑定到文档中的所有按钮：`keyenter`

```
$(document).on("keyenter","button", function(eve){
      if (eve.keyCode == 13) {
          document.getElementById(eve.target.id).click();
      }
      return false;        
}); 
```

相应调整。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T20:38:59.990

要将您的事件实现到所有按钮元素，您可以这样做：

```
$('button').each(function(){
     $(this).keypress(function(){
         if (eve.keyCode == 13) {
             $(this).click(); 
          }
          return false;
      }
}); 
```

# windows - Tomcat 7 配置

> ID：13147186
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:33:57.997
> 
> 标签：windows, tomcat, config

只是想变得花哨。我知道我可以通过创建一个应用程序并将 getQueryParam 放入 jsp 文件并像这样转发来做到这一点。

但我想看看这是否可能。

我正在开发一个指向 xml 数据源的应用程序。所以服务器上的 URL 只是“/safe”，因为它使用应用程序 URL 去 (domain.com/safe)。我想看看是否有可能在 tomcat 7 中创建一个允许（localhost/safe）被转发或被视为（domain.com/safe）的映射。

因此，在本地编辑我的应用程序时，我不必来回更改 httpService

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:56:50.087

您需要配置的是虚拟主机。在官方 Tomcat 文档中阅读有关[此](http://tomcat.apache.org/tomcat-7.0-doc/virtual-hosting-howto.html)内容和[Host容器的信息。](http://tomcat.apache.org/tomcat-7.0-doc/config/host.html)

# php - php根据其他数组的顺序重新排序数组

> ID：13147187
> 
> 赞同：3
> 
> 时间：2012-10-30T20:34:06.093
> 
> 标签：php, arrays, sorting

给定这个数组：

```
Array
(
[0] => Array
    (
        [title] => this is the newest post
        [ssm_featured_post_id] => 70
    )

[1] => Array
    (
        [title] => sdfsfsdf
        [ssm_featured_post_id] => 63
    )

[2] => Array
    (
        [title] => test
        [ssm_featured_post_id] => 49
    )

[3] => Array
    (
        [title] => Hello world!
        [ssm_featured_post_id] => 1
    ) 
```

)

ssm_featured_post_id 值对应于第二个数组中数组项的值。我想以与第二个数组中的项目相同的顺序对第一个数组项进行排序

```
Array
(
    [1] => 63
    [0] => 70
    [3] => 1
    [2] => 49
) 
```

所以排序后的结果是

```
Array
(
[0] => Array
    (

        [title] => sdfsfsdf
        [ssm_featured_post_id] => 63
    )

[1] => Array
    (
        [title] => this is the newest post
        [ssm_featured_post_id] => 70
    )

[2] => Array
    (
        [title] => Hello world!
        [ssm_featured_post_id] => 1

    )

[3] => Array
    (
        [title] => test
        [ssm_featured_post_id] => 49
    )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:40:25.157

更简单的方法是使用[usort](http://www.php.net/manual/en/function.usort.php)并编写一个函数，该函数使用第二个表来比较第一个表中的两个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:38:03.140

您可能想查看[array_multisort](http://php.net/manual/en/function.array-multisort.php)，特别是给出的第三个示例。这个想法是您根据多维数组的“列”创建数组，然后同时对它们进行排序，并将结果放回原始数组中。

# regex - .htaccess 重写什么都不做

> ID：13147192
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:34:14.750
> 
> 标签：regex, apache, .htaccess, mod-rewrite, rewrite

我有一个页面，其中包含`http://www.freshmarketstores.com/departments/produce/recipe.php?ing=Akane_Apples&recipe=59`我想清理的 URL 看起来像`http://www.freshmarketstores.com/departments/produce/recipe/Akane_Apples/59`

现在，在位于生产文件夹中的 .htaccess 文件中，我有以下代码：

```
RewriteEngine on
RewriteRule ^recipe/(.*)/(.*)$ recipe.php?ing=$1&recipe=$2 [L] 
```

目前，这不会影响任何事情。加载 url时`recipe.php?ing=Akane_Apples$recipe=59`，它加载正常，但不进行重写。这是我第一次尝试 URL 重写，但无法解决这个问题。

在此先感谢您的帮助。

**编辑：** 好的，所以昨晚学习了一些之后，我意识到我正在倒退。我可以输入[http://www.freshmarketstores.com/departments/produce/recipe/Akane_Apples/59](http://www.freshmarketstores.com/departments/produce/recipe/Akane_Apples/59)并获取存储在 .../produce/recipe.php?ing=Akane_Apples&recipe=59 的资源。感谢您对此提供的所有帮助。

我现在的问题是，你能走相反的路吗？如果我输入 .../produce/recipe.php?ing=Akane_Apples&recipe=59，如何让它重定向到 /produce/recipe/Akane_Apples/59？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:39:36.540

确保您拥有

```
AccessFileName .htaccess 
```

在你的服务器和 apache 中的虚拟主机配置文件中设置，默认设置为 .htaccess 但它不仅限于此，可以命名任何东西。

基于 debian 的系统的默认配置文件是apache 安装目录中的`/etc/apache2/apache2.conf`大多数其他系统`httpd.conf`

设置访问文件并启用 mod_rewrite 后，您可以执行以下操作

[http://www.freshmarketstores.com/departments/produce/Akane_Apples/59](http://www.freshmarketstores.com/departments/produce/Akane_Apples/59)

```
RewriteEngine On
RewriteRule ^recipe/([^/]*)/([^/]*)$ /recipe.php?ing=$1&recipe=$2 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:48:07.037

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

# internal forwarding to /recipe.php
RewriteRule ^recipe/([^/]+)/([^/]+)/?$ recipe.php?ing=$1&recipe=$2 [L,QSA,NC]

# external redirect to /recipe
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+recipe\.php\?ing=([^&]+)&recipe=([^\s]+) [NC]
RewriteRule ^ recipe/%1/%2? [R=301,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:05:52.487

你应该没问题

```
RewriteEngine on
RewriteCond %{THE_REQUEST} \?ing=([^&]+)&recipe=([^&]+) [NC]
RewriteRule ^(departments/produce/recipe)\.php$ http://%{HTTP_HOST}/$1/%1/%2 [NC,R=301,L] 
```

# android - AsyncTask中applicationobject的调用方法

> ID：13147193
> 
> 赞同：2
> 
> 时间：2012-10-30T20:34:25.373
> 
> 标签：android, android-asynctask

在我的项目中，我定义了几个活动和 1 个应用程序。应用程序对象包含一些活动正在使用的一些方法。

在活动中，我从扩展 AsyncTask 的内部类中调用应用程序对象的方法。这是正确的吗？是不是应用程序的方法也是在AsyncTask进程中执行的？

非常感谢！

新74

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:43:15.327

这取决于您在 Asynctask 中调用该方法的位置。

在“doInBackground”上，您所做的一切都将在单独的线程上运行。并且“onPreExecute/onPostExecute”将在主线程（或 UI 线程）上运行。

只要系统不会杀死应用程序进程以及所有线程，它就会运行。

您可以在此处阅读有关流程生命周期的更多信息：

[http://developer.android.com/guide/components/processes-and-threads.html#Lifecycle](http://developer.android.com/guide/components/processes-and-threads.html#Lifecycle)

# javascript - 获取目标元素的（数字）dom层次结构javascript

> ID：13147195
> 
> 赞同：2
> 
> 时间：2012-10-30T20:34:32.987
> 
> 标签：javascript, dom

没有图书馆解决方案，请，但如果你知道这样做的，我很高兴看看他们是如何做到的。不太关心后备和跨浏览器支持。

我有一个层次结构（会改变）：

```
<body>
    <div></div>
    <div>
        <div></div>
        <div></div>
        <div>
            <a>Click Me!</a>
        </div>
    </div>
</body> 
```

我有一个事件侦听器`<a>Click Me!</a>`并返回一个事件对象。这么多的作品。耶！

我想要`event.target`dom 层次结构数字索引。基本上，`[0][1][2][0]`（尽管它可能会以数组的形式返回，`[0,1,2,0]`这对我来说没关系）。

*我知道这可以通过遍历父元素来完成。*如果可能的话，我试图**避免这种迭代。**

**编辑编辑** 我上次的编辑是一种愚蠢的行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T06:04:08.367

一种无需显式迭代即可获得索引的方法是使用数组 indexOf 方法。

这是它的样子，e 是你的事件：

```
function getIndex(e){
  var t=e.target;
  return Array.prototype.indexOf.call(t.parentNode.childNodes,t);
} 
```

这种技术有很多陷阱。首先， indexOf 仅被最新的浏览器支持。其次，您需要调用技巧，因为 NodeList 不是数组。第三，childNodes 可能返回比预期更多的节点，然后您必须按节点类型进行过滤。

要获取整个层次结构索引，只需在使用 parentNode 爬上 DOM 层次结构时重复并重复。

作为记录， e.target 也不是跨浏览器，但我看到这是您已经在使用的。

[更新] 完整代码，使用子节点而不是子节点：

```
function getIndex(e) {
var index=[],
    t=e.target;

while (t!==document.body) {
    index.unshift(Array.prototype.indexOf.call(t.parentElement.children,t));
    t=t.parentElement;
}
return index;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T21:01:47.887

我知道您想避免迭代，但这可能是最直接的策略：

```
$(document).on('click','a', function(e){
  var result=[];
  var count = function(e){
    if(e.parentNode != document.body ){
      result.push(e);
      count(e.parentNode);
   }else {
      return result;                                    
   }
 };
 count(e.target)
 console.log(result);
}); 
```

您试图避免迭代的原因是什么？dom是巨大的还是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:55:41.810

您说“元素将在页面上快速动态地变化”并且您正在“尝试在 javascript 中创建一个模仿 dom 中元素位置的数组”。这意味着您不仅需要重新计算移动元素的索引路径，还需要重新计算未移动元素的索引**路径**。

底线：不是计算单个元素的路径，而是遍历整个层次结构对我来说是有意义的，因为无论如何你需要重新计算的不是一个，而是所有的索引路径。

# wpf - DataGridTemplateColumn 绑定转换器

> ID：13147196
> 
> 赞同：0
> 
> 时间：2012-10-30T20:34:35.497
> 
> 标签：wpf, data-binding

我正在使用以下代码：我的错误在哪里？解决方案是什么？

```
 <MyClass:CheckForVis  x:Key="_CheckForVis"/>

    </Window.Resources>
        <DataGrid Name="dg" AutoGenerateColumns="False"
 CanUserAddRows="False" CanUserDeleteRows="False" CanUserSortColumns="False" 
                                 ItemsSource="{Binding ElementName=tempWin, Path=TitleClass}" >

            <DataGrid.Columns>

                <DataGridTemplateColumn Visibility="{Binding ElementName=tempWin, Path=TitleClass,Converter={StaticResource _CheckForVis}}" Width="*" Header="Input" IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal"  Margin="10,0,0,0" Grid.Column="0"  Name="partMojudi">
                                <TextBlock Width="Auto" Name="txtInput" Text="{Binding input}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

        </DataGrid>

        </Grid>
</Window> 
```

为什么不对？我的错误在哪里？解决方案是什么？

# loops - 汇编程序循环和变量

> ID：13147199
> 
> 赞同：0
> 
> 时间：2012-10-30T20:35:06.573
> 
> 标签：loops, assembly

我有这个代码

```
.186            
.model small, stdcall
.stack 128

draw_rect PROTO STDCALL :WORD, :WORD, :WORD, :WORD

.data 

x DB 15

...

.code

...

main:

start_loop:

invoke draw_rect, 160, 100, x, 11111111b

dec x

cmp x, 3

jnl start_loop

... 
```

这个循环是永恒的。但是，x 永远从 15 递减（我可以在显示器上看到）。我想，它应该等于 3 或小于 3。JNL - 不少于。draw_rect 根本不触及 x 。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T18:00:52.037

当您使用 DB（定义字节）宏时，ADDRESS 将替换宏到二进制文件中。

你想要的代码是这样的：

```
 MOV EAX, x            ; get the address of x
start:
     invoke draw...
     DEC [EAX]             ; decrement the value at the address
     CMP [EAX], 3          ; compare the value at the address
     JNL start 
```

# c#-4.0 - c#中字符串中的换行符

> ID：13147203
> 
> 赞同：2
> 
> 时间：2012-10-30T20:35:13.907
> 
> 标签：c#-4.0, windows-8, windows-runtime, winrt-xaml

我正在从资源加载器加载一个文本，其中包含 '\n' 以指示新行。文本块获取并显示此文本，但我看不到换行符？我也试图用 Environment.NewLine 替换每个 '\n'，但没有任何反应。我能做些什么？

这是一点点代码：

```
 TextBlock text = new TextBlock();
        text.FontSize = 18;

        var str = loader.GetString("AboutText");
        //str.Replace("\n", Environment.NewLine);

        text.Text = str;
        text.TextAlignment = TextAlignment.Justify;
        text.TextWrapping = TextWrapping.Wrap;
        text.Margin = new Thickness(10, 10, 10, 10); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:40:18.590

看起来 Resource 文件正在转义`\n`到`\\n`，这意味着基本上有两种解决方案可以解决这个问题。

你可以

```
var str = Regex.Unescape(loader.GetString("AboutText")); 
```

或者在您的 resx 文件中，您可以通过按 Shift Enter 将 \n 替换为正常的换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:29:56.587

试试“\r\n”。这个对我有用。

```
 TextBlock text = new TextBlock();
    text.FontSize = 18;

    var str = "Hello\r\nWorld";

    text.Text = str;
    text.TextAlignment = TextAlignment.Justify;
    text.TextWrapping = TextWrapping.Wrap;
    text.Margin = new Thickness(10, 10, 10, 10);
    layoutRoot.Children.Add(text); 
```

# html - HTML Body 使用 Chrome 的开发者工具显示 cz-shortcut-listen="true"？

> ID：13147210
> 
> 赞同：163
> 
> 时间：2012-10-30T20:35:36.437
> 
> 标签：html, google-chrome, google-chrome-devtools

我正在测试我正在制作的一些 HTML 代码，并且在 Google Chrome 版本 22.0.1229.94 m 上使用开发者工具时，我看到该`<body>`标签具有该属性`cz-shortcut-listen="true"`（这当然不在我的代码中）。**这是什么意思，为什么会出现？**（我尝试在谷歌中查找它，但没有发现任何相关信息）

![截屏](../Images/37e5320766427db74e5e3a812a00d808.png)

* * *

## 回答 #1

> 赞同：347
> 
> 时间：2012-10-30T20:37:05.590

它是由 Colorzilla 浏览器扩展添加的。

[https://twitter.com/brianpemberton/status/201455628143689728](https://twitter.com/brianpemberton/status/201455628143689728)

# visual-studio-2012 - WCF 数据服务客户端无法在 WP8 模拟器上运行

> ID：13147214
> 
> 赞同：0
> 
> 时间：2012-10-30T20:36:22.877
> 
> 标签：visual-studio-2012, emulation, wcf-data-services, windows-phone-8

刚刚尝试了一个适用于 WP7 emu 和 VS 2010 的应用程序，称为数据服务并工作，但在 VS 2012 中尝试使用 WP8 SDK，但它不能在 emu 上工作，并因“未找到”错误而中断：'System.Data 类型的异常.Services.Client.DataServiceQueryException' 发生在 System.Data.Services.Client.DLL 中，但未在用户代码中处理

有人也发现了这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:36:07.530

对我来说听起来很像你的问题是模拟器没有任何互联网连接。我建议您从 Hyper-V 列表中删除模拟器，使用以太网电缆连接您的计算机，然后重新启动您的项目。

# c - 哪个 Linux 发行版按原样使用 Linux 内核，无需修改

> ID：13147215
> 
> 赞同：3
> 
> 时间：2012-10-30T20:36:42.193
> 
> 标签：c, linux, kernel

我正在尝试对 Linux 内核进行一些学习，你们都知道没有什么比玩代码本身更好的了，你能告诉我哪个 Linux 发行版最容易使用吗？换句话说，据我所知，例如 Ubuntu 为他们的发行版修改内核，那么问题又来了，哪个发行版使用 Linux 内核，没有修改？

感谢您的指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:43:36.390

当谈到简洁（内核没有外部补丁）时，请查看 Slackware。或者关注“Linux from Scratch”，这是最简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:43:51.150

如果你想开始使用 Linux 内核，我推荐一个发行版，它可以让你自己编译内核变得特别容易。虽然我无法提供详细的指导，但 Gentoo 似乎是这样做的（虽然 gentoo 还有其他缺点，但我不知道现实生活中有一个人真正使用过 gentoo 两年多）。

我不会尝试寻找不修改内核的发行版，这可能不值得付出努力。与内核的整体大小相比，补丁可能很小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:13:19.947

[您可以按照https://wiki.ubuntu.com/KernelTeam/GitKernelBuild](https://wiki.ubuntu.com/KernelTeam/GitKernelBuild)轻松运行 Ubuntu，例如使用 vanilla 内核。

# mysql - 友谊桌

> ID：13147216
> 
> 赞同：1
> 
> 时间：2012-10-30T20:36:46.497
> 
> 标签：mysql, database

我有一个名为 users 的表，其中包含我网页上的用户。用户可以建立友谊，其中用户 1 请求用户 2 建立友谊。它现在的工作方式是，当用户 1 发送请求时，我在友谊表中创建一行，其中包含两个外键：user_id_from 和 user_id_to 以及一个名为 status 的字段，该字段可以为 0（请求待处理）， 1 或 2 user_id_to 分别接受或拒绝了友谊请求。最后状态可以是 3，表示其中一个用户已经删除了友谊。

这是正确的方法，还是我应该创建一个包含所有待处理请求的临时表，然后（如果请求被接受）将其插入到友谊表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:42:13.653

从逻辑的角度来看，您所做的是正确的，因为我个人认为未决的友谊请求是一种未经确认的友谊形式。

从设计的角度来看，我不确定每次用户需要查看他的友谊请求列表时如何创建一个临时表。如果该表不是临时表，您将拥有一个名为 Confirmed_friendships 和 pending_friendships 的表。

我强烈建议您将两者保存在同一张表中，除非会有很多特定于pending_friendships 且不可用于confirmed_friendships 的列，反之亦然。

# php - 访问某个 XML 区域

> ID：13147217
> 
> 赞同：-2
> 
> 时间：2012-10-30T20:36:55.523
> 
> 标签：php, xml, simplexml

我在下面有以下 XML 结构，但我不确定如何直接访问该 URL，以便可以将它用作`src`我的图像标记中的一个。

**PHP结构：**

```
$images = $url->property->photos
<img src="'.$images.'" width="233" height="154" /> - Testing URL 
```

**通用 XML 结构：**

```
<photos>
 <photo>
  Information
 </photo>
</photos> 
```

**XML结构：**

```
["photos"]=>
    object(SimpleXMLElement)#118 (2) {
      ["@attributes"]=>
      array(1) {
        ["count"]=>
        string(2) "43"
      }
      ["photo"]=>
      array(43) {
        [0]=>
        string(97) "http://www.domain.co.nz/images/6f8bc4855bface1ad2c35635625fdbb4c3a11537.jpeg"
        [1]=>
        string(97) "http://www.domain.co.nz/images/fcb36e4a3465b934490d44e6bb8e1a8192cb466d.jpeg"
        [2]=>
        string(97) "http://www.domain.co.nz/images//c1e2c792832a08f881bb24756137a63a19c7070d.jpeg"
        [3]=>
        string(97) "http://www.domain.co.nz/images/b6d9a3c52c7fba81553edb9101c80d273c16ee3c.jpeg" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:05:48.987

```
$xmlstr = <<<XML
<properties count="1">
        <property approved="yesterday">
                <address>123 Main Street</address>
                <photos count="2">
                        <photo>1.jpg</photo>
                        <photo>2.jpg</photo>
                </photos>
        </property>
</properties>
XML;
$properties = new SimpleXMLElement($xmlstr);//this could have been done using simplexml_load_file($url); for instance
//the important part is that you have a SimpleXML object named $properties
foreach($properties->property as $property){
        echo $property['approved']."<br>\n";
        echo $property->address."<br>\n";
        foreach($property->photos->photo as $photo){
                echo $photo."<br>\n";
        }
} 
```

我假设您可能有多个属性，并且您想列出每个属性。如果您只有一个，或者只想列出第一个，您可以安全地删除第一个 foreach 循环：

```
echo $properties->property[0]['approved']."<br>\n";
echo $properties->property[0]->address."<br>\n";
foreach($properties->property[0]->photos->photo as $photo){
    echo $photo."<br>\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:57:46.327

如果你 var_dump'd 喜欢这样：

```
var_dump($images);
//output:
object(SimpleXMLElement)#117 (2) {... 
```

您可以像这样循环访问这些照片 URL：

```
foreach($images->photo as $image){
    echo '<img src="'.$image.'"/>;
} 
```

# c# - 捕获主要图像颜色

> ID：13147221
> 
> 赞同：2
> 
> 时间：2012-10-30T20:37:04.133
> 
> 标签：c#, .net, image, graphics, bitmap

例如 - 我有很多草或森林的照片，它们只是“绿色”。

大海和天空的照片是蓝色的，雪的照片是白色的。

我需要一些东西（想法/算法）来解决我的问题，但不知道如何让它变得又快又容易。（我更喜欢 c#，但 java 也很好）。

# c# - Windows Phone如何通过坐标获取国家？

> ID：13147223
> 
> 赞同：2
> 
> 时间：2012-10-30T20:37:33.920
> 
> 标签：c#, xna, coordinates, reverse-geocoding, country

我目前正在为一个学校项目使用 XNA/Silverlight 为 Windows 手机开发 ac# 应用程序。我已经能够从设备获取坐标。但我不想要坐标，我想显示他们在哪个国家。我发现一些能够将坐标转换为国家的网站： [http ://maps.google.com/maps/geo?q= 47.645,122.141&output=csv&sensor=false](http://maps.google.com/maps/geo?q=47.645,122.141&output=csv&sensor=false) 但我不希望用户上网向他展示，我想在我的应用程序中构建它。那么如何在 TextBlock 上的应用程序中显示国家/地区？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:50:57.070

# 1.制作自己的数据集

下载高分辨率地图，**将每个国家/地区绘制成不同的颜色**，然后在查找表中将这些颜色分配给各自的国家/地区。确保将地图保存为位图 - 压缩格式会扭曲国家边缘的颜色。

要获取国家/地区名称，请执行以下步骤：

```
1\. Translate geocoordinates into map coordinates
2\. Get the pixel at selected map coordinates
3\. Get country name from the lookup by getting color data from the pixel 
```

这个解决方案需要**大量的手工工作**，除非您已经准备好高分辨率彩色地图。

自然，**分辨率越高越好**。您还可以考虑绘制不同国家的领海以及国际水域（即返回大西洋）。

* * *

# 2\. 国家多边形

或者，正如 LB 所建议的，您可以获得**国家的多边形**，并使用多边形中的**点命中测试**算法来确定用户所在的国家。

我编写了一个简单的类来执行此操作：[pastebin link](http://pastebin.com/33G0y1sf)。

基本上，它解析[一个 kml 文件](http://geocommons.com/overlays/5603.kml)（我使用过[这个 geocommons map](http://geocommons.com/overlays/5603)），并使用[在 stackoverflow 上的多边形答案中](https://stackoverflow.com/a/2922778/1020861)找到的代码来检测哪个国家在给定坐标上。

* * *

示例用法：

```
FileInfo kmlFile = new FileInfo("5603.kml");

String kmlString = "";
using (StreamReader sr = new StreamReader(kmlFile.OpenRead()))
{
    kmlString = sr.ReadToEnd();
}

Kml kml = new Kml(kmlString);
String country = kml.GetCountryByCoordinates(18.26, 42.56); 
```

这为我打印了克罗地亚，这是我实际所在的国家。代码是仓促拼凑的（尤其是 KML 解析部分），所以它可能有一些错误。你应该更多地测试它。

* * *

如果您需要**美国的各个州**，您可以尝试使用**不同的 KML 文件**。另外，**这张地图的分辨率不是很高**，如果你看海岸线，你会发现很多半岛和岛屿都没有被多边形包围，所以在这些区域可能会出现一些错误。领海也没有标记。我只能建议您**寻找更好的地图**或制作自己的地图，**如果这会造成重大问题**。

# google-bigquery - 如何列出所有用户的工作 ID？

> ID：13147225
> 
> 赞同：0
> 
> 时间：2012-10-30T20:37:46.230
> 
> 标签：google-bigquery

我正在使用 Java API 使用以下代码查询所有作业 ID

```
Bigquery.Jobs.List list = bigquery.jobs().list(projectId);
list.setAllUsers(true); 
```

但它没有列出由客户端 ID 为 Web 应用程序运行的作业 ID（即指标洞察）我正在使用私钥身份验证。

依次使用命令行工具“bq ls -j”只给我度量洞察作业 ID，而不是使用私钥身份验证运行的那些。有get all方法吗？

我这样做的原因是试图更好地了解哪些查询占用了我们的数据使用量。我们有多种查询来源：指标洞察、内部自动化、一些手动完成等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:59:43.047

从 2.0.10 版本开始，[bq 客户端](http://code.google.com/p/google-bigquery-tools/source/detail?r=0d5b4cd109ef6274fb695902ab59faed0ad23601)支持使用服务帐户凭据进行 API 授权。您可以指定使用具有以下标志的特定服务帐户：

```
bq --service_account your_service_account_here@developer.gserviceaccount.com \
    --service_account_credential_store my_credential_file  \
    --service_account_private_key_file mykey.p12 <your_commands, etc> 
```

键入`bq --help`以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:29:47.913

我的预感是，列出所有用户的工作已被破坏，并且没有人提到它，因为通常有一种解决方法。我目前正在调查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:44:01.877

乔丹——听起来你正在磨练我们想要做的事情。对于我们允许对项目/数据集的所有访问，我们希望为执行的所有查询生成“totalBytesProcessed”的聚合/报告。

我们正在努力解决的问题是，我们有一些不同的 Java 程序访问我们的数据、一个 3rd 方服务（度量洞察力）和 7-8 个通过 Web 界面进行查询访问的个人用户。幸运的是，传入的数据只有一个来源，因此解释成本很简单。对于查询，虽然我现在有点盲目（而且看起来查询将是每月账单的大部分）。

如果我可以仅通过某个顶级身份验证创建一个列表来获取此报告的底层数据，那将是理想的。有了这个，我认为从时间戳和实际的 SQL 文本中我可以将每个查询归因于一个源。

可能使这个问题变得更容易的一件事是，如果工作记录中有更多信息（或 job_id 中的一些文本修饰用于查询）。我看不到我可以在查询中分配我自己的 jobID（也许我错过了？），也许在工作记录中记录一些源信息是可能的？现在只是大声思考...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-07T09:27:38.353

您可以查询三个表。

`region-**.INFORMATION_SCHEMA.JOBS_BY_{USER, PROJECT, ORGANIZATION}`

`**`应该由您所在的地区替换。

`JOBS_BY_USER`区域内的示例查询`eu`：

```
select
  count(*) as num_queries,
  date(creation_time) as date,
  sum(total_bytes_processed) as total_bytes_processed,
  sum(total_slot_ms) as total_slot_ms_cost
from
 `region-eu.INFORMATION_SCHEMA.JOBS_BY_USER` as jobs_by_user,
 jobs_by_user.referenced_tables
group by
 2
order by 2 desc, total_bytes_processed desc; 
```

文档可在以下位置获得：

[https://cloud.google.com/bigquery/docs/information-schema-jobs](https://cloud.google.com/bigquery/docs/information-schema-jobs)

# assemblies - 尝试删除/删除资源/应用程序时无法加载文件或程序集

> ID：13147229
> 
> 赞同：4
> 
> 时间：2012-10-30T20:38:18.977
> 
> 标签：assemblies, biztalk

我有一个 Biztalk 应用程序，它基本上是其他应用程序正在使用的模式的外壳。我现在想删除此应用程序，但无法从 BizTalk Server 管理控制台删除，当我右键单击 --> 删除时，我收到一条错误消息

`Could not load file or assembly <assembly_name>.dll or one of its dependencies. The system cannot find the path specified (mscorlib)`

其次是：

`The system cannot find the path specified (Exception from HRESULT: 0x80070003)`

所以我去从应用程序中删除程序集并得到完全相同的错误。我删除了其他 biztalk 资源中对它的所有引用，但在尝试删除应用程序或资源时仍然出现相同的错误。我确实注意到在引用程序集的*Modify Resouces*对话框中，这个恶意程序集被列为*Not Found*的依赖状态。

奇怪的是，当消息通过时，依赖于恶意程序集的资源仍然可以正常工作并且没有抛出错误（尽管它们使用显示为*Not Found*的程序集组件）。

我已确保检查 GAC 并将程序集加载到其中。

所以现在我不得不问：

1.  Biztalk 实际上在哪里寻找这个程序集？
2.  有没有办法强制删除这个应用程序？
3.  当我试图删除它时，为什么它在乎是否找不到程序集？
4.  为什么它显示为*Not Found*，但仍然有效？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:26:48.843

我认为关键是“或其依赖项之一”。如果它是一个依赖项，它可能正在使用标准的 windows 机制来查找 dll。它在当前目录和 windows 目录中搜索它们。

“Biztalk 实际上在哪里寻找这个程序集？”

在 biztalk 管理控制台中查看应用程序的“资源”部分。它显示了一个带有装配位置的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T21:35:17.870

我会停止所有主机实例/编排，然后从 GAC 中卸载所有内容 - 如果消息实际上仍在通过，那么仍然使用您的架构加载内容。

# php - 如何使用 Google 自定义搜索 API 检查网站列表当前是否已被 Google 索引？

> ID：13147233
> 
> 赞同：0
> 
> 时间：2012-10-30T20:38:38.803
> 
> 标签：php, api, search

目前，您可以将电子表格（包含网站列表）导入数据库。您可以单击一个按钮，它会检索 Google 已为数据库中的每个域编制索引的页面数。

它可以正常工作，直到大约 400 个请求，然后我的请求一无所获。不确定我做错了什么或如何使这项工作 - 有什么想法吗？

```
try {
        require('db.php');
        $conn = new PDO ( "mysql:host=localhost;dbname=" . $database, $user, $pass );
        $conn->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
        $stmt = $conn->query('SELECT `url` FROM domains');
        $stmt->setFetchMode(PDO::FETCH_ASSOC);
        while($row = $stmt->fetch()){
            $id = $row['id'];
            $url = $row['url'];
            $pages = getIndexedPageCount($url);
            if ( $pages > 0 ) {
                $status = 1;
            } else {
                $status = 0;
            }
            $prep = $conn->prepare("
            UPDATE `domains`
                SET
                    url = :url,
                    pages = :pages,
                    status = :status
                WHERE url = :url
            ");
            $prep->execute(array(
                ':url'      =>  $url,
                ':pages'    =>  $pages,
                ':status'   =>  $status
            ));
        }
    } catch ( PDOException $e ) {
        echo 'Error: ' . $e->getMessage();
        exit;
    }

    function getIndexedPageCount($domain) {

    // remove http:// and https://
    if ( strpos( $domain, 'http:' ) == 0 ) { $domain = str_replace('http://', '', $domain); }
    if ( strpos( $domain, 'https:' ) == 0 ) { $domain = str_replace('https://', '', $domain); }

        $content = file_get_contents('https://www.googleapis.com/customsearch/v1?key={{Removed API Key}}&q=site:' . $domain);

        if (strlen($content) > 1) {
            $data = json_decode($content);
            return intval($data->searchInformation->totalResults);
        }

        else {
            echo "Error: URL does not exist.";
        }
    } 
```

任何帮助将不胜感激; 如果有人有想法，我会尽力让它发挥作用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:39:32.407

您可以向 Google 发送的请求数量是有限制的。

有关详细信息，请参见此处[https://developers.google.com/console/help/#monitoringandfiltering](https://developers.google.com/console/help/#monitoringandfiltering)

这是 API 控制台：[https ://code.google.com/apis/console](https://code.google.com/apis/console)

目前在控制台中它说`Custom Search API`有一个`Courtesy limit: 100 requests/day`

> > 如果您未注册计费，超出免费使用配额的任何使用都将失败。启用计费后，您将继续每天收到 100 次免费查询。但是，对于所有额外的请求，您将按每 1000 次查询 5 美元的费率付费，每天最多 10,000 次查询。

# xml - XSLT 查询 - 根据前一个节点的属性查找值

> ID：13147239
> 
> 赞同：1
> 
> 时间：2012-10-30T20:39:24.437
> 
> 标签：xml, xslt, xquery

我必须查询一个属性值，然后基于此我必须从不同的节点中找到另一个属性值。

这是我的 XML 的样子：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <order main="0" state="ntype" otdType="SeeBeyond/eGate/OTDLead/UD1_0" identifier="Test/_453220556">
     <enum id="2" name="order" size="3">
      <item name="seq" value="0"/>
      <item name="any" value="1"/>
      <item name="mix" value="2"/>
     </enum>
     <enum id="3" name="align" size="8">
      <item name="blind" value="0"/>
      <item name="begin" value="1"/>
      <item name="exact" value="2"/>
      <item name="final" value="3"/>
      <item name="inter" value="4"/>
      <item name="oneof" value="5"/>
      <item name="regex" value="6"/>
      <item name="super" value="7"/>
     </enum>
     <enum id="4" name="delimTerm" size="4">
      <item name="never" value="0"/>
      <item name="allow" value="1"/>
      <item name="cheer" value="2"/>
      <item name="force" value="3"/>
     </enum>
     <enum id="5" name="delimKind" size="3">
      <item name="escape" value="0"/>
      <item name="normal" value="1"/>
      <item name="repeat" value="2"/>
     </enum>
     <enum id="6" name="nodeType" size="6">
      <item name="alter" value="0"/>
      <item name="array" value="1"/>
      <item name="delim" value="2"/>
      <item name="fixed" value="3"/>
      <item name="group" value="4"/>
      <item name="trans" value="5"/>
     </enum>
     <overlay type="structure">
      <class id="34" name="com.stc.otd.runtime.OtdOutputStream" java="com.stc.otd.runtime.OtdOutputStream" type="baseclass"/>
      <class id="4" name="java.lang.String" java="java.lang.String" type="baseclass"/>
      <class id="39" name="com.stc.otd.runtime.OtdInputStream" java="com.stc.otd.runtime.OtdInputStream" type="baseclass"/>
      <class id="43" name="byte" java="byte" type="primitive"/>
      <class id="44" name="array of byte" java="byte[]" type="arraytype" base="43"/>
      <class id="25" java="ud1.Test_453220556.Env1.Test" type="nodeclass"/>
      <class id="27" java="ud1.Test_453220556.Test" type="nodeclass">
       <method id="55" name="unmarshalFromString" java="unmarshalFromString" result="31">
        <param id="56" name="in" java="in" type="28"/>
        <throw id="57" name="java.io.IOException" java="java.io.IOException"/>
        <throw id="58" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
       </method>
       <method id="32" name="reset" java="reset" result="31"/>
       <method id="59" name="setDecoding" java="setDecoding" result="31">
        <param id="60" name="code" java="code" type="28"/>
       </method>
       <method id="45" name="marshalToBytes" java="marshalToBytes" result="44">
        <throw id="46" name="java.io.IOException" java="java.io.IOException"/>
        <throw id="47" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
       </method>
       <method id="30" name="check" java="check" result="29"/>
       <method id="65" name="setPostCoding" java="setPostCoding" result="31">
        <param id="66" name="code" java="code" type="28"/>
       </method>
       <method id="38" name="unmarshal" java="unmarshal" result="31">
        <param id="40" name="in" java="in" type="39"/>
        <throw id="42" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
        <throw id="41" name="java.io.IOException" java="java.io.IOException"/>
       </method>
       <method id="63" name="setAnteCoding" java="setAnteCoding" result="31">
        <param id="64" name="code" java="code" type="28"/>
       </method>
       <method id="61" name="setEncoding" java="setEncoding" result="31">
        <param id="62" name="code" java="code" type="28"/>
       </method>
       <method id="48" name="unmarshalFromBytes" java="unmarshalFromBytes" result="31">
        <param id="49" name="in" java="in" type="44"/>
        <throw id="51" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
        <throw id="50" name="java.io.IOException" java="java.io.IOException"/>
       </method>
       <method id="33" name="marshal" java="marshal" result="31">
        <param id="35" name="out" java="out" type="34"/>
        <throw id="37" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
        <throw id="36" name="java.io.IOException" java="java.io.IOException"/>
       </method>
       <method id="52" name="marshalToString" java="marshalToString" result="28">
        <throw id="53" name="java.io.IOException" java="java.io.IOException"/>
        <throw id="54" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
       </method>
      </class>
      <class id="26" java="ud1.Test_453220556.Env1.Element" type="nodeclass"/>
      <class id="29" name="array of java.lang.String" java="java.lang.String[]" type="arraytype" base="28"/>
      <class id="28" name="string" java="java.lang.String" type="baseclass"/>
      <class id="31" name="void" java="void" type="primitive"/>
      <node id="0" type="choice">
       <ref node="1" name="Test" javaName="Test" access="modify"/>
      </node>
      <node id="1" type="group" javaType="25" rootType="27">
       <prop name="public" type="boolean" value="false"/>
       <prop name="top" type="boolean" value="true"/>
       <ref node="2" name="Element" javaName="Element" access="modify"/>
      </node>
      <node id="2" type="group" javaType="26">
       <ref node="3" name="X" javaName="X" access="modify"/>
      </node>
      <node id="3" type="simple" javaType="4"/>
     </overlay>
     <overlay type="document"/>
     <overlay type="origin">
      <node id="0">
       <prop name="mainPackage" value="ud1.Test_453220556."/>
       <prop name="classNameBase" value="Test"/>
      </node>
      <node id="1">
       <prop name="rootClassName" value="ud1.Test_453220556.TestMainImpl.Root1"/>
       <prop name="order" type="2" value="seq"/>
       <prop name="nodeType" type="enum:array,delim,fixed,group,trans" value="group"/>
      </node>
      <node id="2">
       <prop name="order" type="2" value="seq"/>
       <prop name="length" type="integer" value="10"/>
       <prop name="nodeType" type="enum:array,delim,fixed,group,trans" value="fixed"/>
      </node>
      <node id="3">
       <prop name="align" type="3" value="blind"/>
       <prop name="length" type="integer" value="10"/>
       <prop name="nodeType" type="enum:array,delim,fixed,trans" value="fixed"/>
      </node>
     </overlay>
    </order> 
```

示例：我需要查询的属性值在第 101 行。在此示例中，我必须获取引用节点的节点 ID，即“3”：

```
 <node id="2" type="group" javaType="26">
     <ref node="3" name="X" javaName="X" access="modify"/>
  </node> 
```

然后我需要在 XML 中进一步搜索，它应该找到 id="3" 的节点，然后查找名为“length”的属性并返回它的值，在此示例中为“10”：

```
 <node id="3">
    <prop name="align" type="3" value="blind"/>
    <prop name="length" type="integer" value="10"/>
    <prop name="nodeType" type="enum:array,delim,fixed,trans" value="fixed"/>
  </node> 
```

我编写了以下 XSLT 代码，但需要添加更多代码才能正确获取长度部分：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
      <html>
      <body>
        <h2>My OTD type</h2>
        <table border="1">
          <tr bgcolor="#9acd32">
            <th>Name</th>
            <th>Column Length</th>
          </tr>
          <xsl:for-each select="/order/overlay/node/ref">
          <tr>
            <td><xsl:value-of select="@name" /></td>

    <xsl:for-each select="/order/overlay[3]/node">
            <td><xsl:value-of select="props/@value" /></td>
    </xsl:for-each>

          </tr>
          </xsl:for-each>
        </table>
      </body>
      </html>
    </xsl:template>
    </xsl:stylesheet> 
```

请建议如何获得所需的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:02:59.917

**此转换使用键以实现最大效率，并显示如何获得所需值：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:key name="kNodeByTypeAndId" match="overlay/node"
  use="concat(../@type,'+',@id)"/>

 <xsl:template match="/">
     <xsl:value-of select=
      "key('kNodeByTypeAndId',
           concat('origin+',key('kNodeByTypeAndId', 'structure+2')/ref/@node)
           )
           /prop[@name='length']/@value
     "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<order main="0" state="ntype" otdType="SeeBeyond/eGate/OTDLead/UD1_0"
identifier="Test/_453220556">
    <enum id="2" name="order" size="3">
        <item name="seq" value="0"/>
        <item name="any" value="1"/>
        <item name="mix" value="2"/>
    </enum>
    <enum id="3" name="align" size="8">
        <item name="blind" value="0"/>
        <item name="begin" value="1"/>
        <item name="exact" value="2"/>
        <item name="final" value="3"/>
        <item name="inter" value="4"/>
        <item name="oneof" value="5"/>
        <item name="regex" value="6"/>
        <item name="super" value="7"/>
    </enum>
    <enum id="4" name="delimTerm" size="4">
        <item name="never" value="0"/>
        <item name="allow" value="1"/>
        <item name="cheer" value="2"/>
        <item name="force" value="3"/>
    </enum>
    <enum id="5" name="delimKind" size="3">
        <item name="escape" value="0"/>
        <item name="normal" value="1"/>
        <item name="repeat" value="2"/>
    </enum>
    <enum id="6" name="nodeType" size="6">
        <item name="alter" value="0"/>
        <item name="array" value="1"/>
        <item name="delim" value="2"/>
        <item name="fixed" value="3"/>
        <item name="group" value="4"/>
        <item name="trans" value="5"/>
    </enum>
    <overlay type="structure">
        <class id="34" name="com.stc.otd.runtime.OtdOutputStream" java="com.stc.otd.runtime.OtdOutputStream" type="baseclass"/>
        <class id="4" name="java.lang.String" java="java.lang.String" type="baseclass"/>
        <class id="39" name="com.stc.otd.runtime.OtdInputStream" java="com.stc.otd.runtime.OtdInputStream" type="baseclass"/>
        <class id="43" name="byte" java="byte" type="primitive"/>
        <class id="44" name="array of byte" java="byte[]" type="arraytype" base="43"/>
        <class id="25" java="ud1.Test_453220556.Env1.Test" type="nodeclass"/>
        <class id="27" java="ud1.Test_453220556.Test" type="nodeclass">
            <method id="55" name="unmarshalFromString" java="unmarshalFromString" result="31">
                <param id="56" name="in" java="in" type="28"/>
                <throw id="57" name="java.io.IOException" java="java.io.IOException"/>
                <throw id="58" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
            </method>
            <method id="32" name="reset" java="reset" result="31"/>
            <method id="59" name="setDecoding" java="setDecoding" result="31">
                <param id="60" name="code" java="code" type="28"/>
            </method>
            <method id="45" name="marshalToBytes" java="marshalToBytes" result="44">
                <throw id="46" name="java.io.IOException" java="java.io.IOException"/>
                <throw id="47" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
            </method>
            <method id="30" name="check" java="check" result="29"/>
            <method id="65" name="setPostCoding" java="setPostCoding" result="31">
                <param id="66" name="code" java="code" type="28"/>
            </method>
            <method id="38" name="unmarshal" java="unmarshal" result="31">
                <param id="40" name="in" java="in" type="39"/>
                <throw id="42" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
                <throw id="41" name="java.io.IOException" java="java.io.IOException"/>
            </method>
            <method id="63" name="setAnteCoding" java="setAnteCoding" result="31">
                <param id="64" name="code" java="code" type="28"/>
            </method>
            <method id="61" name="setEncoding" java="setEncoding" result="31">
                <param id="62" name="code" java="code" type="28"/>
            </method>
            <method id="48" name="unmarshalFromBytes" java="unmarshalFromBytes" result="31">
                <param id="49" name="in" java="in" type="44"/>
                <throw id="51" name="com.stc.otd.runtime.UnmarshalException" java="com.stc.otd.runtime.UnmarshalException"/>
                <throw id="50" name="java.io.IOException" java="java.io.IOException"/>
            </method>
            <method id="33" name="marshal" java="marshal" result="31">
                <param id="35" name="out" java="out" type="34"/>
                <throw id="37" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
                <throw id="36" name="java.io.IOException" java="java.io.IOException"/>
            </method>
            <method id="52" name="marshalToString" java="marshalToString" result="28">
                <throw id="53" name="java.io.IOException" java="java.io.IOException"/>
                <throw id="54" name="com.stc.otd.runtime.MarshalException" java="com.stc.otd.runtime.MarshalException"/>
            </method>
        </class>
        <class id="26" java="ud1.Test_453220556.Env1.Element" type="nodeclass"/>
        <class id="29" name="array of java.lang.String" java="java.lang.String[]" type="arraytype" base="28"/>
        <class id="28" name="string" java="java.lang.String" type="baseclass"/>
        <class id="31" name="void" java="void" type="primitive"/>
        <node id="0" type="choice">
            <ref node="1" name="Test" javaName="Test" access="modify"/>
        </node>
        <node id="1" type="group" javaType="25" rootType="27">
            <prop name="public" type="boolean" value="false"/>
            <prop name="top" type="boolean" value="true"/>
            <ref node="2" name="Element" javaName="Element" access="modify"/>
        </node>
        <node id="2" type="group" javaType="26">
            <ref node="3" name="X" javaName="X" access="modify"/>
        </node>
        <node id="3" type="simple" javaType="4"/>
    </overlay>
    <overlay type="document"/>
    <overlay type="origin">
        <node id="0">
            <prop name="mainPackage" value="ud1.Test_453220556."/>
            <prop name="classNameBase" value="Test"/>
        </node>
        <node id="1">
            <prop name="rootClassName" value="ud1.Test_453220556.TestMainImpl.Root1"/>
            <prop name="order" type="2" value="seq"/>
            <prop name="nodeType" type="enum:array,delim,fixed,group,trans" value="group"/>
        </node>
        <node id="2">
            <prop name="order" type="2" value="seq"/>
            <prop name="length" type="integer" value="10"/>
            <prop name="nodeType" type="enum:array,delim,fixed,group,trans" value="fixed"/>
        </node>
        <node id="3">
            <prop name="align" type="3" value="blind"/>
            <prop name="length" type="integer" value="10"/>
            <prop name="nodeType" type="enum:array,delim,fixed,trans" value="fixed"/>
        </node>
    </overlay>
</order> 
```

**产生了想要的正确结果：**

```
10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:48:50.277

这个 Xpath 应该可以工作：prop/[@type="3"]/following-sibling

# html - 居中透明菜单

> ID：13147242
> 
> 赞同：-2
> 
> 时间：2012-10-30T20:39:39.973
> 
> 标签：html, css, center

我试图让我的透明菜单**居中**显示，但是无论我从互联网上找到什么方法，似乎都没有任何效果。

如果有人可以查看此代码并帮助我，我真的很高兴。:)

**HTML部分：**

```
<div id="container">
<div id="menu">
    <span class="bg"></span>
    <ul>
        <li><a href="print">PRINT</a></li> 
        <li><a href="tv">TV</a></li> 
        <li><a href="other">OTHER</a></li> 
        <li><a href="resume">RESUME</a></li>
    </ul>
</div> 
```

**CSS部分：**

```
#container 
{   
    display: inline-block;
    *display: inline;
    zoom: 1;
    padding: 10px 0 0 0
    overflow:hidden;
    font-family:arial;
    height:400px;
}

#menu 
{   

    float: left;  // **WHENEVER I CHANGE THIS FLOAT, THE MENU-BACKGROUND DISAPPEARS?!**
    position: relative;
    display:inline;
    border:2px solid #000;
    border-top:0;
    border-radius:0 0 10px 10px;
}
#menu .bg 
{
    position:absolute;
    width:100%;
    height:100%;
    background:#000;
    opacity:0.5;
    filter:alpha(opacity=50);
    left:0;
    top:0;
}
#menu li 
{ 
    float:left;
}
#menu a 
{
    text-decoration:none;
    position:relative;
    padding:8px 13px;
    color:white;
    font-weight:bold;
    z-index:2;
    float:left;
}
#menu a:hover 
{
    color:#999;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:47:34.873

您可以通过更新`#menu`到：

```
#menu {   
    position: absolute;
    border:2px solid #000;
    border-top:0;
    border-radius:0 0 10px 10px;
    left: 50%;
    margin-left: -152px;
    width: 305px;
} 
```

[JSFiddle](http://jsfiddle.net/LAnLt/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:46:28.807

居中浮动是困难的。这是一种方法：

```
<style type="text/css">

#container
{   

font-family:arial;
height:400px;
border: red;
position: relative;

}

#menu
{   

position:relative;
left:-50%;
float:right;
}

ul
{
position:relative;
left:50%;
background: rgba(0, 0, 0, 0.5); 
overflow: hidden;
}

li{
display:block;
float:left; 
padding: 8px 13px;
}

a {text-decoration:none;}

</style>
<div id="container">
<div id="menu">
<ul>
    <li><a href="print">PRINT</a></li>
    <li><a href="tv">TV</a></li>
    <li><a href="other">OTHER</a></li>
    <li><a href="resume">RESUME</a></li>
</ul>
</div>
</div> 
```

来源：[http](http://browse-tutorials.com/snippet/center-floats-css) ://browse-tutorials.com/snippet/center-floats-css 小提琴：http: [//jsfiddle.net/yucHM/2/](http://jsfiddle.net/yucHM/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T20:50:38.023

您的菜单未居中的原因是因为您没有为菜单或容器定义宽度。如果您有一个定义的宽度，那么您将能够使用：

```
margin: 0 auto; 
```

我还不确定为什么你的浮动开始弄乱你的背景颜色，但是我注意到你在你的一个样式属性的末尾错过了一个分号

```
#container 
{
padding: 10px 0 0 0
...
} 
```

应该

```
#container 
{
padding: 10px 0 0 0;
...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T20:56:43.387

另外一个选项：

编辑的CSS：

```
#container 
    {   
        display: inline-block;
        *display: inline;
        zoom: 1;
        padding: 10px 0 0 0
        overflow:hidden;
        font-family:arial;
        height:400px;

    }

    #menu 
    {   

        float: left;  // **WHENEVER I CHANGE THIS FLOAT, THE MENU-BACKGROUND DISAPPEARS?!**
        position: relative;
        display:inline;

    }
    #menu .bg 
    {
        position:absolute;
        width:100%;
        height:100%;
        background:#000;
        opacity:0.5;
        filter:alpha(opacity=50);
        left:0;
        top:0;
    }
    #menu ul {          <===Added this definition and moved the border here as well
       clear:left;
       float:left;
       list-style:none;
       margin:0;
       padding:0;
       position:relative;
       left:50%;
       text-align:center;
        border:2px solid #000;
        border-top:0;
        border-radius:0 0 10px 10px;
    }
    #menu li 
    { 
        float:left;
    }
    #menu a 
    {
        text-decoration:none;
        position:relative;
        padding:8px 13px;
        color:white;
        font-weight:bold;
        z-index:2;
        float:left;
    }
    #menu a:hover 
    {
        color:#999;
    }​ 
```

编辑的 HTML（关闭了 div 标签）

```
<div id="container">
<div id="menu">
    <span class="bg"></span>
    <ul>
        <li><a href="print">PRINT</a></li> 
        <li><a href="tv">TV</a></li> 
        <li><a href="other">OTHER</a></li> 
        <li><a href="resume">RESUME</a></li>
    </ul>
    </div>
</div>​ 
```

这是[FIDDLE](http://jsfiddle.net/jcurran/yucHM/)

# c++ - 我想使线程的执行顺序一个接一个

> ID：13147243
> 
> 赞同：-2
> 
> 时间：2012-10-30T20:39:44.487
> 
> 标签：c++, c, multithreading, winapi

```
#include <windows.h>
#include <iostream>
using namespace std;

int count = 0;

DWORD WINAPI Tf1 ( LPVOID n )
{
    HANDLE hEvent = OpenEvent ( EVENT_ALL_ACCESS , false, (LPCWSTR)"MyEvent" );
    if ( !hEvent ) { return -1; }
    // Loop through and wait for an event to occur
    for ( ;; )
    {
        // Wait for the Event
        WaitForSingleObject ( hEvent, INFINITE );
        count++;
        printf("In function1, Counter value: %d\n",count);
        //    No need to Reset the event as its become non signaled as soon as
        //    some thread catches the event.
        if( count > 7 ) return 0;
    }
    CloseHandle(hEvent);
    return 0;
}

DWORD WINAPI Tf2 ( LPVOID n )
{

    HANDLE hEvent = OpenEvent ( EVENT_MODIFY_STATE , false, (LPCWSTR)"MyEvent" );
    if ( !hEvent ) return -1; 

    for ( ;; )
    {
        if( count % 2 == 0) 
            SetEvent (hEvent);
        else
        {
            count++;
            printf("In function2, Counter value: %d\n",count);
        }
        //    No need to Reset the event as its become non signaled as soon as
        //    some thread catches the event.
        if( count > 7 ) return 0;
    }
    CloseHandle(hEvent);
    return 0;
}

int main()
{
    //    Create an Auto Reset Event which automatically reset to 
    //    Non Signalled state after being signalled
    HANDLE     hEvent = CreateEvent ( NULL , false , false , (LPCWSTR)"MyEvent" );
    if ( !hEvent ) return -1;
    //    Create a Thread Which will wait for the events to occur
    HANDLE mutex = CreateMutex(NULL, FALSE, NULL);

    DWORD Id;
    HANDLE hThrd1 = CreateThread ( NULL, 0, (LPTHREAD_START_ROUTINE)Tf1,0,0,&Id );
    HANDLE hThrd2 = CreateThread ( NULL, 0, (LPTHREAD_START_ROUTINE)Tf2,0,0,&Id );

    if ( !hThrd1 ) { CloseHandle (hEvent); return -1; }
    if ( !hThrd2 ) { CloseHandle (hEvent); return -1; }
    // Wait for a while before continuing....
    Sleep ( 1000 );
    // Give the signal twice as the thread is waiting for 2 signals to occur

    // Wait for the Thread to Die
    WaitForSingleObject ( hThrd1, INFINITE );
    WaitForSingleObject ( hThrd2, INFINITE );

    CloseHandle ( hThrd1 );
    CloseHandle ( hThrd2 );
    CloseHandle ( hEvent );

    system ( "PAUSE" );
    return 0;
} 
```

**输出/输出：**

```
In function1, Counter value: 1
In function1, Counter value: 3
In function2, Counter value: 2
In function2, Counter value: 4
In function2, Counter value: 6
In function1, Counter value: 5
In function1, Counter value: 7
In function2, Counter value: 8 
```

**所需的 O/P：**

```
In function1, Counter value: 1
In function2, Counter value: 2
In function1, Counter value: 3
In function2, Counter value: 4
In function1, Counter value: 5
In function2, Counter value: 6
In function1, Counter value: 7
In function2, Counter value: 8 
```

我知道我没有利用线程的力量。但我的要求是这样的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:44:44.110

如果您想一个接一个地执行一个线程，您可以为每个线程分配一个 Id 并使用共享令牌，假设每个线程递增 1 的变量。只有当它的值等于它的 Id 时，线程才能获取令牌。获取令牌后，线程执行其主体，然后将令牌加 1 并释放它。

如果要顺序执行代码，使用线程有什么意义？:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:56:43.250

在这段代码中没有什么可以阻止竞争条件。您要么需要两个事件，以便线程在信号和等待中进行乒乓球比赛，要么使用临界区保护您的计数器。

**选项1：**

```
// Thread 1
{
    increment counter
    Signal event 2
    Wait on event 1
}

// Thread 2
{
    Wait on event 2
    increment counter
    Signal event 1
} 
```

**选项 2：（**使用您现有的范例）

```
// Thread 1
{
    Wait on event
    Acquire mutex
    if count is even
        increment counter
    end
    Release mutex
}

// Thread 2
{
    Acquire mutex
    if count is even
        Signal event
    else
        increment counter
    end
    Release mutex
} 
```

请注意，选项 2 在线程 2 中有点过时......它可能会在线程 1 响应事件时旋转多次。在这方面，您也可以完全删除该事件并让两个线程都退出...如果您想避免这种情况，请使用我的选项 1。

还有其他方法可以走，包括使用互锁增量，但无论如何都要尝试上述方法之一。

# mysql - MySQL查询子查询或分组

> ID：13147244
> 
> 赞同：1
> 
> 时间：2012-10-30T20:39:46.637
> 
> 标签：mysql, subquery

每个 modx_site_content 记录在 modx_site_tmplvar_contentvalues 中可能有多个记录。

我需要同时检索 modx_site_tmplvar_contentvalues.value，其中 tvv.tmplvarid = 3 和 tvv.tmplvarid = 1。其中 tvv.tmplvarid 是未来日期，我需要返回 tvv.tmplvarid 3 的 tvv.value，它是一个逗号分隔标签列表。

此查询不返回我需要的值，我不确定如何得到我想要的。

```
SELECT sc.id, sc.pagetitle, tvv.value, tvv.tmplvarid, tvv.id, tvv.value
FROM modx_site_content sc
left join modx_site_tmplvar_contentvalues tvv on tvv.contentid = sc.id
where published = '1' 
and (tvv.tmplvarid = '3' and tvv.value >= curdate())
order by sc.id; 
```

基本上最后我只需要返回标签列表（tvv.tmplvarid = 3），其中其他关联记录（tvv.tmplvarid = 1）是未来的日期。

任何想法，这可以通过分组来完成吗？我实际上不需要 modx_site_content 表中的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:00:10.830

因此，您需要返回`modx_site_tmplvar_contentvalues`表中具有`tmplvarid`1 和 3 的两行的标签都与相同的相关`modx_site_content`，但只有当 `tmplvarid`3 行将来有一个 datetime 字段时？

我会对 modx_site_tmplvar_contentvalues 表做两个单独的连接：

```
SELECT tOne.value, tThree.value
FROM modx_site_tmplvar_contentvalues tOne
INNER JOIN modx_site_content c ON tOne.contentid = c.id
INNER JOIN modx_site_tmplvar_contentvalues tThree ON tThree.contentid = c.id
WHERE c.published = 1
AND tOne.tmplvarid = 1 
AND tThree.tmplvarid = 3 AND tThree.date > NOW() 
```

*SQL 小提琴：* [http ://sqlfiddle.com/#!2/a4031/2](http://sqlfiddle.com/#!2/a4031/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:48:01.470

我想到了。如果您只是阅读文档，您可以做什么令人惊奇；）

```
select tv.contentid, tv.value as eventdate, sc.id, sc.pagetitle, tvv.value from 
(   
 select * from modx_site_tmplvar_contentvalues cv 
 where cv.tmplvarid = 3
 and cv.value >= curdate() 
) as tv  
left join modx_site_content sc on sc.id = tv.contentid
left join modx_site_tmplvar_contentvalues tvv on tvv.contentid = sc.id
where (tvv.tmplvarid = 1)
order by value asc 
```

# java - 使用 Spring Security 3 实现 CAS

> ID：13147249
> 
> 赞同：3
> 
> 时间：2012-10-30T20:40:11.973
> 
> 标签：java, spring, configuration, spring-security, cas

我目前已配置弹簧安全性并正常工作。我想让 CAS 工作，这样我就可以在我编写的多个应用程序中进行单点登录。我很困惑如何让 cas 使用我的自定义 userdetailService。

目前我有这是我的 spring-security.xml

```
 <authentication-manager alias="authManager">
        <authentication-provider user-service-ref="userDetailsService">
            <password-encoder ref="passwordEncoder">
                <salt-source ref="saltSource"/>
            </password-encoder>
        </authentication-provider>
    </authetication-manager> 
```

从我发现的所有 cas 示例中，他们说要以这种方式实现管理：

```
<beans:bean id="casAuthenticationProvider" class="org.springframework.security.cas.authentication.CasAuthenticationProvider">
    <beans:property name="authenticationUserDetailsService">
        <beans:bean class="org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper">
            <beans:constructor-arg ref="userDetailsService"/>
        </beans:bean>
    </beans:property>
    <beans:property name="serviceProperties" ref="serviceProperties"/>
    <beans:property name="ticketValidator">
        <beans:bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
            <beans:constructor-arg index="0" value="https://localhost:8443/cas"/>
        </beans:bean>
    </beans:property>
    <beans:property name="key" value="1234554321"/>
</beans:bean>

<authentication-manager alias="authManager">
    <authentication-provider ref="casAuthenticationProvider"/>
</authentication-manager> 
```

文档令人困惑。如何从一个工作的 spring-security 应用程序转到一个实现 cas 并仍然使用我的自定义用户详细信息的应用程序？我还需要在 jsp 页面上进行哪些更改？任何帮助将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T12:19:38.490

我认为您希望 CAS 使用您自己的密码+盐编码器来验证密码。

不幸的是，这不是一个直接的配置，并且该配置不在您的 Spring 应用程序中。您需要重新编译 CAS 以包含您的自定义密码+盐编码器。因此，当 Spring 调用 CAS 进行身份验证时，将使用相同的自定义密码+盐编码器。

幸运的是，CAS 团队创建了 WAR Overlay 方法，因此用户可以轻松重新编译 CAS 服务器以包含自定义密码+盐编码器

文档在这里 [https://wiki.jasig.org/display/CASUM/Best+Practice+-+Setting+Up+CAS+Locally+using+the+Maven2+WAR+Overlay+Method](https://wiki.jasig.org/display/CASUM/Best+Practice+-+Setting+Up+CAS+Locally+using+the+Maven2+WAR+Overlay+Method)

您需要非常耐心地执行这些步骤并确保您的系统具有 Maven2 您无需下载任何库，因为 Maven 会处理这些。WAR Overlay 方法的基本思想是创建一个 Maven 控制文件夹，您可以在其中创建子文件夹以添加您的自定义 java 库。

Maven 将用于重新编译自定义 java 代码以及 CAS 文件以生成一个 WAR 文件，您可以在其中将其发布到 SSL 服务器。

只需确保 CAS 和您的 Spring 应用程序都使用 SSL。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:06:38.867

以下是我在设置 CAS 基础架构时推荐的步骤

1.  首先，您应该了解 CAS 是什么，以及它是如何工作的。查看[这篇文章](http://mattfleming.com/node/269)和 jasig-webpage。
2.  然后[从 Spring Source 下载示例](https://src.springframework.org/svn/spring-security/tags/spring-security-3.0.0.RELEASE/samples)，运行 cas-sample，并使用它来更好地感受它。（我不确定是否有自述文件，或者您在 spring 源网页上获得有关如何使用它的信息，但肯定有信息）
3.  让您的应用针对这个简单的 CAS-Server 进行身份验证（在 CAS 网页上查找配置示例）
4.  设置和配置您自己的 CAS-Server，它使用您当前的身份验证系统来授权用户。
    *   身份验证后，您可以使用 SAML 协议将角色等从 CAS 传输到客户端应用程序
    *   要在客户端应用程序中应用角色，您可能需要自行实现。
5.  调整其他应用程序以使用 CAS-Server

# java - 在 if 语句中将变量设置为一个值

> ID：13147257
> 
> 赞同：1
> 
> 时间：2012-10-30T20:40:50.270
> 
> 标签：java, if-statement

```
static int findPerson(String n, int NP, Friend[] giftGivers){

    int index = 0;

    for (int i = 0; i < NP; i++){
    if (giftGivers[i].name == n){
            index = i;
    }
    }

    return index;
} 
```

我在 Java 中有这个代码，用于搜索朋友数组以查找名称由字符串 n 输入的人的索引号。但是我发现索引号没有设置为应该的索引号。是因为它在if语句中吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T20:41:53.030

`if (giftGivers[i].name == n)`错了，用`if (giftGivers[i].name.equals(n))`

顺便说一句，没有必要使用`NP`. 它是 C 风格的，在 Java 中不是必需的（实际上，非常危险）。代替

`for (int i = 0; i < NP; i++)`,

说啊`for (int i = 0; i < giftGivers.length; i++)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:42:53.737

您需要使用[equals](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals%28java.lang.Object%29)来比较字符串 not `==`。

`==`将比较对象引用而不是实际的字符串值。

如果你不关心大小写，那么还有一个[忽略大小写的equals方法](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equalsIgnoreCase%28java.lang.String%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T20:42:12.410

```
(giftGivers[i].name == n){ 
```

应该

```
(giftGivers[i].name.equals(n)){ 
```

字符串/对象比较应该使用`.equals()`而不是`==`

`==`将检查引用相等性。`equals()`检查对象是否相等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T20:47:20.227

`.equals()`方法检查`equality`两个字符串对象，`==`运算符检查两个引用变量是否指向同一个字符串对象。

在您的情况下，您必须使用`.equals()`方法

```
if (giftGivers[i].name.equals(n)) 
```

请参阅[字符串 API](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#equals%28java.lang.Object%29)。请注意，如果您想检查两个字符串是否不区分大小写，请使用`equalsIgnoreCase()`

# ios - 以编程方式为 UICollectionView 设置委托不起作用

> ID：13147258
> 
> 赞同：3
> 
> 时间：2012-10-30T20:40:51.973
> 
> 标签：ios, delegates, datasource, collectionview

我有一个控制大视图的视图控制器 A。在那个视图上，我有一个类型为 C 的子视图`CollectionView`。

我想要一个单独的类 C_Manager 来处理 C 子视图的委托和数据源功能

我有以下

在 A 中`viewDidLoad`

```
cManager = [[C_Manager alloc] init];

cManager.collection = C;
self.C.delegate = cManager;
self.C.dataSource = cManager; 
```

在 C_Manager.h 我有

```
@interface C_Manager : NSObject <UICollectionViewDataSource,UICollectionViewDelegate> 
```

在 C_Manager.m 我有：

```
// all the functions for the dataSource plus 

-(void)collectionView:(UICollectionView*)collectionview didSelectItemAtIndexPath:(NSIndexPath*) indexPath
{
} 
```

我从来没有达到`didSelectItemAtIndexPath`. 有趣的是，我确实达到了 dataSource 协议的功能，如果我禁用了设置它的行 - 我不再达到它......

我检查了xib中的视图C-`"User Interraction Enabled"`已检查...

怎么了 ？

# jquery - 带有固定元素的 jQuery .animate() 和 css 位置

> ID：13147264
> 
> 赞同：2
> 
> 时间：2012-10-30T20:41:21.830
> 
> 标签：jquery, css, jquery-animate, position, fixed

我正在努力想出一种方法来让它工作，所以寻求一些帮助。

我有一个固定的侧面导航菜单，不在屏幕上。我希望让它从屏幕外动画到屏幕上的特定位置。此外，它需要移动的数量会根据屏幕尺寸而变化（即，排水沟会改变尺寸）。所以，我需要将它移动到相对于容器 div 的特定位置（保持在屏幕中心）。

最好的方法是什么？任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:22:35.567

我不确定我是否完全理解您在寻找什么，但我认为这是您正在寻找的小提琴：

[http://jsfiddle.net/phoffman/vyaHH/5/](http://jsfiddle.net/phoffman/vyaHH/5/)

您需要为侧边栏 div 设置动画，确保它位于容器 div 内，并且其 CSS 位置设置为“相对”。

HTML：

```
 <div class="container">
     <div id="sidebar"> <p>This is a sidebar</p> </div>
 </div> 
```

CSS：

```
#sidebar{
    position:relative;
} 
```

查询：

```
$('button').click(function(){
    $('#sidebar').animate({
        left: 0 //This value of 0 is how far you want the sidebar to animate.
    });
}); 
```

# objective-c - 从精灵表 cocos2d 创建精灵动画

> ID：13147266
> 
> 赞同：0
> 
> 时间：2012-10-30T20:41:37.633
> 
> 标签：objective-c, cocos2d-iphone, sprite

我正在尝试从精灵表创建动画精灵，为此我正在运行以下命令：

```
NSMutableArray *bunsenAnimFrames = [NSMutableArray array];
    for(int i = 1; i <= 74; ++i) {
        [bunsenAnimFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:[NSString stringWithFormat:@"15_%i.png", i]]];
    }

    for (int j = 1; j <= 74; ++j) {
        [bunsenAnimFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:[NSString stringWithFormat:@"15_1.png"]]];
    }

    for (int k = 75; k <= 148; ++k) {
        [bunsenAnimFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:[NSString stringWithFormat:@"15_%i.png",k]]];
    }

    for (int l = 1; l <= 74; ++l) {
        [bunsenAnimFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:[NSString stringWithFormat:@"15_1.png"]]];
    }

    NSLog(@"bunsenAnimFrames is %@", bunsenAnimFrames );

    CCAnimation *bunsenAnimationAnimation = [CCAnimation animationWithSpriteFrames:bunsenAnimFrames delay:1/25];

    bunsens = [CCRepeatForever actionWithAction:[CCAnimate actionWithAnimation:bunsenAnimationAnimation]]; 
```

然后稍后在使用一组平铺精灵填充舞台时，我运行：

```
else if (blockValue == 2 || blockValue == 3 || blockValue == 4 || blockValue == 5) {
                bunsen = [CCSprite spriteWithSpriteFrameName:@"15_1.png"];

                if (blockValue == 2) {
                    bunsen.rotation = 90;
                }
                else if (blockValue == 3) {
                    bunsen.rotation = 180;
                }
                else if (blockValue == 4) {
                    bunsen.rotation = 270;
                }
                float tileY = screenSize.height-((countery*startData4)+startData4/2+77.5)/2;
                float tileX = ((counterx*startData4)+startData4/2+5)/2;

                bunsen.position = ccp(tileX,tileY);

                [bunsenAnimation addChild:bunsen];
                [bunsen runAction:bunsens];

            } 
```

这在添加本生精灵（在头文件中声明为精灵）时效果很好，但是在调用`[bunsen runAction:bunsens];`精灵时没有任何反应，有什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:59:24.657

我为此找到的解决方案没有使用 CCAnimation 延迟中的一小部分......奇怪！因为我认为延迟值可以是任何浮点数！

# ruby-on-rails - Rails：文件路径

> ID：13147277
> 
> 赞同：39
> 
> 时间：2012-10-30T20:42:15.747
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在`app`一个名为的目录`csv`中，在这个目录中我有一个名为的文件，`names.csv` 我想使用`File.read(path:string)`函数来读取文件。
文件的相对路径是什么？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-30T20:45:36.887

```
file = File.join(Rails.root, 'app', 'csv', 'names.csv')
File.read(file) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-12-17T19:59:39.600

你应该做：`Rails.root.join "app", "csv", "names.csv"`

Rails.root 返回一个 PathName 对象。PathName 有一个`join`方法，它接受任意数量的参数并将其附加到路径名以创建新路径。

在此处阅读 PathName#join：

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/pathname/rdoc/Pathname.html#method-i-join](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/pathname/rdoc/Pathname.html#method-i-join)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-30T20:46:13.863

`Rails.root`指向 Rails 项目的顶层文件夹，因此路径为：

```
File.read(File.join(Rails.root, 'app','csv','names.csv')) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-16T12:28:12.110

感谢以上答案，它也对我有用：

```
"#{Rails.root}/public/spreadsheets/file_name.xlsx" 
```

# javascript - 在对象数组上使用下划线的“差异”方法

> ID：13147278
> 
> 赞同：44
> 
> 时间：2012-10-30T20:42:16.670
> 
> 标签：javascript, underscore.js

```
_.difference([], []) 
```

当我拥有原始类型数据时，此方法可以正常工作

```
var a = [1,2,3,4];
var b = [2,5,6]; 
```

并且`_.difference(a,b)`电话返回`[1,3,4]`

但如果我使用像这样的对象

```
var a = [{'id':1, 'value':10}, {'id':2, 'value':20}];
var b = [{'id':1, 'value':10}, {'id':4, 'value':40}]; 
```

似乎不起作用

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-10-23T16:39:18.173

试试这个大小以找出对象数组的差异：

```
var test = [{a: 1},{b: 2}];
var test2 = [{a: 1}];

_.filter(test, function(obj){ return !_.findWhere(test2, obj); }); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-12-27T08:45:35.623

虽然接受的答案是正确的，并且其他答案也给出了很好的想法，但还有一个额外的选项很容易用下划线实现。

这个解决方案依赖于每个对象都有一个唯一的 ID，但在许多情况下，这将是正确的，您只需两行代码即可获得两个对象数组的差异。

使用 underscore 的“pluck”方法，您可以快速构建一个包含源集和目标集中所有 ID 的数组。从那里开始，所有下划线的数组方法都将起作用，差异，联合，交集等......

操作后，从源列表中获取您想要的对象列表是很简单的。这是一个例子：

详细：

```
var a = [{'id':1, 'value':10}, {'id':2, 'value':20}];
var b = [{'id':1, 'value':10}, {'id':4, 'value':40}];

var arr1 = _.pluck(a, "id");
var arr2 = _.pluck(b, "id");
var diff = _.difference(arr1, arr2);
var result = _.filter(a, function(obj) { return diff.indexOf(obj.id) >= 0; }); 
```

或者，更简洁地说：

```
var diff = _.difference(_.pluck(a, "id"), _.pluck(b, "id"));
var result = _.filter(a, function(obj) { return diff.indexOf(obj.id) >= 0; }); 
```

当然，同样的技术可以扩展用于任何数组方法。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-30T20:56:52.990

原因很简单，具有相同内容的对象不是相同的对象，例如

```
var a = [{'id':1, 'value':10}, {'id':2, 'value':20}]; 
a.indexOf({'id':1, 'value':10}) 
```

它不会返回 0 而是返回 -1，因为我们正在搜索不同的对象

查看源代码[http://underscorejs.org/underscore.js](http://underscorejs.org/underscore.js)，`_.difference`使用`_.contains`

```
_.difference = function(array) {
  var rest = concat.apply(ArrayProto, slice.call(arguments, 1));
  return _.filter(array, function(value){ return !_.contains(rest, value); });
}; 
```

并`_.contains` 最终使用`indexOf`因此不会找到对象，除非它们指向同一个对象。

`_.contains`您可以通过遍历所有项目并调用比较回调来改进下划线，您应该能够将其传递给差异或包含函数，或者您可以检查[改进包含方法的此版本](https://github.com/panbhag/underscore-contains/blob/master/underscore-contains.js)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-16T12:08:08.590

我实际上可以想象我宁愿使用@kontr0l 方法而不是其他方法的情况，但是您必须了解这种方法是二次的，所以基本上这段代码是对幼稚方法的抽象——遍历两个数组中的所有值。

有比二次方更好的方法，我不会在这里使用任何大的 O 表示法，但这里有两种主要方法，两者都比天真的方法更好：

*   遍历其中一个数组并使用二进制搜索检查排序的第二个数组中是否存在。
*   将值放入 set/hash/dictionary/你命名它。

正如已经提到的，如果您`difference`使用一些更灵活的方法类似物重新实现标准方法，则可以对对象采用第`indexOf`一种方法。

使用第二种方法，我们可以碰壁，因为截至 2015 年 2 月，只有现代浏览器支持[Sets](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)。由于 javascript 中的哈希（嗯，对象），它们只能有字符串类型的键，所以任何作为键调用的对象首先应该通过`toString`方法转换。所以，我们需要提供一些 => 对应。在大多数情况下的实践中，它非常简单，例如，对于您的特定示例，这种对应关系可以是`String(obj.id)`.

有了这样的对应关系，我们还可以使用以下 lodas/undercore 方法：

```
var idsA = _.pluck(a, 'id');
var idsB = _.pluck(b, 'id');

// actually here we can stop in some cases, because 
// quite often we need to identify object, but not the object itself - 
// for instance to send some ids through remote API.
var intersect = _.intersection(idsA, idsB);

//to be 100% sure you get the idea, here we assume that object having equal ids are treated as equal, so does not really matter which of arrays we'll iterate:

var dictA = _.object(idsA, a); // now we can find a by id faster then with _.find
var intersectObj = intersect.map(function(id) {return dictA[id}) 
```

但是要承认稍微严格的限制——我们可以在我们的集合对象和自然数之间建立对应关系，我们可以建立更有效的算法，即我们所有的 id 都是非负整数——我们可以使用更有效的算法。

诀窍是通过以这种方式引入两个辅助数组来实现 set：

```
var naturalSet = function (arr) {
    var sparse = [];
    var dense = [];

    var contains = function (i) {
        var res = sparse[i] < dense.length && dense[sparse[i]] == i;
        return res;
    }

    var add = function (v) {
        if (!contains(v)) {
            sparse[v] = dense.length;
            dense.push(v);
        }
    }

    arr.forEach(add);

    return {
        contains: contains,
        toArray: function () {
            return dense
        },
        _getDense: function () {
            return dense
        },
        _getSparse: function () {
            return sparse
        }
    }
} 
```

然后我们可以引入带有映射到 naturalSet 的集合：

```
var set = function (arr, valueOf) {
    var natSet = naturalSet(arr.map(valueOf));
    return {
        contains: function (item) {
            return natSet.contains(valueOf(item))
        },
        toArray: function () {
            var sparse = natSet._getSparse();
            var res = natSet._getDense().map(function (i) {
                return arr[sparse[i]];
            });
            return res;
        }
    }
} 
```

最后，我们可以引入交集：

```
var intersection = function(arr1, arr2, valueOf) {
   return set(arr2.filter(set(arr1, valueOf).contains), valueOf).toArray();
} 
```

因此，依靠您正在处理的数据结构有时可以为您提供帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-29T09:29:36.953

```
without using underscorejs,
here is the pretty simple method i got solution ... 

a = [{'key':'123'},{'key':'222'},{'key':'333'}]
b = [{'key':'123'},{'key':'222'}]

var diff = a.filter(function(item1) {
  for (var i in b) {
    if (item1.key === b[i].key) { return false; }
  };
  return true;
});
console.log('result',diff) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-12T18:46:25.383

```
var a = [{'id':1, 'value':10}, {'id':2, 'value':20}];
var b = [{'id':1, 'value':10}, {'id':4, 'value':40}];

var c = _.difference(a.map(e => e.id), b.map(e =>e.id));
var array = [];
array = a.map(e => {
   if(c.includes(e.id)){
     return e;
   }
}).filter(r=>r); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-20T12:22:00.880

除非我遗漏了什么，否则不明白为什么这些答案如此复杂？

```
var a = [{'id':1, 'value':10}, {'id':2, 'value':20}];
var b = [{'id':1, 'value':10}, {'id':4, 'value':40}];

// Or use lodash _.differenceBy
const difference = (array1, array2, prop = 'id') =>
  array1.filter(item1 =>
    !array2.some(item2 =>
      item2[prop] === item1[prop],
    ),
  );

// In one array.
console.log(difference(a, b));

// Intersection.
console.log([...difference(a, b), ...difference(b, a)]);
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-17T19:21:07.313

请原谅我来晚了，但这可能会有所帮助：

```
array_of_objects = 
    // return the non-matching items (without the expected properties)
    _.difference(array_of_objects,
        // filter original list for items with expected properties
        _.where(
            // original list
            array_of_objects,
            // expected properties
            {'id':1, 'value':10}
        )
    ) 
```

# java - jar 文件启动，图像丢失

> ID：13147279
> 
> 赞同：1
> 
> 时间：2012-10-30T20:42:17.607
> 
> 标签：java, jar, image

> **可能重复：**
> [在 jar 中加载文件](https://stackoverflow.com/questions/4548699/load-file-within-a-jar)

最后，我使我的 jar 文件几乎可以正常工作。几乎，因为当我在创建 jar 文件后对其进行测试并启动时，会出现包含在存档中的图片。但是当我将 jar 文件移动到任何其他目录并尝试启动时 - 我收到有关缺少图片的异常（尽管应用程序仍在工作，但不显示该图片）。

这是它在我的目录中的样子：

```
[aqv@voland Converter]$ ll
razem 112
-rw-rw-r--. 1 aqv aqv 51673 10-30 20:42 Converter.java
-rw-rw-r--. 1 aqv aqv    23 10-30 20:41 Converter.mf
-rw-rw-r--. 1 aqv aqv  1167 10-30 20:43 GBC.java
-rw-rw-r--. 1 aqv aqv  1023 10-30 20:58 ImagePanel.java
-rw-rw-r--. 1 aqv aqv 44729 10-30 20:35 programHelp.png
-rw-rw-r--. 1 aqv aqv  3713 10-30 20:43 SettingsManager.java
[aqv@voland Converter]$ 
[aqv@voland Converter]$ 
```

图片文件从 ImagePanel 调用*，* programHelp*是*一个字符串，然后将其传递给适当的方法：

```
public ImagePanel() {

    programHelp = "programHelp.png";

    try {
        helpImage = ImageIO.read(new File(programHelp));
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

如您所见，没有指定目录，所以我猜主类应该在 jar 的主目录中查找图像，不是吗？

我通过以下方式创建 jar 文件（当然是在编译文件之后）：

```
[aqv@voland Converter]$ jar cvfm Converter.jar Converter.mf *.class *.png
[aqv@voland Converter]$ 
```

图片文件在 jar 存档中可见，在类文件中。我的问题：在这种情况下，图像文件放置有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:53:40.117

您的程序只是巧合地工作 - 它实际上是从JAR*外部加载 PNG。*如果愿意，您可以通过临时重命名图像但将 JAR 保留在目录中来测试这一点。

要从 JAR 中加载资源，您需要使用[Class 对象的 getResource() 方法之一](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getResource%28java.lang.String%29)，而不是直接加载文件。

例如，您仍然可以使用`ImageIO`从返回的流中加载数据`getResourceAsStream()`。类似于以下内容：

```
InputStream is = this.getClass().getResourceAsStream("my.png");
helpImage = ImageIO.read(is); 
```

# c++ - 每次调用函数时 C++ 新对象？

> ID：13147280
> 
> 赞同：0
> 
> 时间：2012-10-30T20:42:20.787
> 
> 标签：c++, instance

我想要的是一个函数，每次我调用它时都会创建一个新的不同实例（使用不同的名称......）

像这样：

```
void person::new_person(){
  person *(id+index) = new person(name_temp, age_temp, quote_temp);
} 
```

但它不起作用......我不知道我应该怎么做......（每次创建新实例时索引都会加一）。我意识到每次我做一个指针并在上面添加空格，就像这样：

```
int*p;
*(p+1) = 5; 
```

它可以编译，但在运行时会冻结（我认为它不允许获取内存），因此“person *（id + index）”可能也不起作用。你怎么看？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T20:53:35.950

尝试将您`person`的 s 保存在标准容器中：

```
std::vector<person> people;
void person::new_person(std::string name, int age, std::string quote){
      people.push_back(person(name, age, quote));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T20:53:09.327

你的意思是这样的？

```
#include <string>

person make_person()
{
    static unsigned i = 0;
    return person(std::to_string(i++));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T21:07:58.610

> “我想要的是一个函数，每次我调用它时都会创建一个新的不同实例（使用不同的名称......）”

这被称为**构造函数**，它是一种特殊的成员函数，与类同名。它没有函数结果类型，甚至没有`void`. 它可以是这样的：

```
class Person
{
private:
    string name_;

public:
    Person( string name )
        : name_( name )
    {}
}; 
```

然后有多种方法可以调用它，具体取决于您希望将新实例存储在哪里。例如，

```
int main()
{
    Person a( "A" );    // Local variable
    Person( "B" );      // A temporary, it's already destroyed... ;-)
    vector< Person > v;
    v.emplace_back( "C" );    // As a new item at the end of vector.
} 
```

加上一些，但我想上面的三种方式对一个完整的初学者来说是最相关的。

请注意，对于向量，每次您`push_back`或`emplace_back`您创建一个新的最后一个项目时，都会使用新的索引。调用该`size`方法以找出向量中当前有多少项。*查看文档*以获取更多信息。

顺便说一句，你真的应该给自己买一本教科书。

# razor - 如何根据值更改图表的主题？

> ID：13147285
> 
> 赞同：1
> 
> 时间：2012-10-30T20:42:34.107
> 
> 标签：razor, graph, charts, webmatrix

使用 WebMatrix 和 razor (cshtml)

我有一个图表，但条形图是默认的蓝色。我想根据它们的值（即触发值或目标值）更改它们的颜色。

我该怎么做呢？我有一个使用以下代码的图表：

```
var db = Database.Open("data");
var itot = db.QueryValue("SELECT COALESCE(SUM(SUBTOTAL),0) from dbo.DR_TRANS where         TRANSDATE = datediff(d,0,getdate()) and transtype = 1 and SUBTOTAL >0") ?? 0;
var ctot = db.QueryValue("SELECT COALESCE(SUM(SUBTOTAL),0) from dbo.DR_TRANS where     TRANSDATE = datediff(d,0,getdate()) and TRANSTYPE = 1 and SUBTOTAL <0") ?? 0;
var itotnn = itot ?? 0;
var ctotnn = ctot ?? 0;
var nett = itotnn + ctotnn ?? 0;
var myChart = new Chart(width: 160, height: 500)
.AddTitle("Sales")
.AddSeries(
    name: "Today",
    xValue: new[] { "Actual", "Target" },
    yValues: new[] { nett, 18200 })
.Write();` 
```

# javascript - JSLint “eval 是邪恶的”。备择方案

> ID：13147289
> 
> 赞同：12
> 
> 时间：2012-10-30T20:43:00.540
> 
> 标签：javascript, eval, dry, jslint

我有一些在客户端（浏览器）和服务器（在 Java Rhino 上下文中）上运行的 JavaScript 函数。这些是小函数——基本上是定义良好且不依赖全局变量或闭包的小验证器——自包含且可移植。

这是一个例子：

```
function validPhoneFormat(fullObject, value, params, property) {
    var phonePattern = /^\+?([0-9\- \(\)])*$/;
    if (value && value.length && !phonePattern.test(value))
        return [ {"policyRequirement": "VALID_PHONE_FORMAT"}];
    else
        return [];
} 
```

为了保持干燥，我的服务器代码获取每个函数的句柄并调用它们的 toString()，将它们作为 JSON 对象的一部分返回给浏览器。像这样的东西：

```
 { "name" : "phoneNumber",
        "policies" : [ 
            { "policyFunction" : "\nfunction validPhoneFormat(fullObject, value, params, property) {\n    var phonePattern = /^\\+?([0-9\\- \\(\\)])*$/;\n    if (value && value.length && !phonePattern.test(value)) {\n        return [{\"policyRequirement\":\"VALID_PHONE_FORMAT\"}];\n    } else {\n        return [];\n    }\n}\n"
            }
          ]
      } 
```

然后，我的浏览器 JS 代码接受此响应并在该上下文中创建此函数的实例，如下所示：

```
eval("var policyFunction = " + this.policies[j].policyFunction);

policyFailures = policyFunction.call(this, form2js(this.input.closest("form")[0]), this.input.val(), params, this.property.name)); 
```

这一切都很好。但是，然后我通过 JSLint 运行这段代码，我得到了这条消息：

*[错误] ValidatorsManager.js:142:37:eval 是邪恶的。*

我经常意识到 eval 可能很危险。但是，我不知道如何在不使用它的情况下实现这样的机制。有什么办法可以做到这一点并通过 JSLint 验证器？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-30T20:51:56.423

我不会担心，因为您只是将这些函数字符串从服务器传递到客户端，因此可以控制要评估的内容。

另一方面，如果你走另一个方向并在服务器上对客户端传递的代码进行评估，那将是一个完全不同的故事......

**更新：**

由于在您的评论中禁用验证选项可能会导致您错过未来的错误，我建议您传递函数名称而不是整个函数，并将函数库镜像到服务器和客户端。因此，要调用该函数，您将使用以下代码：

```
var policyFunction = YourLibraryName[this.policies[j].policyFunctionName];
var policyArguments = this.policies[j].policyArguments;

policyFunction.apply(this, policyArguments); 
```

**更新 2：**

我能够使用 JSLint 成功验证以下代码，这基本上允许您在`eval`适当的情况下“关闭”绝大多数情况下的验证。同时，JSLint 仍然验证正常`eval`调用，并且该方法的所有使用都应该为未来的开发人员抛出标志，以避免使用它/在可能的情况下/在时间允许的情况下将其重构出来。

```
var EVAL_IS_BAD__AVOID_THIS = eval;
EVAL_IS_BAD__AVOID_THIS(<yourString>); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T20:58:20.587

不要将函数编码为 JSON 中的字符串。JSON 用于内容，您将其与行为混淆。

相反，我想你可以返回 JS 文件，它允许*真正的*功能：

```
 { name : "phoneNumber",
    policies : [ 
        { policyFunction : function() {
              whateverYouNeed('here');
          }
        }
      ]
  } 
```

但是，虽然这解决了技术问题，但它仍然不是一个好主意。

* * *

这里*真正的解决方案*是将您的逻辑完全移出您的内容。`dataType`导入一个包含小验证功能的 JS 文件，并根据您的 JSON 中的属性或其他内容根据需要调用它们。如果此功能如您所说的那样小巧便携，那么这应该是微不足道的。

让你的数据与你的代码纠缠在一起通常会导致痛苦。您应该静态地包含您的 JS，然后动态地请求/导入/查询您的 JSON 数据以通过您的静态包含的代码运行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-30T20:57:32.160

我会避免在所有情况下使用 eval 。没有理由你不能围绕它进行编码。无需将代码发送到客户端，只需将其托管在服务器上的一个包含的脚本文件中即可。

如果这不可行，您还可以拥有一个动态生成的 javascript 文件，然后通过响应传入必要的参数，然后在客户端动态加载脚本。真的没有理由使用 eval。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T20:52:10.217

您可以使用

```
setInterval("code to be evaluated", 0); 
```

在内部，如果您将 setInterval 传递给一个字符串，它会执行类似于 eval() 的功能。

不过，我不会担心的。如果您知道 eval() 是邪恶的，并采取适当的预防措施，那并不是真正的问题。eval 类似于 GoTo；你只需要小心并意识到你在做什么才能正确使用它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T22:20:01.497

只需很少的解析，您就可以像这样：

```
var body = this.policies[j].policyFunction.substr;
body = body.substr(body.indexOf("(") + 1);
var arglist = body.substr(1, body.indexOf(")"));
body = body.substr(arglist.length + 1);
var policyFunction = new Function(arglist, body); 
```

这将提供一些验证，避免直接使用`eval`代码并与代码同步工作。但它肯定`eval`是变相的，而且很容易受到 XSS 攻击。如果恶意的人可以通过这种方式加载和评估他们的代码 - 它不会拯救你。所以，真的，不要这样做。添加`<script>`带有正确 URL 的标签，这肯定会更安全。好吧，你知道，最好安全而不是抱歉。

PS。如果上面的代码不起作用，我深表歉意，它只显示了意图，我没有测试它，如果我在计算括号或类似的错误时犯了错误 - 好吧，你应该明白了，我不是在做广告无论如何。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-20T21:41:07.073

DRY 绝对是我同意的，但是在某种程度上，复制+粘贴比引用同一段代码更有效且易于维护。

您无需编写的代码似乎相当于一个干净的界面和简单的样板。如果服务器和客户端都使用相同的代码，您可以简单地传递函数的公共部分，而不是整个函数。

```
Payload:
{
    "name": "phoneNumber",
    "type": "regexCheck",
    "checkData": "/^\\+?([0-9\\- \\(\\)])*$/"
} 
```

```
if(payload.type === "regexCheck"){
    const result = validPhoneFormat(fullObject, value, payload.checkData)
}

function validPhoneFormat(fullObject, value, regexPattern) {

    if (value && value.length && !regexPattern.test(value))
        return [ {"policyRequirement": "VALID_PHONE_FORMAT"}];
    else
        return [];
} 
```

这将使您能够从单个位置更新正则表达式。如果界面发生变化，它确实需要在 2 个地方进行更新，但我不认为这是一件坏事。如果客户端正在运行代码，为什么要隐藏结构？

如果您真的非常想将对象结构和模式都保存在一个地方 - 将其提取到单个 API。有一个“ValidatePhoneViaRegex”api 端点，您将传递此序列化函数的所有地方都会调用该端点。

如果所有这些看起来都太费力了，请将 jslint 设置为忽略您的代码：

“在 JSHint 1.0.0 及更高版本中，您可以使用特殊选项语法忽略任何警告。此警告的标识符是 W061。这意味着您可以告诉 JSHint 不要使用 /*jshint -W061 */ 发出此警告指示。

在 ESLint 中，产生这个警告的规则被命名为 no-eval。您可以通过将其设置为 0 来禁用它，或者通过将其设置为 1 来启用它。”

[https://github.com/jamesallardice/jslint-error-explanations/blob/master/message-articles/eval.md](https://github.com/jamesallardice/jslint-error-explanations/blob/master/message-articles/eval.md)

我更愿意看到复制+粘贴的代码，一个通用的 api，或者接收参数和复制+粘贴的样板，而不是从服务器传入要执行的神奇函数。

如果您在使用这些共享功能之一时遇到跨浏览器兼容性错误，会发生什么情况？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-30T20:55:05.477

嗯，首先要记住的是，jsLint 确实指出“它会伤害你的感情”。它旨在指出您没有遵循最佳实践的地方——但不完美的代码仍然可以正常工作；没有强迫您遵循 jsLint 的建议。

话虽如此， eval*是*邪恶的，几乎在所有情况下，总有办法使用它。

在这种情况下，您可以使用诸如 require.js、yepnope.js 之类的库或其他旨在单独加载脚本的库。这将允许您动态包含您需要的 javascript 函数，但不必包含`eval()`它们。

可能还有其他几种解决方案，但这是我想到的第一个。

希望有帮助。

# linux - 在内存数据库中嵌入 HSQL 的 Spring DataSource 和 Linux 上的休眠创建-删除排序

> ID：13147292
> 
> 赞同：0
> 
> 时间：2012-10-30T20:43:17.030
> 
> 标签：linux, spring, hibernate, hsqldb, sessionfactory

我正在使用带有注释的 Spring 3.1 创建一个使用嵌入式 HSQL 的 DataSource。

```
@Bean
public DataSource dataSource() throws Exception {
    EmbeddedDatabaseFactoryBean bean = new EmbeddedDatabaseFactoryBean();
    bean.setDatabaseType(EmbeddedDatabaseType.HSQL);
    bean.afterPropertiesSet();
    DataSource object = bean.getObject();
    return object;
} 
```

我也在像这样配置一个 SessionFactory

```
@Bean
public SessionFactory sessionFactory() {
    SessionFactory sessionFactory = new LocalSessionFactoryBuilder(dataSource)
        .setNamingStrategy(namingStrategy())
        .addProperties(hibernateProperties)
        .addAnnotatedClass(Some.class)
        .buildSessionFactory();
    logger.info("Created session factory: " + sessionFactory + " with dataSource: " + dataSource);
    return sessionFactory;
} 
```

问题是，如果我使用填充数据库的@Component 创建其他一些 bean，SQL 脚本将失败，因为尚未创建数据库。我的 hibernate.properties 包含以下行来生成 DDL

```
properties.put("hibernate.hbm2ddl.auto", "create-drop"); 
```

所以这是bean创建的某种排序问题。然而，这个问题只发生在 Linux (Kubuntu 12.04) 而不是 Windows 7！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T13:54:04.207

我已经解决了在填充数据库的@Component bean中我必须像这样添加@DependsOn注释

```
@Component
@DependsOn({"dataSource", "sessionFactory"})
public class DevSqlPopulator {
 ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:27:31.550

我认为问题在于您自己调用`InitializingBean`方法`afterPropertiesSet`方法，而不是在所有属性都设置好后让 Spring 调用它。尝试这样做：

```
@Bean
public EmbeddedDatabaseFactoryBean dataSource() throws Exception {
    EmbeddedDatabaseFactoryBean bean = new EmbeddedDatabaseFactoryBean();
    bean.setDatabaseType(EmbeddedDatabaseType.HSQL);
    return bean;
} 
```

现在它是一个干净的工厂 bean，Spring 将负责生命周期的其余部分。

# java - 在 WS02 身份服务器中使用 SCIM

> ID：13147297
> 
> 赞同：1
> 
> 时间：2012-10-30T20:43:40.990
> 
> 标签：java, wso2, identity, wso2is

我已经下载了 WS02 Identity Server（版本 3.2.3）并将其安装在 Windows 上。我想探索 WS02 IS 提供的 SCIM 支持。但是，我找不到任何关于它的信息。是否有开发人员指南提供有关 WS02 IS 为 SCIM 公开的 SOAP/REST 端点的更多详细信息？

我已经阅读了 WS02 IS 的文档，但它更像是一个管理员/用户指南。

我正在寻找有关如何在 WS02 IS 中使用 SCIM 支持来管理用户和组的更多详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T08:04:40.827

wso2 网站上有一个演示文稿“使用 SCIM 标准化身份供应”可能会有所帮助：[link](http://wso2.org/library/webinars/2012/01/standardizing-identity-provisioning-scim)。

我认为这是相同的演示文稿，但在[youtube上](http://www.youtube.com/watch?v=3cYuMZaEddQ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:46:08.350

SCIM 支持仅适用于 WSO2 Identity Server 4.0.0。

# ios - 哪个版本的 UUID 将 0 作为第 3 部分的第一个字符？

> ID：13147298
> 
> 赞同：0
> 
> 时间：2012-10-30T20:43:46.517
> 
> 标签：ios, version, uuid

我有一个看起来像这样的 UUID：d30d7840-8f7f-012f-e231-1231390f85a2。

这是哪个版本/类型的 UUID？我正在查看版本位（第 3 部分的第一个字符），但无法确定如何用零来识别它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:50:00.680

[此处介绍了](http://en.wikipedia.org/wiki/Universally_unique_identifier#Variants_and_versions)UUID*变*体和*版本*。

*Variant*实际上是“父”概念，UUID 规范目前只指定了一个变体。

此 UUID 似乎没有使用公开指定的*变体*，因为第四组开头的十六进制数字是`e`（而不是`8`、`9`、`a`或`b`）。您假设的版本数字（第三组）在这里实际上没有意义，因为变体是未知的。

根据[UUID 上的 RFC 4122](http://www.ietf.org/rfc/rfc4122.txt)，您的变体代码只是“为将来定义保留”。它可能只是一串随机数字。

# jquery - jQuery JSON AJAX 请求失败

> ID：13147300
> 
> 赞同：2
> 
> 时间：2012-10-30T20:43:50.537
> 
> 标签：jquery, ajax, json

```
$(document).ready(function() {
    $.ajax({
        type: 'GET',
        url: "http://www.google.com/ig/calculator?hl=en&q=1GBP=?USD",
        dataType: "json"
    }).done(function() {
        alert("success");
    }).fail(function() {
        alert('fail');
    });
});​ 
```

我是新手，所以请有人告诉我为什么会失败？在萤火虫中，我得到了“200 OK”的请求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:47:47.477

除非发出 ajax 请求的脚本是从 www.google.com 加载的，否则您不能向 www.google.com 发出 ajax 请求。它被称为[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。浏览器不会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:48:47.737

您正面临“跨域”请求异常。

这是大量相关主题之一：[跨域异常](https://stackoverflow.com/questions/4932779/cross-domain-exception)

# build - Cloudbees 支持用于构建的 redis 服务器吗？

> ID：13147302
> 
> 赞同：0
> 
> 时间：2012-10-30T20:43:51.347
> 
> 标签：build, jenkins, redis, cloudbees

我正在尝试在 Cloudbees 中设置一些 OSS 构建，其中一个需要 redis 服务器来进行构建期间执行的测试。

Cloudbees下的Jenkins构建过程是否以某种方式支持这一点，还是我必须找到另一种方法来设置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:49:15.417

您可以在构建开始时启动 redis 服务器。

```
redis-server & 
```

可以找到当前安装的 redis 版本（它是一个打包的 Redis，因此 cli 和服务器的版本通常匹配）使用

```
redis-cli -v 
```

此信息现在也可在 CloudBees 开发者网站上找到 - [http://developer.cloudbees.com/bin/view/DEV/Redis](http://developer.cloudbees.com/bin/view/DEV/Redis)

# wordpress - WordPress：防止缓存tinymce的自定义按钮？

> ID：13147309
> 
> 赞同：2
> 
> 时间：2012-10-30T20:44:10.687
> 
> 标签：wordpress, tinymce

我正在关注[本教程](http://brettterpstra.com/adding-a-tinymce-button/)，了解如何在 WordPress 中向 TinyMCE 编辑器添加自定义按钮。试图编辑作者的 JS 以包含我的功能，但它似乎已被缓存。文章作者有一个 hack（下面的代码片段），它确实是第一次工作（按钮现在在工具栏中），尽管它不适用于后续刷新。

```
// "This will intercept the version check and increment the current version number by 3.
// It's the quick and dirty way to do it without messing with the settings directly..."
function my_refresh_mce($ver) {
  $ver += 3;
  return $ver;
}

add_filter( 'tiny_mce_version', 'my_refresh_mce'); 
```

我该怎么做才能**禁用此缓存**？

最新的全新 WordPress localhost 安装，未激活任何插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:05:39.193

原来“没有激活插件”是不够的。一旦我进行了全新安装（**没有**W3 Total Cache 插件），问题就消失了。

# css - 为什么 table::after 元素是在 table > td 元素之后创建的，而不是 table 元素？

> ID：13147318
> 
> 赞同：0
> 
> 时间：2012-10-30T20:45:07.747
> 
> 标签：css, pseudo-element, css-tables

我尝试在表格后添加点，方法是使用`table::after`选择器创建一个点元素并将其居中`margin: 5px auto 5px auto;`。它有效，但似乎在第一个表格列之后添加了点，而不是在表格本身之后：

![在此处输入图像描述](../Images/a099acaff923a000975df4186a811bba.png)

为什么以及如何解决它？

实时代码[http://cssdeck.com/labs/ew6g4ntf/0](http://cssdeck.com/labs/ew6g4ntf/0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:59:27.530

这是一种有点奇怪的方法，但是按照您的解决方案，这可能是因为表格在单元格的基础上工作得最好。这就是为什么 table::after 也类似于单元格的原因。

但是，如果你把这整个东西放在一个 div 中，然后你把它浮动到左边，然后你用 div 而不是 table 来做这个 ::after 事情，它会很好用。

[这是一个预览](http://cssdeck.com/labs/xkpiu16b/0)

# c# - 更改列表框背景颜色

> ID：13147322
> 
> 赞同：1
> 
> 时间：2012-10-30T20:45:33.220
> 
> 标签：c#, listbox

> **可能重复：**
> [列表框项目的背景颜色（winforms）](https://stackoverflow.com/questions/91747/background-color-of-a-listbox-item-winforms)

我有一个 ListBox，对于每个坐标，我需要有不同的颜色。前任。

```
23,34 //red background
56,78 //green background
90,2 // yellow background 
```

代码：

```
 for (int i = 0; i < il_kl; i++)
        {
            int il_pkt = Klastry[i].Punkty.Count;
            string color = lista_kolor[i]; 
            Brush mybrush = (Brush)new BrushConverter().ConvertFromString(color);

            for (int j = 0; j < il_pkt; j++)
            {
                x = Klastry[i].Punkty[j].X;
                y = Klastry[i].Punkty[j].Y;

                _mn.kolekcje_wsp.Items.Add(x + " , " + y);
                _mn.kolekcje_wsp.Foreground = mybrush;

            }

        } 
```

我现在正在使用`Foreground`，但是如何更改`Background`每个坐标的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:05:16.513

您可以尝试以下方法，看看它是否适合您

可能实现这一点的唯一方法是自己绘制项目。

将 DrawMode 设置为 OwnerDrawFixed

并在 DrawItem 事件上编写如下代码：

```
private void listBox_DrawItem(object sender, DrawItemEventArgs e)
{
    e.DrawBackground();
    Graphics myCustomGraphic = e.Graphics;
    myCustomGraphic.FillRectangle(new SolidBrush(Color.Yellow), e.Bounds);
    // Print text
    e.DrawFocusRectangle();
} 
```

# javascript - 为什么`Array.length`、`Function.length`、`String.length`等返回1？

> ID：13147326
> 
> 赞同：3
> 
> 时间：2012-10-30T20:45:49.497
> 
> 标签：javascript

昨天在教我的 JavaScript 课程时，我和我的学生遇到了一些有趣的功能，我认为这些功能可能值得在一个问题和我得到的答案中记录下来。

`Array.length`在 chrome 中的 JS 控制台中键入返回`1`.

同样，`Function.length`返回`1`. 这很重要，因为：

> JavaScript 中的每个函数实际上都是一个 Function 对象。[（MDN JS 参考：函数）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function)

因此，`Object.length`很可能所有其他本机对象都将并且应该`1`作为`length`属性的值返回。

那么，最后*为什么*会发生这种行为？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T20:45:49.497

`Function.length`本身就是答案：

> 指定函数期望的参数数量。[MDN JS 参考：Function.length](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/length)

当我们编写时，`Function.length`我们要求`Function`构造函数告诉我们正式的命名参数的数量（“可选” - 即非正式的 - 参数通过`arguments`函数体中的属性访问）。因为`Function`构造函数需要 1 个正式的命名参数，所以结果是`1`：

```
new Function ([arg1[, arg2[, ... argN]],] functionBody) 
```

`functionBody`是单个正式命名参数。因此`Function.length`是`1`。

# entity-framework - 如何使用 DotConnect for PostgreSQL 查询实体框架实体的空字段值

> ID：13147330
> 
> 赞同：1
> 
> 时间：2012-10-30T20:46:09.777
> 
> 标签：entity-framework, postgresql, devart, dotconnect

在使用 Devart DotConnect for PostgreSQL 连接器查询实体框架实体的空字段时，我观察到一种奇怪的行为。

例如：如果我进行了以下 2 个测试：

```
var test1 = context.bloc.Where(x => x.id_bloc == null);

var test2 = context.bloc.Where(x => x.id_bloc == 100);

```

检查 EF 自动生成的 SQL 查询时，我得到以下结果：

测试1的结果：

```
{选择
 CAST（NULL AS int）作为“C1”，
 CAST（NULL AS varchar）作为“C2”，
 CAST（NULL AS varchar）作为“C3”，
 CAST（NULL AS varchar）作为“C4”
从（选择 1 作为 X）作为“SingleRowTable1”
哪里真=假}

```

测试2的结果：

```
{选择
"Extent1".id_bloc,
"Extent1".numero,
"Extent1".nom,
"Extent1". 滴度
FROM “角色”.bloc AS “Extent1”
其中“Extent1”.id_bloc = 100}

```

查询空字段时的结果很奇怪......我期待的结果类似于测试 2 的结果，但带有`"Extent1".id_bloc IS NULL`WHERE 子句......

它是一个错误吗？如何有效地查询空字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T09:58:49.767

id_bloc 属性是否使用 Entity Key 属性定义？如果是，则正确生成结果 SQL。

实体键不能为空，这就是实体框架避免对表的不必要请求的原因：生成假 SQL，它给出相同的空结果集但不占用服务器资源。

您可以使用 SQL Server（通过 System.Data.SqlClient）检查行为 - 它必须相同。

# java - Android如何在使用惰性列表时获得缓存文件的总大小？

> ID：13147332
> 
> 赞同：1
> 
> 时间：2012-10-30T20:46:16.950
> 
> 标签：java, android, file, caching, lazylist

我试图编写一种智能方式，让我的应用程序可以检查其缓存的当前大小，以便如果缓存增长到超过 1gb，它可以自行删除图像，这是 android 所说的缓存大小应该保持在以下，但是使用 3 种方法我在文档中发现我正在努力在`File()`课堂上找到一个可以准确读取当前大小的内容，我能找到的最好的结果是，`getUsableSpace()`但是这给出了关于实际大小的不准确读数剩余的缓存大小确实是，其他两种似乎相关的方法`getFreeSpace()`是`getTotalSpace`，但是当我运行应用程序时，这两个总数似乎都没有改变它们的值，以前有没有人做过这样的事情？我只需要弄清楚我的应用程序是否使用了超过 1gb 的空间，以便我可以清除缓存

# php - 使用 ftp_put 代替 move_uploaed_files 是否安全

> ID：13147334
> 
> 赞同：0
> 
> 时间：2012-10-30T20:46:30.130
> 
> 标签：php, upload, ftp

在我的服务器上，我根本无法在 PHP 中使用 move_uploaded_files 函数，它给了我一个权限被拒绝的警告。尝试删除文件时，我收到相同的警告。我设法使用 FTP 函数 ftp_delete 和 ftp_rmdir 更改删除脚本。

所以现在我想知道，使用 ftp_put 进行文件上传是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:01:10.863

如果您确定您要移动的文件是用户上传的文件，那么可以。

为了安全起见，最好有可写的临时文件夹，您可以在其中移动上传的文件，在需要时对其进行处理，使用 ftp 上传到具有适当权限的适当位置，并从临时文件夹中删除。

# c# - Mono 启动进程 mdtool 关闭调用者

> ID：13147337
> 
> 赞同：0
> 
> 时间：2012-10-30T20:46:31.693
> 
> 标签：c#, mono, mdtool

在 Mono/OSX 上的控制台应用程序中，我想调用 mdtool 来构建 iOS 项目。我成功地拥有了正确的命令行参数，并且它在 bash shell 脚本中正确运行。

现在，如果我在控制台应用程序中使用 Process/ProcessStartInfo 类调用它，那么在构建之后我得到了这个并且我的程序退出了。

```
Press any key to continue... logout

[Process completed] 
```

这是调用 mdtool 的代码：

```
var buildArgs = string.Format("...");

var buildiOSproject = new ProcessStartInfo
{
    FileName = "/Applications/MonoDevelop.app/Contents/MacOS/mdtool",
    UseShellExecute = false,
    Arguments = buildArgs
};
var exeProcess = Process.Start(buildiOSproject);
exeProcess.WaitForExit();
//code here never called 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T14:05:08.157

我在 Xamarin 论坛 (http://forums.xamarin.com/discussion/267/calling-mdtool-trough-processstartinfo#latest) 上得到了答案，但调试器似乎有问题，所以我关闭了“在外部运行我的项目选项中的控制台“属性，它现在正在工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-24T22:02:26.633

尝试将以下内容添加到您的 StartInfo 初始化程序。当另一个工具退出时，我遇到了同样的问题。虽然我已经使用了 RedirectStandardOutput 和 RedirectStandardError，但我也只是在添加了 RedirectStandardInput 之后才修复它。

```
 buildiOSproject.StartInfo = new ProcessStartInfo
            {
...
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                RedirectStandardInput = true,
...
            } 
```

# java - BinarySearchingTree - dll(generic) ，不知何故我的项目无法添加到我的广告中

> ID：13147338
> 
> 赞同：0
> 
> 时间：2012-10-30T20:46:42.180
> 
> 标签：java, generics, adt, doubly-linked-list

我在徘徊我做错了什么，有人可以帮助我吗？我正在尝试使用 DDL（双向链表）数据结构制作通用 BST。问题是我的 ADT 已初始化，因为我的`isEmpty`方法有效，但我的`public addNewElement`which sue`private insert`不起作用。欢迎任何帮助和建议。

界面：

```
public interface SortedSetBST <type> extends Iterable<type>{
            void addNewElement(Comparable<type> newElement);

    } 
```

ADT：

```
package adt;

import java.util.Iterator;
import java.util.Iterator;

import interfaces.SortedSetBST;
import exceptions.*;

public class BinarySearchTree <type> implements SortedSetBST<type> {
    BinaryNode <type> root;
    int size;

    @Override
    public void addNewElement(Comparable  <type>  newElement) {
         insert(newElement, root);  
    }

protected BinaryNode  <type> insert( Comparable <type> x, BinaryNode <type>  t ) {
   if( t == null )
       t = new BinaryNode( x );
   else if( x.compareTo( t.element ) < 0 )
       t.left = insert( x, t.left );
   else if( x.compareTo( t.element ) > 0 )
       t.right = insert( x, t.right );
   else
       throw new DuplicateItemException( x.toString( ) );  // Duplicate
   return t;
}
class BinaryNode<type> {
    type element;      // The data in the node
    BinaryNode<type> left;         // Left child
    BinaryNode<type> right;        // Right child

    // Constructors
    BinaryNode( type theElement ) {
        element = theElement;
        left = right = null;
    }   
} 
```

类应用

```
public class App {
    public static void main(String [] args){
        System.out.println("   Main:");
        BinarySearchTree <String> db = new BinarySearchTree<String>();

        if(db.isEmpty() == true){
            System.out.println(".db empty!");
        }
        db.addNewElement("unu");
        db.addNewElement("doi");
        db.addNewElement("trei");
        System.out.println(db.getSize());
    }
} 
```

输出：

```
 Main:
.db empty!
0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:19:15.730

这很清楚。

在“插入”中，您正在检查 t 是否为空。如果是这种情况，您可以使用 BinaryNode 的实例初始化*参数*t ，并认为在第一次传入“null”时也会更新 root 。但是“null”在 Java 中是“null”，而不是您可能认为的 C 样式地址！

然后您返回此参数，但返回值在“addNewElement”中丢失。

如何正确执行此操作：

```
if( t == null ) {
   if (root == null){
      root = new BinaryNode(x);
      return root;
   } else {
      t = new BinaryNode( x );
   }
} 
```

# .net - Linq 到实体 DefaultIfEmpty

> ID：13147341
> 
> 赞同：1
> 
> 时间：2012-10-30T20:47:19.867
> 
> 标签：.net, linq, entity-framework-4

我正在使用 EF 4 到 PostgreSQL 使用 3rd 方 ADO.NET 提供程序。在我的数据源中，我没有与基于此连接条件的项目匹配的项目行。出于这个原因，我希望查询 1 基于空引用异常而失败。但是，它完成并为我提供了 il 上每个属性的值类型默认值。item_display_name 是一个字符串，因此 ilName 设置为空。ilStartDate 设置为 DateTime 的默认值。x.il.item_id 和 x.il.item_line_no 都是 0。

```
var query1 =
                    _db.items
                      .GroupJoin(_db.item_line.Where(x => x.start_date == selectedStartDate), x => x.item_id, il => il.item_id, (x, ilgroup) => new { x, ilgroup })
                      .SelectMany(x => x.ilgroup.DefaultIfEmpty(), (x, il) => new { x.x, il })
                      .Select(x =>
                          new
                              {
                                    itemId = x.x.item_id,
                                    ilName = x.il.item_display_name,
                                    ilStartDate = x.il.start_date,
                                    ilItemId = x.il.item_id,
                                    orderLine = x.il.item_line_no}); 
```

但是，如果我通过在 Select 之前对结果调用 ToArray 来强制执行，则会得到空引用异常。

```
var query2 =
                _db.items
                    .GroupJoin(_db.item_line.Where(x => x.start_date == selectedStartDate), x => x.item_id, il => il.item_id, (x, ilgroup) => new {x, ilgroup})
                    .SelectMany(x => x.ilgroup.DefaultIfEmpty(), (x, il) => new {x.x, il}).ToArray()
                    .Select(x =>
                            new
                                {
                                    itemId = x.x.item_id,
                                    ilName = x.il.item_display_name,
                                    ilStartDate = x.il.start_date,
                                    ilItemId = x.il.item_id,
                                    orderLine = x.il.item_line_no}); 
```

据我了解， DefaultIfEmpty 应该返回该类型的默认值。我的类型显然是引用类型，那么为什么查询 1 不会失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:53:05.127

这是因为第一个查询完全翻译成 SQL。当涉及到空“对象”时，SQL 与 C# 不同。在 SQL 中，编写类似的东西是完全可以的

```
SELECT o.Date, ol.Number FROM Order o LEFT JOIN OrderLine ol ON ... (etc.) 
```

有`Order`s 没有`OrderLine`s 不会崩溃。这里没有空引用异常`ol`。`ol.Number`SQL 只为缺少订单行的地方输出空值。

所以在第**一个**语句中，匿名类型是直接从 SQL 获得的值构建的。整个表达式`x.il.item_display_name`由 a 的输出填充，当 no存在`DbDataReader`时为 null 。`ilgroup`

在**第二个**语句中，首先在内存中构建一个对象数组，由`x`和`il`对组成，其中一些没有`il`（`il`为空）。现在匿名类型是从对象数组构建的，并且表达式`x.il.item_display_name`尝试`item_display_name`从一些不存在的对象中读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:53:01.090

这是实体框架的一个棘手特性。当您执行整个查询时，您实际上并没有访问数据库。EF 只会在您执行 ToArray、ToList 等操作时进入数据库...

在第一个查询中，如果您将 ToArray() 放在末尾，您应该会获得 NullReference。虽然您实际上并没有执行 ToArray，但您只会在执行 ToList() 或 ToArray() 时构建要运行的查询。

看看这篇文章：[我在访问数据库吗？](http://www.singingeels.com/Blogs/Nullable/2008/08/04/LINQ_to_SQL__Am_I_Hitting_The_Database.aspx)

# c# - C# 覆盖默认的 ContextMenu 样式 (WPF)

> ID：13147344
> 
> 赞同：2
> 
> 时间：2012-10-30T20:47:25.600
> 
> 标签：c#, wpf, contextmenu

我在尝试更改 WPF 中默认 ContextMenu 的样式时遇到问题。我不想覆盖 de ContextMenu，我只是想覆盖 ContextMenu STYLE。在所有站点中，都说我必须创建 ContextMenu 的每个 MenuItem，但我想使用默认的 MenuItems，并且只更改样式并在背景中添加边框。我该怎么做？

```
<Style TargetType="{x:Type ContextMenu}">
    <Setter Property="SnapsToDevicePixels" Value="True" />
    <Setter Property="OverridesDefaultStyle" Value="True" />
    <Setter Property="Grid.IsSharedSizeScope" Value="true" />
    <Setter Property="HasDropShadow" Value="True" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ContextMenu}">
                <Border x:Name="Border" Background="#000" BorderThickness="1">
                    <ScrollViewer x:Name="ScrollViewer">
                        <ItemsPresenter />
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:46:49.000

确保：

*   资源字典稍后在您的代码中加载而不是卸载。（据我所知，加载的资源字典列表可以在 中找到`Application.Current.Resources.MergedDictionaries`）
*   您没有在其声明中设置目标 ContextMenu 的样式或其他属性。

# jython - 无法让我的 for 循环工作

> ID：13147345
> 
> 赞同：0
> 
> 时间：2012-10-30T20:47:29.620
> 
> 标签：jython, jes

好的，所以我试图让程序执行三个步骤......

1：在（m，n）之间选择一个数字，这是传入的参数（设置为变量“repeat”）

2：从第一步中选择一个介于 0 和变量“重复”之间的随机数。（设置为变量“o”）

3：从“重复”中减去“o”并将结果设置为变量“p”

因此我得到一个数字（比如说 100）

然后是 0-100 的随机数（比如说 40）

然后我得到 100-40 (60...) 的差异

然后我希望程序运行一个for循环“o”（40）次和另一个for循环“p”（60）次......

for 循环部分的代码如下所示（请记住，在此之前还有更多代码......它与这个问题并不真正相关：

```
def randomStars(pic,m,n):

  repeat=random.randint(200,300)
  o=random.randint(0,repeat)
  p=repeat-o

  for i in o:
    star(pic,x,y)
  for j in p:
    largeStar(pic,x,y)
  show(pic) 
```

发生的事情是我在线收到一条错误消息：for i in o: 表示“迭代非序列不适当的参数类型

在设置了 3 个变量并且它们正在工作之后，我还添加了打印语句...... ex.1 repeat=230; o=103；p=127 ex.2 重复=221；o=72；p=149

然后我立即尝试让 for 循环运行“o”次，并收到上述错误消息......我不明白它是如何成为非序列的。但也许我只是不理解序列的定义

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T10:18:20.900

`o`并且`p`是整数。对于`for`循环，您需要可迭代的东西。我认为您可以将其更改为：

```
for i in range(o): 
```

[这是`range()`Python 2.x 的文档](http://docs.python.org/2/library/functions.html#range)

# mysql - SELECT * 一定年龄的用户

> ID：13147352
> 
> 赞同：6
> 
> 时间：2012-10-30T20:47:54.577
> 
> 标签：mysql, sql

在`users`表中，我有一个名为的字段`dob`，它以这种格式存储用户的出生日期：

```
1959-04-02 
```

无论如何，我想选择所有 18 岁和 19 岁的用户。这是我的查询：

```
SELECT *
FROM `users`
WHERE dob BETWEEN '1993-10-30' AND '1994-10-30' 
```

但它似乎只选择了大部分 18 岁的人和一些（但不是全部）19 岁的人。我在数据库中有一堆测试用户，18 岁和 19 岁的人数相等。然而，这个查询产生了大约 90% 的 18 岁和大约 10% 的 19 岁。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T20:50:28.053

18 至 19 岁的人包括 2 岁以上的一系列生日。您的查询仅涵盖 1 年。考虑修改你的逻辑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T21:01:55.250

我会建议类似：

```
SELECT *
FROM `users`
WHERE dob BETWEEN 
    CURDATE() - INTERVAL 18 YEAR 
    AND CURDATE() - INTERVAL 20 YEAR 
```

从技术上讲，这将包括今天年满 20 岁的人。如果您愿意，您可以将其更改`interval`为 a并更精确。`DATE_ADD`

这有点干净，因为您不需要每次都在 PHP 中重做两个生日（或者上帝保佑，手动）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-05T22:47:00.353

我没有足够的声誉来发表评论，但如果你把更大的间隔放在首位，大卫格雷尼尔的回答会起作用（正如所指出的那样，年份不是年份）

```
SELECT *
FROM `users`
WHERE dob BETWEEN 
CURDATE() - INTERVAL 20 YEAR 
AND CURDATE() - INTERVAL 18 YEAR 
```

# java - VisualVM Sampler CPU swing paint() 怪异

> ID：13147355
> 
> 赞同：0
> 
> 时间：2012-10-30T20:48:07.900
> 
> 标签：java, swing, profiling, paint, visualvm

我一直在分析我的摇摆应用程序，它是可视的并且进行了大量的重绘：通过调用重绘并在paintComponent() 中进行绘制。

我正在使用 VisualVM 并使用 Sampler 来查看哪些方法使用了大量的 cpu。

我的很多绘画方法都在列表的顶部，这并不奇怪。

但是可以看到一个奇怪的效果，每次我启动我的应用程序并启动一个 cpu 示例会话时，不同的绘制方法都位于热点的顶部。

我觉得这很奇怪，因为我在我的应用程序中使用了完全相同的数据集。

是否有可能某些东西（可能是摆动油漆模型）弄乱了 visualvm 结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:53:39.703

您必须记住，Swing 是一个事件驱动的系统。这些事件不太可能以完全相同的顺序发生。

此外，重绘管理器受操作系统支配。操作系统可能会根据自己的要求向重绘管理器发出更新其 UI 部分的请求，同样，这些不太可能每次都以完全相同的方式发生。

# mysql - SQL错误我无法弄清楚

> ID：13147356
> 
> 赞同：-5
> 
> 时间：2012-10-30T20:48:09.677
> 
> 标签：mysql

```
CREATE TABLE pa_adclicks(
bannerid mediumint( 9 ) NOT NULL default '0',
zoneid mediumint( 9 ) NOT NULL default '0',
t_stamptimestamp( 14 ) NOT NULL ,
host varchar( 255 ) NOT NULL default '',
source varchar( 50 ) NOT NULL default '',
countrychar( 2 ) NOT NULL default '',
KEY bannerid_date( bannerid, t_stamp ) ,
KEY date( t_stamp ) ,
KEY zoneid( zoneid )
) ENGINE = 'MyISAM'; 
```

MySQL 说：

> 错误#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 14 行的 '(14) NOT NULL,
> host varchar(255) NOT NULL default '',
> source varchar(50) NOT'附近使用正确的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T20:49:38.440

`t_stamp`我会再试一次 - 你在和`timestamp`之间 没有空间`t_stamptimestamp( 14 ) NOT NULL`。

# jquery - 失去布局属性，（可能）因为使用 replaceWith() 方法

> ID：13147357
> 
> 赞同：2
> 
> 时间：2012-10-30T20:48:14.747
> 
> 标签：jquery

我正在尝试制作交互式内容。在此我计划使用 replaceWith() 方法。一切都是用 jQueryMobile 制作的，所以它已经有了一个默认布局。问题是，当我使用 replaceWith() 方法时，似乎没有调用这些布局属性。

我想知道我做错了什么。

编码：

```
 function viewNews(){
    $('#newsPage').replaceWith('<div data-role="content" id="newsPage"><ul data-role="listview" data-filter="true" id="articleList"><li></li></ul></div>');

    for(var i = 2; i<=maxLength; i++) {
        $('#articleList li:last').after('<li id="list' + i + '"><a style="font-size: x-small" href="#article' + i + '">'+ storedTitles[i] +'</a></li>');
enter code here}
}

//======= NEWS OVERVIEW PAGE ========
document.write(
  ' <div data-role="page" id="news">' +
  '     <div data-role="header" data-position="fixed">' +
  "         <h1>What's on Xiamen</h1>" +
  '         <a data-role="button" data-icon="refresh" class="ui-btn-right" data-iconpos="notext" onClick="refresh()">Refresh</a>' +
  '     </div>' +
  '     <div data-role="content" id="newsPage">' +
  '         <ul data-role="listview" data-filter="true" id="articleList">'
);
for(var i=1; i<=maxLength; i++){
 document.write(
  '             <li id="list' + i + '"><a style="font-size: x-small" href="#article' + i + '">'+ storedTitles[i] +'</a></li>'
  );
}
document.write(
  '         </ul>' +
  '     </div>' +
  '     <div data-role="footer" data-id="foo1" data-position="fixed">' +
  '     <div data-role="navbar">' +
  '      <ul>' +
  '         <li><a href="#news" data-back="true" class="ui-btn-active ui-state-persist">News</a></li>' +
  '         <li><a href="#profile" >Profile</a></li>' +
  '         <li><a href="#friends" >Friends</a></li>' +
  '         <li><a href="#settings" >Settings</a></li>' +
  '      </ul>' +
  '     </div>' +
  '     </div>' + 
  ' </div>'
); 
```

实际上，底部是先完成的。viewNews() 函数在另一个函数 refresh() 中被调用，该函数由按下按钮触发。它功能完美，正是我想要的，但它看起来不像我想要的......所以在功能上，没有问题。

希望你看看有什么问题！谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:52:59.267

我只是替换`div`标签内的html（否则它看起来是圆形的）：

```
$('#newsPage').html('<ul data-role="listview" data-filter="true" id="articleList"><li></li></ul>').trigger( 'updatelayout' ); 
```

**编辑：**尝试添加`trigger('updatelayout')`. 从您的问题来看，Jquery Mobile 似乎没有`data-xxxx`在修订中侦听属性。

如果`trigger('updatelayout')`效果很好，如果不是，您可以通过单独更新元素的内容来测试我的预感，`<li>`看看它们是否保持初始化的方式。

# java - 亚马逊 SWF @Signal

> ID：13147359
> 
> 赞同：1
> 
> 时间：2012-10-30T20:48:26.413
> 
> 标签：java, amazon-web-services, amazon-swf

有没有办法从 Amazon SWF 工作流的活动中调用 @Signal 函数。我希望能够通知工作流某些处理已完成，并且它应该为该处理的子集生成一个子工作流。这将如何完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T02:57:06.777

听起来您想告诉工作流某些部分活动已完成，但您想继续运行当前活动。如果是这种情况，那么我建议您将活动分成两部分，并使用第一部分的结果来判断是否需要生成子工作流。我认为在 Flow 框架中不可能在活动中间向工作流发送信号。但是您可以使用原始 SWF API 发送信号（在这种情况下，您需要将“运行 ID”作为参数之一传递给您的活动）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:56:04.227

生成的工作流外部客户端应该用于从活动代码中发送信号。[ActivityExecutionContext](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/simpleworkflow/flow/ActivityExecutionContext.html)包含初始化它所需的所有数据：

```
public class MyActivitiesImpl implements MyActivities {

    private final ActivityExecutionContextProvider contextProvider = new ActivityExecutionContextProviderImpl();

    public void sendSignalBackActivity() {
        ActivityExecutionContext context = contextProvider.getActivityExecutionContext();
        AmazonSimpleWorkflow service = context.getService();
        String domain = context.getDomain();
        WorkflowExecution workflowExecution = context.getWorkflowExecution();
        MyWorkflowClientExternalFactory factory = new MyWorkflowClientExternalFactoryImpl(service, domain);
        GreeterClientExternal workflow = factory.getClient(workflowExecution);
        workflow.signalMethod();
    }
} 
```

当外部客户端调用[SignalWorkflowExecution](http://docs.aws.amazon.com/amazonswf/latest/apireference/API_SignalWorkflowExecution.html) SWF API 时，它可能会因间歇性连接问题而失败。因此，活动实现可能会决定捕获并处理（可能通过重试）在这种情况下抛出的[AmazonServiceException 。](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/AmazonServiceException.html)

# android - Android：是否可以在可绘制选择器中使用字符串/枚举？

> ID：13147360
> 
> 赞同：22
> 
> 时间：2012-10-30T20:48:26.303
> 
> 标签：android, xml, android-layout, android-custom-view

### 问题

**Q1**：有没有人设法让自定义字符串/枚举属性在 xml 选择器中工作？我通过遵循 [1] 得到了一个布尔属性，但不是字符串属性。

编辑：感谢您的回答。目前 android 仅支持布尔选择器。有关原因，请参阅已接受的答案。

我打算实现一个有点复杂的自定义按钮，其外观取决于两个变量。其他将是一个布尔属性（真或假）和另一个类属性（具有许多不同的可能值）。我的计划是使用布尔和字符串（或者可能是枚举？）属性。我希望我可以使用布尔和字符串属性在 xml 选择器中定义 UI。

**Q2**：为什么在 [1] onCreateDrawableState() 中，布尔属性只有在它们为真时才会合并？

### 这是我测试的，布尔属性有效，字符串无效

**注意**：这只是一个测试应用程序，用于确定 xml 选择器中是否可以使用字符串/枚举属性。我知道我可以在没有自定义属性的情况下设置按钮的 textcolor。

在我的演示应用程序中，我使用布尔属性将按钮背景设置为暗/亮，并使用字符串属性设置文本颜色，{“red”、“green”、“blue”} 之一。属性定义在`/res/values/attrs.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="MyCustomButton">
        <attr name="make_dark_background" format="boolean" />
        <attr name="str_attr" format="string" />
    </declare-styleable>
</resources> 
```

以下是我想要实现的选择器：

@drawable/custom_button_background（有效）

```
<?xml version="1.0" encoding="utf-8"?>
<selector 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res/com.example.customstringattribute">

    <item app:make_dark_background="true" android:drawable="@color/dark" />
    <item android:drawable="@color/bright" />

</selector> 
```

@color/custom_button_text_color（不起作用）

```
<selector 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res/com.example.customstringattribute">

    <item app:str_attr="red" android:color="@color/red" />
    <item app:str_attr="green" android:color="@color/green" />
    <item app:str_attr="blue" android:color="@color/blue" />

    <item android:color="@color/grey" />

</selector> 
```

这是自定义按钮背景如何连接到布尔选择器，文本颜色如何连接到字符串选择器。

```
<com.example.customstringattribute.MyCustomButton
    ...
    android:background="@drawable/custom_button_background"
    android:textColor="@color/custom_button_text_color"
    ...
/> 
```

以下是在 init() 方法中加载属性的方式：

```
private void init(AttributeSet attrs) {

    TypedArray a = getContext().obtainStyledAttributes(attrs,
            R.styleable.MyCustomButton);

        final int N = a.getIndexCount();
        for (int i = 0; i < N; ++i)
        {
            int attr = a.getIndex(i);
            switch (attr)
            {
                case R.styleable.MyCustomButton_str_attr:
                    mStrAttr = a.getString(attr);
                    break;
                case R.styleable.MyCustomButton_make_dark_background:
                    mMakeDarkBg  = a.getBoolean(attr, false);
                    break;
            }
        }
        a.recycle();
} 
```

我有属性的 int[] 数组

```
private static final int[] MAKE_DARK_BG_SET = { R.attr.make_dark_background };
private static final int[] STR_ATTR_ID = { R.attr.str_attr }; 
```

并且那些 int[] 数组被合并到可绘制状态

```
@Override
protected int[] onCreateDrawableState(int extraSpace) {
    Log.i(TAG, "onCreateDrawableState()");
    final int[] drawableState = super.onCreateDrawableState(extraSpace + 2);
    if(mMakeDarkBg){
        mergeDrawableStates(drawableState, MAKE_DARK_BG_SET);
    }
    mergeDrawableStates(drawableState, STR_ATTR_ID);
    return drawableState;
} 
```

我的属性设置器方法中也有 refreshDrawableState() ：

```
public void setMakeDarkBg(boolean makeDarkBg) {
    if(mMakeDarkBg != makeDarkBg){
        mMakeDarkBg = makeDarkBg;
        refreshDrawableState();
    }
}

public void setStrAttr(String str) {
    if(mStrAttr != str){
        mStrAttr = str;
        refreshDrawableState();
    }
} 
```

[1] :[如何添加自定义按钮状态](https://stackoverflow.com/questions/4336060/android-how-to-add-a-custom-button-state)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-05T15:24:08.540

**Q1：**

打开StateListDrawable.java的源码，可以在`inflate`读取drawable xml选择器的方法中看到这段代码： [https ://android.googlesource.com/platform/frameworks/base/+/refs/heads /master/graphics/java/android/graphics/drawable/StateListDrawable.java](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/graphics/java/android/graphics/drawable/StateListDrawable.java)

```
 ...

        for (i = 0; i < numAttrs; i++) {
            final int stateResId = attrs.getAttributeNameResource(i);
            if (stateResId == 0) break;
            if (stateResId == com.android.internal.R.attr.drawable) {
                drawableRes = attrs.getAttributeResourceValue(i, 0);
            } else {
                states[j++] = attrs.getAttributeBooleanValue(i, false)
                        ? stateResId
                        : -stateResId;
            }
        }
        ... 
```

`attrs`是每个`<item>`元素的属性`<selector>`。

在这个 for 循环中，它获取`android:drawable`、各种`android:state_xxxx`和自定义`app:xxxx`属性。除了属性之外的所有`android:drawable`属性似乎都被解释为布尔值：`attrs.getAttributeBooleanValue(....)`被调用。

我认为这是基于源代码的答案：

您只能将自定义**布尔**属性添加到您的 xml，而不是任何其他类型（包括枚举）。

**Q2：**

我不确定为什么只有当它被明确设置为 true 时才会合并状态。我怀疑代码应该看起来像这样：

```
private static final int[] MAKE_DARK_BG_SET     = {  R.attr.make_dark_background };
private static final int[] NOT_MAKE_DARK_BG_SET = { -R.attr.make_dark_background };
....
....
@Override
protected int[] onCreateDrawableState(int extraSpace) {
    Log.i(TAG, "onCreateDrawableState()");
    final int[] drawableState = super.onCreateDrawableState(extraSpace + 2);
    mergeDrawableStates(drawableState, mMakeDarkBg? MAKE_DARK_BG_SET : NOT_MAKE_DARK_BG_SET);
    //mergeDrawableStates(drawableState, STR_ATTR_ID);
    return drawableState;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T11:30:38.967

Q1：

我自己没有尝试过，但是：

你试过把你`@color/custom_button_text_color.xml`的放在`drawable`文件夹里吗？（可以肯定的是，Android 中到处都有文件夹魔法，我不确定这个。）

Q2：

状态集有两个用例。一种是以编程方式显式声明有状态可绘制对象的选择器。*在这种情况下，对于选择器，如果未*设置属性，您需要能够告诉 Android*使用*此可绘制对象。为了表达这一点，您可以在.*`int[]`*

 *虽然在选择器标准的上下文中几乎没有提到这一点，但对于可绘制状态本身（也就是可绘制状态的表示）从未提及它。*因此，如果集合中不*包含否定状态 ID，则绝对是安全的；提供的 Android 实现也不包括它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:00:40.553

抱歉，您无法在 xml 中创建自定义可绘制对象： [https ://groups.google.com/d/msg/android-developers/glpdi0AdMzI/LpW4HGMB3VIJ](https://groups.google.com/d/msg/android-developers/glpdi0AdMzI/LpW4HGMB3VIJ)*

# json - 带有 GSON 错误的 JSON 反序列化 -- 这不是 JSON 数组

> ID：13147367
> 
> 赞同：0
> 
> 时间：2012-10-30T20:48:57.880
> 
> 标签：json, serialization, gson

我知道已经有很多关于这个话题的问题，但我被困在这里，我敢肯定这是非常愚蠢的事情。

我正在解析一个看起来像这样的 JSON Api（在此处重命名和简化）：

```
{
"merchant": {
    "name": "TestCo",
    "id": 108
},
"category": [
    {
        "merchant_id": 108,
        "category_name": "Baby Supplies",
        "category_id": 57,
    },
    {
        "merchant_id": 108,
        "category_name": "Dining",
        "category_id": 59,
    }
]} 
```

我有一个包装类，定义为：

```
public class WrapperObject {
  public MerchantObject merchant;
  public List<CategoryObject> category;} 
```

商家和类别都是它们自己正确定义的类。然后我尝试像这样反序列化：

```
collectionType = new TypeToken<List<WrapperObject>>() {}.getType();
List<WrapperObject> wrapperObject = new Gson().fromJson(response, collectionType); 
```

这爆炸了，GSON 报告回“这不是 JSON 数组”。

直到上周，当 API 发生变化时，这才完美运行。JSON 的唯一区别是它曾经看起来像这样（注意数据周围的额外包装数组）：

```
[{
    "merchant": {
        "name": "TestCo",
        "id": 108
    },
    "category": [
        {
            "merchant_id": 108,
            "category_name": "Baby Supplies",
            "category_id": 57,
        },
        {
            "merchant_id": 108,
            "category_name": "Dining",
            "category_id": 59,
        }
    ]}] 
```

如何调整我的代码以解析新的 JSON？注意，我无法控制 JSON。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:04:44.233

旧响应周围的方括号表示一个数组（在这种情况下是一个元素）。看起来新 API 只返回一个包装对象，而不是一个包装对象数组。这行得通吗？

```
wrapperType = new TypeToken<WrapperObject>() {}.getType();
WrapperObject wrapperObject = new Gson().fromJson(response, wrapperType); 
```

# javascript - 我可以使用 jquery 访问存储在 html 元素数据属性中的哈希吗？

> ID：13147369
> 
> 赞同：4
> 
> 时间：2012-10-30T20:49:02.047
> 
> 标签：javascript, jquery, html

我有几个 html 元素，我正在附加哈希值，如下所示：

```
<p class='message' data-dependencies={'#first':{'equal':'Yes'}}>
  Relevant Content
</p> 
```

以便

```
$(".message").first().data("dependencies") 
```

返回

```
{'#first':{'equal':'Yes'}} 
```

但是正如一个朋友刚刚向我指出的那样，这个值是一个字符串。所以很自然地，下面描述的过滤器很难使用它。

过滤器的目标是能够抓取具有指定键的元素，在本例中为“#first”。

```
$el.children().find("*").filter(function(){
    var dependency_hash = $(this).data("dependencies");
    if(dependency_hash != undefined && "#first" in dependency_hash){
      return true
    }
}); 
```

有没有一种方法可以访问通过数据对象传递的哈希，或者是否有另一种方法可以构造数据以实现基于键选择元素的相同方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T20:52:11.347

如果将其存储为有效的 JSON，则可以对其进行解析，并获取内容。

```
<p class='message' data-dependencies='{"#first":{"equal":"Yes"}}'>
  Relevant Content
</p> 
```

* * *

```
var json = $(".message").first().attr("data-dependencies");

// HTML5 browsers
// var json = document.querySelector(".message").dataset.dependencies;

var parsed = $.parseJSON(data);

alert(parsed["#first"].equal); // "Yes" 
```

* * *

或者，如果您使用 jQuery `.data()`，它会自动解析它。

```
var parsed = $(".message").first().data("dependencies");

alert(parsed["#first"].equal); // "Yes" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:51:29.880

使用 JSON.parse。如果您需要旧浏览器的支持，可以使用 polyfill。

```
$el.children().find("*").filter(function(){
    var dependency_hash = $(this).data("dependencies");
    var parsed_hash = JSON.parse(dependency_hash);
    if(parsed_hash != undefined && "#first" in parsed_hash ){
      return true
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T20:51:18.873

您可能希望将数据序列化为 JSON [http://json.org/](http://json.org/)，然后在 JS 中取回它。您可以使用 jquery 的解析器[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

# android - NPE 从非活动类设置自定义适配器

> ID：13147370
> 
> 赞同：0
> 
> 时间：2012-10-30T20:49:03.630
> 
> 标签：android, button

我在我的非活动课程上获得 NPE ..在这个活动中我设置

按钮（setonclicklistener）设置我的自定义适配器..我不知道如何修复它，因为 iam

编程不够好我很困惑我必须更改代码..

**这是我的自定义 AdapterListMenu 类：**

```
public class AdapterListMenu extends BaseAdapter {

    private Activity activity;
    private ArrayList<HashMap<String, String>> data;
    private static LayoutInflater inflater=null;
    public ImageLoader imageLoader;
    Context context; 

    public AdapterListMenu(Activity a, ArrayList<HashMap<String, String>> d) {
        activity = a;
        data=d;
        inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        imageLoader=new ImageLoader(activity.getApplicationContext());
    }

    public int getCount() {
        return data.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }
    public AdapterListMenu(Context context) {
        this.context=context;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.list_menurow, null);

        final TextView nama_menu = (TextView)vi.findViewById(R.id.nama_menu); // title
        TextView keterangan_menu = (TextView)vi.findViewById(R.id.keterangan_menu); // artist name
        TextView harga_menu = (TextView)vi.findViewById(R.id.harga_menu); // duration
        ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image
        final EditText listmenu_jumlahmenu = (EditText)vi.findViewById(R.id.txtListMenu_Jumlah);       
        final Button listmenu_submit=(Button)vi.findViewById(R.id.btn_ListMenu_Submit);

        listmenu_submit.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                String nama_menus = nama_menu.getText().toString();
                String jumlah_menus = listmenu_jumlahmenu.getText().toString();
                MenuInputClass sr = new MenuInputClass();
                sr.setNama_menu(nama_menus);
                sr.setJumlah_menu(jumlah_menus);
                Appetizer_Activity.results.add(sr); 
                ListPemesanan_Activity.list_pemesanan.setAdapter(new AdapterListPemesananMenu(getApplicationContext(), Appetizer_Activity.results));
             --->i think the  problem is here

            }

            private Context getApplicationContext() {
                // TODO Auto-generated method stub
                return null;
            }

            });

        HashMap<String, String> listmenudisplay = new HashMap<String, String>();
        listmenudisplay = data.get(position);

        // Setting all values in listview
        nama_menu.setText(listmenudisplay.get(ListAppetizer_Activity.parser_nama_menu));
        keterangan_menu.setText(listmenudisplay.get(ListAppetizer_Activity.parser_keterangan_menu));
        harga_menu.setText(listmenudisplay.get(ListAppetizer_Activity.parser_harga_menu));
        imageLoader.DisplayImage(listmenudisplay.get(ListAppetizer_Activity.parser_gambar), thumb_image);
        return vi;
    } 
```

**适配器列表 pemesanan 菜单类：**

```
public class AdapterListPemesananMenu extends BaseAdapter {
    public static ArrayList<MenuInputClass> searchArrayList;

    private LayoutInflater mInflater;

    public AdapterListPemesananMenu(Context context, ArrayList<MenuInputClass> results) {
        searchArrayList = results;
        mInflater = LayoutInflater.from(context);
    }

    public AdapterListPemesananMenu(OnClickListener onClickListener,
            ArrayList<MenuInputClass> searchResults) {
        // TODO Auto-generated constructor stub
    }

    public int getCount() {
        return searchArrayList.size();
    }

    public Object getItem(int position) {
        return searchArrayList.get(position);
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.list_pemesananmenu_row, null);
            holder = new ViewHolder();
            holder.txtName = (TextView) convertView.findViewById(R.id.txtNamaMasuk);
            holder.txtCityState = (TextView) convertView
                    .findViewById(R.id.txtJumlahMasuk);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.txtName.setText(searchArrayList.get(position).getNama_menu());
        holder.txtCityState.setText(searchArrayList.get(position)
                .getJumlah_menu());

        return convertView;
    }

    static class ViewHolder {
        TextView txtName;
        TextView txtCityState;

    }
} 
```

**列出pemesanan菜单xml布局**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.76" >

        <TextView
            android:id="@+id/textView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:layout_marginTop="14dp"
            android:text="No Meja :" />

        <EditText
            android:id="@+id/txtNoMeja"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="16dp"
            android:layout_toRightOf="@+id/textView2"
            android:ems="10" >

            <requestFocus />
        </EditText>

        <ListView
            android:id="@+id/list"
            android:layout_width="match_parent"
            android:layout_height="400dp"
            android:layout_below="@+id/txtNoMeja"
            android:layout_centerHorizontal="true"
            android:choiceMode="multipleChoice"
            android:textColor="#ffff00"
            >

        </ListView>

        <Button
            android:id="@+id/btn_submit_list_pemesanan"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:text="Submit" />
    </RelativeLayout>

</LinearLayout> 
```

**列出pemesanan菜单行布局**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/txtNamaMasuk"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="TextView"
        android:textColor="@color/textbody" />

    <TextView
        android:id="@+id/txtJumlahMasuk"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="38dp"
        android:text="TextView"
        android:textColor="@color/textbody" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toLeftOf="@+id/txtJumlahMasuk"
        android:text="Jumlah :"
        android:textColor="@color/textbody" />

</RelativeLayout> 
```

**这是 logcat ：**

```
10-31 03:44:23.111: E/AndroidRuntime(13386): FATAL EXCEPTION: main
10-31 03:44:23.111: E/AndroidRuntime(13386): java.lang.NullPointerException
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.view.LayoutInflater.from(LayoutInflater.java:171)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at xml_parser_and_adapter.AdapterListPemesananMenu.<init>(AdapterListPemesananMenu.java:25)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at xml_parser_and_adapter.AdapterListMenu$4.onClick(AdapterListMenu.java:158)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.view.View.performClick(View.java:2538)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.view.View$PerformClick.run(View.java:9152)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.os.Handler.handleCallback(Handler.java:587)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.os.Handler.dispatchMessage(Handler.java:92)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.os.Looper.loop(Looper.java:130)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at android.app.ActivityThread.main(ActivityThread.java:3693)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at java.lang.reflect.Method.invokeNative(Native Method)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at java.lang.reflect.Method.invoke(Method.java:507)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
10-31 03:44:23.111: E/AndroidRuntime(13386):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665) 
```

我必须做什么？

谢谢你...

将我的代码替换为：

```
ListPemesanan_Activity.list_pemesanan.setAdapter(new AdapterListPemesananMenu(activity, Appetizer_Activity.results));

11-01 16:56:26.108: E/AndroidRuntime(7758): FATAL EXCEPTION: main
11-01 16:56:26.108: E/AndroidRuntime(7758): java.lang.NullPointerException
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.ViewConfiguration.get(ViewConfiguration.java:228)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.View.<init>(View.java:1888)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.View.<init>(View.java:1931)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.ViewGroup.<init>(ViewGroup.java:292)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.widget.AdapterView.<init>(AdapterView.java:228)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.widget.AbsListView.<init>(AbsListView.java:686)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.widget.ListView.<init>(ListView.java:188)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.widget.ListView.<init>(ListView.java:184)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.widget.ListView.<init>(ListView.java:180)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at xml_parser_and_adapter.AdapterListMenu$4.onClick(AdapterListMenu.java:152)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.View.performClick(View.java:2538)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.view.View$PerformClick.run(View.java:9152)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.os.Handler.handleCallback(Handler.java:587)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.os.Handler.dispatchMessage(Handler.java:92)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.os.Looper.loop(Looper.java:130)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at android.app.ActivityThread.main(ActivityThread.java:3693)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at java.lang.reflect.Method.invokeNative(Native Method)
11-01 16:56:26.108: E/AndroidRuntime(7758):     at java.lang.reflect.Method.invoke(Method.java:507) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T09:30:49.657

尝试这个

```
ListPemesanan_Activity.list_pemesanan.setAdapter(new AdapterListPemesananMenu(activity, Appetizer_Activity.results));
         --->i think the  problem is here 
```

代替

```
ListPemesanan_Activity.list_pemesanan.setAdapter(new AdapterListPemesananMenu(getApplicationContext(), Appetizer_Activity.results));
         --->i think the  problem is here 
```

# git - Git：寻找新的樱桃

> ID：13147373
> 
> 赞同：0
> 
> 时间：2012-10-30T20:49:20.607
> 
> 标签：git, svn, cherry-pick

我已经根据[Adam Spiers 在之前的 SO 线程中的回答](https://stackoverflow.com/questions/12924001)设置了一个流程，以定期将 Git 存储库发布到 SVN 存储库中的路径。一切都很好，但有一件我还没有弄清楚。当我使用 获取后续 Git 更改时`cherry-pick`，我如何确定在这个 Git 端发生了哪些新更改，需要将其挑选到 SVN 端？

更具体地说，在我将 Git 历史初始推送到 SVN 之后，我现在坐在一个`master`与 Git 起源具有相同内容和补丁历史的分支上，但它`origin/master`基本上与它的完整历史不同：

```
% git --no-pager diff master git-svn
% git status
# On branch master
# Your branch and 'origin/master' have diverged,
# and have 3 and 2 different commit(s) each, respectively.
#
nothing to commit (working directory clean) 
```

现在，我获取新的上游更改：

```
% git fetch
remote: Counting objects: 5, done.
remote: Total 3 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (3/3), done.
From /cygdrive/c/foo/git/testrep
   6d7dd94..08d3d19  master     -> origin/master 
```

在这一点上，我需要弄清楚哪些修订需要精心挑选，然后我会挑选它们并做一个`git svn dcommit`. 但我不知道如何获得樱桃清单。我已经尝试了各种`git cherry`命令，并且都`git cherry origin master`报告`git cherry master origin`了每边基本上每一个变化的长列表。

我应该求助于解析日志文件中的最后一个樱桃挑选吗？我正在使用`git cherry-pick -x`，所以我确实有记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T14:34:46.707

所以我想我有一个解决方案——在每`git cherry-pick`一轮`git svn dcommit`之后，我都会做一个`git tag -f last-picked origin`. `last-picked`然后下一次，我可以从到樱桃采摘`origin`。

如果他们有更好的解决方案，我愿意将某人的答案标记为已接受，但在这一点上，我似乎不一定需要另一个答案。

# linux - Mono 中的 Intel CPU OpenCL 被 SIGXCPU (Ubuntu) 杀死

> ID：13147375
> 
> 赞同：1
> 
> 时间：2012-10-30T20:49:36.503
> 
> 标签：linux, mono, opencl, signal-handling

前段时间，我使用 OpenCL（是学校作业）编写了简单的 boids 模拟，使用 C#、用于 OpenCL 的 Cloo 和用于 OpenGL 输出的 OpenTK。我在 Windows7 上使用 AMD CPU 实现 OpenCL 和朋友的 NVidia 对其进行了测试。现在我在 Linux (Ubuntu 12.04) 上试了一下。我安装了amd app sdk和intel sdk。它编译正常，参考 CPU 实现与图形输出工作正常。但是当我尝试运行 OpenCL 版本时，它会运行大约 1 秒（显示 OpenGL 中的有效输出），然后被 SIGXCPU 杀死。试图谷歌一些已知问题，但一无所获。所以我试图捕捉并忽略这个信号，但每次我尝试时，程序都会挂起。当我将单声道设置为捕获一些不同的信号（例如 SIGPIPE）时，它运行正常（减去 opencl 时的终止）。在 Mono 中，我尝试了常见问题解答中所述的 Mono.UnixSignal

```
Mono.Unix.Native.Stdlib.SetSignalAction ( Mono.Unix.Native.Signum.SIGXCPU, Mono.Unix.Native.SignalAction.Ignore); 
```

然后一些不会挂起但也无济于事的东西：

```
Mono.Unix.Native.Stdlib.SetSignalAction ( Mono.Unix.Native.Signum.SIGXCPU, Mono.Unix.Native.SignalAction.Error); 
```

乃至

```
ignore (0);
Mono.Unix.Native.Stdlib.signal(Mono.Unix.Native.Signum.SIGXCPU, new Mono.Unix.Native.SignalHandler (ignore)); 
```

和

```
static void ignore(int signal) {
} 
```

即使我从 main 中删除其他所有内容，它仍然会在“触摸”该信号后的某个时间挂起。

还有一件奇怪的事：

```
Mono.Unix.Native.Stdlib.SetSignalAction ( Mono.Unix.Native.Signum.SIGXCPU, Mono.Unix.Native.SignalAction.Default); 
```

在 Application.EnableVisualStyles(); 之后的某处使用 SIGXCPU 杀死应用程序；当我之前设置它时，这次甚至没有接触 OpenCL。

我在 Mono 中错过了什么吗？是否在内部某处使用此信号会妨碍 OpenCl？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:54:54.280

SIGXCPU 意味着您已经超过了每个进程的时间限制。一旦你超过了它，你就已经超过了它。进程卡住了。您需要使用 ulimit 或从管理员那里获得帮助来设置更高的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:19:16.450

Mono 在内部出于自己的目的使用 SIGXCPU，因此如果您忽略它（或者由于其他原因而引发它），事情就会中断。

# jquery - OnMarkerClick 和 JVectorMap

> ID：13147380
> 
> 赞同：3
> 
> 时间：2012-10-30T20:50:06.457
> 
> 标签：jquery, jvectormap

我正在尝试使用 JVectorMap 创建一个地图，该地图将在用户单击给定标记后将信息放入#output div（例如，如果用户单击标记为 Alaska 的标记，则有关 Alaska 的事实会在 #output div 中弹出）。在这里的其他地方，我看到了这个代码示例，它输出标签的名称......

```
onMarkerLabelShow: function(event, label, code) {
    $("#output").html("Some information about "+ label.html());
} 
```

我正在尝试在这里使用开关...

```
onMarkerLabelShow: function(event, label, code) {
    switch (label) {
        case Alaska:
        $("#output").html($("#alaska-facts");
        [break;]

        case North Carolina:
        $("#output").html($("#nc-facts");
        [break;]

        default:
        $("#output").html("Please select a job site");
        [break;]
    }
} 
```

运行此代码时地图不显示，我可能完全走错了路。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T01:42:59.880

几个问题：

*   是一个对象，`label`不会匹配`case`匹配字符串值的简单语句。您可能想要评估`label.text()`
*   中的值`case`应该被引用字符串（即`"North Carolina"`，不是`North Carolina`）
*   `break;`不应该被包裹（`[]`你不想要一个数组`break`，你想打破`switch`）。
*   您缺少使用 jQuery ID 选择器`)`设置的行的关闭`.html()`

更正示例：

```
onRegionLabelShow: function(event, label, code) {
   switch (label.text()) {
      case "Alaska":
         $("#output").html($("#alaska-facts"));
         break;

      case "North Carolina":
         $("#output").html($("#nc-facts"));
         break;

      default:
         $("#output").html("Please select a job site");
         break;
   }
} 
```

# mysql - MySQL 查询 - 列出不存在的 2 个表中的数据

> ID：13147381
> 
> 赞同：0
> 
> 时间：2012-10-30T20:50:14.820
> 
> 标签：mysql

我正在尝试计算在线商店客户的积分使用情况。随着时间的推移，客户获得积分。当积分被兑换时，*customer.points*的值被修改以反映剩余要兑换的积分。获得的任何额外积分也会添加到*customer.points*中。因此，确定客户在帐户生命周期内获得的积分数量的唯一真正机制是将总使用量与剩余积分相加（*`order`.total* + *customer.points*）。

下面的查询返回所需的结果，但仅适用于已兑换积分的客户。我想要的是，因为所有客户都有积分，所以也能够为那些没有兑换积分的人返还积分余额。

```
SELECT customer.store_id, customer.customer_id, `order`.total + customer.points 
    AS allpoints, customer.firstname, customer.lastname 
    FROM `order`
    INNER JOIN customer ON `order`.customer_id = customer.customer_id
    WHERE (customer.store_id =3)
    GROUP BY customer.customer_id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:14:22.253

听起来您需要使用 an `left outer join`，它将返回联接左侧表的所有行，并且仅在存在记录时才返回右侧表的行。这确实意味着当记录不存在时您需要处理表的`null`值。`order`

```
SELECT
  customer.store_id,
  customer.customer_id,
  isnull(order.total, 0) + customer.points AS allpoints,
  customer.firstname,
  customer.lastname
FROM customer
  LEFT OUTER JOIN order ON order.customer_id = customer.customer_id
WHERE (customer.store_id =3)
GROUP BY customer.customer_id 
```

# api - 这是 REST 的正确实现吗？

> ID：13147382
> 
> 赞同：0
> 
> 时间：2012-10-30T20:50:18.633
> 
> 标签：api, rest, parameters, uri

我正在稳步构建我的 API 的资源，但是在对构建 RESTful API 的正确方法进行了大量研究之后，我一直无法找到应该如何接收“复杂”请求的示例。

例如，作为登录过程的一部分（只不过是身份验证密钥更新），客户端会发送以下 URI：

```
/api/auth/login 
```

URI 上没有值，资源是`/auth/`，被触发的命令是`/login/`。实际登录详细信息发送到服务器授权标头。

现在，促使我提出这个问题的原因是，当我正在编写一个命令以允许客户端提醒密钥的有效期时，我立即被吸引到 `getkeyexpiration`或类似于命令名称的东西。

突然我觉得这听起来不像我在 6 个约束中读到的，这感觉更像是操作调用。

那么，基于上面的例子，这还是一个 RESTful API 吗？我很担心，因为我想不出一种通过简单地使用 URI 资源名称和附加值来执行此操作的方法。

谢谢

编辑：

通过阅读：http: [//blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http](http://blog.steveklabnik.com/posts/2011-07-03-nobody-understands-rest-or-http)

我开始明白，通过使用名词词命名资源和仅资源，服务器将如何运行的上下文变得更加清晰。

关于我上面的例子：

```
/api/auth/login 
```

我使用 auth 作为登录的前缀，因为那是资源的上下文。我正在将我的系统设计为可扩展的，并且需要一种在 URI 级别对资源进行分类的方法。有这样做的标准方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:32:00.253

您的 RESTful 资源应该是名词，因为 HTTP 提供了动词。

我会建议这样的事情：

```
/api/key 
```

然后您可以`POST`（包括 HTTP 授权标头）创建一个新密钥，返回如下内容：

```
/api/key/1234ABCDBLAHBLAH 
```

这是特定于您的会话的密钥，然后您可以 GET 以检索有关它的详细信息，例如到期时间等。当然，您必须在每个后续请求中传递该密钥。

如果在 RESTful API 的上下文中讨论关键内容时听起来很笨拙，那是因为它通常是。会话是人类/浏览器的概念，但 RESTful API 是应用程序/集成的概念。

由于服务器不会“登录”到其他服务器，这就引出了一个问题：如果您已经可以要求调用者将 Auth 标头传递给您的登录 API，为什么不只要求为**每个**API 调用传递它，完全忘记键的概念？

# c# - 在 .net com 类上运行 regasm.exe

> ID：13147387
> 
> 赞同：2
> 
> 时间：2012-10-30T20:50:27.377
> 
> 标签：c#, com, installshield, regasm

如何在 installshield 的 .net com 可见类上运行 regasm？我可以通过调用 dll 上的 regasm.exe 手动注册，但是当我在 installshield 项目中将“.net Com Interop”设置为“是”时，我收到错误 -6210。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:43:06.183

发生这种情况是因为用于构建 DLL 的 .net 版本比在 Tools>Options>/.net 选项卡下指定的版本最新。当我将 .net 文件夹更新到那里的最新文件夹时，错误消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:56:24.253

听起来好像找到 COM DLL 的依赖项有问题。

看看这些链接之一是否有帮助：

[http://community.flexerasoftware.com/archive/index.php?t-167698.html](http://community.flexerasoftware.com/archive/index.php?t-167698.html)

[http://kb.flexerasoftware.com/selfservice/viewContent.do?externalID=Q107824](http://kb.flexerasoftware.com/selfservice/viewContent.do?externalID=Q107824)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:01:41.633

您通常希望避免在安装过程中运行 regasm。如果 InstallShield 不知道对系统的修改，它不能保证它会正确清理。如果您无法让 IS 从另一个答案中的链接中提取信息，您可以使用 regasm 的 /regfile 选项来获取密钥并将它们添加到 IS。

# ms-word - 无法使用 VSTO for Word 一次更新一个字段

> ID：13147389
> 
> 赞同：1
> 
> 时间：2012-10-30T20:50:33.390
> 
> 标签：ms-word, vsto, field, updating

当字段嵌套时，就会出现问题。

```
foreach (Word.Field field in this.Application.ActiveDocument.Fields)
        {
            field.Update();
            text = field.Result.Text;

        } 
```

上面的代码不起作用。

该进程开始，但以无限循环或挂起系统的其他进程结束。

考虑一下，我可以推测，当您更新字段时，它可能会对字段集合产生影响——因此，循环会失败。

有没有人对此有任何想法？

PS 我知道有一个 Document.UpdateFields() 方法来更新所有字段。但是，我不能使用它并且只需要更新特定的字段类型是有原因的。

我很抱歉！我将举一个嵌套字段的示例，但在发送任何人（Jack）之前尝试进行更多测试。

我等了又等，等了两三分钟后，它完成了。在最后一个字段之后，它因以下消息而崩溃：

对象已被删除。

错误是从循环内的以下行生成的：

字符串文本 = field.Code.Text；

该模板正在未找到的合并字段上进行测试，因为我在没有数据库连接的情况下进行测试。奇怪但可以解释的是，它遍历了所有字段，然后在一天结束时，非常 OUTER IF 字段的结果是“错误！未找到参考源”。但我仍然不明白为什么会发生这种情况。

我也不明白为什么循环需要 3 分钟，而对 document.Fields.Update() 的调用将在大约 1 秒内执行相同的操作并且不会导致上述错误。

再次，我很抱歉。我从来没有考虑过在循环中更新会比调用 doc.fields.update() 慢得多。

# firefox-addon-sdk - 使 Firefox 面板适合内容

> ID：13147391
> 
> 赞同：1
> 
> 时间：2012-10-30T20:50:35.093
> 
> 标签：firefox-addon-sdk

我正在手动将我在 Chrome 中编写的扩展移植到 Firefox。我将面板附加到小部件，并将该面板的内容设置为 HTML 文件。如何使面板随内容缩小和增长？现在有很多难看的滚动条和灰色背景。

```
var data = require("self").data;

var text_entry = require("panel").Panel({
  width: 320,
  height: 181,
  contentURL: data.url("text-entry.html"),
  contentScriptFile: data.url("get-text.js")
});

require("widget").Widget({
  label: "Text entry",
  id: "text-entry",
  contentURL: "http://www.mozilla.org/favicon.ico",
  panel: text_entry
}); 
```

不设置面板的高度属性会使其非常高。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:56:06.080

You might want to check out this example that resizes the panel based on the document loaded. If you want to resize based on changes to the content size, at least on initial load:

[https://builder.addons.mozilla.org/package/150225/latest/](https://builder.addons.mozilla.org/package/150225/latest/)

( sorry for the delay in respinding, been afk travelling )

# android - 具有两个布局视图的活动，其中一个视图具有垂直滚动条

> ID：13147394
> 
> 赞同：0
> 
> 时间：2012-10-30T20:50:49.203
> 
> 标签：android, android-layout

我需要做一个有两个“部分”的活动。第一个，使用屏幕的上半部分，在那里，我将显示一些字段（名称，日期，...）。第二个，使用同一屏幕的下半部分，在那里，我将显示一个表格，三列和一些行。行数未定义，因为它们来自 Web 服务。

我的疑问是如何使用垂直滚动条表来执行第二部分，用户将在其中看到前半部分是静态的，并且可以角色下半部分来查看表的所有行（如 iframe）。我需要使用表格，因为我的单元格需要对齐。

我已经尝试过tablelayout、listview、gridview，但我找不到显示垂直滚动条的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T20:55:36.010

您可以使用[ScrollView](http://developer.android.com/reference/android/widget/ScrollView.html)。

请注意，虽然 ScrollView 支持一个直接子级，但您可以将所有内容都包装起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:57:21.323

您可以使用以下内容：

```
MainLayout
    TopHalfElements

    ScrollView
        Linear/relative/frame/whatever layout
            Rows From Webservice etc. 
```

您需要在[ScrollView](http://developer.android.com/reference/android/widget/ScrollView.html)中有一个主布局，因为它只支持一个直接子级。

# mysql - Mysql InnoDB 和快速应用大更新

> ID：13147395
> 
> 赞同：0
> 
> 时间：2012-10-30T20:50:57.923
> 
> 标签：mysql, ruby, database, innodb

基本上我的问题是我有一个包含大约 17,000,000 种产品的大表，我需要非常快速地应用大量更新。

该表有 30 列，id 设置为 int(10) AUTO_INCREMENT。

我有另一个表，该表的所有更新都存储在其中，这些更新必须预先计算，因为它们需要几天时间来计算。该表的格式为 [ product_id int(10), update_value int(10) ]。

我快速发布这 1700 万个更新的策略是在 ruby​​ 脚本中将所有这些更新加载到内存中，并将它们分组到数组散列中，这样每个 update_value 都是一个键，每个数组都是排序后的 product_id 列表.

```
{ 
   150: => [1,2,3,4,5,6],
   160: => [7,8,9,10]
} 
```

然后以以下格式发布更新

```
UPDATE product SET update_value = 150 WHERE product_id IN (1,2,3,4,5,6);
UPDATE product SET update_value = 160 WHERE product_id IN (7,8,9,10); 
```

我很确定我这样做是正确的，因为在排序的 product_id 批次上发布更新应该是使用 mysql / innodb 执行此操作的最佳方式。

我遇到了一个奇怪的问题，虽然当我测试更新约 1300 万条记录时，这只花了大约 45 分钟。现在我正在使用更多数据进行测试，大约 1700 万条记录，更新时间接近 120 分钟。我本来预计这里会出现某种速度下降，但不会达到我所看到的程度。

关于如何加快速度或使用这个更大的记录集可能会减慢我速度的任何建议？

就服务器规格而言，它们非常好，大量内存/cpu，整个数据库应该适合内存，并且有足够的增长空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:57:36.877

您可以尝试使用 mysql 的多表更新语法

```
update product, sometable SET product.update_value=sometable.value WHERE product_id=sometable.whatever; 
```

这样，它是一次通过数据库和一个 mysql 可以通过的大查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:20:34.033

我认为您需要仔细设计索引和数据页访问。

假设`product_id`s 在查询中的分布是随机的，那么每次更新 SQL 都会导致随机索引页面访问。当然，索引页访问之后的数据页访问也是随机的。如果您希望所有更新快速运行，则需要将所有索引页都保存在内存中（至少）。因此，这不是一组快速更新操作。

如果我正在设计它并且更新不需要是事务性的，我将按照 product_id 逐一更新所有行，而不是在事务中：

```
UPDATE product SET update_value = 150 WHERE product_id = 1
UPDATE product SET update_value = 150 WHERE product_id = 2
... 
```

由于它会导致索引页和数据页都按顺序读取/更新，因此这种方案可能需要更长的更新时间，但从缓存管理的角度来看会便宜很多。当然，对数据库的整体影响是最小的，因此更新以外的操作（如来自客户的查询）不会降级。

如果需要事务操作，我可能想要有两个表，或者使用一些技巧将两个逻辑表合并到一个表中，这在上述缓存讨论的角度来看更便宜。但是，如果您不需要进行事务处理，那么缓慢的更新`product_id`就是要走的路。

# java - 将开关重写为数组

> ID：13147397
> 
> 赞同：1
> 
> 时间：2012-10-30T20:51:03.460
> 
> 标签：java, arrays

您好，我在 switch 语句的帮助下创建了一个骰子以显示骰子的正确面，现在我打算将其重写为一个数组，但我不知道这应该是什么样子..（我是新手Java，它只是用于学习目的）有人可以给我看一个它必须是什么样子的小例子吗？

这是包含 switch 语句的类：

```
package h05Dobbelsteen;

import java.awt.*;

import javax.swing.JPanel;

public class DobbelSteen extends JPanel {

private final static int SPOT_DIAMETER = 40; // diameter dobbelsteen rondjes
private int faceValue; // getoonde waarde op scherm

public DobbelSteen() {

}

/*
 * roll de dobbelsteen
 */
public int roll() {

    int val = (int) (6*Math.random() + 1); // bepaal getal tussen 1 - 6
    setValue(val);
    System.out.println(val);
    return val;

}

/*
 * set de waarde van de roll
 */
public void setValue(int spots) {
    faceValue = spots;
    repaint();
}

/*
 * get de waarde van de roll
 */
public int getValue() {
    return faceValue;
}

/*
 * teken de view van de dobbelsteen
 */
public void paintComponent(Graphics g) {

    int w = getWidth();  // Get height and width
    int h = getHeight();

    // Graphics naar 2d
    Graphics2D g2 = (Graphics2D)g;
    g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);

    //... Paint background
    g2.setColor(Color.WHITE);
    g2.fillRect(0, 0, w, h);
    g2.setColor(Color.BLACK);

    g2.drawRect(0, 0, w-1, h-1);  // Draw border

    switch (faceValue) {
        case 1:
            drawSpot(g2, w/2, h/2);
            break;
        case 3:
            drawSpot(g2, w/2, h/2);

        case 2:
            drawSpot(g2, w/4, h/4);
            drawSpot(g2, 3*w/4, 3*h/4);
            break;
        case 5:
            drawSpot(g2, w/2, h/2);
        case 4:
            drawSpot(g2, w/4, h/4);
            drawSpot(g2, 3*w/4, 3*h/4);
            drawSpot(g2, 3*w/4, h/4);
            drawSpot(g2, w/4, 3*h/4);
            break;
        case 6:
            drawSpot(g2, w/4, h/4);
            drawSpot(g2, 3*w/4, 3*h/4);
            drawSpot(g2, 3*w/4, h/4);
            drawSpot(g2, w/4, 3*h/4);
            drawSpot(g2, w/4, h/2);
            drawSpot(g2, 3*w/4, h/2);
            break;
    }
}

/*
 * Teken de spots
 */
private void drawSpot(Graphics2D g2, int x, int y) {
    g2.fillOval(x-SPOT_DIAMETER/2, y-SPOT_DIAMETER/2, SPOT_DIAMETER, SPOT_DIAMETER);
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:03:16.663

就像是：

```
private class Point {
  int x;
  int y;
  Point(int x, int y) {
    this.x = x;
    this.y = y;
}

Point[][] pointSpecs = new Point[][] { {new Point( .5, .5) }, 
                                       {new Point(.25, .25), new Point(.75, .75)},
                                  ...}; 
```

这是数组数组的声明。第一个索引是骰子值 1（因为 java 数组是零索引的）。每个位置都有一个需要绘制的点数组。只有乘数在那里，你需要乘以你的宽度和高度。

要使用：

```
public void paintComponent(Graphics g) {

int w = getWidth();  // Get height and width
int h = getHeight();

// Graphics naar 2d
Graphics2D g2 = (Graphics2D)g;
g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
        RenderingHints.VALUE_ANTIALIAS_ON);

//... Paint background
g2.setColor(Color.WHITE);
g2.fillRect(0, 0, w, h);
g2.setColor(Color.BLACK);

g2.drawRect(0, 0, w-1, h-1);  // Draw border

Point[] points = pointSpecs[faceValue-1];
for (Point point : points) {
  drawSpot(g2, w*point.x, h*point.y);
} 
```

您需要填写其余的点值...

# ruby-on-rails - 在 RUBY 控制器中访问 HTML 标签

> ID：13147403
> 
> 赞同：0
> 
> 时间：2012-10-30T20:51:33.367
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我的 HTML.erb 中有以下代码

```
<form>
   <input id="do" type="hidden" value="0" />
   <button type="submit" value="Next">SUBTRACT</button>
</form>
<form>
  <input id="do" type="hidden" value="1" />
  <button type="submit" value="Next" >ADD</button>
</form> 
```

现在，当我单击 2 个按钮中的任何一个时，我想检查 Ruby 控制器中输入 id="do" 的值。语法会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T20:57:13.810

这应该最好在控制器中分成两个动作，每个表单都将提交（使用`action`属性）。

```
<form action='add'>
   <input id="do" type="hidden" value="0" />
   <button type="submit" value="Next">SUBTRACT</button>
</form>
<form action='subtract'>
  <input id="do" type="hidden" value="1" />
  <button type="submit" value="Next" >ADD</button>
</form>

#in your controller
def add
  # do the addition processing
end

def subtract
  # do the subtraction processing
end 
```

如果你真的需要在 1 个动作中实现它们，那么你可以使用 Rails`params`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T20:56:44.470

您需要设置名称属性，名称属性在参数哈希中发送到控制器

```
<form>
   <input id="do" name="subtract" type="hidden" value="0" />
   <button type="submit" value="Next">SUBTRACT</button>
</form>
<form>
  <input id="do" name="add" type="hidden" value="1" />
  <button type="submit" value="Next" >ADD</button>
</form> 
```

在控制器中，

`params[:subtract]`or的`params[:add]`值取决于减去 clicked 或 add clicked 。

# asp.net-mvc - 转换常规 MVC 站点以在 phonegap 中使用

> ID：13147404
> 
> 赞同：19
> 
> 时间：2012-10-30T20:51:42.470
> 
> 标签：asp.net-mvc, cordova, jquery-mobile, mobile-website

我有一个使用 ASP.NET MVC 和 jQuery 完成的网站。是否可以在没有太多返工的情况下修改我现有的项目，以便可以在 phonegap 中使用它来创建 iphone/android 应用程序？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-30T21:03:15.517

这是一种方法：将您的逻辑移动到 MVC WebAPI（或其他 REST/webservice）项目，然后将 MVC 站点转换为简单的 html/javascript/css/image 站点（移动站点）。然后重构您的移动站点以使用 Ajax/JS 来查询您创建的 WebAPI/Rest 服务。以这种方式分离代码后，您可以使用 Phonegap 打包移动网站。我不确定这将为您或您的项目带来多少工作量。如果您在视图中使用大量 Html Helpers 或 Razor 标记，则可能过于复杂。

我这里建议的核心点是将您的移动 UI 层和后端处理层分开，这样您就只能将 Html5/UI/Javascript 层与 Phonegap 打包，而将后端处理留在您的 Web 服务器上。我认为我不需要解释这一点，但显然与 Phonegap 打包的应用程序不会在移动设备上提供 MVC/.Net 框架来呈现视图或执行控制器等。通过迁移你的 UI 变得简单Html5 和 Javascript，您可以对后端使用 Ajax/Jquery/Javascript 调用，您可能希望将其托管在 ASP.Net MVC WebAPI 中。

编辑：猜猜我的建议有些混乱。我并不是说这是唯一可行的方法，但这是我所熟悉的，因为这是我们的团队构建桌面/网络 + 移动 + phonegap + mvc4 + webapi + kendoui 应用程序的方式。这种模式对我们很有效，所以也许它也对你有用，或者至少给你一些关于如何构建你的解决方案的想法。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T20:57:40.263

我不确定，但您需要一个服务器来编译 ASP.NET 对吗？所以我认为这对你不起作用。我认为您需要使用 AJAX 来完成您的 ASP.NET 工作并将您的 ASP.NET 代码和 HTML-jQuery 分开，因为 Phonegap 需要一个 index.html 文件。您可以将 ASP.NET 文件存储在服务器上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:48:27.893

您的问题的答案实际上取决于您尝试转换的网站类型。您是否只是想在 HTML 周围放置一个原生框架并将您的应用程序放入应用程序商店？

如果它本质上主要或完全是信息性的，并且您只是使用 MVC 来构建小册子类型的页面，那么它应该很容易移动。这假设除了页面到页面导航之外几乎没有逻辑。

如果您的站点转而推送大量依赖于后端服务器的数据，您将需要重新构建它以在本地存储数据或通过清单预取数据。接下来，您将需要实施一种策略，允许您将本地数据推送回服务器。

您的应用程序是否需要在断开连接状态下运行？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T08:16:58.293

如果您想针对多个移动平台并且可能使用最广泛，Phonegap 是选项之一。由于您使用的是 jQuery，因此 jQueryMobile 将是学习曲线最少的使用路径。工作量主要集中在前端 UI 上，这取决于您要设计多少个屏幕来提供 Web UI 上已有的子集或完整功能集。您很可能必须使用[此处记录](http://jquerymobile.com/demos/1.2.0/)的 jquery-mobile UI 小部件重新设计您的屏幕。这也是向您的客户展示带有导航的初始屏幕设计的好方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-09T13:10:37.220

jquery mobile 非常适合学习和设计，但是在手机间隙运行的网络浏览器控制中速度很慢。

为此，您需要一个更轻量级的框架。

you can use an inappbrowser control to show your site in case it's responsive , but you wont have the device camera and contacts and so ...

take a look at : [http://docs.phonegap.com/en/3.0.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser](http://docs.phonegap.com/en/3.0.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)

# python - 在 python 网络服务器中不断出现异常

> ID：13147405
> 
> 赞同：0
> 
> 时间：2012-10-30T20:51:42.860
> 
> 标签：python, exception, python-3.x

我有一个非常简单的 python 网络服务器，它返回一些网页，并且不断抛出`TypeError: 'str' does not support the buffer interface`. 这是我的代码，谁能告诉我哪里错了？

```
from os import curdir
from os.path import join as pjoin
from http.server import BaseHTTPRequestHandler, HTTPServer
class StoreHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == "/store.json":
            with open(pjoin(curdir, 'store.json')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/json')
                self.end_headers()
                self.wfile.write(fh.read())
        elif self.path == "/Stock.htm":
            with open(pjoin(curdir, 'stock.htm')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/html')
                self.end_headers()
                self.wfile.write(fh.read())
        else:
            with open(pjoin(curdir, 'index.htm')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/html')
                self.end_headers()
                self.wfile.write(fh.read())
    def do_POST(self):
        if self.path == '/store.json':
            length = self.headers.getheader('content-length')
            data = self.rfile.read(int(length))
            with open(pjoin(curdir, 'store.json'), 'w') as fh:
                fh.write(data)
            self.send_response(200)

server = HTTPServer(('', 8080), StoreHandler)
server.serve_forever() 
```

这是异常输出：

```
127.0.0.1 - - [30/Oct/2012 16:48:17] "GET / HTTP/1.1" 200 -
----------------------------------------
Exception happened during processing of request from ('127.0.0.1', 58645)
Traceback (most recent call last):
  File "C:\Program Files\Python33\lib\socketserver.py", line 306, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\Python33\lib\socketserver.py", line 332, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\Python33\lib\socketserver.py", line 345, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\Python33\lib\socketserver.py", line 666, in __init__
    self.handle()
  File "C:\Program Files\Python33\lib\http\server.py", line 400, in handle
    self.handle_one_request()
  File "C:\Program Files\Python33\lib\http\server.py", line 388, in handle_one_request
    method()
  File "C:\Users\Arlen\Desktop\Stock Recorder\webserver.py", line 25, in do_GET
    self.wfile.write(fh.read())
  File "C:\Program Files\Python33\lib\socket.py", line 317, in write
    return self._sock.send(b)
TypeError: 'str' does not support the buffer interface
---------------------------------------- 
```

**更新：**这是我更新后的代码的样子：

```
from os import curdir
from os.path import join as pjoin

from http.server import BaseHTTPRequestHandler, HTTPServer

class StoreHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == "/store.json":
            with open(pjoin(curdir, 'store.json')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/json')
                self.end_headers()
                self.wfile.write(fh.read(), 'rb')
        elif self.path == "/Stock.htm":
            with open(pjoin(curdir, 'stock.htm')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/html')
                self.end_headers()
                self.wfile.write(fh.read(), 'rb')
        else:
            with open(pjoin(curdir, 'index.htm')) as fh:
                self.send_response(200)
                self.send_header('Content-type','text/html')
                self.end_headers()
                self.wfile.write(fh.read(),'rb')
    def do_POST(self):
        if self.path == '/store.json':
            length = self.headers.getheader('content-length')
            data = self.rfile.read(int(length))
            with open(pjoin(curdir, 'store.json'), 'w') as fh:
                fh.write(data)
            self.send_response(200)

server = HTTPServer(('', 8080), StoreHandler)
server.serve_forever() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:03:01.053

套接字发送和接收字节，但您尝试通过 unicode 字符串发送，因为您在未指定模式的情况下打开文件（请记住，在 Python 3 中，默认情况下所有字符串都是 unicode）。

您可以：

*   使用[`bytes`内置函数](http://docs.python.org/3.3/library/functions.html#func-bytes)转换数据

*- 或者 -*

*   以二进制模式打开文件 - 更改`open(pjoin(curdir, 'a.file'))`为`open(pjoin(curdir, 'store.json'), 'rb')`（注意附加`rb`参数）。

# ios - iPad 键盘自动隐藏

> ID：13147411
> 
> 赞同：0
> 
> 时间：2012-10-30T20:52:16.967
> 
> 标签：ios, ipad, keyboard

我遇到了一个应用程序问题，每当用户登录（使用 SSO 身份验证）时，键盘将显示大约 5 秒钟，然后快速隐藏。然后，用户需要再次单击密码字段才能显示键盘，但是他们只有几秒钟的时间才能再次自动隐藏。

有没有人遇到过这个问题/知道任何修复？

提前非常感谢。

# filter - 从 Gmail 过滤和标签系统中排除已发送的电子邮件

> ID：13147412
> 
> 赞同：3
> 
> 时间：2012-10-30T20:52:19.293
> 
> 标签：filter, gmail, labels

我正在使用 gmail 标签在我的收件箱中创建不同的部分。问题是所有已发送的具有相同主题的电子邮件都会进入我在收件箱中标记的部分。是否仅在收到的电子邮件中排除已发送的电子邮件和标签？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-28T08:52:16.263

请试试这个：

```
in:inbox from:(-me) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-19T22:49:43.133

您可以使用感叹号使从句否定

```
!label:sent 
```

# javascript - 更改计时器超时的字体颜色

> ID：13147414
> 
> 赞同：1
> 
> 时间：2012-10-30T20:52:38.210
> 
> 标签：javascript, html, css

我找到了一个很好的例子来帮助我解释我想要做什么！

“倒计时标签每秒都在变化，随着倒计时的进行，颜色会逐渐从绿色变为红色。”

这是如何运作的？如果有人能以最简单的方式解释，我将不胜感激！

我知道它必须使用 JavaScript 并使用 innerHTML

我找到了一个名为 Display Morphing 并使用 AJAX 的链接。问题是我的导师从未告诉我我们必须使用 AJAX。显示变形是我想要做的事情的正确术语吗？

[http://ajaxpatterns.org/archive/Display_Morphing.php](http://ajaxpatterns.org/archive/Display_Morphing.php)

我是否使用此代码朝着正确的方向前进？我是否在“innerHTML =”之后放置某种类型的函数来告诉页面如何/何时更改字体颜色？

```
var hoursElement = document.getElementById("hours");
        hoursElement.innerHTML = 
var minutesElement = document.getElementById("minutes");
        minutesElement.innerHTML = 
var secondsElement = document.getElementById("seconds");
        secondsElement.innerHTML = 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:18:50.550

看起来您正在更新时间显示。这里有一些额外的提示可以帮助你：

1.  不需要 Ajax，只会使事情复杂化。查看`setTimeout`and `Date`，这应该足以满足您的需要。
2.  对于文本颜色，一旦您在 var 中有一个 dom 元素（例如），您可以使用其中 RR、GG、BB 是文本中红色、绿色和蓝色数量的十六进制数`timeContainer`来更改内部文本的颜色。`timeContainer.style.color = '#RRGGBB';`
3.  如果您还不了解它，请查看[http://jsfiddle.net](http://jsfiddle.net)，它将帮助您快速设置和测试您的 html 和 JavaScript 以查看它是否正常工作。

# nosql - Couchbase GUI 中文档的纯文本视图

> ID：13147416
> 
> 赞同：0
> 
> 时间：2012-10-30T20:52:43.037
> 
> 标签：nosql, couchbase

我正在使用 Couchbase 并在我的本地计算机上使用 ASP.NET 对其进行测试。我已将一些数据插入到示例文档中，并且可以使用 ASP.NET C# Driver for Couchbase 读取数据。问题是当我登录到集群管理 GUI 并查看文档时，我会看到很多没有意义的字符，实际上看不到我插入的文档的文本表示。使用 MongoDB、BigCouch、RavenDB，数据是简单明了的 JOSN 文档，并且很容易更新单个文档。我在这里错过了什么吗？

在我的 .NET 应用程序中，我有以下代码：

```
 var client = new CouchbaseClient();

 client.Store(StoreMode.Add, "aaa", "sample_data");
 client.Dispose(); 
```

当我查看文档时，我得到的是控制台中的内容：

```
"Y29tcGFyaXNvbl9pZDogMQ==" 
```

这是二进制格式，不是 JSON。**使用 CouchBase 2.0 测试版**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T14:33:09.577

在 Couchbase Server 2.0 中，如果您将无效 JSON 作为值存储在您保存的键/值对中，您将看到已保存项目的 Base64 编码版本。由于“sample_data”不是有效的 JSON 文档，Couchbase Server 将其视为字节数组。当您查看字节时，它们是 Base64 编码的。相反，如果您将 store 方法更改为如下所示：

```
client.Store(StoreMode.Add, "aaa", "{ \"message\" : \"sample_data\" }"); 
```

然后您会看到实际的 JSON 文档。

Couchbase 客户端最新 Beta 版的入门指南包含有关使用 JSON 和使用 Couchbase Server 2.0 的视图的更多信息 - [http://www.couchbase.com/develop/net/next](http://www.couchbase.com/develop/net/next)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T08:03:10.373

这是 Couchbase 2.0 GUI 显示的错误。现在我在 RHEL 6.0 中使用 couchbase-server-2.0.0-1723.x86_64，并使用 Coubase 2.0 GUI 创建新文档。当我在 json 下插入时：

```
{
  "_id": "100",
  "name": "Thomas",
  "dept": "Sales",
  "salary": 5000
} 
```

，然后在列出base64字符串时保存：

```
"eyJfaWQiOiIxMDAiLCJuYW1lIjoiVGhvbWFzIiwiZGVwdCI6IlNhbGVzIiwic2FsYXJ5Ijo1MDAwfQ==" 
```

我可以关注这篇文章：[base64 value display in GUI (Beta 2.0)](http://www.couchbase.com/forums/thread/base64-value-display-gui-beta-2-0)，修复此路径中的 javascript 代码：

```
/opt/couchbase/lib/ns_server/erlang/lib/ns_server-2.0.0r_331_g08fb51b/priv/public/js 
```

最后，清理浏览器缓存并再次登录 Couchbase 2.0 GUI。文件将显示：

```
"{"_id":"100","name":"Thomas","dept":"Sales","salary":5000}" 
```

这是正确的。

# php - SplRecurisveDirectoryIterator & 分层数组

> ID：13147422
> 
> 赞同：2
> 
> 时间：2012-10-30T20:53:01.467
> 
> 标签：php, hierarchical-data, spl

我想玩弄一些 PHP 的迭代器，并设法得到一个可靠的（根据我的理解）构建。我的目标是在父文件夹中迭代并关闭 2 个节点；在此过程中构建层次树数组。显然，我可以使用 glob 和几个嵌套循环来相当容易地做到这一点，但我想使用 Spl 类来实现这一点。

所有这些，我都在玩过 SplHeap 和 SplObjectStore 到层次结构并失败了。让我的面条搞砸的是我的正常递归方法失败（内存不足错误），而我的一个成功在于循环遍历每个节点并添加到数组的递归方法。这样做的问题是它忽略了 setMaxDepth() 方法并遍历了所有的孩子。我想过设置一个 $var++ 通过循环递增，限制节点，但我不相信这是“正确的方式”。

任何人，代码（抱歉，如果有任何孤立代码 - 请忽略它）...

```
<?php
namespace Tree;

use RecursiveFilterIterator,
    RecursiveDirectoryIterator,
    RecursiveIteratorIterator;

class Filter extends RecursiveFilterIterator {
    public static $FILTERS = array(
        '.git', '.gitattributes', '.gitignore', 'index.php'
    );

    public function accept() {
        if (!$this->isDot() && !in_array($this->current()->getFilename(), self::$FILTERS))
            return TRUE;

        return FALSE;
    }
}

class DirTree {
    const MAX_DEPTH = 2;

    private static $iterator;
    private static $objectStore;

    public function __construct() {

        error_reporting(8191);
        $path       = realpath('./');

        try {

            $dirItr     = new RecursiveDirectoryIterator($path);
            $filterItr  = new Filter($dirItr);
            $objects    = new RecursiveIteratorIterator($filterItr, RecursiveIteratorIterator::SELF_FIRST);

            $objects->setMaxDepth(self::MAX_DEPTH);

            echo '<pre>';
            print_r($this->build_hierarchy($objects));

        } catch(Exception $e) {
            die($e->getMessage());
        }
    }

    public function build_hierarchy($iterator){
        $array = array();
        foreach ($iterator as $fileinfo) {

            if ($fileinfo->isDir()) {
                // Directories and files have labels
                $current = array(
                    'label' => $fileinfo->getFilename()
                );
                // Only directories have children
                if ($fileinfo->isDir()) {
                    $current['children'] = $this->build_hierarchy($iterator->getChildren());
                }
                // Append the current item to this level
                $array[] = $current;
            }
        }
        return $array;
    }
}

$d = new DirTree; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T23:09:20.433

A`RecursiveIteratorIterator`的主要目的是为您提供一个迭代器，其行为类似于平面列表上的迭代器，但平面列表实际上只是递归遍历中的一个序列。它通过在内部管理一堆 RecursiveIterators 来做到这一点，并`getChildren()`在必要时调用它们。RecursiveIteratorIterator 的客户端实际上只应该调用诸如等之类的普通方法`Iterator`......除了增值方法，如`current()``next()``setMaxDepth()`

你的问题是你试图通过调用自己进行递归`getChildren()`。如果您想手动管理递归，那很好 - 但这会变得`RecursiveIteratorIterator`多余。事实上，我真的很惊讶在没有致命错误的情况下调用`getChildren`() 。`RecursiveIteratorIterator`那是一种`RecursiveIterator`方法。spl 可能只是将方法调用转发给内部迭代器（一些 spl 类将方法调用转发给未定义的方法，以便于使用装饰器设计模式）。

正确的方式：

```
 $dirItr     = new RecursiveDirectoryIterator($path);
    $filterItr  = new Filter($dirItr);
    $objects    = new RecursiveIteratorIterator($filterItr, RecursiveIteratorIterator::SELF_FIRST);

    $objects->setMaxDepth(self::MAX_DEPTH);

    echo '<pre>';
    foreach ($objects as $splFileInfo) {
        echo $splFileInfo;
        echo "\n";
    } 
```

我不打算为您以某种特定的结构形成分层数组，但也许这个相关的问题可以进一步帮助您理解RecursiveIteratorIterator 如何在 PHP 中工作`RecursiveIteratorIterator`和`RecursiveIterator` [如何工作之间的区别？](https://stackoverflow.com/questions/12077177/how-does-recursiveiteratoriterator-works-in-php?lq=1)

# template-toolkit - 模板工具包哈希值未打印且键未按数字排序

> ID：13147425
> 
> 赞同：0
> 
> 时间：2012-10-30T20:53:22.493
> 
> 标签：template-toolkit

以散列引用开头....

```
my $my_hash = {}; 
```

在循环中构建哈希...

```
push(@tmp_arr,$val1);
push(@tmp_arr,$val2);
$my_hash->{$index} = \@tmp_arr; 
```

任何键的元素都可以作为 $my_hash->{$index}[0] 访问

我正在传递这样的哈希：

```
my $vars = {
   myhash => $my_hash                
}; 
```

问题1：尝试像这样打印，它正确打印索引但不打印任何值....我很困惑为什么？

```
[%- FOREACH index IN myhash.keys.sort -%]
    <tt>index number=[%index%]  value_1=[%myhash.$index.0%]  value_2=[%myhash.$index.1%]<tt>
[% END -%] 
```

问题 2：排序不是数字排序，所以我得到 1,10,11,12.... 2,20,21....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:06:35.117

第一个问题可能是混淆了 $index 是指数组位置还是哈希键。我怀疑它可能假设一个数字键属于一个数组。

当您的哈希键可能与其他 vmethod 混淆时，[vmethod通常是一种有用的解决方法。`item()`](http://template-toolkit.org/docs/manual/VMethods.html#section_item)我会尝试以下方法：

```
<tt>index number=[%index%]  value_1=[%myhash.item(index).0%]
    value_2=[%myhash.item(index).1%]
</tt> 
```

第二个问题很[容易分类](http://template-toolkit.org/docs/manual/VMethods.html#section_sort_nsort)（如果你会原谅双关语）：

```
[%- FOREACH index IN myhash.keys.nsort -%] 
```

*顺便说一句，`<tt>`您的示例末尾还有另一个 open 标记，但我认为它`</tt>`在您的原始代码中是正确的（关闭）。*

# c++ - 在 Qt 中删除 QStringList

> ID：13147427
> 
> 赞同：0
> 
> 时间：2012-10-30T20:53:24.750
> 
> 标签：c++, qt, memory-management, memory-leaks

在 Qt 中，我知道如果您创建一个从 QObject 继承的对象并将其设置为父对象，则父对象负责删除子对象。我也明白，如果您在堆栈上创建对象，它们会在超出范围时被删除。

我并没有考虑要明确删除 QStringList （或任何 QList ）中的项目，然后是列表本身的情况。

考虑我是否创建一个 QStringList 并像下面这样填充它：

```
QStringList multiPartPortionList;
multiPartPortionList = multiPartPortion.split(QRegExp("[\r\n]"),QString::SkipEmptyParts); 
```

然后我用它做一些事情并调用这个方法来尝试显式删除列表中包含的项目，然后是列表本身：

```
void MyClass::deleteList(QStringList list) {

    // Now cleanup
    QStringList *delList = new QStringList(list);
    int numObjects = delList->count();
    for (int i=0; i < numObjects; i++)
        delete (new QString(list.takeAt(0)));
    delList->clear();
    delete delList;
    delList = 0;

} 
```

我不能调用 qDeleteall(list) 因为它需要一个指针，而且我也不能这样做：

```
delete list; 
```

由于它与**'argument given to 'delete', expected pointer'**出错，需要一个指针。

我得到分段错误：

```
void MyClass::deleteList(QStringList list) {

    // Now cleanup
    QStringList *delList = &list; // <--- Seg fault with this
    int numObjects = delList->count();
    for (int i=0; i < numObjects; i++)
        delete (new QString(list.takeAt(0)));
    delList->clear();
    delete delList;
    delList = 0;

} 
```

我还遇到以下分段错误：

```
void MyClass::deleteList(QStringList list) {

    // Now cleanup
    QStringList *delList = &list;
    int numObjects = delList->count();
    for (int i=0; i < numObjects; i++)
        delete &(list.takeAt(0)); // <--- Seg fault with this
    delList->clear();
    delete delList;
    delList = 0;

} 
```

然后我也遇到分段错误：

```
void MyClass::deleteList(QStringList list) {

    // Now cleanup
    QStringList *delList = new QStringList(list);
    int numObjects = delList->count();
    for (int i=0; i < numObjects; i++)
        delete (new QString(list.takeAt(0)));
    delList->clear();
    delete delList;
    delList = 0;
    delete &list; // <--- Seg fault with this

} 
```

我不认为这是完全正确的，甚至是接近正确的。我怎样才能最好地实现我想要的 - 即显式删除列表中的所有项目，然后再删除列表本身？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T20:58:01.027

您`QStringList list`会在函数结束时自动删除。无需担心在这里删除指针。

以相同的方式，

```
QStringList *delList = new QStringList(list); 
```

应该

```
QStringList delList = QStringList(list); 
```

更好的是：

```
QStringList delList = list; 
```

您应该阅读有关自动存储和 RAII 的信息。在你的代码中，`new`都是`delete`多余的。

要删除列表中的元素，请使用[removeAt](http://doc.qt.digia.com/qt/qlist.html#removeAt)。这与删除无关。

我还建议您在继续使用 C++ 之前获得一[本好书。](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)

# ruby-on-rails - Rails button_to 不在参数哈希中传递 id

> ID：13147430
> 
> 赞同：2
> 
> 时间：2012-10-30T20:53:45.547
> 
> 标签：ruby-on-rails

当单击按钮以使用 Twitter gem 获取推文并将其存储在我的数据库中时，我试图调用一个方法。

我有一个名为 Sponsor 的模型（其中包括一个存储 twitter 用户名的列）和一个名为 Sponsortweet 的模型：

模型/赞助商.rb：

```
class Sponsor < ActiveRecord::Base                                                      
  attr_accessible :facebook, :name, :twitter                                         
  has_many :sponsortweets, dependent: :destroy                                          
                                                                                          validates :name, presence: true, uniqueness: { case_sensitive: false }                
  VALID_TWITTER_REGEX = /\A^([a-zA-Z](_?[a-zA-Z0-9]+)*_?|_([a-zA-Z0-9]+_?)*)$/          
  validates :twitter, format: { with: VALID_TWITTER_REGEX },                            
                      uniqueness: { case_sensitive: false }                             

  def create_tweet                                                                      
    tweet = Twitter.user_timeline(self.twitter).first                                   
    self.sponsortweets.create!(content: tweet.text,                                     
                               tweet_id: tweet.id,                                      
                               tweet_created_at: tweet.created_at,                      
                               profile_image_url: tweet.user.profile_image_url,         
                               from_user: tweet.from_user,)                             
  end                                                                                   
end 
```

模型/sponsortweet.rb：

```
class Sponsortweet < ActiveRecord::Base
  attr_accessible :content, :from_user, :profile_image_url, :tweet_created_at, :tweet_id
    belongs_to :sponsor
    validates :content, presence: true
    validates :sponsor_id, presence: true

    default_scope order: 'sponsortweets.created_at DESC'
end 
```

在 controllers/sponsors_controller.rb 中：

```
def tweet
        @sponsor = Sponsor.find_by_id(params[:id])
        @sponsor.create_tweet
    end 
```

我的 routes.rb 中的相关行：

`match 'tweet', to: 'sponsors#tweet', via: :post`

在我看来（views/sponsors/show.html.haml）：

`= button_to :tweet, tweet_path`

使用此代码，单击按钮时出现以下错误： `undefined method`create_tweet' for nil:NilClass`

如果我改用 find（而不是 find_by_id），错误是： `Couldn't find Sponsor without an ID`

...这让我认为没有传递 ID，因为据我所知，使用 find 会引发错误，而 find_by_id 返回 nil。

我应该更改什么以使 ID 被传递？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:08:55.470

`id`您需要使用路径助手传递参数：

```
= button_to :tweet, tweet_path(:id => @sponsor.id) 
```

如果您不希望它出现在查询字符串中：

```
= form_tag tweet_path do |f|
  = hidden_field_tag :id => @sponsor.id
  = submit_tag "Tweet" 
```

这与您的 做同样的事情`button_to`，但在生成的表单中添加了一个隐藏字段。

# http - HTTP 缓存的默认代理行为是什么

> ID：13147433
> 
> 赞同：1
> 
> 时间：2012-10-30T20:54:13.320
> 
> 标签：http, proxy

我们构建了一个发送给客户的服务器。我们希望服务器在存在中间代理的情况下工作。我们不希望代理缓存我们的请求。

现在，我们的一个 servlet 使用以下 HTTP 标头显式禁用缓存：

```
Expires: Wed, 31 Dec 1969 17:00:00 MST 
```

我们的其他 servlet 没有指定任何与缓存相关的 HTTP 标头。我的问题是我们是否应该更改那些其他 servlet 也专门禁用缓存。特别是，当不存在缓存标头时，代理服务器会做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T07:28:04.297

(a) 如果您不提供缓存提示（例如 Cache-Control: no-cache -- [http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p6-cache-21.html#cache- response-directive.no-cache](http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p6-cache-21.html#cache-response-directive.no-cache)），代理可以启发式地缓存。

(b) Expires 标头字段示例中的日期无效：它可能没有任何效果。

# c# - ORA-00933: 运行创建序列命令时 SQL 命令未正确结束

> ID：13147434
> 
> 赞同：1
> 
> 时间：2012-10-30T20:54:14.063
> 
> 标签：c#, .net, sql, oracle

我正在尝试使用以下 C# 代码执行一些 sql：

```
IDbCommand objOracleCommand = CreateCommand(commandPart, connection, transaction);
objOracleCommand.ExecuteNonQuery(); 
```

我收到“ORA-00933：SQL 命令未正确结束”错误。

commandPart 是一个字符串，如下所示：

```
CREATE SEQUENCE seq_1
INCREMENT BY 1
START WITH 1
NOMAXVALUE
NOMINVALUE
NOCACHE
NOCYCLE
NOORDER

CREATE SEQUENCE seq_2 START WITH 1 INCREMENT BY 1 
```

commandPart 实际上是从文本文件中读取的。原始 SQL 有分号，如下所示：

```
CREATE SEQUENCE seq_1
INCREMENT BY 1
START WITH 1
NOMAXVALUE
NOMINVALUE
NOCACHE
NOCYCLE
NOORDER;

CREATE SEQUENCE seq_2 START WITH 1 INCREMENT BY 1; 
```

这个原始片段（带有分号）在 SQL Developer 中运行得很好。如果我通过 C# 运行原始片段，我会得到“ora-00911：无效字符”。有任何想法吗？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:02:05.993

您的命令部分由两个命令组成。Oracle 很困惑，因为它只需要一个命令。

您需要分别执行 ( `ExecuteNonQuery`) 这两个命令。

# angularjs - $resource url 中的查询字符串

> ID：13147435
> 
> 赞同：36
> 
> 时间：2012-10-30T20:54:21.160
> 
> 标签：angularjs

由于运行经典 ASP 的服务器的限制，我的服务必须使用查询字符串：

```
angular
  .module('myServices', ['ng', 'ngResource'])
  .factory('Item', ['$resource',
     function ($resource) {
         return $resource('/api/?p=item/:id');
     }]); 
```

我想向它添加额外的查询字符串参数：

```
Item.query({test: 123}, on_success, on_error); 
```

但生成的网址是

```
/api/?p=item?test=123 
```

显然有一个错误，但如何解决它？

编辑：在[https://github.com/angular/angular.js/issues/1511提交](https://github.com/angular/angular.js/issues/1511)

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-11-11T08:04:52.493

您可以使用资源参数。如果您没有在路径中指定占位符，它们将自动转换为查询字符串参数。像那样：

```
angular
    .module('myServices', ['ng', 'ngResource'])
    .factory('Item', [
         '$resource',
         function ($resource) {
             return $resource('/api');
     }]);

Item.query({p: 'item/1'}); 
```

这将导致请求`/api?p=item/1`.

附言

我想你已经知道了，但你不喜欢它。但我仍然认为这是你的正确方法。考虑到您正在处理该后端的糟糕 API 设计，您可以将 AngularJS 资源与另一个为您执行此操作的服务包装在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-06T10:27:27.603

```
var deferred = $q.defer();
api.api_name.query({
    'param':param_value
},
    function(response) {
        deferred.resolve(response);
    },
    function(response) {
        deferred.reject(response);
    }
);
//
angular
    .module('module_name')
    .factory('api',function($resource){
        var api_var={};
        api_var.api_name = $resource('url?param_key=:param', {
            param: '@param'
        }, {
            'query': {
                method: 'get'
            }
        });
        return api_var;
    }); 
```

# jsf-2 - Primefaces ManyCheckbox inside ui:repeat calls setter method only for last loop

> ID：13147440
> 
> 赞同：2
> 
> 时间：2012-10-30T20:54:41.443
> 
> 标签：jsf-2, checkbox, primefaces, omnifaces, selectmanycheckbox

I have a `<p:selectManyCheckbox>` inside `<ui:repeat>`, getting it's items from a List of a certain Object Class (provided by `<ui:repeat>`-variable) and is supposed to save the chosen items into another List of the same Object Class. But it calls the setter method `#{cartBean.setSelectedExtras}` only for the last entry (last iteration of `<ui:repeat>`).

```
<ui:repeat var="item" value="#{category.items}">
    <p:selectManyCheckbox id="extraCheckbox" value="#{cartBean.selectedExtras}" layout="pageDirection" converter="omnifaces.SelectItemsConverter">  
         <f:selectItems value="#{item.items5}" var="extra" itemLabel="#{extra.name}"/>
    </p:selectManyCheckbox>
</ui:repeat> 
```

**Update:** I changed the above construct just the way BalusC proposed.
Declaration in backing bean is now:

```
private List<List<Item>>  selectedExtras   = new ArrayList<List<Item>>(); 
```

When I check checkboxes that were created by the first loops of `<ui:repeat>` and click the `<p:commandButton>` inside the same `<h:form>` the setter method of `selectedExtras` is not called. When I check the checkboxes created in the last loop of `<ui:repeat>` and click the `<p:commandButton>` I get an Exception:

```
javax.el.PropertyNotFoundException: /lightbox-item.xhtml @57,165 value="#{cartBean.selectedExtras[iteration.index]}": null 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:05:25.100

This construct works fine for me.

As mentioned in among others [the showcase page](http://showcase.omnifaces.org/converters/SelectItemsConverter), the `omnifaces.SelectItemsConverter` uses by default the `toString()` representation of the complex object as converted item value. So if you didn't override the `toString()` method (so that it still defaults to `com.example.SomeClass@hashcode` which changes on every instantiation) and the `#{item}` managed bean is request scoped, then the list would basically be changing on every HTTP request. This would cause a "Validation Error: Value is not valid" error.

If you add

```
<p:messages autoUpdate="true" /> 
```

or

```
<p:growl autoUpdate="true" /> 
```

so that you get all (missing) validation/conversion messages in the UI, then you should have noticed it.

In order to utilize the `omnifaces.SelectItemsConverter` at its best, you should override the `toString()` method accordingly so that it returns a fixed and unique representation of the complex object. E.g.

```
@Override
public String toString() {
    return "Extra[id=" + id + "]";
} 
```

Alternatively, you could put the `#{item}` managed bean in a broader scope, such as the view scope.

* * *

**Update** as to your update, you're binding the selected values of *all* checkboxgroups to **one and same** bean property `#{cartBean.selectedExtras}`. This way every iteration overrides the property with the values from the current iteration round as long as until you end up with the values of the last iteration. If you've placed a debug breakpoint on the setter, you'd have noticed that.

This is not right. They should each point to a different bean property. Technically, you should have a `#{item.selectedExtras}` as property. But I think that this makes no sense in your current design. Better would be to make the `#{cartBean.selectedExtras}` an `List<Item[]>` or `Item[][]`. This way you can get them to set based on the iteration index as follows:

```
<ui:repeat var="item" value="#{category.items}" varStatus="iteration">
    <p:selectManyCheckbox id="extraCheckbox" value="#{cartBean.selectedExtras[iteration.index]}" layout="pageDirection" converter="omnifaces.SelectItemsConverter">  
         <f:selectItems value="#{item.items5}" var="extra" itemLabel="#{extra.name}"/>
    </p:selectManyCheckbox>
</ui:repeat> 
```

In case of `List<Item[]>` you only need to make sure that you preinitialize `selectedExtras` with nulls as many times as there are `#{category.items}` in bean's (post)constructor.

```
for (Item item : category.getItems()) {
    selectedExtras.add(null);
} 
```

In case of `Item[][]`, you can suffice with

```
selectedExtras = new Item[category.getItems().size()]; 
```

# android - Android Scala 和 Gradle

> ID：13147443
> 
> 赞同：4
> 
> 时间：2012-10-30T20:54:52.500
> 
> 标签：android, scala, gradle

我是 Gradle 的新手。是否有一些示例如何为 scala 类正确配置 gradle-android-plugin。

这就是我现在所拥有的。

```
buildscript {
repositories {  mavenCentral()  }

dependencies {  classpath 'org.gradle.api.plugins:gradle-android-plugin:1.2.1'  }
}

apply plugin: 'android'
apply plugin: 'eclipse'
apply plugin: 'scala'

sourceCompatibility = 1.6
version = "1.0.0"

repositories { mavenCentral() }

dependencies {  
    compile files('/home/pcu/workspace/workspace-android/emoo/libs/android-support-v4.jar') 
    compile 'org.scala-lang:scala-library:2.9.1'
    scalaTools 'org.scala-lang:scala-compiler:2.9.1'
    scalaTools 'org.scala-lang:scala-library:2.9.1'
}

task configureDebug << {  jar.classifier = "debug"  }

task configureRelease << {  proguard.enabled = true  } 
```

但编译失败。Scala 类未编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-10T09:10:45.933

使用正确的插件实际上要简单得多：

[https://github.com/saturday06/gradle-android-scala-plugin](https://github.com/saturday06/gradle-android-scala-plugin)

这对我来说非常好。

您只需要在 gradle 配置中再增加大约 3 行代码，并且可能需要 proguard 来减少 apk 大小。

该设置在 github 页面上有详细记录。步骤 1-3 之外的所有内容都是可选的。

# php - php 301 重定向到所有 t

> ID：13147445
> 
> 赞同：0
> 
> 时间：2012-10-30T20:54:53.850
> 
> 标签：php, http, redirect

根据：[每日博客提示](http://www.dailyblogtips.com/how-to-setup-a-301-redirect/)

下面的代码做了两件事：

1）它将添加（或删除）www。域内所有页面的前缀。

[2) 下面的代码将http://domain.com](http://domain.com)版本的访问者重定向到[http://www.domain.com](http://www.domain.com)。

**我的问题：**在 index.php 页面中插入下面的代码是否足以创建一个 301 重定向，该重定向将适用于我正在处理的网站的所有页面？

```
<?php
if (substr($_SERVER['HTTP_HOST'],0,3) != 'www') {
header('HTTP/1.1 301 Moved Permanently');
header('Location: http://www.'.$_SERVER['HTTP_HOST']
.$_SERVER['REQUEST_URI']);
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T20:56:22.273

> > 我的问题：在 index.php 页面中插入下面的代码是否足以创建一个 301 重定向，该重定向将适用于我正在处理的网站的所有页面？

不，那只适用于`http://www.example.com/index.php`而不适用于`http://www.example.com/whatever/whatever/file.php`。你最好使用[Apache mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)来完成这个任务。您可以将其粘贴在文档根`/.htaccess`文件中。

```
# Rewrite "example.com -> www.example.com".
<IfModule mod_rewrite.c>
  Options +FollowSymlinks
  RewriteEngine On
  RewriteCond %{HTTPS} !=on
  RewriteCond %{HTTP_HOST} !^www\..+$ [NC]
  RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
</IfModule> 
```

代码取自[HTML5 Boilerplate 的 .htaccess](https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess)

# sql - 在编写 SQL 之前考虑关系代数有多大好处？

> ID：13147449
> 
> 赞同：2
> 
> 时间：2012-10-30T20:55:04.713
> 
> 标签：sql, relational-algebra

在关于 dbms 的课程中​​，我们被教导在转换为 SQL 之前“在关系代数中提出解决方案”。它确实已经成为第二天性，几乎很难直接编写 SQL。这是坏的还是好的？有人告诉我，这会带来更好的查询，这很好，但如果每次被要求在数据库中查找某些内容时，他们开始在纸上写数学，我可以看到一个人很快就会被解雇。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T20:58:18.007

您会看到有人因为在急于解决问题之前解决问题而被解雇吗？

在提出解决方案之前，先解决您需要做的任何事情总是好的。随着时间的推移，随着你技能的进步，你会发现你不需要做太多的准备。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T20:57:53.350

这是一件好事。

太多的程序员在没有考虑关系的情况下使用 SQL，最终使用了不适合 SQL 的游标和循环机制，因为关系数据库针对关系代数进行了优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:03:07.150

好吧，关系代数的重点是它是普遍的。它并不特定于一个 DBMS。所以更多的人可以理解。

它可能更像是一种理论性的东西，你只会在学校看到，而不是真正在实践中看到，但这不是一个坏习惯。它可以在您开始编写查询之前为您提供帮助，从而节省时间

如果你的老板因为你在查询之前没有做关系代数而解雇你，我会感到惊讶，反之亦然。

此外，有些人使用它来优化他们的查询

# c# - 运行时c#中的非静态变量脚本

> ID：13147452
> 
> 赞同：0
> 
> 时间：2012-10-30T20:55:07.157
> 
> 标签：c#, csharpcodeprovider

我正在创建一些脚本并在运行时运行它们，但我只编译一次（除非代码更改）以避免“内存泄漏”，因为每次编译脚本时都会从内存中占用 X Kbs。

无论如何，我正在尝试找到一种方法来使用可以获取并为它们设置值的变量，因为如果我喜欢：

```
int x = 0;
x += 2;
MessageBox.Show(x.ToString()); 
```

它每次都会显示 2，因为它正在执行相同的代码，我想真正将此值设置为 x，但是当它再次执行时，它会显示 4、6、8 等，但为此我需要创建“ int x" 变量我可以得到它的地方。

我编写了一个变量列表并创建了一个方法，如 getvariable(x) 和 setvariable(x)，但是这个列表需要支持所有类型的 os 变量，int、strings、doubles 等。

你知道我该怎么做吗？

# javascript - 自定义溢出生成的水平滚动条：自动

> ID：13147454
> 
> 赞同：3
> 
> 时间：2012-10-30T20:55:09.563
> 
> 标签：javascript, jquery, html, css, jquery-ui

javascript/html 专家。谁能告诉我如何自定义 div 的内容水平溢出时出现的水平滚动条的外观？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:25:01.843

我知道至少一个脚本，它使自定义滚动条： [http ://www.dyn-web.com/code/scroll/demos.php#hz](http://www.dyn-web.com/code/scroll/demos.php#hz)

它不是免费的，但我认为，你可以看看它是如何制作的，并尝试自己制作，或者如果你喜欢它 - 你可以购买脚本并支持作者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:30:38.237

我专门为垂直滚动条创建了一个插件。这可以很容易地转换为我计划很快做的水平。这是跨浏览器兼容的，并且至少可以通过 ie8 恢复但这是我在 gitHub 上的插件的链接：

[scrollThis.js](http://bjoshuanoah.github.com/scrollThis.js/)

如果您能够应对挑战，请随时 fork 它，当您成功完成后，提交拉取请求。:)

# java - 无法从布局中删除视图

> ID：13147455
> 
> 赞同：1
> 
> 时间：2012-10-30T20:55:13.933
> 
> 标签：java, android, layout, view

我正在创建一个小应用程序，您可以在其中通过单击按钮添加或删除表格行。每当我单击“添加行”按钮时，该按钮都会在布局中添加一个表格行并执行它应该执行的操作。但是，“删除行”不会删除新添加的表格行，但会像预期的那样减少（int count）。我已经工作和搜索了大约 4 到 5 个小时，但我没有运气。这是代码：

```
int count = 0;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);       
    setContentView(R.layout.activity_main);
    Button buttonAdd = (Button) findViewById(R.id.button1);
    Button buttonDel = (Button) findViewById(R.id.button2);
    buttonAdd.setOnClickListener(this);
    buttonDel.setOnClickListener(this);
}

public void onClick(View v) {
    TableLayout tableLayout1;
    EditText editText1;
    EditText editText2;
    TableRow tempRow;
    EditText tempText1;
    EditText tempText2;
    TableRow tableRow1;

    tableLayout1 = (TableLayout) findViewById(R.id.tableLayout1);
    editText1 = (EditText) findViewById(R.id.editText1);
    editText2 = (EditText) findViewById(R.id.editText2);
    tempRow = new TableRow(MainActivity.this);
    tempText1 = new EditText(MainActivity.this);
    tempText2 = new EditText(MainActivity.this);
    tempText1.setInputType(InputType.TYPE_CLASS_TEXT);
    tempText2.setInputType(InputType.TYPE_NUMBER_FLAG_DECIMAL);
    tableRow1 = (TableRow) findViewById(R.id.tableRow1);

    tempRow.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
    tempText1.setLayoutParams(editText1.getLayoutParams());
    tempText2.setLayoutParams(editText2.getLayoutParams());
    switch(v.getId()){
    case R.id.button1:
        if(count != 9){
            count++;

            tempRow.addView(tempText1);
            tempRow.addView(tempText2);
            tableLayout1.addView(tempRow);
        } else {
            final AlertDialog alertDialog = new AlertDialog.Builder(MainActivity.this).create(); //Read Update
            alertDialog.setTitle("Error");
            alertDialog.setMessage("You can only have 10 rows!");

            alertDialog.setButton("Ok", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                  alertDialog.dismiss();
               }
            });

            alertDialog.show();
        }
        break;
    case R.id.button2:
        if(count != 0){
            count--;
            tempRow.removeView(tempText1);
            tempRow.removeView(tempText2);
            tableLayout1.removeView(tempRow);
            //tableLayout1.invalidate();

        } else {
            final AlertDialog alertDialog = new AlertDialog.Builder(MainActivity.this).create(); //Read Update
            alertDialog.setTitle("Error");
            alertDialog.setMessage("You must have at least one row!");

            alertDialog.setButton("Ok", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                  alertDialog.dismiss();
               }
            });

            alertDialog.show();
        }
        break;
        default:
            //Do something;
    }

} 
```

.

```
10-30 21:22:23.379: E/AndroidRuntime(3970): FATAL EXCEPTION: main
10-30 21:22:23.379: E/AndroidRuntime(3970): java.lang.NullPointerException
10-30 21:22:23.379: E/AndroidRuntime(3970): at com.android.hopegpacalc.MainActivity.onClick(MainActivity.java:57)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.view.View.performClick(View.java:3511)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.view.View$PerformClick.run(View.java:14105)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.os.Handler.handleCallback(Handler.java:605)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.os.Handler.dispatchMessage(Handler.java:92)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.os.Looper.loop(Looper.java:137)
10-30 21:22:23.379: E/AndroidRuntime(3970): at android.app.ActivityThread.main(ActivityThread.java:4424)
10-30 21:22:23.379: E/AndroidRuntime(3970): at java.lang.reflect.Method.invokeNative(Native Method)
10-30 21:22:23.379: E/AndroidRuntime(3970): at java.lang.reflect.Method.invoke(Method.java:511)
10-30 21:22:23.379: E/AndroidRuntime(3970): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
10-30 21:22:23.379: E/AndroidRuntime(3970): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
10-30 21:22:23.379: E/AndroidRuntime(3970): at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:03:51.850

这是组织问题，试试这个：

```
public void onClick(View v) {
    // These should be class variables, like count, you don't need to re-find it on every click
    TableLayout tableLayout1 = (TableLayout) findViewById(R.id.tableLayout1);
    EditText editText1 = (EditText) findViewById(R.id.editText1);
    EditText editText2 = (EditText) findViewById(R.id.editText2);

    switch(v.getId()){
    case R.id.button1:
        if(count != 9){
            count++;

            // Create the row only when the add button is clicked
            TableRow tempRow = new TableRow(MainActivity.this);
            EditText tempText1 = new EditText(MainActivity.this);
            EditText tempText2 = new EditText(MainActivity.this);
            tempText1.setInputType(InputType.TYPE_CLASS_TEXT);
            tempText2.setInputType(InputType.TYPE_NUMBER_FLAG_DECIMAL);

            tempRow.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            tempText1.setLayoutParams(editText1.getLayoutParams());
            tempText2.setLayoutParams(editText2.getLayoutParams());

            tempRow.addView(tempText1);
            tempRow.addView(tempText2);
            tableLayout1.addView(tempRow);
        } else {
            // Consider using Activity's showDialog() method, to reuse this "error" dialog rather than create a new one every time
            final AlertDialog alertDialog = new AlertDialog.Builder(MainActivity.this).create(); //Read Update
            alertDialog.setTitle("Error");
            alertDialog.setMessage("You can only have 10 rows!");

            alertDialog.setButton("Ok", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    alertDialog.dismiss();
                }
            });

            alertDialog.show();
        }
        break;
    case R.id.button2:
        if(count != 0){
            // Remove the last row at count or use "tableLayout1.getChildCount() - 1"
            tableLayout1.removeView(tableLayout1.getChildAt(count));
            count--;
        } else {
            // Consider reusing the other "error" Dialog and simply changing the message
            final AlertDialog alertDialog = new AlertDialog.Builder(MainActivity.this).create(); //Read Update
            alertDialog.setTitle("Error");
            alertDialog.setMessage("You must have at least one row!");

            alertDialog.setButton("Ok", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    alertDialog.dismiss();
                }
            });

            alertDialog.show();
        }
        break;
    default:
        //Do something;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:00:54.377

`TableRow`每次执行 onClick 时，您的代码都会生成一个新代码。只有在要添加行时才应该这样做。当您想删除一个时，您必须在现有视图中使用 找到要删除的行`findViewById( id )`，然后`removeView`在该对象上运行。

```
case R.id.button2:
    if ( count != 0 ) {
        count--;
        tempRow = (TableRow)findViewById( idoftablerowtodelete );
        tableLayout1.removeView( tempRow ); 
```

这确实意味着当您创建、使用`setId`和跟踪它时，您必须在每个表行上设置一个 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:09:23.660

您的删除代码正在“删除”`tempText1`实际上不在表中的临时视图（例如） - 它们是在`onClick`方法内部动态创建的。不要一进入 就实例化所有这些对象，而是`onClick`在每个 switch 语句案例的主体中这样做。对于添加按钮，只需复制和粘贴即可。对于删除之一，将对象设置为等于要删除的行。

您似乎没有办法选择要删除的行，但假设您在其他地方执行此操作，您可以使用`TableLayout.removeViewAt(int index)`它来选择哪一行。还有`TableLayout.removeView(View view)`，如果你有视图本身而不是索引。

# python - Tkinter 中的 Python 直播入口

> ID：13147458
> 
> 赞同：0
> 
> 时间：2012-10-30T20:55:37.600
> 
> 标签：python, tkinter, tkinter-entry

我想实时查看 Tkinter Entry 值。当我打字时，我看到 print 'downkey';。如果我输入 4 个字符，我看到的一个条目位于窗口底部 ok、ok、ok、ok 等。

```
from email . mime . multipart import MIMEMultipart
from email . mime . text import MIMEText
from Tkinter import *
from ttk import *

import ConfigParser
import smtplib

class Example ( Frame ):

    def __init__ ( self, parent ):

        self . ini ()
        Frame . __init__ ( self, parent )
        self . parent = parent
        self . initUI ()

    def initUI ( self ):

        self . parent . title ( "Quit button" )
        self . style = Style ()
        self . style . theme_use ( "default" )
        self . pack ( fill = BOTH, expand = 1 )
        inputfield = Entry ( self ) # I would like see this entry the app. window bottom in live, when i'm typewriter. If i key down/press call one function is class.
        inputfield . place ( x = 10, y = 10 )
        quitButton = Button ( self, text = "Quit", command = self . quit )
        quitButton . place ( x = 50, y = 50 )

def main ():

    root = Tk ()
    root . geometry ( "250x150+300+300" )
    app = Example ( root )
    root . mainloop ()

if __name__ == '__main__':

    main () 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:42:34.297

如果要在输入字段中键入后调用函数，则必须使用事件处理程序并将输入字段绑定到事件，例如按下返回和某些函数 xyz。这意味着按下回车后，可以调用函数 xyz。

要根据条目更新消息，您需要一个变量字符串作为条目的参数。

全局定义一个文本变量：

```
m=StringVar() 
```

在 Eample 类中添加：

您可以将变量文本添加到输入字段

```
inputfield = Entry ( self,textvariable=m )

self.inputfield.bind('<Return>',self.xyz)  #to call xyz which you may want to define 
```

并将文本变量添加到消息以更新它

```
message = Message(self,textvariable=m) #to update continuously the message which i hope you meant by "live" 
```

# ruby-on-rails-3 - Rails 3：create_association 验证失败并删除以前的关联记录

> ID：13147459
> 
> 赞同：2
> 
> 时间：2012-10-30T20:55:44.090
> 
> 标签：ruby-on-rails-3, validation, activerecord

假设我有两个模型。

```
class User < ActiveRecord::Base
  has_one :blog
end

class Blog < ActiveRecord::Base
  belongs_to :user

  validates_presence_of :user
  validates_uniqueness_of :user_id
end 
```

假设我有一个拥有博客的用户。出于某种原因，假设我呼叫`create_blog`的是同一个用户（我知道这不应该是一个选项，因为该用户已经有一个博客）。如果这个博客没有通过验证，它不仅不会保存，而且会删除用户之前的博客。

为什么会这样？为什么最初的博客被删除？这种行为是预期的还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:12:42.787

通过调用`create_blog`您是在告诉 Rails 放弃之前的博客。没有办法绕过这个（我知道）不涉及做这样的事情：

```
blog = Blog.new(params[:blog])
if blog.valid?
  user.blog = blog
  user.save
end 
```

# html - CSS Subnav 未保持活动状态

> ID：13147464
> 
> 赞同：1
> 
> 时间：2012-10-30T20:56:33.327
> 
> 标签：html, css, z-index

我试图用一些 z-index 的东西变得聪明。（父列表项与子 ul 重叠）但我认为一旦鼠标离开父列表项，它就会干扰我的子导航保持活动状态。我有一个小提琴来演示正在发生的事情。有任何想法吗？

[http://jsfiddle.net/dv8withn8/8QCZk/](http://jsfiddle.net/dv8withn8/8QCZk/)

（占位符页脚用于证明导航之后的所有内容都应该像内容区域一样具有小于 -1 的 z-index。）

# 标记：

```
<!DOCTYPE html>

<html>
<head>
    <title>Header Test</title>
    <link rel="stylesheet" href="style.css" type="text/css">
</head>

<body>
    <div id="global-header" class="header">
        <div id="secondary-nav" class="nav" role="toolbar" aria-label="User Tools">
            <div class="wrapper">
                <ul class="group">
                    <li><a href="">Item 1</a></li>

                    <li><a href="">Item 2</a></li>

                    <li><a href="">Item 3</a></li>

                    <li><a href="">Item 4</a></li>

                    <li><a href="">Item 5</a></li>

                    <li><a href="">Item 6</a></li>
                </ul>
            </div><!-- /.wrapper -->
        </div><!-- /#secondary-nav -->

        <div id="page-top" class="group">
            <div class="wrapper">
                <hgroup id="branding" class="group">
                    <h1 class="logo">Name!</h1>

                    <h2 class="slogan">Memorable slogan!</h2>
                </hgroup><!-- /#branding -->

                <div id="global-nav" class="nav" role="navigation" aria-label="Main Site Navigation">
                    <ul>
                        <li class="1"><a href="">Item 1</a></li>

                        <li class="2"><a href="">Item 2</a></li>

                        <li class="3"><a href="">Item 3</a></li>

                        <li class="4"><a href="">Item 4</a></li>

                        <li class="5"><a href="">Item 5</a></li>

                        <li class="expand user">
                            <a href="">Hi, <span class="user-name">John</span></a><a class="message-count">3</a>

                            <ul class="user-menu sub-nav" role="menu" aria-label="User Menu">
                                <li><a href="">Item 1</a></li>

                                <li><a href="">Item 2</a></li>

                                <li><a href="">Item 3</a></li>

                                <li><a href="">Item 4</a></li>

                                <li><a href="">Item 5</a></li>

                                <li><a href="">Item 6</a></li>
                            </ul>
                        </li>
                    </ul>
                </div><!-- /#global-nav -->
            </div><!--- /.wrapper -->
        </div><!-- /#page-top -->
    </div><!-- /#global-header -->

    <div id="content">
        <p>Hello, World!</p>
    </div>

    <div id="footer">
        <p>I'm a footer, lol!</p>
    </div>
</body>
</html> 
```

# 款式：

```
* {
    box-sizing:border-box;
}

html {
    font-size:100%;
}

body {
    margin:0 auto;
    font:1em/1 Helvetica,Arial,sans-serif;
    width:100%;
}

#global-header {
    width:100%;
}

.wrapper {
    margin:0 auto;
    max-width:960px;
}

.nav ul {
    list-style:none;
}

.nav ul > li {
    display:block;
    float:left;
}

.nav li a {
    display:block;
}

[role=toolbar] {
    display:block;
    margin:0 auto;
    width:100%;
    background:url(grey_diagnol.png) repeat;
    overflow:hidden;
}

[role=toolbar] ul {
    display:block;
    margin:0 auto;
    font-size:.625em;
    float:right;
}

[role=toolbar] li {
    margin:.5em 0;
}

[role=toolbar] li:not(:last-child) {
    border-right:1px solid #436394;
}

[role=toolbar] ul li > a {
    color:#436394;
    text-decoration:none;
    padding:.25em .72em;
}

[role=toolbar] a:hover {
    color:#a1c336;
}

#page-top {
    border-top:2px solid #32568F;
    background-color:#172842;
    color:#fff;
    width:100%;
    overflow:visible;

}

#branding {
    display:inline;
    float:left;
    line-height:2em;
    vertical-align:middle;
    padding-top:.9em;
}

#branding h1.logo {
    display:inline-block;
    margin:0;
    padding:0;
    float:left;
    text-indent:100%;
    overflow:hidden;
    background:url(logo.png) no-repeat left top;
    width:124px;
    height:27px;
    vertical-align:bottom;
    margin-right:.4em;
}

#branding h2 {
    display:inline-block;
    font-size:.625em;
    font-style:oblique;
    font-weight:400;
    float:left;
    margin:0;
    padding:0;
}

[role=navigation] ul {
    display:block;
    margin:0;
    padding:0;
    float:right;
}

[role=navigation] li {
    display:block;
    position:relative;
    margin-bottom:-5px;
    font-family:'MuseoSlab500',Georgia,'Times New Roman',serif;
    font-weight:700;
    font-size:1.2em;
    text-transform:lowercase;
}

[role=navigation] li:hover {
    background:#b4df5b;
    background:-moz-linear-gradient(top,#a1c336 0%,#88a13d 100%);
    background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#a1c336),color-stop(100%,#88a13d));
    background:-webkit-linear-gradient(top,#a1c336 0%,#88a13d 100%);
    background:-o-linear-gradient(top,#a1c336 0%,#88a13d 100%);
    background:-ms-linear-gradient(top,#a1c336 0%,#88a13d 100%);
    background:linear-gradient(to bottom,#a1c336 0%,#88a13d 100%);
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#a1c336',endColorstr='#88a13d',GradientType=0);
    box-shadow:0 1px 4px #000;
    text-shadow:1px 1px 1px #3D4427;
    color:#fff;
}

[role=navigation] a {
    color:#fff;
    text-decoration:none;
    padding:1em;
}

[role=navigation] .user-name {
    position: relative;
    text-transform:uppercase;
    font:.64em Helvetica,Arial,sans-serif;
    color:#a2bf39;
    text-shadow:none;
    /* max-width: 5em;
    overflow: hidden;
    text-overflow: clip;
    display: inline-block; */
}

[role=navigation] li:hover .user-name {
    color:#172842;
}

a.message-count {
    display: block;
    position: absolute;
    top: -2px;
    right: -2px;
    box-shadow: 0px 1px 4px black;
    border: 2px solid #fff;
    border-radius: 50px;
    padding: .25em .5em;
    background-color: #d52424;
    font: .75em Helvetica, Arial, sans-serif;
    font-weight: bold;
    color: #fff;
    cursor: pointer;
}
a.message-count:hover {
    background-color: red;
    box-shadow: 0px 1px 4px white;
}

[role=navigation] li ul.sub-nav {
    display:none;
    position:absolute;
    top:2.5em;
    left:-.75em;
    z-index:-1;
    box-shadow:0 1px 8px rgba(23,40,66,.5);
    border-right:1px solid #172842;
    border-bottom:1px solid #172842;
    border-left:1px solid #172842;
    padding-top:.5em;
    background-color:#ededf4;
}

[role=navigation] li:hover ul.sub-nav {
    display:block;
}

.sub-nav li {
    float:none;
    display:list-item;
    font-size:14px;
    font-size:.82rem;
    font-family:Helvetica,Arial,sans-serif;
    font-weight:400;
    min-width:150px;
    margin:0;
    text-shadow:none;
}

.sub-nav li:hover {
    background:#a1c336;
    text-shadow:none;
    box-shadow:none;
}

.sub-nav li a {
    padding:.5em .75em;
    color:#172842;
}

.sub-nav li a:hover {
    color:#fff;
}

#content {
    width: 100%;
    background-color: red;
    height: 100%;
    z-index: -2;
    position: relative;
}

#footer {
    width: 100%;
    background-color: blue;
    height: 100%;
}

/* group */
.group:after {
    content:".";
    display:block;
    clear:both;
    visibility:hidden;
    line-height:0;
    height:0;
    overflow:hidden;
    font-size:0;
}

.group {
    display:inline-block;
}

html[xmlns] .group {
    display:block;
}

* html .group {
    height:1%;
} 
```

# ssh - 远程服务器上的 ssh 杀死进程，pushd 脚本文件夹并执行脚本不工作

> ID：13147466
> 
> 赞同：1
> 
> 时间：2012-10-30T20:56:39.383
> 
> 标签：ssh

我需要杀死特定模式的远程进程，推送启动路径并执行脚本。到目前为止，我尝试过

```
pid=$(ssh -q username@virt ps -ef|grep $APP|grep $PORT|awk '{print $2}')

ssh -q username@virt kill -9 $pid
ssh -q username@virt "find /shared/local/path1/app -name "start_app*" -exec grep -nl "9122" {} \;| xargs -0 -I '{}' bash -c 'pushd $(dirname {});bash {};'" 
```

当我执行上述命令时，kill 处理工作正常。通过将文件夹推送到路径来查找脚本文件并执行脚本的最后一步不起作用。

由于某种原因，pushd 无法正常工作。本地服务器上的命令确实可以使用

```
find /shared/local/path1/app -name "start_app*" -exec grep -nl "9122" {} \;| xarg -0 -I '{}' bash -c 'pushd $(dirname {});bash {};' 
```

请帮助更有效的解决方案来完成此任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T13:21:12.510

您在此处的引号中有错误：

```
ssh -q username@virt "find /shared/local/path1/app -name "start_app*" -exec grep -nl "9122" {} \;| xargs -0 -I '{}' bash -c 'pushd $(dirname {});bash {};'" 
```

试试这个：

```
ssh -q username@virt "find /shared/local/path1/app -name 'start_app*' -exec grep -nl '9122' {} \;| xargs -0 -I '{}' bash -c 'pushd \$(dirname {});bash {};'" 
```

# charts - 在 WinRT XAML 工具包的图表控件中隐藏数据点

> ID：13147467
> 
> 赞同：1
> 
> 时间：2012-10-30T20:56:40.270
> 
> 标签：charts, windows-runtime, winrt-xaml, silverlight-toolkit, winrt-xaml-toolkit

是否可以从 CodePlex 的 WinRT XAML 工具包中隐藏图表控件中的数据点？我正在使用 LineSeries 并且只想要一条没有点的线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T23:56:43.607

这似乎有效。虽然我还不确定为什么它让我的线条变成橙色......

```
<charting:Chart
    x:Name="LineChart2"
    Title="Line Chart Without Data Points"
    Margin="70,0">
    <charting:LineSeries
        Title="Population"
        IndependentValueBinding="{Binding Name}"
        DependentValueBinding="{Binding Value}"
        IsSelectionEnabled="True">
        <charting:LineSeries.DataPointStyle>
            <Style
                TargetType="charting:LineDataPoint">
                <Setter
                    Property="BorderThickness"
                    Value="0" />
                <Setter
                    Property="IsTabStop"
                    Value="False" />
                <Setter
                    Property="Width"
                    Value="0" />
                <Setter
                    Property="Height"
                    Value="0" />
                <Setter
                    Property="Template">
                    <Setter.Value>
                        <ControlTemplate
                            TargetType="charting:LineDataPoint">
                            <Grid
                                x:Name="Root"
                                Opacity="0" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </charting:LineSeries.DataPointStyle>
    </charting:LineSeries>
</charting:Chart> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-06T05:19:11.667

@Filip Skakun 感谢您提供非常准确的答案，关于您关于**橙色线条**的问题，请尝试添加此属性并将颜色更改为您想要的任何颜色。

```
<Charting:LineSeries.DataPointStyle>
                            <Style TargetType="Charting:LineDataPoint">

                                <Setter Property="Background" Value="Red" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Charting:LineDataPoint">
                                            <Grid x:Name="Root" Opacity="0" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Charting:LineSeries.DataPointStyle> 
```

这主要是因为图表能够在单个图表上显示多个数据系列。对于 Series[0]，默认颜色设置为橙色。

# java - 用户输入的冒泡排序 = 错误

> ID：13147468
> 
> 赞同：-4
> 
> 时间：2012-10-30T20:56:40.803
> 
> 标签：java, bubble-sort

当我尝试调用我的冒泡排序类时出现了一些错误。但我找不到它。这是我的冒泡排序课程，应该没问题：

```
public static void Sort2(double[] yourNumbers) {
        double swap; 
        for(int i = 0; i < yourNumbers.length-1; i++){
            for(int d = 0; d < yourNumbers.length-1; d++){
                if(yourNumbers[d] > yourNumbers[d+1]){ 
                    //swap feature
                    swap = yourNumbers[d];
                    yourNumbers[d] = yourNumbers[d+1];
                    yourNumbers[d+1] = swap;

                }
            }
        }
    } 
```

这是我的主要方法（在​​这里，当我调用该`Sort2`方法时出现错误：

> sort.java 类型中的方法 Sort2(double[]) 不适用于参数 (int)

```
 System.out.println("Size");
        int yourNumbers = scan.nextInt();
        double[] array = new double[yourNumbers];

        System.out.println("Numbers");

        for(int i = 0; i < array.length; i++) {
            System.out.println(array[i]);
            array[i] = scan.nextDouble();

        }
            Sort2(array); 
```

我知道这里被问了很多次，但我觉得我做错了。请问你能帮我吗？PS：我不允许使用`ArrayList`.

编辑：这是我现在使用的代码。仍然无法工作：编辑 2：在这个[http://www.leepoint.net/notes-java/data/arrays/70sorting.html](http://www.leepoint.net/notes-java/data/arrays/70sorting.html)的帮助下，我明白了。一条线解决一切

```
import java.util.Scanner;

public class Bublesort{

    public static void main(String[] args) {
        Scanner scan = new Scanner(System.in);

        System.out.println("Size");
        int yourNumbers = scan.nextInt();
        double[] array = new double[yourNumbers];

        System.out.println("Numbers");

        for(int i = 0; i < array.length; i++) {
            System.out.println(array[i]);
            array[i] = scan.nextDouble();
         }

       Sort2(array);
    **System.out.println(Arrays.toString(array));** 

    }
    public static void Sort2(double[] yourNumbers) {
        double swap; 
         for(int i = 0; i < yourNumbers.length - 1; i++){
                for(int d = i + 1; d < yourNumbers.length; d++){
                    if(yourNumbers[i] > yourNumbers[d]){ 
                        //swap feature
                        swap = yourNumbers[i];
                        yourNumbers[i] = yourNumbers[d];
                        yourNumbers[d] = swap;

                    }
                }
            }

    }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T20:59:38.650

该错误表明您不能将 an 传递`int`给接受`double[]`为`argument`.

```
 System.out.println("Size");
        int yourNumbers = scan.nextInt();
        double[] array = new double[yourNumbers];

        System.out.println("Numbers");

        for(int i = 0; i < array.length; i++) {
            System.out.println(array[i]);
            array[i] = scan.nextDouble();
         }

       sort2(array);//**should work fine** 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:02:03.597

为了使用`ArrayList`，您必须导入`java.util.ArrayList;`您收到错误，因为您将整数传递给您的 Sort2() 函数。您需要向它传递一个双精度数组。此外，您的 sort2 函数将对数组进行排序，但您将无法引用它，因为 java 按值传递参数..您应该拥有您的函数`double[] sort2(double[] array)`，然后返回排序后的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:07:22.967

排序例程的更好版本应该类似于：N*(n-1) / 2 次迭代 vs n^2

```
 for(int i = 0; i < yourNumbers.length - 1; i++){
            for(int d = i + 1; d < yourNumbers.length; d++){
                if(yourNumbers[i] > yourNumbers[d]){ 
                    //swap feature
                    swap = yourNumbers[i];
                    yourNumbers[i] = yourNumbers[d];
                    yourNumbers[d] = swap;

                }
            }
        } 
```

# c++ - 冒泡排序给出访问冲突

> ID：13147475
> 
> 赞同：0
> 
> 时间：2012-10-30T20:56:52.810
> 
> 标签：c++, arrays, file, sorting, bubble-sort

大家好，我正在尝试完成一项课程作业，我需要按他们的 ID 号对一个充满员工的文件进行排序。文件中有 10 行，每行都有一个员工信息。订单是 ID LASTNAME FIRSTNAME

在我编写排序函数并将所有数据正确复制到数组中之前，该程序运行良好，但现在在添加排序函数后，我不断收到访问冲突，没有提示是什么导致它。

我将不胜感激任何帮助。

```
#include <iostream>
#include <string>
#include <fstream>
using namespace std;

class Employee
{
public:
    int _id;
    string _lastName;
    string _firstName;

    Employee()
    {
        _id = 0;
        _lastName = "n/a";
        _firstName = "n/a";
    }
};

void copyFile10(Employee [], int);
void sortFile10(Employee [], int);
int main()
{
    const int size10 = 10;
    Employee employees10[size10];

    copyFile10(employees10, size10); //1.fill array/copy file
    sortFile10(employees10, size10); //2\. sort

    system("pause");
    return 0;
}

void copyFile10(Employee employees10[], const int size)
{
    ifstream data10("data_10.dat");
    for(int count = 0; count < 10; count++) //1.fill array/copy file
    {
        data10 >> employees10[count]._id;
        data10 >> employees10[count]._lastName;
        data10 >> employees10[count]._firstName;
    }
    data10.close();
}

void sortFile10(Employee employees10[], const int size)
{
    Employee buff1;
    Employee buff2;
    int counter = 0;
    bool ordered = false;

    while (ordered == false)
    {
        for(int count = 0; count < size-1; count++)
        {
            if(employees10[count]._id > employees10[count+1]._id)
            {
                buff1._id = employees10[count+1]._id;
                buff1._lastName = employees10[count+1]._lastName;
                buff1._firstName = employees10[count+1]._firstName;

                buff2._id = employees10[count]._id;
                buff2._lastName = employees10[count]._lastName;
                buff2._firstName = employees10[count]._firstName;

                employees10[count]._id = buff1._id;
                employees10[count]._lastName = buff1._lastName;
                employees10[count]._firstName = buff1._firstName;

                employees10[count+1]._id = buff2._id;
                employees10[count+1]._lastName = buff2._lastName;
                employees10[count+1]._lastName = buff2._lastName;

                counter++;
            }
            if(counter == 0)
            ordered = true;
            else
                counter = 0;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:02:20.460

```
for(int count = 0; count < size; count++)
        {
            if(employees10[count]._id > employees10[count+1]._id) 
```

在循环的最后一次迭代中会发生什么（即`count`9 是什么时候）？

# jquery - 如何在 jqGrid 子网格列中显示带有锚标记的图像

> ID：13147480
> 
> 赞同：0
> 
> 时间：2012-10-30T20:57:21.830
> 
> 标签：jquery, jqgrid

我有一个子网格列，其中包含以下代码`subGridRowExpanded:`：

```
{ name: 'applytoall', index: 'applytoall',width: 44,
formatter:'showlink',
formatoptions:{baseLinkUrl:'mylink', 
idName:'myId', addParam:'&mainGridId='+rowId}} 
```

从上面的代码可以看出，当用户单击主网格中的一行并为子网格打开几行时，我想在子网格的每一行中显示一个链接，并且该链接应包含`&mainGridId='+rowId`在这种情况下，父网格也是 ( )。

但是，现在不是链接 ID，而是像带有锚标记的图像和其他所有行为方式相同的图像！

我发现自定义格式化程序可以这样做：

```
{ name: 'mycolname', index: 'mycolname',width: 44,formatter:some}

function some (cellvalue, options, rowObject)
{
   return "<a href=mylink?"
    +"myId="+cellalue.rowId+"&mainGridId="+(what should go here?)
    +"><img src='img/modify.gif'></a>"
} 
```

**问题**

我应该输入什么`what should go here`才能获得`ID`parentGrid 中的行。

如果有更好的方法来实现这一点，我会全力以赴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:13:26.103

如果我理解你是正确的，你应该只在回调`function some` *内部定义。* `subGridRowExpanded`在这种情况下，函数`some`可以访问外部范围内定义的所有变量。回调函数`subGridRowExpanded`作为`rowId`第二个参数，你可以直接使用它。

# optimization - 设置条件语句以利用指令预取（现代 x86）

> ID：13147491
> 
> 赞同：1
> 
> 时间：2012-10-30T20:57:49.740
> 
> 标签：optimization, assembly, x86

我最近拿起了 Michael Abrash 的*The Zen of Assembly Language*（从 1990 年开始），并且正在阅读关于指令预取如何并不总是有利的部分，例如发生分支（跳转）的情况。这是因为所有预取的指令都不再是要执行的指令，因此必须取更多的指令。

这让我想起了另一本旧书Andre LaMothe 的*Tricks of the Game Programming Gurus*中的优化，其中他建议在设置条件语句时，将最频繁（或预期）的路径放在首位。

例如：

```
if (booleanThatIsMostLikelyToBeTrue)
{
   // ...expected code
   // also the code that would've been prefetched
}
else
{
   // ...exceptional or less likely code
} 
```

我的问题是：

1) LaMothe 的优化是否考虑到这一点？（我已经没有书了）

2）这种类型的优化在现代机器上仍然是一个值得的编程习惯吗？（也许预取的处理方式与以前不同？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:52:12.123

这些类型的优化通常很有用。但是，这通常是您在编写程序、对其进行分析并确定程序将从这些微优化中受益之后执行的操作。

此外，许多现代编译器都有[配置文件引导优化](http://en.wikipedia.org/wiki/Profile-guided_optimization)，这可以让您不必为了性能而扭曲代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:21:15.763

您希望将代码设置为尽可能少地分支，并在分支时向后分支。执行该 IF 的更可靠方法是始终执行常见操作，然后测试异常：

做一个；如果（测试）做B；

当然，这必须安排好，如果 B 发生，A 所做的任何事情都会被 B 逆转。

Zen 编程的重点是尝试完全消除 If 语句。因此，例如，不是循环 10 次（这需要退出条件测试），您只需编写相同的语句 10 次，瞧！，没有 if 语句。另一个例子是，如果你正在循环一个列表，你使用一个哨兵来退出循环，而不是测试一个索引值。

如果您使用 C 语言工作，可能很难让编译器做您想做的事。在 IF 语句中放置第一个或第二个内容对编译结果没有影响。请注意，使用正确的编译器选项至关重要。例如，在 Visual C++ 中使用 /O2（优化速度）会大大提高编译效率。

# wix - 如何将 64 位和 32 位 Windows Installer 包部署为单个安装程序？

> ID：13147498
> 
> 赞同：16
> 
> 时间：2012-10-30T20:58:16.963
> 
> 标签：wix, windows-installer, bootstrapping, dotnetinstaller

我需要部署针对 Windows 64 位和 32 位的软件设置。对于每个平台，我都有两个单独的 Windows Installer 数据库（使用[WiX](http://wix.sourceforge.net/)创建），并且我正在使用[dotNetInstaller](http://dblock.github.com/dotnetinstaller/)将两者组合成一个安装引导程序可执行文件。

我目前正在使用 dotNetInstaller 和 set 1.10 版`auto_close_if_installed=True`，因为我想完全对用户隐藏引导程序。尽管如此，dotNetInstaller 仍然坚持在我的安装程序运行时显示窗台进度条窗口，并且不会真正自动关闭。用户需要确认一个对话框，告诉他应用程序已成功安装。但真正的交易破坏者是它不支持 Windows 8（还）。

升级到更高版本的 dotNetInstaller 似乎会中断`auto_close_if_installed`，因此情况更糟。

所以我的问题是：在一个可执行文件中部署这两个设置的当前最先进的技术是什么。Wix [Burn](http://robmensching.com/blog/posts/2009/7/14/Lets-talk-about-Burn)会是一种选择吗？

我知道，在理想情况下，我只是为我的客户提供两个平台的单独安装程序。但他们恰好完全没有意识到这些微妙之处，他们中的大多数甚至不知道他们使用的是什么平台。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-13T07:45:19.563

在这种情况下，我肯定会使用 Burn。类似于以下内容：

```
<Wix>
  <Bundle...>
    <BootstrapperApplicationRef Id='WixStandardBootstrapperApplication.HyperlinkLicense' />

    <Chain>
      <MsiPackage InstallCondition='NOT VersionNT64' SourceFile='path\to\x86.msi' />
      <MsiPackage InstallCondition='VersionNT64' SourceFile='path\to\x64.msi' />
    </Chain>
  </Bundle>
 </Wix> 
```

这正是 Burn 旨在处理的场景之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T23:06:31.050

您可以通过条件和功能在单个 Wix 中完成此操作。

```
<Feature Id='X86' Level='1'>
  <ComponentRef Id='X86Feature1' />
  <Condition Level="1">NOT VersionNT64</Condition>
</Feature> 
```

# jquery - jquery mobile自定义菜单与页脚冲突

> ID：13147500
> 
> 赞同：2
> 
> 时间：2012-10-30T20:58:25.017
> 
> 标签：jquery, iphone, mobile

IOS 移动设备中 jquery 移动自定义选择菜单和页脚的问题（这在模拟器中工作正常）： 1\. 快速滑动菜单时会短暂弹出原生选择菜单。接下来选择菜单最终加载。然后页脚消失。2.当显示一个长的自定义选择菜单并且用户向下滚动到底部然后关闭选择菜单时，页脚在上一页上是“浮动的”

注意：自定义选择菜单可以在没有页脚的情况下正常工作。 [http://jquerymobile.com/demos/1.2.0/docs/forms/selects/custom.html](http://jquerymobile.com/demos/1.2.0/docs/forms/selects/custom.html)

示例：http: [//jsbin.com/utuxuv/1](http://jsbin.com/utuxuv/1)

# google-maps-api-3 - 使用 Google Static Maps API URL 渲染多边形

> ID：13147503
> 
> 赞同：6
> 
> 时间：2012-10-30T20:58:31.923
> 
> 标签：google-maps-api-3, google-static-maps

我创建了一个脚本，通过将属性附加到静态地图 URL 来存储动态地图输入（因此我们可以在用户提交后引用它）。

由于我还无法确定的原因，Polygon 根本没有使用基本的静态地图 URL 进行渲染，但它可以与 3rd 方站点的静态地图功能一起使用。根据静态地图 API 示例，应该没有问题，但我似乎无法重新创建多边形。

[来自第 3 方站点的工作版本](http://staticmaps.cloudmade.com/8ee2a50541944fb9bcedded5165f09d9/staticmap?%20center=33.402285,-111.94271500000002&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color%3ared|weight:1|fill%3awhite|opacity:0.75|33.4022475,-111.9426775|33.4022475,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775)（在 URL 中具有相同的属性，尽管它忽略了卫星和缩放分辨率）。

缺少多边形的[所需版本。](http://maps.googleapis.com/maps/api/staticmap?center=33.402285,-111.94271500000002&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color%3ared|weight:1|fill%3awhite|opacity:0.75|33.4022475,-111.9426775|33.4022475,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775)

问题是：我是否缺少某些参数？我确实有一个从 URL 中删除的 API 密钥，所以这一定不是问题..

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-30T22:46:00.097

您原来的*Desired Version*使用了 Google 不支持的参数。删除`opacity:0|`它就可以了：

[http://maps.googleapis.com/maps/api/staticmap?center=33.402285,-111.94271500000002&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color%3ared|weight:1|fill%3awhite|33.4022475,-111.94247575|33.402 ,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775](http://maps.googleapis.com/maps/api/staticmap?center=33.402285,-111.94271500000002&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color%3ared|weight:1|fill%3awhite|33.4022475,-111.9426775|33.4022475,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775)

谷歌地图上的不透明度在[颜色中设置为 32 位十六进制值](https://developers.google.com/maps/documentation/staticmaps/#PathStyles)，所以

*   细蓝线，0% 不透明度：path=color:0x0000ff00
*   100% 不透明度的实心红线：path=color:0xff0000ff
*   如果传递 24 位颜色，则默认值为 50%：0x0000ff（50% 不透明度，蓝色）

所以我认为这就是您正在寻找的（或非常接近的）：

[http://maps.googleapis.com/maps/api/staticmap?center=33.402285,-111.942715&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color:red|weight:1|fillcolor:white|33.4022475,-111.9426775|33.4022475 ,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775](http://maps.googleapis.com/maps/api/staticmap?center=33.402285,-111.942715&zoom=20&size=600x600&maptype=satellite&sensor=false&path=color%3ared|weight:1|fillcolor%3awhite|33.4022475,-111.9426775|33.4022475,-111.9427525|33.4023225,-111.9427525|33.4023225,-111.9426775|33.4022475,-111.9426775)

# sql-server - 有没有办法在大于 900 字节的列上创建唯一约束？

> ID：13147504
> 
> 赞同：1
> 
> 时间：2012-10-30T20:58:44.533
> 
> 标签：sql-server, indexing, primary-key

我对 SQL Server 还很陌生，所以如果我说的任何话都没有道理，我很有可能只是被某些东西弄糊涂了。反正...

我有一个简单的映射表。它有两列，`Before`和`After`。我想要的只是该`Before`列是唯一的约束。最初它被设置为主键，但是当值太大时会产生错误。我尝试添加一`ID`列作为主键，然后添加`UNIQUE`到该`Before`列，但我遇到了最大长度超过 900 个字节的相同问题（我猜该约束会创建一个索引）。

我能想到的唯一选择是将`id`列更改为校验和列并将其设为主键，但我不喜欢这个选项。有不同的方法可以做到这一点吗？我只需要两个简单的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:00:31.540

我能想到的保证数据库内部唯一性的唯一方法是使用[INSTEAD OF](http://msdn.microsoft.com/en-us/library/aa175158%28v=sql.80%29.aspx)触发器。我提供给 MSDN 的链接有一个检查唯一性的示例。这个解决方案很可能确实很慢，因为您将无法对正在检查的列进行索引。

您可以通过使用计算列创建散列来加快它的速度，也许使用[HASHBYTES 函数](http://msdn.microsoft.com/en-us/library/ms174415.aspx)，之前列。然后，您可以在该哈希列上创建一个非唯一索引，并在您的触发器中检查否定情况——即检查是否*不*存在具有相同哈希的行。如果发生这种情况，请退出触发器。如果有另一行具有相同的哈希值，您可以对精确重复进行更昂贵的检查，如果用户输入重复值则引发错误。您还可以通过简单地比较一个 EXISTS() 子句中的哈希值和 Before 值来简化检查，但我还没有尝试过该解决方案的性能。

（请注意，我提到的 HASHBYTES 函数本身最多只能散列 8000 字节。如果你想比这更大，你必须滚动你自己的散列函数或忍受由 CHECKSUM() 函数引起的冲突）

# google-chrome-devtools - 在 Chrome 开发者工具 22 中看不到动态加载的代码

> ID：13147505
> 
> 赞同：27
> 
> 时间：2012-10-30T20:58:47.337
> 
> 标签：google-chrome-devtools

当我通过 AJAX 动态加载包含 javascript 的 html 片段时，我无法在 Chrome 22.0.1229.94 的开发人员工具窗口的源选项卡中看到该内容。很明显，我去了这里

[https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints#js_dynamic](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints#js_dynamic)

此页面显示了一个已过期的示例开发人员工具窗口。页面上有一个加载动态脚本的按钮，当您这样做时，它不会显示在源选项卡中。

作为一种解决方法，我发现添加

```
debugger; 
```

到脚本并重新加载它会导致它在动态加载的代码中暂停，但不幸的是，所有的行号都是灰色的，你不能在调试器中设置任何断点。

我在这里遗漏了什么还是什么？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-08-02T01:43:29.043

当您使用动态加载的库或 javascript 代码时，您可以使用该短语

```
//@ sourceURL=foo.js 
```

在您的 javascript 代码的开头，*foo.js*是将分配给它的名称。调试器将使用该名称显示它。这在 chrome 中是正确的，我认为在 firebug 中也是如此。在这种情况下，您可以在动态加载的 javascript 代码中放置一个断点。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-09-01T09:20:23.773

可能重复： [是否可以通过 WebKit、FireBug 或 IE8 开发工具等调试器来调试动态加载 JavaScript？](https://stackoverflow.com/questions/1705952/is-possible-to-debug-dynamic-loading-javascript-by-some-debugger-like-webkit-fi)

不知道这在 chrome 中是否有效（这对我现在肯定不起作用，可能在过去）。

```
//@ sourceURL=foo.js 
```

**工作解决方案**

为了让您通过 ajax 动态加载的脚本出现在您的 chrome 源工具中，您需要在脚本文件的开始或结束（我更喜欢）位置添加以下行：

```
//# sourceURL=foo.js 
```

您的名为 foo.js 的脚本将出现在*（无域）*下拉列表下的源选项卡的左窗格中

-> 本地主机——源/src

->（无域）-- foo.js

[![在此处输入图像描述](../Images/79af5b1bd48b0dd5395e8254078f3522.png)](https://i.stack.imgur.com/xv63r.png)

或者，您可以在脚本之间的任何位置添加以下行。

```
debugger; 
```

在 chrome 中，当调试器面板打开时，您可以使用“debugger;”语句在语句处中断。如果调试器面板关闭，Chrome 将简单地忽略这一点。

这将有助于在调试模式下停止您的脚本，您将在源（调试）面板中看到您的脚本，其名称类似于 VM****。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-01T05:54:18.720

您可以使用 //@ sourceURL。Chrome 似乎不支持内联脚本的 //@ sourceURL。但是，它确实适用于 eval 表达式。[本文](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/)提供了有关命名 eval 块和命名代码中任何匿名函数的更多详细信息。

您可以尝试嵌入脚本标签或 JSONP，而不是使用 eval。

瓦伦库马尔·纳加拉扬

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-15T17:56:29.760

对我来说，它发生在 nodejs 项目上。

我重新启动服务器并**在新选项卡中打开**我的应用程序和***tada***！..

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2013-09-24T05:51:10.657

> 或者，要解决此问题，您可以通过单击图标在单独的窗口中打开开发人员工具。现在重新加载您的脚本，它将按预期显示在脚本选项卡中。我知道这不是解决方案，而是解决方法。 ![在此处输入图像描述](../Images/4fb733e9d4c7d5c0153d3a3e58244ff6.png)

# jquery - CheckBoxList的Ajax json选择器获取值

> ID：13147506
> 
> 赞同：0
> 
> 时间：2012-10-30T20:58:59.213
> 
> 标签：jquery, asp.net, ajax, json, checkboxlist

```
<script type="text/javascript" language="javascript">
$(document).ready(function() {
    $("#progressbar").progressbar({
        value: 0
    });
    $("#btnGetData").click(function() {
        updateProgress();
        var intervalID = setInterval(updateProgress, 5000);
        $("#progressbar").progressbar({
            value: 0
        });
        $("#result").text(' ');
        $.ajax({
            type: "POST",
            url: "ListaInformes.aspx/GetText",
            data: "{fechain: '" + $('#txtFechaInicio').val() + "', fechafin: '" + $('#txtFechaFin').val() + "', tiporeporte: '" + $('#DDLTipoInforme').val() + "', segmento:'" + $('#DDLSegmento').val() + "', categoria:'" + $("#<%=ddlCategorias.ClientID%>").val() + "', area:'" + $("#<%=ddlarea.ClientID %>").val() + "', idusuario:'<%=Session("
            IdUsuario ") %>', tipofecha: '" + $('#RBL_TipoFecha input:checked').val() + "',regional:'" + $("#<% = CheckBoxRegional.ClientID %> input:checkbox[checked=true]").serializeArray() + "'}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function(msg) {
                $("#progressbar").progressbar("value", 100);
                $("#result").html(msg.d);
                clearInterval(intervalID);
            }
        });
        return false;
    });
});

function updateProgress() {
    var value = $("#progressbar").progressbar("option", "value");
    if (value < 100) {
        $("#progressbar").progressbar("value", value + 1);
    }
}​
</script> 
```

我正在使用 JSON、jQuery 和 ASP.net 创建一个由数据库填充的复选框列表类型控件。问题是我创建了一个选择器来知道它们是否被选中并且还知道该值。

我需要你在该区域存储变量检查资产及其值？到目前为止，只告诉我哪些是活跃的，而不是它的价值。

申请如下：

选择器 jquery 复选框列表

```
<div id="main">
  <table width="100%">
    <tr id="tr_fechausuario" runat="server" align="left">
      <td colspan="2">
        <table width="100%">
          <tr>
            <td width="50%">Fecha de Inicio&nbsp;&nbsp;&nbsp;
              <asp:TextBox ID="txtFechaInicio" runat="server"
              CssClass="textbox"></asp:TextBox>
            </td>
            <td width="50%">Fecha de Fin&nbsp;&nbsp;&nbsp;
              <asp:TextBox ID="txtFechaFin" runat="server"
              CssClass="textbox"></asp:TextBox>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="tr2" runat="server" align="left">
      <td colspan="2">&nbsp;</td>
    </tr>
    <tr id="tr1" runat="server" align="left">
      <td class="style3">Seleccione el tipo de consulta</td>
      <td class="style1">
        <asp:RadioButtonList ID="RBL_TipoInforme" runat="server" CssClass="textbox"
        AutoPostBack="True">
          <asp:ListItem Value="0">Informe de Casos</asp:ListItem>
          <asp:ListItem Value="1">Informe Histórico</asp:ListItem>
        </asp:RadioButtonList>
      </td>
    </tr>
    <tr id="spacer1" runat="server" align="left">
      <td colspan="2" class="style6"></td>
    </tr>
    <tr id="tr_spacer" runat="server" align="left">
      <td class="style7">Seleccione el criterio de las fechas</td>
      <td>
        <asp:RadioButtonList ID="RBL_TipoFecha" runat="server">
          <asp:ListItem Selected="True" Value="1">Fecha de Creación</asp:ListItem>
          <asp:ListItem Value="2">Fecha de Vencimiento</asp:ListItem>
          <asp:ListItem Value="3">Fecha de Solución</asp:ListItem>
        </asp:RadioButtonList>
      </td>
    </tr>
    <tr id="spacer2" runat="server" align="left" visible="True">
      <td class="style5">&nbsp;</td>
      <td class="style5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
    <tr id="tr_tipoinforme" runat="server" align="left" visible="False">
      <td class="style8">Seleccione el tipo de informe</td>
      <td class="style2">
        <asp:DropDownList ID="DDLTipoInforme" runat="server" AutoPostBack="True"
        DataSourceID="SQLDS_Informes" DataTextField="iet_NombreInforme" DataValueField="iet_TipoInforme"
        Enabled="False" CssClass="textbox" Height="20px" Width="548px"></asp:DropDownList>
        <asp:SqlDataSource ID="SQLDS_Informes" runat="server"
        ConnectionString="<%$ ConnectionStrings:bdcmp_EcopetrolCRMConnectionString %>"
        SelectCommand="eco_spInformeEstadisticaConsulta" SelectCommandType="StoredProcedure">
          <SelectParameters>
            <asp:Parameter DefaultValue="2" Name="Donde_1" Type="Int32" />
            <asp:SessionParameter DefaultValue="96" Name="IdUsuario_2" SessionField="IdUsuario"
            Type="Int32" />
            <asp:Parameter DefaultValue="0" Name="TipoInforme_3" Type="Int32" />
          </SelectParameters>
        </asp:SqlDataSource>
      </td>
    </tr>
    <tr id="spacer3" runat="server" align="left" visible="True">
      <td class="style4" colspan="2">&nbsp;</td>
    </tr>
    <tr id="tr_segmento" runat="server" align="left" visible="false">
      <td class="style7">Seleccione el segmento</td>
      <td>
        <asp:DropDownList ID="DDLSegmento" runat="server" Width="200px" CssClass="textbox"
        AutoPostBack="True"></asp:DropDownList>
      </td>
    </tr>
    <tr id="Tr3" runat="server" align="left" visible="True">
      <td class="style4" colspan="2">&nbsp;</td>
    </tr>
    <%-- Se añade nuevo campos regional--%>
      <tr id="tr_regional" runat="server" visible="False">
        <td>Selecciones la Regional</td>
        <td>
          <asp:CheckBoxList ID="CheckBoxRegional" runat="server" Font-Size="X-Small"></asp:CheckBoxList>
          <asp:DropDownList ID="DDLRegional" runat="server" Visible="False"></asp:DropDownList>
        </td>
      </tr>
      <tr id="Tr7">
        <td></td>
        <td></td>
      </tr>
      <tr id="tr_Categorias" runat="server" align="left" visible="false">
        <td class="style7">Seleccione la Categoria</td>
        <td>
          <asp:DropDownList ID="ddlCategorias" runat="server" CssClass="textbox"
          Width="200px" ToolTip="Seleccione la Categoria"></asp:DropDownList>&nbsp;
          <asp:RequiredFieldValidator ID="Rv_Categoria"
          runat="server" ControlToValidate="ddlCategorias" Display="Dynamic" ErrorMessage="*"
          InitialValue="0" SetFocusOnError="True" Visible="False"></asp:RequiredFieldValidator>
        </td>
      </tr>
      <tr id="Tr4" runat="server" align="left" visible="True">
        <td class="style4" colspan="2">&nbsp;</td>
      </tr>
      <tr id="tr_Area" runat="server" align="left" visible="false">
        <td class="style7">Seleccione el Area</td>
        <td>
          <asp:DropDownList ID="ddlarea" runat="server" Width="200px" CssClass="textbox"
          AutoPostBack="False"></asp:DropDownList>
        </td>
      </tr>
      <tr>
        <td></td>
        <td></td>
      </tr>
  </table>
  <br />
  <div id="progressbar"></div>
  <div id="result"></div>
  <br />
  <center>
    <asp:Button ID="btnGetData" runat="server" Text="Generar Informe" CssClass="button"
    ForeColor="#336699" Enabled="false" />
  </center>
</div> 
```

# c# - 使用 Simple Injector 实现每个线程和每个 Web 请求的混合生活方式

> ID：13147509
> 
> 赞同：14
> 
> 时间：2012-10-30T20:59:15.687
> 
> 标签：c#, dependency-injection, inversion-of-control, simple-injector

我正在`SimpleInjector`用作我的 IoC 库。我`DbContext`根据网络请求注册，它工作正常。但是有一项任务是我在后台线程中运行的。所以，我在创建`DbContext`实例时遇到了问题。例如

1.  `Service1`有一个实例`DbContext`
2.  `Service2`有一个实例`DbContext`
3.  `Service1`并`Service2`从后台线程运行。
4.  `Service1`获取一个实体并将其传递给`Service2`
5.  `Service2`使用该实体，但实体与`DbContext`

实际上问题就在这里：`Service1.DbContext`与`Service2.DbContext`.

似乎当我在 ASP.NET MVC 的单独线程中运行任务时，会为每个调用`SimpleInjector`创建一个新实例。`DbContext`虽然一些 IoC 库（例如`StructureMap`）对 per-thread-per-webrequest 有一种混合的生活方式，但似乎`SimpleInjector`没有。我对吗？

你有什么想法解决这个问题`SimpleInjector`吗？提前致谢。

**编辑：**

我的服务在这里：

```
class Service1 : IService1 {
    public Service1(MyDbContext context) { }
}

class Service2 : IService2 {
    public Service2(MyDbContext context, IService1 service1) { }
}

class SyncServiceUsage {
    public SyncServiceUsage(Service2 service2) {
        // use Service2 (and Service1 and DbContext) from HttpContext.Current
    }
}

class AsyncServiceUsage {
    public AsyncServiceUsage(Service2 service2) {
        // use Service2 (and Service1 and DbContext) from background thread
    }
}

public class AsyncCommandHandlerDecorator<TCommand> 
    : ICommandHandler<TCommand> where TCommand : ICommand {

    private readonly Func<ICommandHandler<TCommand>> _factory;

    public AsyncCommandHandlerDecorator(Func<ICommandHandler<TCommand>> factory) {
        _factory = factory;
    }

    public void Handle(TCommand command) {
        ThreadPool.QueueUserWorkItem(_ => {
            // Create new handler in this thread.
            var handler = _factory();
            handler.Handle(command);
        });
    }
}

void InitializeSimpleInjector() {
    register AsyncCommandHandlerDecorator for services (commands actually) that starts with "Async"
} 
```

我`Service2`有时和`AsyncService2`其他时间用户。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-30T21:39:57.800

> 似乎当我在 ASP.NET MVC 的单独线程中运行任务时，SimpleInjector 会为每个调用创建一个新的 DbContext 实例。

Simple Injector v1.5 及以下的生活方式的行为是在`RegisterPerWebRequest`Web 请求上下文之外请求实例时返回瞬态实例（其中`HttpContext.Current`为 null）。返回瞬态实例是 Simple Injector 的设计缺陷，因为这很容易隐藏不当使用。[Simple Injector 1.6 版](https://simpleinjector.codeplex.com/releases/view/97655)将抛出异常而不是错误地返回瞬态实例，以清楚地传达您错误配置了容器。

> 虽然一些 IoC 库（例如 StructureMap）对 per-thread-per-webrequest 有一种混合的生活方式，但似乎 Simple Injector 没有

由于几个原因，Simple Injector 没有对混合生活方式的内置支持是正确的。首先，它是一个非常奇特的功能，没有多少人需要。其次，您可以将任何两种或三种生活方式混合在一起，这样几乎是无穷无尽的混合体组合。最后，（非常）容易自己注册。

尽管您可以将[Per Web Request](https://simpleinjector.readthedocs.org/en/latest/lifetimes.html#perwebrequest)与[Per Thread生活方式混合使用，但将 Per Web Request 与](https://simpleinjector.readthedocs.org/en/latest/lifetimes.html#perthread)[Per Lifetime Scope](https://simpleinjector.readthedocs.org/en/latest/lifetimes.html#perlifetimescope)混合使用可能会更好，因为使用 Lifetime Scope 您可以显式地开始和结束范围（并且可以`DbContext`在范围结束时处理） .

从[Simple Injector 2](https://simpleinjector.codeplex.com/releases/view/99008)开始，您可以使用[Lifestyle.CreateHybrid](https://simpleinjector.org/ReferenceLibrary/?topic=html/M_SimpleInjector_Lifestyle_CreateHybrid.htm)方法轻松地将任意数量的生活方式混合在一起。这是一个例子：

```
var hybridLifestyle = Lifestyle.CreateHybrid(
    () => HttpContext.Current != null,
    new WebRequestLifestyle(),
    new LifetimeScopeLifestyle());

// Register as hybrid PerWebRequest / PerLifetimeScope.
container.Register<DbContext, MyDbContext>(hybridLifestyle); 
```

还有另一个 Stackoverflow 问题更深入地探讨了这个主题，您可能想看看：[Simple Injector: multi-threading in MVC3 ASP.NET](https://stackoverflow.com/questions/11041601/simple-injector-multi-threading-in-mvc3-asp-net)

**更新**

关于你的更新。你快到了。在后台线程上运行的命令需要在*Lifetime Scope*内运行，因此您必须显式启动它。这里的技巧是调用`BeginLifetimeScope`新线程，但在创建实际的命令处理程序（及其依赖项）之前。换句话说，最好的方法是在装饰器内部。

最简单的解决方案是更新您`AsyncCommandHandlerDecorator`以添加范围：

```
public class AsyncCommandHandlerDecorator<TCommand> 
    : ICommandHandler<TCommand> where TCommand : ICommand 
{
    private readonly Container _container;
    private readonly Func<ICommandHandler<TCommand>> _factory;

    public AsyncCommandHandlerDecorator(Container container,
        Func<ICommandHandler<TCommand>> factory) 
    {
        _container = container;
        _factory = factory;
    }

    public void Handle(TCommand command) 
    {
        ThreadPool.QueueUserWorkItem(_ => 
        {
            using (_container.BeginLifetimeScope())
            {
                // Create new handler in this thread
                // and inside the lifetime scope.
                var handler = _factory();
                handler.Handle(command);
            }
        });
    }
} 
```

提倡[SOLID](https://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)原则的纯粹主义者会大喊这个类违反了[单一职责原则](https://en.wikipedia.org/wiki/Single_responsibility_principle)，因为这个装饰器既在新线程上运行命令，又启动了新的生命周期范围。我不会太担心这一点，因为我认为启动后台线程和启动生命周期范围之间存在密切关系（无论如何，你不会在没有另一个的情况下使用一个）。但是，您仍然可以轻松地`AsyncCommandHandlerDecorator`保持原样并创建一个新`LifetimeScopedCommandHandlerDecorator`的，如下所示：

```
public class LifetimeScopedCommandHandlerDecorator<TCommand> 
    : ICommandHandler<TCommand> where TCommand : ICommand 
{
    private readonly Container _container;
    private readonly Func<ICommandHandler<TCommand>> _factory;

    public LifetimeScopedCommandHandlerDecorator(Container container,
        Func<ICommandHandler<TCommand>> factory)
    {
        _container = container;
        _factory = factory;
    }

    public void Handle(TCommand command)
    {
        using (_container.BeginLifetimeScope())
        {
            // The handler must be created inside the lifetime scope.
            var handler = _factory();
            handler.Handle(command);
        }
    }
} 
```

这些装饰器的注册顺序当然是必不可少的，因为`AsyncCommandHandlerDecorator` **必须**将`LifetimeScopedCommandHandlerDecorator`. 这意味着`LifetimeScopedCommandHandlerDecorator`必须先注册：

```
container.RegisterDecorator(typeof(ICommandHandler<>),
    typeof(LifetimeScopedCommandHandlerDecorator<>),
    backgroundCommandCondition);

container.RegisterDecorator(typeof(ICommandHandler<>),
    typeof(AsyncCommandHandlerDecorator<>),
    backgroundCommandCondition); 
```

[这个旧的 Stackoverflow 问题](https://stackoverflow.com/questions/10304023/simpleinjector-is-this-the-right-way-to-registermanyforopengeneric-when-i-have)更详细地讨论了这一点。你一定要看看。

# c - 在C中返回和打印字符串数组索引

> ID：13147515
> 
> 赞同：1
> 
> 时间：2012-10-30T20:59:48.027
> 
> 标签：c, printing, indexing

我有一个搜索名称列表的函数，我试图让搜索函数将数组的索引返回给主函数并打印出找到的名称的起始位置。到目前为止，我尝试的所有操作要么使程序崩溃，要么导致奇怪的输出。

这是我的搜索功能：

```
#include<stdio.h>
#include<conio.h>
#include<string.h>

#define MAX_NAMELENGTH 10
#define MAX_NAMES 5

void initialize(char names[MAX_NAMES][MAX_NAMELENGTH], int Number_entrys, int i);
int search(char names[MAX_NAMES][MAX_NAMELENGTH], int Number_entrys);

int main()
{
   char names[MAX_NAMES][MAX_NAMELENGTH];
   int i, Number_entrys,search_result,x;
   printf("How many names would you like to enter to the list?\n");
   scanf("%d",&Number_entrys);
   initialize(names,Number_entrys,i);
   search_result= search(names,Number_entrys);
   if (search_result==-1){
      printf("Found no names.\n");
   }else
   {
      printf("%s",search_result);
   }
   getch();
   return 0;
}

void initialize(char names[MAX_NAMES][MAX_NAMELENGTH],int Number_entrys,int i)
{
   if(Number_entrys>MAX_NAMES){
      printf("Please choose a smaller entry\n");
   }else{
      for (i=0; i<Number_entrys;i++){
         scanf("%s",names[i]);
      }
   }
}

int search(char names[MAX_NAMES][MAX_NAMELENGTH],int Number_entrys)
{
   int x;
   char new_name[MAX_NAMELENGTH];
   printf("Now enter a name in which you would like to search the list for\n");
   scanf("%s",new_name);

   for(x = 0; x < Number_entrys; x++) {
      if ( strcmp( new_name, names[x] ) == 0 )
      {
         return x;
      }
   } 
   return -1;        
} 
```

就像我之前提到的那样，我尝试了很多不同的方法来尝试解决这个问题，但我似乎无法让它们发挥作用。像上面那样打印 X 只是我尝试的最后一件事，因此知道它不起作用。对最简单的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:23:33.343

为什么不使用 strcmp 而不是 strstr ？

在您的代码中，似乎存在一些大问题：-似乎我使用未初始化。-您将 x 声明为 int 然后使用 : printf("%s",x) 在这里有点胡说八道。顺便说一句，不要初始化！

类似的东西应该更好（请注意我没有你的初始化函数）并且我没有尝试编译：

```
int search(char names[MAX_NAMES][MAX_NAMELENGTH],int Number_entrys)
{
   int x =0;
   char new_name[MAX_NAMELENGTH];
   printf("Now enter a name in which you would like to search the list for\n");
   scanf("%s",new_name);

   for(x = 0; x < Number_entrys; x++) 
   {
      if ( strcmp( new_name, names[x] ) == 0 )
      {
         return x;
      }
   } 
   return -1;        
 } 
```

主要的 ：

```
int main()
{
    char names[MAX_NAMES][MAX_NAMELENGTH];
    int i=0;
    int Number_entrys=0;
    int search_result=0;
    printf("How many names would you like to enter to the list?\n");
    scanf("%d",&Number_entrys);
    initialize(names,Number_entrys,i); // I guess it is use to initialize names ?!?
    search_result= search(names,Number_entrys);
    if (search_result==-1)
    {
         printf("Found no names.\n");
    }
    else
    {
       printf("Index found in position %d in the tab\n",search_result);
    }
   getch(); //not really a fan of this...
   return 0;
 } 
```

希望能帮助到你。

问候，

乔泽

# datagrid - 如何向 Ext Lib 数据网格中的单元格添加验证？

> ID：13147517
> 
> 赞同：0
> 
> 时间：2012-10-30T21:00:20.960
> 
> 标签：datagrid, xpages, xpages-extlib

我有一个包含来自不同文档的数据的数据网格。用户可以编辑某些列。我想限制他们只能输入一个数字。我想从客户端而不是服务器端进行，因为这意味着检查 20 个或更多文档。

好的，知道该怎么做。如果输入非数字或无效值，请创建一个函数以将数据格式化为红色背景。将函数放在 scriptBlock 中，并将名称放在每列的格式化程序字段中

```
function ValidNmbr(s)
{
var RegularExpression = new RegExp(/^\$?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$/);<br/>
if(RegularExpression.test(s))
{
    return s;
}
else {
    return "<span style='background-color:red'>"+s+"</span>";
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T17:12:09.403

客户端格式强制可以被绕过（任何有萤火虫的人），所以你必须清楚这只是为了用户的舒适，而不是为了你的数据的完整性。

在服务器端：您可以有一个带有数字掩码的输入字段。不需要代码——可能是最少的工作。如果你想做那个客户端：

1.  将 HTML5 属性用于数字格式
2.  使用[一些帮助](https://stackoverflow.com/questions/3855294/html5shiv-vs-dean-edwards-ie7-js-vs-modernizr-which-to-choose)器使旧浏览器正常运行
3.  考虑使用 Dojo 网格。它做了很好的[验证](http://phillipsb1.wordpress.com/2009/11/13/validationtextbox-in-the-grid/)

希望有帮助

# php - Wordpress 自定义数据库表无法识别

> ID：13147525
> 
> 赞同：0
> 
> 时间：2012-10-30T21:01:24.637
> 
> 标签：php, mysql, wordpress

我`sdp_invites`为我的 wordpress (v3.4.2) 站点手动创建了一个自定义表。我过去曾多次这样做，但现在我无法使用任何`$wpdb`方法：

```
global $wpdb;
global $current_user;

$query = "INSERT INTO spd_invites (sender_id,receiver_id,job_id,job_title,job_slug,employer_id) VALUES ('{$current_user->ID}','{$resume->user_id}','{$job_id}','{$job_title}','{$job_slug}','{$employer_id}')";

$wpdb->get_results($query); //ERROR...
$wpdb->query($query); //ERROR... 
```

这是错误：

```
WordPress database error: [Table 'sow2.spd_invites' doesn't exist]
INSERT INTO spd_invites (sender_id,receiver_id,job_id,job_title,job_slug,employer_id) VALUES ('799','809','6','Professional Basket Weaver','professional-basket-weaver','5') 
```

我知道该表存在，因为我手动创建了它，我可以在 phpMyAdmin 中看到它。知道为什么我会收到此错误吗？

更新： WP 用户被称为“root”（在我的本地开发设置中）。以下是 phpMyAdmin 中列出的权限：

```
User    Host             Type    Privileges  Grant  Action
root    localhost    global  ALL PRIVILEGES  Yes 
```

UPDATE2：只是为了排除一堆可能性，我尝试了一个更简单的查询：`"SELECT * FROM sdp_invites"`. 这会引发相同的错误。当我更改为 wp 核心表时，它可以正常工作`"SELECT * FROM sdp_invites"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:09:30.353

我最好的猜测是，您没有为您的 Wordpress MySQL 数据库用户授予新自定义表的权限，大概是因为您使用不同的 MySQL 用户通过`phpMyAdmin`. 尝试运行：

```
GRANT ALL PRIVILEGES ON sow2.spd_invites TO 'wordpress_user'@'wordpress_host';
FLUSH PRIVILEGES; -- load new privileges 
```

将“wordpress_user”替换为您的 Wordpress MySQL 用户名（可在 中找到`wp-config.php`），将“wordpress_host”替换为您的 Wordpress 服务器的主机名（如果位于同一服务器上，则为 localhost）。

请记住，这将允许 Wordpress MySQL 对该表的完全权限（、、、`SELECT`等`INSERT`）`DROP`，这可能是不可取的。有关命令的信息，请参阅 MySQL 文档`GRANT`- [http://dev.mysql.com/doc/refman/5.5/en/grant.html](http://dev.mysql.com/doc/refman/5.5/en/grant.html)

您将希望使用该`query()`函数运行您的插入，因为它不会返回任何结果：

```
$wpdb->query($query); 
```

要查看对您的 Wordpress MySQL 用户可见的所有表，请将以下内容添加到您的主题`functions.php`文件中，以在每个页面的底部打印出表名：

```
function show_all_tables(){
    global $wpdb; 
    foreach($wpdb->get_results("SHOW TABLES", ARRAY_N) as $table): 
        echo $table[0]."<br/>"; 
    endforeach;
} 
add_action('wp_footer', 'show_all_tables'); 
```

# ios - 将 InfoPlist.string 文件与最近创建的 .plist 文件相关联

> ID：13147526
> 
> 赞同：0
> 
> 时间：2012-10-30T21:01:35.487
> 
> 标签：ios, localization, plist

我正在为英语和西班牙语的 iOS 应用程序进行本地化，该应用程序也有多个目标。因此，对于每个目标，我需要创建其 plist 文件及其关联的 plist.strings 以支持每个目标中的本地化。

我的问题是：

**如何将最近创建的 .plist 文件与每个目标中创建的 .string 文件链接？**

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:02:03.900

我刚刚想通了。

您只需确保您创建的新 InfoPlist.strings 在当前目标中。

这看起来很简单，但问题是我复制了我的目标来制作一个新的，所以在这个过程中，第二个的 plist 添加了本地化键，因为我在第一个上有这个。在第二个中删除密钥进行了交易，现在我可以在新目标中设置所有内容。

# mercurial - CruiseControl 无法识别 Mercurial 存储库的修改

> ID：13147527
> 
> 赞同：2
> 
> 时间：2012-10-30T21:01:35.963
> 
> 标签：mercurial, continuous-integration, cruisecontrol, continuous

我正在尝试实现一个连续的构建堆栈，并决定将 CruiseControl 与 Ant 一起使用。但是，CruiseControl 似乎无法从我的 Mercurial 目录中获取更改。这是 config.xml 中的一些代码，其中删除了一堆不必要的元素。我发现的一种解决方法是将 requiremodification 设置为 false，这将构建软件而不管所做的更改。我在这里错过了什么吗？或者这是 CruiseControl 的错误。

```
<!--config.xml-->
<project name="test_runner" buildafterfailed="false"
    requiremodification="true" forceonly="${test_runner.inactive}">
    <listeners>
        <currentbuildstatuslistener file="${projectLogsDir}/status.txt" />
    </listeners>

    <bootstrappers>
    </bootstrappers>

    <modificationset quietperiod="${quietPeriod}">

        <mercurial localworkingcopy="${mercurialDir}/solution1" property="solution1_changed" />

    </modificationset>

    <schedule interval="${scheduleInterval}">
        <ant liveOutput="true" />
    </schedule>

</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-09T07:13:14.280

在 CruiseControl.Net 中，服务器记录它执行哪个命令来检查更改。您可以通过在命令行上自己运行来检查此命令是否正确。我对 Perforce 也有同样的问题，通过自己运行命令，我发现我配置了一个不正确的视图。

请注意，我比 CruiseControl 更熟悉 CruiseControl.Net，因此这可能不适用于 CruiseControl。

# vb.net - VB.NET 将 Tab 键发送到另一个应用程序窗口

> ID：13147529
> 
> 赞同：0
> 
> 时间：2012-10-30T21:01:43.270
> 
> 标签：vb.net, winforms, sendmessage, postmessage, windows-messages

我想将“{TAB}”键发送到另一个应用程序**窗口**（将键发送到窗口而不是文本框）。

我试过了：

```
SendMessage(hWnd, WM_SETHOTKEY, VK_TAB, 0) 
```

没啥事儿。
我的目标是： 当应用程序窗口**不在**焦点 时，
将制表键发送到我的应用程序**或其他应用程序。** （**我知道 sendkey 在这种情况下不专业，别无选择**（这是我第一次使用它）。）

 ****我做了很多尝试，但总是返回相同的结果：

**没啥事儿。**

有人知道答案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T01:58:52.943

[SendKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)要求您将密钥发送到的应用程序处于活动状态。

从上面的链接：

> 使用 SendKeys 将击键和击键组合发送到活动应用程序。

我为了绕过这个限制，你将不得不求助于使用 WinApi 函数。

1.  [FindWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx) [pInvoke.net](http://www.pinvoke.net/default.aspx/user32/FindWindow.html)
2.  [FindWindowEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633500%28v=vs.85%29.aspx) [pInvoke.net](http://www.pinvoke.net/default.aspx/user32/FindWindowEx.html)
3.  [sendMessage](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx) [pInvoke.net](http://www.pinvoke.net/default.aspx/user32/SendMessage.html)

有关示例，请参阅此[MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvb/thread/9787352e-6320-43a6-8644-83a29fe27e7b)

这是该帖子的修改示例：

```
Public Class Form1
    Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
                     (ByVal lpClassName As String, ByVal lpWindowName As String) As IntPtr
    Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" _
                     (ByVal hWnd As IntPtr, ByVal hWndChildAfterA As IntPtr, ByVal lpszClass As String, ByVal lpszWindow As String) As IntPtr
    Declare Function SendMessage Lib "user32" Alias "SendMessageA" _
                     (ByVal hWnd As IntPtr, ByVal wMsg As Integer, ByVal wParam As IntPtr, ByVal lParam As String) As IntPtr
    Const WM_SETTEXT As Integer = &HC

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        Dim destination As IntPtr = FindWindow(Nothing, "Untitled - Notepad")
        Dim destControl As IntPtr = FindWindowEx(destination, IntPtr.Zero, "Edit", Nothing)
        SendMessage(destControl, WM_SETTEXT, IntPtr.Zero, "Hello" & vbTab & "GoodBye" & vbCrLf)

    End Sub

End Class 
```

* * *

添加了一个附加示例，使用`WM_KEYDOWN`我创建了另一个将窗口标题设置为 TestForm 的小应用程序，并覆盖了 WndProc 方法以确定应用程序是否获得了 TabKey。

**发送表格**

```
Public Class Form1

    Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
                 (ByVal lpClassName As String, ByVal lpWindowName As String) As IntPtr
    Declare Function SendMessage Lib "user32" Alias "SendMessageA" _
                 (ByVal hWnd As IntPtr, ByVal wMsg As Integer, ByVal wParam As Integer, ByVal lParam As Integer) As IntPtr
    Const WM_KEYDOWN As Integer = &H100
    Const VK_TAB As Integer = &H9

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

        Dim destination As IntPtr = FindWindow(Nothing, "TestForm")
        SendMessage(destination, WM_KEYDOWN, VK_TAB, 0)

    End Sub

End Class 
```

**测试表**

在 MyBase.WndProc(m) 上放置一个断点并查看 m 以查看已发送的内容。

```
Public Class Form1

    Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)
        MyBase.WndProc(m)
    End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T23:25:25.787

之前曾多次与这种类型作斗争，我建议看几件事。

第一个是[autoit](http://www.autoitscript.com/site/autoit/downloads/)，它包含一个您可以从 vb.net 引用的 dll，而且您使用起来非常简单，并且有据可查。每当我需要控制第 3 方程序时，我倾向于使用它。

另一个是[ui 自动化类](http://msdn.microsoft.com/en-us/library/ms747327.aspx) ，例如：

[http://blog.functionalfun.net/2009/06/introduction-to-ui-automation-with.html](http://blog.functionalfun.net/2009/06/introduction-to-ui-automation-with.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:15:27.073

您需要先激活另一个窗口。检查[将焦点更改到 VB.NET 中的另一个窗口](https://stackoverflow.com/questions/4088020/change-focus-to-another-window-in-vb-net)。然后使用发送键。****

# validation - Rails 唯一性验证 - 跳过满足特定条件的对象

> ID：13147540
> 
> 赞同：1
> 
> 时间：2012-10-30T21:02:46.780
> 
> 标签：validation, ruby-on-rails-3.2

我有一个模型，它具有三个属性，包括一个状态属性：

```
RailsModel:
  attribute1
  attribute2
  state 
```

我想在属性 2 的范围内验证属性 1 的唯一性：

```
validate :attribute1, uniqueness: { scope: :attribute2 } 
```

但是，我不想检查 state = :canceled 的任何 RailsModels

有没有一种简单的方法来添加这个条件或者我需要编写一个自定义验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:09:06.700

您可以使用 if 条件：

```
validate :attribute1, uniqueness: { scope: :attribute2 }, :if => "state == canceled" 
```

那里有很多可能性，只需检查[指南](http://guides.rubyonrails.org/active_record_validations_callbacks.html#conditional-validation)！

# c# - 使用 Dispose() 方法时应用程序中断，即使相同的代码在不同的事件中工作

> ID：13147552
> 
> 赞同：0
> 
> 时间：2012-10-30T21:03:24.230
> 
> 标签：c#, dispose

几天前，我开始使用自己的照片查看器/编辑器。我已经实现了方法“OnKeyDown”，它根据按下的箭头键更改照片：

```
case Keys.Left:
            case Keys.Down:
                ic.getImage().Dispose();
                --fileIndex;
                if (fileIndex < 0)
                    fileIndex = (fileCount - 1);
                ic.setImage(Image.FromFile(fileNames[fileIndex]), ref pictureBox1);
            break;

            case Keys.Right:
            case Keys.Up:
                ic.getImage().Dispose();
                ++fileIndex;
                fileIndex %= fileCount;
                ic.setImage(Image.FromFile(fileNames[fileIndex]), ref pictureBox1);
            break; 
```

这完美地工作。接下来我想做的是对幻灯片进行编程，所以我使用 System.Timers.Timer 来触发事件 goRight() ，该事件执行与按下右箭头键相同的代码：

```
public void goRight(object source, ElapsedEventArgs e)
    {
            ic.getImage().Dispose();
            ++fileIndex;
            fileIndex %= fileCount;
            ic.setImage(Image.FromFile(fileNames[fileIndex]), ref pictureBox1);
    } 
```

使用幻灯片应用程序时会中断。我不知道为什么，因为代码完全相同。如果我注释掉 ic.getImage().Dispose() 幻灯片有效，但 RAM 中的数据量会随着每张下一张照片而越来越高。

难道我做错了什么？谢谢你的时间，我很感激！

呃，差点忘了。有没有一种方法可以在没有 if 语句的情况下使索引向后退（在键按下和键向左事件中）（如运算符 % 用于前向）。我确实试过这个：

```
++fileIndex;
fileIndex %= fileCount;
ic.setImage(Image.FromFile(fileNames[(fileCount -1) - fileIndex]), ref pictureBox1); 
```

如果我只朝一个方向走，效果很好，但如果我改变方向，它会跳过几个索引。对此有什么想法吗？

最好的祝福。Z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:29:11.740

对于索引，您可以执行以下操作：

```
fileIndex = (fileIndex == 0) ? fileCount -1 : fileIndex - 1; // decrementing

fileIndex = (fileIndex == fileCount - 1) ? 0 : fileIndex + 1; // incrementing 
```

正如 cHao 所说，改用 System.Windows.Forms.Timer 。

# c# - ListBox 中大型数据集的 Region 或 ItemsSource

> ID：13147553
> 
> 赞同：0
> 
> 时间：2012-10-30T21:03:39.353
> 
> 标签：c#, wpf, prism, mef, prism-4

在以下情况下，我无法弄清楚最佳解决方案是什么。我正在使用 Prism 4.1、MEF 和 .Net 4.0。

我有一个`Project`可能有大量（~1000）个对象的`Line`对象。我正在决定是否最好公开`ObservableCollection<LineViewModel>`我的`ProjectViewModel`并在那里手动创建 Line 视图模型，或者将 ListBox 设置为它自己的区域并以这种方式激活视图。

我仍然希望`LineViewModel`注入 Prism 的共享服务（IEventAggregator 等），但是当我手动创建`LineViewModel`. 有什么建议或想法吗？

编辑：我最初的想法：

**项目：**

```
public class Project
{
    public List<Line> Lines { get; set; }
} 
```

**项目视图模型：**

```
[Export(typeof(ProjectViewModel))]
[PartCreationPolicy(CreationPolicy.NonShared)]
public class ProjectViewModel : NotificationObject, IRegionMemberLifetime
{
    private Project _localProject;

    /* 
        HERE WILL BE SOME PROPERTIES LIKE COST, PRICE THAT ARE CUMULATIVE FROM THE Lines 
     */

    public ObservableCollection<LineViewModel> Lines { get; private set; }

    private readonly IEventAggregator _eventAggregator;

    [ImportingConstructor]
    public ProjectViewModel(IEventAggregator eventAggregator)
    {
        _eventAggregator = eventAggregator;
        _eventAggregator.GetEvent<ProjectLoaded>().Subscribe(SetupProject, false);
        Lines = new ObservableCollection<LineViewModel>();
    }

    private void SetupProject(Project project)
    {
        _localProject = project;

        foreach(var l in _localProject.Lines)
        {
            LineViewModel lvm = new LineViewModel(l);
            lvm.PropertyChanged += // Some handler here
            Lines.Add(lvm);
        }
    }

    public bool KeepAlive
    {
        get { return false; }
    }
} 
```

**线视图模型：**

```
public class LineViewModel : NotificationObject
{
    private Line _localLine;

    public decimal Cost
    {
        get { return _localLine.Cost; }
        set
        {
            _localLine.Cost = value;
            RaisePropertyChanged(() => Cost);
        }
    }

    public LineViewModel(Line incoming)
    {
        _localLine = incoming;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:58:18.453

要使用 Prism/MEF 手动创建 LineViewModel，您可以使用容器来解决依赖关系，这就是它的用途。

例如，

```
LineViewModel line = container.GetExportedValue<LineViewModel>(); 
```

请参阅此链接：[管理依赖项：使用 MEF 解析实例](http://msdn.microsoft.com/en-us/library/ff921140%28v=pandp.40%29.aspx#sec9)

我有点担心您的设计，您的每一行是否真的有必要拥有一个 ViewModel 并由容器创建并注入依赖项？是否有可能有一个对象管理所有行并具有那些注入的依赖项？也许某种存储库模式可能会使您受益？

如果您通过容器解析数千个对象，则可能会产生相当大的开销。棱镜书还提到这可能不是一个好主意[使用容器的注意事项](http://msdn.microsoft.com/en-us/library/ff921140%28v=pandp.40%29.aspx#sec2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:24:50.130

我在这里可能有点离谱，也许这太简单了，但这对你有帮助吗？我创建了一个快速项目，展示了一些基础知识。如果您需要更多信息，也许我可以用它来帮助您更多。

[绑定到“行”的示例应用程序](https://docs.google.com/open?id=0BxrjI2SEpdk6aXhjQmViLVNUams)

看法

```
 <Window x:Class="WpfApplication1.LinesView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="LinesView" mc:Ignorable="d" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" d:DesignHeight="247" d:DesignWidth="348" SizeToContent="WidthAndHeight" Width="350" Height="250">
    <Window.Resources>
        <DataTemplate x:Key="LineView">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto" MinWidth="50"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Line: " />
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Name}" />

                <TextBlock Grid.Row="1" Grid.Column="0" Text="X: " />
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding X}" />

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Y: " />
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Y}" />
            </Grid>
        </DataTemplate>
    </Window.Resources>
    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
            <TextBlock Text="Total Cost" Margin="5" />
            <TextBlock Text="{Binding Cost}" Margin="5" />
        </StackPanel>
        <ContentControl Name="contentControl1" Content="{Binding ElementName=listBox1, Path=SelectedItem}" ContentTemplate="{StaticResource LineView}" VerticalAlignment="Center" HorizontalAlignment="Center" Width="105" Margin="5" />
        <ListBox Height="234" 
                 HorizontalAlignment="Center"
                 Name="listBox1" 
                 VerticalAlignment="Center"
                 ItemsSource="{Binding Lines}"
                 ItemTemplate="{StaticResource LineView}" Width="152" Margin="5" />
    </StackPanel>
</Window> 
```

视图模型

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using WpfApplication1.Models;
using System.Collections.ObjectModel;
using System.ComponentModel;

namespace WpfApplication1
{
    public class LinesViewModel : INotifyPropertyChanged
    {
        public int Cost
        {
            get
            {
                return Lines.Sum(x => x.X + x.Y); 
            }
        }

        public ObservableCollection<Line> Lines
        {
            get;
            private set;
        }

        public LinesViewModel()
        {
            Lines = new ObservableCollection<Line>();
            Lines.Add(new Line()
            {
                Name = "Line1",
                X = 0,
                Y = 1
            });
            Lines.Add(new Line()
            {
                Name = "Line2",
                X = 1,
                Y = 1
            });
            Lines.Add(new Line()
            {
                Name = "Line3",
                X = 2,
                Y = 2
            });

            foreach(Line line in Lines)
            {
                line.XChanged += new EventHandler(lineChanged);
                line.YChanged += new EventHandler(lineChanged);
            }

            Lines.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(Lines_CollectionChanged);
        }

        private void Lines_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
        {
            if (e.NewItems != null)
            {
                foreach (Line line in e.NewItems)
                {
                    line.XChanged += new EventHandler(lineChanged);
                    line.YChanged += new EventHandler(lineChanged);
                }
            }
            if (e.OldItems != null)
            {
                foreach (Line line in e.OldItems)
                {
                    line.XChanged -= new EventHandler(lineChanged);
                    line.YChanged -= new EventHandler(lineChanged);
                }
            }
        }

        private void lineChanged(object sender, EventArgs e)
        {
            PropertyChanged(this, new PropertyChangedEventArgs("Cost"));
        }

        public event PropertyChangedEventHandler PropertyChanged = delegate { };
    }
} 
```

模型

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace WpfApplication1.Models
{
    public class Line
    {
        private int x;
        private int y;

        public String Name { get; set; }

        public int X
        {
            get
            {
                return x;
            }
            set
            {
                x = value;
                XChanged(this, EventArgs.Empty);
            }
        }

        public int Y
        {
            get
            {
                return y;
            }
            set
            {
                y = value;
                YChanged(this, EventArgs.Empty);
            }
        }

        public event EventHandler XChanged = delegate { };
        public event EventHandler YChanged = delegate { };
    }
} 
```

# php - 使用字符串操作预防 PHP SQL 注入

> ID：13147555
> 
> 赞同：3
> 
> 时间：2012-10-30T21:03:45.407
> 
> 标签：php, mysql, sql, string, code-injection

> **可能重复：**
> [在 PHP 中防止 SQL 注入的最佳方法？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

我一直在做一些关于 SQL 注入的研究，但我有一些我找不到答案的问题。难道不能防止字符串级别的SQL注入攻击吗？我的意思是，我们不能阻止它吗？

*   **在通过 mysql 查询处理它们之前找到非法字符？**

    ```
    $postID = $_POST['id'];
    if($postID contains characters)
        remove characters;
    if($postID still contains characters)
        then exit;
    else
        mysql_real_escape_string($postID); //just in case?
    continue to do whatever you are doing... 
    ```

真的有必要使用 PDO/mysqli 的东西吗？分析要在mysql中处理的sql字符串是否足够？请记住，在回复时我不是 PHP 或 MySQL 专家。我是一个试图了解他们的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:08:14.783

当然，您可以使用 来防止注入`mysql_real_escape_string($postID)`，只要您不介意每次调用该函数时都进行查询。

PDO 和 MySQLi 提供的不仅仅是注入保护。它们允许准备好的语句，可以在不多次调用数据库的情况下保护反注入。这意味着更快的整体性能。想象一下尝试向一个表中插入一个包含 30 列的用户记录......这是很多`mysql_real_escape_string()`调用。

准备好的语句与查询一起发送所有数据，并在一个请求中将其转义到服务器上。Mysql DB 支持prepared statments，旧的php mysql_ 库不支持。

是时候继续使用 mysqli 或者最好是 PDO 了——你永远不会回头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:13:47.990

我鼓励您使用 PDO（PHP 数据对象）。它将有助于防止 SQL 注入并加快查询速度。此外，您的应用程序从数据库中变得更加抽象。

类似于以下内容：

```
$stmt = $conn->prepare("INSERT INTO table_name VALUES(:id, :firstname, :lastname)");
$stmt->bindValue(':id', $id);
$stmt->bindValue(':firstname', $firstname);
$stmt->bindValue(':lastname', $lastname);
$stmt->execute(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:10:38.357

我不再鼓励您使用 mysql_ 函数，因为它们已被弃用。检查：[http](http://php.net/manual/en/function.mysql-real-escape-string.php) : //php.net/manual/en/function.mysql-real-escape-string.php 以获取有关常规 mysql_ 已停产原因的更多信息。你可以很容易地切换到mysqli。真的没那么复杂。另外，如果您想转义字符并且不想为新的转义方式替换每个 mysql_real_escape_string ，则可以使用此函数：

```
function mysql_string_safe($stringtoclean)
{ 
    //In this case, 
    $safestring = mysqli_real_escape_string('your_handle_here',$stringtoclean);
    return $safestring;
} 
```

那么你可以用 mysql_real_escape_string 替换 mysql_string_safe。mysqli 与 mysql_ 非常相似，但更安全。我已经切换到它并没有花费太长时间，这很容易，因为它只是替换东西。连接到数据库也不同。另一方面，PDO 支持不同的数据库驱动程序，但如果您想节省时间并且不打算切换数据库驱动程序，只需使用 mysqli。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T21:13:18.103

如果您的 ID 是整数，请使用

```
$postID = (int)$_POST['id']; 
```

当然，在该行之后验证 $postID 是否为 != 零。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T21:26:06.380

> > 真的有必要使用 PDO/mysqli 的东西吗？

不。

> > 分析要在mysql中处理的sql字符串是否足够？

不。

## 学习资料

*   [MySQL SQL 注入备忘单](http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet)
*   [SQL 注入预防备忘单](https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet)
*   [如何避免 SQL 注入漏洞](https://www.owasp.org/index.php/Testing_for_SQL_Injection_%28OWASP-DV-005%29#How_to_Avoid_SQL_Injection_Vulnerabilities)
*   [更多安全备忘单](https://www.owasp.org/index.php/Cheat_Sheets)

## 编码安全控制

> 不要编写自己的安全控制！在为每个 Web 应用程序或 Web 服务开发安全控制时重新发明轮子会导致时间浪费和大量安全漏洞。OWASP 企业安全 API (ESAPI) 工具包可帮助软件开发人员防范与安全相关的设计和实施缺陷 - [https://code.google.com/p/owasp-esapi-php/](https://code.google.com/p/owasp-esapi-php/)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-10-30T21:22:41.360

只需使用 PDO 并准备您的陈述。

# ant - 使用宏生成 Ant 任务

> ID：13147558
> 
> 赞同：0
> 
> 时间：2012-10-30T21:04:05.750
> 
> 标签：ant, target, macrodef

我一直在寻找从顶级宏生成 ANT 目标的可能性。

细节：

我们有异构的构建系统。ANT+IVY 用作顶层（继承的solutin，不能更改）。一些项目是通过 MSBuild 构建的，通过 exec 任务从 ANT 调用。对于这些项目中的每一个，至少有两个不同的 msbuild 调用（为简洁起见用宏包装），一个在“build”目标中，一个在“clean”中。其中两个仅通过“目标”参数不同。所以我在猜测，如果有这样的可能性：

扩展节点：

```
<extensionpoint name="build-ext-point" />
<extensionpoint name="clean-ext-point" />
<target name="build" depends="build-ext-point" />
<target name="clean" depends="clean-ext-point" /> 
```

我的魔法宏：

```
<macrodef name="msbuild-proj" />
    <attribute name="project" />
    <sequential>
        <target name="@{project}-build" >
            <msbuild project="@{project}" target="Build" />
        </target>
        <target name="@{project}-clean" >
            <msbuild project="@{project}" target="Clean" />
        </target>
    </sequential>
</macrodef> 
```

如何使用：

```
<msbuild-proj project="CPP-proj" /> 
```

谢谢！

PS：是的，我知道我可以定义那些构建和清理覆盖，或者通过 ext 点，或其他任何方式。问题实际上是我是否可以删除一些代码重复。

**UPD：**我会自己回答这个问题。在这一点上，没有这种可能性。主要是因为 Target 类是一个任务容器，而不是一个任务。因此，它不能放入容器中。所以我想我会写一些可扩展的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T12:47:38.147

ANT 有一些用于构建模块化构建的机制。

首先，我认为您的主要问题是如何为您的构建构建“扩展点”？以下 ANT 任务旨在从另一个构建文件导入通用构建逻辑：

*   [进口](http://ant.apache.org/manual/Tasks/import.html)
*   [包括](http://ant.apache.org/manual/Tasks/include.html)

由于您已经计划使用宏定义扩展您的构建，我建议将它们打包为可重用的[ANTlib](http://ant.apache.org/manual/Types/antlib.html)。ANTlib可以[存在](http://ant.apache.org/manual/Types/antlib.html)于您的项目中，但它实际上被设计为打包在另一个构建可以拾取的 jarfile 中，例如通过将其安装在标准 ANT lib 目录中：

*   $ANT_HOME/lib
*   $HOME/.ant/lib

最后，如果您已经在使用 ivy 并将 taskdef 打包为 ANT 库，则可以通过将构建逻辑安装在[Nexus](http://www.sonatype.org/nexus/)等 Maven 存储库管理器中来对构建逻辑进行版本控制。这解决了大型 ANT 构建的关键问题之一。随着时间的推移，它们变得如此之大，不可能在不影响旧构建的情况下更改通用逻辑（证明构建没有正确地相互隔离）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T10:44:45.187

居然做到了这一点。它的工作，虽然存在一些警告。对于那些感兴趣的人：[https ://bitbucket.org/targetsan/ant-events](https://bitbucket.org/targetsan/ant-events)

# c# - C#：基于整数 Enum 值创建类型的实例

> ID：13147560
> 
> 赞同：1
> 
> 时间：2012-10-30T21:04:07.757
> 
> 标签：c#, dapper

我有一个用于实现“输出格式化程序”的接口，看起来有点像这样：

```
public interface IFormatOutput {}
public class HtmlOutputFormatter : IFormatOutput {}
public class TextOutputFormatter : IFormatOutput {}
// etc, etc...

public enum OutputFormat {
    Html,
    Text,
    HappyMeal,
    Excel
}

public class SomeFormattableEntity {
    int Id { get; set; }
    OutputFormat OutputType { get; set; }
} 
```

So`SomeFormattableEntity`通过 Dapper 保存在数据库中，其`OutputType`属性存储为底层整数值（即，在`INT`列中）。你可以猜到，我想提供一个 a 的实例来根据它的属性`IFormatOutput`来处理 a 。`SomeFormattableEntity``OutputType`

是否有一些干净的最佳实践方法来处理这种类型的关系？到目前为止，我的想法包括一个工厂，其内部可能包括：

1.  爷爷的可怕丑陋开关声明
2.  将枚举值映射到类型的数组
3.  基于反射的魔术映射枚举成员名称作为字符串到其他地方的类类型
4.  一些涉及属性的映射机制

我意识到要求类型基于值的事物的实例是不可取的，但是当涉及 SQL 时似乎很难避免这种情况。基本上问题是多个具有不同 .NET 类型的“事物”都存储在一个表中。我一直遇到这个成语，无法找到一个优雅的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:06:58.557

怎么样：

```
OutputFormat format = OutputFormat.Excel;
object obj = Activator.CreateInstance("myAssemblyName", format.ToString()); 
```

假设您的枚举元素具有您的类型的确切名称？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:18:44.317

我可能会选择具有 FormatsOutputFor 属性的自定义属性。`IFormatOutput`然后用属性装饰你的所有实现。例如

```
[YourAttribute(OutputFormat.Html)]
public class HtmlOutputFormatter : IFormatOutput {} 
```

然后在你的工厂：

```
// get all your formatters
var formatters = AppDomain.CurrentDomain.GetAssemblies()
    .SelectMany(s => s.GetTypes())
    .Where(p => Attribute.IsDefined(p, typeof(YourAttribute)));

// Now go through each formatter and use the attribute to figure out which
// output format it's for. Add these to some static IDictionary<OutputFormat, Type> 
```

您可能想要构建一些将`OutputFormat`值映射到`Type`. 然后您的工厂可以仔细检查您是否只有一种类型映射到每种输出格式，并且如果您尝试为没有相应类的枚举值获取格式化程序，那么您将不会从激活器中获得一些晦涩的 TypeLoadException。

希望这是有道理的......

# iphone - UIButton 总是回到它的第一个位置？

> ID：13147564
> 
> 赞同：0
> 
> 时间：2012-10-30T21:04:26.340
> 
> 标签：iphone, objective-c, ios

我有这个头发拉扯的问题，我希望任何人都能够帮助我。这似乎是一件小事，但我一直无法找到任何解决方案。

我有一个 UIButton，我想用动画块四处移动。每次单击按钮时，我都会将其移动到新位置，按钮总是移动到正确的位置，问题是它总是从第一个位置移动到新位置。

假设我有一个按钮，`(0,0)`然后将其移动到`(0,50)`像美女一样工作！现在我想将按钮移动到`(0,100)`，我希望它从到动画`(0,50)`，`(0,100)`但是它从`(0,0)`到动画，`(0,100)`所以它最终在正确的位置，但从错误的位置移动。

我`UIButton`通过在动画块中设置一个新帧来移动

```
[UIView animateWithDuration:0.5f
                              delay:0.0f
                            options:UIViewAnimationCurveLinear
                         animations:^{
                         }
                         completion:nil]; 
```

在我的情况下，当其他控件完成移动时，我将按钮移动到完成块中。

我真的希望有人知道我在说什么并为我解答。

我用于为 uibutton 设置动画的代码是这样的，按钮名称是“btnAddPhoneNumber”，它也是“发送者”

```
[UIView animateWithDuration:1
                      delay:0
                    options:UIViewAnimationCurveLinear
                 animations:^{
                     txtNewPhoneNumber.frame = CGRectMake(newXnumber, newYnumber, txtPhoneNumber.frame.size.width, txtPhoneNumber.frame.size.height);

                 }
                 completion:^(BOOL finished) {
                     txtNewPhoneNumber.placeholder = @"here you go!";

                     //animate add textfield button.
                     [UIView animateWithDuration:0.5f
                                           delay:0
                                         options:UIViewAnimationCurveLinear
                                      animations:^{

                                          [sender setFrame:CGRectMake(btnAddPhoneNumber.frame.origin.x, newYnumber, btnAddPhoneNumber.frame.size.width, btnAddPhoneNumber.frame.size.height)];

                                          txtNewPhoneNumberTitle.frame = CGRectMake(newXtitle, newYtitle, txtPhoneNumberTitle.frame.size.width, txtPhoneNumberTitle.frame.size.height);

                                          [btnDelete setFrame:btnDeleteRect];
                                      }
                                      completion:^(BOOL finished) {
                                      }];
                 }]; 
```

感谢您阅读我的问题，并帮助我找到解决方案。

编辑（添加代码示例）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T12:58:47.543

我发现了问题，视图使用了 AutoLayout，当我删除 AutoLayout 中的勾号时，我的按钮的新位置被保存，下一个动画从以前的位置继续。

感谢 ACB 和 Tobi 的投入，他们帮助我尝试了不同的解决方案，最终解决了问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:16:59.640

尝试添加`UIViewAnimationOptionBeginFromCurrentState`第二个动画的选项，看看它是否解决了您的问题。

```
[UIView animateWithDuration:0.5f
                              delay:0.0f
                            options:UIViewAnimationCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                         animations:^{
                         }
                         completion:nil]; 
```

另一种方法是在第二个动画的完成处理程序中再次设置按钮的框架（设置相同的值）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:48:28.817

检查这项工作。正如我在评论中提到的，您可以将其用作最后的选择。不是推荐的方法。

```
[UIView animateWithDuration:1
                      delay:0
                    options:UIViewAnimationCurveLinear
                 animations:^{
                     txtNewPhoneNumber.frame = CGRectMake(newXnumber, newYnumber, txtPhoneNumber.frame.size.width, txtPhoneNumber.frame.size.height);

                 }
                 completion:^(BOOL finished) {
                     txtNewPhoneNumber.placeholder = @"here you go!";

                     [self performSelector:@selector(callSecondAnimation) withObject:nil afterDelay:1.5f)]; //or 0.5f
                 }];

- (void)callSecondAnimation {
    //animate add textfield button.
    [UIView animateWithDuration:0.5f
                          delay:0
                        options:UIViewAnimationCurveLinear
                     animations:^{

                         [sender setFrame:CGRectMake(btnAddPhoneNumber.frame.origin.x, newYnumber, btnAddPhoneNumber.frame.size.width, btnAddPhoneNumber.frame.size.height)];

                         txtNewPhoneNumberTitle.frame = CGRectMake(newXtitle, newYtitle, txtPhoneNumberTitle.frame.size.width, txtPhoneNumberTitle.frame.size.height);

                         [btnDelete setFrame:btnDeleteRect];
                     }
                     completion:^(BOOL finished) {
                     }];
} 
```

**更新：**

先试试这个

```
[UIView animateWithDuration:1
                      delay:0
                    options:UIViewAnimationCurveLinear
                 animations:^{
                     txtNewPhoneNumber.frame = CGRectMake(newXnumber, newYnumber, txtPhoneNumber.frame.size.width, txtPhoneNumber.frame.size.height);

                 }
                 completion:^(BOOL finished) {
                     txtNewPhoneNumber.placeholder = @"here you go!";
                     txtNewPhoneNumber.frame = CGRectMake(newXnumber, newYnumber, txtPhoneNumber.frame.size.width, txtPhoneNumber.frame.size.height);//try setting it here once and then call next one
                     [self callSecondAnimation];
                 }];

- (void)callSecondAnimation {
    //animate add textfield button.
    [UIView animateWithDuration:0.5f
                          delay:0
                        options:UIViewAnimationCurveLinear
                     animations:^{

                         [sender setFrame:CGRectMake(btnAddPhoneNumber.frame.origin.x, newYnumber, btnAddPhoneNumber.frame.size.width, btnAddPhoneNumber.frame.size.height)];

                         txtNewPhoneNumberTitle.frame = CGRectMake(newXtitle, newYtitle, txtPhoneNumberTitle.frame.size.width, txtPhoneNumberTitle.frame.size.height);

                         [btnDelete setFrame:btnDeleteRect];
                     }
                     completion:^(BOOL finished) {
                     }];
} 
```

# objective-c - 加载 xib 时出现 NSUnknownKeyException

> ID：13147568
> 
> 赞同：0
> 
> 时间：2012-10-30T21:05:24.470
> 
> 标签：objective-c, ios

我在使用 IOS6 的 TOSplitViewController( [http://blog.trustedones.com/development/ipad-uisplitviewcontroller-replacement-for-sethidesmasterviewinportrait](http://blog.trustedones.com/development/ipad-uisplitviewcontroller-replacement-for-sethidesmasterviewinportrait) ) 时遇到问题，因为我的应用程序在加载屏幕后立即崩溃，错误是这样的：

`*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason:`'[ setValue:forUndefinedKey:]: 这个类不符合键 navRoot 的键值编码。'`

* * *

```
First throw call stack:
(0x1964012 0x1294e7e 0x19ecfb1 0x28a711 0x20bec8 0x20b9b7 0x236428 0x7d70cc 0x12a8663 0x195f45a 0x7d5bcf 0x69ae37 0x69b418 0x7e934e 0x69b648 0x69b882 0x69bb2a 0x6b2ef5 0x6b2fdb 0x6b3286 0x6b3381 0x6b3eab 0x6b3fc9 0x6b4055 0x7b93ab 0x60a92d 0x12a86b0 0x2dfbfc0 0x2df033c 0x2dfbeaf 0x6a98cd 0x5f21a6 0x5f0cbf 0x5f0bd9 0x5efe34 0x5efc6e 0x5f0a29 0x5f3922 0x69dfec 0x5eabc4 0x5eb311 0x2423 0x5b77b7 0x5b7da7 0x5b8fab 0x5ca315 0x5cb24b 0x5bccf8 0x18bfdf9 0x18bfad0 0x18d9bf5 0x18d9962 0x190abb6 0x1909f44 0x1909e1b 0x5b87da 0x5ba65c 0x20ed 0x2025)
libc++abi.dylib: terminate called throwing an exception 
```

我的应用程序代表

```
@class RootViewController;
@class DetailViewController;

@interface SplitViewAppDelegate : NSObject <UIApplicationDelegate> {
    UIWindow *window;
    TOSplitViewController *splitViewController;

    RootViewController *rootViewController;
    DetailViewController *detailViewController;

    IBOutlet UINavigationController *navRoot;
    IBOutlet UINavigationController *navDetail;
}

@property (nonatomic, retain) UINavigationController *navRoot;
@property (nonatomic, retain) UINavigationController *navDetail;

@property (nonatomic, retain) IBOutlet UIWindow *window;

@property (nonatomic, retain) IBOutlet TOSplitViewController *splitViewController;
@property (nonatomic, retain) IBOutlet RootViewController *rootViewController;
@property (nonatomic, retain) IBOutlet DetailViewController *detailViewController;

@end 
```

navRoot 连接到 RootView，这是一个 UINavigationController

问题是我真的需要为 IOS4-6 完成这项工作，直到现在一切都很完美。有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:20:56.310

检查包含`RootViewController`. 很有可能你有一些东西在视觉上连接到一个名为的插座`navRoot`，它实际上并不存在于你的代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:21:47.540

您看到此异常的原因是当加载 .xib 时，它试图`navRoot`在某个对象上设置该属性，而该对象实际上并未实现该属性。通常，当您在编辑 .xib 时更改对象的类，但忘记检查其连接时，通常会发生这种情况。查看 .xib 内部，看看是否可以找到任何具有无效连接的对象。

# c# - 使用 csv 文件的内容（包括组）填充列表视图

> ID：13147571
> 
> 赞同：0
> 
> 时间：2012-10-30T21:05:39.273
> 
> 标签：c#, listview

因此，您在文本文件和列表视图中有一个 csv 列表。字段是

> 组、列 1、列 2、列 3、列 4、列 5

示例（所有字符串）

```
"Beginning","1","Quiet","Some text","Some other text","c:\...\image.jpg"
"Beginning","2","Quiet","Some text2","Some other text2","c:\...\image2.jpg"
"Middle","3","Quiet","Some text3","Some other text3","c:\...\image3.jpg"
"Middle","4","Running","Some text4","Some other text4","c:\...\image4.jpg" 
```

组是一个列表视图组。Column1是一个listviewitem，Column2是Column1的第一个子项，Column3是Column1的第二个子项，Column4是Column1的第三个子项，Column5是Column1的最后一个子项。

Group 和 Column2 不是唯一的，所有其他列都是唯一的。

什么是最有效的方法

1.  读取具有该结构的 csv 文件列表
2.  填充列表视图
3.  写入 csv 文件

我尝试了什么：

```
ListViewGroup k = new ListViewGroup("group1");
ListViewGroup l = new ListViewGroup("group2");
ListViewGroup a = new ListViewGroup("group3");
listView1.Groups.AddRange(new ListViewGroup[] {a, k, l });
ListViewItem item1 = new ListViewItem("column1_1", 0);
item1.SubItems.Add("column2_1");
item1.SubItems.Add("column3_1");
item1.SubItems.Add("column4_1");
item1.SubItems.Add("column5_1");
item1.Group=k;
listView1.Items.Add(item1);

ListViewItem item2 = new ListViewItem("column1_2", 0);
... 
```

作为依据。但是这种方法使自动化变得困难。特别是当有更多的组被重用时。所以我正在寻找一种通常可以完成的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:36:33.047

这是您可以尝试的初学者，如果这对您有用，请报告。我将从一个 ListView First 开始，以便您了解事情的工作原理。

```
FileStream fileStreamNew = File.Open("C:\\myCSVFile.csv", FileMode.Open, FileAccess.Read);
StreamReader streamRead = new StreamReader(fileStreamNew);
string strView = streamRead.ReadToEnd();
streamRead.Close();
fileStreamNew.Close();

String[] strArray = strView.Split(new char[] { ',' });
foreach (string strValue in strArray)
{
   listView1.Items.Add(strValue);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:49:23.060

在导入和导出到 .csv（或任何分隔文件）方面，Microsoft.VisualBasic 命名空间中有一个名为 TextFieldParser 的很棒的类（有点令人惊讶）。您只需将它指向文件，说出分隔符是什么，然后在调用 ReadLine() 时会返回一个字符串 []。您还可以定义注释标签，以确保您只导入您需要的数据。

最棒的是异常处理——如果行的格式是意外的，则会抛出 MalformedExceptions。

在[这里](http://geekswithblogs.net/brians/archive/2010/07/07/whats-a-nice-class-like-textfieldparser-doing-in-a-namespace.aspx)查看更多详细信息。

我已经用过很多次了，它从来没有让我失望过！也使您的代码更易于阅读。

# javascript - 我可以将字符串返回到输入类型：文本字段 onkeypress 吗？

> ID：13147575
> 
> 赞同：0
> 
> 时间：2012-10-30T21:06:02.223
> 
> 标签：javascript, string, split, onkeypress

我有一个定义为列表（字符串？数组？-我不确定正确的术语）的句子，我希望在按下任何键时按顺序返回。我正在尝试使用.split。这是列表和功能：

```
var list1 = "This is a test".replace(/\s/g, "\xA0").split("")
function transformTypedChar(charStr) {
    var position = $("#verse1").text().length;
    if (position >= list1.length) return '';
    else return list1[position];
} 
```

目前，重复返回列表开头的“T”，忽略列表的其余部分。我调用函数如下：

```
document.getElementById("verse1").onkeypress = function(evt) {
    var val = this.value;
    evt = evt || window.event;

     // Ensure we only handle printable keys, excluding enter and space
    var charCode = typeof evt.which == "number" ? evt.which : evt.keyCode;
    if (charCode && charCode > 32) {
        var keyChar = String.fromCharCode(charCode);

           // Transform typed character
        var mappedChar = transformTypedChar(keyChar);

        var start, end;
        if (typeof this.selectionStart == "number" && typeof this.selectionEnd ==   
   "number") {
            // Non-IE browsers and IE 9
            start = this.selectionStart;
            end = this.selectionEnd;
            this.value = val.slice(0, start) + mappedChar + val.slice(end);

            // Move the caret
            this.selectionStart = this.selectionEnd = start + 1;
        } else if (document.selection && document.selection.createRange) {
            // For IE up to version 8
            var selectionRange = document.selection.createRange();
            var textInputRange = this.createTextRange();
            var precedingRange = this.createTextRange();
            var bookmark = selectionRange.getBookmark();
            textInputRange.moveToBookmark(bookmark);
            precedingRange.setEndPoint("EndToStart", textInputRange);
            start = precedingRange.text.length;
            end = start + selectionRange.text.length;

            this.value = val.slice(0, start) + mappedChar + val.slice(end);
            start++;

            // Move the caret
            textInputRange = this.createTextRange();
            textInputRange.collapse(true);
            textInputRange.move("character", start - (this.value.slice(0,   
start).split("\r\n").length - 1));
            textInputRange.select();
        }

        return false;
    }
}; 
```

如何按顺序返回整个列表？换句话说，在第一个键事件上出现“T”，在第二个键事件上出现“h”，依此类推。我可以在 contenteditable div 中实现这一点，但我使用的是输入类型：文本字段，因为我想在它们之间自动切换。

整个代码在这里：http: [//jsfiddle.net/NAC77/9/](http://jsfiddle.net/NAC77/9/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T15:00:33.407

调用元素返回一个空字符串`$(el).text()`，`input`你应该调用`$(el).val()`：http: [//jsfiddle.net/NAC77/10/](http://jsfiddle.net/NAC77/10/)

# celery - 带有数据库后端的 celery 任务清理

> ID：13147581
> 
> 赞同：11
> 
> 时间：2012-10-30T21:06:33.023
> 
> 标签：celery, django-celery

我试图了解如何以及何时在芹菜中清理任务。通过查看[任务文档](http://docs.celeryproject.org/en/latest/userguide/tasks.html#rabbitmq-result-backend)，我看到：

> 旧结果将根据 CELERY_TASK_RESULT_EXPIRES 设置自动清除。默认情况下，这设置为 1 天后过期：如果您有一个非常繁忙的集群，您应该降低此值。

但是这句话来自 RabbitMQ Result Backend 部分，我在 Database Backend 部分看不到任何类似的文本。所以我的问题是：我是否可以采用与 celery 进行旧任务清理的后端不可知方法，如果没有，我应该采用特定于 DB Backend 的方法吗？以防我使用 django-celery 有什么不同。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T11:14:10.430

如果单击 CELERY_TASK_RESULT_EXPIRES 设置文档的链接：

[http://docs.celeryproject.org/en/latest/userguide/configuration.html#result-expires](http://docs.celeryproject.org/en/latest/userguide/configuration.html#result-expires)

它确实说数据库支持这一点，但是您需要运行 celery beat（有一个默认的定期任务，每天调用一次，以删除过期的结果）。

任务中的后端文档可能也应该提到这一点，也许也应该有一个专门的后端指南。如果您想为此游说，请在[https://github.com/celery/celery/issues提出问题](https://github.com/celery/celery/issues)

# list - 方案：按索引添加 2 个列表

> ID：13147582
> 
> 赞同：2
> 
> 时间：2012-10-30T21:06:43.163
> 
> 标签：list, recursion, scheme

我需要在 Scheme (Racket) 中编写一个函数，它需要两个不一定相等长度的列表并返回一个列表，其中每个元素是两个列表中相同索引的元素的总和。如果列表的长度不相等，则较短的应附加到自身，直到达到较长的长度。例如：

```
=> (addLists '(1 2 3 4) '(1 2))
(2 4 4 6)

=> (addLists '(1 2 3 4) '(1 2 3 4 5))
(2 4 6 8 6) 
```

到目前为止，我能够编写一个函数来完成等长列表，但问题在于如何增加此函数中较短列表的长度（或使用获取列表和大小并扩展的辅助函数它正确）。

```
(define (sumListPairs lst1 lst2)
    (if (null? lst1) null
        (cons (+ (car lst1) (car lst2))
        (sumListPairs (cdr lst1) (cdr lst2))))) 
```

将不胜感激任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:24:39.583

这是可以做到的，但由于我的印象是这是一个家庭作业，我只给出一个提示。首先，引入一个 named-`let`来进行实际的递归。然后，将递归中的案例数量从两个扩大到四个。

```
(define (sumListPairs lst1 lst2)
  (let loop ((l1 lst1) (l2 lst2))
    (cond ((and (null? l1) (null? l2)) null)
          ((null? l1) ...)
          ((null? l2) ...)
          (else (cons (+ (car lst1) (car lst2))
                      (loop (cdr l1) (cdr l2))))))) 
```

现在，填写`...`部分。请注意，您可以访问所有`l1`、`l2`和。（你可能想在完成后进行一些重构，因为情况会非常相似。）`lst1``lst2`

# unix - JSch SSH连接未登录用户登录到服务器

> ID：13147586
> 
> 赞同：0
> 
> 时间：2012-10-30T21:06:50.243
> 
> 标签：unix, ssh, aix, jsch

我有一个我可以访问的服务器列表，我需要每 30 天至少登录一次以保持我的访问权限，因此对于我使用 JSch 的第一个程序，我想创建一个程序，该程序将包含以下列表主机，用户名和密码，并让我登录和退出每个服务器。

我能够很好地连接到服务器，甚至可以执行命令，但是如果我运行 Unix 命令“last”，它不会显示我已经登录到服务器。任何关于为什么在我运行程序时它不记录但如果我使用 putty 登录它会记录的任何见解将不胜感激。

```
JSch jsch = new JSch();
Session session = jsch.getSession(userId, host, port);
session.setPassword(password);
session.setConfig("StrictHostKeyChecking", "no");
session.connect(timeout);

Channel channel = session.openChannel("exec");
((ChannelExec)channel).setCommand(command);
channel.connect();

InputStream commandOutput = channel.getInputStream();
        int readByte = commandOutput.read();
while(readByte != 0xffffffff)
{
  outputBuffer.append((char)readByte);
  readByte = commandOutput.read();
}

channel.disconnect();
session.disconnect(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:23:54.527

我猜如果你分配一个伪终端，

```
Channel channel = session.openChannel("exec");
((ChannelExec)channel).setCommand(command);
((ChannelExec)channel).setPty(true);      // !!!!
channel.connect(); 
```

您会在命令 "last" 中找到它，但您可能会从终端仿真器的输入流中获得不必要的字符序列。如何检查 /var/log/secure、/var/log/auth.log 而不是检查最后一个命令的输出？

然后，最好在 Channel#connect() 之前调用 Channel#getInputStream()，因为在 Channel#connect() 和 Channel#getInputStream() 期间收到的一些数据可能会丢失。

# r - GNU R 绘图标题中的化学公式（或数学表达式）

> ID：13147591
> 
> 赞同：2
> 
> 时间：2012-10-30T21:07:07.117
> 
> 标签：r, symbols, plotmath

如何在情节标题中写 H2o？

H2 工作：

```
plot(main=expression("H"[2]),0) 
```

H2O 失败：

```
plot(main=expression("H"[2]"O"),0) 
```

仅当我前面有空格时，此解决方案才有效“”

```
plot(main=expression(" "*H[2]*"O"),0) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T21:11:38.993

你很亲密。这有效：

```
plot(1:10, main = expression(H[2]*O)) 
```

原因是`2`是 element 的下标，`H`而您想将 element`O`放在`H`. 表达式中的符号表示与`x * y`并列，即位置和一起。查看更多。`x``y``x``y``?plotmath`

# c# - 将excel数据逐行渲染到网页（C#）

> ID：13147594
> 
> 赞同：0
> 
> 时间：2012-10-30T21:07:36.390
> 
> 标签：c#, asp.net, excel, webmatrix

有人可以帮我使用 WebMatrix 2 逐行打印数据吗

我正在尝试使用 excel 2007 和/或 2003 最后一行 DataGrid1 不起作用。这是我尝试的第三天，请帮助。

```
String Excel = "C://TEST/test_2.xls";
String sConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Excel +";Extended Properties=Excel 8.0;";

string.System.Data.OleDb.OleDbConnection objConn = new`system.Data.OleDb.OleDbConnection(sConnectionString);`

objConn.Open();
System.Data.OleDb.OleDbCommand objCmdSelect = new System.Data.OleDb.OleDbCommand("SELECT * FROM [Sheet1$]", objConn);

System.Data.OleDb.OleDbDataAdapter objAdapter1 = new System.Data.OleDb.OleDbDataAdapter(objCmdSelect);

System.Data.DataSet objDataset1 = new System.Data.DataSet();

objAdapter1.Fill(objDataset1, "XLData");
objConn.Close();
int c = objDataset1.Tables[0].Columns.Count;
int count =0;

//For Test
Response.Write("Colums: "+objDataset1.Tables[0].Columns.Count.ToString()+"<br>");
Response.Write("Rows: "+objDataset1.Tables[0].Rows.Count.ToString()+"<br>");

// Bind data to DataGrid control. Following part not working, also i like to print data with for or foreach loop)

DataGrid1.DataSource = objDataset1.Tables[0].DefaultView;
DataGrid1.DataBind();
//Other option if Data.Grid does not work!!
change Rows to Columns to print Columns.
for (int i=0;i<r;i++){
for (int j=0;j<c;j++){
Response.Write(objDataset1.Tables[0].Rows[i].ItemArray[j]+" ");
}
Response.Write("<br>");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T00:26:05.143

除了代码中的各种语法错误之外，您还创建了一个新的`OleDbDataAdapter`但未将其附加到任何东西上。我怀疑您的程序在`Fill`语句期间抛出异常，因为它没有要执行的 SQL 命令。您需要将`OleDataDbAdapter`对象的实例化编辑为：

```
System.Data.OleDb.OleDbDataAdapter objAdapter1 = new System.Data.OleDb.OleDbDataAdapter(objCmdSelect); 
```

此外，正如 DJ KRAZE 正确指出的那样，将以下几行添加到代码顶部将帮助您清理一些内容并使其更易于理解：

```
using System.Data;
using System.Data.OleDb; 
```

我不确定您对使用循环“打印”数据的评论是什么意思，但是将数据绑定到`DataGrid`您不必这样做的方式。

**编辑：**

以下是改进循环的方法

```
foreach(DataRow row in objDataset1.Tables[0].Rows)
{
    foreach(DataColumn col in objDataset1.Tables[0].Columns)
    {
        Response.Write(row[col.ColumnName].ToString());
    }

    Response.Write(count++ + "<br>");
} 
```

# c# - “应该存在 P/Invoke 入口点”，并说明正确的入口点

> ID：13147597
> 
> 赞同：3
> 
> 时间：2012-10-30T21:07:40.040
> 
> 标签：c#, interop, pinvoke, analysis

我从 Visual Studio 2012 中的代码分析工具收到此警告。代码如下所示：

```
using System;
using System.Runtime.InteropServices;

namespace MyProgramNamespace
{
    class NativeMethods
    {
        [DllImport("user32.dll", EntryPoint = "GetWindowLongPtr")]
        public static extern IntPtr GetWindowLongPtr(IntPtr handle, int flag);

        [DllImport("user32.dll", EntryPoint = "SetWindowLongPtr")]
        public static extern IntPtr SetWindowLongPtr(IntPtr handle, int flag, IntPtr ownerHandle);
    }
} 
```

我只为 x64 编译，所以我不关心使用旧的 GetWindowLong 和 SetWindowLong。据我所知，这些入口点名称是正确的。

编辑：已解决。原来问题在于 Visual Studio 本身（以及代码分析工具）是 32 位的。当代码分析工具检查 user32.dll 以查看这些函数是否存在时，它会检查 user32.dll 的 32 位版本（在 C:/Windows/SysWOW64/ 中），而不是程序实际使用的那个（64 位版本）在 C:/Windows/System32 中），并且这些函数只存在于 64 位版本（32 位版本使用 GetWindowLong/SetWindowLong 而不是 GetWindowLongPtr/SetWindowLongPtr（注意 PTR 部分））。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:56:57.563

（这个答案也发布在原始问题底部的编辑中，以帮助人们快速轻松地找到它）

原来问题在于 Visual Studio 本身（以及代码分析工具）是 32 位的。当代码分析工具检查 user32.dll 以查看这些函数是否存在时，它会检查 user32.dll 的 32 位版本（在 C:/Windows/SysWOW64/ 中），而不是程序实际使用的那个（64 位版本）在 C:/Windows/System32 中），并且这些函数只存在于 64 位版本（32 位版本使用 GetWindowLong/SetWindowLong 而不是 GetWindowLongPtr/SetWindowLongPtr（注意 PTR 部分））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:19:46.683

它们不起作用的原因是，通过`EntryPoint =`在 DllImport 属性中指定，您是在告诉 Marshaller，“这是我希望您调用的确切函数”。

user32.dll中没有调用函数`GetWindowLongPtr`。有`GetWindowLongPtrA`和`GetWindowLongPtrW`。

当您省略 时`EntryPoint=`，Marshaller 将根据正在运行的操作系统调用一个或另一个。

因此，要么将其忽略，要么指定 A 或 W 版本。如果您指定 A 或 W，您还需要指定`CharSet=CharSet.Ansi`A 版本或`CharSet=CharSet.Unicode`W 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:11:28.280

尝试以下操作：

```
 [DllImport("user32.dll", EntryPoint = "GetWindowLongPtrW")]
    public static extern IntPtr GetWindowLongPtr(IntPtr handle, int flag);

    [DllImport("user32.dll", EntryPoint = "SetWindowLongPtrW")]
    public static extern IntPtr SetWindowLongPtr(IntPtr handle, int flag, IntPtr ownerHandle); 
```

# c++ - 需要帮助理解将参数传递给函数

> ID：13147608
> 
> 赞同：-1
> 
> 时间：2012-10-30T20:54:11.447
> 
> 标签：c++, c, function, parameters, arguments

我是 C++ 新手，不确定如何将参数传递给函数。

我正在使用一个函数`Distance()`来计算两个节点之间的距离。我这样声明函数：

```
int Distance(int x1, int y1, int x2 , int y2)
{   
    int distance_x = x1-x2;
    int distance_y = y1- y2; 
    int distance = sqrt((distance_x * distance_x) + (distance_y * distance_y));
    return distance; 
} 
```

在主存储器中，我有 2 个`for`循环。我需要知道的是我是否可以传递这样的值：`Distance (i, j, i+1, j+1)`.

```
for(int i = 0; i < No_Max; i++)
{
    for(int j = 0; j < No_Max; j++)
    {
        if(Distance(i, j, i+1, j+1) <= Radio_Range) // the function 
            node_degree[i] = node_degree[i] + 1;

        cout << node_degree[i] << endl;
    }  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:10:03.020

函数的参数可以作为与该参数类型匹配或可以强制转换的任何表达式提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T00:23:27.843

看起来好像您正在`Distance(int, int, int, int)`正确调用您的函数。以下语句将调用`Distance()`：

```
Distance (i, j, i+1, j+1); 
```

这会将返回的值存储`Distance()`在一个变量中：

```
int dist = Distance (i, j, i+1, j+1); 
```

这会将`Distance()`（左操作数）返回的值与`Radio_Range`（右操作数）进行比较。如果左操作数小于或等于右操作数，它将被评估为`1`(true)。否则它将是`0`（假的）。如果语句内的表达式的整体值`if`不为零，则将执行紧跟在该`if`语句之后的语句或块：

```
if(Distance(i, j, i+1, j+1) <= Radio_Range)
   //Statement; 
```

或者：

```
if(Distance(i, j, i+1, j+1) <= Radio_Range){
   //Statement;
   //Statement;
   //...
} 
```

但是，返回的值`Distance()`将被截断为整数。因此，除非是一个完美的正方形，`distance`否则不会等于实际距离。`(distance_x * distance_x) + (distance_y * distance_y)`为了获得更好的精度，请考虑使用`double`. 如果您打算让函数返回 an `int`，明智的做法是进行显式类型转换，例如：

```
int distance = (int)sqrt((distance_x * distance_x) + (distance_y * distance_y)); 
```

这将确保如果您或其他任何人稍后查看代码，他们不会认为该函数使用了错误的数据类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T21:31:26.020

提示：如果你想使用 sqrt，你应该使用 double 而不是 int：

[http://www.cplusplus.com/reference/clibrary/cmath/sqrt/](http://www.cplusplus.com/reference/clibrary/cmath/sqrt/)

# javascript - 删除单击元素后的jquery此选择器

> ID：13147610
> 
> 赞同：0
> 
> 时间：2012-10-30T21:08:27.357
> 
> 标签：javascript, jquery

我想用类 dialogBody 清空 div 的内容，然后附加返回的 ajax 响应。请看下面的代码。我遇到的问题是 .html(response) 没有做任何事情，因为点击的元素被删除了。删除单击的元素后，如何继承 $this.closest('.dialogBody') 的目标元素？

```
<div class="dialogBody">
  <p>Some content<a href="/question/33" class="ajaxReplace">Click to show question</a></p>
</div>
<script>
$(".ajaxReplace").live("click", function(e){
  e.preventDefault();
  var $this = $(this);
  $this.closest('.dialogBody').empty();          
  ajaxUrl = $(this).attr("href")+"?ajax=1";
  $.ajax({ 
    type: "POST",
    url: ajaxUrl,
    success: function(response){          
      $this.closest('.dialogBody').html(response);  
      console.log(response);
    }
  })                 
});   
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:10:31.303

将其分配给一个变量：

```
$(".ajaxReplace").live("click", function(e){
  e.preventDefault();
  var $this = $(this);
  var $dBody = $this.closest('.dialogBody').empty();   // <------       
  ajaxUrl = $(this).attr("href")+"?ajax=1";
  $.ajax({ 
    type: "POST",
    url: ajaxUrl,
    success: function(response){          
      $dBody.html(response);  // <------
      console.log(response);
    }
  })                 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:10:56.217

保存对您需要的元素的引用，而不是保存对将被删除的元素的引用：

```
$(".ajaxReplace").live("click", function(e){
  e.preventDefault();
  var ajaxUrl = $(this).attr("href")+"?ajax=1",
      $thisDialog = $(this).closest('.dialogBody').empty();          
  $.ajax({ 
    type: "POST",
    url: ajaxUrl,
    success: function(response){          
      $thisDialog.html(response);  
      console.log(response);
    }
  })                 
}); 
```

在删除元素*之前，*您还需要将`ajaxUrl`分配移动到。*`this`*

# xna-4.0 - Vertexbuffer Getdata VertexPositionNormalTexture

> ID：13147611
> 
> 赞同：1
> 
> 时间：2012-10-30T21:08:34.317
> 
> 标签：xna-4.0

我有一个带有 648 个 VertexPositionNormalTexture 元素的 Vertexbuffer。那是 27 个立方体，每个立方体包含 24 个顶点。

如果我想访问我的第一个立方体的顶点，我可以写：

```
int startIndex = 0;

VertexPositionNormalTexture[] vertices = new VertexPositionNormalTexture[24];

vertexBuffer.GetData<VertexPositionNormalTexture>(vertices, startIndex, 24); 
```

问题是如果我想访问我的第 9 个立方体 (24*9 = 216)。我必须写：

```
int startIndex = 216;

VertexPositionNormalTexture[] vertices = new VertexPositionNormalTexture[startIndex + 24];

vertexBuffer.GetData<VertexPositionNormalTexture>(vertices, startIndex, 24); 
```

我必须创建 192 个额外的插槽才能访问我的 24 个元素。因为 vertex.GetData 将复制到它从中获取数据的同一索引。我该怎么做它将我的 24 个元素写入正确大小的数组？

所有的类、结构和函数都来自 XNA Framework 4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T11:55:28.383

为什么需要使用 GetData？

保存对数组的引用并使用数组...而不是使用 vertexBuffer...

# xml - 将我的程序文本文件输出转换为 xml 输出有什么好处？

> ID：13147613
> 
> 赞同：1
> 
> 时间：2012-10-30T21:08:43.397
> 
> 标签：xml, fortran

我有一个 Fortran 程序，它通过编写大量文本文件来输出模拟数据。文本文件将给出网格单元集合的流体特性数据和导体网格单元集合的导体数据。所以类似于下面的例子。

```
Cell Group 1
Axial Level | Pressure | Temperature | Velocity
1           | 150.1    | 198         | 3.5
2           | 150      | 200         | 3.5
...         | ...      | ...         |

Cell Group 2
Axial Level | Pressure | Temperature | Velocity
1           | 150.1    | 201         | 3.5
2           | 150      | 205         | 3.5
...         | ...      | ...         |

Conductor Group 1
Axial Level | Conductivity | Temperature 
1           | 19.8         | 301         
2           | 19.7         | 305          
...         | ...          | ... 
```

通常，我们希望将这些数据组织成某种图形方式，以便解释或呈现它。例如，我可能想知道 Fluid-Cell Group 1,302 的压力变化是多少。要获取此信息，我将执行以下操作之一：

1.  重新编写我的 Fortran 程序的输出子例程，以便它在表格中提供我想要的特定数据，我可以使用 GNUplot 来绘制图表。
2.  编写一个 Python 脚本以从文本文件中获取输出并将其写入一个我可以使用 GNUplot 处理的新文件。
3.  将数据复制并粘贴到电子表格软件中，然后以这种方式构建图表。

我已经开始遇到在我参与的一些项目中使用 XML，但我对此几乎一无所知。我想弄清楚是否值得我花时间学习 XML 并开始向这个 Fortran 程序添加以 XML 格式写入数据的功能。如果我开始将数据写入 XML，是否可以改进我以前分析模拟数据的方法，使其更容易、更快和更自动化？如果是这样，我应该如何以及如何开始？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T22:53:17.667

我同意 Kevin 的观点，除非您的下游工具链读取 XML，否则编写 XML 没有什么意义。

我建议您考虑改为[HDF5](http://www.hdfgroup.org/HDF5/)，它是一种广泛用于科学数据集的格式。HDF Group 发布了针对 C、C++、Fortran 和 Java 的绑定（如果我没记错的话），但是许多其他语言/系统可以读写 HDF5 文件，包括 Python、Matlab、Mathematica、IDL 和一些开放的-源科学可视化工具，包括 ParaView。我还没有找到在 HDF5 文件上使用 GNUPlot 的直接方法。

如果您真的想要 XML `h5dump`，HDF Group 提供的实用程序之一可以将 HDF5 文件转换为 XML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:11:44.937

数据输出的格式与下游流程所需的输入直接相关。当您作为读者唯一拥有的是 .csv 进程时，编写 XML 将是愚蠢的。

如果您发现您的读者请求 XML，那么无论如何，学习 XML 并开始以这种方式编写。

学习你需要学习的东西，让自己跟上潮流，然后继续前进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T06:27:12.467

如果您想以图形形式查看数据，那么 vtk 或 silo 格式可能是您需要的。它们专为表示科学软件在网格上生成的数据而设计。使用诸如[visit](https://wci.llnl.gov/codes/visit/)之类的软件，您可以查看文件、比较多次运行（这听起来像是您想要做的）等等。[本文档](https://wci.llnl.gov/codes/visit/2.0.0/GettingDataIntoVisIt2.0.0.pdf)描述了如何将您的数据转换为这些格式，并应说明所需的工作量以及它是否值得解决您的问题。

这与@HighPerformancemark 建议使用 HDF5 格式有关。然而 HDF5 是一种相当灵活的格式，您不能指望绘图软件能够解释 HDF5 格式的任意数据。silo 使用 HDF5 进行存储，但对于如何存储网格和现场数据具有特定的格式。vtk 类似，但基于 xml。

# ruby-on-rails - 将旧数据库用户迁移到 Devise

> ID：13147616
> 
> 赞同：2
> 
> 时间：2012-10-30T21:08:55.973
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我们在 MySQL 中有一个旧的 PHP 应用程序，我们目前正在 Rails 和 PostgreSQL 中重写它。我正在寻找一种在用户首次登录新系统时将其逐个迁移的方法，以便我们仅迁移活动用户。

设计中是否有一个钩子**，**我可以使用它来捕获对新数据库的登录失败并检查用户是否存在于旧 MySQL 数据库中，如果找到则迁移用户。

顺便说一句，Rails 应用程序可以访问这两个数据库，并且迁移代码已经到位，可以接受 old`username`作为输入。

还是我应该简单地创建一个单独的 _migration_assistant_ 页面来接受旧登录并启动迁移？

PS。任何用户都可能有数千条数据库记录要迁移，因此可能需要一些时间，但我们已经使用 PosgreSQL`COPY FROM`来加快迁移速度（每个帐户大约需要几秒钟）。

**编辑：** 目前大约有**5000**名用户，我们预计其中大约**1000 名**用户会返回新网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:56:49.600

您可以仅从您的用户表中迁移所需的数据。在“old_id”列中包含原始主键。

创建[自定义加密器](https://github.com/plataformatec/devise/wiki/How-To%3a-Create-a-custom-encryptor)，以便用户可以使用现有密码登录。

当用户登录到使用保存的“old_id”触发每个用户的迁移过程的页面时[重定向用户。](https://github.com/plataformatec/devise/wiki/How-To%3a-Redirect-to-a-specific-page-on-successful-sign-in-out)

迁移期结束后，您可以查看 Devise[可跟踪](http://rubydoc.info/github/plataformatec/devise/master/Devise/Models/Trackable)列以确定可以清理哪些用户。

# google-places-api - Google 地方信息自动填充类型

> ID：13147617
> 
> 赞同：3
> 
> 时间：2012-10-30T21:08:56.297
> 
> 标签：google-places-api

我需要的是一个自动完成列表，该列表根据 Google Places API 的建立类型进行搜索。目前，谷歌似乎已将他们的 Places 自动完成 API 限制为诸如设施或地理位置之类的类型。我需要的是一种与 Google Places 搜索完全相同的类型，您可以在其中将结果限制为食品或酒吧等类型的场所。

有谁知道我该怎么做？我更愿意坚持使用 Google API，但请随意推荐其他 API。

# css - 带有大边框的内联块按钮向下两个像素

> ID：13147629
> 
> 赞同：2
> 
> 时间：2012-10-30T21:10:06.453
> 
> 标签：css

我有两个“inline-block”按钮，见下图：

![普通按钮](../Images/d5cba7db964b4974daac6dd5d1f4c034.png)

但是，如果单击，您将看到另一个按钮向下两个像素。

![在此处输入图像描述](../Images/468110f2cb1659652198b1588382a6ee.png)

**示例：http:** [//jsfiddle.net/caio/EUjeY/](http://jsfiddle.net/caio/EUjeY/)。

```
.button {
    border-radius: 2px;
    border: 1px solid #ddd;
    border-bottom: 3px solid #ccc;
    background: #eee;
    padding: 5px 10px;
    display: inline-block;
}

.button:hover {
    background: #e7e7e7;
}

.button:active {
    border-bottom: 1px solid #ddd;
    padding: 7px 10px 5px;
} 
```

你能帮我防止这种情况吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:00:08.730

您可以将其添加到您的 .button 类中：

```
vertical-align: top; 
```

工作示例：http: [//jsfiddle.net/uW7Sa/1/](http://jsfiddle.net/uW7Sa/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:14:33.207

只需提供`.button`css 属性`float: left`，两个按钮将保持在同一位置。这是因为`float: left`从文档流中移除了按钮，所以除了包含的 div 之外，它不受其他内联元素的影响：

```
.button {
    border-radius: 2px;
    border: 1px solid #ddd;
    border-bottom: 3px solid #ccc;
    background: #eee;
    padding: 5px 10px;
    display: inline-block;
    float: left;
} 
```

[**演示**](http://jsfiddle.net/EUjeY/3/)

我会提供更多代码，因为我在这里使用浮点数，但我不知道您文档的其余部分是什么样的，所以我无法补偿。

# xml - 使用 bash 打印 XML 标记

> ID：13147630
> 
> 赞同：0
> 
> 时间：2012-10-30T21:10:10.150
> 
> 标签：xml, bash, search, printing

我试图弄清楚如何使用 bash 在几个 XML 文件中打印某一行。这些文件位于多个文件夹中。我需要打印的行是一个名为 `<name></name>`.

我的目标：

*   搜索文件夹
*   在一行上打印文件夹位置
*   在第二行打印文件名
*   打印介于两者之间的内容

我只需要名称而不是完整路径，我确实需要将它添加到一个名为 .txt 的文件中。我尝试过使用 bash，但我坚持使用这个。

编辑：我也忘了提到这是一个被添加到其他 shell 脚本的片段，所以我不确定我是否可以让 grep 在其中工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T04:48:24.307

处理时`XML`，更好的方法是使用真正的工具，如`xmllint`or `xmlstarlet`。

举例：

```
find /path -iname '*xml' -exec xmllint --xpath '//name/text()' {} + 
```

这将递归地做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:15:10.013

在目录上递归使用 grep 和正则表达式会显示带有标签的文件名（包括路径）：

```
grep -r "<name>.*</name>" /path/to/directory 
```

# hardware - SATA AHCI 控制器的 PCI 功能编号

> ID：13147631
> 
> 赞同：4
> 
> 时间：2012-10-30T16:08:08.843
> 
> 标签：hardware

我正在调试带有 SATA AHCI 控制器的 PC 的第二阶段引导加载程序。我能够枚举 PCI 总线并找到硬盘。到目前为止，一切都很好。现在，我笔记本（Dell Inspiron 1525）中的 lspci 显示：

```
-[0000:00]-+-1f.0  Intel Corporation 82801HEM (ICH8M) LPC Interface Controller
           +-1f.1  Intel Corporation 82801HBM/HEM (ICH8M/ICH8M-E) IDE Controller
           +-1f.2  Intel Corporation 82801HBM/HEM (ICH8M/ICH8M-E) SATA AHCI Controller
           \-1f.3  Intel Corporation 82801H (ICH8 Family) SMBus Controller 
```

我的问题：SATA AHCI 控制器在任何 PC 中是否总是功能 2？如果没有，我是怎么找到的？

我不假装一般；启动我的笔记本就足够了，无需妥协进一步的改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:57:19.180

兼容的 SATA AHCI 控制器应始终具有设备类 1（存储控制器）子类 6（串行 ATA）和接口 1 (AHCI)。所以正确的策略是枚举所有的 PCI 设备并比较它们的类、子类和接口来识别那些实现 AHCI 的设备。请注意，可能不止一个，具体取决于主板以及是否插入了任何其他 AHCI 卡。

您可能还希望允许您的代码通过供应商和设备 ID 匹配 AHCI 控制器，因为一些早期的 AHCI 控制器没有适当的类/子类/接口集。

# capybara - Capybara -> 如何使用本地方法的结果

> ID：13147635
> 
> 赞同：2
> 
> 时间：2012-10-30T21:10:29.900
> 
> 标签：capybara, capybara-webkit

using`page.find( 'some-element' ).native`一致地返回一个字符串，比如'4'。文档声明它返回一些允许我访问本机方法的对象。有人遇到过这个吗？

Capybara 版本是`1.1.2` Capybara-Webkit 版本是`0.12.1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-25T20:35:34.537

听起来您可能正在使用 Capybara Webkit，它将内部节点表示为整数。您仍然可以使用以下方式访问本机 Rack::Test 节点：

```
page.find( 'some-element' ).base.native 
```

更多细节在这里：[https ://github.com/thoughtbot/capybara-webkit/issues/634](https://github.com/thoughtbot/capybara-webkit/issues/634)

# php - 新闻系统 CodeIgniter

> ID：13147637
> 
> 赞同：0
> 
> 时间：2012-10-30T21:10:37.090
> 
> 标签：php, codeigniter, url-routing

我尝试添加示例`http://ellislab.com/codeigniter/user_guide/tutorial/news_section.html`

到我的网站，这是代码：

新闻模型

```
<?php
class News_model extends CI_Model {

    public function __construct()
    {
        $this->load->database();
    }

public function get_news($art = FALSE)
{
    if ($art === FALSE)
    {
        $query = $this->db->get('news');
        return $query->result_array();
    }

    $query = $this->db->get_where('news', array('art' => $art));
    return $query->row_array();
}

public function set_news()
{
    $this->load->helper('url');

    $slug = url_title($this->input->post('title'), 'dash', TRUE);

    $data = array(
        'title' => $this->input->post('title'),
        'art' => $art,
        'text' => $this->input->post('text'),
        'image'=> $image
    );

    return $this->db->insert('news', $data);
  }
}
?> 
```

新闻控制器

```
<?php
class News extends CI_Controller {

    public function __construct()
    {
        parent::__construct();
        $this->load->model('news_model');
    }

    public function index()
    {
        $session_data = $this->session->userdata('logged_in');
        $data['username'] = $session_data['username'];
        $data['errors_login'] = array();
        $data['news'] = $this->news_model->get_news();
        $data['title'] = 'News archive';

    $this->load->view('main/open_news', $data);
    }

    public function view($art) {
    $data['news_item'] = $this->news_model->get_news($art);

    if (empty($data['news_item']))
    {
        show_404();
    }

    $data['title'] = $data['news_item']['title'];
    $session_data = $this->session->userdata('logged_in');
    $data['username'] = $session_data['username'];
    $data['errors_login'] = array();
    $this->load->view('main/open_one_news', $data);
    }   
} 
```

开放新闻

```
<?php
$this->load->view('mains/header');
$this->load->view('main/news');
$this->load->view('mains/footer');
?> 
```

新闻视图

```
<?php foreach ($news as $news_item): ?>

    <h2><?php echo $news_item['title'] ?></h2>
    <div id="main">
        <?php echo $news_item['text'] ?>
    </div>
    <a href="news/<?php $news_item['art'] ?>">View article</a>
<?php endforeach ?> 
```

当我点击`<a href="news/<?php $news_item['art'] ?>">View article</a>`

该页面不会转发到带有新闻的具体页面，仅在链接重复“新闻”中：

```
http://localhost/index.php/news/news/news/news/news/news 
```

我不知道有什么问题。但我认为它可能会在 routes.config 因为我只有： `$route['default_controller'] = 'login';`-> 这是我的起始页

但在 CodeIgniter 教程中是：

```
$route['news/(:any)'] = 'news/view/$1';
$route['news'] = 'news';
$route['(:any)'] = 'pages/view/$1';
$route['default_controller'] = 'pages/view'; 
```

但是当我从 3 第一行添加一些时，即使是带有新闻列表的第一页也没有打开。

已解决：我犯了愚蠢的错误。因为控制器名称是 news，但是 function: public function `view($art)`，而链接应该是: `'news/view/'.$news_item['art']`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:53:24.370

我认为以下链接有问题

```
 <a href="news/<?php $news_item['art'] ?>">View article</a> 
```

改用 codeigniter 锚

```
anchor('news/'.$news_item['art'],'View article'); 
```

试试这个并反馈给我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:56:55.647

你忘了`echo`在：

```
<a href="news/<?php $news_item['art'] ?>">View article</a> 
```

你应该使用：

```
<a href="news/<?php echo $news_item['art'] ?>">View article</a> 
```

或者：

```
<?php echo anchor('news/' . $news_item['art'], 'View article'); 
```

或者：

```
<?php echo anchor("news/{$news_item['art']}", 'View article'); 
```

# java - 如何将 SSL CA 获取到 Java 服务器

> ID：13147645
> 
> 赞同：1
> 
> 时间：2012-10-30T21:11:16.013
> 
> 标签：java, ssl, ca

所以这可能是一个愚蠢的问题，但我整天都在网上搜索，试图弄清楚如何将受信任的 SSL 证书放入我的 java 服务器。

细节：

我创建了一个创建 SSLServerSocket 接受连接的 java 服务器。我使用 keytool 创建了一个名为 domain.key 的密钥库以及一个证书请求 (csr)。然后我联系了证书颁发机构（starfield）并给了他们我的 csr，他们做了他们的事情并将证书退还给我（crt）。我有 3 个。一个叫 domain.com.crt，一个叫 sf_bundle.crt，一个叫 sf_intermediate.crt

经过大量搜索后，我发现我需要将证书导入密钥库，并且密钥库可以与具有我的公钥/私钥的密钥库相同，也可以位于单独的文件中。我选择将它放入一个名为 domain.trust 的单独文件中。

然后我修改了我的服务器以使用以下命令导入信任库和密钥库：

```
System.setProperty("javax.net.ssl.keyStore", "domain.key");
System.setProperty("javax.net.ssl.trustStore", "domain.trust"); 
```

沿着密钥库密码和信任库密码的相应行。

问题是，当我尝试使用任何客户端进行连接时，它总是说证书是出售签名的。

我一直在使用[http://certlogik.com/ssl-checker/](http://certlogik.com/ssl-checker/)来测试它。

我显然错过了一步，但我不知道在哪里。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:52:38.670

首先，您似乎对密钥库和信任库之间的区别感到困惑。[这个答案](https://stackoverflow.com/a/6341566/372643)可能很有趣。

从本质上讲，除非您想使用客户端证书身份验证，否则从服务器的角度来看，您无需更改信任库。

> 经过大量搜索后，我发现我需要将证书导入密钥库，并且密钥库可以与具有我的公钥/私钥的密钥库相同，也可以位于单独的文件中。

为了能够使用您从最初拥有的 CSR 获得的证书，您必须将该证书重新导入生成 CSR 的密钥库中，并且您必须将其与整个证书链一起导入到正确的别名中，存储私钥的地方。

这与此问题中的问题本质上是相同的[问题](https://stackoverflow.com/a/9300727/372643)，但来自服务器端。

使用以下命令查找具有您的私钥的别名`keytool -list -keystore store.jks`：

```
Your keystore contains 1 entry

myalias, Feb 15, 2012, PrivateKeyEntry, 
Certificate fingerprint (MD5): xxxxxxxx 
```

以正确的顺序准备包含您的证书和 CA 证书链的捆绑包（首先是您自己的证书，然后是每个颁发者一个一个）：

```
-----BEGIN CERTIFICATE-----
MIICajCCAdOgAwIBAgIBAjANBgkqhkiG9w0BAQUFADA7MQswCQYDVQQGEwJVSzEa
....
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICkjCCAfugAwIBAgIJAKm5bDEMxZd7MA0GCSqGSIb3DQEBBQUAMDsxCzAJBgNV
....
-----END CERTIFICATE----- 
```

（您可以使用每个块来验证每个证书的内容`openssl x509 -text -noout`并将其粘贴`---BEGIN/END---`到其标准输入中，包括分隔符。）

然后，一步导入​​该文件：

```
keytool -importcert -keystore store.jks -alias myalias -file bundle.pem 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:39:30.573

您首先需要了解 SSL 握手期间发生的情况。也许那时你可以缩小问题的范围。您可以参考互联网上的各种文档。[http://www.pierobon.org/ssl/ch/detail.htm](http://www.pierobon.org/ssl/ch/detail.htm)

1.  您正在运行的服务器必须安装有 CA StarField。或者它应该与 CA StarField 有信任关系。
2.  您的 rclient 证书必须是 CA StarField 签署的 CSR，我猜您已经这样做了。
3.  现在，当您将证书提交给服务器时，它会检查它拥有的 CA。
4.  因此，如果服务器具有 CA StarField 并且您的证书由 StarField 签名，那么您将不会收到自签名错误。
5.  仅当您的证书未由 CA 签名时，您才会得到它。只需打开您的证书并检查其颁发者详细信息即可确认。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:28:01.560

> 问题是，当我尝试使用任何客户端进行连接时，它总是说证书是出售签名的。

这表明根 CA 证书正在发送到客户端。
你没有提到你是如何创建你使用的这个单独的密钥库的。
您应该执行以下操作：

```
keystore.setKeyEntry("alias", privateKey, password, chain); 
```

并且链将具有：
`chain[0]`->您的服务器的证书
`chain[1]`->签名者的证书
....-
`chain[N]`>签名者到根

# c# - 如何从 Unity 3d shaderlab 中的像素着色器返回纹理？

> ID：13147652
> 
> 赞同：2
> 
> 时间：2012-10-30T21:11:48.667
> 
> 标签：c#, unity3d, shader, pixel-shader

如何创建一个简单的像素颜色着色器，说它需要一个纹理，应用类似遮罩的东西：

```
half4 color = tex2D(_Texture0, i.uv.xy);
if(distance(color, mask) > _CutOff)
{
    return color;
}
else
{
return static_color;
} 
```

in 并返回一个纹理，该纹理可以从 c# 代码以类似的方式传递给下一个着色器`mats[1].SetTexture("_MainTex", mats[0].GetTexture("_MainTex"));`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T13:21:12.083

> 但是......你可能不想做一个着色器来只修改一个纹理。

为什么不？这是一种常见的做法。

查看**Graphics.Blit**。它基本上绘制了一个应用了材质（包括着色器）的四边形。所以你可以使用你的着色器来修改纹理。但是纹理必须是 RenderTexture。

它会是这样的：

```
var mat = new Material(Shader.Find("My Shader"));
var output = new RenderTexture(...);
Graphics.Blit(sourceTexture, output, mat); 
```

在这种情况下，sourceTexture 将绑定到**My Shader**的 _MainTex 。

# java - Android蓝牙 - 检测与设备的断开连接

> ID：13147653
> 
> 赞同：3
> 
> 时间：2012-10-30T21:11:49.630
> 
> 标签：java, android, android-intent, bluetooth

我正在尝试捕获蓝牙设备断开连接意图过滤器。我在 onReceive 中添加了一个日志，但它永远不会到达它并且不会显示在 logcat 中。我怀疑问题出在我的 manifest.xml 配置上：

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.company"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="10"
        android:targetSdkVersion="16" />

    <uses-permission android:name="android.permission.BLUETOOTH" />
    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <receiver android:name="com.company.MyReceiver" android:enabled="true" android:exported="true">
            <intent-filter>
                <category android:name="android.intent.category.DEFAULT" />
                <action android:name="android.bluetooth.device.action.ACL_DISCONNECT_REQUESTED" />
                <action android:name="android.bluetooth.adapter.action.CONNECTION_STATE_CHANGED" />
                <action android:name="android.bluetooth.adapter.action.DISCOVERY_STARTED" />
            </intent-filter>
        </receiver>

        <activity
            android:name=".BTActivity"
            android:label="BTActivity" >
        </activity>
    </application>

</manifest> 
```

MyReceiver 扩展了 BroadcastReceiver：

```
@Override
    public void onReceive(Context context, Intent intent) {
        Log.i("got-in", "got-in-");
        // String action = intent.getAction();
        BluetoothDevice device = intent
                .getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

        Log.i("disconnect", device.getName());
        Intent i = new Intent(context, BTActivity.class);
        Bundle b = new Bundle();
        b.putString("deviceName", device.getName());
        intent.putExtras(b); // Put your id to your next Intent
        context.startActivity(i);
        // finish();

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T12:59:07.457

使用此代码接收断开连接（当蓝牙仍处于打开状态时）：

```
<intent-filter> <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />
    <action android:name="android.bluetooth.device.action.ACL_DISCONNECT_REQUESTED" />
    <action android:name="android.bluetooth.device.action.ACL_DISCONNECTED" />
</intent-filter> 
```

此外，您必须注册一个服务，然后注册一个广播接收器以更改蓝牙状态，以便您的应用知道蓝牙何时关闭并因此丢弃所有活动设备，因为当蓝牙关闭时您不会收到 ACL_DISCONNECT。

```
@Override
    public int onStartCommand(Intent intent, int flags, int startId) {

    IntentFilter filter = new IntentFilter();
    filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
    registerReceiver(bluetoothTurnedOnOff, filter);
    return START_STICKY;
}

private final BroadcastReceiver bluetoothTurnedOnOff = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getIntExtra(BluetoothAdapter.EXTRA_STATE, -1) == BluetoothAdapter.STATE_OFF) {
 [...] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-30T13:44:32.590

对于新用户。它会起作用的。您的清单文件看起来

```
<receiver android:name="(package name).BluetoothReceiver" >
            <intent-filter>
                <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />
                <action android:name="android.bluetooth.device.action.ACL_DISCONNECTED" />
            </intent-filter>
        </receiver> 
```

你的接收器看起来像

```
else if (intent.getAction().equals(`enter code here`
    BluetoothDevice.ACTION_ACL_DISCONNECTED)) {
    // connection lost 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T05:34:56.497

尝试`<category .../>`从意图过滤器中删除并重试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T22:04:24.417

在意图过滤器中尝试 android.bluetooth.device.action.ACL_DISCONNECTED 操作。它应该可以解决您的问题。

# algorithm - 来自 InterviewStreet 的保龄球计数算法

> ID：13147654
> 
> 赞同：3
> 
> 时间：2012-10-30T21:11:51.677
> 
> 标签：algorithm

我不知道这是否是正确的部分......但这里是：

上周在 interviewstreet (Code Sprint 3) 上的比赛有一个叫做保龄球的问题。（10 针保龄球，N 帧）。重点是统计播放N帧获得M分的方法数。

问题陈述在这里： http: [//pastebin.com/cyeLML8U](http://pastebin.com/cyeLML8U)

我很确定我已经使用二维 DP 解决了这个问题。但是，我得到了第三个样本数据错误（1 帧，25 分）。示例答案是 1，但我得到 6。

这是他们对示例答案的解释：

```
For the third case, there is only 1 way. Score a strike in the first frame, score another strike with the first extra ball, and an additional 5 with the second extra ball. 
```

但是，您不能在第一帧（也是唯一的）中得分，然后在随后的额外帧中得分以下任何一个吗？

```
10 5
9 6
8 7
7 8
6 9
5 10 
```

我无法理解为什么“1”是正确答案....我也在维基百科上查看了规则。

他们的回答可能是正确的，我可能忽略了一些非常明显的东西。谁能告诉我我的答案有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:16:14.710

你不能用第一个额外的球得到 9 个瓶，然后用第二个额外的球得到 6 个瓶，因为当你用第二个额外的球投球时，只剩下 1 个瓶了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:16:27.467

但如果第二球没有命中，就只有“捡到备用”的机会。也就是说，您只能获得 10 个引脚。因此，如果您在第一个球上被击中，然后在第二个球上被击中 9 个球，那么您在第三个球上最多可以得到 1 个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:32:29.473

我读它的方式，你的回答在技术上是正确的，但我认为这个问题没有被正确地提出。

在您问题链接中规定的限制范围内，我看不出您的解决方案有什么问题。在现实生活中，除非您将球瓶全部击倒或两次（或两次）击倒球瓶，否则球瓶实际上不会被重置，因此 - 正如其他人所说 - 您可以从 1 球框架中获得 25 分的唯一方法是真实的生命就是罢工，罢工，5。

基本上，这个问题没有给你正确的约束。我认为说你的答案错误是没有道理的，因为这个问题的措辞很糟糕。

# ruby-on-rails - Rails 小丑 has_one 用户名，舞者 has_one 用户名

> ID：13147657
> 
> 赞同：1
> 
> 时间：2012-10-30T21:12:21.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

在我的 Rails 应用程序中，我有一个用户名模型，它以多态方式附加到 2 个模型小丑和舞者。

创建 Joker 时，表单会发送一个字符串，该字符串是 Joker 的用户名。我应该如何进行设置，以便在接收用户名的字符串而不是 AR 对象时，rails 不会引发错误？

这是我现在拥有的代码。

```
class Joker < ActiveRecord::Base
  attr_accessible :username

  has_one :username
end 
```

并在创建 Jokers_controller

```
@joker = Joker.new(params[:joker]) 
```

Rails 抛出此错误：

```
Username(#19110) expected, got String(#9130) 
```

所以这是表单域

```
= form_for @joker do |f|
  - if @joker.errors.any?
    #error_explanation
      h2 = "#{pluralize(@joker.errors.count, "error")} prohibited this joker from being saved:"
      ul
        - @joker.errors.full_messages.each do |message|
          li = message

  = f.text_field :username 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:19:32.317

问题是因为您`username`作为文本字段传递，而 Rails 期望它是`Username`该类的实例。我要做的不是拥有一个`Username`模型，而是对两者进行验证，`Dancer`并`Joker`检查另一个模型是否存在冲突的用户名。这很简单：

```
 class Dancer < ActiveRecord::Base
   validate :unique_username

   # your model code goes here

   private

     def unique_username
       if Joker.find_by_username(username)
         errors.add(:username, "is already taken")
       end
     end
  end 
```

因此，删除`Username`模型和相关表并仅`username`向两者添加一个字符串字段，`dancers`并`jokers`在模型中进行此验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T19:38:32.990

我通过将应用程序切换到 mongodb 解决了这个问题。

# spring - 浏览弹簧上下文

> ID：13147658
> 
> 赞同：2
> 
> 时间：2012-10-30T21:12:26.903
> 
> 标签：spring, context.xml

目前，我正在开发一个具有大量依赖项的项目。在开发过程中，我有时会遇到一些 spring bean 的问题。通常，堆栈跟踪可以告诉我 bean 的名称。但是，它没有显示哪个 context.xml 文件声明了 bean。此外，它没有告诉我哪个 .jar 文件包含上下文文件以及该上下文文件是如何导入到我的项目中的（我指的是导入链）。

由于有许多依赖关系，并非所有上下文文件都在使用，许多 bean 都被覆盖......我花了很多时间来搜索正确的上下文文件。一个简单的解决方案是将所有相关项目导入我的 Eclipse 工作区，然后一切都变得非常缓慢。

我正在考虑编写一个工具来加快这个过程：

给定一个spring bean的名称/bean的类，该工具将在应用程序的整个类路径中搜索并返回：

*   声明 bean 的 spring 上下文文件。
*   包含 spring 上下文文件的 .jar 文件。
*   提取内容 spring 上下文文件并直接显示给用户
*   如果用户提供了根弹簧上下文文件，该工具将显示到目标弹簧上下文文件的导入链。

实现这一点并不需要很多时间，但我只是想知道是否有人已经实现了它？我只是不想重新发明轮子。

我找到了这个项目[https://github.com/julior/spring-inspector](https://github.com/julior/spring-inspector)。这很有趣，但这不是我需要的。

如果您知道上述工具，我会很高兴知道它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:23:26.227

您完全应该看看 Intellij IDEA 对 Spring Framework 的强大支持。

此处提供更多信息：http: [//www.jetbrains.com/idea/features/spring_framework.html](http://www.jetbrains.com/idea/features/spring_framework.html)

要在 xml 配置中找到有趣的 bean，您只需单击绿豆图像。

![在此处输入图像描述](../Images/00c8a8e8648e2841f06419baf62a1034.png)

Intellij IDEA 绝对物有所值。

# jquery - jquery ui对话框按钮隐藏并显示id isset

> ID：13147662
> 
> 赞同：0
> 
> 时间：2012-10-30T21:13:04.420
> 
> 标签：jquery

好的，所以我有一个对话框，女巫有一个表单来编辑数据库记录，但是相同的表单用于将记录添加到数据库中字段已设置 id

当对话框打开时，它会使用 id 设置此字段，然后我需要找到一种方法让此按钮仅显示是否设置了 id

```
 $( "#dialog-AL" ).dialog({
        autoOpen: false, 
        height: 530, 
        width: 650, 
        modal: true, 
        buttons: { 

            "Delete": function() {
            var attendance_id = $('#attendance_id').val();
                //more code here
            },

            "Submit": function() { 
            $('#anual_leave_form').submit(); },
            Cancel: function() {                        
                    $('#c1').val("");                       
                    $('#c1').html("");                      
                    $('#from').val("");                     
                    $('#to').val("");                       
                    tinyMCE.get('leave').setContent("");    
                    $('#attendance_id').val("");
                    $('#note_id').val("");                      
            $( this ).dialog( "close" );}}}); 
```

这是开放代码

```
 $( ".edit" ).click(function() {
        var sub_id = $(this).attr("id");
        var sub_name = $(this).attr("name");
        var dataString = 'attendance_id=' + sub_id + '&note_id=' + sub_name + '&LabourHire=' + LabourHire;
            $.ajax({
                type: "POST",
                url: "<?php echo $process . 'process_editleave.php'; ?>",
                data: dataString,
                dataType: "html",
                cache: false,
                success: function(data) {
                    var result = $(data).filter('#d50').text();
                    $('#c1').val(result);
                    var result1 = $(data).filter('#d51').text();
                    $('#c1').html(result1);
                    var result2 = $(data).filter('#d52').text();
                    $('#from').val(result2);
                    var result3 = $(data).filter('#d53').text();
                    $('#to').val(result3);
                    var result4 = $(data).filter('#d54').text();
                    tinyMCE.get('leave').setContent(result4);
                    $('#attendance_id').val(sub_id);
                    $('#note_id').val(sub_name);
                    $( "#dialog-AL" ).dialog( "open" );                 
                },
                error: function() {
                alert('Error occured');
                }
            });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:40:42.280

[您可以使用http://api.jqueryui.com/dialog/#option-buttons](http://api.jqueryui.com/dialog/#option-buttons)动态更改按钮`$(selector).dialog('option','buttons', object)`

在您创建对话框之前，请为按钮创建 2 个对象：

```
var dialogButtons = {
    "Submit": function() { /*code*/
    },
    Cancel: function() {  /* code*/
    }
}    
var dialogDeleteButton = {
    "Delete": function() { /* code*/
    }
} 
```

然后在打开之前更改按钮：

```
var buttons;
if ($('#attendance_id').val() != '') {
    buttons = dialogButtons;
} else {
    buttons = $.extend({}, dialogDeleteButton, dialogButtons)
}

$( "#dialog-AL" ).dialog('option','buttons', buttons).dialog('open') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:26:23.103

只需在您的 AJAX 成功回调中根据需要显示之前创建您的对话框。

```
 if(condition)
        $( "#dialog-AL" ).dialog({
        autoOpen: true, 
        height: 530, 
        width: 650, 
        modal: true, 
        buttons: { 

            "Delete": function() {
            var attendance_id = $('#attendance_id').val();
                //more code here
            },

            "Submit": function() { 
            $('#anual_leave_form').submit(); },
            Cancel: function() {                        
                    $('#c1').val("");                       
                    $('#c1').html("");                      
                    $('#from').val("");                     
                    $('#to').val("");                       
                    tinyMCE.get('leave').setContent("");    
                    $('#attendance_id').val("");
                    $('#note_id').val("");                      
            $( this ).dialog( "close" );}}});
    else
        $( "#dialog-AL" ).dialog({
        autoOpen: true, 
        height: 530, 
        width: 650, 
        modal: true, 
        buttons: { 
            "Submit": function() { 
            $('#anual_leave_form').submit(); },
            Cancel: function() {                        
                    $('#c1').val("");                       
                    $('#c1').html("");                      
                    $('#from').val("");                     
                    $('#to').val("");                       
                    tinyMCE.get('leave').setContent("");    
                    $('#attendance_id').val("");
                    $('#note_id').val("");                      
            $( this ).dialog( "close" );}}}); 
```

# kineticjs - KineticJS 和 VS2012

> ID：13147671
> 
> 赞同：0
> 
> 时间：2012-10-30T21:13:38.347
> 
> 标签：kineticjs

我已经在使用 KineticJS 的项目上工作了数周，没有问题。就在几分钟前，当我构建和调试我的页面时，它开始抛出错误。

这是错误：/scripts/kinetic-v4.0.3.js 中第 2258 行第 13 列未处理的异常

0x800a01b6 - Microsoft JScript 运行时错误：对象不支持属性或方法“indexOf”

我不知道发生了什么，它发生在任何项目中使用 KineticJS 的任何页面上......

我可以在 Firefox 中直接打开文件夹，然后一切正常。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T06:31:00.743

您使用的是旧版 IE 浏览器吗？IE6 或 IE7 不支持 indexOf 方法（尽管 canvas 也不支持）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T20:27:48.963

微软最大的 Internet Explorer 客户群是企业。企业已经投入了无数的金钱和时间来为旧版本的 IE 创建 Intranet 应用程序，这些应用程序会在更新/更符合标准的版本下崩溃。因此，对于在本地 Intranet 区域中检测到的网站，IE 将默认为兼容模式，以使 IE9 的行为类似于 IE7。

默认情况下，本地主机恰好是本地 Intranet。这可能是为什么在从 Visual Studio 进行 F5 调试时，尽管使用 IE9，但没有任何较新的 JavaScript 对象和方法可用。

幸运的是，您可以做一些事情。对于应用程序开发人员来说，最简单的方法是在页面标题中包含一个元标记，告诉 IE 在呈现该页面时忽略兼容模式：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge" /> 
```

首选方法可能是让 Web 服务器在该 Web 应用程序的每个 HTTP 响应中包含此标头。要么配置 IIS 来执行此操作，要么在 web.config 中包含以下内容（我相信对于 IIS7+）：

```
<system.webServer>
   <httpProtocol>
      <customHeaders>
         <remove name="X-UA-Compatible"/>
         <add name="X-UA-Compatible" value="IE=Edge" />
      </customHeaders>
   </httpProtocol>
</system.webServer> 
```

# opencv - cvCaptureFromCAM() / cvQueryFrame()：获取连接相机的原始分辨率？

> ID：13147674
> 
> 赞同：1
> 
> 时间：2012-10-30T21:13:49.977
> 
> 标签：opencv, resolution, video-capture, image-capture

我正在使用上面提到的两个 OpenCV 函数从我的网络摄像头中检索帧。没有设置其他属性，只是使用默认参数运行。

这里 cvQueryFrame() 总是返回大小为 640x480 的帧，与相机的原始分辨率无关。但是，当我不知道它的确切分辨率并因此无法设置宽度和高度属性时，如何获得全尺寸帧？有没有办法重置这些 640x480 设置？或者是否有可能查询设备支持的最大分辨率？

谢谢！

# xml - 如何在 xml 标签中获取文本

> ID：13147681
> 
> 赞同：1
> 
> 时间：2012-10-30T21:14:23.480
> 
> 标签：xml, parsing, tags

我得到了一个看起来像这样的 xml 文档：

```
<recenttracks user="xxxxxx" page="1" perPage="200" totalPages="2" total="233">
<track>
<artist mbid="160629ab-ec18-4931-8c95-02cb92d06186">Foreigner</artist>
<name>Long, Long Way From Home</name>
<streamable>1</streamable>
<mbid>1be3ee4b-98e7-4690-b872-ccabbccd09af</mbid>
<album mbid="4e1cf1f8-2383-434d-9125-6c28028db9d0">No End In Sight</album>
</track> 
```

现在我需要访问里面的 totalPages 属性，现在我知道如何获取两个标签之间的信息，例如像这样的名称标签： $track->name 但不知道如何获取标签内的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:32:11.220

根据[文档](http://www.php.net/manual/en/simplexml.examples-basic.php)，要获取属性值，请使用以下语法：

```
$recenttracks['totalPages']; 
```

PS：我对PHP Simple XML一无所知，我只是听说过google，所以我可能错了。

# iphone - 如何在 iPhone 程序开始时运行函数？

> ID：13147692
> 
> 赞同：1
> 
> 时间：2012-10-30T21:15:13.343
> 
> 标签：iphone, objective-c, xcode

所以在我的 iPhone 应用程序开始时我需要加载几个外部文件，我的问题是我想在应用程序启动时加载它们，但是如果我在目标 c 中使用 viewDidLoad 它会首先加载我的文件和然后显示屏幕。我该怎么做才能让屏幕先出现然后运行我的所有功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:16:53.063

在后台运行它们，例如：

```
dispatch_async(dispatch_get_main_queue(), ^{
    // tasks
}); 
```

如果任务不需要*在*主队列上运行，那么在单独的队列上运行它们会更好，因为它们不会阻止用户界面更新：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    // tasks
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:16:51.053

Default.png 总是首先出现；当它显示您可以开始其他任务时。

你能在 didFinishLaunchingWithOptions 中加载文件吗？

您不应该依赖您的用户乐于长时间盯着 Default.png，因此建议的过程是让它显示，花费最少的时间来执行您需要执行的任何文件操作 - 希望在后台线程 - 然后启动一些实际的 UI 并尽快启动应用程序。

如果您正在使用网络（外部文件）做某事，您可能会从像 AFNetworking 这样的库中获得所需的所有帮助，它可以让您启动操作并指定在收到数据时要执行的代码块，让您继续使用 UI。

# node.js - 如何使用NodeJS连接从请求中提取请求http标头

> ID：13147693
> 
> 赞同：335
> 
> 时间：2012-10-30T21:15:13.050
> 
> 标签：node.js

我想获取使用 Node JS 的连接库包发出的请求的“主机”标头。我的代码如下所示：

```
var app = connect()
  .use(connect.logger('dev'))
  .use(connect.static('public'))
  .use(function(req, res){

    var host = req.???

  })
 .listen(3000); 
```

连接的文档在这里，但我没有看到任何详细说明`req`上述代码中对象的 API 的内容。[http://www.senchalabs.org/connect/](http://www.senchalabs.org/connect/)

**编辑**：注意一个成功的答案必须指向文档（我需要这个来验证哪个版本提供了我正在寻找的 API）。

* * *

## 回答 #1

> 赞同：398
> 
> 时间：2015-05-18T11:36:59.127

如果您使用 Express 4.x，则可以使用[Express 4.x API 参考](http://expressjs.com/en/api.html#req.get)`req.get(headerName)`中描述的方法

* * *

## 回答 #2

> 赞同：274
> 
> 时间：2015-07-29T11:09:48.417

要查看 HTTP 请求标头列表，您可以使用：

```
console.log(JSON.stringify(req.headers)); 
```

返回 JSON 格式的列表。

```
{
"host":"localhost:8081",
"connection":"keep-alive",
"cache-control":"max-age=0",
"accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
"upgrade-insecure-requests":"1",
"user-agent":"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.107 Safari/537.36",
"accept-encoding":"gzip, deflate, sdch",
"accept-language":"en-US,en;q=0.8,et;q=0.6"
} 
```

* * *

## 回答 #3

> 赞同：154
> 
> 时间：2012-10-30T21:24:46.980

检查`console.log(req)`或的输出`console.log(req.headers);`

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2014-07-02T16:18:38.800

```
var host = req.headers['host']; 
```

标头存储在 JavaScript 对象中，标头字符串作为对象键。

同样，用户代理标头可以通过

```
var userAgent = req.headers['user-agent']; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-04-27T08:29:44.517

```
logger.info({headers:req.headers}) 
```

输出;

```
 "headers":{"authorization":"Basic bmluYWQ6bmluYWQ=","content-
type":"application/json","user-
agent":"PostmanRuntime/7.26.8","accept":"*/*","postman-token":"36e0d84a-
55be-4661-bb1e-1f04d9499574","host":"localhost:9012","accept-
encoding":"gzip, deflate, br","connection":"keep-alive","content-
length":"198"} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-16T15:03:55.833

在 express 中，我们可以使用 request.headers['header-name']，例如如果你在授权头中设置了一个 Bearer 令牌，并且想要检索令牌，那么你应该写 req.headers['authorization']，您将获得包含“Bearer tokenString”的字符串。

# javascript - 主干应用程序中的单个模型或集合以及如何访问它

> ID：13147694
> 
> 赞同：0
> 
> 时间：2012-10-30T21:15:13.877
> 
> 标签：javascript, backbone.js, requirejs

我正在查看[Backbone+RequireJS](https://github.com/addyosmani/todomvc/tree/gh-pages/dependency-examples/backbone_require/js)项目上的 Addy Osmani 的 Todos mvc 站点。我正在查看 Todos 集合，因为它不是标准对象。Todos 集合仅在 todos.js 文件中实例化一次，因为我们不需要两个 Todos 集合。因此 Addy 在 todos.js 文件中创建一个实例并返回它。

我想知道这对于这种“单例”对象是否是一个好习惯。例如，假设我有一个模型并且我的 ject 只需要这个模型的一个实例，我是否应该在 model.js 文件中返回一个实例化模型（以防我使用 RequireJS）？在不使用 RequireJS 的情况下，我应该怎么做？

另一个问题是处理如何访问模型实例。如果我在 model.js 文件中返回一个实例（使用 RequireJS），我只需要将 model.js 放在依赖项列表中，我就可以得到该实例。但是如果我不使用 RequireJS 或者我决定不在 model.js 中返回实例化模型怎么办？在这种情况下，访问模型实例的良好做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:29:13.787

```
var myApp = {
    controllers : {},
    models : {},
    routers : {},
    instances : {}

}; 
```

最简单的方法是：

```
myApp.models.Model = (function() {

    /* Model initiation etc can go here, just return the model in the end*/
    var Model = new Backbone.Model.extend({
        /* bla bla*/
    });

    return Model;

})();

myApp.instances.modelInstance = (function() {
    return new myApp.models.Model with app specific data;
})(); 
```

如果你要继续使用 requirejs （**你应该让它很棒**）

```
define(["deps1", "deps"], function(deps1, deps2) {

 var Model = new Backbone.Model.extend({
            /* bla bla*/
        });

        return Model;
}); 
```

然后定义一个新文件（“modelInstance.js”）

```
define(["Model"], function(Model) {

    return new Model with app specific data;
}); 
```

# jquery - jQuery MFX 手风琴未在 Chrome、IE 或 Safari 中初始化（在 Firefox 中运行良好）

> ID：13147698
> 
> 赞同：1
> 
> 时间：2012-10-30T21:15:47.703
> 
> 标签：jquery, google-chrome, joomla, safari, accordion

手风琴脚本在 Firefox 中运行良好，但显然是唯一可以运行的浏览器。这是链接（向下滚动到问答）：

[https://www.in-acuity.com/our-experts/experts_details/20-Frank%20-Koch](https://www.in-acuity.com/our-experts/experts_details/20-Frank%20-Koch)

我正在加载最新的 jQuery 和 UI 库，并且这个手风琴在许多其他网站上运行良好，没有错误。这个插件从来没有问题。曾经。

这是 Chrome 中弹出的错误：

**未捕获的类型错误：无法使用“in”运算符在未定义中搜索“height”**

我非常普遍地理解这意味着什么，但为什么它会在这里发生，而不是在这个脚本运行良好的大量其他站点中发生。调试了好几个小时，准备把海豹宝宝扔出窗外。

提前感谢您提供的任何帮助。

这是代码：

```
<?php
$db =& JFactory::getDBO();

$query = "[OMITTED]";
$db->setQuery( $query );
$questions = $db->loadObjectList();
$count = count($db->loadObjectList());

if($count) {

    echo '<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/jquery-ui.min.js" type="text/javascript"></script>
    <script src="[OMITTED]" type="text/javascript"></script>';  

    echo "<script type='text/javascript'>
                $(document).ready(function() {
                    $('.mfx_accordion').mfxAccordion({
                        slideSpeed: 300,
                        singleOption: true
                    });
                });
            </script>";

    echo '<div class="mfx_accordion">';

    foreach($questions as $question) {

        echo '<div class="section">
                 <h2 class="trigger settings"><span class="icon"></span>'.$question->ques.'</h2>
                 <div class="content">
                     <p>'.$question->anws.'</p>
                 </div>
              </div>';      

    }

    echo '</div>';  

}

?> 
```

编辑：

多亏乔治的帮助，才得以修好。这是更新的工作代码：

```
echo "<script type='text/javascript'>

          jQuery.noConflict(); 

          jQuery(document).ready(function($) {
              $('.mfx_accordion').mfxAccordion({
                  slideSpeed: 300,
                  singleOption: true
              });
          })(jQuery);

      </script>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T09:37:51.823

当您在同一页面上使用 jquery 和 mootools 时，通常会发生此类错误（正如我所看到的那样）。它们都使用 $ 符号作为库的快捷方式。我的建议是查看您的 jquery 代码并替换 $ 变量，看看是否有所作为

```
// Disable the $ global alias completely
jQuery.noConflict();

// For jQuery scripts
(function($){

// set a local $ variable only available in this block as an alias to jQuery
... here is your jQuery specific code ...

})(jQuery); 
```

为了安全起见，我也会对你的 mootools 脚本做同样的事情。因为这可能是 jQuery 错误的来源：

```
(function($){

// set a local $ variable only available in this block as an alias 
// to Mootools document.id
... here is your Mootools specific code ...

})(document.id); 
```

# sorting - 在vim中对两列进行排序

> ID：13147702
> 
> 赞同：7
> 
> 时间：2012-10-30T21:16:20.350
> 
> 标签：sorting, vim

我有一个看起来像这样的表：

```
名字姓氏；长度；体重；

```

我需要按长度排序，如果一个或多个名称的长度相等，我需要按重量对它们进行排序。`sort ni`仅按长度排序，我也尝试`sort /.\{-}\ze\dd/`过，但这也不起作用。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T23:04:47.533

这可以非常简单地使用外部（GNU）排序来完成：

```
!sort -t ';' -k 2,2n -k 3,3n 
```

这表示：按分号拆分字段，按数字排序第二个字段，然后按数字排序第三个字段。可能比您可以编写的任何 vim-internal 命令更容易阅读和记住。

有关 GNU 排序的更多信息：[http ://www.gnu.org/software/coreutils/manual/html_node/sort-invocation.html](http://www.gnu.org/software/coreutils/manual/html_node/sort-invocation.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:23:26.797

`r`用国旗试试。

按长度排序：

```
:%sort rni /.*;\ze\d/ 
```

按重量排序：

```
:%sort rni /\d+\ze;$/ 
```

如果没有这个标志，则对匹配*后*的内容进行排序，这可能有点麻烦。

使用`r`标志，排序是在匹配本身上完成的，这可能更容易定义。在这里，该模式匹配行尾分号之前的一系列 1 个或多个数字。

# html - Google Docs是如何实现内容编辑的？

> ID：13147703
> 
> 赞同：2
> 
> 时间：2012-10-30T21:16:25.093
> 
> 标签：html, google-docs, contenteditable

检查谷歌文档页面的 DOM，我找不到任何具有`contentEditable`属性集的元素。我什至尝试遍历 DOM，查看`isContentEditable`... 全部设置为`false`.

是什么赋予了？谷歌文档如何实现可编辑性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T09:50:10.810

Google Docs 使用自己的编辑界面而不是 contenteditable。它绘制自己的选择和插入符号，并手动处理大多数键和鼠标事件。我认为它可能有一个隐藏的 contenteditable iframe，用于收集用户输入，但我一直无法深入了解它。

这是一篇关于它的谷歌博客文章：

[https://drive.googleblog.com/2010/05/whats-different-about-new-google-docs.html](https://drive.googleblog.com/2010/05/whats-different-about-new-google-docs.html)

# sql - sql查询减去两个表值并将它们保存在第一个表中？

> ID：13147705
> 
> 赞同：2
> 
> 时间：2012-10-30T21:16:34.157
> 
> 标签：sql, tsql, oracle10g

如何从另一个表列值中减去一个表列值，并将该值保存在过程中的第一个表列中？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:21:35.903

`tablename`表在哪里，`col1`是第一列，`col2`是第二列。

```
UPDATE tablename SET col1 = (col2 - col1) 
```

如果您的意思是这些值来自不同的表，那么查询大致相同：

```
UPDATE tablename SET col1 = ((SELECT col2 from tablename2) - col1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:21:58.353

不确定您在寻找什么，但请选择您的示例：

```
update CarBrand 
set SortIndex =  (select SortIndex from CarBrand where CarBrandId = 3615) + 7
where CarBrandId = 3619

update CarBrand
set SortIndex = SortIndex - OtherColumn
where ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T22:32:06.687

如果没有有关您的表格或它们如何相关的详细信息，很难确定，但您可能想要类似的东西

```
UPDATE t1
SET col = t1.col - t2.col
FROM mytable t1
JOIN myothertable t2 ON t2.pkCol = t1.pkCol 
```

# ruby-on-rails-3 - ActiveRecord 事务不回滚

> ID：13147708
> 
> 赞同：3
> 
> 时间：2012-10-30T21:16:48.057
> 
> 标签：ruby-on-rails-3, activerecord, mass-assignment

我是 ActiveRecord 事务的新手。在下面的代码中，第一个 update_attributes 导致警告：无法批量分配受保护的属性：account_type_cdx，这没关系。但令我惊讶的是，下一行 self.update_attributes!(:purchased => true) 被执行并存储在数据库中。我期待它回滚，因为第一个失败了。

我一定是遗漏了什么……有什么提示吗？

```
def complete_purchase(current_user_id, plan_name)
    Rails.logger.debug "COMPLETE PURCHASE"
    user = User.find(current_user_id)
    ActiveRecord::Base.transaction do
        user.update_attributes!(:account_type_cdx => plan_name.to_sym)
        self.update_attributes!(:purchased => true)
    end
end 
```

我遵循了这篇文章的建议：http: [//markdaggett.com/blog/2011/12/01/transactions-in-rails/](http://markdaggett.com/blog/2011/12/01/transactions-in-rails/)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:30:05.060

Rails会*忽略*那些没有在`attr_accessible`类调用中明确列出的记录（因此是第一个更新警告）。它不会使交易失败，这就是为什么您要达到（并完成）第二个 update_attributes 的原因！一般。

# ruby-on-rails - 如何预先选择从数据库给定信息的下拉列表到 select_tag？

> ID：13147720
> 
> 赞同：0
> 
> 时间：2012-10-30T21:17:35.747
> 
> 标签：ruby-on-rails, html-select

我有这一行，在它作为表单提交后，C7000 或 C3000 被存储为字符串。对于编辑页面，我无法将存储的值作为下拉列表中的预加载选项，而不是“选择一个”。我究竟做错了什么？

`= select_tag :enclosure_model, "<option>Select One</option><option>C7000</option><option>C3000</option>".html_safe, :disabled => false`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:31:17.850

```
<%= select_tag :enclosure_model, helper.options_for_select([["select one", ""], ["c700"], "c700"], "c700"), :disabled => false %> 
```

上面的代码会选择c700

# submenu - 子菜单扩展父 div 而不是显示在顶部

> ID：13147723
> 
> 赞同：1
> 
> 时间：2012-10-30T21:17:52.110
> 
> 标签：submenu

我刚加入 Stack Overflow，我希望有人能帮我找到水平菜单的解决方案。我的子菜单似乎扩展了父 div 而不是显示在它上面。这是我的[代码](http://jsfiddle.net/baboyma/9Wy9E/)。

HTML 代码：

```
<div id="menu">
            <ul>
                <li><a id="" class="" href="">Home</a></li>
                <li><a id="" class="" href="">About Me</a>
                    <ul class="sub-menu">
                        <li><a href="">Biography</a></li>
                        <li><a href="">Photo Galery</a></li>
                        <li><a href="">Foot Print</a></li>
                    </ul>
                </li>
                <li><a id="" class="" href="">Expertise</a></li>
                <li><a id="" class="" href="">Projects</a>
                    <ul class="sub-menu">
                        <li><a href="">Geo 228 Portal</a></li>
                        <li><a href="">NEP Application</a></li>
                        <li><a href="">Geo Address Book</a></li>
                        <li><a href="">Assets Management</a></li>
                    </ul>
                </li>
                <li><a id="" class="" href="">Contact</a></li>
            </ul>
        </div> 
```

CSS 代码：

```
#menu {
    position: relative;
    font-size: 0.8em;
    margin: 0;
    padding: 0;
    background-color: #666666;
    border-top: 1px solid #999;
    border-bottom: 1px solid #999;
    overflow: hidden;
    z-index: 2;
}

#menu ul {
    position: relative;
    margin: 0;
    padding: 0;
    list-style: none;
    z-index: 3;
}

#menu li {
    display: block;
    width: 120px;
    float: left;
    border-right: 1px solid #999;
    z-index: 4;
}

#menu a {
    color: #ffffff;
    font-weight: bold;
    display: block;
    text-align: center;
    text-decoration: none;
    text-transform: uppercase;
    margin: 0;
    padding: 10px 20px;
}

#menu a:hover {
    color: #000000;
    margin: 5px 10px;
    padding: 5px 10px;
    background-color: #C0C0C0;
    border-radius: 10px;
}

#menu ul.sub-menu {
    display: none;
    position: relative;
}

#menu ul.sub-menu li {
    width: 200px;
    background-color: #C0C0C0;
    border-width: 0 1px 1px 1px;
    border-style: solid;
    border-color: #666666;
}

#menu ul.sub-menu li a {
    color: #000;
    text-align: center;
    margin: 5px 10px;
    padding: 5px 10px;
}

#menu ul.sub-menu li a:hover {
    color: snow;
    background-color: #666666;
}

#menu li:hover ul.sub-menu {
    display: block;
    z-index: 90;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T15:53:06.573

我将以下内容添加到菜单 div

```
overflow: visible;
height: 35px; 
```

我更新了你的[JsFiddle](http://jsfiddle.net/rayray/9Wy9E/6/)

# jquery - jQuery隐藏对象检查

> ID：13147724
> 
> 赞同：0
> 
> 时间：2012-10-30T21:17:52.207
> 
> 标签：jquery

> **可能重复：**
> [JQuery 隐藏对象](https://stackoverflow.com/questions/13146045/jquery-hidden-objects)

我第一次再次发布这个问题，很多人不明白。好的，我将再次更改我的问题，消除混淆部分。

我有 4 张具有不同 ID 的图像。我不能在这里使用类，因为每个图像都与另一件事相关，所以在这里忘记类以避免混淆。会发生什么，当用户点击每张图片时，它会隐藏起来。所以，点击 4 张图片后，4 张当然会被隐藏。

我希望在隐藏 4 个图像后，显示一个警告框。拜托，我必须包含一个代码来验证是否所有图像都隐藏在这里，不要问我为什么以避免再次混淆。单击后图像会隐藏，但唯一的问题是隐藏 4 个图像后不显示警告框。下面的代码：

```
$(document).ready(function() {

    $('#image1').click(function() {
        $(this).hide('slow');
    });

    $('#image2').click(function() {
        $(this).hide('slow');
    });

    $('#image3').click(function() {
        $(this).hide('slow');
    });

    $('#image4').click(function() {
        $(this).hide('slow');
    });

    if ($('#image1, #image2, #image3, #image4').is(':hidden')) {
        alert('kkk');
    }
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:24:43.330

试试这个 - 将你所有的功能组合成一个......因为它们都做同样的事情

```
$('#image1,#image2,#image3,#image4').click(function() {
    // hide current clicked
    $(this).hide('slow',function(){
        // check if all the images are hidden
        if ($('#image1,#image2,#image3,#image4').filter(':hidden').length == 4) {
            alert('I am a bunny');
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:20:43.713

[JSFiddle](http://jsfiddle.net/TAmNX/)

您需要创建一个`function`来执行检查，因为为相应**的**. 你拥有它的方式是在绑定之后它运行一次语句。按照以下方式进行操作将解决该问题...`click` `event``image``click` `events``if`

```
$(document).ready (function() {

   $('#image1').click(function() {
      $(this).hide('slow', checkImages);
   });

   $('#image1').click(function() {
      $(this).hide('slow', checkImages);
   });

   $('#image2').click(function() {
       $(this).hide('slow', checkImages);
   });

   $('#image3').click(function() {
       $(this).hide('slow', checkImages);
   });

});

function checkImages(){
   if ($('[id^=image]:visible').length == 0) {
     alert('I am a bunny');
   }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:27:57.040

首先，您可以通过对所有以 . 开头的元素使用选择器来消除重复`image`。

`$("[id^=image]")`选择 id 以 . 开头的所有元素`image`。

然后你必须提供隐藏回调函数，让它只在动画结束时运行：

```
$(document).ready(function() {
    $("[id^=image]").click(function() {
        $(this).hide('slow', function() {
            if ($('[id^=image]:visible').length == 0) {
                alert('I am a bunny');
            }
        });
    });
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T21:28:07.330

使用 hide 方法的回调并将 if 语句移动到 click 事件内部，以便在每次点击时发生。

```
$(document).ready(function(){
    var images = $("#image1, #image2, #image3, #image4")
    images.click(function(){
        $(this).hide('slow',function(){
            if (images.filter(":visible").length === 0) {
                alert("worky");
            }
        });
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T21:27:42.473

这将做你想要的，简化：

```
 $('#image1, #image2, #image3, #image4').click(function () {
            $(this).hide('slow', alertIfHidden);
        });

        function alertIfHidden() {
            if (!($('#image1, #image2, #image3, #image4').is(':visible'))) {
                alert('I am a bunny');
            }
        } 
```

请注意，您需要检查是否没有任何图像可见，如果至少有一个图像被隐藏，则返回 true 的原始代码。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-30T21:20:40.273

每次隐藏图像时，您都没有检查是否全部隐藏。这里有很多代码重构可能

```
$(document).ready (function() {

$('#image1').click(function() {
$(this).hide('slow');
checkAllHidden();
});

$('#image1').click(function() {
$(this).hide('slow');
checkAllHidden();
});

$('#image2').click(function() {
$(this).hide('slow');
checkAllHidden();
});

$('#image3').click(function() {
$(this).hide('slow');
checkAllHidden();
});

});
function checkAllHidden(){
  if ($('#image1, #image2, #image3, #image4').is(':hidden')) {
    alert('I am a bunny');
  }
} 
```

# google-fusion-tables - FusionTablesLayer infoWindow re-style 没有出现在网页中

> ID：13147733
> 
> 赞同：1
> 
> 时间：2012-10-30T21:18:43.827
> 
> 标签：google-fusion-tables, infowindow

在我的网页中，我使用`FusionTablesLayer`来自`FusionTable View`. 他们工作得很好。但是，我做了一个重新样式来更改图像显示的大小，以及字体大小、字体颜色。我可以从 中看到更改`Fusion Table Map`，我还可以看到 tableId 和加密的 tableId 此后没有更改，并且保存了信息，但我无法从我的网页中看到更改。我在这里错过了什么吗？有什么建议吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T19:50:42.083

我通过执行以下操作不使用 FusionTablesLayer 附带的 infoWindow 解决了这个问题：

1.suppressinfoWindows:true

1.  创建我自己的信息窗口
2.  为 FusionTablesLayer 创建 openInfoWindow click 事件处理程序，这里是 layer2

为 FusionTablesLayer 创建 openInfoWindow click 事件处理程序，这里是 layer2

像这样：

```
var map;
var infoWindow = new google.maps.InfoWindow();
function openInfoWindow(FTevent) {
    var contentStr = "<div class='googft-info-window' style='font-family:Arial, Helvetica, sans-serif; font-size: 12px; margin: 0; padding:0; background-color: #ffffff;'>";
   contentStr += "<h5 style='margin-top: 0; margin-bottom: 15px; color: #009AA6;'>" + FTevent.row['NAME'].value + "</h5>";
   contentStr += "<div style='text-align: center; width: 300px; height: 220px;'>";
   contentStr += "<img src=" + FTevent.row['URLIMAGE'].value +  " style='vertical-align: top; max-width: 300px; max-height: 220px;'><br>";
   contentStr += "</div></div>";
   infoWindow.setOptions({
   content: contentStr,
   position: FTevent.latLng,
   pixelOffset: FTevent.pixelOffset
});
infoWindow.open(map);
}
function initialize() {
.....
google.maps.event.addListener(layer2, 'click', openInfoWindow);

} 
```

通过这样做，我还可以收听 infoWindow 的“closeclick”，以及当 infoWindow 关闭时的一些内容，如下所示：

```
 map.setZoom(7);
  map.panTo(centerMarker.getPosition());
}); 
```

# jquery - 使用 jquery 最简单的拖放文件上传器插件

> ID：13147736
> 
> 赞同：2
> 
> 时间：2012-10-30T21:18:53.357
> 
> 标签：jquery, file-upload, drag-and-drop, laravel

我遇到了一个问题...我找不到一个很好且易于理解的插件，可以通过单击并选择文件或将文件拖放到某个区域来将文件上传到服务器...我知道那里网络上有很多插件，但我无法真正让它们中的大多数在我的服务器上工作......

例如， http: [//fineuploader.com](http://fineuploader.com)很好，但它使用 GET 请求，据我了解，这对我来说不是很好，而且无论如何它都不起作用......在控制器 url 中，它是在 js 中的“action”属性中编写的我写了一个脚本只是为了了解是否有东西上传，控制台显示 $_FILES 数组是空的......并且'上传失败'被写在拖放框中......我不知道为什么和什么是不是问题...

对于那些理解我在说什么的人：

我正在使用 Laravel 框架...

这是我在js属性中写的：

```
action:'<?=URL::to_action('test@upload')?>' 
```

这是我的控制器的样子：

```
<?php

    class Test_Controller extends Base_Controller {

    public $restful = true;

    public function post_upload() {

            $input = Input::All();

            print_r($input);

            print_r($_FILES);

            if (isset($_GET['file'])) {
                echo "good ";
            } else {
                echo "bad ";
            }
        }

    }
?> 
```

当我尝试上传文件时，控制台向我展示了包含类似内容的 $input 数组`Array ([file] => 'image.png')`和一个空的 $_FILES 数组`Array()`......我最后一次检查返回“好”......如果你知道如何处理这个问题请帮忙！

* * *

或者也许有人知道另一个好的和简单的拖放文件上传器插件......我将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T14:08:57.297

我找到了最好的拖放 jquery 插件！它易于理解且易于使用！

这是链接：[jquery-filedrop](https://github.com/weixiyen/jquery-filedrop/blob/master/README.md)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-08T14:47:50.007

我发现网上最简单的拖放插件：[http ://www.dropzonejs.com/](http://www.dropzonejs.com/)

用 jQuery 看看

# javascript - 使溢出调整大小以适应 div

> ID：13147739
> 
> 赞同：0
> 
> 时间：2012-10-30T21:19:07.583
> 
> 标签：javascript, jquery, html, css

我遇到了一个有趣的问题。我有一个`div`围绕菜单的容器。

如果我`overflow : hidden`在菜单上设置，菜单溢出的部分将被隐藏。

我不想隐藏它们，而是简单地调整“组列表”菜单弹出按钮的大小，以便它留在我的菜单中。

这是一个小提琴：http: [//jsfiddle.net/uW9nG/](http://jsfiddle.net/uW9nG/)

在小提琴中，您会看到，如果您将鼠标悬停在**A**上，它会飞出蓝色容器。如果您切换溢出，溢出将被隐藏。

如何使溢出简单地调整组列表的大小以使其适合容器？

（我整个早上都在研究这个数学，但不太明白..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:58:49.430

我分叉了你的小提琴并想出了一个[解决方案](http://jsfiddle.net/jayjx/1/)。只需找到容器和弹出窗口的顶部位置，然后找到差异并将弹出窗口与该值相对定位。我还必须将列表项的高度更改为 20px 硬编码，否则列表项会改变宽度。

```
var groupListTop = groupList.offset().top;
var containerTop = $('#container').offset().top;
if(groupListTop < containerTop) {
    var diff = containerTop - groupListTop;
    groupList.css({
        position: 'relative',
        top: diff
    })
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:08:06.410

您`groupList`目前正在获得一个`margin-top`，但制作它`position:absolute`然后将其拉上 -50px 会更简单（以匹配您`<ul id='test-two'>`向下推的 50px。[参见小提琴。](http://jsfiddle.net/jayjx/2/)

```
groupList.css({
    'top': '-50px',
    'position': 'absolute'
}); 
```

如果你`#test-two`没有定位，你可以给`groupList`0px 的`top`.

# android - Android 4.0 设计指南和向后兼容性

> ID：13147748
> 
> 赞同：0
> 
> 时间：2012-10-30T21:20:12.590
> 
> 标签：android, android-fragments

谷歌为[Android 4.0+ 设计指南](http://developer.android.com/design/index.html)提供了很好的资源。但是仍然有很大比例的 Android[用户运行 2.3.x](http://developer.android.com/about/dashboards/index.html)。

在保持与旧操作系统版本向后兼容性的同时，使用最新设计指南的最简单方法是什么？指南中有很多特殊的菜单和导航工具，可能仅适用于 Android 4.0+。他们是否优雅地退回到旧版本操作系统的基本元素？您是否必须为每个主要的 Android 版本创建一个完整的单独视图/模板？

采用最新指南的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:23:06.573

使用[ActionBarSherlock](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http%3A%2F%2Factionbarsherlock.com%2F&ei=EUWQUOT-BKXmiwLN5oHgDQ&usg=AFQjCNEKyOYK1H-iAiI67o4J8dIPJNL9TA&sig2=bBemH9Of9AkgJ6uiBJhwZA)和[HoloEverywhere](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=https%3A%2F%2Fgithub.com%2FChristopheVersieux%2FHoloEverywhere&ei=HEWQUL6iEaGcjAK43oD4DQ&usg=AFQjCNHjHK7GWfkXusOoRZ6dh3X4VXYCTg&sig2=MmcuMrDALTMnyCAeY2Xzjg)库，以及[Android 支持](http://developer.android.com/tools/extras/support-library.html)库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:23:20.113

谷歌有一个支持库（[链接](http://developer.android.com/tools/extras/support-library.html)），它移植了许多 Android 4 UI 功能。您可以查看他们主页上的功能列表以了解详细信息。

此外，还有 Jake Wharton 的 Actionbar Sherlock。这是对兼容性操作栏的扩展，它提供了比谷歌原始功能更多的功能。（[链接](http://actionbarsherlock.com/)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T05:58:08.423

“你必须为每个主要的 Android 版本创建一个完全独立的视图/模板吗？” 答案是否定的，您只需要一个适用于所有 Android 版本的 apk，但 UI 会根据操作系统版本和屏幕尺寸而改变。Android 为此提供了许多支持库。最新的设计指南仅适用于 Android 3.X (Honeycomb) 及更高版本。对于早期版本，UI 会相应地运行。请浏览有关支持库的 Android 文档，您也可以在其中找到一些示例。

但是，如果您希望所有版本的 Android 都具有相同的外观，那么您必须使用第三方库，例如 Actionbar Sherlock。

# javascript - Chrome 不尊重 z-index 顺序

> ID：13147757
> 
> 赞同：5
> 
> 时间：2012-10-30T21:21:15.910
> 
> 标签：javascript, google-chrome, z-index

我正在为一家教育公司创建一个学习模块，我在其中创建 25 个动物精灵（带有图像的画布）并将它们放在农场中（带有背景图像的 div）。然后我根据它们在背景上的位置重新排列它们的 z-index，这样更近的精灵将位于更远的精灵之上（背景 DIV 和精灵都是***position:absolute;***）。

这是重新排列精灵的函数：

```
Array.prototype.sortIndices = function (func) {
    var i = j = this.length,
        that = this;

    while (i--) {
        this[i] = { k: i, v: this[i] };
    }

    this.sort(function (a, b) {
        return func ? func.call(that, a.v, b.v) : 
                      a.v < b.v ? -1 : a.v > b.v ? 1 : 0;
    });

    while (j--) {
        this[j] = this[j].k;
    }
}

function rearrangeSprites() {
    var zSprites = new Array();
    for (var i = 0; i < sprites.length; i++) {
        var a = $('#sprite_'+i).css('bottom');
        a = a.substr(0, a.length - 2);
        zSprites[i] = { b : -a*1 };
    }
    zSprites.sortIndices(function(a,b) { return a.b - b.b; });

    for (var i = 0; i < zSprites.length; i++) {
        spriteObjects[zSprites[i]].style.zIndex = (1001 + i) + '';
    }
} 
```

它在 IE 和 Firefox 中运行良好，但 Chrome 不尊重 z-index 顺序。

有任何想法吗？

* * *

## 对答案的回应：

**justspamjustin：**正如文章所指出的，在某些时候尝试了负 z 指数。还尝试使用以下代码重新排序对象：

```
 $('.sprite').detach();
    for (var i = 0; i < zSprites.length; i++) {
        $('#Stage_udi_meadow').append(spriteObjects[zSprites[i]]);
        spriteObjects[zSprites[i]].style.zIndex = (i + 1000) + '';
    } 
```

纳达！

**弗朗西斯：**用 DIV 来替换画布是一件相当不错的事情，因为很多代码都是围绕画布特性构建的。我还需要它是画布，因为我正在使用透明度、PNG 阴影和对拖动进行命中测试，这不适用于简单的 DIV，所以我将把这个美味的选项留到最后。

**apsillers：** CSS（根据要求）：

对于精灵：

```
element.style {
width: 60.674351585014406px;
height: 60.674351585014406px;
left: 204.55043227665706px;
top: 22.550432276657062px;
cursor: pointer;
z-index: 1003;
}

.sprite {
background-repeat: no-repeat;
margin: 0px;
padding: 0px;
overflow: hidden;
position: absolute;
z-index: 140;
}

.EDGE-122375087, .EDGE-122375087 * {
-webkit-transform: translateX(0px);
} 
```

背景：

```
element.style {
position: absolute;
margin: 0px;
left: 0px;
top: 177px;
width: 566px;
height: 347px;
right: auto;
bottom: auto;
background-size: 100%;
background-image: url(http://localhost:9090/cet_html5/publish/images/udi_meadow.png);
-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
opacity: 1;
background-position: 0px 0px;
background-repeat: no-repeat no-repeat;
}

#Stage_udi_meadow {
}

.EDGE-122375087, .EDGE-122375087 * {
-webkit-transform: translateX(0px);
}

user agent stylesheetdiv {
display: block;
}

Inherited from body
Style Attribute {
cursor: auto;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:34:57.143

有时 z-index 可能有点棘手。[W3](http://www.w3.org/TR/CSS2/zindex.html#painting-order)的这篇文章可能会有所帮助。但该规范可能有点令人困惑。如果我不能让 z-index 工作，那么我要确保我在 DOM 中的元素排序正确。通常，DOM 中较低的元素具有较高的可见性偏好。所以在某些情况下，这可能是真的：

```
<div style="z-index:9999">I'm on bottom</div>
<div>I'm on top</div> 
```

尝试重新排序 DOM 中的元素。

# php - 将 pg_query 的结果存储在表中

> ID：13147759
> 
> 赞同：1
> 
> 时间：2012-10-30T21:21:20.153
> 
> 标签：php, sql, postgresql

是否可以将查询结果存储在表中？

例如，我目前使用以下方法运行查询`php`：

```
$sql = "SELECT id FROM mytable";
$query = pg_query($connection, $sql); 
```

然后我`pg_fetch_row()`用来访问结果并将其返回给网络浏览器。但是，我还想将结果存储在一个新表中。我知道我可以两次运行相同的查询，所以我也会：

```
$sql_2 = "CREATE newtable AS SELECT id FROM mytable";
$query = pg_query($connection, $sql_2); 
```

我很好奇是否有一种更有效的方式来构建我的查询，以便我既可以访问结果，又可以通过一个查询将结果插入到表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:34:07.863

不幸的是，该`CREATE TABLE`命令似乎不接受`RETURNING`子句，因此不允许仅让该命令也返回结果。所以你可能需要做两个查询。

您可以先交换查询以创建新表，然后通过选择该新表来获取结果。访问新创建的表可能比执行两次初始查询要快一些，因为 postgres 不需要查看任何不相关的数据。这也将保证相同的结果出现在两个地方。

# javascript - FlotJS 不会在正确的日期绘制数据

> ID：13147760
> 
> 赞同：0
> 
> 时间：2012-10-30T21:21:29.787
> 
> 标签：javascript, jquery, flot

[http://jsfiddle.net/jJNmV/](http://jsfiddle.net/jJNmV/)

是的，我已经将我的时间乘以 1,000，正如你所见，这些点并没有出现在日期上，而是出现在日期的一侧。为什么会这样？

我的数据和 x 轴如下所示：

```
{data: [[1351483200000, 12],[1351569600000, 1]], label: "Clicks"}, {data: [[1351483200000, 24],[1351569600000, 1]], label: "Opens"}
  ], {
    xaxis: {
      mode: 'time',
      timeformat: '%y/%m/%d',
      minTickSize: [1, 'day']
    }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:01:58.197

看起来你没有考虑你的时区。[API 文档](https://github.com/flot/flot/blob/master/API.md)的“时间序列数据”部分更详细，但基本思想是您需要从每个时间戳中添加/减去您的时区偏移量。

# php - Kohana ORM 更新、插入或删除以返回受影响的行数

> ID：13147768
> 
> 赞同：0
> 
> 时间：2012-10-30T21:22:18.400
> 
> 标签：php, kohana

使用 ORM for Kohana 创建、更新或删除后，如何获取受影响的行数？我检查了主类，但没有返回那个值......

如果有任何可能的解决方案来做到这一点，请告诉我。如果可以不使用查询生成器，我更喜欢只使用 ORM 类。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T16:24:10.200

由于其[级联文件系统](http://kohanaframework.org/3.3/guide/kohana/files#cascading-filesystem)，在 Kohana 中很容易对系统或模块类进行一些更改。

在您的情况下，您需要重新定义`ORM`模块主类的方法。它的文件位于`/modules/orm/classes/kohana/orm.php`.

在新`ORM`模块主类文件中创建`/application/classes/orm.php`并重新定义`create`,`update`和`delete`方法，以便这些方法返回受影响的行数。

例如，新`update`方法应以此结尾：

```
// Update a single record
$update_result = DB::update($this->_table_name)
    ->set($data)
    ->where($this->_primary_key, '=', $id)
    ->execute($this->_db);

if (isset($data[$this->_primary_key]))
{
    // Primary key was changed, reflect it
    $this->_primary_key_value = $data[$this->_primary_key];
}

// Object has been saved
$this->_saved = TRUE;

// All changes have been saved
$this->_changed = array();
$this->_original_values = $this->_object;

return $update_result; 
```

# .net - WCF windows 服务使用 https

> ID：13147769
> 
> 赞同：0
> 
> 时间：2012-10-30T21:22:26.500
> 
> 标签：.net, wcf, https, windows-services, wcf-binding

我的任务是对现有的 WCF 服务进行一些更改（我以前没有任何使用 WCF 的经验）。该服务作为 Windows 服务运行。客户端应用程序通过 http 连接到它，调用 Datagram.Services 中公开的方法。我只需要更改它，以便客户端应用程序只能使用 https（而不是 http）连接。是否可以仅通过更改配置文件来做到这一点？如果是这样，任何需要在下面的配置文件中更改以完成它的建议。客户端是否还必须安装证书才能连接到此应用程序？

```
<system.serviceModel>  
    <services>  
      <service name="Datagram.Services" behaviorConfiguration="Datagram_Behavior">  
        <endpoint address="" binding="basicHttpBinding" bindingConfiguration="" name="Datagram.Service" contract="Datagram.IServices" />  
        <endpoint address="mex" binding="mexHttpBinding" name="MEX" contract="IMetadataExchange" />  
        <host>  
          <baseAddresses>  
            <add baseAddress="http://localhost:5000/Datagram" />  
          </baseAddresses>  
          <timeouts closeTimeout="00:01:00" openTimeout="00:05:00" />  
        </host>  
      </service>  
    </services>  
    <behaviors>  
      <serviceBehaviors>  
        <behavior name="Datagram_Behavior">  
          <serviceMetadata httpGetEnabled="true" />  
          <serviceDebug includeExceptionDetailInFaults="true" />  
        </behavior>  
      </serviceBehaviors>  
    </behaviors>  
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T09:39:30.833

您是否启用了传输级安全性？

[http://www.codeproject.com/Articles/36705/7-simple-steps-to-enable-HTTPS-on-WCF-WsHttp-bindi](http://www.codeproject.com/Articles/36705/7-simple-steps-to-enable-HTTPS-on-WCF-WsHttp-bindi)

# android - Tabhost 的 GCM 消息打开选项卡

> ID：13147770
> 
> 赞同：0
> 
> 时间：2012-10-30T21:22:27.047
> 
> 标签：android, android-tabhost, google-cloud-messaging

我有一个相当基本的 android 应用程序，它是一个包含 4 个选项卡的选项卡，每个选项卡都打开一个 web 视图。该应用程序还具有 GCM 所有设置，目前可以正常接收消息。但是，当收到一条消息时，您单击它，它只会打开应用程序，就像单击应用程序图标会打开应用程序一样。我想要做的是当有人点击消息时在应用程序中打开一个特定的选项卡，如果我可以根据消息的内容打开任何选项卡，那就更好了。这可能吗？如果是这样，我将如何去做？

从我目前发现的情况来看，我认为这涉及在消息的有效负载中添加一个额外的项目，例如

```
{
  "registration_id" : "APA91bHun4MxP5egoKMwt2KZFBaFUH-1RYqx...",
  "data" : {
    "message" : "Text notification goes here",
    "tab" : "2"
  },
} 
```

然后可能会做一些我不知道该怎么做的意图。我在正确的轨道上吗？有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:34:18.873

您可以向传递给通知的待处理意图添加额外内容，以指示要打开哪个选项卡。

当活动开始时，检查额外的内容并相应地打开选项卡。

# java - Restlet - 使用路由器附加资源类时出现问题

> ID：13147772
> 
> 赞同：3
> 
> 时间：2012-10-30T21:22:38.120
> 
> 标签：java, rest, restlet

使用 Restlet 2.1.0，Java SE 版本进行原型设计，我无法将 ServerResource 类映射到 url。我使用 Router.attach 方法尝试了很多变体，但没有任何效果。

我当前的代码如下所示：

```
/**
 * @param args
 * @throws Exception 
 */
public static void main(String[] args) throws Exception {
    final Router router = new Router();
    router.attach("/hello", FirstServerResource.class);
    router.attach("/json", Json.class);

    Application myApp = new Application() {
        @Override
        public org.restlet.Restlet createInboundRoot() {
            router.setContext(getContext());
            return router;
        };
    };

    new Server(Protocol.HTTP, 8182, myApp).start();
} 
```

当我浏览到`http://localhost:8182/hello`它时，模板匹配不正确。通过源代码进行调试，我看到匹配逻辑将请求的资源视为`http://localhost:8182/hello`而不是仅仅`/hello`. 发生这种情况的 Restlet 代码在这里：

```
// HttpInboundRequest.java
// Set the resource reference
if (resourceUri != null) {
    setResourceRef(new Reference(getHostRef(), resourceUri));

    if (getResourceRef().isRelative()) {
        // Take care of the "/" between the host part and the segments.
        if (!resourceUri.startsWith("/")) {
            setResourceRef(new Reference(getHostRef().toString() + "/"
                    + resourceUri));
        } else {
            setResourceRef(new Reference(getHostRef().toString()
                    + resourceUri));
        }
    }

    setOriginalRef(getResourceRef().getTargetRef());
} 
```

在上面的代码中，它将 Resource 视为*relative*，因此将请求的资源从更改`/hello`为完整的 url。我在这里遗漏了一些明显的东西，但我完全被难住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:09:01.850

最后通过打开日志记录（FINE）找到了解决方案。我看到了这条日志消息：

> 默认情况下，应将应用程序附加到父组件，以便让应用程序的出站根正确处理调用。

我不完全理解它的含义（也许我必须从头到尾阅读文档？）。将应用程序附加到*VirtualHost*解决了问题：

```
public static void main(String[] args) throws Exception {   
    final Router router = new Router();
    router.attach("/hello", FirstServerResource.class);
    router.attach("/json", Json.class);
    router.attachDefault(Default.class);

    Application myApp = new Application() {
        @Override
        public org.restlet.Restlet createInboundRoot() {
            router.setContext(getContext());                
            return router;
        };
    };

    Component component = new Component();
    component.getDefaultHost().attach("/test", myApp);

    new Server(Protocol.HTTP, 8182, component).start();
} 
```

# google-app-engine - AppEngine SQLite 数据存储区可以与 Django SQLite 后端一起使用吗？

> ID：13147774
> 
> 赞同：4
> 
> 时间：2012-10-30T21:22:45.767
> 
> 标签：google-app-engine

随着 AppEngine 1.7.3 的发布，SQLite 数据存储存根很快将成为 Python SDK 的默认设置。是否有计划让使用 Django 和 Cloud SQL 的用户能够在本地使用带有 SQLLite Django 后端的 SQLLite 数据存储？

# c++ - 优先考虑一个运算符 [] 而不是另一个

> ID：13147775
> 
> 赞同：2
> 
> 时间：2012-10-30T21:22:56.120
> 
> 标签：c++

考虑以下类：

```
class Test
{
public:
    Test( char );
    Test( int );
    operator const char*();
    int operator[]( unsigned int );
}; 
```

当我使用它时：

```
Test t;
Test& t2 = t[0]; 
```

我收到一个编译器错误，它无法确定要使用哪个 operator[]。MSVC 和 Gcc 都有。不同的错误。但同样的问题。

我知道发生了什么。它可以从 int 或 char 构造 Test ，它可以使用`Test::operator[]`也可以转换为 const char* 并使用内置的`char*[]`.

我希望它更喜欢`Test::operator[]`。

有没有办法指定这样的偏好？

更新：首先，我同意下面的回复，即没有语言功能可以让您指定转换的优先级。但就像下面发现的 juanchopanza - 您可以通过使一个转换不需要强制转换来间接创建这样的偏好，而使另一个转换需要强制转换。例如`unsigned int`，作为`operator[]`不会起作用的论点，但是，使用`int`意志。

默认索引参数是无符号的 - 无论如何对于 gcc 和 msvc - 因此使索引参数无符号将导致编译器更喜欢正确的运算符。

@Konrad：关于到内置类型的隐式转换。大体同意。但在这种情况下我需要它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:24:28.337

不，没有。而这种歧义就是为什么`operator char*`不建议自动转换为另一种类型（如 ）的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:25:25.417

您总是可以创建构造函数`explicit`——或者，正如 john 所指出的，省略转换运算符。我通常建议做所有这些事情，但由于您的代码是一个玩具示例，因此很难说出适合您情况的内容。

也就是说，以下应该有效：

```
Test const& t2 = t.operator[](0); 
```

（注意添加`const`- 否则您会将临时绑定到非常量引用，这也不起作用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T01:17:17.657

我之前已经实现了像你这样的容器类——完全有可能在保持简洁、直观的语法的同时避免歧义问题。

首先，您需要考虑 const-ness。通常， const char* 强制转换不会修改对象，因此将其设为 const 成员函数：

```
operator const char*() const; 
```

此外，您的 [] 运算符返回一个 int 而不是 int&，所以这也应该是 const：

```
int operator[]( unsigned int ) const; 
```

如果您希望能够为索引元素（mytest [5] = 2）分配一个值，您将添加另一个像这样的运算符函数（这不会替换上面的 const 版本——保留两者）：

```
int& operator[](unsigned int); 
```

接下来，您将希望接受不仅仅是 unsigned int 的索引。文字整数具有 int 类型。为避免与索引类型相关的问题，您需要重载运算符以获得替代方案。这些重载只会将索引静态转换为您的本机索引类型并将其传递给本机重载（用于本机索引类型的重载）。这些重载之一可能如下所示：

```
int operator[]( int idx ) const {
    return operator[]( static_cast<unsigned int>(idx) ); 
} 
```

您可以使用单个模板成员函数来涵盖所有可能性，而不是添加一堆重载。模板函数将用于任何还没有非模板重载的索引类型。这种对非模板重载的偏好是明确的。本质上，这实现了您对首选运算符的请求，但 const-ness 不是可模板化的，因此如果您有一个 const 和一个非常量 [] 运算符，则需要两个版本。这个包罗万象的成员函数可能看起来像这样（请记住，它的定义必须保留在类的声明中，并且不能移动到实现文件中）：

```
template <typename IT>
int operator[]( const IT& idx ) const {
    return operator[]( static_cast<unsigned int>(idx) );
} 
```

如果您添加了 [] 运算符的非常量版本，那么您还需要：

```
template <typename IT>
int& operator[]( const IT& idx ) {
    return operator[]( static_cast<unsigned int>(idx) );
} 
```

享受！

# php - 完善星级评定系统

> ID：13147776
> 
> 赞同：0
> 
> 时间：2012-10-30T21:22:59.817
> 
> 标签：php, mysql, ajax, rating

我为一个学校项目制作了一个星级评分系统，需要一些帮助来改进它。这是一个相当简单的设置：index.php 包含列表项（内容是从数据库中获取的），其中包含一个图像和一个 div，其中包含用于评级的星星。每颗星都是一个链接，它触发将评级保存在数据库中的功能。

这是[链接](http://kristianmaar.dk/projekter/s3p2/v3/)！对于初学者。

如果您单击任何星，第一次单击将导致第一个列表项上出现绿色复选标记。这个想法是这个复选标记将在评级时出现在每个列表项上。这就是我需要你们为我指明正确方向的地方。首先，我知道我不能用相同的 id 回显多个 div，但我必须这样做才能使 ajax 函数工作（document.getElementById("rated")）。关于如何解决这个问题的任何想法？

**代码**

insert_receive.php：

```
<?php
  session_start();
  $sess = session_id();

  $mysqli = new mysqli("", "", "", "");
  if (mysqli_connect_errno()) {
  printf("Connect failed: %s\n", mysqli_connect_error());
   exit();
 }

$stmt = $mysqli->prepare("REPLACE INTO Ratings (projId_fkey, sessionId, rvalue) VALUES ('".$_GET['projId']."','".$sess."','".$_GET['rating']."')");
$stmt->execute();

printf("✔");
?> 
```

ajax_framework.js：

```
function saveClick(rating,projId)
{

var xmlhttp;

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
if (xmlhttp.readyState==4 && xmlhttp.status==200)
{
document.getElementById("rated").innerHTML=xmlhttp.responseText;
}
}
xmlhttp.open("GET","insert_receive.php?rating=" + rating + "&projId=" + projId,true);
xmlhttp.send("");
} 
```

index.php：（重要的部分）

```
<?php

$select = "SELECT id, projName, location FROM Projects";

if($result = $mysqli->query($select))
{
    while($row = $result->fetch_assoc())
    {
        echo '<li id="'.$row['id'].'">';
        echo '<h1 class="header">'.$row['projName']."</h1>";
        echo '<img src="'.$row['location'].'" alt=""/>';
        echo '<div class="rating">';
        echo '<a href="#" onclick="saveClick(5, '.$row['id'].')">'.★★★★★."</a>";
        echo '<a href="#" onclick="saveClick(4, '.$row['id'].')">'.★★★★."</a>";
        echo '<a href="#" onclick="saveClick(3, '.$row['id'].')">'.★★★."</a>";
        echo '<a href="#" onclick="saveClick(2, '.$row['id'].')">'.★★."</a>";
        echo '<a href="#" onclick="saveClick(1, '.$row['id'].')">'.★."</a>";
        echo '<div id="rated">'.""."</div>";
        echo "</div>";
        echo "</li>";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:32:25.790

您可以使用迭代器为每个元素赋予不同的 ID，之后，您确实可以通过正确的 ID 动态获取元素。例如：

```
echo '<div id="rated'.$row['id'].'"> 
```

进而：

```
document.getElementById("rated"+projId).innerHTML=xmlhttp.responseText; 
```

这将动态选择您想要的元素。

关于您的一般代码，我必须将您指向[http://jquery.com/](http://jquery.com/)的方向， 这将使元素选择更加简单，并且还将规范您对 ajax 的使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:38:46.787

将您的 php 更改为：

```
while($row = $result->fetch_assoc())
{
    echo '<li id="'.$row['id'].'">';
    echo '<h1 class="header">'.$row['projName']."</h1>";
    echo '<img src="'.$row['location'].'" alt=""/>';
    echo '<div class="rating">';
    echo '<a href="#" onclick="saveClick(5, '.$row['id'].')">'.★★★★★."</a>";
    echo '<a href="#" onclick="saveClick(4, '.$row['id'].')">'.★★★★."</a>";
    echo '<a href="#" onclick="saveClick(3, '.$row['id'].')">'.★★★."</a>";
    echo '<a href="#" onclick="saveClick(2, '.$row['id'].')">'.★★."</a>";
    echo '<a href="#" onclick="saveClick(1, '.$row['id'].')">'.★."</a>";
    echo '<div id="rated'.$row['id'].'">'.""."</div>";//updated this line
    echo "</div>";
    echo "</li>";
} 
```

你的javascript中的行是：

```
document.getElementById("rated"+projId).innerHTML=xmlhttp.responseText; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:41:01.770

使用计数器`$id`增加 li id

```
<?php

$select = "SELECT id, projName, location FROM Projects";

if($result = $mysqli->query($select))
{
$id = 0;
while($row = $result->fetch_assoc())
{
    echo '<li id="'.$id.'">';
    echo '<h1 class="header">'.$row['projName']."</h1>";
    echo '<img src="'.$row['location'].'" alt=""/>';
    echo '<div class="rating">';
    echo '<a href="#" onclick="saveClick(5, '.$row['id'].')">'.★★★★★."</a>";
    echo '<a href="#" onclick="saveClick(4, '.$row['id'].')">'.★★★★."</a>";
    echo '<a href="#" onclick="saveClick(3, '.$row['id'].')">'.★★★."</a>";
    echo '<a href="#" onclick="saveClick(2, '.$row['id'].')">'.★★."</a>";
    echo '<a href="#" onclick="saveClick(1, '.$row['id'].')">'.★."</a>";
    echo '<div id="rated">'.""."</div>";
    echo "</div>";
    echo "</li>";
    $id++;
}
}
?> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-30T21:32:21.453

首先，显然使用一个类。

```
echo '<div class="rated">'.""."</div>"; 
```

其次，在你的 JavaScript 中，而不是这一行

```
document.getElementById("rated").innerHTML=xmlhttp.responseText; 
```

用这个

```
var proj = document.getElementById(projId);
var rated = proj.getElementsByClassName('rated')[0];
rated.innerHTML=xmlhttp.responseText; 
```

我们在这里所做的是找到 id 匹配的元素`projId`。然后我们在前面找到的类`rated` **INSIDE**中找到元素。`projID`现在请注意，`getElementsByClassName`无论元素数量如何，它都会返回一个数组，但由于我们这里只有一个，所以我们只选择第一个索引处的项目`[0]`。

# dojo - Why are the colors correct but not the labels in the legend on Dojo StackedColumn

> ID：13147783
> 
> 赞同：0
> 
> 时间：2012-10-30T21:23:26.527
> 
> 标签：dojo, xpages

I have an issue with the Legend on a StackedColumn chart. I have set the following dataSeries and legend elements.

![enter image description here](../Images/4ad4fcfe40b04a0de1312f0e74321b84.png)

In the code, I have the following for loop to assign all the labels to the values so that they appear in the legend.

```
v = compositeData.dataSeries;
y = compositeData.legend;
for (i = 0; i < v.length; i++) {
    dataSeries = v[i];
    r += '  ynchart.addSeries("'+y[i]+'", ['+dataSeries+']);'+@NewLine();
} 
```

When I run the code, I end up with

![enter image description here](../Images/720aa1cc18f80585695ababd1a97a5a5.png)

showing the legend except the order of the labels is not in the order I expected. Element [3] is first, followed by [0], [1](https://i.stack.imgur.com/sShvX.png) and [2](https://i.stack.imgur.com/zXBco.png). The color of the elements in the legend are in the correct order but somehow the label is not. I have no code in the script anywhere else that sorts anything. Why is the order of the legend label reordering itself and how do I fix it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T17:01:28.790

When you specify a parameter in a custom control as "multi-instance" you hand over a java.util.List. The List doesn't guarantee you any delivery sequence and that seems what is happening here. So you are probably better of handing over ONE parameter which you then split(). Of course that leans itself to the potential issue that your label and values get out of sync. So you might want to hand over a complete JSON with all included as parameter. Something like:

```
{ "values" : { "worldwide" : [10,20,30],
               "NA" : [2,10,20],
               "Europe" : [4,5,4],
               "Japan" : [4,5,6]
             }
} 
```

You could consider a function that you hand the names of your fields that returns that string for you.

# html - 如何将内容定位在页眉和页脚上方

> ID：13147787
> 
> 赞同：1
> 
> 时间：2012-10-30T21:23:36.560
> 
> 标签：html, css, layout, positioning

我想要达到的定位： ![在此处输入图像描述](../Images/1d8a5ac620251fa9ce36096161a298c1.png)

现在我有以下内容： ![在此处输入图像描述](../Images/28f0520b88dc680b9b2ad8c1343a90c0.png)

属性如下：

```
.header, .footer {
    background: #666;
    height: 100px;
}

.content {
    background: #ccc;
    margin: -25px auto;
    min-height: 500px;
    width: 960px;
} 
```

所以内容位于页脚下方的问题，我不知道如何解决它。z-index 不起作用。

我的 HTML：

```
<div class="header"></div>
<div class="content"></div>
<div class="footer"></div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:25:19.913

试试这个

```
.header, .footer {
    background: #666;
    height: 100px;
    position: relative;
    z-index: 1;
}

.content {
    background: #ccc;
    margin: -25px auto;
    min-height: 500px;
    width: 960px;
    position: relative;
    z-index: 100;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:02:55.723

这个例子是类似的。

[3 <div> => 中间<div> 重叠上下<div>](https://stackoverflow.com/questions/7495058/3-div-middle-div-overlaps-upper-and-lower-div)

# php - 来自格式化变量的 jQuery 和 PHP 倒数计时器

> ID：13147788
> 
> 赞同：1
> 
> 时间：2012-10-30T21:23:42.800
> 
> 标签：php, jquery, variables, countdown, countdowntimer

我需要在 jquery 中构建一个倒数计时器，它从格式化为 XX Days XX:XX:XX 的 php 变量替换 span 标签中的 html。它应该在页面加载时加载变量，然后当 jquery 脚本加载时它开始倒计时但保持相同的格式（XX 天 XX：XX：XX）并最终显示“过期”并停止倒计时。

我有一个 jsFiddle 启动（[http://jsfiddle.net/2SDdh/1/](http://jsfiddle.net/2SDdh/1/)），但它显示格式化时间，然后加载 10 秒倒计时并最终显示“过期”。有人知道如何正确格式化吗？

我通过 PHP 输出的 HTML

```
<span class="exp">10 Days 10:10:10</span> 
```

我的 jQuery

```
$(function(){
  var count = 10;
  countdown = setInterval(function(){
    if (count > 0) {
      count--;
      $(".exp").html(count);
    } else {
      $(".exp").html('Expired');
    }
  }, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:27:04.987

与其滚动你自己的倒数计时器，为什么不使用[已经存在的倒数计时器呢？](http://krzysztof-furtak.pl/2010/05/kk-countdown-jquery-plugin/). KK倒计时对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T10:23:32.963

试试这个

html:

```
<span class="days">10</span> Days <br />
<span class="exp">23:59:59</span>​ 
```

javascript：

```
 $(function(){
    var days = 10;
    var count = 86399;
    var count2 = 0;
    var hour = 0;
    var min = 0;
    var sec = 0;

    countdown = setInterval(function() {
        if (days != 0 || count != 0) {
            if (count == 0) {
                days--;
                count = 86399;
            } else {
                count--;
            }
            count2 = count;
            hour = Math.floor(count2 / 3600);
            count2 = count2 % 3600;
            min = Math.floor(count2 / 60);
            count2 = count2 % 60;
            sec = count2;

            $(".exp").html(hour + ":" + min + ":" + sec);
            $(".days").html(days);
        } else {
            $(".exp").html('Expired');
        }
    }, 1000);
});​ 
```

干杯!

# c - 波浪号 C 无符号与有符号整数

> ID：13147790
> 
> 赞同：2
> 
> 时间：2012-10-30T21:23:54.217
> 
> 标签：c, operators, bit-manipulation, tilde

例如：

```
unsigned int i = ~0; 
```

**结果**：我可以分配的最大数量`i`

和

```
signed int y = ~0; 
```

**结果**：`-1`

为什么我会得到`-1`？我不应该得到我可以分配的最大数量`y`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T21:34:14.157

`4294967295`（又名`UINT_MAX`）和都`-1`具有相同的二进制表示`0xFFFFFFFF`或 32 位都设置为`1`. 这是因为有符号数是用[二进制补码表示的](http://en.wikipedia.org/wiki/Two%27s_complement)。负数的 MSB（最高有效位）设置为`1`，其值通过翻转其余位、加`1`并乘以 来确定`-1`。因此，如果您将 MSB 设置为`1`并且其余位也设置为`1`，则翻转它们（获得 32 个零），添加`1`(get `1`) 并乘以`-1`最终得到`-1`。

这使得 CPU 更容易进行数学运算，因为它不需要负数的特殊例外。例如，尝试添加`0xFFFFFFFF`(-1) 和`1`. 由于只有 32 位的空间，这将溢出，结果将`0`如预期的那样。

更多信息请访问：

[http://en.wikipedia.org/wiki/Two%27s_complement](http://en.wikipedia.org/wiki/Two%27s_complement)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T22:00:31.137

```
unsigned int i  = ~0; 
```

> 结果：我可以分配给 i 的最大数量

通常，但不一定。该表达式的`~0`计算结果为设置了`int`所有（非填充）位。C 标准允许有符号整数的三种表示形式，

*   二进制补码，在这种情况下`~0 = -1`并将其分配给`unsigned int`结果`(-1) + (UINT_MAX + 1) = UINT_MAX`。
*   一个的补码，在这种情况下`~0`是负零或陷阱表示；如果它是负零，则分配给 an`unsigned int`结果为 0。
*   符号和大小，在这种情况下`~0`是`INT_MIN == -INT_MAX`，并将其分配给`unsigned int`结果`(UINT_MAX + 1) - INT_MAX`，`1`在不太可能的情况下`unsigned int`具有宽度（无符号整数类型的值位数，值位数 + 1 [对于符号位] 对于有符号整数类型）小于 的，`int`并且`2^(WIDTH - 1) + 1`在常见情况下 的宽度与`unsigned int`的宽度相同`int`。

初始化

```
unsigned int i = ~0u; 
```

将始终导致`i`持有价值`UINT_MAX`。

```
signed int y = ~0; 
```

> 结果：-1

如上所述，只有当有符号整数的表示使用二进制补码时（这是迄今为止最常见的表示）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-30T21:26:57.417

`~0`只是一个`int`所有位都设置为 1。当解释为`unsigned`这将等效于`UINT_MAX`. 当解释为`signed`这将是`-1`.

假设 32 位整数：

```
 0 = 0x00000000 =  0 (signed) = 0 (unsigned)
~0 = 0xffffffff = -1 (signed) = UINT_MAX (unsigned) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-30T21:40:04.977

保罗的回答是绝对正确的。您可以使用以下命令，而不是使用 ~0：

```
#include <limits.h>

signed int y = INT_MAX;
unsigned int x = UINT_MAX; 
```

现在，如果您检查值：

```
printf("x = %u\ny = %d\n", UINT_MAX, INT_MAX); 
```

您可以在系统上看到最大值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T21:29:06.633

不，因为`~`是*按位 NOT*运算符，而不是*类型运算符的最大值*。`~0`对应于`int`所有位设置为 的`1`，将其解释为无符号为您提供无符号可表示的最大数，并解释为有符号的 int 为您提供 -1。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T21:29:49.740

你必须在一个[补码](http://en.wikipedia.org/wiki/Two%27s_complement)机器上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-28T23:59:29.273

查阅[http://en.wikipedia.org/wiki/Two%27s_complement](http://en.wikipedia.org/wiki/Two%27s_complement)，了解一些关于布尔代数和逻辑设计的知识。还学习如何以二进制计数和二进制加减法将进一步解释这一点。

C 语言使用这种形式的数字，因此要找到您需要使用的最大数字 0x7FFFFFFF。（您使用的每个字节使用 2 个 FF，最左边的字节是 7。）要理解这一点，您需要查找十六进制数字及其工作方式。

现在解释无符号等价物。在有符号数中，数字的下半部分为负数（假设 0 为正数，因此负数实际上比正数高 1）。无符号数都是正数。所以理论上你的 32 位 int 的最高数字是 2^32，除了 0 仍然算作正数，所以它实际上是 2^32-1，现在对于有符号数，这些数字的一半是负数。这意味着我们将前一个数字 2^32 除以 2，因为 32 是一个指数，我们在每一边得到 2^31 个数字 0 为正数意味着有符号 32 位 int 的范围是 (-2^31, 2^31- 1）。

现在只比较范围： unsigned 32 bit int: (0, 2^32-1) signed 32 bit int: (-2^31, 2^32-1) unsigned 16 bit int: (0, 2^16-1)带符号的 16 位整数：(-2^15, 2^15-1)

you should be able to see the pattern here. to explain the ~0 thing takes a bit more, this has to do with subtraction in binary. it's just adding 1 and flipping all the bits then adding the two numbers together. C does this for you behind the scenes and so do many processors (including the x86 and x64 lines of processors.) Because of this it's best to store negative numbers as though they are counting down, and in two's complement the added 1 is also hidden. Because 0 is assumed positive thus negative numbers can't have a value for 0, so they automatically have -1 (positive 1 after the bit flip) added to them. when decoding negative numbers we have to account for this.

# java - 是否可以对 sql 语句进行软编码？

> ID：13147791
> 
> 赞同：-1
> 
> 时间：2012-10-30T21:24:16.747
> 
> 标签：java, mysql, sql, hibernate

有人告诉我，可以对 SQL 查询进行软编码，而不是对它们进行硬编码。就像我们在 Java 中解析 JSON 响应一样，我们可以通过如下外部文件来实现：

```
abc:[
{
sql:"selecct count(*) from some_database",
count:"100"
}] 
```

可能吗？我怎么能这样做？链接或文章将不胜感激。我正在使用**休眠**。如何在 Hibernate 中通过外部文件运行 SQL 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:31:04.310

如果您使用的是 Java，请尝试使用[MyBatis](http://www.mybatis.org)。

SQL 语句放置在资源 XML 文件中，代码按名称引用查询。这允许您在架构细节发生变化时编辑 XML，可能无需修改使用它们的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:27:44.947

是的。

例如在资源包中：

```
ResourceBundle bundle = ResourceBundle.getBundle();
PreparedStatement psmt = connection.prepareStatement(bundle.getString("users.query"));
.... 
```

或任何其他字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:28:53.710

将 SQL 语句存储在变量中，或者如果您想将变量动态添加到 SQL 语句本身，则从函数中返回它们。

无论您通常将 SQL 查询作为字符串放在哪里，只需将变量或函数调用放在哪里。

# .net - .NET 的 NewRelic 需要在注册表中将 COR_ENABLE_PROFILING 设置为 1

> ID：13147795
> 
> 赞同：6
> 
> 时间：2012-10-30T21:24:39.947
> 
> 标签：.net, iis, registry, newrelic

我刚刚在我们的测试服务器上安装了 NewRelic .NET 代理。我收到一条错误消息，提示安装程序**无法访问注册表**，**并且需要将 COR_ENABLE_PROFILING 设置为 1**，然后代理才能工作。

如何将 COR_ENABLE_PROFILING 设置为 1？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T21:28:26.830

创建一个系统环境变量 COR_ENABLE_PROFILING 并将值设置为 1 并重新启动服务器以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T15:32:46.047

希望这个问题得到解决，但以防万一：最近对 New Relic 的 .NET 代理的一些更改改进了此设置的工作方式，因此安装最新版本通常也可以解决此问题（也可以重新运行安装程序）。[如果您仍然遇到问题，我强烈建议您在https://support.newrelic.com/](https://support.newrelic.com/)上开票

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T22:30:53.970

新版本的新 Relic 创建了一个系统变量，但在我的情况下这不起作用，所以我创建了一个具有相同值的新“用户环境变量”。

要创建环境变量，您必须转到我的电脑> 高级系统设置

在系统属性窗口中选择高级选项卡，然后单击环境变量...

在“环境变量”窗口中，您会注意到用户名和系统变量的两列用户变量。

可能您已经有了 System 变量，但是您需要使用相同的参数 COR_ENABLE_PROFILING 创建一个新的 User 变量并将值设置为 1。

我希望这对你有用。我很抱歉我的英语不好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-12T23:26:07.790

.NET 的 New Relic 代理的最新版本在注册表中放置了必要的环境变量。仅当您计划监视非 IIS 应用程序时才需要系统环境变量（从系统属性 -> 高级 -> 环境变量访问的那些）。它们是在您安装 .NET 代理并启用“仪器所有 .NET 应用程序”选项时创建的。

这听起来像是与向注册表添加值相关的权限问题的原始问题。

# html - 用于连续语音识别的 HTML5 语音输入 API

> ID：13147798
> 
> 赞同：3
> 
> 时间：2012-10-30T21:24:49.757
> 
> 标签：html, speech-recognition, html5-audio

我知道“x-webkit-speech”能够进行某种语音识别，实际上识别非常好。

我发现“x-webkit-speech”非常适合开发问答应用程序，您只需提出问题，系统就会识别问题并回答您。

但是，我正在寻找的是一种在浏览器中执行连续语音识别的方法。例如，如果我正在在线听讲座，我想实时转录教授正在谈论的内容。

“x-webkit-speech”可以吗？我的感觉是“x-webkit-speech”在检测到短暂的静默期时会自动停止，这很烦人。我知道它实际上将音频转换为 flac 并将其发送回谷歌服务器。是否可以发回更长的音频？我需要在网络上进行持续的语音识别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T19:45:00.160

Chrome 刚刚在 25 版中发布了这个。请参阅：[http ://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to-the-Web-Speech-API](http://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to-the-Web-Speech-API)

# csv - Drupal - 导入用户和网络表单数据

> ID：13147799
> 
> 赞同：0
> 
> 时间：2012-10-30T21:25:17.047
> 
> 标签：csv, import, drupal-6, drupal-webform

我们有一个新的 Drupal 6 站点。该网站的大部分内容是使用用户将填写的 webform 模块构建的自定义注册表单。它不是网站注册表，而是人们将要参加的活动的注册表。所以情况是我们有用户（不是 Drupal 用户）和我们想要导入的过去事件的数据。

基本上，如果用户过去已经参加过此活动，我们希望将他们作为新用户导入 Drupal，因为这是我们使用 Drupal 进行注册过程的第一年。我们将在 CSV 文件中包含来自过去事件的用户信息和数据。

所以，我知道你可以批量导入用户，我知道你可以批量导入网络表单数据，但是你能同时做这两个吗？我尝试使用 webform 导入模块，但它只是导入 webform 数据，但不能将其与特定用户相关联，至少就我所见而言。您可以提供 SID，但不能提供 UID。有人告诉我这可能是一项艰巨的任务，但我想我会问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:02:27.407

我通常使用一个简单的 PHP 脚本来引导 Drupal 并使用 API 直接导入我的数据。使用 API 通常需要的只是 Drupal 的 index.php 的前几行。我会先将用户导入用户表。然后获取生成的 UID 并使用它将匹配的 webform 数据插入到 webforms 提交表中。

# jquery - 使用 Jquery 滑块更改 JSON 属性值

> ID：13147805
> 
> 赞同：0
> 
> 时间：2012-10-30T21:26:00.850
> 
> 标签：jquery, d3.js

您好，我将在其中操作一些 JSON 属性，以使用 ui 框架中的一些 jquery 滑块加载其他一些 JSON 数据，我想知道如何访问 JSON 数组中的属性并操作它们的值。

```
d3.json("basbeball.json", function(json) {
  //properties here??
  "year": '2002', //slider will modify this year
  data = json;
  counties.selectAll("path")
 .attr("class", quantize);

  //start of slider for map
  $( "#slider" ).slider({
        range: "min",
        value: 0,
        min: 1910,
        max: 2012,
        slide: function( event, ui ) {

            $( "#sliderVal" ).val(ui.value );                
        }
    });
    $( "#sliderVal" ).val($( "#slider" ).slider( "value" ) );
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:04:21.510

因为您已经声明`data=json`并且它似乎是一个全局变量，您可以`data`从代码中的任何位置读取或修改该对象

```
slide: function( event, ui ) {
      var val=ui.value ;
     $( "#sliderVal" ).val( val );  
     data.year=val;              
} 
```

这假设它`year`是 json 对象的键并且没有嵌套在数组或其他对象中

# jquery - jQuery 可拖动可排序，更改拖放元素上的 html

> ID：13147809
> 
> 赞同：1
> 
> 时间：2012-10-30T21:26:29.117
> 
> 标签：jquery, jquery-ui, drag-and-drop, draggable, jquery-ui-sortable

我正在设计一个表单构建界面。所有可用字段将位于界面左侧的无序列表中，右侧有一个大的空无序列表，它将成为我的网络表单。使该界面工作的“技巧”是通过将 html 附加到可放置的 ui 元素中，将左侧的列表项转换为有效的 html 元素，然后再将它们附加到右侧的可排序列表中。

我让它工作......主要......使用draggable（）和sortable（）。目前，我使用 sortable 的接收事件从可拖动元素中获取 id，我将其放入 data() 块中以传递给更新事件。从那里，我使用 id 元素进行 ajax 调用，确定它是什么类型的字段以及应该从后端添加哪些选项，构建元素，然后使用 将其放入接口中`ui.item.html`，这是由更新功能。

我的方法的问题是它在拖动元素时也会触发，这会导致选择元素在无意中附加到可排序列表时在屏幕上乱扔垃圾。显然，接收事件是仅在排序从连接列表中获取项目时触发的事件。但是，如果我尝试对`ui.item`元素进行内部 html，它会更改源列表，而不是所需的目标。当项目已经在右侧的网络表单列表中时，如果它们只是被排序，我绝对不想修改它们。

有什么方法可以访问和更改连接`sortable()`列表接收事件中的目标 html？还有其他策略可以解决我的挑战吗？

编码：

```
<div class="grid_3 mainwindow formfields">

    <h3>Available Fields</h3>
    <div id="accordion">
         <ul>
            <li>First Name</li>
            <li>Last Name</li>  
            <li>Company</li>            
         </ul>
    </div>

    </div>
    </div> 

    <div class="grid_12 formcontainer formfields">
    <h3>Webform</h3>
    <form id="form" action="http://responses.smarttracks.com" method="post">
         <input type="hidden" name="webform_id" id="webform_id" value="<?php echo $webform_id ?>"></input>

         <ul id="webform_list"></ul>
    </form>
    </div> 
```

和 jQuery

```
/*****  Make webform fields draggable   *****/
    $( ".master_list li" ).draggable({
        connectToSortable: "#webform_list",
        helper: "clone",
        revert: "invalid"
    });

/*****  Make form elements sortable *****/
    $( "#webform_list" ).sortable({
        revert: true,
        cursor: 'pointer',
        placeholder: "placeholderdiv",
        receive: function(event, ui) {
            $(this).data('id', ui.item[0].id);
            var element = event.target

        },

        update: function(event, ui) {
            var fieldname = ui.item.text();
            if ($(this).data('id')) {

                $.ajax({
                    url: "/webform/getFieldAttributes",                 
                    timeout: 30000,
                    type: "POST",
                    data: 'id='+$(this).data('id'),
                    dataType: 'json',
                    error: function(XMLHttpRequest, textStatus, errorThrown)  {
                         alert("An error has occurred making the request: " + errorThrown)
                    },
                    success: function(data){
                        switch (data.control_type) {
                            case 'text':
                                var inputfield = $('<input type="text">').attr('id', 'fieldname');

                                var field = (ui.item).text();

                                switch (field) {
                                    case 'Email Address':
                                        inputfield.addClass('validate[optional,custom[email]]');
                                        break;
                                    default:
                                        inputfield.addClass('validate[required]');
                                        break;
                                }

                                break;
                            case 'textarea': 
                                var inputfield = $('<textarea>');
                                break;
                            case 'Dropdown Menu (Single Select)':
                                var inputfield = $('<select>');

                                $.each(data.field_options, function(name, value) {
                                    inputfield.append($("<option></option>").attr("value",name).text(value)) 
                                });

                                inputfield.addClass('validate[required]');
                                break;
                            case 'Radio Buttons (Single Select)':

                                var inputfield = $('<div class="webform_radiogroup">');

                                $.each(data.field_options, function(name, value) {
                                    var container = $('<div class="webform_radio_option">');
                                    var radio = $('<input type="radio">').attr({    name: name,value: value,id: name });
                                    radio.appendTo(container);
                                    $('<label for="'+name+'">'+name+'</label>').appendTo(container);
                                    $('<div class="clear">').appendTo(container);

                                    container.appendTo(inputfield);
                                });
                                break;
                        }

                        if (data.control_type == 'Radio Buttons (Single Select)') {
                            ui.item.html('<div class="webform_radiogroup_label">'+fieldname+'</div>').append(inputfield).append('<div class="clear">').wrapInner('<div class="webform_questiongroup">').wrapInner('<div class="hoverdiv" />');
                        } else {
                            ui.item.html('').append('<label for="'+fieldname+'">'+fieldname+'</label>').append(inputfield).wrapInner('<div class="hoverdiv" />');
                        }

                    }
                });
            }
        }   
    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T06:07:21.743

而是像这样使用 droppable

```
 $( ".master_list li" ).draggable({
      connectToSortable: "#webform_list",
      helper: "clone",
      revert: "invalid"
   });
    $( "#webform_list" ).droppable({
        drop: function( event, ui ) {
           // your ajax code
        }
    }).sortable({
       handle : 'p',
       cursor : 'crosshair'
   }); 
```

我没有发布完整的代码，只是给了你大致的工作思路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:57:29.127

您根本不需要使用接收方法。您可以使用 update 方法访问对象`$(ui.item)`

只需将您的代码更改为：

```
 placeholder: "placeholderdiv",
    // removed receive method

    update: function(event, ui) {

        var draggingElement = $(ui.item);
        var fieldname = draggingElement.text();
        var fieldId = draggingElement.attr('id'); // or whatever you require.

        if (fieldId) {
           // etc... 
```

至于您的事件触发两次的问题，我试图复制这是[JsFiddle](http://jsfiddle.net/bPPQE/)但我无法将您的代码添加到小提琴中吗？

谢谢。

# ruby - Ruby 在哈希数组中查找某些内容

> ID：13147810
> 
> 赞同：0
> 
> 时间：2012-10-30T21:26:39.737
> 
> 标签：ruby, arrays, hash, find

我正在尝试学习 Ruby，我有以下代码

```
 a[0]={ :artist => 'Green Day',
                          :name => 'Song1',
                                                   :bitrate => 192 }
 a[1]={ :artist => 'U2', :name => 'Song2' }
 a[2]={:artist => 'Metallica', :name => 'Battery' } 
```

我的问题是，例如，我如何在这样的数组中找到 Metallica 的所有歌曲？谢谢！:)

编辑：好的，另一个新手问题？如何找到标题中包含特定序列的歌曲？

我试过：

```
a.find { |x| x[:song].include? 'Song' } 
```

但它返回一个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T21:30:05.380

你可以使用`select`方法

```
a.select {|c| c[:artist] == 'U2'} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:31:57.883

```
a.select { |song| song[:artist] == 'Metallica' } 
```

对于你的第二个问题

```
a.select { |song| song[:name].include? 'Song' } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T21:29:34.983

```
Employee.where("artist = ?", "Metallica") 
```

返回一个类似于数组的可链接范围对象。

# javascript - Uploadify 的多个实例启动缓慢

> ID：13147815
> 
> 赞同：1
> 
> 时间：2012-10-30T21:27:22.263
> 
> 标签：javascript, uploadify

我的网站上有一个上传页面，用户需要上传大量记录（100+）的文件，并且正在使用 Uploadify v3 来初始化每条记录的上传按钮，使用这个：

```
$(".uploadPDF").each(function(){                            
    var eid = $(this).attr('data-eid');
    $(this).uploadify({
        'swf' : '/assets/js/uploadify/uploadify.swf',
        'uploader' : '/fileops/upload_file',
        'buttonText' : 'Select file',
        'auto' : true,
        'formData' : {
            'eid':eid
                },
        'onUploadSuccess' : function(file, data, response) {
        }   
    });
}); //end each 
```

然而，这个函数每 100 个条目需要大约 20 秒来初始化。使用 Firebug，似乎最大的罪魁祸首是对 uploadify.swf 的调用。

有没有办法解决这个问题并加快速度？还是我不应该一次初始化那么多实例？如果是这样，有什么办法可以解决这个问题？

谢谢！

# javascript - 使用 Backbonejs 从对象中获取值

> ID：13147821
> 
> 赞同：0
> 
> 时间：2012-10-30T21:27:49.740
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我想`http://demo82.com/lois/api/get_page/?id=6`使用 Backbone js 从这个 API 中获取价值。我试过了，但我不知道如何从主干中的对象获取值。

这是我的主干代码

```
Page = Backbone.Model.extend({
initialize: function() {
        this.on('all', function() { console.log(this.get('page')); });
    },
    url: "http://demo82.com/lois/api/get_page/?id=6",
    defaults: {
        "id":null,
        "title":"",
        "content":""
    }
});

 var page = new Page();
 console.log(page.fetch({})); 
```

我是新手并尝试学习backbonejs请解释什么是更好的方法？请给我ans using `jsfiddle.net`. 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:35:09.477

它看起来像一个上下文问题（`this`不引用`on`回调中的模型）。您可以通过指定上下文来解决此问题：

```
this.on('all', 
    function() { console.log(this.get('pagel')); },
    this
); 
```

**编辑**

还有一个跨域问题。您需要通过覆盖*sync*和*parse*来使用 JSONP 请求。（[我从这个例子中改编了以下代码。](https://gist.github.com/1245613)）

```
var Page= Backbone.Model.extend({

// override backbone synch to force a jsonp call
sync: function(method, model, options) {
    // Default JSON-request options.
    var params = _.extend({
      type:         'GET',
      dataType:     'jsonp',
      url:            model.url(),
      processData:  false
    }, options);

    // Make the request.
    return $.ajax(params);
},

parse: function(response) {
    // parse can be invoked for fetch and save, in case of save it can be undefined so check before using 
    if (response) {
        console.log(JSON.stringify(response));
        // here you write code to parse the model data returned and return it as a js object 
        // of attributeName: attributeValue
        return { status: response.status };    // just an example
    }
}, 
```

[这是一个 JSFiddle 演示。](http://jsfiddle.net/Tpe4s/12/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:31:05.770

永远`id`是6？在您的代码中，您的模型总是得到第 6 件事。如果您想要一个带有 get 参数的自定义 url，请将其覆盖`url`为函数：

```
 url: function() {
      id = this.get("id");
      return "loispage/api/get_page/?id=" + id
 } 
```

更好的是，如果您可以控制服务器端并且可以对页面实体做一些更多的 RESTful 操作——只需设置 urlRoot

```
 urlRoot: "loispage/api/page/" 
```

并且 fetch 将自动执行 HTTP get from

```
 "http://.../loispage/api/page/<id> 
```

# linux - 安装 php-devel centos

> ID：13147824
> 
> 赞同：2
> 
> 时间：2012-10-30T21:27:57.663
> 
> 标签：linux

我尝试在我的服务器上安装 php-devel 并收到此错误

```
# yum install php-devel
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
* base: centos.mirror.transip.nl
* extras: centos.mirror.transip.nl
* updates: centos.mirror.transip.nl
Excluding Packages in global exclude list
Finished
Setting up Install Process
No package php-devel available.
Nothing to do 
```

问题是什么？

这是我的版本

```
GNU bash, version 3.2.25(1)-release (x86_64-redhat-linux-gnu)
Copyright (C) 2005 Free Software Foundation, Inc.

PHP 5.3.16 (cli) (built: Sep 16 2012 06:57:51)
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-17T13:12:22.657

我面临同样的问题

通过这些命令添加 repo "remi"

```
wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm
sudo rpm -Uvh remi-release-6*.rpm epel-release-6*.rpm 
```

并通过以下方式启用 remi repo

```
sudo vim /etc/yum.repos.d/remi.repo 
```

通过设置启用=1

现在试试

```
yum install php-devel 
```

# ios - 弹出到根视图时恢复倒计时

> ID：13147830
> 
> 赞同：3
> 
> 时间：2012-10-30T21:28:21.807
> 
> 标签：ios, xcode, nstimer

我是 iPhone 开发的新手，正在使用导航控制器和情节提要制作一个倒计时项目。我的应用程序有两个视图。第一个视图只有一个按钮。单击此按钮时，它将转到第二个视图。第二个视图有倒计时对象。我的问题是，当倒计时在第二个视图中运行时，如果我返回第一个视图然后点击按钮转到第二个视图，则倒计时不再运行。

这是代码：

**视图1.h**

```
#import <UIKit/UIKit.h>
#import "view2.h"

@interface view1: UIViewController

-(IBAction)nextpage:(id)sender;

@end 
```

**view1.m**

```
@implementation view1

-(IBAction)nextpage:(id)sender
{
    view2 *next=[self.storyboard instantiateViewControllerWithIdentifier:@"secondview"];
    [self.navigationController pushViewController:next animated:YES];
}

@end 
```

**视图2.h**

```
@interface view2 : UIViewController
{
    IBOutlet UILabel *lbl;
    IBOutlet UITextField *field;

    NSTimer *theTimer;
    NSDate *targetDate;
    NSCalendar *cal;
    NSDateComponents *components;
}

@property (nonatomic,retain) IBOutlet UILabel *lbl;
@property (nonatomic,retain) IBOutlet UITextField *field;
-(IBAction)back_first_view;
@end 
```

**view2.m**

```
@implementation view2
@synthesize lbl,field;

- (void)viewDidLoad
{
    cal = [[NSCalendar currentCalendar] retain];
    components = [[NSDateComponents alloc] init];
}

- (IBAction)buttonPressed:(id)sender {

    if (theTimer != nil) {
        return;
    }

    NSString *input = field.text;
    NSArray *timeSplit = [input componentsSeparatedByString:@":"];
    NSUInteger hours =  [[timeSplit objectAtIndex:0] intValue];
    NSUInteger minutes =  [[timeSplit objectAtIndex:1] intValue];
    NSDate *now = [NSDate date];
    NSDateComponents *dateComponents = [cal components:NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit fromDate:now];
    [dateComponents setHour:hours];
    [dateComponents setMinute:minutes];

    if (!targetDate) {
        targetDate = [[cal dateFromComponents:dateComponents] retain];
    }
    else {
        targetDate = nil;
        targetDate = [[cal dateFromComponents:dateComponents] retain];
    }

    if ([targetDate timeIntervalSinceNow] > 0) {
        theTimer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(tick) userInfo:nil repeats:YES];
        [self hideKeyboard];
    }
    else {
        targetDate = nil;
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Cannot countdown because time is before now" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
}

- (void)tick {
    if ([targetDate timeIntervalSinceNow] <= 0) {
        //Checks if the countdown completed

        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Countdown Completed" message:@"YAY! The countdown has complete" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        [alert release];

        return;
    }
    components = [cal components:(NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit) fromDate:[NSDate date] toDate:targetDate options:0];

    NSInteger hours = [components hour];
    NSInteger minutes = [components minute];
    NSInteger seconds = [components second];

    NSString *output = [NSString stringWithFormat:@"%i Hours\n%i Minutes\n%i Seconds\n", hours, minutes, seconds];
    lbl.text = output;
}

- (void)hideKeyboard {
    if ([field isFirstResponder]) [field resignFirstResponder];
}

- (IBAction)back_first_view
{
    [self.navigationController popToRootViewControllerAnimated:YES];
}
 @end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:40:38.600

因为您使用的是`UINavigationController`，所以当您从 导航回 时`View2`，`View1`实例`View2`（以及在其上运行的计时器）被销毁。当您`View2`第二次导航到时，它是一个全新的实例。

为此，您必须以某种方式使计时器保持活动状态。您可以修改您的应用程序委托来管理计时器，并`View2`从委托中获取其计时器信息（例如）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:44:26.127

将此方法更改为，

```
- (IBAction)nextpage:(id)sender
{
    [self.navigationController pushViewController:self.next animated:YES];
} 
```

并将第一行添加到您的 viewDidLoad 或任何此类方法中，

```
- (void)viewDidLoad {
       [super viewDidLoad]; //Always keep super call as first call in a method
       self.next = [self.storyboard instantiateViewControllerWithIdentifier:@"secondview"];
    // Do any additional setup after loading the view.
} 
```

并在 .h 文件中声明下一个 @interface 为，

```
@interface view1 : UIViewController
{

}
@property (nonatomic, strong) view2 *next; 
```

每次进入下一页时，您都在创建一个新`view2`的 ，您需要对其进行更改。

# javascript - Javascript：防止元素中的内部元素“滚动”

> ID：13147833
> 
> 赞同：0
> 
> 时间：2012-10-30T21:28:24.343
> 
> 标签：javascript, jquery

我有一个脚本，其 div 的宽度大于其父级，父级设置为`overflow: hidden;`. 我有 javascript 设置`left`大 div 的位置以创建“页面”。您可以单击链接在页面之间移动。

所有这些都很好，但问题是如果您从一个“页面”元素切换到另一个，它会完全打乱所有左侧定位以在页面之间移动。

您可以在我设置的小提琴中重新创建此错误，方法是将您的焦点设置为第一页上的输入框之一，然后使用制表符直到它带您进入第二页。

**我在[这里设置了一个演示](http://jsfiddle.net/E7u9X/)。**

重要的代码如下：

HTML：

```
<div class="form">
    <div class="pagesContainer">
        <div class="page" class="active">
            <h2>Page One</h2>
            [... Page 1 Content here...]
        </div>

        <div class="page">
            <h2>Page Two</h2>
            [... Page  Content here...]
        </div>
</div> 
```

CSS：

```
.form {
    width: 400px;
    position: relative;
    overflow: hidden;
    border: 1px solid #000;
    float: left;
}

    .pagesContainer {
        position: relative; /*Width set to 10,000 px in js
    }

    .form .page {
        width: 400px;
        float: left;
    } 
```

JS：

```
slidePage: function(page, direction, currentPage) {
    if (direction == 'next') {
        var animationDirection = '-=';
        if (page.index() >= this.numPages) {
            return false;
        }
    }
    else if (direction == 'previous') {
        var animationDirection = '+=';
        if (page.index() < 0) {
            return false;
        }
    }

    //Get page height
    var height = page.height();
    this.heightElement.animate({
        height: height
    }, 600);

    //Clear active page
    this.page.removeClass('active');
    this.page.eq(page.index()).addClass('active');

    //Locate the exact page to skip to
    var slideWidth = page.outerWidth(true) * this.difference(this.currentPage.index(), page.index());

    this.container.animate({
        left: animationDirection + slideWidth
    }, 600);

    this.currentPage = page;
} 
```

主要问题是，当您从第一页上的输入框到第二页上的某个内容时，无论发生什么，它都会带您到那里，但 css 仍然认为您在`left: 0px;`. 我一直在寻找解决方案，但到目前为止，谷歌向我透露的所有内容都是如何停止滚动条滚动。

任何帮助或建议将不胜感激，谢谢！

PS html 是这样设置的，因此如果禁用了 javascript，它仍然会全部显示在一个页面上并且仍然可以正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T14:51:20.600

我用以下形式更新了您的小提琴，修复了第一个选项卡：http: [//jsfiddle.net/E7u9X/1/](http://jsfiddle.net/E7u9X/1/) 。基本上，您可以做的是在最后一个变得模糊之后专注于选项卡中的第一个“可选项卡”元素，如下所示：

```
$('.form input').last().blur(function(){
    $('.form input').first().focus();
}); 
```

（这只是一个例子，第一个活动元素可以是任何其他元素）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T15:00:15.010

Elements with overflow: hidden still have scrolling, just no scroll bars. This can be useful at times and annoying at others. This is why your position left is at zero, but your view of the element has changed. Set scrollLeft to zero when you change "pages", should do the trick.

# php - 以编程方式删除大量 Magento 优惠券（购物车价格规则）

> ID：13147835
> 
> 赞同：5
> 
> 时间：2012-10-30T21:28:32.587
> 
> 标签：php, magento-1.7, magento, coupon

在询问编写代码以让 Magento 为新的电子邮件订阅者生成随机优惠券代码之前，我一直在这里 -[创建单个随机 Magento 优惠券](https://stackoverflow.com/questions/12806919/creating-a-single-random-magento-coupon)

这段代码运行良好，对那些帮助过我的人我永远感激不尽。我现在正在寻找一种方法来删除这些优惠券，因为它们以批量方式过期，因为通过 Magento 管理员单独删除它们是一个巨大的痛苦。从下图可以看出，在几天的时间里，我们生成了 300 多张优惠券（现在都已过期）。

![在此处输入图像描述](../Images/8b48225a3b608a65386bf931753ce567.png)

修改上面链接（来自我的原始问题）中详述的创建优惠券代码会起作用吗？就像是：

```
$model = Mage::getModel('salesrule/rule')
       $model->getName('New newsletter subscriber discount');
       $model->getToDate(date('Y-m-d'));
$model->delete(); 
```

还是我在这里完全吠错了树？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T22:44:30.433

很抱歉回答我自己的问题，但几乎在我发布后，我就能弄清楚。因此，如果其他人有像我这样的问题：

```
ini_set('auto_detect_line_endings', true);

// Requires Mage
require_once('../../app/Mage.php');

//Initializes Mage
Mage::app('default');
deleteCoupon();

function deleteCoupon() {
  $collection = Mage::getModel('salesrule/rule')->getCollection()->load();

  foreach($collection as $model) {

    // Delete all new newsletter sub coupons
    if ($model->getName() == 'New newsletter subscriber discount') {

    // Delete all coupons expiring today    
    if ($model->getToDate() == date('Y-m-d')) { 
      $model->delete();
      echo "Deleted <br />";
    } else {
      echo "No coupons found! <br />"; 
    }
  }
} 
```

# python - 在 Python 应用程序中导入子子包

> ID：13147838
> 
> 赞同：1
> 
> 时间：2012-10-30T21:28:58.540
> 
> 标签：python, python-module, python-import

我正在编写一个模块化应用程序，它将在运行时根据启动参数等动态导入模块。为了使事情井井有条，我有以下目录结构：

```
 myapp/
    ├── __init__.py
    ├── main.py
    ├── utils.py
    ├──modules/
        ├── __init__.py
        ├── iptables/
        │   ├── __init__.py
        │   ├── iptables.py
        │   ├── [other files/directories/configuration...]
        │   └── tests
        │       ├── iptables_tests.py
        ├── layer4/
        │   ├── __init__.py
        │   ├── layer4.py
        │   ├── [other files/directories/configuration...]
        │   └── tests
        │       ├── layer4_tests.py 
```

我正在尝试完成以下任务：

*   `main.py`应该可以做一些类似的事情`from modules.layer4 import Layer4Manager`，`Layer4Manager`里面有一个类`modules/layer4/layer4.py`。如果可能的话，我想在不包含实际代码的情况下执行此操作`__init__.py`，因为同一目录中还会有其他脚本/文件，因此将它们组合在目录中是有意义的（这也是脚本不包含的原因t 只是在`modules`目录中）。

*   `iptables.py`并且`layer4.py`应该能够从`utils.py`.

*   使用 Python unittest 框架和 Nose 的测试应该能够正确运行，例如，`iptables_tests.py`应该能够运行`from myapp.modules.iptables import IPTablesController`和`from myapp.utils import UtilityFunction`.

我已经为此奋斗了几个小时，但我无法让上述所有三个项目同时工作。使用`from layer4 import *`or`__all__`里面的变量`modules/layer4/__init__.py`会破坏测试，因为它们无法`from myapp.utils import UtilityFunction`.

消隐`modules/*/__init__.py`使我无法做到`from myapp.modules.layer4 import Layer4Manager`。

我尝试了其他几种组合，我认为我只是让事情变得更糟。我的目标是 Python 2.6。我猜某种相对导入会使事情变得更容易，但我不确定它们如何与我在这里使用的两级目录结构一起工作。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:36:52.750

您不需要`main/__init__.py`，因为您不想制作`myapp`包，并且当您执行 main.py 时，myapp 将自动添加到 python 路径中。

除了看起来不错之外，如果您放置正确的路径，您应该能够直接从子包中导入模块，例如

```
import utils
from modules.layer4 import layer4 
```

我创建了一个类似的结构，它运行良好，例如

```
$ cat myapp/main.py 
import utils
from modules.layer4 import layer4
from modules.iptables import iptables

$ cat myapp/modules/iptables/iptables.py
from modules.layer4 import layer4

$ cat myapp/modules/layer4/layer4.py
import utils 
```

所有这一切都没有错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:40:34.367

“from modules.layer4.layer4 import Layer4Manager”应该适用于您的第一次导入 - 它不是，还是不够？

您的 utils.py 是否也从它下面的任何模块导入？如果是这样，您可能正在创建循环导入（只是一个猜测，但这可能是为什么您不能同时让所有导入工作......）。如果是这样，您可能需要将导入移动到代码块中，它们不会在导入 utils.py 时执行。这可以解释为什么在 __init__.py 中进行导入时测试会中断。

否则，如果你想让“from modules.layer4 import Layer4Manager”工作，你真的需要以某种方式将它带入 __init__.py - 可能通过在那里导入。

# php - C 到 PHP 密码加密（反向）

> ID：13147843
> 
> 赞同：1
> 
> 时间：2012-10-30T21:29:19.730
> 
> 标签：php, c, encode

我有一个 Windows 应用程序，它使用此 C 代码的反向加密用户密码（以下解码）：

```
static void PasswordDecode(char * szPassword)
{
char szEncode[1024];
char strDecodePass[_MAX_BUF_LEN + 1]={""}, strPass[_MAX_BUF_LEN + 1]={""};
strcpy(strDecodePass, szPassword);
for(unsigned int i = 0; i < strlen(strDecodePass)/3; i ++)
{
char szCode[_MAX_BUF_LEN + 1];
strcpy(szCode, strDecodePass + i * 3);
szCode[3] = 0;
int nCode = atoi(szCode);
nCode = 999 - nCode;
sprintf(szEncode, "%c", nCode);
strcat(strPass, szEncode);
}

strcpy(szPassword, strPass);

return;
}; 
```

我正在寻找的是使用此算法（但使用 PHP）对密码进行编码的能力，以便我可以将用户帐户导入应用程序。

任何人都可以帮忙吗？

蒂亚吉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:45:24.123

简单的：

```
function PasswordEncode($str)
{
    $enc = "";
    for ($i = 0; $i < strlen($str); $i++) {
        $enc .= sprintf("%03d", 999 - ord(substr($str, $i)));
    }
    return $enc;
} 
```

而且，只是为了踢球：

```
function PasswordDecode($str)
{
    $dec = "";
    for ($i = 0; $i < strlen($str); $i += 3) {
        $dec .= chr(999 - substr($str, $i, 3));
    }
    return $dec;
} 
```

顺便说一句，称这种“加密”是一种夸张的说法。这是完全不安全的，仅通过查看编码密码可能需要大约五分钟才能弄清楚。

# xml - msbuild 服务启动/停止

> ID：13147847
> 
> 赞同：1
> 
> 时间：2012-10-30T21:29:31.897
> 
> 标签：xml, service, msbuild, batch-file

我有一个相当大的 msbuild xml 脚本。我对 xml 不是很流利，有没有办法在脚本中启动或停止 Windows 服务而不将代码放入批处理文件中？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:31:23.367

您可以使用以下命令启动/停止服务

```
net start "servicename" 
```

或者

```
net stop "servicename" 
```

或在 MSBuild 中：

```
<Exec Command="net start %(Service.Name)" /> 
```

# ios - iOS 5和iOS 6中UITabbar的区别

> ID：13147849
> 
> 赞同：1
> 
> 时间：2012-10-30T21:29:37.547
> 
> 标签：ios, objective-c, uitabbar

我`UITabBar`（再次）被难住了。

我有一个`UITabbar`我正在使用背景图像的，在它的正上方我有另一个`UIImage`. 在 iOS 5（设备和模拟器）中一切看起来都很好，但在 iOS 6 上，标签栏顶部有一条锐线。

在 iOS 5 上 [http://i.imgur.com/Fe0k1.png](http://i.imgur.com/Fe0k1.png)

在 iOS 6 上 [http://i.imgur.com/EepoC.png](http://i.imgur.com/EepoC.png)

我将背景图像设置如下：

```
[[UITabBar appearance] setBackgroundImage:[UIImage imageNamed:@"bottombar.png"]]; 
```

知道为什么它在 iOS 5 中有效但在 iOS 6 中无效吗？图像不是问题，因为我尝试在同一个视图中创建两个 UIImage 并将它们放在另一个之上，它们看起来很好。

我的（菜鸟式）猜测是 iOS 6 在标签栏的顶部添加了某种效果。如果是这样，有没有办法删除它？

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T14:53:04.603

找到了答案。感谢 Pixi 在另一个论坛上。

```
[[UITabBar appearance] setShadowImage:[UIImage imageNamed:@"shadow.png"]]; 
```

其中 shadow.png 是 1x1 透明图像。标签栏正在投射阴影，导致标签栏顶部出现锐线。透明图像摆脱了这一点。

可能这将在未来对其他人有所帮助。

# css - 使用 CSS 强制高度

> ID：13147850
> 
> 赞同：8
> 
> 时间：2012-10-30T21:29:46.870
> 
> 标签：css, html-table

我需要控制表格行的高度——我尝试设置单元格的高度，但我碰到了一堵砖墙。[见演示](http://jsfiddle.net/EUFxM/4/)。

```
tr.fixedRow,
tr.fixedRow td.fixedCell {
     height: 50px;
     overflow: hidden; } 
```

我知道我可以将`display`某些东西更改为，`block`但这样做通常会以一种糟糕的方式弄乱桌子——我正在使用一个相当复杂的桌子，它与附近的其他桌子交互并且需要完美地排列像素，所以通常，更改`display`然后尝试使用 CSS 再次使其看起来像一个表格对我来说不是一个好的解决方案，因为它不会匹配。我需要它来留一张桌子。

我也想避免这样做：

```
<td><div>
   ... cell content...
</div></td> 
```

这似乎是一种可怕的形式。这么简单的事情肯定只有 CSS 解决方案吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T00:32:11.647

您试图通过依赖一个无法按您期望的方式工作的 css 属性来实现这一点：CSS 溢出适用于块级元素，而 a`<td>`不是（css: `display: table-cell;`）。

参见[MDN 上的 CSS 溢出](https://developer.mozilla.org/en-US/docs/CSS/overflow)

`display: block;`出于这个原因，我相信除非您设置为s，否则您将无法达到固定高度`<td>`- 您说您不能因为它会破坏表格对齐，所以在我看来，唯一明智的选择是：

```
<td><span>...</span></td> 
```

设置`<span>`为`display: block;`（除了 a`div`会破坏 html 验证，而 span 不会 - 元素中不允许使用块`td`元素）

这是我能想到的最优雅和最有效的方式。

# javascript - 将用户名 + 加密密码发送到 RESTful 服务

> ID：13147855
> 
> 赞同：1
> 
> 时间：2012-10-30T21:30:00.430
> 
> 标签：javascript, rest, spring-mvc, spring-security, password-encryption

在我的应用程序中，我使用带有 JavaScript 客户端的 Spring MVC。现在是我需要向我的应用程序添加 4 眼验证表单的时候了。也就是说，第二个物理人必须过来输入他的用户名和密码，以验证某种敏感数据更新。然后系统将根据企业 LDAP 检查该人的用户名和密码，然后返回成功或失败。如果该人的身份验证失败，系统将通知用户无法删除/添加。如果成功，系统将执行更新。

我的问题是，既然所有的服务都是 RESTful 的，我怎样才能以最安全的方式实施这样的解决方案？我听说应该不惜一切代价避免使用 JavaScript API 加密密码并通过网络发送密码，因为任何中间人攻击都可能造成严重破坏。我也不想使用 HTTPS，它只能用于代表我应用程序的 1% 的表单的目的。我应该去 Spring Security 吗？如果是这样，我如何将 Spring Security Web 表单集成到 JavaScript 框架中？任何想法或经验都会受到欢迎。

最好的，吉米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:32:58.957

如果安全是一个问题，我会重新考虑你的“不想通过 https 和 ssl 来做”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T19:43:58.143

考虑一个挑战-响应机制。不会交换密码。

# facebook - Facebook Graph - 仅包括按页面发布的状态消息？

> ID：13147858
> 
> 赞同：0
> 
> 时间：2012-10-30T21:30:04.923
> 
> 标签：facebook, api, facebook-graph-api

我正在尝试在网站上设置 Facebook 状态更新提要。但是，我使用 Facebook 的 Graph API 提取的当前数据包括图像、喜欢等。

我如何编辑它以仅包含此页面发布到他们自己页面上的状态消息？

`https://graph.facebook.com/477138555413/feed?access_token=<APP ACCESS TOKEN>`

我尝试更换饲料？有状态？但我被告知“请求此资源需要用户访问令牌。”

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:37:11.683

您需要使用用户访问令牌来访问`statuses`页面的连接 - 如果由于某种原因这对您不起作用，您只需请求连接并根据那里的帖子的值和值进行`feed`过滤。`to``from`

如果这是您的页面，只需使用页面本身的页面访问令牌来检索提要。检查[登录](https://developers.facebook.com/docs/concepts/login/)文档以获取详细信息 - 当您使用用户的长期（60 天）令牌（来自服务器端 Oauth 流或通过使用客户端流并扩展令牌服务器端）访问页面访问令牌时在`/accounts`该页面访问令牌不会过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:51:57.147

都好。我找到了一个简单的解决方案。

我正在获取数据：

```
$FBpage = file_get_contents('https://graph.facebook.com/477138555413/posts?access_token=<APP ACCESS TOKEN>'); 
```

用 JSON 解释数据：

```
$FBdata = json_decode($FBpage); 
```

然后我正在运行一个 foreach 循环来返回每个状态：

```
foreach ($FBdata->data as $news ) {) 
```

为了过滤我的结果并只显示状态消息，我添加了这个：

```
if (empty($news->message)) { continue; } 
```

全部完成！

:)

# jsf - Apache Shiro，INI 配置，每个 URL 的权限：如何获取 URL 参数？

> ID：13147859
> 
> 赞同：1
> 
> 时间：2012-10-30T21:30:15.963
> 
> 标签：jsf, authorization, shiro

我想在我的 JSF 应用程序中使用[Apache Shiro](https://shiro.apache.org "阿帕奇希罗")来执行基于 URL 的授权检查，在 shiro.ini 中完成配置正如我在[Shiro 文档](https://shiro.apache.org/web.html#Web-webini)中看到的那样，有一种方法可以使用“perms”过滤器

```
/remoting/rpc/** = authc, perms["remote:invoke"] 
```

在我的场景中，我想要这个功能，但是在 entity-level [1](https://shiro.apache.org "阿帕奇希罗")上，entity-Id 在 http-request 中

```
# "Open settings for user with id=123":
# /user/settings.xhtml?user_id=123
/user/settings.xhtml = perms["user:update:XXX"] 
```

那么，我该如何使用 Shiro 呢？如何告诉 perms-filter 检查 http-params？或者这应该通过调用 FacesContext 在我的 Realm-Implementation 中完成吗？

[1](https://shiro.apache.org "阿帕奇希罗")这至少可以通过编程方式完成：

```
SecurityUtils.getSubject().isPermitted("printer:query:lp7200") 
```

[https://shiro.apache.org/permissions.html](https://shiro.apache.org/permissions.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T07:50:37.213

[可以](http://shiro-user.582556.n2.nabble.com/hundreds-of-url-and-perms-relationship-management-tp7526644p7527823.html "关于 shiro-user...nabble.com 的讨论")通过在软件中实现和使用自己的“org.apache.shiro.web.filter.AccessControlFilter”子类来做到这一点。这个自己的类可以在 shiro.ini 中声明：

```
[main]
user = filter.FooFilter 
```

AccessControlFilter 类提供了“isAccessAllowed(ServletRequest request, ServletResponse response, Object mappedValue)”方法，可以覆盖该方法以使用“request.getParameterMap()”来获取 HTTP-GET 参数。

例如，你可以看看我的项目[提拉米苏](https://github.com/SchulteMarkus/tiramisu)（相当过时）。请参阅[WEB-INF/shiro.ini中包含的](https://github.com/SchulteMarkus/tiramisu/blob/master/src/main/webapp/WEB-INF/shiro.ini)[CompanyManagerPermissionsFilter](https://github.com/SchulteMarkus/tiramisu/blob/master/src/main/java/com/bestellbaer/filter/CompanyManagerPermissionsFilter.java)（它扩展了[CompanyScopedPermissionsFilter](https://github.com/SchulteMarkus/tiramisu/blob/master/src/main/java/com/bestellbaer/filter/CompanyScopedPermissionsFilter.java)，它扩展了[DomainPermissionsFilter](https://github.com/SchulteMarkus/tiramisu/blob/master/src/main/java/com/bestellbaer/filter/DomainPermissionsFilter.java)）。

# ios - UITableViewCell 按下以显示视图

> ID：13147860
> 
> 赞同：0
> 
> 时间：2012-10-30T21:30:22.000
> 
> 标签：ios, xcode, uitableview, menu, hyperlink

我已经按照[本教程](http://youtu.be/Q6YTdRu8H_c)创建了一个菜单，您可以将其滑过或点击按钮以从侧面滑出（如 facebook 的 iOS 应用程序）。在菜单中有来自表格视图的单元格，我想链接到另一个视图，该视图将关闭菜单并打开该视图。如果您知道任何其他可以满足我要求的项目或教程，请告诉我。我已经尝试过[ecslidingviewcontroller](https://github.com/edgecase/ECSlidingViewController)但它不适用于我试图对我的应用程序执行的操作（在您可以从菜单访问的页面中有一个 rss 阅读器）所以，这就是为什么我正在寻找一些既可以是可以具有不同视图的不同滑动菜单从菜单的表视图或建议链接到当前代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:09:15.153

我用这个[https://github.com/izqui/SHSidebarController](https://github.com/izqui/SHSidebarController)挺好的。您基本上为侧面的每个链接或菜单项创建单独的控制器

# linux - 在后台运行 SCP 并监控进度

> ID：13147861
> 
> 赞同：9
> 
> 时间：2012-10-30T21:30:23.317
> 
> 标签：linux, scp, nohup

我`scp`在后台运行一个命令：

```
 nohup scp file.gz root@target-host:/root/ > nohup.out 2>&1 
```

我输入了密码 - 我点击`ctrl-z`停止命令并用 重新启动它`bg`，我可以通过执行来确认它正在运行`jobs`。但是，有没有一种方法可以监控文件传输的进度（即我是否会在不将其置于后台的情况下运行它）？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-11T01:49:29.903

在运行 CentOS / Red Hat / Fedora 时，我只使用：

```
ps aux | grep scp 
```

检查正在运行的 scp 进程。要查看他们是否在做任何事情，我喜欢使用：

```
du -s -c -h * 
```

如果您在`AWS EC2`，您可以切换到 Instances 部分来监控启动卷上的网络和 r/w 操作。要查看其他驱动器在做什么，请切换到卷部分的监控选项卡并选择一个卷。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T21:38:24.867

您可以使用 screen(1) 或类似的，而不是 bg。

然后您可以 control-ad 分离和 screen -d -r 重新附加。

您还可以根据需要注销并重新登录，而不会失去重新连接的能力，因此它非常适合不可靠的网络。它可以追溯到人们在调制解调器上进行 Slip 和 PPP 的时候，以及之前。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-30T09:04:03.010

您可以使用`jobs`命令来检查进程。

例如`jobs -l`，将列出所有正在运行的进程以及进程 ID。请参阅[此站点](https://www.cyberciti.biz/faq/unix-linux-jobs-command-examples-usage-syntax/)以供参考。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-23T09:05:28.760

```
nohup scp <file_name> user@<IP_Address>:<path>
nohup: ignoring input and appending output to 'nohup.out'
user@IP_address's password:
Ctrl+z
bg
disown -h %1 
```

bg -> 将作业发送到后台。

disown -h %1 -> 即使您退出系统，这也会让它运行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T21:37:18.483

也许您可以重定向`STDERR`到文件并用于`tail -f` 监视它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-10T07:35:14.093

你可以使用`watch tail nohup.out`它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-30T21:37:24.977

您可以使用 screen(1) 或类似的，而不是 bg。

然后您可以 control-ad 分离和 screen -d -r 重新附加。

您还可以根据需要注销并重新登录，而不会失去重新连接的能力，因此它非常适合不可靠的网络。它可以追溯到人们通过串行调制解调器进行 Slip 和 PPP 的时候。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-28T18:51:12.970

您可以使用`tail`命令查看 nohup.out 的输出。只需在终端上写下以下命令。

> 尾 -n 10 -f nohup.out

-n 10 告诉要显示的内容末尾的行数。

-f 告诉命令遵循 nohup.out。显示执行命令后将写入文件的所有内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-22T07:47:07.027

对我来说，只有使用详细模式才会附加一些东西`nohup.out`

```
nohup scp -v file.gz root@target-host:/root/ > nohup.out 2>&1 
```

之后可以使用监控`tail -f nohup.out`

# ruby-on-rails-3 - rails 3中nil类的未定义方法

> ID：13147862
> 
> 赞同：0
> 
> 时间：2012-10-30T21:30:45.170
> 
> 标签：ruby-on-rails-3

尝试在我的视图（控制器的索引页）中查看模型中的数据时，我不断收到上述错误消息

我的控制器

```
 def index

 @recipe = Recipe.all

 end 
```

我的观点

```
 <% @recipes.each do |r| %>
   <tr><td><%= r.dish_name %></td></tr>
    <% end %> 
```

我是 Rails 新手，所以可能这样做完全错误。有人还可以解释错误的含义吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:36:57.607

发现我的错误。我的控制器需要

@recipes = Recipe.all

我没有复数我的食谱对象

# javascript - 在 JavaScript 中正确处理 setTimeout

> ID：13147863
> 
> 赞同：0
> 
> 时间：2012-10-30T21:30:50.533
> 
> 标签：javascript

我正在尝试使用 JavaScript 为页面上的某些元素设置动画（带有精灵的 CSS 动画不适用于我需要做的事情）。

我目前正在做这样的事情；

```
function animate_element(current_id)
{
    var next_id = parseInt(current_id, 10) + 1;
    $('#lighthouse')[0].src = '/element_' + next_id + '.png';

    if (next_id >= 8) {
        next_id = 0;
    }     

    setTimeout(function() {
        animate_element(next_id);
    }, 750);
} 
```

从技术上讲，这是可行的，但这将是页面上许多类似的动画之一，我担心这是一种低效的方法。

我知道最好的做法是`clearTimeout()`在调用 setTimeout 之前使用，但我不知道如何记录 setTimeout 并将其递归地传递给自身（如果这有任何意义！）。

任何有关执行此操作的最佳实践方式的指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:34:01.027

> *“我知道最好的做法是`clearTimeout()`在调用 setTimeout 之前使用......”*

对于你正在做的事情，没有理由打电话`clearTimeout()`，因为下一个电话永远不会发生，直到最后一个电话被执行。

在这一点上，没有什么需要澄清的。

* * *

FWIW，您的代码可以缩短一点：

```
function animate_element(current_id) {
    current_id = parseInt(current_id, 10);

    function cycle() {
        document.getElementById('lighthouse').src = '/element_' + current_id + '.png';
        current_id = ++current_id % 8
        setTimeout(cycle, 750);
    }
}

animate_element(0); 
```

* * *

或者，如果有几个相同的，只是使用不同的 ID，您可以像这样使其可重用：

```
function animate_element(id, idx) {
    idx = parseInt(idx, 10);

    function cycle() {
        document.getElementById(id).src = '/element_' + idx + '.png';
        idx = ++idx % 8
        setTimeout(cycle, 750);
    }
}

animate_element('lighthouse', 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:35:35.147

没有仔细查看您的代码或您在做什么，但如果您想保留该值，您可以*关闭*变量：

```
var animate_element = (function(){

   var timer;

   return function(current_id)
   {
       var next_id = parseInt(current_id, 10) + 1;
       $('#lighthouse')[0].src = '/element_' + next_id + '.png';

       if (next_id >= 8) {
           next_id = 0;
       }     

       clearTimeout(timer);
       timer = setTimeout(function() {
          animate_element(next_id);
       }, 750);
   };

})(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:39:22.390

我会说在你的情况下`setInterval`会更好。`setTimeout`

```
var current_id = 0;

function animate_element() {
  setInterval(function() {
    var next_id = parseInt(current_id, 10) + 1;
    $('#lighthouse')[0].src = '/element_' + next_id + '.png';

    if (next_id >= 8) {
        next_id = 0;
    }

    current_id = next_id;
  }, 750);
} 
```

# rdf - 如何从原始数据 (CSV) 创建本体？

> ID：13147864
> 
> 赞同：7
> 
> 时间：2012-10-30T21:30:51.007
> 
> 标签：rdf, data-modeling, semantic-web, owl, ontology

我正在使用具有相关类、对象属性等的 OWL 本体对大学数据进行建模。我将大学数据放在一个简单的文本文件（比如 CSV）中。我想使用我的模型为这些数据创建本体。我的问题是：

1.  这就是本体的工作方式吗？
2.  如果是这样，如何使用 Jena 来完成？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T02:03:44.883

如果我理解您的问题，您有一个代表大学模型的本体，并且您想使用 CSV 形式的数据集创建 owl 实例。如果您需要其他内容，请纠正我。

你的第一个问题的答案是肯定的。

有多种方法可以解决这个问题。

1.  在 Jena 的帮助下，可以使用可用的库将 CSV 数据转换为 RDF。这是链接[链接](http://www.w3.org/wiki/ConverterToRdf)；这是更详细的答案： [链接](https://stackoverflow.com/questions/8373425/populate-an-existing-ontology-from-a-csv-file-using-jena)

2.  这也可以使用 XSLT 来完成，编写一个 xsl 将数据从 csv 转换为 owl 个体。并使用 OWL API 将这些猫头鹰个体附加到本体。

3.  如果您使用 Protege 构建本体，Protege 提供了一个插件来导入 CSV 数据。[关联](http://protegewiki.stanford.edu/wiki/Excel_Import)

4.  其他方法也很少。

以上 3 种方法都被很多人使用，并且没有一个特定的标准来解决这个问题。您可以根据您的要求选择一种方法。

# c - 从文件夹加载图像（使用 C、OpenCV、VisualStudio 2008）

> ID：13147873
> 
> 赞同：2
> 
> 时间：2012-10-30T21:31:55.153
> 
> 标签：c, image, visual-studio-2008, visual-c++, opencv

我正在尝试从文件夹加载图像，并且正在使用 C、OpenCV、VC++ 2008 Express Edition。我的图像位于桌面上并且具有不同的名称，例如 Tom.jpg、Flash.jpeg 等。我想在我的程序中从这个文件夹中加载图像，并一次对图像进行一些实验并保存结果本实验的.txt文件，.txt文件的名称应与.jpeg文件的名称相同。如在 Tom.jpg 上执行的实验数据应存储在 Tom.txt 中，Flash.jpg 应存储在 Flash.txt 等中。

我可以为一张图像执行上述过程（加载图像并将其数据存储在文本文件中）。从我手动创建的文本文件中读取文件名后，我可以一张一张地显示 10 张图像。但在这种情况下，不同图片的所有数据都存储在同一个文本文件中，我无法区分不同的数据集。

任何人都可以建议一种方法从文件夹中加载一个图像并进行必要的实验并将数据存储在不同的 .txt 文件中并为可能 1000 张图像做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:37:18.670

我希望你至少为你的主要处理创建了一个函数。如果你不这样做，做。然后，只需将图像列表作为参数传递给可执行文件，并使用 for 循环

```
int main(int argc, char **argv) {
   for (int i = 1; i < argc; ++i) {
      const char* imageName = argv[i];
      process(imageName);
   }
 return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T07:45:12.570

这是我最终使用的代码：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa365200(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365200(v=vs.85).aspx)

我做了一些修改。我向它传递了两个论点。我选择将不同图像的数据保存在同一个 Excel 表中，但这次我能够区分不同的数据集。图像文件名首先出现，然后是其数据

argv[1] 是所有图像所在的目录 argv[2] 是我在代码中想要的文件扩展名（在我的例子中是 jpg）

//*用于扫描文件夹中的 jpeg 图像*

```
StringCchCopy(szDir, MAX_PATH, argv[1]);          
StringCchCat(szDir, MAX_PATH, TEXT("\\*."));      
StringCchCat(szDir, MAX_PATH, argv[2]);

hFind = FindFirstFile(szDir, &ffd);

do           
   {  
    //Loading the file from the folder and doing processing on it                 
    }    
while (FindNextFile(hFind, &ffd) != 0); 
```

# iphone - CGBitmapContextCreate 的内存使用率非常高

> ID：13147875
> 
> 赞同：0
> 
> 时间：2012-10-30T21:32:01.000
> 
> 标签：iphone, objective-c, ios, xcode, memory-management

我正在使用以下代码在我的 iOS 应用程序的 touchesEnded 处截取绘图：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{

    if(_pagessavedbg.count > selectedIndex)
        self.topimage = [_pagessavedbg objectAtIndex:selectedIndex];

    else
        self.topimage = [UIImage imageNamed:@"BlankImage.png"];

    UIImage *bottomimage = [notification.userInfo objectForKey:@"Image"];

    CGSize size = activeView.frame.size;

    NSUInteger width = size.width * 2;
    NSUInteger height = size.height * 2;

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    unsigned char *rawData = malloc(height * width * 4);
    memset(rawData,0,height * width * 4);

    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);

    CGRect bounds;
    bounds.origin = CGPointMake(0,0);
    bounds.size = size;

    CGContextScaleCTM(context, 2.0, 2.0);

    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), [self.topimage CGImage]);
    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), [bottomimage CGImage]);

    CGImageRef imageRef2 = CGBitmapContextCreateImage(context);
    UIImage *latest2 = [UIImage imageWithCGImage:imageRef2 scale:0.0 orientation:UIImageOrientationDownMirrored];

    activeView.layer.contentsScale = 2.0;
    [activeView.layer renderInContext:context];

    CGImageRef imageRef = CGBitmapContextCreateImage(context);
    UIImage *latest = [UIImage imageWithCGImage:imageRef scale:0.0 orientation:UIImageOrientationDownMirrored];

    CGContextRelease(context);
    CGColorSpaceRelease(colorSpace);
    CGImageRelease(imageRef);
    CGImageRelease(imageRef2);
    free(rawData);

    [_pages replaceObjectAtIndex:_sidebar.selectedIndex withObject:latest];

    [_sidebar reloadData];

    if(_pages.count > selectedIndex)
    {
    if([_pages objectAtIndex:selectedIndex])
    [_pages replaceObjectAtIndex:selectedIndex withObject:latest];

    if([_pagessavedbg objectAtIndex:selectedIndex])
    [_pagessavedbg replaceObjectAtIndex:selectedIndex withObject:latest2];

    else
    [_pagessavedbg insertObject:latest2 atIndex:selectedIndex];
    }

    dispatch_async(dispatch_get_main_queue(), ^{
    [self.sidebar reloadData];
    [self.sidebar scrollRowAtIndexToVisible:_sidebar.selectedIndex];
    });    

}); 
```

但是，每次调用此代码（在 touchesEnded 时），内存使用量都会增加大约 10MB。为什么会这样？有没有更好的替代方法可以使用*更少*的内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T02:10:20.753

正如贾斯汀所说，2048 * 1536 * 4 = 12MB。这个事实是数学，无法避免。但是，如果分配 12MB 是一个问题，那么有很多方法可以管理您的内存利用率（对于短期使用来说，1GB 设备上的内存并不是那么多，所以您应该询问您要解决的问题，但无论如何。 ...)

*   如果您经常这样做，请不要重新分配内存。重复使用它。这样，您只需支付一次。
*   如果您不需要 2048*1536*4 的图像，请创建一个较小的位图并缩放您的图像以适应它。
*   分配较小的位图并将部分图像渲染到其中。稍后将它们缝合在一起。

但是您是否有目标内存分配？虽然视网膜显示器一直是许多应用程序的主要内存问题，但短暂的 12MB 分配通常不是问题。更多时候是所需的时间，而不是内存。

但是，如果您必须有一个 2048*1536*4 的位图，它将占用 12MB 的内存。

# c# - 将 JSON 对象从客户端传递到服务器

> ID：13147876
> 
> 赞同：0
> 
> 时间：2012-10-30T21:32:07.803
> 
> 标签：c#, javascript, json, jquery, webmethod

我无法进行客户端站点 AJAX 调用，然后使用 PageMethods 将 JSON 对象响应传递到服务器端以执行一些条件逻辑

从 Web 服务收到的 JSON 响应是：

```
{"Status":"Internal"} 
```

默认.aspx

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="GoRedirect._Default" %>
<html>
<head>
<title></title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
</head>
<body>
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true">
</asp:ScriptManager>
   <script type="text/javascript">
        function invokeService() {
            $(document).ready(function () {
                $.ajax({
                    type: "GET",
                    async: "false",
                    url: "http://Domain.Local/InternalCheck/",
                    dataType: "json",
                    success: function (result) {
                        AjaxSucceeded(result);
                    },
                    error: AjaxFailed
                });
            });
        }
        function AjaxSucceeded(result) {
            var objJSON = result.Status;
            PageMethods.GetJSONResponse(objJSON);
        }
        function AjaxFailed(result) {
            alert(result.status + ' ' + result.statusText);
        }
        invokeService();
    </script>
</form> 
```

默认.aspx.cs

```
namespace GoRedirect
{
public partial class _Default : Page
{
    [Serializable]
    public class ServerJSON
    {
        public string Status { get; set; }
    }

    [WebMethod]
    public static string GetJSONResponse(string objJson)
    {
        try
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            string JSONResponse = serializer.Serialize(objJson);
            return JSONResponse;
        }
        catch(Exception errorException)
        {
            return errorException.ToString();
        }

    }

    public void Page_Load(object sender, System.EventArgs e)
    {
        If (JSONResponse.Status == "Internal")
        {
        //Do something
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T21:54:41.040

看看 Dave Ward 的这篇文章：http: [//encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

正如文森特所说，您似乎需要使用 POST 而不是 GET，以及一个空的数据参数和内容类型：

```
$(文档).ready(函数 () {
                $.ajax({
                    类型：“发布”，
                    异步：“假”，
                    url: "http://Domain.Local/InternalCheck/",
                    数据类型：“json”，
                    数据： ”{}”，
                    contentType: "应用程序/json; charset=utf-8",
                    成功：函数（结果）{
                        AjaxSucceeded(结果);
                    },
                    错误：Ajax 失败
                });
            });
```

# c# - 我看到的是真正的内存泄漏吗？

> ID：13147878
> 
> 赞同：3
> 
> 时间：2012-10-30T21:32:11.673
> 
> 标签：c#, .net, winforms

我正在编写一个应用程序，在用户使用它之后 - 他可以“重置”它并再次使用它。实际使用会创建一些对象，包括控件。

我使用 Process Explorer 检查了内存使用情况，发现当使用该应用程序时 - 内存使用量有所增加，但当应用程序“重置”时 - 内存使用量几乎没有下降。

`Dispose`因此，在所有s的“重置”时，我`Control`递归地，甚至添加了一个`GC.Collect();`启动。但`Process Explorer -> (app's-) Properties -> .Net CLR Memory`仍然在堆上显示了很多东西，并且使用了很多内存。

这（必然）是内存泄漏吗？为什么强制 GC 没有帮助？

编辑：

我添加了`GC.Collect();`仅用于调试 - 用于确定是否存在泄漏。在 GC 工作之前，我并不担心“临时泄漏”，我只是想找出是否有对象永远不会超出范围（尽管我还没有找到它们），或者这只是一个问题时间，内存将被回收。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T21:40:59.407

> 这（必然）是内存泄漏吗？

嗯……是的，不是的。在 C# 应用程序中，大部分情况下不可能发生真正的内存泄漏，如果从未调用过 Dispose()，即使在后台使用本机资源的类型也会在其终结器中自行清理。

无论如何，可能有陈旧的引用和本机资源需要很长时间才能清理（或编写不当的本机函数会泄漏自身），这与非托管语言中真正的内存泄漏具有相同的实际结果。

> 为什么强制 GC 没有帮助？

你给了 GC 一个建议，它选择不接受。`GC.Collect()`不会强制 GC 清理所有内容，文档也会告诉您。其次，这种内存使用真的会导致问题吗？消耗了多少内存？它会被释放吗？如果只是少量，那么您可能什么都不担心，让 GC 完成它的工作。

在没有看到您的代码的情况下，我所能做的就是猜测。有几种方法可以在 C# 应用程序中建立内存压力。

1.  陈旧的参考资料。对您永远不会清除的“死”对象的引用列表。事件处理程序也可能导致这种情况。例如，应始终取消订阅静态事件，因为事件委托持有对订阅者的引用。

    因此，如果订阅者在没有取消订阅事件的情况下超出范围，则本质上存在内存泄漏，因为始终存在对这些“死”对象的有效引用。请注意，事件的典型用例不会导致这种情况发生，因为父级（事件发布者）通常会在您需要时超出范围。

2.  不处理实现 IDisposable 的对象。当然，它们可能会在它们的终结器中自行清理（所有 .NET IDisposable 类型都会这样做，其余的应该），但是终结器在不确定的时间运行，这使得整个事情变得不可预测。确保尽快调用 Dispose()（尽可能使用`using`语句）。

3.  大对象堆碎片。如果您要分配大量“大”对象（> 85,000 字节的对象），那么这部分内存可能会变得碎片化。此内存不会像在标准堆上分配的第 0 代和第 1 代对象那样经常清理。

.NET GC 很复杂，而且通常非常擅长它的工作。有时调用 是可以接受的`GC.Collect`，但您应该了解何时这是一个好主意，并意识到它可能会或可能不会按照您的意愿行事。例如，如果您创建了大量的短期对象。

当我用尽其他途径时，我在使用[RedGate 的 .NET 内存分析器时获得了很好的体验。](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/)我不为他们工作，也不以任何方式与他们有任何关系，正如你所知，他们也有免费试用。值得一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:40:06.447

要查找泄漏的内存，请使用专门为此设计的工具：

[哪些策略和工具可用于查找 .NET 中的内存泄漏？](https://stackoverflow.com/q/134086/351385)

.NET Framework 中的垃圾收集器不会释放内存，直到内存压力超过某个启发式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T21:45:22.530

正如其他人`GC.Collect()`单独指出的那样并不能确保 GC，您可以尝试的一件事是[`GetTotalMemory`](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx)采用布尔参数的方法，允许您强制执行完整的 GC，例如

```
GC.GetTotalMemory(true); 
```

这将强制进行总收集，然后为您提供分配的托管内存量的近似值（以字节为单位）。

与显示的其他方法一样，这**并不能**保证会发生收集（请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx)的备注部分），并且显然只能收集符合条件的东西。

# php - PHP在while循环中连接到两个表

> ID：13147881
> 
> 赞同：1
> 
> 时间：2012-10-30T21:32:19.927
> 
> 标签：php, sql, database, while-loop, connect

我相信我有一个小而相当简单的问题，但是我已经尝试了所有方法，但我就是无法弄清楚这种语法。

我将从输入以下代码（php）开始：

```
require_once('connectvars.php'); // My database connection

//Connect to the database
$dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
//Retrieve the data from the database
$query = "SELECT * FROM pbclickslogin WHERE username='$username'";
$data = mysqli_query($dbc, $query);
while ($info = mysqli_fetch_array( $data )) {
    echo $info['lol']; echo $info['lol2'];
} 
```

所以我编了这个例子，让我们说“$info['lol'];” 是名为“pbclickslogin”和“$info['lol2'];”的表中的列 是名为“pbclickssomethingelse”的表中的一列。但是我不能同时连接到两个数据库，或者我可以吗？

我试过添加：

```
$query = "SELECT * FROM pbclickslogin, pbclickssomethingelse WHERE username='$username'"; 
```

和这个：

```
$query = "SELECT * FROM pbclickslogin WHERE username='$username'";
$query2 = "SELECT * FROM pbclickssomethingelse WHERE username='$username'";
$data = mysqli_query($dbc, $query, $query2);
while ($info = mysqli_fetch_array( $data )) {
    echo $info['lol']; echo $info['lol2'];
} 
```

但正如你们中的一些有经验的 PHP 用户可能知道的那样。这两件事并没有解决我的问题。你们中有人知道我在执行while循环时如何连接到这两个数据库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:36:22.010

您可以对两个表进行连接，而不是两个单独的查询。这是一个简单的例子：

```
 $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
    $data = mysqli_query($dbc, "SELECT * FROM pbclickslogin, pbclickssomethingelse WHERE pbclickslogin.username = pbclickssomethingelse.username AND pbclickslogin.username='" . $username . "'");
    while ($info = mysqli_fetch_array( $data )) {
        echo $info['lol']; echo $info['lol2'];
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:43:28.157

```
SELECT * FROM pbclickslogin l
   INNER JOIN pbclickssomethingelse s ON l.username = p.username
   WHERE l.username='$username' 
```

根据您提供的示例，我能做到的最好。这将通过两个表上的用户名将表连接在一起，然后您选择“其中”用户名是特定值。

我强烈建议您阅读一些有关 PHP 和 SQL 的教程。

# java - 如何使用 xstream 读取 xml 中的注释

> ID：13147883
> 
> 赞同：1
> 
> 时间：2012-10-30T21:32:24.263
> 
> 标签：java, comments, xstream

有没有办法在使用 XStream 和 Java 解析它时读取 xml 注释。

```
<!--
 Mesh:  three-dimensional box 100m x 50m x 50m Created By Sumit Purohit on 
 for a stackoverflow query.
-->  
<ParameterList name="Mesh">  
 <Parameter name="Domain Low Corner" type="Array double" value="{0.0, 0.0,  0.0}" /> 
 <Parameter name="Domain High Corner" type="Array double" value="{100.0, 50.0,50.0}" /> 
</ParameterList> 
```

我目前使用 XStream 来序列化/反序列化上述类型的 xml。我需要将评论保存为我的 POJO 上的注释，以便我可以在 UI 中显示它。

我在 XStream 中找不到任何东西。

DOM 有[DocumentBuilderFactory.setIgnoringComments(boolean)](http://docs.oracle.com/javase/1.4.2/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setIgnoringComments%28boolean%29)可以让你在 DOM 树中包含注释，你可以区分节点的类型。

同样 C# 有[XmlReaderSettings.IgnoreComments](https://stackoverflow.com/questions/6277966/reading-xml-comments-in-c-sharp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:12:22.573

据我所知，XStream 无法处理 XML 注释。

这是另一种方法，它使用 LexicalHandler API：

```
import org.xml.sax.*;
import org.xml.sax.ext.*;
import org.xml.sax.helpers.*;

import java.io.IOException;

public class ReadXMLFile implements LexicalHandler {

  public void startDTD(String name, String publicId, String systemId)
      throws SAXException {
  }

  public void endDTD() throws SAXException {
  }

  public void startEntity(String name) throws SAXException {
  }

  public void endEntity(String name) throws SAXException {
  }

  public void startCDATA() throws SAXException {
  }

  public void endCDATA() throws SAXException {
  }

  public void comment(char[] text, int start, int length)
      throws SAXException {

    System.out.println("Comment: " + new String(text, start, length));
  }

  public static void main(String[] args) {
    // set up the parser
    XMLReader parser;
    try {
      parser = XMLReaderFactory.createXMLReader();
    } catch (SAXException ex1) {
      try {
        parser = XMLReaderFactory.createXMLReader("org.apache.xerces.parsers.SAXParser");
      } catch (SAXException ex2) {
        return;
      }
    }

    try {
      parser.setProperty("http://xml.org/sax/properties/lexical-handler",new ReadXMLFile()
      );
    } catch (SAXNotRecognizedException e) {
      System.out.println(e.getMessage());
      return;
    } catch (SAXNotSupportedException e) {
      System.out.println(e.getMessage());
      return;
    }

    try {
      parser.parse("xmlfile.xml"); // <----  Path to XML file
    } catch (SAXParseException e) { // well-formedness error
      System.out.println(e.getMessage());
    } catch (SAXException e) { 
      System.out.println(e.getMessage());
    } catch (IOException e) {
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:49:37.047

尝试使用[LexicalHandler](http://docs.oracle.com/javase/1.4.2/docs/api/org/xml/sax/ext/LexicalHandler.html) API 来解析 XML 中的 CData 和 Comments。

# extjs - ExtJS 在 store 上调用 remove 时不会向服务器发送“destroy”命令

> ID：13147886
> 
> 赞同：1
> 
> 时间：2012-10-30T21:32:54.110
> 
> 标签：extjs, proxy, extjs4.1, record

以下是针对 ExtJS 的

所以在我看来，我正在尝试以下方法。（基本上是删除一条记录）但由于某种原因，它甚至根本不会向服务器发送“destroyRecord”调用。知道为什么会发生这种情况吗？代码如下。

请注意，下面的 module.getResults 和 module.destroyRecord 调用创建实际服务器调用的相同函数。module.getResults 被正确调用，我得到了正确的记录，但似乎无法让它进入“destoryRecord”部分。我想知道它是否与 hasMany 参数有关，但不是积极的。任何帮助都是有益的。

看法：

```
var record = this.down('form').getRecord();
var store = Ext.getStore('ModuleStore');
store.remove(record); 
```

店铺：

```
Ext.define('MyApp.store.ModuleStore', {
extend: 'Ext.data.Store',

requires: [
    'MyApp.model.ModuleModel'
],

constructor: function(cfg) {
    var me = this;
    cfg = cfg || {};
    me.callParent([Ext.apply({
        autoLoad: true,
        autoSync: true,
        filterOnLoad: false,
        remoteFilter: true,
        remoteSort: true,
        sortOnLoad: false,
        storeId: 'module',
        model: 'MyApp.model.ModuleModel',
        buffered: true,
        listeners: {
            write: {
                fn: me.onStoreWrite,
                scope: me
            },
            remove: {
                fn: me.onStoreRemove,
                scope: me
            },
            datachanged: {
                fn: me.onStoreDataChangeD,
                scope: me
            }
        }
    }, cfg)]);
},

onStoreRemove: function(store, record, index, options) {
    console.log('remove'); // Isn't called for some reason
}

}); 
```

模型：

```
Ext.define('MyApp.model.ModuleModel', {
extend: 'Ext.data.Model',

uses: [
    'MyApp.model.ModuleHistoryModel'
],

idProperty: 'id',

fields: [
    {
        name: 'id',
        type: 'int'
    },
    {
        name: 'AmendmentNumber',
        type: 'string'
    },
    {
        name: 'contract_id',
        type: 'int'
    }
],

proxy: {
    type: 'direct',
    api: {
        create: module.createRecord,
        read: module.getResults,
        update: module.updateRecords,
        destroy: module.destroyRecord
},
    reader: {
        type: 'json',
        root: 'data'
    }
},

hasMany: {
    model: 'MyApp.model.ModuleHistoryModel',
    foreignKey: 'Module_id',
    name: 'history'
}
}); 
```

模块历史模型：

```
Ext.define('MyApp.model.ModuleHistoryModel', {
extend: 'Ext.data.Model',

uses: [
    'MyApp.model.MaintTypeModel'
],

fields: [
    {
        name: 'id',
        type: 'int'
    },
    {
        name: 'ContractNumber',
        type: 'string'
    },
    {
        name: 'MaintType_id',
        type: 'int'
    },
    {
        name: 'Module_id',
        type: 'int'
    }
],

proxy: {
    type: 'direct',
    api: {
        create: modulehistory.createRecord,
        read: modulehistory.getResults,
        update: modulehistory.updateRecords,
        destroy: modulehistory.destroyRecord
},
    reader: {
        type: 'json',
        root: 'data'
    }
},

belongsTo: {
    associationKey: 'MaintType',
    model: 'MyApp.model.MaintTypeModel',
    getterName: 'getMaintType',
    foreignKey: 'MaintType_id',
    setterName: 'setMaintType'
}
}); 
```

MainType 型号：

```
Ext.define('MyApp.model.MaintTypeModel', {
extend: 'Ext.data.Model',

idProperty: 'id',

fields: [
    {
        name: 'id',
        type: 'int'
    },
    {
        name: 'Type',
        type: 'string'
    }
],

proxy: {
    type: 'direct',
    api: {
        create: mainttype.createRecord,
        read: mainttype.getResults,
        update: mainttype.updateRecords,
        destroy: mainttype.destroyRecord
},
    reader: {
        type: 'json',
        root: 'data'
    }
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:06:00.297

您还需要调用 store sync，以便将网格与服务器同步。

```
var record = this.down('form').getRecord();
var store = Ext.getStore('ModuleStore');
store.remove(record);
store.sync(); 
```

我会将文档发送给您，但它们似乎已关闭。

# c# - Visual Studio 2012 - 导出模板自动化

> ID：13147889
> 
> 赞同：3
> 
> 时间：2012-10-30T21:32:58.800
> 
> 标签：c#, templates, visual-studio-2012

在以前的 VS 版本中，您可以使用 ProjectGen.exe 自动导出。这在VS 2012中仍然可能吗？我找不到 projectgen.exe 或任何解释如何完成此操作的文档。我有几个项目，导出每个项目都很乏味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T03:20:30.993

现在它在技术上仍然有效，但它对 NuGet 并不聪明，所以它不是超级有用。我们正在做这件事。

# r - rollapply 滑动窗口

> ID：13147890
> 
> 赞同：3
> 
> 时间：2012-10-30T21:33:08.020
> 
> 标签：r

我是 R 的新手。我很抱歉我的幼稚问题。

我的部分数据如下：

```
POS         Obs_FCT
4345     0.10049191
4484     0.08930793
4515    -0.00468725
4547    -0.00749802
4628     0.01143598
5347     0.05673895
6071     0.01143598
6449    -0.00070778
6498    -0.0109962
7320     0.00543984
7457    -0.00206247
7761     0.08018589
7875    -0.00601304
7988    -0.00070778
9459     0.01447144
9483     0.08269899
9495    -0.03353229
9552    -0.00206247
9602    -0.0269909
9701    -0.00206247
11809   -0.01952417
12593   -0.02173826
16787    0.08930793
17049   -0.06738125
17058    0.01325792 
```

我想绘制`Obs_FCT`（Y 轴）VS `POS`（X 轴），但它根本没有绘制。我还想在`POS`列上应用一个滑动窗口。窗口如下（即窗口大小为1000，滑动200）：

```
1--1000
200 ---1200
400 ---1400 
600 ----1600
-------- 
```

如果`POS`列中的数字位于每个窗口中，则计算 的平均值`Obs_FCT`。（X 轴使用窗口的中点）。

有人可以告诉我如何使用 R 代码来实现这一目标吗？一般来说，我知道也许我可以得到我想要的东西`rollapply`。但似乎需要一个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T12:29:40.307

我将您的数据复制粘贴到一个文本文件中，并使用 read.table 将其读入 R。使用 plot 命令可以得到你想要的结果`plot`

```
> d<-read.table("path/to/file.txt", header=TRUE, sep="")
> head(d)
   POS     Obs_FCT
1 4345  0.10049191
2 4484  0.08930793
3 4515 -0.00468725
4 4547 -0.00749802
5 4628  0.01143598
6 5347  0.05673895
>plot(d) 
```

这将绘制 X 轴为 POS 和 Y 轴为 Obs_FCT 的绘图。

来自包 caTools 的 runmean，可让您制作运行中位数。您可以指定窗口中的点数，但不能指定希望窗口如何滑动。

```
> md <- runmean(x=d$Obs_FCT, k=1000) 
```

然后您可以绘制：

```
plot(d$POS, md) 
```

# variables - 我想我有范围问题？

> ID：13147891
> 
> 赞同：1
> 
> 时间：2012-10-30T21:33:26.263
> 
> 标签：variables, scope, scheme, let

我正在尝试编写一个程序来计算平均绩点（GPA），该程序采用成绩列表并输出 GPA。（作为练习，而不是家庭作业）。

测试用例：

```
(GPA? '(A C B B)) 
3.0 
```

这是我最好的猜测：

```
(define a 4.0)
(define b 3.0)
(define c 2.0)
(define d 1.0)
(define f 0.0)

(define (mysum lst)
  (let loop ((lst lst) (accum 0))
    (cond
      [(null? lst) accum]
      [else (loop (cdr lst) (+ accum (car lst)))]))) 
```

我收到错误：

> “+ 中的异常：a 不是数字”

当我运行测试用例时：

```
(mysum '(1 2 3 a)) 
```

它应该返回 10，但不能在过程中将 a 定义为 4.0。

有人可以给我一个简单的解释这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:44:35.587

试试这个：

```
(mysum (list 1 2 3 a)) 
```

这不是范围界定问题，只是对报价的一点误解。当你写这个：

```
'(1 2 3 a) 
```

你是说：我想要一个包含 elements 的列表`1, 2, 3, a`。如果*必须*使用引号，则评估`a`变量的正确语法是：

```
`(1 2 3 ,a)
=> '(1 2 3 4.0) 
```

...但在这种情况下，仅使用`list`构建新列表的过程更简单：

```
(list 1 2 3 a)
=> '(1 2 3 4.0) 
```

作为记录：您可以轻松地将所有元素添加到列表中，如下所示：

```
(apply + (list 1 2 3 a))
=> 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:48:19.343

`'(1 2 3 a)`是的缩写，`(quote (1 2 3 a))`表示*逐字*列表`(1 2 3 a)`成为 的参数`mysum`。从未尝试在引号下扩展变量值——如果您在此处写字母，则假定字母是您想要的列表中的内容。特别是第四个元素列表是符号`a`，而不是名称为该符号的变量的值。

如果你想插入变量的值，你可以`list`像在另一个答案中那样使用：

```
(mysum (list 1 2 3 a)) 
```

或准：

```
(mysum `(1 2 3 ,a)) 
```

# mysql - 获取行之前和之后的 SQL

> ID：13147892
> 
> 赞同：0
> 
> 时间：2012-10-30T21:33:28.737
> 
> 标签：mysql

我有以下 SQL：

```
SELECT `PersonID`, `Title`.`Title`, `FirstName`, `LastName` 
FROM `Person` 
ORDER BY `cft` ASC, `FirstName` ASC 
```

`PersonID`现在的问题是因为结果不是数字，如果我将其设置为 1020 ，是否有办法获取前后行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:45:37.000

`FirstName`这是下一行的条件（假设每个没有类似的`cft`）：

```
WHERE (`cft` = :cft AND FirstName > :firstname) OR (`cft` > :cft)
ORDER BY `cft` ASC, `FirstName` ASC
LIMIT 1 
```

其中`:cft`和`:firstname`是来自 的行的对应值`PersonID = 1020`。

上一行的条件与我展示的非常相似，我相信你可以自己得到它（把它当作家庭作业）

# .net - 为什么这个 DelegateCommand 不能用后台工作人员正确刷新 CanExecute？

> ID：13147894
> 
> 赞同：1
> 
> 时间：2012-10-30T21:33:37.433
> 
> 标签：.net, wpf, multithreading, backgroundworker, delegatecommand

在 WPF 中使用 DelegateCommand 我面临以下问题：

如果在 UI 线程上执行命令，则在后台工作人员中执行 Command1 会阻止窗口正确刷新按钮的 CanExecute，一切都按预期工作。在按钮外部单击 CanExecute 会正确刷新。有什么提示吗？

（下面是 DelegateCommand 的代码，如果它太大，抱歉。据我所知，这是 DelegateCommand 的常见实现）

XAML：

```
 <Window x:Class="BackgroundWorkTest.MainWindow"
     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
     Title="MainWindow" Height="350" Width="525">
    <StackPanel>
          <Button Command="{Binding Command1}" Content="1" />
          <Button Command="{Binding Command2}" Content="2" />
    </StackPanel>
 </Window> 
```

C＃：

```
using System.ComponentModel;
using System.Windows;
using System.Windows.Input;
using Utils.Wpf;

namespace BackgroundWorkTest
{
public partial class MainWindow : Window
{
    private bool _canCommand1 = true;
    private bool _canCommand2 = true;

    private readonly BackgroundWorker _backgroundWorker;

    public ICommand Command1 { get; private set; }
    public ICommand Command2 { get; private set; }

    public MainWindow()
    {
        this.Command1 = new DelegateCommand(this.ExecuteCommand1, this.CanCommand1);
        this.Command2 = new DelegateCommand(this.ExecuteCommand2, this.CanCommand2);

        _backgroundWorker = new BackgroundWorker();
        _backgroundWorker.DoWork += _backgroundWorker_DoWork;
        _backgroundWorker.RunWorkerCompleted += _backgroundWorker_RunWorkerCompleted;

        InitializeComponent();

        this.DataContext = this;
    }

    private void _backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        System.Threading.Thread.Sleep(2000);
    }

    private void _backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        System.Threading.Thread.Sleep(2000);
        _canCommand2 = true;
        _canCommand1 = false;
    }

    private bool CanCommand2()
    {
        return _canCommand2;
    }

    private void ExecuteCommand2()
    {
        _canCommand2 = false;
        _canCommand1 = true;
    }

    private bool CanCommand1()
    {
        return _canCommand1;
    }

    private void ExecuteCommand1()
    {
        _backgroundWorker.RunWorkerAsync();
    }
} 
```

}

委托命令 C#：

```
 public class DelegateCommand : ICommand
{
    #region Constructors

    /// <summary>
    ///     Constructor
    /// </summary>
    public DelegateCommand(Action executeMethod)
        : this(executeMethod, null, false)
    {
    }

    /// <summary>
    ///     Constructor
    /// </summary>
    public DelegateCommand(Action executeMethod, Func<bool> canExecuteMethod)
        : this(executeMethod, canExecuteMethod, false)
    {
    }

    /// <summary>
    ///     Constructor
    /// </summary>
    public DelegateCommand(Action executeMethod, Func<bool> canExecuteMethod, bool isAutomaticRequeryDisabled)
    {
        if (executeMethod == null)
        {
            throw new ArgumentNullException("executeMethod");
        }

        this._executeMethod = executeMethod;
        this._canExecuteMethod = canExecuteMethod;
        this._isAutomaticRequeryDisabled = isAutomaticRequeryDisabled;
    }

    #endregion

    #region Public Methods

    /// <summary>
    ///     Method to determine if the command can be executed
    /// </summary>
    public bool CanExecute()
    {
        if (this._canExecuteMethod != null)
        {
            return this._canExecuteMethod();
        }
        return true;
    }

    /// <summary>
    ///     Execution of the command
    /// </summary>
    public void Execute()
    {
        if (this._executeMethod != null)
        {
            this._executeMethod();
        }
    }

    /// <summary>
    ///     Property to enable or disable CommandManager's automatic requery on this command
    /// </summary>
    public bool IsAutomaticRequeryDisabled
    {
        get
        {
            return this._isAutomaticRequeryDisabled;
        }
        set
        {
            if (this._isAutomaticRequeryDisabled != value)
            {
                if (value)
                {
                    CommandManagerHelper.RemoveHandlersFromRequerySuggested(this._canExecuteChangedHandlers);
                }
                else
                {
                    CommandManagerHelper.AddHandlersToRequerySuggested(this._canExecuteChangedHandlers);
                }
                this._isAutomaticRequeryDisabled = value;
            }
        }
    }

    /// <summary>
    ///     Raises the CanExecuteChaged event
    /// </summary>
    public void RaiseCanExecuteChanged()
    {
        this.OnCanExecuteChanged();
    }

    /// <summary>
    ///     Protected virtual method to raise CanExecuteChanged event
    /// </summary>
    protected virtual void OnCanExecuteChanged()
    {
        CommandManagerHelper.CallWeakReferenceHandlers(this._canExecuteChangedHandlers);
    }

    #endregion

    #region ICommand Members

    /// <summary>
    ///     ICommand.CanExecuteChanged implementation
    /// </summary>
    public event EventHandler CanExecuteChanged
    {
        add
        {
            if (!this._isAutomaticRequeryDisabled)
            {
                CommandManager.RequerySuggested += value;
            }
            CommandManagerHelper.AddWeakReferenceHandler(ref this._canExecuteChangedHandlers, value, 2);
        }
        remove
        {
            if (!this._isAutomaticRequeryDisabled)
            {
                CommandManager.RequerySuggested -= value;
            }
            CommandManagerHelper.RemoveWeakReferenceHandler(this._canExecuteChangedHandlers, value);
        }
    }

    bool ICommand.CanExecute(object parameter)
    {
        return this.CanExecute();
    }

    void ICommand.Execute(object parameter)
    {
        this.Execute();
    }

    #endregion

    #region Data

    private readonly Action _executeMethod;
    private readonly Func<bool> _canExecuteMethod;
    private bool _isAutomaticRequeryDisabled;
    private List<WeakReference> _canExecuteChangedHandlers;

    #endregion
} 
```

和 CommandManager：

```
 internal class CommandManagerHelper
{
    internal static void CallWeakReferenceHandlers(List<WeakReference> handlers)
    {
        if (handlers != null)
        {
            // Take a snapshot of the handlers before we call out to them since the handlers
            // could cause the array to me modified while we are reading it.

            EventHandler[] callees = new EventHandler[handlers.Count];
            int count = 0;

            for (int i = handlers.Count - 1; i >= 0; i--)
            {
                WeakReference reference = handlers[i];
                EventHandler handler = reference.Target as EventHandler;
                if (handler == null)
                {
                    // Clean up old handlers that have been collected
                    handlers.RemoveAt(i);
                }
                else
                {
                    callees[count] = handler;
                    count++;
                }
            }

            // Call the handlers that we snapshotted
            for (int i = 0; i < count; i++)
            {
                EventHandler handler = callees[i];
                handler(null, EventArgs.Empty);
            }
        }
    }

    internal static void AddHandlersToRequerySuggested(List<WeakReference> handlers)
    {
        if (handlers != null)
        {
            foreach (WeakReference handlerRef in handlers)
            {
                EventHandler handler = handlerRef.Target as EventHandler;
                if (handler != null)
                {
                    CommandManager.RequerySuggested += handler;
                }
            }
        }
    }

    internal static void RemoveHandlersFromRequerySuggested(List<WeakReference> handlers)
    {
        if (handlers != null)
        {
            foreach (WeakReference handlerRef in handlers)
            {
                EventHandler handler = handlerRef.Target as EventHandler;
                if (handler != null)
                {
                    CommandManager.RequerySuggested -= handler;
                }
            }
        }
    }

    internal static void AddWeakReferenceHandler(ref List<WeakReference> handlers, EventHandler handler)
    {
        AddWeakReferenceHandler(ref handlers, handler, -1);
    }

    internal static void AddWeakReferenceHandler(ref List<WeakReference> handlers, EventHandler handler, int defaultListSize)
    {
        if (handlers == null)
        {
            handlers = (defaultListSize > 0 ? new List<WeakReference>(defaultListSize) : new List<WeakReference>());
        }

        handlers.Add(new WeakReference(handler));
    }

    internal static void RemoveWeakReferenceHandler(List<WeakReference> handlers, EventHandler handler)
    {
        if (handlers != null)
        {
            for (int i = handlers.Count - 1; i >= 0; i--)
            {
                WeakReference reference = handlers[i];
                EventHandler existingHandler = reference.Target as EventHandler;
                if ((existingHandler == null) || (existingHandler == handler))
                {
                    // Clean up old handlers that have been collected
                    // in addition to the handler that is to be removed.
                    handlers.RemoveAt(i);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:11:44.497

I have fixed this by calling CommandManager.InvalidateRequerySuggested() in the _backgroundWorker_RunWorkerCompleted method. I think this is somehow related to the fact that the CanExecuteChanged event is being fired outside the UI Thread. If you are working with a single Dispatcher, you could try changing your ICommand implementation to marshal the calls to CanExecuteChanged to the dispatcher

# c++ - 针对不同的子类值在 Main 上调用排序

> ID：13147899
> 
> 赞同：0
> 
> 时间：2012-10-30T21:34:13.650
> 
> 标签：c++

我有这个父类电话

```
Shape (ShapeTwoD.cpp) 
```

他有2个儿童班

```
1 is Rectangle (Rectangle.cpp)
1 is Square (Square.cpp) 
```

这个变量调用区域在 Rectangle 和 Square 声明，但不在 Shape(父)

所以我试图按区域升序排序，但是区域可以通过

```
class->getArea();

vector<ShapeTwoD*> myVector; 
```

//在记录形状的宽度，高度等数据期间。

```
myVector[arrayCount] = new Rectangle();
myVector[arrayCount].setWidth(inWidth);
myVector[arrayCount].setHeight(inHeight);
myVector[arrayCount].computeArea(); 
```

数组计数++；

```
//done record width , height and then compute area of the shape 
```

假设 myVector 现在包含大约 2 个矩形和 1 个正方形

现在我想按区域升序对它们进行排序。

但是我的 getArea() 函数仅在子类中可用。

如果我尝试这样做

```
sort(myVector.begin(),myVector.end(),funcAreaSort); 
```

我不确定在哪里创建 funcAreaSort ，接下来是我如何发送子区域，假设它们是相同的形状类（矩形对矩形）或不同的形状类（矩形对形状）

我如何创建一个可以通过 getArea() 进行比较的布尔运算符重载，然后查看哪个更好 return a.getArea() > b.getArea() 并对 myVector 进行排序

问题是我在哪里创建那些我想在 main.cpp 使其成为免费方法的函数，但是我无法对事物进行排序并编译时出现诸如限定符错误之类的错误

```
error: passing 'const shapeTwoD' as 'this' argument of 'virtual double shapeTwoD::getArea()' discards qualifers.
error: passing 'const shapeTwoD' as 'this' argument of 'virtual double shapeTwoD::getArea()' discards qualifers. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:37:43.303

1）使比较函数`ShapeTwoD*`作为参数，并`virtual` `getArea`在基类中有一个方法，您可以在子类中覆盖该方法。

2）制作方法`getArea` `const`：

```
int getArea() const; 
```

因为它在逻辑上是有意义的，所以你可以在`const`对象上调用它。

# multithreading - Tomcat 没有通过使用 ExecutorService 的线程化 GWT 应用程序正确关闭

> ID：13147902
> 
> 赞同：1
> 
> 时间：2012-10-30T21:34:24.400
> 
> 标签：multithreading, gwt, tomcat, memory-leaks

我在使用两个 SingleThreadExecutor 线程和一个 FixedThreadPool 的 Google Web Toolkit 应用程序时遇到问题。我可以从 catalina.out 日志中看到线程没有被正确关闭，这导致 tomcat 进程继续运行：

```
INFO: Stopping service Catalina
Oct 30, 2012 2:16:48 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/btq] appears to have started a thread named [pool-4-thread-1] but has failed to stop it. This is very likely to create a memory leak.
Oct 30, 2012 2:16:48 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/btq] appears to have started a thread named [pool-5-thread-1] but has failed to stop it. This is very likely to create a memory leak.
Oct 30, 2012 2:16:48 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/btq] appears to have started a thread named [Thread-4] but has failed to stop it. This is very likely to create a memory leak. 
```

我找到了一些关于使用 ServletContextListener 来处理这种事情的参考，但是我在让它在我的情况下工作时遇到了问题。

在一次尝试中，我将 ServletContextListener 添加到我的 GUIImpl 类中，该类是 GWT 代码的服务器端实现：

```
public class GUIImpl extends RemoteServiceServlet implements GUI, ServletContextListener 
```

我想这可能不是通常的方式，但我尝试这样做是因为实例化 ExecutorService 的类位于另一个包中，该包包含与其他项目的一些共享代码。我的实现只是在其他类上调用了一些关闭函数，但我遇到了一些异常。

```
 @Override
public void contextDestroyed(ServletContextEvent event) {

    this.context = event.getServletContext();
    context.log( "FUNCTION: GUIImpl.contextDestroyed - called" );

    // Tell the Presenter to shut down
    presenter.shutdown();
} 
```

Presenter 类有一个 FileSystemMonitor 类的实例，它是实例化 Executor 的类。日志中的异常是：

```
Oct 30, 2012 2:16:48 PM org.apache.catalina.core.ApplicationContext log
INFO: FUNCTION: GUIImpl.contextDestroyed - called
Oct 30, 2012 2:16:48 PM org.apache.catalina.core.StandardContext listenerStop
SEVERE: Exception sending context destroyed event to listener instance of class com.mdaus.btq.gui.server.GUIImpl
java.lang.NullPointerException
  at com.mdaus.btq.gui.server.GUIImpl.contextDestroyed(GUIImpl.java:1236)
  at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4831)
  at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5478)
  at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)
  at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1575)
  at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1564)
  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
  at java.util.concurrent.FutureTask.run(FutureTask.java:166)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
  at java.lang.Thread.run(Thread.java:722)

Oct 30, 2012 2:16:48 PM org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextDestroyed()
Oct 30, 2012 2:16:48 PM org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextDestroyed() 
```

对不起，如果这个问题有点长而且令人困惑，但我现在有点困惑，因为我没有编写原始代码。

有人对我如何关闭这些线程有想法吗？

# php - php用数字键合并2个多维数组，删除重复项

> ID：13147903
> 
> 赞同：0
> 
> 时间：2012-10-30T21:34:37.550
> 
> 标签：php, arrays, sorting

给定这个数组：

```
Array
(
[0] => Array
    (
        [title] => this is the newest post
        [ssm_featured_post_id] => 70
    )

[1] => Array
    (
        [title] => sdfsfsdf
        [ssm_featured_post_id] => 63
    )

[2] => Array
    (
        [title] => test
        [ssm_featured_post_id] => 49
    )

[3] => Array
    (
        [title] => Hello world!
        [ssm_featured_post_id] => 1
    )

) 
```

将另一个类似数组与新值合并的最直接方法是什么。

第二个数组可能有新项目或已删除项目。

我想保留第一个数组中项目的顺序并将任何新项目添加到最后，并删除不在新数组中的所有项目

```
Array
(
[0] => Array
    (
        [title] => sdfsfsdf
        [ssm_featured_post_id] => 63
    )

[1] => Array
    (
        [title] => this is the newest post
        [ssm_featured_post_id] => 70
    )

[2] => Array
    (
        [title] => test
        [ssm_featured_post_id] => 49
    )

[3] => Array
    (

        [title] => Hello world!
        [ssm_featured_post_id] => 1
    )

[4] => Array
    (
        [title] => awesome post
        [ssm_featured_post_id] => 73
    )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:42:07.577

您可以使用功能[uasort](http://www.php.net/manual/en/function.uasort.php)允许您实现自己的比较功能

```
function cmp($a, $b) {
    if ($a['ssm_featured_post_id'] == $b['ssm_featured_post_id']) {
        return 0;
    }
    return ($a['ssm_featured_post_id'] < $b['ssm_featured_post_id']) ? -1 : 1; 
}

uasort($array, 'cmp'); 
```

为了删除重复的项目，通过传递数组扫描重复的项目

```
$last_id=-1;
for($i=0; $i < cout($array); $i++){
  if($last_id==$array[$i]['ssm_featured_post_id']){
    unset($array[$i]);//Remove Duplicated Item
  }
  $last_id=$array[$i]['ssm_featured_post_id'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T00:34:21.293

好吧，因为我需要检查数组 2 和数组 1 并合并数组 2 中的任何新内容，所以这个解决方案似乎有效：

```
$new_values = array_merge( $slides, $featured_posts );
$new_values = array_unique( $new_values, SORT_REGULAR ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:40:45.320

使用 array_merge 因为键是数字的。“如果输入数组具有相同的字符串键，则该键的后一个值将覆盖前一个。但是，如果数组包含数字键，则后一个值不会覆盖原始值” [http://php.网络/手册/en/function.array-merge.php](http://php.net/manual/en/function.array-merge.php)

# c++ - Linker error while compiling mongo db client example on Windows

> ID：13147907
> 
> 赞同：2
> 
> 时间：2012-10-30T21:35:02.570
> 
> 标签：c++, visual-studio, mongodb, boost

I have a linker problem while compiling mongo db client example on Windows. I'm using Visual Studio 2012\.

I'm trying to compile [src\mongo\client\examples\clientTest.cpp](https://github.com/mongodb/mongo/blob/master/src/mongo/client/examples/clientTest.cpp) from mongo's git.

I did following steps:

*   Built Boost v1.51 using bjam2\. I'm using it on another project so I know binaries are good.
*   Built MongoDB C++ driver as `scons --dd mongoclient.lib`
*   Included boost include directory in my project as an Additional Include Directory.
*   Define _CRT_SECURE_NO_WARNINGS to avoid warnings on use of strncpy and such by the MongoDB client code.
*   Include the boost (binary) libraries directory to the project.

Still, I get following errors

```
1>mongoclient.lib(log.obj) : error LNK2019: unresolved external symbol "void __cdecl boost::filesystem3::path_traits::convert(char const *,char const *,class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > &,class std::codecvt<wchar_t,char,int> const &)" (?convert@path_traits@filesystem3@boost@@YAXPBD0AAV?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@std@@ABV?$codecvt@_WDH@5@@Z) referenced in function "void __cdecl boost::filesystem3::path_traits::dispatch<class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > >(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > &,class std::codecvt<wchar_t,char,int> const &)" (??$dispatch@V?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@std@@@path_traits@filesystem3@boost@@YAXABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AAV?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@4@ABV?$codecvt@_WDH@4@@Z)
1>mongoclient.lib(log.obj) : error LNK2019: unresolved external symbol "private: static class std::codecvt<wchar_t,char,int> const * & __cdecl boost::filesystem3::path::wchar_t_codecvt_facet(void)" (?wchar_t_codecvt_facet@path@filesystem3@boost@@CAAAPBV?$codecvt@_WDH@std@@XZ) referenced in function "public: static class std::codecvt<wchar_t,char,int> const & __cdecl boost::filesystem3::path::codecvt(void)" (?codecvt@path@filesystem3@boost@@SAABV?$codecvt@_WDH@std@@XZ)
1>mongoclient.lib(log.obj) : error LNK2019: unresolved external symbol "class boost::filesystem3::file_status __cdecl boost::filesystem3::detail::status(class boost::filesystem3::path const &,class boost::system::error_code *)" (?status@detail@filesystem3@boost@@YA?AVfile_status@23@ABVpath@23@PAVerror_code@system@3@@Z) referenced in function "bool __cdecl boost::filesystem3::exists(class boost::filesystem3::path const &)" (?exists@filesystem3@boost@@YA_NABVpath@12@@Z)
1>mongoclient.lib(background.obj) : error LNK2019: unresolved external symbol "public: __thiscall boost::thread::~thread(void)" (??1thread@boost@@QAE@XZ) referenced in function "public: class mongo::BackgroundJob & __thiscall mongo::BackgroundJob::go(void)" (?go@BackgroundJob@mongo@@QAEAAV12@XZ) 
```

So it looks like it ignores `#pragma comment lib` directives in boost's headers.

I tried explicitly adding `libboost_thread-vc110-mt-sgd-1_51.lib` in `Linker/Input` tab of project settings. It didn't help.

I tried specifying `#pragma comment(lib, "libboost_thread-vc110-mt-sgd-1_51.lib")` in main cpp file of the example. It didn't help either.

But! Adding

```
#include <boost/thread/thread.hpp> 
```

**and**

```
boost::thread _thrd(&Func);
_thrd.join(); 
```

at the beginning of clientTest.cpp helped to get rid of error about missing boost::thread::~thread(void). Looks like it forced linker to link to thread's lib binary.

Unfortunately repeating this trick with `<boost/filesystem.hpp>` didn't help :(

I also [made sure](https://stackoverflow.com/a/4763452/226895) that all LIB files, of Boost and Mongo client, are compiled for 32-bit target using `dumpbin.exe`.

What else could it be guys ?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:45:29.913

Looks like my messages to mongo-dev mailing list don't reach the destination. Perhaps it's premoderated.

But I managed to make it work via a bit hacky solution because I never used Scons before.

Core of the problem was that mongo is prebundled with Boost 1.49 and I have Boost 1.51 installed in my system. I was trying to compile sample against boost 1.51 while mongo was compiled with 1.49 therefore mismatch of certain classes/methods.

I built library by calling

`scons -j4 --dd --use-system-boost mongoclient.lib`

Also I modified `SConstruct` script. Find line `elif "win32" == os.sys.platform:`. In this section I added

`env.Append( EXTRACPPPATH=[ "C:/work/externals/boost_1_51_0" ] )`

to specify additional "system" folder.

Also I had to disable existence check of boost binary libraries which looked like

```
 for b in boostLibs:
        l = "boost_" + b
        if not conf.CheckLib([ l + boostCompiler + "-mt" + boostVersion,
                               l + boostCompiler + boostVersion ], language='C++' ):
            Exit(1) 
```

because naming of my libraries is very different.

Of course it doesn't cover situation when boost is dynamically compiled with MSVC libraries.

I hope Mongo team or somebody who knows Scons well will modify build script to

*   Allow to specify path to system boost library
*   Allow building dynamically linked libraries for MSVC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-03T11:28:44.587

Solution for **Mac OS**

I know this is not a place to post the answer for **Mac OS**. But, I was struggling for a couple of days solving the msgasserted linker error and finally got it to work...

`mmacosx-version-min=10.5` should be added to the command line.

```
g++ -m64 -I/Users/accessmac/mgoclient/include -L/Users/accessmac/mgoclient/lib second.cpp -lboost_system-mt -lboost_program_options-mt -lboost_filesystem-mt -lboost_thread-mt -lmongoclient  -mmacosx-version-min=10.5 -o second 
```

compiles and produces second

# ruby-on-rails-3 - 特定领域的 Mongoid 观察者？

> ID：13147909
> 
> 赞同：1
> 
> 时间：2012-10-30T21:35:17.767
> 
> 标签：ruby-on-rails-3, mongoid

在模型中，我知道您可以将回调分配给特定字段（即`value1`），如下所示：

```
after_save :run_callback_1, :if => :value1_changed? 
```

这会发生在观察者中吗，所以如果`user.value1`改变了就会调用它？或者如果`value1`多个模型发生了变化？

```
class UserObserver < Mongoid::Observer

  def after_save(record)
    logger.debug "HERE"
  end

end 
```

# date - 应用引擎数据存储实现

> ID：13147912
> 
> 赞同：1
> 
> 时间：2012-10-30T21:35:23.100
> 
> 标签：date, google-app-engine, time, google-cloud-datastore

我正在 appengine 中制作一个系统，但找不到在数据存储区中实现此功能的正确方法。我可以在普通的关系数据库中这样做，但就是无法理解这一点。

数据存储区中是一个实体，该实体每天都有“关闭”和“打开”时间。

到目前为止，这一切都很容易，但是：有时一天内可能会有 2 次“打开”和“关闭”时间。

任何人都可以就正确的实施提供一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:08:54.103

由于您没有指定您使用的是 Java、Python 还是 Go，所以我将给您一个 Python 示例，但一般概念可以在任何一个中实现。

Python 具有包含“重复”属性标志的 NDB API（比 DB API 更新）：[https ://developers.google.com/appengine/docs/python/ndb/properties#repeated](https://developers.google.com/appengine/docs/python/ndb/properties#repeated)

当您重复某个属性时，“该属性采用基础类型的值列表，而不是单个值。”，因此您可以指定多个打开和关闭时间。

当您检索特定日期的信息时，您可以循环浏览列表以查看您处理此信息的时间是否介于打开/关闭窗口之一之间。如果找到一个打开/关闭，则中断循环并处理请求。

我强烈推荐的一件事是跟踪打开/关闭对并消除与验证的任何重叠。这将使您的处理更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T06:56:52.853

您可以创建一个模型来保存每对开闭日期，让我们将其命名为`WorkingPeriod`。然后，在您的主要实体中，您可以拥有嵌入`WorkingPeriod`值列表或`Key`指向`WorkingPeriod`实体的列表。这取决于哪种方法最适合您的需求。

希望这可以帮助！

# python - 如何使用 Python Requests 模块模拟 HTTP 发布请求？

> ID：13147914
> 
> 赞同：24
> 
> 时间：2012-10-30T21:35:32.290
> 
> 标签：python, forms, post, python-requests

[这](http://docs.python-requests.org/en/latest/)是我正在尝试使用的模块，并且有一个我正在尝试自动填写的表格。我想使用 Requests over Mechanize 的原因是因为使用 Mechanize，我必须先加载登录页面，然后才能填写并提交，而使用 Requests，我可以跳过加载阶段并直接发布消息（希望）。基本上，我试图让登录过程消耗尽可能少的带宽。

我的第二个问题是，在登录过程和重定向之后，是否可以不完全下载整个页面，而只检索页面标题？基本上，仅标题就会告诉我登录是否成功，所以我想尽量减少带宽使用。

当涉及到 HTTP 请求和诸如此类的东西时，我是一个菜鸟，所以任何帮助将不胜感激。仅供参考，这是一个学校项目。

**编辑**问题的第一部分已经回答。我现在的问题是第二部分

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-30T21:51:41.080

一些示例代码：

```
import requests

URL = 'https://www.yourlibrary.ca/account/index.cfm'
payload = {
    'barcode': 'your user name/login',
    'telephone_primary': 'your password',
    'persistent': '1'  # remember me
}

session = requests.session()
r = requests.post(URL, data=payload)
print r.cookies 
```

第一步是查看您的源页面并识别`form`正在提交的元素（使用 Firebug/Chrome/IE 工具（或仅查看源））。然后找到`input`元素并确定所需的`name`属性（见上文）。

您提供的 URL 恰好有一个“记住我”，虽然我没有尝试过（因为我不能），但这意味着它会在一段时间内发出 cookie 以避免进一步登录——cookie 被保留在`request.session`.

然后只是`session.get(someurl, ...)`用来检索页面等......

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-26T16:10:26.820

为了在请求 get 或 post 函数中使用身份验证，您只需提供`auth`参数。像这样：

`response = requests.get(url, auth = ('username', 'password'))` 有关更多详细信息，请参阅请求[身份验证文档](http://docs.python-requests.org/en/latest/user/authentication/)。

使用 Chrome 的开发人员工具，您可以检查包含您要填写和提交的表单的 html 页面的元素。有关如何完成此操作的说明，请访问[此处](https://superuser.com/questions/395919/where-is-the-post-tab-in-chrome-developer-tools-network)。您可以找到填充发布请求的数据参数所需的数据。如果您不担心验证您正在访问的站点的安全证书，那么您也可以在 get 参数列表中指定它。

如果您的 html 页面有这些元素可用于您的网络表单发布：

```
<textarea id="text" class="wikitext" name="text" cols="80" rows="20">
This is where your edited text will go
</textarea>
<input type="submit" id="save" name="save" value="Submit changes"> 
```

然后发布到这个表单的python代码如下：

```
import requests
from bs4 import BeautifulSoup

url = "http://www.someurl.com"

username = "your_username"
password = "your_password"

response = requests.get(url, auth=(username, password), verify=False)

# Getting the text of the page from the response data       
page = BeautifulSoup(response.text)

# Finding the text contained in a specific element, for instance, the 
# textarea element that contains the area where you would write a forum post
txt = page.find('textarea', id="text").string

# Finding the value of a specific attribute with name = "version" and 
# extracting the contents of the value attribute
tag = page.find('input', attrs = {'name':'version'})
ver = tag['value']

# Changing the text to whatever you want
txt = "Your text here, this will be what is written to the textarea for the post"

# construct the POST request
form_data = {
    'save' : 'Submit changes'
    'text' : txt
} 

post = requests.post(url,auth=(username, password),data=form_data,verify=False) 
```

# php - 在 PHP foreach 循环中实现链接

> ID：13147916
> 
> 赞同：1
> 
> 时间：2012-10-30T21:35:36.580
> 
> 标签：php, mysql

试图在我的 foreach 循环中实现链接。但是，无法使 $category 链接正常工作。任何指针？设法使链接适用于子类别，如下所示：

```
<?
$output = mysqli_query("SELECT * FROM bikes, bikeTypes WHERE bikes.model_id = bikeTypes.model_id");
$result = array();
while($row = mysqli_fetch_array($output))
{
   $result[$row['model']][] = $row;
}

foreach ($result as $category => $values) {
  echo "<li>".$category.'<ul>';
    foreach ($values as $value) {
      echo "<a href='details.php?id=" . $row['model_id'] . "'><li>" . $value['bikeName'] . "</a></li>";
    }
echo '</ul>';   
echo '</li>';
}
?> 
```

提前感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T21:38:05.830

HTML 标签的顺序不正确，首先是 li-tag，然后是 a-tag

```
 foreach ($values as $value) {
      echo "<li><a href='details.php?id=" . $row['model_id'] . "'>" . $value['bikeName'] . "</a></li>";
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T21:39:25.723

你的`a`和`li`标签是交织在一起的：

```
<a><li>...</a></li> 
```

这应该是：

```
<li><a>...</a></li> 
```

# java - 替换字符串中的一些字符

> ID：13147917
> 
> 赞同：-3
> 
> 时间：2012-10-30T21:35:44.427
> 
> 标签：java, string, replace, char

我正在我的 com 课上做一个作业，要求我创造一个命运之轮游戏。我目前正在研究`getDisplayedPhrase`我将解释的方法。因此，对于这个程序，我有一个随机短语，例如，
`"this is a question, thanks for helping!"`
我希望这个短语更改为
`"**** ** * ********, ****** *** *******!"`
这就是短语在他们猜测之前应该是什么样子。如您所见，我正在尝试仅更改字母，因此我创建了一个

```
private static final String alpha ="abcdefghijklmnopqrstuvwxyz" 
```

以避免任何标点符号。这是我到目前为止所拥有的：

```
public String getDisplayedPhrase() {
    for (int i = 0; i<secretPhrase.length(); i++){
        I don't know what to put here and what method to use???
                I'm thinking of using charAt() or indexOf()
    }
    return displayedPhrase;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T21:41:34.397

```
return secretPhrase.replaceAll("[a-zA-Z]","*") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T21:39:58.067

您可以使用 Character 类来确定字符是否为字母。

```
 String s = "this is a question, thanks for helping!";
            StringBuilder rep="";
            for(int i=0; i<s.length();i++){
                if(Character.isAlphabetic(s.charAt(i))){
                    rep.append("*");
                }
                else {
                    rep.append(s.charAt(i));
                }
            }
            System.out.println(rep); 
```

您还可以使用`String.replace()`和替换现有字符串而不是额外的新字符串

```
 for(int i=0; i<s.length();i++){
            if(Character.isAlphabetic(s.charAt(i))){
                s=s.replace(s.charAt(i), '*');
            }

        }
        System.out.println(s); 
```

输出：

```
**** ** * ********, ****** *** *******! 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T21:40:02.087

使用[`String.replaceAll(String regex, String replacement)`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29). 既然是作业，我会让你研究正则表达式部分。

# c++ - 在 STL 向量数组中初始化类

> ID：13147935
> 
> 赞同：1
> 
> 时间：2012-10-30T21:37:24.210
> 
> 标签：c++, arrays, vector, c++11, initialization

我想知道是否可以在单个“行”内的向量数组中初始化一堆类。

```
class A {
     public:
         A(int k) {...}
};

[...]

#include <array>
#include <vector>
using namespace std;

array<vector<A>, 3> = { { A(5), A(6) }, { A(1), A(2), A(3) }, { } }; 
```

正如您可以想象的那样，此解决方案不起作用（否则我不会在这里！）。最快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:45:14.807

这样做，无需重复提及`A`：

```
array<std::vector<A>, 3> v{{ {1}, {2,3,4}, {} }}; 
```

如果构造函数采用两个参数，您可以将它们写在大括号内：

```
array<std::vector<A2>, 3> v2{{ {{1,2}}, {{2,3},{4,5},{8,9}}, {} }}; 
```

我可能更喜欢下面的语法，如果构造函数是显式的，它也可以工作。

```
std::array<std::vector<A2>, 3> v2{{ {A2{1,2}}, {A2{2,3},A2{4,5},A2{8,9}}, {} }}; 
```

完整示例：

```
#include <array>
#include <vector>
#include <iostream>

struct A2 {
  A2(int k,int j) : mk(k),mj(j) {}
  int mk;
  int mj;
};

int main (){
  std::array<std::vector<A2>, 3> v2{{ {{1,2}}, {{2,3},{4,5},{8,9}}, {} }};  
  int i=0;
  for (auto &a : v2){
    std::cout << "... " << i++ <<std::endl;
    for (auto &b : a){
      std::cout << b.mk << " " <<b.mj <<std::endl;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:43:12.570

我认为应该允许这样做：

```
#include <array>
#include <vector>
using namespace std;

class A {
     public:
         A(int k) {}
};

array<vector<A>, 3> v = { vector<A>{5, 6}, vector<A>{1, 2, 3}, vector<A>{} }; 
```

在快速测试中，g++ 4.7.1 似乎同意。

# ios - iOS 上的视频格式

> ID：13147938
> 
> 赞同：-1
> 
> 时间：2012-10-30T21:37:54.667
> 
> 标签：ios, video, video-capture, video-processing, mov

我刚刚开始从事一个项目，我需要从 iOS 客户端设备压缩视频并将其发送到服务器。

在 iPhone 4 上进行一些测试时，原生相机应用程序使用 .MOV 格式的视频，1 分钟的录制几乎是 100MB。

这完全不适合我通过 wifi 或 3G 发送。

如果视频质量不是那么重要，我有什么选择。获得中等质量、小尺寸、更长的录制时间，并能够在可解析的时间内通过网络传输。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:43:33.570

使用 AVFoundation 框架录制视频并设置合适的会话预设，例如`AVCaptureSessionPresetMedium`或`AVCaptureSessionPresetLow`适合通过 3G 共享的会话预设。

# assembly - RPL 是从哪里来的？

> ID：13147942
> 
> 赞同：1
> 
> 时间：2012-10-30T21:38:09.217
> 
> 标签：assembly, protection, privilege, x86

我从许多不同的网站上阅读过，我有点困惑，但我不清楚：

> 每个段寄存器都有可见部分和不可见部分。可见部分称为段选择器，并且有直接指令来加载段选择器。
> 
> 请求者特权级别（RPL）：该字段标识特权级别以提供对数据的受保护访问。

好的，我知道我可以在汇编中使用指令，例如，加载选择器，但我不能修改 RPL 对吗？它从何而来？CPU是怎么选的？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T22:20:12.703

RPL实际上只是段选择器的最低2位，因此您可以将任何您想要的特权级别（0-3）加载到其中，但是如果请求的级别高于（在数字上低于）相应段的DPL，你会得到一个全科医生的错误。如果这与内存映射 I/O 或其他相关，这允许程序轻松访问比操作系统授予的权限更少的段。

# php - 在 PHP 中创建具有任意行数的 HTML 表

> ID：13147944
> 
> 赞同：1
> 
> 时间：2012-10-30T21:38:14.610
> 
> 标签：php, html

我对 PHP 知之甚少，因此决定创建一个用于生成 Red Hat kickstart 文件的基于 Web 的工具将是一个很好的学习项目。除其他外，该工具将解析 CSV 文件并生成包含从中获取的数据的表格。输入文件格式如下：

```
主机1,10.153.196.248,255.255.255.0,10.153.196.1,00:50:56:ac:69:cb
,10.153.157.113,255.255.255.128,10.153.157.1,
,10.153.157.241,255.255.255.128,10.153.157.129,
,/家,10,,,
,交换,10,,,
,/opt,60,,,
,/数据,30,,,
,,,,,
主机2,10.153.155.124,255.255.255.128,10.153.155.1,00:50:56:ac:69:ce
,10.153.157.114,255.255.255.128,10.153.157.1,
,10.153.157.242,255.255.255.128,10.153.157.129,
,/家,10,,,
,交换,10,,,
,/opt,60,,,
,/数据,30,,,
,,,,,

```

每个文本部分代表一个服务器的信息。字段如下：

```
主机名、eth0 IP、eth0 网络掩码、eth0 网关、eth4 MAC
空，eth1 IP，eth1 网络掩码，eth1 网关，空
空白，eth2 IP，eth2 网络掩码，eth2 网关，空
null，分区名称，分区大小（GB），null，null
null，分区名称，分区大小（GB），null，null
null，分区名称，分区大小（GB），null，null
null，分区名称，分区大小（GB），null，null
空，空，空，空，空

```

目前，我可以解析它并生成一个表格，输入文件中的每一行都是表格中的一行。处理这个的函数：

```
function processFile($workFile) {

    if (file_exists($workFile)) {
        print '<table>';
        $fh = fopen("$workFile", 'rb');
        if ($fh) {
            for ($line = fgets($fh); !feof($fh); $line = fgets($fh)) {
                $line = trim($line);
                $info = explode(',', $line);
                print '<tr><td>' . $info[0] . '</td><td>' . $info[1] . '</td><td>' . $info[2] . '</td><td>' . $info[3] . '</td></tr>';
            }
        } else {
            print "Failed to open $workFile";
        }
        print '</table>';
    } else {
        print "File $workFile does not exist";
    }

} 
```

生成：

```
host1 eth0 IP eth0 网络掩码 eth0 网关
          eth1 IP eth1 网络掩码 eth1 网关
          eth2 IP eth2 网络掩码 eth2 网关
          分区 1 分区 1 大小
          分区 2 分区 2 大小
          分区 3 分区 3 大小
          分区 4 分区 4 大小
host2 eth0 IP eth0 网络掩码 eth0 网关
          eth1 IP eth1 网络掩码 eth1 网关
          eth2 IP eth2 网络掩码 eth2 网关
          分区 1 分区 1 大小
          分区 2 分区 2 大小
          分区 3 分区 3 大小
          分区 4 分区 4 大小

```

这是一个开始。然而，并不是每台服务器都会有四个分区。有些人会有更多，有些人会少一两个。并且不提前知道这些信息会阻碍我想要做的事情，即在每个服务器的分区信息下方添加一行，并可能将每个服务器分解成自己的表。类似这样的东西：

```
host1 eth0 IP eth0 网络掩码 eth0 网关
          eth1 IP eth1 网络掩码 eth1 网关
          eth2 IP eth2 网络掩码 eth2 网关
          分区 1 分区 1 大小
          分区 2 分区 2 大小
          分区 3 分区 3 大小
          分区 4 分区 4 大小
          分区 5 分区 5 大小
          分区 6 分区 6 大小
          多少个磁盘？[文本域}    

host2 eth0 IP eth0 网络掩码 eth0 网关
          eth1 IP eth1 网络掩码 eth1 网关
          eth2 IP eth2 网络掩码 eth2 网关
          分区 1 分区 1 大小
          分区 2 分区 2 大小
          分区 3 分区 3 大小
          分区 4 分区 4 大小
          多少个磁盘？[文本域}

```

我的普遍想法是，我必须在 CSV 文件中有一个字段表明该行包含分区信息。这似乎是最简单的方法。不过，我想知道是否还有其他方法可以使用，不需要更改输入文件的格式。

我还必须弄清楚如何使用包含所有空字段的行作为节分隔符。

任何关于我如何解决这个问题的想法都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:26:24.237

```
echo('<table>');
$i = 0;
while($data = fgetcsv($fh)) {
    echo('<tr>');
    $cellTag = 'td';
    if($i == 0) {
        $cellTag = 'th';
    }
    $i++;
    foreach($data as $cell) {
        echo('<'.$cellTag.'>'.$cell.'</'.$cellTag.'>');
    }
    echo('</tr>');
}
echo('</table>'); 
```

试试看。让我知道它是否第一次不起作用。我已经测试过了，但我手头没有 CSV 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:33:33.527

当您解析应该匹配特定格式的数据时，它本质上应该是正则的，允许您使用正则表达式来严格匹配您想要的输入（并丢弃您不想要的输入）：

```
$rows = explode("\n", $input);

// @link http://stackoverflow.com/questions/106179/regular-expression-to-match-hostname-or-ip-address
$regIp = "(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])";
$regHost = "(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])";

$hosts = array();
foreach ($rows as $row) {
  $matches = null;
  if (preg_match("/(?<host>$regHost),(?<ip>$regIp),(?<netmask>$regIp),(?<gateway>$regIp),(?<mac>.*)/", $row, $matches)) {
    $host = $matches['host'];
    $hosts[$host]['name'] = $matches['host'];
    $hosts[$host]['mac'] = $matches['mac'];
    $hosts[$host]['eth'][] = array(
      'ip'      => $matches['ip'],
      'netmask' => $matches['netmask'],
      'gateway' => $matches['gateway'],
    );
  } else if (preg_match("/,(?<ip>$regIp),(?<netmask>$regIp),(?<gateway>$regIp),/", $row, $matches)) {
    $hosts[$host]['eth'][] = array(
      'ip'      => $matches['ip'],
      'netmask' => $matches['netmask'],
      'gateway' => $matches['gateway'],
    );
  } else if (preg_match("/,(?<name>.+),(?<size>\d+),,,/", $row, $matches)) {
    $hosts[$host]['partition'][] = array(
      'name' => $matches['name'],
      'size' => $matches['size'],
    );
  } else if (preg_match("/,,,,,/", $row)) {
    // we already partition output array with value of `$host` variable.
    echo "Found terminating row\n"; 
  } else {
    echo "Unrecognised data on row: $row\n";
  }
}

var_export($hosts); 
```

由于我们处理的是 CSV 文件，因此也可以`$fields = str_getcsv($row)`在循环内部使用来获取包含每个字段的数组。然后需要计算数组有多少字段，有多少是空的，并验证每个字段包含什么。

直接在每个 CSV 行的字符串表示上使用正则表达式允许我们在单个表达式中严格匹配上述所有内容。`(?<var>...)`每个正则表达式的部分被命名为匹配项。使用 OP 提供的输入，上述脚本输出：

```
Found terminating row
Found terminating row
array (
  'host1' => 
  array (
    'name' => 'host1',
    'mac' => '00:50:56:ac:69:cb',
    'eth' => 
    array (
      0 => 
      array (
        'ip' => '10.153.196.248',
        'netmask' => '255.255.255.0',
        'gateway' => '10.153.196.1',
      ),
      1 => 
      array (
        'ip' => '10.153.157.113',
        'netmask' => '255.255.255.128',
        'gateway' => '10.153.157.1',
      ),
      2 => 
      array (
        'ip' => '10.153.157.241',
        'netmask' => '255.255.255.128',
        'gateway' => '10.153.157.129',
      ),
    ),
    'partition' => 
    array (
      0 => 
      array (
        'name' => '/home',
        'size' => '10',
      ),
      1 => 
      array (
        'name' => 'swap',
        'size' => '10',
      ),
      2 => 
      array (
        'name' => '/opt',
        'size' => '60',
      ),
      3 => 
      array (
        'name' => '/data',
        'size' => '30',
      ),
    ),
  ),
  'host2' => 
  array (
    'name' => 'host2',
    'mac' => '00:50:56:ac:69:ce',
    'eth' => 
    array (
      0 => 
      array (
        'ip' => '10.153.155.124',
        'netmask' => '255.255.255.128',
        'gateway' => '10.153.155.1',
      ),
      1 => 
      array (
        'ip' => '10.153.157.114',
        'netmask' => '255.255.255.128',
        'gateway' => '10.153.157.1',
      ),
      2 => 
      array (
        'ip' => '10.153.157.242',
        'netmask' => '255.255.255.128',
        'gateway' => '10.153.157.129',
      ),
    ),
    'partition' => 
    array (
      0 => 
      array (
        'name' => '/home',
        'size' => '10',
      ),
      1 => 
      array (
        'name' => 'swap',
        'size' => '10',
      ),
      2 => 
      array (
        'name' => '/opt',
        'size' => '60',
      ),
      3 => 
      array (
        'name' => '/data',
        'size' => '30',
      ),
    ),
  ),
) 
```

由于我们现在有一组正确结构化的数据，因此以所需的任何格式（即 HTML 表格）输出数据应该是微不足道的。

# ruby-on-rails - Rails 服务器流量因大量写入 MongoDB 而受阻

> ID：13147947
> 
> 赞同：1
> 
> 时间：2012-10-30T21:38:21.067
> 
> 标签：ruby-on-rails, mongodb, mongoid

我正在从 rails 控制台执行脚本；该脚本爬取 MySQL 数据库，创建约 50 万个 MongoDB 文档。

我注意到`rails server`在脚本运行时运行时，任何请求的响应都必须等待 MOPED 的数千行输出，例如：

```
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5b5"} update={"$set"=>{"questions.1.response"=>{"_id"=>"509043ec2c5f64685b62c5bd", "data"=>{"datepicker"=>"10/21/2011", "response"=>1319216400}, "comment"=>nil}}} flags=[] (0.0000ms)
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5b6"} update={"$set"=>{"questions.2.response"=>{"_id"=>"509043ec2c5f64685b62c5be", "data"=>{"response"=>"Morning"}, "comment"=>nil}}} flags=[] (0.0000ms)
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5b7"} update={"$set"=>{"questions.3.response"=>{"_id"=>"509043ec2c5f64685b62c5bf", "data"=>{"0"=>"yes", "1"=>"no", "2"=>"no", "3"=>"no"}, "comment"=>""}}} flags=[] (0.0000ms)
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5b8"} update={"$set"=>{"questions.4.response"=>{"_id"=>"509043ec2c5f64685b62c5c0", "data"=>{"response"=>"outdoor"}, "comment"=>""}}} flags=[] (0.0000ms)
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5b9"} update={"$set"=>{"questions.5.response"=>{"_id"=>"509043ec2c5f64685b62c5c1", "data"=>{"response"=>"5"}, "comment"=>nil}}} flags=[] (0.0000ms)
MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={"_id"=>"509043ec2c5f64685b62c5b3", "questions._id"=>"509043ec2c5f64685b62c5ba"} update={"$set"=>{"questions.6.response"=>{"_id"=>"509043ec2c5f64685b62c5c2", "data"=>{"response"=>"attest"}, "comment"=>nil}}} flags=[] (1.0002ms) 
```

如果我让脚本执行足够长的时间（运行 rails 服务器），任何 http 请求都会导致：

```
[2012-10-30 16:24:44] ERROR Java heap space
[2012-10-30 16:25:12] ERROR Java heap space
[2012-10-30 16:26:11] ERROR Java heap space 
```

所以，我的问题是：是否有防止这种行为的设置？另外，我是否应该期望在写入 MongoDB 时服务器流量会受到阻碍？

我正在使用*Mongoid*、*Rails 3.2*和*JRuby 1.7.0*、*MongoDB 2.2.0*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:11:58.477

MongoDB 只允许一次写入一个操作。这种写锁的范围因版本而异——它曾经是整个服务器，但在最近的版本中变得更细粒度。见[http://docs.mongodb.org/manual/faq/concurrency/](http://docs.mongodb.org/manual/faq/concurrency/)

也就是说，应该在每个`update`命令之后释放锁。因此，您的 Rails 服务器应该能够以与脚本中的单个更新命令相当的延迟来处理请求。如果不是，那么一定是发生了其他事情。

我建议安装[MMS](https://mms.10gen.com/)并查看锁定百分比和队列长度的图表，以了解由于写锁定而备份的内容如何。

# php - 减少 nginx 重写规则

> ID：13147948
> 
> 赞同：1
> 
> 时间：2012-10-30T21:38:23.797
> 
> 标签：php, regex, nginx

PHP MVC 风格的路由器通常处理这样的请求`index.php?route=one/two/three...`- 由正斜杠分隔的查询字符串为系统提供了一条可遵循的路线（例如文件夹 > 文件 > 功能，或公司 > 部门 > 程序 > 操作）。

一个示例请求是：

```
GET http://localdomain/user/profile/modify
  > /index.php?route=user/profile/modify
    > /user/profile.php
      > modify() 
```

考虑到所有这些，我编写了我的 nginx 服务器配置，如下所示：

```
set $i /index.php;
location ~ ^/([a-z0-9-]*)$                             { rewrite ^/([a-z0-9-]*)$                             $i?route=$1       last; }
location ~ ^/([a-z0-9-]*)/?([a-z0-9-]*)$               { rewrite ^/([a-z0-9-]*)/?([a-z0-9-]*)$               $i?route=$1/$2    last; }
location ~ ^/([a-z0-9-]*)/?([a-z0-9-]*)/?([a-z0-9-]*)$ { rewrite ^/([a-z0-9-]*)/?([a-z0-9-]*)/?([a-z0-9-]*)$ $i?route=$1/$2/$3 last; } 
```

正则表达式的最佳实践要求我将其更改为能够处理 1 个或多个参数的单行（可能通过使用中继器）。我的正则表达式知识有限，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:25:20.457

通过在字符组中添加斜杠，`index.php?route=` *无论文件夹结构有多长，*这都会发送任何请求：

```
location ~ ^/([a-z0-9\/-]*)$ { rewrite ^/([a-z0-9\/-]*)$ $i?route=$1 last; } 
```

它基本上适用于文件夹类型的请求，并且不会触发任何带有点的东西（例如`.php` `.html`等），因此`index.php`其他人是安全的。

# javascript - 跨浏览器兼容音频有哪些选项？

> ID：13147951
> 
> 赞同：6
> 
> 时间：2012-10-30T21:38:46.867
> 
> 标签：javascript, audio, cross-browser, mp3, ogg

我正在使用这个功能：

```
function playSound(file) {

MyAudio = new Audio(file);
MyAudio.play();

} 
```

不幸的是，我正在努力寻找一种适用于所有浏览器的文件类型。Mp3 适用于 Chrome、Safari、IE 但不适用于 FF 和 Opera，而 .ogg 文件似乎仅适用于 FF。

关于解决这个问题的任何建议？我认为没有办法以编程方式检测正在使用的浏览器然后播放适当的文件类型？任何建议/想法表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T22:10:00.427

令人沮丧的是，没有普遍可玩的类型。WAV 最接近，但它非常大并且在 IE9 中不受支持。您需要提供多种类型并选择浏览器可以播放的类型。

为此，请使用**特征检测**，而不是浏览器检测。每个浏览器支持的媒体类型会随着时间的推移而改变，所以你假设 Firefox 不能播放 MP3 的代码可能会在几年后过时，当 Mozilla 采用它时（在专利到期后）。使用[canPlayType](http://developer.mozilla.org/en-US/docs/DOM/HTMLMediaElement#Methods)，它指示是否支持给定格式：

```
var audio = new Audio();
if(audio.canPlayType("audio/mpeg") == "probably") {
    playSound("myMedia.mp3");
} else if(audio.canPlayType("audio/webm") == "probably") {
    playSound("myMedia.webm");
}
// do checks for other types... 
```

此外，如果您将音频标签编写为 HTML，则可以使用多个`<source>`标签，浏览器将播放它可以播放的第一个：

```
<audio controls="controls">
    <source src="mymedia.ogg" type="audio/ogg" />
    <source src="mymedia.mp3" type="audio/mpeg" />
    Update your browser! This sentence is fallback content for browsers that do not support the audio element at all.
</audio> 
```

如果您想测试 Ogg 音频支持，您可能需要专门测试 Ogg Vorbis。Ogg 是一种“容器”格式，[假设可以使用](https://en.wikipedia.org/wiki/Ogg#Ogg_codecs)除 Vorbis 和 Theora 之外的其他编解码器（例如，[Opus 格式](http://en.wikipedia.org/wiki/Opus_(audio_format))）。您可以像这样测试 Ogg Vorbis：

```
audio.canPlayType('audio/ogg; codecs="vorbis"') == "probably"; 
```

请注意，它`canPlayType`具有三个可能的返回值：

*   **“可能”** - 几乎可以肯定可以播放媒体类型
*   **“也许”** - 媒体类型*可能*是可播放的。这是当您询问浏览器中的一般 Ogg 支持是否具有对特定编解码器（即 Vorbis 和 Theora）的 Ogg 支持时返回的内容。Ogg 文件*可能*使用浏览器不支持的编解码器，因此如果不指定编解码器，浏览器只能猜测它*可能*能够播放它。
*   **""** *(空字符串)* - 媒体类型肯定是不可播放的

如果您真的想测试 ogg 支持，那么您可以测试非空字符串（即测试“可能”或“可能”），而不是测试“可能”，如下所示*：*

```
// test for *any* Ogg codecs
if(audio.canPlayType("audio/ogg") != "") {  
    playSound("myMedia.ogg");
} 
```

您应该测试您的媒体文件使用的任何特定编解码器，例如，`'audio/ogg; codecs="vorbis"'`用于 Vorbis。测试一般的 Ogg 支持不太可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:50:37.507

将 webm 用于 Chrome、Firefox 和 Opera + wav 用于 Firefox、IE、Safari 和 Opera。

HTML：

```
<audio id="audio"></audio> 
```

JS：

```
var src = "myvideoname";
var is_chrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

if (is_chrome) {
   $("#audio").attr('src', 'audio/' + src + '.webm')
}
else {
   $("#audio").attr('src', 'audio/' + src + '.wav')
} 
```

解释：
Javascript找出用户的浏览器，如果它是Chrome它服务`webm`，如果不是它使用`wav`

**注意：** 使用此代码，您只需要文件夹中具有相同名称的音频`webm`和音频。`wav``audio`

**注2：**代码需要jQuery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:45:48.587

好吧，请看这里：[jQuery Buzz 扩展](http://buzz.jaysalvat.com/)。没用过，听说应该没问题。它能够检查您的浏览器是否支持某种格式，非常简洁的功能。

# c# - 如何在 Visual Studio 中制作类似属性窗口的表单？

> ID：13147956
> 
> 赞同：0
> 
> 时间：2012-10-30T21:39:17.400
> 
> 标签：c#, winforms

我有`TreeView`对象，我需要选择一个时`node`，`treeview`在`form`明确的位置（属性`node`）中显示，当另一个`node`选择另一个时，`form`更改。当没有节点被选中时，`form`消失。`Form`仅包含`ListView`对象。我需要视觉工作室中的属性窗口之类的东西。

**我现在遇到的问题：**

`Form`随机出现在错误的位置，我需要将它显示在另一个的确定位置`form`。

每次鼠标按下事件后，出现一个新的`form`，但我需要只有一个`form`（或旧的消失 - 新的出现）

当没有选择节点时，`form`不会消失。

我该如何解决这个问题，或者也许有更好的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T21:42:16.693

我认为您正在寻找的是 PropertyGrid 控件。

[http://msdn.microsoft.com/en-us/library/aa302326.aspx](http://msdn.microsoft.com/en-us/library/aa302326.aspx)

这是一个非常深入和复杂的控制，但可以产生惊人的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:23:46.957

关于每次鼠标按下事件后，出现一个新表单，但我需要只有一个表单（或旧消失 - 新出现）我的解决方案：

给Form类添加一个静态变量Form frm；向 Form 类添加静态函数

```
//Create new form if not yet created
//Or return instance of opened form which can update by new parameters
public static Form Instance()
{
    if (Form.frm = null)
        Form.frm = new Form();
    return Form.frm;
} 
```

然后仅通过此静态函数创建所有新表单。如果要打开不同的 Form 实例，请为此静态函数创建重载函数。

当然记得在关闭表单上处理静态 Form.frm 对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:28:56.863

尝试使用这些代码来显示您的表单：

```
 private Form2 f2;    

private void button1_Click(object sender, EventArgs e)
{
    if (f2 == null) {
       f2 = new Form2();
       f2.FormClosed += delegate { f2 = null; };
       f2.Show();
    }
    else {
       f2.Activate();
    }
} 
```

# java - 使用 JAX-WS 提取整个 SOAP 消息

> ID：13147961
> 
> 赞同：1
> 
> 时间：2012-10-30T21:39:39.160
> 
> 标签：java, web-services, spring, soap, ejb

我有一个 EJB 无状态 bean Web 服务，并且想要访问整个 SOAP 消息，而不仅仅是我目前在参数中获取的 SOAP 正文。我想将消息提交到不同的组件。我使用的是 Spring 配置，但不是 Spring-WS。我遵循了本教程：

[http://java.dzone.com/articles/creating-soap-message-handlers](http://java.dzone.com/articles/creating-soap-message-handlers)

照原样，暂时没有做任何改变。它只记录 SOAP 消息。handleMessage() 没有被调用。

```
@Stateless
@WebService(portName = "XRequest_PortType", serviceName = "XRequestService", endpointInterface = "XRequestPortType")
@Addressing(enabled = true)
@HandlerChain(file = "LogMessage_handler.xml")
@Interceptors(SpringBeanAutowiringInterceptor.class)
public class XRequest_PortTypeWS implements
        XRequestPortType {
...} 
```

LogMessage_handler.xml 与教程略有不同，但我尝试了两种方式：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<javaee:handler-chains 
     xmlns:javaee="http://java.sun.com/xml/ns/javaee" 
     xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <javaee:handler-chain>
    <javaee:handler>
      <javaee:handler-class>com.test.ws.LogMessageHandle</javaee:handler-class>
    </javaee:handler>
  </javaee:handler-chain>
</javaee:handler-chains> 
```

日志消息处理程序：

```
package com.test.ws;

import java.io.IOException;
import java.util.Collections;
import java.util.Set;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.xml.namespace.QName;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPMessage;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;

/**
 * 
 * @author meerasubbarao
 */
public class LogMessageHandler implements SOAPHandler<SOAPMessageContext> {

    public boolean handleMessage(SOAPMessageContext messageContext) {
        log(messageContext);
        return true;

    }

    public Set<QName> getHeaders() {
        return Collections.EMPTY_SET;
    }

    public boolean handleFault(SOAPMessageContext messageContext) {
        return true;
    }

    public void close(MessageContext context) {
    }

    private void log(SOAPMessageContext messageContext) {
        SOAPMessage msg = messageContext.getMessage(); // Line 1
        try {
            msg.writeTo(System.out); // Line 3
        } catch (SOAPException ex) {
            Logger.getLogger(LogMessageHandler.class.getName()).log(
                    Level.SEVERE, null, ex);
        } catch (IOException ex) {
            Logger.getLogger(LogMessageHandler.class.getName()).log(
                    Level.SEVERE, null, ex);
        }
    }

} 
```

这甚至是获取整个 SOAP 消息的最佳方式吗？我仍然需要从 XRequest_PortTypeWS 调用 Spring bean 来发送 SOAP 消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:51:32.450

我检查了[http://java.dzone.com/articles/creating-soap-message-handlers](http://java.dzone.com/articles/creating-soap-message-handlers)中的文章 ，我注意到您没有在 LogMessage_handler.xml 中设置处理程序名称，更重要的是找到LogMessage_handler.xml 在 Web 服务 bean 所在的同一包中。还请将@Remote 注释添加到webservice bean。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T22:03:28.917

我确实使用了 SOAP 处理程序并且能够获得完整的 SOAP 消息。详细信息在另一个帖子中。

[将对象从 SOAP 处理程序发送到 Web 服务](https://stackoverflow.com/questions/13185428/sending-object-from-soap-handler-to-web-service/13886861#13886861)

# excel - 返回公式选择的 Excel 函数

> ID：13147964
> 
> 赞同：1
> 
> 时间：2012-10-30T21:39:56.567
> 
> 标签：excel, excel-formula, vba

我正在尝试编写一个 Excel VBA 函数，该函数将根据工作表中其他位置的全局设置返回两个输入参数之一作为它输入的单元格的公式。IE，在工作表的其他地方有人设置了 A 或 B，然后调用函数 AorB 的公式将根据全局设置返回 A 或 B。

像这样的东西：

```
Function AOrB(A As Variant, B As Variant) As Variant
    If someSetting = A Then
        AOrB.formula = A
    ElseIf someSetting = B Then
        AOrB.formula = B
    End If
End Function 
```

我已经大量搜索，但我只是不知道输入和返回什么类型以允许函数返回。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:26:38.827

从 UDF 更改公式不是一个好主意。这是可能的，但很复杂。

我相信执行您所解释的正确方法是通过公式中的 IF ：

```
=IF(someSetting = A, AFormula, If(someSetting = B,BFormula,"")) 
```

如果`someSetting`是您在代码中存储的内容，您可以创建一个 UDF 来检索该值。像这样：

```
Private mySetting As Variant
Function SomeSetting() As Variant
    SomeSetting = mySetting
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T22:28:57.170

为将保存全局设置的单元格命名，例如“ABChoice”。（您可以通过单击显示当前单元格位置的编辑栏左侧并输入所需名称来执行此操作）。

然后重写公式：

```
Function AOrB()
    If ThisWorkbook.Range("ABChoice") = "A" Then
        AOrB = "A"
    ElseIf ThisWorkbook.Range("ABChoice") = "B" Then
        AOrB = "B"
    Else
        AOrB = "A" 'could switch to B, whichever is the default
    End If
End Function 
```

您可以使用 Data Validation（在 Data 菜单下）来确保用户只能输入“A”或“B”，但使用最后的 Else 子句就没有必要了，假设您选择了默认状态。

这实际上与仅命名全局单元格并在以后的公式中引用它没有什么不同，这不需要 VBA。我假设您的功能在幕后有点复杂，这需要 UDF。如果没有，只需使用命名范围。

我实际上建议您使用 1 或 2 而不是“A”或“B”，因为当您需要引用全局设置时，您可以使用 CHOOSE 函数，它的语法比必须使用 IF 函数更简单。

# javascript - 在backbone.js 中未定义的变量

> ID：13147968
> 
> 赞同：0
> 
> 时间：2012-10-30T21:39:58.500
> 
> 标签：javascript, backbone.js

我最近在玩backbone.js 库时遇到了一些麻烦——即我实例化的变量（扩展视图和模型）仍未定义。

这里有一些代码向您展示我的意思：

```
<script type="text/javascript">
$(document).ready(function(){

var img = new ImageUrl();
var search = new ImageSearchDialogue({el: '.imageUrl', model: img}).render();

});
</script> 
```

这是我放置在 HTML 文档中的脚本 - 然而，这两个变量都未定义。（我已经检查过 Firebug）

这可能是一个范围界定问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:11:48.360

您是否期望全局定义变量？它们目前仅在函数范围内定义。试试这个：

```
window.img = new ImageUrl();
window.search = new ImageSearchDialogue({el: '.imageUrl', model: img}).render(); 
```

# ruby-on-rails - 在 mySQL 查询中获取结果时，Ruby 中的分页

> ID：13147972
> 
> 赞同：0
> 
> 时间：2012-10-30T21:40:18.907
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我使用以下查询在 Rails 控制器中获取一些行：

```
@main = connection.execute("SELECT code_ver, result FROM mastertest WHERE code_ver NOT LIKE '%DevBld%' AND date >= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;") 
```

现在在我的 index.html.erb（视图）中，我以表格的形式显示这些行。

但我想在我的 html 页面中有下一个和上一个按钮，这样它一次应该只显示几行。让我们一次假设一周的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:44:42.693

我使用了在[Rails 教程](http://ruby.railstutorial.org/)中学到的 will_paginate gem 。它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T01:18:21.417

对于分页，我会选择[Kaminari](https://github.com/amatsuda/kaminari)。

要获取第 7 页用户，每页 20 个：

```
User.page(7).per(20) 
```

更好的是，要在您的视图中获得漂亮的`First Prev 2 3 [4] 5 6 ... Next Last`链接，您所需要的只是：

```
<%= paginate @users %> 
```

# c# - 自定义 IPrincipal 过期问题

> ID：13147973
> 
> 赞同：1
> 
> 时间：2012-10-30T21:40:23.413
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-membership, iprincipal

我遵循了[this question](https://stackoverflow.com/questions/1064271/asp-net-mvc-set-custom-iidentity-or-iprincipal)关于如何实现自定义的建议`IPrincipal`（我需要将其存储`userId`在其中以减少对数据库的调用以获得公正`userId`）。
现在，如果我登录到站点并离开它大约 20 分钟，请不要在站点上执行任何操作并刷新页面，它会再次请求登录。

自定义实现的 IPrincipal 是否有一些过期时间，如果它有如何扩展它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:01:47.707

`IPrincipal`只是任何实现类必须遵守的合同。

超时确实取决于实现，但 ASP .NET 应用程序的一个重要考虑因素应该是 formsAuthentication 超时值。

[http://msdn.microsoft.com/en-us/library/system.web.configuration.formsauthenticationconfiguration.timeout.aspx](http://msdn.microsoft.com/en-us/library/system.web.configuration.formsauthenticationconfiguration.timeout.aspx)

这将是 ASP .NET 在没有用户输入的情况下保持会话打开的时间。之后，它将不保留有关已登录用户的任何信息。大多数 iPrincipal 实现依赖于`Context.User.Identity.Name`与数据库中的条目匹配。一旦达到 Forms Authentication 超时，该值（和`IsAuthenticated`== true ）状态就会丢失，从而导致请求单独登录。如果您只想简单地延长超时，请先尝试调整该值。

如果您正在寻找长期解决方案（即“让我保持登录”功能），最常见的方法是通过 cookie 向用户的浏览器发送一个令牌，该令牌会在随后访问该站点时进行检查。

通常这里的策略是：-

*   检查cookie
*   从 cookie 中提取令牌值
*   如果找到匹配的用户，自动登录用户并给他们一个 FormsAuthentication 票。

此处有关最佳实践的文章：-

[http://jaspan.com/improved_persistent_login_cookie_best_practice](http://jaspan.com/improved_persistent_login_cookie_best_practice)

# visual-studio-2012 - 有没有一种简单的方法可以直接跳转到文件中的方法？

> ID：13147974
> 
> 赞同：8
> 
> 时间：2012-10-30T21:40:31.840
> 
> 标签：visual-studio-2012

我刚刚安装了 Visual Studio 2012，并且很难在文件中导航。我想做的是在文件中输入一个或多个类、方法、字段或属性的字符，然后直接跳到该行。例如，如果我有代码：

```
public class Foo
{
   public void Bar()
   {

   }
} 
```

我希望能够按下键盘快捷键，输入“Ba”并直接跳转到类的`Bar`方法`Foo`。

在 VS2008 和 VS2010 中，我使用[USysWare 的 DPack](http://www.usysware.com/DPack/Default.aspx)`Alt`使用+`G`键盘快捷键来执行此操作。但是，似乎没有这个插件的 VS2012 版本，至少现在还没有。

我确实找到了`Ctrl`+`;`快捷键来搜索解决方案，这似乎可以很好地跳转到特定文件（类似于 DPack 的`Alt`+`U`快捷方式），但是我正在寻找可以在当前打开的文件中搜索代码的东西。

顺便说一句，我目前正在使用 VS2012 Express Edition，但是当我有时间下载并设置它时，我会升级到 VS2012 Pro。我相信这些版本之间存在一些细微差别，因此我对适用于其中一个或两个版本的答案感兴趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T22:16:11.707

所以这里是我在一些研究后发现的总结。

**[DPack for Visual Studio 2012](http://www.usysware.com/blog/?p=150)**：目前，它处于测试阶段，但运行良好。由于这是一个插件，**它不会在 Visual Studio 的 Express Edition 上运行**。

**Ctrl+F**：标准的`Ctrl`+`F`对话框在 Visual Studio 2012 中完全重新发明，更像是一种内联搜索，在您键入时在文档中跳转。它对于查找符号非常有用，但也可以在文档中查找任何匹配的文本，包括引用、字符串常量、注释等。出于这个原因，这可能不是快速跳转到符号的最佳方式。

**Ctrl+Comma**：这也是 VS2012 的新功能，但**在 Visual Studio Express Edition 中不可用**。这使您可以在解决方案中快速找到符号。它工作得相当好，但对于较大的项目，它可能是信息过载。

**Ctrl+分号**：解决方案资源管理器现在允许您使用`Ctrl`+`;`快捷键按文件名过滤。这使得查找文件变得快速和容易，但不会在当前文件中搜索符号。这更类似于[DPack](http://www.usysware.com/DPack/Default.aspx)的`Ctrl`+`U`功能。

**类视图搜索**：在类视图模式 ( `Ctrl`++ `Shift`)`C`中，您还可以在整个解决方案中搜索类名称或符号。但是，似乎没有使用此搜索的键盘快捷键，您也不能只搜索当前打开的文件。此外，您必须输入查询并按回车键以显示结果，而不仅仅是在键入时进行过滤。

**类/方法下拉**菜单：与以前版本的 Visual Studio 一样，代码文件在文件选项卡下方有下拉菜单，显示当前文件中的类和方法。*这对于快速跳转到文档中的任何*方法是相当不可用的，因为您首先需要选择定义符号的类，然后选择符号本身。此外，我找不到任何键盘快捷键，也没有一种简单的方法可以通过键入部分符号名称来过滤列表中的项目。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-30T22:19:37.887

您可以使用`Ctrl+,`- 只需在框中输入您想要的任何内容，它就会为您找到相应的符号。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-12T07:07:16.940

在 VS 2017 中（不确定，可能也适用于某些以前的版本）：

*   Ctrl + T（或 Ctrl + ,）打开 Go To All 窗口，然后
*   Ctrl + Alt + C 启用当前文档范围。Go To All 窗口中有一个适当的按钮，显示文档采场是否启用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T21:50:49.377

如果我理解正确，您可以通过右侧的下拉菜单执行此操作，就在编码窗口上方。

![http://i.imgur.com/uv96R.png](../Images/e1a0c1d25440fc74745b4c13c3e9a9e1.png)

我不知道任何其他方式，但这并不意味着没有。希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T21:52:58.200

在解决方案资源管理器的顶部，您可以在那里搜索。

此外，您可以从解决方案资源管理器中深入了解代码。这将带您了解每个属性和方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-26T08:41:34.843

使用 Resharper，您可以使用`Ctrl`+`F12`导航到当前类、方法或字段的成员。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-05T15:48:39.483

我正在使用 VS Community 2019。我找到了这个组合键：

*   转到会员：`Ctrl`+ `1`, `Ctrl`+`M`
*   转到符号：`Ctrl`+ `1`,`S`

# wifi - 提供商如何获得有关通过 Wi-Fi 适配器共享互联网的信息？

> ID：13147978
> 
> 赞同：0
> 
> 时间：2012-10-30T21:40:39.267
> 
> 标签：wifi, hardware, network-protocols, provider

我知道**TTL**。如果有一些适配器，那么 TTL -= 1。还有其他方法可以获取有关 Wi-Fi 适配器的信息吗？

如果我想隐藏有关使用 Wi-Fi 的信息，我必须禁用路由器固件中的数字 TTL？就这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T20:59:17.733

TTL 信息不足以确定您是否使用 wifi。TTL 是可配置的，您可以在 PC 中轻松更改它，无需破解 AP。

对于 Windows 7：

1.  运行注册表
2.  打开 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
3.  将 DWORD 32 位命名为 defaultTTL 并设置 [0-255] 范围内的任何值

对于其他操作系统谷歌知道如何，你只需要问。

提供商无法知道您使用的是 wifi 适配器。除非亲自到您的地方并发现 wifi 网络。

# list - f# 从集合中获取值列表

> ID：13147982
> 
> 赞同：1
> 
> 时间：2012-10-30T21:40:47.913
> 
> 标签：list, collections, f#

我正处于学习 f# 的早期阶段，我想出了以下场景。我需要遍历一组电子邮件对象并为每封电子邮件创建一个 CC 属性列表。我知道这对于 f# 来说是理想的，但我似乎找不到任何解释方法。我认为我的 google-fu 不够好，有人能指出我正确的方向吗？

编辑

所以基本上我想将一种类型的 MailMessage 对象映射到另一种类型。第一种类型具有作为 MailAddress 对象的 ICollection 的 CC 字段。第二种类型要求 CC 字段是字符串列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T21:58:17.427

假设您有一个`Email`建模为 F# 记录的类型：

```
type Email = 
  { Subject: string;
    Body: string; } 
```

和电子邮件列表：

```
let emails =
  [ {Subject = "Subject 1"; Body = "Body 1"};
    {Subject = "Subject 2"; Body = "Body 2"};
    {Subject = "Subject 3"; Body = "Body 3"}; ] 
```

您可以使用 List 模块中的高阶函数来操作`emails`：

```
let bodies = emails |> List.map (fun e -> e.Body)
// val bodies = ["Body 1"; "Body 2"; "Body 3"] 
```

要开始使用，请查看有关相关主题的一些 MSDN 资料：

*   [记录](http://msdn.microsoft.com/en-us/library/dd233184.aspx)
*   [基本列表处理](http://msdn.microsoft.com/en-us/library/dd233224.aspx)
*   [列表模块](http://msdn.microsoft.com/en-us/library/ee353738.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T21:53:55.600

像这样的东西？

```
type Email = { Body : string }
// create some emails
let emails = Seq.init 10 (fun i -> { Body = string i })
// get list of bodies
let bodies = emails |> Seq.map (fun { Body = body } -> body) |> Seq.toList 
```

# php - 使用 PHP 优化内存使用和更改文件内容

> ID：13147985
> 
> 赞同：0
> 
> 时间：2012-10-30T21:41:09.537
> 
> 标签：php, memory-management, file-io

在这样的功能中

```
function download($file_source, $file_target) {
    $rh = fopen($file_source, 'rb');
    $wh = fopen($file_target, 'wb');
    if (!$rh || !$wh) {
        return false;
    }

    while (!feof($rh)) {
        if (fwrite($wh, fread($rh, 1024)) === FALSE) {
            return false;
        }
    }

    fclose($rh);
    fclose($wh);

    return true;
} 
```

用我的自定义字符串重写文件最后几个字节的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:59:00.720

您的功能将内容从一个文件复制到另一个文件...我认为最好您有新功能来执行此操作

尝试

```
$yourString = "The New String World";
$fileTarget = "log.txt";

// Replace Last bytes with this new String
replaceFromString($fileTarget, $yourString); 
```

示例 2

```
// Replace last 100bytes form file A to file B
replaceFromFile("a.log", "b.log", 100, - 100); 
```

使用的功能

```
function replaceFromString($file, $content, $offsetIncrement = 0, $whence = SEEK_END) {
    $witePosition = - strlen($content);
    $wh = fopen($file, 'rb+');
    fseek($wh, $witePosition + $offsetIncrement, $whence);
    fwrite($wh, $content);
    fclose($wh);
}

function replaceFromFile($fileSource, $fileTarget, $bytes, $offest, $whence = SEEK_END) {
    $rh = fopen($fileSource, 'rb+');
    $wh = fopen($fileTarget, 'rb+');
    if (! $rh || ! $wh) {
        return false;
    }
    fseek($wh, $offest, $whence);
    if (fwrite($wh, fread($rh, $bytes)) === FALSE) {
        return false;
    }
    fclose($rh);
    fclose($wh);
    return true;
} 
```

# c# - 为什么我的 UIButton 没有响应？

> ID：13147987
> 
> 赞同：2
> 
> 时间：2012-10-30T21:41:10.650
> 
> 标签：c#, xamarin.ios, uibutton

我对 IOS 和 Monotouch 比较陌生，但精通 .NET 和 C#。UIButton 没有响应事件，我不知道为什么。我已经阅读了至少 3 本关于 MonoTouch 编程的教科书，并在 stackoverflow 和其他网站上阅读了许多问题和答案，但没有找到解决方案。我对 UIButton 进行了子类化以获取 id，代码为：

```
using System;
using MonoTouch.UIKit;
using System.Drawing;

namespace Roombler.Views
{
    public class SmallDottedMonthButton : UIButton
    {       

        public SmallDottedMonthButton(int numberOfButton)
        {
            this.number = numberOfButton;
            UIImage image = UIImage.FromFile("Green.png");

            this.SetBackgroundImage(image, UIControlState.Normal);
        }

        public int number = 0;

    }
} 
```

然后在视图中使用此代码。该按钮显示正确，但我无法将任何事件附加到它。我读到启用 userInteraction 可以解决问题，但在我的情况下不是。这是使用自定义 UIButton（名为 smallDottedMonthButtonNr1）的方式：

```
using System;
using MonoTouch.UIKit;
using System.Drawing;
using Roombler.Controllers;

namespace Roombler.Views
{
    public class MonthSelectorView:  UIView
    {
        public UILabel currentYearLabel;
        public UILabel containerForDetailedWeeksLabel;

        public SmallDottedMonthButton  smallDottedMonthButtonNr1;
        public SmallDottedMonthButton smallDottedMonthButtonNr2;

        public NormalDottedMonthButton normalDottedMonthButtonNr1;
        public NormalDottedMonthButton normalDottedMonthButtonNr2;
        public NormalDottedMonthButton normalDottedMonthButtonNr3;

        public WeekButton weekButtonNr1;
        public WeekButton weekButtonNr2;
        public WeekButton weekButtonNr3;
        public WeekButton weekButtonNr4;
        public WeekButton weekButtonNr5;
        public WeekButton weekButtonNr6;

        public NormalMonthButton normalMonthButtonNr1;
        public NormalMonthButton normalMonthButtonNr2;
        public NormalMonthButton normalMonthButtonNr3;

        public SmallMonthButton smallMonthButtonNr1;
        public SmallMonthButton smallMonthButtonNr2;

        private UIScrollView baseView;

        private DateTime currentMonth;

        public MonthSelectorView()
        {
            this.UserInteractionEnabled = true;
            smallDottedMonthButtonNr1 = new SmallDottedMonthButton(1);
            //smallDottedMonthButtonNr1.SetNumberOfButton(1);

            smallDottedMonthButtonNr2 = new SmallDottedMonthButton(2);
            //smallDottedMonthButtonNr2.SetNumberOfButton(2);

            normalDottedMonthButtonNr1 = new NormalDottedMonthButton(1);

            normalDottedMonthButtonNr2 = new NormalDottedMonthButton(2);

            normalDottedMonthButtonNr3 = new NormalDottedMonthButton(3);

            weekButtonNr1 = new WeekButton();
            weekButtonNr1.SetNumberOfButton(1);

            weekButtonNr2 = new WeekButton();
            weekButtonNr2.SetNumberOfButton(2);

            weekButtonNr3 = new WeekButton();
            weekButtonNr3.SetNumberOfButton(3);

            weekButtonNr4 = new WeekButton();
            weekButtonNr4.SetNumberOfButton(4);

            weekButtonNr5 = new WeekButton();
            weekButtonNr5.SetNumberOfButton(5);

            weekButtonNr6 = new WeekButton();
            weekButtonNr6.SetNumberOfButton(6);

            normalMonthButtonNr1 = new NormalMonthButton(1);

            normalMonthButtonNr2 = new NormalMonthButton(2);

            normalMonthButtonNr3 = new NormalMonthButton(3);

            smallMonthButtonNr1 = new SmallMonthButton(1);
            smallMonthButtonNr2 = new SmallMonthButton(2);

            baseView = new UIScrollView {
                Frame = setSizeAndPosition(10.0f, 0.0f, 780.0f, 50.0f),
                BackgroundColor = UIColor.DarkGray,
                AutoresizingMask = UIViewAutoresizing.FlexibleWidth
            };
            this.AddSubview(baseView);

            baseView.UserInteractionEnabled = true;

            currentYearLabel = new UILabel(new RectangleF(5.0f, 5.0f, 100.0f, 40.0f));
            currentYearLabel.Text = "2012";
            currentYearLabel.BackgroundColor = UIColor.Brown;
            currentYearLabel.TextColor = UIColor.White;
            currentYearLabel.TextAlignment = UITextAlignment.Center;
            baseView.AddSubview(currentYearLabel);

            SizeF size = setSize(40.0f, 40.0f);
            DateTime date = currentMonth;
            date = date.AddMonths(1);
            constants = new MonthConstants();

            month = constants.GetNameOfMonth(date.Month, true);

            smallDottedMonthButtonNr1.SetTitle(month, UIControlState.Normal);
            smallDottedMonthButtonNr1.Font = UIFont.FromName("Arial", 8f);
            smallDottedMonthButtonNr1.Frame = new RectangleF(100.0f, 15.0f, 40, 40);
            smallDottedMonthButtonNr1.BackgroundColor = UIColor.White;
            smallDottedMonthButtonNr1.SetTitleShadowColor(UIColor.Green,         UIControlState.Normal);
            smallDottedMonthButtonNr1.SetTitleColor(UIColor.Black, UIControlState.Normal);

            baseView.AddSubview(smallDottedMonthButtonNr1);

            smallDottedMonthButtonNr1.TouchUpInside += HandleTouchUpInside;

            addNormalDottedButton(normalDottedMonthButtonNr1, new PointF(160.0f, 20.0f));
            addNormalDottedButton(normalDottedMonthButtonNr2, new PointF(180.0f, 20.0f));
            addNormalDottedButton(normalDottedMonthButtonNr3, new PointF(200.0f, 20.0f));

            containerForDetailedWeeksLabel = new UILabel(new RectangleF(220.0f, 20.0f, 100.0f, 20.0f));

            addWeekButton(weekButtonNr1.GetButton(1), new PointF(230.0f, 20.0f));
            addWeekButton(weekButtonNr2.GetButton(2), new PointF(240.0f, 20.0f));
            addWeekButton(weekButtonNr3.GetButton(3), new PointF(250.0f, 20.0f));
            addWeekButton(weekButtonNr4.GetButton(4), new PointF(260.0f, 20.0f));
            addWeekButton(weekButtonNr5.GetButton(5), new PointF(270.0f, 20.0f));
            addWeekButton(weekButtonNr6.GetButton(6), new PointF(280.0f, 20.0f));

            addNormalMonthButton(normalMonthButtonNr1, new PointF(310.0f, 20.0f));
            addNormalMonthButton(normalMonthButtonNr2, new PointF(370.0f, 20.0f));
            addNormalMonthButton(normalMonthButtonNr3, new PointF(430.0f, 20.0f));

            addSmallMonthButton(smallMonthButtonNr1, new PointF(490.0f, 20.0f));
            addSmallMonthButton(smallMonthButtonNr2, new PointF(540.0f, 20.0f));

            this.AddSubview(containerForDetailedWeeksLabel);

            UISlider weekOrMonthSlider;

            weekOrMonthSlider = new UISlider { Frame = new RectangleF (500, 500,
                                                             100, 50) };

            weekOrMonthSlider.MinValue = 0.0f;
            weekOrMonthSlider.MaxValue = 20.0f;
            weekOrMonthSlider.SetValue(10.0f, false);

            weekOrMonthSlider.ValueChanged += delegate
            {
                //_text = _slider.Value.ToString ();
                //_testLabel.Text = _text;
            };
            this.AddSubview(weekOrMonthSlider);

        }
        void HandleTouchUpInside(object sender, EventArgs e)
        {
            smallDottedMonthButtonNr1.SetTitle("Test", UIControlState.Normal);
        }

        private RectangleF setSizeAndPosition(float x, float y, float width, float hight)
        {
            return new RectangleF(x, y, width, hight); 
        }

        private SizeF setSize(float width, float hight)
        {
            return new SizeF(width, hight);

        }

        public void setCurrentMonth(DateTime currentMonth)
        {
            this.currentMonth = currentMonth;
        }

        String month;
        MonthConstants constants;

        private SmallDottedMonthButton addSmallDottedButton(SmallDottedMonthButton button, PointF position)
        {

            SizeF size = setSize(40.0f, 40.0f);
            DateTime date = currentMonth;
            date = date.AddMonths(button.number);
            constants = new MonthConstants();

            month = constants.GetNameOfMonth(date.Month, true);

            button.SetTitle(month, UIControlState.Normal);
            button.Font = UIFont.FromName("Arial", 8f);
            button.Frame = new RectangleF(position, size);
            button.BackgroundColor = UIColor.White;
            button.SetTitleShadowColor(UIColor.Green, UIControlState.Normal);

            baseView.AddSubview(button);
            return button;

        }

        private void addNormalDottedButton(NormalDottedMonthButton button, PointF position)
        {
            SizeF size = setSize(50.0f, 50.0f);

            DateTime date = currentMonth;
            date = date.AddMonths(button.number);
            month = constants.GetNameOfMonth(date.Month, true);

            button.SetTitle(month, UIControlState.Normal);
            button.Frame = new RectangleF(position, size);
            button.BackgroundColor = UIColor.White;
            button.SetTitleShadowColor(UIColor.Green, UIControlState.Normal);
            baseView.AddSubview(button);
        }

        private void addWeekButton(WeekButton button, PointF position)
        {
            SizeF size = setSize(35.0f, 35.0f);

            DateTime date = currentMonth;
            date = date.AddMonths(button.number);
            month = constants.GetNameOfMonth(date.Month, true);

            button.SetTitle(month, UIControlState.Normal);
            button.Frame = new RectangleF(position, size);
            button.BackgroundColor = UIColor.White;
            button.SetTitleShadowColor(UIColor.Green, UIControlState.Normal);
            baseView.AddSubview(button);
        }

        private void addNormalMonthButton(NormalMonthButton button, PointF position)
        {
            SizeF size = setSize(50.0f, 50.0f);
            DateTime date = currentMonth;
            date = date.AddMonths(button.number);

            month = constants.GetNameOfMonth(date.Month, true);

            button.SetTitle(month, UIControlState.Normal);
            button.Frame = new RectangleF(position, size);
            button.BackgroundColor = UIColor.White;
            button.SetTitleShadowColor(UIColor.Green, UIControlState.Normal);
            baseView.AddSubview(button);
        }

        private void addSmallMonthButton(SmallMonthButton button, PointF position)
        {

            SizeF size = setSize(40.0f, 40.0f);

            DateTime date = currentMonth;
            date = date.AddMonths(button.number);
            month = constants.GetNameOfMonth(date.Month, true);

            button.SetTitle(month, UIControlState.Normal);
            button.Frame = new RectangleF(position, size);
            button.BackgroundColor = UIColor.White;
            button.SetTitleShadowColor(UIColor.Green, UIControlState.Normal);
            baseView.AddSubview(button);
        }
    }
} 
```

我在这里有点迷路，真的很想得到一些帮助，或者只是提示我应该往哪个方向走。

亲切的问候乔纳斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T05:41:22.983

检查按钮添加到的边界/框架。虽然它是一个滚动视图，所以我想如果你能看到你的按钮就很好。

是否设置断点

```
 smallDottedMonthButtonNr1.SetTitle("Test", UIControlState.Normal); 
```

有帮助吗？

您是否 100% 确定没有其他视图覆盖您的按钮？

另外，出于好奇，请尝试 TouchDown 而不是 TouchUpInside。

# facebook - 使用 HybridAuth 进行“离线”访问

> ID：13147990
> 
> 赞同：6
> 
> 时间：2012-10-30T21:41:47.610
> 
> 标签：facebook, hybridauth, hybridauthprovider

我已经使用 HybridAuth 在我的 Facebook 应用程序中授权了一个用户，并将他的 access_token 存储在我的数据库中。

几天后，当用户不在线时，我想获取他的新 Facebook 朋友，也使用 HybridAuth。

我可以从他的 access_token 中“重新创建”该用户以获取他的朋友、发送通知等吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T10:04:10.933

我终于找到了一个可行的方法，我会把它留在这里，让下一个寻找它的人。如果您确保您的用户和应用程序具有有效的令牌，HybridAuth 不应尝试重定向或返回任何错误

（我正在使用 Codeigniter，但将其转换为“纯”HybridAuth 应该很简单：

```
 $token = "GET A TOKEN IN Facebook's API EXPLORER";
    $this->load->library('HybridAuthLib');
    $this->hybridauthlib->storage()->set( "hauth_session.facebook.is_logged_in", 1 );
    $this->hybridauthlib->storage()->set( "hauth_session.facebook.token.access_token", $token );        
    $service = $this->hybridauthlib->authenticate('Facebook');

    if ($service->isUserConnected()){

        $user_profile = $service->getUserProfile();
        $contacts = $service->getUserContacts();
        $access_token = $service->getAccessToken();

        var_dump($user_profile);
        var_dump($contacts);
        var_dump($access_token);

    }else{
        echo "something went wrong";
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-16T23:20:01.970

虽然上述方法可能有效，但我相信推荐的方法可能是使用此处所述的“持久会话”：http: [//hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html](http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html)

# mysql - 对于以下 mysql 查询，我得到了一个输出。但是如何修改查询以便我得到一个日期范围的结果

> ID：13147991
> 
> 赞同：2
> 
> 时间：2012-10-30T21:41:46.883
> 
> 标签：mysql, sql

```
select hotel.*, hotels.type 
from pe,se 
where p.hotel_Id = s.S_Id 
  and Type=""; 
```

我得到的输出是

```
 pid     SId     PName     PPlan     PMethod     PDate     numberOfParents     SType    
 ---------------------  ----------  -------------------------  -------------------------  ---------------------------  -------------------------  ------------------  ------------ 
 4                      2           kjbkjbjkbk                 jkbjbkbl                   lkblknl                      10/5/2012                  234                 abc       
 6                      2           dfvrvt                     rvrtv                      rvrtvrt                      1/1/2012                   3                   abc       
 9                      2           er 
```

现在我的问题是我想要查询，以便我的输出将以这样的方式进行，即数据适用于一系列日期。例如，2012 年 8 月 9 日至 2012 年 10 月 12 日。

另外，我可以使用 >= 和 <= 为日期范围编写 mysql 查询。但我无法在当前查询中组合该日期范围部分。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T21:51:27.647

`WHERE`在处理日期范围时，使用括号有助于使您的子句清晰：

```
SELECT p.*
  , s.Site_Type 
FROM parentengagement AS p
INNER JOIN site AS s ON p.Site_Id = s.Site_Id 
  AND s.Site_Type = 'County'
  AND
  (
     p.Parent_Engagement_Date >= '2012-08-09'
       AND p.Parent_Engagement_Date <= '2012-10-12'
  ) 
```

我还建议使用`INNER JOIN`语法而不是关于连接`FROM table1, table2` 的良好[**视觉表示。**](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

**来自评论**的更新： OP 想为每个站点汇总 numberOfparents 。

```
SELECT s.Site_Type 
   , SUM(p.NumberOfParents)
FROM parentengagement AS p
INNER JOIN site AS s ON p.Site_Id = s.Site_Id 
  AND s.Site_Type = 'County'
  AND
  (
     p.Parent_Engagement_Date >= '2012-08-09'
       AND p.Parent_Engagement_Date <= '2012-10-12'
  )
GROUP BY s.Site_Type 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T21:53:26.217

如果您只是想运行相同的查询但将其限制在一个日期范围内，那么您应该能够在同一个查询中执行此操作：

```
select parentengagement.*, site.Site_Type 
from parentengagement,site 
where 
    parentengagement.Site_Id = site.Site_Id and 
    site.Site_Type="County" and
    parentengagement.Parent_Engagement_Date > '2012-10-30' and
    parentengagement.Parent_Engagement_Date <= '2012-10-31' 
```

# c# - 尽管已经执行了依赖于 Func`2 的代码，但 WinCE 上 Func`2<> 的 MissingMethodException

> ID：13147994
> 
> 赞同：2
> 
> 时间：2012-10-30T21:42:02.217
> 
> 标签：c#, compact-framework, func, .net-cf-3.5, missingmethodexception

我正在编写在 WindowsCE 6.0 上的 .NETCF 3.5 上运行的 C# 代码，该代码在运行时为 Func`2<> 抛出 MissingMethodExceptions。发生异常的代码部分是随机的。

奇怪的是，当您已经使用该应用程序一段时间并且肯定**已经发生了对 Func`2 的许多调用时，就会发生这种情况**。（例如，通过 IEnumerable.Select() 或 .Where()） 如果您在应用程序的生命周期内仅加载足够的类型以使程序集文件大小的总和超过 ~18MB，则似乎此行为开始。但是设备上有足够的内存（RAM）来加载类型。

还激活了 LoaderLogging 但无济于事。它只向我显示 Func`2 的 TypeLoad 错误。

当我没有想法时：这些错误的原因可能是什么？

不幸的是，我不能分享任何代码，因为它是 1) 我工作的公司的财产，以及 2) 数万行代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T10:09:32.690

.NETCF 似乎有一个限制：

**每个泛型类型声明只能构造 1024 个唯一的封闭类型。**（有关更多信息，请参阅“限制”部分：http: [//blogs.msdn.com/b/romanbat/archive/2005/01/06/348114.aspx](http://blogs.msdn.com/b/romanbat/archive/2005/01/06/348114.aspx)）

意义：

```
List<int> a;
List<int> b;
List<int> c; 
```

占用一个“槽”，

```
List<int> d;
List<string> e; 
```

需要两个“插槽”（两个唯一的关闭），依此类推。

棘手的是：通常这会引发 ArgumentException，但有时 .NETCF 会引发 MissingMethodExceptions。（请参阅“3\. 抛出异常的差异。”：http: [//blogs.msdn.com/b/nazimms/archive/2005/01/25/360324.aspx](http://blogs.msdn.com/b/nazimms/archive/2005/01/25/360324.aspx)）

我们在可能的情况下通过使用我们自己的委托类型来减少 Func`2 的使用，这已经解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T06:42:05.127

如果您了解 Windows CE 内存管理的背景，您已经自己回答了您的问题：“...这样程序集文件大小的总和超过了 ~18MB。但是设备上有足够的内存 (RAM) 可用于加载类型……”

你知道，每个进程只有一个 32MB 的程序内存插槽，不管有 GB 或更多的 RAM！这是设计使然。您知道，由您或任何其他正在运行的进程加载的 DLL 被加载到每个进程的 32MB 插槽中（尽管 Windows Embedded Handheld 6.5 没有加载完整大小）。因此，加载的 DLL 越多，进程获得的可用程序内存就越少。有关更多详细信息，另请参阅[http://community.intermec.com/t5/General-Development-Developer/Slaying-the-virtual-memory-monster/mp/16764](http://community.intermec.com/t5/General-Development-Developer/Slaying-the-virtual-memory-monster/m-p/16764)。

如果从 32MB 插槽底部开始增长的进程​​内存相对于从 32MB 插槽顶部加载的加载的 DLL 增长，您将获得奇怪的程序行为甚至崩溃。

以上适用于所有基于 Windows CE 5 的操作系统版本，例如 windows Mobile 6.1、Windows Mobile 5 甚至最新的 Windows Mobile 6.5.3（嵌入式手持设备）。以上必须针对基于 Windows CE 6 的操作系统版本进行修改。

问候

约瑟夫

# sharepoint - SharePoint 2007：计算列

> ID：13147996
> 
> 赞同：0
> 
> 时间：2012-10-30T21:42:14.863
> 
> 标签：sharepoint

我需要在列表中的计算列上实现以下逻辑...列：需要票证、数量和价格。1.-如果数量。is >= 20 AND Price >= 150 2.- OR IF Price >= 750 然后将文本值设置为“需要票”，如果不满足则将值设置为“不需要票”

我已经尝试了这个公式的几种变体，但没有运气：

=IF(AND(qty>= 20, Price >= 750), "需要票", "不需要票") and: =IF(OR(qty>= 20, Price >= 750), "需要票”、“不需要票”）

我被卡住了，似乎无法为两种可能的逻辑变化编写公式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T15:12:03.187

关于上面的 Nats 答案，不需要 AND(Price>= 750)。写吧

```
=IF(OR(AND(Qty>=20,Price>=150),Price>=750),"don't need a ticket","need a ticket") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:59:13.127

看起来你需要在“OR”中嵌套“AND”结构，例如

```
=IF(OR(AND(Qty>=20,Price>=150),AND(Price>=750)),"don't need a ticket","need a ticket") 
```

# html - SVG 会自动在顶部添加填充并在底部切断

> ID：13147998
> 
> 赞同：1
> 
> 时间：2012-10-30T21:42:40.950
> 
> 标签：html, css, svg

我正在一个网站上工作，其中使用它的说明通过 2100 x 2800 像素左右的 SVG 嵌入，并且调整为浏览器窗口宽度的 90%。出于某种原因，它在顶部添加了大量空白并在底部切断。我对 SVG 不太了解，这个是用 illustrator 生成的，但我很好奇我能做些什么来解决这个问题。

图片： http: [//i.imgur.com/Ywsoy.png](http://i.imgur.com/Ywsoy.png) , [http://i.imgur.com/sObAv.png](http://i.imgur.com/sObAv.png)

这是我正在使用的 svg 标头和其他一些 css/html 代码：

```
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
 width="2120.263px" height="2839.466px" viewBox="0 0 2120.263 2839.466" enable-background="new 0 0 2120.263 2839.466"
 xml:space="preserve"> 
```

HTML：

```
<embed src="P3intro.svg" id="introsvg" type="image/svg+xml"  /> 
```

CSS：

```
article embed {
width: 90%;

margin-left: 5%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T20:51:02.393

我发现了如何做到这一点。我所做的是将 SVG 包含在一个 div 中，该 div 具有使用图像纵横比和一些 jQuery 计算的固定宽度，并使 SVG 宽度为 100% 高度为 100%。