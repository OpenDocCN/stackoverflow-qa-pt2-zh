# StackOverflow 问答 13131000-13131999

# debian - 在php中获取cpu百分比使用率

> ID：13131003
> 
> 赞同：12
> 
> 时间：2012-10-29T23:11:17.383
> 
> 标签：debian, command-line-interface, php

我想在 PHP 中显示 CPU 使用百分比。如果在 shell 中通过 cron 获取值 > 输出到文件 > 在 PHP 中解析或直接在 php 中获取值，这并不重要。我尝试了许多在互联网上找到的解决方案，但没有任何用处。在平均负载情况下，我无法显示 0-100% 的图形栏，并且我发现的百分比输出函数给我的值不好或只有第一个核心的值。获得每个核心的百分比使用率会很好。有解决方案吗？

编辑：

我做了临时解决方案，效果很好，但这不是最好的方法。

cron 作业每隔一分钟运行 php 脚本，该脚本从“顶部”执行 grep cpu 信息的命令并将其保存到文件中，在结束脚本等待 3 秒并循环 20 次（每 3 秒更新一次的方式）php 脚本：

```
<?php
for($i=0; $i<=20; $i++) {
    //cpu load
    exec("top -b -n 1 | grep 'Cpu(s):' > /some/file.cpu");
    //ram usage
    exec("top -b -n 1 | grep 'Mem:' > /some/file.ram");
    //wait 3sec
    sleep(3);
}
?> 
```

现在我可以从这些文件中解析信息。

新问题是如何使守护程序脚本每 3 秒运行一次此命令。我认为使用 php 脚本和 cron 的解决方案只是临时解决方案，并不是最好的方法。守护进程会好很多。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-31T09:39:09.877

在论坛上搜索并尝试了多种方法后，最准确的是：

```
$stat1 = file('/proc/stat'); 
sleep(1); 
$stat2 = file('/proc/stat'); 
$info1 = explode(" ", preg_replace("!cpu +!", "", $stat1[0])); 
$info2 = explode(" ", preg_replace("!cpu +!", "", $stat2[0])); 
$dif = array(); 
$dif['user'] = $info2[0] - $info1[0]; 
$dif['nice'] = $info2[1] - $info1[1]; 
$dif['sys'] = $info2[2] - $info1[2]; 
$dif['idle'] = $info2[3] - $info1[3]; 
$total = array_sum($dif); 
$cpu = array(); 
foreach($dif as $x=>$y) $cpu[$x] = round($y / $total * 100, 1); 
```

现在统计数据在 $cpu['user'], $cpu['nice'], $cpu['sys'], $cpu['idle']

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-10-24T15:44:10.187

Diyism 的答案以及[http://php.net/manual/en/function.sys-getloadavg.php](http://php.net/manual/en/function.sys-getloadavg.php)上的建议似乎不适用于 CentOS 6.5 VPS。我们不得不更改`physical id`为`processor`. 然后它返回一个核心作为 ID 0，因此计算需要 +1 个核心。此外，您需要乘以 100 才能获得百分位数。最后，这需要四舍五入以获得漂亮的百分比。因此，如果您遇到任何一种情况，这里有一个替代想法可能会起作用：

```
<?php
$loads = sys_getloadavg();
$core_nums = trim(shell_exec("grep -P '^processor' /proc/cpuinfo|wc -l"));
$load = round($loads[0]/($core_nums + 1)*100, 2);
echo $load;
?> 
```

因此，如果负载平均 [0] 在 2 核机器上为 0.50，这将显示 CPU 负载为 25%

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-30T06:01:11.480

我不是 100% 确定你在问什么，但如果我是对的，这个答案可能会对你有所帮助：

```
<?php
    exec('ps -aux', $processes);
    foreach($processes as $process)
    {
        $cols = split(' ', ereg_replace(' +', ' ', $process));
        if (strpos($cols[2], '.') > -1)
        {
            $cpuUsage += floatval($cols[2]);
        }
    }
    print($cpuUsage);
?> 
```

提供的代码是[Devils Child](https://stackoverflow.com/users/1199684/devils-child)对类似问题的回答： [https ://stackoverflow.com/a/9846219/904242](https://stackoverflow.com/a/9846219/904242)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-28T10:36:19.710

用这个：

```
<?php
$loads=sys_getloadavg();
$core_nums=trim(shell_exec("grep -P '^physical id' /proc/cpuinfo|wc -l"));
$load=$loads[0]/$core_nums;
echo $load;
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T06:35:38.517

您可以使用“top -n 1”来获取 cpu 百分比。此命令只运行一次 top ，然后给出输出。我认为您可以自己完成解析部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-21T22:36:32.683

另一种选择：

```
function cpuload() {
  $cont = file('/proc/stat');
  $cpuloadtmp = explode(' ',$cont[0]);
  $cpuload0[0] = $cpuloadtmp[2] + $cpuloadtmp[4];
  $cpuload0[1] = $cpuloadtmp[2] + $cpuloadtmp[4]+ $cpuloadtmp[5];
  sleep(1);
  $cont = file('/proc/stat');
  $cpuloadtmp = explode(' ',$cont[0]);
  $cpuload1[0] = $cpuloadtmp[2] + $cpuloadtmp[4];
  $cpuload1[1] = $cpuloadtmp[2] + $cpuloadtmp[4]+ $cpuloadtmp[5];
  return ($cpuload1[0] - $cpuload0[0])*100/($cpuload1[1] - $cpuload0[1]);
} 
```

# php - 用 PHP 更改 URL，切片

> ID：13131004
> 
> 赞同：0
> 
> 时间：2012-10-29T23:11:20.153
> 
> 标签：php, url, slice

我有一个以_s.jpg 结尾的网址。URL 设置为变量，稍后调用。在调用它之前，我需要对 URL 进行切片并删除 _s.jpg 并添加 _o.jpg。

```
$img_src = $data['picture']; 
```

这将返回我的网址

```
http://photos-b.ak.fbcdn.net/hphotos-ak-snc7/416968_4827318927507_851357969_s.jpg 
```

我需要更改 $img_src URL，然后放入新变量 $new_img_src

我知道我可以用 jQuery 来做，但我需要用 PHP 来做。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:18:07.843

```
$new_img_src = str_replace('_s.jpg', '_o.jpg', $data['picture']); 
```

这应该工作......

# facebook - Facebook 移动通知

> ID：13131005
> 
> 赞同：0
> 
> 时间：2012-10-29T23:11:21.773
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk

我正在尝试通过应用程序向用户发送通知，但它们不会显示在任何移动设备中。

例如，用户执行向其他用户发送通知的操作。如果他在计算机浏览器上，他可以看到通知，但在 iOS/Android/Mobile Facebook 中，通知不会显示。

你们能帮帮我吗？

研究生，
埃尔卡斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:13:10.233

您是在谈论向其发出 POST 请求的[通知 API](https://developers.facebook.com/docs/app-notifications/)`/{recipient_userid}/notifications`吗？

如果是这样，这是预期的行为。从文档：

> 注意：只有 Facebook.com 上的应用程序可以使用通知 API。此外，这些通知仅出现在 Facebook.com 的桌面版本上。

# telnet - telnet 捕获 ctrl+c 服务器

> ID：13131006
> 
> 赞同：1
> 
> 时间：2012-10-29T23:11:24.453
> 
> 标签：telnet, socketserver, sigint

我已经写了一个像[这里](http://www.linuxhowtos.org/C_C++/socket.htm)这样的套接字服务器。如果我输入`ctrl+c`telnet，服务器现在什么都不做。我想抓住它，`signal(SIGINT,SIG_IGN)`
我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:43:50.433

telnet 程序捕获 CTRL-C 字符并将其作为单个字节 ( `\x03`) 通过 TCP 连接发送到另一端。由接收程序决定如何处理该字节。

如果它被打算通过伪终端提供类似控制台的交互性的“telnet 守护进程”接收，则*该*组合会为在其下运行的进程（通常是 shell）生成一个 SIGINT。

因此，要回答您的问题，您可以处理接收到的`\x03`字符并在内部生成一个 SIGINT，或者您可以将整个程序作为由 telnetd 在伪终端下生成和控制的进程运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:54:13.563

telnet 客户端（接收 SIGINT 的进程）应该处理它：或者在本地处理它（例如：终止，或重新发出提示），或者将它作为 IAC*东西*（BRK？）和/或输出发送到服务器波段数据。如果你想将中断传递给服务器，谷歌的“telnet IAC”可能会让你开始。

# c - 从 i2c 地址访问值

> ID：13131007
> 
> 赞同：-1
> 
> 时间：2012-10-29T23:11:25.253
> 
> 标签：c, memory, i2c

你可以看看这个网站：[http](http://www.hitechnic.com/cgi-bin/commerce.cgi?preadd=action&key=NSK1042) ://www.hitechnic.com/cgi-bin/commerce.cgi?preadd=action&key=NSK1042来更好地理解我在说什么。例如，该网站显示：传感器的 i2c 地址为 0x10，其中的值表显示为：

```
Address       Type           Contents

00 – 07H      chars           Serial Version Number

43H           byte            Sensor 1 DC Signal Strength 
```

如何在 C 中访问这些值？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:57:47.380

这些寄存器可以进行内存映射。您需要做的几件事：

*   将设备的物理内存映射到您的程序地址空间
*   将指向该区域的任何指针声明为 volatile

volatile 关键字将阻止编译器“优化”不正确的程序。例如，假设读取相同的内存位置将产生相同的结果，因为程序没有写入它。

最简单的部分是声明一个结构，使得所有偏移量都与设备相同，并且每个部分都具有正确的大小。

IE

```
struct hitech {
    char serial_version[8];
    char manufacturer[8];
    /* etc */
};

volatile struct hitech *my_device; 
```

第二部分是确定设备的映射位置。如果它已插入您的计算机，您应该能够看到这一点。您可能需要执行以下操作之一：映射设备的物理地址。或者直接写 my_device = 0x<address>。或者两者的结合。

来自网站：“IRSeeker V2 传感器的 I2C 地址为 0x10”

所以你想在上面为 my_device 写 0x10。

然后，您需要为正确的微控制器进行编译，并将您的程序作为固件加载到正确的位置。

你最好使用他们的编程语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:32:59.577

假设他们没有为您提供 SDK 来访问这些值：

```
// I'm assuming these are read-only, hence the "const"
const char *g_serialVersionNumber = (const char *)0x00; // be careful not to access more than 8 bytes
const unsigned char *g_sensor1DCSignalStrength = (const unsigned char *)0x43;

void main()
{
    printf("Serial version number: %s\n", g_serialVersionNumber);
    printf("Sensor 1 DC Signal Strength: %d\n", *g_sensor1DCSignalStrength);
} 
```

# jquery - 单击时更改父项颜色的子项

> ID：13131009
> 
> 赞同：1
> 
> 时间：2012-10-29T23:11:36.863
> 
> 标签：jquery, dom-traversal

我有一个包含多个`ul`项目的菜单。我想要的是将顶部菜单文本的颜色更改为红色。

但是，这仅在我单击第一项而不是子项时才有效。

例如，我想单击`hydrotherapy`并更改为红色的单词`Services`。家长。任何的想法？

```
$("nav.menu>ul>li").children().click(function() {
    alert("asd");
    var item1 = $(this),
        primeira_ul = item1.closest('.menu>ul#nav>li>a.t2');

    item1.addClass('font_red');
    return false;
}); 
```

***[演示](http://jsfiddle.net/dPeLZ/1/)***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:22:38.077

您可以搜索它的第一个孩子`$(this)`是一个`a`标签。请注意，这`$(this)`不是指事件源，而是**`$("nav.menu>ul>li")`**已经是您的顶级元素`li`。

您可能还想取消设置兄弟姐妹。

```
$("nav.menu>ul>li").on("click", function() {
    var item1 = $(this),
        primeira_ul = item1.closest('.menu>ul#nav>li>a.t2');

    $(this).siblings().find("> a").removeClass('font_red');
    $(this).find("> a").first().addClass('font_red');
    return false;
}); 
```

[JS小提琴](http://jsfiddle.net/dPeLZ/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:20:16.430

`ul.first_level`一种可能的方法是在第一轮中寻找最接近[`.siblings()`](http://api.jquery.com/siblings/)的链接，然后用于获取链接本身（不对代码进行重大修改，只需更改有问题的部分）：

```
$("nav.menu>ul>li").children().click(function() {
    var item1 = $(this);
    var theLink = item1.closest('.first_level').siblings('.t2');

    theLink.addClass('font_red');
    return false;
});​ 
```

[jsFiddle 演示](http://jsfiddle.net/dPeLZ/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T23:48:00.817

其他方式：

```
$("nav.menu>ul>li").children().click(function(e) {
  e.preventDefault();
  $(this).parents('#nav>li:has(.t2)').find('>a').addClass('font_red');
});​ 
```

# javascript - 根据前一个选择列表中的选择填充多个选择框

> ID：13131010
> 
> 赞同：0
> 
> 时间：2012-10-29T23:11:45.573
> 
> 标签：javascript, jquery, arrays, selection

我有一个相当复杂的问题，我似乎无法解决。

当用户在文本框中输入某个“术语”时，我有一个填充选择列表的输入文本框字段。

**例如：**
- 如果用户在文本框中输入单词“Mercedes”，选择列表将填充“A-class”、“B-class”、“C-class”、“S-class”
- 如果他们在文本框中输入“Audi”，选择列表中填充了“A4”、“A5”、“A6”等。

到目前为止，这符合我的预期。但是，当用户从选择列表中选择一个模型时，我想创建一个`<div>`下面动态填充相应的选定车辆配件的内容。

这是我到目前为止的代码：

**HTML**

```
<div>
Manufacturer:<input type="text" id="car_manufacturer"/>
Model: <select id="car_model"></select>
</div>

<p>Vehicle Model Accessories:</p>
<div id="model_accessories">
<!--- Here is a list of the selected vehicle model's accessories. It will change when the model selection changes ------> 
</div> 
```

**Javascript**

```
vehicleModels = {
   "Mercedes": ["A-class", "B-class", "C-class", "S-class", "SLK", "ML", ],
   "Audi": ["A3", "A4", "A5", "A6", "A7", "A8", ],
   "BMW": ["120", "320", "330", "520", "635", "745", ]
} 
```

此函数获取文本框中的值并检查它是否在上面的对象中定义。如果是，则将相应的车辆型号附加到选择列表中。

```
 $('#car_manufacturer').change(function() {
            if(vehicleModels[$(this).val()]) { 
                $.each(vehicleModels[$(this).val()], function() { 
                    $('#car_model').append('<option>' + this + '</option>');
                 });
            } 
});​ 
```

问题就从这里开始了！我现在如何`<div>`用相应的选定模型的配件填充模型配件？以下是目前汽车配件的存放方式。

```
mercedes_accessories = ["Xenons", "Adaptive cruise control", "sunroof"];
bmw_accessories = ["Start/stop", "heated seats", "Leather trim"];
audi_accessories = ["Electric seats", "B&O Sound System", "Leather trim",]; 
```

任何帮助将不胜感激。如果问题有点模糊，我很抱歉，很难解释。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:28:58.840

我会做这样的事情：

```
var vehicleModels = {
       mercedes: ["A-class", "B-class", "C-class", "S-class", "SLK", "ML", ],
       audi: ["A3", "A4", "A5", "A6", "A7", "A8", ],
       bmw: ["120", "320", "330", "520", "635", "745", ]
    },
    vehicleAcc = {
        a3 : ["Xenons", "Adaptive cruise control", "sunroof"],
        a4 : ["Xenons", "Adaptive cruise control", "sunroof"],
        a6 : ["Xenons", "Adaptive cruise control", "sunroof"]
    };

$('#car_manufacturer').on('change', function() {
    if(this.value.toLowerCase() in vehicleModels) { 
        $.each(vehicleModels[this.value.toLowerCase()], function(i,e) { 
            $('#car_model').append('<option>'+e+'</option>');
        });
    }
});

$('#car_model').on('change', function() {
    if (this.value.toLowerCase() in vehicleAcc) {
        $.each(vehicleAcc[this.value.toLowerCase()], function(i,e) {
            $('#car_model_acc').append('<option>'+e+'</option>');
        });
    }
}); 
```

[**小提琴**](http://jsfiddle.net/d2FaQ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:35:13.380

试试这个：

```
var accessories;

accessories.mercedes = ["Xenons", "Adaptive cruise control", "sunroof"];
accessories.bmw = ["Start/stop", "heated seats", "Leather trim"];
accessories.audi = ["Electric seats", "B&O Sound System", "Leather trim"];

$("#car_model").change( function( ) {

    // cache accessories for this manufacturer
    var arr = accessories[ $("#car_manufacturer").val().toLowerCase() ];

    for( var i = 0; i < arr.length; i += 1 ) {
       $("#accessories").append("<option>" + arr[i] + "</option>");
    }
}); 
```

# c# - Outlook 2010 插件 - 如何在安装前强制关闭 Outlook

> ID：13131015
> 
> 赞同：1
> 
> 时间：2012-10-29T23:12:44.723
> 
> 标签：c#, outlook, add-in

我在 c# 中为 Outlook 2010 开发了一个加载项，我发现如果在安装加载项时打开了 Outlook，它不会在顶部显示我的功能区。

我想知道，如何在安装之前强制关闭 Outlook，或者显示一个弹出消息告诉用户他们必须先关闭 Outlook，然后才能继续？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:20:13.577

这是一个**变通解决**方案：

打开记事本，添加以下行：

```
TASKKILL /F /IM outlook.exe /T 
```

并将文件另存为：

> AnyName.bat

在您的安装包中，确保*“AnyName.bat”*文件首先运行。

问候

# azure - 用户传递的授权令牌无效。Azure 缓存

> ID：13131019
> 
> 赞同：1
> 
> 时间：2012-10-29T23:12:58.810
> 
> 标签：azure, azure-caching

也许我误解了如何创建缓存，但没有任何 ID 或访问密钥正在用于启用 azure 缓存。我已经完成了以下教程：

[http://msdn.microsoft.com/en-us/library/windowsazure/gg618003.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg618003.aspx)

[http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_buildingappswithcacheservice_topic3#_Toc310505080](http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_buildingappswithcacheservice_topic3#_Toc310505080)

[http://msdn.microsoft.com/en-us/library/windowsazure/gg618003.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg618003.aspx)

大约 1/2 十几种不同的如何在 azure 页面中创建缓存，我仍在学习。

用户传递的授权令牌无效。

我有一个带有链接存储的网站和云服务，但在管理 Azure 门户中找不到 URL“yourcachename.cache.windows.net”或身份验证令牌。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:42:57.180

事实证明，我对 Azure 的版本感到困惑。我不确定这是从哪个版本开始的，但我在 1.8 中工作，我不需要访问密钥。将以下部分添加到 web.config 后，一切正常。

```
 <dataCacheClients>
    <dataCacheClient name="default">
      <autoDiscover isEnabled="true" identifier="{your cache worker role}" />
      <localCache isEnabled="true" sync="TimeoutBased" objectCount="100000" ttlValue="300" />
    </dataCacheClient>
  </dataCacheClients>
  <cacheDiagnostics> 
```

然后为了让 Sessions 工作，我需要添加以下内容：

```
 <sessionState mode="Custom" customProvider="AFCacheSessionStateProvider">
      <providers>
        <add name="AFCacheSessionStateProvider" type="Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider, Microsoft.Web.DistributedCache" cacheName="default" dataCacheClientName="default" applicationName="AFCacheSessionState"/>
      </providers>
    </sessionState> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:52:02.440

您需要通过新门户上的链接登录旧门户，单击共享缓存、服务总线和访问控制。创建/选择一个命名空间，授权令牌将显示在右侧栏上。

# python - opencv/macports 应用程序的 py2app 错误。如何使用 headerpad_max_install_names 标志编译 opencv？

> ID：13131024
> 
> 赞同：4
> 
> 时间：2012-10-29T23:14:08.837
> 
> 标签：python, macos, opencv, macports, py2app

我正在尝试使用 opencv 和 pygame 构建一个应用程序。这两个库已与 macports 一起安装。我还在 macports python 中安装了 py2app。我正在运行一个简单的 py2app 脚本

```
from setuptools import setup

setup(
    app = [
        '/full/path/to/my_script.py',
    ],
    options={
        "py2app":{
            'argv_emulation': True, 
        }
    },
    setup_requires=['py2app']
) 
```

不幸的是，py2app 失败并出现以下错误：“ValueError: New Mach-O header is too large to relocate”

是否可以使用 opencv 和 macports 制作应用程序包？

谢谢你的帮助

更新：

这是 ronaldoussoren whoi 是 py2app 开发者的答案：

> OSX 上的共享库包含指向其位置的绝对路径，同样所有使用的库也使用绝对路径提及。Py2app 使用 macholib 将这些提及重写为以“@executable_path”开头的相对路径。对于位于 /opt/local 中的库，新路径比旧路径需要更多空间，因此会出现错误消息。确保有足够空间的一种方法是链接器标志“headerpad_max_install_names”。我不知道如何告诉 darwinports 在构建 opencv 时添加此标志。

另请注意，我对 pyinstaller 也有类似的问题。

我试图修改opencv Portfile而不做任何更改。我真的不知道在哪里添加这个链接器标志。

知道如何解决吗？

更新：这是我的 Portfile

```
# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 99165 2012-10-28 22:56:03Z jeremyhu@macports.org $

PortSystem                      1.0
PortGroup                       cmake 1.0

name                            opencv
version                         2.4.2
revision                        2
categories                      graphics science
license                         BSD
platforms                       darwin
maintainers                     nomaintainer

description                     Intel(R) Open Source Computer Vision Library

long_description                opencv is a library that is mainly aimed at real time \
                                computer vision. Some example areas would be \
                                Human-Computer Interaction (HCI), Object Identification, \
                                Segmentation and Recognition, Face Recognition, Gesture \
                                Recognition, Motion Tracking, Ego Motion, Motion \
                                Understanding, Structure From Motion (SFM), and Mobile \
                                Robotics.

homepage                        http://opencv.willowgarage.com/wiki/
master_sites                    sourceforge:project/opencvlibrary/opencv-unix/${version}
use_bzip2                       yes
distname                        OpenCV-${version}

checksums                       rmd160  496964503629b0ff4432fbdd276837ab3f134411 \
                                sha256  690023811e03e21df996291392fcf78e43e42ef557b9307503c74c74b4272c28

depends_build-append            port:pkgconfig

depends_lib-append              port:zlib \
                                path:lib/libavcodec.dylib:ffmpeg \
                                port:libpng \
                                port:tiff \
                                port:jasper \
                                port:jpeg \
                                port:bzip2 \
                                port:openexr \
                                port:ilmbase \
                                port:eigen3

patchfiles                      patch-fix_dirname_case.diff \
                                patch-install_name.diff

configure.args-append           -DBUILD_NEW_PYTHON_SUPPORT=OFF \
                                -DBUILD_EXAMPLES=ON \
                                -DINSTALL_C_EXAMPLES=ON \
                                -DBZIP2_LIBRARIES=${prefix}/lib/libbz2.dylib \
                                -DZLIB_LIBRARY=${prefix}/lib/libz.dylib \
                                -DWITH_OPENEXR=ON \
                                -DWITH_1394=OFF \
                                -DWITH_EIGEN=ON \
                                -DEIGEN_INCLUDE_PATH=${prefix}/include/eigen3 \
                                -DBUILD_JASPER=OFF \
                                -DBUILD_JPEG=OFF \
                                -DBUILD_PNG=OFF \
                                -DBUILD_TIFF=OFF \
                                -DBUILD_ZLIB=OFF
configure.ldflags-append        "-Wl,-headerpad_max_install_names"

# gcc-4.0 exits with a bus error
if {${configure.compiler} == "gcc-4.0"} {
    configure.compiler gcc-4.2
    if {![file executable ${configure.cc}]} {
        depends_build-append port:apple-gcc42
        depends_skip_archcheck-append apple-gcc42
        configure.compiler apple-gcc-4.2
    }
}

platform darwin {
    if {${os.major} <= 9} {
        # Video Decode Acceleration Framework is not available
        patchfiles-append       patch-highgui_CMakeLists.txt.diff
    }
}

post-destroot {
    xinstall -d ${destroot}${prefix}/lib/cmake
    move ${destroot}${prefix}/share/OpenCV/OpenCVConfig-version.cmake \
        ${destroot}${prefix}/share/OpenCV/OpenCVConfig.cmake \
        ${destroot}${prefix}/lib/cmake/
}

variant dc1394 description {Use libdc1394 for FireWire camera. Breaks compatibility with Apple iSight FireWire camera.} {
    depends_lib-append          port:libdc1394
    configure.args-delete       -DWITH_1394=OFF
    configure.args-append       -DWITH_1394=ON \
                                -DHAVE_1394=ON
}

variant qt4 description {Use qt4 backend for graphical interface.} {
    PortGroup                   qt4 1.0
    configure.args-append       -DWITH_QT=ON
}

variant python26 conflicts python27 description {Add Python 2.6 bindings} {
    depends_lib-append          port:python26 \
                                port:py26-numpy
    configure.args-delete       -DBUILD_NEW_PYTHON_SUPPORT=OFF
    configure.args-append       -DINSTALL_PYTHON_EXAMPLES=ON \
                                -DBUILD_NEW_PYTHON_SUPPORT=ON \
                                -DPYTHON_EXECUTABLE=${prefix}/bin/python2.6 \
                                -DPYTHON_LIBRARY=${prefix}/lib/libpython2.6.dylib \
                                -DPYTHON_INCLUDE_DIR=${frameworks_dir}/Python.framework/Versions/2.6/Headers \
                                -DPYTHON_PACKAGES_PATH=${frameworks_dir}/Python.framework/Versions/2.6/lib/python2.6/site-packages
}

variant python27 conflicts python26 description {Add Python 2.7 bindings} {
    depends_lib-append          port:python27 \
                                port:py27-numpy
    configure.args-delete       -DBUILD_NEW_PYTHON_SUPPORT=OFF
    configure.args-append       -DINSTALL_PYTHON_EXAMPLES=ON \
                                -DBUILD_NEW_PYTHON_SUPPORT=ON \
                                -DPYTHON_EXECUTABLE=${prefix}/bin/python2.7 \
                                -DPYTHON_LIBRARY=${prefix}/lib/libpython2.7.dylib \
                                -DPYTHON_INCLUDE_DIR=${frameworks_dir}/Python.framework/Versions/2.7/Headers \
                                -DPYTHON_PACKAGES_PATH=${frameworks_dir}/Python.framework/Versions/2.7/lib/python2.7/site-packages
    configure.ldflags-append    "-Wl,-headerpad_max_install_names"
}

variant tbb description {Use Intel TBB} {
    depends_lib-append          port:tbb
    configure.args-append       -DWITH_TBB=ON \
                                -DHAVE_TBB=ON \
                                -DTBB_INCLUDE_DIRS=${prefix}/include \
                                -DOPENCV_LINKER_LIBS="-ltbb -ltbbmalloc"
}

livecheck.type                  sourceforge
livecheck.name                  opencvlibrary
livecheck.regex                 /OpenCV-(\[0-9a-z.\]+)${extract.suffix} 
```

* * *

更新：macport 团队解决了这个问题，但不幸的是他们的修复并没有解决我的问题。见[http://trac.macports.org/ticket/36841](http://trac.macports.org/ticket/36841)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T10:16:02.813

您需要添加

`configure.ldflags-append "-Wl,-headerpad_max_install_names"`

在 OpenCV Portfile 附近的某处`configure.args-append`。（[文档](http://guide.macports.org/chunked/reference.phases.html)）

我希望这可以解决您的问题。否则，您可能还必须使用该标志编译 OpenCV 的所有依赖项，这可能需要大量工作。如果是这种情况，您可能需要查看[https://trac.macports.org/ticket/29838](https://trac.macports.org/ticket/29838)，并且您希望默认启用 headerpad_max_install_names 标志。

如果您希望保留对 Portfile 的更改，而不是在 OpenCV 的下一次更新时撤消，您可以按照[Sneaky patching source with Macports](https://stackoverflow.com/questions/10690159/sneaky-patching-source-with-macports/11907135#11907135)中的说明进行操作。但是，这将阻止自动安装 OpenCV 的更新！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T13:07:42.577

昨天我在 py2app 开发人员的指导下找到了一个解决方案。

首先，知道-Xlinker、-Wl和。-headpad... 标志并没有为我解决问题，尽管我仍然将它们保存在 macports.conf 中。对我来说，关键是增加 macports 文件深度并减少构建目录文件深度。具体来说，我使用 --prefix=/opt/localdepth/localdepth/localdepth/localdepth/local 安装 macports，并在 /opt/build 中构建。现在 py2app 运行成功。

另请参阅： [https ://bitbucket.org/ronaldoussoren/py2app/issue/93/mach-o-header-may-be-too-large-to-relocate](https://bitbucket.org/ronaldoussoren/py2app/issue/93/mach-o-header-may-be-too-large-to-relocate) [https://trac.macports.org/ticket/38163](https://trac.macports.org/ticket/38163)

# jquery - JQuery 自动完成 - 多个结果

> ID：13131026
> 
> 赞同：0
> 
> 时间：2012-10-29T23:14:42.310
> 
> 标签：jquery, jquery-autocomplete

我无法让自动完成功能正常工作。

我的自动完成框显示多个结果，与 DISTINCT 问题无关。

示例：如果我的自动完成显示 2 个可能的选项，那么它会在自动完成框中显示两次结果 - 即 Lungs，Liver，然后是 Lungs，Liver。如果有三个可能的自动完成选项，则结果列表重复三次，依此类推。

在 Firebug 中，我可以看到返回了正确的 Json，结果不重复。

这是一个[屏幕截图：](http://dl.dropbox.com/u/33793648/screen4.jpg)

请问有人知道是什么问题吗？

问候融化

```
$(document).ready(function () {

$('#search').autocomplete({
    source: function (request, response) {
        $.ajax({
            url: '/home/GetSR',
            type: 'GET',
            cache: false,
            contentType: "application/json; charset=utf-8",
            data: { term: request.term },
            dataType: 'json',
            success: function (json) {

                response($.map(json, function (label, value) {
                    return json;

                }));

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert('error - ' + textStatus);
               // console.log('error', textStatus, errorThrown);
            }
        });
    },
    minLength: 2,
    select: function (event, ui) {

       //  alert('you have selected ' + ui.item.label + ' ID: ' + ui.item.value);
          $('#search').val(ui.item.label);

        // save the auto complete value id to be used later
        setACValue(ui.item.value); 

        return false;
    }
}) 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:58:38.447

```
success: function (json) {
                response($.map(json, function (label, value) {
                    return json;
                }));
            }, 
```

应该：

```
success: function (json) {
                response($.map(json, function (label, value) {
                    return value;
                }));
            }, 
```

每次处理 JSON 元素数组的一个元素时，您都会返回整个 JSON 数组，而不是只返回那个元素的值。所以你`$.map`正在返回一个二维数组。

或者，您可以这样做：

```
success: function (json) {
                response(json);
            }, 
```

# cocos2d-iphone - 如何正确处理多个图层的触摸事件？

> ID：13131027
> 
> 赞同：0
> 
> 时间：2012-10-29T23:14:42.377
> 
> 标签：cocos2d-iphone

我目前有一个“控制台”CClayer，它正在处理已添加到其中的精灵的触摸检测。但是，我也有一些我想要进行触摸检测的精灵，它们不属于控制台层......它们目前是从 CCNode 继承的类的子级。

我的理解是，将“isTouchEnabled”属性设置为true的cocos对象越多，性能受到的影响就越大，所以我很好奇我应该如何处理这个问题？

我是不是该：

A) 控制台的 touchesBegan 方法是否执行了对属于 CCNode 的精灵的检测？

B) 只需在 CCNode 对象上实现 isTouchEnabled

C）其他一些方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:58:00.303

好吧，对于初学者来说，如果您担心，您应该只关注性能，即您正在查看或测量（在设备上而不是模拟器上）一些不适当的响应时间。

我会避免检测涉及另一个节点的触摸——它可能会变得混乱，软件明智。当触摸位于检测节点关注的对象的位置时，我倾向于严格返回 YES（来自 ccTouchBegan）。当您返回 NO 时，调度程序会将触摸传递给其他处理程序（“在控制台下”），直到一个这样的 CCNode 咬住它。种如下：

```
- (void) onEnter{
    [[[CCDirector sharedDirector] touchDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES];
    [super onEnter];
}

- (void) onExit{
    [[[CCDirector sharedDirector] touchDispatcher] removeDelegate:self];
[super onExit];
}

- (BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event{
    if (!_visible || !_enabled) {
        return NO;
    }
    CGPoint loc = [touch locationInView:touch.view];
    loc = [[CCDirector sharedDirector] convertToGL:loc];

    if ([self containsPoint:loc]) {
        // do your thing here !
        return YES;
    }

    return NO;
}

-(BOOL) containsPoint:(CGPoint) location {
    // determine here whether this node should be handling
    // this touch.
} 
```

# java - 具有各种类型对象的 Java ArrayList

> ID：13131034
> 
> 赞同：0
> 
> 时间：2012-10-29T23:16:19.157
> 
> 标签：java, list, iteration

我有`CardType1`and `CardType2`that extends`Card`和 an `Area`that has an `ArrayList`of Card。这个数组将充满`CardType1`和`CardType2`对象，但我最终需要像这样访问它们：

```
for (CardType1 card : this.cards) { ... 
```

概述：

```
public class Area {

    List<Card> cards = new ArrayList<Card>();
    ..
}

public class Card {..}

public class CardType1 extends Card {..}

public class CardType2 extends Card {..} 
```

如何仅迭代列表中的*一个*子类型`List<Card> cards`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:20:57.390

您不能这样做，因为卡片中对象的类型是`Card`，而不是`CardType1`：

```
for(CardType1 card : this.cards){ ... 
```

但是，您可以这样做：

```
for(Card card : this.cards) {
    if (card instanceof CardType1) {
        CardType1 card1 = (CardType1) card;
        // do something with the card1
    } else {
        CardType2 card2 = (CardType2) card;
        // do something with the card2
    }
 } 
```

我在这里所做的是像你一样遍历卡片（除了我的类型是最通用的类​​型`Object`）。然后我检查卡片是否是 type `CardType1`，或者`CardType2`，使用`instanceOf`运算符并将其转换为该类型，然后处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T23:24:00.177

多米尼克和内森的答案是正确的。如果您使用的是 Guava，则可以[`Iterables.filter(Iterable, Class)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterables.html#filter%28java.lang.Iterable,%20java.lang.Class%29)用作快捷方式：

```
for (CardType1 card : Iterables.filter(cards, CardType1.class)) {
    ...
} 
```

从文档中：

> `type`返回 中类的所有实例`unfiltered`。返回的可迭代对象具有其类`type`或 的子类的元素`type`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T23:20:49.017

您将只能将每个项目作为`Card`. 如果您能够迭代使用，`CardType1`那么当您遇到 CardType2 类型的卡片时就会出错。

对于您想要的，您必须检查是否`card`是`CardType1`or的实例，`CardType2`然后`card`适当地进行转换：

```
for (Card card : this.cards) {
    if (card instanceof CardType1) {
        CardType1 cardType1 = (CardType1) card;
        // do something with cardType1
    }
    else if (card instanceof CardType2) {
        CardType2 cardType2 = (CardType2) card;
        // do something with cardType2
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T23:21:46.097

```
ArrayList<Card> cards = new ArrayList<>();
cards.add(new CardType1());
cards.add(new CardType2());

for(Card card : this.cards){ 
   // card can be any thing that extends Card. i.e., CardType1, CardType2
   if(card instanceOf CardType1){
       //do cardType1 things
    }
   else if(card instanceof CardType2){
      // do CardType2 things
      }

} 
```

# java - Java2D 和 Swing 不使用 JFrame 和 JPanel 输出图像

> ID：13131035
> 
> 赞同：1
> 
> 时间：2012-10-29T23:16:20.027
> 
> 标签：java, swing, jframe, jpanel, java-2d

我正在研究 swing 和 java2D 中的图形程序的基础知识以进行练习。我遇到了无法显示图像的问题。我将我的代码分为 4 个类，这样当程序变大时，它更易于管理。

这个想法是我在 Main 中几乎没有什么，Frame 初始化我的第一个屏幕，屏幕都可以细分为它们自己的类，TitleScreen 就是其中之一，而 PullImage 完成所有缓冲和打印图像的工作打扰了我。

当我运行它时，我得到一个空窗口并且没有错误，所以我无法弄清楚问题出在哪里。

请并感谢您的帮助。

主要的

```
package com.game.pack;

import javax.swing.JFrame;

public class Main extends JFrame {

private static final long serialVersionUID = 1L;

public final static void main(String[] args) 
{

    new Frame().initialize();
    new TitleScreen().openScreen();

}
} 
```

框架

```
package com.game.pack;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class Frame extends JFrame{

private static final long serialVersionUID = 1L;

public final void initialize()
{
    JFrame frame = new JFrame("Game");
    JPanel panel = new JPanel();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(800,600);
    panel.setSize(800,600);
    frame.setLayout(null);
    panel.setLayout(null);
    frame.setLocationRelativeTo(null);
    this.getContentPane().add(panel);
    panel.setVisible(true);
    frame.setVisible(true);
}

public final void close()
{
    dispose();
}

} 
```

标题画面

```
package com.game.pack;

public class TitleScreen {

    public void openScreen()
    {
        new PullImage().printARGB("icons/titleBG.png",800,600,0,0);
        new PullImage().printARGBFromSheet("icons/titleButtons.png",
            200, 125, 400, 200, 200, 40, 0, 0);
        while (1!=2)
    {
} 
```

拉取图像

```
package com.game.pack;

import java.awt.Graphics;
import java.awt.Image;
import java.awt.image.BufferedImage;
import javax.swing.ImageIcon;

public class PullImage {

public void printARGB(String source, int sizeX, int sizeY, int locX, int locY)
{
    Image Icon = new ImageIcon(source).getImage();
    BufferedImage BuffedImage = new BufferedImage(sizeX, sizeY, BufferedImage.TYPE_INT_ARGB);
    Graphics graphics = BuffedImage.getGraphics();
    graphics.drawImage(Icon,locX,locY,null);
}

public void printARGBFromSheet(String source, int sizeX, int sizeY, int locX, int locY, int width, int height, int sheetLocX, int sheetLocY)
{
    Image Icon = new ImageIcon(source).getImage();
    BufferedImage BuffedImage = new BufferedImage(sizeX,sizeY,BufferedImage.TYPE_INT_ARGB);
    Graphics graphics = BuffedImage.getGraphics();
    graphics.drawImage(Icon, locX, locY, locX+width, locY+height, sheetLocX, sheetLocY, sheetLocX+width, sheetLocY+height, null);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:31:44.117

这里有一个问题：

```
public final void initialize()
{  
    this.getContentPane().add(panel);
} 
```

这是将框架的内容窗格设置为面板，而不是您创建的 JFrame。本质上，您并没有将其添加到实际的可见窗口中。只需将其替换为

```
frame.getContentPane().add(panel); 
```

# ruby-on-rails - 未设置安全会话 cookie

> ID：13131036
> 
> 赞同：2
> 
> 时间：2012-10-29T23:16:21.317
> 
> 标签：ruby-on-rails, ruby, cookies, session-cookies

我正在尝试将会话 cookie 安全标志设置为 true。我将以下内容添加到我的环境/production.rb

```
ActionController::Base.session_options[:secure] = true 
```

在生产模式下，我在服务器响应中看不到 set-cookie 标头（我正在使用 Tamper Data Firefox 工具查看流量）。我尝试删除所有cookie，手动设置包括子域的域（由于域在许多应用程序之间共享，appache服务器将请求转发到正确的应用程序，因此应用程序服务器始终接收请求，就好像它来自本地主机一样）。我还尝试在开发模式下对其进行测试，我假设服务器至少应该设置 cookie，即使请求是通过 http 进行的，但浏览器不会通过 http 发送 cookie，但服务器也不会发送 set-cookie 标头. 如果我不设置安全标志，会话就可以正常工作。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:58:31.067

我发现在我的 actionpack 版本中，会话 cookie 仅通过 ssl 设置。虽然根据定义，当请求通过 http 时，服务器可以设置一个安全的 cookie，但浏览器不会将它与进一步的请求一起发送。在我的应用程序中，我没有在应用程序级别强制执行 ssl，而是在 appache 级别强制执行，因此 rails 发出的初始请求是通过 http 并且未设置 cookie。

# ruby-on-rails - 添加购物车项目 Ruby on Rails

> ID：13131037
> 
> 赞同：8
> 
> 时间：2012-10-29T23:16:24.530
> 
> 标签：ruby-on-rails, ruby-on-rails-3, checkout, cart

我正在开发一个非常基本的购物车，我遇到的问题是，如果我将多个相同的产品添加到我的购物车中，我并没有看到数量增加，而只是看到了该商品的多个版本。

例如我看到：

1 x 绿灯 = 15 英镑 1 x 绿灯 = 15 英镑

而不是看到：

2 x 绿灯 = 30 英镑

我怎样才能让我的购物车检查购物车中的多个版本，然后将它们添加在一起？

目前我有：

应用控制器

```
 def current_cart
  if session[:cart_id]
    @current_cart ||= Cart.find(session[:cart_id])
  end
  if session[:cart_id].nil?
    @current_cart = Cart.create!
    session[:cart_id] = @current_cart.id
  end
  @current_cart
  end 
```

推车控制器

```
 def show
    @cart = current_cart
   end 
```

购物车型号

```
 has_many :items

 def total_price
   items.to_a.sum(&:full_price)
 end 
```

购物车视图

```
 <table id="line_items">
   <tr>
     <th>Product</th>
     <th>Qty</th>
     <th class="price">Unit Price</th>
     <th class="price">Full Price</th>
   </tr>

  <% for item in @cart.items %>
    <tr class="<%= cycle :odd, :even %>">
       <td><%=h item.product.name %></td>
       <td class="qty"><%= item.quantity %></td>
       <td class="price"><%= gbp(item.unit_price) %></td>
       <td class="price"><%= gbp(item.full_price) %></td>
    </tr>
   <% end %>
 <tr>

  <td class="total price" colspan="4">
    Total: <%= gbp(@cart.total_price) %>
  </td>
  </tr>
  </table> 
```

**更多信息**

产品#索引

```
 <%= link_to "Add to Cart", line_items_path(:product_id => product), :method => :post %> 
```

人们可以提供的任何建议将不胜感激。谢谢！

**新设置**- 导致错误`Uninitialised Constant CartController`

路由.rb

```
 Checkout::Application.routes.draw do

   ActiveAdmin.routes(self)

   devise_for :admin_users, ActiveAdmin::Devise.config

   post '/add_to_cart/:product_id' => 'cart#add_to_cart', :as => 'add_to_cart'

   resources :carts
   resources :products
   resources :items

   root :to => 'products#index'

 end 
```

推车控制器

```
 class CartsController < ApplicationController

   def show
     @cart = current_cart
   end

   def add_to_cart
       current_cart.add_item(params[:product_id])
       redirect_to carts_path(current_cart.id)
   end

 end 
```

推车模型

```
class Cart < ActiveRecord::Base
has_many :items

def add_item(product_id)
        item = items.where('product_id = ?', product_id).first
    if item
        # increase the quantity of product in cart
        item.quantity + 1
        save
    else
        # product does not exist in cart
        product = Product.find(product_id)
        items << product
    end
    save
end

def total_price
    items.to_a.sum(&:full_price)
end
end 
```

产品#索引

```
<table class="jobs">
    <thead>
        <tr>
            <th scope="col" id="name">Product Code</th>
            <th scope="col" id="company">Name</th>
            <th scope="col" id="company">Price</th>
            <th scope="col" id="company">Action</th>
        </tr>
    </thead>

    <tbody>
        <% @product.each do |product| %>
        <tr>    
            <td><%= product.product_code %></td>
            <td><%= product.name %></td>
            <td><%= gbp(product.price) %></td>
            <td><%= button_to "Add to Cart", add_to_cart_path(:product_id => product), :method => :post %></td>
        </tr>
        <% end %>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-30T11:39:10.393

在您的 Cart 模型中，创建一个名为

```
def add_item(product_id)
  item = items.where('product_id = ?', product_id).first
  if item
    # increase the quantity of product in cart
    item.quantity + 1
    save
  else
    # product does not exist in cart
    cart.items << Item.new(product_id: product_id, quantity: 1)
  end
  save
end 
```

在 routes.rb 中，

```
post '/add_to_cart/:product_id' => 'cart#add_to_cart', :as => 'add_to_cart' 
```

将您的 Add to Cart 路由更改为 Cart 控制器中的 call add_to_cart 方法。

```
def add_to_cart
  current_cart.add_item(params[:product_id])
  # redirect to shopping cart or whereever
end 
```

这应该让你知道你想要完成什么。

# sql - 多列约束

> ID：13131039
> 
> 赞同：0
> 
> 时间：2012-10-29T23:16:27.070
> 
> 标签：sql, oracle, oracle11g, constraints, alter

我有一个包含 7 列（f_name、l_name、sex、birth_date、matri_num、dept、sal）的表，我想添加一个约束来验证 3 列（f_name、l_name、birth_date）中至少有 2 个已填充.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T08:38:19.027

```
ALTER TABLE <your_table>
  ADD CONSTRAINT TWO_FILLED
  CHECK(NVL2(F_NAME, 1, 0) + NVL2(L_NAME, 1, 0) + NVL2(BIRTH_DATE, 1, 0) >= 2); 
```

# java - 如何从 Android 的 ListView 中删除项目？是否有像 iOS 那样的内置控件？

> ID：13131042
> 
> 赞同：0
> 
> 时间：2012-10-29T23:16:53.337
> 
> 标签：java, android, ios, eclipse, android-listview

iOS 有一个易于添加的编辑按钮，该按钮附加到 UITableView 以允许快速轻松地删除项目。请参阅此处的屏幕截图：

![在此处输入图像描述](../Images/8f38ca48f1f1d3bf79add3275541c0db.png)

![在此处输入图像描述](../Images/abaa53da6f4f133d2f023dc8a8451a47.png)

是否有任何内置的 Android（特别是 4.0 及更高版本），所以我不必创建自己的自定义删除控件和代码？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:28:21.990

那确实很好。不幸的是，Android 没有内置的。您需要自己添加。

# linux - 如何在bash中输出目录的不可读内容

> ID：13131044
> 
> 赞同：0
> 
> 时间：2012-10-29T23:17:20.300
> 
> 标签：linux, file, bash, permissions, directory

在 bash 中，如何输出目录的不可读内容？

例如，假设目录是`~/foo`，并且有一个不可读的文件夹`~/foo/folder`，其中包含一个文件`~/foo/folder/file1.txt`，以及另一个不可读的文件`~/foo/file2.txt`。我想输出：

```
~/foo/folder cannot be read.
~/foo/folder/file1.txt cannot be read.
~/foo/file2.txt cannot be read. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:42:44.917

目录权限很有趣。如果您没有目录的读取权限，则无法通过系统调用（例如 ,等`readdir()`命令，甚至 shell 生成文件名列表的方式）找出其中包含哪些文件。`find``ls`

如果您对某个目录具有读取权限，则可以在该目录中找到文件的基本列表，但您需要“执行”权限才能访问这些文件，甚至可以找出文件权限。

如果您有执行权限但没有读取权限，但您知道目录中文件的名称，您可以列出该文件并访问它（如果文件权限允许您这样做）。

因此，如果该目录不可读但您对该目录具有执行权限，则可以调查该目录中您知道的任何文件。但是，您无法找出那里有哪些文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:29:30.613

如果您无法读取文件夹`~/foo/folder`，则您无法检测其中的任何文件，无论它们是否可读。

如果您可以阅读`~/foo`，则可以检查所有文件和目录并测试它们是否可读：

```
find ~/foo | while read file; do
    if test \! -r "$file"; then
        echo "$file cannot be read"
    fi
done 
```

# sql-server - “IN”关键字sql文件路径

> ID：13131045
> 
> 赞同：3
> 
> 时间：2012-10-29T23:17:28.017
> 
> 标签：sql-server

在将应用程序从访问权限移动到 sql server 时，我遇到了一个导致错误的关键字。查询中的关键字是“IN”。INSERT INTO Table IN 'sql server 数据库的文件路径'。sql server 是否允许您使用查询中的文件路径插入数据？我已经研究了几天，但什么也没想到。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:42:54.253

此语法中 Microsoft Access 中的`IN`关键字允许您指定表所在的另一个数据库文件。这相当于在 Sql Server 中的另一个数据库中。

看起来您正在获取多个 Access 数据库文件并将它们导入到多个 Sql Server 数据库中。假设您有一个名为 One.MDB 的 Access 数据库，它从 Access 数据库 Two.MDB 中的表中获取一些数据，并且您已将 Sql Server 导入数据库`One`和`Two`. 所以你需要从另一个数据库中获取数据。Sql Server 使用的语法`Database.Schema.Table`（默认情况下架构是数据库所有者架构，或 dbo）。

所以这在 Microsoft Access 中：

```
INSERT INTO MyTable IN 'Two.MDB' ... 
```

在 Sql Server 中转换为：

```
INSERT INTO Two.dbo.MyTable ... 
```

这是假设您仍在使用单独的数据库。如果你把它们都放在同一个数据库中，你只需要直接引用表：

```
INSERT INTO MyTable ... 
```

# sql - TSQL 从 Case 语句中插入列默认值

> ID：13131046
> 
> 赞同：4
> 
> 时间：2012-10-29T23:17:30.700
> 
> 标签：sql, sql-server, tsql, stored-procedures, sql-server-2012

我想在存储过程插入中使用列的默认值，这样我就不必在多个地方重复默认值（它可能会改变...... DRY 原则）。

T-SQL INSERT 操作有一个方便的“默认”关键字，我可以使用如下：

```
Declare @newA varchar(10)
Set @newA = 'Foo2'

-- I can use "default" like so...
Insert into Table_1 (
    A, 
    B) 
Values (
    @newA, 
    default) 
```

但是，如果我需要做一些有条件的事情，我似乎无法让 case 语句返回“默认”。

```
-- How do I use 'default' in a case statement? 
INSERT INTO Table_1 (
    A,
    B )
VALUES (
    @newA,
    CASE WHEN (@newA <> 'Foo2') THEN 'bar' ELSE default END)
-- > yeilds "Incorrect syntax near the keyword 'default'." 
```

我*可以*插入默认值，然后根据需要进行更新，如下所示：

```
INSERT INTO Table_1 (
    A,
    B )
VALUES (
    @newA,
    default)
UPDATE Table_1 
SET B = CASE WHEN (A <> 'Foo2') THEN 'bar' ELSE B END
WHERE ID = SCOPE_IDENTITY() 
```

但我真的很想有人告诉我“有更好的方法……”

如果有帮助，这是此示例的表定义...

```
CREATE TABLE dbo.Table_1 (
    ID int NOT NULL IDENTITY (1, 1),
    A varchar(10) NULL,
    B varchar(10) NULL  )  
GO
ALTER TABLE dbo.Table_1 ADD CONSTRAINT DF_Table_1_A DEFAULT 'A-Def' FOR A
GO
ALTER TABLE dbo.Table_1 ADD CONSTRAINT DF_Table_1_B DEFAULT 'B-Def' FOR B
GO 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:20:42.950

`default`只能在`VALUES()`块内工作，这似乎不是`CASE`语句中可接受的值；您可以使用 if 语句来确定要插入的内容：

```
DECLARE @newA varchar(10) = 'Foo2'

IF (@newA <> 'Foo2')
BEGIN
   INSERT INTO Table_1 (A, B)
   SELECT @newA, 'bar'
END
ELSE
BEGIN
   --If you are using default values, you do not have to specify the column
   INSERT INTO Table_1 (A) 
   SELECT @newA
END 
```

我认为这比插入后更新要好，因此您只需将正确的数据插入表中。它还将 INSERTS/UPDATES 的数量保持为 1。由于作用域，您在使用 @@IDENTITY 时也应该小心。考虑调查[**SCOPE_IDENTITY()**](http://msdn.microsoft.com/en-us/library/ms190315.aspx)。

# linux - Linux递归查找具有给定字符串的文件名

> ID：13131048
> 
> 赞同：120
> 
> 时间：2012-10-29T23:17:49.577
> 
> 标签：linux, string, find

我在 Ubuntu 上，我想在当前目录和子目录中查找名称包含字符串“John”的所有文件。我知道`grep`可以匹配文件的内容，但我不知道如何将它与文件名一起使用。

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2012-10-29T23:19:39.787

使用[查找](https://www.mankier.com/1/find)命令，

```
find . -type f -name "*John*" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-18T03:50:33.227

该`find`命令将花费很长时间，因为它会扫描文件系统中的真实文件。

最快的方法是使用`locate`命令，它会立即给出结果：

```
locate "John" 
```

如果找不到该命令，则需要先安装`mlocate`包并运行`updatedb`命令，以准备第一次搜索数据库。

更多详细信息：[https ://medium.com/@thucnc/the-fastest-way-to-find-files-by-filename-mlocate-locate-commands-55bf40b297ab](https://medium.com/@thucnc/the-fastest-way-to-find-files-by-filename-mlocate-locate-commands-55bf40b297ab)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-24T14:25:00.300

这是一个非常简单的解决方案，使用`tree`您要搜索的目录中的命令。`-f`显示完整的文件路径，`|`用于将 tree 的输出通过管道传输`grep`到名称中包含字符串的文件`filename`。

```
tree -f | grep filename 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-12T04:03:56.020

使用 ack 很简单。只需键入`ack <string to be searched>`

# python - 如何匹配以下正则表达式 python？

> ID：13131052
> 
> 赞同：1
> 
> 时间：2012-10-29T23:18:22.580
> 
> 标签：python, regex

如何将以下内容与正则表达式匹配？

```
string1 = '1.0) The Ugly Duckling (TUD) (10 Dollars)'
string2 = '1.0) Little 1 Red Riding Hood (9.50 Dollars)' 
```

我正在尝试以下操作：

```
groupsofmatches = re.match('(?P<booknumber>.*)\)([ \t]+)?(?P<item>.*)(\(.*\))?\(.*?((\d+)?(\.\d+)?).*([ \t]+)?Dollars(\))?', string1) 
```

问题是当我将它应用于 string2 时它工作正常，但是当我将表达式应用于 string1 时，由于“（TUD）”部分，我无法获得“m.group（name）”。我想使用一个适用于两个字符串的表达式。

我预计：

```
booknumber = 1.0
item = The Ugly Duckling (TUD) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:26:42.533

您可以对重复的字符施加一些更严格的限制：

```
groupsofmatches = re.match('([^)]*)\)[ \t]*(?P<item>.*)\([^)]*?(?P<dollaramount>(?:\d+)?(?:\.\d+)?)[^)]*\)$', string1) 
```

这将确保数字取自最后一组括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:49:24.093

我建议你使用正则表达式模式

```
(?P<booknumber>[^)]*)\)\s+(?P<item>.*\S)\s+\((?!.*\()(?P<amount>\S+)\s+Dollars?\) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T23:28:00.263

我会把它写成：

```
num, name, value = re.match(r'(.+?)\) (.*?) \(([\d.]+) Dollars\)', s2).groups() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T23:28:00.870

你的问题是`.*`贪婪匹配，它可能消耗了太多的字符串。打印所有匹配组将使这一点更加明显：

```
import re

string1 = '1.0) The Ugly Duckling (TUD) (10 Dollars)'
string2 = '1.0) Little 1 Red Riding Hood (9.50 Dollars)'

result = re.match(r'(.*?)\)([ \t]+)?(?P<item>.*)\(.*?(?P<dollaramount>(\d+)?(\.\d+)?).*([ \t]+)?Dollars(\))?', string1)

print repr(result.groups())
print result.group('item')
print result.group('dollaramount') 
```

[将它们更改为`*?`使匹配最小](http://docs.python.org/dev/library/re.html#regular-expression-syntax)。

这在某些 RE 引擎中可能很昂贵，因此您也可以编写 eg`\([^)]*\)`来匹配所有括号。如果您不处理大量文本，则可能无关紧要。

顺便说一句，您应该真正使用原始字符串（即`r'something'`）作为正则表达式，以避免令人惊讶的反斜杠行为，并为读者提供线索。

我看到你有这个组`(\(.*?\))?`可能正在删除`(TUD)`，但如果你真的想在标题中使用它，只需将其删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T23:29:31.640

这就是我将如何使用[演示](http://regex101.com/r/rI3iG3)

`(?P<booknumber>\d+(?:\.\d+)?)\)\s+(?P<item>.*?)\s+\(\d+(?:\.\d+)?\s+Dollars\)`

# rubygems - 使用 RubyGems 创建本地 gem 很困难

> ID：13131053
> 
> 赞同：1
> 
> 时间：2012-10-29T23:18:24.897
> 
> 标签：rubygems

每当我使用 RubyGems 开发 gem 时，我总是需要将任何更改作为不同版本推送到 ruby​​gems，然后更新我的 Gemfile 以进行测试程序。虽然这确实有效，但很烦人，因为我每次都需要更新版本，然后下载 Gemfile 内容并运行程序以查看它是否有效。

理想情况下，我想设置我正在使用 gem 的项目，但要在本地指向它，而不是从 RubyGems 下载的 gem。我已经尝试使用该`:git => '...'`属性使用本地和远程 git 存储库，并且我也尝试过使用`:local => /path/to/gem-directory`但没有任何效果。

关于如何设置的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:07:54.073

每当我需要针对我的 Rails 应用程序测试 ruby​​gem 时，我都会像这样编辑 Rails 应用程序的 Gemfile：

```
gem 'my_gem_name', :path => '/path/to/my_gem_name' 
```

每次您想测试 gem 中的更改时，不要忘记`bundle update`在主应用程序上运行，这样 bundler 将获取最新版本的 gem。

# javascript - 从 `__defineGetter__` 访问原始属性值

> ID：13131060
> 
> 赞同：4
> 
> 时间：2012-10-29T23:19:16.540
> 
> 标签：javascript, oop

是否可以从 Javascript getter 访问原始属性值？

如果没有，是否还有其他“现代”javascript 技术可以实现类似的功能？

也就是说，如果我有这样的代码

```
o = {}
o.foo = "bar"
o.__defineGetter__("foo", function(){
    //can I access the value "bar" here?
    return "some other value";
}); 
```

是否可以从我的 getter 函数中访问值“bar”？还是使用会`__defineGetter__`吹走财产？

（背景：不是新手开发人员，但在过去的 4/5 年里我一直忽略非跨浏览器 Javascript，我希望能赶上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:34:08.840

ECMAscript 262 第 5 版引入了在规范正式定义的对象上使用*getter*和*setter的选项。*您可以直接在对象文字上设置它们

```
var foo = {
    get bar() {
        return "foo";
    }
}; 
```

或使用`Object.defineProperty()`

```
var foo = { };
Object.defineProperty(foo, 'bar', {
    get: function() {
        return "foo";
    }
}); 
```

但是，问题仍然存在。覆盖一个属性将不可撤销地覆盖它。您可以做的是使用这些对象`prototype chain`来闪烁属性。

* * *

```
var foo = { };

foo.bar = 42;

Object.defineProperty(Object.getPrototypeOf( foo ), 'bar', {
    get: function() {
        return 'overwritten';
    },
    configurable: true
});

console.log( foo.bar );   // 42
delete foo.bar;
console.log( foo.bar );   // "overwritten" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:37:37.153

不，[`__defineGetter__`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineGetter)（以及[`Object.defineProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)）覆盖所有旧的。*在“吹走该属性*”之前，您必须将旧值缓存在一个额外的变量中。

使用 IEFE 作为闭包：

```
o = {foo: "bar"};

(function(oldval) {
    o.__defineGetter__("foo", function(){
        return "new"+oldval;
    });
})(o.foo);
o.foo; // "newbar" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T00:11:49.280

__defineGetter__ 就像一个快捷方式

```
Object.defineProperty(o, "foo", {get : function() { 
        return "some other value";
    },  
    enumerable : true}); 
```

所以**o.foo**的值被简单地覆盖了。为了解决这个问题，添加额外的属性**o._foo**并且不要忘记 setter。

我的例子：

```
var o = {};

Object.defineProperty(o, "foo", {
    get : function() { 
        return this._foo;
    },
    set : function(value) { 
        this._foo = value;
    },
    enumerable : true});

o.foo = "newbar";
o.foo;  //newbar 
```

# java - 安全打开和关闭模态 JDialog（使用 SwingWorker）

> ID：13131061
> 
> 赞同：5
> 
> 时间：2012-10-29T23:19:22.167
> 
> 标签：java, multithreading, swing, jdialog, swingworker

我需要一种从数据库中获取一些数据并阻止用户修改现有数据的方法。

我创建了一个 SwingWorker 来更新数据库，并创建了一个模态 JDialog 来向用户展示正在发生的事情（使用 JProgressBar）。模态对话框的 defaultCloseOperation 设置为 DO_NOTHING，因此只能通过适当的调用来关闭它 - 我使用`setVisible(false)`.

```
MySwingWorkerTask myTask = new MySwingWorkerTask();
myTask.execute();
myModalDialog.setVisible(true); 
```

SwingWorker 在 doInBackground() 中做了一些事情，最后它调用：

```
myModalDialog.setVisible(false); 
```

我唯一关心的问题和我的问题：SwingWorker 是否有可能在工人产生之后执行它`setVisible(false)`之前`setVisible(true)`的行？

如果是这样，`setVisible(true)`可能会永远阻塞（用户无法关闭模式窗口）。

我是否必须执行以下操作：

```
while (!myModalDialog.isVisible()) {
    Thread.sleep(150);
}
myModalDialog.setVisible(false); 
```

以确保它实际上会关闭？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:23:12.220

一般来说，是的。

我要做的是在您的`doInBackground`方法中`SwingUtilities.invokeLater`用于显示对话框并在您的`done`方法中隐藏对话框。

这应该意味着即使对话框没有出现在屏幕上，您也可以对流程进行更多控制......

小问题是您现在必须将对话框传递给工作人员，以便它可以控制它......

```
public class TestSwingWorkerDialog {

    public static void main(String[] args) {
        new TestSwingWorkerDialog();
    }
    private JDialog dialog;

    public TestSwingWorkerDialog() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                MyWorker worker = new MyWorker();
                worker.execute();

            }
        });
    }

    public class MyWorker extends SwingWorker<Object, Object> {

        @Override
        protected Object doInBackground() throws Exception {
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    getDialog().setVisible(true);
                }
            });
            Thread.sleep(2000);

            return null;
        }

        @Override
        protected void done() {
            System.out.println("now in done...");
            JDialog dialog = getDialog();
            // Don't care, dismiss the dialog
            dialog.setVisible(false);
        }

    }

    protected JDialog getDialog() {
        if (dialog == null) {

            dialog = new JDialog();
            dialog.setModal(true);
            dialog.setDefaultCloseOperation(JDialog.DO_NOTHING_ON_CLOSE);
            dialog.setLayout(new BorderLayout());
            dialog.add(new JLabel("Please wait..."));
            dialog.setSize(200, 200);
            dialog.setLocationRelativeTo(null);

        }

        return dialog;
    }

} 
```

# nuget - 管理非 nuget dll 以及 nuget 包

> ID：13131064
> 
> 赞同：2
> 
> 时间：2012-10-29T23:19:41.057
> 
> 标签：nuget, dll

是否有任何指南或建议来管理不在 nuget 上的库以及在 nuget 上的包。

其中大多数可能是 3rd 方库，除非我们专门安装它们，否则它们可能永远不会继续使用 nuget。

最好将这些 dll 放在 nuget 用于存储其下载的 dll 的同一文件夹中，还是将它们放在一起更好？

一旦我们解决这个问题，我们将考虑转移到 DVCS，并且可能会添加一个忽略文件以忽略整个包目录（并可能为这些非 nuget dll 添加排除项，或者如果它们确实发生更改，则强制它们被签入）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T06:51:20.140

**我的个人喜好（按顺序）**

1.  创建一个包并将其添加到 NuGet（如果许可允许）
2.  创建一个包并将其放在私有存储库中
3.  在解决方案中创建一个文件夹，将它们全部存储在那里，将它们添加到源代码管理中。与 nuget packages 文件夹不同的文件夹，因为它更清楚它是什么，而且我没有将 nuget dll 添加到源代码管理中。

对于 1 和 2，我建议在构建时使用恢复包，而不是将其存储在源代码管理中。

我还强烈建议不要从安装文件夹或 GAC 中引用任何第三方控件。

# mysql - 将客户现有的 MS Access 数据库与他的 Linux 托管站点集成？

> ID：13131065
> 
> 赞同：0
> 
> 时间：2012-10-29T23:19:41.247
> 
> 标签：mysql, database, linux, ms-access

我的客户问我是否可以将他现有的 Microsoft Access 数据库与他的 Linux 共享主机网站集成。他一直在使用 Microsoft Access 在他的本地计算机上保存客户数据的记录，但现在希望让他们能够在线查看他们的数据。在我用最好的方法回复他之前，我想在这里问几个问题。

目前，我似乎有两个可行的选择：
**a)**将他的数据库转换为 MySQL 或类似的，并允许他使用基于 Web 的界面而不是 Microsoft Access 桌面客户端继续更新数据库。

**b)**允许他继续使用 Microsoft Access，并允许他将更新的文件上传到将解析它们的脚本，然后更新 MySQL 数据库。

*我做了一些关于直接在 Linux 上使用 Microsoft Access 数据库的研究，但它似乎没有得到很好的支持，也不是最好的选择。*

显然选项**b**需要做更多的工作，但我担心他会拒绝从 Microsoft Access 更改为基于 Web 的替代方法来更新数据。我只是想在回复他之前得到一些反馈。

那么，将我客户现有的 MS Access 数据库与他的 Linux 托管站点集成的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:22:56.953

您可以使用 PDO 使用 PHP 查询 Microsoft Access 数据库，但它可能不是 Web 最强大的选项。Access 设计为单用户数据库，您可能会遇到中度到严重的性能问题。

可以在此处找到有关如何完成此操作的指南：http: [//phpmaster.com/using-an-access-database-with-php/](http://phpmaster.com/using-an-access-database-with-php/)

大约 7 年前，我遇到了类似的问题，我们最终将数据库转换为 MySQL，并让一些用户通过 Access 与数据进行交互，这为我们提供了一个可以在 Web 上使用的数据库，以及一个熟悉的用户界面拒绝更改为使用网络，尽管您的里程可能会有所不同： http: [//dev.mysql.com/doc/refman/5.1/en/connector-odbc-examples-tools-with-access.html](http://dev.mysql.com/doc/refman/5.1/en/connector-odbc-examples-tools-with-access.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T12:24:11.660

有一个新的软件工具，CNS Media Gateway，您可以使用。

您可以通过 CNS ODBC 和 JDBC 驱动程序从任何自定义应用程序或平台（如 Linux）连接到 MS Access、Exchange (2000 - 2013)、MS SharePoint、Dynamics CRM、Dynamics NAV 等，从而访问整个 Exchange来自您的自定义应用程序的邮箱。

我希望这篇文章能帮助你回答你的问题。

欲了解更多信息，请访问：

[http://www.connecting-software.com](http://www.connecting-software.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T04:07:37.817

为什么不考虑将表移到 SQL Server 之类的东西上，或者使用 MySQL，然后继续在用户桌面上使用 Access 前端？

在我看来，对于我们所谓的应用程序之间的区别存在一些广泛的混淆。应用程序具有我们所说的 UI（用户界面）。这意味着您拥有用户代码、表单等用户界面以及报告等内容。

应用程序的这一部分是使用 MS Access 等开发工具构建的。

在使用 MS、Access、Delphi、C++ 或 VB 构建应用程序时，您还必须选择数据库系统来存储这些数据。因此，如果您使用 C++、Delphi、VB 或在这种情况下为 MS Access 编写应用程序，您就可以自由选择合适的数据库系统与该开发工具一起使用。通常，开发具有 MS 访问权限的应用程序软件的人会选择使用名为 JET 的默认和基于文件共享的数据引擎（或现在的 ACE，因为有一个新版本支持 64 位并且还存储过程）。

换句话说，您可以继续使用此应用程序，但只需将表链接到 SQL 服务器，或者在本例中为运行在 Web 服务器上的 MySQL 实例。

所以我不确定为什么这里会出现如此混乱的情况，而且人们无法区分您选择使用的数据库系统？以及使用像 MS Access 这样的工具来构建和开发软件。

我的意思是接下来会发生什么？我们要称 VB 或 C++ 为数据库？人们在我们的行业中不掌握和理解数据库系统与软件开发系统之间的区别似乎非常愚蠢。

我不确定在哪里或为什么会在这里发生如此大的混乱，但我当然希望人们不会被某人付钱或做咨询或实际接受计费的工作时间，其中数据库和应用程序系统之间的基本理解和区别是不明白！我很想对我们 IT 行业可怕的事态和缺乏教育大发雷霆，但我会避免这样做。

无论如何，10 多年来，我一直在使用廉价的低成本网络托管并将 MS Access 应用程序部署到人们的桌面上。我只是将应用程序链接到在 Web 服务器上运行的数据库实例。我开始使用 MySQL 来做这件事，但在过去的很多年里，我一直在使用 SQL Server（而且我一直在使用 SQL Server，因为我更习惯它）。

因此，没有什么能阻止您将数据和表移动到在该 Linux 服务器上运行的某种类型的 SQL 服务器或 MySQL 的实例。因此，您可以“按原样”继续使用 Access 应用程序。通过这种方式，99% 的代码、表单和应用程序应该可以继续运行而无需修改。应用程序中可能有一些小片段和几行代码不起作用，但对于任何熟悉 Access 作为开发的应用程序开发人员来说，这不应该花费超过几个小时的时间工具。

这种设置的美妙之处在于，您构建的任何类型的 Web 界面现在都可以立即在用户桌面上的任何访问表单中看到。用户在 Access 表单和 Access VBA 代码中的任何更新都将立即出现在网站上，因为他们共享同一个数据库系统。

所以我认为最好的方法是首先掌握使用 Access 内置的应用程序与您选择使用 Access 的数据库系统之间的区别。

最后但同样重要的是，Access 现在确实具有 Web 发布功能，您可以根据以下视频了解我如何更改为在 Access 中运行此应用程序以 100% 浏览器：

[http://www.youtube.com/watch?v=AU4mH0jPntI](http://www.youtube.com/watch?v=AU4mH0jPntI)

但是，上述内容确实需要所谓的访问 Web 服务。事实上，它基于一组 Web 服务和添加到 Access 的新界面 - 因此，除非运行 Office 365 或 SharePoint，否则此设置在这种情况下不合适。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T09:28:02.700

商业上有几种选择。下面是来自 Easysoft 的一对，在从 PHP-ODBC 或 PDO 连接时可能会有所帮助：-

1.  [Easysoft ODBC-Access 驱动程序](http://www.easysoft.com/products/data_access/odbc-access-driver/index.html)，它可以在 Linux 上连接到本地访问数据库或使用 Samba 连接到远程 Windows 机器上的 Access 数据库。如果您要使用 Samba，您可以与其他用户同时访问 MS Access 数据库。

2.  [Easysoft ODBC-ODBC 桥](http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html)，这是一个客户端服务器安装，您将客户端 ODBC 驱动程序放在 Linux 上，将 ODBC-ODBC 桥 (OOB) 服务器放在 Windows 上。然后你会得到 PHP 程序 -> OOB 客户端 -> OOB 服务器 -> MS Access ODBC 驱动程序 -> MS Access 数据库。

两种解决方案都有优点和缺点，但它们都应该符合您的要求。您可以从[Easysoft 网站](http://www.easysoft.com)获得该软件的试用版。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-12T18:08:07.217

我刚刚为一个无法将数据库移出 Access 并且没有第三方驱动程序预算的项目做了类似的事情。这是一个非常令人头疼的问题，因此在这里为遇到此问题的其他人记录我的解决方案：

1.  在 Linux 服务器上，我们可以挂载包含 access 数据库的 Windows 网络驱动器，然后使用[Meza 包](https://github.com/reubano/meza)将表加载到内存中。这需要知道我们想要对该表进行哪些更改。

    `meza.io.read_mdb(path, table='TABLENAME')`

2.  为了真正在访问数据库中进行更新，我们将想要进行的更改集移动到共享网络驱动器（我们在上面安装的）上的 .txt 文件中。然后在 Windows 服务器上，我们可以使用 Powershell 脚本读取该文件，在该脚本中生成适当的 SQL 并在 Access 数据库上执行该 SQL。

    `$conn = New-Object System.Data.OleDb.OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$YOURACCESSDATABASE;Persist Security Info=False") $conn.Open() $transaction = $conn.BeginTransaction() $command = $conn.CreateCommand() $command.Transaction = $transaction $command.CommandText = "UPDATE [table] SET [col]=@PARAMNAME" $PARAMVAR = "Set a parameter value" $command.Parameters.AddWithValue("@PARAMNAME",$PARAMVAR) $command.ExecuteNonQuery() $transaction.Commit()`

3.  在我的工作流程中，我有 Linux python 脚本循环和睡眠等待进行更改，然后 Windows Powershell 脚本在完成更改后截断 .txt 文件，这是 Linux python 可以检查以了解它何时准备就绪接着说。

几点注意事项：

*   需要 Windows 服务器上的 Microsoft Access Database Engine 2010，您可以在此处下载：http: [//www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)
*   Powershell 必须运行 x86 架构，因此我将其添加到我的 Powershell 脚本中：

    `if ($env:Processor_Architecture -ne "x86")
    { write-warning 'Launching x86 PowerShell' &"$env:windir\syswow64\windowspowershell\v1.0\powershell.exe" -noninteractive -noprofile -file $PATHTOTHEPOWERSHELLSCRIPTYOUARECURRENTLYRUNNING' -executionpolicy bypass exit }`

# xna-4.0 - 如何在 XNA 中正确加速旋转的 3d 模型？

> ID：13131069
> 
> 赞同：0
> 
> 时间：2012-10-29T23:20:29.550
> 
> 标签：xna-4.0

如何操纵矩阵以使我的船的速度保持在加速度应用的方向上？

当前代码不起作用，因为当我应用加速度然后应用旋转时，加速度随之改变。

我在这里寻找太空船而不是飞机的效果。

任何帮助表示赞赏 - 我知道这对你们游戏程序员来说是基本的东西！

```
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using System;

namespace AsteroidsWindowsGAme
{
    public class ShipModel
    {
        Model model;
        Matrix[] boneTransforms;
        ModelBone shipModelBone;
        Matrix shipTransform;
        TimeSpan lastTime;

        public void Load(ContentManager content)
        {
            model = content.Load<Model>("Ship");
            shipModelBone = model.Bones["Ship"];
            shipTransform = shipModelBone.Transform;
            boneTransforms = new Matrix[model.Bones.Count];
        }

        public void UpdateVelocity(GameTime gameTime)
        {
            if (AccelerationX != 0 || AccelerationY != 0 || AccelerationZ != 0)
            {
                if (lastTime == null)
                {
                    lastTime = gameTime.TotalGameTime;
                }
                else
                {
                    TimeSpan elapsedTime = gameTime.TotalGameTime - lastTime;
                    float elapsedSeconds = (float)elapsedTime.TotalSeconds;
                    VelocityX += AccelerationX * elapsedSeconds;
                    VelocityY += AccelerationY * elapsedSeconds;
                    VelocityZ += AccelerationZ * elapsedSeconds;
                }
            }
        }

        public void UpdatePosition(GameTime gameTime)
        {
            if(VelocityX != 0 || VelocityY != 0 || VelocityZ != 0)
            {
                if (lastTime == null)
                {
                    lastTime = gameTime.TotalGameTime;
                }
                else
                {
                    TimeSpan elapsedTime = gameTime.TotalGameTime - lastTime;
                    float elapsedSeconds = (float)elapsedTime.TotalSeconds;
                    PositionX += VelocityX * elapsedSeconds;
                    PositionY += VelocityY * elapsedSeconds;
                    PositionZ += VelocityZ * elapsedSeconds;
                }
            }
        }

        public void Draw(Matrix world, Matrix view, Matrix projection)
        {
            model.Root.Transform = world;

            Matrix shipRotationMatrix =
                Matrix.CreateTranslation(PositionX, PositionY, PositionZ) *
                Matrix.CreateRotationX(RotationX) *
                Matrix.CreateRotationY(RotationY) *
                Matrix.CreateRotationZ(RotationZ);

            shipModelBone.Transform = shipTransform * shipRotationMatrix;

            model.CopyAbsoluteBoneTransformsTo(boneTransforms);

            foreach (ModelMesh mesh in model.Meshes)
            {
                foreach (BasicEffect effect in mesh.Effects)
                {
                    effect.World = boneTransforms[mesh.ParentBone.Index];
                    effect.View = view;
                    effect.Projection = projection;
                    effect.EnableDefaultLighting();
                }
                mesh.Draw();
            }
        }

        public float RotationX { get; set; }
        public float RotationY { get; set; }
        public float RotationZ { get; set; }
        public float PositionX { get; set; }
        public float PositionY { get; set; }
        public float PositionZ { get; set; }
        public float VelocityX { get; set; }
        public float VelocityY { get; set; }
        public float VelocityZ { get; set; }
        public float AccelerationX { get; set; }
        public float AccelerationY { get; set; }
        public float AccelerationZ { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T05:56:18.120

我想通了：解决方案是将平移矩阵乘以视图矩阵，如下所示：

```
 public void Draw(Matrix world, Matrix view, Matrix projection)
    {
        model.Root.Transform = world;

        Matrix shipRotationMatrix =

            Matrix.CreateRotationX(RotationX) *
            Matrix.CreateRotationY(RotationY) *
            Matrix.CreateRotationZ(RotationZ);

        shipModelBone.Transform = shipTransform * shipRotationMatrix;

        model.CopyAbsoluteBoneTransformsTo(boneTransforms);

        foreach (ModelMesh mesh in model.Meshes)
        {
            foreach (BasicEffect effect in mesh.Effects)
            {
                effect.World = boneTransforms[mesh.ParentBone.Index];
                effect.View = view * Matrix.CreateTranslation(PositionX, PositionY, PositionZ);
                effect.Projection = projection;
                effect.EnableDefaultLighting();
            }
            mesh.Draw();
        }
    } 
```

# jquery - 显示/隐藏列表项 - 一次只有一个

> ID：13131072
> 
> 赞同：0
> 
> 时间：2012-10-29T23:20:43.060
> 
> 标签：jquery, show-hide

我正在使用它来扩展隐藏的列表项。我通过锚链接 (.edit_this) 扩展它们。如何在仅展开/显示一个列表项时隐藏其他列表项？

```
$(document).ready(function(){
$('.show_hide').slideUp(0);
$('.edit_this').click(function(){
var takeID = $(this).attr('id');
$('#'+takeID+'C').slideDown(300);
});$('.close').click(function(){
var takeID = $(this).attr('id').replace('Close','');
$('#'+takeID+'C').slideUp(300);
});
}); 
```

--

```
<li><a href="javascript:void(0);" class="edit_button edit_this" id="1">Edit</a></li>
<li class="show_hide" id="1C">
<p>lkjlkjasdfasdf</p>
<a href="javascript:void(0);"  id="1Close" class="close cancel_btn">Close</a>
</li>

<li><a href="javascript:void(0);" class="edit_button edit_this" id="2">Edit</a></li>
<li class="show_hide" id="2C">
<p>lkjlkjasdfasdf</p>
<a href="javascript:void(0);"  id="2Close" class="close cancel_btn">Close</a>
</li>

<li><a href="javascript:void(0);" class="edit_button edit_this" id="3">Edit</a></li>
<li class="show_hide" id="3C">
<p>lkjlkjasdfasdf</p>
<a href="javascript:void(0);"  id="3Close" class="close cancel_btn">Close</a>
</li> 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:26:02.040

只需向`$('.show_hide').slideUp(300);`您的点击事件添加一个简单的即可：

```
$(document).ready(function() {
    $('.show_hide').slideUp(0);
    $('.edit_this').click(function() {
        $('.show_hide').slideUp(300); // this line
        var takeID = $(this).attr('id');
        $('#' + takeID + 'C').slideDown(300);
    });
    $('.close').click(function() {
        var takeID = $(this).attr('id').replace('Close', '');
        $('#' + takeID + 'C').slideUp(300);
    });
}); 
```

[**演示**](http://jsfiddle.net/9aa5n/1)

# android - 无效的密钥库格式

> ID：13131078
> 
> 赞同：0
> 
> 时间：2012-10-29T23:21:02.257
> 
> 标签：android, keystore, keytool, apk, code-signing-certificate

我得到了一个密钥库文件以及用户名和密码，我需要对更新的应用程序进行签名。但是，在尝试列出文件的内容、尝试在密钥库中创建新密钥等时，我收到“keytool 错误：java.io.IOException: Invalid keystore format”。

我看过类似的帖子，但没有一个对我有帮助。

我期待听到解决方案。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T14:17:55.920

原来该文件是一个包含实际密钥库的 RAR 存档文件。

# php - 如何将 css 样式放在 php“回显”html 表 td 中？

> ID：13131083
> 
> 赞同：0
> 
> 时间：2012-10-29T23:21:49.620
> 
> 标签：php, html, css, echo

这会导致我的整个页面显示为白屏。我猜我错误地使用了“或”。

```
echo "<td nowrap="wrap" style="width:100px;"><center>" . $row['probdis'] . "</center></td></tr>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T23:24:03.710

你没有逃避你的报价，正确的是：

```
echo "<td nowrap=\"wrap\" style=\"width:100px;\"><center>" . $row['probdis'] . "</center></td></tr>"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T23:24:27.017

您需要使用单引号

```
echo "<td nowrap='wrap' style='width:100px;'><center>" . $row['probdis'] . "</center></td></tr>"; 
```

或转义你的双引号

```
echo "<td nowrap=\"wrap\" style=\"width:100px;\"><center>" . $row['probdis'] . "</center></td></tr>"; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-29T23:25:41.343

是的，echo 语句必须使用相同类型的撇号或引号来打开和关闭输出。撇号 ( `'`) 表示 PHP 不会进行内部解析，而引号 ( `"`) 表示将解析输出。通过*解析*，我的意思是 PHP 将寻找要输出的变量。

您的代码应该是：

```
echo '<td nowrap="wrap" style="width:100px;"><center>' . $row['probdis'] . '</center></td></tr>'; 
```

请注意，如果您有一个要包含在输出中的变量，您可以通过以下两种方式之一进行操作：

```
echo 'My variable is ' . $x . '.'; 
```

或者

```
echo "My variable is $x."; 
```

后一种情况演示了解析，并简化了连接。

*请注意，如果您使用撇号，则字符串内部*的引号不需要转义字符，也不会结束 echo 的输出。反过来也是如此，如果使用引号，则内部撇号不需要转义字符，也不需要结束输出。

意识到当您输出 HTML 时，您还必须输出将由客户端（浏览器）读取的引号，因此它变得更加复杂。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-29T23:24:18.653

尝试这个

```
echo '<td nowrap="wrap" style="width:100px"><center>' . $row["probdis"] . '</center></td></tr>'; 
```

# javascript - 如何从嵌套函数调用中传递变量

> ID：13131088
> 
> 赞同：0
> 
> 时间：2012-10-29T23:22:24.630
> 
> 标签：javascript, jquery, jsplumb

我正在做一个嵌套函数调用，但同时我需要将变量传递给嵌套函数，我可以这样做吗？这就是我想要做的

```
allSourceEndpoints.push(jsPlumb.addEndpoint(toId, sourceEndpoint(index), { anchor:sourceAnchors[i], uuid:sourceUUID }));

sourceEndpoint(index) = {
            endpoint:"Dot",

            paintStyle:{ fillStyle:"#225588",radius:3 },
            isSource:true,
            isTarget:true,
            maxConnections:-1,
        //  connector:[ "Flowchart", { stub:[40, 60], gap:10 } ],
        //  connector:[ "Flowchart"],

            hoverPaintStyle:connectorHoverStyle,
            connectorHoverStyle:connectorHoverStyle,
            dragOptions:{},
            overlays:[
                [ "Label", { 
                    location:[0.5, 1.5], 
                    label:""+startEnd[index].start,
                    cssClass:"endpointSourceLabel",
                } ]
            ]
        } 
```

上面的代码不起作用，因为

```
 index 
```

传递我正在做的事情。我需要它，因为我需要找出开始。如果我删除该索引引用和该行

```
 label:""+startEnd[index].start, 
```

它工作正常，但我真的需要包括它。有没有办法做到这一点？？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:25:27.387

将 sourceEndPoint 构造更改为函数并将 JSON 对象作为返回值返回。IE：

```
sourceEndpoint = function(index) {

    return {
            endpoint:"Dot",

            paintStyle:{ fillStyle:"#225588",radius:3 },
            isSource:true,
            isTarget:true,
            maxConnections:-1,
        //  connector:[ "Flowchart", { stub:[40, 60], gap:10 } ],
        //  connector:[ "Flowchart"],

            hoverPaintStyle:connectorHoverStyle,
            connectorHoverStyle:connectorHoverStyle,
            dragOptions:{},
            overlays:[
                [ "Label", { 
                    location:[0.5, 1.5], 
                    label:""+startEnd[index].start,
                    cssClass:"endpointSourceLabel",
                } ]
            ]
        };
    } 
```

# javascript - document.write 有哪些替代方案？

> ID：13131092
> 
> 赞同：0
> 
> 时间：2012-10-29T23:22:45.130
> 
> 标签：javascript, domdocument

我正在尝试动态加载[zoom.it](http://zoom.it/)脚本，但如果没有`document.write`. 问题`document.write`在于它替换了我页面上的所有内容，这是我不想要的。还有哪些其他选择？

这是`document.write`在行动： http: [//jsfiddle.net/JyT9B/6/](http://jsfiddle.net/JyT9B/6/)（注意被删除的元素）。

此外，将`<script>`标签直接放入正文中是有效的：http: [//jsfiddle.net/gTcRw/5/](http://jsfiddle.net/gTcRw/5/)，但我需要动态放置它。

* * *

我还尝试了如何[在页面中动态添加 javascript 文件](https://stackoverflow.com/questions/5751620/ways-to-add-javascript-files-dynamically-in-a-page)和[如何动态添加和删除 js 文件](https://stackoverflow.com/questions/10958467/how-to-add-and-remove-js-files-dynamically)中的方法，但似乎得到了错误`Cannot set property 'innerHTML' of null`，这可能是 zoom.it 特定的东西。我不介意知道为什么会这样。

使用其他方法的 jsfiddle 示例：

*   [$('body').append](http://jsfiddle.net/WZjrm/2/)
*   [$.getScript](http://jsfiddle.net/fsxa6/1/)
*   [document.createElement 根据谷歌分析](http://jsfiddle.net/demC4/3/)
*   [函数中的 document.createElement](http://jsfiddle.net/demC4/4/)

也徒劳地尝试了这个：[.innerHTML](http://jsfiddle.net/kbDny/2/) - 它被添加到 dom 但没有运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:29:00.717

我认为`createElement`and的组合`appendChild`应该起作用，如下所示：

[http://jsfiddle.net/kbDny/3/](http://jsfiddle.net/kbDny/3/)

```
$(function() {
    getScript("http://www.zoom.it/aaa.js");
});

function getScript(src) {
    var scr = document.createElement("script");
    scr.type = "text/javascript";
    scr.src = src;

    var head = document.getElementsByTagName("head")[0];
    head.appendChild(scr);
} 
```

但是没有理由不使用`$.getScript`- 只需将 the`url`作为第一个参数传递，例如：

```
$.getScript(url, function (data, textStatus, jqxhr) {
    // Script loaded successfully
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:20:02.280

最终使用 iframe 来包含一个带有嵌入脚本标签的 html 页面。

iframe 的好处是我可以随意显示/删除它，而不必担心在删除脚本时清理当前页面文档。

IE，

HTML

```
<body>
  <div id="container">
    <a id="show" href="#">show</a>
    <a id="close" href="#">close</a>

    <div id="placeholder"></div>
  </div>
</body>​ 
```

JavaScript

```
function appendFrame(elem) {
  var iframe = document.createElement("iframe");
  iframe.id = "iframe";
  iframe.setAttribute("src", "about:blank");
  iframe.style.width = "200px";
  iframe.style.height = "200px";
  $(elem).append(iframe);
}

function loadIFrame() {
  appendFrame($("#placeholder"));

  var doc = document.getElementById('iframe').contentWindow.document;
  doc.open();
  doc.write("<html><head><title></title></head><body><script src='http://zoom.it/aaa.js'><\/script><\/body><\/html>");
  doc.close();
};

$("#show").click(function() {
  loadIFrame();
});

$("#close").click(function() {
  $("#iframe").remove();
});​ 
```

JSFiddle 解决方案在这里：http: [//jsfiddle.net/7KRcG/2/](http://jsfiddle.net/7KRcG/2/)

# linq - 使用 linq 查找嵌套列表中的最后一条记录

> ID：13131095
> 
> 赞同：1
> 
> 时间：2012-10-29T23:23:13.970
> 
> 标签：linq

我有一个类似这样的嵌套 xml。

```
 < H>

   < FP >
       < Name="FP1"/>

       < R >
       < Name = "R1"/> 

            < O>
            < Name="O1"/>
            < /O>
            < O>
                < Name="O2"/>
            < /O>
     < /R>       
     < R>
     < Name = "R2"/>
         < O>
    < Name="O4"/>
          < /O>
     < /R>
< /FP>

< FP>
    < Name="FP2" />

    < R>
          < Name = "R3"/>

          < O>
             < Name="O5"/>
          < /O>
          < O>
             < Name="O6"/>
          < /O>
    < /R>
< /FP>

   < R> 
       < Name="R4"/>
       < O>
    < Name="O7"/>
   < /O>
        < O>
            < Name="O8"/>
        < /O>
     < /R>
 < R>
     < Name="R5"/>
     < O >
          < Name="O9"/>
     < /O>
  < /R>

< /H> 
```

我正在使用反序列化来读取这个 xml。

这是我的反序列化类：

```
[XmlRoot("H")]
public class ReplyH
{
    [XmlElement("FP")]
    public List<ReplyFP> FPs;

    [XmlElement("R")]
    public List<ReplyR> Rs;

}

public class ReplyFP
{
    [XmlElement("Name")]
    public string Name;

    [XmlElement("R")]
    public List<ReplyR> Rs = new List<ReplyR>();
}

public class ReplyR
{
    [XmlElement("Name")]
    public string Name;

    [XmlElement("O")]
    public List<ReplyO> Os = new List<ReplyO>();
}

public class ReplyO
{
    [XmlElement("Name")]
    public string Name;
} 
```

我需要遍历 O 标签。

类似于 foreach(var O in H.FP.RO) 和 foreach(var O in HRO)

1）。我需要找到`<O>`上面示例中的最后一个标签 < O> < Name = "O9" /> < /O> `. 2). I also need to get the parent`R `Name and`FP `Name if exists for a particular`O`

我怎样才能使用 linq / lambda 表达式得到这个？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:15:59.883

对于更新的问题，使用 Linq-to-objects 的更新答案。

该代码不如 Linq-to-XML falvour 优雅，但它可以工作。

> **笔记**
> 
> 1.  因为 FP 和 Rs 位于顶层的不同集合中，所以**无法**像在源 XML 中那样知道它们的文档顺序。我假设 Rs 跟随 FPs inside `ReplyH`，就像代码显示的那样（示例 XML 似乎也暗示了）。
> 2.  我必须修复要使用的序列化类
>     
>     
>     
>     ```
>     [XmlAttribute("Name")] public string Name; 
>     ```
>     
>     
>     
>     它（意外地？）`XmlElement("Name")`在你的问题中说的

```
using System.Collections.Generic;
using System.Xml.Serialization;
using System.Linq;
using System.IO;
using System;

public class Program
{
    public static void Main(string[] args)
    {
        ReplyH doc;
        using (var reader = new StringReader(xml))
            doc = (ReplyH) new XmlSerializer(typeof(ReplyH)).Deserialize(reader);

        var Rs = doc.FPs
            .SelectMany(fp => fp.Rs.Select(r => new { Parent = fp            , R=r }))
            .Concat    (     doc.Rs.Select(r => new { Parent = (ReplyFP) null, R=r }));

        var Os = Rs.SelectMany(r => r.R.Os.Select(o => new { Parent = r, O=o }));

        var lastO = Os.Last();
        Console.WriteLine(lastO.O.Name);

        if (lastO != null)
        {
            Console.WriteLine("Parent R has name '{0}'", lastO.Parent.R.Name);

            ReplyFP granddad = lastO.Parent.Parent;
            if (granddad != null)
                Console.WriteLine("Parent FP has name '{0}'", granddad.Name);
        }
    }

    const string xml = @"<H>
        <FP Name=""FP1"">
            <R Name=""R1""> 
                <O Name=""O1""/>
                <O Name=""O2""/>
            </R>       
            <R Name=""R2"">
                <O Name=""O4""/>
            </R>
        </FP>
        <FP Name=""FP2"">
            <R Name=""R3"">
                <O Name=""O5""/>
                <O Name=""O6""/>
            </R>
        </FP>
    <!--
        <R Name=""R4"">
            <O Name=""O7""/>
            <O Name=""O8""/>
        </R>
        <R Name=""R5"">
            <O Name=""O9""/>
        </R>
    -->
        </H>";
}

[XmlRoot("H")] public class ReplyH {
    [XmlElement("FP")] public List<ReplyFP> FPs = new List<ReplyFP>();
    [XmlElement("R")] public List<ReplyR> Rs = new List<ReplyR>();
}

public class ReplyFP {
    [XmlAttribute("Name")] public string Name; 
    [XmlElement("R")] public List<ReplyR> Rs = new List<ReplyR>();
}

public class ReplyR {
    [XmlAttribute("Name")] public string Name; 
    [XmlElement("O")] public List<ReplyO> Os = new List<ReplyO>();
}

public class ReplyO {
    [XmlAttribute("Name")] public string Name;
} 
```

输出：

```
O6
Parent R has name 'R3'
Parent FP has name 'FP2' 
```

或者在取消注释最后一个 XML 块之后：

```
O9
Parent R has name 'R5' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:38:32.630

这里使用 Xml.Linq：**更新**另请参阅[更新问题的竞争答案](https://stackoverflow.com/a/13131513/85371)

```
using System.Linq;
using System.Xml.Linq;
using System.Xml.XPath;
using System;

public class stuff
{
    public static void Main(string[] args)
    {
        var doc = XDocument.Parse(xml);

        var last = doc.Root
            .XPathSelectElements("//H/FP/R/O | //H/R/O")
            .Last();

        Console.WriteLine(last);
        Console.WriteLine("Parent R has name '{0}'", last.Parent.Attribute("Name").Value);

        var granddad = last.Parent.Parent;
        if (granddad.Name == "FP")
            Console.WriteLine("Parent FP has name '{0}'", granddad.Attribute("Name").Value);
    }

    const string xml = @"<H>
        <FP Name=""FP1"">
            <R Name=""R1""> 
                <O Name=""O1""/>
                <O Name=""O2""/>
            </R>       
            <R Name=""R2"">
                <O Name=""O4""/>
            </R>
        </FP>
        <FP Name=""FP2"">
            <R Name=""R3"">
                <O Name=""O5""/>
                <O Name=""O6""/>
            </R>
        </FP>
    <!--
        <R Name=""R4"">
            <O Name=""O7""/>
            <O Name=""O8""/>
        </R>
        <R Name=""R5"">
            <O Name=""O9""/>
        </R>
    -->
        </H>";
} 
```

输出

```
<O Name="O6" />
Parent R has name 'R3'
Parent FP has name 'FP2' 
```

如果您取消注释 XML 的最后一部分：

```
<!--
    <R Name=""R4"">
        <O Name=""O7""/>
        <O Name=""O8""/>
    </R>
    <R Name=""R5"">
        <O Name=""O9""/>
    </R>
--> 
```

输出变为：

```
<O Name="O9" />
Parent R has name 'R5' 
```

# jsp - 来自 DAO 类的 JSTL foreach ArrayList 对象不起作用

> ID：13131097
> 
> 赞同：0
> 
> 时间：2012-10-29T23:23:30.057
> 
> 标签：jsp, foreach, arraylist, jstl, dao

您好，我为不同项目的列表输出编写了以下代码。

```
<%
List<ProjektDAO> projektListe = new ArrayList<ProjektDAO>();
projektListe = ProjektDB.getAllProjekte();
for(ProjektDAO i : projektListe)
{
%> Titel: <%= i.getName() %><br>
<%  
}
%> 
```

这里一切正常。

但我的问题是用jstl完成这个

我写了以下代码：

```
<c:forEach items="${projektListe}" var="i">
    <p>Titel:</p> 
    <c:out value="${i.name}"></c:out> <br>
</c:forEach> 
```

我不认为这是一般 `<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>` 的 jstl 错误，因为我包含了 taglib 和 jarfile，因为这个小测试代码正在工作

```
 <c:out value="this is a jstl Test"></c:out> 
```

我不确定我应该写 ${i.name} 还是 ${i.getName()} ，但两个版本都不起作用。

标签有问题还是其他问题？我在 StackOverFlow 或其他地方找不到任何建议。
感谢您的帮助。问候马克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T05:28:03.830

EL/JSTL 仅适用于*作用域*值。您可以将`ProjektDB.getAllProjekte()`结果绑定到`request`或绑定到`session`Servlet 的服务方法 (doGet/doPost)。

在 servlet 中，

```
request.setAttribute("projektListe",ProjektDB.getAllProjekte()); 
```

在 JSP 中，

```
<c:forEach items="${projektListe}" var="i">
    <p>Titel:</p> 
    <c:out value="${i.name}"></c:out> <br>
</c:forEach> 
```

# mysql - 查询结果与 join like 语句相反的两个表

> ID：13131110
> 
> 赞同：0
> 
> 时间：2012-10-29T23:24:17.127
> 
> 标签：mysql

这是获得一些奖牌的简单问题:)：我有三个表：“联系人”，其中包含联系人信息，其中每个条目都有一个唯一的 ID。第二个表“groups”存储每个组的名称和组 ID。最后一个“contacts_groups”将每个联系人绑定到一个组，它只有两列，contact_id 和 group_id。

问题是如何在单个语句中编写一个 MySQL 查询，该查询将选择未分配给组的所有联系人。换句话说，“contacts_groups”表中未列出 id 的联系人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:28:50.310

```
select * from contacts c
left outer join contacts_groups cg on c.id = cg.contact_id 
where cg.contact_id is null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:30:15.377

```
SELECT * FROM contacts c
WHERE NOT EXISTS (SELECT * FROM contacts_groups cg
                  WHERE cg.contact_id = c.contact_id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T23:38:30.620

为了完整起见，这是另一个解决方案：

```
SELECT * FROM contacts
WHERE contact_id NOT IN (SELECT contact_id FROM contacts_groups) 
```

但是，我认为 MySQL 倾向于更有效地执行左连接或关联子查询。

# c# - 属性已由“FrameworkElement”注册

> ID：13131116
> 
> 赞同：25
> 
> 时间：2012-10-29T23:24:50.097
> 
> 标签：c#, wpf, properties, frameworks, element

我正在编写两个依赖属性，并且在 VS11 的设计窗口中不断收到“[Property] 已由 'FrameworkElement' 注册”错误。这是我的代码片段

```
 public static readonly DependencyProperty IsEditingNumberProperty =
        DependencyProperty.Register("IsEditingNumbers", typeof(bool), typeof(FrameworkElement),
        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender)); 
```

问题似乎是第三个参数（所有者参数类型（FrameworkElement））。如果我将第三个参数设置为包含两个依赖属性的类，错误就会消失，但我不能直接从 xaml 使用这些属性。在使用之前，我必须为每个依赖属性添加所有权。

实际上，它确实渲染正确，但只有在我第一次打开它时。在第一次渲染之后，它会给我一个例外。在运行时，它似乎工作得很好。

我做错了什么，有没有办法摆脱这个恼人的错误？

- - 编辑 - - -

这是我的自定义类（包括 2 个依赖属性）：

```
public partial class EditableTextBox : UserControl
{
    #region Dependency Properties
    public static readonly DependencyProperty IsEditingNumberProperty =
        DependencyProperty.Register("IsEditingNumber", typeof(bool), typeof(FrameworkElement),
        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender));

    public static readonly DependencyProperty TextProperty =
        DependencyProperty.Register("Text", typeof(string), typeof(FrameworkElement),
        new FrameworkPropertyMetadata("0", FrameworkPropertyMetadataOptions.AffectsRender) 
        { 
            CoerceValueCallback = new CoerceValueCallback((sender,value) =>
                {
                    return expressionRestaraint.Match((string)value).Value;
                })
        });
    #endregion

    public static Regex expressionRestaraint = new Regex("[-a-zA-z0-9+*.\\(\\)\\[\\]\\{\\}]*");

    public string Text
    {
        get { (string)GetValue(TextProperty); }
        set 
        { 
            SetValue(TextProperty, value);
            tbxValue.Text = (string)GetValue(TextProperty);
        }
    }

    public bool IsEditingNumber
    {
        get 
        { 
            return (bool)GetValue(IsEditingNumberProperty); 
        }
        set 
        {
            bool old = (bool)GetValue(IsEditingNumberProperty);
            if (old != value)
            {
                if (!value)
                    stopEditing();
                else
                    startEditing();

                SetValue(IsEditingNumberProperty, value);
            }
        }
    } . . . 
```

在主类中使用：

```
<Window x:Class="VisualMathExpression.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:edit="clr-namespace:VisualMathExpression.EditableTextBox"
    xmlns:all="clr-namespace:VisualMathExpression"
    Title="MainWindow" Height="350" Width="525">
<StackPanel>
    <edit:EditableTextBox HorizontalAlignment="Center" VerticalAlignment="Center"
                          Text="af" IsEditingNumber="True" /> . . . 
```

--- 编辑 --- 包装器已修复（当所有权属于声明的类时导致 xaml 属性不更改的问题）

```
 public partial class EditableTextBox : UserControl
{
    #region Dependency Properties
    public static readonly DependencyProperty IsEditingNumberProperty =
        DependencyProperty.Register("IsEditingNumber", typeof(bool), typeof(EditableTextBox),
        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender) 
        { 
            PropertyChangedCallback = new PropertyChangedCallback((sender, arg) =>
                {
                    EditableTextBox ed = sender as EditableTextBox;
                    if (!(bool)arg.NewValue)
                        ed.stopEditing();
                    else
                        ed.startEditing();
                }),
        });

    public static readonly DependencyProperty TextProperty =
        DependencyProperty.Register("Text", typeof(string), typeof(EditableTextBox),
        new FrameworkPropertyMetadata("0", FrameworkPropertyMetadataOptions.AffectsRender) 
        { 
            PropertyChangedCallback = new PropertyChangedCallback((sender,arg) =>
                {
                    EditableTextBox ed = sender as EditableTextBox;
                    ed.tbxValue.Text = arg.NewValue as string;
                }),
            CoerceValueCallback = new CoerceValueCallback((sender,value) =>
                {
                    return expressionRestaraint.Match((string)value).Value;
                })
        });
    #endregion

    public static Regex expressionRestaraint = new Regex("[-a-zA-z0-9+*.\\(\\)\\[\\]\\{\\}]*");

    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    public bool IsEditingNumber
    {
        get { return (bool)GetValue(IsEditingNumberProperty); }
        set { SetValue(IsEditingNumberProperty, value); }
    } 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-30T08:25:35.057

[DependencyProperty.Register](http://msdn.microsoft.com/en-us/library/ms597502.aspx)`ownerType`方法的第三个参数必须是声明属性的类。

如果您的类是`MyClass`声明，则必须如下所示：

```
public class MyClass : DependencyObject
{
    public static readonly DependencyProperty IsEditingNumberProperty =
        DependencyProperty.Register(
            "IsEditingNumber", typeof(bool), typeof(MyClass), ...);

    // CLR wrapper
    public bool IsEditingNumber
    {
        get { return (bool)GetValue(IsEditingNumberProperty); }
        set { SetValue(IsEditingNumberProperty, value); }
    }
} 
```

# asp.net-mvc - 将 xUnit 测试项目添加到现有的 Visual Web Developer 2010 express MVC 应用程序

> ID：13131117
> 
> 赞同：1
> 
> 时间：2012-10-29T23:24:55.903
> 
> 标签：asp.net-mvc, xunit.net, visual-web-developer-2010

也许这很容易，但我正在尝试在 Visual Web Developer 2010 Express 中添加对 xUnit 的支持。我按照本[教程](http://jayhollingum.blogspot.ca/2011/05/vwd-express-2010-unit-tests-with-xunit.html)介绍了如何安装所有内容，但主要问题是本教程仅展示了如何将测试项目添加到**新项目**而不是现有项目。当我执行“添加新项目”时，任何地方都没有“xunit”或“测试项目”......

有人知道如何或可以指出我的好教程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T08:50:31.187

一个标准的 Windows 库 (.DLL) 项目可以正常工作，并且是用于 xUnit.net 测试的正常项目类型 - 真正添加的所有现有机制是包含一些示例测试以帮助您开始。

这（没有模板）是未来 xUnit 版本所采用的方法。您可以在[http://xunit.codeplex.com/discussions上找到](http://xunit.codeplex.com/discussions)[有关其背后原因的一些讨论](http://xunit.codeplex.com/discussions/272171)

# php - 带有变量的php表单操作路径

> ID：13131121
> 
> 赞同：0
> 
> 时间：2012-10-29T23:25:27.327
> 
> 标签：php, wordpress

我真的在想我必须在开头有一个格式错误的 php echo 语句，但 Dreamweaver 告诉我我没有语法错误。我的 process.php 永远不会被调用。

```
 $file = dirname(__FILE__) . '/customBook-index.php';
 $plugin_path = plugin_dir_path($file);
 $plugin_url = plugin_dir_url($file);

 <?php

     echo '<form method="post" action="'.$plugin_url.'process.php" />';

         echo'<select name="clients">';
        foreach($clientsArray as $client){
             echo'<option value="'.$client.'">'.$client.'</option>';
         }
     echo'</select>';
     echo '</form>';
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:35:03.817

您不必使用`echo`所有的 HTML。你也可以写：

```
<?php
    $file = dirname(__FILE__) . '/customBook-index.php';
    $plugin_path = plugin_dir_path($file);
    $plugin_url = plugin_dir_url($file);
?>
<form method="post" action="<?=$plugin_url?>process.php" />
    <select name="clients">
        <?php
            foreach($clientsArray as $client){
                ?>
                <option value="<?=$client?>"><?=$client?></option>
                <?php
            }
        ?>
    </select>
</form> 
```

也许这对您来说更容易阅读和理解！？`$plugin_url.'process.php`您的 HTML中的输出是什么？我认为要么路径不匹配，要么您没有正确提交表单。

# spring - Spring Security - 如果已经登录则重定向

> ID：13131122
> 
> 赞同：30
> 
> 时间：2012-10-29T23:25:35.527
> 
> 标签：spring, spring-security

我是春天的新手：

我不希望经过身份验证的用户访问登录页面。如果用户已经通过身份验证，处理“/登录”重定向的正确方法是什么？比如说，如果已经登录，我想重定向到“/index”。

我在登录时尝试过“isAnonomous()”，但它重定向到访问被拒绝的页面。

```
<security:http auto-config="true" use-expressions="true" ...>
    <form-login login-processing-url="/resources/j_spring_security_check"
                 default-target-url="/index"
                login-page="/login" authentication-failure-url="/login?login_error=t" />
    <logout logout-url="/resources/j_spring_security_logout"  />
   ...
  <security:intercept-url pattern="/login" access="permitAll" />
  <security:intercept-url pattern="/**" access="isAuthenticated()" />
</security:http> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-30T04:29:42.040

在登录页面的控制器功能中：

1.  检查用户是否登录。

2.  然后在这种情况下将他转发/重定向到索引页面。

相关代码：

```
Authentication auth = SecurityContextHolder.getContext().getAuthentication();

if (!(auth instanceof AnonymousAuthenticationToken)) {

    /* The user is logged in :) */
    return new ModelAndView("forward:/index");
} 
```

### 更新

或者在映射可能包含的另一种情况`path variable`下，`@GetMapping(path = "/user/{id}")`您也可以实现此逻辑：

```
@GetMapping(value = "/login")
public String getLogin() throws Exception {
    Authentication auth = SecurityContextHolder.getContext().getAuthentication();

    if (!(auth instanceof AnonymousAuthenticationToken)) {
        User loggedInUser = userService.findByEmail(auth.getName())
                    .orElseThrow(Exception::new);
        /* The user is logged in :) */
        return "redirect:/user/" + loggedInUser.getUserId();
    }
    return "login";
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-01T10:54:12.620

要从登录页面成功重定向，如果用户已经登录，请将以下内容添加到您的 login.jsp：

在您的 jsp 顶部添加一个安全 taglib 标头：

```
<%@taglib uri="http://www.springframework.org/security/tags" prefix="sec"%> 
```

然后在“head”标签内添加以下标签（最好靠近顶部）：

```
<sec:authorize access="isAuthenticated()">
    <% response.sendRedirect("main"); %>
</sec:authorize> 
```

如果访问登录页面的用户已经登录，这将重定向到 main.html（或您的主 .jsp 映射到的任何内容）。

通过控制器执行此操作对我不起作用，因为有效的登录页面做法是让 spring security 的“form-login”bean 完成所有重定向工作，所以没有登录控制器可供我修改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-01T22:49:47.810

登录.xhtml

```
<h:head >
    <f:metadata>
      <f:event type="preRenderView" listener="#{loginBean.onPageLoad}"/>
  </f:metadata>
</h:head> 
```

登录豆

```
public void onPageLoad(){
    Authentication auth = SecurityContextHolder.getContext().getAuthentication();
    if (!(auth instanceof AnonymousAuthenticationToken)) {
        try {
            FacesContext.getCurrentInstance().getExternalContext().redirect(url);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-31T22:02:18.093

嘿，你可以这样做。

```
<h:head>
<sec:authorize access="isAuthenticated()">
    <meta http-equiv="refresh" content="0;url=http://your index.xhtml url (full url)" /> 
</sec:authorize>
</h:head> 
```

这种方法非常简单方便，不是吗？

# javascript - 如何显示距离矩阵的值？

> ID：13131126
> 
> 赞同：0
> 
> 时间：2012-10-29T23:25:55.713
> 
> 标签：javascript, google-maps

我有这样的事情：

[http://maps.googleapis.com/maps/api/distancematrix/json?origins=Berlin&destinations=Frankfurt&mode=driving&language=de-DE&sensor=false](http://maps.googleapis.com/maps/api/distancematrix/json?origins=Berlin&destinations=Frankfurt&mode=driving&language=de-DE&sensor=false)

如何在我的网站上从此 json 输出中显示“549 km and 5 Stunden, 21 Minuten”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:42:12.670

像这样的东西：

```
var service = new google.maps.DistanceMatrixService();
service.getDistanceMatrix(
  {
    origins: ["Berlin"],
    destinations: ["Frankfurt"],
    travelMode: google.maps.TravelMode.DRIVING,
  }, callback);

function callback(response, status) {
  $("#result").text(response.rows[0].elements.distance.text + " and " + response.rows[0].elements.duration.text);
} 
```

对我来说它看起来不错，但我还没有测试过，所以我可能没有得到所有的细节。我不知道如何以德语获得结果，但[此文档](https://developers.google.com/maps/documentation/javascript/distancematrix)可能会有所帮助。

代替`$("#result")`，您需要为要显示结果的元素提供选择器或集合。

# php - 如何在 php 中更改联系表单手动发送的电子邮件

> ID：13131128
> 
> 赞同：-3
> 
> 时间：2012-10-29T23:26:09.547
> 
> 标签：php, wordpress, email, wordpress-theming

我正在使用 Wordpress 主题，并且更改电子邮件设置表单的选项不起作用。因此，默认情况下，联系表单中的电子邮件会发送到管理员电子邮件。

我想更改联系表的去向（即：联系表的负责人）。因此，而不是试图解决主题问题。我宁愿手动输入电子邮件EXAMPLE@MAIL.COM 以便它工作。

这是联系人模板的代码

```
 <?php
/*
Template Name: Contact
*/
?>

<?php
if(isset($_POST['submitted'])) {
          if(trim($_POST['contactName']) === '') {
               $nameError = 'Please enter your name.';
               $hasError = true;
          } else {
               $name = trim($_POST['contactName']);
          }

          if(trim($_POST['email']) === '')  {
               $emailError = 'Please enter your email address.';
               $hasError = true;
          } else if (!eregi("^[A-Z0-9._%-]+@[A-Z0-9._%-]+\.[A-Z]{2,4}$", trim($_POST['email']))) {
               $emailError = 'You entered an invalid email address.';
               $hasError = true;
          } else {
               $email = trim($_POST['email']);
          }

          if(trim($_POST['comments']) === '') {
               $commentError = 'Please enter a message.';
               $hasError = true;
          } else {
               if(function_exists('stripslashes')) {
                    $comments = stripslashes(trim($_POST['comments']));
               } else {
                    $comments = trim($_POST['comments']);
               }
          }

          if(!isset($hasError)) {
               $emailTo = get_option('workspace_email');
               if (!isset($emailTo) || ($emailTo == '') ){
               $emailTo = get_option('admin_email');
               }
               $subject = '[Contact Form] From '.$name;
               $body = "Name: $name \n\nEmail: $email \n\nComments: $comments";
               $headers = 'From: '.$name.' <'.$emailTo.'>' . "\r\n" . 'Reply-To: ' . $email;

               mail($emailTo, $subject, $body, $headers);
               $emailSent = true;
          }

} ?>

<?php get_header(); ?>

        <div id="content">
               <h1 class="page-title"><?php the_title(); ?></h1>       
              <?php if (have_posts()) : while (have_posts()) : the_post(); ?>
                   <div <?php post_class() ?> id="post-<?php the_ID(); ?>">
                    <div class="entry-content">
                         <?php the_content(); ?>
                         <?php if(isset($emailSent) && $emailSent == true) { ?>

                          <div class="thanks">
                              <p><?php _e('Thanks, your email was sent successfully. ', 'themejunkie') ?></p>
                          </div><!-- .thanks -->

                      <?php } else { ?>

                          <?php if(isset($hasError) || isset($captchaError)) { ?>
                              <p class="error"><?php _e('Sorry, an error occurred.', 'themejunkie') ?><p>
                          <?php } ?>

                          <form action="<?php the_permalink(); ?>" id="contact-form" method="post" class="clear">
                              <ul class="contact-form">
                                  <li><label for="contactName"><?php _e('Name:', 'themejunkie') ?></label>
                                      <input class="txt" type="text" name="contactName" id="contactName" value="<?php if(isset($_POST['contactName'])) echo $_POST['contactName'];?>" class="required requiredField" />
                                      <?php if($nameError != '') { ?>
                                          <span class="error"><?php echo $nameError; ?></span>
                                      <?php } ?>
                                  </li>

                                  <li><label for="email"><?php _e('Email:', 'themejunkie') ?></label>
                                      <input class="txt" type="text" name="email" id="email" value="<?php if(isset($_POST['email']))  echo $_POST['email'];?>" class="required requiredField email" />
                                      <?php if($emailError != '') { ?>
                                          <span class="error"><?php echo $emailError; ?></span>
                                      <?php } ?>
                                  </li>

                                  <li class="textarea"><label for="commentsText"><?php _e('Message:', 'themejunkie') ?></label>
                                      <textarea name="comments" id="commentsText" rows="20" cols="30" class="required requiredField"><?php if(isset($_POST['comments'])) { if(function_exists('stripslashes')) { echo stripslashes($_POST['comments']); } else { echo $_POST['comments']; } } ?></textarea>
                                      <?php if($commentError != '') { ?>
                                          <p><span class="error"><?php echo $commentError; ?></span></p>
                                      <?php } ?>
                                  </li>

                                  <li>
                                      <input type="hidden" name="submitted" id="submitted" value="true" />
                                      <input name="submit" type="submit" id="submit" class="submit-button" value="<?php _e('Send Email', 'themejunkie') ?>" />
                                  </li>
                              </ul>
                          </form>
                      <?php } ?>
                    </div><!-- .entry-content -->
               </div><!-- #post-<?php the_ID(); ?> -->
               <?php endwhile; endif; ?>
          </div><!-- #content -->

<?php get_sidebar(); ?>            
<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:29:44.850

您发送到的电子邮件地址是该[`mail()`](http://php.net/manual/en/function.mail.php)函数的第一个参数：

```
mail('EXAMPLE@MAIL.COM', $subject, $body, $headers); 
```

这不是好方法，而是快速修复。确保不要更改或删除原始行，而仅将其注释掉并留下有用的评论来说明您所做的事情以及原因：

```
//mail($emailTo, $subject, $body, $headers);
//Novice change: manually entered an email address, not knowing the correct way.
mail('EXAMPLE@MAIL.COM', $subject, $body, $headers); 
```

不要个人认为，但也许你应该问/雇一个真正了解 Wordpress 和 PHP 的人来做这件事。

# nginx - 使用 100% cpu 的 php-fpm 和 fwrite 问题

> ID：13131129
> 
> 赞同：1
> 
> 时间：2012-10-29T23:26:22.130
> 
> 标签：nginx, php

我有一个不寻常的问题，我设法找到了根源。我目前设置在 CentOS Linux 6.3 nginx/1.0.15 PHP 版本 5.3.18 PHP-FPM 5.3.18-1

我有一个 refresh.txt 文件，每次有人发布更新新时间戳时都会写入该文件。我们还让 JS 每 1 秒检查一次时间戳的值。现在的问题是.. 假设 5 个人或更多人同时大喊写入 refresh.txt 文件，它将使用 100% cpu。只是为了写一个时间戳！！

我不知道它为什么这样做..

这是我的php代码。

```
if(!empty($rf_clear))
    $tb_send = "clear";
else
    $tb_send = time();

// Add flatfile check
$tbcheck = "refresh.txt";
    $tbsend = fopen($tbcheck, 'w');
    $tbtime = $tb_send;
fwrite($tbsend, $tbtime);
fclose($tbsend); 
```

JS

```
talk_jax.open("GET", boardurl+"/talkbox/refresh.txt?nocache="+nocache); 
```

我该如何解决这个问题或者解决这个问题？任何帮助我都会非常感激。

谢谢。

编辑：仍然没有解决这个问题。有没有办法限制请求？或者有没有更好的方法一起完成这一切。

我已经尝试过 APC 缓存，问题在于它没有足够快地提供 php 文件，所以喊声真的很慢，除非我做错了什么？

```
apc_store("refresh", time()); 
```

JS

```
talk_jax.open("GET", boardurl+"/talkbox/refresh.php?nocache="+nocache); 
```

我也尝试过使用数据库。提供 php 文件同样太慢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:43:57.530

最好的选择是使用`flock()`锁定您的文件进行写入 - [http://ar2.php.net/flock](http://ar2.php.net/flock) - 使用循环以实现 Windows 兼容性，因为`flock`没有阻止选项（在 CentOS 的情况下无效，但无害） .

```
$max_tries = 5; // don't loop forever
$tbcheck = "refresh.txt";
$tbsend = fopen($tbcheck, 'w');
for ($try=0; $try<$max_tries, $try++){
    if (flock($tbsend, LOCK_EX, true)) {  // acquire an exclusive blocking lock
        fwrite($tbsend, $tb_send);  // write to file
        fflush($tbsend);            // flush output before releasing the lock
        flock($tbsend, LOCK_UN);    // release the lock
        break;                      // exit the loop
    }
    usleep(100);                    // sleep for 100ms if we couldn't get a lock
}
fclose($tbsend); 
```

另一种选择是使用`APC`或`memcached`存储一个锁，然后可以从其他 PHP 进程中检查它。假设您`memcached`的代码如下所示：

```
$timeout = 5; // set a cache expiration so a broken process doesn't lock forever
$key = "file_locked";
$max_tries = 5; // don't loop forever
for ($try=0; $try<$max_tries, $try++){
    // check to see if there is a lock
    if (!Memcached::get($key)){
        // not locked, so set a lock before processing
        Memcached::set($key, true, $timeout);

        // write to the file
        $tbcheck = "refresh.txt";
        $tbsend = fopen($tbcheck, 'w');
        $tbtime = $tb_send;
        fwrite($tbsend, $tbtime);
        fclose($tbsend);

        // delete the lock
        Memcached::delete($key);

        // exit the loop
        break;
    }
    // locked, pause for 100ms
    usleep(100);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T14:10:45.527

考虑改用 Apc。
`apc_store('refresh', time());`存储
`apc_get('refresh');`检索

`yum install php-apc`

此外，您甚至不必将时间存储在其中。
你可以只存储一个计数器 `apc_inc('refresher');`来存储
，每次发生变化时都会增加，如果新值高于你以前的值，则检查 js。

# web2py - 在 web2py 中对列使用 filter_out 后无法获得原始值

> ID：13131136
> 
> 赞同：0
> 
> 时间：2012-10-29T23:27:07.787
> 
> 标签：web2py

在使用 DAL 将 filter_out 应用于 db 列后，我从 mysql 数据库中获取原始值时遇到问题。

例如，我有一个带有整数列的表。然后我像这样过滤掉它：

```
db.mytable.mycolumn.filter_out = lambda mycolumn: "some complex stuff"
                                 if mycolumn is None else "another complex stuff" 
```

但是我怎样才能检索到原始值呢？

```
rows = db().select(db.mytable.mycolumn)  // get filtered data, not the original 
```

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:38:06.547

想到两件事：

1.  由于过滤数据和未过滤数据之间的唯一区别是未过滤数据没有任何数据，所以您不能将“某些东西”识别为来自 None 吗？（如果“某些东西”不是一个明显的常数，或者至少可以识别为来自过滤器，我可以看到这是一个问题，但您没有详细说明“某些东西”是什么。）

2.  如果您不希望表格始终被过滤，则不应将过滤器保留在表格上。如果您更换过滤器（设置为 None 或标识 lambda），那应该消除过滤，但是对于之后的每个选择，直到您再次更改它。

# ios - customURL方案iOS打开app的秘密部分

> ID：13131137
> 
> 赞同：0
> 
> 时间：2012-10-29T23:27:37.207
> 
> 标签：ios, url-scheme, custom-url

我已经创建了我的 customURL 方案让我们称之为 myapp://

我想给我们一个 qr 代码，以使用 customURL myapp://secret 访问我的应用程序中原本隐藏的屏幕

我探索了各种教程，但无法让它们发挥作用。

我正在寻找可以在 didFinishLoadingWithOptions 下插入的代码

说 customURL 是 myapp://secret 现在执行此方法的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:48:22.750

> 我正在寻找可以在 didFinishLoadingWithOptions 下插入的代码
> 
> 说 customURL 是 myapp://secret 现在执行此方法的任何帮助将不胜感激。

这不是它的工作原理。如果您的应用程序可以打开 URL，您应该编写`-application:didFinishLaunchingWithOptions:`它返回 YES，然后实现`-application:openURL:sourceApplication:annotation:`实际打开 URL。

# python - Lemmatize 法语文本

> ID：13131139
> 
> 赞同：28
> 
> 时间：2012-10-29T23:27:57.623
> 
> 标签：python, nltk, lemmatization

我有一些法语文本，需要以某种方式处理。为此，我需要：

*   首先，将文本标记为单词
*   然后对这些词进行词形还原以避免多次处理同一个词根

据我所知，NLTK 中的 wordnet lemmatizer 仅适用于英语。当我给它“voudrais”等时，我想要一些可以返回“vouloir”的东西。由于撇号，我也无法正确标记。任何指针将不胜感激。:)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2019-04-16T08:52:17.253

我找到的最好的解决方案是 spacy，它似乎可以完成这项工作

安装：

```
pip3 install spacy
python3 -m spacy download fr_core_news_md 
```

要使用：

```
import spacy
nlp = spacy.load('fr_core_news_md')

doc = nlp(u"voudrais non animaux yeux dors couvre.")
for token in doc:
    print(token, token.lemma_) 
```

结果：

```
voudrais vouloir
non non
animaux animal
yeux oeil
dors dor
couvre couvrir 
```

查看文档以获取更多详细信息：[https](https://spacy.io/models/fr) : //spacy.io/models/fr && [https://spacy.io/usage](https://spacy.io/usage)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-10-30T00:07:39.947

[**这**](http://osdir.com/ml/python.nltk.devel/2007-06/msg00018.html)是 nltk 开发人员的旧但相关的评论。看起来 nltk 中最先进的词干分析器都是英语特定的：

> nltk.stem 模块目前包含 3 个词干分析器：Porter 词干分析器、Lancaster 词干分析器和基于正则表达式的词干分析器。Porter 词干分析器和 Lancaster 词干分析器都是英语特定的。可以自定义基于正则表达式的词干分析器以使用您希望的任何正则表达式。因此，您应该能够使用 regexp 词干分析器为非英语语言编写一个简单的词干分析器。例如，对于法语：
> 
> ```
> from nltk import stem
> stemmer = stem.Regexp('s$|es$|era$|erez$|ions$| <etc> ') 
> ```
> 
> 但是您需要自己提出特定于语言的正则表达式。对于更高级的词干分析器，可能需要添加一个新模块。（这可能是一个很好的学生项目。）
> 
> 有关正则表达式词干分析器的更多信息：
> 
> [http://nltk.org/doc/api/nltk.stem.regexp.Regexp-class.html](http://nltk.org/doc/api/nltk.stem.regexp.Regexp-class.html)
> 
> -爱德华

注意：他提供的链接已失效，请参阅[**此处**](http://www.nltk.org/api/nltk.stem.html#module-nltk.stem.regexp)以获取当前的 regexstemmer 文档。

不过，最近添加的[**雪球词干分析器**](http://www.nltk.org/api/nltk.stem.html#module-nltk.stem.snowball)似乎能够阻止法语。让我们来测试一下：

```
>>> from nltk.stem.snowball import FrenchStemmer
>>> stemmer = FrenchStemmer()
>>> stemmer.stem('voudrais')
u'voudr'
>>> stemmer.stem('animaux')
u'animal'
>>> stemmer.stem('yeux')
u'yeux'
>>> stemmer.stem('dors')
u'dor'
>>> stemmer.stem('couvre')
u'couvr' 
```

如您所见，有些结果有点可疑。

不是你所希望的，但我想这是一个开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-25T16:25:27.890

也许与 TreeTagger ？我没试过，但这个应用程序可以在法语中运行

[http://www.cis.uni-muenchen.de/~schmid/tools/TreeTagger/](http://www.cis.uni-muenchen.de/~schmid/tools/TreeTagger/)
[http://txm.sourceforge.net/installtreetagger_fr.html](http://txm.sourceforge.net/installtreetagger_fr.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-31T15:45:03.483

如果您在文本上执行机器学习算法，您可以使用 n-gram 代替单词标记。它不是严格的词形还原，但它可以检测到一系列 n 个相似的字母，并且收集具有相同含义的单词非常强大。

我使用 sklearn 的功能`CountVectorizer(analyzer='char_wb')`，对于某些特定的文本，它比词袋更有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-24T13:16:15.490

如果你在一家法国银行做文本挖掘项目，我推荐使用**cltk**包。

`install cltk` `from cltk.lemmatize.french.lemma import LemmaReplacer`

更多细节在[cltk](http://docs.cltk.org/en/latest/french.html)

# java - Java hibernate 加入继承（未找到 id）

> ID：13131143
> 
> 赞同：4
> 
> 时间：2012-10-29T23:28:17.770
> 
> 标签：java, hibernate, inheritance, postgresql-9.1, hibernate-annotations

对不起我的英语，这不是我的母语而且已经 2 点了，所以现在不能思考。现在我在使用 Java 和 PostgreSQL 的休眠时遇到了下一个问题：我有实体 Human 和 User 如下（带有注释映射）：

```
 @Inheritance(strategy = InheritanceType.JOINED)
    public class Human implements Serializable{
        private static final long serialVersionUID = 1L;
        public static enum Gender{
            Male,
            Female}
        @Id
        @GeneratedValue
        private Integer id;
        @Enumerated(EnumType.STRING)
        private Gender gender;
        @Column
        @Temporal(TemporalType.DATE)
        private Date dateOfBirth;
        private String firstName;
        private String middleName;
        private String lastName;
        // getters,setters
    }

    @Entity
    @PrimaryKeyJoinColumn
    public class User extends Human{
        private static final long serialVersionUID= 1L;
        @Column
        @Temporal(TemporalType.DATE)
        private Date registrationDate;
        private Boolean activationStatus;
        private String activationCode;
        private String login;
        private String password;
        private String sessionCode;
        private String email;
        private String country;
        private String city;
        private String avatarURL;
        private String description;
        // getters,setters
    } 
```

和数据库结构如下：

```
human
(
  dateofbirth date NOT NULL,
  firstname text NOT NULL,
  middlename text NOT NULL,
  lastname text NOT NULL,
  id serial NOT NULL,
  gender text,
  CONSTRAINT "Human_id" PRIMARY KEY (id )
)
"user"
(
  login text NOT NULL,
  password text NOT NULL,
  activationcode text NOT NULL,
  activationstatus status NOT NULL,
  avatarurl text NOT NULL,
  city text NOT NULL,
  country text NOT NULL,
  description text NOT NULL,
  registrationdate date NOT NULL,
  email text NOT NULL,
  id integer,
  CONSTRAINT uid PRIMARY KEY (id )
) 
```

当我尝试运行我的项目（简单单元测试）时，我得到下一个错误：

```
 org.postgresql.util.PSQLException: ERROR: column human0_1_.id does not exist
      Позиция: 778
        at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2103)
        at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1836)
        at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:512)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
        at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)
        at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)
        at org.hibernate.loader.Loader.doQuery(Loader.java:674)
        at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)
        at org.hibernate.loader.Loader.loadEntity(Loader.java:1860)
        at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:48)
        at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:42)
        at org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3044)
        at org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:395)
        at org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:375)
        at org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:139)
        at org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:195)
        at org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:103)
        at org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:878)
        at org.hibernate.impl.SessionImpl.get(SessionImpl.java:815)
        at org.hibernate.impl.SessionImpl.get(SessionImpl.java:808)
        at org.tempos.server.modules.users.HumanTest.testGetId(HumanTest.java:31)
... 
```

（我剪掉了日志的尾部，而它响应调用 JUnit 方法）。

生成的查询（失败）：

```
select human0_.id as id3_0_, human0_.dateOfBirth as dateOfBi2_3_0_, human0_.firstName as firstName3_0_, human0_.gender as gender3_0_, human0_.lastName as lastName3_0_, human0_.middleName as middleName3_0_, human0_1_.activationCode as activati1_4_0_, human0_1_.activationStatus as activati2_4_0_, human0_1_.avatarURL as avatarURL4_0_, human0_1_.city as city4_0_, human0_1_.country as country4_0_, human0_1_.description as descript6_4_0_, human0_1_.email as email4_0_, human0_1_.login as login4_0_, human0_1_.password as password4_0_, human0_1_.registrationDate as registr10_4_0_, human0_1_.sessionCode as session11_4_0_, case when human0_1_.id is not null then 1 when human0_.id is not null then 0 end as clazz_0_ from Human human0_ left outer join User human0_1_ on human0_.id=human0_1_.id where human0_.id=? 
```

如您所见，它尝试在human1_1_.id（最初是User.id）上加入列，但它没有在查询的SELECT部分​​中指定和获取。

我尝试了什么：

1.  在 User 类中创建 @Column 私有整数 id（获得注释解析器异常以覆盖类的主列）；
2.  创建 @Column private Integer 隐藏在类 User 中并将其设置为 PrimaryKeyJoinColumn （但我得到（应该用 insert="false" update="false" 映射）即使我将它映射为 @JoinColumn(insertable=false,updatable=false ,referencedColumnName="id"));
3.  创建列“隐藏”并将其指向列本身的注释中的 PrimaryKeyJoinColumn，而不是整个类（得到与原始列相同的错误，未找到列“human0_1_.id”）；

任何人，请给我一些想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T10:56:54.160

问题得到了解决，这主要归功于 myhaylo。
这个问题的原始原因一直被 SQE PMD 插件标记——“用户”是 SQL-99 语法中的关键字。因此（看起来），需要引用表名。它在 PgAdmin 查询浏览器中被引用，但不在 Hibernate 生成的查询中，实际上，在这种情况下，必须指向 user.id 的 human0_1_.id 没有指向任何地方。
将类和表名更改为其他名称（如 AndhorUser）后，原始数据库结构现在发布有问题，并且类定义运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T00:15:29.370

您的课程应如下所示：
Human

```
import java.io.Serializable;

import javax.persistence.Entity;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;

@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Human implements Serializable {

    private static final long serialVersionUID = 1L;

    public static enum Gender {
        Male, Female
    }

    @Id
    @GeneratedValue
    private Long id;

    @Enumerated(EnumType.STRING)
    private Gender gender;
    private String firstName;
    private String lastName;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Gender getGender() {
        return gender;
    }

    public void setGender(Gender gender) {
        this.gender = gender;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }
   .....
} 
```

用户

```
import java.util.Date;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.PrimaryKeyJoinColumn;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

@Entity
@PrimaryKeyJoinColumn
public class User extends Human {

    private static final long serialVersionUID = 1L;

    @Column
    @Temporal(TemporalType.DATE)
    private Date registrationDate;

    public Date getRegistrationDate() {
        return registrationDate;
    }

    public void setRegistrationDate(Date registrationDate) {
        this.registrationDate = registrationDate;
    }
    ....
} 
```

*   人类类应该用@Entity注解来注解
*   模型实体类应该实现 Serializable 接口

看

1.  [继承类型（使用休眠）](http://blog.v-s-f.co.uk/2010/12/inheritance-type-with-hibernate/)。
2.  [继承类型已加入](http://www.java2s.com/Tutorial/Java/0355__JPA/InheritanceTypeJOINED.htm)

# c# - 价值提供者的惰性评估依赖注入（Unity、Structure Map、Ninject...）

> ID：13131144
> 
> 赞同：4
> 
> 时间：2012-10-29T23:28:18.267
> 
> 标签：c#, dependency-injection, inversion-of-control, lazy-loading, ioc-container

我不想注入行为依赖，而是注入数据依赖——数据来自数据库或其他服务调用。为了实现这一点，我的第一步是进行类型到委托的绑定，而不是类型到类型的绑定。到目前为止一切顺利，我认为大多数 .net IOC 容器都可以做到这一点。

但我预计许多数据注入会产生不必要的延迟，因为这意味着数据存储需要多次往返。我宁愿在一个请求中获取所有要注入的数据对象。

我想知道是否有用于此的框架或库，或示例代码。

我认为框架或库将通过改进我之前的提案来满足我的需求，以便委托绑定......

1.  每个都将数据请求放入线程本地存储队列。
2.  仅返回`Lazy< T >`.

在 IOC 容器完成注入所有`Lazy< T >`类型之后，程序执行总是会执行其中一个`Lazy< T >.Value`委托。发生这种情况时，整个数据请求队列会同时发送并同时填充到 TLS 内的哈希表或字典中。因此，第一次`Lazy< T >.Value`命中会很慢，但`Lazy< T >`作为 IOC 容器注入树一部分的所有其他项目将很快执行。

对这个提议的方法有什么想法？有没有图书馆做这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T09:25:26.110

在某些情况下，将数据直接注入需要它的消费者可能会起作用，但在大多数情况下，消费者通过查询这些数据（使用提供的参数请求数据）来确定他需要什么数据。

对于可以直接注入数据的少数情况（您可以将它们视为无参数查询），直接注入数据会使您的 DI 配置极其复杂。以一个依赖于系统当前时间的消费者为例。您可以将 a`DateTime`注入消费者（甚至是 a `Lazy<DateTime>`）。另一个消费者可能需要当前用户的出生日期，因此该消费者还依赖于`DateTime`. 但是现在你在系统中有歧义，因为`DateTime`依赖有两个含义。DI 容器在处理这个问题上很糟糕，为了解决这个问题，你必须明确地告诉容器`DateTime`对于每个需要它的消费者意味着什么。这导致难以控制的易碎配置。

对于后一种情况（无参数查询），解决方案是定义可以解析的明确接口。在上面的示例中，您可以定义一个`ITimeProvider`接口和一个`IUserContext`接口。每个消费者都可以依赖正确的接口。

对于前一种情况（参数化查询），您不需要为此提供框架；你需要适当的设计。

您正在谈论查询数据库和 Web 服务，并且需要一种方法来缓存返回的数据。因此，您需要一个用于定义查询的抽象，并以一种可以对它们应用缓存和其他[横切关注点](https://en.wikipedia.org/wiki/Cross-cutting_concern)的方式进行操作，以一种可插入的方式，让您不必对代码进行任何更改。

一种有效的方法是定义一个定义查询对象（查询的输入参数）+返回类型的接口，以及一个定义处理该查询的逻辑的接口：

```
public interface IQuery<TResult>
{
}

public interface IQueryHandler<TQuery, TResult> 
    where TQuery : IQuery<TResult>
{
    TResult Handle(TQuery query);
} 
```

使用这些抽象，您可以像这样定义查询对象：

```
public class FindUsersBySearchTextQuery : IQuery<User[]>
{
    public string SearchText { get; set; }
    public bool IncludeInactiveUsers { get; set; }
} 
```

该对象定义了一个通过搜索文本查找用户并允许包含或排除非活动用户的查询，查询结果是一个`User`对象数组。

执行这个查询的逻辑可以实现如下：

```
public class FindUsersBySearchTextQueryHandler
    : IQueryHandler<FindUsersBySearchTextQuery, User[]>
{
    private readonly NorthwindUnitOfWork db;

    public FindUsersBySearchTextQueryHandler(
        NorthwindUnitOfWork db)
    {
        this.db = db;
    }

    public User[] Handle(FindUsersBySearchTextQuery query)
    {
        return (
            from user in this.db.Users
            where user.Name.Contains(query.SearchText)
            where user.IsActive || query.IncludeInactiveUsers
            select user)
            .ToArray();
    }
} 
```

为什么这能解决您遇到的问题？这解决了您的问题，因为消费者可以依赖接口，而您可以使用[装饰器](https://en.wikipedia.org/wiki/Decorator_pattern)`IQueryHandler<FindUsersBySearchTextQuery, User[]>`包装`IQueryHandler<T>`实现，而无需任何人知道。编写一个将结果缓存在tread-local stogage中的装饰器是不费吹灰之力的：

```
public class TlsCachingQueryHandlerDecorator<TQuery, TResult>
    : IQueryHandler<TQuery, TResult>
    where TQuery : IQuery<TResult>
    where TResult : class
{
    [ThreadStatic]
    private static TResult cache;

    private readonly IQueryHandler<TQuery, TResult> decorated;

    public ValidationQueryHandlerDecorator(
        IQueryHandler<TQuery, TResult> decorated)
    {
        this.decorated = decorated;
    }

    public TResult Handle(TQuery query)
    {
        return cache ?? (cache = this.decorated.Handle(query));
    }
} 
```

任何实体 DI 容器都允许您注册这些装饰器并允许您有条件地注册装饰器（基于装饰类型的类型信息）。这允许您将此缓存装饰器仅放置在可以安全缓存的类型上（根据您的条件）。

您可以在本文中找到有关此模型的更多信息：[同时……在我的架构的查询端](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92)。

# java - 在 Java 应用程序中制作可扩展性地图

> ID：13131145
> 
> 赞同：1
> 
> 时间：2012-10-29T23:28:19.640
> 
> 标签：java, data-structures, hashmap

所以我正在开发这个应用程序并编写这个类来解析一个 xml。我创建了一个代表我的 xml 文件的类，我想为它映射一些东西，然后使用该映射来扩展我的解析器的能力。这是一个例子：

我知道每个文件中都有一个 DATE，在我正在解析的 XML 文件的当前版本中，`<date>dateValue</date>`我想将我的通用字符串“DATE”映射到“日期”，这样我就可以简单地引用一个数据结构（映射）并在键值（在本例中为“日期”）获取值（“日期”）。如果这就是我想做的所有事情，我只会使用哈希图。但是我添加了一些更复杂的东西，我有一个类来表示我从 xml 中提取的数据，比如：

```
public class myXML{
   String date;
   setDate(String input){
        this.date = input;
   }
} 
```

所以我还想找出一种方法，用值“DATE”、“date”和现在的 setDate(“value”) 附加其他东西。那么首先有没有一种将 2 个值链接到一个键的好方法？其次，有没有一种好方法可以映射到一个函数，然后再使用它？如

```
function = map.getFunctionValue("DATE");
myXML.function(someValue); 
```

所有这些都是示例代码，所以请不要评论缺少构造函数或语法错误:)

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:33:54.660

Apache Commons 有[一个 MultiMap](http://commons.apache.org/collections/api-3.1/org/apache/commons/collections/MultiMap.html)。不幸的是，我在标准库中没有看到。

根据[docs](http://docs.oracle.com/javase/tutorial/collections/interfaces/map.html)，他们似乎没有包含它，因为它并不经常需要。

> 多重映射类似于映射，但它可以将每个键映射到多个值。Java Collections Framework 不包含用于多图的接口，因为它们并不常用。将值为 List 实例的 Map 用作多图是一件相当简单的事情。

至于第二个问题，Java 遗憾地缺乏一流的函数，因此没有优雅的方法可以做到这一点。您可以采用的各种方法包括使用自定义接口、包装类、反射和字节码破解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T10:52:42.303

试着看看[Xstream](http://xstream.codehaus.org/tutorial.html)，从这个[相关的问题中得到它](https://stackoverflow.com/questions/1537207/how-to-convert-xml-to-java-util-map-and-vice-versa)

# mysql - 具有 mysql 数据源的 Grails 应用程序不存储复选框位值

> ID：13131148
> 
> 赞同：0
> 
> 时间：2012-10-29T23:28:50.003
> 
> 标签：mysql

在我的 Grails 应用程序中，我有两个域类...Person 和 Course。两者之间存在一对多的关系（一个课程可以有多个人注册）。结果，默认的脚手架将在 show.gsp 中显示所有在课程中注册的人员的列表。

我修改了 show.gsp 以添加“付费”和“参加”复选框：

```
<g:if test="${courseInstance?.persons}">
            <br />
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <g:sortableColumn property="person"
                            title="${message(code: 'person.lastName.label', default: 'Person')}" />
                        <g:sortableColumn property="paid"
                            title="${message(code: 'person.paid.label', default: 'Paid')}" />
                        <g:sortableColumn property="attended"
                            title="${message(code: 'person.paid.attended', default: 'Attended')}" />
                    </tr>
                </thead>
                <tbody>
                    <g:set var="counter" value="${1}" />
                    <g:each in="${courseInstance.persons}" status="i" var="p">
                        <tr class="${(i % 2) == 0 ? 'even' : 'odd'}">
                            <td>
                                ${counter}
                            </td>
                            <td class="property-value" aria-labelledby="persons-label"><g:link
                                    controller="person" action="show" id="${p.id}">
                                    ${p?.encodeAsHTML()}
                                </g:link></td>
                            <td><g:checkBox name="paid" value="${p.paid}"
                                    onclick="${remoteFunction(action:'togglePaid', id:p.id,
                                params:'\'completed=\' + this.checked')}" /></td>
                            <td><g:checkBox name="attended" value="${p.attended}"
                                    onclick="${remoteFunction(action:'toggleAttended', id:p.id,
                                params:'\'completed=\' + this.checked')}" /></td>
                        </tr>
                        <g:set var="counter" value="${counter + 1}" />
                    </g:each>
                </tbody>
            </table>
        </g:if> 
```

在我的班级控制器中，我添加了：

```
class CourseController {

static scaffold = true

def toggleAttended = {
    def person = Person.get(params.id)
    if (person){
        person.attended = params.completed == 'true'
        person.save()
    }
    render ''
}

def togglePaid = {
    def person = Person.get(params.id)
    if (person){
        person.paid = params.completed == 'true'
        person.save()
    }
    render ''
}

} 
```

当我选中/取消选中复选框时，会成功记住这些值。但是我注意到我的 MySQL 数据库没有为这三个复选框存储任何值，无论它们是选中还是未选中：

```
mysql> SELECT paid, attended, pfa FROM person;
+------+----------+-----+
| paid | attended | pfa |
+------+----------+-----+
|      |          |     |
+------+----------+-----+
1 row in set (0.00 sec) 
```

这些列的类型是“位”。我想知道如果数据库中没有存储任何内容，这些值是如何被记住的。另外，我是否需要在控制器中添加额外的代码来更新数据库中的值？或者这应该自动发生吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:24:47.837

将您的选择更改为 SELECTpaid+0, Attended+0, pfa+0 FROM person；看看你是否能看到这些值。mysql 客户端无法呈现位值。这是一个非常非常古老的错误。

在 grails 中你无能为力。这是 mysql 命令行客户端的限制。它与您的应用程序无关。唯一需要使用该语法的情况是使用 mysql 命令行客户端。

[bugs.mysql.com/bug.php?id=28422](http://bugs.mysql.com/bug.php?id=28422)

# php - xterm 中的换行问题

> ID：13131162
> 
> 赞同：3
> 
> 时间：2012-10-29T23:30:41.837
> 
> 标签：php, bash, ansi, xterm

我正在编写一个打印彩色线条的程序，我用它做的越多，我发现自己解决出现的换行问题就越多。

它是一种用 php 编写的终端，提示如下：

```
$return = readline("\033[44m\033[1;37m{$this->text}>>\033[0m "); 
```

滚动浏览历史，非印刷字符对一切造成严重破坏。

如果我尝试添加转义

```
$return = readline("\[\033[44m\033[1;37m\]{$this->text}>>\[\033[0m\] "); 
```

然后它会打印括号......即使我添加了双反斜杠。

```
\[\][timer]>>\[\] 
```

我对 echo -e 也有同样的看法，我真的不确定发生了什么。

最后，如果我修改 PS1 就可以了。

```
[mike@crest ~]$ export PS1="\[\033[44m\033[1;37m\][timer]>>\[\033[0m\] "
[timer]>> 
```

我在这里想念什么？

编辑：着色/显示不是问题。问题是，当不带转义符打印不可见字符时，bash 会出现换行问题......当我添加转义符时，它们在除 PS1 之外的所有情况下都以纯文本形式打印，我不确定有什么区别，如何让它在 PHP 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T10:54:54.767

php 1.php

[定时器]>>

```
<?php

$return = readline("\033[44m\033[1;37m[TIMER]>>\033[0m ");

?> 
```

这是添加的对话框示例

```
dialog --title "Welcome" --msgbox "\nMY TEST DIALOG \n\nPress <Enter> to continue or <Esc> to cancel." 10 50 
```

# ios - 从 UITableView 折叠行部分时出现 NSInternalInconsistencyException

> ID：13131163
> 
> 赞同：1
> 
> 时间：2012-10-29T23:30:51.370
> 
> 标签：ios, uitableview

当我尝试删除行以模拟折叠 UITableView 中的部分时，我收到以下错误消息：

```
 *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Invalid update: invalid number of rows in section 0\.  The number of rows contained in an existing section after the update (3) must be equal to the number of rows contained in that section before the update (3), plus or minus the number of rows inserted or deleted from that section (0 inserted, 3 deleted) and plus or minus the number of rows moved into or out of that section (0 moved in, 0 moved out).' 
```

我正在使用此方法删除行，其中调用者是该部分的标题视图，其标签是其部分：

```
- (IBAction)toggleExpand:(id)sender
{
int section = [sender tag];

if (expandedArray[section]) {
    expandedArray[section] = NO;
    NSMutableArray *rowsToDelete = [[NSMutableArray alloc] init];
    for (int i = 0; i < 3; i++) {
        [rowsToDelete addObject:[NSIndexPath indexPathForRow:i inSection:section]];
    }
    [mainTableView deleteRowsAtIndexPaths:[NSArray arrayWithArray:rowsToDelete] withRowAnimation:UITableViewRowAnimationAutomatic];

    }
} 
```

似乎问题是我在删除行后没有更新我的数据源，但我试图用我的方法 numberOfRowsInSection 来做到这一点：

```
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (expandedArray[section]) {
        return 3;
    }
    else {
        return 0;
    }

} 
```

expandArray 是一个 bool 数组，它们都被初始化为 YES，因为所有部分都是默认扩展的。

编辑：我添加了一些调试消息，并收到以下内容。

```
Asking number of rows....
Section 1 is expanded.
Asking number of rows....
Section 0 is expanded.
header section: 0
header section: 1
toggleExpand tag reads: 0
Asking number of rows....
Section 0 is expanded.
Asking number of rows....
Section 1 is not expanded. 
```

令我困扰的是，它认为第 1 节在应该是第 0 节时被折叠了。

# c# - 在一组文本块或内联下划线

> ID：13131164
> 
> 赞同：0
> 
> 时间：2012-10-29T23:31:32.540
> 
> 标签：c#, wpf

简短版本：我想在 DependencyObject 中添加下划线的任何内容，例如，在这种情况下，我可以设置字体大小和颜色，但不能将其设置为带下划线：

```
<StackPanel TextElement.FontWeight="Bold" TextElement.Foreground="Red" Inline.TextDecorations="Underline">
    <TextBlock Text="This ">
    </TextBlock>
    <TextBlock><Run Text="is "></Run><Run Text="a test"></Run></TextBlock>
</StackPanel> 
```

那么如何在一个位置指定我希望所有文本都加下划线呢？

长版：我正在创建一个像 ContentPresenter 一样工作的超链接控件。使用我的超链接控件的程序员可以将内容放入控件中并指定一个 DataTemplate 来呈现其内容。在 MouseOver 我想要一个触发器来将字体设置为红色并在文本下划线。我可以很容易地将颜色更改为红色，但下划线被证明是一个问题。

```
<Trigger Property="IsMouseOver" Value="True">
    <Setter Property="Inline.TextDecorations" Value="Underline"></Setter>
    <Setter Property="TextElement.Foreground" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:ContentHyperlink}}, Path=ActiveColor}"></Setter>
</Trigger> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:13:23.763

查看评论中发布的链接，看起来可能没有一个好的 xaml 方法来执行此操作。我目前正在使用 C# 代码，它运行良好。为了社区的利益，这是我的解决方案。欢迎就如何更好地做到这一点提出任何意见。我只是捕获 MouseLeave 和 MouseEnter 事件并在那里显示下划线。

```
 void Control_MouseLeave(object sender, System.Windows.Input.MouseEventArgs e)
    {
        WPFHelper.EnumerateChildren<TextBlock>(this, true).ForEach(c => c.TextDecorations = null);
    }

    void Control_MouseEnter(object sender, System.Windows.Input.MouseEventArgs e)
    {
        WPFHelper.EnumerateChildren<TextBlock>(this, true).ForEach(c => c.TextDecorations = TextDecorations.Underline);
    } 
```

WPFHelper 类简单地枚举 DependencyObject 的所有子项，而 ForEach 是一个扩展方法，它只为每个项目执行 lambda 表达式内的操作。

# c# - 有没有像ICollection这样的接口 ，但专为排序集合而设计？

> ID：13131167
> 
> 赞同：8
> 
> 时间：2012-10-29T23:31:43.020
> 
> 标签：c#, .net, interface

...或者我可以毫无问题地使用 ICollection 吗？

我的意思是，我不认为 ICollection 是为排序集合设计的，因为这可能会破坏为排序或未排序的 ICollection 对象设计的应用程序，但我不知道。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-29T23:41:13.563

我想说[ICollection<T> 接口](http://msdn.microsoft.com/en-us/library/92t2ye13.aspx)适合通过排序集合类型实现，因为可以枚举、添加、删除、清除和检查排序集合的内容。

作为一个反例，[IList<T> 接口](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx) 可能不合适，因为与 ICollection<T> 不同，它假定集合是一个列表，其中元素可以添加到特定位置，如果集合没有意义它本身决定了每个元素的位置。

.NET Framework 中的排序集合类型（[SortedList<TKey, TValue> Class](http://msdn.microsoft.com/en-us/library/ms132319.aspx) , [SortedDictionary<TKey, TValue> Class](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)和[SortedSet<T> Class](http://msdn.microsoft.com/en-us/library/dd412070.aspx)）都实现 ICollection<T> 但不实现 IList<T>。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-14T09:16:12.470

此接口可用于排序枚举：

`IOrderedEnumerable<TElement>`

[https://docs.microsoft.com/en-us/dotnet/api/system.linq.iorderedenumerable-1?view=netcore-3.1](https://docs.microsoft.com/en-us/dotnet/api/system.linq.iorderedenumerable-1?view=netcore-3.1)

# php - MySQL表值1小于表值2

> ID：13131172
> 
> 赞同：0
> 
> 时间：2012-10-29T23:32:38.720
> 
> 标签：php, mysql

我这里有个问题。这就是我所拥有的：`mysql_query("SELECT * FROM hosts WHERE location='$locid' AND currentservers < maxservers");`

所以，我想要做的是从一个表中选择位置等于值和 currentservers 小于 maxservers 的所有内容。我尚未对此进行测试，因为我正在制作的整个功能非常大。currentservers 和 maxservers 是表中的列。

这个查询会起作用吗？另外，我只想返回 1 行。我怎么做？

提前致谢。

最好的问候，汤姆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:36:41.930

如果你的两个字段都是数字的`currentservers`，`maxservers`你应该得到你想要在查询中附加“LIMIT 1”的内容：

```
"SELECT * FROM hosts WHERE location='$locid' AND currentservers < maxservers LIMIT 1" 
```

# jquery - 使菜单响应

> ID：13131174
> 
> 赞同：0
> 
> 时间：2012-10-29T23:32:51.710
> 
> 标签：jquery, html, css, responsive-design

我有一个[小提琴](http://jsfiddle.net/M3kWM/)，它显示了我构建的菜单。

这是一个垂直菜单。我遇到的问题是`<li>`我添加到菜单中的 s 越多，就越难适应屏幕。

例如：顶部菜单项 ( **A** ) 的大部分内容都超出了屏幕。想象一下，如果菜单有很多项（a、b、c、d ...z），则底部菜单项（**z**）会延伸到屏幕底部之外。

为了使我的问题更加复杂，想象一下菜单中间的一个菜单项有很多元素。这也将超出屏幕顶部。这不是我想要的。我实际上希望菜单弹出来响应它周围的窗口并适合自己。

我首先告诉每个小组在它显示出来之前把自己放在中心：

```
var groupList = $(e.target).find('.group-list');
groupList.css({
    'margin-top': (-groupList.height() / 2) + 'px'
});
groupList.show(); 
```

不幸的是，这还不够。但是，我不确定如何让每个人都知道它周围的窗口，并且响应足够快以适应窗口内。

**如何重写我的 groupList.css({}) 代码以使 group-list 类响应并适合窗口内？**

编辑：我很抱歉这么罗嗦。我想解释一下我遇到的设计问题，以便你们都能理解并希望为我指明正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:50:29.910

如果我正确理解您的需求，希望这将回答您的问题。我将获得围绕您的完整点亮项目/菜单的包装器的总高度。然后将其与以下类似的变量进行比较：

变量高度 = $(document).height(); // 获取文档高度 Var width = $(window).width();

//然后始终将其与您的列表高度进行比较。如果高度达到您想要的限制点，则创建一个新列并将您的列表附加到它。这样，它总是在调整大小并且永远不会挂在 Windows 视口之外。

然后，您将创建弹出列表项所在的第二个框。将其与文档高度进行比较，并将底部 css 设置为 0px。

如果这没有帮助，请随时通过 generic_brand@ymail.com 给我发送电子邮件，我将创建一个片段来向您展示我的解释示例。快乐的编码，祝你好运！

# core-data - 使用 RubyMotion 将大型数据集导入 CoreData

> ID：13131175
> 
> 赞同：1
> 
> 时间：2012-10-29T23:32:54.927
> 
> 标签：core-data, rubymotion

我想这基本上是[这个问题](https://stackoverflow.com/questions/2140798/importing-large-datasets-on-iphone-using-coredata)的 RubyMotion 类似物。

通过网络将大量数据导入核心数据有哪些策略和资源？有人在 RubyMotion 中做过这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T18:59:35.460

我正在经历同样的问题，但还没有找到令人满意的解决方案。到目前为止，我已经创建了一个异步调度队列，将文档目录中的导入文件分成块，然后将这些块提交到另一个队列。在确保 Core Data 喜欢我正在使用的上下文之后，该导入方法在后台运行得很好。问题是 RubyMotion/CoreData 系统中的某些东西正在使用内存并且即使每个队列的块完成时也没有放弃它。因此，当我处理了几分钟后，内存使用量激增，我开始收到内存警告。包装代码的所有迭代区域

```
autorelease_pool do
...
end 
```

有很大帮助，但还不够。并且那些 autorelease_pool 块可以嵌套。

# iphone - 使用 AVPlayer 流式传输 mp3 音频

> ID：13131177
> 
> 赞同：25
> 
> 时间：2012-10-29T23:33:03.167
> 
> 标签：iphone, objective-c, ios, audio-streaming

我听到一些关于此的相互矛盾的报告。我要做的是从 URL 流式传输 mp3 文件。我已经进行了数小时的研究，但我找不到任何关于如何做到这一点的好的指南，甚至找不到我应该使用哪种音频播放器。

有些朋友告诉我，AVPlayer 可以串流 mp3，但苹果文档说不能。我已经倾注了 Matt Gallagher 的音频流媒体 (http://www.cocoawithlove.com/2008/09/streaming-and-playing-live-mp3-stream.html)，但该代码是不久前制作的，并且我对此很陌生，很难通过自动发布和保留以及所有这些工作。

我尝试流式传输的音频是来自 libsyn 服务器的相当大的 mp3 文件，其 URL 格式为..

```
http://traffic.libsyn.com/podcastname/episode.mp3 
```

我需要做的就是抓住它并开始播放，并且能够暂停和擦洗。所以首先，可以 AVPlayer 流 mp3 吗？如果是这样，是否有人可以指出我的任何指南或代码？如果没有，是否有任何可以流式传输音频的音频播放器类？

我尝试创建一个 AVPlayerItem，使用 URL 进行初始化，然后将其添加到 AVPlayer，但我收到大量错误加载...和未找到符号...错误。我会很感激这方面的任何信息，谢谢！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-10-31T11:32:08.617

试试这个

```
 -(void)playselectedsong{

        AVPlayer *player = [[AVPlayer alloc]initWithURL:[NSURL URLWithString:urlString]];
        self.songPlayer = player;
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(playerItemDidReachEnd:)
                                                     name:AVPlayerItemDidPlayToEndTimeNotification
                                                   object:[songPlayer currentItem]];
        [self.songPlayer addObserver:self forKeyPath:@"status" options:0 context:nil];
        [NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(updateProgress:) userInfo:nil repeats:YES];

    }
    - (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {

        if (object == songPlayer && [keyPath isEqualToString:@"status"]) {
            if (songPlayer.status == AVPlayerStatusFailed) {
                NSLog(@"AVPlayer Failed");

            } else if (songPlayer.status == AVPlayerStatusReadyToPlay) {
                NSLog(@"AVPlayerStatusReadyToPlay");
                [self.songPlayer play];

            } else if (songPlayer.status == AVPlayerItemStatusUnknown) {
                NSLog(@"AVPlayer Unknown");

            }
        }
    }

    - (void)playerItemDidReachEnd:(NSNotification *)notification {

     //  code here to play next sound file

    } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-06-07T12:29:53.073

你也可以试试我的支持 HTTP 流的开源可调节库。它基于 Matt 的 AudioStreamer，但经过整理、优化和更新以支持多个数据源（非 HTTP）和无缝播放。

[https://github.com/tumtumtum/audjustable](https://github.com/tumtumtum/audjustable)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-05T14:29:58.100

除了对我有很大帮助的 Sumit Mundra 的回答之外，我发现这种技术实际上并没有从远程服务器*流式传输*MP3 文件。当我实现这个时，文件在播放之前同步下载，阻塞了我的 UI。正确流式传输我发现效果很好的 MP3 的方法是指向 M3U 文件。这只是一个带有 .m3u 扩展名的文本文件，其中包含指向原始 MP3 的链接。而是将 Sumit 的代码指向该文件，您就有了一个立即开始播放的流。

这是我找到该信息的地方：http: [//www.soundabout.net/streammp3.htm](http://www.soundabout.net/streammp3.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-01T21:55:46.870

Matt Gallagher 的 AudioStreamer 已于 2 个月前更新[https://github.com/mattgallagher/AudioStreamer/commits/master](https://github.com/mattgallagher/AudioStreamer/commits/master)

但是对于您要查找的内容，请查看示例代码 StichedStreamPlayer [http://developer.apple.com/library/ios/#samplecode/StitchedStreamPlayer/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010092](http://developer.apple.com/library/ios/#samplecode/StitchedStreamPlayer/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010092)

它使用 AVPlayer 对象，如果您查看方法 - (IBAction)loadMovieButtonPressed:(id)sender，您应该能够了解它是如何设置 AVPlayer 对象的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-15T21:55:40.583

Aaron 关于使用 m3u 文件而不是 mp3 的帖子对我有用。我还发现 AVPlayer 对 m3u 语法很挑剔。例如，当我尝试以下操作时，我无法获得有效的持续时间（它总是不确定的），并且相对路径不起作用：

```
#EXTM3U
#EXTINF:71
https://test-domain.com/90c9a240-51b3-11e9-bb69-c1300ce2348f.mp3 
```

但是，将 m3u 文件更新为以下内容后，这两个问题都得到了解决：

```
#EXTM3U
#EXT-X-VERSION:3
#EXT-X-TARGETDURATION:70
#EXT-X-MEDIA-SEQUENCE:1
#EXT-X-PLAYLIST-TYPE:VOD
#EXTINF:70.000,
8577d650-51b3-11e9-8e69-4f2b085e94aa.mp3
#EXT-X-ENDLIST 
```

# c++ - c++ 中一个快速、更小的 Q

> ID：13131178
> 
> 赞同：-3
> 
> 时间：2012-10-29T23:33:04.243
> 
> 标签：c++

首先，我只是一个初学者

```
int num;
cin>>num; 
```

如何检查数字是否为数字且仅为0

与常规 exp 有什么关系？有人可以教我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:34:45.000

仅当流包含可解析的字符序列时，提取才会成功。正确的用法是这样的：

```
int num;

if (std::cin >> num)
{
    // OK, use "num". E.g. "if (num == 0)", etc.
}
else
{
    // Error, no number could be extracted
} 
```

如果提取失败，则流保持*失败*状态，需要重置（使用`clear()`），然后对其进行进一步操作才能成功。

（通常最好从流中提取整*行*作为字符串（在耗尽流之前永远不会失败）`std::getline`，然后分别处理每一行。）

# signal-processing - MCU 上的高效调幅 (C)

> ID：13131180
> 
> 赞同：1
> 
> 时间：2012-10-29T23:33:15.067
> 
> 标签：signal-processing, msp430, amplitude, dac

我正在研究微控制器合成器，但我遇到了音量包络生成问题。我现在有这个代码：
`to_dac =(SinTable[lut_pos] * (volume))>>8;`

它工作正常，但分辨率真的很差，我不知道如何改进它以使其仍然可以足够快地运行（因为必须为每个样本执行此操作）

这些是我现在得到的结果：

[波形](https://docs.google.com/open?id=0B7TersVMKAYAbFpJeTZuU3lHQ1U "海浪")

[这是一个 MP3 现在的声音：（注意：DAC 在面包板上，输出端没有低通滤波器，所以有一些多余的噪音）](https://docs.google.com/open?id=0B7TersVMKAYAX2hpR2RpSVFmZFU "MP3的输出")

我正在使用 MSP430 设备（目前是 MSP430G2553，但如果真的有必要，我可以使用 MSP430F5510（更多内存，更快的速度）我也尝试寻找示例，但它们都使用浮点变量，sin() ; 函数和 math.h 中的其他函数，但我没有这些的奢侈......

编辑：我是个彻头彻尾的白痴，另一段代码导致幅度包络的分辨率较低，但我对幅度调制的其他解决方案持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-20T16:27:18.703

我查看了 MSP430G2553 数据表并没有找到任何 DAC。你用的是外接DAC吗？

现代 MCU 具有支持 DMA 的高速 DAC。您可以在内存中填写表格（一个或多个罪恶周期），而不是向 DMA 发出命令以将数据发送到 ADC。

因此，您将给 CPU 更多空闲时间来完成其他工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T11:01:51.760

我必须查看您的其余代码和您的一些硬件设置，但我会假设您有一个中轨的虚拟地面？如果是这样，并且您的 SinTable[] 以参考接地为参考（即对于 12 位 dac，虚拟接地输出将为 2048，Vcc 将为 4095，Gnd 将为 0，然后乘以音量将改变您的虚拟地面。

尝试这个..

```
if (SinTable[lut_pos] >= 2048) {
  out = 2048 + (SinTable[lut_pos]-2048)*volume;
} else {
  out = 2048 - (2048-SinTable[lut_pos])*volume;
}
to_dac = out>>8; 
```

我不确定你为什么要移位，但你可以通过事先缩放 SinTable 来省去麻烦。

# c++ - 函数头中的 C/C++ 数组变量

> ID：13131182
> 
> 赞同：5
> 
> 时间：2012-10-29T23:33:20.810
> 
> 标签：c++, c, arrays, function, variables

我们可以在 C/C++ 函数头中将数组作为变量传递，如

```
int func(int arr[]) { ... } 
```

我想知道：是否有可能`[]`在传递给函数头的变量中存在某些内容，或者它总是空的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T23:39:57.693

对于任何（非引用）类型`T`，函数签名 `R foo(T t[])`和`R foo(T t[123])`（或任何其他数字）都与 相同`R foo(T * t)`，并且通过传递第一个元素的地址来传递数组。

请注意，`T`它本身可能是数组类型，例如`T = U[10]`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T23:35:24.583

对于一维数组，它总是空的，括号是另一种写法：

```
int fun(int * arr)
{

} 
```

至于二维数组，需要指定每个元素本身包含多少个元素

```
int fun(int arr[][3])
{

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T10:58:47.200

int func(int arr[]) { ... } 是传递给函数的数组的无效声明。

数组名是一个指针变量。所以我们只需传递数组名称（它本身就是一个指针）就足够了

int func(int *arr) { ... } 将数组的起始地址传递给函数，以便它可以使用数组。

如果原始数组需要保持完整，可以在函数中创建和使用数组的副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T12:55:13.053

在大多数情况下，数组的**名称会衰减为****指向其第一个元素的指针。**所以当你写

```
void f(int arr[]);
void g(int arr[42]); 
```

该名称`arr`衰减为指向 int 的指针。这两个声明等价于：

```
void f(int *arr);
void g(int *arr); 
```

名称不会衰减的两个地方是在数组的定义中和作为`sizeof`. 所以这个全局范围的声明没有定义一个指向 int 的指针：

```
int arr[]; 
```

我之所以提到这个特殊的错误，是因为它很容易犯，而且很难追查。这定义了一个数组，而不是一个指针，即使没有指定元素的数量。`arr`从另一个源文件引用为`int *arr;`.

# performance - CUDA 适合实时应用吗？

> ID：13131183
> 
> 赞同：3
> 
> 时间：2012-10-29T23:33:30.073
> 
> 标签：performance, cuda, real-time

继续我[之前的问题](https://stackoverflow.com/questions/13130967/why-cuda-memory-copy-speed-behaves-like-this-some-constant-driver-overhead)。CUDA 适合实时快速应用吗？任务是：我需要我的应用程序在 0.1-0.3 毫秒内进行大量计算。CUDA 内核在适合我的项目的非常好的时间内处理这些计算，但是由于我得到的所有开销（内存复制），时间是不可接受的。

CUDA 是不能用于这种应用程序，还是有一些技巧可以避免我之前的问题中描述的 sutuations？

[这些家伙](http://real-time.ccur.com/Real-Time_CUDA.aspx)提供了所谓的“GPU Workbench”，并在他们自己的 linux 版本上构建了经过修改的 gpu 驱动程序。他们说他们的系统比典型的 GPU 配置执行得更快。有人知道他们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:35:04.027

0.3ms 是在 GPU 上运行完整程序的一个非常小的时间窗口。即使对于非常小的任务，10 倍也是更典型的。如果你的任务太小以至于它可以在这么短的时间内运行，那么你可能甚至没有使 GPU 饱和，甚至在 GPU 上运行它也没有任何意义。

也就是说，我确实将 CUDA 用于一个周转时间大约为一秒的实时分布式系统，但听起来我们对“实时”的定义比你的要宽松一些。

我对您链接的“GPU Workbench”一无所知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:18:56.203

我将分两部分回答这个问题。

1.  程序的运行时间取决于您实现的数据量和并行度。并且还使用不同的技术（使用 L1 和 L2 缓存、多个内核）和其他东西。正如您提到的实时应用程序，您需要不时使用 CPU 内存。如果可能，请尝试一次使用所有数据。

2.  如果您的应用程序使用图形。我推荐使用图形库（OpenGL [also, GLSL], DirectX [HLSL]）。

# asp.net-mvc - ASP.NET MVC 部署路由

> ID：13131187
> 
> 赞同：0
> 
> 时间：2012-10-29T23:33:52.040
> 
> 标签：asp.net-mvc, iis

我在 Visual Studio 2012 中构建了我的 ASP.NET MVC 4 网站的 WebDeploy 包。

当我在我的服务器上运行部署程序时，它成功地将网站部署到我的服务器上名为`/myapp`

但是，当我`localhost/myapp`在浏览器中导航到 404 时，似乎 IIS 正在寻找物理路径（一对一）。如何配置 IIS，或设置重写规则，以便`/myapp`在其内部运行？

例如，网站具有的链接和重定向指向`localhost/static/style.css`，当它们*应该*指向时`localhost/myapp/static/style.css`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:36:35.050

您可以在路径中使用波浪号来告诉 ASP.NET 从应用程序根开始遵循路径：

```
~/static/style.css 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:39:35.233

您是否在 IIS 中创建了一个名为 的应用程序`myapp`？它应该具有指向您为网站部署文件的路径 - 在您的情况下：`/myapp`

# ruby - 在 Webistrano 中使用捆绑器、capistrano 部署错误并需要 'bundler/capistrano' 配方

> ID：13131189
> 
> 赞同：0
> 
> 时间：2012-10-29T23:34:00.570
> 
> 标签：ruby, rvm, capistrano, bundler, webistrano

最近，我一直在尝试将 Webistrano 从不使用 bundler 来管理应用程序 gem 的版本升级到使用的版本。为了部署 Rails 应用程序，我们将`require 'bundler/capistrano'`在配方中使用为应用程序和其他相关步骤（如预编译资产等）加载捆绑程序。但是，一旦将 bundler 与 Gemfile 一起使用来指定和加载适当的 gem 环境，就会`require 'bundler/capistrano'`引发以下错误：

> ** 加载阶段配方“捆绑器”
> 
> *** 定义一个名为 `install' 的任务会影响具有该名称的现有方法

如果我从配方中排除要求，部署将继续但不使用捆绑器（否`bundle exec`等）

`require 'rvm/capistrano'`在尝试使用`rvm`来管理 ruby​​ 环境时，我也有类似的问题。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:11:13.913

也许是因为您使用的是具有安装任务的 rake 0.9.x [https://github.com/jimweirich/rake/blob/master/lib/rake/contrib/sys.rb#L30](https://github.com/jimweirich/rake/blob/master/lib/rake/contrib/sys.rb#L30) 尝试使用 rake 0.8.7 运行这个问题可能与[https://github.com/capistrano/capistrano/pull/90有关](https://github.com/capistrano/capistrano/pull/90)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:49:39.913

我刚刚检查了 of 的代码`bundler/capistrano`并且我知道 的代码`rvm/capistrano`，唯一可以做到这一点的方法是当`capistrano`'s`namespace`被覆盖/损坏并且没有为`task`定义提供适当的范围时，请确保您没有重新定义`namespace`或没有其他`gem`//那会那样做`library`。`code`

可能将 capistrano 更新到较新的版本可以修复它（这可能是一些已经修复的错误`capistrano`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T10:04:42.587

您的服务器和本地计算机上是否安装了 bundler 和 rvm-capistrano gem？我以前见过这导致问题。

# canvas - Three.js - 从导入的网格中更改面部的颜色？

> ID：13131197
> 
> 赞同：1
> 
> 时间：2012-10-29T23:35:07.453
> 
> 标签：canvas, 3d, webgl, three.js

在three.js 中，我似乎无法找到如何定位/更改从Blender 导入的网格的颜色。任何帮助将不胜感激。

此外，如果知道如何让所述面（或任何网格中的面）“重叠”或首先出现在所有其他面之上，也将是一件很棒的事情。

```
 loader = new THREE.JSONLoader();
        var callbackDice   = function( geometry ) { createMesh(geometry); };
        loader.load( "js/untitled.js", callbackDice );

function createMesh(geometry){
        material = new THREE.MeshNormalMaterial();
        mesh = new THREE.Mesh( geometry, material);
        mesh.scale.set( 75, 75, 75 );
        mesh.position.x = -1;
        scene.add( mesh);
    } 
```

这就是我将需要的网格插入到场景中的方式。我想定位一个特定的脸并改变它的颜色，但我不知道该怎么做，因为它不是三个对象的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:02:12.277

`THREE.Mesh`其实也是`THREE.Object3D`。但是，我认为这不会直接帮助您。

我相当[更新 wiki 页面](https://github.com/mrdoob/three.js/wiki/Updates)：

> 您可以自由更改用于几何块的材质，您无法更改对象被划分为块的方式（根据面材质）。
> 
> 如果您在运行时需要有不同的材质配置，如果材质/块的数量很少，您可以预先划分对象（例如头发/面部/身体/上衣/裤子，正面/侧面/顶部/玻璃/轮胎/汽车内饰）。
> 
> 如果数量很大（例如每张脸可能不同），请考虑不同的解决方案，使用属性/纹理来驱动不同的每张脸外观。

由此推断，要么为每个可选面使用自己的材料（因此您可以在选择时更改它），或者编写一个自定义解决方案，可以动态地为纹理的相关部分着色，或者使用自定义属性缓冲区来传达彩色面。

我能想到的另一种选择是以顶点颜色烘焙颜色并使用它们。尽管那时您可能会获得颜色插值，但仍需要确保将修改后的缓冲区上传到 GPU。

至于“面面相觑”，我不太明白你想要什么。你想从网格中“分解”脸部，旋转它以面对相机还是确保脸部的深度顺序正确？

# c - 如何测试四连胜的胜利条件？

> ID：13131203
> 
> 赞同：0
> 
> 时间：2012-10-29T23:35:40.527
> 
> 标签：c, logic

试图创建一个连接 4 游戏。除了胜利条件外，一切正常。这是代码，感谢每一个帮助。（抱歉标识符是德语，但我希望你能理解代码）。数组“spielfeld”是一个用 0 初始化的二维数组。120 和 111 代表 x 和 o。

编辑：只剩下关键部分，抱歉代码溢出

```
#include <stdio.h>
#include "eingabe.h"
#include <stdlib.h> 
```

//初始化

```
int main(void)
{
int spieler = 1;
int won = 0;
while(won == 0)
{
    switch(spieler)
    {
        case 1:
              anzeige(zeilen, spalten, spielfeld);
              auswahl = erfasse_ganze_zahl(0, spalten);
              erfolg = setze(zeilen, spalten, spielfeld, auswahl, 1, 120);
              won = victory_condition(zeilen, spalten, spielfeld);
              break;
        case 2:
              anzeige(zeilen, spalten, spielfeld);
              auswahl = erfasse_ganze_zahl(0, spalten);
              erfolg = setze(zeilen, spalten, spielfeld, auswahl, 1, 111);
              won = victory_condition(zeilen, spalten, spielfeld);
              break;
    }
    return 0;
}   

int setze(int zeilen, int spalten, int spielfeld[zeilen][spalten], int auswahl, int spieler, char wert)
{
    auswahl--;
    for (int i = spalten - 1; i >= 0; i--)
    {
        if(spielfeld[i][auswahl] == 0)
        {
            spielfeld[i][auswahl] = wert;
            return 0;
        }
    }
    return -1;
}   

void anzeige(int zeilen, int spalten, int spielfeld[zeilen][spalten])
{
    int i, j, k = 0;
    for(i = 0; i < spalten; i++)
    {
        for(j = 0; j < zeilen; j++)
        {
            printf("%c", spielfeld[i][j]);
            printf(" | ");
            if (j == zeilen - 1)
            {
                printf("\n");
                for (k = 0; k < spalten; k++)
                    printf("----");
                printf("\n");
            }
        }
    }
} 
```

//一些代码

```
int victory_condition(int zeilen, int spalten, int spielfeld[zeilen][spalten])
{
    int vertikal = 1;//(|)
    int horizontal = 1;//(-)
    int diagonal1 = 1;//(\)
    int diagonal2 = 1;//(/)
    char spieler = spielfeld[zeilen][spalten];
    int i;
    int j;//horizontal
     //check for vertikal(|)
    for(i = 0; spielfeld[i][spalten] == spieler && i <= zeilen; i++)
        vertikal++;//Check down
    printf("\n%d, %d\n\n%d, %d\n", vertikal, horizontal, diagonal1, diagonal2);
    for(i = zeilen; spielfeld[i][spalten] == spieler && i >= 0; i--)
        vertikal++;//Check up
    printf("\n%d, %d\n\n%d, %d\n", vertikal, horizontal, diagonal1, diagonal2);
    if(vertikal >= 4) return 1;
    //check for horizontal(-)
    for(j = spalten -1; spielfeld[zeilen][j] == spieler && j >= 0; j--,horizontal++);//Check left
        for(j = spalten +1; spielfeld[zeilen][j] == spieler && j <= 6; j++,horizontal++);//Check right
            if(horizontal >= 4) return 1;
    //check for diagonal 1 (\)
    for(i = zeilen -1, j = spalten - 1; spielfeld[i][j] == spieler && i >= 0 && j >= 0; diagonal1 ++, i --, j --);//up and left
        for(i = zeilen +1, j = spalten + 1; spielfeld[i][j] == spieler && i <= 5 && j <= 6; diagonal1 ++, i ++, j ++);//down and right
            if(diagonal1 >= 4) return 1;
    //check for diagonal 2(/)
    for(i = zeilen -1, j= spalten +1;spielfeld[i][j] == spieler && i>=0 && j <= 6; diagonal2 ++, i --, j ++);//up and right
        for(i = zeilen +1, j= spalten -1;spielfeld[i][j] == spieler && i<=5 && j >=0; diagonal2 ++, i ++, j --);//up and left
            if(diagonal2 >= 4) return 1;
    printf("\n%d, %d\n\n%d, %d\n", vertikal, horizontal, diagonal1, diagonal2);
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:43:26.700

一旦新硬币（或别针或其他任何东西）掉落，只需检查它的周围环境。我在这里只做水平检查，但其他的工作方式类似。

```
int x; // position of the dropped token
int y; // position of the dropped token

for(int count = 0, ix = max(0, x - 3); ix < min(width, x + 3); ++ix) { // go through all fields that might be part of the winning row
    if (field[y][x] == mycolor) { // if it's the active player's color...
        if (++count == 4) // increase the count and check whether there are enough tokens
            winner = true;
    }
    else // if the color doesn't match...
        count = 0; // reset the count
} 
```

# r - 使用for循环在R中输出方程

> ID：13131207
> 
> 赞同：0
> 
> 时间：2012-10-29T23:36:00.290
> 
> 标签：r, function, for-loop

我目前有一系列方程式，用于对生物系统的隔室进行建模。我希望能够在 for 循环之外为我希望模型拥有的隔间数量设置一个变量 n，然后让函数输出那么多 dn.dt。我很确定我必须在函数末尾将它们作为向量返回，但这是我唯一的线索。以下是我希望我的基本功能在 n = 3 时的用途。

```
rate <- function(time, state, parms){
  with(as.list(c(state,parms)),{
    dX.dt <- do stuff
    d1.dt <- do different stuff 
    d2.dt <- do same stuff as d1.dt
    d3.dt <- do same stuff as d1.dt
    return(list(c(dX.dt, d1.dt, d2.dt, d3.dt)))})} 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:54:25.900

我想你在之后`replicate`，你可以通过`n`所需的重复次数。

```
rate <- function(time, state, parms, n){

  dX.dt <- with(as.list(c(state,parms)), foo(....))
  dn.dt <-  with(as.list(c(state,parms)), replicate(n, foobar(...), simplify = FALSE)

return(c(dX.dt, dn.t))))} 
```

我不确定这些`with(as.list(c(state,parms))`是否必要，但如果没有一个简单的可重现示例，我无法确定。

# javascript - 等到所有对象都加载到地图上

> ID：13131208
> 
> 赞同：0
> 
> 时间：2012-10-29T23:36:18.337
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我正在尝试在谷歌地图上绘制数百个建筑足迹。但我遇到了回调问题（我认为）......

为此，在加载 Google 地图后，我从数据库中获取建筑物 ID 的列表，并为每个 ID 创建一个新的建筑物对象。

## 主页

```
function load_buildings() {
    var url='/api/get_imaged_buildings/';
    $.getJSON(url, function(buildings) {
        for(var building in buildings) {
            var new_building = new Building(buildings[building].id, buildings[building].footprint);
        }
    })
    .error(function(jqXhr, textStatus, error) {
        alert("ERROR: " + textStatus + ", " + error);
    });
} 
```

返回：

```
{"507ca17f0f53664a62000fc0": {"footprint": [[-71.06344334281945, 42.354043084935846], [-71.0637134471212, 42.35412603649889], [-71.06333405397038, 42.35480611690739], [-71.06338439864643, 42.35482782501911], [-71.0632517948924, 42.355064458152995], [-71.063047338961, 42.35496617995809], [-71.06308636758757, 42.35492158377903], [-71.06293828848663, 42.35485043826673], [-71.06289913717758, 42.354895213988364], [-71.06272577376158, 42.35481190819347], [-71.06319845721484, 42.35438624633442], [-71.06344334281945, 42.354043084935846]], "id": "507ca17f0f53664a62000fc0"}, 
```

## 构建.js

```
function Building(id, footprint) {
    this.id = id;
    this.footprint = footprint;
}
Building.prototype.plotFootprint = function() {
    var footprint = [];
    var footprint_from_db = this.footprint;
    for(var i=0; i<footprint_from_db.length; i++)
    {
        var location = footprint_from_db[i];
        var point = new google.maps.LatLng(location[0], location[1]);
        bounds.extend(point);
        footprint.push(point);
    }
    var building = new google.maps.Polyline({
        path: footprint,
        strokeColor: '#e81971',
        strokeOpacity: 1.0,
        strokeWeight: 2
    });
    building.setMap(map);
} 
```

我想要做的是在所有建筑物都加载后绘制所有建筑物。做这个的最好方式是什么？我想优化速度。

谢谢。

编辑：我取出了错误的代码并使用了有效的方法。现在我想知道如何确定何时将所有足迹加载到所有对象中，然后我应该在哪里绘制它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:17:52.237

jQuery 有一个称为 Defered 对象的东西——它允许您设置一系列回调以按顺序运行，然后在一切结束后运行一些代码。

查看 dox：[http ://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

# automation - 自动化 Python 脚本

> ID：13131211
> 
> 赞同：0
> 
> 时间：2012-10-29T23:36:43.693
> 
> 标签：automation, cron

我有一个 python 脚本，上传到一个 24/7 的网络服务器上。我想自动化这个脚本，让它每小时自动运行一次。这可能吗？我遇到了 cron 工作的东西，但我不熟悉如何实现这一点。任何帮助或示例都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:39:26.497

打开你的cron作业文件

```
crontab -e 
```

添加这一行

```
* 0 * * *  /path/to/my/script 
```

我建议使用 bash 脚本或其他东西来检查进程是否已经在运行。

```
if [ `ps -u USERNAME | grep -i PROCESSNAME | wc -l` -lt 1 ]
then
  nohup python main.py &
fi 
```

**编辑**

键入命令`crontab -e`，然后按回车键。你的屏幕会变黑，旁边有一堆`~`'。按`i`您现在处于插入模式。键入`* 0 * * * /path/to/my/script`，确保这是脚本的绝对路径。按`Esc`，然后键入`:x`并按 Enter。那应该保存 cron 文件，这也假设`vi`或者`vim`是您的 cron 文件的默认编辑器。

*旁注*

还要确保您的脚本是可执行的，`chmod 777 myscript.py`应该可以解决问题，但是请熟悉 chmod 和权限。

还要确保你`#/python/version/to/use`的 python 文件的第一行是你的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:13:00.057

首先：问问自己数据是否应该是动态的而不是静态的。通过数据库或 cgi 脚本可能会更好地访问动态数据。

第二：稍微阅读一下说明书。crontab 是用于管理 cron 作业的程序。网络搜索可以为您提供更深入的信息（知道要击中哪个钉子是成功的一半）。man crontab 对计划没有太大帮助，但如果它没有按您的预期编辑文件，它可以提供有关程序的指示。

第三：通过执行'which python'来确定你的python从哪里运行并将描述符添加到文件的顶部。就我而言，它是 #!/usr/bin/python

第四：将您的 pyhton 脚本放在适当的位置，如果它足够重要并且您有权限，则可能是 /usr/local/sbin/。对文件使用 chmod 775 使您的文件可执行。运行该文件以确保它按预期执行。

第五：用crontab -e编辑cron作业表表如果不能自己运行，可以试试sudo下运行（即sudo crontab -e）。

第六：添加一行为 0 * * * * /myPath/myfile.py

每次分钟更改为 00 时都会运行。维基百科说 @hourly 应该可以工作，但我从未尝试过。

格式如下

```
*    *    *    *    *  command to be executed
┬    ┬    ┬    ┬    ┬
│    │    │    │    │
│    │    │    │    │
│    │    │    │    └───── day of week (0 - 6) (0 is Sunday)   
│    │    │    └────────── month (1 - 12)
│    │    └─────────────── day of month (1 - 31)
│    └──────────────────── hour (0 - 23)
└───────────────────────── min (0 - 59) 
```

第七：测试测试测试。

crontab -l 列出 cron 作业规范。

cron 执行时可能必须存在诸如 $PYTHONPATH 之类的环境变量。

如果 crontab 中有 6 个字段，则第一个字段可能是秒。

有一天你想记录 seomthing 的输出。阅读有关在 /var/logs 中创建日志文件目录以及如何使用 /etc/logrotate.d/ 文件管理它的信息。

# asp.net - 如何在 ASP.NET 中以编程方式创建子域？

> ID：13131218
> 
> 赞同：5
> 
> 时间：2012-10-29T23:37:19.243
> 
> 标签：asp.net, subdomain, routes

有没有办法通过代码创建子域并将它们路由到我的主域？

`product123.domain.com`代替`www.domain.com/products/?id=123`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T23:44:47.410

我们做同样的事情，但不使用代码生成 DNS 记录。相反，我们创建一个通配符 DNS 条目，将所有子域解析为给定 IP。在代码内部，我们从请求 URI 中检索子域并将其用于进一步处理。

我们使用亚马逊的 Route53 DNS，并且有一个像这样的 A 条目

*.ourblogsite.com 184.5.5.5

它将所有子域解析为该 IP 地址。在 IIS 中，我们将应用程序绑定到该 IP 的端口 80 而不是主机名，它将处理任何请求。Web 应用程序是一个 MVC 应用程序，它分解请求 URI 并找出子域部分。我们使用它来支持 somename.ourblogsite.com 功能，其中 somename 是客户端提供的唯一标识符。

# css - 文本框垂直对齐中间或其他东西......顶部或文本顶部不起作用

> ID：13131219
> 
> 赞同：0
> 
> 时间：2012-10-29T23:37:26.267
> 
> 标签：css, textbox, vertical-alignment

我在 WordPress 中使用了一个制作表单的插件，我添加了一个消息框（这是一个联系表单）并给它我自己的类，在 css 中，我让它更高。这工作得很好，但是每当我单击该框时，光标就会移动到中间，并且它不会环绕文本。我试过了：

```
.messageBoxContactForm {
    vertical-align: top;
} 
```

和

```
.messageBoxContactForm {
    vertical-align: text-top;
} 
```

这是HTML：

```
<div>
  <label for="messageBox">* Message:</label>
  <input class="messageBoxContactForm ccf-tooltip-field" id="messageBox-1351642237" type="text" name="messageBox" value="">
</div> 
```

请记住，这是在 WordPress 中，所以它周围有大量的 PHP。

谁能告诉我我需要做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:44:32.070

您是否尝试添加以下块，

```
.messageBoxContactForm {
   text-align: left;
} 
```

[http://www.w3schools.com/cssref/pr_text_text-align.asp](http://www.w3schools.com/cssref/pr_text_text-align.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T15:49:45.657

实际上你的问题只是你使用了错误的标签`<input>`，你应该使用`<textarea>`，所以你的 html 代码应该是：

```
<textarea></textarea> 
```

textarea 的默认文本对齐方式是左上角。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T14:09:29.257

input type="text" 不换行，它不是多行输入，它的高度完全无关紧要。你想要一个文本区域输入。

尝试：

```
<input class="messageBoxContactForm ccf-tooltip-field" id="messageBox-1351642237" 
type="textarea" name="messageBox" value=""> 
```

可能的缺点是 textareas 会换行。

# python - 从单个值构建一个小的 numpy 数组：快速且可读的方法？

> ID：13131220
> 
> 赞同：13
> 
> 时间：2012-10-29T23:37:28.157
> 
> 标签：python, numpy

我发现我的程序中的一个瓶颈是从给定值列表中创建 numpy 数组，最常见的是将四个值放入 2x2 数组中。有一个明显的，易于阅读的方法来做到这一点：

```
my_array = numpy.array([[1, 3], [2.4, -1]]) 
```

这需要 15 我们 - 非常非常慢，因为我做了数百万次。

然后有一个更快，难以阅读的方式：

```
my_array = numpy.empty((2,2))
my_array[0,0] = 1
my_array[0,1] = 3
my_array[1,0] = 2.4
my_array[1,1] = -1 
```

这快了 10 倍，仅需 1 us。

有没有既快速又易于阅读的方法？

到目前为止我尝试了什么：使用`asarray`而不是`array`没有区别；传入`dtype=float`也`array`没有什么区别。最后，我明白我可以自己做：

```
def make_array_from_list(the_list, num_rows, num_cols):
    the_array = np.empty((num_rows, num_cols))
    for i in range(num_rows):
        for j in range(num_cols):
            the_array[i,j] = the_list[i][j]
    return the_array 
```

这将在 4us 中创建数组，这是中等速度下的中等可读性（与上述两种方法相比）。但实际上，我无法相信使用内置方法没有更好的方法。

先感谢您！！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T00:29:23.177

这是一个很好的问题。我找不到任何可以接近您完全展开的解决方案的速度的东西（**编辑** *@BiRico 能够想出一些接近的东西。请参阅评论和更新*:)。以下是我（和其他人）提出的一系列不同选项以及相关的时间安排：

```
import numpy as np

def f1():
    "np.array + nested lists"
    my_array = np.array([[1, 3], [2.4, -1]])

def f2():
    "np.array + nested tuples"
    my_array = np.array(((1, 3), (2.4, -1)))

def f3():
    "Completely unrolled"
    my_array = np.empty((2,2),dtype=float)
    my_array[0,0] = 1
    my_array[0,1] = 3
    my_array[1,0] = 2.4
    my_array[1,1] = -1

def f4():
    "empty + ravel + list"
    my_array = np.empty((2,2),dtype=float)
    my_array.ravel()[:] = [1,3,2.4,-1]

def f5():
    "empty + ravel + tuple"
    my_array = np.empty((2,2),dtype=float)
    my_array.ravel()[:] = (1,3,2.4,-1)

def f6():
    "empty + slice assignment"
    my_array = np.empty((2,2),dtype=float)
    my_array[0,:] = (1,3)
    my_array[1,:] = (2.4,-1)

def f7():
    "empty + index assignment"
    my_array = np.empty((2,2),dtype=float)
    my_array[0] = (1,3)
    my_array[1] = (2.4,-1)

def f8():
    "np.array + flat list + reshape"
    my_array = np.array([1, 3, 2.4, -1]).reshape((2,2))

def f9():
    "np.empty + ndarray.flat  (Pierre GM)"
    my_array = np.empty((2,2), dtype=float)
    my_array.flat = (1,3,2.4,-1)

def f10():
    "np.fromiter (Bi Roco)"
    my_array = np.fromiter((1,3,2.4,-1), dtype=float).reshape((2,2))

import timeit
results = {}
for i in range(1,11):
    func_name = 'f%d'%i
    my_import = 'from __main__ import %s'%func_name
    func_doc = globals()[func_name].__doc__
    results[func_name] = (timeit.timeit(func_name+'()',
                                        my_import,
                                        number=100000),
                          '\t'.join((func_name,func_doc)))

for result in sorted(results.values()):
    print '\t'.join(map(str,result)) 
```

以及重要的时间：

在 Ubuntu Linux 上，Core i7：

```
0.158674955368  f3  Completely unrolled
0.225094795227  f10 np.fromiter (Bi Roco)
0.737828969955  f8  np.array + flat list + reshape
0.782918930054  f5  empty + ravel + tuple
0.786983013153  f9  np.empty + ndarray.flat  (Pierre GM)
0.814703941345  f4  empty + ravel + list
1.2375421524    f7  empty + index assignment
1.32230591774   f2  np.array + nested tuples
1.3752617836    f6  empty + slice assignment
1.39459013939   f1  np.array + nested lists 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T01:05:44.707

尽管显然违反直觉，但结果并不令人惊讶：NumPy 并非旨在处理大量非常小的数组。相反，它旨在操作更大的数据数组。

我建议先创建一个大小为 的大型数组，`N*2*2`用您的数据填充它，然后将其重塑为`(N,2,2)`.

* * *

作为旁注，您可能想尝试

```
def f10():
    mine = np.empty((2,2), dtype=float)
    mine.flat = (1,3,2.4,-1) 
```

该`.flat`方法应该比该`.ravel()[:]=...`方法更有效（我的个人测试表明它与 @mgilson 的顺序相同`f3`）。

# c# - 如何在O（log n）中获得大于SortedDictionary中指定键的第一个键？

> ID：13131240
> 
> 赞同：4
> 
> 时间：2012-10-29T23:39:59.603
> 
> 标签：c#, .net, search, dictionary, sorteddictionary

假设我有以下代码：

```
SortedDictionary<int,string> test = new SortedDictionary<int, string> ( );
test.Add ( 1, "one" );
test.Add ( 3, "three" );
test.Add ( 7, "seven" );
test.Add ( 8, "eight" );
int key = GetFirstKeyGreaterThan ( test, 3 ); // expects to get 7
int key2 = GetFirstKeyGreaterThan ( test, 6 ); // expects to get 7 
```

有没有一种简单的方法来实现 GetFirstKeyGreaterThan 方法？我知道我们可以使用 GetEnumerator 方法并在达到 3 的键后调用 MoveNext，但这将是一个 O(n) 操作。

我不想使用 SortedList，因为我需要 O(log n) 来插入和删除键。

# c# - 将状态更新从 C++ 中的函数发送到 C#

> ID：13131241
> 
> 赞同：2
> 
> 时间：2012-10-29T23:40:13.563
> 
> 标签：c#, c++, events, asynchronous, delegates

我的 C++ dll 中有一个非常大的函数，它执行很多任务。我们从 ac# 包装器调用它，完成 c++ 函数大约需要 20 秒。我想改变我们运行它的方式。我的想法是 1\. 调用 c++ 函数异步和 2\. 每次使用 C++ 函数完成任务时，我想将“task1 完成”消息发送到 C# 函数并将其显示给用户，以便他们知道什么是在后台进行。

任何想法如何执行这个？我查了几个例子，但感到困惑。我想知道是否有人这样做过。寻找一些指示。

例如：C++ 代码

```
int  CppLibrary::ExecuteWorkflow( param1,param2, param3,param4,param5)
{
task1;
task2;
task3;
task4;
task5;

}

calling the C++ function from C# wrapper:

[DllImport(_dllLocation)]
public static extern int ExecuteWorkflow( param1,param2, param3,param4,param5); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:10:28.013

1.  Export your C++ function using a C-like name (export "C" __declspec(dllexport))
2.  Create a DllImport for your library call using DllImport.
3.  Create a thread and invoke the import with your callback logic (i.e. Task.Run with delegate).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T06:48:14.840

这是 P/Invoke C++ 函数的包装类。希望能帮到你。

```
class CSUnmangedTestClass : IDisposable
{
    #region P/Invokes

    [DllImport(@"E:\VS2012Tests\test\Debug\DllImport.dll", EntryPoint="#1")]
    private static extern IntPtr Foo_Create();

    [DllImport(@"E:\VS2012Tests\test\Debug\DllImport.dll", CallingConvention = CallingConvention.Cdecl)]
    private static extern int Foo_Bar(IntPtr pFoo);

    [DllImport(@"E:\VS2012Tests\test\Debug\DllImport.dll", CallingConvention = CallingConvention.Cdecl)]
    private static extern void Foo_Delete(IntPtr pFoo);

    #endregion

    #region Members
    // variable to hold the C++ class's this pointer
    private IntPtr m_pNativeObject;
    #endregion

    public CSUnmangedTestClass()
    {
        this.m_pNativeObject = Foo_Create();
    }

    public void Dispose()
    {
        Dispose(true);
    }

    protected virtual void Dispose(bool bDisposing)
    {
        if (this.m_pNativeObject != IntPtr.Zero)
        {
            Foo_Delete(m_pNativeObject);
            this.m_pNativeObject = IntPtr.Zero;
        }
        if (bDisposing)
        {
            // No need to call the finalizer since we've now cleaned up the unmanged memory
            GC.SuppressFinalize(this);
        }
    }

    ~CSUnmangedTestClass()
    {
        Dispose(false);
    }

    #region Wrapper methods

    public int Bar()
    {
        return Foo_Bar(m_pNativeObject);
    }

    #endregion
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:03:51.630

您可以在 C# 中使用委托来调用您的 C++ 包装器，然后根据您的情况使用“invoke”或“beginInvoke”。

[Dispatcher.BeginInvoke 方法](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.begininvoke.aspx)

# java - 如何测试在`POST_COMMIT_INSERT`回调上执行的事务工作

> ID：13131242
> 
> 赞同：1
> 
> 时间：2012-10-29T23:40:51.757
> 
> 标签：java, spring, hibernate, unit-testing, transactions

我在调试和诊断应用程序中的问题时遇到了困难。

我有一个连接到 JPA 事件侦听器以在`POST_COMMIT_INSERT`. 执行的工作也是事务性的。

我在编写一个捕获事务后事务中发生的工作的测试时遇到了困难。

我当前的测试在方法中执行它的断言`@PostTransaction`。但是，尽管我看到数据被持久化（使用日志语句），但我无法使用 postTransaction-transaction 工作。

我怀疑这是因为在我的`@PostTransaction`方法中，我还为时过早——而且还有另一笔交易正在进行中。

这是一个大致演示该场景的示例：

> 创建并保存 a后`Foo`，创建并保存`Bar`.

```
// Step 1\.  The factory that responds to creation of the Foo, and build a bar.
@Component
class BarFactory implements PostInsertEventListener
{
     // Note:  I've tried various versions of @Transactional on different points
     // within this class, and none have worked.

     @Autowired
     private BarRepository repository;

     @Override
     public void onPostInsert(PostInsertEvent event) 
     {
         if (event.getEntity() instanceof Foo)
         {
             createBar();
         }
     }
     @Transactional
     public createBar()
     {
         Bar bar = new Bar();
         repository.save(bar);
         log.info("Bar was created: " + bar.getId());
     }
 }

 // Step 2:  Register the BarFactory
 @Component
 class LifecycleListenerFactory {
    // This is a spring bean, and the listeners are also spring beans
    // so we have to use a somewhat long-winded approach to register them
    // with the EntityManager
    @Autowired
    public LifecycleListenerFactory(EntityManager em, BarFactory barFactory)
    {
        SessionFactory sessionFactory = getSessionFactory(em);
        EventListenerRegistry registry = ((SessionFactoryImpl) sessionFactory).getServiceRegistry().getService(EventListenerRegistry.class);
        EventListenerGroup<PostInsertEventListener> eventListenerGroup = registry.getEventListenerGroup(EventType.POST_COMMIT_INSERT);
        eventListenerGroup.appendListener(barFactory);
    }

   SessionFactory getSessionFactory(EntityManager entityManager) {
       Session session = (Session) entityManager.getDelegate();
       SessionFactory sessionFactory = session.getSessionFactory();
       return sessionFactory;
   }
 } 

// Step 3:  Test.
@RunWith(SpringJUnit4ClassRunner.class)
@Transactional
@TransactionConfiguration(defaultRollback=false)
class MyTest {
   @Autowired
   private FooRepository fooRepo;
   @Autowired
   private BarRepository barRepo;

   @Test
   public void test()
   {
       fooRepo.save(new Foo());
   }

   @AfterTransaction
   public void assert()
   {
       assertThat(barRepo.findAll().size(),equalTo(1));
   }
} 
```

在这种情况下，我看到以下输出：

`INFO: Bar was created: 1`

但是测试失败了。

我的假设是正确的，即我`@AfterTransaction`在错误的交易之后运行，还是这里有其他问题？

如果是这样，我该如何测试？

我尝试在`@Transaction`中移动边界`BarFactory`，但这没有任何效果。

# bash - awk 脚本需要修改或可能需要 grep 解决方案（awk 的新手）

> ID：13131245
> 
> 赞同：2
> 
> 时间：2012-10-29T23:40:57.920
> 
> 标签：bash, awk, sh

我有一个像我在这里链接的数据集：http: [//pastebin.com/7tpBAqua](http://pastebin.com/7tpBAqua)

请注意，前两行不是数据（数字），尽管如此，第二行与第三行相关联。同样，第 4 行与第 5 行相关联，依此类推。

目前，我们有一个 awk 脚本，它输出高于阈值的所有行号的信息（低于 -1 和高于 1 的任何内容），这是输出：

```
71
72
88
98
99
.... and so on... 
```

如果数字是偶数，我们需要输出它后面的奇数（即如果是 72，则输出 72 换行，然后输出 73）

如果数字是奇数，那么我们需要在它之前输出偶数（即如果是 99 则输出 98 新行，然后是 99）。

```
70
71
72
73
88
89 
```

等等……</p>

同样，我们的想法是我们在这个数据集中发现了噪音，因此我们需要消除它以使研究有效。感谢您的任何帮助，您可以提供。

编辑：从下面提供的解决方案中，我决定将其分解为我自己的个人学习以及可能阅读此内容的任何其他人：

```
"awk -F'[ ,]' 'NR>2{for (i=2;i<=NF;i++) if ($i<-1 || $i>1) print (NR%2==0) ? NR ORS NR + 1 : NR - 1 ORS NR; next }' file.txt 
```

首先，我们将制定一个基本算法：

```
if (cur == even)
  print cur + \n + prev 
else if (cur == odd)
  print prev + \n + cur

-F'[ ,]'   # a flag for field seperator and designating it with [ ,]

'NR>2      # The total Number of input Records seen so far. 

{for (i=2;i<=NF;i++) # for loop starting at 2, ending when greater or equal to NR

if ($i<-1 || $i>1) # when these conditions are met then 

print (NR%2==0)    # print NR modulus 2

? 

NR ORS NR + 1      # current OR next

: NR - 1 ORS NR;   # comparisons?

next }'            # now go to the next NR

file.txt           # save to file.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:19:19.873

这是一种使用方式`GNU awk`，其中一些是以前的代码：

```
awk -F'[ ,]' 'NR>2{for (i=2;i<=NF;i++) if ($i<-1 || $i>1) print (NR%2==0) ? NR ORS NR + 1 : NR - 1 ORS NR; next }' file.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T23:55:24.090

[从这个问题](https://stackoverflow.com/questions/13126577/new-to-awk-struggling-with-negative-number-formating)中获取原始代码，并放入一个测试 NR 奇偶性的条件。（奇偶性是偶数或奇数的属性，使用模运算符进行测试：％）。

```
awk -F'[ ,]' 'NR>2{for (i=2;i<=NF;i++) if ($i>=-1 || $i<=1) { if(NR%2 == 0) { print NR+1 } else { print NR-1} ; next } }' 
```

# wordpress - 从 wp 3.2 升级到 3.4.2 会破坏 tinymce 与 buddy press

> ID：13131249
> 
> 赞同：1
> 
> 时间：2012-10-29T23:41:25.813
> 
> 标签：wordpress, tinymce, buddypress

我已经浏览了我在网上找到的所有可能的解决方案，但没有一个可行。基本上，我们有带有 BuddyPress 的 Wordpress，我们使用 bp-tinymce 为可编辑的内容区域获取所见即所得。

现在 wp_tiny_mce 已弃用我认为我们不再需要 bp-tinymce 插件（基本上它欺骗了 wordpress 认为它​​应该用 wordpress tinymce 区域替换 buddypress 内容区域）并将其与 wp_editor() 内联。

这似乎（即它在该区域中放置了一个样式化的所见即所得），但没有任何必要的 javascript 被放置到页面中，因此它不作为一个。我试过了：

```
add_filter('admin_head','ShowTinyMCE');
function ShowTinyMCE() {
    // conditions here
    wp_enqueue_script( 'common' );
    wp_enqueue_script( 'jquery-color' );
    wp_print_scripts('editor');
    if (function_exists('add_thickbox')) add_thickbox();
    wp_print_scripts('media-upload');
    if (function_exists('wp_tiny_mce')) wp_tiny_mce();
    wp_admin_css();
    wp_enqueue_script('utils');
    do_action("admin_print_styles-post-php");
    do_action('admin_print_styles');
} 
```

和其他类似的代码进入主题的functions.php，但该函数永远不会被调用。我不确定这是否是因为 buddypress 阻止了它。

我怎样才能将所需的 js 放入页面中，还是我这样做完全错误？

# python - 如果输入 <1 或 >10，则尝试重新运行 skjerm()。但是当我写下提到的值时它什么也没做。使用 3.2

> ID：13131252
> 
> 赞同：1
> 
> 时间：2012-10-29T23:41:39.307
> 
> 标签：python, input

```
def skjerm():

    try:

        tall=int(input("Skriv inn et tall: "))
        if 10<tall<1:

            skjerm()
        else:
            main(tall)

    except ValueError:
        print ("Error")
        skjerm() 
```

如果输入 <1 或 >10，则尝试重新运行 skjerm()。但是当我写下提到的值时它什么也没做。使用 3.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:01:09.787

链式比较与 结合`and`，所以

```
10 < tall < 1 
```

是相同的

```
(10 < tall) and (tall < 1) 
```

这总是错误的。

试试`(10 < tall) or (tall < 1)`吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:46:26.327

如果我没有错，那么您应该使用`if 10<tall or tall<1:`代替`if 10<tall<1`，因为后者将永远是`False`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T23:46:45.340

利用：

```
if not (1 <= tall <= 10): # or < if that's really what you want
    pass # do whatever 
```

或者，您可以这样做：

```
if tall not in range(1, 11):
    pass # do something 
```

# database-design - Cassandra 数据库数据模型：批评我的架构设计

> ID：13131254
> 
> 赞同：1
> 
> 时间：2012-10-29T23:41:52.453
> 
> 标签：database-design, nosql, cassandra, database-schema

我需要为测试系统实现一个数据库。它旨在存储测试数据以供将来进行统计分析。它**必须**基于 Cassandra。

我设计了一个模式，但由于这是我第一次尝试 NoSQL 设计，我想得到一些反馈。

我将首先描述我希望保存的数据，然后描述两个基本查询，最后介绍我建议的设计。

我打算使用 Cassandra 1.1，所以我尝试在我的设计中使用 Composite Columns，但是，请随意建议超级列或任何看起来正确的东西。

## 数据：

我们正在测试的基本单位是外星人。每个外星人都有一个唯一的 ID。每个外星人都有许多身体部位。此外，每个外星人都是外星人家庭的一部分。这些家庭有唯一的名称。

当我们运行测试时，我们在外星人群体的几个身体部位上运行它。例如，我们对几个家庭进行测试，测试他们所有的眼睛和嘴巴。

有几种测试。我们使用它自己的测试唯一 ID 记录每个测试。

当我们进行测试时，我们每隔几分钟对所有相关的外星人身体部位进行采样并收集一些统计数据。

## 基本查询：

1.  每个家庭或外星人或独特的身体部位 - 它参与了哪些测试。
2.  每个测试 ID - 哪些家庭或外星人或独特的身体部位参与其中。
3.  未来，所有数据的统计分析...

## 我的设计尝试：

```
GeneralAliensData : { // Column Family  - general data on aliens. 
    [FamilyID][AlienID][Bodypart] : { //Composite Columns as Row keys
        Race: 'Blurgons' // column
        Shoesize: 5 // column
        Favorite probe: 'fun, toy' // column
    }  
}

TestsData : { // Column Family - we sample each test every couple of minutes...
    [TestID][AlienID][Bodypart][MinutesFromTestStart]: { //Composite Columns as Rowkeys
        Temperture: 30 // column
        Size: 5 // column
    }  
}

BodypartTestParticipation : { // Column Family - all the tests a unique bodypart passed...
    [FamilyID][AlienID][Bodypart]: { //Composite Columns as Row keys
        TestID: 105 // column
        TestID: 564 // column
        ...
    }  
} 
```

就是这个。由于我是数据库和特别是 Cassandra 的真正初学者，因此我将不胜感激。

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T12:29:28.313

您的数据集最终会有多大的行数？我们使用 PlayOrm 将关系数据存储在 noSQL 中，有时效果很好，表可以进入 X 百万行。如果您要进入数十亿/万亿行，那么我们使用 PlayOrm 对相同的数据进行分区，以便扩展。

那么，您需要扩展能力吗？您可能想查看宽行模式（PlayOrm 大量使用该模式）。宽行可以帮助您索引内容以进行非常快速的查找。

我真的不明白你的这部分东西

```
TestsData : { // Column Family - we sample each test every couple of minutes...
    [TestID][AlienID][Bodypart][MinutesFromTestStart]: { //Composite Columns as Rowkeys
        Temperture: 30 // column
        Size: 5 // column
    }  
} 
```

这里不应该更宽吗？其中 testid 是行键，并且您有许多其他数据的复合名称？并且宽行不应大于 1000 万列，因此请确保没有测试数据行会超过该列。所以可能是宽排

testid -> alienId:fk23=null, alienId:fk25=null, etc. 温度=30, size=5

后来，迪恩

# java - 位标志和状态

> ID：13131258
> 
> 赞同：-1
> 
> 时间：2012-10-29T23:42:24.300
> 
> 标签：java, byte, flags, bits, states

我什至不知道这叫什么，所以我真的找不到关于它的问题。

这很简单，我正在编写一个程序，我的朋友给了我一些东西。（很难解释）

它们是：0x00 0x01 和 0x04

基本上，如果布尔值不正确，我希望将 0x00 和 0x04 加在一起以生成 0004 (4)，但如果为真，则添加 0x01 和 0x04 以生成 0104 (104)

我该怎么做呢？：秒

我不确定所有的运算符，我尝试过 |、<<、>>，我所知道的一切，不知道该做什么，没有一个工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:47:27.713

```
 int falseValue = 0x00;
  int trueValue = 0x01;
  int number = 0x04;
  boolean bool = true;

  int result = ((bool ? trueValue : falseValue) << 8) | number;

  System.out.println(Integer.toHexString(result)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:46:28.050

`0x00` `0x01`并且`0x04`是十六进制数字。您正在尝试进行十六进制加法。

```
String a= Integer.tohexString(0x00);
String b = Integer.toHexString(0x01);
if(true){
    sysout(Integer.toHexString(Integer.parseint(a,16)+Integer.parseInt(b,16)));
  } 
```

# c++ - GetProcAddress() 为我的 Hello World 函数返回 null

> ID：13131261
> 
> 赞同：2
> 
> 时间：2012-10-29T23:42:42.650
> 
> 标签：c++, c, winapi, dll

好的，所以我的简单 DLL Hellow World 函数

```
#include "stdafx.h"

extern "C" void HelloWorld()
{
   MessageBox( NULL, TEXT("Hello World"), 
            TEXT("In a DLL"), MB_OK);
} 
```

没有被我简单的 hello world 应用程序调用：

```
case IDM_ABOUT:

            hinstDLL = LoadLibrary(L"phantasyhook.dll");
            if (hinstDLL != NULL)
            {
                HelloWorld = (FARPROC) GetProcAddress(hinstDLL, "HelloWorld");

                if (HelloWorld != NULL)
                    HelloWorld();

                else
                    MessageBox(NULL, L"is null", L"dll Error", MB_OK);

                FreeLibrary(hinstDLL);
            }

            break; 
```

它打开“为空”消息框，认为它应该打开 Hello World 之一。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T23:46:12.017

您需要标记一个函数应该由 DLL 导出，以便其他代码能够加载它。您可以通过添加 [__declspec(dllexport)](http://msdn.microsoft.com/en-us/library/a90k134d%28v=vs.80%29.aspx)或[模块定义文件](http://msdn.microsoft.com/en-us/library/28d6s79h%28v=vs.80%29.aspx)来完成。

```
extern "C" __declspec(dllexport) void HelloWorld() 
```

# javascript - DOJO 1.8 移动小部件未在屏幕上呈现

> ID：13131263
> 
> 赞同：1
> 
> 时间：2012-10-29T23:42:46.300
> 
> 标签：javascript, listview, mobile, dojo

我对 DOJO 小部件 "dojox/mobile/_DataListMixin" 有疑问。基本上，我在我的 html 中定义了小部件，如下所示：

`<ul data-dojo-type="dojox.mobile._DataListMixin" id="meetingul"> </ul>`

我的目标是将列表项小部件放入其中`<ul>`。我必须这样做的javascript是这样的。`

```
require(["dojox/mobile/parser",
     "dijit/registry",
     "dojo/request",
     "dojox/mobile/_DataListMixin",
     "dojox/mobile/_DataMixin",
     "dojo/_base/array",
     "dojo/store/Memory",
     "dojox/mobile",
     "dojox/mobile/ScrollableView",
     "dojox/mobile/DatePicker",
     "dojox/mobile/Button",
     "dojox/mobile/TabBar",
     "dojox/mobile/compat"
     ],
function(parser, registry, request,DataListMixin,DataMixin,basearray,store) {
    // Parse the page for widgets!
    parser.parse();

    gotoToday = function(){
    registry.byId("dpw").reset();
        }
showSelectedValue = function(){
        var w = registry.byId("dpw");
        //console.log(w);
        var d = w.get("value");
 // var d =  w.slots[0].get("value")+ "-" + w.slots[1].get("value") + "-" + w.slots[2].get("value"); //gets same value as above line but "OCT" instead of 11
      return d;
    }
    fillMeetings = function(){
        var date = registry.byId("dpw");
        var meetingdes = document.getElementById("meetingdescription");
        var meetingul = document.getElementById("meetingul");
        //registry.byId("meetings").innerHTML  =  showSelectedValue();
        var sqldate = {sqldate:showSelectedValue()};

        var deferred = request.post("resources/meetingsarray.php",
            {data:sqldate,
            handleAs: "json"});

        deferred.then(function(res){
            console.log(res);
               var meetingul = registry.byId("meetingul");
               var meetingsview = registry.byId("meetings");
               var memstore = new store({data:res});
               var memdata = memstore.data;
               console.log(memstore);
                 // datamixin.setStore(memstore);

                onComplete:{
                        meetingul =  DataListMixin(DataMixin(memstore), request);
                            }

        },
          function(error){
                    console.log("An error occurred: " + error);
                });
    }
    });

       </script> ` 
```

该`memstore`变量正在以 JSON 格式获取我想要的正确数据，但它没有`ul`像我想要的那样填充。没有错误，我只是觉得我缺少一些基本的东西。如果您有任何建议，请回复，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T07:43:55.243

我看不出这条线是如何工作的

```
 meetingul =  DataListMixin(DataMixin(memstore), request); 
```

您只是简单地为变量赋值，这样做不会影响列表中的内容。

我有这种代码：

```
 var meetingul = registry.byId("meetingul");

  var store = new Memory({ 
    data : mydata
  });

  meetingul.setStore(store); 
```

# jquery - 响应式设计：如何在桌面浏览器的模式窗口中打开链接，而不是在移动设备上？

> ID：13131264
> 
> 赞同：1
> 
> 时间：2012-10-29T23:42:53.300
> 
> 标签：jquery, css, modal-dialog, responsive-design, media-queries

我有一些链接要在桌面用户的模式窗口中打开，而不是在移动用户的模式窗口中打开（通过 CSS 类和 jQuery 事件侦听器启动的模式窗口）。该站点正在使用媒体查询运行响应式主题，因此我试图弄清楚如何处理不同屏幕尺寸的不同行为（假设每种屏幕尺寸中使用的设备类型）。

我现在已经设置了 2 个不同的链接。每个屏幕尺寸只显示其中 1 个链接，我假设更大的屏幕尺寸将使用模态窗口链接。当媒体查询返回较小的尺寸时，我会隐藏模式窗口链接并显示指向所需页面的标准链接。

似乎必须有更好的方法来做到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:40:34.517

如果我理解正确，你需要一个锚来根据屏幕尺寸做不同的事情（另一种检测移动设备并避免桌面小窗口的方法是根据尺寸和像素比进行媒体查询）。

我用这种方法看到的问题是（假设您有两个选项，并且只是根据 css 媒体查询显示/隐藏正确的选项）您在代码中重复内容，这对可访问性不是很好。

为什么不通过 jquery 来做呢？您可以检测视口大小并为链接提供足够的功能。例如，您的默认链接除了重定向到新地址之外没有任何特定操作。但是，如果视口大于 x，则您将链接的内容编写为不同的（添加一个类以打开模式左右）。

# c++ - 结构数组似乎不想工作

> ID：13131267
> 
> 赞同：1
> 
> 时间：2012-10-29T23:43:31.567
> 
> 标签：c++, arrays, struct

我有这个类和结构，并且数组上的每个结构都连接到另一个结构（数组的每个元素上的链表结构）..顺便说一句，这只是我的代码示例，假设没有其他错误..

```
class DATA;
class myclass
{
     public:
         myclass();

         mystruct* addDATA(DATA *d);

     private:
         mystruct* array;
};
struct mystruct
{
    DATA     * data;
    mystruct * next ;

}; 
```

在构造函数中我正在尝试这个

```
 mystruct::mystruct()
 {
     mystruct* array = new mystruct[10];
     for(int i = 0; i < 10; i++)
         array[i] = NULL; 
 } 
```

这给出了一个意想不到的（至少对我来说）错误，这个错误是不是有点荒谬，我正在制作指向 NULL 的指针。

```
no match for ‘operator=’ in ‘*(array + ((unsigned int)(((unsigned int)i) * 8u))) = 0’ 
```

当我尝试这样做时；

```
while(this->array[i] != NULL){
    // do some arrangements on the array..

} 
```

这也给出了同样的错误..为什么匹配指向 NULL 的指针会给出这个错误，或者检查它是否为 NULL..从今天早上开始苦苦挣扎，找不到*** *ing 解决方案：/数组的类型是“mystruct”但没有别的，这是一个问题吗？或者 array[i] 不是指针什么的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:48:02.057

您有一个`mystruct`s 数组，而不是指向 的指针数组`mystruct`。如果您真的想要一个指针数组，请像这样分配它：

```
mystruct** array = new mystruct*[10]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T23:48:36.417

不，您不是在制作指针数组，而是在制作结构数组。的每个元素`array`都是 a`mystruct`不是 a `mystruct*`。`mystruct`将 a 设置为 null没有任何意义。

# javascript - 如何在这个 jquery 插件中包含一个公共可访问的函数

> ID：13131270
> 
> 赞同：1
> 
> 时间：2012-10-29T23:43:38.753
> 
> 标签：javascript, jquery, function

我正在寻找一种在插件中包含公共可访问函数的方法，但我仍在学习 jQuery/javascript，所以我无法让它正常工作。我想访问插件中的一些代码，在此示例中，该函数称为 someFunc。那么我该怎么做，最好的方法是什么？

它应该类似于 $.pluggg.validation()。

// 我的插件包装器

```
 ;(function($, window, document, undefined){
        $.fn.pluggg = function(options) { 

            options = $.extend({}, $.fn.pluggg.options, options);    

                return this.each(function() {  

                    var obj = $(this);

                    function someFunc(){
                        alert(options.label);
                    }

                });

            };

            $.fn.pluggg.options = {
                label: 'yeahhhhh'
            };

    })(jQuery, window, document); 
```

# iphone - xcode错误：masterViewController没有可见的@interface声明选择器

> ID：13131272
> 
> 赞同：3
> 
> 时间：2012-10-29T23:43:59.680
> 
> 标签：iphone, objective-c, ios, xcode, class

我遇到了一个似乎相当普遍的问题，但我无法具体弄清楚我的代码有什么问题。

我已经搜索了 stackoverflow 并阅读了至少十几篇与我相似的帖子，但我无法弄清楚我的个人问题。

基本上，我试图将 NSMutableDictionary 从模式视图传递到主视图。这是代码：

QuoteMasterViewController.h：

```
 @class QuoteModalViewController;
    @interface QuoteMasterViewController : UITableViewController
    @end 
```

QuoteMasterViewController.m:

```
#import "QuoteMasterViewController.h"
#import "QuoteModalViewController.h"
#import "QuoteDetailViewController.h"

@interface QuoteMasterViewController () {
    NSMutableArray *_objects;
    }
@end

@implementation QuoteMasterViewController

//after the ViewDidLoad method...

-(void)addQuotationWithDictionary: (NSMutableDictionary *)myDictionary {

     [self insertNewObject:myDictionary];
     [self dismissModalViewControllerAnimated:YES];
 } 
```

QuoteModalViewController.h：

```
 #import <UIKit/UIKit.h>

 @class QuoteMasterViewController;

 @interface QuoteModalViewController : UIViewController <UITextFieldDelegate>

 @property (nonatomic, weak) QuoteMasterViewController *masterView;
 @property (strong, nonatomic) IBOutlet UITextField *sourceQuoted;
 @property (strong, nonatomic) IBOutlet UITextField *quoteQuoted;
 - (IBAction)saveButtonPressed:(id)sender;
 - (IBAction)cancelButtonPressed:(id)sender;

 @end 
```

QuoteModalViewController.m:

```
#import "QuoteModalViewController.h"
#import "QuoteMasterViewController.h"

@interface QuoteModalViewController ()

@end

@implementation QuoteModalViewController

@synthesize sourceQuoted;
@synthesize quoteQuoted;
@synthesize masterView;

//After ViewDidLoad
- (IBAction)saveButtonPressed:(id)sender {
    if (![sourceQuoted.text isEqualToString:@""] && ![quoteQuoted.text isEqualToString:@""]) {
        NSString *sourceString = sourceQuoted.text;
        NSString *quoteString = quoteQuoted.text;
        NSMutableDictionary *quotesDict = [[NSMutableDictionary alloc] initWithObjectsAndKeys: sourceString, @"Source", quoteString, @"Quote", nil];
        [masterView addQuotationWithDictionary:quotesDict]; //Error occurs here
        NSLog(@"%@", quotesDict);
    }
} 
```

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T23:55:38.427

您没有在头文件中声明您的方法。添加

```
-(void)addQuotationWithDictionary: (NSMutableDictionary *)myDictionary; 
```

`@interface QuoteMasterViewController`到和之间的 QuoteMasterViewController.h 文件`@end`。

# tridion - 获取组件的根发布

> ID：13131273
> 
> 赞同：5
> 
> 时间：2012-10-29T23:44:10.023
> 
> 标签：tridion, tridion-2011

让我们假设这个问题有以下出版物。

20 内容 -> tcm:0-20-1

…</p>

…</p>

…</p>

70 网络 -> 中医：0-121-1

我在 ( **20 Content** ) 出版物下创建了一个组件，并且我正在从其中一个子出版物 ( **70 Web** ) 发布该组件。我正在使用 Dreamweaver 模板编写 UI，并且正在从 DWT 调用 C# 自定义函数。发布时，该组件在组件表示中将被称为 121-432。有没有办法获得组件创建位置的根发布？那就是我应该得到 20-432，而不是得到 121-432。

我试过*Component* .GetBluePrintChain() ，它返回一个包含所有蓝图层次结构的列表。我可以从此列表中获取第一项，以获取该组件及其实际创建的出版物。

由于我必须在很多地方调用这个方法，我只是想检查是否有任何其他直接/更好的方法来完成这项工作。

任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T01:06:08.790

您需要查看`OwningRepository`Component 的属性，因此：

```
var componentIdInOwningPublication = new TcmUri(
    component.Id.ItemId,
    ItemType.Component,
    component.OwningRepository.Id.ItemId
); 
```

把它放到一个自定义的 Dreamweaver 可调用函数中，你应该很高兴。

***更新*** 还有一个称为帮助方法`CreateTcmUriForPublication`的翻译。所以你也可以像这样调用那个：

```
var componentIdInOwningPublication = TemplateUtilities.CreateTcmUriForPublication(
    component.OwningRepository.Id.ItemId,
    component.Id
); 
```

不过，这两个片段的最终结果是相同的：组件的 TcmUri 在其拥有的存储库的上下文中。

# javascript - Python Flask 中的自定义文件夹

> ID：13131276
> 
> 赞同：0
> 
> 时间：2012-10-29T23:44:47.400
> 
> 标签：javascript, python, web-services, flask

所以我想在我的 html 页面中包含一些 js 和 css 文件，flask 提供但希望它们在 /js/ 和 /cs/ 中，而不是所有在 /static/ 中。

我尝试[在本地 Flask 实例中执行多个静态路径](https://stackoverflow.com/questions/9513072/more-than-one-static-path-in-local-flask-instance)

使用：

（部分随机命名的cat.html）

```
<link rel="stylesheet" href="{{url_for('css_static',filename='bootstrap.min.css')}}">        
<link rel="stylesheet" href="/static/css/bootstrap-responsive.min.css">  
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/prettify.css"> 
```

和

（app.py 的一部分）

```
@app.route('/sigma')
def sig():
        return render_template('cat.html')

@app.route('/css/<path:fn>')
def css_static(fn):
        return send_from_directory('/css/',fn)

@app.route('/js/<path:fn>')
def js_static(fn):
        return send_from_directory(app.config['JS_STATIC'],fn) 
```

* * *

当我尝试这个时它不起作用（`/cat.html`）显示内部服务器错误。

当我去`/css/bootstrap-responsive.min.css`加载它永远......

那我做错了什么？

编辑：似乎唯一打开的目录是`/static/...`我不知道为什么，因为我有一条`/js/`路线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T05:50:36.350

我认为您不需要为此定义路线。只需将“js”和“css”目录放在静态目录中即可。

这就是我所做的：

```
<link rel="stylesheet" href="{{ config["APP_URL"] }}/static/css/style.css"> 
```

用您的域替换应用程序 url 部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-19T12:03:14.827

你可以这样做：

```
from flask import Flask, render_template, send_from_directory

app = Flask(__name__)

@app.route("/")
def Home_page():
    return render_template("index.html")

@app.route('/images/<filename>')
def images_folder(filename):  
    return send_from_directory('images', filename)

@app.route('/css/<filename>')
def css_folder(filename):  
    return send_from_directory('css', filename)

@app.route('/js/<filename>')
def js_folder(filename):  
    return send_from_directory('js', filename)

if __name__ == "__main__":
    app.run(debug=True) 
```

如果你想下载所有文件：[点击这里](https://drive.google.com/file/d/1ZRaMJO7xvcf51v5m5Ay7B9rSuOZ3uYbg/view?usp=sharing)

# ios - 对 glDrawElements 的多次调用是否比在 GLSL 中对每个片段执行相同的计算更有效？

> ID：13131279
> 
> 赞同：3
> 
> 时间：2012-10-29T23:45:26.860
> 
> 标签：ios, opengl-es, glsl

我正在尝试使用 GLSL（在 iOS 中），并且我编写了一个简单的着色器，它采用颜色值和两个圆（`center`、`radius`和`edgeSmoothing`）的参数。它是在整个屏幕上使用单个四边形绘制的，着色器使用`gl_FragCoord`并确定每个点是在圆圈内还是在圆圈外 - 它计算圆圈内的 alpha 为 1.0，平滑地着色到外部 0.0 `radius + edgeSmoothing`，然后应用镜像 -将样式钳位到 alpha（三角波以获得奇偶填充规则效果）并设置`gl_FragColor = mix(vec4(0.0), color, alpha);`.

这很好用，但我想要 5 种不同颜色的 10 个圆圈，所以我调用`glUniform`所有着色器制服并`glDrawElements`分别绘制四边形五次（使用不同的颜色和圆圈参数），并且我的混合模式是相加的，因此不同的颜色相加很好地给出我想要的图案，完美！

请记住，这是一个实验，所以我试图了解 GL 和 GLSL 而不是画圆圈。

现在我认为只绘制一次四边形并将所有 10 个圆的参数传递到统一数组（`centers[10]`、`radii[10]`等）中，在 GLSL 中循环它们并将它们在着色器中产生的颜色相加会更有效. 所以我编写了这个着色器并重构了我的代码以一次传递所有的圆形参数。我得到了正确的结果（输出看起来完全一样），但我的帧速率从 15fps 下降到大约 3fps - 它慢了五倍！

着色器代码现在有循环，但使用相同的数学计算每对圆的 alpha 值。为什么这么慢？当然，我所做的工作比填充整个屏幕五次而 GL 进行五次加法混合（即读取像素值、混合和写回）要少吗？现在我只是计算累积的颜色并填充整个屏幕一次？

谁能解释为什么我认为的优化会产生相反的效果？

**更新：**将此代码粘贴到[ShaderToy](https://www.shadertoy.com/new)以查看我在说什么。

```
#ifdef GL_ES
precision highp float;
#endif

uniform float time;

void main(void)
{
    float r, d2, a0, a1, a2;
    vec2 pos, mid, offset;
    vec4 bg, fg;

    bg = vec4(.20, .20, .40, 1.0);
    fg = vec4(.90, .50, .10, 1.0);
    mid = vec2(256.0, 192.0);

    // Circle 0
    pos = gl_FragCoord.xy - mid;
    d2 = dot(pos, pos);
    r = 160.0;
    a0 = smoothstep(r * r, (r + 1.0) * (r + 1.0), d2);

    // Circle 1
    offset = vec2(110.0 * sin(iGlobalTime*0.8), 110.0 * cos(iGlobalTime));
    pos = gl_FragCoord.xy - mid + offset;
    d2 = dot(pos, pos);
    r = 80.0;
    a1 = smoothstep(r * r, (r + 1.0) * (r + 1.0), d2);

    // Circle 2
    offset = vec2(100.0 * sin(iGlobalTime*1.1), -100.0 * cos(iGlobalTime*0.7));
    pos = gl_FragCoord.xy - mid + offset;
    d2 = dot(pos, pos);
    r = 80.0;
    a2 = smoothstep(r * r, (r + 1.0) * (r + 1.0), d2);

    // Calculate the final alpha
    float a = a0 + a1 + a2;
    a = abs(mod(a, 2.0) - 1.0);

    gl_FragColor = mix(bg, fg, a);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T03:47:31.177

增加片段着色器中操作的复杂性会对渲染时间产生非线性影响。在某些情况下，即使添加一个看起来很简单的分支操作也会使着色器慢 10 倍。

在 iOS 设备上的片段着色器中，循环尤其可怕，所以我会不惜一切代价避免它们。我敢打赌，如果您将该循环展开为针对您的统一值的一系列检查，它会执行得更好。

然而，对你的制服运行 10 次检查，这听起来像是涉及步骤或平滑步骤，当应用于帧缓冲区中的每个像素时将非常昂贵。这也相当浪费，因为屏幕的很大一部分不会被任何特定的圆圈覆盖。

无需使用单独的`glDrawElements()`调用来绘制单独的圆圈，或者通过绘制屏幕大小的四边形来绘制。[我在这个答案](https://stackoverflow.com/questions/10488086/drawing-a-sphere-in-opengl-es/10506172#10506172)中描述了我用来在我的开源应用程序中绘制球体冒名顶替者的过程，我可以在最新的 iOS 设备上以 60 FPS 的速度在屏幕上绘制数千个圆圈（球体）。为此，我为每个足够大的圆圈传入一个四边形，该圆圈包含该圆圈并且不大于该圆圈。这些四边形都聚集在一个数组中并立即绘制。每个圆的附加参数作为属性与顶点数据一起传入。例如，我不需要指定半径，因为我在顶点旁边使用从 (-1, -1) 到 (1, 1) 的冒名顶替空间坐标，并进行简单的计算以确定一个点是否在圆内。

如果您只绘制每个圆圈所需的片段，而不是更多，您将减轻管道片段处理部分的大量负载。您仍然需要启用混合模式，但是四边形大小的减小，加上片段着色器中执行的操作的简化，将带来更好的整体性能。

# ios - 以编程方式切换视图

> ID：13131283
> 
> 赞同：0
> 
> 时间：2012-10-29T23:46:02.760
> 
> 标签：ios, uiview, tableview, viewcontroller

我在 IB 中设置了一些视图控制器。一个具有大约 6 个单元格（以编程方式填充）的 TableView。然后还有 6 个视图控制器（每个单元格一个）。

我想让它在我的

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

} 
```

我可以将视图切换到与单击的单元格相关的任何视图。

因此，如果他们单击单元格1，则转到视图1，如果单击单元格2，则转到视图2。

顺便说一句，这就是我初始化表的方式，它工作正常。

```
//tableview datasource delegate methods
-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return 1;
}
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return showArray.count;
}
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

static NSString *CellIdentifier = @"Cell";

CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];

if(cell == nil){
    cell = [[CustomCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

cell.showLabel.text = [showArray objectAtIndex:indexPath.row];
cell.image.image = [UIImage imageNamed:[imageArray objectAtIndex:indexPath.row]];
cell.seasonLabel.text = [seasonArray objectAtIndex:indexPath.row];

return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
return 106;
}
- (void)insertRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:    (UITableViewRowAnimation)animation{

NSIndexPath *newCellPath = [NSIndexPath indexPathForRow:showArray.count
                                              inSection:0];

[self.theatreView insertRowsAtIndexPaths:@[newCellPath]
                        withRowAnimation:UITableViewRowAnimationFade];

}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T04:00:35.050

我不知道你的应用程序的结构，但我认为你可以考虑这个：

```
- (UIViewController *)getViewControllerAtIndexPath:(NSIndexPath *)indexPath {
    //..you can use "switch" to return the view controller you want
    return ...;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIViewController *controller = [self getViewControllerAtIndexPath:indexPath];
    //..push or present your controller
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:54:03.557

我会根据您的应用程序的结构建议这两种方法中的一种。

```
[self.navigationController pushViewController:newViewController animated:YES];

[self presentModalViewController:newViewController animated:YES];

//for ios 6.0
[self presentViewController:newViewController animated:animated completion:NULL]; 
```

据我所知，您在主菜单的 .xib 文件中创建了很多 uiviewcontrollers。那是对的吗？所以你将拥有 self.theatreViewController。然后，您可以将其作为按钮回调中的参数传递。例如

```
[self presentViewController:self.theatreViewController animated:animated completion:NULL]; 
```

如果我在这里的假设有误，请纠正我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T04:18:25.323

在这个方法中使用**索引路径**属性： (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath

喜欢

yourObject = [yourArray objectAtIndex:indexPath];

编辑：-在您的 AppDelegate 中，使用以下方法，执行以下操作：-

```
-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

{  

  self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
// Override point for customization after application launch.

  mHomeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil];
  UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:mHomeViewController];
  [mHomeViewController release];

  self.window.rootViewController = navController;
  self.window.backgroundColor = [UIColor whiteColor];
  [self.window makeKeyAndVisible];
  [navController release];
  return YES;
} 
```

现在，在您的 viewController - didSelectRowMethod 中，执行以下操作：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString * object = [yourArray objectAtIndex:indexPath.row];

    [self.tableView deselectRowAtIndexPath:indexPath animated:YES];

    if(newControllerInstance == nil) // check if it's nil, then initialize and alloc it.
   {
      newControllerInstance = [[NewViewController alloc] initWithNibName:@"NewViewController" bundle:nil];
      [self.navigationController newControllerInstance animated:YES];
      [newControllerInstance release];
   }
} 
```

这应该有效。

# sql - SQL - 根据 ID 删除具有多个唯一日期的行

> ID：13131288
> 
> 赞同：2
> 
> 时间：2012-10-29T23:46:40.180
> 
> 标签：sql

我试图只保留 ID 具有单个销售日期的行，例如。

**ID SALES_DTE**
101 10-Jan-12
101 10-Jan-12
101 10-Jan-12
102 10-Jan-12
102 13-Jan-12
103 13-Jan-12

在上面，我想保留 ID 101 和 103，因为它们只有一个销售日期。但我不想要 102，因为它有两个销售日期。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:50:00.330

```
delete from your_table
where id not in 
(
   select id
   from your_table
   group by id
   having count(distinct sales_date) = 1
) 
```

# objective-c - NSString 与 NSInteger

> ID：13131291
> 
> 赞同：-3
> 
> 时间：2012-10-29T23:46:54.233
> 
> 标签：objective-c, macos, nsstring, int, nsinteger

如何将我的 NSInteger 放入我的 NSString stringWithFormat：

我的代码：

```
-(IBAction)main:(id)sender
{
NSAppleScript *script = [[NSAppleScript alloc] initWithSource:@"return the clipboard"];

NSAppleEventDescriptor *clipboardTXT = [[script executeAndReturnError:nil]stringValue];

NSInteger *length = [clipboardTXT.stringValue length];

NSString *mystring = [NSString stringWithFormat:@"%", length];

[mybutton setTitle:mystring];
} 
```

ps 我试过[这个](https://stackoverflow.com/questions/9404201/casting-nsinteger-into-nsstring?rq=1)，但它对我不起作用。

[输出](http://cl.ly/KWNP)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:48:09.963

使用说明`%d`符。

```
- (IBAction)main:(id)sender
{
    NSAppleScript *script = [[NSAppleScript alloc] initWithSource:@"return the clipboard"];

    NSAppleEventDescriptor *clipboardTXT = [script executeAndReturnError:nil];

    NSInteger length = [[clipboardTXT stringValue] length];

    NSString *mystring = [NSString stringWithFormat:@"%d", length];

    [mybutton setTitle:mystring];
} 
```

**编辑：**

您的问题与您所要求的完全不同。为什么第一次没有包含错误消息？浪费时间的人...

它显然指出问题必须在您的`stringValue`电话周围的某个地方。如果你用谷歌搜索过，你肯定会发现这个错误消息意味着你发送`stringValue`到的对象没有这样的方法。`executeAndReturnError`返回一个`NSAppleEventDescriptor`实例。然后你调用`stringValue`which 将返回一个`NSString`，而不是一个`NSAppleEventDescriptor`。之后，您将`stringValue`消息发送到`NSString`（它没有这样的方法）。请参阅我编辑的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T23:56:00.763

两件事，你想使用说明`%d`符，你需要`*`在你的长度声明中删除

```
NSInteger length = [clipboardTXT.stringValue length];
NSString *mystring = [NSString stringWithFormat:@"%d", length]; 
```

# facebook - Facebook 身份验证和 HTTPS - 域、端口、协议必须匹配

> ID：13131292
> 
> 赞同：4
> 
> 时间：2012-10-29T23:47:01.163
> 
> 标签：facebook, facebook-authentication

自从切换到 HTTPS 后，我的网站似乎出现了问题。

如果用户在购物车中添加了一些东西，并且在结帐页面上并且 - 已经登录到 Facebook - 已经获得了应用程序的授权

单击 Facebook 登录按钮将起作用 - 没问题。

如果用户在购物车中添加了一些东西，并且在结帐页面上并且 - 尚未登录 Facebook - 之前已获得该应用程序的授权

单击 Facebook 登录按钮将打开弹出窗口，提示他们的登录详细信息。成功登录 FB 后（通过打开新的浏览器窗口进行检查）-我在控制台中收到此错误-我猜这就是阻止它工作的原因。

注意 - 这在 http..

不安全的 JavaScript 尝试使用 URL [https://www.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=115551305199328&redirect_uri=https%3A%2F%2Fs-static.ak.facebook.com%2Fconnect%访问框架2Fxd_arbiter.php%3Fversion%3D11%23cb%3Df368597038%26origin%3Dhttps%253A%252F%252Fwww.iloveugly.net%252Ff21427b398%26domain%3Dwww.iloveugly.net%26relation%3Dopener%26frame%3Df280a%26frame%3Df280a%26frame%3Df280a%26frame%3Df280a%26frame%3Df280a=dopentype=3e 2Csigned_request&domain=www.iloveugly.net&perms=publish_stream%2Cuser_likes&fbconnect=1&from_login=1&client_id=115551305199328](https://www.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=115551305199328&redirect_uri=https%3A%2F%2Fs-static.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D11%23cb%3Df368597038%26origin%3Dhttps%253A%252F%252Fwww.iloveugly.net%252Ff21427b398%26domain%3Dwww.iloveugly.net%26relation%3Dopener%26frame%3Df280a13e4&sdk=joey&display=popup&response_type=token%2Csigned_request&domain=www.iloveugly.net&perms=publish_stream%2Cuser_likes&fbconnect=1&from_login=1&client_id=115551305199328)来自带有 URL [https://www.iloveugly.net/View-your-cart-content.html?page=shop.cart](https://www.iloveugly.net/View-your-cart-content.html?page=shop.cart)的框架。域、协议和端口必须匹配。

来自脚本 connect.facebook.net/en_GB/all.js:78

网站：

万维网。我爱丑。网

facebook 应用程序设置的域为 www.domain.net，应用程序 URL 为 https://

**问题：**为什么我会收到此错误，我该如何解决？我在哪里可以看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T14:15:49.720

检查您如何设置成功登录重定向。他们还应该指向 https。

# symfony-1.4 - 如何使用 symfony sfTestFunctional 测试带有 ajax 注入的网页？

> ID：13131293
> 
> 赞同：1
> 
> 时间：2012-10-29T23:47:03.537
> 
> 标签：symfony-1.4, functional-testing

我有一个带有超链接 (linkA) 的网页 (pageA)，当单击它时，会进行 ajax 调用以检索一些 html (pageB) 并动态地将链接 (linkB) 添加到 pageA。我希望我的功能测试点击链接 A，然后在创建链接 B 时点击它。

我遇到的问题是，当我让 sfBrowser 单击链接 A 时，响应对象仅包含 pageB，我不知道如何告诉 sfBrowser 单击链接 B。

```
$browser = new sfTestFunctional(new sfBrowser());
$browser->
  get('pageA')->
  with('response')->begin()->
    click('linkA')->
  end()->

  with('response')->begin()->
    click('linkB')->   // I want to do this but I can't because the response is only pageB.
  end(); 
```

有没有办法“退出”到pageA？

# php - Magento 不重建产品缩略图缓存？

> ID：13131296
> 
> 赞同：0
> 
> 时间：2012-10-29T23:47:24.470
> 
> 标签：php, magento, caching, image-resizing

好的，所以我实现了一个adaptiveResize 模块（https://github.com/wearefarm/magento-adaptive-resize）。我想我已经正确安装了。

我实际上在我的网站上使用大型“缩略图”作为产品图片，因为这似乎是为每个产品获取多个图片的最简单方法。所以改变产品图像我正在改变缩略图。

好的，所以我去 app/design/frontend/base/default/template/catalog/product/view/media.phtml 并将缩略图的调整大小功能更改为adaptiveResize。但是现在所有这些图像都作为默认的 Magento 占位符加载。嘘。改回常规调整大小可以解决问题。

我重命名了 media/catalog/product/cache 以强制站点创建一个新的缓存文件夹。它已经这样做了，但在其内部创建了一个图像和 small_image 文件夹，但没有缩略图文件夹。

我的 .htaccess 文件的内存限制设置为 512M。我似乎没有 php.ini 文件（或者我不知道它在哪里......）但是有一个 php.ini.sample，它的内存也设置为 512M。

有任何想法吗？照片是不是太大了？

网站位于 cart.oldfloridian.com。实施此模块后，类别图像也会起作用（http://learntipsandtricks.com/blog/magento/121/How-to-resize-Magento-e-Commerce-category-images） - 可能是相同的缓存问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T15:05:58.290

我刚刚安装并且工作正常，确保您的 media/* 是 777，然后转到管理面板中的 magento 缓存，然后单击刷新目录图像缓存

它看起来像权限问题。

然后

```
echo $this->helper('catalog/image')->init($_product, 'small_image')->adaptiveResize(250,380); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-14T03:08:55.310

确保安装了 PHP "GD" 图形模块。Magento 使用它来创建缩略图。输入你的外壳：

```
php5 -m 
```

查看 gd 是否在列表中。如果不是，请安装它并通过在 shell 中键入以下内容来重新启动 apache：

```
sudo apt-get install php5-gd
sudo apachectl restart 
```

[此链接有更全面的说明](http://www.cyberciti.biz/faq/ubuntu-linux-install-or-add-php-gd-support-to-apache/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-03T09:35:21.163

Flakerim 关于刷新目录图像缓存是正确的，但也忽略了刷新浏览器缓存。这对我有用。

您不必小心 var/ 中的任何文件夹，因此您始终可以安全地运行

```
rm -Rf var/cache/* var/generation/* 
```

# c++ - 将 SYSTEMTIME 转换为 LPCWSTR

> ID：13131299
> 
> 赞同：1
> 
> 时间：2012-10-29T23:47:32.803
> 
> 标签：c++

> **可能重复：**
> [是否有类似 asctime_s() 的函数适用于 Windows 中的 SYSTEMTIME 结构？](https://stackoverflow.com/questions/3121734/is-there-a-function-like-asctime-s-that-works-for-systemtime-structures-in-win)

我需要将类型转换为`SYSTEMTIME`字符串。然后将字符串产品附加到另一个字符串上。然后最后将最终的字符串转换为类型`LPCWSTR`

的所有属性`SYSTEMTIME`都是`WORD`类型。

我想我需要将`WORD`类型转换为`wchar_t`类型，然后将它们连接起来以获取 SYSTEMTIME 的字符串。我该如何进行这种转换和连接？

一旦构建了最终字符串，如何从中创建`LPCWSTR`类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T23:50:59.160

如果您需要支持 Windows XP 以将 SYSTEM 时间格式化为字符串，请使用[`GetTimeFormatEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318131%28v=vs.85%29.aspx)or 。[`GetTimeFormat`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318130%28v=vs.85%29.aspx)

# html - 如何将 img 和 text 放在这样的 div 框中？

> ID：13131300
> 
> 赞同：0
> 
> 时间：2012-10-29T23:47:41.287
> 
> 标签：html, css

我有一个看起来像这样的 div 框：

```
.productholder
{
width: 954px;
margin-left: 175px;
margin-bottom: 30px;
background-color: white; 
border-style:solid;
border-width: 1px;
border-color: #d2d2d2;

/* gradients */
background: -webkit-gradient(linear, left top, left bottom, 
color-stop(0%, white), color-stop(50%, white), color-stop(170%, #f6f6f6)); 
background: -moz-linear-gradient(top, white 0%, white 55%, #f6f6f6 150%); 
} 
```

我正在尝试获取文本和 img 的结构，例如此示例图片：

![分箱](../Images/68ff05e28745cfddaca6c61ac7fe712e.png)

但我似乎不能完全像图片一样，任何形式的帮助都将不胜感激如何让我的盒子看起来像这个示例图片。

到目前为止，我已经尝试过：

```
<div class="productholder">  
  <img src="url" alt="" />
  <h2>Titletext</h2> 
  <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer mi. Vivamu. etc</p>       
  <input type="submit" value="More">
  <p>$599</p>
  <input type="submit" value="Buy">                                    
</div>

img{
float:left;
}

h2{
float:left;
font-size: 14px;
} 
```

任何形式的帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T23:59:47.700

这是一个想法 - [**DEMO**](http://jsfiddle.net/aWQ6q/)

***HTML***

```
<div class="productholder">  
    <img src="http://lorempixel.com/100/100" alt="" />

    <div class="productinfo">
        <h2>Titletext</h2> 
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer mi. Vivamu. etc</p>       
        <input type="submit" value="More">
    </div>

    <div class="productprice">
        <h2>$599</h2>
        <input type="submit" value="Buy">
    </div>        
</div>​ 
```

***CSS***

```
.productholder {
    width: 954px;
    margin-bottom: 30px;
    background-color: white; 
    border-style:solid;
    border-width: 1px;
    border-color: #d2d2d2;

    /* gradients */
    background: -webkit-gradient(linear, left top, left bottom, 
    color-stop(0%, white), color-stop(50%, white), color-stop(170%, #f6f6f6)); 
    background: -moz-linear-gradient(top, white 0%, white 55%, #f6f6f6 150%); 
}

.productholder img {
    display: inline-block;
    margin: 20px;
}

.productinfo {
    border: 1px solid #ccc;
    display: inline-block;
    margin: 20px 0;
    vertical-align: top;
    width: 500px;
}

.productinfo input {
    float: right;
    margin-top: 20px;
}

.productprice {
    border: 1px solid #ccc;
    width: 150px;
    float: right;
    margin: 20px;
    text-align: center;
}
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:57:45.597

对于图像，h2 和第一个 p 执行此操作

```
.productholder{
width: 734px;
padding-left: 220px;
}
.productholder img{
float:left;
margin: 10px;
max-width: 200px;
} 
```

然后给出第二个 pa 类名称，并用`margin-right:10px;` And 作为输入向右浮动：

```
input{
position: absolute;
bottom: 5px;
right: 10px;
} 
```

这是一个粗略的草图，但它应该是正确的..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T17:15:01.943

使用简单的编码：

HTML：

```
<div class="wrapper">

    <div class="box-one">dfgdfg</div>
    <div class="box-two">dfgdfgdfgdfg</div>
    <div class="box-three">dfgdfgdfgdfg</div>
    <div class="clear"></div>

</div> 
```

CSS：

```
.clear{
    clear:both;
}

.wrapper{
    width:450px;
    background:#A4A4A4;
}

.box-one{
    float:left;
    width:80px;
}

.box-two{
    float:left;
    width:300x;
}

.box-three{
    float:right;
    width:70px;
} 
```

我把骷髅听到了。自定义css并使用它。欢呼.....

# mysql - 在 Hibernate 中使用密码（用于独立应用程序）

> ID：13131304
> 
> 赞同：2
> 
> 时间：2012-10-29T23:48:12.183
> 
> 标签：mysql, spring, swing, hibernate, password-encryption

我正在寻找有关如何在我的 Java 独立应用程序（Netbeans+Spring+Hibernate+MySQL 数据库+Swing）中处理密码字段的最佳实践。

1）我创建了一个带有密码列的表......那么，该列必须是哪种数据类型？2）您建议在我的应用程序上遵循和实施哪种 SALTing 密码算法？3）您建议将密码保存为纯文本还是根据算法转换后？4）所有这个过程的示例代码

我希望我们可以帮助许多其他必须处理 Spring 的独立应用程序以及围绕 Hibernate 处理此类问题的任务的开发人员。

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T05:34:00.897

您永远不应该将密码作为纯文本存储在您的应用程序中。不建议将其用于高度安全的应用程序。您可以使用 Spring Framework 本身提供的 PasswordEncoder 将密码以编码格式存储到数据库中。您需要在 applocationContext.xml 文件中进行以下设置。

```
<security:authentication-manager>
        <security:authentication-provider >
            <security:jdbc-user-service data-source-ref="dataSource"
              users-by-username-query="
              select  emailid username,password,'true' enabled from tbl_LoginDetails
              where emailid=?"
             authorities-by-username-query="
             select a.emailid username,b.authority from tbl_LoginDetails a,tbl_UserRoles b
            where a.userId=b.userId
            and a.emailid=?"/>
            <security:password-encoder  ref="passwordEncoder">
            </security:password-encoder>
        </security:authentication-provider>
    </security:authentication-manager>

    <bean name="passwordEncoder" class="org.springframework.security.authentication.encoding.ShaPasswordEncoder"></bean> 
```

在用户注册时，您需要自己在控制器中对密码进行编码，然后再与类一起存储在数据库中`ShaPasswordEncoder`。

希望这对您有所帮助。

# c# - 线程化串行端口查询并在 ListView 控件中使用结果

> ID：13131305
> 
> 赞同：1
> 
> 时间：2012-10-29T23:48:17.887
> 
> 标签：c#, wpf, multithreading

我有一个设备，如果我发送格式正确的字符串；我得到一个字符串。我想在 WPF ListView 控件中使用这个返回的字符串，但我无法无限地查询串行端口另一端的设备。我想每 3 秒左右刷新一次数据。
下面是应用逻辑：

```
 public static void queryDevice()
        {
            SerialPort _serialPort = new SerialPort("COM3", 115200, Parity.None, 8, StopBits.One);
            _serialPort.Handshake = Handshake.None;
            ObservableCollection<string> store= new ObservableCollection<string> { " ", " ", " " };
            string[] query = new string[3] { "t02", "t03", "t04" };
            while (true)
            {
                for (int i = 0; i < 3; i++)
                {
                    string add = SerialCom.returnData(query[i], _serialPort);//returns data depending on which query was sent
                    if (store[i] != add)
                    {
                        store.Add(add);
                    }
                }
                Thread.wait(300);

            }
        } 
```

我正在尝试找到线程化此代码的最佳方法，因为将此代码放入 UI 线程会锁定 UI 线程。我计划使用 ObservableCollection 作为该笔记上 ListView 的数据源。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T04:16:50.180

在我看来，您应该将这些代码分成两种方法并使用线程..

也许像这样

```
 public static void queryDevice()
    {
        SerialPort _serialPort = new SerialPort("COM3", 115200, Parity.None, 8, StopBits.One);
        _serialPort.Handshake = Handshake.None;
        ObservableCollection<string> store= new ObservableCollection<string> { " ", " ", " " };
        string[] query = new string[3] { "t02", "t03", "t04" };
        Thread thread = new Thread(delegate(){Process(store,query,_serialPort);});
        thread.Start();
    }

     public static void Process(ObservableCollection<string> store, string[] query, SerialPort _serialPort)
     {
         while (true)
         {
             for (int i = 0; i < 3; i++)
             {
                 string add = SerialCom.returnData(query[i], _serialPort);
                 if (store[i] != add)
                 {
                     store.Add(add);
                 }
             }
             Thread.Sleep(300);
         }
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:17:45.983

虽然在这种特殊情况下这超出了您的实际需要，但我通常将生产者/消费者模式用于此类事情。仅仅因为我知道我在做什么，线程是错误往往很容易潜入并且很难发现的事情之一。

对于 C# 实现，请查看在 C# 中[实现生产者/消费者模式](https://stackoverflow.com/questions/733793/implementing-the-producer-consumer-pattern-in-c-sharp)

在我学习时学到的所有东西中，这已被证明是最有用的；D

提示：生产者和消费者有自己的线程，消费者填充`ObservableCollection`.

免责声明：有更高效/更精简的解决方案，所以如果这是另一个解决方案的要求，那么你可能没有使用 WPF ;D

# python - python 类改变了另一个类。为什么？

> ID：13131307
> 
> 赞同：1
> 
> 时间：2012-10-29T23:48:22.953
> 
> 标签：python, class

那我怎么改A类？第一个打印：

```
{"s":1, "b":2} 
```

第二个

```
{"s":3, "b":2} 
```

但我想我应该和第一个一样

```
class A():
    def __init__(self, **kwargs):
        self.g =""

        for key, value in kwargs.items():
            setattr(self, key, value)           

class B():
    def __init__(self, classA):
        self.f = classA.g

a = A(g={"s":1, "b":2})

print (a.g)

b = B(a)
b.f["s"]=3

print (a.g) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T23:51:45.950

以下情况会发生什么：

当您实例化时`b = B(a)`，您的`B.__init__`方法设置`b.f = a.g`。

掌握这一点的更简单方法是考虑`a.g`和`b.f`作为对另一个对象（实际字典）的**引用。**这意味着它们*指向*一个对象——它们*不是*对象本身。

Doing`b.f = a.g`意味着`b.f`现在引用相同的底层对象，`a.g`仅此而已。

当您这样做时`b.f["s"]=3`，您正在*修改*引用的基础对象`b.f`。

这恰好与`a.g`引用的相同，因此`a.g`也“更改”了！

* * *

**回复您的评论：**

当你这样做时`b.f={"s":3, "b":2}`，你采取以下步骤：

1.  创建一个新字典：`{"s":3, "b":2}`
2.  修改`b.f`引用，使其现在指向这个新字典（不再与旧字典有任何关系！）

这相当于：

```
new_dict = {"s":3, "b":2}
b.f = new_dict 
```

参考 `a.g`保持不变，因此保持不变。
因此，`a.g`不再`b.f` **引用相同的底层对象**。

# html - 构建一个小部件（HTML/CSS）——表格还是 div？

> ID：13131313
> 
> 赞同：-1
> 
> 时间：2012-10-29T23:48:59.543
> 
> 标签：html, css, html-table

（有关结构和可能的内容，请参见下面的小部件图像）。所以这是交易：在我正在处理的应用程序中，有一个固定大小的小部件，内容可变。内容有 3 到 5 个“内容”容器，这些容器根据小部件的显示位置和时间而有所不同。但是，小部件本身始终具有相同的大小。

每个“容器”中的内容始终垂直和水平对齐到中心。组合（见下图）是：

*   状态容器始终存在（容器 1）
*   第二“行”有 1 个或两个容器；如果是一个，它跨越整个宽度；如果两个，每个是总数的 1/2
*   第 3 行和第 2 行一样，增加/更改也可以为空

现在——正如我所见，有两种方法可以解决这个问题：Divs 和 Table。

如果是 div，它将类似于：

```
<div outer container>
 <div container 1></div>
 <div container 2>
  <div container 2a></div>
  <div container 2b></div>
 </div> end container 2
 <div container 3>
  <div container 3a></div>
  <div container 3b></div>
 </div> end container 3
</div> end outer container 
```

如果它是一张桌子，它将是：

```
<table>
 <tr colspan=2><td>Container 1</td></tr>
 <tr><td>Container 2a</td><td>Container 2b</td></tr>
 <tr><td>Container 3a</td><td>Container 3b</td></tr>
</table> 
```

如果第二个或第三个容器只有一个“列”，请适当地应用 colspan。

在我看来，表格方法更简单，特别是在水平和垂直对象对齐方面，但我想与其他人核实，因为我知道表格往往是禁止的。不过，我实际上认为在这里使用表格是合适的，因为它实际上将表格数据显示为其内容！

想法？

[Widget 架构 http://www.5sn1.com/images/quantity_widget.png](http://www.5sn1.com/images/quantity_widget.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:07:07.157

I would advise against *going with whatever works for you*. Yes, in the short term it would be the easiest method, however, maintaining/updating the layout later on may become more difficult. I would say don't only think of the 'now', but think about the expansion or say in future if another developer would need to take over the work.

Use what works *for the site/app*. If it is most important that the site UI is 100% picture perfect, or 100% cross browser compatible, or 100% validating code. Sadly, it is usually not possible to have all three situations. Thus, use what works for the site and is maintainable.

Personally I would use a table in displaying tabular data instead of juggling around DIVs *if it made sense to do so*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:11:53.447

In my opinion either methods are fine, although if you're aiming for those widgets to be cross-browser, you'll have less headaches using tables, like in vertical alignment like you mentioned. Just keep in mind that tables for layout is bad in most cases, but even i use them when the boss calls IE 7/8 to the table.

I don't think that example is considered tabular data, generally its something like a datagrid.

Anyways, like Kolink said, its up to you, just use the method that works for you.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T23:53:38.897

使用表格进行布局通常不受欢迎，但没有真正的理由不使用它们。正如你所说，它确实使它更容易和更合乎逻辑。

总而言之，你真的应该选择适合你的。

# javascript - 通用和开放式：开发面向流程的 Web 体验的指南（使用继承）

> ID：13131315
> 
> 赞同：1
> 
> 时间：2012-10-29T23:49:51.113
> 
> 标签：javascript, inheritance, workflow, frontend

这是一个普遍的问题，所以也许将它移到堆栈交换中的其他地方是有意义的（？）

我希望获得一些关于设计一个以过程为导向**的网络体验的最佳方式的一般意见（指南？）。**这意味着客户将通过多个屏幕并根据他们的选择将看到下一个屏幕，有效地通过流程等。

根据客户选择与每个屏幕/视图交互的方式，将有几个主要的基线流程和它们的多种差异。这一事实可以导致设计遵循继承模型。

是否有任何前端、基于 java 脚本的工具和框架非常适合这个？您认为在这种情况下继承发挥了重要作用吗？如果是这样，如何？

非常感谢您的任何评论

# css - :focus selector in CSS

> ID：13131317
> 
> 赞同：0
> 
> 时间：2012-10-29T23:49:58.747
> 
> 标签：css, focus

[JSFiddle](http://jsfiddle.net/sKGyW/) (The `*:focus` rule is to illustrate which element is marked as having focus.)

What I'm wondering is why, when I click a menu item, it gets the focus... but clicking a menu item does not give it focus.

What's wrong with the CSS to make it behave this way?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:52:58.353

`focus` is generally only for elements that can receive keyboard or other input, so by this heuristic `li`s don't qualify. [This question has more about it.](https://stackoverflow.com/questions/1677990/what-is-the-difference-between-focus-and-active).

[In the specs](http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#the-user-action-pseudo-classes-hover-act), CSS doesn't explicitly define what elements can be in those states, so it's hard to come up with a set rule for what can and can't be set to `focus`.

What might work for your purposes is `active`, which [you can view here](http://jsfiddle.net/gMNzu/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:58:45.663

There is a small trick - if you want an item which not have focus anabled by default you should make it tabbable by seting its `tabindex="N"` - `N` is a number. As simple as that. if you add tabindex to your clickable items they will get focus when you click. If a tag can be tabbed it have to be able to get focus. Adding `tabindex` attribute to all nodes of the menu is very simple if you have `jQuery` loaded:

```
$(function() { 
  $('#navbar *').attr('tabindex', '1');
}); 
```

end everithing comes in place. You can do it using pure JavaScript of course.

# ruby-on-rails-3.1 - 在模型规范中验证没有数据库的唯一性

> ID：13131325
> 
> 赞同：0
> 
> 时间：2012-10-29T23:51:43.610
> 
> 标签：ruby-on-rails-3.1, mongoid, activemodel

我有一个看起来像这样的模型：

```
class User
   include Mongoid::Document

   field :email

   validate :email, presence: true, uniqueness: true
end 
```

我有一个看起来像...的测试

```
it { User.new.should_not be_valid }
it { FactoryGirl.build(:user).should be_valid }
it { should validate_presence_of :email }
it { should validate_uniqueness_of :email } 
```

这两个都想在`.valid?`调用方法时访问数据库。有什么办法可以抽象出来吗？唯一性验证器已经被很多其他人彻底测试过，所以上面的最后一行对我来说已经足够好了。

如果我必须在模型规范期间运行数据库，这没什么大不了的，但如果可能的话，我宁愿避免它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:46:24.897

.valid? 方法应该仍然适用于 ActiveModel，我不太确定 Mongoid 包括什么，但你必须有 ActiveModel`include ActiveModel:Validations`

这可能还不清楚，但 ActiveModel 不会尝试访问数据库。

# mysql - 这个 MySQL 查询的语法有什么问题？

> ID：13131327
> 
> 赞同：0
> 
> 时间：2012-10-29T23:51:51.677
> 
> 标签：mysql

我有一个相当简单的 MySQL 查询：

```
(SELECT
    id
    , creation_date AS date
    , 'order' AS type
    FROM bus_orders
    WHERE 1
UNION ALL SELECT
    id
    , start_date AS date
    , 'contract start' AS type
    FROM bus_contracts
    WHERE 1
UNION ALL SELECT
    id
    , end_date AS date
    , 'contract end' AS type
    FROM bus_contracts
    WHERE 1
) ORDER BY date DESC LIMIT 5 
```

但是运行它会给我语法错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'UNION ALL SELECT id, start_date AS date, 'contract start' AS type FROM bus_contr' 附近使用正确的语法

我敢肯定这是显而易见的，但我无法完全弄清楚。谁能发现我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:53:05.103

您有一个`)`需要删除的前导。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T23:53:14.153

删除`WHERE 1`或更改为`WHERE 1=1`

```
SELECT *
FROM
    (
        SELECT  id , creation_date AS date , 'order' AS type
        FROM bus_orders
        UNION ALL 
        SELECT id , start_date AS date , 'contract start' AS type
        FROM bus_contracts
        UNION ALL 
        SELECT id , end_date AS date , 'contract end' AS type
        FROM bus_contracts
    ) x
ORDER BY date DESC 
LIMIT 5 
```

# php - php表单有问题（发布错误）

> ID：13131329
> 
> 赞同：-2
> 
> 时间：2012-10-29T23:52:01.173
> 
> 标签：php

我对 PHP 相当陌生，并且在发布验证数据时遇到了一些麻烦（表单）

不断弹出
的错误（对不起，但在您提交的表单中发现错误。这些错误显示在下面。
您输入的名称似乎无效。
您输入的电子邮件似乎无效
。您输入的电话号码似乎无效。
您输入的主席姓名似乎无效。
您输入的主席电子邮件似乎无效。
您输入的受托人人数似乎无效。
号码您输入的学生似乎无效。
请返回并修复这些错误。）

如果你想看看自己[http://wwsta.org.nz/Membership%20Application%20Full%20Board.html](http://wwsta.org.nz/Membership%20Application%20Full%20Board.html)

PHP代码...

```
 <?php 
if(isset($_POST['email'])) {

$email_to = "me@myemail.com";
$email_subject = "Membership Application";
}

function died($error) {
    echo " sorry, but there were error(s) found with the form you submitted. " ;
    echo "these errors appear below.<br /><br />";
    echo $error. "<br /><br />";
    echo "please go back and fix these errors. <br /><br />";
    die();
}

    // validation expected data exists
    if(!isset($_POST['Name']) ||
        !isset($_POST['Email']) ||
        !isset($_POST['Phone_Number']) ||
        !isset($_POST['Chairpersons_Name']) ||
        !isset($_POST['Chairpersons_Email']) ||
        !isset($_POST['Number_of_Trustees']) ||
        !isset($_POST['Number_of_students'])) {
        died ('we are sorry, but these appears to be a problem with the form you submitted.'); 
        }

$Name = $_POST['Name']; //required
$Email = $_POST['Email']; //required
$Phone_Number = $_POST['Phone_Number']; //required
$Chairpersons_Name = $_POST['Chairpersons_Name']; //required
$Chairpersons_Email = $_POST['Chairpersons_Email']; //required
$Number_of_Trustees = $_POST['Number_of_Trustees']; //required
$Number_of_students = $_POST['Number_of_students']; //required

$error_message ="";
$Name_exp = "^[a-z .'-]=$";
if(!eregi($Name_exp,$Name)) {
    $error_message .= 'The name you entered does not appear to be valid.<br />';
}

$Email_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($Email_exp,$Email)) {
    $error_message .= 'The Email you entered does not appear to be valid.<br />';
}

$Phonenumber_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($Phonenumber_exp,$Phone_Number)) {
    $error_message .= 'The Phone Number you entered does not appear to be valid.<br />';
}

$ChairpersonsName_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($ChairpersonsName_exp,$Chairpersons_Name)) {
    $error_message .= 'The Chairpersons name you entered does not appear to be valid.<br />';
}

$ChairpersonsEmail_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($ChairpersonsEmail_exp,$Chairpersons_Email)) {
    $error_message .= 'The Chairpersons Email you entered does not appear to be valid.<br />';
}

$Numberoftrustees_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($Numberoftrustees_exp,$Number_of_Trustees)) {
    $error_message .= 'The Number of trustees you entered does not appear to be valid.<br />';
}

$Numberofstudents_exp = "^[A-Z0-9._%-]+@[A-Z0-9.-]+/.[A-Z]{2,4}$";
if(!eregi($Numberofstudents_exp,$Number_of_students)) {
    $error_message .= 'The Number of students you entered does not appear to be valid.<br />';
}

if(strlen($error_message) > 0) {
    died($error_message);
}

$email_message = "Form details below./n/n";

function clean_string($string) {
    $bad = array("content-type","bcc;","to;","cc:","href");
    return str_replace($bad,"",$string);
}

$email_message .="Name: ".clean_string ($Name)."/n";
$email_message .="Email: ".clean_string ($Email)."/n";
$email_message .="Phone_Number: ".clean_string ($Phone_Number)."/n";
$email_message .="Chairpersons_Name: ".clean_string ($Chairpersons_Name)."/n";
$email_message .="Chairpersons_Email: ".clean_string ($Chairpersons_Email)."/n";
$email_message .="Number_of_Trustees: ".clean_string ($Number_of_Trustees)."/n";
$email_message .="Number_of_students: ".clean_string ($Number_of_students)."/n";

//create email headers
$Headers = 'from: '.$email_from."/r/n".
'Reply-To: '.$email."/r/n".
'X-mailer: PHP/' . phpversion();
@mail ($email_to, $email_subject, $email_message, $headers); 
?> 
```

我要发布的表格

```
<form action="mailscript.php" method="post">
<table border="1">
<tr>
<td>Name of School</td>
<td width="204"><input type="text" width="200" Name="Name" value="name of school"/>&nbsp;</td>
</tr>
<tr>
<td>Email</td>
<td width="200"><input type="text" Name="Email" />&nbsp;</td>
</tr>
<tr>
<td>Phone Number</td>
<td width="200"><input type="text" Name="Phone_Number" />&nbsp;</td>
</tr>
<tr>

<td width="0">&nbsp;</td>
</tr>
<tr>
<td>Chairpersons Name</td>
<td width="200"><input type="text" Name="Chairpersons_Name" />&nbsp;</td>
</tr>

<tr>
<td>Chair persons Email</td>
<td width="200"><input type="text" Name="Chairpersons_Email" />&nbsp;</td>
</tr>
<tr>
<td>Number of Trustees on your board</td>
<td width="200"><input type="text" Name="Number_of_Trustees" />&nbsp;</td>
</tr>
<tr>
<td>Number of Students</td>
<td width="200"><input type="text" Name="Number_of_students" />&nbsp;</td>
</tr>
</table>
<br /><br />

<TABLE width="71">
<TR>
<TD><input type="submit" name="submit" value="Submit"  /></TD>
</TR>
</TABLE>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:19:26.840

您需要修复所有正则表达式类。如果你想`-`在一个类中允许一个字面量，它必须是 . 之后的第一个字符`[`。否则，将其视为字符范围内的分隔符。例如，

```
$Name_exp = "^[a-z .'-]=$"; 
```

应该：

```
$Name_exp = "^[-a-z .']=$"; 
```

此外，这个正则表达式只允许 2 个字符的名称，而第二个必须是`=`. 我怀疑这是一个错字`+`，所以应该是：

```
$Name_exp = "^[-a-z .']+$"; 
```

你所有的其他正则表达式也有类似的问题，我不会去解决所有的问题并为你修复它们。

# jquery - 导航下的jQuery滑动条，定位固定

> ID：13131331
> 
> 赞同：1
> 
> 时间：2012-10-29T23:52:26.787
> 
> 标签：jquery, html, css

嗨，伙计们，我的菜单下的滑块有问题，我是 jquery 和 css 的新手。

我的第一个问题是当页面加载时，该栏不会在菜单下加载，直到您将鼠标悬停在页面一侧加载

第二个问题是，如果我向外滚动**缩小**栏消失在一边，所以这里是基本的 html css 和 jquery .. 真的坚持这个希望有人能提供帮助

我在这里的第一篇文章 ii 做得正确...首先需要帮助 css

```
#topnav { position: relative; width: 997px; height: 50px; background: url(../images/pictures/large/system-files/navbg.png) no-repeat; }
                    #navbar { width: 997px; height: 38px; }             
                    #slider-container {  height: 16px; width: 997px; position: relative;}
        #menu-slide {
        height: 16px;
        width: 64px;
        background: url(../images/pictures/large/system-files/glowbg.png);
        font-size: 1px;
        line-height: 1px;
        z-index: -5;
        position: fixed;
        top: 180px;
        left: 20px;
        } 
```

现在的jQuery

```
<script type="text/javascript">
     $(document).ready(function() {
            $('#slideshow').cycle({
                fx:      'scrollHorz',
                timeout:  0,
                prev:    '#prev',
                next:    '#next'
            }); 
         $('ul.sf-menu').superfish({
         autoArrows:  false
         });
         $("#background_image").fullBg();

        $('li').mouseover( function() { 
            $('.active').removeClass('active');
            $(this).addClass('active');
            //var top = $(this).offset().top + $(this).height() + 5;
            var left = $(this).offset().left + ($(this).width() / 2 - 20);
            $('#menu-slide').stop().animate( {left: left  }, 400 );
        });
        $('li').mouseleave(function(){
             var left = $('.first').offset().left + ($('.first').width() / 2 - 20);
             $('#menu-slide').stop().animate( {left: left  }, 400 );
        });
     });
    </script>
    <script type="text/javascript"> 
      function pageLoad() { 
        var left = $('.first').offset().left + ($('.first').width() / 2);
            $('#menu-slide').stop().animate( {left: left  }, 400 );
      } 
    </script> 
```

> 现在的html

```
<div id="topnav">                    
                        <ul id="navbar"class="sf-menu">
                            <li class="current first"><a href="#a">HOME</a></li>
                            <li><a href="#">ABOUT US</a>
                                <ul>
                                    <li><a href="#">Menu 1</a></li>
                                    <li><a href="#">Menu 2</a></li>
                                </ul>
                            </li>
                            <li><a href="#">CORPORATE</a></li>
                            <li><a href="#">CRUSING</a></li>
                            <li><a href="#">LEISURE</a></li>
                            <li><a href="#">GROUPS</a></li>
                            <li><a href="#">VIRTUOSO</a></li>
                            <li><a href="#">LINKS</a></li>
                            <li class="last"><a href="#">CONTACT</a></li>
                        </ul>
                            <div id="slider-container">
                                <div id="menu-slide"></div>
                            </div>
                        </div> 
```

# javascript - Google Chart API Line Graph 上的日期错误

> ID：13131332
> 
> 赞同：2
> 
> 时间：2012-10-29T23:52:33.060
> 
> 标签：javascript, datetime, google-visualization

因此，我正在尝试使用 Google 的 Chart API 在折线图上绘制潮汐时间。但是，图表上绘制的点与正确的日期和时间值不对应。

数据采用日期时间（x 轴）和潮汐高度（y 轴）的形式。我不确定我是否正确创建了日期时间值，或者 API 只是在做一些奇怪的事情。

例如，tideTimes 数组中的最后一个日期是 11 月 1 日，但图表显示的是 12 月的数据点，您可以在下图中看到这种行为。我添加了下面的代码以允许您重新创建这些错误。

如果有人能告诉我我做错了什么，将不胜感激。 ![在 google chart api 上显示错误的数据点](../Images/b5336fbe0680de219dae24bcfbefcba2.png)

```
 <html>
      <head>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">

        google.load("visualization", "1", {packages:["corechart"]});
          google.setOnLoadCallback(drawWeekChart);
          function drawWeekChart() {

            var data = new google.visualization.DataTable();
            data.addColumn('datetime', 'Date');
            data.addColumn('number', 'Wave Height (Meters)');
            var tideTimes = [
                [new Date(2012, 10, 29, 05, 44, 00, 00), 9.12],
                [new Date(2012, 10, 29, 11, 47, 00, 00), 1.62],
                [new Date(2012, 10, 29, 18, 01, 00, 00), 9.23],
                [new Date(2012, 10, 30, 00, 01, 00, 00), 1.55],
                [new Date(2012, 10, 30, 06, 16, 00, 00), 9.20],
                [new Date(2012, 10, 30, 12, 16, 00, 00), 1.58],
                [new Date(2012, 10, 30, 18, 33, 00, 00), 9.21],
                [new Date(2012, 10, 31, 00, 29, 00, 00), 1.54],
                [new Date(2012, 10, 31, 06, 46, 00, 00), 9.21],
                [new Date(2012, 10, 31, 12, 45, 00, 00), 1.60],
                [new Date(2012, 10, 31, 19, 04, 00, 00), 9.12],
                [new Date(2012, 11, 01, 00, 58, 00, 00), 1.59]
            //  new Date( YYYY, MM, DD, HH, MM, SS, MS), height]
                        ];
            data.addRows(tideTimes);

            var options = {
                title: 'Tide Times',
                smoothLine: true,
                width: 984,
                height: 600
            };

            var chart = new google.visualization.LineChart(document.getElementById('tide_chart_week'));
            chart.draw(data, options);
          }

        </script>
      </head>
      <body>
    <div id="tide_chart_week" stye="float:left; height:800px; background:blue;"></div>
      </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T00:05:08.063

月份必须是整数 b/w 0-11。

检查 Date() 构造函数文档 [0]

> month 表示月份的整数值，从 0 开始表示 1 月到 11 表示 12 月。

只需相应地更改您的`tideTimes`变量

```
 var tideTimes = [
            [new Date(2012, 9, 29, 05, 44, 00, 00), 9.12],   // october
            //.....
            [new Date(2012, 10, 01, 00, 58, 00, 00), 1.59]   // november
 ]; 
```

此外，您可能希望更改图表的横轴格式以显示更友好的日期

```
 var options = {
     /*.. current options ..*/
     hAxis:  {format:'MMM d, y'}
 }; 
```

![例子](../Images/2aa6e3e12e0323d9205a737d9ba88ccd.png)

这是一个例子：http: [//jsfiddle.net/jaimem/F4Gzr/1/](http://jsfiddle.net/jaimem/F4Gzr/1/)

* * *

[0] [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:22:25.800

正如 jm 所指出的，在 ECMAScript 中，月份是从零开始的，所以：

```
new Date(2012, 10, 31, 19, 04, 00, 00) 
```

是 2012 年 11 月 31 日，它创建了 2012 年 12 月 1 日的日期（因为 11 月只有 30 天）并且：

```
new Date(2012, 11, 01, 00, 58, 00, 00) 
```

也是 2012 年 12 月 1 日。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-05-26T03:08:54.837

```
<div id="tide_chart_week" stye="float:left; height:800px; background:blue;"></div> 
```

注意使用 stye 而不是 style ！

# sql - 计算两个表之间的 AVG (JOIN)

> ID：13131333
> 
> 赞同：0
> 
> 时间：2012-10-29T23:52:36.413
> 
> 标签：sql

表 PROBE 如下所示：

`'ProbeID'----- 'TranscriptID' ---- 'Start'---- 'End'`

`'1056'-----------'7981326'----------'1013'---'1010'`

`'1057'-----------'7878826'----------'1011'---'1015'`

`etc..`

表 EXPRESSION2 如下所示：

`'ProbeID'----- 'SampleID' ---- 'Value'`

`'10425'---------'7981326'-----'16.55''`

`'11123'---------'7878826'----- '3.55'`

`etc..`

我需要找到成绩单中最大的 100 个差异（即取探针的平均值）。

**本质上，我需要将 EXPRESSION2 表的 ProbeID 与 PROBE 表中的 TranscriptID 链接起来，并计算前 100 名的平均值。**

我尝试了下面的代码，但不断收到“null”返回。任何替代脚本将不胜感激。我想我错过了一些东西。

**EXPRESSION2 表没有空值，仅供参考**

`选择平均值（值）

从表达式2

```
 where probeID in  
                    (   
                      select P.ProbeId 
                           from Probe P
                            join Transcript T on P.TranscriptID = T.TranscriptID 
```

)`

限制100；`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:08:17.070

If you whant to eliminate the null values

```
select e.probeID, avg(value) as avarage
from expression2 e
    inner join 
    (
        select P.ProbeId 
        from Probe P 
            join Transcript T on P.TranscriptID = T.TranscriptID    
    ) p on e.probeID = p.probeID
where e.value is not null
group by e.probeID 
```

if you whant to treat them as 0

```
select e.probeID, avg(COALESCE(value,0)) as avarage
from expression2 e
    inner join 
    (
        select P.ProbeId 
        from Probe P 
            join Transcript T on P.TranscriptID = T.TranscriptID    
    ) p on e.probeID = p.probeID
group by e.probeID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:10:17.730

Which DBMS are you using? Is it significant that there are no matching ProbeIDs in the two tables in your example, but there are matching TranscriptID/SampleID pairs?

```
Select Top 100
  p.TranscriptID,
  Avg(e.Value)
From
  Probe p
    Inner Join
  Expression2 e
     on p.ProbeID = e.ProbeID
Group By
  p.TranscriptID
Order By
  2 Desc 
```

# java - 处理类给出 NullPointException（初学者）

> ID：13131335
> 
> 赞同：1
> 
> 时间：2012-10-29T23:53:02.053
> 
> 标签：java

我正在尝试制作一个基本的青蛙游戏。我正在尝试为我的青蛙图像创建一个类，然后我希望它显示在`void draw();`除了我不断收到 NullPointException 之外，任何人都可以帮我找出原因吗？

这是我一直在尝试解决问题的代码。

```
PImage img; // frog image

Frog froggy;
Car[] c1;

class Car {
  float xpos;
  int ypos;
  int sizel;
  int sizew;
  float yspeed;
  color c;

   Car(){
    xpos = 0;
    ypos = (int)random(120,480);
    sizel = (int)random(20,30);
    sizew = 15;
    yspeed = (float)random(1,3);
    c= color(random(255), random(255), random(255));

  }

  void carShape() {
    rectMode(CENTER);
    fill(c);
   rect(xpos,ypos,sizel,sizew);
   fill(0);
   rect(xpos-5, ypos-8, 8,5);
   rect(xpos+5, ypos-8, 8,5);
   rect(xpos-5, ypos+8, 8,5);
   rect(xpos+5, ypos+8, 8,5);

  }

 void moveCar () {
   xpos = xpos + yspeed;
    if (xpos > width) {
      xpos = 0;
      ypos = (int)random(120,480);

    } 

 } 
}

class Frog {
  int frogx;
  int frogy;

 Frog(){
    frogx = width/2-20;
    frogy = 527;
 }

  void drawFrog() {
    image(img,frogx,frogy);

 }
}

void setup() {
  size(800,600);
   img = loadImage("frog.png");

c1 = new Car[20];

  for(int i=0; i<20; i++) {
    c1[i] = new Car();
  }
}

  void draw() {
    background(100);

     froggy.drawFrog();

    for(int i=0; i<20; i++) {
    c1[i].carShape();
    c1[i].moveCar();
    }

  } 
```

这是错误

```
Exception in thread "Animation Thread" java.lang.NullPointerException
    at snowflakecarexample.draw(snowflakecarexample.java:97)
    at processing.core.PApplet.handleDraw(PApplet.java:2120)
    at processing.core.PGraphicsJava2D.requestDraw(PGraphicsJava2D.java:197)
    at processing.core.PApplet.run(PApplet.java:1998)
    at java.lang.Thread.run(Thread.java:680) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:58:54.850

你不`initialize` `Frog`反对。尝试

```
 Frog froggy = new Frog();
   froggy.drawfrog(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T23:57:50.483

无论青蛙应该是什么，都必须对其进行初始化：

```
Frog froggy;
... (Froggy is null)
froggy.drawFrog(); 
```

也许您想在某处调用构造函数？喜欢：

```
Frog froggy = new Frog(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:02:49.570

在`moveCar()`您正在检查的函数中`if (xpos > width)`，但我没有看到任何地方声明的宽度。除非它被声明并且不在您发布的代码段中，否则这可能是问题所在。

您还可以在`Frog()`函数中使用宽度。

# c# - twitter bootstrap 的基本 asp.net 设置

> ID：13131337
> 
> 赞同：3
> 
> 时间：2012-10-29T23:53:07.597
> 
> 标签：c#, asp.net, twitter-bootstrap

我正在尝试在 Visual Studio 2010 Ultimate 中使用 twitter bootstrap 和 asp.net。我找不到任何解释如何设置它以及为什么的东西。我尝试的一切都不太奏效。大多数文章都是针对 MVC 的，而我对 asp.net 还是新手，所以我想在尝试 mvc 之前先从基础开始。

我最接近的是让样式工作，但无论我尝试什么例子，javascript似乎都不起作用。这是我得到的最接近的。它是 bootstrap 网站上的模态示例片段和我发现的一些关于将 bootstrap 与 mvc 结合使用的博客的混搭。

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm3.aspx.cs" Inherits="WebApplication6.WebForm3" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title></title>
    <link rel="stylesheet" href="~/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/bootstrap-responsive.min.css" />

</head>
<body>
    <script type="text/javascript" src="~/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="~/js/jquery-1.8.2.min.js"></script>
    <form id="form1" runat="server">

        <a href="#myModal" role="button" class="btn" data-toggle="modal">Launch demo modal</a>

        <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Modal header</h3>
            </div>
            <div class="modal-body">
            <p>One fine body…&lt;/p>
            </div>
            <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary">Save changes</button>
            </div>
            @RenderBody()
        </div>
    </form>
</body>
</html> 
```

这些文件都在链接的位置。我开始认为我需要安装一些先决条件或其他东西。@RenderBody() 显示为文本。

我找不到任何有效的例子。任何帮助将不胜感激，因为我开始兜圈子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T11:28:46.667

这不是 asp.net 的问题，您只需在引导包含之前移动 jquery JS 文件。

如果您使用带有 javascript 控制台（如 chrome）的浏览器，它将对您有很大帮助，该错误并不总是告诉您确切的问题是什么，但它可以帮助缩小范围。

# ruby-on-rails - 在 ruby 中通过 SQL 查询获取结果时使用分页

> ID：13131340
> 
> 赞同：0
> 
> 时间：2012-10-29T23:53:15.710
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, will-paginate, kaminari

我的 Rails 控制器中有以下查询：

```
SELECT CODE_VER FROM MASTERTEST WHERE DATE>= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC; 
```

此查询返回过去 90 天的结果。我现在在表格中显示所有这些结果。

我想在某种分页中一次只显示 7 天的行。我已经尝试过 will_paginate 和 kaminari 以及 paginate_by_sql。但到目前为止，我还没有成功使用它们中的任何一个。

有人可以告诉我查询的确切语法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-30T10:08:39.293

将结果存储在变量中，比如@result

在控制器中

```
@result=SELECT CODE_VER FROM MASTERTEST WHERE DATE>= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC;

@result.page(params[:page]).per(10) 
```

在视图中，使用

```
<% paginate %> # to render the value page by page 
```

# git - 合并相邻提交及其还原

> ID：13131342
> 
> 赞同：2
> 
> 时间：2012-10-29T23:53:52.457
> 
> 标签：git, version-control, commit, git-commit, git-revert

我有一个看起来像这样的特殊提交日志，

```
A --> B --> C --> D 
```

其中每个字母都是一个提交。看起来 C 是 B 的还原，所以基本上历史将与

```
A --> D 
```

有没有办法“总结” B 和 C 的提交？更改尚未推送。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T23:58:57.190

您可以在 TODO 列表中执行`git rebase -i HEAD~3`和删除表示`B`和`C`提交的行并执行变基。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T13:24:59.723

除了交互式变基之外，一个简单的方法是：

```
git reset --hard A     # reset current branch to A
git cherry-pick D      # transplant commit D here 
```

还有一个更通用的命令，当 CD 是整个提交范围时，它会更好地工作：

```
git rebase --onto A C  # transplant C..D onto A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T04:15:35.440

最简单的方法是使用重置：

```
git reset --soft HEAD^^^
git add -A
git commit -C HEAD@{1} 
```

第一个命令使 A 成为当前提交，同时保持工作树就像它在 D 中一样。我们使用下一个命令暂存工作树的状态。接下来，我们使用来自提交 D 的消息进行提交（其中 HEAD 是 1 次之前）。

# php - 多表数据冗余

> ID：13131344
> 
> 赞同：0
> 
> 时间：2012-10-29T23:53:57.133
> 
> 标签：php, mysql, database, schema

所以我创建了一个用户通知系统，我有一个 user_notifications 表结构如下：

```
id
receiver_id
sender_id
action
action_type
entity_id
timestamp 
```

现在，其他表中的值通过“entity_id”列连接到通知。所以假设我也有这张名为**videos_watched**的表：

```
video_id
user_id
time_watched_for 
```

它们从**user_notifications** .entity_id 连接到**videos_watched** .video_id

我要决定的是，将数据也存储在第二个表中是否是一件坏事。我应该将**user_notifications**表视为交互表，而不是实际可靠地存储用户数据的地方吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:06:57.653

The way I would approach this task is by breaking the data you are recording into manageable and logical chunks (although this is influenced by the amount of usage and the actual information you are wanting to pull out).

For instance, if the situation is that you are recording the following types of data:

*   user information (email, id, name etc)
*   videos (id, title, filename etc)
*   videos watched (video_id, user_id, time_watched_for)

Then it may make sense to store the data in separate tables so that the information is separated in a meaningful way.

So in that sense it would also make sense to have you initial table for notifications (although this looks more like a notification logs table):

*   notification table (id, receiver_id, sender_id, action, action_type, entity_id, timestamp)

Essentially, storing the data in a separate table isn't a bad idea, as long as there is a meaningful or logical reason to store it there such as logical data separation.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:08:25.207

Generally, it's a bad idea to have redundant data in your database (non-normalized) because:

*   It takes up more space.
*   It's more cumbersome to maintain and takes longer to write (you are writing the same data to multiple places).
*   You can get an inconsistent database (like if you mess up the point above and don't write to all the places you need to).

The only reason to ever have redundant data that I can think of is because you absolutely need a performance boost for some kind of join that you will be doing and reading from all the time. If you have redundant data, you can eliminate the join/lookup and read straight from a single table.

# c++ - 我应该如何为 SDL 中的多个按钮缩放它？

> ID：13131349
> 
> 赞同：2
> 
> 时间：2012-10-29T23:54:45.040
> 
> 标签：c++, sdl

我有一个简单的脚本，它显示一个按钮（这是一个 png 图像），当用户单击它时，应用程序退出。

但我想添加多个按钮，我发现我目前的想法会导致很长的 if:else 情况，我想知道这是否是唯一的方法。

这就是我在 main.cpp 文件中设置当前菜单的方式。

```
bool handle_mouse_leftClick(int x, int y, SDL_Surface *button) {
 if( ( ( mouseX > x ) && ( mouseX < x + button->w ) ) && ( ( mouseY > y ) && ( mouseY < y + button->h ) ) ) {
        return true;
  } else {
        return false;
 }
} 
```

这是我的检测功能。

下面是我的主要功能，它充当我的游戏循环，我已经删除了不相关的代码以使其更容易理解：

```
//menu button
SDL_Surface *button;
button = IMG_Load("button.png");

while(!quit){
   //handle events
         while( SDL_PollEvent( &event ) ){
               switch(event.type){
                    case SDL_QUIT: quit = true; break;
                    case SDL_MOUSEBUTTONDOWN:

                  if (event.button.button == SDL_BUTTON_LEFT) {
                       if(handle_mouse_leftClick(btnx,btny,button)){
                             quit = true;
                       }
                  }
                    break;
         }
 } 
```

问题是我的 main.cpp 是否应该进行所有这些检查，当我添加更多按钮时会很快变得很长，所以我想知道我是否错过了简化工作的技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:10:45.690

当您深入了解基本逻辑/计算时，我会说答案是“不”，您没有错过任何技巧。我从来没有找到一种方法来一次检查每个目标 - 至少在计算方面。您可以通过多种方式使您的代码*更*简洁。您可以有一个公开“bool IsIn(int x, int y)”方法的 GuiElement 类。然后你的大案例陈述看起来更像：

```
bool handle_mouse_leftClick(int x, int y, SDL_Surface *button) 
{
     if (Button1.IsIn( mouseX, mouseY )
     {
         // do this
     }
     else if (Button2.IsIn( mouseX, mouseY ))
     {
         // do that
     } 
     else 
     {
          return false;
     }
 } 
```

然后，您可以使用列表或表格进一步减少金额代码：

```
int handle_mouse_leftClick(int x, int y, SDL_Surface *button) 
{
     for (unsigned int i = 0; i < buttonList.size(); i++
     {
        if (buttonList[i].IsIn( mouseX, mouseY ))
        {
             return i;   // return index of button pressed
        }
        return -1;   // nothing pressed
     }
 } 
```

但它最终仍然一次只查看每个矩形。

几个警告：

1.  我认为检查每个项目的命中框并没有太多真正的计算开销——除非你以某种疯狂的高帧速率进行。

2.  当然，您可以使用某种空间索引（例如由屏幕上按钮的位置组织的 b 树或四叉树）来优化检查，但是……请参阅 #1。;-)

如果您有*THOUSANDS*而不是 10 或 15 个按钮/控件，那么您可能想要执行 #2，因为 #1 将不再适用。

****** *** ** *** ** *****更新***** ** *** ** *** ********

 **这是可用于此的类的简短示例。至于 .h 与 main.cpp，典型的方法是将标头放在“Button.h”中，将实现（代码）放在“Button.cpp”中，但您可以将其放在 main 的顶部.cpp 开始 - 它在类定义中具有所有逻辑。

你会注意到我并没有真正编写任何新代码。“IsIn()”测试是您的逐字逻辑，我只是​​更改了变量名以匹配类。而且由于您已经有一个按钮，我假设您可以重用渲染该按钮的代码 Render() 方法。

最后，如果不是您熟悉的东西，您根本不必创建列表/向量。呈现按钮的代码可以只调用“okButton.Render()”，然后调用“cancelButton.Render()”。

示例“按钮”类：

```
class Button
{
private:
    int m_x, m_y;            // coordinates of upper left corner of control
    int m_width, m_height;   // size of control

public:
    Button(int x, int y, int width, int height, const char* caption)
    {
       m_x = x;
       m_y = y;
       m_width = width;
       m_height = height;
       // also store caption in variable of same type you're using now for button text
    }

    bool IsIn( int mouseX, int mouseY )
    {
        if (((mouseX > m_x) && (mouseX < m_x + m_width)) 
        && ((mouseY > m_y) && (mouseY < m_y + m_height ) ) ) {
            return true;
        } else {
            return false;
        }
    }

    void Render()
    {
        // use the same code you use now to render the button in OpenGL/SDL
    }
}; 
```

然后创建它/它们（使用列表方法）：

```
Button okButton( 10, 10, 100, 50, "OK" );
buttonList.push_back( okButton );

Button cancelButton( 150, 10, 100, 50, "Cancel" );
buttonList.push_back( cancelButton ); 
```

在你的渲染循环中：

```
void Update()
{
   for (unsigned int i = 0; i < buttonList.size(); i++
   {
       buttonList[i].Render();
   }
} 
```**

# texture2d - 我可以在像素着色器中创建切片引擎吗？

> ID：13131356
> 
> 赞同：7
> 
> 时间：2012-10-29T23:55:23.793
> 
> 标签：texture2d, pixel-shader, tile-engine

我正在尝试使用像素着色器和两个纹理创建一个平铺引擎。一种纹理将保存图块集，另一种用于保存地图。

是否可以将纹理数据作为实际（未采样）数据读取，以便我可以从地图中提取索引？

读取该像素数据的最佳方法是什么？

我只尝试了 text2D ，但这还有一些不足之处（老实说，我对像素着色器有点陌生）。

基本上，我需要一种从地图纹理中的特定像素读取实际数据并将其用作平铺纹理的整数索引的方法。假设我已经设法创建并将适当的纹理传递给着色器。

有什么想法吗？

（使用 monogame 进行地铁所以 dx 级别 9_1）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T09:43:57.767

如果你使用`tex2D`and 传入`(x + 0.5) / width`and `(y + 0.5) / height`，你应该得到精确的像素值在`(x, y)`. 更多信息：[Texture memory-tex2D basics](https://stackoverflow.com/questions/10643790/texture-memory-tex2d-basics)

# function - 在窗口调整大小 jQuery 上重置滚动条检测

> ID：13131357
> 
> 赞同：2
> 
> 时间：2012-10-29T23:55:30.127
> 
> 标签：function, scrollbar, jquery, window-resize

我创建了一个 jQuery 窗口滚动条检测器，但是当我重新调整浏览器窗口的大小时，反过来将滚动条状态从可见更改为不可见，反之亦然，状态通知器保持静态。如何通过严格的 javascript在**没有 AJAX 调用的情况下以简单的方式在每次调整大小时不断更新状态通知器？**

对于进一步的上下文，如果内容不超过窗口大小，我基本上是想提出一个半无限滚动的解决方案。如果你们中的一个人弄清楚了这一点，那么对于许多试图整合需求量很大且流行的滚动加载效果的 UI 开发人员来说，这将是非常有益的。提前致谢。这是我的[演示](http://jsfiddle.net/TwJAM/99/)。

```
$(window).resize(function () {

    ///????

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:00:37.173

您可以使用所谓的函数来实现这一点。在 Javascript 中，函数实际上是对象，可以简单地存储在变量中并作为参数传递。

举个例子：

```
//first define your function - maybe give it a better name than I did :)
var detectScrollbar = function () {
    if($(window).height() >= $(document).height()){
        $('#statusNotifier1').fadeIn("slow");
        $('#statusNotifier2').hide();
    }
    else
    {
        $('#statusNotifier1').hide();
        $('#statusNotifier2').fadeIn("slow");
    }
};

//call it initially
detectScrollbar();

//pass it to .resize() so it will be called when the event fires
$(window).resize(detectScrollbar); 
```

你可以把这整件事放到你的`$(document).ready();`.

[享受jsFiddle 演示](http://jsfiddle.net/TwJAM/100/)的乐趣。我希望所有那些悲伤的 UI 开发人员都会面带微笑地跳舞，庆祝:)。

# android - 在 Android 中存储用于检索的数组列表

> ID：13131360
> 
> 赞同：0
> 
> 时间：2012-10-29T23:56:01.373
> 
> 标签：android, eclipse, arraylist

我目前正在开发一个有点像学生规划师的 Android 应用程序。我的后端都是java，我目前被卡住了，因为我将从后端创建的对象存储到arraylist。作为java，一旦程序终止，这些对象就会消失。下次启动应用程序时，我可以存储我的 java 对象以供检索的最简单方法是什么？任何帮助深表感谢！我正在开发 2.3 和 eclipse(juno)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:06:37.800

[Android 开发人员教程中列出](http://developer.android.com/training/basics/data-storage/index.html)的数据存储选项之一将是最简单的操作。哪个最合适取决于您存储的数据量以及您需要如何访问它。正如页面所说，[SharedPreferences](http://developer.android.com/training/basics/data-storage/shared-preferences.html)类最适合少数项目；对于较大的数据集，您可以使用 Java 序列化或其他方式[将它们写入](http://developer.android.com/training/basics/data-storage/files.html)手机存储中的文件；如果您的数据很大并且/或者您需要对它们进行结构化访问，[那么 SQLite 数据库](http://developer.android.com/training/basics/data-storage/databases.html)是您的最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:32:45.350

您可以使用[共享首选项](http://developer.android.com/guide/topics/data/data-storage.html#pref)来存储您的数据。允许您在应用程序中保留原始数据类型的`SharedPreferences`键值对。您不能`ArrayList`使用单个键存储一个整体，但您可以遍历数组并系统地为列表中的每个值生成一个键。我通常会这样做：

```
public class SomeActivity extends Activity {
    private ArrayList<Data> list; //We'll persist this array

    /* snip */

    //These strings can be anything - you just need something you can use to systematically generate distinct keys
    public static final String LIST_KEY = "SomeActivity_List";
    public static final String LIST_LENGTH_KEY = "SomeActivity_ListLength";

    /**
     * How this method works: It starts by getting a SharedPreferences object,
     * which offers an API for persisting data. It then systematically generates
     * Strings like "SomeActivity_List1", "SomeActivity_List2", "SomeActivity_List3",
     * and so on to use as keys fot the 1st, 2nd, 3rd, etc. elements in the list. Then
     * it Data.saveData(), a method defined below in the Data class, in order to give
     * each Data object in the ArrayList an opportunity to persist its primitive
     * members in the SharedPreferences.
     *
     * SomeActivity.restoreList() works similarly.
     */
    public void saveList() {
        SharedPreferences prefs = getPreferences(); //This method is part of the Activity class
        SharedPreferences.Editor editor = prefs.getEditor();

        //Save the length of the list so that when we restore it, we know how many
        //Data objects to recreate.
        editor.putInt(LIST_LENGTH_KEY, list.size());
        editor.commit();

        //This for loop is important - note how we concatenate i to each of the keys to give each element in list a distinct key
        for(int i = 0; i < list.size(); i++)
        {
            String identifier = LIST_KEY + Integer.toString(i); //generate distinct keys
            list.get(i).saveData(identifier, prefs);
        }
    }

    public void restoreList() {
        SharedPreferences prefs = getPreferences();

        int length = prefs.getInt(LIST_LENGTH_KEY);

        for(int i = 0; i < length; i++)
        {
            String identifier = LIST_KEY + Integer.toString(i); //re-generate distinct keys
            Data data = new Data();
            data.restoreData(identifier, prefs);
            list.addLast(data);
        }
    }

    public static class Data {
        private int i;
        private double j;
        private String s;

        public static final String I_KEY = "Data_I"
        public static final String J_KEY = "Data_J" //strings can really be whatever, as long as they're distinct.
        public static final String S_KEY = "Data_K"

        /**
         * How this method works: The SomeActivity.saveList() method generates a
         * unique String ("identifier") for each of the Data objects it contains.
         * This method uses that distinct string and makes some more distinct keys
         * to store each of Data's primitive members.
         *
         * restoreData() works similarly when it rebuilds Data objects
         */
        public saveData(String identifier, SharedPreferences prefs) {
            SharedPreferences.Editor editor = prefs.getEditor();
            editor.putInt(I_KEY + identifier, i);
            editor.putDouble(J_KEY + identifier, j);
            editor.putString(S_KEY + identifier, s);
            editor.commit();
        }

        public restoreData(String identifier, SharedPreferences prefs) {
            i = prefs.getInt(I_KEY + identifier);
            j = prefs.getDouble(J_KEY + identifier);
            s = prefs.getString(S_KEY + identifier);
        }
    }
} 
```

这种方法递归地工作。例如，如果 Data 有一个 ArrayList 作为其字段之一，它也可以系统地将该列表中的所有值存储在 SharedPreferences 中。

仅供参考：使用 SharedPreferences 的影响之一是，如果用户卸载您的应用程序或清除应用程序数据，则存储的列表将被删除。根据数据的性质，您可能需要也可能不想要这种行为。

# java - 未能加载类 'org.slf4j.impl.StaticLoggerBinder'

> ID：13131365
> 
> 赞同：3
> 
> 时间：2012-10-29T23:56:46.977
> 
> 标签：java, slf4j, logback

我创建了一个包含所有依赖项的 jar 文件，并使用 slf4j + logback 实现了日志记录。因此，我`logback.xml`为所有记录器定义了一个文件。但是，当我运行 jar 时，它给了我这个消息：

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details. 
```

我没有看到任何日志记录发生。解压 jar 文件后，可以看到 org.slf4j 文件夹。我不知道为什么这不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T12:30:36.573

来自[http://www.slf4j.org/codes.html#StaticLoggerBinder](http://www.slf4j.org/codes.html#StaticLoggerBinder)（消息中的链接）：

> org.slf4j.impl.StaticLoggerBinder 类无法加载到内存时会报此错误。当在类路径上找不到合适的 SLF4J 绑定时，就会发生这种情况。将 slf4j-nop.jar、slf4j-simple.jar、slf4j-log4j12.jar、slf4j-jdk14.jar 或 logback-classic.jar 中的一个（也是唯一一个）放在类路径上应该可以解决问题。SINCE 1.6.0 从 SLF4J 版本 1.6 开始，在没有绑定的情况下，SLF4J 将默认为无操作 (NOP) 记录器实现。您可以从项目下载页面下载 SLF4J 绑定。

换句话说，你的类路径中需要一个 slf4j 后端，例如 logback。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T05:50:22.777

类路径中似乎`logback-classic.jar`缺少它。

看看[http://slf4j.org/manual.html#swapping](http://slf4j.org/manual.html#swapping)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-10T08:53:06.927

这是一个scala项目吗？如果是，那么添加以下依赖项将有所帮助。它对我有用。

```
 "org.slf4j" % "slf4j-simple" % "1.7.12" 
```

# java - 如何将 eclipse 项目添加到现有的 git repo？

> ID：13131366
> 
> 赞同：4
> 
> 时间：2012-10-29T23:56:48.240
> 
> 标签：java, eclipse, git

我已经在 Eclipse 中有一个现有项目，我想将它添加到我团队的 github 存储库中。github 存储库现在是空的。将此项目添加到我们的 github 存储库的最佳方式是什么？我正在考虑将`git clone`我们的 repo 放入工作区文件夹（相关项目的父级），然后使用添加项目文件`git add`，然后`pushing`进行更改。这会起作用，还是有更好的方法来做到这一点（也许使用 EGit）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T23:59:38.637

您必须将遥控器添加到项目中，然后推送到它。

例如，您可以（从项目目录中）

```
git init # if you haven't already
git remote add origin ssh://git@github.com:.....
git push -u origin master 
```

eclipse插件也应该有一种方法可以做到这一点，但我发现从命令行很容易做到这一点.. :)

顺便说一句，记住将所有特定于 IDE 的文件添加到`.gitignore`，以避免将垃圾推向世界：它们通常是 `.project`，`.classpath`以及诸如`bin/*`, `.settings/*`...

# emacs - Emacs Ctrl 修饰符在控制台中不起作用

> ID：13131367
> 
> 赞同：4
> 
> 时间：2012-10-29T23:56:50.257
> 
> 标签：emacs, console, hotkeys

我有 2 个用于 dired 的热键，它们在 Emacs 的 GUI 模式下工作：

```
(add-hook 'dired-mode-hook
  (lambda ()
        (define-key dired-mode-map (kbd "C-<up>")
              (lambda () (interactive) (find-alternate-file "..")))))

(add-hook 'dired-mode-hook
  (lambda ()
        (define-key dired-mode-map (kbd "C-<right>") 'diredp-find-file-reuse-dir-buffer))) 
```

但是当我点击`CTRL`+`→</kbd> or `CTRL`+`↑</kbd> in console the cursor just moves as if the arrow was pressed.``

当我尝试`CTRL`+`H` `K`然后`CTRL`+`→</kbd>, it gives me the right key docs as if `CTRL` wasn't pressed at all.`

如何在控制台中解决这种奇怪的行为？

我正在使用 Linux Slackware 14、Emacs 24.2.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:45:55.770

这是算法，如何使修饰键在终端的 Emacs 中工作。

1.创建一个包含内容的文件funcskeys：

```
control keycode 105 = F100
string F100 = "\033[1;5D"
control keycode 106 = F101
string F101 = "\033[1;5C"
control keycode 103 = F102
string F102 = "\033[1;5E"
altgr keycode 105 = F103
string F103 = "\033[1;5F" 
```

最后必须是一个空行！

2.在root下加载文件：

`#loadkeys funcskeys`

3.把这个放到.emacs的开头：

```
(unless (display-graphic-p)
  (progn
    (define-key input-decode-map "\e[1;5C" [(control right)])
    (define-key input-decode-map "\e[1;5D" [(control left)])
    (define-key input-decode-map "\e[1;5E" [(control up)])
    (define-key input-decode-map "\e[1;5F" [(meta left)]))) 
```

* * *

算法结束

在此热键将起作用之后：

```
(global-set-key (kbd "C-<right>") 'forward-word)
(global-set-key (kbd "C-<left>") 'backward-word) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T23:21:41.440

您的终端可能不会产生不同的转义序列`CTRL-right‬</kbd> versus just `right`.`

您可以通过键入轻松验证这一点`CTRL-v CTRL-right‬</kbd> and `CTRL-v right‬</kbd>. Here, `CTRL-v` tells the terminal to print the escape sequence for the key that follows. If these two produce the same sequences then your terminal sends the exact same information to Emacs whether you press CTRL or not.``

例如，如果我在 Gnome 终端中键入这些快捷方式，我会得到：

*   `^[[C`为了`CTRL-v right‬</kbd>`
*   `^[[1;5C`为了`CTRL-v CTRL-right‬</kbd>`

当我在其中一个 Linux 控制台上执行相同操作时，我得到：

*   `^[[C`为了`CTRL-v right‬</kbd>`
*   `^[[C`为了`CTRL-v CTRL-right‬</kbd>`

如您所见，在后一种情况下，两个键序列的结果完全相同，因此 Emacs 无法区分两者。

解决此问题的唯一方法是说服您的终端在按住`CTRL`键时发送不同的序列 - 请参阅[此问题](https://stackoverflow.com/q/13212696/261142)以获取更多信息。

更简单的解决方法是在 Emacs 中简单地使用不同的键绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T23:44:17.627

当心`loadkeys`。至少在 Debian/Ubuntu 中它在 package 中`kbd`。有了它，您可以修改您的键盘布局，可能还可以修改一些“异国情调”的组合键。

# owl - OWL 术语：为什么个人有 ObjectProperties（而不是 IndividualProperties）

> ID：13131368
> 
> 赞同：4
> 
> 时间：2012-10-29T23:56:58.313
> 
> 标签：owl

在 W3 OWL 规范中，个体的属性分为两组：数据类型属性和对象属性。定义了对象属性（正如我发现的一篇文章所说）：

> “对象属性 (owl:ObjectProperty) 关联两个 OWL 类的个体（实例）。

所以本质上，对象属性也可以称为“个体属性”，因为它们不仅指向任何类型的通用对象，它们还专门指向个体。

现在，如果这只是一些随机规范，我会假设作者只是选择了他们的名字很糟糕，但这是 W3 规范，并且专门针对知识存储的规范；我不得不假设人们想到了事物的名称！

因此，我希望这里有人可以解释这个看似奇怪的命名选择。毕竟，您可以将任何规范中的任何东西都称为“ObjectFoo”，因为 Object 是一个超通用术语，但通常人们在命名事物时会使用*最*具体的术语，而不是最不重要的。

是否存在其他情况，其中 ObjectProperty 可以指代个人以外的东西，或者我遗漏的任何其他东西可以解释这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T07:24:53.600

术语“ObjectProperty”（很可能）是为了将其与“DatatypeProperty”区分开来的，因为后者只能具有（数据类型化的）文字值，而不是完整的对象。是的，不仅仅是个体可以是 ObjectProperty 的值，类也可以是它们的值——尽管如果你这样做，你的本体不再是有效的 OWL DL 而是变成 OWL Full。但从建模的角度来看它是有效的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-01T08:55:53.283

我的回答也是对 Jeen 的评论。OWL DL 和 OWL Full 是两种不同的语言，具有不同的（甚至是不相交的）抽象语法。OWL DL 语法是根据其[结构规范](http://www.w3.org/TR/owl2-syntax/)定义的。OWL 完整的语法是 RDF。OWL 的结构规范甚至不包含任何 RDF 三元组。

现在，在 OWL DL 中，将两个类与一个对象属性相关联是无效的。对象属性只能关联`owl:Thing`. 它们也不能关联文字、属性、本体或数据类型。如果你调用这个概念`IndividualProperty`，你会在命名上造成不一致，因为`DatatypeProperty`这并不意味着与数据类型相关的属性。它是与文字相关的属性。所以一个更好的名字会是`ClassProperty`。或者您必须将两者都更改为`DatatypeProperty`and 。`ObjectProperty``LiteralProperty``IndividualProperty`

总而言之，有多种方法可以解决这个问题，工作组选择了获得更多选票的方法。这就是它在标准化小组中的工作方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-18T23:08:16.710

该名称来自“主谓宾”。这些是连接主体和对象的属性，与仅仅是属性的数据类型属性相反。

# javascript - 敲除绑定无法按预期操作可观察数组

> ID：13131371
> 
> 赞同：3
> 
> 时间：2012-10-29T23:57:10.357
> 
> 标签：javascript, razor, knockout.js, ko.observablearray

我们有一个使用 Razor 和 Knockout.js 的视图来显示一个表单。表单的一部分要求用户输入值列表，我们使用 a`ko.observablearray`来跟踪它们。该列表表示为一堆文本框，每个值一个，每个框旁边都有一个“删除”按钮，所有框下方都有一个“添加”按钮。它的工作方式类似于[http://learn.knockoutjs.com/#/?tutorial=collections](http://learn.knockoutjs.com/#/?tutorial=collections)上的演示项目。

我们的表单以两种方式出现意外：

1.  单击删除按钮时，它会从 中删除所有值`ko.observablearray`，而不仅仅是与单击的内容相对应的值。
2.  当点击整个表单的“提交”按钮时，它会添加一个新元素，`ko.observablearray`而不是将表单提交到我们的服务器。

为什么我们会看到这种行为？（我知道这是两个独立的问题，但我不确定它们是否是由相同的潜在问题引起的，这就是我将它们发布在一个问题中的原因。）

这是我们的 Razor 视图：

```
@model OurProject.Models.Input.InputModel
@{
    ViewBag.Title = "Input";
}

<h2>Inputs</h2>

<div id="inputForm">
    <!-- snip - lots of input elements to fill in that are bound to KO -->

    <div>
        @Html.LabelFor(model => model.POSTransactionCodes)
    </div>
    <div>
        <span class="help-block">Separate values by commas.</span>
    </div>
    <div>
        <ul data-bind="foreach: POSTransactionCodes">
            <li><input data-bind="value: $data" /> <a href="#" data-bind="click: $root.removePOSTransactionCode">Delete</a></li>
        </ul>
        <button data-bind="click: addPOSTransactionCode">Add another POS Transaction Code</button>

        @Html.ValidationMessageFor(model => model.POSTransactionCodes, null, new { @class = "help-inline" })
    </div>
    <!-- snip - more input elements -->

    <button data-bind="click: save">Submit</button>
</div>

<script type="text/javascript" src='~/Scripts/jquery-1.8.2.min.js'></script>
<script type="text/javascript" src='~/Scripts/knockout-2.1.0.js'></script>
<script type="text/javascript" src='~/Scripts/OP/OP.js'></script>
<script type="text/javascript" src='~/Scripts/OP/Input/OP.Input.Input.Form.js'></script>
<script type="text/javascript" src='~/Scripts/OP/Input/OP.Input.Input.Data.js'></script>
<script type="text/javascript">
    var elementToBindTo = $("#inputForm")[0];
    OP.Input.Input.Form.init(elementToBindTo);
</script> 
```

这是我们的主要敲除代码 OP.Input.Input.Form.js：

```
extend(OP, 'OP.Input.Input.Form');
OP.Input.Input.Form = function (jQuery) {
    //The ViewModel for the page
    var ViewModel = function () {
        var self = this;

        //Fields
        /* snip - lots of ko.observables() */
        self.POSTransactionCodes = ko.observableArray([]); //is a list of transaction codes
        /* snip - lots of ko.observables() */

        //Set up with initial data
        self.initialize = function () {
            var c = function (data, status, response) {
                if (status === "success") {
                    /* snip - lots of ko.observables() */
                    ko.utils.arrayPushAll(self.POSTransactionCodes, data.POSTransactionCodes);
                    self.POSTransactionCodes.valueHasMutated();
                    /* snip - lots of ko.observables() */
                } else {

                }
            };
            OP.Input.Input.Data.GetInput(c);
        }

        //When saving, submit data to server
        self.save = function (model) {
            var c = function (data, status, response) {
                if (status === "success") {
                    //After succesfully submitting input data, go to /Input/Submitted
                    //in order to let MVC determine where to send the user next
                    window.location.href = "~/Input/Submitted";
                } else {
                }
            };
            OP.Input.Input.Data.SaveInput(model, c);
        }

        //Modifying POSTransactionCodes array
        self.removePOSTransactionCode = function (POScode) {
            self.POSTransactionCodes.remove(POScode)
        }

        self.addPOSTransactionCode = function () {
            self.POSTransactionCodes.push("");
        }
    };

    //Connect KO form to HTML
    return {
        init: function (elToBind) {
            var model = new ViewModel();
            ko.applyBindings(model, elToBind);
            model.initialize();
        }
    };
} ($); 
```

这是 OP.Input.Input.Data.js：

```
extend(OP, 'OP.Input.Input.Data');
OP.Input.Input.Data = {
    GetInput: function (callback) {
        $.get("/API/Input/InputAPI/GetInputModel", callback);
    },
    SaveInput: function (input, callback) {
        $.ajax({
            url: "/API/Input/InputAPI/SaveInput",
            type: "post",
            data: input,
            complete: callback
        });
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T11:07:53.660

您需要将一个新的 ViewModel 推送到您的可观察数组中。它将包含可观察的属性。

为此，我创建了一个名为 TransactionCodeView 的新视图模型

```
var TransactionCodeView = function() {
  var self = this;
  self.code = ko.observable("");    
}; 
```

然后当用户点击“添加另一个 POS 交易代码”时：

```
self.addPOSTransactionCode = function () {
    self.POSTransactionCodes.push(new TransactionCodeView());
} 
```

唯一改变的是 HTML 绑定：

```
<li><input data-bind="value: code" /> <a href="#" data-bind="click: $root.removePOSTransactionCode">Delete</a></li> 
```

因为`code`是新视图模型中的可观察属性，所以我们将`input`值绑定到该属性。

看看这个[jsfiddle](http://jsfiddle.net/VZnb6/)。由于明显的原因，我没有测试提交功能;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:30:21.113

这就是为什么提交功能在我的表单上不起作用的原因：

在视图中，我有这个 Razor：

```
<div>
    <ul data-bind="foreach: POSTransactionCodes">
        <li><input data-bind="value: $data" /> <a href="#" data-bind="click: $root.removePOSTransactionCode">Delete</a></li>
    </ul>
    <button data-bind="click: addPOSTransactionCode">Add another POS Transaction Code</button>

    @Html.ValidationMessageFor(model => model.POSTransactionCodes, null, new { @class = "help-inline" })
</div> 
```

为我的“添加”按钮使用该`button`元素会导致它响应用户按下回车而不是表单末尾的提交按钮。当我将按钮改为`input`元素时，它开始按预期工作。

```
<input type="button" value="Add another POS Transaction Code"
    data-bind="click: addPOSTransactionCode" /> 
```

# javascript - 在 PhoneGap 应用程序中单击时，如何防止图像被选中？

> ID：13131372
> 
> 赞同：0
> 
> 时间：2012-10-29T23:57:43.417
> 
> 标签：javascript, android, html, cordova, webview

当用户按如下方式点击添加到 PhoneGap 应用程序的图像时，该图像似乎已被选中

```
<img src="image.png" onclick="action()"> 
```

这是在 Android 4.1 上。

我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T10:12:59.347

您可以使用`div`标签来防止选择和拖动图像。这是一个示例代码

```
<div style='background: url("image.png");" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T15:15:09.790

在您的 CSS 中添加：

```
* {
-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
} 
```

这应该会为您禁用点击突出显示。

# c# - 如何在资源中存储目录结构？

> ID：13131377
> 
> 赞同：2
> 
> 时间：2012-10-29T23:57:55.457
> 
> 标签：c#, .net, embedded-resource

我正在为基于 .NET 的 CMS 编写一个插件，我想在它第一次运行时解压一棵 javascript、CSS 和图像文件树。因为我只想发送一个 dll，所以我打算压缩这些目录并将它们存储为资源。然后当插件运行时，它会检查必要的文件是否存在，如果不存在，它将解压缩它们。

我知道资源是“扁平的”，因为您无法设置目录结构，因此某种形式的打包是我能看到的唯一方法。

**问题是**，首先，这是可以接受的事情吗？其次，.NET 中是否有任何库可以让我这样做？我想如果我想使用内置插件，我可能不得不使用 GZip 而不是 Zip，但是有没有首选的方法来做我想要实现的目标？

* * *

只是为这个问题添加一些东西 - 我知道一个常见的方案是使用 .tar.gz，我目前正在这样做。但由于某种原因，这让我觉得不是最理想的，因为我必须导入外部库才能像这样工作。我认为这可能是一件很常见的事情，可以通过一种或两种方式在本地进行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:30:11.097

有几种方法可以打包和压缩 .net [http://msdn.microsoft.com/en-us/library/system.io.packaging.aspx](http://msdn.microsoft.com/en-us/library/system.io.packaging.aspx)附带的文件组（我认为在 .net 3.0 中发布）和[http://msdn.microsoft.com/en-us/library/system.io.compression.aspx（.Net](http://msdn.microsoft.com/en-us/library/system.io.compression.aspx) 4.5 中的新功能）

您还可以使用几个免费的开源库（Sharp Zip 库： http: [//www.icsharpcode.net/opensource/sharpziplib/](http://www.icsharpcode.net/opensource/sharpziplib/)和 DotNetZip 库[http://dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/)）。可能还有其他人。我已经使用了它们以及 Packaging api。我喜欢 DotNetZip，因为它易于使用，但你可以很快地使用它们中的任何一个。

压缩资源是有意义的——这是对空间的巧妙利用——但你的资源不必直接映射到你将如何/在哪里提取它们（因为你编写代码来提取和编写可以存储它们的资源如果它更有意义，则平坦）。

# asp.net-mvc - 调试模式下的 ASP.NET 4.5 捆绑 - 过时的资源

> ID：13131381
> 
> 赞同：4
> 
> 时间：2012-10-29T23:58:24.290
> 
> 标签：asp.net-mvc, asp.net-4.5, asp.net-optimization, bundling-and-minification

有什么方法可以让 ASP.NET 4.5 捆绑功能在**调试**模式下运行时生成 GUID 作为查询字符串的一部分（例如捆绑关闭）。

问题是在本地开发时，脚本/CSS文件是这样生成的：

```
<script type="text/javascript" src="/Content/Scripts/myscript.js" /> 
```

因此，如果我更改该文件，我需要进行硬刷新（有时几次）以使浏览器拾取该文件 - 烦人。

有什么办法可以让它像这样渲染：

```
<script type="text/javascript" src="/Content/Scripts/myscript.js?v=x" /> 
```

GUID在哪里`x`（例如始终唯一）。

想法？

我在 ASP.NET MVC 4 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T00:03:19.390

在按照上面的其他答案对 NuGet 包进行修补之前，现在我最终使用了与测试版 NuGet 包相同的包装器代码：

```
private static IHtmlString JsUnbundled(this HtmlHelper htmlHelper, string bundlePath)
{
    var jsBuilder = new StringBuilder();
    foreach (var file in BundleResolver.Current.GetBundleContents(bundlePath))
    {
        var tagBuilder = new TagBuilder("script");
        tagBuilder.Attributes["src"] = file.AddCacheKey(); // add GUID
        tagBuilder.Attributes["type"] = "text/javascript";
        jsBuilder.AppendLine(tagBuilder.ToString());
    }
    return MvcHtmlString.Create(jsBuilder.ToString());
} 
```

然后我有另一个 HTML 帮助程序，它检查是否调试，然后使用上面的 - 否则使用`Scripts.Render`.

显然，这不会对文件进行任何类型的散列 - 它总是会请求文件。但我不介意这一点，因为它仅用于调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T16:58:40.097

我们目前不在调试模式下检查文件的内容，但我们可以添加此功能。

[我在这里](http://aspnetoptimization.codeplex.com/workitem/40)将其作为 codeplex 上的问题提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-11T20:50:21.073

试试 HashCache：[https ://github.com/kemmis/System.Web.Optimization.HashCache](https://github.com/kemmis/System.Web.Optimization.HashCache)

将所有捆绑包添加到集合后，对 BundlesCollection 实例执行 ApplyHashCache() 扩展方法。

```
BundleTable.Bundles.ApplyHashCache(); 
```

这将在调试模式下将内容哈希添加到脚本/样式标签输出。

# javascript - Emberjs 代码乱序运行

> ID：13131384
> 
> 赞同：1
> 
> 时间：2012-10-29T23:58:49.243
> 
> 标签：javascript, ember.js

在这里，RootView 绘制了一个初始视图，然后创建了一个 BranchObj，它在其 init 函数中查找 RootView 的 branchView 并尝试将另一个视图粘贴到它上面。

问题是，即使第 1 行（应该导致控制台记录“1”）写在第 2 行（应该导致控制台记录“2”）之前，控制台也会在“1”之前记录“2”，这给出了一个错误，因为 BranchObj 在 RootView 的 branchView 中找不到它正在寻找的视图。

如何使这两个函数以正确的顺序运行？

```
App.RootView = Ember.CollectionView.extend({
  ...

  didInsertElement: function() {
    //draw this branch
    var branchView = App.BranchView.create();
    this.set("branchView",branchView);
    this.get("childViews").pushObject(branchView); //Line 1

    //draw a child
    App.BrachObj.create({parentView:this}); //Line 2
  }
});

App.BranchView = App.RaphaelView.extend({
  didInsertElement: function() {
    console.log(1);
  },
  ...
});

App.BranchObj = Ember.Object.extend({
  init: function() {
    console.log(2);
  },
  ...
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T06:08:28.287

来自 CollectionView 上的 Ember 文档[http://emberjs.com/api/classes/Ember.ContainerView.html](http://emberjs.com/api/classes/Ember.ContainerView.html)

> 不应直接操作 CollectionView 的 childViews 属性。相反，从其内容属性中添加、删除、替换项目。这将触发对其呈现的 HTML 的适当更改。

使用 pushObject 的直接数组操作似乎不会触发 didInsertElement 事件。相反，它是在 BranchObj 初始化之后触发的（第 2 行）。尝试使用 content 属性进行操作。

# php - PHP 浏览器检测 IE > 6

> ID：13131392
> 
> 赞同：3
> 
> 时间：2012-10-29T23:59:44.720
> 
> 标签：php, browser

好的，所以我在我的公司 repo 中处理一些代码，我在登录检查中偶然发现了这一点浏览器检测。这几乎专门搜索 MSIE，但如果浏览器版本是，则希望拒绝登录`<= 6`。目前这是一个相当有缺陷的概念。看到该方法采用用户代理字符串并删除除版本号之外的所有内容，但是在这种情况下，版本号是一个数字，非常适合版本 1-9 检测。然而，对于 Internet Explorer 10，结果为 1，从而打破了逻辑并使其无用。

所以现在我被困在试图让这个逻辑在很大程度上保持不变，但本质上是为了补偿需要 2 位数字的版本，比如 10+

自从我完成任何特定于版本的浏览器检测以来已经有很长时间了。所以我希望有人可以帮助我稍微调整一下，或者指出我可以在同一个庄园中使用的一些更好/更新的功能。

```
if (isset($_SERVER['HTTP_USER_AGENT'])) {
    $ua = $_SERVER['HTTP_USER_AGENT'];
    if (strstr($ua,'MSIE') && substr($ua,strpos($ua,'MSIE')+5,1) <= 6 ) {
        return $this->renderMessage(
            self::TEXT_LOGIN_FAILED,
            'It seems that your browser is currently unsupported. We apologize for any inconveniences. Please switch to another browser and try again.'
            );
    }
} 
```

以上是我目前正在使用的内容，您可以看到它有点混乱，制作它的人最初并没有想太多。我坚持不想打破它，因为我想保持相似，但如果这有任何意义的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:08:00.483

像这样的东西怎么样：

```
$ua_array = explode(' ', $_SERVER['HTTP_USER_AGENT']);
$msie_key = array_search('MSIE', $ua_array);
if($msie_key !== false) { // you found MSIE browser
    $msie_version_key = $msie_key + 1;
    $msie_version = intval($ua_array[$msie_version_key]);
    if ($msie_version <= 6) {
        // reject user
    }
} 
```

# php - 如何将字符串变量放入css中？

> ID：13131395
> 
> 赞同：1
> 
> 时间：2012-10-29T23:59:54.737
> 
> 标签：php, css, variables, associative-array, background-repeat

这显示图像

```
<img src=\"'.($img).'\" alt=\"\" /> 
```

我想把它放在我可以在css中使用它作为背景图像的地方，以便重复，我能想到的唯一方法是将它变成css中的背景图像。

```
<style>
background-image: ???;
background-repeat: y;
</style> 
```

总的来说，我怎样才能把它（我相信一个关联数组）变成 css？

```
'.($img).' 
```

这是整个代码：

```
function add_logo_css() {
    $img = get_option('add_logo_logo');
    if(!empty($img))
        echo '<style type="text/css">
#admin-logo { margin: 10px 0; padding: 0 0 5px; border-bottom: 1px solid #ddd;  position:absolute; margin-left: 165px; width:100%; }
</style>'."\n";
}

function add_logo_script() {
    $img = get_option('add_logo_logo');
    if(!empty($img))
        echo '<script type="text/javascript">
/* <![CDATA[ */
(function($) {
    $("#wpwrap").prepend("<div id=\"admin-logo\">
<img src=\"'.($img).'\" alt=\"\" /></div>");
})(jQuery);
/* ]]> */
</script>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:03:41.740

您可以为此使用 javascript：

```
<img id="myImg" alt="" />
<script language="text/javascript">
    document.getElementById("myImg").style="background-image: url('.($img).'); background-repeat: repeat-y;";
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:06:37.573

我希望该变量是一个 PHP 字符串变量，其中包含一个图像 url，并且在输出样式标签时您当前处于一个 php 块中。如果是这样，这个巫毒应该起作用。

```
<style>
  background-image: url("'.$img.'");
  background-repeat: repeat-y; /* <~~ corrected */
</style> 
```

# python - 使用新格式字符串记录变量数据

> ID：13131400
> 
> 赞同：91
> 
> 时间：2012-10-30T00:00:38.677
> 
> 标签：python, python-2.7, string-formatting

我使用 python 2.7.3 的日志记录工具。[这个 Python 版本的文档说](http://docs.python.org/2/howto/logging.html)：

> 日志记录包早于更新的格式化选项，例如 str.format() 和 string.Template。支持这些较新的格式选项...

我喜欢带有花括号的“新”格式。所以我正在尝试做类似的事情：

```
 log = logging.getLogger("some.logger")
 log.debug("format this message {0}", 1) 
```

并得到错误：

> TypeError：字符串格式化期间并非所有参数都转换了

我在这里想念什么？

PS我不想用

```
log.debug("format this message {0}".format(1)) 
```

因为在这种情况下，无论记录器级别如何，消息总是被格式化。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-30T00:39:53.197

**编辑：**看看[`StyleAdapter`@Dunes 的答案](https://stackoverflow.com/a/24683360/4279)与这个答案不同的方法；它允许在调用记录器的方法（debug()、info()、error() 等）时使用没有样板的替代格式样式。

* * *

来自文档 -[使用替代格式样式](http://docs.python.org/3/howto/logging-cookbook.html#use-of-alternative-formatting-styles)：

> 记录调用（logger.debug()、logger.info() 等）仅采用实际记录消息本身的位置参数，关键字参数仅用于确定如何处理实际记录调用的选项（例如 exc_info 关键字参数表示应该记录回溯信息，或者额外的关键字参数表示要添加到日志中的附加上下文信息）。因此，您不能直接使用 str.format() 或 string.Template 语法进行日志记录调用，因为在内部日志记录包使用 %-formatting 来合并格式字符串和变量参数。在保持向后兼容性的同时不会改变这一点，因为现有代码中的所有日志记录调用都将使用 %-format 字符串。

和：

> 但是，您可以通过一种方式使用 {}- 和 $- 格式来构建您的个人日志消息。回想一下，对于消息，您可以使用任意对象作为消息格式字符串，并且日志记录包将在该对象上调用 str() 以获取实际的格式字符串。

将此复制粘贴到`wherever`模块：

```
class BraceMessage(object):
    def __init__(self, fmt, *args, **kwargs):
        self.fmt = fmt
        self.args = args
        self.kwargs = kwargs

    def __str__(self):
        return self.fmt.format(*self.args, **self.kwargs) 
```

然后：

```
from wherever import BraceMessage as __

log.debug(__('Message with {0} {name}', 2, name='placeholders')) 
```

注意：实际格式化会延迟到需要时，例如，如果未记录 DEBUG 消息，则根本不执行格式化。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-09-23T19:51:14.967

这是另一个没有沙丘回答中提到的关键字问题的选项。它只能处理位置 ( `{0}`) 参数，而不能处理关键字 ( `{foo}`) 参数。它也不需要两次调用格式化（使用下划线）。它确实具有子类化的 ick 因素`str`：

```
class BraceString(str):
    def __mod__(self, other):
        return self.format(*other)
    def __str__(self):
        return self

class StyleAdapter(logging.LoggerAdapter):

    def __init__(self, logger, extra=None):
        super(StyleAdapter, self).__init__(logger, extra)

    def process(self, msg, kwargs):
        if kwargs.pop('style', "%") == "{":  # optional
            msg = BraceString(msg)
        return msg, kwargs 
```

你像这样使用它：

```
logger = StyleAdapter(logging.getLogger(__name__))
logger.info("knights:{0}", "ni", style="{")
logger.info("knights:{}", "shrubbery", style="{") 
```

当然，您可以取消标记`# optional`以强制通过适配器的所有消息使用新样式格式的检查。

* * *

*多年后阅读此答案的任何人请注意*：从**Python 3.2**开始，您可以[将样式参数](https://docs.python.org/3.2/howto/logging-cookbook.html#use-of-alternative-formatting-styles)与`Formatter`对象一起使用：

> 日志记录（从 3.2 开始）为这两种附加格式样式提供了改进的支持。Formatter 类得到了增强，可以采用一个额外的可选关键字参数，名为`style`. 这默认为`'%'`，但其他可能的值为`'{'`和`'$'`，它们对应于其他两种格式样式。默认情况下保持向后兼容性（如您所料），但通过显式指定样式参数，您可以指定与[`str.format()`](https://docs.python.org/3.2/library/stdtypes.html#str.format)or 一起使用的格式字符串[`string.Template`](https://docs.python.org/3.2/library/string.html#string.Template)。

文档提供了示例 `logging.Formatter('{asctime} {name} {levelname:8s} {message}', style='{')`

请注意，在这种情况下，您仍然无法`logger`使用新格式调用 。即，以下仍然不起作用：

```
logger.info("knights:{say}", say="ni")  # Doesn't work!
logger.info("knights:{0}", "ni")  # Doesn't work either 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-07-10T18:01:15.660

当我发现日志记录仅使用 printf 样式格式时，这是我对问题的解决方案。它允许记录调用保持不变——没有特殊的语法，例如`log.info(__("val is {}", "x"))`. 代码所需的更改是将记录器包装在`StyleAdapter`.

```
from inspect import getargspec

class BraceMessage(object):
    def __init__(self, fmt, args, kwargs):
        self.fmt = fmt
        self.args = args
        self.kwargs = kwargs

    def __str__(self):
        return str(self.fmt).format(*self.args, **self.kwargs)

class StyleAdapter(logging.LoggerAdapter):
    def __init__(self, logger):
        self.logger = logger

    def log(self, level, msg, *args, **kwargs):
        if self.isEnabledFor(level):
            msg, log_kwargs = self.process(msg, kwargs)
            self.logger._log(level, BraceMessage(msg, args, kwargs), (), 
                    **log_kwargs)

    def process(self, msg, kwargs):
        return msg, {key: kwargs[key] 
                for key in getargspec(self.logger._log).args[1:] if key in kwargs} 
```

用法是：

```
log = StyleAdapter(logging.getLogger(__name__))
log.info("a log message using {type} substitution", type="brace") 
```

值得注意的是，如果用于大括号替换的关键字包括`level`、`msg`、`args`、或`exc_info`，则此实现存在问题。这些是 的方法使用的参数名称。如果您需要这些名称之一，请修改以排除这些名称或从呼叫中删除。进一步说明，此实现还默默地忽略了用于 Logger 的拼写错误的关键字（例如）。`extra``stack_info``log``Logger``process``log_kwargs``_log``ectra`

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-10-30T00:11:42.743

更简单的解决方案是使用[优秀的`logbook`模块](http://packages.python.org/Logbook/)

```
import logbook
import sys

logbook.StreamHandler(sys.stdout).push_application()
logbook.debug('Format this message {k}', k=1) 
```

或者更完整的：

```
>>> import logbook
>>> import sys
>>> logbook.StreamHandler(sys.stdout).push_application()
>>> log = logbook.Logger('MyLog')
>>> log.debug('Format this message {k}', k=1)
[2017-05-06 21:46:52.578329] DEBUG: MyLog: Format this message 1 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-03-29T20:59:32.707

* * *

更新：现在 PyPI 上有一个名为[bracelogger](https://pypi.org/project/bracelogger/)的包，它实现了下面详述的解决方案。

* * *

要为日志消息启用大括号样式格式，我们可以对一些记录器代码进行猴子补丁。

以下修补`logging`模块以创建一个`get_logger`函数，该函数将返回一个记录器，该记录器对其处理的每个日志记录使用新样式格式。

```
import functools
import logging
import types

def _get_message(record):
    """Replacement for logging.LogRecord.getMessage
    that uses the new-style string formatting for
    its messages"""
    msg = str(record.msg)
    args = record.args
    if args:
        if not isinstance(args, tuple):
            args = (args,)
        msg = msg.format(*args)
    return msg

def _handle_wrap(fcn):
    """Wrap the handle function to replace the passed in
    record's getMessage function before calling handle"""
    @functools.wraps(fcn)
    def handle(record):
        record.getMessage = types.MethodType(_get_message, record)
        return fcn(record)
    return handle

def get_logger(name=None):
    """Get a logger instance that uses new-style string formatting"""
    log = logging.getLogger(name)
    if not hasattr(log, "_newstyle"):
        log.handle = _handle_wrap(log.handle)
    log._newstyle = True
    return log 
```

用法：

```
>>> log = get_logger()
>>> log.warning("{!r}", log)
<logging.RootLogger object at 0x4985a4d3987b> 
```

* * *

笔记：

*   与普通的日志记录方法完全兼容（只需替换`logging.getLogger`为`get_logger`）
*   只会影响`get_logger`函数创建的特定记录器（不会破坏第 3 方包）。
*   消息的格式会延迟到输出（如果日志消息被过滤，则根本不会）。
*   Args 像往常一样存储在`logging.LogRecord`对象上（在某些情况下对自定义日志处理程序很有用）。
*   适用于从 2.7 到 3.10 的所有 Python 版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-16T00:59:24.080

`logging.setLogRecordFactory`在 Python 3.2+ 中尝试：

```
import collections
import logging

class _LogRecord(logging.LogRecord):

    def getMessage(self):
        msg = str(self.msg)
        if self.args:
            if isinstance(self.args, collections.Mapping):
                msg = msg.format(**self.args)
            else:
                msg = msg.format(*self.args)
        return msg

logging.setLogRecordFactory(_LogRecord) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-11T02:58:11.977

我创建了一个名为[ColorFormatter](https://pypi.org/project/out/)的自定义 Formatter来处理这样的问题：

```
class ColorFormatter(logging.Formatter):

    def format(self, record):
        # previous stuff, copy from logging.py…

        try:  # Allow {} style
            message = record.getMessage()  # printf
        except TypeError:
            message = record.msg.format(*record.args)

        # later stuff… 
```

这使它与各种库兼容。缺点是由于可能尝试两次格式化字符串，它可能性能不佳。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-05T14:45:40.500

与 pR0Ps' 类似的解决方案，[`getMessage`](https://github.com/python/cpython/blob/3.8/Lib/logging/__init__.py#L360)在应该启用新格式的情况下`LogRecord`通过包装[`makeRecord`](https://github.com/python/cpython/blob/3.8/Lib/logging/__init__.py#L1538)（而不是`handle`在他们的答案中）进行包装：`Logger`

```
def getLogger(name):
    log = logging.getLogger(name)
    def Logger_makeRecordWrapper(name, level, fn, lno, msg, args, exc_info, func=None, extra=None, sinfo=None):
        self = log
        record = logging.Logger.makeRecord(self, name, level, fn, lno, msg, args, exc_info, func, sinfo)
        def LogRecord_getMessageNewStyleFormatting():
            self = record
            msg = str(self.msg)
            if self.args:
                msg = msg.format(*self.args)
            return msg
        record.getMessage = LogRecord_getMessageNewStyleFormatting
        return record
    log.makeRecord = Logger_makeRecordWrapper
    return log 
```

我用 Python 3.5.3 对此进行了测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-27T21:51:29.917

结合`string.Formatter`添加`pprint.pformat`类型转换和 from `logging`: `setLogRecordFactory`, `setLoggerClass`. 有一个巧妙的技巧——我`args`为`Logger._log`方法的参数创建额外的嵌套元组，然后在`LogRecord`init 中解压它以省略在`Logger.makeRecord`. 使用`log.f wraps`每个属性（故意记录方法），`use_format`因此您不必显式编写它。该解决方案向后兼容。

```
from collections import namedtuple
from collections.abc import Mapping                                                     
from functools import partial                                                          
from pprint import pformat                                                              
from string import Formatter                                                        
import logging                

Logger = logging.getLoggerClass()                                                       
LogRecord = logging.getLogRecordFactory()                                               

class CustomFormatter(Formatter):                                                       
    def format_field(self, value, format_spec):                                         
        if format_spec.endswith('p'):                                                   
            value = pformat(value)                                                      
            format_spec = format_spec[:-1]                                              
        return super().format_field(value, format_spec)                                 

custom_formatter = CustomFormatter()                                                    

class LogWithFormat:                                                                    
    def __init__(self, obj):                                                            
        self.obj = obj                                                                  

    def __getattr__(self, name):                                                        
        return partial(getattr(self.obj, name), use_format=True)    

ArgsSmuggler = namedtuple('ArgsSmuggler', ('args', 'smuggled'))                                                                                     

class CustomLogger(Logger):                                                             
    def __init__(self, *ar, **kw):                                                      
        super().__init__(*ar, **kw)                                                     
        self.f = LogWithFormat(self)                                                    

    def _log(self, level, msg, args, *ar, use_format=False, **kw):                                         
        super()._log(level, msg, ArgsSmuggler(args, use_format), *ar, **kw)                                     

class CustomLogRecord(LogRecord):                                                       
    def __init__(self, *ar, **kw):                                                   
        args = ar[5]
        # RootLogger use CustomLogRecord but not CustomLogger
        # then just unpack only ArgsSmuggler instance
        args, use_format = args if isinstance(args, ArgsSmuggler) else (args, False)                                       
        super().__init__(*ar[:5], args, *ar[6:], **kw)                                  
        self.use_format = use_format                                                    

    def getMessage(self):                                                               
        return self.getMessageWithFormat() if self.use_format else super().getMessage() 

    def getMessageWithFormat(self):                                                     
        msg = str(self.msg)                                                             
        args = self.args                                                                
        if args:                                                                        
            fmt = custom_formatter.format                                               
            msg = fmt(msg, **args) if isinstance(args, Mapping) else fmt(msg, *args)    
        return msg                                                                      

logging.setLogRecordFactory(CustomLogRecord)      
logging.setLoggerClass(CustomLogger)              

log = logging.getLogger(__name__)   
log.info('%s %s', dict(a=1, b=2), 5)          
log.f.info('{:p} {:d}', dict(a=1, b=2), 5) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-05-25T22:21:26.110

这里有一些非常简单的方法：

```
debug_logger: logging.Logger = logging.getLogger("app.debug")

def mydebuglog(msg: str, *args, **kwargs):
    if debug_logger.isEnabledFor(logging.DEBUG):
        debug_logger.debug(msg.format(*args, **kwargs)) 
```

然后：

```
mydebuglog("hello {} {val}", "Python", val="World") 
```

# php - mysql_query(INSERT ...) 函数在我的代码中不起作用

> ID：13131401
> 
> 赞同：1
> 
> 时间：2012-10-30T00:00:41.547
> 
> 标签：php, mysql, database, web, phpmyadmin

我创建了数据库，它基本上接受名称和 ID 以及长度为 47 的答案字符串，我的 php 代码将根据我提供的答案键对传入的结果进行评分，并且包含正确答案计数的数字将存储在数据库中。这是我的数据库的信息。数据库名称是标记和名为“答案”的表，它有以下 5 个字段

```
1) answer_id :int , not null, auto increament.
2) name: text
3)id : text
4)answers : text
5)correct : int 
```

我的问题和问题是该功能正在运行

```
// setup query
$q = mysql_query("INSERT INTO `answer` VALUES 
 (NULL,'$name', '$id','$answers','$correct')");
// run query
$result = mysql_query($q); 
```

或者以另一种方式，我的数据库中没有存储任何东西？？？

提前致谢。

这是整个程序。

```
<?php
error_reporting(E_ALL ^ E_STRICT);
// to turn error reporting off 
error_reporting(0);

$name  =$_POST['name']; 
$id = $_POST['id']; 
$answers = $_POST['answers'];

// check the length of string
if(strlen($answers) !=10) 
{
print'your answer string must be 10';

return;

} 
mysql_connect("localhost","root",""); 
mysql_select_db("marking"); 
$name = addslashes($name); 
$id = addslashes($id); 
$answers =  addslashes($answers); 
$answer_key =  "abcfdbbjca"; 
$correct =  0; 
for($i=0;$i<strlen($answer_key);$i++) 
{

if($answer_key[$i]  == $answers[$i])

$correct++;

} 
 //  Setup query
$q = mysql_query("INSERT INTO `answer` VALUES ('$name', '$id','$answers','$correct')");
$result = mysql_query($q);
print 'Thnak you. You got' + $correct + 'of 10 answers correct'; 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:07:45.830

Try this:

```
// setup query
$q = "INSERT INTO `answer` (`name`, `id`, `answers`, `correct`) VALUES 
 ('$name', '$id','$answers','$correct')";

//Run Query
$result = mysql_query($q) or die(mysql_error()); 
```

Also, you should avoid using `mysql_` functions as they are in the process of being deprecated. Instead, I recommend you familiarize yourself with [PDO](http://php.net/manual/en/book.pdo.php).

Also, note, the `or die(mysql_error())` portion should not be used in production code, only for debugging purposes.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:07:27.250

Two things.

You are actually executing the query twice. `mysql_query` executes the query and returns the result resource. [http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

And also, you are quoting the `int` column `correct` in your query, as far as I know, you can't do that (I could be wrong there).

```
$result = mysql_query("INSERT INTO `answer` VALUES (NULL,'$name', '$id','$answers',$correct)"); 
```

**EDIT:** Turns out I'm actually wrong, you may disregard my answer.

# ios - 不可访问元素上的 UIAutomation

> ID：13131405
> 
> 赞同：1
> 
> 时间：2012-10-30T00:01:15.333
> 
> 标签：ios, testing, accessibility, instruments, ui-automation

我的视图上有几个按钮将 isAccessibilityElement 设置为 NO。

无论如何通过使用茉莉脚本的仪器通过 UIAutomation 测试这些元素？

# java - 向 Serializable 类添加方法对序列化对象的大小有影响吗？

> ID：13131409
> 
> 赞同：1
> 
> 时间：2012-10-30T00:01:50.177
> 
> 标签：java, android, sockets, serializable

这适用于我需要通过蓝牙将 Serializable 对象（也称为 BallPackage）发送到另一台设备的 Android 应用程序。

由于这样做了很多次，所以对象的大小有点重要。当然，我可以轻松地将这些方法移动到另一个类，但如果它们在 BallPackage 类上，它会感觉更“有条理”。

底线是，我担心向可序列化的类/对象添加方法会增加其序列化对应物，也会增加通过套接字发送的包大小。这真的是个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:09:23.867

不，序列化数据不包含代码。

# java - Java中“field”和“this.field”的区别

> ID：13131410
> 
> 赞同：1
> 
> 时间：2012-10-30T00:02:07.067
> 
> 标签：java

我想更好地理解通过单独使用 this.field 和 field 来引用类字段有什么区别，如

```
this.integerField = 5; 
```

和

```
integerField = 5; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T00:03:52.333

`this`关键字是指当前的`object`. 通常我们`this.memberVariable`用来区分成员变量和局部变量

```
private int x=10;

     public void m1(int x) {
      sysout(this.x)//would print 10 member variable
      sysout(x); //would print 5; local variable
      } 

   public static void main(String..args) {
      new classInst().m1(5);

   } 
```

从具体问题出发，使用`this`In `Overloaded constructors`：

我们可以使用它来调用重载的构造函数，如下所示：

```
public class ABC {
     public ABC() {
      this("example");to call overloadedconstructor
      sysout("no args cons");
     }
      public ABC(String x){
         sysout("one argscons")
        }

 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T00:07:11.340

使用`this`关键字可以消除成员变量和局部变量之间的歧义，例如函数参数：

```
public MyClass(int integerField) {
    this.integerField = integerField;
} 
```

上面的代码片段将局部变量的值赋给`integerField`了同名类的成员变量。

一些商店采用编码标准，要求所有会员访问都必须符合`this`. 这是有效的，但没有必要；在不存在冲突的情况下，删除`this`不会改变程序的语义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T00:07:51.723

当您在实例方法中时，您可能需要指定从哪个范围引用变量。例如 ：

```
private int x;

public void method(int x) {
    System.out.println("Method x   : " + x);
    System.out.println("Instance x : " + this.x);
} 
```

而在本例中，您有两个`x`变量，一个是本地方法变量，一个是类变量。您可以区分这两者`this`以指定它。

有些人总是`this`在使用类变量之前使用。虽然这不是必需的，但它可以提高代码的可读性。

至于多态性，您可以将父类称为`super`. 例如 ：

```
class A {
    public int getValue() { return 1; }
}
class B extends A {
    // override A.getValue()
    public int getValue() { return 2; }

    // return 1 from A.getValue()
    // have we not used super, the method would have returned the same as this.getValue()
    public int getParentValue() { return super.getValue(); }   
} 
```

两个关键字都`this`取决于`super`您使用它的范围；它取决于您在运行时使用的实例（对象）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T00:03:43.907

完全一样。因为您经常键入`this.xyz`它是一个快捷方式，如果存在该名称的字段并且没有隐藏它的局部变量，则意味着相同的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T00:09:49.370

尽管它们的外观和行为相同，但在字段和方法参数之间共享相同名称时会有所不同，例如：

```
private String name;

public void setName(String name){

    this.name = name;

} 
```

`name`是传递的参数，并且`this.name`是正确的类字段。请注意，键入`this.`... 会提示您列出许多 IDE 中的所有类字段 [和方法]。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T00:14:11.943

来自[Java 教程](http://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html)：

> 在实例方法或构造函数中，this 是对当前对象的引用——调用其方法或构造函数的对象。您可以使用 this 从实例方法或构造函数中引用当前对象的任何成员。

因此，当您在对象中调用方法时，调用看起来像这样：

```
public class MyClass{

    private int field;

    public MyClass(){
        this(10); // Will call the constructor with a int argument
    }

    public MyClass(int value){
    }

    //And within a object, the methods look like this
    public void myMethod(MyClass this){ //A reference of a object of MyClass
        this.field = 10; // The current object field
    }

} 
```

# r - 如何确定直方图的区间

> ID：13131411
> 
> 赞同：-2
> 
> 时间：2012-10-30T00:02:11.643
> 
> 标签：r, plot, histogram

我正在尝试一个简单的直方图

```
hist(c(-2,-1,0,1,2)) 
```

对于上述代码，直方图的频率等于 -2 到 -1 的 2。

我不太明白 R 如何将值放置在它给出的图中的区间内。我的意思是，这里的频率（y 轴）不应该一直等于 1，因为没有重复？

另外，我不太明白该范围是如何工作的，是包含上限/包含下限还是..？[,) 或 (,] 或 [,] 或 (,) ..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:06:47.860

All your questions can be answered by reading the help file for `hist`, `help('hist')` or `?hist`

There are arguments `include.lowest` and `right` which both default to `TRUE`

Quoting from the help

> -*include.lowest*
> 
> logical; if TRUE, an x[i] equal to the breaks value will be included in the first (or last, for right = FALSE) bar. This will be ignored (with a warning) unless breaks is a vector.
> 
> -*right*
> 
> logical; if TRUE, the histogram cells are right-closed (left open) intervals.

# php - 如何让我的 jQuery 和 PHP 与 ajax 一起工作？

> ID：13131417
> 
> 赞同：0
> 
> 时间：2012-10-30T00:03:34.100
> 
> 标签：php, jquery, post

我已经看到了一些类似的问题，但我还没有看到任何具体说明这一点的问题。我创建了一个非常简单的示例，我觉得它应该可以工作，但事实并非如此。关键是看一些简单的东西，这样其他类似的东西就清楚了。

我觉得这很“基础”，很难简单得多；所以，人们应该能够支持它，知道它是终极的菜鸟垫脚石：

HTML 和 JS：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<script type="javascript"></script>
<script type="text/javascript" src="/javascript/jquery-1.8.2.js">
$(document).ready(function(){
    $("submit").click(function(){
        var req = $.ajax({
                type: 'POST',
                url: 'form.php',
                data: {
                        message: $('#message').val(),
                        author: $('#author').val()
                },
                timeout: 20000,
                beforeSend: function(msg) {
                        $("#sent").html(msg);
                }
        });

        req.fail(function(xhr, ajaxOptions, thrownError) {
                alert("AJAX Failed");
        });

        req.done(function(res) {
                 $("#received").html(res);
        });
    });
});
</script>
</head>
<body>
<div id="sent"></div>
<div id="form">
<form>  
    Your message:  <input type="text" name="message" value="Hi!" /><br />
    Your name: <input type="text" name="author" value="Michael" /><br />
    <input type="submit" name="submit" value="Submit me!" />
</form>
</div>
<div id="received"></div>
</body>
</html> 
```

和 PHP：

```
<?php 
  echo "The file is located at ".$_POST["message"].".<br>";
  echo "The file is named ".$_POST["author"]."."; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:42:01.343

您可以使用 serialize 而不是将 id 分配给输入字段：

```
<html>
<head>
<script type="javascript"></script>
<script type="text/javascript" src="/javascript/jquery-1.8.2.js">
$(document).ready(function(){
$("#submit").click(function(){
    var req = $.ajax({
            type: 'POST',
            url: 'form.php',
            data: $('#frm').serialize(),
            timeout: 20000,
            beforeSend: function(msg) {
                    $("#sent").html(msg);
            },
            success: function(data){
                alert('Success!Data was received by php.Message from the php script:'+data.res);
            }
    });

    req.fail(function(xhr, ajaxOptions, thrownError) {
            alert("AJAX Failed");
    });

    req.done(function(res) {
             $("#received").html(res);
    });
});});

</script>
</head>
<body>
<div id="sent"></div>
<div id="form">
<form id="frm">  
Your message:  <input type="text" name="message" value="Hi!" /><br />
Your name: <input type="text" name="author" value="Michael" /><br />
<input type="submit" id="submit" value="Submit me!" />
</form>
</div>
<div id="received"></div>
</body>
</html> 
```

PHP脚本：

```
<?php 
if(isset($_POST['message']) && isset($_POST['author']))
{
    $arr_to_pass_as_json = array('res'=>'This is your message:'.$_POST['message'].' and your author '.$_POST['author']);
    echo json_encode($arr_to_pass_as_json)
}
else
    echo json_encode(array('res'=>'Message and Author is required')); 
```

我们使用 json 将结果从 php 显示到 javascript。希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:07:57.793

检查与此的区别：

```
$(document).ready(function(){
    $("submit").click(function(){
        var req = $.ajax({
                type: 'POST',
                url: 'form.php',
                data: {
                        message: $('#message').val(),
                        author: $('#author').val()
                },
                timeout: 20000,
                beforeSend: function(msg) {
                        $("#sent").html(data);
                }
        })

        .fail(function(xhr, ajaxOptions, thrownError) {
                alert("AJAX Failed");
        })

        .done(function(res) {
                 $("#received").html(res);
        });
    });
}); 
```

检查这是否有效（根据[http://api.jquery.com/jQuery.ajax/#jqXHR](http://api.jquery.com/jQuery.ajax/#jqXHR)它应该）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:14:54.017

自从你使用

```
message: $('#message').val(),
author: $('#author').val() 
```

您需要在输入 tgs 中指定您的 id。

```
<form>  
    Your message:  <input type="text" name="message" value="Hi!" id="message" /><br />
    Your name: <input type="text" name="author" value="Michael" id="author" /><br />
    <input type="submit" name="submit" value="Submit me!" />
</form> 
```

您要求查找和 html id selectyor，并从中获取值，“名称”与 ID 不同。

或者，您可以在 html 表单中添加 id 并使用 .sezialize()，但在此步骤中简单地添加 id 会更简单。 [http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

# android - 通过 Service 和 Activity 共享单例 java 类

> ID：13131418
> 
> 赞同：3
> 
> 时间：2012-10-30T00:03:38.917
> 
> 标签：android, service, android-activity, singleton

在 Android 应用程序中，Service 和 Activity 使用 Singleton Java 类是否存在潜在问题？

示例：Singleton 是 Singleton Activity 是一个 Service S

服务 S 有一个单例句柄。S 请求 Singleton 启动 Activity。Activity 调用 Singleton 中定义的操作方法。

我的应用程序中有几个单例，它们封装了功能区域的各种操作。所以Activity会和各种Singleton交互来执行各种操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:23:31.290

我认为这种方法没有问题。我经常使用单例，从来没有遇到任何问题。您只需要记住，android 可能会在需要内存时删除单例实例，因此每次获取单例实例时都需要检查 null。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T02:47:45.790

通常它不会引入问题。您可以预料到的唯一情况 - 使用在单独进程中运行的服务（服务定义了以“。”开头的[`android:process`属性）。](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestService_process)在这种情况下，您只需拥有两个单例实例 - 每个进程一个。

# php - 使用 ajax/php/javascript 进行动态 texbox 修改

> ID：13131424
> 
> 赞同：2
> 
> 时间：2012-10-30T00:04:05.513
> 
> 标签：php, javascript, html, ajax

我有两张桌子。company_details 和 company_specials。每个 company_details 可以有多个特价商品。[我在http://eurothermwindows.com/ed/admin.php](http://eurothermwindows.com/ed/admin.php)显示公司详细信息

在活动列中具有 0 的第一行和第四行来自 company_details，下面的行来自 company_specials。

目前，该代码允许动态修改 company_details 行，如该表中的 compid 所示。但是我希望它下面的行也可以动态修改，但它使用相同的 compid，我不确定如何在代码中将它们分开。

下面的代码是为 company_specials 生成的代码。我需要一种方法来唯一标识每一行并能够对其进行修改。
[http://pastebin.com/RAe9iwAP](http://pastebin.com/RAe9iwAP)

有人可以提供一些指导吗？我在想我可能需要唯一标识 company_specials 中的每个特价商品或设置某种指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T05:39:52.670

我需要一种方法来唯一标识每一行 A。你已经这样做了；

```
<tr id="<?php echo $compid; ?>" 
```

Q. 并且能够修改它。A. 在每行末尾添加一个输入按钮，然后`onclick="edit(<?php echo $compid; ?>)"`根据该行的 $compid 启动编辑周期。

然后使用 Javascript，您可以`<td></td>`像这样通过 tr 中的 $compid 提取行内的所有内容；

```
 var originalString = "<tr>" + document.getElementById(compid).innerHTML + "</tr>";
var targetArray = [];
$(originalString) /*.find("tr")*/ .each(function(index, tr) {
  targetArray = $("td", tr).map(function(index, td) {return $(td).text();});
}); 
```

所有`<td>`内容都将位于 targetArray 变量中，可访问以放入表单中进行编辑，如下所示；

```
document.getElementById("forminputid").value = targetArray[1]; 
```

# android - Android 不会创建第二个活动实例

> ID：13131425
> 
> 赞同：1
> 
> 时间：2012-10-30T00:04:44.583
> 
> 标签：android, android-intent, android-activity

我正在从我的 Application 类中的方法调用 startActivity，但没有调用活动的构造函数及其 onCreate 方法。The Application method is being called when a menu option (in the first activity instance) is selected, so the first activity is on top. 我没有为活动设置launchMode（即它是“标准”），并且没有调用onNewIntent。

但是，如果我复制 .java 文件（+ 重命名类并复制 AndroidManifest.xml 中的 Activity 条目），然后第二次使用新类调用 startActivity，它就可以正常工作。我需要创建一个未知的并且可能大量的这些活动，所以这不是一个解决方案，尤其是当您考虑所有重复的代码时。

如何强制 Android 创建此活动的多个实例？

# asp.net-mvc-3 - 查看 Azure 云服务 IIS 日志

> ID：13131430
> 
> 赞同：2
> 
> 时间：2012-10-30T00:05:56.670
> 
> 标签：asp.net-mvc-3, azure-web-roles

我创建了一个简单的 MVC3 站点，它显示 Azure 数据库中表中的数据。我创建了一个云服务来运行该站点并可以成功发布它。我还在 Azure 模拟器中成功运行了该站点。

我的问题是，当我选择显示数据的页面时，出现错误，因为我得到了默认错误页面。我想我的数据库连接设置正确，但我看不到任何日志。所以我的问题是：

*   IIS 日志在哪里？我想看看错误是什么。
*   是否有任何其他日志/诊断可用于查看问题所在？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-26T10:50:25.640

默认情况下，可能会记录某些内容的唯一位置是 Windows 应用程序事件日志。您需要将远程桌面连接到云服务实例（从 Azure 管理门户中的实例页面连接），然后打开事件查看器。

IIS 日志本身也应该可用，尽管按照正常的 IIS 日志，这些日志不包含异常详细信息。登录到实例时使用 IIS 管理器 > 应用程序 > 日志记录来查找位置。

正如 Magnus 所建议的，您应该使用诸如 Windows Azure 诊断和/或[ELMAH](https://code.google.com/p/elmah/)和/或 log4net 之类的东西将异常和诊断信息记录到可用于故障排除的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T09:01:28.897

我建议您使用 Windows Azure 诊断程序来收集您的日志。

您可以在这里阅读所有（设置和使用）：http: [//msdn.microsoft.com/en-us/library/windowsazure/gg433048.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg433048.aspx)

# symfony - 与 Symfony 2.0.18 一起使用的 FOSRestBundle 的正确版本是什么？

> ID：13131431
> 
> 赞同：0
> 
> 时间：2012-10-30T00:05:59.953
> 
> 标签：symfony, fosrestbundle

我正在尝试将我的 Symfony2 应用程序从 2.0.16 升级到 2.0.18。我遇到了看起来像 FOSRestBundle 的问题，所以我也升级了 FOSRestBundle（到他们在主分支上的最新提交），但这似乎会导致不同的问题。在我们详细介绍所有这些和故障排除之前，有人能告诉我哪个版本的 FOSRestBundle 可以合理地预期与 Symfony 2.0.18 一起使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T18:37:45.440

[FOSRestBundle](https://github.com/FriendsOfSymfony/FOSRestBundle/commit/c94952536a85872e3b168d9e6042a9e081255790)的最新主版本似乎可以与 Symfony 2.0.18 一起正常工作。

我通过从我的文件中删除它来取消固定 FOSRestBundle，`deps.lock`一切都很好。

这是我在升级 FOSRestBundle 之前遇到的错误：

```
PHP Strict standards:  Declaration of FOS\RestBundle\Routing\Loader\RestXmlCollectionLoader::getXmlErrors() should be compatible with that of Symfony\Component\Routing\Loader\XmlFileLoader::getXmlErrors() in /home/adamm/git/bv-bundles/SingleServerApplication/vendor/bundles/FOS/RestBundle/Routing/Loader/RestXmlCollectionLoader.php on line 137 
```

我使用的*是*FOSRestBundle 版本 d9a876803df61858ce3e8d3f0c934727638ad874。

# spring - 什么是 hibernate3-maven-plugin-3.0 的配置选项？

> ID：13131432
> 
> 赞同：0
> 
> 时间：2012-10-30T00:06:00.890
> 
> 标签：spring, hibernate, maven, hbm2ddl, hibernate3-maven-plugin

我似乎找不到任何有关 hbm2ddl 配置选项的文档。这是我的 pom.xml 中的内容：

```
<plugin>
    <!-- Run "mvn hibernate3:hbm2ddl" to generate schema -->
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>hibernate3-maven-plugin</artifactId>
    <version>3.0</version>

    <configuration>
        <hibernatetool>
            <annotationconfiguration
                    propertyfile="src/main/resources/hibernate.cfg.xml" />
            <hbm2ddl update="true" create="true" drop="true" export="false"
                     outputfilename="shemaDiff.ddl" format="true"
                     console="false"/>
        </hibernatetool>
    </configuration>
</plugin> 
```

如果我跑

```
mvn hibernate3:hbm2ddl 
```

它构建成功，但是当我检查时数据库是空的。

.script 文件如下所示：

```
SET DATABASE UNIQUE NAME HSQLDB3AAEB9E84A
SET DATABASE GC 0
SET DATABASE DEFAULT RESULT MEMORY ROWS 0
SET DATABASE EVENT LOG LEVEL 0
SET DATABASE SQL NAMES FALSE
SET DATABASE SQL REFERENCES FALSE
SET DATABASE SQL SIZE TRUE
SET DATABASE SQL TYPES FALSE
SET DATABASE SQL TDC DELETE TRUE
SET DATABASE SQL TDC UPDATE TRUE
SET DATABASE SQL TRANSLATE TTI TYPES TRUE
SET DATABASE SQL CONCAT NULLS TRUE
SET DATABASE SQL NULLS FIRST TRUE
SET DATABASE SQL UNIQUE NULLS TRUE
SET DATABASE SQL CONVERT TRUNCATE TRUE
SET DATABASE SQL AVG SCALE 0
SET DATABASE SQL DOUBLE NAN TRUE
SET DATABASE SQL LONGVAR IS LOB FALSE
SET DATABASE TRANSACTION CONTROL LOCKS
SET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED
SET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE
SET DATABASE TEXT TABLE DEFAULTS ''
SET FILES WRITE DELAY 500 MILLIS
SET FILES BACKUP INCREMENT TRUE
SET FILES CACHE SIZE 10000
SET FILES CACHE ROWS 50000
SET FILES SCALE 8
SET FILES LOB SCALE 32
SET FILES DEFRAG 0
SET FILES NIO TRUE
SET FILES NIO SIZE 256
SET FILES LOG TRUE
SET FILES LOG SIZE 50
CREATE USER SA PASSWORD DIGEST 'd41d8cd98f00b204e9800998ecf8427e'
ALTER USER SA SET LOCAL TRUE
CREATE SCHEMA PUBLIC AUTHORIZATION DBA
ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
GRANT DBA TO SA
SET SCHEMA SYSTEM_LOBS
INSERT INTO BLOCKS VALUES(0,2147483647,0) 
```

有趣的是，如果我设置 console="true"，它会打印正确的 sql 表设置：

```
create table ACCOUNT (
    ACCOUNT_ID integer generated by default as identity (start with 1),
    ...
);

create table ... etc. 
```

如果我降级到 2.2 版，那么插件如下所示：

```
<plugin>
    <!-- Run "mvn hibernate3:hbm2ddl" to generate schema -->
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>hibernate3-maven-plugin</artifactId>
    <version>2.2</version>
</plugin> 
```

并且（不更改任何其他内容）运行 mvn hibernate3:hbm2ddl，然后从带注释的类正确创建数据库表，并且 .script 文件反映了这一点：

```
SET DATABASE UNIQUE NAME HSQLDB3AAEB9E84A
SET DATABASE GC 0
SET DATABASE DEFAULT RESULT MEMORY ROWS 0
SET DATABASE EVENT LOG LEVEL 0
SET DATABASE SQL NAMES FALSE
SET DATABASE SQL REFERENCES FALSE
SET DATABASE SQL SIZE TRUE
SET DATABASE SQL TYPES FALSE
SET DATABASE SQL TDC DELETE TRUE
SET DATABASE SQL TDC UPDATE TRUE
SET DATABASE SQL TRANSLATE TTI TYPES TRUE
SET DATABASE SQL CONCAT NULLS TRUE
SET DATABASE SQL NULLS FIRST TRUE
SET DATABASE SQL UNIQUE NULLS TRUE
SET DATABASE SQL CONVERT TRUNCATE TRUE
SET DATABASE SQL AVG SCALE 0
SET DATABASE SQL DOUBLE NAN TRUE
SET DATABASE SQL LONGVAR IS LOB FALSE
SET DATABASE TRANSACTION CONTROL LOCKS
SET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED
SET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE
SET DATABASE TEXT TABLE DEFAULTS ''
SET FILES WRITE DELAY 500 MILLIS
SET FILES BACKUP INCREMENT TRUE
SET FILES CACHE SIZE 10000
SET FILES CACHE ROWS 50000
SET FILES SCALE 8
SET FILES LOB SCALE 32
SET FILES DEFRAG 0
SET FILES NIO TRUE
SET FILES NIO SIZE 256
SET FILES LOG TRUE
SET FILES LOG SIZE 50
CREATE USER SA PASSWORD DIGEST 'd41d8cd98f00b204e9800998ecf8427e'
ALTER USER SA SET LOCAL TRUE
CREATE SCHEMA PUBLIC AUTHORIZATION DBA
SET SCHEMA PUBLIC
CREATE MEMORY TABLE PUBLIC.ACCOUNT(ACCOUNT_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, ...)
ALTER TABLE PUBLIC.ACCOUNT ALTER COLUMN ACCOUNT_ID RESTART WITH 1
...
ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
GRANT DBA TO SA
SET SCHEMA SYSTEM_LOBS
INSERT INTO BLOCKS VALUES(0,2147483647,0) 
```

有谁知道 hbm2ddl 的配置需要什么才能使用 hibernate3-maven-plugin-3.0 正确创建表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:42:31.263

我仍然没有找到文档，但我确实设法让 hbm2ddl 使用 hibernate3-maven-plugin-3.0 构建表。

这是插件的外观：

```
<plugin>
    <!-- Run "mvn hibernate3:hbm2ddl" to generate schema -->
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>hibernate3-maven-plugin</artifactId>
    <version>3.0</version>

    <configuration>
        <hibernatetool>
            <classpath>
                <path location="${project.build.directory}/classes" />
            </classpath>

            <annotationconfiguration
                    propertyfile="src/main/resources/hibernate.cfg.xml" />
            <hbm2ddl update="true" create="true" drop="true" export="false"
                     outputfilename="schemaDiff.ddl" format="true"
                     console="true"/>
        </hibernatetool>
    </configuration>

</plugin> 
```

希望这对某人有帮助！

# php - How To Queue Files for Upload at a Later time/different page

> ID：13131438
> 
> 赞同：0
> 
> 时间：2012-10-30T00:06:50.433
> 
> 标签：php, jquery, file-upload, plupload

I am developing a cart (utilizing OpenCart). The cart allows people to order prints of images. Because the images will be high resolution and therefore large files, I need a method that allows the following:

1.  The customer arrives at a product page,
2.  The customer selects an image for the product,
3.  The file does NOT upload at that time (or, begins uploading in the background),
4.  Without waiting for the file upload, the customer adds the product to the cart,
5.  Repeat steps 1-4 as needed for additional products (and image files),
6.  AFTER successful checkout, the files are uploaded (or, they complete uploading)

It seems the key is to put the files into a queue, and for that queue to persist across page loads until completion of the order.

I'm familiar with [PLupload](http://www.plupload.com/) and have found [Uploadify](http://www.uploadify.com/), but do not see in their documentation how to accomplish what I'm after.

Can you get me pointed in the right direction? I'm sure this is doable, I'm just unsure how to get started and am unable to find any writeups/documentation around this specific issue.

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:16:27.840

If you're not using AJAX for all state changes, you can't "remember" a file upload input and repopulate it. (When using AJAX you could hide the forms). You can either let the user upload files right before checkout (not a good practice) or let the user upload in a popup and have the popup use AJAX so you can add forms on the fly as soon as new items are added to the cart.

# javascript - jQuery Counter，动画总计，但我如何包含逗号？

> ID：13131444
> 
> 赞同：1
> 
> 时间：2012-10-30T00:07:32.707
> 
> 标签：javascript, jquery, counter, comma

我在这里找到了许多计数器的解决方案，从一个总数到另一个动画。

这是我现在正在使用的：

```
jQuery.fn.extend({
          ts : function (from, to, time) {
            var steps = 1,
                self = this,
                counter;

            if (from - to > 0) {
              steps = -1;
            };

            from -= steps;

            function step() {
              self.text(from += steps);

              if ((steps < 0 && to >= from) || (steps > 0 && from >= to)) {
                clearInterval(counter);
              };
            };

            counter = setInterval(step, time || 5);
          }
        });

        var total = $('.total').ts(56000,56941); 
```

它运行良好，但是我想在总数中添加一个逗号，例如 56,941。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:16:17.057

我想这会做到：

```
jQuery.fn.extend({
    ts: function(from, to, time) {
        var steps = 1, self = this, counter;

        if (from - to > 0) steps = -1;
        from -= steps;

        function step() {
            var x = (from += steps).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
            self.text(x);
            if ((steps < 0 && to >= from) || (steps > 0 && from >= to)) {
                clearInterval(counter);
            };
        };
        counter = setInterval(step, time || 5);
    }
}); 
```

[**小提琴**](http://jsfiddle.net/ESBYb/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:30:32.097

从网络上的某个地方...

```
function formatComma(x){ 
    return (x+'').replace( /\B(?=(\d{3})+(?!\d))/g, ',');
} 
```

我更喜欢我自己的反转字符串的解决方案，因为它更容易理解逻辑......

```
function formatComma(x){
    // prepare the input as a string ready for manipulating and returning
    return (x+'')
      // reverse the string (by converting to array)
      .split("").reverse().join("")
      // replace 3 digits in a row, with themselves and a comma
      // so long as the digits are followed by a non-word boundary
      .replace(/(\d{3})\B/g,'$1,')
      // reverse it all again
      .split("").reverse().join("")
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:09:05.780

是的！您可以检查此插件（[http://code.google.com/p/jquery-numberformatter/](http://code.google.com/p/jquery-numberformatter/)）并在您的插件中实现它:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T00:12:55.967

这将起作用。该函数取自[http://ntt.cc/2008/04/25/6-very-basic-but-very-useful-javascript-number-format-functions-for-web-developers.html](http://ntt.cc/2008/04/25/6-very-basic-but-very-useful-javascript-number-format-functions-for-web-developers.html)。非常便利

```
jQuery.fn.extend({
          ts : function (from, to, time) {
            var steps = 1,
                self = this,
                counter;

            if (from - to > 0) {
              steps = -1;
            };

            from -= steps;

            function step() {
              self.text(addCommas(from += steps));

              if ((steps < 0 && to >= from) || (steps > 0 && from >= to)) {
                clearInterval(counter);
              };
            };

            counter = setInterval(step, time || 5);
          }
        });

var total = $('.total').ts(56000,56941);

function addCommas(nStr)
{
  nStr += '';
  x = nStr.split('.');
  x1 = x[0];
  x2 = x.length > 1 ? '.' + x[1] : '';
  var rgx = /(\d+)(\d{3})/;
  while (rgx.test(x1)) {
    x1 = x1.replace(rgx, '$1' + ',' + '$2');
  }
  return x1 + x2;
} 
```

​</p>

# visual-studio-2010 - TFS - Get Latest checks out every file in the solution even if there were no changes

> ID：13131456
> 
> 赞同：0
> 
> 时间：2012-10-30T00:08:34.503
> 
> 标签：visual-studio-2010, svn, tfs

I've been having this problem for awhile now. Every time I 'Get Latest (Recursive)' the solution, it checks out every file in that solution. Not just the ones with changes. Normally, it wouldn't be a problem. But these solution has thousands of files and it's very cumbersome to check out everything every time there is a new build. 'Get Specific' does the same too.

I hope somebody can provide a solution, I've tried searching the web for this but to no luck.

Thanks.

Edit for clarity.

# php - How do I save text from a textarea into a MySQL database with PHP when a Save button is clicked?

> ID：13131458
> 
> 赞同：2
> 
> 时间：2012-10-30T00:09:03.787
> 
> 标签：php, mysql, insert, save

I have a textarea in HTML where a logged in user can enter and save notes. I use the following script to retrieve the saved notes from the database

```
<?php
function notes() {
    $password = "fake_password";
    $connect = mysql_connect("localhost", "user", $password) or die("Couldn't connect to the database!");
    mysql_select_db("db_name") or die("Couldn't find the database!");

    $query = mysql_query("SELECT * FROM users WHERE notes!=''");
    $numrows = mysql_num_rows($query);

    if ($numrows != 0) {
        while ($row = mysql_fetch_assoc($query)){
            $notes = $row['notes'];
        }

        echo $notes;
    }
}
?> 
```

That works all fine and dandy but now - how do I save the changes the user made to the notes (textarea) when a Save button is clicked?

**EDIT:**

Here is the form itself:

```
<div class="row-fluid">
    <div class="span12">
        <br />
        <center><textarea class="input-xxlarge" rows="15"><?php include('includes/func.php'); notes(); ?></textarea>
        <br />
        <button class="btn btn-primary">Save Changes</button>
        </center>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:20:37.790

**首先**：您应该使用[PDO](http://net.tutsplus.com/tutorials/php/php-database-access-are-you-doing-it-correctly/)连接到您的数据库，而不是 mysql。 [Mysql 已被弃用](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)，并且容易受到[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)，因此在 Web 应用程序中使用并不安全。

有了这个警告，我将使用 mysql 回复，因为这就是你正在使用的。

这不是太难。当然，如果没有表结构或表单中的代码，下面必须使用示例字段名称，并假设您将用户 ID 存储在`$_SESSION`变量中：

```
<?php
    function savenotes() {
        // The database connection code should be moved to a central function/location rather than called in every function
        $password = "fake_password";
        $connect = mysql_connect("localhost", "user", $password) or die("Couldn't connect to the database!");
        mysql_select_db("db_name") or die("Couldn't find the database!");

        // Retreive notes from form
        $notes = $_POST['notes']; // Assumes field is called notes, and you used method=POST
        // Assuming a user can only update their own notes, and that you are storing the user id somewhere
        $userid = $_SESSION['userid']; 
        $query = mysql_query("UPDATE users SET notes ='" . mysql_real_escape_string($notes) . "' WHERE userid = " . (int)$userid);

} 
```

} ?>

# hibernate - How to configure Log4j in a multi project maven

> ID：13131460
> 
> 赞同：4
> 
> 时间：2012-10-30T00:09:05.110
> 
> 标签：hibernate, log4j, java-ee-6, maven-3, glassfish-3

I have a maven war project which depends on an EJB maven project. The EJB project handles all business logic including DB access through Hibernate. Both projects are JEE6 and run on glassfish 3.1.2 using maven. I'm currently trying to configure Log4j to work (also log hibernate) in the scenario described. I have the following log4j.xml file in my ejb's src/main/resources folder (I'm that it is in the classpath):

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

    <log4j:configuration xmlns:log4j=
                "http://jakarta.apache.org/log4j/"
                        debug="false">

        <appender name="consoleAppender"
                class="org.apache.log4j.ConsoleAppender">
            <param name="Threshold" value="INFO" />
            <layout class="org.apache.log4j.PatternLayout">
                <param name="ConversionPattern" value="%d
                %-5p  [%c{1}] %m %n" />
            </layout>
        </appender>

        <logger name="javabeat.net.log4j" additivity="false" >
            <level value="INFO" />
            <appender-ref ref="consoleAppender"/>
        </logger>
    </log4j:configuration> 
```

I keep getting this error from log4j:

> SEVERE: log4j:ERROR A "org.apache.log4j.xml.DOMConfigurator" object is not assignable to a "org.apache.log4j.spi.Configurator" variable.
> 
> SEVERE: log4j:ERROR The class "org.apache.log4j.spi.Configurator" was loaded by
> 
> SEVERE: log4j:ERROR [WebappClassLoader (delegate=true; repositories=WEB-INF/classes/)] whereas object of type
> 
> SEVERE: log4j:ERROR "org.apache.log4j.xml.DOMConfigurator" was loaded by [WebappClassLoader (delegate=true; repositories=WEB-INF/classes/)].
> 
> SEVERE: log4j:ERROR Could not instantiate configurator [org.apache.log4j.xml.DOMConfigurator].
> 
> SEVERE: log4j:WARN No appenders could be found for logger (org.hibernate.type.BasicTypeRegistry).
> 
> SEVERE: log4j:WARN Please initialize the log4j system properly.
> 
> SEVERE: log4j:WARN See [http://logging.apache.org/log4j/1.2/faq.html#noconfig](http://logging.apache.org/log4j/1.2/faq.html#noconfig) for more info.

I'm out of ideas thx for the help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-05T14:51:35.760

[http://forum.spring.io/forum/spring-projects/batch/76295-log4j-classloader-problem](http://forum.spring.io/forum/spring-projects/batch/76295-log4j-classloader-problem)

您好，您提到的问题几乎总是当您有一个 web 应用程序时，它们的 lib 和 tomcat lib 目录中都有 log4j.jar，就像我发布的链接中解释的那样，所以您必须选择，在哪里是 log4j，在所有 webapps lib 文件夹中或仅在 tomcat lib 目录中:)

更新：

此外，您必须避免在 tomcat lib 和 webapp lib 目录中复制 commons-logging.jar。

问候

# objective-c - NSMutableArray of custom classes copy

> ID：13131463
> 
> 赞同：2
> 
> 时间：2012-10-30T00:09:31.727
> 
> 标签：objective-c, nsmutablearray, copy, nsarray, deep-copy

I have an NSMutableArray of custom objects (based on NSObject) which I want to copy into a new array. But I want it to be a deep copy.

How do I go about doing this? Do I need to implement the NSCopying protocol in my custom object?

Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:13:08.230

是的，您需要表明您的自定义类遵守`NSCopying`协议，然后您实现该`copyWithZone:`方法。这允许复制您的课程。在您的实现中，`copyWithZone:`您需要确定有多少内部结构还需要深度复制。

现在，如果您对数组进行深层复制，新数组将包括对象的复制版本，而不仅仅是对原始对象的引用。

请注意，数组的常规副本不会进行深度复制。要制作深层副本，您需要以下内容：

```
NSArray *deepCopyArray=[[NSArray alloc] initWithArray:someArray copyItems:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:35:00.893

可以通过手动遍历所有元素来深度复制数组。如果对象需要进一步的深度复制，这是必要的。

```
NSMutableArray *deepCopied = [NSMutableArray arrayWithCapacity:[array count]];

// assumes your objects know how to "deepCopy"    
for (id object in array)
{
    // if not ARC or GC:
    [deepCopied addObject:[[object deepCopy] aurorelease]];

    // if ARC or GC
    [deepCopied addObject:[object deepCopy]];
} 
```

否则：

```
NSArray *deepCopied = [[NSArray alloc] initWithArray:array copyItems:YES]; 
```

如果您需要制作大量深拷贝，[此处](https://stackoverflow.com/questions/5453481/how-to-do-true-deep-copy-for-nsarray-and-nsdictionary-with-have-nested-arrays-di)的答案中描述了一种类别方法可能会有所帮助。

# javascript - using window.location with a simple html link

> ID：13131464
> 
> 赞同：2
> 
> 时间：2012-10-30T00:09:35.453
> 
> 标签：javascript, html, window.location

Trying to make a **simple** HTML page with a some links on it, but trying to make it so it detects you are either local or using the SSH Port Forwarding.

Some info;

URL I use when accessing the webpage Locally : 192.168.3.5/www/index.html

URL I Use when Using SSH Port Forwarding : 127.0.0.1:9009/www/index.html

This is the full code I am using in my index.html page....

```
<HTML>
- SABNZBD : Pick <A href="#" onclick="javascript:window.location.port=8080">LOCAL</a> or <A href="#" onclick="javascript:window.location.port=9001">REMOTE</a> Connection.
</HTML> 
```

If I use this code;

```
 onclick="javascript:window.location.port=9001" 
```

It sort of works, it returns

```
http://127.0.0.1:9001/www/# 
```

I really want it to return just this :

```
http://127.0.0.1:9001/ 
```

Is there a way I could use the below code ? So it strips the pathname and just uses the hostname and the portname that I have specified ? As I can't seem to get it to work.

```
onclick="javascript:window.location.hostname && window.location.port=9001" 
```

Thx Matt.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:33:25.183

以下应该做你需要的，在连接字符串时你不应该`+`使用`&&`

```
window.location = window.location.protocol + 
   '//' + window.location.hostname + ':9001'; 
```

您可以在处理程序中使用上述`onclick`内容：

```
onclick="window.location = ..." 
```

您无需指定`onclick="javascript:"`，因为这是默认情况下假定的。

此外，与其使用内联点击处理程序，不如使用以下内容：

*   [https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)
*   [http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx)

关于如何同时使用以上两者*（现代浏览器的 addEventListener，IE 的 attachEvent）*：

*   [Javascript 中的 MSIE 和 addEventListener 问题？](https://stackoverflow.com/questions/1695376/msie-and-addeventlistener-problem-in-javascript)

或者，如果您想让生活更简单，您可以使用自动处理这些浏览器差异的 JavaScript 库。像 jQuery。

```
$('.class_on_first_link').click(function(){
  window.location = window.location.protocol + 
   '//' + window.location.hostname + ':8080';
});

$('.class_on_second_link').click(function(){
  window.location = window.location.protocol + 
   '//' + window.location.hostname + ':9001';
}); 
```

### 更新

我上面省略号的意思是：

```
<a href="#" onclick="window.location = window.location.protocol + 
   '//' + window.location.hostname + ':9001';">Port 9001</a>
<a href="#" onclick="window.location = window.location.protocol + 
   '//' + window.location.hostname + ':8080';">Port 8080</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:36:13.490

设置`pathname`也应该可以解决问题

```
onclick="window.location.port=9001;window.location.pathname='/'" 
```

# php - 如何在 HTML 中返回两个多选值？

> ID：13131472
> 
> 赞同：0
> 
> 时间：2012-10-30T00:10:39.437
> 
> 标签：php, html, arrays, forms, parsing

我有一个名为“leads”的 mysql 数据库表，其中包含一个 id 列、一个 name 列和一个 email 列。`form`我目前有用户从多个选择框中选择一个潜在客户，该选择框作为一个带有`$_POST`方法的 html 的数组返回。我将选择框项的值作为电子邮件列，在前端向用户显示的是名称列。但是，我希望能够返回两个值，电子邮件和名称，以供以后使用。我需要让电子邮件值能够在它们之间用逗号分解，这样我以后可以使用 PHP 向它们发送电子邮件`mail`功能。但是，当用户查看已发送的电子邮件时，我想向他们显示名称值。我已经读过我可以解析数组，或者使用 id 列集作为值，这似乎更实用，但是，我不确定我将如何去做。有任何想法吗？提前感谢您的帮助！

****更新****

**基本上，登录网站的用户在 mysql 数据库中有自己的线索。我需要他们能够转到“发送电子邮件”页面，在那里他们可以按名称选择一个或多个潜在客户。然后有一个主题字段和一个消息字段，以便他们可以编写电子邮件，然后我有一个“发送电子邮件”表单提交按钮。在他们单击“发送电子邮件”后，我想取回他们选择的潜在客户的电子邮件地址和姓名，以备后用。我需要用逗号分隔电子邮件地址，以便我可以通过 php 邮件功能发送它们......但重要的是，我希望将表单中的信息存储在名为“PendingEmails”的数据库表中，我将运行一个 cron 作业来运行一个脚本，该脚本会找到需要发送的电子邮件，然后发送它们......发送电子邮件后，我需要将电子邮件中的姓名、主题和消息放入一个名为“SentEmails”的单独数据库中。在网站的另一个页面上，我希望用户能够看到他们发送的所有电子邮件，但我希望他们看到他们发送邮件的人的姓名，而不是电子邮件地址。这就是我需要姓名和电子邮件的原因。我需要邮件功能的电子邮件，以及要向用户显示的名称。我喜欢您使用 id 并运行其余服务器端的想法，我只是不知道该怎么做。希望这有帮助。这就是我需要姓名和电子邮件的原因。我需要邮件功能的电子邮件，以及要向用户显示的名称。我喜欢您使用 id 并运行其余服务器端的想法，我只是不知道该怎么做。希望这有帮助。这就是我需要姓名和电子邮件的原因。我需要邮件功能的电子邮件，以及要向用户显示的名称。我喜欢您使用 id 并运行其余服务器端的想法，我只是不知道该怎么做。希望这有帮助。**

**这是选择框：**

```
<select data-placeholder="Select Lead(s) To Email..." multiple="true" class="chzn-container-multi" name="selectleads[]"style="width:505px;">
            <?php
do {  
?>
            <option value="<?php echo $row_rsAllLeads['Email']?>"><?php echo $row_rsAllLeads['FullName']?></option>
            <?php
} while ($row_rsAllLeads = mysql_fetch_assoc($rsAllLeads));
  $rows = mysql_num_rows($rsAllLeads);
  if($rows > 0) {
      mysql_data_seek($rsAllLeads, 0);
      $row_rsAllLeads = mysql_fetch_assoc($rsAllLeads);
  }
?>
          </select> 
```

**这是实际的表单操作：**

```
$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form")) {
    $startcode = $_POST['messagefield'];
    $replaced = preg_replace( '/\\\\(?="|\')/', '', $startcode );
    $selected = $_POST['selectleads'];
    $collectedleads = implode(", ", $_POST['selectleads']);
 $to = $collectedleads;
 $subject = $_POST['subjectfield'];
 $body = $replaced;
 $headers = "MIME-Version: 1.0\r\n"; 
 $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
 $headers .= "From: " . $row_rs_CurrentUser['FirstName'] . " " . $row_rs_CurrentUser['LastName'] . " <" . $row_rs_CurrentUser['Email'] . ">";
 if (mail($to, $subject, $body, $headers)) {
  } else {
   echo("<p>Message delivery failed...</p>");
  }

} 
```

**您给我的代码，我尝试（但失败）编辑和工作：**

```
$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form")) {
    $startcode = $_POST['messagefield'];
    $replaced = preg_replace( '/\\\\(?="|\')/', '', $startcode );

    mysql_select_db($database_myBackOfficeConn, $myBackOfficeConn);

    $collectedleads = implode(", ", $_POST['selectleads']);

//arrays to store email addresses and names
$emails = array();
$names = array();

foreach ($collectedleads as $id) {
  mysql_query("SELECT Email, FullName FROM Leads 
    WHERE Id = " . mysql_real_escape_string($id));

  while ($row = mysql_fetch_assoc()) {
    $emails[] = $row['Email'];
    $names[] = $row['FullName'];
  }
}
 $to = $collectedleads;
 $subject = $_POST['subjectfield'];
 $body = $replaced;
 $headers = "MIME-Version: 1.0\r\n"; 
 $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
 $headers .= "From: " . $row_rs_CurrentUser['FirstName'] . " " . $row_rs_CurrentUser['LastName'] . " <" . $row_rs_CurrentUser['Email'] . ">";
 if (mail($to, $subject, $body, $headers)) {
  } else {
   echo("<p>Message delivery failed...</p>");
  }

}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:38:05.533

我认为在服务器端检索数据会更有意义。`<option>`将值设置为数据库的`id`列值，而不是电子邮件地址。

**编辑：在与 OP 讨论后更改了大部分答案**

请记住，您发布的代码只是一个片段，因此我无法对此进行测试，您可以尝试以下方式：

```
<select data-placeholder="Select Lead(s) To Email..." multiple="true" 
  class="chzn-container-multi" name="selectleads[]"style="width:505px;">
<?php   
  /* I think while is better, in case there are no results. 
    do...while would attempt to echo the first result in a set even 
    if there were no results, which would give an error, methinks. */

  //Use the id field of your database when you populate the select
  while ($row_rsAllLeads = mysql_fetch_assoc($rsAllLeads)) {  ?>
  <option value="<?php echo $row_rsAllLeads['id']?>">
    <?php echo $row_rsAllLeads['FullName']?></option>
<?php
  }

  /* What is this block used for? */
  $rows = mysql_num_rows($rsAllLeads);
  if($rows > 0) {
    mysql_data_seek($rsAllLeads, 0);
    $row_rsAllLeads = mysql_fetch_assoc($rsAllLeads);
  }
?>
</select> 
```

我不确定最后代码块的用途，所以我就离开了。我假设你对这些数据做了其他事情......？

所以现在你`<select>`的和以前完全一样，但不是实际的电子邮件地址，而是交回相应`id`的数据库。

现在，在提交数据时，我们稍微改变一下策略：

```
<?php
$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form")) {
  $startcode = $_POST['messagefield'];
  $replaced = preg_replace( '/\\\\(?="|\')/', '', $startcode );
  $selected = $_POST['selectleads'];

  /* NEW CODE */
  /*selectleads[] is now an array of your database's ids. 
    You can now run a query to get whatever information you 
    need. In this case, you want the email addresses, so:
   */
  $collectedleads = $_POST['selectleads'];
  $emailaddylist = array();
  foreach ($collectedleads as $id) {
    $x = mysql_query("SELECT `Email` FROM `leads` WHERE `id` = " . 
       mysql_real_escape_string($id));
    $x_assoc = $x->fetch_assoc();
    $emailaddylist[] = $x['Email'];
  }
  /*Now you have an array of email addresses that correspond to 
    the ids you were sent via $_POST.
   */
  $emailaddystring = implode(", ", $emailaddylist);

  $to = $emailaddystring;

  /*If you want to use any other data from the database, 
     you still have an array of ids in $collectedleads.
     Just run another query to get the data you want.*/

  /* END OF NEW CODE */

  $subject = $_POST['subjectfield'];
  $body = $replaced;
  $headers = "MIME-Version: 1.0\r\n"; 
  $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
  $headers .= "From: " . $row_rs_CurrentUser['FirstName'] . " " . $row_rs_CurrentUser['LastName'] . " <" . $row_rs_CurrentUser['Email'] . ">";
  if (mail($to, $subject, $body, $headers)) {
    } else {
      echo("<p>Message delivery failed...</p>");
    }
}
?> 
```

因为我们得到`id`了数组中的 s，所以我们可以使用它们从数据库中获取我们想要的任何信息。在这种情况下，我们只是获取电子邮件地址。如果您想检索任何其他信息，您可以使用相同的技术 - `id`s 的列表仍然存在于 中`$collectedleads`，因此您可以运行另一个查询来获取您需要的任何数据。

> 发送电子邮件后，我需要将电子邮件中的姓名、主题和消息放入一个名为“SentEmails”的单独数据库中

在这种情况下，使用`id`数据`$collectedleads`运行`SELECT`查询`leads`以获取您需要的信息（姓名、电子邮件地址等），然后`INSERT`对表运行查询`SentEmails`以复制该信息。

希望这可以帮助。

***警告：***

`mysql`不鼓励使用以支持[`mysqli`](http://www.php.net/manual/en/mysqli.overview.php)。引用页面：

> 如果您使用 MySQL 4.1.3 或更高版本，**强烈** 建议您改用 mysqli 扩展。

它的工作原理几乎完全相同；在大多数情况下，您需要做的就是将 放在`i`它前面。[有些功能](http://php.net/manual/en/function.mysql-data-seek.php)不适用于它，或者有更好的选择。你应该检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:35:41.183

我会做什么，我会添加一个名为“lead_name”的隐藏字段，并在 onblur 事件中使用 jQuery 或纯 JS 填充它，并使用所选线索的值。

```
$("#lead_name").val($("#lead option:selected").text()); 
```

# makefile - 如何在include的子目录中安装automake头文件

> ID：13131474
> 
> 赞同：2
> 
> 时间：2012-10-30T00:10:53.800
> 
> 标签：makefile, autotools, autoconf, libtool

我当前的项目在其`include/tatoparser`目录中有几个文件，我想将它们与我的库一起分发。

```
qdii@nomada ~/MyProject $ ls include/tatoparser/
dataset.h  interface_lib.h  linkset.h  sentence.h  tagset.h 
```

我创建了一个`Makefile.am`引用这些文件的文件：

```
qdii@nomada ~/MyProject $ cat include/Makefile.am 
include_HEADERS = tatoparser/interface_lib.h tatoparser/sentence.h tatoparser/dataset.h tatoparser/tagset.h tatoparser/linkset.h 
```

但是当我运行`make install`引用的文件被复制到`/usr/include`（或任何`$(includedir)`设置）时，我希望它们被复制到`/usr/include/tatoparser`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T11:27:30.800

使用`nobase`前缀阻止 Automake 从文件中剥离子目录路径：

```
nobase_include_HEADERS = tatoparser/interface_lib.h tatoparser/... 
```

# .net - What is the difference between `marshal.ThrowExceptionForHRInternal` and `marshal.ThrowExceptionForHR`?

> ID：13131475
> 
> 赞同：1
> 
> 时间：2012-10-30T00:10:55.110
> 
> 标签：.net

`marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)` is not documented anywhere and it's hard to interpret the stack trace without knowing what methods do.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:31:11.137

它只是一个由两个公共 Marshal.ThrowExceptionForHR() 方法重载调用的内部辅助方法。不要射击信使，它只是将 COM 错误代码 (HR = HResult) 转换为托管异常并抛出该异常。*希望*您得到的异常表明出了什么问题。这通常不是那么清楚，COM 错误代码往往无法描述，尤其是在没有可用的 IErrorInfo 时。

# jquery - When storing session values in an AJAX call, they are lost when the next page is loaded

> ID：13131476
> 
> 赞同：0
> 
> 时间：2012-10-30T00:10:58.043
> 
> 标签：jquery, ajax, asp.net-mvc-3, session

I am using MVC3, and I am trying to do a login page. I am storing all my details in the session. If I press 'login' again, it will show the values as being in the session. When I load another page, or reload the login page, the session is empty. I have made sure there's no code anywhere in my application that could be clearing the session. I've found online articles about doing what I am doing, so it seems it should work ? I've set breakpoints in my session_start in app_config, and it's only called the once per session.

Just to add, if I look at the session object, the session id is the same. Two values are put in the session in the controller, and then 10 or so in the AJAX call. When I reload the same page, only the 2 values are in the controller, but the AJAX call could see those two values. So, the AJAX call could see the existing session, but the values it adds, are visible if I make the same AJAX call over and over, but gone from a page load.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:49:50.920

据我所知，卡西尼有时会彻底失败。我发现一些谷歌参考表明这是真的，虽然失败是一致的（我可以看到我的会话值，直到我到达授权页面），在我尝试在 IIS 中运行它（这不起作用）之后，它开始在卡西尼工作。无论如何，我最终放弃了这种机制，但是，如果您有同样的问题，我建议您不能信任 Visual Studio 附带的 Web 服务器。

# java - JWindow does not receive events in Java 7 for Mac

> ID：13131481
> 
> 赞同：0
> 
> 时间：2012-10-30T00:11:49.307
> 
> 标签：java, macos, java-7, jwindow

See the sample code below. It simply creates a button and adds it to a window. But when *menu_item3* is selected, the ActionListener doesn't receive the event. This error only occurs on Java 7 for Mac. If I run this same code in Windows, it works fine. When I run this same code on Java 6 for Mac, it works fine. If I use a JFrame instead of JWindow, it works fine. I do not want to use a JFrame because I do not want to display the window title bar and border.

Any ideas?

```
public class SandBox {
 public static JFrame frame = new JFrame();
 public static JPopupMenu menu = new JPopupMenu();
 public static JLabel button = new JLabel();

 public static void main(String[] args) {
     JFrame window = new JFrame();
     JPanel panel = new JPanel();

     JMenuItem menu_item1 = new JMenuItem("Item1");
     JMenuItem menu_item2 = new JMenuItem("Item2");
     JMenuItem menu_item3 = new JMenuItem("Item3");

     menu.add(menu_item1);
     menu.add(menu_item2);
     menu.add(menu_item3);
     menu.setEnabled(true);

     button.setText("Button");
     button.setBorder(BorderFactory.createMatteBorder(4, 4, 4, 4, new Color(255,0,0)));
     button.setSize(100, 24);
     button.add(menu);
     button.setVisible(true);
     button.setEnabled(true);

     panel.add(button);
     panel.setVisible(true);

     window.add(panel);
     window.setVisible(true);
     window.setLocation(100, 100);
     window.setAlwaysOnTop(true);
     window.setFocusable(true);
     window.setFocusableWindowState(true);
     window.pack();

     frame.setVisible(false);

     button.addMouseListener(new MouseAdapter() {
         public void mouseClicked(MouseEvent e) {
             menu.show(button, 0, 0);
         }
     });

     menu_item3.addActionListener(new ActionListener(){
         public void actionPerformed(ActionEvent e){
             JOptionPane.showMessageDialog(frame, "Eggs are not supposed to be green.");
         }
     });
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:38:30.890

我已经向 Oracle 提交了一个错误。还在等待他们的回应是否会正式提交该错误。当我听到一些东西时，我会更新这个答案。

与此同时，我确实找到了一个可行的解决方法。我使用 JFrame 而不是 JWindow。[我不知道您可以使用setUndecorated()](http://docs.oracle.com/javase/7/docs/api/java/awt/Frame.html#setUndecorated%28boolean%29)方法删除 JFrame 的窗口标题和边框。另请注意，此方法只能在框架不可显示时调用。

# c# - Opengl - “全屏”纹理渲染性能问题

> ID：13131483
> 
> 赞同：3
> 
> 时间：2012-10-30T00:11:56.003
> 
> 标签：c#, opengl, opentk

我正在用 openGL 编写一个 2D 游戏，在渲染覆盖整个窗口的几个纹理时遇到了一些性能问题。

我所做的实际上是创建一个具有屏幕大小的纹理，使用 FBO 将我的场景渲染到该纹理上，然后使用不同的偏移量渲染纹理几次以获得一种“阴影”。但是当我这样做时，我在使用集成显卡时性能会大幅下降。

所以总而言之，我在整个屏幕上渲染了 7 个四边形（背景图像、5 个带有黑色“色调”的“阴影图像”和具有相同纹理的真实颜色）。我正在使用大小为 1024x1024 的 RGBA 纹理，并将它们放在 900x700 的窗口中。当我不渲染纹理时，我得到 200 FPS 和 34 FPS（在这两种情况下，我实际上都创建了纹理并将场景渲染到它上面）。我觉得这很奇怪，因为我基本上只渲染 7 个四边形。一个奇怪的事情是，当我运行 CPU 分析器时，它并没有表明这是瓶颈（我知道 opengl 使用管道架构，这可能会发生，但大多数时候不会发生）。

当我使用我的外部视频卡时，当我进行上述测试时，我得到一致的 200 FPS。但是当我禁用场景渲染到纹理上并禁用纹理渲染到屏幕上时，我得到了 ~1000 FPS。这只发生在我的外部显卡上——当我使用集成显卡禁用 FBO 时，我得到相同的 200 FPS。这真的让我很困惑。

谁能解释发生了什么以及上述数字是否正确？

集成显卡 - Intel HD Graphics 4000

外接显卡 - NVIDIA GeForce GTX 660M

PS 我正在用 C# 编写我的游戏——所以如果有帮助的话，我会使用 OpenTK。

**编辑：**

首先感谢所有的回复——它们在某种程度上都非常有帮助，但不幸的是，我认为除了“简化/优化你的代码”之外，还有更多的东西。让我分享一些我的渲染代码：

```
//fields defined when the program is initialized

Rectangle viewport;
//Texture with the size of the viewport
Texture fboTexture;
FBO fbo;

//called every frame
public void Render()
{
    //bind the texture to the fbo
    GL.BindFramebuffer(FramebufferTarget.Framebuffer, fbo.handle);
    GL.FramebufferTexture2D(FramebufferTarget.Framebuffer, fboTexture,
       TextureTarget.Texture2D, texture.TextureID, level: 0);

    //Begin rendering in Ortho 2D space
    GL.MatrixMode(MatrixMode.Projection);
    GL.PushMatrix();
    GL.LoadIdentity();
    GL.Ortho(viewport.Left, viewport.Right, viewport.Top, viewport.Bottom, -1.0, 1.0);
    GL.MatrixMode(MatrixMode.Modelview);
    GL.PushMatrix();
    GL.LoadIdentity();

    GL.PushAttrib(AttribMask.ViewportBit);
    GL.Viewport(viewport);

    //Render the scene - this is really simple I render some quads using shaders
    RenderScene();

    //Back to Perspective
    GL.PopAttrib(); // pop viewport
    GL.MatrixMode(MatrixMode.Projection);
    GL.PopMatrix();
    GL.MatrixMode(MatrixMode.Modelview);
    GL.PopMatrix();

    //Detach the texture
    GL.FramebufferTexture2D(FramebufferTarget.Framebuffer, fboTexture, 0,
                    0, level: 0);
    //Unbind the fbo
    GL.BindFramebuffer(FramebufferTarget.Framebuffer, 0);

    GL.PushMatrix();
    GL.Color4(Color.Black.WithAlpha(128)); //Sets the color to (0,0,0,128) in a RGBA format

    for (int i = 0; i < 5; i++)
    {
        GL.Translate(-1, -1, 0);
        //Simple Draw method which binds the texture and draws a quad at (0;0) with
        //its size
        fboTexture.Draw();
    }
    GL.PopMatrix();
    GL.Color4(Color.White);
    fboTexture.Draw();
} 
```

所以我认为 fbo 和渲染到纹理上实际上没有任何问题，因为这不会导致程序在我的两张卡上变慢。以前我每帧都初始化 fbo，这可能是我的 Nvidia 卡变慢的原因，但现在当我预初始化所有内容时，无论有没有 fbo，我都会得到相同的 FPS。

我认为问题不在于一般的纹理，因为如果我禁用纹理并只渲染无纹理的四边形，我会得到相同的结果。而且我仍然认为我的集成卡在屏幕上仅渲染 7 个四边形时运行速度应该超过 40 FPS，即使它们覆盖了整个屏幕。

你能给我一些关于如何实际分析这个并回发结果的提示吗？那真的很有用。

**编辑2：**

好的，我进行了一些实验，并设法获得了更好的性能。首先，我尝试使用着色器渲染最终的四边形——这并没有像我预期的那样对性能产生任何影响。

然后我尝试运行分析器。但据我所知，SlimTune 只是一个 CPU 分析器，它并没有给我想要的结果。然后我尝试了 gDEBUgger。它与 Visual Studio 集成，后来我发现它不支持 .NET 项目。我尝试运行外部版本，但它似乎不起作用（但也许我只是玩得不够多）。

真正起到作用的是，我不是直接将 7 个四边形渲染到屏幕上，而是首先将它们渲染到纹理上，再次使用 fbo，然后将最终纹理渲染到屏幕上一次。这使我的 fps 从 40 提高到 120。至少可以说，这似乎是一种古玩。为什么渲染到纹理方式比直接渲染到屏幕更快？尽管如此，感谢大家的帮助 - 看来我已经解决了我的问题。如果有人对这种情况提出合理的解释，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T01:07:45.630

显然这是一个猜测，因为我没有看到或分析您的代码，但我猜集成卡只是在为您的后期处理而苦苦挣扎（多次绘制纹理以实现您的“阴影”效果）。

我不知道你对这些概念的熟悉程度，如果我在这里有点冗长，很抱歉。

### 关于后处理

后期处理是在将完成的场景显示在屏幕上之前，将完成的场景渲染到纹理，并对图像应用效果的过程。后处理的典型用途包括：

*   Bloom - 通过将明亮像素“渗透”到相邻的较暗像素中，更自然地模拟亮度。

*   高动态范围渲染 - Bloom 的大哥。场景被渲染为浮点纹理，允许更大的颜色范围（而不是通常的黑色 0 和全亮度 1）。屏幕上显示的最终颜色是使用屏幕上所有像素的平均亮度计算的。所有这一切的效果是相机的行为有点像人眼 - 在黑暗的房间里，明亮的光线（例如，透过窗户）看起来非常明亮，但是一旦你到外面，相机就会调整并且光线看起来只是如果你直视太阳，它会很亮。

*   Cel-shading - 修改颜色以提供类似卡通的外观。

*   运动模糊

*   景深 - 游戏中的相机接近真实的（或你的眼睛），其中只有一定距离的物体是焦点，其余的都是模糊的。

*   延迟着色 - 一种相当先进的后处理应用程序，在渲染场景后计算照明。这会消耗大量视频 RAM（它通常使用多个全屏纹理），但允许将大量灯光快速添加到场景中。

简而言之，您可以将后期处理用于许多巧妙的技巧。很遗憾...

### 后期处理是有成本的

后期处理最酷的地方在于它的成本与场景的几何复杂性无关——无论是绘制一百万个三角形还是绘制十几个三角形，都将花费相同的时间。然而，这也是它的缺点。即使您只是一遍又一遍地渲染四边形来进行后处理，渲染每个像素也是有成本的。如果要使用更大的纹理，成本会更高。

专用显卡显然有更多的计算资源来应用后处理，而集成卡通常可以应用的资源要少得多。正是由于这个原因，视频游戏上的“低”图形设置通常会禁用许多后期处理效果。这不会显示为 CPU 分析器的瓶颈，因为延迟发生在显卡上。CPU 正在等待显卡完成后再继续执行程序（或者更准确地说，CPU 在等待显卡完成时正在运行另一个程序）。

### 如何加快速度？

*   使用更少的通行证。如果将通行证减半，则进行后处理所需的时间减半。为此，

*   使用着色器。由于我没有看到您在任何地方提及它们，因此我不确定您是否使用着色器进行后期处理。着色器本质上允许您使用类 C 语言编写函数（因为您在 OpenGL 中，您可以使用 GLSL 或 Cg），该函数在对象的每个渲染像素上运行。它们可以采用您喜欢的任何参数，并且对于后期处理非常有用。您使用着色器设置要绘制的四边形，然后您可以插入您希望在场景的每个像素上运行的任何算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:25:07.710

看到一些代码会很好。如果两者之间的唯一区别是是否使用外部 GPU，则区别可能在于内存管理（即创建 FBO 的方式和时间等），因为将数据流式传输到 GPU 可能会很慢。尝试移动任何创建任何类型的 OpenGL 缓冲区或向其发送任何类型的数据以进行初始化的东西。如果没有确切地看到你在做什么，我真的无法给出更详细的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T03:05:19.857

这不仅仅是您渲染的四边形数量，我相信在您的情况下，它与填充视频卡的三角形数量有关。

如前所述，进行全屏后期处理的常用方法是使用着色器。如果您想在集成卡上获得更好的性能并且不能使用着色器，那么您应该简化渲染程序。

确保您确实需要 Alpha 混合。在某些卡/驱动程序上，使用 Alpha 通道渲染纹理会显着降低性能。

一种降低全屏填充量的低质量方法是首先在另一个较小的纹理（例如，256x256 而不是 1024x1024）上执行所有阴影绘制。然后，您将使用该复合阴影纹理绘制一个四边形到您的缓冲区。这种方式而不是 7 个 1024x1024 四边形，您只需要 6 个 256x256 和一个 1024x1024。但你会失去决心。

Another technique, and I'm not sure it can be applied in your case, is to pre-render your complex background so you'll have to do less drawing in your rendering loop.

# ios - Auto position subviews of UINavigationBar's titleView

> ID：13131484
> 
> 赞同：0
> 
> 时间：2012-10-30T00:11:55.793
> 
> 标签：ios, uinavigationbar, title, layoutsubviews, titleview

I have a custom titleView for displaying Navigation title and sub-title. The title font is bigger than sub-title. Here's what I have now:

```
CGRect headerTitleSubtitleFrame = CGRectMake(0, 0, 200, 44);
UIView* _headerTitleSubtitleView = [[[UILabel alloc] initWithFrame:headerTitleSubtitleFrame] autorelease];
_headerTitleSubtitleView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
_headerTitleSubtitleView.backgroundColor = [UIColor clearColor];
_headerTitleSubtitleView.autoresizesSubviews = YES;

CGRect titleFrame = CGRectMake(0, 0, 200, 24);
UILabel *titleView = [[[UILabel alloc] initWithFrame:titleFrame] autorelease];
titleView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
titleView.backgroundColor = [UIColor clearColor];
titleView.font = [UIFont boldSystemFontOfSize:20];
titleView.textAlignment = UITextAlignmentCenter;
titleView.textColor = [UIColor whiteColor];
titleView.shadowColor = [UIColor darkGrayColor];
titleView.shadowOffset = CGSizeMake(0, -1);
titleView.text = @"Title";
titleView.adjustsFontSizeToFitWidth = YES;

CGRect subtitleFrame = CGRectMake(0, 24, 200, 20);
UILabel *subtitleView = [[[UILabel alloc] initWithFrame:subtitleFrame] autorelease];
subtitleView.backgroundColor = [UIColor clearColor];
subtitleView.font = [UIFont boldSystemFontOfSize:13];
subtitleView.textAlignment = UITextAlignmentCenter;
subtitleView.textColor = [UIColor whiteColor];
subtitleView.shadowColor = [UIColor darkGrayColor];
subtitleView.shadowOffset = CGSizeMake(0, -1);
subtitleView.text = @"subtitle";
subtitleView.adjustsFontSizeToFitWidth = YES;

_headerTitleSubtitleView.autoresizingMask = (UIViewAutoresizingFlexibleLeftMargin |
                                             UIViewAutoresizingFlexibleRightMargin |
                                             UIViewAutoresizingFlexibleTopMargin |
                                             UIViewAutoresizingFlexibleBottomMargin);

[_headerTitleSubtitleView addSubview:titleView];
[_headerTitleSubtitleView addSubview:subtitleView];

self.navigationItem.titleView = _headerTitleSubtitleView; 
```

I want to have the ability to remove subTitleView at some point in my code, but that makes the titleView look out of center (vertically).

So my question is, how would you implement auto-positioning here? should I use layoutSubviews ? if so, what would be the proper way to override it?

I thought that when the container view has an autoresizingMask it will adjust it's size according to the "total" size of it's subviews (?).

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:40:43.453

我能够通过创建一个单独的视图类并实现 layoutSubviews 来解决这个问题。标题标签子视图始终附加。可以在需要时删除/添加字幕标签子视图 - 这将调用 layoutSubViews 以将标题标签视图重新定位在中心。

```
- (id)initWithFrame:(CGRect)frame
{
    CGRect containerFrame = CGRectMake(0, 0, 200, 44);
    self = [super initWithFrame:containerFrame];
    if (self) {

        self.backgroundColor = [UIColor clearColor];
        self.autoresizesSubviews = YES;

        _title = [[UILabel alloc] initWithFrame:CGRectZero];
        _title.backgroundColor = [UIColor clearColor];
        _title.font = [UIFont boldSystemFontOfSize:20];
        _title.textAlignment = UITextAlignmentCenter;
        _title.textColor = [UIColor whiteColor];
        _title.shadowColor = [UIColor darkGrayColor];
        _title.shadowOffset = CGSizeMake(0, -1);
        _title.adjustsFontSizeToFitWidth = YES;

        _subTitle = [[UILabel alloc] initWithFrame:CGRectZero];
        _subTitle.backgroundColor = [UIColor clearColor];
        _subTitle.font = [UIFont boldSystemFontOfSize:13];
        _subTitle.textAlignment = UITextAlignmentCenter;
        _subTitle.textColor = [UIColor whiteColor];
        _subTitle.shadowColor = [UIColor darkGrayColor];
        _subTitle.shadowOffset = CGSizeMake(0, -1);
        _subTitle.adjustsFontSizeToFitWidth = YES;

        self.autoresizingMask = (UIViewAutoresizingFlexibleLeftMargin |
                                           UIViewAutoresizingFlexibleRightMargin |
                                           UIViewAutoresizingFlexibleTopMargin |
                                           UIViewAutoresizingFlexibleBottomMargin);
        [self addSubview:_title];
    }
    return self;
}

- (void)layoutSubviews {
    [super layoutSubviews];
    if (([self.subviews count] > 1) && ([[self.subviews objectAtIndex:1] isKindOfClass:[UILabel class]]))
    {
            [[self.subviews objectAtIndex:0] setFrame:CGRectMake(0,0,200,24)];
            [[self.subviews objectAtIndex:1] setFrame:CGRectMake(0,24,200,20)];
    }
    else
        [[self.subviews objectAtIndex:0] setFrame:self.bounds];
} 
```

# linux - Mini2440仿真程序：请问，怎么做？

> ID：13131486
> 
> 赞同：1
> 
> 时间：2012-10-30T00:11:58.653
> 
> 标签：linux, qemu

我想模拟友好的ARM板，Mini2440或mini6410，所以我可以练习嵌入式编程，QT编程等等，因为我国家的一些财政困难和奇怪的进口政策。

无论如何，问题是我似乎无法理解进行仿真的第一步是什么：我在 VirtualBox 上运行 ubuntu 12.04，然后我安装了 qemu-kvn-extras，然后呢？我需要 qemu 和仿真过程的新内核吗？它的规格是什么？另一方面，当我阅读网上的所有教程时，我看不到硬件规范部分：我的意思是“qemu-i386 命令”中的部分是指我正在使用的事实迷你2440 ?

研究了好久，不知道能不能模仿板子来适应u-boot和交叉编译等。还是做不到的梦想。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-23T13:09:58.463

（很抱歉恢复旧线程，但我遇到了类似的问题，所以这对其他人也可能有用）

要运行我使用的测试（另请参阅`man qemu-system-arm`）：

```
$ qemu-system-arm -machine versatilepb -cpu arm1176 -m 128M -nographic -kernel kernel.img 
```

`-nographic`当您测试 Qt 并需要替换`kernel.img`为您想要运行的图像时，您可能不希望这里出现。但是，请注意，您需要 qemu 的 ARM 版本`qemu-system-arm`。它不适用于 Intel 版本`qemu-i386`，因为 mini6410 运行 ARM 处理器 (the `ARM1176JZF-S`)。

对我来说，与 gdb 连接也很有用（`-S`在启动时停止 CPU，`-s`在端口 1234 上启动 gdbserver）：

```
$ qemu-system-arm -machine versatilepb -cpu arm1176 -S -s -m 128M -nographic -kernel kernel.img 
```

接着：

```
$ arm-none-eabi-gdb
(gdb) target remote localhost:1234 
```

顺便说一句，主机系统可以是任何 Linux 发行版，因此如果您的主机已经是 Linux，则不需要 VirtualBox。

另一个评论：我目前正在努力让中断在 qemu 上运行（另请参阅[QEMU 中的 ARM 中断处理](https://stackoverflow.com/questions/14869317/arm-interrupt-handling-in-qemu)），所以不确定是否一切都适合你。

祝你好运！;)

# jquery-mobile - jQuery mobile 和 Google Analytics - 单页模板

> ID：13131488
> 
> 赞同：2
> 
> 时间：2012-10-30T00:12:09.447
> 
> 标签：jquery-mobile, asynchronous, google-analytics

我在任何地方都没有找到我的问题的答案，而且我对 javascript 一无所知，所以我自己也搞不清楚。

如果我构建了 jQuery 移动网站，以便**每个页面都在单独的 html 文件**（[单页模板](http://jquerymobile.com/demos/1.1.1/docs/pages/page-anatomy.html)）中。我可以使用标准的异步 Google Analytics 代码，还是必须进行类似于[多页模板中使用的](http://blog.mojotech.com/post/29501319906/google-analytics-within-jquery-mobile)修改？

如果有人能回答这个问题，将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T15:43:36.443

是的，您可以使用标准的 Google Analytics（分析）代码。但是，由于 jQuery Mobile 处理页面导航的方式，您需要将某些页面视图“推送”到 Google Analytics。

例如，如果您的网站上有一个联系表单`contact.html`，一旦提交，就转到一个`process.php`页面，然后在完成后，用户到达`thank-you.html`，您将需要调用一些 JavaScript 来将页面浏览量“推送”到 Google Analytics。

例如，如果您的 jQuery Mobile 页面元素 ( `data-role="page"`) 有`id="thank-you"`，那么我会使用这个：

```
<script type="text/javascript">
$(document).delegate('#thank-you', 'pageshow', function () {
    //Your code for each thank you page load here
    _gaq.push(['_setAccount', 'UA-XXXXXXX-X']);
    _gaq.push(['_trackPageview', '/thank-you.html']);

});
</script> 
```

**更新：**

在加载 jQuery 和 jQuery Mobile 后，我会将其放入您的`script.js`文件中，该文件包含在头部中。这会在每个`data-role="page"` `pageshow`事件上触发，并且目前正在我的现场项目中正常工作。

```
$('[data-role=page]').live('pageshow', function (event, ui) {
    try {
        _gaq.push(['_setAccount', 'UA-XXXXXXX-X']);

        hash = location.hash;

        if (hash) {
            _gaq.push(['_trackPageview', hash.substr(1)]);
        } else {
            _gaq.push(['_trackPageview']);
        }

    } catch(err) {

    }

}); 
```

# tridion - Tridion RepositoryLocalObject.GetBluePrintChain 方法 (BluePrintChainFilter) 在共享项目上抛出异常

> ID：13131489
> 
> 赞同：5
> 
> 时间：2012-10-30T00:12:23.723
> 
> 标签：tridion, tridion-2011

我正在尝试获取继承 RepositoryLocalObject（例如组件）的父项列表。因此，如果我有一个带有组件 tcm:1-80 的 pub ID 1 和一个子 pub ID 2，那么这个组件在子 pub 中共享为 tcm:2-80。所以我想得到 tcm:2-80 的父母，或者树上的任何东西向上移动。

我已经在组件的本地副本上尝试了 GetBluePrintChain() 方法，它可以正常工作。但是，在共享组件上，它返回 InvalidActionException：“此项目是共享的”。该文档提到此异常是在共享项目上引发的。但这有什么意义呢？显然，如果任何具有超出自身的蓝图链的项目将被共享（或成为本地副本）。所以对我来说，让这个方法在有蓝图链的东西上抛出异常是没有意义的。似乎很矛盾。

[我的问题与获取组件的根发布](https://stackoverflow.com/questions/13131273/getting-root-publication-of-component)有些相关，但它有所不同。我需要了解为什么在共享项目上会引发此异常。有人可以解释一下并分享一个用例来支持它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T13:35:42.390

据我所知，`GetBluePrintChain`当您站在蓝图顶部时，这些方法旨在俯视蓝图。因此，在您的情况下，您应该在其拥有的发布上下文中获取该项目，然后调用`GetBluePrintChain`.

```
Item item = package.GetByName("Component");
Component component = new Component(item.GetAsXmlDocument().DocumentElement,
                                    engine.GetSession());
TcmUri id = TemplateUtilities.CreateTcmUriForPublication(
        component.OwningRepository.Id.ItemId, component.Id);

var blueprintchain = ((Component)engine.GetObject(id)).GetBluePrintChain();

package.PushItem(package.CreateStringItem(ContentType.Text, 
                                          blueprintchain.ToString()));
package.PushItem(package.CreateStringItem(ContentType.Text,
                             ""+System.Linq.Enumerable.Count(blueprintchain)));
foreach (var item in blueprintchain)
{
    package.PushItem(package.CreateTridionItem(ContentType.Component, item));
} 
```

我只是在两种情况下将上述 C# 片段作为 TBB 运行：

1.  在共享组件的子出版物中
2.  在本地化组件的子出版物中

在情况 1 中，`blueprintchain`将包含一个项目：共享组件。在情况 2 中，`blueprintchain`将包含两个项目：共享组件和本地化组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T08:16:15.653

总结上面的答案，这是“项目已共享”问题的实际解决方法：

为碰巧*共享*的任意项目调用**GetBluePrintChain()**将失败：

 *```
return
  item.GetBluePrintChain(
    new BluePrintChainFilter(
      BluePrintChainDirection.Up,
      engine.GetSession()
    )
  ).LastOrDefault(); 
```

解决方案是按照弗兰克的食谱首先找到最顶级的本地化项目的父项：

```
return
  ((RepositoryLocalObject)engine
    .GetObject(
      TemplateUtilities.CreateTcmUriForPublication(
        item.OwningRepository.Id.ItemId,
        item.Id
      )
    )
  ).GetBluePrintChain(
    new BluePrintChainFilter(
      BluePrintChainDirection.Up,
      engine.GetSession()
    )
  ).LastOrDefault(); 
```*

# python - 在 Python 中懒惰地将 N 个项目划分为 K 个 bin

> ID：13131491
> 
> 赞同：4
> 
> 时间：2012-10-30T00:12:28.650
> 
> 标签：python, combinatorics

给出一个算法（或直接的 Python 代码），将 N 个项目集合的所有分区生成 K 个 bin，使得每个 bin 至少有一个项目。在订单很重要和订单不重要的情况下，我都需要这个。

顺序很重要的示例

```
>>> list(partition_n_in_k_bins_ordered((1,2,3,4), 2))
[([1], [2,3,4]), ([1,2], [3,4]), ([1,2,3], [4])]

>>> list(partition_n_in_k_bins_ordered((1,2,3,4), 3))
[([1], [2], [3,4]), ([1], [2,3], [4]), ([1,2], [3], [4])]

>>> list(partition_n_in_k_bins_ordered((1,2,3,4), 4))
[([1], [2], [3], [4])] 
```

顺序无关紧要的示例

```
>>> list(partition_n_in_k_bins_unordered({1,2,3,4}, 2))
[{{1}, {2,3,4}}, {{2}, {1,3,4}}, {{3}, {1,2,4}}, {{4}, {1,2,3}},
 {{1,2}, {3,4}}, {{1,3}, {2,4}}, {{1,4}, {2,3}}] 
```

这些函数应该产生惰性迭代器/生成器，而不是列表。理想情况下，他们会使用`itertools`. 我怀疑有一个聪明的解决方案正在躲避我。

虽然我在 Python 中提出了这个要求，但我也愿意翻译一个清晰的算法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T02:40:29.430

您需要一个递归函数来解决此类问题：您获取列表，获取长度增加的子部分，并将相同的过程应用于 n-1 个列表的剩余尾部。

这是我对有序组合的看法

```
def partition(lista,bins):
    if len(lista)==1 or bins==1:
        yield [lista]
    elif len(lista)>1 and bins>1:
        for i in range(1,len(lista)):
            for part in partition(lista[i:],bins-1):
                if len([lista[:i]]+part)==bins:
                    yield [lista[:i]]+part

for i in partition(range(1,5),1): 
    print i
#[[1, 2, 3, 4]]

for i in partition(range(1,5),2): 
    print i
#[[1], [2, 3, 4]]
#[[1, 2], [3, 4]]
#[[1, 2, 3], [4]]

for i in partition(range(1,5),3):
    print i
#[[1], [2], [3, 4]]
#[[1], [2, 3], [4]]
#[[1, 2], [3], [4]] 

for i in partition(range(1,5),4):
    print i
#[[1], [2], [3], [4]] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-01T19:18:09.230

Enrico 的算法，Knuth 的算法，只需要我的胶水就可以将返回列表列表或集合集的东西粘贴在一起（如果元素不可散列，则作为列表列表返回）。

```
def kbin(l, k, ordered=True):
    """
    Return sequence ``l`` partitioned into ``k`` bins.

    Examples
    ========

    The default is to give the items in the same order, but grouped
    into k partitions:

    >>> for p in kbin(range(5), 2):
    ...     print p
    ...
    [[0], [1, 2, 3, 4]]
    [[0, 1], [2, 3, 4]]
    [[0, 1, 2], [3, 4]]
    [[0, 1, 2, 3], [4]]

    Setting ``ordered`` to None means that the order of the elements in
    the bins is irrelevant and the order of the bins is irrelevant. Though
    they are returned in a canonical order as lists of lists, all lists
    can be thought of as sets.

    >>> for p in kbin(range(3), 2, ordered=None):
    ...     print p
    ...
    [[0, 1], [2]]
    [[0], [1, 2]]
    [[0, 2], [1]]

    """
    from sympy.utilities.iterables import (
        permutations, multiset_partitions, partitions)

    def partition(lista, bins):
        #  EnricoGiampieri's partition generator from
        #  http://stackoverflow.com/questions/13131491/
        #  partition-n-items-into-k-bins-in-python-lazily
        if len(lista) == 1 or bins == 1:
            yield [lista]
        elif len(lista) > 1 and bins > 1:
            for i in range(1, len(lista)):
                for part in partition(lista[i:], bins - 1):
                    if len([lista[:i]] + part) == bins:
                        yield [lista[:i]] + part
    if ordered:
        for p in partition(l, k):
            yield p
    else:
        for p in multiset_partitions(l, k):
            yield p 
```

# sql - 如何在多个条件上加入，返回两个条件的所有组合

> ID：13131496
> 
> 赞同：74
> 
> 时间：2012-10-30T00:13:32.413
> 
> 标签：sql, sql-server, join

我敢打赌这是一个非常简单的答案，因为我是 SQL 的菜鸟。

表 1 有第 1 列（标准 1） 第 2 列（标准 2） 第 3 列（指标 1）

表 2 具有第 1 列（标准 1）第 2 列（标准 2）第 3 列（特定于 table2.criteria2 的指标 2）

对于表格上的每个标准 1，标准 2 的值可以是 1 - 5 个。

当我在这里使用 join 语句时（假设我在此之前将表 1 标识为 One）：

```
Select WeddingTable, TableSeat, TableSeatID, Name, Two.Meal
FROM table1 as One
inner join table2 as Two
on One.WeddingTable = Two.WeddingTable and One.TableSeat = Two.TableSeat 
```

即使我知道有 3 个或 4 个组合，我也只能得到一个标准 1/标准 2 组合。如何获得所有组合？

以有一场婚礼为例，table 1 基本上是座位表，table 2 是每个桌子/座位选择的用餐选项。表 1 具有方便的 TableSeatID，但表 2 没有可比较的 ID。

**样本数据：**

![在此处输入图像描述](../Images/27156bebbbd110a57a76b288fc95f6de.png)

结果需要显示所有 4 行，即 WeddingTable 001 的所有 3 个座位和 WeddingTable 002 的一个座位。

**期望的结果：**

![在此处输入图像描述](../Images/1e77af8a8f33da7fa21553c718676f4d.png)

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2014-05-28T02:35:27.653

```
select one.*, two.meal
from table1 as one
left join table2 as two
on (one.weddingtable = two.weddingtable and one.tableseat = two.tableseat) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T00:49:01.340

```
SELECT  aa.*,
        bb.meal
FROM    table1 aa
        INNER JOIN table2 bb
            ON aa.tableseat = bb.tableseat AND
                aa.weddingtable = bb.weddingtable
        INNER JOIN
        (
            SELECT  a.tableSeat
            FROM    table1 a
                    INNER JOIN table2 b
                        ON a.tableseat = b.tableseat AND
                            a.weddingtable = b.weddingtable
            WHERE b.meal IN ('chicken', 'steak')
            GROUP by a.tableSeat
            HAVING COUNT(DISTINCT b.Meal) = 2
        ) c ON aa.tableseat = c.tableSeat 
```

*   [***查看 SQLFiddle 演示***](http://sqlfiddle.com/#!3/edf38/8)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-04T23:35:00.043

```
create table a1
(weddingTable INT(3),
 tableSeat INT(3),
 tableSeatID INT(6),
 Name varchar(10));

insert into a1
 (weddingTable, tableSeat, tableSeatID, Name)
 values (001,001,001001,'Bob'),
 (001,002,001002,'Joe'),
 (001,003,001003,'Dan'),
 (002,001,002001,'Mark');

create table a2
 (weddingTable int(3),
 tableSeat int(3),
 Meal varchar(10));

insert into a2
(weddingTable, tableSeat, Meal)
values 
(001,001,'Chicken'),
(001,002,'Steak'),
(001,003,'Salmon'),
(002,001,'Steak');

select x.*, y.Meal

from a1 as x
JOIN a2 as y ON (x.weddingTable = y.weddingTable) AND (x.tableSeat = y. tableSeat); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T00:30:03.290

听起来您想列出所有指标？

```
SELECT Criteria1, Criteria2, Metric1 As Metric
FROM Table1
UNION ALL
SELECT Criteria1, Criteria2, Metric2 As Metric
FROM Table2
ORDER BY 1, 2 
```

如果您只需要一个 Criteria1+Criteria2 组合，请将它们分组：

```
SELECT Criteria1, Criteia2, SUM(Metric) AS Metric
FROM (
    SELECT Criteria1, Criteria2, Metric1 As Metric
    FROM Table1
    UNION ALL
    SELECT Criteria1, Criteria2, Metric2 As Metric
    FROM Table2
)
ORDER BY Criteria1, Criteria2 
```

# python - os.walk 爬取文件夹结构

> ID：13131497
> 
> 赞同：4
> 
> 时间：2012-10-30T00:13:50.273
> 
> 标签：python, os.walk

我有一些代码可以查看单个文件夹并提取文件。但现在文件夹结构已经改变，我需要在文件夹中搜索匹配的文件。

旧代码是什么样的

```
GSB_FOLDER = r'D:\Games\Gratuitous Space Battles Beta' 

def get_module_data():
    module_folder = os.path.join(GSB_FOLDER, 'data', 'modules')

    filenames = [os.path.join(module_folder, f) for f in
                  os.listdir(module_folder)]

    data = [parse_file(f) for f in filenames]

    return data 
```

但是现在文件夹结构变成了这样

*   GSB_FOLDER\数据\模块
    *   \folder1\data\modules
    *   \folder2\data\modules
    *   \folder3\data\modules

其中 folder1,2 或 3，可以是任何文本字符串

我如何重写上面的代码来做到这一点...有人告诉我 os.walk 但我只是在学习 Python...所以任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T00:19:24.457

您只需调用没有什么太大的变化`os.walk`，它会递归地遍历目录并返回文件，例如

```
for root, dirs, files in os.walk('/tmp'):
    if os.path.basename(root) != 'modules':
        continue
    data = [parse_file(os.path.join(root,f)) for f in files] 
```

在这里，我只检查名为“模块”的文件夹中的文件，您可以更改该检查以执行其他操作，例如在某处具有模块的路径`root.find('/modules') >= 0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:34:26.780

os.walk 是获取传递给它的目录中所有内容的目录结构的好方法；

在您的示例中，您可以执行以下操作：

```
for dirpath, dirnames, filenames in os.walk("...GSB_FOLDER"):
  #whatever you want to do with these folders
  if "/data/modules/" in dirpath:
    print dirpath, dirnames, filenames 
```

试试看，应该是相当自我解释它是如何工作的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:26:52.757

您可以`os.walk`像@Anurag 详细说明的那样使用，也可以试试我的小型[`pathfinder`](http://pypi.python.org/pypi/pathfinder/0.4.1)库：

```
data = [parse_file(f) for f in pathfinder.find(GSB_FOLDER), just_files=True] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-17T21:48:13.420

创建了一个函数，该函数具有爬取目录结构并返回匹配模式的文件和/或路径的一般目的。

```
import os
import re
import sys

def directory_spider(input_dir, path_pattern="", file_pattern="", maxResults=500):
    file_paths = []
    if not os.path.exists(input_dir):
        raise FileNotFoundError("Could not find path: %s"%(input_dir))
    for dirpath, dirnames, filenames in os.walk(input_dir):
        if re.search(path_pattern, dirpath):
            file_list = [item for item in filenames if re.search(file_pattern,item)]
            file_path_list = [os.path.join(dirpath, item) for item in file_list]
            file_paths += file_path_list
            if len(file_paths) > maxResults:
                break
    return file_paths[0:maxResults] 
```

示例用法：

*   directory_spider('/path/to/find') --> 如果存在，则查找路径中前 500 个文件
*   directory_spider('/path/to/find',path_pattern="",file_pattern=".py$", maxResults=10)

# javascript - 在 Shopify 新标准主题上修改图库图像宽度

> ID：13131499
> 
> 赞同：1
> 
> 时间：2012-10-30T00:14:00.150
> 
> 标签：javascript, e-commerce, gallery

我在弄清楚如何修改在 Shopify 上的 JS Colorbox 上运行的画廊时遇到了一些麻烦。 我的店面链接为[http://chillonbroadway-2.myshopify.com/](http://chillonbroadway-2.myshopify.com/)第二个滑块图像。我确信它与 javascript 有关，我是该语言的初学者，只知道如何修改 jqueries 或预制脚本。

请帮忙！

谢谢！

# javascript - js在屏幕上输入文字

> ID：13131505
> 
> 赞同：-2
> 
> 时间：2012-10-30T00:14:26.497
> 
> 标签：javascript, jquery

嘿伙计们，我有一个功能在我的本地主机上运行得很好，当我将它上传到服务器时它不起作用，有人可以指出我的解决方案：

```
var text = "some text";
var textArray = text.split("");
var looptimer;
function letterloop(){
    if (textArray.length > 0){
        $("#divx").append(textArray.shift());
    }
    else {
        clearTimeout(looptimer);
        var div = $("<a href=\"#\" onmousedown=\"javascript:continueOne();\" style=\"margin-top:70px; display:block; text-align:center;\" id=\"continue\" class=\"send_msg_blue\">continue</a>").hide().fadeIn(4000);
        $("#div").append(div);
        return false;
    }
    looptimer = setTimeout("letterloop()",60);
}
letterloop(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:49:58.510

你应该检查你引用的像jquery这样的js文件是否在服务器上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:34:53.400

您可能没有将`jquery.js`文件上传到您的服务器或将其包含在 HTML 中`<script src="jquery.js"></script>`。

# ios - 未调用 Tableview 滑动删除方法

> ID：13131507
> 
> 赞同：0
> 
> 时间：2012-10-30T00:14:53.253
> 
> 标签：ios, xcode, uitableview

我有一个奇怪的问题。我有一个 tableviewcontroller 子类 viewcontroller。

```
@interface TestViewController : UITableViewController<UISearchDisplayDelegate, UISearchBarDelegate>
@end 
```

当我在表格单元格上滑动时

```
-(void)tableView:(UITableView*)tableView willBeginEditingRowAtIndexPath:(NSIndexPath *)indexPath 
```

使用单元格右侧的删除按钮触发，当我单击删除时，单元格确实消失了，但是方法

```
- (void)tableView:(UITableView *)tv commitEditingStyle:(UITableViewCellEditingStyle)editingStyle
forRowAtIndexPath:(NSIndexPath *)indexPath 
```

从未调用...我想在调用 delete 时执行一些自定义代码，但我似乎无法这样做...我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:27:21.117

如果单元格消失了，但您的代码没有让它消失，那么其他一些类正在充当数据源并且正在实现`tableView:commitEditingStyle:forRowAtIndexPath:`并使单元格消失 - 因为，你看到了吗，即使按钮出现，细胞不会自行消失。

# python - 在 virtualenv 中通过 pip 安装 Matploblib 以推送到 Heroku

> ID：13131512
> 
> 赞同：2
> 
> 时间：2012-10-30T00:15:30.323
> 
> 标签：python, heroku

如何在 Heroku 上安装 numpy、scipy、matplotlib？

所以首先我在本地做 pip install matplotlib -> 我得到一个错误说 install numpy.. 所以我做 pip install numpy 并得到一个错误说

```
 File "/home/sghose/myapp/helloflask/build/numpy/numpy/distutils/command/build_src.py", line 385, in generate_sources

    source = func(extension, build_dir)

  File "numpy/core/setup.py", line 410, in generate_config_h

    moredefs, ignored = cocache.check_types(config_cmd, ext, build_dir)

  File "numpy/core/setup.py", line 41, in check_types

    out = check_types(*a, **kw)

  File "numpy/core/setup.py", line 271, in check_types

    "Cannot compile 'Python.h'. Perhaps you need to "\

SystemError: Cannot compile 'Python.h'. Perhaps you need to install python-dev|python-devel.

----------------------------------------
Command python setup.py egg_info failed with error code 1 in /home/sghose/myapp/helloflask/build/numpy 
```

...现在我该怎么做？通常我只会做 apt-get install python-numpy ...但后来我想 pip 不会拿起它，然后当我推动 Heroku 时会不高兴...我还看到他们重新编译 numpy 的以前的帖子，scipy，matplotlib 并更改了变量，以便它们指向 heroku 包（http://stackoverflow.com/questions/9819968/running-scipy-on-heroku）？这还有必要吗？感觉有点痛>_<

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:47:34.290

## Heroku 如何安装依赖项

当您将代码推送到 Heroku 时，Heroku*只会*查看您的`requirements.txt`文件并安装其中列出的包。

## 如何列出这些依赖项

Heroku 不关心您是如何创建该文件的（手动或使用`pip freeze`），因此没有什么能阻止您将包添加到`requirements.txt`文件中，您只需在其中添加一行带有需求名称的行。

## 这如何解决您的问题

将`matplotlib`行添加到`requirements.txt`文件后，您可以将代码推送到 Heroku，他们[会弄清楚如何](https://devcenter.heroku.com/articles/python-faq#can-i-require-modules-with-c-extensions)处理您的`matplotlib`要求。

如果这不起作用，您可以随时联系 Heroku，但如果唯一的要求是 python 标头，那么如果 Heroku 上没有它，我会感到惊讶。

* * *

Regarding local installation, Ben Mezger's answer is right, you just have to:

*   `apt-get install` the python headers (these are *not* a python package, so you don't install them with pip). Heroku likely has those available already.
*   Install the package using pip, it will then compile properly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:17:02.520

你需要安装 python-dev

```
apt-get install python-dev 
```

或者

```
apt-get install python-devel 
```

# scala - playframework - 如何在scala中设置选择输入

> ID：13131514
> 
> 赞同：2
> 
> 时间：2012-10-30T00:16:00.210
> 
> 标签：scala, playframework, playframework-2.0

所以我在页面上有一个表单，我试图在页面加载时预加载所有旧值。但是我在为选择对象实现这一点时遇到了一些麻烦。

我有以下用于生成选择的 scala 代码：

```
<select id="networkInterfaces">
            <option value="">First Available</option>
            @for(interface <- networkInterfaces) {
                @if(interface.Name == configs.last.networkInterfaceName) {
                    <option selected="selected" value="@interface.Name">@interface.DisplayName</option>
                } else {
                    <option value="@interface.Name">@interface.DisplayName</option>
                }
            }
        </select> 
```

当页面加载时，它确实显示所选的网络接口已被选中。但问题是，如果我更改了一些其他设置并提交它返回的是选项 html 而不是值。有没有办法在页面加载时为 scala 中的 select 选择表单值？我缺少一些基本的东西吗？否则，我将更改处理显示名称而不是值的方式...

**编辑**

由于我无法让它工作，我将值更改为@interface.DisplayName，然后将其转换为服务器上的代码。我希望能够正确地做到这一点，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T17:45:32.097

`<select id="networkInterfaces">`没有`name`指定的正确吗？

而不是你应该使用播放助手`@select`和`Form`对象。我认为这是处理表单值的更好方法。

```
@(form : Form[ABean])
@import helper._

@select(
form("configs.last.networkInterfaceName"),
options(networkInterfaces),
'_label -> "Interface Name",
'_default -> "First Available"
) 
```

`@select`有关助手访问 的更多信息： [https ://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/views/helper/select.scala.html](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/views/helper/select.scala.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T04:16:36.880

试试这个方法。

```
 <input type="hidden" id="groupIdRef" name="groupIdRef" value="@userRecord.groupId">
    @input(field=userRecordform("groupId"),'_label -> "") { (id, name, value, htmlArgs) =>
        <select id="groupId" name="groupId" @toHtmlArgs(htmlArgs)>
            options.map { v =>
                @for(g <- groups){
                  <option value=@g.id >@g.displayName</option>
                }
            }
        </select>
    } 

// User JavaScript this onload function
window.onload = function() {    
document.getElementById('groupId').value = document.getElementById('groupIdRef').value;
} 
```

这对我来说是工作。

# python - Python 会改变我的字节串吗？

> ID：13131517
> 
> 赞同：0
> 
> 时间：2012-10-30T00:16:37.040
> 
> 标签：python, c, string, bytearray

Python会改变我的字符串吗？

![在此处输入图像描述](../Images/aaabe46e492fb2caaa424761015bae52.png)

相关的问题是[我在我的 python 中使用了一些 shellcode 但失败了](https://stackoverflow.com/questions/13125651/i-was-using-a-little-shellcode-in-my-python-but-failed)

PS：我在怀疑Python字符串或C字符串的结束字符是什么，如果字符串有结束字符，如何处理？这与这个问题有关吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T00:19:04.263

```
>>> chr(int('49', 16))
'I' 
```

其实`\x49` *是* `I`。

* * *

对此有一点解释：

`\x49`表示“十六进制代码为 49 的字符。十六进制中的 49 是`int('49', 16)`: `73`.`73`是 的 ASCII 字符代码`I`，您可以使用以下代码进行验证：`ord('I')`: `73`。

# jquery - JQuery 选择器最佳实践

> ID：13131521
> 
> 赞同：-1
> 
> 时间：2012-10-30T00:17:12.003
> 
> 标签：jquery, asp.net, asp.net-mvc

当公开将在多个页面中使用的 jquery 脚本时，是否首选将选择器基于 id 或 css 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T05:59:23.600

最佳实践是在需要选择页面中唯一的元素时同时使用 id 和在需要选择多个元素时使用类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:28:48.290

类选择器旨在选择多个元素，而如果您使用 ID 选择器，则预计只有一个元素会匹配选择。仅这一点就会让我认为 ID 选择器更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:28:55.157

保持 id 在页面上的唯一性通常是一种很好的做法。因此，如果您根据 id 进行选择，则脚本只能应用于页面上的 1 个元素。

如果您使用类，则可以将脚本应用于多个元素。

这完全取决于您的脚本需要什么。

我会考虑你的脚本的*语义*。它应该适用于事物的*特定*实例（id）还是某些事物类别（css 类）？

# java - java.sql.PreparedStatement.setString 函数让 Varchars 与双精度数混淆

> ID：13131522
> 
> 赞同：3
> 
> 时间：2012-10-30T00:17:27.093
> 
> 标签：java, mysql, tomcat, jdbc

我有一个用 java 编写的 servlet/tomcat 服务器。

我有一个我编写的 mysql 类，我一直在使用其中的函数将准备好的语句插入到使用 jdbc 的 mysql 数据库中。

我调用的函数`java.sql.PreparedStatement.setString`用于设置准备好的语句的参数。这已经连续几个月完美地适用于数千种不同的输入，没有问题。

然而，最近，当尝试使用该函数将 ip 地址插入 VARCHAR 类型的 mysql 列时，我收到如下异常抛出：

```
com.mysql.jdbc.MysqlDataTruncation: Data truncation: Truncated incorrect DOUBLE value: '10.1.1.101' 
```

这很奇怪，在我的代码中任何地方都没有 DOUBLE 的概念，mysql 表上的“显示列”确保数据类型实际上是 VARCHAR。我让我的同事也查看了这个，以仔细检查我没有遗漏一些简单的东西。然而我们都被难住了。

我唯一的理论是 JDBC 驱动程序或 SetText 函数冒昧并假设 DOUBLE 数据类型，因为 IP 地址的第一部分采用 XX.XX 的形式

任何帮助都会很棒，请不要告诉我做明显的事情，比如检查我的列数据类型等。我花了很多时间检查所有内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T12:24:00.303

问题不在于 JDBC 驱动程序。问题出在 MySQL 上。这是我在 MySQL commadline 上得到的：

```
mysql> INSERT INTO route_table (SYSTEM, IP, PORT) VALUES ("192.168.1.24:8080","192.168.1.24","8080") ON DUPLICATE KEY UPDATE IP=values(IP) AND PORT=values(PORT);
Query OK, 1 row affected (0.04 sec)

mysql> INSERT INTO route_table (SYSTEM, IP, PORT) VALUES ("192.168.1.24:8080","192.168.1.24","8080") ON DUPLICATE KEY UPDATE IP=values(IP) AND PORT=values(PORT);
ERROR 1292 (22007): Truncated incorrect DOUBLE value: '192.168.1.24'
mysql> 
```

问题是，`INSERT INTO .... ON DUPLICATE KEY UPDATE`您使用的语法不正确。您使用了关键字`AND`而不是使用`,`*(comma)*。所以查询应该是：

```
mysql> INSERT INTO route_table (SYSTEM, IP, PORT) VALUES ("192.168.1.24:8080","192.168.1.24","8080") ON DUPLICATE KEY UPDATE IP=values(IP), PORT=values(PORT);
Query OK, 2 rows affected (0.00 sec) 
```

# ruby - 将数组中的元素 i 旋转到 j

> ID：13131523
> 
> 赞同：1
> 
> 时间：2012-10-30T00:17:30.330
> 
> 标签：ruby

给定一个数组：

```
a = [1, 2, 3, 4, 5, 6] 
```

我想在某个方向上`i`旋转`j`元素`n`。因此，例如：

```
i = 2
j = 3
n = 1 
```

旋转`a`会产生：

```
new_a = [1, 2, 4, 3, 5, 6] 
```

这就是我所拥有的：

```
def rotate_sub(a, i, j, n)
  return a[0...i] + a[i..j].rotate(n) + a[j+1..-1]
end 
```

有一个更好的方法吗？由于没有边界检查，`i`或者`j`很可能超出数组的范围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:27:22.920

如果您愿意改变原始数组，您可以执行以下操作：

```
a[i..j] = a[i..j].rotate n 
```

但我喜欢你已经拥有的功能性解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T00:27:39.770

我不认为有什么神奇的方法，所以也许最简单的就是最好的：

```
def rotate_sub(a, i, j, n)
  a[0...i] + a[i..j].rotate(n) + a[j+1..-1] if i < j && j < a.size
end 
```

# html - XSL 用于 Xml 到表的转换

> ID：13131529
> 
> 赞同：2
> 
> 时间：2012-10-30T00:18:19.740
> 
> 标签：html, xml, xslt, xpath

跟进我昨天的 xslt 问题，链接如下。

[第一个最后一个元素第二个变化](https://stackoverflow.com/questions/13116208/first-last-element-2nd-variation#comment17836389_13116208)

我必须将每个部分的第一个和最后一个页码输出到一个表中。

我很困惑从哪里开始。XSLT 1.0 解决方案和 XSLT 2.0 解决方案将不胜感激。我真的很感激任何给定的帮助。

问候JJ。

输入：

```
<root>
  <page number="1" section="Arsenal">Arsenal</page> 
  <page number="2" section="Arsenal">Arsenal</page> 
  <page number="3" section="Arsenal">Arsenal</page> 
  <page number="4" section="Arsenal">Arsenal</page> 
  <page number="5" section="Arsenal">Arsenal</page> 
  <page number="6" section="Arsenal">Arsenal</page> 
  <page number="7" section="Chelsea">Chelsea</page> 
  <page number="8" section="Chelsea">Chelsea</page> 
  <page number="9" section="Chelsea">Chelsea</page> 
  <page number="10" section="Chelsea">Chelsea</page> 
  <page number="11" section="Chelsea">Chelsea</page> 
  <page number="12" section="Chelsea">Chelsea</page> 
  <page number="13" section="ManUnited">ManUnited</page> 
  <page number="14" section="ManUnited">ManUnited</page> 
  <page number="15" section="ManUnited">ManUnited</page> 
  <page number="16" section="ManUnited">ManUnited</page> 
  <page number="17" section="ManUnited">ManUnited</page> 
  <page number="18" section="ManUnited">ManUnited</page> 
  <page number="19" section="ManCity">ManCity</page> 
  <page number="20" section="ManCity">ManCity</page> 
  <page number="21" section="ManCity">ManCity</page> 
  <page number="22" section="ManCity">ManCity</page> 
  <page number="23" section="ManCity">ManCity</page> 
  <page number="24" section="ManCity">ManCity</page> 
 </root> 
```

输出：

```
<tr><td>1</td><td>Arsenal</td><td>6</td></tr>
<tr><td>7</td><td>Chelsea</td><td>12</td></tr>
<tr><td>13</td><td>ManU</td><td>18</td></tr>
<tr><td>19</td><td>Mancity</td><td>24</td></tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:09:21.257

利用：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" omit-xml-declaration="yes" indent="yes"/>

  <xsl:key name="k" match="page" use="@section"/>

  <xsl:template match="/root">
    <table>
      <xsl:apply-templates select="page[generate-id() = generate-id(key('k', @section))]"/>
    </table>
  </xsl:template>

  <xsl:template match="page">
    <tr>
      <td>
        <xsl:value-of select="@number"/>
      </td>
      <td>
        <xsl:value-of select="."/>
      </td>
      <td>
        <xsl:value-of select="key('k', @section)[last()]/@number"/>
      </td>
    </tr>
  </xsl:template>
</xsl:stylesheet> 
```

输出：

```
<table>
  <tr>
    <td>1</td>
    <td>Arsenal</td>
    <td>6</td>
  </tr>
  <tr>
    <td>7</td>
    <td>Chelsea</td>
    <td>12</td>
  </tr>
  <tr>
    <td>13</td>
    <td>ManUnited</td>
    <td>18</td>
  </tr>
  <tr>
    <td>19</td>
    <td>ManCity</td>
    <td>24</td>
  </tr>
</table> 
```

# sharepoint-2010 - 内容查询 Webpart

> ID：13131530
> 
> 赞同：0
> 
> 时间：2012-10-30T00:18:26.193
> 
> 标签：sharepoint-2010, content-query-web-part

我正在使用内容查询 Web 部件来显示页面库中的页面。我想将我的 Web 部件配置为根据页面查看次数显示页面。最受欢迎的页面（根据查看次数）应位于顶部。它是 SharePoint 2010 中的开箱即用功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T15:25:23.823

简单的回答：不，这不是开箱即用的。

为此，您需要将页面查看次数添加到页面项目，然后使用 Content By Query Web 部件按此数量排序。这不是一个开箱即用的解决方案。

您可以使用评分系统显示最受欢迎的页面，但这与基于查看次数的评分系统不同。

# ios - 在 iOS 上使用 AVCodec 将原始 YUV420P 编码为 h264

> ID：13131533
> 
> 赞同：4
> 
> 时间：2012-10-30T00:18:52.387
> 
> 标签：ios, encoding, ffmpeg

我正在尝试将从 a 收集到的单个 YUV420P 图像编码`CMSampleBuffer`为 an `AVPacket`，以便我可以使用 RTMP 通过网络发送 h264 视频。

发布的代码示例似乎可以作为`avcodec_encode_video2`返回`0`（成功）但`got_output`也是`0`（`AVPacket`为空）。

有没有人在可能知道我做错了什么的 iOS 设备上编码视频的经验？

```
- (void) captureOutput:(AVCaptureOutput *)captureOutput
 didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
        fromConnection:(AVCaptureConnection *)connection {

  // sampleBuffer now contains an individual frame of raw video frames
  CVPixelBufferRef pixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);

  CVPixelBufferLockBaseAddress(pixelBuffer, 0);

  // access the data
  int width = CVPixelBufferGetWidth(pixelBuffer);
  int height = CVPixelBufferGetHeight(pixelBuffer);
  int bytesPerRow = CVPixelBufferGetBytesPerRowOfPlane(pixelBuffer, 0);
  unsigned char *rawPixelBase = (unsigned char *)CVPixelBufferGetBaseAddressOfPlane(pixelBuffer, 0);

  // Convert the raw pixel base to h.264 format
  AVCodec *codec = 0;
  AVCodecContext *context = 0;
  AVFrame *frame = 0;
  AVPacket packet;

  //avcodec_init();
  avcodec_register_all();
  codec = avcodec_find_encoder(AV_CODEC_ID_H264);

  if (codec == 0) {
    NSLog(@"Codec not found!!");
    return;
  }

  context = avcodec_alloc_context3(codec);

  if (!context) {
    NSLog(@"Context no bueno.");
    return;
  }

  // Bit rate
  context->bit_rate = 400000; // HARD CODE
  context->bit_rate_tolerance = 10;
  // Resolution
  context->width = width;
  context->height = height;
  // Frames Per Second
  context->time_base = (AVRational) {1,25};
  context->gop_size = 1;
  //context->max_b_frames = 1;
  context->pix_fmt = PIX_FMT_YUV420P;

  // Open the codec
  if (avcodec_open2(context, codec, 0) < 0) {
    NSLog(@"Unable to open codec");
    return;
  }

  // Create the frame
  frame = avcodec_alloc_frame();
  if (!frame) {
    NSLog(@"Unable to alloc frame");
    return;
  }
  frame->format = context->pix_fmt;
  frame->width = context->width;
  frame->height = context->height;

  avpicture_fill((AVPicture *) frame, rawPixelBase, context->pix_fmt, frame->width, frame->height);

  int got_output = 0;
  av_init_packet(&packet);
  avcodec_encode_video2(context, &packet, frame, &got_output)

  // Unlock the pixel data
  CVPixelBufferUnlockBaseAddress(pixelBuffer, 0);
  // Send the data over the network
  [self uploadData:[NSData dataWithBytes:packet.data length:packet.size] toRTMP:self.rtmp_OutVideoStream];
} 
```

注意：众所周知，这段代码存在内存泄漏，因为我没有释放动态分配的内存。

**更新**

我更新了我的代码以使用@pogorskiy 方法。如果输出返回 1，我只会尝试上传帧，并在完成视频帧编码后清除缓冲区。

# jquery - 如何循环访问 JSON 对象成员变量？

> ID：13131535
> 
> 赞同：0
> 
> 时间：2012-10-30T00:18:57.910
> 
> 标签：jquery, json, loops

我有一个 JSON 响应对象，例如：

> {"1":"缺席","2":"已售出","3":"已售出","4":"已售出","5":"已售出","6":"已售出"," 7":"已售出","8":"已售出","9":"已售出"}

如何循环遍历对象的所有成员变量？

反应是可变的。它可能是这样的：

> {"5":"缺席","23":"已售出","24":"已售出","26":"已售出","29":"已售出","41":"已售出"," 42":"已售出","42":"已售出","42":"已售出"}

json查询：

```
$.getJSON(myurl + '?action=21' + '&token=' + token + '&id=' + total + '&sell=1', 
   function(data){ 
    for (var i = '0'; i < reply.length; i++) {
    var obj = data[i][2];
    alert(obj);
  } 
}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T00:24:45.437

在 Javascript 中，`for in`循环遍历对象的键。所以你想要这个：

```
var i;
for (i in data) {
  if (data.hasOwnProperty(i)) {
    alert(data[i]);
  }
} 
```

这[`hasOwnProperty(i)`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)是使用这种循环样式时推荐的步骤。对于像这样简单的普通对象，这不是完全必要的，但它也是一个好习惯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:26:06.013

利用`for`

```
var data = {
    "1": "absent",
    "2": "sold",
    "3": "sold",
    "4": "sold",
    "5": "sold",
    "6": "sold",
    "7": "sold",
    "8": "sold",
    "9": "sold"
};

for (key in data) {

    console.log(data[key])
}​; 
```

[小提琴](http://jsfiddle.net/sushanth009/nqHd7/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:24:30.400

小提琴 - [http://jsfiddle.net/tariqulazam/qAWbW/](http://jsfiddle.net/tariqulazam/qAWbW/)

```
var data = {"1":"absent","2":"sold","3":"sold","4":"sold","5":"sold","6":"sold","7":"sold","8":"sold","9":"sold"};

for (var key in data) {          
    console.log(key + '----' + data[key]);
}​ 
```

这应该适合你

```
$.getJSON(myurl + '?action=21' + '&token=' + token + '&id=' + total +
'&sell=1', 
function(data){ 
   for (var key in data) {          
       console.log(key + '----' + data[key]);
   }  ​
}); 
```

# mongodb - 当 mongod 使用 auth=true 运行时，Mocha 测试失败

> ID：13131541
> 
> 赞同：0
> 
> 时间：2012-10-30T00:19:41.757
> 
> 标签：mongodb, testing, mongoose, mocha.js

我正在尝试通过 MongooseJS 设置 Mocha 测试 NodeJS 到 MongoDB 上的一些简单的杂物。

如果我使用 auth=false 运行 mongod，测试都可以正常工作（并通过）

但是，如果我使用 auth=true 运行 mongod，一切都会失败，即使我在 URI 中指定了用户名和密码，如下所示：

```
mongodb://thisIsMyUsername:thisIsMyPassword@127.0.0.1/theDataBaseName 
```

关于为什么失败的任何想法？

是否无法针对需要身份验证的 Mongo 数据库进行测试？

# python - 从 Twisted 工厂 (Python) 获取对象实例

> ID：13131542
> 
> 赞同：0
> 
> 时间：2012-10-30T00:19:53.957
> 
> 标签：python, multithreading, networking, asynchronous, twisted

我正在使用带有以下代码的 autobhan websockets 库：

```
 from twisted.internet import reactor
    from autobahn.websocket import WebSocketServerFactory, \
                                   WebSocketServerProtocol, \
                                   listenWS

    class EchoServerProtocol(WebSocketServerProtocol):

       def onMessage(self, msg, binary):
          self.sendMessage(msg, binary)

       def sendRandomMessage(message):
          self.sendMessage(message,true)

    if __name__ == '__main__':

       factory = WebSocketServerFactory("ws://192.168.1.135:9999", debug = False)
       factory.protocol = EchoServerProtocol
       listenWS(factory)
       reactor.run()

       #insert random code here.  Things happen independent of the connection state.
       #somehow access EchoServerProtocolINSTANCE.sendMessage("MESSAGE_HERE") 
```

该代码适用于接收消息，但我如何访问 EchoServerProtocol 的实例以便随时发送任意消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T07:07:22.130

一种方法是向工厂注册您的协议实例，并通过工厂与您的应用程序的其余部分进行通信。

这是一个例子：

[https://github.com/tavendo/AutobahnPython/blob/master/examples/websocket/broadcast/server.py#L34](https://github.com/tavendo/AutobahnPython/blob/master/examples/websocket/broadcast/server.py#L34)

在这个例子中，每个协议实例都会在 WebSocket 会话建立后在工厂中注册自己。然后，您可以通过工厂向所有当前连接的协议实例广播消息。

# python - 给随机选择例外

> ID：13131547
> 
> 赞同：2
> 
> 时间：2012-10-30T00:20:34.280
> 
> 标签：python

现在我一直在尝试制作我自己版本的游戏线索，但我似乎无法找到如何做到这一点。我正在努力做到这一点，如果猜测是错误的，它会从其他猜测中给出提示，这不是真正的“杀手”，也不是他们之前的任何猜测。我将举一个类似的例子：

```
 a = input()
    b = input()
    c = input()
    d = input()
    e = input()
    f = input()
    hint = random.choice([a,b,c,d,e,f])
    hint != killer
    hint != previous_guess 
```

现在我知道提示 != 杀手和提示 != previous_guess 并没有真正做任何事情，因为提示是之前分配的。我想知道是否有任何方法可以使它从不是杀手或先前猜测的变量中随机选择。提前致谢！哦，我还想指出我正在使用 python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:00:00.660

您可以使用一组并减去您不想要的，例如

```
hint = random.choice(list({a, b, c, d, e, f} - {killer, previous_guess})) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:57:51.940

这是您可以做到的基本方法。这使用了所谓的[列表推导](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)的概念，以便以有效的方式生成列表。`.format()`表示字符串格式，它允许您将变量传递到各种格式的字符串中（此处的文档，[但](http://docs.python.org/2/library/string.html#format-string-syntax)现在只知道`{0}`指的是 的第一个参数`format()`）。

`names`使用上述列表推导生成，它在语法上等价于：

```
names = []
for i in range(6):
    names.append(raw_input('Enter a name: ') 
```

此模式稍后用于生成您的列表，而无需杀手或先前的猜测。很高兴解释任何没有意义的部分（感谢@JonClements 指出我留下的一些奇怪之处）：

```
import random

# Choose your names
names = [raw_input('Enter killer name: ') for i in xrange(6)]

# Choose a killer
killer = random.choice(names)

# Run for as many times as you want (here we do 6; could also be len(names)
max_guesses = 6

for guessno in xrange(max_guesses):
  guess = raw_input('Guess the killer: ')
  # If the guess is not the killer...
  if guess != killer:
    # This line creates a list that does not include the killer nor the guess
    hint = random.choice([n for n in names if n not in [killer, guess]])
    print 'Hint, the killer is not {0}'.format(hint)
  else:
    print 'Correct! The killer is {0}'.format(guess)
    break 
```

# css - 垂直线在不同的浏览器中改变长度，这是正常的吗？

> ID：13131550
> 
> 赞同：1
> 
> 时间：2012-10-30T00:21:01.870
> 
> 标签：css

我设计了一个 3 列站点，我想在每列之间放置一条细水平线。我很容易做到这一点，并在 Chrome 中获得了我想要的确切高度，然后我在 Firefox 中打开它，水平线短了大约 10px，IE9 也发生了同样的事情。这是正常的还是我做错了什么？无论如何要解决这个问题或做得更好。这是我使用的 css，html 只是一个 div：

```
 #horizontal-dividing-line-news-arabnews {
    border-left: solid 0.1em #0099FF;
    height: 31.8em;
    float: left;
    color: #FFF;
    margin-top: 7.3em;
} 
```

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:24:41.407

您在`em`这里使用 ("ems") 作为大小的单位。

“Ems”与当前字体大小成正比，浏览器可能并非都具有相同的默认字体大小，因此这就是大小不同的原因。

您需要为此使用`px`（像素）。

# java - ArrayList 的类型不兼容错误

> ID：13131552
> 
> 赞同：0
> 
> 时间：2012-10-30T00:21:55.077
> 
> 标签：java, types, arraylist

在我的 Java 类中，我定义了这个属性：

```
private ArrayList requests; 
```

这是类中的构造函数：

```
public LeaveRecord() {
    this.requests = new ArrayList<Request>();
    this.daysLeft = ALLOWANCE;
} 
```

在另一种方法中，我试图`Request`根据 ArrayList 的索引返回相关对象。

```
public Request getRequestAt(int index) {
    try {
        return this.requests.get(index);
    } catch (IndexOutOfBoundsException e) {
        return null;
    }
} 
```

但是我在返回行（上面代码片段中的第 3 行）上收到一个错误，说它需要`leaverecord.Request`但找到`java.lang.Object`.

我不知道可能出了什么问题，因为我将 ArrayList 定义为 type `Request`。

有人能指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:23:43.393

将其更改为

```
private ArrayList requests;

private ArrayList<Request> requests 
```

但是，当您说时，编译器应该向您显示以下警告

```
 private ArrayList requests; 
```

`ArrayList is a raw type. References to generic type ArrayList<E> should be parameterized`

# javascript - slideToggle 一个 div 并在另一个 div 中移动一个按钮

> ID：13131553
> 
> 赞同：0
> 
> 时间：2012-10-30T00:22:09.247
> 
> 标签：javascript, jquery, css, slidetoggle, dom-manipulation

如何使用 css 和 jquery 做到这一点？

如[jsfiddle](http://jsfiddle.net/Vinyl/ar9UB/)所示，左栏中有一个按钮。单击此按钮幻灯片可切换右列中的 div，并出现另外 2 张图片（图片编号 2，图片编号 3）

我想做两件事：

第一个：将按钮准确定位在图片编号 1 的左下角。我实际上做不到，因为我不知道左栏中有多少文字，也不知道图片 1 的高度。

第二：当显示或隐藏 div 时，我希望按钮与 div 一起移动。最后，按钮应位于图片编号 3 的左下方

你能帮我做吗？

html结构是基本的：

```
<div id="col_1">
    <p>Lorem ipsum<br />...<br /></p>
    <p><span id="button">see more pic</span></p>
</div>

<div id="col_2">
    <div id="pic_1">picture number 1</div>
    <div id="pic" class="hidden">      
        <div id="pic_2">picture number 2</div>
        <div id="pic_3">picture number 3</div>
    </div>
</div> 
```

jquery 是基本的：

```
$("#button").click(function () {
      $("#pic").slideToggle("slow");
    }); 
```

css 也很简单。你可以在 jsfiddle 上看到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:31:53.577

你可以做相对位置。这是演示：jsfiddle.net/ar9UB/5/

添加了这个CSS：

```
#button { position:relative; left: -90px; top:-20px; } 
```

并移动了第 2 列中的按钮。

希望这可以帮助。

# c# - “提供者模型”——业务层在哪里？

> ID：13131559
> 
> 赞同：-4
> 
> 时间：2012-10-30T00:23:03.327
> 
> 标签：c#, asp.net, .net, provider-model

有人可以解释提供者模型的哪一部分最能代表业务层吗？

业务规则和业务逻辑应该放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:54:12.970

如果您的意思是 .net 中的 Membership Provider，我会说业务层将提供者用作服务（如 John 所说）。虽然如果您自己实现提供程序，这条线有点灰（比如用户是业务对象吗？如果是这样，那么提供程序逻辑中的规则呢？）。

通常，提供程序是与业务应用程序分开开发的，因为它们更多是基础设施类型的代码。

但是，如果您只对提供程序部分感兴趣，那么您通常在提供程序中具有以下部分：1\. 基础设施内容（配置读取/数据库通信/等） 2\. 提供程序接口（为消费代码提供服务） 3\. “业务”对象和规则

我猜业务层将是特定提供者的实现（通常有一个实现基础设施的基类）。例如，会员提供者处理用户和会员对象，并且有一些关于如何做它作为提供者的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:32:45.107

除非您在谈论与我不同的“提供者模型”，否则与业务*层*没有关系。

提供者模型只是一种架构，其中一个或多个组件提供一组服务。例如，在 LINQ 中，LINQ Provider 提供到数据存储或其他数据源的映射，而 .NET Framework 类提供其余部分。

# ajax - jquery ajax传递多个参数

> ID：13131560
> 
> 赞同：0
> 
> 时间：2012-10-30T00:23:08.913
> 
> 标签：ajax, jquery

我正在尝试使用 jquery 通过 ajax 传递两个请求参数。以下是我所做的：

```
function querySummary(){
$.ajax({
    type:"POST",
    url:"internalSummary.action",
    data:{starttime:$("#starttime").val(),endtime:${"#endtime"}.val()},
    success: function(data) {
        $("#hello").html( data );
    }
}); 
```

}

我正在尝试传递 starttime 和 endtime 两个参数，但是得到

```
Uncaught SyntaxError: Unexpected token ILLEGAL 
```

任何人都可以就如何解决这个问题提出一些建议吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:25:41.180

您在第二个 jquery 选择中使用大括号而不是括号。 `data`应该如下：

```
{starttime:$("#starttime").val(),endtime:$("#endtime").val()} 
```

值的名称可以加引号或不加引号；javascript 假定它们是名称而不是变量。

# twitter - Wordpress 推特插件

> ID：13131567
> 
> 赞同：0
> 
> 时间：2012-10-30T00:24:05.170
> 
> 标签：twitter, wordpress

我正在使用[位于 wordpress 插件目录中的 wordpress 插件“](http://wordpress.org/extend/plugins/twitter-for-wordpress/) **Twitter for Wordpress** ” ，然后它似乎突然停止获取我的推文，显示“没有公共 Twitter 消息”。

我转到插件 url 并发现演示显示相同的错误消息，我试图联系开发人员进行代码更新，因为这个插件已经超过 2 年没有更新了。它可能不再得到维护或支持，并且在与更新版本的 WordPress 一起使用时可能会出现兼容性问题，但没有成功。

由于不熟悉 PHP，我问任何可以帮助我修改代码的人，以便插件可以恢复工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T19:09:54.657

首先，您可以查看 Twitter 资源 URL 的插件配置或 PHP 代码吗？由于 Twitter 已删除版本“0”，因此遗留代码可能是问题所在。

见[https://dev.twitter.com/docs/api/1.1](https://dev.twitter.com/docs/api/1.1)

否则，您应该查看另一个插件解决方案。Twitter 一直在进步，你需要一个跟随更新的插件

# scala - 在 Scala 中使用 case 语句破坏元组的规则

> ID：13131568
> 
> 赞同：7
> 
> 时间：2012-10-30T00:24:10.913
> 
> 标签：scala

我有以下代码：

```
val xs = List(('a', 1), ('a', 2), ('b', 3), ('b', 4)) 
```

我想把它变成一张地图。例如`Map('a' -> Seq(1,2), 'b' -> Seq(3,4))`。所以我继续编写转换：

```
xs.groupBy(_._1) map {
  case (k, v) => (k, v.map(_._2))
} 
```

为什么 map 后面的大括号必须是`{`. 当我开始时，我认为我可以做到以下几点：

```
xs.groupBy(_._1).map(case (k, v) => (k, v.map(_._2))) 
```

但这不编译。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-30T00:34:24.770

因为 .map[方法接受一个函数](https://github.com/scala/scala/blob/v2.9.2/src/library/scala/collection/GenTraversableLike.scala#L154)

你实际上写的是

```
map({
  case (k, v) => (k, v.map(_._2))
}) 
```

并且是*模式匹配匿名函数*（[SLS](http://www.scala-lang.org/docu/files/ScalaReference.pdf)，§8.5）`{ case (k, v) => (k, v.map(_._2)) }`的快捷定义，它是[函数种类之一](http://www.scala-lang.org/api/current/scala/PartialFunction.html)：

 *```
val isOdd: PartialFunction[Int, String] = {
   case x if x % 2 == 1 => x+" is odd"
}

val upcastedIsOdd: Function[Int, String] = {
   case x if x % 2 == 1 => x+" is odd"
} 
```

您不能省略大括号（因此您将失去部分功能和模式匹配的精确性），但您可以跳过普通大括号（并且仍然保留部分功能），就像在下面的代码段中一样：

```
scala> List(1,2,3).take(1)
//res0: List[Int] = List(1)
scala> List(1,2,3) take 1
//res1: List[Int] = List(1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T22:13:58.047

这里真正的问题似乎是什么时候可以使用括号`(`代替大括号`{`来表示匿名函数。我建议看一下 Daniel Sobral 对这个问题的[回答](https://stackoverflow.com/a/4387118/500314)：[Scala 中大括号和圆括号之间的形式区别是什么，什么时候应该使用它们？](https://stackoverflow.com/q/4386127/500314)*

# bash - 使用 Sleep 运行 Bash 脚本 6 小时

> ID：13131570
> 
> 赞同：0
> 
> 时间：2012-10-30T00:24:22.763
> 
> 标签：bash, sleep

您如何使用 sleep 功能每分钟运行 bash 脚本 6 小时？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:31:41.247

设置一个 cron 作业不是更容易吗？

```
min hour     day month weekday command
*/1 10-15    *   *     *       /path/to/your/script 
```

10-16 是运行 6 小时块的示例。10 是上午 10 点，15 是下午 3 点

# sharepoint - 超过 20 分钟的 SharePoint 工作流

> ID：13131572
> 
> 赞同：1
> 
> 时间：2012-10-30T00:24:38.223
> 
> 标签：sharepoint

我们有一些持续超过 20 分钟的同步工作流程。看起来工作流程正在成功启动和完成。但是在工作流设置页面上，它说工作流即使在完成后仍在运行。仅当工作流程持续时间超过 20 分钟时才会发生这种情况。似乎某处发生了超时。但是我们所有的超时在 IIS 中都设置为 60 分钟。是否有我缺少的超时设置？除了 IIS 之外还有什么地方有超时设置？或者，我还有什么遗漏的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T09:58:00.070

是 SharePoint 2010 吗？

**工作流超时：**超时设置指定工作流计时器作业在被认为已停止响应并被迫停止处理之前必须完成的时间量（以分钟为单位）。超时的作业将返回到队列中以便稍后重新处理。默认超时时间为五分钟。

```
stsadm -o setproperty -pn workflow-eventdelivery-timeout -pv "10" 
```

# mysql - 如何在下面编写 SQL 以显示所有详细信息

> ID：13131573
> 
> 赞同：8
> 
> 时间：2012-10-30T00:24:38.880
> 
> 标签：mysql, sql, database

我不知道我在使用 sql 时是否正确地执行了以下方法，但它就在这里。

我想显示所有考试详细信息（考试详细信息（也称为会话）、考试中的问题、答案、罚分、图像、视频等）但我尝试这样做的方式是一个大查询，但它不能正常工作正在显示行。

以下是我想为一项考试（而且只有一项考试）显示的内容：

*   考试详情
*   考试中的所有问题
*   每个问题的所有答案并标记每个答案的价值
*   惩罚（查看是否启用）
*   错误答案的扣分
*   有问题的图片
*   问题中的视频
*   有问题的音频
*   模块详情
*   学生

下面显示了上述每个部分需要从数据库中获取的字段：

*   考试详情

    `SessionId, SessionName, SessionDuration, TotalMarks, SessionWeight`

*   考试中的所有问题

    `QuestionId, QuestionNo, QuestionContent, NoofAnswers, QuestionMarks, OptionId, OptionType, ReplyId, ReplyType`

*   每个问题的所有答案并标记每个答案的价值

`AnswerId, Answer, AnswerMarks`

*   惩罚（查看是否启用）

`PenaltyEnabled`

*   处罚答案

`PenaltyAnswerId, PenaltyAnswer, PenaltyMarks`

*   有问题的图片

`ImageId, ImageFile`

*   问题中的视频

`VideoId VideoFile`

*   有问题的音频

`AudioId, AudioFile`

*   模块详情

`ModuleId, ModuleNo, ModuleName`

*   学生

`StudentId`

我的问题是应该如何编写 SQL 代码才能显示所有这些数据？我只需要一个大查询还是很多小查询？我的尝试是问题的底部，但下面是数据库表，其中显示了处理一项考试及其所有详细信息的详细信息。

**表格：**

**学生**

```
StudentId (PK)  StudentForename  StudentSurname
1              James            Parker 
```

**Student_Session**

```
SessionId (FK)  StudentId (FK)
1              1 
```

**会议**

```
SessionId (PK) SessionName  SessionDuration  TotalMarks  SessionWeight  ModuleId (FK)
1             AAA          01:00:00        30         20            1 
```

**模块**

```
ModuleId (PK)  ModuleNo  ModuleName
1              CHI2513   ICT 
```

**问题**

```
SessionId FK) QuestionId (PK)  QuestionNo QuestionContent NoofAnswers QuestionMarks OptionId (FK) ReplyId (FK)
1             4                1           Question 1      1           5              1            1
1             5                2           Question 2      1           3              2            1
1             6                3           Question 3      2           6              2            2
1             7                4           Question 4      3           7              5            2
1             8                5           Question 5      1           9              5            1 
```

**回答：**

```
AnswerId (PK) Answer  QuestionId (FK)
1              A       4
2              C       5
3              A       6
4              B       6
5              B       7
6              D       7
7              E       7
8              G       8 
```

**个人回答**

```
IndividualId (PK)  AnswerId (FK) AnswerMarks  
1                    1              3       
2                    2              5       
3                    3              3       
4                    4              3       
5                    5              2       
6                    6              2       
7                    7              3       
8                    8              9 
```

**惩罚**

```
PenaltyId(PK) SessionId (FK)  PenaltyEnalbed
1             1               1 
```

**罚分**

```
PenaltyAnswerId (PK) PenaltyAnswer PenaltyMarks QuestionId (FK)
1                     B            1            4
2                     C            1            4
3                     A            1            5
4                     B            1            5
5                     D            1            5
6                     C            2            6
7                     D            2            6
8                     A            1            7
9                     C            1            7
10                    F            1            7
11                    G            1            7
12                    A            0            8
13                    B            0            8
14                    C            1            8
15                    D            1            8
16                    E            1            8
17                    F            0            8 
```

**回复**

```
ReplyId (PK)  ReplyType
1               Single
2               Multiple 
```

**选项表**

```
OptionId (PK)  OptionType
1               A-C        
2               A-D
3               A-E
4               A-F
5               A-G 
```

**图片**

```
ImageId (PK)  ImageFile
1              ImageFile/Tulips.png
2              ImageFile/Daisys.png 
```

**视频**

```
VideoId (PK) VideoFile
1              VideoFile/Speech.png 
```

**声音的**

```
AudioId (PK) AudioFile
1               AudioFile/Song.png 
```

**Image_Question**

```
 ImageQuestionId (PK) ImageId (FK) SessionId (FK)  QuestionNo (FK)
   1                    1             1                2 
```

**视频_问题**

```
VideoQuestionId (PK) VideoId (FK) SessionId (FK)  QuestionNo (FK)
1                      1            1                   4 
```

**音频_问题**

```
AudioQuestionId (PK) AudioId (FK) SessionId (FK)  QuestionNo (FK)
1                      1            1                  5 
```

以下是我失败的尝试：

```
SELECT s.SessionId, 
       SessionName, 
       SessionDuration, 
       TotalMarks, 
       SessionWeight, 
       q.QuestionId, 
       q.QuestionNo, 
       QuestionContent, 
       QuestionMarks, 
       q.OptionId, 
       OptionType, 
       q.ReplyId, 
       ReplyType, 
       a.AnswerId, 
       Answer, 
       NoofAnswers, 
       AnswerMarks, 
       PenaltyEnabled, 
       PenaltyAnswerId, 
       PenaltyAnswer, 
       PenaltyMarks, 
       i.ImageId, 
       au.AudioId, 
       v.VideoId, 
       ImageFile, 
       AudioFile, 
       VideoFile, 
       s.ModuleId, 
       ModuleNo, 
       ModuleName, 
       ss.StudentId 
FROM   Student st 
       INNER JOIN Student_Session ss 
               ON st.StudentId = ss.StudentId 
       INNER JOIN Session s 
               ON ss.SessionId = s.SessionId 
       INNER JOIN Question q 
               ON s.SessionId = q.SessionId 
       INNER JOIN Answer a 
               ON q.QuestionId = a.AnswerId 
       INNER JOIN Individual_Answer ia 
               ON a.AnswerId = ia.AnswerId 
       LEFT JOIN Module m 
              ON s.ModuleId = m.ModuleId 
       LEFT JOIN Penalty p 
              ON q.SessionId = p.SessionId 
       LEFT JOIN Option_Table o 
              ON q.OptionId = o.OptionId 
       LEFT JOIN Reply r 
              ON q.ReplyId = r.ReplyId 
       LEFT JOIN Penalty_Marks pm 
              ON q.QuestionId = pm.QuestionId 
       LEFT JOIN Image_Question iq 
              ON q.QuestionId = iq.QuestionNo 
       INNER JOIN Image i 
               ON iq.ImageId = i.ImageId 
       LEFT JOIN Audio_Question aq 
              ON q.QuestionId = aq.QuestionNo 
       INNER JOIN Audio au 
               ON aq.AudioId = au.AudioId 
       LEFT JOIN Video_Question vq 
              ON q.QuestionId = vq.QuestionNo 
       INNER JOIN Video v 
               ON vq.VideoId = v.VideoId 
WHERE  s.SessionId = 1
ORDER  BY q.QuestionId 
```

更新：

提交问题后，下面的代码是否能够将 QuestionId 插入 Image_Question 表中：（这是我在 SO 上找到的，但已更新为我的表设计）

```
ImageQuestionToken
{
  ImageToken (PK auto)
  SessionId
}

Image{
   ImageId 
   ImageFile
}

Image_Question
{
  Image_QuestionId
  ImageId FK references Image(ImageId)
  QuestionId FK references Question(QuestionId)

}

Question
{
  QuestionId (PK Auto)
  QuestionNo
  QuestionContent
  ....
}

TempImage
{
  ImageToken FK references ImageQuestionToken(ImageToken)
  ImageFile
} 
```

像这样的逻辑：

1.  用户请求问题表。服务器设置令牌并包含响应用户。
2.  用户上传包含令牌的图片。图像存储在临时表中。
3.  步骤 2 重复 n 次。
4.  如果用户提交带有令牌值的问题，则会在问题表中放置一个条目并分配一个 id。TempImage 表中共享令牌的所有图像都将插入到具有现在已知 QuestionId 的图像表中。然后删除 ImageQuestionToken 条目，并级联删除 TempImage 中的临时图像。
5.  否则用户不提交问题，则文件被删除并 ImageQuestionToken 条目被删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:59:24.760

虽然我不能 100% 确定您想要的确切结果。根据您现有的查询，问题是`INNER JOIN`您应该在某些表上使用`LEFT JOIN`.

在您现有的查询中，您正在使用以下内容：

```
LEFT JOIN Image_Question iq 
  ON q.QuestionId = iq.QuestionNo 
INNER JOIN Image i 
  ON iq.ImageId = i.ImageId 
LEFT JOIN Audio_Question aq 
  ON q.QuestionId = aq.QuestionNo 
INNER JOIN Audio au 
  ON aq.AudioId = au.AudioId 
LEFT JOIN Video_Question vq 
  ON q.QuestionId = vq.QuestionNo 
INNER JOIN Video v 
  ON vq.VideoId = v.VideoId 
```

问题是正在检查所有字段上的匹配记录，但您可能没有在或表`INNER JOIN`中存在的记录，`image`因此它不会返回任何内容。`audio``video`

根据您的详细信息，您的查询应与此类似：

```
select st.studentid,
  s.sessionid,
  s.sessionname,
  s.sessionduration,
  s.totalmarks,
  s.sessionweight,
  q.questionid,
  q.questionno,
  q.questioncontent,
  q.noofanswers,
  q.questionmarks,
  q.optionid,
  ot.optiontype,
  q.replyid,
  r.replytype,
  a.answerid,
  a.answer,
  ia.answermarks,
  p.penaltyenabled,
  pm.penaltyanswerid, 
  pm.penaltyanswer,
  pm.penaltymarks,
  i.imageid,
  i.imagefile,
  v.videoid,
  v.videofile,
  ad.audioid,
  ad.audiofile,
  m.moduleid,
  m.moduleno,
  m.modulename
from Student st 
inner join Student_Session ss
  on st.studentid = ss.studentid
inner join session s
  on ss.sessionid = s.sessionid
inner join question q
  on s.sessionid = q.sessionid
inner join answer a
  on q.questionid = a.questionid
inner join Individual_Answer ia
  on a.answerid = ia.answerid
left join Option_Table ot
  on q.optionid = ot.optionid
left join reply r
  on q.replyid = r.replyid
left join module m
  on s.moduleid = m.moduleid
left join Penalty p
  on s.sessionid = p.sessionid
left join penalty_marks pm
  on q.questionid = pm.questionid
left join image_question iq  -- note I am joining on both session and question
  on s.sessionid = iq.sessionid
  and q.questionid = iq.questionno
left join image i  -- this should be a left join not inner join
  on iq.imageid = i.imageid
left join video_question vq -- note I am joining on both session and question
  on s.sessionid = vq.sessionid
  and q.questionid = vq.questionno
left join video v  -- this should be a left join not inner join
  on vq.videoid = v.videoid
left join audio_question aq  -- note I am joining on both session and question
  on s.sessionid = aq.sessionid
  and q.questionid = aq.questionno
left join audio ad  -- this should be a left join not inner join
  on aq.audioid = ad.audioid
where  s.SessionId = 1
order by q.QuestionId 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/610b1/17)。

这将返回您在上面请求的所有数据。样本：

```
| STUDENTID | SESSIONID | SESSIONNAME | SESSIONDURATION | TOTALMARKS | SESSIONWEIGHT | QUESTIONID | QUESTIONNO | QUESTIONCONTENT | NOOFANSWERS | QUESTIONMARKS | OPTIONID | OPTIONTYPE | REPLYID | REPLYTYPE | ANSWERID | ANSWER | ANSWERMARKS | PENALTYENABLED | PENALTYANSWERID | PENALTYANSWER | PENALTYMARKS | IMAGEID | IMAGEFILE | VIDEOID |            VIDEOFILE | AUDIOID |          AUDIOFILE | MODULEID | MODULENO | MODULENAME |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|         1 |         1 |         AAA |        01:00:00 |         30 |            20 |          4 |          1 |      Question 1 |           1 |             5 |        1 |        A-C |       1 |    Single |        1 |      A |           3 |              1 |               1 |             B |            1 |  (null) |    (null) |       1 | VideoFile/Speech.png |  (null) |             (null) |        1 |  CHI2513 |        ICT |
|         1 |         1 |         AAA |        01:00:00 |         30 |            20 |          4 |          1 |      Question 1 |           1 |             5 |        1 |        A-C |       1 |    Single |        1 |      A |           3 |              1 |               2 |             C |            1 |  (null) |    (null) |       1 | VideoFile/Speech.png |  (null) |             (null) |        1 |  CHI2513 |        ICT |
|         1 |         1 |         AAA |        01:00:00 |         30 |            20 |          5 |          2 |      Question 2 |           1 |             3 |        2 |        A-D |       1 |    Single |        2 |      C |           5 |              1 |               3 |             A |            1 |  (null) |    (null) |  (null) |               (null) |       1 | AudioFile/Song.png |        1 |  CHI2513 |        ICT |
|         1 |         1 |         AAA |        01:00:00 |         30 |            20 |          5 |          2 |      Question 2 |           1 |             3 |        2 |        A-D |       1 |    Single |        2 |      C |           5 |              1 |               5 |             D |            1 |  (null) |    (null) |  (null) |               (null) |       1 | AudioFile/Song.png |        1 |  CHI2513 |        ICT |
|         1 |         1 |         AAA |        01:00:00 |         30 |            20 |          5 |          2 |      Question 2 |           1 |             3 |        2 |        A-D |       1 |    Single |        2 |      C |           5 |              1 |               4 |             B |            1 |  (null) |    (null) |  (null) |               (null) |       1 | AudioFile/Song.png |        1 |  CHI2513 |        ICT | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T09:25:37.430

这些表中的外键存在问题：Image_Question、Audio_Question 和 Video_Question。

您正在使用未由表 Question 索引的 QuestionNo 列。我建议将列替换为 QuestionId 并使用它们的值。

```
Image_Question

ImageQuestionId (PK) ImageId (FK) SessionId (FK)  QuestionNo(FK)
   1                    1             1                2

Video_Question

VideoQuestionId (PK) VideoId (FK) SessionId (FK)  QuestionNo(FK)
   1                      1            1               4

Audio_Question

AudioQuestionId (PK) AudioId (FK) SessionId (FK)  QuestionNo(FK)
   1                      1            1               5 
```

你的陈述应该是这样的：

```
SELECT s.SessionId, 
       SessionName, 
       SessionDuration, 
       TotalMarks, 
       SessionWeight, 
       q.QuestionId, 
       q.QuestionNo, 
       QuestionContent, 
       QuestionMarks, 
       q.OptionId, 
       OptionType, 
       q.ReplyId, 
       ReplyType, 
       a.AnswerId, 
       Answer, 
       NoofAnswers, 
       AnswerMarks, 
       PenaltyEnabled, 
       PenaltyAnswerId, 
       PenaltyAnswer, 
       PenaltyMarks, 
       i.ImageId, 
       au.AudioId, 
       v.VideoId, 
       ImageFile, 
       AudioFile, 
       VideoFile, 
       s.ModuleId, 
       ModuleNo, 
       ModuleName, 
       ss.StudentId 
FROM   Student st 
       INNER JOIN Student_Session ss 
               ON st.StudentId = ss.StudentId 
       INNER JOIN Session s 
               ON ss.SessionId = s.SessionId 
       INNER JOIN Question q 
               ON s.SessionId = q.SessionId 
       INNER JOIN Answer a 
               ON q.QuestionId = a.AnswerId 
       INNER JOIN Individual_Answer ia 
               ON a.AnswerId = ia.AnswerId 
       LEFT JOIN Module m 
              ON s.ModuleId = m.ModuleId 
       LEFT JOIN Penalty p 
              ON q.SessionId = p.SessionId 
       LEFT JOIN Option_Table o 
              ON q.OptionId = o.OptionId 
       LEFT JOIN Reply r 
              ON q.ReplyId = r.ReplyId 
       LEFT JOIN Penalty_Marks pm 
              ON q.QuestionId = pm.QuestionId 
       LEFT JOIN Image_Question iq 
              ON q.QuestionNo= iq.QuestionNo
       LEFT JOIN Image i
               ON iq.ImageId = i.ImageId 
       LEFT JOIN Audio_Question aq 
              ON q.QuestionNo= aq.QuestionNo
       LEFT JOIN Audio au 
               ON aq.AudioId = au.AudioId 
       LEFT JOIN Video_Question vq 
              ON q.QuestionNo= vq.QuestionNo
       LEFT JOIN Video v 
               ON vq.VideoId = v.VideoId 
WHERE  s.SessionId = 1
ORDER  BY q.QuestionId 
```

更新：您可以使用列 QuestionNo 毕竟，您可以添加索引，这样您就不必大修代码。呵呵呵呵

我建议你添加这个：

```
ALTER TABLE `your_schema`.`Question` 
ADD INDEX `your_idx` (`QuestionNo` ASC); 
```

而不是这些：

```
 LEFT JOIN Image_Question iq 
    ON q.QuestionId = iq.QuestionId -- from iq.QuestionNo
  LEFT JOIN Image i
    ON iq.ImageId = i.ImageId 
  LEFT JOIN Audio_Question aq 
    ON q.QuestionId = aq.QuestionId -- from aq.QuestionNo
  LEFT JOIN Audio au 
    ON aq.AudioId = au.AudioId 
  LEFT JOIN Video_Question vq 
    ON q.QuestionId = vq.QuestionId -- from vq.QuestionNo
  LEFT JOIN Video v 
    ON vq.VideoId = v.VideoId 
```

你使用这些：

```
 LEFT JOIN Image_Question iq 
    ON q.QuestionNo= iq.QuestionNo
  LEFT JOIN Image i
    ON iq.ImageId = i.ImageId 
  LEFT JOIN Audio_Question aq 
    ON q.QuestionNo= aq.QuestionNo
  LEFT JOIN Audio au 
    ON aq.AudioId = au.AudioId 
  LEFT JOIN Video_Question vq 
    ON q.QuestionNo= vq.QuestionNo
  LEFT JOIN Video v 
    ON vq.VideoId = v.VideoId 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T03:39:43.100

关键问题：通常，使用外部联接表的内部联接不会返回任何行

我已经使用 microsoft SQL 语法进行了子查询。希望能帮助到你。请参阅底部的警告，如果您愿意，请忽略创建过程语句，而只需在顶部声明并将 @SessionID 设置为 1。

```
create procedure GetStuff(
    @SessionID as integer
    ) as

declare @StudentID int -- you may need to use a different data type
select @StudentID = StudentID from Student_Session where SessionID = @SessionID

-- now we can at least remove the sessions table from the join list.

SELECT s.SessionId, 
       SessionName, 
       SessionDuration, 
       TotalMarks, 
       SessionWeight, 
       q.QuestionId, 
       q.QuestionNo, 
       QuestionContent, 
       QuestionMarks, 
       q.OptionId, 
       OptionType, 
       q.ReplyId, 
       ReplyType, 
       a.AnswerId, 
       Answer, 
       NoofAnswers, 
       AnswerMarks, 
       PenaltyEnabled, 
       PenaltyAnswerId, 
       PenaltyAnswer, 
       PenaltyMarks, 
       i.ImageId, 
       au.AudioId, 
       v.VideoId, 
       ImageFile, 
       AudioFile, 
       VideoFile, 
       s.ModuleId, 
       ModuleNo, 
       ModuleName, 
       ss.StudentId 
FROM   Student st 
       INNER JOIN Student_Session ss 
               ON st.StudentId = ss.StudentId 
       INNER JOIN Session s 
               ON ss.SessionId = s.SessionId 
       INNER JOIN Question q 
               ON s.SessionId = q.SessionId 
       INNER JOIN Answer a 
               ON q.QuestionId = a.AnswerId 
       INNER JOIN Individual_Answer ia 
               ON a.AnswerId = ia.AnswerId 
       LEFT outer JOIN Module m 
              ON s.ModuleId = m.ModuleId 
       LEFT outer JOIN Penalty p 
              ON q.SessionId = p.SessionId 
       LEFT outer JOIN Option_Table o 
              ON q.OptionId = o.OptionId 
       LEFT outer JOIN Reply r
              ON q.ReplyId = r.ReplyId 
       LEFT outer JOIN Penalty_Marks pm 
              ON q.QuestionId = pm.QuestionId 
        -- you can't inner join off of an outer joined table, or you'll get no rows for the entire query. I've nested the query, which is bad practice but... practical for getting this monster of a query working.
       LEFT outer JOIN (select c3.ImageID, c3.ImageFile from Image_Question as a1 inner join Images as b1 on a1.QuestionNo = b1.QuestionNo inner join Image as c1 on a1.ImageID = c1.ImageID)
               ON q.QuestionID = iq.QuestionID
        -- you can't inner join off of an outer joined table, or you'll get no rows for the entire query. I've nested the query, which is bad practice but... practical for getting this monster of a query working.
       LEFT outer JOIN (select b2.AudioID, b2.AudioFile from Audio_Question as a2 inner join Audio as b2 on a2.AudioID = b2.AudioID) as aq
              ON q.QuestionId = aq.QuestionNo 
        -- you can't inner join off of an outer joined table, or you'll get no rows for the entire query. I've nested the query, which is bad practice but... practical for getting this monster of a query working.
        left outer join (select b3.VideoID, b3.VideoFile from Video_Question as a3 inner join Video as b3 on a3.QuestionID = b3.QuestionID) as vq 
WHERE  
    st.StudentID = @StudentID
    and 
    s.SessionId = @SessionID
ORDER  BY q.QuestionId 
go 
```

警告：你真的很想把它分解成单独的部分，以便在你的客户端应用程序中显示。例如，您需要为 Exams 和 ExamDetails 显示主/详细信息，否则您将不得不在向用户显示的输出中抑制重复值。例如，从概念上讲，您的输出将如下所示：

```
<Exam Detail Fields>    <Exam Detail Fields>
first one unique        What is the color of your DOG?
repeat          What is the color of your CAT?
repeat          What is the color of your CAR?
repeat          What is the color of your HAT? 
```

请注意左侧的重复值，您将不得不取消这些值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T05:37:16.803

好吧，在小班次中尝试一下：我的意思是：- 逐部分执行查询首先删除一些连接（删除其中大部分），然后逐个添加它们，我对大型查询执行相同操作以跟踪位置是实际问题，或者是哪些条件对获取结果行产生了主要影响。只是一个想法。干杯!

我认为

```
 LEFT JOIN Image_Question iq 
              ON q.QuestionId = iq.QuestionNo 
```

会给你空值

由于 q.QuestionId 从 4 开始，而 iq.QuestionNo 为 2

```
INNER JOIN Image i 
               ON iq.ImageId = i.ImageId 
```

并且由左外连接产生的 Iq 字段中的所有值都是空的。所以它们上的任何内连接肯定会给你空结果。

# javascript - 在 Javascript Windows 8 App 中访问本地 Json 文件

> ID：13131577
> 
> 赞同：0
> 
> 时间：2012-10-30T00:24:47.490
> 
> 标签：javascript, json, windows-8

我正在使用 javascript 构建一个新的 Windows 8 应用程序。我想要一些本地 json 文件用作配置文件，但我不确定如何将它们读入我的系统。

我见过 HTML5s [File Api](http://www.html5rocks.com/en/tutorials/file/dndfiles/)和[JSONP 解决方案](https://stackoverflow.com/questions/5299674/accessing-json-service-from-localhost-or-file)，但两者似乎都是针对浏览器的解决方案。我浏览了 MSDN 文档，但也找不到用于此的 MSFT API。

目前我将我的配置作为 js 对象放在我的源代码中，但我真的很想将它们分开。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:49:01.370

以下是有关 Metro 应用程序文件访问的 MS 文档：

[Windows 应用商店应用程序中的文件访问和权限](http://msdn.microsoft.com/en-us/library/windows/apps/hh967755.aspx)

# sql - 修改时视图失去授权

> ID：13131579
> 
> 赞同：2
> 
> 时间：2012-10-30T00:25:26.100
> 
> 标签：sql, oracle, view

在修改源 SQL 时，oracle 视图失去所有授权是否正常？如果这与它有任何关系，我正在使用 SQL Developer。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T03:12:52.360

首先，你没有“grants”——“grant”是一个操作。你有“角色”和“特权”。

其次，视图本身既没有角色也没有特权——模式确实有。基本上，一个自我描述的命令是：`grant select on view_1 to schema_1`.

**第三，如果您创建或替换**视图，模式不会失去其特权。这是一个快速示例：

```
11:03:07 @> conn system/sys@oars_sandbox                                                                                                                            
Connected.                                                                                                                                                          
11:03:15 SYSTEM@oars_sandbox> create user test1 identified by test1;                                                                                                

User created.                                                                                                                                                       

11:03:39 SYSTEM@oars_sandbox> create user test2 identified by test2;                                                                                                

User created.                                                                                                                                                       

11:03:48 SYSTEM@oars_sandbox> create view test1.view1 as select * from dual;                                                                                        

View created.                                                                                                                                                       

11:04:03 SYSTEM@oars_sandbox> grant select on test1.view1 to test2;                                                                                                 

Grant succeeded.                                                                                                                                                    

11:04:15 SYSTEM@oars_sandbox> select grantee, owner, table_name, privilege, grantor from dba_tab_privs where grantee = 'TEST2';                                     

GRANTEE                        OWNER                          TABLE_NAME                     PRIVILEGE                                GRANTOR                       
------------------------------ ------------------------------ ------------------------------ ---------------------------------------- ------------------------------
TEST2                          TEST1                          VIEW1                          SELECT                                   TEST1                         

11:05:13 SYSTEM@oars_sandbox> create or replace view test1.view1 as select * from dual;                                                                             

View created.                                                                                                                                                       

11:05:24 SYSTEM@oars_sandbox> select grantee, owner, table_name, privilege, grantor from dba_tab_privs where grantee = 'TEST2';                                     

GRANTEE                        OWNER                          TABLE_NAME                     PRIVILEGE                                GRANTOR                       
------------------------------ ------------------------------ ------------------------------ ---------------------------------------- ------------------------------
TEST2                          TEST1                          VIEW1                          SELECT                                   TEST1 
```

但是，很可能 SQL 开发人员`drop view`首先调用而不是`create or replace`. 在这种情况下，您的权限将被自动删除。

```
11:05:26 SYSTEM@oars_sandbox> drop view test1.view1;                                                                            

View dropped.                                                                                                                   

11:10:21 SYSTEM@oars_sandbox> select grantee, owner, table_name, privilege, grantor from dba_tab_privs where grantee = 'TEST2'; 

no rows selected                                                                                                                

11:10:24 SYSTEM@oars_sandbox> create or replace view test1.view1 as select * from dual;                                         

View created.                                                                                                                   

11:10:26 SYSTEM@oars_sandbox> select grantee, owner, table_name, privilege, grantor from dba_tab_privs where grantee = 'TEST2'; 

no rows selected 
```

# python-2.7 - 即使我已经卸载了 Python 2.7，Mac OSX 10.6.8 中从 Python 2.7 恢复到 Python 2.6 也不起作用

> ID：13131583
> 
> 赞同：1
> 
> 时间：2012-10-30T00:25:52.987
> 
> 标签：python-2.7

我有 mac OSX 10.6.8。我的系统附带 Python 2.6 我最近安装了 Python 2.7，但遇到了很多问题，因此决定通过执行恢复到 Python 2.6

```
$ sudo rm -rf /Library/Frameworks/Python.framework/Versions/2.7 
```

我还从我的应用程序文件夹中删除了 Python 2.7。

然而，当我跑步时

```
 $ python -V 

 Python 2.7.3 
```

所以我尝试通过运行以下命令来制作默认的 python 2.6：

```
$ defaults write com.apple.versioner.python Version 2.6 
```

但是，我仍然看到我的 python 版本是 2.7.3

我似乎无法暂时更改我的版本：

```
$ export VERSIONER_PYTHON_VERSION=2.6

$ python -V
Python 2.7.3 
```

如果它有帮助，这就是我得到的

```
$ which python
/opt/local/bin/python 
```

我真的很感激任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:21:15.200

您可能已经看到了[这一点](http://hg.python.org/cpython/file/default/Mac/README)（搜索“卸载框架”），但听起来您可能采取的一些额外步骤是确保符号链接`/Library/Frameworks/Python.framework/Versions/Current`指向您安装的 Python 2.6 版本，并且您删除了所有 Python 2.7 符号链接/usr/本地/bin。

我也刚刚看到[这篇文章](https://stackoverflow.com/questions/3819449/how-to-uninstall-python-2-7-on-a-mac-os-x-10-6-4)，它比我刚刚尝试做的回答要好得多:)

# security - 基于令牌的会话管理

> ID：13131587
> 
> 赞同：2
> 
> 时间：2012-10-30T00:26:24.847
> 
> 标签：security, session, authentication, oauth, go

我使用 GO 服务器 (golang.org)，它对加密和第三方包提供了很好的支持，它提供了基于 cookie 的基本会话处理。我正在寻找有关生成令牌的指南，以及存储、无效等的良好做法。我的应用程序需要自定义用户管理。可以在离线环境中使用 Oauth，还是有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T00:58:18.260

一般来说，会话​​ cookie 应该是：

*   不透明。您不应传递任何隐藏在 cookie 中的信息。它只是一个标识符。
*   猜不透。您不希望人们能够猜测其他人的会话令牌并劫持它们。
*   抗碰撞。如果您的网站上同时有数千名用户，您需要相当大的令牌，这样两个用户就不会得到相同的令牌。
*   安全存放。将您的会话信息保存在 Web 浏览器（和其他公共用户）无法访问它们的地方。通常这意味着将它们保存在服务器文档树之外的磁盘上，或者将它们放入数据库中。
*   接近到期时删除。您不想永远保留会话数据。有时，您需要检查会话数据并删除所有已过期的内容。

我不确定 OAuth 是从哪里来的，因为那是一个身份验证系统，而您正在询问会话管理。（虽然我意识到这两者可能相关。）

# jquery - Ajax 评论表单不返回 ExpressionEngine 成功模板内容

> ID：13131590
> 
> 赞同：2
> 
> 时间：2012-10-30T00:26:49.617
> 
> 标签：jquery, ajax, expressionengine, jquery-forms-plugin

所以我有一个与[jQuery Form 插件](http://www.malsup.com/jquery/form/)挂钩的基本评论表单（只有成员可以发布，所以没有姓名/电子邮件字段）：

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="/assets_site/js/jquery.form.min.js"></script>
  <script>
    $(document).ready(function(){

      function ajaxReturn(data) {
        var messageContainer = $('.alert-box');
        var messageBody = $(data);
        messageContainer.html(messageBody);
      }// ajaxReturn(data)

      $('.member-review').ajaxForm({
        success: ajaxReturn
      });
    });
  </script>

</head>
<body>
    {exp:channel:entries
      channel='products'
      limit='1'
      disable='categories|member_data|pagination'
    }
      {exp:comment:form
        channel='products'
        form_class='member-review'
        return='notifications/success'
      }
        <div class="alert-box">
          {!-- Ajax Form Errors --}
        </div><!--.alert-box-->

        <label for="comment">Tell others what you think</label>
        <textarea name="comment" rows="8" class="required" id="comment"></textarea>

        <input type="submit" value="Submit">
      {/exp:comment:form}
    {/exp:channel:entries}
</body>
</html> 
```

而且，就本演示而言，我的成功模板再简单不过了：

```
<p>Sumission Successful!</p> 
```

不幸的是，当我提交完整的表格时，没有返回任何数据。如果我添加`console.log($(data));`到 ajaxReturn 函数，我会得到一个空字符串。评论成功提交到数据库，只是返回模板似乎没有成功。

真的不知道为什么会这样。它正确返回错误消息，而不是成功模板。

EE v2.5.3

**更新：** [这是一个视频](http://vimeo.com/12909760)，涵盖了我正在尝试做的基础知识。我之前在之前的 EE 版本上已经成功完成了它，所以我想知道他们最近是否更改了某些内容以使其不再工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:54:52.827

文档[https://github.com/malsup/form](https://github.com/malsup/form)提到 ajaxForm 仅准备提交表单，但不提交。当你运行这个时会发生什么？：

```
$('.member-review').on('submit', function(e) {
    e.preventDefault(); 
    $(this).ajaxSubmit({
        target: '.alert-box'
    })
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:59:47.717

我没有使用 jQuery 表单插件，但它看起来不像你期望的那样工作（如果你通过 AJAX 发布表单，EE 似乎不会返回成功页面的内容）。

但是，对于这样一个简单的成功消息，真的不需要一个完整的单独模板。您可以在 return 函数中执行此操作：

```
function ajaxReturn(data) {
    $('.alert-box').html('<p>Sumission Successful!</p>');
} 
```

或者，如果您绝对必须使用单独的模板（为了与非 JS 浏览器或其他任何东西保持一致），您可以只使用 jQuery`load()`函数来获取其内容：

```
function ajaxReturn(data) {
    $('.alert-box').load('/notifications/success');
} 
```

第二个选项会导致对您的服务器再进行一次 AJAX 调用，但这并不是什么大问题。如果您想要最佳性能，请使用第一个选项。

**更新：**如果您的成功函数也返回错误，那该怎么办？

```
function ajaxReturn(data) {
    if (data) {
        $('.alert-box').html(data);
    } else {
        $('.alert-box').html('<p>Sumission Successful!</p>');
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T15:11:32.580

是否确认这是一个错误？我有类似的问题。我有一个开发站点，我正在使用较新的 EE 版本进行测试，即使它确实提交了，ajax 帖子也永远不会返回成功消息，因为如果我刷新页面，我可以看到更新。在实时站点上，我运行的是旧版本，并且获得了成功和响应。在我找到这篇文章之前，我开始疯狂地认为这是服务器的问题。

我也在使用模板页面的负载进行更新，但如果我可以使用 json 响应会很好，这样我就不必对单独的页面进行额外的调用。这是我在现场（旧版 EE 版本）上使用的并且可以正常工作。

```
 var update_cart_form_options = { 
        success: update_cart,  
        dataType: 'json' 
    };
    function update_cart(data, statusText, xhr, $form)  {   

        if (data.success) {                                                   
            $("input[name=XID]").val(data.XID);
            $('#cart_total')        .html( data.cart_total );
            $('#cart_subtotal')     .html( data.cart_subtotal );
        }  
        return false; 
    }      

    $("#update_button").click(function(){
        $('#update_button').val('Processing...');
        var form = $(this).closest("form"); 
        $(form).ajaxForm(update_cart_form_options);
        $(form).submit();  

}); 
```

但是相同的代码将无法在使用最新 EE 版本的开发站点测试中运行。

# java - 继承和接口

> ID：13131592
> 
> 赞同：11
> 
> 时间：2012-10-30T00:26:54.127
> 
> 标签：java, inheritance, interface, subclass

当涉及接口时，我一直在尝试理解继承。我想知道如果它们遵循以下子类是如何创建的：

例如，假设我有：

1.  实现接口 I 的超类
2.  和几个扩展超类 A 的子类

**我的问题**

1.  我是否必须在所有扩展 A 的子类中提供接口方法“q 和 r”的实现？

2.  如果我不在子类中提供接口的实现，我是否必须使该子类成为抽象类？

3.  任何子类都可以实现 I 吗？例如 C 类扩展 A 实现 I，这可能吗？即使它已经扩展了实现 I 的超类？

4.  假设我不提供接口 I 中方法 r 的实现，那么我将不得不创建超类 A 和抽象类！那是对的吗？

我的示例代码：

```
 //superclass
    public class A implements I{
    x(){System.out.println("superclass x");}
    y(){System.out.println("superclass y");}
    q(){System.out.println("interface method q");}
    r(){System.out.println("interface method r");}
    }

    //Interface
    public Interface I{
    public void q();
    public void r();
    }

    //subclass 1
    public class B extends A{
    //will i have to implement the method q and r?
    x(){System.out.println("called method x in B");}
    y(){System.out.println("called method y in B");}
    }

    //subclass 2
    public class C extends A{
    //will i have to implement the method q and r?
    x(){System.out.println("called method x in C");}
    y(){System.out.println("called method y in C");}
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-30T00:34:21.043

1）不，您不需要实现子类中的方法，因为它们已经在超类中定义。子类将继承这些方法定义。

2）不，见1。唯一的例外是如果超类是抽象的并且没有实现接口，那么如果子类不是抽象的，则需要在子类中实现它。

3) 不。它可能编译正确，但没有效果，所以不应该这样做。

4) 是的，这是正确的。如果不从接口实现方法，则需要使类抽象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:36:15.880

只有抽象类才能使它们保持抽象，这意味着抽象类不需要为接口中的方法提供实现。

因为，`A`是具体的，它必须提供实现。然后 的子类`A`将仅从`A`.

但是，如果`A`是抽象的并且没有提供方法的实现，那么`B`并且`C`必须提供实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T00:36:58.213

1：不，如果你在你的超类中实现它们，它不需要在你的子类中实现它们

2：如果你不实现超类中的方法，那么你必须使其抽象，然后让你的具体子类实现这些方法

3：是的，但绝对是多余的，因为你的超类已经在实现 thrm。

4：是的，当你扩展你的超类时，你应该在类中实现这些方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T00:38:13.127

接口是对外界的承诺，即“我可以提供这些方法”。

1) 和 2) 和 4) 由于超类 A 已经实现了接口 I，它已经向外界承诺。超类 A 可以通过以下方式实现这一承诺：

*   实现该方法 - 在这种情况下，您的子类已经继承了该方法并且不需要实现任何东西。
*   声明自己是抽象的——在这种情况下，您的子类必须要么实现抽象方法，要么也将自己声明为抽象，然后将责任“转嫁”给任何扩展子类的类。

3）超类A的所有子类都*实现*了I，因为它们继承了“承诺”，所以C类扩展A实现I是多余的。

# biztalk - BizTalk 集群

> ID：13131593
> 
> 赞同：1
> 
> 时间：2012-10-30T00:26:56.023
> 
> 标签：biztalk, biztalk-deployment

在我的 BizTalk 环境中，我有两个连接到同一个 SQL Server 消息框的应用程序服务器（即它们是单个组的一部分）。我正在寻找 BizTalk 应用程序的高可用性和自动故障转移选项。我们没有共享存储 (SAN)，所以我假设我们无法创建 Windows Server 集群（这个假设是否正确？），剩下的唯一选择是 Windows 2008 附带的 NLB 集群，但 NLB 可以允许自动重启 BizTalk如果主计算机发生故障，辅助计算机上的服务（或就此而言任何 Windows 服务）？

一般来说，当 BizTalk 有自己的负载平衡时，是否建议将 NLB 群集与 BizTalk 一起使用？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T05:29:54.733

是的，跨组中服务器的 NLB 在 BTS 中仍然非常有用，因为它将允许 WCF 等同步接收适配器从 NLB 中受益。这将允许您一次停止一个 BIztalk 服务器，以便重新部署和重新启动主机，而不会影响 Biztalk 公开的 Web 服务的客户端。然后，您可以为 Web 客户端系统提供 NLB ip 或主机名以向其发送请求。

IMO 聚类仅对

*   接收拉取的适配器（如果 2 个或更多主机实例轮询相同的接收位置/队列等，则无法正常工作），例如 msmq
*   底层 SQL 服务器

[这里](https://stackoverflow.com/questions/2702915/biztalk-server-2009-failover-clustering-and-network-load-balancing-nlb)有更彻底的讨论

但是请注意，您不应该依赖 NLB 在[应用程序/端口级别](http://en.wikipedia.org/wiki/Network_Load_Balancing_Services)进行故障转移- （例如，接收适配器停止工作） - NLB 仅在服务器级别工作 - 只要 NLB 服务继续在服务器上运行，它认为它作为“向上”。为此，您需要使用像 SCOM 这样的监控工具。

**编辑**还可以查看David Hall 关于 BizTalk 中高可用性方案的[出色回答](https://stackoverflow.com/questions/1951469/network-load-balancing-biztalk-instances)。

# java - 如何使用 Java 在 Windows 中隐藏显示桌面图标

> ID：13131597
> 
> 赞同：0
> 
> 时间：2012-10-30T00:27:21.520
> 
> 标签：java, windows, swing, icons, jna

我想知道如何使用 Java swing 应用程序（例如单击按钮）在 Windows中隐藏/显示 OS 桌面图标（[像这样）。](http://www.sevenforums.com/tutorials/3659-desktop-icons-hide-show.html)我用 C# 检查[了](https://stackoverflow.com/questions/6402834/how-to-hide-desktop-icons-programatically)它，我想使用 JNA，但我不知道如何开始。有任何想法吗？

# c# - 使用跟踪侦听器重定向所有调试输出

> ID：13131602
> 
> 赞同：3
> 
> 时间：2012-10-30T00:28:04.590
> 
> 标签：c#, winforms, app-config, tracelistener

我遵循这篇[使用 C# 中的跟踪侦听器创建记录器的](http://www.daveoncsharp.com/2009/09/create-a-logger-using-the-trace-listener-in-csharp/) 文章，相信只有`Trace.WriteLine()`语句会写入`application.log`文件中：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.diagnostics>
    <trace autoflush="true" indentsize="4">
      <listeners>
        <add name="myListener" type="System.Diagnostics.TextWriterTraceListener" initializeData="application.log" />
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

但令我沮丧的是，我`Debug.WriteLine()`以前转到该`Output`选项卡的所有内容都从该选项卡中消失了，而是现在都转到了跟踪文件`application.log`。

有没有办法**只** `Trace.WriteLine()`针对那个陈述`application.log`？

如果不是，那么`WriteLine()`只有我选择记录到该文件而不是我的整个调试会话的我自己的文件的最简单方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:32:27.503

不确定您的预期，`<remove name="Default" />`但从配置中删除该行将使您在“输出”选项卡中返回输出。您可以看到[DefaultTraceListener](http://msdn.microsoft.com/en-us/library/system.diagnostics.defaulttracelistener.aspx)使用了 OutputDebugString 方法，该方法允许 VS 在“输出”选项卡中显示日志。

跟踪发送到所有侦听器，侦听器本身可以进行过滤。

如果您想对跟踪进行更多分类 - 请参阅 System.Diagnostic 命名空间中的其他类，如[TraceSource以及](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracesource.aspx)[How to Trace Source](http://msdn.microsoft.com/en-us/library/ms228993%28v=vs.85%29.aspx)中的示例：

```
private static TraceSource mySource = new TraceSource("TraceSourceApp");
...
mySource.TraceEvent(TraceEventType.Error, 1, "Error message."); 
```

# c# - 主窗体上的奇怪类错误

> ID：13131612
> 
> 赞同：1
> 
> 时间：2012-10-30T00:29:38.283
> 
> 标签：c#, compiler-errors

好吧，我知道了，但我不确定如何解决

警告 1 可以设计 Form1 类，但不是文件中的第一个类。Visual Studio 要求设计人员使用文件中的第一个类。移动类代码，使其成为文件中的第一个类，然后再次尝试加载设计器。0 0

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T00:39:13.827

您可能在 Form1.cs 文件中声明了另一个类。该类应该移动到它自己的文件中。

例如，这很糟糕：

```
using ...

namespace WindowsFormsApplication1
{
    public class Foobar
    {
        ...
    }
    public partial class Form1
    {
        ...
    }
} 
```

在本例中，`Foobar`应将其移至名为 Foobar.cs 的文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:34:44.057

您在 Form1.cs 中的 Form1 类之上声明了另一个类。将 Form1 类移到它上面...

# android - 呼叫联系人，选择要发送短信的联系人，然后发送短信

> ID：13131613
> 
> 赞同：1
> 
> 时间：2012-10-30T00:29:50.710
> 
> 标签：android

我正在寻找呼叫用户联系人列表。然后，他们将选择要发送短信的联系人。我很难理解如何在发送短信时保存联系人以供使用。任何帮助，将不胜感激。到目前为止，这是我的代码。

```
package com.example.practiceapp;

import android.os.Bundle;
import android.provider.ContactsContract;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;

public class Dollar extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dollar);
    }

    //@Override
    //public boolean onCreateOptionsMenu(Menu menu) {
        //getMenuInflater().inflate(R.menu.activity_dollar, menu);
        //return true;
    //}

    public void contacts(View view) {
        Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
        int PICK_CONTACT=0;
        startActivityForResult(intent, PICK_CONTACT);

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:16:21.733

我使用[了 Android Essentials：使用联系人选择器](http://mobile.tutsplus.com/tutorials/android/android-essentials-using-the-contact-picker/)

它提供了一个选择电子邮件地址的工作示例。

使用联系人选择器获取联系人 ID 后，关键代码如下：

```
// query for everything email
cursor = getContentResolver().query(
        Email.CONTENT_URI, null,
        Email.CONTACT_ID + "=?",
        new String[]{id}, null); 
```

`id`从联系人选择器返回的联系人 ID在哪里（如教程中所述）。要获取电话数据，您需要将其更改为：

```
// query for everything phone
cursor = getContentResolver().query(
        Phone.CONTENT_URI, null,
        Phone.CONTACT_ID + "=?",
        new String[]{id}, null); 
```

请注意，一个联系人可以有多个电话号码，因此您必须构建第二个对话框来选择特定的电话号码。

```
ArrayList<String> phoneNumbers = new ArrayList<String>();
String name = "";
String number = "";
int nameIdx = cursor.getColumnIndex(Phone.DISPLAY_NAME);
int numberIdx = cursor.getColumnIndex(Phone.DATA);
// Get all phone numbers for the person
if (cursor.getCount() > 0) {
    cursor.moveToFirst();
    do {
        name = cursor.getString(nameIdx);  // get the name from the cursor
        number = cursor.getString(numberIdx); // get the phone number from the cursor
        phoneNumbers.add(number);
        Log.v(DEBUG_TAG, "Got name: " + name + " phone: "
                + number);
    } while (cursor.moveToNext());
    showPhoneNumberSelectionDialog(name,phoneNumbers);
} else {
    Log.w(DEBUG_TAG, "No results");
} 
```

（或者您可以根据需要调整从上述代码中读取的光标）

```
private void showPhoneNumberSelectionDialog(String name,
        final ArrayList<String> phoneNumbers) {
    1\. Build an AlertDialog to pick a number from phoneNumbers (with'name' in the title);
    2\. Send an SMS to the number
} 
```

构建警报对话框并不难，但需要将 ArrayList 转换为 String 数组。请参阅[将 ArrayList 转换为字符串 []](https://stackoverflow.com/questions/5374311/convert-arrayliststring-to-string/%22Convert%20ArrayList%3CString%3E%20to%20String%20%5B%5D%22)

发送 SMS 相当容易。网上有很多例子。

这个 SO Q&A ( [How to read contacts on Android 2.0](https://stackoverflow.com/questions/1721279/how-to-read-contacts-on-android-2-0) ) 也是很好的背景，但最后我没有使用它的任何代码。

# android - 如何创建固定/动态宽度的列布局？

> ID：13131615
> 
> 赞同：1
> 
> 时间：2012-10-30T00:29:59.790
> 
> 标签：android, android-layout, android-linearlayout, android-view

我正在尝试构建一个与其父宽度匹配的视图（最好是线性布局）。此布局应该有 2 个孩子（水平）：

1.  应该占用所有可用宽度的 TextView - 或至少包装其内容（但在任何情况下都不会与其他视图重叠）。
2.  另一个具有 60dp 固定宽度的 LinearLayout。

这是我要实现的目标的基本草图：![草图](../Images/8bc7f945f00b0d176d5ead2dc6393cfc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:41:15.153

我最近在这里回答了这个[问题](https://stackoverflow.com/a/13096242/752320)。只需将答案中的第二个 TextView 与您的孩子 LinearLayout 交换

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:45:43.927

这个怎么样：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >
    <TextView 
        android:layout_width="0dip"
        android:layout_height="fill_parent"
        android:background="#ff0000"
        android:gravity="center"
        android:text="TextView Multiline"
        android:textSize="10dp"
        android:textColor="#ffffff"
        android:layout_weight="1"/>
    <LinearLayout 
        android:layout_width="60dp"
        android:layout_height="fill_parent"
        android:gravity="center"
        android:background="#0000ff" >
        <TextView 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="TextView"
            android:textColor="#ffffff"
            android:textSize="10dp"/>        
    </LinearLayout>
</LinearLayout> 
```

虽然 60 dp 真的很窄恕我直言

# css - 为什么使用相对定位时div不可点击？

> ID：13131618
> 
> 赞同：2
> 
> 时间：2012-10-30T00:30:15.540
> 
> 标签：css, css-position

我目前正在为企业设计一个网站来构建计算机。

唯一的问题是，该网站只能在 Firefox 中 100% 运行。我目前的问题是`div`左侧的 div （带有图片）和右侧的 div （带有 Facebook like 框）在除 Firefox 之外的所有浏览器中都是不可点击的。我很确定它与 . 有关系`z-index`，但我不知道如何解决它。

我所拥有的是顶部的导航栏，其中有一个具有相对定位的主 div。在这个主 div 里面我还有 3 个`div`s。一个用于页面的每一列，左、中和右。然而，这些`divs`都不是可点击的，这是我拥有的 CSS 代码：

```
#fr {
  z-index: -1;
  position: fixed;
  width: 290px;
  right: 10px;
  top: 45px;
}

#la {
  overflow: auto;
  z-index: -1;
  position: fixed;
  width: 200px;
  height: 92.5%;
  left: 15px;
  top: 45px;
  border-right: 1px solid grey;
}

#maindata {
  border-bottom: 1px solid grey;
}

#main {
  z-index: -1;
} 
```

我能做些什么来解决这个问题？我愿意分享我的源代码（它是用 PHP 编码的，但主要是 HTML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:38:23.520

为什么要`#main`和`#la`他们`z-index: -1`？这将它们置于`body`（或其他元素）之后，因此无法通过悬停/单击操作访问它们。删除这些样式，页面将正常工作。

# c - 我想在 C 中创建一个字符串和整数的数组结构

> ID：13131625
> 
> 赞同：-2
> 
> 时间：2012-10-30T00:31:34.610
> 
> 标签：c, arrays, string, struct

```
struct arr 
{char * str;
 int ctr;
}m_arr[100]; 
```

我面临的问题是，每当我将一个值插入字符串和 int 字段并遍历数组进行打印时，该`int`字段会正确显示，但我的字符串字段始终是我更新的最后一个字段。

例如：我传递的值是`{'t-1',2} and {'t-2',5}`.

当我使用 for 循环显示数组元素时，我得到`{'t-2',2}`和`{'t-2',5}`.

我哪里错了？

我第一次尝试使用队列并遇到了同样的问题。所以使用数组实现但同样的问题。请帮忙。很紧急。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:35:50.560

您必须在某处为字符串分配空间。在结构中最容易做到这一点：

```
struct arr 
{
    char str[32];
    int  ctr;
} m_arr[100]; 
```

但您也可以通过使用`malloc()`et al（或使用`strdup()`）进行动态内存分配来实现。

使用显示的结构，您将读取的字符串复制到`m_arr[i].str`using`strcpy()`或等效项中。请记住确保字符串对于数据来说不会太长。动态分配的一个优点`strdup()`是字符串总是可以足够大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T00:36:04.100

您的问题是您实际上并未将字符串存储在其中。你只是保持一个指向它的指针。我假设您实际打印的值是您用来填充它的一些临时字符串。

最简单的解决方法是使用字符串而不是指针：

```
struct arr
{
    char str[10]; // able to hold up to 9 characters + terminating \0
    int ctr;
} m_arr[100]; 
```

要实际存储字符串，您必须复制它，例如使用`strcpy()`or `sprintf()`。

# node.js - TypeError：未定义不是nodejs中的函数

> ID：13131626
> 
> 赞同：7
> 
> 时间：2012-10-30T00:31:35.530
> 
> 标签：node.js, mongoose

这是我的 users.js 模型。

```
var mongoose = require('mongoose')
  , crypto = require('crypto')
  , mongoTypes = require('mongoose-types');

mongoTypes.loadTypes(mongoose, 'email');
mongoose.connect('mongodb://localhost/popbroker');

function hash1 (msg, key) { 
  return crypto.createHmac('sha256', key).update(msg).digest('hex');
};

function required(val) { return val && val.length; }

var Schema = mongoose.Schema
  , ObjectId = Schema.ObjectId;

var UserSchema = new Schema({
    username: {
      type: String,
      validate: [required,"Username is required"],
      index: {unique: true}
    },
    email: {
        type: mongoose.SchemaTypes.Email,
        validate: [required, 'Email required'],
        index: { unique: true }
    },
    password: {
        type: String,
        validate: [required, 'Password required'],
    },
    socialauth:{
      type:String,

    createdAt: {
        type: Date,
        'default': Date.now
    }
});

var UserApiSchema = new Schema({
    user :ObjectId,
    apiKey: {
        type: String,
        validate: [required, 'Senha é obrigatório'],
    },
    createdAt: {
        type: Date,
        'default': Date.now
    }
});

UserSchema.path('email').validate(function (v, fn) {
    User.count({email: v}, function (err, val) {
        if (err) fn(false);
        fn(val==0);
    });
}, 'Email exists!'); 

UserSchema.path('username').validate(function(v,fn){
  User.count({username:v},function(err,val){
    if(err) fn(false);
    fn(val==0);
  });
},'Username exists');

UserApiSchema.path('apiKey').validate(function(v,fn){
  UserApi.count({apiKey:v},function(err,val){
    if(err) fn(false);
    fn(val == 0);
  });
}, 'Api Key wrong');

UserSchema.statics.authenticate = function (email, password, fn) {
    this.findOne({email: email}, function (err, user) {
        if (!user) return fn(new Error('cannot find user'));
        if (user.password == hash1(password, conf.secret)) return fn(null, user);
        // Otherwise password is invalid
        fn(new Error('invalid password'));
    })
;};

UserApiSchema.statics.createApi = function(user,fn){
  var instance = new UserApi();
  instance.user = user;
  instance.apiKey = "asdasdacas121213dasasd";
  console.log("username is " + user.username);
  instance.save(function(err){
    fn(err,instance);

  });
};

UserSchema.statics.getUser = function(userid){
  var user = mongoose.model('User', UserSchema);
  var query = user.findOne({'_id':userid})
  query.exec(function (err, user) {
  if (err) return handleError(err);
  console.log(user.username);
  return user;
});
}

UserApiSchema.statics.getUser = function(apiKey,fn){
  var usAp = UserApiSchema
  var userApi = mongoose.model('UserApi', UserApiSchema);
  var user = mongoose.model('User', UserSchema);
  var query = userApi.findOne({ 'apiKey': apiKey });

  query.exec(function (err, userApi) {
  if (err) return handleError(err);
  console.log(userApi.user);
  user = user.getUser(userApi.user);
  fn(err, userApi);;// Space Ghost is a talk show host.
});
};

UserSchema.statics.newUser = function (email, password,username, fn) {
    var instance = new User();
    var apiInstance = new UserApi();
    instance.email = email;
    instance.password = require('crypto').createHash('sha256').update(password).update('salt').digest('hex');
    instance.username = username;

    instance.save(function (err) {
        fn(err, instance);
    });
};

UserSchema.statics.resetPassword = function(userId, callback) {
    var newPassword = '';
    newPassword = newPassword.randomString(6);
    var cripto = password;
    var data = {} 
        data.password = crypto;

    this.update({_id: userId}
        , {$set: data}
        , {multi:false,safe:true}
        , function( error, docs ) {
            if (error) {
                callback(error);
            }
            else {
                callback(null, newPassword);
            }
        });
}

var LinkSchema = new Schema({

  user: ObjectId,

  text: {
      type: String,
      validate: [required,"Text is required"],
      index: {unique: true}
    },
    body: {
        type: String,
        validate: [required, 'Body is required'],
        index: { unique: true }
    },
    createdAt: {
        type: Date,
        'default': Date.now
    }
})

/*
Exporting findByid function to return back a link based on an id.
*/

LinkSchema.statics.newLink = function (text, body,user, fn) {
    var instance = new Link();
    instance.text = text;
    instance.body =body;
    instance.user = user;

    instance.save(function (err) {
        fn(err, instance);
    });
};

/*
Export findAll function to return back all the links. 
*/

exports.findAll = function(req,res){
  console.log("Retrieving all the links");
  db.collection('links',function(err,collection){
    collecction.find().toArray(function(err,items){
      res.send(items);

    });
  });
};

Link = mongoose.model('Link', LinkSchema);

exports.Link = Link;

User = mongoose.model('User', UserSchema);
UserApi = mongoose.model('UserApi',UserApiSchema);
exports.UserApi = UserApi;
exports.User = User; 
```

由于我是 nodejs 新手，因此很难理解此错误的含义或发生原因。因此，错误是什么意思以及如何摆脱它？

编辑：这是我的 newUser 电话。

```
app.post(
        '/signup/',
        function(req, res) {
             {console.log(req.body.username);
                User.newUser(

                    req.body.email, req.body.password,req.body.username,req.body.apiKey,"pocket",
                    function (err, user) {
                        if ((user)&&(!err)) {
                            console.log(user.username)

                            UserApi.createApi(
                                    user,function(err,userapi){
                                        if((!err)){
                                            console.log("Api created");
                                            res.send("APi created");

                                        }
                                        else{
                                            if(err.errors.apiKey){
                                                res.send(err);
                                            }
                                        }

                                    });
                            req.session.regenerate(function(){
                                req.session.user = user._id;
                                //res.send("Success here!"); 

                            });
                        } else {
                            if (err.errors.email) {
                              res.send(err) 
                              console.log(req.body.password);
                              console.log(req.body.email);
                              console.log(req.body);
                            }                           
                           if (err.errors.username) {
                              res.send(err) 
                              console.log(req.body.password);
                              console.log(req.body.email);
                              console.log(req.body);
                            }   
                        }
                    });

            } 
        }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T04:04:03.313

通过您的编辑，您传递的参数比`newUser`预期的要多。这导致`fn`设置 的值`req.body.apiKey`，这显然是`undefined`：

```
UserSchema.statics.newUser = function (email, password, username, fn) {
    // ...
});

User.newUser(               // set to...
    req.body.email,         // => email
    req.body.password,      // => password
    req.body.username,      // => username
    req.body.apiKey,        // => fn
    "pocket",               // => (unnamed), arguments[4]
    function(err, user) {   // => (unnamed), arguments[5]
        // ...
    }
}); 
```

您要么想要编辑函数以命名其他参数，要么在实际上不需要它们时将它们从调用中删除（因为您在预期的回调`UserApi`内部和内部都创建了一个实例）。`newUser`

* * *

[*原来*]

该错误意味着您正在尝试调用`undefined`.

一种可能性是`fn`参数，`newUser`无论它实际上是否为 a ，都将尝试调用它`function`：

```
UserSchema.statics.newUser = function (email, password,username, fn) {
    //...
        fn(err, instance);
    //...
}); 
```

但是， 的值`fn`取决于您如何调用`newUser`：

```
// fn = undefined
User.newUser('email@domain', 'password', 'username');

// fn = function
User.newUser('email@domain', 'pass', 'user', function (err, user) { }); 
```

因此，您要么想在尝试调用它之前测试它`fn`：`function`

```
instance.save(function (err) {
    if (typeof fn === 'function') {
        fn(err, instance);
    }
}); 
```

或者您可以`fn`直接传递给[`Model#save`](http://mongoosejs.com/docs/api.html#model_Model-save)，它已经处理了 when `fn`is `undefined`：

```
instance.save(fn); 
```

# ruby-on-rails - 如何防止与 Rails 重叠的 cron 作业？

> ID：13131627
> 
> 赞同：4
> 
> 时间：2012-10-30T00:31:39.597
> 
> 标签：ruby-on-rails, crontab, race-condition, whenever

我有一个 cron 作业设置，每 5 分钟运行一次任务。但有时该任务需要超过 5 分钟才能运行，因此该任务的另一个副本由 cron 同时运行。有没有办法在任何时候或 cron 到我们可以让它在运行另一个副本之前等待另一个作业完成？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:35:32.007

AFAIK 你不能使用任何时候这样做，但你可以在你的脚本中处理它。这可以通过以下解决方案之一来完成

1.  使用在作业开始时设置并在作业结束时清除的标志（或一些信息，如开始时间、结束时间、成功状态）在数据库中处理此问题，并在每次作业开始时检查此标志以查看前一个作业是否已完成或不; 但请确保在清除标志之前处理异常，就好像进程死亡一样，其他进程将无法运行

2.  您可以通过创建一个临时文件并为当前进程对其进行排他锁，使操作系统为您工作，因此在当前进程完成之前，其他进程不能对该文件拥有排他锁，然后当进程完成它会释放锁并让其他进程工作。这样做包括这是你的 cron 工作的首要任务

    ```
    file = File.new("cron.lock", "a")
    can_lock = file.flock(File::LOCK_EX | File::LOCK_NB)

    if can_lock == false
      exit 1
    else
      #do whatever you want
    end 
    ```

第二种方法的优点是即使进程意外终止，锁也会被操作系统自动释放

对我来说，我选择了第一种方法，因为如果前一个过程完成或花费的时间超过特定时间限制，我需要启动另一个过程

有关更多详细信息，请查看[此链接](http://sujee.net/tech/articles/rails-cronjobs/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:45:24.880

## 使用文件系统或数据库锁

您无法使用 cron 或类似方法来防止重叠——至少，不能直接使用——但你有很多选择。您可以在生成新任务之前检查正在运行的任务的进程列表，但这仍然容易受到竞争条件的影响。一些更好的选择是：

1.  在您的 shell 脚本中使用信号量或文件锁。为此目的，*flock*和*lockfile是很好的 shell 实用程序。*
2.  如果您的 cron 作业涉及对数据库的更改，请使用具有行级锁定或信号量列的表来防止在另一个进程运行时发生更改。
3.  增加 cron 作业之间的间隔，以便您的进程有时间在下一次运行之前完成。即使您使用其他选项之一，这也可能是一个好主意。
4.  使您的脚本具有幂等性，以便并发操作不会相互影响。
5.  看看队列或单例进程是否比 cron 作业更适合您。

这类问题没有完美的答案。很大程度上取决于您的脚本在做什么，以及您系统的整体架构。您的里程会有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-25T10:05:08.690

这是我用于 rails rake 任务的文件锁定的变体。

把它放在你的 rake 任务文件中（在命名空间下，所以它不会与其他 rake 任务重叠）：

```
def cron_lock(name)
  path = Rails.root.join('tmp', 'cron', "#{name}.lock")
  mkdir_p path.dirname unless path.dirname.directory?
  file = path.open('w')
  return if file.flock(File::LOCK_EX | File::LOCK_NB) == false
  yield
end 
```

用法：

```
cron_lock 'namespace_task_name' do
  # your code
end 
```

完整示例：

```
namespace :service do
  def cron_lock(name)
    path = Rails.root.join('tmp', 'cron', "#{name}.lock")
    mkdir_p path.dirname unless path.dirname.directory?
    file = path.open('w')
    return if file.flock(File::LOCK_EX | File::LOCK_NB) == false
    yield
  end

  desc 'description'
  task cleaning: :environment do
    cron_lock 'service_cleaning' do
      # your code
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T05:35:06.923

我认为最好的选择是任何类型的锁（使用文件、数据库等），但是当你使用锁时，你需要非常巧妙地在你的进程中实现错误处理，否则如果你的锁没有被释放，那么你的 cron 将永远不会运行再次进行该过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-29T12:52:15.993

用法 script_with_lock 'script_name', lock: 'lock_name'

```
job_type :script_with_lock, "cd :path && :environment_variable=:environment flock -n /var/lock/:lock.lock bundle exec script/:task :output" 
```

使用 runner_with_lock '红宝石代码'，锁：'lock_name'

```
job_type :runner_with_lock, "cd :path && flock -n /var/lock/:lock.lock script/rails runner -e :environment ':task' :output" 
```

# ruby-on-rails - 如何追踪 coffescript 和 Stripe 出错的原因？

> ID：13131632
> 
> 赞同：1
> 
> 时间：2012-10-30T00:31:54.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, coffeescript, stripe-payments

我在我的 Rails 3 应用程序中使用 Stripe 进行信用卡支付。尽管我的应用程序现在只收取一次费用，而不是像 Ryan 节目那样的订阅计费，但我大致遵循了[关于 Stripe 集成的 railscast 。](http://railscasts.com/episodes/288-billing-with-stripe)

问题是，我无法启动该`processCard()`功能。我将是第一个承认我不是 javascript 大师（或任何类型的大师）的人。它没有给出 javascript 错误，而是将表单提交到 rails（没有任何信用卡详细信息）并且失败，因为`stripe_card_token`它是 nil。我已经放置了一些`alert()`对话框，用于一些非常粗略的调试，以查看挂断的位置。除了临时的 alert() 对话框之外，我的模型名称是`Payment`迄今为止与 Ryan 的代码的唯一偏差。

所以我的问题是双重的：我怎样才能可靠地找出导致问题的原因？我哪里做错了？

这是Javascript：

```
jQuery ->
  Stripe.setPublishableKey($('meta[name="stripe-key"]').attr('content'))
  payment.setupForm()

payment =
  setupForm: ->
    $('#new_payment').submit ->
      $('input[type=submit]').attr('disabled', true)
      alert("before processCard")
      payment.processCard()
      alert("after processCard")
      false
      # else
      #   true

  processCard: ->
    alert("processCard start")
    card =
      number: $('#credit_card_number').val()
      cvc: $('#cvc').val()
      expMonth: $('#card_month').val()
      expYear: $('#card_year').val()
    alert("card values are set")
    Stripe.createToken(card, payment.handleStripeResponse)
    alert("After createToken")

  handleStripeResponse: (status, response) ->
    if status == 200
      alert(response.id)
      # $('#payment_stripe_card_token').val(response.id)
      # $('#new_payment')[0].submit()
    else
      alert(response.error.message)
      # $('#stripe_error').text(response.error.message)
      # $('input[type=submit]').attr('disabled', false) 
```

以及相关的视图：

```
<%= simple_form_for @payment, :html => { :class => 'form-horizontal'} do |f| %>
<fieldset>
  <legend>Pay via Credit Card</legend>

    <%= f.input :stripe_card_token, :as => :hidden, :id => 'stripe_card_token' %>

    <div class="well well-small">
      <%= current_user.full_name %><br />
      <%= current_user.email %><br />
      This is the name we have on file for you. If it's not correct, please <%= link_to "change it now", edit_user_registration_path(current_user) %>
    </div>

<div id="stripe_error">
  <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
</div>

<div id="credit-card">
  <div class="control-group string required">
    <%= label_tag :credit_card_number, "Card Number", :class => "control-label string required" %>
    <div class="controls">
      <%= text_field_tag :credit_card_number, nil, :class => "string required", :name => nil %>
    </div>
  </div>

  <div class="control-group string required">
    <%= label_tag :cvc, "Security code (CVC)", :class => "control-label string required" %>
    <div class="controls">
      <%= text_field_tag :cvc, nil, :class => "string required", :name => nil %>
    </div>
  </div>

  <div class="control-group date required">
    <%= label_tag :card_month, "Expiration Date", :class => "control-label date required"%>
    <div class="controls">
      <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month", :class => "date required span2"} %>
      <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+25}, {name: nil, id: "card_year", :class => "date required span2"} %>
    </div>
  </div>

    <h4>Your unpaid courses</h4>
    <% @unpaid_subs.each do |sub| %>
      <%= sub.course.name %>&nbsp;|&nbsp;<%= sub.course.credits %><br />
    <% end %>

<div class="form-actions">
<%= f.submit nil, :class=>"btn btn-primary" %>
<%= link_to "Cancel", courses_path, :class=>"btn" %>
</div>
</fieldset>
<% end %> 
```

相关问题（没有接受的答案）：[我在 Stripe 中的 CoffeScript 有什么问题？](https://stackoverflow.com/questions/11314013)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:36:18.303

我解决了这个问题。非常感谢“@mu 太短”。您将其剥离为所需的 js 和 html 的建议最终帮助我找到了错误。

事实证明，我在具有 Stripe 公钥的元标记上拼错了 name 属性。在应用程序布局中，“stripe-key”中缺少“r”：

```
<%= tag :meta, :name => "stipe-key", :content => STRIPE_PUBLIC_KEY %> 
```

我很难找到这个，因为它没有导致任何异常或出现在日志中。为了找到问题的原因，我做了两件事：

*   我`alert()`在 javascript 的关键位置放置了对话框，以在脚本运行时暂停脚本并查找哪个函数不起作用。有点粗糙，但它有效。
*   正如@mu 在评论中所说的太短：

> 您确定没有其他 JavaScript 妨碍您吗？通过手动编写 HTML 并删除除条带库、jQuery 和您的代码之外的所有 (Coffee|Java)Script 来重新启动。

在执行此操作时，我发现如果页面上的其他一些 javascript 出现错误，则 javascript 将无法正常运行。通过将视图剥离到基本要素，我不仅最终发现了变量名的问题，而且还发现了几个不相关的错误。

# actionscript-3 - 浏览器中的 Flash CS6 AS3 测试电影不起作用

> ID：13131638
> 
> 赞同：2
> 
> 时间：2012-10-30T00:33:03.913
> 
> 标签：actionscript-3, browser, flash

我有一个使用 Flahs CS6 AS3 链接 URL 的按钮。当我在 Flash Professional 中测试它时，（Cntl+Enter）它可以工作，但是当我在浏览器（F12）中测试时，该按钮不起作用。当我自己打开 swf 文件时，它也不能正常工作。仅在从 Fla 文件导出时有效（使用 Cntl+Enter），但不能从文件夹中打开实际的 swf 文件）

代码是这样的 - 我认为这个没问题，因为它在导出时工作（Cntl+Enter）

```
function gotoAuthorPage(event:MouseEvent):void

 { 
  var targetURL:URLRequest = new URLRequest("http://www.google.com/"); 
  navigateToURL(targetURL,"_self"); 
} 

  my_btn.addEventListener(MouseEvent.CLICK, gotoAuthorPage); 
```

有谁知道为什么会发生这种情况，我怎样才能让它在浏览器和 swf 文件中工作......请帮忙！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:52:42.097

当您从 Flash 中`ctrl`+`enter`时，您的 SWF 正在投影仪中执行。

*确保您的发布设置启用“本地播放安全”*的网络访问：

![发布设置](../Images/be1c73ab3dc9c0c8d1b36be0463781d8.png)

# prolog - 删除其他抽象语法中的歧义以编写 DCG 解析器 Prolog

> ID：13131640
> 
> 赞同：5
> 
> 时间：2012-10-30T00:33:26.930
> 
> 标签：prolog, dcg, left-recursion

P => 程序 K => 块

S => 单命令

C => 命令

E => 表达式

B => 布尔表达式

I => 标识符

N > 数字

P ::= K。

K ::= 开始 C 结束

C ::= C1 ; C2 | 小号

S ::= 我 := E | 如果 (B) 则 S | 如果 (B) 则 S1 否则 S2 | 而（B）做S | 重复 C 直到 (B) | ķ | 打印 E

E ::= - E | E1 + E2 | E1 - E2 | E1 E2 | E1 分区 E2 | E1 模组 E2 | (五) | 我 | ñ

B ::= E1 = E2 | E1 > E2 | E1 < E2 | E1 != E2 | 不是 B | B1 和 B2 | B1 或 B2 | (乙)

我应该删除 E 和 B 中的歧义，以便我可以在 prolog 中编写 DCG 解析器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T08:37:57.233

Prolog 自上而下评估，然后可以调整LL[语法技术。](http://en.wikipedia.org/wiki/LL_parser#Solutions_to_LL.281.29_Conflicts)DCG 比 LL(1) 更强大，但仍然必须消除左递归。

`B`更容易处理：*留下*生产要素。

```
B ::= E Bx | not B | (B)
Bx ::= = E | > E | < E | != E | and B | or B 
```

E 更难，因为miss `mul`token 引入了更多的歧义。姑且

```
E ::= − E | (E) | I | N | El
El ::= Ex E | epsilon
Ex ::= + El | − El | div El | mod El 
```

DCG中的epsilon（空生产）可以这样写

```
epsilon --> []. 
```

如果您需要处理优先级和关联性（在 B 和 E 中），您将需要更多的工作。您可以参考[这个](https://stackoverflow.com/a/7828855/874024)较旧的答案以获取工作模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T16:44:59.760

@chac 已经给了你一个很好的答案，向你展示了解决这个问题的常用方法。

让我以另一种方式阅读您的问题：您“应该删除 E 和 B 中的歧义，以便”您“可以在 Prolog 中编写 DCG 解析器”。这意味着，您只需要消除歧义，就可以在 Prolog 中编写 DCG 解析器。有一个好消息：**编写 DCG 解析器根本不需要消除任何歧义！**方法如下：

歧义的来源是像

C ::= C ; C

或其他运算符 + - 并列 div mod 和

让我坚持一个简化的语法：

E ::= E + E | “1”

我们可以将其编码为

```
e --> "1".
e --> e, "+", e. 
```

不幸的是，Prolog 不会因类似的查询而终止

```
?- L = "1+1+1", phrase(e,L).
L = "1+1+1" ;
ERROR: Out of local stack 
```

实际上，它终止了，但这只是因为我的计算机的内存是有限的......

甚至不适合：

```
?- L = "1", phrase(e,L).
L = "1" ;
ERROR: Out of local stack 
```

这是一个模棱两可的问题吗？不！这只是 Prolog 的一个程序问题，不能直接处理左递归。这是一种让 Prolog 处理它的方法：

```
e([_|S],S) --> "1"。
e([_|S0],S) --> e(S0,S1), "+", e(S1,S)。

?- L = "1+1+1", 短语(e(L,[]),L)。
L = "1+1+1" ;
L = "1+1+1" ;
错误的。

?- L = "1", 短语(e(L,[]),L)。
L = "1" ;
错误的。

```

目前我们只定义了一个语法，大多数时候你也有兴趣看看对应的语法树：

```
e(整数 (1), [_|S],S) --> "1"。
e( plus(L,R), [_|S0],S) --> e( L, S0,S1), "+", e( R, S1,S)。

?- L = "1+1+1", 短语(e(Tree, L,[]),L)。
L = "1+1+1",
树 = plus(integer(1),plus(integer(1),integer(1))) ;
L = "1+1+1",
树 = plus(plus(integer(1),integer(1)),integer(1)) ;
错误的。

```

现在，我们看到`plus`! 您的原始语法都将其接受为 (1+1)+1 和 1+(1+1)，只要相应的语义保证观察到关联性，这本身就不是问题。大多数情况下，这被消除为左结合，因此意味着 (1+1)+1，但并非所有中缀运算符都是如此。

# xml - 如何使用 c# 使用 xml 架构跟踪 xml 文档？

> ID：13131642
> 
> 赞同：1
> 
> 时间：2012-10-30T00:33:51.497
> 
> 标签：xml, user-interface, editor, schema

首先，我很抱歉我的英语。我英语说得不好。

我正在使用 wpf 制作 xml GUI 编辑器。

（类似[http://www.felixgolubov.com/XMLEditor/Demo.html](http://www.felixgolubov.com/XMLEditor/Demo.html)）

（我的图形用户界面：[https](https://picasaweb.google.com/111372677877243737937/XmlEditor#5804892323036956914) ://picasaweb.google.com/111372677877243737937/XmlEditor#5804892323036956914 ）

我完成了从 xsd 文件制作 GUI。现在我必须解析 xml 文档并填写 GUI 表单。

这项工作的最佳方法是什么？XML 文档只有元素和属性。但 xml 架构有多种类型，如 XmlSchemaComplexType、XmlSchemaChoice、XmlSchemaSequence 等。以及多个实例（MaxOccurs="unbounded"）

我真的需要这份工作的帮助。谢谢

雨歌

# php - 从 PHP 和 mySQL 返回整数到 Android

> ID：13131647
> 
> 赞同：0
> 
> 时间：2012-10-30T00:34:35.857
> 
> 标签：php, android, json

我有一个在线的 mySQL 数据库。我可以更新分数，而且效果很好。现在我想向 Android 返回一个行号，但我做不到。我的 php 文件：

```
 <?php

$name = $_REQUEST['jugador'];
$score = $_REQUEST['score'];
$moles = $_REQUEST['topos']; 

$con = mysql_connect("hots","db","pass");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("a5385197_scores", $con);

mysql_query("INSERT INTO scores VALUES (null, '$name', $score, $moles)");

$result = mysql_query("SELECT COUNT(1) FROM scores WHERE score >= $score");

echo json_encode($result);

mysql_close($con);
 ?> 
```

插入工作正常，Select 语句返回正确值，但我无法发送到 Android。我要响应的 Android 代码：

```
 try {
             BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
             StringBuilder sb = new StringBuilder();
             String line = null;
             while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
             }
             is.close();

             result = sb.toString();
             Log.i("miTraza","Recive: "+result);
        }catch(Exception e){
                Log.e("miError", "Error converting result "+e.toString());
        } 
```

结果我得到一个错误：

```
10-30 01:13:29.445: I/miTraza(29304): Recive: <br><table border='1' cellpadding='2' bgcolor='#FFFFDF' bordercolor='#E8B900' align='center'><tr><td><font face='Arial' size='1' color='#000000'><b>PHP Error Message</b></font></td></tr></table><br />
10-30 01:13:29.445: I/miTraza(29304): <b>Warning</b>:  [json] (php_json_encode) type is unsupported, encoded as null in <b>/home/a5385197/public_html/try.php</b> on line <b>21</b><br />
10-30 01:13:29.445: I/miTraza(29304): <br><table border='1' cellpadding='2' bgcolor='#FFFFDF' bordercolor='#E8B900' align='center'><tr><td><div align='center'><a href='http://www.000webhost.com/'><font face='Arial' size='1' color='#000000'>Free Web Hosting</font></a></div></td></tr></table>null
10-30 01:13:29.445: I/miTraza(29304): <!-- Hosting24 Analytics Code -->
10-30 01:13:29.445: I/miTraza(29304): <script type="text/javascript" src="http://stats.hosting24.com/count.php"></script>
10-30 01:13:29.445: I/miTraza(29304): <!-- End Of Analytics Code --> 
```

我从 PHP 开始，所以很容易出错。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:37:14.390

`echo json_encode(mysql_fetch_array($result));`

# c# - iPhone App 在 Testflight 上运行良好，但不是现场直播

> ID：13131648
> 
> 赞同：2
> 
> 时间：2012-10-30T00:34:37.867
> 
> 标签：c#, iphone, ios, testflight

我们最近刚刚做了一些重要的工作，在 iOS 端和服务器端的 iPhone 应用程序（非常类似于grindr、blender）上添加了功能并进行了大量的性能优化，以使其运行得更快。我们创建了一个新版本，最终在一小群用户的 testflight 上运行顺利，问题最少。我们相信新的发布会顺利进行，测试服务器文件已移至实时服务器，然后新的应用程序版本已准备好销售。

启动后，用户开始遇到许多问题。最常见的问题是应用程序运行缓慢、反应迟钝和经常崩溃。

我们已经集思广益了几个原因.. - 使用旧应用程序版本的用户与使用新应用程序版本的用户发生冲突。- 服务器有问题（尽管带宽似乎很好） - 大多数用户在澳大利亚（云服务器是基于美国的机架空间，ping 时间慢？）

任何解决方案都会很棒。哦，对不起，我对服务器的了解有限，但我可以将信息传递给潜在的服务器开发人员会很棒！

谢谢你

# gwt - GWT FileUpload 问题：Content-Type 是 'multipart/form-data; 预期的“文本/x-gwt-rpc”

> ID：13131650
> 
> 赞同：0
> 
> 时间：2012-10-30T00:34:59.590
> 
> 标签：gwt

我在将文件上传到服务器时遇到了一些麻烦。我使用了本教程：[http](http://code.google.com/p/gwtupload/wiki/GwtUpload_GettingStarted) ://code.google.com/p/gwtupload/wiki/GwtUpload_GettingStarted ，一切顺利，但是当我选择一个文件时，进度条没有显示任何进度，在 Eclipse 中我得到：

[WARN] 调度传入 RPC 调用 javax.servlet.ServletException 时出现异常：Content-Type 为 'multipart/form-data; 边界=----webkitformboundaryfafzb7tzbpq9rkjl'。预期为“文本/x-gwt-rpc”。在 com.google.gwt.user.server.rpc.RPCServletUtils.checkContentTypeIgnoreCase(RPCServletUtils.java:476) ....

我开始在 GWT 的 HelloWorld 初始项目之上添加教程中的代码。

这是我的 web.xml 文件

```
<context-param>
    <!-- max size of the upload request -->
    <param-name>maxSize</param-name>
    <param-value>3145728</param-value>
</context-param>
<context-param>
    <!-- Useful in development mode to slow down the uploads in fast networks. 
        Put the number of milliseconds to sleep in each block received in the server. 
        false or 0, means don't use slow uploads -->
    <param-name>slowUploads</param-name>
    <param-value>200</param-value>
</context-param>

<!-- Servlets -->
<servlet>
    <servlet-name>greetServlet</servlet-name>
    <servlet-class>webapp.server.GreetingServiceImpl</servlet-class>

    <servlet-name>uploadServlet</servlet-name>
    <!-- This is the default servlet, it puts files in session -->
    <servlet-class>webapp.server.CustomizedUploadServlet</servlet-class>

</servlet>

<servlet-mapping>
    <servlet-name>greetServlet</servlet-name>
    <url-pattern>/singlefileuploadsample/greet</url-pattern>

    <servlet-name>uploadServlet</servlet-name>
    <url-pattern>*.gupld</url-pattern>

    <servlet-name>uploadServlet</servlet-name>
    <url-pattern>/upload</url-pattern>

</servlet-mapping>

<!-- Default page to serve -->
<welcome-file-list>
    <welcome-file>SingleFileUploadSample.html</welcome-file>
</welcome-file-list> 
```

对于 servlet，我创建了一个新类并在其中添加了代码。有一些与内容类型有关的东西，但我不知道如何解决这个问题。

更新：

当我尝试在 Jetty 上部署项目时，这只发生在 Eclipse 中。一旦部署为Tomcat上的war文件，我就可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:39:41.627

我使用[gwtupload](http://code.google.com/p/gwtupload/)进行文件上传

```
import gwtupload.server.UploadAction;
import gwtupload.server.exceptions.UploadActionException;

import java.io.File;
import java.util.Hashtable;
import java.util.List;

import javax.servlet.http.HttpServletRequest;

import org.apache.commons.fileupload.FileItem;

public class CWTUploadServlet extends UploadAction {

  private static final long serialVersionUID = 1L;

  Hashtable<String, String> receivedContentTypes = new Hashtable<String, String>();
  /**
   * Maintain a list with received files and their content types. 
   */
  Hashtable<String, File> receivedFiles = new Hashtable<String, File>();

  /**
   * Override executeAction to save the received files in a custom place
   * and delete this items from session.  
   */
  @Override
  public String executeAction(HttpServletRequest request, List<FileItem> sessionFiles) throws UploadActionException {
    String response = "";
    int cont = 0;
    for (FileItem item : sessionFiles) {
      if (false == item.isFormField()) {
        cont++;
        try {

           //Create a new file based on the remote file name in the client
           String saveName = item.getName().replaceAll("[\\\\/><\\|\\s\"'{}()\\[\\]]+", "_");
           System.out.println("Save name : "+saveName);
           File file =new File("/Users/Spirit/hob/" + saveName);

          item.write(file);
          /// Save a list with the received files
          receivedFiles.put(item.getFieldName(), file);
          receivedContentTypes.put(item.getFieldName(), item.getContentType());

          /// Compose a xml message with the full file information
          response += "<file-" + cont + "-field>" + item.getFieldName() + "</file-" + cont + "-field>\n";
          response += "<file-" + cont + "-name>" + item.getName() + "</file-" + cont + "-name>\n";
          response += "<file-" + cont + "-size>" + item.getSize() + "</file-" + cont + "-size>\n";
          response += "<file-" + cont + "-type>" + item.getContentType() + "</file-" + cont + "type>\n";
        } catch (Exception e) {
          throw new UploadActionException(e);
        }
      }
    }

    /// Remove files from session because we have a copy of them
    removeSessionFileItems(request);

    /// Send information of the received files to the client.
    return "<response>\n" + response + "</response>\n";
  } 
```

还有你的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <display-name>CWTMVP</display-name>

    <!-- Default page to serve -->
    <welcome-file-list>
        <welcome-file>CWTMVP.html</welcome-file>
    </welcome-file-list>

    <!--
        This Guice listener hijacks all further filters and servlets. Extra
        filters and servlets have to be configured in your
        ServletModule#configureServlets() by calling
        serve(String).with(Class<? extends HttpServlet>) and
        filter(String).through(Class<? extends Filter)
    -->
    <listener>
        <listener-class>com.db.cawt.clientzonedesign.server.guice.GuiceServletConfig</listener-class>
    </listener>

    <filter>
        <filter-name>guiceFilter</filter-name>
        <filter-class>com.google.inject.servlet.GuiceFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>guiceFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

      <context-param>
        <param-name>maxSize</param-name>
        <param-value>102400000</param-value>
      </context-param>

      <context-param>
        <param-name>slowUploads</param-name>
        <param-value>true</param-value>
      </context-param>

      <servlet>
        <servlet-name>uploadServlet</servlet-name>
        <servlet-class>xxx.yyy.server.CWTUploadServlet</servlet-class>
      </servlet>

      <servlet-mapping>
        <servlet-name>uploadServlet</servlet-name>
        <url-pattern>*.gupld</url-pattern>
      </servlet-mapping>

</web-app> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-02T18:07:15.260

mP 是正确的，您不能将带有文件的表单发布到 RPC servlet。因此，不要扩展 RemoteServiceServlet，而是创建一个扩展 javax.servlet.http.HttpServlet 的 servlet。我自己做了这个改变（使用[这个](https://stackoverflow.com/questions/6420851/calling-servlet-on-submiting-formpanel-in-gwt)问题中的代码）并成功上传了一个文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T01:04:41.270

您不能发布包含要上传到 RPC 服务的文件的表单。扩展 RPC servlet 的服务无法接收表单，而只能获取适当的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T13:21:35.087

您的错误跟踪表明收到您发送的请求的 servlet 是 gwt-rpc servlet。

看来您的 web.xml 配置正确，并且应该根据您的 webapp.server.CustomizedUploadServlet 处理请求的文件，所以我看到的错误的唯一可能原因是：

*   您的 webapp.server.CustomizedUploadServlet 正在扩展 RPCServlet 而不是 UploadAction。
*   或者您的部署错误并且您的应用程序没有读取正确的 web.xml

# sql-server - 试图为 ms sql 探索 olap 多维数据集，但有多个分支的产品文件，这些分支可能在所有分支中具有相同的键有什么想法吗？

> ID：13131653
> 
> 赞同：0
> 
> 时间：2012-10-30T00:35:38.157
> 
> 标签：sql-server, visual-studio-2008, cube, olap-cube

我需要为多个分支机构创建基于销售额的多维数据集，但我不确定如何处理每个分支机构可能使用相同产品代码的事实。在 vs 2008 中，它不会处理多维数据集，因为它看到此代码在我的主产品文件中重复，该文件也有一个分支 id 字段来区分标准查询

有人知道如何在这种情况下设置立方体吗？

表格（仅部分用于说明）

• 事务（所有分支 - 具有分支 ID 和产品 ID） • 产品（主文件 - 具有分支 ID 和产品 ID） • 用户（指向事务的链接） • 分支表（指向事务的链接）

基本上这个立方体有四个维度，用户、产品、分支和基于交易字段的时间维度。

产品领域是主要问题。DB设计因应用而受到限制

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T09:56:06.957

解决方案是在具有重复键的表中添加一个额外的字段，这个字段我称之为业务逻辑键。这对于每个产品都是唯一的，无论产品代码是否再次出现，BLK 仍然是唯一的，只需将其添加到 products 表和 transactions 表并运行一个简单的 sql 查询以使用您的 BLK 更新事务并将其用于 olap 多维数据集 -排序:)

# java - 为什么我的数据透视排序算法没有达到基本情况？

> ID：13131655
> 
> 赞同：2
> 
> 时间：2012-10-30T00:35:49.250
> 
> 标签：java, sorting, linked-list, pivot

我在尝试为链表构建排序算法时遇到堆栈溢出异常。在那里，我的排序无限期地卡在同一个支点上，我无法弄清楚为什么它没有达到基本情况。

//Intlist 是一个简单的单链表类，带有一个 int var ".item" 和一个 .next 指针

```
 pivotS(Intlist thisList){
    if (thisList == null || thisList.next == null){
      return thisList;
    } else{
      int pivot = thisList.item;
      Intlist lower = lowerThanPivot(pivot, thisList);
      Intlist upper = greaterOrEqualPivot(pivot, thisList);
      lower = pivotS(lower);
      upper = pivotS(upper);
      return appendLists(lower, upper);
    }
  } 
```

这应该类似于构造中的合并排序，对吧？我的个人功能似乎工作正常。我只是设置递归错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-24T23:05:46.353

想象一下，你有一个由数字 137 的两个副本组成的列表，让我们看看这个算法会做什么。

首先，您将查看第一个元素并注意到它存在（它不为空）并且列表不只有一个元素（下一个指针也不为空）。然后将第一项拆分为枢轴，因此枢轴为 137。

现在，看看接下来会发生什么。该`lower`列表由小于主元的所有元素组成，在本例中为空列表。该`upper`列表由大于或等于枢轴的所有元素组成，在这种情况下，枢轴是 137 的两个副本。然后您递归地调用`pivotS`这两个列表。但是，这里有一个问题 - 该`upper`列表等于您需要排序的原始列表，因此递归的进行方式与以前完全相同。这最终导致堆栈溢出。

要解决此问题，请更新您的代码以将输入列表分成*三*组 - 小于枢轴的元素、等于枢轴的元素和大于枢轴的元素。这可能看起来像这样：

```
pivotS(Intlist thisList){
    if (thisList == null || thisList.next == null){
      return thisList;
    } else{
      int pivot = thisList.item;
      Intlist lower = lowerThanPivot(pivot, thisList);
      Intlist equal = equalToPivot(pivot, thisList);
      Intlist upper = greaterThanPivot(pivot, thisList);
      return appendLists(appendLists(pivotS(lower), equal), pivotS(upper);
    }
  } 
```

# objective-c - 如何检查 iOS 设备自启动后是否已重新启动

> ID：13131663
> 
> 赞同：6
> 
> 时间：2012-10-30T00:36:25.140
> 
> 标签：objective-c, ios

看看人们为此想出了什么。基本上我想知道自我的应用程序上次启动以来实际设备是否已重新启动。人们使用什么方法来发现这一点？（如果有的话？）

我考虑过使用 mach_absolute_time 但这仍然是一种不可靠的方法。

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T00:59:46.040

不确定这是否是您想要的，但请看一下：

[https://github.com/pfeilbr/ios-system-uptime](https://github.com/pfeilbr/ios-system-uptime)

在这个例子中，作者从内核任务进程中获取它。

或者你可以看看 mach_absolute_time 路线，有一个类似的目标苹果官方问答[https://developer.apple.com/library/mac/#qa/qa1398/_index.html](https://developer.apple.com/library/mac/#qa/qa1398/_index.html)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-17T23:22:33.067

这是我做的一个。它需要 GMT 的当前时间和自上次重新启动以来的时间来推断设备上次重新启动的日期。然后它使用 NSUserDefaults 在内存中跟踪这个日期。享受！

*注意：由于您想在上次启动应用程序后检查这一点**，**因此您需要确保在应用程序启动时调用该方法。最简单的方法是调用下面的方法`+(void)initialize {`，然后在需要手动检查时调用*

```
#define nowInSeconds CFAbsoluteTimeGetCurrent()//since Jan 1 2001 00:00:00 GMT
#define secondsSinceDeviceRestart ((int)round([[NSProcessInfo processInfo] systemUptime]))
#define storage [NSUserDefaults standardUserDefaults]
#define DISTANCE(valueOne, valueTwo) ((((valueOne)-(valueTwo))>=0)?((valueOne)-(valueTwo)):((valueTwo)-(valueOne)))

+(BOOL)didDeviceReset {
    static BOOL didDeviceReset;
    static dispatch_once_t onceToken;
    int currentRestartDate = nowInSeconds-secondsSinceDeviceRestart;
    int previousRestartDate = (int)[((NSNumber *)[storage objectForKey:@"previousRestartDate"]) integerValue];
    int dateVarianceThreshold = 10;
    dispatch_once(&onceToken, ^{
        if (!previousRestartDate || DISTANCE(currentRestartDate, previousRestartDate) > dateVarianceThreshold) {
            didDeviceReset = YES;
        } else {
            didDeviceReset = NO;
        }
    });
    [storage setObject:@(currentRestartDate) forKey:@"previousRestartDate"];
    [storage synchronize];
    return didDeviceReset;
} 
```

# jena - 如何获得一个与 Jena 匹配 Objectproperty 的个人？

> ID：13131666
> 
> 赞同：1
> 
> 时间：2012-10-30T00:36:58.453
> 
> 标签：jena, ontology, owl, pellet

让我们考虑以下本体，其中、 和`PERSON`是`NAME`类。并且是 的子类。并且是**功能 ObjectProperty**。是具有域和范围字符串的 DataTypeProperty。`SURNAME``IDENTIFICATION``NAME``SURNAME``IDENTIFICATION``hasSurname``hasName`**`hasValue``IDENTIFICATION`**

 **![在此处输入图像描述](../Images/4e55ad3185d19a9ddc4b32c38c7b2df7.png)

让我们使用 jena 和 2 人自动实例化这个模型，person1 是“Henry Ford”，person2 是“Harrison Ford”。

为了处理这种重复，需要根据以下模式自动实例化本体，其中个体`name1`用于 person1 和 person2。

```
String   NS    = .... // the name space
OntModel model = .... // Jena model to use   

// creating all the individuals with random uri

Individual person1  = model.createIndividual(NS + "PERSON" + Math.random());
Individual name1    = model.createIndividual(NS + "NAME" + Math.random());
Individual surname1 = model.createIndividual(NS + "SURNAME" + Math.random());
Individual person2  = model.createIndividual(NS + "PERSON" + Math.random());
Individual name2    = model.createIndividual(NS + "NAME" + Math.random());
Individual surname2 = model.createIndividual(NS + "SURNAME" + Math.random());

// asserting that ...
// person1 _hasName_ (name1 _hasValue_ "Ford")     
// person1 _hasSurname (surname1 _hasValue_ "Henry")

name1.addProperty(model.getOntProperty(NS + "hasValue"), Resourcefactory.createLiteral("Ford"));
surname1.addProperty(model.getOntProperty(NS + "hasValue"), Resourcefactory.createLiteral("Henry"));
model.add(person1, model.getOntProperty(NS + "hasName"), name1);
model.add(person1, model.getOntProperty(NS + "hasSurname"), surname1);

name1 = null; // loosing reference to name1

// asserting that ...
// person2 _hasName_ name1
// person2 _hasSurname (surname2 _hasValue_ "Harrison") 
```

如何找到`NAME`属性`hasvalue`为“福特”的类的个体以正确完成实例化？

感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T13:10:53.290

`surname1`从概念上讲，为什么`surname2`必须是不同的个体？那里的使用`Math.random()`看起来很奇怪。如果您考虑您陈述的问题，您有两个人，Henry Ford 和 Harrison Ford，并且在您的域模型中，您希望姓名和姓氏是独立的个体（我假设您有充分的理由，这是一种奇怪的方式接近这个特定的问题）。所以我对你的建模方法的问题是：两个人是否共享一个姓氏福特，或者是否有两个姓氏恰好有相同的`hasValue`字面意思？

就个人而言，我会通过利用图中的通用结构来解决这个问题：

```
ns:ford 
  a ns:Surname ;
  ns:hasValue "Ford".

ns:harrison
  a ns:FirstName ;
  ns:hasValue "Harrison".

ns:henry
  a ns:FirstName ;
  ns:hasValue "Henry".

ns:person1
  a ns:Person ;
  ns:firstName ns:henry ;
  ns:surname ns:ford .

ns:person2
  a ns:Person ;
  ns:firstName ns:harrison ;
  ns:surname ns:ford . 
```

但是，我不知道您要解决什么问题，所以我不能说这是否适合您。例如，它可以很容易地找到所有具有相同姓氏的人。

一般来说，如果您*不想*在图中共享节点，那么您确实希望 Ford 的两种不同用途是不同的，您可以使用空白节点来避免乱用随机数：

```
ns:person1
  a ns:Person ;
  [a ns:SurName ; ns:hasValue "Ford"] ;
  [a ns:FirstName ; ns:hasValue "Henry"]. 
```

因此，我对您问题的主要回答是要清楚您要构建的图表。然后你需要做的耶拿会更清楚。

要回答您的具体问题，如果您想根据其属性模式定位特定资源，我建议使用 SPARQL 查询。您可以使用 Jena API 调用的模式来做到这一点，但 SPARQL 查询一旦超过了很小的初始模式大小，就会变得更加紧凑。**

# xcode - 您可以在 -(void)viewDidAppear:(BOOL)animated 内嵌套一个 IBAction（按钮）吗？如何？

> ID：13131669
> 
> 赞同：0
> 
> 时间：2012-10-30T00:37:24.797
> 
> 标签：xcode, xcode4, xcode4.2, ibaction, viewdidappear

我确定我需要我的按钮操作 (findMe) 成为 viewDidAppear 的一部分，并且不能将其作为单独的 IBAction，因为它有显示用户位置错误。

A：这甚至可能吗？

B：这样做有意义吗？

C：它会是什么样子？

我知道错误的当前代码如下所示：

```
-(void)viewDidAppear:(BOOL)animated
{
  if (findMe == YES)
  {
    self.mapView.showsUserLocation = YES;
    [mapView setCenterCoordinate:mapView.userLocation.coordinate animated:YES];
  }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:02:08.983

您的问题措辞非常混乱且不完整（请包括有错误的代码和确切的错误消息），但我会回答我认为您可能会问的三件事。

如果您的问题是您希望在两种方法中使用相同的代码，请将两种方法的公共部分提取到第三种方法中，并让它们都调用它。

```
- (IBAction) button {
    stuff
    [self commonPart];
}

- (void) viewDidAppear {
    stuff
    [self commonPart];
}

- (void) commonPart {
    stuff they both do
} 
```

如果您的问题是您需要在 viewDidAppear 方法中了解有关 UI 状态的信息，则可以使用 IBOutlet 来引用相关控件。

```
- (void) viewDidAppear {
    if (self.findMeButton.someThingYouWantToCheck) {
          self.mapView.showsUserLocation = YES;
          [mapView setCenterCoordinate:mapView.userLocation.coordinate animated:YES];
    }
} 
```

如果您的问题是您需要存储按钮是否被按下，以便以后可以基于它执行不同的操作，只需将 BOOL 实例变量添加到您的对象并在按下按钮的 IBAction 中将其设置为 YES。

这些是你想要做的吗？

# windows - Windows Azure Node.js SDK - 如何高效查询表存储

> ID：13131671
> 
> 赞同：0
> 
> 时间：2012-10-30T00:37:40.653
> 
> 标签：windows, node.js, azure, sdk

我编写了一个 FB 应用程序，并希望添加更多功能并使其更具社交性。我正在尝试做的一件事是根据用户朋友查询表存储，并发现用户朋友是否在我的应用程序中“观看”了视频。我可以很好地从 FB 获取朋友 ID，但我不确定如何构造我的表存储查询，因为 FB 用户可以拥有的最大朋友数是 5000，所以我最终可能会得到这样的查询：

```
var ts1 = azure.createTableService(config.storageAccount, config.storageAccessKey, config.tableHost);
var query = azure.TableQuery
    .select()
    .from('hits')
    .where('PartitionKey eq ?', '0')

for (f in friends){
    query.or('UserID eq ?', friends[f].UserID);
}

ts1.queryEntities(query, function (err, result){
    etc ...
} 
```

导致一个大胖查询！

我的问题是，在对 Windows Azure 表存储进行这种性质的查询时，这是否是最有效和最具成本效益的（最少的表存储事务），还是更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T06:54:00.797

请记住，表存储不是关系数据库，这意味着您无法利用存储过程的强大功能，以及 SUM 等内置函数……这意味着您无法进行服务器端计算，例如计算总数点击单个用户并返回该结果。

取而代之的是表存储，您需要提取所有这些数据并在消费者端进行工作。另一种解决方案是复制数据。可以为每个点击记录视频、时间等信息……但另一方面，您需要一个包含每个用户的总点击数的不同表格（如共享计数器）。

这样，当您想要单个用户的总点击次数时，您只需查询该值，而无需一遍又一遍地重新计算它。您将写入 2 条记录而不是 1 条，但读取速度会快得多。

Steve Marx 就此写了一篇很好的介绍性文章：[Architecting Scalable Counters with Windows Azure](http://blog.smarx.com/posts/architecting-scalable-counters-with-windows-azure)

# msdeploy - 如何使用 Visual Studio 2012 和 MSdeploy 将 PDB 文件包含到包 ZIP 文件中

> ID：13131672
> 
> 赞同：2
> 
> 时间：2012-10-30T00:37:51.393
> 
> 标签：msdeploy, pdb

我需要能够将 PDB 文件包含到当我在 Visual Studio 中运行“发布”命令以创建 MSDeploy 包时创建的 ZIP 文件中。

我可以看到文件夹中的 PDB 文件，但它们没有进入 ZIP 文件

我需要设置一些配置设置吗？

是的，我知道这不是标准做法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T07:53:31.633

你有两个选择。

### 简单的解决方案

在设置选项卡上的发布对话框中，您可以将配置设置为调试并使用它进行发布。

### 稍微复杂的解决方案

如果您想在发布模式下构建但仍包含 PDB，那么您可以编辑发布配置文件。当您在 VS 发布对话框上创建发布配置文件时，我们会在 Properties\PublishProfile 下创建一个文件（对于 VB，My Project\PublishProfiles）。您可以添加特定的 MSBuild 元素来自定义这些元素。在您的情况下，行为由名为 ExcludeGeneratedDebugSymbol 的属性控制，`true`如果您在 Release 中构建，则该属性设置为。`</Project>`因此，只需在您的 .pubxml 文件中通过在结束标记正上方添加下面的元素来声明该属性为 false 。

```
<PropertyGroup>
  <ExcludeGeneratedDebugSymbol>false</ExcludeGeneratedDebugSymbol>
</PropertyGroup> 
```

您可以从发布对话框继续发布，它将保留您的编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T05:10:49.457

我通过在 web 项目的项目文件中执行此操作来使其工作

```
<ItemGroup>
  <_CustomFilesPdb Include="$(OutDir)\SEEK.*.pdb" Exclude="$(OutDir)\*Tests*.pdb" />
  <FilesForPackagingFromProject Include="%(_CustomFilesPdb.Identity)">
    <DestinationRelativePath>bin\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
  </FilesForPackagingFromProject>
</ItemGroup> 
```

# android - 从浏览器链接到本机 Google Play 商店应用

> ID：13131676
> 
> 赞同：2
> 
> 时间：2012-10-30T00:38:19.337
> 
> 标签：android, google-play

我想以与 iPhone "itms://itunes.apple.com/..." 相同的方式从网页链接到 Google Play/Marketplace 应用程序。Android 设备是否可以通过我的应用程序与网页打开 Google Play/Market 本地应用程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T00:53:17.447

你不必担心所有这些东西。只需创建一个指向`https://play.google.com/store/apps/details?id=your.package.name`. 您不必使用任何替代协议。

根据用户的设置，系统会询问他们想使用哪个应用程序来查看 URL（如果有多个）。默认情况下，这将使用 Google Play 打开商店页面。

使用任何自定义 URL 解析或任何东西的优势在于桌面用户仍然能够使用 URL 并使用市场的网络版本安装（或购买）应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-30T00:45:13.033

如果您想从浏览器或代码中启动它，但不是 100% 明确，但在 Android 中，您只需使用“Intent” - 这是一个如何启动它的示例：

```
protected Dialog onCreateDialog(int id) {
    return new AlertDialog.Builder(this)
    .setTitle(R.string.unlicensed_dialog_title)
    .setMessage(R.string.unlicensed_dialog_body)
    .setPositiveButton(R.string.buy_button,
    new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog,
        int which) {
            Intent marketIntent = new Intent(
            Intent.ACTION_VIEW,
            Uri.parse("http://market.android.com/details?id=com.myappname"));
            startActivity(marketIntent);
        }
    })
    .setNegativeButton(R.string.quit_button,
    new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog,
        int which) {
            finish();
        }
    }).create();
} 
```

这将显示一个对话框，其中包含转到 Google Play 商店的选项。

这是实际完成工作的部分：

```
Intent marketIntent = new Intent(
Intent.ACTION_VIEW,
Uri.parse("http://market.android.com/details?id=com.myappname"));
startActivity(marketIntent); 
```

# android - pinnedHeaderListView 不显示“异国情调”字符的标题

> ID：13131682
> 
> 赞同：0
> 
> 时间：2012-10-30T00:39:03.150
> 
> 标签：android, header, android-listview, scroll

我正在使用[pinnedHeaderListView](https://code.google.com/p/android-playground/)的酷示例，我希望将它用于各种字符串。

出于某种原因，某些字符（如“~”）在此处显示不佳，导致其标题不显示。

![在此处输入图像描述](../Images/f8fb0381f71cac17c4f22bf884ceeac6.png)

如您所见， "~" 没有标题。如果我滚动直到显示的第一个项目有一个“~”，就会显示标题。

为什么会发生，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:56:07.757

一眼看去，原因似乎是这样的：

PinnedHeaderActivity.java 上的第 131 行是您的问题 this.mIndexer = new StringArrayAlphabetIndexer(objects, "ABCDEFGHIJKLMNOPQRSTUVWXYZ");

尝试将 ~ 字符添加到您的字母表中。

# perl - 检查一个数字是否在两个值之间

> ID：13131686
> 
> 赞同：2
> 
> 时间：2012-10-30T00:39:23.037
> 
> 标签：perl, unix, sed, awk

我有这个文件

```
427 A   C   A/C 12
436 G   C   G/C 12
445 C   T   C/T 12
447 A   G   A/G 9
451 T   C   T/C 5
456 A   G   A/G 12
493 G   A   G/A 12 
```

我想阅读第一列并找到所有其他差异小于 10 的 id。

```
427 A   C   A/C 12  436
436 G   C   G/C 12  427,445
445 C   T   C/T 12  436,447,451
447 A   G   A/G 9   445,451,456
451 T   C   T/C 5   445,447,456
456 A   G   A/G 12  451,447
493 G   A   G/A 12 
```

最后一列应该和上面一样。与该特定 id 相距 + 或 - 10 个碱基的所有 id。例如对于 436，边界是 {426 - 446} 在该范围内的其他 id 是 427 和 445，所以我将它们显示在第 6 列中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T02:32:00.783

这是使用 Perl 的一种方法：

```
use strict;
use warnings;

open my $fh, '<', 'dataFile.txt' or die $!;
chomp( my @data = <$fh> );
close $fh;

my @IDs = map /(\d+)/, @data;

for (@data) {
    my ($id) = /(\d+)/;
    print "$_\t"
      . ( join ',', grep { abs $id - $_  < 11 and $id != $_ } @IDs )
      . "\n";
} 
```

输出：

```
427 A   C   A/C 12  436
436 G   C   G/C 12  427,445
445 C   T   C/T 12  436,447,451
447 A   G   A/G 9   445,451,456
451 T   C   T/C 5   445,447,456
456 A   G   A/G 12  447,451
493 G   A   G/A 12 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T01:05:31.587

这是使用`GNU awk`. 像这样运行：

```
awk -f script.awk file.txt{,} | column -t 
```

内容`script.awk`：

```
FNR==NR {
    array[$1]++
    next
}

{
    n = asorti(array,sort)

    for (i=1; i<=n; i++) {

        if (sort[i] <= $1 + 10 && sort[i] >= $1 - 10 && $1 != sort[i]) {
            line = (line ? line "," : line) sort[i]
        }
    }

    print $0, line

    line = ""
} 
```

结果：

```
427  A  C  A/C  12  436
436  G  C  G/C  12  427,445
445  C  T  C/T  12  436,447,451
447  A  G  A/G  9   445,451,456
451  T  C  T/C  5   445,447,456
456  A  G  A/G  12  447,451
493  G  A  G/A  12 
```

或者，这是单线：

```
awk 'FNR==NR { array[$1]++; next } { n = asorti(array,sort); for (i=1; i<=n; i++) if (sort[i] <= $1 + 10 && sort[i] >= $1 - 10 && $1 != sort[i]) line = (line ? line "," : line) sort[i]; print $0, line; line = "" }' file.txt{,} | column -t 
```

# .htaccess - 如何让直接流量访问我的网站

> ID：13131688
> 
> 赞同：0
> 
> 时间：2012-10-30T00:39:31.140
> 
> 标签：.htaccess, http, redirect

我在我的 htaccess 文件中使用此代码仅允许从我们选择的域中引用的人访问我们的站点。但是，有没有一种方法可以允许在我们的域中输入的人也访问该站点？（但阻止所有其他推荐人？）

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^http://the-ok-domain.com [NC]
RewriteCond %{HTTP_REFERER} !^http://your-domain.com [NC]
RewriteRule ^ http://the-website-of-your-choosing.com/ [L,R] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:43:45.037

> 但是，有没有一种方法可以允许在我们的域中输入的人也访问该站点？（但阻止所有其他推荐人？）

添加一个空白的referer检查：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://the-ok-domain.com [NC]
RewriteCond %{HTTP_REFERER} !^http://your-domain.com [NC]
RewriteRule ^ http://the-website-of-your-choosing.com/ [L,R] 
```

另请注意，引荐来源很容易伪造，因此无法保证这会阻止人们链接到您的网站。

# wix - 如何从 WiX 中的延迟自定义操作中获取输出变量？

> ID：13131691
> 
> 赞同：1
> 
> 时间：2012-10-30T00:40:00.820
> 
> 标签：wix, certificate, custom-action, self-signed

我正在部署一个产品，其中包含一些配置 xml 文件中的加密字段。在安装过程中，我正在目标机器上创建一个自签名证书。然后我用它来加密一些字符串，最后我需要将它们存储在一个配置文件中。

为了创建证书，我将**makecert.exe**带到目标安装目录。因此，我需要等到所有文件都复制到它们的目的地，然后才能运行创建证书的 CustomAction。在此之后，其他一些 CustomAction 正在创建需要存储在配置中的加密值。

这很好用，但此时我想将新值存储在我的配置文件中，但我已经错过了执行 XmlFile/XmlConfig 的阶段。在 MSI 日志中，我看到在复制文件后立即执行了“ExecXmlConfig”操作：

```
MSI (s) (6C:CC) [02:12:10:898]: Source for file 'makecert.exe' is compressed
InstallFiles: File: makecert.exe,  Directory: C:\Program Files (x86)\MyProduct\InstanceFolder\,  Size: 60240
MSI (s) (6C:CC) [02:12:10:900]: Executing op: SetTargetFolder(Folder=C:\Program Files (x86)\MyProduct\Nhibernate\)
MSI (s) (6C:CC) [02:12:10:900]: Executing op: SetSourceFolder(Folder=1\o1lebnnf\vemzkq_g\|MyProduct\Nhibernate\)
MSI (s) (6C:CC) [02:12:10:901]: Executing op: FileCopy(SourceName=nw4bpvhi.xml|hibernate.cfg.xml,SourceCabKey=nhibernate.config,DestName=hibernate.cfg.xml,....
MSI (s) (6C:CC) [02:12:10:902]: File: C:\Program Files (x86)\MyProduct\Nhibernate\hibernate.cfg.xml;    Won't Overwrite;    Won't patch;    Existing file is unversioned but modified
MSI (s) (6C:CC) [02:12:10:902]: Executing op: SetTargetFolder(Folder=C:\Program Files (x86)\MyProduct\InstanceFolder\)
MSI (s) (6C:CC) [02:12:10:902]: Executing op: SetSourceFolder(Folder=1\o1lebnnf\|MyProduct\)
MSI (s) (6C:CC) [02:12:10:902]: Executing op: FileCopy(SourceName=7z64.dll,SourceCabKey=Seven7z64.dll,DestName=7z64.dll,Attributes=512,...
MSI (s) (6C:CC) [02:12:10:903]: File: C:\Program Files (x86)\MyProduct\InstanceFolder\7z64.dll; To be installed;    Won't patch;    No existing file
MSI (s) (6C:CC) [02:12:10:903]: Source for file 'Seven7z64.dll' is compressed
InstallFiles: File: 7z64.dll,  Directory: C:\Program Files (x86)\MyProduct\InstanceFolder\,  Size: 1484800
MSI (s) (6C:CC) [02:12:10:929]: Executing op: CacheSizeFlush(,)
MSI (s) (6C:CC) [02:12:10:929]: Executing op: ActionStart(Name=ExecXmlConfigRollback,,)
Action 02:12:10: ExecXmlConfigRollback. 
MSI (s) (6C:CC) [02:12:10:948]: Executing op: CustomActionSchedule(Action=ExecXmlConfigRollback,ActionType=3329,Source=BinaryData,Target=ExecXmlConfigRollback,...
MSI (s) (6C:CC) [02:12:10:949]: Executing op: ActionStart(Name=ExecXmlConfig,,)
Action 02:12:10: ExecXmlConfig. 
MSI (s) (6C:CC) [02:12:10:951]: Executing op: CustomActionSchedule(Action=ExecXmlConfig,ActionType=3073,Source=BinaryData,Target=ExecXmlConfig,CustomActionData=1?C:\Program Files (x86)\MyProduct\Nhibernate\hibernate.cfg.xml?3?0?/hibernate-configuration/session-factory/property[@name='connection.connection_string']????0) 
```

所以我被困在两者之间......如果我将我的 CustomAction 配置为运行`After='InstallFiles'`，它会在文件被复制之前很久就尝试执行。（我错过了正确的事件吗？）。另一方面，如果我将我的操作配置为运行`After='InstallFinalize'`- 为时已晚，因为 XmlConfig 已经触发并且没有向配置文件写入任何内容。理想情况下，我想在安装的最后运行所有这些。

我应该编写一个与 ExecXmlConfig 执行完全相同的操作的 CustomAction 只是为了在其他时间调用它，这似乎很愚蠢......

这是我的 InstallExecuteSequence：

```
 <InstallExecuteSequence>

      <!-- Create and Register Certificate on Install -->
      <Custom Action='GenerateProductCertificate'         After='InstallFiles'><![CDATA[REMOVE<>"ALL"]]></Custom>
      <Custom Action='RegisterProductServiceCertificate'  After='GenerateProductCertificate'><![CDATA[REMOVE<>"ALL"]]></Custom>

      <!-- Create and NHibernate Certificate -->      
      <Custom Action='GenerateNHibernateCertificate'      After='RegisterProductServiceCertificate'><![CDATA[REMOVE<>"ALL"]]></Custom>

      <!-- Configure NHibernate XML with Encrypted ConnectionString -->
      <Custom Action='GenerateSecureConnectionString'                   After='GenerateNHibernateCertificate'><![CDATA[(REMOVE<>"ALL")]]></Custom>

  </InstallExecuteSequence> 
```

我正在使用 WiX 3.7（v3.7.1022.0，2012 年 10 月 22 日，星期一）

我的问题是：

*   有没有办法重新安排 ExecXmlConfig 操作在我的 CustomActions 之后运行？
*   如果没有，我可以安排我的 CustomAction 在复制文件和 ExceXmlConfig 之间运行吗？

***编辑：***

经过几次尝试和更多研究后，我可以更准确地定义我的问题。我想知道的是：**如何设置延迟操作的输出值，该输出值可用于下一个延迟操作？**

我的场景迫使我以延迟模式运行自定义操作，因此我无法访问 Session 来存储任何新变量。但我确信会安排更多的延迟操作，所以我想做的是找到一种方法将一些变量传递给它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:56:41.103

我目前正在构建的 msi 也出现了同样的问题。

**如何设置延迟操作的输出值，该输出值可用于下一个延迟操作？**

底线是我无法完全做到这一点。但是，我确实找到了一种通过其他自定义操作来解决它的方法。

我的情况略有不同，但希望有所帮助。对于这种情况，有一些注册表项必须更新，我希望保存以前的值以防回滚。我不能使用标准的 msi 注册表机制，因为值名称将取决于安装（我知道可能值的范围）。

我的自定义操作是二进制 dll 中基于 c++ 的代码。我的第一个想法是基于这样的假设，即一旦加载了 dll，它将保持不变，并且延迟执行序列中的所有调用都可以访问任何创建的数据结构。因此，我只是创建了一个全局变量并将必要的数据保存到其中。但是，在回滚调用期间，结构为空。似乎在每次调用 dll 之前，都会重新加载 dll。尽管我对它进行了足够的调查以看到 DllMain 被多次调用，但我并没有完全确认这一点。

我最终找到的解决方案是创建两个额外的自定义操作，它们在执行序列的脚本生成轮次中运行，一个用于安装，一个用于回滚。他们扫描了注册表并生成了一个分隔字符串，该字符串保存为 CustomActionData，用于相应的安装和回滚自定义操作。完成工作的延迟自定义操作被重写为仅执行通过 CustomActionData 告知的操作。所有“逻辑”（嗯，几乎所有）都在创建分隔字符串的代码中。

这似乎确实有效。我现在唯一有点担心的是，注册表扫描和注册表更新之间存在一些延迟和分离，出于美学目的，我想我试图避免这种情况。

不确定您是否可以在您的情况下做类似的事情。一种想法是也使用二进制 dll 来管理所有工作。它还将具有自定义操作，这些操作会根据您的第一个自定义操作的模拟输出生成 CustomActionData，然后您的第二个操作可以读取该输出。由于您的自定义操作涉及调用外部 exe，因此您可以使用 ShellExecute、System、CreateProcess 或类似方法来执行此操作。问题是您是否可以在不实际运行第一个自定义操作的情况下获得足够的信息。

# python - Python - 以编程方式获取文件路径？

> ID：13131699
> 
> 赞同：1
> 
> 时间：2012-10-30T00:41:36.670
> 
> 标签：python, windows, path, os.system

我正在尝试创建一个 Python 程序，该程序使用 os.system() 函数根据用户输入创建一个新进程（应用程序）.​​.....但是，这仅在用户输入“notepad.exe”时才有效。例如，当用户输入“firefox.exe”时，它不起作用。我知道这是一个路径问题，因为错误表明该文件不存在。然后我假设 Windows 有一些默认的记事本路径设置，当我要求它时允许记事本运行？所以这引出了我的问题：有没有办法以编程方式找到用户输入的任何应用程序的路径，假设它确实存在？我很难相信打开文件的唯一方法是在某个时候定义整个路径。或者也许有一种 Windows 为我执行此操作的方法，但我不知道如何访问？任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T13:30:05.583

我认为您可以在 PATH 环境变量中添加文件的位置。请按照以下步骤操作：转到我的电脑->右键单击->属性->高级系统设置->单击环境变量。现在单击 PATH，然后单击 EDIT。在变量值字段中，转到末尾并附加“;” （不带引号），然后添加要通过程序运行的 .exe 文件的绝对路径。

# php - 从服务中调用服务？

> ID：13131700
> 
> 赞同：2
> 
> 时间：2012-10-30T00:41:51.647
> 
> 标签：php, symfony

我试图在服务中调用从另一个服务调用另一个方法的方法。

当前类 -> 不同的类/服务 -> 到不同的类/服务

我可以成功调用初始服务，但是当该服务尝试调用其他服务时，我收到错误

```
Fatal error</b>:  Call to a member function get() on a non-object 
```

下面是导致错误的代码：

```
$edmt = $this->get('endorsements'); 
```

以及服务声明：

```
endorsements:
    class:        EndorseMe\EndorsementBundle\Controller\DefaultController
    arguments: [ @router, @service_container] 
```

但是，为了使事情变得更棘手，此服务并不总是用作服务。它也是常规的 symfony 控制器。它需要能够双向工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T02:50:44.900

您应该将您的第二个服务作为参数传递给您的第一个服务：

```
endorsements:
    class:     EndorseMe\EndorsementBundle\Controller\DefaultController
    arguments: [ @router, @service_container, @your_second_service ] 
```

然后在您的第一个服务中：

```
protected $injectedService;

public function __construct(SecondServiceClass $injectedService)
{
    $this->injectedService = $injectedService;
} 
```

之后，您应该可以通过调用来使用注入的服务`$this->injectedService`

查看文档中的[参考服务](http://symfony.com/doc/current/book/service_container.html#referencing-injecting-services)章节。

**编辑：**我认为不可能同时使用同一个类作为服务和控制器。我建议[将控制器定义为服务](http://symfony.com/doc/current/cookbook/controller/service.html)。最后，您会将第二个服务注入您的第一个服务，并将您的第一个服务注入您的控制器服务（总共三个服务）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-21T19:43:20.823

**自 2017 年和 Symfony 3.3 以来，**这变得非常简单。

### 1\. 使用自动装配注册服务

```
# app/config/services.yml
services:
    _defaults:
        autowire: true

    EndorseMe\EndorsementBundle\:
        resource: ../../src/EndorseMe/EndorsementBundle 
```

### 2.通过构造函数注入要求任何其他服务中的任何服务

```
<?php

namespace EndorseMe\EndorsementBundle;

class MyService
{
    /**
     * @var AnotherService 
     */
    private $anotherService;

    public function __construct(AnotherService $anotherService)
    {
        $this->anotherService = $anotherService;
    }

    public function someMethod()
    {
        $this->anotherService->someAnotherMethod();
    }
} 
```

就这样！

* * *

**要在之前/之后获得更多 Symfony 3.3 依赖注入新闻示例，[只需查看这篇文章](https://www.tomasvotruba.cz/blog/2017/05/07/how-to-refactor-to-new-dependency-injection-features-in-symfony-3-3/)。**

# gdb - GDB：在非源文件上设置断点

> ID：13131702
> 
> 赞同：0
> 
> 时间：2012-10-30T00:42:09.900
> 
> 标签：gdb

如果我将 GDB 附加到 httpd 进程并想在 htdocs 文件夹中的文件上设置断点，即在 example.php 的第 3 行调用“echo”时，我将如何执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T11:51:24.613

您不能使用 GDB 调试 PHP 程序 ( `example.php`)。请参阅[PHP Debugging with Breakpoints - 案例研究、示例..？](https://stackoverflow.com/questions/3717136/php-debugging-with-breakpoints-case-studies-examples)关于如何使用`xdebug2`模块设置 PHP 远程调试。

`echo`提示：在行前插入 xdebug_break()`example.php`是设置断点的简单方法。

请使用 php 而不是 gdb 标记 PHP 开发问题。

# backbone.js - Backbone.js 事件在错误的实例上触发

> ID：13131703
> 
> 赞同：0
> 
> 时间：2012-10-30T00:42:20.710
> 
> 标签：backbone.js

我在重新设计应用程序的主要功能时第一次使用主干。目标是使用相同的主干集合/视图代码来管理同一页面上的多个不同列表 - 功能都相同，只是数据发生了变化。

到目前为止，我已经取得了成功，但发现了一个我无法弄清楚的问题。当您从表单输入添加新项目时，视图会处理它并调用集合的 add 函数，该函数使用 ajax 保存它。完成后，集合调用一个“additem”事件，该事件应该触发视图重新呈现。

但是，发生的情况是仅调用最近加载的视图中的事件。即使我完全更改了事件名称，所以它们是前缀并且对于每个视图必须是唯一的 - 这让我感到困惑。

删除了很多代码，但有问题的部分如下。在这个代码示例中，我试图为我们需要的每种列表类型添加事件的前缀，但不管它在错误的视图上调用事件是什么。

```
// A collection is made to manage the data - saves to the server, loads, updates, etc
var ListItems = Backbone.Collection.extend({
    initialize: function(models, options) {
        this.url = options.url;
        this.options = options;
    },
    /**
     * We'll use a custom addItem handler so that we're not triggering
     * events or ajax requests on .add(), since .fetch() uses it
     */
    addItem: function(obj,ajax_elem){
        self_col = this;
        $.ajax({
            type: 'POST',
            url: this.options.add_url,
            data: obj,
            success: function(resp){
                if(resp.success === true){
                    console.log('collection calls ep ' + self_col.options.ep+':addItem');
                    Backbone.Collection.prototype.add.call(self_col, {text:obj.text,id:resp.id} );
                    self_col.trigger(self_col.options.ep+':addItem');
                } else {
                    self_col.trigger(self_col.options.ep+':error', resp.errors);
                }
                // ... rest of stuff

// View manages rendering the items to the page, etc
ListView = Backbone.View.extend({
    initialize: function(){
        self = this;
        this.ep = self.$el.attr('id');
        this.collection.bind(this.ep+":addItem",function(){
            console.log('view thinks ep is: ' + self.ep+":addItem");
            console.log(self.$el);
            self.render();
            $(window).trigger('Snowy:ajax:stop', self.$el.find(':submit'));
        });

// Load the category list
categoryList = new ListView({
    collection: new ListItems( INIT_CATEGORIES, {
        ep: 'categories',
        // other opts
    }),
    el: $("#categories")
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:37:53.777

问题是，您正在使用全局变量。为了使这个`self = this`技巧起作用，您必须将它们设置为分配它们的函数的局部变量，以便在当前上下文中创建的任何闭包中捕获变量。

代替

```
self = this; 
```

做

```
var self = this; 
```

与`self_col`

# objective-c - 如何在 obj-c/ios 中使用单例

> ID：13131705
> 
> 赞同：-3
> 
> 时间：2012-10-30T00:42:34.133
> 
> 标签：objective-c, ios, singleton

我在我的 appDelegate 中创建了一个单例（称为 sharedinstance），理想情况下我想从我的代码中的所有其他对象/实例中访问它，但是每次我想访问其中的方法/变量时，我都必须这样做

```
Game *sharedInstance = [Game sharedInstance]; 
```

在任何其他情况下以任何方法能够做类似的事情..

```
[sharedInstance.myMethod] 
```

我试着把

```
Game *sharedInstance; 
```

在另一个实例的 .h 文件中，但是当我运行代码时，Game = 0。我只是尝试将

```
Game *sharedInstance = [Game sharedInstance]; 
```

在其他情况下，init 方法也无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:47:08.783

您的问题与单例并没有真正的关系，只是不知道如何声明和使用变量和方法。您需要获取 Game 的实例来调用它的方法，您可以使用 [Game sharedInstance] 执行此操作。然后，您需要调用它的方法，或者将其分配给实例变量以便稍后调用方法。

即：

```
[[Game sharedInstance] method] 
```

或者

```
(in the .h)
Game *sharedInstance

(in the init method in your .m)
sharedInstance = [Game sharedInstance];

(elsewhere in your .m)
[sharedInstance method]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T06:51:32.180

在你的 .m 文件的 Init 方法中使用这个

```
[[Game sharedInstance] method]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:56:23.623

> ...每次我想访问其中的方法/变量时，我都必须这样做...

是的。在你使用一个对象之前，不管它是不是像单例这样的共享对象，你都必须得到一个对它的引用。调用你的单例`-sharedInstance`方法是一种方法。另一种选择是声明一个指向单例的全局变量，但考虑到单例经常被用作全局变量的花哨替代品，这似乎是一个糟糕的主意。

# c# - 基于 QT 和 MONO 的 ARM Linux 上的 C# Windows 窗体程序

> ID：13131709
> 
> 赞同：1
> 
> 时间：2012-10-30T00:43:11.130
> 
> 标签：c#, winforms, mono, embedded-linux

命令链接程序正常。

当我运行 Windows 窗体程序时，错误消息显示：

```
Unhandled Exception: System.TypeInitializationException: An exception was thrown by the type initializer for System.Windows.Forms.XplatUI ---> System.DllNotFoundException: libX11.so
at (wrapper managed-to-native) System.Windows.Forms.XplatUIX11:XInitThreads ()
at System.Windows.Forms.XplatUIX11..ctor () [0x00000] in <filename unknown>:0
at System.Windows.Forms.XplatUIX11.GetInstance () [0x00000] in <filename unknown>:0
at System.Windows.Forms.XplatUI..cctor () [0x00000] in <filename unknown>:0
--- End of inner exception stack trace ---
at System.Windows.Forms.Application.EnableVisualStyles () [0x00000] in <filename unknown>:0
at WindowsFormsApplication1.Program.Main () [0x00000] in <filename unknown>:0 
```

而我的arm Linux的GUI是基于QT的。

我该怎么办？

构建 X11 库还是构建 GTK#？

我的想法现在还不清楚。你能给我一些指南和参考资料吗？

谢谢。

# git - 使用克隆重置 GIT 开发

> ID：13131712
> 
> 赞同：0
> 
> 时间：2012-10-30T00:43:34.627
> 
> 标签：git, git-reset

我目前的设置是我有一个 Prime 存储库（工作目录）、Hub 存储库（裸露的、开发人员推送和拉取）、克隆（用于开发人员）。Prime 和 Hub 存储库通过各种挂钩保持同步。

有一个问题，我想`reset`对 Prime 上的先前提交执行一个错误：`To prevent you from losing history, non-fast-forward updates were rejected`.

这是有道理的，但如果需要，我希望能够在 Prime 上执行重置。

我想知道`reset`在这种情况下处理先前提交的最佳方法是什么。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:57:08.667

你需要用力将你的钩子从你的主要位置推到轮毂和其他地方。只要其他人只是您的 Prime 的一面镜子，并且除非您专门从其他人那里拉入 Prime 或其他人可以推动它，否则变化不会以相反的方式传播，这很好。

# html - 滚动条从 使用 标签时

> ID：13131715
> 
> 赞同：0
> 
> 时间：2012-10-30T00:44:03.923
> 
> 标签：html, css, scrollbar, line-breaks

这似乎真的很奇怪，我无法弄清楚为什么会这样。

这是我在 CSS 中的代码：

```
<div style="width:580px; height:400px; overflow-x:hidden; overflow-y:scroll;">
 My content
</div> 
```

我使用 a`div`创建给定尺寸的空间并添加我的内容。

一切正常，直到我用标签强制换行`br`，然后滚动条消失，并且该区域之外的任何内容`div`都丢失（*或无法访问*）。

任何评论为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T00:55:04.310

这很奇怪。首先，如果您可以更具体地了解问题发生的位置（浏览器、版本等），将会有所帮助。

`overflow-x`并且`overflow-y`是可能不完全支持的 CSS 3 属性。有关详细信息，请参阅[此](http://www.w3schools.com/cssref/css3_pr_overflow-x.asp)。

我可以从经验告诉你的是，上述属性的行为不一致。因此，我建议您使用`overflow:scroll`旧模式支持的 ，并确保该 div 内的任何内容都适合相应的宽度。

第二个建议是停止使用`<br />`标签，这总是一个主要的痛苦。而是使用类似的东西：

```
<div class="linebreak" style="width:100%;height:1em"></div> 
```

或者

```
<div style="clear:both;"></div> 
```

# c - 成功初始输入到 C 中的替换程序后，无法输入第二个输入

> ID：13131722
> 
> 赞同：0
> 
> 时间：2012-10-30T00:44:52.987
> 
> 标签：c, arrays, string

我正在编写一个程序来生成一串随机大写字母，然后获取用户输入的大写字母以及用户的字符。对于随机字符串中用户输入字母的任何实例，它会将该字母替换为用户输入的字符。

例如，`s1 = {BDHFKYL}` `s2 = {YEIGH}` `c = '*'`

`Output = BD*FK*L`

该程序基于一个循环，并询问您是否要输入另一个字符串来替换。当我输入 a`'y'`进入另一个循环时，我得到了这个：

```
Please enter at least 2 capital letters and a maximum of 20.

HAJSKSMDHSJ

HAJSKSMDHSJ

NWLRBB*QB*C**RZOW**Y*I**Q*C*XR**OWFRX**Y

Would you like to enter another string?

y          -(HERE"S WHERE THE PROBLEM IS)-

Please enter at least 2 capital letters and a maximum of 20.

You need at least two letters

Would you like to enter another string? 
```

有什么建议么？先感谢您。

```
void fillS1(char x[]);

void fillS2(char x[], char y[], char z);

void strFilter(char a[], char b[], char c);

int main(int argc, const char * argv[])
{
    char s1[42];
    char s2[22];

    fillS2(s2, s1, '*');

    return 0;
}

void fillS1(char x[])
{
    for (int i = 0; i < 40; i++)
        x[i] = 'A' + random() % 26;
    x[40] = (char)0;
}

void fillS2(char x[], char y[], char z){
    char loopContinue = 0;

    do {

        int i = 0;

        printf("Please enter at least 2 capital letters and a maximum of 20.\n");
        while (( x[i] = getchar()) != '\n' ) {
            i++;
        }

        x[i] = '\0';

        if (i < 3) {
            printf("You need at least two letters\n");
        }
        else if (i > 21){
            printf("You cannot have more than twenty letters\n");
        }
        else if (i > 0){
            for (i = 0; i < 20; i++) {
                if ((x[i] >= 'A') && (x[i] <= 'Z')) {
                    puts(x);

                    fillS1(y);

                    strFilter(y, x, '*');
                    break;
                }
            }
        }

        printf("Would you like to enter another string?\n");
        scanf("%c", &loopContinue);

    } while (loopContinue != 'n');

}

void strFilter(char a[], char b[], char c){
    int i = 0;
    int n = 0;

    while (n < 20) {
        for (i = 0; i < 40; i++) {
            if (a[i] == b[n]){
                a[i] = c;
            }
        }
        i = 0;
        n++;
    }

    puts(a);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T01:02:00.137

混合`scanf`，`getchar`对我来说似乎是个坏主意。为什么不也用它`getchar`来确定用户是否表示他们想继续呢？（并且不要忘记处理大小写。）

您可能想阅读文章[Get scanf to quit when it reads a newline?](https://stackoverflow.com/questions/3723044/get-scanf-to-quit-when-it-reads-a-newline)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T01:10:34.233

当您使用：

```
 scanf("%c", &loopContinue); 
```

它只是读取字母，而不是用户在它之后键入的换行符。当您回到循环顶部时，第一个`getchar()`读取仍在等待处理的换行符。

当您收到此问题的回复时，您需要阅读整行，而不仅仅是单个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T03:25:52.197

尝试使用 memset() 清除 x、y 和 z

# facebook - 获取用户在 facebook 上喜欢的所有 youtube 视频

> ID：13131726
> 
> 赞同：5
> 
> 时间：2012-10-30T00:45:43.360
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph, facebook-fql

我需要通过 facebook API 获取（对于特定的登录用户）她在 facebook 上喜欢的所有 youtube 视频（指向 youtube 页面的链接），这意味着她喜欢的所有帖子都包含指向 youtube 视频的链接。

我知道我可以使用 url_like 表在 FQL 中做到这一点，但我还希望能够访问用户**何时**喜欢该链接（或至少在发布链接时），并且通常可以访问该链接喜欢上的视频。

作为参考，这是该表的 FQL 文档（不符合目的）： [https ://developers.facebook.com/docs/reference/fql/url_like/](https://developers.facebook.com/docs/reference/fql/url_like/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-28T20:10:16.350

调用非常复杂，我不确定从哪里开始修复性能，可能是一些批处理调用，保存数据以进行后期处理......但使用纯 FQL 的实际调用本身需要很长时间或窒息大查询。

```
SELECT link_id, owner, created_time, title, summary, url, picture, image_urls 
FROM link 
WHERE url in 
    (SELECT url, user_id 
     FROM url_like 
     WHERE user_id=me()
     AND strpos(url, 'http://www.youtube.com/watch?v=') >= 0)
AND owner in (select uid2 from friend where uid1 = me() LIMIT 20) 
```

请注意，我限制了 20 个朋友。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T09:21:41.217

你可以不使用：

{userId}/likes?fields=created_time。

例如，如果我使用“https://graph.facebook.com/me/likes?fields=created_time”，它会给我我的喜欢和喜欢它们的时间。

希望这可以帮助。

# r - R中每天的观察次数

> ID：13131732
> 
> 赞同：7
> 
> 时间：2012-10-30T00:46:37.100
> 
> 标签：r

我正在使用如下所示的数据框：

```
date<-c("2012-02-01", "2012-02-01", "2012-02-03", "2012-02-04", "2012-02-04", "2012-02-05", "2012-02-09", "2012-02-12", "2012-02-12")
var<-c("a","b","c","d","e","f","g","h","i")
df1<-data.frame(date,var) 
```

我想创建第二个数据框，将我每天的观察次数制成表格。在该数据框中，未提及的日期将为零……结果如下：

```
date<-c("2012-02-01","2012-02-02","2012-02-03","2012-02-04","2012-02-05","2012-02-06","2012-02-07","2012-02-08","2012-02-09","2012-02-10","2012-02-11","2012-02-12")
num<-c(2,0,1,2,1,0,0,0,1,0,0,2)
df2<-data.frame(date,num) 
```

我已经用聚合函数尝试了很多东西，但不知道如何在没有观察到的情况下包含日期（零）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T00:55:55.293

这里使用的方法`data.table`

```
library(data.table)
DF1 <- as.data.table(df1)
# coerce date to a date object
DF1[, date := as.IDate(as.character(date), format = '%Y-%m-%d')]
# setkey for joining
setkey(DF1, date)

# create a data.table that matches with a data.table containing
# a sequence from the minimum date to the maximum date
# nomatch = NA includes those non-matching. 
# .N is the number of rows in the subset data.frame
# this is 0 when there are no matches 
DF2 <- DF1[J(DF1[,seq(min(date), max(date), by = 1)]), .N, nomatch = NA]
DF2

          date N
 1: 2012-02-01 2
 2: 2012-02-02 0
 3: 2012-02-03 1
 4: 2012-02-04 2
 5: 2012-02-05 1
 6: 2012-02-06 0
 7: 2012-02-07 0
 8: 2012-02-08 0
 9: 2012-02-09 1
10: 2012-02-10 0
11: 2012-02-11 0
12: 2012-02-12 2 
```

* * *

一种使用方法`reshape2::dcast`

如果您确保您的`date`列具有您希望制表的每一天的级别

```
df1$date <- with(df1, factor(date, levels = as.character(seq(min(as.Date(as.character(date))), max(as.Date(as.character(date))), by = 1 ))))

df2 <- dcast(df1, date~., drop = FALSE) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T00:59:17.927

我最近处理了这样的事情。我会创建一个包含您要考虑的所有日期的数据框，并使用该`merge()`函数来执行您的建议。

```
df1$date <- as.Date(df1$date, format = "%Y-%m-%d")
newdates <- data.frame(date=seq(as.Date('2012-02-01'),as.Date('2012-02-12'),1))
df2 <- merge(df1, newdates, by = "date", all = TRUE) 
```

这里`all = TRUE`至关重要，它引入了`NA`s where`df1`和`df2`不匹配而不是删除这些实例。

然后使用`plyr`包获取计数：

```
library(plyr)
ddply(df2, "date", function(x) sum(!is.na(x$var))) 
```

这`df2`按 的唯一值分成组`df2$date`，然后找出有多少`df2$var`个 不是`NA`，然后返回该数字及其所代表的唯一值`df2$date`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-29T15:46:54.170

将您的索引转换为 Postxct 格式，然后：

`counts <- data.frame(table(as.Date(index(my_data_frame))))`

# php - 将字符串变量转换为 CSS 或 JavaScript

> ID：13131735
> 
> 赞同：0
> 
> 时间：2012-10-30T00:46:53.500
> 
> 标签：php, javascript, css, repeat

在下面的这段代码中，我怎样才能`\"'.($img).'\"`重复？通过删除图像标签并使用 JavaScript 或 CSS？

```
<img src=\"'.($img).'\" alt=\"\" /> 
```

这是整个代码：

```
function add_logo_css() {
    $img = get_option('add_logo_logo');
    if(!empty($img))
        echo '<style type="text/css">
                #admin-logo 
               { 
                     margin: 10px 0;
                     padding: 0 0 5px; 
                     border-bottom: 1px solid #ddd;  
                     position:absolute; 
                     margin-left: 165px; 
                     width:100%; 
              }
               </style>'."\n";
}

function add_logo_script() {
    $img = get_option('add_logo_logo');
    if(!empty($img))
        echo '<script type="text/javascript">
                  /* <![CDATA[ */
                 (function($) {
                    $("#wpwrap").prepend("<div id=\"admin-logo\">
                    <img src=\"'.($img).'\" alt=\"\" /></div>");
                    })(jQuery);
                  /* ]]> */
                </script>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T01:00:18.507

如果要获取图像标签的 src 属性字符串，可以通过 JS 完成，如下所示：

```
document.getElementById("myImage").src 
```

当然，您需要在页面加载后执行此操作，因为您使用 php 变量来填充图像源，因此：

```
function getSrc() {
    var x = document.getElementById("myImage").src
} 
```

然后在 body 标记中调用 getSrc onload 或在 javascript 中使用 window.load。

就你所说的重复而言，你可以用 JS 做许多不同的“重复”事情。例如，要写入实际的源字符串 10 次：

```
for(int i=0; i<10; i++)
{    
    document.write(x);
} 
```

# git - gitignore 不会忽略特定的 bin 文件夹

> ID：13131739
> 
> 赞同：7
> 
> 时间：2012-10-30T00:48:03.080
> 
> 标签：git, github, gitignore

我有这个目录结构（为说明目的而简化）：

```
parent
--directory1
----bin
--directory2
----bin
-directory3
----bin

... and so on 
```

我希望 Git 忽略所有“bin”目录，除了其中一个（directory2/bin）。我试过这个，但它似乎不起作用：

```
[Bb]in
!directory2/[Bb]in 
```

这也不起作用

```
[Bb]in
!parent/directory2/[Bb]in 
```

我也试过这个，但它不起作用：

```
[Bb]in
!parent/directory2/[Bb]in/* 
```

有谁知道我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T18:45:57.463

我使用 git 根据您问题中的信息创建了一个本地存储库。但是，一旦我这样做了，您所描述的问题就不存在了，我也无法轻易找到引入问题的方法。

它适用`.gitignore`于`parent`：

```
[Bb]in
!directory2/[Bb]in 
```

它也在`.gitignore`根目录中使用它：

```
[Bb]in
!parent/directory2/[Bb]in 
```

似乎问题不在于您在问题中给出的结构，但我不知道它会在哪里或从哪里开始寻找......

# erlide - 外部库的构建路径 erlide

> ID：13131742
> 
> 赞同：2
> 
> 时间：2012-10-30T00:48:27.777
> 
> 标签：erlide

我正在使用 couchbeam 开发一个 erlang 应用程序。我是 erlang 的新手，在 erlide 工作对我来说会更容易。

我在java中使用过eclipse，添加外部库很容易。我试图找出如何在 erlide 中为那些外部库构建路径，但我没有找到任何解决方案。当我查看提出的问题时，我发现 [Erlang: add libraries to application](https://stackoverflow.com/questions/6315279/erlang-add-libraries-to-application)应该与我的问题类似，但我不明白它是如何完成的，因为它与我们在添加外部 jar 文件时所做的不同，例如！

如果没有解决方案，我会问是否有人可以帮助我解决 Emacs 中的相同问题

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:46:09.923

我强烈推荐使用 basho 的[rebar](https://github.com/basho/rebar)来编译 Erlang 项目，它就像Java 的**ant**或**maven**，或多或少是 Erlang 世界的行业标准。它允许轻松管理各种依赖项和编译/发布项目。

另外，我建议您查看[SublimErl](https://github.com/ostinelli/SublimErl)作为 Erlide 的替代品。更加轻便舒适。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:12:47.287

Erlide 目前没有简单的方法来配置使用外部库的项目。我们正在为此制定解决方案。与此同时，这里有一些方法可以让它在今天发挥作用：

*   为 couchdb 创建一个项目并从您的项目中引用它；如果你禁用了项目的 erlang builder，erlide 将不会尝试构建 couch
*   在您的项目中创建指向 couchdb 的链接文件夹，以便它们看起来像是您项目的一部分；可以选择只链接include目录，然后erlide不会尝试编译couch，但是不能导航couch代码（erlide不可用）

对于构建您的项目，最好有一种在 Eclipse 之外执行此操作的方法（无论是 emake、rebar 还是 make）。我们还在研究一种使用 erlide 的这些工具的方法。

如果您需要进一步的帮助，请告诉我。

# r - 如何直接输入数据以制作表示列联表的data.frame？

> ID：13131743
> 
> 赞同：2
> 
> 时间：2012-10-30T00:48:46.020
> 
> 标签：r, contingency

我正在尝试将以下数据直接输入到**R**中（代表列联表）

```
Area        School    Coffeshop    Hospitals    Parks    Totatl  
Washington     142          120           20       20       302   
Seattle        120          140           30       40       330 
Total          262          260           50       60       632 
```

我的代码是这样的：

```
n<-c("Area","School","Cofeeshop","Hospitals","Parks","Total") 
x<-c("Washington",142,120,20,20,302)
y<-c("Seattle",120,140,30,40,330)
z<-c("Total",262,260,50,60,631)
data<-cbind(n,x,y,z)
data<-data.frame(data) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T02:35:02.763

您的代码充满了基本的语法错误，请尝试直接从您正在使用的脚本中复制和粘贴。（我真的希望你没有在这里这样做）。

如果您将字符和数值变量组合在同一个向量中，它将创建一个字符向量，这不是您想要的。

尝试类似的东西

```
vec_names <-c("School", "Cofeeshop", "Hospitals", "Parks", "Total") 
Washington <- c(142, 120, 20, 20, 302)
Seattle<-c(120, 140, 30, 40, 330)
Total <-  c(262, 260, 50, 60, 631)

ctable <- rbind(Washington, Seattle, Total)
colnames(ctable) <- vec_names

# ctable is a matrix at the moment, with the rownames identifying 
# Washington etc

ctable_df <- data.frame(ctable)

# ctable_df is now a data.frame.
# if you want area as a column in your data.frame (not just row.names)
CTABLE <- data.frame(area= rownames(ctable_df), ctable_df, row.names = NULL)
CTABLE
        area School Cofeeshop Hospitals Parks Total
1 Washington    142       120        20    20   302
2    Seattle    120       140        30    40   330
3      Total    262       260        50    60   631 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-13T01:58:15.923

使用 tidyverse 中的 tribble（有关详细信息，请参阅[tidyverse tibble](https://tibble.tidyverse.org/)）

```
install.packages("tidyverse")
library(tidyverse)
ctable <-
tribble(
  ~Area, ~School, ~Coffeeshop, ~Hospitals, ~Parks, ~Total,
  "Washington", 142, 120, 20, 20, 302,
  "Seattle", 120, 140, 30, 40, 330,
  "Total", 262, 260, 50, 60, 631
)
ctable
# A tibble: 3 x 6
  Area       School Coffeeshop Hospitals Parks Total
  <chr>       <dbl>      <dbl>     <dbl> <dbl> <dbl>
1 Washington    142        120        20    20   302
2 Seattle       120        140        30    40   330
3 Total         262        260        50    60   631 
```

# html - 使用 HTML/CSS 列创建 2 个独特的 3 列布局

> ID：13131744
> 
> 赞同：1
> 
> 时间：2012-10-30T00:48:58.797
> 
> 标签：html, css, footer, multiple-columns

编写网页时遇到了结合 HTML 和 CSS 的问题。我想在页脚中创建相同的现有 3 列布局。当我将 HTML/CSS 复制/粘贴并重命名到页脚时，代码不能用作列。如何将第二个 3 列布局添加到页脚，其功能与我的第一个 3 列布局相同？

这是html/CSS的问题

```
<div id="columns">

<div class="left column">
    <p>left column</p>
</div>

<div class="middle column">
    <p>middle column.</p>
</div>    

<div class="right column">
   <p>right column.</p>
</div>
</div>

<div class="footer">
  <!-- 3 column layout would be placed inside the footer --> 
```

```
 #columns {
width: 960px;
padding-top: 50px;
margin-bottom: 0px;
}

#columns .column {
    position: relative;
    width: 300px;
    padding: 1%;
    border: solid 1px #000;
}

#columns .left {
    float: left;
}

#columns .middle {
    float: left;
}
#columns .right {
    float: right;
    #container #col1 {
    width: 320px;
    float: left;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T01:02:02.690

我将所有内容都浮动起来，并确保页脚和列有足够的宽度以彼此相邻，并且它似乎可以满足您的要求：

```
#columns {
padding-top: 50px;
margin-bottom: 0px;
width:1200px;
}
.column {
position: relative;
width: 300px;
padding: 1%;
border: solid 1px #000;
}
.column{float:left;}
.footer{width:1200px;} 
```

​</p>

[http://jsfiddle.net/trG5B/](http://jsfiddle.net/trG5B/)

# c++ - _ttoi win c++ 断言失败

> ID：13131754
> 
> 赞同：1
> 
> 时间：2012-10-30T00:50:39.917
> 
> 标签：c++, c, winapi

我有这个代码：

```
BOOLEAN   Recurse = FALSE;
DWORD     NumPasses = 1;

int _tmain( int argc, TCHAR *argv[] ) 
{

    BOOL        foundFileArg = FALSE;
    int         i;

   if( argc < 2 ) {

        return Usage( argv[0] );
    }

    for( i = 1; i < argc; i++ ) {

        if( !_tcsicmp( argv[i], TEXT("/s") ) ||
            !_tcsicmp( argv[i], TEXT("-s") )) {

            Recurse = TRUE;

    } else if( !_tcsicmp( argv[i], TEXT("/p") ) ||
                   !_tcsicmp( argv[i], TEXT("-p") )) {

                   // assertion failure 
            NumPasses = argc > i ? _ttoi( argv[i+1] ) : 1;
            if( !NumPasses ) return Usage( argv[0] );
            i++;

        } else {

            if( foundFileArg ) return Usage( argv[0] );
            foundFileArg = TRUE;
        }
    }

    return 0;

} 
```

我得到断言失败，请提出问题可能出在哪里以及在哪里寻找。我在失败时使用的_ttoi函数是否有问题，如果我必须分配一个缓冲区，我该如何解决

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:27:10.860

这条线

```
NumPasses = argc > i ? _ttoi( argv[i+1] ) : 1; 
```

应该

```
NumPasses = argc > 1+i ? _ttoi( argv[i+1] ) : 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:21:19.427

尼克是对的；不要忘记在 C/C++ 中数组从零开始。如果有 5 个元素，则意味着 argv[0] 到 argv[4] 是有效的 - 不是 argv[5]。

# python - 使用 argparse 添加参数

> ID：13131756
> 
> 赞同：0
> 
> 时间：2012-10-30T00:50:55.937
> 
> 标签：python, argparse

我对 argparse 有这个小问题：

```
#!/usr/bin/python2.6
#test.py
import argparse

parser = argparse.ArgumentParser(description="test")
parser.add_argument('c', nargs='*')
parser.add_argument('cj', nargs='*')

results = vars(parser.parse_args())
print results 
```

现在在命令行中输入：“test.py c 1”

它返回这个

> {'cj': [], 'c': ['c', '1']}

但如果我输入“”test.py cj 1”

它返回这个：

> {'cj': [], 'c': ['cj', '1']}

我期待第二个示例在“cj”键中返回值，但它继续出现在“c”键中。

我究竟做错了什么 ？

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:08:38.110

您的问题是`*`将匹配它之后的所有内容。由于`c`参数有第一个`*`，因此传入的所有内容都将以`c`.

如果您想存储单个项目`cj`和单个项目，`c`您可以执行以下操作：

```
parser = argparse.ArgumentParser(description="test")
parser.add_argument('c', nargs='+')
parser.add_argument('cj', nargs='+') 
```

如果你想要的是：

```
{'cj': ['1'], 'c': ['cj']} 
```

这是因为`+`匹配单个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T01:08:55.007

至少有两个问题：

*   您使用位置参数（它们不以“-”或“--”开头），但您在命令行中提供它们的名称
*   您使用`nargs='*'`它会消耗所有可以使用的参数

# javascript - 在 Android 浏览器上清除伪元素

> ID：13131757
> 
> 赞同：1
> 
> 时间：2012-10-30T00:50:56.637
> 
> 标签：javascript, css, webkit, android-browser

我在触摸/单击时向 div 添加一个暗阴影（作为前元素），并在效果完成后将其删除。

第一次点击似乎很好，但在随后的点击中，效果变得越来越暗（直到它完全变黑）。

好像有多层之前的

到目前为止，我发现的唯一解决方案是将 div 的显示属性设置为“显示：块”，但这需要我进行一些布局返工。还有其他建议吗？

这是我用来设置突出显示的类

```
.myDivCls:before
{
background-repeat: no-repeat;
background-size: 100% 100%;
content: '';
position: absolute;
top: 0;
right: 0;
bottom: 0;
left: 0;
z-index: -1;
opacity: .3;
background-color: rgb(0,0,0);
} 
```

她是删除它的人：

```
.noEffectCls:before {
content: '';
background-color: transparent;
background-image: none;
position: static;
border-radius: 0;
background-size: auto auto;
background-repeat: repeat;
background-position: 0% 0%;
-webkit-background-size: auto auto;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T21:10:43.707

您是否尝试过在 .noEffectCls:before 元素上使用背景速记属性并将其设置为透明？

# join - 猪：超过2个关系的外部连接

> ID：13131759
> 
> 赞同：4
> 
> 时间：2012-10-30T00:51:22.343
> 
> 标签：join, apache-pig, bigdata

我想做一个涉及 3 个表的外部联接。我试过这个：

```
features = JOIN group_event by group left outer, group_session by group, group_order by group; 
```

我希望 group_event 的所有行都出现在输出中，即使其他 2 个关系中的一个或没有一个与之匹配。

上面的命令不起作用。显然因为它不应该工作（http://pig.apache.org/docs/r0.7.0/piglatin_ref2.html#JOIN+%28outer%29）

```
Outer joins will only work for two-way joins; to perform a multi-way outer join, you will need to perform multiple two-way outer join statements. 
```

拆分有效，可以像这样完成：

```
features1 = JOIN group_event by group left outer, group_session by group;
features2 = JOIN features1 by group_event::group left outer, group_order by group; 
```

在单个命令中执行此操作的任何想法？（如果要加入更多数量的表格会很有用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T16:09:33.197

我认为在某些时候，我们需要信任文档，不要尝试单个命令多个外部连接。

为什么？以下行应该如何工作？

```
JOIN a BY a1 LEFT OUTER, b BY b1, c BY c1 
```

两张桌子都`LEFT OUTER`有效，还是只适用于第一张桌子？如果是前者，那么应该在之间`LEFT OUTER`删除所有不匹配的记录吗？还是在？你越寻找它，它就越没有意义，不是吗？`b``c``b``a`

你想要做的是与into和 then的`JOIN`关系。如果您考虑一下，由于中间状态，在单个命令中执行它是不自然的。`a``b``ab``ab``c``ab`

# java - For循环将值输入到二维数组中

> ID：13131763
> 
> 赞同：-1
> 
> 时间：2012-10-30T00:52:27.757
> 
> 标签：java, java.util.scanner

```
Scanner input = new Scanner(System.in);

System.out.println("Enter matrix 1: ");
for(int row=0;row<3;row++){
    for(int col=0;col<3;col++){
        a[row][col]=input.nextDouble();
    }
} 
```

您好 - 鉴于上述将数据输入名为 2d 3*3 数组的解决方案`a`，我目前无法接受用户输入。intellij ide 不接受我在`input.nextDouble()`.

我想我错过了一些明显的东西，但是什么？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T00:59:42.300

下面的代码非常适合我

```
double a[][]=new double[3][3];
        Scanner input = new Scanner(System.in);

        for(int row=0;row<3;row++){

            for(int col=0;col<3;col++){
                System.out.println("Enter value: ");
                a[row][col]=input.nextDouble();
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T12:57:43.697

这是 JUNIT4 不接受控制台输入 - 这就是为什么将焦点更改为控制台不会产生任何结果。

# bash - 如何停止两个并发进程？

> ID：13131765
> 
> 赞同：0
> 
> 时间：2012-10-30T00:53:10.397
> 
> 标签：bash, shell, concurrency, process

在我的 Web 开发工作流程中，我有两个流程：

1.  监视我的文件夹以进行更改
2.  在浏览器中预览我的网站

我希望能够运行它们，然后同时停止它们。我见过每个人都建议使用 & 运算符：

```
process_1 & process_2 
```

但按下`Ctrl + C`只会停止第二个。我必须`kill`手动完成第一个。我在这种方法中缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T01:05:35.123

写两个脚本怎么样，一个包含

```
./process_1 &
./process_2 & 
```

和第二个包含

```
killall process_1
killall process_2 
```

通过运行第一个脚本启动两个进程，并通过运行第二个脚本结束它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T03:40:56.297

您可以让前台脚本显式终止子进程以响应 SIGINT：

```
#!/bin/sh
trap 'kill $pid1 $pid2' 2
cmd1 &
pid1=$!
cmd2 &
pid2=$!
wait 
```

此示例中有一个竞争条件：如果您在分配`SIGINT`之前发送给父级，则会发出警告消息并且两个子级都不会被终止。如果指定了 send before ，则只会向正在运行的进程发送信号。在任何一种情况下，父级都将继续运行，并且可以发送第二个。某些版本允许您通过使用 向进程组发送信号来避免这种竞争条件，但并非所有版本都支持这种用法。（请注意，如果任一子进程没有响应该信号而终止，则父进程不会退出而是继续等待。）`pid1``kill``SIGINT``pid2``cmd1``SIGINT``kill``kill -$$``kill`

# apache - Apache 超时指令不适用于亚马逊 ec2

> ID：13131766
> 
> 赞同：0
> 
> 时间：2012-10-30T00:53:11.207
> 
> 标签：apache, amazon-ec2, timeout

我正在使用 Amazon Elastic Beans Talk，它为我的 php 应用程序创建了一个 EC2 实例

该应用程序需要几分钟来处理一些工作，但发现 http 连接在 60 秒后关闭

虽然 php 脚本继续处理（最大时间限制设置为 0）但 http 连接被关闭所以我没有收到任何输出

例如谷歌浏览器说

```
Error 324 (net::ERR_EMPTY_RESPONSE): The server closed the connection without sending any data. 
```

我编辑了实例上的 /etc/httpd/conf/httpd.conf 文件并将超时从 60 更改为 300

然后重新启动实例，但连接仍然在 60 处关闭

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T14:55:54.460

知道问题

这不是 apached 问题，而是“弹性负载均衡器”，它在 60 秒没有数据传输后关闭 http 连接

是的，这很无聊，亚马逊不要听电话把这个设置得更高

[https://forums.aws.amazon.com/thread.jspa?messageID=396594ല](https://forums.aws.amazon.com/thread.jspa?messageID=396594&#396594)

# java - 以编程方式获取堆栈转储中Java监视器显示的地址？

> ID：13131772
> 
> 赞同：5
> 
> 时间：2012-10-30T00:54:15.357
> 
> 标签：java, debugging, concurrency, stack-trace, jvm-hotspot

如果您获得进程的堆栈转储，例如，通过 jstack，您将获得有关锁定监视器（和同步器）的信息，每个监视器都有一个地址。例如，来自一个简单死锁的双线程进程（使用 jstack）：

```
"Thread-0" prio=10 tid=0x00007f1444042000 nid=0x2818 waiting for monitor entry [0x00007f14433ca000]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at scrap.DeadlockTest$Deadlocker.run(DeadlockTest.java:49)
    - waiting to lock <0x00000007c14e6378> (a java.lang.Object)
    - locked <0x00000007c14e6368> (a java.lang.Object)
    at java.lang.Thread.run(Thread.java:619)

... (omitted some lines here)

Java stack information for the threads listed above:
===================================================
"Thread-1":
    at scrap.DeadlockTest$Deadlocker.run(DeadlockTest.java:49)
    - waiting to lock <0x00000007c14e6368> (a java.lang.Object)
    - locked <0x00000007c14e6378> (a java.lang.Object)
    at java.lang.Thread.run(Thread.java:619)
"Thread-0":
    at scrap.DeadlockTest$Deadlocker.run(DeadlockTest.java:49)
    - waiting to lock <0x00000007c14e6378> (a java.lang.Object)
    - locked <0x00000007c14e6368> (a java.lang.Object)
    at java.lang.Thread.run(Thread.java:619) 
```

有没有办法在运行时在 Java 代码中获得与上面显示的相同的地址，例如`0x00000007c14e6368`？

我已经尝试在监视器对应的对象以及`MonitorInfo`via上使用身份哈希码，但`ThreadMXBean`没有成功（这些值不对应，至少在 64 位 java 上）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T05:17:44.077

我想，没有简单的方法来获取监视器的地址。这是 jstack 是如何做到的

```
import com.sun.tools.attach.VirtualMachine;
import sun.tools.attach.HotSpotVirtualMachine;

import java.io.InputStream;
import java.lang.management.ManagementFactory;

public class Main {

    public static void main(String[] args) throws Exception {
        VirtualMachine vm = VirtualMachine.attach(getPid());

        HotSpotVirtualMachine hsvm = (HotSpotVirtualMachine) vm;
        InputStream in = hsvm.remoteDataDump("-l");

        byte b[] = new byte[256];
        int n;
        do {
            n = in.read(b);
            if (n > 0) {
                String s = new String(b, 0, n, "UTF-8");
                System.out.print(s);
            }
        } while (n > 0);
        in.close();
    }

    private static String getPid() {
        String name = ManagementFactory.getRuntimeMXBean().getName();
        int ind = name.indexOf('@');
        return name.substring(0, ind);
    }

} 
```

要运行此代码段，请不要忘记添加`$JDK_HOME/lib/tools.jar`到类路径。

这是它产生的输出 2012-10-31 08:48:08 Full thread dump Java HotSpot(TM) 64-Bit Server VM (20.5-b03 mixed mode)：

```
"Monitor Ctrl-Break" daemon prio=6 tid=0x0000000006b98000 nid=0x1d70 runnable [0x00000000074df000]
   java.lang.Thread.State: RUNNABLE
    at java.net.PlainSocketImpl.socketAccept(Native Method)
    at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:408)
    - locked <0x00000007d5d53148> (a java.net.SocksSocketImpl)
    at java.net.ServerSocket.implAccept(ServerSocket.java:462)
    at java.net.ServerSocket.accept(ServerSocket.java:430)
    at com.intellij.rt.execution.application.AppMain$1.run(AppMain.java:82)
    at java.lang.Thread.run(Thread.java:662)

   Locked ownable synchronizers:
    - None

... 
```

让我们仔细看看是`hsvm.remoteDataDump("-l")`什么

```
...

public InputStream remoteDataDump(Object ... args) throws IOException {
    return executeCommand("threaddump", args);
}

/*
 * Execute the given command in the target VM - specific platform
 * implementation must implement this.
 */
abstract InputStream execute(String cmd, Object ... args)
    throws AgentLoadException, IOException;

/*
 * Convenience method for simple commands 
 */
private InputStream executeCommand(String cmd, Object ... args) throws IOException {
    try {
        return execute(cmd, args);
    } catch (AgentLoadException x) {
        throw new InternalError("Should not get here");
    }
}
... 
```

这里是 windows 的 execute 方法的一个实现（你可以在 中找到它`sun.tools.attach.WindowsVirtualMachine`）

```
InputStream execute(String cmd, Object ... args) 
        throws AgentLoadException, IOException {

    assert args.length <= 3;        // includes null

    // create a pipe using a random name
    int r = (new Random()).nextInt();
    String pipename = "\\\\.\\pipe\\javatool" + r; 
    long hPipe = createPipe(pipename);

    // check if we are detached - in theory it's possible that detach is invoked 
    // after this check but before we enqueue the command.
    if (hProcess == -1) { 
        closePipe(hPipe);
        throw new IOException("Detached from target VM");
    }

    try {
        // enqueue the command to the process
        enqueue(hProcess, stub, cmd, pipename, args);

        // wait for command to complete - process will connect with the
        // completion status
        connectPipe(hPipe);

        // create an input stream for the pipe
        PipedInputStream is = new PipedInputStream(hPipe);

        // read completion status
        int status = readInt(is);
        if (status != 0) {
            // special case the load command so that the right exception is thrown
            if (cmd.equals("load")) {
                throw new AgentLoadException("Failed to load agent library");
            } else {
                throw new IOException("Command failed in target VM");
            }
         }      

        // return the input stream
        return is;

    } catch (IOException ioe) {
        closePipe(hPipe);
        throw ioe;
    }
} 

static native void init();

static native byte[] generateStub();

static native long openProcess(int pid) throws IOException;

static native void closeProcess(long hProcess) throws IOException;

static native long createPipe(String name) throws IOException;

static native void closePipe(long hPipe) throws IOException;

static native void connectPipe(long hPipe) throws IOException;    

static native int readPipe(long hPipe, byte buf[], int off, int buflen) throws IOException;

static native void enqueue(long hProcess, byte[] stub,
    String cmd, String pipename, Object ... args) throws IOException; 
```

所以基本上命名管道是打开的，一些命令在它上面执行，所有的魔法都在本机代码中`hotspot/src/share/vm/services/attachListener.cpp`

```
// Implementation of "threaddump" command - essentially a remote ctrl-break
//
static jint thread_dump(AttachOperation* op, outputStream* out) {
    bool print_concurrent_locks = false;
    if (op->arg(0) != NULL && strcmp(op->arg(0), "-l") == 0) {
        print_concurrent_locks = true;
    }

    // thread stacks
    VM_PrintThreads op1(out, print_concurrent_locks);
    VMThread::execute(&op1);

    // JNI global handles
    VM_PrintJNI op2(out);
    VMThread::execute(&op2);

    // Deadlock detection
    VM_FindDeadlocks op3(out);
    VMThread::execute(&op3);

    return JNI_OK;
} 
```

一般来说，如果您想提取您已获得监视器的对象的地址，您可以解析第一个片段的输出并提取必要的片段，例如，通过线程 id。

其他选项是在调试模式下附加到您的进程并使用调试器 api 或 JNI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T17:49:19.363

Perhaps you can log the object that requests a lock. Then you would know who has the lock at the time of the deadlock.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-30T05:15:57.563

所以，你的问题实际上是，有没有办法确定程序中哪两个对象死锁了？这个简单的例子实际上指出了一种检查死锁的方法。死锁最常见的原因之一是检索多个锁，但顺序不同。因此，请搜索它锁定的代码，以确保您始终以相同的顺序请求锁定。

顺便说一句，您需要多个锁来执行某些操作这一事实意味着您应该将设计更改为只需要一个锁来执行任何操作。

# c# - 如何让 `await ...` 与 `yield return` 一起工作（即在迭代器方法中）？

> ID：13131776
> 
> 赞同：20
> 
> 时间：2012-10-30T00:54:29.303
> 
> 标签：c#, ado.net, async-await, generator, yield-return

我现有的代码类似于：

```
IEnumerable<SomeClass> GetStuff()
{
    using (SqlConnection conn = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand(sql, conn)
    {
        conn.Open();
        SqlDataReader reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            SomeClass someClass = f(reader); // create instance based on returned row
            yield return someClass;
        }
    } 
} 
```

看来我可以通过使用`reader.ReadAsync()`. 但是，如果我只修改一行：

```
 while (await reader.ReadAsync()) 
```

编译器通知我`await`只能在标有 的方法中使用`async`，并建议我将方法签名修改为：

```
async Task<IEnumerable<SomeClass>> GetStuff() 
```

但是，这样做会导致`GetStuff()`无法使用，因为：

> *的主体`GetStuff()`不能是迭代器块，因为`Task<IEnumerable<SomeClass>>`它不是迭代器接口类型。*

我确定我错过了异步编程模型的一个关键概念。

**问题：**

*   我可以`ReadAsync()`在我的迭代器中使用吗？如何？
*   我如何才能以不同的方式思考异步范式，以便我了解它在这种情况下的工作原理？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-30T22:45:27.337

问题是你所问的实际上并没有多大意义。`IEnumerable<T>`是一个同步接口，返回`Task<IEnumerable<T>>`不会对你有太大帮助，因为无论如何，一些线程必须阻塞等待每个项目。

您真正想要返回的是一些异步替代方案`IEnumerable<T>`：例如`IObservable<T>`来自 TPL Dataflow 的数据流块或`IAsyncEnumerable<T>`计划添加到 C# 8.0/.Net Core 3.0 的数据流块。（与此同时，有[一些](http://asyncenum.codeplex.com/) [库](https://github.com/Dasync/AsyncEnumerable)包含它。）

使用 TPL 数据流，一种方法是：

```
ISourceBlock<SomeClass> GetStuff() {
    var block = new BufferBlock<SomeClass>();

    Task.Run(async () =>
    {
        using (SqlConnection conn = new SqlConnection(connectionString))
        using (SqlCommand cmd = new SqlCommand(sql, conn))
        {
            await conn.OpenAsync();
            SqlDataReader reader = await cmd.ExecuteReaderAsync();
            while (await reader.ReadAsync())
            {
                SomeClass someClass;
                // Create an instance of SomeClass based on row returned.
                block.Post(someClass);
            }
            block.Complete();
        } 
    });

    return block;
} 
```

您可能希望在上面的代码中添加错误处理，但除此之外，它应该可以工作并且它将是完全异步的。

然后，您的其余代码也将异步使用返回块中的项目，可能使用`ActionBlock`.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-31T00:17:34.190

不，您目前不能将 async 与迭代器块一起使用。正如 svick 所说，你需要类似的东西`IAsyncEnumerable`来做到这一点。

如果您有返回值`Task<IEnumerable<SomeClass>>`，则意味着该函数返回一个`Task`对象，一旦完成，将为您提供一个完整的 IEnumerable（此枚举中没有任务异步空间）。一旦任务对象完成，调用者应该能够同步遍历它在可枚举中返回的所有项目。

这是一个返回的解决方案`Task<IEnumerable<SomeClass>>`。通过执行以下操作，您可以获得异步的很大一部分好处：

```
async Task<IEnumerable<SomeClass>> GetStuff()
{
    using (SqlConnection conn = new SqlConnection(""))
    {
        using (SqlCommand cmd = new SqlCommand("", conn))
        {
            await conn.OpenAsync();
            SqlDataReader reader = await cmd.ExecuteReaderAsync();
            return ReadItems(reader).ToArray();
        }
    }
}

IEnumerable<SomeClass> ReadItems(SqlDataReader reader)
{
    while (reader.Read())
    {
        // Create an instance of SomeClass based on row returned.
        SomeClass someClass = null;
        yield return someClass;
    }
} 
```

...以及一个示例用法：

```
async void Caller()
{
    // Calls get-stuff, which returns immediately with a Task
    Task<IEnumerable<SomeClass>> itemsAsync = GetStuff();
    // Wait for the task to complete so we can get the items
    IEnumerable<SomeClass> items = await itemsAsync;
    // Iterate synchronously through the items which are all already present
    foreach (SomeClass item in items)
    {
        Console.WriteLine(item);
    }
} 
```

在这里，您将迭代器部分和异步部分放在不同的函数中，这允许您同时使用 async 和 yield 语法。该`GetStuff`函数异步获取数据，`ReadItems`然后将数据同步读取到可枚举中。

注意`ToArray()`通话。像这样的东西是必要的，因为枚举器函数延迟执行，因此您的异步函数可能会在读取所有数据之前处理连接和命令。这是因为`using`块覆盖了`Task`执行的持续时间，但是您将对其进行迭代`after`以完成任务。

此解决方案不*使用*，`ReadAsync`但*确实*使用`OpenAsync`and `ExecuteReaderAsync`，这可能会给您带来大部分好处。以我的经验，ExecuteReader 将花费最多的时间并且最大的好处是异步。当我读完第一行时，`SqlDataReader`已经有所有其他行并且`ReadAsync`只是同步返回。如果您也是这种情况，那么迁移到基于推送的系统（如`IObservable<T>`（这将需要对调用函数进行重大修改））不会获得显着的好处。

为了说明，请考虑解决同一问题的另一种方法：

```
IEnumerable<Task<SomeClass>> GetStuff()
{
    using (SqlConnection conn = new SqlConnection(""))
    {
        using (SqlCommand cmd = new SqlCommand("", conn))
        {
            conn.Open();
            SqlDataReader reader = cmd.ExecuteReader();
            while (true)
                yield return ReadItem(reader);
        }
    }
}

async Task<SomeClass> ReadItem(SqlDataReader reader)
{
    if (await reader.ReadAsync())
    {
        // Create an instance of SomeClass based on row returned.
        SomeClass someClass = null;
        return someClass;
    }
    else
        return null; // Mark end of sequence
} 
```

...以及一个示例用法：

```
async void Caller()
{
    // Synchronously get a list of Tasks
    IEnumerable<Task<SomeClass>> items = GetStuff();
    // Iterate through the Tasks
    foreach (Task<SomeClass> itemAsync in items)
    {
        // Wait for the task to complete. We need to wait for 
        // it to complete before we can know if it's the end of
        // the sequence
        SomeClass item = await itemAsync;
        // End of sequence?
        if (item == null) 
            break;
        Console.WriteLine(item);
    }
} 
```

在这种情况下，`GetStuff`立即返回一个可枚举项，其中可枚举项中的每个项目都是一个任务，`SomeClass`当它完成时将呈现一个对象。这种方法有一些缺陷。首先，可枚举是同步返回的，所以在它返回时我们实际上不知道结果中有多少行，这就是为什么我将它设为无限序列的原因。这是完全合法的，但它有一些副作用。我需要使用`null`表示无限任务序列中有用数据的结束。其次，你必须小心你如何迭代它。您需要向前迭代它，并且在迭代到下一行之前需要等待每一行。您还必须仅在所有任务完成后处理迭代器，以便 GC 在完成使用之前不会收集连接。由于这些原因，这不是一个安全的解决方案，我必须强调，我将其包括在内是为了帮助回答您的第二个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-13T14:20:38.117

在我的经验中，严格地说异步迭代器（或有可能），`SqlCommand`我注意到代码的同步版本大大优于它的`async`对应版本。在速度和内存消耗方面。

> 也许，对这个观察持保留态度，因为测试范围仅限于我的机器和本地 SQL Server 实例。

不要误会我的意思，.NET 环境中的[async/await](https://msdn.microsoft.com/library/hh191443(vs.110).aspx)范式在适当的情况下非常简单、强大和有用。然而，经过大量的努力，我不相信数据库访问是一个合适的用例。当然，除非您需要同时执行多个命令，在这种情况下，您可以简单地使用[TPL](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-based-asynchronous-programming)来同时触发命令。

我更喜欢的方法是考虑以下因素：

*   保持*SQL 工作*单元小、简单和可组合（即让您的 SQL 执行“便宜”）。
*   避免在可以向上游推送到应用程序级别的 SQL Server 上进行工作。一个完美的例子就是排序。
*   最重要的是，大规模测试您的 SQL 代码并查看 Statistics IO 输出/执行计划。以 10k 条记录快速运行的查询可能（并且可能会）在有 1M 条记录时表现完全不同。

您可以提出这样的论点，即在某些报告场景中，上述某些要求是不可能的。但是，在报告服务的上下文中，真的需要异步性（甚至是一个词吗？）？

微软布道者 Rick Anderson 有一篇关于这个主题的精彩[文章。](https://blogs.msdn.microsoft.com/rickandy/2009/11/14/should-my-database-calls-be-asynchronous/)请注意，它已经过时（从 2009 年开始），但仍然非常重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-14T15:27:36.163

从 C# 8 开始，这可以通过[IAsyncEnumerable来完成](https://docs.microsoft.com/en-us/archive/msdn-magazine/2019/november/csharp-iterating-with-async-enumerables-in-csharp-8)

修改后的代码：

```
async IAsyncEnumerable<SomeClass> GetStuff()
{
    using (SqlConnection conn = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand(sql, conn)
    {
        conn.Open();
        SqlDataReader reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            SomeClass someClass = f(reader); // create instance based on returned row
            yield return someClass;
        }
    } 
} 
```

像这样消费它：

```
await foreach (var stuff in GetStuff())
    ... 
```

# php - PHP日期验证英美格式

> ID：13131777
> 
> 赞同：0
> 
> 时间：2012-10-30T00:54:44.810
> 
> 标签：php, date, time

我遇到了许多基于日期的问题和解决方案，但没有什么是我习惯的。

我正在为美国市场工作，因此日期通常是 m/d/Y。然而，英语和其他英语国家也将使用它，他们可能想要输入 d/m/Y。

似乎 PHP Date 可以理解前者，但不能理解后者。如果我能保证使用 d/m/Y 而不是任何一个，那就很简单了。

有没有人遇到过可以检测日期类型并对处理进行必要更正的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T01:02:14.810

`strftime()`和其他日期时间函数取决于语言环境。用于`setlocale()`预定义您希望 php 使用的格式。例如：

```
setlocale(LC_TIME, 'en_UK'); 
```

# combobox - 组合框选择未重置到 javafx 2.2 中的下拉列表（项目）的顶部

> ID：13131781
> 
> 赞同：2
> 
> 时间：2012-10-30T00:55:36.667
> 
> 标签：combobox, javafx

我有一个 Source ComboBox 来填充源字段（25-30 项），如下所示

“一个”

“乙”

...

“Z”

我从 ComboBox 中选择了最后一项，如下所示

“Z”

保存后遍历到下一页时，我需要将源组合选择设为空白，因此我返回以下代码以将源组合框重置为指向第一项（将显示重置为从下拉列表顶部开始用户选择）

// 我在源列表中的第一个值是空格 - “”</p>

```
 sourceComboBox.setValue(""); 
```

即使您使用以下代码片段，例如

```
 sourceComboBox.getSelectionModel().selectFirst(); 
                    sourceComboBox.getItems().clear();
                    sourceComboBox.getSelectionModel().clearAndSelect(0); 
```

但是当我单击打开组合框下拉菜单时，它仍然从底部显示下拉菜单，如下所示

...

“X”

“是”

“Z”

我无法发布用于表示组合框值的图像，因此在上面的示例中进行了介绍。

这对我来说看起来像是一个图形错误，还是我做错了什么？我在下面的问题中看到了类似的问题，但到目前为止没有建议解决 [Combobox 清除值问题](https://stackoverflow.com/questions/12142518/combobox-clearing-value-issue)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-29T04:29:15.103

如果您想简单地“重置”组合框，我认为您所要做的就是将值设置为`null`，如下所示：

```
sourceComboBox.setValue(null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-22T16:43:21.863

Below is the code you're looking for. It will reset it to whatever index you give in within the parenthesis.

`sourceComboBox.setSelectedIndex(0);`

Goodluck

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T19:33:47.540

我遇到了几乎完全相同的情况，并在寻找解决方案时遇到了您的问题。幸运的是，我想出了一个强制组合框重置的解决方法。当您重置窗格上的数据时，而不是执行以下操作：

```
sourceComboBox.getSelectionModel().clearSelection();
sourceComboBox.getItems.clear(); 
```

做这样的事情......

```
parentNode.getChildren().remove(sourceComboBox);
sourceComboBox= new ComboBox();  // do whatever else you need to format your ComboBox
parentNode.add(sourceComboBox); 
```

您还需要在您的 ComboBox 上再次执行 setItems() 以便填充新的。这不是一个理想的解决方案，但它似乎可以正常工作，因为我期望提供的 clearSelection() 方法可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-29T01:13:17.203

当我尝试它们时，大多数事情都给了我一个错误。最适合我的是使用它

```
comboBox.getSelectionModel.clearSelection(); 
```

这实际上会将您的 ComboBox 的值设置为 null。因此，如果您在其他地方引用 ComboBox 的值，则使用此检查 ComboBox 的值是否为空变得很重要

```
if(comboBox.getValue() != null)
  //Code segment here 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-30T09:34:34.960

该`ComboBox`控件没有类似`scrollTo(index)`的方法`ListView`。所以似乎很难解决这种行为。您可以在 JavaFX Jira 发出功能请求。

# facebook - 如何取消在其他网站上的赞

> ID：13131786
> 
> 赞同：1
> 
> 时间：2012-10-30T00:55:56.307
> 
> 标签：facebook, api, facebook-like

当你点击`Like`按钮`https://graph.facebook.com/object_id/likes`调用。要取消我该`Like`怎么办？

我尝试了以下方法：

```
<code>
<script>
function doLike(objectId) {
    $.ajax({
       url: 'https://graph.facebook.com/'+objectId+'/likes',
       type: 'post',
       data: {
           access_token: '....'
       }
    });
}

function doCancel(objectId) {
    $.ajax({
       url: '???',
       type: 'post',
       data: {
           access_token: '....'
       }
    });
}
</script>

<input onclick="doLike('...')">Like</button>
<input onclick="doCancel('...')">Cancel</button>
</code> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T23:47:10.920

这让我发疯了。Firefox/Chrome 和其他一切显然都不允许 HTTP DELETE ajax 调用，除非主机先前在当前请求期间进行过通信。因此`$.ajax{(type: 'delete', ... )}`适用于您的服务器 url 主机，但不适用于其他任何东西。

解决方法类似于：

```
$.ajax({ 
  url: "https://graph.facebook.com/" + FB_ACTION_ID,
  type: 'post',
  data: { access_token: ACCESS_TOKEN,
          'method': 'delete',
          '_method' : 'delete' }
  }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:36:43.070

您应该能够简单地通过执行 HTTP DELETE 来“取消”对象 ID。使用您的代码，它看起来像这样：

```
function doCancel(objectId) {
    $.ajax({
       url: 'https://graph.facebook.com/'+objectId+'/likes',
       type: 'delete',
       data: {
           access_token: '....'
       }
    });
} 
```

或者，使用 Facebook Javascript SDK，您可以在其中简单地执行以下操作：

```
FB.api("/" + objectId + "/likes", 'delete', callback); 
```

其中回调是在不同操作完成时调用的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T02:52:54.530

如果您正在寻找允许您删除 Facebook 页面的赞的 API，这是不可能的。

如果您正在寻找一个 API 来删除对象的 Like（通过 URL） - 您可以发出 HTTP DELETE 请求，该请求是您发布[Open Graph like](https://developers.facebook.com/docs/opengraph/actions/builtin/likes/)`/LIKE_INSTANCE_ID`时返回给您的应用程序的 ID - 否则不可能

# c# - 非静态字段所需的对象引用

> ID：13131789
> 
> 赞同：0
> 
> 时间：2012-10-30T00:56:40.017
> 
> 标签：c#, object, ms-word, office-interop

我在这种情况下收到此错误消息：

```
int left = 0;
            int top = 0;
            int width = 0;
            int height = 0;
            Word.Range rng2 = rng;
            Microsoft.Office.Interop.Word.Window.GetPoint(out left, out top, out width, out height, rng); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:47:36.957

Window 是非静态的，您需要创建它的新实例才能使用它。

```
 //using Word = Microsoft.Office.Interop.Word;
                Word.Application application = this.Application;

                //Not sure how you create your application object, just including this incase you're not using VSTO
                //Word.Application application =
                //(Word.Application)System.Runtime.InteropServices.Marshal.GetActiveObject("Word.Application");
                //OR
                //Word.Application application = new Word.Application();

                Word.Range rng = application.ActiveDocument.Range();
                int left,top,width,height = 0;
                Word.Range rng2 = rng;
                application.ActiveWindow.GetPoint(out left, out top, out width, out height, rng); 
```

**或者**

```
Microsoft.Office.Interop.Word.Window window = application.ActiveWindow;
            window.GetPoint(out left, out top, out width, out height, rng); 
```

# ios - iOS项目中如何判断是否是新的一天？

> ID：13131790
> 
> 赞同：6
> 
> 时间：2012-10-30T00:56:46.607
> 
> 标签：ios, objective-c

我有一个 UIView ，我希望它在新的一天显示。例如，今天我启动了我的应用程序，并且 UIView 出现在我的视图中，但是在此之后，直到明天我才能看到那个 UIView。

所以我想知道如何判断是否是新的一天显示UIView？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-30T00:58:51.560

您需要注册才能`UIApplicationSignificantTimeChangeNotification`收到通知。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(timeChange) name:UIApplicationSignificantTimeChangeNotification object:nil]; 
```

然后在`timeChange`方法（或任何你称之为的方法）中更新你的视图。

不要忘记取消注册：

```
[[NSNotificationCenter defaultCenter] removeObserver:self name:UIApplicationSignificantTimeChangeNotification object:nil]; 
```

如果用户更改其设备上的时间或时区更改，则会在午夜发送此通知。如果您的应用在更改发生时处于后台，则在应用返回前台时会收到通知。

# php - 两个表之间的内部连接显示错误

> ID：13131792
> 
> 赞同：0
> 
> 时间：2012-10-30T00:56:47.837
> 
> 标签：php, mysql, sql

我在 mysql 中的内部连接语句有问题。我有两个表，一个是信息，另一个是学生。当学生表中 lname 的值和信息表中 lname 的值相同时，我想要什么，然后从信息中选择 fname。我得到错误...

```
$grad_stu1 = mysql_query("SELECT information.fname FROM information INNER JOIN student ON student.lpatel == information.lname;") or die($myQuery."<br/><br/>".mysql_error()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T00:57:54.590

使用单`=`进`MySQL`

```
SELECT   `information`.fname 
FROM     `information` 
         INNER JOIN student 
             ON student.lpatel = `information`.lname 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T01:00:10.063

`=`它不应该是`==`：

```
$grad_stu1 = mysql_query("SELECT information.fname FROM information 
                          INNER JOIN student ON 
                          student.lpatel = information.lname;") 
                          or die($myQuery."<br/><br/>".mysql_error()); 
```

# c# - 在按钮单击时显示气球提示

> ID：13131793
> 
> 赞同：2
> 
> 时间：2012-10-30T00:56:52.787
> 
> 标签：c#, tooltip

我想在发生错误时显示气球提示而不是显示 MessageBox。

[注意] 我不希望它显示在鼠标悬停上。

我都试过了，但它们实际上显示了鼠标悬停的提示

```
toolTip1.SetToolTip();
toolTip1.Show(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:09:27.110

您可以使用[ToolTip Popup 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.popup.aspx)来检查是否存在 Tooltip，如果没有则取消它。然后，您可以在验证期间设置工具提示，然后显示它。在此示例中，我设置了一个计时器以在 2 秒超时后重置工具提示文本。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        toolTip1.IsBalloon = true;
        toolTip1.Popup += new PopupEventHandler(toolTip1_Popup);
        toolTip1.SetToolTip(textBox1, "");
    }

    void toolTip1_Popup(object sender, PopupEventArgs e)
    {
        if (toolTip1.GetToolTip(e.AssociatedControl) == "")
            e.Cancel = true;

    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        timer1.Stop();
        toolTip1.RemoveAll();

    }

    private void textBox1_Validating(object sender, CancelEventArgs e)
    {
        int temp;
        if (!int.TryParse(textBox1.Text, out temp))
            showTip("Validation Error", (Control)sender);

    }

    private void showTip(string message, Control destination)
    {
        toolTip1.Show(message, destination);
        timer1.Start();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:57:59.820

令我惊讶的是，toolTip1.IsOpen = true 似乎会显示一个工具提示并允许它保持打开状态。请注意，您需要提供代码来关闭它，因为无论我做什么，它都不会在我的机器上自行消失。

# ruby-on-rails - Ruby On Rails libyaml

> ID：13131794
> 
> 赞同：4
> 
> 时间：2012-10-30T00:56:53.810
> 
> 标签：ruby-on-rails, ruby, rvm

我在 Linux 上运行 rails 版本 3.2.8 和 ruby​​ 版本 1.9.3-p286

```
user1@company.com [~/rails_apps/myapp]# rails -v
Rails 3.2.8
user1@company.com [~/rails_apps/myapp]# ruby -v
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]
user1@company.com [~/rails_apps/myapp]# 
```

我可以生成迁移，但无法运行它。我不断收到以下错误消息

```
user1@company.com [~/rails_apps/myapp]# rake db:migrate
/home3/user1/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/yaml.rb:56:in `<top (required)>':
It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby.
/home3/user1/ruby/gems/gems/json-1.7.5/lib/json/common.rb:67: [BUG] unknown type 0x22 (0xc given)
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]
<snip> 
```

然后是很多调试信息

```
[NOTE]
You may have encountered a bug in the Ruby interpreter or extension libraries.
Bug reports are welcome.
For details: http://www.ruby-lang.org/bugreport.html

Aborted
user1@company.com [~/rails_apps/myapp]# 
```

我安装了 libyaml

```
rvm pkg install libyaml 
```

然后重新安装红宝石

```
rvm reinstall ruby-1.9.3-p286 
```

但这并没有帮助。

为什么我不断收到此错误消息的任何其他想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:09:49.780

您需要在系统上安装**libtool**包，否则**libyaml**将无法编译。对于 Ubuntu 尝试：

`sudo apt-get install libtool
rvm pkg install libyaml
rvm pkg install libyaml-dev
rvm reinstall 1.9.3`

您也可以简单地使用发行版的包管理器来安装库而不是 rvm。对于 Ubuntu：

`sudo apt-get install libyaml libyaml-dev`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:46:43.783

这里有两个不同的问题，一个是 Yaml 产生的警告，一个是来自 JSON gem 的错误。

警告是：

```
/home3/user1/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/yaml.rb:56:in `<top (required)>':
It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby. 
```

这不一定是问题，您的 Ruby 安装将回退到使用旧的 Syck Yaml 库。Syck 已从 Ruby 2 中删除，因此您最终需要解决它，但这不是目前的主要问题。

在 Yaml 警告之后，您会立即收到以下信息：

```
/home3/user1/ruby/gems/gems/json-1.7.5/lib/json/common.rb:67: [BUG] unknown type 0x22 (0xc given)
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux] 
```

这是来自 JSON gem 的错误。JSON gem 使用本机扩展，我认为这个错误来自使用安装了早期版本的 Ruby 和更高版本的 gem。尝试重新安装您的 gems（尤其是`json`）来解决这个问题。

# asp.net-mvc - NHibernate 缓存问题 - 何时调用 Evict？

> ID：13131796
> 
> 赞同：6
> 
> 时间：2012-10-30T00:57:16.977
> 
> 标签：asp.net-mvc, nhibernate, caching, evict

我遇到了一个明显的缓存问题，NHibernate 返回的内容与数据库中的内容不匹配。

我相信这是二级缓存数据。看起来我可以使用 Evict 来执行此操作，但**实际上应该何时调用 Evict 方法？** 对于我的特定应用程序，数据对于用户来说将是唯一的，并且提供的数据可能只会使用一次*。

**我可以完全禁用这些对象集的 Level2 缓存吗？**

*更新 10/31*

我的场景是这样的：我有一个购物车，客户将在其中添加和删除商品。我正在做的事情如下：在处理购物车的更新之前，我驱逐了`Cart`and`CartProduct`实体。完成此操作后，我从提供程序检索列表`CartProducts`并返回视图（这发生在 .NET MVC 控制器中）。

*更新 11/3*

购物车已经完成，我遇到了一个似乎与同一个 NHibernate 问题有关的问题，但实际上是一个 MVC 问题。深入挖掘发现 HTML Helper 扩展覆盖了我假设的值并替换为 Model 状态中的值。所以对这个是双重打击。希望这可以帮助某人。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-30T03:20:21.247

不，您不能禁用某些实体的缓存。

你有几个选择：

1.  使用 ISession.Clear() 从 NHibernate 的缓存中清除所有实体。
    *   [http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache](http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache)
2.  使用 ISession.Evict( obj ) 从缓存中清除特定实体。
    *   [http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache](http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache)
3.  使用 ISessionFactory.Evict( typeof( obj ) ) 从缓存中逐出特定类型的所有实体/对象。在我看来，这将是最接近您想要的。
    *   [http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache](http://nhibernate.info/doc/nh/en/index.html#performance-sessioncache)
4.  使用 IStatelessSession 从数据库中获取对象/实体，因为这完全绕过了所有缓存。
    *   [http://nhibernate.info/doc/nh/en/index.html#batch-statelesssession](http://nhibernate.info/doc/nh/en/index.html#batch-statelesssession)

# sql - 在 ORACLE SQL 的 where 子句中对空字符串使用修剪

> ID：13131797
> 
> 赞同：5
> 
> 时间：2012-10-30T00:57:40.847
> 
> 标签：sql, oracle

我试图弄清楚为什么下面的 SQL 语句在 oracle 中没有返回值 do

```
Select 'do' from dual
where trim('  ') = '' 
```

然而

```
Select 'do' from dual
where trim(' a ')='a' 
```

返回值做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T01:01:10.140

因为`trim(' ')`返回`null`而不是`''`

[SQLFiddle 示例](http://sqlfiddle.com/#!4/d41d8/3610)

> 在 Oracle 8 中，没有零长度字符串这样的东西。任何来自函数调用或文字 '' 的零长度字符串都被视为 null。

[来源](http://thunderguy.com/semicolon/2003/04/26/oracle-empty-string-null/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T02:43:02.170

零长度字符串被视为空值，您不能在 Oracle 中通过（不）等式比较空值，因为它们以特殊方式处理。

文档参考：[条件中的 NULLS](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements005.htm#g194888)

因此，这个预期不起作用：

```
Select 'do' from dual where trim('  ') = '' 
```

试试这个：

```
10:39:58 SYSTEM@dwh-prod> select * from dual where trim('   ') is null 
10:40:02   2  /                                                        

D                                                                      
-                                                                      
X                                                                      

Elapsed: 00:00:00.07                                                   
10:40:04 SYSTEM@dwh-prod> select * from dual where '' is null          
10:40:11   2  /                                                        

D                                                                      
-                                                                      
X                                                                      

Elapsed: 00:00:00.02                                                   
10:40:11 SYSTEM@dwh-prod> 
```

# ajax - 防止提交到表单时重定向

> ID：13131802
> 
> 赞同：0
> 
> 时间：2012-10-30T00:57:55.463
> 
> 标签：ajax, post

我有以下代码用于将表单提交到处理脚本。表单被提交，但我被重定向到来自服务器的响应 html。我想留在同一页面上并在成功内运行回调函数：

响应标头正在发送位置：http://url-I-am-Redirected-to-and-don't-want-to-be.html

我正在与第三方合作，无法控制我提交的服务器端代码。

```
 $('#go').click (function () {

        $.ajax ( {
        type: 'POST',   
        data: $('#newsletter form').serialize(),
        url: $('#newsletter').attr('action'),
        success: function(){
        $('#image_container').hide (1000,

       );
      }
     });

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:54:55.310

在点击块的末尾添加

```
return false 
```

# c++ - c ++ while循环条件与stack.empty（）不兼容

> ID：13131803
> 
> 赞同：2
> 
> 时间：2012-10-30T00:58:01.187
> 
> 标签：c++, while-loop, stack

所以我对这段代码感到慌乱 - 无法理解为什么它行为不端。我唯一能想到的是 stack.empty() 在 while 循环中不能正常工作，但这似乎很荒谬。您将在代码后面的输出中看到，在运行失败之前程序永远不会退出 while 循环。

opStack 和 newOrder 的声明：

```
queue<string> newOrder;
stack< vector<char> > opStack; 
```

发生其他事情，然后执行此代码：

```
while(opStack.empty()==false){
    if(opStack.top()[1] != 'L'){
        cout<<"is stack empty?:"<<opStack.empty()<<endl;
        symbol = opStack.top()[0];
        newOrder.push(symbol);
        opStack.pop();
        cout<<"popped stack;"<<endl;
        cout<<"is stack empty?:"<<opStack.empty()<<endl;
    }
    else{
        break;
    }
}
cout<<"made it out of while loop"; 
```

输出：

```
is stack empty?:0
popped stack;
is stack empty?:1
RUN FAILED (exit value 1, total time: 1s) 
```

# c++ - 在 .cpp 和 .h 中包含标头的区别

> ID：13131805
> 
> 赞同：0
> 
> 时间：2012-10-30T00:58:18.770
> 
> 标签：c++, include

我有一个代码，其中我`#include<linux/videodev2.h>`. 共有三个文件：

1.  一个头文件 - 包括：`stdint.h`和`stdlib.h`. 定义了几个函数，一个结构，比如 abc，和一些 #define 宏。功能之一是

    ```
    int func(int, uint32_t, size_t, abc*); 
    ```

2.  一个包含很多方法的 cpp 文件，包括 .h 文件中的函数定义。

3.  一个 main.cpp，它具有 main()，它对 .h 文件中的方法有一个函数调用（下面的完整文件）。此文件仅用于测试目的。

    ```
    #include "head.h"
    int main() {
        func(5, (uint32_t)5, (size_t)5, 0);
        return 0;
    } 
    ```

看到的是一个奇怪的案例：

1.  如果我`linux/videodev2.h`仅包含在 .h 文件中，`uint32_t`并且 .cpp 文件无法访问此标头中定义的其他内容。（我得到的错误是：`uint32_t was not declared in this scope`，和`uint32_t does not name a type`，等等）。即使 .h 文件的第一行是`#include<linux/videodev2.h>`
2.  如果我在两个 cpp 文件中都包含 videodev2 标头，则**仅**当我在 .h 文件之前导入它 (videodev2) 时它才有效。
3.  如果我`func(5, (uint32_t)5, (size_t)5, (abc*)0);`在 main.cpp 文件中使用，我会得到 abc 未在此范围内声明的错误。

我正在使用以下命令进行编译：`g++ main.cpp head.cpp`

我无法弄清楚为什么会这样。我想在 .h 文件中包含 videodev2 标头，因为几乎可以肯定使用 .h 文件的代码将依赖于它。但似乎将其包含在 .h 文件中根本没有效果。

我必须在这里说实话。这是我必须转换为 C++ 的 C 代码。我知道我不符合最佳实践和标准。但为什么会出现这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T03:22:35.207

请记住，该`#include`指令向预处理器指示指定文件的内容应被视为直接出现在源文件中代替指令（从[MSDN](http://msdn.microsoft.com/en-us/library/36k2cdd4(v=vs.71).aspx)转述）。

考虑到这一点，您似乎遇到了不正确的`#include`s 顺序并且还缺少`#include`s。我的猜测是您没有在 .cpp 文件中包含自己的头文件。这将解释案例一和案例三。考虑以下文件：

```
// header.h
// #include <linux/videodev2.h>  <-- Option 1
class A {
    void func(uint32_t var);
};

// header.cpp
void A::func(uint32_t var) {
    // implementation
}

// main.cpp
// #include <linux/videodev2.h>  <-- Option 2
#include "header.h"
// #include <linux/videodev2.h>  <-- Option 3

int main() {
    // implementation; something creates an instance of A and calls func
} 
```

现在，选项 1[并不完全可取](https://stackoverflow.com/questions/2596449/including-includes-in-header-file-vs-source-file)；避免`#include`在头文件中使用 s 是一种很好的做法，因为它们会增加构建时间并创建不需要的依赖项。但是，它将确保`header.h`需要的类型可供它使用。关键是**的内容`linux/videodev2.h`必须出现在 的内容之前`header.h`，在`header.h`d`#include`的任何地方。**

这使我想到了选项 2。选项 2 也将正确编译，因为`linux/videodev2.h`它包含在您的标头之前，并且您的标头依赖于其中定义的类型。同样重要的是两者`main.cpp`和`header.cpp`must `#include "header.h"`，因为它们引用其中声明的符号。

如果您使用选项 3，您将收到类型`uint32_t`未定义的编译错误，并且编译器将指向您的头文件。这是因为头文件的内容出现在 的内容之前，所以编译器在遇到它时`linux/videodev2.h`还不明白是什么类型。`uint32_t`

因此，考虑到所有这些，您可以选择：在每次包含您自己的头文件之前包含 `linux/videodev2.h'，或者直接将其包含在您的头文件中。我之前提到后者不是好的做法，但对于您的特定情况，它可能是两者中更好的选择，以防您的头文件需要包含在许多 .cpp 中。

我认为这将是深入研究[预编译标头](http://en.wikipedia.org/wiki/Precompiled_header)的好机会，但我对它们并不精通，所以我会把它留给有更多经验的人来解释它们。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T04:02:07.180

找到了答案。目录中有.h.gch 文件。我不知道预编译的头文件。感谢 ktodisco 的洞察力。我仍然不知道为什么该文件首先存在。

# jquery - 在 JQuery 中将 HTML 转换为 DOM 对象，反之亦然

> ID：13131807
> 
> 赞同：1
> 
> 时间：2012-10-30T00:58:34.620
> 
> 标签：jquery, dom

我有一个带有这样的文本区域的表单：

```
<textarea id="code"><a href='test.html'><img src='test.jpg'></a></textarea> 
```

我正在把这段代码变成这样的 DOM 对象：

```
var code=$("#code").val();
var banner=$(code); 
```

执行此操作时：

```
alert(banner.html()); 
```

我明白`"<img src='test.jpg'>"`了，我期待完整的代码（`"<a href='test.html'><img src='test.jpg'></a>"`）

当我执行时，`alert(banner.attr('href')`我得到`'test.html'`了，这是我所期望的，它表明 DOM 对象是正确且完整的。

我最终想要做的是处理 HTML，在 href 上运行一些搜索，操作它，然后将结果写回 textarea。将其转换为 DOM 似乎是最合乎逻辑的步骤。

我把代码放在[这个 JSFiddle](http://jsfiddle.net/2MvnF/5/)

我在这里遗漏了什么，我需要做什么才能成功地将 HTML 转换为 DOM、对其进行操作、将其转换回 HTML 并将其作为 HTML 放回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:05:52.920

jQuery 对象包含锚元素，但该`html`方法不返回 jQuery 元素中元素的 HTML 代码，它返回jQuery 对象中元素*内部*的 HTML 代码。

您可以将元素放在另一个元素中以获取 HTML 代码：

```
var html = $('<div>').append(banner).html(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T01:03:57.753

`<a>`是根元素，所以你得到它的innerHTML `<img>`，你可能想要outerHTML，`alert(banner[0].outerHTML);` 试试看[http://jsfiddle.net/9Awu4/](http://jsfiddle.net/9Awu4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-18T18:59:24.393

我认为[（](http://jsfiddle.net/2MvnF/16/) JSFiddle 链接）是你想要的：

```
// grab the html source
var code=$("#code").val();

// convert to dom
var banner = $('<div>').html(code);
// find anchor and change attribute
banner.find('a').attr("href","manipulated.html");

// back to source code
code = banner.html()

// set content back into text area
$("#code").val(code); 
```

# jpanel - 如何在其中包含文本的禁用滚动窗格上添加 jtextfield？

> ID：13131820
> 
> 赞同：1
> 
> 时间：2012-10-30T01:00:38.537
> 
> 标签：jpanel, jscrollpane, jtextfield

我的大部分代码都在工作。我只需要创建一个非常小的配置对话框（输入一些文本作为此应用程序的路径。（日志文件监视器）

它几乎就在那里，文本字段出现在 jscrollpane 上（效果很好）。但我无法在文本字段中输入任何文本。我想不通。

请帮忙。

```
package vlive;
/* 
    vTABLET - a Virtual Desktop Tablet.
    http://www.splashportal.net
    Copyright (C) 2012  Aubrey Bourke.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

    Contact: (Author) Aubrey Bourke - aubrey@splashportal.net
    */

import java.awt.*;
import java.awt.event.*;
import java.awt.geom.RoundRectangle2D;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;

import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.swing.*;
import javax.imageio.ImageIO;
import javax.swing.JWindow;
import java.awt.image.*;
import  sun.audio.*;    //import the sun.audio package
import  java.io.*;
import java.util.Timer;
import java.util.*;
import javax.swing.border.Border;
import javax.swing.text.DefaultCaret;
import javax.swing.text.Document;
import javax.swing.text.html.HTMLEditorKit;
import javax.swing.text.html.StyleSheet;

class vLive extends JPanel implements MouseListener, MouseMotionListener{

    Point location;  
    MouseEvent pressed;
      File file;
      static vLive vlc;
        //static vTablet vlive;
    //vLiveConsole var's
    Shape shape;
    Dimension arcSize;
    BufferedImage splash, logo;
    JWindow vLiveConsoleWindow;
    Float transparency = 0.00f;
    Boolean isGreenLine=false;
    int line;
    Boolean isSplash = true;
        static Boolean isLiveLog = false;
        boolean isConfig;

        JTextField input;
        JTextPane textPane;
        HTMLEditorKit htmlEditorKit;
        BufferedReader daLog;
        String LogString;
        Document document;
        JScrollPane scrollPane;

        String osVersion;
        String status;

        //CONSTRUCTOR
    //@SuppressWarnings("restriction")
    public vLive(){

            Tray();

        //create the vTablet OSD
    Dimension arcSize = new Dimension(16, 16);
    shape = new RoundRectangle2D.Double(0d, 0d, 670, 199, arcSize.width, arcSize.height);
    vLiveConsoleWindow = new JWindow();

        setSize(650, 199);

    loadImages();
        roundTheFrame();

    //add this JPanel (LiveLog)
    vLiveConsoleWindow.add(this);

    vLiveConsoleWindow.addMouseListener(this);
    vLiveConsoleWindow.addMouseMotionListener(this);
    vLiveConsoleWindow.setSize(670, 199);
    //vLiveConsoleWindow.setLocation(10, 10);
    vLiveConsoleWindow.setLocationRelativeTo(null);

        vLiveConsoleWindow.setVisible(true);

      //start a chain call!
    fadein();
        //1\. fadein -> jetstart -> greenbar

         try{
        //keep logo visible after greenbar disappears
        Thread.sleep(4000);
        isSplash=false;

        isLiveLog=true;
        repaint();

        String os_version = System.getProperty("os.name").toLowerCase();
        osVersion = os_version;
        System.out.println("[System: "+os_version.toUpperCase()+"]");

        if(os_version.startsWith("win")){
        file = new File("C:/Windows/WindowsUpdate.log");
        status=file.toString();
        }

        if(os_version.startsWith("linux")) {

                file = new File("/var/log/messages");
                status = file.toString();

                if(!file.exists())
                file = new File("/var/log/syslog");
                status = file.toString();
        }

        //start Log Monitor
        TimerTask task = new FileWatcher( new File(file.getAbsolutePath()) ) {
      protected void onChange( File file ) {
        // here we code the action on a change
        //System.out.println( "File "+ file.getName() +" have changed !" );
        isLiveLog=true;
        updateLog();
      }
    };
                java.util.Timer timer = new Timer();
    // repeat the check every second
    timer.schedule( task , new Date(), 1000 );

        //load the Log to use
        //daLog = new File("/var/log/syslog");

        //add a textpane to JWindow
        textPane = new JTextPane();

        textPane.addMouseListener(this);
        textPane.addMouseMotionListener(this);

        scrollPane = new JScrollPane(textPane, JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,
                JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
        //DefaultCaret caret = (DefaultCaret)textPane.getCaret();
        //caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE);

        textPane.setEditable(false);
        textPane.setOpaque(false);
        scrollPane.setOpaque(false);
        scrollPane.getViewport().setOpaque(false);

            htmlEditorKit = new HTMLEditorKit();
            textPane.setEditorKit(htmlEditorKit);
            // add some styles to the html
            StyleSheet styleSheet = htmlEditorKit.getStyleSheet();
            styleSheet.addRule("body {font: italic bold 6px Sans;}");
            styleSheet.addRule("body {color:#585858;}");
            textPane.setContentType("text/html");

                        textPane.setSize(630, 165);
                        scrollPane.setSize(631, 165);

                         scrollPane.setVisible(true);
                        this.setLayout(null);
                        this.add(scrollPane);
                        this.scrollPane.setLocation(20, 15);
       //textPane.setLocation(0, 0);
                       revalidate();
        //textPane.setText("Hello there\n anybody see this text??\n");

                        updateLog();

        }catch(InterruptedException e){System.out.println(e);}

}
        public void roundTheFrame(){
        try{
    vLiveConsoleWindow.addComponentListener(new ComponentAdapter() {
        @SuppressWarnings("restriction")
        @Override
        public void componentResized(ComponentEvent e){
            com.sun.awt.AWTUtilities.setWindowShape(vLiveConsoleWindow, shape);

        }});
        } catch (SecurityException e) {

                // TODO Auto-generated catch block

                e.printStackTrace();

            } catch (IllegalArgumentException e) {

                // TODO Auto-generated catch block

                e.printStackTrace();

            }
        }
        public synchronized void updateLog(){
                //print the log

            Runnable updateAComponent = new Runnable() {
                public void run() { 

        if(isLiveLog){
              isLiveLog=false;

            System.out.println("[Log Update Event]".toUpperCase());
        try {
        document = textPane.getDocument();

        /*
        StyleSheet styleSheet = htmlEditorKit.getStyleSheet();
        styleSheet.addRule("body {font: italic bold 6px Sans;}");
        styleSheet.addRule("body {color:#585858;}");
        textPane.setContentType("text/html");
        */

        daLog =  new BufferedReader(new FileReader(file));
            try{
                String line = null; //not declared within while loop
                LogString = new String();

                while (( line = daLog.readLine()) != null){

  document.insertString(document.getLength(),line+"\n",null);

                                    //LogString+=line+"\n";
                }
            }finally {
                daLog.close();}
        }catch(Exception e){System.out.println(e);}

        //System.out.println(LogString);

        textPane.select(textPane.getDocument().getLength(), textPane.getDocument().getLength());

       revalidate();

         //textPane.setLocation(0, 0);

            } }
            };
            SwingUtilities.invokeLater(updateAComponent);

        }
        public void loadImages(){
        try 
     {
         String filename = "/images/vLive-Console-Logo.png";
     InputStream is = vLive.class.getResourceAsStream(filename);
         logo = ImageIO.read(is);
     }catch (IOException e) 
                           {
                System.out.println("[Image load error]");
                                }
    try 
     {
     String filename = "/images/vLive-Console.png";
     InputStream is = vLive.class.getResourceAsStream(filename);
         splash = ImageIO.read(is);      
     }catch (IOException e) 
                           {
                    System.out.println("[Image load error]");
                               }
        }

    @SuppressWarnings("restriction")
    public void sfx(){
        try {
            InputStream in;
            //in = new FileInputStream("jetstart2.wav");
            in = vLive.class.getResourceAsStream("/sounds/jetstart2.wav");  

        // Create an AudioStream object from the input stream.
        @SuppressWarnings("restriction")
        AudioStream as = new AudioStream(in);         

        // Use the static class member "player" from class AudioPlayer to play
        // clip.
        AudioPlayer.player.start(as);            
    }catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
    public void fadein(){
        //chain 1 -> fade in
            while (transparency<0.9999955f){
                transparency +=0.000005f;
                //System.out.println(transparency);
                repaint();
            }
            transparency=1.0f;
            repaint();

        //chain 2 -> jetstart2.wav
            sfx();

        //chain 3 -> green barrr    
            try {
                Thread.sleep(200);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            greenline();
    }
    public void greenline(){
        //line=80;
        line=30;
        isGreenLine = true;
        while(line<380){
            line++;
            repaint();
            try{
            Thread.sleep(4);
            }catch(InterruptedException e){System.out.println(e);}}
        try{
            Thread.sleep(2050);
            }catch(InterruptedException e){System.out.println(e);}
        isGreenLine=false;
        repaint();
    }

    public void fadeout(){
        //fade out
        while (transparency>0.01){
            transparency -=0.000007f;
            System.out.println(transparency);
            repaint();
        }
    }

    public void paintComponent(Graphics g) {

        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D)g;
        // Enable antialiasing for text
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.drawImage(splash, 0, 0, null);

                if(isSplash){
        Composite comp = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, transparency);
        g2d.setComposite(comp);
        g2d.drawImage(logo, null, 0, 1);    
        if(isGreenLine){
            g2d.setColor(Color.GREEN);
            //g2d.setColor(new Color(0x1e, 0x90, 0xff));

            g2d.setStroke(new BasicStroke(7));
            g2d.drawLine(30, 158, line, 158);
            g2d.setStroke(new BasicStroke(1));
            g2d.setColor(Color.BLACK);
            g2d.drawRect(26,154, line-22, 7);

            /*g2d.setStroke(new BasicStroke(7));
            g2d.drawLine(80, 125, line, 125);
            g2d.setStroke(new BasicStroke(1));
            g2d.setColor(Color.BLACK);
            g2d.drawRect(76,121, line-72, 7);*/
        }
        }
                if(isLiveLog){
                //System.out.println("isLiveLog - Empty Paint() block!");
                    Font tmp = new Font("Sans", Font.ITALIC+Font.BOLD, 10);    
                    g2d.setFont(tmp);
                    g2d.setColor(Color.GRAY.darker());
                    g2d.drawString("SYSTEM: "+osVersion.toUpperCase(), 30, 145);

                    g2d.drawString("LOGFILE: "+status.toUpperCase(), 30, 156);
                    g2d.drawString("INITIALIZING LIVE LOG-REPORTING...", 30, 167);
                }
                if(isConfig){

                    System.out.println("[Repaint...");

                }
    }

    public void mouseMoved(MouseEvent e) {

    }
    public void mouseDragged(MouseEvent e) {

         location = vLiveConsoleWindow.getLocation(location);  
         int x = location.x - pressed.getX() + e.getX();  
        int y = location.y - pressed.getY() + e.getY();  
        vLiveConsoleWindow.setLocation(x, y);

    }
    public void mouseClicked(MouseEvent e) {
         if(e.getButton()==3){
             System.out.println("[CONFIG]");
             isConfig=true;

             JPanel p2 = new JPanel();
             p2.setBackground(Color.GRAY);
             p2.setSize(300,20);

             input = new JTextField(40);
             input.setOpaque(false);
             input.setSize(300, 20);
             input.setForeground(Color.WHITE);

             input.setLocation(0, 0);
             p2.add(input);

             //Maybe add a POPUP instead!!!!             

             vLiveConsoleWindow.add(p2);
             p2.setLocation(40, 150);
             input.requestFocusInWindow();

             System.out.println(input.isEditable() + " " +input.isEnabled());
             input.setText("your path..");

             input.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {

                String tex = input.getText();
                System.out.println(tex);
        }
      });

         }

    }
    public void mouseEntered(MouseEvent e) {
    //search.requestFocus();
    }
    public void mouseExited(MouseEvent e) {
    //search.requestFocus(); 

    }
    public void mousePressed(MouseEvent e) {

        if(e.getButton()==1) 
        pressed = e; 
    }
    public void mouseReleased(MouseEvent e) {

    }

        public void Tray(){    
            System.out.println("[ACTIVATING TRAY ICON]");
            Image kimage=null;
            final TrayIcon trayIcon;

if (SystemTray.isSupported()) {
System.out.println("[SYSTEM TRAY SUPPORTED!]");
    try {
             String filename = "/images/vLive.png";
     InputStream is = vLive.class.getResourceAsStream(filename);
         kimage = ImageIO.read(is);      

    }catch (Exception e) {

            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    SystemTray tray = SystemTray.getSystemTray();
    //timage = Toolkit.getDefaultToolkit().getImage("res/CrossOfLife.png");

    MouseListener mouseListener = new MouseListener() {

        public void mouseClicked(MouseEvent e) {
            //System.out.println("Tray Icon - Mouse clicked!");                 
        }

        public void mouseEntered(MouseEvent e) {
            //System.out.println("Tray Icon - Mouse entered!");                 
        }

        public void mouseExited(MouseEvent e) {
            //System.out.println("Tray Icon - Mouse exited!");                 
        }

        public void mousePressed(MouseEvent e) {
            //System.out.println("Tray Icon - Mouse pressed!");                 
        }

        public void mouseReleased(MouseEvent e) {
            //System.out.println("Tray Icon - Mouse released!");                 
        }
    };

    ActionListener exitListener = new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            System.out.println("[Saving vTablet Screen Co-ordinates]".toUpperCase());

                      try{
                      FileWriter fw = new FileWriter("Config");
                      BufferedWriter bw = new BufferedWriter(fw);

                     int vx = vLiveConsoleWindow.getX();
                     int vy = vLiveConsoleWindow.getY();

                      bw.write(vx+"\n");
                      bw.write(vy+"\n");

                      bw.flush();
                      fw.close();

                      }catch(IOException eyecaptain){System.out.println("[Co-ordinate save error: "+eyecaptain+"]".toUpperCase());}

                      System.out.println("[Exiting...]".toUpperCase());
                      System.out.println("");
                      System.exit(0);
        }
    };

    ItemListener cbListener = new ItemListener() {
       public void itemStateChanged(ItemEvent e) { 
           Object source = e.getItemSelectable();
System.out.println(source);
           if (e.getItem().equals("vTablet-OSD"))
               System.out.println("Chek....");

    if (e.getStateChange() == ItemEvent.SELECTED){

        }

    if (e.getStateChange() == ItemEvent.DESELECTED){

        }

        }
    };

    PopupMenu popup = new PopupMenu();

    // Create a pop-up menu components
        MenuItem aboutItem = new MenuItem("About");
        CheckboxMenuItem cb1 = new CheckboxMenuItem("vTablet-OSD");
        cb1.setActionCommand("vTablet-OSD");
        cb1.addItemListener(cbListener);
        CheckboxMenuItem cb2 = new CheckboxMenuItem("VTab");
        CheckboxMenuItem cb3 = new CheckboxMenuItem("vTablet");
        Menu displayMenu = new Menu("Configuration");
        MenuItem errorItem = new MenuItem("Error");
        MenuItem warningItem = new MenuItem("Warning");
       MenuItem infoItem = new MenuItem("Info");
       MenuItem noneItem = new MenuItem("None");
        MenuItem exitItem = new MenuItem("Exit");

        //Add components to pop-up menu
        popup.add(aboutItem);
        popup.addSeparator();
        popup.add(cb1);
        popup.add(cb2);
        popup.add(cb3);
        popup.addSeparator();
        popup.add(displayMenu);
        displayMenu.add(errorItem);
        displayMenu.add(warningItem);
        displayMenu.add(infoItem);
        displayMenu.add(noneItem);
       // popup.add(exitItem);

    MenuItem defaultItem = new MenuItem("Exit");
    defaultItem.addActionListener(exitListener);
    popup.add(defaultItem);

    Font font3=new Font("Monospace", Font.ITALIC, 14);
    popup.setFont(font3);

    trayIcon = new TrayIcon(kimage, "vLive", popup);

    ActionListener actionListenerA = new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            trayIcon.displayMessage("Action Event", 
                "An Unimplemented Action Event Has Been Performed!",
                TrayIcon.MessageType.INFO);
            if(e.getActionCommand().equals("vTablet-OSD"))
            {System.out.println("[OSD Toggle!]".toUpperCase());}

        }
    };

   trayIcon.setImageAutoSize(true);
    popup.addActionListener(actionListenerA);
    trayIcon.addMouseListener(mouseListener);

    try {

        System.out.println("Tray Disabled");

    } catch (Exception e) {
        System.err.println("[TrayIcon could not be added.]".toUpperCase());
    }

} else {
    System.out.println("[Tray not supported!]".toUpperCase());

}
        }
    public static void main(String[] args){
                System.out.println("======================================");
        System.out.println("vLive Log-Report Console".toUpperCase());
                System.out.println("[Created by Aubrey Bourke]");
                System.out.println("[WEB: http://www.splashportal.net]".toUpperCase());
        System.out.println("======================================");

        Thread t = new Thread( new Runnable(){
            public void run()
            {
                vlc = new vLive(); //vTablet OSD
            }
                 });
            t.start();      
        }
} 
```

# python - 使用 Python 获取 Windows 7 的绝对路径时出错

> ID：13131825
> 
> 赞同：0
> 
> 时间：2012-10-30T01:01:11.217
> 
> 标签：python, windows, path

尝试运行此程序时，我不断收到“找不到文件”错误。为什么它没有找到并分配绝对路径？这是我的代码：

```
 file = "/" + arr[2] + ".exe"
    print(file)
    path = os.path.abspath(file)
    print(path)
    subprocess.Popen(path)
    localtime = time.asctime(time.localtime(time.time()))
    print(arr[2] + " opened at " + localtime + "\n") 
```

这是输出的内容：

```
/firefox.exe
C:\firefox.exe
Traceback (most recent call last):
File "C:\Python33\lib\subprocess.py", line 1090, in _execute_child
startupinfo)
FileNotFoundError: [WinError 2] The system cannot find the file specified 
```

我正在尝试以编程方式找到基于用户输入的打开程序......也许我正在以错误的方式进行操作，但这就是有人建议这样做的方式。Firefox.exe 应该位于 C:/Program Files/Firefox/firefox.exe

任何帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T03:19:14.693

尝试在 Windows 上打开程序的一种解决方案是仅搜索所有文件夹，从 C:/Program files/ 和 C:/Program Files (x86) 的基本目录开始。一个简单的解决方案可能如下所示：

```
for program_files in (os.path.join("C:", "Program\ Files"), os.path.join("C:", "Program\ Files\ (x86)"):
    for dir in os.listdir(program_files):
        if os.path.exists(os.path.join(program_files, dir, arr[2]) + ".exe"):
            subprocess.Popen(os.path.join(program_files, dir, arr[2]) + ".exe") 
```

这只会将一个目录向下移动到 Program Files 目录，但它至少应该给出需要做的事情的要点，并为大多数情况提供一个简单的解决方案。我假设大多数程序倾向于将它们的可执行文件保存在第一个目录下。

作为一个快速的旁注：如果您正在创建一个可以在 32 位和 64 位版本的 Windows 上运行的应用程序，您将需要某种检查 Program Files (x86) 目录的存在，或者某种检查32 位与 64 位 Windows。该文件夹仅存在于 64 位版本的 Windows 上。

另外：您的方法不起作用的原因是因为您获得了 /firefox.exe 的绝对路径，它在 Unix 系统上表示计算机上的最低级目录。在 Windows 上，这将是 C:/。Python 通常以非常 Unix-ey 的方式工作，因此它假定您需要系统的根目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:40:39.720

一旦我找到了路径，这就是我启动程序的方式，但是文件遍历/搜索算法超出了这个问题的范围。

```
#load this from a setting file later
programDict = {'firefox': r"C:/Program Files/Firefox/firefox.exe"}

if sys.argv[2] in programDict:
    subprocess.Popen(path) 
```

# c++ - 如何以编程方式编写 PST 文件

> ID：13131826
> 
> 赞同：0
> 
> 时间：2012-10-30T01:01:12.777
> 
> 标签：c++, .net, outlook, pst

> **可能重复：**
> [如何使用 .Net 创建 Outlook PST 文件？](https://stackoverflow.com/questions/1724789/how-can-i-create-an-outlook-pst-file-using-net)

如何编写带有标题的 Outlook PST 文件？最好在 .NET 中，尽管 C++ 或其他任何东西也很有用

我看过微软的 PST SDK，但它似乎是只读的。我找到的唯一代码是 CodeProject 文章“将电子邮件写入 PST 格式的文件”，但此代码不能写入电子邮件标题 - 只是正文和主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T02:32:26.457

.pst 文件格式文档对您有用吗？从我的简要介绍来看，它似乎记录了格式本身，因此您可以实现读/写功能。我不知道它有多详细，因为我自己没有使用过。

[http://msdn.microsoft.com/en-us/library/ff385210%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/ff385210%28v=office.12%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:04:56.200

最好的办法是使用 Microsoft 的 Messaging API (MAPI)。在线提供了大量帮助，还有一个名为 MFC Mapi 的示例应用程序，其中一位 Microsoft 人员编写了该应用程序来演示 API 的工作原理。

# asp.net - ASP 中的关键事件

> ID：13131827
> 
> 赞同：0
> 
> 时间：2012-10-30T01:01:48.860
> 
> 标签：asp.net, keyboard

如何使用 C# 代码捕获 ASP 中的关键事件？

例如，我想按下左键，文本框会发音为“Left Pressed”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T02:32:49.903

您误解了 Web 应用程序和 ASP.NET 的工作原理。在显示 HTML 页面的浏览器中，用户在客户端按下键。ASP.NET 和构成 Web 应用程序的 C# 代码在服务器端运行。您无法真正捕获服务器端的关键事件。即使可以，也不应该 - 每次用户按下某个键时，您都必须将其发送到服务器端，对其进行评估，然后再次呈现页面并将其发送回浏览器。这会产生大量流量并非常频繁地强制页面重新加载，从而使页面非常难以使用。即使是 AJAX 调用也无济于事。

相反，您应该在客户端处理按键，在浏览器内运行的 JavaScript 代码中，当您遇到服务器需要处理的内容时，您可以执行服务器调用。

该站点（以及其他站点）包含代码示例，展示了如何在 JavaScript 中实现密钥检测：

[http://www.alessandrolacava.com/using-javascript-to-detect-the-key-pressed/](http://www.alessandrolacava.com/using-javascript-to-detect-the-key-pressed/)

**编辑**：

或者，您可以尝试使用 Silverlight，这是一个类似于 Flash 的可编程浏览器插件。Silverlight 承载 .NET Framework，可以使用 C# 进行编程。但是，即使在这种情况下，您也将在客户端而不是服务器上处理密钥。

# python - 使用 GoogleMaps 1.0.2 的 try 语句

> ID：13131828
> 
> 赞同：1
> 
> 时间：2012-10-30T01:01:54.713
> 
> 标签：python, google-maps

我正在使用 python 模块 googlemaps 1.0.2，在用户输入未知地址的情况下，我无法使用 try 语句。

我收到的错误消息如下所示：

```
GoogleMapsError: Error 602: G_GEO_UNKNOWN_ADDRESS 
```

我的方法看起来像这样，（没有我的 API 密钥）：

```
from googlemaps import GoogleMaps
def get_distance(address, destination):
    try:
        gmaps = GoogleMaps(api_key)
        directions = gmaps.directions(address,destination)
        distance = directions['Directions']['Distance']['meters']/1600.0
        return distance
    except ???: 
```

我试过了：

```
except GoogleMapsError:
except 'GoogleMapsError: Error 602: G_GEO_UNKNOWN_ADDRESS' 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T01:08:03.360

您可能尚未导入 googlemaps.GoogleMapsError 异常。

```
from googlemaps import GoogleMaps, GoogleMapsError

def get_distance(address, destination):
    try:
        gmaps = GoogleMaps(api_key)
        directions = gmaps.directions(address,destination)
        distance = directions['Directions']['Distance']['meters']/1600.0
        return distance
    except GoogleMapsError:
        pass 
```

# c++ - 返回 0 后程序收到 SIGSEGV 错误

> ID：13131832
> 
> 赞同：1
> 
> 时间：2012-10-30T01:02:09.703
> 
> 标签：c++

```
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7b8bc26 in std::basic_filebuf<char, std::char_traits<char> >::_M_terminate_output() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
(gdb) where
#0  0x00007ffff7b8bc26 in std::basic_filebuf<char, std::char_traits<char>    >::_M_terminate_output() ()
from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#1  0x00007ffff7b8c6a2 in std::basic_filebuf<char, std::char_traits<char>>::close()       ()  from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#2  0x00007ffff7b8cb2a in std::basic_ofstream<char, std::char_traits<char> >::~basic_ofstream() ()
from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#3  0x0000000000403e02 in main (argc=2, argv=0x7fffffffe1c8)
at main.cpp:630 
```

我在程序执行后和“return 0;”后遇到了这个错误。已被执行。

我使用了来自 STL 的向量。仅当输入文件大小非常高时才会引发此错误（我在图中有大约 10000 个节点）

另外，我无法将输出写入文件。目前我已经评论了那部分。

请帮我解决问题。我正在使用 Ubuntu 12.10 64 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:07:50.283

从返回后的错误`main`可能由（至少）引起：

*   狡猾的`atexit`处理程序；或者
*   一些描述的内存损坏。

在这两者中，后者更有可能是后者，因此您应该在动态内存使用分析工具下运行代码，例如`valgrind`. 您对导致问题的大向量的描述似乎也支持这一论点。

# php - 方法声明是兼容的，但 PHP 抱怨

> ID：13131836
> 
> 赞同：5
> 
> 时间：2012-10-30T01:03:04.910
> 
> 标签：php, splobjectstorage

所以我有这个类：

```
class JSObjectStorage extends \SplObjectStorage
{

    /**Adds a JavaScript object inside the storage, and optionally associate it to some data.*/    
    public function attach($javaScript, $data = null){}

    /**Removes the object from the storage.*/
    public function detach($javaScript){}

    /**Adds all objects-data pairs from a different JavaScriptBundle storage in the current storage.*/
    public function addAll(\SplObjectStorage $storage){}

    /**Removes objects contained in another storage from the current storage.*/
    public function removeAll(\SplObjectStorage $storage){}

    /**Removes all objects except for those contained in another storage from the current storage.*/
    public function removeAllExcept(\SplObjectStorage $storage){}

    /**Alias to JSObjectStorage::attach. */    
    public function offsetSet($javaScript, $data = null){}

    /**Alias to JSObjectStorage::detach*/
    public function offsetUnset($javaScript){}

    /**Returns the data associated with an object in the storage.*/
    public function offsetGet($javaScript){}

    /**This method calculates an identifier for the objects added to JSObjectStorage object.*/
    public function getHash($javaScript){}
} 
```

这是 SplObjectStorage：

[http://php.net/manual/en/class.splobjectstorage.php](http://php.net/manual/en/class.splobjectstorage.php)

如您所见，它们是相同的，但是当我实例化 JSObjectSTorage 时，出现以下错误：

> 严格标准：MOWAFW\Core\Type\JavaScript\JSObjectStorage::addAll() 的声明应与 /Users/ ****** /JSObjectStorage.php 175 行中的 SplObjectStorage::addAll() 的声明兼容

这发生在 removeAll() 和 removeAllExcept() 上。

有任何想法吗？！

* * *

我正在使用：

```
PHP 5.3.10 with Suhosin-Patch (cli) (built: Feb 20 2012 22:55:53) 
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies
    with Xdebug v2.1.2, Copyright (c) 2002-2011, by Derick Rethans 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T00:36:43.400

有人发布了题为[“名称空间接口由于类型提示问题而无法工作”（错误＃40653）](http://forge.typo3.org/issues/40653)的错误报告，尽管 PHP 版本不同（它读取***v. < 5.3.7***），但它看起来像您的情况。

# c - 在 Linux GTK 应用程序中嵌入 Flash - 沙盒冲突

> ID：13131838
> 
> 赞同：4
> 
> 时间：2012-10-30T01:03:21.013
> 
> 标签：c, linux, flash, gtk, npapi

我正在使用 NPAPI 在 Linux 应用程序中嵌入 Flash SWF 文件。一切正常，但是当 Flash 调用“fscommand”时，我遇到了安全沙箱违规。我用几个 Linux 发行版和几个版本的 Flash Player (9,10,11) 尝试了这个程序，但没有运气。

有谁知道这是否是 Linux 平台中 Flash Player 的限制？

在这篇文章[中，当 SWF 结束时关闭 gtk 应用程序（NPAPI）](https://stackoverflow.com/questions/10726487/closing-gtk-application-when-swf-ends-npapi)似乎他们已经能够接收 Javascript 事件。

这是我正在使用的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <dlfcn.h>
#include <string.h>
#include <unistd.h>
#include <ctype.h>

#include <gtk/gtk.h>
#include <gdk/gdkx.h>

//#include "npupp.h"
#include "npapi.h"
#include "npfunctions.h"

//#ifdef __i386__
#define FLASH_PLUGIN_SO "./flash/libflashplayer32.so"
//#else
//#define FLASH_PLUGIN_SO "./flash/libflashplayer64.so"
//#endif

#define PR_TRUE 1
#define PR_FALSE 0

#define WINDOW_XSIZE 1600/2
#define WINDOW_YSIZE 900/2

#define NO_IDENTIFIER       ((NPIdentifier)0)
#define SPECIAL_IDENTIFIER  0x0FEEBBCC
#define SPECIAL_METHOD_NAME "swhxCall"

#define FLASH_REQUEST       "__flash__request"
#define FSCMD           "_DoFSCommand"
#define INVOKE_RESPONSE "<invoke name=\"%s\" returntype=\"javascript\"><arguments><null/></arguments></invoke>"

typedef intptr_t int_val;

void *flash_plugin_handle;

NPNetscapeFuncs browserFuncs;
NPPluginFuncs pluginFuncs;

GtkWidget *main_window;

char* URL;
NPStream * stream;
const char * uagent = "Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13";

NPError (*iNP_Initialize)(NPNetscapeFuncs* bFuncs, NPPluginFuncs* pFuncs);
NPError (*iNP_Shutdown)();
char* (*iNP_GetMIMEDescription)();

// --- Property IDs

static char **np_ids = NULL;
static int_val np_id_count = 0;

static NPIdentifier resolveNPId( const char *id ) {
    int_val i;
    for(i=0;i<np_id_count;i++)
        if( strcmp(np_ids[i],id) == 0 )
            return (NPIdentifier)(i+1);
    if( strcmp(id,SPECIAL_METHOD_NAME) == 0 )
        return (NPIdentifier)SPECIAL_IDENTIFIER;
    return NO_IDENTIFIER;
}

static NPIdentifier addNPId( const char *id ) {
    NPIdentifier newid = resolveNPId(id);
    if( newid == NO_IDENTIFIER ) {
        np_id_count++;
        printf("New npid added: %i == %s\n",np_id_count, id);
        np_ids = realloc(np_ids,np_id_count*sizeof(char*));
        np_ids[np_id_count-1] = strdup(id);
        return (NPIdentifier)np_id_count;
    }
    return newid;
}

static const char *getNPId( NPIdentifier id ) {
    int_val index = ((int_val)id)-1;
    if( index >= 0 && index < np_id_count )
        return np_ids[index];
    if( id == (NPIdentifier)SPECIAL_IDENTIFIER )
        return SPECIAL_METHOD_NAME;
    return NULL;
}

static int matchNPId(NPIdentifier id, const char *str) {
    const char *strid = getNPId(id);
    return ( strid != NULL && strcmp(strid,str) == 0 );
}

void freeNPIds() {
    while( np_id_count )
        free(np_ids[--np_id_count]);
    free(np_ids);
}

static bool NPN_InvokeProc( NPP npp, NPObject *npobj, NPIdentifier methodName, const NPVariant *args, uint32_t argCount, NPVariant *result ) ;
static bool NPN_InvokeDefaultProc( NPP npp, NPObject *npobj, const NPVariant *args, uint32_t argCount, NPVariant *result ) ;
static bool NPN_GetPropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName, NPVariant *result ) ;
static bool NPN_SetPropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName, const NPVariant *value ) ;
static bool NPN_RemovePropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName ) ;
static bool NPN_HasPropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName ) ;
static bool NPN_HasMethodProc( NPP npp, NPObject *npobj, NPIdentifier methodName ) ;

static NPObject *NPN_CreateObjectProc( NPP npp, NPClass *aClass );
static NPObject *NPN_RetainObjectProc( NPObject *npobj );

// Window class;
static NPClass __gen_class =
    { NP_CLASS_STRUCT_VERSION
    , (NPAllocateFunctionPtr) malloc
    , (NPDeallocateFunctionPtr) free
    , 0
    , (NPHasMethodFunctionPtr) NPN_HasMethodProc
    , (NPInvokeFunctionPtr) NPN_InvokeProc
    , (NPInvokeDefaultFunctionPtr)NPN_InvokeDefaultProc
    , (NPHasPropertyFunctionPtr) NPN_HasPropertyProc
    , (NPGetPropertyFunctionPtr) NPN_GetPropertyProc
    , (NPSetPropertyFunctionPtr) NPN_SetPropertyProc
    , (NPRemovePropertyFunctionPtr) NPN_RemovePropertyProc
    };
static NPObject __window = { &__gen_class, 1 };
static NPObject __location = { &__gen_class, 1};
static NPObject __top = { &__gen_class, 1 };
static NPObject __top_location = { &__gen_class, 1 };

static void traceObjectOnCall(const char *f, NPObject *o){
    if (o == &__top) printf("DOM object 'top': %s\n",f);
    else if (o == &__window) printf("DOM object 'window': %s\n",f);
    else if (o == &__location) printf("DOM object 'location': %s\n",f);
    else if (o == &__top_location) printf("DOM object 'top.location': %s\n",f);
}

static void checkError(const char* str, NPError err) {
if(err == NPERR_NO_ERROR)
printf("[+] %s: success\n", str);
else
printf("[-] %s: failed (%d)\n", str, err);
fflush (stdout);
}

void* loadFlashPluginSo() {
    void *handle;

    handle = dlopen(FLASH_PLUGIN_SO, RTLD_LAZY | RTLD_LOCAL);
    if(!handle) {
        fprintf(stderr, "[-] error loading libflasplayer.so: %s\n", dlerror());
        exit(1);
    }   
    puts("[+] loaded libflashplayer.so");
    return handle;
}

void* loadSymbol(void *handle, const char *name) {
    char *error;
    void *ret;

    ret = dlsym(handle, name);

    if((error = dlerror()) != NULL) {
        fprintf(stderr, "[-] error loading symbol %s: %s\n", name, error);
        exit(1);
    } else {
        printf("[+] loaded symbol %s, address: %p\n", name, ret);
    }
    return ret;
}

void loadNPEntryPoints(void *handle) {
    iNP_Initialize=(NPError (*)(NPNetscapeFuncs* bFuncs, NPPluginFuncs* pFuncs))loadSymbol(handle, "NP_Initialize");
    iNP_Shutdown=(NPError (*)())loadSymbol(handle, "NP_Shutdown");
    iNP_GetMIMEDescription = (char*(*)())loadSymbol(handle,"NP_GetMIMEDescription");
}

void printPluginEntrypoints(NPPluginFuncs* pFuncs) {
printf("[*] NPP struct:\n");
printf("\t- NPP_size: %8d\n",pFuncs->size);
printf("\t- NPP_version: %8d\n",pFuncs->version);
printf("\t- NPP_NewProcPtr: %p\n", pFuncs->newp);
printf("\t- NPP_DestroyProcPtr: %p\n", pFuncs->destroy);
printf("\t- NPP_SetWindowProcPtr: %p\n", pFuncs->setwindow);
printf("\t- NPP_NewStreamProcPtr: %p\n", pFuncs->newstream);
printf("\t- NPP_DestroyStreamProcPtr: %p\n", pFuncs->destroystream);
printf("\t- NPP_StreamAsFileProcPtr: %p\n", pFuncs->asfile);
printf("\t- NPP_WriteReadyProcPtr: %p\n", pFuncs->writeready);
printf("\t- NPP_WriteProcPtr: %p\n", pFuncs->write);
printf("\t- NPP_PrintProcPtr: %p\n", pFuncs->print);
printf("\t- NPP_HandleEventProcPtr: %p\n", pFuncs->event);
printf("\t- NPP_URLNotifyProcPtr: %p\n", pFuncs->urlnotify);
printf("\t- javaClass: %p\n", pFuncs->javaClass);
printf("\t- NPP_GetValueProcPtr: %p\n", pFuncs->getvalue);
printf("\t- NPP_SetValueProcPtr: %p\n", pFuncs->setvalue);
}

NPError NPN_SetValueProc(NPP instance, NPPVariable variable, void *value)
{
    switch(variable) {
        case NPPVpluginWindowBool:
            printf( "NPPVpluginWindowBool - %p\n", value);
            break;
        default:
            printf( "SetValue %i\n", variable );
            break;
    }
    return NPERR_NO_ERROR;
}

NPError NPN_GetValueProc(NPP instance, NPNVariable variable, void *ret_value) {

printf("[D] NPN_GetValueProc instance:%p, variable:%d, abi_mask:%d\n", instance, variable, 0);

switch (variable) {
    case NPNVSupportsXEmbedBool:
        *((int*)ret_value)= PR_TRUE;
        break;
    case NPNVToolkit:
        *((int*)ret_value)= NPNVGtk2;
        break;
    case NPNVnetscapeWindow:
        *((int*)ret_value)= PR_TRUE;
        break;
    default:
        *((int*)ret_value)=PR_FALSE;
        break;
    }
    return NPERR_NO_ERROR;
}

const char* NPN_UserAgentProc(NPP instance) {
    return uagent;
}

static void Status_( NPP instance, const char* message ) {
    printf( "Status\n" );
}

uint32_t MemFlush( uint32_t size ) {
    return 0;
}

void ReloadPlugins( NPBool reloadPages ) {
}

void * GetJavaEnv(void) {
    return NULL;
}

void * GetJavaPeer( NPP instance ) {
    return NULL;
}

NPIdentifier NPN_GetStringIdentifierProc(const NPUTF8* name) {
    return addNPId(name);
}

void GetStringIdentifiers( const NPUTF8 **names, int32_t nameCount, NPIdentifier *identifiers ) {
}

NPIdentifier GetIntIdentifier( int32_t intid ) {
    return NO_IDENTIFIER;
}

bool IdentifierIsString( NPIdentifier id ) {
    return getNPId(id) != NULL;
}

NPUTF8* UTF8FromIdentifier( NPIdentifier identifier ) {
    const char *result = getNPId(identifier);
    return result ? strdup(result) : NULL;
}

int32_t IntFromIdentifier( NPIdentifier id ) {
    return 0;
}

static gboolean plug_removed_cb (GtkWidget *widget, gpointer data) {
    printf("[!] plug_removed_cb\n");
    return TRUE;
}

static void socket_unrealize_cb(GtkWidget *widget, gpointer data) {
    printf("[!] socket_unrealize_cb\n");
}

static NPWindow * npwindow_construct (GtkWidget *widget) {
    NPWindow *npwindow;
    NPSetWindowCallbackStruct *ws_info = NULL;

    GdkWindow *parent_win = widget->window;

    GtkWidget *socketWidget = gtk_socket_new();
    gtk_widget_set_parent_window(socketWidget, parent_win);

    g_signal_connect(socketWidget, "plug_removed", G_CALLBACK(plug_removed_cb), NULL);
    g_signal_connect(socketWidget, "unrealize", G_CALLBACK(socket_unrealize_cb), NULL);
    g_signal_connect(socketWidget, "destroy", G_CALLBACK(gtk_widget_destroyed), &socketWidget);

    gpointer user_data = NULL;
    gdk_window_get_user_data(parent_win, &user_data);

    GtkContainer *container = GTK_CONTAINER(user_data);
    gtk_container_add(container, socketWidget);
    gtk_widget_realize(socketWidget);

    GtkAllocation new_allocation;
    new_allocation.x = 0;
    new_allocation.y = 0;
    new_allocation.width = WINDOW_XSIZE;
    new_allocation.height = WINDOW_YSIZE;
    gtk_widget_size_allocate(socketWidget, &new_allocation);

    gtk_widget_show(socketWidget);
    gdk_flush();

    GdkNativeWindow ww = gtk_socket_get_id(GTK_SOCKET(socketWidget));
    GdkWindow *w = gdk_window_lookup(ww);

    npwindow = (NPWindow*) malloc (sizeof (NPWindow));
    npwindow->window = (void*)(unsigned long)ww;
    npwindow->x = 0;
    npwindow->y = 0;
    npwindow->width = WINDOW_XSIZE;
    npwindow->height = WINDOW_YSIZE;

    ws_info = (NPSetWindowCallbackStruct*) malloc(sizeof (NPSetWindowCallbackStruct));
    ws_info->type = NP_SETWINDOW;
    ws_info->display = GDK_WINDOW_XDISPLAY(w);
    ws_info->colormap = GDK_COLORMAP_XCOLORMAP(gdk_drawable_get_colormap(w));
    GdkVisual* gdkVisual = gdk_drawable_get_visual(w);
    ws_info->visual = GDK_VISUAL_XVISUAL(gdkVisual);
    ws_info->depth = gdkVisual->depth;

    npwindow->ws_info = ws_info;
    npwindow->type = NPWindowTypeWindow;

    return npwindow;
}

static NPStream * npstream_construct() {
    NPStream *stream = (NPStream *) malloc(sizeof(NPStream));

    stream->url=strdup(URL);
    stream->ndata = 0;
    stream->end = 99782;
    stream->lastmodified= 1201822722;
    stream->notifyData = 0x00000000;
    stream->headers = (char*)malloc(200);

    return stream;
}

bool NPN_InvokeProc( NPP npp, NPObject *npobj, NPIdentifier npid, const NPVariant *args, uint32_t argCount, NPVariant *result ) {

    traceObjectOnCall(__FUNCTION__,npobj);

    if( matchNPId(npid,FLASH_REQUEST) && argCount == 1 && args[0].type == NPVariantType_String ) {
        return 1;
    }
    if( matchNPId(npid,FLASH_REQUEST) && argCount == 3 &&
        args[0].type == NPVariantType_String &&
        args[1].type == NPVariantType_String &&
        args[2].type == NPVariantType_String
    ) {
        return 1;
    }

    if( matchNPId(npid,"_DoFSCommand") && argCount == 2 && args[0].type == NPVariantType_String && args[1].type == NPVariantType_String ) {
        printf("[D] FSCOMMAND\n");
        return 1;
    }

    if( npobj == &__top_location ) {
        if( matchNPId(npid,"toString") ) {
            result->type = NPVariantType_String;
            // "chrome://global/content/console.xul" is what Firefox returns for 'top.location.toString()';
            result->value.stringValue.UTF8Characters = strdup("chrome://global/content/console.xul");
            result->value.stringValue.UTF8Length = (int)strlen(result->value.stringValue.UTF8Characters);
            printf("[D] Returned %s\n", result->value.stringValue.UTF8Characters);
        }
        return 1;
    }
    //On OSX, Flash retreives locations by injected functions:
    if( matchNPId(npid,"__flash_getWindowLocation") ) {
        // return the location object:
        result->type = NPVariantType_Object;
        result->value.objectValue = &__location;
        NPN_RetainObjectProc(&__location);
        return 1;
    }
    if( matchNPId(npid,"__flash_getTopLocation") ) {
        // return the top_location object:
        result->type = NPVariantType_Object;
        result->value.objectValue = &__top_location;
        NPN_RetainObjectProc(&__top_location);
        return 1;
    }
    return 0;
}

static bool NPN_InvokeDefaultProc( NPP npp, NPObject *npobj, const NPVariant *args, uint32_t argCount, NPVariant *result ) {
    return 0;
}

static bool NPN_GetPropertyProc( NPP npp, NPObject *npobj, NPIdentifier npid, NPVariant *result ) {

    if (npobj == &__window) {
        if( matchNPId(npid,"location") ) {
            result->type = NPVariantType_Object;
            result->value.objectValue = &__location;
            NPN_RetainObjectProc(&__location);
            return 1;
        }
        if( matchNPId(npid,"top") ) {
            result->type = NPVariantType_Object;
            result->value.objectValue = &__top;
            NPN_RetainObjectProc(&__top);
            return 1;
        }
    } else if (npobj == &__top) {
        if ( matchNPId(npid,"location") ) {
            result->type = NPVariantType_Object;
            result->value.objectValue = &__top_location;
            NPN_RetainObjectProc(&__top_location);
            return 1;
        }
    }
    return 0;
}

static bool NPN_SetPropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName, const NPVariant *value ) {
    return 0;
}

static bool NPN_RemovePropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName ) {
    return 0;
}

static bool NPN_HasPropertyProc( NPP npp, NPObject *npobj, NPIdentifier propertyName ) {
    return 0;
}

static bool NPN_HasMethodProc( NPP npp, NPObject *npobj, NPIdentifier methodName ) {
    return 0;
}

static int unescape( char *str, int *ssize ) {
    int k = 0, esc = 0;
    // UNESCAPE the string
    while( k < *ssize ) {
        if( !esc ) {
            if( str[k++] == '\\' )
                esc = 1;
        } else {
            char c;
            switch( str[k] ) {
            case '"': c = '"'; break;
            case '\\': c = '\\'; break;
            case 'r': c = '\r'; break;
            case 'n': c = '\n'; break;
            case 't': c = '\t'; break;
            default:
                return 0;
            }
            (*ssize)--;
            memcpy(str+k,str+k+1,*ssize-k);
            str[k-1] = c;
            esc = 0;
        }
    }
    str[*ssize] = 0;
    return 1;
}

static const char *end_of_string( const char *send ) {
    int esc = 0;
    while( *send ) {
        switch( *send ) {
        case '"':
            if( !esc )
                return send;
            esc = 0;
            break;
        case '\\':
            esc = !esc;
            break;
        default:
            esc = 0;
            break;
        }
        send++;
    }
    return NULL;
}

#define JS_CALL_START "try { __flash__toXML("
#define JS_RESULT_START "var __flash_temp = \""

bool Evaluate( NPP npp, NPObject *npobj, NPString *script, NPVariant *result ) {
    printf( "Evaluate %s\n", script->UTF8Characters );
    if( memcmp(script->UTF8Characters,JS_CALL_START,strlen(JS_CALL_START)) == 0 ) {
        const char *p = script->UTF8Characters + strlen(JS_CALL_START);
        const char *s = p;
        const char *send;
        while( *s && *s != '(' )
            s++;
        if( !*s || s[1] != '"' )
            return 0;
        s += 2;
        send = end_of_string(s);
        if( send == NULL || send[1] != ')' )
            return 0;
        {
            int isize = (int)(s - p) - 2;
            int ssize = (int)(send - s);
            char *ident = (char*)malloc(isize+1);
            char *str = (char*)malloc(ssize+1);
            memcpy(ident,p,isize);
            memcpy(str,s,ssize);
            ident[isize] = 0;
            if( !unescape(str,&ssize) ) {
                free(ident);
                free(str);
                return 0;
            }
            // CALLBACK
            {               
                printf("CALLBACK\n");
                int size = 0;
                const char *res = "callback";
                free(ident);
                free(str);
                if( res == NULL )
                    return 0;
                result->type = NPVariantType_String;
                result->value.stringValue.UTF8Characters = strdup(res);
                result->value.stringValue.UTF8Length = size;
                return 1;
            }
        }
    }
    if( memcmp(script->UTF8Characters,JS_RESULT_START,strlen(JS_RESULT_START)) == 0 ) {
        const char *s = script->UTF8Characters + strlen(JS_RESULT_START);
        const char *send = end_of_string(s);
        char *str;
        int ssize;
        if( send == NULL || send[1] != ';' )
            return 0;
        ssize = (int)(send - s);
        str = (char*)malloc(ssize+1);
        memcpy(str,s,ssize);
        if( !unescape(str,&ssize) ) {
            free(str);
            return 0;
        }
        result->type = NPVariantType_String;
        result->value.stringValue.UTF8Characters = str;
        result->value.stringValue.UTF8Length = ssize;
        return 1;
    }
    result->type = NPVariantType_Void;
    return 1;
}

void NPN_ReleaseObjectProc(NPObject *npobj) {
    if( npobj == NULL )
        return;
    npobj->referenceCount--;
    if( npobj->referenceCount != 0 )
        return;
    if( npobj->_class->deallocate ) {
        npobj->_class->deallocate(npobj);
        return;
    }
    if( npobj->_class->invalidate )
        npobj->_class->invalidate(npobj);
    free(npobj);
}

NPObject* NPN_CreateObjectProc(NPP npp, NPClass *aClass) {
    NPObject *o;
    if( aClass->allocate )
        o = aClass->allocate(npp,aClass);
    else
        o = (NPObject*)malloc(sizeof(NPObject));
    o->_class = aClass;
    o->referenceCount = 1;
    return o;
}

NPObject* NPN_RetainObjectProc(NPObject *npobj) {
    if( npobj == NULL )
        return NULL;
    npobj->referenceCount++;
    return npobj;
}

void NPN_ReleaseVariantValueProc(NPVariant *variant) {
    //printf("ReleaseVariantValueProc\n");
    switch( variant->type ) {
        case NPVariantType_Null:
        case NPVariantType_Void:
            break;
        case NPVariantType_String:
            free( (char*)variant->value.stringValue.UTF8Characters );
            variant->type = NPVariantType_Void;
            break;
        case NPVariantType_Object:
            NPN_ReleaseObjectProc(variant->value.objectValue);
            variant->type = NPVariantType_Void;
            break;
        default:
            break;
    }
}

void SetException( NPObject *npobj, const NPUTF8 *message ) {
    printf("SetException %s\n",message);
}

NPError NPN_GetURLNotifyProc(NPP instance, const char* url, const char* window, void* notifyData) {
    printf("[D] NPN_GetURLNotifyProc:%p, url: %s, window: %s\n", instance, url, window);
    if (window && strlen(window)==6 && memcmp("_blank",window,6)==0) {
        //system_launch_url(url);
        pluginFuncs.urlnotify(instance,url,NPRES_DONE,notifyData);
    } else if( memcmp(url,"javascript:",11) == 0 ) {
        NPStream s;
        uint16_t stype;
        int success;
        memset(&s,0,sizeof(NPStream));
        s.url = strdup(url);
        success = (pluginFuncs.newstream(instance,"text/html",&s,0,&stype) == NPERR_NO_ERROR);      
        if( success ) {
            int pos = 0;
            int size;
            char buf[256];
            sprintf(buf,"%X__flashplugin_unique__",(int_val)instance);
            size = (int)strlen(buf);
            s.end = size;
            while( pos < size ) {
                int len = pluginFuncs.writeready(instance,&s);
                if( len <= 0 )
                    break;
                if( len > size - pos )
                    len = size - pos;
                len = pluginFuncs.write(instance,&s,pos,len,buf+pos);
                if( len <= 0 )
                    break;
                pos += len;
            }
            success = (pos == size);
        }
        pluginFuncs.urlnotify(instance,url,success?NPRES_DONE:NPRES_NETWORK_ERR,notifyData);
        pluginFuncs.destroystream(instance,&s,NPRES_DONE);
        free((void*)s.url);
    } else {

        NPStream stream;
        uint16_t stype;// = NP_NORMAL;

        memset(&stream,0,sizeof(NPStream));
        stream.url = strdup(url);
        stream.notifyData = notifyData;

        pluginFuncs.newstream(instance,"application/x-shockwave-flash",&stream, 0, &stype);
        //fprintf(stderr, "NPP: %p URL: %s\n", instance, url);

        FILE *pp;
        char buffer[8192];
        pp = fopen(url,"rb");
        int len;

        while((len=fread(buffer, 1, sizeof(buffer), pp)) != 0) {
            pluginFuncs.writeready(instance, &stream);
            pluginFuncs.write(instance, &stream, 0, len, buffer);
        }

        fclose(pp);
        pluginFuncs.destroystream(instance, &stream, NPRES_DONE);

        free((void*)stream.url);
        //pluginFuncs.urlnotify(instance, url, NPRES_DONE, notifyData);
    }

    return NPERR_NO_ERROR;
}

NPError NPN_GetURL( NPP instance, const char* url, const char* target ) {
    printf( "GetURL %s\n", url );
    if (target && strlen(target)==6 && memcmp("_blank",target,6)==0) {
        //system_launch_url(url);
        return NPERR_NO_ERROR;
    }
    return NPERR_NO_ERROR;
}

NPError NPN_PostURLNotify( NPP instance, const char* url, const char* target, uint32_t len, const char* buf, NPBool file, void* notifyData) {
    printf( "PostURLNotify (url) %s (target) %s (buf) %s[%d] (file) %i (nd) %p\n", url, target,  buf, len, file, notifyData);
    //url_process(instance,url,buf,len,notifyData);
    return NPERR_NO_ERROR;
}

NPError NPN_PostURL( NPP instance, const char* url, const char* target, uint32_t len, const char* buf, NPBool file ) {
    printf( "PostURL" );
    return NPERR_NO_ERROR;
}

NPError NPN_RequestRead(NPStream* stream, NPByteRange* range_list) {
    printf("[D] NPN_RequestRead\n");
        return NPERR_NO_ERROR;
}

NPError NewStream( NPP instance, NPMIMEType type, const char* target, NPStream** stream ) {
    printf( "NewStream\n" );
    return NPERR_NO_ERROR;
}

int32_t Write( NPP instance, NPStream* stream, int32_t len, void* buffer ) {
    printf( "Write\n" );
    return 0;
}

NPError DestroyStream( NPP instance, NPStream* stream, NPReason reason ) {
    printf( "DestroyStream\n" );
    return NPERR_NO_ERROR;
}

void _InvalidateRect( NPP instance, NPRect *invalidRect ) {
    printf( "InvalidateRect\n" );

}

void InvalidateRegion( NPP instance, NPRegion invalidRegion ) {
    printf( "InvalidateRegion\n" );
}

void ForceRedraw( NPP instance ) {
    printf( "ForceRedraw\n" );
}

void initNPNetscapeFuncs(NPNetscapeFuncs *bFuncs) {
    int i=0;

    for(i=1; i<sizeof(*bFuncs)/sizeof(ssize_t); i++)
    *(((ssize_t*)bFuncs)+i)=i+1000;

bFuncs->geturl=NPN_GetURL;
bFuncs->posturl=NPN_PostURL;
bFuncs->requestread=NPN_RequestRead;
bFuncs->newstream=NewStream;
bFuncs->write=Write;
bFuncs->destroystream=DestroyStream;
bFuncs->status=Status_;
bFuncs->uagent=NPN_UserAgentProc;
bFuncs->memalloc=malloc;
bFuncs->memfree=free;
bFuncs->memflush=MemFlush;
bFuncs->reloadplugins=ReloadPlugins;
bFuncs->getJavaEnv=GetJavaEnv;
bFuncs->getJavaPeer=GetJavaPeer;
bFuncs->geturlnotify=NPN_GetURLNotifyProc;
bFuncs->posturlnotify=NPN_PostURLNotify;
bFuncs->getvalue=NPN_GetValueProc;
bFuncs->setvalue=NPN_SetValueProc;
bFuncs->invalidaterect=_InvalidateRect;
bFuncs->invalidateregion=InvalidateRegion;
bFuncs->forceredraw=ForceRedraw;
bFuncs->getstringidentifier=NPN_GetStringIdentifierProc;
bFuncs->getstringidentifiers=GetStringIdentifiers;
bFuncs->getintidentifier=GetIntIdentifier;
bFuncs->identifierisstring=IdentifierIsString;
bFuncs->utf8fromidentifier=UTF8FromIdentifier;
bFuncs->intfromidentifier=IntFromIdentifier;
bFuncs->createobject=NPN_CreateObjectProc;
bFuncs->retainobject=NPN_RetainObjectProc;
bFuncs->releaseobject=NPN_ReleaseObjectProc;
bFuncs->invoke=NPN_InvokeProc;
bFuncs->invokeDefault=NPN_InvokeDefaultProc;
bFuncs->evaluate=Evaluate;
bFuncs->getproperty=NPN_GetPropertyProc;
bFuncs->setproperty=NPN_SetPropertyProc;
bFuncs->removeproperty=NPN_RemovePropertyProc;
bFuncs->hasproperty=NPN_HasPropertyProc;
bFuncs->hasmethod=NPN_HasMethodProc;
bFuncs->releasevariantvalue=NPN_ReleaseVariantValueProc;
bFuncs->setexception=SetException;

    bFuncs->size= sizeof(bFuncs);
//  bFuncs->version=(NP_VERSION_MAJOR << 8) + NP_VERSION_MINOR;
    bFuncs->version=20;
}

static void destroy(GtkWidget *widget, gpointer data) {
    gtk_main_quit ();
}

int main(int argc, char **argv)
{

    if(argc < 2) {
        printf("[-] Usage: %s <swfuri>\n", argv[0]);
        exit(-1);
    }

    URL = argv[1];

    gtk_init (&argc, &argv);
    main_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
    gtk_widget_set_usize (main_window, WINDOW_XSIZE, WINDOW_YSIZE);
    g_signal_connect (G_OBJECT (main_window), "destroy", G_CALLBACK (destroy), NULL);
    gtk_widget_realize(main_window);
    //gtk_window_fullscreen((GtkWindow *)main_window);
    gtk_widget_show_all(main_window);

    printf("[+] created GTK widget\n");

    flash_plugin_handle = loadFlashPluginSo();

    loadNPEntryPoints(flash_plugin_handle);
    printf("[+] initialized flash plugin entry points\n");

    initNPNetscapeFuncs(&browserFuncs);
    printf("[+] initialized browser functions\n");

    checkError("NP_Initialize", iNP_Initialize(&browserFuncs, &pluginFuncs));

    printPluginEntrypoints(&pluginFuncs);

    printBrowserEntrypoints(&browserFuncs);

    NPWindow *npwin = npwindow_construct(main_window);
    printf("[+] created NPWindow widget\n");

    NPP_t *instancep = (NPP_t *) malloc(sizeof(NPP_t));
    memset(instancep,0,sizeof(sizeof(NPP_t)));
    NPP instance = instancep;

    NPSavedData* saved = (NPSavedData*) malloc(sizeof(NPSavedData));
    memset(saved,0,sizeof(sizeof(NPSavedData)));

    stream = npstream_construct();
    uint16_t stype;
    NPObject object;

    char *xargv[]= {"allowscriptaccess", "quality", "wmode"};
    char *xargm[]= {"always", "best", "direct"};

    checkError("NPN_New", pluginFuncs.newp("application/x-shockwave-flash", instance, NP_EMBED, 3, xargv, xargm, 0));
    checkError("NPN_GetValue NPPVpluginScriptableNPObject", pluginFuncs.getvalue(instance, NPPVpluginScriptableNPObject, &object));

    checkError("NPN_SetWindow", pluginFuncs.setwindow(instance, npwin));
    checkError("NPN_NewStream", pluginFuncs.newstream(instance, "application/x-shockwave-flash", stream, 0, &stype));

    FILE *pp;
    char buffer[8192];
    pp = fopen(argv[1],"rb");
    int len;
    while((len=fread(buffer, 1, sizeof(buffer), pp)) != 0) {
        pluginFuncs.writeready(instance, stream);
        pluginFuncs.write(instance, stream, 0, len, buffer);
    }
    fclose(pp);

    checkError("NPN_DestroyStream",pluginFuncs.destroystream(instance, stream, NPRES_DONE));

    free(stream);
    gtk_main();

    checkError("NPN_Destroy",pluginFuncs.destroy(instance, &saved));
    checkError("NP_Shutdown", iNP_Shutdown());

    dlclose(flash_plugin_handle);
    return 0;
} 
```

# css - 是否有必要拥有有效的 CSS？

> ID：13131847
> 
> 赞同：9
> 
> 时间：2012-10-30T01:04:57.797
> 
> 标签：css

是否有必要拥有有效的 CSS？我正在使用 Twitter Bootstrap 进行快速 Web 开发，在通过 W3C CSS Validator 运行两个主要的 Bootstrap 样式表后，我注意到大约 600 个错误。

我的问题是，我的网站看起来不错，为什么 CSS 的有效性如此重要？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T02:31:52.323

是的，拥有有效的 CSS 是绝对必要的。CSS 是一种编程语言，因此，您必须遵循其语言规则。仅仅因为浏览器倾向于接受无效的 HTML 并尝试呈现它，它并不能使生成格式错误的 HTML 成为一种好习惯。CSS 也是如此，尽管 - 幸运的是 - CSS 规则比 HTML 规则要严格得多。

另一个原因是有效的 CSS 有保证的行为 - 如果您编写规则，您可以期望该规则以某种方式运行。（有缺陷的浏览器，除了所有版本的 IE。）如果您的 CSS 无效，您获得的任何行为都是未定义的，并且当您用于测试的任何浏览器发布补丁版本时，它可能会中断。您的 CSS 不一定会中断，但是当您编写无效的 CSS 时，您无法保证任何行为 - 您只是得到*一些*对您来说似乎正确但可能随时改变的行为。

如果您将正确的 CSS 与不正确的 CSS 混合在一起，浏览器往往会忽略无效部分（就像规范告诉它们的那样），但每个浏览器的处理方式略有不同。同样，虽然许多人建议使用 CSS hack，但出于上述原因，我会说不要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T01:10:01.130

CSS 不一定要有效才能工作。浏览器会简单地忽略它们不理解的 CSS。

验证 CSS 是一种测试它是否遵循规范的方法。如果是这样，任何与所用规范保持同步的浏览器都将理解 CSS。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-30T01:11:52.130

这确实是一个有争议的话题。W3C 工具当然很好用，但它们往往无法解释很多现代代码。自然，他们不仅很难推进标准，而且很难确保他们提供的工具对新的和创造性的代码负责。

为了让网站在所有浏览器和所有平台上看起来都很好，要求人们可能会超出“有效”的规范。即使CSS不是100％一尘不染，也很难反对一个完美的跨浏览器和平台的网站。那是我的两分钱。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-09T23:13:41.073

你的 CSS 不需要是有效的（取决于你问谁），但如果它是无效的，你应该有一个无效的原因：

```
audio,
canvas,
video {
  display: inline-block;
  *display: inline;
  *zoom: 1;
} 
```

由于属性开头的星号，验证器在此处出现解析错误。这是针对 Internet Explorer 的一个晦涩但公认的黑客攻击。其他浏览器会忽略它无法识别的属性，但 IE6/7 会读取带有星号的属性。

* * *

```
input:-moz-placeholder,
textarea:-moz-placeholder {
  color: #999999;
}

input:-ms-input-placeholder,
textarea:-ms-input-placeholder {
  color: #999999;
}

input::-webkit-input-placeholder,
textarea::-webkit-input-placeholder {
  color: #999999;
} 
```

这里的验证器错误是特定于供应商的伪类的结果。请注意，与无法识别的属性不同，如果浏览器无法识别选择器，则*整个规则*将被忽略，因此供应商占位符扩展需要是单独的规则。即使使用逗号运算符也会发生这种情况：

```
input::-moz-placeholder,
input::-ms-input-placeholder,
input::-webkit-input-placeholder, {
  color: #999999;
} 
```

除非它们识别所有三个供应商前缀，否则在*所有*浏览器中都将被忽略。

* * *

```
 filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fffbb450', endColorstr='#fff89406', GradientType=0); 
```

这是用于渐变的老式 IE 扩展。即使 IE 跟随它并且其他浏览器不会悄悄地忽略它，它也会在验证器中产生涟漪并导致许多错误。

* * *

```
width: auto\9; 
```

\9 是另一个针对 IE<=8 的 IE hack

* * *

最重要的是，如果您正在做一些非标准的事情，请确保您知道*为什么*要这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T01:08:31.987

现在有不同数量的浏览器有不同数量的版本。有些支持很多，但有些不支持。所以当你包含样式时，总是不可能100%完美。如果你的样式没有任何问题就可以了。但是当如果你遇到与 CSS 相关的问题，它会转到不同的浏览器，你必须小心，否则没问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T01:11:10.690

是的，重要的是，大多数浏览器在加载 html 页面时都遵循 w3c 标准。如果您的页面没有有效的 css，在不同的浏览器中它可能会以不同的方式出现。旧的 Internet Explorer 没有遵循 W3c 标准，这对开发人员来说成本很高，导致开发人员总是需要额外的 css 来让 IE 正确显示页面。

# css - 使用 CSS 在包含的 div 上显示两个带有背景图像的 div

> ID：13131849
> 
> 赞同：0
> 
> 时间：2012-10-30T01:05:21.803
> 
> 标签：css, html

如何使用 css 在包含 div 的背景图像上显示两个带有背景图像的 div，并为其背景图像提供颜色渐变？我正在尝试使用 asp.net 页面执行此操作，生成的 html 如下所示：

```
<div id="TopContainer>
    <div id="logos">
        <div id="logoOne" class="ImgContainer"></div>
        <div id="logoTwo" class="ImgContainerWide"><div>
    </div>
</div> 
```

相关的css如下所示：

```
/********************styles for bar across master page-logos,img containers etc.     ********************/
#TopContainer
{
    margin:0px;
    padding:0px;
    border-radius:15px;
}

#logos
{
    width:1024px;
    height:100px;
    border-radius:15px;
    color: -moz-linear-gradient(bottom, #297381, #FFFFFF);
    color: -ms-linear-gradient(bottom, #297381, #FFFFFF);
    color: -webkit-linear-gradient(bottom, #297381,#FFFFFF);
    background:-moz-linear-gradient(bottom, #297381,#FFFFFF);
    background:-ms-linear-gradient(bottom, #297381,#FFFFFF);
    background:-webkit-linear-gradient(bottom, #297381,#FFFFFF);

}

.ImgContainer
{
    background-image:url(~/images/company-logo.jpg);
    width:250px;
    opacity:0.55;
    border-radius:15px;
}

.ImgContainerWide
{
    background-image:url(~/images/company-logo.jpg);
    width:450px;
    opacity:0.55;
    border-radius:15px;
} 
```

由于某种原因，带有图像背景的 div 似乎根本没有出现，因为当我使用 Chrome 开发人员工具并使“logos” div 透明时，两个图像容器仍然不可见。预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:07:34.643

很可能它不起作用，因为 ~ 仅适用于 asp.net 服务器控件（服务器端），而不适用于客户端 CSS。如果它在您的 css 中的一个目录中，请改用它

```
background-image:url(../images/company-logo.jpg); 
```

通常 ~ 会带您进入根应用程序，因此如果您想进入根目录，只需使用 /：

```
background-image:url(/images/company-logo.jpg); 
```

最后，根据您的情况，您还可以使用绝对路径（而不是上面的相对路径），例如：

```
background-image:url(http://www.yourdomain.com/images/company-logo.jpg); 
```

# macos - 检测耳机的点击

> ID：13131850
> 
> 赞同：1
> 
> 时间：2012-10-30T01:05:22.790
> 
> 标签：macos

当我插入耳机并听 iTunes 时，按遥控器将播放/暂停音乐，按音量上下将调整 Mac 的系统音量。

我有一个可以播放媒体的应用程序，我想响应遥控器上的按键。我怎样才能做到这一点？当我按下遥控器时，我没有看到任何 NSEvents 发送到我的应用程序。

# html - Grails 无法处理图像名称中的空格

> ID：13131855
> 
> 赞同：0
> 
> 时间：2012-10-30T01:05:47.433
> 
> 标签：html, image, grails, gsp

我的应用程序需要存储和显示用户上传的图像，但是当图像的名称中有空格（或任何导致无效 url 的字符）时，它不会显示在网页中。

grails 生成的 HTML 保留了名称中的空格。我什至无法通过将空格替换为`%20`（错误 404，但图像确实存在，如果我删除空间，我可以访问它）直接进入图像

试图强制编码是没有用的，因为它仍然保留空格：

```
<g:img dir="someDir" file="${ image.encodeAsURL() }"/> 
```

我能做些什么来解决这个问题？

# map - 将 GPS 坐标映射到某个区域

> ID：13131860
> 
> 赞同：0
> 
> 时间：2012-10-30T01:06:08.117
> 
> 标签：map, gps, theory, geospatial, concept

我有设备在全国各地移动，它们会向我报告他们的 GPS 位置。我想做的是有一个系统将这些坐标映射到一个命名区域。

我看到了两种方法：

*   有一个数据库，将区域定义为在各种 GPS 坐标之间延伸的多边形。
*   使用可以为我提供信息的某种形式的网络服务。

要么都会好的。它根本不需要非常准确，因为我只需要知道所涉及的地区，这样我就知道如果设备出现问题，我应该打电话给哪个地区办事处。

在第一种方法中，您将如何构建包含数据的 SQL 表？以及将 GPS 坐标与定义区域之一匹配的方法是什么？需要定义的区域不会很多，而且它们会很大，因此手动输入定义区域的值不会有问题。

在第二种方法的情况下，有没有人知道一种以编程方式按需将这些信息从网络上拉下来的方法？（在这种情况下，我可能会选择 Perl WWW::Mechanize）。“靠近Somecity”就足够了。

-

PS：这不是“为我做这项工作”之类的问题，而是更多的头脑风暴请求。伪代码很好。关于这个主题的一般理论也很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T00:16:16.840

> 在第一种方法中，您将如何构建包含数据的 SQL 表？以及将 GPS 坐标与定义区域之一匹配的方法是什么？

假设：一个区域被定义为一个封闭的多边形。
您只需调用多边形内的点方法即可匹配 GPS 坐标，例如

```
boolean isInside =  polygon.contains(latitude, longitude); 
```

如果你的多边形很少，你可以对所有现有的多边形进行蛮力搜索。如果您有很多并且每个（一万）数千个点，您希望使用空间网格（如四叉树或 kd 树）来减少对相关多边形的搜索。

方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:42:39.477

这个过程称为反向地理编码，许多服务提供商，如 google、yahoo 和 esri 提供的服务将允许执行此操作

他们将返回最近的兴趣点或地址，但您可以保留您感兴趣的行政级别

检查使用条款以查看哪些服务与您的预期用途兼容

# ruby - 在 Sinatra 视图中访问 OmniAuth 助手

> ID：13131862
> 
> 赞同：2
> 
> 时间：2012-10-30T01:06:12.203
> 
> 标签：ruby, sinatra, omniauth, erb

我是新手，如果我是愚蠢的，请原谅我！

我正在使用[OmniAuth for Sinatra](https://github.com/charliepark/omniauth-for-sinatra)来帮助验证用户身份。在我的`layout.erb`中，我想访问`current_user`帮助程序以检查用户是否已登录。帮助程序是这样的：

```
def current_user
    @current_user ||= User.get(session[:user_id]) if session[:user_id]
end 
```

但我不确定如何在我的布局视图中访问它。我认为这可以解决问题：

```
<% if current_user %> Do stuff here <% end %> 
```

但没有运气。任何帮助，将不胜感激！就像我说的，我是 Ruby 新手，而且我不是一个强大的开发人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T01:10:11.050

您[需要在`helpers`block](http://www.sinatrarb.com/faq.html#helpview)中定义该方法，如下所示：

```
helpers do
  def current_user
    @current_user ||= User.get(session[:user_id]) if session[:user_id]
  end
end 
```

然后它将可用于视图。

# c - 指向指针的指针，值不更新

> ID：13131864
> 
> 赞同：0
> 
> 时间：2012-10-30T01:07:22.730
> 
> 标签：c, pointers

**全局.h**

```
typedef enum _global_list {
    TEST_VAR1,
    TEST_VAR2
} list;

/*Mapper between enum varibales and global variable*/
typedef struct _var_map{
    list list_type;
    void *ptr;
} var_map;

/*struct to hold global variable*/
typedef struct _glo_ptr{
    int *ptr1;
    float *ptr2;
} g_ptr;
g_ptr ptr;
void update_global(list ,void *); 
```

**全球.c**

```
#include "globals.h"

static var_map map[2] = { { TEST_VAR1, &(ptr.ptr1) }, { TEST_VAR2, &ptr.ptr2 } };

update_global(list var, void* ptr){

    if (map[0].list_type == TEST_VAR1){
        map[0].ptr =  ptr;
    }
} 
```

**测试文件.c**

```
#include "globals.h"
int main(){
    int test_var1=0;
    update_global(TEST_VAR1, &test_var1);
    test_var1=4;
    printf("%d",*ptr.ptr1); //should contain value 4
} 
```

我要做的是：我的`g_ptr`应该包含它所指向的最新值。但是在指向指针的指针中，我在某处犯了一些错误，导致没有正确更新值。例如：我的最终`g_ptr.ptr1`值应该包含 4。这需要更正什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:48:03.710

问题是您正在更改地图中的实际指针，但不影响指向的数据：

```
map[0].ptr =  ptr; 
```

应该：

```
*(int**)map[0].ptr =  (int*)ptr; 
```

你的程序背后的动机有点可疑，但我相信这会给你你正在寻找的东西......我会保持距离=）

哦，我注意到另一件事......你声明了`ptr`. 当您包含`global.h`在每个源文件中时，它们会`ptr`被视为私有静态变量。那不是你想要的。您需要像这样声明和定义它：

**全局.h**

```
extern g_ptr ptr; 
```

**全球.c**

```
g_ptr ptr; 
```

# asp.net-mvc - 在 MVC 中以固定的时间表运行控制器方法？

> ID：13131869
> 
> 赞同：3
> 
> 时间：2012-10-30T01:07:50.340
> 
> 标签：asp.net-mvc, scheduled-tasks, azure-web-roles

我们在现有的控制器中有一个现有的方法，我们想在特定的时间表（例如“每天凌晨 2 点”）调用它。该应用程序是一个在 Azure 上作为 Web 角色运行的 MVC3 应用程序，我们不想仅仅为了运行一小部分相同的逻辑而创建、维护和支付一个全新的角色（工作者角色）。

是否可以安排控制器方法在未来特定的预定时间触发？此外，相同的技术是否适用于常规的 ASP.NET 网络表单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:24:30.580

假设您可以使用 URL 调用此控制器操作，您可以... 1) 创建一个 PowerShell 脚本来“ping”网站： http: [//learn-powershell.net/2011/02/11/using-powershell -to-query-web-site-information/](http://learn-powershell.net/2011/02/11/using-powershell-to-query-web-site-information/) 2) 在凌晨 2 点运行的计划任务中通过远程桌面计划该 PowerShell 脚本

您还可以编写一个自动执行 #2 的部署脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T15:11:51.623

[您可以按照此处](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)所述使用 Phil Haack 的[WebBackgrounder](https://github.com/NuGet/WebBackgrounder)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T15:34:10.130

我已经在计划任务/powershell 不可用的共享托管环境中成功使用了 Cron 作业。

[这是一个](http://www.thesitewizard.com/general/set-cron-job.shtml)解释更多关于它的网站

# android - Android 按顺序播放声音

> ID：13131870
> 
> 赞同：1
> 
> 时间：2012-10-30T01:07:53.373
> 
> 标签：android

我目前正在尝试创建一个基于用户输入播放不同声音序列的 android 应用程序。有没有一种简单的方法来播放一系列声音我看过媒体播放器和声音池，但它看起来不像是为顺序设计的。

谢谢 RandyFreak，这可能是更好的方法。但实际上我最终做了一些不同的事情。

我创建了一个指向声音的文件描述符列表，并向媒体播放器添加了一个完整的侦听器。每次媒体播放器完成它的当前声音时，它都会播放列表中的第一个声音并将其从列表中删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:43:36.657

几个月前我遇到了这个问题。

我是如何克服这个问题的，我为每种声音创建了一个不同的媒体播放器，并按照我需要的顺序播放它们。

那将是最简单的方法。

我希望这有帮助

射频

# lucene - Ravendb 实时投影产生空值（Ravendb Lucene、Multimap、实时投影）

> ID：13131874
> 
> 赞同：2
> 
> 时间：2012-10-30T01:08:12.907
> 
> 标签：lucene, ravendb, multimap

首先，我为我的英语感到抱歉，如果我能非常简单地说出我的问题，我会很高兴。

我花了很多时间来解决多地图索引和实时投影问题。我在 stackoverflow、google、ayende 博客等上读了太多……但是无法解决我的问题。

**我想要什么：** 我有一个应用程序，想要一个类似推特的搜索，它是推特搜索框从多个来源搜索，例如推特内容、用户名和主题标签。当我得到结果时，我想将结果和形状索引结果的转换应用到 FullSearchResult 模型中。我也想找到找到结果的地方。在帖子中，在用户中还是在标签中？

**问题：** 我有 3 种类型的文档（帖子、用户、标签）和多图索引。当我使用 TransformResults 创建我的多图索引时，我得到的所有结果都是空值。（我通过全文搜索使用多图索引查询我的文档）。

**我的文档**

```
public class Post
{
    public string Id { get; set; }

    public long SqlDbId { get; set; }

    public string Title { get; set; }

    public string Content { get; set; }

    public string ContentAsHtml { get; set; }

    public Status Status { get; set; }

    public DenormalizedUser User { get; set; }

    public DenormalizedTagCollection Tags { get; set; }
}

public class User
{
    public string Id { get; set; }

    public string Name { get; set; }

    public string Surname { get; set; }

    public string Email { get; set; }

    public string MobileNumber { get; set; }
}

public class Tag
{
    public string Id { get; set; }

    public long SqlDbId { get; set; }

    public string TagName { get; set; }

    public DenormalizedUser TagInserterDenormalizedUser { get; set; }

    public bool IsSystemTag { get; set; }

    public Status Status { get; set; }
}

public class FullSearchIndex : AbstractMultiMapIndexCreationTask<FullSearchResult>
{
    public FullSearchIndex()
    {
        AddMap<Post>(posts => from post in posts
                              let tags = post.Tags
                              where post.Status == Status.Active
                              select new
                              {
                                  UserId = post.User != null ? post.User.Id.ToString() : (string)null,
                                  PostId = post.Id,
                                  TagIds = tags != null ? tags.Select(tag => tag.Id).ToArray() : new string[0],
                                  SearchQuery = new object[] 
                                  {                                      
                                      post.Title,
                                      post.Content,
                                      post.Tags != null ? tags.Select(x => x.TagName).ToArray() : new string[0]
                                  },
                                  Source = SearchResultSource.ResultIsFromPost
                              });

        AddMap<User>(users => from user in users
                              select new
                              {
                                  UserId = user.Id,
                                  PostId = (string)null,
                                  TagIds = new string[0],
                                  SearchQuery = new object[] 
                                  {                                      
                                      user.Name,
                                      user.Surname
                                  },
                                  Source = SearchResultSource.ResultIsFromUser
                              });

        AddMap<Tag>(tags => from tag in tags
                            where tag.Status == Status.Active
                            select new
                            {
                                UserId = (string)null,
                                PostId = (string)null,
                                TagIds = new string[] { tag.Id },
                                SearchQuery = new object[] 
                                {
                                    tag.TagName
                                },
                                Source = SearchResultSource.ResultIsFromTag
                            });

        Index(searchResult => searchResult.SearchQuery, FieldIndexing.Analyzed);

        TransformResults = (clientSideDatabase, results) =>
                                from result in results
                                let post = clientSideDatabase.Load<Post>(result.PostId)
                                let tags = clientSideDatabase.Load<Tag>(result.TagIds)
                                let user = clientSideDatabase.Load<User>(result.UserId)
                                select new
                                {
                                    PostId = post != null ? post.Id : (string)null,
                                    PostTitle = post != null ? post.Title : (string)null,
                                    PostContent = post != null ? post.Content : (string)null,
                                    PostTags = tags != null ? tags.Select(x => x.TagName).ToArray() : (string[])null,

                                    UserId = user != null ? user.Id : (string)null,
                                    UserName = user != null ? user.Name : (string)null,
                                    UserSurname = user != null ? user.Surname : (string)null,
                                    UserEmail = user != null ? user.Email : (string)null,
                                    UserMobileNumber = user != null ? user.MobileNumber : (string)null
                                };
    }
} 
```

当我使用多图索引和 lucene 搜索进行查询时，我有 4 个结果。但是，所有值都为空

```
query = "Tag50";
session.Query<FullSearchResult, FullSearchIndex>()
                        .Search(resultItem => resultItem.SearchQuery, query)
                        .As<FullSearchResultViewModel>()
                        .ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T08:34:05.997

Nkaya，您假设 TransformResults 的输入是地图的输出，但事实并非如此。TransformResults 的输入是实际的*文档*。地图的输出用于生成用于搜索的索引，而不是用于塑造转换结果的输入的样子。

# image-processing - 图像分割：如何隔离人体图和复杂的背景？

> ID：13131878
> 
> 赞同：2
> 
> 时间：2012-10-30T01:08:57.220
> 
> 标签：image-processing, opencv, image-segmentation

我需要在没有用户干预的情况下这样做。用户上传全身图像，服务器必须自动更改背景。我想我会使用 ImageMagik 来更改背景，但我不知道如何删除背景。我正在尝试 opencv+graphcut 但我不确定是否是一个解决方案。我知道这很困难，但我必须找到一个可行的解决方案。也许您知道一些服务可以做到这一点。你们都可以提出任何对我有真正帮助的方法或建议。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T23:19:44.417

如果您使用复杂的背景，那么您应该尝试 GrabCut。它是交互式的，因此您需要用户提供更多信息。

另请查看“ [1.1 交互式抠图的先前方法](http://research.microsoft.com/pubs/67890/siggraph04-grabcut.pdf)”部分。

# javascript - 表单元素不返回新值

> ID：13131880
> 
> 赞同：2
> 
> 时间：2012-10-30T01:09:34.567
> 
> 标签：javascript, forms, textinput

我正在尝试创建一个脚本，该脚本允许用户单击`div`带有`h1`'d 位文本的元素，然后将其替换`h1`为文本框和图形以在编辑后单击。单击图形后，`div`将用新编辑的文本替换文本框和图形`h1`。

以下是功能：

```
function savename() {
    var s = $('#mytextbox').val();
    $('#mydiv').replaceWith('<div id="mydiv" onclick="editname();"><h1>' + s + '</h1></div>');
}
function editname() {
    var strName = $('#mydiv').text();
    $('#mydiv').replaceWith($('<div id="mydiv"><input id="mytextbox" name="mytextbox" type="text" value="' + strName + '"><img id="mysavebutton" src="images/save.gif" onclick="savename();"></div>'));
} 
```

这是div：

```
<div id="mydiv" onclick="editname();"><h1>Some text I want to edit</h1></div> 
```

所以，`div`点击功能工作正常。它用文本框替换`h1`元素。当我单击保存图形时，它也可以正常工作，因为它会返回`h1`. 问题是，文本框的值应该是`h1`'d 文本。那部分不工作。它仍然保留旧值。在将其设置为“s”后，我发出了警报`.val()`，即使在编辑后它仍然显示旧值。我觉得我错过了一些简单的东西，但我整天都在和它斗争，需要一些新鲜的眼睛来替我看。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T02:52:55.110

与其替换 mydiv 并尝试重新创建 mydiv，不如在单击时隐藏 mydiv 并在尝试保存时更改 h1 标记的值？

在 html 中你可以有这样的东西：

```
<div id="mydiv">
    <h1 id="myoutput" onclick="editname();"> ... </h1>
    <input id="mytextbox" name="mytextbox" type="text" style="display:none;">
    <img id="mysavebutton" src="images/save.gif" onclick="savename();" style="display:none" /> 
</div> 
```

然后在javascript中：

```
function editname()
{
    var s = $('#myoutput').text();
    $('#myoutput').css('display', 'none');
    $('#mytextbox').val(s).css('display','inline');
    $('#mysavebutton').css('display', 'inline');
}
function savename()
{
    var s = $('#mytextbox').val();
    $('#myoutput').text(s).css('display', 'inline');
    $('#mytextbox').css('display', 'none');
    $('#mysavebutton').css('display', 'none');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T04:41:40.187

这对我有用，并且是原生 ES5 (ECMAScript 5 Spec) - 没有库

（[**小提琴**](http://jsfiddle.net/Tenru/)）

JavaScript：

```
document.addEventListener("DOMContentLoaded", function() {
    "use strict";

    var divElem = document.getElementById("div"),
        textInputElem = document.createElement("input"),
        buttonElem = document.createElement("input");

    textInputElem.type = "text";
    buttonElem.type = "button";
    buttonElem.value = "Apply";

    function removeChildren(elem) {
        while (elem.firstChild) {
            elem.removeChild(elem.firstChild);
        }
    }

    function divClick() {
        removeChildren(divElem);
        divElem.appendChild(textInputElem, divElem.firstChild);
        divElem.appendChild(buttonElem);
        divElem.removeEventListener("click", divClick, true);
    }

    buttonElem.addEventListener("click", function() {
        var textNode;

        if (textInputElem.value !== "") {
            removeChildren(divElem);
            textNode = document.createTextNode(textInputElem.value);
            divElem.appendChild(textNode);
            divElem.addEventListener("click", divClick, true);
        }
    }, false);
    divClick();
}, false); 
```

HTML：

```
<div id="div"></div>​ 
```

这是关于 Element.AddEventListener() 的 MDN 文档：[MDN: AddEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)

# java - Java - 某些组件区域只能点击？

> ID：13131882
> 
> 赞同：2
> 
> 时间：2012-10-30T01:09:36.183
> 
> 标签：java, components, region, clickable

所以我的问题是只有某些组件的某些区域是可点击的。我有这 3 个课程：

*   `TDUsersPanel`-- [https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDUsersPanel.java](https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDUsersPanel.java)
*   `TDSavedUsersPanel`-- [https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDSavedUsersPanel.java](https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDSavedUsersPanel.java)
*   `TDRegisterPanel`-- [https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDRegisterPanel.java](https://github.com/cats-/TD/blob/master/src/cats/td/gui/game/TDRegisterPanel.java)

下面是所有这些组合在一起的图像：

![可点击区域](../Images/efb2f5a3917f97eab10f626969e8a408.png)

但正如你所知道的，有粉红色区域（我在粉红色内添加），粉红色区域表示组件可点击的位置。例如，如果您查看注册按钮，您可能会注意到按钮顶部有一个粉红色区域，这意味着您只能单击粉红色区域范围内的按钮。您还可以在最右侧看到列表的粉红色区域，表明只有在粉红色区域的范围内单击它时，它才会按照应有的方式运行。

我的问题是，为什么它会这样？我希望它像任何其他组件一样发挥作用，我真的很好奇为什么它只能从那些特定区域做出正确反应。我已经考虑过可能存在某些组件重叠的可能性，但是在每个组件周围绘制边框之后，肯定没有任何重叠。

如果有人可以帮助我解决我的问题并告诉我任何可能的解决方案，将不胜感激，谢谢。

如果您有任何其他问题，请随时提出。

编辑：我做了一些小发现；我尝试向按钮添加鼠标侦听器并打印出按钮的边界以及我单击的位置。然后我添加了一个简单的 if 语句，说明如果按钮的边界包含我单击的点，则打印出如下语句：

```
System.out.println(registerButton.getBounds());
System.out.println(e.getPoint());
System.out.println(registerButton.getBounds().contains(e.getPoint())); 
```

这是一个示例输出：

```
java.awt.Rectangle[x=1,y=115,width=498,height=42]
java.awt.Point[x=383,y=47]
false 
```

正如你所看到的，没有输出语句说它在界限内。这很奇怪，因为这个鼠标监听器只添加到注册按钮，所以它只会在你点击注册按钮时触发。但这很奇怪，因为如果您通过查看注册按钮的边界和您单击的点来比较 y 值，它们会非常不同。您可以单击按钮的 y 值范围是 115 到 157。但是它表示鼠标位置的 y 值是 57，当然 57 < 115。所以没有重叠问题，只有一个抵消问题似乎。有人知道如何解决这个问题吗？

注意：我想我只是注意到了一些东西；我只在寄存器面板中添加了一个鼠标侦听器，并且只是在寄存器面板中添加了一个鼠标侦听器，然后我单击了寄存器面板的左上角（期望它是 0,0）但是当它打印出这个点时，它是（3,30 ) 所以这意味着有一个偏移量，并且由于这个偏移量，鼠标认为它不是它所在的某个地方，导致只有顶部区域是可点击的。但是现在我知道了问题所在，我不知道如何解决这个问题。任何想法将不胜感激。

# assembly - 是 mov rax,0x12345678; jmp rax 仍然会杀死分支预测？

> ID：13131883
> 
> 赞同：4
> 
> 时间：2012-10-30T01:09:48.953
> 
> 标签：assembly, x86-64, compiler-optimization, cpu-architecture, branch-prediction

我无法找到上述两个案例的特定信息，尽管听取了您的专家意见。

第一件事是：我知道间接 jmp 会伤害分支预测，并且即使间接的结果是恒定的，它仍然需要预测维护缓冲区和东西，所有这些都与绝对 jmp 相比。

我的问题是，如果有人知道：

```
mov rax, 1234567812345678h;
jmp rax; 
```

处理器的分支预测器仍然认为是间接的，或者在这种情况下它是否进行数学运算。我这样做是因为 x64 没有直接的“jmp absolute 64”指令，只有间接的。:/ ( [How to execute a call instruction with a 64-bit absolute address?](https://stackoverflow.com/questions/38961192/how-to-execute-a-call-instruction-with-a-64-bit-absolute-address)建议这个，如果你不能把跳转足够靠近目标并使用`jmp rel32`。)

* * *

其次，在这个程度上，jmp 0x1234 和 call 0x1234 之间是否有任何真正的区别（在处理器优化方面（指令缓存、预取器及其提示、分支预测））？（vc2012“速度优化”产生调用，“min_size opt”产生jmp，“混合优化”产生x64的jmp，x86的调用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T18:30:08.637

英特尔的分支目标（和分支）预测既非常复杂，又是一个保密的商业机密。不一定只有一种算法，也就是说，您可以预期预测机制会因 CPU 而异；这取决于英特尔希望针对给定处理器解决问题的晶体管数量。当然，除了英特尔，还有其他 x86 和 x64 处理器制造商。

历史分支目标预测机制——使用相同指令的过去运行来预测后续执行的目标——几乎肯定会预测该分支的正确目标，因为只有一个。因此，如果重新执行此代码序列（例如在循环中）并且它会在指令缓存中停留一段时间，它可能会得到很好的处理。（但是，在某些处理器上，如果另一个分支发生在其他地方导致哈希冲突，则分支目标预测机制可能会被类似于缓存行冲突的效果中和。）

一个更大的问题可能是，如果这样的序列大量出现在新加载到缓存中的代码中，它的处理效果如何，这取决于处理器的非基于历史的目标预测能力。这种（非历史的）分支目标预测可以很容易地确定给定此代码序列的分支位置，尽管它完全取决于制造商是否认为它值得任何给定处理器的裸片上的不动产。做出此类决定的因素包括功耗、权衡其他性能改进（即可能更好地使用相同裸片区域）以及此类和各种其他代码序列的预期频率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-14T20:32:32.273

“我知道间接 jmps 会伤害分支预测”

不，分支预测和间接跳转预测是不同的。此外，间接跳转用于基于表的 switch 语句和解释器中。这些是非常常见的用例，并出现在基准测试中。因此，英特尔和其他公司花费了大量的精力和大量的晶体管来提高它们的性能。一篇论文（写在问题之后！）甚至说从 Sandy Bridge 开始，当涉及到这种间接跳跃预测时，[你不应该相信民间传说。](https://ieeexplore.ieee.org/document/7054191)英特尔+AMD 有动力提高这种性能，他们也有。

现在，如果您的 jmp 示例是冷代码，如果这是第一次执行，则无法预测，实际上 Skylake 间接跳转预测器将预测跳转后的下一条指令并从那里推测。您可以使用非法指令 UD2 关闭该推测。在任何情况下，第二次执行 jmp （如果它仍在 BTB 中）分支目标将是正确的。

至于您的第二个问题，缓存效果无关紧要。我想较小的版本可以英勇地保存缓存行溢出，但仅此而已。硬件预取器用于数据，而不是指令。

# java - 对于嵌套树图的每个循环

> ID：13131890
> 
> 赞同：2
> 
> 时间：2012-10-30T01:10:19.850
> 
> 标签：java, treemap

我有一个嵌套的 treeMap 并且需要检查每个内部映射是否具有某个键。例如：

```
TreeMap<String,TreeMap<String,Integer>> map

for each loop {
//check if the inner map has the key in it
} 
```

我将如何格式化 for-each 循环？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T02:33:56.103

您可以使用`entrySet()`Map 的 来遍历映射中的条目，如下所示：

```
for (Map.Entry<String, TreeMap<String, Integer>> entry : map.entrySet())
{
    if (entry.getValue().containsKey(key)) {
        return entry.getValue().get(key);
    }
} 
```

或者您可以使用`values()`Map 的集合来遍历条目：

```
for (TreeMap<String, Integer> value : map.values())
{
    if (value.containsKey(key)) {
        return value().get(key);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T02:33:36.073

您可以使用两个嵌套的“foreach”循环遍历两个嵌套映射，如下所示：

```
for (Map.Entry<String,TreeMap<String,Integer>> entry1 : map.entrySet()) {
    Map<String,Integer> innerMap = entry1.getValue();
    if (innerMap.containsKey("my-key")) {
        System.out.println("Map at key "+entry1.getKey()+" contains 'my-key'");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T02:35:30.763

从外部映射中获取值，迭代每个内部的元素。在每个元素中，即 a `TreeMap<String,Integer>`，用于`containsKey`检查 map 元素是否包含所需的键。

```
 TreeMap<String,TreeMap<String,Integer>> map = 
                                  new TreeMap<String, TreeMap<String,Integer>>();
    for(TreeMap<String,Integer> mapElement: map.values()) {
        //check if the inner map has the key in it
        if(mapElement.containsKey("searchKey")){
            System.out.println("Match key found in this map element");
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T04:23:45.297

或者，您可以使用 Guava [TreeBasedTable](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/TreeBasedTable.html)，有许多方便的方法来处理您的嵌套数据结构。

```
TreeBasedTable<String, String, Integer> tb = TreeBasedTable.create();
tb.put("rowA", "colA", 1);
tb.put("rowB", "colB", 2);

tb.containsRow("rowA");
... 
```

# c++ - C++ __attribute__ 对齐的含义

> ID：13131893
> 
> 赞同：2
> 
> 时间：2012-10-30T01:11:12.190
> 
> 标签：c++, attributes, alignment

> **可能重复：**
> [GCC __attribute__((aligned(x)) 解释](https://stackoverflow.com/questions/841433/gcc-attribute-alignedx-explanation)
> [第一行中的“_attribute_((aligned(4)));”是什么意思？](https://stackoverflow.com/questions/7055495/what-is-meaning-of-the-attribute-aligned4-in-the-first-line)

这两段代码是什么意思？特别是`__attribute__ ((aligned(..)))`零件。

```
struct my_struct {
  int64_t a;
  int64_t b;
} __attribute__ ((aligned(16))); 
```

和

```
struct my_struct2 { double arr[4] __attribute__((aligned(64))); }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T02:42:08.443

CPU 寄存器通常指向内存。

当您增加一个寄存器时，它会在 64 位机器上进一步指向 64 位。但是，如果您想获取该部分中的一个字节，编译器必须做更多的工作。

如果您在内存的“边缘”上**对齐**内存，寄存器可以更快地访问它们。这也意味着结构成员被填充，因此浪费了一些空间。如果您对结构进行内存转储，您可能会对填充感到惊讶。

# iphone - 测试下一个应用版本的 IAP 内容？

> ID：13131894
> 
> 赞同：0
> 
> 时间：2012-10-30T01:11:34.763
> 
> 标签：iphone, ios, ios5, in-app-purchase

Apple 目前是否允许人们通过测试获取新的 IAP 内容`StoreKit`是否`IAP`适用于该应用程序的下一个未发布版本？

据我所知，`iTunes`Connect 明确警告您，`IAP`用于应用程序未来版本的新项目将始终被拒绝，并且您需要在提交下一个应用程序版本的同时提交这些项目以供审核。

有没有办法让那些未经审查的项目`StoreKit`在沙盒环境中可见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T05:58:21.560

要回答我自己的问题，您实际上可以从 StoreKit 中看到尚未审核的 IAP，这意味着您可以在 iTunes Connect 中声明这些项目后立即对其进行测试。

# android - 是否可以仅将 Facebook 移动 SDK 用于移动应用安装广告？

> ID：13131899
> 
> 赞同：1
> 
> 时间：2012-10-30T02:32:46.187
> 
> 标签：android, ios, facebook, mobile, ads

我目前没有在我的 Android 应用程序中使用 Facebook 的 Android SDK，我只想将它集成到足以通过 Facebook 移动应用程序安装广告捕获安装。

该[文档](https://developers.facebook.com/docs/tutorials/mobile-app-ads/)描述了“[c]在应用程序设置下完成您的基本页面”的需要。如果我输入我的应用程序的包名——并且只输入它的包名——我会得到一个错误：

> 您已指定包名称，但未指定类名称。启动原生 Android 应用程序需要两者。

我不想或不需要启动我的应用程序，是吗？我只想跟踪广告点击到应用安装（和运行）的转化率。我可以让**Promote**链接显示在左侧的唯一方法是提供**Class Name**和**Key Hash**的值并将**Facebook Login**设置为**Enabled**。这真的有必要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:38:05.487

是的，必须填写这些基本信息才能使用我们的 SDK，但是，这些字段仅用于通过 fb 进行登录验证 - 这是我们 SDK 最流行的用例。如果您提供这些字段，您的应用程序将不会启动或类似的事情。对于您的情况，只需填写它们并保持原样，您就可以投放广告而无需担心其他任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:41:18.410

API 需要这些字段。尽管根据我的经验，它不会启动您的应用程序。它仅用于 www.developer.facebook.com 中 Facebook 集成开发方面的凭据

希望有帮助。

射频

# html - 如何在导航栏中隐藏元素直到悬停在css中？

> ID：13131910
> 
> 赞同：0
> 
> 时间：2012-10-30T02:35:37.347
> 
> 标签：html, css, hover, menubar, navbar

我正在为网站制作导航栏。我以前从未做过，这就是我到目前为止所拥有的。在将鼠标悬停在第一部分之前，我不确定如何隐藏下拉部分。特别是对于我的代码，我希望`<dd>`隐藏属性，直到您将鼠标悬停在它的父`<dt>`元素上。现在它们一直在显示。谁能向我解释如何做到这一点？

这是我的代码：

```
<html><head>

<style type='text/css'>
body {
    padding-top: 6px;
}

/*  menubar start  */
#menubar {
    background: -webkit-gradient(radial, center center, 0, center center, 460, from(#5c5c5c), to(#1f1f1f));
    background: -webkit-radial-gradient(circle, #5c5c5c, #1f1f1f);
    background: -moz-radial-gradient(circle, #5c5c5c, #1f1f1f);
    background: -ms-radial-gradient(circle, #5c5c5c, #1f1f1f);
    position: relative;
    display: block;
    height: 36px;
}

#menubar dl {
    position: absolute;
    z-index: 9005;
    list-style: none;
    width: 110px;
    top: -16px;
}

#Home { left: 240px; }
#Projects { left: 400px; }
#Hack { left: 560px; }
#About { left: 720px; }
#Contact { left: 880px; }

#menubar dt a {
    display: block;
    float: left;
    width: 100%;
    height: 20px;
    padding-left: 24.75px;
    padding-right: 24.75px;
    padding-top: 8px; 
    padding-bottom: 8px;
    border-radius: 2px;
    background-color: transparent;
    font-family: 'Trebuchet MS', sans-serif;
    text-decoration: none;
    text-align: center;
    color: #ffffff; 
}

#menubar dt a:hover {
    background-color: #828282;
    color: #000000; 
}

#menubar dd {
    float: left;
    height: 100%;
    width: 100%; 
    margin: 0;
}

#menubar dd a {
    display: block;
    width: 100%;
    height: 100%;
    padding-left: 24.75px;
    padding-right: 24.75px;
    padding-top: 8px;
    padding-bottom: 8px;
    background-color: #5c5c5c;
    color: #ffffff;
    text-align: center;
    text-decoration: none;
    font-family: 'Trebuchet MS', sans-serif; 
}

#menubar dd a:hover {
    background-color: #828282;
    color: #000000;
}
/*  menubar end  */
</style>
</head><body>

<div id='menubar'>
    <dl id='Home'>
        <dt><a href='#'>Home</a></dt>
    </dl>
    <dl id='Projects'>
        <dt><a href='#'>Projects</a></dt>
        <dd><a href='#'>Mini Projects</a></dd>
        <dd><a href='#'>In Progress</a></dd>
        <dd><a href='#'>Help</a></dd>
    </dl>
    <dl id='Hack'>
        <dt><a href='#'>Hack</a></dt>
        <dd><a href='#'>Information</a></dd>
        <dd><a href='#'>Tutorials</a></dd>
        <dd><a href='#'>Challenges</a></dd>
    </dl>
    <dl id='About'>
        <dt><a href='#'>About</a></dt>
    </dl>
    <dl id='Contact'>
        <dt><a href='#'>Contact Us</a></dt>
    </dl>
</div>

<span id='lights' style="font-family: 'Trebuchet MS', sans-serif; font-size: 85%; color: #636363; line-height: 20%"><br>
Lights: On 
<input type='radio' name='lis' value='on' id='LOn' onclick='setL(true)'>
  Off 
<input type='radio' name='lis' value='off' id='LOff' onclick='setL(false)'>
</span>

</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:54:38.317

`display:none`从enhzflep 建议的隐藏元素开始。然后你可以使用 jquery 来显示和隐藏下拉菜单。

[这是一个小提琴](http://jsfiddle.net/pdwce/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:48:19.690

如果将这些样式添加到 CSS 中，它会起作用。基本上，他们说 dd 元素的默认状态是隐藏的。如果一个 dl 元素被悬停，那么它的 dd 子元素是可见的。

```
dl dd
{
    display: none;
}

dl:hover dd
{
    display: block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T11:03:41.667

```
#menubar dd {
display:none;
float: left;
height: 100%;
width: 100%; 
margin: 0;
}

<script>
$("#menubar dl,#menubar dl dd").hover(function(){
   $("#menubar dl dd").slideDown();
 }, function(){
  $("#menubar dl dd").slideUp();
 });
 </script> 
```

​</p>

[JSFIDDLE](http://jsfiddle.net/pdwce/2/)

# ios - iphone 4s - UIImage CGImage 图像尺寸

> ID：13131911
> 
> 赞同：1
> 
> 时间：2012-10-30T02:35:41.887
> 
> 标签：ios, uiimage, size, cgimage

我的崩溃只发生在 4S 上（不在 3GS 上）。我怀疑它是因为@2x。基本上我得到图像的原始字节并进行操作。这是我的问题。

我加载了下面示例代码中提到的图像。最后，uiWidth 应该是 2000，cgwidth 应该是 2000。对吗？（如果图像是从相机胶卷加载的，它仍然是真的吗？或者它的自动缩放和 uiWidth 将是 4000？）

```
//test.jpg is 2000x 1500 pixels.
NSString *fileName = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"jpg"];
UIImage *image = [UIImage imageWithContentsOfFile:fileName];

int uiWidth = image.size.width;

CGImageRef cgimg = image.CGImage;

int cgWidth = CGImageGetWidth(cgimg); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-30T03:01:48.393

`size`报告的单位是`UIImage`点，而不是像素。您需要考虑`scale`.`UIImage`

换句话说，如果`test.jpg`是 1000x1000 那么`UIImage.size`将报告 1000x1000。如果`test@2x.png`是 2000x2000，那么`UIImage.size`也会报告 1000x1000。但在第 2 种情况下，`UIImage.scale`将报告 2。

`CGImageGetWidth`以像素为单位报告其宽度，而不是点数。

# testng - TestNG 重试失败的测试不会输出正确的测试结果

> ID：13131912
> 
> 赞同：14
> 
> 时间：2012-10-30T02:36:06.830
> 
> 标签：testng

**设置：** 我有一个扩展 IRetryAnalyzer 的类，并实现了一个简单的重试逻辑，覆盖了以下方法： public boolean retry(ITestResult result) {

我有另一个扩展类 TestListenerAdapter 的类，它重试失败的测试，直到它们通过或报告失败。我已经实现了覆盖以下方法的逻辑： public void onTestFailure(ITestResult result) {

**场景：** 我总共有 10 个测试。10 次测试中有 1 次失败 2 次，并使用我的重试逻辑在第 3 次尝试中通过。测试结果显示如下：总测试：12，失败：2，跳过：0

我想要的是输出正确数量的测试运行。并且也忽略了自测试结束以来的 2 次失败。所以结果应该是这样的：Total tests: 10, Failed:0, Skipped: 0

我在这里想念什么？我需要修改 ITestResult 对象吗？如果是，如何？

仅供参考：我能够使用 JUnit（实现 TestRule 接口）来实现这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-22T07:55:47.193

请考虑以下最大测试结果。2 次重试：

1.  通过 => 总体还行！
2.  失败，通过 => 总体还行！
3.  失败，失败，通过 => 总体还行！
4.  失败，失败，失败 => 整体失败！

我所做的是创建一个 TestNg 侦听器，它扩展了默认行为并在所有测试完成后做一些魔术。

```
public class FixRetryListener extends TestListenerAdapter {

    @Override
    public void onFinish(ITestContext testContext) {
        super.onFinish(testContext);

        // List of test results which we will delete later
        List<ITestResult> testsToBeRemoved = new ArrayList<>();

        // collect all id's from passed test
        Set <Integer> passedTestIds = new HashSet<>();
        for (ITestResult passedTest : testContext.getPassedTests().getAllResults()) {
            passedTestIds.add(TestUtil.getId(passedTest));
        }

        Set <Integer> failedTestIds = new HashSet<>();
        for (ITestResult failedTest : testContext.getFailedTests().getAllResults()) {

            // id = class + method + dataprovider
            int failedTestId = TestUtil.getId(failedTest);

            // if we saw this test as a failed test before we mark as to be deleted
            // or delete this failed test if there is at least one passed version
            if (failedTestIds.contains(failedTestId) || passedTestIds.contains(failedTestId)) {
                testsToBeRemoved.add(failedTest);
            } else {
                failedTestIds.add(failedTestId);
            }
        }

        // finally delete all tests that are marked
        for (Iterator<ITestResult> iterator = testContext.getFailedTests().getAllResults().iterator(); iterator.hasNext(); ) {
            ITestResult testResult = iterator.next();
            if (testsToBeRemoved.contains(testResult)) {
                iterator.remove();
            }
        }

    }

} 
```

基本上我做两件事：

1.  收集所有通过的测试。如果我遇到至少一个通过测试的失败测试，​​我会删除失败的测试（这将涵盖上面的案例 2 和 3）
2.  遍历所有失败的测试。如果我遇到以前失败的失败测试，​​我会删除当前失败的结果。（这实际上涵盖了案例 3​​ 和 4）。这也意味着如果有几个失败的结果，我只会保留第一个失败的结果。

为了识别测试结果，我使用以下简单的哈希函数：

```
public class TestUtil {

    public static int getId(ITestResult result) {
        int id = result.getTestClass().getName().hashCode();
        id = 31 * id + result.getMethod().getMethodName().hashCode();
        id = 31 * id + (result.getParameters() != null ? Arrays.hashCode(result.getParameters()) : 0);
        return id;
    }
} 
```

这种方法也适用于数据提供者，但有一个小限制！如果您使用具有随机值的数据提供者，您会遇到问题：

```
@DataProvider(name = "dataprovider")
public Object[][] getData() {
    return new Object[][]{{System.currentTimeMillis()}};
} 
```

对于失败的测试，将重新评估数据提供者。因此，您将获得一个新的时间戳，并且相同方法的 result1 和 result2 将产生不同的哈希值。解决方案是在 getId() 方法中包含 parameterIndex 而不是参数，但似乎 ITestResult 中不包含这样的值。

将此简单示例视为概念证明：

```
@Listeners(value = FixRetryListener.class)
public class SimpleTest {

    private int count = 0;

    @DataProvider(name = "dataprovider")
    public Object[][] getData() {
        return new Object[][]{{"Run1"},{"Run2"}};
    }

    @Test(retryAnalyzer = RetryAnalyzer.class, dataProvider = "dataprovider")
    public void teste(String testName) {
        count++;
        System.out.println("---------------------------------------");
        System.out.println(testName + " " + count);
        if (count % 3 != 0) {
            Assert.fail();
        }

        count = 0;
    }

} 
```

将产生：

```
Total tests run: 2, Failures: 0, Skips: 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-17T16:19:33.190

我试过了，试过了，试过了。但现在终于奏效了

**MyRetryAnalyzer.java**

```
import org.testng.IRetryAnalyzer;
import org.testng.ITestResult;

import java.util.concurrent.atomic.AtomicInteger;

public class MyRetryAnalyzer implements IRetryAnalyzer {
private static int MAX_RETRY_COUNT = 3;

AtomicInteger count = new AtomicInteger(MAX_RETRY_COUNT);

public boolean isRetryAvailable() {
    return (count.intValue() > 0);
}

@Override
public boolean retry(ITestResult result) {
    boolean retry = false;
    if (isRetryAvailable()) {
        System.out.println("Going to retry test case: " + result.getMethod() + ", " + (MAX_RETRY_COUNT - count.intValue() + 1) + " out of " + MAX_RETRY_COUNT);
        retry = true;
        count.decrementAndGet();
    }
    return retry;
}
} 
```

**MyTestListenerAdapter.java**

```
import org.testng.*;

import java.util.*;

public class MyTestListenerAdapter extends TestListenerAdapter {
    @Override
    public void onTestFailure(ITestResult result) {
        if (result.getMethod().getRetryAnalyzer() != null) {
            MyRetryAnalyzer retryAnalyzer = (MyRetryAnalyzer)result.getMethod().getRetryAnalyzer();

            if(retryAnalyzer.isRetryAvailable()) {
            } else {
                result.setStatus(ITestResult.FAILURE);
            }
            Reporter.setCurrentTestResult(result);
        }
    }

@Override
    public void onFinish(ITestContext context) {
        Iterator<ITestResult> failedTestCases =context.getFailedTests().getAllResults().iterator();
        while (failedTestCases.hasNext()) {
            System.out.println("failedTestCases");
            ITestResult failedTestCase = failedTestCases.next();
            ITestNGMethod method = failedTestCase.getMethod();
            if (context.getFailedTests().getResults(method).size() > 1) {
                System.out.println("failed test case remove as dup:" + failedTestCase.getTestClass().toString());
                failedTestCases.remove();
            } else {

                if (context.getPassedTests().getResults(method).size() > 0) {
                    System.out.println("failed test case remove as pass retry:" + failedTestCase.getTestClass().toString());
                    failedTestCases.remove();
                }
            }
        }
    }
} 
```

**你测试类**

```
@Listeners(value = MyTestListenerAdapter.class)

public class Test  {

//Your data provider
@DataProvider

@Test(retryAnalyzer = MyRetryAnalyzer.class)
public void testMethod () {
    //your code goes here
 }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-21T21:37:58.427

我的方法建立在[Morvader 的答案](https://stackoverflow.com/a/29127322/4048904)之上，但增加了定义重试分析器的能力，这些分析器符合实际未通过测试的初衷，即使该方法在重试后通过了也是如此。

我也没有发现需要倾向于 onFinish() 方法中的测试数量，这些数字在*maven-surefire-plugin 2.18 版中似乎很好*

**重试监听适配器**

```
public class RetryListenerAdapter extends TestListenerAdapter {

    @Override
    public void onTestFailure(ITestResult tr) {
        IRetryAnalyzer retryAnalyzer = tr.getMethod().getRetryAnalyzer();
        if (retryAnalyzer == null || !(retryAnalyzer instanceof IRetryAnalyzerWithSkip)) {
            super.onTestFailure(tr);
        } else if (((IRetryAnalyzerWithSkip) retryAnalyzer).isRetryable()) {
            tr.setStatus(ITestResult.SKIP);
            super.onTestSkipped(tr);
        } else {
            super.onTestFailure(tr);
        }
    }
} 
```

**IRetryAnalyzerWithSkip**

```
public interface IRetryAnalyzerWithSkip extends IRetryAnalyzer {
    boolean isRetryable();
} 
```

**重试**

```
public class Retry implements IRetryAnalyzerWithSkip {
    private int retryCount = 0;
    private int maxRetryCount = 3;

    public boolean retry(ITestResult result) {

        if (retryCount < maxRetryCount) {
            retryCount++;
            return true;
        }
        return false;
    }

    @Override
    public boolean isRetryable() {
        return retryCount < maxRetryCount;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-18T16:21:37.140

我使用这种方法：

**监听器适配器**：

```
public class MyTestListenerAdapter extends TestListenerAdapter {
    @Override
    public void onTestFailure(ITestResult result) {
        if (result.getMethod().getRetryAnalyzer() != null) {
            MyRetryAnalyzer retryAnalyzer = (MyRetryAnalyzer)result.getMethod().getRetryAnalyzer();

            if(retryAnalyzer.isRetryAvailable()) {
                result.setStatus(ITestResult.SKIP);
            } else {
                result.setStatus(ITestResult.FAILURE);
            }
            Reporter.setCurrentTestResult(result);
        }
    }

   @Overrride
   public void onFinish(ITestContext context) {
     Iterator<ITestResult> failedTestCases =context.getFailedTests().getAllResults().iterator();
    while (failedTestCases.hasNext()) {
        System.out.println("failedTestCases");
        ITestResult failedTestCase = failedTestCases.next();
        ITestNGMethod method = failedTestCase.getMethod();
        if (context.getFailedTests().getResults(method).size() > 1) {
            System.out.println("failed test case remove as dup:" + failedTestCase.getTestClass().toString());
            failedTestCases.remove();
        } else {

            if (context.getPassedTests().getResults(method).size() > 0) {
                System.out.println("failed test case remove as pass retry:" + failedTestCase.getTestClass().toString());
                failedTestCases.remove();
            }
        }
    }
   }
} 
```

**重试分析器**：

```
public class MyRetryAnalyzer implements IRetryAnalyzer {
    private static int MAX_RETRY_COUNT = 3;

    AtomicInteger count = new AtomicInteger(MAX_RETRY_COUNT);

    public boolean isRetryAvailable() {
        return (count.intValue() > 0);
    }

    @Override
    public boolean retry(ITestResult result) {
        boolean retry = false;
        if (isRetryAvailable()) {
            System.out.println("Going to retry test case: " + result.getMethod() + ", " + (MAX_RETRY_COUNT - count.intValue() + 1) + " out of " + MAX_RETRY_COUNT);
            retry = true;
            count.decrementAndGet();
        }
        return retry;
    }
} 
```

**POM.xml -> Surefire 配置：**

这是您应该配置“覆盖”肯定火侦听器的地方，它有自己的计数器。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <version>2.18.1</version>
  <configuration>
    <suiteXmlFiles><suiteXmlFile>${basedir}/testng.xml</suiteXmlFile></suiteXmlFiles>
 <properties> 
   <property>
    <name>listener</name>
    <value>Utils.MyTestListenerAdapter,Utils.MyRetryAnalizer</value>
   </property>
 </properties> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-27T21:20:51.530

在最新版本的 TestNG 7.1.0 中，无需在您的重试分析器中执行任何额外的魔法即可修复此问题。重试的测试现在将被标记为“重试”，您可以 `emailable-report.html`在运行后生成的报告中看到这一点。如果您仍然想在重试测试时对测试执行一些逻辑，您可以这样做：

```
@AfterMethod(alwaysRun = true)
    public void afterMethod( ITestResult result) throws Exception {
            if (result.wasRetried()){
                //your logic here
            } 
```

# asp.net - 用于日志记录的最佳 IFormatProvider 是什么？

> ID：13131913
> 
> 赞同：2
> 
> 时间：2012-10-30T02:36:23.120
> 
> 标签：asp.net, .net

我有一个使用 Common.Logging 进行日志记录的可安装 ASP.Net 应用程序。

编写日志消息时，即：

```
_log.InfoFormat(CultureInfo.???, "{0}: Writing to the Log", DateTime.UtcNow); 
```

我对应该使用哪种文化感到困惑。我想要的结果是使用服务器的区域设置格式化日志消息。这样，当管理员安装应用程序时，他们就可以控制日志消息的格式。

有四个选项，但似乎没有一个是正确的选择：

*   CultureInfo.CurrentCulture：这似乎是 Windows 应用程序的正确选择，但 ASP.Net 正在更改它以匹配浏览网站的用户 - 因此它适合格式化内容以显示给用户，但不适用于写入日志.
*   CultureInfo.CurrentUICulture：与 CurrentCulture 类似的问题 - 将匹配当前浏览网站的用户。
*   CultureInfo.InstalledUICulture：系统安装的文化 - 似乎与安装的 Windows 副本有关，但用户无法更改。显然这个有点[没用](http://www.siao2.com/2005/03/25/402313.aspx)
*   CultureInfo.InvariantCulture：这不是用户可配置的。我想知道这是否是这里四个选项中最好的一个，因为至少它是一致的，并且不会因浏览网站的人/安装媒体窗口的人而异。

我想知道是否需要在我的 web.config 中为系统文化添加显式配置，以便安装程序可以选择一种文化。我真正想要的答案是在 ASP.Net 更改它以匹配当前用户之前 CultureInfo.CurrentCulture 是什么。

注意：我知道我可以关闭 ASP.Net，更改每个用户的 CurrentCulture，但 UI 依赖于这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:41:46.560

管理员喜欢控制日志。告诉他们去配置他们的服务器文化，以便日志采用特定格式对我来说似乎不是最好的解决方案。

在 web.config 中添加配置选项是个好主意。这将让管理员根据需要配置日志格式。

无需询问用户，您可以在安装时使用`CultureInfo.CurrentCulture`. 如果用户希望它是不同的东西，他总是可以改变它。

如果您确实想从配置中获取它`CultureInfo.CurrentCulture`而不是配置，您可以在`Application_Start`事件期间选择它，并将其保存在应用程序上下文中。

# c - 在 Linux 中收集具有不同参数的 C 代码的输出

> ID：13131914
> 
> 赞同：0
> 
> 时间：2012-10-30T02:36:36.880
> 
> 标签：c, linux

我有这段代码在控制台上产生一些带有 printf 语句的输出。当我使用不同的变量多次运行此代码时，我想以某种方式将数据收集到一个 .txt 文件中，例如，如果我的程序被称为“produce”，我想获得以下输出：

```
./产生0
./产生 1
./产生2

```

等等。有什么方法可以自动化吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T07:43:29.713

您可以为此编写一个简单的 shell 脚本。

```
for i in 1 2 3 4 5 6 7 8 9 10
do
echo "Output of produce for $i" >> output.txt
./produce $i >> output.txt
done 
```

将上面的代码放在像 test.sh 这样的文件中。然后在控制台上运行命令`sh test.sh`，您应该会看到文件 output.txt 被创建，其中包含所需的输出。

确保在每次运行脚本之前重命名 output.txt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T07:57:16.217

如果您对外壳感到紧张，那么只需修改您的代码以写入使用输入参数命名的文件。

有关如何写入文件的信息，请参阅[此页面。](http://www.cprogramming.com/tutorial/cfileio.html)

```
FILE *outputFile;
outputFile = fopen(strcat(strcat('output_', argv[1]), '.txt, "wt");  // output_0.txt, output_1.txt, etc 
```

全部替换`printf(`为`fprintf(outputFile,`，仅此而已。

# php - Strip_tags PHP MySQL 不工作

> ID：13131915
> 
> 赞同：-3
> 
> 时间：2012-10-30T02:37:33.197
> 
> 标签：php, html, mysql

我无法让它工作我想确保如果用户在表单中的文本字段中添加 HTML 标记或 PHP 标记，它们不会被添加到数据库中。我现在的代码将 strip_tags 与 HTML 和 PHP 标记一起添加到数据库中。

这是我的代码：

```
 <?php
      //Check for Valid Email
function valid_email($email) {
    return filter_var($email, FILTER_VALIDATE_EMAIL);
}

    //Add people Information to Database 
function addToDB ($sql, $con) {
require 'db.php';

    $sql= ("INSERT INTO people (name,email) VALUES(
            'strip_tags($_POST[name])', 
           '($_POST[email])')");

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }

mysql_close($con);
}

    //Add vehicle Information to Database
function addToDB1 ($sql, $con) {
require 'db.php';

$sql="INSERT INTO vehicle (year, make, model, color)
VALUES
('$_POST[year]','$_POST[make]', '$_POST[model]', '$_POST[color]')";
if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }

mysql_close($con);
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T00:11:11.373

**不能像在双引号字符串上显示变量那样在字符串中调用函数！**

所以你的查询需要是这样的：

```
$sql= 'INSERT INTO people (name,email) VALUES(\''.strip_tags($_POST[name]).'\', \''.$_POST[email].'\')'; 
```

顺便说一句，您真的应该考虑转义来自 post/get 变量的输入数据！就像是：

```
$sql= 'INSERT INTO people (name,email) VALUES(\''.mysql_real_escape_string(strip_tags($_POST[name])).'\', \''.$_POST[email].'\')'; 
```

然而，最好的选择是使用准备好的语句来防止 sql 注入！

* * *

Eidt：如果您使用字符串中的变量，请使用 {$_POST[email]} 而不是 ($_POST[email]) 来保持您的变量名一致！

# winforms - 如何使选项卡控件上的水平滚动按钮更大？

> ID：13131919
> 
> 赞同：0
> 
> 时间：2012-10-30T02:38:44.407
> 
> 标签：winforms

我正在使用一个`System.Windows.Forms.TabControl`. 我将它用于触摸屏界面，当 中有很多选项卡时`TabControl`，顶部右侧的滚动箭头`TabControl`太小而无法触摸。如何调整它们的大小以使它们更大？

编辑：我已`Multiline`设置为 false，以便为我的应用程序启用更多屏幕空间。如果我需要将其更改回`true`，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:21:11.950

Multiline 可能是这里最好的选择。或者，您可以自己制作两个按钮，将它们调整为所需的大小并将它们绑定到以下内容：

**左（或在页面中向下）：**

```
if (tabControl1.SelectedTab != tabControl1.TabPages[0])
{
    tabControl1.SelectedTab = tabControl1.TabPages[tabControl1.SelectedTab.TabIndex - 1];
} 
```

**右（或上）：**

```
if(tabControl1.SelectedTab != tabControl1.TabPages[tabControl1.TabPages.Count - 1])
{
    tabControl1.SelectedTab = tabControl1.TabPages[tabControl1.SelectedTab.TabIndex + 1];
} 
```

我只使用了两个按钮，我可以相应地翻页并控制它们的样式。

# php - PHP JSON 和 Twitter

> ID：13131920
> 
> 赞同：1
> 
> 时间：2012-10-30T02:38:49.180
> 
> 标签：php, json, api, twitter

```
<?
$Tweet = file_get_contents("http://api.twitter.com/1/statuses/user_timeline.json?screen_name=EdVizenor&count=1");

//$Tweet = explode(",",$Tweet);
/// If I explode and echo the $Tweet(3); i get .... "text":"mY LATEST TWEET"

var_dump(json_decode($Tweet,true));
?> 
```

我想要做的是通过键解析出数组。就像是：

```
echo $Tweet(text);  /// but this does not work. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T02:46:04.023

知道错误是什么会很有帮助。问题是这`$Tweet(text)`将调用包含在 中的函数`$Tweet`，因为该变量不是函数，而是实际的数组，您实际上只需要

```
<?php
// your code
$tweets = json_decode($Tweet,true);
echo $tweets[0]['text']; 
```

下一次，一定要把抛出的错误包括在内，这对你阅读和理解这些很有帮助！

# module - RequireJS递归模块加载

> ID：13131923
> 
> 赞同：0
> 
> 时间：2012-10-30T02:39:55.180
> 
> 标签：module, requirejs

我有 2 个模块 A 和 B。我还有 3 个库 L1、L2 和 L3。

**模块 A**：

```
define(
    ['L1', 'L2'],
    function (L1, L2) { ... }
); 
```

**模块 B**：

```
define(
    ['A', 'L3'],
    function (A, L3) { ... }
); 
```

**我是对的，模块 B 已经在范围内具有 L1 和 L2 库还是我必须重新包含这些库？**

*模块 B*：

```
define(
    ['A', 'L1', 'L2', 'L3'],
    function (A, L1, L2, L3) { ... }
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:42:50.483

如果要在其中使用这些库，`Modulue B`则必须在定义中明确命名它们。

```
define(['A', 'L1', 'L2', 'L3'], function (A, L1, L2, L3) {

    // ...
}); 
```

如果您不想使用它们，这没关系：

```
define(['A', 'L3'], function (A, L3) {

    // L1 undefined here
}); 
```

# ios - 我可以解决的 connectionDidFinishLoading 错误

> ID：13131925
> 
> 赞同：0
> 
> 时间：2012-10-30T02:40:30.950
> 
> 标签：ios, json, nsdictionary, nsjsonserialization, nsmutabledata

我有一个简单的 JSON 数组，它是从传递给第三方服务的邮政编码返回的。

[http://api.geonames.org/findNearbyPostalCodes?postalcode=94115&country=US&radius=5&username=frequentz](http://api.geonames.org/findNearbyPostalCodes?postalcode=94115&country=US&radius=5&username=frequentz)

尝试反序列化结果时出现未知错误，我不确定出了什么问题。

这是我的 connectionDidFinishLoading 方法，它按预期触发但总是失败......我在最后一个 else if 中得到错误。想法？

```
-(void) connectionDidFinishLoading:(NSURLConnection *)connection {

NSLog(@"connectionDidFinishLoading...");

self.zipCodes = [NSMutableArray array];

NSError *error = nil;

id jsonObject = [NSJSONSerialization JSONObjectWithData:receivedData options:NSJSONReadingAllowFragments error:&error];

if (jsonObject != nil && error == nil) {

    NSLog(@"Successfully deserialized...");

    if ([jsonObject isKindOfClass:[NSDictionary class]]) {

        NSDictionary *deserializedDictionary = (NSDictionary *)jsonObject;
        NSLog(@"Deserialized JSON Dictionary = %@", deserializedDictionary);

        for (NSDictionary *item in jsonObject) {

          NSString *city = [item objectForKey:@"adminName2"];
          NSString *stateAbbreviation = [item objectForKey:@"adminCode1"];
          NSString *postalCode = [item objectForKey:@"postalCode"];
          NSString *distance = [item objectForKey:@"distance"];
          NSString *country = [item objectForKey:@"country"];
          NSString *stateName = [item objectForKey:@"stateName"];

          ZipCodes *zipCode = [[ZipCodes alloc] initWithName:city stateAbbrev:stateAbbreviation postalCode:postalCode distanceFromGPSZip:distance country:country stateFullName:stateName];

          [self.zipCodes addObject:zipCode];
        }
    }
    else if ([jsonObject isKindOfClass:[NSArray class]]){
        NSArray *deserializedArray = (NSArray *)jsonObject;
        NSLog(@"Deserialized JSON Array = %@", deserializedArray);
    }
    else {
        /* Some other object was returned. We don't know how to deal
         with this situation as the deserializer returns only dictionaries or arrays */
    }
}
else if (error != nil){
    NSLog(@"An error happened while deserializing the JSON data.");
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:25:32.447

我认为您使用了错误的服务——它应该是 ...findNearbyPostalCodesJSON...。据我从他们的网站上可以看出，要使用 JSON 服务。这是他们的示例网址：

[http://api.geonames.org/findNearbyPostalCodesJSON?postalcode=8775&country=CH&radius=10&username=demo](http://api.geonames.org/findNearbyPostalCodesJSON?postalcode=8775&country=CH&radius=10&username=demo)

# c# - Asp.Net 路由 - 显示完整的 URL

> ID：13131929
> 
> 赞同：5
> 
> 时间：2012-10-30T02:41:08.800
> 
> 标签：c#, asp.net, asp.net-mvc-4, asp.net-mvc-routing

我有一个域“http://www.abc.com”。我已经在这个域上部署了一个 ASP.net MVC4 应用程序。我还在 RouteConfig.cs 中配置了默认路由，如下所示

```
routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "MyApp", action = "Home", id = UrlParameter.Optional }
            ); 
```

上述映射确保任何尝试访问“http://www.abc.com”的人都会自动显示“http://www.abc.com/MyApp/Home”页面

一切正常，但浏览器中的地址栏显示“http://www.abc.com”而不是“http://www.abc.com/MyApp/Home”。有没有办法强制浏览器显示完整的 URL，包括控制器和操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:53:11.743

您需要进行某种 url 重写。可能最快的方法是在 Global.asax 中将[RewritePath](http://msdn.microsoft.com/en-us/library/sa5wkk6d.aspx)调用添加到您的 BeginRequest。在你的情况下，它会是这样的：

```
void Application_BeginRequest(Object sender, EventArgs e)
{
    string originalPath = HttpContext.Current.Request.Path.ToLower();
    if (originalPath == "/") //Or whatever is equal to the blank path
        Context.RewritePath("/MyApp/Home");
} 
```

一种改进是动态地从路由表中提取 url 以进行替换。或者您可以使用[Microsoft URL Rewrite](http://www.iis.net/downloads/microsoft/url-rewrite)，但这更复杂 IMO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T12:59:08.023

一种选择是将您的默认路由设置为新控制器，可能会`BaseController`通过操作调用`Root`：

```
public class BaseController : Controller
{
    public ActionResult Root()
    {
        return RedirectToAction("Home","MyApp");
    }
} 
```

并修改你`RouteConfig`的指向根请求：

```
routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Base", action = "Root", id = UrlParameter.Optional }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-13T20:09:11.540

只需删除默认参数，这里已经回答了：

[如何强制 MVC 路由到 Home/Index 而不是 root？](https://stackoverflow.com/questions/26301573/how-to-force-mvc-to-route-to-home-index-instead-of-root)

# ruby-on-rails - Ruby on Rails：更新数据问题

> ID：13131930
> 
> 赞同：1
> 
> 时间：2012-10-30T02:41:09.353
> 
> 标签：ruby-on-rails

好的，所以我只是想编写一些简单的代码来更新给定 ID 的记录。这就是它的样子。

```
def updaterecord
    bathroom = Bathroom.find(params[:key])
    bathroom.name= params[:name],
    #bathroom.bathroomtype = params[:bathroomtype],
    bathroom.street = params[:street]
    #bathroom.city = params[:city],
    #bathroom.state = params[:state],
    #bathroom.country = params[:country],
    #bathroom.postal = params[:postal],
    #bathroom.access = params[:access],
    #bathroom.directions = params[:directions],
    #bathroom.comment = params[:commment],
    #bathroom.avail = params[:avail]
    bathroom.save
  end 
```

问题是，虽然我试图更新每个单独的属性，但它们都被连接到名称字段。例如，上面的这段代码将 name 字段设置为 name 加上地址。我不知道为什么？

如果我在更新后尝试查询，这就是控制台的样子。

```
 Bathroom Load (0.2ms)  SELECT "bathrooms".* FROM "bathrooms" WHERE "bathrooms"."ID" = ? LIMIT 1  [["ID", 4017]]
=> #<Bathroom ID: 4017, name: "--- \n- ttyt\n- 113 some\n", bathroomtype: "0", street: "113 some", city: "Portland", state: "OR", country: "United States", postal: "97217", lat: #<BigDecimal:1109f2890,'0.4558056E2',12(12)>, lon: #<BigDecimal:1109f27c8,'-0.122677857E3',12(16)>, access: "0", directions: "", comment: nil, created: "2012-06-08 17:19:03.420329", modifed: "", avail: "1", slug: "", source: "Squat"> 
```

这就是帖子值的样子：

```
post values = key=4017&name=www&bathroomtype=0&street=7540 N Interstate Ave&city=Portland&state=OR&country=United States&postal=97217&access=0&directions=&comment=<null>&avail=1 
```

为什么我不能让每个字段单独更新？对不起，我对发生了什么感到困惑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:48:15.973

我认为你可能在行尾有一个不必要的逗号。

它应该是：

```
def updaterecord
    bathroom = Bathroom.find(params[:key])
    bathroom.name= params[:name]
    bathroom.street = params[:street]
    bathroom.save
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T02:50:58.650

看起来你没有正确地对你的帖子值进行 urlencoded

一个简单的

```
puts params.inspect 
```

或者

```
pp params 
```

应该注销 params 对象。你也可以使用

```
render :text => params.inspect 
```

将其打印到您的结果 html

# javascript - 如何在 Lightbox2 中调整图像大小？

> ID：13131934
> 
> 赞同：5
> 
> 时间：2012-10-30T02:42:20.217
> 
> 标签：javascript, css, lightbox

我正在使用[http://lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)。我有图像缩略图，单击它们时它们会在灯箱中打开 - 显然。

我遇到的问题是，当其中一些图像为 1800x1200 时，灯箱会覆盖整个网页。

如何编辑以确保图像的最大高度为 400 像素并且宽度成比例？我不能简单地上传较低尺寸的图像，因为它们是用户上传的图像，所以我需要做这个脚本/服务器端。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T02:44:18.207

您可以在图像和灯箱上使用`max-width`和`max-height`CSS 属性：

演示：http: [//jsfiddle.net/rdfAV/1/](http://jsfiddle.net/rdfAV/1/)

CSS：

```
img {
    max-width: 400px;
    max-height: 400px;
}

.lb-outerContainer, .lb-dataContainer {
    max-width: 420px;
    width: auto!important;
    height: auto!important;
}​ 
```

此方法似乎与所有主流浏览器兼容，此处提供了完整的兼容性列表：http: [//caniuse.com/#feat=minmaxwh](http://caniuse.com/#feat=minmaxwh)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-15T06:21:14.683

请尝试将以下内容添加到您的 CSS 中：

```
 .lb-image{
      max-width: inherit;
  } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-10-30T22:04:14.017

非常感谢 .. 真正帮助我的登陆页面

一些编辑的代码，明智地玩

```
img {
max-width: 800px;
max-height: 600px;
}

.lb-outerContainer, .lb-dataContainer {
max-width: 800px;
width: auto!important;
height: auto!important;
}​ 
```

# php - 将 PHP Cookie 设置为在午夜过期

> ID：13131939
> 
> 赞同：2
> 
> 时间：2012-10-30T02:43:22.000
> 
> 标签：php, cookies

我知道如何设置 PHP Cookie 以及如何使其在设定的时间内过期，比如 24 小时，但我怎样才能让 cookie 在服务器每天午夜前的一分钟过期，所以 23:59？

我尝试了以下方法，但似乎没有为我设置？

```
setcookie("cons", 1, mktime(24, 0, 0) - time(), "/"); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-30T02:48:28.293

您可能会发现[strtotime](http://php.net/strtotime)在这些情况下很有用。

```
<?php
setcookie('cons', 1, strtotime('today 23:59'), '/'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T05:00:24.357

```
$dt=explode(':',date('j:n:Y',time()));
$midnight1=mktime(0,0,0,$dt[1],$dt[0],$dt[2]);
$midnight2=$midnight1+(1*24*60*60);
$rest = $midnight2 - time();
setcookie("cons1", 1 ,time()+$r); 
```

我测试了这个代码cookie会在每天00:00自动删除。

# java - 安装 jre 7 时如何设置 Jre 6 的路径？

> ID：13131940
> 
> 赞同：8
> 
> 时间：2012-10-30T02:43:23.373
> 
> 标签：java, path

我正在通过 java 1.6 u_17 进行编程，但我安装了 JRE 版本 6 和 JRE 版本 7，那么如何从 JDK 1.6 运行我编译的程序以仅通过 JRE 6 运行？

默认情况下，它通过 JRE 7 运行我的类文件，如何改变这种行为？在 Windows 7 中设置类路径的任何想法，就像我们为 JDK 所做的那样。

以下显示在我的命令提示符中

```
E:\JAVA>javac -version
javac 1.6.0_17

E:\JAVA>java -version
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) Client VM (build 23.5-b02, mixed mode, sharing) 
```

这是我的 SET 命令显示 Windows 7 环境路径

```
ALLUSERSPROFILE=C:\ProgramData
APPDATA=C:\Users\Administrator\AppData\Roaming
ClassPath=C:\Program Files\Java\jdk1.6.0_17\bin\mysql-connector-java-5.1.5-bin.jar;
CommonProgramFiles=C:\Program Files\Common Files
COMPUTERNAME=RANDMATE-PC
ComSpec=C:\Windows\system32\cmd.exe
FP_NO_HOST_CHECK=NO
HOMEDRIVE=C:
HOMEPATH=\Users\Administrator
JAVA_HOME=C:\Program Files\Java\jre6\bin;
LOCALAPPDATA=C:\Users\Administrator\AppData\Local
LOGONSERVER=\\RANDMATE-PC
NUMBER_OF_PROCESSORS=2
OS=Windows_NT              Path=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\Java\jdk1.6.0_17\bin;C:\Program Files\Java\jre6\bin;C:\Program Files\MyS
QL\MySQL Server 5.1\bin;C:\Program Files\UltraEdit\;C:\Program Files\Jar2Exe                  Wizard\;C:\Program Files\Java\jre6\bin;
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
PROCESSOR_ARCHITECTURE=x86
PROCESSOR_IDENTIFIER=x86 Family 15 Model 6 Stepping 5, GenuineIntel
PROCESSOR_LEVEL=15
PROCESSOR_REVISION=0605
ProgramData=C:\ProgramData
ProgramFiles=C:\Program Files
PROMPT=$P$G
PSModulePath=C:\Windows\system32\WindowsPowerShell\v1.0\Modules\
PUBLIC=C:\Users\Public
SESSIONNAME=Console
SystemDrive=C:
SystemRoot=C:\Windows
TEMP=C:\Users\ADMINI~1\AppData\Local\Temp
TMP=C:\Users\ADMINI~1\AppData\Local\Temp
USERDOMAIN=RANDMATE-PC
USERNAME=Administrator
USERPROFILE=C:\Users\Administrator
windir=C:\Windows 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-30T02:48:37.323

看起来你正在使用 Windows。请转到环境变量并将用户变量定义为：

```
 Right Click(My Computers) -> Advanced -> Environment Variables -> Add

    Variable Name = JAVA_HOME
    Variable Value = Root Folder of Java 1.6.0_17 installation 
```

同样在同一屏幕中，请检查`PATH`变量并确保`**bin** Folder of Java 1.6.0_17 installation`在路径中添加，最好是在开头并从路径中删除 Java 7（如果存在）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-25T07:46:11.597

我通过删除 system32 文件夹中的 java.exe 来解决此问题。然后在cmd中java命令引用路径环境变量中设置的jdk。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-26T11:23:10.550

java.exe 也可以在 C:\windows\system32 中找到，在您的情况下，它的版本可能是 1.7..

由于您的路径首先具有 C:\windows\system32 。无论如何设置路径的其余部分，声纳总是会加载 jre7。（参考Sonar目录下的conf\wrapper.conf，默认有wrapper.java.command=java）

要解决此问题，请更改“wrapper.conf”文件 wrapper.java.command=C:\Program Files\Java\jdk1.6.0_XX\bin\java 的以下属性

无论路径变量如何，这都将解决问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-04T15:10:35.093

对于那些有同样问题的人，我建议阅读这个帖子：

[https://superuser.com/questions/479889/wrong-java-version-being-reported](https://superuser.com/questions/479889/wrong-java-version-being-reported)

wmz 的引用：“要检查从命令行运行 'java -version' 时实际执行的内容：for %I in (java.exe) do @echo %~$PATH:I”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-13T14:56:25.310

我有同样的问题。问题是 Java 安装会将 java.exe、javaw.exe 和 javaws.exe 复制到 windows/system32 目录。您必须最近安装了 JDK7。

我刚刚从 Windows/System32 目录中删除了这些文件，但是在路径中保留了旧版本。这解决了这个问题。

试试看。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-30T03:21:29.320

Windows 正在检查 PATH 变量以查找名为 java 的可执行文件并使用它来启动您的应用程序。在开发环境中有很多安装是很正常的（就像你一样）。但是，这要求您管理您的环境。

在 Windows 中设置环境变量有两种方法。通过如上所述转到我的电脑 > 高级设置 > 环境变量，您可以为您的 JDK 安装设置一个变量，然后更新路径以在该安装中找到 bin 目录。您可以选择更新系统变量（所有用户）或用户变量（仅限您的帐户）。

就个人而言，我不喜欢使用系统/用户环境变量，因为这提供的灵活性较低。您可以使用 bat 文件明确设置特定时刻的路径，或者确实覆盖 JAVA_HOME 以指向不同的安装。

如果您使用的是 IDE，通常可以基于每个项目指定目标运行时。或者，在运行程序时，提供您希望使用的 java 可执行文件版本的完全限定路径。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-29T04:33:58.283

**背景**

我使用的是 Windows 8.1，并且安装了 JDK6 和 JDK8。出于开发目的，我需要克服`java version "1.6.0_45"`命令`java -version`并`javac 1.6.0_45`结束`javac -version`. 在设置`JAVA_HOME`为 JDK6 的主文件夹并添加`%JAVA_HOME/bin%`. `Path`但是第一个命令仍在返回`java version "1.8.0_71"`

**故障排除**

我可以在`Path`环境变量中找到指向`C:\ProgramData\Oracle\Java`. 该文件夹实际上包含 JDK8 的 java.exe 的快捷方式。

**正确的解决方案**：卸载 JDK 8

**解决方法**：编辑快捷方式文件，使其指向内部的 java.exe `%JAVA_HOME%\bin`（请将变量替换为实际文件夹）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-09-03T05:44:03.030

我面临着类似的问题。我同时使用 Java 7 和 Java 8。Java 8 安装在机器中，但我从另一个系统复制了 7 设置。我已经设置了指向 7 的 JAVA_HOME 和路径。但是当我尝试回显 %path% 时，它会在类路径中显示 Jdk 8。经过大量的谷歌，我在路径中找到了“C:\ProgramData\Oracle\Java\javapath”。从路径中删除线解决了这个问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-19T17:31:00.007

java 有两种类型的路径：永久和临时。

这是描述如何为 Java 设置路径的视频教程？

[如何为 Java 设置路径：https://www.youtube.com/watch?v=rM4Qq3Ua7Sk](https://www.youtube.com/watch?v=rM4Qq3Ua7Sk)

本视频教程将指导您为 Java 设置永久和临时路径。只需按照步骤操作。这适用于任何版本的 Java、JDK 或 JRE。在视频中我使用了 JDK 的路径，只需复制 JRE 的路径而不是 JDK，其余部分相同。

或者在这里阅读教程：[如何为 Java 设置路径：http://aatul.me/2011/08/24/how-to-set-path-for-java/](http://aatul.me/2011/08/24/how-to-set-path-for-java/)

希望这些解决方案对您有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-07T04:48:39.983

只需右键单击 MyComputer，然后单击 Advanced System Settings-->Environment Variables-->New 然后在“variable Name”文本字段中添加字符串“PATH”，或者如果它已经存在，则从列表中选择 PATH 并单击编辑，然后附加程序文件中java中“bin”文件夹的路径到变量值文本字段后跟分号（;），如果没有退出，则在“变量值”字段中添加java文件夹的bin目录路径，然后单击“确定”。

如果要检查结果，请打开命令提示符并键入“java”，然后按 Enter。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-30T03:13:49.010

将`PATH`变量设置为您的 jdk6\bin 目录。这样它就会从jdk6中选择`javac`and 。`java`

要设置路径变量，请转到环境变量。设置路径变量后，您需要重新启动命令提示符。（不是电脑）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-25T08:59:28.157

对于 windows 7(X86) 路径设置：

第一步：我的电脑（右键）-->属性-->高级设置-->环境变量-->新建（用户变量）

在这个第一个变量名上：“”JAVA_HOME“”值：“”C:\Program Files\Java\jdk1.7.0_45“”

第二个变量名：“”PATH“”值：“”C:\Program Files\Java\jdk1.7.0_45\bin;.; “”

# c++ - _khbit() 在没有按键时返回真？

> ID：13131945
> 
> 赞同：0
> 
> 时间：2012-10-30T02:43:52.840
> 
> 标签：c++, visual-studio-2010

我有这样一段代码：

```
while (true) {
    if(_kbhit()) {
        cout << "keypressed";
        exit(1);
        } 
```

用于测试以使 _kbhit() 部分正常工作

该程序使用 GetAsyncKeyState() 获取箭头键输入，并在按下 Shift 键的情况下运行这部分代码。

如果我在按 shift 调用这部分代码之前不按任何箭头键，那么 _kbhit 会按预期计算为 false。

问题是这样的，如果我在按下 shift 调用这部分代码之前按下箭头键，即使在调用这部分代码后没有按下任何键，也会输出“keypressed”。

kbhit 是否以某种方式拾取先前的箭头键击？我需要清除输入缓冲区还是什么？

# html - 如何按比例缩放 SVG 背景图像以始终为页脚 div 的全宽？

> ID：13131946
> 
> 赞同：1
> 
> 时间：2012-10-30T02:44:00.203
> 
> 标签：html, css, svg

我很难让图像按我想要的方式缩放`HTML & CSS`。希望有可能做到这一点……我正在开发一个由`header, main content div and footer div`. 所有这三个 div 都属于主包装器 div。没有一个 div 绝对定位或固定到浏览器窗口。在页脚 div 中，我正在尝试将`SVG`矢量图像设置为背景，因为我还将在此页脚 div 中插入文本。`SVG`图像是默认的`800 x 240px`，但由于 SVG 可以无限调整大小，它们会按比例放大。我希望这张`SVG`图片按比例拉伸页脚 div 的宽度。因此，例如，当浏览器缩小到`300px`宽时，图像会`90px`很高。如果浏览器被拉伸到`1200px`宽，图像需要缩放到`360px`高。`SVG`应该始终是浏览器的`100%`宽度，并且它的高度应该成比例地调整大小。

我希望它`footer div`位于浏览器窗口的最底部，以便背景图像下方没有空白。但是，我不想将其设置`footer div`为固定在浏览器窗口的底部。我希望页脚在页面滚动的主要内容 div 之后出现。因此，在较长的网页帖子上，页脚 div 将不可见，直到页面向下滚动一点，然后滚动到视图中。

非常感谢您的帮助！如果需要，我可以提供更多信息。还在学习 CSS 和 HTML！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T14:54:39.677

首先将您的 SVG 设置为按比例缩放：

```
<svg preserveAspectRatio="xMinYMin">
</svg> 
```

然后将其设置为页脚的背景，并使用以下内容声明背景大小`cover`：

```
 .footer {
     background: #000 url(image.svg) top left no-repeat;
     background-size: cover;
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T06:52:48.970

通常，要缩放 SVG 背景图像，您需要设置一个视图框，否则 preserveAspectRatio 将不起作用：

```
<svg
   viewBox = "0 0 90 70" 
   preserveAspectRatio="none"
   ... 
```

然后在您的 CSS 中，例如：

```
.logo{
    background:transparent url(images/matheboss-logo-w.svg) center center no-repeat;
    display:block;
    background-size:contain;
    height:50px;
    width:50px
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-12T07:09:57.600

```
<header>This is out header</header>
<main class="content">This is my content</main>
<footer>
    <div class="footer-inside">
    And here goes footer with background image
    </div>
</footer> 
```

我会做些什么来把页脚放在底部，使用[flexbox](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Flexible_boxes)（现在是 2015 年，每个人都应该支持 flexbox ......），

```
body {
  display: flex;
  min-height: 100vh;
  flex-direction: column;
}

.content {
  flex: 1;
} 
```

然后进行[填充黑客](https://css-tricks.com/NetMag/FluidWidthVideo/Article-FluidWidthVideo.php)以使页脚响应。

```
footer {
    position: relative;
    height: 0;
    padding-top: 30%; /* 240 divided by 800 and multiplied by 100 */
    text-align: center;
}

.footer-inside {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background: red url(http://ohdoylerules.com/content/images/css3.svg) no-repeat center center;
    background-size: contain;
} 
```

演示[小提琴](http://jsfiddle.net/vwnj7boq/)

# android - 计算 ListView 每一行的高度

> ID：13131948
> 
> 赞同：6
> 
> 时间：2012-10-30T02:44:56.210
> 
> 标签：android, android-layout, android-listview

我正在尝试使用 ListView 滚动 ListView 的背景。我的方法基于 Shelves 中的这门课，但是在[Shelves](http://code.google.com/p/shelves/source/browse/trunk/Shelves/src/org/curiouscreature/android/shelves/view/ShelvesView.java)中，所有东西都具有相同的高度，但我无法做出相同的保证。

我有这样的活动：

```
public class MainActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ListView listView = (ListView) findViewById(R.id.listView);

        List<String> items = new ArrayList<String>();
        for(int i=0; i < 100; ++i) {
            items.add("Hello " + i);
        }
        CustomArrayAdapter adapter = new CustomArrayAdapter(this, items);

        listView.setAdapter(adapter);
    }
} 
```

CustomArrayAdapter 在哪里：

```
public class CustomArrayAdapter extends ArrayAdapter<String> {
    private List<Integer> mHeights;

    public View getView(int position, View convertView, ViewGroup parent) {
        //snip
    }
} 
```

我想要做的是用视图行的高度填充适配器中的 mHeights。

我的主要尝试是在 getView() 中这样做：

```
if(row.getMeasuredHeight() == 0) {
    row.measure(
        MeasureSpec.makeMeasureSpec(0, MeasureSpec.EXACTLY),
        MeasureSpec.makeMeasureSpec(0, MeasureSpec.EXACTLY));
}
mHeights.set(position, row.getMeasuredHeight()); 
```

我已经尝试了几种方法来做到这一点，但我无法得到任何工作。

在`getView`中，如果我打电话，`getHeight()`我会得到一个返回值 0，而如果我打电话`getMeasuredHeight()`，我会得到一些非零但不是真实高度的东西。如果我向下滚动然后再次向上滚动（将其中一行移出视图）`getHeight() == getMeasuredHeight()`并且两者都有正确的值。如果我只是更新 getView 中的 mHeights （通过说`mHeights.set(position, row.getHeight()`）；它有效 - 但只有在我滚动到 ListView 的底部之后。我尝试在 getView 方法中调用 row.measure() ，但这仍然会导致`getHeight()`第一次运行时为 0。

我的问题是：如何计算并使用 ListView 行的正确高度填充 mHeights？我见过一些类似的问题，但它们似乎不是我要找的。该`ViewTreeObserver`方法似乎很有希望，但我不知道如何强制调用 getView() （或者，迭代 ListView 的行）。调用`adapter.notifyDataSetChanged()`会导致无限（尽管非阻塞）循环。

1.  [获取实际视图高度](https://stackoverflow.com/questions/4501840/get-actual-height-of-view)
2.  [如何获取列表视图中项目的高度？](https://stackoverflow.com/questions/11671165/how-to-get-height-of-the-item-in-a-listview)

这与我之前关于该主题的问题有关，似乎没有抓住重点：[ListView distance from the top of the list](https://stackoverflow.com/questions/13111847/listview-distance-from-top-of-the-list)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T01:07:00.973

我想出了如何做到这一点。这有点棘手，但它有效。

微妙之处在于获取已知的布局参数。据我所知，`getView()`是第一次返回视图，所以它当然还不能有高度 - 父级还不知道该行（因为`getView()`它的工作是给它充气），所以我们需要一个打回来。

那个回调可能是什么？事实证明，尽我所能告诉它是`OnLayoutChangeListener()`为了行的视图。所以在`getView()`我的自定义`ArrayAdapter`中，我添加了一个回调，`onLayoutChanged`如下所示：

```
row.addOnLayoutChangeListener(new View.OnLayoutChangeListener() {
    public void onLayoutChange(View v, int left, int top, int right,
            int bottom, int oldLeft, int oldTop, int oldRight, int oldBottom) {
        ref.removeOnLayoutChangeListener(this);
        Log.d("CustomArrayAdapter", "onLayoutChange(" + position + "): height " + (bottom - top));
        mHeights.set(position, (bottom - top));
        if(position > 0) {
            mDistances.set(position, bottom - top + mDistances.get(position-1) + ((ListView)parent).getDividerHeight());
        }
        holderRef.distanceFromTop = mDistances.get(position);
        Log.d("CustomArrayAdapter", "New height for " + position + " is " + mHeights.get(position) + " Distance: " + mDistances.get(position));
    }
}); 
```

这里，是适配器`row`中要返回的视图，是 的每个元素的高度列表，并且是到列表视图顶部的距离（以像素为单位）的列表 - 我想要计算的真实事物（也就是说，如果你将整个列表视图首尾相连，那么我离顶部元素的距离有多远）。所有这些都存储在 custom中。这些列表被初始化为零。`getView()``mHeights``ListView``mDistances``ArrayAdapter`

添加此回调允许我计算视图的高度。

我的目标是拥有一个具有随列表滚动的背景的 ListView。如果有人感兴趣，我将代码放在 GitHub 上，如果有人想查看它：[https ://github.com/mdkess/TexturedListView](https://github.com/mdkess/TexturedListView)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-21T22:40:27.067

[这个](https://stackoverflow.com/a/4406090/616561)SO 答案应该适用于也希望支持 API 级别 < 11 的开发人员。

基本上，`View.onLayoutChnageListener`您可以`OnGlobalLayoutListener`在视图的`ViewTreeObserver`.

# php - 单选/复选框未保存到数据库

> ID：13131949
> 
> 赞同：0
> 
> 时间：2012-10-30T02:45:03.250
> 
> 标签：php, ajax, arrays, checkbox, radio-button

我在 foreach 循环中有此表单，因此它在同一页面上显示多次。

除了单选按钮和复选框之外，每个表单中的所有内容都可以正常提交。他们不会将值保存到数据库中。

**编辑：我已将其范围缩小到导致错误的 ajax，但无法弄清楚如何纠正它。**

```
<form action="process.php" method="post" name="editInvoice'.$invoice_id.'" id="editInvoiceForm'.$invoice_id.'" class="editInvoiceForm edit_invoice_container" enctype="multipart/form-data">
<div class="form_item_row">
<input type="radio" value="Unsent" '.$unsent.' name="status"/><span class="choice">Unsent</span>
<input type="radio" value="Sent" '.$sent.' name="status"/><span class="choice">Sent</span>
<input type="radio" value="Paid" '.$paid.' name="status"/><span class="choice">Paid</span>          
</div>          
<div class="form_item_row">
<label for="include_timelog'.$invoice_id.'">Include Time Log</label>
<input type="checkbox" value="true" '.$include_timelog.' name="include_timelog" id="include_timelog'.$invoice_id.'" />
</div>
<div class="clear"></div>               
<div class="form_item_row_btns">
<input type="hidden" value="'.$invoice_id.'" name="hiddenInvoiceID"/>
<input type="submit" class="btn" value="Update Invoice" name="action"/>
</div>
</form> 
```

* * *

```
$query = "UPDATE invoices SET status = ".$db->prep($_POST['status']).", include_timelog = ".$db->prep((isset($_POST['include_timelog'])?1:0))." WHERE invoice_id = ".$db->prep($invoice_id); 
```

* * *

```
$(document).ready(function()
{       
        var action = '';

        $(".due_date").datepicker();

        $('input[name=action]').click(function(){
            action = $(this).val();
        });

        $(".editInvoiceForm").submit(function() {
            $('.editInvoiceForm .form_message').html('<img src="images/loadingAnimation.gif" alt="loadingAnimation" width="30" height="8"/>');

            var dataToSend = {};
            $(this).find(':input').each(function (i,el) {
                dataToSend[el.name] = $(el).val();
            });

            dataToSend.action = action;

            $.ajax({
                type: "POST",
                url: "process.php",
                data: dataToSend,
                dataType: "json",
                cache: false,
                success: function(data){
                    //console.log(data.status);
                    if(data.status == 'error'){
                        $('.editInvoiceForm .form_message').removeClass('status_green').addClass('status_red').html(data.message).append(data.script);
                    }else{
                        $('.editInvoiceForm .form_message').removeClass('status_red').addClass('status_green').html(data.message).append(data.script);

                    }

                }
            });
            return false;
        });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:51:29.477

您需要在 SQL 中的状态值周围加上引号，因为该值是一个字符串。您的 include_timelog 和 invoice_id 值是整数，不需要引号。

```
$query = "UPDATE invoices SET status = '".$db->prep($_POST['status'])."', include_timelog = ".$db->prep((isset($_POST['include_timelog'])?1:0))." WHERE invoice_id = ".$db->prep($invoice_id); 
```

# vb.net - 数据网格视图替换值

> ID：13131950
> 
> 赞同：1
> 
> 时间：2012-10-30T02:45:08.337
> 
> 标签：vb.net, datagridview, replace

你能帮我解决这个..

```
 For Each r As DataGridViewRow In dglist.Rows
        For Each c As DataGridViewCell In r.Cells
            If c.Value IsNot Nothing Then
                **If c.Value.ToString = Label2.Text.ToString Then
                    c.Value.ToString.Trim.Replace(c.Value.ToString.Trim, TextBox1.Text)
                End If**

                'MessageBox.Show(c.Value.ToString)
            End If
        Next
    Next 
```

我需要用标签的值替换单元格的值。但是我的代码仍然不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T05:40:00.950

您需要分配值（给单元格值属性），而不是对您拥有的字符串值进行操作。当您执行诸如此类的操作时，会`ToString`在内存中创建一个额外的实例，如果您没有分配它，这就是全部。改为这样做：

```
 For Each r As DataGridViewRow In dglist.Rows
        For Each c As DataGridViewCell In r.Cells
            If c.Value IsNot Nothing Then
                **If c.Value.ToString = Label2.Text Then
                    c.Value = TextBox1.Text
                End If**

                'MessageBox.Show(c.Value.ToString)
            End If
        Next
    Next 
```

重新考虑您的 if 子句，因为我不太确定您正在寻找什么。在您的问题中，您说要分配标签的值，但是在您粘贴的代码中，在我看来，您是在寻找文本框的文本值。

# android - 有没有一种简单的方法可以将 Android 设置为仅在需要时更新屏幕？

> ID：13131952
> 
> 赞同：0
> 
> 时间：2012-10-30T02:45:13.137
> 
> 标签：android, multithreading, performance, android-canvas, cpu-usage

我正在做一个棋盘游戏。板子永远不会移动，但它上面的部分有时会根据用户交互而移动。还有一些 UI 元素可能会定期更新。

现在我设置它的方式是覆盖子类的`onDraw()`方法`SurfaceView`。`postInvalidate()`我有一个在while循环中不断调用的绘图线程：

```
class PanelThread extends Thread
{
        //...
    long sleepTime = 0;
    long nextGameTick = System.currentTimeMillis();

    @Override
    public void run()
    {
        Canvas c;
        while (_run)
        { // When setRunning(false) occurs, _run is
            c = null; // set to false and loop ends, stopping thread
            try
            {
                c = _surfaceHolder.lockCanvas(null);
                synchronized (_surfaceHolder)
                {
                    // Insert methods to modify positions of items in onDraw()
                    _panel.postInvalidate();
                }
            } finally
            {
                if (c != null)
                {
                    _surfaceHolder.unlockCanvasAndPost(c);
                }
            }
        }
            nextGameTick += MILLISECONDS_PER_FRAME;
        sleepTime = nextGameTick - System.currentTimeMillis();
        if(sleepTime >= 0)
        {
            try
            {
                sleep(sleepTime, 0);
            } catch (InterruptedException e)
            {
                continue;
            }
        }
        else
        {
            //we're behind, oh well.
            System.out.println("behind!");
            nextGameTick = System.currentTimeMillis();
        }
    }
} 
```

这效率不高，并且占用大量 CPU。有没有一种简单的方法可以让 android 仅在发生变化时才更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:21:55.010

你有正确的想法，但它需要一些改进。

但是，您绝对**不**想像 CPU 处理它那样快地循环。你应该在每个循环中让你的线程休眠一段时间。您当然不需要每毫秒都在循环中执行所有操作。

我发现这份[FPS 控制指南对](http://www.koonsolo.com/news/dewitters-gameloop/)设计游戏循环非常有帮助。

这个[Android 特定的游戏循环指南](http://www.javacodegeeks.com/2011/07/android-game-development-game-loop.html)还提供了很多很棒的示例代码和深入的解释。

# android - 罗技 Revue GoogleTv DDMS 屏幕截图不起作用

> ID：13131955
> 
> 赞同：0
> 
> 时间：2012-10-30T02:45:38.940
> 
> 标签：android, eclipse, screenshot, google-tv, ddms

任何人都可以截取他们的罗技 Revue 的屏幕截图吗？

使用以太网连接的计算机和 GoogleTV（logitech revue，固件版本 3.2）我可以在 Eclipse 中成功看到该设备：

```
adb connect 192.168.1.132:5555 
```

但是当我尝试获取屏幕截图时，我得到屏幕不可用，如下所示：

![屏幕不可用错误](../Images/432d7941d5b9f08eb0ccbea29aaa9b7a.png)

在它说“屏幕不可用”之前，它会说“正在捕获......”大约 55 秒。我正在使用 ADT 20.02。

我最初尝试通过 WiFi 并认为以太网可能会有所帮助。它不是。

我考虑过的一种选择是，也许模拟器会允许截图。我在 Windows 上，看来用于仿真的 GoogleTV 插件不兼容：

![在此处输入图像描述](../Images/5efd2370088257817872623a959c5c5a.png)

我想知道是否有人可以使用 DDMS 获取 Logitech Revue 的屏幕截图，或者是否有人正在使用我还没有想到的替代方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:17:07.580

**是**的，我可以使用 Eclipse 中的 DDMS 插件截取我的 Logitech Revue 的屏幕截图（如您的屏幕截图所示）。无需安装“Google TV Addon”——它就可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T11:27:59.270

使用 DDMS 截取屏幕截图适用于 Google TV 应用。您不能截取视频的屏幕截图。

ADB 可能会陷入不良模式，因此最好通过以下方式阻止它：

```
adb kill-server 
```

并重新启动它：

```
adb start-server 
```

然后再次添加您的设备：

```
adb connect 192.168.1.132 
```

并确认它已连接：

```
adb devices 
```

# c# - PLINQ 查询给出溢出异常

> ID：13131957
> 
> 赞同：7
> 
> 时间：2012-10-30T02:46:02.727
> 
> 标签：c#, linq, task-parallel-library, plinq

我正在运行 PLINQ 查询，如下所示：

```
ParallelQuery<string> winningCombos = from n in nextComboMaker.GetNextCombo()
                                              .AsParallel().WithCancellation(_cancelSource.Token)
                                              where ComboWasAWinner(n) 
                                              select n;

ConcurrentBag<string> wins = new ConcurrentBag<string>();

foreach (var winningCombo in winningCombos)
{
        wins.Add(winningCombo);
        if (wins.Count == _maxWinsAllowed)
            break;
} 
```

GetNextCombo 方法只是返回字母和数字的下一个组合，可能高达数十亿/万亿。

现在，当我选择的组合范围大于 Int32 的允许大小时，这会引发异常，当它运行的组合计数器为 2147483584 时，它总是会抛出异常。

我通过创建一个每次返回的假组合来确保 GetNextCombo 中没有任何内容（执行 yield return "234gf24fa23..." 等）

LINQ 抛出异常：

```
System.AggregateException was unhandled by user code
  Message=One or more errors occurred.
  Source=System.Core
  StackTrace:
       at System.Linq.Parallel.QueryTaskGroupState.QueryEnd(Boolean userInitiatedDispose)
       at System.Linq.Parallel.MergeExecutor`1.Execute[TKey](PartitionedStream`2 partitions, Boolean ignoreOutput, ParallelMergeOptions options, TaskScheduler taskScheduler, Boolean isOrdered, CancellationState cancellationState, Int32 queryId)
       at System.Linq.Parallel.PartitionedStreamMerger`1.Receive[TKey](PartitionedStream`2 partitionedStream)
       at System.Linq.Parallel.ForAllOperator`1.WrapPartitionedStream[TKey](PartitionedStream`2 inputStream, IPartitionedStreamRecipient`1 recipient, Boolean preferStriping, QuerySettings settings)
       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.ChildResultsRecipient.Receive[TKey](PartitionedStream`2 inputStream)
       at System.Linq.Parallel.WhereQueryOperator`1.WrapPartitionedStream[TKey](PartitionedStream`2 inputStream, IPartitionedStreamRecipient`1 recipient, Boolean preferStriping, QuerySettings settings)
       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.ChildResultsRecipient.Receive[TKey](PartitionedStream`2 inputStream)
       at System.Linq.Parallel.ScanQueryOperator`1.ScanEnumerableQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)
       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)
       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)
       at System.Linq.Parallel.QueryOperator`1.GetOpenedEnumerator(Nullable`1 mergeOptions, Boolean suppressOrder, Boolean forEffect, QuerySettings querySettings)
       at System.Linq.Parallel.ForAllOperator`1.RunSynchronously()
       at StockWiz.Library.PLINQArrayProcessor.DoProcessing() in C:\Users\dad\Documents\BitBucket\stockwiz_clone\stockwiz\StockWiz.Library\PLINQArrayProcessor.cs:line 50
       at System.Threading.Tasks.Task.Execute()
  InnerException: System.OverflowException
       Message=Arithmetic operation resulted in an overflow.
       Source=System.Core
       StackTrace:
            at System.Linq.Parallel.PartitionedDataSource`1.ContiguousChunkLazyEnumerator.MoveNext(T& currentElement, Int32& currentKey)
            at System.Linq.Parallel.WhereQueryOperator`1.WhereQueryOperatorEnumerator`1.MoveNext(TInputOutput& currentElement, TKey& currentKey)
            at System.Linq.Parallel.ForAllOperator`1.ForAllEnumerator`1.MoveNext(TInput& currentElement, Int32& currentKey)
            at System.Linq.Parallel.ForAllSpoolingTask`2.SpoolingWork()
            at System.Linq.Parallel.SpoolingTaskBase.Work()
            at System.Linq.Parallel.QueryTask.BaseWork(Object unused)
            at System.Threading.Tasks.Task.Execute()
       InnerException: 
```

我想知道我是否可以做任何事情来将此查询更改为不溢出，我执行操作的任何顺序等。也许没有 linq 查询执行 where 和 select，尽管我已经尝试过：

```
 var query = nextComboMaker.GetNextCombo().AsParallel();

 query.ForAll(x => if(ComboWasAWinner(x) wins.Add(x) ); 
```

还是一样的溢出。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T15:32:59.630

您应该能够通过使用自定义分区程序来解决这个问题。在这种情况下，PLINQ 选择的默认分区器仅支持整数范围的项目数。

请参阅[http://msdn.microsoft.com/en-us/library/dd997416.aspx](http://msdn.microsoft.com/en-us/library/dd997416.aspx)了解如何执行此操作。

# git - 在没有 ~/Library/Preferences/com.apple.Terminal.plist 的情况下重置终端

> ID：13131961
> 
> 赞同：0
> 
> 时间：2012-10-30T02:46:40.240
> 
> 标签：git, shell

我试图在终端的rails中运行PostgreSQL并最终使用了一大堆`sudo`命令......你瞧，现在当我尝试运行一个静态项目时，`$ rails new sample_app --skip-test-unit`我不再能够`git`从终端运行命令。我没有收到错误消息，按 Ctrl-Z 会显示一条`Stopped`消息。

我想看看是否有一些我可以重置的“缓存”？我注意到线程声明要查找和删除`~/Library/Preferences/com.apple.Terminal.plist`文件，但是，我找不到这样的文件。先感谢您。-射线

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:59:38.317

听起来您以某种方式删除了 .git 文件夹。`git init`在根级别使用并`git remote add origin <url>`重新连接到远程。您还必须为您的分支机构设置跟踪。请参阅`--set-upstream`分支命令上的选项。

**编辑：**当然，我做了以下工作：

```
$ brew remove git
$ brew install git
$ PATH=/usr/local/git/bin:$PATH 
```

# asp.net - Visual Studio 2012 - 命令识别

> ID：13131962
> 
> 赞同：0
> 
> 时间：2012-10-30T02:46:47.290
> 
> 标签：asp.net, vb.net, visual-studio

```
Public Class HomeController
    Inherits System.Web.Mvc.Controller

    Function Index() As ActionResult

    End Function
End Class 
```

无法识别命令部分“System.Web.Mvc.Controller”和“ActionResult”。

荧光笔也不会突出显示它们。

DLL 和 XML 文件“System.Web.Mvc”位于项目的 bin 文件夹中。

# javascript - 使用多个 JS 库；需要知道如何正确地为“$”编写本地定义

> ID：13131963
> 
> 赞同：0
> 
> 时间：2012-10-30T02:46:59.763
> 
> 标签：javascript, selector, libraries

我在另一个自动滚动插件旁边使用 JQuery 工具滑块。由于我对 Javascript 很陌生，我不知道如何正确解决插件各自库之间的冲突。

据我了解，我需要在 Slider 脚本中为“$”提供一个本地定义，或者我应该为 JQuery 滑块使用的自动滚动插件执行此操作，我想这是一个更广泛的“定义” $"

所有的见解都值得赞赏。再说一次，我对 Javascript 非常非常陌生，所以请原谅我的无知。有一天，我想我会跨越从复制粘贴程序员到真正的程序员的鸿沟。

这是 JQuery 工具滑块的脚本

```
<script>
    var api = $("#scroll").scrollable({ items: '#tools' }).navigator().data("scrollable");
    api.onBeforeSeek(function(e, i) {
    if (i) {$("#intro").fadeOut("slow");
        if ($.browser.msie && $.browser.version < 8) {
             $("#intro").hide();
        }
        // otherwise show the intro
        } else {
            $("#intro").fadeIn(1000);
        }

        // toggle activity for the intro thumbnail
        $("#t0").toggleClass("active", i == 0);
    });

    $("#t0").click(function() {                        
        $("#scroll").scrollable().begin();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:43:06.480

这是关于加载两个版本的 jQuery（通常是一个坏主意）并定义`$`变量是相关版本的 jQuery 的范围的基本想法：

```
<!-- load jQuery 1.7.2 -->
<script type="text/javascript" src="http://example.com/jquery-1.7.2.js"></script>
<script type="text/javascript">
var jQuery_1_7_2 = $.noConflict(true);
</script>

<!-- load jQuery 1.8.2 -->
<script type="text/javascript" src="http://example.com/jquery-1.8.2.js"></script>
<script type="text/javascript">
var jQuery_1_8_2 = $.noConflict(true);
</script>

<script type="text/javascript">
// self executing function that defines $ to be jQuery 1.7.2 in its scope
(function($) {
    var jQuery = $;
    // $ and jQuery in here is 1.7.2
})(jQuery_1_7_2);

// self executing function that defines $ to be jQuery 1.8.2 in its scope
(function($) {
    var jQuery = $;
    // $ and jQuery in here is 1.8.2
})(jQuery_1_8_2);
</script> 
```

# java - Log4j 在基类中创建日志实例

> ID：13131972
> 
> 赞同：0
> 
> 时间：2012-10-30T02:48:45.180
> 
> 标签：java, logging, log4j

假设我在层次结构中的所有类都只有默认构造函数，那么创建 Log 实例有什么问题，如下所示？

```
 public abstract class AbstractService {

    protected static Log log=null;

    public AbstractService(){
        log=LogFactory.getLog(this.getClass().getName());
    }

    public void foo(){      
        log.debug("base foo() : ");
    }

}

class ServiceA extends AbstractService {    

    public void foo(){
        super.foo();

        log.debug("Overloaded foo() in ServiceA");      
    }
}

class ServiceB extends AbstractService {
    public void foo(){
        super.foo();
        log.debug("Overloaded foo() in ServiceB");      

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T03:28:07.847

鉴于“log”字段是静态的（即与 AbstractService 类相关联），它不应从构造函数（与该类的特定实例相关联）中设置。

您要么需要：

*   使“日志”字段非静态（可能是您想要的，因为您使用 getClass().getName() 对其进行命名），或者
*   在其声明中对其进行初始化，例如 protected static Log log=LogFactory.getLog(AbstractClass.class);

# java - 将不同数据（以多种格式）保存到公共数据库表中的最佳方法是什么？

> ID：13131973
> 
> 赞同：0
> 
> 时间：2012-10-30T02:48:55.030
> 
> 标签：java, design-patterns, csv

我在 CSV 文件中有可用的数据。每个 CSV 都与另一个不同，即列名不同。例如，在 FileA 中唯一的标识符称为 ID，但在 FileB 中称为 UID。同样，在 FileA 中金额称为 AMT，但在 FileB 中称为 CUST_AMT。含义相同，但列名不同。

我想创建一个通用解决方案，将这些不同的数据从 CSV 文件保存到数据库表中。该解决方案必须考虑将来可能出现的其他格式。

这种情况有没有最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T05:24:44.560

这个问题有很多解决方案。但我认为最简单的可能是生成从每个输入文件格式到组合行格式的映射。您可以创建一个具有列名到数据库字段名映射的配置文件，并创建一个程序，在给定 CSV 和映射文件的情况下，可以将所有数据插入数据库。

但是，您仍然必须为要添加的每个新列更改表。

更多的设计工作需要更多关于数据进入数据库后如何使用的细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T06:35:51.617

我可以在执行开始时想到“责任链”模式。因此，您阅读标题并让责任链为该文件获取适当的解析器。

代码可能如下所示：

```
interface Parser {
  // returns true if this parser recognizes this format.
  boolean accept(String fileHeader);

  // Each parser can convert a line in the file into insert parameters to be 
  // used with PreparedStatement
  Object[] getInsertParameters(String row);
} 
```

这允许您通过向链中添加新的 Parser 对象来添加新的文件格式。

您将首先按如下方式初始化链：

```
List<Parser> parserChain = new ArrayList<Parser>();
parserChain.add(new ParserImplA());
parserChain.add(new ParserImplB());
parserChain.add(new ParserImplB());
.... 
```

然后您将按如下方式使用它：

```
 // read the header row from file
 Parser getParser (String header) {
    for (Parser parser: parserChain) {
        if (parser.accept(header) 
            return parser;
        }
     throw new Exception("Unrecognized format!");
} 
```

然后，您可以创建一个准备好的语句，用于在表中插入一行。处理每一行文件将是：

```
preparedStatement.execute(parser.getInsertParameters(row)); 
```

# apache - 使用 ,htaccess 将非 www 重定向到 www

> ID：13131974
> 
> 赞同：0
> 
> 时间：2012-10-30T02:48:59.553
> 
> 标签：apache, redirect, seo

我想将我的非 www 请求重定向到 www 版本。已将 wwww 版本设置为我在谷歌网站管理员中的首选域。我在 .htaccess 文件中添加了以下内容

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

但问题是，如果我点击一个非 www url，它会给我 404，因为重定向后自动引入了额外的空间。以下是一个示例 URL：

javaexperience.com/eclipse-get-access-modifier-suggestions-using-ucdetector-plugin/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T08:50:59.570

这个重写规则对我有用

```
RewriteCond %{HTTP_HOST} ^yourdomain.com [NC]
RewriteRule ^(.*)$ http://www.yourdomain.com/$1 [L,R=301] 
```

该规则将旧网址重定向到带有 301 标头的新网址，这对您的 SEO 来说没问题

# javascript - 从带有id的knockoutjs observablearray获取属性

> ID：13131975
> 
> 赞同：2
> 
> 时间：2012-10-30T02:49:10.047
> 
> 标签：javascript, knockout.js

我正在尝试使用其中一项的属性值在可观察数组中查找值。这是一些示例代码：

HTML：

```
<ul data-bind="foreach: items">
  <li data-bind="text:name"></li>
  <li>Cousin: <span data-bind="text:related_id"></span></li>
</ul>​ 
```

JS：

```
var item = function (data){
  this.id = ko.observable(data.id);
  this.name = ko.observable(data.name);
  this.related_id = ko.observable(data.related_id);
}

var related_item = function(data){
  this.id = ko.observable(data.id);
  this.name = ko.observable(data.name);
}

var ViewModel = function(){
    this.items = ko.observableArray([
      new item({id:1,name:'thing1',related_id:1}),
      new item({id:2,name:'thing2',related_id:2})                
    ]);

this.related_items = ko.observableArray([
    new related_item({id:1,name:'cousin it'}),
    new related_item({id:2,name:'cousin fred'})
]);
}
ko.applyBindings(new ViewModel); 
```

摆弄上面的代码：[fiddle](http://jsfiddle.net/8693c/1/)

我的问题：获取related_item 的名称属性以显示项目的related_id 当前显示在哪里的最佳方法是什么？​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T03:20:38.487

像这样的JSFiddle在这里：[小提琴](http://jsfiddle.net/tZm7c/ "小提琴")

我所做的是将 item 和 related_item “对象”放入 ViewModel 中，以便我可以引用它们。有两种可能的解决方案：

1.  将 related_item 本身传递给 item 对象，而不仅仅是 id。
2.  遍历related_items 数组。

JS：

```
 self.item = function (data){
        var itm = this;
        itm.id = ko.observable(data.id);
        itm.name = ko.observable(data.name);
        itm.related_id = ko.observable(data.related_id);
        //Possible solution 1
        itm.related_item = ko.observable(data.related_item); 
        //Possible solution 2
        itm.related_item_name = ko.computed(function() {
            tmp = '';
            $.each(self.related_items(), function(idx, elem) {
                if (elem.id() === itm.related_id()) {
                    tmp = elem.name();
                    return false; //break out of the $.each loop
                }
            });
            return tmp;
        });
    }; 
```

HTML：

```
<ul data-bind="foreach: items">
<li data-bind="text:name"></li>
   <li>Cousin: <span data-bind="text:related_id"></span></li>
   <li>(soln 1) Cousin: <span data-bind="text:related_item().name()"></span></li>
   <li>(soln 2) Cousin: <span data-bind="text:related_item_name"></span></li>
</ul>​ 
```

如果您没有其他限制，我宁愿执行第一种方法并传递整个对象而不是 ID。

# objective-c - 将实例引用存储在 obj-c 中的单例中

> ID：13131977
> 
> 赞同：0
> 
> 时间：2012-10-30T02:49:58.363
> 
> 标签：objective-c, ios

假设我有 2 个班级，A 和 B。A 是单身人士。我在 B 中声明了 A，所以我可以访问 B 中方法中的单例变量。

B 然后创建另一个类的实例，例如 C 类。

C 然后创建另一个类的实例，比如 D 类。

我需要做的是在 D 类的 B 类实例中运行一个方法，这就是让我发疯的原因。

我的第一个想法是在我的单例（A 类）中引用 b 类的实例，类似于...

```
sharedInstance.classBReference = self; 
```

..然后在 D 类中声明单例，然后在 D 类实例中使用类似的东西......

```
[sharedInstance.classBInstance classBInstanceMethod]; 
```

但当然，一旦我这样做了..

```
classB *classBReference; 
```

在我的单身人士的标题中，它与我在这里读到的“未知类型”游戏，所以相反，我放了一个

```
@class classB; 
```

在@interface之上，然后我能够声明......

```
classB *classBReference; 
```

没有未知类型的错误，但是在B类的init方法中，这个...

```
sharedInstance.classBReference = self; 
```

仍然给我一个类型错误

“在“A 类 *”（单例）类型的对象上找不到属性 classBReference 您是要访问 ivar classBReference 吗？

而且我不知道它为什么这样做，解决方案是什么？还是有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:08:39.223

# 点和箭头

“点符号”是最近对 Objective-C 的补充，它为访问器提供了一种速记符号。如果您有一个指向对象（或结构！）的指针，则不能使用`.`但只能使用`->`.

你的线

```
sharedInstance.classBReference = self; 
```

完全一样

```
[sharedInstance setClassBReference:self]; 
```

问题是你没有任何这样的方法`-setClassBReference:`。为了设置实例变量，您必须改为编写

```
sharedInstance->classBReference = self; 
```

## @protected 变量

用这个换行后，您可能（如果您还没有成功`@public`）看到错误

> 实例变量“ `classBReference`”是私有的

在这种情况下，您需要更改`classA`接口，以便将`classBReference`其声明为`@public`. 您的实例变量列表`classA`应类似于

```
@interface classA : NSObject
{
//@protected
//(The @protected keyword is optional when at the beginning of the list; instance
//variables are protected by default, which is why you're needing to declare your
//instance variable classBReference to be @public (since classB is not a subclass
//of classA and consequently cannot access its protected instance variables).
    //....
    //some protected instance variables
    //....
@private
    //....
    //some private instance variables
    //....
@public
    //....
    //some public instance variables
    classB *classBReference;
    //....
@protected
    //....
    //some more protected instance variables
    //Note that @protected is not optional in order to make the instance variables
    //here be protected since they are declared subsequent to the prior @public.
    //....
}
//....
@end 
```

## 使用@properties

### classBReference 的案例

话虽如此，通常使用访问器而不是实例变量被广泛认为是一种更好的做法。为此，您应该在`classA`界面中添加一个属性：

```
@interface classA : NSObject
{
    classB *classBReference;
}
@property classB *classBReference;
@end 
```

并合成`classBReference` **属性**以访问 的实现中的`classBReference` **实例变量**，`classA`如下所示：

```
@implementation classB

@synthesize classBReference = classBReference; 
```

### 一般设置

由于`@synthesize`我们有一个实例变量和一个同名的属性，所以有点不清楚。一些澄清是有序的。一般来说，在一个类的（`MyObject`本例中为“”）中`@interface`声明一个实例变量（`myVariable`本例中为“”）和一个属性（`myProperty`本例中为“”）。

```
@interface MyObject : NSObject
{
    SomeObject *myVariable;
}
@property SomeObject *myProperty;
@end 
```

在班上的`@implementation`一个有行

```
@synthesize myProperty = myVariable. 
```

这段代码的结果是，给定一个实例

```
MyObject *object = //... 
```

班上，一个会写

```
SomeObject *someObject = //...
[object setMyProperty:someObject]; 
```

和

```
SomeObject *someOtherObject = [object myProperty]; 
```

调用`-setMyProperty:`实例的`MyObject`结果`myVariable`是设置等于传递给方法的参数——在这种情况下`someObject`。同样，调用`-myProperty`实例的结果`MyObject`就是`myVariable`返回。

### 它带给我们什么？

如果没有`@property`and`@synthesize`指令，就必须声明方法

```
- (void)setMyProperty:(SomeObject *)myProperty;
- (SomeObject *)myProperty; 
```

手动并手动定义它们：

```
- (void)setMyProperty:(SomeObject *)myProperty
{
    myVariable = myProperty;
}

- (SomeObject *)myProperty
{
    return myVariable;
} 
```

`@property`和`@synthesize`提供此代码的一些删节。[当您使用各种属性属性](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW2)时，为您生成的代码量变得更加有益。

**注意**：关于and指令还有[更多要说的。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)首先，不仅可以省略变量名，还可以完全省略综合，这两种情况下自动使用的变量名是不同的。 `@property``@synthesize``@synthesize myProperty;``myProperty`

## 关于点符号的更多信息

您问题中的点符号提供了另一层缩写。而不是必须写

```
[object setMyProperty:someObject]; 
```

你现在可以写了

```
object.myProperty = someObject; 
```

同样，不必写

```
SomeObject *someOtherObject = [object myProperty]; 
```

你现在可以写了

```
SomeObject *someOtherObject = object.myProperty; 
```

重要的是要注意这**只是符号**。虽然它“有点像”当我们“设置`object.myProperty`等于`someObject`”时我们正在做简单的赋值，但事实*并非*如此。特别是，当我们执行该行时

```
object.myProperty = someObject; 
```

方法

```
- (void)setMyProperty:(SomeObject *)someObject 
```

被执行。出于这个原因，[点](http://weblog.bignerdranch.com/83-83/) [符号](http://qualitycoding.org/dot-notation/) [是](https://stackoverflow.com/questions/6292753/dot-notation-vs-square-brackets-and-casting-in-objective-c) [一些](http://iphonedevelopment.blogspot.com/2009/08/dot-notation-controversy.html)[争论](http://jrfom.com/2010/06/16/objective-c-dot-notation/)[的](http://fernmac.blogspot.com/2012/04/objective-c-dot-notation-or-message.html) [主题](http://eschatologist.net/blog/?p=160) [。](http://www.bit-101.com/blog/?p=2227) 这是一种方便，但重要的是要记住您的代码在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:01:56.240

错误信息告诉你答案。您应该定义`classBReference`为属性或`classBReference`用作 ivar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T03:08:26.153

听起来你会通过避免全局变量（又名单例）来减少困惑。当创建. `C`_ `B`_ 当创建. _ _`B``C``D``B``C``D`

如果您需要避免保留周期，请反向引用（如果您的部署目标至少为 iOS 5.0）或`B`（如果您的部署目标早于 iOS 5.0）。`weak``unsafe_unretained`

# java - Java暂停程序执行

> ID：13131978
> 
> 赞同：1
> 
> 时间：2012-10-30T02:50:00.653
> 
> 标签：java, sleep

我有一个更新部分用户界面的方法。调用此方法后，我希望整个程序休眠 1 秒钟。我不想在这段时间内运行任何代码，只是简单地暂停整个执行。实现这一目标的最佳方法是什么？

我的原因是，我正在更新 GUI，我希望用户在进行下一次更改之前看到更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:06:22.237

如果您希望更新间隔，您最好使用类似`javax.swing.Timer`. 这将允许安排定期更新，而不会导致 UI 看起来像是崩溃/挂起。

![在此处输入图像描述](../Images/84a77711da563ad0b156873482ab9428.png)

此示例将每 250 毫秒更新一次 UI

```
public class TestTimerUpdate {

    public static void main(String[] args) {
        new TestTimerUpdate();
    }

    public TestTimerUpdate() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TimerPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    protected class TimerPane extends JPanel {

        private int updates = 0;

        public TimerPane() {
            Timer timer = new Timer(250, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    updates++;
                    repaint();
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            String text = "I've being updated " + Integer.toString(updates) + " times";
            FontMetrics fm = g2d.getFontMetrics();

            int x = (getWidth() - fm.stringWidth(text)) / 2;
            int y = ((getHeight() - fm.getHeight()) / 2) + fm.getAscent();

            g2d.drawString(text, x, y);

            g2d.dispose();
        }

    }

} 
```

你也可以看看[我怎样才能让时钟滴答作响？](https://stackoverflow.com/questions/13116414/how-can-i-make-a-clock-tick/13116623#13116623)这表明了相同的想法

# c# - CreateInstance 说它是一种方法，被用作一种类型

> ID：13131980
> 
> 赞同：0
> 
> 时间：2012-10-30T02:50:11.157
> 
> 标签：c#, abstract-class, createinstance

我有一个隐含抽象类的基本程序。

```
public abstract class AbstractClass
{
    public AbstractClass (MyObject object1, MyOtherObject object2)
    {
        Console.WriteLine("This is the abstract class");
    }

    public abstract bool Function1();
    <other abstract functions>
} 
```

现在，当我想做不同的事情并为这些事情实现不同的抽象类时，我会构建和编译我的应用程序的单独版本。我觉得这很乏味。

我希望能够采用这行代码

```
new MySuperSpecialClassOfThings(param1, (MyObject obj1, MyOtherObject obj2) => 
{
    return new NotAnAbstractClass(obj1, obj2);
}, true); 
```

并将其更改为：

```
new MySuperSpecialClassOfThings(param1, (MyObject obj1, MyOtherObject obj2) => 
{
    return new System.Activator.CreateInstance(Type.GetType(config.NonAbstractClassName), new object[] { obj1, obj2 });
}, true); 
```

where`config.NonAbstractClassName`是配置文件中提供的字符串。但是，这失败了，并出现错误： `'System.Activator.CreateInstance(System.ActivationContext, string[])' is a 'method' but is used like a 'type'`

`obj1`并且`obj2`不是字符串。他们是班级。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T02:53:05.793

摆脱`new`之前的`CreateInstance`：

```
new MySuperSpecialClassOfThings(param1, (MyObject obj1, MyOtherObject obj2) => 
{
    return (AbstractClass)System.Activator.CreateInstance(Type.GetType(config.NonAbstractClassName), new object[] { obj1, obj2 });
}, true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T03:53:23.457

只需删除“new”关键字..CreateInstance 根据参数类型返回对象的新实例..所以基本上你不需要“new”关键字

# c - 创建线程 - 传递参数

> ID：13131982
> 
> 赞同：16
> 
> 时间：2012-10-30T02:50:31.123
> 
> 标签：c, multithreading, function, parameter-passing

我正在尝试创建多个线程，每个线程都计算一个素数。我正在尝试使用线程创建将第二个参数传递给函数。它不断抛出错误。

```
void* compute_prime (void* arg, void* arg2)
{ 
```

这是我的 main() 与创建线程。&max_prime 之后的 &primeArray[i] 给了我错误。

```
 for(i=0; i< num_threads; i++)
 {
    primeArray[i]=0;
    printf("creating threads: \n");
    pthread_create(&primes[i],NULL, compute_prime, &max_prime, &primeArray[i]);
    thread_number = i;
    //pthread_create(&primes[i],NULL, compPrime, &max_prime);
 }

 /* join threads */
 for(i=0; i< num_threads; i++)
{
    pthread_join(primes[i], NULL);
    //pthread_join(primes[i], (void*) &prime);
    //pthread_join(primes[i],NULL);
    //printf("\nThread %d produced: %d primes\n",i, prime);
    printf("\nThread %d produced: %d primes\n",i, primeArray[i]);
    sleep(1);
} 
```

我得到的错误是：

```
myprime.c: In function âmainâ:
myprime.c:123: warning: passing argument 3 of âpthread_createâ from incompatible pointer type
/usr/include/pthread.h:227: note: expected âvoid * (*)(void *)â but argument is of type âvoid * (*)(void *, void *)â
myprime.c:123: error: too many arguments to function âpthread_createâ 
```

如果我取出第二个参数，它工作正常。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-30T02:53:39.323

您只能将一个参数传递给您在新线程中调用的函数。创建一个结构来保存这两个值并发送结构的地址。

```
#include <pthread.h>
#include <stdlib.h>
typedef struct {
    //Or whatever information that you need
    int *max_prime;
    int *ith_prime;
} compute_prime_struct;

void *compute_prime (void *args) {
    compute_prime_struct *actual_args = args;
    //...
    free(actual_args);
    return 0;
}
#define num_threads 10
int main() {
    int max_prime = 0;
    int primeArray[num_threads];
    pthread_t primes[num_threads];
    for (int i = 0; i < num_threads; ++i) {
        compute_prime_struct *args = malloc(sizeof *args);
        args->max_prime = &max_prime;
        args->ith_prime = &primeArray[i];
        if(pthread_create(&primes[i], NULL, compute_prime, args)) {
            free(args);
            //goto error_handler;
        }
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-13T12:35:44.987

在 std::thread 的情况下，用户可以通过以下方法将参数传递给线程函数

std::thread(funcName,arg1,arg2);

例如，

```
//for a thread function, 
void threadFunction(int x,int y){
   std::cout << x << y << std::endl;
}

// u can pass x and y values as below
std::thread mTimerThread;
mTimerThread = std::thread(threadFunction,1,12); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-19T21:11:21.050

这是[Manakarse](https://stackoverflow.com/a/13132001/10388412)的代码，一切都很好，但你需要一个

**pthread_join（线程[i]，NULL）**

只是为了确保所有线程都将在主线程结束之前成功执行（“主线程将“等待”，而所有线程尚未完成）；

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-05-31T17:03:41.300

```
#include <pthread.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

typedef struct 
{
    int stop_flag;
    char name[30];
} _process_data;

typedef struct 
{
    int meter_no;
    int port_no;
} _process_control;

typedef struct 
{
   _process_data *process_data;
   _process_control *process_control;
} compute_prime_struct;

void *compute_prime (void *args) 
{
    compute_prime_struct *actual_args = args;
      printf("actual_args->process_data->stop_flag [%d]\n",actual_args->process_data->stop_flag);
      printf("actual_args->process_data->name [%s]\n",actual_args->process_data->name);
      printf("actual_args->process_control->meter_no [%d]\n",actual_args->process_control->meter_no);
      printf("actual_args->process_control->port_no [%d]\n",actual_args->process_control->port_no);
    free(actual_args);
    return 0;
}
void fill_data(_process_data *process_data,_process_control *process_control)
{
    process_data->stop_flag=1;
    process_data->name[0]='P';
    process_control->meter_no=6;
    process_control->port_no=22;

    pthread_t tid;

    compute_prime_struct *args = malloc(sizeof (*args));
    args->process_data = malloc(sizeof (*args->process_data));
    args->process_control = malloc(sizeof (*args->process_control));

    memcpy (args->process_data, process_data, sizeof (args->process_data));
    memcpy (args->process_control, process_control, sizeof (*args->process_control));

        if(pthread_create(&tid, NULL, compute_prime, args)) 
        {
            free(args);
            printf("Error here");
        }
        sleep(1);
}

int main() 
{
     _process_data process_data;
     _process_control process_control;

     fill_data(&process_data,&process_control);
    return 0;
} 
```

# jquery - 需要基本的 JQuery marginTop 帮助

> ID：13131987
> 
> 赞同：0
> 
> 时间：2012-10-30T02:51:25.843
> 
> 标签：jquery

谁能告诉我我做错了什么！尝试在单击菜单时使导航和徽标向上移动。然后，我将在导航的新位置下方显示内容。我只是通过更改 marginTop 的值来做到这一点。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
       <title>****</title>
    <link href="design/style.css" rel="stylesheet" type="text/css"/>

</head>
<body>
    <div id="headingBlock" style="margin-top:140px;">
    <div id="logo">
    <a href="index.html"> <img src="design/images/pmb_logo.png" alt="****"/>
    </a>
    </div>
    </div>

<div id="navStrip">
    <div id="navBlock">
    <div id="nav">
        <a href="index.html" id="midPage">Home</a>
        <a href="#" class="topPage">Our Homes</a>
        <a href="#" class="topPage">Displays</a>
        <a href="#" class="topPage">Where we build</a>
        <a href="#" class="topPage">Why PMB?</a>
        <a href="#" class="topPage">Style</a>
        <a href="#" class="topPage">Contact Us</a>
     </div>
    </div>
</div>

<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script type="text/javascript"> 

$(function(){
    $(".topPage").click(function(){
        $("#headingBlock").animate({
            'marginTop': "-=140px", "slow"});

});
$("#midPage").click(function(){
     $("#headingBlock").animate({
        'marginTop': "=150px"});
});
});

</script>

<p>
</p>

<div id="mainContainer" style="visibility:hidden">

<div class="mainContent"> 

<p> Lorem Ipsum is simply dummy text of the printing and typesetting industry.</br> 
Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, </br>
when an unknown printer took a galley of type and scrambled it to make a type </br>
specimen book. It has survived not only five centuries, but also the leap into </br>
electronic typesetting, remaining essentially unchanged. It was popularised in the </br>
1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more </br>
recently with desktop publishing software like Aldus PageMaker including versions of </br>
Lorem Ipsum. </p>

<p> Lorem Ipsum is simply dummy text of the printing and typesetting industry.</br> 
Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, </br>
when an unknown printer took a galley of type and scrambled it to make a type </br>
specimen book. It has survived not only five centuries, but also the leap into </br>
electronic typesetting, remaining essentially unchanged. It was popularised in the </br>
1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more </br>
recently with desktop publishing software like Aldus PageMaker including versions of </br>
Lorem Ipsum. </p>

</div>
<div id="imgHome"> <img src="design/images/builders.png" alt="Builders"/> 
</div>
</div>

<div id="footer">

<h1> Designed by <a href="http://www.AYLWARD-DESIGN.COM" > Aylward Design </a> </h1>

</div>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T02:57:38.843

更改`'marginTop': "-=140px", "slow"});`为`'marginTop': "-=140px"}, "slow");`

```
$(".topPage").click(function(){
    $("#headingBlock").animate({
        'marginTop': "-=140px"}, "slow");
}); 
```

# objective-c - Mac 中的叠加窗口

> ID：13131990
> 
> 赞同：0
> 
> 时间：2012-10-30T02:51:33.213
> 
> 标签：objective-c, macos, cocoa, overlay

[我在developer.apple.com](http://developer.apple.com/library/mac/#samplecode/FunkyOverlayWindow/Introduction/Intro.html)找到了一个覆盖窗口示例。它工作得很好，但我也想将我的程序窗口覆盖在其他全屏应用程序的窗口上。

有没有办法执行这个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T14:08:36.717

查看文档中的**窗口级别。**`NSWindow`

使用`NSScreenSaverWindowLevel`or`NSStatusWindowLevel`应该就足够了。

另请查看[http://cocoadev.com/wiki/NSWindowLevel](http://cocoadev.com/wiki/NSWindowLevel)

# android - 单击时未选择自定义 ListView

> ID：13131991
> 
> 赞同：0
> 
> 时间：2012-10-30T02:51:57.170
> 
> 标签：android, android-listview, adapter

因此，我查看了许多其他答案，但无法让我的应用程序按照我的意愿运行。我基本上想要具有文本和 的列表视图，`check mark`然后`right`是左侧的添加按钮。现在我的列表视图显示了，但检查图像从未改变。

编辑：在有用的评论之后，我发现可以使用模拟器上的箭头（向上/向下）选择行，这突出显示了我想要的行。但是，当我单击该行时，它并没有像我想要的那样被选中。此外，如果它有助于在对话框中使用列表视图。

选择器：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:state_selected="true" 
        android:drawable="@drawable/accept_on" />
    <item 
        android:drawable="@drawable/accept" />
</selector> 
```

行 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout"
    android:orientation="horizontal" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="10dp"
    android:background="#EEE">

    <ImageButton 
        android:id="@+id/goToMapButton"
        android:src="@drawable/go_to_map"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="left"    />

    <TextView 
        android:id="@+id/itemName"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:gravity="center_vertical"
        android:textColor="#000000"
        android:layout_marginTop="5dp"
        android:layout_marginBottom="5dp"
        android:layout_weight="1"     />

    <Button 
        android:id="@+id/checkButton"
        android:background="@drawable/item_selector"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="right"     />
</LinearLayout> 
```

地图适配器：

```
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.LinearLayout;
import android.widget.TextView;

public class MapAdapter extends ArrayAdapter<String>{

    Context context; 
    int layoutResourceId;    
    String data[] = null;
    LayoutInflater inflater;
    LinearLayout layout;

    public MapAdapter(Context context, int layoutResourceId, String[] data) {
        super(context, layoutResourceId, data);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
        inflater = LayoutInflater.from(context);
    }

    @Override
    public String getItem(int position) {
        return data[position];
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder = new ViewHolder();

        if(convertView == null)
        {
            convertView = inflater.inflate(R.layout.map_item_row, null);
            layout = (LinearLayout)convertView.findViewById(R.id.layout);
            holder.map = (ImageButton)convertView.findViewById(R.id.goToMapButton);
            holder.name = (TextView)convertView.findViewById(R.id.itemName);
        //holder.check = (Button)convertView.findViewById(R.id.checkButton);

            convertView.setTag(holder);
        }
        else
        {
            holder = (ViewHolder) convertView.getTag();
        }

        layout.setBackgroundColor(0x00000004);
        holder.name.setText(getItem(position));

        return convertView;
    }

    static class ViewHolder
    {
        ImageButton map;
        TextView name;
        Button check;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T04:10:02.760

像这样试试

```
 @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // Planet to display
        Planet planet = (Planet) this.getItem(position);

        // The child views in each row.
        CheckBox checkBox;
        TextView textView;

        // Create a new row view
        if (convertView == null) {
            convertView = inflater.inflate(R.layout.simplerow, null);

            // Find the child views.
            textView = (TextView) convertView.findViewById(R.id.rowTextView);
            checkBox = (CheckBox) convertView.findViewById(R.id.CheckBox01);

            // Optimization: Tag the row with it's child views, so we don't
            // have to
            // call findViewById() later when we reuse the row.
            convertView.setTag(new PlanetViewHolder(textView, checkBox));

            // If CheckBox is toggled, update the planet it is tagged with.
            checkBox.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    CheckBox cb = (CheckBox) v;
                    Planet planet = (Planet) cb.getTag();
                    planet.setChecked(cb.isChecked());
                }
            });
        }
        // Reuse existing row view
        else {
            // Because we use a ViewHolder, we avoid having to call
            // findViewById().
            PlanetViewHolder viewHolder = (PlanetViewHolder) convertView
                    .getTag();
            checkBox = viewHolder.getCheckBox();
            textView = viewHolder.getTextView();
        }

        // Tag the CheckBox with the Planet it is displaying, so that we can
        // access the planet in onClick() when the CheckBox is toggled.
        checkBox.setTag(planet);

        // Display planet data
        checkBox.setChecked(planet.isChecked());
        textView.setText(planet.getName());

        return convertView;
    } 
```

请参阅此示例 [http://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php](http://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T03:53:54.023

尝试将选择器设置为背景而不是 src

# html - 如何正确居中对齐 Div？

> ID：13131996
> 
> 赞同：4
> 
> 时间：2012-10-30T02:52:54.643
> 
> 标签：html, css

我无法正确地将[我的网站居中](http://www.voltageguitar.com)

当我缩小时，它似乎居中。但对于不缩小的用户来说，它看起来不合适。有什么建议么？该站点是使用所有 AP div 创建的，即使尝试使用以下内容，它也无法正确居中：

```
<div align="center"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T03:20:30.407

尝试**`margin:0 auto;`**容器 div 它将居中对齐您的 div :)

**[看例子](http://jsfiddle.net/sureshpattu/PeRSs/2/)**

**[查看结果的全屏视图](http://jsfiddle.net/sureshpattu/hhmUD/embedded/result/)**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-30T09:54:52.060

在 CSS 中

添加属性

```
body
{
 text-align:center;
 margin:0 auto;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-30T03:04:05.727

我认为您的设计不正确。你必须：

```
<body>
<div id="wrapper">
<div id="header">
from apdiv1 to 31
</div>
<div id="content">*/instead of blockquote*/
put content
</div>
<div id="footer">
put content</div>
</div>
</body> 
```

带有 css 主体{背景图像：混凝土 bkg.jpg}

```
#wrapper{margin:0 auto} 
```

更多更多更多... brgds