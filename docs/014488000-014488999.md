# StackOverflow 问答 14488000-14488999

# javascript - 将html元素传递给javascript中的函数

> ID：14488001
> 
> 赞同：2
> 
> 时间：2013-01-23T19:41:50.413
> 
> 标签：javascript, jquery, html

...这已被问过很多次，但我仍然无法解决我的问题。

我有一个由“box”类定义的动态创建的元素列表，如下所示：

```
<div class="box">
    <button onclick="buttonFunction(element.inputBox)"></button>
    <input class="inputBox"></input>
</div>
<div class="box">
    <button onclick="buttonFunction(element.inputBox)"></button>
    <input class="inputBox"></input>
</div>
    ....
<div class="box">
    <button onclick="buttonFunction(element.inputBox)"></button>
    <input class="inputBox"></input>
</div> 
```

然后我希望函数“buttonFunction(element)”如下所示：

```
function buttonFunction(element){
    $('.element').show()  
} 
```

其中 element 是特定框 div 的特定输入框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:43:23.587

只要您使用 jQuery，就容易多了：

HTML：

```
<div class="box">
    <button></button>
    <input class="inputBox"></input>
</div>
<div class="box">
    <button></button>
    <input class="inputBox"></input>
</div>
<div class="box">
    <button></button>
    <input class="inputBox"></input>
</div> 
```

JS（把这个放在里面`$(document).ready(...)`：

```
$('.box button').click(function(){
   $(this).next('.inputBox').show();
}); 
```

这是一个[例子](http://jsfiddle.net/sdCfD/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:44:04.410

有很多方法可以处理这种情况。通常使用 html 在元素上放置点击事件不是最佳实践。这是一个适合您的示例的强类型解决方案。它将被点击的元素（按钮元素）传递给函数。然后，编写的函数将找到最接近类的元素并向其`inputBox`发出 jquery `show()`。

html

```
<button onclick="buttonFunction(this)"></button> 
```

js

```
function buttonFunction(el){
 $(el).parent().find('.inputBox').show();  
} 
```

# opengl-es - 带有 mipmap 的 PVRTC 纹理保持黑色

> ID：14488005
> 
> 赞同：2
> 
> 时间：2013-01-23T19:42:15.773
> 
> 标签：opengl-es, textures, pvrtc

我最近更新了纹理的加载代码，还添加了一些新功能，如 mipmap 加载（最后一个应用程序只有 2D，所以我不需要它们）。但是加载的 PVRTC 纹理在使用 mipmap 时保持黑色，没有 mipmap 一切都按预期工作，并且在使用像 RGBA8888 纹理这样的纹理时，mipmap 也可以工作。

**加载压缩数据：**

```
for (int i = 0; i < source.MipmapCount; i++)
{
    data = source.GetData(i);
    GLTextures.CompressedTexImage2D(TextureType.TEXTURE_2D, i, Format.CompressedFormat.Value, Width >> i, Height >> i, data.Length, data);
    Debug.WriteGLError("Texture2D->CompressedTexImage2D", "MipmapLevel={0}", i);
} 
```

**过滤设置：**

```
if (source.MipmapCount == 0)
{
    switch (filterQuality)
    {
        case FilterQuality.Nearest:
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MIN_FILTER, (Int32)TextureMinFilterParams.NEAREST);
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MAG_FILTER, (Int32)TextureMagFilterParams.NEAREST);
            break;
        case FilterQuality.Linear:
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MIN_FILTER, (Int32)TextureMinFilterParams.LINEAR);
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MAG_FILTER, (Int32)TextureMagFilterParams.LINEAR);
            break;
    }
    Debug.WriteGLError("Texture2D->TexParameteri without mipmaps");
}
else
{
    switch (filterQuality)
    {
        case FilterQuality.Nearest:
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MIN_FILTER, (Int32)TextureMinFilterParams.NEAREST_MIPMAP_LINEAR);
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MAG_FILTER, (Int32)TextureMagFilterParams.NEAREST);
            break;
        case FilterQuality.Linear:
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MIN_FILTER, (Int32)TextureMinFilterParams.LINEAR_MIPMAP_LINEAR);
            GLTextures.TexParameteri(TextureType.TEXTURE_2D, TexParameter.TEXTURE_MAG_FILTER, (Int32)TextureMagFilterParams.LINEAR);
            break;
    }

    Debug.WriteGLError("Texture2D->TexParameteri with mipmaps");

    if (anisotropicQuality > 1f && GL.IsExtensionSupported(Extension.GL_EXT_texture_filter_anisotropic))
    {
        // GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT 
        GLTextures.TexParameter(TextureType.TEXTURE_2D, 0x84FF, Mathf.Clamp(anisotropicQuality, 1f, GL.GetFloat(GetFloatName.TEXTURE_MAX_ANISOTROPY)));
        Debug.WriteGLError("Texture2D->Anisotropy");
    }
} 
```

**纹理** 的加载 加载是通过修改后的 PVR 文件参考加载器完成的。我检查了每个 mipmap 的字节长度，最后几个数组的大小为 32 个字节（ PVRTC 的最小大小）。什么可能导致问题？

### 编辑

方法“GLTextures.CompressedTexImage2D”。

```
public static void CompressedTexImage2D(TextureType target, Int32 level, CompressedFormats internalFormat, Int32 width, Int32 height, Int32 imageSize, Byte[] pixels)
{
    /* Used for mobile apps for debugging purposes */
    Debug.CheckMethodLoaded(glCompressedTexImage2D);
    Profiler.IncreaseCallCount("glCompressedTexImage2D");
    glCompressedTexImage2D(target, level, internalFormat, width, height, 0, imageSize, pixels);
} 
```

**图像格式定义：**

```
PVRTC2RGB = new ImageFormat("PVRTC2RGB", CompressedFormats.COMPRESSED_RGB_PVRTC_2BPPV1_IMG, 16, 8, bitsPerPixel: 2, requiredExtension:Extension.GL_IMG_texture_compression_pvrtc);
PVRTC2RGBA = new ImageFormat("PVRTC2RGBA", CompressedFormats.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG, 16, 8, bitsPerPixel: 2, requiredExtension: Extension.GL_IMG_texture_compression_pvrtc);
PVRTC4RGB = new ImageFormat("PVRTC4RGB", CompressedFormats.COMPRESSED_RGB_PVRTC_4BPPV1_IMG, 8, 8, bitsPerPixel: 4, requiredExtension: Extension.GL_IMG_texture_compression_pvrtc);
PVRTC4RGBA = new ImageFormat("PVRTC4RGBA", CompressedFormats.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG, 8, 8, bitsPerPixel: 4, requiredExtension: Extension.GL_IMG_texture_compression_pvrtc); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-14T16:43:44.907

我刚刚使用 cocos2d-x 遇到了类似的问题。经过大量调试后，我终于弄明白了：确保提供**完整的 mipmap 链**（低至 1x1）或将 Apple 的**GL_TEXTURE_MAX_LEVEL_APPLE**纹理参数设置为正确数量的 mipmap。不幸的是，Apple 自己的 TextureTool 输出只有 8x8（应该是下限，但现在不是了）。甚至来自 Apple 的 PVRTextureLoader 示例代码也不能开箱即用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T11:12:58.463

**编辑**：更正。

我相信您的纹理 min/mag 过滤器必须是：

*   `GL_LINEAR_MIPMAP_NEAREST`对于最小过滤器
*   `GL_LINEAR`用于磁力过滤器

将 mipmap 与 PVRTC 一起使用时。查看头文件： http: [//ne3d.googlecode.com/svn-history/r3/trunk/Lib/SRC/Tools/OGLES/PVRTTextureAPI.h](http://ne3d.googlecode.com/svn-history/r3/trunk/Lib/SRC/Tools/OGLES/PVRTTextureAPI.h)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T03:40:48.363

确保 glCompressedTexImage2D 中的“imageSize”在任何 mipmap 级别都大于 32。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-05T15:16:46.070

要在 PVRTC 纹理上实现 mipmap“效果”，您应该使用：

*   使用过滤器 GL_LINEAR。
*   使用你自己计算的 lod 值使用 texture2DLod(EXT) 获取纹理颜色。

# entity-framework - 安装 EF 4.4.0.0

> ID：14488014
> 
> 赞同：15
> 
> 时间：2013-01-23T19:42:39.110
> 
> 标签：entity-framework, visual-studio-2012, nuget

目前我在 Visual Studio 2012 中安装了 Entity Framework 5.0。出于某种原因，该项目仅受 EF 4.4.0.0 支持。

所以我安装了 EF 4.4.0.0 但在 Nuget 命令行中出现错误：

> PM> Install-Package EntityFramework -Version 4.4.0.0 Install-Package：找不到包“EntityFramework”的“4.4.0.0”版本。在 line:1 char:1 + Install-Package EntityFramework -Version 4.4.0.0 + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~ + CategoryInfo : NotSpecified: (:) [Install-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand

下午>

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-23T19:48:19.220

您看到的版本控制问题是由于 EF 可以支持的内容不同，具体取决于您的应用程序所针对的 .NET 运行时版本。

如果您的目标是 .NET 4 并安装 EF 5，则程序集版本将为 4.4

如果您的目标是 .NET 4.5 并安装 EF 5，则程序集版本将为 5.0

这是因为诸如 DBGeography 之类的东西只有在存在 .NET 4.5 时才能工作。

只需正确安装 EF 5，NuGet 包就会解决这个问题并为您提供正确的版本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-09T07:56:16.700

tl;tr 当您需要 .NET 4.0 上的程序集版本 4.4.0.0 时，只需在包管理器控制台中键入：

```
PM> Install-Package EntityFramework -Version 5.0.0.0 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-23T19:47:35.013

好的，所以这里的交易是 EF 5 仅受 .net 4.5 项目支持（即没有 .net 4）。但是，如果您有一个 .NET 4 项目并尝试安装 EF 5，他们所做的就是为您提供另一个与 .NET 4 一起运行的二进制文件（称为 EF 4.4）。

这意味着您需要做的就是安装 EF 5 包，您将获得正确的 (4.4) 版本的 EF。

有关 EF 团队的更多信息，请参阅[http://brice-lambson.blogspot.ca/2012/10/unicorn-myths-debunked-entity-framework.html](http://brice-lambson.blogspot.ca/2012/10/unicorn-myths-debunked-entity-framework.html)

# java - Java在不同的类文件中包含片段？

> ID：14488018
> 
> 赞同：2
> 
> 时间：2013-01-23T19:42:58.460
> 
> 标签：java, android

我写了一个监听器，它在 KeyDown 上执行一些操作，基本上我需要将它包含在我的所有活动中，但我是 Java 新手，不知道最好的方法，我当然可以将代码复制粘贴到每个类但是让每个人都更新会很痛苦。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
    if(sharedPrefs.getBoolean("pref_disable_keydowns", true)) {
        System.out.println("Prevent keydown");
        return true; 
        }
    return super.onKeyDown(keyCode, event);
} 
```

如何将它包含在不同的 .java 文件中，这样我只需修改一次即可影响它包含的所有类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:47:57.037

不要在（几乎）没有任何情况下将代码从一种方法复制到另一种方法。

现在到您的解决方案：

```
public class MyListerer implement KeyListener {

    public void onKeyDown(int keyCode, KeyEvent event){
        Toast.makeText(this, "Hey world!", Toast.LENGTH_LONG).show();
    }
} 
```

现在你可以制作

```
object.addKeyListener(new MyListener()); 
```

我很确定，接口`KeyListener`可能有不同的名称，但我想你明白了。

**更新**

都是关于 Android 活动的吗？[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

在这种情况下，您可以以不同的方式实现它。Android 活动中没有事件监听器。您可以执行以下操作：

```
class MyActivity extends Activity {

    private MyListener delegate= new MyListener();

    // your existing code

    public boolean onKeyDown(int keyCode, KeyEvent event)  {
        delegate.onKeyDown(keyCode, event);
    }

} 
```

# java - 如何制作 JFrame 动画？

> ID：14488019
> 
> 赞同：0
> 
> 时间：2013-01-23T19:43:09.200
> 
> 标签：java, swing, animation, jframe

我想知道是否有任何库或其他东西可以像 BUZZ 一样为 JFrame 设置动画！yahoo messenger中的动画，如果没有现有的库可以做到这一点，那么可能的算法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:37:58.987

您可以为正在处理的框架创建自己的 Buzz 方法。看看下面给出的代码。

**编辑** 按照 MadProgrammer 和 DavidKroukamp 的建议，我已更改代码以符合标准。:)

```
import javax.swing.JFrame;
import javax.swing.JButton;
import javax.swing.SwingUtilities;
import java.awt.BorderLayout;
import java.awt.Point;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

class BuzzFrame extends JFrame 
{
    private JButton buzz = new JButton("BUZZ ME!!");
    public BuzzFrame ()
    {
        super("BUZZ Frame!!");
    }
    public void prepareGUI()
    {
        buzz.addActionListener(new BuzzActionListener(this));
        setSize(300,200);
        getContentPane().add(buzz,BorderLayout.NORTH);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
    public static void main(String st[])
    {
        SwingUtilities.invokeLater ( new Runnable()
        {
            @Override
            public void run()
            {
                BuzzFrame bFrame = new BuzzFrame();
                bFrame.prepareGUI();
                bFrame.setVisible(true);
            }
        });
    }
}
class BuzzActionListener implements ActionListener
{
    private JFrame frame;
    private Point currLocation;
    private int iDisplaceXBy = 5;
    private int iDisplaceYBy = -10;
    public BuzzActionListener(JFrame frame)
    {
        this.frame = frame;
    }
    @Override
    public void actionPerformed(ActionEvent evt)
    {
        currLocation = frame.getLocationOnScreen();
        fireBuzzAction();
    }
    private void fireBuzzAction()
    {
        SwingUtilities.invokeLater ( new Runnable() 
        {
            @Override
            public void run()
            {
                Point position1 = new Point( currLocation.x + iDisplaceXBy , currLocation.y + iDisplaceYBy );
                Point position2 = new Point( currLocation.x - iDisplaceXBy , currLocation.y - iDisplaceYBy );
                for (int i = 0; i < 20 ; i++)
                {
                    frame.setLocation(position1);
                    frame.setLocation(position2);
                }
                frame.setLocation(currLocation);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:51:04.103

看一眼

*   [时序框架](http://java.net/projects/timingframework)
*   [三叉戟](http://kenai.com/projects/trident/pages/Home)
*   [补间通用引擎](http://code.google.com/p/java-universal-tween-engine/)

您将需要评估每个，以确定最能满足您的需求

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-30T16:09:32.533

我用一个简单的功能做到了这一点：

```
public void ZUMBIDO() {
        toFront();

        new Thread(new Runnable() {

            int milisegundos = 50;
            int posiciones = 20;

            public void arriba() {

                Point pos = getLocation();
                pos.translate(0, posiciones);
                setLocation(pos);

            }

            public void abajo() {
                Point pos = getLocation();
                pos.translate(0, -posiciones);
                setLocation(pos);
            }

            public void derecha() {
                Point pos = getLocation();
                pos.translate(posiciones, 0);
                setLocation(pos);
            }

            public void izquierda() {
                Point pos = getLocation();
                pos.translate(-posiciones, 0);
                setLocation(pos);
            }

            public void proceso() {
                try {
                    arriba();
                    Thread.sleep(milisegundos);
                    derecha();
                    Thread.sleep(milisegundos);
                    abajo();
                    Thread.sleep(milisegundos);
                    izquierda();
                    Thread.sleep(milisegundos);
                } catch (InterruptedException ex) {
                    Logger.getLogger(cliente.class.getName()).log(Level.SEVERE, null, ex);
                }
            }

            @Override
            public void run() {

                for (int i = 0; i <= 5; i++) {
                    proceso();
                }

            }

        }).start();

    }
```

您可以使用下一个代码观看它的实际操作，它是一个带有回声概念的简单聊天。

[https://github.com/MikeSoft/Sistemas_Operativos_Clase/blob/master/chat/src/sistemas/operativos/cliente.java](https://github.com/MikeSoft/Sistemas_Operativos_Clase/blob/master/chat/src/sistemas/operativos/cliente.java)

# android - ViewPager 如何仅在 PagerTitleStrip 上方滑动视图

> ID：14488022
> 
> 赞同：3
> 
> 时间：2013-01-23T19:43:16.407
> 
> 标签：android, android-viewpager

背景故事：

我已经搞砸了一段时间，找不到任何像样的文档。我被锁定必须支持 api 级别 8，因此查看寻呼机似乎是一个很好的解决方案。我已经让它与 pagerTitleStrip 一起工作。但是，我只希望用户在 pagerTitleStrip 上滑动时能够在视图之间滑动。我有一些工作。

问题：

当我在按钮、edittext 字段等的顶部 (touch_move) 上滑动时。viewpager 仅将一小部分其他视图带入窗口。除非在视图之间滑动的 touchmove 事件位于 pagerTitleStrip 之上，否则我不希望发生任何事情。

失败的尝试：

我已经设置了 viewPager 的 onTouchListener 和我用来确定用户是否在 pagerTitleStrip 上滑动的任何 onTouch 事件操作（touchmove、touchup、touchdown）。

```
//in onCreate()
...
setContentView(R.layout.pager_adapter);
dashboardPagerAdapter = new DashboardPagerAdapter(
getSupportFragmentManager());
dashboardViewPager = (ViewPager) findViewById(R.id.dashboard_pager);
dashboardViewPager.setAdapter(dashboardPagerAdapter);
dashboardViewPager.setId(R.layout.activity_dashboard);
dashboardViewPager.setCurrentItem(DashboardPagerAdapter.DASHBOARD);
dashboardViewPager.setOnTouchListener(this);
...

// in onTouch
View pagerTitleArea = findViewById(R.id.pager_title_strip);
    int pagerTitleBottomYLocation = pagerTitleArea.getBottom();
    initialYPositionOfEvent = 100; // set the initial position out of range.
    int action = event.getAction();

    if (action == MotionEvent.ACTION_DOWN){
        initialYPositionOfEvent = event.getY();
        originWasTitleBar = (initialYPositionOfEvent > pagerTitleBottomYLocation) ? false : true ;
        hasTouchDownEventOccured = true;
        return true;
    } else if (action == MotionEvent.ACTION_MOVE){
        if(originWasTitleBar && hasTouchDownEventOccured){
            return false;
        } else {
            return true;
        }
    } else {
        if(originWasTitleBar && hasTouchDownEventOccured){
            originWasTitleBar = false;
            hasTouchDownEventOccured = false;
            return false;
        } else {
            originWasTitleBar = false;
            hasTouchDownEventOccured = false;
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T20:44:16.900

使用带有按钮的 ViewFlipper 来切换内容，或者使用操作栏选项卡，或者类似的东西，也许。

# ruby - 在osx的脚本中获取cpu使用情况

> ID：14488023
> 
> 赞同：4
> 
> 时间：2013-01-23T19:43:20.607
> 
> 标签：ruby, macos, system, cpu-usage

在 linux 上，我可以从 ; 中获取当前的 CPU 使用率`/proc/stat`。OSX 有没有等价物？或者一些返回易于解析和一致输出的实用程序？我在 Ruby 程序中需要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:48:52.933

有一些方法，我所知道的都依赖于命令行工具：

*   `$` [`top`](http://en.wikipedia.org/wiki/Top_%28software%29)
*   `$` [`system_profiler`](http://en.wikipedia.org/wiki/System_Information)
*   `$ iostat -1`

如果您想保持较低的解析工作量，请尝试通过将有用的参数应用于工具来减少输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T18:29:13.760

`sysctl`易于解析；您可以通过检查该值来获得负载平均值`vm.loadavg`。

```
$ sysctl vm.loadavg
vm.loadavg: { 0.57 0.80 0.85 } 
```

# javascript - 专注于单选按钮

> ID：14488024
> 
> 赞同：0
> 
> 时间：2013-01-23T19:43:22.470
> 
> 标签：javascript, html, radio-button

**目标：**修复下面的代码，并理解为什么关注单选按钮不像关注文本输入框那样工作。

**问题：**为什么这不起作用：

```
function isValidRadio(elem, helperMsg) {
    var valid = false;
    for (var i = 0; i < elem.length; i++) {
        if (elem[i].checked) {
            return true;
        }
    }
    alert(notice);
    setTimeout("focusElement('" + elem.form.name + "', '" + elem.name + "')", 0);
    return false;
} 
```

...当这样做时：

```
function isValidText(elem, notice) {
    var str = elem.value;
    var re = /.+/;
    if(!str.match(re)) {
        alert(notice);         
        setTimeout("focusElement('" + elem.form.name + "', '" + elem.name + "')", 0);
        return false;
    } else {
        return true;
    }
} 
```

*示例代码：*

```
function focusElement(formName, elemName) {
    var elem = document.forms[formName].elements[elemName];
    elem.focus();
    elem.select();
}
function validateForm(form) {
    if (isValidText(form.phone, "Fail."))  {
        if (isValidRadio(form.yesNo, "Fail."))  {
            return true;
        }
        return false;
    }
}
<form id='myForm' action='/formPage/collectinfo/' method='post' accept-charset='UTF-8' name="myForm">
    <input name="phone" type="text" maxlength="14" size="14" />
    <input type="radio" name="yesNo" value="Yes"> Yes <input type="radio" name="yesNo" value="No" > No
<input type="submit" value=" Submit " name="Submit" onclick="return validateForm(myForm)" /> 
```

**详细信息：**我正在使用 php/javascript/html，到目前为止，我只在 Chrome 中测试过这部分。表单工作得很好，验证工作直到它点击 isValidRadio。警报运行，但随后 javascript 中断。代码修复会很棒，但我不介意“一生都在钓鱼......”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T17:02:06.520

好吧，我找到了解决方案，AlienWebguy 让我在考虑数组方面走上了正轨。我只需要指定要关注的单选按钮而不是哪个单选按钮。这是工作代码：

```
// Validate that the user has checked one of the radio buttons
function isValidRadio(radio, helperMsg) {
    var valid = false;
    for (var i = 0; i < radio.length; i++) {
        if (radio[i].checked) {
            return true;
        }
    }
    alert(helperMsg);
    radio[0].focus();
    return false;
} 
```

致电方式：`isValidRadio(form.yesNo, "Error.")`感谢您的协助。

# ajax - Spring MVC 和 Ajax：调用使用 Token 的 URL 时出现错误 404

> ID：14488026
> 
> 赞同：0
> 
> 时间：2013-01-23T19:43:25.807
> 
> 标签：ajax, spring, passwords, uri, token

我正在实施“忘记密码”功能。我正在使用 Spring MVC 和 Ajax，但是当我想使用令牌 url 通过 Ajax 调用 spring 控制器方法时遇到了一些麻烦。我的代码是这样的：

**弹簧控制器**

```
@RequestMapping(value="/resetPassword/{token}", method = RequestMethod.POST)
public @ResponseBody String doResetPassword(@PathVariable("token") String tokenID, 
        @RequestParam String newPassword, HttpServletRequest request) { ... } 
```

*令牌*是用户请求重置密码并通过电子邮件获得临时链接时随机生成的唯一 ID，该链接将他/她重定向到重置密码页面。

**阿贾克斯函数**

```
 $.ajax({
              type: "POST",
              url: "./resetPassword/" + token,
              data: "newPassword=" + password,    
              async: false,
              success: function(response){               
                 ... 
```

当我进行 Ajax 调用时，我收到**404 Page Not Found**错误。

**注意：** URL 格式有效。我已经使用了`./`
显示重置密码表单的控制器方法的其他 Ajax 功能，如下所示：

```
@RequestMapping(value="/resetPassword/{token}")
public String showResetPasswordPage(Model model, @PathVariable("token") String token){
    model.addAttribute("token", token);
    return "account/resetPassword";
} 
```

当用户实际单击按钮（输入新密码后）时，先前的请求方法会出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:26:59.277

如果不需要相对路径，请尝试删除第一个点，并将路径设为绝对路径；

```
 $.ajax({
              type: "POST",
              url: "/absolutepath/resetPassword/" + token,
              data: "newPassword=" + password,    
              async: false,
              success: function(response){ 
```

您使用的是哪个 IDE？许多，比如 IntelliJ，支持一个 rest 服务工具来从你的 IDE 测试这些 web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:54:40.963

简化。将其分解并分别验证每个部分，然后将它们放在一起。

*   尝试先使用浏览器而不是 ajax 来确定您的问题是在 ajax 中还是在请求映射中。您可以为您的浏览器尝试一个 rest 插件，以使其更容易发布，或者只是硬编码一个表单`action="resetPassword/1234-asdf-1234-asdf`和一个名为 newPassword 的输入框。
*   然后，查看令牌，看看是否有需要进行 URL 编码的字符。
*   确保令牌不为空（即，它从 JSP 模型正确填充到 javascript 变量中。
*   然后在 ajax 中对 URL 进行硬编码，以确保它可以正常工作。（我怀疑您可以删除`./`resetPassword 前面的）
*   ？？？
*   利润。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T19:54:51.973

**编辑：** 尝试编码 URL：

```
url: "./resetPassword/" + encodeURIComponent(token), 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T20:35:42.980

**解决了。**我不得不删除部分 Ajax url。现在启动了 Spring 控制器方法，并且密码重置现在工作正常。

**前：**

```
 url: "./resetPassword/" + token, 
```

**后：**

```
 url: "./" + token, 
```

谢谢大家的意见和帮助。

# java - glassfish 忽略 hibernate.id.new_generator_mappings？

> ID：14488030
> 
> 赞同：5
> 
> 时间：2013-01-23T19:43:35.090
> 
> 标签：java, hibernate, glassfish

我正在使用 Hibernate 3.6.9final 和 Glassfish 3.1.1。

当我启动我的应用程序时，我收到以下警告：“Hibernate 不支持`SequenceGenerator.initialValue()`除非`hibernate.id.new_generator_mappings`”。

根据文档，我可以通过启用/禁用该`hibernate.id.new_generator_mappings`值来打开/关闭对新序列生成器的支持。在我`persistence.xml`的属性中，我设置了以下选项：

```
<property name="hibernate.id.new_generator_mappings" value="true"/> 
```

这似乎被完全忽略了，我仍然收到警告。这是不能在persistence.xml 中设置的设置吗？我没有在应用程序中使用 AnnotationConfiguration，也没有 a`hibernate.cfg.xml`或`hbm.xml`.

建议？

# hdl - 我的 DMux 4 方式有什么问题？

> ID：14488036
> 
> 赞同：11
> 
> 时间：2013-01-23T19:43:42.397
> 
> 标签：hdl, mux, nand2tetris

它似乎接近工作，显然只是在第 7 行搞砸了？

```
/**
 * 4-way demultiplexor.
 * {a,b,c,d} = {in,0,0,0} if sel==00
 *             {0,in,0,0} if sel==01
 *             {0,0,in,0} if sel==10
 *             {0,0,0,in} if sel==11
 */

CHIP DMux4Way {
    IN in, sel[2];
    OUT a, b, c, d;

    PARTS:
    DMux(in = in, sel = sel[0], a = out1, b = out2);

    DMux(in = out1, sel = sel[1], a = a, b = b);
    DMux(in = out2, sel = sel[1], a = c, b = d);
} 
```

我已经按如下方式实现了我的 DMux，我只是把它当作一棵树来使用：

```
/**
 * Dmultiplexor.
 * {a,b} = {in,0} if sel==0
 *         {0,in} if sel==1
 */

CHIP DMux {
    IN in, sel;
    OUT a, b;

    PARTS:
    Not(in = sel, out = notsel);
    And(a = in, b = notsel, out = a);
    And(a = in, b = sel, out = b);
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-10T12:54:03.393

你有正确的想法！但是您已经开始缩小 sel[0] 而不是 sel[1]，它对应于左列。

PS：我知道我迟到了

编辑：根据以下请求添加了固定代码。感谢您的反馈

```
CHIP DMux4Way {
    IN in, sel[2];
    OUT a, b, c, d;

    PARTS:
    DMux(in = in, sel = sel[1], a = out1, b = out2);

    DMux(in = out1, sel = sel[0], a = a, b = b);
    DMux(in = out2, sel = sel[0], a = c, b = d);
} 
```

在缩小真值表中左列的范围（即 sel[1]; 记得在计算时从右开始），您将有效地在中间拆分选项

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-05-28T07:41:22.620

另一种更接近OP试图做的方法（以及他错过正确的部分）：

将输出中的 b 和 c 交换到不同的行，如下所示：

```
CHIP DMux4Way {

IN in, sel[2];
OUT a, b, c, d;

PARTS:
// Put your code here:
DMux(in=in, sel=sel[0], a=dOut1, b=dOut2);

DMux(in=dOut1, sel=sel[1], a=a, b=c);

DMux(in=dOut2, sel=sel[1], a=b, b=d); 
```

}

鉴于您正在缩小 sel[0] 范围，您可以从真值表中看到这也是有道理的

# c# - 如何以编程方式单击另一个站点上的按钮？

> ID：14488039
> 
> 赞同：2
> 
> 时间：2013-01-23T19:43:57.837
> 
> 标签：c#, asp.net, web-scraping, web-crawler

我想用我的程序（asp.net/C#）进入另一个站点。

1.  我如何抓取网站并找到用户名和密码文本框并用所需的数据填充它们。
2.  那么我如何按下/触发登录按钮？

注意：我之前使用 HtmlAgilityPack 抓取了网站。有没有办法使用这个 dll 或任何其他 dll？

例如，用户名是：用户密码是：密码，登录按钮 ID 是：按我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T11:15:09.557

你不想那样工作。您需要模拟一旦该表单通过 Post 请求提交到服务器并传递值后站点将执行的操作。您可以通过使用 Fiddler2 并正常执行表单提交来评估网站的功能，然后总结如下：

```
HttpWebRequest request;
        HttpWebResponse response;
        var responseData = "";
        var strUrl = "https://auctions.godaddy.com/trpSearchResults.aspx";

        var postData = string.Format("action=review_selected_add&items={0}_B_{1}_1|&rnd={2}&JlPYXTX=347bde7", auctionRef, bid,
            randomDouble(0, 1).ToString("0.00000000000000000"));
        request = (HttpWebRequest)WebRequest.Create(strUrl);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        request.ContentLength = postData.Length;
        request.Accept = "text/html, application/xhtml+xml, */*";
        request.Accept = "image/gif, image/jpeg, image/pjpeg, image/pjpeg, application/x-shockwave-flash, application/msword, application/vnd.ms-powerpoint, application/vnd.ms-excel, application/x-silverlight, application/x-silverlight-2-b2, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*";
        request.UserAgent = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11";
        request.Headers.Add("Accept-Encoding", "deflate");
        request.Referer = "auctions.godaddy.com";
        request.Headers["my-header"] = "the-value";
        request.KeepAlive = true;
        request.CookieContainer = cookies;
        request.Timeout = Timeout.Infinite;

        var stOut = new StreamWriter(request.GetRequestStream());
        stOut.Write(postData);
        stOut.Flush();
        stOut.Close();
        stOut = null;

        response = (HttpWebResponse)request.GetResponse();
        response.Cookies = request.CookieContainer.GetCookies(request.RequestUri);
        var encoding = new System.Text.UTF8Encoding();
        var responseReader = new StreamReader(response.GetResponseStream(), encoding, true);

        encoding = new System.Text.UTF8Encoding();
        responseReader = new StreamReader(response.GetResponseStream(), encoding, true);

        responseData = responseReader.ReadToEnd();
        response.Close();
        responseReader.Close(); 
```

只需使用上述方法创建一个类来发布数据并返回 html。

# xamarin.ios - 选择 UITableView 行后隐藏子视图

> ID：14488040
> 
> 赞同：1
> 
> 时间：2013-01-23T19:43:59.540
> 
> 标签：xamarin.ios, uitableview

我在注册屏幕上的视图控件中有一个表格视图。当在表中选择一行时，我只想关闭包含 tableview 的视图。像这样的东西：

```
public override void RowSelected (UITableView tableView, NSIndexPath indexPath)
{
    registrationScreen = new RegistrationScreen();
    registrationScreen.subView.Hidden = true;
} 
```

我不确定我是否应该创建注册屏幕的新实例，因为在我这样做之后子视图为空，当然它不起作用。我想我错过了一些非常简单的东西，但我不知道如何完成。对我所缺少的有任何帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T13:24:16.653

我自己在 iOS 上的封装有很多问题。我总是在与诸如此类的事情作斗争，我如何从这里进入这个类？

一种简单的方法是将 传递`RegistrationScreen`给您的`UITableViewSource`：

```
private class YourDataSource : UITableViewSource {

    RegistrationScreen screen;

    public YourDataSource(RegistrationScreen screen) {
        this.screen = screen;
    }

    //rest of class
} 
```

传入你的实例`RegistrationScreen`，然后你就可以`screen`在你的`RowSelected`.

你的问题在正确的轨道上吗？

# .net - 水银。是否可以知道文件是否已“签出”

> ID：14488046
> 
> 赞同：0
> 
> 时间：2013-01-23T19:44:12.410
> 
> 标签：.net, visual-studio, version-control, mercurial, visual-sourcesafe

我们决定将 .NET 项目的源代码控制从 SourceSafe 切换到 Mercurial。

现在的问题是，是否有可能知道解决方案中的哪个文件被“提取”（签出），如果是，由谁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:34:56.903

“签出”用于指示其他人不应修改该文件。这通常被称为**锁定**，但它不再是 VCS 系统如何工作的基础；现代系统可以**逐行合并更改，**并在更改冲突的极少数情况下提供交互式帮助。（当我第一次听说它时我持怀疑态度，但它真的很好用）。

在 Mercurial 中，每个用户都有自己的存储库克隆。我假设您的组织还建立了一个每个人都与之同步的“中央”存储库。坐在您的工作站前，使用`hg incoming`它来查明其他人是否已将更改推送到您尚未拥有的中央服务器。但是您只会看到已“推送”到中央存储库的更改。在 mercurial 中，用户可以多次签入对其本地克隆的更改，并且在它们被“推送”到中央存储库之前，它们将保持私有状态。所以你不能问谁*打算*修改某个文件，只能问谁已经提交了修改。

（警告：这遗漏了很多细节。研究[mercurial 的书](http://hgbook.red-bean.com/read/)以了解系统的工作原理，以及如何充分利用它）。

也就是说，**mercurial 确实具有文件锁定功能。**它由[LockExtension 提供。](http://mercurial.selenic.com/wiki/LockExtension)您可以将某些类型的文件配置为需要锁定；其他用户可以查看文件是否被锁定，并且被阻止向其推送更改（除非他们“窃取”您的锁，因为您可能会锁定文件并去度假，所以他们可以这样做）。

最后：在评论中，您提到了某种文件，不应由一个以上的人处理。在反复无常的术语中，这是一个永远不应合并更改的文件。图像文件和其他所谓的“二进制”格式最常出现这种情况。处理它们的灵活方法不是锁定，而是**防止工具不连贯地“合并”**两个二进制修改。您可以通过将`[merge-patterns]`配置设置为将您的特殊文件视为“二进制”来做到这一点；看到[这个问题](https://stackoverflow.com/questions/4962810/mercurial-merge-strategy-per-file-type)得到一般的想法。

简而言之：如果你真的想要锁，你可以拥有它们，但是有更好的方法来管理你的团队的协作。学会利用它们，你可能根本不需要锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T19:51:16.060

在 mercurial 中，文件不会像这样“签出”，而是在 mercurial 的暂存区域（本地）中跟踪文件。如果你`hg status`从终端运行。它将向您显示它正在跟踪的当前修改的文件以及它不知道的任何文件。

因此，当您提交时，它将提交已修改的跟踪文件。要将未跟踪的文件添加到暂存区域，您可以添加所有未跟踪的文件`hg add .`

您无需担心签出文件，mercurial 知道您所做的更改。

当您使用 Visual Studio 时，您可以安装一个插件（[类似这样的东西](http://visualhg.codeplex.com/)），它将 Mercurial 与 IDE 集成并在解决方案资源管理器中显示不同的图标来修改文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T06:45:43.770

不，Mercurial 没有完全的“锁定/解锁”模型，只有分支/合并。合并完全不是问题，如果在处理过程中必须合并*二进制工件，它**可能*只有一些缺点（并且在 SCM 中存储这种类型的对象无论如何都是反模式）。

 *对于 DVCS 而言，锁定的情况比 CVCS 更糟糕 - 因为每个工作区都有自己的存储库副本，独立于其他工作区，因此无法检查和检测所有克隆中*某些文件的状态。*

如果存储库中的可变二进制对象对于您的工作流程来说是**必须**的并且您无法避免它，您可以考虑两个（不同的）事情：

*   为您的二进制文件查找、添加、使用特殊的 diff/merge 工具（Mercurial 允许对不同的文件扩展名进行单独的differ-merger - 请参阅使用 docdiff "from a box" 获取某些文件类型）
*   选择另一个 SCM，其中仍然存在锁定模型（我只能即时回忆 Subversion）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T19:50:08.650

不，Mercurial 是分散的源代码控制。没有办法可靠地知道其他人可能检查了什么。

也许你可以用钩子构建一些东西，但我建议不要这样做。您可能最终会在维护这样的解决方案时遇到麻烦，而且它会很脆弱，因为可以在本地禁用挂钩。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:44:06.010

Mercurial [LockExtension 在](http://mercurial.selenic.com/wiki/LockExtension) 概念上提供了您正在寻找的东西，但我不确定它是否已准备好迎接黄金时段。我无法让它与中央存储库一起运行。*

# curl - 使用 cURL 访问 Guvnor REST API

> ID：14488050
> 
> 赞同：1
> 
> 时间：2013-01-23T19:44:30.060
> 
> 标签：curl, drools, guvnor

使用 cURL 访问 Guvnor 服务器的任何示例？

**尝试1：**

```
 curl -i --user username:pwd -H"Content-Type: application/json" -X GET localhost:8080/guvnor-server/rest/packages 
```

**回报：**

```
 HTTP/1.1 401 Unauthorized 
```

**尝试2：**

```
curl -X GET -u"username:pwd" localhost:8080/guvnor-server/rest/packages.json 
```

**回报：**

```
 HTTP/1.1 404 Not Found 
```

参考：docs.jboss.org/drools/release/5.5.0.CR1/drools-guvnor-docs/html/ch09 dot html

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T17:40:11.267

这在 Tomcat 7 下的 Guvnor 5.5.0.Final 上对我有用

使用：

```
curl -v -u {user}:{password} -H "Accept: application/json" curl-X GET localhost:8080/drools-guvnor/rest/packages 
```

回报：

```
* About to connect() to localhost port 8080 (#0)
*   Trying ::1... connected
* Server auth using Basic with user '{user}'
> GET /drools-guvnor/rest/packages HTTP/1.1
> Authorization: Basic ZGF2aWQ6ZGF2aWQ=
> User-Agent: curl/7.22.0 (i686-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3
> Host: localhost:8080
> Accept: */*
>
< HTTP/1.1 200 OK
< Server: Apache-Coyote/1.1
< Set-Cookie: JSESSIONID=68225AF4B272E5CCA962FFE83BCB008A; Path=/drools-guvnor/; HttpOnly
< Content-Type: application/json
< Transfer-Encoding: chunked
< Date: Sat, 18 May 2013 17:10:51 GMT
<
* Connection #0 to host localhost left intact
* Closing connection #0
[{"package":{"assets":"http:\/\/localhost:8080\/drools-guvnor\/rest\/packages\/defaultPackage\/assets\/drools","author":"{user}","binar                                  yLink":"http:\/\/localhost:8080\/drools-guvnor\/rest\/packages\/defaultPackage\/binary","description":"The default rule package","meta                                  data":{"archived":false,"checkinComment":"Initial","created":"2013-05-18T12:34:53.825-04:00","state":"","uuid":"ab4ae1a2-10d7-43e7-9d8                                  e-411c93a8e669","versionNumber":1},"published":"2013-05-18T12:34:53.833-04:00","sourceLink":"http:\/\/localhost:8080\/drools-guvnor\/r 
```

故障排除：

```
HTTP Status 500 - Unable to find JAXBContext for media type: application/json 
```

[根据@sstarcher 的这篇文章](https://stackoverflow.com/questions/5080633/could-not-find-jaxbcontextfinder-for-media-type-application-json)，发生此错误是因为“resteasy 不再在 jar 中包含 json 支持” 。从那个答案中不清楚的是如何解决drools-guvnor中的问题。

这种情况下，使用drools-guvnor.5.5.0.Final，需要下载两个jar文件：

```
- [jettison-1.3.3.jar][2]
- [resteasy-jettison-provider-2.2.3.GA.jar][3] 
```

您应该*将这两个*jar 文件放在 {TOMCAT_HOME}/webapps/drools-guvnor/WEB-INF/lib 文件夹中。在某些系统上看起来像这样：

```
 /usr/local/tomcat/apache-tomcat-7.0.35/webapps/drools-guvnor/WEB-INF/lib 
```

下一步停止并重新启动网络服务器。在 {TOMCAT_HOME}/bin 目录中的 Tomcat 上，您可以使用 ./shutdown.sh 和 ./startup.sh 命令。

401 - 未经授权。如果您不使用 -u user:pass 可选参数，则会发生这种情况。开箱即用，guvnor 使用假的基本身份验证器，它需要标头才能工作。

404 - 未找到。如果您没有在请求中指定正确的目录或资源名称，则会出现此错误。

405 - 方法不允许。当您破坏 curl 选项、忘记引号等时会发生这种情况。

406 - 不可接受。如果您使用 curl 的 -H 选项指定了不受支持的“Accept:”标头，则会发生此错误。

高温高压

# c# - 安装期间的 CultureInfo.CurrentUICulture 差异

> ID：14488053
> 
> 赞同：0
> 
> 时间：2013-01-23T19:44:35.620
> 
> 标签：c#, .net, localization, wix, installation

我正在使用 WiX 安装程序来部署我的 .Net 应用程序。我有一个自定义操作来使用特殊参数运行我的应用程序可执行文件，以便将一些本地化文件复制到 Public Documents 文件夹。

```
<CustomAction Id='Foo' ExeCommand='-special-parameter' FileKey='application' Impersonate='no' Execute='deferred'/> 
```

在我的测试机器上，我安装了 Windows 7 Ultimate（从英文 CD 安装 x86）并安装了几种其他语言，并且我以具有管理员权限的用户身份运行。我已将控制面板中的显示语言设置为法语并重新启动，按照此[链接的指示](http://blogs.msdn.com/b/snippets/archive/2008/11/10/what-we-should-know-about-currentculture-and-currentuiculture.aspx) ![](../Images/6f0d8d6ec9040add6601cf42a76df9d4.png)

在我的应用程序中，在上述自定义操作期间，`CultureInfo.CurrentUICulture`返回英文。但是当我在安装**后**运行我的应用程序时，`CultureInfo.CurrentUICulture`会按预期返回法语。

为什么 Windows 在安装过程中返回错误的区域性？是因为安装程序没有以登录用户身份运行吗？还是这与使用英文 CD 安装 Windows 的事实有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:51:53.393

根据概述的步骤，您没有更改系统保留帐户使用的语言（可能是英语，因为您是从英语 CD 安装的）。单击“管理”选项卡（在您的图片中可见），然后单击“复制设置”按钮。从那里您可以对系统帐户进行​​更改。尝试并再次运行您的安装程序。

跟进：我注意到您的自定义操作设置为不模拟。如果是这样，您也可能会看到正确的语言。不利的一面是它可能无法完成它应该做的事情。

来源：[http ://www.mydigitallife.info/change-display-language-for-windows-7-ui-welcome-screen-system-and-new-accounts/](http://www.mydigitallife.info/change-display-language-for-windows-7-ui-welcome-screen-system-and-new-accounts/)

# macos - OSx Mountain Lion ssh-askpass

> ID：14488057
> 
> 赞同：2
> 
> 时间：2013-01-23T19:44:52.210
> 
> 标签：macos, cocoa, ssh

在 OSX Lion (10.7.x) 中，我能够编写一个 SSH 包装器，它使用 ssh-askpass 输入我的 SSH 服务器密码，但现在有了 Mountain Lion (10.8)，我无法使用这种方法。我想知道它是如何改变的，或者我如何设置它以再次使用它。我的一些客户没有为我设置使用 rsa 密钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:34:19.553

我发现这个博客包含一个实现 ssh-askpass 的简单 shell 脚本。它适用于我通过 SSH 从 GUI 应用程序访问 Mercurial 存储库。

[http://blog.retep.org/2009/04/09/ssh-askpass-on-osx-10-5/](http://blog.retep.org/2009/04/09/ssh-askpass-on-osx-10-5/)

希望有帮助。

# extjs - extjs 图表-> 系列动态改变颜色

> ID：14488058
> 
> 赞同：0
> 
> 时间：2013-01-23T19:44:51.110
> 
> 标签：extjs, charts

如何动态更改chart.series.color？

我有什么方法可以改变“ONE”栏的颜色以引起注意？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T07:54:59.413

我使用这段代码，但渐变在后面看到，而不是在所有栏中：

看这张图片：[图表图片](http://adan.co.il/charttt.jpg)

```
var enroll = Ext.create('Ext.chart.Chart', {
    width: 430,        
    height: 250,
    xtype: 'chart',
    renderTo: 'O20_id-body',
    store: store1,
    axes: [{
        type: 'Numeric',
        position: 'left',
        fields: ['data1'],
        label: {
            renderer: Ext.util.Format.numberRenderer('0,0')
        },
        title: 'Number of Hits',
        grid: true,
        minimum: 0
    }, {
        type: 'Category',
        position: 'bottom',
        fields: ['data1'],
        title: 'Month of the Year'
    }], 
    gradients: [{
    id: 'redGradient',
    angle: 45,
    stops: {
        0: {
            color: '#FF0000'
        },
        100: {
            color: '#F0F0F0'
        }
    }
  }],        
    series: [{
        type: 'column',
        axis: 'bottom',
        highlight: true,
        xField: 'name',
        yField: 'data1',
        renderer: function(sprite, record, attr, index, store) {
                     //draw diffrent color                                         
                     sprite.setAttributes({fill: 'url(#redGradient)'}, true);
                     return attr;

        }
    }]

}); 
```

# android - 强制 edittext 只接受以下值：数字、小数、加号和减号

> ID：14488060
> 
> 赞同：-4
> 
> 时间：2013-01-23T19:44:56.297
> 
> 标签：android, android-edittext

这是我的 xml 代码

* * *

```
 <EditText
                    android:id="@+id/etSPHr"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="5dp"
                    android:layout_weight="1"
                    android:background="@drawable/myedittext"
                    android:digits="0123456789.+-"
                    android:ems="10"
                    android:inputType="numberDecimal"
                    android:nextFocusForward="@+id/etCYLr"
                    android:paddingLeft="5dp"
                    android:paddingRight="5dp"
                    android:singleLine="true" > 
```

* * *

问题是我的键盘不允许我使用加号它已禁用

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T19:50:45.777

正在做

```
android:inputType="numberDecimal|numberSigned" 
```

应该管用。

# ios - 更改 UILabel 文本但保留其余属性

> ID：14488069
> 
> 赞同：13
> 
> 时间：2013-01-23T19:45:44.800
> 
> 标签：ios, objective-c, uilabel

我在使用情节提要创建的 ViewController 中有一个 UILabel。标签文本的字体、大小和颜色，对齐方式 - 都在情节提要中设置。故事板中的标签连接到我名为*p_patientNameLbl*的文件中的插座。

现在我正在尝试以编程方式更改标签的文本，如下所示：

```
[self.p_patientNameLbl setText:@"Vasya"]; 
```

我看不到新文本，直到我意识到情节提要中的原始标签是黑色背景上的白色，但显然在我如上所述更改标签的文本后，所有字体属性都已重置，现在它是黑​​色文本黑色背景，因此看不到。一旦我以编程方式设置颜色：

```
[self.p_patientNameLbl setTextColor:[UIColor whiteColor]]; 
```

我可以看到新标签，但所有其余的字体属性和对齐方式仍然是错误的。

有没有办法*只*更改标签的文本，而无需以编程方式设置所有其余属性？我想一定有办法，因为我不想在代码中格式化我的界面！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-06-16T19:12:16.817

这对我有用：

```
- (void)setText:(NSString *)text withExistingAttributesInLabel:(UILabel *)label {

    // Check label has existing text
    if ([label.attributedText length]) {

        // Extract attributes
        NSDictionary *attributes = [(NSAttributedString *)label.attributedText attributesAtIndex:0 effectiveRange:NULL];

        // Set new text with extracted attributes
        label.attributedText = [[NSAttributedString alloc] initWithString:text attributes:attributes];

    }

}

...

[self setText:@"Some text" withExistingAttributesInLabel:self.aLabel]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-23T20:14:56.907

发生这种情况是因为您告诉 Interface builder 采用在其文本上设置了预定义属性的标签并将此属性文本替换为纯文本。而不是`setText`, 或者`setTextColor`您必须使用`setAttributedText`并指定您希望传递给属性字符串的属性。

以下是如何以编程方式将属性字符串应用于标签的示例。我不知道有什么更好的方法，但是使用它，您可以更改文本或文本颜色，只要您将其他属性与它们一起设置，所有更改都会正确应用。

```
[myLabel setAttributedText:[self myLabelAttributes:@"Some awesome text!"]];

....................

- (NSMutableAttributedString *)myLabelAttributes:(NSString *)input
{
    NSMutableAttributedString *labelAttributes = [[NSMutableAttributedString alloc] initWithString:input];

    [labelAttributes addAttribute:NSStrokeWidthAttributeName value:[NSNumber numberWithFloat:-5.0] range:NSMakeRange(0, labelAttributes.length)];
    [labelAttributes addAttribute:NSStrokeColorAttributeName value:[UIColor blackColor] range:NSMakeRange(0, labelAttributes.length)];
    [labelAttributes addAttribute:NSForegroundColorAttributeName value:[UIColor whiteColor] range:NSMakeRange(0, labelAttributes.length)];

    return labelAttributes;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-20T07:29:08.503

Swift 中的一行实现：

```
label.attributedText = NSAttributedString(string: "text", attributes: label.attributedText!.attributesAtIndex(0, effectiveRange: nil)) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-06-03T05:17:27.370

**斯威夫特 4**

```
label.attributedText = NSAttributedString(string: "new label text", attributes: label.attributedText!.attributes(at: 0, effectiveRange: nil)) 
```

（Bartłomiej Semańczyk 回答的一些未成年人变化）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-20T13:06:51.070

0x7fffffff，感谢您的提示，这对我有用。在 iOS6 中，这里的一些其他建议不起作用，例如。提取属性并重新应用它们。

就我而言，我失去了很多有用的属性，包括字体，所以这是我的解决方案：

```
- (NSMutableAttributedString *)SetLabelAttributes:(NSString *)input col:(UIColor *)col size:(Size)size {

NSMutableAttributedString *labelAttributes = [[NSMutableAttributedString alloc] initWithString:input];

UIFont *font=[UIFont fontWithName:@"Helvetica Neue" size:size];

NSMutableParagraphStyle* style = [NSMutableParagraphStyle new];
style.alignment = NSTextAlignmentCenter;

[labelAttributes addAttribute:NSFontAttributeName value:font range:NSMakeRange(0, labelAttributes.length)];
[labelAttributes addAttribute:NSParagraphStyleAttributeName value:style range:NSMakeRange(0, labelAttributes.length)];
[labelAttributes addAttribute:NSForegroundColorAttributeName value:col range:NSMakeRange(0, labelAttributes.length)];

return labelAttributes;
} 
```

然后像这样将它应用到 UILabel 上：

```
[self.myLabel setAttributedText:[self CurrentSetLabelAttributes:[NSString stringWithFormat:@"%d", myClass.text] col:[UIColor redColor]  size:50.0f]]; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-23T20:11:06.240

我已经为多个应用程序做了很多次。我总是在 Storyboard 中制作标签和文本，在编辑器中更改它们的字体大小、颜色显示、alpha 值等。但是之后如果我需要更改我已经多次完成的文本，我所做的就是这个。

```
p_patientNameLbl.textColor = [UIColor redColor];
p_patientNameLbl.text = @"My Sample Text"; 
```

而已。保留所有其他默认属性。除非我错过了你的问题？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-10-27T11:15:43.607

除了存储旧属性并使用更改的文本和存储的属性创建新的 NSAttributedString 之外，一种相对更简单的方法是：

```
NSMutableAttributedString *attStr = [label.attributedText mutableCopy];
NSMutableString *str = attStr.mutableString;
/* change str with new text */
label.attributedText = attStr; 
```

# perl - DOS批处理文件中的Perl脚本返回值

> ID：14488070
> 
> 赞同：2
> 
> 时间：2013-01-23T19:45:47.810
> 
> 标签：perl, error-handling, batch-file, exit-code

我有一个调用 Perl 脚本文件的 DOS 批处理文件：

```
ssutexec.pl prog=MyProg I_CARD=MyCard O_F071=ME007 F70P=MYF70P TRIG=MYTRIG
set status=%errorlevel%
if NOT %status% == 0 (
  echo *******************************************************
  echo   MPSBM070 JOB stopped with a RETURN CODE of %status%
  echo ************** END OF JOB *****************************
  goto JobEnd
 ) 
```

在 ssutexec.pl perl 脚本文件中，执行了一个错误条件，脚本以 exit($status) 退出：

```
if ($status != 0)
 {
  system("ssutdttm.pl SSUTEXEC \"finished processing $prog_nam (Abnormal End) on\"") ;
  print "******************************************************************" ;
  print "              JOB STOPPED - Due to Return code of ($status)" ;
  print "*****************END OF JOB***************************************" ;
  system("ssutdttm.pl SSUTEXEC \"finished processing $prog_nam (Abnormal End) on\"") ;
  system("ssuttmdr.pl -c -b $starttime -m \"$prog_nam\"") ;
  exit($status) ;
 } 
```

我不是 perl 脚本专家。没有触发错误级别，所以我没有收到错误。如何在我的 DOS 批处理文件中捕获 perl 脚本退出代码的值？

包含编辑：新的批处理文件如下所示：

```
@echo off
setlocal enabledelayedexpansion 

if not defined run_env goto ScriptExit

echo ******************************************************************
echo *                      MYPROG                                  *
echo ******************************************************************

perl ssutdttm.pl MYPROG Start -
perl ssutexec.pl prog=MyProg I_CARD=MyCard O_F071=ME007 F70P=MYF70P TRIG=MYTRIG
set status=!errorlevel!
if NOT %status% == 0 (
  echo *******************************************************
  echo   MYPROG JOB stopped with a RETURN CODE of %status%
  echo ************** END OF JOB *****************************
  goto JobEnd
 )

:JobEnd
  if %status% == 0 (
    echo *******************************************************
    echo       NORMAL END OF JOB - RETURN CODE of %status%
    echo ******** NORMAL END OF JOB ****************************
   ) ELSE (
    echo !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    echo     ABNORMAL END OF JOB - RETURN CODE of %status%
    echo !!!!!! ABNORMAL END OF JOB !!!!!!!!!!!!!!!!!!!!!!!!!!!!
   )
  ssutdttm.pl MYPROG end - 
  exit /b %status%
::
:ScriptExit
echo run_env: %run_env% 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:55:53.090

我认为您应该`perl.exe`使用脚本作为参数进行调用：

`perl ssutexec.pl prog=MyProg ...`

在我的测试中，如果我只有脚本名称，则会提示我要使用什么来打开`test.pl`文件。这意味着`perl.exe`没有执行我的 Perl 代码。

您的文件关联可能存在，但由于[Windows 的细微差别，](https://stackoverflow.com/a/7410375/329921)您的脚本仍然可能失败。

我用我的两个非常简单的脚本进行了测试：

测试.bat

```
@ECHO OFF

perl test.pl

set status=%errorlevel%

if NOT %status% == 0 (
 echo status was set with value of %status%
) 
```

和 test.pl

```
use warnings;
use strict;

my $status = 44;

exit($status) 
```

和预期的输出：

```
C:\Dropbox\Programming\Perl\Learn\blah>test
status was set with value of 44 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:40:07.720

使用批处理文件真的很痛苦（DOS 批处理文件使 bash 脚本看起来很棒，而 bash 很臭！）。问题可能来自批处理文件处理变量扩展的方式。这里有一些尝试：

1.  将以下行添加到批处理脚本的顶部（我通常将其放在顶部，就在我的`@echo off`行下方）：`setlocal enabledelayedexpansion`
2.  将所有`%ERRORLEVEL%`引用更改为`!ERRORLEVEL!`（感叹号而不是百分号）。

这些更改将导致变量在执行时而不是在解析时扩展。当不使用延迟扩展选项时，我已经看到`%ERRORLEVEL%`值被破坏了。阅读此[EnableDelayedExpansion 信息页面](http://ss64.com/nt/delayedexpansion.html)了解更多信息。

# git - git push 在 HTTP/1.1 之后挂在（哑）https 上 100 继续

> ID：14488077
> 
> 赞同：7
> 
> 时间：2013-01-23T19:46:12.103
> 
> 标签：git, git-push

我正在尝试进行一些更改，但`git push`挂起。当我运行时`git push`，我看不到任何输出，并且似乎什么也没有发生。中没有任何活动`top`，也没有发生任何事情的迹象。

我不控制 git 托管服务。我正在使用 HTTPS URL。我相信托管服务使用的是哑 HTTPS，而不是 git 的“智能 HTTP”协议。在客户端，我使用 Mac OS X，并通过 Homebrew 安装了 git 1.8.1.1（但使用 Xcode 命令行工具中包含的 git 版本似乎没有什么不同）。注销并重新登录似乎没有帮助。我可以从不同的 Linux 机器上拉取和推送到这个托管服务/存储库。

下面是一些调试输出，显示`git push`在客户端发出 PROPFIND 请求后挂起，`HTTP/1.1 100 Continue`从服务器获得响应，然后什么也没发生：它只是卡住了。

我如何让这个工作？我可以尝试任何故障排除步骤吗？

```
$ GIT_CURL_VERBOSE=1 git push -v
Pushing to https://secure2.svnrepository.com/redacted/redacted/
* About to connect() to secure2.svnrepository.com port 443 (#0)
*   Trying 67.228.18.88...
* Connected to secure2.svnrepository.com (67.228.18.88) port 443 (#0)
* Connected to secure2.svnrepository.com (67.228.18.88) port 443 (#0)
* SSL connection using DHE-RSA-AES256-SHA
* Server certificate:
*    subject: C=US; OU=Domain Control Validated; CN=secure2.svnrepository.com
*    start date: 2012-01-09 16:16:59 GMT
*    expire date: 2015-02-09 02:52:45 GMT
*    subjectAltName: secure2.svnrepository.com matched
*    issuer: O=AlphaSSL; CN=AlphaSSL CA - G2
*    SSL certificate verify ok.
> GET /redacted/redacted/info/refs?service=git-receive-pack HTTP/1.1
User-Agent: git/1.8.1.1
Host: secure2.svnrepository.com
Accept: */*
Accept-Encoding: gzip
Pragma: no-cache

< HTTP/1.1 401 Authorization Required
< Date: Wed, 23 Jan 2013 03:29:36 GMT
< Server: Apache/2.2.3 (Red Hat)
< WWW-Authenticate: Basic realm="redacted"
< Content-Length: 493
< Content-Type: text/html; charset=iso-8859-1
< 
* Ignoring the response-body
* Connection #0 to host secure2.svnrepository.com left intact
* Issue another request to this URL: 'https://secure2.svnrepository.com/redacted/redacted/info/refs?service=git-receive-pack'
* Re-using existing connection! (#0) with host (nil)
* Connected to (nil) (67.228.18.88) port 443 (#0)
* Server auth using Basic with user 'redacted'
> GET /redacted/redacted/info/refs?service=git-receive-pack HTTP/1.1
Authorization: Basic redacted=
User-Agent: git/1.8.1.1
Host: secure2.svnrepository.com
Accept: */*
Accept-Encoding: gzip
Pragma: no-cache

< HTTP/1.1 200 OK
< Date: Wed, 23 Jan 2013 03:29:36 GMT
< Server: Apache/2.2.3 (Red Hat)
< Last-Modified: Wed, 23 Jan 2013 03:00:40 GMT
< ETag: "143802e-3b-e6374600"
< Accept-Ranges: bytes
< Content-Length: 59
< Content-Type: text/plain; charset=UTF-8
< 
* Connection #0 to host (nil) left intact
* Re-using existing connection! (#0) with host (nil)
* Connected to (nil) (67.228.18.88) port 443 (#0)
* Server auth using Basic with user 'redacted'
> GET /redacted/redacted/HEAD HTTP/1.1
Authorization: Basic redacted=
User-Agent: git/1.8.1.1
Host: secure2.svnrepository.com
Accept: */*
Accept-Encoding: gzip
Pragma: no-cache

< HTTP/1.1 200 OK
< Date: Wed, 23 Jan 2013 03:29:36 GMT
< Server: Apache/2.2.3 (Red Hat)
< Last-Modified: Wed, 16 Jan 2013 21:05:31 GMT
< ETag: "d1802c-17-3d0d7cc0"
< Accept-Ranges: bytes
< Content-Length: 23
< Content-Type: text/plain; charset=UTF-8
< 
* Connection #0 to host (nil) left intact
* About to connect() to secure2.svnrepository.com port 443 (#0)
*   Trying 67.228.18.88...
* Connected to secure2.svnrepository.com (67.228.18.88) port 443 (#0)
* Connected to secure2.svnrepository.com (67.228.18.88) port 443 (#0)
* SSL connection using DHE-RSA-AES256-SHA
* Server certificate:
*    subject: C=US; OU=Domain Control Validated; CN=secure2.svnrepository.com
*    start date: 2012-01-09 16:16:59 GMT
*    expire date: 2015-02-09 02:52:45 GMT
*    subjectAltName: secure2.svnrepository.com matched
*    issuer: O=AlphaSSL; CN=AlphaSSL CA - G2
*    SSL certificate verify ok.
> PROPFIND /redacted/redacted/ HTTP/1.1
User-Agent: git/1.8.1.1
Host: secure2.svnrepository.com
Accept: */*
Depth: 0
Content-Type: text/xml
Content-Length: 181
Expect: 100-continue

< HTTP/1.1 100 Continue
* We are completely uploaded and fine
< HTTP/1.1 401 Authorization Required
< Date: Wed, 23 Jan 2013 03:29:37 GMT
< Server: Apache/2.2.3 (Red Hat)
< WWW-Authenticate: Basic realm="redacted"
< Content-Length: 493
< Content-Type: text/html; charset=iso-8859-1
* the ioctl callback returned 0
< 
* Ignoring the response-body
* Connection #0 to host secure2.svnrepository.com left intact
* Issue another request to this URL: 'https://secure2.svnrepository.com/redacted/redacted/'
* Re-using existing connection! (#0) with host (nil)
* Connected to (nil) (67.228.18.88) port 443 (#0)
* Server auth using Basic with user 'redacted'
> PROPFIND /redacted/redacted/ HTTP/1.1
Authorization: Basic redacted=
User-Agent: git/1.8.1.1
Host: secure2.svnrepository.com
Accept: */*
Depth: 0
Content-Type: text/xml
Content-Length: 181
Expect: 100-continue

< HTTP/1.1 100 Continue 
```

我`strace`的 Mac OS X 机器上没有，我不知道如何使用`dtruss`它来查看它挂起的系统调用，因为`dtruss`需要我成为 root，然后 git push 会以不同的方式工作。

更新：我已经在一台带有 git 1.8.1.4 和 strace 的 Linux 机器上复制了这个。运行 strace 在挂起之前显示如下内容：

```
sendto(4, <redacted>..., 314, 0, NULL, 0) = 314
recvfrom(4, "\27\3\1\0000", 5, 0, NULL, NULL) = 5
recvfrom(4, "E\202\271\21\236p\200\346\374\3641\355\t\275\rLi\202T)\326\271l/\351\f\357\2769Jb\22"..., 48, 0, NULL, NULL) = 48
select(5, [4], [4], [], {0, 729000}) = 1 (out [4], left {0, 728997})
poll([{fd=4, events=POLLIN|POLLPRI|POLLRDNORM|POLLRDBAND}, {fd=4, events=POLLOUT|POLLWRNORM}], 2, 0) = 1 ([{fd=4, revents=POLLOUT|POLLWRNORM}])
select(5, [4], [], [], {0, 729000}) = 0 (Timeout)
poll([{fd=4, events=POLLIN|POLLPRI|POLLRDNORM|POLLRDBAND}], 1, 0) = 0 (Timeout)
...last 2 lines repeat infinitely... 
```

所以它似乎挂起期待从服务器接收一些东西。

`GIT_CURL_VERBOSE=1 git push -v`此外，我在运行 git 1.7.4.4 的旧 Linux 机器上尝试了类似的跟踪，它以相同的前缀开始，然后从那里继续。在带有较新 git 的损坏机器上：

```
$ grep '^> [A-Z]' git-1.8.1.1-trace.stderr
> GET /redacted/redacted/info/refs?service=git-receive-pack HTTP/1.1
> GET /redacted/redacted/info/refs?service=git-receive-pack HTTP/1.1
> GET /redacted/redacted/HEAD HTTP/1.1
> PROPFIND /redacted/redacted/ HTTP/1.1
> PROPFIND /redacted/redacted/ HTTP/1.1 
```

在具有较旧 git 的较旧机器上，一切正常：

```
$ grep '^> [A-Z]' git-1.7.4.4-trace.stderr
> GET /g_wagner/c79-s13/info/refs?service=git-receive-pack HTTP/1.1
> GET /g_wagner/c79-s13/info/refs?service=git-receive-pack HTTP/1.1
> GET /g_wagner/c79-s13/HEAD HTTP/1.1
> PROPFIND /g_wagner/c79-s13/ HTTP/1.1
> PROPFIND /g_wagner/c79-s13/ HTTP/1.1
> HEAD /g_wagner/c79-s13/info/refs HTTP/1.1
> HEAD /g_wagner/c79-s13/objects/info/packs HTTP/1.1
> MKCOL /g_wagner/c79-s13/info/ HTTP/1.1
> LOCK /g_wagner/c79-s13/info/refs HTTP/1.1
> GET /g_wagner/c79-s13/objects/info/packs HTTP/1.1
...
> UNLOCK /g_wagner/c79-s13/info/refs HTTP/1.1 
```

查看两台机器上的完整跟踪，我看不出在有问题的 PROPFIND 请求（第二个 PROPFIND）中发送的内容有任何区别：两个请求似乎是相同的，除了`User-Agent:`标头。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-13T08:39:50.857

我遇到了相同症状的问题（过程挂起`HTTP/1.1 100 Continue`）。

我找到了一个可以为我解决问题的提交：[http-push.c: make CURLOPT_IOCTLDATA a usable pointer](https://github.com/git/git/commit/479eaa8ef8384d8026dc05c1288e96ffd9e296d6)，它在**GIT 版本 v2.0.3**中可用。

显然，即使从通信中看起来确实如此，用户也没有在服务器上正确地进行身份验证。

问题很奇怪，因为对你来说，它出现在一台机器上，但没有出现在另一台安装了相同 GIT 版本的机器上，对我来说，GIT 刚刚在一个月内停止工作，我真的不能说是什么原因。

或者，如果可能的话，使用允许其他协议的 GIT 服务提供商：SSH 或 HTTPS，这些都可以更好地调试。

* * *

对于 Windows 用户，这是我对[`git-http-push 2.1.0-rc2`](https://www.dropbox.com/s/9ycdl9xfdzlfjuz/git-http-push_2.1.0-rc2.zip)构建的看法（基于[msysGit 项目说明](https://github.com/msysgit/msysgit/wiki/How-and-when-does-Git-for-Windows-get-released)）

要向后移植到您的**msysGit**安装，请将其解压缩并在 msysGit 安装文件夹中复制到/覆盖`libexec\git-core\git-http-push.exe`。

该问题已在[此处](https://github.com/msysgit/msysgit/issues/116)报告。

**更新**

最新的[msysGit](http://msysgit.github.io/) (Git-1.9.4-preview20140815) 包含反向移植的错误修复。

# javascript - 在 mysql-libmysqlclient 中为节点启用 LOAD DATA LOCAL INFILE？

> ID：14488079
> 
> 赞同：1
> 
> 时间：2013-01-23T19:46:24.473
> 
> 标签：javascript, mysql, sql, node.js

我需要在节点中使用 mysql-libmysqlclient 来使用 LOAD DATA LOCAL INFILE。但是我收到一个错误

[错误：查询错误 #1148：此 MySQL 版本不允许使用的命令]

从 sequel pro 运行相同的命令不会发生这种情况，因此问题很可能与 mysql-libmysqlclient 使用的连接有关。

Anoyone 知道将哪些参数发送到 mysql-libmysqlclient 以解决此问题？

初始化连接：

```
secrets = stuff
mysql_db = mysql.createConnectionQueuedSync()

mysql_db.initSync()
mysql_db.realConnectSync secrets.host, secrets.user, secrets.password, secrets.database
mysql_db.connectError

module.exports = exports = mysql_db 
```

发送查询：

```
mysql_db = require('./config/mysql_db')
sql_insert_into = "LOAD DATA local INFILE 'file_to_send.txt'     
into table #{table.name}    
FIELDS TERMINATED BY ';'    
LINES TERMINATED by '\\n'
"

mysql_db.query sql_insert_into, (err, answer)->
  console.log "sent " + sql_insert_into 
```

我得到的错误：

```
[Error: Query error #1148: The used command is not allowed with this MySQL version] 
```

小注：我用咖啡脚本编程，但这不应该改变任何东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:46:14.677

如果在服务器或客户端中禁用了 LOAD DATA LOCAL，则尝试发出此类语句的客户端会收到以下错误消息：

```
ERROR 1148: The used command is not allowed with this MySQL version 
```

您可以参考下面的 MySql 网站链接了解如何启用：

[https://dev.mysql.com/doc/refman/5.5/en/load-data-local.html](https://dev.mysql.com/doc/refman/5.5/en/load-data-local.html)

# java - 方法结果类型

> ID：14488081
> 
> 赞同：-1
> 
> 时间：2013-01-23T19:46:53.347
> 
> 标签：java, arrays, methods

在下面的代码中，该方法`array1`不会返回平均值，因为它的返回类型是`void`.

我知道什么`void`意思，但有人可以向我解释什么是 void 结果类型以及如何使此方法返回平均值：

```
public class JavaApplication4 {
    public static void main(String[] args) {
    int[] a = {1,2,3,4};

    double result = array1 (a);
}

public static array1 (int[] b) {
    double avarage;
    int total = 0;
    for (int x:b) {
        total += x;
    }

avarage = total / b.length;
return avarage;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:02:00.867

“结果类型”或“返回类型”在函数声明中设置。它只是表示调用函数后将返回什么类型的数据。您的函数应如下所示：

```
public static double array1(int[] b) {
    double average;
    int total=0;
    for(int x:b){
        total +=x;
    }
    average = (double) total/b.length;

    return average;
} 
```

这将在函数完成后返回平均值。因此，函数完成后，结果将与平均值的最终值相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:51:53.887

您需要声明`array1`为正在返回`double`。将其声明更改为：

```
public static double array1(int [] b ) { 
```

`void`函数 -- `void array1(...)`-- 不返回值。

请注意，您的代码中还有另一个错误：

```
avarage = total / b.length; 
```

上面使用整数除法，这意味着结果被截断为整数，然后才转换为`double`. 要修复，请将行更改为：

```
avarage = total / (double)b.length; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:07:08.840

返回类型 void 意味着方法不返回任何内容。当您想要对数组执行操作但没有任何与该操作关联的值时，这很有用。例如，假设您想交换数组中的第一个和最后一个元素，您可以编写类似这样的方法（忽略必要的错​​误检查）

```
 public void swapArrayLocs(int[] swapping){
      int temp = swapping[0];
      swapping[0] = swapping[swapping.length - 1];
      swapping[swapping.length - 1] = temp;
 } 
```

当您调用此方法时，您并不期望从中得到任何结果，您期望您的程序只处理业务并继续执行。

在这种情况下，您实际上希望您的 array1(int[]) 方法使其可用于程序的其余部分。您可以通过指定函数的返回类型来做到这一点，它告诉程序的其余部分您希望该函数返回什么类型的信息。在您的情况下，您可以通过将方法声明更改为来做到这一点。

```
public static double array1(int[] b){
    //the same method body
} 
```

请注意在这种情况下如何在 static 之后插入单词 double。这告诉调用函数，当它执行 array1 时，该方法将返回一个 double 类型的值。将此与您之前所说的方法不会返回任何类型的信息进行对比。

# php - 在 php 中获取 xml 子属性 *url 的结尾？

> ID：14488083
> 
> 赞同：1
> 
> 时间：2013-01-23T19:47:01.043
> 
> 标签：php, xml, explode

好的，我有一个这样的 xml 文件。. .

```
<parent> 
 <x url="example/656577/07234/random.swf"/>
 <x url="example1/609456/67856/random1.swf"/>
 <x url="example2/376987/09365/random2.swf"/>
 <x url="example3/956743/04762/random3.swf"/>
 <x url="example4/678543/95265/random4.swf"/>
</parent> 
```

xml 文件中发生的所有 x 子 url 一直在变化，但总是在 3 个目录中，我想要做的只是获取每个子 url 的结尾。. .

> random.swf random1.swf random2.swf random3.swf random4.swf

我不熟悉爆炸，但这是一个欢迎任何答案的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:07:41.597

好的，是的，我查看了您提供的链接，我发现它很有用，感谢您为我指出我现在正在使用的正确方向

```
$path_parts = pathinfo('example4/678543/95265/random4.swf');
echo $path_parts['filename'].".".$path_parts['extension']; 
```

对于我再次感谢的问题。

# mysql - MySQL 数据库的结构

> ID：14488089
> 
> 赞同：0
> 
> 时间：2013-01-23T19:47:14.887
> 
> 标签：mysql, database

我正在寻找开发一个 MySQL 数据库。该数据库的主要唯一信息是 MAC 地址*（例如 AA:BB:CC:DD:EE:FF）*。对于每个 MAC 地址记录，将有许多子记录，这些子记录将记录这些 MAC 地址的记录时间。因此，如果您愿意，此字段将是 MAC 地址的子记录，并将包含以下内容：-

*   检测到 MAC 地址的设备的参考号
*   日期和时间
*   经度
*   纬度

这将是从网络不断连接的被动数据。尽管如此，我还希望有一个活动表/列表，我可以在其中指定一个 MAC 地址，如果检测到它，则会使用上述相同信息记录一条记录。

我想知道构建这些信息的最佳方式是什么？我假设我将有一个包含 MAC 地址的主表，然后有一个外键将其链接到另一个包含参考号、日期和时间、经度和纬度的表？如何最好地构建被动地整理信息并主动整理信息。

由于数据是被动整理的，我可能想在某个阶段查询它，但是使用活动列表（要注意的 MAC 地址），我想在检测到这些时设置电子邮件警报，所以我不知道是否存储这些分别地。

理想情况下，我希望将所有数据放在一个表中用于被动或主动数据，所以我只是想知道是否可以在主表中添加另一列，其中包含将其标记为“活动”的 MAC 地址，以便任何检测到此 MAC，然后我可以生成代码来创建电子邮件？

我希望这是有道理的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:02:28.973

我认为你在正确的轨道上。有一个包含 MAC 地址和 ID 的主表，然后另一个表可以跟踪 MAC 地址的活动（ID、MAC_ID、REF_NUM、DateTime、LONG、LAT）。我认为在 MAC 地址表中有一个标志是一个好主意，或者您可以有一个包含 MAC_ID（或 MAC 地址）的单独表并将其用作查找表。您可能需要创建一个触发器，以便如果发送“监视”表中的 MAC 地址，它会将插入到“活动”表中，这听起来像是带有 REF_NUM 的活动表的副本， ETC。

另一种选择是组合这些表，并在活动表中设置一个标志，如果在查找表中找到 MAC 地址或该行是否通过触发器插入，则检查该标志。只是大声思考。

这是带有示例数据的表结构示例：

```
MAC_ADDRESSES_TABLE 
MAC_ID (PK)     MAC_ADDRESS
1               00-B0-D0-86-BB-F7
2               00-B1-D0-86-BC-F8
3               00-B2-D0-86-BD-F9
4               00-B3-D0-86-BE-A7
5               00-B4-D0-86-BF-A9
…                …

MAC_ACTIVITIES_TABLE                    
MAC_ACTIVITY_ID (PK)    MAC_ID (FK)     REF_NUM         DATETIME      LONG          LAT
1                              1           A1       1/20/2013 13:40   40.689060   74.044636
2                              1           B2       1/21/2013 13:40   40.689061   74.044636
3                              3           C3       1/22/2013 13:40   40.689062   74.044636
4                              4           A5       1/23/2013 13:40   40.689063   74.044636
5                              4           D9       1/24/2013 13:40   40.689064   74.044636
…                              …           …         …                 …          … 
```

# r - 计算 R 中的 outlier_score

> ID：14488103
> 
> 赞同：-3
> 
> 时间：2013-01-23T19:48:01.533
> 
> 标签：r, data.table

```
 dput(x)
structure(list(Date = structure(c(1L, 1L, 1L, 2L, 2L, 2L, 3L, 
3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 6L, 6L, 6L), .Label = c("1/1/2012", 
"2/1/2012", "3/1/2012", "4/1/2012", "5/1/2012", "6/1/2012"), class = "factor"), 
    Continent = structure(c(3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 
    3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L), .Label = c("Asia", "Europe", 
    "South America"), class = "factor"), Score = c(10L, 4L, 9L, 
    1L, 9L, 3L, 10L, 0L, 0L, 10L, 4L, 9L, 10L, 4L, 9L, 0L, 0L, 
    5L), Country = structure(c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 
    3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L), .Label = c("Brasil", 
    "China", "Germany"), class = "factor"), mean = c(6.83333333333333, 
    3.5, 5.83333333333333, 6.83333333333333, 3.5, 5.83333333333333, 
    6.83333333333333, 3.5, 5.83333333333333, 6.83333333333333, 
    3.5, 5.83333333333333, 6.83333333333333, 3.5, 5.83333333333333, 
    6.83333333333333, 3.5, 5.83333333333333), sd = c(4.91596040125088, 
    3.33166624979154, 3.81663027639129, 4.91596040125088, 3.33166624979154, 
    3.81663027639129, 4.91596040125088, 3.33166624979154, 3.81663027639129, 
    4.91596040125088, 3.33166624979154, 3.81663027639129, 4.91596040125088, 
    3.33166624979154, 3.81663027639129, 4.91596040125088, 3.33166624979154, 
    3.81663027639129), outlier1 = c(FALSE, FALSE, FALSE, TRUE, 
    TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, 
    FALSE, FALSE, TRUE, TRUE, FALSE)), .Names = c("Date", "Continent", 
"Score", "Country", "mean", "sd", "outlier1"), row.names = c(NA, 
-18L), class = c("data.table", "data.frame"), .internal.selfref = <pointer: 0x0000000005e70788>) 
```

我计算了每个国家的平均值、标准差和异常值1。我想对每个国家/地区应用 outlier_score 来对它们进行排名。有人可以指点如何计算该数据集的异常值分数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:06:28.390

```
# if the record is an outlier,
# take the absolute value of the difference
# between the score and the mean
# otherwise leave it blank
x$distance.to.mean <- ifelse( x$outlier1 , abs( x$Score - x$mean ) , NA )

# for all records with non-missing distances,
# add a `rank` variable based on its order in the data
x[ !is.na( x$distance.to.mean ) , 'rank' ] <- 
    rank( x[ !is.na( x$distance.to.mean ) , 'distance.to.mean' ] )

# see the result
x

# sum up the number of outliers in each country grouping
outliers.by.country <- tapply( x$outlier1 , x$Country , sum )

# take a look at those counts
outliers.by.country

# create a vector of all matches to the outliers.by.country table
y <- match( x$Country , names( outliers.by.country ) )

# and merge on the contents of the outliers.by.country table to x
x$sum.outliers <- 
    outliers.by.country[ y ]

# sort by the sum if you like
x <- x[ order( x$sum.outliers , decreasing = TRUE ) , ] 
```

# css - open-quote 在 Firefox 18 中使用 :before 和 content 定位不正确

> ID：14488108
> 
> 赞同：0
> 
> 时间：2013-01-23T19:48:14.290
> 
> 标签：css

我`:before`用来插入`content`元素`open-quote`。

[![截图开放报价](../Images/97a5209571a87258d12b6b691b888667.png)](https://i.stack.imgur.com/S2E7Q.png)

CSS代码：

```
blockquote {
    background:#f9f9f9;
    color: #555;
    font-style: italic;
    text-align: center; 
    border: 1px solid #ccc;
    border-left:5px solid #ccc;
    margin:0 30px;
    padding: 30px;
    border-radius: 5px;
    box-shadow: inset 0 2px 0 rgba(200, 200, 200, 0.7),-5px -4px 25px rgba(0, 0, 0, 0.3);
}
blockquote:before {
    color:#ccc;
    content:open-quote;
    font-size:4em;
    float:left;
    margin-top:-30px;
    text-shadow: 0 1px 1px #909090;
} 
```

使用 Chrome 和 IE9 似乎可以正常工作。

我猜`margin-top:-30px;`Firefox 对它的解释不同。

我该如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:54:02.783

好的，我可以通过使用 css browser hack 来解决这个问题：

```
@-moz-document url-prefix() { 
    blockquote:before {
        margin-top:0;
    }
} 
```

但我很乐意得到更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:25:11.560

我的 Firefox 版本似乎没有显示这种行为。相对定位是另一种选择：

[http://jsfiddle.net/3WMwt/](http://jsfiddle.net/3WMwt/)

```
blockquote:before {
    color:#ccc;
    content:open-quote;
    font-size:4em;
    float:left;
    position: relative;
    top:-30px;
    text-shadow: 0 1px 1px #909090;
} 
```

# java - 删除时区格式

> ID：14488111
> 
> 赞同：1
> 
> 时间：2013-01-23T19:48:17.477
> 
> 标签：java, datetime, calendar, timezone, jax-ws

我想知道如何删除服务输出中自动显示的时区。

让我解释：

我的 web 服务的输出包含一个从这个简单类型派生的字段：

```
<xs:simpleType name="tsMyDateTime">
    <xs:restriction base="xs:dateTime">
        <xs:pattern value="[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}" />
    </xs:restriction>
</xs:simpleType> 
```

我希望以下 tsMyDateTime 输出格式（例如）：

```
2026-02-25T00:00:00 
```

但输出看起来像：

```
2026-02-25T00:00:00.835-03:00 
```

原始日期对象具有正确的日期和时间，但我需要使用日历（对于 xs:dateTime），但时区总是出现。

我通过这种方式设置日历对象：

```
java.util.Date dateObject = (...)
calendar.setTime(dateObject); 
```

有人可以给我建议吗？

# javascript - 引导弹出框/点击

> ID：14488122
> 
> 赞同：2
> 
> 时间：2013-01-23T19:48:48.503
> 
> 标签：javascript, twitter-bootstrap, popover, jsfiddle

所以我想知道......我正在为我的项目使用 Twitter 的 Bootstrap，并且我做了一个小的通知 Popover / Clickover ( [http://www.leecarmichael.com/bootstrapx-clickover/examples.html](http://www.leecarmichael.com/bootstrapx-clickover/examples.html) ) 功能。我想知道我怎么能设法让它在一个静态高度上，里面有一个自定义滚动条......

我创建此弹出框/点击框的基本概念是：

```
$(function () {
    $("[rel='tooltip']").tooltip({container: 'body'});
});
$("#notices").clickover({
    content:data,
    html:true,
    container:'body'
    ,onShown: function () {$("#notices").tooltip("destroy");},
    onHidden: function () {$("#notices").tooltip({container:'.navbar'});},
    template: '\
        <div class="popover notices">\
            <div class="arrow"></div>\
            <div class="popover-inner">\
                <div class="popover-header">\
                    <h3 class="popover-title"></h3>\
                    <h3 class="popover-settings"><a href="/notifications.php?act=settings">Settings</a></h3>\
                </div>\
                <div class="popover-content">\
                    <p></p>\
                </div>\
                <h3 class="popover-footer"><center><a href="/notifications.php">See All</a></center></h3>\
            </div>\
        </div>'

}); 
```

使用 HTML

```
<div id='userbar' class='btn-group input-prepend input-append'>
    <button class='btn'></button>
    <button class='btn'></button>
    <button class='btn'></button>
    <button class='btn'></button>
    <button class='btn'></button>
    <button class='btn'></button>
    <button class='btn'></button>
    <button id='notices' class='btn' rel='tooltip' data-placement='bottom' data-original-title='Notifications'> <i class='icon-exclamation-sign icon-large'> <span class='badge badge-important'>102</span></i></button>
</div> 
```

所以我在 JSFiddle 上发了一篇关于这个的帖子。我没有包含来自 bootstrap 站点的 bootstrap 指令，但我已经在 J​​avascript 部分中发布了代码，因为工具提示做了一些修改。所以可能有很多代码行，虽然我的主要代码在最后......

链接是：http: [//jsfiddle.net/6GRHa/3/](http://jsfiddle.net/6GRHa/3/)

带有弹出框的按钮是“感叹号”

就像我说的那样，我想为其应用自定义高度和可滚动条以获取更多内容...提前谢谢您...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T19:56:11.707

```
.popover-content {
    max-height: 300px;
    overflow-y: auto;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T19:54:14.823

只需添加一些 css 即可为弹出框提供固定高度和滚动条：

```
.popover-inner {
   height: 250px;
   overflow:scroll;
} 
```

小提琴在这里：http: [//jsfiddle.net/6GRHa/4/](http://jsfiddle.net/6GRHa/4/)

# ruby-on-rails-3 - Rails 字段“不能为空”，即使它不是空白的

> ID：14488129
> 
> 赞同：10
> 
> 时间：2013-01-23T19:49:21.600
> 
> 标签：ruby-on-rails-3, validation

我正在使用 Rails 3 并未能提交表单，因为其中一个字段未能通过`validates_presence_of`。我的模型称为`dinner`，与日期选择器结合使用的字段称为`date`。

**`views/dinners/new.html.erb:`**

```
<%= f.text_field :date,  id: "datepicker" %> 
```

**`models/dinner.rb:`**

```
attr_accessible :date
validates_presence_of :date 
```

**`dinners_controller.rb:`**

```
def create
  @dinner = Dinner.new params[:dinner]
  if @dinner.save
    flash[:notice] = "Dinner created successfully."
    redirect_to controller: 'dinners'
  else
    flash.now[:alert] = @dinner.errors.full_messages.join("<br>").html_safe
    render action: "new"
  end
end 
```

每当我填写所有字段（包括`date`）时，我都会收到错误“日期不能为空白”，即使它不是空白的。这里发生了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T22:07:39.660

我找到了答案。

我的`date`专栏是 type `date`，在验证 Rails 之前运行`.to_date`它。不幸的是，我使用的[日期选择器](https://github.com/eternicode/bootstrap-datepicker)以美国`mm/dd/yy`格式创建日期，Rails 无法处理，因此`.to_date`返回 nil。这就是日期验证失败的原因：因为它确实为零，即使 POST 请求很好。

我选择了简单的解决方案并更改了 datepicker 的默认日期，如下[所示](https://stackoverflow.com/a/7181318/805556)。

注意：对于我的 datepicker 版本，我必须使用`format`而不是`dateFormat`，*并且还*必须使用`yyyy-mm-dd`而不是`yy-mm-dd`因为 Rails`String#to_date`认为年份“13”实际上是“0013”而不是“2013”​​。

# php - 给定整数，如何返回总和为给定正整数的所有数字序列？

> ID：14488132
> 
> 赞同：-1
> 
> 时间：2013-01-23T19:49:27.467
> 
> 标签：php, algorithm

例如，输入 3 将返回 [1,1,1]、[2,1] 和 [1,2]

我知道很多组合/排列问题都涉及在**循环内调用自身的递归函数，**但我看不到将其应用于此问题的适当方法。

这是我试图掌握的一个概念，这就是我到目前为止所拥有的......

```
function numberToAddends($number, $arr, $k){
    for ($i = 0; $i < $number; $i++) {
        $arr[$k] = $i;
        numberToAddends($k-$i, $arr, $k + 1);
    }

    if($k <=0){
        print_r($arr);
    }
} 
```

对于测试输入，您可以使用类似 numberToAddends(3, $arr, 0);

我在思考正确的道路吗？任何人都可以提供完整的 php 语法和注释代码来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:04:34.140

您正在寻找的概念是数字的“整数分区”。谷歌应该向你指出很多代码，或者查看[我的博客](http://programmingpraxis.com/2012/05/11/partitions/)以获取解释和代码。

基本思想是一个简单的递归过程。有一个0的单分区，空集()。有一个单一的分区 1，集合 (1)。有 2 的两个分区，集合 (1 1) 和 (2)。有 3 的三个分区，集合 (1 1 1)、(1 2) 和 (3)。有 4 个的五个分区，即集合 (1 1 1 1)、(1 1 2)、(1 3)、(2 2) 和 (4)。共有 5 个分区，即集合 (1 1 1 1 1)、(1 1 1 2)、(1 2 2)、(1 1 3)、(1 4)、(2 3) 和 (5)。等等。在每种情况下，通过将小于或等于所需整数 n 的每个整数 x 添加到由 n - x 的分区形成的所有集合中，确定下一个更大的分区集，消除任何重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:04:45.957

*这是一个通过重用从 1 到n*的子结果来解决这个问题的算法：

```
$number = 3;
$addends = array();
for ($x=1; $x<=$number; $x++) {
    $addends[$x] = array();
    for ($y=$x-1; $y>0; $y--) {
        foreach ($addends[$y] as $z) {
            $addends[$x][] = array_merge($z, array($x-$y));
        }
    }
    $addends[$x][] = array($x);
}
var_dump($addends); 
```

这通过将任何*y* < *x*的任何已知结果*z与**x*和*y*的差异以及最后*x*本身组合来构建*x的结果集。*

# ssh - 无法使用 j2ssh 在服务器上执行命令

> ID：14488137
> 
> 赞同：0
> 
> 时间：2013-01-23T19:49:42.433
> 
> 标签：ssh, j2ssh

我通过 ssh 连接到 unix 服务器并尝试执行“ls”命令并获取它的输出。代码是这样的

```
SessionChannelClient session = client.openSessionChannel();
       session.startShell();
       String cmd = "ls -l";
       session.executeCommand(cmd);           
       ChannelInputStream in = session.getInputStream();
       ChannelOutputStream out = session.getOutputStream();
       IOStreamConnector input = new IOStreamConnector(System.in, session.getOutputStream());
       IOStreamConnector output = new IOStreamConnector(session.getInputStream(), System.out); 
```

运行后我没有在日志文件中得到任何输出。我发现通道请求失败，如图所示

> 1019 [main] INFO com.sshtools.j2ssh.connection.ConnectionProtocol - 通道请求成功 1020 [main] INFO com.sshtools.j2ssh.session.SessionChannelClient - 请求命令执行 1021 [main] INFO com.sshtools.j2ssh.session.SessionChannelClient - 命令是 ls -l 1021 [main] INFO com.sshtools.j2ssh.connection.ConnectionProtocol - 发送会话通道的 exec 请求 1021 [main] INFO com.sshtools.j2ssh.transport.TransportProtocolCommon - 发送 SSH_MSG_CHANNEL_REQUEST 1021 [main] INFO com.sshtools.j2ssh.connection.ConnectionProtocol - 等待通道请求回复 1032 [传输协议 1] INFO com.sshtools.j2ssh.transport.TransportProtocolCommon - 收到 SSH_MSG_CHANNEL_EXTENDED_DATA 1033 [ssh-connection 1] 调试 com.sshtools.j2ssh.transport。服务 - 路由 SSH_MSG_CHANNEL_EXTENDED_DATA 1033 [ssh-connection 1] DEBUG com.sshtools.j2ssh.transport.Service - 已完成处理 SSH_MSG_CHANNEL_EXTENDED_DATA 1075 [传输协议 1] INFO com.sshtools.j2ssh.transport.TransportProtocolCommon - 收到 SSH_MSG_CHANNEL1FO INFAIL_com .sshtools.j2ssh.connection.ConnectionProtocol - 通道请求失败

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:44:56.500

您可以使用`startShell` **or** `executeCommand`，但不能同时使用。

`executeCommand`仅用于调用您选择的特定 shell，例如 /bin/bash。在大多数情况下，您可以只使用`startShell`来启动默认 shell。

这就是执行您提供的命令所需的全部内容：

```
final String cmd = "ls -l" + '\n';       
session.startShell();
session.getOutputStream().write(cmd.getBytes()); 
```

或者，或者，使用 executeCommand：

```
final String cmd = "ls -l";    
session.executeCommand(String.format("sh -c \"%s\"", cmd)); 
```

您可以以相同的方式连接到 stdout 和 stderr`InputStream`以查看命令的结果。此外，请注意 a`SessionChannelClient`只能处理一个命令。您需要实例化另一个以发送第二个命令。

我建议您下载[J2SSH 文档](http://sourceforge.net/projects/sshtools/files/J2SSH-Tutorials/1.0.0/)。在里面你会发现*j2ssh-getting-started.htm*，它解释了 API 的基本操作。

# php - Zend Framework 输出渲染顺序

> ID：14488139
> 
> 赞同：2
> 
> 时间：2013-01-23T19:49:49.503
> 
> 标签：php, zend-framework

我正在尝试了解 Zend 应用程序的工作流程。对于我定义的测试：

控制器 - IndexController.php：

```
public function preDispatch() {
        error_log('IndexController::preDispatch');
        echo 'IndexController::preDispatch <br />'; }

public function init() {       
        error_log('IndexController::init');
        echo 'IndexController::init <br />'; }

public function indexAction() {        
        error_log('IndexController::indexAction');
        echo 'IndexController::indexAction <br />'; } 
```

查看脚本 - index.phtml：

```
<?php
    echo'index view script - echo';
    $this->title = "ZF Tutorial";
    $this->headTitle($this->title); ?>
<h3>index view script - content</h3> 
```

布局脚本 - layout.phtml

```
...
<body>
    <div id="content">  
    <?php 
    error_log('Layout1');
    echo $this->layout()->content ?>
        <h1>
            <?php 
            error_log('Layout2');
            echo $this->escape($this->title); ?>            
        </h1>
    </div>
</body>
... 
```

这是我的困惑。error_log 输出的顺序与我在浏览器中的顺序不同。

error_log 输出（预期顺序）：

*   索引控制器::init
*   IndexController::preDispatch
*   IndexController::indexAction
*   布局1
*   布局2

浏览器输出：

*   索引控制器::init
*   索引视图脚本 - echo
*   索引视图脚本 - 内容
*   IndexController::preDispatch
*   IndexController::indexAction
*   采埃孚教程

为什么控制器中的输出在视图脚本之后呈现？来自 preDispatch 和 indexAction 的回显结果是否以某种方式缓冲以首先输出视图脚本内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:38:01.810

是的，调度过程中的任何输出都由输出缓冲区捕获并附加到响应中。这可能看起来令人困惑，但您不应该直接在控制器中输出内容（但如果您这样做了，您仍然希望看到它）。您的 error_log 列表显示了这些事情的执行顺序，这才是真正重要的。

# mysql - MySQL - 优化 OR 语句

> ID：14488144
> 
> 赞同：1
> 
> 时间：2013-01-23T19:50:05.477
> 
> 标签：mysql, sql, conditional-statements

我想使用该`OR`子句搜索 3 列。我知道，我只是遗漏了一些东西，但我不断收到 mysql 错误。

这是我到目前为止所拥有的：

```
SELECT customerid,companyname,firstname,lastname
FROM `tbl_customers` 
WHERE customeronoff = 1 
AND customerrecordtype = 'A' 
AND (companyname LIKE '$query%') OR (lastname LIKE '$query%') OR (firstname LIKE '$query%')   
ORDER BY lastname ASC 
```

我一定是把 OR 错了。有人能帮我修一下吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:51:11.357

使用 paranethesis 对您的`OR`staements 进行分组：

```
AND (
     (companyname LIKE '$query%') 
  OR (lastname LIKE '$query%') 
  OR (firstname LIKE '$query%')  
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:52:11.560

您缺少两个括号：

```
SELECT customerid,companyname,firstname,lastname
FROM `tbl_customers` 
WHERE customeronoff = 1 
AND customerrecordtype = 'A' 
AND **(**(companyname LIKE '$query%') OR (lastname LIKE '$query%') OR (firstname LIKE '$query%')**)**
ORDER BY lastname ASC 
```

# sql-server - 如果不存在一个不同的值，则插入表中

> ID：14488147
> 
> 赞同：1
> 
> 时间：2013-01-23T19:50:19.023
> 
> 标签：sql-server

我的表包含这些值

```
Name VARCHAR(50),
Program VARCHAR(50),
 Branch VARCHAR(30),
TotalP INT,
 TotalN INT) 
```

如果名称尚不存在，我一直在尝试将记录插入此表。这可能已经在这里得到了回答，但是当我在搜索中输入一些内容时，它会出现 7000 多个结果，我查看了 100 多个结果，但仍然没有找到答案。任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:57:08.007

如果您不担心并发性，则可以使用以下方法：

```
IF NOT EXISTS (
    SELECT 1
    FROM YourTable
    WHERE Name = @Name
)
BEGIN
    INSERT INTO YourTable (Name, Program, Branch, TotalP, TotalN)
    VALUES (@Name, @Program, @Branch, @TotalP, @TotalN)
END 
```

这里的问题是，如果两个进程试图同时添加相同的`name`...`IF NOT EXISTS``INSERT`

为防止这种情况，您可以向`name`列添加唯一约束，这将导致其中一个插入失败，或者您可以在`NOT EXISTS`检查中使用锁定表`WITH (UPDLOCK, HOLDLOCK)`，这将降低并发性但不会引发任何错误。

编辑：

如果您想要的值来自`SELECT`语句，则以下内容将起作用：

```
INSERT INTO YourDestinationTable (Name, Program, Branch, TotalP, TotalN)
SELECT st.Name, st.Program, st.Branch, st.TotalP, st.TotalN
FROM 
    YourSourceTable st
    LEFT JOIN YourDestinationTable dt
        ON dt.Name = st.Name
WHERE 
    dt.Name IS NULL
    -- Add in any other conditions for YourSourceTable here... 
```

`YourSourceTable`如果在 ... 中找不到该行，这将插入该行，`YourDestinationTable`使用 a`LEFT JOIN`和`IS NULL`检查实现。

这与以前有相同的警告...如果两个进程同时运行此语句，则可能会得到重复的`name`值；要么在 上添加唯一约束，要么在目标表中您正在测试是否存在于事务中的行上`name`执行 a ：`(UPDLOCK, HOLDLOCK)`

```
BEGIN TRANSACTION
    IF NOT EXISTS (
        SELECT 1
        FROM 
            YourSourceTable st
            JOIN YourDestinationTable dt WITH (UPDLOCK, HOLDLOCK) 
                ON dt.Name = st.Name
        -- WHERE 
            -- Add in any other conditions for YourSourceTable here...
    )
    BEGIN
        INSERT INTO YourDestinationTable (Name, Program, Branch, TotalP, TotalN)
        SELECT Name, Program, Branch, TotalP, TotalN
        FROM YourSourceTable st
        -- WHERE 
        -- Add in any other conditions for YourSourceTable here...
    END
COMMIT 
```

# .net - Code First TPT 继承 - 如何提供外键而不是 EF 为我创建父行？

> ID：14488148
> 
> 赞同：1
> 
> 时间：2013-01-23T19:50:23.563
> 
> 标签：.net, entity-framework, ef-code-first

我有一个像这样的基本继承层次结构：

```
public class Parent
{
    public int ParentID {get; set;}

    public string SomeOtherProperty {get; set;}
};

public class Child : Parent
{
    public string SomeChildProperty {get; set;}
}; 
```

我有多个子类，并且我有一个 Auditor 对象，该对象具有基于 Parent 类的接口，允许我以通用方式写入数据库，如下所示

```
public class Auditor
{
    public void WriteObject(Parent p)
    {
        using (MyDbContext context = new Context)
        {
            context.Parents.Add(p);
            context.SaveChanges();
        }
    }
} 
```

所以我可以像使用 Auditor

```
auditor.WriteObject(new Child1());
auditor.WriteObject(new Child2()); 
```

等等等等，每当我编写一个子对象时，EF 都会为我在数据库中创建父行。

我遇到的问题是在某些情况下（可能是 10% 的时间），我想将子记录写入数据库并将其链接到现有的父行，即我想提供外键。

我尝试了类似的东西

```
Child1 child = new Child();
child1.ParentID = existingID;
auditor.WriteObject(child); 
```

但是 EF 忽略了我提供的外键并为我创建了一个新的 Parent 记录。

无论如何让EF理解这一点，因为父ID已经存在于我试图编写的子对象上，它不需要插入父行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:46:34.683

根据您的描述，我有点困惑，但会尝试回答我认为您可能意味着的场景：

**选项 1**：我认为这就是您所追求的：您正在创建父类的对象。稍后，您有更多信息并希望将它们“向下转换”到适当的子类。这在 EF 中是不可能的。一旦对象被创建为特定类型，它就必须保留。那么在您的情况下，选项如下：

1.  此对象是否已作为 (parentType) 存在
2.  删除对象（父类型）
3.  保存对象（ChildType）

看到比我在这里能给出的更好的措辞解释：

[将子项添加到实体框架中的现有父记录](https://stackoverflow.com/questions/2618586/add-child-to-existing-parent-record-in-entity-framework)

[使用实体框架向下转型](https://stackoverflow.com/questions/7266848/downcasting-with-entity-framework)

如果这是您打算做的，我建议应该重新考虑正在实施的模型的某些部分以避免这些情况。

**选项 2**：您有一个子元素列表，这些子元素作为一个组属于父对象（在这种情况下是超类型）：

在这些情况下，您可以加载父级，将子级添加到父级，然后保存（在父级）：

```
Child1 child = new Child();
Parent p = _context.Parents.Find(search based on ID)
p.Children.Add(child);
auditor.WriteObject(p); 
```

**更新：选项 3**

根据您对共享父 ID 的评论：您现在谈论的不是 TPT 实现，您在这里违反了规则。在 TPT 中，您有一个 ID，它驻留在“父”表中，它是每个对象的所有表中的主键。绝不应该出现两个子对象（任何类型）具有相同主键的情况，并且在所有情况下，子对象的主键都是**parentID**。使用不太抽象的术语可能有助于消除混淆：如果父表是 Animal 而子表是 Cat 和 Dog 很明显 Cat 和 dog 不会共享主键（因为它们是不同的类型。我想你可能是尝试实现可能是相反的： Child 应该包含 parent 的实例（使用您问题中的术语）。

换一种说法，如果 parentID 是主键，它将只存在于对象层次结构的一个分支中，并且只会用于将构成该对象的继承链拉在一起。例如，如果我有一个像

动物->狗->贵宾犬

我创建了一个 ID=1 的新贵宾犬，我将永远只有一组 ID=1 的记录，并且它将在 Animal、Dog 和 Poodle 中各占一行。（并且所有这三个记录都是针对同一个 Poodle 对象），

# clojure - 如何为clojure编写dissoc-in命令？

> ID：14488150
> 
> 赞同：44
> 
> 时间：2013-01-23T19:50:24.500
> 
> 标签：clojure

我正在寻找一个类似于 assoc-in 但删除键而不是添加键的函数：

```
(dissoc-in {:a {:b 0}} [:a :b])
;;=> {:a {}} 
```

我爬到这里：

```
(def m {:a {:b {:c 1}}})

(assoc  m :a (assoc (:a m) :b (dissoc (:b (:a m)) :c)))
;;=> {:a {:b {}}} 
```

但是整个嵌套的东西都弄乱了我的头

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2014-02-21T18:37:49.400

我用**update-in**写这个：

```
(update-in {:a {:b 0 :c 1}} [:a] dissoc :b) 
```

=>

```
{:a {:c 1}} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-23T20:07:47.953

怎么样：

```
(defn dissoc-in
  "Dissociates an entry from a nested associative structure returning a new
  nested structure. keys is a sequence of keys. Any empty maps that result
  will not be present in the new structure."
  [m [k & ks :as keys]]
  (if ks
    (if-let [nextmap (get m k)]
      (let [newmap (dissoc-in nextmap ks)]
        (if (seq newmap)
          (assoc m k newmap)
          (dissoc m k)))
      m)
    (dissoc m k))) 
```

例子：

```
(dissoc-in {:a {:b 0 :c 1}} [:a :b]) 
```

结果：

```
{:a {:c 1}} 
```

`dissoc-in`曾经是一部分[`clojure.contrib.core`](https://clojure.github.io/clojure-contrib/branch-master/core-api.html#clojure.contrib.core/dissoc-in)，现在是一部分[`core.incubator`](https://github.com/clojure/core.incubator/blob/4f31a7e176fcf4cc2be65589be113fc082243f5b/src/main/clojure/clojure/core/incubator.clj#L63-L75)。

* * *

如果要保留空地图，可以稍微更改代码：

```
(defn dissoc-in
  [m [k & ks :as keys]]
  (if ks
    (if-let [nextmap (get m k)]
      (let [newmap (dissoc-in nextmap ks)]
        (assoc m k newmap))
      m)
    (dissoc m k))) 
```

例子：

```
(dissoc-in {:a {:b {:c 0}}} [:a :b]) 
```

结果：

```
{:a {}} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-06T12:09:59.157

这是基于更新的通用解决方案：

```
(defn dissoc-in [m p]
  (if (get-in m p) 
    (update-in m
               (take (dec (count p)) p)
               dissoc (last p))
    m)) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-23T20:39:57.850

受到 Dominic 的代码的启发。我写了一个更简洁的版本

```
(defn dissoc-in
  [m [k & ks]]
  (if-not ks
    (dissoc m k)
    (assoc m k (dissoc-in (m k) ks))))

(dissoc-in {:a {:b {:c 1}}} [:a :b :c])  ;; => {:a {:b {}}} 
```

另一个版本 dissoc-in2 递归删除空地图

```
(defn dissoc-in2
  [m [k & ks]]
  (if-not ks
    (dissoc m k)
    (let [nm (dissoc-in2 (m k) ks)]
      (cond (empty? nm) (dissoc m k)
            :else (assoc m k nm)))))

(ut/dissoc-in {:a {:b {:c 3}}} [:a :b :c]) 
;;; => {:a {:b {}}}

(ut/dissoc-in2 {:a {:b {:c 3}}} [:a :b :c]) 
;;=> {} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-07T18:49:19.457

不用写了，[clojure.core.incubator](https://github.com/clojure/core.incubator)已经有了`dissoc-in`：

```
=> (dissoc-in {:children [{:name "Billy" :age 5}]} [:children 0 :age])
{:children [{:name "Billy"}]} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-11-08T18:31:48.197

我建议`dissoc-in`从[混合曲库](https://weavejester.github.io/medley)中使用。

以下是 0.7.0 版的代码：

```
(defn dissoc-in
  "Dissociate a value in a nested assocative structure, identified by a sequence
  of keys. Any collections left empty by the operation will be dissociated from
  their containing structures."
  [m ks]
  (if-let [[k & ks] (seq ks)]
    (if (seq ks)
      (let [v (dissoc-in (get m k) ks)]
        (if (empty? v)
          (dissoc m k)
          (assoc m k v)))
      (dissoc m k))
    m)) 
```

这是[medley master 中 dissoc-in 源代码的链接](https://github.com/weavejester/medley/blob/master/src/medley/core.cljc)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-13T07:40:14.640

```
(defn dissoc-in [m ks]
  (let [parent-path (butlast ks)
        leaf-key (last ks)]
    (if (= (count ks) 1)
      (dissoc m leaf-key)
      (update-in m parent-path dissoc leaf-key)))) 
```

# django - NoReverseMatch Django 邮递员

> ID：14488151
> 
> 赞同：1
> 
> 时间：2013-01-23T19:50:25.653
> 
> 标签：django, django-urls, django-1.4

为什么这会返回一个`NoReverseMatch`？

来自[django-postman](https://bitbucket.org/psam/django-postman/src/6ff9fdf9c33f7365a7235a789af2e47f47d9c4fa/postman/urls.py?at=default)：

```
url(r'^write/(?:(?P<recipients>[\w.@+-:]+)/)?$', 'write', name='postman_write'), 
```

模板：

```
<a href='{% url postman_write recipients=object.user %}'>Send Message</a> 
```

这也不起作用..

```
<a href='{% url postman_write object.user %}'>Send Message</a> 
```

返回：`Reverse for 'postman_write' with arguments '(<User: admin>,)' and keyword arguments '{}' not found.`正确构建此 url 我缺少什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:52:16.570

您正在`url`标签中传递一个用户对象。您需要传递用户名。

```
{% url postman_write recipients=object.user.username %} 
```

还要确保在主`urls.py`文件中包含邮递员 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T08:53:25.487

尝试：

`{% url postman_write object.user.username %}`

# python - 将 pull_all 和 push_all 与 python/mongoengine 一起使用

> ID：14488153
> 
> 赞同：1
> 
> 时间：2013-01-23T19:50:34.057
> 
> 标签：python, mongodb, mongoengine

我在 Mongo 中有这个对象：

```
mystuff = ListField(ReferenceField(Asset, dbref=True)) 
```

我有一个 Python 方法，它应该*更新*Mongo 对象，在它的*mystuff* Listfield 值前面加上给定的值。因为 Mongoengine 还没有办法将对象插入到列表中的某个点（并且添加此函数[的优先级较低](https://jira.mongodb.org/browse/SERVER-2362)），所以我尝试：

1.  将当前列表的内容保存到一个临时变量（*oldlist*）
2.  *更新*数据库条目，使用“pull_all”修饰符（它是[mongoengine](https://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html?highlight=update#atomic-updates)的一部分）清空*mystuff列表*
3.  *再次更新*数据库条目，使用 update(push)将新添加的项目推送到*mystuff列表*
4.  *再次*更新DB 条目，使用“push_all”修饰符和**oldlist*变量将旧内容推回*mystuff*列表。*

 *似乎“pull_all”需要某种修饰符，但如果我能弄清楚它想要什么，我会很危险。

有人有什么想法吗？当然，理想的情况是在*update()*中添加一个“insert_at”修饰符，但这不在我的掌控之中。边缘的生活等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:20:11.347

[`pull_all`](http://docs.mongodb.org/manual/reference/operator/pullAll/)获取要从列表中拉出的元素列表。在你的情况下，我相信这将是`oldlist`。

但是我认为您最好的选择可能是使用 检索整个文档[`get`](https://mongoengine-odm.readthedocs.org/en/latest/apireference.html#mongoengine.queryset.QuerySet.get)，修改客户端代码中的 mystuff 字段，然后使用[`save`](https://mongoengine-odm.readthedocs.org/en/latest/apireference.html#mongoengine.Document.save).

正如您所指出的，用于更新文档的工具是有限的。*

# php - 在 jquery 移动弹出窗口中传递参数

> ID：14488155
> 
> 赞同：0
> 
> 时间：2013-01-23T19:50:50.170
> 
> 标签：php, jquery, mysql, mobile, popup

好的，我一直在努力尝试使用 jquery mobile 将参数从页面传递到弹出 div（在同一页面内）。我只想能够在弹出窗口中编辑数据库中的项目。这是我要更新的项目数组：

```
 <div class="ui-block-c">
      <?php
        $fam_mem = $_db->rows('SELECT * from family_member', array());
        foreach($fam_mem as $f)
          {

    echo "<a href='?id=$f[member_ID]#edit_fam_mem' data-mini='true' data-theme='d' data-inline='true' data-role='button' data-rel='popup' data-position-to='window' data-transition='pop' data-icon='gear' data-iconpos='notext'>Edit</a>";

    echo "<a href='?id=$f[member_ID]#delete_fam_mem' data-mini='true' data-theme='d' data-inline='true' data-role='button' data-rel='popup' data-position-to='window' data-transition='pop' data-icon='delete' data-iconpos='notext'>Delete</a>";
          }
      ?>
    </div> <!--End ui-block-c--> 
```

这是弹出 div 的代码：

```
 <div data-role="popup" id="delete_fam_mem" data-theme="d" data-overlay-theme="b" class="ui-content" style="max-width:340px;">
      <?php //include_once("./delete_fam_mem.php");?>
    <h3>Delete Family Member</h3>
    <?php
    echo "id is ", $_GET[id]; exit;
        $del = $_db->query("DELETE FROM family_member WHERE member_ID = ", array($_GET[id]));
        if ( $del )
        echo "Chore $_GET[title] deleted successfully.";
        else "Could not be deleted, maybe you should go to counseling.";
    ?>
    <button class="button" onclick='closefancy()'>OK!</button>
    </div> <!--End Delete Family Member--> 
```

出于某种原因，它不会将页面中的 id 传递给弹出窗口。任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T08:14:47.463

刚刚提交了一份提案，建议如何将`opener`-button 中的参数带入弹出`beforeposition`事件，请参阅[https://github.com/jquery/jquery-mobile/issues/7136](https://github.com/jquery/jquery-mobile/issues/7136)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-23T20:02:34.410

放入您的标签 id 属性。就像“身份证”一样。并放置一个元素来接收页面中的值。喜欢：

```
 <input type="hidden" name="recivedId" /> 
```

所以你可以使用 jquery 做类似的事情：

```
$('#a').on('click',function(){
   $('#recivedId').val($(this).attr('href'));
}) 
```

# django - 如何使用多数据库在 django 中进行选择？

> ID：14488159
> 
> 赞同：0
> 
> 时间：2013-01-23T19:51:06.217
> 
> 标签：django, multi-database

我正在使用多数据库，我尝试：

```
 cursor = connection.cursor().using(profile.dbname)
        cursor.execute('select id_retorno from prc_sequenciadora(' + str(profile.idempresa) + ', "VENDA_PEDIDO", "IDVENDA_PEDIDO", 0, 0)')# calls PROCEDURE named LOG_MESSAGE which resides in MY_UTIL Package
        cursor.fetchall() 
```

但是出现了这个错误：

/comerx/pedidos/novo/ 'Cursor' 对象的 AttributeError 没有属性 'using'

这是回溯： http: [//pastebin.com/CD7B8BxJ](http://pastebin.com/CD7B8BxJ)

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:10:24.467

首先，您应该导入 django.db.connections - 这是一个类似字典的对象，允许您通过其别名检索特定的数据库连接。然后你应该使用它适当的光标。我相信 Cursor 对象没有“使用”方法（这就是错误消息所说的）。

所以，我们有：

```
from django.db import connections
my_db_alias = profile.dbname #in your situation
cursor = connections[my_db_alias].cursor()
# Your code goes here... 
```

欲了解更多信息：[https ://docs.djangoproject.com/en/dev/topics/db/sql/#executing-custom-sql-directly](https://docs.djangoproject.com/en/dev/topics/db/sql/#executing-custom-sql-directly)

# mysql - mySQL 在日期搜索中包括特定范围和更广泛范围

> ID：14488166
> 
> 赞同：0
> 
> 时间：2013-01-23T19:51:25.327
> 
> 标签：mysql, date

我有一个带有记录的表 X：

```
rec# start end 
===============
100  2000  2020 
101  2004  2005 
102  2006  2007 
```

我尝试：

```
 SELECT * from X where start >= 2004 and end <= 2005; 
```

和

```
 SELECT * from X where start BETWEEN 2004 and 2005; 
```

在这两种情况下，我（正确地）得到rec# 101 作为结果。但我还需要检索rec# 100，因为范围（2004-2005）包含在 2000-2020 记录中。

感谢您的任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:53:14.010

听起来你的不平等是错误的：

```
SELECT * FROM X WHERE start <= 2004 AND end >= 2005 
```

这将返回*包含*区间的所有记录`[2004,2005]`。

在[sqlfiddle](http://sqlfiddle.com/#!2/d73ee/1/0)上查看。

# jquery - 在下面的示例中替换内容而不是隐藏和显示的最佳方法？

> ID：14488172
> 
> 赞同：0
> 
> 时间：2013-01-23T19:51:47.290
> 
> 标签：jquery, html

下面我有一个文件输入和 2 个控制文件上传的开始和停止的 javascript 函数。

文件输入：

```
var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" +
    "<p class='imagef1_upload_form'><label>" +
    "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" +
    "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" +
    "<label><input type='button' name='imageClear' class='imageClear' value='Clear File'/></label>" +
    "<p class='imagef1_upload_process'>Loading...<br/><img src='Images/loader.gif' /></p>" +
    "<input type='hidden' class='numimage' name='numimage' value='" + GetFormImageCount() + "' />" +
    "</p><p class='imagef1_cancel' align='center'><label>" +
    "<input type='reset' name='imageCancel' class='imageCancel' value='Cancel' /></label>" +
    "</p><p class='imagemsg'></p><p class='listImage'></p>" +
    "<iframe class='upload_target_image' name='upload_target_image' src='/' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>"); 
```

开始上传功能：

```
 var sourceImageForm;

    function htmlEncode(value) { return $('<div/>').text(value).html(); }

function startImageUpload(imageuploadform){

  $(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
  $(imageuploadform).find('.imagef1_upload_form').css('visibility','hidden');
  $(imageuploadform).find('.imagemsg').css('visibility','hidden');
  sourceImageForm = imageuploadform;

      return true;
} 
```

停止上传功能：

```
function stopImageUpload(success, imageID, imagefilename){

      var result = '';
      imagecounter++;

      if (success == 1){
         result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully</span>';   
            $('.listImage').eq(window.lastUploadImageIndex).append('<input type="hidden" name="imgid[]" id="'+imageID+'" value="' + imageID + '" />');
            $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" data-imageID="'+imageID+'"  data-image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>');
         }

      $(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');
      $(sourceImageForm).find('.imagemsg').html(result);
      $(sourceImageForm).find('.imagemsg').css('visibility','visible'); 
      $(sourceImageForm).find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");
      $(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible');

      return true;   
} 
```

现在发生的情况是，当用户上传文件时，文本输入和按钮将被隐藏，并且加载栏将显示在文件输入和按钮所在的下方，然后当上传完成时，成功消息将显示在下方加载栏是。然而，这一切的问题在于它占用了太多空间。

我想要做的是以下内容：

1.  用户将使用文件输入和上传按钮使用文件输入上传文件
2.  上传时加载栏将替换文件输入和按钮，使其放置在文件输入和按钮所在的位置。
3.  当用户完成上传时，加载栏被文件输入和原始按钮替换，成功消息显示在下方，成功消息下方显示上传的文件名和每个文件名的删除按钮
4.  重复下一个上传文件的过程

我的问题是如何实现上述几点？目前我的代码在下面执行此操作：

下面是文件输入：

![在此处输入图像描述](../Images/0efc51798b6d00ae48dce0a1c0defe3d.png)

下面是用户上传文件时加载栏出现的位置，它隐藏了其余元素以仅显示加载栏和取消按钮，但这显示在文件输入和按钮所在的下方：

![在此处输入图像描述](../Images/257199fefc386dac18e9caef5ceea342.png)

下面是显示成功消息和带有删除按钮的文件名的位置，但这显示在加载栏的下方。如您所见，两者之间的差距太大，我想缩小它，所以我更喜欢替换为而不是隐藏和显示。

![在此处输入图像描述](../Images/836f0f4c4ef682b8633807ddb986b45f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:55:46.243

采用

```
.css('display','none'); 
```

代替`visibility:hidden`

当您通过设置隐藏某些内容`visibility`时`hidden`，它仍然会占用布局中的空间。如果您希望它表现得像根本不存在，则需要设置`display`。要将它带回来，只需将其设置`display`为`block`或隐藏它之前的任何内容。或者更好的是，只使用 jQuery 的`.hide()`和`.show()`函数（这意味着您不必担心它最初是`block`还是`inline`）。

# javascript - 在背景中缩放图片，站点参考

> ID：14488173
> 
> 赞同：0
> 
> 时间：2013-01-23T19:51:50.483
> 
> 标签：javascript, jquery, html, css

[这个网站http://www.rallypoint.com](http://www.rallypoint.com)如何缩放他们的背景图片？

*   当我改变浏览器的大小时，我可以看到 div 元素上的 height css 属性发生了变化，所以我假设它是某种在后台工作的 javascript。

![在此处输入图像描述](../Images/0cbce0a8268847d15c3753c4e627d453.png)

*   我在正文中看到的 javascript 函数是新的 Slider 但是我在网络上的任何地方都找不到关于此的任何参考，除了看起来不相关的 JQuery UI Slider，这是他们编写的自定义函数吗？

![在此处输入图像描述](../Images/f5b659241f7551aa71ef77a1d9360a52.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:57:45.153

他们使用 'background-size' CSS3 属性：

```
background-size: cover !important; 
```

阅读更多相关信息：[http ://www.css3.info/preview/background-size/](http://www.css3.info/preview/background-size/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:00:12.110

好吧，肯定有不止一种方法可以得到你想要的结果。我发现这是最有帮助的...

[完美的整页背景图片](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:04:57.767

这就是所谓的 FLUID 布局......它依赖于 CSS 而不是 javascript 阅读一点关于 boots strap 和其他 CSS 属性的信息

顺便说一句，您可以在 CSS 中看到背景位置为 50%（学习使用 chrome 开发工具）...这就是提示

# php - 使用 PHP 生成高对比度随机颜色

> ID：14488174
> 
> 赞同：0
> 
> 时间：2013-01-23T19:51:51.130
> 
> 标签：php, random, colors

我需要为系统中的所有用户生成随机颜色。诀窍是 2 个用户不能有非常相似的颜色，他们需要是可区分的。我有代码在给定原始混合颜色的情况下生成随机颜色，但找不到仅使用 PHP 生成具有高对比度的随机颜色的方法

```
public static function generateRandomColor($rgb)
{
    $red = rand(1, 256);
    $green = rand(1, 256);
    $blue = rand(1, 256);

    if (! empty($rgb))
    {
        $red = ($red + $rgb['red']) / 2;
        $green = ($green + $rgb['green']) / 2;
        $blue = ($blue + $rgb['blue']) / 2;
    }

    $color = "rgb({$red}, {$green}, {$blue})";

    return $color;
} 
```

然后我有一个循环：

```
$colorsArr = array();
$mixed = array('red' => 255, 'green' => 255, 'blue' => 255);
for($i = 0; $i < count($users); $i++)
{
    $color = generateRandomColor($mixed);

    $colorsArr .= '<div style="width:25px; height: 25px; background-color: ' . $color . '"></div>';
} 
```

现在这会生成颜色，但有些颜色看起来很像。目标是为每个用户提供独特的颜色。任何帮助表示感谢。

**注意：**我不想为 500 个用户硬编码颜色

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:18:25.520

我很无聊，这里有一些代码你可以用：

```
<?php
define( COL_MIN_AVG, 64 );
define( COL_MAX_AVG, 192 );
define( COL_STEP, 16 );

// (192 - 64) / 16 = 8
// 8 ^ 3 = 512 colors

function usercolor( $username ) {
        $range = COL_MAX_AVG - COL_MIN_AVG;
        $factor = $range / 256;
        $offset = COL_MIN_AVG;

        $base_hash = substr(md5($username), 0, 6);
        $b_R = hexdec(substr($base_hash,0,2));
        $b_G = hexdec(substr($base_hash,2,2));
        $b_B = hexdec(substr($base_hash,4,2));

        $f_R = floor((floor($b_R * $factor) + $offset) / COL_STEP) * COL_STEP;
        $f_G = floor((floor($b_G * $factor) + $offset) / COL_STEP) * COL_STEP;
        $f_B = floor((floor($b_B * $factor) + $offset) / COL_STEP) * COL_STEP;

        return sprintf('#%02x%02x%02x', $f_R, $f_G, $f_B);
}

for( $i=0; $i<30; $i++ ) {
        printf('<div style="height: 100px; width: 100px; background-color: %s">&nbsp;</div>'."\n", usercolor(rand()));
} 
```

许多颜色看起来非常相似，但它们彼此相邻的可能性很小。

# jquery - 无法弄清楚为什么 textarea 不能保持可编辑状态

> ID：14488179
> 
> 赞同：2
> 
> 时间：2013-01-23T19:52:07.750
> 
> 标签：jquery, html-table, row, edit

以下 jQuery 代码按预期工作（根据代码中的注释），本质上它的作用是

1.  检测点击了哪个表格行，
2.  遍历表的行并确定该行是否有输入，
3.  如果是，则获取并存储该行中文本框和文本区域的值
4.  从该行的 tds 中删除元素
5.  并用存储值的标签替换输入
6.  然后，在单击的行上，存储标签的值并
7.  标签被替换为使用存储值填充的输入

这是相关的jQuery：

```
// Detect row clicked and switch that row's labels to populated textboxes for editing
$('#tblBranchCoverage').on('click', 'tr', function () {

// When the following is commented out, the inputs work
//  If this block of code isn't commented, none of the rows inputs are editable
// First set any other rows back to labels if they have textboxes
$(this).parent().children('tr').each(function () {
    if ($(this).find('input').length > 0) {
        // Row has textboxes
        var county = $(this).find('#txtEditCounty').val(),
            state = $(this).find('#txtEditState').val(),
            zips = $(this).find('#txtEditZips').val(),
            $td = $(this).find('td');

        // Clear the cells first
        $td.html('');

        // Put the populated labels back in
        $(this).find('.countyCovered').text(county);
        $(this).find('.stateCovered').text(state);
        $(this).find('.zipsCovered').text(zips);
    }
});

// Only run this if there aren't already textboxes in the current row
if ($(this).find('input').length === 0) {
    // Get the values of the cells before the row is cleared
    var county = $(this).find('td.countyCovered').text(),
        state = $(this).find('td.stateCovered').text(),
        zips = $(this).find('td.zipsCovered').text();

    // Clear the text from the selected row
    $(this).find('.countyCovered, .stateCovered, .zipsCovered').text('');

    // Add textboxes to the cells populated with their respective values
    $(this).find('td.countyCovered').append('<input type="text" id="txtEditCounty" value="' + county + '" style="width: 111px;" /><br />' +
        '<input type="submit" id="btnSubmitCoverageEdits" value="Save Edits" /><br />' +
        '<input type="submit" id="btnCancelCoverageEdits" value="Cancel" />');
    $(this).find('td.stateCovered').append('<input type="text" id="txtEditState" value="' + state + '" max-length="2" style="width: 22px;" />');
    $(this).find('td.zipsCovered').append('<textarea id="txtEditZips" cols="100">' + zips + '</textarea>');

    // Size the textarea to its contents
    $('#txtEditZips').flexible();
}
return false;
}); 
```

正如我所说，上述功能按预期工作，除了当单击行中的一个输入时，编辑光标立即消失（好像焦点立即从输入中移除）。但是当我注释掉第一块代码（在代码中注明）时，输入变成了预期的可编辑。

我为此设置了一个[jsFiddle](http://jsfiddle.net/eventide/nHgXf/1/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:10:02.130

一个简单的解决方案是将以下行添加到您的代码中。[**在这里演示**](http://jsfiddle.net/nHgXf/3/)

```
$('#tblBranchCoverage').on('click', ':input', function (event) {
    event.stopPropagation();
}); 
```

由于 javascript 中的事件冒泡而发生此问题。当您单击输入框时，在对输入执行单击后，事件将传递给父元素。所以我们只需要停止所有输入控件上的事件冒泡。 `event.stopPropagation();`将帮助您做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:58:04.450

演示：http: [//jsfiddle.net/nHgXf/2/](http://jsfiddle.net/nHgXf/2/)

更改的Javascript：

```
var editting = false;

// Detect row clicked and switch that row's labels to populated textboxes for editing
$('#tblBranchCoverage').on('click', 'tr', function () {
    if(!editting)
    {
        editting = true;
    // When the following is commented out, the inputs work
    //  If this block of code isn't commented, none of the rows inputs are editable
    // First set any other rows back to labels if they have textboxes
$(this).parent().children('tr').each(function () {
        if ($(this).find('input').length > 0) {
            // Row has textboxes
            var county = $(this).find('#txtEditCounty').val(),
                state = $(this).find('#txtEditState').val(),
                zips = $(this).find('#txtEditZips').val(),
                $td = $(this).find('td');

            // Clear the cells first
            $td.html('');

            // Put the populated labels back in
            $(this).find('.countyCovered').text(county);
            $(this).find('.stateCovered').text(state);
            $(this).find('.zipsCovered').text(zips);
        }
    });

    // Only run this if there aren't already textboxes in the current row
    if ($(this).find('input').length === 0) {
        // Get the values of the cells before the row is cleared
        var county = $(this).find('td.countyCovered').text(),
            state = $(this).find('td.stateCovered').text(),
            zips = $(this).find('td.zipsCovered').text();

        // Clear the text from the selected row
        $(this).find('.countyCovered, .stateCovered, .zipsCovered').text('');

        // Add textboxes to the cells populated with their respective values
        $(this).find('td.countyCovered').html('<input type="text" id="txtEditCounty" value="' + county + '" style="width: 111px;" /><br />' +
            '<input type="submit" id="btnSubmitCoverageEdits" value="Save Edits" /><br />' +
            '<input type="submit" id="btnCancelCoverageEdits" value="Cancel" />');
        $(this).find('td.stateCovered').html('<input type="text" id="txtEditState" value="' + state + '" max-length="2" style="width: 22px;" />');
        $(this).find('td.zipsCovered').html('<textarea id="txtEditZips" cols="100">' + zips + '</textarea>');

        // Size the textarea to its contents
        $('#txtEditZips').flexible();
    }
    }
    editting =false;
    return false;
}); 
```

基本上是因为您绑定到 click 事件，它不断使所有 javascript 发生，并导致 DOM 和选择出现问题

# database - 在数据库中存储单词列表 - 最佳实践

> ID：14488184
> 
> 赞同：0
> 
> 时间：2013-01-23T19:52:23.173
> 
> 标签：database, django, postgresql, django-models

我正在网站上实施用户过滤系统。用户将能够选择他们感兴趣的“类别”和“包”，并在登录时显示匹配的数据。两组数据都来自[HTML 选择表单](http://harvesthq.github.com/chosen/)，例如。类别：“空指针”、“死代码”……以及包“package_x”、“package_y”、“package_z”……

我的问题是关于将此列表信息存储在数据库中的最佳方式（我使用的是 Django 和 PostgresSQL）。

我最初的想法是有一个这样的表：

```
user_id - one to one field
categories - textfield - store json data
packages - textfield - store json data 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T20:03:56.077

我会使用具有多对多字段的类别和包的[用户配置文件。](https://docs.djangoproject.com/en/1.4/topics/auth/#storing-additional-information-about-users)

在模型.py

```
from django.contrib.auth.models import User

class Category(models.Model):
    name = models.CharField(max_length=255)

class Package(models.Model):
    name = models.CharField(max_length=255)

class UserProfile(models.Model):
    user = models.ForiegnKey(User)

    categories = models.ManyToManyField(Category)
    packages = models.ManyToManyField(Package) 
```

在 admin.py

```
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.models import User

class CustomUserAdmin(UserAdmin):     
    inlines = [UserProfile]
    #filter_horizontal = ('',) #Makes the selection a bit more friendly

admin.site.unregister(User)
admin.site.register(User, CustomUserAdmin) 
```

在views.py

```
user_with_profile = User.objects.get(pk=user_id).get_profile() 
```

说了这么多。Django 1.5 将使用可[配置的用户模型](https://docs.djangoproject.com/en/dev/releases/1.5/#configurable-user-model)替换用户配置文件。

# php - php mod rewrite .htaccess 忽略目录

> ID：14488186
> 
> 赞同：0
> 
> 时间：2013-01-23T19:52:35.943
> 
> 标签：php, .htaccess, mod-rewrite

我应该设置什么规则，以使 mod_rewrite 完全忽略目录“public”？我的意思是，文件应该可以在其中访问，但如果文件不存在，服务器错误页面应该会出现类似“禁止”或“未找到文件”之类的信息。我不需要自定义错误页面或类似的东西。我只是想让“公众”表现得像根本没有 mod_rewrite 一样。

这是我的 .htaccess 文件：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

我的文件结构是

```
/system/
/application/
/public/ 
```

我希望文件夹 public 的行为，就像根本没有设置重写规则一样，完全忽略它。

**编辑**

那是我的 .htaccess 文件：

```
RewriteEngine on

RewriteRule ^(public)($|/) - [L,NC]

RewriteCond $1 !^(index\.php|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

我已经在 /public/ 文件夹中有这个 .htaccess ：

```
RewriteEngine off 
```

我已经尝试了上面所有不同的答案（以及来自谷歌的大量答案）。我试着把它们混在一起。

我的文件夹：

```
/system/
/application/
/public/ 
/public/.htaccess #RewriteEngine off
/public/favicon.ico
/index.php 
```

以下是我得到的结果的网址：

```
/public/favicon.ico -> I get the favicon
/public/faviDon.ico -> I get the index.php (without mod rewrite you would get "not found")
/public/ -> I get the index.php (without mod rewrite "forbidden") 
```

因此，如果找不到文件或直接访问文件夹，它仍然会重写 url。

你能看到吗？

非常感谢你们的努力！对此，我真的非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:09:47.727

**编辑**

我在我的机器上完全设置了你的文件

```
//  /.htaccess

RewriteEngine on

RewriteRule ^(public)($|/) - [L,NC]

RewriteCond $1 !^(index\.php|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

公共文件夹中的 .htaccess：

```
//  /public/.htaccess

Options -Indexes
RewriteEngine off 
```

这会禁用您想要的重写。

```
/public/                 -> 403 Forbidden
/public/favicon.ico      -> 200 File found
/public/not-existing.ext -> 404 File not found 
```

您的公共文件夹中有 index.php 吗？也许你可以删除那个..

你在什么机器上测试？

我在 Linux + Apache 2 + PHP5.3 上测试过

我可以在下午给你更多的支持（我的时间+2 GMT）

**编辑 2**

当我从 /.htaccess 中删除此行时仍然有效

```
RewriteRule ^(public)($|/) - [L,NC] 
```

一切都由公用文件夹中的 .htaccess 处理。

也许这是您浏览器中的缓存问题。尝试不同的浏览器/清理历史记录/安装应用程序以删除缓存..（取决于您使用的浏览器）

# python - 验证 Python 字符串中的整数

> ID：14488187
> 
> 赞同：1
> 
> 时间：2013-01-23T19:52:51.063
> 
> 标签：python, string, validation, integer

我们有大量包含可能是整数的子字符串的字符串，例如。

```
mystring = "123 345 456 567 678 789" 
```

并且需要验证：

一个。每个子字符串实际上是一个整数，例如。`mystring = "123 345 456 567 abc 789"`到达'abc'时失败

湾。每个整数都在 0 <= i <= 10000 的范围内，例如。`mystring = "123 -345 456 567 678 789"`达到“-345”时失败

一种解决方案是：

```
mylist= [int(i) for i in mystring.split() if isinstance(int(i), int) and (0 <= int(i) <= 10000)] 
```

问题是：

一世。在列表理解中，对于每个 i，int(i) 是被评估一次还是多次？

ii. 是否有更快的替代方法（因为字符串的数量很大，每个字符串可能包含数百到数千个整数）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:00:57.437

我想我可能会使用类似的东西：

```
try:
    if not all( (0 <= int(i) <= 10000) for i in mystring.split() ):
       raise ValueError("arg!")
except ValueError:
    print "Oops, didn't pass" 
```

`int`这样做的好处是，如果某些东西无法转换为 an或它不在正确的范围内，它会短路。

这是一个愚蠢的测试：

```
def test_str(mystring):
    try:
        return all( (0 <= int(i) <= 10000) for i in mystring.split() )
    except ValueError:
        return False

print test_str("123 345 456 567 abc 789")
print test_str("123 345 456 567 -300 789")
print test_str("123 345 456 567 300 789") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:03:11.513

`int(i)`被多次评估。此外，`isinstance(int(i), int)`它是无用的，因为`int()`会在非整数输入上引发异常，而不是默默地返回非整数。

将代码编写为老式循环并没有错。它在错误处理方面为您提供了最大的灵活性。如果您担心效率，请记住，列表理解只不过是此类循环的语法糖。

```
intlist = []
for part in mystring.split():
    try:
        val = int(part)
    except ValueError:
        continue  # or report the error
    if val < 0 or val > 10000:
        continue  # or report the error
    intlist.append(val) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T08:26:29.133

似乎我错过了辩论的激烈程度，但这是另一种 - 可能更快 - 方法：

```
>>> f = lambda(s): set(s) <= set('0123456789 ') and not filter(lambda n: int(n) > 10000, s.split()) 
```

测试：

```
>>> s1 = '123 345 456 567 678 789'
>>> s2 = '123 345 456 567 678 789 100001'
>>> s3 = '123 345 456 567 678 789 -3'
>>> s4 = '123 345 456 567 678 789 ba'
>>> f(s1)
True
>>> f(s2)
False
>>> f(s3)
False
>>> f(s4)
False 
```

我没有计时，但我怀疑它可能比其他提议的解决方案更快，因为集合比较已经处理了`x < 0`测试和不可解析的字符串，例如`abc`. 由于两个测试（集合比较和数值范围）在逻辑上是连接的，第一个测试失败将阻止运行第二个测试。

！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:08:54.653

如果存在非数字字符串，您的解决方案将不起作用：

> ValueError: int() 以 10 为底的无效文字：'abc'

我会做这样的事情：

```
mystring = "123 345 456 -123 567 abc 678 789"

mylist = []
for i in mystring.split():
    try:
        ii = int(i)
    except ValueError:
        print "{} is bad".format(i)
    if 0 <= ii <= 10000:
        mylist.append(ii)
    else:
        print  "{} is out of range".format(i)
print mylist 
```

要回答您的问题：

一世。是的，不止一次。

ii. 是的，已经提供了几个例子。

我的输出如下所示：

> -123 超出范围
> 
> abc不好
> 
> [123、345、456、567、567、678、789]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:38:27.477

您也可以使用正则表达式：

```
import re
mystring = "123 345 456 567 abc 789 -300 ndas"

re_integer = r'(-??\d+)'
re_space_or_eof = r'(\ |$)' #using space or eof so we don't match floats

#match all integers
matches = re.finditer(re_integer + re_space_or_eof, mystring)

#extract the str, convert to int for all matches
int_matches = [int(num.groups()[0]) for num in matches]

#filter based on criteria
in_range = [rnum for rnum in int_matches if 0 <= rnum <=10000]

>>> in_range
[123, 345, 456, 567, 789] 
```

# arrays - Matplotlib 保存 imshow 数组

> ID：14488188
> 
> 赞同：0
> 
> 时间：2013-01-23T19:52:59.923
> 
> 标签：arrays, matplotlib, plot, 2d

我想知道是否可以保存 imshow 函数的数组？我这是什么意思？

好吧，我有一个具有唯一值的二维数组。我想看到用颜色表示的，所以我自然会使用 imshow 函数。我知道 imshow 函数将颜色图应用于我的数组，然后显示它。我希望能够获得 matplotlib 用来显示我的原始二维数组的数组。这可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:35:50.393

你实际上可以得到颜色映射没有`imshow`

```
data_ = (data - np.min(data))/ (np.max(data) - np.min(data))
my_cmap = matplotlib.cm.get_cmap('gray') # or what ever color map you want
color_array = my_cmap(data_) 
```

`color_array`是一个 shape 数组`data.shape + (4,)`，即 MxNx4，其中 4 是 (r,g,b,a)。您`data`需要缩放到范围内`[0,1]`。

# c++ - 为什么是C FILE* fread() 比 Win32 ReadFile() 快吗？

> ID：14488189
> 
> 赞同：13
> 
> 时间：2013-01-23T19:53:00.440
> 
> 标签：c++, c, winapi, file-io

使用以下三种技术比较读取文件：

1.  C`<stdio.h>` `FILE*`
2.  Win32 `CreateFile()`/`ReadFile()`
3.  Win32 内存映射

我注意到#1 比#2 快，而#3 是最快的。

例如从最快到最慢排序，为了处理一个 900MB 的测试文件，我得到了这些结果：

> Win32 内存映射：821.308 毫秒
> 
> C 文件（文件*）：1779.83 毫秒
> 
> Win32 文件 (CreateFile)：3649.67 毫秒

为什么C`<stdio.h>`技术比Win32`ReadFile()`访问快？我希望原始 Win32 API 的开销比 CRT*少。*我在这里想念什么？

可编译的测试 C++ 源代码如下。

* * *

**编辑**

我使用 4KB 读取缓冲区并使用**三个**不同的文件（具有相同内容）重复测试，以避免可能扭曲性能测量的*缓存*效应，现在结果符合预期。
例如，对于大约 400 MB 的文件，结果是：

1.  **Win32 内存映射**：305.908 毫秒

2.  Win32 文件 (CreateFile)：451.402 毫秒

3.  C 文件（文件*）：460.579 毫秒

* * *

```
////////////////////////////////////////////////////////////////////////////////
// Test file reading using C FILE*, Win32 CreateFile and Win32 memory mapping.
////////////////////////////////////////////////////////////////////////////////

#include <stdio.h>
#include <stdlib.h>
#include <algorithm>
#include <exception>
#include <iostream>
#include <stdexcept>
#include <vector>
#include <Windows.h>

//------------------------------------------------------------------------
//                      Performance (speed) measurement
//------------------------------------------------------------------------

long long counter()
{
    LARGE_INTEGER li;
    QueryPerformanceCounter(&li);
    return li.QuadPart;
}

long long frequency()
{
    LARGE_INTEGER li;
    QueryPerformanceFrequency(&li);
    return li.QuadPart;
}

void print_time(const long long start, const long long finish,
    const char * const s)
{
    std::cout << s << ": " << (finish - start) * 1000.0 / frequency() << " ms\n";
}

//------------------------------------------------------------------------
//                      RAII handle wrappers
//------------------------------------------------------------------------

struct c_file_traits
{
    typedef FILE* type;

    static FILE* invalid_value()
    {
        return nullptr;
    }

    static void close(FILE* f)
    {
        fclose(f);
    }
};

struct win32_file_traits
{
    typedef HANDLE type;

    static HANDLE invalid_value()
    {
        return INVALID_HANDLE_VALUE;
    }

    static void close(HANDLE h)
    {
        CloseHandle(h);
    }
};

struct win32_handle_traits
{
    typedef HANDLE type;

    static HANDLE invalid_value()
    {
        return nullptr;
    }

    static void close(HANDLE h)
    {
        CloseHandle(h);
    }
};

template <typename Traits>
class handle
{
public:
    typedef typename Traits::type type;

    handle()
        : _h(Traits::invalid_value())
    {
    }

    explicit handle(type h)
        : _h(h)
    {
    }

    ~handle()
    {
        close();
    }

    bool valid() const
    {
        return (_h != Traits::invalid_value());
    }

    type get() const
    {
        return _h;
    }

    void close()
    {
        if (valid())
            Traits::close(_h);

        _h = Traits::invalid_value();
    }

    void reset(type h)
    {
        if (h != _h)
        {
            close();
            _h = h;
        }
    }

private: // Ban copy
    handle(const handle&);
    handle& operator=(const handle&);

private:
    type _h;    // wrapped raw handle
};

typedef handle<c_file_traits> c_file_handle;
typedef handle<win32_file_traits> win32_file_handle;
typedef handle<win32_handle_traits> win32_handle;

//------------------------------------------------------------------------
//              File reading tests using various techniques
//------------------------------------------------------------------------

unsigned long long count_char_using_c_file(const std::string& filename, const char ch)
{
    unsigned long long char_count = 0;

#pragma warning(push)
#pragma warning(disable: 4996) // fopen use is OK
    c_file_handle file(fopen(filename.c_str(), "rb"));
#pragma warning(pop)

    if (!file.valid())
        throw std::runtime_error("Can't open file.");

    std::vector<char> read_buffer(4*1024); // 4 KB
    bool has_more_data = true;
    while (has_more_data)
    {
        size_t read_count = fread(read_buffer.data(), 1, read_buffer.size(), file.get());
        for (size_t i = 0; i < read_count; i++)
        {
            if (read_buffer[i] == ch)
                char_count++;
        }

        if (read_count < read_buffer.size())
            has_more_data = false;
    }

    return char_count;
}

unsigned long long count_char_using_win32_file(const std::string& filename, const char ch)
{
    unsigned long long char_count = 0;

    win32_file_handle file(::CreateFileA(
        filename.c_str(),
        GENERIC_READ,
        FILE_SHARE_READ,
        nullptr,
        OPEN_EXISTING,
        FILE_FLAG_SEQUENTIAL_SCAN,
        nullptr
        )
        );
    if (!file.valid())
        throw std::runtime_error("Can't open file.");

    std::vector<char> read_buffer(4*1024); // 4 KB
    bool has_more_data = true;
    while (has_more_data)
    {
        DWORD read_count = 0;
        if (!ReadFile(file.get(), read_buffer.data(), read_buffer.size(), &read_count, nullptr))
            throw std::runtime_error("File read error using ReadFile().");

        for (size_t i = 0; i < read_count; i++)
        {
            if (read_buffer[i] == ch)
                char_count++;
        }

        if (read_count < sizeof(read_buffer))
            has_more_data = false;
    }

    return char_count;
}

// Memory-map a file.
class file_map
{
public:
    explicit file_map(const std::string& filename)
        : _view(nullptr), _length(0)
    {
        _file.reset(::CreateFileA(
            filename.c_str(),
            GENERIC_READ,
            FILE_SHARE_READ,
            nullptr,
            OPEN_EXISTING,
            FILE_ATTRIBUTE_NORMAL,
            nullptr));
        if (!_file.valid())
            return;

        LARGE_INTEGER file_size;
        if (!GetFileSizeEx(_file.get(), &file_size))
            return;

        if (file_size.QuadPart == 0)
            return;

        _mapping.reset(::CreateFileMapping(
            _file.get(), nullptr,
            PAGE_READONLY,
            0,
            0,
            nullptr)
            );
        if (!_mapping.valid())
            return;

        _view = reinterpret_cast<char*>
            (::MapViewOfFile(_mapping.get(), FILE_MAP_READ, 0, 0, 0));
        if (!_view)
            return;

        _length = file_size.QuadPart;
    }

    ~file_map()
    {
        if (_view)
            UnmapViewOfFile(_view);
    }

    bool valid() const
    {
        return (_view != nullptr);
    }

    const char * begin() const
    {
        return _view;
    }

    const char * end() const
    {
        return begin() + length();
    }

    unsigned long long length() const
    {
        return _length;
    }

private:    // ban copy
    file_map(const file_map&);
    file_map& operator=(const file_map&);

private:
    win32_file_handle   _file;
    win32_handle        _mapping;
    char*               _view;
    unsigned long long  _length;    // in bytes
};

unsigned long long count_char_using_memory_mapping(const std::string& filename, const char ch)
{
    unsigned long long char_count = 0;

    file_map view(filename);
    if (!view.valid())
        throw std::runtime_error("Can't create memory-mapping of file.");

    for (auto it = view.begin(); it != view.end(); ++it)
    {
        if (*it == ch)
        {
            char_count++;
        }
    }

    return char_count;
}

template <typename TestFunc>
void run_test(const char * message, TestFunc test, const std::string& filename, const char ch)
{
    const long long start = counter();
    const unsigned long long char_count = test(filename, ch);
    const long long finish = counter();
    print_time(start, finish, message);
    std::cout << "Count of \'" << ch << "\' : " << char_count << "\n\n";
}

int main(int argc, char* argv[])
{
    static const int kExitOk = 0;
    static const int kExitError = 1;

    if (argc != 3)
    {
        std::cerr << argv[0] << " <char> <filename>.\n";
        std::cerr << "Counts occurrences of ASCII character <char>\n";
        std::cerr << "in the <filename> file.\n\n";
        return kExitError;
    }

    const char ch = *(argv[1]);
    const std::string filename = argv[2];

    try
    {
        // Execute tests on THREE different files with the same content,
        // to avoid caching effects.
        // (file names have incremental number suffix).
        run_test("C <stdio.h> file (FILE*)", count_char_using_c_file, filename + "1", ch);
        run_test("Win32 file (CreateFile)", count_char_using_win32_file, filename + "2", ch);
        run_test("Win32 memory mapping", count_char_using_memory_mapping, filename + "3", ch);

        return kExitOk;
    }
    catch (const std::exception& e)
    {
        std::cerr << "\n*** ERROR: " << e.what() << '\n';
        return kExitError;
    }
}

//////////////////////////////////////////////////////////////////////////////// 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T21:32:20.280

刚刚在我的机器上运行了一些测试，表明增加缓冲区大小实际上会提高性能：

```
C <stdio.h> file (FILE*): 1431.93 ms
Bufsize: 0
Count of 'x' : 3161882

Win32 file (CreateFile): 2289.45 ms
Bufsize: 1024
Count of 'x' : 3161882

Win32 file (CreateFile): 1714.5 ms
Bufsize: 2048
Count of 'x' : 3161882

Win32 file (CreateFile): 1479.16 ms
Bufsize: 4096
Count of 'x' : 3161882

Win32 file (CreateFile): 1328.25 ms
Bufsize: 8192
Count of 'x' : 3161882

Win32 file (CreateFile): 1256.1 ms
Bufsize: 16384
Count of 'x' : 3161882

Win32 file (CreateFile): 1223.54 ms
Bufsize: 32768
Count of 'x' : 3161882

Win32 file (CreateFile): 1224.84 ms
Bufsize: 65536
Count of 'x' : 3161882

Win32 file (CreateFile): 1212.4 ms
Bufsize: 131072
Count of 'x' : 3161882

Win32 file (CreateFile): 1238.09 ms
Bufsize: 262144
Count of 'x' : 3161882

Win32 file (CreateFile): 1209.2 ms
Bufsize: 524288
Count of 'x' : 3161882

Win32 file (CreateFile): 1223.67 ms
Bufsize: 1048576
Count of 'x' : 3161882

Win32 file (CreateFile): 1349.98 ms
Bufsize: 2097152
Count of 'x' : 3161882

Win32 memory mapping: 796.281 ms
Bufsize: 0
Count of 'x' : 3161882 
```

Visual Studio 2012 调试器中的一些步骤显示 FILE* 方法的缓冲区大小为 4096 字节，至少在我的机器上是这样。（正如其他人已经说过的那样，`ReadFile`除非您从控制台读取，否则它也会调用。）

有趣的是，大缓冲区略微降低了性能。将`new`操作员移到测试之外也不能解决问题。

首先，内存映射测试对我来说非常慢，因为我在调试模式下运行它。我已经使用发布模式编译更新了所有结果。内存映射成为第一个。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-23T20:29:48.323

我获得过的最快的磁盘访问是使用`ReadFile`. 但是我专门用标志打开了文件以满足我的磁盘访问和缓存要求。如果你只是逐字使用它，比较有点蹩脚。

您应该阅读有关该功能的更多信息，以及`CreateFile`. 您会发现您可以将（多个）扇区大小的块中的数据读取到扇区对齐的内存中。那么你的表现会更好`fread`。

正如其他人所说，`fread`正在做自己的缓冲。您的缓冲实现`ReadFile`仍然需要工作。

查看 MSDN。所有的信息都在那里。具体来说，这里：

*   [文件缓冲](http://msdn.microsoft.com/en-us/library/windows/desktop/cc644950%28v=vs.85%29.aspx)

*   [缓存行为](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx#caching_behavior)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-23T20:28:08.120

你确定你测试正确吗？
您如何计算磁盘位置、寻道时间、文件缓存等？

stdio 和 win32 最终对 Windows 内核进行相同的调用以打开文件。

mmap 做的事情略有不同，因为它可以保留实际读取数据直到它被使用 - 如果你有一个固定的文件大小和性能问题，mmap 是一个不错的选择

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-23T20:34:37.237

使用内存映射文件时，无需将文件的内容复制到您的应用程序 - 它直接从操作系统映射为虚拟内存的一部分，因此当您访问文件内容时，它只需要被直接读入进入映射内存的页面。

如果您在使用 Win32 API 时正确完成工作，那么 C stdio 应该更快，因为调用中的开销更少。但是，您很可能没有在系统调用开销和“缓冲区太大，因此读取时间超过必要时间”之间取得理想的平衡。我建议您尝试使用 4K 或 8K（甚至可能是 32K）作为 Win32 API 功能中的缓冲区 - 理想的缓冲区大小为 4K 的倍数，因为内存页面（通常）为 4KB。对 API 的调用越少，开销就越小，但您不想走得太远。

[前几天我在 Linux 上做了一些类似的测试，发现了类似的结果——根据我在那里的经验：为每个测试使用不同的文件，否则你的文件系统缓存将有助于稍后运行的测试！]。

# c# - AC#函数从日月年检查日期

> ID：14488196
> 
> 赞同：2
> 
> 时间：2013-01-23T19:53:36.117
> 
> 标签：c#, asp.net, date, datetime

我有三个字符串/整数，分别是日、月和年。有什么方法可以检查它们是否采用有效的 DateTime 格式？我正在使用 ASP.NET。

当用户注册时，他输入月、日和年。

我曾经将三个变量转换为字符串并尝试解析以检查它是否合法，但唯一的问题是在不同的机器上运行相同的项目，因为一些不同的机器使用不同的日期格式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T19:55:00.537

这个怎么样：

```
 private bool IsValidDate(int year, int month, int day)
    {
        if (year < DateTime.MinValue.Year || year > DateTime.MaxValue.Year)
            return false;

        if (month < 1 || month > 12)
            return false;

        return day > 0 && day <= DateTime.DaysInMonth(year, month);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:57:07.180

如果您已经将*日*、*月*和*年*作为三个单独的整数，则可以直接使用[DateTime 的构造函数之一](http://msdn.microsoft.com/en-us/library/xcfzdy4x.aspx)，而不是将它们放入字符串中并将其重新解析为 DateTime。

```
DateTime mydate;
myDate = new DateTime(year, month, day); 
```

`ArgumentOutOfRangeException`如果日期无效，这将抛出一个错误，因此您应该将其包装在 try/catch 块中，并`catch(ArgumentOutOfRangeException e)`在您的日期没有有效格式时使用块来管理逻辑。

# java - “...未经检查或不安全的操作”通用容器类

> ID：14488201
> 
> 赞同：1
> 
> 时间：2013-01-23T19:53:47.933
> 
> 标签：java, generics, containers

我想创建一个通用容器类，它可以包含其他类的一个对象。我认为这可能是一种合理的方法：

```
class Container <T> {
    private T thing;

    public void Store(T obj) {
        thing = obj;
    }

    public T ReturnIt() {
        return thing;
    }
} 
```

当我尝试将其与一个 Book 类一起使用时，我收到以下错误消息：“注意：GenericContainer.java 使用未经检查或不安全的操作。注意：使用 -Xlint 重新编译：未检查详细信息。”

可能`public T ReturnIt() { return thing; }`是错误的原因，这是返回容器类中包含的对象的错误方法吗？当我尝试使用 -Xlint:unchecked 编译它时，我没有得到任何进一步的信息。我对错误消息有什么看法？

导致错误的代码：

```
class GenericContainer {

    public static void main(String[] args) {
        Container BookStorage = new Container <Book>();
        Book thejavabook = new Book("The Java book");   
        BookStorage.Store(thejavabook);
    }       
}

class Book {
    private String title;
    Book(String title) {
        this.title = title;
    }
}

class Container <T> {
    private T thing;

    public void Store(T obj) {
        thing = obj;
    }

    public T ReturnIt() {
        return thing;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:00:10.597

您的 BookStorage 变量应该这样定义：

```
Container<Book> BookStorage = new Container <Book>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:02:06.993

我已经重写了您的代码以解决问题并使用 java 命名标准：

```
package com.sandbox;

public class Sandbox {

    public static void main(String[] args) {
        Container<Book> bookStorage = new Container<Book>();  //fix for your warning!
        Book theJavaBook = new Book("The Java book");
        bookStorage.store(theJavaBook);
    }
}

class Book {
    private String title;   //this is unused

    Book(String title) {
        this.title = title;
    }
}

class Container<T> {
    private T thing;

    public void store(T obj) {
        thing = obj;
    }

    public T returnIt() {
        return thing;
    }
} 
```

强调这一行：

```
Container<Book> bookStorage = new Container<Book>();  //fix for your warning! 
```

您忘记将 放在`<Book>`作业的左侧。

# c# - 做空长 if 语句

> ID：14488204
> 
> 赞同：0
> 
> 时间：2013-01-23T19:54:09.440
> 
> 标签：c#, winforms, visual-studio-2012

我花了几个小时制作井字游戏，主要是使用 if else 语句，我刚刚复制和粘贴的一些代码......

我如何只创建一个代码实例，然后再参考它？- 当我需要该代码时，而不是每次都复制和粘贴大量代码行。在这段代码中，我得到一个介于 1 到 10 之间的随机数，该数字将存储在 RI 中……然后轮到 Ai 时，计算机将在按钮中随机输入一个 X，然后使用此代码检查确定计算机是否获胜。我希望这是有道理的=）

```
do
{
    storeRI = rc.Next(0, 10); //storing random number into storeRI so it can be used later on in life. 
    if (storeRI == 1 && btn1.Text == "")
    {
        btn1.Text = "X";
        Turn = 1;
        if (btn1.Text == "X" & btn2.Text == "X" & btn3.Text == "X")
        {
            btn1.BackColor = Color.Green;
            btn2.BackColor = Color.Green;
            btn3.BackColor = Color.Green;

            XScore += 1;
            lblPScoreX.Text = XScore.ToString();

            foreach (Button btn in buttonList)
                 btn.Enabled = false;
        }
        else if (btn1.Text == "X" & btn4.Text == "X" & btn7.Text == "X")
        {
             btn1.BackColor = Color.Green;
             btn4.BackColor = Color.Green;
             btn7.BackColor = Color.Green;

             XScore += 1;
             lblPScoreX.Text = XScore.ToString();

             foreach (Button btn in buttonList)
                btn.Enabled = false;
        }
    }
} 
```

例如，这段代码是一些我至少复制了 10 次的代码，它只是让我的代码看起来很难看，而且很难阅读。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T19:55:46.673

> 例如这段代码，是一些代码，我至少复制了 10 次

任何时候你复制了代码，你都应该尝试将它移动到一个方法中。然后，您可以直接调用该方法。在您的情况下，一种方法可以轻松地接受三个按钮来影响并直接处理它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:57:21.300

您可能想要研究的重构技术是[Consolidate Duplicate Conditional Fragments](http://www.refactoring.com/catalog/consolidateDuplicateConditionalFragments.html)

```
if (btn1.Text == "X" & btn2.Text == "X" & btn3.Text == "X")
{
    btn2.BackColor = Color.Green;
    btn3.BackColor = Color.Green;
}
else if (btn1.Text == "X" & btn4.Text == "X" & btn7.Text == "X")
{
    btn4.BackColor = Color.Green;
    btn7.BackColor = Color.Green;
}
else
{
    return/break/continue; // hard to tell which you what as you have a do without a corresponding while
}

btn1.BackColor = Color.Green;

XScore += 1;
lblPScoreX.Text = XScore.ToString();
foreach (Button btn in buttonList)
{
    btn.Enabled = false;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T20:02:05.033

```
 bool TestWin(Button btnA, Button btnB, button btnC)
   {
           if (btnA.Text == "X" & btnB.Text == "X" & btnC.Text == "X")
           {
                    btnA.BackColor = Color.Green;
                    btnB.BackColor = Color.Green;
                    btnC.BackColor = Color.Green;

                    XScore += 1;
                    lblPScoreX.Text = XScore.ToString();

                    foreach (Button btn in buttonList)
                    {
                         btn.Enabled = false;
                    }
                    return true;
           }
           return false;
     }

     if (!TestWin(btn1, btn2, btn3))
           TestWin(btn1, btn4, btn7); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:00:23.070

```
if (btn1.Text == "X")
{
    btn1.BackColor = Color.Green;
    if(btn2.Text == "X" & btn3.Text == "X")
        btn2.BackColor = Color.Green;
        btn3.BackColor = Color.Green;
    }
    else if (btn4.Text == "X" & btn7.Text == "X")
    {
        btn4.BackColor = Color.Green;
        btn7.BackColor = Color.Green;
    }
    XScore += 1;
    lblPScoreX.Text = XScore.ToString();
    foreach (Button btn in buttonList)
    {
        btn.Enabled = false;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:06:27.227

长长的 if else 语句没有错；拥有可阅读的长代码比不可管理的短代码要好。

我可以看到可能有帮助的一件事是添加一个方法（进行一些更改以匹配您的类型）：

```
public void ChangeButtonColor(Color thisColor, params Button[] buttons)
{
    foreach (Button thisButton in buttons)
    {
        thisButton.BackColor = thisColor
    }
} 
```

然后你可以添加到你的代码中：

```
ChangeButtonColor(Color.Green, btn1, btn2, btn3); 
```

这将为您节省一些重复的代码。

# r - R中的通用“类”

> ID：14488206
> 
> 赞同：3
> 
> 时间：2013-01-23T19:54:17.247
> 
> 标签：r, generics, data-structures, stack

我编写了一个带有以下功能的堆栈“类”：`add`, `push`, `pop`, `size`, `isEmpty`, `clear`（以及更多）。

我想在 R 中使用这个“类”作为泛型，所以我可以在我的脚本中创建多个堆栈实例。我该怎么做呢？

*（我有引号中的类，因为我的堆栈函数是用不同的脚本编写的（不一定是类本身的定义）*

提前致谢

```
list <- ""
cursor = 0

#Initializes stack to empty
stack <- function(){
list <- c()
cursor = -1

assign("list",list,.GlobalEnv)
assign("cursor",cursor,.GlobalEnv)
}

#Where item is a item to be added to generic list
push <- function(item){
if(size(list) == 0){
    add(item, -1)
}else{
    add(item, 0)        
}
assign("list",list,.GlobalEnv)
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T21:01:02.983

这是堆栈实现@GSee 引用的更简单版本，它避免使用 R 中可用的任何正式的面向对象系统。简化源于 R 中的所有函数都是闭包并且在函数调用期间创建的函数都绑定到为该调用创建的环境。

```
new_stack <- function() {
    stack <- vector()
    push <- function(x) stack <<- c(stack, x)
    pop <- function() {
        tmp<-tail(stack, 1)
        stack<<-stack[-length(stack)]
        return(tmp)
    }
    structure(list(pop=pop, push=push), class='stack')
}

x <- new_stack()
x$push(1:3)
x$pop()
# [1] 3
x$pop()
# [1] 2 
```

这是一个 S4 实现，用于比较。

```
setClass('Stack', 
         representation(list='list', cursor='numeric'),  # type defs
         prototype(list=list(), cursor=NA_real_))        # default values

setGeneric('push', function(obj, ...) standardGeneric('push'))
setMethod('push', signature(obj='Stack'), 
    function(obj, x) {
        obj@list <- c(x, obj@list)
        obj
})

setGeneric('pop', function(obj, ...) standardGeneric('pop'))
setMethod('pop', signature(obj='Stack'),
    function(obj) {
        obj@cursor <- obj@list[[1]]
        obj@list <- obj@list[-1]
        obj
    }
)

x <- new('Stack')

# cursor is empty to start
x@cursor
#[1] NA

# add items
x <- push(x, 1)
x <- push(x, 2)

# pop them (move next item to cursor, remove from list)
x <- pop(x)
x@cursor
# [1] 2
x <- pop(x)
x@cursor
# [1] 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T20:46:12.640

由于您专门讨论的是带有 push 和 pop 方法的堆栈“类”，因此这是 Jeff Ryan 取自[Introducing Closures](http://www.lemnica.com/esotericR/Introducing-Closures/)的一个实现，您可以阅读它来解释这里发生的事情。

```
new_stack <- function() { 
  stack <- new.env()
  stack$.Data <- vector()
  stack$push <- function(x) .Data <<- c(.Data,x)
  stack$pop  <- function() {
    tmp <- .Data[length(.Data)]
    .Data <<- .Data[-length(.Data)]
    return(tmp)
  }
  environment(stack$push) <- as.environment(stack)
  environment(stack$pop) <- as.environment(stack)
  class(stack) <- "stack"
  stack
}

> x <- new_stack()
> x$push(1:3)
> x$pop()
[1] 3
> x$pop()
[1] 2 
```

然后，如果您创建 S3 泛型...

```
push <- function(x, value, ...) UseMethod("push")
pop  <- function(x, ...) UseMethod("pop")
push.stack <- function(x, value, ...) x$push(value)
pop.stack  <- function(x) x$pop()

> push(x, 5)
> pop(x)
[1] 5
> pop(x)
[1] 1 
```

# xml - 我们应该在 CDuce 中重写 XSL 吗？

> ID：14488207
> 
> 赞同：-1
> 
> 时间：2013-01-23T19:54:23.127
> 
> 标签：xml, xslt, xml-parsing, xsd, xslt-1.0

我们目前有一个巨大的 XSLT 转换，需要 20-30 分钟来处理。我们需要提高性能，我们正在考虑[CDuce](http://www.cduce.org/)。CDuce 看起来很有希望。这样做的好方法是什么？我们是否必须在 CDuce 中重写整个 xsl 逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T12:25:48.177

您可以用另一种语言重写它，但可能有更简单的选择，这取决于 XSLT 1 代码的效率。如果它使用`//`很多，那么通过将其重写为不使用`//`并改用键或其他构造来获得数量级的速度改进并不少见。当然，切换到更新的更高度优化的 XSLT 引擎也不会受到伤害。（您的问题被标记为 xslt 1 但 XSLT2 引擎无需或很少更改即可运行它）

# html - CSS3 的布局问题

> ID：14488209
> 
> 赞同：2
> 
> 时间：2013-01-23T19:54:28.697
> 
> 标签：html, css, layout

因此，让我首先说我无论如何都不是设计师，我在各种项目中到处修改 HTML 和 CSS，但这对我来说从来都不是全职工作。但是，我最近一直在尝试使用他们的官方快速入门视频学习 Microsoft HTML5 w/ Javascript 和 CSS3 考试，我遇到了一个我似乎无法找到答案/解释的问题。

问题是：

```
How much space will my second column take if the definition of my grids is as follows:

.grid #mydivs > div{
            display: -ms-grid;
            -ms-grid-columns: 100px 1fr 100px;
            -ms-grid-rows: 100px 1fr 100px;
            width: 600px;
           height: 400px;
      } 
```

看着它，我以为答案是 100px，但这似乎是不正确的。有人可以解释一下这里的正确答案是什么以及如何得出它吗？非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:02:07.747

这是非常奇怪的语法，这里是文档： http: [//msdn.microsoft.com/en-us/library/windows/apps/hh466340.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh466340.aspx)我认为第二列是剩余宽度的剩余部分。所以可能是400px。

编辑：

它是如何工作的：

fr 代表剩余宽度的一小部分，因为只有一个 fr 宽度，值 1fr 表示“剩下的任何内容”，因此为 400px。如果有 1fr、3fr 表示将剩余宽度分成四等分，那么它们将是 100px 和 300px，因为它们使用了 1 个和 3 个四分之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:02:17.563

根据[http://msdn.microsoft.com/en-us/library/windows/apps/hh466340.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh466340.aspx)，您的第二列将占用剩余宽度的 1fr（分数）。知道您的第一列将使用 100px 和最后一个 100px 以及 600px 的总宽度：

答案应该是`1 fraction of 400px (600px - 100px - 100px)`或`400px`。

# sencha-touch - Sencha Touch 2.0 多列表项按钮

> ID：14488210
> 
> 赞同：0
> 
> 时间：2013-01-23T19:54:30.990
> 
> 标签：sencha-touch, sencha-touch-2

有谁知道是否可以在 Sencha Touch 列表项上有多个图标按钮来监听不同的事件？如果是这样，我该如何做到这一点？

例如，假设我有一个人员列表，并且有一个电子邮件、电话图标和每个人的位置地图。我想显示 3 个小图标并能够映射每个图标以执行 3 个单独的操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:53:59.970

这取决于您如何创建按钮。

如果按钮是简单的 HTML using `itemTpl`，您可以只监听 List 上的[itemtap](http://docs.sencha.com/touch/2-1/#!/api/Ext.dataview.DataView-event-itemtap)事件并使用`event`参数来检测您按下了哪个按钮。您可以通过自定义属性甚至类名来做到这一点：

```
myListItemTapListener: function(list, index, target, e) {
    var el = Ext.get(e.getTarget());
    if (el.hasClass('map')) {
        this.navigate(index);
    } else if(el.hasClass('email')) {
        this.email(index);
    } else if(el.hasClass('phone')) {
        this.phone(index);
    }
} 
```

如果您的按钮实际`Ext.Button`位于组件列表中，则可以在创建组件时简单地在每个按钮上添加一个侦听器。Sencha Docs的[DataView Guide](http://docs.sencha.com/touch/2-1/#!/guide/dataview)中有一个如何执行此操作的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T20:00:52.880

组件 DataView 可能会对您有所帮助。你可以看到这个[指南]：[http ://docs.sencha.com/touch/2-0/#!/guide/dataview-section-4](http://docs.sencha.com/touch/2-0/#!/guide/dataview-section-4)

我写了一个 [demo]：[https://github.com/hs3180/Sencha-Touch-Component-DataView](https://github.com/hs3180/Sencha-Touch-Component-DataView) ，在 app/view/ 中，

*   Main.js，一个带有***useComponets 为***true 的数据视图组件，并将***defaultType***设置为“demo.view.Item”。
*   Item.js，一个DataItem，每个item的可见内容是一个面板（在Card.js中）。我使用数据映射将记录中的**名称**（在 store 中）链接到**userName**（在 demo.view.Card 中）。
*   Card.js，每个人的面板。一个用户名标题和 3 个按钮。

# java - Java I/O。delete() 方法不从目录中删除创建的文件

> ID：14488211
> 
> 赞同：2
> 
> 时间：2013-01-23T19:54:32.173
> 
> 标签：java, io, mkdir

这段代码在文件夹目录中创建了一个 .txt （它可以工作），但是当需要使用`delete()`方法删除整个目录或 .txt 文件时，什么也没有发生。该`delete()`方法仅在我将 .txt 文件替换为普通文件夹时才有效

```
import java.io.*;

public class Filemkdir {
        public static void main(String[] args) throws Exception {
                File f = new File("C:/Temp/Java/secret.txt");

                FileWriter fSecret = new FileWriter(f);
                f.mkdir();

                f.delete();
        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T19:57:11.880

在 Windows 上，您无法删除打开的文件。关闭第`FileWriter`一个。

此外，该

```
f.mkdir(); 
```

似乎完全没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:57:55.347

也许 fSecret ( `FileWriter`) 需要先关闭。否则文件“正在使用中”

```
fSecret.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:07:59.857

您基本上需要在删除文件之前关闭 writer 对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T19:59:43.280

文件删除工作在文件上，如果你想删除目录，你首先需要删除 id 中的所有文件。

使用您的代码，您将提供文件路径，但之后您将创建目录。

# bash - awk/gsub - 每行多次打印双引号之间的所有内容

> ID：14488221
> 
> 赞同：5
> 
> 时间：2013-01-23T19:55:04.193
> 
> 标签：bash, sed, awk

我试图打印双引号 ( `sampleField="sampleValue"`) 之间的所有数据，但无法获取`awk`和/或`sub`/`gsub`返回双引号之间的所有数据实例。然后，我想在找到它们的相应行上打印所有实例，以将数据保持在一起。

这是该`input.txt`文件的示例：

```
deviceId="1300", deviceName="router 13", deviceLocation="Corp"
deviceId="2000", deviceName="router 20", deviceLocation="DC1" 
```

我正在寻找的输出是：

```
"1300", "router 13", "Corp"
"2000", "router 20", "DC1" 
```

我在使用 gsub 删除 a`,`和`=`. 每次我尝试不同的方法时，它总是只返回第一个字段并移动到下一行。

更新：

我忘了提到我不知道每行会有多少双引号封装的字段。它可以是 1、3 或 5,000。不确定这是否会影响解决方案，但想确保它在那里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:12:22.843

一个`sed`解决方案：

```
sed -r 's/[^\"]*([\"][^\"]*[\"][,]?)[^\"]*/\1 /g'
    <<< 'deviceId="1300", deviceName="router 13", deviceLocation="Corp"' 
```

输出：

```
"1300", "router 13", "Corp" 
```

或者对于一个文件：

```
sed -r 's/[^\"]*([\"][^\"]*[\"][,]?)[^\"]*/\1 /g' input.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:05:33.740

```
awk -F '"' '{printf(" %c%s%c, %c%s%c, %c%s%c\n", 34,$2, 34, 34, $4,34, $6, 34) } ' \
    input file > newfile 
```

是另一种更简单的方法，使用引号作为字段分隔符。

```
awk 'BEGIN{ t=sprintf("%c", 34)}
     { for(i=1; i<=NF; i++){
        if(index($i,t) ){print $i}  }; printf("\n")}'  infile > outfile 
```

更通用的 awk 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T22:52:13.133

```
awk -F \" '
    {
        sep=""
        for (i=2; i<=NF; i+=2) {
            printf "%s\"%s\"", sep, $i
            sep=", "
        }
        print ""
    }
' << END
deviceId="1300", deviceName="router 13", deviceLocation="Corp", foo="bar"
deviceId="2000", deviceName="router 20", deviceLocation="DC1"
END 
```

输出

```
"1300", "router 13", "Corp", "bar"
"2000", "router 20", "DC1" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-22T19:18:16.010

awk/sub/gsub/ 可能既不是最直接的方法，也不是最简单的方法。当它们有意义时，我喜欢单线：

(1) 在 Perl 中：

```
172-30-3-163:ajax vphuvan$ perl -pe 's/device.*?=//g' input.txt
"1300", "router 13", "Corp"
"2000", "router 20", "DC1"

where 
-p means "print to screen"
-e means execute the statement between the single quotes
s is a regular expression command which gives the instruction to substitute
g is the switch for the regular expression. /g instructs the program to carry out the substitution /device.*?=// wherever applicable
/device.*?=// is an instruction to replace with an empty string '' any expression that starts with the prefix "device" and that ends just before the closest "=" sign. Note that "deviceId", "deviceName"  and "deviceLocation" all start with the prefix "device" and each of them ends just before the "=" sign 
```

(2) 在 bash 中：

```
172-30-3-163:ajax vphuvan$ sed "s/deviceId=//; s/deviceName=//; s/deviceLocation=//" input.txt
"1300", "router 13", "Corp"
"2000", "router 20", "DC1" 
```

在这种情况下，我们指示**sed**连续运行三个替换指令，其中 "deviceId"、"deviceName" 和 "deviceLocation" 分别替换为空字符串 ''

不幸的是，**sed**（以及 sub 和 gsub）对正则表达式的支持比 Perl 弱得多，Perl 是完全正则表达式支持的黄金标准。特别是**sed**和 sub/gsub 都不支持非贪婪指令“？”，这个失败让我的生活变得相当复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-24T05:57:22.450

试试这个

`awk -F\" '{ for(i=2; i<=NF; i=i+2){ a = a"\""$i"\""",\t";} {print a; a="";}}' temp.txt`

输出

```
"1300",  "router 13",     "Corp"
"2000",  "router 20",     "DC1" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-26T18:02:52.477

这为时已晚，但一个可能的简单解决方案是：

```
 $ awk -F"=|," '{print $2,$4,$6}' input.txt
"1300" "router 13" "Corp"
"2000" "router 20" "DC1" 
```

# iphone - CATiledLayer - 异步下载图片时如何使用

> ID：14488228
> 
> 赞同：0
> 
> 时间：2013-01-23T19:55:27.713
> 
> 标签：iphone, ios, objective-c, uiimageview, catiledlayer

在我的应用程序中，我有一个滚动视图，一个更大的滚动视图，上面有很多子视图，子视图会根据滚动动态添加。我尝试在滚动时动态添加子视图（图像视图），当用户滚动时，我尝试根据 pageSize 等从服务器异步获取更多图像，并将这些图像放入相应的图像视图中。

我也经历过 Apple 的 WWDC Session 104，这似乎对离线图像很有用。

我还尝试按比例调整滚动视图上的图像大小，我相信这很好。问题是当滚动视图上的图像数量增加时，应用程序内存不足。这一定是由于我直接在图像视图中使用图像而不是使用 CATiledLayer。但是，我正在寻求使用 CATiledLayer 在滚动视图上显示异步图像的帮助。

非常感谢，

雷诺琼斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:13:24.083

我根据评论完全编辑了答案。

您应该将控制器设置为滚动视图的委托，而不是在 scrollViewDidScroll: （或在 scrollViewDidEndDecelerating: 如果您想减少检查频率）方法中，您可以检查您的某些图像是否在内容视图的可见部分之外，然后释放（即设置指针为零）他们节省一些内存。

为方便起见，这里有一个示例如何获取内容的可见部分：

```
CGRect visibleRect;
visibleRect.origin = scrollView.contentOffset;
visibleRect.size = scrollView.bounds.size; 
```

应该释放完全超出该矩形的所有内容（当然，如果用户滚动，您必须重新加载它们：不断加载/卸载可能会很棘手......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:25:11.507

简而言之，这就是我所做的一切.. 我已经异步下载图像并将它们缓存在设备上，然后我向当前的 tile 类添加了一个 UIImage (imageObject) 属性，该属性保存正在下载然后实现的图像对象以下并为我做了诀窍。信不信由你，imageview 加载与 CATiledLayer - CATiledLayer 的速度和效率提高了 100 倍。

```
+ layerClass
{
    return [CATiledLayer class];
}

- (void)drawRect:(CGRect)rect
{
    [imgObject drawAtPoint:CGPointMake(0,0)];
} 
```

希望它在未来对其他人有所帮助。如果我能提供更多帮助，请告诉我。

# android - 使用 ActionBarSherlock 左上角的图标进行导航

> ID：14488229
> 
> 赞同：7
> 
> 时间：2013-01-23T19:55:38.180
> 
> 标签：android, android-actionbar, actionbarsherlock

使用找到的开发人员指南[`here`](http://developer.android.com/guide/topics/ui/actionbar.html#Home)，我试图让我的图标导航回我的主屏幕。我目前有一个按钮可以执行此操作，并且已将代码复制并粘贴到该`onOptionsItemSelected()`方法中。然而，点击图标永远不会做任何事情。这是 ActionBar 和 ActionBarSherlock 的区别吗？

这是作为示例给出的代码：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
switch (item.getItemId()) {
    case android.R.id.home:
        // app icon in action bar clicked; go home
        Intent intent = new Intent(this, HomeActivity.class);
        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);
        return true;
    default:
        return super.onOptionsItemSelected(item);
}
} 
```

这是我正在使用的代码：

```
public boolean onOptionsItemSelected( MenuItem item ) {
    switch( item.getItemId() ) {
    case R.id.mainTopBluetoothState:
        Toast.makeText( this, "BluetoothState", Toast.LENGTH_SHORT ).show();
        return true;
    case R.id.mainTopAppState:
        Toast.makeText( this,  "BluetoothState",  Toast.LENGTH_SHORT ).show();
        return true;
    case android.R.id.home:
        Log.i( "In Home", "In Home" );
        killToasts();
        dispatchKeyEvent(new KeyEvent( KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_BACK ));
        finish();
        return true;
    }
    return super.onOptionsItemSelected( item );
} 
```

当我点击图标时，什么也没有发生。我的代码中的`Log`调用也从未显示过`LogCat`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:00:45.393

您可能没有使 ABS 活动徽标可点击。添加这个`onCreate()`

```
getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

此外，如果您还没有这样做，请阅读[**实现祖先导航**](http://developer.android.com/training/implementing-navigation/ancestral.html)，以便您*正确*导航（忽略他们对 的使用`getActionBar()`，他们没有使用 ABS，这是实际的 Android API 操作栏方法）。

# android - 我怎样才能有一个启动活动的可选行和一个同时触发上下文菜单的复选框

> ID：14488230
> 
> 赞同：2
> 
> 时间：2013-01-23T19:55:43.957
> 
> 标签：android, android-layout, android-listview

在我的应用程序中，我有一个带有适配器的海关 Listview。在我的列表视图中，我添加了一个带有*focusable=false*的复选框，以确保 listItem 仍然是可聚焦的。在*OnCheckedChangeListener*上，我调用*list.setItemChecked*以确保它触发上下文菜单。When a row is selected (not with the checkbox) it's starting an activity. （编辑行内容）

在我的活动中，我有这些行以在选择项目时启动上下文菜单（使用复选框）

```
transactionList.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);
transactionList.setMultiChoiceModeListener(multiChoiceMode); 
```

**问题是**由于 CHOICE_MODE_MULTIPLE_MODAL 当显示上下文菜单时我无法再次单击行。当我单击行时，它只选择或取消选择行。

我正在考虑使用 CHOICE_MODE_MULTIPLE 而不是 CHOICE_MODE_MULTIPLE_MODAL 并自己开始操作，但我不知道是否有更好的方法来做我想做的事情。

事实上，我想要的和 Gmail 应用程序完全一样。您可以选择行以进行自定义操作（删除、共享等），但您仍然可以单击一行来查看电子邮件。（即使弹出上下文菜单）

提前致谢 ！

附言。英语不是我的第一语言，但我很确定你能理解我在说什么。（所以提前抱歉英语错误）

**编辑**添加了一些代码，但我只想了解最好的做法。我知道这段代码使用了一半的旧方法，当上下文菜单打开时你无法单击一行，我做了一半的重构来手动触发操作栏 [http://pastebin.com/Tig0qYcN](http://pastebin.com/Tig0qYcN)

顺便说一句，我的代码在github上

适配器：[https ://github.com/Dalto/PersonalBankManager/blob/master/PersonalBankManager/src/org/madduck/personalbankmanager/model/adapter/TransactionAdapter.java](https://github.com/Dalto/PersonalBankManager/blob/master/PersonalBankManager/src/org/madduck/personalbankmanager/model/adapter/TransactionAdapter.java)

活动：https://github[DOT]com/Dalto/PersonalBankManager/blob/master/PersonalBankManager/src/org/madduck/personalbankmanager/AccountFragment.java

请注意，我的 github 代码可能会更改，并且可能与问题无关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T04:46:20.793

我自己修好了。我不知道这是否可行，但它正在工作。

我在用着

```
transactionList.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); 
```

代替

```
transactionList.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL); 
```

并在选中复选框时添加此代码

```
 if (transactionAdapter.countSelected() > 0) {
        if (actionMode == null) {
            actionMode = getActivity().startActionMode(multiChoiceMode);
        }

        NumberFormat amountFormat = NumberFormat.getCurrencyInstance();
        actionMode.setTitle(amountFormat.format(transactionAdapter.getTotalAmountSelected()));
    } else if (transactionAdapter.countSelected() == 0 && actionMode != null) {
        actionMode.finish();
    } 
```

如果您更喜欢这里我在 github 上所做的提交：[https ://github.com/Dalto/PersonalBankManager/commit/b6f46f7261ae2eef1f7b6fb2d2258a0da1779211](https://github.com/Dalto/PersonalBankManager/commit/b6f46f7261ae2eef1f7b6fb2d2258a0da1779211)

如果有人找到更好的方法（我的意思是使用 Android API 的更清洁的方法），然后发布它，它可能会对其他人有所帮助。

# html - Jquery-mobile：上一页的标题仍然存在

> ID：14488234
> 
> 赞同：0
> 
> 时间：2013-01-23T19:55:54.530
> 
> 标签：html, jquery-mobile, web2py

我正在使用**Web2py**并使用“ **PLUGIN_JQMOBILE/LAYOUT.HTML** ”作为基本布局文件。

问题是当我单击一个链接时，jquery-mobile 会将我带到下一页——这里一切正常。

`When I view the source for the page, I see that it still has <title> from the older page.`

我发现了这个问题，因为我正在使用 lockerz(addToAny.com) 并且当用户尝试在 Facebook 上共享页面时，标题完全不正确。

我使用了[FB 开发人员调试](https://developers.facebook.com/tools/debug)页面并看到了显示的标题。

我可以添加 og:title 等，但这个问题也困扰着我的 Google+。

我是在做不正确的事情还是 jquery-mobile 的副作用..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T17:53:16.697

这是因为在 jQuery Mobile 中默认加载 Ajax。您可以通过在链接中使用 data-ajax="false" 或使用 jQuery 脚本在加载后更改页面标题来避免此问题。

# git - 为什么 git diff 会根据提交修订产生不同的结果？

> ID：14488235
> 
> 赞同：3
> 
> 时间：2013-01-23T19:56:03.907
> 
> 标签：git

我是版本控制领域的新手，刚刚开始使用 git。运行命令时有以下输出`git log`

```
commit 3b33318e20a64f4395bba416fe60f50f9e0002d1
Author: pm
Date:   Thu Jan 24 08:42:24 2013 +1300

    added fourth line to test1

commit 37f2ce409cdc971958add1fcf6585064f5c0d61d
Author: pm
Date:   Thu Jan 24 08:41:24 2013 +1300

    first commit 
```

我了解`git log`显示最新提交后跟上一次提交。现在，如果我运行`git diff HEAD HEAD~`我理解为*"Show me the difference between the latest commit and the previous commit"*的命令，我会得到以下输出：

```
diff --git a/test1 b/test1
index c6f02c2..e41a5e4 100644
--- a/test1
+++ b/test1
@@ -1,4 +1,3 @@
 This is a test document
 This is the second line in the document
 And the third
-Added a fourth line 
```

它显示了减号，当我修改文件*test1*时，我在其中添加了一个新行，但是如果我运行`git diff HEAD~ HEAD`我理解为*“显示第二个最后提交和最新提交之间的区别”*的命令，它会显示以下内容输出：

```
diff --git a/test1 b/test1
index e41a5e4..c6f02c2 100644
--- a/test1
+++ b/test1
@@ -1,3 +1,4 @@
 This is a test document
 This is the second line in the document
 And the third
+Added a fourth line 
```

它表明我添加了带有加号的第四行。

如何比较文件是否重要？我原以为你比较文件的方式是*“比较最新的和以前的”，*即`git diff HEAD HEAD~`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:11:15.343

`git diff A B`列出从 A 到 B 所需的更改。如果交换参数，则会得到相反的更改，如您的示例所示。

你可以争辩说 Git 可以知道 A 发生在 B 之前，然后为`git diff A B`and产生相同的输出`git diff B A`。但是，恕我直言，这不是一个好主意，原因有两个：

1.  显示从左到右的变化更加一致。它也可以派上用场，特别是如果您在它之上构建脚本。

2.  有时不清楚哪个提交在另一个之前，例如：

    ```
     C
     / \
    A   B 
    ```

    `git diff A B`: A 在 B 之前还是 B 在 A 之前？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:59:07.703

将引用传递给 git diff 时，顺序确实很重要。要查看过去与未来的差异，您需要：

```
git diff HEAD~ HEAD 
```

Git 不会为您做任何猜测。

# python - 如何在任何维基百科文章的 div(id="BodyContent") 中抓取文本。我正在使用 Python 的 BeautifulSoup 和 nltk

> ID：14488236
> 
> 赞同：0
> 
> 时间：2013-01-23T19:56:08.710
> 
> 标签：python, beautifulsoup, nltk, wikipedia

```
page=nltk.clean_html(soup.findAll('div',id="bodyContent")) 
```

当我尝试运行此代码时，它显示：

```
Traceback (most recent call last):
  File "C:\Python27\wiki3.py", line 36, in <module>
    page=nltk.clean_html(soup.findAll('div',id="bodyContent"))
  File "C:\Python27\lib\site-packages\nltk-2.0.4-py2.7.egg\nltk\util.py", line 340, in clean_html
    cleaned = re.sub(r"(?is)<(script|style).*?>.*?(</\1>)", "", html.strip())
AttributeError: 'ResultSet' object has no attribute 'strip' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:57:46.200

您正在提供`clean_html`一个可迭代的`BeautifulSoup`对象（这是`findAll`返回的），而不是一个字符串（这是`clean_html`想要的）。

假设您想要一个`div`已清理的字符串列表，请执行以下操作：

```
page = [nltk.clean_html(str(d)) for d in soup.findAll('div',id="bodyContent")] 
```

或者

```
page = map(nltk.clean_html, soup.findAll('div',id="bodyContent")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T18:59:17.727

导入 urllib 从 BeautifulSoup 导入 urllib2 导入 BeautifulSoup 导入 nltk 导入重新导入编解码器

文章=“马拉松帝国”文章= urllib.quote（文章）

opener = urllib2.build_opener() opener.addheaders = [('User-agent', 'Mozilla/5.0')] #wikipedia 需要这个

资源 = opener.open("http://en.wikipedia.org/wiki/" + 文章) 数据 = resource.read()

汤 = BeautifulSoup（数据）

对于 soup.findAll('div',id="bodyContent") 中的节点：page = ''.join(node.findAll(text=True))

f=codecs.open("wikiscrap2","w","utf-8-sig") f.write(page); .............至少使用此代码，我可以使用 bodyContent 标记检索维基百科页面的内容

# python - 如何检查字典项的子集是否存在于另一个字典列表中？

> ID：14488245
> 
> 赞同：0
> 
> 时间：2013-01-23T19:56:41.777
> 
> 标签：python, conditional

我有一个包含以下信息的字典列表（称为“primer names”）：

```
{'part number': 1, 'notes': 'Fw Gibson primer on pEM113 to extract CmR resistance and pSC101 backbone and T7 promoter and term.', 'direction': 'fw primer', 'construct': '24', 'source': 'pEM113'}
{'part number': 1, 'notes': 'Re Gibson primer on pEM113 to extract CmR resistance and pSC101 backbone and T7 promoter and term.', 'direction': 're primer', 'construct': '24', 'source': 'pEM113'}
{'part number': 2, 'notes': 'Fw Gibson primer on BBa_K274100 to extract crtEBI operon', 'direction': 'fw primer', 'construct': '24', 'source': 'BBa_K274100'}
{'part number': 2, 'notes': 'Re Gibson primer on BBa_K274100 to extract crtEBI operon', 'direction': 're primer', 'construct': '24', 'source': 'BBa_K274100'}
{'part number': 1, 'notes': 'Fw Gibson primer on pEM114 to extract CmR resistance and pSC101 backbone and K1F promoter and term.', 'direction': 'fw primer', 'construct': '25', 'source': 'pEM114'}
{'part number': 1, 'notes': 'Re Gibson primer on pEM114 to extract CmR resistance and pSC101 backbone and K1F promoter and term.', 'direction': 're primer', 'construct': '25', 'source': 'pEM114'} 
```

我有另一个包含以下信息的字典列表（称为“引物序列”）：

```
{'Part Number': '1', 'Construct Number': '24', 'Direction': 're primer', 'Primer Sequence': 'agaccgtcatctagtacctcTCTCCCTATAGTGAGTCGTATTACTCTAGAAGCGGCCGCg'}
{'Part Number': '1', 'Construct Number': '24', 'Direction': 'fw primer', 'Primer Sequence': 'tggaggatctgatataataaTAGCATAACCCCTTGGGGCCTCTAAACGGGTCTTGAGGGG'}
{'Part Number': '2', 'Construct Number': '24', 'Direction': 'fw primer', 'Primer Sequence': 'TACGACTCACTATAGGGAGAgaggtactagatgacggtctgcgcaaaaaaacacgttcat'}
{'Part Number': '2', 'Construct Number': '24', 'Direction': 're primer', 'Primer Sequence': 'GGCCCCAAGGGGTTATGCTAttattatatcagatcctccagcatcaaacctgctgtcgct'}
{'Part Number': '1', 'Construct Number': '25', 'Direction': 're primer', 'Primer Sequence': 'agaccgtcatctagtacctcTCTCCCTATAGTGATAGTTATTACTCTAGAAGCGGCCGCg'}
{'Part Number': '1', 'Construct Number': '25', 'Direction': 'fw primer', 'Primer Sequence': 'tggaggatctgatataataaTAGCATAACCCCTTGGGGCCTCTAAACGGGTCTTGAGGGG'}
{'Part Number': '2', 'Construct Number': '25', 'Direction': 'fw primer', 'Primer Sequence': 'TAACTATCACTATAGGGAGAgaggtactagatgacggtctgcgcaaaaaaacacgttcat'}
{'Part Number': '2', 'Construct Number': '25', 'Direction': 're primer', 'Primer Sequence': 'GGCCCCAAGGGGTTATGCTAttattatatcagatcctccagcatcaaacctgctgtcgct'} 
```

我的目标是结合两者中包含的信息，这样我得到一个输出，其中包含底部列表中每个引物（fw 或 re）的部件号、构造编号、方向、引物序列、注释、构造和来源。为了将“引物名称”与“引物序列”匹配，我必须检查以确保它们的“部件号”、“结构号”和“方向”都相同。

我尝试了以下代码来检查这一点，但它似乎不起作用：

```
for row in primers_names_list: #recall that primers_names_list is a list of dictionaries
    if any({x['Part Number'], x['Construct Number'], x['Direction']} == {row['part number'], row['construct number'], row['direction']} for x in primers_without_names):
        primers_with_names.append({'part number':row['part number'], 'construct number':row['construct number'], 'notes':row['notes'], 'primer sequence':x['Primer Sequence']}) 
```

任何人都可以提供关于我如何做到这一点的提示吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:24:28.973

两个问题：

1.  `part number`是*引物名称*`int`中的一个和*引物序列*中的一个。为了比较产量，您必须将 the 转换为 a （使用*str(val)*）或转换为 int （使用*int(val)*）*`str`*`True``int``str`*`str`***

****   您在循环中使用的键名会引发`KeyError`异常，因为它们不正确（注意*引物序列*有`Construct Number`并且*引物名称*有`construct`）*** 

 **这是一个工作代码示例：

```
primers_names_list = [
{'part number': 1, 'notes': 'Fw Gibson primer on pEM113 to extract CmR resistance and pSC101 backbone and T7 promoter and term.', 'direction': 'fw primer', 'construct': '24', 'source': 'pEM113'},
{'part number': 1, 'notes': 'Re Gibson primer on pEM113 to extract CmR resistance and pSC101 backbone and T7 promoter and term.', 'direction': 're primer', 'construct': '24', 'source': 'pEM113'},
{'part number': 2, 'notes': 'Fw Gibson primer on BBa_K274100 to extract crtEBI operon', 'direction': 'fw primer', 'construct': '24', 'source': 'BBa_K274100'},
{'part number': 2, 'notes': 'Re Gibson primer on BBa_K274100 to extract crtEBI operon', 'direction': 're primer', 'construct': '24', 'source': 'BBa_K274100'},
{'part number': 1, 'notes': 'Fw Gibson primer on pEM114 to extract CmR resistance and pSC101 backbone and K1F promoter and term.', 'direction': 'fw primer', 'construct': '25', 'source': 'pEM114'},
{'part number': 1, 'notes': 'Re Gibson primer on pEM114 to extract CmR resistance and pSC101 backbone and K1F promoter and term.', 'direction': 're primer', 'construct': '25', 'source': 'pEM114'},
]

primers_without_names = [
{'Part Number': '1', 'Construct Number': '24', 'Direction': 're primer', 'Primer Sequence': 'agaccgtcatctagtacctcTCTCCCTATAGTGAGTCGTATTACTCTAGAAGCGGCCGCg'},
{'Part Number': '1', 'Construct Number': '24', 'Direction': 'fw primer', 'Primer Sequence': 'tggaggatctgatataataaTAGCATAACCCCTTGGGGCCTCTAAACGGGTCTTGAGGGG'},
{'Part Number': '2', 'Construct Number': '24', 'Direction': 'fw primer', 'Primer Sequence': 'TACGACTCACTATAGGGAGAgaggtactagatgacggtctgcgcaaaaaaacacgttcat'},
{'Part Number': '2', 'Construct Number': '24', 'Direction': 're primer', 'Primer Sequence': 'GGCCCCAAGGGGTTATGCTAttattatatcagatcctccagcatcaaacctgctgtcgct'},
{'Part Number': '1', 'Construct Number': '25', 'Direction': 're primer', 'Primer Sequence': 'agaccgtcatctagtacctcTCTCCCTATAGTGATAGTTATTACTCTAGAAGCGGCCGCg'},
{'Part Number': '1', 'Construct Number': '25', 'Direction': 'fw primer', 'Primer Sequence': 'tggaggatctgatataataaTAGCATAACCCCTTGGGGCCTCTAAACGGGTCTTGAGGGG'},
{'Part Number': '2', 'Construct Number': '25', 'Direction': 'fw primer', 'Primer Sequence': 'TAACTATCACTATAGGGAGAgaggtactagatgacggtctgcgcaaaaaaacacgttcat'},
{'Part Number': '2', 'Construct Number': '25', 'Direction': 're primer', 'Primer Sequence': 'GGCCCCAAGGGGTTATGCTAttattatatcagatcctccagcatcaaacctgctgtcgct'},
]

primers_with_names = []
for row in primers_names_list: #recall that primers_names_list is a list of dictionaries
    for x in primers_without_names:
        if (
            int(x['Part Number']) == row['part number'] and
            x['Construct Number'] == row['construct'] and
            x['Direction'] == row['direction']
        ):
            primers_with_names.append(
                {
                    'part number': row['part number'], 
                    'construct number': row['construct'], 
                    'notes': row['notes'], 
                    'primer sequence':x['Primer Sequence']
                }
            )
            # If you are only expecting one match from the primers_without_names
            # collection, or wish to enforce that, you can add a break statement after
            # the insertion here to break out of the inner comparison loop and move on
            # to the next row item

for p in primers_with_names:
    print p

print
print len(primers_with_names) 
```

**编辑：**另一个选项，如果每个集合中的每一行的比较值都是唯一的，并且如果您有足够的内存并且不介意预处理列表，则将两个集合转换为字典，键入*(part number , 构造数, 方向)*元组。这将以后的查找工作减少到每行摊销 O(1)。总的来说，你会得到 O(3N) 而不是 O(N^2)，这对于大型集合来说非常好。

```
# convert both lists to dictionaries
primers_names_dict = { 
    (str(p['part number']), str(p['construct']), str(p['direction'])): p
    for p in primers_names_list 
}
primers_sequence_dict = {
    (str(p['Part Number']), str(p['Construct Number']), str(p['Direction'])): p
    for p in primers_without_names
}

# now that we have two dicts, we can do a key<->key match between them, so each
# comparison op is just a dictionary key lookup, which is O(1) on average
matches = []
for key in primers_names_dict.keys():
    if key in primers_sequence_dict: # amortized O(1) lookup
        matches.append( {
            'part number': primers_names_dict[key]['part number'], 
            'construct number': primers_names_dict[key]['construct'], 
            'notes': primers_names_dict[key]['notes'], 
            'primer sequence': primers_sequence_dict[key]['Primer Sequence']
        } )

for m in matches:
    print m
print len(matches) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:25:30.003

我在这里看到两个问题。

1.  一个字典中的 Part Number 是一个整数，另一个字典中的 Part Number 是一个字符串。

2.  你把`row['construct number']`我认为应该在的地方`row['construct']`

这里是固定的：

```
for row in primers_names_list: #recall that primers_names_list is a list of dictionaries
    for x in primers_without_names:
        if {x['Part Number'], x['Construct Number'], x['Direction']} == {str(row['part number']), row['construct'], row['direction']}:
            primers_with_names.append({'part number':row['part number'], 'construct number':row['construct'], 'notes':row['notes'], 'primer sequence':x['Primer Sequence']}) 
```**

# jquery - jquery根据选择的类更改列表顺序

> ID：14488246
> 
> 赞同：0
> 
> 时间：2013-01-23T19:56:45.717
> 
> 标签：jquery, list, tabs

我有一组选项卡，选择列表垂直堆叠，所选项目具有“已选择”类。

我需要该项目是列表中的最后一项，因此它也可以充当标签的标题。

所以它看起来像这样；

```
<ul class= 'tabSelect'>
 <li>item 1</li>
 <li>item 3</li>
 <li>item 4</li>
 <li class="selected">item 2</li>
</ul>
<div id="tab1" style="display:none">
<div id="tab2">
 item 2 content....
</div> 
```

ETC

我如何在 jquery 中做到这一点

该页面是[www.businessexcellencebristol.co.uk/category/members](http://www.businessexcellencebristol.co.uk/category/members)

哦，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:04:21.957

如果您需要重新排列项目，您只需从列表中删除该项目，然后将其附加回列表。

```
var $selected = $('.selected');
var $parent = $selected.parent();
$selected.remove();
$selected.appendTo($parent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:05:23.750

这在 jQuery 中实际上非常简单。代码看起来像这样：

```
$('#move').click(function() {
    $('.tabSelect .selected').appendTo('.tabSelect');
}); 
```

该代码被放置在一个点击处理程序中，以便于触发它，但您也可以在加载或任何您想要的事件时执行此操作。您可以在此处查看实际代码：http: [//jsfiddle.net/qK9XL/](http://jsfiddle.net/qK9XL/)

当您将项目附加到其父项时，这实际上会将其移动到子项列表的底部。Prepend 会做同样的事情，但将它移到顶部。请注意，这仅在将项目附加到其父项时有效。如果您要将它附加到不同的元素，它将被复制到那里并作为最后一个子元素添加，而不是移动它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:26:14.187

我会这样做：

**风格**

```
<style type="text/css">
    .tabContent { display: none }
</style> 
```

**重新排列 html，使其显示类似**

```
<ul class='tabSelect'>
    <li id='title-1'>item 1</li>
    <li id='title-2' class="selected">item 2</li>
    <li id='title-3'>item 3</li>
    <li id='title-4'>item 4</li>
</ul>
<div id="tab-1" class="tabContent">
    Item 1 content
</div>
<div id="tab-2" class="tabContent">
    Item 2 content
</div> 
```

**和 Javascript**

```
$(document).ready( function() { // Or maybe within a select change $('#contentSelect').change();
    showSelected();
});

function showSelected() {
    // Puts the title li last
    var $ul = $('ul .selected');
    $('ul').append($ul);
    // Makes the corresponding content visible
    $('.tabContent).hide();
    $('#tab-' + $ul.prop('id').split('-')[1].show();
} 
```

# mysql - 将扑克牌的事件存储在数据库中

> ID：14488249
> 
> 赞同：1
> 
> 时间：2013-01-23T19:57:04.670
> 
> 标签：mysql, sql

我正在尝试用 C++ 编写一个分析扑克手的程序。我希望你使用 SQL 来存储有关手牌、玩家和会话的数据。

我对我想在我的会话和玩家表中存储什么有一个很好的想法，但是手表有点棘手。

单手牌需要包含所有玩家的姓名、他们的手牌（如果显示）、他们的筹码、日期、赌注等。问题在于保存事件。单手 6 人手可以像 fold-fold-fold-fold-raise,4$-fold 一样简单，但它可能会更长。

我能想到的唯一方法是创建一个名为“Events”的列并将操作存储为字符串“FFFFR,4-F”。

我必须有更好，更优雅的方式来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:18:48.760

*将一系列*事件存储在一行中违反了第一范式，并且被认为是不好的做法。

因此，与其将整个事件序列存储在单行中，不如将一系列行存储在另一个表中（John Bustos 建议使用“bets”，但您建议的列名称“Events”可能是一个很好的表名称：好）与之相关联。每个事件都将包含它所属的手牌的标识符，用于对事件进行排序的序列号。这两列将构成该表的主键。然后，您可以有一个列来存储事件的类型（`ENUM`可能对此有用）以及对于某些事件的附加数据，例如金额。

要列出查询中的所有事件，您可以生成多行，每个事件一个。或者您有一个子查询，它将所有这些行转换为文本，然后您可以使用`GROUP_CONCAT`.

# python - igraph 以 Ncol() 格式导入 edgelist 后填充节点属性？

> ID：14488259
> 
> 赞同：0
> 
> 时间：2013-01-23T19:57:35.243
> 
> 标签：python, social-networking, igraph, sna

我不确定这是合并还是两个单独的导入，或者我应该完全重新考虑。我最初是在玩 gephi 之后开始使用 igraph，在那里我总是会进行两阶段导入，首先是边缘，然后是节点数据。这是 igraph 的明智策略吗？

所以，[感谢最近的一些帮助](https://stackoverflow.com/questions/14471473/format-for-importing-edgelist-into-igraph-in-python/14478156#14478156)，我刚刚导入了一个看起来像这样的边缘列表：

```
123123 321321 1
222222 333333 2
123123 333333 3
222222 321321 4 
```

...使用导入命令

```
import igraph
g = igraph.Graph.Read_Ncol('edgelist.txt') 
```

我想向这个 edgelist 导入为我生成的节点添加属性。这些将类似于...

```
123123 "color:red" "community:1"
222222 "color:blue" "community:2"
321321 "color:red" "community:1"
333333 "color:red" "community:2" 
```

如何将此数据附加到当前图表？我看到许多用于导入复杂边缘列表的格式，但没有用于节点列表的格式。我错过了什么？是否没有自动将节点数据附加到适当节点的功能？

如果没有，有人可以推荐一种更简单的方法来将节点数据适当地填充到现有图表中吗？

我的直觉是……

```
[g.vs["color"] = x for x in node_list.color if g.vs["name"] == node_list.name]
[g.vs["community"] = x for x in node_list.community if g.vs["name"] == node_list.name] 
```

但这看起来非常笨拙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T20:56:38.850

好吧，你走在正确的轨道上，是的，它会有点笨拙。它很笨拙，因为 igraph 在其核心深处是一个普通的 C 库，并且在 C 中使用数字（即顶点和边 ID）而不是名称（即顶点和边名称）要容易得多。这就是为什么 igraph 使用从零开始的整数来指代顶点和边而不是它们的名称，这就是为什么你必须跳过一个额外的环才能从它的名称到达顶点本身。

我可能会做以下事情：

1.  使用 读取边缘列表`Graph.Read_Ncol`。（你已经这样做了）。
2.  构建一个将顶点名称映射回其 ID 的字典：

    ```
    >>> id_mapping = dict((v, k) for k, v in g.vs["name"]) 
    ```

3.  将您的属性文件读入`node_list`. 我假设这`node_list.name`给了我一个顶点名称列表，并`node_list.color`给了我一个包含相应颜色的列表。然后，您可以执行以下操作：

    ```
    >>> for name, color in izip(node_list.name, node_list.color):
    ...     g.vs[id_mapping[name]]["color"] = color 
    ```

第三步中的另一种方法是使用`g.vs.find(name)`，它为您提供一个`Vertex`对象，该对象引用具有给定名称的顶点。然后，您可以将属性分配给该顶点；例如：

```
>>> for name, color in izip(node_list.name, node_list.color):
...     g.vs.find(name)["color"] = color 
```

在这种情况下，您不需要`id_mapping`. 实际上，igraph 在后台*只*`name`为顶点属性维护了一个名称到 ID 的映射，并利用了这个映射。如果您想使用不同的顶点属性作为顶点的唯一键而不是 ，则基于 - 的方法更有用。*`g.vs.find``id_mapping``name`*

# jquery - 带有屏蔽输入 onchange 的 jQuery 日期选择器

> ID：14488260
> 
> 赞同：2
> 
> 时间：2013-01-23T19:57:40.923
> 
> 标签：jquery, html, datepicker, onchange, mask

我在 html 文档中有一系列日期输入文本字段。当值改变时，我想触发 onchange 事件来做一些事情。

我已经为这些日期字段设置了日期选择器，以使用户更容易选择日期。

我还在这些字段上设置了掩码，`.mask('99/99/99?99')`以便他们看到所需的格式，因此他们不必输入斜杠。

当我在字段上同时实现日期选择器和掩码并单击它们然后单击退出时，即使我没有更改该字段中的任何内容，也会触发 onchange 事件。如果我删除掩码，除非字段更改，否则日期选择器不会触发 onchange 工作。如果我删除日期选择器并将掩码留在字段上并单击进出，除非我更改了字段，否则不会触发 onchange。只有当我将掩码和日期选择器结合起来时，当我点击进出时，onchange 才会触发。

有没有一种方法可以在不使用字段上的单独 mask() 调用的情况下屏蔽 datepicker 中的输入？日期选择器中有没有办法确定该字段是否实际更改？

这是一个尝试自己的示例。

```
<!doctype html>

<html lang="en">
<head>
    <script type="text/javascript">
        function loadPage(){
            $('input.datepicker').datepicker().mask('99/99/99?99');
        }
    </script>
</head>

<body onload="loadPage();">
    Try it: <input type="text" onchange="alert('changed, do some stuff');" class="datepicker" />
</body>
</html> 
```

# visual-studio-2010 - Visual Studio 2010 说它构建了 DLL 但没有

> ID：14488264
> 
> 赞同：1
> 
> 时间：2013-01-23T19:57:51.287
> 
> 标签：visual-studio-2010, dll

我正在尝试为最新的 SQLite3 版本构建一个 .DLL 和一个 .lib。我在 Visual Studio 2010 中创建了一个新项目，选择了 Visual C++ / Win 32 / Win 32 Project，并选择了 DLL 选项。（虽然它选择了“.NET Framework 4”作为弹出菜单。这是一个问题吗？我不想要求 .NET 框架。）

当我构建项目时，它似乎工作：

```
1>------ Build started: Project: SQLite3, Configuration: Release Win32 ------
1>  shell.c
1>  sqlite3.c
1>  Generating code
1>  Finished generating code
1>  SQLite3.vcxproj -> c:\users\jensenv\documents\visual studio 2010\Projects\SQLite3\Release\SQLite3.dll 
```

但是该目录中没有 SQLite3.dll。日志文件很多，加上shell.obj、sqlite3.obj、SQLite3.og、vc100.pdb。为什么它说它创建了一个 .dll 却没有呢？

我还需要做些什么来让它创建一个匹配的 .lib （导出符号）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:06:55.893

你确定你正在寻找：

> c:\users\jensenv\documents\visual studio 2010\Projects\SQLite3\Release

而不是：

> c:\users\jensenv\documents\visual studio 2010\Projects\SQLite3\SQLite3\Release

第一个包含最终的 DLL/EXE，而第二个包含中间文件，如 .obj 文件。

# php - PHP - 使用正则表达式根据值更改数组键

> ID：14488266
> 
> 赞同：0
> 
> 时间：2013-01-23T19:57:51.733
> 
> 标签：php, regex, preg-replace

我刚刚开始学习正则表达式，我认为这可以使用正则表达式来完成，但无法找到合适的正则表达式匹配。情况如下：我想用各自的值填充数组中的键，但将所有内容都设为小写并下划线表示空格。

示例 PHP 数组：

```
array('' => 'Red Apple',
      '' => 'Blue Sky',
      '' => 'Circle/Earth'); 
```

输出应该是：

```
array('red_apple' => 'Red Apple',
      'blue_sky' => 'Blue Sky',
      'circle_earth' => 'Circle/Earth'); 
```

我能够使用 strtolower()，但无法使用 preg_replace()。我什至可以用正则表达式做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:01:03.350

正如 slier 所说，它可以在没有 preg_replace 的情况下完成

这是一个片段

`$new_key = strtolower(str_replace(array(' ', '/'), '_', $value)));`

查看[http://php.net/str_replace](http://php.net/str_replace) 快速介绍

str_replace（查找，替换，值）；

find 可以是包含常见不需要的字符的数组，例如 array('-', '/', ' ', .. etc);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:08:29.003

您可以使用[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)and[`strtolower()`](http://ca3.php.net/manual/en/function.strtolower.php)来实现这一点：

```
$key = strtolower(preg_replace(array('/[^a-z]+/i', '/\s/'), "_", $string)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:06:01.717

[确认工作](http://codepad.viper-7.com/XLE51N)：

```
$array = array(
    'Red Apple',
    'Blue Sky',
    'Circle/Earth'
);

function nice_keys($key) {
    return strtolower(str_replace(array(' ', '/'), '_', $key));
}

$clean_keys = array_map('nice_keys', $array);
$new_array = array_combine($clean_keys, $array);

print_r($new_array); 
```

**参考**：

*   [`str_replace()`](http://php.net/manual/en/function.str-replace.php)
*   [`array_map()`](http://php.net/manual/en/function.array-map.php)
*   [`array_combine()`](http://php.net/manual/en/function.array-combine.php)

# php - 发送电子邮件后删除附件文件

> ID：14488267
> 
> 赞同：0
> 
> 时间：2013-01-23T19:57:52.200
> 
> 标签：php, file, codeigniter, unlink

在一个较大的项目中，有一个上传 2 个文件的表单。我使用 codeigniter 作为框架。表单上传后，它应该将这两个文件作为电子邮件发送。

为了将其附加到电子邮件中，我们应该拥有该文件的本地副本。因此，我将文件移动到一个临时文件夹并使用 [session-id]_my_file_1 和 [session-id]_my_file_2 的命名约定

最后在发出电子邮件后，我尝试删除这些临时文件。但`unlink`不是删除这些文件。我不知道这是什么原因。

我的猜测是：邮件命令可能仍在使用它来上传/发送。下面是我写的代码大纲。

```
 $config['upload_path']      = './tmp_holder/';
        $config['allowed_types']    = 'doc|docx|pdf|rtf';
        $config['max_size']         = '10240';
        $config['file_name']        = $this->session->userdata('session_id').'_1';
        $config['overwrite']        = TRUE;

        $config2['upload_path']     = './tmp_holder/';
        $config2['allowed_types']   = 'doc|docx|pdf|rtf';
        $config2['max_size']        = '10240';
        $config2['file_name']       = $this->session->userdata('session_id').'_2';
        $config2['overwrite']       = TRUE;

        $this->load->library('upload',$config);

        if ($this->form_validation->run() == FALSE)
        {
            $this->load->view('init_app_form');
        }
        else
        {

            if($this->upload->do_upload('cvFile') === FALSE) {
                $this->load->view('init_app_form');
            }
            else {
                $file1Return = $this->upload->data();

                $this->upload->initialize($config2);
                if($this->upload->do_upload('researchFile') === FALSE) {
                    $this->load->view('init_app_form');
                }
                else {
                    //process data here
                    $file2Return = $this->upload->data();

                    $this->config->load('email');

                    $this->email->initialize($this->config->item('email_conf'));

                    $this->email->from($this->config->item('email_from'), $this->input->post('tname').' '.$this->input->post('fname').' '.$this->input->post('lname'));
                    $this->email->to($this->config->item('email_to'));

                    $this->email->subject('something');
                    $this->email->message('something'); 

                    $this->email->attach($file1Return['full_path']);
                    $this->email->attach($file2Return['full_path']);

                    if( $this->email->send() == false ) {
                        //error
                        echo $this->email->print_debugger(); exit;
                    }

                    $this->email->clear();
                                    ////////////////////////////////
                    @unlink($this->session->userdata('session_id').'_2');
                                    ////////////////////////////////
                    $this->load->view('init_app_success');
                }
                                   ////////////////////////////////
                @unlink($this->session->userdata('session_id').'_1');
                                   ////////////////////////////////
            }

        } 
```

我所做的解决方案是在执行此操作之前删除临时文件夹中的文件，以便清除以前的文件。但这不是一个干净的方法吗？这是因为：

1.  它可能正在尝试删除其他并行实例当前正在使用的其他文件
2.  我希望 tmp 文件夹在我发送后为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:09:35.087

最好使用代码点火器中的 file_helper。

```
$this->load->helper("file");
delete_files($this->session->userdata('session_id').'_1'); 
```

[这](http://ellislab.com/codeigniter/user-guide/helpers/file_helper.html)是有关此的文档

# c - 在汇编中声明一个字符串

> ID：14488269
> 
> 赞同：1
> 
> 时间：2013-01-23T19:58:00.143
> 
> 标签：c, assembly, inline-assembly

我有这个计算一些素数的汇编代码：

```
#include <stdio.h>

int main() {
    char format[] = "%d\t";

    _asm{
        mov ebx, 1000
        mov ecx, 1
        jmp start_while1
incrementare1:
        add ecx, 1
start_while1:
        cmp ecx, ebx
        jge end_while1
        mov edi, 2
        mov esi, 0
        jmp start_while2
incrementare2:
        add edi, 1
start_while2:
        cmp edi, ecx
        jge end_while2
        mov eax, ecx
        xor edx, edx
        div edi
        test edx, edx
        jnz incrementare2
        mov esi, 1
end_while2:
        test esi, esi
        jnz incrementare1
        push ecx
        lea ecx, format
        push ecx
        call printf
        pop ecx
        pop ecx
        jmp incrementare1
end_while1:
        nop
    }
    return 0;
} 
```

它工作正常，但我还想在 asm 中声明“格式”字符串，而不是在 C 代码中。我试过添加类似的东西，`format db "%d\t", 0`但没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:17:52.880

如果一切都失败了，总会有丑陋的方式：

```
format_minus_1:
mov ecx,0x00096425  ; '%', 'd', '\t', '\0' in little-endian format
lea ecx,format_minus_1 + 1  ; skip past the "mov ecx" opcode
push ecx
call printf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:26:20.207

您不能`_asm`使用这些指令在块内定义对象。C 声明为您在堆栈上分配空间，因此如果您想在`_asm`块内执行类似的操作，您需要操作堆栈指针并自己初始化内存：

```
sub esp, 4
mov [esp], '%'
mov [esp + 1], 'd'
mov [esp + 2], '\t'
mov [esp + 3], '\0'
...
push ecx
push esp + 4
call printf 
```

请注意，这是一种方式。不一定是最好的方法。让 C 为您进行内存管理的最佳方式。

# python - Python + Pyglet Cocos2D: TypeError: 'class' object is not callable

> ID：14488271
> 
> 赞同：0
> 
> 时间：2013-01-23T19:58:03.703
> 
> 标签：python, python-2.7, cocos2d-python

我一直在研究平铺地图渲染器，并且尝试在另一个文件中创建一个单独的类。我收到此错误消息：

```
Type Error: 'renderer' object is not callable 
```

这是 render.py 文件：

```
import pyglet, json
from pyglet.window import key
from pyglet.gl import *
from ConfigParser import SafeConfigParser
from cocos.layer import *
from cocos.batch import *
from cocos.sprite import Sprite

class renderer( Layer ):
    def __init__(self, mapname):
        super( renderer, self ).__init__()
        parser = SafeConfigParser()
        try:
            world = parser.read('maps/'+mapname+'.txt')
            print world
        except IOError:
            print("No world file!")
            return
        layer = json.loads(parser.get('layer1', 'map'))
        tiletype = parser.get('type', 'tile')
        print tiletype
        tilesize = 64

        for x in range(0, len(layer)):
            for y in range(0, len(layer[x])):
                self.spr = Sprite("image/tiles/"+tiletype+"/"+str(layer[x][y])+".png")
                self.spr.position = ((x+1)*tilesize, (y+1)*tilesize)
                self.add(self.spr) 
```

这是我称之为的一段代码：

```
from other.render import renderer 
```

```
world = renderer('buildnew')
world() 
```

文件结构：

```
game/main.py
game/other/render.py 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:08:05.420

```
world = renderer('buildnew')
world() 
```

首先，您创建渲染器类的实例并将其存储到 world。但是然后你写`world()`，这是错误的，因为这个对象是不可调用的。如果要制作`world`可调用对象，则应[`__call__`](http://docs.python.org/2/reference/datamodel.html#object.__call__)在渲染器类中实现该方法。

# octave - 如何将零应用于过滤数据的不匹配索引

> ID：14488273
> 
> 赞同：0
> 
> 时间：2013-01-23T19:58:04.657
> 
> 标签：octave

我正在学习八度音阶，我进行了这样的比较：

```
ma = [1,2,3,4,5];
indices = ma > 3; 
```

条件过滤器“ma”，var 'indices' 打印匹配条件的索引，如下所示：

> [4, 5]

...但我想要的是使用该结果返回这样的数组：

> [0,0,0,4,5];

有这个功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:53:13.990

您可以执行以下操作：

```
ma = [1,2,3,4,5];
ma(ma <= 3) = 0 
```

基本上，只需反转条件并使用它将值设置为零。

# c# - XNA 2D 音效鼠标悬停

> ID：14488274
> 
> 赞同：0
> 
> 时间：2013-01-23T19:58:13.830
> 
> 标签：c#, xna

在这里开发游戏，到目前为止，我已经为我的游戏制作了一个菜单系统。我添加了三个不同的按钮。除了一件事，我把一切都整理好了。

所以，我使用了一个普通的 if intersects 方法来查看鼠标和按钮矩形是否碰撞以播放声音效果。但是，我不知道如何停止这种声音，它一直在循环，直到我将鼠标从按钮上移开。我想让它只播放一次。

```
public void Update(MouseState mouse, GraphicsDevice graphics, SoundEffect soundEffect)
{
    rectangle = new Rectangle((int)position.X, (int)position.Y, (int)size.X, (int)size.Y);

    Rectangle mouseRectangle = new Rectangle(mouse.X, mouse.Y, 1, 1);

    if(mouseRectangle.Intersects(rectangle))
    {
        if (mouse.LeftButton == ButtonState.Pressed) isClicked = true;
        size = new Vector2(graphics.Viewport.Width / 9, graphics.Viewport.Height / 13);
        soundEffect.Play();
    }

    else
    {
        size = new Vector2(graphics.Viewport.Width / 10, graphics.Viewport.Height / 14);
        isClicked = false;
    } 
```

任何帮助将不胜感激。

顺便说一句：这不是必需的，但是当我将鼠标悬停在按钮上时，我遇到了另一个“问题”，它们会变大，这是预期的。但它并没有从中心变大。这有点难以解释，但它在 x 和 y 位置变得更大，而不是 -x 和 -y。它具有相同的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:18:20.543

你将不得不使用一些状态字段或事件来做你想做的事。一些简单的事情可能是跟踪鼠标何时进入和离开矩形：

```
private bool _mouseIsIntersecting;

public void Update(...)
{
    rectangle = new Rectangle(...);

    Rectangle mouseRectangle = new Rectangle(...);

    if(mouseRectangle.Intersects(rectangle))
    {
        // Handle click and size stuff

        // Only play the sound if mouse was not previously intersecting
        if (!_mouseIsIntersecting)
            soundEffect.Play();
        _mouseIsIntersecting = true;
    }
    else
    {
        _mouseIsIntersecting = false;

        // Handle other stuff
    }
} 
```

# apache-flex - 是否可以从 Flex Air 中的 nativePath 获取服务器名称？

> ID：14488278
> 
> 赞同：1
> 
> 时间：2013-01-23T19:58:22.433
> 
> 标签：apache-flex, actionscript, flex4, filesystems

我在服务器的某个地方有一个文件的 nativePath，这个 nativePath 的值作为 flex 显示为

Z:\myFolder\myFile.ext

其中，**我知道**也相当于

[http://particularDomain.myCompany.com/myFolder/myFile.ext](http://particularDomain.myCompany.com/myFolder/myFile.ext)

（注意 - Z：映射到[http://particularDomain.myCompany.com/](http://particularDomain.myCompany.com/)，这在我的系统中是正确的，我的同事可以让它将同一服务器映射到 A：在他的系统中）

现在我的问题是 - 这种映射可以通过 Air 应用程序以任何方式实现吗？即，如果本机文件位于[http://particularDomain.myCompany.com/myFolder/myFile.ext](http://particularDomain.myCompany.com/myFolder/myFile.ext)中，它表示它位于该特定服务器中，而不管它映射到什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:03:45.137

不，这种映射无法通过 AIR 中提供的任何功能来实现。

您的 AIR 应用程序如何知道有一个根目录为“Z:\”的 Web 服务器？它不能，除非你告诉它。

现在，只要给它一些特定的参数，就可以自己创建这个功能。

如果您的应用程序知道 particluarDomain.myCompany.com 指向 Z:\，那么编写一些代码来映射两者应该很容易。您甚至可以封装域名和根目录，以便将来轻松更改它们。

理论上，您还可以解析 Apache Web 服务器的配置文件，以确定服务器根目录和目录位置。假设您的本地计算机可以访问两者。如果您将网络位置映射到本地驱动器；不过，这可能会使事情复杂化。

# jquery - 如何返回调用 jQuery AJAX 错误函数的错误消息和 HTTP 状态代码？

> ID：14488281
> 
> 赞同：4
> 
> 时间：2013-01-23T19:58:24.017
> 
> 标签：jquery, ajax, spring, exception, http-status-codes

使用 Spring，我有一个 SimpleMappingExceptionResolver，它可以在 resolveException 方法中捕获我的应用程序中的任何意外异常。在该方法中，我返回一个 ModelAndView，它将错误消息文本返回给 HTTP 客户端。这是代码：

```
public class UnExpectedExceptionResolver extends SimpleMappingExceptionResolver {

private Log logger = LogFactory.getLog(this.getClass().getName());
private ResourceBundleMessageSource messageSource;

@Override
public ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, Object handler, Exception exception) {

    // let the end user know that an error occurred
    Locale locale = RequestContextUtils.getLocale(request);
    String messageText = messageSource.getMessage("systemError", null, locale);
    Message message = new Message(messageText, MessageType.ERROR);
    ModelAndView mav = new ModelAndView();
    mav.setView(new MappingJacksonJsonView());
    mav.addObject("message", message);
    return mav;
} 
```

因此，响应返回的 HTTP 状态代码为 200，响应文本为消息 (JSON)。不幸的是，由于 200 代码，客户认为这是一个有效的响应，并尝试对其进行处理。我尝试将 HTTP 状态代码设置为 500，如下所示：

```
 response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Server Error"); 
```

就在之前

```
 return mav; 
```

陈述。不幸的是，这会返回一个指示内部错误的 HTML 页面，而不是我的 JSON 消息。如何返回 JSON 消息并仍然向客户端指示服务器错误（或某种类型的错误）？具体来说，我希望调用 AJAX 调用中客户端的错误函数，并且仍然将消息数据发送回客户端。仅供参考 - 我在客户端使用 jQuery。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-24T06:20:39.453

我不知道您究竟是如何向服务器发出请求的。但我会这样做。

```
@ExceptionHandler(Exception.class)
@ResponseStatus(value = HttpStatus.INTERNAL_SERVER_ERROR, reason = "your message")
public void handleException(IllegalStateException ex, HttpServletResponse response) throws IOException
{
} 
```

在客户端

```
$.ajax({
type : "POST",
url : urlString,
data : params,
dataType : 'json',
success : function(data) {
    //  do something}
error: function (xhr, ajaxOptions, thrownError) {
    alert(xhr.status); //This will be 500
    alert(xhr.responseText); // your message
    //do stuff
  } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-25T18:48:05.193

在 Spring 3.2 中，您可以将异常处理程序放在带`@ControllerAdvice`注释的类中。

从[Spring 3.2 文档开始](http://static.springsource.org/spring-framework/docs/3.2.0.M2/reference/html/new-in-3.2.html)

> 用注释的类`@ControllerAdvice`可以包含`@ExceptionHandler`、`@InitBinder`和`@ModelAttribute`方法，这些将应用于`@RequestMapping`跨控制器层次结构的方法，而不是在其中声明它们的控制器层次结构。`@ControllerAdvice`是一个组件注释，允许通过类路径扫描自动检测实现类。

因此，如果您的控制器是通过自动扫描 带`@Controller`注释的类来获取的，`@ControllerAdvice`那么它也应该可以工作（如果您`@Controller`使用显式的注释表达式扫描类，您可能需要单独注册此 bean）。

```
@ControllerAdvice
public class AppControllerAdvice{
        @ExceptionHandler(Throwable.class)
        ResponseEntity<String> customHandler(Exception ex) {
        return new ResponseEntity<String>(
                "Custom user message",
                HttpStatus.INTERNAL_SERVER_ERROR);

} 
```

请注意，文本是返回实体的一部分，而*不是*HTTP 原因短语。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-03T15:38:36.343

这是我的做法。

```
public class CustomExceptionResolver extends AbstractHandlerExceptionResolver {

    private static final Logger logger = Logger.getLogger(CustomExceptionResolver.class);

    protected ModelAndView doResolveException(HttpServletRequest request,
                                              HttpServletResponse response,
                                              Object handler,
                                              Exception ex) {
        try {
            response.reset();
            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
            response.setCharacterEncoding("UTF-8");
            response.setContentType("text/json");
            MappingJacksonJsonView view = new MappingJacksonJsonView();
            Map<String, String> asd = new HashMap<String, String>();
            asd.put("message", ex.getMessage());
            view.setAttributesMap(asd);
            return new ModelAndView(view);
        } catch (Exception e) {
            logger.error("send back error status and message : " + ex.getMessage(), e);
        }
        return null;
    } 
```

然后当然是在我的 json-servlet.xml 文件中：

```
<bean id="exceptionResolver" class="com.autolytix.common.web.CustomExceptionResolver"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:47:00.887

将以下代码添加到前端控件

```
 @ExceptionHandler(Exception.class)
public @ResponseBody
MyErrorBean handleGeneralException(Exception e,
        HttpServletRequest request, HttpServletResponse response) {
    logger.info("Exception:" , e);
    response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
    MyErrorBean errorBean = new MyErrorBean();
    errorBean.setStatus(MyConstants.ERROR_STATUS);
    return errorBean;

}` 
```

由于您使用的是 JSON，我假设您将在代码中配置一个 messageconverter，它将其转换为 JSON。通过设置状态并发送一个bean，您将能够解决它。

# php - Zend Framework 1 ACL：允许所有并拒绝一些

> ID：14488282
> 
> 赞同：1
> 
> 时间：2013-01-23T19:58:28.630
> 
> 标签：php, zend-framework

# 问题

嗨，我是 Zend Framework 1 的新手（我知道有一个版本 2，但我们需要为这个项目使用版本 1）所以不知道这是否是一个愚蠢的问题。除此之外，我发现很难找到关于注册和登录的好文档，我设法拥有一个带有 ACL 和 Auth 的系统，可以正常工作。

我只是想知道我的 ACL 是否正确。这就是我的班级现在的样子：

> 类 bckstg_Acl 扩展 Zend_Acl { public function __construct() {
> 
> ```
>  $this->addRole(new Zend_Acl_Role('guest'));
>     $this->addRole(new Zend_Acl_Role('user'), 'guest');
>     $this->addRole(new Zend_Acl_Role('admin'), 'user');
> 
>     $this->add(new Zend_Acl_Resource('error::error'));
>     $this->add(new Zend_Acl_Resource('auth::login'));
>     $this->add(new Zend_Acl_Resource('auth::register'));
>     $this->add(new Zend_Acl_Resource('auth::logout'));
>     $this->add(new Zend_Acl_Resource('data::render'));
>     $this->add(new Zend_Acl_Resource('index::index'));
>     $this->add(new Zend_Acl_Resource('admin::index'));
>     $this->add(new Zend_Acl_Resource('auth::noauth'));
> 
>     //$this->allow('guest', 'error', 'error');
>     $this->allow('guest', 'auth::noauth');
>     $this->allow('guest', 'auth::login');
>     $this->allow('guest', 'data::render');
>     $this->allow('guest', 'index::index');
>     $this->allow('guest', 'auth::register');
>     $this->allow('user', 'auth::logout');
>     $this->allow('admin', 'admin::index');
> } } 
> ```

# 问题

我注意到如果我不向资源添加新控制器，则 3 种用户类型（访客、用户或管理员）都无法看到该页面。但我想知道是否有办法说所有用户都可以看到所有内容？因为基本上我只需要拒绝客人我的应用程序的“喜欢”系统以及管理面板的用户和客人，除此之外他们可以看到所有页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:13:28.780

如果您检测到特定的控制器或模块，您可以初始化 ACL

我的方法是在前端控制器插件中询问我是否需要设置 ACL，所以：

```
// Register ACL plugin if is admin module
if($request->getModuleName() == 'admin'){
    $auth    = Zend_Auth::getInstance();
    $acl     = new My_Acl_Acl();
    $front   = Zend_Controller_Front::getInstance();
    $front->registerPlugin(new My_Plugin_AclControl($auth, $acl));
} 
```

对于 REST 网站（默认模块），ACL 永远不会被请求许可，仅适用于管理模块。

你在网上有很多文献，但是这个博客一开始对我帮助很大 [http://www.amazium.com/blog/label/zend_acl/page/1](http://www.amazium.com/blog/label/zend_acl/page/1)

# d3.js - 防止 d3.js 面积图低于 0 或 x 轴

> ID：14488283
> 
> 赞同：6
> 
> 时间：2013-01-23T19:58:30.533
> 
> 标签：d3.js

是什么导致此图表的值出现在 x 轴 (0:00) 下方？

我的数据看起来像这样（没有小于零的值）：

```
[{"x":1341806400,"y":4},
 {"x":1342411200,"y":0},
 {"x":1343016000,"y":0},
 {"x":1343620800,"y":7},
 {"x":1344225600,"y":6},
 {"x":1344830400,"y":73},
 {"x":1345435200,"y":328},
 {"x":1346040000,"y":0},
 {"x":1346644800,"y":0},
 {"x":1347249600,"y":0},
 {"x":1347854400,"y":0},
 {"x":1348459200,"y":11},
 {"x":1349064000,"y":17},
 {"x":1349668800,"y":0},
 {"x":1350273600,"y":0}] 
```

**渲染图表** ![示例面积/折线图](../Images/93ed7f28116f51a44f3b1f983e968364.png)

上图通过以下方式呈现：

```
var margin = {top: 20, right: 30, bottom: 30, left: 40};
var width = max_width - margin.left - margin.right;
var height = 300; // + margin.top + margin.bottom;
var height_offset = 100;

var x = d3.time.scale()
    .range([0, width]);

var y = d3.scale.linear()
    .range([height, 0]);

var z = d3.scale.category20c();

var ticks_interval;
switch(this.period_type){
  case "day":
    ticks_interval = d3.time.days;
    break;
  case "week":
    ticks_interval = d3.time.weeks;
    break;
  case "month":
    ticks_interval = d3.time.months;
    break;
  case "year":
    ticks_interval = d3.time.years;
    break;
}

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom")
    .ticks(ticks_interval);

var yAxis = d3.svg.axis()
    .scale(y)
    .tickFormat(function(d){ 
       return numeral(d).format("00:00").replace(/^0:/,""); })
    .orient("left");

var stack = d3.layout.stack()
    .offset("zero")
    .values(function(d) { return d.values; })
    .x(function(d) { return d.date; })
    .y(function(d) { return d.value; });

var nest = d3.nest()
    .key(function(d) { return d.key; });

var area = d3.svg.area()
    .interpolate("cardinal")
    .x(function(d) { return x(d.date); })
    .y0(function(d) {return y(d.y0);})
    .y1(function(d) { return y(d.y0 + d.y); });

var svg = d3.select(chart_dom_el)
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + height_offset)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var layers = stack(nest.entries(data));

x.domain(d3.extent(data, function(d){ return d.date; }));
y.domain([0,d3.max(data,function(d){
  return d.y0+ d.y;
})]);

//  re-map for formatted date
data = _.map(data,function(d){
  return {date: d.date.format("MM/D"),value:d.value};
});

svg.selectAll(".layer")
    .data(layers)
    .enter().append("path")
    .attr("class", "layer")
    .attr("d", function(d) { return area(d.values); })
    .style("fill", function(d, i) { return z(i); });

var x_axis_options = {x: 4, y: 9, rotate: 0};
if(data.length > 20){
  x_axis_options = {x: -27, y: 8, rotate: -45};
}else if(data.length > 13){
  x_axis_options = {y: -5, x: 27, rotate: 90};
}
svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis)
  .selectAll("text")
    .attr("y", x_axis_options.y)
    .attr("x", x_axis_options.x)
    .attr("transform", "rotate("+(x_axis_options.rotate)+")");

svg.append("g")
    .attr("class", "y axis")
    .call(yAxis); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T03:58:05.113

这似乎与您在区域生成器上使用的插值模式有关 - 尝试从 更改`cardinal`为`linear`或其他一些[区域插值模式](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-area_interpolate)

# javascript - Internet Explorer 中以 Quirks 模式加载页面 - doctype 已注释掉

> ID：14488284
> 
> 赞同：1
> 
> 时间：2013-01-23T19:58:34.873
> 
> 标签：javascript, html, internet-explorer, doctype, quirks-mode

我遇到了一个问题，即所有版本的 IE 都以 Quirks 模式在我的网站上呈现单个页面。此页面通过单击链接在新窗口中打开：

```
<a href="javascript:void(0);" onclick="popUp();" target="popupWindow">Launch Processor</a> 
```

并且窗口是使用以下js确定的：

```
function popUp(contactId) {
"use strict";
var url, width, height, leftPos, topPos, targetWin;
url = '/company/process';
if (contactId !== undefined && contactId !== null && contactId > 0) {
    url += '?contact_id=' + contactId;
}
width = 900;
height = 800;
leftPos = (screen.width / 2) - (width / 2);
topPos = (screen.height / 2) - (height / 2);
targetWin = window.open(url, 'popupWindow', 'toolbar=no, location=0, directories=no,     status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + width + ',     height=' + height + ', top=' + topPos + ', left=' + leftPos).focus();
} 
```

现在，经过大量研究，我已经尝试了所有方法并阅读了此处提出的各种其他问题，记录了相同的问题，例如[this](https://stackoverflow.com/questions/6529728/html5-doctype-putting-ie9-into-quirks-mode)和[this](https://stackoverflow.com/questions/3949941/what-throws-internet-explorer-into-quirks-mode)。

我已经在我的文本编辑器中检查了我的文件，并在 IE 和 Chrome 中查看了源代码（不使用 IE 中的 Inspector 工具或开发人员工具），并且在文档类型之前没有空格、字符或其他可能干扰的东西。在 IE 开发人员工具中查看文档类型虽然我看到它被注释掉了。这与我在站点范围内使用的文档类型结构（来自 HTML5 Boilerplate）相同。没有其他页面有这个问题。文档类型声明和元项如下：

```
<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7 page-company" lang="en"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8 page-company" lang="en"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9 page-company" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js page-company" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
```

现在，就像我提到的，这个页面被加载到一个使用一些 js 打开的新窗口中。如果我右键单击窗口并选择刷新，页面权限本身，doctype 不再被注释掉并且页面在标准模式下正确呈现，而不是 Quirks。如果我直接访问此 url，而不是通过新的弹出窗口，它也会正确呈现。

什么可能导致这种情况？这与用于强制打开新窗口的js有关吗？

在此先感谢您提供的所有帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T08:26:39.520

doctype 被注释掉的事实表明页面正在被处理，就好像 IE 是 IE7 或更早版本一样。

请注意，`<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">`拥有不会对您的页面产生任何影响，因为您在它之前添加了条件注释。这些具有将 IE 提交为特定版本的效果。

您可以尝试将 X-UA-Compatible, IE=edge 设置为真正的 HTTP 标头。这将在条件注释之前处理，因此应该强制 IE 使用其最新模式。

在文件开头检查页面是否存在无关字符时，我建议不要使用浏览器或文本编辑器，而是使用十六进制编辑器。例如，Hex Editor Neo（免费下载）将允许您直接从 url 加载资源，因此您可以看到发送到浏览器的确切字节。

# c++ - 试图制作一堆字符串。获取缺少类型说明符错误

> ID：14488293
> 
> 赞同：1
> 
> 时间：2013-01-23T19:59:15.203
> 
> 标签：c++

因此，我尝试将 int 添加到错误的来源，但这只会增加大量新错误。我用谷歌搜索了一下，但我没有找到任何对我有帮助的东西，或者我只是不明白很多人在说什么。

```
#include <iostream>

#include <string>
using namespace std;

//Define the stack class, set default stack size to 7
//use a template to define type at later point

template<class T,int size=7>
class stack
{
private: T data[size];
int stack_ptr;
public:
stack(void);
void push(T x);
T pop();
T top();
};

//constructor function to initialize stack and data
template<class T, int size>
stack<T, size>::stack(void)
{
int i;
for(i=0;i<size;i++) data[i]=0;
stack_ptr=0;
}

//Push data onto stack
template<class T,int size>
void stack<T, size>::push(T x)
{
if(stack_ptr>=size)
  {

    cout<<"cannot push data: stack full"<<endl;
    return;
  }
data[stack_ptr++]=x;
cout<<"Pushed\t" << x << "\tonto the stack"<<endl;
return;
}

//Pop data from stack
template<class T, int size>
stack<T, size>::pop()
{
using namespace std;
if(stack_ptr<=0)
  {

    cout<<"cannot pop data: stack empty"<<endl;
    return data[0];
  }
cout<<"popped\t"<< data[--stack_ptr]<< "\tfrom stack"<<endl;
return data[stack_ptr];
}

int main()
{

//declaring stack of strings and using default size
stack<string> c;
string w;
string name1 = "Rich";
string name2 = "Debbie";
string name3 = "Robin";
string name4 = "Dustin";
string name5 = "Philip";
string name6 = "Jane";
string name7 = "Joseph";
c.push(name1);
c.push(name2);
c.push(name3);
c.push(name4);
c.push(name5);
c.push(name6);
c.push(name7);

//pick up the stack value
w=c.pop();
string & i = c.top( );
string next_top = c.top();

cout << "The top person the stack is " << next_top << "."<< endl;

return 0;
} 
```

这是我的错误

```
1>------ Build started: Project: A-2, Configuration: Debug Win32 ------
1>  A-2.cpp
1>h:\pf3\a-2\a-2\a-2.cpp(55): error C4430: missing type specifier-int assumed.         
Note:    C++ does not support default-int 
```

我不确定我还能做什么，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:01:51.557

您在`pop`. 看起来您打算让返回类型`T`来自声明：

```
template<class T, int size>
T stack<T, size>::pop()
{
  // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:14:24.203

有一些问题：

1.  （如 sftrabbit 所示）：缺少 T 作为 pop 的返回类型规范。
2.  `string & i = c.top( );`无效：参考临时
3.  `for(i=0;i<size;i++) data[i]=0`不适用于除 int 类型以外的其他类型`T`

# php - 如果用户未登录，图像不显示？

> ID：14488295
> 
> 赞同：-1
> 
> 时间：2013-01-23T19:59:28.413
> 
> 标签：php, image, login, hyperlink

我正在尝试向已登录的用户显示带有完整尺寸图像链接的图像。我还试图使未登录的用户只能看到没有完整图片链接的缩略图图像，并且如果他们单击他们正在登录页面的图像。

到目前为止，我已经创建了这样的代码，当用户登录时它显示正常，但是当用户注销时，他们看不到任何图像。

有人可以告诉我我哪里出错了。谢谢你。

```
<?php            
$photo = "data/photos/$profile[1]/pic1.jpg";
if (!file_exists($photo)) {
    $photo = "data/photos/0/_default.jpg";
}
$thumb = "data/photos/$profile[1]/thumb_pic1.jpg";
if (!file_exists($thumb)) {
    $thumb = "data/photos/0/_default.jpg";
}
 if (logged_in()) {
echo
"<li><a href=\"$photo\" rel=\"shadowbox\" title=\"$profile[2]'s Photo's\"><img src=\"$thumb\" width=\"90\" height=\"90\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
    }
if (!logged_in()) {
echo
"<li><a href=\"loginframe.php\" rel=\"shadowbox;height=300;width=500\"><img src=\"thumb\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:01:49.120

在注销案例中缺少`$`之前`thumb`

```
<img src=\"thumb\"
          ^^^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:02:40.567

```
if (!logged_in()) {
echo
"<li><a href=\"loginframe.php\" rel=\"shadowbox;height=300;width=500\"><img src=\"thumb\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
} 
```

仔细看，你在 img src 中少了一个 $。

```
if (!logged_in()) {
    echo
    "<li><a href=\"loginframe.php\" rel=\"shadowbox;height=300;width=500\"><img src=\"$thumb\" alt=\"{$profile[2]}'s Photos\"  /></a></li>";
    } 
```

此外，您应该使用 If-Else 而不是检查两次

# json - JSON使用模式验证额外参数

> ID：14488296
> 
> 赞同：5
> 
> 时间：2013-01-23T19:59:30.317
> 
> 标签：json, jsonschema

我想通过 json 模式验证 json 输入。正面案例适用于预期的对象和属性。但我想验证额外的对象，即模式中未提及的参数。

如果在 json 中检测到垃圾数据，则基本上验证失败

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-28T13:30:06.023

如果您只想在 JSON 对象中拥有一组属性并拒绝其他属性：

*   `properties`确保您想要的属性在和中具有匹配的架构`patternProperties`，
*   定义`additionalProperties`为`false`：

    ```
    {
        "type": "object",
        "properties": { "p": {}, "q": {} },
        "additionalProperties": false
    } 
    ```

将只允许属性`p`并存`q`在于对象实例中。

# iphone - 实现游戏中心，和“错过方法”错误

> ID：14488299
> 
> 赞同：0
> 
> 时间：2013-01-23T19:59:44.547
> 
> 标签：iphone, ios, game-center

我正在尝试在我的应用程序中实现 Game Center。

我用[了这个教程](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-game-center-achievements-and-leaderboards-part-2/)

在我的视图控制器中，我有：

```
- (IBAction) submitScore
{
    if(self.currentScore > 0)
    {
        [_gameCenterManager reportScore: self.currentScore forCategory: self.currentLeaderBoard];
    }
} 
```

在 GameCenterManager.m 我有：

```
- (void) reportScore: (int64_t) score forCategory: (NSString*) category 
        {
            GKScore *scoreReporter = [[[GKScore alloc] initWithCategory:category] autorelease]; 
            scoreReporter.value = score;
            [scoreReporter reportScoreWithCompletionHandler: ^(NSError *error) 
             {
                     MyLog(@"scoreReporter %@", scoreReporter);
                 [self callDelegateOnMainThread: @selector(scoreReported:) withArg: NULL error: error];
             }];
        }

- (void) callDelegateOnMainThread: (SEL) selector withArg: (id) arg error: (NSError*) err
    {
        dispatch_async(dispatch_get_main_queue(), ^(void)
        {
           [self callDelegate: selector withArg: arg error: err];
        });
    }

- (void) callDelegate: (SEL) selector withArg: (id) arg error: (NSError*) err
{
    MyLog(@"selector %@", selector);
    MyLog(@"delegate %@", delegate);

    assert([NSThread isMainThread]);
    if([delegate respondsToSelector: selector])
    {
        if(arg != NULL)
        {
            [delegate performSelector: selector withObject: arg withObject: err];
        }
        else
        {
            [delegate performSelector: selector withObject: err];
        }
    }
    else
    {
        NSLog(@"Missed Method");
    }
}} 
```

在我的日志中，我总是写“错过的方法”。我来报告第一个分数（例如：35），但现在，不可能报告新分数（例如：100）。

NSlog 是：

```
2013-01-25 20:21:25.847 isam[37958:c07] -[GameCenterManager reportScore:forCategory:]_block_invoke_1 scoreReporter <GKScore: 0xb19a3f0>player:G:1677639845 rank:0 date:2013-01-25 19:21:25 +0000 value:50 formattedValue:(null) context:0x0
2013-01-25 20:21:25.847 isam[37958:c07] -[GameCenterManager callDelegate:withArg:error:] selector scoreReported:
2013-01-25 20:21:25.848 isam[37958:c07] -[GameCenterManager callDelegate:withArg:error:] delegate <GameViewController_iPhone: 0xb16d120>
2013-01-25 20:21:25.848 isam[37958:c07] Missed Method 
```

我想我在谷歌上阅读了关于我的问题的所有主题，但我没有找到正确的解决方案。

# sql - 如何平均查询底部的列

> ID：14488300
> 
> 赞同：1
> 
> 时间：2013-01-23T19:59:49.623
> 
> 标签：sql, oracle, oracle10g, oracle11g

忽略`'?DATE1::?'`它只是用户输入日期范围的前缀。

```
Select
       STARTDATEKEY 
       round(avg(Minutes),2) as Time  /*average for 1 day */
from   Table
where To_Date(to_char(StartDate, 'DD-MON-YYYY')) >= To_Date('?DATE1::?','MM/DD/YYYY')
and To_Date(to_char(RESTOREDDATETIME, 'DD-MON-YYYY')) <= To_Date('?DATE2::?','MM/DD/YYYY')
and FLAG = 0
group by STARTDATEKEY 
```

出来会
![在此处输入图像描述](../Images/2fed68b589731c24a14ba2252e9b7702.png)

**我需要帮助显示20130110 52.67**底部时间列的平均值

 **编辑/审稿人注意：我不知道是否应该标记 Oracle 或 SQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:14:22.707

您可以使用[ROLLUP](http://docs.oracle.com/cd/B19306_01/server.102/b14223/aggreg.htm#i1007413)分组功能。
应该是这样的：

```
Select
       STARTDATEKEY 
       round(avg(Minutes),2) as Time  /*average for 1 day */
from   Table
where To_Date(to_char(StartDate, 'DD-MON-YYYY')) >= To_Date('?DATE1::?','MM/DD/YYYY')
and To_Date(to_char(RESTOREDDATETIME, 'DD-MON-YYYY')) <= To_Date('?DATE2::?','MM/DD/YYYY')
and FLAG = 0
group by ROLLUP(STARTDATEKEY) 
```

[这是一个简化的 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/4b0db/2)**

# jquery - 将兄弟姐妹分组到一个div中

> ID：14488304
> 
> 赞同：3
> 
> 时间：2013-01-23T20:00:11.073
> 
> 标签：jquery, html, siblings

我正在为一家使用非常奇怪编码的电子商务解决方案的公司工作。我无法直接访问电子商务商店的代码，因为它由该特定公司托管。我会取消整个系统，但客户相当依赖它，这就是他们想要的。

这是我必须使用的：

```
<tbody>
    <tr>
        <td class="Product">
            <div class="ProductWrapper">
                <a class="ProductThumb" href="#">
                    <img src="#" />
                </a>
                <a class="ProductName" href="#">Example</a>
                <meta itemprop="name" content="Example""="">
                <div class="Status">
                    <link href="#">
                    In Stock
                </div>
                <div class="Price">
                    <b>$0.00</b>
                    <meta itemprop="priceCurrency" content="USD">
                </div>
             </div>
         </td>
         <td class="ProductSpacer"><div></div></td>
         <td class="Product">
            <div class="ProductWrapper">
                <a class="ProductThumb" href="#">
                    <img src="#" />
                </a>
                <a class="ProductName" href="#">Example</a>
                <meta itemprop="name" content="Example""="">
                <div class="Status">
                    <link href="#">
                    In Stock
                </div>
                <div class="Price">
                    <b>$0.00</b>
                    <meta itemprop="priceCurrency" content="USD">
                </div>
             </div>
         </td>
    </tr>
</tbody> 
```

我正在尝试以更具视觉吸引力的方式组织内容，因此我想将图像垂直对齐到底部，因为客户端有很多不同高度的图像已经上传到系统（1000 个）。然后在给它一个设定的高度后将文本垂直对齐到顶部，因为一些产品的名称是单行的，而另一些则是多行的。但是，为了做到这一点，我需要将内容放在它自己的 div 中。我尝试了几种不同的 jQuery 解决方案，但都没有奏效。

输出：

```
<tbody>
    <tr>
        <td class="Product">
            <div class="ProductWrapper">
                <a class="ProductThumb" href="#">
                    <img src="#" />
                </a>
                <div class="ProductInfo">
                    <a class="ProductName" href="#">Example</a>
                    <meta itemprop="name" content="Example""="">
                    <div class="Status">
                        <link href="#">
                        In Stock
                    </div>
                    <div class="Price">
                        <b>$0.00</b>
                        <meta itemprop="priceCurrency" content="USD">
                    </div>
                </div>
             </div>
         </td>
         <td class="ProductSpacer"><div></div></td>
         <td class="Product">
            <div class="ProductWrapper">
                <a class="ProductThumb" href="#">
                    <img src="#" />
                </a>
                <div class="ProductInfo">
                    <a class="ProductName" href="#">Example</a>
                    <meta itemprop="name" content="Example""="">
                    <div class="Status">
                        <link href="#">
                        In Stock
                    </div>
                    <div class="Price">
                        <b>$0.00</b>
                        <meta itemprop="priceCurrency" content="USD">
                    </div>
                </div>
             </div>
        </td>
    </tr>
</tbody> 
```

我得到的最接近的解决方案如下：

```
$(".ProductThumb").nextUntil('td').wrapAll("<div class='ProductInfo'>"); 
```

但是，此代码会从页面上的每个产品列表中删除所有信息，并将其放在第一个列表之下。我还想指出，我只能将 jQuery 放在 html 的头部。

~~~~~~~~~~~~~

[编辑 1：] 我修复了代码的显示。我还想澄清几点：

首先，代码的最后一行“应该代表之前 TD 的副本。我很抱歉没有澄清。

其次，我想重申，我无法编辑 HTML。

最后，我试图划分 TD 中的数据。首先，包含图像的锚标记。然后，将其余数据（名称、库存、价格……）放在一个 div 中。

所以：

```
<a class="ProductThumb"> ... </a>
<div class="ProductInfo"> ... </div> 
```

我还要感谢大家的帮助和迅速的反应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:09:59.447

尝试这个

***HTML***

```
<table>
<tbody>
    <tr>
        <td class="Product">
            <div class="ProductWrapper">
                <a class="ProductThumb" href="#">
                    <img src="#" />
                </a>
                <a class="ProductName" href="#">Example</a>
                <meta itemprop="name" content="Example""="">
                <div class="Status">
                    <link href="#">
                    In Stock
            </div>
                <div class="Price">
                    <b>$0.00</b>
                    <meta itemprop="priceCurrency" content="USD">
            </div>
         </td>
         <td class="ProductSpacer"><div></div></td>
         <td class="Product"></td>
</tr>
</tbody>
</table> 
```

***JS代码***

```
$(".ProductThumb").siblings('.Price').wrapAll("<div class='ALLNEW' />"); 
```

**[现场演示](http://jsfiddle.net/WEarS/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:10:42.190

像这样尝试：包装选择器的内容：

```
$(".ProductThumb").parent().wrapinner("<div class='ALLNEW'>"); 
```

或者更简单：

```
$(".ProductWrapper").wrapinner("<div class='ALLNEW'>"); 
```

**编辑：** 如果要排除所有锚点和图像标签，可以使用`:not()`过滤器并稍微更改逻辑：

```
$(".ProductWrapper").children(":not(a, img)").wrapAll("<div class='ALLNEW'>"); 
```

# header - 在使用 Camel 的 @Produce 注释时设置 ActiveMQ 消息头

> ID：14488310
> 
> 赞同：1
> 
> 时间：2013-01-23T20:00:35.563
> 
> 标签：header, activemq, apache-camel

我们使用 Camel 通过 ActiveMQ 发送消息。在我们的代码中，我们有以下配置，它可以工作：

```
@Produce(uri = IEventService.QUEUE_NAME)
private IProducer sender;

@Override
public void emit(final Event e) {
    sender.emit(e);
} 
```

现在，我们要使用 ActiveMQ 消息组： [http ://activemq.apache.org/message-groups.html](http://activemq.apache.org/message-groups.html)

根据文档，我需要在消息头中设置 JMSXGroupID。如何获取消息头以便我可以在我的 emit() api 中设置此属性？

谢谢。-AP_

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:28:33.987

除了将 @Produce 注释到 IProducer （您自己定义的，对吗？），您可以这样做

```
@EndpointInject(uri = IEventService.QUEUE_NAME)
private ProducerTemplate sender;

@Override
public void emit(final Event e){
   sender.sendBodyAndHeader(e,"JMSXGroupID",someId);
} 
```

不确定这是否可以，或者您是否将 IProducer 用于其他用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T08:54:51.760

另一种解决方案是发送到 direct:myname 端点。然后你有一条小路线 from("direct:myname").to(IEventService.QUEUE_NAME)

因此，在这条路线中，您可以轻松添加标题。

# tablesorter - 表格分页机打印

> ID：14488319
> 
> 赞同：2
> 
> 时间：2013-01-23T20:01:09.610
> 
> 标签：tablesorter

我将 jquery tablesorter 与寻呼机一起使用。

我搜索了一种打印版本的页面显示所有项目（不仅仅是可见的列表）的方式。

示例：您有一个包含 25 个元素的列表。将寻呼机设置为 10 个元素。在第 1 页上，您将看到前 10 个元素。在此页面上，您调用 Print。结果是 25 个元素的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T06:13:07.373

如果您碰巧使用我[的 tablesorter 分支](http://mottie.github.com/tablesorter/docs/)，您有两种选择：

1.  将 pager plugin 选项设置`removeRows`为`false`，然后将其包含在您的 css 样式表中：

    ```
    @media print {
      table.tablesorter tbody tr {
        display: table-row !important;
      }
    } 
    ```

    如果过滤器小部件处于活动状态，此方法也将起作用。

2.  打印前禁用寻呼机插件，如下所示：

    ```
    // use $('table.tablesorter').trigger('enable.pager'); to re-enable the pager
    $('table.tablesorter').trigger('disable.pager'); 
    ```

[这是从这里](https://github.com/Mottie/tablesorter/issues/42)转贴的。

# facebook - 将一张照片上传到 Facebook 粉丝专页

> ID：14488322
> 
> 赞同：0
> 
> 时间：2013-01-23T20:01:21.420
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, offline

我正在使用本教程[http://pastebin.com/WpJmPYAi](http://pastebin.com/WpJmPYAi)，通过一些更改，我可以将照片上传到我的粉丝专页。

但是，我希望能够在我从 Facebook 注销时上传。在我的网站中，我需要能够在没有我的帐户登录的情况下将图像上传到粉丝专页。

这可能吗？

例如，我认为：有没有办法做到这一点：

```
$page_info = $facebook->api("/".$fanpage."?fields=access_token"); 
```

没有登录 Facebook 帐户，只有我的应用程序和帐户数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:16:46.713

`access_token`您可以使用该`Facebook::setAccessToken($access_token)`方法设置一个存储。

有关详细信息，请参阅 PHP SDK 文档：[https ://developers.facebook.com/docs/reference/php/facebook-setAccessToken/](https://developers.facebook.com/docs/reference/php/facebook-setAccessToken/)

# d - 如何让 std.net.curl 编译

> ID：14488323
> 
> 赞同：1
> 
> 时间：2013-01-23T20:01:22.747
> 
> 标签：d

如果我尝试从 std.net.curl 编译示例代码

```
import std.net.curl;

void main() {
    auto smtp = SMTP("smtps://smtp.gmail.com");
    smtp.setAuthentication("from.addr@gmail.com", "password");
    smtp.mailTo = ["<to.addr@gmail.com>"];
    smtp.mailFrom = "<from.addr@gmail.com>";
    smtp.message = "Example Message";
    smtp.perform();
} 
```

我收到以下错误消息：

```
OPTLINK (R) for Win32  Release 8.00.12
Copyright (C) Digital Mars 1989-2010  All rights reserved.
http://www.digitalmars.com/ctg/optlink.html
curl.lib
 Warning 2: File Not Found curl.lib
test.obj(test)
(...)
--- errorlevel 8 
```

我去过[http://curl.haxx.se/](http://curl.haxx.se/)，但我不知道如何处理它拥有的许多文件。我在任何地方都看不到 curl.lib。

**编辑**这是我为使其正常工作所做的工作

*   [从http://curl.haxx.se/download.html](http://curl.haxx.se/download.html)下载“Win32 - Generic” zip
*   [从http://www.digitalmars.com/download/freecompiler.html](http://www.digitalmars.com/download/freecompiler.html)下载“基本实用程序”
*   运行“imlib /s curl.lib libcurl.dll”
*   将 curl.lib 放在 dmd2/windows/lib 文件夹中
*   将 libeay32.dll 和 ssleay.dll 放在 dmd2/windows/bin 文件夹中

现在一切似乎都正常，尽管我在编译时不必链接 curl.lib。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T23:07:25.193

这个问题的答案应该会有所帮助：

[DMD 的“curl.lib”在哪里？](https://stackoverflow.com/questions/7933845/where-is-curl-lib-for-dmd/7937155#7937155)

当你编译你的应用程序时，你需要将 curl.lib 添加到命令行，这个问题询问如何构建 curl.lib。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-24T17:57:13.047

[dmd 的下载页面](http://dlang.org/download)包含指向 dmd 兼容 curl 的链接，因此您可以从那里下载和安装 curl。然后在用dmd编译的时候需要链接curl.lib。

# iphone - Facebook 应用程序权限以某种方式切换

> ID：14488325
> 
> 赞同：0
> 
> 时间：2013-01-23T20:01:27.810
> 
> 标签：iphone, facebook, ios6

我的 iPhone 应用程序中的 Facebook SSO 正常工作，我的大多数用户都没有遇到任何问题。但是，他们中的一小部分人一直在报告 Facebook Connect 错误并且无法创建帐户。在与一个人交换电子邮件后，我们确定设置-> Facebook 下的应用程序权限切换以某种方式设置为禁止我的应用程序使用 Facebook。

此后，我添加了一条错误消息，告诉用户可能是这种情况，但我的问题是，这个开关最初是如何切换的？似乎用户必须手动切换此开关，对吗？我还寻找了一种可能执行此操作的 API 方法，例如在用户第一次看到请求许可的对话框时拒绝 Facebook SSO；我找不到任何这样的代码。

有任何想法吗？我希望这个问题会通过我放入的错误对话框自行解决，但如果可能的话，我想完全删除这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T00:27:46.257

据我所知，使用 iOS6 的本机对话框并拒绝权限请求（第一个，至少，不确定请求现有用户获得更多权限的请求）将切换该开关

如果您需要调试，请尝试从您的 facebook 个人资料中卸载该应用程序（a`HTTP DELETE request to /<USER ID>/permissions`会这样做，或者您可以在 facebook 应用程序设置中进行），删除 iOS 应用程序，然后安装它并尝试“第一次”连接再次

# google-app-engine - 使用 GAE 提交表单后，Web 应用程序中没有显示新内容

> ID：14488326
> 
> 赞同：1
> 
> 时间：2013-01-23T20:01:27.893
> 
> 标签：google-app-engine, google-cloud-datastore

我有一个在 GAE for Java 上运行并使用应用引擎 Datastore 和 Objectify 4 的 Web 应用程序。

当用户从 web 提交一个包含多个字段的表单时，应用程序的逻辑应该将这些值发布到数据存储区，读取数据列表（包括这些最后的值）并返回到 web，显示这些最后提交的更改以及其余数据。大多数时候它工作正常。

但是，有时（实际上很少发生），**新值被保存，但是当返回网络时，它们不会出现在网络上**。但是只是**在几秒钟后刷新浏览器（因此刷新了阅读过程），值就在那里**，因为它们应该是第一次。

在我的本地环境中进行测试，这也发生在我身上几次，我收到一个错误，说**用于模拟数据存储的文本文件（称为 local_db.bin）**在“保存”或“阅读”的过程，可能是因为这个过程太快了，而且新的值还不可用（不过这是我的看法）。所以我想类似的事情可能会发生在真正的数据存储上。

你知道如何以简单的方式避免这个问题吗？（如果可能，避免同步块等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:18:35.377

由于使用没有祖先查询的高复制数据存储，听起来您遇到了[最终一致性问题。](http://en.wikipedia.org/wiki/Eventual_consistency)从[为强一致性构建数据](https://developers.google.com/appengine/docs/java/datastore/structuring_for_strong_consistency)（强调添加）：

> Google App Engine 的 High Replication Datastore (HRD) 通过在多个数据中心同步存储数据，为您的读写提供高可用性。但是，从提交写入到它在所有数据中心中可见的延迟意味着跨多个实体组的查询（非祖先查询）只能保证最终一致的结果。因此，**此类查询的结果有时可能无法反映基础数据的最新更改**。
> 
> **要获得高度一致的查询结果，您需要使用祖先查询将结果限制为单个实体组。**这是有效的，因为实体组是一致性和事务性的单位。所有数据操作都应用于整个组；在整个实体组更新之前，祖先查询不会返回其结果。如果您的应用程序依赖于某些查询的高度一致的结果，您可能需要在设计数据模型时考虑到这一点。本页讨论了构建数据以支持强一致性的最佳实践。

这是使用该文档中的祖先查询进行编写的示例：

```
import com.google.appengine.api.datastore.DatastoreService;
import com.google.appengine.api.datastore.DatastoreServiceFactory;
import com.google.appengine.api.datastore.Entity;

String guestbookName = req.getParameter("guestbookName");
Key guestbookKey = KeyFactory.createKey("Guestbook", guestbookName);
String content = req.getParameter("content");
Date date = new Date();

// Place greeting in same entity group as guestbook
Entity greeting = new Entity("Greeting", guestbookKey);
greeting.setProperty("user", user);
greeting.setProperty("date", date);
greeting.setProperty("content", content); 
```

并阅读：

```
import com.google.appengine.api.datastore.DatastoreService;
import com.google.appengine.api.datastore.DatastoreServiceFactory;
import com.google.appengine.api.datastore.Entity;

DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();

Key guestbookKey = KeyFactory.createKey("Guestbook", guestbookName);
Query query = new Query("Greeting", guestbookKey)
                    .setAncestor(guestbookKey)
                    .addSort("date", Query.SortDirection.DESCENDING);

List<Entity> greetings = datastore.prepare(query)
                                  .asList(FetchOptions.Builder.withLimit(10)); 
```

文档中更详细地讨论了使用祖先查询的注意事项。

# c# - 避免制作重复的控件面板？

> ID：14488327
> 
> 赞同：1
> 
> 时间：2013-01-23T20:01:28.367
> 
> 标签：c#, asp.net

我正在制作一个 Web 应用程序，但我没有使用 MVC。

我有这样的页面：创建任务，创建项目，创建案例......

每个人都需要标准信息，例如：StartDate（日历小部件等）、开始时间等。

如果在某个地方，我需要更改此标准内容，例如，我需要更改文本框的日历，我希望它在使用它的任何地方都可以更改。

做这种事情的正确方法是什么？

在 ASP .NET 代码中，最好有这样的：

```
SchedulePanel.Calendar.Date; 
```

它不必基于面板或任何东西，但我基本上有一组我在很多地方都需要的控件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:11:32.447

您可以将所有这些控件放入 UserControl 并在需要时添加。正如罗伯特所说，如果几乎每个页面都需要它，那么将这些控件放入母版页中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:08:34.863

asp.net`UserControls`非常适合这种情况。

[http://asp.net-tutorials.com/user-controls/using/](http://asp.net-tutorials.com/user-controls/using/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:09:11.893

请进一步解释此声明：`I want it to change everwhere where this is used.`

如果我理解正确，您可以将所有控件`User Control`放在声明变量后面的代码中，并在部分`public`中更改控件`set`

# c# - 如何将 xsi:schemaLocation 添加到序列化对象

> ID：14488328
> 
> 赞同：7
> 
> 时间：2013-01-23T20:01:34.550
> 
> 标签：c#

如何将以下 xsi:schemaLocation 添加到序列化类？

```
<ern:NewReleaseMessage xmlns:ern="http://ddex.net/xml/2010/ern-main/32"
                       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                       LanguageAndScriptCode="en"
                       xsi:schemaLocation="http://ddex.net/xml/2010/ern-main/32 http://ddex.net/xml/2010/ern-main/32/ern-main.xsd"
                       MessageSchemaVersionId="2010/ern-main/32"> 
```

这是我到目前为止所做的：

```
public class NewReleaseMessage
{
    [XmlAttribute]
    public string LanguageAndScriptCode { get; set; }

    [XmlAttribute("schemaLocation", Namespace = "http://ddex.net/xml/2010/ern-main/32")] 
    public string  schemaLocation = "http://ddex.net/xml/2010/ern-main/32 http://ddex.net/xml/2010/ern-main/32/ern-main.xsd";

    [XmlAttribute]
    public string MessageSchemaVersionId { get; set; }

    [XmlElement()]
    public MessageHeader MessageHeader { get; set; }

} 
```

当我将 xml 反序列化为 VS 中的对象时，我得到：

{“方法或操作未实现。” XML 文档中存在错误 (5, 44) - 这实际上指向以下行：xsi:schemaLocation="http://ddex.net/xml/2010/ern-main/32 [http://ddex.net/ xml/2010/ern-main/32/ern-main.xsd](http://ddex.net/xml/2010/ern-main/32/ern-main.xsd) "

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T23:43:24.973

灵魂：

```
[XmlAttribute(AttributeName = "schemaLocation", Namespace = "http://www.w3.org/2001/XMLSchema-instance")]
public string schemaLocation { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-29T09:24:01.500

以下是对我有用的：

注意：“XmlAttributeAttribute”

```
[XmlAttributeAttribute(AttributeName = "schemaLocation", Namespace = "http://ddex.net/xml/2010/ern-main/32")] 
public string schemaLocation = "http://ddex.net/xml/2010/ern-main/32 http://ddex.net/xml/2010/ern-main/32/ern-main.xsd"; 
```

# fpga - 如何在 uClinux 上安装 SD 卡和以太网

> ID：14488345
> 
> 赞同：0
> 
> 时间：2013-01-23T20:02:22.597
> 
> 标签：fpga, uclinux

我刚刚在 Altera DE2-115 (FPGA BOARD) 安装了 uCLinux，我可以完全访问终端，发生的事情：

我想为我的 eth0 设置一个 IP 和 MASK，当我执行“ifconfig”时，它只显示：

```
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B) 
```

没有 eth0 或 eth1，并且有两个以太网端口，eth0 插入了一根以太网电缆（完全可以与互联网和局域网一起使用）。

为什么没有 eth0 或 eth1？

另外：当我想安装我的 SD 卡驱动器时，我会执行以下操作：

```
mkdir /mnt/sd
mount /dev/mmcblk0p1 /mnt/sd 
```

我得到：

```
mount: mounting /dev/mmcblk0p1 on /mnt/sd failed: No such device or address 
```

好像没有 SD 卡设备...在我的开发文件夹中有以下内容：

```
mmc0
mmcblk0
mmcblk0p1
mmcblk0p2
mmcblk0p3 
```

我已经尝试过安装它们中的每一个，SD卡驱动器也支持FAT16，这就是我目前在我的SD卡上使用的文件系统。

我该怎么做才能访问以太网“eth0”和/或“eth1”以及 SD 卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T20:05:02.213

Linux 上的以太网需要一些东西：

1.  硬件（磁性+物理），这似乎存在于你的情况下
2.  一些将硬件连接到处理器的 FPGA 设计。这通常称为 IP 核。您可以将其与 PC 中的网卡进行比较。
3.  必须满足以太网IP核的软件。在 Linux 中，这是正确的驱动程序。

您确定第 2 部分在您的硬件设计中吗？
你确定你在linux中激活了正确的驱动程序吗？

# file - Python 3：读取 UCS-2 (BE) 文件

> ID：14488346
> 
> 赞同：13
> 
> 时间：2013-01-23T20:02:27.417
> 
> 标签：file, python-3.x, ucs2

我似乎无法使用内置的 open() 函数在 Python 3.3 下解码 UCS-2 BE 文件（遗留的东西）（堆栈跟踪显示 UnicodeDecodeError 并包含我的 readLine() 方法） - 事实上，我找不到用于指定此编码的标志。

使用 Windows 8，终端设置为代码页 65001，使用“Lucida Console”字体。

我猜代码片段不会有太大帮助：

```
def display_resource():
    f = open(r'D:\workspace\resources\JP.res', encoding=<??tried_several??>)
    while True:
        line = f.readline()
        if len(line) == 0:
            break 
```

感谢对此问题的任何见解。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-23T20:10:58.977

[UCS-2 是 UTF-16](http://en.wikipedia.org/wiki/UTF-16)，实际上，对于在任何情况下仍称为 UCS-2 时分配的任何代码点。

用`encoding='utf16'`. 如果没有 BOM（[字节顺序标记](https://en.wikipedia.org/wiki/Byte_order_mark)，开始时 2 个字节，对于 BE that'd be `\xfe\xff`），则使用`encoding='utf_16_be'`强制字节顺序。

# django - 无法将基于函数的表单视图完全转换为基于类的表单视图

> ID：14488355
> 
> 赞同：0
> 
> 时间：2013-01-23T20:02:53.493
> 
> 标签：django, django-forms, django-views

我正在尝试将以下基于函数的视图转换为基于类的视图：

（基本上在表单提交有效或无效之后，用户会再次被重定向到同一页面）。

旧代码：

```
def handle_form(request, template_name='contact.html'):
    if request.method == "POST":
        form = ContactForm(request.POST)
        if form.is_valid():
            do_something()
    else:
        form = ContactForm()
    return render_to_response(template_name, {'form': form}, context_instance=RequestContext(request)) 
```

新代码：

```
class ContactFormView(FormView):
    template_name = 'contact.html'
    form_class = ContactForm
    success_url = reverse_lazy('contact')

    def form_valid(self, form):
        do_something()
        return super(ContactFormView, self).form_valid(form) 
```

新代码的细微差别在于，如果表单有效，表单的提交值将被遗忘。旧代码中的行为是始终记住这些值。

任何帮助，将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T05:11:22.020

FormView 实现了表单的标准流程，即在成功保存后不再重新显示填充的表单。

要执行您想要的操作，您必须自己保存表单，然后使用传递给它的上下文再次渲染视图，而不是依赖超类方法来执行此操作。

```
class ContactFormView(FormView):
    template_name = 'contact.html'
    form_class = ContactForm

    def form_valid(self, form):
        do_something()
        form.save()
        return self.render_to_response(self.get_context_data(form=form)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:41:48.343

form_valid 将执行重定向，而不是呈现模板。您需要放弃默认行为并像往常一样呈现模板（我假设您没有保存模型，否则您应该简单地重定向到 url

# php - PHP 问题：警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在“

> ID：14488356
> 
> 赞同：-2
> 
> 时间：2013-01-23T20:03:02.120
> 
> 标签：php, mysql, eclipse

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，布尔值在选择中给出](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)
> [警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在](https://stackoverflow.com/questions/5473981/warning-mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-i)

请帮助我在 MYSQL 中建立了一个数据库，并希望我的程序从数据库中打印数据。我有一个小问题，出现警告说：“警告：mysql_fetch_array() 期望参数 1 是资源，给定的布尔值”有人可以帮忙吗

'

```
//open a MySQL Connection
$link = mysql_connect('localhost', 'root', '');
if(!$link)
{
    die('Connection failed:' .mysql_error());
}

//select the database to work with
$db = mysql_select_db('test (2)');
if ($db)
{
    die('Selected database unavailable:' .mysql_error());
}

//create and excute a mysql query
$sql = "SELECT artist_name FROM artist";
$result = mysql_query($sql);

//loop through the returned data and output it
while($row = mysql_fetch_array($result))
{
    printf("Artist: %s<br/>", $row['artist_name']);
}

// free memory associated with the query
mysql_free_result($result);

//close the connection
mysql_close($link);
' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:08:11.003

您的查询没有返回任何结果，因此`$result`不是资源。尝试：

```
//create and excute a mysql query
$sql = "SELECT artist_name FROM artist";
$result = mysql_query($sql) or die(mysql_error()); 
```

也尝试使用`mysqli_*`命令组而不是`mysql_*`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:07:12.860

这意味着您的查询失败。

```
//create and excute a mysql query
$sql = "SELECT artist_name FROM artist";
$result = mysql_query($sql);

if ($result === false) mysql_error();

//loop through the returned data and output it
while($row = mysql_fetch_array($result))
{
    printf("Artist: %s<br/>", $row['artist_name']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:21:39.533

尝试这个：

```
<?php

//open a MySQL Connection
$link = mysqli_connect('localhost', 'root', '','test (2)');
if(!$link)
{
    echo('Unable to connect to the database!');
}
ELSE {

//create and excute a mysql query
$query = "SELECT artist_name FROM artist";
$result = mysqli_query($link, $query);

//loop through the returned data and output it
while($row = mysqli_fetch_array($result, MYSQLI_BOTH))
{
    printf("Artist: %s<br/>", $row['artist_name']);
}

// free memory associated with the query
mysqli_free_result($result);
}
//close the connection
mysqli_close($link);

?> 
```

MYSQLI_ 版本的查询。我使用了我的默认变量名，如果你愿意，你可以将它们设置回你自己的变量名。BWT 检查是否确实调用了数据库`test (2)`。我不喜欢在变量、数据库等中使用括号或数字。

# wordpress - 添加新菜单后wp菜单显示在错误的位置

> ID：14488360
> 
> 赞同：0
> 
> 时间：2013-01-23T20:03:13.003
> 
> 标签：wordpress, menu

我以前做过这百万次，我不知道现在发生了什么。我有一个导航菜单，客户要求我添加另一个导航菜单，整个事情都崩溃了。在我添加了第二个导航，添加了一些页面并将其分配到正确的位置后，第一个菜单出现在第二个的位置，而在第一个的位置又是第一个菜单。

这是我的注册导航代码`functions.php`：

```
register_nav_menus( array(
'primary' => __( 'Top navigacija', 'wpfme' ),
'above' => __( 'Above header', 'wpfme' ),
) ); 
```

这是两者在`header.php`文件中的位置：

```
<div class="left" id="kkk_top">
            <p><?php bloginfo('name'); ?> <?php wp_nav_menu( array('menu' => 'Above header' )); ?>
</p>
</div><!-- #kkk-top -->
<div id="main_navigation">
    <?php wp_nav_menu( array('menu' => 'Top navigacija' )); ?>
</div><!-- #main_navigation --> 
```

我还应该添加现在出现在该`Above header`位置的菜单包含在没有第二次导航时具有动态 id 的 div 中，并且现在出现在该`Top navigacija`位置中的菜单包含在具有新动态 id 的 div 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:53:51.630

我刚刚删除了第二个菜单并重新创建了它，将其放置在新的主题位置，现在一切都很酷......当有疑问时总是重新启动:)

# javascript - 需要在自动添加的脚本下添加 jQuery 函数

> ID：14488361
> 
> 赞同：-1
> 
> 时间：2013-01-23T20:03:26.147
> 
> 标签：javascript, jquery

我目前正在尝试将这个有趣的小爬虫脚本添加到我的网站，并希望对其进行自定义，以便在单击它时将其杀死。该脚本自动将图像放在标签的正上方，我似乎无法在其下方获取我的 jQuery .click 函数。

这是我放在头上的脚本（对不起，它被缩小了，但未缩小的版本由于某种原因不起作用）

```
/* WWW: http://screen-bug.googlecode.com/git/index.html Released under WTFPL license.     */
(function () {
    function y() {
        0 >= --s && t();
        if (!j) {
            var b;
            if (b = 0 >= --u) d = 0, 50 > a.top ? d |= 1 : a.top > document.documentElement.clientHeight - 50 && (d |= 2), 50 > a.left ? d |= 4 : a.left > document.documentElement.clientWidth - 50 && (d |= 8), b = d;
            if (b && (c %= 360, 0 > c && (c += 360), 15 < g(q[d] - c))) {
                b = q[d] - c;
                var k = 360 - c + q[d];
                f = g(b) < g(k) ? b : k;
                u = 10;
                l = 100;
                m = 30
            }
            0 >= --l && (f = e(1, 150), l = h(40 * Math.random()));
            if (0 >= --m) c += e(1, 10), m = h(10 * Math.random());
            else {
                b = e(1, 5);
                if (0 < f && 0 > b || 0 > f && 0 < b) b = -b;
                f -= b;
                c += b
            }
            r = c * v;
            b = 2 * Math.cos(r);
            k = 2 * -Math.sin(r);
            a.style.top = (a.top += k) + "px";
            a.style.left = (a.left += b) + "px";
            n("rotate(" + (90 - c) + "deg)")
        }
    }
    function e(b, a) {
        var c = h(b + Math.random() * a);
        return 0.5 < Math.random() ? c : -c
    }
    function t() {
        j = !j;
        s = e(50, 300);
        j ? (a.src = "https://screen-bug.googlecode.com/git/fruitfly.png", a.id = "bedbug", document.addEventListener ? document.addEventListener("mousemove", p, !1) : document.attachEvent && document.attachEvent("onmousemove", p)) : (a.src = "https://screen-bug.googlecode.com/git/fruitfly.png", w())
    }
    function w() {
        document.removeEventListener ? document.removeEventListener("mousemove", p, !1) : document.detachEvent && document.detachEvent("onmousemove", p)
    }
    function p(b) {
        b = b || window.event;
        b.clientX ? (posx = b.clientX, posy = b.clientY) : b.pageX && (posx = b.pageX - (document.body.scrollLeft + document.documentElement.scrollLeft), posy = b.pageY - (document.body.scrollTop + document.documentElement.scrollTop));
        40 > g(a.top - posy) + g(a.left - posx) && (t(), w())
    }
    var c = 90,
        r = c * v,
        f = 0,
        q = {
            1: 270,
            2: 90,
            4: 0,
            8: 180,
            5: 315,
            9: 225,
            6: 45,
            10: 135
        }, d = 0,
        u = 10,
        m = 0,
        l = 0,
        s = 50 * Math.random(),
        j = !1,
        a = null,
        n = void 0,
        x = {
            Moz: function (b) {
                a.style.MozTransform = b
            },
            Webkit: function (b) {
                a.style.WebkitTransform = b
            },
            O: function (b) {
                a.style.OTransform = b
            },
            Ms: function (b) {
                a.style.msTransform = b
            },
            Khtml: function (b) {
                a.style.KhtmlTransform = b
            },
            w3c: function (b) {
                a.style.transform = b
            }
        }, h = Math.round,
        g = Math.abs,
        v = Math.PI / 180;
    setTimeout(function () {
        a = document.createElement("img");
        a.src = "https://screen-bug.googlecode.com/git/fruitfly.png";
        (new Image).src = "https://screen-bug.googlecode.com/git/fruitfly.png";
        a.style.position = "fixed";
        a.style.zIndex = "99";
        a.top = e(50, document.documentElement.clientHeight - 50);
        a.top = 0 < a.top ? a.top : -a.top;
        a.left = e(50, document.documentElement.clientWidth - 50);
        a.left = 0 < a.left ? a.left : -a.left;
        a.style.top = a.top + "px";
        a.style.left = a.left + "px";
        document.body.appendChild(a);
        m = h(10 * Math.random());
        l = h(40 * Math.random());
        "transform" in a.style && (n = x.w3c);
        var b = ["Moz", "Webkit", "O", "Ms", "Khtml"];
        for (i in b) if (b[i] + "Transform" in a.style) {
            n = x[b[i]];
            break
        }
        c = e(0, 360);
        n && setInterval(y, 100)
    }, 2E3)
})(); 
```

我想把它放在下面：

```
<script type="text/javascript">
$("#bedbug").click(function() {
  alert("ARGHHH!!!!");
});
</script> 
```

最终，一旦它工作，我会让点击功能做更多的事情，但我只需要先让它工作。

提前感谢所有人，我感谢你们（和女孩）提供的所有帮助。干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:06:27.173

当您尝试引用它时，它不会被加载。使用 on() 对您有利

```
$(document).on("click", "#bedbug", function() {
  alert("ARGHHH!!!!");
}); 
```

# java - 带有正则表达式的 JAX-RS @Path 注释与预期的 URL 不匹配

> ID：14488362
> 
> 赞同：1
> 
> 时间：2013-01-23T20:03:32.290
> 
> 标签：java, rest, jax-rs

我希望我的 API 的 URL 具有以下用户资源格式：

```
http://hostname/webappname/something/something/serviceName/orgs/{id}/users 
```

但是，由于 URL 映射失败，我收到 404 错误。但如果我有以下格式，我会得到回复。

```
http://hostname/webappname/{id}/something/something/serviceName/orgs/{id}/users 
```

这是我的`@Path`注释：

```
@Path("/orgs/{oid: [0-9]+}/users") 
```

但如果我有以下`@Path`注释：

```
@Path("/orgs") 
```

有网址的

```
http://hostname/webappname/{id}/something/something/serviceName/orgs
http://hostname/webappname/something/something/serviceName/orgs 
```

我总是得到回应。有人可以告诉我应该如何`@Path`为我的资源提供注释。或者我哪里错了？

用户资源类如下所示：

```
 @Path("/orgs/{oid: [0-9]+}/users")
    @Component
    public class UserResource extends Resource {

    } 
```

Orgs 资源类如下所示：

```
 @Path("/orgs")
    @Component
    public class OrgResource extends Resource {

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T13:20:17.950

您应该使用[JAX-RS 子资源](http://docs.jboss.org/resteasy/docs/1.0.0.GA/userguide/html/JAX-RS_Resource_Locators_and_Sub_Resources.html)。在您的情况下，`UserResource`是 的子资源`OrgResource`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:16:29.570

我解决了这个问题。它与我的 @Path 注释无关。在创建这个项目时，我添加了一些旧代码依赖项。其中之一是取消分片过滤器，其工作是在将 URL 中存在的分片传递给下一个过滤器之前将其剥离。它正在从请求的路径中删除 {oid}，因此出现 URL 映射错误。仅当我更改项目的 URL 格式时，我才遇到此问题。

# backbone.js - 使用 Backbone Relational，如何在 Mongoose 中存储对象 ID 数组、检索为对象、另存为 ID

> ID：14488363
> 
> 赞同：1
> 
> 时间：2013-01-23T20:03:40.977
> 
> 标签：backbone.js, mongoose, backbone-relational

这是我的情况：

我有一个具有以下模式的 Mongo 数据库：

```
var SurveySchema = new Schema({
    start_date: Date,
    end_date: Date,
    title: String,
    questions: [ObjectId] //this I want to refer to questions
});

var QuestionSchema = new Schema({
    question_text: String,
    type: String,
    ....... (Lots and lots of fields)
}); 
```

完整架构文件：[https ://github.com/nycitt/node-survey-builder-api-server/blob/master/schemas.js](https://github.com/nycitt/node-survey-builder-api-server/blob/master/schemas.js)

骨干模型：[https](https://github.com/nycitt/node-survey-builder/blob/master/app/js/survey-builder/models.js) ://github.com/nycitt/node-survey-builder/blob/master/app/js/survey-builder/models.js和集合[https://github.com/nycitt/node-survey- builder/blob/master/app/js/survey-builder/collections.js](https://github.com/nycitt/node-survey-builder/blob/master/app/js/survey-builder/collections.js)

问题应该能够独立存在（说是 2-3 调查的一部分）。但是调查应该提到这个问题。

我理想的流程是：

1.  主干调用：GET /api/survey/123 并检索调查对象，其中 Mongoose 将对象 ID 转换为实际对象（进行连接）
2.  骨干电话： POST /api/survey/123 仅发布问题的 ID（是否有一些骨干关系魔法可以做到这一点）

# java - 多个线程可以通过JDBC同时访问一个数据库吗？

> ID：14488365
> 
> 赞同：0
> 
> 时间：2013-01-23T20:03:50.310
> 
> 标签：java, jdbc

我有一个类用于`JDBC`与 SQL Server 和`INSERT`、、`UPDATE`和`DELETE`...交互。现在有可能多个线程使用这个类（不是共享对象，每个线程使用这个类的一个新对象）来访问数据库同时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:12:48.933

是的，有可能。

> 如果每个新对象都共享同一个 JDBC Connection 对象，那么它会减慢您的数据库访问速度。
> 
> 如果每个新对象都有自己的 JDBC Connection 对象，那么它不会减慢数据库访问速度。但这会与您的数据库创建多个连接，这将增加数据库的负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:08:16.147

JDBC 只是如何通过 Java 代码与某些 SQL 服务器进行通信的标准。多线程对 JDBC 没有任何影响，如果您的代码是线程安全的，您可以在需要时创建事务等等。一切都会好起来的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:11:45.723

JDBC 不是一个类，它是一个标准。但是，您可以有多个到数据库的连接（通常是由容器管理的连接池）。每个线程将获得一个连接并在数据库上执行操作。事务的使用确保了数据的一致性和完整性。

# whitespace - RadComboBox：下拉列表底部出现空白

> ID：14488367
> 
> 赞同：1
> 
> 时间：2013-01-23T20:04:04.783
> 
> 标签：whitespace, dropbox, space, telerik-combobox

我从 Telerik 获得了一个 RadComboBox，并用我的数据库中的一些数据填充它。

假设我有 10 个 20 像素高的项目，这将使下拉列表成为 200 像素高。现在，我强制控件的最大高度为 100px，所以我应该看到一个滚动条。当我滚动我的框时，我的列表末尾有大约 100 像素的空白，使下拉列表变得很长，大约 300 像素。

这些是我的 RadComboBox 的相关属性：

```
<telerik:RadComboBox ... DropDownWidth="280px" MaxHeight="120px" NoWrap="True" /> 
```

**在列表的末尾，我得到了空白**、白线、**控件高度的等效大小**（120 像素的空白）。到目前为止，我对此一无所知。有人有线索吗？

![我的组合框空白的图像](../Images/3993a70bfaf0147809d1a312463ca3c6.png)

# python - Pythonic - 如何使用多个参数初始化构造函数并验证

> ID：14488368
> 
> 赞同：0
> 
> 时间：2013-01-23T20:04:07.460
> 
> 标签：python, design-patterns

我是一个 python 菜鸟，我正在尝试以“pythonic”的方式解决我的问题。我有一个类，谁的`__init__`方法需要 6 个参数。如果有任何验证失败，我需要验证每个参数并抛出/引发异常。

这是正确的方法吗？

```
class DefinitionRunner:
    def __init__(self, canvasSize, flightId, domain, definitionPath, harPath):
        self.canvasSize = canvasSize
        self.flightId   = flightId
        self.domain     = domain
        self.harPath    = harPath
        self.definitionPath = definitionPath

        ... bunch of validation checks...
        ... if fails, raise ValueError ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:12:21.633

如果您希望变量可以独立于 设置`__init__`，您可以使用[属性](http://docs.python.org/2/library/functions.html#property)在单独的方法中实现验证。

它们仅适用于新样式类，因此您需要将类定义为`class DefinitionRunner(object)`

例如，

```
 @property
    def canvasSize(self):
        return self._canvasSize

    @canvasSize.setter
    def canvasSize(self, value):
        # some validation here
        self._canvasSize = value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:09:20.550

从广义上讲，这看起来像你这样做的方式。虽然严格来说，您最好在分配之前而不是之后进行验证，特别是如果分配可能是时间或资源密集型的。此外，风格约定说不要像你一样对齐分配块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:11:30.790

我会像你那样做。除了验证的东西。我将在 setter 方法中进行验证并使用它来设置属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T20:26:18.913

你可以做这样的事情。为每种类型的输入创建一个验证器。创建一个辅助函数来运行验证：

```
def validate_and_assign(obj, items_d, validators):
    #validate all entries
    for key, validator in validators.items():
        if not validator[key](items_d[key]):
            raise ValueError("Validation for %s failed" % (key,))

    #set all entries
    for key, val in items_d.items():
        setattr(obj, key, val) 
```

你会像这样使用它：

```
class DefinitionRunner:
    validators = {
        'canvasSize': canvasSize_validator,
        'flightId': flightId_validator,
        'domain': domain_validator,
        'definitionPath': definitionPath_validator,
        'harPath': harPath_validator,
    }

    def __init__(self, canvasSize, flightId, domain, definitionPath, harPath):
        validate_and_assign(self, {
            'canvasSize': canvasSize,
            'flightId': flightId,
            'domain': domain,
            'definitionPath': definitionPath,
            'harPath': harPath,
        }, DefinitionRunner.validators) 
```

当然，如果数据类型相同，验证器可能是相同的函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-23T22:25:03.860

我不确定这是否完全是“Pythonic”，但我已经定义了一个名为 require_type 的函数装饰器。（老实说，我想我是在网上某个地方找到的。）

```
def require_type(my_arg, *valid_types):
'''
    A simple decorator that performs type checking.

    @param my_arg: string indicating argument name
    @param valid_types: list of valid types
'''
def make_wrapper(func):
    if hasattr(func, 'wrapped_args'):
        wrapped = getattr(func, 'wrapped_args')
    else:
        body = func.func_code
        wrapped = list(body.co_varnames[:body.co_argcount])

    try:
        idx = wrapped.index(my_arg)
    except ValueError:
        raise(NameError, my_arg)

    def wrapper(*args, **kwargs):

        def fail():
            all_types = ', '.join(str(typ) for typ in valid_types)
            raise(TypeError, '\'%s\' was type %s, expected to be in following list: %s' % (my_arg, all_types, type(arg)))

        if len(args) > idx:
            arg = args[idx]
            if not isinstance(arg, valid_types):
                fail()
        else:
            if my_arg in kwargs:
                arg = kwargs[my_arg]
                if not isinstance(arg, valid_types):
                    fail()

        return func(*args, **kwargs)

    wrapper.wrapped_args = wrapped
    return wrapper
return make_wrapper 
```

然后，使用它：

```
class SomeObject(object):

    @require_type("prop1", str)
    @require_type("prop2", numpy.complex128)
    def __init__(self, prop1, prop2):
        pass 
```

# javascript - 如何避免“Internet Explorer 限制此网页运行脚本或 ActiveX 控件”消息？

> ID：14488370
> 
> 赞同：3
> 
> 时间：2013-01-23T20:04:07.877
> 
> 标签：javascript, jquery, security, internet-explorer

我有一些需要从本地 DVD 运行的 HTML 页面。HTML 页面使用 jQuery 和 knockout.js。

它们在 Firefox、Safari、Chrome 上运行良好，但从 IE9 开始，对于每一页，我都会收到一条`Internet Explorer restricted this webpage from running scripts or ActiveX Controls`消息。这些页面需要从本地 DVD 执行，因此我无法确定用户是否更改了浏览器的安全级别。有没有办法避免来自 HTML 页面/脚本的消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:33:32.127

将脚本从您的 HTML 向下移动。../scipts/ 将不起作用。{yourhtmlpageroot}/scripts/

如果它们位于 DOM 页面的上游，则会发生安全违规，因为浏览器认为该页面正试图访问您机器上其他地方的脚本，因为它位于文档路径的上游。

# git - 如何使用 Node.js 获取远程 git 分支？

> ID：14488375
> 
> 赞同：5
> 
> 时间：2013-01-23T20:04:26.233
> 
> 标签：git, node.js, remote-branch

我正在使用这个名为[Gift](https://github.com/sentientwaffle/gift)的很棒的库来完成我所有的标准 git 事情（拉取、读取提交等）。但是，我似乎无法获得远程分支。我相信该`git branch -r`命令会向我显示分支，但格式肯定不是机器可读的：

```
 origin/HEAD -> origin/master
  origin/dev
  origin/gh-pages
  origin/master 
```

我想知道如何查看存储库拥有的所有远程分支。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:16:49.000

我猜你正在寻找的命令是

```
git ls-remote origin 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T02:00:04.790

要显示所有用于推送和拉取的远程存储库，请尝试：

`git remote -v`

如果您想了解有关特定远程的更多信息以及它与当前存储库的关系：

`git remote show <remoteName>`

# php - 在 CodeIgniter 中使用 AJAX 从控制器更新 DIV 框

> ID：14488381
> 
> 赞同：0
> 
> 时间：2013-01-23T20:04:52.057
> 
> 标签：php, javascript, ajax, codeigniter

我将每分钟更新两个用户之间的小聊天。这已经在工作了——但是我不知道如何进行 AJAX 调用来更新包含实际消息的 DIV。

```
var interval
window.onload = function(){
    interval = setInterval('updateMessages()', 2000);
};

function updateMessages() {
    $(function () {
         // UPDATE #mail_container
    });
} 
```

解决这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:08:50.447

最简单的方法可能是包含 jQuery 并使用它的 .append() 或 .html() 方法。

例如。`$("#mail_container").html("<p>Your chat message</p>");`

看：

*   [http://api.jquery.com/append/](http://api.jquery.com/append/)
*   [http://api.jquery.com/html/](http://api.jquery.com/html/)

# javascript - 如何更改当前页面上元素的可见性？

> ID：14488394
> 
> 赞同：0
> 
> 时间：2013-01-23T20:05:49.590
> 
> 标签：javascript, visibility, hidden, visible

一些人目前正在为一个项目构建一个小界面，我被困在一个点上。目前我有一个`setPage()`将`.current`类设置为活动链接的函数。

但是...我想更改可见性 a`<p>`以便它在当前页面时变为活动状态。

默认情况下`<p>`隐藏在 CSS 中。

这是HTML（顺便说一句，索引：1,2,3,4 ...仅用于测试）

```
 <script type="text/javascript" src="activemenu.js"></script>
</head>

<html>
<body>
<div id="menu">
    <ul>
        <li><a href="index.html">List Item 1<p>1042</p></a></li>
        <li><a href="index2.html">List Item 2<p>1042</p></a></li>
        <li><a href="index3.html">List Item 3<p>1042</p></a></li>
        <li><a href="index4.html">List Item 4<p>1042</p></a></li>
    </ul>
    <script language="javascript">setPage()</script>
    <div id="newalbumtxt"><a href="#">Create new album</a></div>
</div>

</body>
</html> 
```

这是`setPage()`功能

```
function extractPageName(hrefString)
{
    var arr = hrefString.split('/');
    return  (arr.length < 2) ? hrefString : arr[arr.length-2].toLowerCase() + arr[arr.length-1].toLowerCase();
}
function setActiveMenu(arr, crtPage)
{
    for (var i=0; i < arr.length; i++)
    {
        if(extractPageName(arr[i].href) == crtPage)
        {
            if (arr[i].parentNode.tagName != "DIV")
            {
                    arr[i].className = "current";
                    arr[i].parentNode.className = "current";
            }
        }
    }
}
function setActiveNbImg(arr, crtPage)
{
    for (var i=0; i < arr.length; i++)
    {
        if(extractPageName(arr[i].href) == crtPage)
        {
            if (arr[i].parentNode.tagName != "DIV")
            {
                    arr[i].className = "current";
                    arr[i].parentNode.className = "current";
            }
        }
    }
}

function setPage()
{
    hrefString = document.location.href ? document.location.href : document.location;

    if (document.getElementById("menu") !=null )
    setActiveMenu(document.getElementById("menu").getElementsByTagName("a"), extractPageName(hrefString));
}

function setNbImg()
{
    hrefString = document.location.href ? document.location.href : document.location;

    if (document.getElementById("menu") !=null )
        setActiveNbImg(document.getElementById("menu").getElementsByTagName("p"), extractPageName(hrefString));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:11:53.273

试试这个 CSS：

```
a p {
  display: none;
}

a.current p {
  display: block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:21:32.167

您可以向元素添加另一个类或修改当前类以包含`display`or`visibility`声明：

```
a p
{
    display: none;
}

.current
{
    display: block;
} 
```

或者：

```
a p
{
    visibility: hidden;
}

.current
{
    visibility: visible;
} 
```

`display`改变元素的显示方式，它有多个值，例如`inline`, `inline-block`, `block`,`table`等`table-cell`。当设置为`none`元素时，根本不再渲染，它本来占用的空间又是空闲的。[在这里阅读更多](https://developer.mozilla.org/en-US/docs/CSS/display)

`visibility`只是改变元素是否可见，但主要区别`display`在于元素占用的空间不会被回收，很像使用`position: relative`. [在这里阅读更多](https://developer.mozilla.org/en-US/docs/CSS/visibility)

# javascript - 触发window.onload时未加载css样式

> ID：14488395
> 
> 赞同：3
> 
> 时间：2013-01-23T20:05:50.043
> 
> 标签：javascript, html, css

这是我的问题：触发 window.onload 时未初始化 css 样式。

```
 <div id="foo"></div> 
```

css 文件

```
 #foo {
    height: 200px
 } 
```

js文件

```
window.onload = function(){
     console.log(document.getElementById('foo').style.height);
}; 
```

控制台显示：“”

样式必须在不同的文件中，如果使用样式属性 (style="height=200px") 它可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:07:39.450

`.style.height`不显示来自 CSS 规则的样式。它只返回已在该对象上显式设置的样式，无论是在 HTML 中还是通过 javascript，而不是从 CSS 规则继承的样式。

相反，您必须使用`window.getComputedStyle()`. 有关如何正确使用的更多详细信息，请参阅[MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle?redirectlocale=en-US&redirectslug=DOM%3awindow.getComputedStyle)`getComputedStyle()`。这是一个例子：

```
window.getComputedStyle(document.getElementById('foo'),null).getPropertyValue("height"); 
```

注意：对于旧版本的 IE，您必须安装 polyfill`getComputedStyle`或使用`el.currentStyle`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:09:04.540

Element.style 只会为内联样式（ ）设置，使用[window.getComputedStyle](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)`<div id="foo" style="height: 200px"></div>`来获取计算的样式

```
window.getComputedStyle(document.getElementById("foo"), null).getPropertyValue('height') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:41:01.107

您真正想要的是 offsetHeight 或 clientHeight。尝试这个：

```
window.onload = function(){
 console.log(document.getElementById('foo').offsetHeight);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:23:49.250

您还可以考虑使用 jquery，这是一个非常流行的 javascript 库，具有大量非常好的和强大的功能。而且，如果您使用[google cdn](https://developers.google.com/speed/libraries/devguide#jquery)，则无需担心性能，因为大多数浏览器已经在缓存中包含 libray。

要获取元素的高度，您只需使用`.height()`完整的解释在这里[http://api.jquery.com/height/](http://api.jquery.com/height/)

您的代码将如下所示：

```
$(document).ready(function() {
  console.log($('#foo).height());
}); 
```

起初它可能看起来有点混乱，但你很快就会掌握它的窍门，你会用 jquery 更快、更紧凑地编写 js。我永远不会没有它！

# sql - SQL Server 使用多对多相关表连接行

> ID：14488401
> 
> 赞同：2
> 
> 时间：2013-01-23T20:06:13.257
> 
> 标签：sql, sql-server, many-to-many, string-concatenation

我已经搜索过我的问题，但大多数示例（如果不是全部）只需要处理一两个表，它们之间存在一对多关系。所以，这是我的场景：

我的第一张桌子是：

```
OrderID Quantity    Price
----------------------------------
18      1000.00     160.00
19      1000.00     40.00
22      1000.00     40.00
23      100.00      500.00
24      10.00       50.00 
```

我的第二张桌子是：

```
ExtrasID    Name
-------------------
1           Value 1
2           Value 2
3           Value 3
4           Value 4
5           Value 5 
```

我在上面的表之间建立了多对多的关系，所以还有第三个（联合）表，如下所示：

```
OrderExtrassID  OrderExtras_OrderID OrderExtras_ExtrasID
----------------------------------------------------------------
20              19                  2
22              22                  3
23              23                  2
24              23                  5 
```

现在，我想要实现的只是得到如下结果：

```
OrderID Extras
----------------------------
18      NULL
19      Value 2
22      Value 3
23      Value 2, Value 5
24      NULL 
```

有很多使用 XML PATH、PIVOT、CTE 等的例子，但这些似乎都不能帮助我解决我的场景，或者至少我没有设法深入研究它们，以完成我的工作......

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:18:16.830

我建议使用`For XML`将多行返回到单行，然后使用`STUFF`删除多余的逗号。像这样的东西：

```
SELECT O.OrderId
 ,STUFF(
        (
            SELECT ',' + E.Name AS [text()]
                FROM OrderExtras OE
                    Inner Join Extras E 
                        ON E.ExtrasId = OE.OrderExtras_ExtrasID
                WHERE O.OrderId = OE.OrderExtras_OrderID
            ORDER BY E.Name
            FOR XML PATH('')
        ), 1, 1, '') AS ColList
FROM Orders O 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!3/3d785/1)。

祝你好运。

# c# - 区域和内部区域的最佳用途

> ID：14488402
> 
> 赞同：-1
> 
> 时间：2013-01-23T20:06:16.967
> 
> 标签：c#

我看到了很多旧代码和来自很多开发人员的代码。

> #region #endregion

有时可能会有所帮助，但如果使用得当。

如何使用它来保持我的代码井井有条且易于阅读的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:10:06.860

如果这就是您要问的，那并不意味着什么特别。它具有的唯一特殊效果是在 Visual Studio 中用于代码折叠。

如果您有一个执行一些任务的大型类，最好通过分离您的属性、不同的方法组、接口实现以及您认为可能重要的任何其他内容来将其区分开来。没有严格的规定。

```
class MyReallyBigClass : IAwesome, INotAsAwesome
{
    #region Public Properties
    public string Test { get; set; }
    // ..
    #endregion

    #region IAwesome Implementation
    public void IAwesome.BeAwesome()
    {
        // ..
    }
    public int IAwesome.AwesomeLevel()
    {
        // ..
    }
    #endregion

    #region INotAsAwesome Implementation [[...]]

    #region Internal Fields
    private int _whatever;
    // ..
    #endregion
} 
```

当然，在实践中，你不会真的得到一个大到*需要*将它分开的类，但我通常会发现自己至少在属性和接口实现方面使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:13:41.803

这纯粹是为了提高 IDE 的可读性。它在编译时被有效地剥离了。

也就是说，我倾向于在使用方面遵循 Microsoft 的样式指南：对方法、属性、构造函数等进行分组 - 很少（如果有的话）在方法内部，并且从不在大括号构造（if、for 等）和开口支架。

# clojure - 如何构建带有或不带有元素的哈希集（取决于条件）？

> ID：14488403
> 
> 赞同：1
> 
> 时间：2013-01-23T20:06:20.240
> 
> 标签：clojure

我正在尝试这个：

```
(hash-set (when (= a 1) x)) 
```

我期待`#{x}`if`a`等于，否则`1`为空集`#{}`。但我得到`#{nil}`的不是任何空集。如何重新编写语句？

附言。一种解决方法，但看起来很难看：

```
(filter #(not (nil? %)) (hash-set (when (= a 1) x))) 
```

解决方案：

```
(apply hash-set (when (= a 1) (list x))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:18:44.013

你可以使用：

```
(apply hash-set (when (= a 1) x)) 
```

我假设 a 和 x 是变量，例如通过：

```
(defn foo [a & x] (apply hash-set (when (= a 1) x))) 
```

我将参数 x 设为可选，因为如果 a 不等于 1，则不需要提供它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:05:20.193

其他方式：

```
(into #{} (when (= a 1) [x])) 
```

如果你喜欢`hash-set`代码中的这个词，你可以这样做：

```
(apply hash-set (when (= a 1) [x])) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:20:42.347

你可以这样做：

```
(if (= a 1) #{x} #{}) 
```

# java - 最小更改java中的贪心算法

> ID：14488407
> 
> 赞同：3
> 
> 时间：2013-01-23T20:06:29.810
> 
> 标签：java, double, minimum, greedy

好的，所以我需要编写一个程序来问我要多少钱，然后我需要它告诉我最少的硬币数量。我可以使用的硬币有：美元、25 美分硬币、10 美分硬币、5 美分硬币和1 美分硬币。例如，当我运行程序时，它应该如下所示：

```
> run Coins
Enter the amount of given money:
 [1.73]
Give the seller 8 coins:
1 dollars,
2 quarters,
2 dime,
0 nickels,
3 pennies. 
```

这是我到目前为止所拥有的：

```
import java.util.Scanner;

class Coins {
  public static void main (String args[]) {
     Scanner input = new Scanner(System.in);
     double  money;
     System.out.println("Enter the amount of money ");
     money = input.nextDouble();

     while (money > 0.0 ){
       if (money >= 1) {
          System.out.println(money/1+"dollars");
          money -= 1;

     }
       else if (money>=.25) {
         System.out.println(money/.25+"quarters");
         money-=.25;

       }
       else if (money>=.10) {
         System.out.println(money/.10+"Dimes");
         money-=.10;
       }
       else if (money>=.05) {
         System.out.println(money/.05+"Nickels");
         money-=.05;
       }
       else if (money>=.01) {
         System.out.println(money/.01+"Penny");
         money-=.01;
       }
     }        
  }
} 
```

我需要帮助的部分是：如果我运行程序并输入金额 1.73，按照我编写代码的方式，它需要数字 1.73，将其除以 1，然后打印“1.73 美元”。我需要一种去掉小数部分的方法，所以不是打印“1.73 美元”，而是打印“1 美元”。但我不知道该怎么做。我尝试将其转换为 int，但它扰乱了其他语句的流程。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:13:24.493

您需要在除法之后摆脱其余部分。您可以[`Math.floor()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#floor%28double%29)为此使用：

```
class Coins {
  public static void main (String args[]) {

     double  money = 1.73;

    int dollars = (int) Math.floor(money/1);
    money -= dollars * 1;

    int quarters = (int) Math.floor(money/0.25);
    money -= quarters * 0.25;

    int dimes = (int) Math.floor(money/0.10);
    money -= dimes * 0.10;

    int nickels = (int) Math.floor(money/0.05);
    money -= nickels * 0.05;

    int pennies = (int) Math.round(money * 100);

    System.out.println("Dollars: " + dollars);
    System.out.println("Quarters: " + quarters);
    System.out.println("Dimes: " + dimes);
    System.out.println("Nickels: " + nickels);
    System.out.println("Pennies: " + pennies);
  }
} 
```

导致：

```
Dollars: 1
Quarters: 2
Dimes: 2
Nickels: 0
Pennies: 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:16:45.733

您应该使用`floor`with cast to的组合`double`，以下代码有效：

```
class Coins {
    public static void main (String args[]) {
        double  money = 1.73;

        while (money > 0.0 ){
            if (money >= 1) {
                System.out.println(Math.floor(money/1)+" dollars");
                money -= Math.floor(money/1)*(double)1;

            }
            else if (money>=.25) {
                System.out.println(Math.floor(money/.25)+" quarters");
                money-=Math.floor(money/.25)*(double).25;

            }
            else if (money>=.10) {
                System.out.println(Math.floor(money/.10)+" Dimes");
                money-=Math.floor(money/.10)*(double).10;
            }
            else if (money>=.05) {
                System.out.println(Math.floor(money/.05)+" Nickels");
                money-=Math.floor(money/.05)*(double).05;
            }
            else if (money>=.01) {
                System.out.println(Math.round(money/.01)+" Penny");
                money-=Math.round(money/.01)*(double).01;
            }
        }
    }
} 
```

您遇到的另一个错误：您不
应该减去`Math.floor(money/XXX)*(double)XXX``(double)XXX`

# ios - 似乎无法将数组传递给 uitableview xcode

> ID：14488410
> 
> 赞同：2
> 
> 时间：2013-01-23T20:06:47.903
> 
> 标签：ios, objective-c, xcode, uitableview

我正在尝试将数组的内容显示到 uitableview 上。如果我单独分配值，它工作正常，但是当我尝试从数组中显示它们时，xcode 退出，调试报告中除了 (lldb) 之外没有任何内容。它编译并运行良好，直到我进入带有 tableview 的页面。我查看了错误，它似乎与内存分配有关，但由于必须为某些 JSON 类启用 ARC 才能运行，我无法手动释放任何内容。任何人都可以看看，看看可能是什么问题。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    theArray = [[NSArray alloc] initWithObjects:@"1","2","3","4",nil];

    // Do any additional setup after loading the view.
}

#pragma mark Table view methods

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [theArray count];
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Set up the cell...
    self.recentSearchesTable.backgroundColor =[UIColor clearColor];
    self.recentSearchesTable.separatorColor = [UIColor clearColor];
    cell.textLabel.font = [UIFont fontWithName:@"Helvetica" size:15];
    cell.textLabel.text = [theArray objectAtIndex:indexPath.row];

    cell.contentView.backgroundColor = [UIColor clearColor];

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // open a alert with an OK and cancel button
    NSString *alertString = [NSString stringWithFormat:@"Clicked on row #%d", [indexPath row]];
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:alertString message:@"" delegate:self cancelButtonTitle:@"Done" otherButtonTitles:nil];
    [alert show];

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:18:57.657

在`viewDidLoad`您的数组中包含非对象项，也进行更改：

```
theArray = [[NSArray alloc] initWithObjects:@"1",@"2",@"3",@"4",nil]; 
```

注意`@`数组中每一项的前面，表明它们是`NSString`文字（而不是 c 字符串）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:11:40.200

首先，由于外部类，您不需要为您的项目禁用 ARC。您可以通过设置 -fno-objc-arc 标志来排除这些类。

返回您的答案如果可以从以前的单元格中重复使用，则应分配一个新单元格。如果 dequeueReusableCellWithIdentifier:CellIdentifier 未返回单元格，则应分配新单元格。

```
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

  if (cell == nil)  {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:Cellidentifier] autorelease];
  } 
```

除此之外，当您在 viewDidLoad 中初始化数据源数组时，您需要在每个元素之前添加 @ 以指示 NSString。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:31:16.400

您首先在这里犯了两个错误，您需要以这种方式初始化数组。

theArray = [[NSArray alloc] initWithObjects:@"1",@"2",@"3",@"4",nil];

另一个错误是**您需要在单元格为 nil 时对其进行初始化**

```
if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    } 
```

如果你想要整个代码，那么你需要像这样实现。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }
    // Set up the cell...

    cell.textLabel.text = [theArray objectAtIndex:indexPath.row];

    cell.contentView.backgroundColor = [UIColor clearColor];

    return cell;
} 
```

# c# - 当字符序列出现在中间时，不匹配左括号和右括号

> ID：14488420
> 
> 赞同：1
> 
> 时间：2013-01-23T20:07:29.867
> 
> 标签：c#, regex

这里有一个有趣的问题供大家考虑：

我正在尝试解析和标记由字符分隔的字符串，`"/"`但前提是不在括号之间。

例如：

```
根/分支1/分支2/叶

```

应标记为：`"Root"`, `"Branch1"`, `"Branch2"`,`"leaf"`

```
Root/Branch1(subbranch1/subbranch2)/叶子

```

应标记为：`"Root"`, `"Branch1(subbranch1,subbranch2)"`,`"leaf"`

```
根（branch1/branch2）文本（branch3/branch4）文本/根（branch1/branch2）/叶

```

应标记为：`"Root(branch1/branch2) text(branch3/branch4)"`, `"Root(branch1/branch2)"`, `"leaf"`.

我想出了以下表达式，它适用于除 ONE 之外的所有情况！

```
([^/()]*\((?<=\().*(?=\))\)[^/()]*)|([^/()]+) 
```

唯一不起作用的情况是以下测试条件：

```
根(branch1/branch2)/SubRoot/SubRoot(branch3/branch4)/叶子

```

这**应该**被标记为：`"Root(branch1/branch2)"`, `"SubRoot"`, `"SubRoot(branch3/branch4)"`,`"Leaf"`

相反，我得到的结果只包含一个与整行匹配的组，因此它根本没有对其进行标记：

```
“根（分支 1/分支 2）/子根/子根（分支 3/分支 4）/叶”

```

这里发生的事情是，因为正则表达式是贪婪的，它会将最左边的左括号`"("`与最后一个右括号匹配，`")"`而不是仅仅知道在其适当的分隔符处停止。

你们那里的任何正则表达式专家都可以帮助我弄清楚如何在我现有的表达式中添加一个小的正则表达式片段来处理这个额外的情况？

```
Root(branch1/branch2) 测试(branch3/branch4)/SubRoot/SubRoot(branch5/branch6)/Leaf

```

应该被标记为组：

```
“根（分支 1/分支 2）测试（分支 3/分支 4）”
“子根”
“子根（分支 5/分支 6）”
“叶子”

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:19:34.443

```
List<string> Tokenize(strInput)
{
  var sb = new StringBuilder();
  var tokens = new List<string>();
  bool inParen = false;
  foreach(var c in strInput)
  {
      if (inParens)
      {
           if (c == ')')
               inParens = false;
           else
               sb.Append(c);
       }
       else if (c == '(')
               inParens = true;
       else if (c == '/')
            {
                 tokens.Add(sb.ToString());
                 sb.Length = 0;
            }
       else
             sb.Append(c);

  }
  if (sb.Length > 0)
      tokens.Add(sb.ToString());

  return tokens;
} 
```

这是未经测试的，但它应该可以工作。（并且几乎肯定会比正则表达式快得多）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:24:31.867

不同的方法，试图避免昂贵的环顾断言......

```
/(\(.+?\)|[^\/(]+)+/ 
```

加上一些评论...

```
/
(           # group things to be captured
  \(.+?\)   # 1 or more of anything in (escaped) brackets, un-greedily
|           # or ...
  [^\/(]+   # 1 or more, not slash, and not open bracket characters
)+          # repeat until done...
/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:25:49.357

以下使用平衡组来*捕获*每个匹配项`Regex.Matches`，确保`/`在括号之前的括号不平衡时关闭不匹配：

```
(?<=^|/)((?<br>\()|(?<-br>\))|[^()])*?(?(br)(?!))(?=$|/) 
```

奇怪的是，这似乎与[Billy Moon](https://stackoverflow.com/users/665261/billy-moon)的[简单得多的答案](https://stackoverflow.com/a/14488707/215380)类似，尽管这是过度设计的（每个令牌支持多个，可能嵌套的括号集）。

* * *

以下执行类似的操作，但使用（为清楚起见添加了换行符）*拆分*字符串`Regex.Split`：

```
(?<=^(?(brb)(?!))(?:(?<-brb>\()|(?<brb>\))|[^()])*)
/
(?=(?:(?<bra>\()|(?<-bra>\))|[^()])*(?(bra)(?!))$) 
```

这匹配“`/`字符串开头和字符串之间的任何括号`/`是平衡的，并且`/`字符串结尾之间的任何括号是平衡的”。

请注意，在lookbehind 中，`brb`捕获以与之前相反的顺序出现 - 这是因为lookbehind 显然是从右到左工作的。（感谢[Kobi](https://stackoverflow.com/a/13425789/215380)的回答教会了我这一点。）

这比匹配版本*要*慢得多，但我还是想弄清楚该怎么做。

# twitter-bootstrap - Internet Explorer 8 中未显示轮播图像

> ID：14488432
> 
> 赞同：1
> 
> 时间：2013-01-23T20:08:14.447
> 
> 标签：twitter-bootstrap, angularjs, internet-explorer-8, carousel, angular-ui

我正在尝试在我的应用程序中使用[AngularUI-Bootstrap](http://angular-ui.github.com/bootstrap/)（尤其是 carousel 指令）。

它在 Chrome、FF、Opera 和 IE9 中运行良好，但在 IE8 中它不显示`<img>`标签内的`<slide>`标签（或者在我的情况下`<div slide></div>`）。

```
<div carousel interval="5000">
    <div ng-repeat="image in dealerdetails.images" active="slide.active" slide>
        <img src="{{image}}" />
    </div>
</div> 
```

当我只显示`{{image}}m`它时，它会显示我的图像的路径。这是正确的，但如果我尝试使用`<img src="{{image}}">`or with `ng-src`，它根本不会显示。

还有其他人有同样的问题吗？它只是在 IE8 和 7 中。IE7 并不重要，但我必须在 IE8 中修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-09T19:35:26.563

有一些补丁可以解决这个问题。我必须结合使用这个[补丁](https://github.com/redaemn/bootstrap/commit/19ab7e5f4cee7814589da175d5581f5a1e1d222f#src/carousel/carousel.js)并使用 div carousel 而不是 carousel 标签才能让它在 IE8 中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T20:40:08.937

```
<img src="{{img}}" /> 
```

角度从来都不是一个好主意

试试这个：

```
<img ng-src="{{img}}" /> 
```

这并不能解释为什么 DOES 可以在其他浏览器中工作，但是让 angular 使用 ngSrc 指令来做它的事情通常是一个好主意

不幸的是，我在 Linux 上并且没有 IE8 访问权限，所以我无法为您进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T12:10:45.653

这对我有用：（仅在此页面中使用 jquery-1.10.2，并且在图像之前使用 div 父级）

```
 <script src="//code.jquery.com/jquery-1.10.2.js"></script>

                 <div carousel interval="3000">
                  <div slide ng-repeat="slide in slides" active="slide.active">
                    <div style="text-align: center; align: center">
                        <img src="/img/articles/{{slide.image}}" alt="{{slide.title}}"  style="margin: auto; text-align: center; align: center"/>
                    </div>          
                    <div class="carousel-caption">
                      <p>{{slide.tittle}}</p>
                      <p>{{slide.content}}</p>
                    </div>
                  </div>
                </div> 
```

# c# - 将 String 转换为 DateTime 会导致错误

> ID：14488438
> 
> 赞同：0
> 
> 时间：2013-01-23T20:08:45.870
> 
> 标签：c#, datetime

> **可能重复：**
> [DateTime.ParseExact 字符串格式异常](https://stackoverflow.com/questions/2000580/datetime-parseexact-string-format-exception)

`FormatException`被找到 ！

我试图将字符串转换为`DateTime`.

```
string dateString1 = "5/22/1985 12:00:00 AM";

DateTime myDate = 
    DateTime.ParseExact(dateString1, 
                        "mm-dd-yyyy",
                        System.Globalization.CultureInfo.InvariantCulture); 
```

它给了我一个错误，但是当我尝试以这种格式转换字符串时

```
string dateString2 = "10-10-2000"; 
```

这第二个字符串工作得很好，但`dateString1`不起作用！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:11:20.177

您的代码回答了您的问题。您正在使用`ParseExact`，它的格式不接受您的第一个字符串。

从 MSDN (http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)：

> 使用指定的格式和特定​​于区域性的格式信息将日期和时间的指定字符串表示形式转换为其等效的 DateTime。字符串表示的格式必须与指定的格式完全匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:13:47.480

试试这个：

```
DateTime myDate = DateTime.ParseExact(dateString1, "M/d/yyyy h:m:s tt", System.Globalization.CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:13:13.893

您专门使您的代码完全根据格式“mm-dd-yyyy”解析日期，因此当然只有具有该格式的日期才能工作。如果您改用 DateTime.Parse，则这两个示例都可以使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:17:12.917

您可以使用 Parse 而不是 ParseExact：

```
DateTime myDate = DateTime.Parse(dateString1); 
```

这应该正确解析您的两个示例中的任何一个。 [http://msdn.microsoft.com/en-us/library/1k1skd40.aspx](http://msdn.microsoft.com/en-us/library/1k1skd40.aspx)

# php - 将 PDO 与类一起使用

> ID：14488441
> 
> 赞同：0
> 
> 时间：2013-01-23T20:09:03.230
> 
> 标签：php, oop, pdo

我正在尝试在我的课程中使用 PDO 语句。我是 oop 的新手，我正试图弄清楚它应该如何完成。我查看了该站点上的一些示例，并使用了它们的逻辑，但它们似乎都不起作用。源代码中没有致命错误或警告，但从未执行过 sql 语句。所以我觉得我只是错过了一件我还没有学到的小东西。

到目前为止，我了解到的是 PDO 连接必须在一个类中进行，并且应该通过构造函数方法调用。我从其他人那里得到了数据库类的代码。

```
class Database
{
    protected static $Connection;

    public static function Connect()
    {
        if((self::$Connection instanceof PDO) === false)
        {
            $dbhost = 'host';
            $dbname = 'name';
            $dbuser = 'user';
            $dbpass = 'pass';

            self::$Connection = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);
        }
        return self::$Connection;
    }
} 
```

这只是类的一个函数中的构造函数和一个示例 PDO 语句

```
class blahJR extends blah
{       
    private $Database;

    function __construct ($sUser)
    {
        parent::__construct($sUser);

        //Updated below: $this->Database = Database::Connect();
        $this->Database = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass); //All the variables are given and the connection is definitely being made
    } //end __construct

public function foo($sString)
{
    try 
    {
         $Statement = $this->Database->prepare("INSERT INTO table (column) VALUES (?)");
         $Statement->execute(array($sString));
    }
    catch (PDOexception $e)
    {
         DatabaseError($e);
    }
} 
```

任何帮助将不胜感激。感谢您的时间。

更新：我在 try 语句周围添加了该函数以使其更清晰，它始终存在，只是在我提出问题时从未添加它。我希望能澄清它。它仍然没有报告任何错误。我不知道为什么这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:15:52.503

没有理由创建一个单独的类来连接数据库。只需创建一个实例`PDO`并将其注入到需要它的类/方法中。

另请注意，`Database`该类与 OOP 没有太大关系。

```
class BlarJR extends blah
{
    private $connection;

    public function __construct(\PDO $connection, $user)
    {
        parent::__construct($user);

        $this->connection = $connection;
    }

    public function foo($someValue)
    {
        $stmt = $this->connection->prepare("INSERT INTO table (column) VALUES (?)");
        $stmt->execute(array($someValue));
    }
}

$connection = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);
$connection->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$blarJR = new blahJR($connection, $user);

try {
    $blarJR->foo('my value');
} catch (\PDOexception $e) {
    echo $e->getMessage();
} 
```

如您所见，我还在 PDO 连接上启用了异常，并[禁用了模拟的准备好的语句](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)。您当前正在尝试捕获不会抛出的异常。[默认情况下，PDO 使用`PDO::ERRMODE_SILENT`](http://nl3.php.net/manual/en/pdo.error-handling.php)：

> 这是默认模式。PDO 将简单地设置错误代码供您使用语句和数据库对象上的 PDO::errorCode() 和 PDO::errorInfo() 方法进行检查；如果错误是由对语句对象的调用引起的，您将在该对象上调用 PDOStatement::errorCode() 或 PDOStatement::errorInfo() 方法。如果错误是由对数据库对象的调用引起的，您将改为在数据库对象上调用这些方法。

你目前拥有的东西会产生错误，因为你的东西只是坐在一个类中而不是在一个方法中。

> 解析错误：语法错误，意外的“尝试”（T_TRY），期待函数（T_FUNCTION）在...

# ios - 如何根据其中的组件设置 UITableViewCell 高度

> ID：14488446
> 
> 赞同：2
> 
> 时间：2013-01-23T20:09:16.830
> 
> 标签：ios, objective-c, uitableview

我创建了一个`UITableViewCell`包含`UITextView`. 当设置文本时`UITextView`，它会自动调整大小，以便高度增加但宽度保持不变。

我现在想使用下面显示的方法根据其中的高度动态设置每个`UITableViewCell`的高度`UITextView`。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Some code to pull in the subclassed UITableViewCell & set 
    // the height based on the UITextView within it.
} 
```

请有人建议如何/如果这可能吗？需要明确的是，这是从这种方法中获取我的自定义单元格导致了我的问题，显然我可以直接转换它，但这对我来说似乎不合适。请有人建议如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:00:10.967

创建一个宽度正确的 UITextView，然后在 textview 上设置文本。打电话`[textview sizeToFit]`。从 textview 获取高度，然后添加您需要的任何额外高度，以使其与您的 UITableViewCell 子类中的高度相同。

使用 NSString`sizeWithFont:constrainedToSize:lineBreakMode:`会很好，但根据我的经验，与相同大小的 UITextView 相比，这通常会在不同的地方破坏字符串，所以它不可靠。您的文本在 UITextView 中通常需要比 NSString`sizeWithFont:constrainedToSize:lineBreakMode:`建议的更多或更少的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:51:01.827

每次`UITextView`内容更改时，都需要重新计算和更新相关的单元格高度。您不能只设置新的单元格高度，而是`tableView`应该通过调用其委托方法`tableView:heightForRowAtIndexPath:`来询问它。要强制`tableView`重新计算其单元格大小，请调用空`[tableView beginUpdates]`/`[tableView endUpdates]`块。[我的TableKit](https://github.com/onegray/UITableKit)
库 中有一个 ReminderSample 演示，它显示了此功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:14:32.690

在 UITextView 中的字符串上使用 NSString 的[sizeWithFont:constrainedToSize:lineBreakMode :。](http://developer.apple.com/library/ios/documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html#//apple_ref/occ/instm/NSString/sizeWithFont%3aconstrainedToSize%3alineBreakMode%3a)我在返回的高度上添加了 ~15px 以给它一些喘息的空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T13:15:28.467

这是一个真实世界的例子。在这个应用程序中，只有第三部分中的单个单元格被调整大小，如果您想要调整任何单元格的大小，您应该将大小（在我的示例 descriptionLableSize 中）保存在 NSMutableDictionary 中并在`tableView:cellForIndexPath:`

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *description = [self.modelObject valueForKey:@"descriptionText"];
    CGSize constraintSize = CGSizeMake(280.0f, MAXFLOAT);

    //if needed save the size in a dictionary for each indexPath
    descriptionLableSize = [description sizeWithFont:[UIFont fontWithName:@"Helvetica" size:17] constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];
    if (indexPath.section == 2){
        NSUInteger h = descriptionLableSize.height + 20;
        h = (h < 44) ? 44:h;
        return h;
    }
    return 44.0;
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    //....
    if (section == 2) {

        NSString *description = [self.modelObject valueForKey:@"descriptionText"];
        cell.textLabel.text = description;
        [cell.textLabel setNumberOfLines:0];
        cell.textLabel.font = [UIFont fontWithName:@"Helvetica" size:17.0];
        cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;

    }

    cell.selectionStyle = UITableViewCellSelectionStyleNone;

    return cell;

} 
```

# r - 将参数列表/向量插入函数

> ID：14488450
> 
> 赞同：0
> 
> 时间：2013-01-23T20:09:30.547
> 
> 标签：r, function, vector

我需要多次重复一个函数，不同的参数在迭代中保持不变。为此，我想创建一个参数列表（或向量），然后将该列表插入到函数中。

例如：

```
q<-c("l,a,b,s")

genericfunction<-function(q){
} 
```

等效的代码当然是

```
genericfunction<-function(l,a,b,s){
} 
```

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:20:53.970

在我看来，你在追求`do.call`。

```
genericfunction <- function(l, a, b, s){
  l+a+b+s
}

args <- list(l=1, a=3, b=345, s=-4)

do.call(genericfunction, args)
[1] 345 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:54:58.400

您是否检查过 get() 和 assign() 函数 - 它们可能会完成您所追求的。你能扩展你的例子吗？

# java - Java ImageWriter BufferedImage 转 GIF

> ID：14488452
> 
> 赞同：2
> 
> 时间：2013-01-23T20:09:36.583
> 
> 标签：java, gif, bufferedimage, javax.imageio, bytearrayoutputstream

我希望你们能帮助我解决这个问题。我不确定这是Java中的错误还是我做错了什么，但我会选择后者。

我想将 BufferedImage 转换为 GIF 图像。然后我希望将 GIF 以字节数组的形式保存在内存中。（我不想将文件保存到磁盘）

该程序应该捕获一个屏幕片段（只是为了创建一个快速图像）并使用 ImageIO ImageWriter 和 ByteArrayOutputStream 将其转换为 GIF 字节数组。

下面的代码将向您展示该错误。程序将崩溃并给出 ArrayIndexOutOfBoundsException 并且数组保持为空。如果你用“png”替换“gif”，它会工作得很好，因此我很困惑。还！如果我将图像保存到磁盘上的文件中

```
write.setOutput(ImageIO.createImageOutputStream(new FileOutputStream(new File("C:/Image.gif"))); 
```

它会正确地将其保存到 .gif 文件中。

所以我的问题是，我在这段代码中做错了什么？任何帮助将不胜感激！:)

注意：这不是动画 GIF，也不涉及透明度。

```
 String format = "gif";
    Robot r = null;
    try {
        r = new Robot();
    } catch (AWTException e1) {
        e1.printStackTrace();
    }
    BufferedImage screen = r.createScreenCapture(new Rectangle(512,512));
    final BufferedImage gif = new BufferedImage(512,512,BufferedImage.TYPE_BYTE_INDEXED);
    Graphics2D g = gif.createGraphics();
    g.drawImage(screen,0,0,null);
    g.dispose();
    ImageWriter write = ImageIO.getImageWritersBySuffix(format).next();
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    try {
        write.setOutput(ImageIO.createImageOutputStream(out));
        write.write(gif);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    for(int i=0; i < 10; i++) {
        System.out.println(out.toByteArray()[i]);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:08:13.250

似乎在`com.sun.imageio.plugins.gif.*`. 如果您没有显式刷新或关闭 ImageOutputStream，则内容不会被刷新，*即使在关闭基础流之后也是如此*。改变

```
 write.setOutput(ImageIO.createImageOutputStream(out));
 write.write(gif); 
```

到

```
 ImageOutputStream imageos = ImageIO.createImageOutputStream(out);
   write.setOutput(imageos);
   write.write(gif);
   imageos.close();  // or imageos.flush(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-21T04:34:32.307

你必须使用 a`ByteArrayOutputStream`来获取图像作为字节。要写这个`ByteArrayOutputStream`，你应该用一个`ImageOutputStream`.

```
ImageWriter jpgWriter = ImageIO.getImageWritersByFormatName("gif").next();
//got imagewriter for gif
ImageWriteParam gifWriteParam = jpgWriter.getDefaultWriteParam();
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ImageOutputStream ios=ImageIO.createImageOutputStream(baos);
jpgWriter.setOutput(ios);
jpgWriter.write(null,new IIOImage(myBufferedImageObject, null, null),gifWriteParam);
baos.flush();
byte[] buf= baos.toByteArray();//got as bytes here 
```

希望这可以帮助！

# c# - 具有右锚定静态面板的可变高度 FlowLayoutPanel

> ID：14488453
> 
> 赞同：2
> 
> 时间：2013-01-23T20:09:38.507
> 
> 标签：c#, winforms, user-interface, docking, flowlayoutpanel

好好看看这个 ![数字](../Images/0d81ef6740ffd8fa19e74c7628d60797.png)

我有一个*顶部面板*，它停靠在`Top`我的表单 ( `AutoSize == True`, `AutoSizeMode == GrowOnly`) 上。在其中，我有一个停靠到( , ) 的*FlowLayoutPanel* ，以及停靠到( ) 的普通*静态面板*。*静态面板*有一个固定的宽度，但它的高度可以被拉伸。*FlowLayoutPanel*包含许多向右对齐的子元素。`Fill``AutoSize == True``AutoSizeMode == GrowOnly`*`Right``AutoSize == False`*

 ***我想要它，所以当用户将表单的大小调整到所有 FlowLayout 子级无法容纳在同一“行”上时，*FlowLayoutPanel*、*Top Panel*和*Static Panel*都在高度上增长以适应被截断的子级。行”，可能还有第三、第四等等。

就目前而言（在本例中），可能重叠的孩子被撞到第二条“线”，但没有一个高度可以显示出来。我在这些不同的面板中以各种方式摆弄了各种停靠和自动调整参数。

我认为这不会太难，但我无法仅使用设计时可用的功能来使其工作。也许这是不可能的，或者我错过了一些东西。谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-20T16:18:31.893

我尝试了多种方法。这对我有用：

用`TableLayoutPanel`( `Anchor= Top, Left, Right`, `ColumnCount=2` `RowCount=1`, `Autosize = True`, `AutosizeMode = GrowAndShrink`) 替换您的顶部面板，并为右列提供 x 像素的固定宽度（左列将调整为 100%）

在左栏中输入您的`FlowLayoutPanel`( `Autosize = True`, `AutosizeMode = GrowAndShrink`, `Anchor= Top, Left, Right`)

在右栏中放一个`Panel`( `Autosize = False`, `Anchor= Top, Bottom, Left, Right`)

这是它的外观：Blue= FlowLayoutPanel，Green=Panel

调整大小前 调整大小
![在此处输入图像描述](../Images/393f2841450e9ac5745f59b758266902.png) 后
![在此处输入图像描述](../Images/7b6c86e0ccc1633e3f71a9dddb06dec1.png)

不要忘记为您的表单设置最小宽度。或者它可能看起来像这样
![在此处输入图像描述](../Images/de2d169556b6a9685db85a0e75dd1d63.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-20T15:14:18.327

我在我的电脑上试过这个，看到你的问题。

造成这种情况的原因是您在混合嵌套控件的 AutoSize 和 Dock 属性时应该小心。

Flowlayoutpanel.Dock 设置为 Fill，因此它不能根据其中的控件增加大小。它只取决于其父级的大小。将 FOP 设置为 Dock = None 并改为使用锚点 - 上、左、右。

我能够在我的电脑上完成这项工作。如果您需要帮助，请告诉我。***

# java - 为什么 BitmapDecoder 不起作用？

> ID：14488456
> 
> 赞同：0
> 
> 时间：2013-01-23T20:09:41.067
> 
> 标签：java, android, url, bitmap

我正在尝试在互联网上下载一些图像并使用gridview将它们粘贴到屏幕中。但是当我使用BitmapDecoder选项时，图像不会出现。如果我不使用它（仅下载）图像出现在屏幕 ：/

```
 URL url = new URL(src);
 Rect padding = new Rect(8,8,8,8);
 HttpURLConnection connection = (HttpURLConnection) url.openConnection();
 connection.setDoInput(true);
 connection.connect();
 InputStream input = connection.getInputStream();
 final BitmapFactory.Options options = new BitmapFactory.Options();
 options.inJustDecodeBounds = true;
 BitmapFactory.decodeStream(input, padding , options);
 options.inSampleSize = calculateInSampleSize(options, 300, 300);
 options.inJustDecodeBounds = false;
return  BitmapFactory.decodeStream(input, padding, options); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:16:13.730

您不能从同一个输入流中解码两次。最好的选择是立即将文件保存到磁盘并从那里解码，或者将输入流读入字节数组，然后解码字节数组。

# php - PHP 在将复杂类型从客户端传递到服务器时遇到问题

> ID：14488463
> 
> 赞同：0
> 
> 时间：2013-01-23T20:09:59.073
> 
> 标签：php, soap, soap-client

我有以下客户端代码：

```
 $user = new SoapVar(array (
            "account-id" => 5,
            'first-name' => "Colby",
            'last-name' => "Meier",
            'email' => "colbymeier1337@gmail.com",
            'passwd' => "password",
            'user-type' => 2,
            'phone' => "555-555-1234",
            'mobile' => "555-555-1234",
            'website' => "http://www.notarealwebsite.com"
    ), XSD_ANYTYPE, "ns:CreateUserType", "http://192.168.1.120/Client_Billing.wsdl");

 $createUser = array (
        "session-id" => "testsession",
        "user" => $user
    );

 try {
    $test = $client->CreateUser(array("parameters"=>$createUser));
 } catch(Exception $ex) { //Request failed, print out why
    echo "<pre>Error:\n\t".$ex->getMessage()."\n</pre>";
 } 
```

不幸的是，我知道我做错了什么都是愚蠢的简单的事情，但对于我的生活，我无法找到它（对 Soap 来说非常新）。

我得到的错误信息是：

```
[Wed Jan 23 13:59:04 2013] [error] [client 192.168.1.141] PHP Fatal error:  SOAP-ERROR: Encoding: object has no 'session-id' property in /var/www/test_soap/client_avid_new.php on line 107, referer: http://192.168.1.120/test_soap/ 
```

相关 WSDL 信息：

```
<element name="CreateUser">
    <complexType>
        <sequence>
            <element name="session-id" type="xsd:string" minOccurs="1" maxOccurs="1"/>
            <element name="user" type="ns:CreateUserType" minOccurs="1" maxOccurs="1"/>
        </sequence>
    </complexType>
</element>
<complexType name="CreateUserType">
    <sequence>
        <element name="account-id" type="xsd:int" minOccurs="1" maxOccurs="1"/>
        <element name="first-name" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="last-name" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="email" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="passwd" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="user-type" type="xsd:int" minOccurs="1" maxOccurs="1"/>
        <element name="phone" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="mobile" type="xsd:string" minOccurs="1" maxOccurs="1"/>
        <element name="website" type="xsd:string" minOccurs="1" maxOccurs="1"/>
    </sequence>
</complexType> 
```

相关服务器代码：

```
class Client_Billing extends SoapClient {
    function __call ($function_name , $arguments) {
        $response = parent::__call ($function_name , $arguments);
        $this->httpsocket = NULL;
        return $response;
    }
    /**
     * Default class map for wsdl=>php
     * @access private
     * @var array
     */
    private static $classmap = array(
        "Results" => "Results",
        "CreatePlanType" => "CreatePlanType",
        "CreateUserType" => "CreateUserType",
        "UserType" => "UserType",
        "CreateAccountAddressType" => "CreateAccountAddressType",
        "AccountAddressType" => "AccountAddressType",
        "CreateResellerType" => "CreateResellerType",
        "CreateMarketingCenterType" => "CreateMarketingCenterType",
        "CCInfo" => "CCInfo",
        "FullAccountType" => "FullAccountType",
        "DateFormat" => "DateFormat",
        "Permissions" => "Permissions",
        "AuthedUser" => "AuthedUser",
        "StyleSheetRule" => "StyleSheetRule",
        "StyleSheet" => "StyleSheet",
        "CreatePermissionProfileType" => "CreatePermissionProfileType",
        "CreatePlan" => "CreatePlan",
        "CreatePlanResponse" => "CreatePlanResponse",
        "CreateUser" => "CreateUser",
        "CreateUserResult" => "CreateUserResult",
        "SaveUser" => "SaveUser",
        "SaveUserResult" => "SaveUserResult",
        "DeleteUser" => "DeleteUser",
        "DeleteUserResult" => "DeleteUserResult",
        "SuspendUser" => "SuspendUser",
        "SuspendUserResult" => "SuspendUserResult",
        "ActivateUser" => "ActivateUser",
        "ActivateUserResult" => "ActivateUserResult",
        "GetUsersForAccount" => "GetUsersForAccount",
        "GetUsersForAccountResult" => "GetUsersForAccountResult",
        "CreateAccountAddress" => "CreateAccountAddress",
        "CreateAccountAddressResponse" => "CreateAccountAddressResponse",
        "SaveAccountAddress" => "SaveAccountAddress",
        "SaveAccountAddressResponse" => "SaveAccountAddressResponse",
        "DeleteAccountAddress" => "DeleteAccountAddress",
        "DeleteAccountAddressResponse" => "DeleteAccountAddressResponse",
        "GetAddressesForAccount" => "GetAddressesForAccount",
        "GetAddressesForAccountResponse" => "GetAddressesForAccountResponse",
        "CreateReseller" => "CreateReseller",
        "CreateResellerResult" => "CreateResellerResult",
        "CreateMarketingCenter" => "CreateMarketingCenter",
        "CreateMarketingCenterResult" => "CreateMarketingCenterResult",
        "DeleteAccount" => "DeleteAccount",
        "DeleteAccountResult" => "DeleteAccountResult",
        "SuspendAccount" => "SuspendAccount",
        "SuspendAccountResult" => "SuspendAccountResult",
        "GetFullAccountDetails" => "GetFullAccountDetails",
        "GetFullAccountDetailsResult" => "GetFullAccountDetailsResult",
        "AuthUser" => "AuthUser",
        "AuthUserResult" => "AuthUserResult",
        "getNumberOfSignups" => "getNumberOfSignups",
        "getNumberOfSignupsResponse" => "getNumberOfSignupsResponse",
        "getNumberOfSignupsPerPlan" => "getNumberOfSignupsPerPlan",
        "getNumberOfSignupsPerPlanResponse" => "getNumberOfSignupsPerPlanResponse",
        "getRevenueByDateRange" => "getRevenueByDateRange",
        "getRevenueByDateRangeResponse" => "getRevenueByDateRangeResponse",
        "getRevenueByDateRangePerPlan" => "getRevenueByDateRangePerPlan",
        "getRevenueByDateRangePerPlanResponse" => "getRevenueByDateRangePerPlanResponse",
        "StoreStyleSheet" => "StoreStyleSheet",
        "StoreStyleSheetResult" => "StoreStyleSheetResult",
        "GetStyleSheet" => "GetStyleSheet",
        "GetStyleSheetResult" => "GetStyleSheetResult",
        "CreatePermissionProfile" => "CreatePermissionProfile",
        "CreatePermissionProfileResult" => "CreatePermissionProfileResult",
    );

    /**
     * Constructor using wsdl location and options array
     * @param string $wsdl WSDL location for this service
     * @param array $options Options for the SoapClient
     */
    public function __construct($wsdl="http://192.168.1.120/Client_Billing.wsdl", $options=array()) {
        foreach(self::$classmap as $wsdlClassName => $phpClassName) {
            if(!isset($options['classmap'][$wsdlClassName])) {
                $options['classmap'][$wsdlClassName] = $phpClassName;
            }
        }
        parent::__construct($wsdl, $options);
    }

    /**
     * Checks if an argument list matches against a valid argument type list
     * @param array $arguments The argument list to check
     * @param array $validParameters A list of valid argument types
     * @return boolean true if arguments match against validParameters
     * @throws Exception invalid function signature message
     */
    public function _checkArguments($arguments, $validParameters) {
        $variables = "";
        foreach ($arguments as $arg) {
            $type = gettype($arg);
            if ($type == "object") {
                $type = get_class($arg);
            }
            $variables .= "(".$type.")";
        }
        if (!in_array($variables, $validParameters)) {
            throw new Exception("Invalid parameter types: ".str_replace(")(", ", ", $variables));
        }
        return true;
    }

    /**
     * Service Call: CreateUser
     * Parameter options:
     * (CreateUser) parameters
     * @param mixed,... See function description for parameter options
     * @return CreateUserResult
     * @throws Exception invalid function signature message
     */
    public function CreateUser($mixed = null) {
        $validParameters = array(
            "(CreateUserType)",
        );
        $args = func_get_args();
        $this->_checkArguments($args, $validParameters);
        return $this->__call("CreateUser", $args);
    }

}}

$server = new SoapServer("http://192.168.1.120/Client_Billing.wsdl");
$server->setClass("Client_Billing");
$server->handle(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:31:24.717

所以我通过消除自己的白痴并发送

```
$test = $client->CreateUser($createUser); 
```

但现在我回到[这里发现的问题](https://stackoverflow.com/questions/14401578/php-soap-server-concatenating-array-items-in-dorequest)

# ruby-on-rails - 了解 Rails 验证：allow_blank 有什么作用？

> ID：14488465
> 
> 赞同：40
> 
> 时间：2013-01-23T20:10:01.747
> 
> 标签：ruby-on-rails

我对 Rails 很陌生，发现了一个小片段来逐步验证存在性和唯一性：首先检查存在性，然后检查唯一性。

```
validates :email, :presence => true, :allow_blank => true, :uniqueness => { :case_sensitive => false } 
```

`presence => true`我对一起使用和有点困惑`allow_blank => true`。

不使用`allow_blank => true`这两个规则将同时检查而不是一步一步。

为什么会`allow_blank => true`出现这种魔法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-23T21:53:03.637

您所拥有的与此等效（为清楚起见已包装）：

```
validates :email, :presence => true, 
            :uniqueness => { :allow_blank => true, :case_sensitive => false } 
```

这有点愚蠢，因为如果您需要存在，那么这将使 . 的`:allow_blank`子句“无效” `:uniqueness`。

当您切换到使用其他验证器时更有意义.. 说...`format`和`uniqueness`，但如果它是空白的，您不需要任何检查。在这种情况下，添加“全局应用”`:allow_blank`更有意义，并且 DRY 会稍微完善代码。

这...

```
validates :email, :format => {:allow_blank => true, ...}, 
                  :uniqueness => {:allow_blank => true, ...} 
```

可以写成：

```
validates :email, :allow_blank => true, :format => {...}, :uniqueness => {...} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-09-30T16:11:14.323

了解以下区别可能很有用：

```
presence: true                    # nil and empty string fail validation
presence: true, allow_blank: true # nil fails validation, empty string passes 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-19T20:15:18.823

`:allow_blank`是一个选项，它将“禁用”几个验证器，但不是存在验证器。将这两者结合使用的结果是，当该字段留空时，您将收到`:blank`错误消息（即“不能为空”），但不会收到其他错误消息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-24T15:37:45.243

在您的代码中，`:presence =>`并且`:uniqueness =>`是验证器，while`:allow_blank =>`是传递给其他验证器的默认选项。

所以你的代码：

```
validates(
    :email,
    :presence => true,
    :allow_blank => true,
    :uniqueness => { :case_sensitive => false }
) 
```

相当于这段代码：

```
validates(
    :email,
    :presence => { :allow_blank => true },
    :uniqueness => { :allow_blank => true, :case_sensitive => false }
) 
```

但是，`presence`验证器会忽略该`allow_blank`选项，因此您的代码最终基本上是这样的：

```
validates(
    :email,
    :presence => { }, # `{ }` is equivalent to `true`
    :uniqueness => { :allow_blank => true, :case_sensitive => false }
) 
```

输入意味着当电子邮件为空白时，`:allow_blank => true`将不会运行验证。`:uniqueness``uniqueness`

这样做的一个效果是您消除了数据库查询。

例如，*如果没有*条件，`:allow_blank => true`您会看到：

```
>> user = User.new(email: nil)
>> user.valid?
  User Exists (0.2ms) SELECT  1 AS one FROM "users" WHERE "users"."name" IS NULL LIMIT 1
=> false
>> user.errors.messages
=> {:email=>["can't be blank"]} 
```

但是*使用*该`:allow_blank => true`选项，您将不会看到`User Exists`数据库查询发生。

*当您的数据库中已有*包含空白电子邮件地址的记录时，会发生另一个极端情况的副作用。在这种情况下，如果您在验证器上*没有*`:allow_blank => true`选项`uniqueness`，那么您会看到返回两个错误：

```
>> user = User.new(email: nil)
>> user.valid?
  User Exists (0.2ms) SELECT  1 AS one FROM "users" WHERE "users"."name" IS NULL LIMIT 1
=> false
>> user.errors.messages
=> {:email=>["has already been taken", "can't be blank"]} 
```

但是*使用*该`:allow_blank => true`选项，您只会看到`"can't be blank"`错误（因为当电子邮件为空白时，唯一性验证不会运行）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-07T03:37:18.463

> 来自 Rails 注释

```
# * <tt>:allow_nil</tt> - Skip validation if the attribute is +nil+.
# * <tt>:allow_blank</tt> - Skip validation if the attribute is blank. 
```

因此，这意味着当我们`allow_blank`在电子邮件上使用时，如果电子邮件为 nil，则仅向`errors`对象添加一个错误，跳转唯一性验证。

# iphone - 您可以将动态 UITableView 拆分为多个部分吗？

> ID：14488467
> 
> 赞同：1
> 
> 时间：2013-01-23T20:10:04.210
> 
> 标签：iphone, ios, ipad, uitableview

我试图在输入动态 UITableView 的两种不同类型的数据之间放置一个符号。我是否允许将数据分成两部分，或者我只需要输入一个非 userInteractionEnabled 单元格来标记拆分？我无法以编程方式设置 numberOfSections 属性。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:37:51.827

您要做的是创建一个分组表视图，确保在您的界面构建器中为您的表视图选择了分组表视图选项

然后调用分组表视图方法，例如

```
// for sections I guess you want 2 sections 
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 2;
}

- (NSInteger)tableView:(UITableView *)tableView
 numberOfRowsInSection:(NSInteger)section {
     if(section==0)
       return [yourdatasource count]; // make sure that each section is returned here
     if(section==1)
       return [anotherdatasource count];
}

// set header height of gropued tableview
-(CGFloat)tableView:(UITableView*)tableView heightForHeaderInSection:(NSInteger)section {

    return 60.0; // choose your height for each section
}
//set header section labels
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
} 
```

我的代码未经测试，

查看此[http://www.mobisoftinfotech.com/blog/iphone/iphone-uitableview-tutorial-grouped-table/](http://www.mobisoftinfotech.com/blog/iphone/iphone-uitableview-tutorial-grouped-table/)了解更多信息

# php - 从android上传多个图像到php脚本

> ID：14488469
> 
> 赞同：0
> 
> 时间：2013-01-23T20:10:13.770
> 
> 标签：php, image, file, upload, http-post

我使用最新的 apache HTTPmultipart 将多个图像从 android 发布到 PHP 脚本。

我在android中创建了一个循环来加载这样的多部分：

```
try {

            HttpClient client = new DefaultHttpClient();
            HttpPost post = new HttpPost(urlServer);
            MultipartEntity mpEntity = new MultipartEntity();

            //Loop to add images    
            for (int i = 0; i<selectedList.size(); i++) {
                File passFile = selectedList.get(i);
                ContentBody cbFile = new FileBody(passFile, "image/png");
                String partName = "image" + i;
                mpEntity.addPart(partName, cbFile);

            } 
```

这工作正常，并使用以下代码将图像加载到我的 PHP 中以获取第一张图像：

```
uploadDir = './';      //Uploading to directory specified

$file = basename($_FILES['image0']['name']);

$uploadFile = $file;
$randomNumber = rand(0, 99999999999); 
$newName = $uploadDir . $randomNumber . $uploadFile;

if (is_uploaded_file($_FILES['image0']['tmp_name'])) {
    echo "Temp file uploaded. \r\n";
} else {
    echo "Temp file not uploaded. \r\n";
}

if ($_FILES['image']['size']> 100000000) {
    exit("Your file is too large."); 
}

if (move_uploaded_file($_FILES['image0']['tmp_name'], $newName)) {
    $maxsize = ini_get('upload_max_filesize');
    echo json_encode(
        array(
            'result'=>$newName,
            'msg'=>'Report added successfully.'
            )
        ); 
```

我遇到了问题，但是将更多图像放入 PHP。我尝试了以下方法：

```
$currentName = 'image' + 0;
$file = basename($_FILES[$currentName]['name']); 
```

但这不起作用。将创建一个循环，因此上面的 0 将被 i 替换，但这在创建文件时无法识别。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:50:57.843

连接使用点而不是加号。

```
$currentName = 'image'.$i; 
```

'image'+0 只是 0。然后将 'image0' 替换为 $currentName。不要忘记修复以下行，你应该使用'image0'，而不是'image'

```
if ($_FILES['image']['size'])... 
```

# wpf - 将所有键盘和鼠标输入从 wpf-host 应用程序传递到托管的进程外 win32 客户端。（使用 HwndHost）

> ID：14488470
> 
> 赞同：0
> 
> 时间：2013-01-23T20:10:17.813
> 
> 标签：wpf, winapi, keyboard, mouse, hwndhost

我有一个旧应用程序（游戏），它从位置 0、0 开始，并且是对话框样式的。不能以常规方式移动它，不能调整大小，非常烦人。我无法访问源代码，只能访问已编译的应用程序。

我使用 HwndHost 以 wpf 形式托管此应用程序，效果很好。非常平滑地调整窗口大小和移动窗口。

麻烦的是我需要所有的键盘和鼠标输入，而我的 wpf 表单具有焦点，才能传递给托管应用程序。

我不需要过滤任何消息或任何其他花哨的东西，只需要我的 wpf 表单变得愚蠢并忽略所有内容，而托管进程获取所有输入。

最好的方法是什么？

由于它不在进程中，我知道这可能会导致一些问题，但我希望那里有一个简单的解决方案。

有趣的是，我确实在托管应用程序中看到了鼠标移动（特别是在应用程序光标中），但它似乎错过了点击和/或键盘输入。

谢谢！

休伦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T11:14:54.707

由于这给我造成的所有问题，我决定使用另一种方法。我现在在 winform 中托管进程外应用程序，而不是使用 hwndhost 的 wpf 表单。

这会导致托管应用程序自动接收键盘和鼠标的所有输入。

让我的工作轻松多了。

唯一的缺点是调整大小很难与我在 wpf hwndhost 中调整大小相提并论。但我可以忍受，无论如何移动应用程序是我的首要任务。

# javascript - 在站点负载上运行 javascript

> ID：14488472
> 
> 赞同：1
> 
> 时间：2013-01-23T20:10:32.880
> 
> 标签：javascript, jquery, css

我在使用 java/css 选项卡式菜单系统时遇到了一些困难。我已经启动并运行了一段时间的菜单，但我最近尝试向其中一个页面添加一个新的图表系统，但我发现很难让它正确显示。

我已将其追溯到一个所需的 css 条目，以防止显示所有选项卡式内容，直到您将鼠标悬停在每个选项卡上。CSS如下：

```
div.tabscontainer div.curvedContainer .tabcontent{
display:none;
padding:20px;
font-size:12px;
font-family: "CenturyGothicRegular", "Century Gothic", Arial, Helvetica, sans-serif;
} 
```

如前所述， display:none 会阻止显示所有内容，直到您将鼠标悬停在其中一个选项卡上。然而，同样的 display:none 会阻止我的图表脚本正确绘制图表。如果我将 display:none 注释掉，则图表绘制正确，但所有选项卡式内容都显示在页面加载时。第 22 条渔获物。

但是，如果我将 display:none 注释掉，然后将鼠标悬停在任何菜单选项卡上，则会运行以下 javascript 并根据需要正确隐藏或显示所有相应内容：

```
<script language="JavaScript">
$(document).ready(function() {
    $(".tabs .tab[id^=tab_menu]").hover(function() {
        var curMenu=$(this);
        $(".tabs .tab[id^=tab_menu]").removeClass("selected");
        curMenu.addClass("selected");

        var index=curMenu.attr("id").split("tab_menu_")[1];
        $(".curvedContainer .tabcontent").css("display","none");
        $(".curvedContainer #tab_content_"+index).css("display","block");
    });
});
</script> 
```

我可以以某种伪代码的方式理解脚本在做什么，它正在更改选项卡本身的属性（添加/删除“选定的类”）以使其在更改属性时显示为“突出显示”内容容器（添加/删除显示：无或阻止）以隐藏或显示每个选项卡的内容（如适用）。

我现在的想法是，如果我添加上述脚本的修改版本以在页面加载时运行并自动选择第一个选项卡，那么我可以从 CSS 中删除全局 display:none 并允许 javascript 对其进行排序.

最后，这引出了我的问题。我还是 javascript 的新手，我正在尝试弄清楚如何修改上面的代码以反映我需要它在页面加载时自动选择给定菜单 (tab_menu_50)，同时仍然允许用户将鼠标悬停在任何标签。

您可以提供的任何指示都会很高兴地被接受，如果以上任何内容都没有任何意义，我提前道歉！（不过，如果你能告诉我我完全错了，我也将不胜感激！）

乔纳森

已尝试删除所有内容，但仍对站点结构有所了解，希望这有助于找到答案。可能有一些错误的标签，但这只是因为我刚刚完成的黑客工作允许我在这里发布一些 html...

```
<html>
<head>

# Below script enables tab switch on mouseover

<script language="JavaScript">
$(document).ready(function() {
$(".tabs .tab[id^=tab_menu]").hover(function() {
    var curMenu=$(this);
    $(".tabs .tab[id^=tab_menu]").removeClass("selected");
    curMenu.addClass("selected");

    var index=curMenu.attr("id").split("tab_menu_")[1];
    $(".curvedContainer .tabcontent").css("display","none");
    $(".curvedContainer #tab_content_"+index).css("display","block");
});
});
</script>

# Below script draws the chart

<script type="text/javascript">
    $(function(){
    $('.charttable').visualize({type: 'line'});
    });
</script>

<style>

# Below style sheet contains the problematic entry of display:none

div.tabscontainer div.curvedContainer .tabcontent{
display:none;
padding:20px;
font-size:12px;
font-family: "CenturyGothicRegular", "Century Gothic", Arial, Helvetica, sans-serif;
}

</head>

<body>

<div class="tabscontainer">
    <div class="tabs">
        <div class="tab first selected" id="tab_menu_50">
            <div class="link">Home</div>
            <div class="arrow"></div>
        </div>
        <div class="tab" id="tab_menu_150">
            <div class="link">Screen2</div>
            <div class="arrow"></div>
        </div>
        <div class="tab last" id="tab_menu_250">
            <div class="link">Screen3</div>
            <div class="arrow"></div>
        </div>
    </div>
    <div class="curvedContainer">
        <div class="tabcontent" id="tab_content_50">
        </div>
        <div class="tabcontent" id="tab_content_150">
        </div>
        <div class="tabcontent" id="tab_content_250">
<table class="charttable">
    <caption>Visits from August 16 to August 21</caption>
    <thead>
    <tr>
        <td></td>
        <th scope="col">chartlabel1</th>
        <th scope="col">chartlabel2</th>
        <th scope="col">chartlabel3</th>
        <th scope="col">chartlabel4</th>
        <th scope="col">chartlabel5</th>
        <th scope="col">chartlabel6</th>
        <th scope="col">chartlabel7</th>
    </tr>
</thead>
<tbody>
    <tr>
        <th scope="row">SuiteA</th>
        <td>54</td>
        <td>49</td>
        <td>52</td>
        <td>61</td>
        <td>44</td>
        <td>57</td>
        <td>61</td>
    </tr>
    <tr>
        <th scope="row">SuiteB</th>
        <td>12</td>
        <td>11</td>
        <td>5</td>
        <td>13</td>
        <td>11</td>
        <td>10</td>
        <td>9</td>
    </tr>
    <tr>
        <th scope="row">SuiteC</th>
        <td>73</td>
        <td>67</td>
        <td>64</td>
        <td>74</td>
        <td>61</td>
        <td>73</td>
        <td>75</td>
    </tr>
 </tbody>
</table>
</div>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:17:13.240

如果我正确理解您的问题，您可能想使用可见性：隐藏而不是显示：无。

如果您设置 display:none，则无法在这些节点上进行某些计算，除非维度被明确编码；计算尺寸（无法在所有浏览器中以可靠的方式计算没有固定宽度或高度的节点）。

将节点设置为可见性：隐藏本质上将其不透明度设置为 0，同时将其及其尺寸保留在文档中。

尝试更换 display: none; 可见性：隐藏

希望应该工作。如果没有，您也可以尝试通过在文档加载时使用 jquery 的 .hide() 方法来设置其可见性。

```
$("div.tabscontainer div.curvedContainer .tabcontent").hide() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:20:48.877

在示例代码中绑定悬停事件*后*，只需在 DOM 就绪时触发事件：

```
$(function(){
    $('#desiredTab').trigger('mouseover');
}); 
```

演示：http: [//jsfiddle.net/LC2un/](http://jsfiddle.net/LC2un/)

# linux - bash 合并开头和结尾相同的行

> ID：14488473
> 
> 赞同：1
> 
> 时间：2013-01-23T20:10:34.590
> 
> 标签：linux, bash, shell, sed, awk

伙计们，我怎样才能打开这个文件：

```
ops01.mysite.com /dev/mapper/sys-home 7700480  602202 7098278    8% /home
ops01.mysite.com /dev/mapper/sys-tmp   512000     471  511529    1% /tmp
ops01.mysite.com /dev/mapper/sys-var   512000    3236  508764    1% /var
ops01.mysite.com /dev/mapper/sys-home   58G   26G   30G  47% /home
ops01.mysite.com /dev/mapper/sys-tmp   3.9G  2.3G  1.5G  61% /tmp
ops01.mysite.com /dev/mapper/sys-var   3.9G  533M  3.2G  15% /var
ops02.mysite.com /dev/mapper/sys-home 3424256  250425 3173831    8% /home
ops02.mysite.com /dev/mapper/sys-tmp   262144      17  262127    1% /tmp
ops02.mysite.com /dev/mapper/sys-var   262144    2647  259497    2% /var
ops02.mysite.com /dev/mapper/sys-home   52G  9.5G   40G  20% /home
ops02.mysite.com /dev/mapper/sys-tmp   4.0G  137M  3.7G   4% /tmp
ops02.mysite.com /dev/mapper/sys-var   4.0G  419M  3.4G  11% /var 
```

进入这个：

```
ops01.mysite.com /dev/mapper/sys-home 7700480  602202 7098278    8% /home   ops01.mysite.com /dev/mapper/sys-home   58G   26G   30G  47% /home
ops01.mysite.com /dev/mapper/sys-tmp   512000     471  511529    1% /tmp    ops01.mysite.com /dev/mapper/sys-tmp   3.9G  2.3G  1.5G  61% /tmp
ops01.mysite.com /dev/mapper/sys-var   512000    3236  508764    1% /var    ops01.mysite.com /dev/mapper/sys-var   3.9G  533M  3.2G  15% /var
ops02.mysite.com /dev/mapper/sys-home 3424256  250425 3173831    8% /home   ops02.mysite.com /dev/mapper/sys-home   52G  9.5G   40G  20% /home
ops02.mysite.com /dev/mapper/sys-tmp   262144      17  262127    1% /tmp    ops02.mysite.com /dev/mapper/sys-tmp   4.0G  137M  3.7G   4% /tmp
ops02.mysite.com /dev/mapper/sys-var   262144    2647  259497    2% /var    ops02.mysite.com /dev/mapper/sys-var   4.0G  419M  3.4G  11% /var 
```

因此，当目录相同时，合并这些行（在 OSX 中， df 命令输出 inode 和空间使用情况，但在我使用的这个 redhat 中，我必须运行一个 df -h 用于空间使用，一个 df -我获取 inode 使用情况）

我用过：

```
cat file | sed 's/[0-9]% /*\n/ /' 
```

尝试在下一行中的文本的每个 '%' 之后替换文本......但这根本不起作用......：S 我只是无法通过 'ops01.mysite.com' 过滤，因为我不知道我要检查多少台服务器。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T07:45:32.937

```
awk '{a[$1$2]=a[$1$2]" "$0;next}END{for(i in a){print a[i]}}' your_file 
```

[在这里](http://ideone.com/f8d6cs)检查

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:19:49.850

分别运行 2 个`df`命令，将它们的结果保存到单独的文件，然后`join`是两个文件。

```
df > df-size
df -i > df-inodes
join df-size df-inodes 
```

# list - 如何设计 DevExpress “详细信息选项卡”并通过列表填充它？

> ID：14488479
> 
> 赞同：0
> 
> 时间：2013-01-23T20:11:00.467
> 
> 标签：list, devexpress, datasource, master-detail

我是使用 DevExpress 工具的新手。我设计了一个 GridControl，它在下一级有一个主 GridView 和三个其他 Gridview。我打开了主 GridView 的选项：EnableMasterViewMode = True 和 EnableDetailToolTip = true。

我想设计类似的东西： [http ://demos.devexpress.com/ASPxGridViewDemos/MasterDetail/Det​​ailTabs.aspx](http://demos.devexpress.com/ASPxGridViewDemos/MasterDetail/DetailTabs.aspx)

所以：

1.  当我运行项目时，我的设计只是呈现了第一层，我如何才能看到上一个链接中出现的嵌套网格的视图？

2.  我将在网格中绑定的数据在运行时存储在列表中，而不是在数据库中，那么我如何从该列表而不是数据库中填充网格单元格和列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T06:19:22.517

[资源：](http://www.devexpress.com/Support/Center/p/Q93769.aspx)

如果您使用的是 WinForms，请查看以下帮助主题：[将控件绑定到运行时创建的数据](http://documentation.devexpress.com/#CoreLibraries/CustomDocument2387)， [如何：将控件绑定到运行时创建的数据](http://documentation.devexpress.com/#CoreLibraries/CustomDocument2389)。

`GridControl`自动将返回集合的属性视为主从关系。因此，您只应在您的类中实现相应的属性并将主集合分配给该`GridControl.DataSource`属性，就像您为标准 .Net DataGridView 控件所做的那样。此任务并非特定于我们的 XtraGrid。也请尝试 XtraGrid 附带的 GridTutorials 项目的 GridUnboundMasterView 模块。

Grid 仅在其根级别为实现 IList 接口的属性创建详细视图。此行为在[GridControl 中进行了描述 - 如果详细信息集合类型是从 IList](http://www.devexpress.com/Support/Center/p/Q450324.aspx)票证继承的接口类型，则现在创建详细信息视图。推荐的方法是与 IList 一起实现 IList 接口。在这种情况下，网格将自动创建详细视图，如[通过集合属性](http://documentation.devexpress.com/#WindowsForms/CustomDocument5496)帮助主题实现对象的主从关系中所述。[您还可以通过此处](http://documentation.devexpress.com/#WindowsForms/CustomDocument732)描述的事件提供主从关系。

示例代码片段：

```
gridControl1.DataSource = new NestedRecords();
//... 
public class NestedRecords : ArrayList {
    public NestedRecords() {
        Add(new NestedRecord("Customers", new ChildRecordsCustomers()));
        Add(new NestedRecord("Products", new ChildRecordsProducts()));
        Add(new NestedRecord("Shippers", new ChildRecordsShippers()));
    }
    public virtual new NestedRecord this[int index] {
        get { return (NestedRecord)(base[index]); }
    }
} 
```

参考：
[具有 IList 属性的](http://www.devexpress.com/Support/Center/p/Q130400.aspx)
[主详细信息 使用 iList](http://www.devexpress.com/Support/Center/p/Q295225.aspx)
[的主详细信息 如何使用 Ilist 创建主详细信息网格控件 XtraGrid](http://www.devexpress.com/Support/Center/p/Q453850.aspx)
[如何检测主详细信息网格的集合](http://www.devexpress.com/Support/Center/p/Q385648.aspx)

如果您使用的是 WebForms，请查看以下文档帮助主题：[主从关系](http://documentation.devexpress.com/#AspNet/CustomDocument3772)并尝试实现获取集合 dataSource 而不是 dataTable。

# c# - 命名系统互斥锁无法识别

> ID：14488481
> 
> 赞同：3
> 
> 时间：2013-01-23T20:11:07.557
> 
> 标签：c#, .net, mutex

我正在尝试命名系统互斥锁方法来同步两个进程-

1.  ac#windows服务
2.  一个桌面 C# 应用程序

创建互斥锁时，未创建互斥锁的进程似乎没有检测到现有的互斥锁。下面更详细的：

Windows 服务负责创建互斥体（无前缀-全局/本地等。只是一个普通的命名系统互斥体），如下所示：

```
 Mutex myMutex= null;
        try
        {
            myMutex= Mutex.OpenExisting(myMutexName);

        }
        catch (WaitHandleCannotBeOpenedException x)
        {
            //doesn't exist. 
            try
            {
                this.GetLogger().Info("Create Mutex");
                bool createdNew = false;
                new Mutex(false, myMutexName, out createdNew);
                if (!createdNew) throw new Exception("Unable to create Mutex");

            }
            catch (Exception ex)
            {
                this.Stop();
            }

        }
        catch (Exception x)
        {
            this.Stop();
        }
        finally
        {

            if (myMutex!= null)
            {
                try
                {
                    myMutex.ReleaseMutex();
                }
                catch(Exception x)
                {
                    this.GetLogger().Warn("Unable to release mutex");
                }
            }
        } 
```

我在 onStart() 中有这个。此外，我在此互斥锁上同步服务的其他地方。

现在，在应用程序中，我这样使用它：

```
 Mutex myMutex= null;

        try
        {
            myMutex= Mutex.OpenExisting(this.myMutexName);
            myMutex.WaitOne();
//do required stuff

        }
        catch (WaitHandleCannotBeOpenedException wcbox)
        {
            //doesn't exist yet. service not running??
            this.GetLogger().Error("Background Service is not Running");
            shutdownApp();
        }
        finally
        {
            if (myMutex!= null)
            {
                try
                {
                    myMutex.ReleaseMutex();
                }
                catch (Exception x)
                {
                }
            }
        } 
```

我的问题：

1.  随着服务的运行，应用程序抛出 WaitHandleCannotBeOpenedException，这意味着它看不到存在的互斥体（我使用工具“WinObj”验证了这一点，互斥体存在于“BaseNamedObjects”下作为“Mutant”类型）。为什么？我在登录时使用相同的帐户运行该服务。即使没有，这也不应该是问题，因为命名互斥锁是操作系统范围的对象，对吗？

2.  我不清楚互斥锁何时会被破坏。目前，我看到当我启动服务时创建了互斥锁，当我停止服务时，我看到互斥锁不再存在（WinObj）。这是否意味着当没有人在等待互斥锁并且创建者进程结束时，它会被垃圾收集？

3.  一般来说，命名系统互斥体的生命周期是什么。具体来说，它什么时候死？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:10:08.747

Since you want to share a mutex across sessions you must use either the `Global` namespace, or create your [own private namespace](http://msdn.microsoft.com/en-us/library/ms684295.aspx).

As it stands, you are not specifying a namespace. And whilst the service defaults to use the global namespace, your interactive application will be using the local namespace.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-12-01T03:24:39.613

@david 我使用了一个名为 google 的工具来轻松找到它，我们正在生产中运行交互式服务检测，并启用了交互式服务。除非您切换该注册表项，否则无法启动交互式服务检测。我不知道这里的争论是什么：它就在那里，它有记录，谷歌可以很容易地指出它。

# javascript - HTTP 基本身份验证 - 服务器说？

> ID：14488483
> 
> 赞同：0
> 
> 时间：2013-01-23T20:11:12.933
> 
> 标签：javascript, html, basic-authentication

> **可能重复：**
> [通过表单发送基本身份验证信息](https://stackoverflow.com/questions/4460543/sending-basic-authentication-information-via-form)

当使用基本身份验证连接到 Web 文件夹时，服务器可以对您“说”一些东西。

例如，当您尝试访问 example.com 上的受限文件夹时，您会收到一个警告框，上面写着：

> 服务器[http://domain.com](http://domain.com)需要用户名和密码。服务员说：**你好**

有没有办法通过 javascript 或 html5 查看响应？（在这种情况下**你好**）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:15:21.480

我相信基本身份验证只能通过浏览器的界面提交。要拥有一个受限访问区域，最好的办法是拥有一个提交给基本身份验证的页面。

[通过表单发送基本认证信息](https://stackoverflow.com/questions/4460543/sending-basic-authentication-information-via-form)

我相信这应该可以解决您的问题。

# php - 从表单返回结果作为拆分数组

> ID：14488488
> 
> 赞同：0
> 
> 时间：2013-01-23T20:11:25.583
> 
> 标签：php, loops, foreach

我正在尝试自定义现有的开源脚本并遇到障碍。在处理文件中，我使用以下行从他们提交的表单中检索用户的输入。

```
$listingKeywords = $_POST["listingKeywords"]; 
```

用户被要求在表格中输入关键字，每个关键字之间用逗号隔开（例如：关键字一，关键字二）。在处理文件中，我有以下...

```
$keyword_list = array(
'1'=>"HTML5",
'2'=>"CSS3",
'3'=>"PHP",
); 
```

稍后会像这样使用它：

```
foreach ($keyword_list as $key=>$value) 
```

基本上我正在寻找一种用逗号分隔 $listingKeywords 的方法，然后通过 $i++ 设置 $key。我知道这很简单，我只是要求有人指出我正确的方向。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:14:03.283

`$arr = explode("," $content);`

这是你想要的吗？

只要记住`trim`在将它们放入数据库之前使用，人们往往会使用`value1, value2, value3`

# java - 十六进制验证算法

> ID：14488501
> 
> 赞同：-1
> 
> 时间：2013-01-23T20:12:23.133
> 
> 标签：java, algorithm

我正在尝试验证一个十六进制数字，但它的进展并不顺利。我正在尝试下面的代码，但我的逻辑并不完全正确。有什么帮助吗？

```
if (!array[i].equals("A") || !array[i].equals("B") || !array[i].equals("C") || !array[i].equals("D") || !array[i].equals("E") || !array[i].equals("F")) 
  {
  b[i] = false;
  }
  else
  {
  b[i] = true;
  } 
```

上述代码的目的是给我一个真值或假值。True 表示值在 A 到 F 之间 false 表示值不在 A 到 F 之间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:16:19.960

```
if ((array[i]-'A') > 5)
b[i]=false;
else 
b[i]=true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:14:30.897

全部更改`||`为`&&`.

现在你的`if`条件总是计算为`true`（因为*任何*字符串都不等于`"A"`or `"B"`）。

或者，将整个构造替换为：

```
b[i] = array[i].equals("A") || array[i].equals("B") || array[i].equals("C") ||
       array[i].equals("D") || array[i].equals("E") || array[i].equals("F"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:16:39.307

```
if (array[i].equals("A") || array[i].equals("B") || array[i].equals("C") || array[i].equals("D") || array[i].equals("E") || array[i].equals("F")) 
{ b[i] = true; }
else 
{ b[i] = false; } 
```

或者，您也可以使用 a`List`和使用[`.contains()`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#contains%28java.lang.Object%29)。

```
List<String> hexchars = new ArrayList<String>();
hexchars.add("A");
hexchars.add("B");
hexchars.add("C");
hexchars.add("D");
hexchars.add("E");
hexchars.add("F");
return hexchars.contains("A"); 
```

但从长远来看，正则表达式将是最干净的方法。

# android - Android 更新小部件 ListView

> ID：14488502
> 
> 赞同：1
> 
> 时间：2013-01-23T20:12:30.377
> 
> 标签：android, service, android-listview, refresh

我正在开发一个带有我想定期更新的小部件的应用程序。我设置了 android:updatePeriodMillis="3600000" 但我的 ListView 没有更新。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:25:26.840

您能否检查一下您的 onUpdate(...) 函数是否被调用。如果在更新周期后调用 onUpdate()，则需要调用`notifyAppWidgetViewDataChanged()`ListView 的适配器；为了更新它。

```
AppWidgetManager mgr = AppWidgetManager.getInstance(context); 
int[] ids = mgr.getAppWidgetIds(new ComponentName(context, AppWidgetProvider.class));
mgr.notifyAppWidgetViewDataChanged(yourWidgetId, R.id.list_view); 
```

# ios - IOS无法正确解码json格式的emoji unicode，Emoji图标显示为方块

> ID：14488503
> 
> 赞同：5
> 
> 时间：2013-01-23T20:12:31.413
> 
> 标签：ios, encode, json, emoji, utf8mb4

我正在开发一个 iPhone 应用程序，该应用程序允许人们使用 Emoji 图标发送消息。我用字符集utf8mb4和排序规则utf8mb4_unicode_ci将图标保存在Mysql中，并且所有表情符号图标都正确保存在我的数据库中。但是，当我将 json 返回到客户端 (php json_encode) 时，表情符号被编码为如下所示：'\ud83d\ude04'，iPhone 将其显示为正方形。但是，如果我以 XML 格式返回，表情符号图标不会变成这样的 unicode：'\ud83d\ude04'，它只是图标。

我想知道这是我的服务器上还是我的客户端上的问题。如果是我的客户，对象 c 如何正确解码。

有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T21:17:00.203

`"\ud83d\ude04"`是 的 JSON Unicode 转义序列`U+D83D U+DE04`，它是 Unicode U+1F604（张开嘴和微笑眼睛的微笑脸）的“代理对”。

但`NSJSONSerialization`可以正确解码，如下例所示：

```
const char *jsonString = "{ \"emoji\": \"\\ud83d\\ude04\" }";
NSLog(@"JSON: %s", jsonString);
NSData *jsonData = [NSData dataWithBytes:jsonString length:strlen(jsonString)];
NSError *error;
NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error];
self.myLabel.text = [jsonDict objectForKey:@"emoji"];
NSLog(@"Emoji: %@", self.myLabel.text); 
```

*输出：*

```
JSON: { "emoji": "\ud83d\ude04" }
Emoji: 
```

并且表情符号也正确显示（用 iPhone 设备和模拟器测试）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-14T12:52:42.673

请按照以下步骤操作：

*   将 Emoji 字符转换为 base64 并使用 Json 发送到服务器。
*   在服务器端将 base64 保存在数据库中，无需解码。
*   当您想在应用程序上显示表情符号时，请从服务器检索相同的 base64 数据。
*   解码检索字符串并在应用程序上显示。
*   您的表情符号字符将正确显示。

注意：当您想在网页上显示时，当您在网页上显示数据时解码数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-04T10:05:48.680

我们的团队通过将 utf 数据传输到服务器，将它们保存在 mysql utf8mb4 代码页并使用 base64 接收来解决此问题。服务器按需将保存的数据转换为base64。

# mysql - SQL：连接中的限制和随机化结果

> ID：14488504
> 
> 赞同：1
> 
> 时间：2013-01-23T20:12:36.177
> 
> 标签：mysql, select, join, random, limit

我正在构建一个购物系统，可以在附近位置查找商品。基本上，每个位置（供应商）在一个名为 Location 的表中都有一个条目，其中包含名称、纬度、经度和其他列......然后有一个项目表，带有一个外键，用于标识项目所属的位置至。

基本上，我想找到用户附近的所有项目：我可以使用以下查询来完成：

但是我想做以下事情 - 随机选择该位置的项目 - 将每个位置的项目数量限制为几个（比如 5 个） - 随机化所有结果，以便它们不会按位置分组

到目前为止，这是我已经完成的必须困难的查询，我正在变得更好，但我非常坚持这个 - 如果非常感谢任何帮助！谢谢你！！

到目前为止，这是我的选择声明：

```
SELECT Location.idLocation
 , Location.locationName
 , Location.tagline
 , Location.tags
 , Location.shortAddress
 , (3959 * acos(cos(radians('40.181')) * cos(radians(Location.latitude)) * cos(radians(Location.longitude) - radians('-74.0265')) + sin(radians('40.181')) * sin(radians(Location.latitude)))) AS distance
 , Item.idItem
 , Item.dateAdded
 , Item.fidLocation
 , Item.itemName
 , Item.description
 , Item.fullImageName
 , Item.thumbnailImageName
FROM
  Location
INNER JOIN Item
ON Location.idLocation = Item.fidLocation
HAVING distance < '1000' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:58:42.053

```
SET @local = 0;
SET @group = 0;

SELECT Location.idLocation
 , Location.locationName
 , Location.tagline
 , Location.tags
 , Location.shortAddress
 , (3959 * acos(cos(radians('40.181')) * cos(radians(Location.latitude)) * cos(radians(Location.longitude) - radians('-74.0265')) + sin(radians('40.181')) * sin(radians(Location.latitude)))) AS distance
 , Item.idItem
 , Item.dateAdded
 , Item.fidLocation
 , Item.itemName
 , Item.description
 , Item.fullImageName
 , Item.thumbnailImageName
 , @level := IF(@group = idLocation, @level+1, 1) AS level
 , @group := idLocation as tempGroup 
FROM
  Location
INNER JOIN Item
ON Location.idLocation = Item.fidLocation
order by idLocation, RAND(),
HAVING distance < '1000' AND level <= 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:38:34.177

好的。这是基于假设的未经测试的版本。

```
SELECT
  Location.idLocation,
  Location.locationName,
  Location.tagline,
  Location.tags,
  Location.shortAddress,
  (3959 * acos(cos(radians('40.181')) * cos(radians(Location.latitude)) * cos(radians(Location.longitude) - radians('-74.0265')) + sin(radians('40.181')) * sin(radians(Location.latitude)))) AS distance,
  Item.idItem,
  Item.dateAdded,
  Item.fidLocation,
  Item.itemName,
  Item.description,
  Item.fullImageName,
  Item.thumbnailImageName
FROM Location
  INNER JOIN (select *
          from Item
          order by RAND()
          limit 5) as Item
    ON Location.idLocation = Item.fidLocation
ORDER BY RAND()
HAVING distance < '1000' 
```

# iphone - 即使在 viewDIdAppear 中，iPad Childviews 在横向模式下仍然会看到不正确的边界

> ID：14488506
> 
> 赞同：0
> 
> 时间：2013-01-23T20:12:47.753
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我在视图控制器中创建了 2 个子视图，以便基于 2 个不同的按钮在彼此之间交换。

a la，按钮 1 显示 childview1 等。

但是，当我以横向模式启动应用程序并在 viewDidAppear 中打印出子视图的边界时，边界仍然不正确。

所以基本上，

1.  在视图控制器的 viewDidAppear 方法中，我创建了 2 个子视图，然后我立即在此处为视图控制器打印出边界。他们是正确的。

2.  在 childviewcontroller 的 viewDidAppear 方法中，我还打印出边界，因为我知道它们对于父级是正确的并且它们仍然不正确。

所以输出看起来像这样..

```
ViewController Bounds Height2:748.000000 Width: 1024.000000   
Child Bounds Height:1004.000000 Width: 768.000000 
```

当应用程序加载时，我的视图控制器有正确的尺寸，而孩子们没有。

有任何想法吗？有什么方法可以设置孩子的创作界限吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:33:03.013

我认为问题在于您永远不会从子视图控制器之外的任何地方设置子视图控制器的视图框架。在您的父视图控制器的`viewDidLoad`方法（或`viewDidAppear`方法，如果您喜欢）中，并且在子视图控制器被初始化之后，使用父视图控制器的`bounds`.

例如，您可以将以下内容放在父视图控制器的`viewDidLoad`方法中：

```
childViewController.view.frame = CGRectMake(0, 50, self.view.bounds.size.width, self.view.bounds.size.height - 50); 
```

# javascript - 通过ajax在后台预加载多个大型数据集？

> ID：14488508
> 
> 赞同：1
> 
> 时间：2013-01-23T20:13:01.423
> 
> 标签：javascript, ajax, jquery

我正在开发一个完全在一个页面中的 Web 应用程序，它基于在网格中显示一堆表格数据。数据库中有大约 30 个不同的表，用户可以随时请求其中任何一个以网格形式显示在他们的屏幕上。大多数（但不是全部）这些表的行数少于 1000 行。这些网格的数据正在通过 ajax 调用和加载。

现在，我显示登录屏幕并立即预加载一些主表，因此当用户输入他们的用户名和密码时，它正在加载初始网格。这确实增加了用户体验，因为他们不必在单击查看这些数据网格之一后等待 ajax 调用。因此，我正在考虑更进一步。

我正在考虑进行 ajax 调用以在后台加载所有 30 个表。在需要之前，它们不会被添加到 dom 中，而是添加到数组中。不利的是我不知道用户是否会在他们的会话中使用这些表的一半，但他们所做的那些通常会在用户请求时立即显示并创造更好的用户体验。

所以，我的问题是，通过 ajax 调用将 30 个完整的数据表（每个表大约 50 到 1000 行）存储在数组中是否是个好主意，如果是这样，获得最佳性能的最佳方法是什么（保持请记住，我只是将它们放入数组中，而不是在预加载后将它们添加到 dom 中）？以下哪一项是最好的方法：

1.  在页面加载时为每个表进行 30 次 ajax 调用
2.  在返回所有表格的页面加载时进行 1 次 ajax 调用
3.  在页面加载时进行 5 次 ajax 调用，每次都返回 6 个表
4.  倾斜 ajax 调用，所以我做了一些，然后一旦它们完成，再做一些
5.  还有一些方法...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:20:45.707

这些表格是正在编辑还是只会被查看？

如果仅查看上面的答案，则可能需要加载所有 30 个表（假设它们没有任何包含 BLOB 数据的字段）并将它们存储在应用程序的内存中而不是会话内存中。

如果要编辑表，则找出该用户（组？）经常使用哪个表并预加载这些表。

同样，我认为您的初始里程碑已经足够好，我不确定我是否喜欢在会话中为用户加载可能的 30,000 行数据的想法。特别是因为它有可能不被使用......如果数据库中的数据发生变化会发生什么，你要同步它吗？你怎么知道它变了？你要轮询数据库吗？看到开始出现的问题了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:21:23.750

我建议在一次调用中加载主表，然后在另一次调用中加载其余表。主要问题是，如果您将任何东西一起批处理，那么在整个 AJAX 请求完成之前，应用程序将无法使用这些信息。因此，如果您在一次调用中加载所有内容，则可能需要一段时间，并且当用户完成登录时主表不会准备好。

# java - Maven：如何重命名项目的war文件？

> ID：14488509
> 
> 赞同：104
> 
> 时间：2013-01-23T20:13:09.900
> 
> 标签：java, maven

我有一个`bird`包含以下组件的项目`pom.xml`

```
 <groupId>com.myorg</groupId>
    <artifactId>bird</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    <name>bird</name>

    <modules>
        <module>persistence</module>
        <module>business</module>
        <module>service</module>
        <module>web</module>
    </modules> 
```

和网络模块`pom.xml`

```
 <parent>
        <artifactId>bird</artifactId>
        <groupId>com.myorg</groupId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <artifactId>web</artifactId>
    <packaging>war</packaging> 
```

web 模块创建一个名为`web-1.0-SNAPSHOT.war`
How can I configure maven to build it as的 war 文件`bird.war`？

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2013-01-23T20:22:12.723

您可以在产生战争的 web 模块中使用以下内容：

```
<build>
  <finalName>bird</finalName>
 . . .
</build> 
```

这会导致在使用目标“war:war”时创建一个名为bird.war 的文件。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-01-23T20:17:55.277

你需要配置war插件：

```
<project>
  ...
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.3</version>
        <configuration>
          <warName>bird.war</warName>
        </configuration>
      </plugin>
    </plugins>
  </build>
  ...
</project> 
```

更多信息[在这里](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-10-26T04:18:05.047

查找 pom.xml > 项目标签 > 构建标签。

我想要下面的解决方案。

```
<artifactId>bird</artifactId>
<name>bird</name>

<build>
    ...
    <finalName>${project.artifactId}</finalName>
  OR
    <finalName>${project.name}</finalName>
    ...
</build> 
```

为我工作。^^

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-02-10T07:02:19.687

如果您使用的是 maven 项目，您可以按照以下步骤修改 .war 文件名。

打开 maven 项目的 pom.xml 文件并转到标签`<build></build>`，

1.  在此标签之间给出您想要的名称： `<finalName></finalName>`。

    **前任。：`<finalName>krutik</finalName>`**

    部署此 .war 后，您将能够通过以下方式访问 url：
    [http://localhost:8080/krutik/](http://localhost:8080/krutik/)

2.  如果您想使用斜杠**'/'**访问 url，那么您必须指定如下名称：

    **前任 ：`<finalName>krutik#maheta</finalName>`**

    部署此 .war 后，您将能够通过以下方式访问 url：
    [http://localhost:8080/krutik/maheta](http://localhost:8080/krutik/maheta)

# objective-c - 如何创建一个可用的继承 CCLayer 的基类？

> ID：14488513
> 
> 赞同：0
> 
> 时间：2013-01-23T20:13:22.990
> 
> 标签：objective-c, cocos2d-iphone

我想创建一个继承自`CCLayer`. 我的原因是因为我有一个单图像全屏`CCSprite`，我想覆盖在我的应用程序的每个场景上。创建一个基类，并添加一个`CCSprite`包含图像作为最顶层的 Z 对象似乎是有意义的，因为它可以防止我不得不为每个场景一次又一次地重新编码相同的覆盖实现。

我已经能够`CCLayer`相对容易地派生一个类。但是，我无法弄清楚如何正确创建另一个图层类~~的场景~~`CCLayer`，该图层类是. 如何做到这一点，如何工作？

据我了解，当大多数用户提出此类问题时，第一个问题是“向我们展示您的代码”。我可以向您展示代码，但我最感兴趣的是 Cocos2d 对象的一个​​非常通用的实现，它派生自`CClayer`其他层并可用作其他层的基类，预先连接常见的精灵和对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:26:22.273

I think this may be your problem:

> "*I cannot figure out how to create a scene that is a child, of a child of CCLayer.*"

As I understand it, Cocos layers are added as children to Cocos scenes, not the other way around, as the quote seems to imply.

I think you could simply make a custom layer class, deriving it from CCLayer and adding your CCSprite. Then simply go to everywhere you are creating or deriving a CCLayer and instead create or derive it from your custom layer class and then show or hide the sprite when needed.

Alternatively, and probably more easily, you could create a category on CCLayer adding a "showFullscreenSprite" method which simply creates the sprite and sets its image, then calls

```
[self addChild:yourSprite z:yourSprite.zOrder tag:9999]; 
```

You would also need a corresponding "hideFullscreenSprite" method which would simply do this

```
[self removeChildByTag:9999 cleanup:YES]; 
```

The nice thing about this approach is you wouldn't need to sub-class at all and all of your CCLayers would now have your "showFullscreenSprite" and "hideFullscreenSprite" methods available.

(Note: "9999" has to be some number you're not already using as a CCNode tag. Make it big enough so you don't have to worry about it. Maybe pull it out into a constant such as "FULL_SCREEN_SPRITE_TAG" or some such for readability.)

Hope this helps!

# java - 按钮组如何更改 JCheckBox 的计数

> ID：14488518
> 
> 赞同：0
> 
> 时间：2013-01-23T20:13:31.037
> 
> 标签：java, swing, jbutton

您好，有人知道如何制作 ButtonGroup，例如 10 个选项中只能选择 5 个吗？提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:15:29.700

您必须使用选择事件以编程方式对此检查进行编码。

# wordpress - Google Analytics 页面加载时间与 Pingdom 页面加载时间。

> ID：14488522
> 
> 赞同：1
> 
> 时间：2013-01-23T20:13:55.317
> 
> 标签：wordpress, google-analytics, pingdom

我正在检查 GA 和 Pingdom 中的页面加载时间数字。我通过 pingdom 的平均时间始终是 3 秒，或者大约是 3 秒。我在 GA 中的页面加载时间始终在 10 秒左右。谁能解释造成这种差异的技术原因。请。

对此信息的任何参考都会有所帮助，我无法找到直接的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-10T22:36:12.973

这是一个老问题，你可能已经继续前进了，但是 Pingdom 只测试服务器的响应时间（服务器返回 200、4XX 或 5XX 状态需要多长时间），甚至没有测试接收 HTML 的时间文档；而谷歌分析显示整个页面的加载时间，包括加载的所有内容和每个资产。

# iphone - 有没有办法在不使用 ALAsset 的情况下获取 iphone 中所有图像的 NSURL

> ID：14488523
> 
> 赞同：1
> 
> 时间：2013-01-23T20:13:58.963
> 
> 标签：iphone, alassetslibrary, alasset

我是 iphone 新手 - objC 等。我想知道是否有一种方法可以在不使用 ALAsset 的情况下获取 iphone 中图像文件的所有 NSURL 和文件名？

在当前代码中 - 如下所示。我看到循环 1100 张图像所需的时间大约是 14 秒。有没有更好的方法来快速获取url，文件名，请告诉我。

```
 ALAssetsLibrary* assetLibrary = [[ALAssetsLibrary alloc] init];
    ALAssetsGroupType type = m == 2 || m == 1 ? ALAssetsGroupAll : ALAssetsGroupLibrary;

    [assetLibrary enumerateGroupsWithTypes:type usingBlock:^(ALAssetsGroup* group, BOOL* stop)
     {
         if (group)
         {
             [group setAssetsFilter:m == 1 ? [ALAssetsFilter allVideos] : [ALAssetsFilter allPhotos]];
             [group enumerateAssetsUsingBlock:^(ALAsset* asset, NSUInteger index, BOOL* innerstop)
              {

                  if (asset)
                  {
                      @autoreleasepool
                      {
                          if (!initialized)
                          {
                              *innerstop = YES;
                              return;
                          }

                          /***************************************************************************************/

                          ALAssetRepresentation* defaultRepresentation = [asset defaultRepresentation];

                          if(defaultRepresentation)
                          {
                              //NSLog(@"defaultRepresentation for %@", [[defaultRepresentation url] absoluteString]);
                              long long size        = [defaultRepresentation size];
                              NSURL*    url         = [defaultRepresentation url];
                              NSString* fileName    = [defaultRepresentation filename]; 
```

# c++ - OpenCV 窗口冻结

> ID：14488525
> 
> 赞同：1
> 
> 时间：2013-01-23T20:14:02.100
> 
> 标签：c++, c, qt, opencv, tcp

我正在尝试显示通过 TCP 发送的帧。一切正常，我可以实时看到帧。

问题是，窗口冻结一段时间后，如果我关闭窗口，则会出现另一个窗口并在一段时间后冻结。

这是我的代码：

```
CvSize size;
size.height = 480;
size.width = 640;
IplImage *frame = cvCreateImageHeader(size, IPL_DEPTH_8U, 3);
frame->imageData = Frame.data();
cvShowImage( "mywindow", frame );
Frame.clear();
cvReleaseImage(&frame);
totalPacketsSize =0 ; 
```

此代码在接收帧时循环运行。

**注意：** 此代码在单独的线程上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:23:35.560

在 showimage() 之后需要一个[cvWaitKey(xxx)](http://docs.opencv.org/modules/highgui/doc/user_interface.html#waitkey)，其中 XXX 是准备好新图像的合理时间（以毫秒为单位）

# php - Perl & SHA1 查询

> ID：14488527
> 
> 赞同：1
> 
> 时间：2013-01-23T20:14:07.080
> 
> 标签：php, xml, perl

我的 PHP 代码

```
<?php
$xml="<request>
<point_of_sale_id>XXXXXXX</point_of_sale_id>
<order_id>XXXXXXX</order_id>
<amount>XXXXXXX</amount>
<description>XXXXXXX
</description>
<result_url>XXXXXXX</result_url>
<server_url>XXXXXXX</server_url>
</request>";

$parameters_xml=base64_encode($xml);
$merchant_secret_code='XXXXXXX';

$signature=base64_encode(sha1($xml.$merchant_secret_code,1));

echo "<form action=\"https://www.i-koruna.com/i-koruna/api/payment/payment-entry-point.jsf\"\n"; 
echo "method=\"POST\" accept-charset=\"utf-8\">\n"; 
echo "<input type=\"hidden\" name=\"api_version\" value=\"v2\" />\n"; 
echo "<input type=\"hidden\" name=\"parameters_xml\" value=\"$parameters_xml\" />   \n"; 
echo "<input type=\"hidden\" name=\"signature\" value=\"$signature\" />\n"; 
echo "<input type=\"hidden\" name=\"locale\"  value=\"en\" />\n"; 
echo "<input type=\"submit\" value=\"Buy\" />\n"; 
echo "</form> \n";
?> 
```

此代码正在工作，但在 perl 中相同的复制

Perl 代码

```
 use MIME::Base64;
            use Digest::SHA qw(sha1);
            my $parameters_xml = encode_base64("<request><point_of_sale_id>".$c->{ikoruna_pos}."</point_of_sale_id><order_id>$id</order_id><amount>".$f->{amount}."</amount><description>".$c->{item_name}."</description><result_url>$c->{site_url}/?payment_complete=$id-$usr_id</result_url><server_url>$c->{site_url}/?payment_complete=$id-$usr_id</server_url></request>");
            $parameters_xml =~ s/\s+//g;
            my $merchant = 'XXXXXXXXXXXXX';
            my $signature=encode_base64(sha1($parameters_xml.$merchant), '');

            print "Content-type:text/html\n\n";
print <<END
<form action="https://www.i-koruna.com/i-koruna/api/payment/payment-entry-point.jsf" method="POST" accept-charset="utf-8">
     <input type="hidden" name="api_version" value="v2" />
     <input type="hidden" name="parameters_xml" value="$parameters_xml" /> 
     <input type="hidden" name="signature" value="$signature" />
    <input type="hidden" name="locale"  value="en" />
     <input type="submit" value="Buy" />
</form>
END 
```

我在打包 $signature 时检查了这是一个问题，我这样做是否正确？如果我错过了一些我可以做到的不是问题的东西，请忽略 HTML 部分

我从商家“无效的商家签名”处收到此错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:35:37.193

在 PHP 中，sha 哈希是未编码的 xml，而在 perl 中，sha 哈希是 base64 编码的 xml

更正：

```
use MIME::Base64;
use Digest::SHA qw(sha1);
my $xml = <<END;
    <request>
        <point_of_sale_id>".$c->{ikoruna_pos}."</point_of_sale_id>
        <order_id>$id</order_id>
        <amount>".$f->{amount}."</amount>
        <description>".$c->{item_name}."</description>
        <result_url>$c->{site_url}/?payment_complete=$id-$usr_id</result_url>
        <server_url>$c->{site_url}/?payment_complete=$id-$usr_id</server_url>
    </request>
END
my $parameters_xml = encode_base64($xml);
$parameters_xml =~ s/\s+//g;
my $merchant = 'XXXXXXXXXXXXX';
my $signature=encode_base64(sha1($xml.$merchant), '');
print "Content-type:text/html\n\n";
print <<END;
<form action="https://www.i-koruna.com/i-koruna/api/payment/payment-entry-point.jsf" method="POST" accept-charset="utf-8">
    <input type="hidden" name="api_version" value="v2" />
    <input type="hidden" name="parameters_xml" value="$parameters_xml" /> 
    <input type="hidden" name="signature" value="$signature" />
    <input type="hidden" name="locale"  value="en" />
    <input type="submit" value="Buy" />
</form>
END 
```

# android - Android 从 CustomView 绘制 TextView

> ID：14488531
> 
> 赞同：1
> 
> 时间：2013-01-23T20:14:26.700
> 
> 标签：android, view, android-canvas, draw

我有一个看起来像这样的自定义视图：

```
public class CustomView extends View {

    protected Context c;
    protected String text;
    ... // and some more useful member variables...

    public CustomView(String text, Context c, ...) {

         this.text = text; this.c = c;
         ...
    }

    @Override
    protected void onDraw(Canvas canvas) {

        super.onDraw(canvas);

        LinearLayout ll = new LinearLayout(c);
        TextView tv = new TextView(c);
        tv.setText(text);
        ll.addView(tv);

        ll.draw(canvas);
    } 
```

在我的主要活动中，我这样做：

```
 RelativeLayout gamelayout = (RelativeLayout) findViewById(R.id.gamelayout);

    CustomView customview = new CustomView("Textview text", this);
    gamelayout.addView(customview); 
```

我的问题是，根本没有绘制任何东西，绘制的 TextView 不会出现在“游戏布局”中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:20:22.023

TextView 对象无法直接绘制到画布上，因为您已经完成了您需要分配给 Layout 然后执行以下操作：

```
ll.layout(0, 0, canvas.getWidth(), canvas.getHeight()); //Modify values as needed 
```

就个人而言，我很惊讶 call 没有引发错误`ll.draw()`。除非您需要绘制 TextView，否则我更喜欢将文本绘制到画布上：

```
canvas.drawText(...) 
```

[在此处查看文档](http://developer.android.com/reference/android/graphics/Canvas.html#drawText%28java.lang.String,%20float,%20float,%20android.graphics.Paint%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:58:12.893

你`LinearLayout`没有附加到你的视图

尝试`this.addView(ll)`将您的 LinearLayout 添加到您的视图中。

# eclipse - Joda Date 和 SWT DateTime 冲突

> ID：14488532
> 
> 赞同：0
> 
> 时间：2013-01-23T20:14:29.533
> 
> 标签：eclipse, datetime, swt

我遇到了一个我以前从未见过的问题，搜索什么也没找到。我在我的程序中导入了 SWT DateTime 和 Joda DateTime，看起来它们不能共存。有没有办法在 Eclipse 中允许这两个类？它一直想专门使用 swt DateTime 小部件，我不确定如何在不同的导入中处理两个同名的类。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:24:06.767

您可以跳过导入并使用完整的包名引用类：

```
public class Main {
    private org.joda.time.DateTime jodaDateTime;
    private swt.DateTime swtDateTime;
} 
```

# javascript - 单击处理程序失去对创建它的“this”对象的引用

> ID：14488534
> 
> 赞同：0
> 
> 时间：2013-01-23T20:14:29.900
> 
> 标签：javascript, oop

我制作了 JS 脚本：

```
var zzz;
zzz = {
    fff: function (Id) {
        alert("You did it! Id="+Id);
    },
    main: function (Id) {
        var button, elements;
        button = document.createElement("input");
        button.type = "submit";
        button.onclick = function () {
            zzz.fff(Id);
        };
        elements = document.getElementById(Id);
        elements.appendChild(button);
    }
}; 
```

和 HTML，我在其中对其进行了测试：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

    <head>
        <meta http-equiv="Content-type" content="text/html; charset=UTF-8">
        <title>My Web Page!</title>
        <script type="text/javascript" src="test.js"></script>
    </head>

    <body>
        <div id="div001"></div>
        <div id="div002"></div>
        <script type="text/javascript">
            object1 = zzz;
            object1.main("div001");
            object2 = zzz;
            object2.main("div002");
        </script>
    </body>

</html> 
```

为什么它只有在我写的时候才有效`button.onclick = function () { zzz.fff(Id); };`，而且用`this.fff(Id)`它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:21:35.263

当您绑定事件处理程序（例如`onclick`）时，处理程序内部`this`成为触发事件的元素（除非您使用了内联`onclick=""`属性，应避免使用）。

除了 using `zzz`，您还可以通过闭包复制`this`到处理程序内部可用的另一个变量：

```
var that = this;
button.onclick = function () {
    that.fff(Id);
}; 
```

或者你可以使用[`Function.prototype.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
var clickHandler = button.onclick = function () {
    this.fff(Id);
};
button.onclick = clickHandler.bind(this); 
```

# java - 为项目中存在的类获取 NoClassDefFoundError

> ID：14488536
> 
> 赞同：2
> 
> 时间：2013-01-23T20:14:33.650
> 
> 标签：java

```
decodeThread = new DecodeThread(activity, decodeFormats, characterSet,
    new ViewfinderResultPointCallback(activity.getViewfinderView())); 
```

对于上面的代码，我遇到了以下异常：

```
01-24 01:33:02.078: E/AndroidRuntime(708): java.lang.NoClassDefFoundError: com.main.onlinecart.ViewfinderResultPointCallback 
```

该类`ViewfinderResultPointCallback`存在于调用类的同一包中。对于从同一个包中使用的其他类，我没有收到错误消息。这里可能存在什么问题？有什么与类路径有关的吗？我在哪里可以交叉检查类路径变量？

我正在使用 eclipse（在 mac os x 上）并从运行配置运行项目。

该类`ViewfinderResultPointCallback`实现了另一个`ResultPointCallback`不在同一个包中的类，但它存在于项目构建路径中添加的 jar 中。我在日志中看到一个异常：

```
01-24 01:33:01.968: I/dalvikvm(708): Failed resolving com/main/onlinecart/ViewfinderResultPointCallback; interface 472 'Lcom/google/zxing/ResultPointCallback;' 
01-24 01:33:01.968: W/dalvikvm(708): Link of class 'Lcom/main/onlinecart/ViewfinderResultPointCallback;' failed 
```

但是同一个 jar 中还有许多其他类没有抛出任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:19:23.980

大多数时候 java.lang.NoClassDefFoundError 不是实际问题。在此之前应该有另一个例外。您应该在消息 (ViewfinderResultPointCallback) 中寻找在类的静态初始化期间发生的异常。对此类的任何访问都将触发 NoClassDefFound ，但这仅意味着未加载该类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:31:37.477

不要`NoClassDefFoundError`与`ClassNotFoundException`. 如果所讨论的类实现了一个接口并且两者中的任何一个在新版本中提供（它们不再匹配），第一个也可能发生。有关详细信息，请参阅[http://javarevisited.blogspot.ch/2011/06/noclassdeffounderror-exception-in.html 。](http://javarevisited.blogspot.ch/2011/06/noclassdeffounderror-exception-in.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T21:17:22.103

NoClassDefFoundError 是因为我的类依赖于 jar 中的一个接口。当我将 jar 添加到项目的 libs 目录时，错误得到解决。这是必需的，因为我正在处理一个 android 项目，并且在创建 .apk 文件时，它会从 libs 文件夹中添加 jar 以供运行时使用。

# ios - 个人资料和证书，我做错了什么？

> ID：14488540
> 
> 赞同：1
> 
> 时间：2013-01-23T20:14:51.860
> 
> 标签：ios, xcode, apple-push-notifications, provisioning-profile, ios-provisioning

我们在 AppStore 上有一个应用程序，我们正在将其制作成两个不同的应用程序，一个 Pro 和一个 Lite。在我们开发的时候，我们只是复制了原始项目，我制作了 Pro 版，他制作了 Lite 版。现在，我必须更改配置文件和证书以及 AppID 和 bundleID 等，但我在做这件事时遇到了一些麻烦..

因为我们实际上已经完成了两者，所以我决定直接分发/发布。

我首先为新项目创建了一个 AppID，名称与另一个类似（+Pro）。然后我配置了分发推送通知服务，并请求证书，并制作了 .p12 和 .pem 等等。

然后我去'Provisioning'->'Distribution'并创建了一个新的配置文件。此配置文件使用了新的 AppID。到目前为止，一切都很好？

我下载了分发配置文件，并将其添加到 XCode Organizer。然后我进入了目标和项目的构建设置，并设置`Code Signing Identity->Release->Any iOS SDK->iPhone Distribution(the correct new profile I just made)`. 我为 Ad-hoc 设置了相同的值，以防万一..

我去`Product->Edit Scheme`，并将“运行 appName.app”-> 构建配置设置为“调试”的“发布”。然后我构建项目，并在项目导航器中向下滚动，找到 appName.app，将其拖入 iTunes，然后从那里将其安装到我的设备上。

当我现在将手机与 iTunes 同步时，它在我的设备上显示（大致翻译）`iTunes synchronization - AppName could not install`：。为什么？配置文件怎么可能是错误的？我正在使用完全相同的配置文件，只有新的配置文件称为“appPro”而不是“应用程序”。新的 AppID，新的 BundleID，但我的应用程序失败了。或者也许这不是个人资料错误？

# google-app-engine - HTTP 请求可以在互联网中复制吗？

> ID：14488553
> 
> 赞同：2
> 
> 时间：2013-01-23T20:15:48.557
> 
> 标签：google-app-engine, windows-phone, mobile-website

我有一个应用程序，它包含一个 Windows Phone 客户端，它将 HTTP 请求发送到托管在 Google App Engine 中的 Python 服务器。在 GAE 日志中，我看到我经常在几毫秒内收到来自同一个客户端的多个相同请求（见下文）。在我的开发环境中测试客户端时，我从未见过这种行为。尽管如此，我意识到这可能是我的代码中的错误，但我的问题是：

基础设施的任何部分（移动网络、互联网、谷歌应用引擎本身）是否会导致请求重复？

如果是这样，接下来的问题是：是否有最佳实践来最小化这种情况？

![gae日志截图](../Images/d952921c6fc25908d55ddf746d07d62c.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:43:06.350

不，底层基础设施不会复制 HTTP 请求。至少他们*不应该*是。

可能发生的情况是，您看到移动应用程序请求是用本机 cod 发出的，它们不使用 cookie 并且具有相同的用户代理字符串。相同的 IP 是因为移动网络内部使用 NAT，将多个（可能数千个）客户端隐藏在单个 IP 地址后面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T10:29:36.790

网络确实不可能复制 HTTP 请求。它可以使用错误配置的路由复制 IP 数据报，但 TCP 层过滤重复的 IP 数据报，以便端到端连接只看到一个 TCP 流。应用引擎可能会在没有标准时间的情况下重用 TCP 端口来等待先前的 TCP 连接出于性能目的而终止，但我仍然认为重复的数据包不会从用于初始化连接的三向 TCP 握手中幸存下来。

# java - 将字符串拆分为具有未定义空格的数组

> ID：14488556
> 
> 赞同：0
> 
> 时间：2013-01-23T20:15:52.877
> 
> 标签：java, arrays, string, split

我有这些数据，我试图将其拆分为单独的部分，唯一的问题是每个值之间的空格不一样。例如：

```
2010   1    5.1     0.9      11    55.4    86.1# 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:17:16.253

```
String[] values = input.split("\\s+"); 
```

罗尔夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:17:57.970

标记字符串，然后删除空格。如果这是家庭作业，我将把实施留给你。

# python - 从字符串中删除连续的点（句点）？

> ID：14488557
> 
> 赞同：0
> 
> 时间：2013-01-23T20:16:04.900
> 
> 标签：python, python-2.7

在从 word doc 转换文本时，原作者使用了一行句点， 我想摆脱长行的连续句点。我想保持使用句点的句子完整。所以我不想删除所有句点，只是当它们出现在 3 个或更多组中时。
`Friends and family......................................-1
XBox 360 ................................................-2`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:17:33.467

使用正则表达式：

```
import re

consequitivedots = re.compile(r'\.{3,}')
consequitivedots.sub('', inputstring) 
```

示范：

```
>>> import re
>>> consequitivedots = re.compile(r'\.{3,}')
>>> inputstring = '''\
... Friends and family......................................-1
... XBox 360 ................................................-2
... '''
>>> consequitivedots.sub('', inputstring)
'Friends and family-1\nXBox 360 -2\n'
>>> print consequitivedots.sub('', inputstring)
Friends and family-1
XBox 360 -2 
```

# c# - 如何在 Windows 8 设置面板中订阅事件（c#）

> ID：14488565
> 
> 赞同：0
> 
> 时间：2013-01-23T20:16:20.963
> 
> 标签：c#, windows-8

我正在用 c#/xaml 开发一个 Windows 8 商店应用程序。Windows 商店指南说，当用户更改设置时，应用程序应立即反映该更改。我需要帮助弄清楚如何做到这一点。

以下是有关我的设置的一些详细信息。

我创建了一个名为 OptionsView 的自定义控件：

```
public partial class OptionsView : UserControl
{
    public OptionsView()
    {
        this.InitializeComponent();
    }

    private void cmbEarliestYear_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        ApplicationDataContainer roamingSettings = Windows.Storage.ApplicationData.Current.RoamingSettings;
        roamingSettings.Containers["appOptions"].Values["earliestYear"] = cmbEarliestYear.SelectedValue.ToString();
    }
} 
```

在我的 App.xaml.cs 类中，当用户单击选项链接时，我使用 Callisto 库中的 SettingsFlyout 来显示自定义选项控件：

```
protected override void OnWindowCreated(WindowCreatedEventArgs args)
{
    base.OnWindowCreated(args);
    SettingsPane.GetForCurrentView().CommandsRequested += onCommandsRequested;
}

void onCommandsRequested(SettingsPane settingsPane, SettingsPaneCommandsRequestedEventArgs eventArgs)
{
    UICommandInvokedHandler optionsHandler = new UICommandInvokedHandler(onOptionsClick);
    SettingsCommand optionsCommand = new SettingsCommand("options", "Options", optionsHandler);
    eventArgs.Request.ApplicationCommands.Add(optionsCommand);

}

void onOptionsClick(IUICommand command)
{
    SettingsFlyout settings = new SettingsFlyout();
    settings.FlyoutWidth = SettingsFlyout.SettingsFlyoutWidth.Narrow;
    settings.HeaderText = "Options";
    settings.Content = new OptionsView();
    settings.IsOpen = true;
} 
```

我的应用程序中有一个名为 CreateTripPage 的页面。该页面上有一个组合框，允许用户更改旅行的年份。该组合框中最早的年份需要根据用户在选项中设置的值进行更改。因此，当用户在 CreateTripPage 打开时更改 OptionsView 中 cmbEarliestYear 的值时，我需要触发一个事件。我不知道如何触发/订阅所需的事件。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:42:05.540

这是我实现的类似行为的简单示例。Cineworld 应用程序可用于查看有关英国和爱尔兰的电影院/电影/的详细信息。

设置窗格中的选项页面，允许选择/修改区域。这意味着我的应用程序需要在运行时适应区域修改。

我倾向于这样做：

1) 有一个定义属性并保留这些值的配置类。2) config 类公开一个属性

```
public static event Action RegionChanged = delegate { }; 
```

3) 在 Region 属性的 setter 中触发事件。

```
if (RegionChanged != null)
    RegionChanged(); 
```

4) 现在在 MainPage.xaml.cs 或主应用程序入口点。

```
protected async override void OnNavigatedTo(NavigationEventArgs e)
{
    Config.RegionChanged -= Config_RegionChanged;
    Config.RegionChanged += Config_RegionChanged;

    // do whatever else you need to do (initial data load)

    base.OnNavigatedTo(e);
}

async void Config_RegionChanged()
{
    bLoaded = false;
    this.GoHome(this, new RoutedEventArgs());
} 
```

就是这样。

# android - Android 地图 v2 地图在方向更改时变得无响应

> ID：14488566
> 
> 赞同：0
> 
> 时间：2013-01-23T20:16:26.923
> 
> 标签：android, android-fragments, android-maps-v2

我正在使用新的地图 api。它工作正常.. 但是当设备方向改变时.. 地图变得无响应。我的意思是地图不会对用户响应做出反应。

当我在布局 xml 中嵌入地图片段时，不会出现这个问题。但仅当我尝试在 Activity 的 onCreate 中的布局容器中添加 mapfragment 时才会发生。

谁能告诉我这个问题。

这是我添加地图的方式

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".HomeActivity" >

<FrameLayout
    android:id="@+id/activity_home_fragment_container"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true">
</FrameLayout>

</RelativeLayout> 
```

而在Activity的oncreate

```
mMapFragment = new SupportMapFragment();
    FragmentManager manager = getSupportFragmentManager();
    FragmentTransaction transaction = manager.beginTransaction();
    transaction.add(R.id.activity_home_fragment_container, mMapFragment,
            "MAP_FRAGMENT");
    transaction.commit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:11:46.397

**在您的布局中使用它：**

```
<LinearLayout
        android:id="@+id/map_container2"
        android:layout_width="match_parent"
        android:layout_height="200dp"
        android:layout_weight="35.22"
        android:orientation="horizontal" >

        <fragment
            android:id="@+id/map1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_weight="1"
            class="com.google.android.gms.maps.SupportMapFragment"
            map:cameraTargetLat="40.72"
            map:cameraTargetLng="-74.00"
            map:cameraZoom="8" />
    </LinearLayout> 
```

**而这段代码：**

```
onCreate{
   setUpMapIfNeeded();
}

private void setUpMapIfNeeded() {
        // TODO Auto-generated method stub
        // Do a null check to confirm that we have not already instantiated the map.
        if (mMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map1))
                    .getMap();
            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                setUpMap();
            }
        }
    }

private void setUpMap() {
        // TODO Auto-generated method stub
         // Hide the zoom controls as the button panel will cover it.
        mUiSettings = mMap.getUiSettings();
 // Enables/disables zoom gestures (i.e., double tap, pinch & stretch).
        mMap.getUiSettings().setZoomGesturesEnabled(false);
// Enables/disables scroll gestures (i.e. panning the map).
        mMap.getUiSettings().setScrollGesturesEnabled(false);
 // Enables/disables the compass (icon in the top left that indicates the orientation of the
        // map).
        mMap.getUiSettings().setCompassEnabled(false);
        // Add lots of markers to the map.
        addMarkersToMap();

        // Pan to see all markers in view.
        // Cannot zoom to bounds until the map has a size.
        final View mapView = getSupportFragmentManager().findFragmentById(R.id.map1).getView();
        if (mapView.getViewTreeObserver().isAlive()) {
            mapView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
                @SuppressLint("NewApi") // We check which build version we are using.
                @Override
                public void onGlobalLayout() {
                    LatLngBounds bounds = new LatLngBounds.Builder()
                            .include(WOODS)
                            .build();
                    if (Build.VERSION.SDK_INT < Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
                      mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                    } else {
                      mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                    }
                    mMap.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds, 50));
                }
            });
        }
    }

private void addMarkersToMap() {
        // TODO Auto-generated method stub
         // Uses a colored icon.
        mWoods = mMap.addMarker(new MarkerOptions()
                .position(WOODS)
                .title("Woods")
                .snippet("R. Quatá, 1016, Vila Olimpia - (11) 3849-6868")
                .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T14:36:10.120

我的猜测是，如果您`Fragment`在`Activity's` `onCreate()`不检查是否添加的情况下添加，`savedInstanceState == null`那么您最终会在`SupportMapFragments`另一个上添加两个（或更多），这会导致这种效果。

# php - 脚本头过早结束：index.php、mod_fcgid：读取数据超时 61 秒

> ID：14488567
> 
> 赞同：21
> 
> 时间：2013-01-23T20:16:32.880
> 
> 标签：php, apache, timeout, mod-fcgid

我在 localhost（有 4 个变体）上编写了一个简单的爬虫脚本（用 php 编写）。他们都在本地主机上工作得很好。但是当我将它们移动到共享主机时，其中两个工作了其他人给了内部服务器错误。我查看了error_log，看到了这些行：

```
[Wed Jan 23 22:01:02 2013] [warn] [client ***] mod_fcgid: read data timeout in 61 seconds
[Wed Jan 23 22:01:02 2013] [error] [client ***] Premature end of script headers: index.php 
```

我进行了搜索，但找不到任何有用的结果。这些错误与什么有关？有任何想法吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-10T16:31:38.707

如果您可以访问 Linux 服务器，请`/etc/httpd/conf.d/fcgid.conf`使用 vim 编辑文件。
更改`FcgidIOTimeout 45`为`FcgidIOTimeout 600`。
重启阿帕奇。
然后将解决快速 CGI 超时问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-11T18:37:00.743

我在安装 Drupal7 的 MediaTemple Grid 实例上遇到了这个问题；原来它是由 FastCGI 引起的；切换到正常/稳定的 CGI 似乎已经解决了这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-14T08:42:39.933

如果您使用的是虚拟主机（在我的情况下，我使用的是 ispconfig），您需要在虚拟主机配置文件中进行更改。这些文件位于`/etc/httpd/conf/sites-available`每个虚拟主机下。只需编辑您想要的配置文件，找到`IPCCommTimeout`并将当前值设置为更高的数字。如果您有常规站点和 SSL 站点，您可能需要对同一配置文件中的两个变量进行此更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:17:03.410

> 读取数据超时 61 秒

他们超时了。您的执行时间很可能设置为 60 秒。因此，在 61 秒时，该进程被终止，因此*提前结束*。

您可以调整超时（不推荐）或通过其他来源运行脚本（推荐）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:19:13.460

本质上，您的脚本对于服务器配置来说运行时间过长。mod_fcgid 正在等待 php 响应，并设置为在 61 秒后放弃。由于此共享主机，您可能无法更改它。

无论如何，这不应该通过浏览器/网络服务器运行。将其编写为控制台脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-08T11:41:34.157

mod_cfgid`max_execution_time`在执行 php 脚本时引入了除 PHP 之外的其他时间限制。以先到者为准。

据我所知，mod_cfgid 考虑的时间限制配置项有很多，我不是专家来告诉哪个做哪个，但至少在我们的例子中添加以下行

```
IPCCommTimeout  9999 
```

在`fcgid.conf`解决了我们意想不到的超时问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-09-05T04:42:27.297

如果 mod_fcgid 出现任何问题，如下所示： _mod_fcgid：在 XX 秒内读取数据超时 _mod_fcgid：无法为

请优先解决这些问题：

```
_Increasing the memory limit of php (default 128M, up to 256, 384, ... then restart apache anh check it again)
_Increasing the time out of FCGI, but not need if above is ok 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-03-09T04:32:52.767

增加`max_execution_time`值，即：

```
<?php
ini_set('max_execution_time', 300); # 5 minutes
... 
```

# ruby-on-rails - 使用 Rails 进行 SEO - 如何根据操作更改部分标题（例如索引与显示）

> ID：14488576
> 
> 赞同：0
> 
> 时间：2013-01-23T20:16:54.840
> 
> 标签：ruby-on-rails, view

我有一家产品商店。我创建了一个`_product.html.erb`包含产品摘要的部分，并将它用于索引和显示页面。

问题是，我希望产品名称成为`<h1>`产品展示页面中的标题，但`<h2>`在索引页面上。`<h1>`我想这样做是因为我在索引页面上有很多产品，我不确定在同一页面上有大量 s 是否有意义。对于展示页面，我只有一个产品，所以肯定想使用`<h1>`.

我这样做的方法是在下面的部分中使用 if/else 子句，但这有点混乱。有一个更好的方法吗？

**产品/_product.html.erb**

```
<div class="product_partial">
  <% if params[:action] == "show" %>
    <h1><%= product.name %></h1>
  <% else %>
    <h2><%= product.name %></h2>
  <% end %>          
  <h3><%= product.description %></h3>
</div> 
```

**产品/show.html.erb**

```
<div class="product_show">
  <%= @product %>
  <%= @product.other_info %>    
</div> 
```

**产品/index.html.erb**

```
<div class="product_index">
  <%= @products %>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:39:53.253

也许是这样的

产品/_product.html.erb

```
<div class="product_partial">
    <<%= heading_tag %>><%= product.name %></<%= heading_tag %>>         
    <h3><%= product.description %></h3>
</div> 
```

产品/show.html.erb

```
<div class="product_show">
    <%= render @product, :heading_tag => 'h1' %>
    <%= @product.other_info %>    
</div> 
```

产品/index.html.erb

```
<div class="product_index">
   <%= render @products, :heading_tag => 'h2' %>
</div> 
```

# vb.net - 如何使用 vb.net 重新启动个人无线网件路由器？

> ID：14488579
> 
> 赞同：-1
> 
> 时间：2013-01-23T20:17:05.027
> 
> 标签：vb.net, wireless

如何在 vb.net 代码中配置 netgear 无线路由器？我想重新启动我的路由器并考虑断开客户端。这可能用于帮助亲戚使用他们的无线路由器。

编辑：操作系统信息：Windows 7 SP1 .NET Framework 4.5 或更高版本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:45:20.467

首先：您在任何情况下都不必重新启动路由器（没有固件升级）。如果您的调制解调器/路由器偶尔“中断”并需要重新启动才能恢复正常运行，那么它有问题，您应该寻求保修更换。线路不同步也不需要重新启动。

有了这个免责声明：有两种方法可以实现你的目标：

首先是使用 Netgear 路由器中的 Telnet 管理功能（假设它们已启用且可操作）。用代码编写 Telnet 客户端是微不足道的，是留给读者的练习。只需知道要发送的正确命令以使其重新启动即可。

第二种方法是编写一个 Web 客户端（使用`HttpWebRequest`），将一系列 HTTP 请求发送到路由器，就像人工浏览器自己重启时一样。使用像 Firefox 的“Live HTTP Headers”这样的工具来查看需要发送哪些 HTTP 请求。注意 HttpWebRequest 中的 cookie 保留问题。

# java - Eclipse：编译依赖应用程序时导出 JAR

> ID：14488584
> 
> 赞同：0
> 
> 时间：2013-01-23T20:17:21.600
> 
> 标签：java, android, eclipse, jar

我正在开发一个以 JAR 形式导出的 SDK，它将被 Android 应用程序使用。我创建了一个测试应用程序来测试 SDK 的行为。我正在寻找一种在编译测试应用程序时将 JAR 导出到测试应用程序库文件夹的简单方法。因此，JAR 中所做的所有更改都可以与测试 App 中的更改一起进行测试。

所以目前的工作流程是：

在 SDK -> 编译 -> 导出 JAR -> 将 JAR 放入测试应用程序的 Lib 文件夹中进行更改 -> 编译测试应用程序 -> 运行测试

有没有办法将它们链接在一起，所以当测试应用程序被编译时，所有 previos 步骤都会自动运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:57:02.300

创建一个ant文件来编译jar并将其复制到“app lib文件夹”中，并在构建项目时将其配置为运行。这是一个生成jar的ant文件示例

```
<?xml version="1.0"?>
<project name="your-project-name" default="jar" basedir="..">

<property name="app.lib.dir" value="C:/folder_destination_of_the_jar"/>
<property name="jar.filename" value="jar-filename.jar"/>
<property name="core.build.dir" value="bin"/>

<target name="jar">
    <jar jarfile="${app.lib.dir}/${jar.filename}">
        <fileset dir="${core.build.dir}"/>
    </jar>
</target>

</project> 
```

如果您使用 eclipse 作为 IDE，请按照以下步骤将其配置为在构建项目时运行：右键单击您的项目->Properties->Builders->New->选择 Ant Builder->将 ant 文件添加为 Buildfile

# javascript - div标签和输入标签的换行调整

> ID：14488585
> 
> 赞同：0
> 
> 时间：2013-01-23T20:17:23.183
> 
> 标签：javascript, html

我在使用 DIV 标记和表单输入字段时遇到了一些问题。我使用javascript获取输入字段的值。Javascript工作正常。它获取输入字段值并显示在 DIV 标记中。问题是，当我给出一个长输入或长句子时，它会按原样显示在 div 标签中。我希望它不是以长单行的形式显示，而是以段落的形式显示。这是我的代码。

```
<script>
function myFunc(){
    var str = document.myform.aaa.value;
    document.getElementById('mydiv').innerHTML=str;
}
</script>

<form>
<input type="text" name="aaa" />
<input type="button" value="Post" onclick="myFunc();" >
</form>

<div id="mydiv" width="500px" height="300px">Old text</div> 
```

如果我给它一个输入，例如：

```
hello there, how are you hello there, how are youhello there, how are youhello there. 
```

它以单行而不是段落格式显示。我希望它以这种形式显示上面的句子：

```
hello there, how are you hello there, 
how are youhello there, how are youhello 
there. 
```

我自己有一些整理。我的意思是说，如果我写一个带有空格的句子，它可以正常工作，但如果有一长串没有任何空格的字母，那么它就不起作用。我想要的是，要么我可以输入空格和没有空格，它应该可以双向工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:27:02.927

尝试使用 css 来设置`width`and`height`的`<div>`而不是属性。

[jsFiddle](http://jsfiddle.net/XFsnx/1)

```
<div id="mydiv" style="width: 200px; height: 200px;">Old text</div> 
```

更好的是创造一种风格：

```
.comments {
    width: 200px;
    height: 200px;
}

<div id="mydiv" class="comments">Old text</div> 
```

使用自动换行来解决没有空格的问题。

```
word-wrap:break-word 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:27:52.600

这与javascript没有任何关系。默认情况下，DIV 标签将扩展到其父元素的 100%。

如果将 div 的宽度设置为特定的百分比或像素宽度，则该 div 的内容将相应地换行。

您可以使用 CSS 来定义宽度，但您必须知道要设置它的宽度。

```
#mydiv {
    width:50%; //I just guessed at this number
} 
```

或者

```
#mydiv {
    width:100px; 
} 
```

或者，您可以使用 javascript 来设置它。（尽管最好使用 CSS 进行设置）

```
document.getElementById('mydiv').style = "width:50%'; 
```

# c# - 如何在 WinRT 中一次允许多个弹出窗口？

> ID：14488587
> 
> 赞同：3
> 
> 时间：2013-01-23T20:17:24.867
> 
> 标签：c#, windows-8, popup, windows-runtime, winrt-async

如果您在另一个对象已向用户显示但未关闭时调用该`ShowAsync`命令（即`MessageDialog`当另一个`MessageDialog`对象已启动时显示弹出窗口），`UnauthorizedAccessException`则会抛出 an 。当您有多个线程试图同时提醒用户时，这会使事情变得困难。

我当前的（权宜之计）解决方案只是`ShowAsync`用 try/catch 块包围调用并吞下异常。这不希望地导致用户错过后续通知。我能想到的唯一其他方法是手动实现某种弹出队列。这似乎是一项过多的工作，然而，考虑到其他框架（如 Windows Phone）没有这个问题，并且只会在用户关闭它们时一个接一个地显示弹出窗口。

有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T22:15:56.413

您可以使用此扩展方法轻松做到这一点：

```
public static class MessageDialogShower
{
    private static SemaphoreSlim _semaphore;

    static MessageDialogShower()
    {
        _semaphore = new SemaphoreSlim(1);
    }

    public static async Task<IUICommand> ShowDialogSafely(this MessageDialog dialog)
    {
        await _semaphore.WaitAsync();
        var result = await dialog.ShowAsync();
        _semaphore.Release();
        return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-23T20:59:11.803

有很多方法可以解决它，选择可能取决于您的技能、要求和偏好。

我个人的选择是完全避免使用对话框，因为它们不利于用户体验（[邪恶](https://stackoverflow.com/questions/361493/why-are-modal-dialog-boxes-evil)）。然后有替代解决方案，例如使用 UI 显示单独的屏幕/页面，要求用户在确实需要时提供一些输入，或者如果用户输入是可选的，则在侧面/边缘/角落的某处显示非模态弹出窗口并隐藏它经过片刻或其他不会破坏用户流程的通知。

如果您不同意或没有时间、资源或技能来实现替代方案 - 您可以围绕 MessageDialog.ShowAsync() 调用创建某种包装器，以便在已显示对话框时对任一队列或忽略新请求。

此类具有扩展方法，允许在已显示另一个对话框时忽略新的显示请求或将请求排队：

```
/// <summary>
/// MessageDialog extension methods
/// </summary>
public static class MessageDialogExtensions
{
    private static TaskCompletionSource<MessageDialog> _currentDialogShowRequest;

    /// <summary>
    /// Begins an asynchronous operation showing a dialog.
    /// If another dialog is already shown using
    /// ShowAsyncQueue or ShowAsyncIfPossible method - it will wait
    /// for that previous dialog to be dismissed before showing the new one.
    /// </summary>
    /// <param name="dialog">The dialog.</param>
    /// <returns></returns>
    /// <exception cref="System.InvalidOperationException">This method can only be invoked from UI thread.</exception>
    public static async Task ShowAsyncQueue(this MessageDialog dialog)
    {
        if (!Window.Current.Dispatcher.HasThreadAccess)
        {
            throw new InvalidOperationException("This method can only be invoked from UI thread.");
        }

        while (_currentDialogShowRequest != null)
        {
            await _currentDialogShowRequest.Task;
        }

        var request = _currentDialogShowRequest = new TaskCompletionSource<MessageDialog>();
        await dialog.ShowAsync();
        _currentDialogShowRequest = null;
        request.SetResult(dialog);
    }

    /// <summary>
    /// Begins an asynchronous operation showing a dialog.
    /// If another dialog is already shown using
    /// ShowAsyncQueue or ShowAsyncIfPossible method - it will wait
    /// return immediately and the new dialog won't be displayed.
    /// </summary>
    /// <param name="dialog">The dialog.</param>
    /// <returns></returns>
    /// <exception cref="System.InvalidOperationException">This method can only be invoked from UI thread.</exception>
    public static async Task ShowAsyncIfPossible(this MessageDialog dialog)
    {
        if (!Window.Current.Dispatcher.HasThreadAccess)
        {
            throw new InvalidOperationException("This method can only be invoked from UI thread.");
        }

        while (_currentDialogShowRequest != null)
        {
            return;
        }

        var request = _currentDialogShowRequest = new TaskCompletionSource<MessageDialog>();
        await dialog.ShowAsync();
        _currentDialogShowRequest = null;
        request.SetResult(dialog);
    }
} 
```

**测试**

```
// This should obviously be displayed
var dialog = new MessageDialog("await ShowAsync", "Dialog 1");
await dialog.ShowAsync();

// This should be displayed because we awaited the previous request to return
dialog = new MessageDialog("await ShowAsync", "Dialog 2");
await dialog.ShowAsync(); 

// All other requests below are invoked without awaiting
// the preceding ones to complete (dialogs being closed)

// This will show because there is no dialog shown at this time
dialog = new MessageDialog("ShowAsyncIfPossible", "Dialog 3");
dialog.ShowAsyncIfPossible();

// This will not show because there is a dialog shown at this time
dialog = new MessageDialog("ShowAsyncIfPossible", "Dialog 4");
dialog.ShowAsyncIfPossible();

// This will show after Dialog 3 is dismissed
dialog = new MessageDialog("ShowAsyncQueue", "Dialog 5");
dialog.ShowAsyncQueue();

// This will not show because there is a dialog shown at this time (Dialog 3)
dialog = new MessageDialog("ShowAsyncIfPossible", "Dialog 6");
dialog.ShowAsyncIfPossible();

// This will show after Dialog 5 is dismissed
dialog = new MessageDialog("ShowAsyncQueue", "Dialog 7");
dialog.ShowAsyncQueue();

// This will show after Dialog 7 is dismissed
dialog = new MessageDialog("ShowAsyncQueue", "Dialog 8");
dialog.ShowAsyncQueue(); 
```

# sql - SQL 仅当数据存在时从其他表中选择列

> ID：14488588
> 
> 赞同：1
> 
> 时间：2013-01-23T20:17:25.463
> 
> 标签：sql, sql-server

我有两个表，我从第一个表中选择数据。如果条件满足（别名类型 = 2）并且第二个表中存在第一个表中 id 的数据，我想从第二个表中选择列。这里有数据来解释更多：

**表格1**

```
id | Name         | Location  
---+--------------+---------  
34 |John Smith    |NewYork  
36 |Mike Smith    |London  
45 |Bob Smith     |Los Angeles 
```

**表 2**

```
id | Alias             | Alias type     
---+-------------------+-------  
36 |Warren Johnson     |1  
36 |William Williams   |2 
```

如果别名类型 = 2，则需要的结果

```
id |Name               | Location   
---+-------------------+---------  
34 |John Smith         |NewYork  
36 |William Williams   |London  
45 |Bob Smith          |Los Angeles 
```

你能帮我写查询以获得想要的结果吗？告诉我是否需要解释更多。我正在使用 SQL Server 数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:22:59.217

您可以`left outer join`在 Table2 上使用 a，然后[`COALESCE`](http://msdn.microsoft.com/en-us/library/ms190349.aspx)使用 Alias 和 Name 结果如下：

```
SELECT Table1.ID, COALESCE(Table2.Alias, Table1.Name) AS Name, 
    Table1.Location
FROM Table1
LEFT OUTER JOIN Table2 ON Table1.ID = Table2.ID AND Table2.AliasType = 2 
```

`COALESCE`通过在提供的值中查找第一个非空值来工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:22:40.833

尝试这样的事情 - 你只需要使用`CASE`：

```
SELECT T1.Id, 
   CASE WHEN T2.Alias IS NOT NULL THEN T2.Alias ELSE T1.Name END as Name,
   t1.Location
FROM Table1 T1
   LEFT JOIN Table2 T2 ON T1.Id = T2.Id AND T2.AliasType = 2 
```

这是[SQL 小提琴](http://sqlfiddle.com/#!3/8efa3/1)。

祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T20:23:03.587

COALESCE 函数将让您有一个备用表达式，以便使用表 2 中的名称（如果存在），否则使用表 1 中的名称。LEFT 外连接仅在行存在时连接表 2，如果没有连接记录，则 t2.name 为空。

`SELECT t1.id, COALESCE(t2.name, t1.name), t1.location FROM [Table 1] as t1 LEFT JOIN [Table 2] as t2 on t1.id=t2.id and t2.[alias type]=2`

# android - 如何在 Titanium Android 中永久选择/突出显示 TableView 行？

> ID：14488589
> 
> 赞同：1
> 
> 时间：2013-01-23T20:17:28.687
> 
> 标签：android, titanium, tableview

我有一个带有 Master / Detail 布局的平板电脑应用程序，在 Master 面板中有一个 TableView 可以更改 Detail 窗格的内容。我希望主行在单击时保持突出显示，就像在 android 操作系统设置中一样。

现在我能做的最好的事情就是将 设置`backgroundColor`为新颜色以响应`'click'`事件。但是，当我快速点击时，该行会突出显示，然后闪烁恢复正常，然后再次突出显示。我猜这是我抬起手指和背景颜色改变之间的延迟。

```
tableview.addEventListener('click', function(e) {
    ...
    else if (e.rowData.id == 3) { // scan history
        e.row.backgroundColor = 'blue'; 
```

这似乎是其他人的做法：http: [//developer.appcelerator.com/question/124359/android---tableviews-deselectrow](http://developer.appcelerator.com/question/124359/android---tableviews-deselectrow)

如果我只是使用 android 而不是 Titanium：[如何在单击时突出显示表格行？](https://stackoverflow.com/questions/4075356/how-can-i-highlight-the-table-row-on-click)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T22:44:08.747

试试这个。touch start 会立即被调用，而 click 通常不会。请注意，[根据文档](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.UI.TableViewRow-event-touchstart)，对于 iOS 和 Android，一个`scroll`事件和一个事件不能同时发生，因此如果您有一个 `touchstart` 侦听器`touch`，您可能还想处理该事件。`touchcancel`

```
tableview.addEventListener('touchstart', function(e) {
    ...
    // Get the source row, and then get its id
    else if (e.source.id == 3) { // scan history
        e.row.backgroundColor = 'blue'; 
}); 
```

**编辑：** 也许更好的方法是处理`touchend`事件。这将处理快速点击、用户滑动到不同行和滚动边缘情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-18T20:06:03.730

创建行时，请使用：

```
selectionStyle : "NONE" 
```

这可以防止它在点击/触摸时改变颜色

并滚动您自己的事件侦听器来准确控制您的行何时突出显示。

iOS 蓝色行选择颜色类似于：“#006EF1”

# javascript - Android 2.3 上的 JavaScript – “这个”不起作用？

> ID：14488593
> 
> 赞同：1
> 
> 时间：2013-01-23T20:17:42.863
> 
> 标签：javascript, android

我有一堂课的结构是这样的

```
function myClass () {
    this.varA = 0;
}

myClass.prototype.consts = {
    someConst : 1,
    anotherConst : 1000,
}

myClass.prototype.startIt = function () {
    window.setTimeout(this.brokenFunc.bind(this), this.consts.anotherConst);
}

myClass.prototype.brokenFunc = function () {
    this.varA += this.consts.someConst;

    window.setTimeout(this.brokenFunc.bind(this), this.consts.anotherConst); 
}

// Example call
var myObj = new myClass();
myObj.startIt(); 
```

这在大多数 Android 设备上都可以正常工作——但运行 Android 2.3 的用户现在告诉我它不起作用，我可以在模拟器中重现该错误。首先，它`TypeError: Result of expression 'this.brokenFunc.bind' [undefined] is not a function`针对这一行（在 内`startIt`）说：

```
window.setTimeout(this.brokenFunc.bind(this), this.consts.anotherConst); 
```

很公平，我想，并用老`var _this = this`把戏来绕过`bind`电话。但现在它`TypeError: Result of expression 'this.consts' [undefined] is not an object`在这一行中说

```
this.varA += this.consts.someConst; 
```

我有点迷路了。这段代码*怎么行不通*？特别是因为它适用于大多数 Android 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:32:16.247

默认情况下，`setTimeout`调用`this`全局对象的函数（即，`window`在浏览器中）。（旁注：在严格模式下，它是`undefined`。）因此，当您不使用时`bind`，`this` `brokenFunc`现在是`window`而不是注册超时的对象。

为了保留`this`from `startIt`，您需要将调用包装在匿名函数中：

```
myClass.prototype.startIt = function () {
    var that = this;

    window.setTimeout(function() {
        // call brokenFunc with the outer this
        that.brokenFunc();
    }, this.consts.anotherConst);
} 
```

您的第一个错误发生是因为 Android 2.3 浏览器不支持 EMCAScript 5`bind`功能。出现第二个错误是因为`this.consts`is really `window.consts`，它不存在。`that`只需将调用包装在其范围内的匿名函数中，然后从`that`.

# html - Adobe AIR HTML+JavaScript 应用程序与硬件加速

> ID：14488595
> 
> 赞同：1
> 
> 时间：2013-01-23T20:17:47.987
> 
> 标签：html, air, hardware-acceleration, webkit-transform

我正在为手机和台式机开发一个 HTML 应用程序。该应用程序针对基于 WebKit 的环境进行了优化。为了提高渲染速度，我正在使用硬件加速层（诸如此类`-webkit-transform: translateZ(0);`...）。

这在我的 iOS 设备上效果很好（使用 PhoneGap aka Cordova 来打包“本机”应用程序）。

在 Windows 和 OS X 上，我使用 Adob​​e AIR 3.5 来打包一个基于 HTML/JavaScript 的强制运行时应用程序。我发现这是最好的解决方案（目前），即使我尝试了许多其他解决方案（适用于 Windows 7 / OS X、TideSDK 的 Cordova，...）。

关键是 Adob​​e AIR 中的 HTML 渲染似乎没有经过硬件加速。你们中有人有这方面的经验吗？这里有可能在 AIR HTML 渲染中启用硬件加速层吗？

非常感谢 ：）

# python - 如何修复 Python Nose：覆盖不可用：无法导入覆盖模块

> ID：14488601
> 
> 赞同：59
> 
> 时间：2013-01-23T20:17:53.307
> 
> 标签：python, nose, coverage.py, python-coverage

尽管安装了插件，但我似乎无法使用 Nose 获得代码覆盖率。

有想法该怎么解决这个吗？

```
12:15:25 ~/sandbox/ec$ nosetests --plugins
Plugin xunit
Plugin deprecated
Plugin skip
Plugin multiprocess
Plugin failuredetail
Plugin capture
Plugin logcapture
Plugin coverage
Plugin attributeselector
Plugin doctest
Plugin profile
Plugin id
Plugin allmodules
Plugin collect-only
Plugin isolation
Plugin pdb

12:15:34 ~/sandbox/ec$ nosetests -v --with-coverage
nose.plugins.cover: ERROR: Coverage not available: unable to import coverage module
tests.edgecast_client_tests.test_log ... ok

----------------------------------------------------------------------
Ran 1 test in 0.206s

OK 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-01-23T20:28:11.493

你试过`pip install coverage`吗？覆盖插件依赖于单独的覆盖模块，它不是鼻子的依赖，所以需要手动安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-11T05:58:02.760

验证覆盖模块是否通过`coverage --version`. 我有一个案例，由于我从源代码安装的 python 中缺少 SQLite 模块，它无法正常工作。我重新安装了带有 SQLite 扩展的 python 来解决这个问题。

# ruby-on-rails - 无法安装 ZenTest 4.8.4

> ID：14488605
> 
> 赞同：10
> 
> 时间：2013-01-23T20:18:04.723
> 
> 标签：ruby-on-rails, gem, zentest

当我尝试安装 ZenTest 时：

```
gem install ZenTest 
```

我收到以下错误：

> [C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/specifications/ZenTest-4.8.4.gemspec] 中的无效 gemspec：不正确的要求 ["< 2.1, >= 1.8"]

我尝试清理 gem 并删除 ZenTest 无济于事。

怎么了？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-23T21:44:51.450

我刚刚与 ZenTest 的作者 Ryan Davis 进行了交谈。他告诉我这是由于 RubyGems 中的一个错误，他们正在准备一个修复它的版本。

同时，降级到 4.8.3。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T19:21:25.090

将 ruby​​gems 更新到 1.8.25 似乎可以解决问题（[https://github.com/seattlerb/zentest/issues/28](https://github.com/seattlerb/zentest/issues/28)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-30T07:41:04.780

要清理 gem，请将 gemspec 文件移动到其他位置。

例如：在 ubuntu 中清理 gem，做

```
sudo mv /var/lib/gems/1.8/specifications/ZenTest-4.8.4.gemspec /var/tmp/ 
```

# java - parseDouble 为非空变量抛出 NullPointerException

> ID：14488611
> 
> 赞同：1
> 
> 时间：2013-01-23T20:18:28.047
> 
> 标签：java, android, eclipse, nullpointerexception

我很想得到第二眼的帮助，因为我一直在努力找出我的代码出了什么问题。

在 Eclipse IDE 中，我试图实现一个 Google Maps 活动，该活动从 assets 文件夹 ( */assets/mmsi.txt* ) 中的文件中读取 seaship MMSI 代码，并将地图标记添加到它们各自的位置。我可以使用该类从该文件中读取，但在使用该函数将结果行`BufferedReader`转换为双精度时遇到问题。`String``Double.parseDouble`

LogCat 检测到以下问题。

```
01-23 17:59:11.672: E/AndroidRuntime(18242): FATAL EXCEPTION: main
01-23 17:59:11.672: E/AndroidRuntime(18242): java.lang.RuntimeException: Unable to resume activity {com.aquamet.saramap/com.aquamet.saramap.MainActivity}: java.lang.NullPointerException
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:3128)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:3143)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2684)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.os.Looper.loop(Looper.java:123)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.main(ActivityThread.java:4627)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at java.lang.reflect.Method.invokeNative(Native Method)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at java.lang.reflect.Method.invoke(Method.java:521)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:876)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:634)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at dalvik.system.NativeStart.main(Native Method)
01-23 17:59:11.672: E/AndroidRuntime(18242): Caused by: java.lang.NullPointerException
01-23 17:59:11.672: E/AndroidRuntime(18242):    at com.aquamet.saramap.MainActivity.getMMSI(MainActivity.java:173)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at com.aquamet.saramap.MainActivity.setupRegion(MainActivity.java:136)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at com.aquamet.saramap.MainActivity.onResume(MainActivity.java:82)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1149)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.Activity.performResume(Activity.java:3827)
01-23 17:59:11.672: E/AndroidRuntime(18242):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:3118)
01-23 17:59:11.672: E/AndroidRuntime(18242):    ... 12 more 
```

换句话说，以下代码中似乎存在 NullPointerException：

```
private double[] getMMSI() throws IOException {
        AssetManager am = this.getAssets();
        double[] mmsi = null;
        BufferedReader br = null;

        try {
            InputStream  file_stream = am.open("mmsi.txt");
            br = new BufferedReader(new InputStreamReader(file_stream));
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        String line;
        for (int i=0; (line = br.readLine()) != null; i++) {
                // Following line seems to be the problem (line 173).
                mmsi[i] = Double.parseDouble(line);
        }

        try {
            br.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
} 
```

但是，在调试变量时`line`实际上不为空！（抱歉没有足够的 REP 用于图像） [调试屏幕截图](http://i45.tinypic.com/nnqfdz.png)

另一个 SO 用户也有类似的问题，但他的变量似乎没有正确初始化。 [parseDouble 在我的代码中抛出空指针 [关闭]](https://stackoverflow.com/questions/13016634/parsedouble-throwing-null-pointer-in-my-code)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T20:19:54.897

`Double.parseDouble`不是问题。你的任务是：

```
double[] mmsi = null;
...
// mssi is still null...
mmsi[i] = Double.parseDouble(line); 
```

您永远不会将非空值分配给`mmsi`，因此当您尝试写入它时会出现错误。如果您想进一步证明这一点，请将您的代码拆分为：

```
double tmp = Double.parseDouble(line);
mmsi[i] = tmp; 
```

您会看到异常发生在*第二*行，而不是第一行。

鉴于您不知道需要多少行，我建议您使用 an`ArrayList`代替：

```
List<Double> mmsi = new ArrayList<Double>();
...
mmsi.add(Double.valueOf(line)); 
```

编辑：此外，您应该在一个`finally`块中关闭您的文件。目前，如果在您阅读时抛出异常，您将保持文件打开。而且您当前的`catch`块实现并不像让异常被抛出那样有用，IMO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:23:32.593

问题在于：`double[] mmsi = null;`

您尚未创建阵列。

尝试：

```
double[] mmsi = new double[10]; // or your desired array size 
```

有关数组的更多信息：[Java 中的数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:24:06.640

双精度数组 mmsi 从未初始化为引用除空引用之外的某些内容。因此，NPE

```
 double[] mmsi = null; 
```

# css - @font-face 字体渲染在 Windows 上不太顺利

> ID：14488613
> 
> 赞同：0
> 
> 时间：2013-01-23T20:18:42.603
> 
> 标签：css, google-chrome, firefox, font-face, truetype

我最近一直在使用@font-face 并开始在我的 vbox 上进行测试。原来字体渲染得不是很好。我研究了 Firefox，我一直看到的只是关闭硬件加速。我们不能指望每个用户都这样做。Chrome 也这样做。尝试了该`Anti-aliasing`属性，但没有运气。您可以在下面看到结果图片： ![在此处输入图像描述](../Images/b15ae7fcbab0d9f8ac7a89d8b06d9b2c.png)

[Win] FireFox、Chrome [Mac] Chrome、FireFox

如您所见，左边的两个渲染得非常差，而右边的两个则很棒。他们正在使用这个：

```
@font-face{
  font-family: "gBok";
  font-weight: bold;
  font-style: normal;
  src: url(/font/gotham-bold.ttf) format("truetype");
}
@font-face{
  font-family: "gBok";
  font-weight: normal;
  font-style: normal;
  src: url(/font/gotham-book.ttf) format("truetype");
}
label {
font-family: "gBok", Helvetica, serif;
font-weight: bold;
} 
```

有什么我做错了吗？有什么建议吗？非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:42:14.970

这确实是一个已知的问题和一个真正的痛苦！我通常删除粗体的字体，让操作系统生成它自己的粗体版本。它有时会产生更好的结果，尽管并不完美。不过值得一试...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:26:32.770

这是 Chrome 的一个已知错误——它们在 Windows 上的字体渲染非常粗糙。不要使用抗锯齿的东西，当他们最终修复它时，那会让它看起来更糟！[https://code.google.com/p/chromium/issues/detail?id=137692](https://code.google.com/p/chromium/issues/detail?id=137692)

# java - 长度小于 4 的字符串的字节缓冲区异常

> ID：14488621
> 
> 赞同：2
> 
> 时间：2013-01-23T20:19:18.593
> 
> 标签：java, string, bytebuffer

我正在尝试使用`ByteBuffer`( `java.nio.ByteBuffer`) 将字符串转换为其整数等价物以便更快地进行比较。

我使用`ByteBuffer`.

```
public class LargeCompare {

    public static void main(String args[]){
        byte[]b ="zzz".getBytes();
        ByteBuffer bb = ByteBuffer.wrap(b);
        bb.getInt();
    }
} 
```

上面的代码不会为长度为 4 的字符串引发异常，但会为长度为 3 及以下的字符串引发异常。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:22:19.567

An`int`是 32 位或 4 字节宽。您正在尝试`int`从比这短的缓冲区中读取一个。这就是您遇到异常的原因。

我并没有真正遵循您的想法，因此不会提出建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:23:32.830

嗯，从文档中：

> 抛出： BufferUnderflowException - 如果此缓冲区中剩余的字节少于四个

你只有 3 个字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T06:58:28.343

这是解决方案...

```
public class LargeCompare {

public static void main(String args[]){
    String str = "A";
    System.out.println(bytesToInt(str.getBytes()));
}

public static int bytesToInt(byte[] byteArray){          
    int value= 0;
    for(int i=0;i<byteArray.length;i++){                
    int x=(byteArray[i]<0?(int)byteArray[i]+256:(int)byteArray[i])<<(8*i);             
        value+=x;
    }         
    return value;       
}} 
```

I have tested this code, working without any issues...

# c# - 旧数据文件到图表

> ID：14488623
> 
> 赞同：0
> 
> 时间：2013-01-23T20:19:20.410
> 
> 标签：c#, dataset, datasource, raw-data

我的程序应该：

1.  从旧的原始数据文件加载数据表。
2.  提供显示、过滤、图表等界面。

我的方法是创建一个内存数据库作为数据源，用于绑定过滤器控件、结果网格、图形等。

**问题：** 定义和填充这个内存数据库的最简单方法是什么？

**编辑：** 我对 LINQ 的了解很少。过去，我总是能够将数据库表或查询拖到表单或网页中。Visual Studio 会为我创建 DataSet、DataTable、DataSource 等对象。

... 我在哪里定义这个结构（XML 文件、代码内、向导、拖放）？我需要什么数据对象？ETC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:03:38.423

您可以创建包含必要属性的类，然后简单地解析文件并将这些类填充到内存中。给你，你有一个内存数据库。

> 我对 LINQ 的了解很少

这是一个好的开始：[http ://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)

> 我在哪里定义这个结构（XML 文件、代码内、向导、拖放）？

如果要将数据存储在内存中，请定义与您的数据匹配的强类型 C# 类。

> 我需要什么数据对象？

这完全取决于您在文件中拥有哪些信息以及您想要处理的信息。

# javascript - 将类添加到 div，每个 div 的数字都会增加

> ID：14488625
> 
> 赞同：1
> 
> 时间：2013-01-23T20:19:23.870
> 
> 标签：javascript, jquery, iteration

我想将一个类“slide-number-x”添加到滑块中每张幻灯片内的元素中，“x”代表 dom 中的幻灯片编号。

因此，例如这个简单的 HTML 标记：

```
<div class="slider">
    <div class="slide"><div class="slide-title"></div></div>
    <div class="slide"><div class="slide-title"></div></div>
    <div class="slide"><div class="slide-title"></div></div>
    <div class="slide"><div class="slide-title"></div></div>
</div> 
```

会成为：

```
<div class="slider">
    <div class="slide slide-number-1"><div class="slide-title"></div></div>
    <div class="slide slide-number-2"><div class="slide-title"></div></div>
    <div class="slide slide-number-3"><div class="slide-title"></div></div>
    <div class="slide slide-number-4"><div class="slide-title"></div></div>
</div> 
```

我认为这会起作用：

```
$('.slide').each(function(i){
  $(this).addClass('slide-number'i+1);
}); 
```

有什么帮助或想法吗？

非常感谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T20:20:32.103

您忘记了连接运算符 ( `+`)，请使用：

```
$('.slide').each(function(i){
  $(this).addClass('slide-number-' + (i+1));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:21:15.757

看起来应该是：

```
$(this).addClass('slide-number-' + (i + 1)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:25:00.840

这给了你你想要的

```
$('.slide').each(function(i){
  $(this).addClass('slide-number-' + (i+1));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:26:35.377

你 + 是在错误的地方......试试这个。它对我有用...

```
$('.slide').each(function(i){
  $(this).addClass('slide-number'+i);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:27:31.230

您缺少连接运算符。此外，在 JavaScript 中递增值的约定是双加号。

```
$('.slide').each(function(i){
  $(this).addClass('slide-number-' + ++i);
}); 
```

# maven - Maven-2：模块依赖于同一项目中的另一个（两个问题）

> ID：14488627
> 
> 赞同：0
> 
> 时间：2013-01-23T20:19:28.873
> 
> 标签：maven, maven-2, module, multi-module

这是我的文件系统设置：

```
.m2/                 <--- Local Directory
app/
    pom.xml
    module1/
    module2/
    module3/
    target/          <--- Package directory 
```

**问题一**

在 parent`pom.xml`中，它具有所有模块所依赖的依赖项。但是，当它进入`compile`阶段时，`module2`将需要依赖刚刚编译的东西，`module1`并且`module3`需要依赖`module2`. 如果不创建两个或三个“maven 项目”，您将如何做到这一点？是否可以一次单独运行每个模块上的`compile`、`install`和`package`阶段（我宁愿做这个解决方案）？

**问题 B**

另外，我知道当您`install`使用模块时，所有“东西”都会更新并添加到本地存储库中。当您处于`compile`阶段时，默认情况下，它会从本地存储库中获取它需要依赖的所有内容（如果我错了，请纠正）。另外，如果我能够实现*Question A*，而不是使用本地 repo 来获取我的依赖项所需的所有信息，是否可以使用打包`target`目录中的相同文件来代替？

这些问题可以通过简单的 pom 操作和/或添加插件来回答吗？如果这是可能的，我将如何去做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T04:41:29.897

Maven 是基于一个项目-一个工件的想法构建的。在您描述的情况下，您通常会做的是在每个模块中创建一个单独的 POM，并将顶级 POM 指定为父级。然后，每个子模块将继承父模块的依赖关系，并可以自由添加额外的模块特定依赖关系。然后在顶层 Pom 中使用声明来声明三个子模块。

一个关键优势是，如果子模块之间存在依赖关系（如您所描述的），那么 maven 将根据这些依赖关系自动找出构建它们的正确顺序。

# ruby-on-rails - 更新一个模型并以一种形式创建另一个模型 Rails 3.2.5

> ID：14488629
> 
> 赞同：0
> 
> 时间：2013-01-23T20:19:41.823
> 
> 标签：ruby-on-rails, ruby, forms, nested

我有一种可以完美创建两个模型的表单，但是，有没有办法更新其中一个模型并创建另一个模型？恢复：我有一个用于创建约会的表格，我也可以为此约会创建人。

```
def new
  @Cita = Cita.new
  @Cita.build_paciente

  render :new
end

def create

 @Cita = Cita.new(params[:cita])

 if @Cita.save
  redirect_to :action => 'hoy'
 else
  render  'new' 
```

结尾

当我一次创建两个模型时，这工作得很好，但是如果我填写人员字段......我该如何更新人员属性（“paciente”）并为那个人创建约会（“Cita”） .

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:54:42.320

最后我解决了它，在人员表单上添加了一个填充 person_ID 的隐藏字段。当您在模型属性中发送 ID 时，rails 会对该模型进行更新而不是插入，同时创建与嵌套模型相关联的其他模型。如果这个隐藏字段为空，rails 会同时创建两个模型。

# php - Travis CI 在 PHP 项目中忽略 .travis.yml，只构建主分支

> ID：14488637
> 
> 赞同：0
> 
> 时间：2013-01-23T20:20:07.967
> 
> 标签：php, phpunit, composer-php, travis-ci

我在名为“3.0”的分支中有一个非常简单的[`.travis.yml`配置文件：](https://github.com/naoisegolden/Aixada/blob/61aaa8ac178e6e1b6d16a772305bd709cdf86f78/.travis.yml)

```
language: php

php:
 - 5.3
 - 5.4

branches:
  only:
   - 3.0

before_script:
 - composer install --dev 
```

对于[带有 PHPUnit 测试和 Composer 的 Silex 项目](https://github.com/naoisegolden/Aixada/tree/3.0)。[对分支 3.0 的提交](https://github.com/naoisegolden/Aixada/commit/61aaa8ac178e6e1b6d16a772305bd709cdf86f78)触发[了 Travis CI](https://travis-ci.org/naoisegolden/Aixada/builds/4339277)中的此构建，该构建忽略了配置文件并尝试构建没有`.travis.yml`文件的主分支，因此构建失败，因为它尝试将其作为 Ruby on Rails 项目运行.

为什么 Travis CI 会忽略我的`.travis.yml`配置文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T22:22:40.567

来自[Travis 的文档](http://about.travis-ci.org/docs/user/build-configuration/#Specify-branches-to-build)：

> 请注意，目前（出于历史原因），.travis.yml 需要出现在项目的所有活动分支上。

所以这意味着，你实际上必须`.travis.yml`在你的主分支上有一个，即使你没有在那里使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-16T12:00:34.277

您现在可以进入[存储库设置](http://blog.travis-ci.com/2014-03-05-repository-settings/)并将设置切换为仅使用 .travis.yml 文件构建提交，这意味着任何没有 .travis.yml 文件的分支都将被忽略。

# java - Java迭代巨大的数据库表

> ID：14488650
> 
> 赞同：4
> 
> 时间：2013-01-23T20:20:49.097
> 
> 标签：java, jdbc, iteration, yield-return, large-data

我在 c# 中有一个程序，它使用 yield return 迭代一个非常大的数据库查询。然后调用方法通过在 parallel.for each 中调用 IEnumerable 来处理每个对象。Java没有yield return，我在Java中看到的yield return的所有实现都非常混乱。

有没有人可以建议将行从 dB 流式传输到调用方法的另一种方法？到目前为止，我正在考虑将我们需要运行的方法放在 SQL 迭代器中（我们使用 jdbc），但这也使代码审查变得困难，因为它在某种程度上掩盖了读取器循环中的关键方法。

我会提供示例代码，但我希望有一个更高级的想法，因为这个问题以及阅读非常大的文本文件对我们来说很常见，c# yield return 在这方面很棒。

# javascript - 为什么 focus() 不像它应该的那样工作？

> ID：14488652
> 
> 赞同：0
> 
> 时间：2013-01-23T20:20:52.987
> 
> 标签：javascript, jquery

```
<DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" dir="ltr" lang="en">
<head>
    <script src="../js/third_party/jq142unmin.js"></script>
    <script>
        $(document).ready( function(){
            $("#set_focus1").click(function(){
                console.log($("#input1").focus());
            });
            $("#set_focus2").click(function(){
                console.log($("#input2").focus());
            });
        });
    </script>
</head>
<body>
    <input id="input1"></input>
    <input id="input2"></input>
    <button id="set_focus1">Set Focus1</button>
    <button id="set_focus2">Set Focus2</button>
</body>
</html> 
```

![在此处输入图像描述](../Images/9b0db74127415602f4593835345ebe12.png)

代码本身就像我认为的那样工作，例如，单击按钮将焦点集中在一个输入或另一个上。但是如果我从控制台尝试同样的事情，它没有任何效果（没有错误消息，只是什么都不做）。如上所示，我尝试了几种不同的方法。

在这些输入元素上从控制台执行的其他 jQuery 函数，例如。$("#input1").val("foo")，就像我期望的那样工作。focus() 有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:26:35.093

我刚刚复制了这个，这不是错误，它只是浏览器如何处理您的输入。当您使用开发人员工具时，该页面没有您的标线，因此不会将其传递给另一个元素。

该元素实际上确实得到了“聚焦”。在您的浏览器中运行它，您会看到该`focus()`事件确实触发了，但是当您注意另一个窗口时，浏览器不会强制您切换到该页面。

```
$("#input1").on("focus", function(){  alert("focused")  });
$("#input1").focus(); 
```

这将触发警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:28:22.467

控制台与浏览器窗口是分开的。所以当你在控制台执行一些命令时，焦点不会移动到html窗口。这就是为什么你没有得到预期的结果。

`$("#input1").val("foo")`正在设置 DOM 元素的值。因此它将更改值并将光标保留在控制台中。

要验证`$("#input1").focus()`您可以在焦点事件中放置一个警报，然后从控制台调用该事件。

# apache - 在远程服务器上安装 Symfony

> ID：14488653
> 
> 赞同：2
> 
> 时间：2013-01-23T20:20:53.907
> 
> 标签：apache, symfony

我正在尝试评估 Symfony 2 (2.1.7)。我正在按照已经在 Apache 上运行 PHP 5.3.20 的 EC2 实例上[的下载说明安装它。](http://symfony.com/download)

我被困在 README.md 的第二步：“`config.php`从浏览器访问脚本”。自述文件假定本地安装并提供到 localhost: 的示例 URL `http://localhost/path/to/symfony/app/web/config.php`。

由于我在远程服务器上，因此我尝试使用相关 URL: 访问 config.php 文件，该 URL`http://mysite.com/Symfony/app/check.php`会返回以下消息：

**禁止的**

您无权访问此服务器上的 /Symfony/app/check.php。

我尝试应用[如何远程访问 symfony config.php 中的答案？](https://stackoverflow.com/questions/12870243/how-do-i-access-to-symfony-config-php-remotely)通过将 PHP 报告的内容添加为我的 REMOTE_ADDR，但这不会改变消息。

现在我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:42:13.787

在 symfony 中，web 文件夹应该是你的 webroot。因此，如果您想访问 \project\web\config.php，您应该将浏览器指向[http://www.example.com/config.php](http://www.example.com/config.php)。

如果这不起作用，则可能是 apache 配置不正确。确保它指向您的 web 目录，而不是您的项目目录。

*编辑*正如您在问题中提到的，您还需要编辑 config.php 文件以允许远程访问。您可以将这些行注释掉，或将您的 IP 添加到白名单中。

*edit2*许多虚拟主机不允许您指定您的 webroot。在这种情况下，您可以将 Symfony 文件放在不同的目录中，并在 Symfony web 目录和您的 webroot 之间创建一个符号链接。

# c# - 数据库中的外键重复

> ID：14488654
> 
> 赞同：0
> 
> 时间：2013-01-23T20:21:00.803
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-5

一些外键在我的合同表中创建了双倍。（文章和客户）。公司还可以！

我的模型：

```
public class Contract {
    [Key]
    public int ContractID { get; set; }
    public double PricePerUnit { get; set; }
    public int Unit { get; set; }
    public int Currency { get; set; }

    [Required]
    public int ClientID { get; set; }
    public virtual Client Client { get; set; }

    [Required]
    public int CompanyID { get; set; }
    public virtual Company Company { get; set; }

    [Required]
    public int ArticleID { get; set; }
    public virtual Article Article { get; set; }

}

public class Client {
    [Key]
    public int ClientID { get; set; }
    public string Number { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string ZipCode { get; set; }
    public string City { get; set; }
    public string AddressLine1 { get; set; }
    public string AddressLine2 { get; set; }
    public string Memo { get; set; }
    public bool isMerchant { get; set; }

    public string Name
    {
        get
        {
            return string.Format("{0} {1}", FirstName, LastName);
        }
    }

    //[Required]
    public int? MerchantReferenceID { get; set; }
    public virtual Client MerchantReference { get; set; }
    [Required]
    public int CompanyID { get; set; }
    public virtual Company Company { get; set; }
    public virtual ICollection<Contract> Contracts { get; set; }
    public virtual ICollection<Order> Orders { get; set; }
}

public class Company
{
    [Key]
    public int CompanyID { get; set; }
    public string Name { get; set; }
    public int DeviceIncomingWeight { get; set; }
    public string ZipCode { get; set; }
    public string AddressLine1 { get; set; }
    public string AddressLine2 { get; set; }
    public string City { get; set; }
    public bool Admin { get; set; }
    public int UnitForMeasurements { get; set; }
    public int UnitForDisplayOnDocuments { get; set; }

    public virtual ICollection<User> Users { get; set; }
    public virtual ICollection<Category> Categories { get; set; }
    public virtual ICollection<Article> Articles { get; set; }
    public virtual ICollection<Client> Clients { get; set; }
    public virtual ICollection<Location> Locations { get; set; }
    public virtual ICollection<Contract> Contracts { get; set; }
    public virtual ICollection<IncomingMeasurement> IncomingMeasurements { get; set; }
    public virtual ICollection<Measurement> Measurements { get; set; }
    public virtual ICollection<Order> Orders { get; set; }
}

public class Article {
    [Key]
    public int ArticleID { get; set; }
    [Required]
    public string Code { get; set; }
    public string Name { get; set; }
    public bool TrackStock { get; set; }
    public int CurrentStock { get; set; }
    public double? Price { get; set; }

    [Required]
    public int CompanyID { get; set; }
    public virtual Company Company { get; set; }
    [Required]
    public int CategoryID { get; set; }
    public virtual Category Category { get; set; }

    public virtual ICollection<Contract> Contracts { get; set; }
    public virtual ICollection<Order> Orders { get; set; }
} 
```

这是我的 OnModelCreating，可能是错误所在：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
       // modelBuilder.Entity<Contract>().HasRequired(bm => bm.Company).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Contract>().HasRequired(bm => bm.Article).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Contract>().HasRequired(bm => bm.Client ).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Article>().HasRequired(bm => bm.Company).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Measurement>().HasRequired(bm => bm.Company).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Order>().HasRequired(bm => bm.Client).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Order>().HasRequired(bm => bm.Article).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<IncomingMeasurement>().HasRequired(bm => bm.client).WithMany().WillCascadeOnDelete(false);
        modelBuilder.Entity<Client>().HasOptional(c => c.MerchantReference).WithMany().HasForeignKey(c => c.MerchantReferenceID);

        //Required fields

        base.OnModelCreating(modelBuilder);
    } 
```

在我的数据库（我的 sql 服务器）中发生了一些奇怪的事情，即这是我的创建表模式。

这些是我的领域：

```
CREATE TABLE [dbo].[Contracts](
[ContractID] [int] IDENTITY(1,1) NOT NULL,
[PricePerUnit] [float] NOT NULL,
[Unit] [int] NOT NULL,
[Currency] [int] NOT NULL,
[ClientID] [int] NOT NULL,
[CompanyID] [int] NOT NULL,
[ArticleID] [int] NOT NULL,
[Client_ClientID] [int] NOT NULL,
[Article_ArticleID] [int] NOT NULL,
[Client_ClientID1] [int] NULL,
[Article_ArticleID1] [int] NULL, 
```

如果您注意到，[Client_ClientID] 有一个重复项：[Client_ClientID1] 和 [Article_ArticleID1] 中的 [Article_ArticleID]。但公司没有。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:29:47.013

发生这种情况是因为您在实体类中包含了一个冗余（外键）列。例如，查看您`Contract`班级中的类别。

```
public class Contract
{
    public Int32 CategoryID { get; set; }

    public virtual Category Category { get; set; }
} 
```

您手动指定一个属性和列`CategoryID`，然后实体框架生成另一个列来保存该`Category`属性引用的外键`Category`。

因此，如果您需要引用类别的 ID，只需删除该属性`CategoryID`并改用该属性即可。`contract.Category.CategoryID`

*更新*

我不知道包含外键属性的建议，但查看评论中链接到 Jeff Siever 答案的文章，我可能在*配置非常规外键名称*部分中找到了答案。

实体框架使用约定来匹配导航属性和外键属性的名称，默认约定是`NavigationPropertyNameId`或者`NavigationPropertyName_Id`当你使用`NavigationPropertyNameID`大写时`D`。

因此，您有多种选择 - 将您的命名更改为使用`Id`、替换约定或覆盖约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:25:58.250

消除模型中的重复信息。不需要引用对象的 id，这是导致您的问题的原因。

```
public class Contract {
    [Key]
    public int ContractID { get; set; }
    public double PricePerUnit { get; set; }
    public int Unit { get; set; }
    public int Currency { get; set; }

    public virtual Client Client { get; set; }

    public virtual Company Company { get; set; }

    public virtual Article Article { get; set; }
} 
```

而不是 id 上的 Required 属性，您需要设置您的实体，以便孩子是必需的。

# .net - Windows 窗体构造函数不接受参数

> ID：14488655
> 
> 赞同：-1
> 
> 时间：2013-01-23T20:21:04.797
> 
> 标签：.net, vb.net, constructor

如果 Form 对象是使用参数创建的，为什么在填写 Form 值时会出错？

错误是：

> 对非共享成员的引用需要对象引用。

### 文件 ParentForm.vb

```
Public Class Maincls
Dim oChildForm as New ChildForm("abc") ' Causes an error, but removing the arguments removes the error
Dim oChildForm as New ChildForm ' Does not throw an error
Public Sub btnok_click
ChildForm.tbXYZ.Text = "abc"    ' Reference to non-shared member needs an object reference
End Sub

End Class 
```

### 文件 ChildForm.vb

```
Public Class ChildForm

    Public Sub New(tempString as String)
        InitializeComponent()
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:29:56.167

在 btnok 的处理程序中，您使用的是类名而不是您创建的实例的名称。这应该这样做。

```
Public Class Maincls

    Dim oChildForm as New ChildForm("abc") 'Causes Error, but removing the arguments removes the error
    Dim oChildForm as New ChildForm 'Does not thow error

    Public Sub btnok_click
        oChildForm.tbXYZ.Text = "abc"    'Reference to non-shared member needs an object reference
    End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:29:15.570

在按钮单击事件中，将 ChildForm 更改为 oChildForm。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T03:12:37.493

对于构造函数，您必须定义一个值，例如：

```
Sub New() ' You can use "Overload" if it needs to be shared or no shared
          ' for a non-shared member

End Sub

Public Class ChildForm

    Private valStr As String

    Public Sub New(ByVal str As String)
        Me.valStr = str ' Shared Memeber
    End Sub

    Public Property Text As String
        Get
            Return valStr
        End Get
        Set(ByVal value As String)
            valStr = value
        End Set
    End Property

End Class 
```

如何使用：

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) _
  Handles Button2.Click

    Dim a As New ChildForm("Contoh")
    MsgBox(a.Text)
End Sub 
```

或者：

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) _
  Handles Button2.Click

    Dim a As New ChildForm
    a.Text = "Test"
    MsgBox(a.Text)
End Sub 
```

# c# - ComboBox SelectionChangeCommitted 事件不适用于 AutoComplete

> ID：14488659
> 
> 赞同：8
> 
> 时间：2013-01-23T20:21:17.317
> 
> 标签：c#, winforms, autocomplete, combobox

这是一个简短的程序，可以重现我刚刚遇到的问题。这是在带有 .NET 4.0 的 MS Windows 7 下编译的，以防万一。

```
using System;
using System.Drawing;
using System.Windows.Forms;

// Compile with "csc /target:exe /out:comboboxbug.exe /r:System.dll /r:System.Drawing.dll /r:System.Windows.Forms.dll comboboxbug.cs"
// in a Visual Studio command prompt.

static class Program
{
    [STAThread]
    static void Main()
    {
        //Create a label.
        Label oLabel = new Label();
        oLabel.Location = new Point (10, 10);
        oLabel.Size = new Size (100, 15);
        oLabel.Text = "Combo box bug:";

        // Create a combo-box.
        ComboBox oComboBox = new ComboBox();
        oComboBox.Location = new Point (10, 50);
        oComboBox.Size = new Size (150, 21);
        oComboBox.Items.AddRange (new object[]
            { "A", "A B", "A C", "A B C", "A C B", "A B C D", "A C B D" });
        oComboBox.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
        oComboBox.AutoCompleteSource = AutoCompleteSource.ListItems;
        oComboBox.SelectionChangeCommitted
            += new EventHandler (comboBox_SelectionChangeCommitted);

        // Create a form.
        Form oForm = new Form();
        oForm.Size = new Size (200, 150);
        oForm.Controls.Add (oLabel);
        oForm.Controls.Add (oComboBox);

        // Run this form.
        Application.Run (oForm);
    }
    static void comboBox_SelectionChangeCommitted (object sender,
        EventArgs e)
    {
        MessageBox.Show ("SelectionChangeCommitted");
    }
} 
```

单击组合框的文本部分并键入“A”。您将获得自动完成建议的列表。用鼠标单击其中一个选项。事件`SelectionChangeCommitted`不会发生！

选择一个菜单项而不使用自动完成。您将收到一个消息框，显示该`SelectionChangeCommitted`事件已发生！

鉴于在这两种情况下用户都更改了选择，在这两种情况下都不`SelectionChangeCommitted`应该调用吗？

使用`SelectedIndexChanged`事件不是一个选项，因为对于这个罐头示例背后的应用程序，我只希望它在用户进行选择时发生，而不是在以编程方式设置时发生。

编辑 2020 年 10 月 28 日：我发现了另一个`SelectionChangeCommitted`没有被调用的案例！甚至不需要为问题发生设置自动完成！单击以打开组合框，按与组合框项目之一的开头匹配的键，然后按 Tab 键离开。组合框项目被选中，但`SelectionChangeCommitted`未被调用！我修改后的答案如下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:36:20.290

> 使用`SelectedIndexChanged`事件不是一个选项，因为对于这个罐头示例背后的应用程序，我只希望它在用户进行选择时发生，而不是在以编程方式设置时发生。

您还可以通过编写一个包装方法来更改暂时禁用您的事件的选择来完成此操作。

`SelectionChangeCommitted`不幸的是，对于更一般的情况（例如您无法控制`ComboBox`或访问它的方式），我不知道该问题的解决方案。

编辑：

我制作了 ComboBox 调用的所有事件的流媒体，并且似乎没有任何其他事件会满足您的需求。我能想到的唯一解决方案是挂钩自动完成触发的事件。困难在于知道这些事件是什么，因为它们似乎不会触发`ComboBox`我的小测试显示的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-10T15:57:53.923

仅供参考，这是我想出的最好的解决方案。显然，这是 ComboBox 子类上的 Leave 事件处理程序。SelectionChangeCommitted 事件不会在鼠标单击时发生，但至少会在 GUI 交互的正常流程中发生。

```
private void this_Leave (object sender, EventArgs e)
{
    // If this is an autocomplete combo-box, select the
    // item that was found by autocomplete.
    // This seems like something that ComboBox should be
    // doing automatically...I wonder why it doesn't?
    if (this.AutoCompleteMode != AutoCompleteMode.None)
    {
        // Determine which combo-box item matches the text.
        // Since IndexOf() is case-sensitive, do our own
        // search.
        int iIndex = -1;
        string strText = this.Text;
        ComboBox.ObjectCollection lstItems = this.Items;
        int iCount = lstItems.Count;
        for (int i = 0; i < iCount; ++i)
        {
            string strItem = lstItems[i].ToString();
            if (string.Compare (strText, strItem, true) == 0)
            {
                iIndex = i;
                break;
            }
        }

        // If there's a match, and this isn't already the
        // selected item, make it the selected item.
        //
        // Force a selection-change-committed event, since
        // the autocomplete was driven by the user.
        if (iIndex >= 0
        && this.SelectedIndex != iIndex)
        {
            this.SelectedIndex = iIndex;
            OnSelectionChangeCommitted (EventArgs.Empty);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-14T12:26:05.227

这种解决方法对我来说很好，也希望对你有用。当通过在组合框中键入数据来使用自动完成以通过键盘或鼠标选择获取项目时，您需要 _KeyDown 事件。从内部调用 _SelectionChangeCommitted 方法，该方法包含其他操作的代码。请参见下面的代码：

```
 private void YourComboBox_KeyDown(object sender, KeyEventArgs e)
    {
        //Works also when user select and click on autocomplete list.
        if (e.KeyCode == Keys.Enter && YourComboBox.SelectedItem != null)
            YourComboBox_SelectionChangeCommitted(sender, e);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-28T14:59:55.237

对于上面提到的非自动完成案例（即我的 2020 年 10 月 28 日编辑），只要您的事件处理程序是[idempotent](https://en.wikipedia.org/wiki/Idempotence)`Leave` ，子类上的这个事件处理程序就会合并新案例和旧案例。与我之前的答案相比，它删除了自动完成的测试，并且总是调用.`ComboBox``SelectionChangeCommitted``OnSelectionChangeCommitted()`

```
private void this_Leave (object sender, EventArgs e)
{
    // Determine which combo-box item matches the text.
    // Since IndexOf() is case-sensitive, do our own
    // search.
    int iIndex = -1;
    string strText = this.Text;
    ComboBox.ObjectCollection lstItems = this.Items;
    int iCount = lstItems.Count;
    for (int i = 0; i < iCount; ++i)
    {
        string strItem = lstItems[i].ToString();
        if (string.Compare (strText, strItem, true) == 0)
        {
            iIndex = i;
            break;
        }
    }

    // If there's a match, and this isn't already the
    // selected item, make it the selected item.
    if (iIndex >= 0
    && this.SelectedIndex != iIndex)
        this.SelectedIndex = iIndex;

    // Force a selection-change-committed event, since
    // the autocomplete was driven by the user.
    OnSelectionChangeCommitted (EventArgs.Empty);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-20T18:20:05.100

如果有人遇到这个问题，我建议一个对我来说很好的解决方案......

跟我一起想想，要接受 Combo-box 的建议，一般用户需要用 Enter 键按下。

您可以写入组合框属性的 KeyDown 事件，如下所示：

```
 private void cboProperty_SelectionChangeCommitted(object sender, EventArgs e)
    {
       //Call here the event of SelectionChangeCommitted
       cboProperty_SelectionChangeCommitted(sender,null);
    } 
```

它将在正确的时间引发 SelectionChangeCommitted。

# c# - JSON.Net Xml 序列化误解了数组

> ID：14488662
> 
> 赞同：27
> 
> 时间：2013-01-23T20:21:26.233
> 
> 标签：c#, json, json.net

我有一些自动生成的 xml，其中 xml 的某些部分可能有多行，而有些可能没有。结果是，如果有一行，则返回单个 json 节点，如果我有多行，则返回带有 json 节点的数组。

xmls 可能看起来像这样

```
<List>
    <Content>
        <Row Index="0">
            <Title>Testing</Title>
            <PercentComplete>0</PercentComplete>
            <DueDate/>
            <StartDate/>
        </Row>
    </Content>
</List> 
```

或多行

```
<List>
    <Content>
        <Row Index="0">
            <Title>Update Documentation</Title>
            <PercentComplete>0.5</PercentComplete>
            <DueDate>2013-01-31 00:00:00</DueDate>
            <StartDate>2013-01-01 00:00:00</StartDate>
        </Row>
        <Row Index="1">
            <Title>Write jQuery example</Title>
            <PercentComplete>0.05</PercentComplete>
            <DueDate>2013-06-30 00:00:00</DueDate>
            <StartDate>2013-01-02 00:00:00</StartDate>
        </Row>
    </Content>
</List> 
```

使用将这些序列化为 JSON 时

```
JsonConvert.SerializeXmlNode(xmldoc, Formatting.Indented); 
```

第一个xml变成这个

```
{
    "List": {
        "Content": {
            "Row": {
                "@Index": "0",
                "Title": "Testing",
                "PercentComplete": "0",
                "DueDate": null,
                "StartDate": null
            }
        }
    }
} 
```

第二个这个

```
{
    "List": {
        "Content": {
            "Row": [{
                "@Index": "0",
                "Title": "Update Documentation",
                "PercentComplete": "0.5",
                "DueDate": "2013-01-31 00:00:00",
                "StartDate": "2013-01-01 00:00:00"
            }, {
                "@Index": "1",
                "Title": "Write jQuery example",
                "PercentComplete": "0.05",
                "DueDate": "2013-06-30 00:00:00",
                "StartDate": "2013-01-02 00:00:00"
            }]
        }
    }
} 
```

可以清楚地看到第二个上的 Row 是一个数组，但不是第一个。对于此类问题是否有任何已知的解决方法，或者我是否需要在接收 JSON 的前端中实施检查（这会有点问题，因为结构非常动态）。最好的方法是如果有任何方法可以强制 json.net 始终返回数组。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-08-06T08:32:10.343

来自 Json.NET 文档： http: [//james.newtonking.com/projects/json/help/ ?topic=html/ConvertingJSONandXML.htm](http://james.newtonking.com/projects/json/help/?topic=html/ConvertingJSONandXML.htm)

`json:Array='true'`您可以通过将属性添加到要转换为 JSON 的 XML 节点来强制将节点呈现为数组。此外，您需要在 XML 标头中声明 json 前缀命名空间，`xmlns:json='http://james.newtonking.com/projects/json'`否则您将收到一个 XML 错误，指出未声明 json 前缀。

下一个示例由文档提供：

```
xml = @"<person xmlns:json='http://james.newtonking.com/projects/json' id='1'>
        <name>Alan</name>
        <url>http://www.google.com</url>
        <role json:Array='true'>Admin</role>
      </person>"; 
```

生成的输出：

```
{
  "person": {
    "@id": "1",
    "name": "Alan",
    "url": "http://www.google.com",
    "role": [
      "Admin"
    ]
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-23T20:46:58.330

我确实像这样修复了这种行为

```
// Handle JsonConvert array bug
var rows = doc.SelectNodes("//Row");
if(rows.Count == 1)
{
    var contentNode = doc.SelectSingleNode("//List/Content");
    contentNode.AppendChild(doc.CreateNode("element", "Row", ""));

    // Convert to JSON and replace the empty element we created but keep the array declaration
    returnJson = JsonConvert.SerializeXmlNode(doc).Replace(",null]", "]");
}
else
{
    // Convert to JSON
    returnJson = JsonConvert.SerializeXmlNode(doc);
} 
```

它有点脏，但它有效。我仍然对其他解决方案感兴趣！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-10-22T10:15:25.473

将我的 +1 给 Iván Pérez Gómez 并在此处提供一些代码来支持他的回答：

将所需的 json.net 命名空间添加到根节点：

```
private static void AddJsonNetRootAttribute(XmlDocument xmlD)
    {
        XmlAttribute jsonNS = xmlD.CreateAttribute("xmlns", "json", "http://www.w3.org/2000/xmlns/");
        jsonNS.Value = "http://james.newtonking.com/projects/json";

        xmlD.DocumentElement.SetAttributeNode(jsonNS);
    } 
```

并将 json:Array 属性添加到 xpath 找到的元素：

```
private static void AddJsonArrayAttributesForXPath(string xpath, XmlDocument doc)
    {
        var elements = doc.SelectNodes(xpath);

        foreach (var element in elements)
        {
            var el = element as XmlElement;

            if (el != null)
            {

                var jsonArray = doc.CreateAttribute("json", "Array", "http://james.newtonking.com/projects/json");
                jsonArray.Value = "true";
                el.SetAttributeNode(jsonArray);
            }
        }
    } 
```

这是一个作为 json 数组的单个子节点的示例：

![这是一个作为 json 数组的单个子节点的示例：](../Images/ee44e1c64ec9b68135a99a83759e9eaf.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-22T07:44:36.357

我的解决方案：如果 JsonConvert 不起作用，请不要使用它。将 XML 解析为字典/集合，然后解析为 Json。至少通过这种方式，您不必对任何元素名称进行硬编码。

```
 private JsonResult AsJsonResult(XmlDocument result)
    {
        var kvp = new KeyValuePair<string, object>(result.DocumentElement.Name, Value(result.DocumentElement));

        return Json(kvp
             , JsonRequestBehavior.AllowGet);
    }

    /// <summary>
    /// Deserializing straight from Xml produces Ugly Json, convert to Dictionaries first to strip out unwanted nesting
    /// </summary>
    /// <param name="node"></param>
    /// <returns></returns>
    private object Value(XmlNode node)
    {
        dynamic value;

        //If we hit a complex element
        if (node.HasChildNodes && !(node.FirstChild is XmlText))
        {
            //If we hit a collection, it will have children which are also not just text!
            if (node.FirstChild.HasChildNodes && !(node.FirstChild.FirstChild is XmlText))
            {
                //want to return a list of Dictionarys for the children's nodes
                //Eat one level of the hierachy and return child nodes as an array
                value = new List<object>();
                foreach (XmlNode childNode in node.ChildNodes)
                {
                    value.Add(Value(childNode));
                }
            }
            else //regular complex element return childNodes as a dictionary
            {
                value = new Dictionary<string, object>();
                foreach (XmlNode childNode in node.ChildNodes)
                {
                    value.Add(childNode.Name, Value(childNode));
                }
            }
        }
        else //Simple element
        {
            value = node.FirstChild.InnerText;
        }

        return value;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-27T13:48:52.853

使用 XDocument 发现同样的问题

if (XDocument.Parse("5.0021.0045.00").Descendants("row").Count() > 1) { }

```
 if (XDocument.Parse("<RUT3><row><FromKG>1.00</FromKG><ToKG>5.00</ToKG><Rate>45.00</Rate></row><row><FromKG>6.00</FromKG><ToKG>10.00</ToKG><Rate>65.00</Rate></row><row><FromKG>11.00</FromKG><ToKG>100.00</ToKG><Rate>98.00</Rate></row></RUT3>").Descendants("row").Count() > 1)
            {

            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-31T16:12:10.103

更简单，在 JsonConvert.DeserializeXmlNode 中将 bool 参数添加到可用的数组节点：

```
 var xml= JsonConvert.DeserializeXmlNode(dashstring, "root", true); 
```

# jquery - 通过 Ripple 代理调用 POST ajax 请求时省略数据（有效负载）

> ID：14488663
> 
> 赞同：4
> 
> 时间：2013-01-23T20:21:25.913
> 
> 标签：jquery, cordova, ripple

我正在使用**Cordova 2.3.0**和**Ripple 0.9.2**模拟器 Chrome 扩展。POST（`$.ajax`）时，我的数据（有效负载）没有通过代理与我的 url 一起发送。

这是包含代理的最终网址：

[https://rippleapi.herokuapp.com/xhr_proxy?tinyhippos_apikey=ABC&tinyhippos_rurl=https%3A//mydomain.com/MobileFacade/login](https://rippleapi.herokuapp.com/xhr_proxy?tinyhippos_apikey=ABC&tinyhippos_rurl=https%3A//mydomain.com/MobileFacade/login)

这是直接调用时正确响应的标准 Web 服务，即

[https://mydomain.com/MobileFacade/login](https://mydomain.com/MobileFacade/login)

但是在被代理调用时会中断，因为数据没有传递。

有任何想法吗？

# lotus-notes - 编辑文档时 UNID 无效

> ID：14488670
> 
> 赞同：2
> 
> 时间：2013-01-23T20:21:43.267
> 
> 标签：lotus-notes, lotusscript

我在一个文件夹中有一个文档，`AUNID`其中的一个字段填充了特定子文档的唯一 ID。在文件夹的操作栏上，我有一个按钮，它应该打开与`AUNID`用户编辑相关的文档。

当按下操作按钮时，它会给用户以下错误：

`Invalid UNID; UNID must be a 32-digit hex string.`

但是，在按下“确定”后，会打开正确的文档进行编辑。我已经使用了调试器，并且代码完全按照我的预期执行，但是这个错误似乎没有理由弹出。

这是我的代码：

```
Sub Click(Source As Button)
    On Error Goto handleError
    Dim ws As New NotesUIWorkspace
    Dim s As New NotesSession
    Dim leaddoc As NotesDocument
    Dim action As NotesDocument
    Dim db As NotesDatabase
    Dim view As NotesView
    Dim doc As NotesUIDocument

    Set db = s.CurrentDatabase
    Set leaddoc = db.UnprocessedDocuments.GetFirstDocument
    Set view = db.GetView("(ActionsByLead)")
    If (leaddoc.GetFirstItem("AUNID").Text = "") Then
        Msgbox ("There is nothing to edit!")
        Exit Sub
    End If
    Dim uid As String
    uid = Cstr(leaddoc.GetFirstItem("AUNID").Text)
    Set action = db.GetDocumentByUNID(uid)
    Call ws.SetTargetFrame("")
    Call ws.EditDocument(True, action,,,, False) 'Error occurs on this line according to the debugger. 

    Exit Sub 
handleError:
    Resume Next
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:07:04.767

检查您正在打开的子文档的形式。我怀疑在加载该文档期间存在导致错误的某些东西，并且它与父文档上的操作或 AUNID 项无关。

或者尝试新建一个子文档，看看是否出现错误

# mysql - 当变量可以取负值时，在无符号数之间进行操作

> ID：14488674
> 
> 赞同：0
> 
> 时间：2013-01-23T20:21:55.210
> 
> 标签：mysql, sql, database, unsigned, between

我如何进行一项操作在我执行这样的查询之间： **types.init 和 types.end 是一个无符号数，对于这种情况`B.init=0 and B.end=0`**

```
SET @init:=20;
SET @end:=100;

SELECT
  A.`type_id`, B.`type_id`,count(A.id)
FROM
  `types` A ,`types` B 
WHERE
  A.`init` BETWEEN B.`init`- @init
  AND B.`init` +  @init
  AND  A.`end` BETWEEN B.`end`-  @end
  AND B.`end` +  @end 
```

然后发生此错误：

```
 #1690 - BIGINT UNSIGNED value is out of range in '(`database`.`B`.`init` - (@init))' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T03:56:21.353

您要么需要使用[CAST](http://dev.mysql.com/doc/refman/5.0/en/cast-functions.html)转换为 SIGNED，要么使用[CASE](http://dev.mysql.com/doc/refman/5.0/en/case.html)检查 B.init >= @init。

对于前一种情况，您的查询将如下所示：

```
WHERE
  CAST(A.`init` AS SIGNED) BETWEEN CAST(B.`init` AS SIGNED) - @init
  AND CAST(B.`init` AS SIGNED) +  @init
  AND CAST(A.`end` AS SIGNED) BETWEEN CAST(B.`end` AS SIGNED) -  @end
  AND CAST(B.`end` AS SIGNED) +  @end 
```

对于后者：

```
WHERE
  A.`init` BETWEEN CASE WHEN B.`init` >= @init THEN B.`init`- @init ELSE 0 END
  AND B.`init` +  @init
  AND  A.`end` BETWEEN CASE WHEN B.`end` >= @end THEN B.`end`-  @end ELSE 0 END
  AND B.`end` +  @end 
```

# c# - 在 c# / WPF 中循环浏览图像文件夹

> ID：14488677
> 
> 赞同：1
> 
> 时间：2013-01-23T20:22:14.233
> 
> 标签：c#, wpf

所以我试图遍历一个文件夹并每 2 秒更改一次图像源。

我认为我的代码是正确的，但我似乎遗漏了一些东西，因为我的图像不会更新，但我没有收到错误。

该代码填充了我的文件数组，以便找到图片，我只是在设置图像源时做错了。

XAML 代码

```
<Grid>
       <Image x:Name="Picture" Source="{Binding ImageSource}"  Width="980" Height="760" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="350,50,0,0"></Image>
 <Grid> 
```

C# 代码

```
 private string[] files;
    private System.Timers.Timer timer;

    private int counter;
    private int Imagecounter;

    Uri _MainImageSource = null; 

    public Uri MainImageSource {
        get 
        {
            return _MainImageSource; 
        } 
        set 
        {
            _MainImageSource = value;
        } 
    }

    public IntroScreen()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(this.MainWindow_Loaded);
    }

    private void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {

        setupPics();
    }

    private void setupPics() 
    {
        timer = new System.Timers.Timer();
        timer.Elapsed += new ElapsedEventHandler(timer_Tick);
        timer.Interval = (2000);
        timer.Start();

        files = Directory.GetFiles("../../Resources/Taken/", "*.jpg", SearchOption.TopDirectoryOnly);
        Imagecounter = files.Length;
        MessageBox.Show(Imagecounter.ToString());
        counter = 0;
    }

    private void timer_Tick(object sender, EventArgs e)
    {
        counter++;
        _MainImageSource = new Uri(files[counter - 1], UriKind.Relative);
        if (counter == Imagecounter)
            {
                counter = 0;
            }
    } 
```

有人知道我在做什么错吗？

更新代码

XAML

```
 <Image x:Name="Picture" Source="{Binding MainImageSource}"  Width="980" Height="760" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="350,50,0,0"></Image> 
```

C＃

```
public partial class IntroScreen : UserControl, INotifyPropertyChanged
{

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(propertyName));
    }

    private string[] files;
    private System.Timers.Timer timer;

    private int counter;
    private int Imagecounter;

    Uri _MainImageSource = null;

    public Uri MainImageSource
    {
        get 
        {
            return _MainImageSource; 
        } 
        set 
        {
            _MainImageSource = value;
            OnPropertyChanged("MainImageSource");
        } 
    }

    public IntroScreen()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(this.MainWindow_Loaded);
    }

    private void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {

        setupPics();
    }

    private void setupPics() 
    {
        files = Directory.GetFiles("../../Resources/Taken/", "*.jpg", SearchOption.TopDirectoryOnly);
        Imagecounter = files.Length;

        counter = 0;
        timer = new System.Timers.Timer();
        timer.Elapsed += new ElapsedEventHandler(timer_Tick);
        timer.Interval = (2000);
        timer.Enabled = true;
        timer.Start();

    }

    private void timer_Tick(object sender, EventArgs e)
    {
        counter++;
        MainImageSource = new Uri(files[counter - 1], UriKind.Relative);
        if (counter == Imagecounter)
            {
                counter = 0;
            }
    } 
```

我没有收到任何错误，但图像仍然没有切换。我想知道我的路径是否有效。有什么方法可以测试吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:29:37.857

您忘记通知`MainImageSource`绑定的更新。

为此，您必须实现接口：`INotifyPropertyChanged`和定义`DataContext`。

并且，正如 MSDN 文档中所写的那样，“将 Enabled 设置为 true 与调用 Start 相同，而将 Enabled 设置为 false 与调用 Stop 相同。”。

像这样：

```
public partial class IntroScreen : Window, INotifyPropertyChanged
{
    private string[] files;
    private Timer timer;

    private int counter;
    private int Imagecounter;

    BitmapImage _MainImageSource = null;
    public BitmapImage MainImageSource  // Using Uri in the binding was no possible because the Source property of an Image is of type ImageSource. (Yes it is possible to write directly the path in the XAML to define the source, but it is a feature of XAML (called a TypeConverter), not WPF)
    {
        get
        {
            return _MainImageSource;
        }
        set
        {
            _MainImageSource = value;
            OnPropertyChanged("MainImageSource");  // Don't forget this line to notify WPF the value has changed.
        }
    }

    public IntroScreen()
    {
        InitializeComponent();
        DataContext = this;  // The DataContext allow WPF to know the initial object the binding is applied on. Here, in the Binding, you have written "Path=MainImageSource", OK, the "MainImageSource" of which object? Of the object defined by the DataContext.

        Loaded += MainWindow_Loaded;
    }

    private void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        setupPics();
    }

    private void setupPics()
    {
        timer = new Timer();
        timer.Elapsed += timer_Tick;
        timer.Interval = 2000;

        // Initialize "files", "Imagecounter", "counter" before starting the timer because the timer is not working in the same thread and it accesses these fields.
        files = Directory.GetFiles(@"../../Resources/Taken/", "*.jpg", SearchOption.TopDirectoryOnly);
        Imagecounter = files.Length;
        MessageBox.Show(Imagecounter.ToString());
        counter = 0;

        timer.Start();  // timer.Start() and timer.Enabled are equivalent, only one is necessary
    }

    private void timer_Tick(object sender, EventArgs e)
    {
        // WPF requires all the function that modify (or even read sometimes) the visual interface to be called in a WPF dedicated thread.
        // IntroScreen() and MainWindow_Loaded(...) are executed by this thread
        // But, as I have said before, the Tick event of the Timer is called in another thread (a thread from the thread pool), then you can't directly modify the MainImageSource in this thread
        // Why? Because a modification of its value calls OnPropertyChanged that raise the event PropertyChanged that will try to update the Binding (that is directly linked with WPF)
        Dispatcher.Invoke(new Action(() =>  // Call a special portion of your code from the WPF thread (called dispatcher)
        {
            // Now that I have changed the type of MainImageSource, we have to load the bitmap ourselves.
            BitmapImage bitmapImage = new BitmapImage();
            bitmapImage.BeginInit();
            bitmapImage.UriSource = new Uri(files[counter], UriKind.Relative);
            bitmapImage.CacheOption = BitmapCacheOption.OnLoad;  // Don't know why. Found here (http://stackoverflow.com/questions/569561/dynamic-loading-of-images-in-wpf)
            bitmapImage.EndInit();
            MainImageSource = bitmapImage;  // Set the property (because if you set the field "_MainImageSource", there will be no call to OnPropertyChanged("MainImageSource"), then, no update of the binding.
        }));
        if (++counter == Imagecounter)
            counter = 0;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

并且您的 XAML 没有引用正确的属性：

```
<Grid>
    <Image x:Name="Picture" Source="{Binding MainImageSource}"  Width="980" Height="760" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="350,50,0,0"></Image>
<Grid> 
```

### 为什么需要实施`INotifyPropertyChanged`？

基本上，当您定义绑定时，WPF 将检查包含相应属性的类是否定义了`INotifyPropertyChanged`. 如果是这样，它将订阅`PropertyChanged`该类的事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:29:24.930

我没有看到该`INotifyPropertyChanged`界面的任何使用，这需要以您使用它的方式更新 UI 项。就像现在一样，UI 控件无法知道值已更新。

# html - jQuery移动页面链接不起作用

> ID：14488680
> 
> 赞同：0
> 
> 时间：2013-01-23T20:22:57.907
> 
> 标签：html, jquery-mobile, hyperlink

在我的 jQuery mobile (v 1.2) 网站中，我有几个单独的页面（即每个页面都有一个页眉、内容和页脚）。问题是我无法链接页面。以下行不起作用。 `<a href="anotherpage.html">Another Page</a>`显示“错误加载页面”。

如果我添加`rel="external"`到`<a>`元素中，它会起作用。但是，它关闭了通过 Ajax 的自动加载。但我想使用 Ajax 加载以及保持页面分开。只是想知道这是否可能。

**代码页 1**

```
<!DOCTYPE html> 
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Single page template</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js">  </script>
</head> 
<body> 
    <div data-role="page">
        <div data-role="header">
            <h1>Page 1</h1>
        </div>
        <div data-role="content">   
            <a href="b.html"> click me</a>
        </div>  
        <div data-role="footer">
            <h4>Footer content</h4>
        </div>
        </div>
</body>
</html> 
```

**代码页 2**

```
 <!DOCTYPE html> 
 <html>
 <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Single page template</title> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js">      </script>
 </head> 
 <body> 
     <div data-role="page">
         <div data-role="header">
             <h1>Page 2</h1>
         </div>
         <div data-role="content">  
              page 2 content
         </div> 
         <div data-role="footer">
             <h4>Footer content</h4>
         </div>
    </div>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:01:04.777

问题是您正在尝试从文件系统加载页面。假设存在安全风险，Chrome 设置会阻止这种情况。

使用 Web 服务器为您的页面提供服务。为此，您可以在 Windows XP Pro 上使用 IIS。

或者

`--allow-file-access-from-file`您可以使用命令行选项启动 chrome

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T15:08:43.830

我相信你应该给每个 'data-role="page" 和 id 像 "page2 所以实际上它会是：

```
<div data-role="page" id="page"> <!--Home Page-->
<div data-role="page" id="page2"> <!--2nd Page-->
<div data-role="page" id="page3"> <!--3rd Page--> 
```

我不确定这是否是您在这种情况下要寻找的东西......

# html - 在 Rich Snippet 中为 Itemscope 属性分配值

> ID：14488686
> 
> 赞同：4
> 
> 时间：2013-01-23T20:23:32.440
> 
> 标签：html, rich-snippets

所以我们使用了一些丰富的片段，它们使用 html5 标记方案。

我们的问题是 itemscope 属性没有值。

```
<div itemscope itemtype="http://schema.org/LocalBusiness"> 
```

这会导致我们的旧产品 html 验证失败，因为它认为它是一个空标签。如果您像这样为其分配值 1，则 google 和标记规则的工作方式是否相同。

```
<div itemscope="1" itemtype="http://schema.org/LocalBusiness"> 
```

在我们可以正确更新我们的验证方法之前，这是一个暂时的解决方法，但这是一个更远的项目。

那么基本上是否有适当的语法可以使其对 Google 的 Rich Snippet 规则、html5 和 html5 之前的旧验证引擎仍然有效？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-01T11:46:43.820

（这个答案基本上是从[Peter Murray](http://dltj.org/article/schema-org-invalid/)复制的，特别是这[两个](http://dltj.org/article/schema-org-invalid/#comment-146961) [评论](http://dltj.org/article/schema-org-invalid/#comment-146968)。）

HTML5 规范允许[布尔属性](http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#boolean-attributes)的值为空字符串或属性名称：

> 如果存在该属性，则其值必须是空字符串或与属性的规范名称匹配的[不区分大小写的 ASCII值，并且没有前导或尾随空格。](http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#ascii-case-insensitive)

所以要么这样：

```
<div itemscope="" itemtype="http://schema.org/LocalBusiness"> 
```

或这个：

```
<div itemscope="itemscope" itemtype="http://schema.org/LocalBusiness"> 
```

是有效的 HTML5。

为了确保 Google 能够`itemscope="itemscope"`正确识别，他（Peter Murray）创建了一个[示例页面](http://dltj.org/wp-content/uploads/2011/06/schema-event-html5.html)并通过[Google 的丰富片段验证器](http://www.google.com/webmasters/tools/richsnippets)运行它。从[结果](http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fdltj.org%2Fwp-content%2Fuploads%2F2011%2F06%2Fschema-event-html5.html&view=)中，您可以看到 Google 正确提取了数据（一个事件项）。

# css - 是否可以根据输入的类型来设置标签的样式？

> ID：14488694
> 
> 赞同：1
> 
> 时间：2013-01-23T20:23:42.563
> 
> 标签：css

我想为我的下拉列表设置与其他输入类型不同的标签样式，但希望避免为每个标签分配类。是否可以根据标签的类型来设置标签的样式？

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:38:05.083

这取决于你的 html 是如何构建的。如果将标签放在 html 中的输入之后，则可以创造性地使用兄弟选择器。

HTML：

```
<div>
<input type="text" value="lorem ipsum" id="lorem" />
<label for="lorem">lorem label</label>

<input type="checkbox" id="check"/>
<label for="check">check label</label>
</div> 
```

CSS：

```
input[type="text"] + label {
   color: red;   
}
input[type="checkbox"] + label {
   color: blue;   
} 
```

我设置了一个小小提琴来演示：http: [//jsfiddle.net/pLCBP/](http://jsfiddle.net/pLCBP/)

也就是说，在现实生活中，我可能会在每个输入和标签“组”周围放置一个包装器 div，并给它一个类来指示其中包含什么类型的字段，因为这使得定位更容易。但如你所见，你所问的确实是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:46:54.753

如果你想用 Javascript/jQuery 来实现它，你可以运行几个循环来将标签与其输入类型相关联，然后让样式由类处理。

像这样的东西会起作用

```
$("label").each(function(){
    var forText = $(this).attr("for");
    $("input").each(function(){
      if($(this).attr("id") == forText){
        var inputType = $(this).attr("type");
        $("label[for="+forText+"]").addClass(inputType);
      } 
    });
  }); 
```

[您可以在这里](http://jsbin.com/upuguv/1/edit)看到它的实际效果。它可能会写得更好，但它会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:25:53.267

**选项 A**
不，这是不可能的。你应该给每个标签它自己的类。喜欢

```
<label for="test" class="inputText">Name:</label><input name="test" id="test" /> 
```

CSS

```
.inputText{} // Label
input[type=text]{} // Input 
```

**选项 B**
什么也是一个选项。是如果您在输入/选择之后使用标签。你可以这样做。这是因为`+`您可以选择 DOM 中的下一个元素。太糟糕了，这`-`是不可能的。

```
input[type=text] + label {}
input[type=password] + label {}
input[type=checkbox] + label {}
select + label {}
textarea + label {} 
```

# python - Pandas read_csv 在具有空字符的列上失败

> ID：14488697
> 
> 赞同：7
> 
> 时间：2013-01-23T20:23:47.490
> 
> 标签：python, pandas

下面的 y 列应该是 ['Reg', 'Reg', 'Swp', 'Swp']

```
In [1]: pd.read_csv('/tmp/test3.csv')  
Out[1]:  
x,y  
 ^@^@^@,Reg  
 ^@^@^@,Reg  
I,Swp  
I,Swp  

In [2]: ! cat /tmp/test3.csv  
     x    y  
0  
1  NaN  NaN  
2    I  Swp  
3    I  Swp    

In [3]: f = open('/tmp/test3.csv', 'rb'); print(repr(f.read()))  
'x,y\n \x00\x00\x00,Reg\n \x00\x00\x00,Reg\nI,Swp\nI,Swp\n' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T21:00:42.983

是的，我可以重现该问题，但不知道如何使用`pd.read_csv`. 这是一种解决方法：

```
In [46]: import numpy as np
In [47]: arr = np.genfromtxt('test3.csv', delimiter = ',', 
                             dtype = None, names = True)

In [48]: df = pd.DataFrame(arr)

In [49]: df
Out[49]: 
   x    y
0     Reg
1     Reg
2  I  Swp
3  I  Swp 
```

* * *

请注意，`names = True`csv 的第一个有效行被解释为列名（因此不会影响后续行中值的 dtype。）因此，如果 csv 文件包含数字数据，例如

```
In [22]: with open('/tmp/test.csv','r') as f:
   ....:     print(repr(f.read()))
   ....:     
'x,y,z\n \x00\x00\x00,Reg,1\n \x00\x00\x00,Reg,2\nI,Swp,3\nI,Swp,4\n' 
```

然后 genfromtxt 将为第三列分配一个数字 dtype（`<i4`在这种情况下）。

```
In [19]: arr = np.genfromtxt('/tmp/test.csv', delimiter = ',', dtype = None, names = True)

In [20]: arr
Out[20]: 
array([('', 'Reg', 1), ('', 'Reg', 2), ('I', 'Swp', 3), ('I', 'Swp', 4)], 
      dtype=[('x', '|S3'), ('y', '|S3'), ('z', '<i4')]) 
```

但是，如果数字数据与字节混合，`'\x00'`那么 genfromtxt 将无法将此列识别为数字，因此将求助于分配字符串 dtype。`dtype`不过，您可以通过手动分配参数来强制列的 dtype 。例如，

```
In [11]: arr = np.genfromtxt('/tmp/test.csv', delimiter = ',', dtype = [('x', '|i4'), ('y', '|S3')], names = True) 
```

将第一列设置`x`为具有 dtype `|i4`（4 字节整数），将第二列`y`设置为具有 dtype `|S3`（3 字节字符串）。有关可用 dtype 的更多信息，请参阅[此文档页面](http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html)。

# r - 如何像在 R 中一样在 matlab 中读取 csv 文件？

> ID：14488703
> 
> 赞同：8
> 
> 时间：2013-01-23T20:24:13.990
> 
> 标签：r, matlab, csv, import-from-csv

我有一个保存为 .csv 文件的数据集，如下所示：

```
Name,Age,Password
John,9,\i1iiu1h8
Kelly,20,\771jk8
Bob,33,\kljhjj 
```

在 RI 中可以通过以下方式打开此文件：

```
X = read.csv("file.csv",header=TRUE) 
```

Matlab 中是否有读取带有数字和字符串变量的 .csv 文件的默认命令？ `csvread`似乎只喜欢数字变量。

更进一步，在 RI 中可以使用附加函数来创建与数据集的列和列标题相关联的变量，即

```
attach(X) 
```

Matlab中是否有类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T22:08:41.437

尽管这个问题几乎是完全重复的，但@NathanG 提供的链接中建议的解决方案（即 using `xlsread`）只是解决问题的一种可能方法。链接中的作者还建议使用`textscan`，但没有提供有关如何操作的任何信息，所以我想我会在这里添加一个示例：

```
%# First we need to get the header-line
fid1 = fopen('file.csv', 'r');
Header = fgetl(fid1);
fclose(fid1);

%# Convert Header to cell array
Header = regexp(Header, '([^,]*)', 'tokens');
Header = cat(2, Header{:});

%# Read in the data
fid1 = fopen('file.csv', 'r');
D = textscan(fid1, '%s%d%s', 'Delimiter', ',', 'HeaderLines', 1);
fclose(fid1); 
```

`Header`现在应该是单元格的行向量，每个单元格都存储一个标题。`D`是单元格的行向量，其中每个单元格存储一列数据。

我没有意识到要“附加”`D`到`Header`. 如果你愿意，你可以把它们放在同一个结构中，即：

```
S.Header = Header;
S.Data = D; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-12T05:23:04.813

Matlab 的新表类使这很容易：

```
X = readtable('file.csv'); 
```

默认情况下，这将解析标题，并将它们用作列名（也称为变量名）：

```
>> x

x = 

 Name      Age     Password  
_______    ___    ___________

'John'      9     '\i1iiu1h8'
'Kelly'    20     '\771jk8'  
'Bob'      33     '\kljhjj' 
```

您可以使用其名称等选择一列：

```
>> x.Name

ans = 

    'John'
    'Kelly'
    'Bob' 
```

自 Matlab 2013b 起可用。请参阅[www.mathworks.com/help/matlab/ref/readtable.html](http://www.mathworks.com/help/matlab/ref/readtable.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T15:29:14.160

我喜欢这种方法，得到 Matlab 2012 的支持。

```
path='C:\folder1\folder2\';
data = 'data.csv';
data = dataset('xlsfile',sprintf('%s\%s', path,data)); 
```

当然，您还可以执行以下操作：

```
[data,path] = uigetfile('C:\folder1\folder2\*.csv');
data = dataset('xlsfile',sprintf('%s\%s', path,data)); 
```

# delphi - 带红外图像的保险丝台温度 (Jpg*)

> ID：14488704
> 
> 赞同：0
> 
> 时间：2013-01-23T20:24:17.513
> 
> 标签：delphi, delphi-xe3

![在此处输入图像描述](../Images/73fbee8366b1d2ae72d2807c1afa4eee.png)

![在此处输入图像描述](../Images/1f6a2339007acc0109bdc4cdb066479b.png)

有没有办法将 Jpeg 图像与附加的字符串网格中显示的相应像素温度融合。融合后，鼠标围绕并读取图像中的温度。如果有，请任何人告诉我如何。

谢谢你，AmmadeuX

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:28:32.033

我的理解是你手头有三个不同的问题。我将在下面指出它们，并附上答案。但是请您，您需要尽最大努力自己完成这些类型的项目，并且只有在您有需要解决的特定问题时才在这里提问。问“如何做某事”总是主观的。

问题 2 和 3 是非此即彼的解决方案，这意味着每个问题都可以是一个不同的问题，并且可以完全独立地回答。但他们都仍然依赖于第一个问题。

**问题1：“如何识别鼠标指向的像素的颜色？”**

我假设您使用的是`TImage`具有默认属性的标准控件，并且未设置为重新调整大小、拉伸或居中图像。如果你需要这样做，有一种不同的方法。

首先，您必须确定鼠标指向的像素。有几种方法可以做到这一点，但取决于您用于显示图像的控件（我假设是标准的`TImage`），我建议使用鼠标移动事件 ( `OnMouseMove`) 来捕获鼠标在此控件上的移动。此时，您需要识别当前鼠标位置。值得庆幸的是，此事件带有鼠标指针的 X 和 Y 位置。

然后，您需要获取图像的画布。您可以通过以下方式获得：

```
TImage.Picture.Bitmap.Canvas 
```

接下来，读取 Canvas 的`Pixels[]`属性以获取颜色。

**问题 2：“我如何确定颜色落在 From/To 刻度上的哪个位置？”**

现在您知道鼠标指向的是什么颜色，您需要确定该颜色属于刻度的哪个位置。为此，最简单的方法是只使用 1 个颜色通道。你上面的例子说明了不同颜色的组合和褪色，这对我来说太棘手了，无法解释。请将此作为一个附加问题提出，因为它需要我自己做不到的想法（需要我不擅长的大量数学）。

**问题 3：“如何将图像链接到数据表？”**

由于您有一个温度读数表，因此您需要根据上面第一个问题中提供的单个像素按列/行读取此表。

由于您已经知道鼠标的 X/Y 位置，因此使用这些相同的变量来识别网格的列/行。（我不鼓励使用网格作为存储此数据的主要基础，您应该使用客户端数据集，并使用该数据动态加载网格。）

**结论：**

这是我为您准备的示例应用程序的代码。它应该可以帮助您了解您正在做的事情背后的基础知识。您必须选择自己的图像，因为我不想用原始图像数据污染这个答案的代码。

**注意：**一旦您编辑问题以明确您希望图像*如何*链接到数据，那么我将修改我的答案。否则，这是我在当前状态下能解释的最好的。

**单元1.pas**

```
unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Vcl.StdCtrls, Vcl.ComCtrls;

type
  TForm1 = class(TForm)
    Image1: TImage;
    Shape1: TShape;
    StatusBar1: TStatusBar;
    procedure Image1MouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Image1MouseMove(Sender: TObject; Shift: TShiftState;
  X, Y: Integer);
var
  Color: TColor;
  Canvas: TCanvas;
  R, G, B: Byte;
begin
  Canvas:= Image1.Picture.Bitmap.Canvas;
  Color:= Canvas.Pixels[X, Y];
  Shape1.Brush.Color:= Color;
  R:= GetRValue(Color);
  G:= GetGValue(Color);
  B:= GetBValue(Color);
  StatusBar1.Panels[0].Text:= 'Pos: '+IntToStr(X)+' x '+IntToStr(Y);
  StatusBar1.Panels[1].Text:= 'Clr: '+IntToStr(Color);
  StatusBar1.Panels[2].Text:= 'RGB: '+IntToStr(R)+' x '+IntToStr(G)+' x '+IntToStr(B);
end;

end. 
```

**单元1.dfm**

```
object Form1: TForm1
  Left = 315
  Top = 113
  Caption = 'Form1'
  ClientHeight = 415
  ClientWidth = 548
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  DesignSize = (
    548
    415)
  PixelsPerInch = 96
  TextHeight = 13
  object Image1: TImage
    Left = 0
    Top = 0
    Width = 548
    Height = 281
    Align = alTop
    Anchors = [akLeft, akTop, akRight, akBottom]
    OnClick = Image1Click
    OnMouseMove = Image1MouseMove
  end
  object Label1: TLabel
    Left = 8
    Top = 285
    Width = 31
    Height = 13
    Anchors = [akLeft, akBottom]
    Caption = 'Label1'
  end
  object Shape1: TShape
    Left = 8
    Top = 312
    Width = 532
    Height = 57
    Anchors = [akLeft, akRight, akBottom]
  end
  object StatusBar1: TStatusBar
    Left = 0
    Top = 396
    Width = 548
    Height = 19
    Panels = <
      item
        Width = 150
      end
      item
        Width = 150
      end
      item
        Width = 50
      end>
  end
end 
```

# java - 动态调用方法名

> ID：14488709
> 
> 赞同：0
> 
> 时间：2013-01-23T20:24:41.497
> 
> 标签：java, reflection

假设我有一个类和一个名为 testMethod(String test1, String test 2) 的方法。我还有另一个具有不同方法的类，它将调用它所在的方法。请参见下面的示例

```
public class functional {

    testMethod(String test1, String test2) {

        reCallMethod();

    }
}

reCallMethod(){
    testMethod(test1, test2); // ------> This has to be dynamic. I've written the method name as "testMEthod" here. But I want it generalized so that I can use this in any method and not just in "testMethod"
} 
```

更多信息 ： - - - - - - - - - - - - - - - -

```
public class test1 {
public void TestCase1(String param1, String param2, String param3) {
        try {
            //Bla Bla Bla
        }
        catch (Throwable t) {
                TestCase_Store_Locator_Verify_Page_Name(param1,param2,param3); //Retry running this method

        }
    }
}

public class test2 {
    public void TestCase2(String param1, String param2, String param3, String param4, String Param5) {
        try {
            //Bla Bla Bla
        }
        catch (Throwable t) {
                TestCase2(param1,param2,param3,param4,param5); //Retry running this method

        }
    }
} 
```

像 TestCase1 和 TestCase2 我有 500 个测试。而不是上面做的，我将有一个名为 retryLogic 的通用方法，如下所示

```
public void retryLogic(){
 //Call the test method in the class which this method is placed.
}

So my TestCase1 will look like

    public class test1 {
public void TestCase1(String param1, String param2, String param3) {
        try {
            //Bla Bla Bla
        }
        catch (Throwable t) {
                retryLogic(); //Retry running this method

        }
    }
}

    public void TestCase2(String param1, String param2, String param3) {
        try {
            //Bla Bla Bla
        }
        catch (Throwable t) {
                retryLogic(); //Retry running this method

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:28:58.740

您可以使用反射来确定在运行时调用哪个方法。

有关如何执行此操作的信息，请参阅此帖子： [How do I invoke an Java method when given the method name as a string?](https://stackoverflow.com/questions/160970/how-do-i-invoke-a-java-method-when-given-the-method-name-as-a-string)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:29:14.860

看看[Java 的反射特性](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/package-summary.html)！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:00:15.173

也许你可以这样做，它做同样的事情：

```
 public void TestCase2(String param1, String param2, String param3) {
        boolean success;
        do {
            success = true;
            try {
                //Bla Bla Bla
            }
            catch (Throwable t) {
                success = false;
            }
        } while (!success);
    } 
```

你甚至可以添加一个计数器来防止它永远运行。只是增加并`break`在 20 次尝试后执行或其他操作。

如果您已经编写了其他代码，那么它的最大优点是。您只需复制并越过方法顶部的第 1 4 行，并复制并越过底部的最后 5 行，并检查现有代码中是否没有捕获和吃掉任何异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:32:22.807

您可以使用 Java 反射来查找类上的方法。因此， clazz.getMethods() 将返回一个 Method 对象数组。当您确定您感兴趣的那个时，您会调用 method.invoke(...) 看到这个：[http ://docs.oracle.com/javase/tutorial/reflect/class/classMembers.html](http://docs.oracle.com/javase/tutorial/reflect/class/classMembers.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:34:42.187

在 java 中，没有办法让变量持有对方法的引用。其他一些语言，例如 javascript，允许这样做。

如果您将对象传递到实现具有已知方法名称的接口的“reCallMethod()”中，则有一个详细的解决方法。通常界面看起来像这样：

```
public interface CallMe() {
    public Object execute(Object parm1, Object parm2);
} 
```

尽管“执行”上的返回值和参数可能会因您的需要而异。

然后你的代码看起来像这样：

```
public class functional {

    final OtherClass otherInstance = new OtherClass();

    testMethod(String test1, String test2) {

        reCallMethod(new CallMe() {
            public Object execute(Object parm1, Object par2) {
                return otherInstance.varyingMethod((String)parm1, (String)parm2); // This is the varying method
            }
        }, text1, text2);
    });
}

reCallMethod(CallMe func, Object parm1, Object parm2){
    func.execute(parm1, parm2);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T20:43:51.660

如果您不想使用反射，还有另一种可能性，即策略模式。它不提供与反射完全相同的功能，但您确实可以更改在运行时调用的方法。您可以使用将在您的类中调用正确方法的`functional`类。

例如，如果您的`functional`类具有以下定义：

```
public class functional {
    public void testMethod (String test1, String test2) {
        reCallMethod();
    }

    public void anotherMethod (String test1, String test2) {
        reCallMethod();
    }
} 
```

你可以有一个接口来定义你的策略接口：

```
public interface MyStrategy {
    void callMethod (String param1, String param2);
} 
```

然后有2种不同的策略实施；一个用于您要调用的每种方法。例如：

```
public class TestMethodStrategy implements MyStrategy {
    private functional myFunctional;

    public TestMethodStrategy (functional myFunctional) {
        this.myFunctional = myFunctional;
    }

    public void callMethod (String test1, String test2) {
        myFunctional.testMethod (test1, test2);
    }
} 
```

之后您需要做的就是根据当前上下文使用适当的策略。

# c# - 管理可以包含其他对象的对象列表的最简单方法

> ID：14488712
> 
> 赞同：0
> 
> 时间：2013-01-23T20:25:03.887
> 
> 标签：c#, list

对不起标题。我想不出比这更适合我的生活了。

无论如何，这就是我遇到的麻烦。假设我有一个像这样的列表

```
[a, b, c, d, e, f, g, h] 
```

现在，根据某些规则，我想将元素从 c 分组到 f 以便列表看起来像。

```
[a, b, [c, d, e, f], g, h] 
```

原始列表的大小已减少到 5 个元素（内部列表与奇异值的类型相同）。

现在我可以将它进一步分组，例如

```
[a, [b, [c, d, e, f]], [g, h]] 
```

我遇到的问题是它的实际实施。当我在编写自定义链表（尽管 C# 提供了一个）之前必须这样做时，它让我可以修改元素的左右链接，所以我只是将元素从 c 带到 f，将它们卡在一个新对象中并告诉 b将其指向右侧，g 将其指向左侧。

然而，这似乎是一个巨大的矫枉过正，有一些事情告诉我必须在.NET 中为这些类型的事情提供一些更简单的内置解决方案。

# ember.js - Ember 命名空间创建可重用的应用程序

> ID：14488713
> 
> 赞同：0
> 
> 时间：2013-01-23T20:25:05.797
> 
> 标签：ember.js, code-reuse

嗨，我是 ember 的新手，我试图解决自己的问题，但没有成功。

看一下代码：

```
// works 
window.App = Em.Application.create();
window.Core = Em.Namespace.create({ Beta: Em.Namespace.create() });

App.Router.map(function() {
    this.route("registration", {
        path: "/beta/registration"
        }); // also Core.Beta.registration tried
});

App.IndexRoute = Em.Route.extend({
    redirect: function() {
        this.transitionTo('registration'); // also Core.Beta.registration tried
    }
});

// never is called
Core.Beta.RegistrationController = Em.Controller.extend();
Core.Beta.RegistrationView = Em.View.extend({ template: Em.TEMPLATES['beta.regisration'] });

Core.Beta.RegistrationRoute = Em.Route.create({
    setupController: function() {
        console.log(arguments);
    },
    setupView: function() {
        console.log(arguments);
    }
}); 
```

Core.Beta 中的所有内容在 ember pre4 中都不会被调用...使用 Core.Beta 我可以生成可重用的微应用程序以在其他项目中使用。你知道 ember 如何在路由器中注入该应用程序，以便它可以在命名空间内创建实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:39:44.150

您需要在应用程序本身内创建命名空间

```
window.App = Em.Application.create();
window.App.Core = Em.Namespace.create({ Beta: Em.Namespace.create() }); 
```

# vbscript - 打印二进制数据 WScript

> ID：14488719
> 
> 赞同：1
> 
> 时间：2013-01-23T20:25:40.150
> 
> 标签：vbscript, wmi, wsh

我在 WMI 中使用此页面上的最后一个示例打印出一些 Windows 系统日志信息：http: [//msdn.microsoft.com/en-us/library/aa394593 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa394593(VS.85).aspx)

我也想打印出二进制数据，但我不确定如何在 WScript 中执行此操作。这是我修改后的代码：

```
' test.vbs
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2")
Set colLoggedEvents = objWMIService.ExecQuery _
    ("Select * from Win32_NTLogEvent " _
        & "Where Logfile = 'System' and SourceName = 'MySource'")
For Each objEvent in colLoggedEvents
    Wscript.Echo "Category: " & objEvent.Category & VBNewLine _
    & "Event Code: " & objEvent.EventCode & VBNewLine _
    & "Message: " & objEvent.Message & VBNewLine _
    & "Time Written: " & objEvent.TimeWritten & VBNewLine _
    & "Event Type: " & objEvent.Type & VBNewLine _
    & "Binary Data: " & objEvent.Data
Next 
```

运行 test.vbs 时，我从 Windows Script Host 收到此错误消息：

> 错误：类型不匹配，代码：800A000D，来源：Microsoft VBScript 运行时错误

知道如何将数据打印为十六进制字符串吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:59:36.140

`.Data`是一个整数值数组（从外观上看是小端编码的宽字符）。在打印数据之前，您需要将`ChrW()`每对数字连接到一个字符串。像这样的功能可能会起作用：

```
Function ToStr(arr)
  ToStr = ""
  For i = 0 To UBound(arr) Step 2
    ToStr = ToStr & ChrW(arr(i) + arr(i+1)*256)
  Next
End Function 
```

# erlang - 如何在我的 calc 函数中读取 add(N) 函数的返回值？

> ID：14488720
> 
> 赞同：0
> 
> 时间：2013-01-23T20:25:40.863
> 
> 标签：erlang

我是 Erlang 的新手，我需要生成两个运行 add 函数的进程，然后添加两个数字。进程一和进程二的分配值显示进程ID，我需要捕获该值。

如何在我的`calc`函数中读取 add(N) 函数的返回值？

```
-module(myerl).
-export([calc/1,add/1]).

add(N) ->
    N + 5.

calc(L)

pone = spawn( fun() -> add(A) end),   
ptwo = spawn( fun() -> add(B) end),

Result = Pone + Ptwo,
io:format("result ~p~n", [Result]). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:42:43.547

您需要使用消息传递。您必须将消息连同结果一起发送回调用进程。该`spawn`函数向新生成的进程返回一个 PID（进程标识符），而不是其执行的结果。

这个例子应该做你所期望的：

```
calc(A, B) ->
    Self = self(),       % The spawned funs need a Pid to send to, use a closure
    POne = spawn(fun() -> Self ! {self(), add(A)} end),
    PTwo = spawn(fun() -> Self ! {self(), add(B)} end),
    wait_for_response(POne, PTwo, 0).

wait_for_response(undefined, undefined, Sum) ->
    Sum;
wait_for_response(POne, PTwo, Sum) ->
    receive
        {POne, V} -> wait_for_response(undefined, PTwo, Sum + V);
        {PTwo, V} -> wait_for_response(POne, undefined, Sum + V)
    end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:17:01.963

@Soup d'Campbells 的解释很好。我本能地做了一些稍微不同的事情，以一种玩具的方式，预测了子进程的一些不良行为。另外，我允许输入是数字列表，而不仅仅是 2。

```
-module(myerl).
-export([calc/1, add/1]).

calc(NumList) when is_list(NumList)->
    Parent = self(),
    _Pids = [spawn(fun()-> Parent ! add(ANum) end) || ANum <- NumList],
    collect(length(NumList), 0);
calc(_) -> 
    {error, badarg}.

collect(0, Sum)   -> 
    Sum;
collect(Cnt, Sum) ->
    receive
        N when is_number(N) -> 
            collect(Cnt-1, Sum + N);
        _Bad ->  % returned something that isnt a number
            collect(Cnt-1, Sum)
    after 1000 -> % died or is too slow
        collect(Cnt-1, Sum)
    end.

add(N) -> 
    N + 5. 
```

# ms-access - 使用 C# 从 Access Query 派生参数

> ID：14488727
> 
> 赞同：0
> 
> 时间：2013-01-23T20:26:16.473
> 
> 标签：ms-access

我在 microsoft Access 中有一个接受几个参数的查询。我正在寻找 C# 中的一个示例，它可以让我先从查询中“导出”参数，然后再用值填充它们。

这可以做到吗？请告诉我如何尽快。

网络上的其他网站上有很多这样的问题，但没有答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:06:03.710

我能看到的唯一方法是使用 DAO，但可能还有其他方法。

```
DBEngine dbEng = new DBEngine();
Workspace Ws = dbEng.CreateWorkspace("", "admin", "", WorkspaceTypeEnum.dbUseJet);
Database Db = Ws.OpenDatabase(@"Z:\Docs\Test.accdb", false, false, "");

QueryDef qry = Db.QueryDefs["MyStoredQuery"];
foreach (Parameter prm in qry.Parameters)
{
    Console.WriteLine(prm.Name);
    Console.WriteLine(prm.Type);
} 
```

获得准确类型的唯一方法是包含 Parameter 语句：

```
PARAMETERS param1 Text ( 255 ), param2 Integer; 
```

# java - Dropwizard/Jersey 将 Java 列表返回为没有根节点的 JSON

> ID：14488730
> 
> 赞同：3
> 
> 时间：2013-01-23T20:26:21.037
> 
> 标签：java, jersey, dropwizard

我正在使用 dropwizard，它使用 jersey & jackson 作为 json。我的问题是当我返回一个列表时它没有指定一个根。

我有一个 POJO 类：

```
public class Company { 
public String id; 
public String name; 
public String address; 
} 
```

我的资源是这样设置的：

```
@GET
@Path("/companies/all")
public List<Company> getAllCompanies(){
    ...
    return companies;
} 
```

我得到以下回复：

```
[{
"id": "01",
"name": "Yammer Corp",
"address": "1 Finite Loop"
},
{
"id": "02",
"name": "DropWizards Inc",
"address": "4 Magic Square, Olympus"
}] 
```

虽然我想要的是如下所示：

```
{"Companies" : 
[{
"id": "01",
"name": "Yammer Corp",
"address": "1 Finite Loop"
},
{
"id": "02",
"name": "DropWizards Inc",
"address": "4 Magic Square, Olympus"
}
]} 
```

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T04:00:50.557

您需要再创建一个 POJO 包装`List<Company>`

```
public class ApiResponse
{
   private List<Company> Companies;
   //Getter and Setter
   //Public Constructor
} 
```

您的 GET 方法所需的更改是：

```
@GET
@Path("/companies/all")
public ApiResponse getAllCompanies(){
    //Set your ApiResponse Object with the companies List.
    ApiResponse apiResponse = new ApiResponse(companies);
    return apiResponse;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T08:55:22.890

我相信您可以使用 Jackson API 进行自定义。这是一种允许您使用[ObjectWriter](http://fasterxml.github.com/jackson-databind/javadoc/2.1.1/com/fasterxml/jackson/databind/ObjectWriter.html)设置生成的 JSON 的根的方法。

```
 @GET
    @Path("/companies/all")
    public Response getAllCompanies() throws JsonProcessingException {
        List<Company> companies = Lists.newArrayList();
        Company yc = new Company();
        yc.id = "01";
        yc.name = "Yammer Corp";
        yc.address = "1 Finite Loop";
        companies.add(yc);
        Company dw = new Company();
        dw.id = "02";
        dw.name = "DrowWizards Inc";
        dw.address = "4 Magic Square, Olympus";
        companies.add(dw);

        ObjectMapper objectMapper = new ObjectMapper();
        ObjectWriter writer = objectMapper.writer();
        String entity = writer.withRootName("Companies").writeValueAsString(companies);
        return Response.ok(entity).build();
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-24T09:52:46.993

如果您查看您的代码，您要求返回公司列表：

```
public List<Company> getAllCompanies(){ 
```

如果你想返回一个带有 Companies 值的 JSON 对象，那么你需要一个与之匹配的合适的 Java 对象。

```
public class MyListOfCompanies {
  List<Companies> companies;
} 
```

然后你会要求你的代码返回它：

```
public MyListOfCompanies getAllCompanies(){ 
```

但是，请考虑您是否真的想这样做。如果您考虑某人为您的 API 进行编码的情况，他们是否更愿意收到公司列表（正如他们所要求的并且 API 暗示他们将获得），或者除了包含公司列表之外没有其他用途的对象?

最后，对于良好的 REST 设计，获取所有公司列表的常用方法是使用路径 /companies，而不是 /companies/all。

# devexpress - 将javascript中的字符串转换为devexpress控件

> ID：14488731
> 
> 赞同：1
> 
> 时间：2013-01-23T20:26:22.193
> 
> 标签：devexpress

我将动态创建的 ASPxRadioButtonList(s) 列表保存在一个隐藏输入中，该输入填充到回调面板中，因此当用户选中一个复选框以启用全部时，我可以遍历所有这些 RBL 并在客户端启用它们。

但是，我无法弄清楚如何将控件“audit-Something”的字符串名称转换为实际控件，以便我可以检查 Enabled 列表项......这是我所拥有的图像：

![在此处输入图像描述](../Images/885fa22868eb5b2bfd8ad5a28c78fbaa.png)

我不断收到错误消息：对象不支持属性或方法“SetValue”

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T15:52:23.740

我不确定我是否理解正确，但我会尽力提供帮助。如果没有，请发布服务器端代码的相关部分。

如果您在隐藏字段中有 ASPxRadioButtonList 名称，请执行以下操作：

1.  在服务器端设置 ASPxRadioButtonList ClientInstanceName。每个 ASPxRadioButtonList 应该有不同的 ClientInstanceName 值。将这些客户端实例名称保存在您隐藏的位置。
2.  然后：

```
for(var i = 0; i < auditControls.length; i++) {
    var clientInstanceName = auditControls[i];
    window[clientInstanceName].SetEnabled(true);
} 
```

这将启用所有单选按钮列表控件。

# java - 在这个简单的例子中，静态关键字的目的是什么？

> ID：14488732
> 
> 赞同：5
> 
> 时间：2013-01-23T20:26:25.863
> 
> 标签：java, static

> **可能的重复：**
> [方法什么时候应该是静态的？](https://stackoverflow.com/questions/48755/when-should-a-method-be-static)

通常在为类编写静态方法时，可以使用`ClassName.methodName`. 在这个简单的例子中使用“静态”的目的是什么？为什么应该/不应该在这里使用它？私有静态也破坏了使用静态的目的吗？

```
public class SimpleTest { 

   public static void main(String[] args) {
         System.out.println("Printing...");
         // Invoke the test1 method - no ClassName.methodName needed but works fine?
         test1(5);
   }

   public static void test1(int n1) {
         System.out.println("Number: " + n1.toString());
   }
   //versus
   public void test2(int n1) {
         System.out.println("Number: " + n1.toString());
   }
   //versus
   private static void test3(int n1) {
         System.out.println("Number: " + n1.toString());
   }
} 
```

我看了一些教程。例如[http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)

我对它的理解是，您可以只使用类名而不是创建类的实例来使用该方法 - 在某些情况下节省内存，每次都使用特定方法构造一个对象是没有意义的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:28:18.543

关键字的目的`static`是能够在不创建类实例的情况下使用成员。

这就是这里发生的事情；调用所有方法（包括私有方法）而不创建`SimpleTest`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:30:20.180

在此示例中，静态用于直接访问方法。私有静态方法破坏了“数据隐藏”的目的。

您的 main 可以直接调用 test1 方法，因为它也是静态的，它不需要任何对象进行通信。`Main`不能引用`non-static`成员，或者任何其他非静态成员不能引用静态成员。

`"non-static members cannot be referred from a static context"`

您可以参考[此线程](http://www.leepoint.net/notes-java/flow/methods/50static-methods.html)以获取有关静态成员的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:28:20.040

`static`意味着该函数不需要调用类的实例。代替：

```
SimpleTest st = new SimpleTest();
st.test2(5); 
```

您可以致电：

```
SimpleTest.test1(5); 
```

[您可以在本文](http://www.leepoint.net/notes-java/flow/methods/50static-methods.html)中阅读有关静态方法的更多信息。

[这里已经提出了](https://stackoverflow.com/questions/685522/using-private-static-methods)`private static`一个关于 的问题。要带走的重要部分是：

> 私有静态方法本身并不违反 OOP，但是当您在不需要（也不能*）访问实例字段的类上有很多这些方法时，您就不是以 OO 方式编程，因为“对象”意味着状态+对该状态一起定义的操作。如果它们不需要任何状态，为什么要将这些方法放在该类上？-埃尔延索

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:30:29.273

您将与类的特定实例无关的所有计算放入静态方法中。

关于可见性，`public static`当您要导出功能时使用，而`private static`旨在独立于实例但内部使用。

例如，假设您想为类的每个实例分配一个唯一标识符。为您提供下一个 id 的计数器与任何特定实例无关，您也不希望外部代码对其进行修改。因此，您可以执行以下操作：

```
class Foo {
    private static int nextId = 0;

    private static int getNext () {
        return nextId ++;
    }

    public final int id;

    public Foo () {
        id = getNext();    // Equivalent: Foo.getNext()
    }
} 
```

如果在这种情况下，您还想从类外部知道已创建了多少实例，则可以添加以下方法：

```
public static int getInstancesCount () {
    return nextId;
} 
```

关于`ClassName.methodName`语法：它很有用，因为它指定了提供静态方法的类的名称。如果您需要从类内部调用该方法，您可以忽略第一部分，因为名称`methodName`在命名空间方面是最接近的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:33:29.513

在您的示例中调用`test1`from`main`无需使用类名即可工作，因为`test1`它是与`main`. 如果您想调用`test2`from `main`，则需要先实例化该类的对象，因为它不是静态方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T20:28:31.850

`static`表示该方法不与该类的实例相关联。

它与`public`/ `protected`/正交`private`，它决定了方法的可访问性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-23T20:34:07.613

当静态方法在同一个类中时，不需要使用类名来限定该方法。一个方法是私有的（静态的或非静态的）仅仅意味着它不能被另一个类访问。实例方法（在您的示例中为 test2）只能在类的实例上调用，即：

```
new SimpleTest().test2(5); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-23T20:36:28.773

由于 main 是一个静态方法，如果你想调用类的方法而不实例化它，你需要使这些方法也是静态的。

关于将私有方法设为静态，它比其他方法更具可读性。引擎盖背后并没有太大的区别。

# javascript - asp.net 用户控件中的 Javascript 变量 - 覆盖同一插入的用户控件中的变量

> ID：14488736
> 
> 赞同：1
> 
> 时间：2013-01-23T20:26:36.637
> 
> 标签：javascript, asp.net, variables, user-controls

我在 Default.aspx 中插入了四个相同的 UserControl。我想将数据写入 HiddenField 并使用 javascript 将此数据写入 Label1。

该方法仅适用于最后加载的 UserControl - HiddenFieldLoader3。

为什么该方法不适用于所有用户控件？我怎样才能修复我的代码？

**默认.aspx**

```
<%@ Register Src="~/HiddenFieldLoader.ascx" TagPrefix="uc1" TagName="HiddenFieldLoader" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Default.aspx</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="HiddenFieldLoader.js"></script>
</head>
<body>
    <form id="form1" runat="server">
        <uc1:HiddenFieldLoader runat="server" ID="HiddenFieldLoader" />
        <uc1:HiddenFieldLoader runat="server" ID="HiddenFieldLoader1" />
        <uc1:HiddenFieldLoader runat="server" ID="HiddenFieldLoader2" />
        <uc1:HiddenFieldLoader runat="server" ID="HiddenFieldLoader3" />
    </form>
</body>
</html> 
```

用户控件：**HiddenFieldLoader.ascx**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="HiddenFieldLoader.ascx.cs" Inherits="NewControls.HiddenFieldLoader" %>

<script type="text/javascript">
    HFLoader.declareVariables("<%=Button1.ClientID %>", "<%=HiddenField1.ClientID %>", "<%=Label1.ClientID %>");
</script>

<asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
<asp:HiddenField ID="HiddenField1" runat="server" />

<input type="button" ID="Button1" value="Save" runat="server" />

<input type="button" ID="Button2" onclick="HFLoader.showEvent();" value="Show" runat="server" /> 
```

Javascript 文件：**HiddenFieldLoader.js**

```
HFLoader = {

    button: null,
    hiddenField: null,
    label: null,

    declareVariables: function (btn, hf, label) {
        HFLoader.button = btn;
        HFLoader.hiddenField = hf;
            HFLoader.label = label;
        },
        ///////SHOW EVENT
        showEvent: function () {
            $("#" + HFLoader.label).html($("#" + HFLoader.hiddenField).val());

        },
        //////!SHOW EVENT
        saveHiddenField: function (data) {

        $("#" + HFLoader.hiddenField).val(data);
    },

    buttons: function () {
        $("#" + HFLoader.button).click(function () {

            var datatest = "Data from button ID: " + $(this).attr("id");
            HFLoader.saveHiddenField(datatest);
            $("#" + HFLoader.label).html($("#" + HFLoader.hiddenField).val());
            return false;
        });
    },

    init: function () {
        $(function () {

            HFLoader.buttons();

        });
    }

};

HFLoader.init(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:48:59.803

它不起作用，因为您使用的是单个实例变量，`HFLoader`而不是实例。

因此，修复它的一种方法是将您的对象包装`HFLoader`在更紧密的（函数，本地范围）中，以便每个方法调用都限定对象的范围。在下面的示例中，我将变量包装`HFLoader`在创建者函数中。然后，每次调用`HFLoaderCreator`都会产生`HFLoader`对象的不同版本（实例）。我选择这样做而不是创建一个真正的 JS 类的原因是因为它需要最少的代码更改来演示它是如何完成的。

编辑。还假设您想在以后调用 HFLoader 以调用诸如`saveHiddenField`方法之类的东西。为此，我做了 2 次。1）我已经添加`data('HFLoader')`了传入的三个元素，因此您可以使用其中任何一个来调用`HFLoader`设置。并且 2) 我添加了自定义事件，您可以触发这些事件来调用这些方法。这两个选项显示了 jQuery 插件开发人员用来允许访问底层结构的两种不同方式。

```
<script type="text/javascript">
    HFLoaderCreator("<%=Button1.ClientID %>", "<%=HiddenField1.ClientID %>", "<%=Label1.ClientID %>");
</script>

function HFLoaderCreator(btn, hf, label)
{
    var HFLoader = {

        button: null,
        hiddenField: null,
        label: null,

        declareVariables: function (btn, hf, label) {
            HFLoader.button = btn;
            HFLoader.hiddenField = hf;
            HFLoader.label = label;
        },

        saveHiddenField: function (data) {
            $("#" + HFLoader.hiddenField).val(data);
        },

        buttons: function () {
            $("#" + HFLoader.button).click(function () {

                var datatest = "Data from button ID: " + $(this).attr("id");
                HFLoader.saveHiddenField(datatest);
                $("#" + HFLoader.label).html($("#" + HFLoader.hiddenField).val());
                return false;
            });

            // add the data so it can be recalled at a later date
            $("#" + HFLoader.button).data('HFLoader', HFLoader);
            $("#" + HFLoader.hiddenField).data('HFLoader', HFLoader);
            $("#" + HFLoader.label).data('HFLoader', HFLoader);

            // add custom event handlers - saveHiddenField
            $("#" + HFLoader.button).on('saveHiddenField', HFLoader.saveHiddenField);
            $("#" + HFLoader.hiddenField).on('saveHiddenField', HFLoader.saveHiddenField);
            $("#" + HFLoader.label).on('saveHiddenField', HFLoader.saveHiddenField);

            // add custom event handlers - showEvent
            $("#" + HFLoader.button).on('showEvent', HFLoader.showEvent);
            $("#" + HFLoader.hiddenField).on('showEvent', HFLoader.showEvent);
            $("#" + HFLoader.label).on('showEvent', HFLoader.showEvent);  
        },

        init: function () {
            $(function () {

                HFLoader.buttons();

            });
        }

    };

   HFLoader.declareVariables(btn, hf, label);
   HFLoader.init();

   return HFLoader;
} 
```

所以现在要充分利用它。在 JS 中，如果您想根据 Button1 ID 查找 HFLoader 数据，您可以执行以下操作：

```
<script type="text/javascript">
  var HFLoader = $('#<%=Button1.ClientID %>').data('HFLoader');
  HFLoader.showEvent();
</script> 
```

如果您想使用 ButtonID1 来触发最终会调用 showEvent 方法的自定义事件，您可以执行以下操作：

```
<script type="text/javascript">
  $('#<%=Button1.ClientID %>').trigger('showEvent');
</script> 
```

如果你想内联，就像你的第一个例子......

```
<input type="button" ID="Button2" onclick="$('#<%=Button1.ClientID %>').data('HFLoader').showEvent();" value="Show" /> 
```

虽然我强烈建议使用 JS 将事件连接到 Button2，例如：

```
$(function()
{
  $('#<%=Button2.ClientID').click(function()
  {
    $('#<%=Button1.ClientID %>').data('HFLoader').showEvent();

    return false;
  });
}); 
```

这样它就不是内联脚本。总的来说，HFLoader 的脚本有点被破解了。我建议看一下我整理的示例，以提取有用的信息，并考虑重新思考和/或重写你做事的方式。你的大脑将你推向某种“全局”视图，或者某种称为 HFLoader 的自动范围变量。但是如果你在一个页面上有 5 个实例，那么你真的想要一些 HFLoader 对象的实例，而不是一些 HFLoader 的全局概念。这就像创建一个类的新实例，而不是使用一个类的静态或单例实例——两个非常不同的概念！

我希望这有帮助。

# c# - MVC ValidationMessageFor 无法正常工作

> ID：14488737
> 
> 赞同：5
> 
> 时间：2013-01-23T20:26:47.003
> 
> 标签：c#, asp.net-mvc-3, razor

在我看来，我有以下几点：

```
 <fieldset>
        <legend>User Registration</legend>            
        <div class="editor-label">
            @Html.LabelFor(m => m.UsrName)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(m => m.UsrName)
            @Html.ValidationMessageFor(m => m.UsrName)
        </div>
        <div class="editor-label">
            @Html.LabelFor(m => m.Pwd)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(m => m.Pwd)
            @Html.ValidationMessageFor(m => m.Pwd)
        </div>
        <div class="editor-label">
            @Html.LabelFor(m => m.ReEnterPwd)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(m => m.ReEnterPwd)
            @Html.ValidationMessageFor(m => m.ReEnterPwd)
        </div>            
       <fieldset>
         <legend>Location</legend>
           <span id="locationDiv"> 
           @Html.RadioButtonFor(m => m.Location, "Loc1")  @Html.Label("Loc1")
           &nbsp;&nbsp; 
           </span>
           @Html.RadioButtonFor(m => m.Location, "Loc2") @Html.Label("Loc2")               
           @Html.ValidationMessageFor(m => m.Location)
        </fieldset>         

         <fieldset>
         <legend>Role</legend>
            @Html.RadioButtonFor(m => m.Role, "User") @Html.Label("User")
           &nbsp;&nbsp; @Html.RadioButtonFor(m => m.Role, "Admin") @Html.Label("Admin")
            @Html.ValidationMessageFor(m => m.Role)
         </fieldset>  

        <p>
            <input type="submit" value="Register User" />
        </p> 
    </fieldset> 
```

即使我没有填写所有字段，即使它们都是必需的，它仍然会转到控制器。我想

```
 @Html.ValidationMessageFor 
```

应该防止这种情况。

```
 [Required]
    public string Location { get; set; }

    [Required]
    public string Role { get; set; }

    [Required]
    [Display(Name = "User Name")]
    public string UsrName { get; set; }

    [Required]
    [StringLength(50, MinimumLength = 5, ErrorMessage = "Must have a minimum length of 5.")]
    public string Pwd { get; set; }

    [Required]
    [Display(Name = "Re-enter Password")]
    [StringLength(50, MinimumLength = 5, ErrorMessage = "Must have a minimum length of 5.")]
    [Compare("Pwd", ErrorMessage = "The password and re-entered password do not match.")]
    public string ReEnterPwd { get; set; } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T20:31:21.363

您必须在视图中包含以下脚本：

```
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-03-12T22:18:23.003

我必须在脚本部分的视图底部包含 JQuery Validation 包。

我注意到这存在于所有用于登录和身份验证的烘焙视图中，但需要手动添加到您的自定义视图中。

例子

```
 @section scripts{
    @Scripts.Render("~/bundles/jqueryval")
} 
```

# c# - 如何获取对应于选中复选框的行然后写出值？

> ID：14488744
> 
> 赞同：1
> 
> 时间：2013-01-23T20:27:08.210
> 
> 标签：c#, asp.net, visual-studio, gridview, checkbox

各位程序员好，

现在我有一个通过网格视图显示数据表的网页。这工作正常。我还在视图的开头插入了一列复选框。这也很好。但是，当我尝试从选中相应复选框的行中的单元格中检索信息时，我得到一个空字符串。

以下是与此问题相关的代码部分：

.aspx：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (Page.IsPostBack)
        {
            return;
        }
        else
        {

        }

        //server connections and whatnot//

        OleDbCommand c0 = new OleDbCommand(sql0, myConnection);
        myAdapter.SelectCommand = c0;
        DataSet ds0 = new DataSet("Contacts");
        myAdapter.Fill(ds0);
        DataTable dt0 = new DataTable(); 
        dt0 = ds0.Tables["Contacts"];
        DataView view = new DataView();
        view.Table = dt0;
        GV0.DataSource = view;
        GV0.DataBind();

        myConnection.Close();
    } 
```

。CS：

```
 /**
     * WHY U NO WORK?!
     */
    public void Dedupe(Object o, EventArgs e)
    {
        String output = "start ";
        foreach (GridViewRow row in GV0.Rows)
        {
            CheckBox cb = (CheckBox)row.FindControl("CheckBox1");
            if (cb.Checked == true)
            {
                output += row.Cells[1];
            }
        }
        Label1.Text = output;
    } 
```

任何帮助将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:06:51.907

只是一个想法，但在您的 foreach 循环中，您可能需要检查您正在循环的当前行的 RowType 属性，并确保将其设置为 DataRow。或者，您可以使用 LINQ 语句仅返回具有 RowType == DataRow 的行并对其进行循环。

**更新** 这是我的意思的快速示例。但是在查看您的代码时，您的 gridview 的第二个单元格中似乎没有任何文本，实际上您的 gridview 只有一个基于您提供的代码的单元格。

```
public void Dedupe(Object o, EventArgs e)
{
    String output = "start ";
    IEnumerable<GridViewRow> rows = from r in GV0.Rows
                                    where r.RowType == DataControlRowType.DataRow
                                    select r;
    foreach (GridViewRow row in rows)
    {
        CheckBox cb = (CheckBox)row.FindControl("CheckBox1");
        if (cb.Checked)
        {
            output += row.Cells[1];
        }
    }
    Label1.Text = output;
} 
```

# javascript - Javascript JSON 日期反序列化

> ID：14488745
> 
> 赞同：18
> 
> 时间：2013-01-23T20:27:08.803
> 
> 标签：javascript, json, serialization

我正在尝试反序列化一个包含 javascript 日期的 json 对象。在对象上调用 JSON.stringify 时，日期被序列化为未正确反序列化回日期的字符串。我尝试使用带有 chrome、IE 和 FF 的本机浏览器实现以及使用 jquery 来反序列化对象。两者都给出了一些结果。这是片段：

```
var obj = {Date: new Date()};
var objSer = JSON.stringify(obj);
var objDeser = JSON.parse(objSer);
var objJqDeser = $.parseJSON(objSer);

function getYear(value){
  try{
     return value.getYear();
  }
  catch(err){
    return err;
  }
}

$("#orig").text("Orig Year: " + getYear(obj.Date));
$("#deser").text("Deser Year: " + getYear(objDeser.Date));
$("#jqDeser").text("JqDeser Year: " + getYear(objJqDeser.Date)); 
```

我希望 objDeser.Date 成为 js 日期而不是字符串。你可以在这里看到这个问题：http: [//jsbin.com/unijud/24/edit](http://jsbin.com/unijud/24/edit)。是否有任何 js 库可以在构建 javascript 对象时正确反序列化日期？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-05-16T01:30:03.333

`JSON.parse`有一个鲜为人知的第二个参数：'reviver' 函数。这正是用于此目的：`Date`在初始解析期间将日期字符串恢复为对象（或者，假设是您想要从字符串转换的任何其他类型的对象）。

有一篇关于此的[SO 帖子](https://stackoverflow.com/a/14509447/800457)，这里有[一篇博文](http://weblog.west-wind.com/posts/2014/Jan/06/JavaScript-JSON-Date-Parsing-and-real-Dates)，其中包括一个实现示例和一个函数，该函数将在解析为`Date`.

这是该博客文章中的关键功能，fwiw：

```
// JSON date deserializer
// use as the second, 'reviver' argument to JSON.parse();

if (window.JSON && !window.JSON.dateParser) {
    var reISO = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*))(?:Z|(\+|-)([\d|:]*))?$/;
    var reMsAjax = /^\/Date\((d|-|.*)\)[\/|\\]$/;

    JSON.dateParser = function (key, value) {
        // first, just make sure the property is a string:
        if (typeof value === 'string') {
            // then, use regex to see if it's an ISO-formatted string
            var a = reISO.exec(value);
            if (a) {
                // if so, Date() can parse it:
                return new Date(value);
            }
            // otherwise, see if it's a wacky Microsoft-format string:
            a = reMsAjax.exec(value);
            if (a) {
                // and perform some jujitsu to make use of it:
                var b = a[1].split(/[-+,.]/);
                return new Date(b[0] ? +b[0] : 0 - +b[1]);
            }
            // here, you could insert any additional tests and parse instructions you like, for other date syntaxes...
        }
        // important: you need to return any values you're not parsing, or they die...
        return value;
    };
}

// use: JSON.parse(json,JSON.dateParser); 
```

（关于 ISO 8601 日期的正确正则表达式有[很多意见](https://stackoverflow.com/questions/12756159/regex-and-iso8601-formated-datetime)。YMMV。此外，没有特别的理由将函数打到全局 JSON 对象上。你可以在任何你喜欢的地方存储/引用它。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-24T00:22:37.250

我接受了@LastCoder 的建议并编写了一个简单的实现。它似乎正在做我想做的事。

```
var jsonDates = {
  dtrx2: /\d{4}-\d{2}-\d{2}/,
  parse: function(obj){
      var parsedObj = JSON.parse(obj);
      return this.parseDates(parsedObj);
  },
  parseDates: function(obj){
    // iterate properties
    for(pName in obj){

      // make sure the property is 'truthy'
      if (obj[pName]){
        var value = obj[pName];
        // determine if the property is an array
        if (Array.isArray(value)){
          for(var ii = 0; ii < value.length; ii++){
            this.parseDates(value[ii]);
          }
        }
        // determine if the property is an object
        else if (typeof(value) == "object"){
          this.parseDates(value);
        }
        // determine if the property is a string containing a date
        else if (typeof(value) == "string" && this.dtrx2.test(value)){
          // parse and replace
          obj[pName] = new Date(obj[pName]);
        }
      }
    }

    return obj;
  }
}; 
```

[jsbin](http://jsbin.com/unijud/59/edit)上提供了一个实时示例。[gist](https://gist.github.com/4616109)上提供了参考。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-01T18:26:11.780

为了使用 JavaScript 表示日期，我发现 JSON 使用 ISO 8601，一种将日期编码为字符串的特定字符串格式。不过，当我上次检查时，日期格式应该是什么样子并没有官方标准。主要浏览器使用 ISO 8601 作为 JSON 日期编码格式。

因此，日期被编码为 ISO 8601 字符串，然后在 JSON 被序列化和反序列化时就像常规字符串一样使用。

也就是说，可以使用 JavaScript Date 构造函数将 ISO 日期转换为 JavaScript 日期，该构造函数接受各种输入来构造日期，ISO 8601 就是其中之一。

获取今天的日期：

```
 var curDate = new Date();
document.write(curDate); //Mon Feb 01 2016 12:57:12 GMT-0600 (Central Standard Time) 
```

将其解析为字符串：

```
var dateStr = JSON.parse(JSON.stringify(curDate));
document.write(dateStr);//2016-02-01T18:59:35.375Z 
```

然后使用构造函数将其转换回 javascript 日期：

```
var date = new Date(dateStr);
document.write(date); //Mon Feb 01 2016 12:59:35 GMT-0600 (Central Standard Time) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-23T20:43:20.743

JSON 规范不包括日期的特殊格式。因此，它们通常被序列化为字符串，有时带有特殊标记以表明如果语言支持它们，则应将其视为 Date 对象。因此，大多数（全部？）浏览器原生 JSON 解析器无法正确地往返 Date 对象。

有几个很好的库可以帮助解决这个问题——尽管我过去也使用[过 datejs ，但我非常喜欢](http://www.datejs.com/)[MomentJS](http://momentjs.com/)。您只需要遍历您的对象并将正确的字段在解析后转换为 Date 对象。

我发现记住 JSON 格式比 JavaScript 对象字面量表示法更受限制是很有帮助的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-30T20:52:22.443

JavaScript es5 能够像`2018-04-03T22:00:00...`在其默认`Date`构造函数中一样解析日期。（例如`new Date("2018-04-03T22:00:00...");`.

对于像我这样正在**从 JSON Web 响应中搜索自动日期反序列化的**人来说，这可能很方便。

```
/**
 * Iterates over all entries of the input object and replace the string dates with the objects of {@link Date}.
*/
function fixDateObjects(responseBody) {
  if (responseBody) {
    const regex = /^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}/;
    for (const [key, value] of Object.entries(responseBody)) {
      const val = String(value);
      if (val.startsWith('[object Object]')) {
        fixDateObjects(value);
      }
      if (val.match(regex)) {
        responseBody[key] = new Date(val);
      }
    }
  }
} 
```

**说明：**它遍历 JSON(responseBody) 的所有对象条目，并用对象替换字符串日期（由给定的正则表达式匹配）`new Date(str)`。

**结果：**这为您带来了进一步处理的自由。现在您已经完全反序列化了所有日期字符串。

```
//usage
function parseBody(response) {
   fixDateObjects(response);

   console.log(response.someDate); // Mon Aug 30 2021 22:45:59 GMT+0200 (...)
   // further processing
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T20:57:42.983

您可以手动将所需的所有日期函数添加到 String.prototype。

```
String.prototype.getYear = function() {
    return Date.parse(this).getYear();
};
var obj = {date: new Date()};
var dtObj = JSON.parse(JSON.stringify(obj));
console.log(dtObj.date.getYear()); 
```

或者您可以覆盖 JSON.parse 并让它遍历结果对象以查找与时间戳正则表达式匹配的字符串，然后将它们转换为 Date 对象。

```
var JSON_parse = JSON.parse;
JSON.parse = function(str) {
    var res = JSON_parse(str);
    findAndConvertStringsToDates(res);
    return res;
} 
```

**编辑**这是我为实现而准备的内容

```
(function() {
    var jsonParse = JSON.parse;
    var reDate = /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/i;
    function jsonDate(obj) {
        var type = typeof(obj);
        if(type == 'object') {
            for(var p in obj)
                if(obj.hasOwnProperty(p))
                    obj[p] = jsonDate(obj[p]);
            return obj;
        } else if(type == 'string' && reDate.test(obj)) {
            return new Date(obj);
        } 
        return obj;
    }
    JSON.parse = function(str) { return jsonDate(jsonParse(str)); }
})();
/*
 * Tests
 */
var dt = JSON.parse(JSON.stringify({date: new Date()}));
console.log(typeof(dt.date));
console.log(JSON.parse(JSON.stringify(null)));
console.log(JSON.parse(JSON.stringify(123)));
console.log(JSON.parse(JSON.stringify("test")));
console.log(JSON.parse(JSON.stringify(new Date())));
console.log(JSON.parse(JSON.stringify([1,new Date(),2])));
console.log(JSON.parse(JSON.stringify({d: new Date(), d2: {d3: new Date(), d4: [0,new Date(),4]}}))); 
```

# ruby - Ruby - 在内存中创建文件

> ID：14488748
> 
> 赞同：22
> 
> 时间：2013-01-23T20:27:29.943
> 
> 标签：ruby, csv, io

无论如何在Ruby中编写以下代码而不将文件写入磁盘？

```
temp_file = 'path/to/file.csv'
users = [a@b.c, c@b.a]

CSV.open(temp_file, "w") do |csv|
  csv << data_for_report
end

Reports.sendreport users temp_file

File.delete(temp_file) 
```

Reports.sendreport 附加一个文件并发送电子邮件，所以它需要是一个文件...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T21:47:11.293

你可以使用[`Tempfile`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html). `Tempfile`将文件写入光盘，因此不符合您的要求。

但我认为 Tempfile 提供了您需要的一些功能：

> 当一个 Tempfile 对象被垃圾回收，或者当 Ruby 解释器退出时，它相关的临时文件会被自动删除。

例子：

```
require 'tempfile'
require 'csv'

data_for_report = [1,2,3,4]
temp_file = Tempfile.new('foo')

CSV.open(temp_file, "w") do |csv|
  csv << data_for_report
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:12:56.973

尝试其中一种 mmap 宝石。如果库*仅*采用文件名，那是您的选择。

但是，如果它可以接受类似文件的对象，则可以使用 StringIO。

您可能会考虑更改任何`Reports`内容，使其更通用。这取决于它使用什么来创建它的邮件消息——这可能是微不足道的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-07T15:00:31.753

使用您当前的代码是不可能的，如果您的代码将使用文件指针/句柄，您可以执行以下操作：

```
require 'csv'
require 'stringio'

data_for_report = [1,2,3,4]
temp_file = StringIO.new # creates a fake file as string.

CSV.new(temp_file, "w") do |csv|
  csv << data_for_report
end 
```

为什么它不适用于您的用例的关键问题是行`Reports.report users temp_file`

如果它接受句柄而不是字符串，它将起作用。

另请参阅此 SO：[https ://stackoverflow.com/a/19110958/887836](https://stackoverflow.com/a/19110958/887836)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-04T21:10:23.923

```
temp_file = CSV.generate do |csv|
  csv << data_for_report
end

Reports.sendreport users temp_file 
```

# c# - C# 参数化 Oracle 更新在 ExecuteNonQuery 上失败

> ID：14488751
> 
> 赞同：1
> 
> 时间：2013-01-23T20:27:46.740
> 
> 标签：c#, oracle, odp.net

我正在尝试动态更新一组数据库表。我有两个变量； `table_name`& `field_name`. 这些由`foreach`循环填充，循环通过`DataTable`. `DataTable`每次我们在名称中分别更改新行时。在这个循环中，我创建了一个新的 Oracle 连接并尝试使用当前的 table_name/field_name 编写更新。但是甲骨文一直给我一个错误的`ExcecuteNonQuery`命令。任何帮助是极大的赞赏！！

编辑：我已经重新格式化以包含参数，但仍然不起作用有人对我做错了什么有任何想法吗？

```
foreach (DataRow fieldtable in setofTables.Tables[0].Rows)
{

    //do work                   
    table_name = fieldtable["table_name"].ToString().Trim();
    field_name = fieldtable["field_name"].ToString().Trim();

    MessageBox.Show(table_name + field_name);

    //create parameters

    OracleParameter fieldParamater = new OracleParameter("field_name", OracleDbType.Varchar2);
    OracleParameter diffParameter = new OracleParameter("mark_diff_oracle", OracleDbType.BinaryFloat);
    OracleParameter wellIdParameter = new OracleParameter("id", OracleDbType.Char);
    //wellIdParameter.Size = 10;

    //create oracle connection and open 
    OracleConnection OrclCon2 = new OracleConnection("Data Source=" + dbname + "; User Id=" + userid + ";Password=" + password1 + ";");
    OrclCon2.Open();

    //prepare sql to be passed to oracle 
    string UpdateOraSQL = "UPDATE " +table_name+ " set :field_name = :field_name - (:mark_diff_oracle) where  id = ':id' and :field_name is not null;";
    MessageBox.Show(UpdateOraSQL);   

    //create dommand
    OracleCommand UpdateDB = new OracleCommand(UpdateOraSQL, OrclCon2);
    UpdateDB.CommandType = CommandType.Text;
    //add parameters
    UpdateDB.Parameters.Clear();
    UpdateDB.Prepare();
    UpdateDB.Parameters.Add(fieldParamater).Value = field_name;
    UpdateDB.Parameters.Add(diffParameter).Value = mark_diff_oracle;
    UpdateDB.Parameters.Add(wellIdParameter).Value = id; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:19:10.610

删除 sql 语句末尾的分号。更改以下代码

```
string UpdateOraSQL = "UPDATE " +table_name+ " set :field_name = :field_name - (:mark_diff_oracle) where  id = ':id' and :field_name is not null;"; 
```

到

```
string UpdateOraSQL = "UPDATE " +table_name+ " set :field_name = :field_name - (:mark_diff_oracle) where  id = ':id' and :field_name is not null"; 
```

有关更多信息，请参阅以下链接

[为什么在 C# 时分号不能放在 OracleCommand 的 CommandText 中](https://stackoverflow.com/questions/6212575/why-the-semicolon-couldnt-place-in-the-commandtext-of-a-oraclecommand-when-c-sh)

如果问题仍未解决，那么您也可以发布整个异常消息，这可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T21:23:38.293

AFAIK，您不能使用参数来定义您正在更新的列。AFAIK，您只能将参数用于要设置的值。

因此，您必须使用字符串 concat 创建查询：

```
string sql = "UPDATE " + tableName + " SET " + fieldName + " = :p_Value  WHERE id = :p_Id";

OracleCommand UpdateDB = new OracleCommand(sql, OrclCon2);

UpdateDB.Parameters.Add ("p_Value", ... ).Value = "foo";
UpdateDB.Parameters.Add ("p_Id", ...).Value = 4; 
```

当然，您应该确保添加到字符串中的变量不包含任何有害的语句。您应该对它们进行完整性检查。
也许，您甚至可以验证已传递的 tableName 或 fieldName 是否是有效/现有的 tableName/columnname。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:29:59.167

在 SQL 中，没有说`COLUMN <> NULL`. 正确的语法是`COLUMN IS NOT NULL`.

# php - 使用 curl 在本地获取 .php 文件

> ID：14488753
> 
> 赞同：2
> 
> 时间：2013-01-23T20:27:52.210
> 
> 标签：php, curl

我`curl`在 PHP 中使用来返回 PHP 文件的内容。我想在本地执行此操作，因为我将在同一个脚本中访问多个 PHP 文件，因此直接打开文件会更快。

但是，我希望能够将参数推送到 PHP 文件中（将它们完全视为 Web 上的 PHP 文件，但在本地抓取它们），因为我想将参数推送到脚本中，当我抓取时将生成额外的动态内容它。

如果我在本地调用文件，这可能吗？我尝试使用 file:///，直接调用该文件，但这不会运行在这些文件中找到的 PHP 代码。

有任何想法吗？

**编辑**

很抱歉造成混淆：-这目前在网络服务器上运行，我目前正在调用 http://（而不是 file:///），因此可以执行这些文件中包含的 PHP。但是，我发现这很慢，因为我正在生成多个 curl() 调用，这些调用实际上是多次调用服务器本身。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:36:50.920

你可以做这样的伎俩：

```
function php_to_string($php_file, $new_GET = false, $new_POST = false) {
    // replacing $_GET, $_POST if necessary
    if($new_GET) {
        $old_GET = $_GET;            
        $_GET = $new_GET;
    }
    if($new_POST) {
        $old_POST = $_POST;            
        $_POST = $new_POST;
    }
    ob_start();
    include($php_file);
    // restoring $_GET, $_POST if necessary
    if(isset($old_GET)) {
       $_GET = $old_GET;
    }
    if(isset($old_POST)) {
       $_POST = $old_POST;
    }
    return ob_get_clean();
}

$content = php_to_string('my_file.php');
$content = php_to_string('my_file.php', Array('id'=>23)); // http://localhost/my_fie.php?id=23 
```

但请注意它可能会覆盖您现有的变量，导致错误（例如重复定义）等，因此您可以使用[沙盒解决方案](https://stackoverflow.com/questions/324726/is-there-a-way-to-execute-php-code-in-a-sandbox-from-within-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:33:35.427

我相信你会想在你的本地机器上设置一个 web 服务器（例如 Apache），这样你就可以去`http://localhost/script.php?param1=foo&param2=bar`而不是`file:///path/to/script.php`. 不同之处在于，当你这样做时`file:///`，文件只是被*打开*，但如果你通过 Apache，脚本实际上是*被执行*的。

至于将参数传递给脚本，请使用查询字符串（例如`?param1=foo`，等）。

我不知道你为什么要做你正在做的事情，但希望这可以帮助你做到这一点。

# hadoop - 在 pig 中读取 snappy 压缩输入

> ID：14488755
> 
> 赞同：0
> 
> 时间：2013-01-23T20:27:53.597
> 
> 标签：hadoop, apache-pig, snappy

我有一个文件，我试图将它加载到用 snappy 压缩的 pig 中。我在 grunt 中设置了配置选项，就像在[这个 jira 问题](https://issues.apache.org/jira/browse/PIG-2319)中描述的那样，但我仍然在结果中获得压缩数据。

当我运行该作业时，它确实说：org.apache.hadoop.io.compress.snappy.LoadSnappy - Snappy 本机库可用

对于这项工作，我使用 PigStorage() as (x, y, z) 做了一个简单
的 a = load '/path/to/snappy/file'

然后：
转储数据

将输出压缩数据。

有谁知道我可以做些什么来正确读取数据？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:13:09.400

PigStorage 使用 PigTextInputFormat 进行输入，它将检测并使用 Snappy 压缩文件，但文件必须具有正确的扩展名，以便 hadoop 压缩编解码器工厂知道使用 snappy。

我的猜测是您的文件没有 .snappy 扩展名，请尝试重命名文件并重试

# transition - CSS过渡缓出不起作用

> ID：14488757
> 
> 赞同：12
> 
> 时间：2013-01-23T20:28:03.377
> 
> 标签：transition

好的，所以我不明白为什么这不能缓解，只是在：（例如，为了快速查看，只需将其粘贴到[http://htmledit.squarefree.com](http://htmledit.squarefree.com)中）

```
<style>
#over {
background: url(http://th01.deviantart.net/fs71/150/f/2013/005/0/6/dal_shabet__have__don_t_have_by_awesmatasticaly_cool-d5qkzu8.jpg);
height:150px;
width:150px;
}

#in {
background: url(http://www.mygrafico.com/images/uploads/thumbs/thumb_revidevi_CoolMonsterTruck.jpg);
height:150px;
width:150px;
}

#in:hover {
opacity: 0;
transition: opacity .3s ease-in-out;
}

</style>

<div id="over">
<div id="in"></div
</div> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-19T23:32:27.447

我不确定你到底在问什么，但我认为你是说过渡只发生在鼠标悬停时，而不是当你鼠标移开时（它只是恢复到以前的方式，而不是过渡）。您需要将转换属性添加到`#in`，而不是`#in:hover`。仅当您的`#in`元素悬停时才会发生过渡。将用于过渡的 css 移到下方`#in`，它将在鼠标悬停和鼠标移出时起作用。您希望将悬停状态所需的 css 保留在 下`#in:hover`，在这种情况下，不透明度会发生变化，但实际的过渡 css 属性将位于 下`#in`。

为了更清楚一点：

```
#in {
    background: url(http://www.mygrafico.com/images/uploads/thumbs/thumb_revidevi_CoolMonsterTruck.jpg);
    height:150px;
    width:150px;
    transition: opacity .3s ease-in-out; /* add this here */
}

#in:hover {
    opacity:0;
    /* and we've removed it from here */
} 
```

要知道的是，缓入出与何时转换无关。看起来，缓入是悬停，缓出是鼠标悬停，但实际上，缓入意味着它会慢慢缓入和缓出，而不是像缓入那样缓和慢慢地进入过渡，然后加速接近尾声。它与过渡本身的风格有关，而不是何时发生。

也许您已经理解了这一点，但是根据您的问题，您似乎对此感到困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-29T22:39:22.793

我发现@welbornio 的答案对我有用，但是ease-in-out 一开始并不完美。当应用于“img”时，缓解效果只能间歇性地起作用。我发现为了让效果每次都能发挥作用，我必须将缓入应用于“img”，将缓出应用于“悬停”。我不确定为什么会发生这种情况，但如果有人遇到同样的问题，这是一个解决方案。

# windows-phone-7 - phonegap windows phone 复制现有的 www 过吗？

> ID：14488763
> 
> 赞同：0
> 
> 时间：2013-01-23T20:28:19.303
> 
> 标签：windows-phone-7, cordova, buildaction

我创建了一个 phonegap windows phone 项目，进行了安装和设置。当我运行模拟器时，它使用演示/默认代码运行良好。我有一个现有的 android 项目。我将我的 www 文件夹拖到 windows 项目中，但没有任何效果。manifestprocessor.js 不会在 xml 中构建任何新文件。当我右键单击我的新文件时，我**没有**选择构建操作的选项。我在构建时没有收到任何错误。我还要注意，我的默认 htnl 文件应该加载 login.html（我更新了 CordovaView.xaml.cs 文件），并且 cordova.js 文件位于 www 的“js”文件夹中，而不是像默认设置那样位于根目录中.

有人有想法么？我从来没有使用 Visual Studio 开发过，我猜我需要让我的新文件被识别，这样我才能分配我猜的构建操作，但因为它不会让我不知道该怎么做，或者即使那是问题。

感谢您的时间和建议。

# apache - htaccess 基于获取值重定向

> ID：14488768
> 
> 赞同：0
> 
> 时间：2013-01-23T20:28:23.707
> 
> 标签：apache, .htaccess, rewrite

我想根据 url 中检索到的值重定向一些页面。

我有必要用 htaccess 来做。

例如

```
http://www.mydomain.com/products.php?id=1040

http://www.mydomain.com/products.php?id=1041

http://www.mydomain.com/products.php?id=1042 
```

如果id值大于1039小于1501，apache必须重定向到另一个页面

```
http://www.mydomain.com/otherpage.html 
```

欢迎一些想法。

先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:03:30.170

尝试：

```
RewriteCond %{QUERY_STRING} ^id=([0-9]+)
RewriteCond %1 >1039
RewriteCond %1 <1501
RewriteRule ^/?products\.php? /otherpage.html? [L,R=301] 
```

第一个条件将数字 ID 分组，使其可通过**%1**作为反向引用。接下来的两个条件检查此数字 ID 是否大于 1039 且小于 1501。如果所有 3 个条件都满足，则请求`/products.php`重定向到`/otherpage.html`。at the `?`end 确保查询字符串*不附加到 end*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:33:45.450

有了这种特定的要求，我认为在应用程序级别而不是在 Apache 中执行重定向是最合适的。只需比较值 fo`$_GET['id']`并根据需要重定向 via `header()`。

要么，要么您必须编写一个相对复杂的正则表达式来搜索 a 内 1040 和 1500 之间的值，`RewriteCond`因为正`RewriteRule`则不会对查询字符串进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T20:35:18.607

你应该添加这样的东西

```
AddDefaultCharset UTF-8
Options +MultiViews
RewriteEngine On
RewriteRule condition/ http://www.mydomain.com/otherpage.html [P] 
```

悬停我不确定重定向参数值有多容易：|

# jquery-ui - 在 jQuery UI 1.10 中的对话框标题中使用 HTML

> ID：14488774
> 
> 赞同：51
> 
> 时间：2013-01-23T20:28:49.660
> 
> 标签：jquery-ui

[http://jqueryui.com/upgrade-guide/1.10/#changed-title-option-from-html-to-text](http://jqueryui.com/upgrade-guide/1.10/#changed-title-option-from-html-to-text)

jQuery UI 1.10 使对话框标题只能是文本（不能是 html），以防止脚本漏洞。我不允许用户输入来生成这个标题，所以我仍然想使用 HTML，主要是在标题的左侧显示一个图标。

我将发布我对这个问题的解决方案，因为我还没有看到其他人问或回答这个问题。希望它会帮助其他人，或者其他人可能有更好的方法。

关于他们为什么这样做的更多信息：http: [//bugs.jqueryui.com/ticket/6016](http://bugs.jqueryui.com/ticket/6016)

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-23T20:28:49.660

这将覆盖设置 jQuery UI 对话框标题时使用的函数，允许它包含 HTML。

```
$.widget("ui.dialog", $.extend({}, $.ui.dialog.prototype, {
    _title: function(title) {
        if (!this.options.title ) {
            title.html("&#160;");
        } else {
            title.html(this.options.title);
        }
    }
})); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-10-24T22:02:16.337

如果你对重写 jQuery 的 _title 方法犹豫不决，你可以在 jQuery 对话框的 open 事件中对 title 元素使用 html、append 或类似方法，如下所示：

```
$("#element").dialog({
  open: function() {
    $(this).find("span.ui-dialog-title").append("<span class='title'>" + subtitle + "</span>");
  }
}); 
```

上面的代码在绕过 jQuery 的 title 方法的同时正确地解析了 HTML。而且由于它发生在公开活动中，因此用户体验保持无缝。刚刚在一个项目上做了这个，效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-05T09:58:17.073

这将在初始化对话框后修改标题

```
$('#element').dialog(options);

var dialogTitle = $('#element').closest('.ui-dialog').find('.ui-dialog-title');
dialogTitle.html('<strong>hello world</strong>'); 
```

# image - 从 gmail 应用程序发送图像会丢失扩展名 png

> ID：14488777
> 
> 赞同：1
> 
> 时间：2013-01-23T20:28:56.213
> 
> 标签：image, text, android-intent, sendmail

嗨，我正在尝试分享一些文本和图像，我使用了这个论坛的许多 snnipes，但没有任何效果。Mi代码是下一个：

```
 Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
                emailIntent.setType("image/png");
                emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "testing email send.");

                emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("android.resource://com.tortilla.patatapro/drawable/" + Integer.toString(R.drawable.ic_home)));             

                startActivity(emailIntent); 
```

首先，这似乎很容易，但问题是当我与 gmail 应用程序共享我的应用程序并且它发送图像并且仅发送电子邮件的主题时，然后当我打开电子邮件时，图像没有扩展名。例如，如果当我打开电子邮件时图像是 ic_home.png，它附加的名称为 239378437892 但没有扩展名，因此电子邮件阅读器（gmail、hotmail...）不知道是什么。

我尝试更改代码，例如：

```
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("android.resource://com.tortilla.patatapro/drawable/" + R.drawable.ic_home)); 
```

或者

```
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("android.resource://com.tortilla.patatapro/drawable/"+ R.drawable.ic_home + ".png")); 
```

但是来自 GMAIL 应用程序的电子邮件没有发送没有扩展名的图像，当然图像是 .png 扩展名。

谢谢！

# hadoop - HDFS 文件比较

> ID：14488779
> 
> 赞同：7
> 
> 时间：2013-01-23T20:29:11.423
> 
> 标签：hadoop, hive, hdfs

既然没有，如何比较两个 HDFS 文件`diff`？

我正在考虑使用 Hive 表并从 HDFS 加载数据，然后在 2 个表上使用连接语句。有没有更好的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-24T00:03:38.467

hadoop没有`diff`提供任何命令，但您实际上可以通过以下`diff`命令在 shell 中使用重定向：

```
diff <(hadoop fs -cat /path/to/file) <(hadoop fs -cat /path/to/file2) 
```

如果您只想知道 2 个文件是否相同而不关心差异，我建议您使用另一种基于校验和的方法：您可以获取两个文件的校验和，然后进行比较。我认为 Hadoop 不需要生成校验和，因为它们已经存储，所以它应该很快，但我可能错了。我认为没有命令行选项，但您可以使用 Java API 轻松完成此操作并创建一个小应用程序：

```
FileSystem fs = FileSystem.get(conf);
chksum1 = fs.getFileChecksum(new Path("/path/to/file"));
chksum2 = fs.getFileChecksum(new Path("/path/to/file2"));
return chksum1 == chksum2; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-24T00:01:56.653

好吧，最简单的答案可能是：

```
diff <(hadoop fs -cat file1) <(hadoop fs -cat file2) 
```

它只会在您的本地机器上运行。如果这太慢了，那么是的，您必须使用 Hive 和 MapReduce 做一些事情，但这有点棘手，并且不会完全匹配 diff 所做的按顺序比较。

# iphone - 将图像保存在相机胶卷中并获取资产 url

> ID：14488782
> 
> 赞同：12
> 
> 时间：2013-01-23T20:29:18.600
> 
> 标签：iphone, uiimagepickercontroller

对于我正在开发的应用程序，我使用 UIImagePickerController 拍摄照片并将其存储在相机胶卷中：

```
- (void)imagePickerController:(UIImagePickerController*)picker didFinishPickingMediaWithInfo:(NSDictionary*)info {
//... some stuff ...

        UIImageWriteToSavedPhotosAlbum([info objectForKey:@"UIImagePickerControllerOriginalImage"], nil, nil, nil);

} 
```

图像已保存，现在我需要获取其参考网址，因此我尝试枚举相机胶卷并获取最后一张图像，但我总是在刚刚拍摄的图像之前获得图像。

有人知道如何获取刚刚保存的图片的参考吗？

谢谢，马克斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T21:27:21.533

此解决方案应该可以解决问题：

```
 ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
    [library writeImageToSavedPhotosAlbum:((UIImage *)[info objectForKey:UIImagePickerControllerOriginalImage]).CGImage
                                 metadata:[info objectForKey:UIImagePickerControllerMediaMetadata]
                          completionBlock:^(NSURL *assetURL, NSError *error) {
                              NSLog(@"assetURL %@", assetURL);
                          }]; 
```

瞧：

```
assetURL assets-library://asset/asset.JPG?id=1611E84C-24E2-4177-B49A-1C57B4A9C665&ext=JPG 
```

# mysql - 使用 CodeIgniter 的 Fusioncharts 3D

> ID：14488787
> 
> 赞同：0
> 
> 时间：2013-01-23T20:29:27.130
> 
> 标签：mysql, sql, codeigniter, graph, fusioncharts

我有两张桌子

```
Table 1 : Zone        Table 2 : Tonnage
id  zonename          id  zoneid   tones  date
1     A               1    1        9.96    15-12-2012
2     B               2    2       62.26    15-12-2012
3     C               3    3       123      15-12-2012
4     D               4    4       190      15-12-2012
                      5    1       50       30-12-2012
                      6    2       45       30-12-2012
                      7    3       78       30-12-2012
                      8    4       90       30-12-2012 
```

我想创建一个带有融合图表的 MSColumn3D 图表。A、B、C、D 应位于 X 轴，色调应位于 y 轴。这是我的 sql 语句：

```
SELECT zone.zonename,tonnage.tonnes,tonnage.date
FROM zone, tonnage
WHERE zone.id = tonnage.zoneid ORDER BY ZONE.zonename; 
```

我希望将 A、B、C 和 D 的数据组合在一起并根据吨位显示，但它没有给出正确的输出。如何制定sql语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:19:51.493

询问：

**[SQLFIDDLE示例](http://sqlfiddle.com/#!2/26fa1/3)**

```
SELECT z.zonename,
       SUM(t.tones) AS TotalTones
FROM Zone z
JOIN Tonnage t
ON z.id = t.zoneid 
GROUP BY z.zonename
ORDER BY z.zonename 
```

结果：

```
| ZONENAME | TOTALTONES |
-------------------------
|        A |      59.96 |
|        B |     107.26 |
|        C |        201 |
|        D |        280 | 
```

# clojure - 使用“get”来访问地图有什么好处

> ID：14488788
> 
> 赞同：6
> 
> 时间：2013-01-23T20:29:33.720
> 
> 标签：clojure

跟进这个问题：[Idiomatic clojure map lookup by keyword](https://stackoverflow.com/questions/7034803/idiomatic-clojure-map-lookup-by-keyword)

可以通过多种方式使用 clojure 进行地图访问。

```
(def m {:a 1}

(get m :a) ;; => 1
(:a m) ;; => 1
(m :a) ;; => 1 
```

我知道我主要使用第二种形式，有时使用第三种，很少使用第一种。使用每个的优点（速度/可组合性）是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T23:02:05.423

`get`当 map 可以是 nil 或 not-a-map 并且 key 可以是不可调用的东西（即不是关键字）时很有用

```
(def m nil)
(def k "some-key")

(m k)  =>  NullPointerException
(k m)  =>  ClassCastException java.lang.String cannot be cast to clojure.lang.IFn

(get m k)  =>  nil
(get m :foo :default)  =>  :default 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T21:53:51.120

从[clojure网页](http://clojure.org/data_structures#Data%20Structures-Maps%20%28IPersistentMap%29)我们看到

> 映射实现 IFn，用于一个参数（键）的调用（）和可选的第二个参数（默认值），即映射是其键的函数。nil 键和值都可以。

有时，深入了解 Clojure 的内部结构会很有意义。如果您查看`invoke`地图中的外观，您会看到：

[https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/APersistentMap.java#L196](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/APersistentMap.java#L196)

它显然调用`valAt`了地图的方法。

如果您查看`get`使用地图调用该函数时的作用，这是对 的调用`clojure.lang.RT.get`，这实际上归结为`valAt`对地图的相同调用（地图实现 ILookUp 因为它们是[Associatives](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Associative.java)）：

[https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/RT.java#L634](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/RT.java#L634)。

对于使用键和未找到值调用的映射也是如此。那么，有什么优势呢？由于这两种方式归结为几乎相同，性能方面我不会说什么。这只是语法上的方便。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T21:45:23.653

您可以传递`get`给`partial`etc. 来构建 HOF 以弄乱您的数据，尽管它不会经常出现。

```
user=> (def data {"a" 1 :b 2})
#'user/data
user=> (map (partial get data) (keys data))
(1 2) 
```

当数据以字符串为键时，我经常使用第三种形式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T20:58:50.940

我认为没有速度差异，即使是这种情况，这也将是一个实现细节。

就我个人而言，我更喜欢第二种选择 (:am)，因为它有时会使代码看起来更容易一些。例如，我经常需要遍历一系列映射：

```
(def foo '({:a 1} {:a 2} {:a 3})) 
```

如果我想过滤 :a 的所有值，我现在可以使用：

```
(map :a foo) 
```

代替

```
(map #(get % :a) foo) 
```

或者

```
(map #(% :a) foo) 
```

当然，这是个人口味的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-24T14:23:29.710

要添加到列表中，get 在使用 threading 宏时也很有用`->`，您需要通过不是关键字的键来访问

`(let [m {"a" :a}] (-> m (get "a")))`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T08:53:07.997

使用关键字优先方法的一个优点是它是在映射为 nil 的情况下以宽容的行为访问值的最简洁方法。

# sql-server - ADO Connection.ConnectionString 不再返回凭据

> ID：14488790
> 
> 赞同：2
> 
> 时间：2013-01-23T20:29:42.127
> 
> 标签：sql-server, asp-classic, ado

我有一个需要在现代服务器上发布的旧版 ASP 应用程序。它使用带有 SQLOLEDB 的 ADO 与 MS SQL Server 通信。它使用用户名和密码登录到 SQL。

该应用程序依赖于似乎已更改的 ADO Connection 对象的特殊行为。如今（在 ADODB.Connection.6 中），当您向 Connection 提供连接字符串然后将其取回时，您不会得到原始字符串的精确副本；具体来说，去掉了用户名和密码，并添加了一些额外的参数。

在这种情况下，旧版本的 ADO 似乎没有删除凭据；如果确实如此，该应用程序将永远无法运行，并且它可以运行。问题 - 这是否记录在案？有没有办法在新的 ADO 中强制执行遗留行为？

我真的不想在共享服务器上降级 ADO。

编辑：只是将它隔离到一个最小的测试用例。适用于 Windows 2003 上的 Connection.2.80 (msado15.dll v. 2.82.5011.0)，在 Windows 2008 上的 Connection.6 上失败 (dll v.6.1.7600.17036)。

EDIT2：正式地，ADO 所属的旧 MDAC 2.8 在 Vista 和更高版本上不受支持。所以降级并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T03:42:21.977

您正在寻找的可能是“持久安全信息”属性。该属性记录[在此处](http://msdn.microsoft.com/en-us/library/ms677227%28v=vs.85%29.aspx)和[此处](http://msdn.microsoft.com/en-us/library/ms714905%28v=vs.85%29.aspx)（假设您使用的是 SQLOLEDB 提供程序；但我处理过的大多数提供程序在这方面表现相同）。基本上，当此属性设置为 时`False`，敏感信息（例如密码）将在读取连接字符串时从连接字符串中剥离。相反，当属性设置为`True`时，连接字符串将完全按照提供的方式返回（包括任何敏感信息）。

我只发现一篇[博](http://www.damirscorner.com/PersistSecurityInfoDefaultValueChangedInWindowsVista.aspx)文（但没有官方文档）指出此属性的默认值在 Windows Vista 中从 更改为`True`，`False`这与 Windows Server 2008 相对应。这与您的观察结果相符。

应该注意的是，新的默认设置`False`被认为更安全，因为意外泄露敏感信息的风险较小。这里推荐的解决方案是重新设计应用程序，使其不需要依赖从`ConnectionString`属性中获取密码。

使用该免责声明，您可以通过连接字符串显式设置“持久安全信息”属性，方法是添加`;Persist Security Info=True`. 也可以`Connection`在打开对象之前设置对象的属性（以防您无法更改连接字符串），但我不完全确定这是否可行（您可能必须先手动设置`Provider`属性） .

```
' untested examples

' Method 1
connString = "Provider=SQLOLEDB;"
connString = connString & "Data Source=example;"
connString = connString & "Initial Catalog=exampleDB;"
connString = connString & "User Id=user;"
connString = connString & "Password=1234;"
connString = connString & "Persist Security Info=True"

Set conn = Server.CreateObject("ADODB.Connection")
conn.Open connString

' Method 2
connString = "Data Source=example;"
connString = connString & "Initial Catalog=exampleDB;"
connString = connString & "User Id=user;"
connString = connString & "Password=1234;"

Set conn = Server.CreateObject("ADODB.Connection")
conn.Provider = "SQLOLEDB"
conn.Properties("Persist Security Info").Value = True
conn.Open connString 
```

# android - 打开带有空格的本地 Android 文件

> ID：14488794
> 
> 赞同：4
> 
> 时间：2013-01-23T20:29:50.457
> 
> 标签：android

我正在尝试使用意图在 Android (4.0) 中打开本地文件。以下是执行该操作的代码。只要文件没有特殊空格，它就可以正常工作（例如：如果文件是 /data/data/com.xxxx.yyyy/files/Downloads/Documents/ProductFeature.pptx，则它可以正常打开，但如果文件名称是 /data/data/com.xxxx.yyyy/files/Downloads/Documents/Product Feature.pptx （注意名称中的空格），然后失败。Uri.fromFile 正确编码空间，但其他应用程序似乎无法解释它们，似乎无法打开。

```
 Intent intent = new Intent();
    intent.setAction(android.content.Intent.ACTION_VIEW);

    Uri uri =  Uri.fromFile(new File( selectedEntry.get(Defs.PATH_KEY)));
    System.out.println("openFileWith: File to open: " + uri);

    intent.setDataAndType(uri,type);
    startActivity(Intent.createChooser(intent, "Open With ...")); 
```

我还尝试在没有太多帮助的情况下使用“file://”+未编码路径。

那么你如何处理这种情况呢？任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:47:27.407

您需要将空格替换为`"\ "`. 请注意，如果您正在使用，`String.replace()`那么您还需要转义斜杠 ( `"\\ "`)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T16:45:28.910

对我来说，主要问题是我将文件存储在内部存储的应用程序目录中，并且必须明确给出对文件的访问权限。我正在使用 chmod 755 命令授予权限。但是带有空格的文件没有正确设置权限，从而阻止了这些文件被打开。

从那以后，我开始使用外部（Activity.getExternalFilesDir（）），并且该文件夹允许对所有其他应用程序的访问权限，这为我解决了这个问题。

# c# - .NET 是否提供了一种将字节转换为 KB、MB、GB 等的简单方法？

> ID：14488796
> 
> 赞同：144
> 
> 时间：2013-01-23T20:29:52.533
> 
> 标签：c#, .net, byte, megabyte

只是想知道 .NET 是否提供了一种干净的方法来做到这一点：

```
int64 x = 1000000;
string y = null;
if (x / 1024 == 0) {
    y = x + " bytes";
}
else if (x / (1024 * 1024) == 0) {
    y = string.Format("{0:n1} KB", x / 1024f);
} 
```

ETC...

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2013-01-23T20:38:59.160

这是一个相当简洁的方法：

```
static readonly string[] SizeSuffixes = 
                   { "bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB" };
static string SizeSuffix(Int64 value, int decimalPlaces = 1)
{
    if (decimalPlaces < 0) { throw new ArgumentOutOfRangeException("decimalPlaces"); }
    if (value < 0) { return "-" + SizeSuffix(-value, decimalPlaces); } 
    if (value == 0) { return string.Format("{0:n" + decimalPlaces + "} bytes", 0); }

    // mag is 0 for bytes, 1 for KB, 2, for MB, etc.
    int mag = (int)Math.Log(value, 1024);

    // 1L << (mag * 10) == 2 ^ (10 * mag) 
    // [i.e. the number of bytes in the unit corresponding to mag]
    decimal adjustedSize = (decimal)value / (1L << (mag * 10));

    // make adjustment when the value is large enough that
    // it would round up to 1000 or more
    if (Math.Round(adjustedSize, decimalPlaces) >= 1000)
    {
        mag += 1;
        adjustedSize /= 1024;
    }

    return string.Format("{0:n" + decimalPlaces + "} {1}", 
        adjustedSize, 
        SizeSuffixes[mag]);
} 
```

这是我建议的原始实现，它可能会稍微慢一些，但更容易理解：

```
static readonly string[] SizeSuffixes = 
                  { "bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB" };

static string SizeSuffix(Int64 value, int decimalPlaces = 1)
{
    if (value < 0) { return "-" + SizeSuffix(-value, decimalPlaces); } 

    int i = 0;
    decimal dValue = (decimal)value;
    while (Math.Round(dValue, decimalPlaces) >= 1000)
    {
        dValue /= 1024;
        i++;
    }

    return string.Format("{0:n" + decimalPlaces + "} {1}", dValue, SizeSuffixes[i]);
}

Console.WriteLine(SizeSuffix(100005000L)); 
```

需要记住的一件事 - 在 SI 表示法中，“kilo”通常使用小写 k，而所有较大的单位都使用大写字母。Windows 使用 KB、MB、GB，所以我在上面使用了 KB，但您可以考虑使用 kB。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2014-03-12T23:58:20.853

签出[ByteSize](https://github.com/omar/ByteSize)库。这是`System.TimeSpan`字节！

它为您处理转换和格式化。

```
var maxFileSize = ByteSize.FromKiloBytes(10);
maxFileSize.Bytes;
maxFileSize.MegaBytes;
maxFileSize.GigaBytes; 
```

它还进行字符串表示和解析。

```
// ToString
ByteSize.FromKiloBytes(1024).ToString(); // 1 MB
ByteSize.FromGigabytes(.5).ToString();   // 512 MB
ByteSize.FromGigabytes(1024).ToString(); // 1 TB

// Parsing
ByteSize.Parse("5b");
ByteSize.Parse("1.55B"); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2014-03-29T16:32:08.267

我会使用`Extension methods`,`Math.Pow`函数和来解决它`Enums`：

```
public static class MyExtension
{
    public enum SizeUnits
    {
        Byte, KB, MB, GB, TB, PB, EB, ZB, YB
    }

    public static string ToSize(this Int64 value, SizeUnits unit)
    {
        return (value / (double)Math.Pow(1024, (Int64)unit)).ToString("0.00");
    }
} 
```

并像这样使用它：

```
string h = x.ToSize(MyExtension.SizeUnits.KB); 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2013-01-23T20:44:05.180

由于其他人都在发布他们的方法，我想我会发布我通常用于此的扩展方法：

编辑：添加了 int/long 变体...并修复了 copypasta 错字...

```
public static class Ext
{
    private const long OneKb = 1024;
    private const long OneMb = OneKb * 1024;
    private const long OneGb = OneMb * 1024;
    private const long OneTb = OneGb * 1024;

    public static string ToPrettySize(this int value, int decimalPlaces = 0)
    {
        return ((long)value).ToPrettySize(decimalPlaces);
    }

    public static string ToPrettySize(this long value, int decimalPlaces = 0)
    {
        var asTb = Math.Round((double)value / OneTb, decimalPlaces);
        var asGb = Math.Round((double)value / OneGb, decimalPlaces);
        var asMb = Math.Round((double)value / OneMb, decimalPlaces);
        var asKb = Math.Round((double)value / OneKb, decimalPlaces);
        string chosenValue = asTb > 1 ? string.Format("{0}Tb",asTb)
            : asGb > 1 ? string.Format("{0}Gb",asGb)
            : asMb > 1 ? string.Format("{0}Mb",asMb)
            : asKb > 1 ? string.Format("{0}Kb",asKb)
            : string.Format("{0}B", Math.Round((double)value, decimalPlaces));
        return chosenValue;
    }
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2020-07-02T14:04:04.553

我知道这已经是旧线程了。但也许有人会寻找解决方案。这就是我使用的最简单的方法

```
public static string FormatFileSize(long bytes)
{
    var unit = 1024;
    if (bytes < unit) { return $"{bytes} B"; }

    var exp = (int)(Math.Log(bytes) / Math.Log(unit));
    return $"{bytes / Math.Pow(unit, exp):F2} {("KMGTPE")[exp - 1]}B";
} 
```

获取文件夹大小（例如用法）

```
public static long GetFolderSize(string path, string ext, bool AllDir)
{
    var option = AllDir ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly;
    return new DirectoryInfo(path).EnumerateFiles("*" + ext, option).Sum(file => file.Length);
} 
```

示例用法：

```
public static void TEST()
{
    string folder = @"C:\Users\User\Videos";

    var bytes = GetFolderSize(folder, "mp4", true); //or GetFolderSize(folder, "mp4", false) to get all single folder only
    var totalFileSize = FormatFileSize(bytes);
    Console.WriteLine(totalFileSize);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-12-28T13:39:59.277

投票最多的答案的简短版本存在 TB 值问题。

我对它进行了适当的调整以处理 tb 值并且仍然没有循环，并且还添加了一些对负值的错误检查。这是我的解决方案：

```
static readonly string[] SizeSuffixes = { "bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB" };
static string SizeSuffix(long value, int decimalPlaces = 0)
{
    if (value < 0)
    {
        throw new ArgumentException("Bytes should not be negative", "value");
    }
    var mag = (int)Math.Max(0, Math.Log(value, 1024));
    var adjustedSize = Math.Round(value / Math.Pow(1024, mag), decimalPlaces);
    return String.Format("{0} {1}", adjustedSize, SizeSuffixes[mag]);
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-01-23T20:33:39.617

不。主要是因为它是一个相当小众的需求，并且有太多可能的变化。（是“KB”、“Kb”还是“Ko”？一兆字节是 1024 * 1024 字节，还是 1024 * 1000 字节？——是的，有些地方使用它！）

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-01-23T20:35:02.407

这是一个比您的更容易扩展的选项，但是不，库本身没有内置任何选项。

```
private static List<string> suffixes = new List<string> { " B", " KB", " MB", " GB", " TB", " PB" };
public static string Foo(int number)
{
    for (int i = 0; i < suffixes.Count; i++)
    {
        int temp = number / (int)Math.Pow(1024, i + 1);
        if (temp == 0)
            return (number / (int)Math.Pow(1024, i)) + suffixes[i];
    }
    return number.ToString();
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-01-26T18:44:01.473

[@Servy 的回答](https://stackoverflow.com/a/14488873/1037948)简洁明了。我认为它可以更简单？

```
private static string[] suffixes = new [] { " B", " KB", " MB", " GB", " TB", " PB" };

public static string ToSize(double number, int precision = 2)
{
    // unit's number of bytes
    const double unit = 1024;
    // suffix counter
    int i = 0;
    // as long as we're bigger than a unit, keep going
    while(number > unit)
    {
        number /= unit;
        i++;
    }
    // apply precision and current suffix
    return Math.Round(number, precision) + suffixes[i];
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-08-06T06:59:50.253

```
 private string GetFileSize(double byteCount)
    {
        string size = "0 Bytes";
        if (byteCount >= 1073741824.0)
            size = String.Format("{0:##.##}", byteCount / 1073741824.0) + " GB";
        else if (byteCount >= 1048576.0)
            size = String.Format("{0:##.##}", byteCount / 1048576.0) + " MB";
        else if (byteCount >= 1024.0)
            size = String.Format("{0:##.##}", byteCount / 1024.0) + " KB";
        else if (byteCount > 0 && byteCount < 1024.0)
            size = byteCount.ToString() + " Bytes";

        return size;
    }

    private void btnBrowse_Click(object sender, EventArgs e)
    {
        if (openFile1.ShowDialog() == DialogResult.OK)
        {
            FileInfo thisFile = new FileInfo(openFile1.FileName);

            string info = "";

            info += "File: " + Path.GetFileName(openFile1.FileName);
            info += Environment.NewLine;
            info += "File Size: " + GetFileSize((int)thisFile.Length);

            label1.Text = info;
        }
    } 
```

这也是一种方法（数字 1073741824.0 来自 1024*1024*1024 aka GB）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-02-09T14:06:37.103

基于 NeverHopeless 的优雅解决方案：

```
private static readonly KeyValuePair<long, string>[] Thresholds = 
{
    // new KeyValuePair<long, string>(0, " Bytes"), // Don't devide by Zero!
    new KeyValuePair<long, string>(1, " Byte"),
    new KeyValuePair<long, string>(2, " Bytes"),
    new KeyValuePair<long, string>(1024, " KB"),
    new KeyValuePair<long, string>(1048576, " MB"), // Note: 1024 ^ 2 = 1026 (xor operator)
    new KeyValuePair<long, string>(1073741824, " GB"),
    new KeyValuePair<long, string>(1099511627776, " TB"),
    new KeyValuePair<long, string>(1125899906842620, " PB"),
    new KeyValuePair<long, string>(1152921504606850000, " EB"),

    // These don't fit into a int64
    // new KeyValuePair<long, string>(1180591620717410000000, " ZB"), 
    // new KeyValuePair<long, string>(1208925819614630000000000, " YB") 
};

/// <summary>
/// Returns x Bytes, kB, Mb, etc... 
/// </summary>
public static string ToByteSize(this long value)
{
    if (value == 0) return "0 Bytes"; // zero is plural
    for (int t = Thresholds.Length - 1; t > 0; t--)
        if (value >= Thresholds[t].Key) return ((double)value / Thresholds[t].Key).ToString("0.00") + Thresholds[t].Value;
    return "-" + ToByteSize(-value); // negative bytes (common case optimised to the end of this routine)
} 
```

也许有过多的评论，但我倾向于留下它们以防止自己在以后的访问中犯同样的错误......

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-01-23T20:34:59.043

不。

但是你可以这样实现；

```
 static double ConvertBytesToMegabytes(long bytes)
    {
    return (bytes / 1024f) / 1024f;
    }

    static double ConvertKilobytesToMegabytes(long kilobytes)
    {
    return kilobytes / 1024f;
    } 
```

另请查看[如何正确地将文件大小以字节为单位转换为兆字节或千兆字节？](https://stackoverflow.com/questions/565704/how-to-correctly-convert-filesize-in-bytes-into-mega-or-gigabytes)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-06-12T04:38:25.767

针对 C# 9.0[关系模式进行了更新](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/patterns#relational-patterns)

```
public const long OneKB = 1024;

public const long OneMB = OneKB * OneKB;

public const long OneGB = OneMB * OneKB;

public const long OneTB = OneGB * OneKB;

public static string BytesToHumanReadable(ulong bytes)
{
    return bytes switch
    {
        (< OneKB) => $"{bytes}B",
        (>= OneKB) and (< OneMB) => $"{bytes / OneKB}KB",
        (>= OneMB) and (< OneGB) => $"{bytes / OneMB}MB",
        (>= OneGB) and (< OneTB) => $"{bytes / OneMB}GB",
        (>= OneTB) => $"{bytes / OneTB}"
        //...
    };
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-10-30T05:24:25.533

我将这里的一些答案组合成两种效果很好的方法。下面的第二种方法将从字节字符串（如 1.5.1 GB）转换回作为长类型值的字节（如 1621350140）。我希望这对寻找将字节转换为字符串并返回字节的解决方案的其他人有用。

```
public static string BytesAsString(float bytes)
{
    string[] suffix = { "B", "KB", "MB", "GB", "TB" };
    int i;
    double doubleBytes = 0;

    for (i = 0; (int)(bytes / 1024) > 0; i++, bytes /= 1024)
    {
        doubleBytes = bytes / 1024.0;
    }

    return string.Format("{0:0.00} {1}", doubleBytes, suffix[i]);
}

public static long StringAsBytes(string bytesString)
{
    if (string.IsNullOrEmpty(bytesString))
    {
        return 0;
    }

    const long OneKb = 1024;
    const long OneMb = OneKb * 1024;
    const long OneGb = OneMb * 1024;
    const long OneTb = OneGb * 1024;
    double returnValue;
    string suffix = string.Empty;

    if (bytesString.IndexOf(" ") > 0)
    {
        returnValue = float.Parse(bytesString.Substring(0, bytesString.IndexOf(" ")));
        suffix = bytesString.Substring(bytesString.IndexOf(" ") + 1).ToUpperInvariant();
    }
    else
    {
        returnValue = float.Parse(bytesString.Substring(0, bytesString.Length - 2));
        suffix = bytesString.ToUpperInvariant().Substring(bytesString.Length - 2);
    }

    switch (suffix)
    {
        case "KB":
            {
                returnValue *= OneKb;
                break;
            }

        case "MB":
            {
                returnValue *= OneMb;
                break;
            }

        case "GB":
            {
                returnValue *= OneGb;
                break;
            }

        case "TB":
            {
                returnValue *= OneTb;
                break;
            }

        default:
            {
                break;
            }
    }

    return Convert.ToInt64(returnValue);
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-11-13T10:26:11.050

我选择了 JerKimballs 解决方案，并对此表示赞同。但是，我想补充/指出，这确实是一个整体上存在争议的问题。在我的研究中（出于其他原因），我提出了以下信息。

当普通人（我听说他们存在）谈到千兆字节时，他们指的是公制系统，其中原始字节数的 1000 的 3 次方 == 千兆字节数。但是，当然有 IEC / JEDEC 标准，它在维基百科中得到了很好的总结，而不是 1000 的 x 次方，它们有 1024。对于物理存储设备（我猜逻辑如亚马逊和其他）意味着公制与 IEC 之间的差异越来越大。因此，例如 1 TB == 1 TB 公制是 1000 的 4 次方，但 IEC 官方将类似的数字称为 1 TiB，tebibyte 为 1024 的 4 次方。但是，唉，在非技术应用中（我会由观众决定）标准是公制的，目前在我自己的内部使用应用程序中，我解释了文档中的差异。但出于显示目的，我什至只提供公制。在内部，即使它在我的应用程序中不相关，我也只存储字节并进行显示计算。

作为旁注，我发现 .Net 框架 AFAIK（我经常错了，感谢强大的力量）即使在它的 4.5 化身中，在内部的任何库中都没有包含任何关于此的内容，这有点乏味。人们会期望某种开源库在某个时候成为 NuGettable，但我承认这是一个小问题。另一方面 System.IO.DriveInfo 和其他也只有字节（只要），这是相当清楚的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-10-18T08:07:26.130

一些递归怎么样：

```
private static string ReturnSize(double size, string sizeLabel)
{
  if (size > 1024)
  {
    if (sizeLabel.Length == 0)
      return ReturnSize(size / 1024, "KB");
    else if (sizeLabel == "KB")
      return ReturnSize(size / 1024, "MB");
    else if (sizeLabel == "MB")
      return ReturnSize(size / 1024, "GB");
    else if (sizeLabel == "GB")
      return ReturnSize(size / 1024, "TB");
    else
      return ReturnSize(size / 1024, "PB");
  }
  else
  {
    if (sizeLabel.Length > 0)
      return string.Concat(size.ToString("0.00"), sizeLabel);
    else
      return string.Concat(size.ToString("0.00"), "Bytes");
  }
} 
```

然后你可以调用它：

```
ReturnSize(size, string.Empty); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-08-29T16:01:44.310

我最近需要这个并且需要将字节转换为长整数。

用法：`Byte.Kb.ToLong(1)`应该给1024。

```
public enum Byte
{
    Kb,
    Mb,
    Gb,
    Tb
}

public static class ByteSize
{
    private const long OneKb = 1024;
    private const long OneMb = OneKb * 1024;
    private const long OneGb = OneMb * 1024;
    private const long OneTb = OneGb * 1024;

    public static long ToLong(this Byte size, int value)
    {
        return size switch
        {
            Byte.Kb => value * OneKb,
            Byte.Mb => value * OneMb,
            Byte.Gb => value * OneGb,
            Byte.Tb => value * OneTb,
            _ => throw new NotImplementedException("This should never be hit.")
        };
    }
} 
```

* * *

使用 xunit 进行测试：

```
[Theory]
[InlineData(Byte.Kb, 1, 1024)]
[InlineData(Byte.Kb, 2, 2048)]
[InlineData(Byte.Mb, 1, 1048576)]
[InlineData(Byte.Mb, 2, 2097152)]
[InlineData(Byte.Gb, 1, 1073741824)]
[InlineData(Byte.Gb, 2, 2147483648)]
[InlineData(Byte.Tb, 1, 1099511627776)]
[InlineData(Byte.Tb, 2, 2199023255552)]
public void ToLong_WhenConverting_ShouldMatchExpected(Byte size, int value, long expected)
{
    var result = size.ToLong(value);

    result.Should().Be(expected);
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-03-29T15:56:21.073

怎么样：

```
public void printMB(uint sizekB)   
{
    double sizeMB = (double) sizekB / 1024;
    Console.WriteLine("Size is " + sizeMB.ToString("0.00") + "MB");
} 
```

例如调用喜欢

```
printMB(123456); 
```

将导致输出

```
"Size is 120,56 MB" 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-12-12T17:50:12.607

[https://github.com/logary/logary/blob/master/src/Logary/DataModel.fs#L832-L837](https://github.com/logary/logary/blob/master/src/Logary/DataModel.fs#L832-L837)

```
let scaleBytes (value : float) : float * string =
    let log2 x = log x / log 2.
    let prefixes = [| ""; "Ki"; "Mi"; "Gi"; "Ti"; "Pi" |] // note the capital K and the 'i'
    let index = int (log2 value) / 10
    1\. / 2.**(float index * 10.),
sprintf "%s%s" prefixes.[index] (Units.symbol Bytes) 
```

（免责声明：我写了这段代码，甚至是链接中的代码！）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-10-12T03:05:21.073

```
public static class MyExtension
{
    public static string ToPrettySize(this float Size)
    {
        return ConvertToPrettySize(Size, 0);
    }
    public static string ToPrettySize(this int Size)
    {
        return ConvertToPrettySize(Size, 0);
    }
    private static string ConvertToPrettySize(float Size, int R)
    {
        float F = Size / 1024f;
        if (F < 1)
        {
            switch (R)
            {
                case 0:
                    return string.Format("{0:0.00} byte", Size);
                case 1:
                    return string.Format("{0:0.00} kb", Size);
                case 2:
                    return string.Format("{0:0.00} mb", Size);
                case 3:
                    return string.Format("{0:0.00} gb", Size);
            }
        }
        return ConvertToPrettySize(F, ++R);
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-12-15T15:19:20.503

如上所述，在对数的帮助下，递归是最喜欢的方式。

以下函数有 3 个参数：输入、输出的维度约束，即第三个参数。

```
int ByteReDim(unsigned long ival, int constraint, unsigned long *oval)
{
    int base = 1 + (int) log10(ival);

    (*oval) = ival;
    if (base > constraint) {
        (*oval) = (*oval) >> 10;
        return(1 + ByteReDim((*oval), constraint, oval));
    } else
        return(0);
} 
```

现在让我们将 12GB 的 RAM 转换为几个单位：

```
int main(void)
{
    unsigned long RAM;
    int unit; // index of below symbols array
    char symbol[5] = {'B', 'K', 'M', 'G', 'T'};

    unit = ByteReDim(12884901888, 12, &RAM);
    printf("%lu%c\n", RAM, symbol[unit]); // output is 12884901888B

    unit = ByteReDim(12884901888, 9, &RAM);
    printf("%lu%c\n", RAM, symbol[unit]); // output is 12582912K

    unit = ByteReDim(12884901888, 6, &RAM);
    printf("%lu%c\n", RAM, symbol[unit]); // output is 12288M

    unit = ByteReDim(12884901888, 3, &RAM);
    printf("%lu%c\n", RAM, symbol[unit]); // output is 12G
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-06-12T08:52:36.370

我将它用于 Windows（二进制前缀）：

```
static readonly string[] BinaryPrefix = { "bytes", "KB", "MB", "GB", "TB" }; // , "PB", "EB", "ZB", "YB"
string GetMemoryString(double bytes)
{
    int counter = 0;
    double value = bytes;
    string text = "";
    do
    {
        text = value.ToString("0.0") + " " + BinaryPrefix[counter];
        value /= 1024;
        counter++;
    }
    while (Math.Floor(value) > 0 && counter < BinaryPrefix.Length);
    return text;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-11-18T16:59:26.997

我已将此（几乎没有修改）合并到我的项目的 UWP DataBinding 转换器中，并认为它对其他人也可能有用。

代码是：

```
using System;
using System.Text;
using Windows.UI.Xaml.Data;

namespace MyApp.Converters
{
    public class ByteSizeConverter : IValueConverter
    {
        static readonly string[] sSizeSuffixes = { "bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB" };

        // The number of decimal places the formatter should include in the scaled output - default 1dp
        public int DecimalPlaces { get; set; } = 1;

        public object Convert(object value, Type targetType, object parameter, string language)
        {
            Int64 intVal = System.Convert.ToInt64(value);

            return SizeSuffix(intVal);
        }

        public object ConvertBack(object value, Type targetType, object parameter, string language)
        {
            // TODO: Parse string into number and suffix
            //       Scale number by suffix multiplier to get bytes
            throw new NotImplementedException();
        }

        string SizeSuffix(Int64 value)
        {
            if (this.DecimalPlaces < 0) { throw new ArgumentOutOfRangeException(String.Format("DecimalPlaces = {0}", this.DecimalPlaces)); }
            if (value < 0) { return "-" + SizeSuffix(-value); }
            if (value == 0) { return string.Format("{0:n" + this.DecimalPlaces + "} bytes", 0); }

            // magnitude is 0 for bytes, 1 for KB, 2, for MB, etc.
            int magnitude = (int)Math.Log(value, 1024);
            // clip magnitude - only 8 values currently supported, this prevents out-of-bounds exception
            magnitude = Math.Min(magnitude, 8);

            // 1L << (magnitude * 10) == 2 ^ (10 * magnitude) [i.e. the number of bytes in the unit corresponding to magnitude]
            decimal adjustedSize = (decimal)value / (1L << (magnitude * 10));

            // make adjustment when the value is large enough that it would round up to 1000 or more
            if (Math.Round(adjustedSize, this.DecimalPlaces) >= 1000)
            {
                magnitude += 1;
                adjustedSize /= 1024;
            }

            return String.Format("{0:n" + this.DecimalPlaces + "} {1}", adjustedSize, sSizeSuffixes[magnitude]);
        }
    }
} 
```

要使用它，请将本地资源添加到您的 UserControl 或 Page XAML：

```
<UserControl.Resources>
    <converters:ByteSizeConverter x:Key="ByteFormat" DecimalPlaces="3" />
</UserControl.Resources> 
```

在数据绑定模板或数据绑定实例中引用它：

```
<TextBlock HorizontalAlignment="Left" VerticalAlignment="Center"
    Text="{x:Bind MyItem.FileSize_bytes, Mode=OneWay, Converter={StaticResource ByteFormat}}" /> 
```

嘿，很快。奇迹发生了。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-08-25T23:37:40.893

这是我对@drzaus 答案的看法。我对其进行了修改，以利用舍入误差来发挥我们的优势，并正确管理单元边界周围的问题。它还处理负值。

将其`C# Program`放入 LinqPad：

```
// Kudos: https://stackoverflow.com/a/48467634/117797

void Main()
{
    0.ToFriendly().Dump();                      // 0 B
    857.ToFriendly().Dump();                    // 857 B
    (173*1024).ToFriendly().Dump();             // 173 KB
    (9541*1024).ToFriendly().Dump();            // 9.32 MB
    (5261890L*1024).ToFriendly().Dump();        // 5.02 GB

    1.ToFriendly().Dump();                      // 1 B
    1024.ToFriendly().Dump();                   // 1 KB
    1048576.ToFriendly().Dump();                // 1 MB
    1073741824.ToFriendly().Dump();             // 1 GB
    1099511627776.ToFriendly().Dump();          // 1 TB
    1125899906842620.ToFriendly().Dump();       // 1 PB
    1152921504606850000.ToFriendly().Dump();    // 1 EB
}

public static class Extensions
{
    static string[] _byteUnits = new[] { "B", "KB", "MB", "GB", "TB", "PB", "EB" };

    public static string ToFriendly(this int number, int decimals = 2)
    {
        return ((double)number).ToFriendly(decimals);
    }

    public static string ToFriendly(this long number, int decimals = 2)
    {
        return ((double)number).ToFriendly(decimals);
    }

    public static string ToFriendly(this double number, int decimals = 2)
    {
        const double divisor = 1024;

        int unitIndex = 0;
        var sign = number < 0 ? "-" : string.Empty;
        var value = Math.Abs(number);
        double lastValue = number;

        while (value > 1)
        {
            lastValue = value;

            // NOTE
            // The following introduces ever increasing rounding errors, but at these scales we don't care.
            // It also means we don't have to deal with problematic rounding errors due to dividing doubles.
            value = Math.Round(value / divisor, decimals);

            unitIndex++;
        }

        if (value < 1 && number != 0)
        {
            value = lastValue;
            unitIndex--;
        }

        return $"{sign}{value} {_byteUnits[unitIndex]}";
    }
} 
```

输出是：

```
0 B
857 B
173 KB
9.32 MB
1.34 MB
5.02 GB
1 B
1 KB
1 MB
1 GB
1 TB
1 PB
1 EB 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-03-22T09:12:31.707

```
string Convert(float bytes)
{
    string[] Group = { "Bytes", "KB", "MB", "GB", "TB"};
    float B = bytes; int G = 0;
    while (B >= 1024 && G < 5)
    {
        B /= 1024;
        G += 1;
    }
    float truncated = (float)(Math.Truncate((double)B * 100.0) / 100.0);
    string load = (truncated + " " + Group[G]);

    return load;
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-10-08T06:21:51.183

我就是这样做的。

```
Console.Write(FileSizeInBytes > 1048576 ? FileSizeInBytes / 1048576f + " MB" : FileSizeInBytes / 1024f + " KB"); //1048576 = 1024 * 1024 
```

# ios5 - 这种 ios 演示风格叫什么？

> ID：14488799
> 
> 赞同：0
> 
> 时间：2013-01-23T20:30:03.573
> 
> 标签：ios5, uialertview, modalviewcontroller

当您在 iPhone 上使用邮件应用程序并单击小标志图标时，它会从屏幕底部显示一个对话框，上面写着：标志、标记为已读和取消。这种演示风格叫什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:36:32.010

`UIActionSheet`（[类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIActionSheet_Class/Reference/Reference.html)）

# php - 我正确使用 MATCH() 吗？

> ID：14488800
> 
> 赞同：1
> 
> 时间：2013-01-23T20:30:05.557
> 
> 标签：php, mysql, sql

我有这个 SQL 查询，它一直给我一个错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 4 行的“OR `description`IN BOOLEAN MODE) ORDER BY `datetime`ASC LIMIT 0,20”附近使用正确的语法

这是我试图运行的查询：

```
$items = $itemsClass->getAll($start , $limit, " `status` = 'active' AND MATCH (".sql_quote($s).") AGAINST (`name` OR `description` IN BOOLEAN MODE) ".$whereQuery, "$order"); 
```

原因：我正在开发一个网站的搜索功能，当我们搜索某个关键字（即蛋糕）时，它会显示相关项目。但是，当我们搜索与蛋糕项目在相同标题/描述中的“cook”时，它不会产生任何结果并说它是空的。

我似乎无法弄清楚为什么我在查询中收到此错误。我只是想找到解决我问题的方法。我正在使用 MySQL 5.1.66。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:39:52.910

首先，您将列名放入`MATCH()`函数中，并将模式放入`AGAINST()`函数中。你做错了。

其次，跨多个列的搜索是隐含的“或”比较，因为*任何*索引列中的关键字匹配都算作匹配。

所以你应该使用：

```
... MATCH (`name`, `description`) AGAINST (".sql_quote($s).") IN BOOLEAN MODE)" 
```

您在函数中命名的列`MATCH()`必须是您在全文索引中定义的所有列，并且与它们在索引中出现的顺序相同。

仅当您定义了两个*单独*的全文索引，每列一个，那么您需要使用两个单独的谓词。

```
... MATCH (`name`) AGAINST (".sql_quote($s).") IN BOOLEAN MODE)
    OR 
    MATCH (`description`) AGAINST (".sql_quote($s).") IN BOOLEAN MODE)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:34:04.860

你写了：

```
MATCH ("your string") AGAINST (`name` OR `description` IN BOOLEAN MODE) 
```

但是， （与其他运算符一样）以这种方式`AGAINST`不具有[关联性。](http://en.wikipedia.org/wiki/Associative_property)它所采用的表达方式就是——一个表达方式；诸如此类的连接词的使用`OR`并未展开以应用于更广泛的操作，而仅用于评估最终表达式。

因此，通常，您必须将连接`OR` *放在*操作员调用之外：

```
MATCH ("your string") AGAINST `name` IN BOOLEAN MODE
 OR
MATCH ("your string") AGAINST `description` IN BOOLEAN MODE 
```

但是，在这种情况下，您还将[操作数切换为`MATCH`](http://dev.mysql.com/doc/refman/5.5/en//fulltext-search.html#function_match).

写：

```
MATCH (`name`) AGAINST "your string" IN BOOLEAN MODE
 OR
MATCH (`description`) AGAINST "your string" IN BOOLEAN MODE 
```

碰巧它`MATCH`本质上支持搜索多个列。

* * *

所以，最后：

```
MATCH (`name`, `description`) AGAINST "your string" IN BOOLEAN MODE 
```

*这个故事的寓意是文档是你的朋友。*

# ruby-on-rails - 您如何访问存储在 tmp 目录中的文件？

> ID：14488810
> 
> 赞同：1
> 
> 时间：2013-01-23T20:30:52.920
> 
> 标签：ruby-on-rails

我正在使用 CarrierWave 将图像上传到我的网页。目前，我正在使用 Amazon S3 和 Heroku。但是，我希望能够在我的机器上使用 localhost 对其进行测试。同样，我有这个工作。但是，我将上传的照片存储在我的应用程序 tmp 目录中：

`Users/.../app/tmp/uploads`.

尝试显示图像时，我得到一个断开的链接。我一直在使用：

`<img src='<%= bucket.path %>'/>`

显示图像，它一直在 Heroku 上工作。在本地主机上，我收到此错误：

`ActionController::RoutingError (No route matches [GET] "/Users/.../app/tmp/uploads/pic.jpeg")`

我不确定该怎么做，我认为提供路径就足够了。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:44:26.223

你在用雾吗？此回复假设您是。

在 /config/environments/development.rb 你应该能够设置以下内容：

```
config.uploadsURL = "http//localhost:3000"
config.serve_static_assets = true 
```

在 /config/initializers/carrierwave.rb 中：

```
if Rails.env.production?
    # your aws config stuff
else
    config.storage   = :file
end 
```

在一个视图中（除非我忘记了什么）你应该能够：

```
<%= image_tag(image.imgUpload.mini) if image.imgUpload? %> 
```

其中“mini”是载波版本，imgUpload 是您在模型中定义的安装：

```
mount_uploader :imgUpload, ImageUploader 
```

当然，您应该能够在 localhost 上对其进行测试，同时还可以使用 AWS 存储。将 /config/environments/development.rb 从以下位置更改可能更简单：

```
config.action_controller.asset_host = "//#{ENV['FOG_DIRECTORY']}.s3.amazonaws.com" 
```

至

```
config.action_controller.asset_host = "//your-test-bucket.s3.amazonaws.com" 
```

并在本地主机上运行时继续使用 AWS。

# ruby-on-rails - Devise gem 使用什么算法来生成身份验证令牌？

> ID：14488812
> 
> 赞同：3
> 
> 时间：2013-01-23T20:31:11.343
> 
> 标签：ruby-on-rails, authentication, encryption, devise

我有一个使用 Devise 身份验证令牌机制进行客户端令牌身份验证的应用程序。我想知道 gem 使用什么算法来生成令牌本身？是 BCrypt 吗？MD5等等等等...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T21:12:25.017

代码在`devise.rb`：

```
# Generate a friendly string randomically to be used as token.
def self.friendly_token
  SecureRandom.base64(15).tr('+/=lIO0', 'pqrsxyz')
end 
```

[http://rdoc.info/github/plataformatec/devise/Devise.friendly_token](http://rdoc.info/github/plataformatec/devise/Devise.friendly_token)

# c# - 将包含公式的循环中的每个答案添加到 C# 中的列表中

> ID：14488813
> 
> 赞同：-2
> 
> 时间：2013-01-23T20:31:12.533
> 
> 标签：c#, list, loops, nullreferenceexception

我有一个计算数字的公式，然后我需要它取每个数字的倍数并将它们存储到有序列表中，达到 300 所需的数字。我相信 for 循环不是最好的方法来做到这一点，但这是我得到的。

```
public List<double> axialLengthFt(double length)
    {
       fundamental = (1130 / 2) / length;

       for (int i = 1; i < 15; i++)
       {    
           double d = fundamental * i;
           if (d <= 300)
              modes.Add(d); //NullReferenceException here??
           else
               break;              
       }
        return modes;
    } 
```

我不知道为什么我会收到 NullReferenceException，请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:35:09.170

您永远不会声明变量模式。

```
List<double> modes = new List<double>(); 
```

# oauth - Restlet 上的 OAuth2.0“无流量”服务器

> ID：14488815
> 
> 赞同：0
> 
> 时间：2013-01-23T20:31:16.870
> 
> 标签：oauth, restlet

男人，真是一场噩梦！

任何人都可以向我指出如何在 Restlet（2.2 或 2.1.1）上实现 OAuth2.0 服务器的任何类型的适当教程或示例的方向。我设法找到的唯一类似于教程的就是[这里](http://web.archive.org/liveweb/http://web.archive.org/web/20120204015421/http://wiki.restlet.org/docs_2.1/13-restlet/28-restlet/392-restlet.html)的这个，但现在不要太兴奋，因为框架中的代码似乎比本教程的更新更频繁。

除了上述文章之外，Google 上似乎几乎完全没有任何有用的搜索结果。肯定有人在那里做对了，并且在 Restlet 上使用了 OAuth2.0 吗？

事实上，我确实设法让我的 OAuth2.0 服务器向我返回访问令牌（在花费数小时分析*AccessTokenResource.java*文件的源代码之后），但它似乎只是验证*客户端 ID*和不是*客户机密*。假设我可以解决这个问题，我仍然面临着实际保护资源的任务（这应该是*OAuthAuthorizer*的工作，但在 2.1.1 之后似乎不再存在）。

任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T09:09:25.443

此扩展正在进行中。请注意，OAuth 2.0 是最近才完成的。

我们目前正在将 2.2 分支更新为最新的草案 (31)。代码已更新，文档确实需要遵循。

2.2 仍在开发中，尚未准备好投入生产。目前，我们正在寻找测试人员和贡献者（代码和文档）。

在 2.2 中 OAuthAuthorizer 已被拆分。

有关更多详细信息，请参阅此问题： [https ://github.com/restlet/restlet-framework-java/pull/644](https://github.com/restlet/restlet-framework-java/pull/644)

# iphone - 具有自定义值的 App Store URL

> ID：14488818
> 
> 赞同：0
> 
> 时间：2013-01-23T20:31:22.017
> 
> 标签：iphone, app-store, referrals

我在我所在城市的大约 100 个不同地方发布了我的应用程序。我想为这 100 个地方中的每一个地方创建一个不同的 QR 码，因此，我想知道每个地方都有多少下载。

例如（使用愤怒的小鸟应用程序）：

*   itunes.apple.com/es/app/angry-birds/id343200656?place=1
*   itunes.apple.com/es/app/angry-birds/id343200656?place=2
*   itunes.apple.com/es/app/angry-birds/id343200656?place=3
*   ...

安装应用程序后，我知道“地点 1”又下载了一个。

我知道这可以在 Android 中完成……但我还没有为 Apple 找到任何东西。

谢谢

# c# - 编译器错误 1：构造函数包含超过 0 个 args

> ID：14488832
> 
> 赞同：0
> 
> 时间：2013-01-23T20:32:13.080
> 
> 标签：c#, visual-studio-2010, compiler-errors, xna-4.0

我是 C、C#、XNA 的初学者，我正在尝试在线学习一些教程，但是当我尝试从不同的类创建一个 paddle 对象时，我得到构造函数不包含 0 个参数的错误。我不知道错误是在我的游戏课还是我的桨课。

我的游戏类中的重要代码：

```
Paddle paddle; // creates a paddle
...
public Game1()
{
    graphics = new GraphicsDeviceManager(this);
    Content.RootDirectory = "Content";

    screenRectangle = new Rectangle(
        0,
        0,
        graphics.PreferredBackBufferWidth,
        graphics.PreferredBackBufferHeight);
}
...
protected override void LoadContent()
{
    // Create a new SpriteBatch, which can be used to draw textures.
    spriteBatch = new SpriteBatch(GraphicsDevice);

    Texture2D tempTexture = Content.Load<Texture2D>("paddle");
    paddle = new Paddle(tempTexture, screenRectangle);
} 
```

这是我桨班的开始

```
public class Paddle : Microsoft.Xna.Framework.GameComponent
{
    Vector2 position;
    Vector2 motion;
    float paddleSpeed = 8f;

    KeyboardState keyboardState;
    GamePadState gamePadState;

    Texture2D texture;
    Rectangle screenBounds;

    public Paddle(Texture2D texture, Rectangle screenBounds)
    {
        this.texture = texture;
        this.screenBounds = screenBounds;
        SetInStartPosition();
    } 
```

[我正在学习http://xnagpa.net/xna4/beginnertuts/BreakingOut1.pdf](http://xnagpa.net/xna4/beginnertuts/BreakingOut1.pdf)上的教程

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:43:20.873

你说的某个地方`paddle = new Paddle();`

# input - Windows 8 IE 10 手写插入输入浏览器事件

> ID：14488833
> 
> 赞同：1
> 
> 时间：2013-01-23T20:32:19.877
> 
> 标签：input, windows-8, internet-explorer-10

我编写了一个应用程序，它在文本输入上使用按键来触发激活和停用按钮。我的一位用户正在使用 Windows 8 平板电脑上的手写功能来输入文本。他将文本写入其中，然后点击“插入”按钮。文本被插入，但不会触发 keypress 事件。它也不会触发 onchange 或 onpaste 事件。

有谁知道是否有可以捕获的事件允许我验证表单元素？我可以在其上放置一个 onchange 事件，然后单击开箱即用，这将触发验证，但这并不直观。

这是我为 change 事件尝试的 JQuery 代码，但我愿意使用 run of the mill JS 来完成工作。

```
 var lastTerms ="";
    $("input#searchbox").change(function()
    {
    var acTerm = $("#searchbox").val(); 
        if (acTerm.length>2)
        {
           if (isDisabled($("#btnSearch")))
            {
                $("#btnSearch").removeClass("buttonDisabled");
                $("#btnSaveSearch").removeClass("buttonDisabled");
            }
        }
        else
        {
                            if (!isDisabled($("#btnSearch")))
            {
                $("#btnSearch").addClass("buttonDisabled");
                //$("#btnSaveSearch").addClass("buttonDisabled");
            }
        }
    }); 
```

# ruby - 通过 cron 执行 ruby gem

> ID：14488835
> 
> 赞同：3
> 
> 时间：2013-01-23T20:32:26.100
> 
> 标签：ruby, path, gem, cron-task

我试图在这里解决一些谜团......我们创建了一个通过 cron 调用的 gem。

谜团是：这适用于机器`A`但不适用于机器`B`，据我所知，环境是相同的。

两台机器都是 Mac OS X 10.6。

我也了解 cron 在简约的环境中运行。

crontab：

```
10 2 * * * /Users/michael/.rvm/gems/ruby-1.9.3-p194/bin/my_gem 
```

机器上的错误`B`是：

```
/Users/michael/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find my_gem-toolchain (>= 0) amongst [bigdecimal-1.1.0, io-console-0.3, json-1.5.4, minitest-2.5.1, rake-0.9.2.2, rdoc-3.9.4] (Gem::LoadError)
    from /Users/michael/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
    from /Users/michael/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem'
    from /Users/michael/.rvm/gems/ruby-1.9.3-p194/bin/my_gem:22:in `<main>' 
```

这里是内容`/Users/michael/.rvm/gems/ruby-1.9.3-p194/bin/my_gem`

```
#!/Users/michael/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
#
# This file was generated by RubyGems.
#
# The application 'my_gem-toolchain' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require 'rubygems'

version = ">= 0"

if ARGV.first
  str = ARGV.first
  str = str.dup.force_encoding("BINARY") if str.respond_to? :force_encoding
  if str =~ /\A_(.*)_\z/
    version = $1
    ARGV.shift
  end
end

gem 'my_gem-toolchain', version
load Gem.bin_path('my_gem-toolchain', 'my_gem', version) 
```

第 22 行是：`gem 'my_gem-toolchain', version`

这是`env`在两台机器上通过 cron 运行的输出：

```
SHELL=/bin/sh
USER=michael
PATH=/usr/bin:/bin
PWD=/Users/michael
SHLVL=1
HOME=/Users/michael
LOGNAME=michael
_=/usr/bin/env 
```

我相信这与`GEM_PATH`未设置有关。但是，在机器`A`上`GEM_PATH`似乎没有设置，但一切正常。

我想更好地了解红宝石的工作原理。显然我仍然缺少一些东西。

为什么这可以在机器上工作，`A`但不能在机器上工作`B`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:29:14.467

RVM 是开发人员维护其环境的绝佳工具，但在生产环境中却是一场噩梦。一旦你从 cron 执行任务，为了维护执行环境，你本质上是“在生产中”，即使它恰好是你的开发机器上的 cron。

我建议您在系统范围内安装 gem 并从脚本运行它，该脚本不假设它的安装位置。确保您遵循创建 gem 的所有最佳实践，以便正确安装 gem 的依赖项并正确处理二进制文件等。一旦您构建了 gem，您应该通过系统 Ruby 安装它，以便它可以用于操作系统的 Ruby 解释器的默认位置中的所有用户，以及它的所有依赖项都已安装。

查看 Rubygems 的[Make your own gem 指南](http://guides.rubygems.org/make-your-own-gem/)以获得最佳实践。

然后使用系统 ruby​​ 安装生成的 gem 文件，而不是安装到您的 RVM 目录中：

```
rvm use system
gem install my-gem-1.0.0.gem 
```

这应该得到所有设置，以便它可以从 cron 和任何用户愉快地运行。您可能不想在您的主目录中运行依赖于 RVM 的 cron 作业。

为了具体解决您的问题，它可能适用于 A 但不适用于 B 的原因有很多。如果您在一台机器上安装 gem 系统范围并通过 RVM 在另一台机器上安装，这将影响安装依赖项的位置（系统-wide vs. 在您的主目录中）；如果您甚至在另一台机器上都没有 RVM，那肯定是这种情况。可能是您的 Gem 没有正确声明其依赖项，因此当您将其安装在机器 B 上时，依赖项并未安装在那里，而是您在开发过程中手动将它们安装在机器 A 上。可能是您在两者上都安装了相同的 gem，并且主目录是共享的，并且其他所有内容似乎都是重复的，但是您的 shell 配置中的 RVM 魔法并没有在两者上执行。可能是不同的用户，因此不同的环境。无论根本原因是什么，只要将 RVM 排除在外，并遵循 ruby​​gems 指南，你就会好起来的。

# ruby-on-rails - 通过 Capybara (v2) 与 Bootstrap 模态交互时出现问题

> ID：14488836
> 
> 赞同：14
> 
> 时间：2013-01-23T20:32:31.557
> 
> 标签：ruby-on-rails, twitter-bootstrap, capybara, jquery-tokeninput, capybara-webkit

在 Rails 应用程序中，我正在尝试使用 Capybara 和驱动程序在 Rspec 中使用[jQuery TokenInput 字段测试](http://loopj.com/jquery-tokeninput/)[引导模式。](https://getbootstrap.com/javascript/#modals)有问题的部分如下：`capybara-webkit`

```
click_link 'Create Team Modal'
sleep 1

within('div#modal_popup') do
  fill_in 'input#token-input-team_name', with: 'Fancy team name'
  sleep 1
  fill_in 'input#token-input-team_name', with: '\t'
  sleep 1

  click_button 'Create Team'
end

page.should have_content('Fancy team name') 
```

*   点击按钮获取模态
*   用团队名称填写 TokenInput
*   模拟 Tab 键以将其选中
*   创建团队
*   验证名称显示在页面上

这仅适用于所有这些`sleep 1`s；否则 Capybara 在 崩溃`have_content`，最终导致服务器错误，因为团队名称永远无法正确选择。但是，其他*没有*`sleep 1`TokenInput 字段的 Bootstrap 模式在加载之前不需要 a 。

说了这么多，有什么办法可以摆脱睡眠并让这一切正常进行吗？Capybara 2 退出`wait_until`（有充分的理由），因为它会在默认等待时间内等待测试某些东西……但这似乎并没有反映在我的上述测试中；就好像水豚在进入/退出这个模式时没有参与那个等待期。有人对此有经验吗？使用 Rails 3.2.10、Rspec 2.12、Capybara 2、capybara-webkit 0.14.0、TokenInput 1.6。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-22T08:42:14.427

尝试在测试环境 layouts/application.html.erb 中禁用动画

```
<% if Rails.env.test? %>
 <style type="text/css">
    .modal.fade, .fade {
      -webkit-transition: opacity 0.01s;
      -moz-transition: opacity 0.01s;
      -ms-transition: opacity 0.01s;
      -o-transition: opacity 0.01s;
      transition: opacity 0.01s;
    }
 </style>
<%end%> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-11T10:00:33.117

我建议在测试环境中添加 falowing css：

```
 div, a, span, footer, header {
      -webkit-transition: none !important;
      -moz-transition: none !important;
      -ms-transition: none !important;
      -o-transition: none !important;
      transition: none !important;
  }

  .modal {
    display: none !important;
  }

  .modal.in {
    display: block !important;
  }

  .modal-backdrop {
    display: none !important;
  } 
```

在正文中添加这个js：

```
$(".fade").removeClass("fade"); 
```

这解决了我使用水豚和引导程序的大部分问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-22T22:04:39.250

我们只是这样做，它似乎工作（例如点击`$('.tp-header-login'`）：

```
# instead of find(".tp-header-login")

find(".tp-header-login") # still do the find so you are sure its loaded then...
execute_script "$('.tp-header-login').click()" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-19T19:02:48.527

对于那些希望避免`Rails.env.___?`hacks* 的人来说，以下*似乎*工作（到目前为止 - 手指交叉）可以避免在基于 Bootstrap 的模式上测试[jQuery UI 拖放功能的问题。](https://api.jqueryui.com/sortable/)

首先，我们已经在*“等待”*模态框的出现，使用这样的辅助方法：

```
def wait_for_modal_to_appear
  modal = wait_until {
    # Look for the modal by ID/whatever...
  }
  raise Capybara::ModalNotFound.new('...') if modal.nil?
  return modal
end 
```

然而，当我们尝试在该模式中拖放元素时，我们仍然遇到了一些虚假的问题。`return`在该行之前添加的以下代码*似乎*起到了作用：

```
page.execute_script("document.getElementById('#{modal[:id]}').classList.remove('fade');") 
```

* * *

* 正是这样的黑客攻击最近导致需要在与我合作的公司进行紧急部署......一个糟糕的代码更改设法使其投入生产，因为它仅由`if Rails.env.production?`限定符激活；否则它会失败一半的测试套件。

# php - 如何缩小 INSERT 和 PRINT 查询？

> ID：14488845
> 
> 赞同：0
> 
> 时间：2013-01-23T20:33:34.297
> 
> 标签：php, mysql

我有两个 PHP/SQL 函数，我想知道如何缩小它们。我想将 3 个插入命令作为单个 $import 而不是三个运行，但我不确定如何缩小它。

```
$import9="INSERT into wp_postmeta (meta_id,post_id,meta_key,meta_value) values(',','$data[37]','lower_electric_costs','$data[5]')";
$import10="INSERT into wp_postmeta (meta_id,post_id,meta_key,meta_value) values(',','$data[37]','cheapest_green_electric','$data[6]')";
$import11="INSERT into wp_postmeta (meta_id,post_id,meta_key,meta_value) values(',','$data[37]','contract_type','$data[11]')"; 
```

它与我的 PRINT 结果相同——我将如何缩小它？

```
mysql_query($import9) or die("mysql_error()");
print $import9."<br>";
mysql_query($import10) or die("mysql_error()");
print $import10."<br>";
mysql_query($import11) or die("mysql_error()");
print $import11."<br>"; 
```

我仍在学习 PHP/SQL，我认为学习如何缩小我的代码是其中的一个重要部分。如果有人能告诉我一个缩小版本的例子，那么我可能可以从那里拿走它。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:36:10.377

您可以将其组合成一个查询，如下所示：

```
$import9="
    INSERT into
        wp_postmeta
        (meta_id,post_id,meta_key,meta_value)
    values
        (',','$data[37]','lower_electric_costs','$data[5]'),
        (',','$data[37]','cheapest_green_electric','$data[6]'),
        (',','$data[37]','contract_type','$data[11]')
"; 
```

但是，您应该使用`mysqli`而不是`mysql`函数，因为`mysql`函数已被弃用。

```
mysqli_query($import9); 
```

出于安全原因，还建议您不要使用 INSERT 查询，`mysqli_query`而是使用 Prepared Statements。您应该查看[PDO](http://us1.php.net/manual/en/book.pdo.php)和[Prepared Statements](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)。

首先，创建一个 PDO 实例。

```
$db = new PDO("mysql:host=localhost;port=3306;dbname=mydb", "username", "password");
$db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); //Turn off prepared statement emulation too. 
```

使用准备好的语句，您将向`prepare`服务器发送语句：

```
$stmt = $db->prepare("
    INSERT into
        wp_postmeta
        (meta_id,post_id,meta_key,meta_value)
    values
        (?,?,?,?)
"); 
```

使用如下数组：

```
$values = array(
    array(',',$data[37], 'lower_electric_costs', $data[5]),
    array(',',$data[37], 'cheapest_green_electric', $data[6]),
    array(',',$data[37], 'contract_type', $data[11]),
); 
```

接下来，您将发出一系列执行语句：

```
foreach ($values as $v) {
    $stmt->execute($v);
} 
```

最后，关闭语句，以便执行更多语句：

```
$stmt->closeCursor(); 
```

# javascript - 具有 HTML5 画布的更高 DPI 图形

> ID：14488849
> 
> 赞同：19
> 
> 时间：2013-01-23T20:33:40.050
> 
> 标签：javascript, html, canvas, html5-canvas

使用 HTML5 画布创建图像时，是否可以设置自定义 DPI/PPI？我知道如何在画布上绘制并将其导出为图像，但如何确保输出图像具有特定的 DPI/PPI。我想使用 SVG 元素在画布上绘制是一种方法，但是当我将整个画布导出为图像时，这不会变平吗？或者计算设备 DPI，然后缩放图像以满足我的 DPI 要求，但这似乎不是正确的解决方案。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2014-09-25T20:42:09.657

画布有两种不同的“尺寸”：它们的 DOM 宽度/高度和它们的 CSS 宽度/高度。您可以通过增加 DOM 大小同时保持 CSS 大小固定来增加画布的分辨率，然后使用 .scale() 方法将您未来的所有绘图缩放到新的更大尺寸。这是一个例子：

```
function changeResolution(canvas, scaleFactor) {
    // Set up CSS size.
    canvas.style.width = canvas.style.width || canvas.width + 'px';
    canvas.style.height = canvas.style.height || canvas.height + 'px';

    // Resize canvas and scale future draws.
    canvas.width = Math.ceil(canvas.width * scaleFactor);
    canvas.height = Math.ceil(canvas.height * scaleFactor);
    var ctx = canvas.getContext('2d');
    ctx.scale(scaleFactor, scaleFactor);
} 
```

画布默认分辨率为 96dpi（CSS 英寸，不基于实际屏幕）。所以 2 的 scaleFactor 给出 192dpi，3 是 288dpi，依此类推。事实上，这里有一个版本应该给出你想要的 DPI：

```
function setDPI(canvas, dpi) {
    // Set up CSS size.
    canvas.style.width = canvas.style.width || canvas.width + 'px';
    canvas.style.height = canvas.style.height || canvas.height + 'px';

    // Resize canvas and scale future draws.
    var scaleFactor = dpi / 96;
    canvas.width = Math.ceil(canvas.width * scaleFactor);
    canvas.height = Math.ceil(canvas.height * scaleFactor);
    var ctx = canvas.getContext('2d');
    ctx.scale(scaleFactor, scaleFactor);
} 
```

玩得开心！请注意，这两个代码示例每个画布只能使用一次，它们假定当前 DOM 大小是原始大小（可以对其进行调整以更改）。在画布上进行任何绘图*之前*，还需要进行重新缩放。感谢[这篇文章](http://searchvoidstar.tumblr.com/post/86542847038/high-dpi-rendering-on-html5-canvas-some-problems)提供的方法和信息！

**编辑：**这是一个更强大的功能，可以扩展未来的绘图*并*维护现有的画布内容。这可以调用多次重新缩放。

```
function setDPI(canvas, dpi) {
    // Set up CSS size.
    canvas.style.width = canvas.style.width || canvas.width + 'px';
    canvas.style.height = canvas.style.height || canvas.height + 'px';

    // Get size information.
    var scaleFactor = dpi / 96;
    var width = parseFloat(canvas.style.width);
    var height = parseFloat(canvas.style.height);

    // Backup the canvas contents.
    var oldScale = canvas.width / width;
    var backupScale = scaleFactor / oldScale;
    var backup = canvas.cloneNode(false);
    backup.getContext('2d').drawImage(canvas, 0, 0);

    // Resize the canvas.
    var ctx = canvas.getContext('2d');
    canvas.width = Math.ceil(width * scaleFactor);
    canvas.height = Math.ceil(height * scaleFactor);

    // Redraw the canvas image and scale future draws.
    ctx.setTransform(backupScale, 0, 0, backupScale, 0, 0);
    ctx.drawImage(backup, 0, 0);
    ctx.setTransform(scaleFactor, 0, 0, scaleFactor, 0, 0);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T22:20:34.363

您无法（ugh）在任何浏览器中访问当前网页显示的 DPI：

[从 JS/CSS 检测系统 DPI/PPI？](https://stackoverflow.com/questions/279749/detecting-the-system-dpi-ppi-from-js-css)

对于打印：您很可能无法`<canvas>`使用浏览器标准功能设置导出图像（PNG、JPEG）的 DPI。但是，如果您使用纯 Javascript 编码器图像编码器，您可以自由创建任何类型的二进制文件，并手动调整嵌入在二进制文件中的 DPI 值。

[https://gist.github.com/1245476](https://gist.github.com/1245476)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-16T12:30:25.200

如果您只想设置 PNG 的 dpi（即不增加像素数），那么此库可让您设置**pHYs**块（除其他外）：

[https://github.com/imaya/CanvasTool.PngEncoder](https://github.com/imaya/CanvasTool.PngEncoder)

将 HTML5 画布导出为 base64 编码的 PNG 的最小示例：

```
 // convert dots per inch into dots per metre
        var pixelsPerM = dpi * 100 / 2.54;

        var param = {
            bitDepth : 8,
            colourType : 2,
            filterType : 0,
            height : canvas.height,
            interlaceMethod : 0,
            phys : {
                unit : 1,
                x : pixelsPerM,
                y : pixelsPerM
            },
            width : canvas.width
        };

        var array = canvas.getContext('2d').getImageData(0, 0, canvas.width,
                canvas.height).data;

        var png = new window.CanvasTool.PngEncoder(array, param).convert();

        var base64 = 'data:image/png;base64,' + btoa(png); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-12T07:03:30.107

使用库 changedpi：

```
npm install changedpi --save 
```

另见

*   [https://github.com/shutterstock/changeDPI](https://github.com/shutterstock/changeDPI)
*   [https://github.com/hongru/canvas2image](https://github.com/hongru/canvas2image)

还允许为 png 或 jpg 导出调整 px 大小和分辨率的示例代码：

```
Canvas2Image.saveAsImage('fileName.png', canvas, 2000, 3000, 300, 'png'); 
```

-

```
import Url from './url';
import * as ChangeDpi from 'changeDPI';

export default class Canvas2Image {
  static saveAsImage(fileName, canvas, width, height, dpi, type) {
    type = this._fixType(type);
    canvas = this._scaleCanvas(canvas, width, height);
    let dataUrl = canvas.toDataURL(type);
    let dataUrlWithDpi = ChangeDpi.changeDpiDataUrl(dataUrl, dpi)
    dataUrlWithDpi = dataUrlWithDpi.replace(type, 'image/octet-stream');
    Url.download(fileName, dataUrlWithDpi);
  }

  static _fixType(type) {
    type = type.toLowerCase().replace(/jpg/i, 'jpeg');
    const r = type.match(/png|jpeg|bmp|gif/)[0];
    return `image/${r}`;
  }

  static _scaleCanvas(canvas, width, height) {
    const w = canvas.width;
    const h = canvas.height;
    if (width === undefined) {
      width = w;
    }
    if (height === undefined) {
      height = h;
    }

    const retCanvas = document.createElement('canvas');
    const retCtx = retCanvas.getContext('2d');
    retCanvas.width = width;
    retCanvas.height = height;
    retCtx.drawImage(canvas, 0, 0, w, h, 0, 0, width, height);
    return retCanvas;
  }
} 
```

-

```
export default class Url {
  static download(fileName, url) {
    const element = document.createElement('a');
    element.setAttribute('href', url);
    element.setAttribute('download', fileName);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }

  static createUrlForBlob(blob) {
    return this._URL.createObjectURL(blob);
  }

  static clearBlobUrl(blobUrl) {
    this._URL.revokeObjectURL(blobUrl);
  }

  static get _URL() {
    return window.URL || window.webkitURL || window;
  }
} 
```

# html - 链接按钮在 ie7/ie8 中不起作用

> ID：14488852
> 
> 赞同：0
> 
> 时间：2013-01-23T20:33:43.867
> 
> 标签：html

我有一个将用户带到另一个页面的按钮。我可以只使用一个链接，但我希望它看起来像一个按钮。它在除 IE7 和 IE8 之外的所有设备上都可以正常工作，但我不知道为什么？

```
<div id="print_version">
          <a href="report_print.php?audit=<? echo $audit_id; ?>" target="_blank">
          <input type="button"value="Print Report"></a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:48:28.433

摆脱输入并使用样式`<a>`标签。

**HTML**

```
<div id="print_version">
     <a class="btn" href="report_print.php?audit=<?php echo $audit_id; ?>" target="_blank">Print Report</a>
</div> 
```

**CSS**

```
.btn {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #F5F5F5;
    background-image: -moz-linear-gradient(center top , #FFFFFF, #E6E6E6);
    background-repeat: repeat-x;
    border-color: #E6E6E6 #E6E6E6 #A2A2A2;
    border-image: none;
    border-radius: 4px 4px 4px 4px;
    border-style: solid;
    border-width: 1px;
    box-shadow: 0 1px 0 rgba(255, 255, 255, 0.2) inset, 0 1px 2px rgba(0, 0, 0, 0.05);
    color: #333333;
    cursor: pointer;
    display: inline-block;
    font-size: 14px;
    line-height: 20px;
    margin-bottom: 0;
    padding: 4px 14px;
    text-align: center;
    text-decoration: none;
    text-shadow: 0 1px 1px rgba(255, 255, 255, 0.75);
    vertical-align: middle;
} 
```

CSS 是对 twitter 引导程序的补充。[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

# sql - 查找任何列中具有空值的所有行

> ID：14488859
> 
> 赞同：22
> 
> 时间：2013-01-23T20:34:23.457
> 
> 标签：sql, sql-server, sql-server-2005, null, correlated-subquery

我正在尝试创建一个查询，该查询将返回除 1 列之外的所有具有空值的所有行。有些行在某处会有多个空条目。我将要排除一列，因为此时所有条目均为空，并且它是唯一允许具有空值的列。我被卡住了，因为我不知道如何在 WHERE 中包含所有列。

```
SELECT *
FROM Analytics
WHERE * IS NULL 
```

或者，我可以对一列进行计数，但该表大约有 67 列。

```
SELECT COUNT(*)
FROM Analytics
WHERE P_Id IS NULL 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T21:08:41.483

[在 SQL Server 中，您可以从这个答案](https://stackoverflow.com/a/9079399/73226)中借用这个想法

```
;WITH XMLNAMESPACES('http://www.w3.org/2001/XMLSchema-instance' as ns)
SELECT *
FROM   Analytics
WHERE  (SELECT Analytics.*
        FOR xml path('row'), elements xsinil, type
        ).value('count(//*[local-name() != "colToIgnore"]/@ns:nil)', 'int') > 0 
```

[SQL小提琴](http://www.sqlfiddle.com/#!3/32a27/1)

可能构建具有 67 列的查询会更有效，但它节省了一些输入或需要动态 SQL 来生成它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:49:02.367

根据您使用的 RDBMS，我认为您唯一的选择（而不是明确地说`WHERE col1 IS NULL and col2 IS NULL and col3 IS NULL`...）是使用动态 SQL。

例如，如果您想从 SQL Server 数据库中获取所有列名，您可以使用类似这样的方法来返回这些名称：

```
SELECT
     name
FROM
     sys.columns
WHERE
     object_id = OBJECT_ID('DB.Schema.Table') 
```

您可以使用 FOR XML 创建 WHERE 子句：

```
SELECT Name + ' IS NULL AND ' AS [text()]
FROM sys.columns c1
WHERE     object_id = OBJECT_ID('DB.Schema.Table')
ORDER BY Name
FOR XML PATH('') 
```

希望这有助于您入门。

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:55:06.327

我没有这样的表来测试，假设`'x'`在任何字段中都没有 as 数据，我认为这应该可以`Sql-Server`；（[演示](http://sqlfiddle.com/#!3/cf7c3/8)）

**注意：**我已将 keyColumn 过滤为`c.name != 'keyColumn'`

```
DECLARE @S NVARCHAR(max), @Columns VARCHAR(50), @Table VARCHAR(50)

SELECT @Columns = '66', --Number of cols without keyColumn
       @Table = 'myTable'

SELECT @S =  ISNULL(@S+'+ ','') + 'isnull(convert(nvarchar, ' + c.name + '),''x'')'  
FROM sys.all_columns c 
WHERE c.object_id = OBJECT_ID(@Table) AND c.name != 'keyColumn'

exec('select * from '+@Table+' where ' + @S + '= replicate(''x'',' + @Columns + ')') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-19T00:24:48.840

对于像我这样的 SQL 初学者来说，上面的所有查询似乎都很难消化。我认为最快的方法就是为所有 67 列编写查询。它基本上只是一个复制和粘贴过程。例如：

```
select count(*) from user where id is null or 
 name is null or 
 review_count is null or
 yelping_since is null or 
 useful is null or 
 funny is null; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-20T23:23:01.240

这是针对 SQLite 的，略有不同，但我遇到了同样的问题，最后我编写了这个小 Python 脚本`findnulls.py`来查找数据库中的所有空值：

```
import sqlite3
import sys

def main():
    dbfile = sys.argv[1]
    conn = sqlite3.connect(dbfile)
    c = conn.cursor()

    tables = c.execute("SELECT name FROM sqlite_master WHERE type='table';").fetchall()

    for table in tables:
        tablename = table[0]
        cols = c.execute("PRAGMA table_info({0})".format(tablename)).fetchall()

        for col in cols:
            colname = col[1]
            nullvals = c.execute("SELECT COUNT(*) FROM {0} WHERE {1} IS NULL;".format(tablename, colname)).fetchall()
            if nullvals[0][0] != 0:
                print("found {0} nulls in table: {1} column {2}".format(nullvals[0][0], tablename, colname))

main() 
```

你会像这样运行它：

`findnulls.py somedatabase.db`

输出如下所示：

```
found 1 nulls in table: Channels column MessageId
found 1 nulls in table: Channels column MessageChannel
found 1 nulls in table: Channels column SignalType    
found 7 nulls in table: Channels column MinVal        
found 7 nulls in table: Channels column MaxVal        
found 9 nulls in table: Channels column AvgVal        
found 9 nulls in table: Channels column Median
found 9 nulls in table: Channels column StdDev 
```

# bash - 如何删除 | 在多个反斜杠之间

> ID：14488860
> 
> 赞同：0
> 
> 时间：2013-01-23T20:34:34.910
> 
> 标签：bash, shell, sed, awk

我以前在这里得到过类似的问题的回答，但这一次对我来说更具挑战性，我所需要的只是删除 | 在名称“\WAPNER|约翰|M\”之间

删除反斜杠也将是一个加号。

文件

```
10.46|5060|100002366551140|\WAPNER| john | M\ |100002366551750 
```

期望的输出

```
 10.46|5060|100002366551140|\WAPNER john  M\ |100002366551750 
```

如果您的解决方案也适用于带有单斜杠的名称，那将是完美的:)

```
 10.46|5060|100002366551140|\WAPNER|  M\ |100002366551750 
```

输出将是

```
 10.46|5060|100002366551140|\WAPNER M\ |100002366551750 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T22:17:14.457

这可能对您有用（GNU Sed）：

```
sed -r '/\\[^\\]*\\/{s//\n&\n/;h;s/[\\|]//g;G;s/.*\n(.*)\n.*\n(.*)\n.*\n/\2\1/}' file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T20:44:56.333

尝试这个

```
awk -F '\\'  '{ gsub("|", "", $2); print $0 }'  inputfile > newfile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:42:00.700

```
$ echo "10.46|5060|100002366551140|\WAPNER| john | M\ |100002366551750" | awk -F'|' '{print $1"|"$2"|"$3"|"$4$5$6"|"$7}' | sed s.\\\\..g
10.46|5060|100002366551140|WAPNER john  M |100002366551750 
```

请注意，只有假设总是有 3 个'|'，它才会起作用 要删除的字符。

更新：似乎我没有注意到标题 - 如果你想删除所有 '|' 一对'\'之间的字符，jim mcnamara 的解决方案更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T05:34:51.887

尝试这个

`sed -re 's/\\(\w+)(\|)( \w* )(\|)([ A-Za-z]+)\\/\1\3\5/g' temp.txt`

输出

`10.46|5060|100002366551140|WAPNER john M |100002366551750`

# android - Google Map API V2 中的堆不断增加

> ID：14488865
> 
> 赞同：5
> 
> 时间：2013-01-23T20:34:42.003
> 
> 标签：android, performance, google-maps, heap-memory

我遇到了一个让我发疯的问题。我在我的代码中使用了 Google Map API V2，当我移动地图时，我可以看到以下 Logcat 输出（在 Nexus 7 上）：

```
01-23 21:17:10.724: D/dalvikvm(5484): GC_FOR_ALLOC freed 4531K, 21% free 12911K/16312K, paused 29ms, total 29ms
01-23 21:17:10.724: I/dalvikvm-heap(5484): Grow heap (frag case) to 13.043MB for 285724-byte allocation
01-23 21:17:10.744: D/dalvikvm(5484): GC_FOR_ALLOC freed 200K, 22% free 12990K/16592K, paused 25ms, total 25ms
01-23 21:17:12.074: D/dalvikvm(5484): GC_FOR_ALLOC freed 1326K, 23% free 12893K/16592K, paused 30ms, total 31ms
01-23 21:18:04.854: D/dalvikvm(5484): Debugger has detached; object registry had 1 entries
01-23 21:18:07.374: D/dalvikvm(5484): GC_FOR_ALLOC freed 658K, 23% free 12904K/16592K, paused 27ms, total 27ms
01-23 21:18:07.384: I/dalvikvm-heap(5484): Grow heap (frag case) to 13.763MB for 1048592-byte allocation
01-23 21:18:07.404: D/dalvikvm(5484): GC_FOR_ALLOC freed 2K, 21% free 13925K/17620K, paused 27ms, total 27ms
01-23 21:18:07.714: D/dalvikvm(5484): GC_FOR_ALLOC freed 2127K, 26% free 13054K/17620K, paused 29ms, total 29ms
01-23 21:18:44.694: D/dalvikvm(5484): GC_CONCURRENT freed 1894K, 27% free 12970K/17620K, paused 4ms+5ms, total 56ms
01-23 21:18:46.684: D/dalvikvm(5484): GC_CONCURRENT freed 1738K, 27% free 12996K/17620K, paused 4ms+2ms, total 53ms
01-23 21:18:49.254: D/dalvikvm(5484): GC_CONCURRENT freed 1756K, 27% free 13014K/17620K, paused 2ms+8ms, total 77ms
01-23 21:18:56.864: I/dalvikvm(5484): Jit: resizing JitTable from 8192 to 16384
01-23 21:18:56.934: D/dalvikvm(5484): GC_CONCURRENT freed 1840K, 21% free 13010K/16312K, paused 2ms+4ms, total 49ms
01-23 21:18:59.434: D/dalvikvm(5484): GC_CONCURRENT freed 1779K, 21% free 12995K/16312K, paused 4ms+5ms, total 50ms
01-23 21:19:03.414: D/dalvikvm(5484): GC_CONCURRENT freed 1781K, 21% free 13007K/16312K, paused 2ms+3ms, total 48ms 
```

堆不断增长和增长，我不知道我能做些什么。我通过网络和 stackoverflow 进行了搜索，但没有对我有用的答案。我希望你们中的某个人能找到错误。我对Android很陌生，所以请欣赏。

EDIT1：堆转储：

![在这里您可以看到导致堆分配的原因。](../Images/d8de79a2ee7795d274b354ace283a101.png)

EDIT2：MAT分析

嫌疑人一：

```
One instance of "maps.by.a" loaded by "dalvik.system.PathClassLoader @ 0x4480cfa8" occupies 1.002.352 (22,33%) bytes. The memory is accumulated in one instance of "maps.by.d" loaded by "dalvik.system.PathClassLoader @ 0x4480cfa8".

Keywords
maps.by.a
dalvik.system.PathClassLoader @ 0x4480cfa8
maps.by.d 
```

嫌疑人2：

```
3.507 instances of "java.lang.Class", loaded by "<system class loader>" occupy 795.104 (17,72%) bytes. 

Biggest instances:
•class com.ibm.icu4jni.util.Resources$DefaultTimeZones @ 0x401fccc8 - 151.744 (3,38%) bytes. 
•class android.text.Html$HtmlParser @ 0x4016d288 - 126.592 (2,82%) bytes. 
•class org.apache.harmony.security.fortress.Services @ 0x40091188 - 51.456 (1,15%) bytes. 

Keywords
java.lang.Class 
```

嫌疑人3：

```
8.168 instances of "java.lang.String", loaded by "<system class loader>" occupy 529.048 (11,79%) bytes. 

Keywords
java.lang.String 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:49:06.570

首先，您的堆不会“不断增长”。它在 12893K 和 13054K 之间徘徊，上升和下降，在 13925K 处有一个异常峰值。就个人而言，我在该日志中没有看到任何让我担心的东西。

关于您的 MAT 输出，如果这三个是罪魁祸首，那就不足为奇了。后两者说“我正在为 Android 编写一个应用程序”，因为它们总是存在于任何 Android 应用程序上。第一个表明 Maps V2 有一个相当矮胖的对象。同样，我在该输出中看不到任何表明存在问题的内容。

# c# - 没有可用源的未处理 System.NotImplementedException？

> ID：14488867
> 
> 赞同：2
> 
> 时间：2013-01-23T20:34:48.410
> 
> 标签：c#, visual-studio-2012, windows-phone-8, notimplementedexception

我不确定是否有人遇到过这个问题。

我正在 VS 2012 中开发 C# Windows Phone 8 应用程序。

我最近收到了 System.NotImplementedException 类型的未处理异常。

尽管事实上我的所有代码都包含在 try/catch 块中，并且没有抛出未实现异常的方法存根。

在输出中是：

*MyAppName.DLL 中发生了“System.NotImplementedException”类型的第一次机会异常*

*MyAppName.DLL 中发生了“System.NotImplementedException”类型的异常，并且在托管/本机边界之前未处理*

如果我点击“继续”继续调试，我会在 VS 中弹出错误消息对话框：

*System.Windows.ni.dll 中出现“System.NotImplementedException”类型的未处理异常*

如果我在此处选择“中断”，则打开的堆栈跟踪会显示**“无可用源；调用堆栈仅包含外部代码。该线程停止时仅调用堆栈上的外部代码帧。**等等。”

这是应用程序崩溃后突出显示的代码：

```
private void Application_UnhandledException(object sender, ApplicationUnhandledExceptionEventArgs e)
    {
        if (Debugger.IsAttached)
        {
            // An unhandled exception has occurred; break into the debugger
            Debugger.Break();
        }
    } 
```

编辑：这是堆栈：

```
Call stack with external code
System.Windows.ni.dll!MS.Internal.JoltHelper.OnUnhandledException(object sender, System.UnhandledExceptionEventArgs args)
mscorlib.ni.dll!System.Runtime.CompilerServices.AsyncMethodBuilderCore.ThrowAsync.AnonymousMethod_1(object state)
mscorlib.ni.dll!System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(object state)
mscorlib.ni.dll!System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)
mscorlib.ni.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)
mscorlib.ni.dll!System.Threading.QueueUserWorkItemCallback..System.Threading.|ThreadPoolWorkItem.ExecuteWorkItem()
mscorlib.ni.dll!System.Threading.ThreadPoolWorkQueue.Dispatch()
mscorlib.ni.dll!System.Threading._ThreadPoolWaitCallback.PerformWaitCallback()
[Native to Managed Transition] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T21:55:35.620

对于任何有类似问题的人，我找到了明显的原因。

我已经从 Surface 的 Win8 应用程序中移植了一些涉及文件输入/输出的代码，并且在其中一行中，忽略了更改

```
StorageFolder storageFolder = KnownFolders.DocumentsLibrary; 
```

到其对应的

```
IsolatedStorageFile storageFolder = IsolatedStorageFile.GetUserStoreForApplication(); 
```

不知何故，这没有在 try/catch 块中被捕获，但是当我修复它时，未捕获的 notimplementedexception 不再发生。

# plugins - 如何在我的插件上使用 OrganizationServiceProxy - CRM 2011？

> ID：14488868
> 
> 赞同：0
> 
> 时间：2013-01-23T20:34:48.297
> 
> 标签：plugins, dynamics-crm-2011, fetchxml

我需要在 CRM 插件中使用 fetch xml，我在这里找到了一个关于如何做到这一点的示例：

```
string groupby1 = @" 
    <fetch distinct='false' mapping='logical' aggregate='true'> 
     <entity name='opportunity'>
      <attribute name='name' alias='opportunity_count' aggregate='countcolumn' />  
      <attribute name='ownerid' alias='ownerid' groupby='true' />
      <attribute name='createdon' alias='createdon' /> 
      <attribute name='customerid' alias='customerid' /> 
     </entity> 
    </fetch>";

    EntityCollection groupby1_result = orgProxy.RetrieveMultiple(new FetchExpression(groupby1)); 
```

但是还有其他东西我不知道如何使用，或者它在哪里使用..它的部分说：

```
orgProxy.RetrieveMultiple(new FetchExpression(groupby1)); 
```

我知道它是*OrganizationServiceProxy*的一个对象，但它在插件类中的什么位置？我查不出来。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:55:25.627

以最礼貌的方式，您可能需要后退几步才能前进。

所以要写一个插件，你需要实现`IPlugin`，它只有一个方法

```
public void Execute(IServiceProvider serviceProvider) 
```

这`IServiceProvider`是您进入 CRM 的窗口以及您所关注的事件的上下文。

通常，您会执行以下操作：

```
var context = (IPluginExecutionContext) serviceProvider.GetService(typeof (IPluginExecutionContext));
var factory = (IOrganizationServiceFactory) serviceProvider.GetService(typeof (IOrganizationServiceFactory));
var service = factory.CreateOrganizationService(context.UserId); 
```

在上面的例子中，`service`是类型`IOrganizationService`。这为您提供了您期望的所有方法

```
service.Execute(foo);
service.RetrieveMultiple(bar);
service.Update(... /* etc 
```

可能值得回顾一下这方面的一些指南 - 正如我在之前的回答中给出的[那样](https://stackoverflow.com/questions/11507590/tutorial-for-plugin-in-dynamic-crm-2011)

# ruby-on-rails - 将 Ruby 字符串插值作为 ID

> ID：14488869
> 
> 赞同：4
> 
> 时间：2013-01-23T20:34:55.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, scroll, interpolation

我正在尝试掌握插值并尝试使用动态字符串（我说动态，因为它可以一直更改，我通过屏幕抓取来获取电影发布的日期）并作为 ID，以便我可以使用 bootstrap scrollspy我的项目

我使用传统的 ID 和锚标签创建[了一个 js fiddle](http://jsfiddle.net/richlewis14/NySg6/)，展示了我想要实现的目标。

如您所见，如果我在滚动时位于该部分内，我想显示电影的发行日期。

我的代码如下所示：

```
<div class="container">
 <div class="row">
  <div class="span8 offset2">
   <div id="dateNav">
    <ul class="dateNav">
      <li><a href="##{date}"></a><% @response.each_pair do |date, movie| %><%= link_to date_format(date) %><% end %></li>
   </ul>
   </div>
  </div>
 </div>
</div>
<div class="span9">
 <% @response.each_pair do |date, movie| %>
  <h3 class="resultTitle fontSize13" id="<%= date %>">Available on&nbsp;<%= date_format(date) %></h3>
</div>
<!-- More movie information here
<% end %> 
```

我的身体是这样的

```
<body data-spy="scroll" data-target="#dateNav"> 
```

我像这样打电话给scrollspy

```
$('.dateNav').scrollspy() 
```

当您在相关部分时，日期应该出现

CSS

```
ul.dateNav ul li a {
 display:none;
}

ul.dateNav ul > li.active > a{
display:block
color: red;
text-decoration: underline;
} 
```

但是，当向下滚动页面时，日期不会出现。

任何帮助表示赞赏，真的很想在这里澄清一些理解。

谢谢

编辑

好的，正如乔·皮姆所建议的那样已经改变了

```
<li><% @response.each_pair do |date, movie| %><%= link_to date_format(date), "##{date}" %><% end %></li> 
```

每个日期现在都有自己的 id，以前没有发生，但相关日期仍然没有出现

现在生成的 HTML

```
<ul class="dateNav">
 <li>
 <a href="#2013-01-09">9th Jan 2013</a>
 <a href="#2013-01-11">11th Jan 2013</a>
 <a href="#2013-01-18">18th Jan 2013</a>
 <a href="#2013-01-23">23rd Jan 2013</a>
 <a href="#2013-01-25">25th Jan 2013</a>
 <a href="#2013-01-30">30th Jan 2013</a>
 </li>
</ul> 
```

编辑萨拉

调用滚动间谍

```
$('#spyOnThis').scrollspy(); 
```

日期导航

```
<div class="container">
 <div class="row">
  <div class="span12">
   <div id="dateNav">
    <ul class="nav dateNav">
      <li><% @response.each_pair do |date, movie| %><%= link_to date_format(date), "#d_#{date}" %><% end %></li>
    </ul>
   </div>
  </div>
</div> 
```

电影列表

```
<div id="spyOnThis">
  <% @response.each_pair do |date, movie| %>
    <h3 class="resultTitle fontSize13" id="d_<%= date %>">Available on&nbsp;<%= date_format(date) %></h3>
    <% movie.each do |m| %>
      <div class="thumbnail clearfix">
        <img class="pull-left" src=<% if m.image_link %> <%= m.image_link %> <% else %> "/assets/noimage.jpg" <% end %>>
        <div class="caption pull-right">
          <%= link_to m.name, m.title_id, :class => 'resultTitle fontSize11' %>
          <p class="bio"><%= m.bio %></p>
          <p class="resultTitle">Cast</p>
          <p class="bio"><%= m.cast.join(", ") unless m.cast.empty? %></p>
          <%= link_to "Remind me", reminders_path(:title_id => m.title_id), :method => :post, :class => 'links button' %>
        </div>
      </div>

    <% end %>
  <% end %>
  </div> 
```

CSS

```
#spyOnThis {
 height:auto;
 overflow:auto;
} 
```

我将高度设置为自动，因为结果的数量每次都会改变

```
ul.dateNav > li.active > a {
display:block;
color: red;
text-decoration: underline;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T21:52:04.367

以数字开头的 ID 无效。[来源](https://stackoverflow.com/a/79022/1684247)

尝试在每个 ID 的开头添加一个字符串常量。

```
<a href="#d_#{date}"></a> 
```

和

```
<h3 class="resultTitle fontSize13" id="d_<%= date %>"> 
```

[免责声明：我不认识 Ruby。]

* * *

**编辑**

好的，所以我将其剥离并使其正常工作。[jsFiddle](http://jsfiddle.net/JT2vB/)

我出于小提琴的目的更改了您的一些类和 ID（似乎还有一些混淆`.dateNav`and `#dateNav`），但它应该看起来像这样：

```
<ul class="nav dateNav">
  <li>
    <a href="#d_#{date}"><% @response.each_pair do |date, movie| %><%= link_to date_format(date) %><% end %></a>
  </li>
</ul> 
```

和

```
<div class="span9">
  <% @response.each_pair do |date, movie| %>
  <h3 class="resultTitle fontSize13" id="d_<%= date %>">Available on&nbsp;<%= date_format(date) %></h3>
</div> 
```

您可以将 ID 放在`div`（就像在小提琴中一样）或者`h3`，没关系。重要的部分是 CSS 以及如何启动 ScrollSpy。

如果您使用 JavaScript ( `$('#spyOnThis').scrollspy()`) 调用它，则需要将其附加到要触发滚动事件的元素上，而不是跟踪的菜单上。[Source](https://stackoverflow.com/a/12125291/1684247)
此外，您应该从元素 中删除`data-spy`和。`data-target``body`

最后但并非最不重要的一点是，您调用的元素`.scrollspy()`需要为插件设置一个`height`并`overflow: auto;`设置以跟踪滚动位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:38:25.853

在你的 ERB 中，你有

```
<li><a href="##{date}"></a> 
```

你不是插值它。将其更改为：

```
<li><a href="#<%= date%>"></a> 
```

编辑。

报废...只是看起来标签应该在循环内？

# visual-studio-2010 - 如何从 VS2010 中的构建后脚本覆盖 TFS 下签入的文件？

> ID：14488876
> 
> 赞同：0
> 
> 时间：2013-01-23T20:35:09.170
> 
> 标签：visual-studio-2010, tfs, access-denied, overwrite, webdeploy

我有一个带有 WebForms 项目的 VS2010 解决方案，该项目设置为使用 Web Deploy 发布。还有另一个 WinForms 项目和一个 WinForms 设置，我也需要发布其输出。

现在这些设置文件已添加到 Web 项目中，并且通常保持签入状态。我们以前手动替换它们。

我尝试在 WebClient 上编写构建后脚本以从安装项目复制并替换旧版本，但由于签入了旧安装文件，因此遇到了“拒绝访问”问题。

问题：

*   有没有更好的方法在 Web Deploy 发布中包含不属于项目的文件？
*   如果没有，有没有办法自动签出这些文件，以便可以使用批处理脚本覆盖它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:50:33.523

> 有没有更好的方法在 Web Deploy 发布中包含不属于项目的文件？

是的。Web 部署在部署（或打包）它们之前将您的 Web 应用程序的文件复制到一个临时文件夹。您最好的选择是挂钩该事件并将您的设置文件复制到临时目录结构中。

```
<!-- This goes in your publish profile (or ProjectName.wpp.targets if you don't 
     have the Azure SDK or VS 2012 installed) -->
<PropertyGroup>
  <PipelineCollectFilesPhaseDependsOn>
    CollectWindowsFormsApp;
    $(PipelineCollectFilesPhaseDependsOn);
  </PipelineCollectFilesPhaseDependsOn>
</PropertyGroup>

<Target Name="CollectWindowsFormsApp">
  <ItemGroup>
    <FilesForPackagingFromProject  Include="$(SolutionDir)YourWindowsFormsApp\bin\debug\YourWindowsFormsApp.msi">
      <DestinationRelativePath>App_Data\YourWindowsFormsApp.msi</DestinationRelativePath>
    </FilesForPackagingFromProject>
  </ItemGroup>
</Target> 
```

# laravel - 从 Laravel 的流畅查询构建器返回 mysql_insert_id 等效项

> ID：14488877
> 
> 赞同：1
> 
> 时间：2013-01-23T20:35:18.340
> 
> 标签：laravel

我正在使用 Laravel 的流畅查询生成器将一行插入到表中，并希望获取新插入的行的 id。例如，我通常会做类似的事情：

```
public static function next_id() {
    $con = self::getInstance();
    return (int)mysqli_insert_id($con);
} 
```

有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:40:18.423

好的，刚刚浏览了 \laravel\database\query.php 并在第 820 行，有一个名为的函数`insert_get_id($values, $column = 'id')`，其中第二个参数似乎返回任何列，但默认为 id！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T13:39:26.680

```
$id = DB::table('table_name')->insertGetId(
array('email' => 'john@example.com', 'votes' => 0));   return $id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T07:52:45.330

是的，它在文档[http://laravel.com/docs/database/fluent](http://laravel.com/docs/database/fluent) - 插入记录部分

# java - 如何从 Web 服务 REST 启动 GWT

> ID：14488880
> 
> 赞同：0
> 
> 时间：2013-01-23T20:35:26.497
> 
> 标签：java, web-services, rest, gwt

是否可以从 Web 服务 REST 运行 GWT 应用程序？

```
@Path("/main")
public class RestService {
  @GET
  @Path("{name}")
  public Response getUserByName(@PathParam("name") String name){

   // return Response.status(200).entity("My name is " + name).build();
  }
} 
```

对我来说重要的是，调用 REST 的 URL 在 GWT 运行后不得更改。因此，当浏览器转到时`localhost:8080/application/main/adam`，REST 运行并调用显示消息框的 GWT 应用程序`My name is adam`。之后，我可以在浏览器中看到相同的 URL。

也许我应该解释我的要求的原因。我想创建最终用户仅使用 URL 的应用程序，例如：

`localhost:8080/application/somecommand/somedata`

`localhost:8080/application/anothercommand/anotherdata`

没有窗口，没有表单，只有 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:43:02.080

对的，这是可能的。只需使用您的 GWT 应用程序提供 HTML 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:45:07.877

如果您可以像这样处理网址：

本地主机：8080/application#somecommand/somedata 本地主机：8080/application#anothercommand/anotherdata

它只是 GWT [History-API](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsHistory?hl=de)

# c - 重新分配三重指针

> ID：14488881
> 
> 赞同：0
> 
> 时间：2013-01-23T20:35:28.747
> 
> 标签：c, memory, realloc, calloc

嗨，我有一个三重指针，当我的原始数组被填满时，我想重新分配它。出于某种原因，我使用 realloc 的方式给了我一个段错误。有人知道为什么吗？

```
double ***matrixn;
matrixn=(double***) calloc(1,sizeof(double **));
for(i=0;i<1;i++){
    matrixn[i]=(double**)calloc(3,sizeof(double*));
    for(j=0;j<3;j++){
        matrixn[i][j]=(double*)calloc(4,sizeof(double));
    }
}

max_size=1 
```

下一部分发生在循环内：

```
max_size+=1;

matrixn=realloc(matrixn,max_size*sizeof(double**));
matrixn[max_size-1]=(double**)calloc(3,sizeof(double*));

for (i=0;i<3;i++){
matrixn[max_size-1]=(double*)calloc(4,sizeof(double));
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:38:34.607

在第二个代码块的循环中，您忘记了 index `i`。它应该看起来像

```
matrixn[max_size-1][i]=(double*)calloc(4,sizeof(double)); 
```

# c# - 对象被释放时如何使用 VS2012 进行调试？

> ID：14488882
> 
> 赞同：2
> 
> 时间：2013-01-23T20:35:29.277
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api, ninject, ravendb

我已经开始编写一个小的 ASP.NET MVC 4 项目。然而，到目前为止，还没有前端，因为我开始使用我的项目将公开的 API。API 是使用 Web API 的 API 控制器创建的。API 控制器访问存储在 Raven DB 数据库中的数据。使用 VS 2012 和 IIS Express 调试我的代码时，一切正常。在第一个请求期间，就是这样。在第二个请求中，Raven DB IDocumentStore 对象（即数据库连接对象）已被释放，我不知道它是如何发生的。

我使用 Ninject 将`IDocumentStore`对象注入到我的存储库对象中，并且 Ninject 的设置如下：

```
public class NinjectModule: Ninject.Modules.NinjectModule {
    readonly string _connStrName;

    IDocumentStore _store;

    public NinjectModule(string connStrName) {
        _connStrName = connStrName;
    }

    public override void Load() {
        _store = new DocumentStore { ConnectionStringName = _connStrName };
        _store.Initialize();

        Bind<IDocumentStore>().ToConstant(_store);
    }

    public override void Unload() {
        _store.Dispose();

        base.Unload();
    }
} 
```

被`IDocumentStore`设置在`Unload`方法中，但据我所知，该`Unload`方法永远不会被调用。

如果有人能告诉我为什么我`IDocumentStore`会被处理，那就太好了，但我会在它真正被处理时找到一种调试方法。我可以在处理特定对象时触发吗？

我已经非常仔细地检查`IDocumentStore`过，我的（仍然非常小的）代码库从未处理过该对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:38:45.927

我不确定这是否是问题所在，但 RavenDB`IDocumentStore`应该有一个单实例生命周期范围，而 a`IDocumentSession`应该有一个每个请求的范围。

我自己使用 AutoFac，但是快速搜索如何在 Ninject 中定义生命周期范围产生了[这个页面](https://github.com/ninject/ninject/wiki/Object-Scopes)。

请尝试`.InSingletonScope()`在适当的地方添加，`IDocumentStore`看看是否能解决问题。

如果您打算在会话中使用 Ninject，那么它看起来`.InRequestScope()`是合适的选项。

# javascript - 参考：电话中断

> ID：14488885
> 
> 赞同：1
> 
> 时间：2013-01-23T20:35:39.140
> 
> 标签：javascript, google-maps, twitter-bootstrap, google-fusion-tables

我有一张使用 Fusion Table 图层来提供联系信息的地图。我希望添加这个，以便可以从智能手机拨打联系信息。

```
<a href=tel:888-8888> 
```

但 FT 似乎不喜欢这样，因为每当我将它加载到我的服务器上时，它都会以 javascript.void(0) 的形式返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:10:09.737

不幸的是，我们目前不支持 tel: in info window 链接。您可能想在我们的[问题跟踪器](http://code.google.com/p/fusion-tables/)中添加功能请求。

# c# - 将用户名保存到会话属性中以帮助保护站点

> ID：14488887
> 
> 赞同：1
> 
> 时间：2013-01-23T20:35:45.457
> 
> 标签：c#, asp.net, session, session-variables

**编辑**有些人表示不喜欢我在这个问题中提出的特定解决方案，但请不要浪费我的时间来建议完全替代的方法。我无法控制我正在从事的工作的要求。如果您不同意并且没有答案，请继续前进。谢谢。

对于初学者来说，这是一个实践项目，不会被公众使用。我需要使用用户名的会话属性来保护我网站中的某些页面。当输入正确的用户名和密码组合时，会发生这种情况（用户名保存到会话中）。老板看了我的实现说“直接把用户名值存入HttpSessionState是不对的，你应该设置session的username属性，把session对象存入HttpSessionState”。现在我想我明白他指的是我的代码的哪些部分，但是更改它会破坏安全性（一旦单个用户登录，任何人都可以使用指向页面的直接链接）。

确保阅读代码中的注释，我添加它们来描述有问题的行。

什么在安全方面起作用，但用户名直接存储在 HttpSessionState 中：

```
//login.ascx.cs
private void Login_Click(object sender, EventArgs e)
{
   if (sender == null || e == null)
   {
      throw new ArgumentNullException("Null Exception: Login_Click");
   }

   User user = new User();            
   user.Login(_username.Text, _password.Text);           

   if (user.IsValid() && user.GetIsUser() != false)
   {
      user.Save();
      //the line below is what I used to make the secure pages work properly.
      //but based on what my boss says, I think this is what should be changed.
      Session["Username"] = _username.Text;
      //What i tried instead was to set 'MySession.Current.Username = _username.Text;'
      //which allowed successful login, but the pages became insecure once again.
      Response.Redirect("Secure/Default.aspx");
   }
   else
   {
      DisplayErrors(user._validationErrors);
   }
   _errors.Text = errorMessage;    
} 
```

和 MySession.cs

```
public string Username
{
   get
   {
      if (HttpContext.Current.Session["Username"] == null)
      {
         return string.Empty;
      }
      else
      {
         return HttpContext.Current.Session["Username"].ToString();
      }
   }
   set
   {
      //when the line below is uncommented, the secure pages are vulnerable
      //but if I comment it out, they work properly.
      //HttpContext.Current.Session["Username"] = value;
   }
} 
```

那么我怎样才能`Set the username property of the session, and store the session object into the HttpSessionState`在保持安全站点的同时呢？

编辑：@Win，在 Secure/Default.aspx.cs 中

```
private void Page_load(object sender, System.EventArgs e)
{
   ...
   if((string)Session["Username"] != _labelusername.Text)
   {
      Response.Redirect(redirectLogin); //to login page
   } 
   else {} //success
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:43:06.687

你应该调查一下`FormsAuthentication`。网上有很多这样的例子：

[http://bradkingsley.com/securing-asp-net-pages-forms-authentication-c-and-net-4/](http://bradkingsley.com/securing-asp-net-pages-forms-authentication-c-and-net-4/)

# php - 函数内的 PHP mysql_close 阻止数据库查询在页面上工作

> ID：14488892
> 
> 赞同：-2
> 
> 时间：2013-01-23T20:35:54.307
> 
> 标签：php, mysql, function

我有一个引用包含文件以获取数据库信息的 PHP 页面。同一页面与数据库交互，最后我有一个`mysql_close($db_connect)`声明。

但是，我还有一个在代码中间引用的函数。该函数位于单独的包含文件中，并且还使用数据库。我`mysql_close($db_connect)`在包含文件中也有声明。

我遇到的问题是函数执行后在主页上发生的任何数据库调用都会失败，因为数据库连接已关闭。我知道这可能是一个新手问题，但我是否应该不关闭包含文件中的数据库连接，或者我是否以错误的方式处理这一切？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:37:51.030

理想情况下，您应该只在开始时连接到数据库一次，然后在最后手动关闭它，或者让脚本的关闭序列结束连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:39:21.677

mysql_close() 关闭与指定链接标识符关联的 MySQL 服务器的非持久连接。

通常不需要使用 mysql_close()，因为非持久打开的链接会在脚本执行结束时自动关闭。

查看下面的链接： [http ://www.php.net/manual/en/language.types.resource.php#language.types.resource.self-destruct](http://www.php.net/manual/en/language.types.resource.php#language.types.resource.self-destruct)

我希望这有帮助

# c# - 避免重复列表项

> ID：14488908
> 
> 赞同：0
> 
> 时间：2013-01-23T20:37:16.130
> 
> 标签：c#, validation, combobox, listbox

我有一个`ListBox`包含项目的项目，我从`ComboBox`. 当我从我的 中选择一个项目时`ComboBox`，它也会从我的`ComboBox`.

我的表单上有一个按钮，让我复制我的选定项目`ListBox`，给我两个相同的项目`ListBox`。

我的表单上还有一个按钮，可以让我从我的`ListBox`. 如果我从 中删除一个项目`ListBox`，该项目将返回到`ComboBox`，但如果我复制了该项目并且我从 中删除了两个项目`ListBox`，它们都会显示在`ComboBox`.

**我不希望有两个相同的项目在`ComboBox`**

这是我尝试使用的代码：

```
private void buttonRemove_Click(object sender, EventArgs e)
    {
        try
        {
            if (ComboBox.ToString().Contains("Chicken McNuggets"))
            {
                found = true;
            }
            if (!found)
            {
                ComboBox.Items.Add("Chicken McNuggets");
                found = false;
            }
            ListBox.Items.Remove(ListBox.SelectedItem);
        }
        catch
        {
            MessageBox.Show(// Message);
        }
    } 
```

这是我第一次在这里提问。

编辑：

```
private void buttonRemove_Click(object sender, EventArgs e)
        {
            try
            {
                if ((String)listBox.SelectedItem == "Big Mac" || (String)listBox.SelectedItem == "Quarter Pounder" || (String)listBox.SelectedItem == "McFeast" || (String)listBox.SelectedItem == "Cheeseburger" || (String)listBox.SelectedItem == "Hamburger" || (String)listBox.SelectedItem == "Big Tasty Bacon" || (String)listBox.SelectedItem == "McChicken" || (String)listBox.SelectedItem == "Fillet-O-Fish" || (String)listBox.SelectedItem == "Chicken Nuggets")
                {
                    comboBox.Items.Add(listBox.SelectedItem);
                    listBox.Items.Remove(listBox.SelectedItem);
                }
                else if ((String)listBox.SelectedItem == "BBQ dip" || (String)listBox.SelectedItem == "Cheddar dip" || (String)listBox.SelectedItem == "Gulerod" || (String)listBox.SelectedItem == "Hvidløgs dip" || (String)listBox.SelectedItem == "Karry dip" || (String)listBox.SelectedItem == "Ketchup" || (String)listBox.SelectedItem == "Pommes Frites Sauce" || (String)listBox.SelectedItem == "Sennep dip" || (String)listBox.SelectedItem == "Sursød dip" || (String)listBox.SelectedItem == "Æbler")
                {
                    comboBox2.Items.Add(listBox.SelectedItem);
                    listBox.Items.Remove(listBox.SelectedItem);
                }
                else if ((String)listBox.SelectedItem == "Gulerodskage" || (String)listBox.SelectedItem == "Kanelsnegl" || (String)listBox.SelectedItem == "McDonut chokolade" || (String)listBox.SelectedItem == "Sundae m. chokoladesauce" || (String)listBox.SelectedItem == "McDonut sukkerovertræk" || (String)listBox.SelectedItem == "McFlurry Daim" || (String)listBox.SelectedItem == "McFlurry Smarties" || (String)listBox.SelectedItem == "Sundae m. jordbærdsauce" || (String)listBox.SelectedItem == "Sundae m. karamelsauce" || (String)listBox.SelectedItem == "Triple chokolade muffin" || (String)listBox.SelectedItem == "Vaffelis")
                {
                    comboBox3.Items.Add(listBox.SelectedItem);
                    listBox.Items.Remove(listBox.SelectedItem);
                }
                else if (listBox.SelectedItem.ToString().Contains("Stor") || listBox.SelectedItem.ToString().Contains("Mellem") || listBox.SelectedItem.ToString().Contains("Lille") || listBox.SelectedItem.ToString().Contains("9") || listBox.SelectedItem.ToString().Contains("6") || listBox.SelectedItem.ToString().Contains("4"))
                {
                    string objectToString = listBox.SelectedItem.ToString();
                    string[] ord = objektToString.Split(' ');
                    string selectedItem = listBox.SelectedItem;

                    var check = comboBox.Items.Cast<string>()
                         .ToList()
                         .FirstOrDefault(c => c.Contains(selectedItem));
                    if (check != null)
                    {
                        comboBox.Items.Add("Chicken McNuggets");
                    }
                    else
                    {
                        listBox.Items.Remove(selectedItem);
                    }
                    if (listBox.SelectedItem.ToString().Contains("Pommes Frites"))
                        comboBox2.Items.Add(ord[1] + " " + ord[2]);
                    else if (listBox.SelectedItem.ToString().Equals("Stor Coca-Cola") || listBox.SelectedItem.ToString().Equals("Mellem Coca-Cola") || listBox.SelectedItem.ToString().Equals("Lille Coca-Cola"))
                        comboBox4.Items.Add(ord[1]);
                    else if (listBox.SelectedItem.ToString().Contains("Milkshake"))
                        comboBox4.Items.Add(ord[1] + " " + ord[2] + " " + ord[3]);
                    else
                        comboBox4.Items.Add(ord[1] + " " + ord[2]);
                    listBox.Items.Remove(listBox.SelectedItem);
                }
            }
            catch
            {
                MessageBox.Show(// Message);
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:08:01.730

我们需要[**Cast**](http://msdn.microsoft.com/en-us/library/ms173105.aspx)到**`string`**来自的项目，`ComboBox`以便我们现在可以轻松地检查`ListBox.SelectedItem`已经来自的项目`ComboBox.Items`。

```
 private void buttonRemove_Click(object sender, EventArgs e)
    {
        try
        {
            string selectedItems = listBox1.SelectedItem.ToString();

            var check = comboBox1.Items.Cast<string>()
                 .ToList()
                 .FirstOrDefault(c => c.Contains(selectedItems));

            if (check != null)
            {

            }
            else
            {
                comboBox.Items.Add("Chicken McNuggets");
                listBox1.Items.Remove(selectedItems);
            }
        }
        catch
        {
            //MessageBox.Show();
        }
    } 
```

# visual-studio-2010 - 我可以使用 VS2012 打开旧的 VS 版本项目而不进行任何更改吗？

> ID：14488909
> 
> 赞同：0
> 
> 时间：2013-01-23T20:37:18.627
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, visual-studio-2005

我可以使用 VS2012 打开旧的 VS 版本项目而不进行任何更改吗？

我刚开始使用 VS2012，在大学里我总是使用 VS2010，我刚刚开始与一家新公司合作，他们在大多数项目中使用 2005。

我想知道是否有一种方法可以在不更改任何内容的情况下使用 VS2012 或 VS2010，所以我的（同事不需要更改任何内容）

注意：到目前为止，他们没有使用 TFS，但如果他们安装一个，它必须是 2010 cus 是其他团队使用的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T04:38:40.703

是的，当然：您只需在第一个 Visual Studio 对话框中告诉您不想转换 VS 2010 项目，就可以了！

# mysql - 当值为 NULL 时删除 SQL 输出

> ID：14488910
> 
> 赞同：0
> 
> 时间：2013-01-23T20:37:25.073
> 
> 标签：mysql, sql

下面的 SQL 查询对我有用，但是当 staffNo 为空 6 次（每个工作人员一次）时，它返回属性值。即使 staffNo 为空，我也想归还财产所有者，没有 6 个回报。

```
SELECT s.branchNo, s.staffNo, s.fName, s.lName, propertyNo, p.staffNo,
       o.fName, o.lName, o.ownerNo
  FROM staff s, propertyforrent p, privateowner o
 WHERE s.staffNo = p.staffNo AND o.ownerNo = p.ownerNo
    OR p.staffNo IS NULL     AND o.ownerNo = p.ownerNo
 ORDER BY s.branchNo, s.staffNo, propertyNo 
```

结果

```
B003    SG14    David   Ford    PG16    SG14    Tony    Shaw    CO93
B003    SG14    David   Ford    PG4     NULL    Tina    Murphy  CO40
B003    SG37    Ann     Beech   PG21    SG37    Carol   Farrel  CO87
B003    SG37    Ann     Beech   PG36    SG37    Tony    Shaw    CO93
B003    SG37    Ann     Beech   PG4     NULL    Tina    Murphy  CO40
B003    SG5     Susan   Brand   PG4     NULL    Tina    Murphy  CO40
B005    SL21    John    White   PG4     NULL    Tina    Murphy  CO40
B005    SL41    Julie   Lee     PG4     NULL    Tina    Murphy  CO40
B005    SL41    Julie   Lee     PL94    SL41    Carol   Farrel  CO87
B007    SA9     Mary    Howe    PA14    SA9     Joe     Keogh   CO46
B007    SA9     Mary    Howe    PG4     NULL    Tina    Murphy  CO40 
```

这是想要的结果

```
B003    SG14    David   Ford    PG16    SG14    Tony    Shaw    CO93
B003    SG14                    PG4     NULL    Tina    Murphy  CO40
B003    SG37    Ann     Beech   PG21    SG37    Carol   Farrel  CO87
B003    SG37    Ann     Beech   PG36    SG37    Tony    Shaw    CO93
B005    SL41    Julie   Lee     PL94    SL41    Carol   Farrel  CO87
B007    SA9     Mary    Howe    PA14    SA9     Joe     Keogh   CO46 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:51:44.530

使用左连接可能会有所帮助

```
SELECT s.branchNo, s.staffNo, s.fName, s.lName, propertyNo, p.staffNo,
       o.fName, o.lName, o.ownerNo
  FROM privateowner o
  LEFT JOIN propertyforrent p ON o.ownerNo = p.ownerNo
  LEFT JOIN staff s ON s.staffNo = p.staffNo

 ORDER BY s.branchNo, s.staffNo, propertyNo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:56:02.107

试试这个：

```
SELECT s.branchNo, s.staffNo, s.fName, s.lName, propertyNo, p.staffNo,
       o.fName, o.lName, o.ownerNo
  FROM staff AS s LEFT JOIN propertyforrent AS p
  ON s.staffNo = p.staffNo AND  p.staffNo IS NOT NULL
  LEFT JOIN privateowner AS o
 ORDER BY s.branchNo, s.staffNo, propertyNo; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T20:56:45.317

希望这是正确的..

```
SELECT s.branchNo, s.staffNo, s.fName, s.lName, propertyNo, p.staffNo, o.fName, o.lName, o.ownerNo
FROM staff s 
join propertyforrent p on s.staffNo = p.staffNo
left join privateowner o on o.ownerNo = p.ownerNo
where p.staffNo is not null
ORDER BY s.branchNo, s.staffNo, propertyNo 
```

大卫福特下的空白栏是故意的吗？

# angularjs - 将计算字段添加到 AngularJS 模型中数组的每个元素

> ID：14488912
> 
> 赞同：3
> 
> 时间：2013-01-23T20:37:30.687
> 
> 标签：angularjs

我正在从 JSON 数据源将一组用户拉入我的 AngularJS 模型。此数据正在表中呈现，我想创建一个根据现有用户对象的两个值计算的列，而不修改我的基础数据服务。

```
// My model
function UserListCtrl($scope,$http) {
$http.get('users').success(function(data) {
    $scope.users = data;
});
}; 
```

在我的部分模板中，我知道我可以这样做：

```
 <tr ng-repeat="for user in users">
    <td>{{user.data / user.count | number:2}}</td>
 </td> 
```

但我宁愿将该字段添加到模型中，这样我就可以像这样使用它：

```
<td>{{user.amplification}}</td> 
```

如何将“放大”字段添加到模型中的每个用户？

顺便说一句，是否可以在这样的`orderBy`事情上使用过滤器：

```
<td>{{user.data / user.count | number:2}}</td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:05:12.923

你可以吃：

1.  在加载用户之后执行：

    $http.get('users').success(function(data) { $scope.users = data; $scope.user.amplification() = function() { return $scope.user.data / $scope.user.数数; } }）;

并用作`{{user.amplification()}}`

1.  控制器的任何位置：

    $scope.$watch('user', function() { $scope.userAmplification = $scope.user.data / $scope.user.count; }, true); $http.get

2.  或者如果 user.data/count 不变，则与 1 相同，但静态计算：

    $http.get('users').success(function(data) { $scope.users = data; $scope.user.amplification = $scope.user.data / $scope.user.count; });

并且`OrderBy`可以用于任何表达式（不包括其他过滤器的结果）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-24T21:09:15.427

如果您不需要`amplicification()`在更新时更新函数`data`和`count`属性`user`，则可以在控制器中执行以下操作：

```
$scope.users.forEach(function(user) {

    user.amplification = function() {

        return user.data / user.count;

    };

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-26T19:29:07.663

添加第二个答案，因为它与我的第一个不同，因此我认为它是合适的。

环顾四周后，我发现如果您尝试动态添加新行或依赖于计算值的数组中添加新元素，我最初发布的方法就会失败。这是因为`$scope.array.forEach()`只有在创建控制器时才会运行。

解决此问题的最佳方法是创建一个`object`包含您想要的选项的正确定义。例如

```
function Task(id, name, prop1, prop2) {

    this.id = id;
    this.name = name;
    this.prop1 = prop1;
    this.prop2 = prop2;

    this.computedProperty = function () {

        return this.prop1 + this.prop2;

    };  

} 
```

这更加灵活，因为创建的每个新对象都将具有新属性。

唯一的缺点是在您的 ajax 成功回调中，您需要将每个用户传递给您的“Users()”构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-28T11:17:20.293

对我有用的是添加一个循环并将属性添加到该循环中的每个项目。我使用了控制器的一个属性，但我相信您可以按照您在问题中接近它的方式使用范围。

```
function(result) {
    self.list = result;
    angular.forEach(self.list, function(item) {
        item.hasDate = function() {
            return this.TestDate != null;
        }.bind(item); // set this context 
    });
} 
```

然后在我的标记中，我只是这样使用它。

```
<div ng-repeat...>
    <div ng-show="item.hasDate()">This item has a date.</div>
</div> 
```

# javascript - 使用 Javascript 在鼠标悬停时向各个方向平移背景图像

> ID：14488913
> 
> 赞同：2
> 
> 时间：2013-01-23T20:37:33.480
> 
> 标签：javascript, html, panning

我正在尝试为页面中的背景图像添加平移效果，图像非常大 1800 x 1067 ，所以基本上会大于我想在鼠标到达窗口末尾时向各个方向平移背景的窗口只是，我找到了一个 Javascript 代码，它可以进行平移，但只是水平的，尝试使用它来启用垂直平移。没用。

这是 JSFiddle 上的代码：http: [//jsfiddle.net/v662t/](http://jsfiddle.net/v662t/)

// HTML

```
<div id="pageBg">
</div> 
```

//CSS

```
#pageBg {
    background: url(images/pageBg.jpg) no-repeat 0 0 scroll;
    background-size: cover;
    height: auto;
    left: 0;
    min-height: 768px;
    min-width: 1024px;
    overflow: hidden;
    position: fixed;   
    top: 0;
    width: 100%;
} 
```

// Javascript

```
$(document).ready(function(){
   $('#pageBg').mousemove(function(e){
      var mousePosX = (e.pageX/$(window).width())*100;
      $('#pageBg').css('background-position-x', mousePosX +'%');
   }); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:58:10.993

为 mousePosY删除`background-size: cover`并添加一些 javascript 行：

```
var mousePosY = (e.pageY/$(window).height())*100;
$('#pageBg').css('background-position-y', mousePosY +'%'); 
```

在这里查看工作小提琴：http: [//jsfiddle.net/georgedyer/XWnUA/2/](http://jsfiddle.net/georgedyer/XWnUA/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T14:35:27.803

我在这里回答关于在边缘平移以包括更好的格式的评论。

这取决于您希望在边缘平移的*确切程度。*仅当鼠标在边缘上移动时，图像才会移动，或者即使鼠标静止但悬停在边缘上时，图像也会移动吗？

在第一种情况下：您可以使用相同的小提琴代码，然后检查`mousePosX`or`mousePosY`是否 < 10 或 > 90（或您想要定义为边缘的任何百分比）。如果是这样，那么不是将图像移动到窗口的百分比，而是将其移动到边缘的百分比。

由于这可能最终有点过于敏感，因此您可以选择仅在悬停上移动，在这种情况下，您将使用`mouseEnter`and事件，然后在(using )`mouseLeave`上开始一个间隔，将背景图像移动一个像素，然后清除那个区间 ( ) on 。`mouseEnter``var interval = setInterval(moveImage,250);``clearInterval(interval);``mouseLeave`

我会把它留给你自己编辑[小提琴](http://jsfiddle.net/georgedyer/XWnUA/2/)，看看你是否可以让它按你想要的方式工作。

# javascript - 标头固定中的偏移量未定义

> ID：14488916
> 
> 赞同：0
> 
> 时间：2013-01-23T20:37:50.567
> 
> 标签：javascript, jquery, undefined

我现在有一个代码来修复我的表格的标题，它工作正常。但是这个函数有一个警告：

```
Error: TypeError: $(...).offset(...) is undefined 
```

我的代码（我使用引导程序）：

```
function goheadfixed(classtable) {
$(classtable).wrap('<div class="fix-inner">'); 
$('.fix-inner').wrap('<div class="fix-outer" style="position: relative;"></div>'); //this is relative cause the header will be absolute
$('.fix-outer').append('<div class="fix-head"></div>');
$('.fix-head').prepend($('.fix-inner').html()); // agrego la tabla
$('.fix-head table').find('caption').remove();
//$('.fix-head table').removeAttr('style');
$('.fix-head table').css('width','100%');

$('.fix-head').css('width', $('.fix-inner table').outerWidth(true)+'px');
$('.fix-head').css('height', $('.fix-inner table thead').outerHeight(true)+'px');

var ithead = parseInt($('.fix-inner table thead').offset().top);
var divfix = parseInt($('.fix-inner').offset().top);
var itop = ithead-divfix;

$('.fix-head').css({'position':'absolute', 'overflow':'hidden', 'top': itop+'px', 'left':0, 'z-index':100 });

$(window).scroll(function () {
    var vscroll = $(window).scrollTop();

    if(vscroll >= ithead)
        $('.fix-head').css('top',(vscroll-divfix)+'px');
    else
        $('.fix-head').css('top', itop+'px');
});

/*  If the windows resize   */
$(window).resize(goresize);
}

function goresize() {
$('.fix-head').css('width', $('.fix-inner table').outerWidth(true)+'px');
$('.fix-head').css('height', $('.fix-inner table thead').outerHeight(true)+'px');
} 
```

我调用我的函数：

```
goheadfixed('table.fixed'); 
```

然后，当我将其他代码 javascript 放在下面时，我的代码不起作用，但是放在上面时，它可以正常工作！：

如何删除此警告？

**编辑（添加作为答案发布的详细信息）**：哦。对不起，我忘了说“警告”只有在我不使用该功能时才会出现。

如果我调用函数 goheadfixed('table.fixed'); 好的，但是如果我不调用这个函数，就会显示警告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:02:30.937

在第 14 行，`$('.fix-inner table thead')`指的是不存在或隐藏的元素。听起来好像您至少找到了一个带有`display:none`集合的元素，因此它返回了一个未定义的数字。

`$("thead:visible")`要解决此问题，您可以为每个元素添加可见选择器。

# actionscript-3 - 动态 xml 文本和图像不会在 Flash 中刷新

> ID：14488918
> 
> 赞同：2
> 
> 时间：2013-01-23T20:37:55.357
> 
> 标签：actionscript-3, flash, caching

我有一个简单的 Flash 登录页面，它有 2 个动态旋转图像的区域和 2 个动态文本区域。所有区域都由单个 XML 文件控制。

当我对 XML 文件中的文本内容进行更改时，或者如果我更新文件夹中的图像并在我的 adobe flash 编辑器中进行测试，这些更改是即时的。当我打开 Firefox 或 IE 时，带有 flash 文件的页面不会反映更新。我已经删除了我的历史记录，告诉 adobe flash 不允许在我的计算机上存储任何 flash，关闭并重新加载页面但无济于事。我可以刷新内容的唯一方法是重命名文件，保存在新文件夹中并重命名它从中提取的 xml 页面。我什至在末尾添加了 kiosk.swf?id=#randrange(10000,99999)# 字符串，看看它是否让浏览器认为它是一个新文件。只要重命名和移动文件/文件夹，浏览器就会显示新内容。

这个简单的 Flash 页面将成为信息亭的登录页面。

```
 <style type="text/css" media="screen">
        body { margin:0; padding:0; overflow:hidden;background-color:#153d6f; }
        #myID   { height:100%;background-color:#153d6f; }
    </style>    
    <script type="text/javascript" src="swfobject.js"></script>
    <script type="text/javascript" src="swffit.js"></script>
   <cfoutput>
       <script type="text/javascript">
            swfobject.embedSWF("kiosk.swf?id=#randrange(10000,99999)#", "myID", "100%", "100%", "9.0.0", "expressInstall.swf");
            swffit.fit("myID");
        </script>
   </cfoutput> 

</head>
<body>
    <div id="myID"></div>
</body> 
```

...................根据您的要求，将动态图像拉到两个区域之一的 actionscript3 ...... ……

```
import fl.transitions.Tween;
import fl.transitions.easing.*;
import fl.transitions.TweenEvent;

var my_speed:Number;
var my_total:Number;
var my_images:XMLList;

var my_loaders_array:Array = [];
var my_success_counter:Number = 0;
var my_playback_counter:Number = 0;

var my_slideshow:Sprite = new Sprite();
var my_image_slides:Sprite = new Sprite(); 

var my_timer:Timer;
var my_prev_tween:Tween; 

var my_xml_loader:URLLoader = new URLLoader();
my_xml_loader.load(new URLRequest("content.xml")); 
my_xml_loader.addEventListener(Event.COMPLETE, processXML);

function processXML (e:Event):void{
    var my_xml:XML = new XML(e.target.data); 
    my_speed=my_xml.option2.slideShow2.@SPEED;
    my_images=my_xml.option2.slideShow2.IMAGE;
    my_total=my_images.length();    

    loadImages();
}

function loadImages():void{
    for (var i:Number = 0; i < my_total; i++){
        var my_url:String = my_images[i].@URL;
        var my_loader:Loader = new Loader();
        my_loader.load(new URLRequest(my_url));
        my_loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);
        my_loaders_array.push(my_loader); 
    }
}

function onComplete(e:Event):void{
    my_success_counter++;
    if (my_success_counter == my_total){
        startShow();
    }

}  

function startShow():void{
    addChild(my_slideshow);
    my_slideshow.addChild(my_image_slides);

    setChildIndex(my_slideshow,0);

    nextImage();

    my_timer = new Timer(my_speed*1000);
    my_timer.addEventListener(TimerEvent.TIMER, timerListener);
    my_timer.start();

}

function nextImage():void{
    var my_image:Loader = Loader(my_loaders_array[my_playback_counter]);
    my_image_slides.addChild(my_image);
    //my_image.x = (stage.stageWidth - my_image.width)/2;
    //my_image.y = (stage.stageHeight - my_image.height)/2;

    if (my_image.width == my_image.height) {
        my_image.width = 305;
        my_image.height = 305;
    }   else if( my_image.width > my_image.height ) {
            var newWidth = (my_image.width *(305 / my_image.height));
            my_image.height = 305;  
            my_image.width = newWidth;
    }   else if( my_image.width < my_image.height ) {
            var newHeight = (my_image.height *(305 / my_image.width));
            my_image.width = 305;   
            my_image.height = newHeight;

    }

    my_image.x = 80;
    my_image.y = -140;

    new Tween(my_image,"alpha",Strong.easeOut,0,1,1,true); 

} 

function timerListener (e:TimerEvent):void{
    hidePrev();

    my_playback_counter++;
    if (my_playback_counter == my_total){
        my_playback_counter =0;
    }

    nextImage();

} 

function hidePrev():void{
    var my_image:Loader=Loader(my_image_slides.getChildAt(0));
    my_prev_tween = new Tween(my_image,"alpha",Strong.easeOut,1,0,1,true);
    my_prev_tween.addEventListener(TweenEvent.MOTION_FINISH, onFadeOut)

    new Tween(my_image,"alpha",Strong.easeOut,1,0,1,true);

} 

function onFadeOut(e:TweenEvent):void{
    my_image_slides.removeChildAt(0);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:08:17.030

为避免在动作脚本中缓存，请添加“？” 然后在您正在加载的项目的 URL 末尾添加一些唯一字符（无论是图像、swfs、xml 等）。例如：

```
var cacheBuster:String = "?"+(new Date()).time.toString();
my_loader.load(new URLRequest(my_url+cacheBuster)); 
```

new Date().time 返回自 1970 年 1 月 1 日以来的毫秒数，因此它是生成唯一字符串的不错选择。

如果它的 kiosk.swf 是缓存，则 javascript 非常相似：

```
var cacheBuster = "?"+(new Date()).getTime().toString();
swfobject.embedSWF("kiosk.swf"+cacheBuster, .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:54:36.257

有关文本的信息，请访问[此处](http://www.virtualmv.com/wiki/index.php?title=Flash10%3aActionScript2%3aImporting_XML_into_Dynamic_Text_Boxes)

有关如何刷新图像，请访问[此处](http://www.republicofcode.com/tutorials/flash/as3slideshow/)

希望这可以帮助！

# javascript - 从回调函数内部获取变量值

> ID：14488924
> 
> 赞同：1
> 
> 时间：2013-01-23T20:38:07.963
> 
> 标签：javascript

我正在尝试从回调函数中提取变量的值。我在这里做错了什么？

```
var storyList = [];
var storyTemp ={};

// get list of all stories
db.getAllStoriesSet(function(err, reply) {
    if (err) throw err;
    else {
        storyList = reply;
        console.log("storylist inner: " + storyList);
    };
});
console.log("storylist outer: " + storyList); 
```

在上面的代码中，我期望内部和外部故事列表值相同。但是外部 storyList 值仍然是一个空列表。

编辑：添加到问题中。我已经在异步函数之外初始化了一个变量 storyList。然后我从异步函数中获取回复并将其放入变量故事列表中。我希望从我显然为自己挖的缓慢而残酷的死亡的异步深坑中作弊。它不应该起作用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:39:51.297

如果`getAllStoriesSet`是异步的，则在执行回调之前调用其调用之后的行。`storyList`就像打电话之前一样。

这就是您提供回调的原因：您必须在回调中放入需要`reply`.

# domain-driven-design - 外部对象是否应该通过调用...对内部实体执行操作？

> ID：14488931
> 
> 赞同：1
> 
> 时间：2013-01-23T20:38:32.970
> 
> 标签：domain-driven-design

1) a)*聚合*内的*实体*只能通过*聚合根*访问。虽然*根可以将对**内部实体的临时引用*传递给*外部对象*（在单个操作期间），但我假设在大多数情况下，如果*外部对象*需要对*内部实体*执行某些操作，它应该调用方法（s ）在*聚合根*上定义（人为的例子- ）？********`Order.SetOrderLineTitle(...)`********

 ***2）只能直接获得*AGGREGATE根。*所有其他对象必须通过*关联的遍历*找到。

a) 当我们说*外部对象*应该通过关联的*遍历来访问**非根实体*时，我们的意思是它们应该调用*聚合根*（例如）上的方法，这反过来将对*内部对象*执行操作，还是我们的意思是*聚合根*应该将对*内部实体的引用*传递给*外部对象*或两者兼而有之？**`Order.SetOrderLineTitle(...)`**

 ***谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T22:24:16.483

1) 是的，这是聚合体保持其完整性的最佳方式。有人说这可能导致聚合具有非常多的方法，但是在这种情况下可能有多个聚合在起作用。

2) 理想情况下，聚合将在不传递引用的情况下执行所需的操作。在某些情况下，传递引用是有意义的，但这应该谨慎实施，因为它会使关于完整性的推理变得更加困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T10:01:03.593

> 我假设在大多数情况下，如果外部对象需要对内部实体执行一些操作，它应该调用在聚合根上定义的方法

只是为了对此略有不同，也可以使用相反的方法。**在大多数情况下**，向聚合根添加方法会迫使您将域划分为非常小的聚合，以免根变得臃肿，违反 SRP。这种切片可能是以牺牲聚合的自然业务凝聚力为代价的。

相反，您可以决定，**在大多数情况下**，您将让外部对象获得对内部实体的临时引用，并根据需要操作它们。**在极少数情况下**，尤其是那些意味着强制跨多个实体的不变量的情况下，直接在根上实现这些操作会是一个更好的主意。

这种方法在这里讨论：[https ://groups.google.com/forum/#!topic/dddcqrs/mtGanS39XYo](https://groups.google.com/forum/#!topic/dddcqrs/mtGanS39XYo)

> 我看到的方式是虽然聚合根负责其中实体的生命周期，但这并不意味着它应该是对聚合中任何项目调用的所有方法的专有接口（除了返回特定实体） .

总体而言，最终决定将取决于您是想主要考虑域/功能内聚性来设计聚合，还是首先要将它们视为事务保障。******

# c# - 推荐的任务异常处理代码是否同步任务？

> ID：14488934
> 
> 赞同：0
> 
> 时间：2013-01-23T20:38:35.183
> 
> 标签：c#, multithreading, exception-handling, task-parallel-library

它看起来像 MSDN 上用于处理任务中引发的异常的模式同步代码。这是来自[MSDN 页面](http://msdn.microsoft.com/en-us/library/dd997415.aspx)的代码：

```
var task1 = Task.Factory.StartNew(() =>
{
    throw new MyCustomException("I'm bad, but not too bad!");
});    
try
{
    task1.Wait();
}
catch (AggregateException ae)
{
    // Code removed
} 
```

该调用`task1.Wait();`导致调用线程阻塞，直到 task1 完成，对吗？如果是这样，那么我根本看不到使用 Task 的理由，因为无论是使用 Task 同步调用还是异步调用代码，调用线程都会阻塞，直到代码完成运行或抛出异常。

另外，如果 task1 在调用代码进入 try-catch 块之前抛出异常会发生什么？如果可能，try-catch 块将不会捕获 AggregateException。

如果我希望调用线程被通知任务中引发的异常，我应该怎么做？我认为我不应该打电话`task1.Wait();`来收到异常通知。我知道，`ContinueWith()`但代码也在`ContinueWith()`一个单独的线程中运行，而不是调用线程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:34:03.147

> 调用 task1.Wait(); 导致调用线程阻塞，直到 task1 完成，对吗？如果是这样，那么我根本看不到使用 Task 的理由，因为无论是使用 Task 同步调用还是异步调用代码，调用线程都会阻塞，直到代码完成运行或抛出异常。

正确的。但是您可以在调用该`Wait()`方法之前在调用线程上做任何您需要的事情（例如启动其他任务或执行一些操作）。

> 另外，如果 task1 在调用代码进入 try-catch 块之前抛出异常会发生什么？如果可能，try-catch 块将不会捕获 AggregateException。

异常将被捕获并在内部存储。然后，当您`Wait()`在任务实例上调用该方法时，原始异常将被包装`AggregateException`并传播到调用线程。

# jquery - 链接到 Zurb Foundation 中的特定选项卡（URL 哈希链接）

> ID：14488938
> 
> 赞同：0
> 
> 时间：2013-01-23T20:38:44.467
> 
> 标签：jquery, zurb-foundation

显然，Zurb Foundation 中的深层链接已被删除，因此本机无法链接到站点上其他位置的选项卡。我希望有人可以帮助我解决方法？

这是我的标签页的 HTML 代码：

```
<dl class="tabs">
    <dd class="active"><a href="#one">Tab 1</a></dd>
    <dd><a href="#two">Tab 2</a></dd>
    <dd><a href="#three">Tab 3</a></dd>
    <dd><a href="#four">Tab 4</a></dd>
</dl> 
```

对于标签内容：

```
<ul class="tabs-content">
    <li id="oneTab" class="active">
        [content]
    </li>

    <li id="twoTab">
        [content]
    </li>

    <li id="threeTab">
        [content]
    </li>

    <li id="fourTab">
        [content]
    </li>

</ul> 
```

我尝试链接到选项卡的 URL（位于站点的页脚中）：

```
http://domain.com/path/to/page#four
http://domain.com/path/to/page#fourTab 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T21:22:22.653

深度链接在 3.2.3 中被设置为默认参数。如果您下载最新版本 3.2.4，您的深层链接应该可以正常工作。

如果您不想将所有 Foundation（尽管我建议您保持最新）更新到最新版本，您可以从存储库下载最新版本的 Tabs：[jquery.foundation.tabs.js](https://github.com/zurb/foundation/blob/master/vendor/assets/javascripts/foundation/jquery.foundation.tabs.js)并替换这个旧标签。

在 3.2.4 中，如果要禁用深度链接，则必须`deep_linking`在初始化插件时显式设置为 false。

```
$(document).foundationTabs({deep_linking: false}); 
```

# ruby-on-rails - 魔法重定向错误

> ID：14488939
> 
> 赞同：1
> 
> 时间：2013-01-23T20:38:47.723
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sorcery

用户想在 domain.com/users/new 上注册，但是用户不小心按了“enter”并且所有字段都填空了。现在问题来了。我有两个选择。如果我删除...

```
...else
redirect_to new_user_path
end 
```

用户将自动被重定向到 domain.com/users（在填写空白字段后），并且注册字段错误将很好地显示在表单上方。

但是，如果我在上面添加该代码而不是删除它，用户将被重定向到相同的链接 - 这意味着 /users/new 不幸的是，用户不会很好地显示他的表单错误，它们实际上根本不会显示。为什么错误出现在 domain.com/users 而不是 domain.com/users/new？

# mysql - 如何获取没有模型的表的 ActiveRecord 查询的结果集？

> ID：14488946
> 
> 赞同：0
> 
> 时间：2013-01-23T20:39:14.540
> 
> 标签：mysql, ruby-on-rails, rails-activerecord

我需要连接到远程 MySQL 表中的数据，遍历它，并使用 ActiveRecord“创建”方法，以便执行所有验证和回调。我找到了有关具有多个数据库配置设置并为每个模型单独分配它们的文档，但这不符合我的需求，因为我不想为一次性导入创建模型或迁移。

所以我发现了另一种在 AR 之外查询数据库的方法：

```
base = ActiveRecord::Base.establish_connection(
  :adapter  => "mysql2",
  :host     => "XXX",
  :username => "YYY",
  :password => "ZZZ",
  :database => "AAA"
)

results = base.connection.execute("SELECT * FROM programs WHERE 1") 
```

但它返回一个看起来相当难以理解的对象：

```
#<Mysql2::Result:0x007fdf6e8bb9d8> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:41:39.593

这可以解决问题：

```
base.connection.select("SELECT * FROM programs WHERE 1") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:42:24.677

看看[ActiveModel](https://github.com/rails/rails/tree/master/activemodel)。您可以将所需的所有功能放在那里，并可以访问诸如验证之类的东西。

# c - 为什么我无法打印空格字符？

> ID：14488947
> 
> 赞同：3
> 
> 时间：2013-01-23T20:39:19.853
> 
> 标签：c

这是我的代码：

```
int main(void)
{

    int i, j, k, n;
    char userLatter, space;
    printf("please enter an uppercase letter:\n");
    scanf("%c", &userLatter);
    n = 9;

    for (i = 0; i < 5; i++)
    {
        space = ' ';
        for (j = 5; j > i; j--)
        {
            ++space;
        }

        for (k = 0; k <= i ; k += 1)
        {
            printf("%c%c%c", space, userLatter, space);
        }
        printf("\n");
    }

} 
```

你能告诉我我应该怎么做才能打印空格字符吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T20:42:52.327

你不断地用这条线把空间变成别的东西：

```
++space; 
```

你期望它做什么？您是否试图使其成为多个空格的字符串

您可以使用`printf`格式说明符左填充您的字符。试试这个：

```
int width = 4;
char letter = 'A';
printf( ":%*c:\n", width, letter ); 
```

这将输出 3 个空格和字母 A：

```
:   A: 
```

如果你只是想放一个空格，别忘了你可以在格式字符串中放一个空格。正如著名的：

```
printf( "Hello, world!\n" ); 
```

注意里面有空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:56:50.407

这不是 Java。中没有`Strings`。`C`或者，您使用`char[]`. 你不能说`++space`并期望`space`连接它的自我。`++space`和中说的`space = space + 1`一样`C`。如果我不正确，这样做会给它的 ASCII 值加 1。`space`是一个字符，一次只能保存一个字符。如果您希望它包含多个字符，则必须将其设为数组。这是一个替代方案：

```
char space[5]; //This would be done at the top when you initialize it
/* Many lines of code later */
for(j = 5; j > i; j--){
    space[j] = ' ';
} 
```

仅供参考，`n`完全没有做任何事情，而且在浪费空间。抱歉，我的强迫症感觉很刺痛。

# google-app-engine - 应用引擎上的 Web 应用程序设计策略

> ID：14488950
> 
> 赞同：1
> 
> 时间：2013-01-23T20:39:43.280
> 
> 标签：google-app-engine

我正在尝试开发一个游戏网站。用户可以将其他用户添加为他们的朋友。用户将在完成各种游戏关卡时获得积分。现在我需要在其页面上显示所有已经玩过该游戏的用户的朋友的平均积分（例如：当用户玩游戏A时，他的朋友获得的平均积分应该显示在游戏A页面上。同样的游戏在他玩游戏 B) 时，将显示他朋友的 B 平均分。

**我的做法：**

*   将用户的好友列表（最多 1000 个）作为多值属性存储在数据存储中，并在用户登录站点时将其加载到 GAE 内存缓存中。
*   使用常驻后端缓存所有用户的游戏数据（每个特定游戏获得的积分）。一个 cron 作业每小时更新一次后端缓存。当用户第一次请求游戏页面（例如：游戏 A）时，请求处理程序通过 URL-Fetch 服务与后端联系以计算朋友点的平均值。
*   现在后端从内存缓存中获取用户的好友列表（最多 1000 个），从内存缓存（后端缓存）中获取游戏 A 的好友点并返回计算的平均值。获取平均值后的请求处理程序，将其保存在数据存储中，并将其存储在内存缓存中，以便对游戏 A 页面的后续请求从内存缓存/数据存储中获取数据，而无需在后端进行计算开销。该平均值的有效期为 1 小时，之后在下一次请求游戏 A 页面时重新计算。

**我的问题**：

*   上述方法是解决这个问题的正确方法吗？
*   如何使用后端实例（python-2.7）高效可靠地实现内存缓存？
*   如何估计仅这项工作所需的后端内存和 CPU？（假设必须存储 10 万个键值对，其中“userid/gamename”作为键，用户点作为值。用户好友列表最大大小为 1000。）
*   如果随着负载的增加我必须使用多个后端实例，如何对它们进行负载平衡？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T05:03:31.600

看看尼克约翰逊的这篇关于计数器的博客文章：http: [//blog.notdot.net/2010/04/High-concurrency-counters-without-sharding](http://blog.notdot.net/2010/04/High-concurrency-counters-without-sharding)

将 NDB 数据存储用于： - 自动缓存，而不是您自己的内存缓存 - NDB 有一些新的有趣属性，例如：带压缩的 json 属性、重复属性，其作用类似于 Python 列表

并查看 mapreduce 以进行有效更新。

# jquery - jQuery - 如果窗口宽度为“x”，则获取元素的宽度

> ID：14488957
> 
> 赞同：0
> 
> 时间：2013-01-23T20:40:09.037
> 
> 标签：jquery

我正在创建一个插件来帮助使网站响应。第一步是创建一个故障保险，这样事情看起来仍然像他们应该的那样。

在页面加载时，我想以最大窗口大小获取元素的宽度。目前，我只是这样做：

```
var theElements = ['div', 
                'section',
                'table',
                'article',
                'aside',
                'details',
                'figcaption',
                'figure',
                'footer',
                'header',
                'hgroup',
                'nav',
                'section',
                'summary'];

for (var i=0; i<theElements.length; i++){

    $(theElements[i]).each(function(){
        var theWidth = $(this).width();
        $(this).css('max-width', theWidth + "px"); 
    });
} 
```

这工作*得*很好，但它只会在页面加载时以窗口大小获取元素的宽度 - 所以如果窗口只有 500 像素，那就是我坚持的容器大小。

**我想做的事**

用最简单的术语来说，我试图了解页面的*外观*，它的设计外观。无法知道网站的设计者是否使用边距、具体像素值或百分比来编码他们的网站，所以最简单的方法是让窗口大到足以说“是的，这就是它的外观”。

我希望能够非常快速地将窗口宽度设置为 1280 像素，计算`theElements`宽度然后将其设置回原来的值（这不是一个好的选择，因为它对用户来说很突兀）或者以其他方式找到一些方法如果主体宽度为 1280 像素，则计算元素的宽度（更好的 UX，但不确定是否可能）。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:46:23.870

您可以将*body*的宽度（或`<html>`元素的宽度）设置为 1280，计算所有宽度，然后将其改回 auto。只要 JS 不间断地运行，浏览器就不会重绘任何东西。

我能看到的唯一其他选择是将整个文档克隆到具有固定宽度的隐藏元素中，然后将其全部丢弃。不过，这要贵一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:44:33.027

虽然我不完全理解为什么要将元素的最大宽度设置为元素的宽度，但这应该可以响应屏幕尺寸的变化。

```
$(window).on("resize", function(){
  for(var i = 0, n; n = theElements[i]; ++i){
    $(n).each(function(){
       $(this).css({"max-width" : $(this).width() + "px"};
   })
  }
}) 
```

# c - 无符号数的定点乘法

> ID：14488965
> 
> 赞同：5
> 
> 时间：2013-01-23T20:40:33.533
> 
> 标签：c, numbers, fixed-point

我正在尝试用定点数解决乘法问题。数字是 32 位的。我的架构是 8 位的。所以这里是：

1.  我使用 8.8 表示法，即 8 表示整数，8 表示分数。

2.  我有 A78，它是 10.468。我取它的二进制补码，答案是 FFFFF588，我将它截断为 16 位作为 F588 并存储它。原因是，我只想将两个 2 字节数相乘。

3.  现在，当我将此 F588（负 10.42 或 0x0A78）乘以 0xFF4B（即 0x00B5（0.707）的二进制补码）时，答案应该是 0x0766。或者类似的东西。

另一方面，我得到的是 66D8。

现在有趣的是：如果我将 B5 的负数存储在 32 位的二进制补码中，我得到 0xFF5266D8，我将其右移 8 位，然后截断为 16 位，答案是 0x5266。

另一方面，如果我将负数 10.42 存储在 32 位中，我得到 0xF58F66D8，在移位 8 位并截断后变为 8F66。

但是，如果我将两个数字都存储为 32 位格式，那么只有在移位和截断后才能得到正确的结果，即 0x0766。

为什么会这样？我知道当我们从 32 位到 16 位时，信息丢失是固有的，但是 0x07 与 0x55 有很大不同。我将非常感谢您的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:02:59.683

让我们只看整数表示。您有两个 16 位整数*x*和*y*，并形成它们的 16 位二进制补码。但是，您将这些 16 位补码保存在 32 位对象中。在 32 位中，您拥有的是 65536–<em>x 和 65536–<em>y。（例如，您从 0xa78 开始，将其补充为 0xfffff588，并丢弃位以获得 0xf588。这等于 0x10000-0xa78。）

当您将这些相乘时，结果为 65536•65536 – 65536•<em>x – 65536•<em>y + *x* •<i>y。

65536•65536 是 2 ^(32)，因此它消失了，因为无符号 32 位算术是以 2 ^(32)为模执行的。剩下 – 65536•<em>x – 65536•<em>y + *x* •<i>y。

现在你可以看到问题了：*x* •<i>y 是两个 16 位值的乘积，所以它流入了 32 位的高 16 位。在那里，你仍然有 - 65536•<em>x - 65536•<em>y，这是你不想要的。

一个简单的方法是乘以保留所有 32 位的补码。例如，当你取 0xa78 的二进制补码时，你得到 0xfffff588。然后你丢弃了高位，只保留 0xf588。如果你不这样做，你会将 0xfffff588 乘以 0xffffff4b，乘积将是 0x766d8，当为分数移动时，将是 0x766，这就是你想要的结果。

如果由于将二进制补码存储到 16 位对象中而丢失了高位，则只需在重新加载对象时通过扩展符号位来恢复它们。也就是说，取第 15 位并在第 16 位到第 31 位重复。一个简单的方法是将 16 位对象加载到 16 位有符号整数，然后将 16 位有符号整数转换为无符号 32-位整数。

# javascript - 加载后在gallerio.io中使用javascript旋转图像

> ID：14488966
> 
> 赞同：1
> 
> 时间：2013-01-23T20:40:36.503
> 
> 标签：javascript, jquery, galleria, image-rotation

我正在使用 Galleria 1.2.8。我尝试在画廊加载图像后旋转图像。为此，我正在使用 jquery rotate 插件（http://code.google.com/p/jqueryrotate/）。我确实附加到“loadfinish”事件，然后执行 e.imageTarget.rotate(90)。然后我收到错误：“TypeError：e.imageTarget.rotate 不是函数”。当我在控制台中执行“e.imageTarget”时，我确实得到了 img 对象，但我怀疑它尚未添加到 DOM 中，这就是它不起作用的原因。我也尝试附加到“图像”事件，但我得到了同样的错误。

我有什么想法可以使旋转与画廊一起工作吗？

谢谢，斯文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T21:09:47.250

`e.imageTarget`根据[文档](http://galleria.io/docs/api/events/#loadfinish)，它不是 jQuery 对象，而是 HTML 元素：

> imageTarget（HTML 元素）转换前现在加载的图像的 IMG 元素。

HTML 元素没有名为`rotate`. 您需要将其包装在一个 jQuery 对象中：

```
this.bind("loadfinish", function(e) {
    $(e.imageTarget).rotate();
}); 
```

# html - 三个 div 堆叠类似于网格样式

> ID：14488967
> 
> 赞同：0
> 
> 时间：2013-01-23T20:40:44.257
> 
> 标签：html, css

假设我有三个 div：DIV1、DIV2、DIV3 是这个特定的顺序。

我想像这样堆叠它们：

```
 (BIG|DIV1
   DIV2)|DIV3 
```

我尝试过定位和浮动，不幸的是，DIV 只是重叠、隐藏或堆叠在另一个之下。

任何帮助或建议都会很棒。

**更新** 我当前的代码：

```
.div1
{
    position: absolute;
    margin-left: 125px;
    width: 500px;
}

.div2
{
    position: relative; 
}

.div3
{
    clear: both;
} 
```

结果：

```
 (BIG|DIV1
DIV2)|
 DIV3 
```

HTML：

```
<div class="div1">DIV1</div>
<div class="div2">(BIG <br /> DIV2)</div>
<div class="div3">DIV3</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:45:48.443

```
<div id="div1"></div>
<div id="div2"></div>
<div id="div3"></div>

#div1{
  width:200px;
  height: 50px;
  clear: both;
}
#div2{
  width:100px;
  height: 50px;
  float: left;
}
#div3{
  width:100px;
  height: 50px;
  float: left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:09:58.243

如果您发布您尝试过的代码会有所帮助。如果我理解你想要什么，应该这样做：

```
#one {
    clear: both;
    height: 15%;
    width: 40%;
    margin-right: 0px;
    margin-left: auto;
}

#two {
    margin-right: auto;
    margin-left: 0px;
    float: left;
}

#three {
    margin-right: 0px;
    margin-left: auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:10:27.427

该解决方案采用相对定位的包装器。我希望这对你有用。

[http://jsfiddle.net/LLRR8/2/](http://jsfiddle.net/LLRR8/2/)

```
#div1 {
    height: 50%;
    position: absolute;
    right: 0;
    top: 0;
    margin-left: 120px;
}
#div2 {
    height: 100%;
    width: 120px;
    position: absolute;
    left: 0;
    top: 0;
}
#div3 {
    height: 50%;
    position: absolute;
    top: 50%;
    right: 0;
    margin-left: 120px;
}
#wrapper {
    position: relative;
}

<div id="wrapper">
    <div id="div1"></div>
    <div id="div2"></div>
    <div id="div3"></div>
</div> 
```

# css - 用于全屏流畅、响应式布局、滚动内容的 CSS 包

> ID：14488968
> 
> 赞同：0
> 
> 时间：2013-01-23T20:40:46.770
> 
> 标签：css, layout, fluid

我正在寻找一个 CSS 包，它可以帮助构建带有滚动内容的流畅/响应式布局......我不知道我是否准确地描述了这一点，但我的意思[在这里](http://bklynsoap.com/)和[这里](https://mylapka.com/)都很好地表达了。

还有其他的，但是这两个显示得很好。

有什么建议吗？我是不是想太多了，它就像一个大的无列 CSS 网格一样简单（即我什至可以使用 twitter 的 Bootstrap 作为起点）？我已经尝试过一些简单的设计，但它似乎永远不会适用于每台设备/每次调整屏幕大小时。

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:53:30.573

在进行响应式设计时，您需要确保将元标记设置为视口初始缩放值 1。移动设备倾向于将更多像素值打包到实际像素中，以便它们适合屏幕，但如果您将视口的初始比例值为 1，那么您实际上是在告诉设备您希望以 1 比 1 的像素比率查看页面。

将此添加到您的标题中：

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" > 
```

# javascript - webgl three.js 获取网格上的鼠标位置

> ID：14488971
> 
> 赞同：2
> 
> 时间：2013-01-23T20:41:06.400
> 
> 标签：javascript, cursor, position, three.js, webgl

老实说，我试图在下面找到问题的解决方案，请帮助我。对不起我的英语:)

我创建了一张地图，添加了一个相机 + 添加了所有维度的相机控制。

而当我得到光标相对于网格的位置时，位置总是因不同的角度而不同。

查看 jsfiddle.net 中的所有代码：http: [//jsfiddle.net/BT3g3/](http://jsfiddle.net/BT3g3/)

我使用 Three.js r49。

这段代码只负责计算位置。

```
function onDocumentMouseMove(event) {
    var vector = new THREE.Vector3(  ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 1);
    projector.unprojectVector( vector, camera );

    var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
    var intersect = ray.intersectObject( island );  

    if ( intersect.length > 0) { // !!
        document.getElementById('z').value = intersect[0].point.z;
        document.getElementById('x').value = intersect[0].point.x;
    }
} 
```

我在浏览互联网时遇到[了一篇文章](http://www.chandlerprall.com/2011/07/dynamic-terrain-without-heightmaps/)，其中光标位置被捕获在地图上，但我未能将此方法移至我的项目:(

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T05:15:39.173

您是否尝试过以下操作？

```
mouseX = ( ( event.clientX - canvas.offsetLeft ) / canvas.clientWidth ) * 2 - 1;
mouseY = - ( ( event.clientY - canvas.offsetTop ) / canvas.clientHeight ) * 2 + 1; 
```

# php - 如何访问多维关联数组的值

> ID：14488972
> 
> 赞同：0
> 
> 时间：2013-01-23T20:41:06.440
> 
> 标签：php, key, associative-array

我有一个`$scores`名为“team”的数组，它本身是一个索引为“w”、“l”和“d”的数组。如何访问“w”、“l”和“d”的值？

我试过了：

```
echo '<td>' . $scores['team']['w'] . '</td>';
echo '<td>' . $scores['team']['l'] . '</td>';
echo '<td>' . $scores['team']['d'] . '</td>'; 
```

和

```
echo '<td>' . array_values(array_keys($scores['team'], 'w')) . '</td>';
echo '<td>' . array_values(array_keys($scores['team'], 'l')) . '</td>';
echo '<td>' . array_values(array_keys($scores['team'], 'd')) . '</td>'; 
```

但这些都行不通。

声明数组：

```
$scores = array (
                            'team' => array (
                                                'w'     => 0
                                            ,   'l'     => 0
                                            ,   'd'     => 0
                                            )
                    ); 
```

print_r($scores):

```
Array ( [team] => Array ( [w] => 0 [l] => 0 [d] => 0 ) [team one] => Array ( [l] => 2 [w] => 1 [d] => 1 ) [team two] => Array ( [w] => 1 [l] => 1 [d] => 1 ) [team three] => Array ( [l] => 1 ) [team four] => Array ( [w] => 1 ) [team five] => Array ( [w] => 1 ) ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:42:23.977

现在已经解决了 - 感谢贡献者。

问题是我试图从 for 循环中访问值：

```
for($i = 0; $i < count($teams); $i++)
{
    echo '<td>' . $scores[$teams[$i]]['l'] . '</td>';
} 
```

这给了我正在寻找的答案。

# ruby-on-rails - heroku:db push 不起作用，时区位移超出范围

> ID：14488973
> 
> 赞同：0
> 
> 时间：2013-01-23T20:41:10.887
> 
> 标签：ruby-on-rails, postgresql, heroku, taps, heroku-toolbelt

我似乎无法使用 heroku 推送，**heroku db:pull 工作正常**，但**heroku db:push 不行**

，这是我得到的错误

> Taps服务器错误：PGError：错误：时区位移超出范围

我的宝石文件

```
source 'https://rubygems.org'

gem 'rails', '3.2.11'
gem 'jquery-rails'
gem 'kaminari'
gem 'bootstrap-kaminari-views'

gem 'devise'

gem 'pg'

gem 'rmagick'
gem 'carrierwave'
gem 'fog', '~> 1.3.1'

group :development do
  gem 'taps'
  gem 'sequel'
  gem 'sqlite3'
  gem 'pry'
end

group :assets do
  gem 'bootstrap-sass', '~> 2.2.1.1'
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

我正在使用`ruby-1.9.3-p327`，我也尝试过`ruby-1.9.2-p318`使用 rvm 安装，但它也不起作用，它与以前有相同的时区错误

* * *

我也尝试过使用[heroku的pgbackups](https://devcenter.heroku.com/articles/heroku-postgres-import-export)将我的本地数据库转储到s3，然后从那里恢复到heroku，但无济于事。

* * *

### 我用于 pgbackups 的命令是

```
PGPASSWORD=mypassword pg_dump -Fc --no-acl --no-owner -h localhost -U myuser mydb > mydb.dump 
```

然后我将它复制到我的 s3 存储桶并将其公开

并使用将其从 s3 恢复到 heroku db

```
heroku pgbackups:restore DATABASE 'https://s3.amazonaws.com/my_bucket/my_db.dump' 
```

这是来自 pgbackups 的错误

```
2013-01-23T19:19:23+00:00 app[pgbackups]: psql: bin//psql-9.2.1-64bit
2013-01-23T19:19:23+00:00 app[pgbackups]: pv: bin//pv-1.1.4-64bit
2013-01-23T19:19:23+00:00 app[pgbackups]:       SELECT count(*) = 0 as is_empty
2013-01-23T19:19:23+00:00 app[pgbackups]:       FROM pg_class INNER JOIN pg_roles ON relowner = pg_roles.oid
2013-01-23T19:19:23+00:00 app[pgbackups]:       WHERE rolname <> '\''postgres'\'''
2013-01-23T19:19:44+00:00 app[pgbackups]: psql-9.2.1-64bit: could not connect to server: Connection timed out 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:52:41.727

看看这个讨论： [https ://github.com/ricardochimal/taps/issues/93](https://github.com/ricardochimal/taps/issues/93)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:11:21.987

## 删除 heroku-toolbelt 后，它现在可以使用 ruby​​-1.9.2-p318

这是我所做的（Ubuntu 12.04）

* * *

### 1.删​​除heroku工具带

```
sudo rm -rf /usr/local/heroku
sudo rm -rf /usr/bin/heroku 
```

* * *

### 2.更新gemfile

我在水龙头上加了 require false

```
group :development do
  gem 'taps', :require => false
end 
```

如果您的gemfile中还没有heroku gem，还可以添加它

```
gem 'heroku' 
```

* * *

### 3\. 安装 ruby​​ 1.9.2 和 gems

导航到您的应用程序 (cd ~/sites/myapp) 并执行

```
rvm install ruby-1.9.2-p318
rvm use ruby-1.9.2-p318
bundle install
gem install rb-readline 
```

您现在应该安装了 heroku gem

仔细检查在控制台中运行它
`ls ~/.rvm/gems/ruby-1.9.2-p318/gems`
您现在应该看到一个名为 heroku 的文件夹，其中附加了一个版本。例如。*heroku-2.26.3*

* * *

### 4\. 再次运行该推送

现在您应该仍然在您的应用程序文件夹中，例如 (~/sites/myapp)

尝试使用您刚刚安装的 heroku gem 进行推送，如果您下载了不同的版本，**请记住更改您的版本。**

```
~/.rvm/gems/ruby-1.9.2-p318/gems/heroku-2.26.3/bin/heroku db:push 
```

看来您需要切换回 ruby​​ 1.9.3 才能使用 rake db:migrate 等

我在使用 rake db:migrate 时遇到的错误

```
You're running a version of ruby with no Readline support
Please `gem install rb-readline` or recompile ruby --with-readline. 
```

```
rvm use ruby-1.9.3-p327 
```

你应该在路上了！

# html - 如何在超链接后以纯文本形式插入链接的域名？

> ID：14488975
> 
> 赞同：2
> 
> 时间：2013-01-23T20:41:21.473
> 
> 标签：html, css, hyperlink

有没有办法在该链接之后自动插入链接的域名？我想看看这个：

`A link to youtube video [youtube.com]`

我更喜欢只使用 HTML 和 CSS，但我想这是不可能的。这个想法是使用这段代码：

```
 a:after {
    content: " [" attr(href) "]";
  } 
```

但这当然会显示整个 URL：

`A link to youtube video [https://www.youtube.com/watch?v=asdfghi00]`

我认为这太长而且没有必要。我使用 Wordpress（也许只有一个插件可以做到这一点，我只是没见过）。它链接 jQuery，所以一个 jquery 脚本可能是可以接受的。或者，我可以使用 PHP 并将其破解到 Wordpress 中。

您认为最好的解决方案是什么？PHP 还是 JavaScript？我会从使用 jQuery 中受益吗（好吧，它已经加载了）？如果可能的话，你能为我写这个片段吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:47:55.443

如果您负担得起在链接上添加另一个属性，则可以这样做。

[这是一个例子](http://codepen.io/anon/pen/BgKvj)

在您的标记中，添加一个`data-`属性：

```
<a href="youtube.com/foo" data-href-domain="youtube.com">a link to youtube video</a> 
```

并在您尝试时使用生成的内容引用它：

```
a:after {
 content: " [" attr(data-href-domain) "]";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:10:45.583

当我想到它时，一种可能的解决方案是创建一个自定义简码（在插件[Shortcoder](http://wordpress.org/extend/plugins/shortcoder/)或类似插件的帮助下）。这将使我能够轻松地制作经典链接和带有显示地址的链接。我会使用类似于这样的短编码器语法：

```
<a href="http%%s%%://%%domain%%/%%link%%">%%text%%</a> [%%domain%%] 
```

使用它 -`Lorem Ipsum [sc:extlink s="s" domain="youtube.com" link="watch?v=asd" text="link" ] Dolor Dot.`转化为：

```
<p>Lorem Ipsum <!-- Start Shortcoder content --><a href="https://youtube.com/watch?v=asd">link</a> [youtube.com]<!-- End Shortcoder content --> Dolor Dot.</p> 
```

或者

```
<a class="with-note" href="http%%s%%://%%domain%%/%%link-tail%%" data-href-domain="%%domain%%">%%text%%</a> 
```

后者按照 Alessandro[建议](https://stackoverflow.com/a/14489079/1306158)的方式使用 CSS 。但它仍然没有它应该的那么好和舒适。如果没有人能提供更好的东西，这只是一个选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-04T06:42:57.327

这个问题很老了，但这里是你如何用 jQuery 来做的：

```
$('a').each(function () {
    this.hostname && $(this).after(' ['+this.hostname+']');
}); 
```

编辑：您可以通过将其粘贴到控制台中来在 stackoverflow 上试用它

# ruby - 如何在 html 输出结果中对 rspec 描述进行分组

> ID：14488976
> 
> 赞同：2
> 
> 时间：2013-01-23T20:41:22.133
> 
> 标签：ruby, rspec, watir-webdriver

我在不同的文件中有许多 rspec 规范。但它们都是密切相关的，所以我决定同样描述它们。问题是输出 html 按文件而不是描述对场景进行分组。像这样的东西：

Rspec 文件 1：

```
describe "Module 1" do

    it "should do something " do
    ...
end 
```

文件 2：

```
describe "Module 1" do

    it "should do another thing " do
    ...
end 
```

html结果是这样的：

```
Module 1 ---------
    should do something
Module 1 ---------
    should do another thing 
```

理想的结果应该是这样的：

```
Module 1---------
    should do something
    should do another thing 
```

是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:36:53.917

好的！自定义格式化程序成功了。感谢所有帮助！

# c# - AutoMapper 2.1.267.0 不映射简单的int？财产

> ID：14488978
> 
> 赞同：0
> 
> 时间：2013-01-23T20:41:27.243
> 
> 标签：c#, automapper, automapper-2

我有以下课程

资源：

```
public class NewBusinessSubmission
{
    //other properties      
    public int? TermTypeId { get; set; }

} 
```

目的地：

NewBusinessSubmission 类继承自如下所示的 PolicyTransaction 类（是的，它是 VB.NET）：

```
<System.Serializable()> Public MustInherit Class PolicyTransaction
    Inherits Framework2.BusinessBase(Of PolicyTransaction)
    Implements IDisposable

  ...........

Public Property TermTypeId() As Nullable(Of Integer)
    Get
        CanReadProperty(True)
        If Not _PolicyTermsDataRow.IsTermTypeIdNull Then
            Return Me._PolicyTermsDataRow.TermTypeId
        End If
    End Get
    Set(ByVal value As Nullable(Of Integer))
        If Nullable(Of Integer).Equals(value, Me.TermTypeId) Then Exit Property
        CanWriteProperty(True)
        If value.HasValue Then
            Me._PolicyTermsDataRow.TermTypeId = value.Value
        Else
            Me._PolicyTermsDataRow.SetTermTypeIdNull()
        End If
        AfterTermTypeIdChanged()
        Me.PropertyHasChanged()
    End Set
End Property
  ...........

End Class 
```

下面的映射配置没有设置 TermTypeId：

```
 Mapper.CreateMap<NewBusinessSubmission, NewBusiness>()
        .ForMember(x => x.PolicyTxnNum, opt => opt.Ignore())
        .ForMember(x => x.ContactProducerLicId, opt => opt.Ignore())
        .ForMember(x => x.PolicyNames, opt => opt.Ignore())
        .ForMember(x => x.PolicyExp, opt => opt.Ignore()); 
```

这个也不起作用：

```
 Mapper.CreateMap<NewBusinessSubmission, NewBusiness>()
        .ForMember(x => x.PolicyTxnNum, opt => opt.Ignore())
        .ForMember(x => x.ContactProducerLicId, opt => opt.Ignore())
        .ForMember(x => x.PolicyNames, opt => opt.Ignore())
        .ForMember(x => x.PolicyExp, opt => opt.Ignore())
        .ForMember(x => x.TermTypeId, opt => opt.MapFrom(x => x.TermTypeId)); 
```

我这样称呼地图：

```
 var newBusiness = Mapper.Map<NewBusinessSubmission, NewBusiness>(newBusinessSubmission); 
```

在 Set() 方法中具有相似代码的所有其他属性都正确映射，我也可以像这样手动映射 TermTypeId：

```
 newBusinessInstance.TermTypeId = newBusinessSubmissionInstance.TermTypeId; 
```

关于为什么此属性未正确映射的任何想法？

谢谢。

# xpages - 如何管理附件（查看/删除）

> ID：14488981
> 
> 赞同：1
> 
> 时间：2013-01-23T20:41:39.503
> 
> 标签：xpages

我可以将文件上传控件添加到我的页面并添加附件。但是我该如何管理它们呢？查看，删除？

我在我的 xpage 中添加了一个计算字段，并将附件字段设为源并将该字段设置为 HTML。我得到了一堆条目，例如（参见附件：abc.pdf）。但这似乎并没有达到我想要的效果。

有没有一种简单的方法来管理这些附加文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T11:50:42.703

将文件下载控件绑定到与上传控件绑定的相同数据。该组件支持的属性之一是是否允许删除的布尔值。您还可以选择它显示的每个文件的属性（MIME 类型、大小等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T07:39:51.290

对文件名进行重复控制重复并直接生成指向那些文件的链接有什么问题，这些文件在链接上有执行删除或查看的事件处理程序？

# c# - 如果异步请求的 AsyncCallback 已完成，如何通知您？

> ID：14488986
> 
> 赞同：1
> 
> 时间：2013-01-23T20:41:57.623
> 
> 标签：c#, multithreading, asynchronous, mono

在[此](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx)示例中，发出了一个异步请求，当它完成时，从它的回调中发出另一个异步请求。当第二个回调完成时，如何从第一个线程（主线程）通知我？通常我会监控 IAsyncResult，但是第二个请求的创建不是在第一个线程的范围内完成的，所以我无权访问它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:58:17.773

解决这个问题的最简单方法可能是不这样做 - 第二个回调可以同步（使用`GetResponse`而不是`BeginGetResponse`），然后您可以只监视 IAsyncResult。

或者，您也可以使用他们用来防止主线程结束的相同方法：创建另一个

```
private static ManualResetEvent allDone = new ManualResetEvent(false); 
```

然后在第一个回调中使用

```
allDone.WaitOne(); 
```

并打电话

```
allDone.Set(); 
```

在第二个回调中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:57:06.380

您的回调必须向第一个线程发出信号，表明它已完成。例如，它可以使用事件来做到这一点。`TaskCompletionSource`是一个等待友好的替代方案。

# import - 将旧的 xcode 项目移植到 xcode 4.5.2

> ID：14488988
> 
> 赞同：1
> 
> 时间：2013-01-23T20:42:00.810
> 
> 标签：import, xcode4.5

我是新手，我来自 Windows C++，
将 VC 6 项目加载到 VC 2010 没有问题，
但现在我在 mac 上，我有 xcode 旧项目和 x_myapp.pbproj 项目文件，当我将它加载到 xcode 4.5 时。 2 它给了我错误。那是旧项目。我如何将其移植/导入到新的 Xcode？

# java - 绘制等距墙

> ID：14488989
> 
> 赞同：9
> 
> 时间：2013-01-23T20:42:00.657
> 
> 标签：java, math, isometric

我在使用等距墙时遇到了一些问题。

我正在使用从后到前的渲染方法绘制等距地砖，并且效果很好。我还保持我的地砖在一个漂亮的网格中正确排列。代码（这似乎是等距平面图的标准）如下：

```
for(int x = 0; x < 6; x++){
    for(int y  = 3; y >=0 ; y--){

        int xCo = (y+x)*(tileWidth/2);
        int yCo = (x-y)*(tileHeight/2);
        tile.draw(g, xCo, yCo);
    }            
} 
```

这是一个不错的小地板：

![多块地砖](../Images/957b84ceadfd839dc5e010891678b62c.png)

网格是从这个图块构建的：

![单瓦](../Images/116e15673f908b2a9d11f18c63b71d0a.png)

不幸的是，当我对墙壁使用相同的逻辑时，一切都变得糟糕透顶。

```
for(int x = 0; x < 6; x++){
    for(int y  = 3; y >= 0 ; y--){

        int xCo = (y+x)*(wallWidth()/2);
        int yCo = (x-y)*(wallHeight()/2);
        walls.draw(g, xCo, yCo);    
}
} 
```

我用这个作为我的墙砖：

![单墙砖](../Images/9a2987b70fd44c9eb17d207394982a3f.png)

（它是来自谷歌图片搜索的占位符，但它应该可以正常工作）

这是我得到的结果：

![多块墙砖](../Images/a34dee5b17d8331bcd22a8e10a7b13c7.png)

我的墙壁的渲染顺序显然是正确的，较近的墙壁在较远的墙壁上渲染，这是我想要的，但定位也非常不正确，我不知道我应该如何纠正这个不足像素值。

作为参考，我确实使用硬编码的像素值进行了试验，因为我发现从一堵墙的右上角到另一堵墙的右角，变化正好是 (200, -100) 像素。当我为此制作渲染循环时

```
int xCo = (x+y)*200;
int yCo = (y-x)*-100; 
```

它工作得很好，但这不是一个可行的解决方案，因为它不允许任何多功能性。

因此，寻找有关如何使我的等距墙对齐的建议。我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:43:24.730

您不能简单地对墙壁和地板使用相同的绘图代码，因为墙壁和地板不在同一平面上：地板是平的（水平的）而墙壁是垂直的。所以你必须稍微不同地绘制它们。

就瓷砖的放置而言，您在地板案例中的 x 和 y 坐标意味着“左/右”和“前/后”。对于砖块来说，left 和 right 仍然有意义，但我们希望将 forward/backward 替换为 up 和 down 以反映垂直方向。所以我们的“y”有了新的含义。

现在，在数学中，y 轴通常指向上方，而在 2D 计算机图形中则指向下方。您可以选择 - 下面的代码假定它指向上方，这`y = 0`意味着“在地板上”。

所以让我们开始考虑顺序。您发布的示例砖是用于作为地板（上）左端的墙。由于砖的黑色部分（墙的深度），我们必须确保首先绘制更靠右的砖，以便左侧的黑色深度会被更近的砖覆盖。相同的论点适用于墙壁顶部的黑色，我们必须先绘制较低的砖块。

如果我们坚持前面讨论的 x 和 y 方向（x 从左到右，y 从下到上），这意味着我们必须在负方向上运行两个 for 循环：

```
 for (int y = 3; y >= 0; y--) {
        for (int x = 5; x >= 0; x--) {
            ...
        }
    } 
```

现在的主要问题是我们必须将每块砖相对于其他砖的绘制偏移多少。让我们一次只做一个方向，从 x 方向开始。

让我们想象一下只有两块相邻的砖块：

![两块砖水平](../Images/dfc819b65877d6fc28f90c898af34050.png)

两者的左侧有可见的黑色深度部分，但右侧不应该显示它。因此，我们不能简单地将正确的图像偏移 PNG 的整个宽度。事实上，假设砖与你的地砖对齐，墙的实际前部的宽度应该是瓷砖宽度的一半。

```
int xCo = x * tileWidth / 2; 
```

左边的黑色墙体深度不能忽略，因为我们可能想让每块砖向左偏移一点，这样墙前角的x坐标就和地砖对齐了，而不是x-后角的坐标。

现在，每块砖的 y 坐标有点棘手，因为它不仅取决于砖的行，还取决于 x 坐标：越靠右，我们应该画得越高。但是让我们暂时忽略 x 方向并尝试简单地绘制一列砖块：

![两块砖垂直](../Images/884f12a5f3208b1aa9ae213b712bb7cb.png)

同样，两块砖的 y 坐标之间的增量不是 PNG 的全高。与我们假设砖块与允许我们`tileWidth`用作 delta-x 的砖块对齐的左/右案例不同，砖块可以具有任意高度。但是我们仍然可以从图像高度计算出实际的砖高度，因为我们知道左侧的深度和顶部的深度必须对齐。

如果我们看一下砖PNG右上角的小透明三角形，我们注意到它的宽度和高度的比例必须与地砖的宽度和高度的比例相同。这允许我们从上面计算的 xoffset 计算 yoffset，并使用它来推断砖的实际高度：

```
int yoffset = xoffset * tileHeight / tileWidth;
int wallHeight = wallHeight() - tileHeight / 2 - yoffset; 
```

请注意，这仅在 PNG 的边界没有空白空间的假设下有效，并且由于舍入错误可能仍会失败。因此，如有必要，您可以在此处添加`Math.ceil()`（或简单地）。`+ 1`

所以对于简单的列，我们现在可以开始了：我们可以简单地将我们的`y`变量与上面的`wallHeight`. 但如前所述，砖块的 x 位置也会影响 y 像素坐标。如果我们再看第一张图片，两块砖并排在一起，我们需要将右边的砖向上移动多少才能与左边的砖对齐？嗯，这个其实很简单，因为它和地砖一样：只有地砖的一半高度！

所以我们都准备好了。如果我们把所有东西放在一起，我们最终会得到一些像这样的代码：

```
int xoffset = wallWidth() - tileWidth / 2;
int yoffset = xoffset * tileHeight / tileWidth;
int wallHeight = wallHeight() - tileHeight / 2 - yoffset;

for (int y = 3; y >= 0; y--) {
    for (int x = 5; x >= 0; x--) {

        int xCo = x * tileWidth / 2;
        int yCo = y * wallHeight - x * tileHeight / 2;

        walls.draw(g, xCo - xoffset, yCo - yoffset);
    }
} 
```

（我假设 wallWidth() 和 wallHeight() 返回砖块 PNG 的宽度和高度。）

请注意，for 循环之前的三个常量可以从实际绘图代码中移出——它们只依赖于图像属性和其他常量，不必在每次绘制墙壁时都重新计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:42:58.057

如果您查看形状像菱形的地砖，将其向上移动一半宽度并穿过一半长度，两条边将对齐。
墙砖不是菱形，因此通过移动一半宽度和一半长度，您想要匹配的边缘将不会对齐。

给定`u`= 移动距离和`v`= 向上移动距离和`A`等距角

`v = u*tan(A)`

`u`在这种情况下是图像正面的宽度。

如果墙壁图像的面（纹理位）与地砖的边缘长度匹配，则给出

```
int offset = ?;// this is the width of the black stripe on the image.

for(int x = 0; x < 6; x++){
    for(int y  = 3; y >=0 ; y--){

        int xCo = ((y+x+1)*(tileWidth/2))-offset;
        int yCo = (x-y)*(tileHeight/2);
        wall.draw(g, xCo, yCo);
    }            
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:03:54.843

在等距领域中，您可以移动三个轴 - Z 表示上下，X 和 Y 表示“对角线”。

首先，让我们想象一个 1 x 1 x 1 单位的等距立方体的像素表示，所有边都表示相同的长度：

它在 Z 轴上将是 A 像素高。它的其他边缘的长度也是 A 像素，但旋转了 60 度 - 所以它将是 sin(30)*A 像素高和 cos(30)*A 像素在 X 和 Y 方向上长 - 也就是 0.5*A 和 sqrt (3)/2 *A。

因此，要在 X、Y 和 Z 中定位等距立方体大小的对象，我们必须通过以下方式在屏幕 x 和 y 上平移它：

```
y += Z*A
x += X*A/2 - Y*A/2
y += (X+Y)*A*sqrt(3)/2 
```

只要我做出的假设成立，这应该有效。

编辑：顺便说一句，如果图像具有深度，则必须对 A 进行硬编码，因此您无法从图像尺寸中自动提取 A。

# c# - 将授权标头添加到 Web 参考

> ID：14488991
> 
> 赞同：16
> 
> 时间：2013-01-23T20:42:03.843
> 
> 标签：c#, .net, web-services, web-reference, request-headers

我正在尝试向客户端的 Web 服务发出请求（我不知道客户端的底层平台）。我使用“添加 Web 引用”在 Visual Studio 2010 中使用了客户端的 WSDL，并生成了我的代理类（称为“ContactService”）。

我现在需要在我的服务请求中添加一个如下所示的授权标头。

```
Header=Authorization & Value=Basic 12345678901234567890 
```

（上面的“123456...”值只是占位符）

```
ContactService service = new ContactService();

//not sure if this is the right way - it's not working
WebClient client = new WebClient();
client.Headers.Add("Authorization", "Basic 12345678901234567890");            
service.Credentials = client.Credentials;

int contactKey = null;
try
{                
   contactKey = service.CreateContact("ABC", emailAddress, firstName, lastName, null);
} 
```

将授权标头添加到服务请求的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-24T13:07:22.243

上述反应是在正确的轨道上，但它只是必须在不同的位置。

我将此添加到 .Net 生成的 Web 参考代理类中：

```
protected override WebRequest GetWebRequest(Uri uri)
    {
        HttpWebRequest req = (HttpWebRequest)base.GetWebRequest(uri);            
        req.Headers.Add(HttpRequestHeader.Authorization,
                "Basic " + "12345678901234567890");

        return req;
    } 
```

Web 引用代理类扩展了 System.Web.Services.Protocols.SoapHttpClientProtocol。此类包含对 System.Net.WebRequest.GetWebRequest(Uri uri) 的调用。WebRequest 允许我们在调用代理类的方法时在请求上设置特定的标头。

谢谢你的帮助！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-23T20:48:02.290

有几个改变要做。

首先，有一个方便的常数`HttpRequestHeader.Authorization`。

其次，他们是否期望标头是 Base64 编码的 - 这通常是基本身份验证所必需的。

```
WebClient.Headers.Add(HttpRequestHeader.Authorization, 
    "Basic " + Convert.ToBase64String(System.Text.ASCIIEncoding.ASCII.GetBytes("12345678901234567890"))); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-11T12:28:45.527

我正在为现在有这个问题的人写这篇文章。正如前面的答案中提到的继承层次结构上升到`WebClientProtocol`类，这个类有一个`ICredentials`属性，只需通过一个`NetworkCredential`实例设置这个属性，如下所示：

```
YourServis.Credentials = new NetworkCredential("UserName", "Password", "Domain"); 
```

我认为 taht 是最简单的方法，无需更改 Reference.cs 或添加标题。

# android - 在 Android 中从钢琴中读取 MIDI 消息

> ID：14488995
> 
> 赞同：0
> 
> 时间：2013-01-23T20:42:14.853
> 
> 标签：android, usb, midi

我想读取和存储从钢琴发送的 MIDI 信息。我确实有一条 midi 到 USB 电缆，我可以将它连接到我的安卓手机，但我还没有找到关于如何阅读发送内容的答案。所有问题要么是关于 MIDI 文件，要么是没有给出太多答案。我的 Galaxy S2 确实可以用作 MIDI 主机，所以我想知道是否有一种方法是我只是读取原始信息然后对其进行解密（使用 MIDI 规范）还是已经有了一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:02:31.037

[USB MIDI Logger](https://play.google.com/store/apps/details?id=jp.kshoji.driver.midi.sample)显示带有 USB 设备的原始 MIDI 信息。

而且，源代码也可以在 github 上找到。 [https://github.com/kshoji/USB-MIDI-Driver](https://github.com/kshoji/USB-MIDI-Driver)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:58:18.590

我认为默认情况下 Android 不知道 MIDI 协议。

所以，你的任务分为两件事

*   从 USB 读取/写入数据

为此，请阅读[Android USB Host API](http://developer.android.com/guide/topics/connectivity/usb/host.html)。

*   实现 MIDI 协议

你可以看看[这里](https://ccrma.stanford.edu/~craig/articles/linuxmidi/misc/essenmidi.html)。但是，我相信您需要对此进行更多研究。

# java - Java Scanner 获取下一个分隔符

> ID：14488998
> 
> 赞同：1
> 
> 时间：2013-01-23T20:42:30.080
> 
> 标签：java, regex, java.util.scanner

我正在尝试捕获可以使用“\”将命令扩展到多行的命令。因此，可能的分隔符可以是：

```
Pattern assignment = Pattern.compile("[^\\\\]\\n"); 
```

当然，这有将'\n' 之前的最后一个非'\' 字符切掉的问题。我试图通过尝试以下方法来恢复该角色：

由于扫描仪的输入形式为：T1 D1 T2 D2 T3 D3.... 其中 T# 和 D# 分别对应于标记和分隔符编号“#”，我认为这会起作用：

```
Pattern p = Pattern.compile("\\\\?\\s+");

String residue = file.findInLine(assignment);
String curToken = file.next().trim();

if(residue == null)
   residue = "";
else
   residue = residue.trim();

Scanner tokens = new Scanner(curToken + residue).useDelimiter(p); 
```

findInLine 应该忽略扫描仪的分隔符，而不是获取 T1 和 D1 的连接，而是在模式与分隔符相同时返回 null！谁能解释这种奇怪的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:03:32.253

弄清楚如何获得我想要的行为，但我仍然不明白为什么我尝试的东西不起作用。

解决方案是使用不消耗非'\'的负面回顾：

```
Pattern assignment = Pattern.compile("(?<!\\\\)\\n"); 
```