# StackOverflow 问答 16004000-16004999

# ruby-on-rails - 查找具有 ID 的对象的名称

> ID：16004001
> 
> 赞同：2
> 
> 时间：2013-04-14T20:30:08.933
> 
> 标签：ruby-on-rails, ruby, sqlite

我有两个类**User**和**Schedule**：

```
class User < ActiveRecord::Base
  attr_accessible :startdate, :schedule_id, :password, :username
  belongs_to :schedule
end

class Schedule < ActiveRecord::Base
  attr_accessible :name
  has_many :users
end 
```

我想创建一个视图，在其中打印按用户过滤的对象计划的名称：

```
<table>
  <% @users.each do |user| %>
  <tr>
    <td><%= user.id %></td>
    <td><%= user.username %></td>
    <td><%= user.password %></td>
    <td><%= user.startdate %></td>
    <td><%= Schedule.find(user.schedule_id).name %></td>  # <<< This is what I want to do!
  </tr>
  <% end %>
</table> 
```

当我执行此操作时，我得到“找不到没有 ID 的计划”

我怎样才能做到这一点？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:53:43.607

我看不出您的代码有任何语法错误。如果它正在生成错误，请提供错误。要遵循 Ruby on Rails 约定，您应该能够做到：

```
<td><%= user.schedule && user.schedule.name %></td> 
```

这`&&`是在用户没有分配时间表的情况下。

# c# - 实体框架：自己的ondelete动作

> ID：16004002
> 
> 赞同：2
> 
> 时间：2013-04-14T20:30:09.563
> 
> 标签：c#, entity-framework, code-first

当从某个表中删除任何记录（让我们称之为 STORAGE_INFO）时，必须删除磁盘中的其他数据。谁能提供一个示例（如果可能的话）如何指定自己的 DELETE 操作？像这样的东西：

```
 DBSet<STORAGE_INFFO>.ONDELETE+= CUSTOM_FUNCTION

      CUSTOM_FUNCTION()
      {
          BASE.DELETE();
          DELETE_DISK_CONTENT();
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T20:36:41.883

可能您正在寻找[`ObjectContext.SavingChanges`活动](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.savingchanges.aspx)

如果您`context.ObjectStateManager.GetObjectStateEntries(EntityState.Deleted)`使用整个重载迭代调用方法的结果，您将能够检测到在`ObjectContext`保存一些更改时删除了哪些实体。

查看 MSDN 文章中的示例代码（这是一个很好的示例，说明如何实现您的目标！）：

*   [http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.savingchanges.aspx](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.savingchanges.aspx)

### 原海报说：

> 这很漂亮。但是我在哪里可以在 DBContext 类中找到这个事件？

向上转换`DbContext`为`IObjectContextAdapter`：

```
((IObjectContextAdapter)dbContext).ObjectContext.SavingChanges += ... 
```

# java - 比较数组列表中的元素

> ID：16004003
> 
> 赞同：0
> 
> 时间：2013-04-14T20:30:16.957
> 
> 标签：java, arrays, compare

我必须检查数组列表中的“令牌”是否按递增顺序排列。

```
private E[] data;      // where the data is stored   
private int size;      // how many items have been added to the list

public TopSpinArray(int numTokens, int spinSize)
{
    super(numTokens, spinSize);

    data = (E[])(new Object[numTokens]);
    size = 0;
} 

public boolean isSolved()
{     
    for(int i = 0; i < numTokens; i++)
    {
        if(data[i] < data[i+1])
        { 
            return true;
        }
    }
    return false;
} 
```

当我编译时，它说“二元运算符'<'第一种类型的错误操作数类型：E；第二种类型：E”

我如何检查它们是否在增加？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T20:35:05.437

该运算符`<`仅对某些类型的对象有效。为了能够比较任何可比较类型的对象（我认为您`E`的意思是您的令牌确实实现了[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)，否则您的问题毫无意义），您可以使用[`compareTo()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html#compareTo%28T%29)：

```
for(int i = 0; i < numTokens - 1; i++) {
     if(data[i].compareTo(data[i+1]) > 0) { 
         return false;
     }
}
return true; 
```

# java - 如何在 java 中的 DefaultListModel 中保存数据

> ID：16004005
> 
> 赞同：3
> 
> 时间：2013-04-14T20:30:34.150
> 
> 标签：java, swing, jlist, defaultlistmodel

我正在尝试使用 JList/DefaultListModel 创建一个列表，该列表在其内部保存数据。

这是我的问题。

```
DefaultListModel my_docs = new DefaultListModel();
JList my_jlist = new JList(my_docs);
// From here, I add elements to my_docs..
my_docs.addElement("Document 1");
my_docs.addElement("Document 2");
my_docs.addElement("Document 3"); 
```

我该怎么做才能将每​​个文档的文本（平均大约 4,000 个字节）保存在元素中，而不是在单击之前分配给另一个变量？

例如，如果我单击列表中的 Document 2，文档的文本将被分配给一个变量。如果我点击列表中的 Document 1，它会做同样的事情。

很抱歉用这么少的信息问这个问题，我只是不知道从哪里开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T20:59:50.680

您可以为文档创建包装器。例如，包装器可以公开数据和名称。如果需要，也可以按需加载数据。将包装器的实例添加到列表中。使用文档名称来呈现列表的每个条目。选择列表中的条目后，使用选定的项目进行处理。这是一个显示文档列表的简单示例。选择文档后，其内容将显示在文本区域中。

```
import java.awt.BorderLayout;
import java.awt.Component;
import javax.swing.*;
import javax.swing.event.*;

public class TestListModel {
    public TestListModel() {

        DefaultListModel model = new DefaultListModel();
        model.addElement(new DocumentWrapper("Doc 1", "Doc 1 data"));
        model.addElement(new DocumentWrapper("Doc 2", "Doc 2 data"));
        model.addElement(new DocumentWrapper("Doc 3", "Doc 3 data"));

        final JList list = new JList();

        final JTextArea output = new JTextArea(5, 40);
        list.setModel(model);
        list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        list.setCellRenderer(new DocumentWrapperRenderer());

        list.getSelectionModel().addListSelectionListener(
                new ListSelectionListener() {
                    @Override
                    public void valueChanged(ListSelectionEvent e) {
                        if (!e.getValueIsAdjusting()) {
                            DocumentWrapper docWrapper = (DocumentWrapper) list
                                    .getSelectedValue();
                            if (docWrapper != null) {
                                output.setText(docWrapper.getData());
                            } else {
                                output.setText("");
                            }
                        }
                    }
                });

        JFrame frame = new JFrame("Document list");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new JScrollPane(list));
        frame.add(output, BorderLayout.SOUTH);
        frame.setLocationByPlatform(true);
        frame.pack();
        frame.setVisible(true);
    }

    public class DocumentWrapper {
        private String data;
        private String name;

        public DocumentWrapper(String name, String data) {
            this.name = name;
            this.data = data;
        }

        public String getData() {
            return data;
        }

        public String getName() {
            return name;
        }
    }

    public static class DocumentWrapperRenderer extends DefaultListCellRenderer {
        @Override
        public Component getListCellRendererComponent(JList list, Object value,
                int index, boolean isSelected, boolean hasFocus) {
            if (value instanceof DocumentWrapper) {
                return super.getListCellRendererComponent(
                        list, ((DocumentWrapper) value).getName(), index,
                        isSelected, hasFocus);
            }
            return super.getListCellRendererComponent(list, value, index, 
                    isSelected, hasFocus);
        }
    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestListModel();
            }
        });
    }
} 
```

# android - 我怎样才能获得已经挂起的 PendingIntent 的 Intent 附加功能？

> ID：16004006
> 
> 赞同：5
> 
> 时间：2013-04-14T20:30:54.240
> 
> 标签：android, android-pendingintent

我已经安排了一个`PendingIntent`with `AlarmManager`。当`AlarmManager`交付时`Intent`，我能够收到`getExtras()`我最初发送的所有数据。

但是，有时我会在火灾发生`Intent`之前获得想要通过 , 传递的其他数据。`AlarmManager`我的想法是，我会得到`Intent`我要取消它的感觉，但是在取消它之后，更新附加内容并用 重新安排它`AlarmManager`，如下所示：

```
Intent i=new Intent(this, MyReceiver.class);
Bundle b = i.getExtras();
PendingIntent pi=PendingIntent.getBroadcast(this, id,i, 0);
if (b == null) b = i.getExtras(); // in case I can't get it before calling getBroadcast
// now add a key to b, put it in a new intent, schedule it, and cancel the old one? 
```

我`getBroadcast()`使用与之前安排的相同的 ID 进行呼叫。唯一的问题是，当我调用它时，`getExtras()`它总是返回 null。这似乎与我经常看到的问题相反，其中一个`Intent`将被缓存并且这是不希望的。在这种情况下，我实际上想要获取缓存`Intent`并获取它的值，并且由于`Intent`它处于挂起状态，它应该仍然存在。

我该怎么做呢？

我有过和/或尝试过的几个想法。一个围绕`Intent.fillIn()`函数展开，我是否可以使用它来指示它应该（或不应该）覆盖附加内容，以便我可以检索原始内容。

再看远一点，我看到`PendingIntent`了`writeToParcel()`。我可以使用它来访问附件的附加功能`Intent`吗？我的尝试`readBundle: bad magic number`在 readParcel 上失败，但出现异常：

```
PendingIntent pi=PendingIntent.getBroadcast(this, id,i, 0);
Parcel out = Parcel.obtain();
pi.writeToParcel(out, 0);
i.readFromParcel(out); 
```

我怀疑这可能是因为我正在输出 a`PendingIntent`但试图将其作为`Intent`.

另一个想法是我可以调用 send()`PendingIntent`以使其立即交付，并传递一个`Intent`带有新键的新键来添加。然后在处理程序中，我必须遍历意图附加项中的所有键。`PendingIntent`然后，`AlarmManager`如果还没有时间进行实际处理，则需要重新发出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T06:31:41.730

尝试这个

```
pi = PendingIntent.getBroadcast(this, id, i, 
                       PendingIntent.FLAG_UPDATE_CURRENT) 
```

这里我们发送**PendingIntent.FLAG_UPDATE_CURRENT**意图标志，如果相同的 PendingIntent 存在，它将按原样返回，否则将返回一个新的 PendingIntent。

请注意，当我们说意图匹配时，URI、数据类型、类别将被匹配，而在匹配时意图附加内容将被忽略。换句话说， **IntentFilters**将匹配两个意图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-28T16:59:28.707

好的，我终于找到了解决这个问题的方法。

似乎无法`Intent`从 a中获取`PendingIntent`，但可以在`Intent`传递的 to中添加额外`getBroadcast()`内容 - 最后一个参数（标志）为零很重要，这样它就不会覆盖现有的额外内容。

此外，附加项包含名称/值对，重要的是添加的新键与现有的键不匹配`Intent`。这意味着`removeExtra()`必须在完成时调用它以在下次之前摆脱密钥。然后调用自己`send()`的`PendingIntent`目标，然后当接收到意图时，可以访问新的和旧的额外内容。然后可以将这两个额外的内容收集到一个新`Intent`的中，然后`AlarmManager`可以调用它来重新安排。

# django - Django，设计一个与另一个模型部分链接的模型

> ID：16004007
> 
> 赞同：0
> 
> 时间：2013-04-14T20:30:56.380
> 
> 标签：django, database-design, django-models

我正在开发一种功能，以将博客可见性限制为给定的用户列表（博客查看者）。我想使用电子邮件地址添加查看器，因此如果用户不存在此电子邮件地址，则会向用户发送邀请以创建帐户。

因此，在 BlogViewer 中，我有一些电子邮件地址，其中一些存在于我的用户模型中，而另一些则不存在。如何将我的 BlogViewer 模型链接到我的 Users 模型？我是否应该将我的 BlogViewer 分成两个模型，一个用于现有用户，以便我可以使用 ForeignKey，另一个用于不存在的用户？

```
def Blog(models.Model):
    creator = models.ForeignKey(User)
    title = models.CharField()
    description = models.TextField()
    viewers = models.ManyToManyField(BlogViewer)

def BlogViewerr(models.Model):
    email= models.EmailField()

#Part of my User model
def User(models.Model):
    email = models.EmailField()
    username = models.CharField()
    ... 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T08:06:50.623

我设法使用可为空的外键和设计模型来解决这个问题：

```
def Blog(models.Model):
    title = models.CharField()
    ...
    viewers = models.ManyToManyField(UserModel, through='BlogViewer')

def BlogViewer(models.Model):
    email = models.EmailField()
    user = models.ForeignKey(UserModel, null=True)
    blog = models.ForeignKey(Blog) 
```

如果存在具有给定电子邮件地址的用户，则更新用户字段，否则将其保留为空。如果用户不存在，我仍然可以使用电子邮件地址向用户发送电子邮件，邀请加入。

# jquery - 使用 c:foreach 创建一个列表并在项目上放置一个带有参数的 onClick 侦听器

> ID：16004014
> 
> 赞同：1
> 
> 时间：2013-04-14T20:31:23.627
> 
> 标签：jquery, spring, model, foreach, onclick

我正在尝试通过以下方式在 jsp 页面中构建项目列表：我有一个 Spring Mvc 控制器，它返回模型中的搜索结果。我可以通过 jsp 中的以下代码访问此模型中的对象：

```
<c:forEach var="listItem" items="${poiList}">
            <div class="manageListItem">
                <table>
                    <tr>
                        <td><c:out value="${listItem.getName()}"/></td>
                        <td><c:out value="${listItem.getAddress()}"/></td>
                        <td><c:out value="${listItem.getType()}"/></td>
                        <td><c:out value="${listItem.getRating()}"/></td>
                    </tr>
                </table>
            </div>
</c:forEach> 
```

列表打印得很好。但是，我希望每个项目都可以点击并在点击时重定向到某个页面（更像是向控制器发送另一个请求）。

到目前为止，我已经尝试过 jquery，但是如果我不在那里构建列表，我将无法访问请求所需的 listItem 的 ID。如果我能以某种方式将它作为参数传递给 manageListItem div 的 onClich 属性，那就太好了，但这似乎是不可能的。我也可以在 jQuery 中完成所有操作，但这看起来更简洁，而且我不知道如何在 jQuery 中访问模型的属性 :)

实现此功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:53:53.960

您可以在行上放置一个 onclick 侦听器，并且可以像往常一样使用 JSP EL 引用项目 ID。看看这个例子：

```
<c:forEach var="listItem" items="${poiList}">
  <div class="manageListItem">
    <table>
      <tr onclick="alert('I clicked on '+${listItem.id});">
        <td><c:out value="${listItem.getName()}"/></td>
        <td><c:out value="${listItem.getAddress()}"/></td>
        <td><c:out value="${listItem.getType()}"/></td>
        <td><c:out value="${listItem.getRating()}"/></td>
      </tr>
    </table>
  </div>
</c:forEach> 
```

你总是可以调用另一个函数，或者在 onclick 部分中有 jQuery 的东西；要点是您可以使用 JSP EL 构建可以对事件做出反应的 javascript 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:36:20.833

如果您没有提到您的浏览器要求是什么，但大多数“现代”浏览器将支持使用`data-`属性。在你的情况下：

```
<c:forEach var="listItem" items="${poiList}">
            <div class="manageListItem" data-item-id="${listItem.getId()}">
                <table>
                    <tr>
                        <td><c:out value="${listItem.getName()}"/></td>
                        <td><c:out value="${listItem.getAddress()}"/></td>
                        <td><c:out value="${listItem.getType()}"/></td>
                        <td><c:out value="${listItem.getRating()}"/></td>
                    </tr>
                </table>
            </div>
</c:forEach> 
```

现在，使用[jquery data()](http://api.jquery.com/jQuery.data/)方法很简单：

```
$('div.manageListItem').click(function(evt) {
     var id = $(this).data('itemId');
     alert('Huzzah, you clicked on ' + id);
}); 
```

仅供参考，如果您创建一个具有名为 属性的元素，则`data-my-item-id`需要使用 jquery 检索它`myItemId`。首字母之后的所有内容都`data-`转换为驼峰式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:00:41.137

```
$(document).on('click', '.manageListItem td', function(e){
    //i think the value is just the text in the TD, no?
    window.location = window.location.protocol + '//' + window.location.host + '?listItemId=' + $(this).text()
}); 
```

使用 jQuery `.on()`，我们可以委托监听静态元素的事件。对于动态元素，这将确保它们仍然可以触发事件。`.on()`接受 3 个参数：事件、我们想要触发事件的元素，当然还有在事件触发时运行的回调函数。

根据您上面的标记，我假设您在其中打印的值`td`是您的 listItemId。

线`window.location = window.location.protocol + '//' + window.location.host + '?listItemId=' + $(this).text()`

会抢协议

```
http: 
```

然后我们用两个尾部正斜杠连接字符串`//`（如果没有 http/https，// 在 URL 仍然有效之前）。

然后我们抓取主机位置

```
stackoverflow.com 
```

然后我们在 TD 内附加一个带有文本的查询字符串。

```
?listItemId=8 
```

例如，如果您`c:out`打印了 8，那么整个 url 看起来像

`http://stackoverflow.com?listItemId=8`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T18:54:30.057

谢谢你的所有这些想法！

最后，我发现将重定向命令直接写入标签的 onClick 属性是最简单的：

```
<c:forEach var="listItem" items="${poiList}">
            <div class="manageListItem" onclick="window.location.replace('/poi/display/' + ${listItem.id})">
                <table>
                    <tr>
                        <td><c:out value="${listItem.getName()}"/></td>
                        <td><c:out value="${listItem.getAddress()}"/></td>
                        <td><c:out value="${listItem.getType()}"/></td>
                        <td><c:out value="${listItem.getRating()}"/></td>
                    </tr>
                </table>
            </div>
        </c:forEach> 
```

这样，每个被点击的列表项都会发送一个带有自己 ID 的请求，并且控制器会按预期处理该请求。

# entity-framework - 配置 DropCreateDatabaseAlways

> ID：16004015
> 
> 赞同：1
> 
> 时间：2013-04-14T20:31:24.450
> 
> 标签：entity-framework

我已经成功地在我的 app.config 文件中使用以下配置来设置实体框架初始化策略。

```
<databaseInitializer type="System.Data.Entity.MigrateDatabaseToLatestVersion`2[[My.DataLayer.MyModelContext, My.DataLayer], [My.DataLayer.Migrations.Configuration, My.DataLayer]], EntityFramework"></databaseInitializer> 
```

现在我想将其更改为 DropCreateDatabaseAlways 但在调用 update-database 或运行程序时我不断收到错误消息。

```
<databaseInitializer type="System.Data.Entity.DropCreateDatabaseAlways`2[[My.DataLayer.MyModelContext, My.DataLayer], [My.DataLayer.Migrations.Configuration, My.DataLayer]], EntityFramework"></databaseInitializer> 
```

除了 DropCreateDatabaseAlways 与 MigrateDatabaseToLatestVersion 之外，语法完全相同。

错误：

```
Failed to set database initializer of type 'System.Data.Entity.DropCreateDatabaseAlways`2[[My.DataLayer.MyModelContext, My.DataLayer], [My.DataLayer.Migrations.Configuration, My.DataLayer]], EntityFramework' for DbContext type 'My.DataLayer.MyModelContext, My.DataLayer' specified in the application configuration. See inner exception for details. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:35:36.300

在``2` 符号的帮助下，您可以指定通用参数。

您需要编写``2`，因为[MigrateDatabaseToLatestVersion](http://msdn.microsoft.com/en-us/library/hh829293%28v=vs.103%29.aspx)类有两个通用参数。

但是[DropCreateDatabaseAlways](http://msdn.microsoft.com/en-us/library/gg679506%28v=vs.103%29.aspx)只**接受一个通用参数** `TContext baseAlways<TContext> : IDatabaseInitializer<TContext>`

所以你需要写

```
<databaseInitializer type="System.Data.Entity.DropCreateDatabaseAlways`1[[My.DataLayer.MyModelContext, My.DataLayer]], EntityFramework"></databaseInitializer> 
```

# javascript - 使用jQuery单击多个复选框

> ID：16004017
> 
> 赞同：0
> 
> 时间：2013-04-14T20:31:27.893
> 
> 标签：javascript, jquery, checkbox, onchange

当我检查标题复选框时，我试图检查多个子复选框。我的代码很[糟糕](http://jsfiddle.net/sandeepd/sF3My/8/)。

我的代码是：

```
$('input.fieldCheck'.on('change', function(event) {
var $rows = $(this).parents('tr.field').nextUntil('tr.field');
var isChecked = this.checked;
$rows.each(function() {
    $(this).find('input.subFieldCheck').each(function() {
        $(this).prop('checked', isChecked);
    });});        
})); 
```

这有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T20:48:57.447

有三个主要问题导致此方法不起作用。

1 -`$('input.fieldCheck'.on('change',`缺少结束`)`

2 - 您试图遵循名为 的命名模式`lower camel case`，不幸的是，您错过了它；因为每一个都`input.subFieldCheck`应该是`input.subfieldCheck`，请注意您是如何错过`field`此处单词上的 LCC 模式的。

`)`3 - 活动结束时还有一个额外的内容`on('change')`。在小提琴中也删除了。

4 -[这是您的工作 jsFiddle](http://jsfiddle.net/ZJ4sA/)（也清除了 HTML 标记中的一些错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:04:31.983

Try this (with a nice long jQuery chain and no assignments) :

```
$('input.fieldCheck').on('change', function(event) {
    $(this).closest('tr.field').nextUntil('tr.field').find('input.subfieldCheck').prop('checked', this.checked);
}); 
```

**[Updated fiddle](http://jsfiddle.net/sF3My/10/)**

# c - 在 C 中将字符串转换为小写/计数单词的问题

> ID：16004019
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:31:44.053
> 
> 标签：c, char, constants, tolower

在我的第三个函数中，我在 const char* it = s; 处遇到语法错误 当我尝试编译时。我的朋友让这个程序在他的编译器上工作，但是我使用的是 Visual Studio，它不会编译。任何和所有的帮助将不胜感激！

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>

//Declaring program functions
char concStrings(); 
int compStrings();
int lowerCase();
int birthday();

//Main function begins the program execution
int main (void)
{
concStrings( );
compStrings();
lowerCase();
birthday();

}
//end main function

//concatenate function
char concStrings ( )
{
char string1[20];
char string2[20];
char string3[50] = "";;

printf("Enter in two strings:");
gets(string1);
gets(string2);

strcat(string3, string1);
strcat(string3, "-");
strcat(string3, string2);

printf("The new string is: %s\n", string3);

}

// compare function
int compStrings() 
{
char string1[20];
char string2[20];
int result;

printf ( "Enter two strings: ");
//  scanf( "%s%s", string1, string2 );
gets(string1);
gets(string2);

result = strcmp ( string1, string2 );

if (result>0)
printf ("\"%s\"is greater than \"%s\"\n", string1, string2 );
else if (result == 0 )
printf ( "\"%s\" is equal to \"%s\"\n", string1, string2 );
else
printf ( "\"%s\" is less than \"%s\"\n", string1, string2);
return 0;
}

//lowercase function
int lowerCase()
{
char s[300];
int x;
int counted = 0;
int inword = 0;

printf ("Enter a sentence:");
//  scanf("%s", s);
gets(s);

const char* it = s;

printf ("\nThe line in lowercase is:\n");

for (x = 0; s[x] !='\0'; x++)
printf ("%c", tolower(s[x]));

do
{ 
switch(*it) 
{ 
  case '\0': case ' ': case '\t': case '\n': case '\r':
    if (inword)
   {
     inword = 0; counted++;
    }
    break; 
  default: 
    inword = 1;
 } 
 }
while(*it++);

printf("\nThere are %i words in that sentence.\n", counted);

return 0;
}

int birthday()
{
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T20:34:53.763

C89（MSVC 遵循 C89 标准）禁止在块中混合声明和语句：

```
gets(s);
const char* it = s; 
```

您的`it`对象声明是在`gets`函数调用之后，C89 不允许这样做。

此外`gets`，最新的 C 标准中删除了函数，在所有 C 程序中应不惜一切代价避免使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:19:58.377

**你在变量声明块的开头做。**对于老 c。

改成

```
int lowerCase()
{
char s[300];
int x;
int counted = 0;
int inword = 0;
const char* it;

printf ("Enter a sentence:");
//  scanf("%s", s);
gets(s);

it = s; 
```

或者

```
rename progname.c progname.cpp 
```

# css - 列表和浮点数的奇怪包装

> ID：16004023
> 
> 赞同：0
> 
> 时间：2013-04-14T20:32:06.540
> 
> 标签：css, css-float, html-lists

[http://jsfiddle.net/cqEw2/](http://jsfiddle.net/cqEw2/)

标记：

```
<section>
    <h1>Title of this section</h1>

    <ol>
        <li>Thing thing thing thing thing thing thing thing</li>
        <li>Thing Thing Thing Thing THING THING THING</li>
    </ol>

    <nav>
        <ol>
            <li>Place1</li>
            <li>PlaceThatIsSecond</li>
            <li>Place3</li>
            <li>Place4</li>
            <li>Place5</li>
        </ol>
    </nav>
</section> 
```

款式：

```
section > ol {
        display: block;
        float: right;
        clear: both;
        max-width: 80%;
}

section > nav {
    max-width: 20%;
} 
```

当您缩小窗口时，长条目会导致列表的其余部分被推到主要内容下方，但左侧较早的列表条目仍位于上方。真的，整个事情应该立即下降，或者可能只是继续缩小。我没有遇到使用段落和块引用的类似侧边栏样式的这种行为。这是我的浏览器选择布局列表的方式所特有的，还是在标准中我遗漏了一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:48:36.017

如果添加一个位置：绝对；它应该解决主要内容被推到下面的问题。

```
section > ol {
    display: block;
    float: right;
    clear: both;
    max-width: 80%;
}
section > nav {
   max-width: 20%;
   position:absolute;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:54:27.300

更改`section > ol`以`section ol`确保将块应用于两个`ol`元素。

# jquery - 如何使用jquery获取数据属性值的元素？

> ID：16004025
> 
> 赞同：3
> 
> 时间：2013-04-14T20:32:12.100
> 
> 标签：jquery

考虑以下问题，如何获取特定数据属性值的最后一个元素？

```
 <tr data-log="sectionA"><td>Log Information</td></tr>
      <tr data-log="sectionA"><td>Log Information</td></tr>
      <tr data-log="sectionA"><td>Log Information</td></tr>
      <tr data-log="sectionA"><td>Log Information</td></tr> <--- I need this last element of sectionA
      <tr data-log="sectionB"><td>Log Information</td></tr>
      <tr data-log="sectionB"><td>Log Information</td></tr>
      <tr data-log="sectionB"><td>Log Information</td></tr>
      <tr data-log="sectionB"><td>Log Information</td></tr> 
```

我不确定要尝试什么..感谢您的任何想法...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:36:06.330

怎么样

```
$('[data-log="sectionA"]:last') 
```

[http://jsfiddle.net/U9HQH/](http://jsfiddle.net/U9HQH/)

# php - 选项标签中的代码将空白数据发送到数据库

> ID：16004046
> 
> 赞同：0
> 
> 时间：2013-04-14T20:33:54.950
> 
> 标签：php, html, mysql

我建立了一个将 Service Mechanic 客户存储到数据库的站点。它具有更新条目的功能。我有一个下拉选择字段工作正常（它仍然可以）。但是我在事实之后添加的第二个仅返回空白以获取信息。

这是我的代码。

```
include('connect.php');

$table='currentJobs';
$tableMap=array('Date','Name','Phone','Bike_Year','Bike_Model','Current_Status','SType','Mechanic','Revenue','Notes');

$sqlArray=array();

foreach ($tableMap AS $key){
    $sqlArray[]="`".$key."`='".mysql_real_escape_string(@$_POST[$key],$dbLink)."'";
}

$sql="UPDATE `".$table."` SET ".join(',',$sqlArray)." WHERE `id`='".$_POST['id']."'";

if (mysql_query($sql,$dbLink)){
    echo 'Data for <i>' .$_POST['Name'].'</i> was successfully updated <br />'.$sql.'.';
}
else {
    echo 'Sorry, could not process the following sql: <br /><code>'.$sql.'</code>';
    echo mysql_errno($dbLink) . ": " . mysql_error($dbLink). "\n";
}

mysql_close($dbLink); 
```

它正在返回：

```
Data for Test User was successfully updated 
UPDATE `currentJobs` SET `Date`='04/14/2013',`Name`='Test User',`Phone`='1234567890',`Bike_Year`='2001',`Bike_Model`='FXD',`Current_Status`='Checked In',`SType`='',`Mechanic`='All',`Revenue`='0',`Notes`='' WHERE `id`='55'. 
```

我的表格如下所示：

```
<form action="updated.php" method="POST" name="dataForm" id="dataForm">
<fieldset>
    <input type="hidden" name="id" value="<?php echo $row['id']; ?>"/>
    <label>Arrival<input type="text" name="Date" value="<?php echo $row['Date']; ?>"/></label><br />
    <label>Name<input type="text" name="Name" value="<?php echo $row['Name']; ?>"/></label><br />
    <label>Phone Number<input type="text" name="Phone" value="<?php echo $row['Phone']; ?>"/></label><br />
    <label>Bike Year<input type="text" name="Bike_Year" value="<?php echo $row['Bike_Year']; ?>"/></label><br />
    <label>Bike Model<input type="text" name="Bike_Model" value="<?php echo $row['Bike_Model']; ?>"/></label><br />
    <label>Current Status<!--Update Status types on two pages-->
        <select name="Current_Status" form="dataForm" value="<?php echo $row['Current_Status']; ?>">
            <option value="Checked In">Checked In</option>
            <option value="Inline For Service">Inline For Service</option>
            <option value="In Service">In Service</option>
            <option value="On Hold - Parts on Order">On Hold - Parts on Order</option>
            <option value="On Hold - Parts to Paint">On Hold - Parts to Paint</option>
            <option value="On Hold - Waiting To Hear From Customer">On Hold - Waiting To Hear From Customer</option>
            <option value="Test Ride">Test Ride</option>
            <option value="Completed - Awaiting Pick Up">Completed - Awaiting Pick Up</option>
            <option value="Picked Up">Picked Up</option>
        </select>
    </label><br />
    <!--update Service Type in two pages.-->
    <label>Service Type</label>
        <select name="SType" form="" value="<?php echo $row['SType']; ?>">
            <option value="Spec Service Interval">Spec Service Interval</option>
            <option value="Interim Service">Interim Service</option>
            <option value="Diagnostics">Diagnostics</option>
            <option value="Tires">Tires</option>
            <option value="Engine– Light Work (1-3 hrs)">Engine– Light Work (1-3 hrs)</option>
            <option value="Engine– Medium Work (3-8 hrs)">Engine– Medium Work (3-8 hrs)</option>
            <option value="Engine– Heavy Work (8-24 hrs)">Engine– Heavy Work (8-24 hrs)</option>
            <option value="Drivetrain– Light">Drivetrain– Light</option>
            <option value="Drivetrain - Heavy">Drivetrain - Heavy</option>
            <option value="Dyno Tune">Dyno Tune</option>
        </select>
    <br />
    <label>Mechanic Assigned<input type="text" name="Mechanic" value="<?php echo $row['Mechanic']; ?>"/></label><br />
    <label>Final Revenue<input type="text" name="Revenue" value="<?php echo $row['Revenue']; ?>"/></label><br />
    <label>Notes<input type="text" name="Notes" value="<?php echo $row['Notes']; ?>"/></label><br />
    <input type="submit" value="Update" style="color:#000000;" />
</fieldset> 
```

为什么第二个选择不发送数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:40:33.543

该`select`标签没有名为`value`.

[http://www.w3schools.com/tags/tag_select.asp](http://www.w3schools.com/tags/tag_select.asp)

更新：

像这样的东西会更有用：

```
<label>Service Type</label>
    <select name="SType" form="dataForm">
    <?php
    $Stypes = array(
    "Spec Service Interval",
    "Interim Service",
    "Diagnostics",
    "Tires",
    "Engine– Light Work (1-3 hrs)",
    "Engine– Medium Work (3-8 hrs)",
    "Engine– Heavy Work (8-24 hrs)",
    "Drivetrain– Light",
    "Drivetrain - Heavy",
    "Dyno Tune",
    );

    foreach($Stypes as $value){
      if ($value==$row['SType']){
        echo "<option value=\"$value\" selected=\"selected\">value</option>";  
      } else {
        echo "<option value=\"$value\">$value</option>";  
      }
    }

    ?>

    </select> 
```

假设您`$row['Stype']`要从数据库中撤出。

同样正如@Fred 所说，如果您使用的是 HTML5，您可能需要为该属性指定一个*表单 ID*`form`（尽管这在 IE 中不起作用......但是）。

您还可以`print_r($_POST)`在进行插入的页面上进行调试，以验证发生了什么。

# arduino - 处理找不到Arduino？

> ID：16004049
> 
> 赞同：0
> 
> 时间：2013-04-14T20:34:12.503
> 
> 标签：arduino, processing, firmata

我在[Processing](http://en.wikipedia.org/wiki/Processing_%28programming_language%29)中使用 Arduino 库。但是所有示例[草图](http://www.arduino.cc/en/Tutorial/Sketch)都不起作用。我尝试使用`Arduino.list[0]`and更改串行端口`Arduino.list[1]`。如果我选择任何更高的数字，它会引发错误，所以我假设它只看到两个串行设备。

我的 Arduino 已连接并正常工作。我通过 Arduino 应用程序使用它没有问题。

还有哪些其他可能的问题？

*[在Arduino 和 Processing](http://playground.arduino.cc/interfacing/processing)*页面上有一个示例草图，我一直在使用它来进行故障排除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T09:22:44.260

如果您这样做，您应该在终端中看到 Arduino 板的名称`ls /dev/tty.*`。`ls`插上板子前后试着做命令看看效果。

通常在 Mac 上，它以其他开头`tty.usbmodem`，而在 PC 上则是 COM3、COM4 等，因此您可以执行以下操作：

```
void setup(){
    String[] arduinoList = Arduino.list();
    for (int n=0;n<arduinoList.length && arduino==null;++n) {
        if (arduinoList[n].startsWith("/dev/tty.usbmodem")) {
            println("Arduino found at: " + Arduino.list()[n]);
            arduino = new Arduino(this, Arduino.list()[n], 57600);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:10:58.873

这个页面很有帮助：[http ://wiki.processing.org/w/Serial_Issues](http://wiki.processing.org/w/Serial_Issues)

最终，使用

```
print(Serial.list()[0]); 
```

并尝试数字直到串行端口的名称与 Arduino IDE 成功上传到的名称相匹配。

希望这对将来的某人有所帮助。

# c# - 为基于 Kinect 的手势识别构建 HMM

> ID：16004052
> 
> 赞同：1
> 
> 时间：2013-04-14T20:34:18.870
> 
> 标签：c#, algorithm, kinect, gesture-recognition, hidden-markov-models

我有一个概念问题。我正在创建一个使用 Kinect 进行手势识别的程序。我有一些按类别划分的手势数据（圆圈、滑动等）。现在我只分析一只手。我记录了所有帧（30fps）。

(*) 为了使我的数据离散且与位置无关，我计算了连续点之间的角度。

现在我想`hidden Markov models`为每种手势类型创建。

现在我需要为我的`HMM`. 怎么做？我想找到最长的手势（及时）。例如，我有 3 个手势，第一个`1,2s`、第二个`1,4s`和第三个`1,5s`。`1,5s`最长的也是如此。现在我想每 250 毫秒（一秒内 4 个样本）为每个帧应用 (*)。因为我最长的手势很`1,5s`长，所以`NumberOfStatesForHMM = 1500ms / 250ms = 6 states`- 这应该是最佳的？

我不确定我应该如何定义状态`HMM`：/如果我上面的想法是正确的，当有（例如）6个状态并且一个手势在之后结束时如何计算转换概率`1s`，所以我分析了4个状态（从状态转换的概率4 到 5 和 5 到 6 等于 0？）。

我读了[这篇](http://www.waset.org/journals/ijeee/v3/v3-3-26.pdf)论文，但我不太确定如何解决我的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T10:52:26.383

我从事过一个类似的动态手势识别项目（尽管使用的是更简单的网络摄像头而不是 Kinect）。就我而言，我将手势分类为左、右、循环顺时针、循环逆时针......等。由于您将考虑连续点之间的角度，这将是您的观察序列。至于状态，您的状态和观察之间可能不一定总是存在逻辑关系。我正在使用 8 个手势。现在，对于每个输入模式，我有大约 12 个观察符号，但没有。每个类的状态是不同的。例如：左：2 个状态 右：3 个状态 顺时针循环：4 个状态等。

优点是从我从维特比算法得到的状态序列输出中，我可以直接得到最大的状态数，从而得到我的类。此外，在学习阶段，我的 Baum-Welch 实现会根据编号自动学习类。的州。您可以参考我的博客文章 [其中描述了我在项目中使用 HMM 识别手势的方法] 以获取更多信息。我希望它对你有帮助。

[链接在这里](http://hcicv.blogspot.in/2012/07/hidden-markov-model-for-dummies.html)

# parsing - 如何在不使用递归的情况下将输入拆分为可变长度的片段？

> ID：16004065
> 
> 赞同：1
> 
> 时间：2013-04-14T20:36:16.113
> 
> 标签：parsing, clojure

我有一个包含以下内容的输入文件：

```
2
stuff-11
stuff-12
3
stuff-21
stuff-22
stuff-23
1
stuff-31 
```

我想得到以下结果：

```
([stuff-11 stuff-12] [stuff-21 stuff-22 stuff-23] [stuff-31]) 
```

我最初的解决方案是使用带有累加器的递归，如下所示：

```
(defn parse-input [lines accum]
   (if (= 0 (count lines))
       accum
       (let [[line-num (Integer. (first lines))]
             [head tail] (split-at (+ 1 line-num) lines)]
             [stuff (vec (drop 1 head))]]
            (parse-input tail (concat accum [stuff]))))
(def result (parse-input input [])) 
```

但是，据我了解，由于 JVM 上缺乏 TCO，递归函数在 Clojure 中并不惯用。

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:15:21.800

```
user=> (require '[clojure.string :as s])
nil
user=> (require '[clojure.edn :as edn])
nil
user=> (keep-indexed #(if (odd? %) %2) 
                     (partition-by (comp number? edn/read-string) 
                     (s/split-lines (slurp "/tmp/input.txt"))))
(("stuff-11" "stuff-12") ("stuff-21" "stuff-22" "stuff-23") ("stuff-31")) 
```

其中`/tmp/input.txt`包含您提供的文本。

如果您想获得一系列向量，请替换`#(if (odd? %) %2)`为。`#(if (odd? %) (vec %2))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T23:50:09.160

我不喜欢 Michiel Borkent 的回答有几个原因，其中之一是`((comp number? read-string) "3 blah blahb stuff and etc")`返回 true 的事实。此外，虽然它可能很简洁，但它并不是非常直观或可扩展。

我认为您对使用递归有正确的直觉，但是惰性 seq 更惯用。

```
(defn parse-stuff [text]
  (let [step (fn step [[head & tail]]
               (when-let [n (clojure.edn/read-string head)] 
                 (cons (vec (take n tail))
                   (lazy-seq (step (drop n tail))))))]
     (step (clojure.string/split-lines text)))) 
```

# android - 在子类化 ArrayAdapter 中，通过 getView 的视图为空？为什么？

> ID：16004067
> 
> 赞同：0
> 
> 时间：2013-04-14T20:36:27.900
> 
> 标签：android, android-listview

我是 ArrayAdapter 的子类，但是通过 getView 的视图是空的？这是为什么？

我必须在 getView 方法中手动指定视图。发送到此方法的视图从何而来？

```
public class CustomList2 extends ArrayAdapter<String>
{
    public CustomList2(Context context, int layout_id, ArrayList<String> objects){
        super(context, layout_id, objects);
    }

    @Override
    public View getView(final int position, View view, ViewGroup view_group) {
       if(view == null) 
       {
           LayoutInflater inflater = getLayoutInflater();
           view = inflater.inflate(R.layout.customlist, null);
       }
      return view;
    }
} 
```

适配器和视图设置如下：

```
video_list = (ListView)findViewById(R.id.list);
video_list.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T20:41:32.163

您需要调用超类的`getView`方法来获取默认行为：

```
public class CustomList2 extends ArrayAdapter<String>
{
    public CustomList2(Context context, int layout_id, ArrayList<String> objects){
        super(context, layout_id, objects);
    }

    @Override
    public View getView(final int position, View view, ViewGroup view_group) {
        view = super.getView(position, view, view_group);
        // Do something special with the view
        return view;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:48:25.703

当没有要重用的视图时，发送到 getView 的视图可能为空。

如果它为空，您需要创建您的视图或调用 super（如 ianhanniballake 建议的）。

这是 ListView 中的缓存功能，使其响应速度更快。

# linux - 如何使用 Apache 自动启动 Django Celery？

> ID：16004073
> 
> 赞同：1
> 
> 时间：2013-04-14T20:36:51.397
> 
> 标签：linux, django, apache, celery, django-celery

我已经按照这些[说明](https://stackoverflow.com/questions/8404325/django-celery-works-in-development-fails-in-wsgi-production-how-to-debug)在我的生产服务器中设置了 Django 和 Celery ，它可以工作。

我现在需要 celery 启动等。这怎么做？

我正在运行 Ubuntu 和 Apache，我要向我的虚拟主机添加一些东西吗？

任何帮助，入门指南都会有所帮助。我用谷歌搜索但没有找到任何东西。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T07:34:42.777

运行以下命令。它将使您的 /etc/init.d/celeryd 在启动时启动。

```
sudo update-rc.d celeryd defaults 
```

# python - Python：导入模块导入模块

> ID：16004076
> 
> 赞同：6
> 
> 时间：2013-04-14T20:37:21.337
> 
> 标签：python, python-import

所以在一个文件 foo 我正在导入模块：

```
import lib.helper_functions
import lib.config 
```

在 helper_functions.py 中，我有：

```
import config 
```

当我运行 foo 的主要功能时，我得到一个 ImportError

编辑：这是我拥有的文件的结构

```
foo.py
lib/
    config.py
    helper_functions.py 
```

错误是在 helper_functions 中导入配置导致的

```
Traceback (most recent call last):
  File "C:\Python33\foo.py", line 1, in <module>
    import lib.helper_functions
  File "C:\Python33\lib\helper_functions.py", line 1, in <module>
    import config
ImportError: No module named 'config' 
```

所以：当我运行 foo.py 时，解释器抱怨 helper_functions 的导入语句。然而，当我运行 helper_functions 的 main 时，没有出现这样的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T21:29:34.207

您需要`config`使用绝对导入来导入。要么使用：

```
from lib import config 
```

或使用：

```
from . import config 
```

Python 3 只支持绝对导入；该语句`import config`仅导入*顶级*模块`config`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:39:24.510

在 python 中，每个模块都有自己的命名空间。当您导入另一个模块时，您实际上只是在导入其名称。

模块 helper_functions 中存在名称“config”，因为您在那里导入了它。在 foo 中导入 helper_functions 只会将名称“helper_function”带入 foo 的命名空间，没有别的。

您实际上可以通过执行以下操作来使用当前导入引用 foo.py 中的“配置”名称：

```
lib.helper_functions.config 
```

但是在 python 中，显式总比隐式好。因此，在 foo.py 中导入配置将是最好的方法。

```
#file foo.py
import lib.helper_functions
import config 
```

# python - Python 2.6 (Windows EXE) 保持程序运行？

> ID：16004083
> 
> 赞同：0
> 
> 时间：2013-04-14T20:38:22.823
> 
> 标签：python, python-2.7, python-2.6

我试图让我的 python 程序运行，但它立即关闭。我试过了`raw_input()`，但我得到了这个错误：`EOFError: EOF when reading a line` 我放在`raw_input()`最后。我应该用什么让它运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T20:59:53.993

您要做的是使用 py2exe 编译一个 EXE，**指定它是一个控制台应用程序**。这就是您收到 EOF 错误的原因，没有可供`raw_input()`读取的标准输入。

像这样创建一个**setup.py**：

```
from distutils.core import setup
import py2exe

setup(console=['your_script.py']) 
```

然后你可以通过在控制台窗口中运行它来编译它：

```
python setup.py py2exe 
```

`raw_input()`这将在该目录中生成 your_script.exe，如果您的脚本末尾有一个，则该目录应作为控制台窗口保持打开状态。

确保 setup.py 和 your_script.py 位于同一目录中并且您已安装 py2exe。

作为参考，您可以[在线获取 py2exe](http://www.py2exe.org/index.cgi/FrontPage)。

顺便说一句，这还[允许您](https://stackoverflow.com/questions/9497370/making-exe-file-from-python-that-uses-command-line-arguments)在 py2exe 程序中使用命令行参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T20:48:16.760

我现在无法访问 Python，但是类似

```
from time import time, sleep

while True:
    #do other stuff
    sleep(5) 
```

应该很近。每次循环都会休眠 5 秒，请参阅[time.sleep()](http://docs.python.org/2/library/time.html#time.sleep)的文档。调整时间以满足您的需求。

# android - 根据android中按钮单击的持续时间触发不同的方法

> ID：16004085
> 
> 赞同：1
> 
> 时间：2013-04-14T20:39:17.090
> 
> 标签：android, button, onclick

我对android比较陌生。我正在考虑添加一个功能，其中根据按下按钮的持续时间发生两种不同类型的事件。这样的功能可能吗？假设用户按下按钮三秒钟，它应该打开一个设置菜单，否则它应该在你的手机中搜索音乐。我不关心该怎么做。我需要知道是否可以检测到持续时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T20:45:16.367

也许在你的情况下就足以实现 onClick 和 onLongClickListener

```
Button someButton = findViewById(R.id.button);

// fire this listener when user click on button
someButton.setOnClickListener(new OnClickListener({...}));

// fire this listener when user do long click on Button
someButton.setOnLongClickListener(new OnLongClickListener({...})); 
```

在这种情况下，您有两种选择，第一种是简单点击，第二种是标准长按。我认为这将是适合您问题的解决方案。但是，如果您需要更具体的解决方案，比如说不同的时间，那么您应该实现 OnTouchListener 并根据您的意图处理触摸事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T20:41:22.337

`View.setOnClickListener``View.setOnLongClickListener`这就是你所需要的。

如果要查找持续时间，则必须编写自己的`View`子类。我建议从`Button`监听器开始并使用它。

# java - Java - 关于某些代码的观察者模式。模拟同步文本更新

> ID：16004086
> 
> 赞同：2
> 
> 时间：2013-04-14T20:39:21.320
> 
> 标签：java, design-patterns, document, observer-pattern, jtextarea

我的代码的目的是模仿 Google Docs 的功能——当用户在一台机器上键入时，他们键入的字母会出现在另一台机器上。为简单起见，每台机器在 gui 中键入文本，主类处理所有更改。

![](https://i.stack.imgur.com/LYiCY.png) 每台机器都有一个“编辑器”，并链接到总共 1 个“文件内容主题”。“文件内容主题”应该进行用户所做的更改并将更新的代码发送给所有“编辑器”

![在此处输入图像描述](https://i.stack.imgur.com/atgx5.png)

这从一个简单的**驱动程序**开始，我在其中创建一个文件内容主题，创建两个编辑器并将它们连接在一起

```
public class Driver {
    public static void main(String[] args) {
    FileContentSubject filecontentsubject = new FileContentSubject();

    Editor e1 = new Editor(filecontentsubject);
    Editor e2 = new Editor(filecontentsubject);

    filecontentsubject.attach(e1);
    filecontentsubject.attach(e2);  
}
} 
```

**编辑器**看起来像这样（两个弹出窗口，而不是其余窗口）： ![在此处输入图像描述](https://i.stack.imgur.com/tq0PM.png)

制作编辑器的代码在这里：

```
import javax.swing.*;
import java.util.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;

import javax.swing.text.AbstractDocument;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;

public class Editor extends JFrame implements DocumentListener, Observer {

private FileContentSubject reference;
private Document doc;

    private JScrollPane textAreaScrollPane;
    private JTextArea textArea;

public Editor(FileContentSubject filecontentsubject) {
    super("Editor");
    initComponents();

    this.reference = filecontentsubject;
    textArea.getDocument().addDocumentListener(reference);

}

private void initComponents(){

    textArea = new JTextArea();
    textArea.setColumns(5);
    textArea.setLineWrap(true);
    textArea.setRows(50);
    textArea.setWrapStyleWord(true);

    textAreaScrollPane = new JScrollPane(textArea);

    setLocation(600,100);
    setSize(500,400);
    setVisible(true);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    getContentPane().setLayout(new BorderLayout());
    getContentPane().add(textArea, BorderLayout.CENTER);

}

@Override
public void changedUpdate(DocumentEvent arg0) {
}

@Override
public void insertUpdate(DocumentEvent arg0) {      
    reference.insertUpdate(arg0);
}

@Override
public void removeUpdate(DocumentEvent arg0) {
    reference.removeUpdate(arg0);
}

@Override
public void update() {
    //textArea.setText(reference.getJTextArea());
    //textArea.setText(reference.temp);

}   
} 
```

我的代码现在唯一的**问题是在****File Content Subject**中，当我尝试更改通过编辑器传递的代码时。我收到很多“不能在通知中变异”和一些“空指针异常”错误。生成此代码的代码如下，是我**注释掉的部分。**

```
import java.util.ArrayList;
import java.util.List;

import javax.swing.JTextArea;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;
import javax.swing.text.Position;

public class FileContentSubject implements Subject, DocumentListener {

private JTextArea textArea;
private Document doc;

private SubjectImpl reference;

@Override
public void attach(Observer o) {
    reference.attach(o);
}

@Override
public void detach(Observer o) {
    reference.detach(o);
}

@Override
public void notifyAllObservers() {
    reference.notifyAllObservers();
}

public FileContentSubject(){
    reference = new SubjectImpl();

    textArea = new JTextArea();
    textArea.setTabSize(5);
    textArea.setLineWrap(true);
    textArea.setWrapStyleWord(true);
    textArea.getDocument().addDocumentListener(this);
}

@Override
public void changedUpdate(DocumentEvent arg0) {}

@Override
public void insertUpdate(DocumentEvent arg0) {
    doc = (Document)arg0.getDocument();

//      try {
//          //this.textArea.setText(doc.getText(0, doc.getLength()-1));
//      } catch (BadLocationException e) {
//          // TODO Auto-generated catch block
//          e.printStackTrace();
//      }
    notifyAllObservers();
}

@Override
public void removeUpdate(DocumentEvent arg0) {
    doc = (Document)arg0.getDocument();

//      try {
//          this.textArea.setText(doc.getText(0, doc.getLength()-1));
//      } catch (BadLocationException e) {
//          // TODO Auto-generated catch block
//          e.printStackTrace();
//      }       

    notifyAllObservers();
}

public String getJTextArea(){
    return textArea.getText();
}
} 
```

所以我的问题是，如何将文本（通过编辑器传入 DocumentEvent）传递到文件内容主题中，让它更改文件内容主题，并通知所有编辑者？

* * *

我的其他课程使这一切发生（不重要，但为了清楚起见）：

**主题界面**

```
/**
 * Interface
 */
public interface Subject {

public void attach(Observer o);
public void detach(Observer o);

public void notifyAllObservers();

} 
```

**观察者界面**

```
public interface Observer {

    public void update();
} 
```

**SubjectImpl 类**

```
import java.util.ArrayList;
import java.util.List;

public class SubjectImpl implements Subject {

private List <Observer> observers;

public SubjectImpl(){
    observers = new ArrayList<Observer>();
}

@Override
public void attach(Observer o) {
    observers.add(o);
}

@Override
public void detach(Observer o) {
    observers.remove(o);
}

@Override
public void notifyAllObservers() {
    for(Observer o: observers){
        o.update();
    }
}
} 
```

* * *

* * *

* * *

# **回答**

需要防止正在编辑自身的编辑器被更新。这是通过文档属性完成的，并将所有内容都保存在字符串中而不是 JTextArea 中。非常感谢 acdcjunior 的帮助，代码答案位于所选答案的最后三个代码块上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:14:15.083

被`java.lang.IllegalStateException: Attempt to mutate in notification`抛出是因为在这些行中`FileContentSubject`：

```
@Override
public void insertUpdate(DocumentEvent arg0) {
    doc = (Document) arg0.getDocument();

    try {
        this.textArea.setText(doc.getText(0, doc.getLength()-1));
    } catch (BadLocationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    notifyAllObservers();
}

@Override
public void removeUpdate(DocumentEvent arg0) {
    doc = (Document) arg0.getDocument();

    try {
        this.textArea.setText(doc.getText(0, doc.getLength()-1));
    } catch (BadLocationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    notifyAllObservers();
} 
```

而`FileContentSubject`'s 的构造函数中的这一行：

```
textArea.getDocument().addDocumentListener(this); 
```

**表明您正在尝试`textArea`从`DocumentListener`方法内部更改 的值。**

[正如这里](https://stackoverflow.com/questions/6088069/java-cant-change-the-value-of-a-jtextfield-from-inside-of-documentlistener-met)所指出的，**你应该使用 a`DocumentFilter`来达到这个目的**。

这是一个使用 ' 的简单工作示例`DocumentFilter`（它将所有键入的字符替换为其大写版本）：

```
//UpcaseFilter.java
//A simple DocumentFilter that maps lowercase letters to uppercase.

import javax.swing.*;
import javax.swing.text.*;

public class UpcaseFilter extends DocumentFilter {

    public void insertString(DocumentFilter.FilterBypass fb, int offset,
            String text, AttributeSet attr) throws BadLocationException {
        fb.insertString(offset, text.toUpperCase(), attr);
    }

    // no need to override remove(): inherited version allows all removals
    public void replace(DocumentFilter.FilterBypass fb, int offset, int length,
            String text, AttributeSet attr) throws BadLocationException {
        fb.replace(offset, length, text.toUpperCase(), attr);
    }

    public static void main(String[] args) {
        DocumentFilter dfilter = new UpcaseFilter();

        JTextArea jta = new JTextArea();
        JTextField jtf = new JTextField();
        ((AbstractDocument) jta.getDocument()).setDocumentFilter(dfilter);
        ((AbstractDocument) jtf.getDocument()).setDocumentFilter(dfilter);

        JFrame frame = new JFrame("UpcaseFilter");
        frame.getContentPane().add(jta, java.awt.BorderLayout.CENTER);
        frame.getContentPane().add(jtf, java.awt.BorderLayout.SOUTH);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(200, 120);
        frame.setVisible(true);
    }
} 
```

（上面的例子取自[Java Swing, 2nd Edition](http://shop.oreilly.com/product/9780596004088.do) book,[第 22 章](http://examples.oreilly.com/jswing2/code/ch22/UpcaseFilter.java)。）

## 这就是引发异常的原因，但您必须做更多的事情来纠正您的代码：

简而言之，问题在于您的代码中发生了这种情况：

*   当一个`Editor`实例的（我们称之为`edt`）`textArea`改变时......
*   ... `FileContentSubject`（因为它是`DocumentListener`）通知事件，然后通知其所有注册的观察者（`edt`包括！）调用他们的`update()`方法...
*   ...改变它的`update()`方法和...瞧！您正在尝试更改活动的发起人（在活动结束之前）！`edt``textArea``textArea`

然后，您所要做的就是找到一种不通知活动发起人的方法。下面的代码使用`Document.putProperty()`and `Document.getProperty()`来实现：它分离事件的源编辑器 ( `reference.detach(e);`)，将更改通知每个人，然后重新附加它 ( `reference.attach(e);`)。

（另外，我将`FileContentSubject`'s替换`JTextArea`为 a`String`就`String`足够了。）

因此，这是更改后的`FileContentSubject`代码：

```
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;

public class FileContentSubject implements Subject, DocumentListener {

    // private JTextArea textArea; // removed as a String field will suffice
    // private Document doc; // should not be a field!

    private String state;

    public String getState() {
        return this.state;
    }

    private SubjectImpl reference;

    @Override
    public void attach(Observer o) {
        reference.attach(o);
    }

    @Override
    public void detach(Observer o) {
        reference.detach(o);
    }

    @Override
    public void notifyAllObservers() {
        reference.notifyAllObservers();
    }

    public FileContentSubject() {
        reference = new SubjectImpl();

//      textArea = new JTextArea();
//      textArea.setTabSize(5);
//      textArea.setLineWrap(true);
//      textArea.setWrapStyleWord(true);
//      textArea.getDocument().addDocumentListener(this);
    }

    @Override
    public void changedUpdate(DocumentEvent arg0) {
    }

    @Override
    public void insertUpdate(DocumentEvent arg0) {
        Document doc = (Document) arg0.getDocument();
        try {
            // this.textArea.setText(doc.getText(0, doc.getLength()-1));
            this.state = doc.getText(0, doc.getLength());
        } catch (BadLocationException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        Editor e = (Editor) doc.getProperty("ownerEditor");
        reference.detach(e); // so it will not be notified of its own change
        notifyAllObservers(); // tell everybody else to catch up with the changes
        reference.attach(e); // reattaches the editor
    }

    @Override
    public void removeUpdate(DocumentEvent arg0) {
        Document doc = (Document) arg0.getDocument();
        try {
            // this.textArea.setText(doc.getText(0, doc.getLength()-1));
            this.state = doc.getText(0, doc.getLength());
        } catch (BadLocationException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        Editor e = (Editor) doc.getProperty("ownerEditor");
        reference.detach(e); // so it will not be notified of its own change
        notifyAllObservers(); // tell everybody else to catch up with the changes
        reference.attach(e); // reattaches the editor
    }

    // public String getJTextArea() {
    //     return textArea.getText();
    // }
} 
```

改变`Editor`的构造函数：

```
public Editor(FileContentSubject filecontentsubject) {
    super("Editor");
    initComponents();

    this.reference = filecontentsubject;
    textArea.getDocument().addDocumentListener(reference);
    textArea.getDocument().putProperty("ownerEditor", this); // <---- ADDED LINE
} 
```

和`update()`：

```
@Override
public void update() {
    //textArea.setText(reference.getJTextArea());
    //textArea.setText(reference.temp);
    textArea.setText(reference.getState()); // ADDED
} 
```

而已！

# javascript - 如何将 JavaScript 表单转换为 XML（或其他？）

> ID：16004089
> 
> 赞同：0
> 
> 时间：2013-04-14T20:39:36.717
> 
> 标签：javascript, xml, forms

我正在开发一个用 JavaScript 制作分数表格的程序。表单本身功能齐全（它可以很好地计算分数），但现在我正在寻找一种方法将这些结果保存到某种文件中，该文件也可以由同一个程序加载，两者都在同一个系统上其他系统和/或设备。

我发现 XML 可以以某种方式用于此，但我不知道从哪里开始。表单中的字段没有什么特别之处：文本表单的组合（其中一些具有动态计算的结果，即三个字段的数字为 8、8 和 7，第四个字段的数字为 23）和一些下拉菜单. 这可能会改变在这种情况下使用的代码，也可能不会。

所以我的问题如下：如何将 JavaScript 表单的内容保存并加载到一个易于移动的文件中，我应该为此使用 XML 还是其他什么？欢迎使用代码中的答案、简短的步骤列表或完整教程的链接。

谢谢，

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:45:53.337

您不能轻松地将文件存储在本地用户的机器上。根据您存储的信息的生命周期，您可以使用 LocalStorage、Cookie 或服务器端数据库系统。

您可以让用户选择要上传/下载的文件，如果您愿意，该文件将用于存储作为最后的手段。

但是，我建议您使用[JSON](http://codular.com/json)存储数据，因为它使用起来超级简单，尤其是使用 JavaScript。

最好的办法是在服务器（PHP 或 Node 或其他）上运行一些东西，然后为您存储数据。

# vhdl - 使用 2 位比较器的 VHDL 4 位比较器

> ID：16004094
> 
> 赞同：1
> 
> 时间：2013-04-14T20:40:03.030
> 
> 标签：vhdl

我在使用 2-Bit`greater than Comparator`和 2-bit创建 4-Bit Comparator 时遇到了麻烦`equality Comparator`。

**大于比较器**

```
entity bit2com is                
    Port ( a,b: in  STD_LOGIC_vector(1 downto 0);
           y : out  STD_LOGIC);
end bit2com;

architecture Behavioral of bit2com is

signal p0,p1,p2:std_logic;

begin

p0  <= a(1) and not b(1);
p1  <= a(0) and a(1) and not b(0);
p2<=a(0) and not b(0) and not b(1);
y <= p0 or p1 or p2;

end Behavioral; 
```

* * *

**相等比较器**

```
entity comaeqb is

    Port ( a,b: in  STD_LOGIC_vector(1 downto 0);
           y : out  STD_LOGIC);
end comaeqb;

architecture Behavioral of comaeqb is

signal p0,p1,p2,p3:std_logic;
begin

p0  <= a(0) and a(1) and b(0) and b(1);
p1  <= a(0) and not a(1) and b(0) and not b(1);

p2<=not a(0) and not a(1) and not b(0) and not b(1);
p3<=not a(0) and a(1) and not b(0) and b(1);
y <= p0 or p1 or p2 or p3; 
```

我如何使用它来比比较器大 4 位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:30:39.883

如我所见，您尝试从 2 位比较器（`>`和`=`）创建 4 位比较器。但我认为您的问题有两个答案：

1.  如果您只想创建没有任何比较器的 4 位比较器（独立），请声明`A and B`为`signed`或`unsigned`进行比较（如果您使用，则可以转换为该类型`std_logic_vector`）。有两个库可供使用：`arith`和`numeric_std`（只使用其中一个，两者都被违反）。
2.  如果您必须使用 2 位比较器。使用这种方式：

提议`A = [A3 A2 A1 A0]`和`B = [B3 B2 B1 B0]`。运行两步：

**第 1 步**将两个 MSB 与您的比较器进行比较：

```
if [A3 A2] > [B3 B2] then
  A_greater_than_B <= '1';
elsif [A3 A2] < [B3 B2] then
  A_greater_than_B <= '0';
else -- [A3 A2] = [B3 B2]
-- next step >>>
end if; 
```

**步骤 2使用与****步骤 1**类似的方法将两个 LSB 与您的比较器进行比较。这个分支发生在`[A3 A2] =[ B3 B2]`. **步骤 2**的结果是 4 位比较器的结果。例如，如果`[A1 A0] = [B1 B0]`那么`A = B`.

# java - 如何将图像转换为位图形式的 java 应用程序到 android 设备

> ID：16004096
> 
> 赞同：3
> 
> 时间：2013-04-14T20:40:22.777
> 
> 标签：java, android, image, bitmap

我编写了一个 java 应用程序，它从网络摄像头创建一些图像，它们的格式是`java.awt.Image`. 我想在我的 Android 设备上显示这些图像，但是 ADK 不包括`java.awt`.

我想在Java应用程序中转换它并通过将图像转换为位图然后通过套接字连接将其传输到Android来在Android中显示图像。

我用谷歌搜索了一个解决方案和一些使用的例子，`BitmapFactory.decodeResource`但在这种情况下似乎没有用。

///// 2012/4/15 添加///////////

我用这个，但不工作，有什么问题吗

/////输出/////

`ByteArrayOutputStream baos = new ByteArrayOutputStream();
try { ImageIO.write(image, "png", baos); } catch (IOException e) {e.printStackTrace();}
byte[] data = baos.toByteArray();
int len =data.length; oos.writeInt(len); oos.flush(); oos.write(data); oos.flush();`

/////输入/////

`int size =dis.readInt(); byte []data=new byte[size]; dis.read(data); image = BitmapFactory.decodeByteArray(data, 0, data.length);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:45:45.617

将图像转换为 JPEG 或 PNG 字节数组并发送。InputStream 可以在 Android 上解码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:46:09.033

你可以看看这个：[Savin bitmap files in Java](http://www.javaworld.com/javatips/jw-javatip60.html?page=2)

在代码中，您可以将文件替换为缓冲区，将其发送并加载到 Android 上，就像从文件中一样。

# php - ZF2 + Zend\Db\Sql\Insert + 重复键更新

> ID：16004097
> 
> 赞同：3
> 
> 时间：2013-04-14T20:40:33.020
> 
> 标签：php, zend-framework2, zend-db, sql-insert

我想使用 Zend\Db\Sql\Insert 和**ON DUPLICATE KEY UPDATE选项插入一些数据**

实际上我使用这种查询：

```
INSERT INTO `user_data` (`user_id`, `category`, `value`) 
VALUES (12, 'cat2', 'my category value')
 ON DUPLICATE KEY UPDATE `user_id`=VALUES(`user_id`), `category`=VALUES(`category`), `value`=VALUES(`value`); 
```

和

```
$this->dbAdapter->query($sql, Adapter::QUERY_MODE_EXECUTE); 
```

但是如何使用**Zend\Db\Sql\Insert**生成上述查询？

感谢您的任何建议。干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-10T23:53:22.993

也许这个解决方案可以帮助你。

[https://gist.github.com/newage/227d7c3fb8202e473a76](https://gist.github.com/newage/227d7c3fb8202e473a76)

```
/**
* Use INSERT ... ON DUPLICATE KEY UPDATE Syntax
* @since mysql 5.1
* @param array $insertData For insert array('field_name' => 'field_value')
* @param array $updateData For update array('field_name' => 'field_value_new')
* @return bool
*/
public function insertOrUpdate(array $insertData, array $updateData)
{
$sqlStringTemplate = 'INSERT INTO %s (%s) VALUES (%s) ON DUPLICATE KEY UPDATE %s';
$adapter = $this->tableGateway->adapter; /* Get adapter from tableGateway */
$driver = $adapter->getDriver();
$platform = $adapter->getPlatform();

$tableName = $platform->quoteIdentifier('table_name');
$parameterContainer = new ParameterContainer();
$statementContainer = $adapter->createStatement();
$statementContainer->setParameterContainer($parameterContainer);

/* Preparation insert data */
$insertQuotedValue = [];
$insertQuotedColumns = [];
foreach ($insertData as $column => $value) {
$insertQuotedValue[] = $driver->formatParameterName($column);
$insertQuotedColumns[] = $platform->quoteIdentifier($column);
$parameterContainer->offsetSet($column, $value);
}

/* Preparation update data */
$updateQuotedValue = [];
foreach ($updateData as $column => $value) {
$updateQuotedValue[] = $platform->quoteIdentifier($column) . '=' . $driver->formatParameterName('update_' . $column);
$parameterContainer->offsetSet('update_'.$column, $value);
}

/* Preparation sql query */
$query = sprintf(
$sqlStringTemplate,
$tableName,
implode(',', $insertQuotedColumns),
implode(',', array_values($insertQuotedValue)),
implode(',', $updateQuotedValue)
);

$statementContainer->setSql($query);
return $statementContainer->execute();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T08:55:20.343

**我做了这个代码： Sql\Insert**的扩展类

 **它正在工作，但我认为我需要点亮它。因为我只是从 Zend\Db\Sql\Insert 库中更新了最新的“prepareStatement”和“getSqlString”行。

你可以在这里找到我的插件[https://github.com/remithomas/rt-extends](https://github.com/remithomas/rt-extends)

你怎么看 ？

```
<?php

namespace RtExtends\Sql;

use Zend\Db\Adapter\AdapterInterface;
use Zend\Db\Adapter\StatementContainerInterface;
use Zend\Db\Adapter\ParameterContainer;
use Zend\Db\Adapter\Platform\PlatformInterface;
use Zend\Db\Adapter\Platform\Sql92;

use Zend\Db\Sql\Insert as ZendInsert;

class Insert extends ZendInsert{

    /**
     * Constants 
     */
    const SPECIFICATION_INSERTDUPLICATEKEY = 'insert';
    const VALUES_DUPLICATEKEY = "duplicatekey";

    /**
     * @var array Specification array
     */
    protected $duplicatespecifications = array(
        self::SPECIFICATION_INSERTDUPLICATEKEY => 'INSERT INTO %1$s (%2$s) VALUES (%3$s) ON DUPLICATE KEY UPDATE %4$s'
    );

    /**
     * Constructor
     *
     * @param  null|string|TableIdentifier $table
     */
    public function __construct($table = null)
    {
        parent::__construct($table);
    }

    /**
     * Prepare statement
     *
     * @param  AdapterInterface $adapter
     * @param  StatementContainerInterface $statementContainer
     * @return void
     */
    public function prepareStatement(AdapterInterface $adapter, StatementContainerInterface $statementContainer)
    {
        $driver   = $adapter->getDriver();
        $platform = $adapter->getPlatform();
        $parameterContainer = $statementContainer->getParameterContainer();

        if (!$parameterContainer instanceof ParameterContainer) {
            $parameterContainer = new ParameterContainer();
            $statementContainer->setParameterContainer($parameterContainer);
        }

        $table = $this->table;
        $schema = null;

        // create quoted table name to use in insert processing
        if ($table instanceof TableIdentifier) {
            list($table, $schema) = $table->getTableAndSchema();
        }

        $table = $platform->quoteIdentifier($table);

        if ($schema) {
            $table = $platform->quoteIdentifier($schema) . $platform->getIdentifierSeparator() . $table;
        }

        $columns = array();
        $values  = array();

        foreach ($this->columns as $cIndex => $column) {
            $columns[$cIndex] = $platform->quoteIdentifier($column);
            if (isset($this->values[$cIndex]) && $this->values[$cIndex] instanceof Expression) {
                $exprData = $this->processExpression($this->values[$cIndex], $platform, $driver);
                $values[$cIndex] = $exprData->getSql();
                $parameterContainer->merge($exprData->getParameterContainer());
            } else {
                $values[$cIndex] = $driver->formatParameterName($column);
                if (isset($this->values[$cIndex])) {
                    $parameterContainer->offsetSet($column, $this->values[$cIndex]);
                } else {
                    $parameterContainer->offsetSet($column, null);
                }
            }
        }

        $sql = sprintf(
            $this->duplicatespecifications[self::SPECIFICATION_INSERTDUPLICATEKEY],
            $table,
            implode(', ', $columns),
            implode(', ', $values),
            implode(",", array_map(array($this, "mapValue"), $columns))
        );

        $statementContainer->setSql($sql);
    }

    /**
     * Get SQL string for this statement
     *
     * @param  null|PlatformInterface $adapterPlatform Defaults to Sql92 if none provided
     * @return string
     */
    public function getSqlString(PlatformInterface $adapterPlatform = null)
    {
        $adapterPlatform = ($adapterPlatform) ?: new Sql92;
        $table = $this->table;
        $schema = null;

        // create quoted table name to use in insert processing
        if ($table instanceof TableIdentifier) {
            list($table, $schema) = $table->getTableAndSchema();
        }

        $table = $adapterPlatform->quoteIdentifier($table);

        if ($schema) {
            $table = $adapterPlatform->quoteIdentifier($schema) . $adapterPlatform->getIdentifierSeparator() . $table;
        }

        $columns = array_map(array($adapterPlatform, 'quoteIdentifier'), $this->columns);
        $columns = implode(', ', $columns);

        $values = array();
        foreach ($this->values as $value) {
            if ($value instanceof Expression) {
                $exprData = $this->processExpression($value, $adapterPlatform);
                $values[] = $exprData->getSql();
            } elseif ($value === null) {
                $values[] = 'NULL';
            } else {
                $values[] = $adapterPlatform->quoteValue($value);
            }
        }

        $values = implode(', ', $values);
        $valuesDuplicate = implode(",", array_map(array($this, "mapValue"), $columns));

        return sprintf($this->duplicatespecifications[self::SPECIFICATION_INSERTDUPLICATEKEY], $table, $columns, $values, $valuesDuplicate);
    }

    private function mapValue($columns){
        return $columns."=VALUES(".$columns.")";
    }
}

?> 
```**

# css - 斑马条纹每两个 TR 连续使用 CSS。

> ID：16004099
> 
> 赞同：10
> 
> 时间：2013-04-14T20:40:57.413
> 
> 标签：css, css-selectors

我想连续每两行灰色/条纹。很难解释。这是一张图片::
|-^-^-^-^-^-|
|-^-^-^-^-^-|
|--------------|
|--------------|
|-^-^-^-^-^-|
|-^-^-^-^-^-|
|--------------|
|--------------|
|-^-^-^-^-^-|
|-^-^-^-^-^-|
|--------------|
|--------------|

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-14T20:46:02.577

像这样？[http://jsfiddle.net/GQNUV/1/](http://jsfiddle.net/GQNUV/1/)

```
table tr:nth-child(4n-1), table tr:nth-child(4n)  {
    background: #ccc;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T20:49:35.187

将其更改为您的偏好，它应该可以工作

```
tr:nth-child(4n+1) { color: green; }
tr:nth-child(4n+2) { color: green; }
tr:nth-child(4n+3) { color: red; }
tr:nth-child(4n+4) { color: red; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-05T15:44:05.640

如果标题有一行，请添加 thead 和 tbody 并将 css 更改为：

```
table tbody tr:nth-child(4n-1), table tbody tr:nth-child(4n)  {
    background: #ccc;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T20:50:08.007

为了使其正常工作，`n`in`nth-child()`必须相同，但您更改添加到`n`. 对于这种情况，数字只能相隔一个数字。所以你需要`4n+1`and `4n`, or `4n+2`and`4n+3`等。

[小提琴](http://jsfiddle.net/GQNUV/2/)

# java - 使取消操作回到程序的开始？

> ID：16004110
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:42:02.277
> 
> 标签：java, swing, joptionpane

我有这个 gui，提示用户在个人或公司之间进行选择，但我希望取消按钮返回程序的开头或主框架。

```
int chooseVehicleType = JOptionPane.showOptionDialog(this,
                "What kind of vehicle is it?", "Choose and option",
                JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, null,
                vehicle, "");

if (chooseVehicleType == 1) {
        int result2 = JOptionPane.showConfirmDialog(null, truck,
                "Enter the truck details", JOptionPane.OK_CANCEL_OPTION);
        // Printing out the input of the user in the center panel
        if (result2 == JOptionPane.OK_OPTION) {
                             //Do stuff here, proceed to he next prompt window
            }
        if (result2 == JOptionPane.CANCEL_OPTION) {
            updateCenterPanel("Operation cancelled!");
                           /* Updating the center panel, 
                            * but also close the operation   
                            * and go back to the main screen 
                            */
        } 
```

所以，我走到了这一步。但是现在用户被提示到下一个选择屏幕，而不是回到主框架。

有任何想法吗？我已经用完了它们...在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:40:03.773

由于尚未发布[SSCCE](http://sscce.org/)，因此需要考虑许多情况。

根据您的代码中的注释，您有一个可能已打开 JOptionPane 的中心面板，并且主屏幕可能在后台。如果按下取消按钮，您想要关闭中心面板并获得主屏幕框架的焦点。您可以将以下代码添加到取消选项：

```
 if (result2 == JOptionPane.CANCEL_OPTION) {
        updateCenterPanel("Operation cancelled!");
                      centerPanel.dispose(); // closes the window and releases it's occupied resources
                      mainScreen.setVisible(true); //gain focus on the main window
    } 
```

如果您只想在不关闭任何其他窗口的情况下专注于主屏幕框架，只需将其添加到 JOptionPane 的取消选项中：

```
 mainScreen.setVisible(true); 
```

我希望这会有所帮助。干杯!

# clojure - 我们什么时候需要 Clojure 中的引用列表？

> ID：16004112
> 
> 赞同：2
> 
> 时间：2013-04-14T20:42:10.757
> 
> 标签：clojure

我刚开始使用 Clojure，才一个星期。我尝试用 Clojure 的方式解决一些标准问题。

我读到了引用列表，这些列表没有得到评估，被认为是像向量这样的标准数据集合。

在哪些情况下，引用形式的列表将代替向量有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:04:41.390

Macros and literal list instantiation. In macros you usually need syntax quote instead of normal quote

*   [http://clojure.org/macros](http://clojure.org/macros)
*   [http://en.wikibooks.org/wiki/Learning_Clojure/Macros](http://en.wikibooks.org/wiki/Learning_Clojure/Macros)
*   [http://techbehindtech.com/2010/09/28/clojure-macros-simplified/](http://techbehindtech.com/2010/09/28/clojure-macros-simplified/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:26:19.880

Clojure 列表可以用作不可变的、持久的单链表。对于典型的列表操作，尤其是那些涉及头部和尾部操作的操作，列表将比向量执行得更好。此外，引用形式的列表不会立即评估，因此您可以将函数调用存储在其中并控制何时执行调用；在向量中做同样的事情，一切都会立即按顺序运行。

向量更适合随机访问，如果您需要将数据附加到集合的末尾，它们的性能会更好。它们也是“关联的”，这意味着您可以将它们视为映射，其中键是值的索引，并且可以将它们用于瞬态操作（这是另一个主题）。

# php - PHP内存不足读取blob

> ID：16004118
> 
> 赞同：0
> 
> 时间：2013-04-14T20:42:48.387
> 
> 标签：php, blob, firebird

我有一个 php 函数来从 blob 字段中获取所有图像。

如下：

```
$db_corp = new PDO ("firebird:dbname=DATA.FDB;host=localhost", "sysdba", "masterkey");

$query_corp1= "Select CODPROD, ,FOTO From PRODUCT";

$result_corp1 = $db_corp->prepare($query_corp1);
$result_corp1->execute();
$result_corp1->bindColumn(1, $corp1_CODPROD);
$result_corp1->bindColumn(9, $corp1_FOTO, PDO::PARAM_LOB);

while($result_corp1->fetch()){
    if($corp1_FOTO){
        file_put_contents($corp1_CODPROD.".png",$corp1_FOTO);
    }
} 
```

该脚本运行良好，几乎占据了数据库中一半的照片，但在此过程中出现以下错误。

`Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 480055 bytes)`

我已经尝试过 gc_enable(); 和 gc_collect_cycles；我的数据库有 2100 个产品，但一半有图片，我需要将其提取到文件中。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T20:47:17.370

增加 php.ini 中的内存使用量可能会有所帮助，但这只是一个肮脏的修复，而不是真正的解决方案。尝试每次检索 100 行，而不是清理一些内存并重新开始......在“伪代码”中：

```
$from = 1;
$to = 100;

while ($to < totalLines()) {
   getLines($from,$to);
   $from += 100;
   $to += 100;
   clearMemory();
} 
```

# java - Servlet 无法第二次生成输出

> ID：16004122
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:43:17.617
> 
> 标签：java, servlets

请查看我的代码：

```
 package controller;

        import java.io.File;
        import java.io.Io Exception;
        import java.io.PrintWriter;
        import java.util.ArrayList;
        import java.util.Iterator;
        import java.util.logging.Level;
        import java.util.logging.Logger;
        import javax.servlet.RequestDispatcher;
        import javax.servlet.ServletException;
        import javax.servlet.http.HttpServlet;
        import javax.servlet.http.HttpServletRequest;
        import javax.servlet.http.HttpServletResponse;
        import model.dbLayer;
        import org.apache.commons.fileupload.FileItem;
        import org.apache.commons.fileupload.FileItemFactory;
        import org.apache.commons.fileupload.FileUploadException;
        import org.apache.commons.fileupload.disk.DiskFileItemFactory;
        import org.apache.commons.fileupload.servlet.ServletFileUpload;

        /**
         *
         * @author sarir

    /*i am having jsp page with multipart enctype and saving image path in db

        i am able to insert a first record successfully.Everything goes wellBut when a click a hyperlink again to insert second record  and i`enter code here`nserting all the fields into the forma and submitting as posting a request to above servlet it does not produce output and neither any exceptions...any help would be appreciated..plz i am doing final year project...help me

    */
         */
        public class multipartServlet extends HttpServlet {
        //reading input from jsp page 
           String path="";
           Long CRN;
           String username="";
            private ArrayList<String>list=new ArrayList<String>();

//to process enctype dtat
            protected void processRequest(HttpServletRequest request, HttpServletResponse response)
                    throws ServletException, IOException, FileUploadException, Exception {
                response.setContentType("text/html;charset=UTF-8");
                PrintWriter out = response.getWriter();

                username=request.getSession(true).getAttribute("uname").toString();
                try {            
                          CRN=generatorCRN.getCRN();
                          list.add(CRN.toString());
                          list.add(username); 

             FileItemFactory factory = new DiskFileItemFactory();
             ServletFileUpload upload = new ServletFileUpload(factory);
             Iterator<FileItem> iterator = upload.parseRequest(request).iterator();
             File uploadedFile;
             String dirPath="C:\\Users\\Bhatjaved\\Documents\\NetBeansProjects\\6thsem\\build\\web\\view\\Photo";

             while (iterator.hasNext()) {

                            FileItem item = iterator.next();
                            if (!item.isFormField()) {

                                String fileNameWithExt = item.getName();

                                File filePath = new File(dirPath);

                                if (!filePath.exists()) {
                                    filePath.mkdirs();
                                }

                            uploadedFile = new File(dirPath + "/"+CRN.toString().concat(".jpg"));

                               path=dirPath +filePath.separator+CRN.toString().concat(".jpg");
                                item.write(uploadedFile);  

                            }
                            else {
                    String otherFieldName = item.getFieldName();
                    String otherFieldValue = item.getString();
                            if(otherFieldValue.equals("Select"))
                                ;
                            else                        
                        list.add(otherFieldValue);
                            }
                       }

                    dbLayer dl=new dbLayer();
                    int res= dl.registerperson("missing_persons", list,path);
                    out.println(res);
                    if(res>0)
                    {
              //request.getRequestDispatcher("/view/missingsucess.jsp").forward(request, response); 
                       response.sendRedirect("/online_complaint/view/missingsucess.jsp?crn="+CRN);
                    }

                }catch(Exception ex)

                {

                 out.print(ex.getCause().toString());

                }

                finally {    

                    out.close();
                }
            }

            // <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
            /**
             * Handles the HTTP
             * <code>GET</code> method.
             *
             * @param request servlet request
             * @param response servlet response
             * @throws ServletException if a servlet-specific error occurs
             * @throws IOException if an I/O error occurs
             */
            @Override
            protected void doGet(HttpServletRequest request, HttpServletResponse response)
                    throws ServletException, IOException {
                try {
                    processRequest(request, response);
                } catch (FileUploadException ex) {
                    Logger.getLogger(multipartServlet.class.getName()).log(Level.SEVERE, null, ex);
                } catch (Exception ex) {
                    Logger.getLogger(multipartServlet.class.getName()).log(Level.SEVERE, null, ex);
                }
            }

            /**
             * Handles the HTTP
             * <code>POST</code> method.
             *
             * @param request servlet request
             * @param response servlet response
             * @throws ServletException if a servlet-specific error occurs
             * @throws IOException if an I/O error occurs
             */
            @Override
            protected void doPost(HttpServletRequest request, HttpServletResponse response)
                    throws ServletException, IOException {
                try {
                    processRequest(request, response);
                } catch (FileUploadException ex) {
                    Logger.getLogger(multipartServlet.class.getName()).log(Level.SEVERE, null, ex);
                } catch (Exception ex) {
                    Logger.getLogger(multipartServlet.class.getName()).log(Level.SEVERE, null, ex);
                }
            }

            </editor-fold>
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:51:54.103

从您的帖子中不清楚您第二次*无法生成*`list`什么，但一个明显的问题是.

您每次都无法清空此列表，并且根据您将其传递给 ( `registerperson`) 的方法的名称来判断，您很可能给它一个过度填充的对象。

也许这对您的方法来说应该是本地的，因为它不需要成为实例变量。

# google-app-engine - “您无权访问此页面。” 在计费设置和计费配置文件上？

> ID：16004125
> 
> 赞同：3
> 
> 时间：2013-04-14T20:43:25.797
> 
> 标签：google-app-engine

当我尝试访问结算设置和配置文件时，我一直在“您无权访问此页面。”页面结束。

在帐户上尝试了两个不同的应用程序，它们都启用了计费。

还有其他人有同样的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T07:48:07.400

使用**隐身模式解决了这个问题**。这可能与 Google 的多个帐户登录有关。

# php - 无法获取动态生成的文本框数组的发布值

> ID：16004126
> 
> 赞同：0
> 
> 时间：2013-04-14T20:43:50.567
> 
> 标签：php, javascript, jquery, html, mysql

我有一个表单，它有 2 个下拉列表“Diplomas”和“Fields”、一个提交按钮和一个“添加”按钮，只要文本框的数量低于5 这是`dipSecSelection.php`包含在表单中的文件的代码：

```
<!----------- The dipSecSelection File ------------->
<div id="dipSecSelection">
    <table>
        <tr>
            <td><label for="diplomes">Diplome:</label></td>
            <td>
                <select name="Diplomes" id="Diplomes">
                    <option value="na">--Diplome--</option>
                    <option value="Technician">Technician</option>
                    <option value="Master">Master</option>
                    <option value="PhD">PhD</option>    
                </select>    
            </td>
            <td id="separator">|</td><!-- Separator -->
            <td><label for="secteurs">Secteur:</label></td>
            <td>
                <select name="Secteurs" id="Secteurs">
                    <option value="na">--Secteur--</option>
                    <option value="Software Dev">Software Dev</option>
                    <option value="Engineering">Engineering</option>
                    <option value="Physics">Physics</option>
                </select>
            </td>
            <td>
                <a href="#" Onclick="addDipSec()" value="Add" class="button">Add</a>
            </td>
            </tr>
    </table>
    <table>
        <tr>
            <td><div id='DipTextBoxesGroup'></div></td>
            <td><div id='SecTextBoxesGroup'></div></td>
        </tr>
    </table>
</div>

<script type="text/javascript">
    //Diplomas textBoxes!!!
    var counterdip = 1;
    var countersec = 1;
    function addDipSec(){
        if(counter>5){
            alert("Only 5 Diplomas allow");
            return false;
        }           
        var newTextBoxDiv = $(document.createElement('div')).attr("id", 'TextBoxDiv' + counterdip);
        newTextBoxDiv.after().html('<label>Diplome #'+ counterdip + ' : </label>' +
            '<input type="text" name="dipBox[]" id="textboxdip' + counterdip + '" value="" >');
        newTextBoxDiv.appendTo("#DipTextBoxesGroup");
        $('#textboxdip'+counterdip).val($('#Diplomes option:selected').html());
        counter++;

        //Secteurs textBoxes
        if(countersec>5){
            alert("Only 5  Setors are allowed");
            return false;
        }  
        var newTextBoxDiv = $(document.createElement('div')).attr("id", 'TextBoxDiv' + countersec);
        newTextBoxDiv.after().html('<label>Secteur #'+ countersec + ' : </label>' +
              '<input type="text" name="secBox[]" id="textboxsec' + countersec + '" value="" size="35">');
        newTextBoxDiv.appendTo("#SecTextBoxesGroup");
        $('#textboxsec'+countersec).val($('#Secteurs option:selected').html());
        countersec++;
        alert(secBox[0].val);
}
</script> 
```

这是php代码：

```
<form action="<?php echo $_SERVER['REQUEST_URI']; ?>" method="POST" enctype="multipart/form-data">
    <?php include'includes/dipSecSelection.php'?>
    <?php
        if(isset($_POST['dipBox']) && isset($_POST['secBox'])){
            if(!empty($_POST['dipBox'])&&!empty($_POST['secBox'])){
                $dip= $_POST['dipBox'];
                $sec= $_POST['secBox'];
                $N = count($dip);
                for($i=0; $i < $N; $i++){
                    $add_AnnDipSec = "INSERT INTO annDipSec VALUES('$dip[$i]','$sec[$i]')";
                    if(mysqli_query($connection, $add_AnnDipSec)){
                        echo'Successfully Added to AnnDipSec';
                    }else{echo'Error while trying to insert into AnnDipSec';}
                }
            }else{echo"Dip and Sec were Empty";}
        }                            
    ?>
    <input type="submit" name="submit" value="Submit" class='button'>
</form> 
```

问题是永远不会被设置`dipBox[]`并且`secBox[]`总是什么都不返回，所以它们永远不会被插入到数据库表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:49:38.390

`option`在您的选择器中丢失`$('#Diplomes :selected')`

试试这个方法——

```
$('#textboxdip'+counterdip).val($('#Diplomes option:selected').html()); 
```

这也是

```
$('#textboxsec'+countersec).val($('#Secteurs option:selected').html()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:26:01.710

我刚刚解决了问题！当我把它拉出来的时候，我把表单标签放在第一个表里面，表单工作得很好

# python - Python，Google App Engine 错误：断言类型（数据）是字符串类型，“写（）参数必须是字符串”

> ID：16004135
> 
> 赞同：3
> 
> 时间：2013-04-14T20:44:56.800
> 
> 标签：python, google-app-engine

我现在正在通过 Charles Severance 的《使用 Google App Engine》一书学习 Google App Engine。

我在第 6 章，到目前为止，我已经在模板文件夹中制作了`app.yaml`, `index.py`，`index.html`在静态文件夹中制作了 CSS 文件。

我的`index.py`样子是这样的：

```
import os
import wsgiref.appengine.ext import webapp
from google.appengine.ext import webapp
from google.appengine.ext.webapp import template

class MainHandler(webapp.RequestHandler):
      def get(self):
          path=self.request.path
          temp=os.path.join(os.path.dirname(__file__, 'templates' + path)
          if not os.path.isfile(temp):
             temp=os.path.join(os.path.dirname(__file__, 'templates/index.html')

          self.response.out.write(template.render(temp,{}))

def main():
    application = webapp.WSGIApplication([('/.*', MainHandler)], debug=True)
    wsgiref.handlers.CGIHandler().run(application)

if __name == '__main__':
   main() 
```

为什么我会收到此错误？

```
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 86, in run
    self.finish_response()
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 127, in finish_response
    self.write(data)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 202, in write
    **assert type(data) is StringType,"write() argument must be string"**

AssertionError: write() argument must be string 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:36:52.683

由于一些旧的 Google App Engine 示例代码，我最近也遇到了这个确切的错误。我的问题出在`doRender()`函数中，其中`outstr`对象是`django.utils.safestring.SafeUnicode`对象，因此该`write()`函数在抱怨。所以我通过它`unicode()`最终得到了一个可以接受的 unicode 对象`write()`。

```
def doRender(handler, tname="index.html", values={}):
    temp = os.path.join(os.path.dirname(__file__),
                        'templates/' + tname)
    if not os.path.isfile(temp):
        return False

    # Make a copy of the dictionary and add the path
    newval = dict(values)
    newval['path'] = handler.request.path

    outstr = template.render(temp, newval)
    handler.response.out.write(unicode(outstr))
    return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:39:01.540

第 2 行：更改`import wsgiref.appengine.ext import webapp`为`import wsgiref`.

第 9 行：添加一个`)`之后`__file__`

第 11 行：添加一个`)`之后`__file__`

第 19 行：更改`__name`为`__name__`

这些都是基本的语法错误。你刚才抄错书了。始终通过 App Engine SDK 提供的开发服务器 dev_appserver.py 运行新代码。

# android - SupportMapFragment - 无法从 Fragment 转换为 MapFragment

> ID：16004137
> 
> 赞同：18
> 
> 时间：2013-04-14T20:45:10.943
> 
> 标签：android, google-maps-android-api-2

试图在我正在构建的活动中组合一个小 MapFragment，但在让它全部工作时遇到了一些麻烦。我知道 Maps api 和 Play 服务都安装正确，就像我做的测试教程一样，一切正常。

按照[此处](https://developers.google.com/maps/documentation/android/map)的文档，我遇到了以下问题：在我的 setUpMapIfNeeded 方法中，我可以使用`getFragmentManager()`或`getSupportFragmentManager()`。当我使用`getFragmentManager()`Eclipse 时，它​​很酷，但是当我运行时，我得到一个`NoSuchMethodError`说法，即该方法未定义。当我选择 时`getSupportFragmentManager()`，Eclipse 不喜欢它并给我错误“无法从 Fragment 转换为 MapFragment”。那么有什么关系呢？有什么建议么？

```
private void setUpMapIfNeeded() {
    //Do a null check to confirm that we have not already instantiated the map.
    if (mMap == null) {
        mMap = ((MapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
        if (mMap != null) {
            //do things to the map
            mMap.addMarker(new MarkerOptions().position(LOCATION).title(EXTRA_URL));
            mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(LOCATION,15));
            mMap.getUiSettings().setZoomControlsEnabled(false);
        }
    }
} 
```

如果我可以提供任何其他代码，请告诉我，我很乐意快速发布。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-04-14T20:52:01.133

> 我可以使用 getFragmentManager() 或 getSupportFragmentManager()。

这里不应该争论。如果`getSupportFragmentManager()`您可以使用，那么您正在使用 Android 支持包的片段的反向移植，这是您必须使用的方法。

> 当我选择 getSupportFragmentManager() 时，Eclipse 不喜欢它并给我错误“无法从 Fragment 转换为 MapFragment”。

那是因为你不应该使用`MapFragment`. 您正在使用 Android 支持包的片段反向移植，因此您必须使用`SupportMapFragment`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-17T21:39:38.510

This is what i had to do, because i was working under level 11;

```
 import com.google.android.gms.maps.GoogleMap;
    import com.google.android.gms.maps.SupportMapFragment;
    import android.support.v4.app.FragmentActivity;

    public class MapaActivity extends FragmentActivity {

    private GoogleMap map;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_mapa);

        map =  ((SupportMapFragment)getSupportFragmentManager().findFragmentById(R.id.mapa)).getMap();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-01T10:00:08.390

嘿，只需将 v4 jar 添加到您的 libs 文件夹并添加到 build 然后在您的 Fragment 页面中导入即可

导入android.support.v4.app.FragmentActivity；

你可以扩展 FragmentActivity

公共类 MainActivity 扩展 FragmentActivity 实现 LocationListener{

}

它还访问 getSupportFragmentManager();

SupportMapFragment fm =(SupportMapFragment)getSupportFragmentManager().findFragmentById(R.id.map);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-08T23:38:05.553

将您的依赖项更改为：

```
implementation 'com.google.android.gms:play-services-maps:16.1.0'
implementation 'com.google.android.gms:play-services-location:16.0.0' 
```

# android - 为什么每次我添加/删除自定义类型的帐户时，Android 都会触发 Google 帐户同步？

> ID：16004141
> 
> 赞同：14
> 
> 时间：2013-04-14T20:45:30.297
> 
> 标签：android, sync, accountmanager

我有一个与 Web 服务链接的应用程序，该服务使用 AccountManager 和 Sync 来允许用户通过应用程序登录到他们的帐户并同步他们的数据（这是自定义数据，而不是联系人或 Google 帐户使用的任何其他内容）。AFAIK，我正在按照我应该做的一切。当用户通过我们的 API 登录时，我将他们的帐户保存到 Android AccountManager：

```
AccountManager am = AccountManager.get(context);
m.addAccountExplicitly(new Account(username, ACCOUNT_TYPE), account_id, user_data); 
```

我已将 ACCOUNT_TYPE 定义为应用程序的包名称，这足以将其与任何其他帐户类型区分开来。

添加帐户后，我将其设置为自动同步：

```
ContentResolver.setSyncAutomatically(account, AUTHORITY, true);
ContentResolver.addPeriodicSync(account, AUTHORITY, new Bundle(), SYNC_FREQUENCY_SECONDS); 
```

我已将 SYNC_FREQUENCY_SECONDS 定义为 86400（即 1 天）。

同样，如果用户注销，我只需从 AccountManager 检索他们的帐户并调用 removeAccount() 将其删除。很好很简单。

同步是通过我自己的代码执行的，因为它是正在同步的所有自定义数据，并且一切正常。然而，让我抓狂的是，每当我使用此代码添加或删除一个帐户（我自己的类型）时，它会立即触发设备上所有 Google 帐户的同步。这意味着，在同步我的数据之前，它首先必须同步所有电子邮件、日历数据、联系人、Google Play 杂志、Google+ 数据和图片等等等等。这可能需要几分钟，在此期间我的应用程序只是耐心地等待轮到同步数据。这非常令人沮丧，而且我的用户很难理解为什么他们登录后同步数据需要这么长时间（更不用说当它同步这么多数据时，

我在这里做错了吗？我的代码中是否有某些东西无意中告诉 Android，“嘿，现在去同步你所有的 Google 数据！”？还是我不得不忍受的谷歌帐户/同步框架中固有的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T11:23:44.450

我认为（尽管我不是 100% 确定）这是一个省电功能；发送一个长传输而不是几个较短的传输更节省电池电量，因为无线电在传输结束后会在一段时间内处于待机电源状态，因此发送一个长传输可以避免停留在待机状态（本质上是浪费功率）不止一次。所以我猜测同步基础设施会尝试尽可能多地进行同步。

如果关注的是第一次同步的延迟，也许除了定期自动同步之外，您还可以手动请求第一次同步的同步时间更短？

# matlab - 除了MATLAB中的特定圆圈之外，还有什么方法可以用黑色填充图像？

> ID：16004142
> 
> 赞同：-3
> 
> 时间：2013-04-14T20:45:34.427
> 
> 标签：matlab, image-processing

谁能帮我 ？我需要在 MATLAB 中制作一个充满黑色的图像，而不是我从以前的函数中获得的特定圆圈，这可能吗？谢谢~

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:32:56.813

这是可以做到的：

```
%Center of the circle is (x,y) and radius is r.
x=250;
y=250;
r=50;

%this is your image
a=true(500,500);
for i=1:500
   for j=1:500
      if ((j-x)^2+(i-y)^2)<=r^2 %condition that (x,y) lies on the circle.
         a(i,j)=0;
      end
   end
end
imshow(a)

%%%%%%%%%%%%%%%%%% Alternate method %%%%%%%%%%%%%%%%%%%%%%
%vectorized way

x=250;
y=250;
r=50;

%this is your image
a=true(500,500);
[x_meshgrid,y_meshgrid]=meshgrid(1:500,1:500);
circle_test=(x_meshgrid-x).^2+(y_meshgrid-y).^2-r.^2;
b=circle_test<=0;
%desiredImage=yourImage.*b;
desiredImage=a.*b; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T21:56:13.553

如果您只想渲染图像（之后不使用矩阵计算任何内容），您可以使用高级函数，例如`rectangle`或`viscircles`在图像上绘制圆圈。在命令窗口中键入`'doc rectangle'`参数说明。例如：

```
N=50;
x=23; y=11;
rad = 13;

img = zeros(N);

figure(1)
image(im); colormap gray; axis xy; axis image
hold on; rectangle('Position', [x,y,rad,rad], 'Curvature', [1,1], 'facecolor', 'w', 'edgecolor', 'w'); hold off; 
```

# class - 在类中调用方法

> ID：16004144
> 
> 赞同：1
> 
> 时间：2013-04-14T20:45:44.787
> 
> 标签：class, methods

我有一个程序，里面有一个类，然后在那个类中有另一个类，在那个类中有一个方法。我正在尝试在类中调用该方法。基本上：方法在 B 类中，而 B 类在 A 类中。

```
Class A
    Class B
        Method 
```

B类：

```
class MyTableModel extends AbstractTableModel
{
    public void getLibraryData () throws IOException
    {
        BufferedReader reader = new BufferedReader (new FileReader ("" + username [0] + ".txt"));
        BufferedWriter writer = new BufferedWriter (new FileWriter ("" + username [0] + ".txt", true));
        String line = null;
        int count = 0;

        while ((line = reader.readLine ()) != null)
        {
            songs [count] = line;
            artists [count] = reader.readLine ();
            categoryA [count] = reader.readLine ();
            count++;
        }
        data = new Object [count] [];
        for (int i = 0 ; i < count ; i++)
        {
            Object[] row = data [i] = new Object [3];
            row [0] = songs [i];
            row [1] = artists [i];
            row [2] = categoryA [i];
        }
    }
    private String[] columnNames = {"Song",
        "Artist",
        "Category", };

    private Object[] [] data = {
        };

    public int getColumnCount ()
    {
        return columnNames.length;
    }

    public int getRowCount ()
    {
        return data.length;
    }

    public String getColumnName (int col)
    {
        return columnNames [col];
    }

    public Object getValueAt (int row, int col)
    {
        return data [row] [col];
    }

    public Class getColumnClass (int c)
    {
        return getValueAt (0, c).getClass ();
    }
} 
```

我正在尝试调用 getLibraryData()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:52:33.970

调用 A 需要一个 getter 方法，就像`getB()`你可以调用 B 实例的方法一样。或者你在 A like 中创建一个 deferral 方法`getLibraryDataInB()`，或者你只是重写你的代码并且没有像这样的盒装类，如果它们必须从外部访问的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-22T04:35:36.903

您必须创建内部类的实例并调用该方法。干得好。 [http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

# java - 如何将从串口接收到的字节转换为十六进制？

> ID：16004153
> 
> 赞同：1
> 
> 时间：2013-04-14T20:46:04.853
> 
> 标签：java, serialization, serial-port, hex, bytearray

我需要为我的传感器板读取串行端口，我使用这个[例子](http://rxtx.qbang.org/wiki/index.php/Two_way_communcation_with_the_serial_port)来读取数据。但令我惊讶的是控制台终端上的输出数据看起来像这样

```
Wÿðÿ8Ã?íÈÓÿ 
```

因为我使用这种`System.out.print(new String(buffer,0,len));` 方法只是在每次接收数据包时打印数据。

但是当我将此方法用于六位数字时，输出将在接收任何数据之前写入零！

这种方法

```
 byte[] arr = { 0x00, 0x01 };
    ByteBuffer wrapped = ByteBuffer.wrap(arr); // big-endian by default
    short  num = wrapped.getShort();
    String f=String.valueOf(num);
    System.out.print(f); 
```

那么如何处理这个问题以将传入的字节转换为十六进制的可读数据！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:59:28.480

试试这个：

```
final byte[] arr = new byte[] { 0x00, 0x01 }; // or whatever your byte array is
final String asHexStr = DatatypeConverter.printHexBinary(arr)
System.out.println(asHexStr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T20:57:05.077

您应该充分利用现有接口的潜力。考虑使用`printf`.

```
byte[] arr = { 0x00, 0x01 };
ByteBuffer wrapped = ByteBuffer.wrap(arr); // big-endian by default
boolean read = true;
while(read)
  try { System.out.printf("%x",wrapped.get()); } //get each byte, print as hex
  catch(BufferUnderflowException ex) { read = false; } //stop at empty buffer
} 
```

# javascript - 使用 mongodb shell 脚本时可以处理多少有限制吗？

> ID：16004154
> 
> 赞同：0
> 
> 时间：2013-04-14T20:46:05.447
> 
> 标签：javascript, mongodb, mongodb-shell

我在将测试文档插入 MongoDB 时遇到问题。

我正在使用 JavaScript 创建我的测试文档，然后通过 MongoDB Shell 运行它们。但我得到了一些意想不到的结果。

我的脚本创建了一个具有以下树结构的文档。

```
-Project
  -Task
    -Timesheet 
```

当我尝试创建具有 15 个任务和 50 个时间表 ( `createCollections("my project", 5, "my task", 15, 50, 100);`) 的 5 个项目时，我只会在数据库中获得 2 个完整（无错误）的文档。当我尝试创建具有 1 个任务和 5 个时间表 ( `createCollections("my project", 5, "my task", 1, 5, 100);`) 的 5 个项目时，我只在数据库中获得 4 个完整（无错误）文档。比较奇葩。

我确信脚本会运行预期的迭代，因为我放置`prints`以验证插入是否实际运行。

**输出：（**如预期的那样。）

```
before 0
after 0
before 1
after 1
before 2
after 2
before 3
after 3
before 4
after 4 
```

## 剧本

```
db.test_embedded.drop();
db.createCollection("test_embedded");

var projectKey = 0;
var taskKey = 0;
var timesheetKey = 0;

Array.prototype.randomElement = function () {
    return this[Math.floor(Math.random() * this.length)]
}

function Iterator(array){
    var i = 0;
    this.array = array;
    this.length = array.length;

    this.next = next;
    function next() {
        return this.array[i++ % this.length];
    }
}

var userIds = new Array();
db.users.find({},{_id:1}).forEach(function (user) { userIds.push(user._id) });

var projectCollaboratorSlice = 0;
function project(title) {
    this._id = "project" + projectKey++;
    this.title = title;
    this.owner = userIds[0];
    this.collaboraters = userIds.slice(projectCollaboratorSlice++ % userIds.length + 1);
    this.tasks = new Array();
}

var taskCollaboratorSlice = 0;
function task(title) {
    this._id = "task" + taskKey++;
    this.title = title;
    this.owner = userIds[0];
    this.collaboraters = userIds.slice(taskCollaboratorSlice++ % userIds.length + 1);
    this.timesheets = new Array();
}

var timesheetUserIter = new Iterator(userIds);
function timesheet(duration) {
    this._id = "timesheet" + timesheetKey++;
    this.owner = timesheetUserIter.next();
    this.date = new Date(0);
    this.duration = duration;
}

function createTimesheets(num, duration) {
    var timesheets = new Array();
    for (k = 0; k < num; k++) {
        timesheets.push(new timesheet(duration));
    }
    return timesheets;
}

function createDoc(projectName, taskName, numTasks, numTimesheets, duration) {
    var newProject = new project(projectName);
    for (var i=0; i<numTasks; i++) {
        var newTask = new task(taskName + i);
        newTask.timesheets.push(createTimesheets(numTimesheets, duration));

        newProject.tasks.push(newTask);
    }

    return newProject;
}

function createCollections(projectName, projectCount, taskName, taskCount, timesheetCount, timesheetDuration){
    for (var p=0; p<projectCount; p++) {
        print("before" + p);
        db.test_embedded.insert(createDoc(projectName + p, taskName, taskCount, timesheetCount, timesheetDuration));
        print("after" + p);
    }
}
createCollections("my project", 5, "my task", 1, 5, 100); 
```

是我的脚本造成的，还是对您可以通过脚本执行多少操作存在限制/错误？

# c++ - 编译器会根据我处理未引用参数的方式做不同的事情吗？

> ID：16004157
> 
> 赞同：2
> 
> 时间：2013-04-14T20:46:11.870
> 
> 标签：c++, compiler-warnings, compiler-optimization, suppress-warnings

因此，我看到了许多线程解释如何避免未引用的参数警告，例如：

[避免警告“未引用的形式参数”](https://stackoverflow.com/questions/3020584/avoid-warning-unreferenced-formal-parameter)
[C++ 强制转换为 void 的目的是什么？](https://stackoverflow.com/questions/4178695/c-what-is-the-purpose-of-casting-to-void)

但我想知道的是编译器是否会根据使用的方法做任何不同的事情。例如，以下三种情况的编译输出是否会有所不同？

```
void Method(int /*x*/)
{
    // Parameter is left unnamed
}

void Method(int x)
{
    x;  // This would be the same as UNREFERENCED_PARAMETER(x);
}

void Method(int x)
{
    (void)x;  // This would be the same as _CRT_UNUSED(x);
} 
```

从编译器将做什么的角度来看，我对此最感兴趣，但是如果您对一种方法比其他方法强烈感觉，我也很高兴听到这些论点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T18:16:43.797

在这三个选项中，最后一个选项`(void)x;`在大多数情况下更可取。

第一个选项，保留参数未命名，是可以接受的，但通常为参数命名以用于调试目的很有用（例如，即使您没有在函数中使用参数，您也可能对它的值感兴趣调试时）。但是，在某些情况下，此选项很好，例如在执行[标记调度](http://www.boost.org/community/generic_programming.html#tag_dispatching)时。

第二个选项，`x;`可能会导致其他警告。Visual C++ 将针对此代码发出警告 C4555：

```
warning C4555: expression has no effect; expected expression with side-effect 
```

通过转换`x`为`void`via `(void)x;`，此警告将被抑制。（请注意，此警告默认关闭；此警告必须通过`#pragma`或命令行选项明确启用。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:48:47.723

我看不出编译器为什么会区别对待任何这些。但是确定编译器的唯一方法是查看编译器的输出。

我更喜欢第一个选项，因为这种情况（未使用的参数）是该语言功能的设计目的。

# wix - 如何从 WixUI_Advanced 中删除 FeaturesDlg

> ID：16004158
> 
> 赞同：2
> 
> 时间：2013-04-14T20:46:15.730
> 
> 标签：wix

我的应用程序只有一个“功能”，所以我想从 WixUI_Advanced 中省略 FeaturesDlg。我制作了一份 wixui_advanced.wxs 的副本，并对其进行了调整以使其按原样工作。

为了看看会发生什么，我注释掉了这一行：

```
<Publish Dialog="InstallDirDlg" Control="Next" Event="NewDialog" Value="FeaturesDlg" Order="4">WIXUIDONTVALIDATEPATH OR WIXUI_INSTALLDIR_VALID="1"</Publish> 
```

但是，正如人们所预料的那样，我的更改导致 InstallDirDlg 上的 Next 按钮变为 NOP。我猜我希望 InstallDirDlg Next 按钮“完成”一切并开始安装。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:42:43.050

您基本上想`Install`从`FeaturesDlg`. 这看起来像：

```
<Control Id="Install" Type="PushButton" ElevationShield="yes" X="212" Y="243" Width="80" Height="17" Hidden="yes" Text="!(loc.FeaturesDlgInstall)">
    <Condition Action="show">NOT Installed AND ALLUSERS</Condition>
    <Condition Action="default">NOT Installed</Condition>
    <Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">!(wix.WixUICostingPopupOptOut) OR CostingComplete = 1</Publish>
    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
</Control>
<Control Id="InstallNoShield" Type="PushButton" ElevationShield="no" X="212" Y="243" Width="80" Height="17" Hidden="yes" Text="!(loc.FeaturesDlgInstall)">
    <Condition Action="show">NOT Installed AND NOT ALLUSERS</Condition>
    <Condition Action="default">NOT Installed</Condition>
    <Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">!(wix.WixUICostingPopupOptOut) OR CostingComplete = 1</Publish>
    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
</Control> 
```

是的，那里发生了很多事情，因为该`Install`按钮是完成所有磁盘空间不足检查的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:18:23.827

您的 Next 是 NOP，因为您还没有为该控件的事件发布任何内容。

如果您希望“下一步”按钮带您进入最终安装对话框，即安装程序在继续安装之前要求用户确认，则将值设置为“VerifyReadyDlg”而不是“FeaturesDlg”。然后，您必须为“VerfiyReadyDlg”设置后退按钮控件，以便它带您回到原来的位置。

否则，如果您不想要这个，那么只需将“安装”按钮（如 Rob 的回答）放在您认为是最终对话框的对话框上。

# android - 是否可以使用捏缩放来更改布局？

> ID：16004167
> 
> 赞同：0
> 
> 时间：2013-04-14T20:47:52.130
> 
> 标签：android, android-layout

我正在开发一个 Android 应用程序，其中有一个 4x4 ImageViews 网格。我想实现一个捏缩放功能，其中我可以捏缩放以将布局更改为 2x2 图像视图，并进一步缩放到 1（或 1x1 图像视图）。我的问题是：这可能吗？（对不起，如果这听起来像一个菜鸟，我之前没有在 android 上实现捏缩放）如果是的话，有人可以给我一些可能有帮助的指针。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:19:18.320

是的，你可以做到，但如果你正在寻找它来平滑缩放它可能会非常棘手和有趣。如果您很高兴只检测到捏缩放和切换布局，那么它就足够简单了。使用[ScaleGestureDetector进行检测](http://developer.android.com/reference/android/view/ScaleGestureDetector.html)

# php - 如何将 id 转换为 PHP 类别的文本

> ID：16004168
> 
> 赞同：0
> 
> 时间：2013-04-14T20:47:54.830
> 
> 标签：php

例如，如何将 id 转换为类别的文本

```
cat_id='1' to NEWS
cat_id='2' to Hardware
cat_id='3' to Software 
```

这是我的文章代码： /* 类别 >`<?php echo ( $lajmifundit1['cat_id']); ?>`

并因此出现在浏览器中：到新闻：类别> 1

或其他文章：硬件

类别 > 2 如何将 id 1 替换为 NEWS 并将 id 2 替换为 Hardware

请帮我..！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:14:10.687

您需要将类别的名称保存在某处，因为现在您只有类别 ID。话虽如此，这里有一个例子：

```
$category = array(
   1 => "News",
   2 => "Hardware",
   3 => "Software",
);

foreach ($category as $name ) {
   echo $name;
} 
```

# c - C - 字符串数组到字符数组

> ID：16004169
> 
> 赞同：0
> 
> 时间：2013-04-14T20:48:00.023
> 
> 标签：c, vigenere

在 C 中，我需要从中获取一个字符串参数`argv []`并将其放入另一个数组中，以便我可以遍历字符。我该怎么做呢？

（这是为了实现 Veginre Cypher 仅供参考）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:56:12.793

如果要遍历`n`th 条目的字符`argv`：

```
int i;
int len = strlen(argv[n]);
for (i = 0; i < len; i++)
    // do something with argv[n][i] 
```

如果您想先将它们复制到其他地方（这很可能没有必要），请使用`strcpy()`or `strdup()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:04:19.430

您不需要将其复制到单独的字符串中。

方法如下：

```
// argv is array of strings, or array of array of chars
int main( int argc, char** argv ) // here argv is an array of strings
{
    int i = 0;
    while( 1 )
    {
        if( argv[1][i] == '\0' )
            break; // argv[1][i] <- Current character of the first cmd-line arg
        i++
    }
} 
```

或者如果您真的想复制它以使用简单的字符串，只需设置一个指向字符串开头的指针，如下所示：

```
char* firstArgument = argv[n]; // where n is the nth command line argument 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:06:33.547

您不需要复制字符串。你没有声明你正在改变字符串（虽然 argv 是可修改的，但我可能会不理会它），所以只需迭代它。

```
int main(int argc, char *argv[])
{
    if(argc < some_min_value) {
        print_usage();
        return -1;
    }

    for(int i = 0; argv[str_idx][i]; ++i) {
        char c = argv[str_idx][i];
        /* do something with c */
    }

    return 0;
} 
```

# hadoop - 缺少 Hive 执行 Jar：/usr/local/hadoop/hive/lib/hive-exec-*.jar

> ID：16004172
> 
> 赞同：7
> 
> 时间：2013-04-14T20:48:19.980
> 
> 标签：hadoop, jar, environment-variables, hive

我在我的 Ubuntu 机器上设置的单节点集群上运行 Hadoop 1.0.4。

我做了以下步骤来下载和安装 hive 版本

```
> svn co http://svn.apache.org/repos/asf/hive/trunk hive    
> cd hive 
```

我的 hadoop 安装文件夹是 $HADOOP_HOME/hive 和 $HADOOP_HOME=/usr/local/hadoop。我在 /home/hduser 下的 .bashrc 中设置了两个环境变量，这是我的 Hadoop 用户和 $JAVA_HOME。

```
export HADOOP_HOME=/usr/local/hadoop

export HIVE_HOME=$HADOOP_HOME/hive

export JAVA_HOME=/usr/lib/jvm/java-6-openjdk 
```

我还在 $PATH 变量中添加了 hadoop 和 hive 的 bin 文件夹，如下所示

```
export PATH=$PATH:$HADOOP_HOME/bin    
export PATH=$HIVE_HOME/bin:$PATH 
```

但是在从 CLI 运行 hive 时，我收到以下错误。

```
hduser@somnath-laptop:/usr/local/hadoop/hive$ bin/hive    
Missing Hive Execution Jar: /usr/local/hadoop/hive/lib/hive-exec-*.jar 
```

我应该下载这个 jar 并将其添加到 /lib/ 还是需要配置一些特定于配置单元的环境变量。任何建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:16:53.277

我自己解决了这个问题，但不确定到底发生了什么。

按照我在原始问题中提到的过程，我创建了 $HADOOP_HOME/hive 但它给了我一个丢失的 jar 错误。

所以，我所做的是：我下载了 hive-0.10.0.tar.gz 并将其解压缩到 $HADOOP_HOME 下。所以新创建的文件夹是 $HADOOP_HOME/hive-0.10.0。

我将 $HADOOP_HOME/hive-0.10.0/lib 下的所有 jar 复制到 $HADOOP_HOME/hive/lib 下，当我接下来执行时，

$HADOOP_HOME/hive> bin/hive

有效！请注意我的 $HIVE_HOME=$HADOOP_HOME/hive 和 $HIVE_HOME/bin 已添加到路径中。希望这可以帮助面临类似问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T09:14:57.677

tar 文件 apache-hive-0.13.1-src.tar.gz 缺少 lib 文件夹 您可以下载 hive-0.12.0.tar.gz 并将 lib 文件夹移动到 apache-hive-0.13.1-src 文件夹。现在蜂巢应该可以工作了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-16T22:13:57.200

只需找到您的 hive-exec-*.jar 文件夹并创建一个符号链接即可。

就我而言，首先我使用“cd /usr/local/Cellar/hive/1.2.1”进入 hive 文件夹

然后运行命令“ln -s libexec/lib/lib”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-06T07:39:24.250

我有同样的问题，我使用命令“source ~/.bashrc”

问题解决了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T23:07:09.690

尝试这个 ：

```
export HIVE_HOME=$HADOOP_HOME/hive/build/dist
export PATH=$HIVE_HOME/bin:$PATH 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-05T07:24:55.597

就我而言，设置 PATH 变量后，简单的重新启动会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-05T02:29:36.010

我在 2017 年 12 月在下面做了，它奏效了。

1.  将 hive 复制到 hadoop_home 目录
2.  在cygwin下面做了：

    ```
    export HIVE_HOME=$HADOOP_HOME/hive
    export PATH=$HIVE_HOME/bin:$PATH 
    ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-12T12:04:51.243

这是 2017 年对我有用的另一篇文章。

这个问题发生在我身上，因为我（初学者）提取 Hive tar 文件的方式。[我从us.apache.org](http://www-us.apache.org/dist/hive/)下载了“hive-2.3.0”并将文件解压缩到 /usr/local/hive。该 jar 应位于 /usr/local/hive/lib 中，但由于某些原因，它位于 /usr/local/hive**/bin/**lib 中。换句话说，/hive 下有一个额外的“/bin”目录，其中包含所有应该直接位于 /hive 下的文件。我通过将额外的 /bin 目录重命名为“/bin2”来解决这个问题，将 /bin2 中的所有文件移动到 /hive 主目录，并删除不必要的现在为空的 /bin2 目录。一旦 .jar 文件位于正确的目录中，运行 Hive 就没有问题了！以下是我使用的命令：

```
 cd /usr/local
    mv hive/bin hive/bin2
    mv hive/bin2/* hive
    rm -r hive/bin2 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-19T18:05:14.310

1.  尝试交叉检查您的环境变量路径，以防您输入错误。

2.  尝试通过键入以下命令重新加载 .bashrc

    `source ~/.bashrc`

3.  尝试重新启动您的机器

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-21T19:37:05.200

只想发布对我有用的东西（2017 年）。

使用 Spark 2.0.2，我不得不更改我的`$HIVE_HOME`变量（在我的情况下，这构成了我只是从我的`.bash_profile`.

希望这对其他人有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-22T03:12:12.410

问题是关于配置单元路径的，所以你可以检查所有涉及配置单元路径的配置文件。请记住，您必须确认已安装 hadoop。

**1、环境参数（/etc/profile或~/.profile）**

```
export HIVE_HOME=/usr/app/apache-hive-2.3.0-bin
export PATH=$HIVE_HOME/bin:$PATH 
```

**2、$HIVE_HOME/conf/hive-env.sh**

```
export JAVA_HOME= ${Your_JAVA_HOME_directory}
export HADOOP_HOME= ${Your_HADOOP_HOME_directory}
export HIVE_HOME= ${Your_HIVE_HOME_directory}
export HIVE_CONF_DIR= ${Your_HIVE_HOME_directory}/conf 
```

Hive 是基于 Hadoop 的，所以你必须在 hive-env.sh 上配置 hadoop 的路径。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-17T21:16:22.547

2021 - 由于 $HIVE_HOME 环境变量配置错误而出现类似问题

具体来说，我有：

$HIVE_HOME="/usr/local/hadoop/hive/ **bin** "

*所以 hive在 $HIVE_HOME/lib/hive-exec- .jar 中*寻找 lib/hive- exec- .jar 这是错误的

* * *

因此，工作配置为：

```
$HIVE_HOME="/usr/local/hadoop/hive"  # Or wherever you hive is installed
export PATH=${HIVE_HOME}/bin:${PATH} 
```

# java - android.content.res.Resources.NotFoundException

> ID：16004173
> 
> 赞同：0
> 
> 时间：2013-04-14T20:48:20.477
> 
> 标签：java, android, android-listview

我在尝试执行以下代码时收到此错误日志：

```
04-14 22:46:22.789: D/onCreate(18563): EOF
04-14 22:46:22.875: D/AndroidRuntime(18563): Shutting down VM
04-14 22:46:22.875: W/dalvikvm(18563): threadid=1: thread exiting with uncaught exception (group=0x40018578)
04-14 22:46:22.976: E/AndroidRuntime(18563): FATAL EXCEPTION: main
04-14 22:46:22.976: E/AndroidRuntime(18563): android.content.res.Resources$NotFoundException: File  from xml type layout resource ID #0x102000a
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.Resources.loadXmlResourceParser(Resources.java:1916)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.Resources.loadXmlResourceParser(Resources.java:1871)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.Resources.getLayout(Resources.java:731)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.LayoutInflater.inflate(LayoutInflater.java:318)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:332)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.AbsListView.obtainView(AbsListView.java:1586)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ListView.makeAndAddView(ListView.java:1782)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ListView.fillDown(ListView.java:705)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ListView.fillFromTop(ListView.java:762)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.ListView.layoutChildren(ListView.java:1633)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.AbsListView.onLayout(AbsListView.java:1416)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.View.layout(View.java:7175)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.View.layout(View.java:7175)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.View.layout(View.java:7175)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.View.layout(View.java:7175)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.View.layout(View.java:7175)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1146)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1865)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.os.Looper.loop(Looper.java:130)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.app.ActivityThread.main(ActivityThread.java:3687)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at java.lang.reflect.Method.invokeNative(Native Method)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at java.lang.reflect.Method.invoke(Method.java:507)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at dalvik.system.NativeStart.main(Native Method)
04-14 22:46:22.976: E/AndroidRuntime(18563): Caused by: java.io.FileNotFoundException: 
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.AssetManager.openXmlAssetNative(Native Method)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.AssetManager.openXmlBlockAsset(AssetManager.java:486)
04-14 22:46:22.976: E/AndroidRuntime(18563):    at android.content.res.Resources.loadXmlResourceParser(Resources.java:1898)
04-14 22:46:22.976: E/AndroidRuntime(18563):    ... 34 more 
```

这是代码。我已经更改了我正在使用的ListView的ID，所以我可以`this.getListView()`根据[这个](https://stackoverflow.com/questions/10841929/listview-yielding-nullpointerexception-on-setonitemclicklistener)问题使用，因为我之前遇到过同样的问题。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_waypoint_list);
    ArrayList<String> listItems = new ArrayList<String>();
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, this.getListView().getId(), listItems);
    this.setListAdapter(adapter);
//...    nothing changed here before so left away a part.
    ListView waypoint_list = this.getListView();
    waypoint_list.setOnItemClickListener(this);
    Log.d("onCreate", "EOF");
} 
```

* * *

这是 XML 布局文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".WaypointList"
    android:orientation="vertical"
    android:padding="20dp" >

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/my_list"
        android:textSize="30sp"
        android:textColor="#FF000000" />

    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scrollbars="vertical"
        android:choiceMode="singleChoice" >

    </ListView>

</LinearLayout> 
```

顺便提一句。该类被定义为`public class MyListActivity extends ListActivity implements OnItemClickListener`

现在我已将每个更改`this.getListView()`为`(ListView)this.findViewById(android.R.id.list)`，但它没有显示任何效果。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T12:09:56.720

在这里你制作一个新的 ArrayAdapter

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, this.getListView().getId(), listItems); 
```

作为第二个参数，您传递 ListView 的 id，而不是您应该传递您用来填充其行的资源的 id，例如：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, listItems); 
```

您也可以为一行创建自己的布局，但是您需要创建一个`my_layout.xml`描述行布局的新文件并将其`R.layout.my_layout` 作为第二个参数

# c++ - 我怎样才能有一个具有许多值的关联数组

> ID：16004176
> 
> 赞同：1
> 
> 时间：2013-04-14T20:48:40.667
> 
> 标签：c++, arrays, associative-array

我有一张专辑，上面有标题、发行年份和专辑中的歌曲。

我的数组是这样设置的：

```
std::string alb_name[256]['title', 'year', 'songs']; 
```

但我希望歌曲关联数组最多容纳 20 首歌曲。是否有捷径可寻？我在编程 1 节课，但我想不出办法。任何帮助都会得到帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T20:53:02.163

C++ 有一个叫做 a 的东西`std::map`，它作为一个关联数组工作。

```
#include <map>
#include <string>
#include <vector>

struct AlbumData
{
    int year;
    std::vector<std::string> songs;
};

std::map<std::string, AlbumData> albums;

AlbumData d;
d.year = 1966;
d.songs.push_back("A Day in the Life");
d.songs.push_back("When I'm 64");
albums["Sgt Pepper's Lonely Hearts Club Band"] = d; 
```

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T21:19:55.213

首先，您想使用数据库：[在什么情况下值得使用数据库？](https://stackoverflow.com/questions/2648802/at-what-point-is-it-worth-using-a-database/2649916#2649916)

您将需要多个关联数组或映射。这将允许您根据不同的字段进行搜索和排序。

例如：
标题表

```
+----------+-------+  
| ID_Title | Title |  
+----------+-------+ 
```

艺术家表

```
+-----------+-------------+
| ID_Artist | Artist name |
+-----------+-------------+ 
```

歌表

```
+-----------+----------+
| ID_Artist | ID_Title |
+-----------+----------+ 
```

您可以将歌曲表设置为按艺术家或标题排序。

还可以在网上搜索“数据库范式”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T20:57:29.043

A`struct`结构数据：

```
struct Album {
    string title;
    string year;
    vector<string> tracks;
}; 
```

A`map`将一个值映射到另一个值：

```
map<string, Album> albums;

Album album;
album.title = "Acoustic Sketches";
album.year = "1996";
album.tracks.push_back("Metamorphosis");
album.tracks.push_back("Rivulets");
//.. etc
albums[album.title] = album; 
```

# mongodb - 显示我当前在 MongoDB 中使用的数据库的命令？

> ID：16004182
> 
> 赞同：88
> 
> 时间：2013-04-14T20:49:21.413
> 
> 标签：mongodb

在 MongoDB shell 中显示当前数据库的命令是什么？

（我在谷歌上没找到）

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2013-04-14T20:52:01.047

通过猜测找到它:) 很简单：

`db`

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2013-04-15T03:13:36.360

在 shell 中获取数据库名称的命令是：

```
> db.getName() 
```

虽然只输入 db 有效，但您会发现这只能以交互方式工作，如果您正在处理脚本，这可能不会给出您想要的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-30T03:44:07.357

`db.current`

是一个 CLI 命令，它将显示您当前正在使用的数据库

# linux - 模拟 PTY 并输出换行流

> ID：16004183
> 
> 赞同：2
> 
> 时间：2013-04-14T20:49:29.290
> 
> 标签：linux, shell, unix, output-buffering, tty

我正在寻找一种方法来欺骗 Linux 程序，使其认为它已连接到 TTY，以便输出是行缓冲而不是块缓冲。

当我直接在终端仿真器内调用程序时，它的行为是正确的，但是如果我将它的输出通过管道传输到`while read line; do ...; done`或者`cat`它没有。

基本上我想得到这样的结果：

```
exec "${some_strange_wrapper}" "${some_program}" | while read line;
do
    # Do something...
done 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:49:29.290

在考虑在我的问题中写更多的东西时，我找到了答案！

使用`socat`！它是一个外部程序，可以在不同类型的文件描述之间建立许多不同类型的连接。

然而，在这种情况下，它可以像这样使用：

```
socat EXEC:"${some_program}",pty stdout 
```

感谢大家，检查这个问题是否需要回答！（尽管在这种情况下不再需要......）:-)

# wordpress - 链接到帖子的 ID (Wp)

> ID：16004185
> 
> 赞同：0
> 
> 时间：2013-04-14T20:49:32.687
> 
> 标签：wordpress, post, categories, slug, permalinks

我无法链接到单个帖子。我已经查询了我的循环以显示与 slug 匹配的帖子类别。所以我只需要一个图库模板。

这对我来说是一个问题，这意味着我不能简单地使用`get_permalink()`.

我的代码在下面，但不起作用。有什么想法吗？

```
<div id="tile-container">
<?php query_posts(array('category_name' => $post->post_name));?>

<?php while (have_posts()) : the_post(); ?>

  <?php

    $link = the_permalink( $post->ID );

    echo '<div class="tile-posts">';
    echo '<a href="' . echo $link . '">';
      the_content();
    echo '</a>"';
    echo '</div>';

  ?>

  <?php endwhile; ?>

  <?php wp_reset_query(); ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:57:00.590

你可以尝试使用`the_permalink()`

[http://codex.wordpress.org/Function_Reference/the_permalink](http://codex.wordpress.org/Function_Reference/the_permalink)

或者您也可以使用`$post->post_name`

我也注意到了这一点：

```
echo '<a href="' . echo get_permalink($link) . '">'; 
```

因为您已经分配`$link`给`get_permalink()`上面的方法，所以您不需要`$link`作为参数传入`get_permalink()`- 您应该能够像这样回显它

```
echo '<a href="' . $link . '">'; 
```

# php - 查询正在为每个循环中附加到一行的每个图像创建一个记录

> ID：16004188
> 
> 赞同：0
> 
> 时间：2013-04-14T20:49:43.637
> 
> 标签：php, mysql

我有这个查询，它会拉出附加到特定主题公园的游乐设施列表，并显示它们的详细信息和任何附加的照片（照片是从单独的表中提取的，并通过“ride_id”连接）。下面是查询

```
$park_id = $_GET['park_id'];
$query2="SELECT * FROM  `tpf_rides` LEFT JOIN tpf_images
ON tpf_rides.ride_id=tpf_images.ride_id 
WHERE tpf_rides.park_id = $park_id AND `type` LIKE '%Roller Coaster%' ORDER BY `name` ASC";
$result2 = $pdo->query($query2); 
```

问题是当我列出从此查询中提取的结果时，它会创建重复的行以供骑行，每个图像一个。

想要的是：

```
Ride 1 - Type <br>  
Manufactured by xxx, Opened xxxx <br>
image1 image2 

Ride 2 - Type <br>  
Manufactured by xxx, Opened xxxx <br>
image1 image2 image3 
```

但我目前拥有的是

```
Ride 1 - Type <br>  
    Manufactured by xxx, Opened xxxx <br>
    image1 

Ride 1 - Type <br>  
    Manufactured by xxx, Opened xxxx <br>
    image2 

Ride 2 - Type <br>  
    Manufactured by xxx, Opened xxxx <br>
    image1 
```

下面是我正在使用的每个循环。我需要对查询或循环进行哪些更改才能使其正常工作？

```
<?php foreach ($result2 as $row2): ?>

<h2 style="display:inline;"><?php echo $row2['name']; ?></h2><h3 style="display:inline;"> - <?php echo $row2['type']; ?></h3> 
<h3>Manufactured by <?php echo $row2['make']; ?>, Opened <?php echo $row2['opened']; ?> </h3>
<img border="0" src="<?php echo $row2['url']; ?>" style="max-height:250px; max-width:250px;" >

<br>

<?php endforeach; ?> 
```

我仍处于了解 PHP 和 MySQL 的早期阶段，因此详细的答案将非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:57:21.937

我现在在其他地方的帮助下解决了这个问题。如果它对其他人有帮助，这是实现它的代码：

```
$sLastRide = '';
foreach ($result2 AS $row)
{
    $sRide = $row['name'] . $row['type'];
    if (strcasecmp($sRide, $sLastRide) != 0)
    {
        if (!empty($sLastRide))
        {
            print('</div>' . PHP_EOL);
        }
        $sLastRide = $sRide;
        print('<div>' . PHP_EOL);
        printf('<h2 style="display:inline;">%s</h2><h3 style="display:inline;"> - %s</h3>' . PHP_EOL, $row['name'], $row['type']);
        printf('<h3>Manufactured by %s, Opened %s</h3>' . PHP_EOL, $row['make'], $row['opened']);
    }
    printf('<img src="%s" style="max-height: 250px; max-width: 250px" alt=""/>' . PHP_EOL, $row['url']);
}
print('</div>'); 
```

# android - 应用程序上下文始终返回 null

> ID：16004190
> 
> 赞同：0
> 
> 时间：2013-04-14T20:49:56.030
> 
> 标签：android, android-context

我的项目中有这个类：

```
public class MyClass extends Application {

    // some stuff

    private Context context;

    public MyClass() {
        processContext();
        APP_DIRECTORY = context.getFilesDir();
        PRIVATE_FILE = new File(APP_DIRECTORY, MD5(getIEMI()));
    }

    public void processContext() {
        do {
            this.context = this.getApplicationContext();
        } while (this.context==null);
    }

    // some other stuff, such as reading or writing above declared files

    public String getIEMI() {
        String IMEI;
        Boolean hasTelephony = context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_TELEPHONY);
        if(hasTelephony) {
            TelephonyManager telephonyManager = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);
            IMEI = telephonyManager.getDeviceId();
        } else {
            IMEI = "IMEI_not_AVAIABLE";
        }
        return IMEI;
    }
} 
```

但是`context`，即使我尝试遵循[此处](https://stackoverflow.com/questions/6516441/why-does-androidtestcase-getcontext-getapplicationcontext-return-null)提出的提示（模拟器中的错误），我在任何地方都会收到 NullPointerException（下面的 LogCat）。我不能使用`context = MyClass.this`，因为我总是（并且只）得到一个 NullPointerException。

> 04-14 20:25:28.063：E/AndroidRuntime(1084)：引起：java.lang.NullPointerException 04-14 20:25:28.063：E/AndroidRuntime(1084)：在 android.content.ContextWrapper.getApplicationContext(ContextWrapper .java:100) 04-14 20:25:28.063: E/AndroidRuntime(1084): at com.example.mypackage.MyClass.processContext(MyClass.java:71) // 这是 APP_DIRECTORY = context.getFilesDir 的行();

事实上，我不确定是否完全理解了 Android 中 Context 的定义。我非常有信心将课程扩展到超级`Application`课程就足够了。

我不能用参数作为上下文来构造类，从调用者（以这种方式：）到达，`(new MyClass(MainActivity.this))`因为我甚至需要从不是类扩展的`Activity`类中读取和写入文件。

我要生气了，说实话……

- 编辑 -

出于测试目的，我重新编写了该类，以便以这种方式构造它：

```
 public MyClass(Context app_context) {
        APP_CONTEXT = app_context;
        APP_DIRECTORY = APP_CONTEXT.getFilesDir();
    } 
```

调用 getFilesDir() 时，它总是返回 NullPointerException。

-- 编辑 2 --

正如评论中所建议的，我添加了 onCreate() 的声明：

```
 @Override
    public void onCreate() {
        super.onCreate();
        Context context = this.getApplicationContext();
        APP_DIRECTORY = getFilesDir();
        LOGIN_FILE = new File(APP_DIRECTORY, name);

        Log.e("MyApp", "Main point reached.");
    } 
```

这样，一切看起来都很好。但是在 onCreate() 方法中声明的文件似乎总是为空，就好像它们根本没有声明一样：当我尝试访问它们时，为了读取或写入，我得到了一个空指针异常。而事实上“达到了要点”。永远不会显示，就好像 onCreate() 根本不会被调用或处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:55:41.730

应用程序是上下文。尽量不要使用构造函数，而是使用 onCreate 。

您可以`getFilesDir`直接调用而无需`private Context context;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-31T11:28:19.770

替换`this.context`为`getActivity()`

# css - CSS语法和东西

> ID：16004191
> 
> 赞同：0
> 
> 时间：2013-04-14T20:49:57.913
> 
> 标签：css

所以我在没有帮助的情况下搜索了一堆.. 我一直在使用 css 一段时间，但最近一直在学习我不知道存在的小技巧（例如第 n 个孩子）而且我经常在 css 中看到 > 和 < ul > li 之类的东西，所以我想知道在哪里可以找到列表或教程之类的东西，或者任何可以在 css 中使用的小字符的东西？或者如果有人可以解释：p 我尝试检查几个站点，但他们只会解释嵌套，嗯，我不记得该怎么称呼它，但是当你喜欢 [input] 时，我想知道你还能做什么它到底是做什么的~谢谢c：

哦，任何其他任何人都知道的小技巧也很高兴知道

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:52:05.860

[http://www.w3.org/TR/css3-selectors/#selectors](http://www.w3.org/TR/css3-selectors/#selectors)

该链接中有很好的参考

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:52:27.453

您想研究 CSS 选择器。最好的非 w3 参考文章可能是[这个 Tuts+ one](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)。

# javascript - 碰撞数组无法正常工作javascript

> ID：16004197
> 
> 赞同：1
> 
> 时间：2013-04-14T20:50:31.907
> 
> 标签：javascript, jquery, multidimensional-array, collision-detection

只是想在我的游戏中实现碰撞。

我对如何测试瓷砖的碰撞有疑问，因此碰撞不起作用。

我有一个看起来像这样的数组：

```
var coll_array = [
[[tile_index],[x],[y]] 
] 
```

瓦片索引是im使用的图像地图中瓦片的编号，x是x位置，y是瓦片的y位置。

基本上，如果 tile_index 不为 0，那么玩家应该会撞到这个 tile，这就是我想要实现的。

**请参阅更新以获取代码示例**

出于某种原因，虽然我不确定为什么，变量 collided 一直返回 false，但我相信这与我设置数组的方式有关。

任何帮助将非常感激。我[这里有游戏的现场版](http://upbeatevents.co.uk/dis)

用户名=客人

密码=客人。

请使用新游戏，以便您可以看到正确的 console.log

我已经在播放器函数中放置了数组的控制台日志，以便您可以看到它是如何设置的。

谢谢

**更新**

好的，经过更多的尝试，代码现在看起来像这样：

```
function Player()
{
  var sprite = new Sprite(),
   collision_array,
   collided,
   x,
   y,
   w = sprite.width,
   h = sprite.height,
   gameW = canvas.width,
   gameH = canvas.height-192,
block_x,
    block_y,
    block_cx,
    block_cy,
    combined_hw = 32,
    combined_hh = 32,
   player_cx,
   player_cy;

this.keys = [];
// What delay do we want to use between switching sprites (in milliseconds)
this.moveSpeed = 4;
this.player = null;

this.init = function(coll_data){
    collision_array = coll_data;
    console.log(collision_array);
};

this.init_Player = function(pos_X, pos_Y){
  this.player = sprite.load("player");
   x = pos_X;
   y = pos_Y;
};

this.update = function(elapsed) {
    // perform a switch statement on the last key pushed into the array
    // this allows us to always move the direction of the most recently pressed
    // key

    switch (this.keys[this.keys.length - 1])
    {
        case 37:
            // move the player left on the screen
            x -= this.moveSpeed * elapsed;
            break;
        case 38:
            // move the player up on the screen
            y -= this.moveSpeed * elapsed;
            break;
        case 39:
            // move the player right on the screen
            x += this.moveSpeed * elapsed;
            break;
        case 40:
            // move the player down on the screen
            y += this.moveSpeed * elapsed;
            break;
    }
    if (x < 0)
    {
        x = 0;
    }
    if (x >= gameW - w)
    {
        x = gameW - w;
    }
    if (y < 0)
    {
        y = 0;
    }
    if (y >= gameH - h)
    {
        y = gameH - h;
    }

    player_cx = x+(32/2);
    player_cy = y+(32/2);

    collision_array.forEach(function(row) {
        for(var i = 0; i<row.length;i++){
            if(row[i][0] != 0){
                block_x = row[i][1];
                block_y = row[i][2];
                block_cx = block_x+(32/2);
                block_cy = block_y+(32/2);

            }

        }
        collided = Math.abs(player_cx - block_cx)< combined_hw
            && Math.abs(player_cy - block_cy)< combined_hh;
    });

    if(collided)
    {
        console.log("COLLIDED!")
    }
    return {
        'pos_X':x,
        'pos_Y':y
    };
};

this.draw = function() {
    ctx.drawImage(this.player,x, y, w ,h);
};
} 
```

这有效，但它只适用于存储在数组中的最后一个位置，例如右下角，你能看到我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:21:18.883

我只是快速阅读了这篇文章，但你说它只适用于最后一个区块，也许你应该尝试一下。

```
 collided |= Math.abs(player_cx - block_cx)< combined_hw
            && Math.abs(player_cy - block_cy)< combined_hh; 
```

ORing 发生碰撞，因此如果有任何块发生碰撞，这将是真的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T11:59:30.363

好的，所以我设法与固体块和对话出现的区域发生碰撞！

如果您想看看如何完成，我已将代码上传到[此处的实时站点。](http://upbeatevents.co.uk/dis)

为了澄清这一切都是通过一个平铺地图编辑器 JSON 文件完成的。而且我想这对任何人都有用，所以当我有机会时，我会把它放在 git 上，我什至会在博客上写一篇教程，因为我发现很难找到这方面的资源。

感谢任何帮助过的人。

# delphi - 移除 tcategorypanel 边框

> ID：16004200
> 
> 赞同：7
> 
> 时间：2013-04-14T20:50:44.623
> 
> 标签：delphi, delphi-xe

如何从 XE3 中的 TCategoryPanel 和 TCategoryPanelGroup 中删除边框？

试过这个并没有用：

```
type
   TCategoryPanel =  class (Vcl.ExtCtrls.TCategoryPanel)
protected
   procedure  CreateParams ( var  Params: TCreateParams);  override ;
end ;

procedure  TCategoryPanel.CreateParams ( var  Params: TCreateParams);
begin
  Inherited ;
  Params.Style:= Params.Style  and  not  WS_BORDER;
end ; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T21:24:51.127

因为`TCategoryPanel`您需要将受保护的属性设置`BevelOuter`为`bvNone`.

因为`TCategoryPanelGroup`您确实可以删除`CreateParams`. 像这样：

```
Params.Style := Params.Style and (not WS_BORDER); 
```

它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/gHNyj.png)

# ruby - 在 Ruby 中通过查询对 mongo 组进行排序

> ID：16004202
> 
> 赞同：1
> 
> 时间：2013-04-14T20:51:55.837
> 
> 标签：ruby, mongodb, group-by

我需要一些帮助在 ruby​​ 中对 mongo 'group by' 查询进行排序。

我让小组按部分工作。下面的查询按小时对记录进行分组，返回如下结果：

```
{"date"=>"2013,4,2,18,0,0,0", "count"=>1.0}
{"date"=>"2013,4,9,19,0,0,0", "count"=>1.0}
{"date"=>"2013,3,13,2,0,0,0", "count"=>3.0} 
```

理想情况下，结果将按“日期”字段排序。

```
data = db[collection_name].group(
"function(doc) {
var dateKey = doc.created_at.getFullYear() + ',' +
(doc.created_at.getMonth() + 1) + ',' + doc.created_at.getDate() + ',' +
doc.created_at.getHours() + ',0,0,0';
return {'date': dateKey};}", 
{"parent_id" => parent_id, "checked" => true},
{ :count => 0 },
"function(doc, y){y.count++}",
true) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:36:21.123

Ruby 有一个用于可数（包括数组）的内置[**sort_by**](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-sort_by)函数。

```
array = [
  {"date"=>"2013,4,2,18,0,0,0", "count"=>1.0},
  {"date"=>"2013,4,9,19,0,0,0", "count"=>1.0},
  {"date"=>"2013,3,13,2,0,0,0", "count"=>3.0}
]

p array.sort_by { |item| item['date'] }

# => [
#  {"date"=>"2013,3,13,2,0,0,0", "count"=>3.0}, 
#  {"date"=>"2013,4,2,18,0,0,0", "count"=>1.0}, 
#  {"date"=>"2013,4,9,19,0,0,0", "count"=>1.0}
#] 
```

**编辑**：您还可以将时间解析为块中的时间对象以确保正确排序。

```
require 'time'

array = [
  {"date"=>"2013,4,2,18,0,0,0", "count"=>1.0},
  {"date"=>"2013,4,9,19,0,0,0", "count"=>1.0},
  {"date"=>"2013,3,13,2,0,0,0", "count"=>3.0},
  {"date"=>"2013,4,13,2,0,0,0", "count"=>2.0}
]

p array.sort_by { |item| Time.parse(item['date']) }

# => [
#   {"date"=>"2013,3,13,2,0,0,0", "count"=>3.0}, 
#   {"date"=>"2013,4,2,18,0,0,0", "count"=>1.0}, 
#   {"date"=>"2013,4,9,19,0,0,0", "count"=>1.0}, 
#   {"date"=>"2013,4,13,2,0,0,0", "count"=>2.0}
# ] 
```

# php - 如何在不发送 id 的情况下使用 htacess 重定向页面

> ID：16004203
> 
> 赞同：0
> 
> 时间：2013-04-14T20:51:56.147
> 
> 标签：php, apache, .htaccess, url-rewriting

`.htacces`我对url 重写有问题。

我有一个文件夹`dir`，里面有三个文件

* * *

![在此处输入图像描述](https://i.stack.imgur.com/ktZIG.jpg)

* * *

`.htaccess`是空的，`i.php`也是空的，**但**在`index.php`我有

```
 $sql = mysql_query("SELECT * FROM clients ORDER By id DESC LIMIT 10"); 
        while($row = mysql_fetch_array($sql)){

        $url = "i/$row[id]/".preg_replace('/[^a-zA-Z0-9-_]/', '-', $row['company']);
        echo "<a href='".$url ."'>".$row['company'].'<br/ ></a>';

        } 
```

当我将鼠标悬停在`echo`输出上时，像

`localhost/dir/i/101/today-in-news`

```
localhost // is localhost obviously
dir // is a folder where I keep index.php and i.php files
i // is i.php
101 // is the id of the news
today-in-news // is the title of the news 
```

所以，当我点击它时，它会把我带到我想要的地方，但我需要摆脱 id，在这种情况下，`101`我希望链接只`localhost/dir/i/today-in-news`在我点击它时出现。我已经尽我所能，但没有任何结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:50:12.293

此代码会将标题传递到`i.php`您可以从数据库或其他任何地方提取它的位置。在[这里](http://codular.com/htaccess-introduction)查看一些 .htaccess 信息。

**索引.php**：

```
$sql = mysql_query("SELECT * FROM clients ORDER By id DESC LIMIT 10"); 
while($row = mysql_fetch_array($sql)){
    $url = "i/".preg_replace('/[^a-zA-Z0-9-_]/', '-', $row['company']);
    echo "<a href='".$url ."'>".$row['company'].'<br/ ></a>';
} 
```

**.htaccess**：

```
<IfModule mod_rewrite.c> 
    RewriteEngine On
    RewriteRule ^i\/([a-zA-Z0-9_-])+\/?$ i.php?title=$1 [L]
</IfModule> 
```

**i.php**

```
$title = $_GET['title']; 
```

# linux - 强制 GNU 链接器生成 32 位 ELF 可执行文件

> ID：16004206
> 
> 赞同：25
> 
> 时间：2013-04-14T20:52:05.100
> 
> 标签：linux, assembly, x86, ld, elf

嗨，我目前正在为我正在编写的编译器生成 x86 程序集，并且在我的 64 位 VM 上链接文件时遇到了一些问题（程序集代码是 32 位）。

我能够用这个命令很好地组装目标文件：

```
as --32 mult.S -o mult.o 
```

但我似乎找不到任何`ld`使它生成 32 位 ELF 文件的选项：

```
ld <some-option?> mult.o -o mult 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-14T21:16:48.487

> `ld <some-option?> mult.o -o mult`

```
ld -m elf_i386 mult.o -o mult 
```

您可以通过以下方式获取可用架构的列表：

```
ld -V 
```

样本输出：

```
GNU ld (GNU Binutils for Ubuntu) 2.24
  Supported emulations:
   elf_x86_64
   elf32_x86_64
   elf_i386
   i386linux
   elf_l1om
   elf_k1om
   i386pep
   i386pe 
```

但是，这不是必需的：ld 查看第一个对象，并且应该根据该对象的格式自动选择仿真。

# c++ - 如何将所有设置位向右移动？

> ID：16004208
> 
> 赞同：2
> 
> 时间：2013-04-14T20:52:15.553
> 
> 标签：c++, c, bit-manipulation

问题：如何开发算法将**32 位整数**`1`中的所有设置位 ( )向右移动

 **例子

```
V= 0b01001000110010 
```

`V`包含 5 个设置位，如果我们将它们向右移动，我们得到：

```
V = 0b011111 
```

我试过的：

```
v = v - ((v >> 1) & 0x55555555);                    // reuse input as temporary
v = (v & 0x33333333) + ((v >> 2) & 0x33333333);     // temp
c = ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24; // count 
```

上面的代码以 32 位整数返回设置的位数

并使用以下代码

```
c = (1<<c) - 1; 
```

我们将第`c`一个位设置为`1`. [解释](https://stackoverflow.com/questions/15816927/bit-manipulation-clearing-range-of-bits/15817020#15817020)

还有其他算法比上述解决方案更好吗？

在建议的解决方案中是否可以仅使用按位运算（`&`, `|`, `^`, `~`, `>>`, `<<`）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T21:01:27.623

```
bitset<32> const bv( V );
size_t const numSetBits = bv.count();
uint32_t const answer = ~( ~0U << numSetBits ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T21:16:41.720

我看到的最佳解决方案是使用人口计数来获得 1 位的数量，然后只使用`(1 << (pop_cnt % typeSize)) - 1`[1]，这就是您已经在做的事情。

要查找人口计数，您可以查看[此处](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetKernighan)，有几种有效的实现。如果你对 gcc 没问题，那么 gcc 的内置`__builtin_popcount`指令应该会为你的硬件生成最有效的代码。

[1] 正如另一篇文章的评论中正确指出的那样，`1 << pop_cnt`如果单词中的所有位都设置为一个，则未定义的行为。为了避免这种情况，请预先应用模字大小。只要您使用无符号类型，这将避免未定义的行为，为您提供正确的结果，并且如果您使用字长数据类型，实际上应该在 x86 下产生完全相同的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:05:57.557

```
int v = 0b01001000110010;
int a = 0;

for (int i = 0; i < 32; ++i) {
    if((v & 1) == 1)
       a = (a << 1) + 1;

    v = v >> 1;
}

v = a; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T20:54:36.637

你可以使用`V >>= 1;`还是`int v = (V >> 1);`不可以？

**如果目的是将所有**非零位一直向右移动，那么你可以这样做......

```
int v = 0;
int i;

for( i = 0; i < 32; i++, V >>= 1 )
   if( (V & 1) != 0 )
      v = (v << 1) + 1;

V = v; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T21:25:27.270

```
int shift(int V) {
    if (V != 0) {
        int r = 1;
        for (int i = 0; i < 32; i++)
            if ((V >> i) & 1) r <<= 1;
        return r - 1;
    } else return 0;
} 
```

节省一些补充。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-14T21:02:45.050

这将获得一些价值`v`。

```
// Count the bits (only iterates once per set bit)
unsigned count = 0;
for(; v!=0; v&=(v-1))
    ++count;

// Produce that many "shifted bits".
v = (1 << count) - 1; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-14T21:00:14.030

您可以尝试找到一个魔术常数并使用乘法和 (32 - 5) 右移（假设您使用 32 位整数来存储常数）。

```
#include <iostream>

int main()
{
   unsigned V = 0b01001000110010; 
   unsigned magic = 0x79838cb2; // try some random numbers until you succeed
   unsigned result = (V * magic) >> (32 - 5);   

   std::cout << result; // writes 31
} 
```

看看这个[问题](https://stackoverflow.com/q/14547087/819272)如何找到这样的常数

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-14T21:04:18.140

我建议使用两个变量：

```
unsigned int Squish_Bits(unsigned int value)
{
  unsigned int result = 0;
  for (i = 0; i < sizeof(value)/CHAR_BITS; ++i)
  {
    if (value & (1 << i))
    {
       result <<= 1;
       result |= 1;
    }
  }
  return result;
} 
```

尽管此函数不计算位，但它确实解决了您的示例。

这将在汇编语言中更好地实现，因为您可以将位移入进位，然后将进位移入结果。**

# python - numpy array.tolist() 和 scipy.sparse tolist() 有什么区别

> ID：16004212
> 
> 赞同：3
> 
> 时间：2013-04-14T20:52:35.327
> 
> 标签：python, numpy, scipy

```
import numpy as np
from scipy.sparse import lil_matrix 
```

使用 numpy 我得到

```
test_mat = (np.ones((4,6)))
test_list = test_mat[0,:].tolist() 
```

给出`test_list`一个包含 6 个元素的列表。但是，当我使用 scipy.sparse

```
test_mat = lil_matrix(np.ones((4,6)))
test_list = test_mat[0,:].todense().tolist() 
```

给出`test_list`一个包含一个元素的列表，该列表又包含 6 个元素（`test_list[0]`有 6 个元素）。

有人可以向我解释导致这种差异的潜在机制吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T21:01:16.707

这是因为`lil_matrix.todense()`返回一个 numpy `matrix`，它总是有`ndim = 2`，而不是 numpy `ndarray`，它会在切片中只选择一行/列时减小它的维度。矩阵/数组的维数在转换为列表格式时保留。

要查看数组中的 2d 行为，请将其切片为：

```
test_mat = np.ones((4,6))
test_list = test_mat[0:1,:].tolist() 
```

或者，将其启动为：

```
test_mat = np.matrix(np.ones((4,6)))
test_list = test_mat[0:1,:].tolist() 
```

您将看到列表的 2d 列表，就像您从`lil_matrix`

这是您在转换为列表*之前所拥有的：*

```
In [137]: ma = np.ones((4,6))

In [138]: mm = np.matrix(np.ones((4,6)))

In [139]: ms = lil_matrix(np.ones((4,6)))

In [141]: ma[0,:]
Out[141]: array([ 1.,  1.,  1.,  1.,  1.,  1.])

In [142]: mm[0,:]
Out[142]: matrix([[ 1.,  1.,  1.,  1.,  1.,  1.]])

In [143]: ms[0,:].todense()
Out[143]: matrix([[ 1.,  1.,  1.,  1.,  1.,  1.]]) 
```

使用不减少维度的切片：

```
In [144]: ma[0:1,:]
Out[144]: array([[ 1.,  1.,  1.,  1.,  1.,  1.]]) 
```

上面方括号的数量是关键。看看它们的形状：

```
In [145]: ma[0:1,:].shape
Out[145]: (1, 6)

In [146]: ma[0,:].shape
Out[146]: (6,)

In [147]: mm[0,:].shape
Out[147]: (1, 6)

In [148]: ms[0,:].shape
Out[148]: (1, 6) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T21:03:16.600

这是`array`密集矩阵的实现的结果：当您索引`array`as in

```
test_list = test_mat[0,:] 
```

你 cat 一个新的一维数组。

但是，当您对稀疏矩阵执行相同的索引时，结果是 1x6 稀疏矩阵。请注意，这仍然是一个二维矩阵，其中一维的长度恰好为 1。

由于`tolist()`返回一个表示矩阵的列表，因此您会得到一个简单的列表，用于从 中获得的 1D 对象`array`和包含稀疏矩阵行的 2D“列表列表”。

# android - 无需按下或使用按钮即可从 android 向服务器发送位置更新

> ID：16004216
> 
> 赞同：0
> 
> 时间：2013-04-14T20:52:59.070
> 
> 标签：android, button, android-intent, location

我做了一系列的研究和分析。我找不到正确的方法来做到这一点。所以我想请你帮忙。我有两件事想请教各位。

1）我得到了部分答案，但非常感谢您的精心帮助。如何从广播接收器启动意图以启动另一个活动。当我想在拨号时启动一项活动时，这就是我的选择。这是我到目前为止得到的。

```
public void onReceive(Context context, Intent intent) { 

       Intent i = new Intent();
       i.setClassName("com.tsering.project", "com.tsering.project.MainActivity");
       i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
       context.startActivity(i);
} 
```

2）有没有在不使用或按下android中的按钮的情况下向服务器发送位置更新等数据。我想自动将位置更新发送到服务器。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T10:21:09.110

基本上 onReceive() 用于接收来自另一端的广播数据。

它可能来自任何活动，也可能通过 Intent 的帮助来自服务，遵循 sendBrodcast(intent) 方法。

蒂姆是对的，但是按照实际步骤操作对您来说有点好处。检查 [***这个链接***](https://stackoverflow.com/questions/8095030/background-service-need-to-send-gps-location-on-server?rq=1)..希望这会给你一些更好的想法..[](https://stackoverflow.com/questions/8095030/background-service-need-to-send-gps-location-on-server?rq=1)

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:02:56.260

您可以使用位置管理器：

```
LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE); 
```

请求位置更新（请咨询 developer.android.com，了解使用什么作为参数）

```
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 50, this); 
```

并实现此方法来处理位置更改。在这里，您需要一些代码将数据发送到服务器

```
@Override
public void onLocationChanged(Location location)
{
    //...
} 
```*

# javascript - 如何使用按钮更改网站上的文本颜色？

> ID：16004218
> 
> 赞同：0
> 
> 时间：2013-04-14T20:53:15.123
> 
> 标签：javascript, html

我想知道如何使用按钮更改网站上的整个文本（段落、链接、标题）？我已经设法使用 Javascript 在我的网站上更改背景颜色：

```
 function chngebg (id)
{
    switch (id)
    {
        case 'b1':
            document.body.bgColor = "#0099FF";
            break;

        case 'b2':
            document.body.bgColor = "#FF6666";
            break;

        case 'b3':
            document.body.bgColor = "black";
            break;   

    }
} 
```

但我不知道如何让它改变网站上的文字。我有这样的想法： http: [//www.codelifter.com/main/javascript/colorbuttonsPop.html](http://www.codelifter.com/main/javascript/colorbuttonsPop.html)

这是我的网站（我是新手，不要太苛刻：P）：alexander.araweb.se（这些按钮目前在页面底部显示为 [x]。）

先感谢您！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:54:50.427

```
document.body.style.color = 'red'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T23:55:39.553

一切都必须单独更改。有两种方法可以做到这一点。

使用 CSS 或使用 JavaScript。

**1\. JavaScript**

给所有需要更改的 id 像这样：

```
<h1 id="title"> Title </h1> 
```

然后在 JavaScript 中通过其 id 访问所有内容并在函数中更改它：

```
function changeStyleTwo()
{
  document.getElementById('title').style.color = 'blue';
} 
```

**2.CSS**

给所有需要更改的类名，如下所示：

```
<h1 class="title"> Title </h1> 
```

在 JavaScript 中，当调用函数时，更改类名以便 CSS 可以像这样相应地更改它：

```
function changeStyleTwo()
{
  var title = document.getElementByClassName('title');
  title.className = 'titleStyleTwo';
} 
```

然后在 CSS 中，每个不同的类都有不同的 CSS 样式。

```
.titleStyleOne
{
  color:red;
}

.titleStyleTwo
{
  color:blue;
} 
```

# android - 如何使用 Jake Wharton & Support Library 缓存图像？

> ID：16004226
> 
> 赞同：2
> 
> 时间：2013-04-14T20:54:34.597
> 
> 标签：android, image, caching

我正在尝试关注[http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)讨论 DiskCache 的部分，但我在该代码中发现了很多问题。我修复了很多，但有一个我不知道该怎么做。就是这个：

```
mDiskLruCache.put(key, bitmap); 
```

和这个

```
mDiskLruCache.get(key); 
```

这些方法不存在。我正在添加 Jake Wharton 和 Support Library v4 的 .jar，但它们似乎都不起作用。拜托，谁能告诉我这是怎么回事？？

此外，我正在寻找如何使用该[https://github.com/fhucho/simple-disk-cache](https://github.com/fhucho/simple-disk-cache)捕获图像，但我不知道该怎么做。

任何帮助将不胜感激。

编辑 1

我正在使用 Budius 推荐的产品，但我遇到了问题。我正在创建那个 onCreate

```
DiskLruImageCache dlic=new DiskLruImageCache(getApplicationContext(),"bckgCache", CACHESIZE, CompressFormat.PNG, 70); 
```

所以我认为，每次打开应用程序时，我都会覆盖缓存，这很糟糕，因为我需要将一些位图从一种用途存储到另一种用途。有没有办法检查缓存是否已经存在所以我不再创建它？

编辑 2

我打开了另一个帖子问这个问题，所以我们不会将两者混为一谈。 [如何检查 DiskLruCache 是否已经存在？（安卓）](https://stackoverflow.com/questions/16054007/how-check-if-a-disklrucache-already-existsandroid)

不能将任何评论标记为答案，同样有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T15:09:02.397

[https://github.com/JakeWharton/DiskLruCache/blob/master/src/main/java/com/jakewharton/disklrucache/DiskLruCache.java](https://github.com/JakeWharton/DiskLruCache/blob/master/src/main/java/com/jakewharton/disklrucache/DiskLruCache.java)

查看源代码，open 方法会检查缓存是否已经存在并在可能的情况下返回它。

# javascript - 禁用 URL JavaScript 中的哈希链接

> ID：16004228
> 
> 赞同：1
> 
> 时间：2013-04-14T20:54:42.033
> 
> 标签：javascript, jquery

这可能是一个简单的问题，我确信我在这里遗漏了一些东西。

我要做的就是禁用 URL 中的哈希标记链接。例如，如果有人要输入 url:`www.example.com/#anchor`它将更改为`www.example.com`并完全删除 URL 中的哈希。

我什至不介意禁用该功能并将其保留在 URL 中，无论哪种方式。

到目前为止，这是我所拥有的，但我运气不佳：

```
var locationHashIndex = window.location.href.lastIndexOf("#"),
    station = window.location.href.slice(locationHashIndex + 1);

    window.location.href = window.location.href.substr(0, locationHashIndex); 
```

这让页面重新加载变得疯狂......不是我想要的。对这个有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T20:56:45.197

你可以做：

```
if(window.location.hash){
    window.location.href = window.location.href.replace(/#.*/,'');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T20:57:28.127

您将需要查看`window.location.hash`，它存储了您要删除的值，因此您只想在该变量中有值时*运行您的代码。*

```
if(window.location.hash != ''){
    // code here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T20:57:52.643

你应该`window.history.pushState`改用`window.location.href` [https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T21:12:19.843

如果您愿意使用 jQuery，请参阅[https://stackoverflow.com/a/8683139/618649](https://stackoverflow.com/a/8683139/618649)以获得一个简单的解决方案，以禁用所有带有 # 的 URL。

在这个例子中，你可以整天点击 Go There 链接，什么都不会发生。

```
<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    </head>
    <body>
        <a href="./#there"><span id="here">Go There...</span></a>
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.<br/>.
        <span id="there">There...</span></a>

        <script language="javascript">
        jQuery(function ($) {
            $("a[href*=#]").click(function(e) {
                e.preventDefault();
            });
        });
        </script>
    </body>
</html> 
```

# php - 从标题下载时缺少文件扩展名

> ID：16004231
> 
> 赞同：2
> 
> 时间：2013-04-14T20:55:23.103
> 
> 标签：php, apache, .htaccess, http-headers

我正在使用下面的代码下载一个文件，它工作得很好，但问题是文件扩展名丢失了，即使在有压力的下载之后也是如此。我尝试将其更改为其他 MIME 类型，可能是什么问题，我该如何解决？

```
header('Content-Type: audio/mp3');
header("Content-Disposition: attachment; filename=$row[3]");
header("Content-Length: ".filesize("$row[1]$row[2]"));
$fp = fopen("$row[1]$row[2]", "r");
fpassthru($fp);
fclose($fp); 
```

注意： $row 数组中的值很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T21:01:40.303

在这里只是在黑暗中拍摄，可能是文件名中有空格吗？在这种情况下，您可以尝试在文件名周围添加双引号，有关于省略空格后的部分的报告（例如：http: [//kb.mozillazine.org/Filenames_with_spaces_are_truncated_upon_download](http://kb.mozillazine.org/Filenames_with_spaces_are_truncated_upon_download)）

编辑：正如评论中所讨论的，标头没有返回扩展名，因此在后端手动添加 .mp3 扩展名可以解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T20:59:59.570

您可以尝试在文件名周围添加转义引号，如下所示：

```
header("Content-Disposition: attachment; filename=\"$row[3]\""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-03T04:20:20.563

升技修改帕特里克答案

```
header("Content-Disposition: attachment; filename="."\"{$fname}\""); 
```

# php - CakePHP 扩展烘焙控制器

> ID：16004233
> 
> 赞同：1
> 
> 时间：2013-04-14T20:55:28.990
> 
> 标签：php, cakephp-2.0

我正在开发一个非常复杂的应用程序，因此为简单起见，我将使用“电影”示例。

如果我使用控制台烘焙一个“电影”表，其中包含发布日期、流派等视图字段，并且我想通过扩展 MoviesController 以将演员添加到特定电影中来添加到电影表中：

```
class ActorsControler extends MoviesController{

} 
```

我将如何按照传统方式执行此操作.. 就 CakePHP 而言，是否有最佳实践？我希望将 Movies 和 Actors 视图分开，这样我就可以显示电影列表，并可以选择单独查看所选电影的演员。我可以在程序上执行此操作，但我希望我可以扩展 MoviesController 并以这种方式添加到 Movies 表中。有什么建议么？

提前致谢！

# c++ - Qt 从旧的 c++ 项目生成 .ui 文件？

> ID：16004235
> 
> 赞同：5
> 
> 时间：2013-04-14T20:55:38.510
> 
> 标签：c++, qt

我是 Qt 的新手，但对 C++ 有很好的掌握。我刚刚学习了 qt design (QT5) 来生成 GUI 和 .ui 文件，并在 VS 2012 中进行编码。

现在有一个纯手工编写的旧项目，没有 qt 设计。为了维护它，代码仍然需要手工编写。

是否有任何 qt 工具可以对代码进行逆向工程以产生 qt design 可以处理的东西？这样任何未来的 GUI 修改都可以在 qt 设计中进行吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T21:14:29.700

一个准备充分的项目会将应用程序逻辑与 UI 层隔离开来，从而更容易对后者进行更改或完全替换。如果您要转换的项目是这样的，它应该在某种程度上是可行的。

如果您保持相同的命名，则命令式 UI 和`.ui`生成的 UI 之间最显着的区别将是`ui->`访问 UI 成员时的额外内容。

没有工具可以为您完成所有工作，但您可以使用`QObject::dumpObjectTree()`树状表示 UI，如下所示：

```
QTabDialog::dialog <574,451,133,123>
      QBoxLayout::unnamed
        QBoxLayout::unnamed
        QBoxLayout::unnamed
      QPushButton::ok <45,91,82,26>
      QTabWidget::tab widget <6,6,119,75>
        QTabBar::tab control <0,0,48,24>
          QToolButton::qt_right_btn I
          QToolButton::qt_left_btn I
          QAccel::tab accelerators
        QWidget::tab base I
        QWidgetStack::tab pages <0,22,119,51>
          QFrame::first <2,2,115,47>
          QObject::unnamed
          QWidgetStackPrivate::Invisible::unnamed <2,2,115,47> 
```

如您所见，您可以轻松解析并获取当前 UI 中每个对象的类型和名称，您可以使用该信息以及元系统提供的功能来查询属性并生成 XML .ui 文件。

当然，您可以使用动态创建或删除元素的更动态的 UI，在这种情况下，这样做会更难。在这种情况下，您将不得不手动完成所有操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:14:51.857

简短的回答：没有。

好吧，可能有，但至少我不知道有任何工具可以采用 C++ GUI 并从中生成一个 .ui 文件。如果存在这样的东西，它很可能不会解析 C++ 代码，而是需要以某种方式附加到正在运行的应用程序，然后从中解析 GUI。据我所知，这实际上并不难实现，这要归功于 Qt 元对象和属性系统允许反射，但我不知道这样的工具，我怀疑它是否存在。有 GUI 测试工具可以执行此操作，但它们不会根据从正在运行的应用程序收集的数据生成 .ui 文件。

然而，手工编写 Qt GUI 是完全合理的，而且通常它也更易于维护（只要维护者精通 Qt 风格的 C++ 和 QWidgets）。

此外，如果您需要向 GUI 添加新的小部件（或从根本上修改现有的小部件，以便从头开始重写是合理的），那么使用 Qt Designer 实现这些小部件（独立版本或集成到Qt Creator IDE，不要与 QML Designer 混合，即使它们在 Qt Creator 中的相同图标后面）。根据我的观点和经验，通常最好使用 Designer 设计单个小部件（例如，QTabWidget 中的页面或对话框），但不要将整个 UI 作为一个大的 .ui 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-03T04:42:46.573

我在这里同意**@hyde**。实施这样的工具是不值得的。使用 Qt Designer 制作布局非常快。

但答案是肯定的。

软件自省工具[GammaRay](https://github.com/KDAB/GammaRay)可以将正在运行的 Qt 应用程序中的小部件保存到`.ui`文件中（我相信自 2012 年以来）。在 Qt 5.12 上测试 - 布局完全正确，但没有信号，没有对象名称，尽管它为恢复对象的层次结构及其属性提供了一个很好的起点。

对[Marc Mutz-mmutz](https://stackoverflow.com/users/134841/marc-mutz-mmutz)和[他的回答](https://stackoverflow.com/a/9214657/1104612)表示赞赏。

# database - 在@OneToMany 关联中获取列表？

> ID：16004240
> 
> 赞同：0
> 
> 时间：2013-04-14T20:56:24.213
> 
> 标签：database, jpa, relational-database, jpa-2.0, eclipselink

问题是，一个`user`有一个或多个`properties`，所以这就是我的实体类的原因`user`

```
@Entity
public class User implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private Integer id;

        // others attributes  

    //bi-directional many-to-one association to Property
    @OneToMany(mappedBy="user", fetch=FetchType.EAGER)
    private List<Property> properties;
    ..
} 
```

我的实体`property`：

```
@Entity
public class Property implements Serializable {
  private static final long serialVersionUID = 1L;
  ..
  //bi-directional many-to-one association to User
  @ManyToOne
  @JoinColumn(name="id_user")
  private User user;
  ..
} 
```

这些实体由`EclipseLink`.

这是我的桌子，我认为可以满足我的需求。

```
CREATE TABLE `user` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
   ..
   PRIMARY KEY (`id`),
  UNIQUE KEY `email_UNIQUE` (`email`),
  KEY `u_id_city_to_ac_id_idx` (`id_city`),
  KEY `u_id_state_to_as_id_idx` (`id_state`),
  KEY `u_id_country_to_acy_id_idx` (`id_country`),
  CONSTRAINT `u_id_city_to_ac_id` FOREIGN KEY (`id_city`) REFERENCES `address_city` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `u_id_country_to_acy_id` FOREIGN KEY (`id_country`) REFERENCES `address_country` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `u_id_state_to_as_id` FOREIGN KEY (`id_state`) REFERENCES `address_state` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=44 DEFAULT CHARSET=utf8 COMMENT='an user can be a tenant and a landlord also'; 
```

我的`property`桌子：

```
CREATE TABLE `property` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `id_user` int(11) unsigned NOT NULL,
   ..
    PRIMARY KEY (`id`),
  KEY `p_id_accomodation_to_pac_id_idx` (`id_accomodation`),
  KEY `p_id_room_type_to_prt_id_idx` (`id_room_type`),
  KEY `p_id_bed_type_to_pbt_id_idx` (`id_bed_type`),
  KEY `p_id_policty_cancelation_to_pc_id_idx` (`id_policy_cancelation`),
  KEY `p_id_user_to_u_id_idx` (`id_user`),
  KEY `p_id_city_to_ac_id_idx` (`id_city`),
  KEY `p_id_state_to_as_id_idx` (`id_state`),
  KEY `p_id_country_to_acy_id_idx` (`id_country`),
  CONSTRAINT `p_id_accomodation_to_pac_id` FOREIGN KEY (`id_accomodation`) REFERENCES `property_accomodation` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `p_id_bed_type_to_pbt_id` FOREIGN KEY (`id_bed_type`) REFERENCES `property_bed_type` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `p_id_city_to_ac_id` FOREIGN KEY (`id_city`) REFERENCES `address_city` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `p_id_country_to_acy_id` FOREIGN KEY (`id_country`) REFERENCES `address_country` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `p_id_policty_cancelation_to_pc_id` FOREIGN KEY (`id_policy_cancelation`) REFERENCES `policy_cancellation` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `p_id_room_type_to_prt_id` FOREIGN KEY (`id_room_type`) REFERENCES `property_room_type` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `p_id_state_to_as_id` FOREIGN KEY (`id_state`) REFERENCES `address_state` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `p_id_user_to_u_id` FOREIGN KEY (`id_user`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8; 
```

我想获取所有登录操作`properties`，`user`例如：

```
user = userEAO.find(user.getEmail());
user.getProperties(); //always empty 
```

我怎样才能做到这一点 ？我认为放置哪种类型`fetching`就足够了，但似乎不是。

**更新** 我更改为`LAZY`我的`FetchType`，现在看：

//与属性的双向多对一关联 @OneToMany(mappedBy="user", fetch=FetchType.LAZY) 私有列表属性；

`user`登录系统时：

```
User u = userEAO.findByEmail(profile.getEmail());
if (u != null){
  if (u.getProperties() != null){
    u.getProperties().size();
    System.out.println(u.getProperties().size()); // now prints 1
} 
```

**詹姆斯**，当你创建一个新`property`的对象时，`user`这就是你的意思，对吧？是的，创建后我将它添加到列表中=]`refreshing``property``property``user``properties`

```
public Message create(Property property) {
        try{
            em.persist(property);
            em.flush();
            em.refresh(property);
        }catch(ConstraintViolationException cve){
            cve.printStackTrace();

        }catch (Exception e) {
            e.printStackTrace();
            // 1062 : duplicate entry
            if (e.getMessage().contains("Duplicate"))
                return new Message(-1000);
            else{
                e.printStackTrace();
                return new Message(-1);
            }
        }
        return new Message(0);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:41:34.247

`FetchType.EAGER`意味着您的`Property`列表将与对象同时被检索。`LAZY`意味着您的列表将在您调用时立即被检索`getProperties().anyMethod()`。但是，条件是您的`User`对象仍由 JPA 管理（意味着它当前存在`EntityManager`管理您的实体实例的实例）。

Eager 的兴趣在于，即使列表`EntityManager`已关闭（例如，您的基础交易已关闭），您也可以访问您的列表。一种懒惰的做法是，在有效使用对象之前，您不会在内存中执行查询和映射对象

因此，在您的情况下，如果列表为空，则与获取模式无关（您在检索到用户后立即显式调用 getProperties()），但这是因为您在 DB 中没有数据或映射失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T13:18:29.853

确保当您持久保存您设置的用户对象时是属性。当您保留一个新属性时，请确保您设置其用户并将该属性添加到用户的属性中。您需要保持双向关系的双方。

您也可以尝试执行 refresh()。

# .htaccess - 301重定向不起作用htaccess

> ID：16004243
> 
> 赞同：0
> 
> 时间：2013-04-14T20:56:49.453
> 
> 标签：.htaccess, mod-rewrite, redirect

我已将我的照片库更改为我的虚拟主机帐户的子域。

由于谷歌仍在引用我图片的旧链接，我想用 htaccess 做一个 301 重定向。在 301 重定向中，我认为最好的方法是在传入的 URL 中搜索旧链接中的特定字符串，如果找到，则只需将照片附加到链接作为子域。

例如传入的 URL -`http://www.MYDOMAIN.com/photography-...y/12345_crABCD`

如果找到字符串“photography-gallery”，则检查传入 URL 的字符串，然后通过将子域照片附加到 URL 来 301 重写 URL

```
photos.MYDOMAIN.com/photography-gallery/12345_crABCD 
```

如果找到字符串并且它没有做任何事情，我也尝试了这个重定向 htaccess 只是去我的域

```
redirect 301 /photography-gallery/ http://www.MYDOMAIN.com/ 
```

有人可以帮助编写此 htaccess 重定向或重写的表达式吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:04:22.603

You will want to look into [.htaccess Rewrites](http://codular.com/htaccess-introduction), which will allow you to conditionally redirect.

You will want to check if the url matches `/photography-gallery/` at any point, and then redirect that off to the subdomain.

```
RewriteRule ^\/photography-gallery\/([0-9a-z_A-Z]+)\/?$ http://photos.domain.com/$1 [R=301,L] 
```

The above should do it for you. Also, take a look at using Google Webmaster Tools for ensuring that paths are redirecting correctly etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:35:31.437

如果你想将同一个 URL 重定向到另一个域，你可以使用这个简单的[`RewriteRule`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)

```
RewriteEngine on
RewriteRule ^photography-gallery/.*$ http://photos.mydomain.com/$0 [R,L] 
```

当一切按预期工作时，您可以更改`R`为`R=301`.

永远不要在启用的情况下进行测试，有关详细信息`301`，请参阅此答案[提示调试 .htaccess 重写规则](https://stackoverflow.com/a/9204355/1741542)。

# c - 为正态分布直方图生成数字？

> ID：16004244
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:56:53.510
> 
> 标签：c

我正在为直方图生成通常分布的数字。这是我的两个功能。首先用于生成，其次用于将它们转换为正态分布。出于某种原因，当我进行测试 printf 时，它只是返回最小负数。有人知道这件事吗？谢谢！

```
double s, u[1000], v[1000], z;
int transformed[1000];

void generateec(){
srand( time(NULL) );
for(int i = 0; i < 1000; ++i)
 {
 u[i] = rand() % 7-3;
 v[i] = rand() % 7-3;
 }

}

void transform(){
generateec();

for(int i = 0; i < 1000; ++i)
{
    s = (u[i]*u[i])+(v[i]*v[i]);
    transformed[i] = u[i]*(sqrt( (-2.0 * log(s) ) / s)); 

}

printf("%d %d %d \n", transformed[0], transformed[500], transformed[600]);

 } 
```

多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:00:00.483

在：

```
for(int i = 0; i < 1000; ++i)
{
    u[i] = rand() % 1;
    v[i] = rand() % 1;
 } 
```

表达方式：

```
rand() % 1 
```

总是产生`0`。

**编辑**：

由于同时编辑了程序，现在的问题是`sqrt`程序中函数的参数可以是负值。如果`sqrt`参数为负，则发生域错误`sqrt`并将返回实现定义的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:26:49.477

好的，看来您正在尝试实现 Box-Muller 变换。但是您的代码存在一些问题。

首先，你需要一个连续的均匀分布，而不是离散的，所以

```
u[i] = (double)rand()/(double)(RAND_MAX);
v[i] = (double)rand()/(double)(RAND_MAX); 
```

然后，变换部分大大偏离，见[Box Muller Transform](http://en.wikipedia.org/wiki/Box_Muller_transform "Box-Muller 变换")，它一定是沿着

```
transformed[i] = sqrt(-2.0 * log(u[i])) * cos(2 * pi * v[i]) ; 
```

哪里`pi = atan(1)*4`。

请注意，`2 * 1000`生成了正态分布的数字，因此您可以定义`transformed`为`double transformed[2000];`并执行此操作

```
transformed[2*i] = sqrt(-2.0 * log(u[i])) * cos(2 * pi * v[i]); 
transformed[2*i+1] = sqrt(-2.0 * log(u[i])) * sin(2 * pi * v[i]); 
```

请注意，仍然有非零概率得到`u[i] * v[i] == 0`。我把这留给你解决。

# java - 什么时候应该使用 JSF 而不是 Javascript+HTML+CSS UI？

> ID：16004248
> 
> 赞同：1
> 
> 时间：2013-04-14T20:57:10.623
> 
> 标签：java, javascript, css, jsf, jakarta-ee

我正在开发一个客户端-服务器应用程序——它是一个用于信用风险评估的简单决策支持系统。它有一个基于 Hibernate+PostgreSQL+一些 Java EE 技术的服务器和一个必须为用户显示一些 Web 表单的客户端（年龄、工作、信用记录、组合框、表格等的输入文件）。问题我不知道我应该为客户端选择什么：JSF 或带有 HTML 和 CSS 的 Javascript UI？据我所知，Jsf 是服务器端技术，但我对此并不完全理解。服务器端 GUI 是什么意思？

详细的解释会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:03:19.713

JSF 组件为封装在可重用模块中的 UI 提供 HTML、CSS 和 JS。

也就是说，他们有一个阶梯式的学习曲线。如果您不知道它们是如何工作的，请不要尝试在实际项目中对其进行测试。当你有时间的时候，自己研究它们，一旦你掌握了它们，就决定你是否使用它们。

# php - php安全下载（cpu使用）

> ID：16004252
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:57:29.353
> 
> 标签：php, security, download

我不会说一口流利的英语，对不起！我需要一个 php 安全下载 我正在使用此代码 但是当我下载大文件时 CPU 使用率太高 解决方案是什么？

我的 CPU 使用率

[http://s2.picofile.com/file/7726178274/Untitled_1.jpg](http://s2.picofile.com/file/7726178274/Untitled_1.jpg)

```
 <?php
@ini_set('error_reporting', E_ALL & ~ E_NOTICE);
//- turn off compression on the server
if(function_exists("apache_setenv"))
    @apache_setenv('no-gzip', 1);
@ini_set('zlib.output_compression', 'Off');
if(!isset($_REQUEST['file']) || empty($_REQUEST['file'])) 
{
    header("HTTP/1.0 400 Bad Request");
    exit;
}
// sanitize the file request, keep just the name and extension
// also, replaces the file location with a preset one ('./myfiles/' in this example)
$file_path  = $_REQUEST['file'];
$path_parts = pathinfo($file_path);
$file_name  = $path_parts['basename'];
$file_ext   = $path_parts['extension'];
//$file_path  = './myfiles/' . $file_name;
// allow a file to be streamed instead of sent as an attachment
$is_attachment = isset($_REQUEST['stream']) ? false : true;
// make sure the file exists
if (is_file($file_path))
{
    $file_size  = filesize($file_path);
    $file = @fopen($file_path,"rb");
    if ($file)
    {
        // set the headers, prevent caching
        header("Pragma: public");
        header("Expires: -1");
        header("Cache-Control: public, must-revalidate, post-check=0, pre-check=0");
        header("Content-Disposition: attachment; filename=\"$file_name\"");

        // set appropriate headers for attachment or streamed file
        if ($is_attachment) {
                header("Content-Disposition: attachment; filename=\"$file_name\"");
        }
        else {
                header('Content-Disposition: inline;');
                header('Content-Transfer-Encoding: binary');
        }

        // set the mime type based on extension, add yours if needed.
        $ctype_default = "application/octet-stream";
        $content_types = array(
                "exe" => "application/octet-stream",
                "zip" => "application/zip",
                "mp3" => "audio/mpeg",
                "mpg" => "video/mpeg",
                "avi" => "video/x-msvideo",
        );
        $ctype = isset($content_types[$file_ext]) ? $content_types[$file_ext] : $ctype_default;
        header("Content-Type: " . $ctype);

        //check if http_range is sent by browser (or download manager)
        if(isset($_SERVER['HTTP_RANGE']))
        {
            list($size_unit, $range_orig) = explode('=', $_SERVER['HTTP_RANGE'], 2);
            if ($size_unit == 'bytes')
            {
                //multiple ranges could be specified at the same time, but for simplicity only serve the first range
                //http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt
                list($range, $extra_ranges) = explode(',', $range_orig, 2);
            }
            else
            {
                $range = '';
                header('HTTP/1.1 416 Requested Range Not Satisfiable');
                exit;
            }
        }
        else
        {
            $range = '';
        }

        //figure out download piece from range (if set)
        list($seek_start, $seek_end) = explode('-', $range, 2);

        //set start and end based on range (if set), else set defaults
        //also check for invalid ranges.
        $seek_end   = (empty($seek_end)) ? ($file_size - 1) : min(abs(intval($seek_end)),($file_size - 1));
        $seek_start = (empty($seek_start) || $seek_end < abs(intval($seek_start))) ? 0 : max(abs(intval($seek_start)),0);

        //Only send partial content header if downloading a piece of the file (IE workaround)
        if ($seek_start > 0 || $seek_end < ($file_size - 1))
        {
            header('HTTP/1.1 206 Partial Content');
            header('Content-Range: bytes '.$seek_start.'-'.$seek_end.'/'.$file_size);
            header('Content-Length: '.($seek_end - $seek_start + 1));
        }
        else
          header("Content-Length: $file_size");

        header('Accept-Ranges: bytes');

        set_time_limit(0);
        fseek($file, $seek_start);

        while(!feof($file)) 
        {
            print(@fread($file, 1024*8));
            ob_flush();
            flush();
            if (connection_status()!=0) 
            {
                @fclose($file);
                exit;
            }           
        }

        // file save was a success
        @fclose($file);
        exit;
    }
    else 
    {
        // file couldn't be opened
        header("HTTP/1.0 500 Internal Server Error");
        exit;
    }
}
else
{
    // file does not exist
    header("HTTP/1.0 404 Not Found");
    exit;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:02:59.333

对于大文件，您最好使用 xsend 文件，它是 apache 的一个模块，非常容易设置，最重要的是，它可以完美地处理大文件。[https://tn123.org/mod_xsendfile/](https://tn123.org/mod_xsendfile/)

php 解决方案意味着您必须在提供下载之前读取内存中的所有文件，正如您所见，这是一个相当大的问题。

# database - Visual Studio VB.NET 数据库资源管理器“未指定错误”

> ID：16004259
> 
> 赞同：1
> 
> 时间：2013-04-14T20:58:13.580
> 
> 标签：database, vb.net, visual-studio-2010, ms-access, jet

我整天都在寻找解决此问题的方法，但找不到有效的方法。基本上，我已经通过 Visual Studio 连接到 Access 数据库一段时间了（我使用 Access 数据库是有原因的），但突然之间它无法连接。现在，每当我尝试添加数据库连接时，我都会收到“未指定错误”。我在这里搜索过，阅读了 MSDN，重新安装了 Visual Studio，但似乎没有任何效果。如果我转到“数据库资源管理器”，更改为 Access 数据库，浏览文件，然后点击“测试连接”/“确定”，我将收到错误消息。它也不是特定于文件的，它发生在所有人身上。

有任何想法吗？这里真的需要一些帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T01:56:23.807

一些可能有帮助的想法：

*   确保您的项目明确针对 x86 代码，而不是 x64 或 AnyCPU。
    Access Jet ( `.mdb`) 只能在 32 位下工作，如果您使用的是 ACE（用于新的`.accdb`数据库格式），您很可能也在使用 32 位版本的驱动程序。
    您不能混合使用 32 位和 64 位代码和数据库驱动程序，只要确保一切一致即可。

*   您的安装可能已损坏。
    如果您可以在另一台机器上执行相同的步骤并且它在那里工作，那么您可能需要重新安装 VS（先尝试重新安装[ACE 驱动程序](http://www.microsoft.com/en-us/download/details.aspx?id=13255)，看看它是否解决了问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-07T17:20:57.067

我也刚刚在连接到 MS Access 2013 的 VSB2013 上遇到了这个问题。

我也解决了一点我不完全理解为什么它会工作它有多稳定

注意 - 当我循环浏览 120 条 ish 记录时会出现问题。该过程是读取下一条记录 - 读取下一条记录等。记录类似，需要一些其他数据库读取来处理记录。Unspecified 错误发生在记录/循环 79 上，但记录非常相似。

在我的调查中，我发现以下所有 3 个工作（即 120 次循环都没有错误） - 但显然前 2 个仅用于调试

解决方案 1 - WORKS）在循环中插入一个 msgbox - 消息框报告将要处理的循环号和记录键

解决方案 2 - WORKS）将 msgbox 替换为一行，该行将相同的文本附加到我的表单上的富文本框中，并带有 Cr/Lf。

**解决方案 3 - 有效）将 RTB 更新替换为 Threading.Thread.Sleep(15) 行。调整睡眠的毫秒数表明 15 及以上在我的代码中始终有效。9 及以下的值始终失败。10 到 14 之间的值显示不一致的结果。**

据我所知，睡眠方法暂停循环以允许其他事件和垃圾收集发生。这是否类似于我们在 VB6 之前使用的 DoEvents。

这就是我所知道的。问候杰夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T01:50:36.243

在您访问数据库的代码块周围放置一个 try/catch 并检查返回的错误详细信息。

```
Try
  'Your code here
Catch ex as exception
  msgbox(ex.Message)
Finally
  'any code you want here like close connections etc
End Try 
```

一旦您有更多信息，请在此处发布，因为“未指定的错误”并没有说明太多，您也没有发布任何代码，因此很难看到可能发生的情况。

# wcf - 带有回调选项的 RESTful WebService

> ID：16004260
> 
> 赞同：-1
> 
> 时间：2013-04-14T20:58:21.707
> 
> 标签：wcf, http, rest, wcf-binding

我正在尝试创建一个 WCF RESTful WebService，它具有用于某些操作的 WebGet-Attribute，因此我可以在浏览器中显示它们的结果/更新（这里，我正在使用 HttpBinding）。但我也想使用回调通知其他客户这些结果/更新。我知道为此需要 wsDualHttpBinding。我的问题是，我是否仍然可以在浏览器中请求/访问我的操作，或者 wsDualHttpBinding 不支持此操作。如果是，请发布示例或参考教程

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:46:44.347

对于这种情况，我建议您检查一些“websocket”解决方案，例如 node.js、signalR、...

例如：[http ://martinsikora.com/nodejs-and-websocket-simple-chat-tutorial](http://martinsikora.com/nodejs-and-websocket-simple-chat-tutorial)

另外，从这篇文章：[http ://social.msdn.microsoft.com/Forums/en-US/wcf/thread/89dfefb8-7fa9-4bb0-8295-03447578a59d/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/89dfefb8-7fa9-4bb0-8295-03447578a59d/)

. . . 回调功能（双工通信）仅适用于 SOAP 服务。

# c++ - 简单的模板代码在 Visual Studio 中编译，但不使用 LLVM

> ID：16004264
> 
> 赞同：3
> 
> 时间：2013-04-14T20:59:27.960
> 
> 标签：c++, templates, function-pointers

我要做的是创建一个模板函数，该函数存储通用函数指针和有关如何转换为实际类型的信息。我的脚本绑定 API 使用它从 Python 为游戏引擎进行 C++ 函数调用。在使用带有 LLVM 的 XCode4 将其移植到 OSX 的过程中，我遇到了一个错误。此示例代码在 Visual Studio 2012 中编译并运行良好，但使用 LLVM 时出现错误“No matching function for call to 'Call'”。

```
#include <iostream>

void testfun (int i)
{
  std::cout << "Hello World " << i << std::endl;
}

typedef void BasicFunction ();

template <BasicFunction* fn, typename T0>
void Call (void(*f)(T0), T0 i)
{
  reinterpret_cast<decltype(f)>(fn)(i);
}

int main(int argc, const char * argv[])
{
  Call<reinterpret_cast<BasicFunction*>(testfun)>(testfun, 5);
  return 0;
} 
```

这是非标准代码吗？LLVM 的错误？还是有更好的方法来完成相同的任务？注意：函数指针必须在模板中排在第一位，这样才能自动推导出函数信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:43:24.933

叮当是正确的。我相信 14.3.2p1 排除了这一点：

> 非类型、非模板模板参数的模板参数应为以下之一：
> 
> — 一个常量表达式 (5.19)，它指定具有静态存储持续时间和外部或内部链接的对象或**具有外部或内部链接的**函数的地址，包括函数模板和函数模板 ID，但不包括非静态类成员，**表示为 (忽略括号）作为 & id-expression**，但如果名称引用函数或数组，则 & 可以省略，如果相应的模板参数是引用，则应省略；或者

重要的部分是`expressed (ignoring parentheses) as & id-expression`。表达式必须有一个`&`，但是您不能获取右值的地址。所以这几乎排除了任何演员表。

此外，从 5.19p2 开始`reinterpret_cast`在常量表达式中是非法的：

> 条件表达式是核心常量表达式，除非它涉及以下之一作为潜在评估的子表达式
> 
> — reinterpret_cast (5.2.10)；

# python - python的时间序列平均值

> ID：16004266
> 
> 赞同：0
> 
> 时间：2013-04-14T20:59:31.503
> 
> 标签：python, pandas, time-series

我看了看 Panda，它可能并不容易用于我的目的。可能有一个 python 工具包，我不知道。你能告诉我什么包可以轻松处理如下所述的情况吗？

我有一系列 2D numpy 气象变量的即时值数组（对于一个地理区域），在特定日期的 0、6、12、...、96、... 小时采样。

我将它作为 python 字典：

```
values[0]:[[3, 2,...,9, 5][6, 7, ..., 6, 7]]
...
...
values[96]:[[2, 2,...,8, 5][6, 7, ..., 5, 6]] 
```

我需要对可配置的聚合步骤进行平均。例如，对于 24 小时的聚合步骤，我将获得 4 个每日平均值：

```
values_avg24h=average(values, aggr_step=24)
values_avg24h[24]=[[...][...]]
values_avg24h[48]=[[...][...]]
values_avg24h[72]=[[...][...]]
values_avg24h[96]=[[...][...]] 
```

时间分辨率可以改变。此外，原始值也可以在不同的聚合步骤上进行平均。一个特定的现有软件包可以解决所有这些问题。无论如何，即使是这个简单问题的聪明解决方案也会受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:00:33.180

```
import numpy as np

def average(values, aggr_step=24):
    keys = np.array(values.keys())
    bins = range(aggr_step,1+keys.max(),aggr_step)
    npd = np.digitize(keys,bins)
    return {b:np.mean(np.r_[[values[k] for k in keys[npd==i]]],axis=0)
            for i,b in enumerate(bins)} 
```

抽出一些样本值，并测试：

```
values = {h:np.array([np.random.random_integers(1,10,5) for _ in 'x'*2])
          for h in np.r_[0:100:6]}

{0: array([[ 1,  2, 10,  8,  7],
       [10,  1,  8,  2,  5]]),
 6: array([[ 7, 10,  7,  6,  4],
       [ 9,  4,  6,  1,  1]]),
 12: array([[ 7, 10, 10,  5,  4],
       [ 7,  6,  2,  6,  7]]),
 18: array([[9, 9, 8, 5, 8],
       [8, 9, 6, 1, 2]]),
 24: array([[8, 1, 5, 9, 7],
       [1, 1, 6, 8, 3]]),
 30: array([[ 7,  2,  8,  3,  4],
       [ 5, 10,  5,  6,  5]]),
 36: array([[ 6,  5,  9,  4,  5],
       [ 6, 10,  8, 10, 10]]),
 42: array([[ 2,  2,  6,  6,  9],
       [ 5,  7,  4,  8, 10]]),
 48: array([[10,  1,  1,  1,  8],
       [ 5,  6,  4,  5,  8]]),
 54: array([[ 6,  2,  6,  6,  6],
       [10,  6,  9,  4,  8]]),
 60: array([[ 6,  8,  2,  1,  7],
       [ 1, 10, 10,  2,  3]]),
 66: array([[4, 8, 7, 1, 3],
       [1, 3, 8, 4, 2]]),
 72: array([[ 8,  9,  8,  6,  7],
       [ 1,  4,  2, 10,  1]]),
 78: array([[ 2,  1,  3,  8,  9],
       [ 2,  8,  6, 10,  3]]),
 84: array([[ 1,  8,  9,  4,  3],
       [ 9, 10,  8,  3,  4]]),
 90: array([[ 4,  4,  2,  8,  6],
       [ 1,  3, 10,  2,  6]]),
 96: array([[ 9,  9,  8,  4,  4],
       [ 2,  8, 10,  3,  5]])}

average(values,24)

{24: array([[ 6\.  ,  7.75,  8.75,  6\.  ,  5.75],
       [ 8.5 ,  5\.  ,  5.5 ,  2.5 ,  3.75]]),
 48: array([[ 5.75,  2.5 ,  7\.  ,  5.5 ,  6.25],
       [ 4.25,  7\.  ,  5.75,  8\.  ,  7\.  ]]),
 72: array([[ 6.5 ,  4.75,  4\.  ,  2.25,  6\.  ],
       [ 4.25,  6.25,  7.75,  3.75,  5.25]]),
 96: array([[ 3.75,  5.5 ,  5.5 ,  6.5 ,  6.25],
       [ 3.25,  6.25,  6.5 ,  6.25,  3.5 ]])} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T07:41:35.907

如果数据是定期采样的（您的帖子似乎表明了这一点），那么`pandas`肯定可以帮助您。

一种可能的`pandas`解决方案是创建一个`Panel`对象，其中`items`（字典中的类似键）属于 class `pandas.tseries.index.DatetimeIndex`。然后`major_axis`， 和`minor_axis`元素`Panel`将成为 numpy 数组中的行和列。这听起来有点奇怪，所以我将举一个简单的例子。

```
>>> import pandas as pd
>>> import numpy as np
>>> start_date = '4/14/2013'  # Start today (default time is midnight)

# create the date_range we will use as panel items
>>> ind = pd.date_range(start=start_date, periods=20, freq='6H')

# Create data: thanks @mtadd
>>> values = {h:np.array([np.random.random_integers(1,10,5) for _ in 'x'*2])
              for h in np.r_[0:120:6]}

# Create the Panel object directly from the dict of 2D np.arrays
>>> my_panel = pd.Panel(values)

# Set the Panel's items to be the date_range we made earlier
>>> my_panel.items = ind

>>> my_panel.ix[0]  # Show first 2D array of data
        0   1   2   3  4
     0  4   3  10   6  6
     1  4  10   7  10  6
>>> values[0]  # Same as above, but from the dict
    array([[ 4,  3, 10,  6,  6],
           [ 4, 10,  7, 10,  6]]) 
```

现在我们已经设置好了，我们将使用`Panel`方法`resample`。我们将提供两个参数，第一个是我们希望数据处于的新频率，第二个是`how`我们将指定为的关键字参数`mean`。 ***这是我回答的主要部分！***

```
>>> averaged = my_panel.resample('24H', how='mean')
>>> list(averaged.items)  # Show new time stamps for data
    [<Timestamp: 2013-04-14 00:00:00>,
     <Timestamp: 2013-04-15 00:00:00>,
     <Timestamp: 2013-04-16 00:00:00>,
     <Timestamp: 2013-04-17 00:00:00>,
     <Timestamp: 2013-04-18 00:00:00>] 
```

请注意，`'24H'`我们为`resample`方法提供的参数只是 OA 发布的示例的扩展。有关此参数可以采用哪些类型的描述的更多信息，请参阅[此链接](http://pandas.pydata.org/pandas-docs/dev/timeseries.html#offset-aliases)。

为了验证平均值是否正确计算，我们将比较中的第一项与`averaged` `Panel`我们手动计算的平均值。

```
>>> averaged.ix[0]
         0     1     2     3     4
    0  6.5  5.25  7.25  6.25  6.50
    1  5.0  6.75  5.25  6.50  5.25

>>> (values[0] + values[6] + values[12] + values[18]) / 4.
    array([[ 6.5 ,  5.25,  7.25,  6.25,  6.5 ],
           [ 5\.  ,  6.75,  5.25,  6.5 ,  5.25]]) 
```

`items`如果您传入一个对象，您可以在时间戳方面拥有更大的灵活性`datetime.datetime`。例如，如果您在元旦下午 1:37 开始采样并继续采样 50 个时段，您可以这样做：

```
>>> from datetime import datetime
>>> start = datetime(2013, 1, 1, 13, 37)  # 1:37 on 1/1/2013
>>> ind = pd.date_range(start, periods=50, freq='6H') 
```

然后你会像以前一样继续。您还可以将开始和结束项目传递给 date_range 而不是您希望它生成的周期数。如果我们从与上述相同的开始时间到 2 月 28 日凌晨 4:50，每 2 1/2 小时收集一次数据，您可以执行以下操作：

```
>>> end = datetime(2013, 2, 28, 4, 50)  # 4:50 AM on 2/28/2013
>>> ind = pd.date_range(start, freq='2H 30MIN') 
```

请注意，您不必传递与您传入的频率完全一致的开始和结束时间。有关如何使用[`Panel`](http://pandas.pydata.org/pandas-docs/dev/dsintro.html#panel)对象或[时间序列数据](http://pandas.pydata.org/pandas-docs/dev/timeseries.html)的更多详细信息，`pandas`请查看这些词中给出的链接。

# android - 我想将我的 android 类数据传递给一个类

> ID：16004273
> 
> 赞同：-2
> 
> 时间：2013-04-14T21:00:10.400
> 
> 标签：android

我有 4 个类向我显示传感器值和声音，我使用 onSensorChanged() 和 onProgressUpdate() 在 4 个类中获得不同的值，我想通过单击主类中的一个按钮来获取这些值

我的问题是如何将传感器值传递给我的班级？

这是我的声音.class

```
 public Void doInBackground(Void... params) {
        while(rec == true){
            try{
                Thread.sleep(250);
            }catch(InterruptedException e){
                e.printStackTrace();
            }
            ampitude = recorder.getMaxAmplitude();
            db =(float) (20 * Math.log10(ampitude));
            publishProgress(db);
        }
        return null;
    }
    public void onProgressUpdate(Float... progress){

        database.addSoundData(dB);
        dB = (progress[0].toString());
        sound.setText("dB: "+ dB);
    }
} 
```

这是我的传感器类之一

```
 public void onSensorChanged(SensorEvent event) {
    float speedX=event.values[0];
    float speedY=event.values[1];
    float speedZ=event.values[2];
    float absoluteSpeed = (float)Math.sqrt(speedX*speedX + speedY*speedY + speedZ*speedZ);

    db.addSpeedData(speedX, speedY, speedZ, absoluteSpeed );
    String results = "X: "+ event.values[0] + "\nY: "+ event.values[1] + "\nZ: "+ event.values[2] +"\nAbsolute: "+ absoluteSpeed;
    speed.setText(results);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:18:25.203

我会使用侦听器将值传递给我的 Activity，您将获得更新流，但您可以在按下按钮时使用它们更新 UI。这是一些粗略的伪代码。

像这样创建监听器

```
public Interface MyListener{

    public void onSensor1Update(Object value);
    public void onSensor2Update(Object value);
    public void onSensor3Update(Object value);
} 
```

在您的 Activity 中实现它，并将您的 Activity 引用到传感器类以充当侦听器。

```
public class MyClassActivity implements MyListener{

    public void createSensors(){
        Sensor1 s1 = new Sensor1();
        s1.listener = this;

        Sensor2 s2 = new Sensor2();
        s2.listener = this;
    }

    @Override
    public void onSensor1Update(Object value){
         //do something
    }
    public void onSensor2Update(Object value){
        //do something 
    }
    ....
    ....
    etc.
} 
```

为每个你想要一个值的类做这样的事情，它也可以为 AsyncTask 类做。

```
public class Sensor1{

    public MyListener listener;

    @Override
    public void onSensorChanged(...){
        listener.onSensor1Update(some value);
    }

} 
```

# mongodb - 无法更新流星集合

> ID：16004274
> 
> 赞同：1
> 
> 时间：2013-04-14T21:00:12.010
> 
> 标签：mongodb, collections, meteor

我是 Meteor 的新手，我不知道为什么会发生这种情况？我有一个名为`gameCol`我正在尝试更新的集合。集合中只有一个文档符合条件。当我这样更新时：

```
gameCol.update({started:true}, {$set:{started:false}}); 
```

流星投掷

```
Meteor.Error.prototype = new Error; at line 144 livedata_common.js 
```

如果我这样更新：

```
var status = gameCol.findOne({started:true});
gameCol.update({_id:status._id}, {$set:{started:false}}); 
```

一切都按预期工作。

这对我来说似乎有点奇怪，我也找不到任何解释它的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:21:32.533

引用形式的[文档](http://docs.meteor.com/#update)：

> 不受信任的代码 [= 客户端上的 js] 一次只能修改一个文档，由其 _id 指定。只有在检查任何适用的允许和拒绝规则后才允许修改。

这是出于安全原因（[此处](https://groups.google.com/forum/?hl=fr&fromgroups=#!searchin/meteor-talk/security/meteor-talk/qUa3clv4g5E/N7F8IaAX5AgJ)有说明）。因此，您需要使用第二段有效的代码。

# gcc - 理解 gcc 和 glibc 的一致性

> ID：16004276
> 
> 赞同：5
> 
> 时间：2013-04-14T21:00:17.907
> 
> 标签：gcc, build, glibc

我在一个相对较旧的系统上工作：

*   `gcc --version`打印`4.1.2 20080704`）。
*   `ldd --version`打印`ldd (GNU libc) 2.5`。

我希望下载并使用更新版本的 gcc（最新的稳定版本是`4.8.0`）。

为什么问题是，在构建或**使用** `gcc`编译其他工具/程序时，我需要在多大程度上关注`glibc`我正在使用它的版本？

更一般地说，如果我更新一个但不更新另一个，我会遇到什么问题，我如何找出`glibc`给定版本的哪些版本`gcc`可以很好地相互配合？

万一这很重要，我在我工作的机器上没有管理员权限，所以我需要手动进行升级。

# python - raw_input 和 dict

> ID：16004277
> 
> 赞同：2
> 
> 时间：2013-04-14T21:00:20.670
> 
> 标签：python, dictionary, raw-input

我试图将“房间”中的值作为键，将“acquity”作为字典的值，或者每次代码运行时都将最终值“acquity”分配给一个新变量（它需要运行 32 32 个房间的时间）。我无法弄清楚这一点，对不起，对此很陌生，任何帮助将不胜感激。

```
def main():

var=0

        while (var<33):

            room=raw_input("Input patient room Number ")

                ##Lists and prints/input for Procedural acuity
            print "1- No Procedures"
            print "2- IV Starts, Foley Catheter"
            print "3- Vitals, Neuro Check, Bladder Scans"
            print "4- Bedside Procedure, Physician post-op, frequent catheterization"
            a=raw_input("Input Procedural Acuity 1-4 ")

                ##Lists and prints/input for Nutritional acuity
            print "1- Setup Self"
            print "2- Ordering Assistance"
            print "3- Feed"
            print "4- Tubefeed, Aspiration Procedures"
            b=raw_input("Input Nutritional Acuity 1-4 ")

                ##Lists and prints/input for Medication acuity
            print "1- Minimal Oral"
            print "2- Moderate PO/IV"
            print "3- Dysphasia/Multi IV"
            print "4- Chemo/GTUBE/Complex IV"
            c=raw_input("Input Medication Acuity 1-4 ")

                ##Lists and prints/input for Mobility acuity
            print "1- Ad lib"
            print "2- Assist of SB"
            print "3- Assist of 1"
            print "4- Assist of 2"
            d=raw_input("Input Mobility Acuity 1-4 ")

                ##Lists and prints/inputs for Behavioral Acuity
            print "1- Calls Appropriately/No Needs"
            print "2- Some Education/ Calls Often"
            print "3- Anxious/ Calls Frequently"
            print "4- New Diagnosis, Calls very frequently, highly anxious"
            e=raw_input("Input Behavioral Acuity 1-4 ")

            a=float(a)
            b=float(b)
            c=float(c)
            d=float(d)
            e=float(e)

            Acuity1= a+b+c+d+e
            print "Patient in room %s, is graded at acuity %s"%(room, Acuity1)
            var= var + 1

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:12:51.540

在你的开头`main()`，让我们更改名称以`get_roomnumbers_dict`添加：

```
def get_roomnumbers_dict():
    var=0    
    d = {} # this line to initalize the dictionary

    while (var<33):
        ..... 
```

在您的功能结束时：

```
 .....
        Acuity1= a+b+c+d+e
        print "Patient in room %s, is graded at acuity %s"%(room, Acuity1)
        d[int(room)] = Acuity1 # saves to the dictionary
        var= var + 1
        # end of while loop here

    return d # returns dictionary for someone to check acuity and room number 
```

那么在你的代码中你可以简单地拥有：

```
acquity_by_roomnumber = get_roomnumbers_dict() # and that gets the dictionary 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:04:04.680

替换`raw_input`为`input`! 我之前有同样的错误！:P 也添加`import sys`到顶部！

# cross-compiling - 为 Raspberry Pi 交叉编译 C++11 代码

> ID：16004283
> 
> 赞同：11
> 
> 时间：2013-04-14T21:01:10.093
> 
> 标签：cross-compiling, raspberry-pi

我正在尝试将一个大量使用 C++11 功能的大型项目移植到 Raspberry Pi。该项目使用 CMAKE，我使用 crosstool-ng 进行交叉编译。我在 Pi 上安装了依赖项并将它们复制到本地，并且我设法让 CMAKE 找到它们。一些代码可以正确构建并产生 ARM 输出。但是，大多数代码都因混淆 GCC 输出而失败，我很确定这与 C++11/模板支持有关。例如，我收到这样的错误：

*   `error: 'mutex' in namespace 'std' does not name a type`（有问题的文件包括 <thread>，如果我还包括 <mutex>，这个错误就会消失，这不是 x86 Ubuntu 的要求）

*   `error: expected class-name before '{' token`（{ 之前的行是`template<typename _Res> class __basic_future : public std::__future_base`：）

*   `error: '__result_type' does not name a type`（这可能是由于上面的错误而发生的）

这些错误看起来像 ARM g++ 编译器只是不太喜欢模板。正在使用的 g++ 版本是`arm-unknown-linux-gnueabi-g++ (crosstool-NG 1.18.0) 4.7.3 20130102 (prerelease)`.

谁能指出我正确的方向？

编辑：这是 g++ 中的一个文件的样子`ps`：

```
arm-unknown-linux-gnueabi-g++ -DprojectCore_EXPORTS -fPIC
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/freetype2
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/glib-2.0
-I/home/sagar/workspace/RaspberryPi/target_env/usr/lib/arm-linux-gnueabihf/glib-2.0/include
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/gdk-pixbuf-2.0
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/gtk-2.0
-I/home/sagar/workspace/RaspberryPi/target_env/usr/lib/arm-linux-gnueabihf/gtk-2.0/include
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/cairo
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/pango-1.0
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/atk-1.0
-I/home/sagar/workspace/RaspberryPi/target_env/usr/local/include
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/eigen3
-I/home/sagar/workspace/RaspberryPi/target_env/usr/include/flann
-I/home/sagar/workspace/project/include -std=c++0x -Wall -Werror -Wno-deprecated -fPIC -g -O4
-o CMakeFiles/projectCore.dir/src/project/Core/Memory/Array2D.C.o -c /home/sagar/workspace/project/src/project/Core/Memory/Array2D.C 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-15T15:42:37.867

我认为唯一的事情是：

*   将`-std=c++0x`参数设置为`g++ compiler`
*   链接 pthread ( `-lpthread`)
*   你必须确定你正在编译`armv6`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-20T09:41:48.423

Let me start by saying I am not sure about the fix for this error. But I had seen a similar error while working with C++ in RPi for a large image processing code. I couldn't fix it by installing all the dependencies in time. Instead I ended up moving the entire code to cloud that was running windows server edition / windows 7 code where it compiled well. Just workaround idea if you are time bound!

# php - 除非字符串包含美元符号 ('$')，否则用于操作值的 PHP 函数不起作用

> ID：16004286
> 
> 赞同：0
> 
> 时间：2013-04-14T21:01:30.470
> 
> 标签：php, javascript, string

下面显示的*PHP*和*JS*函数一起工作，以 1) 从数组中填充`select`元素 2) 预先选择`options`匹配的*db*值，以及 3) 操作`select`元素`options`on的值`focus`。

*PHP*帮助函数与*JS* 函数协同工作，`focus`如果 db 值包含后缀“_default”，则它会操作字符串值，但只有在选项/字符串值包含美元符号 (“$”) 时才会触发它。代码中没有任何东西需要这样做，但我已经测试了所有可能性，这似乎是唯一导致它的原因。

[我已经在http://click2fit.com/sample_php_select.php](http://click2fit.com/sample_php_select.php)发布了一个带有组合代码的功能示例。要查看实际问题，请单击“提交”按钮而不关注任一`select`元素，它将`echo`发布两个`select`具有“默认”值的元素的值——一个带有美元符号，一个没有。为了演示问题，我对这些值进行了硬编码，而不是从*db*中获取它们。另外，我在这里发布了一个带有*JS*功能的小提琴[http://jsfiddle.net/chayacooper/JHAPp/6/](http://jsfiddle.net/chayacooper/JHAPp/6/)

*PHP 和 HTML*

```
<?php
// Helper function that replaces a key while maintaining the entry's position in the array. It does not modify the given array, but returns a new array.
function replaceKey($array, $oldKey, $newKey) {
    $newArray = array();
    foreach ($array as $key => $value) {
        $newArray[($key === $oldKey) ? $newKey : $key] = $value;
    }
    return $newArray;
} 
// Function to select the option matching the value in the db
function printSelectOptions($dataArray, $currentSelection) {
    foreach ($dataArray as $key => $value) {
        echo '<option ' . (($key == $currentSelection) ? 'selected="selected"' : '') . ' value="' . $key . '">' . $value . '</option>';
    }
}
  try {  
    $stmt = $conn->prepare("SELECT * FROM price WHERE user_id = :user_id");  
    $stmt->bindValue(':user_id', $user_id); 
    $stmt->execute();
}  catch(PDOException $e) {echo $e->getMessage();}
$row = $stmt->fetch();
$search_default = array('_default');
$replace_default = array('');
$row_default = str_replace($search_default, $replace_default, $row);
?>

<select name="importance" id="importance">
<?php
    // Generates a <select> element with the options specified in this array
    $options = array("1"=>"1", "2"=>"2", "3"=>"3", "4"=>"4", "5"=>"5");
    // If these are different then the value from the database includes "_default"
    if ($row_default['importance'] !== $row['importance']) {
        // Change the key for the entry in $options so it includes "_default" 
        $options = replaceKey($options, $row_default['importance'], $row['importance']);
    }
    $selected = $row['importance'];
    // Pre-selects the option matching the db information
    echo printSelectOptions($options, $selected);
?>
</select> 
```

*JS函数*

```
 $(function () {
     $('select').focus(function () {
         var option = $(this).find("option[value*=default]");
         option.attr('value', option.attr('value').replace(/_default/g, ''));
     });
 }); 
```

*JS函数的用途*

我正在为 apx 预先选择最常用的选项。300 个`select`元素，并使用此功能来区分这些值何时仍处于初始预选/默认状态与用户在关注表单元素后主动选择该值的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:11:39.893

`option`没有任何价值，`replace`也不能很好地与 jQuery 一起使用。

改变这个：

```
$(function () {
  $('select').focus(function () {
     var option = $(this).find("option[value*=default]");
     option.attr('value', option.attr('value').replace(/_default/g, ''));
  });
}); 
```

对此：

```
$(function () {
  $('select').focus(function () {
    var default_option = $("option[value*=default]"); // Just added this part to a variable, for easy of use.
    var option = default_option.val(); // Got the option value that contains the word default.
    // This will replace the '_default' with '' and assign the new value to the option
    default_option.val(function(index, value) {
      return value.replace(/_default/g, '');
    });
  });
}); 
```

但是javascript不是你唯一的问题。你的 php 代码有很多问题，恐怕你把它弄得比实际更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:14:46.110

在您的示例页面`option`上找不到，因为最初没有选项具有`_default`其价值。您需要从一开始就设置一个或编辑您的 JS 以包含一个选项，当没有找到选项时：

```
var option = $(this).find("option[value*=default]") ||  $(this).find("option:first-child"); 
```

但老实说，我不知道你想用这段代码实现什么。

# r - 在 Windows 7 中使用 /src 中的代码从源代码安装 R 包失败

> ID：16004288
> 
> 赞同：0
> 
> 时间：2013-04-14T21:02:07.070
> 
> 标签：r, package

我制作了一个包含 /scr 文件夹的包，我想在 Windows 7 中安装它。我安装了 Rtools for Windows 以防出现任何编译器问题，但是当我运行时：

```
> install.packages("mypackage.tar.gz", repos="NULL", type="source") 
```

我仍然收到如下错误消息：

```
Installing package(s) into ‘C:/Users/UserName/Documents/R/win-library/2.15’
(as ‘lib’ is unspecified)
Warning: unable to access index for repository NULL/src/contrib
Warning message:
package ‘mypackage.tar.gz’ is not available (for R version 2.15.1) 
```

这是我的会话信息（）：

```
> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252  LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats   graphics  grDevices utils   datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_2.15.1 
```

在 Windows 7 中从源代码（使用 /src）安装 R 包是否缺少任何东西？谢谢！

# python - Python布尔错误？

> ID：16004289
> 
> 赞同：0
> 
> 时间：2013-04-14T21:02:07.407
> 
> 标签：python

好的，所以我正在创建一个循环：

```
def equ(par1,par2):
    con1=4/par1

    ready=False
    add=False

    if ready==True:
        if add==True:
            par2+=con1
            add=False
            print("true")
        elif add==False:
            par2-=con1
            add=True
            print("False")
    elif ready==False:
        par2=con1
    ready=True
    input()
    return par2 
```

每次我运行程序时，它都没有做它应该做的事情。我注意到它不会改变为真。任何人都可以给我一些帮助吗？谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:05:06.840

First, you have no looping construct. You only have a linear flow of logic.

Second, `ready==True` will never be true, since it is explicitly set to `False` before that code block is ever hit.

If you're intending to reuse the boolean value `ready`, then you'd either want to preserve its state somewhere outside of the scope of the method - once you leave the method, it goes right back through and sets it to `False` again.

# image - 从 treectrl 项目中删除图像

> ID：16004290
> 
> 赞同：1
> 
> 时间：2013-04-14T21:02:13.523
> 
> 标签：image, wxpython, treecontrol

我将图像添加到 wxpython treectrl 项目中`tree.SetItemImage`。稍后将删除图像。我该怎么做？我只找到了`SetItemImage`方法，我没有找到类似`RemoveItemImage`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T13:38:59.887

不是很明显，但是可以通过为image参数调用`SetItemImage`和传递来移除item的图片`-1`

```
tree.SetItemImage(node, -1) 
```

# c# - C# 在独立应用程序的新 Outlook 邮件项中嵌入图像

> ID：16004292
> 
> 赞同：2
> 
> 时间：2013-04-14T21:02:27.447
> 
> 标签：c#, outlook, embed, native, email-attachments

将图像从独立应用程序嵌入到新 Outlook 邮件项目的最佳方法是什么。不为 Outlook 构建加载项。

尝试将现有图片嵌入或附加到新电子邮件项目。我已经阅读并查看了很多资源，但其中大部分都与交换或在 Outlook 中使用 AddIn 方法相关。

用户会看到嵌入到新电子邮件中的图像，并且只需要填写“收件人：”字段。也希望从应用程序中预先填充新电子邮件消息中的主题。

下面的代码：（我正在尝试将下面捕获的图片附加到 Outlook 电子邮件中！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Net.Mail;
using System.Net.Mime;

namespace While_You_Were_Out
{
    public partial class main : Form
    {
        public main()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            WindowState = FormWindowState.Normal;
            Show();

            Rectangle l = Screen.PrimaryScreen.WorkingArea;
            //Sets Position Manual all other Dialogs are set within parent center area.
            this.StartPosition = FormStartPosition.Manual;
            this.Location = new Point(Screen.PrimaryScreen.WorkingArea.Width - this.Width, Screen.PrimaryScreen.WorkingArea.Height - this.Height);
        }

        private void aboutToolStripMenuItem_Click(object sender, EventArgs e)
        {
            new AboutDialog().ShowDialog(this);
        }

        private void trayIcon_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            WindowState = FormWindowState.Normal;
            Show();

            Rectangle l = Screen.PrimaryScreen.WorkingArea;
            //Sets Position Manual all other Dialogs are set within parent center area.
            this.StartPosition = FormStartPosition.Manual;
            this.Location = new Point(Screen.PrimaryScreen.WorkingArea.Width - this.Width, Screen.PrimaryScreen.WorkingArea.Height - this.Height);
        }

        private void trayRightClickMenu2_Opening(object sender, CancelEventArgs e)
        {

        }

        private void toolStripMenuExit_Click(object sender, EventArgs e)
        {
            //Exit Application
            Application.Exit();
        }

        private void toolStripMenuOpen1_Click(object sender, EventArgs e)
        {
            WindowState = FormWindowState.Normal;
            Show();

            Rectangle l = Screen.PrimaryScreen.WorkingArea;
            //Sets Position Manual all other Dialogs are set within parent center area.
            this.StartPosition = FormStartPosition.Manual;
            this.Location = new Point(Screen.PrimaryScreen.WorkingArea.Width - this.Width, Screen.PrimaryScreen.WorkingArea.Height - this.Height);
        }

        private void button1_Click(object sender, EventArgs e)
        {
            //Hides to System Tray
            this.Hide();
            trayIcon.Visible = true;
            //Dispose();
        }

        private void button2_Click(object sender, EventArgs e)
        {

        }

        private void sendNotificationToolStripMenuItem_Click(object sender, EventArgs e)
        {
            /* Bitmap bmp = new Bitmap(panel1.Width, panel1.Height);
             panel1.DrawToBitmap(bmp, new Rectangle(0, 0, bmp.Width, bmp.Height));
             bmp.Save(@"C:\Razor\wywo_notification.jpg");
             bmp.Dispose();*/

            SaveAsBitmap(panel1, @"C:\Users\Razor\wywo_notification.jpg");
        }

        private void clearFormToolStripMenuItem_Click(object sender, EventArgs e)
        {
            txtBox6.Text = string.Empty;
            txtBox8.Text = string.Empty;
            txtBox9.Text = string.Empty;

        }

        public void SaveAsBitmap(Control control, string fileName)
        {
            //get the instance of the graphics from the control
            Graphics g = control.CreateGraphics();

            //new bitmap object to save the image
            Bitmap bmp = new Bitmap(panel1.Width, panel1.Height);

            //Drawing control to the bitmap
            panel1.DrawToBitmap(bmp, new Rectangle(0, 0, control.Width, control.Height));

            bmp.Save(fileName);
            bmp.Dispose();

        }

        private void sendToOutlook_Click(object sender, EventArgs e)
        {  

        }

    }

} 
```

我能够使用 VBS 脚本执行该功能：

```
Set olApp = CreateObject("Outlook.Application")
Set olMsg = olApp.CreateItem(0)

With olMsg
  .To = "test@test.com"
  '.CC = "cc@test.com"
  '.BCC = "bcc@test.com"
  .Subject = "Subject"

.HTMLBody = "<html><p>This is a picture.</p>" & _
                   "<img src='cid:wywo_notification.jpg'>"
  '.Body = "<IMG align=baseline border=0 hspace=0 src=cid:myident>"
  '.Attachments.Add "C:\users\doej\wywo_notification.jpg" 
   '.Attachments.Add "C:\users\doej\wywo_notification.jpg"

  .Display
End With 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T00:39:46.077

我能够依靠从应用程序中调用的 VBS 脚本来解决我的问题，这很简单并且解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:33:37.853

您现有的代码是什么？创建附件并使用 Attachment.PropertyAccessor 设置 PR_ATTACH_CONTENT_ID 属性（DASL 名称“ [http://schemas.microsoft.com/mapi/proptag/0x3712001F](http://schemas.microsoft.com/mapi/proptag/0x3712001F) ”）。

然后，您的 HTML 正文将需要通过 cid 引用该图像附件：

img src="cid:xyz"

其中 xyz 是 PR_ATTACH_CONTENT_ID 属性的值。

[使用OutlookSpy](http://www.dimastr.com/outspy/)查看现有消息（单击 IMessage 按钮）。

# java - 未使用局部变量chaine2的值

> ID：16004295
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:02:55.677
> 
> 标签：java

我收到此错误消息：`The value of the local variable chaine2 is not used`。

编码：

```
package com.example.Projet_java;

public class MyFirstClass 
                         {
  public static void main(String[] args) {
     { String chaine = new String("HELLO"),
      chaine2 = new String();
      chaine2 = chaine.toLowerCase();
     }
                                         }
                          } 
```

我尝试遵循以下线程 [Java 错误“未使用局部变量的值”](https://stackoverflow.com/questions/11062919/java-error-value-of-local-variable-is-not-used) 但没有成功。

有人知道我该如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:06:04.960

1.  `chaine2 = new String()` is redundant. Delete that.
2.  You should use the value of `chaine2`, which currently you don't. For example, print it out.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:06:28.163

It's the `chaine2 = new String();` You're assigning a new `String()` to `chaine2`, and then immediately discarding it when you reassign it in the next line with `chaine2 = chaine.toLowerCase();`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:07:24.093

`The value of the local variable chaine2 is not used` is a **warning** and not an **error**.

Your IDE is saying that you never use the variable `chaine2`, that is, you neither use it in other operations, nor store it anywhere, nor print it on screen nor anything... Anyway your code will run!

Despite of what is being said in other answers, warnings are very useful notifications about things that **may** lead to errors, so they're very useful while programming, because your IDE will notice issues that you may not notice. So you shouldn't *discard them while learning Java*!

* * *

**EDIT**: If what you want to do is to get the String "HELLO" in lowercase, don't seek anymore... you got it! The only point is that you have it stored in a avariable `chaine2` but you don't do anything with it... Just do:

```
System.out.println("Printing chaine2: " + chaine2); 
```

And you will see the result printed on the console.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T21:21:12.140

学习一门特定的语言，即使是一开始也不应该让程序员忘记仔细设计它的算法。您的算法应始终尽可能是最佳的。

Moderns IDE 有助于不要忘记 ;) => 一个无用的变量？（因为在您的情况下，`chaine2`初始化后根本不使用）=> 把它扔掉！

因此，您应该真正注意您最喜欢的 IDE（或其他来源）抛出的任何警告，即使对于简单的“Hello World”算法也是如此。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-14T21:05:55.067

You are setting an object to `chaine2`,

```
chaine2 = new String(); 
```

but you overwrite it at the next line, so the previously created empty String is not used for anything.

```
chaine2 = chaine.toLowerCase(); 
```

The compiler finds it odd, since the first line is useless, and warns you in case it is a logic error (although it is a correct program and will compile and run correctly).

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-14T21:06:49.823

It's a **warning**, not an **error**. This is the way compiler informs you thay you create variable which you never use. This variable is useless, so there is no point in creating it. You can just ignore this warning if you're learning Java, because it doesn't prevent your code to being compiled and execute. It's just a tip for you: "Hey, you have a variable you don'tuse! Maybe you've missed something?"

# php - Codeigniter 不断收到带有查询的 Error500

> ID：16004297
> 
> 赞同：0
> 
> 时间：2013-04-14T21:02:57.307
> 
> 标签：php, mysql

在使用 AJAX 时，我在 Codeigniter 中不断收到错误 500 的这个特定查询。它出什么问题了？

```
foreach($admins as $val){
    $admin_id = $val['admin_id'];

    foreach($messages_ids as $v){
        $id = (int)$v['msg_id'];

        $this->db->query('
            INSERT INTO sol_message_folder VALUES (?, ?, ?, ?)',
            array(1, $id, 'inbound', $admin_id));
    }
} 
```

如果我注释掉这个查询，我的 AJAX 运行良好。我错过了什么吗？

# vb.net - 如何删除在表单上绘制的线条

> ID：16004299
> 
> 赞同：1
> 
> 时间：2013-04-14T21:03:14.647
> 
> 标签：vb.net, visual-studio-2008

我正在尝试绘制这样的三角形：

```
Dim triangle As Graphics
    Dim pen1 As New Pen(Color.LimeGreen, 2)
    Dim lside As Integer
    Dim wside As Integer
    Dim dside As Integer

triangle = Me.CreateGraphics()
triangle.DrawLine(pen1, wside, 420, 640, 420)
triangle.DrawLine(pen1, 640, lside, 640, 420)
triangle.DrawLine(pen1, dside, 420, 640, lside) 
```

`lside`,`wside`分别`dside`代表长边、宽边和对角边。

我有 4 个文本框，长度、宽度、对角边和角度。目的是填写其中的 2 个值，然后按照毕达哥拉斯定理绘制一个矩形三角形。稍后我也想为 Angle 画一条线。但我首先想让这个工作。

但是每次我单击按钮绘制一个新三角形时，前一个应该被删除。这就是问题所在。

我尝试了多种方法，例如 triangle.Dispose triangle.Restore triangle.Clear 等等。它们都不起作用。

为什么我不把它们画在你可能会问的图片框中。好吧，当我在图片框中画一条线时，图片框有点在线条的前面，使线条不可见。我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:15:16.517

尝试使用 Me.Invalidate()，它基本上会清除，然后在您正在绘画的区域中绘制形状。[参考](http://msdn.microsoft.com/en-us/library/aa334877%28v=vs.71%29.aspx)。

```
Private Sub ClearCanvas_Click(sender As Object, e As EventArgs) Handles Button1.Click
       Me.Invalidate()
End Sub

Priavte DrawTriangle_Click(sender As Object, e As EventArgs) Handles Button1.Click
       Dim triangle As Graphics
       Dim pen1 As New Pen(Color.LimeGreen, 2)
       Dim lside As Integer
       Dim wside As Integer
       Dim dside As Integer
       triangle = Me.CreateGraphics()
       triangle.DrawLine(pen1, wside, 420, 640, 420)
       triangle.DrawLine(pen1, 640, lside, 640, 420)
       triangle.DrawLine(pen1, dside, 420, 640, lside)
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-18T09:52:06.020

```
‘Draw select delete multiple lines on Picturebox

Imports System
Imports System.Drawing

Imports System.Drawing.Drawing2D

Public Class Form1

    Dim drawrec, undo_delete As Boolean

    Dim index_arrary_line_tobe_deleted(10000) As Integer
    Dim ptA, ptB As Point                     ' starting and ending point
    Dim down As Boolean
    Dim k, Last_index_line_tobe_selected As Integer
    Private temp As line
    Dim List_of_line_tobe_deleted As New List(Of line)
    Dim List_of_line_to_Undo As New List(Of line)

    Private m_Lines As New List(Of line)
    Private m_Pt As Point
    Private m_Pt2 As Point
    Private m_tracking As Boolean
    Private Sub B2_index_arrary_line_tobe_deletedete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles B2_Delete.Click

        Try

            m_Lines.RemoveAll(AddressOf List_of_line_tobe_deleted.Contains)

        Catch ex As Exception

        End Try

        PictureBox1.Refresh()
    End Sub
    Private Sub B3_Undodelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles B3_Undodelete.Click

        undo_delete = True

        Try
            m_Lines.AddRange(List_of_line_tobe_deleted)
        Catch ex As Exception

        End Try
        PictureBox1.Refresh()

    End Sub
    Private Sub B1_Select_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles B1_Select.Click

        drawrec = True

    End Sub

    Private Sub PictureBox1_Paint(ByVal sender As Object, ByVal e As PaintEventArgs) Handles PictureBox1.Paint

        Dim r As New Rectangle(m_Pt, New Size(m_Pt2.X - m_Pt.X, m_Pt2.Y - m_Pt.Y))

        If m_tracking = True And drawrec = True Then

            k = -1
            For i As Integer = 0 To m_Lines.Count - 1
                If m_Lines(i).ContainsCompletely(r) = True Then
                    k = k + 1

                    index_arrary_line_tobe_deleted(i) = k
                    Debug.Print("Index of NOT selected lines  " + i.ToString + "Index of selected lines  " + Last_index_line_tobe_selected.ToString)  'to compare idex of two lists !!!!
                    index_arrary_line_tobe_deleted(k) = i
                    List_of_line_tobe_deleted.Add(m_Lines(i))
                End If

            Next
            Last_index_line_tobe_selected = k 'so far no use, just to know
            e.Graphics.DrawRectangle(Pens.Cyan, r)
        End If

        If undo_delete = False Then
            For i As Integer = 0 To m_Lines.Count - 1
                Me.m_Lines(i).Draw(e.Graphics, r)
                Debug.Print("Index of remaining lines  " + i.ToString)
            Next
        End If
        If undo_delete = True Then
            For i As Integer = 0 To m_Lines.Count - 1
                Me.m_Lines(i).Re_Draw(e.Graphics)
                Debug.Print("Index of remaining lines  " + i.ToString)
            Next
        End If

    End Sub

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load

        drawrec = False
        down = False
        undo_delete = False
        For i As Integer = 0 To index_arrary_line_tobe_deleted.Length - 1
            index_arrary_line_tobe_deleted(0) = -1
        Next i
        k = -1
        Last_index_line_tobe_selected = -1
    End Sub

    Private Sub PictureBox1_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseDown
        down = True

        If down = True And drawrec = False Then

            ptA = e.Location
            temp = New line
            temp.StartPoint = e.Location

        End If

        If e.Button = MouseButtons.Left Then
            ResetSelected(Me.m_Lines)
            m_Pt = e.Location
        End If
    End Sub

    Private Sub ResetSelected(ByVal m_Lines As List(Of line))
        For i As Integer = 0 To m_Lines.Count - 1
            m_Lines(i).Selected = False
        Next
    End Sub

    Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseMove
        If down = True Then

        End If

        If e.Button = MouseButtons.Left Then

            If down = True And drawrec = False Then
                ptB = e.Location
                temp.EndPoint = e.Location
            End If

            m_Pt2 = e.Location
            m_tracking = True
            Me.PictureBox1.Invalidate()
        End If
    End Sub

    Private Sub PictureBox1_MouseUp(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseUp
        down = False

        If drawrec = False Then

            temp.EndPoint = e.Location

            m_Lines.Add(temp)
            temp = Nothing
            Me.PictureBox1.Invalidate()

        End If

        m_tracking = False
        Me.PictureBox1.Invalidate()
    End Sub

End Class

Public Class line

    Public StartPoint As Point
    Public EndPoint As Point

    Private m_selected As Boolean
    Public Property Selected() As Boolean
        Get
            Return m_selected
        End Get
        Set(ByVal value As Boolean)
            m_selected = value
        End Set
    End Property

    Public Sub Draw(ByVal g As Graphics, ByVal r As Rectangle)
        Dim myPen1 As New Pen(Color.Red, 1)
        g.SmoothingMode = SmoothingMode.AntiAlias
        If Me.ContainsCompletely(r) OrElse Me.Selected Then
            Me.Selected = True
            g.DrawLine(myPen1, Me.StartPoint, Me.EndPoint)
        Else
            Dim myPen2 As New Pen(Color.Blue, 1)
            g.DrawLine(myPen2, Me.StartPoint, Me.EndPoint)
        End If

    End Sub
    Public Sub Re_Draw(ByVal g As Graphics)
        g.SmoothingMode = SmoothingMode.AntiAlias
        Dim myPen2 As New Pen(Color.Blue, 1)
        g.DrawLine(myPen2, Me.StartPoint, Me.EndPoint)
    End Sub

    Public Function ContainsCompletely(ByVal r As Rectangle) As Boolean

        If r.Contains(Me.StartPoint) AndAlso r.Contains(Me.EndPoint) Then
            Return True
        End If

        Return False
    End Function
End Class 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-07-16T09:55:49.910

```
Imports System
Imports System.Drawing
Imports System.Drawing.Drawing2D

Public Class Form1

Dim drawrec As Boolean

Dim del As Integer
Dim ptA, ptB As Point                     ' starting and ending point
Dim down As Boolean
Private temp As line

Private m_Lines As New List(Of line)
Private m_rnd As New Random
Private m_Pt As Point
Private m_Pt2 As Point
Private m_tracking As Boolean
Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Bt_Delete.Click
    Try
        m_Lines.RemoveAt(del)

    Catch ex As Exception

    End Try
    PictureBox1.Refresh()
End Sub
Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load

    drawrec = False
    down = False
    del = -1

End Sub

Private Sub PictureBox1_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseDown
    down = True

    If down = True And drawrec = False Then

        ptA = e.Location
        temp = New line
        temp.StartPoint = e.Location

    End If

    If e.Button = MouseButtons.Left Then
        ResetSelected(Me.m_Lines)
        m_Pt = e.Location
    End If
End Sub

Private Sub ResetSelected(ByVal m_Lines As List(Of line))
    For i As Integer = 0 To m_Lines.Count - 1
        m_Lines(i).Selected = False
    Next
End Sub

Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseMove
    If down = True Then

    End If

    If e.Button = MouseButtons.Left Then

        If down = True And drawrec = False Then
            ptB = e.Location
            temp.EndPoint = e.Location
        End If

        m_Pt2 = e.Location
        m_tracking = True
        Me.PictureBox1.Invalidate()
    End If
End Sub

Private Sub PictureBox1_MouseUp(ByVal sender As Object, ByVal e As MouseEventArgs) Handles PictureBox1.MouseUp
    down = False

    If drawrec = False Then

        temp.EndPoint = e.Location

        m_Lines.Add(temp)
        temp = Nothing
        Me.PictureBox1.Invalidate()

    End If

    m_tracking = False
    Me.PictureBox1.Invalidate()
End Sub

Private Sub PictureBox1_Paint(ByVal sender As Object, ByVal e As PaintEventArgs) Handles PictureBox1.Paint

    Dim r As New Rectangle(m_Pt, New Size(m_Pt2.X - m_Pt.X, m_Pt2.Y - m_Pt.Y))

    If m_tracking And drawrec = True Then
        For i As Integer = 0 To m_Lines.Count - 1
            If m_Lines(i).ContainsCompletely(r) = True Then
                Debug.Print("KKKKKKKKKKKKKKK  " + i.ToString)
                del = i
            End If

        Next
        e.Graphics.DrawRectangle(Pens.Cyan, r)
    End If

    For i As Integer = 0 To m_Lines.Count - 1

        Me.m_Lines(i).Draw(e.Graphics, r)

    Next

End Sub

Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Bt_Select.Click
    drawrec = True
End Sub

End Class

Public Class line

Public StartPoint As Point
Public EndPoint As Point
Public Filled As Boolean
Public ShapeColor As Color
Public PenWidth As Integer

Private m_selected As Boolean
Public Property Selected() As Boolean
    Get
        Return m_selected
    End Get
    Set(ByVal value As Boolean)
        m_selected = value
    End Set
End Property

Public Sub Draw(ByVal g As Graphics, ByVal r As Rectangle)
    g.SmoothingMode = SmoothingMode.AntiAlias
    If Me.ContainsCompletely(r) OrElse Me.Selected Then
        Me.Selected = True
        g.DrawLine(Pens.Red, Me.StartPoint, Me.EndPoint)
    Else

        g.DrawLine(Pens.Blue, Me.StartPoint, Me.EndPoint)
    End If

End Sub

Public Function ContainsCompletely(ByVal r As Rectangle) As Boolean

    If r.Contains(Me.StartPoint) AndAlso r.Contains(Me.EndPoint) Then
        Return True
    End If

    Return False
End Function
End Class 
```

# constructor - 如何删除 C++/CLI 类的默认构造函数？

> ID：16004304
> 
> 赞同：1
> 
> 时间：2013-04-14T21:03:50.620
> 
> 标签：constructor, c++-cli, destructor

我有一组 C++/CLI 类，我作为原生 C++ 类的包装器编写。对于 C++/CLI 类：我将构造函数声明放在类声明的私有部分中并且没有实现它们，但是这在我有一个未实现的构造函数的每种情况下都会导致链接器错误。

在 C++/CLI 中删除默认构造函数的适当方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T21:49:56.443

这适用于本机 C++，因为它使用链接器。如果没有人要求，这对缺少成员实现感到满意。但这在托管代码中不起作用，它不使用链接器。您的类定义被复制到程序集元数据中，并且绑定在运行时动态发生。

这要求所有声明的成员都有一个表示，否则元数据将不完整并且不受支持，因为这会破坏反射。即使是私人会员。没有什么特别难解决的，`{}`对于私有构造函数来说是一个非常好的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:23:31.217

> 我将构造函数和析构函数声明放在类声明的私有部分中**并且没有实现它们**，但是在我有一个未实现的构造函数或析构函数的每种情况下都会导致链接器错误。

仅仅因为您将构造函数设为私有并不意味着您不再需要实现它们。你还在叫它；你必须实施它。

# java - 结果集元数据不返回第一行

> ID：16004306
> 
> 赞同：2
> 
> 时间：2013-04-14T21:04:00.747
> 
> 标签：java, sql, jdbc, metadata

此代码返回除第一行之外的每一行。我看不出有什么问题？我怎样才能让它包括第一个？

```
stmt = con.createStatement();  

ResultSet res=stmt.executeQuery("SELECT * FROM Orders ORDER BY OrderID");

if (res.next())
{
    ResultSetMetaData rsmd=res.getMetaData();
    int columnCount=rsmd.getColumnCount();
    for (int i = 1; i<= columnCount; i++) {
        columnHeading=columnHeading+"\t"+rsmd.getColumnName(i); 
    }
    System.out.println(columnHeading);
    while(res.next()) {
        for (int i= 1; i<= columnCount; i++) {                            
            System.out.print("\t"+res.getString(i));
        }
    System.out.println("\n");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:08:15.377

You're calling `res.next()` twice - once here:

```
if (res.next()) 
```

and once here:

```
while (res.next()) 
```

Between the `if` statement and the `while` statement, you're "looking at" the first row - but by the time you get into the `while` loop body, you're already on the second row.

The simplest fix would probably be to change:

```
while (res.next())
{
} 
```

To:

```
do
{
} while (res.next()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:09:06.870

`ResultSet`当你打电话时，你正在移动`if(res.next)`。

这意味着当你进入你的循环时，你已经在下一排了。

将循环更改为 do-while

```
do {

} while (res.next()); 
```

这将在第一次循环调用*之前*`next`运行代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:09:38.790

`res.next()`将自动移动结果集。您首先在`if`语句中调用它，然后在`while`打印任何行之前再次在语句中调用它，并且在打印任何内容之前调用它两次，您错过了第一行。

将 更改`while`为 a `do..while`，这应该如您所愿。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T15:06:23.497

尝试这个。我希望它会奏效。

```
stmt = con.createStatement();  

ResultSet res=stmt.executeQuery("SELECT * FROM Orders ORDER BY OrderID");

if (res != null)
{
ResultSetMetaData rsmd=res.getMetaData();
int columnCount=rsmd.getColumnCount();
for (int i = 1; i<= columnCount; i++) {
    columnHeading=columnHeading+"\t"+rsmd.getColumnName(i); 
}
System.out.println(columnHeading);
while(res.next()) {
    for (int i= 1; i<= columnCount; i++) {                            
        System.out.print("\t"+res.getString(i));
    }
 System.out.println("\n");
 }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-04-23T02:41:57.280

这里的问题是 ResultSet 的索引不是从 0 开始的。因此，如果您没有全局声明 ResultSet，那么您必须按以下方式编写：ResultSet res = null; 否则它将起作用。

# configuration - Configuring BGP Neighbors In Quagga

> ID：16004312
> 
> 赞同：0
> 
> 时间：2013-04-14T21:04:27.440
> 
> 标签：configuration, bgp, quagga

I am trying to run Quagga on a couple of connected VMs and am confused about how to write the neighbor command in the bgpd.conf configuration file. All my queries are about the following specific statement of neighbor specification:

neighbor peer remote-as asn

What should I provide for the 'peer' IP value? Say I am configuring a VM A which is many hops away from a neighbor B (lets assume same AS number). So when I add neighbor B in the bgpd.conf configuration file, which particular interface IP of B should be added as the peer IP in the configuration file.

I am seeing that for some interface IPs the connection is not getting established and for some it is. So I want to know theoretically which of the interface IPs should be specified.

I did a lot of Google study but no ones clear about this. Please help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-22T10:39:42.707

您是否能够 ping 那些无法建立 bgp 会话的 IP 地址/接口？如果没有，那么你就无法成立。

# c# - 使用正则表达式从字符串中删除标点和空格

> ID：16004314
> 
> 赞同：4
> 
> 时间：2013-04-14T21:04:36.993
> 
> 标签：c#, regex, string, encryption

我正在尝试删除要使用 Playfair Cipher 加密的字符串中的所有标点符号和空格。我不明白为什么这条线不起作用。

```
s = Regex.Replace(s, @"[^\w\s]", string.Empty); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T21:06:53.930

The `[^\w\s]` means remove anything that's not a word or whitespace character.

Try this instead:

```
s = Regex.Replace(s, @"[^\w]", string.Empty); 
```

You could also use:

```
s = Regex.Replace(s, @"\W", string.Empty); 
```

Of course that will leave underscores as those are considered word characters. To remove those as well, try this:

```
s = Regex.Replace(s, @"[\W_]", string.Empty); 
```

Or this:

```
s = Regex.Replace(s, @"\W|_", string.Empty); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T21:10:17.463

使用 Linq 代替 Regex 怎么样？

```
string str = "abc; .d";
var newstr = String.Join("", str.Where(char.IsLetterOrDigit)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T21:09:33.007

`^`字符意味着不是。我用`[^A-Za-z0-9-]`连字符代替所有不是字母数字的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T21:13:00.367

你最好的选择可能是使用`[^A-Za-z]`contains `\w`，`_`我`0-9`猜你不想保留它。

以下正则表达式将删除任何 not`a-z`或`A-Z`.

```
s = Regex.Replace(s, @"[^A-Za-z]", string.Empty); 
```

# loops - For loop run time

> ID：16004321
> 
> 赞同：1
> 
> 时间：2013-04-14T21:05:42.583
> 
> 标签：loops, for-loop, integer

I was having trouble understanding the following concepts of how processor speed affects how long a certain loop runs for.

For a computer with a 3GHz processor, and can do 64-bit arithmetic per cycle, for how long will the following loop run?

long long int x; for(x = 0 x<=0; x--){}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:14:37.453

编译器可能会完全优化此循环，因为它可能检测到从未使用过任何结果。

但是如果实际编译了循环，则对速度上限的猜测可能是每次迭代两个周期。是的，处理器可能是超分频器，所以它有时可以在一个周期内执行多条指令，但另一方面，一条指令是一个分支，这往往会破坏管道。

因此，如果我们猜测两个循环，那么运行该循环将需要大约一个世纪。

```
irb> 2**63/(3*10**9)/60/60/24/7/52 # => 97 years 
```

我很想说这个循环永远不会结束，因为这比服务器、UPS 设备和电网的 MTBF 长得多，但也许你可以在 VM 中运行它并定期检查它。:-)

当然，当经验证据可用时，还有一个关于愚蠢猜测的希腊寓言。为什么不运行循环一小段时间，然后计算 2 ^(63)次迭代的实际结果？推测很困难，因为除了设计师之外，很少有人真正了解当今复杂的微架构。还有很多实际问题：编译器是否可以展开循环？也许您应该将其写在汇编中，以便您可以测量特定的东西？

# python - 无法使用 python mechanize 自动登录（必须“激活”特定浏览器）

> ID：16004322
> 
> 赞同：2
> 
> 时间：2013-04-14T21:05:44.537
> 
> 标签：python, forms, authentication, login, mechanize

我似乎很难登录需要浏览器身份验证的网站。发生的情况是，当您第一次登录时，网站会将您重定向到一个页面，上面写着“我们已向您的电子邮件发送了一封电子邮件，请单击链接以验证此浏览器。”

我正在为 python 使用 mechanize 模块。该页面会登录，但该网站永远不会识别“浏览器”，因此会有很多“请注册此浏览器”电子邮件！我尝试按照其他示例提供自定义标头以及添加 cookie 处理程序......不走运。每次我访问时，该网站都认为该脚本是一个新的（未经授权的）浏览器。

初始化代码如下所示：

```
 self.br = mechanize.Browser( factory=mechanize.RobustFactory() )
    self.br.add_handler(PrettifyHandler())

    cj = cookielib.LWPCookieJar()
    self.br.set_cookiejar(cj)

    self.br.addheaders = [('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'),
                          ('User-agent', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko) Ubuntu Chromium/24.0.1312.56 Chrome/24.0.1312.56 Safari/537.17'),
                          ('Referer', 'https://www.temp.com/logout'),
                          ('Accept-Encoding', 'gzip,deflate,sdch'),
                          ('Accept-Language', 'en-GB,en-US;q=0.8,en;q=0.6'),
                          ('Accept-Charset', 'ISO-8859-1,utf-8;q=0.7,*;q=0.3'),
                          ] 
```

我的登录代码如下所示。它填写一个简单的 html 表单并提交。

```
 self.br.open('https://www.temp.com/login')

    # Select the first (index zero) form
    self.br.select_form(nr=0)

    # User credentials
    self.br.form['username'] = 'temp'
    self.br.form['password'] = 'temp'

    # Login
    self.br.submit()

    # Inventory
    body = self.br.response().read().split('\n') 
```

然而，每次我收到这封电子邮件：“要激活您的浏览器，请单击以下链接......”即使在我点击链接并激活/验证浏览器之后也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:22:55.963

如果要保存会话，请尝试使用[保存/加载](http://docs.python.org/2/library/cookielib.html#cookielib.FileCookieJar.save)功能保存 cookie。例子：

```
cj = cookielib.LWPCookieJar()
cj.save('cookies.txt', ignore_discard=False, ignore_expires=False)
...
cj.load('cookies.txt', ignore_discard=False, ignore_expires=False) 
```

# android - android custom view - section with header for grouping elements, best approach

> ID：16004327
> 
> 赞同：0
> 
> 时间：2013-04-14T21:06:16.620
> 
> 标签：android, view, android-linearlayout

I need to group views in sections on activities and describe sections by headers, so I created custom view like below:

```
public class Section extends LinearLayout {
    public Section(Context context) {
        this(context, null);
    }

    public Section(Context context, AttributeSet attrs) {
        super(context, attrs);
        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.Section, 0, 0);
        String title = a.getString(R.styleable.Section_textHeader);
        a.recycle();
        setOrientation(LinearLayout.VERTICAL);
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        inflater.inflate(R.layout.section_header, this, true);
        TextView titleTextView = (TextView) getChildAt(0);
        titleTextView.setText(title);
    }
} 
```

and I use this view like below:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:custom="http://schemas.android.com/apk/res/eu.szwiec"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="8dip" >

    <eu.szwiec.Section
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        custom:textHeader="Sample Header" >

        <Button
            android:id="@+id/button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left|center_vertical"
            android:text="go to second activity" />
    </eu.szwiec.Section>

</LinearLayout> 
```

This solution works, but in my opinion there are 2 things to improve:

1.  LinearLayout in LinearLayout isn't optimal
2.  I have to always declare in Section android:layout_width and android:layout_height

Have You ideas for better solution of this problem? or above approach is the best?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:25:28.660

1）您不需要外部LinearLayout。只需在 xml 中的 Section 上声明填充并记住也放在`xmlns:android="http://schemas.android.com/apk/res/android"`那里。

2）您需要声明宽度和高度。我相信您可以使用样式，但我认为它不适合 layout_xxx 属性。

# java - 如何结合 Lucene SpanQueries 来匹配一些分隔符 Token 之间的内容？

> ID：16004331
> 
> 赞同：0
> 
> 时间：2013-04-14T21:06:32.023
> 
> 标签：java, lucene, full-text-search, match

也许这是一个简单的问题，但我不知道如何处理这种情况。

我想在 Lucene 索引中搜索文档，其中我的文档有一个名为的存储字段`content`，其文本以这种方式标记：

```
DELIMITER_TOKEN
TOKEN_1                |
TOKEN_2                |  <- this is the first "block"
...                    |     (bounded by some delimiter tokens)
TOKEN_N                |
DELIMITER_TOKEN
TOKEN_1                |
TOKEN_2                |  <- another block...
...                    |
DELIMITER_TOKEN
...                    |  <- and so on... 
```

我想搜索包含例如`TOKEN_1`,`TOKEN_3`和`TOKEN_8`, 但在同一`DELIMITER_TOKEN`对之间的文档。

我的第一个想法是，我可以`SpanNearQuery`为搜索词创建一个带有大斜率的词，然后我可以创建一个`SpanNotQuery`我可以用来从上一个查询的匹配项中排除重叠的 DELIMITER_TOKENs，这样我就不会得到像这样的匹配项

```
DELIMITER_TOKEN
TOKEN_1
TOKEN_3
DELIMITER_TOKEN
TOKEN_8 
```

我想这个解决方案应该有效。

但有时我必须处理更复杂的情况，例如搜索

```
TOKEN_1 TOKEN_2 TOKEN_8 DELIMITER_TOKEN TOKEN_3 DELIMITER_TOKEN 
```

...这意味着我想在包含（除其他外）TOKEN_1、TOKEN_2 和 TOKEN_8 令牌的文档中找到一个“块”，并且它旁边有一个包含 TOKEN_3（除其他外）的块。

我的想法是在简单的情况下使用 SpanNotQueries，并像这样创建一个 SpanNearQuery：

```
new SpanNearQuery(new SpanQuery[] {
        queryForFirstBlock,
        queryForDelimiter,
        queryForSecondBlock}
        0,
        true); 
```

但我认为这行不通，因为对第一个块的查询不一定跨越整个块。我想我将不得不在最后一个 Near Query 中引入一些 slop 来处理这些情况。但是如果我选择引入大于 0 的 slop，那么它将允许这样的匹配：

```
DELIMITER_TOKEN    
TOKEN_1            |                     |
TOKEN_2            | first near query    |        
TOKEN_8            |                     |
DELIMITER_TOKEN                          |   the top query
TOKEN_X                                  |
DELIMITER_TOKEN    | delitimer           |
TOKEN_3            | second near query   | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:49:32.897

最后发现这不是一个好主意。如果有人想在 Lucene 中做这样的事情，我认为这是错误搜索设计的标志。

但是我找到了解决方案......（如果有人感兴趣）

这个想法是，您不仅要存储一个分隔符标记，而且要存储其中的两个。（每个块有两个不同的分隔符：例如`DELIMITER1`和`DELIMITER2`）

然后你必须在你的 SpanNearQuery 中包含第一个分隔符（这会有很大的倾斜），但你必须`DELIMITER2`从这些结果中排除（使用 SpanNotQuery）。

现在您只需要构造一个带有 slop 0 的 SpanNearQuery，即可将其“粘合”`DELIMITER1`到前一个查询。就这样。:)

但我认为如果有人不得不破解这样的东西，那么是时候重新审视实际的搜索逻辑了（我最终得出结论，也许 Lucene 不是最好的选择）。

# wordpress - Accessing a subfolder of a Wordpress site

> ID：16004339
> 
> 赞同：2
> 
> 时间：2013-04-14T21:07:12.340
> 
> 标签：wordpress, .htaccess, mod-rewrite

So I have a wordpress website installed in the root of my domain and it is up and running fine. I want to install a shopping cart in a subfolder but it's giving me trouble. I have a folder called "magento". In that folder is a filed called downloader.php and index.php.

When I try to access the file, Wordpress was giving me a 404 error like it was thinking I meant it to look for a WP article. I tried a different .htaccess file which changed it to a standard 500 error now.

I've googled for this and found tons of people with the same problem, but haven't found a solution that works. I also checked the permissions and the folder is 777 and I changed the files to 777 as well but it still doesn't work.

The .htaccess file in the root (public_html) file simply shows

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /wp/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /wp/index.php [L]
</IfModule>

# END WordPress 
```

I don't know anything about configuring .htaccess files but if anyone has any suggestions on how I can get this to work, that'd be great.

Thanks!!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T22:21:07.697

`magento`您可以在子目录中安装一个空的 .htaccess 文件。这[会覆盖](http://httpd.apache.org/docs/current/howto/htaccess.html#how)Wordpress .htaccess 文件并允许访问该目录中的文件。

永远不要将文件权限更改为`777`. 这是危险的，因为它允许*任何人*修改您的文件。

# java - Java - 可重入锁，无法访问新创建的条件

> ID：16004340
> 
> 赞同：0
> 
> 时间：2013-04-14T21:07:16.480
> 
> 标签：java, concurrency, locking, conditional-statements, reentrantlock

我创建了一个新条件`chopstickFree`，在我的`pickUpChopstick()`方法中，我正在等待锁定它，但我根本无法访问它。

通过调试我发现当它到达方法中的`chopstickFree.await()`行时`pickUpChopstick()`，它只是无限期地暂停

我不明白？构造函数中的代码只是一个不确定的尝试让它工作，但无论哪种方式，我都创建了一个新条件，向所有人发出信号，它是免费的，但我根本无法锁定它？

```
public class Chopstick {
    Lock lock = new ReentrantLock();

    private Condition chopstickFree = lock.newCondition();
    private Condition chopstickInUse = lock.newCondition();

    Chopstick() {
        lock.lock();
        chopstickFree.signalAll();
        lock.unlock();
    }

    // Pick up chopstick
    public void pickUpChopstick() throws InterruptedException {
        lock.lock();

        try {
            chopstickFree.await(); // ALWAYS PAUSES HERE INDEFINITELY
            chopstickInUse.signalAll();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }

    // Release chopstick
    public void releaseChopstick() {
        lock.lock();
        chopstickFree.signal();
        lock.unlock();
    }
} 
```

有任何想法吗？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:27:01.110

[`Condition#signalAll()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html#signalAll%28%29)仅向当前[`Condition#await()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html#await%28%29)（或其朋友）中的线程发出信号，即信号不会排队等待以后的调用。

您需要另一个受锁保护的标志才能正确实现：

```
public class Chopstick {
  private final Lock lock = new ReentrantLock();
  private final Condition chopstickFree = lock.newCondition();
  private volatile boolean isFree = true;

  Chopstick() { /* Nothing */ }

  // Pick up chopstick
  public void pickUpChopstick() throws InterruptedException {
    lock.lock();

    try {
      while (!isFree) {
        chopstickFree.await();
      }
      isFree = false;
    } finally {
      lock.unlock();
    }
  }

  // Release chopstick
  public void releaseChopstick() {
    lock.lock();
    try {
      isFree = true;
      chopstickFree.signal();
    } finally {
      lock.unlock();
    }
  }
} 
```

* * *

这是一个使用 a 的版本[`Semaphore`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Semaphore.html)，它的意图可能与您的原始实现更接近：

```
public class Chopstick {
  private final Semaphore chopsticksAvailable = new Semaphore(1);

  Chopstick() {
    // Nothing
  }

  // Pick up chopstick
  public void pickUpChopstick() throws InterruptedException {
    chopsticksAvailable.acquire();
  }

  // Release chopstick
  public void releaseChopstick() {
    chopsticksAvailable.release();
  }
} 
```

# php - Allow user to delete profile information

> ID：16004346
> 
> 赞同：0
> 
> 时间：2013-04-14T21:08:33.023
> 
> 标签：php, mysql, delete-row

I'm trying to create a form that displays current service information for a user on their profile and then allows them to select a check box for one or more services they provide and then hit a delete button to remove the service(s) related to the check box. Each service has a unique ID and so I'm assuming I need to use this so that the query knows what to delete.

Here is relevant code and the form I am using:

```
<?php

if (isset($_POST['OddJobName']) && isset($_POST['Description']) && isset($_POST['DaysAvailable']) && empty($errors) === true){//if (empty($_POST) === false && empty($errors) === true) { //if (isset(empty($_POST['OddJobName'])) && isset(empty($_POST['Description'])) && isset(empty($_POST['DaysAvailable'])) === false && empty($errors) === true)
            $daysavailable='';
            foreach ($_POST['DaysAvailable'] as $value)
            {

            $daysavailable .=$value." ";
            }

            $Delete_Oddjob = array (
                'MemberID'      => $MemberID,
                'OddJobID'      => $_POST['OddJobID'],
                'OddJobName'    => $_POST['OddJobName'],
                'Description'   => $_POST['Description'],
                'DaysAvailable' => $daysavailable, 

                );
                Delete_Oddjob ($Delete_Oddjob);
                if(success){
                 header('Location: member.php?username='.$username);
                 exit ();
                }
            } else if (empty($errors) === false){
                //otherwise output errors
                echo output_errors($errors);
            }

?>

<?php
                $result = mysql_query("SELECT * FROM `oddjob` WHERE `MemberID` = $MemberID");

                while($row = mysql_fetch_assoc($result))
                {

                echo"<table width='100%' border='1' cellspacing='0' cellpadding='5'>
                <td width='50%'>
                <table width='100%' cellspacing='17' cellpadding='0'>
                <form action='' method ='post' enctype='multipart/form-data'>
                    <tr>
                        <td>
                        <input type='hidden' name='MemberID' id='MemberID' value= ". $MemberID ."> 
                        </td>
                    </tr>
                    <tr>
                        <td>
                        <input type='hidden' name='OddJobID' id='OddJobID' value= ". $row['OddJobID'] ."> 
                        </td>
                    </tr>
                    <tr>
                        <td width='35%'>
                        <p>Name of OddJob*:</p>
                        </td>
                        <td>
                        <input type='text' name='OddJobID' style='width:180px' value= ". $row['OddJobID'].">
                        </td>
                    </tr>
                    <tr>
                        <td width='35%'>
                        <p>Name of OddJob*:</p>
                        </td>
                        <td>
                        <input type='text' name='OddJobName' style='width:180px' value= ". $row['OddJobName'].">
                        </td>
                    </tr>
                    <tr>
                        <td>
                        <p>Description*:</p>
                        </td>
                        <td>
                        <div class='expandingArea'>
                        <pre><span></span><br></pre>
                        <textarea name='Description'>". $row['Description'] ."</textarea>
                        </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        <p>Days Available(current week)*:</p>
                        <p>(hold Ctrl to select multiple)</p>
                        </td>
                        <td>
                        <select name='DaysAvailable[]' size='5' multiple='multiple' id='DaysAvailable[]'>
                        <option value='Monday'>Monday</option>
                        <option value='Tuesday'>Tuesday</option>
                        <option value='Wednesday'>Wednesday</option>
                        <option value='Thursday'>Thursday</option>
                        <option value='Friday'>Friday</option>
                        <option value='Saturday'>Saturday</option>
                        <option value='Sunday'>Sunday</option>
                        </select>
                        </td>
                </td>
                    <tr>
                        <td>
                        <input type='checkbox' name='Delete' value= ". $row['OddJobID'] .">
                        </td>
                    </tr>
                </table>
                </table>
                </table>
                <input type='submit' name='Delete' value='Delete'>
                </form> ";
                }
?> 
```

Function:

```
function Delete_Oddjob ($Delete_Oddjob){
            //global $Add_Oddjob;
             array_walk($Delete_Oddjob, 'array_sanitize');
             mysql_query("DELETE FROM `oddjob` WHERE `OddJobID` = '".$_POST['OddJobID']."'") or die (mysql_error());
} 
```

I don't understand how to make this work. At the moment when I select a check box and click the delete button the page seems to refresh but nothing else happens. Also If i try to echo out the query nothing is displayed.

```
echo "DELETE FROM `oddjob` WHERE `OddJobID` = '".$_POST['OddJobID']."'"; 
```

Any help would be great. Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T10:21:45.297

你在那里几乎有解决方案。

将您的删除复选框重命名为 name="delete[]" 允许以一个名称发布多个复选框，然后在 PHP 方面，您可以通过以下方式访问这些复选框：

```
if (isset($_POST['delete'])) {
    foreach($_POST['delete'] as $oddjob) {
        if (Delete_Oddjob($oddjob)) {
            // success
        } else {
            // failure
        }
    }
} 
```

每当提交表单并选择删除选项时，这将遍历表单上所有选中的复选框并使用它们的 ID 删除它们。

# php - PHP使用页面名称作为变量

> ID：16004354
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:09:27.570
> 
> 标签：php

我想做的是说有人来到我的网站并去

`www.site.com/users/james`

该页面`/james`将不存在，因此我想使用该名称`james`并使用它来显示基于该用户名的个人资料页面，即`james`在搜索中用于从我的数据库中提取信息。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:13:06.510

**.htaccess**

```
RewriteEngine on
RewriteRule ^/users/(.+?) /users.php?name=$1 
```

**用户.php**

```
<?php
if ($_GET['name']) {
    $query = mysql_query("SELECT * FROM `users` WHERE `name`='".mysql_real_escape_string($_GET['name'])."'");
    if (mysql_num_rows($query)>0) {
         $user = mysql_fetch_assoc($query);
         print_r($user);
    }
} 
```

# mysql - 缓慢的简单 UPDATE 查询

> ID：16004357
> 
> 赞同：2
> 
> 时间：2013-04-14T21:10:06.010
> 
> 标签：mysql, sql, performance, innodb

我对mysql的奇怪行为有疑问。在大约 3000 行的表的 where 子句中只有主键的简单更新查询有时需要 2 秒以上。根据命令，它卡在具有高 Context_vulner 值（200+）的“查询结束”阶段`SHOW PROFILE ALL`。

在大多数情况下，它是连接中的第一个查询。

示例查询：

```
UPDATE `users`
set last_portal_login = NOW()
    , ip = 1464635301
    , browser = "chrome"
where uid = 2021 
```

创建表查询：

```
`CREATE TABLE `users` (
  `uid` int(10) unsigned NOT NULL,
  `login` char(50) COLLATE utf8_polish_ci NOT NULL,
  `hide_me` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `addon` int(10) unsigned NOT NULL DEFAULT '0',
  `protocol` float unsigned NOT NULL DEFAULT '0',
  `mode` enum('firefox','lite','chrome','opera') COLLATE utf8_polish_ci DEFAULT NULL,
  `browser` enum('firefox','chrome','opera','ie','safari') COLLATE utf8_polish_ci DEFAULT NULL,
  `last_login` datetime DEFAULT NULL,
  `last_portal_login` datetime DEFAULT NULL,
  `ip` int(10) unsigned DEFAULT NULL,
  PRIMARY KEY (`uid`),
  UNIQUE KEY `login` (`login`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_polish_ci$$`
```

`这是 InnoDB 配置：`

```
``'innodb_adaptive_flushing', 'ON'
'innodb_adaptive_hash_index', 'ON'
'innodb_additional_mem_pool_size', '8388608'
'innodb_autoextend_increment', '8'
'innodb_autoinc_lock_mode', '1'
'innodb_buffer_pool_instances', '1'
'innodb_buffer_pool_size', '268435456'
'innodb_change_buffering', 'all'
'innodb_checksums', 'ON'
'innodb_commit_concurrency', '0'
'innodb_concurrency_tickets', '500'
'innodb_data_file_path', 'ibdata1:10M:autoextend'
'innodb_data_home_dir', ''
'innodb_doublewrite', 'ON'
'innodb_fast_shutdown', '1'
'innodb_file_format', 'Antelope'
'innodb_file_format_check', 'ON'
'innodb_file_format_max', 'Antelope'
'innodb_file_per_table', 'OFF'
'innodb_flush_log_at_trx_commit', '2'
'innodb_flush_method', 'O_DIRECT'
'innodb_force_load_corrupted', 'OFF'
'innodb_force_recovery', '0'
'innodb_io_capacity', '200'
'innodb_large_prefix', 'OFF'
'innodb_lock_wait_timeout', '50'
'innodb_locks_unsafe_for_binlog', 'OFF'
'innodb_log_buffer_size', '8388608'
'innodb_log_file_size', '67108864'
'innodb_log_files_in_group', '2'
'innodb_log_group_home_dir', './'
'innodb_max_dirty_pages_pct', '75'
'innodb_max_purge_lag', '0'
'innodb_mirrored_log_groups', '1'
'innodb_old_blocks_pct', '37'
'innodb_old_blocks_time', '0'
'innodb_open_files', '300'
'innodb_print_all_deadlocks', 'OFF'
'innodb_purge_batch_size', '20'
'innodb_purge_threads', '0'
'innodb_random_read_ahead', 'OFF'
'innodb_read_ahead_threshold', '56'
'innodb_read_io_threads', '4'
'innodb_replication_delay', '0'
'innodb_rollback_on_timeout', 'OFF'
'innodb_rollback_segments', '128'
'innodb_spin_wait_delay', '6'
'innodb_stats_method', 'nulls_equal'
'innodb_stats_on_metadata', 'ON'
'innodb_stats_sample_pages', '8'
'innodb_strict_mode', 'OFF'
'innodb_support_xa', 'ON'
'innodb_sync_spin_loops', '30'
'innodb_table_locks', 'ON'
'innodb_thread_concurrency', '0'
'innodb_thread_sleep_delay', '10000'
'innodb_use_native_aio', 'ON'
'innodb_use_sys_malloc', 'ON'
'innodb_version', '5.5.30'
'innodb_write_io_threads', '4'``
```

``Mysql 版本：来自 dotdeb.org 的 5.5.30，连接基于 unix socket。``

 ``我应该怎么做才能解决这个问题？``

# php - 使用 php 从 URL 创建 png 图像

> ID：16004358
> 
> 赞同：0
> 
> 时间：2013-04-14T21:10:10.463
> 
> 标签：php, png

如何从图像 URL 创建具有给定宽度和高度的 PNG 图像。我正在尝试使用此代码。但得到一张无效的图片：

```
$img_r = imagecreatefrompng($src);
$dst_r = ImageCreateTrueColor( $targ_w, $targ_h );
imagecopyresampled($dst_r,$img_r,0,0,$_POST['x'],$_POST['y'],$targ_w,$targ_h,$_POST['w'],$_POST['h']);
header('Content-type: image/png');
@imagepng($dst_r, url_to_save, $jpeg_quality); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:17:15.630

首先，我会从 url (file_get_contents/curl/etc) 获取文件，然后将其写入磁盘并找出它是否是图像，什么类型等，然后，我会减少我的努力并使用图像处理库，例如[http:/ /phpthumb.gxdlabs.com/](http://phpthumb.gxdlabs.com/)调整图像大小并根据需要保存。

# html - 标记化功能在 XSLT 中不起作用

> ID：16004363
> 
> 赞同：0
> 
> 时间：2013-04-14T21:10:55.327
> 
> 标签：html, xslt

我正在尝试在 XSLT 中使用 tokenize 函数，但它不起作用

```
<xsl:variable name="stringList" select="tokenize('XPath,is,fun', ',')"/>
<xsl:for-each select="$stringList">
    <xsl:value-of select="." />
</xsl:for-each> 
```

这有什么问题吗？我在 eclipse 和[w3schools 教程编辑器中都试过了](http://www.w3schools.com/XSL/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog)

实际代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:rg="http://www....."
    xmlns="http://wwww.w3.org/1999/xhtml" >
    <xsl:template match="/">
        <html>
            <head>
                <title>Temp</title>
            </head>
            <body>
                <xsl:variable name="stringList" select="tokenize('XPath,is,fun', ',')" />
                <xsl:for-each select="$stringList">
                    <xsl:value-of select="." /><br/>
                </xsl:for-each>
            </body>
        </html>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:41:08.277

Tokenize 实际上是一个 XSLT 2.0 函数，因此您需要使用支持 XSLT 1.0 的 XSLT 处理器。W3Schools 的编辑器只有 XSLT 1.0。

[我以http://xslttest.appspot.com/](http://xslttest.appspot.com/)为例尝试了您的 XSLT ，它运行良好。

# loops - 简单的 Haskell 循环

> ID：16004365
> 
> 赞同：46
> 
> 时间：2013-04-14T21:11:02.890
> 
> 标签：loops, haskell, io

我刚开始学习 Haskell，但是现在没有循环是非常令人沮丧的。我想出了如何为函数编写循环。但是，我的问题是我想在迭代循环时输出一些结果。看来我必须使用调试来执行这个简单的任务。

所以现在我只是欣赏一个如何在主结构中打印出一个字符串 10 次的例子。

换句话说，我想这样做 10 次：

```
main = do  
    putStrLn "a string" 
```

谢谢。我觉得这对我的任务很有启发性。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-04-14T21:14:46.420

您可以定义一个递归函数，打印 n 次“字符串”（n 是函数的参数），如下所示：

```
printStringNTimes 0 = return ()
printStringNTimes n =
 do
  putStrLn "a string"
  printStringNTimes (n-1)

main = printStringNTimes 10 
```

一种更通用的方法是定义一个将任何 IO 操作重复 n 次的函数：

```
repeatNTimes 0 _ = return ()
repeatNTimes n action =
 do
  action
  repeatNTimes (n-1) action

main = repeatNTimes 10 (putStrLn "a string") 
```

上面的函数已经存在于`Control.Monad`name 下`replicateM_`。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-04-14T21:13:38.433

当你刚开始时，Haskell 的 IO 有点棘手，因为它是基于 monads 的。

您的问题虽然有一个简单的解决方案：

```
main = replicateM_ 10 $ putStrLn "a string" 
```

这是使用来自的组合`replicateM_`器`Control.Monad`

它有很多有用的函数来组合和执行一元动作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-10T15:24:32.527

我也是 Haskell 的初学者，我有一个不太优雅但实用的解决方案。

```
main = do 
    putStr result
    where
        string = "a string"
        result = concat [string ++ "\n" | i <- [1,2..10]] 
```

所以在这里，我们定义了一个列表，其中的元素是您要打印的字符串，后跟一个换行符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-10T23:57:18.177

我认为执行 for 循环的最迫切的形式是：

```
for list action = mapM_ action list

main :: IO Int
main = do
    for [0..10] (\ i -> do

        print(i^2)
        )
    return 0 
```

对我来说，这实际上看起来很像 C 代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-18T12:59:26.440

做这样的事情可以让你循环一个特定的函数，使它更可重用（而不是为你想要循环的每个新事物写出来）。

```
loop :: Int -> (IO()) -> IO()
loop 0 _ = return ()
loop n f =
 do
  f
  loop (n - 1) f 
```

例子：

```
main = do
 loop 5 (do
  putStr "hello "
  putStrLn "there") 
```

```
main = do
 loop 3 (do
  loop 4 (putStrLn "Hi")
  putStrLn ""
  ) 
```

# c# - C# KeyPress 事件不会将文本框中的最后一个字符复制到表单的文本属性

> ID：16004368
> 
> 赞同：2
> 
> 时间：2013-04-14T21:11:22.437
> 
> 标签：c#, string, copy, keypress

情况：表单有一个文本框，用户必须在其中输入一些文本。此文本框有一个 KeyPress 事件，其中 Form 的 text 属性更改为用户在每次击键时键入的文本。

这是文本框的 KeyPress 事件的代码：

```
 private void tbGameTitle_KeyPress(object sender, KeyPressEventArgs e)
        {
            this.Text = textBox1.Text;
        } 
```

问题：用户输入的最后一个字符没有被复制到表单的文本中。例子：

```
textBox1.Text = "The War of 1812"
Form2.Text = "The War of 181" 
```

textBox1.Text 中“1812 年战争”结尾处的“2”不会被复制到 Form2.Text。

如何让整个文本字符串从 textBox1.Text 复制到 Form2.Text？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T21:17:40.880

尝试使用[`TextChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.textchanged.aspx)事件而不是`KeyPress`. 使用后者时您还为时过早，因为在`Text`处理按键后属性会更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:21:10.813

那是因为[`KeyPress`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress.aspx)在角色实际“进入”之前被解雇`textBox1`。如果你边看边打字，你会注意到`Form2`后面总是有一个字符`textBox1`。您将希望改用该[`TextChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.textchanged.aspx)事件，该事件*在*每次更改`textBox1`.

# forms - 如何在 Symfony2 中正确使用 Forms、FOS Rest Bundle 和多对多关系

> ID：16004370
> 
> 赞同：5
> 
> 时间：2013-04-14T21:11:45.863
> 
> 标签：forms, symfony, backbone.js, fosrestbundle

我正在使用 Symfony2 Forms 和 FOSRestBundle。

我正在尝试将具有多对多关系的实体保存在数据库中。

我创建了一个带有集合字段（[http://symfony.com/doc/master/cookbook/form/form_collections.html](http://symfony.com/doc/master/cookbook/form/form_collections.html)）的表单，如下所示：

```
class MainType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('name');
        $builder->add('description');

        $builder->add('others', 'collection', array(
            'type' => new OtherType()
        ));
    }

    public function getName()
    {
        return '';
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Acme\SearchBundle\Entity\Main',
            'csrf_protection' => false
        ));
    }
}

class OtherType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('id');
    }

    public function getName()
    {
        return '';
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Acme\SearchBundle\Entity\Other',
            'csrf_protection' => false
        ));
    }
} 
```

“其他”类型的对象集合存储在数据库中。而且我不想存储更多该类型的对象，只读取并将它们与主对象相关联。

当我处理表单时，我使用此功能：

```
private function processForm(Main $main, $new = false)
{

    $new = true;

    $statusCode = $new ? 201 : 204;

    $form = $this->createForm(new MainType(), $main);
    $form->bind($this->getRequest());

    if ($form->isValid()) {

        $mainValidated = $form->getData();

        // I should store the collection of objects of type other
        // in the database

        $em = $this->getDoctrine()->getEntityManager();
        $em->persist($mainValidated);
        $em->flush();

        return $this->view($new ? $mainValidated : null, $statusCode);
    }

    return $this->view($form, 400);
} 
```

我从客户端 Backbone.js 发送的代码 json 是：

```
{"others":[{"id":1}, {"id":2}]} 
```

实体：

*   主要的

xml:

```
 <entity name="Acme\SearchBundle\Entity\Main" table="main">
    <id name="id type="integer" column="id">
      <generator strategy="IDENTITY"/>
    </id>
    <field name="name" type="integer" column="name" nullable="true"/>
    <field name="description" type="integer" column="description" nullable="true"/>

    <many-to-many field="others" target-entity="Other" inversed-by="mains">
      <cascade>
         <cascade-persist/>
      </cascade>
      <join-table name="main_has_other">
        <join-columns>
          <join-column name="main" referenced-column-name="id"/>
        </join-columns>
        <inverse-join-columns>
          <join-column name="other" referenced-column-name="id"/>
        </inverse-join-columns>
      </join-table>
    </many-to-many>

  </entity> 
```

实体：

```
<?php

namespace Acme\SearchBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

use JMS\Serializer\Annotation\Type;

use JMS\Serializer\Annotation\Groups;
use JMS\Serializer\Annotation\Expose;

class Main
{   
    /**
     * @Type("integer")
     * @Groups({"admin"})
     * 
     * @var integer
     * 
     */
    private $id;

    /**
     * 
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $name;

    /**
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $description;

    /**
     * @Type("ArrayCollection<Acme\SearchBundle\Entity\Other>")
     * @Groups({"manage"})
     * 
     * @var \Doctrine\Common\Collections\Collection
     */
    private $others;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->others = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Main
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Main
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Add others
     *
     * @param \Acme\SearchBundle\Entity\Other $other
     * @return Main
     */
    public function addOthers(\Acme\SearchBundle\Entity\Other $other)
    {
        $this->others[] = $other;

        return $this;
    }

    /**
     * Remove others
     *
     * @param \Acme\SearchBundle\Entity\Other $other
     */
    public function removeOthers(\Acme\SearchBundle\Entity\Other $other)
    {
        $this->others->removeElement($other);
    }

    /**
     * Get others
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getOthers()
    {
        return $this->others;
    }
} 
```

*   其他

xml:

```
<entity name="Acme\SearchBundle\Entity\Other" table="other">
  <id name="id" type="integer" column="id">
    <generator strategy="IDENTITY"/>
  </id>
  <field name="name" type="string" column="name" length="255" nullable="true"/>
  <field name="description" type="string" column="name" length="255" nullable="true"/>
  <many-to-many field="mains" target-entity="Main" mapped-by="others">
    <cascade>
        <cascade-persist/>
    </cascade>
  </many-to-many>
</entity> 
```

实体：

```
<?php

namespace Acme\SearchBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

use JMS\Serializer\Annotation\Type;
use JMS\Serializer\Annotation\Groups;

class Other
{

   /**
     * @Type("integer")
     * @Groups({"manage"})
     * 
     * @var integer
     */
    private $id;

    /**
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $name;

    /**
     * @Type("string")
     * @Groups({"manage"})
     * 
     * @var string
     */
    private $description;

    /**
     * @Type("Acme\SearchBundle\Entity\Main")
     * @Groups({"admin"})
     * 
     * @var \Doctrine\Common\Collections\Collection
     */
    private $mains;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->mains = new \Doctrine\Common\Collections\ArrayCollection();
    }        

    /**
     * Set name
     *
     * @param string $name
     * @return Other
     */
    public function setName($name)
    {
        $this->name = $name
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Other
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set id
     *
     * @param integer $id
     * @return Other
     */
    public function setId($id)
    {
        $this->id = $id;

        return $this;
    }

    /**
     * Add main
     *
     * @param \Acme\SearchBundle\Entity\Main $main
     * @return Other
     */
    public function addMains(\Acme\SearchBundle\Entity\Main $main)
    {
        $this->mains[] = $main;

        return $this;
    }

    /**
     * Remove main
     *
     * @param \Acme\SearchBundle\Entity\Main $main
     */
    public function removeMains(\AcmeSearchBundle\Entity\Main $main)
    {
        $this->mains->removeElement($main);
    }

    /**
     * Get mains
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getMains()
    {
        return $this->mains;
    }
} 
```

当我将“main”类型的对象持久保存在数据库中时，集合不会保存在多对多关系的表中。持久化“主要”对象时，我必须手动保存集合。

我正在寻找一种尽可能简单地自动保存对象集合的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-29T12:00:04.643

我有一个类似的问题，我认为您只需要配置表单以期望您的收藏中有额外的项目。

```
'allow_add' => true 
```

这样，“此表单不应包含额外字段”错误将不会上升，因为表单将期待这些额外字段。所以，代码应该是

```
 $builder->add('others', 'collection', array(
        'type' => new OtherType(),
        'allow_add' => true
    )); 
```

# symfony - 没有 mappedBy 的 Doctrine2 OneToMany

> ID：16004371
> 
> 赞同：6
> 
> 时间：2013-04-14T21:11:51.237
> 
> 标签：symfony, doctrine

我有一个实体 'listing' 与 OneToMany 到实体 'view'，它们之间的键是 view.content_id ，它包含列表的 ID，但是，它也与其他实体有关，所以通过添加

```
/**
 * @var Listing
 *
 * @ORM\ManyToOne(targetEntity="\Acme\Bundle\Entity\Listing", inversedBy="views")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="content_id", referencedColumnName="id")
 * })
 */
private $listing; 
```

对于视图，它会刹车，因为在保存视图实体时 content_id 变为空。

我该如何解决？

上市方关系：

```
/**
 * @var views
 *
 * @ORM\OneToMany(targetEntity="\Acme\Bundle\Entity\View", mappedBy="listing")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="id", referencedColumnName="content_id")
 * })
 */
private $views; 
```

我通过加入 Listing.views 并添加 WITH content_type = :ContentType 来进行查询，它可以区分一些“视图”结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-02T19:24:10.350

我参加聚会很晚，但我想我会回答，以防它帮助别人。

由于您在两个实体之间建立了关系，您现在必须将一个*对象*分配给该属性，而不是 FK 值本身。像这样：

```
$listing = $em->getRepository('Acme\Bundle\Entity\Listing')
              ->find($content_id);
$view->setListing($listing); 
```

并不是：

```
$view->setListing($content_id); 
```

当然，如果结果是别的东西，我很想知道。

:^)

# javascript - 将此传递给 jQuery 插件

> ID：16004372
> 
> 赞同：1
> 
> 时间：2013-04-14T21:12:01.193
> 
> 标签：javascript, jquery, oop, jquery-plugins

我在我的网站上使用来自[http://code.drewwilson.com/entry/autosuggest-jquery-plugin](http://code.drewwilson.com/entry/autosuggest-jquery-plugin)的 autoSuggest 插件来搜索各种不同的项目。这个插件的一个主要功能是，当添加选择时，会调用一个回调函数，我检查这是添加的新数据还是从 Web 服务获取的数据，然后更新一些变量（我用于提交）

到现在为止，我一直在没有任何想法地使用它，但现在我决定采用 OOP 方式并创建一个 JS 对象来包装这个插件和其他相关函数（常见回调）和配置值（url）等。

在类中，我有不同的数据变量，这些变量将随着选择的添加和删除而更新。在代码进行到一半时，我意识到回调只接受一个参数并且没有办法（对我来说很明显）我可以将这些变量或对象的上下文传递给这些回调

以下是我到目前为止编写的代码：

```
var coSuggest = function(options) {
this.selector = options.selector;
this.options = options;
//this.that = this;
//this.submitURL = options.submitURL;

//if y=type is not defined , default type will be people

if ( typeof (options.type) === 'undefined') {
    this.type = 'people';
} else {
    this.type = options.type;
}

// if as_options are not defined, as_options will be a empty object
//console.log(typeof(options.as_options));

if ( typeof (options.as_options) === 'undefined') {
    this.as_options = {};
} else {
    this.as_options = options.as_options;
}

this.valuesField = $('#as-values-' + this.as_options.asHtmlID);

//the initData field will be an array of object containing {id,value} of prefilled items initially
//the addData field will be an array of object containing {id,value} of new selected items from the suggestions
//the newData field will be an array of strings [values] containing the new values added
//the removeData field will be an array of objects containing {id,value} of the items from data to be removed
if ( typeof (options.initData) !== 'undefined') {
    this.initData = options.initData;
    this.as_options.preFill = this.initData;

}
this.as_options.selectionAdded = this.selectionAdded;

// callback function to be added in as_options as selectionAdded
this.as_options.selectionRemoved = function(elem) {
    console.log(elem);
}
//return this

};

//urlConf for searching the items sitewide
coSuggest.prototype.urlConf = {
people : 'abc',
interest : "index.php/profile/getInterestsSkillsTags",
skill : 'xyz',
teacher : 'xyz',
designation : 'xyz',
city : 'xyz',
subject : 'xyz',

};

 // callback function to be added in as_options as selectionAdded
 coSuggest.prototype.selectionAdded = function(elem) {
//console.log($(this).find('.as-values'));
console.log(elem);
}

//bind function to bind the autoSuggest plugin with the selector provided

coSuggest.prototype.bind = function(options) {  
//console.log(as_options);
$(this.selector).autoSuggest(base_url + this.urlConf[this.type], this.as_options);
} 
```

我怎样才能做到这一点而不会失去代码的可重用性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T08:33:53.690

我正在回答这个问题，因为我认为我已经通过扩展代码解决了这个问题。我在 selectionAdded 回调中添加了一个新参数，并在调用时在该函数中提供了函数引用。

# javascript - 在垂直列中动态创建 HTML 表单

> ID：16004374
> 
> 赞同：1
> 
> 时间：2013-04-14T21:12:09.520
> 
> 标签：javascript, forms, google-maps, html

所以我有这段代码将创建一个新的表单输入字段，它位于一个 javascript 方法中，该方法在谷歌地图窗口中的每次鼠标点击时触发。现在它在一行上创建每个表单，我如何让每个新表单显示在前一个表单下方？

谢谢你的帮助！

JavaScript：

```
//Creates new input boxes for each new marker
var newForm = "Checkpoint " + markerId + " Name:<input type='text' id=" + markerId + " />";
document.getElementById("divForms").innerHTML = document.getElementById("divForms").innerHTML + newForm; 
```

HTML：

```
<form id="divForms"></form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:25:27.787

您是否尝试将换行标记添加`<br />`到末尾`newform`：

```
var newForm = "Checkpoint " + markerId + " Name:<input type='text' id=" + markerId + " /><br />"; 
```

或者在分配时`innerHTML`：

```
document.getElementById("divForms").innerHTML = document.getElementById("divForms").innerHTML + '<br />' + newForm; 
```

# signalr - SignalR：如何从服务器调用 .Net 客户端方法？

> ID：16004375
> 
> 赞同：5
> 
> 时间：2013-04-14T21:12:13.547
> 
> 标签：signalr, signalr-hub, signalr.client

我想将数据发送到我的控制台应用程序，该应用程序与我的“someHub”有连接。我尝试按照[链接](https://gist.github.com/davidfowl/1324342)中的示例中所述进行操作，但没有得到任何结果。服务器端代码：

```
[HubName("somehub")]
public class SomeHub : Hub
{
    public override Task OnConnected()
    {
        //Here I want to send "hello" on my sonsole application
        Clients.Caller.sendSomeData("hello");

        return base.OnConnected();
    }
} 
```

客户端代码：

```
public class Provider
{
    protected HubConnection Connection;
    private IHubProxy _someHub;

    public Provider()
    {
        Connection = new HubConnection("http://localhost:4702/");
        _someHub = Connection.CreateHubProxy("somehub");
        Init();
    }

    private void Init()
    {
        _someHub.On<string>("sendSomeData", s =>
        {
            //This code is not reachable
            Console.WriteLine("Some data from server({0})", s);
        });

        Connection.Start().Wait();
    }
} 
```

实现这一点的最佳解决方案是什么，我无法调用客户端方法的原因是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-15T14:09:11.200

您是否正在尝试与 Hub 之外的客户交谈？如果是，那么您将必须在 Hub 之外获取 HubContext。然后你可以和所有的客户交谈。

```
IHubContext context = GlobalHost.ConnectionManager.GetHubContext<MyHub>(); 
```

**SignalR 服务器使用 Owin 自主机**

```
class Program
    {
        static void Main(string[] args)
        {
            string url = "http://localhost:8081/";

            using (WebApplication.Start<Startup>(url))
            {
                Console.WriteLine("Server running on {0}", url);
                Console.ReadLine();
                IHubContext context = GlobalHost.ConnectionManager.GetHubContext<MyHub>();
                for (int i = 0; i < 100; i++)
                {
                    System.Threading.Thread.Sleep(3000);
                    context.Clients.All.addMessage("Current integer value : " + i.ToString());
                }
                Console.ReadLine();
            }

        }
    }
    class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            // Turn cross domain on 
            var config = new HubConfiguration { EnableCrossDomain = true };
            config.EnableJavaScriptProxies = true;

            // This will map out to http://localhost:8081/signalr by default
            app.MapHubs(config);
        }
    }
    [HubName("MyHub")]
    public class MyHub : Hub
    {
        public void Chatter(string message)
        {
            Clients.All.addMessage(message);
        }
    } 
```

**Signalr 客户端控制台应用程序使用 Signalr 集线器。**

```
class Program
    {
        static void Main(string[] args)
        {  
            var connection = new HubConnection("http://localhost:8081/");

            var myHub = connection.CreateHubProxy("MyHub");

            connection.Start().Wait();
            // Static type
            myHub.On<string>("addMessage", myString =>
            {
                Console.WriteLine("This is client getting messages from server :{0}", myString);
            });

            myHub.Invoke("Chatter",System.DateTime.Now.ToString()).Wait();

            Console.Read();
        }
    } 
```

要运行此代码，请创建两个单独的应用程序，然后首先运行服务器应用程序，然后运行客户端控制台应用程序，然后只需在服务器控制台上按键，它将开始向客户端发送消息。

# ruby-on-rails-3 - Rails 如何在 gem 中创建初始化程序

> ID：16004378
> 
> 赞同：9
> 
> 时间：2013-04-14T21:12:30.150
> 
> 标签：ruby-on-rails-3, gem, initializer

我正在尝试在 Rails 3 中构建一个 gem，并在其中尝试传递一个初始化程序：

```
Credentials.configure do |config|
  file = File.read("#{Rails.root}/config/twitter.yaml")
  file_config = YAML.load(file)

  config.consumer_key = file_config[Rails.env][:consumer_key]
  config.consumer_secret = file_config[Rails.env][:consumer_secret]
  config.callback_url = URI.escape(file_config[Rails.env][:callback_url])
  config.time_stamp = Time.now.to_i
end 
```

然后我试图这样称呼它：

```
Credentials.time_stamp 
```

但我收到此错误：

```
uninitialized constant Twitter::Credentials 
```

问题是什么？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-15T00:50:49.120

您的 gem 首先需要在 lib/generators/your_gem_name_generator.rb 中定义一个生成器

```
mkdir -p lib/generators/ 
```

将您的初始化程序复制到该文件夹​​中，名称如下`twitter_credentials.rb`

然后在该文件夹中创建另一个文件，其名称类似于`twitter_generator.rb`以下内容：

```
class YourGemNameRailtie < Rails::Generators::Base
  source_root(File.expand_path(File.dirname(__FILE__)))
  def copy_initializer
    copy_file 'twitter_credentials.rb', 'config/initializers/twitter_credentials.rb'
  end
end 
```

您应该在此处查看有关创建生成器的官方文档：http: [//guides.rubyonrails.org/generators.html](http://guides.rubyonrails.org/generators.html)

# objective-c - 从文件读取和写入

> ID：16004379
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:12:43.397
> 
> 标签：objective-c

我知道这似乎是一个被反复询问的问题，但我正在尝试验证设备上是否存在文件（位于支持文件文件夹中），其中文件的名称为“names.txt” .

根据我阅读的内容，下面的代码应该可以工作，但我不断收到“找不到文件”。

```
NSFileManager *filemgr = [NSFileManager defaultManager];
NSString *path = @"names.txt";

if ([filemgr fileExistsAtPath:path]) {

    NSLog (@"File exists");
}
else {
    NSLog (@"File not found");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:15:19.000

您需要文件的完整路径，而不仅仅是名称。

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES);
NSString *appSupportDirectory = paths[0];
NSString *path = @"names.txt";
NSString *fullPath = [appSupportDirectory stringByAppendingPathComponent:path];

NSFileManager *filemgr = [NSFileManager defaultManager];
if ([filemgr fileExistsAtPath:fullPath]) {

    NSLog (@"File exists");
}
else {
    NSLog (@"File not found");
} 
```

调整此代码以反映应用程序中文件的实际完整路径。

# android - 在 android 中通过 GSM 加密语音

> ID：16004381
> 
> 赞同：3
> 
> 时间：2013-04-14T21:12:56.207
> 
> 标签：android, encryption, voice

是否可以在应用程序级别或 Android OS 级别的 android 中通过 gsm 对语音呼叫执行加密和解密？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:28:03.157

检查这个问题：[https](https://stackoverflow.com/questions/15716097/how-to-implement-voice-changer-in-android-during-phone-call)
://stackoverflow.com/questions/15716097/how-to-implement-voice-changer-in-android-during-phone-call 可悲的是，我认为，如果没有生根/高级修改系统是不可能的.

# xcode4.6 - 十进制小键盘 Xcode

> ID：16004385
> 
> 赞同：1
> 
> 时间：2013-04-14T21:13:11.963
> 
> 标签：xcode4.6

我有一个文本框和一个计算按钮，我使用的是十进制键盘，当我在 Xcode 模拟器中运行我的程序时，我在左下角得到一个点，但是当我在我的 iPhone 中运行程序时，我得到一个逗号左下角。我知道模拟器是在美国语言环境中设置的，而我在冰岛，如果我使用逗号而不是点，我不会得到相同的结果。我需要在我的文本框中使用点，而不是逗号。有没有我可以使用的代码告诉我的程序使用点而不是逗号，或者我需要为此制作一个自定义键盘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-25T16:40:02.503

```
float s2 = [[dist.text stringByReplacingOccurrencesOfString:@"," withString:@"."] floatValue];

dist.text = [[NSString alloc] initWithFormat:@"%0.02f", s2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T21:16:44.747

不清楚你在追求什么。如果要更改键盘的外观，则必须编写自己的键盘。但是，如果通过在文本字段中放置一个点来响应逗号就足够了，那么您可以通过在文本字段的委托中截取逗号来轻松地做到这一点。实施`textField:shouldChangeCharactersInRange:replacementString:`。像这样的东西（未经测试，因此您可能需要对其进行一些调整）：

```
-(BOOL)textField:(UITextField *)textField
        shouldChangeCharactersInRange:(NSRange)range
        replacementString:(NSString *)string {
    if (![string isEqualToString: @","])
        return YES;
    textField.text =
        [textField.text stringByReplacingCharactersInRange:range
                                                withString: @"."];
    return NO;
} 
```

如果问题是逗号没问题，但在逗号是小数点的国家，你希望它用作小数点，只需在将字符串从文本字段中拉出并将其转换为时使用 NSNumberFormatter一个号码。现在你通过说 来做到这一点`[_PipeID.text floatValue]`。该调用没有关于语言环境的情报。NSNumberFormatter 会：

```
NSNumberFormatter* nf = [[NSNumberFormatter alloc] init];
nf.locale = [NSLocale currentLocale];
NSNumber* n = [nf numberFromString: tf.text];
// and *then* you can convert the NSNumber to a float with `floatValue`
NSLog(@"%f",n.floatValue); 
```

顺便说一句，你说：

> 当我在 Xcode 模拟器中运行我的程序时......但是当我在我的 iPhone 中运行程序时

但是你可以在模拟器上很好地测试它；只需使用设置应用程序设置语言和区域格式。

# jquery - 如何使用 jquery 获取复选框的 tabindex？

> ID：16004390
> 
> 赞同：0
> 
> 时间：2013-04-14T21:14:09.960
> 
> 标签：jquery

我已经看到很多关于为复选框设置 tabindex 的示例，但我无法找到获取当前选定复选框的 tabindex 或其在组中的位置的示例。我一直在尝试使下面的代码工作，但每个复选框的值都为 0。你能指点我一个例子或帮助我吗？谢谢。

```
 $.each($checkboxes, function () {

                 if ($(this).is(':checked')) {
                     var selectedIndex = $(this).attr('tabindex');
                      //do something with selectedIndex 
```

编辑

所以 jesh.tesh 我正在尝试在这一行中使用您的代码 var theCheckboxPosition = ($(this).prop("tabindex")); 但它忽略了 eq(theCheckboxPosition)。这是我应该开始发布的内容。

```
 var $checkboxes = $('input[type="checkbox"]');

         $(document).ready(function () {

             var nos = $('#listTable #searchString').length;

             // alert(nos);
             $.each($checkboxes, function (idx, data) {
                 if ($(this).is(':checked')) {

                     //  alert('checked');
                     var theCheckboxPosition = ($(this).prop("tabindex"));
                     $('#listTable .teacherlists').eq(theCheckboxPosition).css('border', '2px dashed blue');
                     $('#listTable .daylists').eq(theCheckboxPosition).css('border', '2px dashed blue');

                 }

             });

         });

        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:22:27.567

我想你会想要使用`prop`. 我有[一个工作 jsFiddle](http://jsfiddle.net/jesus_tesh/VJWhy/)。

这是小提琴中的内容：

**HTML**

```
<ul>
    <li><input type="checkbox" tabindex="1" /></li>
    <li><input type="checkbox" tabindex="2" /></li>
    <li><input type="checkbox" tabindex="3" /></li>
</ul>
<p>
    <button>Submit</button>
</p> 
```

**JS**

```
$(function () {
    $("button").on("click", function () {
        $.each($("input[type=checkbox]"), function (idx, data) {
            if ($(this).is(":checked")) {
               console.log($(this).prop("tabindex")); 
            }
        });
    });
}); 
```

**编辑**

再次阅读您的问题后，我看到您提出了 2 个不同的问题。你要求我提供了一个解决方案的 tabindex，你要求在一个组中的位置，另一个答案为你提供了。这些不是一回事。

我的猜测是你会想要上一个答案，因为你可能不使用 tabindex 属性（大多数人忽略了这些）。

# javascript - Skrollr 在 chrome 早期相对上下火

> ID：16004394
> 
> 赞同：0
> 
> 时间：2013-04-14T21:14:31.377
> 
> 标签：javascript, jquery, animation, scroll

我有几个相对定位的 div 堆叠在一起，高度为 100%，加载时使用 jQuery。每个相对定位的 div 内部都有一个固定的 div，用于保存内容。

当您向下滚动页面时，我正在使用 skrollr 为固定 div 设置动画顶部 -100%。我对 skrollr 的标记是这样`data-anchor-target="#home" data-top="top:0%;"data-top-bottom="top:-100%;"`的，所以当父幻灯片位于视口的顶部时，它位于顶部，而当父幻灯片的底部位于视口的顶部时，它是顶部 -100%。正确的？

第二个固定位置 div 比屏幕高度稍长，因此当父级位于视口顶部时，它不会使其顶部 -100% 成为相对位置。`data-100-top="position:fixed;" data-top='position:relative;'`

第三个 div 遵循与第一个相同的逻辑`data-anchor-target="#exhibitions" data-top="top:0%;"data-top-bottom="top:-100%;"`

这一切在 Firefox 和 IE 中都可以正常工作，但在 Chrome 和 Safari 中，第 3 个 div 过早地开始制作动画。当父 div 位于顶部时，固定内容已经离开屏幕一半，这让我感到困惑，因为 data-top 属性设置为 top:0;

这是示例 - [http://dev.touch-akl.com/standout/](http://dev.touch-akl.com/standout/)

链接到 Skrollr - [https://github.com/Prinzhorn/skrollr](https://github.com/Prinzhorn/skrollr)

HTML 示例

```
<section id="home" class="page">
    <div class="slide" data-anchor-target="#home" data-top="top:0%;"data-top-bottom="top:-100%;">
        <section class="content">
             CONTENT GOES HERE
        </section>
    </div>
</section>

<section id="about" class="page">
    <div class="slide" data-anchor-target="#about" data-100-top="position:fixed;" data-top='position:relative;'>
        <section class="content">
             CONTENT GOES HERE - THIS IS THE ONE THAT IS HIGHER THAN THE OTHERS
        </section>
    </div>
</section>

<section id="exhibitions" class="page">
    <div class="slide" data-anchor-target="#exhibitions" data-top="top:0%;"data-top-bottom="top:-100%;">
        <section class="content">
             CONTENT GOES HERE - THIS IS THE ONE THAT TRIGGERS EARLY
        </section>
    </div>
</section>

<section id="events" class="page">
    <div class="slide" data-anchor-target="#events" data-top="top:0%;"data-top-bottom="top:-100%;">
        <section class="content">
             CONTENT GOES HERE
        </section>
    </div>
</section> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T20:33:13.087

最后在 jQuery 中对此进行了修复，不知道之前的方式有什么问题，现在关于幻灯片的滚动距离的数据属性在 jQuery 中设置为像素而不是 HTML 中的固定百分比值

```
 // check for desktop
    if($('body').hasClass('skrollr')){

        var $page = $('.page'),
            $slide = $('.slide');

        $slide.css({'position':'fixed'});

        $page.each(function(){

            var $this = $(this),
                $thisSlide = $this.find('.slide'),
                newHeight = $thisSlide.outerHeight();

            // if the slide contents height is less than the window height
            if(newHeight < winHeight){

                // set the height of the page and slide to the window height
                $this.add($thisSlide).css({'height':winHeight});

            }else{

                // set the height of the page and slide to the contents height
                $this.add($thisSlide).css({'height':newHeight});

                if($this.is("#about")){

                    $thisSlide.attr('data-300-top-bottom', 'top:'+ -newHeight +'px');    

                }   // if this slide was the about slide

            }   // end if this slide is smaller than the window height

        }); // end each page function

         s.refresh();  

    }   // end if was desktop 
```

# symfony - Doctrine2 不更新 DateTime

> ID：16004406
> 
> 赞同：2
> 
> 时间：2013-04-14T21:15:37.100
> 
> 标签：symfony, doctrine-orm, symfony-2.1

我想我发现了一个我找不到解决方案的错误..

我尝试更新 datetime 字段，但不要更新它，不要给我一个错误。

移动所有其他字段正确修改它们，但日期时间字段没有。

```
$em = $this->getDoctrine()->getManager();
$entity = $em->getRepository('MyOwnBundle:Events')->find($id);
$In = $entity->getDateIn();
$In->modify('+1 day');
$entity->setDateIn($In);
$em->flush(); 
```

我还尝试直接插入一个 DateTime() 对象，但根本不更新！

```
$entity->setDateIn(new \DateTime()); 
```

这个问题有解决方案吗？

我安装了 symfony 2.1 和教义 2.3.3

**编辑** 事件实体：

```
/**
 * Events
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="My\OwnBundle\Entity\EventsRepository")
 */
 class Events
 {
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 * @var string
 *
 * @ORM\Column(name="name", type="string", length=100)
 */
private $name;

/**
 * @var string
 *
 * @ORM\Column(name="description", type="text")
 */
private $description;

/**
 * @var \DateTime
 *
 * @ORM\Column(name="dateIn", type="datetime")
 */
private $dateIn;

/**
 * @var \DateTime
 *
 * @ORM\Column(name="dateOut", type="datetime")
 */
private $dateOut;

....

/**
 * Set dateIn
 *
 * @param \DateTime $dateIn
 * @return Events
 */
public function setDateIn($dateIn)
{
    $this->dateIn = $dateIn;

    return $this;
}

/**
 * Get dateIn
 *
 * @return \DateTime 
 */
public function getDateIn()
{
    return $this->dateIn;
}

/**
 * Set dateOut
 *
 * @param \DateTime $dateOut
 * @return Events
 */
public function setDateOut($dateOut)
{
    $this->dateOut = $dateOut;

    return $this;
}

/**
 * Get dateOut
 *
 * @return \DateTime 
 */
public function getDateOut()
{
    return $this->dateOut;
}

.... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-25T20:10:50.793

modify() 方法不会更新实体，因为 Doctrine 通过引用跟踪 DateTime 对象。你需要克隆你现有的 DateTime 对象，给它一个新的引用。修改新的，然后设置为新的时间戳。

有关更多信息，请参阅[Doctrine 文档](http://doctrine-orm.readthedocs.org/en/latest/cookbook/working-with-datetime.html)中的文章。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T14:32:25.187

实体是正确的，但是您需要使用 $em->persist($entity) 来持久化您的实体，并且您不需要再次设置日期，因为日期时间是通过引用传递的

```
$em = $this->getDoctrine()->getManager();
$entity = $em->getRepository('MyOwnBundle:Events')->find($id);
$entity->getDateIn()->modify('+1 day');
$em->persist($entity);
$em->flush(); 
```

# python - Python 中的快速素数筛

> ID：16004407
> 
> 赞同：7
> 
> 时间：2013-04-14T21:15:48.423
> 
> 标签：python, algorithm, primes, sieve-of-eratosthenes

我一直在使用 Eratosthenes 的筛子在 python 中生成素数，人们吹捧为相对较快的选择的解决方案，例如 [关于在 python 中优化素数生成的问题的一些答案中的解决](https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python)方案并不简单，而且我在这里的简单实现在效率上与它们相媲美。我的实现如下

```
def sieve_for_primes_to(n):
    size = n//2
    sieve = [1]*size
    limit = int(n**0.5)
    for i in range(1,limit):
        if sieve[i]:
            val = 2*i+1
            tmp = ((size-1) - i)//val 
            sieve[i+val::val] = [0]*tmp
    return sieve

print [2] + [i*2+1 for i, v in enumerate(sieve_for_primes_to(10000000)) if v and i>0] 
```

定时执行返回

```
python -m timeit -n10 -s "import euler" "euler.sieve_for_primes_to(1000000)"
10 loops, best of 3: 19.5 msec per loop 
```

虽然上面链接问题的答案中描述的方法是python食谱中最快的方法，但下面给出

```
import itertools
def erat2( ):
    D = {  }
    yield 2
    for q in itertools.islice(itertools.count(3), 0, None, 2):
        p = D.pop(q, None)
        if p is None:
            D[q*q] = q
            yield q
        else:
            x = p + q
            while x in D or not (x&1):
                x += p
            D[x] = p

def get_primes_erat(n):
  return list(itertools.takewhile(lambda p: p<n, erat2())) 
```

运行时它给出

```
python -m timeit -n10 -s "import euler" "euler.get_primes_erat(1000000)"
10 loops, best of 3: 697 msec per loop 
```

我的问题是，为什么人们会从相对复杂的烹饪书中吹捧上述内容作为理想的素数发生器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-25T06:18:24.993

我以最快的方式将您的代码转换为适合@unutbu 的素数筛比较脚本，[以列出 N 以下的所有素数](https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python) ，如下所示：

```
def sieve_for_primes_to(n):
    size = n//2
    sieve = [1]*size
    limit = int(n**0.5)
    for i in range(1,limit):
        if sieve[i]:
            val = 2*i+1
            tmp = ((size-1) - i)//val 
            sieve[i+val::val] = [0]*tmp
    return [2] + [i*2+1 for i, v in enumerate(sieve) if v and i>0] 
```

在我的 MBPro i7 上，该脚本正在快速计算所有小于 1000000 的素数，但实际上比 rwh_primes2、rwh_primes1 (1.2)、rwh_primes (1.19) 和 primeSieveSeq (1.12) 慢 1.5 倍（页面末尾的@andreasbriese）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T00:37:13.073

您应该只使用该算法的[*“推迟”*变体](https://stackoverflow.com/a/10733621/849891)。比较您的代码[测试运行](http://ideone.com/5csqNu)上限为 10 和 2000 万，如

```
...
print(len( [2] + [i*2+1 for i, v in 
  enumerate(sieve_for_primes_to(10000000)) if v and i>0])) 
```

与另一个，以 664579 和 1270607 素数的相应数字[运行以产生，如](http://ideone.com/WFv4f)

```
...
print( list( islice( (p for p in postponed_sieve() ), n-1, n+1))) 
```

显示您的代码“仅”运行***3.1x...3.3x***倍。:)*不是* ***36***倍快，因为您的时间显示出于某种原因。

我认为没有人声称它是一个“理想的”主要生成器，只是说它是一个概念上干净和清晰的生成器。所有这些素数生成函数真的是玩具，真正的东西是处理非常大的数字，无论如何使用完全不同的算法。

在这个较低的范围内，重要的是算法的时间复杂度，它应该在`~ n^(1+a)`，`a < 0.1...0.2` [**经验增长顺序**](http://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth)左右，它们看起来确实如此。拥有一个具有`~ n^1.5`甚`~ n^2`至增长顺序的玩具发电机玩起来并不好玩。

# jsf - 在 JSF 页面上提交表单时如何调用方法？

> ID：16004410
> 
> 赞同：-3
> 
> 时间：2013-04-14T21:15:51.983
> 
> 标签：jsf, el

我基本上想做的是，当用户提交表单时，应该调用一个方法，而不是setter。

这是我尝试过的：

```
<h:form>
    <p>
        Your guess: <h:inputText value="#{quizBean.someMethod()}"/>
    </p>
    <p>
        <h:commandButton value="Submit answer"/>
    </p>
</h:form> 
```

它也不适用于**#{quizBean.someMethod}**。

如果我创建一个名为**someMethod**的字段并为其生成**getter 和 setter**，它将正常工作。

有没有办法做到这一点？

我的 web.xml：

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0"> 
```

我在 Tomcat 7.0 上运行它并使用**jsf-api:2.1.19**和**jsf-impl:2.1.19** jars。

这是我得到的例外：

```
javax.servlet.ServletException: /index.xhtml @23,71 value="#{quizBean.someMethod()}": Property 'someMethod' not found on type com.tugay.problems.QuizBean
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:606) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:32:30.160

不。

该`value`属性必须评估为一个`property`表达式（使用它的`get`方法）。此外，如果控件不是只读的，`set`还必须提供方法。

其他属性（例如`action`from 的属性`h:commandButton`）接受计算结果为 bean 中方法的表达式，但不是这个。

唯一的解决方法是你已经做过的，制作`get`工具`someMethod`. 请注意，我不确定在呈现 JSF 页面时是否会调用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T06:35:15.750

您想在表单提交上调用方法吗？这正是`h:commandButton`为此而生的。只需将`action`属性添加到命令按钮并将其指向如下操作方法：

```
<h:inputText value="#{quizBean.answer}"/>
<h:commandButton value="Submit answer" action="#{quizBean.submitAnswer}"/> 
```

bean 上的方法应如下所示：

```
public String submitAnswer() {
  // Do something with property answer
  return null;
} 
```

由于在存储输入组件的值之后调用操作方法，因此您可以毫无问题地访问它们。返回值由 JSF 用于导航。它可以包含视图 ID 或导航结果。如果返回值为 null，则 JSF 停留在同一页面上。

# c# - 当我从 sql server 2008 r2 检索图像时，图像是黑色的

> ID：16004411
> 
> 赞同：1
> 
> 时间：2013-04-14T21:16:07.063
> 
> 标签：c#, .net, sql-server, image-processing, sql-server-2008-r2

我写了一个程序，我在它上面上传和下载图像到/从数据库`SQL Server 2008 R2`。我使用以下代码上传图片：

```
SqlParameter picparameter = new SqlParameter();

            picparameter.SqlDbType = System.Data.SqlDbType.Image;

        picparameter.ParameterName = "value";

        picparameter.Value = val;//val is a byte array

        SqlCommand sqlcommand = new SqlCommand("update " + table + " set " + col + " = @value "+" where "+where, sqlconnection);
        sqlcommand.Parameters.Add(picparameter);
        sqlcommand.ExecuteNonQuery(); 
```

我使用以下代码将图像从`PictureBox`数组转换为：

```
 public static byte[] ImageToByteArray(System.Drawing.Image img)
    {
        System.IO.MemoryStream ms = new System.IO.MemoryStream();
        Bitmap b = new Bitmap(img);
        b.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
        return ms.ToArray();
    } 
```

然后我使用以下代码将图像从数据库下载到硬盘：

```
Byte[] data = new Byte[0];
data = (Byte[])(imageReader["image"]);
MemoryStream mem = new MemoryStream(data);
Image.FromStream(mem).Save(Application.StartupPath + "\\Temp\\img\\" +imageReader["code"].ToString() + ".png",
System.Drawing.Imaging.ImageFormat.Png); 
```

但是，我有一个很大的问题，图像从数据库保存到硬盘后背景变黑。

![这是我上传到数据库的图像](https://i.stack.imgur.com/lE6jk.png) ![这是我从数据库下载的图像](https://i.stack.imgur.com/2NVhv.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:21:36.893

您保存为 jpeg：

```
b.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg); 
```

但加载为png：

```
Image.FromStream(mem).Save(..., ImageFormat.Png); 
```

不是 100% 确定这是你的问题，但它看起来有问题。

# c# - 如何解决 EF：表的潜在运行时违规

> ID：16004413
> 
> 赞同：10
> 
> 时间：2013-04-14T21:16:23.533
> 
> 标签：c#, sql, asp.net-mvc, entity-framework

我在我的 Web 应用程序中使用 EF 4。

这是我的相关表格：

```
**AppToDomains_V1 **
GroupId   uniqueidentifier
AppGuid   uniqueidentifier

**Apps table**
AppName   nvarchar(50)  
AppGuid   uniqueidentifier  
ClientAppID   nvarchar(50)  
IsDeleted     bit   
CreatedDate   datetime  
UpdatedDate   datetime 
```

和我的 edmx：

[http://ge.tt/17n6R2e/v/0?c](http://ge.tt/17n6R2e/v/0?c)

我收到以下错误：

> 错误 2 错误 3002：从第 1565 行开始映射片段时出现问题：表 AppToDomains_V1 的键（AppToDomains_V1.AppId、AppToDomains_V1.Domain）的潜在运行时违规：列（AppToDomains_V1.AppId、AppToDomains_V1.Domain）映射到 EntitySet AppToDomains_V1 的属性（AppToDomains_V1\. AppId、AppToDomains_V1.Domain）在概念方面，但它们不构成 EntitySet 的关键属性（AppToDomains_V1.AppId、AppToDomains_V1.Domain、AppToDomains_V1.IsWhiteListed）。D:\MaM\Server\MamAdmin\Dev\Admin 1.7\MaMDBEntityFramework\MaMModel.edmx 1566 15 MaMDBEntityFramework

我该如何解决这个问题？

D:\MaM\Server\MamAdmin\Dev\Admin

> 1.7\MaMDBEntityFramework\MaMModel.edmx 1566 15 是：

```
 <EntitySetMapping Name="AppToDomains_V1">
        <EntityTypeMapping TypeName="MaMDBModel.AppToDomains_V1">
          <MappingFragment StoreEntitySet="AppToDomains_V1">
            <ScalarProperty Name="IsWhiteListed" ColumnName="IsWhiteListed" />
            <ScalarProperty Name="Domain" ColumnName="Domain" />
            <ScalarProperty Name="AppId" ColumnName="AppId" />
          </MappingFragment>
        </EntityTypeMapping>
      </EntitySetMapping> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2016-03-30T19:43:44.293

我知道这是很久以前的事了，但它仍然出现在搜索引擎上，所以这就是交易。

3002 错误表明模型和实际数据库在表的主键方面不匹配。例如，数据库可能只有一个 ID 字段作为主键，但在模型中它有两个或多个列标记为主键的一部分。当我遇到此错误时，模型已将所有非空外键字段标记为主键的一部分，这是不正确的。

要解决此问题，请进入模型，找到表，突出显示错误标记为主键一部分的每个字段，并将“实体键”属性更改为 false。重新编译，错误应该消失了。

这对我有用。

# php - 使用 cron 获取包含 jQuery 内容的视图？

> ID：16004420
> 
> 赞同：0
> 
> 时间：2013-04-14T21:16:56.557
> 
> 标签：php, jquery, drupal-7, cron

有没有办法可以设置一个 cron 在我的 Drupal 站点上运行视图？我有一个 jQuery 脚本，我想每小时运行一次。

我试过了;

```
php http://mysite/myview 
```

但我想我离题了。我明白了；

```
Could not open input file: 
```

这是我在我的 rss 提要中使用的 js；

```
// $Id
(function ($) {
Drupal.behaviors.tweetcast = {

attach: function (context, settings) {

$('div.tagspeak:not(.tags-processed)', context).addClass('tags-processed').each(function () {

var mynid, sinceid, updateinfo, sinceurl, author, tweethtml;
var currentsinceid = $('.currentsinceid').val();

var firstring = $(this).html();
var twostring = firstring.replace(/\s/g,'').replace(/^%20OR%20/gim,'').replace(/%20OR$/gim,'').replace(/%20OR%20%$/gim,'').replace(/%20OR%20$/gim,'').replace(/%$/gim,'').replace(/%20OR$/gim,'').toLowerCase();  
var threestring = twostring.replace(/%20or%20/gim,'%20OR%20');
$(this).text(threestring);
var fourstring = threestring.replace(/%20OR%20/gim,' ');
var fivestring = fourstring.replace(/%23/gim,'#');

$(this).closest('.views-row').append('<div class="views-field views-field-replies"></div>');    
tweethtml = $(this).closest('.views-row').find('div.views-field-replies').eq(0);

var twitter_api_url = 'http://search.twitter.com/search.json';
$.ajaxSetup({ cache: true });

$.getJSON( twitter_api_url + '?callback=?&rpp=1&q=' + threestring + '&since_id=' + currentsinceid, function(data) {
$.each(data.results, function(i, tweet) {console.log(tweet);

    if(tweet.text !== undefined) {

    var tweet_html = '<div class="tweetuser">' + tweet.from_user + '</div>';
    tweet_html  += ' <div class="sinceid">' + tweet.id + '</div>';
    tweethtml.append(tweet_html);

    }
});
});
    $.fn.delay = function(time, callback){
    jQuery.fx.step.delay = function(){};
    return this.animate({delay:1}, time, callback);
    }

    $(this).delay(2000, function(){
    title = $(this).closest('.views-row').find('div.views-field-title').eq(0).find('span.field-content').text();
    link = $(this).closest('.views-row').find('div.views-field-path').eq(0).find('span.field-content').text();
    author = $(this).closest('.views-row').find('div.tweetuser').eq(0).text();
    mynid = $(this).closest('.views-row').find('div.mynid').text();
    sinceid = $(this).closest('.views-row').find('div.sinceid').eq(0).text();
    updateinfo = {sinceid: sinceid, mynid: mynid, author: author, title: title, link: link, tags: fivestring};
    sinceurl = Drupal.settings.basePath + 'sinceid';

    $.ajax({
    type: "POST",
    url: sinceurl,
    data: updateinfo,
    success: function(){}
    });
    });
});
}}
})
(jQuery); 
```

这是 php 我的模块；

```
<?php
// $id:
function sinceid_menu() {
  $items = array();
  $items['sinceid'] = array(
  'title' => 'sinceid',
  'page callback' => 'sinceid_count',
  'description' => 'sinceid',
  'access arguments' => array('access content'),
  'type' => MENU_CALLBACK,
  );
return $items;
}
function sinceid_count() 
{
$sinceid=$_POST['sinceid'];
$mynid=$_POST['mynid'];
$author=$_POST['author'];
$title=$_POST['title'];
$link=$_POST['link'];
$tags=$_POST['tags'];

db_update('node')
->expression('sinceid', $sinceid)
->condition('nid', $mynid)
->execute();

$sql = db_query("SELECT author FROM {authordupe} WHERE author = $author");
$result = db_query($sql);
$how_many_rows = $result->rowCount();
if($how_many_rows == 0) {

db_insert('authordupe')
->fields(array(
'author' => $author,
'title' => $title,
'link' => $link,
'tags' => $tags,
))
->execute();

}   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:26:52.650

在 Drupal 中运行视图的基本代码是

```
$view = views_get_view('<your_view_machine_name>');
$view->set_display('<optional_display_name>');
$view->execute(); 
```

也就是说，您说有一个在视图中运行的 jQuery 脚本。严重地？你的脚本在做什么？我会说当您希望在客户端运行脚本时最好使用 jQuery。您不能编写 php 代码来完成您需要的任何事情并将其放入 cron 钩子中吗？

# function - withing如何加1（私有静态函数）

> ID：16004421
> 
> 赞同：0
> 
> 时间：2013-04-14T21:17:05.167
> 
> 标签：function, html, numbers

我正在使用 Bol.com 的 API 开发一个新网站，但我现在被困住了。我的问题很简单，但我无法解决这个问题。我只想为每个需要增加 1 的 div 设置一个数字。

此代码将在 div 中生成一本书：

```
private static function printIndex($product) {

echo '<div id="indexboxes">';    
echo '<div id="itemleft"><img src=" ' . $product->getImagemedium() . ' " width="135" height="210"></div>';  
echo '<div id="itemmiddle">'; 
echo '<div id="itemmiddlename"><h2>' . $product->getTitle() . "</h2></div>"; 
echo '<div id="itemmiddlepub"><h3> ' . $product->getPublisher() . "</h3></div>";
echo '</div></div>';
} 
```

它需要是这样的：

1 号图片标题出版商

2 号图片标题出版商

3 号图片标题出版商

ETC..

图片、标题和出版商已经在工作了。但数字不起作用。如何获取此 div 中的数字？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:30:13.703

您可以使用比`<h2>`. 为什么不使用有序列表`<ol>`元素和列表项`<li>`。您可以使用 CSS 计数器并`li:before`获取“数字？” 在每个项目之前。

当 HTML 和 CSS 功能是最自然的工作方式时，为什么不使用它们呢？在任何情况下，使用这种打印方法并将 id 放在您的 div 上会导致在同一页面上多次使用 id。你不想那样做；id 必须是唯一的。

我建议您对您希望页面的外观做一个静态模型；不要使用 PHP，使用列表进行样式设置，并使用 CSS 来格式化文本大小和所需的“数字”前缀。然后，添加 PHP 以获得您想要的动态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:24:38.593

我会通过引用将索引传递给您的函数：例如：

```
private static function printIndex($product, &$idx) {

// your code

$idx++;

} 
```

# c# - 使用 html 敏捷包抓取网站，查找类

> ID：16004424
> 
> 赞同：0
> 
> 时间：2013-04-14T21:17:21.980
> 
> 标签：c#, html-agility-pack, scrape

我正在尝试使用 HTML Agility 包从 html 字符串中获取 som 数据。

我试图从返回 innerhtml 中获取数据的行字符串 [] 如下所示：

```
<td class="street">Riksdagen</td>
<td class="number">&nbsp;</td>
<td class="number">&nbsp;</td>
<td class="postalcode">100 12</td>
<td class="locality">Stockholm</td>
<td class="region_code">018001</td>
<td class="county">Stockholm</td>
<td class="namnkommun">Stockholm</td> 
```

如何将每个类分配给正确的 addressDataModel 属性？

```
var row = doc.DocumentNode.SelectNodes("//*[@id='thetable']/tr");

    foreach (var rowItem in row)
    {
        var addressDataModel = new AddressDataModel
        {
            street = rowItem.FirstChild.InnerText,
            zipCodeFrom = // Next item,
            zipCodeTo = // Next item,
            zipCode = // Next item,
            locality = // Next item,
            regionCode = // Next item,
            state = // Next item,
            county = // Next item
        };
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:49:39.413

你可以这样写（确保节点存在之前使用 InnerText 道具）：

```
var addressDataModel = new AddressDataModel
    {
        street = rowItem.SelectSingleNode("./td[@class='street']").InnerText,
        zipCodeFrom = // Next item,
        zipCodeTo = // Next item,
        zipCode = // Next item,
        locality = // Next item,
        regionCode = // Next item,
        state = // Next item,
        county = rowItem.SelectSingleNode("./td[@class='county']").InnerText
    }; 
```

参考：[http ://www.w3schools.com/xpath/xpath_syntax.asp](http://www.w3schools.com/xpath/xpath_syntax.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-25T16:44:29.480

如果您不想使用 Xpath 也可以参考这里：

```
HtmlAgilityPack.HtmlDocument htmlContent = new HtmlAgilityPack.HtmlDocument();

        htmlContent.LoadHtml(htmlCode);

        if (htmlContent.DocumentNode != null)
        {
            foreach (HtmlNode n in htmlContent.DocumentNode.Descendants("div"))
            {
                if (n.HasAttributes && n.Attributes["class"] != null)
                {
                    if (n.Attributes["class"].Value == "className")
                    {
                      // Do something
                    } 
                }                 
            }
        } 
```

# java - IJVM ILOAD 指令未加载正确的值

> ID：16004426
> 
> 赞同：3
> 
> 时间：2013-04-14T21:17:32.403
> 
> 标签：java, assembly, jvm, bytecode, java-bytecode-asm

我正在为 MIC1 架构编写一个简单的程序来计算 IJVM 中几个整数的绝对值。我正在使用位于[此处](http://www.ontko.com/mic1/)的模拟器。

这是代码：

```
BIPUSH 0xC0  
DUP
ISTORE i1 
ISTORE i2 

LDC_W OBJREF
ILOAD i1  
INVOKEVIRTUAL 
OUT

LDC_W OBJREF
ILOAD i2   
INVOKEVIRTUAL abs
OUT 
```

其中 abs 是一种计算整数绝对值的方法。

`0xC0`第一次调用 abs 工作正常，并正确计算输出的绝对值`0x11`。但是，第二次调用没有，并且输出`0x77`.

当我使用模拟器逐条指令观察堆栈帧时，第二个 ILOAD 最终会推`0x00000000`送到堆栈上，而不是`0xffffffc0`像第一条指令那样。这意味着只有函数的第一次调用才会真正输出正确的值。

有谁知道为什么它`0x00000000`会在后续调用中输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:28:44.953

经过一番调查后，我解决了这个问题 - 方法中有一条指令未正确使用。

# android - 从 Android 到 Arduino 的蓝牙连接立即关闭

> ID：16004430
> 
> 赞同：1
> 
> 时间：2013-04-14T21:17:41.127
> 
> 标签：android, bluetooth, arduino

我是[Android](http://en.wikipedia.org/wiki/Android_%28operating_system%29)的新手......和[​​Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)：/ 我试图修改 BluetoothChat 示例以制作我学校的一个项目，但我仍然从 LogCat 收到这些消息：

```
04-14 16:14:06.399: I/BluetoothSocket(22238): connect() to  00:06:66:4D:61:F8 on port 0
04-14 16:14:06.399: D/BluetoothSppPort(22238): Creating a BluetoothSpp proxy object
04-14 16:14:06.414: D/BluetoothSocket(22238): closed: SppPort closed() for port 0 
```

我正在尝试连接蓝牙伴侣 - 第 2 类 [银] RN-42。我该如何解决这个问题？

我可以发送我的代码。就像我说的那样，我对 Android 和 Java 完全陌生......

# css - Clean Retina Theme #Wordpress，如何删除页眉和页脚背景图案？

> ID：16004431
> 
> 赞同：0
> 
> 时间：2013-04-14T21:17:42.717
> 
> 标签：css, wordpress

在主题选项中，它说为了在页眉和页脚中显示我的背景，我需要添加我自己的基本上忽略或优先考虑我的背景的 CSS（它已经显示在“内容部分”或中间网站）那里的默认模式。我有非常基本的编码技能。任何帮助表示赞赏。（注意：我不是想改变颜色，我想忽略默认图案背景，我希望我的背景显示在整个网站上） Nutivet.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:27:33.240

转到主题文件夹中的 style.css，在第 453 行，您将找到“品牌”的 css，这是您的标题的 id：

```
 #branding{
     background: url("images/header-bg.jpg");
 ....
 } 
```

将其更改为您的模式。或将其更改为无：

```
 background: none; 
```

页脚的 id 是 colophon。

# python - Tkinter PhotoImage 中的透明度

> ID：16004432
> 
> 赞同：3
> 
> 时间：2013-04-14T21:17:46.187
> 
> 标签：python, tkinter

在我正在创建的简单游戏中，我目前有占位符矩形对象作为图形。我正在尝试用精灵替换它们，但据我了解，Tkinter 不支持 PNG 或 alpha 透明度。我正在使用 Python 3.3，它不适用于 PIL（并且由于它是一个学校项目，我只是尝试使用 Tkinter 作为唯一的外部库）。有没有办法将 alpha 通道与支持的文件格式一起使用，以便我可以拥有多层瓷砖？我只想过滤掉白色像素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:29:58.800

我能够使用具有透明度的图像。我理解您希望避免使用 PIL，但以下代码可以工作并证明 Tkinter 将支持具有透明度的格式。

```
from Tkinter import Tk, Canvas
import PIL
root = Tk() 
tkimg = PIL.ImageTk.PhotoImage('cat1-a.gif')
canvas = Canvas(root, height=600, width=600)
canvas.grid()
def stamp(event):
    canvas.create_image(event.x, event.y, image=tkimg)
canvas.bind('<ButtonPress-1>', stamp)
root.mainloop() 
```

![三个 create_image() 调用展示了透明度](https://i.stack.imgur.com/2y7A1.jpg "显示透明度")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-25T18:03:07.873

要使白色像素透明（我假设白色表示#ffffff），您可以使用下面的此功能或类似的功能。这不需要 PIL。它适用于 pngs，但也适用于 gif。

*   首先，制作一个与您的图像大小相同的新空白图像。
*   其次，逐像素复制到新图像（除非像素是白色的）。
*   将原始图像设置为新图像。

这是正在使用的函数的示例：

```
from tkinter import *

def makeTransparent(img, colorToMakeTransparentInHexFormat):
    newPhotoImage = PhotoImage(width=img.width(), height=img.height())
    for x in range(img.width()):
        for y in range(img.height()):
            rgb = '#%02x%02x%02x' % img.get(x, y)
            if rgb != colorToMakeTransparentInHexFormat:
                newPhotoImage.put(rgb, (x, y))
    return newPhotoImage

root = Tk()
mycanvas = Canvas(root, width=200, height=200,bg="orange")
mycanvas.pack()

myphotoImage = PhotoImage(file="whitecar.gif")
#set your image to the image returned by the function
myphotoImage = makeTransparent(myphotoImage, "#ffffff")
canvasImage = mycanvas.create_image(100, 100, image=myphotoImage, anchor=CENTER)

root.mainloop() 
```

这是一个白色背景的白色汽车的例子：

[![白色背景的汽车](https://i.stack.imgur.com/RHqfn.gif)](https://i.stack.imgur.com/RHqfn.gif)

这是使用示例程序在画布上显示该汽车的示例：

[![橙色背景画布上的汽车](https://i.stack.imgur.com/2KT6l.png)](https://i.stack.imgur.com/2KT6l.png)

所以我希望我已经回答了你的问题。

*   我没有使用 PIL。只有 tkinter 模块。
*   我只使用了gif，而不是你问的png。
*   无论白色在哪里，现在都将是透明的。

* * *

##### 笔记：

无论出于何种原因，使用上述函数多次处理透明度可能会导致 tkinter 中的查看错误。下面是一种使用颜色切换功能去除多种颜色的方法： 这是一辆汽车：

[![灰色背景的红色汽车](https://i.stack.imgur.com/dfktJ.png)](https://i.stack.imgur.com/dfktJ.png)

这是另一个切换颜色的功能，可以在使颜色透明之前实现。

```
def switchColors(img, currentColor,futureColor):
    newPhotoImage = PhotoImage(width=img.width(), height=img.height())
    for x in range(img.width()):
        for y in range(img.height()):
            rgb = '#%02x%02x%02x' % img.get(x, y)
            if rgb == currentColor:
                newPhotoImage.put(futureColor, (x, y))
            else:
                newPhotoImage.put(rgb, (x, y))
    return newPhotoImage 
```

这里正在使用

```
root = Tk()
mycanvas = Canvas(root, width=200, height=200,bg="orange")
mycanvas.pack()

myphotoImage = PhotoImage(file="car.png")

myphotoImage = switchColors(myphotoImage,"#db0000","#ffffff") #switch red to white
myphotoImage = switchColors(myphotoImage,"#d9d9d9","#ffffff") #switch greybackground to white
myphotoImage = switchColors(myphotoImage,"#6d6d6d","#ffffff") #switch windshield grey to white
myphotoImage = makeTransparent(myphotoImage,"#ffffff") #make white transparent

canvasImage = mycanvas.create_image(100, 100, image=myphotoImage, anchor=CENTER)

root.mainloop() 
```

这是该过程的结果：

[![去除了 2 个灰色和红色的汽车](https://i.stack.imgur.com/CdxSU.png)](https://i.stack.imgur.com/CdxSU.png)

这是对类似问题的参考： [如何在不使用 PIL 的情况下在画布上旋转图像？](https://stackoverflow.com/questions/41248426/how-to-rotate-an-image-on-a-canvas-without-using-pil)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T16:29:09.503

有一种方法可以将 PIL 与 Python 3 一起使用，使用 PIL 的非官方版本去[http://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)下载它。

# android - Android API 是否有类似 Flash 的重复影片剪辑的东西？

> ID：16004434
> 
> 赞同：0
> 
> 时间：2013-04-14T21:17:59.813
> 
> 标签：android, flash, view

我曾经做过很多 Flash Actionscript，现在我正在进入 Android。Android API 中是否有类似于 Actionscript 中的 duplicateMovieClip() 的内容？我确信可能有一种方法可以编写这样的方法，但我想知道是否有任何现有的快捷方式。

例如，假设我在屏幕上有一个 ImageView、TextView 或其他类型的视图对象，并且我希望有一个可以单击的按钮，该按钮将复制屏幕上的某些对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T01:42:28.790

如果你不介意我问，你*为什么*需要类似的东西`duplicateMovieClip()`？

为了回答这个问题，Android 没有 AS2 的概念`duplicateMovieClip()`。就像在 AS3（也没有`duplicateMovieClip()`）中一样，您必须实现自己的克隆方法。Java 确实有一个未实现的 '.clone()' 方法作为每个 Java 对象的一部分，因此如果您想要克隆一个特定的 View，您可以通过覆盖 clone 方法来实现您的克隆。

我认为您最终可能会做一些更类似于从库中实例化的事情，方法是在 xml 中制作小视图布局并使用 Inflater 工具对它们进行充气。

```
View result = null;

// where pContext is a context object, either supplied by the application
// or just by the current Activity (if available)

LayoutInflater inflater = (LayoutInflater) pContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

// where id is the layout id such as R.layout.myclonableview.
// where pRoot is the parent container for the new result.
// where pAttachToRoot is whether to immediately inflate the new view into the root.
result = inflater.inflate(id, pRoot, pAttachToRoot);

// Now "clone" your old view by copying relevant fields from the old one to the
// one stored in result 
```

# smalltalk - seaside : html 锚点上的 2 个事件

> ID：16004435
> 
> 赞同：3
> 
> 时间：2013-04-14T21:18:00.977
> 
> 标签：smalltalk, seaside

在海边，我需要做两个事件 - 回调并在单击链接时转到另一个 url (google.com)，但我无法同时执行这两个事件。这里可能有什么问题？有什么办法我可以同时做这两个事件吗？

```
html anchor
    newTarget url: 'www.google.com';
    callback: [Transcript show: 'clicked on google.com'];
    with: ('www.google.com') . 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T16:47:05.900

因为 >>callback: 和 >>url: 都更新了 Anchor 标签上的 href 属性，所以您不能在同一个锚点上同时使用它们。您必须通过编写一个执行逻辑的回调方法来解决这个问题，然后使用 javascript 在新窗口中打开页面。

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:28:05.470

您不能使用锚点的默认单击行为来完成此操作。下面的代码片段演示了如何使用 ajax 调用来执行此操作，该调用在回调中执行您的操作并将导航设置为另一个 url 作为 ajax 'oncomplete' 操作。

```
html anchor
   url: 'javascript:{}';
   onClick: (html jQuery ajax 
                        callback: [ ... ];
                        onComplete:(html javascript goto:'http://www.google.com'));
    with: 'http://www.google.com'. 
```

该代码段使用“javascript:{}”代码作为 url 取消锚点上的默认点击操作。在某些情况下，我也看到了“#”的使用，但根据我的经验，它也会将您的浏览器滚动到顶部。接下来，它设置适当的“单击”处理程序来启动 ajax 请求，如我之前所述。

# ios5 - 使用地图 visibleRegion 搜索 CoreData

> ID：16004436
> 
> 赞同：0
> 
> 时间：2013-04-14T21:18:10.417
> 
> 标签：ios5, core-data, google-maps-sdk-ios, geohashing

我在 CoreData 中存储了数千个位置，我想搜索[Google Maps](https://developers.google.com/maps/documentation/ios/start) visibleRegion 中的位置。我以前使用边界框进行搜索，但添加[轴承功能](https://developers.google.com/maps/documentation/ios/views#bearing_orientation)会破坏这种类型的查询。我有几个想法，但这一定是一些经过深思熟虑的解决方案的常见问题。我很想看看是否有任何解决方案使用geohashes。

这是我的查询，当方位不是正北时会中断。

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(lat > %f AND lat < %f AND lng > %f AND lng < %f)",
                                    [self.googleMap.projection visibleRegion].nearLeft.latitude,
                                    [self.googleMap.projection visibleRegion].farLeft.latitude,
                                    [self.googleMap.projection visibleRegion].nearLeft.longitude,
                                    [self.googleMap.projection visibleRegion].nearRight.longitude
                               ]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:24:46.740

您可以计算可见区域的轴对齐边界框，然后使用它来查找您的位置。其中一些仍将在实际可见区域之外，但至少您将过滤掉其中的大部分。

中的`GMSCoordinateBounds`类`GMSCoordinateBounds.h`可用于使这更容易：

```
GMSMapView* _mapView = ...;

GMSCoordinateBounds* bounds = 
    [[GMSCoordinateBounds alloc] 
        initWithRegion: [_mapView.projection visibleRegion]];
CLLocationCoordinate2D northEast = bounds.northEast;
CLLocationCoordinate2D southWest = bounds.southWest; 
```

另请注意，当前存在可见区域太大的错误，请参见此处：

[https://code.google.com/p/gmaps-api-issues/issues/detail?id=5107](https://code.google.com/p/gmaps-api-issues/issues/detail?id=5107)

有关该问题的解决方法，请参见此处：

[Google Maps iOS SDK：如何从相机的可见区域获取准确的经纬度坐标？](https://stackoverflow.com/questions/15317359/google-maps-ios-sdk-how-do-i-get-accurate-latitude-and-longitude-coordinates-fr/15740559#15740559)

# javascript - 试图解析 JSON 字符串，意外的数字

> ID：16004439
> 
> 赞同：3
> 
> 时间：2013-04-14T21:18:44.043
> 
> 标签：javascript, json

我正在尝试解析这个 JSON：

```
var json = '{"material":"Gummislang 3\/4\" 30 m (utanp\u00e5liggande sk\u00e5p)"}' 
```

我运行`JSON.parse(json)`但`SyntaxError: Unexpected number`这样做时出现错误。我在谷歌浏览器中试过这个。我不知道问题出在哪里，因为我可以将 JSON 字符串放入任何 JSON 验证器中，并且它声称 JSON 是有效的。浏览器不应该能够解析它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T21:26:11.163

您将 JSON 对象表示插入到 JavaScript 字符串中，而没有正确转义表示。

为避免必须这样做，请删除您在表示周围添加的引号，并跳过`JSON.parse(json)`- PHP 的默认输出`json_encode()`在此上下文中使用时是有效的 JavaScript。

为了安全起见，您应该尽可能指定该`JSON_HEX_TAG`选项。如果 JSON 可能最终位于解析为 XML 的文档中，这将防止跨站点脚本。（对于 XML 文档，JSON 也应该在 CDATA 部分中。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T21:21:17.283

您正在验证*string literal*，这是一个包含无效 JSON 的有效 JSON 字符串。您需要验证字符串的值，这不是有效的 JSON。

如果将字符串值粘贴到 JSON 验证器中，您将看到错误来自此部分：

```
"material": "Gummislang 3/4"30m 
```

`"`需要逃避。

# javascript - 如何解析电子邮件文本的“有人写...”部分？

> ID：16004444
> 
> 赞同：2
> 
> 时间：2013-04-14T21:19:45.703
> 
> 标签：javascript, regex, email, github, filter

如果你从 Github 收到私信，你可以直接通过邮件回复，而不是直接去网站回复。

当 Github 收到您的电子邮件时，它会解析邮件并将其插入数据库。我正在尝试做同样的事情。

但是，当我的服务器以原始字符串形式接收电子邮件时，它会得到如下内容：

```
Important message here

On April 4, 2012 Somebody wrote:
    > blahblahblah
      On March 2, 2012 Somebody wrote:
           > blahblahbla 
```

当然，我只想要重要的信息。我不想要人们以前写的其他垃圾。

有没有**通用**的方法来过滤掉它？某种图书馆？

或者...我是否必须检查 Gmail、Yahoo、Hotmail 以确定他们在邮件底部添加了哪些垃圾，然后将其单独过滤掉？

Github 是如何做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:23:03.557

GitHub 为此使用了他们的[email_reply_parser](https://github.com/github/email_reply_parser) gem。

> 这是 GitHub 用来显示从电子邮件回复中创建的评论的方式。这段代码是开源的，旨在众包我们的电子邮件表示的质量。

# c# - Ormlite 不会将日期时间从 SQL Server 映射到 C#？

> ID：16004446
> 
> 赞同：5
> 
> 时间：2013-04-14T21:19:57.087
> 
> 标签：c#, datetime, mapping, servicestack, ormlite-servicestack

我试图在一段时间内从我的 sql server 数据库中检索一些数据。我在 DateTime2(7) 的数据库中得到了一个字段，在我的 DAO 中我得到了 Datetime 作为该字段的类型。但我收到以下错误：从字符串转换日期和/或时间时转换失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:45:35.627

获取 Ormlite 源代码并逐步完成。查看发生了什么的最快方法，如果有问题，您可以快速解决。

[https://github.com/ServiceStack/ServiceStack.OrmLite](https://github.com/ServiceStack/ServiceStack.OrmLite)

# asp.net-mvc - 果园项目文件组织

> ID：16004448
> 
> 赞同：0
> 
> 时间：2013-04-14T21:20:08.010
> 
> 标签：asp.net-mvc, module, orchardcms, orchardcms-1.6

我计划为 Orchard 构建一些自定义模块。

现在我正在计划一个包含许多“功能”的模块，可以随意禁用/启用。例如看这个项目：[https ://bitbucket.org/bleroy/nwazet.commerce/src/aaf4eb89b711d99181a11c94bdaefc13ca086903/Module.txt?at=default](https://bitbucket.org/bleroy/nwazet.commerce/src/aaf4eb89b711d99181a11c94bdaefc13ca086903/Module.txt?at=default)

当同一个项目中有许多功能时，我看到的逻辑组织是按角色划分命名空间中的文件（服务命名空间中的所有服务，控制器命名空间中的所有控制器等等）。

当一个模块增长并且有 5 或 10 个功能时，它会有点混乱，因为通常一个功能一次工作一个功能，同时您在服务或模型目录中有 10 个功能的模型......

我知道 Orchard 使用了很多隐式代码约定，尤其是文件放置。

问题是：我可以添加一个额外的命名空间层，以便在单个模块中为每个功能都有一个文件夹，并且项目更干净吗？

可能视图必须保持在一起，是否可以移动其他文件？

在这种情况下推荐的最佳做法是什么？

Mvc 允许在这种情况下使用区域，但果园模块已经是区域......我可以在果园模块中使用区域吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:21:30.220

模块已经是区域，你不能在其中有区域，所以是的，你必须尊重约定并且有一些混乱的东西，或者你必须将它分成单独的模块。

# php - 如何使网页下载 PDF、DOC、POWER POINT 和图像

> ID：16004449
> 
> 赞同：0
> 
> 时间：2013-04-14T21:20:10.247
> 
> 标签：php

我一直在尝试制作一个可以下载不同文件格式（PDF、DOC、POWER POINT 和图像）的下载页面。这适用于 pdf，但第一个问题是有时它会使我的整个系统重新启动，或者它重定向到内容不可读的其他页面。其次，不是应用程序/pdf的其他文件格式（MIME）不会只是下载，有时会下载pdf，但是当我尝试打开它时会显示一条错误消息，说它是一种错误的文件格式。以下是我用来制作下载页面的标题。

```
header('Content-Type: application/{$_GET['mime']}');
header("Content-Disposition:attachment; filename='{$_GET['name']}'\n");
header("Content-Length:{$_GET['size']}\n");
header('Content-Transfer-Encoding: binary'); 
```

以下是我尝试允许的各种 MIME：

```
$permitted = array('text/html', 'image/jpeg', 'image/png', 'image/jpg','image/gif',
 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 
 'application/pdf', 'text/plain', 
 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
 'application/vnd.openxmlformatsofficedocument.presentationml.presentation'); 
```

这是（几乎）所有代码：

```
$flag = false;
$filepath = $_GET['path'] . $_GET['name']
foreach($permitted as $value) {
    if($_GET['mime'] == $value) {
        $flag=true;
        break;
    }
    if($flag == true) {
        header('Content-Type: application/{$_GET['mime']}');
        header("Content-Disposition:attachment; filename='{$_GET['name']}'\n");
        header("Content-Length:{$_GET['size']}\n");
        header('Content-Transfer-Encoding: binary');
        readfile($filepath)
    } 
```

当我在学校的项目中使用它时，我将不胜感激所有的回应，谢谢....

# c# - 如果 DB 具有值，则遍历复选框列表并将数据库中的值分配给选定的列表

> ID：16004451
> 
> 赞同：2
> 
> 时间：2013-04-14T21:20:45.457
> 
> 标签：c#, asp.net, loops, selecteditem, checkboxlist

我有一个包含 10 个值的 asp.net 复选框列表，并且我已将 4 个选中的值插入到数据库中。现在这些值在数据库中，如下所示

```
1
2
3
4 
```

如果我想将值重新分配给 Checkboxlist 已选中。有人可以告诉我如何使用数据库值遍历复选框列表并检查我从数据库中获得的值。

提前致谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:24:53.820

这应该这样做。您只需要检查 listitem 的值，看看它是否与数据库中的值相同。有很多方法可以做到这一点，实际上取决于您的其余设置和与数据库的连接。

以下是如何遍历列表框项目（我认为这是您真正的问题）：

```
 for (int x = 0; x < listBox1.Items.Count; x++)
   {
    if(YOUR LOGIC HERE)
    {
       listBox1.SetSelected(x, true);
    }
   } 
```

希望这对你有帮助！

# c# - Web 配置中的连接字符串被忽略

> ID：16004457
> 
> 赞同：2
> 
> 时间：2013-04-14T21:21:17.850
> 
> 标签：c#, wcf, web-config, connection-string

这是一个我以前从未见过的问题，似乎甚至找不到不涉及蛮力硬编码的解决方法，更不用说解决方案了。尝试在 WCF 服务应用程序中连接到 SQL Server Express 2012 数据库时，我对 的调用`ConfigurationManager`不显示添加到 Web.config 的连接字符串。这是连接字符串...

```
<connectionStrings>
  <add name="SRC.RMX.DB" connectionString="Data Source=COMPUTER-NAME\SQLEXPRESS;Initial Catalog=src.db;Integrated Security=True" providerName="MSSQL"/>
</connectionStrings> 
```

这是我在无数真实和测试应用程序中添加的完全相同的连接字符串格式，并且与正在构建的服务非常相似的服务具有完全相同的连接（它们应该在同一系统中并排工作）与不同的名称，并且没有问题。令人惊讶的是，如果将测试控制台应用程序添加到项目中，并在其 app.config 中使用此连接字符串，则它可以毫无问题地运行。

但是尝试运行 Web 服务的单元测试，它在 web.config 中找不到它。调试时，它甚至没有列在连接字符串选项中。我会理解配置文件是否存在问题，但我几乎只是在项目中使用由 VS2012 创建的文件，并且只添加了连接字符串，如下所示...

```
<?xml version="1.0"?>
<configuration>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <connectionStrings>
    <add name="SRC.RMX.DB" connectionString="Data Source=COMPUTER-NAME\SQLEXPRESS;Initial Catalog=src.db;Integrated Security=True" providerName="MSSQL"/>
  </connectionStrings>
  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <protocolMapping>
        <add binding="basicHttpsBinding" scheme="https" />
    </protocolMapping>    
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <directoryBrowse enabled="true"/>
  </system.webServer>
</configuration> 
```

任何想法可能是罪魁祸首？我可以在这里做些什么来让这个连接字符串最终出现吗？我会错过什么？

解决了：

哎呀。不好意思承认，但我下载了一个没有用于我的单元测试的连接字符串的 .config 文件版本，并且 100% 确定我有。就在你认为你确定的时候，再次检查是值得的……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:38:17.940

如果它是为单元测试完成的，您也应该将 connString 添加到单元测试项目配置中。

您也可以尝试调试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T02:25:07.643

尝试重新创建配置文件并将您的自定义属性复制/粘贴到其中。可能只是某个地方不合适的字符或分隔符。如果它有效，你可以 winmerge 看看它是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:50:56.513

我还没有测试过它可能会产生什么影响，但是您的提供程序应该是`System.Data.SqlClient`针对 MSSQL Server 的。我以前没有见过`MSSQL`提供商名称。

# c++ - 为 Stroustup 的书使用 Makefile

> ID：16004461
> 
> 赞同：0
> 
> 时间：2013-04-14T21:21:39.020
> 
> 标签：c++, makefile

我正在阅读 Stroustrup 的“Programming Principles and Practice Using C++”。尝试在 Visual Studio 中编译以下示例时，我得到四个链接器错误。但后来我意识到我没有使用他的网站提供的makefile（[here](http://www.stroustrup.com/Programming/Graphics/)）。这是我正在尝试编译的示例：

```
#include "../../Simple_window.h"
#include "../../Graph.h"
#include "../../Point.h"

int main()
{
    using namespace Graph_lib;

    Point tl(100,100);

    Simple_window win(tl,600,400,"Canvas");

    /*Polygon poly;
    poly.add(Point(300,200));
    poly.add(Point(350,100));
    poly.add(Point(400,200));

    poly.set_color(Color::red);

    win.attach(poly);*/

    win.wait_for_button();
} 
```

我应该如何使用 Makefile？我应该将头文件和 cpp 文件放在同一目录中并将其包含在代码中吗？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:24:17.547

将其放在与您的代码相同的目录中，然后从命令行`make`在该目录中运行。绝对不要将 makefile 包含到您的源文件中。看起来您的`main.cpp`文件比 Stroustrup 提供的代码更深两个目录，但它可能应该在同一个目录中。

# php - 使用 jquery wordpress 加载 php 文件

> ID：16004462
> 
> 赞同：0
> 
> 时间：2013-04-14T21:21:49.303
> 
> 标签：php, jquery, wordpress, wordpress-theming

我在我的 worpdress 主题 ios 按钮开关中实现，当有人单击按钮时，脚本会加载一个带有文本的 php 文件：on 或 off

这是代码：

```
 <script type="text/javascript">

$('#1').iphoneSwitch("<?php echo get_user_meta( $current_user->ID, '_fbpost_status', true); ?>", 
 function() {
   $('#ajax').load('<?php bloginfo( 'template_url' ); ?>/includes/ajaxswitch/on.php');
  },
  function() {
   $('#ajax').load('<?php bloginfo( 'template_url' ); ?>/includes/ajaxswitch/off.php');
  },
  {
    switch_on_container_path: '<?php bloginfo( 'template_url' ); ?>/includes/ajaxswitch/iphone_switch_container_off.png'
  }); 
```

所以 on.php 只有“已激活”文本和 of.php “已停止”文本。on 和 off 文件没有包含 wordpress 变量。我怎样才能包括它们？在 db 中进行更新。或者您知道进行更新的更好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:53:16.397

由于您使用的是 WordPress，因此正确的做法是使用`wp_localize_script`in发送一个 JavaScript 变量`functions.php`：

```
add_action('wp_enqueue_scripts', 'my_frontend_data');
function my_frontend_data()
{
  global $current_user;
  wp_localize_script('data', 'Data', array(
    'userMeta' => get_user_meta($current_user->ID, '_fbpost_status', true),
    'templateUrl' => get_template_directory_uri()
  ));
} 
```

以上将添加一个`Data`可在所有页面中访问的 JavaScript 变量。然后你可以像这样在前端使用它：

```
var ajaxUrl = Data.templateUrl +'/includes/ajaxswitch/';

$('#1').iphoneSwitch(Data.userMeta, function() {
  $('#ajax').load(ajaxUrl +'on.php');
}, function() {
  $('#ajax').load(ajaxUrl +'off.php');
}, {
  switch_on_container_path: Data.templateUrl +'iphone_switch_container_off.png';
}); 
```

# javascript - 更改浏览器中的 URL（假 URL）以进行电影摄影

> ID：16004466
> 
> 赞同：-4
> 
> 时间：2013-04-14T21:22:08.647
> 
> 标签：javascript, html, google-chrome, url

在我目前负责的一个项目中，我们必须为电影场景编写假网页。（喜剧演员正在使用计算机并在浏览器（Chrome）上（本地）导航。

由于我不能使用 PHP 进行本地更改，出于安全原因也不能简单地使用 Javascript 更改 URL 位置，我该如何修改 URL 内容？

**示例**：

file:///C:/Users/User/Desktop/Project/SEARCH/4.html

至

[http://www.some-web-site-here.com/fake/url/page.html](http://www.some-web-site-here.com/fake/url/page.html)

谢谢您的反馈 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:32:43.683

尝试使用 onpopstate 处理程序来控制地址栏中的 url。

请参阅此处了解更多信息：[https ://developer.mozilla.org/en-US/docs/DOM/window.onpopstate](https://developer.mozilla.org/en-US/docs/DOM/window.onpopstate)

# java - 如何从 Max/MSP 中的 mxj 对象中获取鼠标状态

> ID：16004467
> 
> 赞同：0
> 
> 时间：2013-04-14T21:22:16.483
> 
> 标签：java, max-msp-jitter

从 mxj 对象内部，有没有办法确定当前是否按下了任何鼠标按钮？

我知道在 Max 补丁中，这些数据可以从 [mousestate] 对象中收集。我想做同样的事情，但在我的 Java 代码中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-26T23:25:05.267

我用它来获取鼠标位置。

```
public void bang() {
        Point p = MouseInfo.getPointerInfo().getLocation();
        post(""+p.getX());
} 
```

借助上面的代码，获取鼠标状态应该非常容易。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-29T19:55:09.563

经过数小时的搜索，我想不出任何方法可以从 mxj 对象中获取鼠标状态数据。我不确定这是否可能。我最终使用 [mousestate] 制定了一个笨重的解决方案。

# c++ - 使用 STL 的 C++ 共享对象在 Windows 上导致 SIGSEGV

> ID：16004469
> 
> 赞同：0
> 
> 时间：2013-04-14T21:22:23.447
> 
> 标签：c++, windows, dll, g++

我正在用 C++ 编写一个支持 GET 的简单 Web 服务器。为了支持动态内容，我将制作动态对象作为程序。即对 URL 之类的请求`example.com/dynamicContent/124`将被发送到`dynamicContent.dll`.

模块必须实现以下功能：

```
extern "C" __declspec (dllexport) int handle_request(http::request*, http::response*); 
```

我可以让原型正常工作，但是当我尝试使用`std::string`时，程序崩溃了。由于`http::response`API 包含设置内容/内容类型等的方法，并且期望字符串对象，我真的很沮丧。

这些模块在同一台计算机上使用与 Web 服务器完全相同的 g++ 版本进行编译。这是我的测试模块的 Makefile：

```
g++ -c modules/TestModule.cpp
g++ -g -Wall -o modules/dynwindows.dll TestModule.o libsol.a
g++ -g -Wall -o dynamic_windows.exe dynamic_windows.cpp libsol.a 
```

`libsol.a`是一个实现`http::request`和的库`http::response`。

这是功能：

```
extern "C" __declspec (dllexport) int handle_request(http::request* request, http::response* response)
{
    std::string name = "yo"; // this handle sigsegv
    response->set_status(200);
    response->set_body(name);
    return 1;
} 
```

**更新** 以下 make 使事情正常进行..任何猜测为什么？

```
g++ -shared -g -o modules/dynwindows.dll \
-Wl,--export-all-symbols \
-Wl,--enable-auto-import \
-Wl,--whole-archive TestModule.o \
-Wl,--no-whole-archive libsol.a 
```

# constants - 在 Inno Setup 中安装之前使用 [Code] 更改 AppID

> ID：16004473
> 
> 赞同：5
> 
> 时间：2013-04-14T21:23:03.793
> 
> 标签：constants, inno-setup, app-id

在设置中，我为用户提供了使用单选按钮安装 32 位或 64 位版本的选项。

然后我想将“_32”或“_64”附加到 AppID。

我知道我可以使用脚本常量更改 AppID，但是在安装程序启动时会调用所需的函数。但此时单选按钮尚不存在，因此我收到错误“无法调用 proc”。

我查阅了 Inno Setup 帮助，我读到您可以在安装过程开始之前的任何给定点更改 AppID（如果我理解正确的话）。

那么我该如何做到这一点呢？

我期待着您的回答！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T00:12:23.297

某些`{code:...}`指令值的某些函数被多次调用，而`AppId`是其中之一。更具体地说，它被调用了两次。一次是在创建向导表单之前，一次是在安装开始之前。您可以做的只是检查您尝试从中获取值的复选框是否存在。您可以简单地询问它是否`Assigned`如下所示：

```
[Setup]
AppId={code:GetAppID}
...

[Code]
var  
  Ver32RadioButton: TNewRadioButton;
  Ver64RadioButton: TNewRadioButton;

function GetAppID(const Value: string): string;
var
  AppID: string;
begin
  // check by using Assigned function, if the component you're trying to get a
  // value from exists; the Assigned will return False for the first time when
  // the GetAppID function will be called since even WizardForm not yet exists
  if Assigned(Ver32RadioButton) then
  begin
    AppID := 'FDFD4A34-4A4C-4795-9B0E-04E5AB0C374D';
    if Ver32RadioButton.Checked then
      Result := AppID + '_32'
    else
      Result := AppID + '_64';
  end;
end;

procedure InitializeWizard;
var
  VerPage: TWizardPage;
begin
  VerPage := CreateCustomPage(wpWelcome, 'Caption', 'Description');
  Ver32RadioButton := TNewRadioButton.Create(WizardForm);
  Ver32RadioButton.Parent := VerPage.Surface;
  Ver32RadioButton.Checked := True;
  Ver32RadioButton.Caption := 'Install 32-bit version';
  Ver64RadioButton := TNewRadioButton.Create(WizardForm);
  Ver64RadioButton.Parent := VerPage.Surface;
  Ver64RadioButton.Top := Ver32RadioButton.Top + Ver32RadioButton.Height + 4;
  Ver64RadioButton.Caption := 'Install 64-bit version';
end; 
```

# sql - 根据另一个表中的值计算出现次数

> ID：16004477
> 
> 赞同：0
> 
> 时间：2013-04-14T21:23:36.843
> 
> 标签：sql

我有一个名为“评论”的表格，其中包含评论 ID 和评论内容。

为了计算有多少评论包含特定关键字，我使用了代码。

```
SELECT COUNT(text)
FROM Reviews
WHERE text LIKE '%PC%'; 
```

现在，我要做的是代替“%PC%”，而是从另一个包含关键字 ID 和实际关键字的表中获取关键字。

我希望结果会是这样的：

```
COUNT(text) | Keyword
    5       |   PC
    1       |   Computer 
```

计数是包含特定关键字的评论数。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:30:46.997

使用 GROUP BY 函数：

```
 SELECT COUNT(text), text as Keyword
    FROM Reviews
-- you can use where clause here to filter down your results further
    GROUP BY text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:38:01.547

尝试这个

```
SELECT k.keyword, COUNT(text) cnt
FROM KeywordTable k
LEFT OUTER JOIN Reviews r ON r.text like '%' + k.Keyword + '%'
GROUP BY k.keyword 
```

# linux - Django Celery socket.error: [Errno 111] 连接被拒绝

> ID：16004478
> 
> 赞同：9
> 
> 时间：2013-04-14T21:23:43.200
> 
> 标签：linux, django, ubuntu, celery, django-celery

`celery status`在我的生产服务器上运行命令时，出现此错误：

但是，Celery 工作并且工人运行，这是什么错误，为什么我不能运行这个命令？

```
ubuntu@ip-10-32-9-39:/srv/project/logs/celery$ celery status
Traceback (most recent call last):
  File "/usr/local/bin/celery", line 9, in <module>
    load_entry_point('celery==3.0.11', 'console_scripts', 'celery')()
  File "/usr/local/lib/python2.7/dist-packages/celery/__main__.py", line 14, in main
    main()
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 946, in main
    cmd.execute_from_commandline(argv)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 890, in execute_from_commandline
    super(CeleryCommand, self).execute_from_commandline(argv)))
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/base.py", line 179, in execute_from_commandline
    return self.handle_argv(prog_name, argv[1:])
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 882, in handle_argv
    return self.execute(command, argv)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 857, in execute
    return cls(app=self.app).run_from_argv(self.prog_name, argv)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 142, in run_from_argv
    return self(*args, **options)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 112, in __call__
    ret = self.run(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 652, in run
    .run('ping', **dict(kwargs, quiet=True, show_body=False))
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 505, in run
    return self.do_call_method(args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 527, in do_call_method
    replies = handler(method, *args[1:], **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/bin/celery.py", line 570, in call
    return getattr(i, method)(*args)
  File "/usr/local/lib/python2.7/dist-packages/celery/app/control.py", line 79, in ping
    return self._request('ping')
  File "/usr/local/lib/python2.7/dist-packages/celery/app/control.py", line 54, in _request
    timeout=self.timeout, reply=True))
  File "/usr/local/lib/python2.7/dist-packages/celery/app/control.py", line 260, in broadcast
    channel=channel)
  File "/usr/local/lib/python2.7/dist-packages/kombu/pidbox.py", line 235, in _broadcast
    chan = channel or self.connection.default_channel
  File "/usr/local/lib/python2.7/dist-packages/kombu/connection.py", line 748, in default_channel
    self.connection
  File "/usr/local/lib/python2.7/dist-packages/kombu/connection.py", line 733, in connection
    self._connection = self._establish_connection()
  File "/usr/local/lib/python2.7/dist-packages/kombu/connection.py", line 692, in _establish_connection
    conn = self.transport.establish_connection()
  File "/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqp.py", line 109, in establish_connection
    heartbeat=conninfo.heartbeat)
  File "/usr/local/lib/python2.7/dist-packages/amqp/connection.py", line 136, in __init__
    self.transport = create_transport(host, connect_timeout, ssl)
  File "/usr/local/lib/python2.7/dist-packages/amqp/transport.py", line 250, in create_transport
    return TCPTransport(host, connect_timeout)
  File "/usr/local/lib/python2.7/dist-packages/amqp/transport.py", line 95, in __init__
    raise socket.error, msg
socket.error: [Errno 111] Connection refused 
```

设置...

```
CELERYD_NODES="w1 w2 w3"

# Where to chdir at start.
CELERYD_CHDIR="/srv/project/"

# How to call "manage.py celeryd_multi"
CELERYD_MULTI="$CELERYD_CHDIR/manage.py celeryd_multi"

# How to call "manage.py celeryctl"
CELERYCTL="$CELERYD_CHDIR/manage.py celeryctl"

# Extra arguments to celeryd
CELERYD_OPTS="--time-limit=300 --concurrency=8"

# %n will be replaced with the nodename.
CELERYD_LOG_FILE="/srv/project/logs/celery/%n.log"
CELERYD_PID_FILE="/srv/project/celery/%n.pid"

# Workers should run as an unprivileged user.
CELERYD_USER="ubuntu"
CELERYD_GROUP="ubuntu"

# Name of the projects settings module.
export DJANGO_SETTINGS_MODULE="project.settings" 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-15T13:59:34.727

从 manage.py shell 启动...

```
sudo python manage.py celery status 
```

这将解决您的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-18T09:55:29.017

就我而言，我必须在包含和文件`__init__.py`的包中的文件中添加以下行：`settings.py``celery.py`

```
# -*- coding: utf-8 -*-
from __future__ import absolute_import

# This will make sure the app is always imported when
# Django starts so that shared_task will use this app.
from .celery import app as celery_app 
```

检查[http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html](http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html)以供参考。

# php - 正则表达式匹配包含任何数字的最后一个“单词”

> ID：16004483
> 
> 赞同：1
> 
> 时间：2013-04-14T21:24:15.467
> 
> 标签：php, regex

我正在尝试匹配包含数字的字符串的最后一个“单词”。基本上，如果其中任何一个是数字，我想匹配字符串的最后一个（空格）之后的任何字符。

在我的特殊情况下，作为一个例子，我试图从电视节目 RSS 提要中提取季节/剧集。如果我有：`Show Name 12x4`或者`Show Name 2013-04-12`我希望匹配`12x4`and `2013-04-12`。

我从最后一个单词 regex ( `[^ ]*$`) 开始，但有些节目没有剧集或日期 ( `Show Name`)，所以我希望让我的 regex 更具体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:26:39.180

试试这个正则表达式：

```
/[\w\-]+$/ 
```

有时正则表达式是不够的，或者它变得更复杂......首先尝试拆分字符串：

```
$str = 'Show Name 12x4';
$lastWord = array_pop(explode(' ', $str));

if (preg_match('/(?=\d)/', $lastWord)) {
  ...
} 
```

# javascript - 为什么我的精灵是从底部裁剪的？

> ID：16004486
> 
> 赞同：1
> 
> 时间：2013-04-14T21:24:23.580
> 
> 标签：javascript, flash-cs6, easeljs, sprite-sheet

我正在使用 Flash Pro 生成我的精灵表并使用 EaselJS 加载精灵。我注意到如果我的精灵太大，它会从底部被裁剪（即手臂被剪掉）。下面的代码演示了这一点：

```
<html>
    <head>
        <title>Example</title>
        <script type="text/javascript" src="easeljs-0.6.0.min.js"></script>
    </head>

    <body>
        <canvas id="canvas">
            HTML5 Canvas not supported
        </canvas>
        <script>
            canvas = document.getElementById("canvas");
            stage = new createjs.Stage(canvas);

            // create spritesheet and assign the associated data.
            largeSS = new createjs.SpriteSheet({
                images: ["large.jpg"],
                frames: [[0,0,221,200,0,0,0],[221,0,221,200,0,0,0],[0,200,221,200,0,0,0],[221,200,221,200,0,0,0]],
                animations: {
                    talk: [0, 3, "talk", 7]
                }
            });

            bmpAnimation = new createjs.BitmapAnimation(largeSS);
            bmpAnimation.gotoAndPlay("talk");
            stage.addChild(bmpAnimation);
            createjs.Ticker.addListener(stage);
        </script>
    </body>
</html> 
```

以下是我的大.jpg： ![](https://i.stack.imgur.com/LNI6v.jpg)

但是，如果我让我的精灵变小，问题就解决了。下面我有完全相同的代码，除了使用更小的框架尺寸和相同但更小的精灵表：

```
<html>
    <head>
        <title>Example</title>
        <script type="text/javascript" src="easeljs-0.6.0.min.js"></script>
    </head>

    <body>
        <canvas id="canvas">
            HTML5 Canvas not supported
        </canvas>
        <script>
            canvas = document.getElementById("canvas");
            stage = new createjs.Stage(canvas);

            // create spritesheet and assign the associated data.
            smallSS = new createjs.SpriteSheet({
                images: ["small.jpg"],
                frames: [[0,0,100,91,0,0,0],[100,0,100,91,0,0,0],[0,91,100,91,0,0,0],[100,91,100,91,0,0,0]],
                animations: {
                    talk: [0, 3, "talk", 7]
                }
            });

            bmpAnimation = new createjs.BitmapAnimation(largeSS);
            bmpAnimation.gotoAndPlay("talk");
            stage.addChild(bmpAnimation);
            createjs.Ticker.addListener(stage);
        </script>
    </body>
</html> 
```

小.jpeg：

![](https://i.stack.imgur.com/hU3Ne.jpg)

我真的很想解决这个问题。有人可以向我解释为什么会这样吗？我究竟做错了什么？或者精灵的大小是否有限制？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T01:39:57.243

画布的默认尺寸小于您的图像 - 因此您的图像被裁剪为该尺寸。（铬是 300x150）。将您的画布高度设置得更高，您的动画的其余部分将可见。

干杯!

# jquery - 用于动态命名表单的 jQuery 选择器

> ID：16004488
> 
> 赞同：1
> 
> 时间：2013-04-14T21:24:42.267
> 
> 标签：jquery, jquery-selectors

我有一个包含一系列表单的页面 - 所有名称都相同，但 ID 的模式如下：

```
<form name='myRadios' id='myRadios_1' />
<form name='myRadios' id='myRadios_2' />
<form name='myRadios' id='myRadios_3' /> 
```

我正在通过以下方式捕获单选按钮：

```
 $('input[type=radio]').change(function (event) { 
```

但需要弄清楚哪个表单包含单击的按钮。此时，我正在将相同的 ID 迭代器附加到单选按钮本身的 ID 字段：

```
var targetForm = event.target.id.toString().split("_")[1]; 
```

但是我看不到我如何获取该值并使用它来绑定到正确的形式。我正在尝试沿线的变化：

```
var form = $("#myRadios_" + targetForm);
var form = $("[id=#myRadios_" + targetForm+ "]"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:27:22.217

```
$('input:radio').on('change', function(){
   var $form = $(this).closest('form');
}); 
```

# php - 检查禁止/非活动

> ID：16004489
> 
> 赞同：0
> 
> 时间：2013-04-14T21:24:42.767
> 
> 标签：php, parameters, actionscript-2

所以我正在研究一个虚拟世界，我目前正在尝试让 login.php 检查用户是否被禁止或未激活。如果用户被封禁，封禁栏会显示“1”（如果没有被封禁，则会显示“0”。）如果用户的帐户已激活，则活动栏会显示“1”（如果未激活，则活动栏会显示“0”。）我的 as2 发送帖子参数用户名并传递给 login.php。Login.php 这样做：

```
<?php
$myServer = "localhost";
$myUser = "root";
$myPass = "";
$myDB = "game";

//connection to the database
$dbhandle = mysql_connect($myServer, $myUser, $myPass)
or die("Couldn't connect to SQL Server on $myServer");

//select a database to work with
$selected = mysql_select_db($myDB, $dbhandle)
or die("Couldn't open database $myDB");

// The response variable
$res = "res=KO";

// Check incoming data  
if ($_POST['name'] != "" && $_POST['pass'] != "") { 

// Retrieve all rows from the "user_name" and "password" columns from the "account_info" table
$result = mysql_query("SELECT username, password, active, banned FROM users")
or die(mysql_error()); 
}
//create a loop that continues until each row is called
while($row = mysql_fetch_array($result)) {

//check if client user name/password is the same as the row from database
if ($_POST['name'] == $row['username'] && $_POST['pass'] == $row['password'] && $row['active'] = '1' && $row['banned'] == '0') { //BE AWARE OF "" ''

// If they match, Ok, user found
$res = "res=OK";
break;
}
else if ($_POST['name'] == $row['username'] && $_POST['pass'] == $row['password'] && $row['active'] == '0' && $row['banned'] == '0') 
{
$res = "res=unactive";
}
else if ($_POST['name'] == $row['username'] && $_POST['pass'] == $row['password'] && $row['banned'] == '1' && $row['active'] == '1' )
{
$res = "res=banned";
}

}
print $res;
?> 
```

这是处理 $res 的函数：

```
serverIn.onLoad = function(success)
{
    if (success)
    {
        if (this.res == "OK")
        {
            sendLogin()
        }
        else if (this.res == "unactive")
        {
            var win:MovieClip = showWindow("errorWindow")
            win.errorMsg.text = "Your account is not activated."
        }
        else if (this.res == "banned")
        {
            var win:MovieClip = showWindow("errorWindow")
            win.errorMsg.text = "Your account is banned."
        }
        else
        {
            var win:MovieClip = showWindow("errorWindow")
            win.errorMsg.text = "Incorrect username or password"
        }
    }
    else
    {
        var win:MovieClip = showWindow("errorWindow")
        win.errorMsg.text = "Connection failed"
    }
} 
```

这两个文件都很好用，在我添加 login.php 中检查用户是否被禁止的部分之前它一直有效。所以这是我的问题：

我在数据库中更改了我的用户信息，以便我被禁止和激活。但是发送到 swf 的 $res 是 res=unactive 并且会出现“用户不活动”窗口。当我被禁止和活跃时，我希望“用户被禁止”弹出窗口出现。

然后我改变了它，这样我就不会被禁止并且我很活跃。这让我正常登录，就像它应该的那样。

然后我这样做，这样我就不会被禁止和不活跃。它在不应该登录的时候登录。我希望“用户未激活”窗口会出现，但事实并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:31:40.703

这可能很重要：

（PHP 的 ~29 行）

```
$row['active'] = '1' 
```

这是将值设置为 1，而不是针对 1 测试该值。

```
$row['active'] == '1' 
```

另外，请不要将用户凭据存储为明文！

# r - R - 从原始数据集中下载子集

> ID：16004495
> 
> 赞同：3
> 
> 时间：2013-04-14T21:25:12.957
> 
> 标签：r, download, dataset, subset

我想知道是否有可能（从网站）下载由 Rdata 格式的原始数据集制作的子集。最简单的方法当然是以这种方式进行：

```
set<-url("http://xxx.com/datasets/dataset.RData")
load(set)
subset<-set[set$var=="yyy",] 
```

但是我正在尝试加快我的代码并避免下载不必要的列。

感谢您的任何反馈。

马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T22:27:17.210

该任务没有机制。也没有检查 .Rdata 文件的机制。过去，当有人提出要求时，人们被建议转换为真正的数据库管理系统。

# nhibernate - NHibernate 检查实体是否存在的线程安全方法

> ID：16004496
> 
> 赞同：0
> 
> 时间：2013-04-14T21:25:18.690
> 
> 标签：nhibernate

我一直在努力解决应该是一个简单的问题。我正在尝试执行以下基本操作

1）通过ID以外的字段检查实体是否存在

2）如果没有，创建实体

问题是这是在一个多线程的控制台应用程序中，所以我需要以某种方式通过 ID 以外的字段获取实体并将 LockMode 设置为 Upgrade（或者至少我认为这是需要做的）。据我所知，ISession 无法做到这一点。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T14:16:45.123

在单个进程中使用全局锁对象

```
lock(existsLocker)
{
    var entity = session.Query<Entity>().Where(...).FirstOrDefault();
    if (entity == null)
    {
       entity = new Entity();
       session.Save(entity);
       session.Flush();
    }
} 
```

# mysql - 在进一步的子查询中引用（基于子查询的）别名

> ID：16004498
> 
> 赞同：1
> 
> 时间：2013-04-14T21:25:27.493
> 
> 标签：mysql, sql

我可以在 where 子句的第二个子查询中引用从 FROM 子句中的子查询创建的别名吗？

```
Select x FROM 
((SELECT x,y FROM A) UNION (SELECT x,y FROM B) UNION (SELECT x,y FROM C)) AS newAlias 
WHERE y IN (SELECT MAX(y) FROM newAlias) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:43:40.837

不，答案是否定的。`NewAlias`必须重复子查询。

可以使用 CTE（通用表表达式），但 MySQL 尚未实现它们：

```
WITH newAlias AS
  (SELECT x,y FROM A UNION SELECT x,y FROM B UNION SELECT x,y FROM C)
SELECT x 
FROM newAlias 
WHERE y = (SELECT MAX(y) FROM newAlias) ; 
```

在 MySQL 中，您必须重复子查询：

```
SELECT x 
FROM 
  (SELECT x,y FROM A UNION SELECT x,y FROM B UNION SELECT x,y FROM C) 
  AS newAlias 
WHERE y = 
      ( SELECT MAX(y) 
        FROM
          (SELECT x,y FROM A UNION SELECT x,y FROM B UNION SELECT x,y FROM C) 
          AS newAlias  
      ) ; 
```

当然，您通常可以重新编写查询。一种方法：

```
SELECT x 
FROM 
  (SELECT x,y FROM A UNION SELECT x,y FROM B UNION SELECT x,y FROM C) 
  AS newAlias 
WHERE y = GREATEST( (SELECT MAX(y) FROM A)
                  , (SELECT MAX(y) FROM B)
                  , (SELECT MAX(y) FROM C)
                  ) ; 
```

# php - PharData::extractTo 将文件提取为什么文件格式？

> ID：16004501
> 
> 赞同：5
> 
> 时间：2013-04-14T21:25:32.973
> 
> 标签：php, hex, bzip2, phar

我正在使用[`extractTo`](http://php.net/manual/en/phardata.extractto.php)PHP`PharData`类的方法来检查 phar 文件的内容并遇到了一些 strage 结果。我已经达到了我的字节级侦探工作的极限，希望这里有人能够帮助我解决这个问题。

详细信息如下，但一般来说：当我用 提取我的存档文件时`PharData::extractTo`，我得到的文件似乎是一个变体`bzip`，但`bzip2`命令不喜欢它们。这是正常`phar`行为，还是特定存档有问题？（或者可能是我正在使用的 PHP/OS 组合）。有没有办法从 phar 存档中获取纯文本文件 - 或者纯文本应该是默认的，我正在寻找奇怪的系统行为？

具体来说，当我运行命令时

```
$phar = new Phar('n98-magerun.phar');
$phar->extractTo('/tmp/n98-magerun'); 
```

在我的 OS 10.6.8 上，基于 Intel 的 Mac 使用内置的 PHP 5.3.6，存档成功解压到 /tmp/n98-magerun 文件夹中。

![在此处输入图像描述](https://i.stack.imgur.com/eF86c.png)

我提取的档案[可以在这里找到](https://github.com/netz98/n98-magerun)。

如果我打开在 BBEdit 中提取的任何文本文件，我会看到正确的内容。

![在此处输入图像描述](https://i.stack.imgur.com/Ofvgn.png)

**但是**，如果我使用其他工具，例如 quicklook `vi`、 或`cat`，我会看到二进制数据。我在尝试`ack`/`grep`通过文件内容时注意到了这一点，但没有得到预期的结果。

![在此处输入图像描述](https://i.stack.imgur.com/BvZlt.png)

如果我`file`在文件上使用命令，它会报告它是一个`bzip`文件。

```
$ file MIT-LICENSE.txt 
MIT-LICENSE.txt: bzip2 compressed data, block size = 400k 
```

并使用十六进制编辑器检查文件确认文件以`BZ`标题开头

![在此处输入图像描述](https://i.stack.imgur.com/IuN1r.png)

但是，尝试解压缩文件`bzip2`会导致以下错误

```
$ bzip2 -d MIT-LICENSE.txt 
bzip2: Can't guess original name for MIT-LICENSE.txt -- using MIT-LICENSE.txt.out

bzip2: Compressed file ends unexpectedly;
    perhaps it is corrupted?  *Possible* reason follows.
bzip2: No such file or directory
    Input file = MIT-LICENSE.txt, output file = MIT-LICENSE.txt.out

It is possible that the compressed file(s) have become corrupted.
You can use the -tvv option to test integrity of such files.

You can use the `bzip2recover' program to attempt to recover
data from undamaged sections of corrupted files.

bzip2: Deleting output file MIT-LICENSE.txt.out, if it exists. 
```

我可以`bzcat`成功地文件，尽管它在文件中间用这个

```
bzcat: Compressed file ends unexpectedly;
    perhaps it is corrupted?  *Possible* reason follows.
bzcat: Undefined error: 0
    Input file = MIT-LICENSE.txt, output file = (stdout)

It is possible that the compressed file(s) have become corrupted.
You can use the -tvv option to test integrity of such files.

You can use the `bzip2recover' program to attempt to recover
data from undamaged sections of corrupted files. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T04:33:22.593

这是一个`bzip2`文件，但要解压缩它，您需要使用`--stdout`(or `-c`) 选项（见下文）。

您需要该`--stdout`选项的原因是文件不以`.bz2`扩展名结尾，这将允许`bunzip2`确定要解压缩到的结果文件名。

```
$ bunzip2 --stdout MIT-LICENSE.txt 2>/dev/null
Copyright (c) 2012 netz98 new media GmbH

http://www.netz98.de

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE 
```

我不知道为什么`bunzip2`将以下内容输出到标准错误：

```
bzip2: Compressed file ends unexpectedly;
        perhaps it is corrupted?  *Possible* reason follows.
bzip2: Success
        Input file = MIT-LICENSE.txt, output file = (stdout)

It is possible that the compressed file(s) have become corrupted.
You can use the -tvv option to test integrity of such files.

You can use the `bzip2recover' program to attempt to recover
data from undamaged sections of corrupted files. 
```

正如`file`命令报告的那样，该文件是一个有效的 bzip2 文件，块大小为 400k：

```
$ file MIT-LICENSE.txt 
MIT-LICENSE.txt: bzip2 compressed data, block size = 400k 
```

我尝试将`-4`选项添加到`bunzip2`，但它仍然抱怨：

```
$ bunzip2 -d -4 -vvvvv -c  MIT-LICENSE.txt >/dev/null 
  MIT-LICENSE.txt: 
    [1: huff+mtf rt+rld {0x2010d4b9, 0x2010d4b9}]
    combined CRCs: stored = 0x2010d4b9, computed = 0x2010d4b9
    [1: huff+mtf 
bunzip2: Compressed file ends unexpectedly;
        perhaps it is corrupted?  *Possible* reason follows.
bunzip2: Success
        Input file = MIT-LICENSE.txt, output file = (stdout)

It is possible that the compressed file(s) have become corrupted.
You can use the -tvv option to test integrity of such files.

You can use the `bzip2recover' program to attempt to recover
data from undamaged sections of corrupted files. 
```

所以我的猜测是创建这些 bzip2 文件的程序是这个问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T14:12:09.430

使用`extractTo`文件以与存档相同的格式存储！这可以是以下之一：无、gzip、bzip2

虽然您当然可以以这种格式保存它们，然后尝试以某种方式提取它，但我建议如下：将 phar 转换为**未压缩**的phar 并提取该存档！

方法如下：

```
<?php
$phar = new Phar('Someclass.phar');
$phar2 = $phar->convertToExecutable (Phar::TAR,Phar::NONE); //convert to an uncompressed tar archive
$phar2->extractTo('/some/path/'); // extract all files 
```

这将为您提供所有未压缩的文件！

# reference - MonoDevelop 正在删除我对 System.Drawing (Unity) 的引用

> ID：16004502
> 
> 赞同：0
> 
> 时间：2013-04-14T21:25:34.457
> 
> 标签：reference, unity3d, monodevelop

在我的一个脚本中，我需要引用 System.Drawing。但是，似乎每次我启动项目并输入 Mono 时，它都会删除引用，我需要重新添加它。

我所有的其他参考资料都留在他们应该在的地方，这可能发生的任何特殊原因或我将如何防止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-18T13:06:23.233

每当文件系统发生更改时，Unity 会自动重新生成 .csproj.sln 文件，这将覆盖您对 .csproj.sln 所做的任何更改。

Unity 使用来自 Unity 项目和文件系统的信息来执行此操作，因此您必须使用 Unity 理解的方法来保留您的更改。例如，必须通过 Unity 项目定义预处理器标志，并且必须通过文件系统添加程序集。

我相信如果您将 dll 放入 ./Assets/Dlls 中，那么它们将包含在项目中。但是，我怀疑 System.Drawing 将不受支持，因为它是一个不兼容的绘图库。

# silverlight - IIS 5 上的 Silverlight 5 WCF Ria 服务 404 错误

> ID：16004517
> 
> 赞同：4
> 
> 时间：2013-04-14T21:27:17.683
> 
> 标签：silverlight, iis, wcf-ria-services

我已经使用 Silverlight 和 WCF Ria 服务开发了一个应用程序。
该应用程序必须托管在使用 IIS 5 的 Windows XP 机器上。
由于我在网上找到的信息，我确实部署了应用程序没有任何问题。
但是现在当我的应用程序尝试执行第一个 WCF 查询时，我遇到了这个错误：

> 消息：查询“登录”的 Silverlight 应用程序加载操作中未处理的错误失败。[HttpWebRequest_WebException_RemoteServer] 参数：NotFound 调试资源字符串不可用。通常，关键和论据提供了足够的信息来诊断问题。请参阅 [http://go.microsoft.com/fwlink/?linkid=106663&Version=5.1.10411.0&File=System.Windows.dll&Key=HttpWebRequest_WebException_RemoteServer](http://go.microsoft.com/fwlink/?linkid=106663&Version=5.1.10411.0&File=System.Windows.dll&Key=HttpWebRequest_WebException_RemoteServer) at System.ServiceModel.DomainServices.Client.OperationBase.Complete(Exception error) at System.ServiceModel System.ServiceModel.DomainServices.Client.ApplicationServices.AuthenticationOperation.<>c_DisplayClass1.b 处的 .DomainServices.Client.ApplicationServices.AuthenticationOperation.End(IAsyncResult 结果*)*_0（对象状态）在 System.ServiceModel.DomainServices.Client.ApplicationServices.AuthenticationOperation.HandleAsyncCompleted(IAsyncResult asyncResult) 在 System.ServiceModel.DomainServices 的 System.ServiceModel.DomainServices.Client.ApplicationServices.AuthenticationOperation.RunInSynchronizationContext(SendOrPostCallback 回调，对象状态) .Client.AsyncResultBase.Complete()
> 在 System.ServiceModel.DomainServices.Client.ApplicationServices.WebAuthenticationService.HandleOperationComplete(OperationBase operation) 在 System.ServiceModel.DomainServices.Client.LoadOperation.<>c_ *DisplayClass4`1.<Create>b__0(LoadOperation`1 arg）在 System.ServiceModel.DomainServices.Client.LoadOperation`1.InvokeCompleteAction() 在 System.ServiceModel.DomainServices.Client.OperationBase.Complete（异常错误）在 System.ServiceModel.DomainServices.Client.LoadOperation.Complete（异常错误) 在 System.ServiceModel.DomainServices.Client.DomainContext.CompleteLoad(IAsyncResult asyncResult) 在 System.ServiceModel.DomainServices.Client.DomainContext.<>c* _DisplayClass1b.b__17(Object )

我该如何解决这个错误？
应用程序在 Windows 7 机器上的 IIS 7 上成功托管，并且 wcf ria 也可以工作。
更新：使用 Fiddler 后，我发现我的应用程序的错误是 404，Silverlight 找不到 Ria Services。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:50:37.033

在这种情况下，NotFound 表示服务器上的任何错误。您需要获取详细的 WCF 日志。我建议您将以下内容添加到 web.config 文件以启用 WCF 日志记录：

```
<configuration>
  ... your regular configuration here ...
  <system.diagnostics>
    <sources>
      <source name="System.ServiceModel" switchValue="All" propagateActivity="true">
        <listeners>
          <add name="traceListener" type="System.Diagnostics.XmlWriterTraceListener"
initializeData="C:\wcflogs\your_wcf_service_log.svclog"  />
        </listeners>
      </source>
    </sources>
  </system.diagnostics>
</configuration> 
```

然后，您可以使用服务跟踪查看器工具 (SvcTraceViewer.exe) 打开 .svclog 文件并查看详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:21:38.843

尝试在服务器上重新安装 RIA 服务。

我认为命令是 RiaService.msi Server=true

重新安装后，尝试直接在网络浏览器上访问您的服务。您的服务的 URL 将是[http://YOURDOMAIN.COM/YourAPP/Full-NameSpace-Of-Class.svc](http://YOURDOMAIN.COM/YourAPP/Full-NameSpace-Of-Class.svc)

在命名空间中，您必须将点 (.) 更改为破折号 (-)

如果它没有返回响应，那么您必须验证 WCF 是否已安装并在 IIS 中注册。

# java - Java 图像指向鼠标

> ID：16004523
> 
> 赞同：0
> 
> 时间：2013-04-14T21:28:28.300
> 
> 标签：java, slick2d

我遇到了一个问题，图像根据玩家位置和鼠标位置之间的差异旋转，但图像实际上并没有指向鼠标。我希望图像的顶部中心指向鼠标，而角度似乎总是关闭。我将在下面发布代码。

```
 Input input = gc.getInput();

  if (input.isKeyDown(Input.KEY_W))
  {
     position.y -= 3;
  }

  if (input.isKeyDown(Input.KEY_A))
  {
     position.x -= 3;
  }

  if (input.isKeyDown(Input.KEY_S))
  {
     position.y += 3;
  }

  if (input.isKeyDown(Input.KEY_D))
  {
     position.x += 3;
  }

  float xDistance = input.getAbsoluteMouseX() - position.x;
  float yDistance = input.getAbsoluteMouseY() - position.y;
  double angleToTurn = Math.toDegrees(Math.atan2(yDistance, xDistance));
  entityImage.setRotation((float) angleToTurn); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T11:10:43.657

[Math.atan(double)](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#atan%28double%29)的 javadoc表示返回值的范围可以从 -pi/2 到 pi/2。
所以你需要补偿那个返回值。

```
double angleToTurn = Math.toDegrees(Math.atan2(yDistance, xDistance));
if(angleToTurn < 0)
{
        angleToTurn += 360;
} 
```

# sqlite - SQLite“错误：找不到列'studentID'”

> ID：16004524
> 
> 赞同：2
> 
> 时间：2013-04-14T21:28:31.440
> 
> 标签：sqlite

当我尝试编写一个简单的数据库来代表一所小学时，我在尝试编译代码时遇到了这个错误。

当我尝试插入到 ATTENDS 表时发生错误。

我似乎找不到错误，因为其他一切正常。同样删除所有触发器仍然会导致错误，因此它们不是问题。

任何帮助将不胜感激。

```
CREATE TABLE IF NOT EXISTS Student(
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    name TEXT NOT NULL, 
    lastName TEXT NOT NULL, 
    gender TEXT COLLATE NOCASE NOT NULL ,
    DOB TEXT NOT NULL, 
    address TEXT NOT NULL, 
    grade TEXT NOT NULL,
    /* Checks */
    CHECK(gender IN ("m", "f", "o")),
    CHECK(grade IN("K", "1", "2", "3", "4", "5", "6"))
);
CREATE TABLE IF NOT EXISTS Course(
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    name TEXT NOT NULL, 
    grade TEXT COLLATE NOCASE NOT NULL,
    /* Checks */
    CHECK(grade IN("K", "1", "2", "3", "4", "5", "6"))
);

CREATE TABLE IF NOT EXISTS Attends(
    studentID INTEGER,
    courseID INTEGER,
    gradePoints TEXT COLLATE NOCASE,
    FOREIGN KEY(studentID) REFERENCES Student(id), 
    FOREIGN KEY(courseID) REFERENCES Course(id), 
    /* Checks */
    CHECK(gradePoints ISNULL OR gradePoints IN ("A", "B", "C", "D", "E")),
    UNIQUE(studentID, courseID)
);

CREATE TRIGGER IF NOT EXISTS sameGrade 
BEFORE INSERT ON Attends 
WHEN (SELECT grade  FROM Student WHERE Student.id = studentID) <> (SELECT grade
FROM Course Where Course.id = courseID)
BEGIN
    SELECT RAISE(ABORT,'The student’s grade does not match the course’s grade.');
END;

CREATE TRIGGER IF NOT EXISTS changeGrade
BEFORE UPDATE ON Student
WHEN (NOT OLD.grade LIKE "K" AND NEW.grade LIKE "K") OR (NOT OLD.grade LIKE "K" AND NEW.grade < OLD.grade) 
BEGIN
    SELECT RAISE(ABORT,'The student cannot go into a lower grade.');
END;

CREATE TRIGGER IF NOT EXISTS max100Students
BEFORE INSERT ON Attends
WHEN 100 < (SELECT COUNT(*) FROM Attends WHERE courseID = NEW.courseID)
BEGIN
    SELECT RAISE(ABORT,'Courses cannot have more than 100 students.');
END;

INSERT INTO Student(name,lastName,gender,DOB,address,grade) VALUES('Taylor','B','F','1992-04-25','123 1st ST','2');
INSERT INTO Student(name,lastName,gender,DOB,address,grade) VALUES('Taylor','B','F','1992-04-25','123 1st ST','2');
INSERT INTO Student(name,lastName,gender,DOB,address,grade) VALUES('Taylor','B','F','1992-04-25','123 1st ST','2');
INSERT INTO Student(name,lastName,gender,DOB,address,grade) VALUES('Taylor','B','F','1992-04-25','123 1st ST','2');
INSERT INTO Student(name,lastName,gender,DOB,address,grade) VALUES('Taylor','B','F','1992-04-25','123 1st ST','4');

INSERT INTO Course(name,grade) VALUES('Gym','K');
INSERT INTO Course(name,grade) VALUES('Gym','1');
INSERT INTO Course(name,grade) VALUES('Gym','2');
INSERT INTO Course(name,grade) VALUES('Gym','3');
INSERT INTO Course(name,grade) VALUES('Gym','4');
INSERT INTO Course(name,grade) VALUES('Gym','5');
INSERT INTO Course(name,grade) VALUES('Gym','6');

INSERT INTO Attends(studentID, courseID, gradePoints) VALUES(1,3,NULL);
INSERT INTO Attends(studentID, courseID, gradePoints) VALUES(2,3,NULL);
INSERT INTO Attends(studentID, courseID, gradePoints) VALUES(3,3,NULL);
-- INSERT INTO Attends(studentID, courseID, gradePoints) VALUES(4,3,NULL);
-- INSERT INTO Attends(studentID, courseID, gradePoints) VALUES(5,3,NULL); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:25:08.707

问题出在sameGrade 触发器中。您忘记使用 NEW 引用该行。只需在前面加上“新”。到“studentID”和“courseID”列，以便 sqlite3 知道您指的是什么：

```
CREATE TRIGGER IF NOT EXISTS sameGrade 
BEFORE INSERT ON Attends 
WHEN (SELECT grade FROM Student WHERE Student.id = NEW.studentID) <> (SELECT grade FROM Course WHERE Course.id = NEW.courseID)
BEGIN
    SELECT RAISE(ABORT,'The student’s grade does not match the course’s grade.');
END; 
```

# visual-c++ - 使一个库引用另一个库

> ID：16004527
> 
> 赞同：0
> 
> 时间：2013-04-14T21:28:52.620
> 
> 标签：visual-c++, linker

我需要创建一个将使用winsocks 的静态库。正如您已经知道的那样，为了使用winsocks，您需要在项目中引用ws2_32.lib，无论如何，从visual studio我找不到我通常会这样做的“链接”选项卡。如果我打开另一个项目，一个不是库的项目（比如 win32 控制台应用程序），这个选项卡就会出现......无论如何，我无法构建一个 .lib 文件，而该文件又包含另一个，这对我来说似乎很奇怪。 ..我不认为是第一个需要在图书馆中使用套接字的人..或者不是？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T14:12:11.520

解决了通过命令行编译...

```
cl myLib.c /link ws2_32.dll 
```

# javascript - 下拉菜单中缺少滚动条

> ID：16004532
> 
> 赞同：-2
> 
> 时间：2013-04-14T21:29:17.320
> 
> 标签：javascript, css, scrollbar

出于某种原因，在我的页面[http://automammoth.com/shop/cart/](http://automammoth.com/shop/cart/)上（请在购物车中添加商品以查看）下拉菜单中缺少滚动条，因此我的客户无法选择正确的州或国家/地区. 有谁知道我需要做什么来解决这个问题？我在 css 中找不到正确的字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:35:12.907

摆脱`overflow: hidden`此 CSS 规则中的 可以解决您的问题。

```
http://automammoth.com/wp-content/plugins/shopp/core/ui/styles/catalog.css?ver=20110511
line 47
media="screen"

#shopp form ul {
  width: 100%;
  overflow: hidden;
  line-height: 1;
} 
```

# ios - 通知在上午 12 点而不是上午 7 点发送

> ID：16004537
> 
> 赞同：1
> 
> 时间：2013-04-14T21:29:36.860
> 
> 标签：ios, objective-c

我正在尝试安排在早上 7 点发送通知。但它在上午 12 点交付。请帮助我做错了什么。这是我的代码。

```
NSString *date = @"4/14/2013 07:00";
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"MM/dd/yyyy HH:mm"];
NSDate *thisDate = [df dateFromString:date];

UILocalNotification *localNotification = [[UILocalNotification alloc] init];
localNotification.fireDate = thisDate;
localNotification.timeZone = [NSTimeZone defaultTimeZone];  
localNotification.alertBody = @"This is notification";
localNotification.alertAction = @"view";
localNotification.soundName = UILocalNotificationDefaultSoundName;
localNotification.alertLaunchImage = Nil;
self.badgeCount ++;
localNotification.applicationIconBadgeNumber = self.badgeCount;
localNotification.userInfo = Nil;
[[UIApplication sharedApplication] scheduleLocalNotification:localNotification]; 
```

我预计此通知将在上午 7 点送达。相反，它在上午 12 点弹出。这里出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:41:40.013

我打赌`localNotification.timeZone`和`df.timeZone`不一样...

将此添加到您的 DateFormatter：

```
df.timeZone = [NSTimeZone defaultTimeZone]; 
```

# python - 列表：如何判断列表中的字母是否在单词中？

> ID：16004539
> 
> 赞同：1
> 
> 时间：2013-04-14T21:29:48.907
> 
> 标签：python, list, for-loop, python-3.x

例如，如果您有一个列表

```
C=''
B='apple'
A=['a','b','c','d','e'] 
```

您将如何查看该列表中的任何字母是否在单词“apple”中，向用户显示其中包含哪些字母，并为列表中未显示的每个字母显示“-”。例如，苹果是 a---e。我以为会是这样的......

```
for item in A:
     if item in B:
          C+=item
     else:
          C+='-'
print(C) 
```

但我无法弄清楚。任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T21:32:50.427

```
>>> B = 'apple'
>>> A = ['a','b','c','d','e']
>>> print ''.join(c if c in B else '-' for c in A)
a---e 
```

这相当于这个`for`循环：

```
>>> s = ''
>>> for c in A:
        if c in B:
            s += c
        else:
            s += '-'

>>> print s
a---e 
```

# c++ - 使用 mysql 连接器将 mysql 数据库中的数据存储到 C++ 变量中

> ID：16004540
> 
> 赞同：0
> 
> 时间：2013-04-14T21:29:50.067
> 
> 标签：c++, mysql, connector

所以我从[http://dev.mysql.com/downloads/connector/cpp/](http://dev.mysql.com/downloads/connector/cpp/)
下载了 c++/mysql 连接器 现在我想将从数据库中检索到的数据存储到一个变量中。这是我所得到的。

```
string str;
/////////////////////////////////get data from database////////////////////////////////////////////////////////
  sql::Driver *driver;
  sql::Connection *con;
  sql::Statement *stmt;
  sql::ResultSet *res;

  /* Create a connection */
  driver = get_driver_instance();
  con = driver->connect("tcp://127.0.0.1:3306", "root", "");
  /* Connect to the MySQL test database */
  con->setSchema("awesome");

  stmt= con->createStatement();

      res = stmt->executeQuery(

"SELECT * FROM master where choice='Y'");

/////////////////////////////Store it somewhere/////////////////////////////// 
          str= res->getString("rfid"); 
```

欢迎任何和所有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:53:19.180

虽然没有其他代码和数据库数据就很难猜出发生了什么，但下面的代码至少应该有助于更好地理解问题所在：

```
 try
  {
    while (res->next())
    {
          str= res->getString("rfid");
    }
  }
  catch (std::exception &e)
  {
    std::cerr << e.what();
  } 
```

# php - PHP插入错误..尝试了一切

> ID：16004543
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:30:19.560
> 
> 标签：php, mysql, database, forms, sql-insert

可能是一些愚蠢的事情，因为我的 MySQL PHP 知识太生疏了.. 我清理了所有我能做的错误，但我仍然无法写入我的数据库。任何人都可以阐明可能出了什么问题，因为它甚至不再打印错误了。谢谢：

```
<?php
$conn=mysql_connect("127.0.0.1","root","","pe_results"); 

        if (isset($_POST['Name'])) { 
        $Name = $_POST['Name'];
        }
        if (isset($_POST['Short'])) { 
        $Short = $_POST['Short'];
        }
        if (isset($_POST['Med'])) { 
        $Med = $_POST['Med'];
        }
        if (isset($_POST['Long'])) { 
        $Long = $_POST['Long'];
        }
        if (isset($_POST['VLong'])) { 
        $VLong = $_POST['VLong'];
        }
        if (isset($_POST['Extreme'])) { 
        $Extreme = $_POST['Extreme'];
        }
        if (isset($_POST['LJump'])) { 
        $LJump = $_POST['LJump'];
        }
        if (isset($_POST['HJump'])) { 
        $HJump = $_POST['HJump'];
        }
        if (isset($_POST['Shotputt'])) { 
        $Shotputt = $_POST['Shotputt'];
        }
        if (isset($_POST['Discuss'])) { 
        $Discuss = $_POST['Discuss'];
        }
        if (isset($_POST['Javelin'])) { 
        $Javelin = $_POST['Javelin'];
        }
        if (isset($_POST['Date'])) { 
        $Date = $_POST['Date'];
        }
        if (isset($_POST['Year'])) { 
        $Year = $_POST['Year'];
        }

            $sql="INSERT INTO results_main (Name, Short, Med, Long, VLong, Extreme, LJump, HJump, Shotputt, Discuss, Javelin, Date, Year)
            VALUES ('$Name', '$Short', '$Med', '$Long', '$VLong', '$Extreme', '$LJump', '$HJump', '$Shotputt', '$Discuss', '$Javelin', '$Date', '$Year')";

    $result = mysql_query($sql,$conn);
        if($result){
echo"<br/>Everythings been saved";
echo "<BR>";
echo "<a href='index.html'>Back to the main page</a>";
}

else {
echo 'Fatal Error, you information has not been saved';
}

// close connection 
mysql_close($conn);
?> 
```

这是更新：

查询是： INSERT INTO results_main (Name, Short, Med, Long, VLong, Extreme, LJump, HJump, Shotputt, Discuss, Javelin, Date, Year) VALUES ('Chris Davern', '10:00', '20: 00'、'40:00'、'80:00'、'15:00'、'100m'、'10m'、'15m'、'50m'、'400m'、'2013-03-27'、' 9')

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“Long, VLong, Extreme, LJump, HJump, Shotputt, Discuss, Javelin, Date, Year) 附近使用正确的语法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:44:45.423

这意味着您没有选择数据库。以下是我用来连接 mysql_ 函数的方式：

```
$host = "localhost";
$databasename = "pe_results";
$databaseusername = "root";
$databasepassword = "password";

$conn = mysql_connect("$host", "$databaseusername", "$databasepassword"); 
mysql_select_db("$databasename", $conn); 

$sql="INSERT INTO results_main (`Name`, `Short`, `Med`, `Long`, `VLong`, `Extreme`, `LJump`, `HJump`, `Shotputt`, `Discuss`, `Javelin`, `Date`, `Year`)
        VALUES ('$Name', '$Short', '$Med', '$Long', '$VLong', '$Extreme', '$LJump', '$HJump', '$Shotputt', '$Discuss', '$Javelin', '$Date', '$Year')";

$result = mysql_query($sql); 
```

另请注意，更新了列名，因为 LONG 列名是 mysql 关键字，因此需要将其识别为列名而不是关键字。

然后你可以执行你的mysql_query。但是，就像我们之前提到的那样。mysql_ 函数已弃用，不应再使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T23:45:56.213

[LONG](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html#table-reserved-words-5.0.96)这个词是 MySQL 中的保留字...尝试将所有内容都包含在反引号中：

```
 $sql="INSERT INTO `results_main` (`Name`, `Short`, `Med`, `Long`, `VLong`, `Extreme`, `LJump`, `HJump`, `Shotputt`, `Discuss`, `Javelin`, `Date`, `Year`)
        VALUES ('$Name', '$Short', '$Med', '$Long', '$VLong', '$Extreme', '$LJump', '$HJump', '$Shotputt', '$Discuss', '$Javelin', '$Date', '$Year')"; 
```

代替

```
 $sql="INSERT INTO results_main (Name, Short, Med, Long, VLong, Extreme, LJump, HJump, Shotputt, Discuss, Javelin, Date, Year)
        VALUES ('$Name', '$Short', '$Med', '$Long', '$VLong', '$Extreme', '$LJump', '$HJump', '$Shotputt', '$Discuss', '$Javelin', '$Date', '$Year')"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:39:02.877

阅读[php 文档](http://php.net/manual/fr/function.mysql-connect.php)，您的第四个参数`mysql_connect`应该是一个布尔值，我猜这是您的数据库名称，因此您永远不会选择任何数据库。采用 ：

```
mysql_select_db("pe_results"); 
```

此代码可能已打印此错误。：

```
$result = mysql_query($sql,$conn) or die (mysql_error ()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T21:51:19.857

您在创建连接时没有选择数据库，因此您可以像这样指定它：

```
mysql_select_db("Put your Database Name Here"); 
```

# c++ - 默认初始化后如何更改 mpf_class 的精度？

> ID：16004545
> 
> 赞同：0
> 
> 时间：2013-04-14T21:30:28.777
> 
> 标签：c++, gmp

我需要`mpf_class`从 MPIR 库封装到我的类中`A`：

```
class A
{           
    mpf_class a;    // default constructor - default precision
public:
    A(){                
        a = mpf_class(0,my_precision); // initialize a with zero, but it remains with default precision 
        mpf_class b = mpf_class(0,my_precision); // initialize local b with zero with my_precision
    }
}; 
```

但是在构造函数中我不能`a`用初始化`my_precision`，因为`operator=`不会改变目标的精度。

我创立的唯一方法是将默认精度更改为`my_precision`在创建对象之前`A`，例如

```
mpf_set_default_prec(my_precision);
A my_class; 
```

这有效，但这是一个非常糟糕的解决方案。那么，如何创建`a`具有所需精度的字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:32:07.823

只需使用成员初始化列表来初始化`a`：

```
A() : a(0, my_precision)
{ } 
```

这避免了`a`.

# python - Python 与 sqlalchemy 数据库检索

> ID：16004547
> 
> 赞同：0
> 
> 时间：2013-04-14T21:30:39.170
> 
> 标签：python, sql, network-programming, sqlalchemy

我对 python 和 sqlalchemy 很陌生。我编写了以下网络程序。

```
class SourcetoPort(Base):
    """"""
    __tablename__ = 'source_to_port'
    id = Column(Integer, primary_key=True)
    port_no        = Column(Integer)
    src_address    = Column(String)

    #----------------------------------------------------------------------
    def __init__(self, src_address,port_no):
        """"""
        self.src_address = src_address
        self.port_no     = port_no 
```

#

```
def act_like_switch (self, packet, packet_in):
    """
    Implement switch-like behavior.
    """
    # Learn the port for the source MAC
    print "RECIEVED FROM PORT ",packet_in.in_port , "SOURCE ",packet.src
    Session = sessionmaker(bind=engine)
    session = Session()
    self.mac_to_port[packet.src]=packet_in.in_port
    if(self.matrix.get((packet.src,packet.dst))==None):
            # create a Session
            #print "creating a db session"
            #Session = sessionmaker(bind=engine)
            #session = Session()        
            self.matrix[(packet.src,packet.dst)]=0
            # Create an entry with address and port
            print "creating a new db entry"
            entry = SourcetoPort(src_address="packet.src" , port_no=packet_in.in_port)
            # Add the record to the session object
            session.add(entry)
            session.commit()
    self.matrix[(packet.src,packet.dst)]+=1
    #if self.mac_to_port.get(packet.dst)!=None:
    if session.query(SourcetoPort).filter_by(src_address=packet.dst).all():
      #send this packet
      self.send_packet(packet_in.buffer_id, packet_in.data,self.mac_to_port[packet.dst], packet_in.in_port)
      #create a flow modification message
      msg = of.ofp_flow_mod()
      #set the fields to match from the incoming packet
      msg.match = of.ofp_match.from_packet(packet)

      #print "SENDING  TO PORT " + str(self.mac_to_port[packet.dst]), packet.dst
      # send the rule to the switch so that it does not query the controller again.
      msg.actions.append(of.ofp_action_output(port=self.mac_to_port[packet.dst]))
      # push the rule
      self.connection.send(msg)

    else:
      #print 'flooding the packet '
      # Flood this packet out as we don't know about this node.
      self.send_packet(packet_in.buffer_id, packet_in.data,
                       of.OFPP_FLOOD, packet_in.in_port) 
```

在上面的代码行

```
if session.query(SourcetoPort).filter_by(src_address='packet.dst').all(): 
```

不像我预期的那样工作。我期望它应该从 sqlalchemy 数据库中检索条目，如果它成功（因为输出不是 NONE）它应该执行以下代码。

当我尝试使用 print 打印该行时

```
 print "session query", session.query(SourcetoPort).filter_by(src_address='packet.dst').all() 
```

我得到的输出是

```
session query  [] 
```

我是不是做错了什么。如果有人能指出这一点，那就太好了。

如果我根据建议更改上述行

```
print session.query(SourcetoPort).filter_by(src_address=packet.dst).count() 
```

我收到以下错误：

```
creating a new db entry
RECIEVED FROM PORT  2 SOURCE  96:74:ba:a9:92:b9
creating a new db entry

ERROR:core:Exception while handling Connection!PacketIn...
Traceback (most recent call last):
  File "ws_thesis/pox/pox/lib/revent/revent.py", line 234, in raiseEventNoErrors
    return self.raiseEvent(event, *args, **kw)
  File "ws_thesis/pox/pox/lib/revent/revent.py", line 281, in raiseEvent
    rv = event._invoke(handler, *args, **kw)
  File "ws_thesis/pox/pox/lib/revent/revent.py", line 159, in _invoke
    return handler(self, *args, **kw)
  File "ws_thesis/pox/tutorial.py", line 137, in _handle_PacketIn
    self.act_like_switch(packet, packet_in)
  File "ws_thesis/pox/tutorial.py", line 101, in act_like_switch
    print session.query(SourcetoPort).filter_by(src_address=packet.dst).count()
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2400, in count
    return self.from_self(col).scalar()
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2045, in scalar
    ret = self.one()
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2014, in one
    ret = list(self)
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2057, in __iter__
    return self._execute_and_instances(context)
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2072, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1405, in execute 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:33:24.267

如果要按*变量*的内容过滤项目，则需要直接使用该变量：

```
session.query(SourcetoPort).filter_by(src_address=packet.dst) 
```

相反，您试图按字符串过滤`'packet.dst'`。

您在*创建*`SourcetoPort`条目时犯了同样的错误；您可能想存储`packet.src`表达式的结果，而不是字符串`'packet.src'`：

```
SourcetoPort(src_address=packet.src, port_no=packet_in.in_port) 
```

请注意，调用`.all()`会从数据库中检索所有匹配的条目，但您只是在`if`测试中使用它。使用而不是让数据库告诉我们有多少项目匹配会更有效（可能更有效*） ：*`.count()``.all()`

```
if session.query(SourcetoPort).filter_by(src_address=packet.dst).count(): 
```

# c - 当我解除分配字符串数组时，我的程序崩溃

> ID：16004556
> 
> 赞同：0
> 
> 时间：2013-04-14T21:31:06.850
> 
> 标签：c

我需要分配一个字符串数组。长度为 100，每个单元格可以包含 100 个字符的字符串。

```
typedef char* (*Encryptor3)(char*, char);
char** encryptToString(char** input,int length,int first,Encryptor3 encryptor)
{
int i=0;
char** output=(char **)malloc(sizeof(char*)*length);
for(i=0;i<length;i++){
    output[i]=(char *)malloc(sizeof(char)*(100+1));
}
output[0]=encryptor(first,input[0]);
output[1]=encryptor(first,input[1]);

for(i=2; i<length ; i++)
{
    output[i]=encryptor(output[i-2],input[i]);
}
return output;
}

int main()
{
    char plain[] = {'p','l','a','i','n','t','e','x','t'};
    char** outputS = encryptToString(plain, 9, "test", idenString);
    int i;
    for(i=0; i<9; i++)
        printf("%s\n", outputS[i]);
    for(i=0; i<9; i++) //deallocating my array of strings
        free(outputS[i]);
    free(outputS);
    return 0;
} 
```

“free(outputS[i]);”这一行 会使程序崩溃，我会收到一个普通错误，说“myp.exe 已停止工作”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T07:09:05.503

代替

```
output[...]=encryptor(...); 
```

做：

```
strcpy(output[...], encryptor(...)); 
```

这假设使用的缓冲区`encryptor()`是静态的。

还要确保返回的字符串`encryptor()`不大于分配给 引用的指针的字符串`output`，即 100 个字符，不包括尾随的零终止符。

# java - Java GUI 输入文本框

> ID：16004557
> 
> 赞同：0
> 
> 时间：2013-04-14T21:31:33.477
> 
> 标签：java, swing, user-interface

我正在设计一个模拟自动售货机的程序。您知道自动售货机如何拥有一个大文本框来显示您需要知道的任何信息……这就是我想要做的。所以基本上，如果用户点击一个按钮，如果该项目不在商店，过期，他们没有足够的信用，无论如何，消息应该显示在这个框中。

然后，在一两秒后，返回显示用户投入机器的金额。我还想制作这个框，以便在文本框旁边有一个按钮可以单击以插入钱。当他们点击那个时，我想让文本框可编辑，然后他们输入他们想要输入的金额，然后再次按插入，钱就被插入了。文本框再次变得不可编辑，并显示他们在机器中的信用。

有人对如何做到这一点有任何建议吗？

我还想知道如何在摆脱消息并返回在机器中显示信用之前实现延迟。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:41:04.203

正如 Andrew Thompson 所说，您将使用 JTextField。使用 setText() 方法设置所需的文本，然后您可以使用睡眠功能（usleep() 我认为应该适用于您的应用程序），然后再次将文本设置回美元值。

编辑：没有看到后半部分。要完全启用和禁用文本字段，请使用 setEnabled(true/false)，要阻止其可编辑，请使用 setEditable(true/false)

另外，只是想一想，您可以以时间戳格式获取当前日期，然后进入一个循环，在该循环中不断获取时间戳并将其与第一个时间戳进行比较。如果达到所需的差异，则退出循环并更新文本字段。查看 Date 的 Java 文档；)

# regex - 捕获有关文件和找到的正则表达式的信息

> ID：16004562
> 
> 赞同：0
> 
> 时间：2013-04-14T21:32:11.973
> 
> 标签：regex, bash, grep

我有一个充满文件的目录，其中包含我要捕获的数字。我还想知道哪些数字来自哪些特定文件。现在我正在运行 grep，它会输出如下内容：

```
grep ./* -e 'expression'
./file1: expression numberA
./file1: expression numberB
./file1: expression numberA
./file2: expression numberC numberD
... 
```

我想要的是提取一段文件名（在本例中，文件 1 为 1），以及出现在我的表达式之后的所有数字。

虽然我更喜欢在 bash 中做所有事情，但欢迎任何解决方案。

编辑：为了清楚起见，我想输出以下内容：

```
file1:
numberA
numberB
file2:
numberC
numberD
... 
```

我还编辑了前面的部分（./file1: 表达式 numberA）。抱歉之前没有说清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:57:48.313

尝试这个：

```
grep -e 'expression' * | perl -pe 's/^(.*?)(\d+)(:.*)$/$1$2$3 $2/' 
```

这应该产生所有输入行。如果输入行的文件名部分以数字结尾，则该数字应附加到输入行。

`$1`,`$2`并且`$3`是对 3 个子表达式（括号中的正则表达式的那些部分）的反向引用。

命令行开关`-e`指示 Perl 解释器执行给定的表达式。`-p`循环输入并打印`$_`.

但是，由于您还想要比赛后的所有数字，您可能需要更复杂的东西：

```
grep -e 'expression' * | perl -ne '
  chomp;
  ($a,$b) = split ":";
  $a =~ s/.*(\d+)$/$1/;
  $b =~ s/.*expression(.*)/$1/;
  $b =~ s/[^\d]+/ /g;
  print "$_ $a $b\n";
' 
```

`-n`与 相同`-p`，只是没有隐式打印`$_`。

**编辑：**在阅读了您更新的要求后，我认为您最好使用全 Perl 解决方案。

```
#!/usr/bin/env perl

use strict;
use warnings;

foreach (@ARGV) {
  my $file = $_;
  open FILE, "<$file" or die "Can't open file $file.";
  my $first = 1;
  foreach (<FILE>) {
    if (m/expression(.*)/) {
      my $values = $1;
      if ($first) {
        print "$file:\n";
        $first = 0;
      }
      $values =~ s/(^ +| +$)//g;
      $values =~ s/ +/\n/g;
      print "$values\n";
    }
  }
  close FILE;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:57:33.747

感谢回答的两位-根据你们俩给我的信息，我能够找到一个完美的解决方案：

```
grep -i expression ./* | perl -pe 's/.*(\d+).*:.*(\d+)/$1 $2/' | sort | uniq 
```

这给出了输出：

```
1 numberA
1 numberB
2 numberC numberD 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T20:48:14.213

我认为在这种情况下不需要 grep 。需要用awk或perl来积累数据，这样就可以在文件中查找表达式了。这是一个 awk 示例：

```
awk '/expression/ {f[FILENAME]; for(i=2;i<=NF;++i) v[FILENAME,$i]} 
END {for(i in f) {print i":"; for(j in v) if(sub("^"i SUBSEP,"",j))print j}}' ./* 
```

输出

```
file1:
numberB
numberA
file2:
numberD
numberC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T09:40:38.660

如果您只想查看文件编号和编号，您可以使用以下内容：

```
find . -exec sh -c "echo -n \;{}::;grep -e 'expression' {}" \; | perl -pe 's/^.*(\d+)::/File \1:\n/' | perl -pe 's/\D*(\d+)$/\1/' 
```

**注意：**如果您的表达式包含`::number`（用作分隔符，可以更改），这将中断。如果未找到匹配项，则打印最后一个文件名。

会产生：

```
File 2:
878
File 3:
199
File 4:
123
234
9
0 
```

示例文件 2：

```
foo 123
bar 123
expression 878
lorem ipsum 
```

如果您只想要数字对（文件号+数字），那么您可以尝试：

```
grep ./* -e 'expression' | perl -pe 's/^.*?(\d+):.*?(\d+)$/\1 \2/' 
```

输出：

```
2 878
3 199
4 123
4 234
4 9
4 0 
```

正如我在评论中提到的，您的问题对于您想要的内容有些不清楚。提供一些示例将是有益的。

# javascript - AngularJS 流沙

> ID：16004569
> 
> 赞同：5
> 
> 时间：2013-04-14T21:32:45.793
> 
> 标签：javascript, jquery, angularjs, quicksand

有没有办法在 Angular中实现 jQuery 的[流沙插件？](http://razorjack.net/quicksand/)也许有一个实现，但我似乎找不到它。

也许这样做的策略会对我有所帮助，因为流沙需要一个列表，然后将新列表作为参数接收，但是对于 Angular 重新渲染数据的方式，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-13T21:38:50.560

我使用 masonry 指令 + ng-animate 为进入/离开动画实现了类似的东西，这是一个仅 CSS 动画的演示（带有 chrome 供应商前缀的 CSS）：

[http://jsfiddle.net/g/3SH7a/](http://jsfiddle.net/g/3SH7a/)

指令：

```
angular.module('app', [])
.directive("masonry", function () {
    var NGREPEAT_SOURCE_RE = '<!-- ngRepeat: ((.*) in ((.*?)( track by (.*))?)) -->';
    return {
        compile: function(element, attrs) {
            // auto add animation to brick element
            var animation = attrs.ngAnimate || "'masonry'";
            var $brick = element.children();
            $brick.attr("ng-animate", animation);

            // generate item selector (exclude leaving items)
            var type = $brick.prop('tagName');
            var itemSelector = type+":not([class$='-leave-active'])";

            return function (scope, element, attrs) {
                var options = angular.extend({
                    itemSelector: itemSelector
                }, attrs.masonry);

                // try to infer model from ngRepeat
                if (!options.model) { 
                    var ngRepeatMatch = element.html().match(NGREPEAT_SOURCE_RE);
                    if (ngRepeatMatch) {
                        options.model = ngRepeatMatch[4];
                    }
                }

                // initial animation
                element.addClass('masonry');

                // Wait inside directives to render
                setTimeout(function () {
                    element.masonry(options);

                    element.on("$destroy", function () {
                        element.masonry('destroy')
                    });

                    if (options.model) {
                        scope.$apply(function() {
                            scope.$watchCollection(options.model, function (_new, _old) {
                                if(_new == _old) return;

                                // Wait inside directives to render
                                setTimeout(function () {
                                    element.masonry("reload");
                                });
                            });
                        });
                    }
                });
            };
        }
    };
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T11:25:17.887

您需要添加一个[指令](http://www.adobe.com/devnet/html5/articles/angularjs-directives-and-the-computer-science-of-javascript.html)来执行此操作。

因此，仅使用 jQuery，您将拥有：

**JS**

```
$('#source').quicksand( $('#destination li') ); 
```

**HTML**

```
<ul id="source">
  <li data-id="iphone">iOS</li>
  <li data-id="android">Android</li>
  <li data-id="winmo">Windows Phone 7</li>
</ul>

<ul id="destination" class="hidden">
  <li data-id="macosx">Mac OS X</li>
  <li data-id="macos9">Mac OS 9</li>
  <li data-id="iphone">iOS</li>
</ul> 
```

使用 Angular，您可以：

**JS**

```
yourApp.directive('jqQuicksand', function(){
    var linkFn = function(scope,element,attrs){
        // element here = $(this)
        // bind your plugin or events (click, hover etc.) here
        element.quicksand( $(attrs.jqQuicksand) );
    }

    return {
        restrict:'A',
        scope: {},
        link: linkFn
    }
}); 
```

**HTML**

```
<ul data-jq-quicksand="#destination li" id="source">
  <li data-id="iphone">iOS</li>
  <li data-id="android">Android</li>
  <li data-id="winmo">Windows Phone 7</li>
</ul>

<ul id="destination" class="hidden">
  <li data-id="macosx">Mac OS X</li>
  <li data-id="macos9">Mac OS 9</li>
  <li data-id="iphone">iOS</li>
</ul> 
```

请注意，这是未经测试的，但应该没问题。

# android - 无法从 LG 设备发送短信

> ID：16004570
> 
> 赞同：1
> 
> 时间：2013-04-14T21:32:46.547
> 
> 标签：android, sms, lg

我的应用程序正在发送自动短信。问题是它适用于所有手机，但不适用于 LG 设备。那是我的代码：

```
private void sendSMS(String phoneNumber, String message) {
    SmsManager sms = SmsManager.getDefault();
    ArrayList<String> parts = sms.divideMessage(message);
    sms.sendMultipartTextMessage(phoneNumber, null, parts, null,
                null);
} 
```

这就是错误日志：

```
java.lang.NullPointerException
at com.lge.mdm.uimanager.adapter.LGMDMUIMessageAdapter.isAllowSendMessage(LGMDMUIMessageAdapter.java:50)
at com.lge.mdm.MDMInterfaceImpl.isAllowSendMessage(MDMInterfaceImpl.java:108)
at android.telephony.SmsManager.sendMultipartTextMessage(SmsManager.java:354)
at berg.royi.donotdisturbe.free.service.DNDservice.sendSMS(DNDservice.java:120)
at berg.royi.donotdisturbe.free.service.DNDservice.onHandleIntent(DNDservice.java:95)
at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:65)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.os.HandlerThread.run(HandlerThread.java:60) 
```

这是什么“LGMDMUIMessageAdapter.isAllowSendMessage”？我该如何允许？我看到一些关于在从 LG 设备发送短信时需要添加可选字段的问题，但仅此而已，没有其他解释。谢谢！

# java - 使用 getColumnDisplaySize() 来保持整洁？

> ID：16004576
> 
> 赞同：2
> 
> 时间：2013-04-14T21:33:05.260
> 
> 标签：java, sql, jdbc, metadata, resultset

我想知道您是否可以使用`getColumnDisplaySize()`生成一个更整洁的表格，并将结果放在正确的列中，我该怎么做？

这是我目前的代码。

```
stmt = con.createStatement();  
ResultSet res = stmt.executeQuery("SELECT * FROM Orders ORDER BY OrderID");

if (res.next()) {
    ResultSetMetaData rsmd = res.getMetaData();
    int columnCount = rsmd.getColumnCount();
    for (int i = 1; i <= columnCount; i++) {
        columnHeading = columnHeading + "\t" + rsmd.getColumnName(i);
    }
    System.out.println(columnHeading);

    do {
        for (int i = 1; i <= columnCount; i++) {                            
            System.out.print("\t" + res.getString(i));
        }
        System.out.println("\n");
    } while(res.next());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T12:23:57.793

我不会那样做的。

该`getcolumnDisplaySize()`方法为您提供由 (SQL) 列类型指定的列宽。这与任何给定时间表中最大值的宽度几乎没有关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T23:47:38.587

如果您想手动设置表格列的大小，请阅读 Swing 教程中关于[设置和更改列宽](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#width)的部分。

如果你想自动计算列的大小，那么你可以试试[Table Column Adjuster](http://tips4java.wordpress.com/2008/11/10/table-column-adjuster/)。

# android - 不幸的是，android已经停止了

> ID：16004577
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:33:07.600
> 
> 标签：android, eclipse, android-intent, android-emulator

我是新来的，我想找到一些解决方案。每次单击登录按钮时，我总是有一个错误提示“不幸的是，android 已停止”，我想不出我有任何错误。

> 第一个.java

```
 package com.example.android;

            import android.os.Bundle;
            import android.app.Activity;
            import android.view.Menu;
            import android.view.View;
            import android.view.View.OnClickListener;
            import android.widget.*;
            import android.content.Intent;

            public class First extends Activity {

                @Override
                public void onCreate(Bundle savedInstanceState) {
                    super.onCreate(savedInstanceState);
                    setContentView(R.layout.firstlayout);
                    Button admin = (Button) findViewById (R.id.admin);
                    admin.setOnClickListener(new OnClickListener(){

                @Override
                public void onClick(View arg0) {
                    // TODO Auto-generated method stub
                    Intent it = new Intent (First.this, Secondadmin.class);
                    startActivity(it);
                    System.exit(0);

                }

                    });

                    Button sec = (Button) findViewById(R.id.sec);
                    sec.setOnClickListener(new OnClickListener(){

                        public void onClick(View arg0) {
                            // TODO Auto-generated method stub
                        Intent is = new Intent(First.this, Secondsec.class);
                            startActivity(is);
                            System.exit(0);
                        }

                    });

                    Button stock = (Button) findViewById (R.id.stock);
                    stock.setOnClickListener(new OnClickListener () {

                        @Override
                        public void onClick(View v) {
                            // TODO Auto-generated method stub
                        Intent iu= new Intent(First.this,Secondstock.class);
                            startActivity(iu);
                            System.exit(0);
                        }

                    });

                }

                @Override
                public boolean onCreateOptionsMenu(Menu menu) {
                    // Inflate the menu; this adds items to the action bar if it is present.
                    getMenuInflater().inflate(R.menu.first, menu);
                    return true;
                }

            } 
```

> 第一个布局.xml

```
 <?xml version="1.0" encoding="utf-8"?>
        <LinearLayout
            android:id="@+id/widget32"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            xmlns:android="http://schemas.android.com/apk/res/android">
        <Button
            android:id="@+id/admin"
            android:layout_width="130dp"
            android:layout_height="wrap_content"
            android:text="ADMIN" />
        <Button
            android:id="@+id/sec"
            android:layout_width="130dp"
            android:layout_height="wrap_content"
            android:text="SECRETARY" />
        <Button
            android:id="@+id/stock"
            android:layout_width="130dp"
            android:layout_height="wrap_content"
            android:text="CHECKERS" />
        </LinearLayout> 
```

> 第二个admin.java

```
 package com.example.android;

        import android.app.Activity;
        import android.app.AlertDialog;
        import android.os.Bundle;
        import android.widget.Button;

        import android.view.View.OnClickListener;
        import android.view.View;
        import android.content.DialogInterface;
        import android.content.Intent;

        public class Secondadmin extends Activity {

            @Override
            public void onCreate(Bundle savedInstanceState){
                super.onCreate(savedInstanceState);
                setContentView(R.layout.secondlayout);

                 Button login= (Button) findViewById (R.id.login);
                    login.setOnClickListener(new OnClickListener(){

                        @Override
                        public void onClick(View arg0) {

                        // TODO Auto-generated method stub

                            {    

                                 Intent log = new Intent(Secondadmin.this, Thirdadmin.class);
                                 startActivity(log);
                            }
                        }
                        });

                Button exit = (Button) findViewById (R.id.exit);
                exit.setOnClickListener(new OnClickListener() {

                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub
                        AlertDialog.Builder builder = new AlertDialog.Builder(Secondadmin.this);
                        builder.setMessage("Are you sure you want to exit?");

                        builder.setPositiveButton("Yes", new DialogInterface.OnClickListener () {

                            public void onClick(DialogInterface arg0, int arg1) {
                                Secondadmin.this.finish();
                                System.exit(0);
                            }
                        });

                builder.setNegativeButton("No", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int arg1) {
                        dialog.cancel();
                        }
                    });
                AlertDialog alert= builder.create();
                alert.show();
                }});
                     Button back= (Button) findViewById (R.id.back);
                     back.setOnClickListener(new OnClickListener(){

                        @Override
                        public void onClick(View arg0) {
                            // TODO Auto-generated method stub
                            Intent is = new Intent (Secondadmin.this, First.class);
                             startActivity(is);
                         }
                });

        }

        } 
```

> secondlayout.xml

```
<?xml version="1.0" encoding="utf-8"?>
        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="91dp"
                android:layout_height="wrap_content"
                android:text="Password" />

            <EditText
                android:id="@+id/password"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="textPassword" >

                <requestFocus />
            </EditText>
            <Button 
                android:id="@+id/login"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Login" />
            <Button
                android:id="@+id/back"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Back" />

            <Button
                android:id="@+id/exit"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Exit" />

        </LinearLayout> 
```

> 第三个admin.java

```
 package com.example.android;

        import android.os.Bundle;
        import android.app.Activity;
        import android.app.AlertDialog;
        import android.content.DialogInterface;
        import android.content.Intent;
        import android.widget.Button;
        import android.view.View;
        import android.view.View.OnClickListener;

        public class Thirdadmin extends Activity {

            @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.thirdlayoutadmin);

                Button view= (Button)findViewById(R.id.view);
                view.setOnClickListener(new OnClickListener(){

                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub

                    Intent id= new Intent(Thirdadmin.this, Fourthview.class);
                    startActivity(id);

                }
            });
                Button update= (Button)findViewById(R.id.update);
                update.setOnClickListener(new OnClickListener(){

                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub

                    Intent i= new Intent(Thirdadmin.this, Fourthupdate.class);
                    startActivity(i);

                }
            });

                Button add= (Button) findViewById (R.id.add);
                add.setOnClickListener(new OnClickListener(){

                    @Override
                    public void onClick(View v) {
                        // TODO Auto-generated method stub

                            Intent it= new Intent(Thirdadmin.this, Fourthadmin.class);
                            startActivity(it);
                        }

                    });

                Button delete= (Button) findViewById (R.id.delete);
                delete.setOnClickListener(new OnClickListener() {

                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub
                        Intent t= new Intent(Thirdadmin.this, Fourthdelete.class);
                        startActivity(t);
                    }

                });
                Button exit = (Button) findViewById (R.id.exit);
                exit.setOnClickListener(new OnClickListener(){

                    @Override
                    public void onClick(View arg0) {
                        // TODO Auto-generated method stub
                        AlertDialog.Builder builder = new AlertDialog.Builder(Thirdadmin.this);
                        builder.setMessage("Are you sure you want to exit?");

                        builder.setPositiveButton("Yes", new DialogInterface.OnClickListener () {

                            public void onClick(DialogInterface arg0, int arg1) {
                                Thirdadmin.this.finish();
                                System.exit(0);
                            }
                        });

                builder.setNegativeButton("No", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int arg1) {
                        dialog.cancel();
                        }
                    });

                AlertDialog alert= builder.create();
                alert.show();
                }});
                     Button back= (Button) findViewById (R.id.back);
                     back.setOnClickListener(new OnClickListener(){

                        @Override
                        public void onClick(View arg0) {
                            // TODO Auto-generated method stub
                            Intent is = new Intent (Thirdadmin.this, Secondadmin.class);
                             startActivity(is);
                         }
                });

                }   

            } 
```

> 第三个layoutadmin.xml

```
 <?xml version="1.0" encoding="utf-8"?>
        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/add"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:text="Add" />

            <Button
                android:id="@+id/view"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:text="View" />

            <Button
                android:id="@+id/update"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:text="Update" />

            <Button
                android:id="@+id/delete"
                android:layout_width="150dp"
                android:layout_height="wrap_content"
                android:text="Delete"/>

        </LinearLayout> 
```

> 机器人：清单

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.example.android"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-sdk
            android:minSdkVersion="8"
            android:targetSdkVersion="17" />

        <application
            android:allowBackup="true"
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" >
            <activity
                android:name="com.example.android.First"
                android:label="@string/app_name" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
            <activity
                android:name=".Secondadmin"
                android:label="@string/app_name">
                </activity>

            <activity 
                android:name=".Secondsec"
                android:label="@string/app_name">
                </activity>
            <activity 
                android:name=".Secondstock"
                android:label="@string/app_name">
                </activity>
                <activity 
                android:name=".Thirdsec"
                android:label="@string/app_name">
                </activity>
                 <activity 
                android:name=".Thirdstock"
                android:label="@string/app_name">
                </activity>
                 <activity 
                android:name=".Thirdadmin"
                android:label="@string/app_name">
                </activity>
                <activity
                android:name=".Fourthadmin"
                android:label="@string/app_name">     
                </activity>
                <activity
                android:name=".Fourthstock"
                android:label="@string/app_name">     
                </activity>
                <activity
                android:name=".Fourthdelete"
                android:label="@string/app_name"> 
                </activity>
                <activity
                android:name=".Fourthview"
                android:label="@string/app_name">
                </activity>
        </application>

    </manifest> 
```

每次我点击登录按钮时，我总是有一个错误提示“不幸的是，android 已停止”我想不出我有任何错误。

日志猫：

```
04-15 02:29:54.553: W/dalvikvm(790): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
04-15 02:29:54.603: E/AndroidRuntime(790): FATAL EXCEPTION: main
04-15 02:29:54.603: E/AndroidRuntime(790): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.android/com.example.android.Thirdadmin}: java.lang.NullPointerException
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.os.Looper.loop(Looper.java:137)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread.main(ActivityThread.java:5041)
04-15 02:29:54.603: E/AndroidRuntime(790):  at java.lang.reflect.Method.invokeNative(Native Method)
04-15 02:29:54.603: E/AndroidRuntime(790):  at java.lang.reflect.Method.invoke(Method.java:511)
04-15 02:29:54.603: E/AndroidRuntime(790):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-15 02:29:54.603: E/AndroidRuntime(790):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-15 02:29:54.603: E/AndroidRuntime(790):  at dalvik.system.NativeStart.main(Native Method)
04-15 02:29:54.603: E/AndroidRuntime(790): Caused by: java.lang.NullPointerException
04-15 02:29:54.603: E/AndroidRuntime(790):  at com.example.android.Thirdadmin.onCreate(Thirdadmin.java:73)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.Activity.performCreate(Activity.java:5104)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-15 02:29:54.603: E/AndroidRuntime(790):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-15 02:29:54.603: E/AndroidRuntime(790):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:37:58.290

你不应该使用`System.exit(0);`. 改为使用`finish()`。

# c - 简单宏扩展中令人困惑的 gcc 错误消息

> ID：16004579
> 
> 赞同：0
> 
> 时间：2013-04-14T21:33:17.407
> 
> 标签：c, gcc, macros, c-preprocessor

我一直在看这个太久了，只是看不出问题是什么：

```
#include <stdio.h>

typedef struct {
    int a;
    int b;
} S;

#define F(a,b) ( v.a = a, v.b = b, v )

int main(void) {
    S s, v;

    s = ( v.a = 1, v.b = 2, v ); // this works as expected

    printf("s = { %d %d } \n", s.a, s.b);

    s = F(1, 2); // but gcc complains about the macro equivalent

    printf("s = { %d %d } \n", s.a, s.b);

    return 0;
} 
```

gcc 抱怨：

> 在函数'main'中：
> 第 17 行：错误：数字常量之前的预期标识符

预处理后这两个任务应该是相同的，但显然我错过了一些东西......

您可以在此处运行代码：http: [//codepad.org/0c1aUBLm](http://codepad.org/0c1aUBLm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:35:09.860

```
#define F(a,b) ( v.a = a, v.b = b, v ) 
```

当使用 1 和 2 作为参数调用时，这将扩展为

```
( v.1 = 1, v.2 = 2, v) 
```

将宏的参数名称更改为不同的名称：

```
#define F(first,second) ( v.a = first, v.b = second, v ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:35:26.410

不会`F(1, 2)`扩展到`( v.1 = 1, v.2 = 2, v )`?

```
#define F(x,y) ( v.a = x, v.b = y, v ) 
```

应该更好

# java - Java提取字符串的一部分

> ID：16004586
> 
> 赞同：0
> 
> 时间：2013-04-14T21:34:01.080
> 
> 标签：java, string, extract

我想`0.81`从以下字符串中提取值，但我不知道如何。使用 JSON 不起作用，因为据我所知它不是正确的 JSON 代码。

> [{"boundingbox":{"size":{"height":239.23,"width":239.23},"tl":{"y":46.15,"x":166.92}},"name":"152 :0.81,","信心":0.9}]

你知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:37:56.067

如果这是 JSON，它看起来是，将其加载为 JSON 对象并

```
JSONArray jsonArray = new JSONArray(thatString);
JSONObject jObj = jsonArray.getJSONObject(0);
String name = jObj.getString("name"); 
```

然后它会给你一个字符串“152：0.81”，一个奇怪的名字 - 但是我会拆分它：

```
String[] tokens = name.split(":"); 
```

令牌[0] 将是 152

令牌[1] 将是 0.81，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:37:04.693

它实际上是有效的 Json，因此您可以使用 Json 库（其中任何一个）将 Json 加载到对象并访问该值 - 如果您在将其加载到对象时遇到问题，也许您可​​以更改您的问题并显示我们的错误？

如果有任何机会，您可能会收到无效 Json 的响应*，*您可以使用正则表达式：

如果你总是有同样的模式，比如：

```
\"name\":\"\d+:(\d\.\d+),\" 
```

您的价值将在于捕获第一组。

如果您不确定如何在 Java 中使用正则表达式，只需搜索 SO 或 Google，这里有大量示例。

# android - LibGdx 和 Gwt：没有可用于类型的源代码

> ID：16004588
> 
> 赞同：7
> 
> 时间：2013-04-14T21:34:04.747
> 
> 标签：android, gwt, inheritance, project, libgdx

我正在尝试启动我的 Html 项目，但我遇到了一些问题。桌面和 Android 项目运行良好。问题是我有另一个项目用作未导入的库或其他项目。

```
[ERROR] [com.mobilecostudios.walkingskeleton.GwtDefinition] - Errors in 'file:/C:/Users/chelo/Documents/mobilecostudios-libgdx/trunk/walkingskeleton/WalkingSkeleton/src/com/mobilecostudios/walkingskeleton/GameLoop.java'
[ERROR] [com.mobilecostudios.walkingskeleton.GwtDefinition] - Line 21: No source code is available for type com.mobilecostudios.gamelibrary.Domain.BaseSprite; did you forget to inherit a required module? 
```

我的项目层次结构是：

*   游戏开发库
*   行走骨架
*   行走骨架-html

我的 gwt.xml 是：

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE module PUBLIC "-//Google Inc.//DTD Google Web Toolkit trunk//EN" "http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd">
<module>
    <inherits name='com.badlogic.gdx.backends.gdx_backends_gwt' />
    <inherits name='GameLoop' />
    <entry-point class='com.mobilecostudios.walkingskeleton.client.GwtLauncher' />
    <set-configuration-property name="gdx.assetpath" value="../WalkingSkeleton-android/assets" />
</module> 
```

我已经将项目添加到构建路径中。我还缺少什么？

构建路径 ![在此处输入图像描述](https://i.stack.imgur.com/DnK1z.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T21:54:48.517

您必须确保还将项目的源代码添加到您的路径中。将在客户端使用的任何 GWT Java 模块都需要提供其源代码。

在你的情况下，

```
<inherits name='GameLoop' /> 
```

应该：

```
<inherits name='com.mobilecostudios.walkingskeleton.GameLoop' /> 
```

还有，`com.mobilecostudios.gamelibrary.Domain.BaseSprite`从哪里来？如果它用于客户端，则需要将其添加到模块`.gwt.xml`文件中。应该是这样的：

```
<inherits name='com.mobilecostudios.gamelibrary.GameLibrary' /> 
```

上面，我假设这`GameLibrary.gwt.xml`是项目的 GWT 模块 XML 文件，其中包含`com.mobilecostudios.gamelibrary.Domain.BaseSprite`.

基本上，当您想在客户端在您自己的项目中使用外部 GWT 模块时，您需要通过将源代码和二进制文件添加到您的构建路径来将其导入您的项目，并且您还需要在`<inherits name='...'>`您`.gwt.xml`的项目文件中添加一个.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-09T18:04:19.123

对于具有多个包的项目，您必须为您正在使用的每个包添加一个 .gwt.xml ：
![为每个包添加一个 xml](https://i.stack.imgur.com/oZx72.png)

如上图所示，我为控制器对象添加了 controller.gwt.xml。为对象添加了 gwt.xml 等等……在这些 .gwt.xml 文件中，您必须编写如下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE module PUBLIC "-//Google Inc.//DTD Google Web Toolkit trunk//EN" "http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd">
<module>
    <source path="com/me/controller" />
</module> 
```

例如，这是我的 controller.gwt.xml，然后将继承标签添加到您的 GwtDefinition.gwt.xml 文件中，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE module PUBLIC "-//Google Inc.//DTD Google Web Toolkit trunk//EN" "http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd">
<module>
    <inherits name='com.badlogic.gdx.backends.gdx_backends_gwt' />
    <inherits name='MyGdxGame' />
    <inherits name='objects' />
    <inherits name='settings' />
    <inherits name='controller' />
    <entry-point class='com.me.mygdxgame.client.GwtLauncher' />
    <set-configuration-property name="gdx.assetpath" value="../cannongame-android/assets" />
</module> 
```

# python - python：检查字典中是否存在多个键的最佳方法是什么？

> ID：16004593
> 
> 赞同：18
> 
> 时间：2013-04-14T21:34:45.603
> 
> 标签：python, dictionary

我的字典看起来像

```
d = {
  'name': 'name',
  'date': 'date',
  'amount': 'amount',
  ...
} 
```

我想测试是否存在`name`，`amount`所以我会做

```
if not `name` in d and not `amount` in d:
  raise ValueError # for example 
```

假设我从 api 获取数据，并且我想测试`10`字典中是否存在字段。

它仍然是寻找的最佳方式吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-14T21:36:48.403

您可以使用`set`交叉点：

```
if not d.viewkeys() & {'amount', 'name'}:
    raise ValueError 
```

在 Python 3 中，这将是：

```
if not d.keys() & {'amount', 'name'}:
    raise ValueError 
```

因为`.keys()`默认返回一个字典视图。[字典视图对象](http://docs.python.org/2/library/stdtypes.html#dictionary-view-objects)（例如由`.viewkeys()`（和`.keys()`在 Python 3 中）返回的）充当集合，并且交集测试非常有效。

Python 2.7 中的演示：

```
>>> d = {
...   'name': 'name',
...   'date': 'date',
...   'amount': 'amount',
... }
>>> not d.viewkeys() & {'amount', 'name'}
False
>>> del d['name']
>>> not d.viewkeys() & {'amount', 'name'}
False
>>> del d['amount']
>>> not d.viewkeys() & {'amount', 'name'}
True 
```

请注意，仅当*两个*键都丢失时才测试 True。如果缺少*任何一个，您需要通过测试，请使用：*

```
if not d.viewkeys() >= {'amount', 'name'}:
    raise ValueError 
```

仅当*两个*键都存在时才为 False：

```
>>> d = {
...   'name': 'name',
...   'date': 'date',
...   'amount': 'amount',
... }
>>> not d.viewkeys() >= {'amount', 'name'}
False
>>> del d['amount']
>>> not d.viewkeys() >= {'amount', 'name'})
True 
```

对于*严格*的比较（*只*允许两个键，不多也不少），在 Python 2 中，将字典视图与集合进行比较：

```
if d.viewkeys() != {'amount', 'name'}:
    raise ValueError 
```

（所以在 Python 3 中就是这样`if d.keys() != {'amount', 'name'}`）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-14T21:35:47.910

```
if all(k not in d for k in ('name', 'amount')):
    raise ValueError 
```

或者

```
if all(k in d for k in ('name', 'amount')):
    # do stuff 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-14T21:39:51.273

您也可以使用 set 为：

```
>>> d = {
  'name': 'name',
  'date': 'date',
  'amount': 'amount',
}
>>> test = set(['name','date'])
>>> test.issubset(set(d.keys()))
True 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T22:08:42.247

我喜欢这种形式：

```
>>> d = {
...   'name': 'name',
...   'date': 'date',
...   'amount': 'amount'
... }
>>> tests={'name','date'}
>>> if any(test not in d for test in tests):
...    raise ValueError
>>> # no error...

>>> del d['name']
>>> if any(test not in d for test in tests):
...    raise ValueError
... 
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
ValueError 
```

适用于 Py 2 或 Py 3

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-28T00:56:23.607

为了获得最大效率，您希望避免构造不必要的临时`set`s（所有非比较二元运算符都需要）。您可以这样做：

```
if name not in d and amount not in d: 
```

和：

```
if d.keys().isdisjoint(("amount", "name")): 
```

但这可能是错误的逻辑（在这两种情况下），因为它仅在*两个*`if`键都丢失时才进入正文（并引发异常） ，并且如果*其中一个*键丢失，您可能希望引发异常。

 **对于更可能的拒绝逻辑，`d`除非它包含*两个*键，否则您需要这样：

```
if name not in d or amount not in d: 
```

这可以通过这种方式通过集合操作来完成：

首先，您需要预先定义（在函数之外避免重复构建集合）：

```
required_keys = frozenset({"amount", "name"}) 
```

然后做：

```
if not d.keys() >= required_keys: 
```

两种解决方案 (`isdisjoint`和`>=`) 都避免构建每个测试临时集，并且应该尽可能高效地运行（一旦发现缺少单个键就短路，并且只需要`O(1)`在两个键都存在时进行查找）。就个人而言，对于只有两个键，我会坚持使用`if name not in d or amount not in d:`，但如果键的数量增加，当然可以使用类似集合的操作。**

# jsf-2 - dispatcherTypes = {DispatcherType.REQUEST} 上的 nullpointerexception 使用漂亮的面孔

> ID：16004596
> 
> 赞同：1
> 
> 时间：2013-04-14T21:35:20.237
> 
> 标签：jsf-2, primefaces, filter, servlet-filters, prettyfaces

嗨，我正在使用 jsf2.0，prettyfaces，primesfaces

我创建了一个过滤器来监控用户会话

```
@WebFilter(urlPatterns= {"*.xhtml"} , dispatcherTypes = {DispatcherType.REQUEST})
public class Authentication implements Filter {

@Override
public void init(FilterConfig config) throws ServletException {
System.out.println("[Authentication Filter] : init Method");
}
@Override
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {
HttpServletRequest request = (HttpServletRequest) req;
HttpServletResponse response = (HttpServletResponse) res;
HttpSession session = request.getSession(false);
PrettyContext context = PrettyContext.getCurrentInstance(request);      
if (!(context.getCurrentMapping().getId().equals("login")) && (session == null || session.getAttribute("username") == null)) {
{
response.sendRedirect(request.getContextPath()+"/login");
}
else {
chain.doFilter(req, res); // Logged-in user found, so just continue request.
}
@Override
public void destroy() {}
} 
```

web.xml

```
<welcome-file-list>
<welcome-file>/</welcome-file>
</welcome-file-list>
<servlet>
<servlet-name>Faces Servlet</servlet-name>
<servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
<load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
<servlet-name>Faces Servlet</servlet-name>
<url-pattern>/faces/*</url-pattern>
</servlet-mapping>
<servlet-mapping>
<servlet-name>Faces Servlet</servlet-name>
<url-pattern>*.xhtml</url-pattern>
</servlet-mapping> 
```

漂亮的配置.xml

```
<url-mapping id="home"> 
<pattern value="/" /> 
<view-id value="index.xhtml" />
</url-mapping> 
```

当我使用 dispatcherTypes = {DispatcherType.REQUEST} 我在 context.getCurrentMapping().getId() 上得到空指针异常，该语句在 if 语句中使用，见上文，但是当我 dispatcherTypes = {DispatcherType.FORWARD} 它对我来说工作正常发生了什么事可以指导我吗？谢谢，我想知道 DispatcherType.REQUEST 和 DispatcherType.FORWARD 之间的区别，另一个问题是当我使用 FacesContext.getCurrentInstance().getExternalContext().invalidateSession(); 用于销毁会话，如果我从浏览器按 BACK 按钮，它会将我带到上一页，为什么浏览器会显示我的隐私页面？，我想在 BAck 按钮上登录页面，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T05:45:35.000

PrettyFaces 通过在 Servlet 过滤器中拦截传入的请求，然后将其*转发*到真实的 URL 来实现 URL 重写。

过滤器`DispatchType`的 配置过滤器应该应用于哪种请求。默认值是`REQUEST`通常的情况。如果将其设置`FORWARD`为仅适用于内部转发的请求（PrettyFaces 就是这样做的）。

如果`REQUEST`您获得 NPE，因为您的过滤器在 PrettyFaces 过滤器之前执行，因此您无法访问`PrettyContext`.

在您的情况下使用它绝对没问题`FORWARD`。您唯一需要记住的是，`HttpServletRequest.getRequestURI()`它将返回*真实的*URL，而不是转发请求的漂亮 URL。

您的后退按钮问题可能与缓存有关。如果您没有设置正确的缓存头，浏览器将缓存最后一页，因此按 BACK 将简单地重新显示最后一页，而不向服务器发送请求。

# iphone - 创建可重用控件

> ID：16004599
> 
> 赞同：0
> 
> 时间：2013-04-14T21:35:37.150
> 
> 标签：iphone, uiview, uiviewcontroller, storyboard, xib

（使用 IOS 6、XCode 4.6、ARC、Storyboard）

我正在尝试创建一个可重用的`UIView`（如 C# 中的用户控件），因为我有两个 viewControllers 具有相同的数据，一个用于输入，另一个用于显示。

我在这里读到，这样做的方法是为 ReusableUIView 创建一个单独的 xib 文件，并为其创建相应的 h + m 文件。添加所有控件并将出口链接到它们。

在我的故事板中`UIViewController`，`viewDidLoad`我写了以下代码：

```
NSArray *myNibsArray = [[NSBundle mainBundle] loadNibNamed:@"ReusableUIView" owner:self options:nil];
ReusableUIView *myCustomView = [myNibsArray objectAtIndex:0]; 
```

几个问题：

1.  此时没有任何反应，所以我猜我必须以某种方式将 self（UIViewController）与 myCustomView 连接起来
2.  ReusableUIView 是 UIViewController 中的众多控件之一，我该如何设置它的位置
3.  在 xib 文件中，我找不到设置 UIView 大小的方法，以及我们在何处以及何时设置它的大小

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:08:41.883

1.  最好自定义视图加载它的类本身 - 在您的自定义视图类中添加一些静态方法，如下所示：

    > '+' (ReusableUIView *) loadView {
    > 
    > > ReusableUIView *loadedView = nil;
    > > 
    > > NSArray *nibs = [[NSBundle mainBundle] loadNibNamed:@"ReusableUIView" owner:self options:nil];
    > > 
    > > if ([nibs count] > 0) {
    > > 
    > > > 加载视图 = [myNibsArray objectAtIndex:0];
    > > > 
    > > > }
    > > 
    > > 返回加载的视图；
    > 
    > }

2.  由于 ReusableUIView 继承 UIView ，您可以使用 frame 属性轻松配置其大小和位置，并将其添加为父视图的子视图。

3.  我不确定是什么问题，但您可以轻松更改 xib 中的视图大小。

另外，请注意两点：

1.  当您从 nib 加载视图时***- (id) initWithCoder(NSCoder ** )aDecoder**构造方法被调用。因此，如果您需要任何其他设置 - 您必须在此方法中实现 then。
2.  当您使用 xib 和 .h/.m 文件制作自定义视图时，您必须在 xib 中标记您的自定义类，而不是在文件所有者上，而是直接在您的 UIView 上。

# c - C 数组算法中的最大数量

> ID：16004600
> 
> 赞同：0
> 
> 时间：2013-04-14T21:35:37.847
> 
> 标签：c, algorithm

所以，我只是在处理 C 代码，特别是一个接受 3 个参数的函数：一个数组、数组的大小以及您想要返回的最大元素的数量。

这是我的代码：

```
int* findMaxElements(int base_array[],int size_of_base_array, int number_of_elements_to_find);

int main( void )
{

    printf("Find Max Values in an Array\n\n");

    // Set up array

    int kinch[6] = {1,2,3,4,5,6};

    // Pass to function and get a pointer to new array filled with only the max elements

    int *given = findMaxElements(kinch,6,3);

    for(int i = 0; i < 3; i++)
    {
        printf("\nMax Value = %d\n", *(given + i));
    }
    return 0;

}

int* findMaxElements(int base_array[],int size_of_base_array, int number_of_elements_to_find)
{

    // Set up all initial variables

    int i,k,c,position;
    int maximum = 0;

    int returnArray[100];

    /*Actual Algorythm */

    for(i = 0; i < number_of_elements_to_find; i++)
    {

        // Get the max value in the base array

        for(k = 0; k < size_of_base_array; k++)
        {
            if(base_array[k] > maximum)
            {
                maximum = base_array[k];
            }
        }

        // Find the position of the max value

        for(position = 0; position < size_of_base_array; position++)
        {

            if(base_array[position] == maximum)
            {
                break;
            }

        }

        // Delete the maximum value from the array and shift everything

        for(c = position - 1; c < size_of_base_array - 1; c++)
        {
            base_array[c] = base_array[c+1];
        }

        // Reduce the size of the array

        size_of_base_array -= 1;

        // Push max value into return array

        returnArray[i] = maximum;

        // Reset max value

        maximum = 0;
    }

    return returnArray;

} 
```

我感觉函数的某个地方出了点问题。

```
// Set up array

    int kinch[6] = {1,2,3,4,5,6};

    // Pass to function and get a pointer to new array filled with only the max elements

    int *given = findMaxElements(kinch,6,3);

    for(int i = 0; i < 3; i++)
    {
        printf("\nMax Value = %d\n", *(given + i));
    } 
```

这应该输出数字 6、5 和 4，因为它们是数组中最大的三个，但是我得到的输出始终是 6、6 和 6。它有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:39:32.193

这可能不是您唯一的问题，但在线路中

```
for(c = position - 1; c < size_of_base_array - 1; c++)
    {
        base_array[c] = base_array[c+1];
    } 
```

您将元素`[c+1]`（最大值）复制到`[c]`- 所以您不断找到最大值......

您应该从 开始循环`c = position`，而不是`c = position - 1`。

并在用于存储返回值的数组前面添加关键字`static`，以便它们保持有效（这是解决 Jonathan Leffler 发现的问题的一种方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:38:18.517

一个问题是您`returnArray`在函数中返回一个指向局部变量 的指针。你不能可靠地做到这一点——它会导致未定义的行为。

很可能还有其他问题，但这足以成为一个展示者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T21:48:23.220

寻找第 K 个最大元素的整个方法既不高效也不优雅。我会建议你修改你的算法，虽然上面的建议可以正常工作，但这不是解决这个问题的好方法。

我建议您查看以下链接以修改您的算法 [http://www.geeksforgeeks.org/k-largestor-smallest-elements-in-an-array/](http://www.geeksforgeeks.org/k-largestor-smallest-elements-in-an-array/)

# ios - 看不到我的 UICollectionViewCells

> ID：16004602
> 
> 赞同：0
> 
> 时间：2013-04-14T21:35:56.290
> 
> 标签：ios, uicollectionview, uicollectionviewcell

我正在编写一个带有 UICollectionViewController 的应用程序。

我用故事板创建了布局。子类化 UICollectionViewController 并在 IB 中链接两者。我还给它一个 Storyboard ID“ImageCollectionViewController”。

我还对 UICollectionViewCell 进行了子类化，并将其与 IB 中的原型单元链接起来，并为其赋予了标识符“ImageCell”。

这是我用来创建自定义 UICollectionViewController 的构造函数：

```
-(id)initWithGroup:(CatalogGroup*)group
{
    UIStoryboard* storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPad" bundle: nil];
    self = [storyboard instantiateViewControllerWithIdentifier:@"ImageCollectionViewController"];
    if (self) {

        [self setGroup:group];

        // Register the type of cell for collection view
        [self.collectionView registerClass:[ImageCell class] forCellWithReuseIdentifier:@"ImageCell"];
    }

    return self;
} 
```

现在这一切似乎都奏效了。所有的委托方法都在 collectionViewController 中被调用。例如：

```
-(NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
{
    id <NSFetchedResultsSectionInfo> sectionInfo = [[self fetchedResultsController] sections][section];
    return [sectionInfo numberOfObjects];
} 
```

我的单元格正在初始化并通过以下方式传回：

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString* identifier = @"ImageCell";
    ImageCell* cell = [collectionView dequeueReusableCellWithReuseIdentifier:identifier forIndexPath:indexPath];
    ImageItem* item = [[self fetchedResultsController].fetchedObjects objectAtIndex:indexPath.row];

    if(cell) {
        // Set up label
        cell.label.lineBreakMode = NSLineBreakByCharWrapping;
        cell.label.numberOfLines = 0;
        [cell.label setText:item.labelText];

        NSData* imageData = item.imageData;
        UIImage* image = [UIImage imageWithData:imageData];
        UIImageView* imageView = [[UIImageView alloc] initWithImage:image];
        [cell setImageView:imageView];
    }

    return cell;
} 
```

然而，当我将视图控制器推入堆栈时。没有细胞吗？我的堆栈有什么问题吗？

我在 IB 中为 CollectionView 设置的背景颜色正在显示，所以我相信它正在正确创建。单元格被初始化。委托方法被调用，所以我不知道从哪里开始调试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:00:59.580

我不确定您的自定义单元格是什么样子，但一般来说，它应该是 cell.contentView 的子视图：

```
[cell.contentView addSubview:myContentView]; 
```

因此，您可以尝试使用 [cell setImageView:imageView] 而不是

```
[cell.contentView addSubview:imageView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T11:42:12.360

您可以通过在集合视图单元格自定义类中设置单元格的**背景颜色**来测试您的集合视图。这将确保您的单元格配置正确。现在来解决您的问题（这只是一个猜测，因为您没有看到您的单元格类）。如果您在 nib 中设置单元格的图像视图，您应该为单元格 _ *registerNib*而不是 _ *registerClass* _ 。否则，您应该将图像视图作为子视图添加到 cell.contentView

# javascript - JSON.parse 使用嵌套对象解析 JSON

> ID：16004603
> 
> 赞同：10
> 
> 时间：2013-04-14T21:35:58.587
> 
> 标签：javascript, json

我正在尝试使用在发布请求的响应中收到的嵌套对象解析 JSON 字符串。运行后`JSON.parse(responseText)`，结果格式如下：

```
[{
  "atco":"43000156407",
  "location":{
    "longitude":"-1.7876500000000000",
    "latitude":"52.4147200000000000","
    timestamp":"2013-03-19 11:30:00"
   },
  "name":"Solihull Station Interchange",
  "road":"STATION APPROACH",
  "direction":"NA",
  "locality":"Solihull",
  "town":"Solihull"}, ... 
```

我以为我可以使用以下示例提取值，但我得到的只是未定义的。

```
var atco = json[0].atco; 
```

我也尝试过，但这会从 JSON ( )`json[0][0]`返回一个单独的字符。`[`这是否表明 JSON 没有正确解析，或者这是预期的行为，我只是不正确地引用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-14T21:40:45.480

这意味着您的 JSON 被双重编码。确保只在服务器上对其进行一次编码。

作为证据，在你解析它之后，再次解析它。

```
var parsed = JSON.parse(resposneText);

var parsed2 = JSON.parse(parsed);

alert(parsed2.atco); 
```

* * *

要么，要么您正在解析它，然后尝试从原始字符串中选择数据。这显然行不通。

# java - JVM/Java 强制应用程序在首次启动时运行较慢，Windows 8？

> ID：16004607
> 
> 赞同：2
> 
> 时间：2013-04-14T21:36:18.213
> 
> 标签：java, windows, eclipse, aptana, aptana3

我已经尝试了三个 IDE，我相当肯定所有这些 IDE 都需要 Java 才能运行，并且它们在当天的第一次启动时都启动得非常慢（30 秒到 1 分钟）。在那之后，它们都开始快速变亮。

这三个程序是：Aptana Studio 3、Eclipse 和 PHP Webstorm。

根据我的网络搜索，我已经修改了 AptanaStudio3.ini，使用了一些关于如何加快速度的建议，它们都可以工作......对于第一次启动*后*的每次启动，也就是说，但第一次启动一天仍然痛苦而莫名其妙地缓慢。

我已经搜索过，我没有看到任何关于这个问题的问题。如果有人在这里找到答案，非常感谢，但我不能。

我唯一的结论是，这个问题与 Java 在 Windows 8 上的运行方式有关，因为所有三个软件程序都受到了不利影响。这是 Windows 8 上 Java 中的一个已知错误吗？我不知道该怎么想，但如果有人能提供帮助，我将不胜感激。

观察：从我的测试来看，如果我启动我的笔记本电脑，然后在启动的前 10 分钟内启动 Eclipse 或 Aptana，它启动得更快（仍然很慢但没有那么糟糕），然后我要等待大约一个小时，然后启动我的 IDE。不确定这表明什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:23:01.853

尽管您可以调整 Eclipse（或 Aptana）.ini 文件并执行诸如禁用类验证和使用 JVM DLL 引导之类的操作，但这更多地与操作系统和硬件磁盘缓存有关，而不是 JVM。从 Ramdisk 启动每个 IDE，您会发现它们第一次从 RAM 启动的速度与第二次从“磁盘”启动的速度一样快。

资料来源：我已经花了很多时间试图解决这个问题。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-01T15:02:10.113

检查您的防病毒扫描程序行为可能值得 - 我正是这个问题。尽管在 win8 Ultimate 上使用 SSD 和相当快的 i5，但 Eclipse 的首次启动时间是在很多分钟内测量的（可能超过 10 分钟），随后的重启在几十秒内完成。整个 PC 可以在大约半分钟内完全重启，因此不太可能是原始 I/O 问题。

从查看 cpu hogs 并从那里挖掘，似乎 a/v（macafee）在每次启动后都在对所有 eclipse 组件和插件进行访问扫描，我怀疑这是大部分时间都在采取。

当我说服某人从实时扫描中排除 eclipse 和 jvm 时，我会发布更新...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T23:00:51.833

由于 Aptana Studio 是基于 Eclipse 的，因此没有太大的区别。这不是 Windows 8 上 Java 的已知错误，因为我至少已经在 Windows 7 中体验过它。AFAIK 它与第一次启动 JVM 有关。当然，您可以为此投入大量内存或调整 IDE 的 .ini。JVM-startupprocess 不会真正受到影响，它仍然会很慢。对于服务器来说，可以忽略的是桌面上的问题。有关详细信息，请查看[http://en.wikipedia.org/wiki/Java_performance#Startup%5Ftime](http://en.wikipedia.org/wiki/Java_performance#Startup%5Ftime)

# php - Javascript/html 用返回键提交表单？

> ID：16004608
> 
> 赞同：0
> 
> 时间：2013-04-14T21:36:32.090
> 
> 标签：php, javascript, html, forms

我有一个在单击提交时执行 javascript 的表单。当使用返回键 (13) 时，我似乎无法弄清楚如何做同样的事情。

HTML：（注意 MakeRequest() 是一个 JS 方法，它在另一个 php 页面上执行请求并将结果返回给 JSresult。）

```
<form name="SearchForm">
Name: <input type = "text" name = "Name" id="Search"
placeholder="Search stuff here...">
<button type="button" id "Request" onClick="MakeRequest()"">Search</button>

</form>
div id="JSresult">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:44:12.990

将您的按钮替换为提交输入并将函数移动到表单 onSubmit，而不是按钮 onClick ：

```
<form name="SearchForm" onSubmit="MakeRequest();">
    Name: <input type = "text" name = "Name" id="Search" placeholder="Search stuff here..." />
    <input type="submit" id="Request" value="Search" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:53:42.947

这是一种不引人注目的方法，应该可以解决问题：

```
<script>
    window.onload = function(){
        document.getElementById("Search").onkeydown = function(e){
            key = (e.keyCode) ? e.keyCode : e.which;
            if(key == 13) {
                document.getElementById("Request").click();
            }
        };
    };
</script> 
```

只需将其复制到`head`您的 HTML 文件中即可。

# prolog - 为什么这个序言代码只返回一个结果？

> ID：16004609
> 
> 赞同：0
> 
> 时间：2013-04-14T21:36:36.990
> 
> 标签：prolog

我正在为期末考试学习 Prolog，从课程的早期开始，我无法弄清楚我在这个作业问题上做错了什么。

这不完全是一个“家庭作业”问题，它是一个“学习最后一个问题”，所以如果有人能给我一个正确的答案，那将是一个很大的帮助。:(

问题是：

```
%% b) Write a predicate after(X, List, Result) that returns everything 
%% in a list after any occurrence of the given element X.
%% ?- after(a,[b,a,x,d,a,f,g],R).
%% R = [x,d,a,f,g];
%% R = [f,g];
%% no 
```

我的解决方案是这样，但它只返回一个 R 值，而不是两个。

```
after(X,[_,X|R],R).

?- after(a,[b,a,x,d,a,f,g],R).
R = [x, d, a, f, g]. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:46:41.480

几个小时，我一贴在这里就想通了！

仅供参考，这是我的解决方案：

```
after(X,[X|R],R).
after(X,[_|Z],R) :-
    after(X,Z,R). 
```

# mysql - 删除多行

> ID：16004610
> 
> 赞同：1
> 
> 时间：2013-04-14T21:36:38.347
> 
> 标签：mysql, database, pdo

我想删除表参与者投票中 id 与另一个表行的 id 匹配的所有记录。

这可以在一个查询中完成吗？

这是我现在的查询，它返回我的子选择包含多行的错误

> DELETE FROM WHERE `participant_vote`id =（从 WHERE 中选择 id = :facebookid）`vote``facebookid`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:38:27.063

是的。使用`IN`运算符而不是`=`运算符。

```
DELETE FROM participant_vote
WHERE id IN (
    SELECT id
    FROM vote
    WHERE facebookid = :facebookid
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:38:34.277

```
DELETE FROM participant_vote WHERE id IN (SELECT id FROM vote WHERE facebookid = :facebookid) 
```

`IN`是诀窍。我的感觉是，搜索消息也会提供答案。

# lua - 如何使用 socket.select？

> ID：16004612
> 
> 赞同：3
> 
> 时间：2013-04-14T21:36:48.883
> 
> 标签：lua, luasocket

我需要一些使用套接字“选择”功能的帮助。

我的服务器代码是这样的：

```
while true do
    for _,server in pairs(servers) do
        local client = server:accept()

        client:settimeout(5)

        local line, err = client:receive()
        if not err then
            client:send(line .. "_SERVER_SIDE\n")
        else
            client:Send("___ERRORPC"..err)
        end

        client:close()
    end
end 
```

但现在我想使用 select 函数而不是像这样创建一个永远循环。

阅读：[http ://w3.impa.br/~diego/software/luasocket/socket.html](http://w3.impa.br/~diego/software/luasocket/socket.html)

我知道我可以使用类似的东西：

```
socket.select(servers, nil, 5) 
```

但我不知道如何在上面的代码中使用它。谁能帮我？

我将不得不在一段时间内使用这个真实的声明？

读取操作（第一个参数）意味着我只能接受/接收]？而秒参数意味着我只能发送？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T06:36:14.407

根据文档， select 接收一个或两个套接字数组并返回一个可以安全地读取而不会阻塞的套接字数组和一个可以安全地写入而不会阻塞的套接字数组和一个可以安全地写入的套接字数组没有阻塞。重要的一点是，第一个数组用于要调用 accept 的服务器套接字和要调用 receive 的客户端套接字。

秒参数只是选择的超时。这与您可以进行多少次操作无关。

您必须在代码中更改的基本内容是，当接收调用因超时而失败时，您应该将该套接字添加到您传递给选择的套接字数组中。这样，您可以让 select 告诉您该套接字何时再次变为活动状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T19:13:25.370

来自文档`select`：“在调用 accept 之前使用接收参数中的服务器套接字调用 select 并不能保证 accept 将立即返回。使用 settimeout 方法或 accept 可能会永远阻塞。” 这意味着您需要在通话`settimeout`之前使用`accept`，但假设您有一个可以在`servers`表中使用的打开连接列表，您可以通过`select`以下方式使用：

```
local canread = socket.select(servers, nil, 1)
for _,client in ipairs(canread) do
  local line, err = client:receive()
  if not err then
      client:send(line .. "_SERVER_SIDE\n")
  else
      client:send("___ERRORPC"..err)
  end
end 
```

`socket.select`最多会阻塞 1 秒，但如果您提供的列表中有一个可以读取的套接字，则会更快返回。如果您使用`socket.select(servers, nil, 0)`;您可以无限期阻止 如果您在等待输入时需要做一些其他工作，那么阻塞一小段时间很有用。

更新为使用`ipairs`，而不是`pairs`返回表在数字和套接字本身上都键入了键，因此如果可以从中读取一个套接字，则返回的数组看起来像`{[1] = sock, [sock] = 1}`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-17T04:25:41.460

单个演示

```
local server = socket.bind("*",7777)
local client_tab = {}

while true do
    -- socket.select first param is a table of connected socket,
    -- you want a connected socket,you need to call accept()
    -- if you do not want to block,you should call settimeout(seconds)
    local recvt = socket.select(client_tab, nil, 1)
    server:settimeout(1)
    local client = server:accept()
    if client then
        client_tab[#client_tab+1] = client 
    end
    if #recvt > 0 then
        -- read clients in recvt
    end
end 
```

# javascript - 禁用滚动，但保持缩放能力

> ID：16004616
> 
> 赞同：2
> 
> 时间：2013-04-14T21:37:07.967
> 
> 标签：javascript, ios, css, safari, lightbox

在我正在开发的响应式网站上，我有自己的小灯箱脚本，它可以全屏打开图像，同时保持它们的纵横比。这很简单，使用 2 个 div（外部全屏 div 带有黑色背景“lbBlack”和内部 div 带有图像“lbImg”）：

```
//super small lightbox ;)
$("#posts").on("click", ".img", function(event) {
    $('#lbBlack').css('top',$(document).scrollTop());
    $('#lbImg').attr('src', $(this).attr('src'));
    $('#lbBlack').css('width',$(window).width());
    $('#lbBlack').css('height',window.innerHeight);
    $('#lbBlack').fadeIn(500);
    $('#lbImg').css('margin-top',((window.innerHeight-$('#lbImg').height()))/2);
    document.body.style.overflow="hidden";
    document.ontouchmove = function(event){
        event.preventDefault();
    }
    $('#lbBlack').on("click", "#lbImg, body", function(event) {
        $('#lbBlack').fadeOut(500);
        document.body.style.overflow="visible";
        document.ontouchmove = function(event){
            return true;
        }
    });
}); 
```

对于 iOS，我必须添加 ontouchmove-prevention，因为 body-overflow-hidden 不足以避免在打开灯箱时滚动。

现在上面这个工作解决方案的“大问题”：我想启用缩放图像。“ontouchmove”代码可以防止这种情况发生。

有任何想法吗？

HTML代码：

```
<body>
    <div id="lbBlack">
        <img id="lbImg">
    </div>..... 
```

CSS代码：

```
#lbBlack {
    display: none;
    position: absolute;
    left: 0;
    background-color: black;
    z-index: 2001;
    text-align: center;
}
#lbBlack #lbImg {
    max-height: 100%;
    max-width: 100%;
    position: relative;
} 
```

所以我认为我正在寻找的是一种防止滚动同时仍保持缩放可能性的方法。我仍然不明白为什么 body-overflow:hidden 仍然能够在 iOS 上滚动？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:52:24.357

那么，拉斐尔，

这可能并不完美，但它应该让你朝着正确的方向前进。我在 Android 上测试过，我处理 Apple 东西的伙伴目前不可用。滚动和其他移动被禁用，但您可以缩放。然而，一个问题是，当您实际上处于捏缩放过程中时，您可以四处移动图片。捏缩放完成后，您始终可以将图片重新捕捉到中心。（这甚至可能看起来很整洁）。

请注意，我向 jQuery 原型添加了一个方法，并向 jQuery.Event 原型添加了一个属性。

```
/*global console, $*/
/*jslint browser: true*/

(function () {
    "use strict";

    $.fn.detectPinch = function () {
        var numTouches = 0;

        // each finger touch triggers touchstart
        // (even if one finger is already touching)
        $(document).on('touchstart', function (event) {
            // if numTouches is more than 1, reset it to 0
            // or else you can have numTouches >= 2 when
            // actually only one finger is touching
            numTouches = (numTouches > 1) ? 0 : numTouches;
            // if numTouches is 0 or 1, increment it
            numTouches = (numTouches < 2) ? numTouches += 1 : 2;
            console.log(numTouches + ' start');

        }).on('touchend', function (event) {
            // another safety check: only decrement if > 0
            numTouches = (numTouches > 0) ? numTouches -= 1 : 0;
            console.log(numTouches + ' end');

        });

        // all event objects inherit this property
        $.Event.prototype.isPinched = function () {
            return (numTouches === 2) ? true : false;
        };
        return this;
    };

    $(document).ready(function (event) {
        // call the method we added to the prototype
        $(document).detectPinch();

        $("#posts").on("click", "img", function (event) {
            $(this).css('visibility', 'hidden');
            $('#lbBlack').css('top', $(document).scrollTop());
            $('#lbImg').attr('src', $(this).attr('src'));
            $('#lbBlack').css('width', $(window).width());
            $('#lbBlack').css('height', window.innerHeight);
            $('#lbBlack').fadeIn(500);
            $('#lbImg').css('margin-top', ((window.innerHeight - $('#lbImg').height())) / 2);
            document.body.style.overflow = "hidden";
        });

        $('#lbBlack').on("click", "#lbImg, body", function (event) {
            $('#lbBlack').fadeOut(500);
            $('#posts img').css('visibility', 'visible');
            document.body.style.overflow = "visible";
        });

    }).on('touchmove', function (event) {
        // prevent one-finger movements
        if (!event.isPinched()) {
            event.preventDefault();
            console.log('prevented');
        }

    });
}()); 
```

# sql - 为什么在 Where 子句中使用 (1=1)？

> ID：16004621
> 
> 赞同：1
> 
> 时间：2013-04-14T21:37:29.733
> 
> 标签：sql, where-clause

[此查询来自此处](https://stackoverflow.com/a/765892/614863)的答案。where 子句中有 (1=1)，但执行计划相同（SQL Express 2008R2）。

我猜这是古代的神器？

```
SELECT 
     ind.name 
    ,ind.index_id 
    ,ic.index_column_id 
    ,col.name 
    ,ind.* 
    ,ic.* 
    ,col.* 
FROM sys.indexes ind 

INNER JOIN sys.index_columns ic 
    ON  ind.object_id = ic.object_id and ind.index_id = ic.index_id 

INNER JOIN sys.columns col 
    ON ic.object_id = col.object_id and ic.column_id = col.column_id 

INNER JOIN sys.tables t 
    ON ind.object_id = t.object_id 

WHERE (1=1) 
    AND ind.is_primary_key = 0 
    AND ind.is_unique = 0 
    AND ind.is_unique_constraint = 0 
    AND t.is_ms_shipped = 0 
ORDER BY 
    t.name, ind.name, ind.index_id, ic.index_column_id 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T21:41:45.887

从代码生成动态 SQL 时，根据需要从`WHERE (1=1)`then concatenate\append开始会很有用`AND <Condition>`。不确定该答案是否是这种情况，但也许它是基于一些用于生成 SQL 的代码。

# django - 在 Django 中下载文件

> ID：16004628
> 
> 赞同：0
> 
> 时间：2013-04-14T21:37:49.013
> 
> 标签：django, file, class, upload, download

我需要一些帮助来了解如何将文件从我的 django 站点下载到用户机器上。我已经创建了一个相当基本的上传文件的方法。这些文件是一个类的实例，并保存在我的“媒体”文件夹中。我需要帮助的是如何提供文件。我希望用户能够访问一个页面并单击他们想要下载的文件。出于某种原因，我找不到有关如何执行此操作的任何资源。这是我此时的文件

**网址.py**

```
 url(r'^admin/', include(admin.site.urls)),
    url(r'^upload/', views.upload),
    url(r'^download/', views.download),
    url(r'^success/', views.success),
)

if settings.DEBUG:
    urlpatterns = patterns('',
                           url(r'^media/(?P<path>.*)$', 'django.views.static.serve',{'document_root': settings.MEDIA_ROOT, 'show_indexes': True}),
                           ) + urlpatterns 
```

**模型.py**

```
class WorkSheet(models.Model):
    worksheet_name = models.CharField(max_length= 150, default = '')
    creator = models.ForeignKey(User, default = True)
    worksheet_file = models.FileField(upload_to = 'worksheets', default = True)
    number_of_stars = models.PositiveIntegerField(default = 0)
    category = models.CharField(max_length = 100, default = '')

class UploadWorkSheetForm(ModelForm):
    class Meta:
        model = WorkSheet
        exclude = ('number_of_stars',
                   'creator',) 
```

**视图.py**

```
def upload(request):
    if request.method == 'POST':
        form = UploadWorkSheetForm(request.POST, request.FILES)
        if form.is_valid():
            form.save()
            return http.HttpResponseRedirect('/success/')
    else:
        form = UploadWorkSheetForm()
    return render(request, 'upload.html', {'form': form})
def download(request):
    return render_to_response('download.html')
def success(request):
    return render_to_response('upload_success.html') 
```

所以基本上我希望用户访问 www.mysite.com/download 并能够下载文件。谢谢！！

. . . . . . . . .

另外，我的上传文件视图没有这样的处理程序是否有问题？

```
def handle_uploaded_file(file,path=''):
    filename = file._get_name()
    destination_file = open('%s/%s' % (settings.MEDIA_ROOT, str(path) + str(filename)), 'wb+')
    for chunk in file.chunks():
        destination_file.write(chunk)
    destination_file.close() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T22:59:50.237

在您的下载视图中，您只是呈现一个 download.html，但您没有向它发送任何上下文。我可能会将工作表的查询集（Worksheet.objects.all()）作为上下文发送到模板。在模板中，做类似的事情

```
{% for worksheet in worksheets %}

{{ worksheet.worksheet_file.url }}

{% endfor %} 
```

然后，您的 WorkSheet.objects.all() 查询中将包含所有文件 url。

如果可能的话，我会处理模型文件本身中的所有上传逻辑，就像[这样](http://milindshakya.tumblr.com/post/6468927692/uploading-images-and-files-in-django-forms)

# javascript - 禁用流星注册

> ID：16004637
> 
> 赞同：16
> 
> 时间：2013-04-14T21:38:29.517
> 
> 标签：javascript, meteor

我想从我的 Meteor 应用程序中禁用注册。我正在使用accounts-ui smartpackage。

我试过这个：

```
Accounts.config({
  var forbidClientAccountCreation = true;
}) 
```

但是我的应用服务器崩溃了。我怎样才能解决这个问题？

这是使用一个通用 JS 文件，不是一个用于客户端，一个用于服务器。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-04-14T21:55:32.377

`Accounts.config`接受一个参数，它是一个*javascript hashmap*。您应该正确编写它：

```
Accounts.config({
  forbidClientAccountCreation : true
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-08-28T20:31:12.353

我刚刚遇到这个问题，这里的答案并不完全清楚。接受的答案适用于 OP，因为他使用的是单个 JS 文件，但如果没有，请将以下代码放在`client`and`server`文件夹之外的文件中。

```
Accounts.config({
  forbidClientAccountCreation : true
}); 
```

原因是在客户端运行它会触发`accounts-ui`隐藏“注册”链接和文本的功能，而在服务器上运行它实际上会禁止创建新用户帐户。

如果您只在客户端上运行它，链接和文本将被隐藏，但您仍然可以通过浏览器的控制台创建一个帐户。

如果您只在服务器上运行它，帐户创建将始终失败，但您仍会获得相关的链接和文本。

代码的一个好地方是在`lib`文件夹中，因为该文件夹中的任何内容都将由 Meteor 在服务器和客户端以及任何其他文件夹之前处理。例如，您可以将其放在`lib/environment.js`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-10T00:17:29.767

只需在控制台上输入下一个：

```
Accounts._loginButtonsSession.set('inSignupFlow', true); 
```

您将再次看到注册表单。

我所做的是阻止验证服务器上的用户创建，如下所示：

```
Accounts.validateNewUser(function (user) {
    return false
}); 
```

# python - Math.sqrt(-1) 上没有错误

> ID：16004639
> 
> 赞同：1
> 
> 时间：2013-04-14T21:38:45.720
> 
> 标签：python

查看下面的代码，当我输入一个负数时，似乎没有错误，但是平方根不可能是负数，所以我不知道为什么会这样。

```
import math
d=[]
while True:
    z=int(raw_input())
    if (z>0 and math.sqrt(z)): d.append(int(z)) 
```

空闲时：

```
math.sqrt(int(-1))

Traceback (most recent call last):
  File "<pyshell#16>", line 1, in <module>
    math.sqrt(int(-1))
ValueError: math domain error 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T21:40:54.793

```
 if (z>0 and math.sqrt(z)): ... 
```

[布尔运算短路](http://docs.python.org/2/library/stdtypes.html?highlight=short%20circuit#boolean-operations-and-or-not)。这意味着如果`z > 0`为假，`math.sqrt(z)`则不评估。因此没有错误。

PS 严格来说，负数的平方根存在并且是[复数](http://en.wikipedia.org/wiki/Complex_number)。像这样的函数`scipy.sqrt()`会很高兴地返回一个复杂的平方根：

```
>>> import scipy as sp
>>> sp.sqrt(-1)
1j 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T21:40:52.870

没有错误，因为您正在检查以确保该值为正。`and`运算符短路，这意味着如果第一个条件为假，则不评估第二个条件。你写`if z>0 and math.sqrt(z)`的。如果`z`小于或等于零，则不会计算第二个表达式（平方根），因此您永远不会尝试取平方根，因此不会出现错误。

# mysql - 关于创建 SQL 连接的建议

> ID：16004641
> 
> 赞同：0
> 
> 时间：2013-04-14T21:38:57.253
> 
> 标签：mysql, sql, join

我很难获得一个查询来产生我需要的行，要么给出太少或太多的重复项。

最终，我想要的是一个产生所有非重复资源的查询，其中 cid > 0。

我研究了其他答案，但大多数只是提供了一个有效的查询。我希望答案能帮助我和其他人更好地*理解*查询构建。谢谢！

TL；DR 版本如下...

以下查询产生重复项：

```
SELECT DISTINCTROW r.rid, r.rname, c.cid, c.spanclass, c.cname, u.name, r.time
FROM rmn_resources as r, rmn_users as u, rmn_conditions as c
WHERE c.cid=r.cid 
```

这是我显示数据的尝试：

```
|r.rid  |r.rname        |c.cid  |c.spanclass        |c.cname        |u.name |r.time
|1      |'Keyfob #1'    |0      |NULL               |'Created'      |User B |'0000-00-00 00:00:00'
|1      |'Keyfob #1'    |0      |NULL               |'Created'      |User A |'0000-00-00 00:00:00'
|2      |'Keyfob #2'    |1      |'label-success'    |'Available'    |User B |'2013-04-13 02:17:07'
|2      |'Keyfob #2'    |1      |'label-success'    |'Available'    |User A |'2013-04-13 02:17:07'
|3      |'Keyfob #3'    |2      |'label-important'  |'Checked out'  |User B |'2013-04-13 18:11:17'
|3      |'Keyfob #3'    |2      |'label-important'  |'Checked out'  |User A |'2013-04-13 18:11:17'
|5      |'Spork'        |1      |'label-success'    |'Available'    |User B |'2013-04-14 02:29:39'
|5      |'Spork'        |1      |'label-success'    |'Available'    |User A |'2013-04-14 02:29:39' 
```

我有一个减少重复的变体，但仍然有两条记录，我只想要一个：

```
SELECT DISTINCTROW r.rid, r.rname, c.cid, c.spanclass, c.cname, u.name, r.time
FROM rmn_resources as r, rmn_users as u, rmn_conditions as c
WHERE c.cid=r.cid AND (u.uid=r.uid OR (r.uid=0 AND r.cid>0)) 
```

还有一个没有重复但没有显示我心爱的Spork。

```
SELECT DISTINCTROW r.rid, r.rname, c.cid, c.spanclass, c.cname, u.name, r.time
FROM rmn_resources as r, rmn_users as u, rmn_conditions as c
WHERE c.cid=r.cid AND u.uid=r.uid 
```

（老实说，我在这里在黑暗中拍摄，试图解决这个问题。）

以下是 SQL 形式的基本表（抱歉，没有 TL；DR 版本）

表：rmn_resources

```
CREATE TABLE IF NOT EXISTS `rmn_resources` (
  `rid` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `rname` varchar(255) CHARACTER SET utf8 NOT NULL,
  `oid` int(10) unsigned NOT NULL COMMENT 'owner uid in users',
  `cid` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'cid: condition id in conditions',
  `time` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT 'NULL or last changed time',
  `uid` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'user uid from users',
  PRIMARY KEY (`rid`) ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=6 ;

INSERT INTO `rmn_resources` (`rid`, `rname`, `oid`, `cid`, `time`, `uid`) VALUES
(1, 'Keyfob #1', 0, 0, '0000-00-00 00:00:00', 0),
(2, 'Keyfob #2', 0, 1, '2013-04-13 08:17:07', 1),
(3, 'Keyfob #3', 0, 2, '2013-04-14 00:11:17', 2),
(5, 'Spork', 1, 1, '2013-04-14 08:29:39', 0); 
```

表：rmn_users

```
CREATE TABLE IF NOT EXISTS `rmn_users` (
  `uid` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) CHARACTER SET utf8 NOT NULL,
  `email` varchar(255) CHARACTER SET utf8 NOT NULL,
  PRIMARY KEY (`uid`),
  UNIQUE KEY `email` (`email`),
  KEY `name` (`name`) ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;

INSERT INTO `rmn_users` (`uid`, `name`, `email`) VALUES
(1, 'User A', 'usera@users.com'),
(2, 'User B', 'userb@users.com'); 
```

表：rmn_conditions

```
CREATE TABLE IF NOT EXISTS `rmn_conditions` (
  `cid` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `cname` varchar(255) CHARACTER SET utf8 NOT NULL,
  `spanclass` varchar(255) CHARACTER SET utf8 DEFAULT NULL,
PRIMARY KEY (`cid`) ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=4 ;

INSERT INTO `rmn_conditions` (`cid`, `cname`, `spanclass`) VALUES
(0, 'Created', NULL),
(1, 'Available', 'label-success'),
(2, 'Checked out', 'label-important'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:51:46.530

您应该开始使用显式连接，重复的问题是因为您是交叉连接。最后一个查询没问题，但它不显示 spork 因为您没有匹配的用户。你可以`LEFT JOIN`像这样使用：

```
SELECT r.rid, r.rname, c.cid, c.spanclass, c.cname, u.name, r.time
FROM rmn_resources AS r
LEFT JOIN rmn_users AS u
  ON u.uid=r.uid
LEFT JOIN rmn_conditions AS c
  ON c.cid=r.cid; 
```

[http://sqlfiddle.com/#!8/4d5de/1](http://sqlfiddle.com/#!8/4d5de/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T02:51:17.267

如果您还没有，您可能需要通读[Visual-Representation-of-SQL-Joins](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)以更好地理解连接。

当表包含数百万行时，与当前使用的联接相比，当您使用特定联接时，它会给您带来巨大的优势、内存和时间优势。

希望能帮助到你。

![在此处输入图像描述](https://i.stack.imgur.com/bObxS.jpg)

# java - netutils Java 网络库不工作

> ID：16004642
> 
> 赞同：1
> 
> 时间：2013-04-14T21:38:58.687
> 
> 标签：java

我找到了一个名为 netutils 的 java 网络库。 [这是主页](https://code.google.com/p/netutils/)。

我需要编辑 tcp 数据包。

jnetpcap 库有太多错误，所以我正在尝试寻找另一个库。这个 netutils 似乎非常好，但在手册中它说有 libnet.lib 和 netutils.dll 文件。

我无法找到正确的文件。

# java - 如何打开玩！Intellij IDEA 中的 2.0 控制台？

> ID：16004645
> 
> 赞同：1
> 
> 时间：2013-04-14T21:39:20.267
> 
> 标签：java, scala, playframework, intellij-idea, playframework-2.0

请注意（！）：*我已经安装了所有必需的插件（请参阅我的问题的其余部分），所以这个问题不是重复的！* 原始问题：我使用 Intellj IDEA 设置了新的 Play 2.0 框架项目。但我找不到如何`Play!`在 Intellij IDEA 中运行命令行实用程序。从教程中我了解到它必须可以从`Tools | Play with Playframework`.

但我错过了这个上下文菜单： ![在此处输入图像描述](https://i.stack.imgur.com/0XC52.png)

哪里可能有问题？

一些附加信息：

*   我使用 Intellij IDEA 向导设置了新项目。
*   我能够使用`Run`命令从 Intellij IDEA 运行应用程序并在浏览器中查看结果。
*   我使用 Intellij Idea 12.1.1
*   为了能够从 IDEA 创建新项目，我安装了所有其他插件（Play 2.0 插件，Scala 插件）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:45:48.097

您需要启用 Play！支持特定模块。右键单击模块根目录，选择“添加框架支持...”并选择播放！2。

# java - 特定于子类的代码 - 我应该使用抽象基类方法还是接口？

> ID：16004651
> 
> 赞同：1
> 
> 时间：2013-04-14T21:40:15.383
> 
> 标签：java, methods, implementation, abstract, overriding

我有一个超类 Animal，它有两个子类 Cat 和 Dog。狗和猫都需要有特定的说话和移动方法。以下是实现此目的的两种选择：

1.  Animal 会有两个抽象方法 move() 和 speak()；Dog、Cat 和 Dog 分别覆盖这两个方法，因此它们是特定于它们的。
2.  我可以有一个具有通用动物方法 move() 和 speak() 的接口，两个子类实现这些方法，因此它们再次特定于它们。

这些方法中的一种是否比另一种更合适？我意识到如果我有一个动物的 ArrayList，我会写：

```
ArrayList Animal<allAnimals> = new ArrayList <Animal>():
allAnimals.add(new Dog());
allAnimals.add(new Cat());

//If I override the methods, I can simply go: 
for (Animal a: allAnimals) a.move();

//Where as if I implemented the methods, I would not need be able to do this. I would need to cast the animal as its specific animal. e.g. If I knew the animal was a dog.

Dog aDog= (Dog) a; 
a.move(); 
```

因此，根据使用的情况，覆盖和实施可能具有某些优点和缺点。其他人可以详细说明吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:44:39.730

作为一般经验法则，当且仅当您的扩展类将共享大量行为时，才使用扩展（抽象类）。在这种情况下，可以使用扩展来消除重复代码的需要，这是一件好事（TM）。

另一方面，如果您的类只需要具有相同的签名，则使用更灵活的接口（例如，您可以实现多个接口，但您只能从一个类扩展）。

这只是一些通用的建议，因为每个用例都是不同的。为了避免扩展的限制，可以使用其他技术，例如组合：（[http://en.wikipedia.org/wiki/Composition_over_inheritance](http://en.wikipedia.org/wiki/Composition_over_inheritance)）。

最后但并非最不重要的一点是，我认为您的代码略有错误。您可以以完全相同的方式调用基类上的方法，无论它们是从抽象类还是接口继承。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T21:45:30.770

首先，从子类的角度来看，重写或实现方法没有区别。因此，您编写的代码在所有情况下都将完全相同（在 Java 中，所有方法都像 C++`virtual`函数一样工作；调用的方法是被引用的实际类之一）。

因此，决定是定义一个超类，它是一个接口、一个抽象类或一个可实例化的类。

`new Animal()`如果创建超类（ ）的对象有意义，则应使用可实例化类。

抽象类，当没有超类的对象但某些方法的实现将由所有（或几乎所有）子类共享。

接口，当您只定义合同并且实现留给每个子类时。

这取决于问题的范围来决定使用哪种方式。例如，如果`move()`只是表示“更改动物的 x,y 坐标”，则可能它应该是抽象类中的实现方法。但是，如果您必须定义动物如何移动，那么`Animal`接口会更好，因此每个子类都定义它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T21:44:19.990

一般来说，经验法则是使用一个接口，如果你可以使一个 Java 类可以实现许多接口但只能扩展一个类。

只有当几个类有很多共同点并且您希望能够重用相同的代码时，才应该使用扩展（继承）。

顺便说一句，在您作为示例提供的代码中，您可以使用：

```
for (Animal a: allAnimals) a.move(); 
```

在您使用接口和继承的情况下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T21:45:33.023

在这种情况下，它可能取决于您是否希望拥有 move() 的默认实现，因此 Dog 和 Cat 不必提供自己的实现。大概 move() 方法在猫和狗之间有很多共同点，因此您可以通过超类中的通用实现具有更好的可重用性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-14T21:47:11.403

```
//Where as if I implemented the methods, I would not need be able to do this. I would need to cast the animal as its specific animal. e.g. If I knew the animal was a dog.

Dog aDog= (Dog) a; 
a.move(); 
```

不，你根本不必这样做。如果`Animal`是接口而不是抽象类，那么您为抽象类显示的过程就可以正常工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-14T21:50:13.007

从概念上讲，抽象类描述事物的本质，接口描述事物的作用。在这种情况下，将 Animal 作为抽象类是合适的，因为 Cat 或 Dog 是 Animal。在功能上，选择导致最少编码量/最干净的类层次结构的任何选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-15T09:35:35.877

首先，您有第三种选择，即：拥有一个接口（例如 MoverAndSpeaker；虽然这名字有点蹩脚），并拥有*抽象基类*Animal 'implmenent' 它：

```
static public abstract class Animal implements MoverAndSpeaker {
    @Override
    public abstract void move();
    public abstract void speak();
} 
```

为什么你甚至想要这样的东西？

与这里的一些答案不同，我认为语义一致性是最重要的考虑因素，避免代码重复等问题要么自行解决，要么只占少数。

如果我处于你的位置，我将应用的关键标准是：

> “有没有不是动物的物体会移动和说话？”

*   如果答案是“不”，那么移动和说话是动物会做的事情。*因此，仅*使用抽象方法
**   如果答案是“是”，那么我问自己*

 *> “所有的动物都会移动和说话吗？”

*   如果第二个答案是“是”，那么使用上面的代码（假设您不希望所有动物都有一些默认实现）。
*   如果第二个答案是“否”，则只考虑接口。尽管您可能想要在 Dog、Cat 和 Animal 之间建立一个中间类 - 如果您在所有也会移动和说话的 Animals 之间有一些共享代码或字段。

最后，如果所有动物都没有共同点，那么正如其他答案中所建议的那样，您可能根本不需要 Animal 基类。*

# c - C - 我的功能适得其反

> ID：16004652
> 
> 赞同：0
> 
> 时间：2013-04-14T21:40:22.200
> 
> 标签：c

当我调用这个函数时，它总是返回 false 并停止程序。但我不知道为什么。

```
// checks to see if the second argument is a positive interger, 
// and that there is only one arg
    if (ArgCheck (argc, shift) == false)
   {
       printf("You may only input one non-negative argument.\n");
       return 1;
    }
    else
        return true; 
```

功能`ArgCheck`是：

```
int ArgCheck (int a, int b)
{
  if (a > 2)
        {
        return false;
        }
  else if (b < 0)
        {
        return false;  
        }
  else
    return 0;  
} 
```

即使我在命令行中输入正确的参数，它仍然返回 false。我知道这是一个菜鸟问题，但我感谢您的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:49:38.290

```
int ArgCheck (int a, int b)
{
  if (a > 2)
        {
        return false;
        }
  else if (b < 0)
        {
        return false;  
        }
  else
    return 0;  
} 
```

此函数始终返回 false。 `0`是一样的`false`。您的要求是：

> 如果第二个参数是正整数并且只有一个 arg，则返回 true

所以...

```
bool ArgCheck(int argCount, int value)
{
    return argCount == 1 && value >= 0;
} 
```

请注意，我不允许参数计数为 0，因为您说需要一个参数。您当前的代码不允许任何参数。

# sql - 使用 SQL 合并或 UPDATE / INSERT

> ID：16004653
> 
> 赞同：0
> 
> 时间：2013-04-14T21:40:23.217
> 
> 标签：sql, sql-server-2012

我有一个表（Customer_Master_File），需要从转储到文件夹中的平面文件中进行更新。我有一个 SSIS 包，可以运行以获取平面文件并将它们导入临时表（temp_Customer_Master_File）

我一直无法做到的是：

对于 temp 表中的每条记录，如果 Master 表中存在 Customer_Number，则更新它，如果不插入 temp 表的内容。

我正在更新记录的所有字段，而不是查找单个字段的更改。

我尝试了 SQL Merge 功能，但是当源数据中有多个记录时它会出错。

平面文件包含对客户记录的更改，一次可能有多个更改。我只想根据需要通过插入或更新来处理每条记录。

我还尝试从 TEMP_TABLE WHERE CUSTOMER_NUMBER NOT IN MASTER_FILE 执行 INSERT INTO MASTER_FILE，但是当它遇到重复的源行时，这也会失败并出现 PK 错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:44:40.393

```
UPDATE m SET 
  col2 = t.col2, 
  col3 = t.col3 -- etc. - all columns except Customer_Number
FROM dbo.Master_File AS m
INNER JOIN 
(
  SELECT 
    Customer_Number, rn = ROW_NUMBER() OVER
    (
      PARTITION BY Customer_Number ORDER BY [timestamp_column] DESC
    ), col2, col3, ... etc ...
  FROM dbo.Temp_Table
) AS t
ON m.Customer_Number = t.Customer_Number
WHERE t.rn = 1;

INSERT dbo.Master_File(Customer_Number, col2, col3, ...etc...)
  SELECT Customer_Number, col2, col3, ...etc...
  FROM 
  (
    SELECT 
      Customer_Number, rn = ROW_NUMBER() OVER 
      (
        PARTITION BY Customer_Number ORDER BY [timestamp_column DESC
      ),
      col2, col3, ...etc...
    FROM dbo.Temp_Table AS t 
    WHERE NOT EXISTS 
    (
      SELECT 1 FROM dbo.Master_File AS m
      WHERE m.Customer_Number = t.Customer_Number
    )
  ) AS x WHERE rn = 1; 
```

这会处理源表中不存在于目标中的多行。我对必须调整的列名做出了假设。

`MERGE`可能很诱人，但是我回避它有几个原因：

1.  语法令人生畏并且难以记忆......
2.  [除非您有意添加特定的锁定提示，否则您不会获得比上述方法更多的并发性](http://weblogs.sqlteam.com/dang/archive/2009/01/31/UPSERT-Race-Condition-With-MERGE.aspx)...
3.  [有许多未解决的错误，`MERGE`](http://www.sqlperformance.com/2013/02/t-sql-queries/another-merge-bug)可能还有更多尚未被发现的错误......

[我最近也在这里发布了一个警告提示，](http://www.mssqltips.com/sqlservertip/3074/tip-on-using-caution-with-merge/?utm_source=AaronBertrand)并在这里[收集了一些其他意见](https://sqlblog.org/merge)。

# .net - 在 Silverlight 中使用 HttpResponse 上传数据

> ID：16004664
> 
> 赞同：4
> 
> 时间：2013-04-14T21:40:58.093
> 
> 标签：.net, silverlight, httprequest, httpresponse

如何在 Silverlight 中使用异步双向二进制上传和下载数据？

1.  我需要将我的二进制文件上传到服务器，然后 >
2.  从服务器获取答案也作为二进制文件

我当前使用的示例是：http: [//msdn.microsoft.com/en-us/library/system.net.webrequest.begingetresponse.aspx](http://msdn.microsoft.com/en-us/library/system.net.webrequest.begingetresponse.aspx)

但是示例以请求开始，我需要从上传开始。

我已经尝试过使用 WebClient，但我无法按一个顺序进行上传/下载：[Bidirectional use of Webclient for binary](https://stackoverflow.com/questions/15981496/bidirectional-use-of-webclient-for-binary)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:57:54.533

我所做的是由 Silverlight 中的 Handlers.(ASHX) 同步的。RadFileUploader 是 Telerik 的组件与这些处理程序一起使用。

```
 namespace MyNameSpace.Web
    {   
      public class FileHandler : IHttpHandler
           {

      public void ProcessRequest(HttpContext context)
      {

        if (context.User.Identity.IsAuthenticated)
        {

            string fileName = context.Request.QueryString.Get("fileName");

            if (File.Exists(fileName))
            {                 
                context.Response.ContentType = MimeType(fileName);
                context.Response.AddHeader("Content-Transfer-Encoding", "binary");
                context.Response.WriteFile(fileName, 0, length);
            }
          }
   } 
```

我削减了大部分代码，但它给出了这个想法。我使用了一个处理程序来播放音频文件和一个处理程序来下载音频文件。Mimetype 是非常重要的部分。你的标题也很重要。通过这种方式，你告诉你想做什么。

对于异步，此页面可能会有所帮助。[http://msdn.microsoft.com/en-us/library/ms227433(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms227433(v=vs.100).aspx)

**编辑**

下面的处理程序文件`"Top.jasper"`从目录中读取文件并将其写入回调方法。`(ar.IsCompleted)`参数的 IsCompleted 属性检查其是否已完成。

`<%@ WebHandler Language="C#" CodeBehind="BDTest.ashx.cs" Class="AHBSBus.Web.Classes.BDTest" %>`

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Threading;
     using System.IO;

    namespace AHBSBus.Web.Classes
     {
/// <summary>
/// Summary description for BDTest
/// </summary>
public class BDTest : IHttpAsyncHandler
{
    public bool IsReusable { get { return false; } }

    public BDTest()
    {

    }
    public IAsyncResult BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
    {
        cb = new AsyncCallback((ar) =>
            {

                if (ar.IsCompleted)
                {
                    var result = ar.AsyncState;

                    File.WriteAllBytes("c:\\new.jasper", (byte[])result);
                }
            });

        extraData = File.ReadAllBytes("c:\\Top.jasper");

        context.Response.Write("<p>Begin IsThreadPoolThread is " + Thread.CurrentThread.IsThreadPoolThread + "</p>\r\n");
        AsynchOperation asynch = new AsynchOperation(cb, context, extraData);
        asynch.StartAsyncWork();
        return asynch;
    }

    public void EndProcessRequest(IAsyncResult result)
    {
    }

    public void ProcessRequest(HttpContext context)
    {
        var ctx=context;
    }
}

class AsynchOperation : IAsyncResult
{
    private bool _completed;
    private Object _state;
    private AsyncCallback _callback;
    private HttpContext _context;

    bool IAsyncResult.IsCompleted { get { return _completed; } }
    WaitHandle IAsyncResult.AsyncWaitHandle { get { return null; } }
    Object IAsyncResult.AsyncState { get { return _state; } }
    bool IAsyncResult.CompletedSynchronously { get { return false; } }

    public AsynchOperation(AsyncCallback callback, HttpContext context, Object state)
    {
        _callback = callback;
        _context = context;
        _state = state;
        _completed = false;
    }

    public void StartAsyncWork()
    {
        ThreadPool.QueueUserWorkItem(new WaitCallback(StartAsyncTask), null);
    }

    private void StartAsyncTask(Object workItemState)
    {
        //You may modify _state object here            
        _context.Response.Write("<p>Completion IsThreadPoolThread is " + Thread.CurrentThread.IsThreadPoolThread + "</p>\r\n");

        _context.Response.Write("Hello World from Async Handler!");
        _completed = true;
        _callback(this);
    }
  }
 } 
```

我提供`SignalR`双向通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T14:18:35.517

AHSX 是一种方法，但要特别考虑超过 4 MB 的文件。

你需要做两件事：

*   服务器端：将处理接收到的数据的 Ashx HttpHandler：

    公共类 FileUpload : IHttpHandler { public void ProcessRequest(HttpContext context) { _httpContext = context;

    ```
     if (context.Request.InputStream.Length == 0)
            throw new ArgumentException("No file input");

        try
        {
            // Method that will be populating parameters from HttpHandler Request.
            GetQueryStringParameters();

            string uploadFolder = _directory;
            string tempFileName = _fileName + _tempExtension;

            if (_firstChunk)
            {
                //// Delete temp file
                if (File.Exists(@HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + tempFileName))
                    File.Delete(@HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + tempFileName);

                //// Delete target file
                if (File.Exists(@HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + _fileName))
                    File.Delete(@HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + _fileName);

            }

            using (FileStream fs = File.Open(@HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + tempFileName, FileMode.Append))
            {
                SaveFile(context.Request.InputStream, fs);
                fs.Close();
            }

            if (_lastChunk)
            {
                File.Move(HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + tempFileName, HostingEnvironment.ApplicationPhysicalPath + "/" + uploadFolder + "/" + _fileName);
            }

        }
        catch (Exception e)
        {
            // Todo
            // Logger Exception
            throw;
        }

    } 
    ```

    }

*   将调用它的 Silverlight 类：

公共类上传文件 {

public void Upload(Stream streamNewFile, string fileName, string dirOnServer = "") { this.uploadMode = UploadMode.OpenStream;

```
 this.destinationOnServer = dirOnServer;
        this.fileStream = streamNewFile;
        this.fileName = fileName;
        this.dataLength = this.fileStream.Length;

        long dataToSend = this.dataLength - this.dataSent;
        bool isLastChunk = dataToSend <= this.chunkSize;
        bool isFirstChunk = this.dataSent == 0;
        string docType = "document";

        var strCurrentHost = HtmlPage.Document.DocumentUri.ToString().Substring(0, HtmlPage.Document.DocumentUri.ToString().LastIndexOf('/'));
        UriBuilder httpHandlerUrlBuilder = new UriBuilder(strCurrentHost + "/FileUpload.ashx");
        httpHandlerUrlBuilder.Query = string.Format("{5}file={0}&offset={1}&last={2}&first={3}&docType={4}&destination={6}",
            fileName, this.dataSent, isLastChunk, isFirstChunk, docType,
            string.IsNullOrEmpty(httpHandlerUrlBuilder.Query) ? string.Empty : httpHandlerUrlBuilder.Query.Remove(0, 1) + "&", destinationOnServer);

        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(httpHandlerUrlBuilder.Uri);
        webRequest.Method = "POST";
        webRequest.BeginGetRequestStream(new AsyncCallback(this.WriteToStreamCallback), webRequest);
    } 
```

}

# internet-explorer-8 - Video.js 不适用于 IE8 页面上的 2 个视频

> ID：16004666
> 
> 赞同：3
> 
> 时间：2013-04-14T21:41:19.840
> 
> 标签：internet-explorer-8, video.js

我正在使用 video.js。它工作得很好，视频可以在所有浏览器中播放。

我遇到的问题是，当我在 IE8 的同一页面上有 2 个视频时，只有一个有效。另一个只是一个大的黑色矩形，视频应该在哪里。当我删除其中一个视频的代码时，另一个工作正常。一旦我重新添加代码， 1 就会停止工作。

是否有一个修复程序可以让多个视频在 IE 的一页上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T15:09:37.107

您是否在视频对象 ID 中为每个播放器提供了唯一的名称/字符串？这也适用于任何包含用于 Flash 后备的 div 或对象。

```
 <video id="video-id-1" class="video-js vjs-default-skin" controls
      width="960" height="540" poster="video-1-poster.jpg" data-setup="{}">
      <source src="video-1-file.mp4" type='video/mp4'>
    </video>

    <video id="video-id-2" class="video-js vjs-default-skin" controls
      width="960" height="540" poster="video-2-poster.jpg" data-setup="{}">
      <source src="video-2-file.mp4" type='video/mp4'>
    </video> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-15T17:19:16.690

我遇到了一个非常相似的问题，结果发现 videojs 不会在隐藏元素中设置视频。我最终不得不显示该元素，但将其放置在屏幕外，然后在 videojs 初始化它后重置位置并再次隐藏它。

# c - C - 在函数中分配矩阵

> ID：16004668
> 
> 赞同：0
> 
> 时间：2013-04-14T21:41:23.307
> 
> 标签：c, function, matrix, malloc

我正在尝试使用一个函数来分配一个矩阵，该函数采用它的维度和一个三重指针。我已经分配了一个 int**（设置为 NULL）并且我将它的地址作为函数的参数传递。由于某种原因，这给了我一个内存访问冲突。

```
void allocateMatrix(int ***matrix, int row, int col)
{
    int i;
    if((*matrix = (int**)malloc(row * sizeof(int*))) == NULL)
    {
        perror("There has been an error");
        exit(EXIT_FAILURE);
    }
    for(i = 0; i < row; ++i)
    {
        if((*matrix[i] = (int*)malloc(col * sizeof(int))) == NULL)
        {
            perror("There has been an error");
            exit(EXIT_FAILURE);
        }
    }
}

/* main.c */

    int** matrix = NULL;
    allocateMatrix(&matrix, MATRIX_ROW, MATRIX_COL); //error 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:45:34.810

你需要改变

```
if((*matrix[i] = (int*)malloc(col * sizeof(int))) == NULL) 
```

到

```
if(((*matrix)[i] = (int*)malloc(col * sizeof(int))) == NULL)
//  ^       ^ 
```

您需要`matrix`在使用数组下标之前取消引用。
`*matrix[i]`相当于`*(matrix[i])`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T21:46:49.187

这是运算符优先级的问题。在

```
if ((*matrix[i] = (int*)malloc( ... )) 
```

默认优先级是`*(matrix[i])`, 而您应该使用`(*matrix)[i]`.

我仍然建议将矩阵分配为连续数组，而不是作为指向数组的指针数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-08T20:13:59.610

我为 gcc C11/C99 制作了一个基于链接的适当分配功能的解决方案：

[http://c-faq.com/aryptr/dynmuldimary.html](http://c-faq.com/aryptr/dynmuldimary.html)

[http://c-faq.com/aryptr/ary2dfunc3.html](http://c-faq.com/aryptr/ary2dfunc3.html)

经过评论中的一些讨论，很明显 matrix2 被正确分配，它可以传递给这个函数 fn(int row, int col, int array[col][row]) 作为 matrix2[0] （一维数组中的数据) 转换为 (double (*)[])

```
//compile with gcc --std=c11 program.c
#include <stdio.h>
#include <stdlib.h>

#define MX 9
#define MY 14

void input_matrix(int row, int column, double matrix[row][column]);
void print_matrix(int row, int column, double matrix[row][column]);
double **alloc_matrix2(int row, int column);
double  *alloc_matrix3(int row, int column);
void    *alloc_matrix4(int row, int column);

int main()
{
    int i=MX, j=MY;
    printf("Generate input values and print matrices with functions fn(int w, int k, double matrix[w][k]) (in C99 and C11)\n");
    double matrix1[i][j];
    input_matrix(MX,MY,matrix1);
    printf("matrix static\n");
    print_matrix(MX,MY,matrix1);

    double **matrix2; //data of matrix2 is just matrix3                 
    matrix2=alloc_matrix2(MX,MY); 
    input_matrix(MX,MY,(double (*)[])(*matrix2));
    printf("matrix two times allocated one for pointers, the second for data (double (*)[])(m[0])\n");
    print_matrix(MX,MY,(double (*)[])(matrix2[0]));
    free(*matrix2);
    free(matrix2);

    double *matrix3=alloc_matrix3(MX,MY);
    input_matrix(MX,MY,(double (*)[])matrix3);
    printf("matrix allocated as two-dimensional array\n");
    print_matrix(MX,MY,(double (*)[])matrix3);
    free(matrix3);

    j=MY;
    double (*matrix4)[j];
    matrix4 = (double (*)[])alloc_matrix4(MX,MY);
    input_matrix(MX,MY,matrix4);
    printf("matrix allocated via pointer to array m = (double (*)[])malloc(MX * sizeof(*m))\n");
    print_matrix(MX,MY,matrix4);
    free(matrix4);
    printf("\nThe End!\n");
    return 0;
}

void input_matrix(int row, int column, double matrix[row][column]){
    for(int i=0; i<row; i++){
        for(int j=0; j<column; j++)
            matrix[i][j]=i+1;
    }
}

void print_matrix(int row, int column, double matrix[row][column]){
    for(int i=0; i<row; i++){
        for(int j=0; j<column; j++)
            printf("%.2lf ", matrix[i][j]);
        printf("\n");
    }
}

double **alloc_matrix2(int row, int column){
    double **matrix;
    matrix=malloc(row*sizeof(double*));
    matrix[0] = (double *)malloc(row*column*sizeof(double));
    for(int i = 1; i < row; i++)
        matrix[i] = matrix[0]+i*column;
    return matrix;
}

double *alloc_matrix3(int row, int column){
    double *matrix;
    matrix=malloc(row*column*sizeof(double));
    return matrix;
}

void *alloc_matrix4(int row, int column){
    double (*matrix)[column];
    matrix = (double (*)[])malloc(row*sizeof(*matrix));
    return matrix;
} 
```

# emacs - Emacs - 为光标闪烁设置不同的间隔

> ID：16004673
> 
> 赞同：6
> 
> 时间：2013-04-14T21:41:40.330
> 
> 标签：emacs, text-cursor

我想为闪烁 ON 和闪烁 OFF 设​​置不同的间隔。我的意思是，我希望光标保持可见 1 秒并关闭 0.2 秒。我阅读了光标文档，但我发现最接近的是改变 ON 和 OFF 闪烁的闪烁光标间隔。

如何在 Emacs 中自定义它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T00:18:19.673

Emacs 中没有内置这样的功能，但您可以通过在 .emacs 文件中添加以下行来破解它：

```
(defvar blink-cursor-interval-visible 1)
(defvar blink-cursor-interval-invisible 0.2)

(defadvice internal-show-cursor (before unsymmetric-blink-cursor-interval)
  (when blink-cursor-timer
    (setf (timer--repeat-delay blink-cursor-timer)
          (if (internal-show-cursor-p)
              blink-cursor-interval-visible
            blink-cursor-interval-invisible))))
(ad-activate 'internal-show-cursor) 
```

Emacs 使用由计时器调用的切换函数来实现光标的闪烁。每次调用该函数时，如果光标当前可见则隐藏光标，如果光标不可见则显示。不幸的是，计时器以固定的时间间隔调用此函数。

为了根据光标的状态实现不同的延迟时间，上面的代码[建议](http://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html)了显示或隐藏光标的内部函数。每次调用该函数时，建议将计时器的延迟时间更改为 1 或 0.2，具体取决于光标是否可见。也就是说，每次隐藏或显示光标时，都会改变定时器的延迟时间。

相当hackish，但它确实有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T00:16:55.887

我能够修改该`blink-cursor-timer-function`功能以支持您想要的我相信。

首先，您需要将 的值修改`blink-cursor-interval`为 .2

那么这段代码应该可以解决问题：每秒钟 `blink-cursor-timer-function`调用一次`blink-cursor-interval`。因此，此函数将每 0.2 秒调用一次，它将保持光标打开 5 次调用，然后将其关闭 1。因此，每次调用 0.2 秒的 5 次调用将为您提供 1 秒的开启时间，然后只有 0.2 秒关闭时间。

```
;; change the interval time to .2
(setq blink-cursor-interval .2)

;; create a variable that counts the timer ticks
(defvar blink-tick-counter 0)

;; this function will be called every .2 seconds
(defun blink-cursor-timer-function ()
  "Timer function of timer `blink-cursor-timer'."
  (if (internal-show-cursor-p)
      (progn
    (if (> blink-tick-counter 4)
        (progn
          (internal-show-cursor nil nil)
          (setq blink-tick-counter 0))
      (setq blink-tick-counter (1+ blink-tick-counter))))
    (internal-show-cursor nil t))) 
```

# entity-framework - 使用 ORM 管理实体及其快照

> ID：16004677
> 
> 赞同：0
> 
> 时间：2013-04-14T21:42:13.373
> 
> 标签：entity-framework, design-patterns, ef-code-first, domain-driven-design

我想使用 Jimmy Nilsson 在他的书[Applying DDD with Patterns](https://rads.stackoverflow.com/amzn/click/com/0321268202)中提到的一个想法，那就是如果我有一个像***Product***这样的实体，我想为该实体拍摄历史信息的快照，一些像***ProductSnapshot***但我想知道如何使用 ORM 来实现它（我目前正在使用实体框架）。我面临的主要问题是，如果我有另一个像***OrderLine***这样的实体通过其构造函数接收***产品***，那么实体框架将需要您创建一个您希望保留的类型的公共属性，所以这将迫使我拥有这样的东西：

```
class OrderLine {
public Product Original Product {get; set;}
public ProductSnapshot Snapshot {get; set;}
} 
```

这看起来很尴尬而且不直观，当涉及到数据绑定（我应该绑定到哪个属性）时，我不知道如何正确处理它，最后我认为***Product***是一个**实体**，而***ProductSnapshot***是一个**值对象**加上仅当接受***OrderLine***并且之后不再需要***Product***时才会拍摄快照。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T08:40:14.957

做DDD的时候，忘记数据库存在。这意味着 ORM 也不存在。现在，因为您不必关心持久性和 ORM 限制，您可以根据域需要对 ProductSnapshot 进行建模。

创建一个包含所有必需成员的 ProductSnapshot 类。这个类可能是 SnapshotService.GetSnapshot(Product p) 的结果。获得 ProductSnapshot 后，只需将其发送到存储库 SnapshotsRepository.Save(snapshot) 。作为一个快照，这意味着它可能更像是一个数据结构，一个“哑”的对象。它也应该是不变的，“冻结”。

存储库将使用 EF 实际保存数据。您决定 EF 实体和关系是什么。ProductSnapshot 被持久性认为是一个业务对象（实际上它是否只是一个简单的 Dto 没关系），并且 EF 实体可能看起来非常不同（例如，我将业务对象以序列化形式存储在一个键中 -值表）根据您的查询需要。

定义 EF 实体后，您需要将 ProductSnapshot 映射到它们。ProductSnapshot 本身很可能可以用作 EF 实体，因此您不需要进行任何映射。

关键是，拍摄快照似乎是域行为。仅在获得快照后才处理 EF，并且您的操作与处理任何其他业务对象的方式完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:07:33.030

为什么 OrderLine 必须具有 ProductSnapshot 属性？我想，如果您需要获取该历史信息，您可以从 Product 类中获得 ProductSnapshot 的链接，或者，如果您只想在某些条件下保存 Product 状态，只需在 Product 部分类中实现 SaveSnapshot 方法，或者有它的扩展方法。

# python - 基于 Django 类的视图，get_absolute_url 不起作用

> ID：16004679
> 
> 赞同：4
> 
> 时间：2013-04-14T21:42:44.780
> 
> 标签：python, django

我购买并正在阅读这本书 Django 的两个勺子：Django 1.5 的最佳实践，其中有一个基于类的视图示例。在此实施之后，我在提交表单后收到错误。

```
ImproperlyConfigured at /NonProfitCreate/
No URL to redirect to.  Either provide a url or define a get_absolute_url method on the Model 
```

做研究我遇到了这个问题[Django - 基于类的通用视图 - “没有要重定向到的 URL”](https://stackoverflow.com/questions/6266415/django-class-based-generic-view-no-url-to-redirect-to)

我希望 get_absolute_url 在我的程序中工作

这是我的forms.py

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
#  npp/forms.py

from django import forms

from .models import NonProfit

class NonProfitCreateForm(forms.ModelForm):
    class Meta:
        model = NonProfit
        fields = ("name","contact_name","email","phone","address","image","tags",)

    def __init__(self, *args, **kwargs):
        self.request = kwargs.pop('request', None)
        return super(NonProfitCreateForm, self).__init__(*args, **kwargs)

    def save(self, *args, **kwargs):
        kwargs['commit']=False
        obj = super(NonProfitCreateForm, self).save(*args, **kwargs)
        if self.request:
            obj.user = self.request.user
            obj.save()

class NonProfitUpdateForm(NonProfitCreateForm):
    class Meta:
        model = NonProfit 
```

这是我的 models.py 和视图文件

```
from django.db import models
from django.contrib.auth.models import User
from django.db.models import permalink
from django_extensions.db.fields import AutoSlugField
from django.contrib import admin

from django.core.urlresolvers import reverse

import tagging
from tagging.models import Tag
# Create your models here.
''' this is for the Non-Profit Proccess '''

class NonProfit (models.Model):
    User = models.ForeignKey(User)
    name = models.CharField(max_length=100)
    contact_name = models.CharField(max_length=100)
    email = models.EmailField(max_length=75)
    phone = models.CharField(max_length=20)
    address = models.TextField(max_length=3000)
    image = models.ImageField(upload_to='photos/%Y/%m/%d',blank=True)

    slug = models.SlugField(max_length=128)
    slug = AutoSlugField(('slug'), max_length=128, unique=True, populate_from=('name',))
    tags = tagging.fields.TagField()

    def get_absolute_url(self):
        return reverse("npp/nonprofit_detail", kwargs={"slug": self.slug})  

    def __unicode__(self):
        return self.name

    def get_tags(self):
        return Tag.objects.get_for_object(self)

  # Create your views here.
    # Auction/npp/views.py

from Auction.views import ActionMixin

from django.contrib import messages
from django.views.generic import CreateView, UpdateView, DetailView

from braces.views import LoginRequiredMixin

from forms import NonProfitCreateForm,NonProfitUpdateForm

from models import NonProfit

class NonProfitCreateView(LoginRequiredMixin,ActionMixin,CreateView):
    model = NonProfit
    action = "created"
    form_class = NonProfitCreateForm

class NonProfitUpdateView(LoginRequiredMixin,ActionMixin,UpdateView):
    model = NonProfit
    action = "updated"
    form_class = NonProfitUpdateForm

class NonProfitDetailView(DetailView):
    model = NonProfit

# Auction/views.py
class ActionMixin(object):
    @property
    def action(self):
        msg = "{0} is missing action.".format(self.__class__)
        raise NotImplementedError(msg)

    def form_valid(self, form):
        msg = "{0}!".format(self.action)
        messages.info(self.request, msg)
        return super(ActionMixin, self).form_valid(form) 
```

网址.py

```
url(
    regex=r'^NonProfitCreate/',
    view=NonProfitCreateView.as_view(),
    name='NonProfitCreate',
),
url(
    regex=r'^NonProfit/(?P<slug>[-\w\d]+)/',
    view=NonProfitDetailView.as_view(),
    name='NonProfit'
    ) 
```

这是我的堆栈跟踪，django 大括号突出显示，并且

```
/home/talisman/projects/Auction/Auction/views.py in form_valid
        return super(ActionMixin, self).form_valid(form) 

EEnvironment:

Request Method: POST
Request URL: http://127.0.0.1:8000/NonProfitCreate/

Django Version: 1.5.1
Python Version: 2.7.4
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'django.contrib.admindocs',
 'django.contrib.comments',
 'django.contrib.sitemaps',
 'zinnia',
 'tagging',
 'mptt',
 'south',
 'misc',
 'adm',
 'registration',
 'npp',
 'blogs')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.clickjacking.XFrameOptionsMiddleware')

Traceback:
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/core/handlers/base.py" in get_response
  115\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/base.py" in view
  68\.             return self.dispatch(request, *args, **kwargs)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/django_braces-1.0.0-py2.7.egg/braces/views.py" in dispatch
  98\.             **kwargs)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/base.py" in dispatch
  86\.         return handler(request, *args, **kwargs)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/edit.py" in post
  199\.         return super(BaseCreateView, self).post(request, *args, **kwargs)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/edit.py" in post
  165\.             return self.form_valid(form)
File "/home/talisman/projects/auction/Auction/views.py" in form_valid
  54\.       return super(ActionMixin, self).form_valid(form)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/edit.py" in form_valid
  128\.         return super(ModelFormMixin, self).form_valid(form)
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/edit.py" in form_valid
  65\.         return HttpResponseRedirect(self.get_success_url())
File "/home/talisman/virt_env/Auction/local/lib/python2.7/site-packages/Django-1.5.1-py2.7.egg/django/views/generic/edit.py" in get_success_url
  119\.                     "No URL to redirect to.  Either provide a url or define"

Exception Type: ImproperlyConfigured at /NonProfitCreate/
Exception Value: No URL to redirect to.  Either provide a url or define a get_absolute_url method on the Model. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-20T14:32:52.230

产生此异常是因为`self.object = None`在有效编辑后尝试重定向时。由于 的值`self.object`是`form.save()`调用的结果，因此该错误最可能的原因是您已覆盖 中的`save()`方法`NonProfitCreateForm`，但忘记返回保存的对象。

该`Form.save()`方法应返回已保存且不应保存的对象`None`。

您`NonProfitCreateForm`可以修改如下所示：

```
class NonProfitCreateForm(forms.ModelForm):
    ...
    def save(self, *args, **kwargs):
        kwargs['commit']=False
        obj = super(NonProfitCreateForm, self).save(*args, **kwargs)
        if self.request:
            obj.user = self.request.user
            obj.save()
        return obj #<--- Return saved object to caller. 
```

您的方法的前两行`save()`将从输入的表单数据创建一个模型实例。但是因为`commit=False`，对象*不会*被保存到数据库中。如果`self.request`您的表单实例上不存在，则返回的对象将没有数据库主键，并且 `get_absolute_url`仍然会失败。

因此，您要确保`request`在实例化时始终将参数传递给您的表单。默认情况下不会发生这种情况，因此您需要安排视图代码以使用`request`参数实例化表单。

查看[代码，`FormMixin`](https://github.com/django/django/blob/1.5.1/django/views/generic/edit.py#L10)您可以看到有一个`get_form_kwargs`函数可以确定要传递给任何实例化表单的参数。您需要传递`request=self.request`，因此在您的视图中覆盖`get_form_kwargs`以添加所需的参数，如下所示：

```
class NonProfitCreateView(LoginRequiredMixin,ActionMixin,CreateView):
    model = NonProfit
    action = "created"
    form_class = NonProfitCreateForm

    def get_form_kwargs(self):
        # Ensure the current `request` is provided to NonProfitCreateForm.
        kwargs = super(NonProfitCreateView, self).get_form_kwargs()
        kwargs.update({ 'request': self.request })
        return kwargs 
```

`CreateView`使用修改后的`get_form_kwargs`函数创建一个子类并`NonProfitCreateView`从子类派生可能是一个更好的主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-19T23:52:39.173

当您使用 时`reverse`，请使用您希望反转的 url 模式的名称。

您希望重定向到此网址：

```
url(
    regex=r'^NonProfit/(?P<slug>[-\w\d]+)/',
    view=NonProfitDetailView.as_view(),
    name='NonProfit'
    ) 
```

因此，您的`get_absolute_url`方法应该是：

```
def get_absolute_url(self):
    return reverse("NonProfit", kwargs={"slug": self.slug}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-20T12:08:13.937

您可以覆盖基于类的视图的`get_success_url`功能。像这样：

```
def get_success_url(self):
    return reverse("NonProfit", kwargs={"slug": self.object.slug}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T22:15:32.083

尝试从您的方法中删除`@permalink`装饰器。`get_absolute_url`它不能与`reverse`.

此外，[Django 文档](https://docs.djangoproject.com/en/dev/ref/models/instances/#the-permalink-decorator)指出以下内容：

> `permalink`不再推荐使用装饰器。您应该`reverse()`在方法的主体中使用`get_absolute_url`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-29T02:08:13.700

[阅读Austin Phillips](https://stackoverflow.com/a/16651802/7728887)的第一句话后解决了这个问题：

```
 def form_valid(self, form):
        article = form.save(commit=False)
        article.author = self.request.user
        self.object = article.save()
        return super().form_valid(form) 
```

关键是 save`article.save()`的结果回到`self.object`

# java - 如何过滤使用 JSP 中的表达式语言显示的表？

> ID：16004680
> 
> 赞同：1
> 
> 时间：2013-04-14T21:42:49.550
> 
> 标签：java, jsp, jstl

这是我用来显示数据库数据的代码。

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/sql" prefix="sql"%>
<%@ page import="java.io.*,java.util.*,java.sql.*"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Book List</title>
</head>
<body>
    <sql:setDataSource var="snapshot" driver="com.mysql.jdbc.Driver"
        url="jdbc:mysql://localhost:3306/BookTracker" user="root" password="school" />

    <sql:query dataSource="${snapshot}" var="result">
SELECT * from BookTrackerSystem;
</sql:query>

    <table border="1" width="100%">
        <tr>
            <th>Book ID</th>
            <th>Book Name</th>
            <th>Book Author</th>
            <th>Book Genre</th>
            <th>Book Description</th>
            <th>Book Due Date</th>
            <th>Book Status</th>
            <th>Full Name</th>
        </tr>
        <c:forEach var="row" items="${result.rows}">
            <tr>
                <td><c:out value="${row.id}" /></td>
                <td><c:out value="${row.bookName}" /></td>
                <td><c:out value="${row.bookAuthor}" /></td>
                <td><c:out value="${row.bookGenres}" /></td>
                <td><c:out value="${row.bookDesc}" /></td>
                <td><c:out value="${row.bookDueDate}" /></td>
                <td><c:out value="${row.bookStatus}" /></td>
                <td><c:out value="${row.fullname}" /></td>
            </tr>
        </c:forEach>
    </table>
</body>
</html> 
```

我想要做什么，使用一个简单的文本框我希望能够过滤使用上面的代码显示的表格，我相信我可以使用 jQuery 来做到这一点，但 jQuery 与表达式语言兼容，或者我可以使用任何其他方法的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T01:24:12.217

尽管事实上几乎没有人会支持你所做的事情:) .. 我的意思是一切都在 JSP 中..

确切的答案如下：

1.  添加带有文本框的 html 表单。

2.  添加将文本框值读取为 request.getParameter() 的代码。 [http://www.tutorialspoint.com/jsp/jsp_form_processing.htm](http://www.tutorialspoint.com/jsp/jsp_form_processing.htm)

3.  将 (2) 中的值添加到您的查询`<sql:param value="..." />`和添加`where`子句中。也许，您将需要 IF 来处理两种情况：a) 过滤掉 - 没有文本值，也没有`where`b) 过滤 - 文本值存在并`where`使用。

不过，这将是一个服务器端处理（过滤）。

如果您想要客户端过滤，请考虑使用 DataTables [http://www.datatables.net/](http://www.datatables.net/)

# c++ - 尝试打印 3 种时间类型：通用、标准和军用（3 个文件）

> ID：16004681
> 
> 赞同：0
> 
> 时间：2013-04-14T21:42:50.973
> 
> 标签：c++, class, function, constructor

```
 #ifndef time_time_h

 #define time_time_h

class time

{

public:

time();
void settime(int h, int m, int s);
void printuniversal();
void printmilitary();
void printstandard();

private:

int hour;
int minute;
int second;
};

 #endif

  //////////////////.hfile////////////////

 #include <iostream>

using namespace std;

#include "time.h"

time::time()

{

int h, m, s;

hour=0;
minute=0;
second=0;

hour=h;
minute=m;
second=s;

}

void time::settime(int h, int m, int s)

{

if (h<=0||h>23||h==99)

{

    h=0;

}

if (m<=0||m>59||m==99)
{
    m=0;

}

if (s<=0||s>59||s==99)
{
    s=0;
}
}

void time::printuniversal()

{

if (hour<10)
{
cout<<"0"<<hour<<":";
}
else
    cout<<hour<<":";

if (minute<10)
{
cout<<"0"<<minute<<":";
}
else
    cout<<minute<<":";
if (second<10)
{
cout<<"0"<<second<<"\n";
}
else
    cout<<second<<"\n";

}

void time::printmilitary()

{

if (hour<10)
{
    cout<<"0"<<hour<<":";
}
else
    cout<<hour<<":";
if (minute<10)
{
    cout<<"0"<<minute<<"\n";
}
else
    cout<<minute<<"\n";
}

void time::printstandard()

{

if (hour>12)
{
    hour=hour-12;
    cout<<hour<<":";        
}
else if(hour<10)
{
    cout<<"0"<<minute<<":";
}

else
{
    cout<<hour<<":";
}

if(minute<10)
{
cout<<"0"<<minute<<":";
}

else
{
    cout<<minute<<":";
}

if(second<10)
{
    cout<<"0"<<second;
}

else
{
    cout<<second;
}

if (hour>12)
{
    cout<<" PM\n";
}

else
{
    cout<<"AM\n";
}
}
////////////////////cpp file//////////////

#include <iostream>
using namespace std;
#include "time.h"

int main()

{

int h, m, s;

time::time test;
test.settime(0,0,0);
test.printstandard();
test.printmilitary();
test.printuniversal();

time::time test2;
test2.settime(23, 4, 8);
test2.printstandard();
test2.printmilitary();
test2.printuniversal();

time::time test3;
test3.settime(99, 99, 99);
test3.printstandard();
test3.printmilitary();
test3.printuniversal();

cout<<"Enter hour, minutes, seconds:\n";
cin>>h>>m>>s;
time::time user;
user.settime(h, m, s);
user.printstandard();
user.printmilitary();
user.printuniversal();

return 0;
}
////////////main///////////////////// 
```

它应该与 settime (0,0,0)、settime(23,4,8) 和 settime(99,99,99) 一起输出。给予： 00:00:00AM 00:00 00:00:00 11:04:08AM 23:04 23:04:08 00:00:00AM 00:00 00:00:00 “输入小时、分钟、秒”

但是，我得到了一些荒谬的数字： 32755:2074578800:01 PM 32755:2074578800 32755:2074578800:01 32755:2074578800:01 PM 32755:2074578800 32755:2074578800:01

我似乎无法弄清楚我做错了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:45:43.317

您的 settime 函数没有设置任何内容。它只是测试有效值并将变量设置为零以防无效值。

您会得到奇怪的输出，因为在构造函数中您声明变量使用它们而不初始化它们。

这应该有效：

```
time::time()
{
    hour=0;
    minute=0;
    second=0;
}

void time::settime(int h, int m, int s)
{
    if (h<=0||h>23||h==99)
    {
        h=0;
    }

    if (m<=0||m>59||m==99)
    {
        m=0;
    }

    if (s<=0||s>59||s==99)
    {
        s=0;
    }
    hour = h;
    minute = m;
    second = s;
} 
```

# c# - C# 从一个图片框拖放到另一个图片框

> ID：16004682
> 
> 赞同：10
> 
> 时间：2013-04-14T21:42:52.790
> 
> 标签：c#, drag-and-drop, picturebox

我正在使用 C# 在 Visual Studio 2012 中工作，我需要将图片框拖动到另一个图片框中，基本上将目标图片框图像替换为拖动的图片框图像。

我该怎么做呢？

请具体一点，并尝试尽可能简单和最好地解释。我对编程非常陌生，有点绝望，所以请耐心等待。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-14T23:35:11.420

拖放在 PictureBox 控件上隐藏。不知道为什么，它工作得很好。这里可能的指导是，对于用户来说，您可以将图像放在控件上并不明显。您必须对此做一些事情，至少将 BackColor 属性设置为非默认值，以便用户可以看到它。

无论如何，您需要在第一个图片框上实现 MouseDown 事件，以便您可以单击它并开始拖动：

```
 private void pictureBox1_MouseDown(object sender, MouseEventArgs e) {
        var img = pictureBox1.Image;
        if (img == null) return;
        if (DoDragDrop(img, DragDropEffects.Move) == DragDropEffects.Move) {
            pictureBox1.Image = null;
        }
    } 
```

我假设您想移动图像，如果需要复制，则在必要时进行调整。然后你必须在第二个图片框上实现 DragEnter 和 DragDrop 事件。由于属性是隐藏的，您应该在表单的构造函数中设置它们。像这样：

```
 public Form1() {
        InitializeComponent();
        pictureBox1.MouseDown += pictureBox1_MouseDown;
        pictureBox2.AllowDrop = true;
        pictureBox2.DragEnter += pictureBox2_DragEnter;
        pictureBox2.DragDrop += pictureBox2_DragDrop;
    }

    void pictureBox2_DragEnter(object sender, DragEventArgs e) {
        if (e.Data.GetDataPresent(DataFormats.Bitmap))
            e.Effect = DragDropEffects.Move;
    }

    void pictureBox2_DragDrop(object sender, DragEventArgs e) {
        var bmp = (Bitmap)e.Data.GetData(DataFormats.Bitmap);
        pictureBox2.Image = bmp;
    } 
```

这确实允许您将图像从另一个应用程序拖到框中。让我们称之为功能。如果您想禁止这样做，请使用 bool 标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-28T22:04:19.457

汉斯的回答使我找到了正确的解决方案。该答案的问题在于，放入`DoDragDrop`内部`MouseDown`会阻止`MouseClick`事件触发。

这是我的解决方案：

```
private void PictureBox_MouseMove(object sender, MouseEventArgs e)
{
    if (e.Button == MouseButtons.Left)
    {
        var pb = (PictureBox)sender;
        if (pb.BackgroundImage != null)
        {
            pb.DoDragDrop(pb, DragDropEffects.Move);
        }
    }
}

private void PictureBox_DragEnter (object sender, DragEventArgs e)
{
    e.Effect = DragDropEffects.Move;
}

private void PictureBox_DragDrop (object sender, DragEventArgs e)
{
    var target = (PictureBox)sender;
    if (e.Data.GetDataPresent(typeof(PictureBox)))
    {
        var source = (PictureBox)e.Data.GetData(typeof(PictureBox));
        if (source != target)
        {
            // You can swap the images out, replace the target image, etc.
            SwapImages(source, target);
        }
    }
} 
```

[我的GitHub 上](https://github.com/javon27/PictureBox_DragDrop_Example)的完整工作示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T22:32:27.987

您可以使用鼠标进入和离开事件轻松完成此操作。例如，您有两个图片框pictureBox1 和pictureBox2。你想把图片从图片框1拖放到图片框2上，做这样的事情。

```
private void pictureBox2_MouseUp(object sender, MouseEventArgs e)
{
    if (a == 1)
    {
        pictureBox1.Image = pictureBox2.Image;
        a = 0;
    }
}

private void pictureBox1_MouseEnter(object sender, EventArgs e)
{
    a = 1;
} 
```

其中“a”只是一个锁或钥匙，用于检查鼠标是否已进入我们要放置此图像的控件。希望它有帮助，对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-04T10:36:03.317

1.  您不能在 PictureBox 上设置 AllowDrop ...为您的整个表单设置它。

代码片段

Form1.AllowDrop = true;

2.  使用 Form DragEnter、DragDrop 事件，即使您将其放在图片框上，它们也会起作用。

私人无效Form1_DragEnter（对象发送者，DragEventArgs e）

{

```
e.Effect = DragDropEffects.Move; 
```

}

私人无效Form1_DragDrop（对象发送者，DragEventArgs e）

{

```
int x = this.PointToClient(new Point(e.X, e.Y)).X;

int y = this.PointToClient(new Point(e.X, e.Y)).Y;

if(x >= pictureBox1.Location.X && x <= pictureBox1.Location.X + pictureBox1.Width && y >= pictureBox1.Location.Y && y <= pictureBox1.Location.Y + pictureBox1.Height)

{

    string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);

    pictureBox1.Image = Image.FromFile(files[0]);

} 
```

}

# node.js - ObjectID.createFromHexString 无法识别输入的十六进制字符串

> ID：16004683
> 
> 赞同：1
> 
> 时间：2013-04-14T21:43:04.237
> 
> 标签：node.js, mongodb

我正在通过 Ciaran Jessup 的创建基本博客的演练作为对节点的介绍。当我尝试查看一篇文章时，我收到以下错误：

```
500 Error: Argument passed in must be a single String of 12 bytes or a string of 24 hex characters
at Function.createFromHexString (/Users/me/Dropbox/projects/node/howtonode_blog/node_modules/mongodb/node_modules/bson/lib/bson/objectid.js:212:11)
at /Users/me/Dropbox/projects/node/howtonode_blog/articleprovider-mongodb.js:38:64
at /Users/me/Dropbox/projects/node/howtonode_blog/articleprovider-mongodb.js:16:10
at Db.collection (/Users/me/Dropbox/projects/node/howtonode_blog/node_modules/mongodb/lib/mongodb/db.js:484:44)
at ArticleProvider.getCollection (/Users/me/Dropbox/projects/node/howtonode_blog/articleprovider-mongodb.js:14:11)
at ArticleProvider.findById (/Users/me/Dropbox/projects/node/howtonode_blog/articleprovider-mongodb.js:34:10)
at app.post.articleProvider.addCommentToArticle.person (/Users/me/Dropbox/projects/node/howtonode_blog/app.js:51:19)
at callbacks (/Users/me/Dropbox/projects/node/howtonode_blog/node_modules/express/lib/router/index.js:161:37)
at param (/Users/matty/Dropbox/projects/node/howtonode_blog/node_modules/express/lib/router/index.js:135:11)
at param (/Users/matty/Dropbox/projects/node/howtonode_blog/node_modules/express/lib/router/index.js:132:11) 
```

以下是相关的代码：

来自 app.js：

```
app.get('/blog/:id', function(req, res) {
  articleProvider.findById(req.param.id, function(error, article) {
    res.render('blog_show.jade',{title: article.title, article: article})
  })
}) 
```

来自 articleprovider-mongodb.js：

```
ArticleProvider.prototype.findById = function(id, callback) {
    this.getCollection(function(error, article_collection) {
      if(error) callback(error);
      else {
        article_collection.findOne(
         // THIS IS THE LINE IN QUESTION BELOW
          {_id: article_collection.db.bson_serializer.ObjectID.createFromHexString(id)}, 
          function(error, result) {
            if(error) callback(error);
            else callback(null, result);
          }
        );
      }
    });
}; 
```

我试图将`id`对象转换为字符串，并尝试直接将其作为对象传递。但是，我的 javascript 非常糟糕，而且我没有运气。我尝试过传递`String(id)`，`id + ""`而不是`id`与：

`{_id: id}`

和

`{_id: article_collection.db.bson_serializer.ObjectID(id)}`

我真的很感激有人指出我做错了什么。

谢谢阅读！

**编辑：** `console.log("req.param.id is " + req.param.id)`输出“req.param.id is undefined” 但是，url`http://localhost:3000/blog/516afb1064036bb345000001`是正确的，因为我将 516afb1064036bb345000001 直接传递给`ArticleProvider.findById`调用并且它有效。

**编辑 2：**当我更改`req.param.id`为`req.params.id`. 但是，在我的`app.post`函数中，我使用了`param`如下的单数并且仍然有效：

```
articleProvider.save({
    title: req.param('title'),
    body: req.param('body')
  }  ... 
```

为什么单数`param`在这里起作用？是否`params`特指在 URI 中传递的参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T21:48:19.077

在没有实际显示`id`正在传递的内容的情况下，我建议您验证路线。添加这个：

```
app.get('/blog/:id([0-9a-f]{24})' 
```

这将确保传递的 id 始终有效。

最好`ObjectID`从 mongodb 或 bson 库中获取，而不是达到这么多级别。

```
var ObjectID = require('mongodb').ObjectID

// later
var id = ObjectID.createFromHexString(req.params.id) 
```

如果这些不起作用，请向我们展示正在通过的实际字符串`console.log(req.params.id)`

此外，查询中的最后一个回调`findOne()`是完全没有必要的。事实上，你可以这样做`collection.findOne(id, callback)`

# java - 单击按钮时启动视频 - Android

> ID：16004688
> 
> 赞同：0
> 
> 时间：2013-04-14T21:43:30.080
> 
> 标签：java, android, button, video, android-videoview

嘿！

我想创建一个有 3 个按钮的程序。每个按钮都会启动一个新活动（videoview），该活动会在启动时自动播放我的 res/raw 文件夹中的视频。下面的代码没有显示任何错误，但只是不工作，即它启动了视频视图但不显示任何视频。

我的主要活动：

```
public class MainActivity extends Activity {

String uri;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

}

public void playsquirrelmp4(View v) {
    Intent VideoIntent = (new Intent(this, VideoActivity.class));
    VideoIntent.putExtra("android.resource://" + getPackageName() + "/"+ R.raw.squirrel, uri);
    startActivity(VideoIntent);
} 
```

播放视频的我的 VideoActivity

```
public class VideoActivity extends Activity {

VideoView vid;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.videoview);

    vid = (VideoView) findViewById(R.id.videoview);
    vid.setMediaController(new MediaController(this));

    Intent myIntent = getIntent();

    String uri = myIntent.getStringExtra("uri");
            Bundle b = myIntent.getExtras();

    b.getString(uri);

}

public void startVideo(String uriString) {

    Uri uri = Uri.parse(uriString);
    vid.requestFocus();
    vid.setVideoURI(uri);
    vid.start();
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T02:17:33.090

在发送方和接收方，您的意图额外必须具有相同的密钥。
更改如下：

```
public void playsquirrelmp4(View v) {
    Intent VideoIntent = (new Intent(this, VideoActivity.class));
    VideoIntent.putExtra("uri", "android.resource://" + getPackageName() + "/"+ R.raw.squirrel, uri);
    startActivity(VideoIntent);
} 
```

您的 startVideo() 方法没有被调用，因此您不能指望视频开始。
请尝试以下方法！

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.videoview);

    vid = (VideoView) findViewById(R.id.videoview);
    vid.setMediaController(new MediaController(this));

    Intent myIntent = getIntent();

    String uri = myIntent.getStringExtra("uri");
            Bundle b = myIntent.getExtras();

    startVideo( b.getString(uri) ); // call startVideo here

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:46:56.077

尝试调用VideoActivity`startVideo`的`onCreate`方法，然后如果您不希望视频开始自动暂停它。

此外，如果您在模拟器上进行测试，有时我会遇到 videoView 问题，但在真实设备上它总是可以正常工作。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:43:32.997

从调试信息来看，MainActivity 中的 VideoIntent 似乎无法将视频的路径发送到 VideoActivity。我从 uriString 收到 NullPointerException 错误。我认为其中一些代码来自

视频活动

```
Intent myIntent = getIntent();
String uri = myIntent.getStringExtra("uri");
Bundle b = myIntent.getExtras();

startVideo(b.getString(uri)); 
```

无法从 Mainactivity 接收 uri：

```
 public void playsquirrelmp4(View v) {
    Intent VideoIntent = (new Intent(this, VideoActivity.class));
    VideoIntent.putExtra("android.resource://" + getPackageName()
    + "/"+   R.raw.squirrel, uri);
    startActivity(VideoIntent);
} 
```

# c - 如何在 C 中按键入顺序打印整数 - 递增、递减或均匀

> ID：16004689
> 
> 赞同：0
> 
> 时间：2013-04-14T21:43:40.727
> 
> 标签：c, printing, integer, typing

我正在尝试编写的交流程序有问题。程序必须将整数存储在数组中（从键盘读取）。数字必须按输入的顺序打印出来，例如如果输入：3 2 0 5 5 5 8 9，输出应该是：

3 2 0 - 减少 5 5 5 - 均匀 8 9 - 增加

对我来说，问题是，我无法编写一个能够在所有情况下工作的算法。我试图用另一个数组“标记”元素（使用相同的索引，为每个整数保存一个值 1-表示增加，-1-表示减少，0 表示均匀），但这部分有效。你还有其他想法吗？提前致谢 ：）

```
#include <stdio.h>
#include <stdlib.h>

main() {

    int array[100];
    int flag[100];
    int num, i;

    printf("Enter how many numbers you want to type: ");
    scanf("%d",&num);

    for(i=0;i<num;i++) {
        scanf("%d",&array[i]);
    }
    for(i=0;i<num;i++){
        if((array[i]<array[i+1])) {
            flag[i]=flag[i+1]=1;
        }
        if(array[i]>array[i+1]) {
            flag[i]=flag[i+1]=-1;
        }
    }

    for(i=0;i<num;i++) {
        if(array[i]==array[i+1]) {
            flag[i]=flag[i+1]=0;
        }
    }
    for(i=0;i<num;i++){
        printf("%d ",flag[i]);
    } 
    printf("\n");

    for(i=0;i<num;i++) {
        if(flag[i]==1) {
            do{
                if(flag[i]==1){
                    printf("%d ",array[i]);
                    i++;
                }
            }while(flag[i]==1);
            printf(" - increasing\n");
        }

        if(flag[i]==0) {
            do{
                if(flag[i]==0){
                    printf("%d ",array[i]);
                    i++;
                }
            }while(flag[i]==0);
            printf(" - evenly\n");
        }

        if(flag[i]==-1) {
            do{
                if(flag[i]==-1) {
                    printf("%d ",array[i]);
                    i++;
                }
            }while(flag[i]==-1);
            printf(" - decreasing\n");
        }

    } 

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:35:00.123

想法：

*   只有在看到“第二个”数字后，才能知道“第一个”数字是属于降序、偶数还是升序。

*   “第三个”数字要么属于与前两个相同的序列，要么是另一个序列的“第一个”数字。

所以：检查两个数字并分配一个序列类型。
继续以相同的顺序检查数字。
当您无法分配相同的序列时，请返回检查两个数字并分配一个序列。

就像是

```
int *n1, *n2, *n3;
n1 = <first element>;
n2 = n1 + 1;
n3 = n2 + 1;

/* some kind of loop */
if ((n3 - n2) HAS_SOME_SIGN_AS (n2 - n1)) /* n3 belongs to the sequence */;
n1++;
n2++;
n3++;
/* end loop */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T23:13:34.563

```
#include <stdio.h>

int status(a, b){
    if(a < b) return 1;
    if(a > b) return -1;
    return 0;
}

int main() {
    int array[100]={0};
    int old_status, new_status;
    int old_pos;
    int num, i, j;
    const char* status_message[] = {"decreasing","evenly","increasing", "i don't know"};

    printf("Enter how many numbers you want to type: ");
    scanf("%d",&num);
    for(i=0;i<num;i++)
        scanf("%d",&array[i]);

    //{num | 1 < num <= 100}
    old_status =status(array[0], array[1]);
    old_pos = 0;
    for(i=1;i<num;++i){
        new_status = status(array[i-1], array[i]);
        if(old_status != new_status){
            for(j=old_pos;j<i;++j)
                printf("%d ", array[j]);
            printf("- %s\n", status_message[1 + old_status]);
            old_status = (i<num-1)? status(array[i], array[i+1]):2;
            old_pos = i;
        }
    }
    if(old_pos < num){ //not output section output
        for(j=old_pos;j<i;++j)
            printf("%d ", array[j]);
        printf("- %s\n", status_message[1 + old_status]);
    }

    return 0;
} 
```

# actionscript-3 - 为什么一次只有一个动作脚本工作？

> ID：16004692
> 
> 赞同：0
> 
> 时间：2013-04-14T21:43:48.103
> 
> 标签：actionscript-3, flash

我是 Flash 新手，正在尝试构建一个非常简单的游戏，其中涉及使用箭头键移动一个影片剪辑并避开其他三个影片剪辑。第一帧上还有一个开始按钮。只要其他 4 个被注释掉，每个单独的动作脚本就可以自己工作。但是，一旦我尝试使用多个动作脚本，它们都不起作用。我在它自己的层中有每个动作脚本。

我确定我很明显错过了一些东西，但是多个动作脚本如何同时工作？任何感谢将不胜感激

这是代码

```
/*Start*/
import flash.events.MouseEvent;

stop();
btn1.addEventListener(MouseEvent.CLICK,buttonClickHandler);
function buttonClickHandler(event:MouseEvent):void{
    gotoAndPlay(2);
}

/*Drive*/
function hearKey(yourEvent:KeyboardEvent):void{
if (yourEvent.keyCode==Keyboard.RIGHT){
LionOne_mc.x +=  8;
};
if (yourEvent.keyCode==Keyboard.LEFT){
LionOne_mc.x -=  8;
};
if (yourEvent.keyCode==Keyboard.UP){
LionOne_mc.y -=  8;
};
if (yourEvent.keyCode==Keyboard.DOWN){
LionOne_mc.y +=  8;
};
};
stage.addEventListener(KeyboardEvent.KEY_DOWN,hearKey);

/*Colision*/
kangaTwo.addEventListener(Event.ENTER_FRAME,LionHit2);
function LionHit2(event:Event):void {
if (kangaTwo.hitTestObject(LionOne_mc)) {
tackle_mc.visible = true;
} else {
tackle_mc.visible = false;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:27:46.637

您可以在一个框架中拥有跨多个层的脚本。没有问题。它们只会从最顶层运行到最底层。

虽然在技术上是可行的，但我不推荐它。时间线代码在最好的时候是混乱的，所以最好把它全部放在一层中。最佳实践也是将此图层置于顶部，其上没有视觉元素，并将图层命名为“Actions”。

如果您正在调用`gotoAndStop(2);`，那么第一帧上的所有代码都将停止运行。

当您有机会时，您绝对应该考虑使用外部 ActionScript 类，而不是编写时间线代码。这里有一个很棒的教程：[active.tutsplus.com - AS3 101: OOP Introduction – Basix](http://active.tutsplus.com/tutorials/actionscript/as3-101-oop-introduction-basix/)

# javascript - Jquery FullCalendar 使事件在特定日期发生

> ID：16004698
> 
> 赞同：0
> 
> 时间：2013-04-14T21:44:13.537
> 
> 标签：javascript, jquery, fullcalendar

我正在使用 Jquery FullCalendar [http://arshaw.com/fullcalendar/docs/event_data/events_json_feed/](http://arshaw.com/fullcalendar/docs/event_data/events_json_feed/)

尝试设置每周发生的事件。

```
In my database its stored as
DayOfTheWeek 1 (1-5 specifies monday to firday)
StartTime 10:00:00
EndTime 13:00:00 
```

无论如何我可以将其转换为 Fullcalendar Event 对象吗？

```
events: [{
        title: 'Event One',
        id: 1,  
        start: Monday 10AM,
        end: Monday 1PM
    },
    {
        title: 'Event Two',
        id: 2, 
        start: Tuesday 10AM,
        end: Tuesday 5pm
    },
    ] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T01:41:35.603

这个 php 代码应该可以帮助您：

```
/* create this array from SQL query*/
$events=array(
    array('title'=>'Event One', 'day'=>2, 'startTime'=> '10:00:00', 'date'=>getFirstOfMonthDate(2)),
    array('title'=>'Event Two', 'day'=>4, 'startTime'=> '13:00:00' ,'date'=>getFirstOfMonthDate(4))

);
/* number of weeks to generate*/
$num_weeks=10;
/* calling this function outputs recurring events JSON*/
createRecurringEventsJSON( $events, $num_weeks);

/* functions*/
function createRecurringEventsJSON( $events, $num_weeks){
    $output=array();

    for($i=0;$i<$num_weeks;$i++){
      for($j=0; $j< count($events) ;$j++){
          $output[]= createEvent($events[$j]['date'],$events[$j]['title'],$events[$j]['startTime']);
          $events[$j]['date']=datePlusOneWeek($events[$j]['date']);
      }
    }
    echo json_encode($output);

}

function datePlusOneWeek($date){
    return date('Y-m-d',strtotime ( '+1 week' , strtotime ( $date ) ));

}

function getFirstOfMonthDate( $dayNumber){
    /* first is blank so index 1 =Monday, 5=Friday*/
    $days=array('','Monday','Tuesday','Wednesday','Thursday','Friday');
    $fullMonthText=date('F');
    $dayText=$days[$dayNumber];
    $year = date('Y');
    /* strtotime accepts "first Monday of December 2013" format*/
    $textString='first '.$dayText.' of '.$fullMonthText.' '.$year;
    return date('Y-m-d', strtotime($textString));

}

/* returns calendar event object*/
function createEvent($date,$title,$time){
   return array('title'=>$title, 'start'=>$date.' '.$time,'allDay'=> false );
}; 
```

样本输出：

```
[
    {
        "title": "Event One",
        "start": "2013-04-02 10:00:00",
        "allDay": false
    },
    {
        "title": "Event Two",
        "start": "2013-04-04 13:00:00",
        "allDay": false
    },
    {
        "title": "Event One",
        "start": "2013-04-09 10:00:00",
        "allDay": false
    },
    {
        "title": "Event Two",
        "start": "2013-04-11 13:00:00",
        "allDay": false
    }
] 
```

# c - 客户端服务器通信中的校验和代码

> ID：16004700
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:44:16.350
> 
> 标签：c, client-server, checksum

我编写了一个代码来发送 TCP 数据包并接收确认数据包。

我想在代码中实现校验和以检查数据一致性，但未能编写代码（用 C 语言）来检查数据一致性。

请给我代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:40:11.930

执行此操作的常用方法是使用[zlib 校验和函数](http://www.zlib.net/manual.html#Checksum)之一，例如`crc32`.

在源代码顶部添加

```
#include <zlib.h> 
```

用类似的东西初始化CRC

```
my_crc = crc32(0L, Z_NULL, 0); 
```

然后根据需要多次添加数据，通常在某些循环上下文中

```
my_crc = crc32(my_crc, (unsigned char *)some_buffer_pointer, length_of_buffer); 
```

记得链接 zlib 库

```
-lz 
```

如果您不想使用库函数，例如您在 MPU 上，那么您可以使用[http://www.opensource.apple.com/source/xnu/xnu-1456.1.26/bsd/ libkern/crc32.c?txt](http://www.opensource.apple.com/source/xnu/xnu-1456.1.26/bsd/libkern/crc32.c?txt)。

如果您的平台上没有 zlib，您可以从[http://www.zlib.net/](http://www.zlib.net/)下载它。

如果您在 Windows 上，希望其他人会建议使用什么。

# c++ - 使用 cpp 将节点插入二叉搜索树

> ID：16004701
> 
> 赞同：0
> 
> 时间：2013-04-14T21:44:17.107
> 
> 标签：c++

我在尝试将节点插入二叉搜索树时遇到问题。我不断得到

错误 LNK2019：未解析的外部符号“public：__thiscall tr​​ee::tree(void)”(??0?$tree@H@@QAE@XZ)

有人可以告诉我问题是什么。

**树节点.h**

```
template <class T> class tree;

//treenode class-template definition
template <class T>
class treenode
{
friend class tree<T>;

public:

    treenode(const T &d, treenode<T> *l, treenode<T> *r)
        : data(d), leftptr(l), rightptr(r)
    {

    }

    treenode(const T &d):
        leftptr(0),
        data(d),
        rightptr(0)
    {

    }

    T getData() const
    {
        return data;
    }

private:
    treenode<T> *leftptr;
    T data;
    treenode<T> *rightptr;
};//end class treenode 
```

**树.h**

```
class tree
{
public:
    tree(); //initializes the private data member

    void insertNode (treenode<T> **, const T &);
    void preOrderTraversal(treenode<T> * ) const;
    void postOrderTraversal(treenode<T> * ) const;
    void inorderTraversal(treenode<T> *) const;

private:
    treenode<T> *rootptr;
}; 
```

**树.cpp**

```
#include <iostream>
#include "tree.h"
using namespace std;

//constructor
template< class T>
tree<T>::tree()
{
rootptr = 0; //indicate tree is initially empty
}//end tree constructor

//insert node in tree
template <class T>
void tree<T>::insertNode(treenode<T> **rootptr, const T &val)
{
// subtree is empty; create new treenode containing value
if(*rootptr == 0)
    *rootptr = new treenode<T>(val);
else // subtree is not empty
{
    // data to insert is less than data in current node
    if(val < (*rootptr)->data)
    {
        insertNode(&((*rootptr)->leftptr), val);
    }
    else
    {
        // data to insert is greater than data in current node
        if(val > (*rootptr)->data)
        {
            insertNode(&((*rootptr)->rightptr), val);
        }
    }//end else
}//end else
}//end function insertNode 
```

**测试器.cpp**

```
int main()
{
   tree <int> create;
   int userVal;

   cout << "Enter 10 Integers" << "\n\n";
   for(int i=0; i<10; i++)
{
    cout << "-> ";
    cin >> userVal;
    createTree.insertNode(0, userVal);
    }

   system("pause");
   return 0;
}//end main 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:52:57.130

问题是头文件`tree`中没有**定义构造函数。**`tree.h`编译器需要模板的完整定义才能实例化它。现在，发生的情况是某个文件包含 tree.h，编译器看到该类的类定义，`tree`但找不到其构造函数的定义。

因此，您需要将 tree.cpp 文件中的所有内容移动到 tree.h 中。（这不适用于普通的非模板类。）

它实际上比这稍微复杂一些： [Storing C++ template function definitions in a .CPP file](https://stackoverflow.com/questions/115703/storing-c-template-function-definitions-in-a-cpp-file)

因此，您可以将定义放在 .cpp 文件中，但前提是您为要使用的所有类型显式实例化模板。最简单的解决方案仍然是将整个定义放在头文件中。

# build - Nant 不会识别 namespace.Properties

> ID：16004705
> 
> 赞同：0
> 
> 时间：2013-04-14T21:44:26.197
> 
> 标签：build, nant, csc

我正在尝试使用 nant 为 ac# 项目构建解决方案，但是在我的构建文件中指定资源时遇到问题。我收到错误代码：CS0234：名称空间“Darkside”中不存在类型或名称空间名称“Properties”。如何修改我的构建文件以消除错误？

这是我的源文件中导致问题的代码片段之一：

```
Image enemyImage = DarkSide.Properties.Resources.DarkSide_Asteroid_Medium_Gray; 
```

其中 Darkside 是项目的命名空间，其余访问资源

这是我的构建文件的片段：

```
<target name="build" depends="init" description="compiles the source code">
    <property name="build.dir" value="${project::get-base-directory()}/${project::get-name()}/bin/release/${project.version}${basedir.suffix}"/>        
    <mkdir dir="${build.dir}"/>
    <csc target="exe" output="${build.dir}/Darkside.exe" debug="${build.debug}">

        <sources>
            <include name="Darkside/*.cs"/>
        </sources>

        <resources >
            <include name="${project::get-base-directory()}/${project::get-name()}/Properties/**" />
        </resources>
    </csc>
</target> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:00:26.623

您可能应该`prefix`为`resources`标签定义 （使用 dynamicprefix="true"）。

```
<target name="build" depends="init" description="compiles the source code">
    <property name="build.dir" value="${project::get-base-directory()}/${project::get-name()}/bin/release/${project.version}${basedir.suffix}"/>        
    <mkdir dir="${build.dir}"/>
    <csc target="exe" output="${build.dir}/Darkside.exe" debug="${build.debug}">

        <sources>
            <include name="Darkside/*.cs"/>
        </sources>

        <resources dynamicprefix="true" prefix="DarkSide">
            <include name="${project::get-base-directory()}/${project::get-name()}/Properties/**" />
        </resources>
    </csc>
</target> 
```

事实上，该`csc`任务的[文档](http://nant.sourceforge.net/release/0.91/help/tasks/csc.html)指出：

> 注意：为了让`<csc>`任务生成与 Microsoft Visual Studio.NET 生成的清单资源名称相匹配，`<resources>`元素的前缀属性的值应与 C# 项目的“默认命名空间”以及 dynamicprefix 属性的值匹配应设置为“真”。

# c# - 实体条目的意外 GetType() 结果

> ID：16004707
> 
> 赞同：35
> 
> 时间：2013-04-14T21:44:32.023
> 
> 标签：c#, entity-framework, ef-code-first, dbcontext, objectstatemanager

当我遍历`ObjectStateEntries`我期望的`[t]`变量名时`MY_ENTITY`

```
foreach (ObjectStateEntry entry in context.ObjectStateManager.GetObjectStateEntries(EntityState.Deleted))
{
    Type t = entry.Entity.GetType();
    ...
} 
```

但真实的我有

```
System.Data.Entity.DynamicProxies.MY_ENTITY_vgfg7s7wyd7c7vgvgv..... 
```

如何确定可以将当前条目转换为`MY_ENTITY`类型？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-04-14T22:58:34.640

您可以通过以下方式获取代理类型的原始实体类型

```
ObjectContext.GetObjectType(entity.GetType()) 
```

这是 的[静态方法`ObjectContext`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.getobjecttype.aspx)，因此您可以在`DbContext`环境中轻松使用。

如果由于某种原因您需要将实际实体作为其原始类型，则可以使用该模式

```
var entity = entry.Entity as MyEntity;
if (entity != null)
{
    ...
} 
```

这比

```
if (entry.Entity is MyEntity)
{
    var entity = (MyEntity)entry.Entity;
    ...
} 
```

因为后一个片段将对象投射了两次。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-07-04T08:53:13.933

您可以使用

```
Type t = entry.Entity.GetType().BaseType; 
```

或者

```
ObjectContext.GetObjectType(entity.GetType()) 
```

但从我的角度来看，这种`second`方式是**更好的方式。**如果您在 Mapper 方法中调用 Type() 请求，例如 DTO 映射器（从实体对象到 DTO 类或从内存中对象到 DTO 类），将**始终**`ObjectContext.GetObjectType(..)` 授予您预期的结果，这与将**`.GetType().BaseType`**

 **例如，如果您对 EF 实体模型使用[TPT（按类型表）](http://weblogs.asp.net/manavi/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-2-table-per-type-tpt)策略，则在内存对象上调用 BaseType() 将返回层次结构中的基类，这与`ObjectContext.GetObjectType(..)`

![在此处输入图像描述](https://i.stack.imgur.com/sqPC4.jpg)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-09T12:04:08.703

另一种方法是访问`BaseType`返回的代理类型的属性：

```
Type t = entry.Entity.GetType().BaseType; 
```**

# javascript - 加载图像后隐藏进度条

> ID：16004710
> 
> 赞同：1
> 
> 时间：2013-04-14T21:44:42.460
> 
> 标签：javascript, jquery, progress-bar

我有一个带有 Bootstrap、CSS 和 jQuery 的进度条。一切正常，但我希望这个栏在所有图像加载后消失。为此，我尝试放入以下脚本：

```
if(n==100) { $('#fabbar').hide(); } 
```

这是脚本：

```
$(function () {
    var n = 0,
    $imgs = $('img.gallery'),
    val = 100 / $imgs.length,
    $bar = $('#fabbar');

    $imgs.load(function () {
      n = n + val;
      // for displaying purposes
      $bar.width(n + '%').text(n + '%');            
    });

  if(n==100) { $('#fabbar').hide(); }

  }); 
```

在我的身体里，我有：

```
 <div class="progress progress-info progress-striped active">
    <div class="bar" id='fabbar' style="width: 20%">0%</div>
    </div>

    <a href="images/1.jpg"><img class="gallery" src="images/1.jpg"></a>
    <a href="images/2.jpg"><img class="gallery" src="images/2.jpg" ></a>    
    <a href="images/3.jpg"><img class="gallery" src="images/3.jpg" ></a>
    <a href="images/4.jpg"><img class="gallery" src="images/4.jpg" ></a>

... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-15T07:43:00.687

为此使用 WaitforImages jquery 插件： [https ://github.com/alexanderdickson/waitForImages](https://github.com/alexanderdickson/waitForImages)

这是它应该如何工作的：

```
$(function () {
    var n = 0,
        $imgs = $('img'),
        val = 100 / $imgs.length,
        $bar = $('#fabbar');

    $imgs.load(function () {
        n = n + val;
        // for displaying purposes
        $bar.width(n + '%').text(n + '%');
    });

});

$('body').waitForImages(function() {
    // All descendant images have loaded, now hide the progress bar.
    $(".bar_wrap").fadeOut();
}); 
```

查看演示（（单击运行按钮）） [http://jsfiddle.net/yphM4/24/](http://jsfiddle.net/yphM4/24/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:07:23.180

应该管用：

```
$(function () {
    var n = 0,
        $imgs = $('img.gallery'),
        val = 100 / $imgs.length,
        $bar = $('#fabbar');
    $("img").one('load', function () {
        n = n + val;
        // for displaying purposes
        $bar.width(n + '%').text(n + '%');
         n === 100?$('#fabbar').hide():false;       
    }).each(function () {
        if (this.complete) $(this).load();
    });
}); 
```

# java - 在java中使用超出范围的整数

> ID：16004712
> 
> 赞同：0
> 
> 时间：2013-04-14T21:44:50.607
> 
> 标签：java, rsa

从事一个处理 RSA 加密和解密的项目，其中一部分正在使用这个数字

```
int modulus = 270653957405596110781 
```

这是一个 68 位的数字，我知道 long 只能达到 64 位，那么我将如何解决这个问题？

我试了整个

```
 public static void main(String [] args){

    long modulus = 270653957405596110781L;

} 
```

事情仍然没有运气，因为它是一个 68 位的数字，而不是我说的 64。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:46:15.753

您将不得不使用`BigInteger`：

```
BigInteger modulus = new BigInteger("270653957405596110781"); 
```

[Javadocs](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:46:32.810

使用[BigInteger](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html)。它被设计为支持任意大整数运算。

顺便说一句，我希望您不要自己重新实现 RSA 加密。JDK 原生支持 RSA。

# qt - Qt 有像 Word 这样的组合框吗？

> ID：16004713
> 
> 赞同：0
> 
> 时间：2013-04-14T21:45:07.133
> 
> 标签：qt, combobox

在 Microsoft Word 中，如果您想使用项目符号，您有一个组合框（如果我们可以称它为组合框）来选择项目符号的形状（通过单击小三角形），或者您可以通过单击应用默认的组合框的按钮。

![在此处输入图像描述](https://i.stack.imgur.com/UFwvy.png)

实际上 Word 中的组合框有两个部分。例如，让我们考虑一种情况，我想在 Qt 中有一个组合框，其中包含以下项目作为菜单项： **"Restart"**、**"Shutdown"**和**"Log off"**。用户需要选择其中之一，但他也可以通过单击其按钮来应用先前选择的项目，**就像 Windows 的“开始”菜单一样**。您可以单击**关闭**或选择其他选项。

![在此处输入图像描述](https://i.stack.imgur.com/ZmXJR.png)

我们如何在 Qt 中实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:24:44.203

如果您正在追求第二张图片中的菜单，您可以使用它`QToolButton`来实现您的目标。使用 a`QToolButton`并`popupMode`设置为`MenuButtonPopup`。它将呈现类似于以下内容的控件。

![在此处输入图像描述](https://i.stack.imgur.com/5785p.png)

[然后，您可以使用Qt Style Sheets](http://qt-project.org/doc/qt-5.0/qtwidgets/stylesheet.html)进一步设置外观样式。阅读此示例以[了解如何设置 QToolButton 的样式。](http://qt-project.org/doc/qt-5.0/qtwidgets/stylesheet-examples.html#customizing-qtoolbutton)

动态创建一个`QMenu`，以便您可以`QToolButton`在运行时将其附加到菜单中，这样所有项目都将包含在菜单中，默认项目除外。默认操作必须分配给`QToolButton`自身。

您可以在运行时使用 void`QToolButton::setMenu (QMenu * menu)`将 a 分配`QMenu`给您`QToolButton`的。

如果您尝试设计第一个屏幕截图中的控件，我猜您将不得不创建一个自定义 Qt 控件。没有可用的默认控件，它可以产生开箱即用的外观。

# java - 如何打印从 SQL 到 Java 到 CSV 的列部分？

> ID：16004714
> 
> 赞同：0
> 
> 时间：2013-04-14T21:45:10.573
> 
> 标签：java, mysql, sql, database, io

我已经建立了一个 MySQL 数据库，我的连接工作正常，并且我已经掌握了如何使用 ResultSet 从数据库中检索数据的方法。我目前遇到的问题是，作业要求以 CSV 格式打印几个不同表中的某些列，同时替换一些满足某些条件的值；即，如果特定航班的机票成本低于某个价格，则将成本替换为“LOW！” 在 CSV 文件的那一部分。这是我所拥有的：

```
public void generate() throws IOException, SQLException{

    FileWriter fw = new FileWriter("datamine.csv");
    PrintWriter out = new PrintWriter(fw);
    Statement st = conn.createStatement();

    out.println("Airline,FlightNumber,Source,Destination,DayOfWeek,Seats,Daysbefore,Price");

    //ResultStatements here

    out.flush();
    out.close();
    fw.close();

} 
```

我知道如何查询数据库，我想我可以弄清楚如何从我需要的表中合并列，但这只会打印列中的所有内容。有没有办法遍历列，评估条件值，然后将其附加到输出文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:56:13.297

你需要一个`while`循环和一个`if`测试。

```
while (rs.next()) {

    String airline = rs.getString(1);
    ...
    BigDecimal price = rs.getBigDecimal(8);
    if (price.compareTo(limit) < 0) {
        csvFile.print("LOW!");
    }
    else {
        csvFile.print(price);
    }
} 
```

# php - 如何连接两个数组键？

> ID：16004718
> 
> 赞同：2
> 
> 时间：2013-04-14T21:45:37.990
> 
> 标签：php, html, arrays, function

我想知道是否有办法将两个 Array 键转换为一个 Array 键？

例如，数组看起来像：

```
[0] => '12345' 
[1] => 'New'
[2] => 'York' 
```

我怎样才能结合`[1] => 'New'`和`[2] => 'York'`进入`[1] => 'New York'`？

我发现的只是`array_merge`结合了两个数组。即使关于如何连接两个 Array 键，我也找不到任何东西。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:51:26.677

你可以试试 ：

```
$data = array(12345,"New","York");
echo concat($data, array(1,2)); //New York 
```

//或者

```
$data = array(12345,"New","York");
print_r(concatArray($data, array(1,2))); 
```

输出

```
Array
(
    [0] => 12345
    [1] => New York
) 
```

使用的功能

```
function concat($array, $keys , $glue = " ") {
    $values = array_intersect_key($array, array_flip($keys));
    return implode($glue, $values);
}

function concatArray($array, $keys, $glue = " ") {
    $last = null;
    foreach ( $array as $key => &$value ) {
        if (in_array($key, $keys)) {
            if ($last === null) {
                $last = $key;
                continue;
            }
            $array[$last] .= $glue . $value;
            unset($array[$key]);
        }
    }
    return $array;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T21:49:31.087

这是一个提示；）

```
$new = $array[1] . ' ' . $array[2];
$array[1] = $new;
unset($array[2]); 
```

# android - HTC One 硬件后退按钮在 Cordova 2.0.1 及更高版本中显得古怪

> ID：16004720
> 
> 赞同：0
> 
> 时间：2013-04-14T21:45:46.737
> 
> 标签：android, cordova, jquery-mobile

我发现在 2.0.0 之后的所有版本的 cordova 中都有一个奇怪的行为（如在 cordova-2.0.0.jar 中）

这是在 HTC One X 手机上的 html/css/jQuery/jQueryMobile 移动应用程序中。问题是硬件后退按钮返回到用户查看的最后一个 data-role=页面，而不是仅仅关闭软键盘。（LogCat 日志如下）

我的问题是：我能做什么，使用最新版本的cordova API，让硬件后退按钮只是关闭键盘，而不是回到我最近的data-role = page？

用例是：

*   HTC One X 手机
*   打开应用程序；它在 page_1 上打开
*   点击页脚按钮转到 page_3
*   单击页脚按钮返回 page_1
*   点击输入框（软键盘出现）
*   点击硬件后退按钮

软键盘关闭，应用程序转到 page_3

*   在 cordova 版本 1.9.0 和 2.0.0 上，软键盘关闭并且应用程序停留在 page_1
*   2.0.0 之后的所有版本都这样做。
*   我不能使用旧版本，因为三星 Galaxy 3 有问题

下面的 html 完全按照我的描述执行。

```
<!DOCTYPE html>
<html>
<head>
<title>GFE Tool</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="scripts/jquery.mobile-1.2.0.min.css" />
<link rel="stylesheet" href="scripts/themeswf2.css" />
<link rel="stylesheet" href="scripts/jquery.mobile.simpledialog.min.css" />

<link rel="stylesheet" href="scripts/css_gfe.css" />
<script src="scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="scripts/jquery.mobile-1.2.0.min.js" type="text/javascript"></script>
<script src="scripts/jquery.mobile.simpledialog2.min.js" type="text/javascript">    
</script>
<script src="scripts/using_timios_ws.js" type="text/javascript" ></script>
<script src="scripts/jsrender.js" type="text/javascript"></script>

</head>
<body>

<section id="page_1" data-role="page" data-theme="a">

    <header data-role="header" data-position='fixed'>
        <div class="standard_table our_header" >
            <span><img src="images/LogoWhite.png" width="187" height="61" alt="Timios logo"/></span>
            <span class="setup_gear" style="height: 61px;background-color:#4d4d4d;">
                <a id='the_gear' href="#setup_page">
                    <img src="images/geargray.png" width='61' height="61" alt="Set Up"/></a>
            </span>
        </div>
    </header>

<div data-role="content" class="content">
<div >
    <table class='standard_table'>
        <tr><td><div class='page_title' >Enter Property Data</div>
                <div class='page_title' id='div_welcome_user'></div>
        </td>
        </tr>
    </table>
</div>
<input type="number" />
</div>

<div data-role="footer" data-position='fixed'  align="center">
    <a id='get_results_2' href="#" >
        <div class="one_line_footer_button" >Get Closing Costs</div>
    </a>
    <a href="#page_3" id='CmdGoToNews'  >
        <div class="one_line_footer_button" >New at Our Company</div>
    </a>
    </div>
</div>

</section>

<section id="page_3" data-role="page" data-theme="f">
<header data-role="header" data-position='fixed'>
    <div class="standard_table our_header" >
        <a href="#page_1" >
        <span><img src="images/LogoWhite.png" width="187" height="61" alt="HEADER IMAGE"/></span>
        </a>
            <span class="setup_gear" style="height: 61px;background-color:#4d4d4d;">
        <a id="the_gear_3" href="#setup_page"><img src="images/geargray.png" width="61" height="61" alt="Set Up"/></a>
            </span>
    </div>
</header>

<div data-role="content" class="content">

    <div id='divNews' class="about_us" style="padding-left: 5px; padding-right: 5px; ">
    This is where New at our company goes.
    </div>

</div>

<div  data-role="footer" data-position='fixed' align="center" class='our_footer'>
    <a id="NewAccountSetup" href="#setup_page" >
        <div class="two_line_footer_button">New Account<br>Sign Up</div>
    </a>
    <a id='ClientSetup' href="#setup_page" >
        <div class="two_line_footer_button">Client<br>Sign In</div>
    </a>
    <a href="#page_1" >
        <div class='two_line_footer_button'>
            <img src='images/home_icon_white_36.jpg' />
        </div>
    </a>

</div>

</section>

</body> 
```

注意：我没有使用 PhoneGap Build。我正在eclipse中创建exec。

LogCat 日志（如下）在我按下硬件后退按钮的那一刻开始。它表明 CordovaWebView 正在跟踪我的“浏览器历史记录”- index: 0 处的 URL 是...当我使用旧版本的 cordova jar 时的日志没有显示这些行。

```
04-13 16:15:54.964: D/SoftKeyboardDetect(32763): Ignore this event
04-13 16:15:55.124: D/CordovaWebView(32763): The URL at index: 0is file:///android_asset/www/gfe_one.html
04-13 16:15:55.124: D/CordovaWebView(32763): The URL at index: 1is file:///android_asset/www/gfe_one.html#page_3
04-13 16:15:55.124: D/CordovaWebView(32763): The URL at index: 2is file:///android_asset/www/gfe_one.html#/android_asset/www/gfe_one.html
04-13 16:15:55.124: D/SoftKeyboardDetect(32763): Ignore this event
04-13 16:15:55.164: D/Cordova(32763): onPageFinished(file:///android_asset/www/gfe_one.html#page_3)
04-13 16:15:55.164: D/Cordova(32763): Trying to fire onNativeReady
04-13 16:15:55.164: D/DroidGap(32763): onMessage(onNativeReady,null)
04-13 16:15:55.164: D/DroidGap(32763): onMessage(onPageFinished,file:///android_asset/www/gfe_one.html#page_3)
04-13 16:15:56.475: I/Adreno200-EGLSUB(32763): <ConfigWindowMatch:1991>: Format RGBA_8888. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T14:24:55.517

@Nanashi 写道： *一旦加载了phonegap/cordova，您需要为后退按钮添加一个事件处理程序。请参阅此 stackoverflow.com/questions/14207690/stop-exit-on-back-button-android-in-phonega‌​p-build*

注意：在我现在处理硬件后退按钮的 js 函数中，我只是返回；示例做其他事情或有 // 在这里做事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T01:59:46.403

打开您的 res/xml/config.xml 文件并查找：

```
<preference name="useBrowserHistory" value="false" /> 
```

您可能希望使用 useBrowserHistory 的值来返回返回按钮的旧工作方式。

# algorithm - n 个不同元素上的二叉搜索树的数量

> ID：16004723
> 
> 赞同：16
> 
> 时间：2013-04-14T21:45:57.063
> 
> 标签：algorithm, math, binary-tree, binary-search-tree, proof

从 n 个不同的元素可以构造多少个二叉搜索树？我们怎样才能找到一个经过数学证明的公式呢？

> **示例：** 如果我们有 3 个不同的元素，例如 1、2、3，则有 5 个二叉搜索树。

![元素 1、2、3 上的二叉搜索树](https://i.stack.imgur.com/0SET8.jpg)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-14T21:56:33.757

给定 n 个元素，可以从这些元素组成的二叉搜索树的数量由第 n 个[加泰罗尼亚数](http://en.wikipedia.org/wiki/Catalan_number)（表示为 C [n]）给出。这等于

![在此处输入图像描述](https://i.stack.imgur.com/gLKFb.png)

直观地说，加泰罗尼亚数字表示您可以通过以下方式创建由 n 个元素组成的结构的方式数量：

*   将元素排序为 1、2、3、...、n。
*   选择其中一个元素用作枢轴元素。这会将剩余的元素分成两组——元素之前的元素和元素之后的元素。
*   从这两个组中递归地构建结构。
*   将这两个结构与您删除的一个元素组合在一起以获得最终结构。

这种模式与您从一组 n 个元素构建 BST 的方式完美匹配。选择一个元素作为树的根。所有较小的元素必须向左，所有较大的元素必须向右。从那里，您可以从左侧和右侧的元素构建更小的 BST，然后将它们与根节点融合在一起以形成整体 BST。使用 n 个元素执行此操作的方法数由 C [n]给出，因此可能的 BST 数由第 n 个加泰罗尼亚数给出。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-25T11:00:17.897

我确信这个问题不仅仅是使用数学公式来计算。我花了一些时间编写程序以及计算背后的解释或想法。

我尝试用递归和动态编程来解决它。希望这可以帮助。

该公式已经存在于上一个答案中：

因此，如果您有兴趣学习解决方案并了解方法，您可以随时查看我的文章[Count Binary Search Trees created from N unique elements](http://techieme.in/count-binary-search-trees/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-14T21:57:46.137

令 T(n) 为 n 个元素的 bst 数。

给定 n 个不同的有序元素，编号为 1 到 n，我们选择 i 作为根。

这将 (1..i-1) 留在左子树中用于 T(i-1) 组合，将 (i+1..n) 留在右子树中用于 T(ni) 组合。

所以：

```
T(n) = sum_i=1^n(T(i-1) * T(n-i)) 
```

当然 T(1) = 1

# javascript - 砌体 - Rails 集成问题

> ID：16004726
> 
> 赞同：1
> 
> 时间：2013-04-14T21:46:16.433
> 
> 标签：javascript, jquery

如何捕获砌体无限滚动的“GET”参数以显示 url 地址中的页数。

JS：

```
$(function(){

  var $container = $('#masonry-container');

  $container.imagesLoaded(function(){
    $container.masonry({
      itemSelector: '.box',
      columnWidth: 100
    });
  });

  $container.infinitescroll({
    navSelector  : '#page-nav',    // selector for the paged navigation 
    nextSelector : '#page-nav a',  // selector for the NEXT link (to page 2)
    itemSelector : '.box',     // selector for all items you'll retrieve
    loading: {
        finishedMsg: 'No more pages to load.',
        img: 'http://i.imgur.com/6RMhx.gif'
      }
    },
    // trigger Masonry as a callback
    function( newElements ) {
      // hide new items while they are loading
      var $newElems = $( newElements ).css({ opacity: 0 });
      // ensure that images load before adding to masonry layout
      $newElems.imagesLoaded(function(){
        // show elems now they're ready
        $newElems.animate({ opacity: 1 });
        $container.masonry( 'appended', $newElems, true ); 
      });
    }
  );
}); 
```

如何查找 `vk_posts?page=2`
并保存到 var。

滚动后，我在所有加载的页面中都有 localhost:3000/vk_posts 。Masonry 删除了选择器`$(".pagination a")`，我找不到该选择器的 href。

# gitolite - 在 gitolite 中重新生成 authorized_keys 文件？

> ID：16004729
> 
> 赞同：3
> 
> 时间：2013-04-14T21:46:21.537
> 
> 标签：gitolite

是否可以？我的 authorized_keys 文件已被擦除，更新 gitolite 管理规则仅附加到文件中。是否可以根据 gitolite 配置重新生成整个文件？

编辑：找到了！

**`gitolite trigger POST_COMPILE`**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T05:53:11.757

使用 gitolite g3（版本 3.x），一个简单的：

```
 gitolite setup 
```

（在服务器上执行）就足够了。

见[`src/lib/Gitolite/Setup.pm`](https://github.com/sitaramc/gitolite/blob/master/src/lib/Gitolite/Setup.pm)：

> 设置 gitolite，编译 conf，运行 POST_COMPILE 触发器（参见 rc 文件）并传播钩子。

这个命令比 . 更容易记住`gitolite trigger POST_COMPILE`。

# wpf - 复杂形状生成问题

> ID：16004737
> 
> 赞同：0
> 
> 时间：2013-04-14T21:47:12.460
> 
> 标签：wpf, xaml

如何实现以下图像的 XAML 设计？我有适用于白色填充区域的曲线的主要问题。我想在 WPF 中实现该曲线。我想生成包含“组”文本的形状。

![在此处输入图像描述](https://i.stack.imgur.com/Fgf0i.png)

# javascript - 用jquery覆盖href

> ID：16004738
> 
> 赞同：1
> 
> 时间：2013-04-14T21:47:27.273
> 
> 标签：javascript, jquery, overriding, href

我有很多与这种结构的链接：

```
<a class="myclass" href="http://externaldomain.com">Anchor Text</a> 
```

我想在 href 属性中的 url 之前放一些东西来改变结构：

```
<a class="myclass" href="http://internaldomain.com/http://externaldomain.com">Anchor Text</a> 
```

我认为 jquery 非常适合这样做，但我不知道如何。你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:23:51.830

```
$('a.myclass').attr('href', function(i, href) {
     return 'http://internaldomain.com/' + href;
}); 
```

来源： [jQuery 在 img src 属性中添加 URL](https://stackoverflow.com/questions/4815398/jquery-to-prepend-url-in-img-src-attribute)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:51:51.937

```
$('.myclass').each(function(){this.href = "http://internaldomain.com/"+this.href}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T21:52:07.027

`href`是`a`元素的一个属性，因此您可以使用[`attr`](http://api.jquery.com/attr/)带有 class 的元素上的方法来更改它`myclass`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T21:53:01.740

您可以将修改回调传递给该`attr`方法：

```
$('[href^=http:]').attr('href',function(i,str) {
  return "http://internaldomain.com/"+str;
} 
```

[http://api.jquery.com/attr](http://api.jquery.com/attr)

[http://api.jquery.com/attribute-starts-with-selector/](http://api.jquery.com/attribute-starts-with-selector/)

# c# - 为不同的客户端加载不同的程序集或模块

> ID：16004741
> 
> 赞同：1
> 
> 时间：2013-04-14T21:47:54.303
> 
> 标签：c#, asp.net-mvc

我已经在 .net 4.5 中开发了一个 Web 应用程序，现在客户要求我为某些应用程序模块定制（例如发票的不同实现）。我的问题是我可以“拦截”我的客户以加载定制组件并为普通客户加载不同的组件吗？

我可以简单地通过反思来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:15:32.017

关键思想是设计软件，使其部件易于更换。您应该将您的解决方案分成多个项目，以便您可以快速交换接口的不同实现。

此外，还有一种叫做依赖注入的东西，这基本上意味着您可以根据需要在运行时或使用配置文件注入不同的实现。为了便于使用，已经为您准备了一些不错的框架，例如 Ninject 或 Unity。

应用程序需要有一个坚实的架构来支持这种可能性。也许如果您提供了有关您的系统的更多信息，我可能会更具体，但我相信对依赖注入进行一些研究会给您一个良好的开端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:32:31.273

是的你可以。您可以像这样从文件中加载程序集， `var asmbly = System.Reflection.Assembly.LoadFrom(path);` 然后使用反射来加载类型。

有几种方法可以实现这种可插拔性。一种方法是提取“模块”的接口并针对该接口对“模块客户端”进行编码，将具体实现与“客户端”代码解耦。然后，在运行时查看组件内部，加载实现所述接口的类型并注入“模块客户端”。

我在这里粘贴一些我编写的代码作为概念证明，用于精确地那种类型的“模块”运行时加载（这是 MVC 3）：

```
// "Module User" was decoupled from "module", by coding it against module's interface:
public class CustomerController : Controller
{
    private ICustomerRepository _customerRepository;

    // dependency injection constructor
    public CustomerController(
            ...
            ICustomerRepository customerRepository,
            ...)
    {
            _customerRepository = customerRepository;
    }

    public ActionResult Details(Nullable<Guid> id)
    {
            Customer c = _customerRepository.GetByKey(id.Value.ToString());
            ...
    }

    ...
} 
```

在运行时：

```
// I first load the assembly
System.Reflection.Assembly dal = System.Reflection.Assembly.LoadFrom(System.IO.Path.Combine(pBinPath, pDALAssemblyName));

// I then look for types implementing ICustomerRepository 
var addressRepositoryContract = typeof(QSysCamperCore.Domain.IAddressRepository);
var addressRepositoryImplementation = dal.GetTypes()
    .First(p => addressRepositoryContract.IsAssignableFrom(p));
... 
```

请注意，这种类型的编程需要更多的权限——我已经对这段代码“生疏”了几年，但我记得信任级别的问题，当然，必须考虑文件系统访问。

* * *

有一些框架可以帮助这种应用风格。这又是几年前的事了，但微软的模式和实践网站上曾经有所谓的“复合应用程序块”，它是两个框架的基础——Smart Cliet Softweare Factory 及其网络等价物——Web Client Software Factory。它们站起来有点重，但为这种模块化（复合）应用程序提供了强大的骨架。

# javascript - 如何解释这种日期格式？

> ID：16004742
> 
> 赞同：0
> 
> 时间：2013-04-14T21:47:59.783
> 
> 标签：javascript, date, format

我刚刚在一个我从未见过的 javascript 文档中找到了日期格式。它看起来像这样：

```
'1978-11-23T00:00:01.000Z' 
```

有人能解释一下'T'和'Z'是什么意思吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T21:49:08.360

> 有人能解释一下'T'和'Z'是什么意思吗？

是日期和时间之间的`T`分隔符。这`Z`是一个时区，特别是时区“Zulu”（GMT+00:00，例如格林威治标准时间）。在最新的规范 (ES5) 中，JavaScript 有一个[标准的日期/时间格式](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15)，它源自[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)的简化版本（尽管它处理时区的缺失与 ISO 标准不同）。（在 ES5 之前，JavaScript 中根本没有标准的日期字符串形式，令人惊讶。）

> 如何解释这种日期格式？

如果您使用的是实现 ES5 的这一部分的引擎，您可以将该字符串传递给[`Date(value)`构造函数](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.3.2)：

```
var dt = new Date('1978-11-23T00:00:01.000Z'); 
```

如果您使用的引擎尚未实现标准的这一部分（例如 IE8 或更早版本），则必须使用正则表达式来分解字符串的各个部分，将它们转换为数字，并将它们提供给[`Date(year, month, date, hours, minutes, seconds, ms)`构造函数](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.3.1)，或使用附加库为您解析它。

# git - 在 Netbeans (Git) 中推进几个提交？

> ID：16004745
> 
> 赞同：1
> 
> 时间：2013-04-14T21:48:23.117
> 
> 标签：git, netbeans, version-control, netbeans-7

我对版本控制还比较陌生。我正在将 Git 与 Netbeans 一起使用。我将更改还原得太远了，现在我需要回去吗？有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:53:16.740

查看`git reflog`并找到您可以接受的提交，然后找到您从 reflog 中选择的提交`git reset <sha1>`在哪里。`<sha1>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:50:04.667

还原本身就是一个提交。您可以还原还原。

# java - 将字符串日期转换为日期对象

> ID：16004747
> 
> 赞同：0
> 
> 时间：2013-04-14T21:48:25.613
> 
> 标签：java

如何将 11/03/2009-20:06:16 转换为 Date 对象，以便我可以比较两个日期。我不断收到 java.lang.IllegalArgumentException: Cannot format given Object as a Date 错误，如果我使用下面的实现。我需要输出格式为 Tue Jul 14 01:32:31 2009 的日期对象

```
 import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Dateaf {

    /**
     * @param args
     * @throws ParseException
     */
    public static void main(String[] args) throws ParseException {
        // TODO Auto-generated method stub

        String text = "11/03/2009-20:06:16";

        SimpleDateFormat dateParser = new SimpleDateFormat("MM/dd/yyyy-hh:mm:ss");

        Date date = dateParser.parse(text);
        System.out.println(date);

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T21:50:12.590

`sdf.format()`接受一个`Date`对象并返回一个`String`. 你正在传递一个`String`给它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T21:54:22.290

您非常接近，只需拨打以下电话`format`：

```
Date date = sdf.parse(text); 
```

所以：

```
String text = "11-03-2009 20:06:16";

SimpleDateFormat dateParser = new SimpleDateFormat("MM-dd-yyyy HH:mm:ss");
                                                             //^^ capital H for 24 hour  

Date date = dateParser.parse(text); 
```

并打印（来自您的评论，格式为“Tue Jul 14 01:32:31 2009”）：

```
SimpleDateFormat dateFormatter = new SimpleDateFormat("EE MM dd HH:mm:ss yyyy");

System.out.println(dateFormatter.format(date)); 
```

[`SimpleDateFormat`javadoc](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)是一个很好的格式参考。

**编辑**

在 OP 的编辑后，这里是一个完整的例子

```
public static void main(String[] args) throws ParseException {
    final String text = "11/03/2009-20:06:16";
    final SimpleDateFormat dateParser = new SimpleDateFormat("MM/dd/yyyy-HH:mm:ss");
    final Date date = dateParser.parse(text);
    final SimpleDateFormat dateFormatter = new SimpleDateFormat("EE MMM dd HH:mm:ss yyyy");
    System.out.println(dateFormatter.format(date));
} 
```

输出：

```
Tue Nov 03 20:06:16 2009 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-14T21:52:45.160

Java 有一个文本包，它为我们提供了预定义的类文本

```
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Main {
public static void main(String[] args) throws Exception{
DateFormat df = new SimpleDateFormat("dd/MM/yyyy");

Date today = df.parse("20/12/2005");
System.out.println("Today = " + df.format(today));
}
} 
```

还有另一种方法可以做到这一点

```
String date = "2000-11-01";
java.sql.Date javaSqlDate = java.sql.Date.valueOf(date); 
```

# mysql - 目标表不可更新错误

> ID：16004750
> 
> 赞同：1
> 
> 时间：2013-04-14T21:48:57.663
> 
> 标签：mysql, insert-update

我需要运行这个查询：

```
UPDATE (
   SELECT r.* 
   FROM booked r 
   INNER JOIN (
      SELECT a.st_code as from_t
           , b.st_code as to_t 
      FROM `stops_at` a 
      CROSS JOIN `stops_at` b 
      WHERE (a.stop_no < b.stop_no) 
        and (a.train_no = b.train_no) 
        and (a.train_no = '11280')
      ) new 
   ON (r.st_from = new.from_t) 
     and (r.st_to = new.to_t)
     and r.date = '2013-04-16'
   ) temp 
SET temp.seat_ac = temp.seat_ac-5 
```

但在执行时它给出了一个错误：

**#1288-UPDATE 的目标表 temp 不可更新**。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:36:56.300

我认为您的`UPDATE`语法不正确。看看这是否有效：

```
UPDATE booked r
INNER JOIN (
   SELECT a.st_code as from_t
        , b.st_code as to_t 
   FROM `stops_at` a 
   CROSS JOIN `stops_at` b 
   WHERE (a.stop_no < b.stop_no) 
     and (a.train_no = b.train_no) 
     and (a.train_no = '11280')
   ) new 
ON r.st_from = new.from_t 
  and r.st_to = new.to_t
  and r.date = '2013-04-16' 

SET r.seat_ac = r.seat_ac-5 
```

# mysqli - mysqli 致命错误：在非对象上调用成员函数 bind_param()

> ID：16004752
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:49:04.330
> 
> 标签：mysqli, bind, param

我对准备好的语句有疑问，这是我的代码：

```
function query_array($table, $data) {
    foreach ($data as $column => $value) {
        $columns[] = sprintf("`%s` = '%s'", $column, $this->db->real_escape_string($value));
    }
    $column_list = join(',', $columns);

    // Prepare the statement
    $stmt = $this->db->prepare("UPDATE `?` SET ?");
    $stmt->bind_param('ss', $table, $column_list);

    // Execute the statement
    $stmt->execute();

    // Save the affected rows
    $affected = $stmt->affected_rows;

    // Close the statement
    $stmt->close();

    // ...
} 
```

$this->db 返回一个对象；

$table = '设置'; （细绳）

$column_list：（字符串）

```
`title` = 'Socialsd',`captcha` = '0',`public` = '',`private` = '',`time` = '1',`perpage` = '10',`message` = '140',`mail` = '1',`inter` = '10000',`size` = '1048576',`format` = 'png,jpg,gif',`sizeMsg` = '1048576',`formatMsg` = 'png,jpg,gif,bmp',`censor` = '',`ad1` = '',`ad2` = '' 
```

我得到的错误是：

> 致命错误：未捕获的异常 'ErrorException' 并带有消息“您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以了解在“？”附近使用的正确语法 在 C:\xampp\htdocs\new\includes\classes.php:256 中的第 1 行 堆栈跟踪：#0 C:\xampp\htdocs\new\sources\admin.php(225): updateSettings->query_array(' settings', Array) #1 C:\xampp\htdocs\new\index.php(42): PageMain() #2 {main} 在第 256 行的 C:\xampp\htdocs\new\includes\classes.php 中抛出

我不知道是什么原因造成的，因为尝试以下方法就可以了：

```
$query = sprintf("UPDATE `%s` SET %s", $table, $column_list);
$result = $this->db->query($query); 
```

任何帮助表示赞赏。

**更新 1**：我可以知道为什么这被否决了吗？很高兴知道。

**更新2**：所以我删除了最后一个绑定（$column_list）并将$column_list的整个输出放入语句中，所以基本上我只绑定表名，现在我得到另一个错误：

> 找不到文件：'.\diary\@003f.frm'（错误号：22）

现在我真的很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:37:13.590

我在这里找到了答案：[使用一个具有可变数量输入变量的 bind_param()](https://stackoverflow.com/questions/793471/use-one-bind-param-with-variable-number-of-input-vars)以及@Jocelyn 链接我，我发现无法绑定表名。可以关闭。

# php - 在php中获取一个mysql变量

> ID：16004756
> 
> 赞同：0
> 
> 时间：2013-04-14T21:49:32.133
> 
> 标签：php, mysql, mysqli, sql-update

我正在尝试使用以下给出的答案：[如何获取 MySQL 中最后更新行的 ID？](https://stackoverflow.com/questions/1388025/how-to-get-id-of-the-last-updated-row-in-mysql)

我想要更新的行的 ID。但是下面的错误是不起作用的 `Fatal error: Call to a member function fetch_assoc() on a non-object`。

```
$query = "
  SET @update_id := 0;
  UPDATE locations SET owner_player_id='$player_id', id=(SELECT @update_id := id)
   WHERE game_id='$game_id' LIMIT 1;
  SELECT @update_id;
  ";

$result = $mysqli->query($query);
$row = $result->fetch_assoc();
$location_id = $row['update_id']; 
```

谢谢

编辑：

$mysqli->错误给出`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UPDATE locations SET owner_player_id='5', id=(SELECT @update_id := id) WHERE gam' at line 1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:54:44.493

您的 SQL 失败了，这就是为什么您的后续`fetch_assoc()`方法也失败了。

您将需要考虑在不使用变量 ( `@update_id`) 的情况下运行查询，并查看使用[mysqli::$insert_id](http://php.net/manual/en/mysqli.insert-id.php)。

在不知道您到底要做什么的情况下，很难更具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:40:15.120

非得`mysqli::multi_query`用`mysqli::query`。然后还必须使用`mysqli::next_result`并`mysqli::store_result`获得正确的数据。

```
$query = "SET @update_id := 0; UPDATE locations SET owner_player_id='$player_id', id = ( SELECT @update_id := id ) WHERE game_id='$game_id' LIMIT 1; SELECT @update_id;";
$mysqli->multi_query($query) or die($mysqli->error);
$mysqli->next_result();
$mysqli->next_result();
$result = $mysqli->store_result();
$row = $result->fetch_assoc();
$location_id = $row['@update_id']; 
```

# php - ASP 中 PHP 的 $HTTP_RAW_POST_DATA

> ID：16004758
> 
> 赞同：0
> 
> 时间：2013-04-14T21:49:38.973
> 
> 标签：php, html, actionscript-3, vbscript

我正在用一个 Flash 应用程序更新一个经典的 asp 页面，我需要在 vbscript 下重现 PHP 的 $HTTP_RAW_POST_DATA 函数（或 C# .NET，因为它也在 IIS7 上）。这是我迄今为止所拥有的，但不起作用。浏览器只是告诉我，由于错误或损坏，它无法显示图像。提前谢谢。

AS3 代码

```
vid_out = new Video();
vid_out.x = 0;
vid_out.y = 0;
vid_out.width = cam.width;
vid_out.height = cam.height;
vid_out.attachCamera(cam);
addChild(vid_out);

var bitmapData:BitmapData = new BitmapData(640, 480);
bitmapData.draw(vid_out);
var encoder:JPGEncoder = new JPGEncoder();
var byteArray:ByteArray = encoder.encode(bitmapData);
var header:URLRequestHeader = new URLRequestHeader("Content-type", "application/octet-stream");
var jpgURLRequest:URLRequest = new URLRequest("/capture.asp?i=blah.jpg");
jpgURLRequest.requestHeaders.push(header);
jpgURLRequest.method = URLRequestMethod.POST;
jpgURLRequest.data = byteArray;
navigateToURL(jpgURLRequest, "_blank"); 
```

非工作 vbscript 代码

```
Function RSBinaryToString(xBinary)
  Dim Binary
  If vartype(xBinary)=8 Then Binary = MultiByteToBinary(xBinary) Else Binary = xBinary

  Dim RS, LBinary
  Const adLongVarChar = 201
  Set RS = CreateObject("ADODB.Recordset")
  LBinary = LenB(Binary)

  If LBinary>0 Then
    RS.Fields.Append "mBinary", adLongVarChar, LBinary
    RS.Open
    RS.AddNew
    RS("mBinary").AppendChunk Binary
    RS.Update
    RSBinaryToString = RS("mBinary")
  Else
    RSBinaryToString = ""
  End If
End Function

photoname = trim(request.querystring("i"))

Dim ByteCount, BinRead
ByteCount = Request.TotalBytes

If ByteCount > 0 Then
BinRead = Request.BinaryRead(ByteCount)
Response.ContentType = "image/jpeg"
Response.AddHeader "Content-Disposition", "inline; filename=" & photoname
Response.BinaryWrite(RSBinaryToString(BinRead))
Response.End()
End If 
```

'工作的vbscript代码

我只是使用位于服务器上的实际文件夹路径。您也可以使用 servermappath。

```
photoname = trim(request.querystring("i"))
folder = "C:\some_folder\"

tofolder = folder & photoname

Dim BinaryData, ByteCount 
ByteCount = Request.TotalBytes 
BinaryData = Request.BinaryRead(ByteCount)

Set objADO = Server.CreateObject("ADODB.Stream")
objADO.Type = 1
objADO.Open
objADO.Write BinaryData
objADO.SaveToFile tofolder, 2
Set objADO = Nothing 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:22:09.113

请参阅[请求对象参考](http://msdn.microsoft.com/en-us/library/ms524948%28v=vs.90%29.aspx)

具体来说，您将对[`Request.TotalBytes`](http://msdn.microsoft.com/en-us/library/ms524728%28v=vs.90%29.aspx)获取请求正文大小的属性和[`Request.BinaryRead`](http://msdn.microsoft.com/en-us/library/ms525710%28v=vs.90%29.aspx)读取请求正文的方法感兴趣。

*引用 MSDN：* **VBScript**

```
<% 
Dim vntPostedData, lngCount 
lngCount = Request.TotalBytes 
vntPostedData = Request.BinaryRead(lngCount) 
%> 
```

# android - 在 AsyncTask 中传递数组

> ID：16004764
> 
> 赞同：0
> 
> 时间：2013-04-14T21:50:08.943
> 
> 标签：android, android-asynctask

是否可以在`AsyncTask`'s中传递数组`publishProgress`？在我的代码中，我有：

```
publishProgress(returnOK, dataType, data) 
```

数组在哪里`data`（用户决定他想接收多少数据）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:52:02.000

是的。类型是通用的，所以它可以是一个数组。只要确保双方都这样对待它。

# ios - 尝试包含库时的未知类型名称

> ID：16004768
> 
> 赞同：0
> 
> 时间：2013-04-14T21:50:14.133
> 
> 标签：ios, objective-c

我正在尝试在我正在构建的 iPhone 应用程序中使用[Novocaine 。](https://github.com/alexbw/novocaine/)我不知道如何解决我遇到的这个错误：

```
Unknown type name 'RingBuffer' 
```

这是我的文件结构：

![文件结构](https://i.stack.imgur.com/ZprRj.png)

... Novocaine 下的那些文件是从 Github 存储库中为 Novocaine 提取的文件。这是我的 DDViewController 头文件。

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>
#import "UICoordButton.h"
#import "Novocaine.h"
#import "RingBuffer.h"
#import "AudioFileReader.h"
#import "AudioFileWriter.h"

@interface DDViewController : UIViewController
{
    RingBuffer *ringBuffer;
    Novocaine *audioManager;
    AudioFileReader *fileReader;
    AudioFileWriter *fileWriter;
}
- (IBAction)changeColor:(id)sender;
- (IBAction)changeColor2:(id)sender;
@end 
```

我尝试了在[另一个问题](https://stackoverflow.com/questions/11163581/class-not-being-read-unknown-type-name)上找到的解决方案，这表明这应该可行：

```
@class RingBuffer;
@interface DDViewController : UIViewController
{
... 
```

但这只是给了我`Redefinition of 'RingBuffer' as a different kind of symbol.`

我该如何解决这个问题并使用`RingBuffer`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:19:07.737

`RingBuffer`是一个 C++ 类。我建议您更改您的 Objective-C 文件的扩展名，`.m`这`.mm`将使它们成为 Objective-C++

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:27:05.693

找到了答案（或者我猜是答案的组合）：

按照 coryalder 的建议将编译器默认设置为 Objective-C++，如此[处](https://github.com/alexbw/novocaine/issues/17)所述。

此外，将所有`.m`文件更改为`.mm`文件，最后将`-fno-objc-arc`编译器标志添加到所有 .mm 文件中——这里有详细描述[。](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)

# ios - NSDictionary：查找特定对象并将其删除

> ID：16004770
> 
> 赞同：0
> 
> 时间：2013-04-14T21:50:36.307
> 
> 标签：ios, objective-c, nsmutabledictionary

我`NSMutableDictionary`看起来像这样：

```
category =     (
            {
        description =             (
                            {
                id = 1;
                name = Apple;
            },
                            {
                id = 5;
                name = Pear;
            },
                            {
                id = 12;
                name = Orange;
            }
        );
        id = 2;
        name = Fruits;
    },
            {
        description =             (
                            {
                id = 4;
                name = Milk;
            },
                            {
                id = 7;
                name = Tea;
            }
        );
        id = 5;
        name = Drinks;
    }
); 
```

现在，当用户在我的应用程序中执行操作时，我会得到对象的 @"name"-value，例如“Apple”。我想从字典中删除该对象，但是如何使用

```
[myDictionary removeObjectForKey:] 
```

方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:08:00.323

在高层次上，您需要获取对“描述”数组的引用。然后遍历数组获取每个字典。检查字典以查看它是否具有匹配的“名称”值。如果是这样，请从“描述”数组中删除该字典。

```
NSString *name = ... // the name to find and remove
NSMutableArray *description = ... // the description array to search
for (NSUInteger i = 0; i < description.count; i++) {
    NSDictionary *data = description[i];
    if ([data[@"name"] isEqualToString:name]) {
        [description removeObjectAtIndex:i];
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:22:53.957

要从 INNER 数组中删除某些内容：

```
NSString* someFood = <search argument>;
NSArray* categories = [myDictionary objectForKey:@"category"];
for (NSDictionary* category in categories) {
    NSArray* descriptions = [category objectForKey:@"description"];
    for (int i = descriptions.count-1; i >= 0; i--) {
        NSDictionary* description = [descriptions objectForIndex:i];
        if ([[description objectForKey:@"name"] isEqualToString:someFood]) {
            [descriptions removeObjectAtIndex:i];
        }
    }
} 
```

从外部数组中删除整个组（例如，“Fruits”）更简单。

# javascript - 使用 selectNodeContents 时如何选择 html 标签及其内容？

> ID：16004772
> 
> 赞同：7
> 
> 时间：2013-04-14T21:50:44.090
> 
> 标签：javascript, textarea

我有这段代码，我用它来获取光标在可编辑 div 中的位置：

```
 function getMeCurPos(element){
       if (typeof window.getSelection != "undefined") {
          var range = window.getSelection().getRangeAt(0);
          var preCaretRange = range.cloneRange(); 
          preCaretRange.selectNodeContents(element);
          preCaretRange.setEnd(range.endContainer, range.endOffset); 
          caretOffset = preCaretRange.toString().length;  
          return caretOffset;
       }                        
   } 
```

问题是，返回的 caretOffset 只计算文本内容而不是 html 标签。例如：

在我的可编辑 div 中考虑这个字符串： `Hey <b>jony</b>, whats goin on in the | party`

*光标用`|`字符表示。

做 getMeCurPos(ele) 返回：`30`但它应该返回`37`。它不计算`b`标签

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T09:02:23.563

您可以创建一个临时`div`文件，您可以在其中放置您的文件`preCaretRange`以及可以使用的位置`textContent`或`innerText`上面。这不会占用 HTML 长度，而是它周围的文本。

```
 function getMeCurPos(element){
       if (typeof window.getSelection != "undefined") {
          var range = window.getSelection().getRangeAt(0);
          var preCaretRange = range.cloneRange(); 
          preCaretRange.selectNodeContents(element);
          preCaretRange.setEnd(range.endContainer, range.endOffset); 
          var temp = document.createElement("div");
          temp.innerHTML = preCaretRange.toString();
          var sanitized = temp.textContent || temp.innerText;
          caretOffset = sanitized.length;
          return caretOffset;
       }                        
} 
```

看到[这个小提琴](http://jsfiddle.net/AbUJe/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-24T12:37:31.463

要获取文本和 DOM 节点的选择，您可以`cloneContents()`在 Javascript 选择范围中使用。HTML如下

```
function getMeCurPos(element) {
  if (typeof window.getSelection != "undefined") {
    var range = window.getSelection();
    cloned.innerHTML = '';
    for (let i = 0; i < range.rangeCount; i++) {
      cloned.append(range.getRangeAt(i).cloneContents());
    }

    var sanitized = cloned.innerHTML;
    caretOffset = sanitized.length;
    return caretOffset;
  }
}
```

```
<p contenteditable="true" id="test" onclick="alert(getMeCurPos(this))">Test1<br>Test2<br>Test3<br>Test4</p>
<br>
Cloned: <span id="cloned"></span>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-24T11:54:55.260

我从这篇文章中获取了代码： [Select all DIV text with single mouse click](https://stackoverflow.com/questions/1173194/select-all-div-text-with-single-mouse-click)

```
 <script type="text/javascript">
                function selectText(containerid) {
                    if (document.selection) {
                        var range = document.body.createTextRange();
                        range.moveToElementText(document.getElementById(containerid));
                        range.select();
                    } else if (window.getSelection) {
                        var range = document.createRange();
                        range.selectNode(document.getElementById(containerid));
                        window.getSelection().addRange(range);
                    }
                }
            </script>

            <div id="selectable" onclick="selectText('selectable')">http://example.com/page.htm</div> 
```

# curl - 无法使用 Curl 将查询复制到 Amazon Manage Kindle。我错过了什么？

> ID：16004781
> 
> 赞同：2
> 
> 时间：2013-04-14T21:51:28.343
> 
> 标签：curl, reverse-engineering, kindle

由于亚马逊的“管理您的 Kindle”的 Web 界面极其缓慢，我正试图弄清楚如何构建一个连接到提供管理页面的未记录服务的应用程序。我现在已经确定了要使用哪些 URL 和参数来检索执行 CRUD 操作所需的 JSON 数据，但是我无法成功地使用 CURL 向任何服务发布数据。

身份验证似乎存在问题，但我正在发送我能找到的所有相关标头和 cookie。还是得到一个

```
HTTP/1.1 302 MovedTemporarily
Location: https://www.amazon.com/ap/signin?_encoding=UTF8&accountStatusPolicy=P1&openid.assoc_handle=usflex&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.mode=checkid_setup&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&openid.ns.pape=http%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0&openid.pape.max_auth_age=900&openid.return_to=https%3A%2F%2Fwww.amazon.com%2Fgp%2Fdigital%2Ffiona%2Fmanage%2Ffeatures%2Forder-history%2Fajax%2FqueryPdocs.html%3Fie%3DUTF8%26contentType%3DPersonal%2520Documents%26count%3D15%26offset%3D0 
```

发送此请求后，应该列出所有个人文件。cookie 已使用 Chrome 的 Web 开发人员工具复制。

```
> POST /gp/digital/fiona/manage/features/order-history/ajax/queryPdocs.html HTTP/1.1
> User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
> Host: www.amazon.com
> Accept: */*
> Cookie: session-token=8tAmbclc1/ZjtWU8o5VXyU5H8s0/Yiy346W1/Nx4Sz2BzTUWUR9lkwDABzzgRW1lwZUqcu8MqhGzbby2Xg9RA8Y0cwpLRDk5sf6eXUwNQBvZAcgEXsHG8Bj+24q2C1MZ9v5hFrzBNr6pDP+9CYXrMl2WaEVzmvd/sBO69jk5o3mK3PJf1leY6YhLAL3W8dVj89O+ebIoaPvLHP7naDpImbqaa5bwGS4ki+AzJDLAHs5UMwQkiuXoUCnukz1+WqCr0rHhKoPkI17WGm6MrRDs9/PC2ll7+qDU13; session-id=184-5755217-1234567; session-id-time=2082787201l
> Content-Length: 48
> Content-Type: application/x-www-form-urlencoded 
```

（是的，我在在线发布之前更改了我的会话令牌和会话 ID：p）

我在 CLI 上使用以下调用并将 cookie 存储在 cookie3.txt

```
curl -v --cookie cookie3.txt  --data 'offset=0&count=15&contentType=Personal+Documents' 'https://www.amazon.com/gp/digital/fiona/manage/features/order-history/ajax/queryPdocs.html' 
```

知道我在这里缺少什么以使其正常工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-16T12:01:40.480

亚马逊似乎尽最大努力实现*Security Through Obscurity*；如果您的用户代理不是公认的浏览器，例如 Firefox、Chrome 或 IE，您将被拒绝访问。为了通过需要伪造用户代理来获取请求。

我最终放弃了 Python 和 Requests 库的 cURL。进入 FIONA 所需的所有步骤都可以[在 GitHub 上的代码](https://github.com/fatso83/amazon_fiona/blob/3df10d41d9b242f77143589878c9558f1b7d6389/kindle_manager.py)中看到。

# ruby - BasicObject 中的 binding.pry

> ID：16004783
> 
> 赞同：8
> 
> 时间：2013-04-14T21:51:32.297
> 
> 标签：ruby, debugging, proxy-classes, pry

pry 非常适合调试 BasicObject 的子类！

[https://github.com/pry/pry](https://github.com/pry/pry)说 pry 有：“Exotic object support (BasicObject instances...”

但是怎么做呢？正如所料，BasicObject 不理解绑定。

```
 NameError:
   undefined local variable or method `binding' for #<C30Course:0xbefbc0c> 
```

调用 method_missing 时，将绑定发送到哪里？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-14T23:38:24.100

您需要像这样直接调用该`binding`方法`Kernel`：

```
[13] pry(main)> class O < BasicObject
              |   def hi
              |     x = 10
              |     ::Kernel.binding.pry
              |   end  
              | end  
=> nil
[14] pry(main)> O.new.hi

From: (pry) @ line 19 O#hi:

    17: def hi
    18:   x = 10
 => 19:   ::Kernel.binding.pry
    20: end

[1] pry(unknown)> x
=> 10
[2] pry(unknown)> self
=> #<O:0x3fd5310d04f8> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-14T23:14:01.910

因为从 BasicObject 继承会给你一个`Blank Slate`（所有的 pry 实例方法也被删除），你必须做更多的手动操作。例如：

```
require 'pry'
class Test < BasicObject
  def test_method
    a = 1+1
    ::Pry.send(:binding).pry
    b = 2+2
  end
end
o = Test.new
p o.test_method 
```

输出（撬开会话）：

```
☺  ruby hack.rb                                                            ruby-2.0.0-p0

From: .../quick_hacking/hack.rb @ line 5 Test#test_method:

    3: def test_method
    4:   a = 1+1
 => 5:   ::Pry.send(:binding).pry
    6:   b = 2+2
    7: end 
```

# c - 何时使用回调函数？

> ID：16004784
> 
> 赞同：10
> 
> 时间：2013-04-14T21:51:44.687
> 
> 标签：c, callback

什么时候使用回调函数？我知道它们是如何工作的，我已经看到它们在使用中，而且我自己也使用过很多次。

C 世界的一个例子是`libcurl`它依赖于回调来检索数据。

一个相反的例子是 OpenSSL：在我使用过它的地方，我使用 out 参数：

```
ret = somefunc(&target_value);
if(ret != 0)
    //error case 
```

我想知道什么时候使用哪个？回调仅对异步内容有用吗？我目前正在设计我的应用程序的 API，我想知道是使用回调还是只使用 out 参数。在底层，它将使用 libcurl 和 OpenSSL 作为它构建的主要库，并且参数“returned”是 OpenSSL 数据类型。

我看不出回调比仅仅返回有什么好处。如果我想以任何方式处理数据而不是仅仅将其返回，这是否才有用？但是我可以处理返回的数据。区别在哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-14T21:58:01.750

在最简单的情况下，这两种方法是等价的。但是如果回调可以在数据到达时被多次调用来处理数据，那么回调方法提供了更大的灵活性，并且这种灵活性不仅限于异步用例。

libcurl 就是一个很好的例子：它提供了一个 API，允许为所有新到达的数据指定回调。正如您所介绍的那样，另一种选择是只*返回 data*。但归还——如何？如果将数据收集到内存缓冲区中，则缓冲区最终可能会非常大，调用者可能只想将其保存到文件中，例如下载程序。如果数据被保存到一个文件名返回给调用者，如果调用者实际上只是想将它存储在内存中，它可能会产生不必要的 IO，就像显示图像的 web 浏览器一样。如果调用者想要在数据流时处理数据，比如计算校验和，并且根本不需要存储它，那么这两种方法都是次优的。

回调方法允许调用者决定如何处理单个数据块或将其组装成一个更大的整体。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T21:56:45.040

回调对于异步通知很有用。当您使用某些 API 注册回调时，您希望该回调在某些事件发生时运行。同样，您可以将它们用作数据处理管道中的中间步骤（如果您熟悉音频/录音行业，则类似于“插入”）。

因此，总而言之，这是我遇到和/或实现的回调方案的两个主要范例：

1.  当数据到达或某些事件发生时，我会告诉你——你可以随意使用它。
2.  在我处理它之前，我会给你修改一些数据的机会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T21:55:14.043

如果可以立即返回值，那么可以，不需要回调。*正如您所推测的，回调在由于某种原因无法*立即返回值的情况下很有用（也许它只是一个长时间运行的操作，最好异步执行）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-22T00:10:53.493

我对此的看法：我认为哪个模块必须知道哪个模块？我们称它们为数据用户和 IO。假设你有一些 IO，数据从那里进来。IO-Module 甚至可能不知道谁对数据感兴趣。然而，数据用户确切地知道它需要哪些数据。所以 IO 应该提供一个类似 subscribe_to_incoming_data(func) 的函数，Data-User 模块将订阅 IO-Module 拥有的特定数据。另一种方法是更改​​ IO-Module 中的代码以调用 Data-User。但是对于现有的库，您绝对不想触及其他人提供给您的现有代码。

# php - Paypal IPN：付款后更新列的值？

> ID：16004786
> 
> 赞同：0
> 
> 时间：2013-04-14T21:51:47.410
> 
> 标签：php, mysql, paypal, paypal-ipn

我有 2 个文件：

1.  索引.php
2.  谢谢你.php

在 index.php 中，用户提交他的电子邮件（我将其保存到名为“电子邮件”的数据库表列中），然后转到 PayPal 并进行付款。然后用thankyou.php我想更新我的数据库，电子邮件列在哪里，该列称为高级，付款后默认为0，现在应该是1...

简单的方法可能是说电子邮件（在 index.php 中提交）将其与在 Paypal 付款中提交的“payer_email”进行比较。我怎样才能做到这一点？会议？饼干？他们似乎不为我工作，我该怎么做？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:06:06.160

您不需要任何会话或 cookie，只需使用`UPDATE ... SET premium = 1 WHERE email = :1`带有 :1的常规`$_POST['payer_email']`。

我了解您不确定您记录中的电子邮件是否是买家用来登录贝宝的电子邮件，因此您必须使用贝宝留给您的自定义字段。执行以下操作：

1.  在数据库中记录客户 ID
2.  创建添加以下字段的贝宝按钮：

`<input type="hidden" name="custom" value="yourclientid">`

1.  收到 ipn 时，`$_POST['custom']`使用此唯一对应关系检索自定义字段并更新您的数据库，因此您不必怀疑使用了哪个电子邮件。

请注意，这对贝宝常见的“购买”按钮有效。对于订阅，情况可能会略有不同，因为在第一个 ipn 之后，该`custom`字段不再传递。

希望它有所帮助。S。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:12:25.570

PayPal 的 API 文档中介绍了事件顺序。我建议您阅读它以了解该过程的工作原理。

开始之前，您需要向 PayPal 注册返回 URL（thankyou.php），然后即时付款通知（IPN）将作为 POST 对象提交到注册的 URL，您应该使用 PayPal 验证 POST 对象以确保它有效，之后您可以解析字段，并根据需要提取完成您自己的流程所需的任何数据。

# c# - 可空对象必须有一个值

> ID：16004789
> 
> 赞同：-1
> 
> 时间：2013-04-14T21:51:54.853
> 
> 标签：c#

当我尝试在我的项目中添加数据时出现此错误。它指向此代码：

```
var currentuserid = WebSecurity.CurrentUserId;
var user = db.UserProfiles.SingleOrDefault(u => u.UserId == currentuserid);
List<Claim> claims = db.Claims.Include("Claim_Status").Include("Patient").Include("Hospital").ToList();
var userClaims = claims.Where(c => c.Hospitalid.Value == user.Hospitalid);
return View(userClaims.ToList()); 
```

我该如何解决这个问题。

我正在使用 Microsoft sql server 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:55:17.030

您的一个或多个`HospitalId`s 为空。您可以通过将`Where`子句更改为来修复它：

```
var userClaims = claims.Where(c => c.Hospitalid == user.Hospitalid); 
```

这将过滤掉任何带有 null 的声明`HospitalId`。

请注意，您当前正在加载整个`Claims`表并过滤内存中的集合。您可能想在数据库上执行过滤器，您可以这样做：

```
List<Claim> claims = db.Claims.Include("Claim_Status").Include("Patient").Include("Hospital")
    .Where(c => c.HospitalId == user.Hospitalid)
    .ToList(); 
```

# android - Android - 拖动和调整大小，捏触摸超出范围时出错

> ID：16004794
> 
> 赞同：1
> 
> 时间：2013-04-14T21:52:36.300
> 
> 标签：android, view, touch, zooming, drag

我正在尝试实现视图对象的拖动和调整大小。我在使用捏缩放手势时遇到问题，有时当手指分开太快并离开附有触摸侦听器的视图对象（我试图拖动和缩放相同的视图对象）时，应用程序会崩溃.

因此，我将触摸侦听器附加到填充屏幕的 View 上，然后根据触摸事件的位置限制触摸动作。例如，如果触摸甚至在目标对象的边界内，那么它可以被拖动，如果我触摸到它的边界之外，那么它就不能被拖动。

下面是附加到整个屏幕的触摸监听器的代码。

```
scaleView.setOnTouchListener(new View.OnTouchListener(){
        public boolean onTouch(View v, MotionEvent event){
            float viewWidth = mTouchBox.getWidth();
            float viewHeight = mTouchBox.getHeight();
            switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
                mode = DRAG;
                //get initial box coords:
                x_0 = mTouchBox.getX();
                y_0 = mTouchBox.getY();
                //get initial touch raw coordinates:
                initialTouchRawX = event.getRawX();
                initialTouchRawY = event.getRawY();
                //get current scaling of box
                currentScale = mTouchBox.getScaleX();
                break;
            case MotionEvent.ACTION_POINTER_DOWN:
                oldDist2 = spacing(event);
                if (oldDist2 > 10f) {
                    mode = ZOOM;
                }
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                break;
            case MotionEvent.ACTION_MOVE:
                float xmin = x_0 - viewWidth/2*(currentScale-1);
                float xmax = x_0 + viewWidth + viewWidth/2*(currentScale-1);
                float ymin = y_0 - viewHeight/2*(currentScale-1) + viewShift;
                float ymax = y_0 + viewHeight + viewHeight/2*(currentScale-1) + viewShift;
                //for dragging, check if touch is inside box bounds
                if (mode == DRAG 
                    && initialTouchRawX >= xmin && initialTouchRawX <= xmax 
                    && initialTouchRawY >= ymin && initialTouchRawY <= ymax ) { 
                    //we must shift the touch coordinates some:
                    float mShiftX = -(initialTouchRawX - x_0);
                    float mShiftY = -(initialTouchRawY - y_0);
                    mTouchBox.setX((float) event.getRawX()+mShiftX);
                    mTouchBox.setY((float) event.getRawY()+mShiftY);
                    mTouchBox2.setX((float) event.getRawX()+mShiftX);
                    mTouchBox2.setY((float) event.getRawY()+mShiftY); 
                } else if (mode == ZOOM) {
                    float newDist2 = spacing(event);
                    if (newDist2 > 10f) {
                        float newScale = newDist2 / oldDist2 * currentScale;
                        mTouchBox.setScaleX(newScale);
                        mTouchBox.setScaleY(newScale);                          
                    }
                }
                break;
            }
            return true; 
        }
    }); 
```

这很好用，但我想知道是否有更简单、更有效的方法来做这件事。如果我要将这段代码（经过一些修改）附加到我试图拖动和调整大小的视图对象中，那么如果捏缩放手势看起来移动得太快，我就会出现越界错误。

理想情况下，我只想在需要缩放的对象上进行捏合缩放/缩放，但不一定完全在其范围内，并且如果其中一个手指超出范围，应用程序不会崩溃。关于如何做到这一点的任何建议？

# php - 数据库问题、站点未显示父自定义帖子类型和其他错误

> ID：16004804
> 
> 赞同：0
> 
> 时间：2013-04-14T21:53:26.010
> 
> 标签：php, database, wordpress, post, core

我在这里而不是 wordpress 论坛发帖，因为我相信这确实是一个我无法弄清楚的数据库问题。我正在运行一个 wordpress 网站，我只是尝试将一个项目添加到我的自定义菜单中，但它没有保存。我切换到默认主题（2012），仍然没有。我创建了一个新菜单，向其中添加了 3 页并保存了……然后它们都消失了。我关闭了所有插件，仍然是同样的事情。

于是我开始往下看。我去通过外观区域中的自定义上传我的标题图像，它显示了很好的旧“cheeting huh”文本。

然后我添加了一个插件，我知道它在“页面”选项卡下的仪表板导航中添加了一个额外的导航选项卡，它不会显示。我也无法访问任何帖子。当我将鼠标悬停在“帖子”上时，只显示“类别”和“标签”。也许这是注册帖子类型的问题？

我在仪表板区域的顶部有一条通知，说我需要升级到 3.5.1，我觉得太棒了……只要升级，一切都会好起来的。但它没有解决它。

然后我删除了所有的 wordpress 文件并用新的下载替换它们，但仍然没有修复。

我搜索了谷歌并找到了一个可能的解决方案：

```
define('CONCATENATE_SCRIPTS', false );

to the wp-config.php file just before require_once(ABSPATH . 'wp-settings.php')

define('SCRIPT_DEBUG', true);

to the wp-config.php file 
```

他们俩都不走运，我的 wp-config 文件看起来完全正常。

我还检查了我的 .htaccess 文件，它看起来也很正常：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

最后我登录到我的数据库并删除了所有未使用的表并优化了剩下的但仍然没有。这是在一个拥有 100 多种产品的有效电子商务网站上，因此不能直接报废。

如果我采取一些替代路线来到达像帖子这样的破损部分，它仍然不会分叉。例如，如果我转到前端并转到帖子并单击编辑，则页面顶部没有像他们应该的那样“添加新”的按钮。如果我滚动工具栏“+ new”，它不会列出帖子。如果我直接访问 www.myblogname.com/wp-admin/edit.php?post_type=post 它会显示“您没有足够的权限访问此页面”。为什么...我可以访问其他所有内容，而我的用户角色是管理员。

所以这就是我现在的位置......有什么想法吗？这是一个数据库问题吗，因为我不知道还剩下什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T14:01:55.180

哇，所以你永远不会相信答案.....用户权限。我的管理员用户权限有些混乱，它不允许它显示仪表板的某些区域或执行某些功能。我创建了一个新的管理员用户和 BINGO。一切都解决了。疯狂的。

因此，任何在访问其 Wordpress 仪表板区域或执行特定功能时遇到问题的人，在您执行任何操作之前，请创建一个新的管理员用户。

# emacs - 为 LaTeX Jump to PDF 创建一个键绑定——synctex

> ID：16004805
> 
> 赞同：2
> 
> 时间：2013-04-14T21:53:28.323
> 
> 标签：emacs, latex, emacs24, aquamacs

任何想法如何将其转换为“跳转到 PDF”的全局设置键？

```
(defun aquamacs-latex-viewer-support ()
"Support for Skim as LaTeX viewer if present."
 (add-to-list 'TeX-command-list
     '("Jump to PDF" 
       "%V" TeX-run-discard-or-function nil t :help "Run Viewer") 'append) 
```

右键单击上下文菜单有几个有用的选项，我想我已经追踪到这个文件： `/Applications/Aquamacs.app/Contents/Resources/lisp/aquamacs/auctex-config.el`. 但是，我可能是错的吗？

我认为这将比简单地生成 pdf 更复杂——即：

```
(global-set-key (kbd "<f7>") 'TeX-command-master) 
```

* * *

我现在更近了一步——这个 init.el 配置适用于在 OSX Mountain Lion 上运行的最新版本的 Emacs（通用二进制）——所以现在将它转换为键盘快捷键应该会容易得多。这将重新配置视图选项以跳转到 pdf。这是我得到它的线程的链接（由 Ricardo 编写）： [https ://tex.stackexchange.com/questions/11613/launching-an-external-pdf-viewer-from-emacs-auctex-on-a -mac-osx-失败](https://tex.stackexchange.com/questions/11613/launching-an-external-pdf-viewer-from-emacs-auctex-on-a-mac-osx-fails)

```
(setq TeX-view-program-selection '((output-pdf "Skim")))

(add-hook 'LaTeX-mode-hook 'TeX-source-correlate-mode)

(setq TeX-source-correlate-method 'synctex)

(add-hook 'LaTeX-mode-hook
      (lambda()
        (add-to-list 'TeX-expand-list
             '("%q" skim-make-url))))

(defun skim-make-url () (concat
        (TeX-current-line)
        " "
        (expand-file-name (funcall file (TeX-output-extension) t)
            (file-name-directory (TeX-master-file)))
        " "
        (buffer-file-name)
))

(setq TeX-view-program-list
  '(("Skim" "/Applications/Skim.app/Contents/SharedSupport/displayline %q"))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T18:50:07.017

该解决方案确实`not`依赖于使用 Aquamacs —— 即，通用的 Emacs 风格就足够了。对于带有 package 的 OSX 版本的 Emacs（Snow Leopard 和 Mountain Lion）`auctex-11.86`，以下代码行`tex.el`会影响查看 *.pdf 文件：

第1028行：（“Evince”（“evince”（mode-io-correlate“-p %（outpage）”）“%o”））

第 1119 行：（输出-pdf“Evince”）

Skim.app 被广泛认为是最适合 OSX *.tex 文档的 *.pdf 查看器，因为它能够在检测到 *.pdf 文件更改时自动更新显示，并且因为它能够使用反向搜索（即，command + shift + 左键单击）以在单击鼠标的精确点跳回文本编辑器。

由于 OSX 社区没有广泛使用 Evince，解决方法是修改 tex.el 或修改 init.el。tex.el 中甚至有一个符号表示开发人员需要协调他们的努力以在 OSX 系统上实现查看 *.pdf。

以下是对 init.el 的修改，其中包括我自己选择的键盘快捷键。当前版本`auctex-11.86`已经有`'TeX-view`(Cc Cv) 的键盘快捷键。注意：以下代码将 View 配置为 Jump-To-PDF 并启用了 synctex，因此任何希望在没有 synctex 的情况下快速查看的人都需要稍微不同的配置。我创建的键盘快捷键是 F7 用于构建；F8 跳转到 pdf；和 F9 进行清理，但保留 *.pdf 和 *.tex。

[将来，我计划编写一些代码来使用 /tmp 的 -output-directory 选项并自动将 *.pdf 复制回工作目录，这样就不需要清理了。TexLive 目前不支持 -aux-directory 选项，因此以前的解决方案是消除清理过程的最佳选择。]

```
(global-set-key (kbd "<f7>") 'TeX-command-master) ;; need to set a default for this to work.
(global-set-key (kbd "<f8>") 'TeX-view) ;; jump to *.pdf with synctex (or C-c C-v)
(global-set-key (kbd "<f9>") 'TeX-clean) ;; clean, but leave the *.pdf

(setq TeX-PDF-mode t)

(setq TeX-view-program-selection '((output-pdf "Skim")))

(add-hook 'LaTeX-mode-hook 'TeX-source-correlate-mode)

(setq TeX-source-correlate-method 'synctex)

(add-hook 'LaTeX-mode-hook
    (lambda()
        (add-to-list 'TeX-expand-list
            '("%q" skim-make-url))))

(defun skim-make-url () (concat
    (TeX-current-line)
    " "
    (expand-file-name (funcall file (TeX-output-extension) t)
        (file-name-directory (TeX-master-file)))
    " "
    (buffer-file-name)
))

(setq TeX-view-program-list
    '(("Skim" "/Applications/Skim.app/Contents/SharedSupport/displayline %q"))) 
```

也可以看看：

[https://tex.stackexchange.com/questions/111834/auctex-output-directory-copy-pdf-to-working-directory](https://tex.stackexchange.com/questions/111834/auctex-output-directory-copy-pdf-to-working-directory)

# python - 如何将字符串更改为整数？

> ID：16004806
> 
> 赞同：0
> 
> 时间：2013-04-14T21:53:36.747
> 
> 标签：python

现在我的代码有点纠结。代码：

```
def main(a,b):
    c=a+b
    print("Your answer was: %s"% c)
    input()

def launch():
    print("Please set integer a and integer b!")
    intA=input("Integer A: ")
    intB=input("Integer B: ")
    input("Press return to continue!")
    main(intA, intB) 
```

我需要帮助的是将 intA&intB 转换为 ACTUAL 整数。因为当我运行这段代码时，我得到：3030 ...如果有人能提供帮助，我将不胜感激！谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:55:02.753

改变

```
intA=input("Integer A: ")
intB=input("Integer B: ") 
```

至

```
intA=int(input("Integer A: "))
intB=int(input("Integer B: ")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T21:54:52.827

您可以使用`int`：

```
c = int(a)+int(b) 
```

当然，您甚至可以在调用 main 方法之前进行此转换。

关键是：`int`尝试将参数转换为整数，相反，您可以使用`str`将数字转换为字符串。

# .net - Orchard CMS 自定义模块未加载

> ID：16004810
> 
> 赞同：2
> 
> 时间：2013-04-14T21:53:47.187
> 
> 标签：.net, orchardcms, orchardcms-1.6

我有一个自定义的果园模块。它没有加载。我没有看到它被复制到 App_Data\Dependencies 或添加到 dependencies.xml。

它确实显示在仪表板的模块部分（我已启用它）。

我在 Orchard 错误日志中没有看到任何错误。

我已附加到 Orchard w3wp，但我在模块 bin 目录中的 dll 根本没有加载到 AppDoamin 中。

我该如何进一步解决这个问题？

谢谢你。

更新：

module.txt 如下

```
Name: MyApp
Path: App
AntiForgery: disabled
Author: Me
Website: http://www.myapp.com
Version: 1.0.0
OrchardVersion: 1.6.0
Description: Module for Orchard
Category: Content
Dependencies: 
```

该文件位于 Modules\MyApp 中。

有问题的 dll 位于 Modules\MyApp\bin\MyApp.Web.dll 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T07:15:40.307

Orchard 似乎对模块名称及其组件进行了一些有趣的名称匹配。

我有以下情况：

Module.txt 说名字是 MyApp

模块位于 Modules/MyApp

网站 dll 是 MyApp.Web.dll。类库是 MyApp.dll。

Orchard 决定忽略我的模块。

如果我将 Module.txt 更改为 MyApp.Web，则没有变化。如果我还将虚拟目录更改为 MyApp.Web，Orchard 会加载我的模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T00:20:18.400

如果您已验证清单存在并且有效，则几乎可以肯定它没有编译。尝试从 Visual Studio 打开解决方案并从那里构建它。您应该会看到构建错误。

# django - 如何将初始数据强制转换为实例化的 django ModelForm？

> ID：16004813
> 
> 赞同：0
> 
> 时间：2013-04-14T21:54:11.090
> 
> 标签：django, django-forms

我有一个实例化的表格：

```
user = get_user_model().get(...)
f = forms.UserForm(instance=user, initial={"username":"whatever"}) 
```

但是在渲染时，初始数据不显示，用户模型中包含的数据似乎具有优先级。

无论模型中写了什么，如何强制初始数据出现在表单中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-02-11T18:41:21.850

我知道这很旧，我不知道这是否正是您所要求的，但这可能对其他人有所帮助：

```
class UserForm(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        kwargs['initial'] = {'username': 'whatever'}  # Override instance initial
        super().__init__(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:22:15.183

`user`只需在将其传递给表单之前更改您的实例。`user.save()`除非您明确调用，否则不会保存数据。

# macos - (OSX) 当用户在浏览器中单击电子邮件链接时，操作系统如何将电子邮件地址传送到默认邮件应用程序？

> ID：16004816
> 
> 赞同：0
> 
> 时间：2013-04-14T21:54:28.733
> 
> 标签：macos, email, hyperlink, client

我爸爸很生气，当他单击电子邮件超链接时，OSX 会尝试打开他从未使用过也不想学习的 Mail。他希望它只打开一个浏览器窗口到他的 ISP 提供的电子邮件服务 (bleh)。

我正在尝试编写一个基本上处理该交互的程序，但我无法弄清楚超链接中的电子邮件地址是如何传递给应用程序的。本质上...当我单击 foo@example.com 的 mailto 超链接时，操作系统如何告诉 Mail.app（或任何默认客户端）撰写新电子邮件到 foo@example.com？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T23:32:29.407

首先，Mail.app 通过在其 Info.plist 文件中包含以下内容，被动地告诉 Launch Services 它处理“mailto” URL 方案：

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>Email Address URL</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>mailto</string>
        </array>
        <key>LSIsAppleDefaultForScheme</key>
        <true/>
    </dict>
    ...
</array> 
```

`kInternetEventClass`接下来，它为/ `kAEGetURL`Apple 事件设置一个处理程序。在 Cocoa 中，这看起来像：

```
NSAppleEventManager* appleEventManager = [NSAppleEventManager sharedAppleEventManager];
[appleEventManager setEventHandler:self andSelector:@selector(handleGetURLEvent:withReplyEvent:) forEventClass:kInternetEventClass andEventID:kAEGetURL]; 
```

您可以像这样实现处理程序方法：

```
- (BOOL)handleGetURLEvent:(NSAppleEventDescriptor*)event withReplyEvent:(NSAppleEventDescriptor*)replyEvent
{
    NSAppleEventDescriptor* directObjectDescriptor  = [event paramDescriptorForKeyword:keyDirectObject];
    NSString*               urlString               = [directObjectDescriptor stringValue];
    NSURL*                  url                     = [NSURL URLWithString:urlString];
    // ... do something with url ...
} 
```

对于“mailto” URL，大部分解析行为`NSURL`无效，因为 URL 不符合 RFC 1808（资源说明符不以“//”开头）。您实际上只能使用该`-resourceSpecifier`方法获取方案（mailto）和资源说明符。某些 mailto URL 可能具有类似查询的语法，例如“?subject=Some%20subject%20text”，但`NSURL`不会帮助您将其分开。因此，您需要手动执行此操作。（您可以考虑通过在资源说明符的前面注入“//”并对其进行`NSURL`解析来构造一个虚假的 URL。）

# ios - 当我点击屏幕左侧时，炮塔开火方式错误

> ID：16004817
> 
> 赞同：0
> 
> 时间：2013-04-14T21:54:28.903
> 
> 标签：ios, cocos2d-iphone

我对这一切都很陌生，所以如果这是一个非常无知的问题，我深表歉意。我正在尝试制作一个炮塔，该炮塔将旋转以面对水龙头并朝该方向开火。在 Ray Wenderlich 的旋转炮塔教程中找到了一些代码，我将炮塔移动到屏幕的底部中心，并将弹丸的起点重新定位到同一点。这个位置更类似于旧的导弹指挥风格的游戏。

不幸的是，现在当我点击屏幕右侧时，武器会正确开火，但是当我点击左侧时，它会向下并向右开火，就像它以某种方式翻转命令一样。谁能帮我解决这个问题？是否有另一种编码方式，这样我就不会出现左击问题，或者我是否需要输入额外的内容来翻译坐标以便水龙头正确注册？

```
// Import the interfaces
#import "HelloWorldLayer.h"
#import "SimpleAudioEngine.h"
#import "GameOverLayer.h"
#import "Monster.h"
#import "LevelManager.h"

// Needed to obtain the Navigation Controller
#import "AppDelegate.h"

#pragma mark - HelloWorldLayer

// HelloWorldLayer implementation
@implementation HelloWorldLayer

// Helper class method that creates a Scene with the HelloWorldLayer as the only child.
+(CCScene *) scene
{
    // 'scene' is an autorelease object.
    CCScene *scene = [CCScene node];

    // 'layer' is an autorelease object.
    HelloWorldLayer *layer = [HelloWorldLayer node];

    // add layer as a child to scene
    [scene addChild: layer];

// return the scene
return scene;
}

- (void) addMonster {

    //CCSprite * monster = [CCSprite spriteWithFile:@"monster.png"];
    Monster * monster = nil;
    if (arc4random() % 2 == 0) {
        monster = [[[WeakAndFastMonster alloc] init] autorelease];
    } else {
        monster = [[[StrongAndSlowMonster alloc] init] autorelease];
    }

    // Determine where to spawn the monster along the Y axis
    CGSize winSize = [CCDirector sharedDirector].winSize;
    int minY = monster.contentSize.height / 2;
    int maxY = winSize.height - monster.contentSize.height/2;
    int rangeY = maxY - minY;
    int actualY = (arc4random() % rangeY) + minY;

    // Create the monster slightly off-screen along the right edge,
    // and along a random position along the Y axis as calculated above
    monster.position = ccp(winSize.width + monster.contentSize.width/2, actualY);
    [self addChild:monster];

    // Determine speed of the monster
    int minDuration = monster.minMoveDuration; //2.0;
    int maxDuration = monster.maxMoveDuration; //4.0;
    int rangeDuration = maxDuration - minDuration;
    int actualDuration = (arc4random() % rangeDuration) + minDuration;

    // Create the actions
    CCMoveTo * actionMove = [CCMoveTo actionWithDuration:actualDuration position:ccp(-monster.contentSize.width/2, actualY)];
    CCCallBlockN * actionMoveDone = [CCCallBlockN actionWithBlock:^(CCNode *node) {
        [_monsters removeObject:node];
        [node removeFromParentAndCleanup:YES];

        CCScene *gameOverScene = [GameOverLayer sceneWithWon:NO];
        [[CCDirector sharedDirector] replaceScene:gameOverScene];
    }];
    [monster runAction:[CCSequence actions:actionMove, actionMoveDone, nil]];

    monster.tag = 1;
    [_monsters addObject:monster];

}

-(void)gameLogic:(ccTime)dt {
    [self addMonster];
}

- (id) init
{
    if ((self = [super initWithColor:[LevelManager sharedInstance].curLevel.backgroundColor])) {

        CGSize winSize = [CCDirector sharedDirector].winSize;
        _player = [CCSprite spriteWithFile:@"player2.png"];
        _player.position = ccp(winSize.width/2, 20);
        [self addChild:_player];

        [self schedule:@selector(gameLogic:) interval:[LevelManager sharedInstance].curLevel.secsPerSpawn];

        [self setTouchEnabled:YES];

        _monsters = [[NSMutableArray alloc] init];
        _projectiles = [[NSMutableArray alloc] init];

        [self schedule:@selector(update:)];

        [[SimpleAudioEngine sharedEngine] playBackgroundMusic:@"background-music-aac.caf"];

    }
    return self;
}

- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

    if (_nextProjectile != nil) return;

    // Choose one of the touches to work with
    UITouch *touch = [touches anyObject];
    CGPoint location = [self convertTouchToNodeSpace:touch];

    // Set up initial location of projectile
    CGSize winSize = [[CCDirector sharedDirector] winSize];
    _nextProjectile = [[CCSprite spriteWithFile:@"projectile2.png"] retain];
    _nextProjectile.position = ccp(winSize.width/2, 20);

    // Determine offset of location to projectile
    CGPoint offset = ccpSub(location, _nextProjectile.position);

    // Bail out if you are shooting down or backwards
    //if (offset.x <= 0) return;

    // Determine where you wish to shoot the projectile to
    int realX = winSize.width + (_nextProjectile.contentSize.width/2);
    float ratio = (float) offset.y / (float) offset.x;
    int realY = (realX * ratio) + _nextProjectile.position.y;
    CGPoint realDest = ccp(realX, realY);

    // Determine the length of how far you're shooting
    int offRealX = realX - _nextProjectile.position.x;
    int offRealY = realY - _nextProjectile.position.y;
    float length = sqrtf((offRealX*offRealX)+(offRealY*offRealY));
    float velocity = 480/1; // 480pixels/1sec
    float realMoveDuration = length/velocity;

    // Determine angle to face
    float angleRadians = atanf((float)offRealY / (float)offRealX);
    float angleDegrees = CC_RADIANS_TO_DEGREES(angleRadians);
    float cocosAngle = -1 * angleDegrees;
    float rotateDegreesPerSecond = 180 / 0.5; // Would take 0.5 seconds to rotate 180 degrees, or half a circle
    float degreesDiff = _player.rotation - cocosAngle;
    float rotateDuration = fabs(degreesDiff / rotateDegreesPerSecond);
    [_player runAction:
     [CCSequence actions:
      [CCRotateTo actionWithDuration:rotateDuration angle:cocosAngle],
      [CCCallBlock actionWithBlock:^{
         // OK to add now - rotation is finished!
         [self addChild:_nextProjectile];
         [_projectiles addObject:_nextProjectile];

         // Release
         [_nextProjectile release];
         _nextProjectile = nil;
     }],
      nil]];

    // Move projectile to actual endpoint
    [_nextProjectile runAction:
     [CCSequence actions:
      [CCMoveTo actionWithDuration:realMoveDuration position:realDest],
      [CCCallBlockN actionWithBlock:^(CCNode *node) {
         [_projectiles removeObject:node];
         [node removeFromParentAndCleanup:YES];
    }],
      nil]];

    _nextProjectile.tag = 2;

    [[SimpleAudioEngine sharedEngine] playEffect:@"pew-pew-lei.caf"];
}

- (void)update:(ccTime)dt {

    NSMutableArray *projectilesToDelete = [[NSMutableArray alloc] init];
    for (CCSprite *projectile in _projectiles) {

        BOOL monsterHit = FALSE;
        NSMutableArray *monstersToDelete = [[NSMutableArray alloc] init];
        for (Monster *monster in _monsters) {

            if (CGRectIntersectsRect(projectile.boundingBox, monster.boundingBox)) {
                monsterHit = TRUE;
                monster.hp --;
                if (monster.hp <= 0) {
                    [monstersToDelete addObject:monster];
                }
                break;
            }
        }

        for (CCSprite *monster in monstersToDelete) {

            [_monsters removeObject:monster];
            [self removeChild:monster cleanup:YES];

            _monstersDestroyed++;
            if (_monstersDestroyed > 30) {
                CCScene *gameOverScene = [GameOverLayer sceneWithWon:YES];
                [[CCDirector sharedDirector] replaceScene:gameOverScene];
            }
        }

        if (monsterHit) {
            [projectilesToDelete addObject:projectile];
            [[SimpleAudioEngine sharedEngine] playEffect:@"explosion.caf"];
        }
        [monstersToDelete release];
    }

    for (CCSprite *projectile in projectilesToDelete) {
        [_projectiles removeObject:projectile];
        [self removeChild:projectile cleanup:YES];
    }
    [projectilesToDelete release];
}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
    [_monsters release];
    _monsters = nil;
    [_projectiles release];
    _projectiles = nil;
    [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:51:23.390

我再次查看了您的代码，并发现了其他问题。我更改了以下部分：

*   下面拍摄时的“救助”条件（注意顺序更改，否则在第一次满足救助条件后您将无法获得镜头！）
*   计算`realY`和`realX`- 您离开了 Ray 教程中的代码，并将目标位置设置为始终位于右侧，而在下面的代码中，它始终位于顶部
*   删除`atan`/`atan2`功能并`ccpToAngle(ccp(offRealX, offRealY))`改为使用

以下是已更改的代码部分。如果您需要，我可以分享整个修改后的项目，但它应该足以替换您`ccTouchesEnded`方法的开头。

```
- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (_nextProjectile != nil) return;

    CGSize winSize = [[CCDirector sharedDirector] winSize];

    // Choose one of the touches to work with
    UITouch *touch = [touches anyObject];
    CGPoint location = [self convertTouchToNodeSpace:touch];

    CGPoint targetPosition = ccp(winSize.width / 2, 20);

    // Determine offset of location to projectile
    CGPoint offset = ccpSub(location, targetPosition);

    // Bail out if you are shooting down or backwards
    if (offset.y <= 0)
    {
    return;
    }

    // Set up initial location of projectile
    _nextProjectile = [[CCSprite spriteWithFile:@"projectile2.png"] retain];
    _nextProjectile.position = targetPosition;

    // Determine where you wish to shoot the projectile to
    int realY = winSize.height + (_nextProjectile.contentSize.height/2);
    float ratio = (float) offset.x / (float) offset.y;
    int realX = (realY * ratio) + _nextProjectile.position.x;
    CGPoint realDest = ccp(realX, realY);

    // Determine the length of how far you're shooting
    int offRealX = realX - _nextProjectile.position.x;
    int offRealY = realY - _nextProjectile.position.y;
    float length = sqrtf((offRealX*offRealX)+(offRealY*offRealY));
    float velocity = 480/1; // 480pixels/1sec
    float realMoveDuration = length/velocity;

    // Determine angle to face
    float angleRadians = ccpToAngle(ccp(offRealX, offRealY)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T19:41:57.823

我会说你应该用 替换你`atanf`的`atan2f`，即替换

```
float angleRadians = atanf((float)offRealY / (float)offRealX); 
```

with （注意分别`atan2f`接受`Y`和`X`！）

```
float angleRadians = atan2f((float)offRealY, (float)offRealX); 
```

查看[有关 atan2 的 Wikipedia 文章](http://en.wikipedia.org/wiki/Atan2)。您将从 0-PI/2 看到这一点，`atanf`并将`atan2f`给您相同的结果。然而，一旦你从 PI/2 转向 PI，你会得到负角，而使用`atanf`while`atan2f`会产生正确的角。

# php - 请求参数php中的数组

> ID：16004819
> 
> 赞同：0
> 
> 时间：2013-04-14T21:54:31.450
> 
> 标签：php, arrays

我可以在php的请求参数中传递一个数组吗

例如

我这里有一个隐藏的提交表单

```
<form action="" method="POST"><input type="hidden" name="myarray" value="' . $arrayofvalues . '"> 
```

然后我可以这样调用正确的变量吗？

```
($_REQUEST['arrayofvalues[1]']
($_REQUEST['arrayofvalues[2]'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:55:05.260

是的。只需在输入名称属性中使用 PHP 数组语法：

```
<input type="hidden" name="myarray[]" value="<?php echo $_REQUEST['myarray'][0]; ?>">
<input type="hidden" name="myarray[]" value="<?php echo $_REQUEST['myarray'][1]; ?>"> 
```

在 PHP 中：

```
print_r($_REQUEST['myarray']); 
```

# node.js - Node.js 在 app.js 之外需要失败

> ID：16004824
> 
> 赞同：1
> 
> 时间：2013-04-14T21:54:54.000
> 
> 标签：node.js, path, require

我正在尝试`./routes/exchange.js`从另一个模块加载自定义模块`./routes/socketRouter.js`。它抛出

```
module.js:340
throw err;
      ^
Error: Cannot find module './routes/exchange' 
```

`require('./routes/exchange)`从 app.js（在根目录中）完成的相同调用是成功的！

是否存在阻止在 app.js 之外的其他地方调用 require 的限制？

我已经尝试了许多不同的路径，例如： `require('./routes/exchange.js')`,,,`require('exchange')``require('exchange.js')`

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:01:45.420

```
require('./exchange') 
```

这将在与您需要的源模块相同的目录中加载一个模块。

`require('exchange')``node_modules`如果模块位于基本目录中，则只会加载该模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:02:32.327

当需要客户模块和文件时，您提供文件的相对路径。所以使用以下结构

```
./my-app
  app.js
  routes/
    exchange.js
    socketRouter.js
  some-folder/
    some-file.js 
```

现在，当包含`exchange.js`from时`app.js`，您将使用`require('./routes/exchange')`当从 socketRouter.js 包含它时，您将它在同一个文件夹中，所以`require('./excahnge')`.

为清楚起见，当想要从 some-file.js 中包含 exchange.js 时，您可以将其引用为`require('../routes/exchnage')`

（注意，.js 扩展名在通过 require 调用时是可选的，如果 exchange 是一个文件夹，那么它将从该文件夹加载 index.js 文件，请参见[http://nodejs.org/api/modules.html#modules_file_modules](http://nodejs.org/api/modules.html#modules_file_modules)和[http://nodejs.org/api/modules.html#modules_folders_as_modules](http://nodejs.org/api/modules.html#modules_folders_as_modules)）

# clojure - Clojure 中的内存文件类型对象

> ID：16004828
> 
> 赞同：3
> 
> 时间：2013-04-14T21:55:06.160
> 
> 标签：clojure, java-io

我刚刚开始使用 Clojure，想调用一个 Java 方法，该方法将要读取的输入文件和要写入的输出文件作为参数。两者似乎都是 java.io.File 类型。我想调用的方法是此类中的“解析”：

[http://htmltolatex.sourceforge.net/javadoc/cz/kebrt/html2latex/Parser.html](http://htmltolatex.sourceforge.net/javadoc/cz/kebrt/html2latex/Parser.html)

但是，因为我将重复调用该方法，所以我更喜欢使用内存中的对象而不是磁盘上的文件。

我已经成功加载了 Parser 类的一个实例：

```
(def my_parser (cz.kebrt.html2latex.Parser.)) 
```

我相信我已经成功创建了一个类似内存文件的对象，可以使用以下命令从中读取：

```
(def input-object (java.io.StringBufferInputStream. "this is a test")) 
```

但是，我应该传递什么样的文件（如对象）来捕获输出？（为了完整起见，我应该提一下，这个输出文件首先用于构造 ParserHandler 的实例，然后将其传递给上面创建的解析器。http: [//htmltolatex.sourceforge.net/javadoc/cz/kebrt/ html2latex/ParserHandler.html](http://htmltolatex.sourceforge.net/javadoc/cz/kebrt/html2latex/ParserHandler.html) )

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T22:12:45.160

我很确定这个（设计糟糕的）API 是用于旧版本的软件，它不允许你做你想做的事情。（即，您不能创建`File`内容在内存中的内容。这不是该类的用途。）

[最新版本](http://htmltolatex.svn.sourceforge.net/viewvc/htmltolatex/src/cz/kebrt/html2latex/parser/Parser.java?revision=15&view=markup)似乎有一个构造函数，您可以将 a`java.io.File`或 a传递给该构造函数`String`。后者应该是你所追求的。

编辑：我认为为您清理一些东西可能会很好，因为您似乎来自 Python 背景（鉴于您反复使用“类文件”一词）。`java.io.File`是一个误导性的名字。它实际上更像是一条路径。例如，如果你想检查一个文件是否存在，你会做`(.exists (java.io.File. "my/path"))`. A`File`也可以是目录。我知道这很愚蠢，但是嘿，它是java。（如果您想了解更多，请看[这里](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)）。这个 Parser 类真正应该提供的是传递 a 的能力`java.io.Reader`，这就像对一系列字符的抽象视图。在内部，他们将`String`option 和`File`option 都转换为 a `Reader`，因此他们不只是接受读者并切断中间人，这是非常糟糕的设计。

# android - OpenGL ES 2.0 | 游戏屏幕顶部的 GUI 屏幕？

> ID：16004835
> 
> 赞同：0
> 
> 时间：2013-04-14T21:55:49.443
> 
> 标签：android, user-interface, opengl-es, controls, opengl-es-2.0

好的，所以我想用 openGL ES 2.0 制作游戏，但我的控件有问题。到目前为止，我制作的控件就像我游戏中的任何其他精灵一样，只需绘制它，如果相机更新，控件将在它像“移动”相机后更新。

有没有更有效的方法来做到这一点？这是我想做的一个例子：

*游戏画面

![游戏画面 (OpenGL ES 2.0)](https://i.stack.imgur.com/4RCj8.jpg)

*控制

![游戏控制](https://i.stack.imgur.com/OLaZ9.jpg)

然后就像将控件放在游戏屏幕的顶部，这样即使相机移动它也不会移动。可能吗？也许混合xml？如果是这样，那怎么办？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-05T20:15:41.553

当你每一帧都在同一个地方画同样的东西时，感觉就像是无用的工作，但另一方面，屏幕的每个像素可能都会重绘每一帧。大多数游戏都不会竭尽全力避免这种额外的工作。我建议尽量避免绘制不可见像素来提高性能，例如：

*   将几何图形收缩包裹在 UI 周围，因此您使用 alpha 0 绘制的像素越少越好。这可能涉及绘制更多三角形，但根据我的经验，这种权衡是值得的。

*   让深度测试为您服务。如果您的 UI 完全不透明，您所要做的就是先绘制它，然后在背景中绘制场景的其余部分，这样如果像素被 UI 遮挡，它们就不会绘制。如果您的 UI 只是部分不透明，您可以尝试将其细分为不透明三角形和半透明三角形，并在最后单独调用中绘制半透​​明的，以便您可以对不透明的进行深度测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:05:25.280

我从来没有开发过，`OpenGL`但如果你在某个布局内开发它。那么你可以做的是：

1.  将您的游戏布局放在`FrameLayout`.

2.  将 a `Linearlayout`or`RelativeLayout`放在同一个`FrameLayout`.

3.  将控件放置在您添加的布局中。

这样您将添加的控件将出现在游戏顶部，您可以使布局半透明以获得更好的用户体验。

# sublimetext2 - 如何在 Sublime Text 2 中打印

> ID：16004842
> 
> 赞同：213
> 
> 时间：2013-04-14T21:56:38.493
> 
> 标签：sublimetext2

Sublime Text 2 似乎是一个很棒的编辑器。我一周前才开始在评估模式下使用它，它似乎没有任何打印功能。这对我来说似乎很荒谬，但我在任何地方都找不到。

这是购买后解锁的功能吗？我在公司网站上没有看到任何提及。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-10-23T10:08:40.447

还有 Simple Print 包，它使用 enscript 进行实际打印。

类似于kenorb的回答，打开调色板（ctrl/cmd+shift+p），“安装包”，“简单打印功能”

您必须安装 enscript，方法如下：

[https://github.com/svenax/SublimePrint](https://github.com/svenax/SublimePrint)

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2013-04-14T22:01:15.250

尚不支持此功能。您可以先使用插件将文本导出为 HTML 或 RTF，然后根据需要将其打印出来。

例如，可以用于导出的[SublimeHighlight插件。](https://github.com/n1k0/SublimeHighlight)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2016-03-01T19:20:12.863

**TL;DR** *使用`Cmd/Ctrl+Shift+P`then `Package Control: Install Package`，然后`Print to HTML`安装它。用于`Alt+Shift+P`打印。*

我最喜欢的从 Sublime Text 打印的工具是**[Print to HTML](https://github.com/joelpt/sublimetext-print-to-html)** package。您可以通过网络浏览器“打印”一个选择或整个文件。

# 用法

1.  进行选择（或对整个文件不进行选择）
2.  按`Alt`+ `Shift`+`P` **或** `Shift`+ `Command`+`P`并输入“打印到 HTML”。

这将打开您的浏览器打印对话框（对我来说是 Chrome），所选文本整齐地显示在打印对话框窗口中，语法高亮显示完好无损。在那里您可以选择打印机或导出为 PDF 并打印。

# 设置

使用包管理器安装“打印到 HTML”包。

1.  `Ctrl + Shift + P`=> 给出命令列表。
2.  `install`通过键入“ ”找到包管理器
3.  您会看到一些选择。选择“ `Package Control: Install Package`”
4.  这将打开一个包列表。输入“ `print to`”
5.  其中一个选项应该是“ `Print to HTML`”。选择它，它正在安装。
6.  您现在可以通过键盘快捷键使用“打印到 html”`Alt+Shift+P`

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2014-12-18T00:15:17.350

**2016 年更新：**在 2015年[7 月](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)[至 2016](http://web.archive.org/web/20160109062812/http://sublimetext.userecho.com/topic/25170-printing/)年 1 月之间的某处，我在 2014 年写的打印功能请求已**被删除**。原始答案如下，相关链接已更改为 Web 存档中的最新工作版本：

## 2014 年原始答案

在 Sublime Text 中打印是一项请求了大约 4 年（截至 2014 年）的功能，在下面的讨论中有 1600 多张支持票和 160 多条评论。对于大约 6000 个功能请求，这是前 5 名。

查看原始的、仍然开放的功能请求：

*   **[打印 - 应该可以](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)在 Sublime Text 的 UserEcho 官方论坛上打印文件**

[![在此处输入图像描述](https://i.stack.imgur.com/S0gI9.png)](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)

从功能请求（仍然开放，没有官方答案）来看，打印似乎不太可能在版本 3（正如其他人所建议的那样）或任何版本中实现。

[此功能请求下方](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)的讨论可能会提供一些关于**为什么**不支持打印以及将来是否有机会获得支持的见解。

**也许如果更多的人投票或评论它会在未来改变。** *（有关功能请求的最新列表，请参阅下面的 2016 年更新）*

提出了一些变通办法，最流行的建议是使用**其他一些编辑器**进行打印（例如[Brackets](http://brackets.io/)、[Atom](https://atom.io/)、[gedit](https://wiki.gnome.org/Apps/Gedit)、[Notepad++](http://notepad-plus-plus.org/)）或使用一些据报道无法正常工作或根本无法正常工作的第 3 方插件。

一般来说，强烈反对将打印添加为 Sublime Text 的原生功能，对于文本编辑器中的这种通用功能来说，这似乎令人惊讶，但仍然可能会为这个问题提供一些启示。

同时，有许多可以打印的免费编辑器（事实上我想不出一个不能打印的），所以当需要打印时，可以很容易地使用其他编辑器。

## 2016 年更新

由于[上述功能请求](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)已被[**删除**](http://web.archive.org/web/20160109062812/http://sublimetext.userecho.com/topic/25170-printing/) **（如果有人知道原因，请发表评论）**这里是其他一些地方的最新列表，以查找有关在 Sublime Text 中打印的更多信息：

*   [Sublime Text 功能请求 #25170：**打印**](http://web.archive.org/web/20150701214838/http://sublimetext.userecho.com/topic/25170-printing/)（Web 存档，2015 年 7 月）
*   [Sublime Text 功能请求 #128509：**请添加打印功能！**](http://sublimetext.userecho.com/topic/128509-please-add-printing-features/)
*   [Sublime Text 功能请求 #150254：**Sublime Text2 中没有打印选项**](http://sublimetext.userecho.com/topic/150254-no-print-option-in-sublime-text2/)
*   [Sublime Text 功能请求 #149563：**需要打印和漂亮的打印**](http://sublimetext.userecho.com/topic/149563-printing-and-pretty-printing-required/)
*   [Sublime Text 功能请求 #128718：**Sublime Text 无法打印吗？**](http://sublimetext.userecho.com/topic/128718-is-sublime-text-unable-to-print/)
*   [Sublime Text 功能请求 #380352：**打印**](http://sublimetext.userecho.com/topic/380352-printing/)
*   [Sublime Text 功能请求 #203216：**打印打印打印**](http://sublimetext.userecho.com/topic/203216-print-print-print-print-print-print-print-print-print-print-print-print-print-print-print-print/)
*   [Sublime Text 功能请求 #128718：**是否有打印文件的菜单选项？**](http://sublimetext.userecho.com/topic/128718-is-sublime-text-unable-to-print/)
*   [其他与打印相关的 Sublime Text 功能请求](http://sublimetext.userecho.com/#module_62582/search/print)
*   [从 Sublime 打印 - Sublime 论坛](https://www.sublimetext.com/forum/viewtopic.php?f=3&t=607)

**由于最初的功能请求 #25170 已被删除，您应该在其他有关打印的功能请求中投票和评论。**

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-10-01T09:19:14.253

1.  首先安装[Package Control](https://sublime.wbond.net/installation)并重新启动编辑器。请参阅：[如何将插件安装到 Sublime Text 2 编辑器？](https://stackoverflow.com/questions/15652758/install-plugins-to-sublimetext-2/19111997)
2.  安装[高亮](https://github.com/n1k0/SublimeHighlight)插件。
    1.  打开托盘，按 ctrl+shift+p (Win, Linux) 或 cmd+shift+p (OS X)。
    2.  输入并确认：安装包
    3.  输入并确认：突出显示或打印

* * *

另请参阅相关打印论坛主题：[从 sublime 打印](http://www.sublimetext.com/forum/viewtopic.php?f=3&t=607)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-26T17:26:20.580

我喜欢[ExportHTML](http://facelessuser.github.io/ExportHtml/installation/)，它导出为 html，在浏览器中打开它，并可选择打开系统打印对话框。看起来也不错。不是本机打印的完美替代品，但非常接近。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-14T22:07:32.643

不好意思说 sublimetext2 中没有打印功能，可能是 3 会解决这个问题？

无论如何，有一些插件正在浮动，对您最有帮助的可能是 print-to-HTML [https://github.com/joelpt/sublimetext-print-to-html](https://github.com/joelpt/sublimetext-print-to-html)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-25T14:32:27.737

打印代码的一种方法是将其推送到 Github 或 Bitbucket 等在线版本控制系统。在浏览器中，导航到文件并打印它。

这样做，您将获得语法突出显示和版本控制。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-17T15:38:50.290

仍然没有打印没有本机打印功能，但是在安装建议的软件包之外，您可以使用自动热键方式，因为该应用程序实际上也可以帮助您为其他东西运行宏。因此，您可以执行类似创建宏的操作，只需单击一下即可：

1.  选择所有文本
2.  复制所有文本
3.  打开您选择的其他编辑
4.  粘贴文本
5.  打印文本

没有最迷人的选项，但如果接收应用程序可以接受代码格式，也可以工作。

# python - Django 适配器 CSV 需要数小时才能导入

> ID：16004844
> 
> 赞同：7
> 
> 时间：2013-04-14T21:56:47.317
> 
> 标签：python, django

我正在使用[Django 适配器](http://django-adaptors.readthedocs.org/en/latest/)上传一个简单的 CSV。当我导入 100 或 200 个联系人时，它似乎工作得很好。但是当我尝试上传一个包含 5000 个联系人的 165kb 文件时，它永远不会完成。我让它继续尝试，当我在 1 小时后回来时，它仍在尝试。

这有什么问题？[使用Django 适配器](http://django-adaptors.readthedocs.org/en/latest/)导入一个 165kb 的文件不可能花费一个多小时。**代码有问题吗？**

```
 def process(self):
        self.date_start_processing = timezone.now()
        try:

            # Try and import CSV
            ContactCSVModel.import_data(data=self.filepath, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}])

            self._mark_processed(self.num_records)
        except Exception as e:
            self._mark_failed(unicode(e)) 
```

**CSV模型**

```
class ContactCSVModel(CsvModel):

    first_name = CharField()
    last_name = CharField()
    company = CharField()
    mobile = CharField()
    group = DjangoModelField(Group)
    contact_owner = DjangoModelField(User)

    class Meta:
        delimiter = "^"
        dbModel = Contact
        update = {'keys': ["mobile", "group"]} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T22:39:51.987

将较大的任务分成较小的部分。

**第 1 步 - 只需读取 CSV 文件**

ContactCSVModel.import_from_filename() 和 ContactCSVModel.import_from_file() 都返回 csv 行。禁用与 django 模型的交互以跳过与数据库的交互。这应该会大大加快任务并打印导入的数据。这绝对应该有效！

CSV模型

```
class ContactCSVModel(CsvModel):

    first_name = CharField()
    last_name = CharField()
    company = CharField()
    mobile = CharField()
    group = DjangoModelField(Group)
    contact_owner = DjangoModelField(User)

    class Meta:
        delimiter = "^" 
```

你的代码

```
 def process(self):
        self.date_start_processing = timezone.now()
        try:

            # Try and import CSV
            lines = ContactCSVModel.import_data(data=self.filepath, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}])
            print lines # or use logging

            self._mark_processed(self.num_records)
        except Exception as e:
            self._mark_failed(unicode(e)) 
```

**第 2 步 - 启用 django 模型交互但禁用以检查数据库中的现有项目。**

禁用它，因为启用此功能将查询 CSV 中每一行的数据库，以根据您的自然键规范检查现有项目（我已阅读源代码）。可能您知道 CSV 中的所有行都是唯一联系人。

如果您的问题是整个导入过程中的数据库查询缓慢，这将有所帮助，但如果导入消耗太多内存，则并没有真正的帮助。

```
class ContactCSVModel(CsvModel):

    first_name = CharField()
    last_name = CharField()
    company = CharField()
    mobile = CharField()
    group = DjangoModelField(Group)
    contact_owner = DjangoModelField(User)

    class Meta:
        delimiter = "^"
        dbModel = Contact 
```

**第 3 步 - 导入相同大小的 CSV 块**

使用 CSVModel 并启用与 Contact 模型的交互，但为 ContactCSVModel.import_data() 提供更小的迭代。我将其设置为 500。根据您的需要更改它。下面的代码示例（[链接](https://stackoverflow.com/questions/4956984/how-do-you-split-a-csv-file-into-evenly-sized-chunks-in-python)）是为了让您了解。您需要对其进行一些更改以将其放入现有代码中。如果内存消耗是问题，这将有所帮助。

```
import csv
reader = csv.reader(open(self.filepath, 'rb'))

def gen_chunks(reader, chunksize=100):
    """ 
    Chunk generator. Take a CSV `reader` and yield
    `chunksize` sized slices. 
    """
    chunk = []
    for i, line in enumerate(reader):
        if (i % chunksize == 0 and i > 0):
            yield chunk
            del chunk[:]
        chunk.append(line)
    yield chunk

for chunk in gen_chunks(reader, chunksize=500):
    ContactCSVModel.import_data(data=chunk, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}]) 
```

**第 4 步 - 针对大量内存消耗和缓慢运行**

因为 django-adaptors 在导入期间将所有 Contact 模型实例保存在内存中，并且由于多次单次提交而不是批量插入操作而导致操作缓慢 - 它不太适合较大的文件。

你有点依赖 django-adaptors。如果您依赖此 django 包，则无法切换到批量插入。在 linux 下使用 top 或 htop 检查内存消耗，在 windows 上使用任务管理器。如果进程消耗太多并且操作系统开始交换，请切换到另一个 django 附加组件，该附加组件具有更高效的内存消耗和批量插入作为选项 - 有很多用于 csv 导入。

另一个提示是使用 csv 模块进行阅读，并使用您的 django 模型知识与数据库进行交互。这对你来说并不是一个真正的挑战——只要尝试一下你的大局中的孤立任务，如果它们正在工作，就把它们放在一起——祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T10:41:53.893

首先要尝试的是向`import_data`函数传递一个可迭代对象：

```
ContactCSVModel.import_data(open(self.filepath), extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}]) 
```

要尝试的第二件事是使用`import_from_filename`：

```
ContactCSVModel.import_from_filename(self.filepath, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}]) 
```

如果这没有帮助，请尝试找出它挂在哪里。您可以通过减小 csv 文件的大小来手动执行此操作，或者您可以在 上放置一个模拟`csv.reader`，或者您可以模拟[CsvImporter.process_line](https://github.com/anthony-tresontani/django-adaptors/blob/master/adaptor/model.py#L463)而不是处理行，而是打印出它们以查看它在哪里停止。如果您在嘲笑方面需要帮助，请告诉我。

此外，这个[问题](https://github.com/anthony-tresontani/django-adaptors/issues/7)可能是相关的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T12:40:38.940

我会首先检查 csv 中没有数据错误。例如，如果一列有错误的转义字符或不正确的数据类型 - 也许数据库不能接受某些列上的空值。

在挂起时，您可以手动检查数据库是否正在填充吗？通过命令行 MySQL 提示符或工作台？如果是，则自动提交已打开，您应该能够看到它挂在哪一行 - 然后检查 CSV 中的记录。

但是，如果关闭自动提交（我不知道 Django 默认会做什么，或者您的数据库是如何配置的），那么您可能会溢出事务缓冲区。应该有一种方法可以分阶段手动刷新/提交事务来解决这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T17:55:49.870

我对 django-adaptors 了解不多，但是当数据库导入缓慢时，一些对我有帮助的事情是`@transaction.commit_manually()`在方法上使用装饰器，或者使用该`Model.objects.bulk_create()`方法。对您来说，看起来 commit_manually 方法可能会有所帮助，但 bulk_create 方法不会，因为您实际上并没有控制创建过程。

# r - 可视化文本之间的距离

> ID：16004847
> 
> 赞同：10
> 
> 时间：2013-04-14T21:57:09.667
> 
> 标签：r, matlab, graph, distance, text-mining

我正在为学校做一个研究项目。我编写了一些文本挖掘软件，可以分析集合中的法律文本并输出一个分数，表明它们有多相似。我运行程序将每个文本与其他文本进行比较，我有这样的数据（尽管还有更多点）：

```
codeofhammurabi.txt crete.txt      0.570737
codeofhammurabi.txt iraqi.txt      1.13475
codeofhammurabi.txt magnacarta.txt 0.945746
codeofhammurabi.txt us.txt         1.25546
crete.txt iraqi.txt                0.329545
crete.txt magnacarta.txt           0.589786
crete.txt us.txt                   0.491903
iraqi.txt magnacarta.txt           0.834488
iraqi.txt us.txt                   1.37718
magnacarta.txt us.txt              1.09582 
```

现在我需要将它们绘制在图表上。我可以轻松地反转分数，因此现在小值表示相似的文本，而大值表示不同的文本：该值可以是表示文本的图表上的点之间的距离。

```
codeofhammurabi.txt crete.txt      1.75212
codeofhammurabi.txt iraqi.txt      0.8812
codeofhammurabi.txt magnacarta.txt 1.0573
codeofhammurabi.txt us.txt         0.7965
crete.txt iraqi.txt                3.0344
crete.txt magnacarta.txt           1.6955
crete.txt us.txt                   2.0329
iraqi.txt magnacarta.txt           1.1983
iraqi.txt us.txt                   0.7261
magnacarta.txt us.txt              0.9125 
```

简短版本：直接在上面的那些值是散点图上点之间的距离（1.75212 是 codeofhammurabi 点和 crete 点之间的距离）。我可以想象一个大的方程系统，其中圆圈代表点之间的距离。制作此图表的最佳方法是什么？我有 MATLAB、R、Excel，并且可以访问我可能需要的几乎所有软件。

如果您能指出我的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-15T08:19:03.893

如果问题是“我怎么能像[这个人](http://www.sciencedaily.com/releases/2012/08/120827073906.htm)那样做？” （来自xiii1408对问题的评论），那么答案是**使用[Gephi](https://gephi.org/)内置的Force Atlas 2算法对文档主题后验概率的欧几里得距离**。

“这家伙”就是马特·乔克斯，他是一位数字人文领域的创新学者。[他在他的博客](http://www.matthewjockers.net/)和[其他](http://www.dh2012.uni-hamburg.de/conference/programme/abstracts/computing-and-visualizing-the-19th-century-literary-genome/) [地方](http://www.matthewjockers.net/2012/07/20/computing-and-visualizing-the-19th-century-literary-genome/)等上记录了他的一些方法[。Jockers](http://vimeo.com/52959139)主要工作`R`并[分享他的一些代码](http://www.matthewjockers.net/materials/dhwi-2013/)。他的基本工作流程似乎是：

1.  将纯文本分成 1000 个单词的块，
2.  删除停用词（不要词干），
3.  做词性标注，只保留名词，
4.  构建主题模型（使用 LDA），
5.  根据主题比例计算文档之间的欧几里得距离，对距离进行子集化以仅将距离保持在某个阈值以下，然后
6.  用力导向图可视化

这是一个小规模的可重现示例`R`（导出到 Gephi），可能与 Jockers 所做的相近：

```
#### prepare workspace
# delete current objects and clear RAM
rm(list = ls(all.names = TRUE))
gc() 
```

获取数据...

```
#### import text
# working from the topicmodels package vignette
# using collection of abstracts of the Journal of Statistical Software (JSS) (up to 2010-08-05).
install.packages("corpus.JSS.papers", repos = "http://datacube.wu.ac.at/", type = "source")
data("JSS_papers", package = "corpus.JSS.papers")
# For reproducibility of results we use only abstracts published up to 2010-08-05 
JSS_papers <- JSS_papers[JSS_papers[,"date"] < "2010-08-05",] 
```

清洁和重塑...

```
#### clean and reshape data
# Omit abstracts containing non-ASCII characters in the abstracts
JSS_papers <- JSS_papers[sapply(JSS_papers[, "description"], Encoding) == "unknown",]
# remove greek characters (from math notation, etc.)
library("tm")
library("XML")
remove_HTML_markup <- function(s) tryCatch({
    doc <- htmlTreeParse(paste("<!DOCTYPE html>", s),
                         asText = TRUE, trim = FALSE)
                         xmlValue(xmlRoot(doc))
                         }, error = function(s) s)
# create corpus
corpus <- Corpus(VectorSource(sapply(JSS_papers[, "description"], remove_HTML_markup)))
# clean corpus by removing stopwords, numbers, punctuation, whitespaces, words <3 characters long..
skipWords <- function(x) removeWords(x, stopwords("english"))
funcs <- list(tolower, removePunctuation, removeNumbers, stripWhitespace, skipWords)
corpus_clean <- tm_map(corpus, wordLengths=c(3,Inf), FUN = tm_reduce, tmFuns = funcs) 
```

词性标注和名词子集...

```
#### Part-of-speach tagging to extract nouns only
library("openNLP", "NLP")
# function for POS tagging
tagPOS <-  function(x) {

  s <- NLP::as.String(x)
  ## Need sentence and word token annotations.

  a1 <- NLP::Annotation(1L, "sentence", 1L, nchar(s))
  a2 <- NLP::annotate(s, openNLP::Maxent_Word_Token_Annotator(), a1)
  a3 <- NLP::annotate(s,  openNLP::Maxent_POS_Tag_Annotator(), a2)

  ## Determine the distribution of POS tags for word tokens.
  a3w <- a3[a3$type == "word"]
  POStags <- unlist(lapply(a3w$features, `[[`, "POS"))

  ## Extract token/POS pairs (all of them): easy - not needed
  # POStagged <- paste(sprintf("%s/%s", s[a3w], POStags), collapse = " ")
  return(unlist(POStags))
} 
# a  loop to do POS tagging on each document and do garbage cleaning after each document
# first prepare vector to hold results (for optimal loop speed)
corpus_clean_tagged <- vector(mode = "list",  length = length(corpus_clean))
# then loop through each doc and do POS tagging
# warning: this may take some time!
for(i in 1:length(corpus_clean)){
  corpus_clean_tagged[[i]] <- tagPOS(corpus_clean[[i]])
  print(i) # nice to see what we're up to
  gc()
}

# subset nouns
wrds <- lapply(unlist(corpus_clean), function(i) unlist(strsplit(i, split = " ")))
NN <- lapply(corpus_clean_tagged, function(i) i == "NN")
Noun_strings <- lapply(1:length(wrds), function(i) unlist(wrds[i])[unlist(NN[i])])
Noun_strings <- lapply(Noun_strings, function(i) paste(i, collapse = " "))
# have a look to see what we've got
Noun_strings[[1]]
[8] "variogram model splus user quality variogram model pairs locations measurements variogram nonstationarity outliers variogram fit sets soil nitrogen concentration" 
```

具有潜在狄利克雷分配的主题建模...

```
#### topic modelling with LDA (Jockers uses the lda package and MALLET, maybe topicmodels also, I'm not sure. I'm most familiar with the topicmodels package, so here it is. Note that MALLET can be run from R: https://gist.github.com/benmarwick/4537873
# put the cleaned documents back into a corpus for topic modelling
corpus <- Corpus(VectorSource(Noun_strings))
# create document term matrix 
JSS_dtm <- DocumentTermMatrix(corpus)
# generate topic model 
library("topicmodels")
k = 30 # arbitrary number of topics (they are ways to optimise this)
JSS_TM <- LDA(JSS_dtm, k) # make topic model
# make data frame where rows are documents, columns are topics and cells 
# are posterior probabilities of topics
JSS_topic_df <- setNames(as.data.frame(JSS_TM@gamma),  paste0("topic_",1:k))
# add row names that link each document to a human-readble bit of data
# in this case we'll just use a few words of the title of each paper
row.names(JSS_topic_df) <- lapply(1:length(JSS_papers[,1]), function(i) gsub("\\s","_",substr(JSS_papers[,1][[i]], 1, 60))) 
```

使用主题概率作为文档的“DNA”计算一个文档与另一个文档的欧几里得距离

```
#### Euclidean distance matrix
library(cluster)
JSS_topic_df_dist <-  as.matrix(daisy(JSS_topic_df, metric =  "euclidean", stand = TRUE))
# Change row values to zero if less than row minimum plus row standard deviation
# This is how Jockers subsets the distance matrix to keep only 
# closely related documents and avoid a dense spagetti diagram 
# that's difficult to interpret (hat-tip: http://stackoverflow.com/a/16047196/1036500)
JSS_topic_df_dist[ sweep(JSS_topic_df_dist, 1, (apply(JSS_topic_df_dist,1,min) + apply(JSS_topic_df_dist,1,sd) )) > 0 ] <- 0 
```

使用力导向图进行可视化...

```
#### network diagram using Fruchterman & Reingold algorithm (Jockers uses the ForceAtlas2 algorithm which is unique to Gephi)
library(igraph)
g <- as.undirected(graph.adjacency(JSS_topic_df_dist))
layout1 <- layout.fruchterman.reingold(g, niter=500)
plot(g, layout=layout1, edge.curved = TRUE, vertex.size = 1,  vertex.color= "grey", edge.arrow.size = 0.1, vertex.label.dist=0.5, vertex.label = NA) 
```

![在此处输入图像描述](https://i.stack.imgur.com/7aupf.png) 如果你想在 Gephi 中使用 Force Atlas 2 算法，你只需将`R`图形对象导出到一个`graphml`文件，然后在 Gephi 中打开它并将布局设置为 Force Atlas 2：

```
# this line will export from R and make the file 'JSS.graphml' in your working directory ready to open with Gephi
write.graph(g, file="JSS.graphml", format="graphml") 
```

这是使用 Force Atlas 2 算法的 Gephi 图： ![在此处输入图像描述](https://i.stack.imgur.com/q3Mbp.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-14T23:00:20.230

您的数据实际上是文档中包含的词库跨越的多元空间中的距离（某种形式）。诸如此类的相异性数据通常被协调以提供相异性的最佳*k* - d 映射。主坐标分析和非度量多维缩放是两种这样的方法。我建议您绘制将这些方法中的一种或另一种应用于您的数据的结果。我在下面提供了这两个例子。

首先，加载您提供的数据（此阶段没有标签）

```
con <- textConnection("1.75212
0.8812
1.0573
0.7965
3.0344
1.6955
2.0329
1.1983
0.7261
0.9125
")
vec <- scan(con)
close(con) 
```

您实际上拥有的是以下距离矩阵：

```
mat <- matrix(ncol = 5, nrow = 5)
mat[lower.tri(mat)] <- vec
colnames(mat) <- rownames(mat) <-
  c("codeofhammurabi","crete","iraqi","magnacarta","us")

> mat
                codeofhammurabi  crete  iraqi magnacarta us
codeofhammurabi              NA     NA     NA         NA NA
crete                   1.75212     NA     NA         NA NA
iraqi                   0.88120 3.0344     NA         NA NA
magnacarta              1.05730 1.6955 1.1983         NA NA
us                      0.79650 2.0329 0.7261     0.9125 NA 
```

R，一般来说，需要一个类的相异对象`"dist"`。我们可以使用`as.dist(mat)`now 来获取这样的对象，或者我们可以跳过创建`mat`并直接进入`"dist"`对象，如下所示：

```
class(vec) <- "dist"
attr(vec, "Labels") <- c("codeofhammurabi","crete","iraqi","magnacarta","us")
attr(vec, "Size") <- 5
attr(vec, "Diag") <- FALSE
attr(vec, "Upper") <- FALSE

> vec
           codeofhammurabi   crete   iraqi magnacarta
crete              1.75212                           
iraqi              0.88120 3.03440                   
magnacarta         1.05730 1.69550 1.19830           
us                 0.79650 2.03290 0.72610    0.91250 
```

现在我们有了一个正确类型的对象，我们可以调整它。R 有很多包和函数可以做到这一点（参见 CRAN 上的[Multivariate](http://cran.r-project.org/web/views/Multivariate.html)或[Environmetrics](http://cran.r-project.org/web/views/Environmetrics.html)任务视图），但我将使用**vegan**包，因为我对它有点熟悉......

```
require("vegan") 
```

## 主坐标

首先，我说明如何使用**vegan**对您的数据进行主坐标分析。

```
pco <- capscale(vec ~ 1, add = TRUE)
pco

> pco
Call: capscale(formula = vec ~ 1, add = TRUE)

              Inertia Rank
Total           10.42     
Unconstrained   10.42    3
Inertia is squared Unknown distance (euclidified) 

Eigenvalues for unconstrained axes:
 MDS1  MDS2  MDS3 
7.648 1.672 1.098 

Constant added to distances: 0.7667353 
```

到目前为止，第一个 PCO 轴在解释文本之间的差异方面是最重要的，如特征值所示。现在可以通过绘制 PCO 的特征向量来生成排序图，使用`plot`方法

```
plot(pco) 
```

产生

![在此处输入图像描述](https://i.stack.imgur.com/jpAMR.png)

## 非度量多维缩放

非度量多维缩放 (nMDS) 不会尝试在欧几里得空间中找到原始距离的低维表示。相反，它试图在*k*维中找到一个映射，以最好地保持观察之间距离的排序**。**这个问题没有封闭形式的解决方案（与上面应用的 PCO 不同），需要迭代算法来提供解决方案。建议随机开始以确保算法尚未收敛到次优的局部最优解。Vegan 的`metaMDS`功能结合了这些功能以及更多功能。如果您想要普通的旧 nMDS，请参阅`isoMDS`包**MASS**。

```
set.seed(42)
sol <- metaMDS(vec)

> sol

Call:
metaMDS(comm = vec) 

global Multidimensional Scaling using monoMDS

Data:     vec 
Distance: user supplied 

Dimensions: 2 
Stress:     0 
Stress type 1, weak ties
No convergent solutions - best solution after 20 tries
Scaling: centring, PC rotation 
Species: scores missing 
```

有了这个小数据集，我们基本上可以完美地表示差异的等级排序（因此警告，未显示）。可以使用该`plot`方法实现绘图

```
plot(sol, type = "text", display = "sites") 
```

产生

![在此处输入图像描述](https://i.stack.imgur.com/DFD6z.png)

在这两种情况下，样本之间图上的距离是它们相异性的最佳二维近似值。在 PCO 图的情况下，它是实际相异性的 2-d 近似值（需要 3 个维度来完全表示所有相异性），而在 nMDS 图中，图上样本之间的距离反映了等级相异性不是观察之间的实际差异。但本质上，图上的距离代表了计算的差异。靠近的文本最相似，在情节上相距较远的文本彼此最不相似。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-14T23:18:53.653

您可以使用 igraph 制作网络图。Fruchterman-Reingold 布局有一个参数来提供边权重。大于 1 的权重会沿边缘产生更多的“吸引力”，小于 1 的权重则相反。在您的示例中， crete.txt 的距离最短，位于中间，与其他顶点的边缘较小。事实上，它更接近于iraqi.txt。请注意，您必须反转 E(g)$weight 的数据才能获得正确的距离。

```
data1 <- read.table(text="
codeofhammurabi.txt crete.txt      0.570737
codeofhammurabi.txt iraqi.txt      1.13475
codeofhammurabi.txt magnacarta.txt 0.945746
codeofhammurabi.txt us.txt         1.25546
crete.txt iraqi.txt                0.329545
crete.txt magnacarta.txt           0.589786
crete.txt us.txt                   0.491903
iraqi.txt magnacarta.txt           0.834488
iraqi.txt us.txt                   1.37718
magnacarta.txt us.txt              1.09582")
par(mar=c(3,7,3.5,5), las=1)

library(igraph)
g <- graph.data.frame(data1, directed = FALSE)
E(g)$weight <- 1/data1[,3] #inversed, high weights = more attraction along the edges
l <- layout.fruchterman.reingold(g, weights=E(g)$weight)
plot(g, layout=l) 
```

![在此处输入图像描述](https://i.stack.imgur.com/ya8Pg.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T23:02:43.607

如果您想尝试 3D 条形视图，这个 Matlab 片段应该可以工作：

```
% Load data from file 'dist.dat', with values separated by spaces
fid = fopen('dist.dat');
data = textscan(                            ...
        fid,                   '%s%s%f', ...
        'Delimiter',           ' ',      ...
        'MultipleDelimsAsOne', true      ...
);
fclose(fid);

% Find all unique sources
text_bodies = unique(reshape([data{1:2}],[],1));

% Iterate trough the records and complete similarity matrix
N = numel(text_bodies);
similarity = NaN(N,N);
for k = 1:size(data{1},1)
        n1 = find(strcmp(data{1}{k}, text_bodies));
        n2 = find(strcmp(data{2}{k}, text_bodies));

        similarity(n1, n2) = data{3}(k); % Symmetrical part ignored
end;

% Display #D bar chart
bar3(similarity); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T22:58:02.727

这是 Matlab 的潜在解决方案：

您可以将数据排列到正式的 5x5 相似性矩阵**S**中，其中元素**S(i,j)**表示文档**i**和文档**j**之间的相似性（或不相似性） 。假设您的距离度量是一个实际的[metric](http://en.wikipedia.org/wiki/Metric_%28mathematics%29#Definition)，您可以通过[mdscale(S,2)](http://www.mathworks.com/help/stats/mdscale.html)对该矩阵应用*多维缩放*。

此函数将尝试查找数据的 5x2 维度表示，以保留在较高维度中找到的类之间的相似性（或不相似性）。然后，您可以将此数据可视化为 5 个点的散点图。

您也可以尝试使用 mdscale(S,3) 投影到一个 5x3 维矩阵，然后您可以使用 plot3() 对其进行可视化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-14T22:58:10.433

如果您想要表示点之间距离的圆圈，这将在 R 中起作用（我在您的示例中使用了第一个表）：

```
data1 <- read.table(text="
codeofhammurabi.txt crete.txt      0.570737
codeofhammurabi.txt iraqi.txt      1.13475
codeofhammurabi.txt magnacarta.txt 0.945746
codeofhammurabi.txt us.txt         1.25546
crete.txt iraqi.txt                0.329545
crete.txt magnacarta.txt           0.589786
crete.txt us.txt                   0.491903
iraqi.txt magnacarta.txt           0.834488
iraqi.txt us.txt                   1.37718
magnacarta.txt us.txt              1.09582")
par(mar=c(3,7,3.5,5), las=1)

symbols(data1[,1],data1[,2], circles=data1[,3], inches=0.55, bg="lightblue", xaxt="n", yaxt="n", ylab="")
axis(1, at=data1[,1],labels=data1[,1])
axis(2, at=data1[,2],labels=data1[,2])
text(data1[,1], data1[,2], round(data1[,3],2), cex=0.9) 
```

![在此处输入图像描述](https://i.stack.imgur.com/zGMmF.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-14T22:19:06.320

您是否在进行所有成对比较？取决于您如何计算距离（相似度），我不确定是否可以制作这样的散点图。因此，当您只考虑 3 个文本文件时，您的散点图很容易制作（边长相等的三角形）。但是当您添加第四个点时，您可能无法将其放置在其与现有 3 个点的距离满足所有约束的位置。

但是，如果你能做到这一点，那么你有一个解决方案，只需不断地添加新点......我认为......或者，如果你不需要散点图上的距离是精确的，你可以简单地做一个网并标记距离。

# php - PHP openssl 不验证签名字符串，尽管它看起来像原始字符串

> ID：16004848
> 
> 赞同：0
> 
> 时间：2013-04-14T21:57:25.013
> 
> 标签：php, openssl

应该是编码问题。

```
$sign2 = (stripslashes($_POST['sign']));
$sign2 = mb_convert_encoding($sign2, "auto"); 
```

上面的代码是试错法的结果，它使 $sign2 看起来像 $sign ，它是来自：

```
openssl_sign($content, $sign, $key_pr); 
```

但是当我输入 $sign2 而不是 $sign 进行验证时，openssl_verify() 返回 false - 尽管它们都是字符串类型，长度为 128 并且看起来相同。

> $sign: KOóÂ^0Å ¶Ô®þó :æ aêÌCæÃñÃ·”äþÊÝÌ7=ËæK-ÎËÚ¦iÛtËš½Då^Ðv¶:Å*^'¬~8êšq
> 
> $sign2: KOóÂ^0Å ¶Ô®þó :æ aêÌCæÃñÃ·”äþÊÝÌ7=ËæK-ÎËÚ¦iÛtËš½Då^Ðv¶:Å*^'¬~8êšq
> 
> 验证：不好

# apache - 使用 .htaccess 删除 iframe url 部分

> ID：16004850
> 
> 赞同：0
> 
> 时间：2013-04-14T21:57:29.307
> 
> 标签：apache, .htaccess, mod-rewrite

如何删除在我的网站上的每个网页上生成的 url 部分，其中我有 livecore iframe 模块，看起来像[http://mysite.com/livescore/football#incore_ifheight_xdc_17343](http://mysite.com/livescore/football#inscore_ifheight_xdc_17343)？该页面的真实 url 是[http://mysite.com/livescore/football](http://mysite.com/livescore/football)，但是当使用 livescore iframe 打开网页时，这部分 #inscore_ifheight_xdc_17343 总是自动生成并添加到 url。

如果有人可以为我生成 .htaccess mod_rewrite 重写规则，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:17:45.167

[片段标识符](http://en.wikipedia.org/wiki/Fragment_identifier)不是发送到服务器的 URL 的一部分。因此，您不能使用 .htaccess 规则将其删除。

防止这种情况的唯一方法是首先不创建它。

# asp.net - IE 10中的PageMethods不发送参数，导致错误：无效的Web服务调用，参数缺失值

> ID：16004853
> 
> 赞同：0
> 
> 时间：2013-04-14T21:57:45.297
> 
> 标签：asp.net, localhost, internet-explorer-10, pagemethods

**以下场景适用于除 IE10 之外的所有常见浏览器，但没有兼容性视图！**

我在我的应用程序中使用 ASP.NET PageMethods，如下所示：

```
 [System.Web.Services.WebMethod]
    public static string TestItWM(string param1)
    {
        return "This is : " + param1;
    } 
```

相关的 JavaScript 是：

```
 function TestIt() {
        var param1 = $("#testWebMethod").val();
        PageMethods.TestItWM(param1, OnSucceeded, OnFailed);
    }
    function OnSucceeded(result, userContext, methodName) {
        alert(result);
    }
    function OnFailed(error, userContext, methodName) {
        alert("error:" + error._message);
    } 
```

**上述示例在 Chrome26、FireFox16、IE10-CompatibilityView 上运行良好，但不适用于 IE10！。使用Fiddler2我可以在所有浏览器中看到，请求发送了参数，除了IE10，没有发送到web方法！**

注意：该应用程序在我的机器的 IIS7.5/Windows7 本地托管，带有示例 URL：

```
http://localhost/MyApp1/Test.aspx 
```

感谢您的帮助！

* * *

这似乎是 Windows 7 上 IE10 的 IE10 或 .NET 识别中的错误：

如前所述，以管理员身份运行 IE10 可以解决问题。

为了为客户解决这个问题，我必须添加以下元：

```
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7" /> 
```

强制 IE 工作为 9 max！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-04T14:48:44.707

这是一个已知问题。并且自一年多前以各种形式被报道。

MS Connect 上的错误票证已全部关闭。但是，在 jQuery 上有一张错误票： http: [//bugs.jquery.com/ticket/12790](http://bugs.jquery.com/ticket/12790)，它显然已关闭，但直到上个月仍然有效。

根据该线程中的[http://bugs.jquery.com/ticket/12790#comment:26](http://bugs.jquery.com/ticket/12790#comment:26)，据报道某些加载项会产生问题（除其他原因外）。我的 IE10/Win8 上的下载管理器有这个问题。也许您可以检查一下您的 IE 上安装的任何 DM/DAP 插件是否会导致问题。

在 IE-normal 和 IE-runas-admin 之间进行“开发者工具 > 网络 > 开始捕获”比较。这可以帮助您发现问题。

**顺便说一句**：您可以使用相同的设置在 SO 上投票和发帖吗？如果是，那么它可能不是真正的 IE10 问题。

# python - 如何创建一个带有多个参数的构造函数？

> ID：16004857
> 
> 赞同：0
> 
> 时间：2013-04-14T21:58:07.007
> 
> 标签：python, function, variadic-functions

我有一个特定的类，我在设置`__init__`构造函数时遇到了困难。我需要它接受零个或多个字符串作为参数，每个字符串都给出一个城市名称和州缩写，并指示美国城市之旅的目的地。

例如：

```
Tour("New York, NY", "Lansing, MI", "Los Angeles, CA") 
```

代表从纽约市开始，前往兰辛，并在洛杉矶结束的旅行。

任何想法如何使用 python 3.3 进行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:59:20.027

像这样：

```
class Tour:
    def __init__(self, *cities):
        # cities is a tuple of arguments, do what you want with it 
```

你打电话时

```
Tour("New York, NY", "Lansing, MI", "Los Angeles, CA") 
```

`cities`in`__init__`将设置为`("New York, NY", "Lansing, MI", "Los Angeles, CA")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T08:57:26.323

> 这可能会有所帮助...

**例子**

```
class Bar:
   def __init__ (self, arg1=None, arg2=None, ... argN=None):

class NEW (Bar):    
    def __init__ (self, my_new_arg=None, ??? )
       self.new_arg = my_new_arg
       Bar.__init__(self, ??? ) 
```

# java - 莫尔斯电码转英文？

> ID：16004858
> 
> 赞同：-3
> 
> 时间：2013-04-14T21:58:12.893
> 
> 标签：java, string, split, morse-code

我正在尝试编写将英语翻译成摩尔斯电码的东西，反之亦然。我让英语到莫尔斯语运行良好，但我很难以另一种方式转换它。我的意思是`|`用作单词之间的空格，所以`- --- | -... .`意思是“成为”。谁能告诉我我的代码部分有什么问题`case:1`？

```
public class Project {
    public static void main(String[] args)
    {
        String[] morse = { ".- ", "-... ", "-.-. ", "-.. ", ". ", "..-. ", "--. ", ".... ", ".. ",

        ".--- ", "-.- ", ".-.. ", "-- ", "-. ", "--- ", ".--. ", "--.- ", ".-. ", "... ", "- ", "..- ",

        "...- ", ".-- ", "-..- ", "-.-- ", "--.. ", "|" };
        String[] alphabet = { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", " " };

        int a;
        a = Input.getInt("Enter 1 for Morse to English or enter 2 for English to Morse.");

        switch (a)
        {
        case 2:
        {
            String toMorse = new String();
            toMorse = Input.getString("Enter a sentence.");
            toMorse = toMorse.toUpperCase();
            for (int i = 0; i < toMorse.length(); i++)
            {
                char x = toMorse.charAt(i);
                if (x == ' ') System.out.print(" | ");
                else System.out.print(morse[x - 'A']);
            }

            break;
        }

        case 1:
        {
            String toEnglish = new String();
            toEnglish = Input.getString("Enter your Morse code.");

            String[] parts = toEnglish.split("|");
            for (int x = 0; x < parts.length; x++)
            {
                if (parts.equals(morse[x])) System.out.println(alphabet[x]);
            }

            break;
        }

        default:
        {
            System.out.println("Invalid Response");
        }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T21:59:55.900

*   [split](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)使用正则表达式命令，`|`是正则表达式中的特殊运算符。而不是`|`，你想要`\\|`。

    改变

    `String[] parts = toEnglish.split("|");`

    至

    `String[] parts = toEnglish.split("\\|");`

*   当你这样做时：

    `if (parts.equals(morse[x]))`那么您正在比较对字符串的*引用*，这不是您想要做的..

    你可能想做：

    `if (parts[x].equals(morse[x]))`

    现在，`parts[x]`包含一个字符串。我建议您阅读[String#split](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:01:21.860

你可能是有意义`continue`的，而不是`break`

*   `continue`开始外循环的下一次迭代
*   `break`跳出循环，在for循环结束后执行第一行代码。

# php - 添加一个文本区域以形成 symfony2

> ID：16004860
> 
> 赞同：1
> 
> 时间：2013-04-14T21:58:53.973
> 
> 标签：php, symfony

我有一个与实体相关的表格。我想在表单中添加一个文本区域编号并获取输入的值，因为我知道我在实体中没有具有此值的属性，因此也`getNumber()`没有 setNumber。我也希望它与表格一起提交。

我怎样才能做到这一点？

我找到了[这个链接](https://stackoverflow.com/questions/12384414/how-to-add-additional-non-entity-fields-to-entity-form-in-symfony2)并尝试了

```
->add('From', 'text', array(
                "property_path" => false,
            )); 
```

但是我现在想知道如何获得这个值？可以和表格一起提交吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T00:13:59.203

该值将与表单一起提交。因此，您可以直接在“请求”对象中检索它。

在你的情况下，你会做

```
$this->get('request')->request->get('From'); 
```

有关更多信息，请参阅[关于没有类的表单的食谱](http://symfony.com/doc/current/book/forms.html#using-a-form-without-a-class)。

* * *

您还可以通过在函数中使用[Request](http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/Request.html)类型的参数来检索请求对象：

```
use Symfony\Component\HttpFoundation\Request;

public function myFunction(Request $request /*, ... */){
    //...

    $from = $request->get('From');

    //...
} 
```

# actionscript-3 - Optimizing a double for loop

> ID：16004863
> 
> 赞同：0
> 
> 时间：2013-04-14T21:59:12.620
> 
> 标签：actionscript-3, for-loop, foreach

Hey guys so i am creating a game and when i test it in Adobe Scout is states that this function is causing it to go over its budget by 600% checkMainGunMissleHitZapper();

So i was wondering if their was a way to optimize it. It is a double for loop since the missle is an array and the enemy is also handled by an array.

Whenever the hittest takes place between the 2 objects the screen just completely pauses and slows down the performance majorly on a mobile device.

Here is how i set up the loops:

```
private function checkMainGunMissleHitZapper():void 
    {
        //loop through al current missles
        for (var i:int = 0; i < aMainGunMissleArray.length; i++)
        {
            //get current missle in loop
            var currenMainMissle:mcMainGunMissle = aMainGunMissleArray[i];

            //loop through all our enemies
            for (var j:int = 0; j < aEnemyZapperArray.length; j++)
            {
                //get current enemy in j loop
                var currentZapper:mcEnemyZapper = aEnemyZapperArray[j];

                //test if current missle is hitting current enemy
                if (currenMainMissle.hitTestObject(currentZapper))
                {
                    //create an explosion

                    //create a new explosion instance/movieclip
                    var newZapperExplosion:mcEnemyZapperExplosion = new mcEnemyZapperExplosion()
                    //add our explosion to the stage
                    stage.addChild(newZapperExplosion)
                    //position explosion to enemy
                    newZapperExplosion.x = currentZapper.x
                    newZapperExplosion.y = currentZapper.y

                    //remove missle
                    currenMainMissle.destroyMainGunMissle()
                    //remove missle from missle array
                    aMainGunMissleArray.splice(i, 1);

                    //remove enemy on stage
                    currentZapper.destroyEnemyZapper()
                    //remove enemy from array
                    aEnemyZapperArray.splice(j, 1);

                    nScore += 20;
                    updateScoreText();

                }

            }
        }
    } 
```

Some forums i read were saying that this would optimize the code:

```
for (int k = 0; k < N * N; ++k) { int i = k / N; int j = k % N; } 
```

But i wouldnt even know where to begin with that. kind of past my as3 skill level.

But can you see any way to optimize these for loops?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:23:09.283

I think the warning is due to the hitTestObject call within the inner loop:

```
if (currenMainMissle.hitTestObject(currentZapper)) 
```

hitTestObject(...) is a relatively slow process, so if you are looping through many hit tests, it can take a long time - hence the warning from Scout.

Optimising the loops (such as in the way mentioned in forums after your code) will make a negligible difference - 99% of the time spent in the loop will be due to hitTestObject.

The 'trick' is to reduce the number of hitTestObject calls you make - such as checking whether x and y values of the 2 objects are within a certain range - if theyre not, no need to check for a collision.

Or when there is a collision (and missile is removed), no need to continue looping through further checks, so after this line:

```
updateScoreText(); 
```

Add this line:

```
break; 
```

This will cause inner loop to end (and next outer loop to begin)

Optimising collision detection is a vast subject and there are many techniques so i cant give you a specific solution for your case without knowing the details of your game - googling "actionscript collision detection" should provide a few tutorials.

# jquery - jquery ajax 实际是如何工作的

> ID：16004867
> 
> 赞同：2
> 
> 时间：2013-04-14T21:59:56.130
> 
> 标签：jquery

假设我有这样的表格（取自一本关于 jquery 的书）：

```
<body>
<form>
<label>Enter your Name</label>
<input type="text" name="uname" class="uname"/> <br/>
<input type="submit" id="submit"/>
</form>
<div id="message"></div>
</body> 
```

和这样的ajax函数：

```
$(document).ready(function() {
   $('#submit').click(function () {
   var name = $('.uname').val();
   var data = 'uname=' + name;
      $.ajax({
         type:"POST",
         url:"welcome.php",
         data: data,
         success: function (html) {
            $('#message').html(html);
         }
      });
      return false;
   });
}); 
```

脚本文件如下所示：

```
<?php
$name = $_POST['uname'];
echo "Welcome ". $name;
?> 
```

它会起作用，但这是我无法理解的。如果welcome.php 脚本从POST 数组中获取$name 的值，为什么它需要通过ajax 请求将数据发送给它？POST 数组肯定已经包含该信息？

另外，我的理解是，ajax 请求是键/值对的形式，但数据以 uname=name 的形式发送，但键/值对通常没有等号。

这里发生了什么 - 它有效，但对我来说没有意义，我讨厌只是在我死记硬背中学习的代码中打孔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:09:06.423

jQuery AJAX 异步工作。表单没有被发布，因为您可以看到它没有在表单标签上设置操作或方法属性。

jQuery 拦截按钮单击并设置一个新的异步请求，然后将数据添加到该请求并将其发布到服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T12:37:40.943

问题在于您的代码
**var data = 'uname=' + name;**
使用
**var data = '{uname:' + name + '}';**
因为它是一个 post 方法

# php - PHP 在特定时间后执行操作

> ID：16004868
> 
> 赞同：2
> 
> 时间：2013-04-14T22:00:19.963
> 
> 标签：php, time, cron

我已经有这个问题很长时间了。我想在PHP 脚本的特定时间后*做某事；*例如，假设用户在我的网站上注册，但除非他点击提供的激活链接，否则该帐户将在 45 分钟内被删除。我该如何做到这一点？我曾想过编写一个 PHP 保护脚本，它会检查数据库中是否有任何过期条目，然后删除任何条目，并设置一个 cron，例如每 3 分钟一次。这是要走的路吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T22:49:15.100

不要将所有此类问题都视为必须在“应该发生”的特定时间*执行代码。*我将“应该发生”放在引号中，因为不必*发生某些事情*。如果您认为帐户在 45 分钟内未激活是无效的，那么这可以通过逻辑完美表达，而无需在 45 分钟后*执行*任何特定操作。无论您在哪里检查有效的尚未激活的帐户，您都可以检查*“未激活且已在最近 45 分钟内创建”*。如果帐户不满足这两个条件，则该帐户无效。

您仍然可以在闲暇时使用 cron 作业来清理过时的数据，但这可能一天左右发生一次。不一定要在*45 分钟之后*。

# c# - 双击文件将“调试”作为第二个参数？

> ID：16004869
> 
> 赞同：0
> 
> 时间：2013-04-14T22:00:25.100
> 
> 标签：c#, arguments

当我双击某个文件时，启动的应用程序的参数根据 Process Explorer：

"C:\Program Files (x86)\MiKeSoft\PCG Tools\PcgTools.exe" 调试 D:\Muziek\Korg\Workstations\Kronos\Sounds and Templates_Commercial\KRS\KRS-03\KRS-03.PCG

为什么有调试作为第二个参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:10:32.657

使用描述应执行的命令行的字符串在注册表中设置文件关联。`%1`除了文件名的占位符之外，该字符串还可以包含任意附加参数。

如果字符串类似于`PcgTools.exe debug %1`您将获得与您观察到的命令行类似的命令行。

正如 Raymond 所指出的，如果您没有`%1`用引号引起来，即使文件名包含空格，shell 也不会插入它们。然后，默认命令行解析将该单个文件名视为由空格分隔的多个参数，因此您通常希望使用`"%1"`.

在您的情况下`"`，文件名周围没有，所以我猜您的程序使用`%1`的是非标准命令行解析。一些（大多数是较旧的）程序的行为是这样的，但我建议您自己的程序不要这样做。为它们使用`"%1"`和标准解析。

# ios - UIImageView setImage 当 UIScrollView 滚动时

> ID：16004874
> 
> 赞同：0
> 
> 时间：2013-04-14T22:00:42.820
> 
> 标签：ios, objective-c, uiscrollview, uiimageview

我正在尝试在 UIScrollView 滚动时设置 UIImageView 的图像属性。看起来图像设置得很好，但只有在滚动完成后才会显示在图像视图中。

不是真的需要，但在这里值得的是我正在使用的代码。在图像数据完成下载并创建图像对象后，此代码在主线程上调用。

```
[imageView setImage:image]; 
```

有没有办法设置图像属性并在滚动仍在进行时显示图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:12:28.343

在滚动视图滚动时运行任何代码的唯一机会是 UIScrollView 委托的`scrollViewDidScroll:`. 所以你必须实现它并使用它来检查是否有新的图像值并设置图像如果有。

# javascript - 如何使列表菜单“可折叠”？

> ID：16004875
> 
> 赞同：3
> 
> 时间：2013-04-14T22:00:43.510
> 
> 标签：javascript, html, joomla, menu, collapsable

我有一个包含 4 个主要项目的菜单，每个项目有 3 到 5 个子项目。

```
<ul id="navigation">
    <li><a>Diagonóstico</a>

    </li>
    <li class="sub"><a href="javascript:void(0);" class="sub_di1"> › Grátis (na compra de qualquer serviço) </a>

    </li>
    <li><a>Hardware</a> 
    </li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha1"> › Instalação/Configuração de Componentes</a> 
```

请检查**[完整的代码](http://jsfiddle.net/fDYMz/2)**。

正如您在 jsFiddle 中看到的那样，所有菜单项在单击时都会在另一个 div 中显示一些文本。我把它放在那里以防需要进一步的 javascript 帮助。我想要的是折叠所有 .sub 菜单，当我将**鼠标悬停**在其中一个主要菜单上时，它会展开相应的 .sub 项目，以便用户可以看到。谢谢！

编辑：

我设法在其中一个评论中获得了一个不错的教程，并想出了**[这个](http://jsfiddle.net/fDYMz/2)**！

我现在需要的是一种从相应的 .main 菜单中显示所有 .sub 菜单的方法，而不仅仅是第一个菜单。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T01:31:59.050

仅使用 HTML 和 CSS。

HTML

```
<ul id="menu">
    <li><a href="SOME_LINK">Some menu without sub-menu</a></li>
    <li><a href="SOME_LINK2">Some menu without sub-menu 2 </a></li>
    <li>Some menu WITH sub-menu
        <ul>
            <li><a href="SOME_LINK">Some sub-menu</a></li>
            <li><a href="SOME_LINK">Some sub-menu 2</a></li>
        </ul>
    </li>
    <li><a href="SOME_LINK3">Some menu without sub-menu 3</a></li>
</ul> 
```

CSS

```
ul>li>ul{display:none}
ul>li:hover>ul, ul>li:selected>ul{display:block} 
```

JS (jQuery) 打开所有子菜单

```
$('#menu li>ul').parent().addClass('selected'); 
```

没有 Jquery 的 JS

```
var menus = document.getElementById('menu').getElementsByTagName('li') 
for(var row in menus){
     if(typeof menus[row] == 'object' && menus[row].getElementsByTagName('ul').length > 0){
         menus[row].getElementsByTagName('ul')[0].className = 'selected';
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-18T08:45:14.000

我的解决方案类似于问题编辑中提到的解决方案，但是单击时已打开的列表项不会重新打开：http: [//jsfiddle.net/g5oc0uoq/](http://jsfiddle.net/g5oc0uoq/)

```
$('.content').hide();
$('.listelement').on('click', function(){
  if(!($(this).children('.content').is(':visible'))){
    $('.content').slideUp();
    $(this).children('.content').slideDown();
  } else {
    $('.content').slideUp();
  }
}); 
```

如果您遇到性能问题，可以使用 show() 和 hide() 代替 slideUp() 和 slideDown()。

# java - 我需要创建自己的 hash 和 equal 方法吗？

> ID：16004881
> 
> 赞同：-2
> 
> 时间：2013-04-14T22:01:39.763
> 
> 标签：java, hash, key

```
class EventManager{
    public String unique_ID;
    public List<Object> infoList;

    public EventManager(String ID, List<Object> infoList){
        this.unique_ID = ID;
        this.infoList = infoList;
    }
} 
```

如果这个类使用映射键，我是否需要实现自己的 hashcode 和 equal() 方法？

如果需要，只需散列 unique_ID 就足够了？谢谢。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:12:59.323

如果您不定义自己的哈希码，我相信它会使用对象的地址。因此，如果您创建两个具有相同 id 的实例，它们将不会散列到同一个存储桶。您可能想使用 id 来表示相等。作为旁注，请确保不要在相等或散列中使用列表，除非您可以保证不变性。

[默认 .equals 和 .hashCode 将如何适用于我的课程？](https://stackoverflow.com/questions/4178997/how-default-equals-and-hashcode-will-work-for-my-objects)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:04:17.077

除非您想覆盖`hashCode`and equals 的值以赋予它们不同的`behaviour`.

如果没有，您可以只使用默认值，并且每个不同的对象将有不同`hashCode`的 JVM 或多或少地保证。

您只需要覆盖`equals`，例如，如果您希望能够说两个对象在某些条件满足时是相同的（例如，只是`unique_ID`相同）。

如果你*做*override `equals`，那么你*必须*override `hashCode`，以尊重 Object 契约：

> Object 类的 equals 方法实现了对象上最有区别的可能等价关系；也就是说，对于任何非空引用值 x 和 y，当且仅当 x 和 y 引用同一个对象（x == y 的值为 true）时，此方法才返回 true。
> 
> 请注意，每当重写该方法时，通常都需要重写 hashCode 方法，以维护 hashCode 方法的一般约定，即相等的对象必须具有相等的哈希码。

[http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals(java.lang.Object)](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals(java.lang.Object))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T22:08:51.580

请理解，如果您不覆盖 equals，那么只有当它们实际上是 SAME 实例（即，相等的地址）时，两个实例才会相等。如果您希望包含相等字段的实例被视为相等，您需要实现自己的版本。

如果您覆盖 equal，那么您也必须覆盖 hashcode，以确保两个相等的实例返回相同的 hashcode。不这样做将导致 HashMap 等失败。

请注意，哈希码始终返回 6 或其他一些固定值是完全合法的（尽管很愚蠢）。它**不能**做的是为相等的实例返回两个不同的哈希码值。

# xml - XSLT 1.0 按每个元素内的属性值对节点进行分组

> ID：16004886
> 
> 赞同：0
> 
> 时间：2013-04-14T22:02:41.267
> 
> 标签：xml, xslt, xslt-1.0

> 我有这样的 XML

```
<root>
  <Users groupid="1">
    <User id="person1" name="ABC"  parentid="person7"/>
    <User id="person2" name="xyz"  parentid="person1"/>
    <User id="person3" name="LMN"  parentid="bac3"/>
    <User id="person4" name="PQR"  parentid="person2"/>
    <User id="person5" name="PQR" parentid="person1"/>
    <User id="person6" name="PQR" parentid="person7"/>
  </Users>
  <Users groupid="3">
    <User id="person7" name="ABC"  parentid="person11"/>
    <User id="person8" name="xyz"  parentid="person1"/>
    <User id="person3" name="LMN"  parentid="bac3"/>
    <User id="person4" name="PQR"  parentid="person2"/>
    <User id="person5" name="PQR" parentid="person1"/>
    <User id="person6" name="PQR" parentid="person7"/>
  </Users>
</root> 
```

> 我需要使用**xslt 1.0**将其转换为=>

```
<Users groupid="1">
  <User id="person1" name="ABC"  parentid="person7" haschildinGroup="yes"/>
      <User id="person2" name="xyz"  parentid="person1" haschildinGroup="yes"/>
          <User id="person4" name="PQR"  parentid="person2" haschildinGroup="no"/>
      <User id="person5" name="PQR" parentid="person1" haschildinGroup="no"/>
  <User id="person3" name="LMN"  parentid="bac3" haschildinGroup="no"/> 
  <User id="person6" name="PQR" parentid="person7" haschildinGroup="no"/>
</Users>
<Users groupid="3">
  <User id="person7" name="ABC"  parentid="person11" haschildinGroup="yes"/>
      <User id="person6" name="PQR" parentid="person7" haschildinGroup="no"/>
  <User id="person8" name="xyz"  parentid="person1" haschildinGroup="no"/>
  <User id="person3" name="LMN"  parentid="bac3" haschildinGroup="yes"/>
      <User id="person5" name="PQR" parentid="person3"  haschildinGroup="no"/>
  <User id="person4" name="PQR"  parentid="person2"  haschildinGroup="no"/>
</Users> 
```

> **指南：** 1）我需要根据共享 parentid 及以上的人对值进行分组输出 xml 解释更多
> 
> 2) 需要将 xml 缩进类似父子关系的缩进（在第一个添加额外的空格）用于 HTML 视图
> 
> 我尝试过这样的示例，但其中的**关键**在整个 XML 上而不是在当前节点内

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html" indent="no"/>

      <xsl:key name="groups" match="User" use="@parentid" />
      <xsl:variable name="Space">&amp;nbsp;</xsl:variable>
      <xsl:variable name="addSpace" select="concat($Space,$Space)"/>

      <xsl:template match="/">
        <html>
          <table width="100%" cellspacing="0" cellpadding="0" border="0">
            <xsl:for-each select="root/Users/User[generate-id(.)=generate-id(key('groups',@parentid)[1])]">
              <xsl:call-template name="selectusers"></xsl:call-template>
            </xsl:for-each>
          </table>
        </html>
      </xsl:template>

      <xsl:template name="selectusers">
          <xsl:for-each select="key('groups', @parentid)">
            <tr>
               <xsl:value-of select="$addSpace" disable-output-escaping="yes"/><!--Works for only 1st Level need to add If-->
              <td>

                <xsl:value-of select="@id"/>
              </td>
              <td>
                <!--HasChild =:(-->
              </td>
            </tr>
          </xsl:for-each>
      </xsl:template>

    </xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T06:23:12.380

您的 XSLT 是为生成 HTML 而不是您所描述的所需输出而编写的，但我会假设您想要的实际上是您试图生成的 HTML。如果是这样，应该这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" indent="no"/>

  <xsl:key name="groups" match="User" use="concat(../@groupid, '+', @parentid)" />
  <xsl:variable name="Space">&#xA0;</xsl:variable>
  <xsl:variable name="addSpace" select="concat($Space,$Space)"/>

  <xsl:template match="/">
    <html>
      <table width="100%" cellspacing="0" cellpadding="0" border="0">
        <tr>
          <th>ID</th>
          <th>Has Children</th>
        </tr>
        <xsl:apply-templates 
              select="root/Users/User[not(@parentid = ../User/@id)]" />
      </table>
    </html>
  </xsl:template>

  <xsl:template match="User">
    <xsl:variable name="children"
                  select="key('groups', concat(../@groupid, '+', @id))" />

    <tr>
      <td>
        <xsl:apply-templates select="." mode="spacing" />
        <xsl:value-of select="@id"/>
      </td>
      <td>
        <xsl:value-of select="substring('No Yes', 1 + 3 * boolean($children), 3)"/>
      </td>
    </tr>
    <xsl:apply-templates select="$children" />
  </xsl:template>

  <xsl:template match="User" mode="spacing">
    <xsl:value-of select="$addSpace" />
    <xsl:apply-templates 
          select="../User[@id = current()/@parentid]" mode="spacing" />
  </xsl:template>
</xsl:stylesheet> 
```

当这在您的示例输入上运行时，结果是：

```
<html>
  <table width="100%" cellspacing="0" cellpadding="0" border="0">
    <tr>
      <th>ID</th>
      <th>Has Children</th>
    </tr>
    <tr>
      <td>  person1</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>    person2</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>      person4</td>
      <td>No </td>
    </tr>
    <tr>
      <td>    person5</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person3</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person6</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person7</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>    person6</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person8</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person3</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person4</td>
      <td>No </td>
    </tr>
    <tr>
      <td>  person5</td>
      <td>No </td>
    </tr>
  </table>
</html> 
```

# c# - 将 C# 参数中的多个参数视为包含空格的文件夹/名称的一个参数？

> ID：16004888
> 
> 赞同：0
> 
> 时间：2013-04-14T22:03:01.987
> 
> 标签：c#, arguments

当我双击某个文件时，启动的应用程序的参数根据 Process Explorer：

"C:\Program Files (x86)\MiKeSoft\PCG Tools\PcgTools.exe" 调试 D:\Muziek\Korg\Workstations\Kronos\Sounds and Templates_Commercial\KRS\KRS-03\KRS-03.PCG

有没有一种简单的方法可以将包含文件名（调试后）的参数视为一个字符串（无需手动解析/组合/提取所有可能性）？

原因：可以有更多文件（其中有或没有空格）。

我得到的论点是：

```
argument 0: "C:\Program Files (x86)\MiKeSoft\PCG Tools\PcgTools.exe"
argument 1: debug
argument 2: D:\Muziek\Korg\Workstations\Kronos\Sounds
argument 3: and 
argument 4: Templates\_Commercial\KRS\KRS-03\KRS-03.PCG 
```

我想要的是：

```
argument 0: "C:\Program Files (x86)\MiKeSoft\PCG Tools\PcgTools.exe"
argument 1: debug
argument 2: "D:\Muziek\Korg\Workstations\Kronos\Sounds and Templates\_Commercial\KRS\KRS-03\KRS-03.PCG" 
```

即我想要自动 " 围绕字符串并将它们组合在一起。在这种情况下很容易，但是当有多个文件时它可能会很棘手。

注意：这不是关于 Debug 参数的问题（请参阅[双击文件将“debug”作为第二个参数？](https://stackoverflow.com/questions/16004869/double-clicking-a-file-gives-debug-as-second-parameter)）尽管使用了相同的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:58:19.313

您的文件类型注册没有在参数周围加上引号。如果要引用参数，则必须提供引号。Windows 只是按照您提供的说明进行操作。

```
"C:\Program Files (x86)\MiKeSoft\PCG Tools\PcgTools.exe" debug "%1" 
```

请注意 %1 周围的引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:29:45.010

看看这个例子：

```
C:\development\abkcmd\abkcmd\bin\Debug>abkcmd.exe one "two parms" 3
Number of command line parameters = 3
Arg[0] = [one]
Arg[1] = [two parms]
Arg[2] = [3]

C:\development\abkcmd\abkcmd\bin\Debug>abkcmd.exe one two parms 3
Number of command line parameters = 4
Arg[0] = [one]
Arg[1] = [two]
Arg[2] = [parms]
Arg[3] = [3]

C:\development\abkcmd\abkcmd\bin\Debug>abkcmd.exe one two 'parms' 3
Number of command line parameters = 4
Arg[0] = [one]
Arg[1] = [two]
Arg[2] = ['parms']
Arg[3] = [3] 
```

您可以使用以下代码执行此操作：

```
Console.WriteLine("Number of command line parameters = {0}", args.Length);
        for (int i = 0; i < args.Length; i++)
        {
            Console.WriteLine("Arg[{0}] = [{1}]", i, args[i]);
        }

        Console.ReadLine(); 
```

# visual-studio-2010 - 方法算作关联吗？

> ID：16004890
> 
> 赞同：1
> 
> 时间：2013-04-14T22:03:11.087
> 
> 标签：visual-studio-2010, class, uml, class-diagram

考虑到这个类图：

如果我没记错的话，两者之间有一个“有一个”（聚合），因为图书馆实际上可以持有一本书实例的句柄。 ![在此处输入图像描述](https://i.stack.imgur.com/4RqHj.jpg)

现在，这个图表怎么样？

![在此处输入图像描述](https://i.stack.imgur.com/WmsCp.png)

两者之间有关联吗？LibraryService 永远不会在其中存储 Book 的实例，但它的一个方法返回一个书籍数组。这两个类之间会有什么关系？

在相关说明中，Visual Studio 似乎不允许您在生成类图时将方法链接到对象。这就是导致我提出这个问题的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:34:26.440

事实上，你可以在这里建立一个关系：一个依赖关系，它是一个匿名的虚线箭头。但正如观察者所说，这并不值得，因为您已经拥有方法定义中的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T23:11:59.763

> 两者之间有关联吗？LibraryService 永远不会在其中存储 Book 的实例

那么答案是否定的。关系表示两个类之间的某种合作，例如通过交换消息或查询状态（Seemann 2006, p. 53, "UML2"）。在这种情况下，两人不合作。可能，您的 LibraryService 只为图书馆提供服务，然后与“书”建立连接。

> 但其中一个方法返回一组书籍。

您已经在方法列表中传达了该信息 - 这很好:)

如果你想要一个关系，你必须能够向它添加语义，在这种情况下这只是多余的，但不太容易理解。

# android - 为什么 Activity 的构造函数中的 getApplicationContext() 会抛出空指针异常？

> ID：16004891
> 
> 赞同：8
> 
> 时间：2013-04-14T22:03:12.760
> 
> 标签：android, constructor, nullpointerexception, android-context

在花了一些时间寻找错误之后，事实证明：

```
public class MainActivity extends BaseActivity { // BaseActivity extends Activity

    public MainActivity() {
        super();
        getApplicationContext(); // NPE here
    }
} 
```

为什么 ？这是在哪里记录的？
弗罗约

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-06T02:17:18.920

只是为了感受一下发生了什么。*Activity* [扩展了 ContextThemeWrapper](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.2_r1/android/app/Activity.java?av=f#642)，后者扩展了*Activity*继承的*ContextWrapper*。*ContextWrapper*[将其实现为](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.2_r1/android/content/ContextWrapper.java#ContextWrapper.getApplicationContext%28%29)：*`getApplicationContext()`*

 **```
@Override
public Context  getApplicationContext() {
    return mBase.getApplicationContext(); // mBase is a Context
} 
```

的[唯一公共构造函数](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.2_r1/android/content/ContextWrapper.java#56)是`ContextWrapper`：

```
 public  ContextWrapper(Context base) {
     mBase = base;
 } 
```

在`ContextThemeWrapper` [我们有](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.2_r1/android/view/ContextThemeWrapper.java#37)：

```
 public  ContextThemeWrapper() {
     super(null);
 } 
```

并且由于*Activity*没有定义显式构造函数，因此调用了上面的构造函数 -`mBase == null`在 Activity 的构造函数中 - 繁荣。

[来自的链接`4.2.2_r1`]

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-14T22:11:24.443

等待结束`onCreate`调用此方法。

```
public class MainActivity extends BaseActivity { 

    public onCreate(Bundle savedInstanceState) {
        super(savedInstanceState);
        getApplicationContext(); //activity has a context now
    }
} 
```**

# asp.net-mvc-4 - 子网格数据未在 jqGrid 4.4.5 中显示

> ID：16004892
> 
> 赞同：0
> 
> 时间：2013-04-14T22:03:28.433
> 
> 标签：asp.net-mvc-4, jqgrid

我将 jqGrid 4.4.5 与 jQuery 1.9.1 一起使用，并且在服务器端，我使用的是 ASP.NET MVC 4（尽管我认为这不是问题的一部分）。

我有一个简单的 jqGrid 工作正常，我正在尝试向它添加一个简单的子网格。我已经配置了子网格，将其连接回服务器端的单独控制器，一切似乎都运行良好，直到我需要显示子网格数据为止。

初始网格加载调用我的控制器的主要数据方法，获取 json 并显示行。单击 + 号会展开一行，从而调用控制器的辅助数据方法。辅助方法将子网格数据作为有效的 json 返回（我使用 Google Chrome 开发工具对其进行了验证）。子网格展开并显示正确的行数和正确的标题，但值不会出现在单元格中。

我已经浏览了在线文档和这里的各种建议，但似乎没有任何效果。我已经使用 jsonReader 配置玩了很多，但它似乎没有帮助（如果我将 repeatitems 设置为 true，它根本不起作用）。将 gridview 从 true 翻转为 false 似乎也无济于事。

任何帮助表示赞赏。

这是对子网格控制器方法的实际调用：

```
/Schedule/SubGridData?nd_=1365975664423&id=1002200&InspectionScheduleId=1002200&ItemTypeId=1000003 
```

这是调用返回的 Google Chrome 声称的数据：

```
{"rows":[{"cell":["Tony\u0027s HomeBrew","Icky Beer"]},{"cell":["Tony\u0027s WorkBrew","Tasty Beer"]}]} 
```

这是网格配置：

```
 <script type="text/javascript">
    jQuery(document).ready(function () {
    jQuery('#GridDataBasic').jqGrid({
    autoencode:true,
    autowidth:true,
    caption:'Inspection Schedule',
    datatype:'json',
    jsonReader:{ repeatitems:false, id: 'InspectionScheduleId', subgrid: { root: 'rows', repeatitems: false, cell: 'cell', id: 'id' } },
    emptyrecords:'No record Found',
    gridview:false,
    height:'100%',
    loadui:'block',
    pager:'#pager',
    rowList:[10,15,20,50],
    rowNum:10,
    rowattr: function(rowData) {var dueDate = new Date(parseInt(rowData.DueDate.substr(6)));var nowDate = new Date();var colorDate = new Date(dueDate - (rowData.RedOffsetInMinutes * 60000));if (nowDate > colorDate) { return {'class': 'redOffsetColor'}; }colorDate = new Date(dueDate - (rowData.OrangeOffsetInMinutes * 60000));if (nowDate > colorDate) { return {'class': 'orangeOffsetColor'}; }colorDate = new Date(dueDate - (rowData.YellowOffsetInMinutes * 60000));if (nowDate > colorDate) { return {'class': 'yellowOffsetColor'}; }colorDate = new Date(dueDate - (rowData.GreenOffsetInMinutes * 60000));if (nowDate > colorDate) { return {'class': 'greenOffsetColor'}; }},
    viewsortcols:[true,'vertical',true],
    shrinkToFit:true,
    url:'/Schedule/IndexGridData',
    viewrecords:true,
    subGrid: true,
    subGridUrl : '/Schedule/SubGridData',
    subGridModel : [ { 
    name : [ 'Item Name','Item Description' ],
    width : [ 50,50 ],
    align : [ 'left','left' ],
    params : [ 'InspectionScheduleId','ItemTypeId' ]
     } ],
    colModel: [
    {
      name:'InspectionScheduleId',
      hidden:true,
      key:true,
      label:'InspectionScheduleId',
      sortable:false,
      index:'InspectionScheduleId'
    },{
      name:'ItemTypeId',
      hidden:true,
      label:'ItemTypeId',
      sortable:false,
      index:'ItemTypeId'
    },{
      name:'GreenOffsetInMinutes',
      hidden:true,
      label:'GreenOffsetInMinutes',
      sortable:false,
      index:'GreenOffsetInMinutes'
    },{
      name:'YellowOffsetInMinutes',
      hidden:true,
      label:'YellowOffsetInMinutes',
      sortable:false,
      index:'YellowOffsetInMinutes'
    },{
      name:'OrangeOffsetInMinutes',
      hidden:true,
      label:'OrangeOffsetInMinutes',
      sortable:false,
      index:'OrangeOffsetInMinutes'
    },{
      name:'RedOffsetInMinutes',
      hidden:true,
      label:'RedOffsetInMinutes',
      sortable:false,
      index:'RedOffsetInMinutes'
    },{
      name:'ItemTypeName',
      label:'Item Type',
      sortable:false,
      index:'ItemTypeName'
    },{
      align:'center',
      name:'DueDate',
      formatter:'date', formatoptions: {srcformat:'ISO8601Long', newformat:'m/d/Y H:i:s'},
      label:'Due Date',
      sortable:true,
      index:'DueDate'
    }
    ]
    });
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:19:23.757

`subgrid`的属性`jsonReader`应该包含`repeatitems: true`而不是`false`。`subgrid`属性的默认值已经是`{root:"rows", repeatitems: true, cell:"cell"}`。所以我认为删除`subgrid`属性`jsonReader`应该可以解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T14:32:30.030

如果您的给定函数之一不存在，您在子网格中的数据也不会显示。因此，如果您输入错字，则会显示空行：

```
afterSave: ReloadSubGrid, onError: UpdateFailed, delOptions:...
...
function ReloadSbuGrid(rowid, response) {
    ...
} 
```

错字：ReloadSbuGrid 应该是 ReloadSubGrid

# delphi - cxDateEdit 设置时间

> ID：16004895
> 
> 赞同：-1
> 
> 时间：2013-04-14T22:03:43.497
> 
> 标签：delphi, devexpress, delphi-xe2, delphi-xe

你如何强制 cxDateEdit 将时间重置为 00:00:00 ？实际上我不需要时间并且只将其属性更改为日期，但不知何故时间仍然包含在结果中。不可见，但足以使我的查询结果出错。我必须将时间重置为 00。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T22:32:15.580

[`DateUtils.DateOf`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.DateUtils.DateOf)仅返回日期时间变量的日期部分。

```
// QueryDate is a TDateTime variable
QueryDate := DateUtils.DateOf(cxDateEdit1.DateTime);
YourQuery.ParamByName('TheDate').AsDateTime := QueryDate; 
```

对于使用没有该`DateUtils`单元的旧版本 Delphi 的未来读者，您可以使用`Trunc`. （如果你有`DateUtils`，如果你改用它，你在做什么会更清楚`DateOf`。）

```
QueryDate := Trunc(cxDateEdit1.DateTime); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:32:40.367

属性中有一个 SaveTime 属性，您可以将其设置为 False。这将只存储日期。

# linux - 每秒 Ping 服务器以查看正常运行时间

> ID：16004896
> 
> 赞同：2
> 
> 时间：2013-04-14T22:03:45.207
> 
> 标签：linux, shell, unix, cron, ping

我正在编写一个快速而肮脏的脚本来检测服务器停机时间。我有一台服务器和两个远程客户端，它们每秒 ping 一次服务器以查看它是否已启动。

`cron`如果您最多可以运行每分钟一次，我将如何设置任务在客户端计算机上每秒运行一次？完成上述内容的最佳方法是什么？

此外，客户端机器可能会重新启动，程序需要继续运行（类似于此处的 cron）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T22:08:37.667

```
while true; do ping -c 1 server | do stuff w/ output;sleep 1;done 
```

要获得“编辑（可能重新启动）”的资格，只需创建一个重新启动循环的初始化脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T01:02:10.350

我知道你问过关于 ping 的问题。还有其他事情需要考虑。

获得“正常运行时间”的一种更合理的方法是使用查询数据库的东西，如 wtpmx、utmp 或其他用于此目的的文件。ping 协议 ICMP 可以并且将被繁忙的系统忽略。错过回报并不总是意味着系统已关闭。或者系统不工作。可能有很多原因。

考虑在现代 UNIX 机器上获得正常运行时间的一种方法：

```
ssh remoteserver 'uptime' 
```

还要考虑“为什么”你正在ping。

Ping 可用于检查系统是否处于活动状态并响应 ping 数据包，但可能无法告诉您系统是否实际运行。这可能是您肯定想知道的。例如，数据库服务器或邮件服务器可能有一些挂起的进程。所以它对 ping 有响应，但很少做它打算做的事情。您可能想要构建一个比 ping 更有用的命令。我们每分钟登录一次服务器上的 24x7 prod 数据库，并让它运行一个 sql 脚本，该脚本会回应一些无害的东西，比如“OKAY”。例如，

```
select 'OKAY' from dual; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-19T06:19:24.623

您可以在以下脚本的帮助下编写一个 cronjob 来实现此目的。

`1 * * * * /bin/ping -c2 www.google.com | while read pong; do echo "$(date): $pong"; done >> ~/pings/google.com.log`

它每 1 分钟 ping 一次 google.com，并将当前日期和时间的输出记录到文件路径。

# python - 有没有办法让 argparse.ArgumentParser.parse_args() 不退出参数错误？

> ID：16004901
> 
> 赞同：3
> 
> 时间：2013-04-14T22:04:04.480
> 
> 标签：python, argparse, systemexit

例如：

```
import argparse

parser = arparse.ArgumentParser()
# parser.add_argument(...) ...
args = parser.parse_args(args_list) 
```

问题是，`parser.parse_args`如果`args_list`. 是否有一个设置可以让它引发更友好的异常？如果有任何解决方法，我不想捕获`SystemExit`并从中提取所需的错误消息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T22:14:02.717

你可以使用

```
args, unknown = parser.parse_known_args(args_list) 
```

然后，任何未知的参数都将简单地返回到`unknown`.

例如，

```
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('--bar', action='store_true')
parser.add_argument('cheese')
args, unknown = parser.parse_known_args(['--swallow', 'gouda', 'african'])
print(args)
# Namespace(bar=False, cheese='gouda')

print(unknown)
# ['--swallow', 'african'] 
```

# javascript - xhtml 到 javascript 通过 xslt 输出

> ID：16004903
> 
> 赞同：1
> 
> 时间：2013-04-14T22:04:25.420
> 
> 标签：javascript, xslt, xhtml, xslt-2.0

我正在尝试将 xhtml 输入转换为 javascript 输出，我的输入如下：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>My page</title>
</head>

<body>
  <ul>
    <li><a href="page.html">about page</a></li>

    <li><a href="ipsum.html">ipsum</a></li>

    <li>there is a text right there

      <ul>

        <li><a href="dolor.html">dolor</a></li>

        <li><a href="yeah.html">yeah</a></li>

   </ul>
</ul>
</body>
</html> 
```

我想在单行 javascript 中生成一个输出文件以重用于菜单，如下所示：

```
var mytree="";
mytree=' <ul><li><a href="page.html">about page</a></li><li><a href="ipsum.html">ipsum</a></li><li>there is a text right there<ul><li><a href="dolor.html">dolor</a></li> <li><a href="yeah.html">yeah/a></li></ul></ul>'; 
```

我怎样才能通过 xsl 转换产生这个？我试过这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:html="http://www.w3.org/1999/xhtml"
    exclude-result-prefixes="html"
    version="2.0">
    <xsl:output  media-type="text/xml" method="xml" indent="no" omit-xml-declaration="yes"  ></xsl:output>
    <xsl:strip-space  elements="html:*"/> 
    <xsl:template match="html:html">
    <xsl:text disable-output-escaping="yes">toctree='</xsl:text>
 <xsl:apply-templates select="html:body"/>
    <xsl:text disable-output-escaping="yes">';</xsl:text>        
    </xsl:template>    
    <xsl:template name="copy" match="html:ul| html:li | html:a"  >
        <xsl:element name="{local-name()}"><xsl:for-each select="@*">
                <xsl:attribute name="{local-name()}">
                    <xsl:value-of select="replace(., '\n', '')" />
                </xsl:attribute>
            </xsl:for-each>
            <xsl:apply-templates />
        </xsl:element>
    </xsl:template> 
</xsl:stylesheet> 
```

它对我有用，但总是有很多换行符......我需要一行来定义变量 mytree。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T02:29:11.450

**只需将此模板添加到提供的转换中：**

```
<xsl:template match="text()">
 <xsl:value-of select="normalize-space()"/>
</xsl:template> 
```

**现在完整的转换变成：**

```
<xsl:stylesheet version="2.0" id="" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:html="http://www.w3.org/1999/xhtml" exclude-result-prefixes="html">
    <xsl:output  media-type="text/xml" method="xml" indent="no" omit-xml-declaration="yes"/>
    <xsl:strip-space  elements="html:*"/>

    <xsl:template match="html:html">
      <xsl:text disable-output-escaping="yes">toctree='</xsl:text>
      <xsl:apply-templates select="html:body"/>
      <xsl:text disable-output-escaping="yes">';</xsl:text>
    </xsl:template>

    <xsl:template name="copy" match="html:ul| html:li | html:a"  >
        <xsl:element name="{local-name()}">
           <xsl:for-each select="@*">
                <xsl:attribute name="{local-name()}">
                    <xsl:value-of select="replace(., '\n', '')" />
                </xsl:attribute>
            </xsl:for-each>
            <xsl:apply-templates />
        </xsl:element>
    </xsl:template>

    <xsl:template match="text()">
     <xsl:value-of select="normalize-space()"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时：**

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>My page</title>
</head>

<body>
  <ul>
    <li><a href="page.html">about page</a></li>

    <li><a href="ipsum.html">ipsum</a></li>

    <li>there is a text right there

      <ul>

        <li><a href="dolor.html">dolor</a></li>

        <li><a href="yeah.html">yeah</a></li>
      </ul>
    </li>
  </ul>
</body>
</html> 
```

**产生了想要的单行结果：**

```
toctree='<ul><li><a href="page.html">about page</a></li><li><a href="ipsum.html">ipsum</a></li><li>there is a text right there<ul><li><a href="dolor.html">dolor</a></li><li><a href="yeah.html">yeah</a></li></ul></li></ul>'; 
```

# jquery - jQuery 悬停在 IE10 中不起作用，但在较低的 IE 版本中起作用

> ID：16004905
> 
> 赞同：4
> 
> 时间：2013-04-14T22:04:41.267
> 
> 标签：jquery, internet-explorer, internet-explorer-10, jquery-hover, quicksand

在我的网站上，这些框应该淡入描述中。这适用于我尝试过的所有浏览器，除了 IE10。这是一个 WordPress 网站，我使用了九个插件。我试过停用所有插件，但悬停在 IE10 中仍然不起作用。

下面是我用于悬停的代码：

```
jQuery(document).ready(function($){

$('.thumbnail').hover(function() {
  $('img', this).stop(true,true).fadeTo(100, 0.1);
  $('.description', this).stop(true,true).fadeIn(100);
}, function() {
  $('img', this).stop(true,true).fadeTo(100, 1);
  $('.description', this).stop(true,true).fadeOut(100);
});

}); 
```

有人可以帮我找出问题吗？如果我遗漏了任何重要信息，请告诉我。谢谢你。

编辑：过滤/悬停的整个代码。

```
 // Filter
  $(function() {

    var time_effect = 1000;
    var effect_name = 'easeOutQuart';

    $('.all').quicksand( $('.everything article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });

            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });

    $('.btn_all').click(function(e) {
      $('.all').quicksand( $('.everything article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });
            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });
      $('.button_box a').removeClass('selected');
      $(this).addClass('selected');
      e.preventDefault();
    });

    $('.btn_identity').click(function(e) {
      $('.all').quicksand( $('.identity article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });
            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });
      $('.button_box a').removeClass('selected');
      $(this).addClass('selected');
      e.preventDefault();
    });

    $('.btn_web').click(function(e) {
      $('.all').quicksand( $('.web article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });
            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });
      $('.button_box a').removeClass('selected');
      $(this).addClass('selected');
      e.preventDefault();
    });

    $('.btn_illustration').click(function(e) {
      $('.all').quicksand( $('.illustration article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });
            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });
      $('.button_box a').removeClass('selected');
      $(this).addClass('selected');
      e.preventDefault();
    });

    $('.btn_print').click(function(e) {
      $('.all').quicksand( $('.print article'), {
        duration: time_effect,
        attribute: 'data-id',
        easing: effect_name,
        adjustHeight: 'auto',
        useScaling: false
      }, function() { // callback function
            $("a.single-image").fancybox({
                'transitionIn'   : 'elastic',
                'transitionOut'  : 'fade',
                'overlayColor'   : '#000',
                'overlayOpacity' : '0.6'
            });
            $(document.body)
                .on('mouseenter', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 0);
                    $('.description', this).stop(true,true).fadeIn(600);
                })
                .on('mouseleave', '.thumbnail', function() {
                    $('img', this).stop(true,true).fadeTo(600, 1);
                    $('.description', this).stop(true,true).fadeOut(600);
                });
            $("body.blog #content article:last, body.archive #content article:last, body.search-results #content article:last").addClass("last");
      });
      $('.button_box a').removeClass('selected');
      $(this).addClass('selected');
      e.preventDefault();
    });
  }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T01:07:31.063

这里的问题在于浏览器嗅探代码。将 Internet Explorer 10 的用户代理字符串* 更改为 Chrome，然后刷新浏览器。你会看到它工作得很好。

脚本正在利用`$.browser.msie`并假设 Internet Explorer 10 与 Internet Explorer 7、8 和 9 类似（事实并非如此，它完全不同）。您的情况的罪魁祸首来自 jQuery QuickSand。看看下面的条件：

```
if ( $.browser.msie && $.browser.version.substr(0,1) < 7 ) {
    $sourceParent.html('').append($collection);
    return;
} 
```

这个测试，只检查版本号的第一个值，会错误地将 Internet Explorer 10 识别为版本“1”，这显然小于支持的版本 7。

这是[六个月前](https://github.com/razorjack/quicksand/commit/cb823552f7fe7a26f8d8ec3868af6209c263b17a#jquery.quicksand.js)修复的；[从 GitHub下载最新版本](https://github.com/razorjack/quicksand)的 QuickSand。

### 更改 Internet Explorer 的用户代理字符串

按 F12 显示开发者工具。选择`Tools > Change user agent string`以显示其他 ua 字符串选项。选择“Chrome”，然后刷新浏览器以将 HTTP 请求重新发出为“Chrome”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T23:19:13.667

您可以`.thumbnail`通过在当前调用上方的行中插入此代码来了解在运行代码时是否存在 IE 10 的对象`.hover`：

```
console.log($('.thumbnail').length); 
```

如果这记录了 a`0`那么这就解释了为什么悬停事件处理程序永远不会连接。无论出于何种原因，IE 10 认为这些元素在代码运行时还不存在。这是绑定可能更好的事件的另一种方法：

```
jQuery(document).ready(function($){

    $(document.body)
        .on('mouseenter', '.thumbnail', function() {
            $('img', this).stop(true,true).fadeTo(100, 0.1);
            $('.description', this).stop(true,true).fadeIn(100);
        })
        .on('mouseleave', '.thumbnail', function() {
            $('img', this).stop(true,true).fadeTo(100, 1);
            $('.description', this).stop(true,true).fadeOut(100);
        });

}); 
```

这样做是它设置了一对全局事件处理程序，这些事件处理程序仅适用于具有“缩略图”类名称的元素，而不管这些元素在此代码首次运行时是否存在。如果问题是 IE 10 中的时间问题，这可能会解决它。

# php - PHP如何防止非会员直接访问私有内容

> ID：16004906
> 
> 赞同：1
> 
> 时间：2013-04-14T22:04:56.643
> 
> 标签：php, apache, security, password-protection

我知道 .htaccess Apache 保护文件夹免受非成员访问的方法，但我想知道如何仅使用 PHP 来完成。

检查会话变量可以保护 php 页面，但有时会忽略对照片和或 pdf 的直接访问。例如，如果我从 facebook 复制一张照片的直接链接，注销，然后将我的浏览器定向到照片的 url，它显示没有问题。

Rapidshare 之类的网站如何防止对其内容的直接访问？

我知道有一种方法可以在 Apache 中设置变量。也许有一种方法可以用 Apache 检查会话变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T23:24:09.500

从问题和评论来看，您似乎在寻找看起来像直接访问的 URL，但通过 PHP 脚本允许授权下载它们。我不知道你当前的目录结构，所以我要为这个答案的测试用例做一个——尽管是一个小清单：

```
public-html/
    content/        <- where the actual files are
        .htaccess   <- to deny access to the directory
    .htaccess       <- the one created here
    download.php    <- download script 
```

由此，我们将假设所有文件都位于其中，`/content`并且“直接链接”看起来像`/file`

`/content/.htaccess`: _

```
deny from all 
```

下一个带有注释，第一个`RewriteRule`是使已经存在的普通文件不会被覆盖，而前一个则`.htaccess`防止该目录中的文件被访问。如果你有一个`.htaccess`你已经在使用的，重要的规则是最后一个，如果匹配它就会停止处理，所以把它相应地放在你现有的`.htaccess`.

`/.htaccess`：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} -s [OR]
    RewriteCond %{REQUEST_FILENAME} -l [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^.*$ - [NC,L]

    RewriteRule ^file/(.+)$ download.php?file=$1 [L]
</IfModule> 
```

有了它，它看起来就像是直接访问一个文件，如果去的话`/file/myDocument.pdf`，它将被发送到脚本，如`download.php?file=myDocument.pdf`.

从那里，创建要使用的下载脚本是一个问题。我要发布的是来自[Armand Niculescu](http://www.richnetapps.com/php-download-script-with-resume-option/)的修改版本。我只在此处发布相关部分（[可以在 PasteBin](http://pastebin.com/w7Hsd7tQ)上找到全部内容，您可以修改此处发布的部分以满足您的需要）：

```
/******************************
 * PERFORM AUTHORIZATION HERE *
 *   The following is added   *
 ******************************/
if($_SESSION['validated'] !== true) {
    //Not authorized to download, send header and exit
    header("HTTP/1.0 401 Unauthorized");
    exit;
} 
```

我还对正确的文件路径进行了另一个小编辑，向下 8 行：

```
$file_path  = './content/' . $file_name; 
```

至此，这个关于如何获取有效下载脚本并使其看起来像直接文件访问的小示例结束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T23:27:23.373

从您的问题中，我了解到您已经知道如何保护文件夹不被直接访问以及如何保护 php 脚本。所以你需要的是一个受保护的 php 脚本，提供对文件的间接访问（正如评论中已经提到的）。

创建此下载脚本时，您应该记住一些重要的细节：

*   提供 mime 类型。在许多情况下`header("Content-Type: application/octet-stream")`就足够了，尽管
*   告诉客户端下载文件（而不是显示它）并提供文件名：`header('Content-Disposition: attachment; filename="' . basename($path) . '"')`
*   提供文件大小：`header("Content-Length: " . filesize($path));`
*   为避免大文件出现问题，您应该使用以下内容而不是`readfile`：

    ```
    $file = fopen($path, 'r');
    flush(); 
      while (!feof($file)) { 
      print(fread($file, 4096)); 
      flush(); 
    }
    fclose($file); 
    ```

# css - 确保 div 永远不会相互交叉

> ID：16004908
> 
> 赞同：0
> 
> 时间：2013-04-14T22:05:12.417
> 
> 标签：css, jquery-mobile

我有 2 个并排的 div，每个 div 的宽度为 50%，向左浮动我想要的是，如果它们不能放在页面上，那么一个 div 应该低于另一个 div。如何在 CSS 中做到这一点？我还应该提到我正在使用 jQuery Mobile，如果这有所作为的话。我的代码如下： `#artistimage,#artistinfo{ width: 50%; float: left; }`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T23:21:05.153

正如您在此处看到的那样[http://jsfiddle.net/PMXpb/](http://jsfiddle.net/PMXpb/)当它们设置为 50% 宽度时它们总是适合。 `{width:50%; height: 100px; float:left;}`

如果您将它们设置为固定宽度（像素值），当空间不足时，一个会下降到另一个下方，如下所示：http: [//jsfiddle.net/Yk4sX/](http://jsfiddle.net/Yk4sX/) `{width:300px; height: 100px; float:left;}`

您可以通过调整浏览器大小来测试这两种情况。

# c++ - 在 C++ 中使用全局向量

> ID：16004910
> 
> 赞同：1
> 
> 时间：2013-04-14T22:05:27.363
> 
> 标签：c++, variables, static, global-variables, scope

我已经实现了一个使用查找表的快速比较功能。由于项目中多个类都用到了这个函数，所以我需要确保在整个程序执行过程中，查找表只有一份。

查找表是一个`vector<int>`大小为 65536 的简单表。我希望在程序开始时初始化此表，而不是在第一次使用时。如何处理这个问题？

以下代码片段是我的比较函数的当前版本。我相信通过制作`lookup_table`一个静态变量，问题只会部分解决，因为静态变量的生命周期从程序流第一次遇到声明时开始。

```
int fast_compare(const char* array1, const char* array2, int length)
{
    static const vector<int> lookup_table = init_lookup_table();

    // process the input arrays...
    // ...
    return lookup_table[...];
}

vector<int> init_lookup_table()
{
    vector<int> lut(65536);

    // ----------------------------
    // initialize the look-up table
    // ...
    // ...
    // end of initialization
    // ----------------------------

    return lut;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T22:36:18.253

> 我希望这个表在程序开始时被初始化，而不是在它第一次使用的时候。

为什么不在 cpp 文件中使用未命名的命名空间？

```
#include <numeric>
#include <iterator>
#include <iostream>
#include <vector>

namespace {
    //c++11 version
    static auto const lookup_table = []() -> std::vector<int> { 
        std::vector<int> lut(65536);
        iota(begin(lut), end(lut), 0);// init lut here
        return lut;
    }();// invoke the lambda

    //c++ 98 version
    //static const std::vector<int> lookup_table = init_lookup_table();
}

int main()
{
    std::cout<<"lut[32768] = " << lookup_table[32768]<<std::endl;
} 
```

[Herb Sutter在这里](http://herbsutter.com/2013/04/05/complex-initialization-for-a-const-variable/)解释了 lambda 初始化

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T22:10:33.677

你描述的是**单例**模式。Web 上有关于如何使用 C++ 通常实现单例的文档。

基本上它是一个带有静态函数的小类，它返回指向查找表的指针/引用（我个人，我更喜欢引用）。

参考：[Singleton：应该如何使用](https://stackoverflow.com/questions/86582/singleton-how-should-it-be-used)

但是，针对您的特定问题的一个更简单的解决方案可能是只生成一次查找表，然后转手`boost::shared_pointer`。

# c++ - 计算机视觉：跟踪硬币翻转

> ID：16004911
> 
> 赞同：0
> 
> 时间：2013-04-14T22:05:31.527
> 
> 标签：c++, opencv, computer-vision

是否有可能编写一个可以跟踪和预测硬币翻转的程序？

输入将是两个或多个监控翻转最初几秒钟的网络摄像头的馈送。该程序将使用我想象的物理方程来分析旋转硬币的运动。输出将是在事件实际发生之前硬币是正面朝上还是反面朝上的估计。如果确实可能，哪些语言和库最适合这项任务？C++ 和 OpenCV 能胜任这项任务吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:32:00.050

您需要阅读样本混叠的奈奎斯特极限。

基本上，您需要确定典型的抛硬币每秒会显示多少转，并使用 Nyquist 定理计算出捕获它的最小帧速率。

如果你能确定硬币在哪一帧是平的，它在哪一帧离开了手，它在哪一帧被抓到，以及最初的硬币面是什么，你就有很好的机会将其推断到抓到的地方。您也许可以进行音频处理以帮助查明翻转和捕捉事件。

您也可以使用帧内的运动模糊来确定硬币边缘的角速度，但您不知道旋转轴。捕捉更清晰的图像会更容易。这意味着大光圈镜头和/或良好的照明以允许较短的曝光时间，并且可能具有较高的帧速率。

如果您可以交错来自多个摄像机的帧，您可能会牺牲更高的帧速率。这需要良好的外部同步。

# xna - Xna 手动创建边界框检测？

> ID：16004912
> 
> 赞同：0
> 
> 时间：2013-04-14T22:05:44.280
> 
> 标签：xna, xna-4.0, bounding-box, bounding

所以我设法创建并成功测试了边界框。我现在已经获得了所有 8 个角点，`vector[] corners = new vector[8]`并且`vector[] corners1 = new vector[8]`只是想知道代码将是什么而不是 model.intersect(model1)。我之所以要这样做是因为希望我可以更改向量中的一些点以使我的模型上升。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T23:42:04.553

首先...您有一个 BoundingBox 结构，可以为您处理 AABB 碰撞...。

[http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.boundingbox.aspx](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.boundingbox.aspx)

第二……如果你想自己做，

1.  如果您只需要检查 AABB 碰撞，只需确定边界框中每个顶点的最小和最大坐标，即可与边界最小和最大进行比较...

    ```
    foreach (vertex in vertices) {
        Min.X = Min(Min.X, vertex.X);
        Min.Y = Min(Min.Y, vertex.Y);
        ....
        // Idem for max
    }

    bool collide(BoundingBox other)
    {
         if (min.X > other.max.X) return false;
         if (min.y > other.max.y) return false;
         ....

    } 
    ```

2.  如果需要检查A和B对象的obb碰撞，只需将B顶点转换为A空间，并在A空间工作

    ```
    BVertexInASpace = B.WorldVertex.Select( v => Matrix.Transform(v, A.TransformInverted)); 
    ```

    在 A 空间中，最小顶点为 (0,0,0)，最大顶点为 (width, height, depth)，因此您只需检查 BVertexInASpace 顶点是否在内部...

# c++ - 从 C 程序执行终端命令，不符合我的预期

> ID：16004913
> 
> 赞同：1
> 
> 时间：2013-04-14T22:05:46.043
> 
> 标签：c++, linux, debian, raspberry-pi

我正在尝试获取一个包含 WiFi 信号强度的变量。从终端执行时，以下命令成功返回

```
iwconfig wlan0 |grep Signal| cut -d"=" -f3 |cut -d" " -f1 
```

返回 74/100

但是，当我将其放入 system() 调用中时，会出现以下编译错误。

```
int main (){
system("iwconfig wlan0 |grep Signal| cut -d"=" -f3 |cut -d" " -f1");
return 0;
} 
```

当我编译那个...

$ c++ wifi.cc wifi.cc: 在函数'int main()'中：

wifi.cc:8:59: 错误：分配只读位置 '"iwconfig $_[0]|grep Signal|cut -d"'</p>

wifi.cc:8:59：错误：将“const char [16]”分配给“const char [34]”时的类型不兼容</p>

非常感谢任何想法/建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T22:08:33.103

这是因为您的字符串文字中包含未转义的引号。你需要逃避它们：

```
system("iwconfig wlan0 |grep Signal| cut -d\"=\" -f3 |cut -d\" \" -f1"); 
```

在您不正确的代码中，引号是这样配对的：

```
system("iwconfig wlan0 |grep Signal| cut -d"=" -f3 |cut -d" " -f1");
       ^                                   ^ ^            ^ ^    ^
       └─────────────────1─────────────────┘ └──────2─────┘ └─3──┘ 
```

如您所见，有三个单独的字符串文字。转义引号后，就 C++ 而言，只有一对引号：

```
system("iwconfig wlan0 |grep Signal| cut -d\"=\" -f3 |cut -d\" \" -f1");
       ^                                                             ^
       └──────────────────────────────1──────────────────────────────┘ 
```

转义的引号（`\`前面有引号）只是字符串的一部分。

但是，在终端中，该命令不是某些字符串的一部分。它本身只是一个命令，并且引号是这样配对的：

```
iwconfig wlan0 |grep Signal| cut -d"=" -f3 |cut -d" " -f1
                                   ^ ^            ^ ^
                                   └1┘            └2┘ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:08:28.997

你需要逃避`"`这样的事情`\"`：

```
system("iwconfig wlan0 |grep Signal| cut -d\"=\" -f3 |cut -d\" \" -f1"); 
```

否则，您在第一种情况下拥有的是：

```
"iwconfig wlan0 |grep Signal| cut -d" = " -f3 |cut -d"
                                     ^^^ 
```

它试图分配给一个字符串文字，这是错误`assignment of read-only location`的来源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T07:32:43.830

如果你的字符串足够简单并且你想避免逃生地狱，你也可以在 shell 命令中使用单引号，例如：

```
system("iwconfig wlan0 |grep Signal| cut -d'=' -f3 |cut -d' ' -f1"); 
```

这只有效，因为在 shell 中，您可以对字符串文字同时使用双引号和单引号（两者之间*存在*差异，但现在让我们不要理会它们）。

除此之外，我建议使用库调用而不是执行终端程序。这应该使您的程序更快（因为您不必调用调用库的外部程序来获取一些值并打印它；只为您解析打印输出并尝试读取正确的值），并且更健壮（例如，如果`iwconfig`由于新版本或仅仅因为它在不同的语言下运行而改变输出；或者您有多个无线连接，或者...）

看看[libiw](http://packages.debian.org/libiw-dev)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-14T22:08:49.967

您需要使用转义序列在字符串中添加引号，如下所示：

```
system("iwconfig wlan0 |grep Signal| cut -d\"=\" -f3 |cut -d\" \" -f1");
//                                         ^^ ^^            ^^ ^^ 
```

# javascript - d3.js节点之间的链接不呈现为线

> ID：16004915
> 
> 赞同：1
> 
> 时间：2013-04-14T22:05:51.533
> 
> 标签：javascript, d3.js, svg, circle-pack

我正在使用修改后的气球图，并且在获取要渲染的节点之间的链接时遇到问题。我正在使用 JustinVDM 的自定义气球图（[https://gist.github.com/justinvdm/3676778](https://gist.github.com/justinvdm/3676778)）

使用的数据是股票 Bostockflare.json 数据：[http](http://bl.ocks.org/mbostock/4063530) ://bl.ocks.org/mbostock/4063530 。

如果我在 中包含“错误”选项`d3.json("flare.json", function(error, root) {...`，它将出错。没有它，至少节点会出现。源和目标的数据是否已被识别？

如果是，下面的尝试是尝试调用父源和目标子的坐标并在它们之间画一条线，但我不知道这种方法是否合适。我应该改为使用`d3.svg.diagonal`吗？

这是出现的图表： ![没有边缘](https://i.stack.imgur.com/rDzBF.jpg)

```
var margin = {top: 20, right: 20, bottom: 20, left: 20},
    width =1500, 
    height = 1500, 
    diameter = Math.min(width, height),
    radius = diameter / 2;

var balloon = d3.layout.balloon()
  .size([width, height])
  .gap(50)                                      

var line = d3.svg.line()

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + (margin.left + radius) + "," + (margin.top + radius) + ")")

    root = "flare.json";
    root.y0 = height / 2;
    root.x0 = width / 2;

d3.json("flare.json", function(root) {
  var nodes = balloon.nodes(root),
      links = balloon.links(nodes);

  var link = svg.selectAll(".link")
      .data(links)
    .enter().append("path")
      .attr("class", "link")
      .attr("d", line)
      .attr("fill", "black");

  var node = svg.selectAll("g.node")
    .data(nodes)
    .enter()
    .append("g")
    .attr("class", "node");

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; });

  node.append("text")
      .attr("dx", function(d) { return d.x })
      .attr("dy", function(d) { return d.y })
      .attr("font-size", "5px")
      .attr("fill", "white")
      .style("text-anchor", function(d) { return d.children ? "middle" : "middle"; })
      .text(function(d) { return d.name; })
}); 
```

更新：我从 API 参考中添加了以下关于“hierarchy.links”的代码：

```
var link= svg.selectAll("path")
  .data(links)
 .enter()
  .append("path")
  .attr("d", d3.svg.diagonal()); 
```

结果有点奇怪，但如果我替换`d3.svg.diagonal()`为`d3.svg.line()`，代码会中断。

![在此处输入图像描述](https://i.stack.imgur.com/vb1KM.jpg)

我如何只制作边缘线而不是丝带？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T16:32:21.527

您可以通过将填充设置为无并使用描边来定义颜色来制作边缘线。像这样的东西：

```
var link = svg.selectAll(".link")
  .data(links)
.enter().append("path")
  .attr("class", "link")
  .attr("d", line)
  .attr("fill", "none")
  .attr("stroke", "black"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T05:31:18.420

此布局中的节点之间没有链接。目标是将树表示为具有嵌套节点的图。

但是，如果您真的想添加链接，即使它们仅通过颜色或粗细添加信息，那么您始终可以通过给每个圆圈不同的方式在圆圈之间绘制线条，然后在您的数据中绘制圆圈之间的`id`线条. `source``target`

# cuda - 求向量元素之和等于 k 且不大于 k 的元素的向量数量

> ID：16004916
> 
> 赞同：0
> 
> 时间：2013-04-14T22:05:56.780
> 
> 标签：cuda, parallel-processing

我正在用 CUDA C 编写一个程序，我已经以经典方式解决了这个问题，但我应该使用 CUDA 并行化代码。问题是：打印所有长度为 n 的向量，其中每个元素的值可以为 [0 ... K]，并且所有元素的总和为 SUM。

我已经用 CUDA C 编写了程序，程序应该返回给我满足条件的向量的数量。现在的问题是我在代码中找不到任何错误，我不知道如何在Ubuntu中调试，输出总是给我0。我认为**全局**函数没有执行。这是代码，我希望有人能帮助我：

该程序的代码是：

```
#include <stdio.h>
#include <stdlib.h>
#include <assert.h>
#include <cuda.h>

#define MIN(x, y) (((x) < (y)) ? (x) : (y))
#define MYASSERT(condition) if(!(condition)) { return; }

__device__ void distribute2 (int vec[], int n, int k, int sum)
{
    int i;
    for (i =  blockIdx.x * blockDim.x + threadIdx.x;; i < n; i+=blockDim.x * gridDim.x)
    {
        vec[i]=MIN(sum, k);
        sum = sum- vec[i];
    }
    MYASSERT (sum == 0);
}
__global__ void moveUp (int vec[], int n, int k, int *res)
{
    int i;
    int collected = 0;
    for(i=blockIdx.x * blockDim.x + threadIdx.x; i<n;i+=blockDim.x * gridDim.x)
    {
        if (collected == 0)
            collected = vec[i];
        else
        {
            if (vec[i] < k)
            {
                vec[i] =vec[i]+1;
                distribute2 (vec, i, k, collected-1);
                __synchthreads();
                res[0]=res[0]+1;
            }
            else
            {
                collected += k;
            }
        }

    }
    MYASSERT(collected != 0);
}
int main()
{
    int n=5;
    int vec[n];
    int k=5;
    int sum=10;

    int *res_h, *res_d;
    size_t size = 1 * sizeof(int);
    res_h = (int *)malloc(size);
    cudaMalloc((void **) &res_d, size);
    res_h[0] = 0;
    cudaMemcpy(res_d, res_h, size, cudaMemcpyHostToDevice);

    cudaDeviceProp devProp;
    cudaGetDeviceProperties(&devProp, 0);
    unsigned maxbytes = devProp.totalGlobalMem / 3;
    unsigned max_samples = maxbytes / sizeof(int);

    if (n > max_samples) n = max_samples;

    printf("Using %d samples to estimate pi\n", n);

    moveUp<<<256, 256>>>(vec, n, k, res_d);
    cudaMemcpy(res_h, res_d, size, cudaMemcpyDeviceToHost);
    printf("%d\n", res_h[0]);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T15:27:38.400

您发布的代码中的一个问题是`vec`您在设备上取消引用的主机指针。这会导致您的内核中止。

您必须`vec`以与您处理的方式类似的方式处理`res_h`，并且`res_d`

# asp.net-web-api - 缓存从 Web api 服务返回的图像

> ID：16004917
> 
> 赞同：2
> 
> 时间：2013-04-14T22:06:00.157
> 
> 标签：asp.net-web-api, httpresponse, http-status-code-304, image-caching

无论我做什么，我都无法从 web api 缓存返回图像，每次我请求图像时都会看到对服务器的请求。

我已经为标题设置尝试了许多 permiations，这是我最近的努力：

```
 public class TestController : ApiController
    {
        public HttpResponseMessage Get(int id)
        {
            HttpResponseMessage response = new HttpResponseMessage();

            StreamContent streamContent = new StreamContent(File.Open("c:\\1.jpg", FileMode.Open, FileAccess.Read, FileShare.Read));

            response.Content = streamContent;
            response.Content.Headers.Add("Content-Type", "image/jpeg");
            response.Headers.CacheControl = new CacheControlHeaderValue
            {
                MustRevalidate = true,
                Private= false,
                MaxAge = TimeSpan.FromMinutes(1),
            };

            //string hash = new Guid("524DF956-D67A-4D66-A3E0-5E78726A204A").GetHashCode().ToString();
            //response.Headers.ETag = new EntityTagHeaderValue(String.Concat("\"", hash, "\""), true);
            //response.Content.Headers.LastModified = new DateTimeOffset(new DateTime(2012, 12, 24));
            //response.Content.Headers.Expires = new DateTimeOffset(new DateTime(2013, 12, 24));
            return response;
        } 
```

这就是我使用 chrome 检查时响应标头的样子：

> 缓存控制：必须重新验证，最大年龄 = 60 内容长度：24233
> 
> 内容类型：图像/jpeg 日期：2013 年 4 月 14 日星期日 22:04:32 GMT
> 
> 服务器：Microsoft-IIS/8.0 X-AspNet-版本：4.0.30319
> 
> X-Powered-By:ASP.NET
> 
> X-SourceFiles:=?UTF-8?B?Qzpcc291cmNlXFRydW5rXFRlc3RcYXBpXHRlc3RcMQ==?=

关于如何进行的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:49:53.920

如果您正在寻找 200 / 304 的情况，那么您在此阶段缺少的最大步骤可能是您的服务器代码需要选择何时返回 304，而不是带有完整消息正文的 200。当满足缓存规则的条件（并且您需要确定它们是什么）时，您将需要：

```
return new HttpResponseMessage(HttpStatusCode.NotModified); // 304 
```

**第2部分：**

然后，下一个选择是决定您的缓存规则。您当前的代码不会比缓存检查的第一步更进一步（即使是这样）。您需要为客户端返回一个`LastModified`和/或`ETag`，然后在后续请求中使用以执行缓存检查。

`LastModified`相当直截了当。比较日期，如果自该`LastModified`日期以来资源已被修改，则返回完整响应，否则返回 304。

`ETag`应该唯一地代表资源，*而不是*请求（正如您当前注释掉的 ETag 代码所做的那样）。散列对于 ETag 可能有意义，但前提是它是您要返回的资源的散列，*而不是*每次都是完全唯一的散列。把它想象成一个时间戳，甚至是版本号。客户端获取图像的版本 1，ETag 值为（假设）“1”。客户端然后发送对该图像的请求，包括 ETag 值，然后服务器检查“1”是否仍然是有效版本，并根据需要返回 200 + 正文 + 新 ETag 或 304。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T11:13:48.737

如果您希望浏览器能够缓存您的内容，您应该设置 Private=true，如果您希望共享缓存来缓存它，则应该设置 public=true。

# ios - 带有正确 JSON 流的 iOS SDK 中出现奇怪错误

> ID：16004918
> 
> 赞同：0
> 
> 时间：2013-04-14T22:06:02.013
> 
> 标签：ios, json, parsing

我有一个小问题，当我尝试解析我的 JSON 流时，我遇到了一个错误

```
if(error) {NSLog(@"%@",error);} 
```

这告诉我这个

> 2013-04-14 23:53:09.979 测试 [24463:303] 错误域 = NSCocoaErrorDomain 代码 = 3840 “数据已损坏，无法读取。” （字符 215 周围未转义的控制字符。） UserInfo=0x10042f6c0 {NSDebugDescription=字符 215 周围的未转义控制字符。}

问题是我的 JSON 流似乎很完美，你可以在这里找到它：http: [//api.kalokod.com/cce/news.json](http://api.kalokod.com/cce/news.json)，完美的'因为 JSONLint 返回这个 JSON 是有效的。

任何想法 ？谢谢 ！

**编辑**

这是我的解析器

```
- (NSDictionary *)JSONParser:(NSString *)JSONFile {

NSError *jsonParserError;

NSURL *myJSONfileURL = [NSURL URLWithString:JSONFile];

NSString *myJSONstring = [NSString stringWithContentsOfURL:myJSONfileURL encoding:NSUTF8StringEncoding error:&jsonParserError];

if (jsonParserError) {
    NSLog(@"%@", jsonParserError);
}

NSData *jsonData = [myJSONstring dataUsingEncoding:NSUTF8StringEncoding];

NSError *error;

NSDictionary *JSONParser = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error];

if (error) {
    NSLog(@"%@", error);
}

return JSONParser; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T23:39:46.700

JSON 不必是 UTF-8。如果 JSON 数据是 UTF-16 或 UTF-32，那么您将其转换为 NSString 的尝试将大错特错。尝试

```
NSData* data = [NSData dataWithContentsOfURL...] 
```

并将数据直接传递给 JSONObjectWithData。顺便提一句。“无法连接到服务器”是链接给我的。

# python - 当我使用 Windows 键盘键入非 ASCII 字符时，我得到“？”

> ID：16004920
> 
> 赞同：13
> 
> 时间：2013-04-14T22:06:08.487
> 
> 标签：python, unicode, tkinter, keyboard

当我使用 Windows 键盘（在语言栏中）键入字符时，我会在非 ASCII 字符的位置出现`non-ASCII`问号。`?`

复制和粘贴工作正常，Unicode 字符显示在`Text`小部件中。

我正在使用`Lakota All-In-One keyboard`找到的[here](http://www.languagegeek.com/siouan/keyboards/si_kbds.html)。此特定键盘列在区域设置下的*Windows 语言栏中*`US`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T03:01:12.520

TkInter 对特殊字符似乎不太好，尤其是在 Fedora 上。我看过几十个这样的帖子。您最好的选择可能是使用另一个 GUI 库，例如[PyFLTK](http://pyfltk.sourceforge.net/)（我最喜欢的）、[GTK+ 3](https://live.gnome.org/PyGObject)（我的第二喜欢）、[PyQt](http://www.riverbankcomputing.com/software/pyqt/intro)、[PySide](http://qt-project.org/wiki/PySide)、[wxPython](http://www.wxpython.org)、[Kivy](http://kivy.org)等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-18T17:30:12.217

Tkinter 的 unicode 历史有问题。尝试输入完整的 utf 值（即 \x80abc），我发现有时可以解决此问题。

# php - WordPress“循环”问题与“endwhile”

> ID：16004922
> 
> 赞同：-1
> 
> 时间：2013-04-14T22:06:17.867
> 
> 标签：php, wordpress

出于某种原因，我的编辑给了我一个错误`<?php endwhile; ?>`，我不知道为什么。它说它是一个`syntax error`. 如果有人可以花时间检查我的代码，看看它是否是编辑器中的错误，或者我做错了什么，那将不胜感激！

> 编辑::::: 页面不会加载或者我发布了我在下面得到的错误的图片......

**非常感谢提前！！！**

```
 <div class="homepage-slider-container">
        <div class="homepage-slider">
            <?php $loop = new WP_Query(array('post_type' => 'feature', 'posts_per_page' => -1, 'orderby'=> 'ASC')); ?>
            <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
            <a href="#" class="prev"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-left-arrow.png" alt=""></a>
            <a href="#" class="next"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-right-arrow.png" alt=""></a>

            <div class="slide">
                <?php $url = get_post_meta($post->ID, "url", true);
                if($url!='') {
                    echo '<a href="'.$url.'">';
                    echo '
                ?>
                <div class="homepage-slider-title">
                    <span class="title-rectangle">
                        <article>
                            <h3><?php the_title(); ?></h3>
                            <div class="clear"><!-- Clear --></div>
                            <p><?php the_content();?></p>
                        </article>
                    </span>
                    <!-- This is the right arrow that is attached to the title rectangle -->
                    <div class="title-rectangle-right_arrow"> </div>
                    <!-- This is the arrow that is to the right of the title text area -->
                    <img src="<?php echo get_template_directory_uri(); ?>/img/slider-title-right-arrow.gif" class="title-rectangle-further_right_arrow" alt="">
                    <?php '; echo the_post_thumbnail('full');
                echo '</div>';
            echo '</div>';
            ?>
            <?php endwhile; ?>

            <?php wp_reset_query(); ?>

            <div class="homepage-slider-front_pedestal">
                <p><?php echo of_get_option('slider_front-pedestal', 'no entry'); ?></p>
            </div>
        </div>
    </div> 
```

![WordPress 错误](https://i.stack.imgur.com/MKsSj.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:08:47.137

这是完整的版本：

```
 <div class="homepage-slider-container">
    <div class="homepage-slider">
        <?php $loop = new WP_Query(array('post_type' => 'feature', 'posts_per_page' => -1, 'orderby'=> 'ASC')); ?>
        <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
        <a href="#" class="prev"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-left-arrow.png" alt=""></a>
        <a href="#" class="next"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-right-arrow.png" alt=""></a>

        <div class="slide">
            <?php $url = get_post_meta($post->ID, "url", true);
            if($url!='') {
                echo '<a href="'.$url.'">';
            ?>
            <div class="homepage-slider-title">
                <span class="title-rectangle">
                    <article>
                        <h3><?php the_title(); ?></h3>
                        <div class="clear"><!-- Clear --></div>
                        <p><?php the_content();?></p>
                    </article>
                </span>
                <!-- This is the right arrow that is attached to the title rectangle -->
                <div class="title-rectangle-right_arrow"> </div>
                <!-- This is the arrow that is to the right of the title text area -->
                <img src="<?php echo get_template_directory_uri(); ?>/img/slider-title-right-arrow.gif" class="title-rectangle-further_right_arrow" alt="">
                <?php echo the_post_thumbnail('full'); ?>
            </div>
            <?php } ?>
        </div>
        <?php endwhile; ?>

        <?php wp_reset_query(); ?>

        <div class="homepage-slider-front_pedestal">
            <p><?php echo of_get_option('slider_front-pedestal', 'no entry'); ?></p>
        </div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:09:40.437

尝试使用这个：

```
<div class="homepage-slider-container">
    <div class="homepage-slider">
        <?php $loop = new WP_Query(array('post_type' => 'feature', 'posts_per_page' => -1, 'orderby'=> 'ASC')); ?>
        <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
        <a href="#" class="prev"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-left-arrow.png" alt=""></a>
        <a href="#" class="next"><img src="<?php echo get_template_directory_uri(); ?>/img/slide-right-arrow.png" alt=""></a>

        <div class="slide">
            <?php $url = get_post_meta($post->ID, "url", true);
            if($url!='') {
                echo '<a href="'.$url.'">';
            ?>
            <div class="homepage-slider-title">
                <span class="title-rectangle">
                    <article>
                        <h3><?php the_title(); ?></h3>
                        <div class="clear"><!-- Clear --></div>
                        <p><?php the_content();?></p>
                    </article>
                </span>
                <!-- This is the right arrow that is attached to the title rectangle -->
                <div class="title-rectangle-right_arrow"> </div>
                <!-- This is the arrow that is to the right of the title text area -->
                <img src="<?php echo get_template_directory_uri(); ?>/img/slider-title-right-arrow.gif" class="title-rectangle-further_right_arrow" alt="">
                <?php echo the_post_thumbnail('full');
            echo '</div>';
        echo '</div>';
        ?>
        <?php endwhile; ?>

        <?php wp_reset_query(); ?>

        <div class="homepage-slider-front_pedestal">
            <p><?php echo of_get_option('slider_front-pedestal', 'no entry'); ?></p>
        </div>
    </div>
</div> 
```

你有一个错误的回声，它不会回声任何东西。取出一些单引号+一个回声/分号。

当您关闭 PHP 标记时，它不再回显，而是使用普通 HTML。:) 所以在结束 PHP 标记之前不需要 echo。

# css - 我不能将相同的 CSS 样式应用于两个“行流体”

> ID：16004924
> 
> 赞同：0
> 
> 时间：2013-04-14T22:06:44.723
> 
> 标签：css, html

这是我的 HTML 和 CSS 代码。

**HTML**

```
<section id="content">
    <article id="areaRegister">
        <div class="row-fluid">
            <div class="span6">
                <?php include 'formulario.php'; ?>
            </div>
            <div class="span6">
                <div class="contentBarcode">
                    <div class="codigoBarras">
                        <header><h4>Código de barras generado!</h4></header>
                        <canvas id="registerBarcode" width="230" height="100"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </article>
    <article id="areaSearch">
        <div id="toEdit" class="row-fluid">
            <div class="span6">
                <?php include 'formulario.php'; ?>
            </div>
            <div class="span6">
                <div class="contentBarcode">
                    <div class="codigoBarras">
                        <header><h4>Código de barras generado!</h4></header>
                        <canvas id="editBarcode" width="115" height="70"></canvas>
                    </div>
                    <a href="#" class="btn btn-primary">Guardar</a>
                </div>
            </div>
        </div>
    </article>
</section> 
```

**CSS**

```
.row-fluid .span6:nth-child(1) {
    padding-left: 10%;
} 
```

例如，对于上面的 css：第一个 span6 的第一个“row-fluid”有 10% 的填充，但是第一个 span6 的第二个“row-fluid”没有它，会发生什么？如果是同一种风格。

如果我想要第二个 span6 每个“row-fluid”都有 margin-left: 0; 也不起作用 单独放置第一个“行流体”，但第二个没有。

另一个问题是当我尝试将任何样式应用于#toEdit 的第一个 span6 时：

```
#toEdit div:first-child{
    padding-left: 10%;
 } 
```

它应该适用于第一个 span6 但观察 chrome 和 firefox 开发工具中的代码，我意识到顶级样式适用于：/

**固定的**

问题是：使用 JS 在第二个“row-fluid”之前添加 H3，并且引导程序不允许在“row-fluid”div 和“spanN”div 之间放置任何元素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:35:11.180

**固定的**

问题是：使用 JS 在第二个“row-fluid”之前添加 H3，并且引导程序不允许在“row-fluid”div 和“spanN”div 之间放置任何元素

无论如何感谢@Miljan Puzović

# drupal - Drupal 7 用户/角色 - 创建一系列包含其他角色的角色

> ID：16004925
> 
> 赞同：0
> 
> 时间：2013-04-14T22:06:47.620
> 
> 标签：drupal, permissions, roles, account

这是我第一次使用 Drupal 构建网站，我仍在学习我可以用它做的所有事情。

我试图找出一种方法来配置由权限定义的角色组成的第二级用户角色。该站点的用户将是具有各种头衔的组成员，例如：经理、秘书、网络管理员等。这些头衔中的每一个都将在站点内承担责任。尽管与这些标题相关的用户发生了变化，但我希望在站点中重新配置它以尽可能简单（对于不熟悉 Drupal 的人来说）。

我正在考虑根据每个标题的职责将权限配置为内容编辑器、文件上传器等角色。然后我需要一个额外的角色编辑页面（可能是自定义的），该页面将显示与权限/角色类似的表格，但将带有角色/标题，站点管理员可以轻松地获取具有说秘书头衔的人并轻松地为他们提供以下能力：编辑日期，或上传文件等。

这将很容易，因为站点管理员只会看到为站点使用定义的标题和能力，而不必梳理整个权限列表。

第二个问题是我如何为用户分配标题。理想情况下，这与在用户帐户页面中分配角色相同​​。

有什么建议/想法吗？？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:00:50.703

处理这个问题的更 Drupal 风格的方法是将您的个人角色（“内容编辑器”、“文件上传者”）设置为角色并为每个用户分配多个角色。因此，您无需将例如“经理”头衔获得“内容编辑器”和“文件上传者”角色，而是将这两个角色直接分配给用户，并完全避免“经理”头衔的概念。

另一个明显的选择是将您的标题设置为角色，这意味着“经理”角色获得了原本授予“内容编辑器”和“文件上传者”的所有权限。

这两种方法都避免了两级角色的概念，因为这并不是 Drupal 真正应该如何工作的，所以走这条路会为您省去很多痛苦。

# javascript - Highcharts 将 x 轴时间转换为本地时间

> ID：16004926
> 
> 赞同：10
> 
> 时间：2013-04-14T22:06:50.673
> 
> 标签：javascript, highcharts

我有一个图表需要根据用户的本地时间显示服务器正常运行时间。UTC 是不可接受的，因为它需要显示用户的计算机时间。

有没有办法将 x 轴时间转换为本地时间？我当前的输入看起来像这样：

```
[UNIX_TIMESTAMP,1], [UNIX_TIMESTAMP, 2], ... 
```

如果在 highcharts 中不可能，我将如何将上面的 UTC 转换为用户的本地时间（即偏移 UNIX_TIMESTAMP）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-15T13:27:09.187

您可以在全局选项中将 useUTC 设置为 false：

[http://api.highcharts.com/highcharts#global.useUTC](http://api.highcharts.com/highcharts#global.useUTC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T23:11:11.360

以下是如何在 Javascript 中以分钟为单位获取与 UTC 的本地时区偏移量

```
var d = new Date();
var tzOffset = d.getTimezoneOffset(); 
```

一旦你有了它，你只需从你的 UNIX_TIMESTAMP 中减去它，就是这样。

此外，您可能需要考虑不将每个数据点的时间值传递给 Highcharts，而是使用[pointStart 和 pointInterval](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-pointstart-datetime/)系列属性，然后只传递数据。

# c++ - 向量的向量是否可以因为元素之一被重新分配而重新分配？

> ID：16004932
> 
> 赞同：6
> 
> 时间：2013-04-14T22:07:54.580
> 
> 标签：c++, stdvector

假设我有一个向量向量：

```
vector< vector<int> > table; 
```

我知道如果向量没有足够的容量，它可以重新分配。
我想知道如果我这样做是否有可能重新分配向*量表*：

```
table[i].resize(1000); 
```

*重新分配table[i]*是否也可能重新分配*table*？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T22:09:31.830

不会。这不会导致`table`.

唯一调用的运算符/函数`table`是`[]`运算符，它承诺恒定时间。如果发生重新分配，这将违反恒定时间承诺。

您可以更改子向量（`table[i]`s）的向量大小而不需要在顶级向量中分配额外空间的原因是向量的存储是通过指向内存块的指针进行管理的。因此，增加向量使用的元素数量实际上并不会改变向量*对象*的大小。

`table[i].size()`改变而不改变`sizeof(table[i])`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-14T22:16:52.127

不，它不会有任何影响：在大多数情况下，向量的实现是基于数组的（这几乎是向量的概念），尽管这在语言规范中并没有一成不变。无论如何，向量的动态特性排除了数据结构中内联的任何形式的序列，即。类管理的元素序列`vector`不能在`vector`类内部，但必须是位于其他地方的一块内存，在类中有一个指针。

因此，您的数据类型类似于指向动态数组的指针的动态数组。重新分配一个指向数组不会对指针数组产生影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T22:10:48.833

不，因为 的内容`table`没有改变 - 它仍然包含与以前完全相同的实例。只有存储`table[i]`需要重新分配。`vector`包含指向存储的指针 - 矢量对象的大小始终相同，只有引用的数组可以增长或缩小。因此， table[i] 没有增长，如果这就是你所问的 - 只有它指向的数组是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T22:14:36.860

不会。调用 a`vector`元素的方法不会影响它`vector`本身。

将其视为以下调用：parent_object.child_object.Method()，其中 child_object 对 parent_object 一无所知。Method() 不能改变 parent_object 的状态。

向量的向量也是如此。（从技术上讲，这里存储了一个指向数组的指针数组。调整其中一个子数组的大小是一项本地操作，会更改相应的指针，但不会更改父数组的大小。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-14T22:17:18.887

不，这不可能发生。`resize`不会改变向量*对象*的大小——它只会改变向量*管理*的动态存储。因此，从外部向量的角度来看，所有元素都保持不变（并且具有相同的小尺寸）。

# actionscript-3 - 错误 #2136：swf 包含无效数据

> ID：16004940
> 
> 赞同：0
> 
> 时间：2013-04-14T22:08:24.993
> 
> 标签：actionscript-3, flash

```
 public function starttank(event:MouseEvent):void
    {
        var Tankdrive:TankDrive = new TankDrive();
        Tankdrive.tankstart();
    } 
```

这是说该函数中的某些内容包含无效数据。

我不知道它是什么，我检查了 TankDrive 和 tankstart(); 两者都是正确的， tankstart() 是一个公共函数......

我被难住了...

编辑：错误：错误 #2136：SWF 文件 file:///C|/Users/BigRed/Desktop/TankDrive/TankDrive.swf 包含无效数据。在主菜单/starttank()

这就是错误...

而上面的 starttank() 函数还是一样的……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:47:50.517

问题是您的实例名称也是类名称（并且编译器假定您打算引用后者）。您可能打算将 TankDrive 变量称为“tankDrive”，因此将代码片段更改为以下内容可能会有所帮助：

```
public function starttank(event:MouseEvent):void
{
    var tankdrive:TankDrive = new TankDrive();
    tankdrive.tankstart();
} 
```

通常并建议所有公共变量名称以小写字母开头，私有变量以下划线开头，类名以大写字母开头，尽管这不是由语言本身强制执行的，所以这种事情可能会发生。

以下是一些关于常规变量和函数命名的指南，可以帮助您跟踪每个变量和函数应该做什么：

[http://www.adobe.com/devnet/actionscript/learning/as3-fundamentals/variables.html](http://www.adobe.com/devnet/actionscript/learning/as3-fundamentals/variables.html) [http://www.adobe.com/devnet/actionscript/learning/as3-fundamentals/functions.html](http://www.adobe.com/devnet/actionscript/learning/as3-fundamentals/functions.html)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:34:46.323

好的，我查看了文件。

我对你想要做什么感到困惑。

您的 Document 类是 TankDrive，它会创建一个 mainmenu 实例，当您单击一个按钮时，它会创建另一个 TankDrive 实例。这不是我认为您想要做的，或者您认为它允许您访问您的文档类。 - 它不是。它试图创建一个全新的游戏实例。

简而言之，您的设计没有意义，并且还与导致该错误的文档类发生冲突。

快速的解决方案是不要在主菜单类中为单击设置 EventListener 和处理程序，然后调用文档类的 tankstart() 方法，而不是尝试创建 TankDrive 的新实例。

首先将该侦听器移动到文档类中并像这样修改：

```
main.enterTank.addEventListener(MouseEvent.CLICK, starttank); 
```

然后将您的处理程序移动到 TankDrive 类并修改如下：

```
public function starttank(event:MouseEvent):void
{
         tankstart();
} 
```

这不是做到这一点的唯一方法，也不是我真正想做的方式。但我认为讨论超出了这个问题的范围。

如果您愿意，可以通过prototype.in.training@gmail.com 与我联系以获取更多详细信息。

# javascript - 给 div 图片标题

> ID：16004941
> 
> 赞同：0
> 
> 时间：2013-04-14T22:08:27.027
> 
> 标签：javascript, html

是否可以从其中的图像标题中为 div 提供一个 ID。这样任何上传到没有 id 的空 div 的图像 div.id 将使用 js 复制图像标题

示例将 OSCAR 传递到 div id

```
<div id="">
<img src="images/image/image.png" title="OSCAR"/>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T22:27:37.953

考虑到这个问题没有被标记`jQuery`，都`img`应该有一个`title`属性。

[http://jsfiddle.net/eC3DE/](http://jsfiddle.net/eC3DE/)

```
var images = document.querySelectorAll('div > img'),
    i = 0,
    len = images.length,
    img;

for (; i < len; i++) {
    img = images[i];
    img.parentNode.id = img.title;
} 
```

*请注意，每次将图像添加到`DOM`. 如果您使用的是支持[MutationObserver](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)对象的现代浏览器，则可以使用它来检测何时添加了新图像。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:15:29.307

包括 jQuery 并使用此代码设置 div id：

```
$(function(){
  $("div > img[title]").each(function(){
   var parent = this.parentNode;
   if(!parent.id)parent.id=this.title;//if id is empty, set id from title
 })
}) 
```

或者你可以采取 div 这样：

```
$("img[title='OSCAR']").parent("div"); 
```

# css - 如何根据 x2 视网膜尺寸创建适用于 Android 和 iOS 浏览器的单个 CSS

> ID：16004944
> 
> 赞同：1
> 
> 时间：2013-04-14T22:08:31.323
> 
> 标签：css, web, mobile-website

Mobile Safari 将我所有的 CSS 尺寸乘以 2，所以如果我编写一个高度为 44 像素的顶栏，它在 iOS 上显示为我想要的，但在 Android chrome 上只有一半大小。

如何编写适用于两种浏览器的 CSS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T23:01:04.397

如果您使用 Grunt 进行编译，您可以简单地创建两个目标 CSS 文件，android.css、iOS.css - 并使用参数字典编译每个文件

{因子：1}，{因子：2}，

这样，将创建具有两个不同维度的 2 个 css 文件。

# c++ - 阻止“const”成员在另一个别名下被编辑

> ID：16004960
> 
> 赞同：3
> 
> 时间：2013-04-14T22:09:46.183
> 
> 标签：c++, constants, alias, abstract, member

我有一个带有`const`抽象成员的类。由于它是抽象的，因此对象必须位于更高的范围内。但是，它可以在这个更高的范围内进行编辑。我已经制作了这个 MWE，并添加了解释我想要达到的目标的评论（即我知道这并没有达到我想要的目标）。

除了注释掉它之外，还可以做些什么来阻止用户编辑对象。最好是一个白痴证明方法（最好是编译错误）

```
#include <iostream>

class Foo
{
    private:
        const int * p_abstract_const;   
        //int my application this is a pointer to abstract object
    public:
        Foo(const int * p_new_concrete_const)
        {
            p_abstract_const  = p_new_concrete_const;
        }

        void printX()
        {
            std::cout << *p_abstract_const << std::endl;
        }
};

int main()
{
    int concrete_nonconst = 666;
    Foo foo(&concrete_nonconst);    // I want this NOT to compile
  //const int concrete_const(1);
  //Foo foo(&concrete_const);       // only this should compile 
    foo.printX();
    concrete_nonconst=999;          // so that this will NOT be possible
    foo.printX();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T21:06:49.340

您可以在不提供实现的情况下将非常量 int* 构造函数设为私有：

```
class Foo
{
    private:
        const int * p_abstract_const;   
        //int my application this is a pointer to abstract object
        Foo(int * p_new_concrete_const);

    public:
        Foo(const int * p_new_concrete_const)
        {
            p_abstract_const  = p_new_concrete_const;
        }
        void printX()
        {
            std::cout << *p_abstract_const << std::endl;
        }
};
int main()
{
    int concrete_nonconst = 666;
    Foo foo(&concrete_nonconst);    // This won't compile
    const int concrete_const(1);
    Foo foo(&concrete_const);       // But this will
    foo.printX();

    concrete_nonconst=999;          // so that this will NOT be possible
    foo.printX();
} 
```

# asp.net-mvc-3 - ASP.Net MVC 3 时间戳为空

> ID：16004963
> 
> 赞同：1
> 
> 时间：2013-04-14T22:10:21.050
> 
> 标签：asp.net-mvc-3, concurrency, timestamp

我构建了我的第一个 MVC 项目并且在处理并发方面遇到了问题。在我决定添加并发处理之前，Web 应用程序运行良好（添加、编辑和删除）。

```
 //Entity class Line
public class Line
{
    [Key]
    [Required(ErrorMessage = "Please enter a line name")]
    public string Name { get; set; }

    [Required(ErrorMessage = "Please enter a Business Unit name")]
    public string BU { get; set; }

    [Required(ErrorMessage = "Please enter a Department name")]
    public string Department { get; set; }

    [Required(ErrorMessage = "Please enter a location of the line")]
    public string Location { get; set; }

    [Required(ErrorMessage = "Please enter a target output")]
    [Range(0.01, double.MaxValue, ErrorMessage = "Please enter a positive target output")]
    public int TargetOutput { get; set; }

    [Required(ErrorMessage = "Please enter a target yiel")]
    [Range(0.01, 1.00, ErrorMessage = "Please enter a positive number in range of 0.01 to 1.00")]
    public Double TargetYield { get; set; }

    [Timestamp]
    public Byte[] Timestamp { get; set; }
} 
```

来自控制器的代码：

```
// Saves changes to the Line
    [HttpPost]
    public ActionResult Edit(Line line)
    {
        if (ModelState.IsValid)
        {
            repository.SaveLine(line);
            TempData["message"] = string.Format("{0} has been saved", line.Name);
            return RedirectToAction("Index");
        }
        else
        {
            // return to lines list if there is something wrong with the data
            return View(line);
        }
    } 
```

来自实体框架存储库类的代码（这部分代码尚未完成，在发生并发的那一刻，它应该只是用数据库中的时间戳替换时间戳并再次保存）：

```
 // Save changes to the line or create new one if not exists
    public void SaveLine(Line line)
    {
        // Checking if line with the same name already exists

        //Line found = Lines.FirstOrDefault(l => l.Name == line.Name);
        string found = Lines
            .Select(l => l.Name)
            .Where( n => n == line.Name)
            .SingleOrDefault();

        if (found == null)
        {
            context.Lines.Add(line);
        }
        else
        {
            context.Entry(line).State = System.Data.EntityState.Modified;
        }

        //context.SaveChanges();

        try
        {
            context.SaveChanges();
        }
        catch (DbUpdateConcurrencyException ex)
        {
            var entry = ex.Entries.Single();
            var dbvalues = (Line)entry.GetDatabaseValues().ToObject();
            line.Timestamp = dbvalues.Timestamp;
            context.SaveChanges();
        }

    } 
```

当我仅在一个选项卡中运行应用程序并尝试编辑线实体时，我收到此错误：

存储更新、插入或删除语句影响了意外数量的行 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。

我已经调试并检查了时间戳值，它为空。但在数据库中是 0x0000000000000814。当在下一步中时间戳被替换为数据库中的时间戳并尝试再次保存时，它会引发相同的异常。

我不知道我在哪里犯了错误，非常感谢任何帮助

对不起我的英语。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:36:04.873

您需要将时间戳写到视图中，以确保它返回到您的实体中。

Html.HiddenFor(o=>o.Timestamp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T08:24:13.520

它在我运行单个应用程序实例时起作用，但是当我运行其中两个来测试并发性时。我得到了我已经处理并用数据库中的时间戳替换时间戳的异常，但即使两个时间戳相同，也会再次引发相同的异常：从即时窗口：

```
?line.Timestamp
{byte[8]}
[0]: 0
[1]: 0
[2]: 0
[3]: 0
[4]: 0
[5]: 0
[6]: 70
[7]: 81
?dbValues.Timestamp
{byte[8]}
[0]: 0
[1]: 0
[2]: 0
[3]: 0
[4]: 0
[5]: 0
[6]: 70
[7]: 81 
```

这是为什么？它不仅应该在时间戳不同时引发异常吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T12:59:00.267

已解决：看起来当我尝试在代码中再次保存时，它实际上仍然持有带有旧时间戳的旧对象。我已将 try catch 语句移至控制器并更改为替换时间戳并在并发发生时返回编辑视图。现在，当用户再次按下保存时，不会抛出异常并保存数据。

# postgresql - 在 tie 的情况下，在 postgresql 中对每列使用不同的标准进行排序

> ID：16004966
> 
> 赞同：21
> 
> 时间：2013-04-14T22:10:44.060
> 
> 标签：postgresql, sorting

我在 postgresql 中排序有问题。信息必须按照第一列降序排序，但如果出现平局，信息必须按照第二列升序排序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-14T22:26:45.260

`SELECT ... ORDER BY col1 DESC, col2 ASC`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-14T22:27:09.863

```
select *
from t
order by c1 desc, c2 asc 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-14T22:22:29.187

当然。

[http://www.postgresql.org/docs/9.2/static/sql-select.html#SQL-ORDERBY](http://www.postgresql.org/docs/9.2/static/sql-select.html#SQL-ORDERBY)

> ORDER BY 子句使结果行根据指定的表达式进行排序。*如果根据最左边的表达式，两行相等，则根据下一个表达式进行比较，依此类推。*

然后

> *可以选择在 ORDER BY 子句中的任何表达式之后*添加关键字 ASC（升序）或 DESC（降序） 。

 *多一个：

> 请注意，排序选项仅适用于它们遵循的表达式；例如 ORDER BY x, y DESC 与 ORDER BY x DESC, y DESC 的含义不同。

强调，我自己的。*

# php - 在php中自动重写URL

> ID：16004968
> 
> 赞同：-1
> 
> 时间：2013-04-14T22:11:04.617
> 
> 标签：php, function

我想知道是否有一个预先存在的 PHP 函数将重写给定的 URL，添加预定义的应用程序上下文。例如：我有一个这样的链接：

```
<a href="/">Home</a> 
```

我希望这个链接在生产环境下指向“/”，但在开发环境下它应该指向“/app_context/”。是否有任何 PHP 函数可以为我做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-14T22:26:52.590

您始终可以通过更改生产卷的文档根目录来更改生产服务器上的服务器配置以匹配实时服务器（除非您在像 Bluehost 或类似的共享主机上）。这也有例外......示例：

`BluehostDomain1.com`根是`/`

如果您使用 bluehost 托管第二个域，则它是第一个域的子目录（并且可访问）。

`BluehostDomain2.com`root`/`默认情况下，也可以在`/BluehostDomain1.com/BluehostDomain2.com`.

在这些情况下，我会这样做：

使代码查找执行它的域：

```
<?php
    switch ($_SERVER['SERVER_NAME']){
        case "production.server.com":
        $dR = '/';
        break;

        default:
        //Dev server dev.server.com
        $dR = '/app_context/';

    }

    $code = '<a href="$dR">Home</a>';
    $code .= '<a href="'.$dR.'about/">About</a>'; // /about/
    echo $code;
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-14T22:34:24.663

我通常定义一个 WEBROOT 常量来保存这个值，然后将它添加到所有链接：

```
define('WEBROOT', str_replace('//', '/', dirname($_SERVER['SCRIPT_NAME']) . '/'));

<a href="<?php echo WEBROOT ?>">Home</a>
<a href="<?php echo WEBROOT ?>about/">About</a> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T02:21:00.367

问题解决了。我意识到我可以只使用相对路径。例如：

```
<a href="./index.html">Home</a> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-14T22:28:56.927

你可以使用类似的东西：

```
<?php
if(/* test for developement environement */) {
    echo '<a href="/app_context/">Home</a>';
}
else {
    echo '<a href="/">Home</a>';
}
?> 
```

# oracle - 使用 dblink 创建表作为选择不会移动所有行

> ID：16004971
> 
> 赞同：0
> 
> 时间：2013-04-14T22:11:26.617
> 
> 标签：oracle, oracle11g

我们正在从 amazon ec2 数据库迁移到 amazon rds 数据库。大多数表都很小，可以使用 sql developer 复制命令移动，但有几个更大（3M+ 记录）。为了加快速度，我在两个系统之间创建了数据库链接。那些工作正常。然后我运行了以下命令：

```
create table schema.tablename as select * from schema.tablename@ec2db; 
```

ec2db 是旧数据库。那里的表包含 3,503,064 条记录。但是，NEW 数据库表仅包含 3,454,685 条记录。在 create table 语句期间未生成任何错误。这是可重复的（即：我删除表并再次运行它，它会加载相同数量的记录。）

任何想法为什么会发生这种情况？为什么我做选择（*）时表的内容与我做创建表时同一个表（完全指定）的内容不同？

# jquery - jQuery：加载后立即删除容器

> ID：16004972
> 
> 赞同：0
> 
> 时间：2013-04-14T22:11:33.700
> 
> 标签：jquery

我正在开发一个带有一些 div 的单页网站。这些 div 包含一些内容，例如 iframe。如果 js/jquery 不可用，此内容是后备文本。现在我想删除这些 div 的一些内容，一旦它们准备好，用一些动态创建的内容替换它。

示例：包含用于谷歌日历的 iframe 的 div。此 iframe 应替换为同一日历的 $.getJson 调用的生成内容。

我怎么做？是

```
$('div#calendar').ready(function(){ 
  $('div#calendar').remove('iframe')
}); 
```

够早吗？jquery的标签应该放在`script`哪里，目前它在正文的末尾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:13:42.470

您可以尝试`$('div#calendar').html(<new content>)`getJson 的成功回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T22:45:23.027

对于绝对没有 JS 可用的实例，您可以使用[noscript 。](http://www.w3schools.com/tags/tag_noscript.asp)

```
<script src="url"></script>
<noscript>
  <!-- Your iFrame -->
</noscript> 
```

如果您想要更多控制，请查看例如[Modernizr](http://modernizr.com/)的特征检测方法。

或者在[此处](https://stackoverflow.com/questions/2170484/shouldnt-we-use-noscript-tag)查看有关使用或不使用 noscript 标签或替代方法的一些想法。最受青睐的方法似乎是有一个`display:none;`块，然后`display:block;`由 JS 设置，反之亦然，用于非 JS 页面。

# php - PHP邮件脚本未发送到我的电子邮件

> ID：16004973
> 
> 赞同：0
> 
> 时间：2013-04-14T22:11:37.863
> 
> 标签：php

我已经设置了一个表格，而不是按下图像提交按钮时，它将填写的表格发送到商务电子邮件。

这是我用于从我的 html 链接的 php 的脚本。

```
<?php
if(isset($_POST['submit'])) {
$emailbody = 'First Name = '.$_POST['Name']."\n"
.'Surname = '.$_POST['SName']."\n"
.'Email = '.$_POST['email']."\n"
.'Contact Number = '.$_POST['tel_no']."\n"
.'Adress Line 1 = '.$_POST['address_line_1']."\n"
.'Adress Line 2 = '.$_POST['address_line_2']."\n"
.'Town/City = '.$_POST['town_city']."\n"
.'County = '.$_POST['county']."\n"
.'Post Code = '.$_POST['Post_code']."\n"
.'Newsletter = '.$_POST['newsletter']."\n"
.'Events = '.$_POST['events']."\n"
mail('My email@gmail.com', 'Order Form', $emailbody);

    } else {
header('location: Payment.html');
    }
?> 
```

html 上的表单已通过操作链接。脚本有什么问题吗？

PS 在按下图像时，它会被转发到贝宝支付页面。

干杯

编辑：这是 HTML 代码：

```
 <form name="form1" method="post" action="PaymentFormmail.php" align="left">
    <section>
    <h1>Basic Infomation:</h1>
     <p>
    <label for="SName">First Name:</label>
    <input type="text" name="Name" id="Name" style="margin-left:50px;">
  </p>
  <p>
    <label for="SName">Surname:</label>
    <input type="text" name="SName" id="SName" style="margin-left:64px;">
    </p>
     <p>
      <label for="email">Email Address</label>
      <input type="text" name="email" id="email" style="margin-left:28px;">
  </p>
  <p>
    <label for="tel_no">Contact Number:</label>
    <input type="text" name="tel_no" id="tel_no" style="margin-left:14px;">
  </p>
</section>
<section>
<h1>Billing Infomation:</h1>
  <p>
    <label for="address_line_1">Address line 1:*</label>
    <input name="address_line_1" type="text" id="address_line_1" align="right" style="margin-left:20px;">
  </p>
  <p>
    <label for="address_line_2">Address Line 2: </label>
    <input type="text" name="address_line_2" id="address_line_2"style="margin-left:20px;">
  </p>
  <p>
    <label for="town_city">Town/City:*</label>
    <input type="text" name="town_city" id="town_city"style="margin-left:55px;">
  </p>
  <p>
    <label for="county">County:*</label>
    <input type="text" name="county" id="county"style="margin-left:73px;">
  </p>
  <p>
    <label for="Post_code">Post Code:*</label>
    <input type="text" name="Post_code" id="Post_code"style="margin-left:46px;">
  </p>
<h1>News and Events:</h1>
<p>
  <input name="newsletter" type="checkbox" id="newsletter" value="Yes">
  <label for="newsletter">I wish to receive the monthly newsletter from Monster Computers UK</label>
</p>
<p>
  <input name="events" type="checkbox" id="events" value="Yes">
  <label for="events">I wish to receive any infomation about upcomming events</label>
</p>

  </section>
</form>

<p>By Clicking Pay now you agree to the Terms of Service</p>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
                    <input type="hidden" name="cmd" value="_xclick">
                    <input type="hidden" name="business" value="monstercomputeruk@gmail.com">
                    <input type="hidden" name="lc" value="GB">
                    <input type="hidden" name="item_name" id="byoName" value="0">
                    <input type="hidden" name="amount" id="finalpaypal">
                    <input type="hidden" name="currency_code" value="GBP">
                    <input type="hidden" name="button_subtype" value="services">
                    <input type="hidden" name="no_note" value="0">
                    <input type="hidden" name="bn" value="PP-BuyNowBF:btn_buynowCC_LG.gif:NonHostedGuest">
                    <input name="submit" type="image" onClick="MM_validateForm('Name','','R','SName','','R','email','','R','address_line_1','','R','town_city','','R','county','','R','Post_code','','R');return document.MM_returnValue" src="images/buttons/Pay Now.png" alt="PayPal — The safer, easier way to pay online." border="0">
                    <img alt="" border="0" src="https://www.paypalobjects.com/en_GB/i/scr/pixel.gif" width="1" height="1">
                    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:17:47.403

尝试改变

```
if(isset($_POST['submit'])) 
```

至

```
if(isset($_POST['SName'])) 
```

我认为 $_POST['submit'] 不起作用。如果这也失败了，那么这意味着信息没有发送到您的脚本。在这种情况下，向我们展示您在脚本中使用的表单的 html。

**编辑**

[使用 if(isset($_POST['submit'])) 在脚本打开时不显示回显不起作用](https://stackoverflow.com/questions/7775512/using-ifisset-postsubmit-to-not-display-echo-when-script-is-open-is-not)

**在 HTML 之后编辑**

在您的名为 MM_validateForm 的 javascript 函数中，使用 jquery POST 将您的信息发送到您的邮件脚本并删除 if 子句检查 if isset。

```
$.post("test.php", { name: "John", time: "2pm" } ); 
```

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/) 请参阅示例部分。

# sql - IPN 请求查询字符串

> ID：16004974
> 
> 赞同：0
> 
> 时间：2013-04-14T22:11:41.337
> 
> 标签：sql, vb.net, paypal, paypal-ipn, request.querystring

在 PayPal 中，我设置了 notify_url，它运行良好。

但是我想捕获 QueryString，例如 tx、amt 和 item_number

我将以下 SQL 命令放入验证部分

SqlCommand("UPDATE ElyPartyInvoices SET TransactionID = '" & Request.QueryString("tx") & "', TotalPaid = " & Request.QueryString("amt") & ", Status = 'Paid' WHERE id = " & Request. QueryString("item_number"), conn)

已经在另一个环境中测试了代码并且工作正常，那么我如何在 IPN 中捕获 tx、amt 和 item_number 呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-18T16:55:31.317

实际上，我不知道 vb.net，但我确信所有语言的 PayPal IPN 响应都是相同的。

PayPal IPN 在 post 方法中向“notify_url”发送响应。

如果您想获取使用以下变量的 IPN 响应：

```
Transactin Id = txn_id,
Amount = mc_gross_1,
Item Number = item_number,
Item Name = item_name 
```

如果您获得所有使用 POST 变量的事务变量来使用所有变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T22:54:00.233

帖子是必需的。不幸的是，大公司忘记了他们是初学者，使他们的样品很难理解

# ruby - 子类中的实例变量访问

> ID：16004975
> 
> 赞同：1
> 
> 时间：2013-04-14T22:11:43.107
> 
> 标签：ruby, inheritance

我希望有人可以阐明我在下面收到的错误。我在父类中定义了一个实例变量，`Node`并希望在子类中访问和修改它`AddSubNode`，每当我尝试访问时，都会`@code`收到此错误：

```
'code': undefined method `<<' for nil:NilClass (NoMethodError) 
```

我一定是误解了 Ruby 的继承模型，但我认为我可以做到这一点。

```
class Node
  attr_accessor :code

  def initialize
    @code = []
  end
end

class AddSubNode < Node
  def initialize op, l, r
    @op = op
    @l  = l
    @r  = r
  end

  def code
    @code << 1 # error: `code': undefined method `<<' for nil:NilClass (NoMethodError)
    @code
  end

  def to_s
    "#{@l} #{@op} #{@right}"
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T22:14:20.953

您需要在子类的初始化程序中调用超级初始化程序。

```
class AddSubNode < Node
  def initialize op, l, r
    super()
    @op = op
    @l  = l
    @r  = r
  end
... 
```

编辑：忘记括号

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T22:18:34.763

当您`initialize`在子类中重新定义方法时，您会覆盖原来的方法。因此，实例变量`@code`永远不会被初始化，并且当您调用`@code << 1`.

`super()`从子类中的方法调用`initialize`（有效地调用它的父类）或利用`@code << 1 unless @code.nil?`是解决错误的几种方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T06:36:47.797

这里我只是试着给你一些可视化来测试这样的场景。

```
class Node
  attr_accessor :code

  def initialize
    @code = []
  end
end

class AddSubNode < Node
  def initialize op, l, r
    @op = op
    @l  = l
    @r  = r
  end

  def code
    @code << 1 # error: `code': undefined method `<<' for nil:NilClass (NoMethodError)
    @code
  end

end

ob = AddSubNode.new(1,2,3)
p ob.instance_variables #=> [:@op, :@l, :@r]
p ob.instance_variable_defined?(:@code) #=> false
p ob.instance_variable_set :@code,[12] #=> [12]
p ob.instance_variable_defined?(:@code) #=> true
p ob.instance_variable_get :@code #=> [12]
p ob.instance_variables #=> [:@op, :@l, :@r, :@code]
p ob.code #=> [12, 1] 
```

# json - 将嵌套列表转换为 json 会产生多余的数组

> ID：16004978
> 
> 赞同：3
> 
> 时间：2013-04-14T22:12:05.083
> 
> 标签：json, scala, playframework-2.0

我有一些历史数据，我想将其转换为 json。所以这些是列表列表。它们的类型是 List[List[Position]] 其中 Position 是一个简单的案例类。我写了一个格式化程序来帮助 Json.toJson 应对。我期待一个带有两个内部数组的外部数组的输出，每个内部数组包含 3 个对象。我得到的是这个。请注意额外的数组包装。

```
[[[[{"amount":1.0,"minAmount":2.0,"price":3.0,"volume":4.0},
{"amount":5.0,"minAmount":6.0,"price":7.0,"volume":8.0},
{"amount":9.0,"minAmount":10.0,"price":11.0,"volume":12.0}]],
[[{"amount":0.1,"minAmount":0.2,"price":0.3,"volume":0.4},
{"amount":5.0,"minAmount":6.0,"price":7.0,"volume":8.0},
{"amount":9.0,"minAmount":10.0,"price":11.0,"volume":12.0}]]]] 
```

我不知道包装数组来自哪里。有人可以帮我吗？这是我正在使用的包装器的测试：

```
class ApplicationSpec extends Specification {

  implicit object PositionFormat extends Format[List[List[Position]]] {
    def writes(historyList: List[List[Position]]) : JsValue = {
      Json.arr(historyList.map{
        o => Json.arr(o.map{ p =>
          Json.obj(
            "amount"    -> JsNumber(p.amount),
            "minAmount" -> JsNumber(p.minAmount),
            "price"     -> JsNumber(p.price),
            "volume"    -> JsNumber(p.volume)
          )
        })
      })
    }
    def reads(json: JsValue): JsResult[List[List[Position]]] = ???
  }

  "Application" should {

    "Convert position data to json" in {
      val l1 = ListBuffer(new Position(1.0D,2.0D,3.0D,4.0D),
        new Position(5.0D,6.0D,7.0D,8.0D),
        new Position(9.0D,10.0D,11.0D,12.0D)).toList
      val l2 = ListBuffer(new Position(0.1D,0.2D,0.3D,0.4D),
        new Position(5.0D,6.0D,7.0D,8.0D),
        new Position(9.0D,10.0D,11.0D,12.0D)).toList
      val obj = ListBuffer(l1,l2).toList
      val json = Json.toJson(obj)
      var string: String = json.toString()
      println(string)
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T04:42:07.437

似乎`Json.arr`接受它的参数并`JsValue`为它们的 JSON 数组返回一个。看起来您可以简单地使用`Json.toJson`：

以下`arr`是使用方法：

```
// Json.arr
Json.arr("one", "two")
// Gives you
// play.api.libs.json.JsArray = ["one","two"] 
```

如果您改为：

```
// vs
val l = List("one", "two")
Json.arr(l)
// Gives you
// play.api.libs.json.JsArray = [["one","two"]]
// ... a nested array, which is what you don't want. 
```

你需要的是：

```
// Json.toJson
Json.toJson(l)
// Gives you:
// play.api.libs.json.JsValue = ["one","two"] 
```

# django - 安装特定版本的 django

> ID：16004979
> 
> 赞同：5
> 
> 时间：2013-04-14T22:12:13.210
> 
> 标签：django

我正在尝试使用 pip 安装 django 1.4.3。我在跑步

```
$ sudo pip unistall django
$ sudo pip install django==1.4.3 
```

我在安装过程中收到以下消息

```
 Requested django==1.4.3, but installing version 1.5.1 
```

如果需要，我可以提供更多代码。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-21T05:30:29.510

我在安装 Twisted 时遇到了同样的问题。需要 10.0.0 但安装 13.0.0，最后我得到 10.0.0 包并下载 src，手动安装它。只需将[https://pypi.python.org/pypi/Twisted/](https://pypi.python.org/pypi/Twisted/) **13.0.0**更改为[https://pypi.python.org/pypi/Twisted/](https://pypi.python.org/pypi/Twisted/) **10.0.0**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-28T14:33:52.300

一个简单的解决方案是创建一个`requirements.txt`文件：

```
pip freeze > requirements.txt 
```

然后，手动更改*requirements.txt文件中的 django 版本：*

```
Django==1.4.3 
```

最后运行命令：

```
pip install -r requirements.txt 
```

您应该拥有所需的 Django 版本。

干杯!

# powershell - Powershell命令仅复制文本文件

> ID：16004984
> 
> 赞同：2
> 
> 时间：2013-04-14T22:12:30.370
> 
> 标签：powershell

我正在尝试编写一个 Powershell 命令来识别和仅从该目录的目录和子目录中复制文本 (.txt) 文件。有谁知道是否有可以执行此任务的命令。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T00:29:07.273

如果您不担心维护可以使用的目录结构

```
Get-ChildItem *.txt -recurse | Copy-Item -destination c:\qwerty 
```

如果您想维护可以使用的目录结构

```
Copy-Item  -Recurse -Filter *.txt  -path c:\temp -destination c:\asdf 
```

注意。
PowerShell`get-help`命令非常有用，除了通配符之外它确实有用。
ie
`get-help *copy*`为您提供可能对您有用的命令列表。
`get-help Copy-Item -full`为您提供所有参数以及使用示例。

# c++ - 是否可以使用浏览器扩展从网页中获取文本并以某种方式将其放入我的 c++ 程序中？

> ID：16004985
> 
> 赞同：0
> 
> 时间：2013-04-14T22:12:38.063
> 
> 标签：c++, google-chrome-extension, firefox-addon

我正在为我的算法类编写一个程序，该程序应该能够遍历网页，找到一个随机地址，然后使用浏览器扩展程序（Firefox/Chrome），它应该在谷歌地图上搜索该地址。从字面上看，我只是认为也许尝试使用扩展来捕获文本并将其放入文本文件中，然后让我的程序读取该文本文件将是一个好主意，但我不知道如何实现。

到目前为止我的代码（别担心，在 Window UI 之后，它会变长。这只是一个测试控制台应用程序）：

```
#include <iostream>
#include <cstdlib>
#include <stdlib.h>
#include <windows.h>

using namespace std;

int main ()
{
  string address;

  cout << "Please input address: ";
//cin >> address;
  getline(cin, address); 
//word_list = getRecursiveURLs(url, DEPTH)
//return cleaner(word_list) 

//string address = "Houston, Tx ";
  std::string str = "http://mapof.it/" + address;
//cout << mapSearch;
  const char * c = str.c_str();

  ShellExecute(NULL, "open", c, NULL, NULL, SW_SHOWNORMAL);     
} 
```

现在，我的代码接受一个地址并将其添加到“Mapof.it”网址的末尾，该网址基本上启动了 GMaps 搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:08:42.017

看起来用户正在与您的 C++ 程序进行交互。它不需要与浏览器进度通信。

您可以从 C++ 程序发送 http 请求，获取响应文本，然后解析它。

首先，您尝试查找网站是否提供返回 json/xml 格式的 api url，因为 json/xml 更容易解析。例如，谷歌地图确实提供[了 api](https://developers.google.com/maps/)。

如果不行，尝试用正则表达式解析html，或者找一些DOM句柄库用DOM解析。

如果您的结果文本不能从原始文本中提取，它是由 JavaScript 动态创建的，您可以找到一些“无头浏览器”库来帮助您。

如果您需要一个全功能的浏览器，请使用 QT，它提供了 QtWebkit 小部件。

# css - 缩放时如何禁用 CSS3 过渡？

> ID：16004990
> 
> 赞同：1
> 
> 时间：2013-04-14T22:13:21.010
> 
> 标签：css

当我在元素的宽度/高度或上/右/下/左上使用 CSS3 过渡，并使用或调整页面缩放`CTRL``+`时，浏览器会为这些属性的更改设置动画。`CTRL``-``CTRL``0`

有没有办法使用这些过渡，但阻止浏览器仅在缩放时使用它们？

编辑：

示例 HTML：

```
<div></div> 
```

示例 CSS：

```
div {
    background:red;
    height:200px;
    width:200px;
    -moz-transition:1s;
    -webkit-transition:1s;
    transition:1s;
}

div:hover {
    height:300px;
    width:300px;
} 
```

代码也可以在[jsFiddle](http://jsfiddle.net/fireman_biff/uUNbH/)上找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:53:22.160

我想到了一种解决方法，它使用 Javascript 在`CTRL`按下时禁用转换。它处理上面列出的键盘快捷键以及 `CTRL`+scrollwheel，但仅在文档具有焦点时。

它无法处理使用菜单启动的缩放，但总比没有好。

HTML

```
<div></div> 
```

CSS：

```
div {
    background:red;
    height:200px;
    width:200px;
    -moz-transition:1s;
    -webkit-transition:1s;
    transition:1s;
}

div:hover {
    height:300px;
    width:300px;
}

.zooming {
    -moz-transition:0s;
    -webkit-transition:0s;
    transition:0s;   
} 
```

jQuery：

```
$(document)
.keydown(function(e) { if (e.ctrlKey) { $('div').addClass('zooming'); }})
.keyup(function(e) { $('div').removeClass('zooming'); }); 
```

更新[了 jsFiddle](http://jsfiddle.net/fireman_biff/uUNbH/1/)。到目前为止只在 Chrome 中测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T17:13:06.513

试试这个解决方案：

[http://jsfiddle.net/995zE/](http://jsfiddle.net/995zE/)

它通过在单击按钮时添加过渡 css 来工作，当您缩放浏览器窗口时，它会删除该 css。

这适用于 Firefox、Chrome 和 IE 10。在 Firefox 和 IE 上，当您缩放时，过渡照常继续，并且缩放不会影响它。在 Chrome 上，转换快进到其最终状态。

HTML：

```
<button id="decrease_width">- width</button>
<button id="increase_width">+ width</button>
<div id="test"></div> 
```

CSS：

```
div#test
{
    width: 100px;
    height: 100px;
    border: 1px solid red;
}

div#test.transition
{
    transition: width 2s ease;
    -webkit-transition: width 2s ease;
    -moz-transition: width 2s ease;
    -o-transition: width 2s ease;
} 
```

JavaScript：

```
var transition_class = 'transition';

var $test = jQuery('#test');

function transition_test(width) {
    $test.addClass(transition_class).css('width', $test.width() + width);
}

jQuery("#decrease_width").click(function () {
    transition_test(-50);
});

jQuery("#increase_width").click(function () {
    transition_test(50);
});

jQuery(window).resize(function () {
    $test.removeClass(transition_class);
}); 
```

# android - 首次登录时无法设置某些 facebook 权限

> ID：16004995
> 
> 赞同：0
> 
> 时间：2013-04-14T22:14:00.530
> 
> 标签：android, facebook, permissions

我正在制作一个将与 facebook 集成的应用程序。我必须有权访问用户的friends_requests，所以我必须请求“read_requests”权限，现在这很复杂，我一直在尝试两种方式：1）使用LoginButton

```
LoginButton button = new LoginButton(this);
button.setReadPermissions(Arrays.asList("read_requests")); 
```

2）使用会话：

```
Session.OpenRequest openrequest = new Session.OpenRequest(this);
openrequest.setPermissions(Arrays.asList("friend_requests"));
openrequest.setCallback(statusCallback);
session.openForRead(openrequest); 
```

两种方式我都可以登录应用程序，但它不要求额外的权限。我注意到，当我尝试获取电子邮件权限（“电子邮件”而不是“read_requests”）时，它工作正常。我知道，我可以通过以下方式获得额外的权限：

```
Session.NewPermissionsRequest request = new Session.NewPermissionsRequest(Nowa.this, Arrays.asList("friend_requests"));
session.requestNewReadPermissions(request); 
```

但是我想从一开始就访问friend_requests，有什么办法吗？感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T01:22:05.927

我刚刚使用 (2) 进行了尝试，它工作正常：对话框显示为“TestApp 想要访问您的公共个人资料和请求”。对于所有读取权限，您应该只能在 Android 上看到一个对话框，即使它是扩展权限。因此，如果您得到不同的东西，您应该确保您没有授予此权限 - 如果您这样做了，您可以将其从您的 facebook 帐户设置中删除并尝试再次登录。