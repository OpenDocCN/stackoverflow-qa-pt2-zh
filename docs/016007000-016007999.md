# StackOverflow 问答 16007000-16007999

# c# - 在 UpdatePanel 中向面板添加控件

> ID：16007003
> 
> 赞同：0
> 
> 时间：2013-04-15T02:54:47.307
> 
> 标签：c#, asp.net, updatepanel

我在 UpdatePanel 中有一个面板、一个按钮和一个文本框。

```
<asp:UpdatePanel ID="updatepanel1" runat="server">
<ContentTemplate>
    <asp:TextBox ID="commentBox" Rows="1" Columns="60" placeholder="Add a comment..." TextMode="MultiLine" ClientIDMode="Static" runat="server"></asp:TextBox>  
    <asp:LinkButton ID="commentButton" runat="server" OnClick="commentButton_Click"> CommentButton   </asp:LinkButton>
    <asp:Panel ID="commentPanel" runat="server"></asp:Panel>   
</ContentTemplate>
</asp:UpdatePanel> 
```

on Button Click 我正在尝试将 TextBox 中的内容添加到面板中，如下所示

```
Literal myComment = new Literal();
myComment.Text = "<p>"+commentBox.Text+"</p><br />";
commentPanel.Controls.Add(myComment); 
```

这会添加当前在 TextBox 中的内容，但会删除面板中的内容。因此，每次从 0 开始计数面板中的控件。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:52:44.550

你可以看看这个：

```
List<Literal> persistControls = new List<Literal>();
protected void Page_Load(object sender, EventArgs e)
{
    // if you already have some literal populated
    if (Session["persistControls"] != null)
    {
        // pull them out of the session
        persistControls = (List<Literal>)Session["persistControls"];
        foreach (Literal ltrls in persistControls)
            commentPanel.Controls.Add(ltrls); // and push them back into the page
    }
}

protected void commentButton_Click(object sender, EventArgs e)
{
    Literal myComment = new Literal();
    myComment.Text = "<p>" + commentBox.Text + "</p><br />";
    commentPanel.Controls.Add(myComment);
    persistControls.Add(myComment);// add it to the list
    Session["persistControls"] = persistControls; // put it in the session
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:54:26.223

```
 Literal comment = new Literal();
    comment.Text="";

    Panel1.Controls.Add(comment);
    if (Panel1.Controls.Contains(comment))
    {
        comment.Text = comment.Text + "<p>" + commentbox.Text + "</p>";
    } 
```

# ios - DrawRect：如何在给定一组有序点的情况下填充多边形？

> ID：16007004
> 
> 赞同：0
> 
> 时间：2013-04-15T02:54:58.350
> 
> 标签：ios, objective-c, cocoa-touch, drawrect

目前在我的`drawRect:`方法中，我在我的点集中的每个点之间画一条线，每个点都表示为`CGPoint`; 但是，现在我想填写这些设定点区域内的区域。我不知道如何使用quartz api来做到这一点，有没有办法？

现在，积分是有序的。因此可以识别出哪个点代表多边形的第一个点等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T02:59:43.977

将您的点添加到 UIBezierPath ，然后使用它的填充方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:07:39.397

[Apple 的](http://developer.apple.com/library/ios/#samplecode/QuartzDemo/Listings/Quartz_QuartzPolygons_m.html#//apple_ref/doc/uid/DTS40007531-Quartz_QuartzPolygons_m-DontLinkElementID_32)此代码示例显示了您需要执行的操作：

```
-(void)drawInContext:(CGContextRef)context
{
    // Drawing with a white stroke color
    CGContextSetRGBStrokeColor(context, 1.0, 1.0, 1.0, 1.0);
    // Drawing with a blue fill color
    CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1.0);
    // Draw them with a 2.0 stroke width so they are a bit more visible.
    CGContextSetLineWidth(context, 2.0);

    CGPoint center;

    // Add a star to the current path
    center = CGPointMake(90.0, 90.0);
    CGContextMoveToPoint(context, center.x, center.y + 60.0);
    for(int i = 1; i < 5; ++i)
    {
        CGFloat x = 60.0 * sinf(i * 4.0 * M_PI / 5.0);
        CGFloat y = 60.0 * cosf(i * 4.0 * M_PI / 5.0);
        CGContextAddLineToPoint(context, center.x + x, center.y + y);
    }
    // And close the subpath.
    CGContextClosePath(context);

    // Now add the hexagon to the current path
    center = CGPointMake(210.0, 90.0);
    CGContextMoveToPoint(context, center.x, center.y + 60.0);
    for(int i = 1; i < 6; ++i)
    {
        CGFloat x = 60.0 * sinf(i * 2.0 * M_PI / 6.0);
        CGFloat y = 60.0 * cosf(i * 2.0 * M_PI / 6.0);
        CGContextAddLineToPoint(context, center.x + x, center.y + y);
    }
    // And close the subpath.
    CGContextClosePath(context);

    // Now draw the star & hexagon with the current drawing mode.
    CGContextDrawPath(context, drawingMode);
} 
```

请注意，这是在[对类似问题](https://stackoverflow.com/questions/7175886/how-to-fill-a-shape-defined-with-cgpoints-with-gradient-in-ios)的回答中提到的。

# python - 更改 while() 循环内的操作顺序

> ID：16007009
> 
> 赞同：1
> 
> 时间：2013-04-15T02:55:27.850
> 
> 标签：python

我是 python 新手，目前正在上课，我的程序看起来像：

```
if choice=="1":
    def addition():
        print("You are doing addition. X+Y=Z")
        X = int(input("Enter X:"))
        Y = int(input("Enter Y:"))
        sum = X + Y
        print ("your total is:")
        print (sum)

    Well = "y"
    while Well == "y":
        again = input("Would you like to go again? (y/n)")
        if again == "y":
            addition()
        if again == "n":
            project()
        else:
            print("sorry re-enter choice") 
```

在显示实际添加部分之前，它会询问我是否要再去一次。我该如何解决？谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:07:39.193

有很多方法，但你可以`addition()`像这样把你的函数放在顶部：

```
Well = "y"
while Well == "y":
    addition()
    again = input("Would you like to go again? (y/n)")
    if again == "n":
        project()
    if again not in ("n", "y"):
        print("sorry re-enter choice") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T02:59:45.460

`false`只需添加一个在第一次运行时从变为的标志`true`，这样您就不会在第一次运行时看到“再次”语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T02:59:58.463

几点：

*   您不应将**`sum`**其用作变量名。它是一个内置的 Python。
*   查看您用于循环检查的变量，您会很快注意到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T03:05:33.523

我认为在你做完你的事情之后，问你是否想在循环结束时再去一次会更有意义：

```
while loop_condition:
    #do_your_stuff:
    bla bla bla

    #see if you should go again
    bla bla = raw_input("Do you want to go again") 
```

事实上，99% 的时间你的 while 循环都会遵循这种模式（检查条件、运行循环体、更新条件），如果你以不同的顺序做事（比如在运行主体之前更新条件）它通常是表明你可能做错了什么。

# css - 是否有任何非响应式 CSS 框架？如果是，请列出它们

> ID：16007010
> 
> 赞同：2
> 
> 时间：2013-04-15T02:55:34.967
> 
> 标签：css, frameworks, responsive-design

我使用响应式框架为客户开发了一个网站，我们发现他们不喜欢在设备很小的时候改变它，他们希望网站在 iPhone 上看起来和在 Windows PC 上一样。由于我使用的是 Zurb Foundation CSS，我发现很难让它无响应。

现在还有哪些其他 CSS 框架可以允许固定布局？我看到大多数框架现在都说响应式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T09:14:45.327

您还可以使用 twitter 引导程序，只是不包含（排除）包含在 css 文件夹内的包中的响应式 CSS 文件。 [http://twitter.github.io/bootstrap/](http://twitter.github.io/bootstrap/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T02:59:11.577

周围有很多 CSS 框架。如果您不打算支持响应式设计，则可以选择使用[960 Grid](http://960.gs)等固定布局框架。

参考：[CSS 框架的维基百科](http://en.wikipedia.org/wiki/CSS_frameworks)

# zend-framework - Zend 框架插件认证

> ID：16007011
> 
> 赞同：2
> 
> 时间：2013-04-15T02:55:41.817
> 
> 标签：zend-framework, plugins, frameworks

我正在尝试创建一个 ZF1 插件来集中我的身份验证系统。到目前为止，这是我所做的：

```
class Application_Plugin_Auth extends Zend_Controller_Plugin_Abstract {

    private $_whitelist;
    protected $_request;

    public function __construct() {
        $this->_whitelist = array(
            'default'
        );
    }

    public function preDispatch(Zend_Controller_Request_Abstract $request) {
        $this->_request = $request;
        $module = strtolower($this->_request->getModuleName());

        if (in_array($module, $this->_whitelist)) {
            return;
        }

        $auth = Zend_Auth::getInstance();
        if (!$auth->hasIdentity()) {
            $this->_request->setModuleName('admin'); 
            $this->_request->setControllerName('auth');
            $this->_request->setActionName('login');
            return;
        }
    }
} 
```

如果没有记录，它可以完美地避免人们访问后端。现在，我想实现一个**没有参数**`login`的函数，它将获取当前请求，检查参数（**getPost**），然后执行登录工作：

 ****```
public function login(){
    // Here will check the request data and then try to login
} 
```

我的问题是如何在这个函数中获取当前的请求对象？另外，如何在我的控制器中使用这个登录功能？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T14:52:08.623

当您不想将请求作为参数传递给函数时，这就是您想要的：

```
$request = Zend_Controller_FrontController::getInstance()->getRequest();
$postData = $request->getPost(); 
```

但是，通常您确实希望将参数传递给您的函数。主要是因为您希望使用登录功能操作的对象独立于系统的其余部分。只有少数情况下我能想到与这种方法不同意的情况。

当您想`Request`从前端控制器获取时，您可以发出：

```
$request = $this->getRequest(); 
```****

# java - Install4j - 如何在现在是 Mac 文件夹的 Mac 上卸载以前打包的应用程序？

> ID：16007015
> 
> 赞同：2
> 
> 时间：2013-04-15T02:56:04.070
> 
> 标签：java, macos, installation, install4j

在我们之前的版本中，Mac OS 的安装程序类型是“Mac OS X 单一捆绑包”，但现在由于不断变化的需求，我正在使用“Mac OS X 文件夹”。问题是我需要删除旧的应用程序，但我似乎做不到。

我尝试使用“卸载以前的安装”操作，但这似乎没有任何作用。我怀疑这与安装类型发生了变化有关。

然后我尝试创建一个“删除文件和目录”操作并使用：

```
${installer:sys.installationDir}\..\ApplicationName.app 
```

其中 ApplicationName 是我们的应用程序名称。但是，这似乎也不起作用。我已将“文件过滤器脚本”和“目录过滤器脚本”设置`return true;`为以及我已检查标记为“递归”。

我浏览了文件夹，也找不到`installation.log`用于诊断问题的文件。

**更新：**以下是日志文件的结果（已编辑 ApplicationName.app）：

```
[INFO] com.install4j.runtime.beans.actions.files.DeleteFileAction [ID 3184]: Execute action
       Property rollbackSupported: true
       Property backupForRollback: true
       Property showFileNames: true
       Property showProgress: false
       Property recursive: true
       Property files: [/Applications/LandlordMax/../ApplicationName.app]
       Property directoryFilter: I4jScript_Internal_5
       Property fileFilter: I4jScript_Internal_6
[ERROR] com.install4j.runtime.beans.actions.files.DeleteFileAction [ID 3184]: Execute action not successful after 22 ms 
```

我看到该操作存在错误，但我似乎无法获得更多详细信息。至少没有什么可以解决的问题，我试图`cd`通过从 installation.log 文件中复制和粘贴文件位置值到目录中，并且它存在并且有内容。我也可以使用`rm -rf`和路径从终端中删除它。

并且`Action elevation type`设置`Elevate to maximum priviledges`为该操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T08:46:47.387

“Mac OS X 单一包”媒体类型没有卸载程序（用户只需将包拖到垃圾箱），因此“卸载上一个”操作将不起作用。

使用“删除文件和目录”操作是正确的想法。最有可能的是，`${installer:sys.installationDir}\..\ApplicationName.app`没有指向正确的目录。日志文件位于默认隐藏的 .install4j/installation.log 中，因此您要么必须使用终端导航到该文件，要么查看[此处](http://www.macworld.com/article/1051830/showallfinder.html)以在查找器中显示它们。

# javascript - 显示/隐藏开关

> ID：16007016
> 
> 赞同：0
> 
> 时间：2013-04-15T02:56:07.900
> 
> 标签：javascript, css, show-hide, slidetoggle

我有以下代码

```
<input type='radio' name='showhide'></input><input type='radio' name='showhide'></input>
<br/>
<label> Some tips here!</label> 
```

我的要求是，当单选按钮改变时，下面的标签将被显示或隐藏。很容易实现，但我的问题是，随着标签的显示或隐藏，整个页面的布局会发生变化。我认为这是因为标签中的文本比单选按钮长。那我应该怎么做才能防止页面布局的变化呢？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T02:57:47.360

首先，没有`</input>`. 另一件事是你没有给输入赋值。

```
<input type='radio' name='showhide' value="true" />
<input type='radio' name='showhide' value="false" /> 
```

现在，对于交互，`ID`给`<label>`.

```
<label id="tips"> Some tips here!</label> 
```

使用 JavaScript，您可以这样做：

```
<input type='radio' name='showhide' onclick="document.getElementById('tips').style.visibility='visible'" value="true" />
<input type='radio' name='showhide' onclick="document.getElementById('tips').style.visibility='hidden'" value="false" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:02:54.657

使用 CSS 可见性

```
<input type='radio' name='showhide' onclick="document.getElementById('tip').style.visibility='visible';" />
<input type='radio' name='showhide' onclick="document.getElementById('tip').style.visibility='hidden''" value="false" />

<label id="tip"> Some tips here!</label> 
```

# linux - iptables 将端口转发到另一个网络

> ID：16007017
> 
> 赞同：0
> 
> 时间：2013-04-15T02:56:22.793
> 
> 标签：linux, iptables, portforwarding

我有一个运行 CentOS 的 VDS，它有两个接口：eth0 和 ham0。eth0 是我的 WAN 接口，具有可从 Internet 访问的外部 IP，ham0 是小型 VPN 网络（Logmein Hamachi）的接口。

VPN网络中有三台机器，其中一台是我家的一台linux机器，它在80端口运行Apache。这台机器在ISP的NAT后面，从外面看不到。我想在我的 VDS 上创建一条规则，将来自 Internet（eth0 接口）的端口 8081 的连接转发到我的 VPN 网络中的这个 linux 盒子。像这样的东西：

```
[Internet]   --->  [VDS server with public IP]  --->  [Apache server inside VPN] 
```

我使用了以下规则：

```
iptables -t nat -A PREROUTING -p tcp -d *external_ip* --dport 8081 -j DNAT --to *internal_ip*:80
iptables -A FORWARD -p tcp -d *internal_ip* --dport 80 -j ACCEPT
iptables -t nat -A POSTROUTING -p tcp --dst *internal_ip*  -j LOG --log-level warning --log-prefix "[REQUEST_FORWARDED]" 
```

但它不起作用。我可以在 /var/log/messages 中看到“REQUEST_FORWARDED”消息，但是当我进入`http://my_eternal_ip:8081/`浏览器时，它会尝试连接主机很长时间，然后显示服务器没有响应的消息。

什么会导致这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T08:52:00.103

我想你需要确保“/proc/sys/net/ipv4/ip_forward”已经启用，如果没有

```
echo 1 > /proc/sys/net/ipv4/ip_forward 
```

以上命令可以帮助您允许 IP 转发。

希望这对你有帮助。

# python - 如何判断未定义的变量是否在 Python 列表中？

> ID：16007018
> 
> 赞同：1
> 
> 时间：2013-04-15T02:56:23.167
> 
> 标签：python

这段代码给了我一个错误，我如何检查变量是否在列表中？

```
TomMarks = [66,54,34,79]
JackMarks = [66,54,34,79]
myList = [TomMarks, JackMarks]

if KateMarks in myList:
    print("yes")
else:
    print("no") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:04:01.887

如果 Python 首先不知道某物是什么，它就无法检查某物是否在列表中。（通常，如果您尝试引用尚未定义的变量，则会出现错误。）

在您的示例中，即使您定义`myList = [TomMarks, JackMarks]`了 ，如果您打印列表，您也会得到：

```
[[66, 54, 34, 79], [66, 54, 34, 79]] 
```

如果您`KateMarks`事先定义，那么是的，代码将完美运行。但如果变量未定义，Python 将不知道要检查什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T03:04:30.553

您需要在使用它之前定义一个变量。你告诉编译器“KateMarks”，它不知道它是什么——你认为它会怎么做？

这个：

```
TomMarks = [66,54,34,79]
JackMarks = [66,54,34,79]
myList = [TomMarks, JackMarks]

KateMarks = 1

if KateMarks in myList:
    print("yes")
else:
    print("no") 
```

工作正常并打印“否”。

您可能想要的是首先检查变量是否存在：

```
if 'KateMarks' in locals(): 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T03:19:09.983

您可以通过字典来代替列表，如下所示：

```
myList = {'TomMarks':[66,54,34,79], 'JackMarks':[66,54,34,79]}

if 'KateMarks' in myList:
    print("yes")
else:
    print("no") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T03:10:19.223

如果您真的想打印`no`即使`KateMarks`未定义，您可以执行以下操作，但这不是一个好方法。

```
TomMarks = [66,54,34,79]
JackMarks = [66,54,34,79]
myList = [TomMarks, JackMarks]

try:
    if KateMarks in myList:
        print 'yes'
    else:
        print 'no'
except(NameError):
    print 'no' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-15T03:11:00.840

Python 变量名是对对象的引用。因为 KateMarks 没有引用任何东西，所以 Python 会引发 NameError 异常。

命名空间内省可以通过`locals()`或`dir()`

```
'KateMarks' in dir() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T03:32:53.810

Do you mean you're writing some sort of code where you'll get Kate's marks somewhere else in the program, and then check if the marks are in it?

Or actually, on second thought I think the whole list-in-a-list and marks idea is just a distraction... you really mean to ask if you can use a variable name in a similar fashion to a string, right? If that's the case, there's a somewhat not-so-efficient way to do what I think you're trying to do, using `dict`:

```
marks = {} # a Python dictionary
marks["Tom"] = 1234123412512352345
marks["Jack"] = 2394872394857389578935

if "Kate" in marks:
    print("Kate is a key in marks.")
else:
    print("Kate isn't a key, but at least now we know that we didn't get Kate's marks.") 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-15T03:43:59.157

If variable is **undefined** you just simply check if it is undefined. No undefined variables can be in any list:

```
if not 'undefined_variable' in dir():
   print "NO WAY!" 
```

# php - php范围解析运算符

> ID：16007023
> 
> 赞同：0
> 
> 时间：2013-04-15T02:57:55.333
> 
> 标签：php, oop

为什么这会返回“严格标准”通知？：

```
'Strict Standards: Non-static method main::i() should not be called statically in...'

class main
{
    public function __construct()
    {
        echo "in main class";
    }
    public function i()
    {
        echo "i in main";
    }
}

class secondary extends main
{
    public static function tom()
    {
        parent::i();
    }
}

secondary::tom(); 
```

我合法地调用了一个静态方法，其中包含对父类中非静态方法的调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:07:54.720

该通知告诉您不应在静态方法中调用非静态方法。

您可以检查方法`i()`，如果`$this`没有出现在该方法中，您可以考虑更改`i()`为静态方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:11:31.170

您已经自己回答了这个问题 - 当您`tom()`静态调用时（这很好），`i()`不是静态的。

非静态`i()`假设您有一个对象的实例，因此可能会尝试访问属性或执行需要实例的其他操作。因此，它不应该被静态调用，甚至不能从子类的静态方法中调用。例如，考虑对您的代码进行以下轻微更改：

```
class main
{
    var something = 0;
    public function __construct()
    {
        echo "in main class";
    }
    public function i()
    {
        $this->something++;
        echo "i in main";
    }
}

class secondary extends main
{
    public static function tom()
    {
        parent::i();
    }
}

secondary::tom(); 
```

这是一个严格的警告——这意味着如果你愿意，你可以选择忽略它——但它告诉你，你所做的通常不是好的做法，你可能应该重新考虑你的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T03:11:57.800

```
class main
{
    public function __construct()
    {
        echo "in main class";
    }
    public static function i()
    {
        echo "i in main";
    }
}

class secondary extends main
{
    public static function tom()
    {
        parent::i();
    }
}

secondary::tom(); 
```

它应该是什么样子，请注意我已将函数转换`i();`为静态函数，然后可以合法地调用它`parent::i();`

但执行：

```
 public static function tom()
    {
        $this->i();
    } 
```

将返回：

> 致命错误：不在对象上下文中使用 $this

所以你的赌注是完全静止，或者不是静止的。

一个决议：

```
class main
{
    public function __construct()
    {
        echo "in main class";
    }
    public function i()
    {
        echo "i in main";
    }
}

class secondary extends main
{
    public function tom()
    {
        $this->i();
    }
}

$Class = new secondary();
$Class->tom(); 
```

# ios - 如何获取父视图控制器的类

> ID：16007040
> 
> 赞同：0
> 
> 时间：2013-04-15T03:00:40.217
> 
> 标签：ios, modalviewcontroller, parentviewcontroller

我有一个视图控制器A，它呈现有一个模态segue，它呈现一个`UINavigationController`作为根视图控制器的另一个视图控制器B。

如何从视图控制器 B 中知道视图控制器 A 的类？

最好使用代表作为最后的手段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:08:08.813

尝试这个

```
if ([self.navigationController.presentingViewController isKindOfClass:[ViewControllerA class]){
       //do stuff
    }
    else{
       //it's view controller b, do stuff
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:06:01.557

一种解决方案是为控制器 A 覆盖`UINavigationController`并添加一个弱属性。然后您可以从控制器 B 访问该属性，并获取其类名。

# php - 然后在查询中使用 PHP + Format 数组

> ID：16007047
> 
> 赞同：0
> 
> 时间：2013-04-15T03:01:45.313
> 
> 标签：php, mysql, arrays, format

假设我执行这样的查询：

```
$charsnamequery = mysql_query("SELECT * FROM 'bookstable' WHERE 'bookcharactersname' = 'JHON'") 
```

这将返回一个资源，然后我将其放入一个数组并用于打印如下结果：

```
while ( $fullist = mysql_fetch_array( $charsnamequery ))
{ Print "book title: ".$fullist['id_book'] . ", book author:".$fullist['book_author'] . "
.....etc etc etc";
 } 
```

所以，假设现在我想做的是：在我的数据库中搜索过去对任何 id_book 表现出兴趣的客户并收集他们的电子邮件。

我知道我应该以某种方式重新格式化数组，**以便**我可以执行新的查询，例如：

```
$newquery = mysql_query("SELECT 'email' FROM 'customerstable' WHERE 'id_book_interested_in' IN ($value1,$value2,$value3....etc etc etc)" 
```

希望你能帮我解决这个问题！提前谢谢你！

PS：我宁愿不加入查询，即使我可以尝试逐步学习。-

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:03:09.690

查询不起作用的原因是因为您将表名和列名用单引号括起来。

```
SELECT * FROM bookstable WHERE bookcharactersname = 'JHON' 
```

这些是标识符而不是字符串文字。在这种情况下，反引号是可选的，因为它们都不是保留关键字。

*   [MySQL - 何时使用单引号、双引号和反引号？](https://stackoverflow.com/questions/11321491/mysql-when-to-use-single-quotes-double-quotes-and-backticks)

# windows - 如何执行批处理文件来复制和重命名文件？

> ID：16007048
> 
> 赞同：1
> 
> 时间：2013-04-15T03:01:47.283
> 
> 标签：windows, batch-file, xcopy

我正在尝试创建一个批处理文件以将“文件夹”作为备份复制到新目的地。但是，我需要添加文件名的日期戳。

例如文件夹是 myFolder 当我复制它时我想命名为 myFolder_todays_date

我希望能够复制文件夹及其内容。

我找到了 xCopy，但我不确定如何正确编写它。

现在我尝试了 xCopy /e/i dir newDir

如何将日期附加到文件夹名称？

感谢您对如何正确编写此批处理文件的帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:19:52.150

```
@echo off
mkdir %1%DATE%
xcopy /s %1 %1%DATE% 
```

这接受文件夹的名称作为命令行参数。

例如，如果上面的批处理文件名为 bkup.bat 并且您想要备份一个名为 work 的目录，您可以将其运行为

```
bkup.bat work 
```

它将它复制到当前目录中。您可以接受第二个命令行参数 (%2)，如果您想复制到不同的目录，也可以使用它

```
xcopy /s %1 %2\%1%DATE% 
```

# javascript - 使用 javascript 突出显示文本

> ID：16007050
> 
> 赞同：2
> 
> 时间：2013-04-15T03:02:04.197
> 
> 标签：javascript, html, regex

我想在给定的段落中加粗一个单词。这是一个javascript代码。

```
 var hlWord = "idm";
        var nregex = new RegExp(hlWord,"gi");
        var div = document.getElementById("SR").innerHTML;
        var rword = div.replace(nregex,"<b>"+hlWord+"</b>");
        document.getElementById("SR").innerHTML = rword; 
```

这是一个 HTML 代码。

```
<div id="SR">
Download here free idm.
<a href="http://www.anywebsite.com/idm">click here to download</a>
</div> 
```

这很好用，并使所有 idm 粗体，但这里有一个问题，它也将 url 更改为这样

```
<a href="http://www.anywebsite.com/<b>idm</b>">click here to download</a> 
```

这不是一个有效的 url。这是此代码使 url 损坏的问题。请告诉我如何避免这种情况。
谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:52:55.193

[您可以使用此线程](https://stackoverflow.com/questions/2579666/getelementsbytagname-equivalent-for-textnodes)中的方法遍历所有文本节点，更改它们并用新的粗体替换它们。

```
var hlWord = "idm";
var nregex = new RegExp(hlWord,"gi");

var sr = document.getElementById('SR');

function escape_html(html) {
    return html.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

(function findTextNodes(current) {
    // make a shadow copy of the child nodes.
    var current_children = Array.prototype.slice.call(current.childNodes);
    for(var i = 0; i < current_children.length; i++) {
        var child = current.childNodes[i];
        // text node
        if(child.nodeType == 3) {
            var value = escape_html(child.nodeValue);
            var html = value.replace(nregex, '<b>' + hlWord + '</b>');
            if (html != value) {
                var node = document.createElement('div');
                node.innerHTML = html;
                // make a shadow copy of the child nodes.
                var childNodes = Array.prototype.slice.call(node.childNodes);
                // replace the plain text node with the bold segments
                for (var j = 0; j < childNodes.length; j++) {
                    var c = childNodes[j];
                    current.insertBefore(c, child);
                }
                current.removeChild(child);
            }
        }
        else {
            findTextNodes(child);
        }
    }
})(sr); 
```

检查[jsFiddle](http://jsfiddle.net/ArieShout/r9Qrr/7/)的代码示例。

**更新**：

*   [路人](https://stackoverflow.com/users/570812/passerby)指出，`innerHTML`应谨慎使用。处理前转义文本 nodeValue。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:53:56.487

经过一些尝试和失败后，我做了一个工作演示，它可能比你想象的要复杂：

[http://jsfiddle.net/4VKNk/](http://jsfiddle.net/4VKNk/)

```
var cache=[];
var reg=/idm/gi;
var id=function(ID){return document.getElementById(ID);}
function walkElement(ele){
    if(ele.childNodes.length>0){
        for(var i=0;i<ele.childNodes.length;i++){
            walkElement(ele.childNodes[i]);
        }
    }else if(ele.nodeType==3){//text node
        if(reg.test(ele.nodeValue)){
            cache.push(ele);
        }
    }
}
id("test").onclick=function(){
    cache=[];
    walkElement(id("SR"));
    while(cache.length>0){
        var ele=cache.shift();
        var val=ele.nodeValue;
        var pnt=ele.parentNode;
        var nextSibling=ele.nextSibling;
        var i=0;
        var r,tmp;
        pnt.removeChild(ele);
        while(r=reg.exec(val)){
            tmp=document.createTextNode(val.substring(i,r.index));
            if(nextSibling){
                pnt.insertBefore(tmp,nextSibling);
                tmp=document.createElement("strong");
                tmp.appendChild(document.createTextNode("idm"));
                pnt.insertBefore(tmp,nextSibling);
            }else{
                pnt.appendChild(tmp);
                tmp=document.createElement("strong");
                tmp.appendChild(document.createTextNode("idm"));
                pnt.appendChild(tmp);
            }
            i=reg.lastIndex;
        }
        if(i<val.length-1){
            tmp=document.createTextNode(val.substring(i,val.length));
            if(nextSibling){
                pnt.insertBefore(tmp,nextSibling);
            }else{
                pnt.appendChild(tmp);
            }
        }
    }
}; 
```

我采用了 DOM 操作的方法。

解释：

1.  遍历目标元素下的整个DOM树，并缓存所有TEXT_NODE( `nodeType==3`)；
2.  使用`RegExp.exec()`方法获取每个匹配的索引；
3.  当您找到匹配项时，添加回它之前的文本，然后添加一个`<strong>`包含匹配项的突出显示元素 ( )；继续这一步；
4.  如果我们仍然有文本，请将其添加回来。

我需要先缓存 TEXT_NODE 的原因是，如果我们直接在 中修改它`walkElement`，它会改变`childNodes.length`它的父节点，并中断进程。

# wpf - 使用代码隐藏从 XAML 访问变量和从 ViewModel 访问对象

> ID：16007054
> 
> 赞同：4
> 
> 时间：2013-04-15T03:02:59.040
> 
> 标签：wpf, xaml, mvvm, windows-phone-7.1

我是 Windows Phone 开发的新手。我想问是否有可能做到这一点。我需要使用后面的代码访问 XAML 中的变量，然后将其作为项目添加到在我的视图模型中找到的现有列表中。因此，我需要访问我的视图模型以获取列表和 XAML 以从资源中获取变量。

这是可行的吗？如果是，我该如何访问它。这就是我当前的 XAML 中的内容。

```
<phone:PhoneApplicationPage.Resources>
  <system:String x:Key="scanName">SCAN</system:String>
</phone:PhoneApplicationPage.Resources> 
```

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T06:53:28.030

您正在尝试做的是对 MVVM 的所有内容的严重违反，但有可能......

使用视图代码隐藏中的以下行，您可以...

...访问资源字符串：

```
var scanName = this.Resources["scanName"]; 
```

...访问 ViewModel：

```
var vm = DataContext as MyViewModel;
if (vm == null) return;
vm.ScanHistory.Add(scanName); 
```

话虽如此，你真的不应该这样做。MVVM 的理念是将 ViewModel 和 View 完全解耦，让 WPF 绑定机制为您将它们连接在一起。在您的情况下，据我所知，您应该将扫描名称存储在其他地方，作为资源或配置值，在 ViewModel 中获取它并在 ViewModel 上提供 View 可以绑定的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:34:36.987

I haven't near winphone app so i make simple example on wpf(it's similiar with winphone).

//write string value from dynamic resource into textblock

```
 <TextBlock FontSize="14" Text="{DynamicResource scanName}"/> 
```

//changing resource in codebehind (`this` is Window in my example)

```
 this.Resources["scanName"] = "new value"; 
```

As my mind you scenario is veru specific.Try to read about bindings. May be bindings will be more useful in your scenario.

# ruby-on-rails - 如何在管理员批准后允许推文通过？

> ID：16007058
> 
> 赞同：0
> 
> 时间：2013-04-15T03:03:16.163
> 
> 标签：ruby-on-rails, ruby, twitter

我有一个 Rails 3 应用程序，我允许用户发帖。这些帖子还使用 Twitter gem 发布到他们的 Twitter 帐户中。

Posts 表内部有一个“验证”列，默认为 false，但是某些帖子将被标记为 true。我有这个，所以某些帖子必须由管理员用户验证。

下面是 schema.db 代码的样子：

```
create_table "posts", :force => true do |t|
    t.text     "content"
    t.integer  "user_id"
    t.boolean  "verify",          :default => false 
```

这是我的控制器`verify`内部定义的方式：`Posts`

```
def verify
  @post = post.find(params[:id])
  @post.verify = false
  @post.save
  redirect_to "/verify"
end 
```

我正在尝试在内部添加以下两行的变体，`verify`以便管理员可以使用它。它在发布帖子的用户调用它时起作用，但在管理员尝试时不起作用。我得到一个`undefined method 'update' for nil:NilClass`.

```
 @twitter_user = current_user.twitter_user
  @twitter_user.update(@post.content) 
```

这是如何`twitter_user`定义的：

```
def twitter_user
    provider = self.authentications.find_by_provider('twitter')
    Twitter::Client.new(:oauth_token => provider.token, 
                        :oauth_token_secret => provider.secret)
  rescue
    return nil
  end 
```

应该如何更改下面的代码，以便我可以将其放入内部`verify`以便管理员可以运行它，同时允许帖子转到每个发布者的 Twitter 帐户？

```
 @twitter_user = current_user.twitter_user
  @twitter_user.update(@post.content) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:25:15.793

鉴于您当前正在加载基于 的 twitter 用户`current_user`，如果您以管理员身份运行它，它可能会尝试将推文发布为属于管理员。您应该能够通过将用于发布推文的代码更改为：

```
@twitter_user = User.find(@post.user_id).twitter_user
@twitter_user.update(@post.content) 
```

# clojure - 在 Incanter、Clojure 中快速更新矩阵元素的方法？

> ID：16007062
> 
> 赞同：1
> 
> 时间：2013-04-15T03:04:17.803
> 
> 标签：clojure, incanter

假设我有一个 3x3 矩阵

```
(def myMatrix (matrix (range 9) 3))
; A 3x3 matrix
; -------------
; 0.00e+00  1.00e+00  2.00e+00 
; 3.00e+00  4.00e+00  5.00e+00 
; 6.00e+00  7.00e+00  8.00e+00 
```

我可以使用 $ 来获取一个元素，比如第二行第一列

```
($ 1 0 myMatrix) ; --> 3 
```

是否有任何 API 方法可以快速更新元素然后返回矩阵？例如

```
(update-matrix-by-element 2 1 myMatrix 4)
; A 3x3 matrix
; -------------
; 0.00e+00  1.00e+00  2.00e+00 
; 4.00e+00  4.00e+00  5.00e+00 
; 6.00e+00  7.00e+00  8.00e+00 
```

我能找到的最接近的 API 方法是[bind-rows](http://clojuredocs.org/incanter/incanter.core/bind-rows)和[bind-columns](http://clojuredocs.org/incanter/incanter.core/bind-columns)，我当前使用这两种方法的函数版本是

```
;note i j starts from 1 rather than 0 
(defn update-matrix-by-element [i j myMatrix value]  
    (if (or (> i  (count (trans myMatrix))) (> j  (count  myMatrix)) (< i 1) (< j 1)  (not (integer? i)) (not (integer? j)))
      myMatrix
      (let [n (count myMatrix)
        m (count (trans myMatrix))
        rangeFn #(if (== %1 %2)  %1 (range %1  %2 ))
        m1 (if (==    (dec i) 0) []
             ($ (rangeFn 0 (dec i)) :all myMatrix))
        m2   (if (==  i  m) []
               ($ (rangeFn  i m)  :all myMatrix))
        matrixFn  #(if (matrix? % ) % [ %])
        newRow  (if (==   (dec j) 0) 
                  (bind-columns    [value]    (matrixFn ($  (dec i) (rangeFn   j   n ) myMatrix)))
                  (if (== j n )
                    (bind-columns  (matrixFn ($  (dec i) (rangeFn 0  (dec j) ) myMatrix))  [value]   )
                    (bind-columns  (matrixFn ($  (dec i) (rangeFn 0  (dec j) ) myMatrix))  [value]    (matrixFn ($   (dec i) (rangeFn   j    n ) myMatrix))))
                  )
    ]  

   ;  (prn " m1 " m1 ) (prn  " m2 " m2 ) (prn " newrow " newRow)

    (bind-rows m1 newRow m2)))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:08:26.133

如果您的意思是性能意义上的“快速”，那么您可能会查看[core.matrix](https://github.com/mikera/matrix-api)，它旨在支持快速可变矩阵运算。

使用[vectorz-clj](https://github.com/mikera/vectorz-clj)实现的示例`core.matrix`：

```
(def M (matrix [[1 2] [3 4]]))
=> #<Matrix22 [[1.0,2.0][3.0,4.0]]>

(mset! M 0 0 10)
=> #<Matrix22 [[10.0,2.0][3.0,4.0]]>

(time (dotimes [i 1000000] (mset! M 0 0 i)))
"Elapsed time: 28.895842 msecs"   ;; i.e. < 30ns per mset! operation 
```

这将比任何需要构建新的可变矩阵的方法都要快得多，尤其是当矩阵变得更大/具有更高的维度时*。*

我正在努力`core.matrix`与 Incanter 巧妙地集成，因此不久之后您应该能够`core.matrix`在 Incanter 中透明地使用矩阵。

# php - 将贝宝纳入我的 PHP 购物车？

> ID：16007070
> 
> 赞同：0
> 
> 时间：2013-04-15T03:05:33.133
> 
> 标签：php, paypal

我正在使用 PHP 构建一个简单的购物车，我希望能够使用 paypal。我想使用这里描述的工具： [https ://www.paypal.com/cgi-bin/webscr?cmd=p/pdn/howto_checkout-outside](https://www.paypal.com/cgi-bin/webscr?cmd=p/pdn/howto_checkout-outside)

这似乎是最简单的方法。我查看了他们的开发页面，真的很困惑，但这是有道理的。我唯一的问题是我被告知更改价格相当容易。现在我可以运行一个脚本来检查从贝宝的回报，以检查他们的订单价格是否与他们的购物车总额相匹配，但我想在它发生之前停止它。我从开发站点得到的一件事是他们的令牌调用。我是否可以通过上述方法提供所有商品，然后进行令牌调用以将这些商品的 ID 和价格链接到按钮，从而构建一个创建立即购买按钮的函数？我只是有点困惑，很多人都说要查看文档，但我很难理解所有这些，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:23:24.197

您只需将具有总数的变量传递给贝宝

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="you@youremail.com">
<input type="hidden" name="item_name" value="Item Name">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="amount" value="$TOTAL">
<input type="image" src="http://www.paypal.com/en_US/i/btn/x-click-but01.gif" name="submit" alt="Make payments with PayPal - it's fast, free and secure!">
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T22:20:28.087

如果您想坚持使用[付款标准](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/wp_standard_overview)，您可以使用[购物车上传方法](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/cart_upload)将所有信息发送到 PayPal 结帐。

不过，如果您对 PHP 感到满意，我建议您使用[Express Checkout API](https://developer.paypal.com/webapps/developer/docs/classic/express-checkout/gs_expresscheckout/)。这将使您在结帐体验中获得更多的释放。

您可能想查看这个[用于 PayPal 的 PHP 类库](http://www.angelleye.com/download-angell-eye-php-class-library-for-paypal/)。这对您来说非常简单。使用该库，只需知道要进行哪些 API 调用，然后使用包含的文件相应地传入您自己的数据。

对于 Express Checkout，您将使用[SetExpressCheckout](https://www.x.com/developers/paypal/documentation-tools/api/getexpresscheckoutdetails-api-operation-nvp)、[GetExpressCheckoutDetails](https://www.x.com/developers/paypal/documentation-tools/api/setexpresscheckout-api-operation-nvp)和[DoExpressCheckoutPayment](https://www.x.com/developers/paypal/documentation-tools/api/doexpresscheckoutpayment-api-operation-nvp)。

# amazon-web-services - 我需要备份 AWS EBS 数据吗？

> ID：16007074
> 
> 赞同：6
> 
> 时间：2013-04-15T03:05:56.913
> 
> 标签：amazon-web-services, backup

我在使用 EBS 存储作为其本地驱动器的 AWS EC2 实例上运行 Web 应用程序。Web 应用程序在 Apache/Tomcat 服务器上运行，在本地存储中处理上传的文件并使用 MySQL 数据库，所有这些都在这个本地驱动器上。AWS 是否保证 EBS 数据的完整性和可用性，还是应该将其备份到 S3？如果是这样，我该怎么做？我需要每天进行增量备份（即我只能承担今天执行的最新事务/文件的损失）。注意：我不担心人为错误（意外删除等），而是系统崩溃、底层服务故障等。谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T03:16:49.207

Amazon 不保证您的 EBS 卷的完整性，但它们很容易备份。只需拍摄每日快照（您可以使用 ec2-api-tools 设置 cron 来进行每日快照）。

EBS 快照存储在 S3 中。它们不在您自己的存储桶中，详细信息由 Amazon 处理，但存储快照的基础设施是 S3。

快照是增量的，并备份整个卷。每个快照都将自上次快照以来的更改存储在设备上，因此经常拍摄它们会减少制作所需的时间，但每个 AWS 账户一次只能拥有有限数量的快照。我认为是 250。您最终需要删除旧快照来处理这个问题。您也可以通过 cron 作业来做到这一点。删除旧快照不会使新快照失效，即使它们存储为增量快照，因为它实际上会在删除时更新下一个最新快照以包含前一个快照的信息。

# r - R，为矩阵的每一行添加一个属性

> ID：16007078
> 
> 赞同：1
> 
> 时间：2013-04-15T03:06:33.143
> 
> 标签：r, matrix, attributes, higher-order-functions

在 R 中，我有一个矩阵：`matClust4`它在执行`kmeans`算法后保存集群 4 中的所有向量。

`matClust4`尺寸为 27 X 31，并`rownames`为每个向量设置了属性。我想做的是为每个行向量赋予另一个属性`matClust4`

我更喜欢使用该`apply`功能。我想尝试这样的事情：

```
apply(matClust4, 1, function(v) SOME_ATTRIBUTE(v) = idClust4)

#where idClust4 is some previous calculated result 
```

1.  我怎样才能创建/使用一个属性`matClust4`来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:47:26.813

`apply`如果已经计算了要分配的值（并且具有与行相同数量的元素），则不需要为此目的使用`matClust4`。您应该只分配一个 R 属性：

```
 attr(matClust4, 'SOME_ATTRIBUTE') = idClust4 
```

这就是 Frank Harrell 为他从 SAS 导入的数据集创建值标签的方式。您确实需要小心，数据帧的重新排序或更改可能会破坏与向量的关联，因为会通过`[<-`or`sort`或强制执行一致性`order`。

# ios - 如何使用叠加调整捕获的图像

> ID：16007080
> 
> 赞同：1
> 
> 时间：2013-04-15T03:06:40.217
> 
> 标签：ios, objective-c, uiimageview, avcapturesession

我想像立方体狗的工作原理一样实时捕获带有叠加层的图像 -按照此处[http://www.musicalgeometry.com/?p=1681](http://www.musicalgeometry.com/?p=1681)**完成下面的代码**

我知道如何在预览层中叠加图像并捕获图像，我查看了 Apple 示例代码，如果在相机胶卷中检测到人脸，它会保存一个红色方框。

**编辑：**

我想将其保存为 1920 X 1080 用于后置摄像头和 1280 X 960，下面的代码可以实时保存叠加层和图像，但是对齐已关闭，我不知道为什么有人可以帮忙？

干杯

![在此处输入图像描述](https://i.stack.imgur.com/Ih0hz.jpg) 这是预览层

![在此处输入图像描述](https://i.stack.imgur.com/a0mrf.png) 这是在捕获之后

```
- (id)init {
    if ((self = [super init])) {
        [self setCaptureSession:[[AVCaptureSession alloc] init]];
        [self.captureSession setSessionPreset:AVCaptureSessionPresetHigh];
    }
    NSLog(@"init called");
    return self;
}

-(void)takePictureWithOverlay:(UIImage*)overlay andRect:(CGRect)overlayRect
{
    // Find out the current orientation and tell the still image output.
    AVCaptureConnection *stillImageConnection = [self.stillImageOutput connectionWithMediaType:AVMediaTypeVideo];

    //UIDeviceOrientation curDeviceOrientation = [[UIDevice currentDevice] orientation];
    // AVCaptureVideoOrientation avcaptureOrientation = [self avOrientationForDeviceOrientation:curDeviceOrientation];

    [stillImageConnection setVideoOrientation:AVCaptureVideoOrientationPortrait];

    [stillImageConnection setVideoScaleAndCropFactor:self.effectiveScale];

    [self.stillImageOutput captureStillImageAsynchronouslyFromConnection:stillImageConnection
                                                       completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) {
                                                           if (error) {
                                                               [self displayErrorOnMainQueue:error withMessage:@"Take picture failed"];
                                                           }
                                                           else {
                                                               // trivial simple JPEG case
                                                               NSData *jpegData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageDataSampleBuffer];

                                                               UIImage *image = [[UIImage alloc] initWithData:jpegData];

                                                               /////
                                                               CGSize imageSize = [image size];
                                                               CGSize overlaySize = [overlay size];

                                                               UIGraphicsBeginImageContext(imageSize);

                                                               [image drawInRect:CGRectMake(0, 0, imageSize.width, imageSize.height)];

                                                               NSLog(@"aaa %f", [UIScreen mainScreen].applicationFrame.size.width);
                                                               NSLog(@"aaa %f", [UIScreen mainScreen].applicationFrame.size.height);
                                                               NSLog(@"aaa %f", [[UIScreen mainScreen] bounds].size.height);

                                                               CGFloat xScaleFactor = imageSize.width / 320;//320;
                                                               CGFloat yScaleFactor = imageSize.height / 568;//480;//568;

                                                              NSLog(@"xScaleFactor size %F",xScaleFactor);
                                                               NSLog(@"yScaleFactor size %F",yScaleFactor);              

                                                               //144 for 568
                                                               [overlay drawInRect:CGRectMake(overlayRect.origin.x * xScaleFactor, overlayRect.origin.y*yScaleFactor
                                                                                              , overlaySize.width * xScaleFactor, overlaySize.height * yScaleFactor)]; // rect used in AROverlayViewController was (30,100,260,200)
                                                               UIImage *combinedImage = UIGraphicsGetImageFromCurrentImageContext();
                                                               [self setStillImage:combinedImage];
                                                               UIGraphicsEndImageContext();
                                                                /////
                                                           }
                                                           [[NSNotificationCenter defaultCenter] postNotificationName:kImageCapturedSuccessfully object:nil];

                                                       }];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:44:18.307

从这里找到我的答案。[http://developer.apple.com/library/ios/#qa/qa1714/_index.html](http://developer.apple.com/library/ios/#qa/qa1714/_index.html)

```
// Render the UIView into the CGContextRef using the
// CALayer/-renderInContext: method
- (void)renderView:(UIView*)view inContext:(CGContextRef)context
{
    // -renderInContext: renders in the coordinate space of the layer,
    // so we must first apply the layer's geometry to the graphics context
    CGContextSaveGState(context);
    // Center the context around the window's anchor point
    CGContextTranslateCTM(context, [view center].x, [view center].y);
    // Apply the window's transform about the anchor point
    CGContextConcatCTM(context, [view transform]);
    // Offset by the portion of the bounds left of and above the anchor point
    CGContextTranslateCTM(context,
                          -[view bounds].size.width * [[view layer] anchorPoint].x,
                          -[view bounds].size.height * [[view layer] anchorPoint].y);

    // Render the layer hierarchy to the current context
    [[view layer] renderInContext:context];

    // Restore the context
    CGContextRestoreGState(context);
}

-(void)takePictureWithOverlay:(UIView *)overlay andRect:(CGRect)overlayRect
{
    // Find out the current orientation and tell the still image output.
    self.videoConnection  = [self.stillImageOutput connectionWithMediaType:AVMediaTypeVideo];

    //UIDeviceOrientation curDeviceOrientation = [[UIDevice currentDevice] orientation];
    // AVCaptureVideoOrientation avcaptureOrientation = [self avOrientationForDeviceOrientation:curDeviceOrientation];

    [self.videoConnection  setVideoOrientation:AVCaptureVideoOrientationPortrait];

    [self.videoConnection  setVideoScaleAndCropFactor:self.effectiveScale];

    [self.stillImageOutput captureStillImageAsynchronouslyFromConnection:self.videoConnection
                                                       completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) {
                                                           if (error) {
                                                               [self displayErrorOnMainQueue:error withMessage:@"Take picture failed"];
                                                           }
                                                           else {
                                                               // trivial simple JPEG case
                                                               NSData *jpegData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageDataSampleBuffer];

                                                               UIImage *image = [[UIImage alloc] initWithData:jpegData];
                                                               NSLog(@"cgsize of image %@", NSStringFromCGSize(image.size));
                                                               CGSize imageSize = [[UIScreen mainScreen] bounds].size;
                                                               NSLog(@"cgsize %@", NSStringFromCGSize(imageSize));

                                                               UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
                                                               CGContextRef context = UIGraphicsGetCurrentContext();
                                                               // Draw the image returned by the camera sample buffer into the context.
                                                               // Draw it into the same sized rectangle as the view that is displayed on the screen.
                                                                  float menubarUIOffset = 200.0;
                                                                  UIGraphicsPushContext(context);
                                                                  [image drawInRect:CGRectMake(0, 0, imageSize.width, imageSize.height)];
                                                                  UIGraphicsPopContext();

                                                               // Render the camera overlay view into the graphic context that we created above.
                                                                  [self renderView:overlay inContext:context];

                                                               //Retrieve the screenshot image containing both the camera content and the overlay view
                                                               UIImage *screenshot = UIGraphicsGetImageFromCurrentImageContext();
                                                               [self setStillImage:screenshot];
                                                               UIGraphicsEndImageContext();
                                                                /////
                                                           }
                                                           [[NSNotificationCenter defaultCenter] postNotificationName:kImageCapturedSuccessfully object:nil];

                                                       }];

} 
```

# groovy - 使用 IntelliJ 时 griffon 的文件类型差异

> ID：16007083
> 
> 赞同：1
> 
> 时间：2013-04-15T03:07:06.567
> 
> 标签：groovy, intellij-idea, griffon

为什么 IntelliJ 将 Controller 和 Model 的 groovy 文件识别为 groovy 类，但将 View 识别为 groovy 脚本？

![在此处输入图像描述](https://i.stack.imgur.com/91loq.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:55:08.843

因为 Griffon 视图默认是脚本。IDEA 在这里做的是正确的事。

# android - android.webkit.CookieManager 是否适用于 android 2.3.6？

> ID：16007084
> 
> 赞同：0
> 
> 时间：2013-04-15T03:07:07.577
> 
> 标签：android, cookiemanager

我发现android.webkit.CookieManager从api级别9开始工作，所以我认为它会从包含android2.3开始工作。但最近我发现它在android2.3.6上不起作用。</p>

//设置cookie

```
CookieSyncManager.createInstance(this.activity);
CookieSyncManager.getInstance().startSync();
CookieManager cookieManager = CookieManager.getInstance();
cookieManager.removeAllCookie();
cookieManager.setCookie(cookie_url,cookieNameString);
CookieSyncManager.getInstance().sync(); 
```

我在android3.2和android4.1.2上测试过，一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T12:03:39.080

我认为您正在看到一个 android 错误：

[https://code.google.com/p/android/issues/detail?id=16543](https://code.google.com/p/android/issues/detail?id=16543)

[removeAllCookie()](http://developer.android.com/reference/android/webkit/CookieManager.html#removeAllCookie%28%29)调用启动一个线程，然后与调用线程并行运行，并可能删除您使用 setCookie() 添加的[cookie](http://developer.android.com/reference/android/webkit/CookieManager.html#setCookie%28java.lang.String,%20java.lang.String%29)。一种解决方法是仅删除特定域的 cookie，如果您知道它们是哪些。

它似乎已在较新的 android 设备中得到修复 - 我无法在 4.1 或 4.2 上重现该问题。

# image-processing - 平面几何图形内的线检测

> ID：16007086
> 
> 赞同：3
> 
> 时间：2013-04-15T03:07:10.233
> 
> 标签：image-processing, computer-vision, object-detection

我想从给定的下图中实现什么 ![三角形](https://i.stack.imgur.com/GaOCL.png)

1.  以 A 点为原点的 A、B、C 和 D 点的坐标。
2.  事实上有lineAB，AC，BC和AD。
3.  事实点 D 在线 AB

点 id 并不重要，只要它可以检测到这些位置有点并且它们之间有线即可。OpenCV 会帮助我实现这一目标吗？如果是这样，你能更具体一点吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T22:00:01.063

正如乔所说的霍夫变换会帮助你，我知道 openCV 会帮助你，但我以前从未使用过它，这是我编写的一个简单的 Matlab 代码，用于提取线和点的坐标。

```
f=imread("your image without piont ID"); 
f=rgb2gray(f);              
fb=im2bw(f,graythresh(f));  

[H,T,R] = hough(not(fb),'RhoResolution',0.5,'Theta',-90:0.5:89.5); 
peaks=houghpeaks(H,4,'threshold',ceil(0.3*max(H(:))));      

lines = houghlines(not(fb),T,R,peaks); %this will give u start and end point of lines, Rho and tetha (x*cos(tetha)+y*sin(tetha)=Rho) now you can answer to all of your questions 
```

[http://en.wikipedia.org/wiki/Hough_transform](http://en.wikipedia.org/wiki/Hough_transform)

# python - regex 正则表达式 python

> ID：16007094
> 
> 赞同：0
> 
> 时间：2013-04-15T03:08:05.813
> 
> 标签：python

我在名为 findall 的 python 中遇到了这种方法的问题。在这种情况下，我正在访问网页 HTML 并尝试返回产品名称`'bread'`并将其打印到控制台。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:14:05.067

不要使用正则表达式进行 HTML 解析。有几个解决方案。我建议 BeautifulSoup ( [http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/) )

话虽如此，但在这种特殊情况下，RE 就足够了。放松一点。可能有更多或更少的空格，或者可能是制表符。因此，不要使用文字空间，而是使用空间类**\s**：

```
product = re.findall(r'Item:\s*is\s*in\s*lane\s*12\s*(\w*)', content)
print product[0] 
```

由于 '*'、'+' 和 '?' 限定符都是贪婪的（它们匹配尽可能多的文本）你不需要限制它**`[^<]*<br>`**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:31:13.490

如果您仍想使用正则表达式，这里有一个适合您的情况：

```
product = re.findall(r'<br>\s*Item:\s+is\s+in\s+lane 12\s+(\w*)[^<]*<br>', content) 
```

它考虑了 DSM 的空间灵活性建议和`(\w*)`可能出现的非字母`<br>`。

# excel - 如何在汇总宏中设置相对路径

> ID：16007096
> 
> 赞同：1
> 
> 时间：2013-04-15T03:08:09.100
> 
> 标签：excel, relative-path, vba

我正在使用宏来汇总文件夹中的一堆 excel 文件，路径设置如下：

```
MyPath = "C:\Users\Tim\Desktop\XXX\Compiled" 
```

我需要设置一个相对路径，因为文件夹 XXX 不断更改名称。

我发现

```
 Workbooks.Open Filename:=ThisWorkbook.Path & "\Compiled" 
```

将设置一个相对路径，但无法弄清楚如何将其应用于我的情况，我已经尝试过

```
 MyPath = Workbooks.Open Filename:=ThisWorkbook.Path & "\Compiled" 
```

但不起作用

谢谢

编辑我想通了

```
MyPath = ActiveWorkbook.Path & "\Compiled" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:23:15.383

虽然您已经根据主机工作簿的路径解决了这个问题，但请注意，您可以将相对目录返回到`Desktop`无论使用什么，这可能会很有`OS`用`SpecialFolders`：

```
Dim wsShell As Object
Set wsShell = CreateObject("wscript.shell")
strDir = wsShell.SpecialFolders("Desktop") & "\XXX\Compiled" 
```

# javascript - 离线网络应用程序。如何存储数据？

> ID：16007097
> 
> 赞同：7
> 
> 时间：2013-04-15T03:08:17.783
> 
> 标签：javascript, local-storage, offlineapps

### 介绍：

我想开发一个 webapp 来管理体育比赛。它必须能够完全离线运行，在本地存储数据并在有可用互联网连接时通过 AJAX 在线发布结果 - 这可能是后天。

### 问题：

如何使用 Javascript 存储数据？

### 附加说明：

*   我不想使用任何服务器端技术。
*   它必须像数据库一样安全。我读过关于 cookie 和 html5 存储的文章，但没有一个听起来令人信服。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:20:21.777

根据您想要存储的数据结构的复杂程度，您可以查看[indexedDB](https://developer.mozilla.org/en-US/docs/IndexedDB)。它的可用性仍然[非常先进](http://caniuse.com/indexeddb)，但是使用[polyfil](http://nparashuram.com/IndexedDBShim/)，您可以针对大多数现代桌面和移动浏览器。

存储的数据并不比任何其他客户端存储模型更安全，因为它是用 JavaScript 读取的。

API 本身非常复杂，无法直接使用，因此您可能想查看与 CouchDB 同步的[PouchDB](http://pouchdb.com/)等包装器 API ，或者如果您想要更简单的东西，可以使用[db.js。](https://github.com/aaronpowell/db.js)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T03:11:11.100

如果您支持现代浏览器，则可以使用[HTML5 Local Storage](http://diveintohtml5.info/storage.html)。

> **持久本地存储**是本地客户端应用程序比 Web 应用程序具有优势的领域之一。对于本机应用程序，操作系统通常提供一个抽象层，用于存储和检索特定于应用程序的数据，例如首选项或运行时状态。根据平台约定，这些值可能存储在注册表、INI 文件、XML 文件或其他位置。如果您的本地客户端应用程序需要键/值对之外的本地存储，您可以嵌入自己的数据库、发明自己的文件格式或任何数量的其他解决方案。

**例子**

```
// Save data to a the current session's store
sessionStorage.setItem("username", "John");

// Access some stored data
alert( "username = " + sessionStorage.getItem("username"));

// Get the text field that we're going to track
var field = document.getElementById("field");

// See if we have an autosave value
// (this will only happen if the page is accidentally refreshed)
if ( sessionStorage.getItem("autosave")) {
   // Restore the contents of the text field
   field.value = sessionStorage.getItem("autosave");
}

// Check the contents of the text field every second
setInterval(function(){
   // And save the results into the session storage object
   sessionStorage.setItem("autosave", field.value);
}, 1000); 
```

[浏览器兼容性](http://www.html5rocks.com/en/features/storage)

* * *

**旧版浏览器**

使用[Polyfill](http://www.calormen.com/polyfill/#storage)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-27T15:02:05.010

正是你想要的：

*   [您可以在IrisCouch](http://www.iriscouch.com/)上设置一个 CouchDB 实例来存储您的数据。CouchDB 是一个充当网络服务器的数据库，因此它可以根据自己的数据提供 html 页面——这种使用 CouchDB（提供页面）通常称为[CouchApp](http://docs.couchdb.org/en/latest/couchapp/index.html)。
*   因此，您[了解了 CouchDB](http://guide.couchdb.org/editions/1/en/)并编写了一个 HTML/Javascript/CouchDB 风格的应用程序来为您的页面提供服务。有一些[工具](http://couchapp.org/page/index)可以促进这一点。
*   之后，您只需将数据发送到您的 CouchDB 数据库，它就会出现在您的网页上。您将使用[PouchDB](http://pouchdb.com/)管理客户端的东西，这是一个在您的浏览器上运行并在本地保存数据的 CouchDB 实现，因此您永远不会丢失它，并自动更新您在 CouchDB 服务器上的本地数据，反之亦然。它是互联网上离线存储的最前沿。
*   为了确保客户端不会向服务器发送不良数据，您可以设置*身份验证*（因此要连接 Pouch 和 Couch，您需要提供密码）或者您可以设置*验证功能*（因此服务器将只接受数据存储与您定义的某些参数匹配的请求）。这两种方法在我之前链接的指南（[这里](http://guide.couchdb.org/draft/security.html)）中得到了很好的解释，但是在 CouchDB 学习过程中您肯定会遇到所有这些。

很多东西，但一个很酷的解决方案足以解决问题。此外，这个 CouchDB 非常简单，我敢打赌你会在一两天内阅读和学习所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T03:13:19.283

您可以使用 HTML5 本地存储

对旧版浏览器使用 polyfill [https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills#web-storage-localstorage-and-sessionstorage](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills#web-storage-localstorage-and-sessionstorage)

# c# - 如何验证 WindowsIdentity 实例？

> ID：16007101
> 
> 赞同：3
> 
> 时间：2013-04-15T03:09:04.787
> 
> 标签：c#, .net, wpf, wif, windows-identity

我正在尝试在我的 WPF 客户端/服务器 (WCF) 应用程序中使用 Windows Identity Foundation 进行授权，该应用程序可能会或可能不会在与提供身份验证的活动目录相同的信任环境中运行。例如，认证可能由活动目录提供，但应用程序可能在云中运行，并且应用程序的用户配置文件角色/权限将由应用程序数据库提供。

为了完全理解我应该做什么，我觉得我在脑海中遗漏了 WIF 流程的一个基本部分：

1.  用户使用 Active Directory 用户名/密码登录 Windows 域
2.  用户打开我的应用程序。
3.  我引用了登录用户的 WindowsIdentity，现在可以查看他们的登录令牌和所有配置的角色/声明 - 但就像他们可以登录域一样，他们可以登录到自己的机器并且仍然拥有 WindowsIdentity 令牌。
4.  我可以将用户的 Windows 身份绑定到他们在我的数据库中的用户配置文件，并授予他们访问我的应用程序中他们的配置文件允许他们访问的特定功能的权限。

我缺少的部分是我有来自 WindowsIdentity.GetCurrent() 的这个 WindowsIdentity 实例......我如何验证是什么产生了这个？即它是本地机器用户还是活动目录用户，如果它是活动目录用户，我怎么知道它是*我*真正的活动目录服务器？

例如 - 几个场景：

**方案 1**

1.  用户使用与我的活动目录域相同的名称来命名他们的本地计算机
2.  用户在该计算机上创建一个本地用户，其用户名与他们知道存在于我的活动目录中的用户相同，该用户对我的应用程序具有完全管理访问权限。
3.  他们登录到我的应用程序，并且出于所有密集目的，他们似乎具有相同的用户名，就好像管理用户登录到我的活动目录一样。

在这种情况下，用户有一个本地用户帐户，而不是 Active Directory 帐户，并且它有一个伪造的身份，旨在有目的地绕过应用程序安全性。

我假设有某种方法可以确定这是 Windows 本地用户帐户而不是 Active Directory 用户？我可以使用在 WindowsIdentity 中找到的用户名调用我的用户帐户的活动目录，并比较 SID 以确定这实际上是一个欺骗的用户帐户，并且应该拒绝用户访问。

这是正确的方法吗？有没有什么方法可以从 WindowsIdentity 中看出它是由*我的*活动目录发出的，并且这个身份没有被篡改？

**方案 2**

1.  用户创建了一个与我的活动目录同名的欺骗活动目录服务器，并创建了一个模拟与场景 1 中描述的本地用户相同的过程的帐户。

现在我有一个具有相同域名和用户名的活动目录用户，我为方案 1 建议的相同解决方案也可以解决此方案的问题，但再次确定此令牌不是由我的活动创建的会很好目录只是通过检查令牌。

有人可以清除我缺少的东西 - 或者我是否缺少任何东西？我是否应该只调用 Active Directory 以验证提供的 WindowsIdentity 是否允许访问我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T13:17:53.693

简单的回答：您的活动目录不仅仅通过名称来识别。当您的计算机加入域时，它会交换一组凭据。欺骗活动目录或任何其他计算机比仅仅创建具有相同名称的计算机要困难得多。Windows 负责机器之间的所有幕后身份验证。除了错误和漏洞，您可以非常确定，当您调用 WindowsIdentity.GetCurrent() 时，会有一条由不同凭据支持的完整推力链来验证用户身份。

更完整的答案：有两种类型的 windows 身份验证：

1.  第一种类型是在网络中的对等点之间（即域外）。在这种情况下，当计算机 A 中的用户连接到计算机 B 时，它实际上使用的是 B 的本地用户。如果 B 中的用户恰好与 A 中的用户具有相同的名称和密码，则无需用户干预即可进行身份验证。如果没有出现登录屏幕，用户需要为 B 中的某个用户提供凭据。无论如何，用户实际上是在登录计算机 B，而 B 不需要信任或知道计算机 A 中的本地使用。
2.  第二种类型是在域中。我相信如果计算机本身属于域的一部分或与它有信任关系的域中，您只能从域中添加用户。在任何情况下，当计算机 B 将拥有一组不同的凭据时，它可以对域控制器进行身份验证。现在，当来自计算机 A 的用户想要登录计算机 B 时，它要求域控制器（它知道并信任）对用户进行身份验证。一旦从域控制器获得 OK，用户就会被接受。

Windows 支持各种用于身份验证的协议，其中一些协议比其他协议更新且更强大。网络管理员配置接受哪些协议。大多数（全部？）协议不涉及通过网络发送实际密码（查看[摘要身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)以获取此类协议的示例或阅读[旧的 NTLM 协议](http://en.wikipedia.org/wiki/NTLM)）

# android - Android Service 在特定时间从数据库中获取数据

> ID：16007107
> 
> 赞同：0
> 
> 时间：2013-04-15T03:09:48.743
> 
> 标签：android, database, android-service, android-alarms, dashclock

我有一个显示我的学校时间表的应用程序，现在我正在尝试编写一个 DashClock 小部件。我需要在特定时间（例如每天凌晨 12 点）从数据库中获取当前主题，以便将更新发布到 DashClock。我检查了AlarmManager，但不知道如何设置在上午12 点自动运行的时间以及它如何访问数据库。有什么例子或教程吗？请帮助，提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:13:50.713

您可以简单地使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。通过使用 AlarmManager 将您的任务安排在上午 12 点重复进行。并且当 AlarmManager 触发时，您可以执行数据库操作。

那里有很多例子。这个[SO 答案](https://stackoverflow.com/a/8801990/931982)可能是一个好的开始。你也可以检查[这个项目](https://github.com/rakeshcusat/Code4Reference/tree/master/AndroidProjects/AlarmManagerExample)。以下是 google 第一页中的一些搜索结果示例。

[链接](http://justcallmebrian.com/?p=129)1 ，[链接](http://www.javacodegeeks.com/2012/09/android-alarmmanager-tutorial.html)2 ，[链接3](http://blog.mikesir87.io/2013/04/android-creating-an-alarm-with-alarmmanager/)

我认为从下一次开始，最好在发布之前搜索您的答案。

# binary - 霍夫曼编码：用零处理负歧义

> ID：16007114
> 
> 赞同：0
> 
> 时间：2013-04-15T03:10:38.787
> 
> 标签：binary, negative-number, huffman-code

我编写了一个使用霍夫曼编码的简单文本文件压缩器。我对文本进行编码并将 Huffman 生成的二进制文件写入文件。为了解码，我读入二进制文件并逐步遍历霍夫曼树。

那部分很简单。问题出现在 0 和负数上。为了练习/娱乐/学习，我决定做自己的二进制转换方法（从 Java 字节到字符串，反之亦然），我决定通过将最后一位翻转为 1 来表示负数。

例如，`-2 = 00000101;`; `2 = 00000100`（额外的 0 用于填充，因为即使是不必要的 0 在 Huffman 中也很重要……不过这无关紧要）

然而，`0 = 00000000 = 00000001`

这似乎不是问题，但是这两个二进制字符串映射到霍夫曼树中的两个不同字符。

有没有更好的方法来处理二进制中的负数来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:20:04.007

我不确定这会对您有所帮助，但我会尝试：

首先，有不同种类的二进制，纯的或其他的。二进制纯不允许负数，它从 0 开始......

您可以使用幅度和符号，另一种二进制，它允许负数，并且 - 或 + 符号用数字中最重要的位表示，例如： 4 位的数字：

0100=2

1100=-2

（1 位为符号，最重要的，左第一个，其他 3 位为数字）

您也可以使用二进制补码，但它更难，您需要以二进制形式获取数字，然后将其转换为另一种类型。

我希望我能帮助你，对于英语的很多错误，我深表歉意！

# node.js - 对于 Windows Azure，我可以使用 Dropbox 部署 node.js 服务器吗？

> ID：16007122
> 
> 赞同：2
> 
> 时间：2013-04-15T03:11:15.047
> 
> 标签：node.js, azure, dropbox

Azure 上有几个[教程](http://www.windowsazure.com/en-us/develop/nodejs/tutorials/create-a-website-%28mac%29/)展示了如何使用 git 部署 node.js 服务器。Azure 有一个很棒的功能，您可以将 Dropbox 文件夹链接到 Azure 网站，以进行非常简单的部署。非常适合网站，但我希望它也适用于 node.js 部署。

它似乎不起作用 - 部署过程正常，但导航到 node.js 部署的 URL 会产生此错误：

```
The page cannot be displayed because an internal server error has occurred. 
```

任何人都知道是否可以通过 Dropbox 将 node.js 服务器部署到 Windows Azure？

非常感谢-

**更新-** 刚刚浏览了部署日志并找到了这一行：

```
The package.json file is not present.
The node.js application will run with the default node.js version 0.6.20. 
```

也许它解释了我的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T10:53:35.693

从控制台和文件夹类型“npm init”生成 package.json

# php - 在不重新加载页面的情况下执行 php 脚本

> ID：16007126
> 
> 赞同：0
> 
> 时间：2013-04-15T03:11:32.983
> 
> 标签：php, javascript

```
<form action ="send.php" name ="userdetails" onsubmit="display(); return false;"> 
```

虽然这确实执行了 send.php 脚本，但它加载了 send.php 页面并且当前页面的内容丢失了。

提交表单后，我需要执行以下操作 - 应该发送一封电子邮件。但是，当前页面不会更改。实现这一目标的最佳方法是什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:17:23.863

设置值`action="..."`将始终将您重定向到新页面。

对于你想做的事情，AJAX 是完美的。它允许您在不离开当前页面的情况下运行 PHP 脚本。我会检查[jQuery 的 AJAX 功能](http://www.w3schools.com/jquery/jquery_ajax_intro.asp)。

# javascript - 在 javascript 中预览表单

> ID：16007131
> 
> 赞同：0
> 
> 时间：2013-04-15T03:12:12.893
> 
> 标签：javascript, jquery, onsubmit

我需要你的帮助。我快到了.. ：）

我想在提交前预览我的表单。但是**form.submit()** ; 不起作用。

这是我的代码：

HTML：

```
<form action="" method="post" name="frmaction" onSubmit="return preview(this);">
<label>First Name:</label>
<input name="fname" type="text" size="40" value="" />
<label>Last Name:</label>
<input name="lname" type="text" size="40" value="" />
</form> 
```

Javascript：

```
<script>
  function preview(form){
  var dia_log;
  $( "label" ).each(function(i,val) { 
  dia_log +=$(this).text() + " " + $(this).next().val()+"<br/>";
     });
  dia_log =dia_log.replace('undefined', '');

    $.confirm({
        'title'     : 'Are all these information is correct?',
        'message'   : dia_log,
        'buttons'   : {
            'Yes'   : {
                'class' : 'blue',
                'action': function(){
                form.submit();
                }
            },
            'No'    : {
                'class' : 'gray',
                'action': function(){}  
            }
        }
    });

    return false;

    }
</script> 
```

查询：

```
(function($){

$.confirm = function(params){

    if($('#confirmOverlay').length){
        // A confirm is already shown on the page:
        return false;
    }

    var buttonHTML = '';
    $.each(params.buttons,function(name,obj){

        // Generating the markup for the buttons:

        //buttonHTML += '<a href="#" class="button '+obj['class']+'">'+name+'<span></span></a>';
        buttonHTML += '<input type="submit" class="button '+obj['class']+'" value="'+name+'"/>';

        if(!obj.action){
            obj.action = function(){};
        }
    });

    var markup = [
        '<div id="confirmOverlay">',
        '<div id="confirmBox">',
        '<h1>',params.title,'</h1>',
        '<p>',params.message,'</p>',
        '<div id="confirmButtons">',
        buttonHTML,
        '</div></div></div>'
    ].join('');

    $(markup).hide().appendTo('body').fadeIn();

    var buttons = $('#confirmBox .button'),
        i = 0;

    $.each(params.buttons,function(name,obj){
        buttons.eq(i++).click(function(){

            // Calling the action attribute when a
            // click occurs, and hiding the confirm.

            obj.action();
            $.confirm.hide();
            return true;
        });
    });
}

$.confirm.hide = function(){
    $('#confirmOverlay').fadeOut(function(){
        $(this).remove();
    });
}

})(jQuery); 
```

希望我能得到你的回应。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:50:37.033

首先你应该`onSubmit="return preview(this);"`从 HTML 代码中删除，因为它违反了 w3c 标准。而是在表单中使用提交`<button>`。

```
<form action="" method="post" name="frmaction">
    <label>First Name:</label>
    <input name="fname" type="text" size="40" value="" />
    <label>Last Name:</label>
    <input name="lname" type="text" size="40" value="" />
    <button type="submit" name="submit">Submit</button>
</form> 
```

其次，`e.preventDefault`当单击提交按钮时，您没有申请，而且我在任何地方都找不到这样的插件`$.confirm`。我建议使用默认的 JavaScript `confirm()`。这是正确的代码：

```
<script type="text/javascript">
    //Register the click-submit event
    $('form').on('click', function(e) {
        e.preventDefault();
        preview($(this));
    });

    function preview(form){
        var dia_log;
        $( "label" ).each(function(i,val) { 
            dia_log += $(this).text() + " " + $(this).next().val() + "<br/>";
        });
        dia_log = dia_log.replace('undefined', '');

        if ( confirm("Are all these information is correct? " + dia_log) ) {
            alert('yes is clicked');
            form.submit();
        } else {
            alert('no is clicked');
        }

        /*
        In any case you should consider to remove the following alignment style because is unproductive!
        The eye is distracted by the alignment/appearance and not focuses at the important stuff.
        $.confirm({
            'title'     : 'Are all these information is correct?',
            'message'   : dia_log,
            'buttons'   : {
                'Yes'   : {
                    'class' : 'blue',
                    'action': function(){
                    form.submit();
                    }
                },
                'No'    : {
                    'class' : 'gray',
                    'action': function(){
                         //Here you had to apply return false;
                         return false;
                     }  
                }
            }
        });
        */
    }
</script> 
```

`$.confirm`有的话请提供网址。我想看看它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-16T08:17:52.640

您可以`e.preventDefault()`在`Javascript`.

```
<form onsubmit="preview(event)">
    ...
</form> 
```

```
const preview = (e) => {
    e.preventDefault();
    const form = $(e.target);

    form.find("input").forEach(inp => {
        console.log(inp.value)
    })
} 
```

# android - 正确使用 AsyncTask get()

> ID：16007137
> 
> 赞同：3
> 
> 时间：2013-04-15T03:13:24.433
> 
> 标签：android, android-asynctask

我遇到了一个问题。我需要使用 asynctask 来检索 JSON 数据，并且在移动到程序的下一部分之前我需要这些数据。但是，当使用 AsyncTask 的 get() 方法时，在看到数据显示之前，我有 5 到 8 秒的黑屏。我想在数据检索期间显示进度对话框，但由于黑屏，我无法执行此操作。有没有办法放入另一个线程？这是一些代码

异步任务

```
public class DataResponse extends AsyncTask<String, Integer, Data> {

    AdverData delegate;
    Data datas= new Data();
    Reader reader;
    Context myContext;
    ProgressDialog dialog;
    String temp1;

public DataResponse(Context appcontext) {

    myContext=appcontext;
    }

@Override
protected void onPreExecute()
{
    dialog= new ProgressDialog(myContext);
    dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
    dialog.setCancelable(false);
    dialog.setMessage("Retrieving...");
    dialog.show(); 
};      

    @Override
    protected Data doInBackground(String... params) {
        temp1=params[0];              
        try
        {
            InputStream source = retrieveStream(temp1);
            reader = new InputStreamReader(source);
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }

            Gson gson= new Gson();
            datas= gson.fromJson(reader, Data.class);    

            return datas; 

    }

    @Override
    protected void onPostExecute(Data data) 
    {

             if(dialog.isShowing())
            {
                dialog.dismiss();
            }

    }

    private InputStream retrieveStream(String url) {

            DefaultHttpClient client = new DefaultHttpClient(); 

            HttpGet getRequest = new HttpGet(url);

            try {

               HttpResponse getResponse = client.execute(getRequest);
               final int statusCode = getResponse.getStatusLine().getStatusCode();

               if (statusCode != HttpStatus.SC_OK) { 
                  Log.w(getClass().getSimpleName(), 
                      "Error " + statusCode + " for URL " + url); 
                  return null;
               }

               HttpEntity getResponseEntity = getResponse.getEntity();
               return getResponseEntity.getContent();

            } 
            catch (IOException e) {
               getRequest.abort();
               Log.w(getClass().getSimpleName(), "Error for URL " + url, e);
            }

            return null;

         } 
```

}

显示信息

```
public class DisplayInfo extends Activity implements AdverData {

public static Data data;
public ProjectedData attup;
public ProjectedData attdown;
public ProjectedData sprintup;
public ProjectedData sprintdown;
public ProjectedData verizionup;
public ProjectedData veriziondown;
public ProjectedData tmobileup;
public ProjectedData tmobiledown;
public ProjectedAll transfer;
private ProgressDialog dialog;
public DataResponse dataR;

Intent myIntent; // gets the previously created intent
double x; // will return "x"
double y; // will return "y"
int spatial; // will return "spatial"

//public static Context appContext;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    StrictMode.ThreadPolicy policy = new StrictMode.
            ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy); 

    dialog= new ProgressDialog(DisplayInfo.this);
    dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
    dialog.setCancelable(false);
    dialog.setMessage("Retrieving...");
    dialog.show(); 

        myIntent= getIntent(); // gets the previously created intent
         x = myIntent.getDoubleExtra("x",0); // will return "x"
         y = myIntent.getDoubleExtra("y", 0); // will return "y"
         spatial= myIntent.getIntExtra("spatial", 0); // will return "spatial"

        String URL = "Some URL"

dataR=new DataResponse().execute(attUp).get();

@Override
public void onStart()
{more code} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-15T04:40:34.290

当您使用`get`时，使用 Async Task 没有任何意义。因为`get()`会阻塞 UI 线程，这就是为什么你上面提到的要面对 3 到 5 秒的空白屏幕。

不要`get()`使用 AsyncTask 与 Call Back 检查此[AsyncTask 与回调接口](https://stackoverflow.com/questions/9273989/how-do-i-retrieve-the-data-from-asynctasks-doinbackground/14129332#14129332)

# java - IntelliJIDEA 找不到 Tomcat Lib 目录

> ID：16007144
> 
> 赞同：1
> 
> 时间：2013-04-15T03:13:49.317
> 
> 标签：java, jsp, configuration, intellij-idea

我已经在 IntelliJ IDEA 中配置了 Tomcat 服务器设置，但是每次执行程序都会出现同样的问题。它提示一个错误`"(AppPath)\build.xml:85 C:\apache-tomcat-6.0.26\lib does not exist."`（不存在）。但是我已经更新了我的 Tomcat 服务器目录的主目录。

请参阅下面的配置和错误的附加图像： ![Tomcat 配置](https://i.stack.imgur.com/tmy2o.jpg)

![建筑错误](https://i.stack.imgur.com/2kByh.jpg)

build.xml 的第 85 行：

```
<path id="catalina-ant-classpath">
    <!-- We need the Catalina jars for Tomcat -->
    <!--  * for other app servers - check the docs -->
    <fileset dir="${appserver.lib}">
        <include name="catalina-ant.jar"/>
    </fileset>
</path>

<!--This is Line 84, next is 85th-->
<taskdef name="install" classname="org.apache.catalina.ant.InstallTask">
    <classpath refid="catalina-ant-classpath"/>
</taskdef>
<taskdef name="reload" classname="org.apache.catalina.ant.ReloadTask">
    <classpath refid="catalina-ant-classpath"/>
</taskdef>
<taskdef name="list" classname="org.apache.catalina.ant.ListTask">
    <classpath refid="catalina-ant-classpath"/>
</taskdef>
<taskdef name="start" classname="org.apache.catalina.ant.StartTask">
    <classpath refid="catalina-ant-classpath"/>
</taskdef>
<taskdef name="stop" classname="org.apache.catalina.ant.StopTask">
    <classpath refid="catalina-ant-classpath"/>
</taskdef> 
```

有人可以帮我为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:33:41.720

发现 Ant 属性是在 build.properties 文件中配置的。我修改了`appserver.home`Ant 属性来构建 Spring 应用程序，它就像一个魅力！

# android - 如何使用可点击对象消除可跨字符串中的下划线？

> ID：16007147
> 
> 赞同：83
> 
> 时间：2013-04-15T03:14:24.593
> 
> 标签：android, textview, spannable

我`Spannable Object`有一套`Clickable Object`。当`Spannable String`显示在 中时，`TextView`它具有蓝色文本和蓝色下划线（向用户表明此文本是可点击的）。我的问题是如何防止出现蓝色下划线`TextView`？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-04-15T05:50:15.113

使用下面的代码并尝试

```
String mystring =" Hello";
SpannableString ss= new SpannableString(mystring);
ss.setSpan(new MyClickableSpan(mystring), 0, ss.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);  

class MyClickableSpan extends ClickableSpan{// extend ClickableSpan     

    String clicked;
    public MyClickableSpan(String string) {
        super();
        clicked = string;
    }
    @Override
    public void onClick(View tv) {
       Toast.makeText(MainActivity.this,clicked , Toast.LENGTH_SHORT).show();
    }

    @Override
    public void updateDrawState(TextPaint ds) {// override updateDrawState
        ds.setUnderlineText(false); // set to false to remove underline
    }
} 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2016-08-16T13:11:32.660

这对我有用。无需创建自定义`ClickableSpan`类。只需覆盖`updateDrawState(TextPaint ds)`.

```
SpannableString span = new SpannableString("Some text");
ClickableSpan clickSpan = new ClickableSpan() {
    @Override
    public void updateDrawState(TextPaint ds) {
        ds.setColor(ds.linkColor);    // you can use custom color
        ds.setUnderlineText(false);    // this remove the underline
    }

    @Override
    public void onClick(View textView) {
        // handle click event
    }
};

span.setSpan(clickSpan, 5, span.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
yourTextView.setText(span); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-30T01:30:02.147

Raghunandan 的回答对我来说非常有效。这是它的精简版：

```
public abstract class NoUnderlineClickableSpan extends ClickableSpan {    
    public void updateDrawState(TextPaint ds) {
        ds.setUnderlineText(false);
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-30T13:42:44.863

覆盖 ClickableSpan 类的 updateDrawState 方法

```
String mystring =" Hello";
SpannableString ss= new SpannableString(mystring);
ss.setSpan(new MyClickableSpan(mystring), 0, ss.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);  

class MyClickableSpan extends ClickableSpan{// extend ClickableSpan     

String clicked;
public MyClickableSpan(String string) {
    // TODO Auto-generated constructor stub
super();
clicked =string;
}

public void onClick(View tv) {

   Toast.makeText(MainActivity.this,clicked ,
        Toast.LENGTH_SHORT).show();
}

public void updateDrawState(TextPaint ds) {// override updateDrawState
   ds.setUnderlineText(false); // set to false to remove underline
} 
```

用于更改可跨字符串的颜色

```
 SpannableString    ss = new SpannableString("android Stack Overflow");

  ForegroundColorSpan fcs=newForegroundColorSpan(Color.parseColor("#01579B"));
  ss.setSpan(fcs, 8,13, Spannable.SPAN_INCLUSIVE_INCLUSIVE); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-10-18T05:52:46.797

最简单的方法是

```
 string1 = new SpannableString("By Tapping Register You Agree To The \nTerms And Conditions");
    ClickableSpan clickableSpan = new ClickableSpan() {
        @Override
        public void onClick(View widget) {
            Toast.makeText(getApplicationContext(),"clicked",Toast.LENGTH_SHORT).show();
        }
        @Override
        public void updateDrawState(TextPaint ds) {
        ds.setUnderlineText(false);    // this line removes underline
        }

    };
    text_terms.setMovementMethod(LinkMovementMethod.getInstance());
    string1.setSpan(clickableSpan,37,string1.length(),0);
    text_terms.setText(string1); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-15T03:26:34.477

> ~~spannableStringObject.toString();~~

编辑

```
SpannableString ss = getYourSpannableString();
UnderlineSpan[] uspans = ss.getSpans(0, ss.length(), UnderlineSpan.class);
for (UnderlineSpan us : uspans) {
    ss.removeSpan(us);
} 
```

将从 Spannable 中删除所有 UnderlineSpans。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-11-16T03:27:33.513

基于[@Sai Gopi Me的回答](https://stackoverflow.com/users/5208491/sai-gopi-me)

在科特林：

```
val clickableSpan: ClickableSpan = object : ClickableSpan() {
    override fun onClick(widget: View) {
        // some action here
    }

    override fun updateDrawState(ds: TextPaint) {
        super.updateDrawState(ds)
        ds.isUnderlineText = false
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-05T09:32:29.950

```
Try the below code to remove underlined and clicked event on multiple words in textview :

            String str="Angelina Clapped For Lester Kang";
            Spannable span = Spannable.Factory.getInstance().newSpannable(str);

            // 0 to 8 start and  index of Angelina
            span.setSpan(new ClickableSpan(str), 0, 8, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);

             //  21 to 32  start and  index of Lester  Kang
            span.setSpan(new ClickableSpan(str), 21, 32, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);

            textview.setText(span);

             class ClickableSpan extends ClickableSpan{

                    String clicked;
                    public ClickableSpan (String string) {
                        super();

                    }

                    public void onClick(View v) {
                        Toast.makeText(MyActivity.this,""+((TextView)v).getText().toString(),Toast.LENGTH_SHORT).show();
                    }

                    public void updateDrawState(TextPaint ds) {
                       // override updateDrawState
                        ds.setUnderlineText(false); // set to false to remove underline
                    }
                } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-29T15:02:13.060

ANURAG RASTOGI 的回答为我节省了一天！我已经有一个`SpannableString`我想应用的格式`ClickableSpan`：

```
spannableString.setSpan(new ClickableSpan() {
    @Override
    public void onClick(View widget) {
        // Do something...
    }
    // Prevent
    // ds.setColor(ds.linkColor);
    // ds.setUnderlineText(true);
    // in: https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/text/style/ClickableSpan.java
    // from executing.
    @Override
    public void updateDrawState(@NonNull TextPaint ds) {
        // super.updateDrawState(ds);
    }
},0, spannableString.length(), SPAN_EXCLUSIVE_EXCLUSIVE); 
```

`updateDrawState`覆盖Android 类`updateDrawState`中的`ClickableSpan`，并且不调用`super.updateDrawState`它不会被执行。

所有已经存在的文本格式`spannableString`都将被保留。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-15T15:52:04.783

如果您不想要任何预先应用的属性，请不要调用**super.updateDrawState()**。在 object 的帮助下覆盖 updateDrawState(object:Textpaint) 时，**您**可以应用或调用 Text Paint 中存在的不同函数。

# ruby-on-rails - 如何每 x 秒调用一次方法？

> ID：16007148
> 
> 赞同：3
> 
> 时间：2013-04-15T03:14:26.517
> 
> 标签：ruby-on-rails, ruby, sinatra

是否有一个简单的库可以让我每隔 x 秒安排一个非常简单的任务，由传入的 Web 请求指定？

我正在寻找类似的东西：

```
Something.after(5) { call_method } 
```

很简单。我是否必须安装像 resque 这样的库，或者是否有可以处理这个的库？我不是在寻找完整的后台队列处理，只是在 x 秒后调用一个简单的方法。我知道resque和sidekiq...

我需要从 Rails 或 Sinatra 运行它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T07:03:27.390

也许重写你的代码示例：

```
Something.after(5) { call_method } 
```

至：

```
Something
Thread.new do
  sleep(5)
  call_method
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:48:17.870

最好将其发送到后台任务，看看[resque-scheduler](https://github.com/bvandenbos/resque-scheduler)和[Resque](https://github.com/defunkt/resque)。还有一个不错的[Railscast](http://railscasts.com/episodes/271-resque)值得一试。使用 crons 之类的其他任何事情都是不对的。

我确实找到了这颗宝石（[sucker_punch](https://github.com/brandonhilkert/sucker_punch)），它看起来可以满足您的要求

# ios - iOS AFNetworking 阻塞主线程

> ID：16007151
> 
> 赞同：3
> 
> 时间：2013-04-15T03:14:52.650
> 
> 标签：ios, multithreading, networking, afnetworking, mbprogresshud

我最近才切换到 AFNetworking 来处理我的应用程序中的所有网络。但是，它现在似乎阻塞了主线程，因此我的 MBProgressHUD 直到操作完成后才会旋转，并且我的 pullToRefreshView 也不会在操作之后进行动画处理。我将如何解决这个问题？

```
- (void)pullToRefreshViewShouldRefresh:(PullToRefreshView *)view; {

    // Call the refreshData method to update the table
    [dataController refreshData];
}

- (void)refreshData {

    NSURLRequest *request = [NSURLRequest requestWithURL:[FCDataController parserURL]];

    NSLog(@"URL = %@", request);

    AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request

    success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {

        _calls = [[NSMutableArray alloc] init];

        XMLParser.delegate = self;
        [XMLParser parse];
    }

    failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, NSXMLParser *XMLParser) {

        if ([delegate respondsToSelector:@selector(refreshDataDidFailWithError:)]) {
            [delegate refreshDataDidFailWithError:error];
        }

    }];
    [operation start];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:12:51.550

默认情况下，AFNetworking 在主线程上调用成功/失败块（在网络操作在后台线程上运行之后）。这对于您的代码只需要更新 UI 的常见情况很方便。如果您需要对结果执行一些更复杂的操作（例如解析大型 XML 文档），那么您可以指定一些其他调度队列，您的回调应该在其上运行。有关更多信息，请参阅[文档](http://cocoadocs.org/docsets/AFNetworking/2.6.3/Classes/AFURLConnectionOperation.html#//api/name/completionQueue)。

更新（2016 年 2 月 11 日）：自从我发布此答案以来，AFNetworking 在近三年中发生了很大变化：`AFHTTPRequestOperation`在当前版本（3.0.4）中不再存在。我已经更新了链接，所以它不会被破坏，但是这些天你完成类似事情的方式可能会大不相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T05:08:47.273

MBProgressHUD 在哪里被调用？您使用的是 SSPullToRefresh 还是其他一些实现。我正在为当前项目编写非常相似的代码，并且效果很好。

```
- (BOOL)pullToRefreshViewShouldStartLoading:(SSPullToRefreshView *)view {
    return YES;
} 

- (void)pullToRefreshViewDidStartLoading:(SSPullToRefreshView *)view {
    [self refresh];
}

- (void)refresh {
    NSURL* url = [NSURL URLWithString:@"some_url_here"];
    NSURLRequest* request = [NSURLRequest requestWithURL:url];
    AFJSONRequestOperation* operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        // consume response

        [_pullToRefreshView finishLoading];
        [self.tableView reloadData];
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    }];
    [operation start]; 
```

我的猜测是`- (void)pullToRefreshViewShouldRefresh:(PullToRefreshView *)view; {`从后台线程调用。

# cron - 用于基于 db 值运行脚本的 cron 作业

> ID：16007152
> 
> 赞同：1
> 
> 时间：2013-04-15T03:15:39.340
> 
> 标签：cron

我有一个 sctipt runthisapp.sh 并且我的 db table holiday 中有一些日期。我的问题是它应该每天检查数据库，如果假期表中存在日期，runthisapp.sh 应该在 10 点钟运行，否则它应该在 8 点钟运行。我试过但找不到解决方案。你能帮帮我吗。请在这个问题上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:50:37.953

您可以有两个 crontab 条目，一个在上午 8 点，一个在上午 10 点，将不同的选项传递给您的脚本，例如前者take`--holiday=0`和后者`--holiday=1`，如果在错误的“假期”中，您的脚本应该什么都不做。

# c++ - 指向模板类方法的指针的 typedef

> ID：16007153
> 
> 赞同：1
> 
> 时间：2013-04-15T03:15:46.080
> 
> 标签：c++, templates, c++11, typedef

标题总结了我的问题——我需要一个泛型 typedef 来作为指向模板类方法的指针，如下面的代码中所述。typedef 需要是通用的。

```
template<typename TYPE>
struct MyClass {
    const TYPE& get() const {}
};

// this is okay:
typedef void (MyClass<int>::*ParticleMethodPtr)( int );

// now I just need to typedef this so I can
// use the pointer on methods other than int

// using typedef, not okay:
template< TYPE >
typedef void (MyClass<TYPE>::*ParticleMethodPtr)( TYPE ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:22:33.980

在 C++11 中：

```
template<typename TYPE>
using ParticleMethodPtr = const TYPE&(MyClass<TYPE>::*)() const;

ParticleMethodPtr<int> p = &MyClass<int>::get; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:20:03.813

这是不允许的，正如你自己所见。

你可以这样做：

```
template<typename T>
struct member_pointer
{
    typedef void (MyClass<T>::*function_type)(T);
}; 
```

现在您可以将其用作：

```
member_pointer<int>::function_type memfun = &MyClass<int>::some_func;

(obj.*memfun)(100); 
```

您可以使用 C++11 模板别名使其更简单：

```
template<typename T>
using mem_function = typename member_pointer<T>::function_type; 
```

然后将其用作：

```
mem_function<int> memfun = &MyClass<int>::some_func;

(obj.*memfun)(100); 
```

希望有帮助。

# javascript - Jquery rails 3，选中时将项目从一个div类移动到另一个div

> ID：16007165
> 
> 赞同：2
> 
> 时间：2013-04-15T03:17:45.983
> 
> 标签：javascript, ruby-on-rails-3, jquery

我有两个 div id=left 和 div id=right。现在，左侧 div 中列出了多个带有项目的复选框。当我选中一个复选框时，该项目应从左侧 div 中删除并添加到右侧 div，并将所选项目从 div id=right 移动到 div id=left。当我单击一个复选框时，它的状态也在数据库中更新。所以告诉我如何在 rails 3 中使用 jquery-ajax 执行此任务。

脚本 ：

```
 <script>
          $(function () {

            $(".checkbox").click(function() {

              $('.allchkb').each(function(){

                var item = $(this).attr('id');
                  if($(this).is(':checked')){
                  $("#right > span."+item).appendTo("#left");
                  $(this).siblings("#left").css("text-decoration","line-through");
                  $(this).siblings("#left").css("color","#aaa");
                  $(this).parent('li').css("background-color","#ccc");

                  } 
                  else 
                  {
                    $("#left > span."+item).appendTo("#right");
                  }
              });
            });
         });
      </script> 
```

导轨代码：

```
 <div class="box-body box-body-nopadding" id="left">
      <% @activity.each do |p| %>
        <% p.task.each do |t| %>
          <ul class="tasklist">
            <li class="bookmarked">
              <label class="checkbox">
                <%= check_box_tag 'activity_status', task.id, :class => 'checkbox'%>
              <%= link_to task.title, mytask_path(@task), :title => "is responsible.                                 , Total my task : " %>
               <span class="task-actions">
                 <%= link_to "Edit", task(@activity) %> |
                 <%= link_to "delete", @task, :method => :delete %>

              </span>
              <span class="task-actions">
                <%= task.due_date %> 
              </span>
            </li><li>
            </li>
          </ul>
        <% end %>
      <% end %>
    </div>
      <div class="box-body box-body-nopadding" id="right">
      </div> 
```

# javascript - 替换双引号内的通配符字符串

> ID：16007167
> 
> 赞同：-1
> 
> 时间：2013-04-15T03:18:03.867
> 
> 标签：javascript, string, replace, wildcard

我有这个字符串

```
var newtypegraph=newtypegraph.replace(' "type":"bar3d" ',' "type":"area" '); 
```

我想将 bar3d 设为通配符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:20:31.410

这看起来像 JavaScript，所以你可以使用正则表达式：

```
var newtypegraph = newtypegraph.replace(/"type":".*?"/g, '"type":"area"'); 
```

这看起来像 JSON 对象的属性。这是 JSON 吗？

# jquery - 如何在 JQuery 中“或”两个 Promise

> ID：16007168
> 
> 赞同：2
> 
> 时间：2013-04-15T03:18:12.420
> 
> 标签：jquery, promise

如果[.when](http://api.jquery.com/jQuery.when/)相当于 JQuery Promises 的“and”运算符，那么“Or”运算符的等价物是什么？

如果我有两个 Promise，并且我想在两者都解决后做某事，那么我应该使用“when”方法。但是我有一个场景，当一个承诺或另一个承诺已经解决时，我想做一些事情。

场景是数据库初始化。第一个承诺与检查数据库是否已经存在有关。如果第一个承诺被拒绝，第二个承诺来自创建数据库。然后我想运行一些以第一个承诺或第二个承诺为条件的代码。

目前我的代码看起来有点像这样：

```
function initialiseDB() {
    var deferred = jQuery.Deferred();

    // Check to see if the database exists already
    var existencePromise = checkExistenceOfDatabase();

    existencePromise.done(function() {
        // The database exists; no need to pull a copy
        deferred.resolve(); 
    });
    existencePromise.fail( function(error) {
        // Failed to confirm existence of database; pull a copy
        var pullPromise = pullDatabase();

        pullPromise.fail( function(error) {
            // Failed to pull database
            deferred.reject();
        });
        pullPromise.done( function() {
            // A copy of the database has been pulled
            deferred.resolve();
        });
    });

    return deferred.promise();
} 
```

这实际上是一个自定义的“惰性或”运算符。

我是 JQuery 的 Promises 的新手，我花了很长时间寻找一个通用的“或”方法。上面的代码是应该如何完成的，还是我错过了一个通用形式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:09:00.433

这是您可以尝试的功能 - 我们称之为`whenAny`：

```
var whenAny = function() {
  var finish = $.Deferred();
  $.each(arguments, function(index, def){
    def.done(finish.resolve);
  });
  return finish.promise();
} 
```

用法：`whenAny(def1, def2, def3)`。

您可能需要在这里和那里进行一些调整，也许是关于参数传递，找出实际解决的问题等等，但您明白了。

感谢您提出这个用例......我想我实际上可能会将它添加到[simple-deferred](https://github.com/sudhirj/simply-deferred)中。看起来还蛮有用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:01:29.887

马修，您的代码将简化为：

```
function initialiseDB() {
    var deferred = jQuery.Deferred();
    checkExistenceOfDatabase().done(deferred.resolve).fail(function(error) {
        pullDatabase().fail(deferred.reject).done(deferred.resolve);
    });
    return deferred.promise();
} 
```

我很确定它将进一步简化为：

```
function initialiseDB() {
    return checkExistenceOfDatabase().then(null, function(error) {
        return pullDatabase();
    });
} 
```

或者非常简洁：

```
function initialiseDB() {
    return checkExistenceOfDatabase().then(null, pullDatabase);
} 
```

尽管 nett 效应类似于 or，但它确实是顺序逻辑……这正是您想要的；ie只有在失败`pullDatabase`时才应该调用。`checkExistenceOfDatabase()`

# c++ - 为什么将外部模板中的 T 作为默认参数传递给 std::function 会导致编译错误？

> ID：16007178
> 
> 赞同：7
> 
> 时间：2013-04-15T03:19:19.000
> 
> 标签：c++, templates, visual-c++, visual-studio-2012, c++11

我创建了一个模板类，并将 T 作为默认类型参数传递。但是，这会导致编译失败。任何人都可以解释会发生什么？谢谢！

PS。我使用的编译器是VS2012。

```
#include <functional>

using namespace std;

template <typename T = void()>
struct delegate
{
    typedef function<T> function_t;

    function_t f;
};

int main()
{
    delegate<> d;

    return 0;
} 
```

编译器输出：

```
1>.\Microsoft Visual Studio 11.0\VC\include\functional(554): error C2027: use of undefined type 'std::_Get_function_impl<_Tx>'
1>          with
1>          [
1>              _Tx=void (__cdecl *)(void)
1>          ]
1>          test.cpp(12) : see reference to class template instantiation 'std::function<_Fty>' being compiled
1>          with
1>          [
1>              _Fty=void (__cdecl *)(void)
1>          ]
1>          test.cpp(17) : see reference to class template instantiation 'delegate<>' being compiled
1>.\Microsoft Visual Studio 11.0\VC\include\functional(555): error C2504: 'type' : base class undefined
1>.\Microsoft Visual Studio 11.0\VC\include\functional(558): error C2027: use of undefined type 'std::_Get_function_impl<_Tx>'
1>          with
1>          [
1>              _Tx=void (__cdecl *)(void)
1>          ]
1>.\Microsoft Visual Studio 11.0\VC\include\functional(558): error C2146: syntax error : missing ';' before identifier '_Mybase'
1>.\Microsoft Visual Studio 11.0\VC\include\functional(558): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-08T20:17:19.840

正如您对问题的评论所示：这只是 Visual Studio 中的一个错误，您的 C++ 代码没有任何问题。@Stephan-T-Lavavej 说他已将其归档为 DevDiv#671343。

假设@Yakk 的诊断是正确的（MSVC 错误地将`T`其视为`void(*)()`而不是`void()`），我以前提出了“可能的解决方法”

```
typedef function<typename remove_pointer<T>::type> function_t; 
```

但正如@JoshPeterson 在下面评论的那样，即使进行了更改，该错误仍然出现在 VS2013 中，因此它*实际上并不是*一种解决方法。

# c - 将for循环的测试条件设置为指针的功能是什么

> ID：16007189
> 
> 赞同：1
> 
> 时间：2013-04-15T03:20:29.680
> 
> 标签：c

我很难理解将 for 循环的测试条件设置为指针的确切作用，甚至在没有任何比较的情况下将其设置为变量值。我正在使用的一个代码示例是：

```
int f ( char *s, char *t) {
  char *p1, *p2;
  for (p1 = s; *p1; p1++) {
    for (p2 = t; *p2; p2++)
      if (*p1==*p2) break;
    if (*p2 == ‘\0’) break;
  }
return p1-s;
} 
```

我不是在寻找函数的解释，而只是对两个 for 循环的测试条件的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:23:20.990

```
for (p1 = s; *p1; p1++) {
  for (p2 = t; *p2; p2++) { 
```

它相当于比较`*p1`和`*p2`NUL ( `\0`)。当到达字符串的 NUL 终止符时，循环将终止。

```
for (p1 = s; *p1 != '\0'; p1++) {
  for (p2 = t; *p2 != '\0'; p2++) { 
```

`if`您也可以在and语句中使用此速记，`while`以及其他类型。省略条件检查变量是否针对其类型的默认零值：`'\0'`对于字符，`0`对于整数，`0.0f`或者`0.0`对于浮点数和双精度数，`NULL`对于指针。

```
p = malloc(n);
if (p) {
    // if p is not null
}

int len = strlen(s);
while (len--) {
    // loop until len reaches 0
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:22:22.067

`for (p1 = s; *p1; p1++)`继续执行循环 while`*p1`为真，即，当地址处的字符值`p1`非零时，即，while`p1`未指向 NUL 字节。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-15T03:47:34.980

外循环中的每个字符：

```
for (p1 = s; *p1; p1++) {
} 
```

使用指针算法针对内部循环测试每个字符的字符，如果匹配则中断

```
for (p2 = t; *p2; p2++)
  if (*p1==*p2) break; 
```

字符结束或内部循环为 NULL 然后从循环中中断

```
if (*p2 == ‘\0’) break; 
```

# iphone - 如何加载已经缩小的图像

> ID：16007192
> 
> 赞同：1
> 
> 时间：2013-04-15T03:20:42.640
> 
> 标签：iphone, objective-c, image, zooming

我正在尝试在我的 iPhone 应用程序中显示一个大图像。它的行为有点奇怪，我不能把它放在中心看它这么大。有没有办法按比例加载它，以便整个图像适合屏幕，然后你可以放大？

```
- (void)loadImageView1 {
    KFImageZoomView *image = [[KFImageZoomView alloc] initWithImageNamed:@"TrappsTrailMapImage.png"atLocation:CGPointMake(0,0)];
    [self addSubview:image];
    [image release];
} 
```

自定义类：

.h 文件

```
#import <UIKit/UIKit.h>

@interface KFImageZoomView : UIScrollView <UIScrollViewDelegate> {
    UIImageView *imageView;
}

@property (nonatomic, retain)   UIImageView     *imageView;

#pragma mark Initialisation
- (id)initWithImageNamed:(NSString *)imageName atLocation:(CGPoint)location;

@end 
```

.m 文件

```
#import "KFImageZoomView.h"

@implementation KFImageZoomView

@synthesize imageView;

#pragma mark - Memory Management

- (void) dealloc {
    [self.imageView release];
    [super dealloc];
}

#pragma mark - Initialisation

- (id)initWithImageNamed:(NSString *)imageName atLocation:(CGPoint)location {
    self = [super init];
    if (self) {
        // Assign the delegate
        self.delegate = self;

        // Create our image view using the passed in image name
        self.imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:imageName]];

        // Update the ImageZoom frame to match the dimensions of passed in image
        self.frame = CGRectMake(location.x, location.y, 
                                self.imageView.frame.size.width, self.imageView.frame.size.height);

        // Set a default minimum and maximum zoom scale
        self.minimumZoomScale = 0.01f;
        self.maximumZoomScale = 10.0f;

        // Add image view as a subview
        [self addSubview:self.imageView];
    }

    return self;
}

#pragma mark - UIScrollViewDelegates

- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {

}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView {
    return self.imageView;
}

@end 
```

# javascript - 标签的 Title 属性是否有效，可以像换行一样保存 html 标签

> ID：16007193
> 
> 赞同：5
> 
> 时间：2013-04-15T03:21:21.773
> 
> 标签：javascript, jquery, html

 我的问题是，title 属性保存 html 标签（如换行的 break 标签）确实有效。

```
 <a href="#" title="hello <br> how are you" target="xxx"></a> 
```

如果它有效，则中断标记显示在工具提示中，我想避免但仍需要换行。

我正在使用 jQuery。 

我提到了一个链接[http://jsfiddle.net/roXon/N8Q2z/](http://jsfiddle.net/roXon/N8Q2z/)在其中我在标题中给出了中断标签。它可以很好地实现新行，而不会在工具提示中显示中断标记。

但不确定代码的哪一部分避免了工具提示中的中断标记。

您能否让我知道 jquery 中的哪段代码实际上避免了在工具提示中显示中断标记，因为我是 jquery 的新手。

感谢您的所有帮助！

提前致谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T03:27:38.790

尝试使用`<br />`但使用`&lt;`for`<`和`&gt;`for的值`>`。这意味着当`title`将 放入您的工具提示时，它将是正确的格式，并且有效！

在 IE7+、Chrome、Firefox 中测试。

[jsFiddle](http://jsfiddle.net/zfFuu/)

```
<a title="hello&lt;br/&gt;how are you" class="printbtn" href="#">Print results</a><br> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T03:25:00.523

使用 `&#13;`或`&#xD;`

```
<a href="#" title="hello &#13; how are you" target="xxx"></a> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T03:26:31.070

属性值不能包含标签。您可以在属性值中添加新行，但这可能不是一个好主意。

现在是思考为什么要在属性中放置标签以及要完成什么的好时机。我确信有更好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T03:29:53.440

标题属性应该是一个`text`. [标题属性参考](http://www.w3.org/TR/html401/struct/global.html#adef-title)

> 标题=文本[CS]；此属性提供有关为其设置的元素的咨询信息。标题属性的值可以由用户代理以多种方式呈现。例如，视觉浏览器经常将标题显示为“工具提示”（指点设备在对象上暂停时出现的短消息）。音频用户代理可以在类似的上下文中说出标题信息。例如，在链接上设置属性允许用户代理（可视和非可视）告诉用户链接资源的性质：

# ios - 在类别中实现 UIAlertView 委托方法

> ID：16007198
> 
> 赞同：0
> 
> 时间：2013-04-15T03:22:03.857
> 
> 标签：ios, objective-c, uialertview, objective-c-category

我尝试实现一个处理 uialertview 的视图控制器类别。如果 viewcontroller 还需要显示警报视图，它需要实现`-(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex`而不是搞砸。为此，我将 uialertview 的委托设置为类别中的虚拟对象，而不是 self。`exc_bad_access`但是当点击 alertview 中的一个按钮时，我的应用程序崩溃了。下面的代码有什么问题？

```
//Dummy handler .h

@interface dummyAlertViewHandler : NSObject <UIAlertViewDelegate>

@property (nonatomic, weak) id delegate;

//.m
-(id) initWithVC:(id) dlg
{
    self = [super init];
    if (self != nil)
    {
        self.delegate = dlg;
    }
    return self;
}

-(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 1)
    {
        [self mainMenuSegue]; //There is no problem with the method
    }
}

//Category .h
#define ALERT_VIEW_DUMMY_DELEGATE_KEY "dummy"
@property (nonatomic, strong) id dummyAlertViewDelegate;

//Category .m
@dynamic dummyAlertViewDelegate;

- (void)setDummyAlertViewDelegate:(id)aObject
{
    objc_setAssociatedObject(self, ALERT_VIEW_DUMMY_DELEGATE_KEY, aObject, OBJC_ASSOCIATION_ASSIGN);
}

- (id)dummyAlertViewDelegate
{
    id del = objc_getAssociatedObject(self, ALERT_VIEW_DUMMY_DELEGATE_KEY);

    if (del == nil)
    {
        del = [[dummyAlertViewHandler alloc] initWithVC:self];
        self.dummyAlertViewDelegate = del;
    }

    return del;
}

-(void) mainMenuSegueWithConfirmation
{
    UIAlertView *ruSure = [[UIAlertView alloc] initWithTitle:@"Confirm leave" 
message:@"Are you sure you want to leave this game?" 
delegate:self.dummyAlertViewDelegate 
cancelButtonTitle:@"No" 
otherButtonTitles:@"Yes", nil];

    [ruSure show];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:57:28.397

你的问题是这一行：

```
objc_setAssociatedObject(self, ALERT_VIEW_DUMMY_DELEGATE_KEY, aObject, OBJC_ASSOCIATION_ASSIGN); 
```

特别是`OBJC_ASSOCIATION_ASSIGN`导致您的关联对象不被保留。为了让您的设计能够正常工作，您需要将其更改为`OBJC_ASSOCIATION_RETAIN`，如下所示：

```
objc_setAssociatedObject(self, ALERT_VIEW_DUMMY_DELEGATE_KEY, aObject, OBJC_ASSOCIATION_RETAIN); 
```

# asp.net - 如何使用 DevExpress 在 Visual Studio Web 应用程序中添加磁贴

> ID：16007201
> 
> 赞同：0
> 
> 时间：2013-04-15T03:22:28.877
> 
> 标签：asp.net, web-applications, visual-studio-2012, devexpress, tiles

我在 Windows 应用程序（WinForms）中添加并使用了[Tile Control 。](https://www.youtube.com/watch?v=_SsRalcL_58)但我无法在 Visual Studio 上的任何 Web 应用程序中使用磁贴。除了使用 Metro css，还有什么方法可以在 Visual Studio Web 应用程序中使用 DevExpress 平铺控件吗？请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:47:25.783

**来自**：[Mehul Harry 的 DevExpress 博客文章](http://community.devexpress.com/blogs/aspnet/archive/2012/12/11/q-amp-a-from-dxtreme-creating-ios-apps-webinar.aspx)

> 使用 DXTREME 为网站生成“平铺”感觉的任何方式... ????????

**答**：对于网站，您可以尝试[TileView 小部件](http://help.devexpress.com/HTML/#!UI%20Widgets/TileView)。对于 Window，`DXTREME XAML`因为它包含一个`Windows 8 Tile control`.

> ***有什么方法可以在 Visual Studio Web 应用程序中使用 DevExpress 平铺控件吗？***
> 
> ASP.NET WebForms 没有这样的控制。同时我相信使用 [ASPxDocking](http://demos.devexpress.com/aspxperiencedemos/Docking/Widgets.aspx)可以实现相同的行为。请参考我们的演示，从这个 - [停靠 - 禁区](http://demos.devexpress.com/ASPxperienceDemos/Docking/ForbiddenZones.aspx)开始。您可以使用移动平板设备测试任何演示。您可以在演示页面的相应选项卡上启用任何现有主题。

希望这可以帮助..

# gps - 如何确定 GPS 坐标是在椭圆上还是在椭圆中？

> ID：16007203
> 
> 赞同：0
> 
> 时间：2013-04-15T03:22:34.710
> 
> 标签：gps, coordinates, coordinate-systems, ellipse, coordinate-transformation

好的，所以我对在 Stack Overflow 上提问还是很陌生，所以请客气 :)

我有一个问题，我已经尝试解决了一个月，结果一次又一次地失败。我发现了各种与此有些相似的问题，但没有什么让我印象深刻的答案。

到目前为止，我发现的最接近的是： [将 GPS 坐标转换为坐标平面](https://stackoverflow.com/questions/3588653/convert-gps-coordinates-to-coordinate-plane)。

简而言之，我需要知道的是 GPS 坐标是在椭圆上还是在椭圆内。

**知道：**

*   椭圆的宽度（以米为单位）
*   椭圆的高度（以米为单位）
*   椭圆中心的 GPS 坐标（可能是坐标系上的 [0,0]）
*   测试点GPS坐标
*   测试点角度
*   到测试点的距离

**未知/需求：**

*   椭圆上点的 GPS 坐标与测试点角度
*   到椭圆上的点与测试点角度的距离

出于某种原因，请提供帮助，我只是无法围绕这个数学思考。

* * *

**更新：** 为了添加更多信息，在宏伟的计划中，这些值都非常小。

例如：如果用户想知道另一个用户是否进入了某个公园/场地/地理围栏区域或某些其他类型的物理区域。在这种情况下，物理区域被设计为椭圆。

另外，这是用 Objective-C 编写的。下面，您将看到一个随机的“+90”度，这是因为当我希望它是 Unit-Circle "Normal" 时，底层机制将 0 度视为北（导航）。

与讨论相关的代码：

```
- (BOOL)isLocation:(CLLocation *)location withinEllipse:(Ellipse *)ellipse
{
    BOOL locationIsWithinEllipse = NO;
    double ellipseWidth = ellipse.width;
    double ellipseHeight = ellipse.height;

    CLLocationDegrees locationAngleDegrees = 360 - ((int)([self headingBetweenCoordinate1:location.coordinate coordinate2:ellipse.locationCenter.coordinate] + 90) % 360);//Invert Direction
    double xOffsetInMeters = (ellipseWidth/2) * COS(DEGREES_TO_RADIANS(locationAngleDegrees));
    double yOffsetInMeters = (ellipseHeight/2) * SIN(DEGREES_TO_RADIANS(locationAngleDegrees));

    // The logic below will currently grab the Top-Right point as if it were a box, not the point on the Ellipse,
    // This is where things are broken. I need this to be the GPS Coordinate of the Point on the Ellipse with angle (locationAngleDegrees)

    // Grab the Coordinate on the Ellipse in the heading of the Test Point
    CLLocationDegrees pointLat = [ellipse.locationCenter addToLocationDistanceInMeters:yOffsetInMeters withBearingInDegrees:0].coordinate.latitude;
    CLLocationDegrees pointLong = [ellipse.locationCenter addToLocationDistanceInMeters:xOffsetInMeters withBearingInDegrees:90].coordinate.longitude;
    CLLocation * testPointOnEllipseLocation = [[CLLocation alloc] initWithLatitude:pointLat longitude:pointLong];

    // Just check if the Test Point is closer than the Distance of the Ellipse Point
    if(ABS([location distanceFromLocation:ellipse.locationCenter]) <= ABS([testPointOnEllipseLocation distanceFromLocation:ellipse.locationCenter]))
    {
        locationIsWithinEllipse = YES;
    }

    return locationIsWithinEllipse;
} 
```

* * *

**更新：**

我仍在努力使这个数学正确。我了解如何使用“学校数学”来完成它，但是如何将其应用于示例中的代码？另外，我真的不理解所有这些轮换的东西，因为我编写的所有代码都与任何轮换无关。我相信这一切都在 Apple 的低级定位中得到了处理。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T00:02:21.060

I have solved this by using some mathematical calculations from Google and guidance from the (very helpful) following question: [How to determine if a latitude & longitude is within an ellipse](https://stackoverflow.com/questions/7084725/how-to-determine-if-a-latitude-longitude-is-within-an-ellipse?rq=1)

I also used this reference for the Foci calculations: [http://www.mathopenref.com/ellipsefoci.html](http://www.mathopenref.com/ellipsefoci.html)

To quote, from Cody in the link, the primary logic: "My ellipse is relatively small so I assumed it was a true (flat) ellipse. I was able to locate the lat lon of the foci of the ellipse then if the sum of the distances from the point of interest to each focus is less than 2a (the major axis radius), then it is within the ellipse."

I do appreciate the suggestions presented! Thank You!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T09:18:35.257

解决此类任务的一种方法始终有效：
1) 将 lat,lon 转换为基于米的笛卡尔坐标系 (4-5) 行代码。
在您的情况下，我会在转换代码中使用椭圆中心作为“中心”（例如，圆柱等距投影需要中心纬度）

2）然后使用学校数学，解决任务：使用椭圆方程。

这一切都假设椭圆轴平行于赤道。如果不更新您的问题。

# python - 在 Python 中对数字进行因式分解

> ID：16007204
> 
> 赞同：7
> 
> 时间：2013-04-15T03:22:35.130
> 
> 标签：python, loops, primes, prime-factoring, sieve-of-eratosthenes

这是我的代码：

```
def factorize(n):
    sieve = [True] * (n + 1)

    for x in range(2, int(len(sieve) ** 0.5) + 1):
        if sieve[x]: 
            for i in range(x + x, len(sieve), x):
                sieve[i] = False

    lowerPrimes = i for i in range(2, len(sieve)) if sieve[i]] and (n % i == 0)]
    return lowerPrimes 
```

`factorize(n)`返回给定值的所有素因子`n`。如您所见，它首先`n`为`n`. 它为此目的工作相对较好，但是，我希望它返回一个列表，这样如果您将其中的每个项目相乘，结果就是`n`. 你明白我的意思吗？

例如，`factorize(99020)`返回`[2, 5, 4951]`，但我希望它返回`[2, 2, 5, 4951]`，如`2*2*5*4951 = 99020`。

我知道我的方法还不够接近，但你能帮我做到吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-17T12:34:34.640

[Blender 答案](https://stackoverflow.com/a/16007256/849891)中的代码非常好，但该算法在一个非常重要的方面缺乏：它测试太多。例如，尝试分解`n=392798360393`素数，它将尝试将其除以它下面的所有数字（包括它自己）。这将需要*很多*时间。

真的有必要吗？如果`n == a*b`并且`a < b`发现`a`我们真的不需要测试`n`除以`b`。我们*知道*它也分`n`，因为`n/a == b`暗示`n/b == a`。所以我们只需要在潜在因子`a`小于（或等于）潜在因子时进行测试`b`。也就是说，直到达到数字的*平方根。*

`n`此外，与其从 2 开始，不如从 2[的前一个值开始`i`](http://ideone.com/Ln9sa2)：

```
def factors(n):    # (cf. https://stackoverflow.com/a/15703327/849891)
    j = 2
    while n > 1:
        for i in xrange(j, int(sqrt(n+0.05)) + 1):
            if n % i == 0:
                n /= i ; j = i
                yield i
                break
        else:
            if n > 1:
                yield n; break 
```

实际上，`9000009`在 Ideone 上通过此代码进行分解需要 0.08 秒，而不是 0.59 秒。

这保证只产生素数（因为我们将找到的每个因子分开，并且我们以*非递减的*顺序尝试候选）。如果我们一次分解多个数字，那么首先生成素数然后仅通过素数进行测试（通过所有数字进行 aot 测试，如上所述）的开销将是值得的；只考虑一个数字可能不值得，这取决于您的素数生成的速度。

* * *

但是，当一次分解多个数字时，真正应该做的是首先创建***最小的因子*筛**，我们在给定范围内用其最小（主要）因子（由筛生成它）来标记给定范围内的每个数字只是通过`True`或`False`如在埃拉托色尼的筛子中。然后，这个最小的因子筛用于有效分解相同范围内的每个给定数字，方法是从最小的向上连续除以它们的因子，通过直接在筛中查找而不是测试可以有效地找到重新：

```
def sfs_factorize(nums):
    top = max(nums)
    sv = smallest_factor_sieve(top)
    for k in nums:
        fs = [] ; n = k
        while n > 1:
            f = sv[n]    # no testing
            n /= f
            fs.append(f)
        print( k, list(fs)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-15T03:29:23.223

埃拉托色尼筛法可帮助您找到低于特定限制的素数。它并不能真正帮助您找到特定数字的因数。

如果你想这样做，我能看到的最简单的方法是这样的：

```
def factors(n):
    while n > 1:
        for i in range(2, n + 1):
            if n % i == 0:
                n /= i
                yield i
                break

for factor in factors(360):
    print factor 
```

`n`这基本上找到了（保证为素数）的最小因子，除以`n`该数字并重复该过程直到`n`等于`1`。

输出是：

```
2
2
2
3
3
5 
```

它们乘以原始数字：

```
>>> from operator import mul
>>> reduce(mul, factors(360))
360 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-02-18T05:31:42.040

你的第一个初筛部分完全没问题。只有第二因素发现部分应该被纠正。

在第二部分中，您应该除以素数，而不仅仅是一次，而是多次，直到它仍然可以整除。这将确保您考虑所有主要因素的权力。

第二部分称为素数试除法。众所周知，仅通过以下除数进行试除就足够了`Sqrt(N)`。N 的剩余值也将自动成为素数。

对您的算法的另一项非常重要的速度改进是它足以使筛子尺寸变大`Sqrt(N)`，而不是`N`。因为我们只需要小于 的素数`Sqrt(N)`。这是因为经过试除后剩余`N`的自动变成素数。

我还为您的筛分部分发现了一项改进，您应该替换`for i in range(x + x, ...`为`for i in range(x * x, ...`. 因为你可以根据[埃拉托色尼筛的](https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)经典算法，`x + x`而不是从开始筛分。这将进一步提高速度。从开始是可以的，但也会给出正确的结果和更好的性能。`x * x``x + x``x * x`

一个更明显的改进是当你想分解多个数字时，你可以多次重用和扩展筛子，这将使代码更快。当重用筛子时，最好将得到的素数保存在一个单独的列表中，这样在第二个审判阶段你不会迭代整个筛子而只迭代素数，这又会加快速度。我没有在下面的代码中进行这两项改进，但是如果您愿意，我可以做到，请告诉。

完整更正的最终版本是：

[在线尝试！](https://tio.run/##fVHLboMwELz7K0aqKkGKEkKLVJDosV/QG/KBJktjFS3IQEv789SGhEcVZWX54J2dx7r6aU4lPz5Xuu@PlCPPDk2p1S857MYCpmpFX4QE6ZtuSWIDxY3D2Gzgb0M8IHAH2HDlpUZnANAZf5ATeAO4IHYGFnc5daa3pXJw2YxKaSdjTB1bh5IbxS1Nj1ZFzSqd8dR5mFU8dAvyKUOqpInxmhU1idHtkLW22aS4QhwsSdd2ld0DXsBrnXdN2ef1WErGt1N9n1RBYNwb4iSBv4afvW6zqiI@OspddRm7XQIlLqrG2X6e/zfL46ymptV8aQpRaftX8/9HkR/4ros7pGYR5oQenqJwL0Xf/wE "Python 3.8（预发布）——在线试用")

```
def factorize(n):
    sieve = [True] * int(n ** 0.5 + 2)

    for x in range(2, int(len(sieve) ** 0.5 + 2)):
        if not sieve[x]: 
            continue
        for i in range(x * x, len(sieve), x):
            sieve[i] = False

    factors = []
    for i in range(2, len(sieve)):
        if i * i > n:
            break
        if not sieve[i]:
            continue
        while n % i == 0:
            factors.append(i)
            n //= i
    if n > 1:
        factors.append(n)
    return factors

print(factorize(99020)) # [2, 2, 5, 4951] 
```

输入：

```
99020 
```

输出：

```
[2, 2, 5, 4951] 
```

* * *

如果您只需要分解几个数字，那么在没有中间筛选阶段的情况下进行[Trial Division Factorization](https://en.wikipedia.org/wiki/Trial_division)可能会更快。这也使代码更简单、更短。

下面是在没有筛选阶段的情况下进行分解的完整代码。

在这段代码中，我通过只尝试奇数除数做了一个明显的速度改进，这将使总算法速度加倍。当然，要做到这一点，您需要先排除 2 的所有幂，我也这样做了。

[在线尝试！](https://tio.run/##dVDLCsIwELz3KwZESaRoUx9YMf0R8VBNqkHZhlgR/fkajVoFXdjLzOzuzNpLvatoNLOuaZQuURabunLmqhnxeQRfATlCYrl6AOedOWgwQg@CQ0okQfghHhTWalIs5W@GkOcSIqysHBQMwRW01WwUQ2CxwDSJkfJ2mSm9qu87B7XovdZOF/s3EgwRul76beeHJcW/WMJwKKGi5z3vEuJvHAqzTtcnRy8yiqwzVLP2c1mWpAnn6GCZ@kQxJjHG2USsmuYG "Python 3.8（预发布）——在线试用")

```
def factorize(n):
    factors = []
    while (n & 1) == 0:
        factors.append(2)
        n >>= 1
    for d in range(3, 1 << 60, 2):
        if d * d > n:
            break
        while n % d == 0:
            factors.append(d)
            n //= d
    if n > 1:
        factors.append(n)
    return factors

print(factorize(99020)) # [2, 2, 5, 4951] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T03:29:03.323

我不太熟悉这个问题是否应该被删除或其他什么，但无论如何我都会提供帮助。

我认为你的筛子部分是正确的。关键是使用一个`while`循环来不止一次地划分出一个有效的素数。

```
factors = []
sieve[0] = sieve[1] = False # So I don't have to worry about trying to skip over these two
for testFactIndex, isPrime in enumerate(sieve):
    if isPrime:
        while n%testFactIndex == 0:
            n = n/testFactIndex
            factors.append(testFactIndex)
return factors 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-10-19T18:51:09.350

我使用 python 3.8 的单线器（使用了赋值表达式）

```
f = lambda n: (p:=[next(i for i in range(2, n+1) if n % i == 0)] if n>1 else [])+(f(n//p[0]) if p else []) 
```

[包含详细信息的视频 - Python 中的因式分解数字](https://www.youtube.com/watch?v=mq0nCzeWlYs)

# json - 如何确保在 Aspectj 和 AOP 中匹配相同连接点的两个切点的顺序建议

> ID：16007206
> 
> 赞同：0
> 
> 时间：2013-04-15T03:23:14.193
> 
> 标签：json, spring, aop, aspectj, pointcut

我打算使用 Spring AOP 使用 Spring Security。对于控制器类上的所有公共方法，它将有自己的切入点。这些方法将由类名和公共方法挑选出来，也许是部分参数签名。

我还想封装检查标头、良好 json、良好 json 请求对象和身份验证的代码，并将其插入控制器类的公共方法中。由于我将同时拥有 JSON-RPC 和 JSON-REST，因此访问上述公共方法的共有三个切入点。

Spring Security 将在所有方法上插入建议，JSON-RPC 切入点将处理该控制器类，而 JSON-REST 切入点将处理其控制器类。

如何保证两条建议的运行顺序？我希望安全的东西首先运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:47:42.120

您可以使用`@Order`注释

[http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/core/annotation/Order.html](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/core/annotation/Order.html)

您尚未提供有关如何设置 aop 的更多信息，以准确指出如何在您的结构中使用它。

您可以实现 Ordered 接口，然后通过 xml 配置传递订单，例如 -

```
<bean id="xyz" class="com.abc.XYZ">
     <property name="order" value="34"/>  
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T03:32:54.283

一个很好的答案链接： [aspect ADK 1.5 Notebook](http://eclipse.org/aspectj/doc/next/adk15notebook/ataspectj-declare.html)

我想引用的另一个链接： [回答](http://doanduyhai.wordpress.com/2012/01/01/advanced-aspectj-part-iv-declaring-aspects-precedence/)

> 要声明方面优先级，可以使用特殊关键字
> 
> ```
> declare precedence : <Type1Pattern>,<Type2Pattern>…&lt;TypeNPattern>; 
> ```
> 
> 在上面的例子中，aspect1 优先于aspect2，aspect2 又优先于aspect3 等等，直到aspectN。
> 
> “优先于”，我们的意思是“在之前执行”。通常，最高的方面首先执行。执行顺序还取决于通知的类型。
> 
> ```
> the aspect with highest precedence kicks in before the lowest precedence aspect for before() advice
> the aspect with highest precedence kicks in after the lowest precedence aspect for after() advice
> the aspect with highest precedence wraps around the lowest precedence aspect for around() advice 
> ```
> 
> AspectJ 中的一个最佳实践是声明一个特殊方面，其任务只是声明其他方面的优先级。
> 
> 示例：公共方面 MyAspectsOrdering { 声明优先级：around1, around2, before3, before4, after5; 声明优先级：Transactional*, around4; 声明优先级：*, before2; }

# android - 致命异常：与 doInBackground() 相关的 AsyncTask #1

> ID：16007210
> 
> 赞同：2
> 
> 时间：2013-04-15T03:23:44.420
> 
> 标签：android, android-asynctask, nosuchmethoderror

运行代码时出现致命异常：AsyncTask #1。日志告诉我这是由 NoSuchMethodError 指向`com.google.api.client.http.HttpHeaders.set`. 我正在使用适用于 Android 的 Factual java 驱动程序，并且在运行该代码时出现此错误。

为什么我会得到这个？我能做些什么来解决它？

这是错误指向的代码：

```
 @Override
    protected List<ReadResponse> doInBackground(Query... params) {
        List<ReadResponse> results = Lists.newArrayList(); 
        for (Query q : params) {
            results.add(factual.fetch("restaurants-us", q));
        }
        return results;
    } 
```

我得到的错误日志在这里：

```
04-14 18:07:43.731: E/AndroidRuntime(12714): FATAL EXCEPTION: AsyncTask #1
04-14 18:07:43.731: E/AndroidRuntime(12714): java.lang.RuntimeException: An error occured while executing doInBackground()
04-14 18:07:43.731: E/AndroidRuntime(12714):    at android.os.AsyncTask$3.done(AsyncTask.java:200)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.lang.Thread.run(Thread.java:1027)
04-14 18:07:43.731: E/AndroidRuntime(12714): Caused by: java.lang.NoSuchMethodError: com.google.api.client.http.HttpHeaders.set
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.factual.driver.Factual.request(Factual.java:668)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.factual.driver.Factual.request(Factual.java:614)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.factual.driver.Factual.request(Factual.java:610)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.factual.driver.Factual.get(Factual.java:343)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.factual.driver.Factual.fetch(Factual.java:110)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.example.blobtag2.PlaceActivity$FactualRetrievalTask.doInBackground(PlaceActivity.java:139)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at com.example.blobtag2.PlaceActivity$FactualRetrievalTask.doInBackground(PlaceActivity.java:1)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-14 18:07:43.731: E/AndroidRuntime(12714):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-14 18:07:43.731: E/AndroidRuntime(12714):    ... 4 more 
```

非常感谢任何帮助，如果我能提供其他任何帮助，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:39:59.163

看起来您的库 Factual 正在调用一个不存在的函数。您确定它适用于您的 Android 版本吗？

# c - 我可以通过 C 宏自动收集函数列表吗

> ID：16007214
> 
> 赞同：0
> 
> 时间：2013-04-15T03:22:17.390
> 
> 标签：c, gcc

我想自动收集开始 FUN_BEGIN() 和 FUN_END() 宏的函数列表，如果我把它写成：

```
FUN_BEGIN()

FUN_DEFINE(f1) {
    printf("f1\n"); }

FUN_DEFINE(f2) {
    printf("f2\n"); }

FUN_DEFINE(f3) {
    printf("f3\n"); }

FUN_END() 
```

代码将展开如下：

```
static bool f1(void) 
{
    printf("f1\n");
}

static bool f2(void)
{
    printf("f2\n");
}

static bool f3(void)
{
    printf("f3\n");
}

void global_fun(void)
{
    f1();
    f2();
    f3();
} 
```

我可以释放它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:13:06.607

这是一种使用构造函数添加到列表的方法，允许您使用的确切语法。

```
#define FUN_BEGIN() struct __fun_list { \
    struct __fun_list *next; \
    bool (*f)(void); \
} *head = NULL; \
static void globals_list_add(bool (*f)(void)) { \
    /* add f to the linked list... */ \
}

#define FUN_DEFINE(f) static bool f(void);\
    static void __attribute__((constructor)) __construct_##f(void) {\
        globals_list_add(f); \
    } \
    static bool f(void)

#define FUN_END() void global_fun(void) { \
    struct __fun_list *cur; \
    for(cur = head; cur; cur = cur->next) { \
        cur->f(); \
    } \
} 
```

请注意，构造函数不一定按照它们声明的顺序调用，因此您可能需要`__LINE__`在宏中使用定义的行号对列表进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:41:08.547

一种选择可能是将您的定义放在单独的文件中

`funcs.def`：

```
FUN_DEFINE(f1) {
    printf("f1\n"); }

FUN_DEFINE(f2) {
    printf("f2\n"); }

FUN_DEFINE(f3) {
    printf("f3\n"); } 
```

然后在不同的源文件中，执行类似的操作

```
#define FUN_DEFINE(name) static bool name(void)
#include "funcs.def"
#undef FUN_DEFINE

void global_fun(void) {
#define FUN_DEFINE(name) name();
#include "funcs.def"
#undef FUN_DEFINE
} 
```

这种方法有一个名字，但我不记得了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T19:30:15.163

替代解决方案：

```
typedef bool (*func_t) (void);

// ...place function prototypes anywhere in scope

funct_t test_functions [] = 
{
  &f1,
  &f2,
  &f3
};

#define TEST_FUNCTIONS_N (sizeof(test_functions) / sizeof(funct_t))

void global_fun(void)
{
  for(size_t i=0; i<TEST_FUNCTIONS_N; i++)
  {
    test_functions[i]();
  }
} 
```

# c# - 为 xaml 更新列表视图中的选定行

> ID：16007215
> 
> 赞同：0
> 
> 时间：2013-04-15T03:24:20.333
> 
> 标签：c#, wpf

我在列表视图中有一个按钮，当我单击该按钮时，数据模板应将值加 1。我只想更新特定的行，但是当我单击按钮时，所有行都会更新。有人能帮我吗？尝试了许多解决方案，但它根本无法工作。这些是我的 xaml 代码

```
<ListView.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal" Width="1048" Height="158">
                <StackPanel.Background>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="White" Offset="0.971"/>
                        <GradientStop Color="#FF929990" Offset="1"/>
                    </LinearGradientBrush>
                </StackPanel.Background><Button x:Name="btnVote" BorderBrush="Black" BorderThickness="2" Height="45" Margin="0,70,0,43" Width="78" Content="Vote" Background="Black" Click="btnVote_Click" />
                <Image HorizontalAlignment="Left" Height="111" Margin="10,10,0,0" Grid.Row="1" VerticalAlignment="Top" Width="118" Source="{Binding Img}"/>
                <HyperlinkButton Tag="{Binding UserID}" FontSize="20" ScrollViewer.VerticalScrollBarVisibility="Visible" Content="{Binding Name}" Width="918" Height="48" Margin="0,12,0,98" Foreground="Black" Tapped="HyperlinkButton_Tapped_1" HorizontalContentAlignment="Left"/>
                <TextBlock FontSize="18" ScrollViewer.VerticalScrollBarVisibility="Visible" Text="{Binding Comment}" Width="884" Height="56" Margin="-930,59,0,43" Foreground="Black"/>
                <TextBlock ScrollViewer.VerticalScrollBarVisibility="Visible" Text="{Binding DateTime}" Width="583" Height="36" Margin="-1230, 90, 0,0" Foreground="Black"/>
                <TextBlock  ScrollViewer.VerticalScrollBarVisibility="Visible" Text="{Binding Votes}"  Margin="-500,100,0,10" Width="321" Height="48" Foreground="Black"/>
            </StackPanel>

        </DataTemplate>
    </ListView.ItemTemplate>
    <TextBlock Height="81" TextWrapping="Wrap" Text="TextBlock" Width="273"/>
</ListView> 
```

我的按钮的 xaml.cs 代码

```
private async void btnVote_Click(object sender, RoutedEventArgs e)
{
    MyLearningStory.Clear(); 
    addVotes();
    retrieveLearningStory();

    //Service1Client updateclient = new Service1Client();
    //string update = await updateclient.updateVotesAsync(userId);

} 
```

以及 getlearningstory() 的方法

```
public async void retrieveLearningStory()
{
    btnShowMore.IsEnabled = true;
    Service1Client retrieveClient = new Service1Client();

    if (firstRun == true)
    {
        if(userId!=""){/*
            learningStoryComment.AddRange(await retrieveClient.retrieveLearingStoryCommentAsync(userId, storyId));
            learningStoryDatetime.AddRange(await retrieveClient.retrieveLearingStoryDatetimeAsync(userId, storyId));
            learningStoryImg.AddRange(await retrieveClient.retrieveLearingStoryImgAsync(userId, storyId));
                        */
            learningStoryComment.AddRange(await retrieveClient.retrieveLearingStoryCommentByStoryIDAsync(storyId));
            learningStoryDatetime.AddRange(await retrieveClient.retrieveLearingStoryDateTimeByStoryIDAsync(storyId));
            learningStoryImg.AddRange(await retrieveClient.retrieveLearingStoryImgByStoryIDAsync(storyId));
            learningStoryUserId.AddRange(await retrieveClient.retrieveLearingStoryUserIDByStoryIDAsync(storyId));

            }
    }

    await Task.Delay(1000);

    string name = "";
    Service1Client client1 = new Service1Client();

    if(userId==null){
        userId = roamingSettings.Values["userID"].ToString();

    }

    if (firstRun == true)
    {
        initialValue = 0;
        firstRun = false;
        currentUserId = userId;

    }
    //finding the  author of the learningstory
    for (int a = initialValue; a < learningStoryComment.Count; a++)
    {

        if (a == (learningStoryComment.Count-1))
        {
            InMemoryRandomAccessStream randomAccessStream = new InMemoryRandomAccessStream();
            DataWriter writer = new DataWriter(randomAccessStream.GetOutputStreamAt(0));
            writer.WriteBytes(learningStoryImg[a]);
            await writer.StoreAsync();
            // Create bitmap image
            BitmapImage b = new BitmapImage();
            b.SetSource(randomAccessStream);

            name = await retrieveClient.retrieveNameByUserIDAsync(learningStoryUserId[0]);
           // status = await retrieveClient.RetrieveUserStatusAsync(learningStoryUserId[0]);

            imgFirstPost.Source = b;
            txtFirstPostComment.Text = learningStoryComment[a];
            txtFirstPostDateTime.Text = learningStoryDatetime[a].ToString();
            hbtnName.Content = name;
            hbtnName.Tag = currentUserId;

        }

    }

    //finding the other user that posted in the learningstory
    // for (int a = learningStoryComment.Count - 1; a > -1; a--)

    //tbvotesdisplay = count.ToString();
    for (int a = initialValue; a < learningStoryComment.Count; a++)
    {
        count++;
        InMemoryRandomAccessStream randomAccessStream = new InMemoryRandomAccessStream();
        DataWriter writer = new DataWriter(randomAccessStream.GetOutputStreamAt(0));
        writer.WriteBytes(learningStoryImg[a]);
        await writer.StoreAsync();
        // Create bitmap image
        BitmapImage b = new BitmapImage();
        b.SetSource(randomAccessStream);
        name = await client1.retrieveNameByUserIDAsync(learningStoryUserId[a]);
        //vote = await client1.retrieveVotesAsync(learningStoryUserId[a]);
        //status = await retrieveClient.RetrieveUserStatusAsync(learningStoryUserId[a]);

        if (a != (learningStoryComment.Count - 1))
        {
               MyLearningStory.Add(new LearningStoryItem(learningStoryComment[a], name, learningStoryDatetime[a], b, 1, userId, votescount));

        }
   lvLearningStory.DataContext = MyLearningStory; 
```

我的加票方式

```
 public async void addVotes()
    {
        votescount++;
    } 
```

我的 listview.datacontext 类

```
 public class LearningStoryItem
{
      public BitmapImage Img { get; set; }
    public string Comment{ get; set; }
   public DateTime DateTime { get; set; }
   public string Name {get; set;}
   public int StoryID { get; set; }
   public string UserID { get; set; }
   public string LastCommented { get; set; }
   public string View { get; set; }
   public double Votes { get; set; }

   public LearningStoryItem(double votes)
   {
       Votes = votes;
   }

    public LearningStoryItem(string comment, DateTime datetime, BitmapImage img)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Votes = 200;
    }
    public LearningStoryItem(string comment)
    {
        Comment = comment;
    }
    public LearningStoryItem(int storyid)
    {
       StoryID = storyid;

    }

    public LearningStoryItem(string comment, string name, DateTime datetime, BitmapImage img)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Name = name;

        Votes = 200;
    }
    public LearningStoryItem(string comment, string name, DateTime datetime, BitmapImage img, int storyid)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Name = name;
        StoryID = storyid;

        Votes = 200;
    }
    public LearningStoryItem(string comment, string name, DateTime datetime, BitmapImage img, int storyid, string userid,double votes)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Name = name;
        StoryID = storyid;
        UserID = userid;

        Votes = votes;

    }
    public LearningStoryItem(string comment, string name, DateTime datetime, BitmapImage img, int storyid, string userid,string lastCommented)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Name = name;
        StoryID = storyid;
        UserID = userid;
        LastCommented = lastCommented;

        Votes = 200;
    }
    public LearningStoryItem(string comment, string name, DateTime datetime, BitmapImage img, int storyid, string userid, string lastCommented,string view)
    {
        Comment = comment;
        DateTime = datetime;
        Img = img;
        Name = name;
        StoryID = storyid;
        UserID = userid;
        LastCommented = lastCommented;
        View = view;

        Votes = 200;
    }

    public LearningStoryItem(DateTime datetime)
    {
        DateTime = datetime;

        Votes = 200;
    }
    public LearningStoryItem(BitmapImage img)
    {
        Img = img;

        Votes = 200;
    }
    public LearningStoryItem(int storyid,string userid)
    {
        StoryID = storyid;
        UserID = userid;

        Votes = 200;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:30:47.110

您需要发送`addVotes`一些 id 以增加特定的投票值。如果我理解正确，你`btnVote_Click`现在增加所有选票。

编辑： 1）将 UserId 保存到`Tag`

```
 <Button x:Name="btnVote" BorderBrush="Black" Tag="{Binding UserID}"  BorderThickness="2" Height="45" Margin="0,70,0,43" Width="78" Content="Vote" Background="Black" Click="btnVote_Click" /> 
```

2）改变`btnVote_Click`

私人无效btnVote_Click（对象发送者，RoutedEventArgs e）{

```
 string userId = (string)(sender as Button).Tag;

         //getting `LearningStoryItem` by id from ListViewDataContext
        LearningStoryItem itemForRefresh = dataContext.Single(item => item.UserID == userId);
        //refresh only clicked item
        itemForRefresh.Votes = itemForRefresh.Votes+1;
        itemForRefresh.Comment = "new comment";

    } 
```

3) 在中使用 DependencyProperties`LearningStoryItem`

```
public class LearningStoryItem:DependencyObject

private static DependencyProperty voteProperty;

    static LearningStoryItem()
    {
        var votePropertyMetadata = new FrameworkPropertyMetadata(Convert.ToDouble(0),
                                                                      FrameworkPropertyMetadataOptions.AffectsRender);
        voteProperty = DependencyProperty.Register("Votes",
                                                       typeof(double),
                                                       typeof(LearningStoryItem),
                                                       votePropertyMetadata);
    }

    public double Votes {
        get { return (double) GetValue(voteProperty); } 
        set {SetValue(voteProperty,value); }  
    } 
```

# android - 如何保存 Float 对象的 ArrayList 以便在我的 Activity 重新启动时检索它？

> ID：16007216
> 
> 赞同：0
> 
> 时间：2013-04-15T03:24:25.447
> 
> 标签：android, orientation, dynamic-memory-allocation

我有个问题。存储 Float 对象的 ArrayList 的最佳方法是什么，以便我可以在我的 Activity 由于切换设备方向而重新启动时重新加载 ArrayList？我曾考虑过使用 Bundle，但后来我不得不扩展 Float 类以使其实现 Parcelable。由于该课程已被宣布为最终课程，不幸的是，我不能这样做。我做了一些搜索，并且遇到了一些类似问题的解决方案，例如覆盖 onRetainNonConfigurationInstance()。我还考虑为浮动原语创建自己的基本包装类，并使其可打包。必须注意的是，我希望保存的 ArrayLists 在类中，其实例是在我的 Activity 的 DrawView 实例中创建的。

我还不想发布任何代码，因为除了研究可能的解决方案之外，我没有做任何事情来解决这个问题。如果你们需要看，请告诉我，我会很乐意发布。

在相关的说明中，我决定使用 ArrayLists 的原因是因为我想使用某种形式的动态内存分配。因为，由于我的应用程序的性质，我无法预测数组上有多少对象，所以我想有一些方法来分配尽可能多的内存来存储 Float 对象。说实话，我只需要存储浮点基元，但 ArrayLists 需要非基元 无论如何，由于你们知道更好的方法来做到这一点，因为使用 ArrayLists 和浮点数来存储基元值对我来说似乎有点笨拙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T06:03:30.490

该`NonConfig`方法现在（从 API 13/Android 3.2 开始）已弃用，但这在实践中意义不大，特别是如果您想支持较旧的 API 级别，因为弃用的方法通常会保留很长时间。[截至今天，根据谷歌官方数据，Android 2 aka APIs 8 到 10 的市场份额为 43.8%（注意：该页面会定期更新）](http://developer.android.com/about/dashboards/index.html)，许多 2.3（API 9 或 10）设备目前正在销售预算细分市场。因此，如果您不想支持这些，请三思而后行，并请放心，Google 不会`NonConfig`很快禁用这些方法。

好的部分是它们在资源消耗`onRetainNonConfigurationInstance()`和`getLastNonConfigurationInstance()`实施工作方面都非常有效。由于几乎 50% 的设备没有提供任何更好的方法，这只是今天要走的路。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T03:34:29.983

带有浮点数组的静态类怎么样？

# c++ - 全局智能指针未正确清理

> ID：16007223
> 
> 赞同：2
> 
> 时间：2013-04-15T03:25:15.847
> 
> 标签：c++, memory-leaks, c++11, shared-ptr, smart-pointers

我有一个 c++ 接口，并且该接口的派生类在一个 DLL 中，我通过包含接口头文件并导入返回派生类对象（COM 样式）的工厂函数在另一个进程中使用该类：

```
MyInterface
{
public:
 virtual ~MyInterface(){}
 virtual A() = 0;
}

MyDerivedClass : MyInterface
{
 public:
 virtual ~MyDerivedClass (){...};
 A(){...};
}

__declspec(dllexport) MyInterface* getObject()
{
 return (new MyDerivedClass());
} 
```

当我在我的 DLL（单元测试）中进行测试时，我会这样做：

```
std::tr1::shared_ptr<MyInterface> MyInterfaceObj; //global

func1() //initilize
{
 std::tr1::shared_ptr<MyInterface> temp(getObject());
 MyInterfaceObj.swap(temp);
}

func2()
{
 //use MyInterfaceObj;
} 
```

一切正常，我使用视觉检漏仪，没有任何抱怨，我可以看到调用了 MyDerivedClass 析构函数。

但是，当我在我的进程（加载 DLL）中执行完全相同的操作时，MyDerivedClass 析构函数永远不会被调用，并且 VLD 会抱怨内存泄漏。

但是，如果我在 func2() [在我的过程中] 声明所有内容，则一切正常，没有泄漏，并且调用了析构函数：

```
func2()
{
 std::tr1::shared_ptr<MyInterface> MyInterfaceObj; // not global anymore
 std::tr1::shared_ptr<MyInterface> temp(getObject());
 MyInterfaceObj.swap(temp); //I know this is useless here, just wanted to have the same steps as before
 //use MyInterfaceObj;
} 
```

我需要在我的流程中拥有第一个结构（一个全局变量，由一个函数初始化，然后在心跳函数中使用）。

任何想法为什么会发生这种情况？！，我试图创建一个函数来释放内存（它有“删除这个”）并将它传递给智能指针构造函数，但它不会改变任何东西。

（使用视觉 c++ 2008 sp1）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:57:51.463

无法保证全局变量的破坏顺序。在 DLL 中的测试代码的情况下，它显然在泄漏检测发生之前破坏了全局，但是当你在应用程序中拥有它时它不会。它仍然会在应用程序退出之前被销毁。

当您在函数内部而不是全局变量中具有变量时，它将仅存在于函数范围内。它将在函数结束时被销毁。

# php - Heredoc 并没有像我被告知的那样保留文字

> ID：16007224
> 
> 赞同：2
> 
> 时间：2013-04-15T03:25:35.373
> 
> 标签：php, heredoc

我刚刚开始阅读 O'Reilly 关于 PHP、MySQL 和 JavaScript 的书，而且我刚刚到了学习 heredocs 的阶段。它在书中说他们按字面意思保留文本，但我的根本没有。我什至完全按照书中的内容复制了代码，但它仍然没有运行，我被告知应该这样做。

我希望我的代码保留heredoc中的换行符，但它只是不想这样做，我可以让它这样做的唯一方法是使用“ `< br />`”标签。

这是我的代码：

```
<?php
$author = "Bobby McBobson";

$text = <<<_END
This is a Headline.

This is the first line.
This is the second line.
- Written by $author.
_END

echo $text;
?> 
```

无论我使用什么代码变体，它总是像这样出现：

```
This is a Headline. This is the first line. This is the second. -Written by Bobby McBobson 
```

而我希望它出来为：

```
This is a Headline.

This is the first line.
<br/>This is the second.
<br/>-Written by Bobby McBobson 
```

即使在这里，我也不得不使用`< br />`标签（由于明显的原因分解），所以我认为我缺少一些基本的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T03:59:58.933

换行符被保留，但是当写成 HTML 时，这些换行符失去了意义；要在 HTML 中添加格式，您应该使用`nl2br()`：

```
echo nl2br($text); 
```

您也可以将它们包装在内部`<pre>`或具有该`white-space: pre;`样式的其他标签中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-01T22:50:34.473

这是从书中引用的。这是一页左右。

> 将文本布置在多行上通常只是为了让您的 PHP 代码更易于阅读，因为一旦它显示在网页中，HTML 格式规则就会接管并禁止空格（但 $author 仍然被替换为变量的值）。因此，例如，如果您将这些多行输出示例加载到浏览器中，它们将不会显示多行，因为所有浏览器都将换行符视为空格。但是，如果您使用浏览器的查看源代码功能，您会发现换行符放置正确，并且输出确实出现了多行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T03:32:17.740

```
<?php
$author = "Bobby McBobson";

$text = <<<_END
This is a Headline.<br /><br />

This is the first line.<br />
This is the second line.<br />
- Written by $author.<br />
_END;

echo $text;
?> 
```

works fine for me, don't forget the semicolon after END to close the variable $text definition. You really need the `<br />` tags if you want a new line otherwise it will just interpret as text. EDIT: Actually the code without HTML stays formatted when I try it on [http://sandbox.onlinephpfunctions.com/](http://sandbox.onlinephpfunctions.com/) but loses its formatting on [http://writecodeonline.com/php/](http://writecodeonline.com/php/)

Not sure why?

# json - 将带有前缀（冒号）的 KML 解析为 json

> ID：16007226
> 
> 赞同：0
> 
> 时间：2013-04-15T03:25:50.787
> 
> 标签：json, parsing, google-maps-api-3, kml

我有一些由 Google My Tracks 创建的 KML 文件。我想将它转换为 json 格式，以便我可以访问特定的时间点和地点。但是，KML 标记具有前缀（例如`<gx:SimpleArrayField>`和`<gx:coord>`），这会在使用“xml2json”进行解析时导致问题。即使我尝试使用 xml2json`$('gx\\:coord')`来逃避，xml2json 也无法识别 gx:coord。

此外，内部有三个值（经度、纬度和高度），它们仅由空格分隔（看起来像`<gx:coord>-73.994146 40.735471 13.800000190734863</gx:coord>`）我如何将它们分隔成三个不同的元素？

有没有人为此推荐解析器或解决方案？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:02:03.530

刚刚意识到不是用它的完整原始名称（例如：）来调用元素，`<gx:coord>`我只需要在冒号之后用它的缩短名称来调用它。（例如`<coord>`：）使用 xmltojson 解析后。

# c++ - 我可以在不返回 void 的函数中不返回值而侥幸吗？

> ID：16007233
> 
> 赞同：-1
> 
> 时间：2013-04-15T03:26:45.637
> 
> 标签：c++, c

在 C 中，当函数的返回类型为 say`int`并且我没有在函数中包含返回调用时，我只会收到警告。

这可以接受吗？

```
int foo()
{
    int number = 0;
} 
```

返回值是多少？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T03:30:11.493

标准第 6.6.3 节包括以下规则：

> 既没有表达式也没有花括号初始化列表的 return 语句只能用于不返回值的函数，即返回类型为 void、构造函数 (12.1) 或析构函数 (12.4) 的函数. 带有非 void 类型表达式的 return 语句只能用于返回值的函数；表达式的值返回给函数的调用者。表达式的值被隐式转换为它出现的函数的返回类型。return 语句可能涉及临时对象 (12.2) 的构造和复制或移动。带有花括号初始化列表的 return 语句通过指定初始化列表中的复制列表初始化 (8.5.4) 初始化要从函数返回的对象或引用。
> 
> **从函数的末尾流出相当于没有值的返回；这会导致值返回函数中的未定义行为。**

请注意，仅当函数的右大括号可访问时，这才是问题。如果执行总是采用具有 的分支，`return {value}`则没有问题。

# android - 数组中每个对象的速度在碰撞时发生变化

> ID：16007236
> 
> 赞同：0
> 
> 时间：2013-04-15T03:27:02.230
> 
> 标签：android, andengine

我正在 AndEngine 中开发一款游戏，并且我有一系列汽车 sprties。我正在检查它们何时与屏幕上的其他对象发生碰撞，当它们发生碰撞时，该数组的单个索引应该改变它的速度。但是，屏幕上每辆车的速度也会发生变化。

任何帮助，将不胜感激。请在下面找到附加代码：

```
this.registerUpdateHandler(new IUpdateHandler() {
        @Override
        public void onUpdate(final float pSecondsElapsed) {
            for (int i = 0; i < rManager.getInstance().carArray.length; i++)
            {
                if(rManager.getInstance().carArray[i].getCarSprite().collidesWith(rManager.getInstance().iceArray[i].getIceSprite())) {
                    Log.e("test", "ice collision");
                    rManager.getInstance().carArray[i].setCarSpeed(3f);
                } else {
                    rManager.getInstance().carArray[i].setCarSpeed(0.5f);
                }
            }
        }

        @Override
        public void reset() {
            // TODO Auto-generated method stub

        }
    }); 
```

更新代码：

```
for (int i = 0; i < rManager.getInstance().carArray.length; i++)
                {
                    for (int j = 0; j < rManager.getInstance().iceArray.length; j++)
                    {
                        if(rManager.getInstance().carArray[i].getCarSprite().collidesWith(rManager.getInstance().iceArray[j].getIceSprite())) {
                            Log.e("log", "CAR COLLIDED WITH ICE LOL");
                            rManager.getInstance().carArray[i].setCarSpeed(3f);
                        } else {
                            rManager.getInstance().carArray[i].setCarSpeed(1f);
                        }
                    }
                } 
```

更新代码2：

```
@Override
protected void onManagedUpdate(float pSecondsElapsed) {

            for (int i = 0; i < rManager.getInstance().carArray.length; i++)
            {                       
                for (int j = 0; j < rManager.getInstance().iceArray.length; j++)
                {
                    if(this.getX() < (rManager.camera.getWidth() + this.getWidth())){
                        this.setPosition(this.getX() + (rManager.getInstance().carArray[i].getSpeed() + speedMod), this.getY());
                    } else {
                        this.setPosition(0 - this.getWidth(), this.getY());
                    }

                    if (rManager.getInstance().iceArray[j].getIceSprite().collidesWith(rManager.getInstance().carArray[i].getCarSprite()))
                    {
                        Log.e("log", "car collided with ice");
                        this.setPosition(this.getX() + (rManager.getInstance().carArray[i].getSpeed() + 2f), this.getY());
                    }
                }
            }               

            super.onManagedUpdate(pSecondsElapsed);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:41:43.373

First, notice that you are accessing to the array of (IceSprites) using the index of the cars. If you have a different number of these elements you can have exceptions.

Your code is only checking if each car collides with one ice sprite element. Is this what you want?

*rManager.getInstance().**carArray[i]**.getCarSprite().collidesWith(rManager.getInstance().**iceArray[i]**.getIceSprite())*

Maybe you want to check if your car collides with any ice element presented in your world. No? In that case you will need another loop for the ice elements.

I hope this helps,
Best Regards

# postgresql - postgresql - 检索部分索引 WHERE 表达式

> ID：16007240
> 
> 赞同：3
> 
> 时间：2013-04-15T03:27:35.887
> 
> 标签：postgresql

我将如何运行查询（在 PostgreSQL 内部表上）来检索部分索引的条件表达式（`roles_user_group_role_idx`在这种情况下如下）。

```
# \d roles
                                Table "public.roles"
    Column     |            Type             |               Modifiers               
---------------+-----------------------------+---------------------------------------
 id            | character varying(15)       | not null default next_id('r'::bpchar)
 user_id       | character varying(15)       | not null
 group_id      | character varying(15)       | not null
 role          | character varying(255)      | not null
 language_code | character varying(2)        | 
 created_at    | timestamp without time zone | not null
 updated_at    | timestamp without time zone | not null
Indexes:
    "roles_pkey" PRIMARY KEY, btree (id)
    "roles_user_group_role_idx" UNIQUE, btree (user_id, group_id, role) WHERE language_code IS NULL 
```

根据[PostgreSQL pg_index doc](http://www.postgresql.org/docs/9.2/static/catalog-pg-index.html)， pg_index.indpred 似乎是我需要研究的领域。运行此查询：

```
SELECT
    C.oid,
    I.indpred
FROM pg_catalog.pg_class C,
     pg_catalog.pg_namespace N,
     pg_catalog.pg_index I
WHERE C.relname = 'roles_user_group_role_idx'
  AND C.relnamespace = N.oid
  AND I.indexrelid = C.oid
  AND N.nspname = 'public'; 
```

给了我这个，不完全在那里。

```
 oid   |                                                                                  indpred                                                                                  
---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1235504 | {NULLTEST :arg {VAR :varno 1 :varattno 5 :vartype 1043 :vartypmod 6 :varcollid 100 :varlevelsup 0 :varnoold 1 :varoattno 5 :location 95} :nulltesttype 0 :argisrow false} 
```

我在正确的方向吗？如何获取部分索引的 WHERE 子句？我正在使用 PG 9.2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T03:34:40.157

好吧，经过一番谷歌搜索后，我在[这里](http://comments.gmane.org/gmane.comp.db.postgresql.general/165841)找到了答案，正确的查询：

```
SELECT
    C.oid,
    pg_get_expr(I.indpred, I.indrelid)
FROM pg_catalog.pg_class C,
     pg_catalog.pg_namespace N,
     pg_catalog.pg_index I
WHERE C.relname = 'roles_user_group_role_idx'
  AND C.relnamespace = N.oid
  AND I.indexrelid = C.oid
  AND N.nspname = 'public'; 
```

结果：

```
 oid   |       pg_get_expr       
---------+-------------------------
 1235504 | (language_code IS NULL) 
```

# sql-server - 物化查询结果不支持此方法

> ID：16007250
> 
> 赞同：2
> 
> 时间：2013-04-15T03:28:42.830
> 
> 标签：sql-server, linq

我正在尝试使用 LINQ Lambda 链接许多表，但是在处理子查询以获取 ProducedBy 属性的值时遇到问题。我收到一条消息：**物化查询结果消息不支持此方法**。

可以帮帮我吗？

```
 var temp = db.MK_Product_Variant
                .Join(db.MK_Products, a => a.ProductId, b => b.ID, (a, b) => new { a, b })
                .Join(db.MK_Product_Category, c => c.b.CategoryId, d => d.ID, (c, d) => new { c, d })
                .Join(db.MK_Game_Type, e => e.d.GameType, f => f.ID, (e, f) => new { e, f })
                .Where(g=> !db.MK_MP_Variant.Select(h=>h.ID).Contains( g.e.c.a.ID)) /* My Store only */
                .Select(i => new { 
                    Category = i.e.d.Name, 
                    ItemType = i.f.Name, 
                    ItemNo = i.e.c.a.ID, 
                    Enabled = i.e.c.b.Enabled,
                    Status = "", 
                    ProducedBy = (db.MK_Products.Join(db.MK_Production_Resource,k=>k.ID,l=>l.Item,(k,l) => new {k,l})
                    .Join(db.MK_Production_Staff,m=>m.l.Staff,n=>n.ID,(m,n) => new {m,n})
                    .Where(o => o.m.k.ID == i.e.c.a.ID)
                    .Select(p=>p.n.Location).DefaultIfEmpty("").ToList())[0],
                    ReleaseDate = i.e.c.a.ReleaseDate, 
                    ReleasingQty = i.e.c.a.Qty, 
                    Price = i.e.c.a.Price_MKD, 
                    QtyPurchaseFromUser = "", 
                    QtySold = db.MK_Product_VariantHistory.Where(j => j.Variant == i.e.c.a.ID && j.PurchaseDate >= startDate && j.PurchaseDate <= stopDate && !(db.MK_MP_Variant.Select(t => t.ID)).Contains(i.e.c.a.ID)).Count() 
                }); 
```

这是我要使用它的代码行：

```
 int count = 0;

            foreach (var item in temp)
            {
                result.Add(count, new string[] { item.Category, item.ItemType, item.ItemNo.ToString(), item.Enabled.ToString(), "", item.ProducedBy.Count()==0?"":item.ProducedBy.FirstOrDefault().Country , string.Format("{0:yyyy-MM-dd hh:mm:ss tt}", item.ReleaseDate), "", "", item.ReleasingQty.ToString(), "", item.QtySold.ToString(), item.QtyPurchaseFromUser.ToString(), string.Format("{0:#0}", item.Price), "", "", "", "", "" });

                count++;
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-29T19:52:33.487

你有`select`，在`where`语句之后，你返回一个匿名类型的`select`语句，它有一个名为的属性`ProducedBy`，设置这个属性你已经写了一个查询，最后，调用`ToList`了第一个元素......你需要使用它`FirstOrDefault`并`ToList()`获得零索引像这样的元素：

```
ProducedBy = db.MK_Products
            .Join(db.MK_Production_Resource,k=>k.ID,l=>l.Item,(k,l) => new {k,l})
            .Join(db.MK_Production_Staff,m=>m.l.Staff,n=>n.ID,(m,n) => new {m,n})
            .Where(o => o.m.k.ID == i.e.c.a.ID)
            .Select(p=>p.n.Location)
            .DefaultIfEmpty("")
            .FirstOrDefault() 
```

您不能`ToList`在 linq to entity 之间调用，除非您的日期之前被提取到内存中，如果您想在主详细信息案例中填充 linq to entity 之间的列表，您可以`AsEnumerable`使用

# php - Stackoverflow 实时更新如何工作？

> ID：16007251
> 
> 赞同：2
> 
> 时间：2013-04-15T03:28:49.340
> 
> 标签：php, javascript, jquery, html, ajax

这是从带有 PHP 标记的问题中截取的屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/lDM54.png)

所以，如果我打开这个页面并让它在几分钟内不刷新，它就会出现

`x questions with new activity`

当我单击它时，它会显示所有最新更新。我想为新闻更新编写类似的脚本。是否使用 JavaScript`setTimeout`轮询服务器并将更新嵌入到`<div>`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:35:07.180

网络套接字

```
StackExchange.realtime.init('ws://sockets.ny.stackexchange.com:80'); 
```

[http://socket.io/](http://socket.io/)

# css - 仅当文本适合时，如何使用 d3.js 在 SVG 矩形中显示文本？

> ID：16007254
> 
> 赞同：2
> 
> 时间：2013-04-15T03:29:11.407
> 
> 标签：css, svg, d3.js, visualization

我正在使用 d3 创建一个包含一堆不同大小的矩形元素的可视化。我想在每个 rect 元素中添加一个“标题”，但我只希望在文本自然适合的情况下显示它。这将如何完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T08:17:29.557

你得到文本的边界框，检查它是否对于元素来说太大了`rect`，如果是这种情况，就删除它。[这](http://bl.ocks.org/mbostock/1160929)是一个如何获取文本元素的边界框的示例。

# batch-file - 批量 unicode 支持？

> ID：16007258
> 
> 赞同：0
> 
> 时间：2013-04-15T03:29:34.523
> 
> 标签：batch-file

如何在批处理文件中添加 unicode 支持？我尝试将其保存为 unicode 和 utf-8，但它仍然无法正确显示外文。示例文件：

```
@echo off
echo привет
pause 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:39:36.233

来自[维基百科](http://en.wikipedia.org/wiki/Code_pages_on_Microsoft_Windows)

> 活动的 OEM 代码页可以通过 MS-DOS chcp 命令更改，但除非您从默认光栅字体切换到 Lucida Console，否则将无法正确显示。光栅字体不支持代码页的非系统范围的更改。

如果您的批处理文件是 UTF-8，请尝试`chcp 65001`在您的批处理文件 (65001=CP_UTF8) 之前执行并将字体更改为 Lucida Console。

# javascript - 使用原型查看如何将函数与函数一起使用

> ID：16007259
> 
> 赞同：1
> 
> 时间：2013-04-15T03:29:35.020
> 
> 标签：javascript

我只是有点胡思乱想，试图模仿某些 jQuery 函数（试图为 jQuery 函数编写香草`javascript`）我在这里编造了这个

```
function ezWork(element) {
    if (typeof element === 'string') {
        document.getElementById(element);
        console.log('Got element');
    }
}

ezWork.prototype.on = function(event, callback) {
    if (typeof event === 'string') {

        if (event === 'click') {
            if(window.addEventListener) {
                element.addEventListener('mousedown', callback);
                alert('addEventListener called');
            } else if (window.attachEvent) {
                element.attachEvent('onmousedown', callback);
            } else {
                element.onmousedown = callback;
            }
        }
    }
}

ezWork('click').on('click', function(e) {
    e.preventDefault();
    alert('Worked');
}); 
```

[http://jsfiddle.net/aJmma/](http://jsfiddle.net/aJmMa/)

我只是好奇为什么我得到 .on 没有定义（我正在按照我认为应该做的方式做这件事，而不是我是否知道这是正确的方法，我只是在尝试学习，做我正在尝试做的向函数添加函数的正确方法是什么？）

非常感谢您的帮助！

我现在得到的错误是，'.on' 没有定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:38:43.360

```
var ezWork = (function(win, doc) {

  // Constructor
  function EzWork(element) {
    this.element = this._init(element);
  }

  EzWork.prototype = {
    _init: function(element) {
      return doc.getElementById(element);
    },

    on: function(event, callback) {
      // simplified...
      this.element.addEventListener(event, callback);
    }
  };

  // Shortcut to create a new instance without using 'new'
  return function(element) {
    return new EzWork(element);
  };

}(window, document));

ezWork('click').on('click', function(e) {
  e.preventDefault();
  alert('Worked');
}); 
```

**演示：http:** [//jsbin.com/oquduf/2/edit](http://jsbin.com/oquduf/2/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:40:53.190

因为`ezWork()`不返回`ezWork`. 事实上，它不返回*任何东西*。一旦你修复它，你会发现它`element`是未定义的。您必须添加它并将其作为属性访问。

```
function ezWork(element) {
    if (!(this instanceof ezWork)) {
        return new ezWork(element);
    }
    if (typeof element === 'string') {
        element = document.getElementById(element);
        console.log('Got element');
    }
    this.element = element;
} 
```

[http://jsfiddle.net/aJmma/1/](http://jsfiddle.net/aJmMa/1/)

# ios - 如何通过按下按钮添加文本字段

> ID：16007260
> 
> 赞同：0
> 
> 时间：2013-04-15T03:29:40.453
> 
> 标签：ios, button, uiview, uitextfield, add

我试图弄清楚如何通过单击按钮在我的 iphone 应用程序的视图中添加文本字段。可能吗？

我想应该就这么简单。但它不起作用。

```
- (IBAction)addText:(id)sender

CGRect textField = CGRectMake(0.0, 0.0, 100.0, 30.0);
UITextField *textField = [[UITextField alloc] initWithFrame:textField]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:38:13.757

如果此代码不起作用，则意味着您的 UIButton 的 IBAction 不起作用将 NSLog 放入 IBAction 或编写 UITextView 全局变量，因为它可能是超级调用 dealloc 您的 UITextView。或者，您视野之外的 CGRectMake(0.0, 0.0, 100.0, 30.0) 框架可能超过了最大高度或最大高度，而您看不到它。

```
- (IBAction)addText:(id)sender {
     CGRect textFieldFrame = CGRectMake(0.0, 0.0, 100.0, 30.0);
     UITextField *textField = [[UITextField alloc] initWithFrame:textFieldFrame];   
     textField.delegate = self;
     [self.view addSubview:textField];
     // or add to you wanted view
    [yourView addSubview:textField];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:42:05.547

Hi John yes you can create uitextfield after clicking the button for that you have to write code as such below

```
- (IBAction)addText:(id)sender
{
CGRect textfieldFrame = CGRectMake(0.0, 0.0, 100.0, 30.0);
UITextField *textField = [[UITextField alloc] initWithFrame:textfieldFrame];
textField.borderStyle = UITextBorderStyleRoundedRect;
textField.font = [UIFont systemFontOfSize:15];
textField.placeholder = @"enter text";
textField.autocorrectionType = UITextAutocorrectionTypeNo;
textField.keyboardType = UIKeyboardTypeDefault;
textField.returnKeyType = UIReturnKeyDone;
textField.clearButtonMode = UITextFieldViewModeWhileEditing;
textField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;    
textField.delegate = self;
[self.view addSubview:textField];

} 
```

# groovy - IntelliJ 将 Griffon 中的工作代码突出显示为错误

> ID：16007262
> 
> 赞同：2
> 
> 时间：2013-04-15T03:29:44.657
> 
> 标签：groovy, intellij-idea, griffon

下面是从 Groovy in Action 书中摘录的工作代码片段。如下所示，IntelliJ 将其视为错误。

为什么？

见下图：

![在此处输入图像描述](https://i.stack.imgur.com/fn2Y7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:58:13.247

我不认为 IDEA 应该归咎于此。Griffon 正在利用 Groovy 带来的一个技巧：使用闭包作为注释值。然而@PropertyListener 更进一步允许使用闭包属性，但为了做到这一点，它将无效代码（属性名称不能用作注释值）转换为有效代码（将注释值更改为空字符串） .

IDEA 无法知道 Griffon 编译器正在使用此技巧，因此出现红色曲线。不管怎样，不要惊慌，Griffon 编译器会做正确的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T10:49:30.347

固定的。IntelliJ IDEA 12.1.2 将支持它

# ruby-on-rails - 旧文件减慢heroku？

> ID：16007265
> 
> 赞同：0
> 
> 时间：2013-04-15T03:29:56.413
> 
> 标签：ruby-on-rails, performance, heroku, load

我对我的 rails 网站进行了完整的网站改造，并将新文件推送到我的 heroku 应用程序。

我注意到服务器响应时间从 0.5 秒变为近 2.5 秒来初始化，即使站点本身更精简。

heroku 是否有可能使用旧文件？有没有一种好方法可以清除服务器（我显然想保留数据库）可能存储的任何内容？

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T11:50:36.730

> heroku 是否有可能使用旧文件？

仅当您的应用程序仍在使用它们时。每次将代码推送到 Heroku 时，都会生成一个新的测功机，并回收前一个测功机。

自改版以来，您可能还没有优化您的网站；缓存、查询优化等。

# lua - Lua访问存储在外部文件中的表

> ID：16007268
> 
> 赞同：-1
> 
> 时间：2013-04-15T03:29:58.353
> 
> 标签：lua, lua-table

我有一个外部 lua 文件，其中存储了一个表格，其格式如下：

```
sgeT = {
    2535047 = {
    {
       ["account"] = "TG-MCB110105",
       ["exec"] = "/share/home/00288/tg455591/NAMD_2.8b3/NAMD_2.8b3_Linux-x86_64-MVAPICH-Intel-Ranger/namd2",
       ["execEpoch"] = 1305825864,
       ["execModify"] = "Thu May 19 12:24:24 2011",
       ["execType"] = "user:binary",
       ["jobID"] = "2535047",
       ["numCores"] = "128",
       ["numNodes"] = "8",
       pkgT = {
       },
       ["runTime"] = "65125",
       ["sha1"] = "e157dd510a7be4d775d6ceb271373ea24e7f9559",
       sizeT = {
          ["bss"] = "104552",
          ["data"] = "192168",
          ["text"] = "10650813",
      },
      ["startEpoch"] = "1335843433",
      ["startTime"] = "Mon Apr 30 22:37:13 2012",
      ["user"] = "guo",
   },
 },
 2535094 = {
 {
     ["account"] = "TG-MCB110105",
     ["exec"] = "/share/home/00288/tg455591/NAMD_2.8b3/NAMD_2.8b3_Linux-x86_64-MVAPICH-Intel-Ranger/namd2",
     ["execEpoch"] = 1305825864,
     ["execModify"] = "Thu May 19 12:24:24 2011",
     ["execType"] = "user:binary",
     ["jobID"] = "2535094",
     ["numCores"] = "128",
     ["numNodes"] = "8",
     pkgT = {
     },
     ["runTime"] = "81635",
     ["sha1"] = "e157dd510a7be4d775d6ceb271373ea24e7f9559",
     sizeT = {
         ["bss"] = "104552",
         ["data"] = "192168",
         ["text"] = "10650813",
     },
     ["startEpoch"] = "1335823028",
     ["startTime"] = "Mon Apr 30 16:57:08 2012",
     ["user"] = "guo",
   },
 } 
```

我想像数组一样遍历表并返回 exec 键、值对，我对 lua 完全陌生，我正在使用以下脚本：

```
FileStr = "lariatData-sgeT-2012-05-31.lua"
Hnd, ErrStd = io.open(FileStr, "r")
myTable = loadTable(FileStr)
if Hnd then
for Str in Hnd:lines() do
    print(Str, "\n")
    for exec, val in pairs(myTable) do
        print(exec.." "..val, "\n")
    end
end
Hnd.close()
else
    print(ErrStr, "\n")
end 
```

但是，它返回该表为零。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:04:01.203

继续上面的评论：

```
-- Notice that I've used `[2535047]`
sgeT = {
    [2535047] = {
    {
       ["account"] = "TG-MCB110105",
       ["exec"] = "/share/home/00288/tg455591/NAMD_2.8b3/NAMD_2.8b3_Linux-x86_64-MVAPICH-Intel-Ranger/namd2",
       ["execEpoch"] = 1305825864,
       ["execModify"] = "Thu May 19 12:24:24 2011",
       ["execType"] = "user:binary",
       ["jobID"] = "2535047",
       ["numCores"] = "128",
       ["numNodes"] = "8",
       pkgT = {
       },
       ["runTime"] = "65125",
       ["sha1"] = "e157dd510a7be4d775d6ceb271373ea24e7f9559",
       sizeT = {
          ["bss"] = "104552",
          ["data"] = "192168",
          ["text"] = "10650813",
      },
      ["startEpoch"] = "1335843433",
      ["startTime"] = "Mon Apr 30 22:37:13 2012",
      ["user"] = "guo",
   },
 },
} 
```

以上是你的文件。那么，你的 Lua 程序应该是：

```
FileStr = "lariatData-sgeT-2012-05-31.lua"
Hnd, ErrStr = io.open(FileStr, "r")
if Hnd then
    dofile(FileStr)
    for Str in Hnd:lines() do
        print(Str, "\n")
        for exec, val in pairs(sgeT) do
            print(exec.." "..val, "\n")
        end
    end
    Hnd.close()
else
    print(ErrStr, "\n")
end 
```

# ruby-on-rails - Rails 简单表单路由问题

> ID：16007271
> 
> 赞同：1
> 
> 时间：2013-04-15T03:30:26.507
> 
> 标签：ruby-on-rails, ruby, forms, routing

我在 Rails 中有一个表格

```
<div class="page-header">
    <h3>Create Blah</h3>
</div>
<%= simple_form_for @blah do |f| %>
    <%= f.input :id %>
    <%= f.input :name %>
    <%= f.input :pho %>
    <%= f.input :fun %>
    <%= f.submit :class => 'btn btn-primary' %>
<% end %>
<br> 
```

当我单击提交按钮时，代码会尝试去哪里？它是否调用 create 方法`blah_controller.rb`？因为目前，我收到路由错误

```
Routing Error
uninitialized constant BlahsController 
```

这是`BlahController#create`方法：

```
 def create
    authorize! :create, :blahs
    @blah = Blah.new(params[:blah])
    if @blah.save
      redirect_to admin_blah_path(@blah), :notice => 'New blah created!'
    else
      render :new
    end
 end 
```

在我的`rake routes`，我有

```
 admin_blahs GET    /admin/blahs(.:format)                      admin/blahs#index
                POST   /admin/blahs(.:format)                      admin/blahs#create
 new_admin_blah GET    /admin/blahs/new(.:format)                  admin/blahs#new
edit_admin_blah GET    /admin/blahs/:id/edit(.:format)             admin/blahs#edit
     admin_blah GET    /admin/blahs/:id(.:format)                  admin/blahs#show
                PUT    /admin/blahs/:id(.:format)                  admin/blahs#update
                DELETE /admin/blahs/:id(.:format)                  admin/blahs#destroy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:55:24.507

看起来 your`BlahsController`是一个命名空间控制器，位于`Admin`模块下（即，它的完全限定名称是`Admin::BlahsController`）。如果是这样，在构建表单时，您还必须提供`:admin`命名空间，使用类似以下内容：

```
<%= simple_form_for [:admin, @blah] do |f| %> 
```

请参阅**“处理命名空间”**部分下的[Rails Guide to Form Helpers 。](http://guides.rubyonrails.org/form_helpers.html#relying-on-record-identification)

# c# - GDI 在 C# 中将位图写入文件

> ID：16007273
> 
> 赞同：1
> 
> 时间：2013-04-15T03:30:59.547
> 
> 标签：c#, bitmap, gdi+, gdi

我正在尝试从给定 Handle/DC 的窗口中捕获图像。我想捕捉具有所有透明度和像素的图像，所以我决定使用 GDI/GDI+。

下面的代码是我所拥有的，但是当它“写入”位图时，它写错了：S 换句话说，文件不可读。它是空白的。然而它的大小是 20kb :S

有什么想法有什么问题吗？

导入.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;

namespace Imaging
{
    static class Imports
    {
        public enum ObjectType : uint
        {
            OBJ_PEN = 1,
            OBJ_BRUSH = 2,
            OBJ_DC = 3,
            OBJ_METADC = 4,
            OBJ_PAL = 5,
            OBJ_FONT = 6,
            OBJ_BITMAP = 7,
            OBJ_REGION = 8,
            OBJ_METAFILE = 9,
            OBJ_MEMDC = 10,
            OBJ_EXTPEN = 11,
            OBJ_ENHMETADC = 12,
            OBJ_ENHMETAFILE = 13
        }

        public enum TernaryRasterOperations : uint
        {
            SRCCOPY = 0x00CC0020,
            SRCPAINT = 0x00EE0086,
            SRCAND = 0x008800C6,
            SRCINVERT = 0x00660046,
            SRCERASE = 0x00440328,
            NOTSRCCOPY = 0x00330008,
            NOTSRCERASE = 0x001100A6,
            MERGECOPY = 0x00C000CA,
            MERGEPAINT = 0x00BB0226,
            PATCOPY = 0x00F00021,
            PATPAINT = 0x00FB0A09,
            PATINVERT = 0x005A0049,
            DSTINVERT = 0x00550009,
            BLACKNESS = 0x00000042,
            WHITENESS = 0x00FF0062,
            CAPTUREBLT = 0x40000000
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct Rect
        {
            public int Left, Top, Right, Bottom;
        }

        [StructLayout(LayoutKind.Sequential, Pack = 1)]
        public struct BITMAPFILEHEADER
        {
            public ushort bfType;
            public uint bfSize;
            public ushort bfReserved1;
            public ushort bfReserved2;
            public uint bfOffBits;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct BITMAPINFOHEADER
        {
            public uint biSize;
            public int biWidth;
            public int biHeight;
            public ushort biPlanes;
            public ushort biBitCount;
            public uint biCompression;
            public uint biSizeImage;
            public int biXPelsPerMeter;
            public int biYPelsPerMeter;
            public uint biClrUsed;
            public uint biClrImportant;

            public void Init()
            {
                biSize = (uint)Marshal.SizeOf(this);
            }
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct BITMAPINFO
        {
            public uint biSize;
            public int biWidth;
            public int biHeight;
            public ushort biPlanes;
            public ushort biBitCount;
            public uint biCompression;
            public uint biSizeImage;
            public int biXPelsPerMeter;
            public int biYPelsPerMeter;
            public uint biClrUsed;
            public uint biClrImportant;

            [MarshalAs(UnmanagedType.ByValArray, SizeConst = 256)]
            public uint[] cols;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct BITMAP
        {
            public int bmType;
            public int bmWidth;
            public int bmHeight;
            public int bmWidthBytes;
            public ushort bmPlanes;
            public ushort bmBitsPixel;
            public IntPtr bmBits;
        };

        [DllImport("user32.dll", SetLastError = true)]
        public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

        [DllImport("user32.dll", SetLastError = true)]
        public static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);

        [DllImport("user32.dll")]
        public static extern IntPtr GetDC(IntPtr WindowHandle);

        [DllImport("user32.dll")]
        public static extern void ReleaseDC(IntPtr WindowHandle, IntPtr DC);

        [DllImport("user32.dll")]
        public static extern IntPtr GetWindowRect(IntPtr WindowHandle, ref Rect rect);

        [DllImport("user32.dll", SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool PrintWindow(IntPtr hwnd, IntPtr DC, uint nFlags);

        [DllImport("user32.dll")]
        public static extern int SetForegroundWindow(IntPtr hWnd);

        [DllImport("user32.dll")]
        public static extern IntPtr ShowWindow(IntPtr hWnd, int nCmdShow);

        [DllImport("user32.dll")]
        public static extern int GetWindowRgn(IntPtr hWnd, IntPtr hRgn);

        [DllImport("gdi32.dll")]
        public static extern IntPtr GetCurrentObject(IntPtr DC, ObjectType uObjectType);

        [DllImport("gdi32.dll")]
        public static extern int GetObject(IntPtr hObject, int nCount, ref BITMAP lpObject);

        [DllImport("gdi32.dll", SetLastError = true)]
        public static extern IntPtr CreateCompatibleDC(IntPtr DC);

        [DllImport("gdi32.dll", ExactSpelling = true, SetLastError = true)]
        public static extern bool DeleteDC(IntPtr DC);

        [DllImport("gdi32.dll")]
        public static extern IntPtr CreateCompatibleBitmap(IntPtr DC, int nWidth, int nHeight);

        [DllImport("gdi32.dll", ExactSpelling = true, PreserveSig = true, SetLastError = true)]
        public static extern IntPtr SelectObject(IntPtr DC, IntPtr hgdiobj);

        [DllImport("gdi32.dll")]
        public static extern bool DeleteObject(IntPtr hObject);

        [DllImport("gdi32.dll")]
        public static extern IntPtr CreateRectRgn(int nLeftRect, int nTopRect, int nRightRect, int nBottomRect);

        [DllImport("gdi32.dll")]
        static extern bool FillRgn(IntPtr DC, IntPtr hrgn, IntPtr hbr);

        [DllImport("gdi32.dll")]
        public static extern IntPtr CreateSolidBrush(uint crColor);

        [DllImport("gdi32.dll")]
        public static extern int GetDIBits(IntPtr DC, IntPtr hbmp, uint uStartScan, uint cScanLines, [Out] byte[] lpvBits, ref BITMAPINFO lpbmi, uint uUsage);

        [DllImport("gdi32.dll")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool BitBlt(IntPtr DC, int nXDest, int nYDest, int nWidth, int nHeight, IntPtr SrcDC, int nXSrc, int nYSrc, TernaryRasterOperations dwRop);
    }
} 
```

我的 PBitmap 类：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

namespace Imaging
{
    class PBitmap
    {
        private Bitmap Img = null;
        private Imports.BITMAPINFO Info;
        private Imports.BITMAPFILEHEADER bFileHeader;

        public PBitmap(IntPtr Window, int X, int Y, uint BitsPerPixel = 24)
        {
            IntPtr DC = Imports.GetDC(Window);
            Imports.BITMAP Bmp = new Imports.BITMAP();
            IntPtr hBmp = Imports.GetCurrentObject(DC, Imports.ObjectType.OBJ_BITMAP);

            if (Imports.GetObject(hBmp, Marshal.SizeOf(Bmp), ref Bmp) == 0)
                throw new Exception("ERROR_INVALID_WINDOW_HANDLE.");

            Imports.Rect BMBox = new Imports.Rect();
            Imports.GetWindowRect(Window, ref BMBox);   //GetClientRect
            int width = BMBox.Right - BMBox.Left;
            int height = BMBox.Bottom - BMBox.Top;

            IntPtr MemDC = Imports.GetDC(IntPtr.Zero);
            IntPtr SDC = Imports.CreateCompatibleDC(MemDC);
            IntPtr hSBmp = Imports.CreateCompatibleBitmap(MemDC, width, height);
            Imports.DeleteObject(Imports.SelectObject(SDC, hSBmp));

            Imports.BitBlt(SDC, 0, 0, width, height, DC, X, Y, Imports.TernaryRasterOperations.SRCCOPY);
            long size = ((width * BitsPerPixel + 31) / 32) * 4 * height;

            Info = new Imports.BITMAPINFO();
            bFileHeader = new Imports.BITMAPFILEHEADER();

            Info.biSize = (uint)Marshal.SizeOf(Info);
            Info.biWidth = width;
            Info.biHeight = height;
            Info.biPlanes = 1;
            Info.biBitCount = (ushort)BitsPerPixel;
            Info.biCompression = 0;
            Info.biSizeImage = (uint)size;
            bFileHeader.bfType = 0x4D42;
            bFileHeader.bfOffBits = (uint)(Marshal.SizeOf(bFileHeader) + Marshal.SizeOf(Info));
            bFileHeader.bfSize = (uint)(bFileHeader.bfOffBits + size);

            byte[] ImageData = new byte[size];
            Imports.GetDIBits(SDC, hSBmp, 0, (uint)height, ImageData, ref Info, 0);

            var bw = new BinaryWriter(File.Open("C:/Users/*******/Desktop/Foo.bmp", FileMode.OpenOrCreate));

            bw.Write((short)0x4D42);
            bw.Write((uint)(bFileHeader.bfOffBits + size));
            bw.Write((uint)0);
            bw.Write((uint)54);
            bw.Write((uint)Info.biSize);
            bw.Write(width);
            bw.Write(height);
            bw.Write((short)Info.biPlanes);
            bw.Write(BitsPerPixel);
            bw.Write((uint)0);
            bw.Write((uint)size);
            bw.Write((uint)0);
            bw.Write((uint)0);
            bw.Write((uint)0);
            bw.Write((uint)0);
            bw.Write(ImageData);

            bw.Flush();
            bw.Close();
            bw.Dispose();

            Imports.DeleteDC(SDC);
            Imports.DeleteObject(hSBmp);
            Imports.ReleaseDC(IntPtr.Zero, MemDC);
            Imports.ReleaseDC(Window, DC);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:47:26.020

如果您正在寻找快速的创可贴修复来完成此操作（它只需要工作，不经常使用等），请考虑将图像加载回 .NET 并在启用 PNG 压缩的情况下重新保存它。.NET 框架将为您处理此问题，文件大小将更加优化。当然，如果这是针对实时应用程序，这并不理想。

# zlib - Zlib 使用 Win api createFile 和 ReadFile

> ID：16007279
> 
> 赞同：0
> 
> 时间：2013-04-15T03:31:25.383
> 
> 标签：zlib

我在 www.zlib.net 上看到了“zlib 使用示例”，但他们使用了 stdio.h 中的“fread”函数。

我必须考虑我的程序的性能，所以我必须使用 win api 'ReadFile' 功能。

但我也看到了这个。

```
This is an ugly hack required to avoid corruption of the input and output data on
Windows/MS-DOS systems. Without this, those systems would assume that the input and
output files are text, and try to convert the end-of-line characters from one standard 
to another. That would corrupt binary data, and in particular would render the 
compressed data unusable. This sets the input and output to binary which suppresses the 
end-of-line conversions. SET_BINARY_MODE() will be used later on stdin and stdout, at 
the beginning of main().

#if defined(MSDOS) || defined(OS2) || defined(WIN32) || defined(__CYGWIN__)
#  include <fcntl.h>
#  include <io.h>
#  define SET_BINARY_MODE(file) setmode(fileno(file), O_BINARY)
#else
#  define SET_BINARY_MODE(file)
#endif 
```

在 zlib 上使用 ReadFile 我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T14:08:05.883

没有什么。ReadFile 读取二进制文件。

# cuda - cuFFT 分析问题

> ID：16007281
> 
> 赞同：0
> 
> 时间：2013-04-15T03:31:43.160
> 
> 标签：cuda, nvidia, cufft

我正在尝试获取 cuFFT 库调用的分析数据，例如 plan 和 exec。我正在使用 nvprof（命令行分析工具），带有“--print-api-trace”选项。它打印除 cuFFT api 之外的所有 api 的时间。我需要更改任何标志以获取 cuFFT 分析数据吗？或者我需要使用这些事件并测量自己？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T05:02:53.927

根据 nvprof[文档](http://docs.nvidia.com/cuda/profiler-users-guide/index.html#nvprof-overview)，[api-trace-mode](http://docs.nvidia.com/cuda/profiler-users-guide/index.html#gpu-trace-and-api-trace-modes)：

> API 跟踪模式显示所有 CUDA 运行时和驱动程序 API 调用的时间线

cuFFT 既不是[CUDA 运行时 API](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html)也不是[CUDA 驱动程序 API](http://docs.nvidia.com/cuda/cuda-driver-api/index.html)。它是 FFT 例程库，其文档在[此处](http://docs.nvidia.com/cuda/cufft/index.html)。

当然，您仍然可以使用 nvprof、命令行分析器或视觉分析器来收集有关 cuFFT 如何使用 GPU 的数据。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-15T04:57:50.463

让它工作..我没有使用 nvprof，而是使用了 CUDA_PROFILE 环境变量。

# ruby - Encode a movie with Unicode filename in Windows using Popen

> ID：16007284
> 
> 赞同：0
> 
> 时间：2013-04-15T03:32:06.370
> 
> 标签：ruby, unicode, ffmpeg, popen

I want to encode a movie through IO.popen by ruby(1.9.3) in windows 7. If the file name contains only ascii strings, encoding proceed normally. But with unicode filename the script returns "No such file or directory" error. Like following code.

```
#-*- encoding: utf-8 -*-
command = "ffmpeg -i ü.rm"
IO.popen(command){|pipe|
  pipe.each{|line|
    p line
  }
} 
```

I couldn't find whether the problem causes by ffmpeg or ruby. How can fix this problem?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:35:36.970

Windows 不使用 UTF-8 编码。Ruby 直接将 Unicode 文件名的字节序列发送到文件系统，当然文件系统不会识别 UTF-8 序列。似乎较新版本的 Ruby 已解决此问题。（我不确定。我正在使用 1.9.2p290，它仍然存在。）

您需要将 UTF-8 文件名转换为 Windows 使用的编码。

```
# coding: utf-8
code_page = "cp#{`chcp`.chomp[/\d+$/]}"   # detect code page automatically.
command = "ffmpeg -i ü.rm".encode(code_page)
IO.popen(command) do |pipe|
  pipe.each do |line|
    p line
  end
end 
```

另一种方法是使用 Windows 使用的相同编码保存脚本。并且不要忘记更新编码声明。例如，我使用的是简体中文 Windows，它使用 GBK(CP936) 作为默认编码：

```
# coding: GBK
# save this file in GBK
command = "ffmpeg -i ü.rm"
IO.popen(command) do |pipe|
  pipe.each do |line|
    p line
  end
end 
```

顺便说一句，按照惯例，建议使用`do...end`多行代码块而不是`{...}`，除非在特殊情况下。

**更新**：

底层文件系统 NTFS 使用 UTF-16 进行文件名编码。`가`有效的文件名字符也是如此。但是，GBK 无法`가`在您的日文 Windows 中进行编码，因此无法对 CP932 进行编码。因此，您无法将该特定文件名发送到您的`cmd.exe`，并且您不可能使用`IO.popen`. 对于 CP932 兼容的文件名，上面提供的编码方法可以正常工作。对于那些与 CP932 不兼容的文件名，最好将文件名修改为兼容的文件名。

# mysql - 我的 SQL 语法中的另一个错误？

> ID：16007287
> 
> 赞同：1
> 
> 时间：2013-04-15T03:32:54.420
> 
> 标签：mysql, join

我想知道另一个语法错误：

```
SELECT * FROM forum_question
    WHERE category='art'
        LEFT JOIN forum_answer ON (forum_question.id = forum_answer.question_id) 
    GROUP BY forum_question.id 
ORDER BY a_datetime DESC; 
```

我得到的错误是：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“LEFT JOIN forum_answer ON (forum_question.id = forum_answer.question_id) GROUP B”附近使用正确的语法

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:33:50.750

`WHERE`子句应该在子句之后`FROM`。`JOIN`语句是`FROM`子句的一部分

```
SELECT  * 
FROM    forum_question
        LEFT JOIN forum_answer 
           ON (forum_question.id = forum_answer.question_id)
WHERE   category='art' 
GROUP   BY forum_question.id 
ORDER   BY a_datetime DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:36:31.853

`WHERE`子句应该在子句`JOIN`之后

```
SELECT  * 
FROM    forum_question
        LEFT JOIN forum_answer 
           ON (forum_question.id = forum_answer.question_id)
WHERE   category='art' 
GROUP   BY forum_question.id 
ORDER   BY a_datetime DESC; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T03:34:02.767

首先`join`，然后使用`where`子句：

```
 SELECT * FROM forum_question
    LEFT JOIN forum_answer ON (forum_question.id = forum_answer.question_id) 
    WHERE forum_question.category='art'
    GROUP BY forum_question.id 
    ORDER BY a_datetime DESC; 
```

# sugarcrm - SugarCRM查询数据库

> ID：16007291
> 
> 赞同：0
> 
> 时间：2013-04-15T03:33:45.847
> 
> 标签：sugarcrm

在 SugarCRM 中，使用 SOAP API，想象我在数据库中填充了很多帐户，我想找到具有`'phone_work' = '00352254856987'`. 我怎样才能进行查询来实现这一点？它会是这样的：？

```
 $query = "phone_work = '${myPhone}'"; 
```

对于我所尝试的，编译器似乎在 XML 文档中发现了一个错误，这意味着查询没有很好地执行。进行此类查询的最佳方法是什么？

我正在使用 magento 并创建一个模块来连接到糖，所以它是 PHP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T12:29:45.110

事实证明，该领域`'phone_work'`是错误的。您可以访问：[http](http://apidocs.sugarcrm.com/schema/6.3.0/pro/tables/accounts.html) ://apidocs.sugarcrm.com/schema/6.3.0/pro/tables/accounts.html并获取与该模块相关的所有字段。在模块`'Accounts`' 中，字段名称为`'office phone'`，但在数据库中，名称为`'phone_office'`。因为查询是针对数据库的，所以我们需要使用数据库字段名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T06:38:57.280

你能发布你得到的错误吗？还请查看 sugarcrm.log 并可能增加日志记录级别以查看从您的查询创建的 sql 是否错误。顺便说一句，我切换到 REST Json 以摆脱与肥皂相关的问题。

# php - 将存储在 mysql 中的数据从一个人发送到另一个人的安全方式

> ID：16007292
> 
> 赞同：0
> 
> 时间：2013-04-15T03:33:46.957
> 
> 标签：php, mysql, encryption

我正在使用 PHP 和 MySql 编写一个 webapp。用户 A 将他们的密码发布到数据库，用户 B 的 PHP 文件应该访问密码。用户 A 指定密码的访问持续时间，密码存储在数据库中。持续时间完成后，表中的记录会自动删除，因此用户 B 的 PHP 文件无法再访问它。

现在我想知道的是，在规定的时间内将密码存储在表中的最佳且安全的方法是什么，这样当数据库受到威胁时，攻击者就无法知道密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:50:04.690

为了使数据免受攻击者攻击您的服务器，*您*必须无法解密数据。如果您（您的服务器）可以解密数据，您可以假设攻击者也可以成功侵入您的服务器。

这意味着您需要对数据进行加密并保留必要的秘密以完全解密您*的*服务器。想到的最明智的事情显然是让*用户*保守秘密。

一个好的方案可能是这样的：

*   为每个用户生成一个公钥/私钥对，使用用户的密码锁定私钥
*   将两个密钥都存储在您的服务器上
*   当用户 A 向用户 B 发送内容时，使用用户 B 的公钥对数据进行加密；数据现在只能使用用户 B 的私钥解密，该私钥使用用户 B 的密码锁定，而您没有该密码
*   当用户 B 想要检索数据时，要求/使用他的密码来解锁他的私钥来解密数据
*   **永远不要在服务器上的任何地方存储密码或明文数据**

最大的问题是可用性，因为如果您从不将用户密码存储在任何地方，您可能不得不经常向他询问。另一件事是你应该真正知道你在这里做什么。即使将密码暂时*保存在内存*中也可能导致漏洞，更不用说整个事情实施起来非常棘手，如果您不完全理解所涉及的所有概念，很容易出错。

您可以将整个加密和解密过程移至客户端，因此您的服务器*永远不会*处理纯密码或纯文本数据。这有多可行取决于您的确切用例。

# c# - 使用哈希码比较对象的属性

> ID：16007294
> 
> 赞同：0
> 
> 时间：2013-04-15T03:33:56.653
> 
> 标签：c#, hashcode, gethashcode, iequatable

我需要知道使用哈希码比较许多对象的方法。所以这是其中的一课。

```
public class Test: IEquatable<Test>
{
    public Test()
    {
    }

    public string ID { get; set; }
    public string Name{ get; set; }

    public static int SafeGetHashCode<T>(this T value) where T : class
    {
        return value == null ? 0 : value.GetHashCode();
    }

    public override int GetHashCode()
    {
        int hash = 19;
        hash = hash * 31 + ID.SafeGetHashCode();
        hash = hash * 31 + Name.SafeGetHashCode();
        return hash;
    }

    public override bool isSame(object obj)
    {
         // compare objects here
    }
} 
```

但是有2个错误。两者都是一样的。

“string”不包含“SafeGetHashCode”的定义，并且找不到接受“string”类型的第一个参数的扩展方法“SafeGetHashCode”（您是否缺少 using 指令或程序集引用？）

而对于isSame()，我不知道怎么写代码。概念是比较所有对象，如果有 2 个相同的 ID 和名称，将它们组合在一起。

```
Item A = new Item();
Item B = new Item();
Item c = new Item();

A.ID = "Exam1";
A.Name = "Apple";

B.ID = "Exam1";
B.Name = "Orange";

C.ID = "Exam1";
C.Name = "Apple"; 
```

所以项目 A 和 C 将组合在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T03:40:51.283

扩展方法必须是静态类的成员，它应该处理第一个错误。`SafeGetHashCode`移出您的班级，以便您可以将`Test`其用作扩展`String`和其他引用类型：

```
public static class TestHashCodeExtension
{
    public static int SafeGetHashCode<T>(this T value) where T : class
    {
        return value == null ? 0 : value.GetHashCode();
    }
} 
```

至于实现`IEquatable<T>.Equals`（我假设您`isSame`的方法名称不正确，也奇怪地标有`override`-`isSame`在任何 .Net 类中都没有，尤其是在 .Net 类中没有`Object`）：

*   确保也实现`Equals`基础`IEquatable<T>.Equals`
*   请参阅[IEquatable.Equals](http://msdn.microsoft.com/en-us/library/ms131190.aspx)中的示例以实现两个`Equals`调用

缩短样本：

```
public bool Equals(Test other) 
{
  return (other == null) ?
     false : (Id == other.Id) && (Name == other.Name);
}

public override bool Equals(Object obj)
{
  Test testObj = obj as Test;
  return testObj == null ? false : Equals(testObj);   
} 
```

注意：一般`Equals`不需要先使用`GetHashCode`。`Dictionary`（主要原因`GetHashCode`存在）总是在调用之前检查哈希码本身`Equals`。在大多数情况下，两者`GetHashCode`和`Equals`都作为每个成员的哈希/比较来实现。因此，除非您确定您的类缓存结果，`GetHashCode`因为没有实际理由检查哈希码，`Equals`因为您最终会触摸两次（`Equals`如果第一个字段不相等，则可以短路比较，不像`GetHashCode`需要使用所有/大多数字段来计算结果）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T06:55:05.113

就我个人而言，我只是内联它 - 不需要额外的方法：

```
public override int GetHashCode()
{
    int hash = 19;
    hash = hash * 31 + (ID == null ? 0 : ID.GetHashCode());
    hash = hash * 31 + (Name == null ? 0 : Name.GetHashCode());
    return hash;
} 
```

添加不受约束的扩展方法会污染诸如智能感知之类的东西。

# ruby-on-rails - Why is my timezone one hour off?

> ID：16007296
> 
> 赞同：1
> 
> 时间：2013-04-15T03:34:13.987
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, time, timezone

Running this code...

```
Time.use_zone('Pacific Time (US & Canada)') do
  p Time.zone.now
end 
```

I get the following: `=> Sun, 14 Apr 2013 20:30:53 PDT -07:00`

Yet when I do Rails Time Zone Select.... it says `-8:00` quite clearly. Why is it -7 in one area and -8 in another?

Other times, time zones like `Hawaii` which are `-10:00` don't get offset by an hour.

I assume this has something to do with DST, but I'm more curious whether it means it's working *properly* or *improperly* and there is something else I need to do.

Ultimately I'm using this in a datepicker, and I find it very odd that when I use `Time.zone.parse` (along with my time zone around filter), its offsetting everything by 1 hour.

THanks

# websocket - Websocket：是否可以从程序中知道调用 onClose 的原因是什么

> ID：16007298
> 
> 赞同：1
> 
> 时间：2013-04-15T03:34:21.443
> 
> 标签：websocket, jetty

我有一个示例 WebSocket 程序，它在下面运行良好

当用户关闭浏览器或有任何异常或任何断开连接时，将调用 onClose 方法

我的问题是，是否有可能从程序中知道调用 onClose 的原因是什么？请分享您的观点，感谢您的阅读。

```
public class Html5Servlet extends WebSocketServlet {

    private AtomicInteger index = new AtomicInteger();

    private static final List<String> tickers = new ArrayList<String>();
    static{
        tickers.add("ajeesh");
        tickers.add("peeyu");
        tickers.add("kidillan");
        tickers.add("entammo");
    }

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    public WebSocket doWebSocketConnect(HttpServletRequest req, String resp) {
        //System.out.println("doWebSocketConnect");
        return new StockTickerSocket();
    }
    protected String getMyJsonTicker() throws Exception{
        return "";
    }
    public class StockTickerSocket implements WebSocket.OnTextMessage{
        private Connection connection;
        private Timer timer; 

        @Override
        public void onClose(int arg0, String arg1) {
            System.out.println("onClose called!"+arg0);
        }

        @Override
        public void onOpen(Connection connection) {
            //System.out.println("onOpen");
            this.connection=connection;
            this.timer=new Timer();
        }

        @Override
        public void onMessage(String data) {
            //System.out.println("onMessage");
            if(data.indexOf("disconnect")>=0){
                connection.close();
                timer.cancel();
            }else{
                sendMessage();

            }           
        }

        public void disconnect() {

            System.out.println("disconnect called");
        }

        public  void onDisconnect()
        {
            System.out.println("onDisconnect called");
        }

        private void sendMessage() {

            if(connection==null||!connection.isOpen()){
                //System.out.println("Connection is closed!!");
                return;
            }
            timer.schedule(new TimerTask() {

                    @Override
                    public void run() {
                        try{
                            //System.out.println("Running task");
                            connection.sendMessage(getMyJsonTicker());
                        }
                        catch (IOException e) {
                            e.printStackTrace();
                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }, new Date(),5000);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:46:19.517

签名`onClose`如下...

```
 @Override
    public void onClose(int closeCode, String closeReason) {
        System.out.println("onClose called - statusCode = " + closeCode);
        System.out.println("                 reason     = " + closeReason);
    } 
```

`int closeCode`任何已[注册的关闭状态代码](http://www.iana.org/assignments/websocket/websocket.xml#close-code-number-rules)在哪里。

并且`String closeReason`是可选的（[根据协议规范](https://www.rfc-editor.org/rfc/rfc6455#section-7.4)）关闭原因消息。

# wpf - 使用 MVVM 和 EF 的简单 WPS

> ID：16007302
> 
> 赞同：1
> 
> 时间：2013-04-15T03:34:36.840
> 
> 标签：wpf, database, entity-framework, mvvm

我快要发疯了。

我有一个工作的 WinForms/数据库应用程序，我尝试用 WPF 重建它。我的主要问题是我以前没有使用过 MVVM，而且我似乎无法掌握从实体框架到视图的数据绑定。

我的 WinForms 是专门使用代码隐藏构建的，我知道这是不好的做法，但它确实有效。我已经阅读了大约 100 篇文章、教程和示例，下载了几个使用 MVVM 的演示/示例。包括“WPF应用框架（WAF）”

但是我还没有找到一个简单的解决方案/示例，如何将 EF 用作模型或模型的数据提供者。并将信息传递给 ViewModel，最后从 View 中绑定它。

我读过的所有教程都只描述了从静态列表中获取数据，我需要对数据库进行常规的 CRUD 操作。

我知道这里一直有人问这样的问题，但是我无法找到将数据从 EF 推送到视图（模型）并通过 EF 更新回来的答案。我希望你们中的一些人可以帮助像我这样的（必须是智障的）人提供一些指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:36:18.223

MVVM 模式很大程度上取决于 EF 实现的 INotifyPropertyChanged 接口，因此这里的一些工作已经为您完成。

我不太确定您的特定要求，但从为您的窗口创建视图模式开始。假设您有一个名为 Person 的实体，其属性为 FirstName 作为字符串，Id 为 Int32（当然），并且数据层的所有工作都已处理。我将向您展示如何列出人员实体并允许编辑人员实体。

**视图模型**

```
public class Window1ViewModel : INotifyPropertyChanged {
  public event PropertyChangedEventHandler PropertyChanged;

  private ObservableCollection<Person> _people;
  private Person _selectedPerson;

  public ObservableCollection<Person> People {
    get { return _people; }
    set { _people = value;
      this.RaisePropertyChanged("People");
    }
  }

  public Person SelectedPerson {
    get { return _selectedPerson; }
    set { _selectedPerson = value;
      this.RaisePropertyChanged("SelectedPerson");
  }

  public Window1ViewModel() {
    // Instead of setting to empty collection populate with data from EF.
    this.People = new ObservableCollection<Person>();
  }

  private void RaisePropertyChanged(string propertyName) {
    if (PropertyChanged != null) PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
  }
} 
```

现在您已经处理好 ViewModel，是时候创建 UI 并绑定它了。

**绑定列表框**

```
<ListBox ItemsSource="{Binding Source={StaticResource viewModel}, Path=People}" SelectedItem="{Binding Source={StaticResource viewModel}, Path=SelectedPerson, Mode=TwoWay}"/> 
```

**绑定文本框**

```
<TextBox Text="{Binding Source={StaticResource viewModel}, Path=SelectedPerson.FirstName, Mode=TwoWay}"/> 
```

最后，您可以在 Window 上创建一个按钮，将其绑定到 ViewModel 上的 ICommand 以调用 EF 层中的 Save() 方法。

您可以写很多东西来满足您的要求，我希望这对您有所帮助。还推荐以下信息。[http://www.codeproject.com/Articles/81484/A-Practical-Quick-start-Tutorial-on-MVVM-in-WPF](http://www.codeproject.com/Articles/81484/A-Practical-Quick-start-Tutorial-on-MVVM-in-WPF)

# excel - 危机：对账宏 - Excel 2010 每次都挂起

> ID：16007306
> 
> 赞同：0
> 
> 时间：2013-04-15T03:35:06.700
> 
> 标签：excel, vba, crash, excel-2010

晚上好。

两个月前，我开始在 Excel 2010 中开发一个宏，目的是协调两组不同的信息。我在一个月前搁置了这个项目，此时宏可以毫无怨言地浏览每一行信息。

几天前我恢复了我的项目工作，我实现了一些非常小的使用长数组来包含满足特定条件的行的位置。现在，这导致了每次尝试运行宏时都让 Excel 挂在我身上的令人毛骨悚然的体验。只要我不做得太快，单步执行代码就可以毫无问题地完成，但是第二次我让它自己运行它就会崩溃。状态栏更新是主循环的一部分，它告诉我宏在停止响应之前设法处理了大约 1% 的行。

这是一个令人难以置信的令人沮丧的问题，因为它 - 据我所知 - 根本不应该发生，并且必须是由于在处理大量数据时对 Excel 施加的一些限制。也许它将我的循环解释为无限循环？

有一个贯穿两个数据集之一的总体循环，它包含第二个循环，该循环贯穿第二个数据集的相对较小部分以查找匹配项。在崩溃开始发生之前，该宏能够处理大约是我现在使用的数据集大小的 11 倍的数据集。将数据集的当前大小减少到上述默认值的 10% 左右仍会导致宏使 Excel 挂起，但有趣的是，它设法处理了 11% 的数据。从中得出的明智结论是，数据集中某处的实际数据以某种方式导致 Excel 挂起，但是 1）：如果是这种情况，我会收到一条错误消息，以及 2）检查数据集大约构成 1% 的人并没有导致任何非凡的发现。

所以我转向你。我真诚地希望您能就可能导致此问题的原因以及我如何尝试解决它提出一些建议。

这是有问题的子程序： http: [//pastebin.com/ywacHTVN](http://pastebin.com/ywacHTVN)

我一直想知道是否将其拆分为几个子程序会使 Excel 更易于消化，从而解决我的问题？如果是这种情况，如果有人可以向我解释原因，我将不胜感激。

我想我应该提到一些重要的事情：在我实现对数组的少量使用之前，我之前写过宏能够毫无问题地处理比当前数据大 11 倍的数据集。但这只是在我添加了 DoEvents 的常规执行之后——每次状态栏更新时；在此之前，Excel 会像现在一样挂起。

```
Sub MainRecon()

Dim row_MSPS As Long, row_FPMS As Long, rowStart_FPMS As Long, rowEnd_FPMS As Long, row_FPMS_lastMatch As Long
Dim row_midFPMS As Long, row_midMSPS As Long, IMO_Number As Long, size_MSPS As Long, row_MSPS_next As Long
Dim n_matches As Integer, I_sup As Integer, temp_FPMS_Row As Long

Dim match_Array() As Long
Dim supreme_match_Array() As Long: ReDim supreme_match_Array(30)
Dim IMO_FPMS_Pos_Array() As Long: ReDim IMO_FPMS_Pos_Array(30)

Dim row_first_FPMS As Integer, I As Integer, IMO_matches As Integer, supreme_Size As Integer

Dim order_no_FPMS As String

Dim match As Boolean, quantity_MSPS As Boolean, IMO_next_match As Boolean, stock_update As Boolean
Dim MSPS_duplicate As Boolean, FPMS_noMatches As Boolean, empty_FPMS As Boolean

Dim deliveryDate_MSPS As Date, deliveryDate_FPMS As Date, deliveryDate_MSPS_next As Date

row_MSPS = 2
row_FPMS = 2

row_midFPMS = 3
row_midMSPS = 3

size_MSPS = 2

'Index for supreme match array.
I_sup = 0

Do While MSPS_RawWS.Cells(size_MSPS, 1) <> ""
    size_MSPS = size_MSPS + 1
Loop

MainProcedure:
Do While MSPS_RawWS.Cells(row_MSPS, 1) <> "" 'Stops at the end of the records

    'Boolean variables defined
    empty_FPMS = False
    match = False
    quantity_MSPS = False
    IMO_next_match = False
    stock_update = False
    FPMS_noMatches = False

    If IsNumeric(Left(MSPS_RawWS.Cells(row_MSPS, 7), 2)) = True _
        And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS, 7), 4, 2)) = True _
        And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS, 7), 7, 4)) = True Then 'Confirms date format DD-MM-YYYY of 'Time for Bunker' of MSPS

        'Crew updated stock by reporting a new delivery instead of following proper procedure.
        'Stock-Delivery difference smaller than 60 will be picked up as a stock update
        'as well as delivery quantities under 10 [mt]
        If ((60 > Abs(MSPS_RawWS.Cells(row_MSPS, 6) - MSPS_RawWS.Cells(row_MSPS, 8)) And _
            Abs(MSPS_RawWS.Cells(row_MSPS, 6) - MSPS_RawWS.Cells(row_MSPS, 8)) >= 0) Or (0 < MSPS_RawWS.Cells(row_MSPS, 8) And MSPS_RawWS.Cells(row_MSPS, 8) <= 10)) And _
            (MSPS_RawWS.Cells(row_MSPS, 6) + MSPS_RawWS.Cells(row_MSPS, 8) > 0) Then

                    MSPS_RawWS.Range("A" & row_MSPS, "H" & row_MSPS).Copy
                    mid_ReportWS.Cells(row_midMSPS, 11).PasteSpecial

                    mid_ReportWS.Cells(row_midMSPS, 9) = "Error 40\. Updated stock reported as delivery."

                    row_midMSPS = row_midMSPS + 1
                    row_midFPMS = row_midFPMS + 1

                    Call UpdateProgress("", 4, row_MSPS, size_MSPS)

        Else 'Proceed if it passes the stock update check

            Call UpdateProgress("", 4, row_MSPS, size_MSPS)

            quantity_MSPS = False

            If MSPS_RawWS.Cells(row_MSPS, 8) > 0 Then 'If MSPS quantity is above 0, proceed

            quantity_MSPS = True

                If IsNumeric(Left(MSPS_RawWS.Cells(row_MSPS, 7), 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS, 7), 4, 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS, 7), 7, 4)) = True Then 'Confirms date format DD-MM-YYYY

                deliveryDate_MSPS = Left(MSPS_RawWS.Cells(row_MSPS, 7), 10) 'Cuts away HH:MM:SS
                IMO_Number = MSPS_RawWS.Cells(row_MSPS, 2)

                'Finds the next MSPS record with quantity and date.
                row_MSPS_next = row_MSPS + 1
                Do While (MSPS_RawWS.Cells(row_MSPS_next, 7) = "" Or Not MSPS_RawWS.Cells(row_MSPS_next, 8) > 0) And row_MSPS_next <= size_MSPS _
                And Not (IsNumeric(Left(MSPS_RawWS.Cells(row_MSPS_next, 7), 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS_next, 7), 4, 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS_next, 7), 7, 4)) = True)

                    row_MSPS_next = row_MSPS_next + 1

                Loop

                'Checks if the next MSPS record has an IMO that matches the current one, and gets the date of the next record
                IMO_next_match = False
                If IMO_Number = MSPS_RawWS.Cells(row_MSPS_next, 2) And (IsNumeric(Left(MSPS_RawWS.Cells(row_MSPS_next, 7), 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS_next, 7), 4, 2)) = True _
                And IsNumeric(Mid(MSPS_RawWS.Cells(row_MSPS_next, 7), 7, 4)) = True) And MSPS_RawWS.Cells(row_MSPS_next, 8) > 0 Then

                    deliveryDate_MSPS_next = Left(MSPS_RawWS.Cells(row_MSPS_next, 7), 10)
                    IMO_next_match = True

                End If

                'Checks if the MSPS record is a duplicate
                If IMO_next_match = True And deliveryDate_MSPS = deliveryDate_MSPS_next And _
                MSPS_RawWS.Cells(row_MSPS, 8) = MSPS_RawWS.Cells(row_MSPS_next, 8) Then

                            MSPS_RawWS.Range("A" & row_MSPS, "H" & row_MSPS).Copy
                            mid_ReportWS.Cells(row_midMSPS, 11).Paste

                            mid_ReportWS.Cells(row_midMSPS, 9) = "Duplicate entry."

                            row_midMSPS = row_midMSPS + 1
                            row_midFPMS = row_midFPMS + 1

                            Call UpdateProgress("", 4, row_MSPS, size_MSPS)

                            row_MSPS = row_MSPS + 1

                            'Proceed prematurely to the next iteration in the all-encompassing 'Do While'-loop
                            'if the current MSPS-record is a duplicate
                            GoTo MainProcedure
                End If

                match = False
                row_first_FPMS = 0

                    Do While IsEmpty(FPMS_RawWS.Cells(row_FPMS, 1)) = False And (IMO_Number > FPMS_RawWS.Cells(row_FPMS, 1) _
                    Or IMO_Number = FPMS_RawWS.Cells(row_FPMS, 1)) 'Search for FPMS records with matching IMO number

                        If IMO_Number = FPMS_RawWS.Cells(row_FPMS, 1) Then

                            If row_first_FPMS > 0 Then
                                If FPMS_RawWS.Cells(row_first_FPMS, 1) <> FPMS_RawWS.Cells(row_FPMS, 1) Then

                                    row_first_FPMS = row_FPMS 'This is the very first of the matching FPMS records
                                    'For use later in connection with the arrays.

                                End If

                            Else

                                row_first_FPMS = row_FPMS

                            End If

                            If deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) Or deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) - 1 Or deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) + 1 Then

                                match = True

                                Exit Do

                            End If
                        End If

                        row_FPMS = row_FPMS + 1

                    Loop

                If match = True Then

                'The following array will contain the location (row) of all FPMS records matching the current MSPS record
                ReDim match_Array(30)

                match_Array(0) = row_FPMS
                n_matches = 1

                row_FPMS_lastMatch = row_FPMS
                order_no_FPMS = FPMS_RawWS.Cells(row_FPMS, 4)

                rowStart_FPMS = row_FPMS 'Multiple entries can exist in FPMS for a single entry in MSPS. This is the lower boundary

                row_FPMS = row_FPMS + 1

                Do While IMO_Number = FPMS_RawWS.Cells(row_FPMS, 1)

                    'The FPMS order numbers are made up of 8 ciphers: XXXXXXXN
                    'The 7 first ciphers are used to tie orders together. MSPS usually has a single entry for all FPMS
                    'entries under XXXXXXX.
                    If Left(order_no_FPMS, 7) = Left(FPMS_RawWS.Cells(row_FPMS, 4), 7) And order_no_FPMS = FPMS_RawWS.Cells(row_FPMS, 4) Then

                        match_Array(n_matches) = row_FPMS
                        n_matches = n_matches + 1

                        row_FPMS = row_FPMS + 1

                    ElseIf deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) Or deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) - 1 Or deliveryDate_MSPS = FPMS_RawWS.Cells(row_FPMS, 5) + 1 Then

                        match_Array(n_matches) = row_FPMS
                        n_matches = n_matches + 1

                        row_FPMS = row_FPMS + 1

                        'If the next valid MSPS record is on the date after the current one, and the next FPMS record is as well, exit loop
                        If IMO_next_match = True And deliveryDate_MSPS_next = FPMS_RawWS.Cells(row_FPMS, 5) Then

                            Exit Do

                        End If

                    End If
                    Loop

                    'Upper boundary of range.
                    rowEnd_FPMS = row_FPMS - 1

                    If n_matches = 1 Then

                        FPMS_RawWS.Range("A" & match_Array(0), "H" & match_Array(0)).Copy
                        mid_ReportWS.Cells(row_midFPMS, 1).PasteSpecial

                        MSPS_RawWS.Range("A" & row_MSPS, "H" & row_MSPS).Copy
                        mid_ReportWS.Cells(row_midMSPS, 11).PasteSpecial

                    ElseIf n_matches > 1 Then

                        For I = 0 To n_matches - 1

                            FPMS_RawWS.Range("A" & match_Array(I), "H" & match_Array(I)).Copy
                            mid_ReportWS.Range("A" & row_midFPMS + I).PasteSpecial

                        Next I

                        MSPS_RawWS.Range("A" & row_MSPS, "H" & row_MSPS).Copy
                        mid_ReportWS.Range("K" & row_midMSPS).PasteSpecial

                    End If

                    'Next free rows in mid-report
                    row_midMSPS = row_midMSPS + n_matches
                    row_midFPMS = row_midFPMS + n_matches

                    'The supreme_match_Array contains the row-position of all FPMS records that have been matched with an MSPS partner
                    'Empty the contents of the match_Array into the supreme array.
                    'The match_Array is recycled for every MSPS record - not every IMO number.

                    I = 0

                    Do Until match_Array(I) = 0

                        supreme_match_Array(I_sup) = match_Array(I)

                        I_sup = I_sup + 1
                        I = I + 1

                    Loop

                    'When the next MSPS record has a different IMO number than the current one, check supreme_match_Array against IMO_FPMS_Pos_Array
                    'to find out which FPMS records have not been paired with their MSPS counterparties, and copy these to the mid-report.
                    If IMO_next_match = False Then

                        temp_FPMS_Row = row_first_FPMS

                        IMO_matches = 0

                        'Find position of all FPMS records with matching IMO, and save this
                        Do While IMO_Number = FPMS_RawWS.Cells(temp_FPMS_Row, 1)

                            IMO_matches = IMO_matches + 1

                            IMO_FPMS_Pos_Array(IMO_matches - 1) = temp_FPMS_Row

                            temp_FPMS_Row = temp_FPMS_Row + 1

                        Loop

                        supreme_Size = 0

                        Do While supreme_match_Array(supreme_Size) > 0 'Find size of array

                            supreme_Size = supreme_Size + 1

                        Loop

                        For I = 0 To IMO_matches - 1

                            For I_sup = 0 To supreme_Size - 1

                                If IMO_FPMS_Pos_Array(I) = supreme_match_Array(I_sup) Then

                                    IMO_FPMS_Pos_Array(I) = 0
                                    GoTo NextIteration_I

                                End If

                            Next I_sup
NextIteration_I:
                        Next I

                        For I = 0 To IMO_matches - 1

                            If IMO_FPMS_Pos_Array(I) > 0 Then

                                FPMS_RawWS.Range("A" & IMO_FPMS_Pos_Array(I), "H" & IMO_FPMS_Pos_Array(I)).Copy
                                mid_ReportWS.Cells(row_midFPMS, 1).PasteSpecial

                                mid_ReportWS.Cells(row_midFPMS, 9).Hyperlinks.Add Anchor:=mid_ReportWS.Cells(row_midFPMS, 9), Address:="", SubAddress:= _
                               "'MSPS Raw'!A" & row_MSPS & ":R" & row_MSPS, TextToDisplay:="FPMS missing MSPS counter."

'                                Cells(row_midFPMS, 9).Select
'                                ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
'                                "'MSPS Raw'!A" & row_MSPS & ":R" & row_MSPS, TextToDisplay:="FPMS missing MSPS counter."

                                row_midFPMS = row_midFPMS + 1

                                FPMS_noMatches = True

                            End If

                        Next I

                        If FPMS_noMatches = True Then

                            'Next free rows in mid-report
                            row_midMSPS = row_midFPMS

                            FPMS_noMatches = False

                        End If

                        'The supreme array should be purged since we are moving on to another IMO-number
                        ReDim supreme_match_Array(30)
                        I_sup = 0

                    End If

            ElseIf quantity_MSPS = True Then

                        Sheets("MSPS Raw").Activate
                        Range("A" & row_MSPS, "H" & row_MSPS).Copy
                        Sheets("Mid-Report").Activate
                        Cells(row_midMSPS, 11).Select
                        ActiveSheet.Paste

                        'Cells(row_midMSPS, 9) = "MSPS missing partner."

                        Cells(row_midMSPS, 9).Select
                        ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                        "'FPMS Raw'!A" & row_FPMS_lastMatch & ":R" & row_FPMS_lastMatch, TextToDisplay:="MSPS missing partner."

                        row_midMSPS = row_midMSPS + 1
                        row_midFPMS = row_midFPMS + 1

                        row_FPMS = row_FPMS_lastMatch + 1

            End If 'Match check
            End If 'Date check
            End If 'Quantity > 0 check
    End If 'Error 40: Stock Update
    End If 'Date format check

    row_MSPS = row_MSPS + 1

Loop

End Sub 
```

编辑：更改数据集的大小没有任何区别。它仍然只能在崩溃之前协调 5-7 行，无论数据集总共包含超过 6000 行，还是总共只有 200 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T13:23:23.193

啊，天哪，我觉得自己好傻。我不小心从 Do While 循环中删除了分步语句。我为浪费您的时间而道歉。不过，由于 Chris 建议的变体数组，我的代码现在运行得比以往任何时候都快。

# javascript - 如何检测显示动画 [jquery] 当前正在运行

> ID：16007308
> 
> 赞同：0
> 
> 时间：2013-04-15T03:35:09.867
> 
> 标签：javascript, jquery, hide, show

我在 jquery 中使用特定时间的 show

```
$('#main_div').hide();
$('#main_div').show(3000); 
```

是他们的任何 jquery 选择器来检测显示动画当前正在运行。可能吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:38:04.800

可以通过选择器检测**一个动画是否在运行**`:animated`，但无法判断**运行的是哪个动画**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T03:38:32.190

你可以检查：

```
if( $("#main_div").is(':animated') ) {
   ...
} 
```

参见：[动画](http://docs.jquery.com/Selectors/animated)

# json - 在 Laravel/Eloquent 中，如何在 json 中包含没有属性和关系的 model::all() 的结果？

> ID：16007310
> 
> 赞同：1
> 
> 时间：2013-04-15T03:35:25.823
> 
> 标签：json, laravel, eloquent

Laravel 版本：laravel-laravel-936160f

```
$data = entities\org::all();

return var_dump($data); 
```

我在 all() 调用中获取数据，但我只想发出列元组。而且，因为我不能在 $data 上调用 toJson()，所以我将结果输出为 var_dump：

> 数组（612）{
> 
> > [0]=> 对象（实体\组织）#34 (5) {
> > 
> > > [“属性”]=> 数组（3）{
> > > 
> > > > [“org_id”]=> int(1)
> > > > 
> > > > ["name"]=> string(28) "某个名字"
> > > > 
> > > > ["short_name"]=> string(15) "一些短名称"
> > > 
> > > } [“原始”]=> 数组（3）{
> > > 
> > > > [“org_id”]=> int(1)
> > > > 
> > > > ["name"]=> string(28) "某个名字"
> > > > 
> > > > ["short_name"]=> string(15) "一些短名称"
> > > 
> > > } [“关系”]=> 数组（0）{ }
> > > 
> > > [“存在”]=>布尔（真）
> > > 
> > > [“包括”]=> 数组（0）{ }
> > 
> > }
> > 
> > [1]=>...

如何获取基本的 json 元组？（org_id，名称，简称）。我可以迭代数据数组，但我在想必须有一个更快/更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:52:36.407

在 Laravel 3 中：

```
$data = entities\org::all();
return Response::eloquent($data); 
```

在 Laravel 4 中：

```
return entities\org::all(); 
```

Laravel 3 和 Laravel 4 都提供了自动方法来返回 json 表示。

Laravel 3 资源：

[http://laravel.com/docs/database/eloquent#to-array](http://laravel.com/docs/database/eloquent#to-array) [https://github.com/laravel/laravel/blob/master/laravel/helpers.php#L281](https://github.com/laravel/laravel/blob/master/laravel/helpers.php#L281) [https://github.com/laravel/ laravel/blob/master/laravel/response.php#L136](https://github.com/laravel/laravel/blob/master/laravel/response.php#L136) [https://github.com/laravel/laravel/blob/master/laravel/database/eloquent/model.php#L589](https://github.com/laravel/laravel/blob/master/laravel/database/eloquent/model.php#L589)

Laravel 4 资源：

[http://four.laravel.com/docs/eloquent#converting-to-arrays-or-json](http://four.laravel.com/docs/eloquent#converting-to-arrays-or-json) [https://github.com/laravel/framework/blob/master/src/Illuminate/Database/Eloquent/Model.php #L1409](https://github.com/laravel/framework/blob/master/src/Illuminate/Database/Eloquent/Model.php#L1409) [https://github.com/laravel/framework/blob/master/src/Illuminate/Support/Collection.php#L200](https://github.com/laravel/framework/blob/master/src/Illuminate/Support/Collection.php#L200)

希望所有这些都有帮助。

# c - 环回设备上的组播

> ID：16007311
> 
> 赞同：14
> 
> 时间：2013-04-15T03:35:32.230
> 
> 标签：c, linux, networking, multicast

我希望将 UDP 多播数据包发送到环回地址并在其他应用程序中接收相同的数据。所有测试均在 fedora core 17 Linux 上完成。

这个想法是通过 RTSP/HTTP 或任何其他网络协议接收视频流，并在环回地址上多播它，这样我就可以使用 VLC 使用多播地址播放流。撇开其他比特率和受控多播问题不谈，我尝试在环回设备上读取一个视频文件和多播。但是当试图在 vlc 上玩同样的游戏时，它并没有奏效。我可以看到在wireshark中传输的数据包，但是src ip取自我的默认网络接口（即我的默认网关接口）

我已经尝试过以下命令

```
sudo ifconfig lo multicast
sudo ip route add 239.252.10.10 dev lo 
```

在这方面的任何建议都会非常有帮助。

下面粘贴的测试程序代码

```
 #include <sys/types.h>
    #include <sys/socket.h>
    #include <arpa/inet.h>
    #include <netinet/in.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    #include <unistd.h>

    #define MULTICAST_ADDRESS "239.252.10.10"
    #define UDP_PORT 1234
    #define INTERFACE_IP    "127.0.0.1"
    #define MTU 1474
    #define DATA_BUFFER_SIZE  (1024*1024)

    static int  socket_init(char *intf_ip) {
    int sd;
    struct in_addr localInterface;

      sd = socket (AF_INET, SOCK_DGRAM, 0);
      if (sd < 0) {
          perror ("Opening datagram socket error");
          return -1;
      }
      else
        printf ("Opening the datagram socket...OK.\n");

      localInterface.s_addr = inet_addr (intf_ip);

      if (setsockopt(sd, IPPROTO_IP, IP_MULTICAST_IF, (char *) &localInterface,sizeof (localInterface)) < 0){
          perror ("Setting local interface error");
          close(sd);
          return -1;
      }
      else
        printf ("Setting the local interface...OK\n");
    #if 1
        char loopch = 1;

        if(setsockopt(sd, IPPROTO_IP, IP_MULTICAST_LOOP, (char *)&loopch, sizeof(loopch)) < 0){
        perror("Setting IP_MULTICAST_LOOP error");
        close(sd);
        return -1;
        }
        else
        printf("Enabling the loopback...OK.\n");
    #endif
      return sd;

    }

    static int transmit_packet(int sd, char *databuf, int size,char *ip, unsigned short port){

    struct sockaddr_in groupSock;
    int len,datalen,rc;

      memset ((char *) &groupSock, 0, sizeof (groupSock));

      groupSock.sin_family = AF_INET;

      groupSock.sin_addr.s_addr = inet_addr (ip);

      groupSock.sin_port = htons (port);

      len=0;
      datalen = MTU;
      if(size < MTU)
        datalen = size;

      while(len < size){
        rc = sendto(sd, databuf, datalen, 0, (struct sockaddr *) &groupSock,sizeof (groupSock));
        if(rc <0){
          perror ("Sending datagram message error");
          return -1;
        }
        usleep(10000);
        len += rc;
      }
      return len;
    }

    static int transmit_file(char *filepath, char *dstip, char *srcip,unsigned short port) {
    FILE *fp;
    int sd,rc;
    char *databuf;

        fp = fopen(filepath, "r");
        if(!fp) {
        printf("transmit_file : no such file or directory %s \n",filepath);
        return -1;
        }
        sd = socket_init(srcip);
        if(sd < 0) {
        printf("Socket initialization failed \n");
        fclose(fp);
        return -1;
        }
        databuf = (char*) malloc(sizeof(char)*DATA_BUFFER_SIZE);
        if(!databuf) {
        printf("Unable to allocate databuf\n");
        close(sd);fclose(fp);
        return -1;
        }
        while(!feof(fp)){
        rc = fread(databuf,1,DATA_BUFFER_SIZE,fp);
        if(rc<= 0) {
            printf("read failed or EOF reached\n");
            break;
        }           
        if(transmit_packet(sd,databuf,rc,dstip,port) <0)
            printf("Transmit failed\n");    
        }
        close(sd);fclose(fp);
        free(databuf);
        return 0;
    }

    int main(int argc, char *argv[]){

       if(argc != 3){
        printf("%s <filename> <ip>\n",argv[0]);
        return -1;
       }
       transmit_file(argv[1],argv[2],INTERFACE_IP,UDP_PORT);
       return 0;
    } 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-06-22T14:09:22.420

您可以在环回上使用多播，但您必须添加新路由，因为您的操作系统默认使用默认外部接口进行多播。默认情况下，也可以在环回时禁用多播。在 linux 上，您可以使用以下命令更改它：

```
route add -net 224.0.0.0 netmask 240.0.0.0 dev lo
ifconfig lo multicast 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-06-20T05:10:04.270

如果您不希望通过网络发送 IP 多播流量（例如 IGMP 消息），则必须绑定或路由到环回设备。但是，这通常仅在网络上存在可能通过使用相同的多播组进行干扰的其他计算机时才需要。

真正的问题是，当它们都配置为使用相同的多播组时，同一主机上的程序接收彼此发送的多播数据（或者，等效地，单个程序中的套接字接收彼此发送的多播数据）。

这是一个很常见的问题，上面有很多 StackOverflow 问题，但它们经常被误解或措辞不当。很难专门针对操作系统行为或标准化来搜索此问题。

在硬件级别，多播流量被视为广播流量，因为它不会路由回发送它的物理端口，以防止链路级循环。这意味着操作系统负责将流量转发到加入多播组的同一主机上的其他程序或套接字，因为它不会从接口读取。

这是由标准选项配置的， [IP 多播 MSDN 文章](https://docs.microsoft.com/en-us/windows/win32/winsock/ip-multicast-2)[（存档）](https://web.archive.org/web/20190716181242/https://docs.microsoft.com/en-us/windows/win32/winsock/ip-multicast-2)`IP_MULTICAST_LOOP`对此进行了最佳总结：

> 目前，大多数 IP 多播实现使用一组由 Steve Deering 向 Internet 工程任务组 (IETF) 提出的套接字选项。因此提供了五种操作：
> 
> [...]
> 
> *   `IP_MULTICAST_LOOP`— 控制多播流量的环回。
> 
> [...]
> 
> 该选项的 Winsock 版本在`IP_MULTICAST_LOOP`语义上与该选项的 UNIX 版本不同`IP_MULTICAST_LOOP`：
> 
> *   在 Winsock 中，该`IP_MULTICAST_LOOP`选项仅适用于接收路径。
> *   在 UNIX 版本中，该`IP_MULTICAST_LOOP`选项适用于发送路径。
> 
> 例如，应用程序 ON 和 OFF（比 X 和 Y 更容易[跟踪]）在同一个界面上加入同一个组；application ON 设置`IP_MULTICAST_LOOP`选项打开，application OFF 设​​置`IP_MULTICAST_LOOP`选项关闭。如果 ON 和 OFF 是 Winsock 应用程序，OFF 可以发送到 ON，但 ON 不能发送到 OFF。相反，如果 ON 和 OFF 是 UNIX 应用程序，则 ON 可以发送到 OFF，但 OFF 不能发送到 ON。

根据我的阅读，这个设置可能在 Windows 上默认禁用，在 Linux 上默认启用，但我自己没有测试过。

作为一个重要的附带说明，该`IP_MULTICAST_LOOP`选项与该选项完全不同，`IPV6_MULTICAST_LOOP`请参阅 Linux[`ip(7)`](https://man7.org/linux/man-pages/man7/ip.7.html)和[`ipv6(7)`](https://man7.org/linux/man-pages/man7/ipv6.7.html)手册页：

> `IP_MULTICAST_LOOP`（自 Linux 1.2 起）设置或读取一个布尔整数参数，该参数确定发送的多播数据包是否应循环回本地套接字。
> 
> `IPV6_MULTICAST_LOOP` 控制套接字是否看到它自己[发送]的多播数据包。参数是一个指向布尔值的指针。

`IP_MULTICAST_LOOP`允许在发送它的同一主机上的不同套接字上接收 IP 多播流量。`IPV6_MULTICAST_LOOP`允许在发送它的同一个套接字上接收 IPv6 多播流量——这在 IPv4 中通常是不可能的。

如果有人参考了有关实现的预期行为的官方标准（RFC、IEEE POSIX 标准等），请将它们发布在评论中或编辑此答案。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-04-15T04:15:03.690

> 我希望将 UDP 多播数据包发送到环回地址

停在那儿。你不能那样做。不可能。您只能将多播发送到多播地址。您的代码不进行任何多播，只是发送到 127.0.0.1。

如果您只发送到本地主机，为什么要使用多播？你有多个聆听过程吗？

> src ip取自我的默认网络接口（即我的默认网关接口）

很可能，因为你还没有绑定你的套接字。你期待什么？

# c# - c# 等待串口上的回显，检查它，并在等待时超时

> ID：16007313
> 
> 赞同：5
> 
> 时间：2013-04-15T03:35:38.837
> 
> 标签：c#

您好，感谢您考虑此查询：我正在通过虚拟串行端口从 PC 向嵌入式系统发送命令，当嵌入式系统完成命令时，该命令会回显该命令。

当命令由嵌入式系统完成时，我可以很好地发送命令并看到回显，但是我无法找到合适的方法来等待或延迟程序直到收到回显的命令，以便我可以继续并发送下一个命令。我想它是我正在尝试实现的一种“高级”流控制。代码在 C# 中。我想等待回声并有一个超时，以防PC和嵌入式系统之间的通信丢失，这样程序就不会冻结。有没有可以建议一种巧妙的方法来做到这一点的聪明孩子？我不是一个伟大的 c# 程序员，只是在学习。

这是我拥有的接收功能：

```
 private void port_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        // If the com port has been closed, do nothing
        if (!comport.IsOpen) return;

        // This method will be called when there is data waiting in the port's buffer

        // Determain which mode (string or binary) the user is in
        if (CurrentDataMode == DataMode.Text)
        {
            // Read all the data waiting in the buffer
            string data = comport.ReadExisting();

            // Display the text to the user in the terminal
            Log(LogMsgType.Incoming, data);
        }
        else
        {
            // Obtain the number of bytes waiting in the port's buffer
            int bytes = comport.BytesToRead;

            // Create a byte array buffer to hold the incoming data
            byte[] buffer = new byte[bytes];

            // Read the data from the port and store it in our buffer
            comport.Read(buffer, 0, bytes);

            // Show the user the incoming data in hex format
            Log(LogMsgType.Incoming, ByteArrayToHexString(buffer));
            }
    } 
```

这是调用 Transmitt 命令的示例：

```
 text = "AR" + 50 + "\r";            //transmit a command to move
     this.comport.Write(text); 
```

目前我正在使用时间延迟 [Thread.Sleep(TIMEGAP)] 并假设消息已执行并且从嵌入式系统返回的回声很好但我不检查它并且等待很长时间以确保完成：

```
 text = "AR" + 50 + "\r";            //transmit a command to move
     this.comport.Write(text);
     Thread.Sleep(TIMEGAP);              //Timegap = 10000ms 
```

我真的很想用一个监视串行端口响应的函数/方法替换时间延迟调用 [Thread.Sleep(TIMEGAP)]，检查它是否与发送的相同，然后允许程序代码继续执行下一个命令，并且如果在例如 5 秒内未收到正确的回显 [AR50\r 在上例中]，则程序报告错误。

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T03:55:05.247

最简单的方法是不使用`DataReceived`事件，而是通过设置 a[`ReadTimeout`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readtimeout.aspx)并使用`Read`方法。

而且由于您正在处理 ASCII，因此您应该查看该[`ReadLine`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readline.aspx)方法。

在没有传入数据的情况下，两者都会抛出一个[`TimeoutException`](http://msdn.microsoft.com/en-us/library/system.timeoutexception.aspx)if `ReadTimeout`has elapsed。

但是，如果嵌入式系统可以发送不请自来的消息，那么您将需要另一种方法。然后，您可以将您期望的回声放在全局字符串变量中，并在收到[`ManualResetEvent`](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)回声时设置接收事件。然后你可以等待`ManualResetEvent`超时。这也将涉及使用[`lock`](http://msdn.microsoft.com/en-us/library/c5kehkcz%28v=vs.80%29.aspx)语句的线程同步。

如果 GC 不是问题，我可能会从以下内容开始：

```
using System.Text;
using System.IO.Ports;
using System.Threading;

namespace ConsoleApplication2
{
    class Program
    {
        static string serialBuffer = "";
        static string expectedEcho = null;
        static object expectedEchoLock = new object();
        static ManualResetEvent expectedEchoReceived = new ManualResetEvent(false);
        static SerialPort port = new SerialPort("COM1", 19200, Parity.None, 8, StopBits.One);

        static void Main(string[] args)
        {
            port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
        }

        static void port_DataReceived(object sender, SerialDataReceivedEventArgs e)
        {
            while (port.BytesToRead > 0)
            {
                byte[] buffer = new byte[port.BytesToRead];
                int bytesRead = port.Read(buffer, 0, buffer.Length);
                if (bytesRead <= 0) return;
                serialBuffer += Encoding.UTF8.GetString(buffer, 0, bytesRead);
                string[] lines = serialBuffer.Split('\r', '\n');
                // Don't process the last part, because it's not terminated yet
                for (int i = 0; i < (lines.Length - 1); i++)
                {
                    if (lines[i].Length > 0)
                        ProcessLine(lines[i]);
                }
                serialBuffer = lines[lines.Length - 1]; // keep last part
            }
        }

        static void ProcessLine(string line)
        {
            bool unsolicitedMessageReceived = false;
            lock (expectedEchoLock)
            {
                if (line == expectedEcho)
                {
                    expectedEchoReceived.Set();
                }
                else
                {
                    unsolicitedMessageReceived = true;
                }
            }
            if (unsolicitedMessageReceived)
            {
               // Process unsolicited/unexpected messages
            }
        }

        /// <summary>
        /// Send a command and wait for echo
        /// </summary>
        /// <param name="command">The command to send</param>
        /// <returns>True when echo has been received, false on timeout.</returns>
        static bool SendCommand(string command)
        {
            lock (expectedEchoLock)
            {
                expectedEchoReceived.Reset();
                expectedEcho = command;
            }
            port.Write(command);
            return expectedEchoReceived.WaitOne(5000); // timeout after 5 seconds
        }
    }
} 
```

# elasticsearch - ElasticSearch/Elastica：搜索包含“and”或其他停用词的确切术语

> ID：16007315
> 
> 赞同：0
> 
> 时间：2013-04-15T03:36:26.587
> 
> 标签：elasticsearch, stop-words, elastica

我试图让 ES QueryString 匹配其中包含“和”的搜索词，但到目前为止我尝试过的所有内容（尝试不同的分析器、tokenziers、过滤器）都没有奏效。在 MySQL 方面，我想要的是：

```
WHERE field LIKE '%abbot and costello%' 
```

我尝试了各种配置，这是我目前正在使用的（略有改进，因为它匹配“abbot”（带有尾随空格），但仍然不匹配任何带有“and”的内容：

```
$eI->create(array(
    'analysis' => array(
        'analyzer' => array(
            'indexAnalyzer' => array(
                'type' => 'custom',
                'tokenizer' => 'SQLedgeNGram',
                'filter' => array(
                    'lowercase',
                ),
            ),
            'searchAnalyzer' => array(
                'type' => 'custom',
                'tokenizer' => 'SQLedgeNGram',
                'filter' => array(
                    'lowercase', 
                ),
            )
        ),
        'tokenizer' => array(
            'SQLedgeNGram' => array(
                'type' => 'edgeNGram',
                'min_gram' => 2,
                'max_gram' => 35,
                'side' => 'front'   
            ),
            'standardNoStop' => array(
                'type' => 'standard',
                'stopwords' => ''   
            )   
        )
    )
), true
); 
```

这是我的测试用例字段值：

```
Abbott and Costello - Funniest Routines, Vol. 
```

尝试各种分析器，我似乎无法让它匹配任何包含“和”的东西。

结果：

```
searching [abbot] 
 @       searchAnalyzer          total results: 1
 @       standard                total results: 1
 @       simple                  total results: 1
 @       whitespace              total results: 1
 @       keyword                 total results: 1

searching [abbot ] 
 @       searchAnalyzer          total results: 1
 @       standard                total results: 1
 @       simple                  total results: 1
 @       whitespace              total results: 1
 @       keyword                 total results: 1

searching [abbot and c] 
     searchAnalyzer          total results: 0
     standard                total results: 0
     simple                  total results: 0
     whitespace              total results: 0
     keyword                 total results: 0

searching [abbot and cost] 
     searchAnalyzer          total results: 0
     standard                total results: 0
     simple                  total results: 0
     whitespace              total results: 0
     keyword                 total results: 0

searching [abbot and costello] 
     searchAnalyzer          total results: 0
     standard                total results: 0
     simple                  total results: 0
     whitespace              total results: 0
     keyword                 total results: 0

searching [abbot costello] 
     searchAnalyzer          total results: 0
     standard                total results: 0
     simple                  total results: 0
     whitespace              total results: 0
     keyword                 total results: 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:01:20.137

您在查询中有拼写错误（雅培中缺少第二个 t）。您也不需要通过 ngram 运行搜索。搜索标记器可以是关键字，它仍然适用于短于 35 个字符的短语。顺便说一下，edgeNGram 只会给你尾随通配符。对于前导和尾随通配符，您需要使用 nGram 过滤器。

# django - 构建自定义可扩展模型

> ID：16007317
> 
> 赞同：0
> 
> 时间：2013-04-15T03:36:39.657
> 
> 标签：django, django-models

假设我有一个名为**客户端**的模型，其中包含基本信息，例如名字、姓氏、电子邮件等。如果我希望用户能够添加另一个自定义字段（仅针对他），请说**净值**（文本字段）。该用户现在可以向他的所有客户添加净值信息。另一个用户可能想要向他的所有客户添加**通话记录**。

我该如何设计一个可以处理来自不同用户的自定义添加的模型？而且，我正在尝试做的事情有一个特定的名称吗？

**更新：**

有多个帐户，每个帐户都有一组客户。我正在考虑使用 ClientCharIndex 模型来跟踪所有扩展字段，并使用 ClientCharAttribues 模型来存储所有值。

```
class Client(Model):
   account = models.ForeignKey(Account)
   first_name = Model.CharField()
   last_name = Model.CharField()
   ...

class ClientCharIndex(Model):
   account = models.ForeignKey(Account)
   name = Model.CharField()

class ClientCharAttribues(Model):
   key = models.ForeignKey(ClientCharIndex)
   client = models.ForeignKey(Client)
   value = Model.CharField() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:30:17.560

您可以做的是定义一个仅具有键值字段（并且可能是类型）的模型，并与`client`模型具有 M2M 或外键关系。

像这样的东西：

```
class Client(Model):
  ...

class UserAttribues(Model):
   key = Model.CharField()
   value = Model.CharField()
   client = Model.ManyToManyField(Client) 
```

有了这个，您可以将任何键值信息添加到客户端对象和任意数量的对象中。

# gwt - 为什么这个 uibinder 页面没有垂直滚动条？

> ID：16007318
> 
> 赞同：0
> 
> 时间：2013-04-15T03:36:41.493
> 
> 标签：gwt, uibinder

我希望浏览器在内容变得大于页面时显示垂直滚动条。内容和页脚消失在屏幕下方，而不是显示垂直滚动条（就像我们在 SO 主页上看到的那样）。

我之前问过一个[类似](https://stackoverflow.com/questions/16003671/how-to-get-content-to-push-footer-down-using-uibinder-docklayoutpanel)的问题，但它是针对为什么页脚不会随着内容的增长而扩展的。我解决了这个问题，但现在页脚向南移动，但页面滚动条从未出现。

我的 UiBinder xml 如下（这里是[文件的链接](https://github.com/justinhrobbins/FlashCards_App/blob/4ae599c373ec0cbb08248535d6d0c0af4fee99d8/FlashCards_GWT/src/main/java/org/robbins/flashcards/client/ui/desktop/style/ShellStyles.css)）：

```
<g:DockLayoutPanel unit='PX' styleName="{style.shellStyles.wrap}">
<g:north size='180'>
    <g:HTMLPanel styleName='{style.shellStyles.header}'>
        <div id="login" class="{style.shellStyles.login}">
            <g:InlineLabel ui:field="loggedInUser"/>
            <g:InlineHyperlink ui:field="loginLogoutLink"/>
        </div>
        <h1><a href="/">Flash Cards Application</a></h1>
    </g:HTMLPanel>
</g:north>
<g:center>
  <g:FlowPanel>
    <g:HTMLPanel styleName='{style.shellStyles.content}'>
        <g:SimplePanel styleName='{style.shellStyles.left}' ui:field="navigationPanel" />
        <g:SimplePanel styleName='{style.shellStyles.right}' ui:field='contentPanel' />
        <div style="clear: both;" ></div>
    </g:HTMLPanel>
    <g:HTMLPanel styleName="{style.shellStyles.footer}" height="70">
        <g:Label>&copy; Copyright by Justin Robbins</g:Label>
    </g:HTMLPanel>
  </g:FlowPanel>
</g:center> 
```

CSS 的摘录如下（这里是[完整 CSS 的链接](https://github.com/justinhrobbins/FlashCards_App/blob/4ae599c373ec0cbb08248535d6d0c0af4fee99d8/FlashCards_GWT/src/main/java/org/robbins/flashcards/client/ui/desktop/style/ShellStyles.css)）：

```
.wrap {
    width: 820px;
    margin: 20px auto 10px auto;
}
@sprite .header {
gwt-image: "headerImage";
background-color: #efefef;
height: 180px;
}
@sprite .content {
    gwt-image: "contentImage";
    background-color: #efefef;
    padding: 10px 40px 20px 20px;
    min-height: 500px;
}
.left {
    width: 210px;
    float: left;
}
@sprite .left h4 {
    gwt-image: "sidebarImage";
    padding: 0 0 0 10px;
    height: 50px;
    line-height: 50px;
    color: #fff;
}
.right {
    width: 530px;
    float: right;
    padding-top: 10px;
    padding-right: 60px;
}
@sprite .footer {
    gwt-image: "footerImage";
    background-color: #efefef;
    height: 70px;
    line-height: 70px;
    color: #fff;
    text-align: center;
}

*{margin:0; padding:0;}
body {
    font-family: Arial;
    font-size: 12px; 
    background: #efefef;
    color: #232323; 
    margin:0; 
    padding:0;
    line-height: 150%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T11:29:57.963

[使用ScrollPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/ScrollPanel.html)将 Flowpanel 包裹在内容区域并设置其高度。你会得到卷轴

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T08:47:22.920

您正在使用基于布局的面板作为根元素，因此它将始终适合整个页面，如果您调整浏览器窗口的大小，所有内容都会相应地调整大小（如果您已经使用`ProvidesResize`/`RequiresResize`小部件）。

如果您知道它的内容会增长，只需​​将其包装成 a `ScrollLayoutPanel`，或将元素的第一个设置`FlowPanel`为`<center>`have `overflow`（您将看到它很难看）。

您可能还希望页脚始终可见，那么为什么不将其移到 main 区域`DockLayoutPanel`呢？

我建议你在[这里](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels)阅读。

# servlets - 一个 web 项目中可以有多个 servlet 吗？

> ID：16007322
> 
> 赞同：1
> 
> 时间：2013-04-15T03:37:46.970
> 
> 标签：servlets

我正在创建一个课程注册系统。

首先，用户填写注册表，然后将用户信息存储在数据库中。然后用户被发送到登录页面。所有这些都在一个名为 RegServlet.java 的文件中处理。

在下一页，用户需要输入用户名和密码才能“登录”查看提供的课程列表。

我需要创建另一个 Servlet 文件吗？尝试向 web.xml 文件添加另一个 servlet，但没有成功。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T06:08:36.950

一个 Web 项目中可以有超过 1 个 servlet。

但是，这不是你在你的情况下应该做的。理想情况下，当您可以隔离身份验证和用户注册时，您不需要在同一个 web.xml 文件中添加另一个 Servlet。

要执行身份验证，请阅读此[Java EE 教程](http://docs.oracle.com/javaee/6/tutorial/doc/bnbwj.html)

# spring - Maven 是否需要明确指定 Spring/Hibernate 依赖的依赖项？

> ID：16007323
> 
> 赞同：2
> 
> 时间：2013-04-15T03:37:49.203
> 
> 标签：spring, hibernate, maven, dependencies

我是 Maven 新手，我尝试在我的项目中使用 Maven 和 Spring、Hibernate。在查看 Spring 和 Hibernate 参考后，我发现“无需在 POM.xml 文件中为此类 Apache 公共库显式指定依赖库”。

我的问题是：如果我的项目的其他部分引用了 Apache 公共库，例如 commons-io，我应该在 POM.xml 文件中明确指定此依赖项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:41:52.310

您应该在项目使用的 Maven 中定义这些依赖项。例如，即使某些库依赖于 commons-io，但如果您的代码需要它，那么您应该直接在 pom.xml 中定义 commons-io

您不必担心在 pom.xml 中定义的库的依赖关系。Maven 会为你做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:33:22.867

[您可以在mvnrepository.com](http://mvnrepository.com/)之类的站点上提供一个库名称，以查看它所依赖的内容（例如，在[spring-webmvc](http://mvnrepository.com/artifact/org.springframework/spring-webmvc/3.2.2.RELEASE)库的情况下，请查看名为“此工件取决于...”的部分）。这些依赖项（您的工件所依赖的）称为[传递依赖项](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)。您不必在 pom.xml 中指定这些，因为 maven 会为您解析它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T07:52:10.570

**为了便于阅读，您应该只在您的模块中说明您直接**依赖的那些依赖项。你想让 JUnit 测试你的软件，只声明 JUnit；你需要hibernate才能使用ORM，声明hibernate等等。剩下的交给 Maven。

大多数情况下，您应该在要使用它的模块中说明您打算使用的内容。因此，如果您想在多个模块中使用依赖项，请考虑将其移动到父 pom 中的 dependencyManagement 块中并在您想要的模块中从那里引用它。

父 pom.xml

```
<dependencyManagement>
   <dependencies>
      <dependency>
         <groupId>junit</groupId>
         <artifactId>junit</artifactId>
         <version>4.10</version>
         <scope>test</scope>
      </dependency>
   </dependencies>
</dependencyManagement> 
```

子 pom.xml

```
<dependencies>
   <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
   </dependency>
</dependencies> 
```

这保证了您的版本稳定性，并且仍然允许您通过仅查看它的 pom（而不是所有地方）来找出模块使用的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T03:54:08.440

Maven 用于避免必须运行依赖于其他 JAR 文件的 JAR 文件的问题。当然，您不必使用 maven 来执行此操作，但您应该这样做。Maven会自动下载你需要的JAR文件的依赖JAR文件。例如，hibernate-entity manager JAR 文件有 100 多个依赖项，而 maven 会为您完成这项工作。

无论如何，即使您确实将commons-io文件添加到maven项目的构建路径/类路径，然后更新项目配置，maven也会将其踢出。

# javascript - 从另一个页面调用的一个页面的 Ajax 加载 div

> ID：16007330
> 
> 赞同：0
> 
> 时间：2013-04-15T03:38:40.787
> 
> 标签：javascript, ajax, url, load

我面临一些关于 ajax 加载
OK 的故障，所以查询可以说我有页面 a（附图片）
![在此处输入图像描述](https://i.stack.imgur.com/qjYSd.jpg)

ajax 在单击特定 ID 时将 div 加载到“RESULT” div 中，
这里是 ajax 脚本和我到目前为止的 html。这可以完美地加载到页面 a 本身的 Result div 上。

```
<a href="#" id="one" /><br>
<a href="#" id="two" /><br>
<a href="#" id="three" /><br>
<div id="result"  class="functions"></div> 
```

```
 $.ajaxSetup({
        cache: false
    });
    var ajax_load = "<img class='loading' src='img/load.gif' alt='loading...' />";

    var loadUrl = "content.php";
    $("#one").click(function () {
    $("#result").html(ajax_load).load(loadUrl);
    });

    var load2Url = "content1.php";
    $("#two").click(function () {
    $("#result").html(ajax_load).load(loadUrl);
    });

    var load3Url = "content2.php";
    $("#three").click(function () {
        $("#result").html(ajax_load).load(load2Url);
    }); 
```

事情是我需要使用相同的 id 调用从另一个页面在页面 b 上的结果 div 上加载相同的内容，比如说页面 b。
![在此处输入图像描述](https://i.stack.imgur.com/TMYhv.jpg)

这个概念是，在页面 b 上，单击 id，它首先加载页面 a 并在“结果”div 上加载内容。两个页面都在同一台服务器上
非常感谢任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:53:24.827

处理它的一种方法是将动态项目作为请求参数传递，例如在页面 b 中使用 url`/pagea.html?section=one`等

然后在页面加载

```
$(function(){
    var location = window.location.href;
    var page = location.substring(location.indexOf('=') + 1);
    $('#' + page).trigger('click');
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:49:57.680

您的`loadUrl`'s 速度错误，它们应该在函数内部，否则它的值是它设置为的最后一个值`content2.php`

[jsFiddle 演示](http://jsfiddle.net/Class/HnH9S/1/)

```
$.ajaxSetup({
    cache: false
});

var ajax_load = "<img class='loading' src='img/load.gif' alt='loading...' />";

$("#one").click(function () {
    var loadUrl = "content.php";
    $("#result").html(ajax_load).load(loadUrl);
});

$("#two").click(function () {
    var loadUrl = "content1.php";
    $("#result").html(ajax_load).load(loadUrl);
});

$("#three").click(function () {
    var loadUrl = "content2.php";
    $("#result").html(ajax_load).load(loadUrl);
}); 
```

# scala - 如何在 Akka (2.1.2) 中限制消息？

> ID：16007333
> 
> 赞同：2
> 
> 时间：2013-04-15T03:39:03.697
> 
> 标签：scala, akka, scala-2.10

你们能否展示在 Akka 中限制消息的示例？

这是我的代码

```
object Program {
  def main(args: Array[String]) {
    val system = ActorSystem()
    val actor: ActorRef = system.actorOf(Props[HelloActor].withDispatcher("akka.actor.my-thread-pool-dispatcher"))

    val zzz : Function0[Unit] = () => {
      println(System.currentTimeMillis())
      Thread.sleep(5000)
    }

    var i: Int = 0
    while (i < 100) {
      actor ! zzz
      i += 1
    }

    println("DONE")

//    system.shutdown()
  }
}

class HelloActor extends Actor {
  def receive = {
    case func : Function0[Unit] => func()
  }
} 
```

这是我的配置

```
akka {
  actor {
    my-thread-pool-dispatcher {
      type = Dispatcher
      executor = "thread-pool-executor"
      thread-pool-executor {
        task-queue-type = "array"
        task-queue-size = 4
      }
    }
  }
} 
```

但是当我运行它时，它似乎是单线程的，因为我希望同时处理 4 条消息。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T05:18:55.427

I don't see the connection between the question's title and the content.

Here is an article about throttling messages in Akka:

[http://letitcrash.com/post/28901663062/throttling-messages-in-akka-2](http://letitcrash.com/post/28901663062/throttling-messages-in-akka-2)

However, you seem puzzled about the fact that your actor is processing only one message at a time. But that's how Akka actors work. They have a single mailbox of messages and they process only one message at a time in a continuous loop.

If you want to handle multiple tasks concurrently with the same work processing unit I suggest you take a look at routers:

[http://doc.akka.io/docs/akka/2.1.2/scala/routing.html](http://doc.akka.io/docs/akka/2.1.2/scala/routing.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-05T06:16:35.143

Typesafe 最近宣布了 akka 反应式流。可以使用其背压能力来实现节流。

[http://java.dzone.com/articles/reactive-queue-akka-reactive](http://java.dzone.com/articles/reactive-queue-akka-reactive)

# php - 清空 div，然后在用户登录后自动将内容加载到其中

> ID：16007334
> 
> 赞同：0
> 
> 时间：2013-04-15T03:39:09.387
> 
> 标签：php, jquery, session, login

一旦用户登录，我想使用 jQuery 清空内容 div 并将另一个页面加载到该 div 中。

我使用单击按钮后的正常工作方式：

```
$(document).ready(function() {
    $("#login").click(function() {
        $("#content").empty();
        $("#content").load("DIS-loginform.php");
    });
}); 
```

我不希望单击任何内容以在我的内容 div 中加载另一个页面。

这是我主页侧边栏中的登录脚本，因此一旦登录，它将输出用户的用户名，

```
<?php  //LOGIN PHP SCRIPT
    $login = $_POST['username'];
    $loginpass =$_POST['password'];
    if((isset($login)) || (isset($loginpass))){
        include("DIS-connect.php");
        $query = "SELECT * FROM user WHERE username='$login' and password=('$loginpass')";
        $result = mysql_query($query) or die($query."<br/><br/>".mysql_error());
        $count = mysql_num_rows($result);
        //echo $count;
        if($count >0){
            echo "Logged in as <button id='user' value='$login'>$login</button>";
            $_SESSION['valid_user'] = $login;
        }
        else{
            echo "<p>sorry login failed</p>";
        }
    }
// LOGIN PHP END ?> ` 
```

这是我的简单登录表单，当登录选项被选中时，它会加载到我的主页的内容 div 中。

```
<div id="login">
    <form name="login" action="DIS-home.php" method="POST" 
                onSubmit="return confirm('Continue with Login?');">
        <table border="1">
            <tr>
                <th>Username</th><td><input name="username" type="text" id="username" /></td>
            </tr>
    <tr>
        <th>Password</th><td><input name="password" type="password" id="password" /></td>
    </tr>
        </table>
        <input type="submit" name="Submit" value="Login" id="loginbutton" />
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:17:39.250

如果您不想点击任何内容，请使用

```
$(document).ready(function() {
    $("#content").empty();
    $("#content").load("DIS-loginform.php");
}); 
```

代替

```
$(document).ready(function() {
    $("#login").click(function() {
        $("#content").empty();
        $("#content").load("DIS-loginform.php");
    });
}); 
```

而且我认为您最好更改您的 SQL 查询，因为它不保存（SQL 注入）！同样在查询中：密码值上没有散列或其他东西？所以也许考虑使用 MD5 或 SHA2 加密？

我目前看到的最后一件事：

而不是使用：

```
if($count >0) 
```

利用

```
if($count == 1) 
```

这可以防止黑客使用返回多行的 SQL 注入进行登录。

例如：

我可以不使用密码和这个用户名登录：

```
' or 'test'='test' -- ' 
```

因为它会得到所有用户的结果，并且查询中的密码部分将被注释掉。

# php - 需要帮助将时间字符串转换为可用格式

> ID：16007337
> 
> 赞同：0
> 
> 时间：2013-04-15T03:39:41.243
> 
> 标签：php

我有一个格式如下的字符串 yyyy-mm-dd-hh-mm-ss

它采用这种格式的原因是它是 URL 的一部分。我需要帮助将其转换为 PHP 中可用的时间格式。

这是我到目前为止所尝试的。

```
$time = "2013-04-14-23-33-17";
$time2 = strtotime($time);
$time3 = date('M d, Y', $time2) . ' ' . _('at') . ' ' . date('h:i a', $time2);
echo $time3; 
```

它只是在 1970 年 1 月 1 日凌晨 12:00 回响，这是错误的，而不是 2013 年 4 月 14 日晚上 11:33。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:44:13.637

它不起作用，因为那不是有效的日期格式。请参阅[支持的日期和时间格式](http://www.php.net/manual/en/datetime.formats.php)。

您需要做的是通过为您的字符串指定格式来创建一个 DateTime 对象。

[`DateTime::createFromFormat`](http://www.php.net/manual/en/datetime.createfromformat.php)正是这样做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T03:45:04.990

您可以[`DateTime`](http://php.net/manual/en/datetime.createfromformat.php)用来帮助您进行解析：

```
$date = DateTime::createFromFormat('Y-m-d-H-i-s', $time);
echo $date->format('M d, Y h:i a'); 
```

# clojure - 我可以在没有 Google Closure 库的情况下编译 ClojureScript 吗？

> ID：16007338
> 
> 赞同：9
> 
> 时间：2013-04-15T03:39:44.527
> 
> 标签：clojure, clojurescript

我是 Clojure 和 ClojureScript 的忠实粉丝，我通常更喜欢在我的项目中使用 ClojureScript 而不是其他替代品，但有时让我无法使用它的一件事，尤其是在较小的项目中，是由 ~80kb 添加的在生成的 javascript 中包含 Google Closure 库，即使我在代码中没有使用 API。

有什么方法可以编译 ClojureScript 来避免这种额外的重量？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-15T14:36:18.923

额外的大小不是来自 Google Closure 库——如果您打开了高级优化，Closure 编译器将从最终的 JavaScript 中删除您未使用的任何 Closure 库代码。相反，JavaScript 看起来很大，因为那里有一个完整的 Clojure 运行时在其中实现诸如惰性序列、承诺和其他一切的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T04:20:11.190

**更正**：正如 Zubair 所指出的，以下步骤禁用了 Google Closure 优化，但不会从最终的 JavaScript 中删除 Google Closure 代码。正如其他答案所建议的那样，您应该选择高级优化来消除未使用的 JavaScript。

* * *

在[ClojureScript: Up and Running](http://shop.oreilly.com/product/0636920025139.do)中，作者解释了如何禁用 Google Closure 步骤：

> 如果`:optimizations`值为`:none`[in `project.clj`]，则根本不会调用 Google Closure Compiler，并且构建将直接写出 ClojureScript 编译器生成的 JavaScript。这种模式对于开发和调试很有用。但是，JavaScript 输出将被拆分到许多单独的文件中，需要在浏览器中进行略微不同的处理 [...]

请注意，这可能会或可能不会减少生成的 JavaScript 的大小，因为 Google Closure 做了相当多的工作来去除您的代码没有专门调用的任何内容。可能值得玩弄`:optimizations`( `:none`、和) 的各种值`:whitespace`，看看每种情况下生成的 JavaScript 有多大。`:simple``:advanced`

# java - 为什么这个 OutOfMemoryError 在被 Future 抛出时没有出现？

> ID：16007345
> 
> 赞同：2
> 
> 时间：2013-04-15T03:40:53.433
> 
> 标签：java, concurrency, out-of-memory

一个简单的场景：

```
private static final ExecutorService executor =
        Executors.newCachedThreadPool();

public static void main(String... args) throws InterruptedException, ExecutionException {
    Future<byte[]> f = null;
    for (int i = 0; i < 10; i++) {
        f = executor.submit(new Callable<byte[]>(){
            @Override
            public byte[] call() {
                System.out.println("Starting task.");
                try {
                    return new byte[1500 * 1024 * 1024];    // 1500 mb
                }
                finally {
                    System.out.println("Task complete.");
                }
            }
        });
    }
//  System.out.println(f.get().length);
} 
```

当我运行上面的代码时，它（据称）运行没有错误。

（奇怪的是，当我在 NetBeans 中分析此代码时会引发*OutOfMemoryError*，但在我正常运行时不会。）

全部 10 个“任务完成”。消息立即显示出来，时间框架太短而无法实际分配字节数组。

当我取消注释最后一行时，会引发*ExecutionException*。

我知道代码示例有点荒谬......但是为什么根本没有抛出异常，我怎样才能让*OutOfMemoryError*出现？我必须抓住它吗？那会是安全的操作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T03:47:20.883

你不应该抓住`Errors`- 他们打算吵闹地让你的程序崩溃。你应该只捕获一个`Exception`if a。你正在记录它/重新扔它或b。你正在处理它；你没有办法处理一个`OutOfMemoryError`，所以让它像它应该的那样让你的程序崩溃。

“任务完成”会在`Future`对象被分配时显示，而不是在它们完成工作时显示 - 您需要调用`f.get()`每个 Future 以确保它已完成分配其字节数组。当您对其进行分析时，程序运行速度较慢，这允许`Futures`在 Main 方法终止之前分配更多的字节数组，这反过来又允许它们用完所有的堆空间。

更改`f`为期货的 ArrayList（和`f = executor.submit`）`f.add(executor.submit)`，然后遍历它并调用它`.get()`的所有期货。这应该在不使用探查器的情况下触发您的 OutOfMemoryError。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:53:16.460

主线程不会自动意识到线程抛出的异常。使用了以前的运行方法，它不会引发异常，您被迫使用 uncaughtexceptionhandler。

JDK1.5 及以后的期货和可调用对象被引入。可调用对象的调用方法会引发异常并返回值。现在要捕获调用方法抛出的异常，您需要调用future.get()。

所以你的代码运行良好。

# prolog - Prolog 搜索列表

> ID：16007350
> 
> 赞同：2
> 
> 时间：2013-04-15T03:41:35.707
> 
> 标签：prolog

在下面的代码中，我正在尝试搜索列表并在列表中有匹配项时打印“匹配”，如果没有匹配项则打印“不匹配”。如果有匹配项，我的代码会打印“匹配”，但是如果没有匹配项，则不打印“不匹配”而是返回 false。如果列表中没有匹配项，如何更改我的代码以打印“不匹配”？谢谢

```
 on(Item,[Item|_], X) :- X is 1.
    on(Item,[_|Tail],X):- on(Item,Tail,X).

    check(X,Y) :- on(X,Y,Z), (Z == 1, write('match');write('no match')). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:05:07.177

您需要添加一个在`on`到达列表末尾时捕获案例的子句：

```
on(_, [], X) :- X is 0. 
```

但是，为了使其工作，您需要`!`在匹配`on`子句中放置一个剪切运算符 , ，这样它就不会继续并找到空列表匹配子句：

```
on(Item,[Item|_], X) :- X is 1, !. 
```

此外，您的打印代码似乎没有按照您的意愿执行，我认为它应该类似于：

```
(Z == 1 -> write('match'); write('no match')). 
```

（注意`->`那里）。我不肯定这是正确的，但我必须对其进行更改以使其在我的身上正常工作。

最后，为了让你的代码看起来更漂亮一点，你可以将`X is 0`and`X is 1`东西放入谓词本身，所以它变成：

```
on(_, [], 0).
on(Item, [Item|_], 1) :- !. 
```

# jquery - 如何在我的 JQuery 可排序的每个项目上添加“替换”按钮

> ID：16007355
> 
> 赞同：0
> 
> 时间：2013-04-15T03:42:19.407
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-button

我想知道如何在我的 JQuery sortable 中的每个项目上放置一个按钮。现在我在屏幕顶部有一个按钮，可以将自动完成中的用户输入添加到可排序中。这是我的 .js 代码，它将新项目添加到我的可排序项中：

```
$(".addButton").click(function(e) {
    e.preventDefault();
    // set var item to be the string inputted by the user
    var item = $("input[name='inputItem']").val(); //where 'inputItem' is the name of the <form> which contains the <input>
    // parses input string, splitting at commas into liArray containing substrings as elements
    var liArray = item.split(", ");
    // for loop to add each brew to the sortable list (length-1 because last element in array is empty string)
    for (var i = 0; i < liArray.length-1; i++) {
        // sets var $li to the string in the ith index of liArray
        var $li = $("<li class='ui-state-default'/>").text(liArray[i]);

        // adds var $li to gui
        $("#sortable").append($li);
    };

    $("#sortable").sort();

    // refreshes the page so var $li shows up
    $("#sortable").sortable("refresh");
}); 
```

我的想法是添加类似

```
<button>Button!</button> 
```

到这一行：

```
var $li = $("<li class='ui-state-default'/>").text(liArray[i]); 
```

但我不知道如何准确地实现它。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:46:24.713

尝试这个。

```
$("<li class='ui-state-default'/>").text(liArray[i]).append('<button>Button!</button>'); 
```

# asp.net - WCF\ASP.NET 互操作性

> ID：16007358
> 
> 赞同：1
> 
> 时间：2013-04-15T03:42:46.477
> 
> 标签：asp.net

我有一个使用异步回调在 WCF 中编写的服务器应用程序，以及一个在 ASP.NET 中的 webforms 应用程序。两个应用程序之间的所有通信都很好，我可以通过 Web 应用程序调用服务器中公开的函数，服务器可以向 Web 应用程序发送回调，但是有时回调中的函数工作，而其他时候，它们不。

例如，我希望 Web 应用程序上的登录按钮向服务器发送用户名和密码，服务器会根据数据库对此进行检查，如果登录信息正确，它应该发送回调，打开一个新页面在网络应用程序中。

这是相关的服务器代码：

```
public void Login(String username, String password)
{
    //DoCheckAgainstDatabase(username, password);

    ICallback callback = OperationContext.Current.GetCallbackChannel<ICallback>();
    callback.LoginSuccess();
} 
```

和网络应用程序代码：

```
private InstanceContext _instanceContext;
private ServiceClient _service;
public CallbackHandler MyCallbackHandler = new CallbackHandler();

protected void Page_Load(object sender, EventArgs e)
{
    _instanceContext = new InstanceContext(MyCallbackHandler);
    _backEnd = new ServiceClient(_instanceContext, "NetTcpBinding_IAU", "net.tcp://localhost/MyService/Service");
    _backEnd.Open();
    MyCallbackHandler.LoginSucceeded += OnLoginSucceeded;
}

protected void LoginButton_Click(object sender, EventArgs e)
{
    _backEnd.Login(UsernameTextBox.Text, PasswordTextBox.Text);
}

private void OnLoginSucceeded(object sender, EventArgs e)
{
    ScriptManager.RegisterStartupScript(this.Page, Page.GetType(), "OpenClientWindow", "window.open('Client.aspx','_self');", true);
} 
```

我可以设置断点，并查看一切正常，只是代码“ScriptManager.RegisterStartupScript...”始终无法正常执行。

这可能与线程有关吗？有人可以提出解决此问题的方法吗？

提前致谢！大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:18:46.017

在我看来，在调用回调之前，您的页面生命周期可能已经结束 - 或者至少进入渲染阶段，这是启动脚本将写入输出的地方。

是否可以同步调用您的服务，并且`LoginButton_Click`在服务调用返回之前不继续？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:03:21.740

我认为你缺少脚本标签 - 用它包装你的 window.oppen，比如

```
 ScriptManager.RegisterStartupScript(this.Page, Page.GetType(), "OpenClientWindow", "<script>window.open('Client.aspx','_self');</script>", true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T11:44:58.490

感谢 Ann L. 对此的指导。我添加了一个 ManualResetEvent，然后在按钮单击方法中，我等到收到回调，然后继续打开新页面：

```
private InstanceContext _instanceContext;
private ServiceClient _service;
public CallbackHandler MyCallbackHandler = new CallbackHandler();
private ManualResetEvent _resetEvent = new ManualResetEvent(false);

protected void Page_Load(object sender, EventArgs e)
{
    _instanceContext = new InstanceContext(MyCallbackHandler);
    _backEnd = new ServiceClient(_instanceContext, "NetTcpBinding_IAU", "net.tcp://localhost/MyService/Service");
    _backEnd.Open();
    MyCallbackHandler.LoginSucceeded += OnLoginSucceeded;
}

protected void LoginButton_Click(object sender, EventArgs e)
{
    _backEnd.Login(UsernameTextBox.Text, PasswordTextBox.Text);
    _resetEvent.WaitOne();

    ScriptManager.RegisterStartupScript(this.Page, Page.GetType(), "OpenClientWindow", "window.open('Client.aspx','_self');", true);
}

private void OnLoginSucceeded(object sender, EventArgs e)
{
    _resetEvent.Set();
} 
```

# javascript - Invalid URL for audio file using URLForResource withExtension

> ID：16007363
> 
> 赞同：0
> 
> 时间：2013-04-15T03:43:38.043
> 
> 标签：javascript, ios, objective-c, trigger.io

My 'play' method works with a test file I put in the Supporting Files folder called "seconds.m4a", but when I [send over the file in the proper format](http://docs.trigger.io/en/v1.4/modules/native/file_objects.html), the URL is said to be invalid.

I have a strong feeling it has something to do with the way I'm creating the URL,

```
NSURL* url = [[NSBundle mainBundle] URLForResource:fileURL withExtension:@"m4a"]; // THIS FORMS THE INVALID URL 
```

PLUGIN CODE:

```
+ (void)play:(ForgeTask*)task {

    // parse the file url from the file object

    ForgeFile* file = [[ForgeFile alloc] initWithFile:[task.params objectForKey:@"file"]];

    NSString* fileURL = [file url]; // eg. "/var/mobile/Applications/AC963D11-88EC-4559-9C2E-68F666AC44D5/Library/Application Support/Forge/assets-6B531B6A-AF26-44FB-BCB1-D036BD4A7293/src/audio/seconds.m4a"

    NSLog(@"Playing file at %@", fileURL);

    NSURL* url = [[NSBundle mainBundle] URLForResource:fileURL withExtension:@"m4a"]; // THIS FORMS THE INVALID URL

    // TESTING - THIS WORKS IN THE FORGEINSPECTOR WHEN UNCOMMENTED

    //url = [[NSBundle mainBundle] URLForResource:@"seconds" withExtension:@"m4a"];

    // END TESTING

    NSAssert(url, @"URL is invalid."); // THIS IS THE ERROR MESSAGE THAT COMES UP

    // create the player

    NSError* error = nil;

    player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];

    if(!player)

    {

        NSLog(@"Error creating player: %@", error);

    };

    [player play];

[task success:nil];

} 
```

CLIENT CODE:

```
forge.file.getLocal('/audio/seconds.m4a', function(file) {

    debug(null, file); // SHOWS THE PROPER FILE: {"uri":"/var/mobile/Applications/AC963D11-88EC-4559-9C2E-68F666AC44D5/Library/Application Support/Forge/assets-6B531B6A-AF26-44FB-BCB1-D036BD4A7293/src/audio/seconds.m4a"}

    forge.internal.call(

        'audio.play',

        {file: file},

        function () { alert('Success!') },

        function (e) { alert('Error: '+e.message)}

    );

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T10:08:57.633

您引用的文件可能不在 中`mainBundle`，所以我绝对不建议使用它！如果您尝试从 NSURL 获取 NSURL `fileURL`，如何：

```
[NSURL URLWithString:fileURL] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T03:53:21.780

```
try this ...

NSString * pFileUrl = [[NSBundle mainBundle] pathForResource:@"seconds" ofType:@"m4a"];

NSURL * pUrl = [NSURL fileURLWithPath:pFileUrl]; 
```

# php - jquery ajax is not passing data properly in this situation

> ID：16007365
> 
> 赞同：0
> 
> 时间：2013-04-15T03:44:05.030
> 
> 标签：php, jquery, ajax

I am creating one website in php. and i am using jquery ajax to pass data from one page to another. and that is general process for all pages.

my javascript function is :

```
function add_data()
{       
  var searchinOn = mainObjectAddForm['available_add_fields'].split(","); 
  var whereOn="{";
  var where = "";
  for (i=0;i<searchinOn.length;i++)
  {
    var keyValue= searchinOn[i];
    where+=getAddData(mainObjectAddForm[keyValue]['name'],mainObjectAddForm[keyValue]['text'],mainObjectAddForm[keyValue]['datatype'],mainObjectAddForm[keyValue]['data'],keyValue)  

  }  

  whereOn+= where.substring(0,where.length-1)+"}";

  $.ajax({
    type:'POST',
    data:whereOn,
    url:siteurl + "add/",
     dataType:'json',
    success:function(data)
    {
    }
  });
 }

 function getAddData(name,text,datatype,data,keyValue)
 {  

 var control="";
 var value1="";
 var value2="";
switch(datatype)
{
    case "text":                         
        control +=  "'"+name+"':'"+trim($('#add_form #'+name).val())+"'";
        break;
    case "password":
        control +=  "'"+name+"':'"+trim($('#add_form #'+name).val())+"'";           
        break;      
    case "label":
        control +=  "'"+name+"':'"+trim($('#add_form #'+name).val())+"'";           
        break;          
    case "textarea":
        control +=  "'"+name+"':'"+trim($('#add_form #'+name).val())+"'";           
        break;
}
if (trim(control)=="") return "";
else return control + ",";
} 
```

but on php page i am not getting all values. Its coming as one string in post variable.

like

```
 [{'field1':'abc','field2':'pqr','field3':'xyz'}] => 
```

but i want like this :

```
Array
{
[field1] => abc
[field2] => pqr
[field3] => xyz
} 
```

and i know the problem that the problem is the ajax data is passing as one string because the '{' and '}' are in whereOn string. but if i add that in ajax call than also its same problem.

can anyone help me to solve it ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:11:04.723

几个建议：

1.  ***永远不要***手动构建 JSON。你有一个很好的`JSON.stringify(..)`功能，所有现代浏览器都支持。
2.  您在 POST 正文中发送原始 JSON。为什么不设置标题`Content-Type: application/json`？
3.  POST 正文**不是**百分位数编码的。`$_POST`所以使用数组没有意义。您需要做的是通读整个 POST 正文`file_get_contents('php://input')`以获取 JSON-String。然后您可以使用`json_decode(..)`将其转换为可以以通常方式使用的 PHP 对象。

    ```
    $postBody = file_get_contents('php://input');
    var_dump($postBody);
    $jsonObj = json_decode($postBody);
    var_dump(jsonObj); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:10:56.817

如果您尝试手动构建 json，请查看[http://json.org](http://json.org)。我建议不要这样做，并为此使用 json 。
而是使用 application/x-www-form-urlencoded （键/值对）

```
function add_data()
{       
  var searchinOn = mainObjectAddForm['available_add_fields'].split(","); 
  var whereOn={};
  var where = "";
  for (i=0;i<searchinOn.length;i++)
  {
    var keyValue= searchinOn[i];
    getAddData(mainObjectAddForm[keyValue]['name'],mainObjectAddForm[keyValue]['text'],mainObjectAddForm[keyValue]['datatype'],mainObjectAddForm[keyValue]['data'],keyValue,whereOn)  

  }  

  $.ajax({
    type:'POST',
    data:whereOn,
    url:siteurl + "add/",
     dataType:'json',
    success:function(data)
    {
    }
  });
 }

function getAddData(name,text,datatype,data,keyValue,whereOn)
{  
 switch(datatype)
 {
    case "text":                         
        whereOn[name] = trim($('#add_form #'+name).val());
        break;
    case "password":
        whereOn[name] = trim($('#add_form #'+name).val());           
        break;      
    case "label":
        whereOn[name] = trim($('#add_form #'+name).val());           
        break;          
    case "textarea":
        whereOn[name] = trim($('#add_form #'+name).val());           
        break;
 }

} 
```

# arrays - What is the immutable version to de/reference array?

> ID：16007368
> 
> 赞同：0
> 
> 时间：2013-04-15T03:44:19.803
> 
> 标签：arrays, reference, f#, mutable, dereference

How to de/reference the 3 array variables in this code instead of using mutable values?

The code below computes the Longest common subsequence (LCS) by diagonal traversing the m*n array.

The arguments are 2 char arrays like so:

So LCS method should result to length 4 as the longest common sub-sequence chars are "acbb" & "bcbb".

```
let private s1 = "ABCDBB".ToCharArray()    
let private s2 = "CBACBAABA".ToCharArray()
    let public lcs_seq_1d_diags (x:char[]) (y:char[]) = 
        let m = x.Length
        let n = y.Length

        let mutable dk2 = Array.create (1+m) 0
        //printfn "\r\n0: %A" dk2
        let mutable dk1 = Array.create (1+m) 0
        //printfn "1: %A" dk1
        let mutable dk = Array.create (1+m) 0

        for k = 2 to m+n do
            let low = max 1 (k-m)
            let high = min (k-1) n

            for j = low to high do
                let i = k - j
                if x.[i-1] = y.[j-1] then
                    dk.[i] <- dk2.[i-1] + 1
                else 
                    dk.[i] <- max dk1.[i] dk1.[i-1]

            let mutable temp = dk2
            dk2 <- dk1
            dk1 <- dk
            dk <- temp

        dk1.[m]

let private res_seq_1d_rows = duration (fun () -> lcs_seq_1d_rows s1 s2)
//res_seq_1d_rows = 4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T12:23:43.620

默认情况下，数组是可变的。如果您想要不变性，请尝试使用列表。

尝试从这个开始：

```
let s1 = List.ofSeq "ABCDBB"
let s2 = List.ofSeq "CBACBAABA" 
```

剩下的我留给读者练习:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:41:35.857

查看参考单元格[http://msdn.microsoft.com/en-us/library/dd233186.aspx](http://msdn.microsoft.com/en-us/library/dd233186.aspx)

语法如下所示：

```
let a = ref 1 // declaring a reference
a := 2 // changing the reference value
printfn "%i" !a // dereferencing 
```

这可能也很有趣：[F#: let mutable vs. ref](https://stackoverflow.com/questions/3221200/f-let-mutable-vs-ref)

# ruby-on-rails - 试图在模块中包含 Rails 帮助程序库

> ID：16007369
> 
> 赞同：3
> 
> 时间：2013-04-15T03:44:24.217
> 
> 标签：ruby-on-rails, ruby, module, include, require

我有一个名为的模块`Sms`，我在`lib/sms.rb`. 在其中，我有一个`Sms.chunk`使用 method 的方法`word_wrap`。这是 TextHelper 库的一部分，因此我将它包含在模块的开头`include ActionView::Helpers::TextHelper`：

```
module Sms
  include ActionView::Helpers::TextHelper

  def Sms.chunk
  ...
  word_wrap
  ... 
```

我在初始化过程中需要这个`require "sms"`模块`config/initializers/additional_libs.rb`

我还有一个名为 TWILIO_API 的 Grape API 类，我想在其中调用`Sms.chunk`. 但是，当我这样做时，我会得到`undefined method`Sms:Module 的 word_wrap'。我尝试在 TWILIO_API 类本身中包含 TextHelper 库，以及包含它的各种其他方式，但没有成功。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T05:29:19.243

问题是[wrap_word](https://github.com/rails/rails/blob/c5205041f65206a1490063b08915e7b2a2151a61/actionpack/lib/action_view/helpers/text_helper.rb#L223)是一个`instance method`，并且您是从类方法调用它`Sms.chunk`。通过删除部件使其成为实例方法`Sms.`。例如，以下工作：

```
require 'action_view'
class Test
  include ActionView::Helpers::TextHelper
  def test_method
    word_wrap('Once upon a time')
  end
end
o = Test.new
p o.test_method # "Once upon a time" 
```

# ruby-on-rails - 在继承模型中跳过回调

> ID：16007370
> 
> 赞同：4
> 
> 时间：2013-04-15T03:44:24.900
> 
> 标签：ruby-on-rails, callback, abstract-class

是否有类似`ActionController::Base#skip_before_filter`ActiveRecord 回调的方法`after_create`？我有一些行为相似的类，为了减少代码重复，我创建了一个抽象类。抽象包含关系信息、验证和`after_create`创建新消息的回调。`Message`实现了这个抽象，所以保存消息会导致堆栈溢出。

我可以从模型中删除回调吗？

```
class Parent < ActiveRecord::Base
    self.abstract_class = true
    after_create :notify

    def notify
        Message.create
    end
end

class Message < Parent
    # skip after_create :notify
end

class Child < Parent
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T04:00:59.330

```
class Message < Parent
  skip_callback :create, :after, :notify
end 
```

查看[Rails 文档](http://api.rubyonrails.org/classes/ActiveSupport/Callbacks/ClassMethods.html#method-i-skip_callback)了解详细信息

# excel - How do I parse text in excel?

> ID：16007374
> 
> 赞同：-1
> 
> 时间：2013-04-15T03:45:28.007
> 
> 标签：excel, excel-2013

If my selected fields contain the word "xxx" or "yyy", I want to change those fields to show only those words. If a field doesn't contain either, I want to delete the info in that field.

How can this be done in excel?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:36:48.327

我想你可能想在这里使用 IF 表达式。

例如：

`=IF(OR(A1="xxx",A1="yyy"),A1,"no")`

如果在 A 列中，您将 xxx、yyy、zzz 分别放在各自的行中。然后在 B 列中放置此公式并将其复制到 B3 行，您应该会发现如果单元格中存在“xxx”或“yyy”，则显示该值，否则显示“否”。您可以将公式中的 no 更改为空字符串`""`以获得删除内容的效果。

有关 Excel IF 表达式的进一步阅读，请参阅[http://www.techonthenet.com/excel/formulas/if.php](http://www.techonthenet.com/excel/formulas/if.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:57:32.303

您将用于确定单元格是否“包含”xxx 或 yyy 的工作表公式，然后执行您请求的操作将是：

```
=IF(NOT(ISERROR(FIND("xxx",A1))),"xxx",IF(NOT(ISERROR(FIND("yyy",A1))),"yyy","")) 
```

但是我想指出，在这种情况下，如果单元格值为“abcyyydefxxx”，“xxx”将覆盖“yyy”......结果将是“xxx”。

如果一个单元格有可能包含您的两个字符串，我将修改公式以适应它。

现在，公式中的 A1 指向您正在检查的单元格。

# ruby-on-rails - 按名称和整数排列祖先兄弟姐妹

> ID：16007384
> 
> 赞同：0
> 
> 时间：2013-04-15T03:47:15.397
> 
> 标签：ruby-on-rails, mongoid, ancestry

我有一个名为 的模型，我可以通过调用or`Category`找到我当前类别的兄弟姐妹，但是一旦我尝试对这些请求中的任何一个进行排序，我就会得到方法错误。`@category.parent.siblings``Category.siblings_of(params[:id])`

如果我打电话`Category.where(:parent_id => @category.parent.id)`什么都没有出现，但我没有收到任何错误。

如果我打电话`Category.siblings_of(params[:id]).sort('name')`，我会得到错误：

```
undefined method `to_direction' for nil:NilClass 
```

如果我打电话给`Category.siblings_of(params[:id]).arrange(:order => 'name')`它说：

```
undefined method `name' for #<Array:0x007fb00de57b70>
Extracted source (around line #21):

18:                 %i.icon-plus
19:         %li.nav-header a neighbour of:
20:         - for neighbour in @siblings
21:             %li= link_to neighbour.name, neighbour, :remote => true 
```

只要我根本不对结果进行排序，我就可以让它正常工作，但我真的很想知道为什么对结果进行排序会搞砸一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T05:13:03.883

`where`如果不查看模型中的内容，很难知道您的查询出了什么问题。但排序可能是因为你没有尝试正确的方法。使用 mongoid 进行排序的正常方法如下所示：

```
Category.siblings_of(params[:id]).order_by(name: :asc) 
```

或者查看[文档](http://mongoid.org/en/origin/docs/options.html#sorting)以获取更多语法选项。

# asp.net - UpdatePanel 中的按钮未触发 Click 事件：RequiredFieldValidator 原因

> ID：16007390
> 
> 赞同：0
> 
> 时间：2013-04-15T03:48:25.860
> 
> 标签：asp.net, ajax, telerik

我正在处理一个由 Telerik RadToolTip、一个包含按钮的 UpdatePanel 和一些用户控件组成的页面。还有一个 Master Page，就是 ScriptManager 所在的地方。

以前，我在 Master Page 和 RadAjaxProxyManager 上有一个 RadAjaxManager。由于用户控件中的复杂性，我删除了它们并开始实施标准更新面板。

但是，现在我似乎无法让此页面的任何内容按预期运行。当我在 UpdatePanel 中放置一个 Button 时，我期望一个 Partial Postback 并且我期望 Button 的 OnClick 事件被触发。但是，当我在 btnPostBack_Click 事件代码中使用断点运行此代码时，断点永远不会被命中。

如果我将具有相同设置的相同控件剪切并粘贴到一个新项目中，就会遇到断点。站点环境中是否有某些东西，或者 Telerik 是否会干扰 Button 的 Click 事件？我已经删除了所有 RadAjaxManager/Proxies。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/AV.Master" AutoEventWireup="true"
    CodeBehind="AssetView.aspx.cs" Inherits="AV_ASP_UI.AssetPages.AssetView" %>

<%@ Register Assembly="Telerik.Web.UI" Namespace="Telerik.Web.UI" TagPrefix="telerik" %>
<%@ Register TagPrefix="uc" TagName="AssetDiagram" Src="~/Controls/AssetDiagram.ascx" %>
<%@ Register TagPrefix="uc" TagName="AssetInfo" Src="~/Controls/AssetInfo.ascx" %>

<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
    <script type="text/javascript">

        function DoPartialPostBack(command, id) {
            document.getElementById("<%= hfldId.ClientID %>").value = id;
            document.getElementById("<%= btnPostBack.ClientID %>").click();
        }

    </script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <asp:HiddenField ID="hfldId" runat="server" />

    <telerik:RadToolTip ID="RadToolTip1" runat="server" Modal="true" ShowEvent="FromCode"
        Position="Center" RelativeTo="BrowserWindow" HideEvent="FromCode" TargetControlID="hfldFireToolTip">        
    </telerik:RadToolTip>

    <asp:UpdatePanel ID="UpdatePanel1" runat="server" >
        <ContentTemplate>
           <asp:Button ID="btnPostBack" runat="server" Text="Button" style="visibility: hidden" OnClick="btnPostBack_Click"/>
        </ContentTemplate>
    </asp:UpdatePanel>

    <asp:Panel ID="pnlWorkArea" CssClass="pnlWorkArea" runat="server" Height="770px" onMouseDown="hideSVGTtip(event);">
        <uc:AssetDiagram ID="ucAssetDiagram" runat="server" CanvasHeight="720" CanvasWidth="276" />
        <uc:AssetInfo ID="ucAssetInfo" runat="server"/>
    </asp:Panel>
 </asp:Content> 
```

# heroku - DreamHost 到 Heroku 的域设置

> ID：16007397
> 
> 赞同：1
> 
> 时间：2013-04-15T03:49:13.777
> 
> 标签：heroku, dreamhost, nameservers

我正在将我的 Rails 应用程序从 DreamHost 转移到 Heroku。名称服务器仍在 DreamHost 上。

这是我的设置方式：

```
www.mydomain.com: CNAME to mydomain.herokuapp.com
mydomain.com redirected to www.mydomain.com 
```

这类作品。

但是 mydomain.com/admin 不起作用。我必须去 www.mydomain.com/admin。

如何使 mydomain.com/admin 工作？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T11:47:32.310

`mydomain.com`转发是否`www.mydomain.com`正确？然后`mydomain.com/admin`不会工作，一切都`mydomain.com`被转发。

如果您想要这种行为，那么您需要在 DNS 中删除您的转发，并在应用程序级别执行这种重定向（或不执行）。

# android - Android Google Mapv2 空指针异常

> ID：16007399
> 
> 赞同：0
> 
> 时间：2013-04-15T03:49:23.263
> 
> 标签：android, android-fragments, android-tabhost, android-maps-v2, supportmapfragment

我在我的应用程序中使用谷歌地图 v2，但是当我尝试`SupportMapFragment`使用`onActivityCreated()`这种方法创建一个对象时没有被调用有人请帮助我这是我的代码，

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        super.onCreateView(inflater, container, savedInstanceState);
        Log.d("err", "onCreateView");
        view = inflater
                .inflate(R.layout.todays_deal_location, container, false);
    mFragment = new SupportMapFragment() {
                 @Override
                 public void onActivityCreated(Bundle savedInstanceState) {
                 super.onActivityCreated(savedInstanceState);
                 Log.d("err", "onActivityCreated");
                 GoogleMap map = mFragment.getMap();
                 }
                 };
       return view;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T13:43:43.393

这是将 SupportMapFragment 正确添加到您的片段的方法：

[http://code.google.com/p/gmaps-api-issues/issues/detail?id=5064#c1](http://code.google.com/p/gmaps-api-issues/issues/detail?id=5064#c1)

笔记：

1.  R.layout.layout_with_map 不包含片段
2.  使用 getChildFragmentManager()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:41:17.453

`Fragments`你应该知道` `onCreateView()`Fragments `onActivityCreated()`.

**onCreateView():**

在这里，我们膨胀布局或简单地创建视图，如果您必须做任何引用 Activity 的事情，请不要这样做，例如创建对话框、访问 Activity 视图等，因为这个地方不能确保托管 Activity 完全功能性的

**onActivityCreated():**

这个方法位置表示我们的托管 Activity 视图已创建并且托管 Activity 是功能性的，这是执行所有与 Activity 相关的任务的正确位置。

`onActivityCreated()`当片段的活动被创建**并且这个片段的视图层次被实例化时调用。一旦这些部分到位，它就可以用来进行最终初始化，例如检索视图或恢复状态。**它对于使用 setRetainInstance(boolean) 来保留其实例的片段也很有用，因为此回调会告诉片段何时与新的活动实例完全关联。这在 onCreateView(LayoutInflater, ViewGroup, Bundle) 之后和 onStart() 之前调用。

# android - Android - 在 Facebook 等通知栏中使用外部个人资料图片

> ID：16007401
> 
> 赞同：21
> 
> 时间：2013-04-15T03:50:01.087
> 
> 标签：android, android-layout, push-notification, android-notifications

我知道您可以在消息、标题、图像 URL 等推送通知参数中发送信息。Facebook 如何在通知区域中显示您的个人资料图片和您的消息？我想在通知区域中使用外部图像，因此当您将其拉下时，您会看到带有消息的个人资料图像。现在，我的只是显示可绘制文件夹中的默认图标。我认为这可能是一个常见问题，但找不到任何东西。你能帮忙的话，我会很高兴。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-15T04:30:15.983

该语句将使用一种方法将 URL（自然地，指向图像的 URL）转换为`Bitmap`.

```
Bitmap bitmap = getBitmapFromURL("https://graph.facebook.com/YOUR_USER_ID/picture?type=large"); 
```

**注意：**由于您提到了 Facebook 个人资料，因此我提供了一个 URL，该 URL 可以获取您的 Facebook 用户的大尺寸个人资料图片。但是，您可以将其更改为指向您需要在`Notification`.

以及从您在上述语句中指定的 URL 获取图像的方法：

```
public Bitmap getBitmapFromURL(String strURL) {
    try {
        URL url = new URL(strURL);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setDoInput(true);
        connection.connect();
        InputStream input = connection.getInputStream();
        Bitmap myBitmap = BitmapFactory.decodeStream(input);
        return myBitmap;
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
} 
```

现在将`bitmap`上面创建的实例传递给`Notification.Builder`实例。我**`builder`**在这个示例代码中调用它。它用于此行：`builder.setLargeIcon(bitmap);`. 我假设您知道如何显示实际`Notification`及其配置。因此，我将跳过该部分并仅添加*builder*。

```
// CONSTRUCT THE NOTIFICATION DETAILS
builder.setAutoCancel(true);
builder.setSmallIcon(R.drawable.ic_launcher);
builder.setContentTitle("Some Title");
builder.setContentText("Some Content Text");
builder.setLargeIcon(bitmap);
builder.setContentIntent(pendingIntent); 
```

哦，差点忘了，如果你还没有这样做，你需要在 Manifest 中设置这个权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-15T05:38:39.627

![在此处输入图像描述](https://i.stack.imgur.com/gas5O.png)

## 首先使用以下代码下载图像：

```
private Bitmap getBitmap(String url)
    {
        File f=fileCache.getFile(url);

        //from SD cache
        Bitmap b = decodeFile(f);
        if(b!=null)
            return b;

        //from web
        try {
            Bitmap bitmap=null;
            URL imageUrl = new URL(url);
            HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
            conn.setConnectTimeout(30000);
            conn.setReadTimeout(30000);
            conn.setInstanceFollowRedirects(true);
            InputStream is=conn.getInputStream();
            OutputStream os = new FileOutputStream(f);
            Utils.CopyStream(is, os);
            os.close();
            bitmap = decodeFile(f);
            return bitmap;
        } catch (Exception ex){
           ex.printStackTrace();
           return null;
        }
    }

    //decodes image and scales it to reduce memory consumption
    private Bitmap decodeFile(File f){
        try {
            //decode image size
            BitmapFactory.Options o = new BitmapFactory.Options();
            o.inJustDecodeBounds = true;
            BitmapFactory.decodeStream(new FileInputStream(f),null,o);

            //Find the correct scale value. It should be the power of 2.
            final int REQUIRED_SIZE=70;
            int width_tmp=o.outWidth, height_tmp=o.outHeight;
            int scale=1;
            while(true){
                if(width_tmp/2<REQUIRED_SIZE || height_tmp/2<REQUIRED_SIZE)
                    break;
                width_tmp/=2;
                height_tmp/=2;
                scale*=2;
            }

            //decode with inSampleSize
            BitmapFactory.Options o2 = new BitmapFactory.Options();
            o2.inSampleSize=scale;
            return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
        } catch (FileNotFoundException e) {}
        return null;
    } 
```

## 在下面的代码中使用该图像作为位图：

```
Bitmap icon1 = downloadedBitmap;

            NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(
                    this).setAutoCancel(true)
                    .setContentTitle("DJ-Android notification")
                    .setSmallIcon(R.drawable.ic_launcher)
                    .setContentText("Hello World!");

            NotificationCompat.BigPictureStyle bigPicStyle = new NotificationCompat.BigPictureStyle();
            bigPicStyle.bigPicture(icon1);
            bigPicStyle.setBigContentTitle("Dhaval Sodha Parmar");
            mBuilder.setStyle(bigPicStyle);

            // Creates an explicit intent for an Activity in your app
            Intent resultIntent = new Intent(this, testActivity.class);

            // The stack builder object will contain an artificial back stack
            // for
            // the
            // started Activity.
            // This ensures that navigating backward from the Activity leads out
            // of
            // your application to the Home screen.
            TaskStackBuilder stackBuilder = TaskStackBuilder.create(this);

            // Adds the back stack for the Intent (but not the Intent itself)
            stackBuilder.addParentStack(testActivity.class);

            // Adds the Intent that starts the Activity to the top of the stack
            stackBuilder.addNextIntent(resultIntent);
            PendingIntent resultPendingIntent = stackBuilder.getPendingIntent(
                    0, PendingIntent.FLAG_UPDATE_CURRENT);
            mBuilder.setContentIntent(resultPendingIntent);

            NotificationManager mNotificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);

            // mId allows you to update the notification later on.
            mNotificationManager.notify(100, mBuilder.build()); 
```

## 我知道你不知道关于 android 权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

有关更多详细信息，请查看此[artical](http://dj-android.blogspot.in/2013/04/android-notifications-3-applying-big.html)和[android 开发人员](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-11T01:40:31.717

我使用[通用图像加载器](https://github.com/nostra13/Android-Universal-Image-Loader)来解决这个问题。查看 wiki 以了解如何设置它。实例化一次后，这是我在 GCM 侦听器中用于下载和显示图像的代码。我下载位图，然后在通知中设置它：

```
// Download profile picture of the user with Universal Image Loader
Bitmap bitmap =  ImageLoader.getInstance().loadImageSync(profilePhotoUrl);

intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
PendingIntent pendingIntent = PendingIntent.getActivity(this, 0 /* Request code */, intent,
        PendingIntent.FLAG_ONE_SHOT);

Uri defaultSoundUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.ic_my_app)
        .setLargeIcon(bitmap) // This is the image displayed on the lock screen
        .setContentTitle("My App")
        .setContentText(message)
        .setAutoCancel(true)
        .setSound(defaultSoundUri)
        .setContentIntent(pendingIntent); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-08T06:57:15.370

由于图像是从互联网加载的，它应该在后台线程中**异步完成。您可以使用 (1) 异步任务或 (2) Glide（用于有效的图像加载）。**

要加载图像通知，您需要使用“ **NotificationCompat.BigPictureStyle()** ”。这需要一个**位图**（必须从图像 url 中提取）

**Glide**的大部分 API 和方法现在都被弃用了。以下适用于 Glide 4.9 和 Android 10。

**第 1 步：从后台线程上的图像 url 加载位图**

```
 private void getBitmapAsyncAndDoWork(String imageUrl) {

            final Bitmap[] bitmap = {null};

            Glide.with(getApplicationContext())
                    .asBitmap()
                    .load(imageUrl)
                    .into(new CustomTarget<Bitmap>() {
                        @Override
                        public void onResourceReady(@NonNull Bitmap resource, @Nullable Transition<? super Bitmap> transition) {

                            bitmap[0] = resource;
                            // TODO Do some work: Load image notification from here
                            displayImageNotification(bitmap[0]);
                        }

                        @Override
                        public void onLoadCleared(@Nullable Drawable placeholder) {
                        }
                    });
        } 
```

**步骤2：显示一次图像通知，位图准备就绪。**

```
private void displayImageNotification(Bitmap bitmap) {

      NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext(), getChannelId());
            builder
                    .setContentTitle(title)
                    .setContentText(subtext)
                    .setDefaults(Notification.DEFAULT_LIGHTS | Notification.DEFAULT_VIBRATE)
                    .setSmallIcon(SMALL_ICON)
                    .setPriority(NotificationCompat.PRIORITY_DEFAULT)
                    .setColor(getApplicationContext().getColor(color))
                    .setAutoCancel(true)
                    .setOngoing(false)
                    .setOnlyAlertOnce(true)
                    .setContentIntent(pendingIntent)
                     .setStyle(
                     new NotificationCompat.BigPictureStyle().bigPicture(bitmap))
                    .setPriority(Notification.PRIORITY_HIGH);

        getManager().notify(tag, id, builder.build());
} 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-02-03T08:48:52.177

```
Notification notif = new Notification.Builder(context)
     .setContentTitle("Title")
     .setContentText("content")
     .setSmallIcon(R.drawable.ic_small)
     .setLargeIcon(bitmap)
     .setStyle(new Notification.BigPictureStyle()
         .bigPicture(bigBitmap)
         .setBigContentTitle("big title"))
     .build(); 
```

# python - 将二进制数据视为文件对象？

> ID：16007412
> 
> 赞同：25
> 
> 时间：2013-04-15T03:51:35.770
> 
> 标签：python, file-io

在这个代码片段（由另一个人创作）中，`self.archive`是一个大文件的路径，并且`raw_file`是作为二进制数据读取的文件内容。

```
with open(self.archive, "rb") as f:
    f.seek(offset)
    raw_file = start + f.read(dlen - len(start))
    ...
    f.write(raw_file) 
```

这个存档文件包含存储的图像文件，我想访问它们`pygame.image.load`，这需要一个 File 对象。但我需要做一些类似的事情`pygame.image.load(toVirtualFileObject(raw_file))`（即访问这个存档文件的内容作为文件对象而不先写入磁盘）。

这可以做到吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-15T03:59:08.627

这就是[`StringIO`](http://docs.python.org/2/library/stringio.html)（在 Python 2 中）和[`io.BytesIO`](http://docs.python.org/3/library/io.html#io.BytesIO)（在 Python 3 中）的用途。

# javascript - AngularJS在http之前修改数据

> ID：16007419
> 
> 赞同：1
> 
> 时间：2013-04-15T03:53:06.153
> 
> 标签：javascript, angularjs

我使用这个脚本作为我的起点：http: [//jsfiddle.net/EJGHX/](http://jsfiddle.net/EJGHX/) 我已经修改它以从数据库构建一个列表，但我无法以服务器可以读取的格式将其发送回。

这是我的代码：

**JS**

```
var app = angular.module('app', []);

app.config(function ($routeProvider) {
    $routeProvider.when('/article/:slug', {
        templateUrl: '/university_assets/partials/admin/content.html',
        controller: 'TreeController'
    })
        .when('/', {
        templateUrl: '/university_assets/partials/home.html'
    })
        .when('/add', {
        templateUrl: '/university_assets/partials/admin/addContent.html'
    })
        .otherwise({
        templateUrl: '/university_assets/partials/404.html'
    });
});

app.directive('yaTree', function () {

    return {
        restrict: 'A',
        transclude: 'element',
        priority: 1000,
        terminal: true,
        compile: function (tElement, tAttrs, transclude) {

            var repeatExpr, childExpr, rootExpr, childrenExpr;

            repeatExpr = tAttrs.yaTree.match(/^(.*) in ((?:.*\.)?(.*)) at (.*)$/);
            childExpr = repeatExpr[1];
            rootExpr = repeatExpr[2];
            childrenExpr = repeatExpr[3];
            branchExpr = repeatExpr[4];

            return function link(scope, element, attrs) {

                var rootElement = element[0].parentNode,
                    cache = [];

                // Reverse lookup object to avoid re-rendering elements
                function lookup(child) {
                    var i = cache.length;
                    while (i--) {
                        if (cache[i].scope[childExpr] === child) {
                            return cache.splice(i, 1)[0];
                        }
                    }
                }

                scope.$watch(rootExpr, function (root) {

                    var currentCache = [];

                    // Recurse the data structure
                    (function walk(children, parentNode, parentScope, depth) {

                        var i = 0,
                            n = children.length,
                            last = n - 1,
                            cursor,
                            child,
                            cached,
                            childScope,
                            grandchildren;

                        // Iterate the children at the current level
                        for (; i < n; ++i) {

                            // We will compare the cached element to the element in 
                            // at the destination index. If it does not match, then 
                            // the cached element is being moved into this position.
                            cursor = parentNode.childNodes[i];

                            child = children[i];

                            // See if this child has been previously rendered
                            // using a reverse lookup by object reference
                            cached = lookup(child);

                            // If the parentScope no longer matches, we've moved.
                            // We'll have to transclude again so that scopes 
                            // and controllers are properly inherited
                            if (cached && cached.parentScope !== parentScope) {
                                cache.push(cached);
                                cached = null;
                            }

                            // If it has not, render a new element and prepare its scope
                            // We also cache a reference to its branch node which will
                            // be used as the parentNode in the next level of recursion
                            if (!cached) {
                                transclude(parentScope.$new(), function (clone, childScope) {

                                    childScope[childExpr] = child;

                                    cached = {
                                        scope: childScope,
                                        parentScope: parentScope,
                                        element: clone[0],
                                        branch: clone.find(branchExpr)[0]
                                    };

                                    // This had to happen during transclusion so inherited 
                                    // controllers, among other things, work properly
                                    parentNode.insertBefore(cached.element, cursor);

                                });
                            } else if (cached.element !== cursor) {
                                parentNode.insertBefore(cached.element, cursor);
                            }

                            // Lets's set some scope values
                            childScope = cached.scope;

                            // Store the current depth on the scope in case you want 
                            // to use it (for good or evil, no judgment).
                            childScope.$depth = depth;

                            // Emulate some ng-repeat values
                            childScope.$index = i;
                            childScope.$first = (i === 0);
                            childScope.$last = (i === last);
                            childScope.$middle = !(childScope.$first || childScope.$last);

                            // Push the object onto the new cache which will replace
                            // the old cache at the end of the walk.
                            currentCache.push(cached);

                            // If the child has children of its own, recurse 'em.             
                            grandchildren = child[childrenExpr];
                            if (grandchildren && grandchildren.length) {
                                walk(grandchildren, cached.branch, childScope, depth + 1);
                            }
                        }
                    })(root, rootElement, scope, 0);

                    // Cleanup objects which have been removed.
                    // Remove DOM elements and destroy scopes to prevent memory leaks.
                    i = cache.length;

                    while (i--) {
                        cached = cache[i];
                        if (cached.scope) {
                            cached.scope.$destroy();
                        }
                        if (cached.element) {
                            cached.element.parentNode.removeChild(cached.element);
                        }
                    }

                    // Replace previous cache.
                    cache = currentCache;

                }, true);
            };
        }
    };
});

app.controller('TreeController', function ($rootScope, $scope, $timeout, $http, $location) {

    $scope.data = {
        children: [{
            text: '',
            children: []
        }]
    };
    $http.get('/university/list').success(function (data) {
        var myArr = data;
        for (var i = 0; i < myArr.length; i++) {
            myArr[i].children = [];
            for (var q = 0; q < myArr.length; q++) {
                if (myArr[i].id == myArr[q].parentid) {
                    var temp = {
                        id: myArr[q].id,
                        text: myArr[q].text,
                        index: myArr[q].index
                    };
                    myArr[i].children.push(temp);
                };
            };

        };
        $scope.data = ({
            children: myArr
        });
    });
    $scope.index = function (i, child) {
        child.index = i;
    }

    $http.get('/university' + $location.path()).success(function (data) {
        $rootScope.pageContent = data[0];
        $rootScope.page = $scope.pageContent;
    });
    $scope.edit = function (child) {
        $http.get('/university/article/' + child.id).success(function (data) {
            $rootScope.pageContent = data[0];
            $rootScope.page = $scope.pageContent;
        });
        $location.path('/article/' + child.id);
        $("#article").attr("action", "/admin/updateArticle");
        $('.admin-actions button').text(' Update ');
    };
    $scope.toggleMinimized = function (child) {
        child.minimized = !child.minimized;
    };

    $scope.addChild = function (child) {
        child.children.push({
            title: '',
            children: []
        });
    };

    $scope.remove = function (child) {
        function walk(target) {
            var children = target.children,
                i;
            if (children) {
                i = children.length;
                while (i--) {
                    if (children[i] === child) {
                        return children.splice(i, 1);
                    } else {
                        walk(children[i])
                    }
                }
            }
        }
        walk($scope.data);
    }

    $scope.update = function (event, ui) {
        var root = event.target,
            item = ui.item,
            parent = item.parent(),
            target = (parent[0] === root) ? $scope.data : parent.scope().child,
            child = item.scope().child,
            index = item.index();

        target.children || (target.children = []);

        function walk(target, child) {
            var children = target.children,
                i;
            if (children) {
                i = children.length;
                while (i--) {
                    if (children[i] === child) {
                        return children.splice(i, 1);
                    } else {
                        walk(children[i], child);
                    }
                }
            }
        }
        walk($scope.data, child);

        target.children.splice(index, 0, child);

            var graph = $scope.data.children;
            console.log(graph);
            var i, l,
            nodes=[],
            visited=[];

            function clone(n) {
             // improve the function yourself I'm lazy
             return {
                "id": n.id,
                "parentid": n.parentid,
                "text": n.text,
                "index": n.index
             };
            }

            function helper (node) {
                var i, limit;
                if (visited.indexOf(node.id) == -1) {
                  visited.push(node.id);
                  nodes.push(clone(node));
                  if( node.children)
                  for (i=0, limit = node.children.length; i< limit; i++) {
                    helper(node.children[i]);
                  }
                }
            }

            for (i=0, l = graph.length; i< l; i++) {
                helper(graph[i]);
            }

            nodes = JSON.stringify(nodes);
            $http.post('/admin/sort/', nodes).success(function () {});        
    };

});

app.directive('uiNestedSortable', ['$parse', function ($parse) {

    'use strict';

    var eventTypes = 'Create Start Sort Change BeforeStop Stop Update Receive Remove Over Out Activate Deactivate'.split(' ');

    return {
        restrict: 'A',
        link: function (scope, element, attrs) {

            var options = attrs.uiNestedSortable ? $parse(attrs.uiNestedSortable)() : {};

            angular.forEach(eventTypes, function (eventType) {

                var attr = attrs['uiNestedSortable' + eventType],
                    callback;

                if (attr) {
                    callback = $parse(attr);
                    options[eventType.charAt(0).toLowerCase() + eventType.substr(1)] = function (event, ui) {
                        scope.$apply(function () {

                            callback(scope, {
                                $event: event,
                                $ui: ui
                            });
                        });
                    };
                }

            });

            element.nestedSortable(options);

        }
    };
}]); 
```

除了一些添加的 $http 请求和这个之外，它基本上是相同的：

```
 var graph = data.children;
    console.log(graph);
    var i, l,
    nodes=[],
    visited=[];

    function clone(n) {
     // improve the function yourself I'm lazy
     return {
        "id": n.id,
        "parentid": n.parentid,
        "text": n.text,
        "index": n.index
     };
    }

    function helper (node) {
        var i, limit;
        if (visited.indexOf(node.id) == -1) {
          visited.push(node.id);
          nodes.push(clone(node));
          if( node.children)
          for (i=0, limit = node.children.length; i< limit; i++) {
            helper(node.children[i]);
          }
        }
    }

    for (i=0, l = graph.length; i< l; i++) {
        helper(graph[i]);
    }

    nodes = JSON.stringify(nodes);
    $http.post('/admin/sort/', nodes).success(function () {}); 
```

我需要在更新功能运行后运行它。这会展平我的 $scope.data 数组并将其发送到服务器。

**我的问题是..**如果我把上面的函数放在我的 $scope.update 函数中，它会在更改之前发送以前的数据。它会发送 'index': 1，当我把它移到 'index': 2 时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:06:20.590

我使用 angulars 'copy' 方法来防止修改范围，并且我使用 javascript 来定义索引而不是这里看到的 angular： var data = angular.copy(target);

```
 for (i=0, l=data.length; i<l; i++){
        parentid = data[i].id;
        data[i]['index'] = i;
        if(data[i].children) {
            if(data[i].children.length > 0){
                for (q=0, r=data[i].children.length; q<r; q++){
                    data[i].children[q]['parentid'] = parentid;
                    data[i].children[q]['index'] = q;
                }
            }
        }
    } 
```

# cairo - 为什么 Cairo.set_source_rgb 绘制整个画布？

> ID：16007420
> 
> 赞同：1
> 
> 时间：2013-04-15T03:53:13.023
> 
> 标签：cairo, vala, clutter

我正在玩杂物/开罗，我正在尝试绘制一个矩形；`set_source_rgb`但是，无论我是否告诉它绘制一个矩形，它似乎都会自动使用其源绘制整个画布（也就是说，即使我删除了`ctx.rectangle()`和`ctx.fill()`线，矩形仍然被绘制）。为什么是这样？我需要做什么才能让矩形而不是 set_source_rgb 进行绘画？

```
public class AnActor : Clutter.Actor {

    public Clutter.Canvas canvas;

    public AnActor() {
        canvas = new Clutter.Canvas();
        canvas.set_size(300,300);

        this.set_content( canvas );
        this.set_size(300,300);

        //Connect to the draw signal.
        canvas.draw.connect(drawme);
    }

    private bool drawme( Cairo.Context ctx, int w, int h) {
        stdout.printf("Just to test this ran at all: %d\n", w);

        ctx.scale(w,h);
        ctx.set_source_rgb(0,0,0);

        //Why is this rectangle drawn even when I remove these lines?
        ctx.rectangle(0,0,200,200);
        ctx.fill();

        ctx.paint();

        return true;
    }
}

int main(string [] args) {
    // Start clutter.
    var result = Clutter.init(ref args);
    if (result != Clutter.InitError.SUCCESS) {
        stderr.printf("Error: %s\n", result.to_string());
        return 1;
    }

    var stage = Clutter.Stage.get_default();
    stage.destroy.connect(Clutter.main_quit);

    //Make my custom Actor:
    var a = new AnActor();
    stage.add_child(a);
    a.canvas.invalidate();

    stage.show_all();

    Clutter.main();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:47:18.490

在我看来，drawme方法实际上存在一些误解：

```
ctx.scale(w,h); 
```

从您稍后所做的判断，您似乎认为这意味着您想要缩放您正在做的事情，以便您可以绘制 0,0 到 300,300 之间的内容。你实际上在做的是在另一个方向……如果你把这条线留在这里，你需要在 0,0 和 1,1 之间绘制。

```
ctx.rectangle(0,0,200,200);
ctx.fill(); 
```

在这里，您要求一个从原点到 200 * 画布宽度和高度的矩形。如果你把它改成`ctx.rectangle (0, 0, 0.67, 0.67)`结果应该更接近你想要的。或者，正如我之前提到的，您可以摆脱`ctx.scale(w,h);`呼叫。

```
ctx.paint(); 
```

查看[cairo_paint](http://www.cairographics.org/manual/cairo-cairo-t.html#cairo-paint)的文档：“在当前剪辑区域内的任何位置绘制当前源的绘图运算符。” 您想要的是填充当前*路径*，这就是[cairo_fill](http://www.cairographics.org/manual/cairo-cairo-t.html#cairo-fill)所做的。由于您尚未定义剪辑区域，因此整个上下文都会被填充。

[或者，您可以使用cairo_clip](http://www.cairographics.org/manual/cairo-cairo-t.html#cairo-clip)创建一个剪辑区域；只需在之前添加一个`ctx.clip ();`权利`ctx.paint ();`。您可能想要使用 cairo_save 和 cairo_restore——cairo_clip 的文档对此进行了解释。

# haskell - 定义 Haskell 类型构造函数相等？

> ID：16007427
> 
> 赞同：3
> 
> 时间：2013-04-15T03:54:10.597
> 
> 标签：haskell, algebraic-data-types, pattern-synonyms

我不是 Eq 的成员。我的代码：

```
data Race = Terran | Zerg | Protoss deriving (Eq, Show, Read);

data MU = MU Race Race deriving (Eq, Show); 
```

在这种情况下，我定义例如`(MU Terran Zerg)`。我想创建一个数据构造函数`TvZ`，它在实例的所有方面都基本相同，因此我可以匹配一个函数模式：

```
foo TvZ = ... 
```

而不是必须做

```
foo (MU Terran Zerg) = ... 
```

如果将其分配给变量，则无法执行此操作`tvZ = (MU Terran Zerg)`

我想做的另一件事是制作简短的表格，就像制作类型构造函数`T`一样`Terran`。

最后一件事，我觉得医疗运输车的速度提升需要小幅削弱。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T04:04:18.933

您所要求的被称为“模式同义词”，并且已被多次提出。目前尚未实施。您可以在[此处](http://hackage.haskell.org/trac/ghc/wiki/PatternSynonyms)、[此处](http://hackage.haskell.org/trac/ghc/ticket/5144)和许多其他地方查看提案（链接由 hammar 提供）。

但是，作为一种解决方案，这同样适用：

```
foo (MU Terran Zerg) = ...
foo (MU Zerg Terran) = foo $ MU Terran Zerg 
```

并且将有效地实现相同的目标，即使它看起来不那么好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T06:02:05.657

首先尝试使用以下模式（我假设`MU Terran Terran`允许其他自我关系。）：

```
foo (MU Terran Terran)   = ...
foo (MU Terran Zerg)     = ...
foo (MU Terran Protoss)  = ...
foo (MU Zerg Zerg)       = ...
foo (MU Zerg Protoss)    = ...
foo (MU Protoss Protoss) = ...
foo (MU x y) = foo (MU y x) 
```

你必须对这样定义的函数非常小心，因为如果你没有让案例详尽无遗，那就是一个无限循环。

第二次尝试：我尝试了概括这种模式，我想出的最好的就是这个，几乎没有更好的：

```
forceSymmetric :: (MU -> Maybe r) -> MU -> r
forceSymmetric f = \p -> case f p of
                          Nothing -> fromJust (f (swap p))
                          Just r -> r

foo (MU Terran Terran)   = Just ...
foo (MU Terran Zerg)     = Just ...
foo (MU Terran Protoss)  = Just ...
foo (MU Zerg Zerg)       = Just ...
foo (MU Zerg Protoss)    = Just ...
foo (MU Protoss Protoss) = Just ...
foo (MU x y)             = Nothing 
```

这样做的好处是，如果你搞砸了，你会产生错误而不是无限循环。

第三，更深层次的尝试：问题的核心是你想要**对称**。让我们忘记这`MU`是一个构造函数，而只是将其视为一个函数。你希望它遵守这个对称定律：

```
MU a b == MU b a 
```

这里`==`我不一定指`Eq`类型类，而是**相互替代**；用一个表达式代替另一个表达式不应影响任何程序的含义。

好吧，代数数据类型没有那个属性，句号。对于代数数据类型构造函数，例如`MU`，`MU a b == MU c d`当且仅当`a == b`和`c == d`。所以如果你想让任何函数都无法区分`MU Terran Zerg`and `MU Zerg Terran`，你需要将`MU`类型抽象化，这样它的用户就看不到它的内部表示。

一次取*r的**n 个*项目的组合数的公式，允许重复，是；对于和，这是 6 种组合。所以我们想要的是定义一个只有六个可能值的类型，一个这样的函数，和一个这样的函数。我能想到的最简单的方法是使用排序的元组：*`factorial (n + r - 1) / (factorial r * factorial (n - 1))``n = 3``r = 2``MU``toMU :: Race -> Race -> MU``mu a b == mu b a``fromMU :: MU -> (Race, Race)``uncurry toMU . fromMU == id`*

 *```
data Race = Terran | Zerg | Protoss deriving (Eq, Show, Read, Ord);

data SortedPair a = SP a a  -- The constructor here needs to be private

makeSortedPair :: Ord a => a -> a -> SortedPair a
makeSortedPair a b | a < b     = SP a b
                   | otherwise = SP b a

breakSortedPair :: SortedPair a a -> (a, a)
breakSortedPair (SP a b) = (a, b)

type MU = SortedPair Race

toMU :: Race -> Race -> MU
toMU = makeSortedPair

fromMU :: MU -> (Race, Race)
fromMU = breakSortedPair 
```

现在您可以保证`fromMU`可以生产`(Terran, Zerg)`但不能生产`(Zerg, Terran)`，因此您可以从上面的前两个提案中省略最终的“包罗万象”案例。（然而，编译器对此一无所知，所以它仍然会抱怨非详尽的模式。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-16T14:39:00.927

从 GHC 7.8 开始，您可以使用[pattern synonyms](https://ghc.haskell.org/trac/ghc/wiki/PatternSynonyms)，这是一种新的语言扩展，主要针对这个用例：

```
{-# LANGUAGE PatternSynonyms #-}

pattern TvZ :: MU
pattern TvZ = MU Terran Zerg 
```

这将允许您`TvZ`在模式上下文（即匹配）和表达式上下文（即新`MU`值的构造）中使用。*

# blogs - 带有博客文章的果园标签描述页面

> ID：16007433
> 
> 赞同：0
> 
> 时间：2013-04-15T03:55:19.243
> 
> 标签：blogs, orchardcms, taxonomy

我有一个 Orchard 站点，其中有页面和博客文章都被标记。每个标签都有：

*   单个关联页面
*   多个相关的博客文章

我基本上是在尝试创建一个页面，其中包含每个标签的描述，以及描述下的相应博客文章。有人对实现这一目标的最佳方法有建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T07:40:21.463

请改用分类法。分类术语可以有一个正文部分，它基本上对应于您的标签页。

# php - 将javascript值分配给php变量

> ID：16007435
> 
> 赞同：1
> 
> 时间：2013-04-15T03:55:27.073
> 
> 标签：php, javascript, jquery

我正在尝试检查屏幕宽度并将其分配给 php 变量以执行一些 if else 语句。这就是我得到的。

```
<script>
    var mobileFormWidthCheck = $(window).width();
    var mobileFormReady;
    if(mobileFormWidthCheck < 767){
        mobileFormReady = 22;
    }
    else{
        mobileFormReady = 55;  
    }

</script>

    <?php   
        $widthChecked = "<script>document.write(mobileFormReady);</script>";
        echo $widthChecked;
    ?> 
```

这完美地工作。但是当我尝试根据`mobileFormReady`值回显某些内容时，它不会回显。

这就是我试图开始工作的原因。

```
$widthChecked = "<script>document.write(mobileFormReady);</script>";
if($widthChecked == "22"){
  echo 'this page is under 767 pixels';
}
else if($widthChecked == "55"){
  echo 'this page is OVER 767 pixels';
}
else{
  echo 'NOT WORKING YET';
} 
```

我认为这是一个字符串整数问题。但我似乎无法弄清楚。你们能帮帮我吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:19:39.693

我想你可以使用cookies。

1）首先添加一个cookie jquery插件。

2) 然后将该窗口宽度存储在 cookie 变量中。

3) 在 PHP 中访问您的 cookie，例如 $_COOKIE['variable name']。( [http://www.w3schools.com/php/php_cookies.asp](http://www.w3schools.com/php/php_cookies.asp) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:49:06.790

你无法达到你想要的...

原因是

```
$widthChecked  is "<script>document.write(mobileFormReady);</script>";
and not 22 or 55. 
```

您获得值的原因`echo`是因为它正在执行脚本而不是打印`$widhcheck`

# javascript - ajax 忽略 url

> ID：16007436
> 
> 赞同：2
> 
> 时间：2013-04-15T03:55:36.123
> 
> 标签：javascript, jquery, ajax

```
$.ajax({
    method: 'post',
    url: '/send.php',
    data: { 'username': user }
}) 
```

它忽略 url 位并将参数从数据发送到当前页面并将我发送到

```
mywebsite.com/currentpage.php?username=user 
```

代替

```
mywebsite.com/send.php?username=user 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:06:43.537

看起来您遇到的可能是一个错误，因为我无法重现它。但是，假设它是 jQuery，正确的选项是`type`，而不是，如[方法](http://api.jquery.com/jQuery.ajax/)[文档中](http://api.jquery.com/jQuery.ajax/)`method`所示：[`$.ajax()`](http://api.jquery.com/jQuery.ajax/)

```
$.ajax({
    type:'post',
    url: '/send.php',
    data: { 'username': user }
}); 
```

**编辑1：**

..根据评论，您似乎正在尝试在表单上使用ajax ..而不阻止表单的默认操作，除非我弄错了，否则当一个人不提供表单方法时，它默认为get.. 除非指定，否则操作默认为当前页面。

在您执行此操作的任何函数中.. 对于此示例，我将假设`submit()`您想要`return false`或`e.preventDefault()`，在`e`提交事件中传递给函数的事件对象在哪里。例子：

```
$("form").submit(function(e) {
    e.preventDefault();
    //do your ajax here.
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-23T07:12:19.733

我最近经历过这种情况。经过调查，我发现ajax请求的原始目标是重定向。Chrome 开发工具显示的是第二个而不是 $.ajax 的原始目标。

# css - CSS3 悬停效果在移动浏览器上不起作用

> ID：16007437
> 
> 赞同：3
> 
> 时间：2013-04-15T03:55:38.323
> 
> 标签：css, mobile

我在我的网站上设置了以下内容。但是，当使用移动浏览器时，我无法让描述在触摸/悬停时淡入。有没有办法可以更改下面的代码，以便在移动浏览器上具有相同的行为？

JSFiddle在这里：http: [//jsfiddle.net/CJNgb/](http://jsfiddle.net/CJNgb/)

**HTML**

```
<article class="project">
  <div class="thumbnail view">
    <img src="http://lorempixel.com/output/people-q-c-292-292-9.jpg" />
    <section class="description">
      <hgroup>
        <h2>Title</h2>
        <h3>Identity, Illustration, Web</h3>
      </hgroup>
      <p>Description of project.</p>
      <a class="screenshot single-image" href="http://lorempixel.com/output/nightlife-q-c-700-700-4.jpg"></a>
        <span><a href="http://test.com" target="_blank">Visit website</a>   <a href="http://test.com/read-more">View more</a></span>
    </section>
  </div>
</article> 
```

**CSS**

```
body {
color: #666;
font: 11px/1.5 helvetica,arial,sans-serif;
}
a { font-weight:bold;text-decoration:none }
.project {
background: #fff;
border: 1px solid #e5e5e5;
float: left;
height: 292px;
margin: 0 20px 20px 0;
overflow: hidden;
padding: 3px;
position: relative;
top: auto;
width: 292px;
}
.project .thumbnail {
   float: left;
   overflow: hidden;
   cursor: default;
   background: #f4f3f1;
    width:292px;
    height:292px;
}
.project .description {
   width: 252px;
   height:252px;
   position: absolute;
   top: 3px;
   left: 3px;
   padding:20px;
}
.project .description span a {
opacity: 1;
-webkit-transition: opacity;
-webkit-transition-timing-function: ease-out;
-webkit-transition-duration: 150ms;
-moz-transition: opacity;
-moz-transition-timing-function: ease-out;
-moz-transition-duration: 150ms;
background: #fff;
border: 1px solid #dedede;
color: #222 !important;
display: block;
float: left;
margin: 10px 10px 0 0;
padding: 10px 15px;
}
.screenshot {
opacity: 1;
-webkit-transition: opacity;
-webkit-transition-timing-function: ease-out;
-webkit-transition-duration: 150ms;
-moz-transition: opacity;
-moz-transition-timing-function: ease-out;
-moz-transition-duration: 150ms;
background: url("http://i.imgur.com/fEoN3s9.png") no-repeat scroll 0 0 transparent;
background-size: 37px 46px;
display: block;
height: 46px;
position: absolute;
right: 20px;
top: 20px;
width: 37px;
}
.thumbnail img {
   display: block;
   position: relative;
}
.thumbnail h2 {
   margin-bottom:5px;
   padding-bottom:0;
}
.project .description h3 {
   border-bottom:1px solid #dedede;
   color: #666;
   font-size:1em;
   margin-bottom: 15px;
   padding-bottom: 15px;
}
.project .description a {
   color: #ea641c;
}
.view img {
   -webkit-transition: all 0.2s linear;
   -moz-transition: all 0.2s linear;
   -o-transition: all 0.2s linear;
   -ms-transition: all 0.2s linear;
   transition: all 0.2s linear;
}
.view .description {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=0)";
   filter: alpha(opacity=0);
   opacity: 0;
   background-color: #f4f3f1;
   -webkit-transition: all 0.4s ease-in-out;
   -moz-transition: all 0.4s ease-in-out;
   -o-transition: all 0.4s ease-in-out;
   -ms-transition: all 0.4s ease-in-out;
   transition: all 0.4s ease-in-out;
}
.view hgroup {
   -webkit-transform: translateY(-100px);
   -moz-transform: translateY(-100px);
   -o-transform: translateY(-100px);
   -ms-transform: translateY(-100px);
   transform: translateY(-100px);
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=0)";
   filter: alpha(opacity=0);
   opacity: 0;
   -webkit-transition: all 0.2s ease-in-out;
   -moz-transition: all 0.2s ease-in-out;
   -o-transition: all 0.2s ease-in-out;
   -ms-transition: all 0.2s ease-in-out;
   transition: all 0.2s ease-in-out;
}
.view p {
   -webkit-transform: translateY(100px);
   -moz-transform: translateY(100px);
   -o-transform: translateY(100px);
   -ms-transform: translateY(100px);
   transform: translateY(100px);
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=0)";
   filter: alpha(opacity=0);
   opacity: 0;
   -webkit-transition: all 0.2s linear;
   -moz-transition: all 0.2s linear;
   -o-transition: all 0.2s linear;
   -ms-transition: all 0.2s linear;
   transition: all 0.2s linear;
}
.view:hover img {
   -webkit-transform: scale(1.1,1.1);
   -moz-transform: scale(1.1,1.1);
   -o-transform: scale(1.1,1.1);
   -ms-transform: scale(1.1,1.1);
   transform: scale(1.1,1.1);
}
.view a.info {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=0)";
   filter: alpha(opacity=0);
   opacity: 0;
   -webkit-transition: all 0.2s ease-in-out;
   -moz-transition: all 0.2s ease-in-out;
   -o-transition: all 0.2s ease-in-out;
   -ms-transition: all 0.2s ease-in-out;
   transition: all 0.2s ease-in-out;
}
.view:hover .description {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
   filter: alpha(opacity=100);
   opacity: 1;
}
.view:hover hgroup,
.view:hover p,
.view:hover a.info {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
   filter: alpha(opacity=100);
   opacity: 1;
   -webkit-transform: translateY(0px);
   -moz-transform: translateY(0px);
   -o-transform: translateY(0px);
   -ms-transform: translateY(0px);
   transform: translateY(0px);
}
.view:hover p {
   -webkit-transition-delay: 0.1s;
   -moz-transition-delay: 0.1s;
   -o-transition-delay: 0.1s;
   -ms-transition-delay: 0.1s;
   transition-delay: 0.1s;
}
.view:hover a.info {
   -webkit-transition-delay: 0.2s;
   -moz-transition-delay: 0.2s;
   -o-transition-delay: 0.2s;
   -ms-transition-delay: 0.2s;
   transition-delay: 0.2s;
} 
```

编辑：添加此行使其在移动设备上工作！`document.addEventListener("touchstart", function() {},false);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:36:22.653

您可以依靠这个 javascript 解决方案：

**[泽普托](http://zeptojs.com/)**

[查看 JsFiddle](http://jsfiddle.net/p92KR/1/)
[查看现场演示](http://tap.mspyratos.com/)

首先，[下载](http://zeptojs.com/#download) `Zepto.js`. 这是一个非常轻量级的库，专注于移动浏览器。对于触摸事件，您还需要`touch.js`包含在 Zepto`src`文件夹中的 Zepto 模块。

所以我们只需要这两个文件：
+ `zepto.js`(minified+gzipped: 9.7k)
+ `touch.js`(non-minified/non-gzipped: 4k)

Zepto 支持以下触摸事件：

*   `tap`— 当元素被点击时触发。
*   `singleTap`并且`doubleTap`— 这对事件可用于检测同一元素上的单击和双击（如果您不需要双击检测，请改用轻击）。
*   `longTap`— 当一个元素被点击并且手指被按住超过 750 毫秒时触发。
*   `swipe`, `swipeLeft`, `swipeRight`, `swipeUp`, `swipeDown`— 滑动元素时触发（可选在给定方向上）

**新代码：**

* * *

**HTML/JS**

```
<body>
<article class="project">
  <div class="thumbnail view">
    <img src="http://lorempixel.com/output/people-q-c-292-292-9.jpg" />
    <section class="description">
      <hgroup>
        <h2>Title</h2>
        <h3>Identity, Illustration, Web</h3>
      </hgroup>
      <p>Description of project.</p>
      <a class="screenshot single-image" href="http://lorempixel.com/output/nightlife-q-c-700-700-4.jpg"></a>
        <span><a href="http://test.com" target="_blank">Visit website</a>   <a href="http://test.com/read-more">View more</a></span>
    </section>
  </div>
</article>

<script src="zepto.js"></script>
<script src="touch.js"></script>
<script>
$('.view').tap(function(){
    if( $(this).hasClass('view-tap') ) {
        $(this).removeClass('view-tap')
    } else {
        $(this).addClass('view-tap')
    }
})

// Prevent any link click, when tap on image
$('.view a').on('click', function(e) {
    if( !$('.view').hasClass('view-tap') ) {
        e.preventDefault()
    }
})
</script>
</body> 
```

* * *

**CSS**（仅替换部分：添加`.view-tap`到每个旁边`.view:hover`）

```
.view:hover img, .view-tap img {
   -webkit-transform: scale(1.1,1.1);
   -moz-transform: scale(1.1,1.1);
   -o-transform: scale(1.1,1.1);
   -ms-transform: scale(1.1,1.1);
   transform: scale(1.1,1.1);
}
.view:hover .description, .view-tap .description {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
   filter: alpha(opacity=100);
   opacity: 1;
}
.view:hover hgroup, .view-tap hgroup,
.view:hover p, .view-tap p,
.view:hover a.info, .view-tap a.info {
   -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
   filter: alpha(opacity=100);
   opacity: 1;
   -webkit-transform: translateY(0px);
   -moz-transform: translateY(0px);
   -o-transform: translateY(0px);
   -ms-transform: translateY(0px);
   transform: translateY(0px);
}
.view:hover p, .view-tap p {
   -webkit-transition-delay: 0.1s;
   -moz-transition-delay: 0.1s;
   -o-transition-delay: 0.1s;
   -ms-transition-delay: 0.1s;
   transition-delay: 0.1s;
}
.view:hover a.info, .view-tap a.info {
   -webkit-transition-delay: 0.2s;
   -moz-transition-delay: 0.2s;
   -o-transition-delay: 0.2s;
   -ms-transition-delay: 0.2s;
   transition-delay: 0.2s;
} 
```

这种方法的优点是您不必担心跨浏览器的兼容性，如果您将来需要更多的移动功能，实现它们很容易。

# pentaho - 在 pentaho 中创建导出按钮

> ID：16007438
> 
> 赞同：0
> 
> 时间：2013-04-15T03:55:43.243
> 
> 标签：pentaho, dashboard, dashboard-designer, pentaho-design-studio

我尝试创建导出按钮以将仪表板导出到 pentaho 中的 pdf 文件，如下所示：

[http://www.youtube.com/watch?v=D1fj69yHiGc](http://www.youtube.com/watch?v=D1fj69yHiGc)

希望你能帮助我，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:07:25.480

执行此操作的一般/最佳方法是将仪表板实际重新实现为 Pentaho 报告并使用 CGG 将图表放入报告中。

像这样：

[http://www.ambientbi.co.uk/?p=357](http://www.ambientbi.co.uk/?p=357)

你有什么理由特别想使用 PhantomJS 吗？PRD 选项将使您更好地控制最终报告，并且在不同浏览器上不会有差异，这肯定是您想要的 PDF 吗？

# c++ - cin 作为while循环中的条件？

> ID：16007441
> 
> 赞同：3
> 
> 时间：2013-04-15T03:57:22.047
> 
> 标签：c++, cin

这里对 C++ 有点新。是否可以执行以下操作？

```
int temp;
while(cin >> temp != -9999){//Do something with temp} 
```

我无法让那个确切的代码工作，但我觉得这样的事情应该是可能的。

**编辑** 也尝试了以下方法：

```
while(cin.getline(temp) != -9999){//Do something with temp} 
```

依然没有。`getline()`仅适用于字符串吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T03:59:37.457

是的，它确实：

```
while (std::cin >> temp && temp != -9999) 
```

但是，C++ 中的运算符优先级很烦人，所以我会使用：

```
while (std::cin >> temp) {
    if (temp == -9999)
        break; 
```

推理是那`std::cin`是一个流。因此，从中读取会返回流，因此您可以执行以下操作：

```
std::cin >> temp >> temp2; 
```

# jquery - jq的div显示问题

> ID：16007444
> 
> 赞同：0
> 
> 时间：2013-04-15T03:57:29.563
> 
> 标签：jquery

修改了一个小提琴来做多个，但它有一个错误与多重...当链接 1 被点击时，div 1 和 2 受到影响。

单击链接 2 时，只有 div 2 受到影响。

这里可能是什么问题？

[http://jsfiddle.net/bluey/zsMaE/3/](http://jsfiddle.net/bluey/zsMaE/3/)

```
 function deselect() {
        $(".pop").slideFadeToggle(function() { 
            $("#contact").removeClass("selected");
        });    
    }

    $(function() {
        $("#contact").live('click', function() {
            if($(this).hasClass("selected")) {
                deselect();               
            } else {
                $(this).addClass("selected");
                $(".pop").slideFadeToggle(function() { 

                });
            }
            return false;
        });

        $(".close").live('click', function() {
            deselect();
            return false;
        });
    });

    $.fn.slideFadeToggle = function(easing, callback) {
        return this.animate({ opacity: 'toggle', height: 'toggle' }, "fast", easing, callback);
    };

    function deselect() {
        $(".pop2").slideFadeToggle(function() { 
            $("#contact2").removeClass("selected");
        });    
    }

    $(function() {
        $("#contact2").live('click', function() {
            if($(this).hasClass("selected")) {
                deselect();               
            } else {
                $(this).addClass("selected");
                $(".pop2").slideFadeToggle(function() { 

                });
            }
            return false;
        });

        $(".close").live('click', function() {
            deselect();
            return false;
        });
    });

    $.fn.slideFadeToggle = function(easing, callback) {
        return this.animate({ opacity: 'toggle', height: 'toggle' }, "fast", easing, callback);
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:44:49.087

您声明 2 次取消选择！所以显然第二个会覆盖第一个

做一个插件

```
$.fn.extend({deselect : function () {$(this).removeClass('deselect')} }); 
```

然后立即绑定您的 2 个联系人（给他们上课）然后使用`$(this)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:49:41.250

您已经定义了两次“deselect()”函数。您可以将第二个重命名为“deselect2”，但有更好的方法可以做到这一点。

不要给链接唯一的ID，而是给它们相同的类（比如“联系人”）。然后，您可以轻松地为它们分配相同的单击事件处理程序。然后重写“deselect()”函数，将链接作为参数。要将“messagepop” div 与链接相关联，您可以给它们唯一的 id，然后将链接的 href 设置为 div 的 id。

HTML：

```
<div class="messagepop" id="pop1">ANYTHING HERE 1</div>
<div class="messagepop" id="pop2">ANYTHING HERE 2</div>
<a href="#pop1" class="contact">Contact Us 1</a>
<a href="#pop2" class="contact">Contact Us 2</a> 
```

JavaScript：

```
function select($link) {
    $link.addClass('selected');
    $($link.attr('href')).slideFadeToggle(function () {});
}

function deselect($link) {
    $($link.attr('href')).slideFadeToggle(function () {
        $link.removeClass('selected');
    });
}

$('.contact').click(function () {
    var $link = $(this);
    if ($link.hasClass('selected')) {
        deselect($link);
    } else {
        select($link);
    }
    return false;
}); 
```

[**jsfiddle**](http://jsfiddle.net/john_s/zsMaE/6/)

**更新评论中的问题**

如果您一次只希望其中一个`<div>`s 可见，则可以跟踪哪个可见并在使另一个可见之前将其隐藏，但在显示一个之前将它们全部隐藏起来更容易。`<div>`s 都有“messagepop”类，所以很容易全部选中。

```
function select($link) {
    $link.addClass('selected');
    $('.messagepop:visible').slideFadeToggle(function () {});
    $($link.attr('href')).slideFadeToggle(function () {});
} 
```

注意：如果我们用 隐藏它们`.hide()`，我可能会使用`'.messagepop'`选择器并隐藏所有它们，但是由于`.slideFadeToggle()`切换它们，我`'.messagepop:visible'`将切换限制为仅可见的切换。

# html-lists - w3c 标记验证：此时元素 li 上不允许属性持续时间

> ID：16007445
> 
> 赞同：1
> 
> 时间：2013-04-15T03:57:41.303
> 
> 标签：html-lists, w3c-validation, duration

通过 w3c 验证器验证时出现此错误：

> 此时不允许在元素 li 上使用属性持续时间。

```
<li data-text-id="#bannerscollection_kenburns_photoText3" data-horizontalPosition="center" data-verticalPosition="center" data-initialZoom="1" data-finalZoom="1" duration="5" > 
```

有人请帮助我。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T11:47:42.917

试试这个代码：

```
<li data-text-id="#bannerscollection_kenburns_photoText3" data-horizontalPosition="center" data-verticalPosition="center" data-initialZoom="1" data-finalZoom="1" data-duration="5" > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T13:29:32.237

正如消息所说，该属性`duration`不允许用于 element `li`，因为您可以轻松地检查[规范](http://www.w3.org/TR/html5/grouping-content.html#the-li-element)：

> **内容属性：**
> 
> *   全局属性
> *   如果元素是元素的子`ol`元素：`value`

`duration`不是全局[属性](http://www.w3.org/TR/html5/dom.html#global-attributes)。*_*

你可以在它前面加上前缀`data-`，就像你对所有其他属性一样。但是，*如果*您使用需要属性的第三方工具`duration`，它将不再起作用。（不过，您没有在问题中提及工具。）

# android - 如何以编程方式在Android中标记紧急呼叫

> ID：16007448
> 
> 赞同：0
> 
> 时间：2013-04-15T03:58:02.303
> 
> 标签：android

我正在创建一个应用程序，在该应用程序中我试图覆盖默认的 android 拨号以包含一个更多按钮“URGENT”。这个想法是，如果应用程序安装在 2 部手机上，并且一部手机将呼叫标记为“紧急”，另一部手机的接收器屏幕（也将被覆盖）将变为“红色”以向接收器显示呼叫是“紧迫的”。

**我正在使用下面的代码进行调用，但不确定如何包含“URGENT”参数。**

`Intent intent = new Intent(Intent.ACTION_CALL, Uri.parse("tel:03000000000"));
startActivity(intent);`

请建议是否有任何方法可以实现此功能。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:06:04.863

您不能只为意图构成参数 - 您的调用必须支持该字段的意图。而且我不确定电话网络是否有“紧急”呼叫的想法。我知道我不会想要它——世界上每个电话推销员都会在每次通话中使用它。但是如果你真的想通过这个，你需要一种带外方式将数据发送到另一部手机，并且你需要在通话通过之前将其发送到那里。您可以尝试让它告诉您拥有的服务器一个呼叫将是紧急的，并通过 GCM 将其推送到接收器，但是很难获得时间。

# clojure - 如何在不重置 repl 的情况下重新加载 aot 编译的类？

> ID：16007450
> 
> 赞同：6
> 
> 时间：2013-04-15T03:58:51.717
> 
> 标签：clojure

我已经使用定义了一个 java 类`gen-class`，并且每次启动 repl 时都会编译它。但是，如果我想对类进行更改，我发现我必须重新启动并重新编译该类。有没有办法在不关闭repl的情况下做到这一点？

### 一个例子

我正在研究这个[https://github.com/zcaudate/hara/blob/master/src/hara/ova/impl.clj](https://github.com/zcaudate/hara/blob/master/src/hara/ova/impl.clj)

并且项目中有一条线。clj

```
:aot [hara.ova.impl] 
```

所以说文件已经加载，我可以这样做：

```
(import hara.ova.Ova)
(def a (Ova.)) 
```

我想为`bar`类添加另一个方法，我只想`-bar`在`hara.ova.impl`命名空间中定义，调用一个`compile-gen-class`函数来重新加载类，然后在不重新加载 repl 的情况下执行此操作：

```
(import hara.ova.Ova)
(def a (Ova.))
(.bar a) 
```

现在，Cc Ck 不允许这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-12T18:11:31.947

您需要`compile`在命名空间上调用该函数。

`(ns test) (gen-class :name test.Cls) (comment (compile 'test))`

编译调用需要注释掉，这样它就不会递归调用自己。我经常将这些保留在我的开发文件中，以便通过评估该编译表达式来快速重新编译定义。

# git - 仅在 Jenkins 的新分支上触发构建？

> ID：16007451
> 
> 赞同：3
> 
> 时间：2013-04-15T03:59:06.060
> 
> 标签：git, jenkins, branch

我有一个几年前的 git 存储库，有 100 个分支。我真的只想让 Jenkins 开始在新推送的分支上运行构建，而不是以前的分支。

目前我正在尝试通过`post-receive`钩子中的 URL 触发它：

```
http://jenkins/git/notifyCommit?url=git@git:myrepository.git&branches=${BRANCH} 
```

它确实激活了构建，但是我可以看到的每个分支都这样做，而不是 URL 中指定的分支。

有没有办法指定要构建的分支。也许找出“已完成”分支列表在数据库/配置中的位置并更新它，以便它不会尝试构建这些分支（因为它认为它已经完成了它们）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T04:54:48.370

使用“分支”字符串变量启用的“此构建已参数化”选项设置构建适用于此：

```
curl -s "http://jenkins/job/job_name/buildWithParameters?branch=${BRANCH}" 
```

有关设置作业配置的信息，请参阅[http://julianhigman.com/blog/2012/02/22/building-github-branches-with-jenkins/ 。](http://julianhigman.com/blog/2012/02/22/building-github-branches-with-jenkins/)

# c# - 当我将文本框的此属性初始化为 false 时，属性 setenabled 保持为 false

> ID：16007457
> 
> 赞同：1
> 
> 时间：2013-04-15T03:59:45.060
> 
> 标签：c#, javascript, asp.net

我是 javascript 的新编程，我有这个问题，在一个 web 项目中，我有两个 raddiobuttons（rbtn1 和 rbtn2）和一个文本框（txt1），当我选择 rbtn1 时，他的选中属性为 true（显然）和 setenabled 属性txt1 的属性必须为真，当我选择 rbtn2 时，txt1 的 setenabked 属性必须为假。我做到了，当我初始化 txt1 的属性 setenabled=true 时它工作得很好，但是当我将此属性初始化为 false 时它不起作用。

为什么会这样？，有关额外信息，我在 asp.net 和 c# 项目中使用 devexpress 控件。谢谢回答。。

嗨，谢谢你的回答，是的，我正在使用 C# asp.net 项目，但在这种情况下，我也使用了 javascript。这是单选按钮的代码

```
 <dx:ASPxRadioButton ID="rbtn" runat="server" Text="Disabled" 
                ClientIDMode="AutoID" ClientInstanceName="rbtn">
                <ClientSideEvents CheckedChanged="function(s, e) {
        disabled(s, e);}" />  </dx:ASPxRadioButton>

            <dx:ASPxRadioButton ID="rbtn1" runat="server" Text="Enabled" 
              ClientIDMode="AutoID" ClientInstanceName="rbtn1" Checked="True">  
<ClientSideEvents CheckedChanged="function(s, e) {enabled(s, e);}" />
     </dx:ASPxRadioButton> 
```

这里是javascript代码

```
function disabled(s, e) {
        rbtn1.SetChecked(false);
        txt1.SetEnabled(false);
    }

    function enabled(s, e) {
        rbtn.SetChecked(false);
        txt1.SetEnabled(true);
    } 
```

正如我所说，只有当我将 setenabled txt1 的属性初始化为 true 时它才能完美运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:05:46.553

当 ASP.NET 呈现控件时，它会将它们转换为 HTML 块。在这种情况下，您应该检查呈现的控件是否保持相同的 ID（rbtn、rbtn1）等。

此外，您需要检查它们以 HTML 控件的形式呈现的内容。[运行后在浏览器中查看->源代码] 通常它们会在 HTML 标记内呈现，因此，如果该标记称为 form1，并且控件是 rbtn 和 rbtn1，则要启用/禁用它们，您可以使用：

document.form1.rbtn.disabled=true；document.form1.rbtn1.disabled=false；

等等

适用于 C# 的服务器端控件的 API 可能不适用于 JS（除非 DevExpress 生成一个模仿它的 JS 库，它可以在运行时自动下载，我对此表示怀疑）

# eclipse - 在 Eclipse RCP 中的自定义编辑器上切换断点？

> ID：16007459
> 
> 赞同：1
> 
> 时间：2013-04-15T03:59:50.997
> 
> 标签：eclipse, eclipse-rcp, eclipse-plugin

我想在我创建的新编辑器上切换断点。我有一个新的编辑器和一个新的 LineBreakpoint 实现并运行。我已经可以使用`Ctrl`+ `Shift`+`B`或 Main Menu -> Run -> Toggle Line Breakpoint 切换这些断点。我希望能够在我的自定义 Eclipse 应用程序的垂直标尺栏中添加 Java 编辑器中完全相同的切换行为。也就是说，双击在给定的行位置创建/切换断点。右键单击会弹出切换断点菜单上下文（在垂直标尺栏上）。完成线切换图像标签。

*我假设有一种简单的方法可以做到这一点*，而不是实现每个菜单和操作。如果没有，如何将这些双击和上下文菜单添加到自定义编辑器的垂直标尺？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-12T16:10:10.247

这是一个老问题，但我遇到了这个问题并这样做了：

我有一个编辑器（org.eclipse.ui.texteditor.AbstractDecoratedTextEditor）。在这个编辑器类上，我实现了这个方法：

```
@Override
protected IVerticalRulerColumn createAnnotationRulerColumn(CompositeRuler ruler) {
    AnnotationRulerColumn column = new MyAnnotationRulerColumn(VERTICAL_RULER_WIDTH, getAnnotationAccess(), this);
    return column;
} 
```

MyAnnotationRulerColumn 类是一些这样的想法：

```
import org.eclipse.debug.ui.actions.ToggleBreakpointAction;
import org.eclipse.jface.text.source.AnnotationRulerColumn;
import org.eclipse.jface.text.source.IAnnotationAccess;
import org.eclipse.jface.text.source.IVerticalRulerInfo;

public class MyAnnotationRulerColumn extends AnnotationRulerColumn {

    private MyEditor editor;

    public MyAnnotationRulerColumn(int width, IAnnotationAccess annotationAccess, MyEditor part) {
        super(width, annotationAccess);
        this.editor = part;
    }

    @Override
    protected void mouseDoubleClicked(int rulerLine) {
        if (editor != null) {
            IVerticalRulerInfo rulerInfo= (IVerticalRulerInfo) editor.getAdapter(IVerticalRulerInfo.class);
            ToggleBreakpointAction action = new ToggleBreakpointAction(editor, null, rulerInfo);
            action.update();
            action.run();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-16T16:28:41.260

我正在考虑做同样的事情。到目前为止，我发现扩展 AbstractDecoratedTextEditor 将为您提供执行此操作的平台。我会在它工作时更新。

# openssl - make & make install OpenSSL 1.0.1e 一些错误

> ID：16007467
> 
> 赞同：6
> 
> 时间：2013-04-15T04:01:17.073
> 
> 标签：openssl

> 重复符号 _OPENSSL_cleanse 在：
> 
> ../libcrypto.a(mem_clr.o)
> 
> ../libcrypto.a(x86_64cpuid.o)
> 
> 重复符号 _AES_encrypt 在：
> 
> ../libcrypto.a(aes_core.o)
> 
> ../libcrypto.a(aes-x86_64.o)
> 
> 重复符号 _AES_decrypt 在：
> 
> ```
> ../libcrypto.a(aes_core.o) 
> ```
> 
> ../libcrypto.a(aes-x86_64.o)
> 
> 重复符号 _private_AES_set_encrypt_key 在：
> 
> ../libcrypto.a(aes_core.o)
> 
> ../libcrypto.a(aes-x86_64.o)
> 
> 重复符号 _private_AES_set_decrypt_key 在：
> 
> ../libcrypto.a(aes_core.o)
> 
> ../libcrypto.a(aes-x86_64.o)
> 
> 重复符号 _AES_cbc_encrypt 在：
> 
> ../libcrypto.a(aes_cbc.o)
> 
> ../libcrypto.a(aes-x86_64.o)
> 
> ld：架构 x86_64 的 6 个重复符号
> 
> clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）
> 
> make[2]: *** [link_app.] 错误 1
> 
> make[1]: *** [openssl] 错误 2
> 
> 制作：*** [build_apps] 错误 1

`iOS 6.1.0 和 Xcode 4.6.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:08:32.760

您似乎已经编译并链接了程序集和 .c 文件。使用程序集或 .c 文件，而不是两者。

请阅读自述文件或一些文档以在 Mac OS X 上构建库。

# php - 调用自身后调用自身不做任何事情的递归函数

> ID：16007469
> 
> 赞同：0
> 
> 时间：2013-04-15T04:01:35.683
> 
> 标签：php

我有一个调用自身的递归函数，并且在任何其他调用上都没有发生任何事情。意思是，第一次运行该函数时它运行良好，但是当它递归运行时，这些调用都没有做任何事情。

代码如下所示：

```
<?php
for($i=0; i<=$arr.length()-1; $i++;){
    function recursiveEcho(string){
        echo $arr[i];
        recursiveEcho($arr[i+1]);
    }
}
?> 
```

真正的代码会比 echo 更复杂，并且在这个函数之外它工作得很好，但是当我把它放进去时它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:07:19.910

你的代码有点奇怪。如果你想打印数组的所有元素，你只需要做一个简单的循环，比如：

```
for($i = 0 ; i < count($arr) ; $i++) {
    echo $arr[$i];
} 
```

但是，如果你想递归地实现它，你应该写这样的东西：

```
<?php

// take the array as reference (avoid copies)
function recursiveEcho(&$arr, $i){

    // Stop the recursion when we are at the end of the array
    if ($i >= count($arr))
        return;

    // print the current value
    echo $arr[$i];

    // recursively call the function for the next value
    recursiveEcho($arr, $i+1);
}

recursiveEcho($arr, 0);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:08:03.693

您调用的函数是无限递归的。使用递归时，您必须始终使用结束条件。要打印数组的所有元素，请使用

```
<?php
$arr=[1,2,3,4];
$n=count(($arr);
recursiveEcho(0);
function recursiveEcho($a)
{
    if($a==$n)
        return;
    else
    {
        echo $arr[$a]
        recursiveEcho($a+1)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:09:14.840

你是这个意思吗？

```
$arr = [1,2,3,4];

function recursiveEcho($i=0) {
  echo $arr[$i];
  if ($i < count($arr)-1) recursiveEcho(++$i);
}

recursiveEcho(); //=> 1..2..3..4 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T04:10:58.360

你不能多次定义一个函数；它会在第二次迭代中炸毁你的脚本。

在这种情况下实现递归的正确方法是完全放弃循环并创建一个有界递归函数，如下所示：

```
function recursiveEcho($arr, $i, $n)
{
    if ($i < $n) {
        echo $arr[$i];
        recursiveEcho($arr, $i + 1, $n);
    }
}

recursiveEcho($arr, 0, count($arr)); 
```

# vb.net - 将字符串编码设置为 ISO-8859-1

> ID：16007472
> 
> 赞同：0
> 
> 时间：2013-04-15T04:02:14.930
> 
> 标签：vb.net, visual-studio, encoding, utf-8, visual-studio-2010

我有一个用 UTF-8 编码的字符串，我想将其编码转换为`ISO-8859-1`. 那有可能吗？

# html - CSS 仅在索引页面上正确显示。Ruby On Rails

> ID：16007479
> 
> 赞同：3
> 
> 时间：2013-04-15T04:04:08.287
> 
> 标签：html, css, ruby-on-rails, haml

我是 Ruby On Rails 的新手，我正在尝试让一个 css 模板为一个项目工作。它在我的索引页面上运行良好，但在其他所有页面上似乎都没有从 application.html.haml 文件中获取完整的布局。

如果我使用链接在页面中包含 css，它只会添加字体更改和颜色更改，但不会更改实际布局，即。表格，格式等。

```
 = stylesheet_link_tag 'style' 
```

我不确定现在在哪里进行故障排除，因为它只从样式表中获取了我一半的样式。

```
!!! 5
%html
  %head
    %title HELPDESK   
    = csrf_meta_tags
    %link{:href => "style.css", :rel => "stylesheet", :type => "text/css"}/

  %body
    %h1.title HELPDESK
    #main
      - if flash[:notice]
        #notice.message= flash[:notice]
      - elsif flash[:warning]
        #warning.message= flash[:warning]

      = yield 
```

如果有任何帮助，我可以将我的其他页面重命名为 index.html.haml 并且 css 加载得非常好，因此页面编写正确我只是在 Rails 加载样式表的方式上有错误，或者路线有错误。

tl:dr 在**site.com/questions/**之后我的 Rails 应用程序中的所有内容都没有使用正确的样式表加载，而**site.com/questions**加载得非常好。

谢谢！

## 好的，对于稍后阅读此内容的任何人，我解决了这个问题。我需要使 application.html.haml 文件（上面列出）中的链接指向 ../style.css 而不是 style.css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:30:50.873

我解决了这个问题。我需要使 application.html.haml 文件（上面列出）中的链接指向 ../style.css 而不是 style.css

# html - 如何检查我的服务器上由哪个 URL 加载的图像（动态生成）托管？

> ID：16007482
> 
> 赞同：0
> 
> 时间：2013-04-15T04:04:25.637
> 
> 标签：html, ruby, image, webserver

我的服务器生成了动态图像 ( `http://myserver.com/image/71286cdef.png`) 并由其他站点加载。此 html 嵌入到其他服务器中的页面（例如[http://www.othersite.com/787878.html](http://www.othersite.com/787878.html)）

```
<img src='http://myserver.com/image/71286cdef.png'/> 
```

如何`http://www.othersite.com/787878.html`在我的服务器中检测此 url ( ) 加载图像

```
http://myserver.com/image/71286cdef.png 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:13:20.500

非 Ruby 特定：通常浏览器会发送[“referer”](http://en.wikipedia.org/wiki/HTTP_referer)标头以及对原始页面上资源的所有请求。因此，在生成图像的代码中，您可以检查该标题。

如果您稍后需要它来进行分析，您还可以将服务器配置为记录引荐来源标头以及其他标准属性（IP、Url、查询参数）。

注意：此标头可能丢失或伪造 - 没有真正可靠的方法来确认谁请求了图像。（可能缺少带有客户端证书的 SSL）。

处理 Ruby 漏洞的可能 Ruby 代码[：检查 HTTP 引荐来源网址](http://ruby.about.com/od/security/a/httpreferers.htm)

```
 if (
   ( request.headers['referer'].nil? ) or
   ( (request.headers['referer'] =~ %r[^http://#{request.host_with_port}/]).nil? )
   )
   flash[:notice] = "Incorrect Referer header"
   redirect_to :action => 'index'
 end 
```

# windows - 如何以编程方式防止在 Windows 上安装应用程序？

> ID：16007484
> 
> 赞同：0
> 
> 时间：2013-04-15T04:04:52.700
> 
> 标签：windows, installation, driver, block

现在，我有一个解决方案：

*   我使用驱动程序来监视任何即将执行的进程。当驱动程序检测到这一点时，它会将进程信息（例如：*.exe）发送到用户模式应用程序。
*   然后，该应用程序将检查该 *.exe 文件的“产品名称”信息。如果“产品名称”是常见的软件安装程序之一，例如：InstallShield、WiX...，用户模式应用程序将调用驱动程序来阻止它。

我的问题是：有没有更好的方法来做到这一点？

# vb.net - ClickOnce 部署到 Web 服务器 - 仅在线提供

> ID：16007486
> 
> 赞同：1
> 
> 时间：2013-04-15T04:05:10.630
> 
> 标签：vb.net, visual-studio-2010, webserver, clickonce, vb.net-2010

```
PLATFORM VERSION INFO
Windows                  : 6.1.7601.65536 (Win32NT)
Common Language Runtime  : 4.0.30319.296
System.Deployment.dll    : 4.0.30319.1 (RTMRel.030319-0100)
clr.dll                  : 4.0.30319.296 (RTMGDR.030319-2900)
dfdll.dll                : 4.0.30319.1 (RTMRel.030319-0100)
dfshim.dll               : 4.0.31106.0 (Main.031106-0000)

SOURCES
Deployment url           : http://apps4you.comyr.com/appTest8   /snake.application
Server                   : Apache

IDENTITIES
Deployment Identity      : snake.application, Version=1.0.0.6,  Culture=neutral, PublicKeyToken=5bd57d3abffa2377, processorArchitecture=x86

APPLICATION SUMMARY
* Online only application.
* Trust url parameter is set.

ERROR SUMMARY
Below is a summary of the errors, details of these errors are listed later in the log.
* Activation of http://apps4you.comyr.com/appTest8/snake.application resulted in exception. Following failure messages were detected:
    + Exception reading manifest from http://apps4you.comyr.com/appTest8 /Application%20Files/snake_1_0_0_6/snake.exe.manifest: the manifest may not be valid or  the file could not be opened.
    + Unexpected end of file has occurred. The following elements are not  closed: br, br. Line 3, position 254.

COMPONENT STORE TRANSACTION FAILURE SUMMARY
No transaction error was detected.

WARNINGS
There were no warnings during this operation.

OPERATION PROGRESS STATUS
* [15/04/2013 5:23:29 p.m.] : Activation of http://apps4you.comyr.com/appTest8/snake.application has started.
* [15/04/2013 5:23:31 p.m.] : Processing of deployment manifest has successfully completed.
* [15/04/2013 5:23:31 p.m.] : Installation of the application has started.

ERROR DETAILS
Following errors were detected during this operation.
* [15/04/2013 5:23:31 p.m.] System.Deployment.Application.InvalidDeploymentException (ManifestParse)
    - Exception reading manifest from http://apps4you.comyr.com/appTest8/Application%20Files/snake_1_0_0_6/snake.exe.manifest: the manifest may not be valid or the file could not be opened.
    - Source: System.Deployment
    - Stack trace:
        at    System.Deployment.Application.ManifestReader.FromDocument(String localPath, ManifestType manifestType, Uri sourceUri)
        at System.Deployment.Application.DownloadManager.DownloadApplicationManifest(AssemblyManifest deploymentManifest, String targetDir, Uri deploymentUri, IDownloadNotification notification, DownloadOptions options, Uri& appSourceUri, String& appManifestPath)
        at System.Deployment.Application.DownloadManager.DownloadApplicationManifest(AssemblyManifest deploymentManifest, String targetDir, Uri deploymentUri, Uri& appSourceUri, String& appManifestPath)
        at System.Deployment.Application.ApplicationActivator.DownloadApplication(SubscriptionState subState, ActivationDescription actDesc, Int64 transactionId, TempDirectory& downloadTemp)
        at System.Deployment.Application.ApplicationActivator.InstallApplication(SubscriptionState& subState, ActivationDescription actDesc)
        at System.Deployment.Application.ApplicationActivator.PerformDeploymentActivation(Uri activationUri, Boolean isShortcut, String textualSubId, String deploymentProviderUrlFromExtension, BrowserSettings browserSettings, String& errorPageUrl)
        at  System.Deployment.Application.ApplicationActivator.ActivateDeploymentWorker(Object state)
    --- Inner Exception ---
    System.Xml.XmlException
    - Unexpected end of file has occurred. The following elements are not closed: br, br. Line 3, position 254.
    - Source: System.Xml
    - Stack trace:
        at System.Xml.XmlTextReaderImpl.Throw(String res, String arg)
        at System.Xml.XmlTextReaderImpl.ParseElementContent()
        at System.Deployment.Application.ManifestValidatingReader.XmlFilteredReader.Read()
        at System.Deployment.Application.ManifestValidatingReader.XmlFilteredReader.Read()
        at System.Xml.XmlTextReaderImpl.Skip()
        at System.Deployment.Application.ManifestValidatingReader.XmlFilteredReader.Read()
        at System.Xml.XmlTextReaderImpl.Skip()
        at System.Deployment.Application.ManifestValidatingReader.XmlFilteredReader.Read()
        at System.Xml.XmlCharCheckingReader.Read()
        at System.Xml.XsdValidatingReader.Read()
        at   System.Deployment.Application.ManifestReader.FromDocument(String localPath, ManifestType manifestType, Uri sourceUri)

COMPONENT STORE TRANSACTION DETAILS
No transaction information is available. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:48:46.313

您的部署[URL](http://en.wikipedia.org/wiki/Uniform_resource_locator) **错误**。

根据：

> 激活 C:\Users\user\Downloads\snake.application 导致异常。检测到以下失败消息： + 部署和应用程序没有匹配的安全区域。

网址

```
file:///C:/Users/user/Downloads/snake.application 
```

应该

```
http://apps4you.comyr.com/appTest7/ 
```

所以浏览器通过清单知道应用程序部署在与发布者预期相同的位置并且没有被篡改。这是一个安全问题。

在[发布选项卡](http://msdn.microsoft.com/en-us/library/c37e68bc%28v=vs.80%29.aspx)中：

```
In the Installation URL field, enter the installation
location using a fully qualified URL using the format  http://www.microsoft.com/ApplicationName, or a
UNC path using the format \\Server\ApplicationName. 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-05-13T16:18:12.057

检查*[带回基本设置和部署项目类型 Visual Studio Installer](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3041773-bring-back-the-basic-setup-and-deployment-project-)*。

# git - 为什么 Git 版本控制没有更新远程位置的文件

> ID：16007487
> 
> 赞同：2
> 
> 时间：2013-04-15T04:05:27.183
> 
> 标签：git, networking, version-control

我遵循了 [如何从本地创建远程 Git 存储库？](https://stackoverflow.com/questions/6648995/how-to-create-a-remote-git-repository-from-a-local-one)

和这篇[文章](http://devlicio.us/blogs/krzysztof_kozmic/archive/2011/08/20/simple-guide-to-running-git-server-on-windows-in-local-network-kind-of.aspx)

我正在尝试为具有**windows 机器**的 3 名开发人员团队创建一个本地 Git 存储库。在白费了几个小时之后，我来到了这里。

**我的设置：**

我使用我的一个外部硬盘（K：带有共享的驱动器`\\xyz\gitRepo`）来共享存储库。C：开车去我当地的工作

测试版本控制。我创建了一个测试文件并提交并推送。

当我做

```
git push origin master 
```

我得到：

```
Eveything up-to-date 
```

信息。

但是当我手动查看文件夹中的远程驱动器内容时`\\xyz\gitRepo\myProject`，我没有发现我的新文件被复制。

我没有收到错误，所以不知道我在做什么错。有什么想法/建议吗？

如果还有其他这样的免费版本控制软件使用起来不那么痛苦，请告诉我。谢谢！

**更新：** 我收到以下错误，当我在阅读您的答案和评论后做了更多的摆弄时，现在我可以得到一些东西

顺便说一句：`y:\`是`\\xyz\gitRepo`我根据上面文章中的说明创建的网络图

```
Counting objects: 282, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (242/242), done.
Writing objects: 100% (281/281), 3.21 MiB, done.
Total 281 (delta 160), reused 0 (delta 0)
remote: error: unable to write sha1 filename ./objects/pack/pack-e7e1036deac5f7b032db6445f3071dd014076632.pack: Permissi
on denied
remote: fatal: cannot store pack file
error: unpack failed: index-pack abnormal exit
To file:///y:
 ! [remote rejected] master -> master (unpacker error)
error: failed to push some refs to 'file:///y:' 
```

我不知道它为什么要写 ./objects/pack 我认为它应该写在 \xyz\gitRepo\objects\pack 或 y:\objects\pack

`gitRepo`文件夹对每个人都有读/写权限。

我在 Windows 8 机器上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T04:16:52.193

如果您的远程仓库是“裸露的” - 它没有“工作区”。这意味着您的文件已提交到存储库并作为对象存储在那里。

要测试您是否推送实际工作，请检查推送前后远程仓库中“对象”目录的大小。如果您实际推送新文件，大小应该会增加。

为了有效地使用 Git，你必须对它的内部有一些了解。这是最好的来源之一：http: [//git-scm.com/book](http://git-scm.com/book)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T06:28:12.427

如上所述 - 一个裸仓库（通常是“远程”仓库）不显示任何文件。如果您想确保您的文件已添加，您可以简单地再次克隆您的项目并检查该文件。:-)

# python - Networkx，AttributeError：“模块”对象没有属性“all_simple_paths”

> ID：16007498
> 
> 赞同：1
> 
> 时间：2013-04-15T04:06:53.633
> 
> 标签：python, networkx

我是 python-networkx 的新用户，当我[在这里尝试 all_shortest_paths 函数时，它以某种方式显示错误](http://networkx.lanl.gov/reference/generated/networkx.algorithms.shortest_paths.generic.all_shortest_paths.html#networkx.algorithms.shortest_paths.generic.all_shortest_paths)

ps：我已经将networkx更新到最新版本

```
>>> import networkx as nx
>>> print nx.__version__
1.7
>>> G = nx.complete_graph(4)
>>> print nx.all_simple_paths(G, source=0, target=3, cutoff=2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'all_simple_paths' 
```

谢谢！该软件包似乎安装得很好，我尝试的其他功能没有这个问题。

```
>>> print  help(nx)

NAME
    networkx

FILE
    /Library/Frameworks/Python.framework/Versions/7.2/lib/python2.7/site-packages/networkx/__init__.py

DESCRIPTION
    NetworkX
    ========

        NetworkX (NX) is a Python package for the creation, manipulation, and
        study of the structure, dynamics, and functions of complex networks.

        https://networkx.lanl.gov/

    Using
    -----

        Just write in Python 
```

# sql-server - 多个字段的 ISNULL/COALESCE

> ID：16007503
> 
> 赞同：1
> 
> 时间：2013-04-15T04:07:09.677
> 
> 标签：sql-server, tsql, join, coalesce

考虑以下数据模型：

***顾客***

```
CustNum | First Name | Last Name
  555        John         Doe 
```

***客户地址***

```
CustNum | ShippingAddress|     Line1      |  Line2  |   City  | State |  Zip    
  555   |     ADD1       |   333 A Dr.    | Apt. 10 | Dallas  |  TX   | 11345  
  555   |     ADD2       |   111 B St.    |  NULL   | Miami   |  FL   | 22222
  555   |     WXYZ       |  123 Main St.  |  NULL   | Detroit |  MI   | 99998 
```

***订单头***

```
OrdNum | CustNum | OrderTotal |     Line1     | Line2 |   City  | State|  Zip
 1000  |   555   |   67.00    | 123 Main St.  | Ste 1 | Detroit |  MI  | 99998 
```

***订单行***

```
OrderNo  | Item  |  Price  | ShippingAddress  
 1000    | X123  |  32.00  |     ADD1
 1000    | Y234  |  25.00  |     ADD2
 1000    | ZZZZ  |  10.00  |     NULL 
```

客户和客户地址之间存在一对多的关系。
每个 OrderHeader，而不是与 CustomerAddresses 表的关键关系，将用于运送的地址存储在 Line1、Line2、City、State 和 Zip 字段中。
此外，可以在 OrderLine 表中选择一个送货地址来覆盖 OrderHeader 中存储的地址。
我正在尝试提出一个查询以返回以下格式的数据，以生成邮件标签列表：
***MailingLabels***

```
OrderNo  | Item  |     Line1      |  Line2  |   City  | State |  Zip     
 1000    | X123  |   333 A Dr.    | Apt. 10 | Dallas  |  TX   | 11345
 1000    | Y234  |   111 B St.    |  NULL   | Miami   |  FL   | 22222
 1000    | ZZZZ  |  123 Main St.  |  NULL   | Detroit |  MI   | 99998 
```

基本上，如果 OrderLine 记录有 ShippingAddress 值，我想从 CustomerAddresses 表中返回相应的地址。
如果它为 NULL，那么我想返回存储在 OrderHeader 表中的 Line1、Line2、City、State 和 Zip 值。
问题是，当我使用 COALESCE 或 ISNULL 时，可能会返回不正确的结果。这是我的查询：

```
SELECT OH.OrderNo, Item, ISNULL(CA.Line1, OH.Line1), ISNULL(CA.Line2, OH.Line2),  
       ISNULL(CA.City, OH.City), ISNULL(CA.State, OH.State), ISNULL(CA.Zip, OH.Zip)
FROM   OrderHeader OH
JOIN   OrderLine OL
ON     OH.OrderNo = OL.OrderNo
LEFT JOIN   CustomerAddress CA
ON     OL.CustNum = CA.CustNum
AND    OL.ShippingAddress = CA.ShippingAddress 
```

使用上面的查询，如果为 OrderHeader 定义了 Line2 字段，但在 OrderLine 中定义了 ShippingAddress，则可以为 Y234 项目返回混合地址：

```
OrderNo | Item |   Line1   |  Line2  |   City  | State |  Zip            
1000    | Y234 | 111 B St. |  Ste 1  |  Miami  |  FL   | 22222 
```

请注意，Ste 1 不是 OrderLine 中表示的地址的一部分，它实际上是 OrderHeader 的一部分。
如何编写查询以以所需的方式返回数据？非常感谢任何和所有帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T06:45:30.710

不幸的是，我想不出一种简洁的方法来做到这一点，而不会非常重复。

假设`OL`别名应该是`CA`：

```
SELECT OH.OrderNo, Item,
       CASE WHEN OL.ShippingAddress IS NULL THEN OH.Line1 ELSE CA.Line1 END,
       CASE WHEN OL.ShippingAddress IS NULL THEN OH.Line2 ELSE CA.Line2 END,
       CASE WHEN OL.ShippingAddress IS NULL THEN OH.City ELSE CA.City END,
       CASE WHEN OL.ShippingAddress IS NULL THEN OH.State ELSE CA.State END,
       CASE WHEN OL.ShippingAddress IS NULL THEN OH.Zip ELSE CA.Zip END
FROM   OrderHeader OH
JOIN   OrderLine OL
ON     OH.OrderNo = OL.OrderNo
LEFT JOIN   CustomerAddress CA
ON     OL.CustNum = CA.CustNum
AND    OL.ShippingAddress = CA.ShippingAddress 
```

# python - 具有列表参数的映射函数

> ID：16007504
> 
> 赞同：0
> 
> 时间：2013-04-15T04:07:09.883
> 
> 标签：python, python-2.7

我正在尝试为列表列表创建自定义转换。我正在尝试对子列表运行算术运算，但我没有成功。这是我的代码：

```
def my_transform(seq):
    new_seq = []
    new_seq[0] = seq[0] + 100
    new_seq[1] = seq[1] - 1
    new_seq[2] = seq[2] * seq[2]
    return new_seq

my_list = [[1,2,3], [4,5,6]]

new_list = map(my_transform, my_list) # error
# ideal output:
#[[101,1,9], [104,4,36]] 
```

但我收到以下错误：

```
Traceback (most recent call last):
File "<pyshell#9>", line 1, in <module>
map(my_transform,my_list)
File "<pyshell#7>", line 3, in my_transform
new_seq[0] = seq[0] + 100
IndexError: list assignment index out of range 
```

我也试过：

```
[my_transform(L) for L in my_list] 
```

这也给了我同样的错误。如何使用地图和/或列表理解获得结果？谢谢！

保罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T04:10:40.987

问题出在你的功能上。

`new_seq[0]`试图引用列表的第一个元素，但它不存在，所以它给出了错误。为了解决这个问题，我们可以制作`new_seq`原始列表的长度，或者使用`append`，但更简单的解决方案是更改函数，使其根本不使用中间列表。

```
def my_transform(seq):
    return [seq[0] + 100, seq[1] - 1, seq[2] * seq[2]] 
```

如果我们尝试这个功能，我们可以看到它有效。

```
>>> my_list = [[1,2,3], [4,5,6]]
>>> map(my_transform, my_list)
[[101, 1, 9], [104, 4, 36]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T04:09:31.017

问题是你的新列表一开始是空的，这就是为什么你在尝试访问不存在的项目时遇到索引错误的原因，我用占位符填充它`0`来解决这个问题：

```
>>> my_list = [[1,2,3], [4,5,6]]
>>> def my_transform(seq):
        new_seq = [0] * len(seq)
        new_seq[0] = seq[0] + 100
        new_seq[1] = seq[1] - 1
        new_seq[2] = seq[2] * seq[2]
        return new_seq

>>> map(my_transform, my_list)
[[101, 1, 9], [104, 4, 36]] 
```

或者，您可以初始化为这样的副本`seq`：

```
new_seq = list(seq) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T04:11:10.457

这是因为元素 0、1 和 2 是不防御的，你可以写

```
def my_transform(seq):
    new_seq = []
    new_seq.append(seq[0] + 100)
    new_seq.append(seq[1] - 1)
    new_seq.append(seq[2] * seq[2])
    return new_seq 
```

# bison - 为什么返回值不止一个token？

> ID：16007505
> 
> 赞同：0
> 
> 时间：2013-04-15T04:07:16.083
> 
> 标签：bison, yacc, lex, flex-lexer

我想返回 DOLLARID($foo) 和 DOTID(.foo)，所以我写了一条规则（我的 lex 文件的代码片段）：

```
ID  ([_a-zA-Z]+[a-zA-Z0-9_\-]*)
DOLLAR ("$"|("$!"))
DOT "."
%x DIRECTIVE REFERENCE
%%

[^#$]*?/"$" {BEGIN REFERENCE;yylval.string = yytext;printf("==========begin reference flex content===content:%s=====\n",yytext);return CONTENT;}
[^$#]*?/"#" {BEGIN DIRECTIVE;yylval.string = yytext; return CONTENT;}
<REFERENCE,DIRECTIVE>{DOLLAR}{ID} {yylval.string = yytext;printf("==========flex    content===ID:%s=====\n",yytext);return DOLLARID;}
<REFERENCE,DIRECTIVE>{DOT}{ID} {yylval.string = yytext;printf("==========flex content===DOTID:%s=====\n",yytext);return DOTID;} 
```

我的 yacc 文件的代码片段：

```
set:SET PARENTHESIS reference EQUAL expression CLOSE_PARENTHESIS { $$ = set_directive($3,$5); }
;
reference: DOLLARID {printf("reference ---Id,key:%s\n",$1);$$ = reference($1);}
|DOLLARID DOTID {printf("reference ---dotId\n");$$ = reference($2);}
; 
```

我写了一个测试文件 test.vm

```
#set($arr = [1..5])
#set($hell = "sinory")
$hell
$arr 
```

当我运行它时，部分结果是：

![](https://i.stack.imgur.com/3ela2.png)

第 1 行是 lexer 打印的，没错

第 2 行由野牛打印，超过两个字符（`" ="`）

因为flex需要的不仅仅是token？</p>

我不知道为什么？请帮我解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:23:03.883

问题是它`yytext`仅对单个令牌有效，并且将被下一次读取的令牌覆盖或以其他方式修改。所以返回一个指向它的指针通常是行不通的——它会有一段时间的标记文本，但稍后会从你下面改变。`yytext`如果您想在解析器中实际使用它的值，您需要制作字符串的副本。

更改要使用的词法分析器代码`yylval.string = strdup(yytext);`，事情会更好地工作（尽管那时您需要担心释放字符串以避免泄漏内存）。

# sql - 创建查询以在“连接”表中查找匹配对象

> ID：16007509
> 
> 赞同：1
> 
> 时间：2013-04-15T04:07:31.463
> 
> 标签：sql, postgresql, query-optimization, jointable

我试图找到一个有效的查询来查找“连接”表中的所有匹配对象。

`Adopter`给定一个有 many的对象`Pets`，并且通过连接表`Pets`有很多。我怎么能找到所有相同的？`Adopters``AdopterPets``Adopters``Pets`

架构相当规范化，看起来像这样。

```
TABLE Adopter
  INTEGER id

TABLE AdopterPets
  INTEGER adopter_id
  INTEGER pet_id

TABLE Pets
  INTEGER id 
```

现在，我正在使用的解决方案遍历所有`Adopters`内容，并在我们有匹配项时随时询问他们的宠物并将其存储起来，以后可以使用它，但我确信必须有更好的使用 SQL 的方法。

我看过的一个 SQL 解决方案是，`GROUP BY`但它似乎不是解决这个问题的正确技巧。

### 编辑

为了解释更多我正在寻找的东西，我将尝试举一个例子。

```
+---------+ +------------------+ +------+
| Adptors | | AdptorsPets      | | Pets |
|---------| +----------+-------+ |------|
| 1       | |adptor_id | pet_id| | 1    |
| 2       | +------------------+ | 2    |
| 3       | |1         | 1     | | 3    |
+---------+ |2         | 1     | +------+
            |1         | 2     |
            |3         | 1     |
            |3         | 2     |
            |2         | 3     |
            +------------------+ 
```

当您询问任何其他`Adopter`具有相同内容`id`的人时，您将被退回。`1``Adopters``Pets``id 3`

如果你问与你相同的问题，`Adopter`你会得到.`id``3``id 1`

如果您再次询问`Adopter with` id 2` 的相同问题，您将一无所获。

我希望这有助于澄清问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:08:37.633

谢谢大家的帮助，我使用了一些东西的组合：

```
 SELECT adopter_id
  FROM (
    SELECT adopter_id, array_agg(pet_id ORDER BY pet_id)
    AS pets
    FROM adopters_pets
    GROUP BY adopter_id
  ) AS grouped_pets
  WHERE pets = array[1,2,3]  #array must be ordered
  AND adopter_id <> current_adopter_id; 
```

在子查询中，我得到了由他们的采用者分组的 pet_ids。pet_ids 的顺序是关键，因此主查询中的结果将不依赖于顺序。

在主查询中，我将子查询的结果与我要匹配的采用者的宠物 ID 进行比较。出于此答案的目的，特定采用者的 pet_id 由 [1,2,3] 表示。然后我确保我所比较的采用者不包含在结果中。

让我知道是否有人看到任何优化，或者是否有办法比较顺序无关紧要的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:38:48.943

我不确定这是否正是您正在寻找的，但这可能会给您一些想法。

首先，我创建了一些示例数据：

```
create table adopter (id serial not null primary key, name varchar );
insert into adopter (name) values ('Bob'), ('Sally'), ('John');

create table pets (id serial not null primary key, kind varchar);
insert into pets (kind) values ('Dog'), ('Cat'), ('Rabbit'), ('Snake');

create table adopterpets (adopter_id integer, pet_id integer);
insert into adopterpets values (1, 1), (1, 2), (2, 1), (2,3), (2,4), (3, 1), (3,3); 
```

接下来我运行了这个查询：

```
SELECT p.kind, array_agg(a.name) AS adopters
FROM pets p
JOIN adopterpets ap ON ap.pet_id = p.id
JOIN adopter a ON a.id = ap.adopter_id
GROUP BY p.kind
HAVING count(*) > 1
ORDER BY kind;

  kind  |     adopters     
--------+------------------
 Dog    | {Bob,Sally,John}
 Rabbit | {Sally,John}
(2 rows) 
```

在这个例子中，我为每只宠物创建了一个包含所有所有者的数组。该`HAVING count(*) > 1`条款确保我们只展示拥有共享所有者（超过 1 个）的宠物。如果我们忽略这一点，我们将包括不共享所有者的宠物。

**更新**

@scommette：很高兴你让它工作了！我在下面将您的工作示例重构为：

*   使用`@>`运算符。这将检查一个数组是否包含另一个避免需要显式设置顺序
*   将 grouped_pets 子查询移至 CTE。这不仅是解决方案，而且还巧妙地允许您过滤掉 current_adopter_id 并获取该 id 的宠物

您可能会发现将其包装在一个函数中会很有帮助。

```
WITH grouped_pets AS (
  SELECT adopter_id, array_agg(pet_id ORDER BY pet_id) AS pets
  FROM adopters_pets
  GROUP BY adopter_id
)
SELECT * FROM grouped_pets
WHERE adopter_id <> 3
  AND pets @> (
    SELECT pets FROM grouped_pets WHERE adopter_id = 3
  ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T11:00:49.120

```
--
-- Relational division 1.0
-- Show all people who own *exactly* the same (non-empty) set
-- of animals as I do.
--

        -- Test data
CREATE TABLE adopter (id INTEGER NOT NULL primary key, fname varchar );
INSERT INTO adopter (id,fname) VALUES (1,'Bob'), (2,'Alice'), (3,'Chris');

CREATE TABLE pets (id INTEGER NOT NULL primary key, kind varchar);
INSERT INTO pets (id,kind) VALUES (1,'Dog'), (2,'Cat'), (3,'Pig');

CREATE TABLE adopterpets (adopter_id integer REFERENCES adopter(id)
        , pet_id integer REFERENCES pets(id)
        );
INSERT INTO adopterpets (adopter_id,pet_id) VALUES (1, 1), (1, 2), (2, 1), (2,3), (3,1), (3,2);

        -- Show it to the world
SELECT ap.adopter_id, ap.pet_id
        , a.fname, p.kind
FROM adopterpets ap
JOIN adopter a ON a.id = ap.adopter_id
JOIN pets p ON p.id = ap.pet_id
ORDER BY ap.adopter_id,ap.pet_id;
SELECT DISTINCT other.fname AS same_as_me
FROM adopter other
        -- moi has *at least* one same kind of animal as toi
WHERE EXISTS (
        SELECT * FROM adopterpets moi
        JOIN adopterpets toi ON moi.pet_id = toi.pet_id
        WHERE toi.adopter_id = other.id
        AND moi.adopter_id <> toi.adopter_id
                -- C'est moi!
        AND moi.adopter_id = 1 -- 'Bob'
        -- But moi should not own an animal that toi doesn't have
        AND NOT EXISTS (
                SELECT * FROM adopterpets lnx
                WHERE lnx.adopter_id = moi.adopter_id
                AND NOT EXISTS (
                        SELECT *
                        FROM adopterpets lnx2
                        WHERE lnx2.adopter_id = toi.adopter_id
                        AND lnx2.pet_id = lnx.pet_id
                        )
                )
        -- ... And toi should not own an animal that moi doesn't have
        AND NOT EXISTS (
                SELECT * FROM adopterpets rnx
                WHERE rnx.adopter_id = toi.adopter_id
                AND NOT EXISTS (
                        SELECT *
                        FROM adopterpets rnx2
                        WHERE rnx2.adopter_id = moi.adopter_id
                        AND rnx2.pet_id = rnx.pet_id
                        )
                )
        )
        ; 
```

结果：

```
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "adopter_pkey" for table "adopter"
CREATE TABLE
INSERT 0 3
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "pets_pkey" for table "pets"
CREATE TABLE
INSERT 0 3
CREATE TABLE
INSERT 0 6
 adopter_id | pet_id | fname | kind 
------------+--------+-------+------
          1 |      1 | Bob   | Dog
          1 |      2 | Bob   | Cat
          2 |      1 | Alice | Dog
          2 |      3 | Alice | Pig
          3 |      1 | Chris | Dog
          3 |      2 | Chris | Cat
(6 rows)

 same_as_me 
------------
 Chris
(1 row) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T04:32:13.820

如果您使用的是 Oracle，那么`wm_concat`这里可能会很有用

```
select pet_id, wm_concat(adopter_id) adopters
from AdopterPets
group by pet_id ; 
```

# mysql - 创建查询时的 SQL 语法错误

> ID：16007511
> 
> 赞同：2
> 
> 时间：2013-04-15T04:07:49.397
> 
> 标签：mysql, create-table

当我在 phpMyAdmin 和 Sequel 上运行以下查询时，出现以下错误

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的“id Int UNSIGNED NOT NULL AUTO_INCREMENT, login Char(128) NOT NULL, passw”附近使用正确的语法。

我无法弄清楚这个查询的错误。Mysql 运行在 5.5.25 版本上。

```
CREATE TABLE user
(
  id Int UNSIGNED NOT NULL AUTO_INCREMENT,
  login Char(128) NOT NULL,
  password Char(128) NOT NULL,
  emailaddress Char(128),
  alternateemailaddress Char(128),
  officephone Char(20),
  officefax Char(20),
  mobilephone Char(20),
  client Int UNSIGNED,
  facility Int UNSIGNED,
  user_status Int UNSIGNED NOT NULL DEFAULT 0,
  valid_from Datetime NOT NULL,
  valid_to Datetime NOT NULL,
  last_login Datetime,
  last_login_from Char(48),
  modified_by Int NOT NULL,
  modified_time Datetime,

  PRIMARY KEY (id),
  FOREIGN KEY client REFERENCES client (id) ON DELETE CASCADE,
  FOREIGN KEY facility REFERENCES facility (id) ON DELETE CASCADE

 ) ENGINE = InnoDB
  AUTO_INCREMENT = 0
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:39:50.997

这对我有用。
查看我成功[的 SQLFiddle](http://sqlfiddle.com/#!2)

我怀疑您的输入中有一些奇怪的空白字符，也许是制表符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:30:38.140

在编写表和字段的名称时应该使用 backsticks 以避免 MySQL 将其解析为保留关键字。您还应该使用括号包裹您的外键名称。工作查询应如下所示：

```
CREATE TABLE `user`
(
  `id` Int UNSIGNED NOT NULL AUTO_INCREMENT,
  `login` Char(128) NOT NULL,
  `password` Char(128) NOT NULL,
  `emailaddress` Char(128),
  `alternateemailaddress` Char(128),
  `officephone` Char(20),
  `officefax` Char(20),
  `mobilephone` Char(20),
  `client` Int UNSIGNED,
  `facility` Int UNSIGNED,
  `user_status` Int UNSIGNED NOT NULL DEFAULT 0,
  `valid_from` Datetime NOT NULL,
  `valid_to` Datetime NOT NULL,
  `last_login` Datetime,
  `last_login_from` Char(48),
  `modified_by` Int NOT NULL,
  `modified_time` Datetime,

  PRIMARY KEY (`id`),
  FOREIGN KEY (`client`) REFERENCES `client` (`id`) ON DELETE CASCADE,
  FOREIGN KEY (`facility`) REFERENCES `facility` (`id`) ON DELETE CASCADE

 ) ENGINE = InnoDB
  AUTO_INCREMENT = 0
; 
```

# apache-pig - 使用 group by 和 MAX 函数的 Pig Latin 查询

> ID：16007513
> 
> 赞同：-2
> 
> 时间：2013-04-15T04:07:57.480
> 
> 标签：apache-pig

给定表格：

```
Place(name, province, population, mayorid) 
```

您将如何用 Pig Latin 编写以下查询？为每个省返回人口最多的地方。您的结果集应该包含省名、地名和该地的人口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:50:13.447

没有测试过这个，但类似

```
places = LOAD 'placesInput' AS (name, province, population, mayorid);
placesProjected = FOREACH places GENERATE name,province,population;
placesGrouped = GROUP placesProjected by province;
biggestPlaces = FOREACH placesGrouped {
    sorted = ORDER placesProjected by population DESC;
    maxPopulation = LIMIT sorted 1;
    GENERATE group as province, FLATTEN(maxPopulation.name) as name, FLATTEN(maxPopulation.population) as population;
}; 
```

应该工作。

# php - 如果不存在问题，则向表中的 INT 添加一个

> ID：16007516
> 
> 赞同：2
> 
> 时间：2013-04-15T04:08:10.967
> 
> 标签：php, mysql

（这是我的第一个问题，如果我做错了什么，很抱歉）

所以我正在尝试编写一个锦标赛积分榜程序。这个想法是通过一个表格提交 12 名玩家及其位置，然后如果该人*尚未在表中，**则*在数据库中创建一行，如果在表中，则将其添加到相应的列中。这是适用的代码：

```
 for($i = 1; $i < 14; $i++) {
        $g = $i - 1;
        $fields = array('first', 'second', 'third', 'fourth', 'lose', 'tie');
        $array[$g] = array($_GET['nameplayer' . $i], $_GET['placementplayer' . $i]); //Because there are 12 people, I used a for-loop for selecting player # hence the $array[$g]. It is  being filled with the name and placement

        //Insert Player Name
        if($array[$g][0] != "") {
            $k = $array[$g][0]; //Name of the person
            $z = $_GET['tournyname'];
            $t = $array[$g][1]; //Placement of the person (can be 1, 2, 3, 4, tie or lose)

        $checkme = mysql_query("SELECT * FROM tournamentstandings WHERE name = '$k' AND tournyname = '$_GET[tournyname]'")or die(mysql_error()); //Getting the specific row for the guy I wanna add +1 to

        if($t != "Tie" && $t != "Loss") { //Defining $y which is the field name for where the +1 should go
            $y = $fields[$t - 1];
        } else if ($t == "Tie") {
            $y = $fields[5];
        } else if ($t == "Loss") {
            $y = $fields[4];
        }

            if (mysql_num_rows($checkme)){
                $qone = mysql_query("SELECT $y FROM tournamentstandings WHERE name = '$k' AND tournyname = '$_GET[tournyname]'");
                    while($query = mysql_fetch_array($qone)) {
                        echo "updated";
                        mysql_query("UPDATE tournamentstandings SET $y = '$qone[$y] + 1' WHERE name = '$k' AND tournyname = '$z'") or die(mysql_error()); //THIS IS THE TROUBLE LINE
                    }
            }
            else if($y == "first" && !mysql_num_rows($checkme)) {
                mysql_query("REPLACE INTO tournamentstandings(name, first, tie, second, third, fourth, lose, tournyname, totalplayed, totalpoints, pointspergame, winpercentage) VALUES('$k', '1', '0', '0', '0', '0', '0', '$z', '0', '0', '0', '0')")or die(mysql_error()); //Does the exact same thing but for $y == "second" and so on inserting 1 if the row does not already exist
            } 
```

所以问题是，有时当我添加一个新播放器时，它会变成 3 而不是 1，这意味着调用了“故障线”但没有显示“更新”（回显），这很奇怪。如果我注释掉该行，它可以正常工作，但如果该行已经存在，则不会添加 +1

所以表明智的假设有人提交了 12 个名字；name1（第一名），name2（第二名），name3（第三名），name4（第四名），name5（输）... name 12（输）并且这些都不存在于 tournyname FFA（可以是 FFA、1 Ally、2 Ally，6v6，您可以在表格中指定）

它应该是 ：

```
name | first     | tie     | second     | third     | fourth     | lose     | tournyname
name1|  1        |  0      |  0         |   0       |   0        |  0       |     FFA
name2|  0        |  0      |  1         |   0       |   0        |  0       |     FFA
name3|  0        |  0      |  0         |   1       |   0        |  0       |     FFA
name4|  0        |  0      |  0         |   0       |   1        |  0       |     FFA
name5|  0        |  0      |  0         |   0       |   0        |  1       |     FFA 
```

等等

但正在发生的是：

```
name | first     | tie     | second     | third     | fourth     | lose     | tournyname
name1|  3        |  0      |  0         |   0       |   0        |  0       |     FFA
name2|  0        |  0      |  3         |   0       |   0        |  0       |     FFA
name3|  0        |  0      |  0         |   2       |   0        |  0       |     FFA
name4|  0        |  0      |  0         |   0       |   1        |  0       |     FFA
name5|  0        |  0      |  0         |   0       |   0        |  1       |     FFA 
```

或者像前三个坏了，最后几个没问题的那种随机的东西。当我稍后尝试更新它时（只需将一个添加到现有行，它就可以正常工作。这只是最初的提交。我已经尝试了一段时间来弄清楚它是什么但我不知道。我试过了：

1.  使用 REPLACE 更改查询
2.  将for循环运行的次数限制为提交的条目数（不一定是12，可以是1-12
3.  添加 AUTO_INCREMENT id
4.  主键更改

和一大堆玩选择查询等。我缺少什么小东西吗？:) 如果我遗漏了你们需要的东西，请告诉我！

非常感谢！

插入的问题图片 ::

![不应该是3或2！ 应该是1！](https://i.stack.imgur.com/O7Lmx.png)

所有的红框表示第三批 12 所有黑框表示错误。这些数字应该是 1，因为在我提交表单之前，这些行不存在。所有名称都是唯一的，因此该图片中的任何内容都不应超过一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:38:02.857

如果您将 SQL 调用推送到数据库中的存储过程，这可能会简化您的工作，然后您可以将 SQL 与应用程序代码分开测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:38:44.617

您可以使用[**insert...on duplicate key update**](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)代替首先搜索值然后更新值。它将 MySQL 操作减少为单个查询，并且还必须解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:55:14.913

```
while($query = mysql_fetch_array($qone)) {
    echo "updated";
    $val=$query["$y"]+1;
    mysql_query("UPDATE tournamentstandings SET $y = '$val' WHERE name = '$k' AND tournyname = '$z'") or die(mysql_error()); //THIS IS THE TROUBLE LINE
                    } 
```

# testng - TestNG 测试未并行运行

> ID：16007530
> 
> 赞同：0
> 
> 时间：2013-04-15T04:10:23.973
> 
> 标签：testng

我对这个问题感到沮丧。我有 3 个节点在多个浏览器上运行，并且网格启动良好。然后我有一个测试套件，其中包含 3 个测试，每个测试中有多个测试。当我执行测试时，三个浏览器被占用，但一段时间后，第一个节点中只有一个浏览器保持被占用，其他两个节点保持空闲。这是我的设置代码

```
public void setUpEagle() throws Exception {
        DesiredCapabilities cap = DesiredCapabilities.firefox();
        cap.setBrowserName("firefox");
        cap.setPlatform(Platform.ANY);          
        ffdriver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), cap);

        eagleLogin = new EagleLogin();
        LaunchEagle launchEagle = new LaunchEagle();
        driver = launchEagle.setUp(eagleLogin, LP1_GeneralManager, NonProductionPassword);

        // Print the Class Name
        System.out.println("Test Starting: " + this.getClass().getName());

        menuItem = new MenuItems();
        menu = new Menu();

        verify = new Verify();
    }

//testng.xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd">

<suite name="MRS_TestNGSuites1" verbose="10" parallel="tests" thread-count="30">    

<test name="mrs_testsuite1" junit="true">
    <classes> 
        <class    name="com.squaretwo.eagle.smoketests.noninvasive.AccountAssignmentTestNI"/>                   
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountCommentPODDataVerifyTest"/>
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountDebtorPODAddressDataVerifyTest"/>
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountDebtorPODEmailDataVerifyTest"/>
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountDebtorPODPhoneDataVerifyTest"/>
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountDebtorPODPInfoDataVerifyTest"/>              
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountDebtorTearOffTest"/>
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountFinancialPODDataVerifyTest"/>
    </classes>
 </test>

 <test name="mrs_testsuite2" junit="true"> 
    <classes> 

        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountHeaderViewTest"/>
        <class name="com.squaretwo.eagle.test.accounts.AccountID_CTC_US5211Test"></class>                                       
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountNotelineDataVerifyTest"/>                                    
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountNotelineTearOffTest"/>       
        <class name="com.squaretwo.eagle.test.accounts.Account_ReOpen_And_CancelTimTest"/>          
        <class name="com.squaretwo.eagle.smoketests.noninvasive.PerformanceLegalAccountSearchTest"/>                                    
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AdvDebtorsLifecycleCancelledTest"/>                     
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AdvSearchAcctNumberTest"/>  
    </classes>
 </test>
 <test name="mrs_testsuite3" junit="true"> 
    <classes>                       
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AdvSearchLifecycleCancelledTest" />                 
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AdvSearchMultipleCriteriaTest" />                                       
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AdvSearchSaveCriteriaTest" />                                       
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountPODDataVerifyTest" />
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountPODMediDataVerifyTest" />                    
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountStatusPODDataVerifyTest" />                  
        <class name="com.squaretwo.eagle.smoketests.noninvasive.AccountsTouchedReportTest" />
        <class name="com.squaretwo.eagle.test.accounts.AddPaymentPlanArrangement" /> 
    </classes>
 </test> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-21T12:47:37.820

您的套件 xml 中有 parallel=tests，其中只有 3 个测试（`<test>`）。所以你实际上一次运行不超过 3 个浏览器。你`<test>`的一个运行时间比其他两个长，这就是为什么“一段时间后，第一个节点中只有一个浏览器保持被占用，而其他两个节点保持空闲”。

# java - 如何创建可执行的jar文件夹？

> ID：16007531
> 
> 赞同：2
> 
> 时间：2013-04-15T04:10:28.987
> 
> 标签：java, jar, heap-memory, executable

我正在尝试创建一个用户只需单击并执行代码的可执行 jar 文件。我做了一些研究，但几乎所有的例子都是针对单个文件的。我目前在一个文件夹中的文件中使用了我所有的类和图像。我的图像超出了默认的 java 内存空间，因此我必须使用`-Xmx500m`.

如何创建一个可执行的 jar 文件，该 jar 文件将进入我的文件夹并从那里运行我的程序？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:19:49.910

> 我正在尝试创建一个用户只需单击并执行代码的可执行 jar 文件

使用[Java Web Start](https://stackoverflow.com/tags/java-web-start/info)来部署它。

将所有图像和其他媒体放入启动文件中提到的 Jar 文件中，它们将在需要时下载。JWS 还具有调整分配给应用程序的内存的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:41:45.413

我建议使用[https://netbeans.org/](https://netbeans.org/%22NetBeans%22)来构建您的项目。一旦构建，它将为您创建 jar。您还可以设置编译设置，例如您需要的 ram 数量。

请参阅以下说明[https://netbeans.org/kb/docs/java/quickstart.html#build](https://netbeans.org/kb/docs/java/quickstart.html#build)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:13:06.983

只需使用 jar 命令创建 jar。您可能需要将这种类型的文件链接到 Java，以便可以通过在 Windows 中单击它来运行它。像这样的东西-

```
jar cvf test.jar <path to your classes / resources> 
```

# javascript - 使用带有 Javascript 的“this”删除 div

> ID：16007533
> 
> 赞同：0
> 
> 时间：2013-04-15T04:10:41.533
> 
> 标签：javascript, html, this

我想做的是通过单击一个按钮来创建一个 div。在该 div 中，如果单击将删除另一个按钮，它将删除它所在的 div。因此，第一个按钮可能会创建许多带有此删除按钮的 div，但我希望删除按钮仅删除它所在的 div。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:18:55.380

HTML:

```
<input type="button" id='create' value="Create div!"/> 
```

JS:

```
var i = 0;
document.onclick = function(e) {
    var t = e.target;
  if(t.id == 'create'){
     t.parentNode.innerHTML += '<div>I AM A CHILD '+(++i)+' <input type="button" class="child" value="DELETE ME!"/><br/></div>';
    }
  if (t.className == 'child') {
    t.parentNode.outerHTML = '';
  }
}; 
```

using document.onclick and detecting the target element can be used as a live click to monitor newly created divs.

Its early and my brain may be a little foggy and the code may be a little dirty

Here is a **[jsfiddle](http://jsfiddle.net/KZm9u/10/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:26:17.780

如果您不需要在页面上保留“删除按钮”，请将`click`事件绑定在每个页面上，并`.removeChild`在父 div 的父元素上使用。
[**小提琴演示**](http://jsfiddle.net/KZm9u/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:56:19.427

您可以执行以下操作：

```
<script>

var addDiv = (function() {
  var div = document.createElement('div');
  div.appendChild(document.createTextNode('some text'));

  var button = document.createElement('button');
  button.appendChild(document.createTextNode('Remove...'));
  button.type = "button";

  return function() {
    var d = div.cloneNode(true);
    var b = button.cloneNode(true);
    b.onclick = function() {
      var d = this.parentNode;
      d.parentNode.removeChild(d);
    };
    d.appendChild(b);
    document.body.appendChild(d);
  };
}())

</script>

<button onclick="addDiv()">Add a div</button> 
```

上面只是一个简单的例子来演示一种方法。请注意，如果您克隆一个元素，则作为属性添加的侦听器或通过 addEventListener 添加的侦听器将被删除（如果不这样做，此脚本会简单得多）。

# php - 带有 PHP 工具的 Visual Studio 2012 - 调试问题/定位引用的 (CSS/JQuery) 文件

> ID：16007535
> 
> 赞同：0
> 
> 时间：2013-04-15T04:10:45.627
> 
> 标签：php, jquery, css, visual-studio-2012, reference

我目前正在使用 Visual Studio 2012 的 PHP 工具插件开发一个项目。

目前，我正在尝试调试一个试图链接到 CSS 文件的页面。当前页面上没有 PHP 脚本，因为我正在尝试设置基本模板并从那里构建。

例子：

```
<link rel="stylesheet" href="css/layout.css" type="text/css" media="screen" /> 
```

当我调试此页面时，会显示 HTML，但没有任何格式或图像。如果我将 CSS 直接粘贴到文件中，则格式将起作用。我也试图引用几个遭受同样问题的 jquery 文件。

当试图调试一个 php 页面时，它说... 生成一个 HTML 表单，验证数据，然后将信息传递到我的数据库中，我没有任何问题。

如果我制作了一个包含相同代码的 html 文件，然后只需右键单击打开方式 > Google Chrome，一切都会按预期运行/显示。

我已确保所有文件/文件夹与正在调试的文件位于同一目录中。

任何人都可以诊断这个问题吗？我需要在我的 VS2012 项目环境中正常工作。

TL;DR -- 带有 Visual Studio 2012 扩展的 PHP 项目。在调试时，页面将无法正确访问本地引用的图像、css 或脚本文件。帮助。

# while-loop - 由于用户在while循环中输入，如何继续分配变量？

> ID：16007536
> 
> 赞同：0
> 
> 时间：2013-04-15T04:10:49.520
> 
> 标签：while-loop

我正在尝试使用 while 循环来询问用户“他们上过的多个课程以及课程所持有的时间”，我需要将每个输入分配为不同的变量，即 Cal 2, 4 hours ENGL 101, 3 hours class1 = cal2，4 小时 class2 = ENGL101，3 小时

谢谢！

# php - 在 PHP 中使用动态表名执行 mySQL 查询

> ID：16007543
> 
> 赞同：-3
> 
> 时间：2013-04-15T04:11:13.003
> 
> 标签：php, phpmyadmin, mysqli, dynamic-sql

我有一个 android 应用程序，它将表名作为参数发送到 php 脚本以执行 mySQL 查询。问题是表名是一个参数（因此是动态的）。我尝试`{$table_name}`按照我在此处阅读的一些问题中的建议使用和反引号，但似乎没有任何效果。有人可以告诉这个问题的解决方案吗？

```
 <?php
    $dbhost = "localhost";
    $dbuser = "root";
    $dbpass = "mmm";
    $connect = mysql_connect($dbhost, $dbuser, $dbpass);
    $tabn= $_POST['tabn'];
    $dt=$_POST['dt'];
    $query="INSERT into $tabn VALUES('$dt')";
    $result = mysql_query($query);
    if($result)
    {
    $response["success"]=1;
    }
    else
    {
    $response["error"]=1;
    }
    echo json_encode($response);
    ?> 
```

php 脚本如上所示。我`error = 1`在 android LogCat 窗口中得到输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:14:42.220

地方

```
if(mysql_errno()){
   die(mysql_error());
} 
```

刚过

```
$result = mysql_query($query); 
```

它会告诉你 MySQL 错误。

**或者：**

```
if(mysql_errno()){
    $response["error"]   = 1;
    $response["message"] = mysql_error();
} else {
    $response["success"] = 1;
} 
```

代替：

```
if($result){
    $response["success"] = 1;
} else {
    $response["error"] = 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-31T10:22:44.977

```
$tablename = $_POST['gettable'];
$data='this is data you want to insert';
mysql_query("insert into `$tablename`(`data`) values('$data')"); 
```

```
$tablename 
```

它获取数据将插入的表的名称。

```
$data 
```

这是您要插入的数据。

当您想要在数据库中插入数据并且想要在一个查询中选择不同的表时。然后使用此查询，您可以在不同的表上插入数据。

# solr - 太阳黑子轨道中的数据导入处理程序

> ID：16007545
> 
> 赞同：2
> 
> 时间：2013-04-15T04:11:37.067
> 
> 标签：solr, dih

我在mysql中有一些表。我想使用数据导入处理程序导入一些数据并使用 Solr 索引这些数据。可能吗？。我看到我们需要从这个链接中对 data-config.xml 文件进行一些修改。[是否可以在 Sunspot Rails 中使用 DataImportHandler？](https://stackoverflow.com/questions/7183304/is-it-possible-to-use-dataimporthandler-in-sunspot-rails)

如果是这样，当我在执行此数据导入时执行 rails 应用程序时。因为使用 rails 应用程序，我相信无法提供 DIH 命令，例如 fullimport、deltaimport 等。

请帮我解决，因为我对 DIH 和 solr 之间的交互以及这些程序的流程有点困惑。

# java - 按日期排序路径 - 实用方法

> ID：16007546
> 
> 赞同：0
> 
> 时间：2013-04-15T04:11:47.583
> 
> 标签：java, sorting, path

某些包中是否有任何实用程序类，例如 commons-io、jodatime 等，其中可以传入如下列表：

```
March/Invoice - 00000020 - 01.03.2013.xls
March/Invoice - 00000021 - 08.03.2013.xls
April/Invoice - 00000025 - 05.04.2013.xls
January/Invoice - 00000015 - 25.01.2013.xls 
```

并按月份排序路径，例如：

```
January/Invoice - 00000015 - 25.01.2013.xls
March/Invoice - 00000020 - 01.03.2013.xls
March/Invoice - 00000021 - 08.03.2013.xls
April/Invoice - 00000025 - 05.04.2013.xls 
```

我们可能自己写一个`Comparator`，但我希望这样的东西已经存在于某个第三方库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:34:27.740

我相信这样的事情比搜索任何第三方库要好：

```
final Map<String, Integer> monthMap = new LinkedHashMap<String, Integer>();
// Initialize it with all the months and corresponding index like:
// (January,1), (February,2), etc...
monthMap.put("January", 1);
monthMap.put("February", 2);
monthMap.put("March", 3);
monthMap.put("April", 4);
monthMap.put("May", 5);
monthMap.put("June", 6);
monthMap.put("July", 7);
monthMap.put("August", 8);
monthMap.put("September", 9);
monthMap.put("October", 10);
monthMap.put("November", 11);
monthMap.put("December", 12);

Collections.sort(list, new Comparator<String>()
{
    @Override
    public int compare(String a, String b)
    {
        String first = a.substring(0, a.indexOf(File.separatorChar));
        String second = b.substring(0, b.indexOf(File.separatorChar));

        return monthMap.get(first).compareTo(monthMap.get(second));
    }
}); 
```

我相信还有比这更好的解决方案，它只是一个指针。

# layout - 使用 SSRS 代替 Crystal 报表来生成管理表单

> ID：16007547
> 
> 赞同：1
> 
> 时间：2013-04-15T04:11:51.113
> 
> 标签：layout, reporting-services, crystal-reports, report

我正在考虑升级 .net 2.0 应用程序。某个城市的公共当局使用该应用程序来跟踪费用并生成报告和表格。

报表和表单是在 VS2005 中使用 Crystal 报表生成的。它们遵循定义明确的布局，就像官方文档通常那样。

我正在寻找升级应用程序的选项，我遇到的主要问题是确定如何处理水晶报告文件。我已经成功升级到VS2008，但是之后的任何版本都没有CR了，所以我公司不得不单独购买CR，因为客户和我公司都很紧张，我正在寻找替代品......

显而易见的一个是使用 SSRS。我以前从未接触过它，但在玩了一会儿之后，我觉得它不太适合生成包含大量非表格内容和大量格式的表单。还是我错了？似乎每条线都必须单独绘制。没有（我能看到的）准确的定位线的方法来格式化......但我只是一个初学者，所以我可能把这一切都弄错了？

如果是这种情况，是否有任何其他替代 CR 和 SSRS？

我正在考虑在解决方案中可能有一个单独的 MVC 网站项目。让它使用来自我的实体模型的数据生成 html 和 css 布局，然后在（内置或非内置）Web 浏览器中查看结果。我在这方面过于复杂了吗？

我真的需要以前做过这种事情的人的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:32:17.180

SSRS 有什么好处：

1.  与 SQL Server 交谈，比其他产品快得多，因为它在许多情况下可以更好地保留数据库，而在其他程序恕我直言，他们有时会重复查询。
2.  从数据集中设计可折叠的网格和图表对象。您可以拥有可以嵌套折叠值聚合的“组”，并且可以根据表达式、参数或递归父集按需取消折叠或折叠。
3.  一种便于部署的 Web 服务，您可以在其中部署一个或多个对象。您还可以使用 C# 和 ReportingService.asmx Web 服务为此服务编写附加组件。
4.  您可以直接在 HTML 中的“表单”对象中与 Web 服务对话并操作它的输出。
5.  您可以安排报告通过电子邮件和文件自动保存发送给客户或内部用户。

什么 SSRS 不适合：

1.  除了参数之外，它几乎不是事件驱动的。您无法单击许多内容并获取表单本身的其他部分进行更新。您可以执行转到另一个位置、报告或站点的“操作”。但本质上你是在调用一个单独的对象，而不是再次调用同一个实例。
2.  多层报告。除了调整工具提示之外，如果不入侵 SSRS，您就无法进行“悬停”报告。您可以让 javascript 窗口显示其他报告，但它不会嵌入到 SSRS 中。因此，您要么单击新报表或报表中的制表位，但不会将鼠标悬停在工具提示中的文本和表达式之外的快速对象上。

在考虑你需要实施什么之前，你想要什么？

1.  我想在与我的数据库交谈时输入和导出内容——如果你想成为新手，可能会使用 HTML 5 或 MVC4 的 ASP.NET。ASP.NET 用于主动与服务器对话并接受命令 IN 和 OUT。

2.  我想要一个表单作为登陆站点和仪表板在页面上定期自动更新 - HTML、Java 或 ASP.NET 之上的 AJAX 和 Javascript。

3.  我想创建存在于服务器上的报告，并且可以通过 Web 服务调用 - SSRS 在 .NET 中的各种平台上托管。

SSRS 对我来说最大的卖点是它的可重用性，一旦你拨入一个报告。它们很容易创建，易于配置，易于部署，如果你在调用 web 服务方面有一点进步，你可以在其他地方获得 SSRS 报告对象如果你愿意，技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:51:49.600

有针对 VS2010 和 VS2012 的 Crystal 报告。它只是不随他们一起发货。您可以从这里下载安装：http: [//scn.sap.com/docs/DOC-7824](http://scn.sap.com/docs/DOC-7824)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T17:29:30.433

我目前正在经历相同的决策过程。有一家名为“Windward”的公司提供的 .NET 产品可让您在 Microsoft Office 中设计报表。如果您已经在 MS 生态系统中，或者希望您的用户设计报告而不是总是打电话给您，这可能会有所帮助。

他们的模板设计工具称为 AutoTag，您可以通过几行代码将这些模板部署到他们基于 .NET 的引擎中。

我知道问题是关于 SSRS 与 Crystal 的比较，但认为您应该知道还有其他选择，有些可以让生活更轻松

瑞安

# android - Android 使用 Intent 将事件添加到日历，获取 EventID

> ID：16007549
> 
> 赞同：7
> 
> 时间：2013-04-15T04:11:55.570
> 
> 标签：android, android-intent, calendar

我正在尝试通过日历意图添加事件。但是，我不知道如何获取刚刚添加的事件的事件 ID。

```
 Intent intent = new Intent(Intent.ACTION_EDIT);
        intent.setType("vnd.android.cursor.item/event");
        intent.putExtra("beginTime", sdate.getTime());
        intent.putExtra("endTime", edate.getTime());
        intent.putExtra("allDay", true);
        intent.putExtra("rrule", "FREQ=YEARLY");
        intent.putExtra("title", "A Test Event from android app");
        intent.putExtra("description", "Description here");
        intent.putExtra("eventLocation", "location here here here"); 
```

我广泛阅读了其他资源，但似乎找不到答案。我试过 startActivityForResult 但我似乎无法让它工作。在活动结束之前，我尝试的其他方法似乎无法检查它。

将事件添加到日历后，还有其他方法可以获取事件 ID 吗？我需要为此使用意图方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-25T10:28:52.240

试试这个解决方案：

```
import android.content.ContentResolver;
import android.content.ContentValues;
import android.net.Uri;

public class CalenderUtils {

/**
 * Add a new event into a native Google calendar. Add alert notification by setting <code>isRemind</code> as <code>true</code>.
 * @param cr - ContentResolver
 * @param title - Event title
 * @param addInfo - Event description
 * @param place - Event place
 * @param status -  <code>int</code> This information is sufficient for most entries: tentative (0), confirmed (1) or canceled (2):
 * @param startDate - <code>long</code> event start time in mls
 * @param isRemind - <code>boolean</code> need to remind about event before?
 * @param isMailService - <code>boolean</code>. Adding attendees to the meeting
 * @return <code>long</code> eventID
 */
public static long addEventToCalender(ContentResolver cr, String title, String addInfo, String place, int status,
        long startDate, boolean isRemind, boolean isMailService) {
    String eventUriStr = "content://com.android.calendar/events";
    ContentValues event = new ContentValues();
    // id, We need to choose from our mobile for primary its 1
    event.put("calendar_id", 1); 
    event.put("title", title);
    event.put("description", addInfo);
    event.put("eventLocation", place);
    event.put("eventTimezone", "UTC/GMT +2:00");

    // For next 1hr
    long endDate = startDate + 1000 * 60 * 60; 
    event.put("dtstart", startDate);
    event.put("dtend", endDate);
    //If it is bithday alarm or such kind (which should remind me for whole day) 0 for false, 1 for true
    // values.put("allDay", 1);
    event.put("eventStatus", status);
    event.put("hasAlarm", 1);

    Uri eventUri = cr.insert(Uri.parse(eventUriStr), event);
    long eventID = Long.parseLong(eventUri.getLastPathSegment());

    if (isRemind) {
        String reminderUriString = "content://com.android.calendar/reminders";
        ContentValues reminderValues = new ContentValues();
        reminderValues.put("event_id", eventID);
        // Default value of the system. Minutes is a integer
        reminderValues.put("minutes", 5); 
        // Alert Methods: Default(0), Alert(1), Email(2), SMS(3)
        reminderValues.put("method", 1); 
        cr.insert(Uri.parse(reminderUriString), reminderValues); //Uri reminderUri = 
    }
    if (isMailService) {
        String attendeuesesUriString = "content://com.android.calendar/attendees";
        /********* To add multiple attendees need to insert ContentValues multiple times ***********/
        ContentValues attendeesValues = new ContentValues();
        attendeesValues.put("event_id", eventID);
        // Attendees name
        attendeesValues.put("attendeeName", "xxxxx");
        // Attendee email
        attendeesValues.put("attendeeEmail", "yyyy@gmail.com");
        // Relationship_Attendee(1), Relationship_None(0), Organizer(2), Performer(3), Speaker(4)
        attendeesValues.put("attendeeRelationship", 0);
        // None(0), Optional(1), Required(2), Resource(3)
        attendeesValues.put("attendeeType", 0);
        // None(0), Accepted(1), Decline(2), Invited(3), Tentative(4)
        attendeesValues.put("attendeeStatus", 0);
        cr.insert(Uri.parse(attendeuesesUriString), attendeesValues); //Uri attendeuesesUri = 
    }

    return eventID;
}

} 
```

我从我的项目中复制粘贴了这个类，所以欢迎您根据需要更改名称。正如您在这里注意到的那样，您`id`在插入后会收到价值。

如果您需要获取`reminderId`或`id`与与会者会面 - 您必须处理来自`cr.insert...`然后 parce uri的返回值`long id = Long.parseLong(uri.getLastPathSegment());`

这是附加信息：[CalendarContract.Events](http://developer.android.com/reference/android/provider/CalendarContract.Events.html)和[Calendar 章节](http://android-developers.blogspot.com/2011/10/ics-and-non-public-apis.html)

# android - Android - 使用捏缩放缩放文本视图的字体大小

> ID：16007550
> 
> 赞同：1
> 
> 时间：2013-04-15T04:12:31.650
> 
> 标签：android, fonts, textview, zooming, scale

我正在尝试使用捏缩放手势缩放 TextView。我有捏缩放工作，但随着文本的缩放，它变得有些像素化。我认为这是因为实际字体大小没有缩放。但是，当我尝试将 setTextSize() 放在 onTouch() 方法中的任何位置时，它的缩放非常不稳定，TextView 边缘出现/消失的小线条，并且当​​缩放足够大时文本消失。我在 LinearLayout 中有 TextView，捏缩放缩放 LinearLayout。

这是布局xml：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#FF000000" >

<LinearLayout
    android:id="@+id/textLayout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="top"
        android:text="texthere" />

</LinearLayout>

<View
    android:id="@+id/touchView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />

</FrameLayout> 
```

这是触摸监听器java：

```
scaleView.setOnTouchListener(new View.OnTouchListener(){
        public boolean onTouch(View v, MotionEvent event){
            float viewWidth = mTextView.getWidth();
            float viewHeight = mTextView.getHeight();
            switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
                mode = DRAG;
                x_0 = mTextView.getX();//+50;
                y_0 = mTextiew.getY();//+50;
                initialTouchRawX = event.getRawX();
                initialTouchRawY = event.getRawY();
                currentScale = mTextView.getScaleX();
                break;
            case MotionEvent.ACTION_POINTER_DOWN:
                oldDist2 = spacing(event);
                if (oldDist2 > 10f) {
                    mode = ZOOM;
                }
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                break;
            case MotionEvent.ACTION_MOVE:
                float xmin = x_0 - viewWidth/2*(currentScale-1);
                float xmax = x_0 + viewWidth + viewWidth/2*(currentScale-1);
                float ymin = y_0 - viewHeight/2*(currentScale-1) + viewShift;
                float ymax = y_0 + viewHeight + viewHeight/2*(currentScale-1) + viewShift;
                if (mode == DRAG && initialTouchRawX >= xmin && initialTouchRawX <= xmax && initialTouchRawY >= ymin && initialTouchRawY <= ymax ) { 
                    float mShiftX = -(initialTouchRawX - x_0);
                    float mShiftY = -(initialTouchRawY - y_0);
                    mTextView.setX((float) event.getRawX()+mShiftX);
                    mTextView.setY((float) event.getRawY()+mShiftY);
                } else if (mode == ZOOM) {
                    float newDist2 = spacing(event);
                    if (newDist2 > 10f) {
                        newScale = newDist2 / oldDist2 * currentScale;
                        mTextView.setScaleX(newScale);
                        mTextView.setScaleY(newScale);
                        //***I've tried setting the font size here***
                    }
                }
                break;
            }
            //***I've tried setting the font size here***
            //*** Now I write the scaling float to shared preferences here
            return true; 
        }
    }); 
```

我对实际缩放字体大小的位置和方式感到困惑。我已经在代码中指出了我尝试实现 setFontSize() 的位置。我的意思是，它在大多数情况下确实有效，但就像我上面提到的那样，它的质量非常糟糕，文本消失了，而且线条有时会出现在 TextView 的边缘。非常感谢任何提示。

=== 编辑：===

我在下面实现了一个自定义 TextView：

```
public class ScaleTextView extends TextView {

public ScaleTextView(Context context) {
    this(context, null);
}

public ScaleTextView(Context context, AttributeSet attrs) {
    this(context, attrs, 0);
}

public ScaleTextView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    updateTextSize(context);
}

public void updateTextSize(Context context) {
    getTypeface();
    float currentTextSize = getTextSize();
    SharedPreferences otherSettings = context.getSharedPreferences("settings", 0);
    float newScale = otherSettings.getFloat("key_scaling", 1f);
    setTextSize(newScale * currentTextSize); 
}

} 
```

所以这在一定程度上有所帮助，只是现在纵向和横向的字体大小不同，这会导致每次更改方向时缩放都会发生变化。一旦缩放足够大，文本仍然会消失，并且有时文本视图的边缘会出现线条。也许有更好的方法将缩放变量传递给自定义 ScaleTextView 类？

# javascript - jQuery：验证空文本输入

> ID：16007555
> 
> 赞同：-1
> 
> 时间：2013-04-15T04:14:00.333
> 
> 标签：javascript, jquery, validation

如何验证空文本输入？当输入文本字段为空时，将显示必需的消息。

```
<script>
function LoadData(data){
    var tempdata = data;
    var i=0;
    while (i<tempdata.activity.length) {
        var index = Math.floor(Math.random() * tempdata.activity.length);
        qHint[i] = tempdata.activity[i].hint;
        i++;
    }
}

function hint(data, i){
    $('#mypanel' + (i + 1)).append("<label for=text" + (i + 1) + " id=panel"+ (i + 1)+ " style='margin-top:10%;text-align:center;color:white;'><span id=panelTitle"+ (i + 1) +" >"+ data + "</span></label>");// panel item
    $('#panel' + (i + 1)).append('<input type="text"  name="name" id=text'+ (i + 1) + ' style="text-align: center">');
    $('#mypanel' + (i + 1)).append('<a href="#header" data-role="button" name="submit" id=submit'+ (i + 1)+ ' onClick="submitFunc(' +(i+1)+ ')" data-inline="true" data-rel="close" data-icon="check" style="margin-left:75px;">Submit</a>');
    $('#mypanel' + (i + 1)).append('<a href=#mypanel'+ (i + 1)+ ' data-role="button" id=cancel'+ (i + 1)+ ' data-inline="true" data-rel="close" data-icon="delete2" style="margin-left:75px;">Cancel</a>');
 }

function submitFunc(num){
    $("#text"+num).attr("disabled", true);
    $("#text"+num).attr("readonly", true);
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:28:48.593

您将需要研究使用[jQuery 方法](http://api.jquery.com/val/) `val()`，该方法返回文本框类型输入的值等。

如果您在`submitFunc()`方法中使用它：

```
function submitFunc(num){
    if($('#text' + num).val() != ''){
        $("#text"+num).attr("disabled", true);
        $("#text"+num).attr("readonly", true);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:59:20.763

为此，您可以使用 jquery.validate.js。您只需要在输入字段上添加所需的类。
例如：

```
<input type="text" id="Field1" class="required" /> 
```

然后在 document.ready 上，只需调用`$("#FormName").validate`函数即可为您验证该表单及其字段。
必须注意，要验证的输入字段必须是表单的一部分。

# javascript - 如何检测文本框字段空格？

> ID：16007556
> 
> 赞同：0
> 
> 时间：2013-04-15T04:14:18.510
> 
> 标签：javascript

我需要文本框按键功能方面的帮助。如果文本框字段为空，则无需发布值。

我的以下功能正常工作。如果文本框字段为空，我按回车键去nexline 很好。但我按回车键两次发布值。

我的代码有什么问题。请帮助我。

```
 $(".ppop-comment").keypress(function(e)
         {
          if($('#add_comment').val()=="")
           {
               if (e.which == 32) 

        return false;
              }
           else if (e.keyCode == 13 && !e.shiftKey && !$('#add_comment').val()==" ")
           {
                     $("#submit-comment").click(); 
                    }

         });

              <form id="commentform" method="post">
                 <textarea id="add_comment" name="meetnewpeople[message]" class="popup-comment">
                <input id="submit-comment" type="button" value="Post a comment" />

                   </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:32:22.990

```
 $(".ppop-comment").keypress(function(e)
     {
      if($('#add_comment').val().trim()!="")
       {
          if (e.keyCode == 13 && !e.shiftKey && !$('#add_comment').val()==" ")
           {
                 $("#submit-comment").click(); 
           }
       }
       else
       {
          return false;
       }

     }); 
```

# ruby-on-rails - 在 Google 地图上设置标志 - Ruby 1.9

> ID：16007558
> 
> 赞同：0
> 
> 时间：2013-04-15T04:14:35.893
> 
> 标签：ruby-on-rails, google-maps, flags

我是RoR的新手。
我被困在从数据库（纬度和经度）加载的点上在谷歌地图上设置一个标志（图像）。
任何帮助，请！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T14:10:19.643

您可以使用 Google Maps 中的嵌入式代码，并添加带变量的 lat/long。例如，假设您的纬度在变量中`@latitude`，经度在`@longitude`：

```
<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?q="+<%= @latitude %>+",+"+<%= @longitude >+"+(You+can+insert+your+text+here)&amp;hl=en&amp;ie=UTF8&amp;t=m&amp;z=14&amp;iwloc=A&amp;output=embed">
</iframe>
<br />
<small>
  <a href="https://maps.google.com/maps?q="+<%= @latitude %>+",+"+<%= @longitude %>+"+(You+can+insert+your+text+here)&amp;hl=en&amp;ie=UTF8&amp;t=m&amp;z=14&amp;iwloc=A&amp;source=embed" style="color:#0000FF;text-align:left">
    View Larger Map
  </a>
</small> 
```

# z-index - z-index 不工作 css 伪之前，之后

> ID：16007561
> 
> 赞同：1
> 
> 时间：2013-04-15T04:15:07.407
> 
> 标签：z-index, css, pseudo-element

我正在尝试在这样的 div 之一中实现 css3 弯曲阴影**[效果](http://www.paulund.co.uk/playground/demo/css_box_shadow/)**。但是，我遇到了 z-index 问题。即使我将父级设置为相对位置并设置更高的 z-index 它仍然无法正常工作。伪元素显示在元素之上。这是演示我的问题的**[小提琴也是下面的代码。](http://jsfiddle.net/7mMaT/)**任何帮助都感激不尽。

HTML

```
<div class="app-home-body-banners">
    <div>
        <ul style="height: 100px">
        </ul>
        <br class="clear" />
    </div>
</div> 
```

CSS

```
.app-home-body-banners
{
    position: relative;
    z-index: 100;
    margin: 20px 0px 20px 0px;
    background-color: #E9E9E9; 
}
.app-home-body-banners:before, .app-home-body-banners:after
{
    content:"";
    position:absolute;
    z-index:-1;
}

.app-home-body-banners:before
{
    top:0px;
    bottom:0px;
    left:10px;
    right:10px;
    -webkit-box-shadow:0 0 15px rgba(0,0,0,0.6);
    -moz-box-shadow:0 0 15px rgba(0,0,0,0.6);
    box-shadow:0 0 15px rgba(0,0,0,0.6);
    -moz-border-radius:100px / 10px;
    border-radius:100px / 10px;
}

.clear
{
    float: none;
    clear: both;
    line-height: 1px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-19T00:48:06.050

remove the z-index from .app-home-body-banners: [http://jsfiddle.net/7mMaT/9/](http://jsfiddle.net/7mMaT/9/)

```
.app-home-body-banners {
    position: relative;
    margin: 20px 0px 20px 0px;
    background-color: #E9E9E9; 
} 
```

# php - 用其他颜色为表格着色

> ID：16007564
> 
> 赞同：0
> 
> 时间：2013-04-15T04:15:24.613
> 
> 标签：php, html, css

下面我添加了我的 css 文件和我的 html 文件，我需要用更改名称颜色为我的表格着色，但它不起作用我不知道我在哪里做错了。

CSS文件：-

```
table.gridtable{
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    float:center;
    border-width:1px;
    border-style:groove;
    border-color:black;
    border-collapse:collapse;
    width:600px;
    }
    table.gridtable th{
    border-width:1px;
    padding:3px;
    border-style:solid;
    border-color:black;
    }
    table.gridtable td{
    border-width:1px;
    padding:3px;
    border-style:solid;
    border-color:black;
    }
    .oddrowcolor{
    background-color: black;
    }
    .evenrowcolor{
    background-color: red;
    }
    table.gridtable td.darkcol{
    border-top:0px;
    border-bottom:0px;
    border-right: 1px;
    }
    table.gridtable td.emptycol{
    border-bottom:0px;
    border-right: 1px;
    } 
```

HTML & PHP:-

```
 <table class="gridtable" id="alternatecolor" align="center"
 <tr><th>disease Name/th><th>Gene Name/th><th>OMIM Number</th></tr>  
 <?php
    $dbhandle = mysql_connect($hostname, $username, $password) or die("Unable to connect to MySQL");
    $selected = mysql_select_db("missensencemuttation",$dbhandle) or die("Could not select disease");
    $result = mysql_query("SELECT DISTINCT * FROM `gene_data` ORDER BY disease_name");
        $last=" ";
    while($row = mysql_fetch_array($result))    

        $now=$row[2];
        if($last != $now){
                $rcnt=mysql_query("select count(gene_name) from gene_data where gene_name='$now'");
        if($rcnt==1){
        echo "<tr><td>";   
        echo "<a href='d1.php?d_name=".$row['disease_name']."'>".$row['disease_name'];
        echo "</a></td>";       
        echo "<td>".$row['gene_name']."</td>";
        echo "<td>".$row['ommi_number']."</td></tr>";
        }
        else{
        echo "<tr><td class='emptycol'>";   
        echo "<a href='d1.php?d_name=".$row['disease_name']."'>".$row['disease_name'];
        echo "</a></td>";       
        echo "<td>".$row['gene_name']."</td>";
        echo "<td>".$row['ommi_number']."</td></tr>";
        }
        }
        else
        {
        echo "<tr'>";
        echo "<td class='darkcol'>";   
        echo '&nbsp';
        echo "</td>";       
        echo "<td>".$row['gene_name']."</td>";
        echo "<td>".$row['ommi_number']."</td></tr>";
        }
        $last=$row[2]; 
```

谁能帮我这个 ？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:25:16.103

也许我误解了，但看起来你想应用`oddrowcolor`或`evenrowcolor`交替行 - 但在你实际的 php/html 中，我在任何地方都看不到这些类名。他们没有被放在行上，所以他们的规则不会被应用。只需将它们添加到`<tr>`您的 php 中的适当标签中，它应该可以工作。或者，您可以使用`nth-of-type`选择器来应用规则而不更改您的 php：

```
tr:nth-of-type(odd) {
    background-color: black;
}
tr:nth-of-type(even) {
    background-color: red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T06:19:02.307

如果您想要每个表格行的替代颜色，那么一个简单的 CSS 应该可以做到。这样，如果您想动态插入新行，它将自动调整颜色。

```
.stripped-rows:nth-child(odd){
   background-color:red;
 }
.stripped-rows:nth-child(even){
   background-color:blue;
 } 
```

和 html ...

```
 <table>
 <tr class = 'stripped-rows'>
     <td>sad</td>
 </tr>
 <tr class = 'stripped-rows'>
  <td>sad</td>
</tr>
 <tr class = 'stripped-rows'>
   <td>sad</td>
</tr> 
```

[演示](http://jsfiddle.net/6VeJH/)

# mysql - 复杂的 MySQL 命令有问题。我可以做出这样的复合陈述吗？

> ID：16007565
> 
> 赞同：0
> 
> 时间：2013-04-15T04:15:42.303
> 
> 标签：mysql, sql, sql-server, prepared-statement

我可以在数据库中搜索一个元素，我的 PreparedStatement 的其中一个参数是从我通常作为单独语句制作的变量中找到的值吗？

所以我想做

```
preparedStatement = conn.prepareStatement("SELECT COUNT(*) FROM table1 WHERE Name = ? AND WHERE  user_ID = ?);  
preparedStatement.setString(1, name);  
preparedStatement.setString(2, userID);    
rs = preparedStatement.executeQuery(); 
```

除了目前的情况，我需要一个单独的语句来在另一个表中查找 userID 变量。就像是：

```
preparedStatement = conn.prepareStatement("SELECT user_id FROM users WHERE name = ?);  
preparedStatement.setString(1, theirName); 
```

那么有没有办法将这些组合成两个语句？即：类似...

```
"SELECT COUNT(*) FROM table1 WHERE Name = (user_ID FROM users WHERE username = theirName); 
```

编辑：这可能更清楚。想象一下，我有一个 Cars 表，其中每辆车都有一个名称和一个 Owner_ID。我有一个用户表，其中每个用户都有一个名称、密码和 ID。每辆车的车主 ID 都是用户的 ID 之一。

因此，我真正想要（在单个语句中）得到的是所有名称为 X 的汽车的数量，其中它们的所有者 ID = 来自用户 Y 的 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:18:34.607

这是通过将表连接在一起来完成的：

```
SELECT COUNT(*) FROM 
    table1 t1
    JOIN table2 t2 ON t2.name = t1.name
WHERE t1.name = "John" AND t2.user_ID = 2342433 
```

# ios - insertNewObjectForEntityForName 在表中的第一个位置不是最后一个

> ID：16007568
> 
> 赞同：0
> 
> 时间：2013-04-15T04:15:52.943
> 
> 标签：ios, objective-c, core-data

如何在表的第一个位置插入带有coredata的记录？目前，如果我添加`insertNewObjectForEntityForName`它会将记录添加到最后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:25:36.137

好吧，据我所知这是不可能的。但是，您可以做的一件事是操纵如何从数据库中检索对象。例如，对于此类需求，在模型类中包含 NSDate 属性通常很有用。在将对象插入 DB 时，为该属性传递 [NSDate date]。在从数据库中提取对象的同时，编写一个排序算法，返回按插入日期排序的记录

在您的模型类的头文件 Header.h

```
//Declare this property
NSDate *dateOfInsertion

//This method returns objects sorted by DateOf Insertion
    - (NSArray*)arraySortedByDateOfInsertion {
        NSSortDescriptor *descriptor = [NSSortDescriptor sortDescriptorWithKey:@"dateOfInsertion" ascending:NO];
        return [self sortedArrayUsingDescriptors:[NSArray arrayWithObject:descriptor]];

    } 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:34:48.330

您无法决定在表格中的何处添加元素。但是您为此使用数组。您可以在数组顶部添加元素，使其显示为表中的第一行：

```
- (void)insertObject:(id)anObject atIndex:(NSUInteger)index 
```

# sql - 将 SQL Server BIT 数据类型转换为布尔值 VB.NET

> ID：16007569
> 
> 赞同：1
> 
> 时间：2013-04-15T04:16:15.383
> 
> 标签：sql, vb.net, boolean, bit

我对我的 VB.NET 有点生疏，尤其是在转换为 SQL 时。我以为我有一个隐藏 2 个按钮的简单任务，除非选中一个复选框。该复选框绑定到具有`bit`数据类型的 SQL Server 列。

我的代码如下：

```
Private Sub CaseVehicleCollisionCheckBox1_CheckedChanged(sender As Object, e As EventArgs) Handles CaseVehicleCollisionCheckBox1.CheckedChanged
    Dim collision As System.Data.SqlTypes.SqlBinary
    collision = CaseVehicleCollisionCheckBox1

    If collision = True Then
        btnVehicle1.Visible = True
        btnVehicle2.Visible = True
    ElseIf collision = False Then
        btnVehicle1.Visible = False
        btnVehicle2.Visible = False
    End If

End Sub 
```

我不断收到错误

> “System.Windows.Forms.CheckBox”类型的值无法转换为“System.Data.SqlTypes.SqlBinary”

尝试将复选框分配给变量时。

尝试使用时出现相同的错误`System.Data.SqlTypes.SqlBoolean`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:33:56.170

问题是您正在将 CheckBox 控件强制转换为 SQLBinary 数据类型，但这是行不通的。

我认为 CaseVehicleCollisionCheckBox1 是 CheckBox 的名称。您需要使用[`CheckBoxes Checked property`](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkbox.checked.aspx)，例如：

```
Dim collision As Boolean
collision = CaseVehicleCollisionCheckBox1.Checked 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:40:59.857

使用 SqlBoolean 而不是 sqlBinary。sqlBinary 是字节数组的 sql 等价物。

# java - 使用回溯的最小图形着色

> ID：16007570
> 
> 赞同：0
> 
> 时间：2013-04-15T04:16:38.307
> 
> 标签：java, backtracking, pruning, graph-coloring

我正在处理一个 m_coloring 问题，其中我必须使用回溯确定无向图的色数 m。到目前为止，我的（java）解决方案是递增 m，尝试 m_Coloring 方法，如果找不到解决方案，则重复。但是，对于较大的文件，如果 m 超过 6，则计算需要很长时间。有人告诉我，我们使用的算法没有合并修剪，所以我试图弄清楚如何把它放进去，但经过一周的搜索却没有运气。

```
vColor = new int[nodes+1];
vColor[1] = 1;
while(unsolved)
{
    m++;
    mColoring(1);
}

static void mColoring(int i)
{
    int color;
    if (promising(i))
    {
        if (i==nodes)
        {
            unsolved = false;
        }
        else
        {
            for(color = 1; color<=m; color++)
            {
                if(unsolved)
                {
                    vColor[i+1] = color;
                    mColoring(i+1);
                }
            }
        }
    }
}

static public boolean promising (int i)
{
    int j=1;
    boolean promise = true;

    while(j<i && promise)
    {
        if(adjMatrix[i][j] && vColor[i] == vColor[j])
        {
            promise = false;
        }
        j++;
    }
    return promise;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-28T21:41:30.023

一种简单、有效且众所周知的精确算法使用[Brélaz](http://dl.acm.org/citation.cfm?id=359101)最小*饱和度*启发式 DSATUR（即选择具有较少可用颜色的候选顶点作为新的候选顶点，别名具有更多不同颜色的邻居）在完整[枚举方案](http://gcs1.googlecode.com/svn-history/r28/trunk/Recursos/BrownRandall.pdf)中进行分支。

基本的剪枝策略是隐含的：每个候选顶点最多只能有前面顶点中使用的颜色 + 1 （新颜色，如果它是*饱和*的，则分配）。这意味着可以沿着回溯到最后分配是*新*颜色的顶点的任何分支修剪搜索。

很抱歉，我不能为您提供有关基于 DSATUR 的精确算法的 Java 实现的参考，但如果您有兴趣，我可以提供 C、C++ 参考。

# macports - 如何通过 MacPort 获取已安装包的大小？

> ID：16007574
> 
> 赞同：4
> 
> 时间：2013-04-15T04:16:52.900
> 
> 标签：macports

`port installed`显示本地机器上所有已安装的包，但是有没有办法列出每个包的大小？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-04-23T03:17:06.187

```
port space --units MB installed 
```

[好用又简单，从 2011 年的2.0 版](http://svn.macports.org/repository/macports/branches/release_2_0/base/ChangeLog)开始就一直可用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:37:41.953

我不相信 Macports 有内置命令来列出安装的大小，但你可以这样做：

在终端中尝试以下命令：

```
du -sh /opt/local/var/macports/software/* 
```

这将为您提供 /opt/local/var/macports/software/* 中每个包的大小，我*相信*这是默认安装位置。

显然，如果您将端口安装在其他地方，您可以使用

```
 du -sh [directory] 
```

如果没有内置的 Macports 命令，这可能是您能做的最好的事情。

想到的一种替代方法是创建一个脚本，该脚本将输出

```
 port installed 
```

并回显每次安装的大小。

编辑：

我错了。/opt/local/var/macports/software/* 包含从中提取安装的*tarbell*，因此大小会更小。

如果你做 du -sh /opt/local，它应该列出所有东西的大小，但列表中可能有一些非 macports 包。

该命令`port contents installed`将向您显示 macports 已安装的所有内容的目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-02T19:39:46.897

这是一个小的 bash 函数，它将接受任何有效的 macports 查询

```
function port_size {
    size=0
    pkg_size=0
    for pkg in $(port $@ | tail -n +2 | awk '{ print $1 }')
    do
        pkg_size=$(port contents $pkg \
            | sed -r 's/^[[:space:]]*(.*)[[:space:]]*$/\1/g;s/ /\\ /g' \
            | tail -n +2 | xargs du | cut -f1 | paste -sd '+' | bc)
        size=$(( $size + $pkg_size ))
        printf "%10d %s\n" $pkg_size $pkg
    done
    printf "%10d %s\n" $size "Total Size (KB)"
} 
```

我只用 sed 和 awk 的 GNU 版本对其进行了测试，但无论如何它都应该可以工作。

```
port_size installed   # will print out all installed packages and their size

port_size installed gcc*    # will print out all packages matching gcc* wildcard 
```

同样，任何有效的 macports 查询都将起作用（包括`installed inactive`or `outdated`.

# php - PHP simplexml_load_file 错误：请求太多？

> ID：16007576
> 
> 赞同：-2
> 
> 时间：2013-04-15T04:17:20.053
> 
> 标签：php, mysql, xml, parsing

我正在尝试使用 vimeos API 通过其 XML 文件调用视频的名称。如果我将此代码用于一个 xml 文件，它可以工作文件：

```
 $location = "http://vimeo.com/api/v2/video/16417063.xml";
    $xml = simplexml_load_file($location);
    echo $xml->video->title; 
```

但是在我将所有 vimeo 视频 ID 存储在数据库中并使用以下代码之后：

```
 <?php
    $seasontwo=mysql_query("SELECT s2 FROM video_ids LIMIT 1");
    while($row=mysql_fetch_array($seasontwo))
    {
    $headline=$row['s2'];
    $location = "http://vimeo.com/api/v2/video/".$headline.".xml";
    $xml = simplexml_load_file($location);
    echo $xml->video->title;
    }
    ?> 
```

我得到错误：

```
 Warning: simplexml_load_file(http://vimeo.com/api/v2/video/16417063.xml) [function.simplexml-load-file]: failed to open stream: HTTP request failed! HTTP/1.1 429 Too Many Requests in /home/dpnews0/public_html/tnn/wordpress/wp-content/themes/twentytwelve/content.php on line 11

    Warning: simplexml_load_file() [function.simplexml-load-file]: I/O warning : failed to load external entity "http://vimeo.com/api/v2/video/16417063.xml" in /home/dpnews0/public_html/tnn/wordpress/wp-content/themes/twentytwelve/content.php on line 11 
```

尽管 xml 文件[http://vimeo.com/api/v2/video/16417063.xml](http://vimeo.com/api/v2/video/16417063.xml)实际上是有效的。谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:55:16.623

请求过多是 http 状态错误代码之一，
请参阅此处：[http ://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error)

> > 429 Too Many Requests (RFC 6585) 用户在给定时间内发送了太多请求。旨在与速率限制方案一起使用。

您收到此错误的原因只是 vimeo 阻止您的请求，因为您的脚本触发了异常的高活动。这是服务提供商防止内容报废的常见做法（就像您尝试做的那样）。

抛出错误 429 时，您将无法获得有效的 xml 响应。
因此，您将收到 xml I/O 警告的第二条警告消息。

要解决此问题，您应该将 xml 响应 ( [http://vimeo.com/api/v2/video/16417063.xml](http://vimeo.com/api/v2/video/16417063.xml) ) 存储在本地，以避免重复请求 vimeo。

一种简单的方法是将 xml 响应存储到磁盘缓存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T11:45:15.693

您正在与另一台不属于您且您无法控制的计算机进行交互。正因为如此，其他计算机可以改变他们的行为，不同于你的预期。这就是这里发生的情况，您打开 XML 的请求导致错误。如果你不理解错误信息，没问题，你只需要处理它。

当您与远程服务交互时，您需要*针对失败进行设计*：

```
$xml = simplexml_load_file($location);

$hasLoaded = (bool) $xml;

if (!$hasLoaded) 
{
   // handle the case that the remote server could not provide valid XML
   // e.g. provide a stub, search inside a cache or what not:

   $xml = new SimpleXMLElement('<r><video><title>Unknown</title></video></r>');
} 
```

Vimeo 还提供有关它在响应标头 ( ) 中使用的 HTTP 速率限制的元信息*`$http_response_header`*：

1.  `X-RateLimit-Limit: 3600`
2.  `X-RateLimit-Remaining: 0`
3.  `X-RateLimit-Reset: 1366033220`

这表明使用的 WAN IP 现在被阻止，直到*格林威治标准时间 2013 年 4 月 15 日星期一 13:40:20*，也就是大约。在我触发请求限制（3600 个请求）后一小时。

我没有收到[*429 Too Many Requests* (RFC6585)](https://www.rfc-editor.org/rfc/rfc6585#section-4)，而只是收到*403 Forbidden*。最后，这都是因为 Vimeo 使用的速率限制。

变量转储：

```
array(17) {
  [ 0] => string(22) "HTTP/1.1 403 Forbidden"
  [ 1] => string(13) "Server: nginx"
  [ 2] => string(35) "Date: Mon, 15 Apr 2013 12:49:05 GMT"
  [ 3] => string(38) "Content-Type: text/html; charset=UTF-8"
  [ 4] => string(17) "Connection: close"
  [ 5] => string(23) "X-RateLimit-Limit: 3600"
  [ 6] => string(24) "X-RateLimit-Remaining: 0"
  [ 7] => string(29) "X-RateLimit-Reset: 1366033220"
  [ 8] => string(38) "Expires: Mon, 15 Apr 2013 13:40:20 GMT"
  [ 9] => string(39) "X-UA-Compatible: IE=EmulateIE9,chrome=1"
  [10] => string(26) "X-DNS-Prefetch-Control: on"
  [11] => string(21) "Vary: Accept-Encoding"
  [12] => string(20) "X-Varnish: 366390796"
  [13] => string(6) "Age: 0"
  [14] => string(16) "Via: 1.1 varnish"
  [15] => string(18) "X-Varnish-Cache: 0"
  [16] => string(24) "X-VServer: 10.90.128.147"
} 
```

另见：

*   [HTTP API 速率限制 HTTP 响应标头的示例](https://stackoverflow.com/q/16022624/2261774)

# matlab - 将数据从文本文件移动到 MATLAB

> ID：16007579
> 
> 赞同：0
> 
> 时间：2013-04-15T04:17:35.063
> 
> 标签：matlab

我的数据如下所示：

> # 输入 1
> 
> 0 1 1 0 0 0 0 1 1 0 0 1 0 1 1 0 1 0 0 1 0 0 0 0 1 0 1 0 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 0 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 1 0 0 0 0 1 1 0 1 0 1 0 1 0 0 0 0 1 1 0 0 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 1 0 1 0 1 0 0 1
> 
> # 输出 1
> 
> 1.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
> 
> # 输入 2
> 
> 0 1 0 1 0 0 0 1 0 1 0 1 0 1 1 0 1 0 0 1 0 0 0 0 1 0 1 0 0 0 1 0 1 1 0 1 0 0 1 1 0 0 1 0 0 0 1 0 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 1 0 0 0 0 1 1 0 1 0 1 0 1 0 0 0 0 1 1 0 0 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 1 0 1 0 1 0 0 1
> 
> # 输出 2
> 
> 1.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00

数据位于文本文件中。大约有 130 个输入和输出向量。我基本上需要在 MATLAB 中加载数据来训练 SVM 模型。有人知道我如何将数据加载到 MATLAB 中吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T10:05:09.670

加载文本文件的更短方法：

```
%// Read lines from text file into cell array
fid = fopen(filename, 'r');
C = textscan(fid, '%s', 'Delimiter', '', 'CommentStyle', '#');
fclose(fid);

%// Convert contents of each cell into a numerical array
C = cellfun(@str2num, reshape(C{1}, [], 2), 'UniformOutput', false); 
```

结果是一个包含您的数据的*N* ×2 元胞数组`C`（其中*N*是输入-输出对的数量）。

对于您问题中的示例，`C{1, 1}`存储一个由 1 和 0 组成的 1×121 输入数组，并`C{1, 2}`包含相应的 1×10 输出数组`[1.00 0 0 0 0 0 0 0 0 0]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:24:10.507

您可以以交互方式和编程方式将文本文件导入 MATLAB。

要以交互方式导入数据，请使用导入工具。您可以生成代码以对多个类似文件重复该操作。导入工具支持文本文件，包括扩展名为 .txt、.dat、.csv、.asc、.tab 和 .dlm 的文本文件。这些文本文件可以是非矩形的，并且可以有行和列标题。这些文件中的数据可以是数字和非数字文本的组合，并且可以由一个或多个字符分隔。

要以编程方式从文本文件导入数据，请使用导入函数。大多数文本文件的导入功能要求文件中的所有数据字段都是数字，并且每行数据具有相同的列数

MATLAB 中有很多导入工具，例如“load”、“textscan”等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:31:42.920

如果您知道不想以 开头的行`#`，则可以使用类似`textscan`简单选项的内容：“到达此字符时停止阅读”。在这种情况下，一次读一行你会得到

```
fid = fopen(myFile);
while(~feof(fid))
    myData = textscan(fid, '%[^#]d');
    if numel(myData) > 1
        thisRow = [myData{:}];
    end
end 
```

我现在无法访问matlab，但上面应该非常接近......

我刚刚意识到，如果您的数据实际上是交替的“向量名称”和“向量数据”，并且名称总是以“#”开头，那么您可以做得更好：

```
fid = fopen(myFile);
while(~feof(fid))
    myName = textscan(fid, '# %s %d');
    myData = textscan(fid, '%f', Inf);
    if numel(myData) > 1
        varName = sprintf('%s{%d}', myName{1}, myName{2});
        assignin('base', varName,myData); 
    end
end 
```

这*可能*只是做你真正需要的......或者，再一次，有点接近。尝试使用这些命令 - 将其视为“仅用于灵感”。

# android - 不同的应用程序图标和启动器图标？

> ID：16007580
> 
> 赞同：6
> 
> 时间：2013-04-15T04:17:36.560
> 
> 标签：android, graphics, icons

没有从 Android 开发中心找到答案，所以我不得不在 Stackoverflow 中找到一些答案......

a) 如果我的启动器图像和 Google Play 商店的图标不同，我的应用程序会被拒绝，即。Google Play 商店图标上会有文字，而启动器图像不会？小修改也会出现。

b）我能否以某种方式拥有不同的应用程序图标和应用程序名称（在 Google Play 和启动器图标下显示的那个）取决于语言，即。英语和芬兰语？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T05:01:38.437

a) 不。有很多应用程序在启动器中不显示图标，例如，应用程序小部件或动态壁纸，所以我想没有严格的规定。但是，如果 Play 商店中的图标与启动器图标相同，则用户可以轻松地在 Play 商店中找到您的应用，因此它们应该相同以增加可查找性。

b) 是的~~和不~~. 您可以[在应用资源](http://developer.android.com/guide/topics/resources/localization.html#creating-alternatives)和[Play 商店列表详情](http://support.google.com/googleplay/android-developer/answer/113469?hl=en)中为每种语言设置不同的应用名称。您还可以通过将启动器图标放入`res`带有区域设置限定符的目录来更改启动器图标，例如`drawable-en-xhdpi`.~~但是，Play 商店不支持根据语言更改图标。~~ **已编辑：**现在 Google Play 商店支持为每个语言环境使用不同的资产，因此您可以单独指定本地化图标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:56:57.907

谷歌权威机构可以提供您问题的确切答案。但是，让我尝试分享我对您的问题的发现。

[a) 我在此处](http://support.google.com/googleplay/android-developer/topic/2364761?hl=en&parent=2365624&ctx=topic)和[此处](http://play.google.com/about/developer-content-policy.html)的 googleplay 政策中没有找到任何类似的信息。但是在这个[链接](http://developer.android.com/distribute/googleplay/publish/preparing.html)的一个地方写着

> 资产应引用与用户下载应用后在所有应用启动器中实际找到的相同徽标和图标

因此我们可以得出结论，必须使用相同的图标。虽然我不知道他们是怎么检查的。

b）到目前为止，现在有办法做到这一点。没有像标题、描述、图像这样的信息可以针对不同的语言进行不同的设置（如果我错了，有人会纠正我）。你可以做一件事。对于不同的语言，您可以发布具有不同包名称的不同 apk。通过搜索，您可以找到类似的问题。[这个问题](https://stackoverflow.com/questions/9394852/android-publish-an-app-with-different-screenshots-corresponding-to-different-la)就是其中之一。

您还可以在 google play 中查看[多个 APK 支持。](http://developer.android.com/google/play/publishing/multiple-apks.html)尽管它针对不同的设备，但您可以检查是否可以针对不同的语言执行相同的操作。（我不确定这个：S）

# vector - C++/CX - 向量的向量？

> ID：16007582
> 
> 赞同：2
> 
> 时间：2013-04-15T04:17:42.560
> 
> 标签：vector, windows-runtime, c++-cx

在 C++/CX 中是否有可能拥有向量的向量？我只是好奇语法会是什么样子。目前，我有...

```
Vector<String^>^ 
```

...而且我发现我实际上可能需要许多这些 Vector，所以我希望使用另一个 Vector 来包含所有这些 Vector。那可能吗？

我努力了...

```
Vector<Vector<String^>^>^ blah; 
```

...这似乎可以编译，但是当我尝试使用...对其进行初始化时

```
Vector<Vector<String^>^>^ blah = ref new Vector<Vector<String^>^>(); 
```

...编译失败并出现错误...

```
 "'get': signature of public member contains native type 'std::equal_to<_Ty>'" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:32:45.150

这似乎工作......

```
Vector<IVector<String^>^>^ blah = ref new Vector<IVector<String^>^>(); 
```

请注意，它现在是 IVector 的 Vector，显然可以编译。

# javascript - 范围广泛的修复边界

> ID：16007585
> 
> 赞同：0
> 
> 时间：2013-04-15T04:18:20.703
> 
> 标签：javascript, rangy

选择文本时，选择开始和结束的确切位置会有所不同，有时它从前一个元素的末尾开始，有时在文本节点的开头。我正在尝试对此进行规范化，使其始终从包含文本的元素的开头开始，并在包含文本的元素的末尾结束，并使其在浏览器中保持一致。

例如`<b>mouse></b><i>cat</i>`

选择“cat”时，chrome 似乎总是做正确的事情并返回一个带有 startContainer cat 和 startOffset 0 的选择。Firefox 和偶尔的 IE8 通常会从前一个元素（鼠标）的末尾开始，startOffset 为 5

我试图解决这个问题的粗略尝试没有成功：

```
 var sr=rangy.getSelection().getRangeAt(0);
  var sc=sr.startContainer;
  if(sc.nodeType!=3||sr.startOffset==sc.length)
    {
    sr.setStartAfter(sc);   //move start to next node in range
    }
  rangy.getSelection().setSingleRange(sr);
  console.log(sr.inspect()); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:48:43.283

好的，我想我已经破解了它，但我非常愿意接受有关如何改进它的评论或建议。不知何故，它缺乏优雅，我觉得应该有更好的方法。这个问题似乎只需要在 Firefox 中修复。Chrome 和 IE8 似乎从未在包含文本的元素之外进行选择。无论如何，这似乎对我有用。（至今）

```
var sr=rangy.getSelection().getRangeAt(0);
var sc=sr.startContainer,ec=sr.endContainer;
if(sc.nodeType!=3||sr.startOffset==sc.length)
  {
  sc=(sc.nextSibling)?sc.nextSibling:sc.parentNode.nextSibling;
  if(sc.nodeType!=3)sc=sc.firstChild;
  sr.setStart(sc,0);
  }
if(ec.nodeType!=3||sr.endOffset==0)
  {
  ec=(ec.previousSibling)?ec.previousSibling:ec.parentNode.previousSibling;
  if(ec.nodeType!=3)ec=ec.lastChild;
  sr.setEnd(ec,ec.length);
 }
rangy.getSelection().setSingleRange(sr);
console.log(sr.inspect()); 
```

# mysql - MySQL 子查询 - 查找用户所在的房间，并查找房间中的其他人

> ID：16007587
> 
> 赞同：0
> 
> 时间：2013-04-15T04:18:33.263
> 
> 标签：mysql

我有一张简单的桌子，里面有用户和房间。一个用户可以在多个房间中，我想做的是在一次查询操作中找到用户所在的房间，以及其他人在同一个房间中的哪些房间。

```
SELECT user, room FROM rooms WHERE user='foobar' 
```

之后我可以简单地进行另一个查询`SELECT user FROM rooms WHERE room='theroom'`，但是有没有办法减少 MySQL 查询并提供性能优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:21:53.010

您可以自行加入`rooms`表：

```
SELECT r1.user, r1.room, r2.user 
FROM 
   rooms r1 JOIN rooms r2 ON r2.room = r1.room 
WHERE r1.user='foobar'AND r2.user != 'foobar' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:22:11.187

这个怎么样：

```
SELECT r.user, r.room
  FROM rooms r JOIN rooms x ON r.room=x.room
  WHERE x.user='foobar'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:35:10.987

在这种情况下，我认为您可以在查询中使用“IN”子句......

从房间所在的房间中选择用户（从用户 = 'foobar' 的房间中选择房间）；

# java - Android 中的 2 个客户端 + 1 个服务器游戏，带有 PHP 中的网络服务器

> ID：16007589
> 
> 赞同：0
> 
> 时间：2013-04-15T04:18:45.297
> 
> 标签：java, php, android, client-server

我正在尝试构建一个带有 2 个客户端和 1 个服务器的 Android 应用程序。设计如下：

1.  客户 1 登录。
2.  客户端 2 登录。

3.  客户端 1 通过 MySQL db 输入一些需要服务器验证的文本。

4.  根据服务器响应，服务器向客户端 2 发送一些结果。

这种情况来回发生，直到游戏结束。

两个客户端都是安卓移动设备。我能够建立 1 个客户端 (Java) + 服务器 (PHP) + MySQL 连接，并且工作正常。但是现在我对如何在我的应用程序中实现 2 个客户端与同一服务器交互的概念感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:54:56.397

缺少一些重要的用例：

*   如果连接了两个以上的客户端会怎样？
*   客户 1 是如何知道客户 2 的，他是如何与他开始游戏的？
*   如果其中一个客户端断开连接会发生什么？

通常这些用例的答案表明你的服务器有状态，至少你需要处理登录客户端的状态和活动游戏的状态。

您可以使用 PHP 和 MySQL 来实现它，但您可能会发现自己大部分时间都在处理与架构相关的问题，而不是添加新功能。我建议选择更好的框架，至少是 Servlets。

但是，如果您仍然想在 PHP 中执行此操作并且不回答上述用例：

*   登录后，启动拉取机制：客户端每隔 x 秒询问服务器是否有信息给他，并根据响应执行适当的操作。
*   将响应表添加到服务器，每当您有事情要告诉客户端时，将客户端 ID 和响应添加到此表。
*   You would probably need a table for logged in users and a table for the states of the games.

Client 1 logged in and start pulling

*   Client 1 response: do nothing

Client 2 logged in and start pulling

*   Client 1 response: send text
*   Client 2 response: do nothing

Client 1 send text

*   Client 1 response: do nothing
*   Client 2 response: result

Client 2 send text

*   Client 1 response: result
*   Client 2 response: do nothing

etc.

There are other ways but again, in my opinion PHP is not the right solution here.

Hope this helps, Yaron

# android - 尝试更改 textView 背景中使用的形状的颜色

> ID：16007593
> 
> 赞同：0
> 
> 时间：2013-04-15T04:19:10.313
> 
> 标签：android, android-canvas, android-view, android-drawable

我在**xml**中定义了一个白色背景的可绘制椭圆。我将这个圆圈设置为`textView`我的 gridAdapter 内部的背景资源。

我想通过代码更改可绘制圆圈的颜色，但运气不佳。我用过`.setColor`,`.setColorFilter`和其他各种黑客，但没有一个奏效。圆圈在背景中加载`textView`为**白色**，它似乎永远不会改变。

这里我尝试加载drawable并修改它的颜色，然后将它作为背景资源添加到`textView`：

```
 int color = Color.parseColor(locationModel.col_line_color); // Color of the line

            GradientDrawable bgcircle = (GradientDrawable) gridContext.getResources().getDrawable(R.drawable.circle);
            bgcircle.mutate();
//          bgcircle.setColor(color);

            bgcircle.setColorFilter(color, Mode.SRC_ATOP);

            viewHolder.textView.setText((locationModel.col_line).toString());
            viewHolder.textView.setBackgroundResource(R.drawable.circle); 
```

可绘制形状的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" 
    android:shape="oval">

   <solid 
       android:color="@android:color/white"/>

   <size 
       android:width="120dp"
       android:height="120dp"/>

</shape> 
```

很多教程都要求`.mutate()`then 实现`.setColorFilter()`，但我运气不佳。我尝试将 PorterDuff 模式更改为一些替代方案，但圆圈继续呈现白色。

任何帮助/指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:30:29.103

不要试图修改当前的 xml 可绘制对象，而是在您的代码中创建可绘制对象。如果不需要渐变，也可以使用[ShapeDrawable 。](https://www.google.com.bd/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&sqi=2&ved=0CC4QFjAA&url=http://developer.android.com/reference/android/graphics/drawable/ShapeDrawable.html&ei=_IFrUYXyNs2uiQf2jIHgDQ&usg=AFQjCNEkCc7devFnVf9xKbfi4AfBpfMSvw&sig2=ZXI23WrfRM4pZ-UlCOy-iA&bvm=bv.45175338,d.aGc)

```
ShapeDrawable drawable = new ShapeDrawable(new OvalShape());
drawable.getPaint().setColor(newColor); 
```

# c# - 果园主题页面添加logo

> ID：16007594
> 
> 赞同：0
> 
> 时间：2013-04-15T04:19:22.740
> 
> 标签：c#, css, orchardcms

目前我正在为果园网站创建一个主题，并且需要在页面中添加徽标图像。我的要求是在与导航菜单相同的级别上显示徽标图像。

```
LOGO         Home | Blog | About Us 
```

我可以将 LOGO 图像添加到 Header 区域并使用 css 使其显示在与 Navigation 区域相同的级别，或者将 LOGO 图像添加到 Navigation 区域。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:29:10.570

您想在`<header>`区域顶部添加徽标并使用 CSS 使徽标与您的`<nav>`区域内联。您的导航菜单中已经有一个主页链接，因此不建议在同一导航菜单中重复徽标上的链接（假设您将徽标链接到您的主页）。

```
<header>
<a href="home"><img src="logo"></a>
    <nav>
       <ul>
         ...
       </ul>
    </nav>
</header> 
```

# javascript - EaselJS中如何触发和监听全局事件

> ID：16007595
> 
> 赞同：0
> 
> 时间：2013-04-15T04:19:36.193
> 
> 标签：javascript, easeljs, createjs

我知道 EventDispatcher 能够在对象之间触发事件，但是层次结构中的任何对象都可以监听和响应的全局事件呢？在 EaselJS 中是否有推荐的正确执行此操作的方法，一般来说这是一个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T07:11:27.280

事件可以通过任何对象，任何对象都可以监听任何事件，您只需通过以下方式为您的自定义对象初始化 EaselJS 事件：

```
EventDispatcher.initialize(myObject); 
```

如果您希望它可以全局访问，我认为您必须使用诸如`window.myGlobalEventHub`调度对象之类的东西，或者可以从任何地方访问的其他一些窗口变量。

# wcf - 部署桌面应用程序 WCF 端点

> ID：16007597
> 
> 赞同：0
> 
> 时间：2013-04-15T04:19:39.333
> 
> 标签：wcf

我有网络托管的客户端端点与桌面应用程序服务端点交谈。这是客户端端点端的配置：

```
<system.serviceModel>
<client>
<endpoint address="net.tcp://10.8.20.175:3337/NotificationService"
  binding="netTcpBinding" contract="INotificationService"
name="NetTcpBinding_INotificationService" />
</client>
<bindings>
<netTcpBinding>
 <binding sendTimeout="00:10:00" maxReceivedMessageSize="1000000"    name="NetTcpBinding_INotificationService"/>
 </netTcpBinding>
</bindings>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" /> 
```

这是服务端点端的配置：

```
<services>
<service behaviorConfiguration="NotificationServiceBehavior"
 name="NotificationService">
<endpoint address="" binding="netTcpBinding" contract="INotificationService" />
<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
<host>
  <baseAddresses>
    <add baseAddress="net.tcp://localhost:3337/NotificationService" />
  </baseAddresses>
</host>
</service>
</services> 
```

我试图通过添加以下内容来打开服务端 WCF 跟踪

```
<system.diagnostics>
<trace autoflush="true" />
<sources>
  <source name="System.ServiceModel"
          switchValue="Information, ActivityTracing"
          propagateActivity="true">
    <listeners>
      <add name="sdt"
          type="System.Diagnostics.XmlWriterTraceListener"
          initializeData= "C:\data\logs\trace.log" />
    </listeners>
  </source>
</sources> 
```

但是，我没有生成 trace.log。

那么如何在桌面应用程序端获取跟踪日志？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:31:38.597

我没有看到这个：

```
<diagnostics wmiProviderEnabled="false">
      <messageLogging logEntireMessage="true" logMalformedMessages="true" logMessagesAtServiceLevel="true" logMessagesAtTransportLevel="true" />
</diagnostics> 
```

在 system.ServiceModel 下。

试试这个指南[快速设置 WCF 诊断](http://petarvucetin.me/blog/2013/02/setting-wcf-diagnostics-quickly/)

# c++ - 强制 C++ 类实例在复制或分配时更改成员值

> ID：16007601
> 
> 赞同：0
> 
> 时间：2013-04-15T04:20:22.933
> 
> 标签：c++, vector, copy-constructor, assignment-operator

我有一个名为`Solution`定义如下的类。我只包含了相关代码，并**没有**编写自定义复制或赋值运算符。

```
class Solution {

public:

    Solution() {
        stream.setNewSeed(seedShift+static_cast<long>(12345));
        ++seedShift;
    }

    RandomNumberStream stream;

private:

    static long seedShift = 0;
}; 
```

这里的重点是我希望每个新实例`Solution`都有不同的随机数流。这行得通。

然而，问题是在某些地方我`Solution`从 a复制一个实例`std::vector<Solution>`，稍微修改它，然后将副本推送到同一个`std::vector<Solution>`. 发生这种情况时，我有两个`Solution`具有相同随机数种子的实例，灾难随之而来。

如何使`stream.setNewSeed(seedShift+static_cast<long>(12345));`and`++seedShift;`语句在`Solution`推送到向量上的复制实例中运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:26:04.233

重载赋值运算符。注意 - 这也意味着当您从向量中读取值和/或复制向量本身时，随机数种子也会再次发生变化。

```
class Solution {

public:

    Solution() {
        stream.setNewSeed(seedShift+static_cast<long>(12345));
        ++seedShift;
    }

    Solution& operator=(Solution& other)
    {
        stream.setNewSeed(seedShift+static_cast<long>(12345));
        ++seedShift;

        x = other.x;
        y = other.y;
        z = other.z;

        return *this;
    }

    RandomNumberStream stream;

private:

    static long seedShift = 0;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:29:28.247

推入 a`vector`将使用复制构造函数（或移动构造函数，但我们将使其简单并假设它现在使用复制构造函数）。这有签名：

```
Solution(const Solution& rhs); 
```

然后，您可以相当简单地实现此逻辑：

```
Solution(const Solution& rhs)
{ 
     stream.setNewSeed(seedShift + 12345L);
     ++seedShift;
} 
```

请注意，如果您实现了这一点，您可能还应该实现复制赋值运算符：

```
Solution& operator=(const Solution& rhs)
{
    if(this != &rhs) {
        stream.setNewSeed(seedShift+static_cast<long>(12345));
        ++seedShift;
    }
    return *this;
} 
```

# asp.net - 如何在 asp.net 简单网页中实现反向 ajax，如彗星或 Websync

> ID：16007602
> 
> 赞同：1
> 
> 时间：2013-04-15T04:21:02.210
> 
> 标签：asp.net, ajax, jquery, webmethod

如何在 asp.net 简单网页中实现反向 ajax，如 comet 或 Websync？

我想在服务器上推送更新，然后在一秒钟内反转所有客户端的响应。
因为我是新手，对反向 ajax 没有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-10T16:12:58.340

看看[WebSync](http://frozenmountain.com/products/websync)。它使用 Bayeux 协议（因此您可以与其他供应商的解决方案集成），在可用时使用 WebSockets，支持回到 IE 5.5 的 Web 浏览器，并为几乎每个软件平台提供客户端 SDK。

让您的客户订阅一个频道（例如“/data”）：

```
var client = new fm.websync.client('websyncurl');
client.connect();
client.subscribe({ channel: '/data', onReceive: function(e) {
    alert(e.getData());
}); 
```

然后当你想从服务器发送一些东西时：

```
WebSyncServer.Publish("/data", Json.Serialize(data)); 
```

**免责声明：**我为[Frozen Mountain](http://www.frozenmountain.com)工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:44:44.477

使用 SignalR [http://signalr.net/](http://signalr.net/)它可以将内容推送到客户端

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T08:50:26.340

**SignalR**与**MVC**配合得很好，他们在示例中使用的聊天应用程序是 MVC。正如@Garath 所指出的，有一个关于 ASP.NET 的教程。要考虑的另一项技术是**Knockout**，它们与 UI 的即时更新配合得很好。我刚刚使用 Knockout、MVC 和 SignalR 完成了一个留言板类型的应用程序，它运行得非常好。

[http://knockoutjs.com/](http://knockoutjs.com/)

这里有一个 TODO 应用程序，它也实现了上述技术，[http://www.codeproject.com/Articles/322154/ASP-NET-MVC-SIngalR-and-Knockout-based-Real-time-U](http://www.codeproject.com/Articles/322154/ASP-NET-MVC-SIngalR-and-Knockout-based-Real-time-U)

# java - 如何打印存储在 Tree 中的所有单词，其中已使用 Java 中的 Hashmap 实现 trie？

> ID：16007603
> 
> 赞同：5
> 
> 时间：2013-04-15T04:21:02.370
> 
> 标签：java, hashmap, trie

我想打印或检索存储在 Trie 数据结构中的所有单词。这是因为我想计算拼写错误的单词和字典中的单词之间的编辑距离。因此，我正在考虑从 Trie 中检索每个单词并计算编辑距离。但我无法检索。我想要一些代码片段。这就是我`HashMap`在 Java中使用 Trie 实现的方式

现在请告诉我如何编写代码来打印存储在 Trie 中的所有单词。很感谢任何形式的帮助

**TrieNode.java**

```
package triehash;
import java.io.Serializable;
import java.util.HashMap;

public class TrieNode implements Serializable {

HashMap<Character, HashMap> root;

public TrieNode() {
   root = new HashMap<Character, HashMap>();   
   }
} 
```

**TrieDict.java**

```
package triehash;

import java.io.FileOutputStream;
import java.io.ObjectOutputStream;;
import java.io.Serializable;
import java.util.HashMap;
import java.io.Serializable;

public class TrieDict {   
 public  TrieNode createTree()
 {
     TrieNode t = new TrieNode();
     return t;
 }

 public void add(String s, TrieNode root_node) {
    HashMap<Character, HashMap> curr_node = root_node.root;
    s = s.toLowerCase();
    for (int i = 0, n = s.length(); i < n; i++) {
        Character c = s.charAt(i);
        if (curr_node.containsKey(c))
            curr_node = curr_node.get(c);
        else {
            curr_node.put(c, new HashMap<Character, HashMap>());
            curr_node = curr_node.get(c);
        }
    }
    curr_node.put('\0', new HashMap<Character, HashMap>(0)); // term
  }

 public void serializeDict(TrieNode root_node)
 {    
   try{
        FileOutputStream fout = new FileOutputStream("/home/priya/NetBeansProjects/TrieHash/dict.ser");

    ObjectOutputStream oos = new ObjectOutputStream(fout);   
    oos.writeObject(root_node);
    oos.close();
    System.out.println("Done");

   }catch(Exception ex){
       ex.printStackTrace();
   }
}

 public void addAll(String[] sa,TrieNode root_node) {
    for (String s: sa)
        add(s,root_node);
 }

 public static void main(String[] args)
 {
    TrieDict td = new TrieDict();
    TrieNode tree = td.createTree();

    String[] words = {"an", "ant", "all", "allot", "alloy", "aloe", "are", "ate", "be"};
    for (int i = 0; i < words.length; i++)
      td.add( words[i],tree);       
    td.serializeDict(tree); /* seriliaze dict*/
 }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:55:28.377

首先，值得注意的是`root`实例变量的声明类型有点奇怪。（具体来说， 的值类型`HashMap<Character,HashMap>`不包括您希望它使用的一些泛型。）下面的代码应该可以工作，但是您会因此收到一些警告。您可以尝试重构代码以改用该类型`HashMap<Character,TrieNode>`。对不起，如果那是迂腐的。:)

试试这个，作为方法添加到`TrieNode`：

```
public Set<String> computeWords() {
    Set<String> result;

    if(root.size() == 0)
        result = new HashSet<String>();
    else
        result = computeWords(root, "");

    return result;
}

protected static Set<String> computeWords(HashMap tree, String prefix) {
    Set<String> result=new HashSet<String>();

    if(tree.size() == 0)
        result.add(prefix);
    else
        for(Object o : tree.keySet()) {
            Character c=(Character) o;
            prefix = prefix+c;
            result.addAll(computeWords((HashMap) tree.get(c), prefix));
            prefix = prefix.substring(0, prefix.length()-1);
        }

    return result;
} 
```

对于给定的`TrieNode`对象`t`，`t.computeWords()`将返回在 中编码的所有单词的集合`t`。

我相信这回答了你试图问的问题。但是，要回答标题中所述的问题，您将打印所有相同的单词，`t`如下所示：

```
for(String word : t.computeWords())
    System.out.println(word); 
```

此外，这绝对不是最有效的实现，特别是因为我们在 中创建了一堆`HashSet`对象`computeWords(HashMap,String)`，但它应该可以工作！

**编辑**：此代码还假定您以空结尾的单词`HashMap`。如果您`null`改为使用 终止单词，则需要使用 更新方法`if(tree.size() == 0)`中的检查。抱歉，应该说出来的。`static``if(tree == null)`

**编辑**：解释了如何打印所有的单词，以防万一不清楚。

**编辑**：固定空的特里案例。

# cocoa - Mac 应用程序中的 NSUserDefaults

> ID：16007606
> 
> 赞同：0
> 
> 时间：2013-04-15T04:21:23.673
> 
> 标签：cocoa, nsuserdefaults

我对 Mac OS X 中的 NSUserDefaults 有几个问题：

1.  什么时候`NSUserDefaults`使用提供的字典`registerDefaults`？只有第一次打开应用程序还是每次打开应用程序？

2.  信息`NSUserDefaults`存储在哪里？

3.  如何重置存储在 中的某些值`NSUSerDefaults`？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:41:48.637

幸运的是，Apple 提供了 Cocoa 编程的文档！

您可以查看[NSUserDefaults Class Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)和 **[Preferences and Settings Programming Guide](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i)**以获得有关如何从 Cocoa 应用程序使用 OS X 首选项系统的可靠信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T15:09:40.973

2：该文件将在您的首选项文件夹中：

> ~/Library/Preferences/yourname.yourapp.plist

您可以在 Finder 预览窗格中轻松查看它，这样就不必加载它了。

# php - 在 encodeURIComponent() 之后无法提取后置参数

> ID：16007609
> 
> 赞同：0
> 
> 时间：2013-04-15T04:21:50.637
> 
> 标签：php, javascript, ajax, urlencode

我从表单收集的字段中编码了一个参数字符串`encodeURIComponent()`，然后使用`XMLHttpRequest`.

在我`extract(urldecode($_POST), EXTR_SKIP);`用来将参数提取到变量的服务器端 PHP 脚本中。

尽管在我添加 URI 组件的编码之前该过程运行良好，但现在没有在服务器上提取变量。请问我做错了什么？

这是执行发送的 JavaScript：

```
function postData(url, parameters, postprocess, displayURL, runOnError) {

    // Check whether user action has already failed validation
    if (typeof cancel !== 'undefined') {

        // Deleting a variable only works if a global
        delete cancel;
        return false;

    }

    var
        xmlHttp = AJAX(),
        resp,
        defcon,
        json;

    parameters = EncodeURIComponent(parameters);

    if( url.charAt( 0 ) === '&' ) {

        url = url.slice( 1 );

    }

    xmlHttp.onreadystatechange =  function(){

        if (xmlHttp.readyState == 4) {

            resp = xmlHttp.responseText;

            checkSessionTimeout(resp);

            // REDIRECT TO POST-PROCESSORS
            if (postprocess !== '') {

                // Goto custom post processing function
                eval(unescape(postprocess));

            }

            // Determine whether json response or not
            else if ( resp.charAt( 0 ) == '{' ) {

                // it's json so redirect to...
                jsonGenericRespHandler(resp, displayURL);

            } else {

                // Use generic post process

                /* The following is depreciated. We should
                 * be using jsonGenericRespHandler(resp).
                 */

                if      (resp.toLowerCase().indexOf('error') > -1)      defcon = 'error';
                else if (resp.toLowerCase().indexOf('success') > -1)    defcon = 'success';
                else if (resp.toLowerCase().indexOf('warn') > -1)       defcon = 'warn';
                else                                                    defcon = 'info';

                // Make sure we don't miss an important message.
                if (defcon === 'warn' || defcon === 'error') {

                    alert(resp);
                    eval(runOnError);

                } else {

                    // Redirect to dashboard
                    if (displayURL === '') {

                        ajaxLoader('main/home.php', 'contentMain');

                    } else if (displayURL !== 0) {

                        ajaxLoader(displayURL, 'contentMain');

                    }

                    showMessage(defcon, resp);

                }
            }
        }
    }

    xmlHttp.open("POST", url, true);
    xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlHttp.setRequestHeader("Content-length", parameters.length);
    xmlHttp.setRequestHeader("Connection", "close");
    xmlHttp.send(parameters);
} 
```

我可能应该提到我添加 encodeURIComponent() 的原因是因为我注意到如果访问者在表单中输入了一个合法的 & 符号，它会被视为服务器上的一个额外参数。

# php - 隐藏用户名/密码时重定向到 ftp 服务器？

> ID：16007614
> 
> 赞同：0
> 
> 时间：2013-04-15T04:22:41.257
> 
> 标签：php, mysql, ftp

我目前正在使用它来重定向到 ftp 服务器

```
header('Location: ' . $result['url']); 
```

`$result['url']`包含这样的ftp url

```
ftp:username@password:server 
```

问题是任何人都可以打开控制台并查看安全凭据，

我知道您可以像这样使用 readfile 来隐藏下载网址

```
header("Content-Description: File Transfer");
header("Content-Length: " .(string)(filesize($variable)) );
header('Content-Disposition: attachment; filename="'.basename($variable).'"');
header("Content-Transfer-Encoding: binary\n");
readfile($variable); 
```

ftp url重定向有类似的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:23:52.760

简短的回答：不可能

长答案：根本不可能。即使有可能——无论如何，传递给客户端的内容很容易被发现，因此不安全。

# android - 我应该将 LruCache 标记为易失性吗？

> ID：16007620
> 
> 赞同：0
> 
> 时间：2013-04-15T04:23:23.687
> 
> 标签：android, multithreading, caching

我记得在某处读过 android 保证 LruCache 为所有线程提供最新信息，并且一个线程的操作将在同一个线程看到另一个线程对缓存的编辑之前完成。我正在使用 LruCache 存储从我的应用程序服务器获取的位图，并使用线程池从网络获取位图。

现在我在 Android 文档或任何其他提及中找不到对此的引用。我是否需要将 LruCache 实例标记为 volatile 或围绕缓存操作设置同步（LruCache）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T13:48:21.553

[mibollma 关于Android LruCache Thread Safety](https://stackoverflow.com/questions/7086782/android-lrucache-android-3-1-thread-safety)的回应没有错。人们经常误认为线程安全和原子性。

如果一个类是线程安全的，这意味着，例如，当两个线程调用它的操作时，内部不会中断。Vector就是这样一个类，每个操作都是同步的。如果两个不同的线程调用 Vector.add，它们都会在实例上同步并且状态不会被破坏。例如这样的：

```
synchronized void add(final T obj) {
  objects[index++] = obj;
} 
```

这种线程安全的意思是没有两个线程会在同一位置添加元素。如果它不会同步，他们可以读取 index = 0 并尝试在该位置写入。

现在为什么还需要同步？想象一下，你有这样一个案例：

```
if(!collection.contains(element)) {
  collection.add(element);
} 
```

在这种情况下，您的操作不是原子的。当您询问元素是否已经存在时，您会同步一次，然后在添加该元素时进行第二次同步。但是当另一个线程可以取得进展并且您对不包含该元素的集合的假设被打破时，这两个调用之间存在一个窗口。

在伪代码中：

```
if(!coll.contains(element)) {         // << you have the exclusive lock here
  //Thread 2 calls coll.add(element)     << you do not have the lock anymore
  coll.add(element);                  // << doomed!
} 
```

所以这就是为什么答案是正确的，因为您应该围绕非原子操作进行同步，例如

```
synchronized(coll) {
    if(!coll.contains(element)) {       // << you have the exclusive lock here
      // Thread 2 wants to call            << still holding the lock
      // coll.add(element) but
      // cannot because you hold the lock
      coll.add(element);                // << unicorns!
    }
} 
```

因为同步非常昂贵，并发集合带有原子操作，例如`putIfAbsent`.

现在回到你最初的问题：你应该让 LruCache 易失吗？通常，您不会将 LruCache 本身标记为 volatile，而是将其标记为对它的引用。如果这样的引用是跨线程共享的，并且您计划更新该字段，那么可以。

如果字段未标记为 volatile，则线程可能看不到更新的值。但同样：这只是对 LruCache 本身的引用，与它的内容没有直接关系。

在您的特定场景中，我宁愿使用 final 而不是 volatile 引用，因为`null`无论如何都没有线程应该将引用设置为。

是否需要围绕缓存操作进行同步的问题取决于具体情况。如果您想创建单个原子操作，例如`putIfAbsent`，那么可以。

```
public void putIfAbsent(final K key, final V value) {
  synchronized(lruCache) {
    if(!lruCache.containsKey(key)) {
      lruCache.put(key, value);
    }
  }
} 
```

但是稍后在您的代码中，当您调用 just 时`lruCache.get(key)`，无需将其包装到同步块本身中。仅当您计划创建不应干扰另一个线程的原子操作时。

# eclipse-rcp - 循环遍历 Nebula Grid 中的行

> ID：16007621
> 
> 赞同：0
> 
> 时间：2013-04-15T04:23:25.190
> 
> 标签：eclipse-rcp, nebula

我有一个包含多行数据的星云网格。

如何循环遍历每一行以从中捕获数据？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T09:43:24.317

我只是在自己努力寻找自己问题的答案时遇到了这个问题。无论如何，循环通过一个 nebulagrids 行（或网格项，因为它们被称为）可以这样完成：

```
GridItem[] itemList = grid.getItems();
for(GridItem item:itemList){
    System.out.println(item.getText());
} 
```

根据您要从项目中检索的数据，您必须将 item.getText() 替换为您自己喜欢的内容。

# angularjs - 调用服务后，我的视图在 AngularJS 中没有更新

> ID：16007626
> 
> 赞同：0
> 
> 时间：2013-04-15T04:24:20.747
> 
> 标签：angularjs

我有以下服务：

```
angular.module('adminApp')
.factory('subjectService', function ($http) {
    return {
        get: function (testAccountId) {
            return $http({
                method: 'GET',
                url: '/api/Subjects/GetSelect',
                params: { testAccountId: testAccountId }
            });
        }
    }
}); 
```

当我直接调用 http 但现在使用该服务时，以下代码有效：

```
 $scope.$watch('selectedTestAccount', function () {
        if ($scope.selectedTestAccount != null) {
            $scope.myData = null;

            $http({
                method: 'GET',
                url: '/api/Subjects/GetSelect',
                params: { testAccountId: $scope.selectedTestAccount }
            }).success(function (result) {
                $scope.subjects = result;
                $scope.myData = null;
            });

            //subjectService.get($scope.selectedTestAccount)
            //    .then(function (result) {
            //        $scope.subjects = result;
            //        $scope.myData = null;
            //        alert($scope.subjects);
            //    }, function (result) {
            //        alert("Error: No data returned");
            //    });
        }
    }); 
```

与这个问题有关。这是调用服务的正确方法吗？我看到了另一个看起来像下面的建议并使用了 Promise。我应该这样做：

```
services.factory('MultiRecipeLoader', ['Recipe', '$q',
   function(Recipe, $q) {
      return function() {
         var delay = $q.defer();
         Recipe.query(function(recipes) {
            delay.resolve(recipes);
         }, function() {
            delay.reject('Unable to fetch recipes');
         });
         return delay.promise;
      };
}]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:52:32.220

我试图在 plunker 中重现您的示例。让我知道它是否是您正在寻找的：

[http://plnkr.co/edit/6s5utccjgHTnrrokM1u8?p=preview](http://plnkr.co/edit/6s5utccjgHTnrrokM1u8?p=preview)

在这个演示中，有一个下拉菜单可以更改控制器中**$watched的****帐户**变量的值。如果帐户值发生变化，它会调用 SubjectsServices 并使用主题名称更新无序列表。此外，还有一个填充了相同值的下拉列表。

 **如果更改值的唯一方法是通过下拉菜单，也许您只能在 select 上使用**ng-change**指令来调用将执行相同工作的更新函数。

```
$scope.update = function() {
    SubjectService.get($scope.account).then(function(result) {
        $scope.subjects = result.data;
    }, function(result) {
        // error handling...
    }); 
};

<select ng-change="update()"></select> 
```

在**$http承诺****中**从方法接收的参数中的对象具有包含请求数据的数据属性。

 **```
$http.get(...).then(function(result) {
    var subjects = result.data;
}); 
```****

# python - 局部变量在赋值前被引用；不知道为什么

> ID：16007631
> 
> 赞同：1
> 
> 时间：2013-04-15T04:25:09.940
> 
> 标签：python, pygame, runtime-error

我有大学的这个任务。我现在已经将我的代码更改了 3 次以上，甚至将其调整为可以正常工作的代码。我们有两种模式：一种是幽灵从吃豆人身上反弹，另一种是吃豆人从它们身上反弹。我知道我可以使用列表来缩短此代码，但我仍在学习如何使它们正常工作。

我每次都会遇到这个错误，我真的不知道为什么任何建议都会很棒。

```
Traceback (most recent call last):
  File "C:/", line 111, in <module>
    mode_switch()
  File "C:/", line 21, in mode_switch
    blue_right, orange_right, pink_right,\
UnboundLocalError: local variable 'blue_right' referenced before assignment 
```

### 我的代码

```
import pygame

import pygame
from random import *

pygame.init()

def ghost_collision():

    SCREAM.play()
    pacman_velocity[0] = randint(-1,1)
    pacman_velocity[1] = randint(-1,1)
    if pacman_velocity[0] < 0:
        pacman = pygame.image.load(PACMAN_LEFT).convert()
    elif pacman_velocity[0] > 0:
        pacman = pygame.image.load(PACMAN_RIGHT).convert()
    return pacman_velocity

def mode_switch():
    global mode
    blue_right, orange_right, pink_right,\
          red_right, blue, orange, pink, red
    if mode == False:
        mode = True
        blue = pygame.image.load(GHOST_SCARED).convert()
        orange = pygame.image.load(GHOST_SCARED).convert()
        pink = pygame.image.load(GHOST_SCARED).convert()
        red = pygame.image.load(GHOST_SCARED).convert()
    else:
        mode = False
        if blue_right == True:
            blue = pygame.image.load(BLUE_LEFT).convert()
            blue_right = False
        else:
            blue = pygame.image.load(BLUE_RIGHT).convert()
            blue_right = True
    if orange_right == True:
        orange = pygame.image.load(ORANGE_LEFT).convert()
        orange_right = False
    else:
        orange = pygame.image.load(ORANGE_RIGHT).convert()
        orange_right = True
    if pink_right == True:
        pink = pygame.image.load(PINK_LEFT).convert()
        pink_right = False
    else:
        pink = pygame.image.load(PINK_RIGHT).convert()
        pink_right = True
    if red_right == True:
        red = pygame.image.load(RED_LEFT).convert()
        red_right = False
    else:
        red = pygame.image.load(RED_RIGHT).convert()
        red_right = True

PACMAN_LEFT = 'pacman-left.png'
PACMAN_RIGHT = 'pacman-right.png'
BLUE_LEFT = 'blue-left.png'
BLUE_RIGHT = 'blue-right.png'
ORANGE_LEFT = 'orange-left.png'
ORANGE_RIGHT = 'orange-right.png'
PINK_LEFT = 'pink-left.png'
PINK_RIGHT = 'pink-right.png'
RED_LEFT = 'red-left.png'
RED_RIGHT = 'red-right.png'
GHOST_SCARED = 'vulnerable.png'
BOUNCE_SOUND = 'Thump.wav'
SOUND = pygame.mixer.Sound(BOUNCE_SOUND)
WIDTH = 800
HEIGHT = 600
BACKGROUND_COLOUR = 0, 0, 0
CAPTION = 'Random Pacman'
pacman_up = True#define image direction controlling variables
pacman_right = True
blue_right = False
orange_right = True
pink_right = False
red_right = True
mode = False

frame = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption(CAPTION)
pacman = pygame.image.load(PACMAN_RIGHT).convert()#create sprites and define boundaries
pacman_boundary = pacman.get_rect(center = (300,300))
pacman_velocity = [1, 1]
blue = pygame.image.load(BLUE_LEFT).convert()
blue_boundary = pacman.get_rect(center = (300,300))
blue_velocity = [-1, -1]
orange = pygame.image.load(ORANGE_RIGHT).convert()
orange_boundary = pacman.get_rect(center = (300,300))
orange_velocity = [1, -1]
pink = pygame.image.load(PINK_LEFT).convert()
pink_boundary = pacman.get_rect(center = (300,300))
pink_velocity = [-1, 1]
red = pygame.image.load(RED_RIGHT).convert()
red_boundary = pacman.get_rect(center = (300,300))
red_velocity = [1, 1]

finished = False
while not finished:
    pygame.event.pump()
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            finished = True
        if event.type == pygame.MOUSEBUTTONUP:
            mode_switch()

    #####################################################

if pacman_boundary.left < 0 or pacman_boundary.right > WIDTH:
    SOUND.play()
    pacman_velocity[0] = -1 * pacman_velocity[0]
    if pacman_velocity[0] < 0:
        pacman = pygame.image.load(PACMAN_LEFT).convert()
    elif pacman_velocity[0] > 0:
        pacman = pygame.image.load(PACMAN_RIGHT).convert()
    pacman_velocity[1] = randint(-1,1)

if pacman_boundary.top < 0 or pacman_boundary.bottom > HEIGHT:
    SOUND.play()
    pacman_velocity[1] = -1 * pacman_velocity[1]

if mode == False:        
    if pacman_boundary.colliderect(blue_boundary)\
       or pacman_boundary.colliderect(orange_boundary)\
       or pacman_boundary.colliderect(pink_boundary)\
       or pacman_boundary.colliderect(red_boundary):
        ghost_collision()

    #####################################################

if blue_boundary.left < 0 or blue_boundary.right > WIDTH:
    blue_velocity[0] = -1 * blue_velocity[0]
    if mode == False:
        if blue_right == True:
            blue = pygame.image.load(BLUE_LEFT).convert()
            blue_right = False
        else:
            blue = pygame.image.load(BLUE_RIGHT).convert()
            blue_right = True

if blue_boundary.top < 0 or blue_boundary.bottom > HEIGHT:
    SOUND.play()
    blue_velocity[1] = -1 * blue_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(blue_boundary):

        blue_velocity[0] = randint(-1,1)
        blue_velocity[1] = randint(-1,1)

#####################################################

if orange_boundary.left < 0 or orange_boundary.right > WIDTH:
    orange_velocity[0] = -1 * orange_velocity[0]
    if mode == False:
        if orange_right == True:
            orange = pygame.image.load(ORANGE_LEFT).convert()
            orange_right = False
        else:
            orange = pygame.image.load(ORANGE_RIGHT).convert()
            orange_right = True

if orange_boundary.top < 0 or orange_boundary.bottom > HEIGHT:
    SOUND.play()
    orange_velocity[1] = -1 * orange_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(orange_boundary):
        orange_velocity[0] = randint(-1,1)
        orange_velocity[1] = randint(-1,1)

#####################################################

if pink_boundary.left < 0 or pink_boundary.right > WIDTH:#
    pink_velocity[0] = -1 * pink_velocity[0]
    if mode == False:
        if pink_right == True:
            pink = pygame.image.load(PINK_LEFT).convert()
            pink_right = False
        else:
            pink = pygame.image.load(PINK_RIGHT).convert()
            pink_right = True

if pink_boundary.top < 0 or pink_boundary.bottom > HEIGHT:
    SOUND.play()
    pink_velocity[1] = -1 * pink_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(pink_boundary):
        pink_velocity[0] = randint(-1,1)
        pink_velocity[1] = randint(-1,1)

#####################################################

if red_boundary.left < 0 or red_boundary.right > WIDTH:
    red_velocity[0] = -1 * red_velocity[0]
    if mode == False:
        if red_right == True:
            red = pygame.image.load(RED_LEFT).convert()
            red_right = False
        else:
            red = pygame.image.load(RED_RIGHT).convert()
            red_right = True

if red_boundary.top < 0 or red_boundary.bottom > HEIGHT:
    SOUND.play()
    red_velocity[1] = -1 * red_velocity[1]

if mode == True:
    if pacman_boundary.colliderect(red_boundary):
        red_velocity[0] = randint(-1,1)
        red_velocity[1] = randint(-1,1)

#####################################################

pacman_boundary = pacman_boundary.move(pacman_velocity)
blue_boundary = blue_boundary.move(blue_velocity)
orange_boundary = orange_boundary.move(orange_velocity)
pink_boundary = pink_boundary.move(pink_velocity)
red_boundary = red_boundary.move(red_velocity)

frame.fill(BACKGROUND_COLOUR)
frame.blit(pacman, pacman_boundary)
frame.blit(blue, blue_boundary)
frame.blit(orange, orange_boundary)
frame.blit(pink, pink_boundary)
frame.blit(red, red_boundary)
pygame.display.flip()

pygame.quit() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:39:20.583

认为问题出在以下几行：

```
def mode_switch():
    global mode
    blue_right, orange_right, pink_right,\
          red_right, blue, orange, pink, red 
```

您将 mode 定义为全局变量，而不是在您的程序中看起来是全局变量的其余变量，例如，您需要将它们更新为全局变量 - 因为您在 mode_switch 函数中修改它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T04:40:18.597

```
blue_right, orange_right, pink_right,\
          red_right, blue, orange, pink, red 
```

这条线明显断了。至少前一行的“全局”声明在这里没有效果。可能您在 global 语句的行中缺少尾随 '\'，或者相应的行需要它自己的 global 语句。

# runtime-error - 谁能帮我找到大的 theta 运行时复杂度

> ID：16007633
> 
> 赞同：0
> 
> 时间：2013-04-15T04:25:27.650
> 
> 标签：runtime-error, time-complexity, big-theta

我对 Big Theta ( **Θ** ) 运行时复杂度的概念不熟悉，

我有以下递归关系要分析，

**T(n) = 2T(n/3) + 5n ²** 我得到**Θ( ² )**

**T(n) = T(n/4) + n ⁴** 我得到**Θ(n ⁴ )**

请验证我的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:56:42.547

你的答案是正确的。您可以通过应用主定理来解决这些问题。

链接是主定理，

[http://en.wikipedia.org/wiki/Master_theorem#Generic_form](http://en.wikipedia.org/wiki/Master_theorem#Generic_form)

如果**T(n) = a T(n/b) + f(n)**其中 a >= 1 且 b > 1

我们需要考虑主定理的案例3，

案例 3：如果**f(n) = Θ(n ^c )** 其中**c > log [b] a**

那么**T(n) = Θ(n ^c )**

**第一次复发**

T(n) = 2T(n/3) + 5n ²

a = 2, b = 3 和 f(n) = 5 n ²

其中，f(n) = Θ(n ^c )，其中 c = 2。

现在 c > log [b] a since 2 > log [3] 2。

因此，您提到的T(n) = Θ(n ^(2 )。)

**第二次复发**

T(n) = T(n/4) + n ⁴

a = 1, b = 4 和 f(n) = n ⁴

其中，f(n) = Θ(n ^c )，其中 c = 4。

现在 c > log [b] a since 4 > log [4] 1。

因此，您提到的T(n) = Θ(n ^(4 )。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:28:44.237

这些都是正确的。因为每个递归方程的第二项比第一项高得多，所以它将支配第一项（用外行的话来说）。

# c - OpenMP：并行快速排序

> ID：16007640
> 
> 赞同：5
> 
> 时间：2013-04-15T04:27:19.550
> 
> 标签：c, multithreading, parallel-processing, openmp, quicksort

我尝试使用 OpenMP 在分区部分和 QuickSort 部分中并行化 QuickSort。我的C代码如下：

```
#include "stdlib.h"
#include "stdio.h"
#include "omp.h"

// parallel partition
int ParPartition(int *a, int p, int r) {
    int b[r-p];
    int key = *(a+r); // use the last element in the array as the pivot
    int lt[r-p]; // mark 1 at the position where its element is smaller than the key, else 0
    int gt[r-p]; // mark 1 at the position where its element is bigger than the key, else 0
    int cnt_lt = 0; // count 1 in the lt array
    int cnt_gt = 0; // count 1 in the gt array
    int j=p;
    int k = 0; // the position of the pivot
    // deal with gt and lt array
    #pragma omp parallel for
    for ( j=p; j<r; ++j) {
        b[j-p] = *(a+j);
        if (*(a+j) < key) {
            lt[j-p] = 1;
            gt[j-p] = 0;
        } else {
            lt[j-p] = 0;
            gt[j-p] = 1;
        }
    }
    // calculate the new position of the elements
    for ( j=0; j<(r-p); ++j) {
        if (lt[j]) {
            ++cnt_lt;
            lt[j] = cnt_lt;
        } else
            lt[j] = cnt_lt;
        if (gt[j]) {
            ++cnt_gt;
            gt[j] = cnt_gt;
        } else
            gt[j] = cnt_gt;
    }
    // move the pivot
    k = lt[r-p-1];
    *(a+p+k) = key;
    // move elements to their new positon
    #pragma omp parallel for 
    for ( j=p; j<r; ++j) {
        if (b[j-p] < key)
            *(a+p+lt[j-p]-1) = b[j-p];
        else if (b[j-p] > key)
            *(a+k+gt[j-p]) = b[j-p];
    }
    return (k+p);
}

void ParQuickSort(int *a, int p, int r) {
    int q;
    if (p<r) {
        q = ParPartition(a, p, r);
        #pragma omp parallel sections
        {
        #pragma omp section
        ParQuickSort(a, p, q-1);
        #pragma omp section
        ParQuickSort(a, q+1, r);
        }
    }
}

int main() {
    int a[10] = {5, 3, 8, 4, 0, 9, 2, 1, 7, 6};
    ParQuickSort(a, 0, 9);
    int i=0;
    for (; i!=10; ++i)
        printf("%d\t", a[i]);
    printf("\n");
    return 0;
} 
```

对于main函数中的例子，排序结果为：

```
0   9   9   2   2   2   6   7   7   7 
```

我使用gdb进行调试。在早期的递归中，一切顺利。但是在某些递归中，它突然搞砸了，开始重复元素。然后生成上面的结果。

有人可以帮我找出问题所在吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T08:50:06.363

我对我的第一个评论感到抱歉。与您的问题无关。我没有找到您问题的真正问题（可能您的移动元素有问题）。根据您的意见，我写了一个类似的程序，它工作正常.（我也是 OpenMP 的新手）。

```
#include <stdio.h>
#include <stdlib.h>

int partition(int * a, int p, int r)
{
    int lt[r-p];
    int gt[r-p];
    int i;
    int j;
    int key = a[r];
    int lt_n = 0;
    int gt_n = 0;

#pragma omp parallel for
    for(i = p; i < r; i++){
        if(a[i] < a[r]){
            lt[lt_n++] = a[i];
        }else{
            gt[gt_n++] = a[i];
        }   
    }   

    for(i = 0; i < lt_n; i++){
        a[p + i] = lt[i];
    }   

    a[p + lt_n] = key;

    for(j = 0; j < gt_n; j++){
        a[p + lt_n + j + 1] = gt[j];
    }   

    return p + lt_n;
}

void quicksort(int * a, int p, int r)
{
    int div;

    if(p < r){ 
        div = partition(a, p, r); 
#pragma omp parallel sections
        {   
#pragma omp section
            quicksort(a, p, div - 1); 
#pragma omp section
            quicksort(a, div + 1, r); 

        }
    }
}

int main(void)
{
    int a[10] = {5, 3, 8, 4, 0, 9, 2, 1, 7, 6};
    int i;

    quicksort(a, 0, 9);

    for(i = 0;i < 10; i++){
        printf("%d\t", a[i]);
    }
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-20T17:22:46.607

我决定发布这个答案是因为：

1.  **[接受的答案是错误](https://stackoverflow.com/a/16011125/1366871)**的，并且这些天用户似乎不活跃。有一个*竞争*条件

    ```
     #pragma omp parallel for
     for(i = p; i < r; i++){
         if(a[i] < a[r]){
             lt[lt_n++] = a[i]; //<- race condition lt_n is shared
         }else{
             gt[gt_n++] = a[i];  //<- race condition gt_n is shared
         }   
     } 
    ```

2.  尽管如此，即使它是正确的，**这个问题的现代答案是使用 OpenMP`tasks`而不是`sections`.**

我正在为社区提供这种方法的完整可运行示例，包括测试和分析。

```
#include <assert.h>
#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <omp.h>

#define TASK_SIZE 100

unsigned int rand_interval(unsigned int min, unsigned int max)
{
    // https://stackoverflow.com/questions/2509679/
    int r;
    const unsigned int range = 1 + max - min;
    const unsigned int buckets = RAND_MAX / range;
    const unsigned int limit = buckets * range;

    do
    {
        r = rand();
    } 
    while (r >= limit);

    return min + (r / buckets);
}

void fillupRandomly (int *m, int size, unsigned int min, unsigned int max){
    for (int i = 0; i < size; i++)
    m[i] = rand_interval(min, max);
} 

void init(int *a, int size){
   for(int i = 0; i < size; i++)
       a[i] = 0;
}

void printArray(int *a, int size){
   for(int i = 0; i < size; i++)
       printf("%d ", a[i]);
   printf("\n");
}

int isSorted(int *a, int size){
   for(int i = 0; i < size - 1; i++)
      if(a[i] > a[i + 1])
        return 0;
   return 1;
}

int partition(int * a, int p, int r)
{
    int lt[r-p];
    int gt[r-p];
    int i;
    int j;
    int key = a[r];
    int lt_n = 0;
    int gt_n = 0;

    for(i = p; i < r; i++){
        if(a[i] < a[r]){
            lt[lt_n++] = a[i];
        }else{
            gt[gt_n++] = a[i];
        }   
    }   

    for(i = 0; i < lt_n; i++){
        a[p + i] = lt[i];
    }   

    a[p + lt_n] = key;

    for(j = 0; j < gt_n; j++){
        a[p + lt_n + j + 1] = gt[j];
    }   

    return p + lt_n;
}

void quicksort(int * a, int p, int r)
{
    int div;

    if(p < r){ 
        div = partition(a, p, r); 
        #pragma omp task shared(a) if(r - p > TASK_SIZE) 
        quicksort(a, p, div - 1); 
        #pragma omp task shared(a) if(r - p > TASK_SIZE)
        quicksort(a, div + 1, r); 
    }
}

int main(int argc, char *argv[])
{
        srand(123456);
        int N  = (argc > 1) ? atoi(argv[1]) : 10;
        int print = (argc > 2) ? atoi(argv[2]) : 0;
        int numThreads = (argc > 3) ? atoi(argv[3]) : 2;
        int *X = malloc(N * sizeof(int));
        int *tmp = malloc(N * sizeof(int));

        omp_set_dynamic(0);              /** Explicitly disable dynamic teams **/
        omp_set_num_threads(numThreads); /** Use N threads for all parallel regions **/

         // Dealing with fail memory allocation
        if(!X || !tmp)
        { 
           if(X) free(X);
           if(tmp) free(tmp);
           return (EXIT_FAILURE);
        }

        fillupRandomly (X, N, 0, 5);

        double begin = omp_get_wtime();
        #pragma omp parallel
        {
            #pragma omp single
             quicksort(X, 0, N);
        }   
        double end = omp_get_wtime();
        printf("Time: %f (s) \n",end-begin);

        assert(1 == isSorted(X, N));

        if(print){
           printArray(X, N);
        }

        free(X);
        free(tmp);
        return (EXIT_SUCCESS);

    return 0;
} 
```

如何运行：

该程序接受三个参数：

1.  数组的大小；
2.  是否打印数组，0为否，否则为是；
3.  并行运行的线程数。

**迷你基准**

在 4 核机器中：输入 100000

```
1 Thread  -> Time: 0.784504 (s)
2 Threads -> Time: 0.424008 (s) ~ speedup 1.85x
4 Threads -> Time: 0.282944 (s) ~ speedup 2.77x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T14:16:58.417

我已经在生产环境中实现了并行快速排序，尽管使用并发进程（即 fork() 和 join()）而不是 OpenMP。我还找到了一个相当不错的 pthread 解决方案，但就最坏情况的运行时间而言，并发进程解决方案是最好的。首先让我说您似乎没有为每个线程制作输入数组的副本，因此您肯定会遇到可能破坏数据的竞争条件。

本质上，发生的事情是您在共享内存中创建了一个数组*N*`#pragma omp parallel sections` ，当您执行 a 时，您将产生与`#pragma omp section`'s 一样多的工作线程。每次工作线程尝试访问和修改 a 的元素时，都会执行一系列指令：“从给定地址读取*N*的第 n 个值”、“修改*N*的第 n 个值”、“写入*N*的第 n 个值返回给定地址”。由于您有多个没有锁定或同步的线程，读取、修改和写入指令可以由多个处理器以任意顺序执行，因此线程可能会覆盖彼此的修改或读取未更新的值。

我发现的最佳解决方案（经过数周的测试和基准测试，我想出了许多解决方案）是将列表*log(n)*细分，其中*n*是处理器的数量。例如，如果您有一台四核机器 (n = 4)，则将列表细分 2 次 (log(4) = 2)，选择作为数据集中位数的枢轴。重要的是枢轴是中位数，否则您可能会遇到选择不当的枢轴导致列表在进程之间分布不均的情况。然后每个进程对其本地子数组进行快速排序，然后将其结果与其他进程的结果合并。这被称为“hyperquicksort”，从最初的 github 搜索中，我发现[了这个](https://github.com/danielpetroianu/COSP/wiki/Hyperquicksort). 我不能保证那里的代码，也不能发布我写的任何代码，因为它受 NDA 保护。

顺便说一句，最好的并行排序算法之一是 PSRS（常规采样并行排序），它使列表大小在进程之间更加平衡，不会在进程之间不必要地通信密钥，并且可以在任意数量的并发进程上工作（它们不一定是 2) 的幂。

# c - fread 无法读取无符号整数？[C]

> ID：16007643
> 
> 赞同：0
> 
> 时间：2013-04-15T04:27:56.483
> 
> 标签：c, file, binaryfiles

我有一个`Person`结构如下：

```
typedef struct Person {
    char name[NUM_CHARS];
    unsigned int age;
} Person; 
```

哪里`#define NUM_CHARS 20`。

我想将此结构写入二进制文件，因此我编写了两个函数来处理它：

```
int writePerson(Person* person, FILE* _fp) {
    int i = 0;
    int count = 0;
    int len = strlen(person->name);
    // Write name
    for(i = 0; i < len+1; i++) {
        count += fwrite(&(person->name[i]), sizeof(char), 1, _fp);
    //  fseek(_fp, 1, SEEK_CUR);
    }
    // Continue
    // Write age
    count += fwrite(&(person->age), sizeof(unsigned int), 1, _fp);

    return count;
}

int readPerson(Person* person, FILE* _fp) {
    int i = 0;
    int count = 0;
    // Write name
    for(i = 0;person->name[i] != NULL;i++) {
        count += fread(&(person->name[i]), sizeof(char), 1, _fp);
    }
    // Continue
    // Write age
    count += fread(&(person->age), sizeof(unsigned int), 1, _fp);

    return count;
} 
```

所以我写了一个我提前创建好的`Person`空白文件：`Px.bin`

```
int main() {
    FILE* fp = fopen("Px.bin", "r+b");
    Person person = {"Billie", 40};
//  Person y ;
    int x = writePerson(&person, fp);
    printf("%d", x);
//  printPerson(&y);
    getchar();
    fcloseall();
    return 0;
} 
```

似乎运作良好，打印`8`。

但是当我尝试阅读这个文件时：

```
int main() {
    FILE* fp = fopen("Px.bin", "r+b");
//  Person person = {"Billie", 40};
    Person y ;
    int x = readPerson(&y, fp);
    printf("%d\n", x);
    printPerson(&y);
    getchar();
    fcloseall();
    return 0;
} 
```

我得到这个结果：

```
11
Billie
-858993460 
```

printPerson 在哪里：

```
void printPerson(Person* p) {
    printf("%s\n%d\n", p->name, p->age);
} 
```

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:35:45.470

您读取名称的代码会检查可能未初始化（或归零）的`person->name[i]`元素。结果循环在某个不可预测的时间结束（即，如果它被清零，循环`fread`甚至不会是单个字符）。

```
for(i = 0;person->name[i] != NULL;i++) {
    count += fread(&(person->name[i]), sizeof(char), 1, _fp);
} 
```

您想将其更改为`do`/`while`循环，而不是读取`0`文件字符串中具有长度的前缀数据并读取那么多字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:35:57.853

这一点

```
for(i = 0;person->name[i] != NULL;i++) {
    count += fread(&(person->name[i]), sizeof(char), 1, _fp);
} 
```

将使用未初始化（IOW，包含垃圾）`person->name[]`作为读取条件。并且可能会在此处读取错误的字节数。

之后以下

```
count += fread(&(person->age), sizeof(unsigned int), 1, _fp); 
```

可以从文件中的错误位置读取整数，而不是从存储所述整数的位置读取整数。

解决方法是先读取一个字符，然后看看它是否`'\0'`存在。如果是，则字符串已被完全读取。如果不是，请继续阅读字符。

# java - Java - 了解克隆

> ID：16007644
> 
> 赞同：3
> 
> 时间：2013-04-15T04:27:59.683
> 
> 标签：java, clone, private, super

今天在我的计算机科学课上展示了这段代码（伴随着几个与这篇文章无关的问题）。这**不是**作业，只是我个人在代码中发现的一些问题；

```
public class CloneClass implements Cloneable {
    private Element element ;

    public CloneClass ( Element newElement ) {
        element = newElement ;
    }

    public CloneClass clone () {
        try {
            // I don't understand this
            CloneClass copy = ( CloneClass ) super.clone ();
            // or this
            copy.element = element.clone ();

            return copy ;
        } catch ( CloneNotSupportedException e ) {
            return null ;
        }
    }
} 
```

**首先;**

```
CloneClass copy = ( CloneClass ) super.clone (); 
```

我们知道 super 是 Object （因为没有显式扩展）并且它`super.clone()`必须返回一个实例`CloneClass`（它不能返回一个`Object`实例，因为它是抽象的，并且它被向下转换为`CloneClass`，所以它必须是一个`CloneClass`或后代实例）。
我的问题; 怎么`super.clone()`知道返回一个`CloneClass`实例？

**第二;**

```
copy.element = element.clone (); 
```

怎么可能这样直接引用`copy.element`；它被宣布为私有！
它不是当前类的属性，而是另一个实例的属性（恰好是同一个类）

**第三；**

```
} catch ( CloneNotSupportedException e ) { 
```

为什么需要这个？这是incase`Element`不延长`Cloneable`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T04:32:14.913

> super.clone() 如何知道返回一个 CloneClass 实例？

即使在一个`super`方法内，`this`仍然指向同一个对象，所以`this.getClass()`会给你`CloneClass`（甚至是一个子类）。

> 怎么可能像这样直接引用copy.element；它被宣布为私有！

您不仅可以访问 的私有字段，还可以访问*同一类*`this`的其他实例的私有字段。它只对其他类是私有的。

 *> 为什么需要这个？这是 incase Element 不扩展 Cloneable 吗？

因为`CloneClass`可能不会扩展 Cloneable（它显然是这样做的，但由于这个 API 是如何设计的 Object#clone 抛出 CloneNotSupportedException，编译器无法建立这个连接）。

这在 Java 中有点丑陋的设计缺陷。Object 有一个`clone`方法，但是 Object 本身不是 Cloneable （这是一个标记接口）。因此，您可以在不支持它的对象上调用该方法。与可序列化类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:40:09.453

1) Object.clone API 声明对于任何对象 x，x.clone().getClass() == x.getClass() 为真

2）可以访问私有的copy.element，因为我们在同一个类中访问它

3）如果Element没有实现Cloneable，element.clone()会抛出CloneNotSupportedException，会被捕获并返回null

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:32:48.633

`Object#clone`签名是

> 受保护的对象 clone() 抛出 CloneNotSupportedException

`Object`它复制包含被克隆对象的内部“深层结构”的任何可变对象并返回`CloneClass`.

> copy.element = element.clone();

您可以引用私有字段，因为您自己在同一个班级。

> } 捕捉（CloneNotSupportedException e）{

`Object#clone``CloneNotSupportedException`如果对象的类不支持 Cloneable 接口，则抛出。覆盖 clone 方法的子类也可以抛出此异常，表示无法克隆实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T04:58:05.410

```
// I don't understand this
CloneClass copy = ( CloneClass ) super.clone (); 
```

构造此对象的副本，按位复制其所有成员，包括原始类型和引用类型。

```
// or this
copy.element = element.clone (); 
```

看上面。在此行之前，`copy.element`指向与 相同的对象`this.element`。这一行克隆了它，所以它们现在指向不同的元素，所以克隆`this`现在完全独立于`this`.*

# php - 检查服务器状态的问题

> ID：16007650
> 
> 赞同：0
> 
> 时间：2013-04-15T04:29:01.407
> 
> 标签：php

我有一个简单的脚本来检查服务器是在线还是离线，但是这个脚本似乎不适用于我想要的服务器。

这是脚本：

```
$value = mysql_result($result,$i,"servername");
$value2 = mysql_result($result,$i,"serveraddress");
$value3 = mysql_result($result,$i,"portnumber");
$value4 = mysql_result($result,$i,"description");
$id = mysql_result($result,$i,"id");

ob_start();

if (!$socket = @fsockopen($value2, $value3, $errno, $errstr, 1))
{
    echo "&nbsp;<font color='red'><CENTRE><strong>OFFLINE</strong></CENTRE></font>";
}
else 
{
    echo "&nbsp;<font color='green'><CENTRE><strong>ONLINE</strong></CENTRE></font>";  

    fclose($socket);
}
$status = ob_get_contents();
ob_end_clean();
?> 
```

问题是，如果我说使用谷歌地址和端口 80，它会显示谷歌的在线，如果我使用外部 IP 地址和像 7000 这样的端口，它不会显示服务器是否在线，尽管它在线。我不确定为什么会这样，我认为这可能是因为在显示端口已关闭时没有数据通过端口发送。

有人可以对此有所了解，也许可以纠正这种情况。

# macos - Mac OS 上的 ImageMagick 部署

> ID：16007654
> 
> 赞同：3
> 
> 时间：2013-04-15T04:29:13.303
> 
> 标签：macos, imagemagick, cmake

我正在尝试使用我自己的软件部署 ImageMagick。在 Windows 上，我刚刚在 exe 路径中包含了所有带有编码器 dll 的核心 dll，它运行良好。但是在 mac os 上，我遇到了编码器的麻烦。我通过 macports 安装了 ImageMagick，并在 CMake 的帮助下找到了它。CMake 完成了复制和修复我链接的所有核心库的所有工作。然后我复制了所有的编码器库并修复了它们，但是当我启动我的应用程序时，它就是找不到任何编码器。所以我想知道我在那里错过了什么。

注意：如果我没有修复任何路径，它运行良好。只有我的部署有问题。也许我应该包含某种配置文件？

PS我在MacOS捆绑子文件夹中的可执行文件附近拥有所有ImageMagick库，包括编码器SO。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T08:54:31.390

在你的包中设置 MAGICK_CODER_MODULE_PATH 怎么样？

见这里： [http ://www.imagemagick.org/script/resources.php](http://www.imagemagick.org/script/resources.php)

**编辑：**

改善信息：

最初在我们自己的应用程序包中嵌入 IM 时，我们遇到了三个问题：

1.  我们的应用程序和 IM dylib 没有找到引用的 IM dylib，
2.  IM 找不到它的配置文件，
3.  IM 找不到编码器（No Decode Delegate 错误）

我们尝试使用 install_name_tool 更改 dylibs 中的硬编码路径，但最后在进行一些测试时将 IM 移动到不同的目录并进行测试

```
convert -debug configuration 
```

我们发现，只要在运行 convert 之前在终端控制台中设置和导出至少这三个环境变量，就可以解决上述所有三个问题：

```
DYLD_LIBRARY_PATH
MAGICK_CONFIGURE_PATH
MAGICK_CODER_MODULE_PATH 
```

有了这个经验，我们回到了我们的包，并在开始时尝试使用 Info.plist 字段来设置这些变量，但它似乎不起作用 - 可能是因为在包中设置 IM 相对路径时存在问题.

最后，我们创建了一个简单的 sh 脚本并将其放入我们的包中，并将此包配置为运行此脚本而不是主应用程序：

```
#!/bin/sh
CURR_DIR="$( cd -P "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
IMAGE_MAGICK_PATH=$CURR_DIR/../Resources/ImageMagick

export DYLD_LIBRARY_PATH=$IMAGE_MAGICK_PATH/lib
export MAGICK_CONFIGURE_PATH=$IMAGE_MAGICK_PATH/lib/ImageMagick-6.8.0/config
export MAGICK_CODER_MODULE_PATH=$IMAGE_MAGICK_PATH/lib/ImageMagick-6.8.0/modules-Q16/coders

# run application
exec $CURR_DIR/OurAppName 
```

使其正常工作的关键是正确获取应用程序包的 CURR_DIR（感谢[这篇文章](https://stackoverflow.com/questions/59895/can-a-bash-script-tell-what-directory-its-stored-in)）。

正如我们的测试得出的那样，以这种方式设置环境变量使它们仅在此应用程序执行上下文中可见 - 即当我们使用捆绑包启动应用程序时，打开终端并输入

```
env 
```

输出中缺少上述三个变量。

希望这将帮助其他人节省几天的研究时间并从头上拔毛；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-01T06:02:34.540

在 CMake 的帮助下，我找到了在捆绑包中部署 ImageMagick 的完整解决方案。如果您不使用 CMake，那么 @Tomasz 的回答也会有所帮助。那么让我们开始吧：

首先，您需要知道在您自己的代码中使用 ImageMagick 时试图定位的内容和位置。要找出它，您可以使用可以设置为[这些](http://www.imagemagick.org/script/command-line-options.php#debug)参数的**MAGICK_DEBUG环境变量。**当您调试 ImageMagick 时，它真的很有帮助。

先决条件：我假设您使用 FIND_PACKAGE 和 FIXUP_BUNDLE 来查找 ImageMagick 并在包中设置其二进制路径。剩下的唯一事情就是部署编码器。我还假设您已经从 Mac Ports 安装了 ImageMagick。

1.  我们需要获取 ImageMagick 版本字符串来正确定位编码器：

    ```
    STRING(REGEX REPLACE "-.+" "" ImageMagick_SHORT_VERSION ${ImageMagick_VERSION_STRING}) 
    ```

    现在**ImageMagick_SHORT_VERSION**包含完整版本，没有任何子版本。

2.  然后我们需要将所有编码器复制到一些预定义的文件夹中（我使用了 MacOS 捆绑包部分下的 ImageMagick/coders 子文件夹）

    ```
    FILE(COPY /opt/local/lib/ImageMagick-${ImageMagick_SHORT_VERSION}/modules-Q16/coders/ DESTINATION ${PATH_TO_YOUR_BUNDLE}/Contents/MacOS/ImageMagick/coders/) 
    ```

3.  现在我们需要修复我们拥有的所有 *.so 库，所以我们列出它并传递给 fixup_bundle

    ```
    FILE(GLOB IMAGEMAGICK_CODERS ${PATH_TO_YOUR_BUNDLE}/Contents/MacOS/ImageMagick/coders/*.so) 
    ```

4.  现在我们应该更新伴随编码器 *.so 的 *.la 文件。为了实现它，我使用了脚本：

    ```
    INSTALL(SCRIPT LaScript.cmake COMPONENT Runtime) 
    ```

脚本内容：

```
SET(TARGET_BINARY_DIR "${PATH_TO_YOUR_BUNDLE}")
FILE(GLOB IMAGEMAGICK_CODERS_LA ${TARGET_BINARY_DIR}/Contents/MacOS/ImageMagick/coders/*.la)
FOREACH(file ${IMAGEMAGICK_CODERS_LA})
    FILE(READ ${file} FILE_CONTENT)
    STRING(REGEX REPLACE "dependency_libs='.*'" " " MODIFIED_FILE_CONTENT ${FILE_CONTENT})
    STRING(REGEX REPLACE "libdir='.*'" " " MODIFIED_FILE_CONTENT ${MODIFIED_FILE_CONTENT})
    FILE(WRITE ${file} ${MODIFIED_FILE_CONTENT})
ENDFOREACH() 
```

我们几乎准备好了，唯一剩下要做的就是改变我们启动应用程序的方式。但是让我们离题一点，找出 ImageMagick 搜索编码器的位置：

*   它试图获取**MAGICK_CODER_MODULE_PATH**环境变量的内容
*   然后它检查是否定义了**MAGICKCORE_CODER_PATH**宏（实际上确实定义了！）并使用它的值。

然后它将尝试使用**MAGICK_HOME**环境变量和**MAGICKCORE_CODER_RELATIVE_PATH**来获取模块的路径，但我们不在乎，因为无论如何我们都会在 #2 上停止！（注意：Mac Ports 安装确实如此）

所以我们可以干扰搜索的唯一方法是设置**MAGICK_CODER_MODULE_PATH**环境变量（我们也可以编辑 libMagickCodre 并用我们需要的一些静态路径替换**MAGICKCORE_CODER_PATH**但这太脆弱了，如果有人设置它不会拯救我们无论如何， **MAGICK_CODER_MODULE_PATH**）我们不应该在系统范围内设置它，因为我们可以破坏一些用户安装，所以我们有两个选项：

*   使用 LSEnvironment 将 MAGICK_CODER_MODULE_PATH 设置**为**某个预定义的位置
*   使用脚本启动我们的应用程序并在其中设置此变量。

我选择了后者，因为它更灵活，我有以下脚本：

```
#!/bin/bash
working_dir="${0%/*}"
export MAGICK_CODER_MODULE_PATH=$working_dir/ImageMagick/coders
executable="${working_dir}/ApplicationName"
"$executable" 
```

并设置`CFBundleExecutable`为脚本的名称。

这就是全部，我希望它可以帮助某人节省他/她的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T06:33:06.500

您应该遵循[Mac OS X 特定的构建说明](http://www.imagemagick.org/script/advanced-unix-installation.php#macosx)，但`--enable-shared`在`configure`选项中指定（有关详细信息，请参阅[本文档](http://www.imagemagick.org/script/advanced-unix-installation.php)）。

我猜您的应用程序找不到编解码器，因为它们已静态链接到 ImageMagick 工具。这通常是为了解决可移植性问题。要使编解码器在您的应用程序中可用，您应该将它们构建为共享对象。

# c - 将两个功能合二为一

> ID：16007656
> 
> 赞同：0
> 
> 时间：2013-04-15T04:29:29.783
> 
> 标签：c, function

我有两个分别实现编码和解码的函数：

```
void
delta_encode (char *buffer, const unsigned int length)
{
 char delta = 0;
 char original;
 unsigned int i;
 for (i = 0; i < length; ++i)
 {
  original = buffer[i];
  buffer[i] -= delta;
  delta = original;
 }
}

void
delta_decode (char *buffer, const unsigned int length)
{
 char delta = 0;
 unsigned int i;
 for (i = 0; i < length; ++i)
 {
  buffer[i] += delta;
  delta = buffer[i];
 }
} 
```

我不喜欢这些的是它们非常相似，除了 += 与 -= 部分。有没有办法将它们组合成一个函数，它会询问用户是要编码还是解码，并分别选择 -= 或 += 版本。如果有，它的代码会是什么样子？如果有几种方法可以做到这一点，哪种方法最好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:44:33.030

如果您有相同的代码但对于符号，您可以在函数调用中添加一个参数，如果您有编码版本，则将您`encode/decode`添加的内容乘以。`-1`因此：

```
typedef enum {ENCODE = -1; DECODE = 1;} CODE_TYPE;

void delta_code(char *buffer, const unsigned int length, CODE_TYPE e);

void delta_code(char *buffer, const unsigned int length, CODE_TYPE e) 
  {
  char delta = 0;
  char original;
  unsigned int i;
  for (i = 0; i < length; ++i)
    {
    original = buffer[i];
    buffer[i] += delta*e;
    delta = (e<0)?original:buffer[i];
    }
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T05:19:24.453

只要这是一个“智力练习”，我还不如发布这个，它捕获了编码/解码的对称性：

```
#include <stdbool.h>

void delta_code(char *buffer, const unsigned int length, bool encode) 
{
    char delta = 0;
    unsigned int i;
    for (i = 0; i < length; ++i)
    {
        char next_delta;
        if (encode)
        {
            next_delta = buffer[i];
            buffer[i] -= delta;
        }
        else
        {
            buffer[i] += delta;
            next_delta = buffer[i];
        }
        delta = next_delta;
    }
} 
```

编辑： OP 提到了语言功能。如果 C 有一个广义的后缀减法，比如说`=-`它像后缀一样工作，因为它在减法*之前*`--`返回左侧的值，那么你可以这样做：

 *```
 for (i = 0; i < length; ++i)
       delta = encode? (buffer[i] =- delta) : (buffer[i] += delta); 
```

当然，在真正的 C 中你可以做

```
 char temp;
      for (i = 0; i < length; ++i)
          delta = encode? (temp = buffer[i], buffer[i] -= delta, temp) : (buffer[i] += delta); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T04:37:36.940

我同意所有说这样做不好的人的观点。它使您的程序效率降低，代码更笨拙（从而降低了可读性）。如果您在实施设计时遇到这样的障碍，您可能需要重新考虑您的设计以及*为什么*会存在这样的要求。

说了这么多，你可以做这样的事情：

```
typedef enum
{
    ENCODE,
    DECODE
} CONTEXT;

void
delta_operation (char *buffer, const unsigned int length, CONTEXT context)
{
    if(context == ENCODE)
    {
        char delta = 0;
        char original;
        unsigned int i;
        for (i = 0; i < length; ++i)
        {
            original = buffer[i];
            buffer[i] -= delta;
            delta = original;
        }
    }
    else if(context == DECODE)
    {
        char delta = 0;
        unsigned int i;
        for (i = 0; i < length; ++i)
        {
            buffer[i] += delta;
            delta = buffer[i];
        }
    }
} 
```

并称它为：

```
char buffer[] = "Whatever your buffer is supposed to be";
delta_operation (buffer, strlen(buffer), ENCODE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T04:44:18.540

我个人同意@paddy。您不应该仅仅为了减少代码行而使您的代码不可读。

一般来说，如果你想在 += 和 -= 之间切换，你可以使用 (+/-1) 乘数。对于 += 你应该使用 multiplier = 1 然后你会得到：

```
buffer[i] = buffer[i] + multiplier * delta ==> buffer[i] = buffer[i] + delta 
```

对于 -= 你可以使用 multiplier = -1 然后你会得到：

```
buffer[i] = buffer[i] + multiplier * delta ==> buffer[i] = buffer[i] - delta 
```

特别是对于您的代码，它可能看起来像这样（您可以使用 boolean 而不是 int 并在函数中分配值）：

```
void
delta_encode_decode (char *buffer, const unsigned int length, int shouldDecode)
{
 char delta = 0;
 char original;
 unsigned int i;
 for (i = 0; i < length; ++i)
 {
  original = buffer[i];
  buffer[i] = buffer[i] + shouldDecode * delta;

  if (shouldDecode == 1)
    delta = buffer[i];
  else
    delta = original;

 }
} 
```

或更“优雅”的解决方案（Anish Ram 的贡献）：

```
typedef enum
{
    ENCODE = -1,
    DECODE = 1
} eOperation; 
```

并使用 eOperation 而不是 -1/+1 的硬编码值和 int 参数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T05:44:43.107

这是其他人似乎还没有建议的东西。您可以制作一个内核函数来对单个字符进行操作并将其传入。

```
typedef void (*delta_op)( char *value, char *delta );

void encode( char *value, char *delta )
{
    char prev = *value;
    *value += *delta;
    *delta = prev;
}

void decode( char *value, char *delta )
{
    *value -= *delta;
    *delta = *value;
} 
```

然后你只需将你的内核函数传递给主要部分。

```
void encode_decode( char *buffer, unsigned int length, encode_op operation )
{
    char delta = 0;
    unsigned int i;
    for (i = 0; i < length; ++i)
    {
        operation( &buffer[i], &delta );
    }
} 
```

所以你这样打电话：

```
encode_decode( buffer, length, encode );
encode_decode( buffer, length, decode ); 
```

不过它会很笨重而且很慢......就像`qsort`. 因为所有的函数调用。*

# c++ - 采用指向集合的指针的函数的优势，以避免在返回时复制？

> ID：16007662
> 
> 赞同：0
> 
> 时间：2013-04-15T04:30:20.307
> 
> 标签：c++, pointers, reference

假设我有以下 C++ 函数：

```
// Returns a set containing {1!, 2!, ..., n!}.
set<int> GetFactorials(int n) {
  set<int> ret;
  int curr = 1;
  for (int i = 1; i < n; i++) {
    curr *= i;
    ret.insert(curr);
  }

  return ret;
}

set<int> fs = GetFactorials(5); 
```

（这只是一个虚拟示例。关键是该函数自己创建集合并返回它。）

我的一个朋友告诉我，不要像我那样编写函数，我应该编写它以便函数接收指向集合的指针，以避免在返回时复制集合。我猜他的意思是这样的：

```
void GetFactorials2(int n, set<int>* fs) {
  int curr = 1;
  for (int i = 1; i < n; i++) {
    curr *= i;
    fs->insert(curr);
  }
}

set<int> fs;
GetFactorials2(5, &fs); 
```

我的问题：第二种方式真的是一个很大的优势吗？这对我来说似乎很奇怪。我是 C++ 新手，对编译器了解不多，但我会假设通过一些编译器魔法，我的原始函数不会贵得多。（而且我会避免自己初始化集合。）我错了吗？关于指针和返回复制我应该知道些什么才能理解这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:39:59.050

不，这通常根本没有优势。如今，几乎所有合理的编译器都将利用命名返回值优化（参见[此处](http://en.wikipedia.org/wiki/Return_value_optimization)）。这有效地消除了前一个示例中的任何性能损失。

如果你真的想深入了解细节，请阅读Dave Abrahams 的[这篇文章](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)（boost 的主要贡献者之一）。然而，长话短说，只需返回值。它可能更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:36:54.060

是的，它可能很昂贵。尤其是当集合变大时。没有理由不在这里使用指针或引用。它将为您节省很多，并且您不会在可读性方面做出太多牺牲。

当您可以自己优化时，为什么还要依赖编译器优化。编译器知道你的代码，但并不总是理解你的算法。

我会这样做

```
void GetFactorials2(int n, set<int>& fs) {
//                                   ^^
  int curr = 1;
  for (int i = 1; i < n; i++) {
    curr *= i;
    fs->insert(curr);
  }
} 
```

通话将保持正常。

```
set<int> fs;
GetFactorials2(5, fs);
                  ^^ 
```

# ios - 从网络下载图像时如何找到“UIImagePickerControllerOriginalImage”和“UIImagePickerControllerReferenceURL”

> ID：16007666
> 
> 赞同：2
> 
> 时间：2013-04-15T04:30:37.603
> 
> 标签：ios, objective-c, ios5, ios6

我想得到`UIImagePickerControllerOriginalImage`，`UIImagePickerControllerReferenceURL`当我下载图像并将其保存到相册时..

谁能建议找到这两个参数的正确方法？

如果我使用方法“

```
[library writeImageToSavedPhotosAlbum:[viewImage CGImage] orientation:(ALAssetOrientation)[viewImage imageOrientation] completionBlock:^(NSURL *assetURL, NSError *error) 
```

我会得到“UIImagePickerControllerReferenceURL”，如果我使用

```
UIImageWriteToSavedPhotosAlbum([UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:self.imageURL]]], testOriginalImage, @selector(image:didFinishSavingWithError:contextInfo:), nil) 
```

我会得到“UIImagePickerControllerOriginalImage”

怎么做才能两者兼得？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:51:56.043

如果你打电话：

```
[library writeImageToSavedPhotosAlbum:[viewImage CGImage] orientation:(ALAssetOrientation)[viewImage imageOrientation] completionBlock:^(NSURL *assetURL, NSError *error) 
```

然后你得到/拥有两者。是`assetURL`和`UIImagePickerControllerReferenceURL`与`viewImage`相同`UIImagePickerControllerOriginalImage`。

# c++ - 正确使用智能指针和编程风格

> ID：16007670
> 
> 赞同：3
> 
> 时间：2013-04-15T04:30:54.767
> 
> 标签：c++, c++11

这是思考智能指针和使用原始指针进行非所有权的正确方法吗？

```
class DisplayObject {
    DisplayObject* Parent;
};

class DisplayObjectContainer: public DisplayObject {
    std::vector<DisplayObject*> Children;
};

class Stage {
    std::vector<std::unique_ptr<DisplayObject>> DisplayObjects;
}; 
```

使用
`make_unique<DisplayObject>`
或创建项目
`make_unique<DisplayObjectContainer>`

Stage 将拥有所有`DisplayObject`类，但 a`DisplayObjectContainer`将具有指向 Stage 拥有的对象的原始指针。

`DisplayObject`还将有一个 Parent （可以是`nullptr`）。

当我将项目添加到向量 ( `DisplayObjects.back().get()`) 并大量使用`std::move`

这是使用智能指针和所有权的正确方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T04:37:12.687

看你的代码，是的。这看起来是一种组织代码的完美方式：您有一个保持显式所有权的类，而使用原始指针的每个其他类都不拥有它所指向的内容。这将使您的代码保持干净、高效，并且每个使用它的人都会知道什么时候中断以及如何中断。

只要确保如果您确实开始共享此代码，您会预先告诉所有人原始指针意味着它不拥有资源，并且他们不会自己删除或新建资源。预先知道这一点将防止人们对人们使用/传递给您的方法的指针是否需要手动新建的混淆。

***边注：***

`DisplayObject`? `DisplayObjectContainer`? 听起来很像[AS3 的](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html)C++ 显示层次结构！听起来很有趣。祝你一切顺利。

# visual-c++ - 在 C++/CX 中，为什么未引用的 hat ^ 参数不生成警告？

> ID：16007671
> 
> 赞同：0
> 
> 时间：2013-04-15T04:30:56.033
> 
> 标签：visual-c++, compiler-warnings, c++-cx, visual-c++-2012

我正在开发一个 Windows 应用商店应用程序，并且刚刚将 Visual Studio 的警告级别提高到 4，因此我一直在修复未引用的参数警告。在此过程中，我注意到未引用的框架管理参数 (^) 不会像其他未引用的“正式”参数一样生成 C4100 警告。为了说明我的意思：

```
void Method(CNonFrameworkManaged* pObject)
{
    // Warning C4100: 'pObject' : unreferenced formal parameter
}

void Method(CFrameworkManaged^ spObject)
{
    // No warning
} 
```

为什么第二个不产生警告？有没有办法打开这样的警告？我希望我的代码看起来一致，但手动跟踪所有这些需要几天时间。

注意：我在没有 CLR 支持的情况下编译我的项目，但似乎这些仍然可以检测到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:56:06.060

hat 类型是智能指针的一种形式，因此每个 hat 类型都有一个析构函数，它释放指向对象的所有权。虽然`spObject`在源代码中没有按名称引用，但该对象*由*编译器生成的函数末尾的析构函数调用引用。

当编译器检查未引用的局部变量时，它会找到该引用并且不会发出警告。一个普通的（非参数）局部变量必须有一个名称，如果编译器对这些仅存在被销毁的局部变量（例如，RAII 类型，如`lock_guard`）发出“未引用的局部变量”警告，那将是有问题的。针对未引用的非参数局部变量发出警告 C4101 和 C4189。（编译器能否以不同的方式处理参数？可能。但事实并非如此。）

请注意，对于具有析构函数的类型的任何参数，都不会发出 C4100：

```
struct A { };
struct B { ~B() { } };

void f(A a) { } // C4100 is issued for 'a'
void f(B b) { } // C4100 is not issued for 'b' 
```

# mysql - 如何从两个表中获取未映射的行

> ID：16007674
> 
> 赞同：1
> 
> 时间：2013-04-15T04:31:31.067
> 
> 标签：mysql, sql, sql-server

我在 SQL Query 中遇到问题

我有两张桌子：

表一

```
ID Number
1  100
2  200
3  300
4  400
5  500
6  600
7  700
8  800
9  900 
```

表二

```
ID Someotherdata
1  100
2  200
3  300
4  400
5  500 
```

* * *

我尝试了一个查询

```
Select one.ID,one.Number
from table1 one
Left Outer Join
table2 two
on one.ID=two.id 
```

我要结果

```
6  600
7  700
8  800
9  900 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:52:58.043

使用`except`：

```
Select one.ID,one.Number
from table1 one
except
(Select one.ID,one.Number
from table1 one
inner join
table2 two
on one.ID=two.id) 
```

**[要测试的 SQL 文件](http://www.sqlfiddle.com/#!3/3fc9a/4)**

**编辑（根据 OP 请求）**

```
SELECT table1.id, table1.number FROM table1
LEFT JOIN table2 on table2.id = table1.id
WHERE table2.id  IS NULL 
```

**[这是用于测试的 SQL 文件](http://www.sqlfiddle.com/#!3/3fc9a/2)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:48:52.803

据我所知，您有两个具有相应 ID 的表。并非所有条目`table1`都在 中`table2`，但出现在`table2`中的条目与 中的条目具有相同的 ID `table1`。

这应该有效：

```
SELECT table1.id, table1.number FROM table1
LEFT JOIN table2 on table1.id = table2.id
WHERE table2.id IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:59:21.507

```
Select one.ID,one.Number
from table1 one
Where not in(Select two.ID From Table2 two) 
```

# vba - VBA：昏暗控制对象失败

> ID：16007684
> 
> 赞同：0
> 
> 时间：2013-04-15T04:32:35.563
> 
> 标签：vba

只是不知道为什么下面的代码一直抱怨“未定义用户定义的类型”：

```
Dim ownControl As Control 
```

我在网上看到所有其他资源都使用此代码没有任何问题。真的很困惑，希望有人能给我解释一下。

顺便说一句，我使用的是 MS Excel 2007。非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:59:56.760

您很可能需要首先将一个用户窗体添加到您的工作簿（假设您将使用一个），或者添加对“Microsoft Forms 2.0 对象库”的引用。

该`Control`类型在该库中定义。

# java - 简单的 Q 迭代器 of Abstract Class Hi guys can u tell until tomorrow ?? Well, I dont use java.util.iterator to create my iterator interface, just create my own so I have 2 Iterators: AccountIterator / FileIterator, 问问题 问问题 2013-04-15T04:32:55.307 481 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. javainterfacecastingiteratorabstract-class 4 2 回答 2 This answer is useful 1 你已经用 type 参数化了你的类E，但是你的 account 数组是 type Account。accounts[index]返回一个Account而不是E。 您可能打算实现一个Iterator<Account>. 将类签名更改为此... public class AccountIterator<E> implements Iterator<Account> 然后，Impl 将处理您的通用偏好，并且它会起作用。 class MyIter implements Iterator<String> { String [] arr = new String[10]; public void init() { } public boolean hasNext() { return false; } public String next() { return arr[1]; } } 于 2013-04-15T04:37:39.357 回答 This answer is useful 0 只需修改类头以指定对象类型。 利用 public class AccountIterator implements Iterator<Account> 而不是一般的 public class AccountIterator<E> implements Iterator<E> 您必须将 E 更改为 Account。 于 2013-04-15T04:38:29.517 回答 Related 1 ios - 用 UIView Block 动画做闪烁效果 4 github - GitHub for Windows 安装错误“应用程序无法启动” 1 label - 检票口继承和编辑基本页面的组件值。 3 php - Laravel ORM 友谊关系不重复 4 java - 线程需要连续检查是否存在 3 python - 如何创建此 PHP 脚本的 PYTHON 版本。（从 php://stdin 读取） 1 python - 在 Python 中使用正则表达式创建匹配 3 r - 如何使用变量的输出来调用R中的向量 1 clojure - 您可以从本地签出的源代码中加载 leiningen 库代码吗？ 2 javascript - AngularJS 通知视图模型的变化 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16007688
> 
> 赞同：1
> 
> 时间：
> 
> 标签：java, interface, casting, iterator, abstract-class

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:37:39.357

你已经用 type 参数化了你的类`E`，但是你的 account 数组是 type `Account`。`accounts[index]`返回一个`Account`而不是`E`。

您可能打算实现一个`Iterator<Account>`. 将类签名更改为此...

```
public class AccountIterator<E> implements Iterator<Account> 
```

然后，Impl 将处理您的通用偏好，并且它会起作用。

```
class MyIter implements Iterator<String>
{
    String [] arr = new String[10];

    public void init()
    {
    }

    public boolean hasNext()
    {
        return false;
    }

    public String next()
    {
        return arr[1];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:38:29.517

只需修改类头以指定对象类型。

利用

```
public class AccountIterator implements Iterator<Account> 
```

而不是一般的

```
public class AccountIterator<E> implements Iterator<E> 
```

您必须将 E 更改为 Account。

# string - 他们是用户输入单词并使该单词成为（变成）＃的一种方式吗？

> ID：16007689
> 
> 赞同：0
> 
> 时间：2013-04-15T04:32:57.523
> 
> 标签：string, while-loop, user-input, java.util.scanner

我正在尝试创建角色 2 骰子的程序。然后用户说“是”以再次角色骰子或说“否”以停止掷骰子。

```
import java.util.*;
    public class Dice
    {
        public static void main(String[] args)
        {

        Random dice1 = new Random();
        Scanner in = new Scanner(System.in);
        //varibles
        int die1;
        int die2;
        byte playagain=1;
        byte Yes = 1;
        byte No = 0;
        int total;
        int stop = 0;
        //Want find I way to change words into #s
        String start = Yes;
        while(stop<5 && start<Yes){
        stop+=1;
            die1=dice1.nextInt(6)+1;
            die2=dice1.nextInt(6)+1;
                total=die1 + die2;
                System. out. println("You rolled a "  + total+ ".");
        System. out. println("Do you want to play again?");
        System. out. println("Type Yes to keep playing you and No to stop.");
        /*I want people to be able to input Yes and that equal a # so I can use it in the While loop. Same with No.*/
        start=in.next();

        System. out. println("start is at " + start);

        }
        }
    } 
```

我浏览了整个互联网，找不到任何帮助，所以这就是我要问的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:36:23.793

如果您的意思是要从扫描仪中读取 int，请尝试使用`Scanner.nextInt` [http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#nextInt()](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#nextInt())

您可以使用`hasNextInt`来确定使用`nextInt`是否有效：[http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#hasNextInt()](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#hasNextInt())

如果您已经有了字符串并想将其转换为 int，请尝试`Integer.parseInt` [http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#parseInt(java.lang.String)](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#parseInt(java.lang.String))

一般来说，如果您想知道是否存在执行基本操作的函数，您应该检查 java.lang、java.util、java.io 等中的 API（取决于您认为它在哪里）

# c#-4.0 - 使用 c# 将 Outlook 约会与 windows 应用程序集成

> ID：16007690
> 
> 赞同：-1
> 
> 时间：2013-04-15T04:33:03.667
> 
> 标签：c#-4.0

嗨，我正在 c#.net 中开发一个 Windows 应用程序，我需要在其中显示在 Outlook 中创建的约会应该能够在我的 Windows 应用程序中可见。我什至不知道如何开始以及从哪里开始。请帮助我解决我面临的这个问题。请给我一些参考，其中使用 c#.net 将 Outlook 的约会集成到 Windows 应用程序中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:34:29.590

**在这里使用 C# 集成 Outlook**，您将有一些参考来寻找答案[http://www.c-sharpcorner.com/UploadFile/rambab/OutlookIntegration10282006032802AM/OutlookIntegration.aspx](http://www.c-sharpcorner.com/UploadFile/rambab/OutlookIntegration10282006032802AM/OutlookIntegration.aspx)

也是[这里的一个问题](https://stackoverflow.com/questions/1630409/integrating-pocket-outlook-and-c-sharp-application)

# jquery - 使用 jQuery 显示大写锁定

> ID：16007691
> 
> 赞同：0
> 
> 时间：2013-04-15T04:33:18.473
> 
> 标签：jquery

当我打开登录页面时，如果大写锁定已打开，我需要立即显示大写锁定已打开。我看到一些帖子，比如

[这](https://stackoverflow.com/questions/2308895/detect-caps-lock-on-off-using-jquery)在按键中显示。但我想在页面加载后立即显示。我如何使用 jQuery 来做到这一点。请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:56:33.293

有一个名为 capslockstate 的 jQuery 插件，它将监视整个页面上大写锁定键的状态，而不仅仅是在特定字段中。

您可以查询大写锁定键的状态或定义事件侦听器以响应状态更改。

与此处的其他建议相比，该插件在检测和状态管理方面做得更好，包括使用非英语键盘，监控 Caps Lock 键本身的使用，以及在输入非字母字符时不要忘记状态。

有两个演示，[一个显示基本事件绑定](http://jsfiddle.net/nosilleg/zVCU5/)，另一个[仅在密码字段具有焦点时显示警告](http://jsfiddle.net/nosilleg/tBB58/)。

例如

```
$(document).ready(function() {

/* 
* Bind to capslockstate events and update display based on state 
*/
$(window).bind("capsOn", function(event) {
    $("#statetext").html("on");
});
$(window).bind("capsOff", function(event) {
    $("#statetext").html("off");
});
$(window).bind("capsUnknown", function(event) {
    $("#statetext").html("unknown");
});

/*
* Additional event notifying there has been a change, but not the state
*/
$(window).bind("capsChanged", function(event) {
    $("#changetext").html("changed").show().fadeOut();
});

/* 
* Initialize the capslockstate plugin.
* Monitoring is happening at the window level.
*/
$(window).capslockstate();

// Call the "state" method to retreive the state at page load
var initialState = $(window).capslockstate("state");
$("#statetext").html(initialState);}); 
```

和

```
$(document).ready(function() {

/* 
* Bind to capslockstate events and update display based on state 
*/
$(window).bind("capsOn", function(event) {
    if ($("#Passwd:focus").length > 0) {
        $("#capsWarning").show();
    }
});
$(window).bind("capsOff capsUnknown", function(event) {
    $("#capsWarning").hide();
});
$("#Passwd").bind("focusout", function(event) {
    $("#capsWarning").hide();
});
$("#Passwd").bind("focusin", function(event) {
    if ($(window).capslockstate("state") === true) {
        $("#capsWarning").show();
    }
});

/* 
* Initialize the capslockstate plugin.
* Monitoring is happening at the window level.
*/
$(window).capslockstate();}); 
```

[该插件的代码](https://github.com/nosilleg/capslockstate-jquery-plugin/blob/master/src/jquery.capslockstate.js)可在 GitHub 上查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:40:21.637

抱歉，您无法在页面加载时获得键盘按钮的状态。您必须分析按键的 keyCode。这是唯一的方法。

检查这篇文章：[在页面加载（或类似）时检测大写锁定状态](https://stackoverflow.com/questions/5371732/detect-caps-lock-status-on-page-load-or-similar)

# objective-c - 将语音数据字段从 Excel 导入 Xcode

> ID：16007692
> 
> 赞同：0
> 
> 时间：2013-04-15T04:33:22.553
> 
> 标签：objective-c, excel, parsing

我有一个大型的日文单词 excel 电子表格，其发音如下面的示例截图所示 - 请查看 B 列。注音字符是汉字上方的小字符。

我熟悉在 Xcode 中解析 CSV 文件，但是当我将此电子表格保存为 CSV 时，我会丢失拼音字符。有谁知道我可以将 excel 文件转换为保留拼音字符并且我仍然可以在 Xcode 中解析的格式的方法？

![在此处输入图像描述](https://i.stack.imgur.com/KTZoY.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:24:04.020

Excel 不支持以纯文本格式导出注音假名/ruby/注音文本。

您要么必须 (1) 使用[`PHONETIC`](http://office.microsoft.com/en-nz/excel-help/phonetic-function-HA102752905.aspx)函数将文本提取到单独的列（您似乎已经拥有）并使用该列，或者 (2) 将文件导出为 HTML 并解析它（Excel 将标记带有`<ruby><rp><rt>`元素的文本）。

# go - 使用 go.crypto/openpgp 验证签名

> ID：16007695
> 
> 赞同：6
> 
> 时间：2013-04-15T04:33:41.387
> 
> 标签：go, openpgp

我有一个二进制文件：

```
foo.bin 
```

此文件已使用 gpg 密钥签名以创建：

```
foo.bin.sig 
```

我有一个包含用于签署二进制文件的公钥的文件。

我想做的是能够使用 Go 来验证这个签名。

我正在阅读 go.crypto/openpgp 文档，它们对这个用例并不是特别有用。

验证将在远程机器上完成。理想情况下，我想避免在运行此代码的机器上使用密钥环。公钥可以简单地存储在可执行文件本身中……如果我能弄清楚如何完成此验证。

我认为我需要做的步骤如下：

*   创建一个仅代表公钥的实体
*   打开二进制文件和签名并将其传递给某个验证函数

问题主要是：如何仅使用公钥编写此验证功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-30T13:10:20.223

openpgp API 不是最简单易用的，但我试了一下（双关语），这就是我想出的*：*

```
package main

import (
    "bytes"
    "code.google.com/p/go.crypto/openpgp/packet"
    "encoding/hex"
    "errors"
    "fmt"
    "io/ioutil"
    "os"
)

// gpg --export YOURKEYID --export-options export-minimal,no-export-attributes | hexdump /dev/stdin -v -e '/1 "%02X"'
var publicKeyHex string = "99[VERY LONG HEX STRING]B6"

func main() {
    if len(os.Args) != 3 {
        fmt.Println("Usage: " + os.Args[0] + " <file> <signature file>")
        return
    }

    err := checkSig(os.Args[1], os.Args[2])

    if err != nil {
        fmt.Println("Invalid signature : ")
        fmt.Println(err)
    } else {
        fmt.Println("Valid signature")
    }
}

func checkSig(fileName string, sigFileName string) error {
    // First, get the content of the file we have signed
    fileContent, err := ioutil.ReadFile(fileName)
    if err != nil {
        return err
    }

    // Get a Reader for the signature file
    sigFile, err := os.Open(sigFileName)
    if err != nil {
        return err
    }

    defer func() {
        if err := sigFile.Close(); err != nil {
            panic(err)
        }
    }()

    // Read the signature file
    pack, err := packet.Read(sigFile)
    if err != nil {
        return err
    }

    // Was it really a signature file ? If yes, get the Signature
    signature, ok := pack.(*packet.Signature)
    if !ok {
        return errors.New(os.Args[2] + " is not a valid signature file.")
    }

    // For convenience, we have the key in hexadecimal, convert it to binary
    publicKeyBin, err := hex.DecodeString(publicKeyHex)
    if err != nil {
        return err
    }

    // Read the key
    pack, err = packet.Read(bytes.NewReader(publicKeyBin))
    if err != nil {
        return err
    }

    // Was it really a public key file ? If yes, get the PublicKey
    publicKey, ok := pack.(*packet.PublicKey)
    if !ok {
        return errors.New("Invalid public key.")
    }

    // Get the hash method used for the signature
    hash := signature.Hash.New()

    // Hash the content of the file (if the file is big, that's where you have to change the code to avoid getting the whole file in memory, by reading and writting in small chunks)
    _, err = hash.Write(fileContent)
    if err != nil {
        return err
    }

    // Check the signature
    err = publicKey.VerifySignature(hash, signature)
    if err != nil {
        return err
    }

    return nil
} 
```

根据要求，我将公钥放入代码中。你可以这样测试它：

```
$ go run testpgp.go foo.bin foo.bin.sig 
```

如果您签署的文件非常大，您可能需要稍微更改代码以避免将其加载到内存中。

# artoolkit - ARToolkit DSVLD.dll 错误

> ID：16007700
> 
> 赞同：0
> 
> 时间：2013-04-15T04:34:12.593
> 
> 标签：artoolkit

我已经按照这里的教程：[http ://www.hitl.washington.edu/artoolkit/documentation/devstartup.htm](http://www.hitl.washington.edu/artoolkit/documentation/devstartup.htm)

当我尝试编译程序时，它会编译但输出窗口会告诉我：

DSVLd.dll（tid 774c）42818982：无法访问模块密钥 DSVLd.dll（tid 774c）42818982：无法访问 GLOBAL 模块密钥

然后程序将退出。

我已经能够根据说明设置工具包，并且能够很好地运行示例程序。如果我从头开始创建这个项目，我不确定是否有一些我错过或需要配置的设置步骤。

我目前正在运行 64 位 Windows 7。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T13:15:56.970

当我的程序使用 MS directshow（调试版本）运行链接库时，我有类似的调试输出。调试系统似乎正在寻找 Windows 注册表项。但这不应该是程序退出的原因，至少我的工作不受影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-18T05:52:24.923

我刚刚解决了。只需将两个文件 (`data`和`Wrl`) 从您自己的项目文件夹`ARToolKit\bin\data`下`ARToolKit\bin\Wrl`的目录`debug`复制到您自己的项目文件夹下的目录，而不仅仅是复制到您的项目文件夹。

# regex - 解析网页，使用re，如何确定找到的字符串的行？

> ID：16007702
> 
> 赞同：0
> 
> 时间：2013-04-15T04:34:22.300
> 
> 标签：regex, python-2.7, web

我正在使用如下代码查看 python 中的网站：

```
import urllib
import urllib2
import re

aResp = aResp = urllib2.urlopen("http://stackoverflow.com/");

web_pg = aResp.read();

pattern = "<title>Stack Overflow</title>"

m = re.search(pattern, web_pg)

if m:
   print "found"

else:
   print "Nothing found" 
```

我试图在这之后查看标签并在其中进行测试。有没有什么简单的方法可以查到这些信息？？？？如果它更简单，我可以使用只给出 m 的行号和获取该行的 HTML 代码的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:47:01.733

要捕获文本，请使用 () 大括号，如下所示：

```
import urllib
import urllib2
import re

aResp = aResp = urllib2.urlopen("http://stackoverflow.com/");

web_pg = aResp.read();

pattern = "<title>(.*?)</title>"

m = re.search(pattern, web_pg)

if m:
   print m.group(1)

else:
   print "Nothing found" 
```

.group() 函数返回匹配项的第一次出现。

# objective-c - Objective C - 以随机顺序调用数组对象

> ID：16007711
> 
> 赞同：0
> 
> 时间：2013-04-15T04:35:11.210
> 
> 标签：objective-c, nsarray

我有一个填充的 NSArray。我希望能够以随机顺序打印出数组的内容，以便每个对象只打印一次。下次我打印出来时，我希望它们的顺序与以前打印出来的顺序完全不同。如果有人可以帮助我，将不胜感激。
谢谢
棒棒糖

# c++ - 用大写和小写字母C++初始化一个数组

> ID：16007712
> 
> 赞同：0
> 
> 时间：2013-04-15T04:35:37.693
> 
> 标签：c++

```
//Loop to initialize the array of structs; set count to zero

for(int i = 0; i < 26; i++)
{
    //This segment sets the uppercase letters
    letterList[i].letter = static_cast<char>(65 + i);
    letterList[i].count = 0;

    //This segment sets the lowercase letters
    letterList[i + 26].letter = static_cast<char>(97 + i);
    letterList[i + 26].count = 0;
} 
```

//这似乎不起作用！

整个程序，获取一个文本文件，读取它，然后打印出每个使用的字母，使用的次数和出现的百分比......但是，我的输出不断出现：

出现的字母计数百分比

¿ 0 0.00%

52次……

我搜遍了，似乎无法得到这个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:55:03.473

我没有看到此代码输出有任何问题

```
 letterType letterList[52];
    for(int i = 0; i < 26; i++)
    {
        //This segment sets the uppercase letters
        letterList[i].letter = static_cast<char>('A' + i);
        letterList[i].count = 0;

        //This segment sets the lowercase letters
        letterList[i + 26].letter = static_cast<char>('a' + i);
        letterList[i + 26].count = 0;
    }
    for (int i = 0; i < 26 * 2; i++)
        cout<<letterList[i].letter<<" "<<letterList[i].count<<endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:51:01.747

```
for(int i=0, c='a'; i<26; i++)
{
        letterList[i] = c++;
}
for(int i=26,c='a'; i<52; i++)
{
        letterList[i] = toupper(c++);
} 
```

或者，您可以将第二个 for 循环替换为：

```
for(int i=26,c='A'; i<52; i++)
{
        letterList[i] = c++;
} 
```

**编辑**

根据您的要求`struct`
假设您`struct`有一个`char`成员并且每个`struct`实例都带有每个字母，这是代码：

```
struct letterType
{
    char letter;
};

int main()
{
    struct letterType letterList[52];
    char c;
    for(int i=0, c='a'; i<26; i++)
    {
            letterList[i].letter = c++;
    }
    for(int i=26,c='a'; i<52; i++)
    {
            letterList[i].letter = toupper(c++);
    }
    for(int i=0; i<52; i++)
    {
            cout<< letterList[i].letter << endl;
    }
} 
```

# windows-8 - gnuwin32 libxml2 安装：设置几个 lib 和包含目录

> ID：16007716
> 
> 赞同：0
> 
> 时间：2013-04-15T04:35:46.950
> 
> 标签：windows-8, include, libxml2, mingw32, linkage

我现在正在使用 mingw32 在 Windows 8 上编译 libxml2。

我已从此处下载[ftp://xmlsoft.org/libxml2/](ftp://xmlsoft.org/libxml2/)并按照自述文件中的说明进行操作。他们指示使用名为 configure.js 的 javascript 配置 make。我们可以像这样运行脚本：

```
cscript configure.js compiler=msvc prefix=c:\opt include=c:\opt\include lib=c:\opt\lib debug=yes 
```

我想这个问题有一个超级简单而且可能很明显的问题，但是如何设置几个 lib 和 include 文件夹？我尝试用“;”分隔 ：

```
cscript configure.js compiler=mingw zlib=yes prefix=C:\cpp\libraries\libxml2 include=C:\cpp\libraries\iconv-1.9.2.win32\include;C:\cpp\libraries\zlib1.2.3\GnuWin32\include lib=C:\cpp\libraries\iconv-1.9.2.win32\lib;C:\cpp\libraries\zlib1.2.3\GnuWin32\lib 
```

但这没有成功。在自述文件中没有找到任何相关内容...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:18:44.127

终于事情没那么难了。javascript脚本创建一个易于编辑的文件config.mingw，在这种情况下，使用-I手动添加路径，在我的情况下：

```
INCLUDE+= -IC:\cpp\libraries\iconv\GnuWin32\include -IC:\cpp\libraries\zlib1.2.3\GnuWin32\include
LIB+= -LC:\cpp\libraries\iconv\GnuWin32\lib -LC:\cpp\libraries\zlib1.2.3\GnuWin32\lib 
```

# ruby-on-rails - heroku heroku labs:enable user-env-compile

> ID：16007718
> 
> 赞同：1
> 
> 时间：2013-04-15T04:35:54.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, cdn, precompile

我正在尝试预编译并将我的文件推送到 CDN ......每个[https://devcenter.heroku.com/articles/cdn-asset-host-rails31](https://devcenter.heroku.com/articles/cdn-asset-host-rails31)

但是，当我运行这个

```
heroku labs:enable user-env-compile -a <<my app>> 
```

我收到以下错误

```
-----> Enabling user-env-compile for sleepy-castle-9766... failed
 !    Application error 
```

日志：

```
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (38.3ms)
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (9.2ms)
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (67.5ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (9.5ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (38.9ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (10.8ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (94.8ms)
2013-04-15T04:41:48.299446+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.7ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.9ms)
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (15.9ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (9.0ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (11.2ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (28.0ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (13.7ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.8ms)
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.9ms)
2013-04-15T04:41:48.300161+00:00 app[web.1]:   Rendered posts/_vote.html.erb (16.6ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.7ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.6ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.7ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered layouts/_footer.html.erb (0.0ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.4ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.8ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.4ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered static_pages/_login.html.erb (0.0ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (12.3ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered static_pages/home.html.erb within layouts/application (1607.6ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]: Completed 200 OK in 1613ms (Views: 769.4ms | ActiveRecord: 843.0ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (10.1ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered posts/_vote.html.erb (43.6ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_post.html.erb (477.6ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered posts/_post.html.erb (233.7ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.9ms)
2013-04-15T04:41:48.300890+00:00 app[web.1]:   Rendered layouts/_header.html.erb (1.8ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (45.0ms)
2013-04-15T04:41:48.300405+00:00 app[web.1]:   Rendered posts/_vote.html.erb (41.7ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.2ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (38.9ms)
2013-04-15T04:41:48.299894+00:00 app[web.1]:   Rendered posts/_vote.html.erb (40.2ms)
2013-04-15T04:41:48.300656+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.8ms)
2013-04-15T04:41:49.264569+00:00 heroku[router]: at=info method=GET path=/img/greenlogo.png host=www.imissyou.com fwd="76.98.253.94" dyno=web.1 connect=1ms service=6ms status=304 bytes=0
2013-04-15T04:41:49.289944+00:00 heroku[router]: at=info method=GET path=/img/homepagetopheader.png host=www.imissyou.com fwd="76.98.253.94" dyno=web.1 connect=1ms service=4ms status=304 bytes=0
2013-04-15T04:42:42.366874+00:00 app[web.1]: Started GET "/" for 95.211.87.85 at 2013-04-15 04:42:42 +0000
2013-04-15T04:42:43.722607+00:00 heroku[router]: at=info method=GET path=/ host=www.imissyou.com fwd="95.211.87.85" dyno=web.1 connect=1ms service=1355ms status=200 bytes=80024
2013-04-15T04:42:44.743673+00:00 app[web.1]:   Rendered posts/_vote.html.erb (8.4ms)
2013-04-15T04:42:44.743673+00:00 app[web.1]:   Rendered posts/_vote.html.erb (40.0ms)
2013-04-15T04:42:44.743673+00:00 app[web.1]: Processing by StaticPagesController#home as HTML
2013-04-15T04:42:44.743673+00:00 app[web.1]:   Rendered posts/_vote.html.erb (48.6ms)
2013-04-15T04:42:44.743673+00:00 app[web.1]:   Rendered posts/_vote.html.erb (55.0ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.9ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.6ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (39.2ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (8.5ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (24.3ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.4ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.1ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.4ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.1ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.6ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.8ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.4ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.2ms)
2013-04-15T04:42:44.744198+00:00 app[web.1]:   Rendered posts/_vote.html.erb (8.1ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.6ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.4ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.1ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.3ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.0ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (39.6ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (13.6ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (29.2ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (11.5ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.9ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (9.1ms)
2013-04-15T04:42:44.744453+00:00 app[web.1]:   Rendered posts/_post.html.erb (382.1ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (44.8ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_post.html.erb (268.4ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (5.7ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (8.8ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (63.7ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (38.4ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.0ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (16.8ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (9.0ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.3ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.2ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.1ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.8ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (8.1ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_post.html.erb (273.0ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.9ms)
2013-04-15T04:42:44.744698+00:00 app[web.1]:   Rendered posts/_vote.html.erb (42.9ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered static_pages/home.html.erb within layouts/application (1333.4ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered static_pages/_login.html.erb (0.0ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered layouts/_header.html.erb (2.2ms)
2013-04-15T04:42:44.745438+00:00 app[web.1]:   Rendered layouts/_footer.html.erb (0.0ms)
2013-04-15T04:42:44.745438+00:00 app[web.1]: Completed 200 OK in 1339ms (Views: 750.7ms | ActiveRecord: 587.7ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (6.4ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (11.0ms)
2013-04-15T04:42:44.744943+00:00 app[web.1]:   Rendered posts/_vote.html.erb (7.2ms)
2013-04-15T04:42:44.745185+00:00 app[web.1]:   Rendered posts/_vote.html.erb (37.0ms) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:23:07.563

我在asset_sync github页面上找到了运行命令时的文档：

```
heroku labs:enable user-env-compile --app <appname> 
```

为了让它工作。

Heroku 也有 AssetSync [https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration](https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration)文档

现在只编译一次资产真是太好了

当我想直接部署到 Heroku 时，这也适用于我。我使用需要的i18n **-js** [https://github.com/fnando/i18n-js](https://github.com/fnando/i18n-js) gem`config.assets.initialize_on_precompile = true``application.rb.`

所以，这个命令让我不必在部署之前预编译资产。我真的帮助 Heroku 保持这一点。

我们也叫 heroku `labs:enable user-env-compile -a <appname>`，而不是 user_env_compile。

**编辑：** 为了解决这个问题，只需更新你的`heroku toolbelt`，请参考下面提到的链接 [https://blog.heroku.com/archives/2012/10/15/upgrading-to-the-heroku-toolbelt](https://blog.heroku.com/archives/2012/10/15/upgrading-to-the-heroku-toolbelt)

# java - Jlist 上的滚动条

> ID：16007720
> 
> 赞同：-1
> 
> 时间：2013-04-15T04:36:17.043
> 
> 标签：java, swing, jlist

这是我创建 Jlist 并使用动作侦听器填充它的代码

首先，我使用了一个字符串数组来填充 Jlist，并且我有滚动条。然后，为了更新 Jlist，我需要将 Jlist 的模式更改为 DefaultListModel，一旦我进行了更改，我就丢失了滚动条。

我不知道出了什么问题

任何人都可以帮助我吗

```
private Component makeListView() {  
        final DefaultListModel<String> listModel = new DefaultListModel<String>();
        final JList<String> list = new JList<String>(listModel);
        list.setModel(listModel);
        updateCourseListPanel(listModel);
        notifyObserverInModelForClickingOnListItem(list);       
        list.setPreferredSize(getSize());
        list.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        list.setLayoutOrientation(JList.HORIZONTAL_WRAP);
        list.setVisibleRowCount(-1);        
        list.setFixedCellWidth(80);
        JScrollPane listScroller = new JScrollPane(list);
        listScroller.setPreferredSize(getMaximumSize());
        setVisible(true);       
        return list;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T15:39:42.320

很难从您的代码段中分辨出来（因为您没有显示调用它的代码）：从表面上看，问题是您返回列表而不是它添加到的 scrollPane。

更深层次的问题是，您似乎（只是猜测，因为缺乏细节:-) 每当需要更新数据时重新创建列表。更好的方法是将列表及其模型的创建与其更新分开，并仅根据需要更新模型：

```
private Component makeListView() {  
    final DefaultListModel<String> listModel = new DefaultListModel<String>();
    final JList<String> list = new JList<String>(listModel);
    list.setModel(listModel);
    list.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
    list.setLayoutOrientation(JList.HORIZONTAL_WRAP);
    list.setFixedCellWidth(80);
    JScrollPane listScroller = new JScrollPane(list);
    return listScroller;
 }

 private void update(Jlist list) {  
    updateCourseListPanel(list.getModel());
    notifyObserverInModelForClickingOnListItem(list);       
 } 
```

顺便说一句，从不调用任何 setXXSize 方法，[某些原因](https://stackoverflow.com/a/7229519/203657)

# drag-and-drop - JavaFX Dragboard setContent 干扰 setOnMouseDragged？

> ID：16007724
> 
> 赞同：4
> 
> 时间：2013-04-15T04:36:41.617
> 
> 标签：drag-and-drop, javafx, clipboard

我想在 JavaFX 中使用拖放功能，并有一个功能可以让您直观地看到被拖动的项目。我已经实现了我认为可行的解决方案，但 API 似乎存在问题。

根据 API startDragAndDrop(TransferMode...) 必须在 setOnDragDetected 内初始化。这是我使用 Dragboard 来存储我想转移到另一个节点的内容的地方。

**编辑：**这似乎与 TrasferMode 有关。如果我使用 TransferMode.NONE 没有问题，但使用 COPY、ANY、LINK 总是会导致这个问题。

但是调用 dragBoard.setContent(some clipboard content) 只允许鼠标移动非常小的增量（在任何方向上最多 4 个像素！）。删除这行代码，然后我可以拖动项目并看到它被拖动到任何地方，但是当然，我不能存储剪贴板内容。

我看到的问题是 setOnMouseDragged(..) 在 setOnDragDetected 之前被调用！为什么 setOnMouseDragged 在 setOnDragDetected 之前运行没有多大意义......

我的代码中是否有明显的东西可能会导致问题？我只是希望能够在拖动时看到 imgView 移动，并能够像往常一样将其拖放到目标上，并带有剪贴板内容。

**编辑 2：**更新了下面的代码以反映仅使用 Drag 事件，而不是 Drag 和 Mouse 事件。使用两者都会导致问题。仍然存在的问题是我无法放在目标上，因为使用 setOnDragOver 会使拖动的节点始终位于光标的正下方。

```
protected ImageView initImageView(Image img){

    final Pane ldzPane = GameBoard.getInstance().getLDZpane();

    final ObjectProperty<Point2D> dragAnchor = new SimpleObjectProperty<>();

    final ImageView imgView = new ImageView(img);

    final DoubleProperty initX = new SimpleDoubleProperty();
    final DoubleProperty initY = new SimpleDoubleProperty();

    final DoubleProperty dragX = new SimpleDoubleProperty();
    final DoubleProperty dragY = new SimpleDoubleProperty();

    final DoubleProperty newXPosition = new SimpleDoubleProperty();
    final DoubleProperty newYPosition = new SimpleDoubleProperty();

    final int buffer = 3;

    imgView.setOnDragDetected(new EventHandler<MouseEvent>() {
        public void handle(MouseEvent event) {
            initX.set(imgView.getTranslateX());
            initY.set(imgView.getTranslateY());
            dragAnchor.set(new Point2D(event.getSceneX(), event.getSceneY()));
            ClipboardContent content = new ClipboardContent();
            content.putString(RHSIconizedToken.this.tokenLookupInfo());
            Dragboard db = imgView.startDragAndDrop(TransferMode.ANY); 
            db.setContent(content); 
            event.consume();
        }
    });

    imgView.setOnDragOver(new EventHandler<DragEvent>(){

        @Override
        public void handle(DragEvent event) {
            imgView.toFront();

            dragX.set(event.getSceneX() - dragAnchor.get().getX());
            dragY.set(event.getSceneY() - dragAnchor.get().getY());
            imgView.setOpacity(0.5);

            newXPosition.set(initX.get() + dragX.get());
            newYPosition.set(initY.get() + dragY.get());

            //if(       (Math.abs((newXPosition.get() - ldzPane.getWidth())) <=  ldzPane.getWidth() + startX + buffer) &&
            //      ((newXPosition.get() + startX + imgView.getImage().getWidth()+ buffer)<=  ldzPane.getWidth()))
                imgView.setTranslateX(newXPosition.get());

            //if(       (Math.abs((newYPosition.get() - ldzPane.getHeight())) <=  ldzPane.getHeight() + startY + buffer) &&
            //      ((newYPosition.get() + startY + imgView.getImage().getHeight()+ buffer)<=  ldzPane.getHeight()))
                imgView.setTranslateY(newYPosition.get());

            event.consume();
        }

    });

    imgView.setOnDragDone(new EventHandler<DragEvent>() {
        public void handle(DragEvent event) {

            LinkedList<RHSIconizedToken> iTokens = GameBoard.getInstance().getTokenBayItokens();
            if (event.getTransferMode() == TransferMode.MOVE) {
                RHSIconizedToken element = iTokens.remove(index);
                iTokens.add(index, new RHSIconizedToken(element.getImage(), new SourceToken("removed", "removed"), index));
                imgView.setVisible(false); 

                GameBoard theGameBoard = GameBoard.getInstance();
                GUI theGUI = GUI.getInstance();
                //was this the last one removed from the rhs?
                //if so we need to signal the CompileButton to be turned on!
                if(theGameBoard.isRHSempty())
                    theGUI.enableCompileButton();
                else
                    theGUI.disableCompileButton();
            }
            event.consume();
        }
    });

    imgView.setOnMouseEntered(new EventHandler <MouseEvent>() {
        public void handle(MouseEvent event) {
            imgView.setEffect(new Glow(0.5));
            event.consume();
        }
    });

    imgView.setOnMouseExited(new EventHandler <MouseEvent>() {
        public void handle(MouseEvent event) {
            imgView.setEffect(new Glow(0.0));
            imgView.setOpacity(1);
            event.consume();
        }
    });

    return imgView;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-04T18:34:26.357

Java 8 计划提供对可视拖放的更多支持。DragBoard 的 setDragView (Image, XOffset, YOffset) 方法效果很好，并且在 Java 8 beta 中可用。

```
 imgView.setOnDragDetected(new EventHandler<MouseEvent>() {
        public void handle(MouseEvent event) {
            ClipboardContent content = new ClipboardContent();
            content.putString(RHSIconizedToken.this.tokenLookupInfo());
            Dragboard db = imgView.startDragAndDrop(TransferMode.ANY);
            db.setDragView(image, 7, 7); 
            db.setContent(content); 
            event.consume();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T06:35:15.403

我认为这会对您有所帮助：

[DraggablePanelsExample.java](http://docs.oracle.com/javafx/2/events/DraggablePanelsExample.java.htm)

我也将它用于我的面板，它适用于 ImageView 就像一个魅力。

**编辑：**
你正在结合这个错误！您不能将 DragDetected 与 MouseDragged 结合使用。如果您开始在 JavaFX 中拖动，mouseevents 将不再被触发。
如果您想要一个 Drag-Board-String，那么只需将您的 String 保存在您的班级中。

ps：将 DragDone 替换为 MouseReleased

# mysql - 在php中执行mysql查询时出错

> ID：16007725
> 
> 赞同：0
> 
> 时间：2013-04-15T04:36:41.880
> 
> 标签：mysql, php

我在php中的sql查询如下：

```
mysql_query("insert into tbl_features (img_id,features_1,features_2,features_3,features_4,features_5,features_6,features_7,features_8,features_9,features_10,features_11,features_12,features_13,features_14,features_15,features_16,features_17) VALUES ($datas[$k],$contentsarray[19],$contentsarray[20],$contentsarray[21],$contentsarray[22],$contentsarray[23],$contentsarray[24],$contentsarray[25],$contentsarray[26],$contentsarray[27],$contentsarray[28],$contentsarray[29],$contentsarray[30],$contentsarray[32],$contentsarray[33],$contentsarray[34],$contentsarray[35],$contentsarray[36] )") or die (mysql_error()); 
```

在执行它时，我收到错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '1.0E-6 )' 附近使用正确的语法

当它应该插入 30,000 条数据时，它只插入 13 条数据。我无法弄清楚这里的问题。1.0E-6 是第 14 列的最后一个数据。那么支架有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:38:40.347

您必须放置`'`varchar 数据

```
mysql_query("insert into tbl_features (img_id,features_1,features_2,features_3,features_4,features_5,features_6,features_7,features_8,features_9,features_10,features_11,features_12,features_13,features_14,features_15,features_16,features_17) 
VALUES ('$datas[$k]','$contentsarray[19]','$contentsarray[20]','$contentsarray[21]','$contentsarray[22]'
,'$contentsarray[23]','$contentsarray[24]','$contentsarray[25]','$contentsarray[26]'
,'$contentsarray[27]','$contentsarray[28]','$contentsarray[29]','$contentsarray[30]',
'$contentsarray[32]','$contentsarray[33]','$contentsarray[34]','$contentsarray[35]'
,'$contentsarray[36]' )") or die (mysql_error()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:39:25.140

你需要放置`'`varchar` 数据

每当您插入 varchar 数据时，请将这些数据放在单引号中。

喜欢 `('$datas[$k]','$contentsarray[19]','$contentsarray[20]'...................`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:58:36.600

当你使用`array`时，`double quotes`你应该用`braces{}` 试试这个

```
mysql_query("insert into tbl_features (img_id,features_1,features_2,features_3,features_4,features_5,features_6,features_7,features      8,features_9,features_10,features_11,features_12,features_13,features_14,features_15,features_16,features_17) 
VALUES ('{$datas[$k]}','{$contentsarray[19]}','{$contentsarray[20]}',-----") or die (mysql_error()); 
```

# php - 检测 URL apache 中的单斜杠

> ID：16007733
> 
> 赞同：0
> 
> 时间：2013-04-15T04:37:33.620
> 
> 标签：php, apache, url-rewriting

我在检测 URL 中的单斜杠时遇到问题，我想要的 URL 是

[http://sitename.com/username](http://sitename.com/username)

通过这个重写规则，我可以捕获用户名，但它也适用于前导斜杠，这是不需要的。

```
RewriteRule ([A-Za-z0-9]+){0,1}$ index.php?c=profile&val=$1 [NC,L] 
```

`^`起始符号没有返回任何内容，因此我已将其删除，现在我正在通过本地主机对其进行测试，因此我的测试网址是

```
http://localhost/projectname/username 
```

在服务器上

```
http://sitename.com/username 
```

这是我完整的 .htaccess

```
RewriteEngine On
RewriteBase /projectname/

RewriteCond $1 !^(maintainance\.php|index\.php|files|images|robots\.txt|css|js)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [PT,L]

RewriteRule ^([A-Za-z0-9]+){0,1}$ index.php?c=profile&val=$1 [NC,L] 
```

谁能告诉我如何通过 rewriteRule 捕获单斜杠用户名

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:51:29.323

请尝试使用以下 htaccess 脚本。在`val`您可以获取 url values.exploding 通过`/`您可以获取用户名。

```
RewriteEngine On
RewriteBase /projectname/
RewriteRule ^([A-Za-z0-9]+){0,1}$ index.php?c=profile&val=%{REQUEST_URI} [L,NC,QSA] 
```

# ios - iOS - 更改屏幕色温

> ID：16007739
> 
> 赞同：6
> 
> 时间：2013-04-15T04:38:17.667
> 
> 标签：ios

我想构建一个像 f.lux 这样的 iOs 应用程序。它根据白天改变设备的屏幕亮度。我知道我必须越狱我的设备。但我不知道如何实现这个应用程序。

请建议我任何有用的 API 来做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:41:11.323

iOS 已经内置了该系统范围的功能：请参阅**Settings > Brightness & Wallpaper**，在**Auto-Brightness**下：

![自动亮度](https://i.imgur.com/RRfJ5x4.jpg)

尽管可以以编程方式控制设备的亮度，但没有用于确定外部光线的公共 API，因此这是操作系统处理的功能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T04:41:00.233

试试这个（仅限 iOS5 及更高版本）：

```
[[UIScreen mainScreen] setBrightness:1.0]; 
```

来自相关问题：[通过代码调整屏幕亮度](https://stackoverflow.com/questions/7894232/adjust-the-brightness-of-the-screen-through-code)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-15T05:31:04.677

**浏览UIScreen**的**亮度**属性，这是 IOS5 之后提供的新 API。

# database - 使用本地数据库的数据仓库 - 初学者

> ID：16007742
> 
> 赞同：0
> 
> 时间：2013-04-15T04:38:38.683
> 
> 标签：database, data-warehouse

我想了解如何实现这一目标；

我有一个在 5 个不同地理位置运行的应用程序。例如：德克萨斯、纽约、加利福尼亚、波士顿、华盛顿

此应用程序将数据保存到位于该位置的本地数据库。

我想做数据仓库，所以只有一个数据库是必须的吗（现在所有 5 个应用程序都将其数据保存在一个数据库中 - 没有本地数据库）

或者是否可以有5个本地数据库，并通过将数据从这些本地数据库检索到中央数据库然后执行数据仓库来进行数据仓库。

请给我你的想法和参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:48:18.430

为此，您有三个选择：

1.  您使用单个集中托管的数据库服务器。如今，可以通过网络直接访问典型的关系数据库服务器：mySQL、Postgresql、Oracle ......必需的。可以同时进行多个连接。

2.  您使用单个中央数据库服务器，但在其周围放置一个包装器。所以一些小的网络层应用层充当代理。通过这种方式，您可以通过网络处理该中央实例，但通过标准协议（例如 http）。

3.  您使用分散的方法并在每个位置安装一个数据库实例。然后你需要一些额外的工具来执行同步。对于大多数现代数据库服务器（见上文）而言，存在此类工具，但设置并非易事。

如果有疑问并且负载不是那么高，请使用第一个替代方案。

# python - 大致近似于 Python 中一串文本的宽度？

> ID：16007743
> 
> 赞同：6
> 
> 时间：2013-04-15T04:38:39.787
> 
> 标签：python, fonts

如何使用 Python 来近似给定文本字符串的字体宽度？

我正在寻找一个原型的函数，类似于：

```
def getApproximateFontWidth(the_string, font_name="Arial", font_size=12):
   return ... picas or pixels or something similar ... 
```

我不是在寻找任何非常严格的东西，一个近似值就可以了。

这样做的动机是我在我的 web 应用程序的后端生成一个截断的字符串并将其发送到前端进行显示。大多数时候字符串都是小写的，但有时字符串都是大写的，这使得它们非常宽。如果字符串没有正确截断，它看起来很难看。我想知道根据字符串的近似宽度截断多少字符串。如果它减少 10%，这没什么大不了的，这是一个装饰功能。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-15T05:07:48.577

下面是我的简单解决方案，它可以让你达到 80% 的准确率，非常适合我的目的。它仅适用于 Arial 并且假定为 12 pt 字体，但它也可能与其他字体成比例。

```
def getApproximateArialStringWidth(st):
    size = 0 # in milinches
    for s in st:
        if s in 'lij|\' ': size += 37
        elif s in '![]fI.,:;/\\t': size += 50
        elif s in '`-(){}r"': size += 60
        elif s in '*^zcsJkvxy': size += 85
        elif s in 'aebdhnopqug#$L+<>=?_~FZT' + string.digits: size += 95
        elif s in 'BSPEAKVXY&UwNRCHD': size += 112
        elif s in 'QGOMm%W@': size += 135
        else: size += 50
    return size * 6 / 1000.0 # Convert to picas 
```

如果你想截断一个字符串，这里是：

```
def truncateToApproximateArialWidth(st, width):
    size = 0 # 1000 = 1 inch
    width = width * 1000 / 6 # Convert from picas to miliinches
    for i, s in enumerate(st):
        if s in 'lij|\' ': size += 37
        elif s in '![]fI.,:;/\\t': size += 50
        elif s in '`-(){}r"': size += 60
        elif s in '*^zcsJkvxy': size += 85
        elif s in 'aebdhnopqug#$L+<>=?_~FZT' + string.digits: size += 95
        elif s in 'BSPEAKVXY&UwNRCHD': size += 112
        elif s in 'QGOMm%W@': size += 135
        else: size += 50
        if size >= width:
            return st[:i+1]
    return st 
```

然后是以下内容：

```
>> width = 15
>> print truncateToApproxArialWidth("the quick brown fox jumps over the lazy dog", width) 
the quick brown fox jumps over the
>> print truncateToApproxArialWidth("THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG", width) 
THE QUICK BROWN FOX JUMPS 
```

渲染时，这些字符串的宽度大致相同：

敏捷的棕色狐狸跳过

快速的棕色狐狸跳跃

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T04:44:03.490

您可以使用 PIL 渲染带有文本的图像，然后确定生成的图像宽度。

[http://effbot.org/imagingbook/imagefont.htm](http://effbot.org/imagingbook/imagefont.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T04:47:58.097

我使用了一个库来执行此操作，但它需要 pygame： [http](http://inside.catlin.edu/site/compsci/ics/python/graphics.py) : //inside.catlin.edu/site/compsci/ics/python/graphics.py 在 sizeString 下查看

# android - 如何从意图调用创建自定义 PopupWindow？

> ID：16007750
> 
> 赞同：1
> 
> 时间：2013-04-15T04:39:21.520
> 
> 标签：android, android-intent, popupwindow

我想创建一个与此类似的自定义 PopupWindow：

[http://android-er.blogspot.kr/2012/03/example-of-using-popupwindow.html](http://android-er.blogspot.kr/2012/03/example-of-using-popupwindow.html)

在此示例中，PopupWindow 是由活动中的按钮单击事件创建的，但我想通过来自另一个应用程序的意图创建 PopupWindow。可能吗？任何意见将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:05:34.390

这个想法是声明一个标准的活动，使其看起来像一个弹出窗口。

使用此代码（标准样板`Intent`代码触发`Activity`）

```
SOME_WIDGET.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        Intent myIntent = new Intent(getApplicationContext(), THE_POPUP_ACTIVITY.class);
        startActivity(myIntent);
    }
}); 
```

例如，如果您将弹出窗口命名`Activity`为**Popup**`THE_POPUP_ACTIVITY.class`，则将**`Popup.class`**

现在，对于这个 Activity，在 Manifest 中声明一个`theme`. 例如：

这是相应的样式声明：

```
<style name="DialogNoTitleBar" parent="android:style/Theme.Dialog">
    <item name="android:windowIsTranslucent">true</item>
    <item name="android:windowBackground">@android:color/transparent</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowIsFloating">true</item>
    <item name="android:backgroundDimEnabled">false</item>
</style> 
```

此外，在`onCreate()`Popup Activity 中，您可能希望在`setContentView(R.layout.THE_LAYOUT_XML);`我所说的*可能*之后添加此语句，因为您希望它的显示方式可能与我对弹出 Activity 的编程方式不同。

```
getWindow().setLayout(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:02:49.847

你的要求不是很清楚。当您想要切换到另一个活动或可能将意图发送到某种服务时，通常会使用意图。如果你想为一个动作打开一个对话框，你真的不需要意图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:03:22.927

使用您的自定义设计创建一个活动，在清单文件中注册活动时，只需添加它`android:theme="@android:style/Theme.Dialog"` 并根据您的意图调用活动。希望你明白了。:)

# jquery - 使用浏览器后退按钮获取 ajax 以前的 wordpress 帖子

> ID：16007756
> 
> 赞同：0
> 
> 时间：2013-04-15T04:39:55.177
> 
> 标签：jquery, ajax, wordpress

我是 ajax wordpress 的新手，我已经用 ajax 显示了帖子，但是现在我有问题我想用 ajax 显示上一篇文章，这意味着我已经用 ajax 显示了帖子，当用户点击一个帖子时，它会显示和单击浏览器后退按钮时，不会显示以前的帖子。谁能告诉我如何使用浏览器后退按钮显示上一个 wordpress ajax 帖子。这是我用过的代码

```
 <script type="text/javascript">
    jQuery(document).ready(function($) {
    jQuery(".ajaxclick").click(function() {
    var post_id1 = $(this).parent("li").attr("id");
    var pageurl = $(this).attr('href');
    alert(pageurl);
    var ajaxURL = '<?php echo get_admin_url(); ?>admin-ajax.php';
    $.ajax({
    url: ajaxURL,
    type: 'POST',
    beforeSend: function() {
    $("#loading-animation").hide();
    $("#ajaxloader").show();
    },
    complete: function() {
    $("#loading-animation").show();
    $("#ajaxloader").hide();
    },
    data:   {
    action: 'load-content',
    post_id: post_id1 
    },
    success: function(response) {
    jQuery("#loading-animation").addClass('loadingstyle');
    jQuery("#loading-animation").html(response);
    return false;
    }

    });
    });
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:49:40.257

使用哈希`#`，

```
$(function(){
   if(location.hash === 'somepage'){
     //do ajax again automatically here
   }
 }); 
```

并在成功时添加哈希：

```
success: function(response) {
jQuery("#loading-animation").addClass('loadingstyle');
jQuery("#loading-animation").html(response, function(){
   location.hash = 'somepage';//<<-- must be identic with loaded page and same with above
}); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:59:14.490

有一个 jquery 插件似乎可以有效地管理它

> 这个 jQuery 插件通过跨浏览器 HTML5 window.onhashchange 事件启用了非常基本的可书签#hash 历史记录。

[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/) [https://stackoverflow.com/a/173075/1061871](https://stackoverflow.com/a/173075/1061871)

html5 解决方案：[https ://developer.mozilla.org/en-US/docs/DOM/window.onpopstate](https://developer.mozilla.org/en-US/docs/DOM/window.onpopstate)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T04:54:55.777

您好已经解决了这个问题，现在 ajax 帖子可以正常使用浏览器后退按钮和前进按钮，此代码在 ajax 帖子加载 ajax 后使用，然后此代码将用于显示浏览器后退按钮这里是代码：

```
 // Bind an event to window.onhashchange that, when the hash changes, 
$(window).on('hashchange', function(){
//check if hash tag exists in the URL
if(window.location.hash) {
var ajaxURL1 = '<?php echo get_admin_url(); ?>admin-ajax.php';
//set the value as a variable, and remove the #
var post_id1= window.location.hash.substring(1);
$.ajax({
url: ajaxURL1,
type: 'POST',
cache:false,
data:   {
action: 'load-content',
post_id: post_id1
},
success: function(response) {
jQuery("#loading-animation").addClass('loadingstyle');
jQuery("#loading-animation").html(response);
return false;
}   
});
}
else
{
window.location="http://203.134.217.4/testingwp/";
}
}); 
```

# redis - 与按范围设置的 redis 相交的单个命令

> ID：16007772
> 
> 赞同：5
> 
> 时间：2013-04-15T04:41:27.980
> 
> 标签：redis, jedis

雷迪斯：

```
redis>zadd zsetA 1 'A'
redis>zadd zsetA 2 'B'
redis>zadd zsetA 3 'C'
redis>zadd zsetA 5 'E'
redis>zadd zsetB 1 'A'
redis>zadd zsetB 2 'B'
redis>zadd zsetB 3 'C'
redis>zadd zsetB 4 'D' 
```

操作：

```
a=redis.ZRANGEBYSCORE 'zsetA',1,3
b=redis.ZRANGEBYSCORE 'zsetB',2,4
result=a∩b 
```

如何在单一命令中快速获得“结果”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T20:42:59.563

*编辑：哎呀！回到我回答这个问题的那天，我错过了问题的重点，这个答案不是最初的问题。*

我认为您正在寻找的是`ZINTERSTORE`（[http://redis.io/commands/zinterstore](http://redis.io/commands/zinterstore)）。

使用上面的示例，它将类似于：

> `redis.ZINTERSTORE result, 2, 'zsetA', 'zsetB'`

结果可以通过运行`redis.ZRANGE result, 0, -1`

# ios - 使用类作为静态 AVAudioPlayer 的 AVAudioPlayerDelegate

> ID：16007776
> 
> 赞同：1
> 
> 时间：2013-04-15T04:41:46.337
> 
> 标签：ios, objective-c, delegates, avaudioplayer, trigger.io

我无法在 TriggerIO 插件中维护实例，因此我需要一种静态方式来响应我`AVAudioPlayer`的事件。但是，我无法设置`player.delegate`to `audio_API`，所以我有点卡住了。

音频API.h：

```
@interface audio_API : NSObject<AVAudioPlayerDelegate> 
```

audio_API.m：

```
static AVAudioPlayer* player = nil;

@implementation audio_API

+ (void)play:(ForgeTask*)task {

    // parse the file url from the file object
    ForgeFile* file = [[ForgeFile alloc] initWithFile:[task.params objectForKey:@"file"]];
    NSString* fileURL = [file url];

    NSLog(@"Playing file at %@", fileURL);

    NSURL* url = [NSURL URLWithString:fileURL];

    // TESTING
    url = [[NSBundle mainBundle] URLForResource:@"seconds.m4a" withExtension:nil];
    // END TESTING

    NSAssert(url, @"URL is invalid.");

    // create the player
    NSError* error = nil;
    player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    if(!player)
    {
        NSLog(@"Error creating player: %@", error);
    };

//    player.delegate = audio_API;

    [player play];

    [task success:nil];
}

+ (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    if (flag) {
        [ForgeLog d:@"Audio finished playing successfully."];
    } else {
        [ForgeLog d:@"Audio did not finish playing successfully."];
    }

    // call the audio.finishedPlaying event
    [[ForgeApp sharedApp] event:@"audio.finishedPlaying" withParam:nil];
}

+ (void)audioPlayerDecodeErrorDidOccur:(AVAudioPlayer *)player error:(NSError *)error
{
    [ForgeLog d:@"Audio had error decoding."];
    [ForgeLog e:error];

    // call the audio.decodeErrorOccurred event
    [[ForgeApp sharedApp] event:@"audio.decodeErrorOccurred" withParam:nil];
}

@end 
```

知道如何进行这项工作吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:31:15.790

委托必须是一个对象，但是`audio_API`是类型名称。但是，您可以简单地将委托分配为以下的类对象`audio_API`：

```
player.delegate = (id<AVAudioPlayerDelegate>)[audio_API class]; 
```

注意：如果你不强制转换类对象，编译器会抱怨，因为`[audio_API class]`返回 a `Class`，而不是 a `Class<AVAudioPlayerDelegate>`，即使你在接口上指定了委托`audio_API`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-30T19:44:18.933

对我来说，它帮助我的班级管理声音成为 AVAudioPlayerDelegate。SoundManager.h 文件：

```
#import <Foundation/Foundation.h>
#import <AVFoundation/AVFoundation.h>

@interface SoundManager : NSObject<AVAudioPlayerDelegate> {

} 
```

在 .m 文件中，您可以选择为委托实现回调，例如：

```
-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    NSLog(@"audioPlayerDidFinishPlaying %d",flag);
} 
```

# c - 将 char 数组存储到另一个数组中 - c

> ID：16007778
> 
> 赞同：2
> 
> 时间：2013-04-15T04:41:59.387
> 
> 标签：c

我想知道是否有人可以帮助我解决以下代码片段。我想弄清楚的是如何将一个数组存储在另一个数组中。我已经尝试了所有我能想到的方法，但都导致编译器出错。以下是我的代码片段，应该足以向您展示我的立场：

```
char min[20], max[20], input[20] ;
printf("Enter word: ");
scanf("%s", &input);
min = input; max = input; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T04:44:25.227

```
char min[20], max[20], input[20] ;
printf("Enter word: ");
scanf("%s", input);
strcpy(min, input);
strcpy(max, input); 
```

这就是你的做法。请注意，我已经删除`&`了`scanf`也。

`scanf`不是一个很好的功能 - [http://c-faq.com/stdio/scanfprobs.html](http://c-faq.com/stdio/scanfprobs.html)

`#include <string.h>`获取`strcpy`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T04:48:16.760

我认为您必须将输入复制到`max`数组`min`中。所以代码应该是

```
char min[20], max[20], input[20] ;
printf("Enter word: ");
scanf("%s", input);
strcpy(min,input);
strcpy(max,input); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T04:45:01.543

`memcpy`是你的朋友：

```
char min[20], max[20], input[20];
memset(min,'d',19);
min[19] = 0;
memcpy(min,max,20); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T04:45:17.180

您应该尝试复制字符串。

```
strncpy(input, min, sizeof(min)-1);
strncpy(input, max, sizeof(max)-1);
//to be careful
min[sizeof(min)-1] = '\0';
max[sizeof(max)-1] = '\0'; 
```

# c++ - 由于 const 成员，'operator =' 函数不可用

> ID：16007782
> 
> 赞同：0
> 
> 时间：2013-04-15T04:42:38.507
> 
> 标签：c++

处理这个问题的最佳方法是什么？我希望“x”保持不变。

```
class Foo 
{
public:
    Foo(int x) : x(x) { }
    const int x;
};

void main()
{
    Foo a(0), b(1);
    b = a; // error C2582: 'operator =' function is unavailable in 'Foo'
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:42:13.000

设为`x`私有。添加一个公共函数，例如`int getX()`返回值。例如：

```
class Foo
{
public:
    Foo(int x) : _x(x) {}
    int getX(){return _x;}
private:
    int _x;
}; 
```

现在改变 x 的唯一方法是调用构造函数，这是你想要的行为（我认为）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T15:41:17.000

编译器不会生成`operator=`（分配每个数据成员）的默认版本，因为它无法知道您想对该 const 数据成员做什么。这并不意味着你不能编写自己的`operator=`，它只是意味着编译器不会为你提供一个。所以决定你想用那个 const 数据成员做什么，并编写一个赋值运算符来完成它，以及赋值运算符需要做的任何其他事情。

# php - 动态解析文件位置以下载

> ID：16007783
> 
> 赞同：1
> 
> 时间：2013-04-15T04:42:38.520
> 
> 标签：php, restler

我正在使用restler框架，并在下面给出了一个类

```
class file {
function upload ($url= ' '){
    echo $url ;
}
} 
```

我想输入一个链接，以便服务器根据 url 下载文件，所以如果我把它放在浏览器中

```
http://localhost/apiv1/file/upload?url=http://10.220.5.181/New%20folder/02%20Track%202.mp3 
```

我得到回应

```
Warning: parse_url(/apiv1/file/upload?url=http://10.220.5.181/New%20folder/02%20Track%202.mp3): Unable to parse URL in /usr/share/airtime/public/vendor/Luracast/Restler/Restler.php 
```

那么这是什么意思，我该如何解决呢？

PS：请注意它确实正确执行了该功能（即：它上传文件）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T15:45:27.903

您的网址无效。您必须`urlencode()`查询值。请尝试以下方法：

```
http://localhost/apiv1/file/upload?url=http%3A%2F%2F10.220.5.181%2FNew%2520folder%2F02%2520Track%25202.mp3 
```

# html - 不能'使导航显示在 h1 元素旁边

> ID：16007787
> 
> 赞同：1
> 
> 时间：2013-04-15T04:43:27.300
> 
> 标签：html, css, floating

***解决了 - 这是一个集体的努力。非常感谢你们，我在这里的第一次发帖体验非常棒，你们都给了我要学习的东西：）***

我正在尝试使用 html5/css(3) 创建一个网站。我希望有一个导航栏位于标题的远端，并与 h1 元素位于同一行，同时共享 h1 背景。（如果可能的话）我将发布我正在使用的代码，以及一个屏幕截图，显示它的外观与我想要的外观。 ***注意***我已经搞砸了几个小时，所以我的代码很漂亮......现在到处都是。对不起。

图片链接：http: [//i36.photobucket.com/albums/e50/Fallon_Vii/screencap.png](http://i36.photobucket.com/albums/e50/Fallon_Vii/screencap.png)

```
<body id="wrapper">
<div id="header">
<img src="images/logo2.png">
<h2>Broadcast Services</h2>

<ul id="nav">
<li class="border"> <a href="index.hmtl">Home</a></li>
<li class="border"> <a href="about.hmtl">PAGE 2</a></li>
<li class="border"> <a href="master.hmtl">PAGE 3</a></li>
<li class="border"> <a href="advertise.hmtl">PAGE 4</a></li>
<li class="border"> <a href="entertainment.hmtl">PAGE 5</a></li>
<li> <a href="contact.hmtl">Contact Us</a></li>
</ul>
</div> 
```

* * *

```
#header {
width: 100%;
border-top: 1.5px solid black;
border-bottom: 1.5px solid black;
margin-bottom: 4%;
padding: .75%;
}

#header img {
width: 30%;
display: inline;
}

h2 {
color: #4F2F8F;
font-size: 125%;
font-weight: bold;
background-image: url(images/transpblack10.png);
text-shadow: 1px 1px 1px #000000;
line-height: 85%;
}

#nav  {
font-size: 110%;
float: right;
}

#nav ul li {
display: inline;
float: left;
list-style-type: none;
}

#nav ul li a {
display: inline-block;
text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:52:29.113

好吧，首先你的`<ul>`'s 没有正确的语法......它应该看起来像这样：

```
ul#nav li {
display: inline;
float: left;
list-style-type: none;
}

ul#nav li a {
display: inline-block;
text-decoration: none;
} 
```

我相信这就是您要实现的目标：

[http://jsfiddle.net/NQVLy/5/](http://jsfiddle.net/NQVLy/5/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T05:12:33.903

嗨，艾莉森，请根据您的要求检查下面提到的代码，它的工作正常......

实际上，您犯了一些小错误，这就是为什么它变得如此混乱的原因，现在我已经对错误及其工作进行了排序，因此您可以检查....

**[现场演示](http://jsfiddle.net/NQVLy/11/)**

**HTML**

```
<body id="wrapper">
<div id="header">

 <div class="bg">
<img src="images/logo2.png">
<h2>Broadcast Services</h2>
<ul id="nav">
<li class="border"> <a href="index.hmtl">Home</a></li>
<li class="border"> <a href="about.hmtl">PAGE 2</a></li>
<li class="border"> <a href="master.hmtl">PAGE 3</a></li>
<li class="border"> <a href="advertise.hmtl">PAGE 4</a></li>
<li class="border"> <a href="entertainment.hmtl">PAGE 5</a></li>
<li> <a href="contact.hmtl">Contact Us</a></li>
</ul>
</div>
</div> 
```

**CSS**

```
#header {
width: 100%;
border-top: 1.5px solid black;
border-bottom: 1.5px solid black;
margin-bottom: 4%;
padding: .75%;
}

#header img {
width: 30%;
display: inline;
}
.bg {
    background:grey;
}
h2 {
color: #4F2F8F;
font-size: 125%;
font-weight: bold;
text-shadow: 1px 1px 1px #000000;
display:inline-block;
    margin:0;
    padding:0;
}

#nav  {
font-size: 110%;
float: right;
    margin:0;
    padding:0;
}

#nav li {
display: inline;
float: left;
list-style-type: none;
}

#nav li a {
display: inline-block;
text-decoration: none;
    color:#fff;
} 
```

# jquery - jQuery：鼠标悬停时菜单项略微向右滑动

> ID：16007788
> 
> 赞同：0
> 
> 时间：2013-04-15T04:43:37.307
> 
> 标签：jquery, menu, sliding

我认为这很容易制作，但我还没有真正习惯 jQuery，我才刚刚开始学习。

通过CSS，我们可以写一个item:hover class，写left:20px；对我们的菜单项应用轻微的滑动效果，例如`<li> Item </li>`

现在我想以流畅的动作实现这一点，即不是突然出现在 20 像素的右边，而是滑到那里。我认为 jQuery 中的动画东西用于此类动画，但我真的不擅长 jQuery，我不知道应该在哪里以及以什么顺序放置代码。你能给我一个简单的例子吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:07:35.450

您可以按照 bipen 的回答中指出的那样使用 jQuery。

我有一些简单的 CSS 用于处理悬停转换，但正如 mikakun 所说，这仅适用于浏览器 CSS3 检查兼容浏览器的[caniuse](http://caniuse.com/#feat=css-transitions)。

```
li {
    /* put your base styles here */
}

li:hover {
    /* put your new styles here */
    transition:all 300ms ease;
    -moz-transition:all 300ms ease;
    -webkit-transition:all 300ms ease;
    -o-transition:all 300ms ease;
} 
```

这将为您为特定元素指定的任何内容设置 300 毫秒的转换。

如果你有一个兼容 CSS3 的浏览器，你可以看到这个：

[http://jsfiddle.net/3leven11/7aRhe/](http://jsfiddle.net/3leven11/7aRhe/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:52:50.767

使用[动画（）](http://api.jquery.com/animate/)

```
 $('li').hover(function(){
      $(this).animate({left:20},2000)
  },function(){
      $(this).animate({left:0},2000)
 }); 
```

这将为`<li>`文档中的所有内容设置动画..您可以指定一个`<li>`具体的类..`2000`这里是动画的持续时间

# c - 在 C 中保持套接字打开

> ID：16007789
> 
> 赞同：3
> 
> 时间：2013-04-15T04:43:40.180
> 
> 标签：c, sockets, parent-child

我认为这可能是一个简单的解决方案，我只是想多了。我正在编写一个非常基本的聊天程序，客户端和服务器轮流发送消息。现在我有它，它只来回发送一次消息，客户端关闭套接字。该程序不必同时打开套接字，只要它可以像秋千一样来回切换，而不是一个真正的聊天程序，它可以同时从双方接受多个输入。

客户端中的 while 循环是否会使其保持打开状态，while 循环的条件是什么？

我尝试了几种不同的条件，但都没有奏效……它只是让它挂起。我也试过注释掉`close()`服务器代码中的一些函数，但这也不起作用。

我也有一个收到的输入打印乱码的小问题，但我认为这是因为它正在打印字符串数组的内存地址，而其中没有任何内容......我只是不记得如何缩短它。哈哈。

**服务器.c：**

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>
#include <arpa/inet.h>
#include <sys/wait.h>
#include <signal.h>

#define PORT "3490"  // The port users will be connecting to

#define BACKLOG 10   // How many pending connections queue will hold

char input[20];
char *pointer;

void sigchld_handler(int s)
{
    while(waitpid(-1, NULL, WNOHANG) > 0);
}

// Get sockaddr, IPv4 or IPv6:
void *get_in_addr(struct sockaddr *sa)
{
    if (sa->sa_family == AF_INET) {
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }
    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

int main(void)
{
    int sockfd, new_fd;  // Listen on sock_fd, new connection on new_fd
    struct addrinfo hints, *servinfo, *p;
    struct sockaddr_storage their_addr; // Connector's address information
    socklen_t sin_size;
    struct sigaction sa;
    int yes = 1;
    char s[INET6_ADDRSTRLEN];
    int rv;

    memset(&hints, 0, sizeof hints);
    hints.ai_family = AF_UNSPEC;
    hints.ai_socktype = SOCK_STREAM;
    hints.ai_flags = AI_PASSIVE; // use my IP

    if ((rv = getaddrinfo(NULL, PORT, &hints, &servinfo)) != 0) {
        fprintf(stderr, "getaddrinfo: %s\n", gai_strerror(rv));
        return 1;
    }

    // loop through all the results and bind to the first we can
    for(p = servinfo; p != NULL; p = p->ai_next) {
        if ((sockfd = socket(p->ai_family, p->ai_socktype,
                             p->ai_protocol)) == -1) {
            perror("server: socket");
            continue;
        }

        if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &yes,
                       sizeof(int)) == -1) {
            perror("setsockopt");
            exit(1);
        }

        if (bind(sockfd, p->ai_addr, p->ai_addrlen) == -1) {
            close(sockfd);
            perror("server: bind");
            continue;
        }

        break;
    }

    if (p == NULL)  {
        fprintf(stderr, "server: failed to bind\n");
        return 2;
    }

    freeaddrinfo(servinfo); // All done with this structure

    if (listen(sockfd, BACKLOG) == -1) {
        perror("listen");
        exit(1);
    }

    sa.sa_handler = sigchld_handler; // Reap all dead processes
    sigemptyset(&sa.sa_mask);
    sa.sa_flags = SA_RESTART;
    if (sigaction(SIGCHLD, &sa, NULL) == -1) {
        perror("sigaction");
        exit(1);
    }

    printf("server: waiting for connections...\n");

    sin_size = sizeof their_addr;

    while((new_fd = accept(sockfd, (struct sockaddr *)&their_addr, &sin_size)) > 0) {  // Main accept() loop

        if (new_fd == -1) {
            perror("accept");
            continue;
        }

        inet_ntop(their_addr.ss_family,
            get_in_addr((struct sockaddr *)&their_addr),
            s, sizeof s);
        printf("server: got connection from %s\n", s);

        if (!fork()) { // this is the child process
            close(sockfd); // child doesn't need the listener

            char input[20];
            char *pointer;
            printf("Type in an server's input: ");
            scanf("%s", input);
            pointer = input;  //Will need to clean this up to be more effcient... later

            if (send(new_fd, pointer, strlen(input), 0) == -1) //Need to change the length to
                                                               //the actual length of the
                                                               //input... later.

                perror("send");
            close(new_fd);
            exit(0);
        }

        char Cinput[20];
        if ((recv(new_fd, Cinput, strlen(Cinput), 0)) == 0) { //NEW LINE ADDED HERE
            printf("No more messages");
        }

        if ((recv(new_fd, Cinput, strlen(Cinput), 0)) == -1) {
                perror("recv");
                exit(1);
        }

        printf("Server: received '%s'\n",Cinput);

        close(new_fd);  // Parent doesn't need this
    }
    return 0;
} 
```

**客户端.c**

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <netdb.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/socket.h>

#include <arpa/inet.h>

#define PORT "3490" // The port client will be connecting to

#define MAXDATASIZE 100 // Max number of bytes we can get at once

// Get sockaddr, IPv4 or IPv6:
void *get_in_addr(struct sockaddr *sa)
{
    if (sa->sa_family == AF_INET) {
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }

    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

int main(int argc, char *argv[])
{
    int sockfd, numbytes;
    char buf[MAXDATASIZE];
    struct addrinfo hints, *servinfo, *p;
    /*
        This is what is in the struct

        struct addrinfo {
            int ai_flags; // AI_PASSIVE, AI_CANONNAME, etc.
            int ai_family; // AF_INET, AF_INET6, AF_UNSPEC
            int ai_socktype; // SOCK_STREAM, SOCK_DGRAM
            int ai_protocol; // Use 0 for "any"
            size_t ai_addrlen; // Size of ai_addr in bytes
            struct sockaddr *ai_addr; // struct sockaddr_in or _in6
            char *ai_canonname; // Full canonical hostname
            struct addrinfo *ai_next; // Linked list, next node
        };

        getaddrinfo() will return a pointer to this
    */
    int rv;
    char s[INET6_ADDRSTRLEN];

    if (argc != 2) {
        fprintf(stderr,"usage: client hostname\n");
        exit(1);
    }

    memset(&hints, 0, sizeof hints);
    hints.ai_family = AF_UNSPEC;
    hints.ai_socktype = SOCK_STREAM;

    if ((rv = getaddrinfo(argv[1], PORT, &hints, &servinfo)) != 0) {
        fprintf(stderr, "getaddrinfo: %s\n", gai_strerror(rv));
        return 1;
    }

    // Loop through all the results and connect to the first we can
    for(p = servinfo; p != NULL; p = p->ai_next) {
        if ((sockfd = socket(p->ai_family, p->ai_socktype,
                             p->ai_protocol)) == -1) {
            perror("client: socket");
            continue;
        }

        if (connect(sockfd, p->ai_addr, p->ai_addrlen) == -1) {
            close(sockfd);
            perror("client: connect");
            continue;
        }

        break;
    }

    if (p == NULL) {
        fprintf(stderr, "client: failed to connect\n");
        return 2;
    }

    inet_ntop(p->ai_family, get_in_addr((struct sockaddr *)p->ai_addr),
              s, sizeof s);
    printf("client: connecting to %s\n", s);

    freeaddrinfo(servinfo); // All done with this structure

    while(1)//NEW LINE ADDEDthis is getting the client to repeat asking for the input, but doesn't send it.
    {
        if ((numbytes = recv(sockfd, buf, MAXDATASIZE-1, 0)) == 0) { //NEW LINE ADDED
               printf("Shutdown");
        }

        if ((numbytes = recv(sockfd, buf, MAXDATASIZE-1, 0)) == -1) {
            perror("recv");
            exit(1);
        }

        buf[numbytes] = '\0';

        printf("client: received '%s'\n",buf);

        char Cinput[20];
        char *pointer;
        printf("Type in an client's input: ");
        scanf("%s", Cinput);
        pointer = Cinput;
        if (send(sockfd, pointer, strlen(Cinput), 0) == -1)
        {
            perror("send");
            close(sockfd);
            exit(0);
        }
    }

    close(sockfd); //As soon as the client receives a message, it closes the socket.
    //We probably need a while loop in here in order to keep the socket open,
    //but what are the parameters for the while loop?
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T06:15:50.030

以下伪代码将确保*同一个*客户端和服务器可以无限地相互发送消息，直到其中一个挂断：

### 客户：

1.  创建`socket`.
2.  `connect`给它。
3.  `recv`数据。
4.  如果`recv`返回0，则表示对端已经有序关机。转到步骤 7。
5.  `send`回复。
6.  转到第 3 步。
7.  停止。

### **服务器**：

1.  创建`socket`.
2.  `bind`套接字到一个地址。
3.  将套接字标记为`listen`ing。
4.  `accept`一个连接。
5.  如果接受的连接无效，请转到步骤 4。
6.  `send`数据。
7.  `recv`回复。
8.  如果`recv`返回0，则表示对端已经有序关机。转到第 4 步以接受新连接。
9.  转到第 6 步。

# lua - lua读写表数据

> ID：16007796
> 
> 赞同：0
> 
> 时间：2013-04-15T04:44:34.043
> 
> 标签：lua, lua-table

我正在使用以下 lua 脚本来访问和读取外部 lua 文件：

```
FileStr = "lariatData-sgeT-2012-05-31.lua"
Hnd, ErrStr = io.open(FileStr, "r")
if Hnd then
    dofile(FileStr)
    for Str in Hnd:lines() do
        print(Str, "\n")
        for exec, val in pairs(sgeT) do
            print(exec.." "..val, "\n")
        end
    end
    Hnd.close()
else
    print(ErrStr, "\n")
end 
```

但是，当返回 exec 键的值时，我得到一个十六进制的内存位置。例如，一行输出如下：

```
table: 07x7fdc5b2538f0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:06:01.740

正如我在你之前的问题上回答的那样；你需要递归调用一个函数。[这里](https://stackoverflow.com/a/11886528)有一个示例程序。

```
function DeepPrint (e)
    -- if e is a table, we should iterate over its elements
    if type(e) == "table" then
        for k,v in pairs(e) do -- for every element in the table
            print(k)
            DeepPrint(v)       -- recursively repeat the same procedure
        end
    else -- if not, we can just print it
        print(e)
    end
end 
```

# ios - 无法编辑 iOS 配置文件

> ID：16007799
> 
> 赞同：0
> 
> 时间：2013-04-15T04:44:48.043
> 
> 标签：ios, ios-provisioning

自从我上次访问该站点以来，OS 配置文件似乎已更新。

我想更新我的配置文件，将现有设备添加到配置文件中，但是“生成”按钮始终处于禁用状态，我无法按下它。

那么这里发生了什么？我应该如何使用这个新网站更新我的个人资料？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T04:48:08.963

在我的屏幕上：

*   配置文件`Managed by Xcode`的`Edit`按钮变灰（`Generate`不再有按钮）。
*   不受 Xcode 管理的配置文件可以在线编辑。

所以通过 Xcode 编辑配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:23:12.687

这是因为您在配置文件名称中使用了“ **_ ”。**因为我已经在[这里给出了类似问题的答案](https://stackoverflow.com/questions/15964600/provisoning-profile-generate-button-not-working/15965472#15965472)

如果您使用启用**生成按钮**，请删除**下划线**，因为苹果现在限制使用此特殊字符。

 **希望能帮助到你**

# ios - 我可以将 iO 中现有的 inApp 用于新版本的应用程序吗？

> ID：16007802
> 
> 赞同：0
> 
> 时间：2013-04-15T04:44:52.887
> 
> 标签：ios, in-app-purchase

我已经提交了我的应用程序及其 inApps 的第一个版本。现在我想使用现有的 inApps 提交新版本的应用程序。但应用审核团队表示，您的应用中并未实现 inApp 功能。但是我在使用 inAPPs 提交之前使用相同的代码也实现了 inAPPp 功能。我应该重新提交之前批准的所有应用程序新版本的应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T13:06:10.567

不，您不必重新提交 IAP。在提交表格中指明测试人员可以在哪里购买您的 IAP。

# sql - SQL Server：如何连接两个表并水平旋转第二个表

> ID：16007807
> 
> 赞同：0
> 
> 时间：2013-04-15T04:45:04.013
> 
> 标签：sql, sql-server, tsql

我有两张表，我需要在一张表中显示员工列表，横向同一公司的所有客户最多可以有 50 个客户

表一：

```
Company_id  staff name  email
1       John        john@abc
1       Mandy       mandy@aaa
2       Jane        Jane@jlkj
3       Andy        Andy@uuu 
```

表二：

```
Company_id  client name client class
1       a       02
2       ss      01
2       d       08 
```

结果表：

```
Company_Id  staff name  email            client 1   client 2 client3    …..  clientX 
1       John        john@abc     a(02)
1       Mandy       mandy@aaa  a(02)
2       Jane        Jane@jlkj       ss(01)  d(08) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:02:18.847

试试这个——

```
CREATE TABLE dbo.staff 
(
      company_id INT
    , staff_name NVARCHAR(50)
    , email NVARCHAR(50)
)

INSERT INTO dbo.staff  (company_id, staff_name, email)
VALUES 
    (1, 'John', 'john@abc'),
    (1, 'Mandy', 'mandy@aaa'),
    (2, 'Jane', 'Jane@jlkj'),
    (3, 'Andy', 'Andy@uuu')

CREATE TABLE dbo.client 
(
      company_id INT
    , client_id INT
    , client_name NVARCHAR(50)
    , client_class NVARCHAR(50)
)

INSERT INTO dbo.client (company_id, client_id, client_name, client_class)
VALUES 
    (1, 1, 'a', '02'),
    (2, 2, 'ss', '01'),
    (2, 3, 'd', '08')

DECLARE 
      @Cols NVARCHAR(MAX)
    , @SQL NVARCHAR(MAX)

SELECT @Cols = 
    STUFF((
        SELECT DISTINCT ',' + QUOTENAME(c.client_id) 
        FROM dbo.client c
        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)') 
     , 1 , 1, '')

SELECT @SQL = '
SELECT s.staff_name, s.email, d.*
FROM (
    SELECT 
          company_id
        , ' + @Cols + ' 
    FROM (
        SELECT name = client_name + ''('' + client_class + '')'', client_id, company_id
        FROM dbo.client
    ) x
    PIVOT 
    (
        MAX(name)
        FOR client_id IN (' + @Cols + ')
    ) p 
) d
JOIN dbo.staff s ON s.company_id = d.company_id
'

EXEC sys.sp_executesql @SQL

SELECT  s.company_id
    ,   s.staff_name
    ,   s.email
    ,   c.clients 
FROM dbo.staff s
OUTER APPLY (
    SELECT clients = STUFF((
        SELECT N', ' + c.client_name + '(' + c.client_class + ')'
        FROM dbo.client c
        WHERE c.company_id = s.company_id
        FOR XML PATH(N''), TYPE, ROOT).value(N'root[1]', N'NVARCHAR(MAX)'), 1, 2, '')
) c
WHERE c.clients IS NOT NULL 
```

![结果窗口](https://i.stack.imgur.com/qHY4p.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T05:32:22.993

USE FOR XML CLAUSE 和 SUBQUERY [解决方案](http://sqlfiddle.com/#!3/c9c87/3)

# java - 将 char AZ 转换为对应的 int。

> ID：16007814
> 
> 赞同：5
> 
> 时间：2013-04-15T04:45:38.890
> 
> 标签：java, arrays

我正在尝试将 A char 从数组（第二个和第三个）插槽转换为对应于例如的 int 值。A = 1 , B= 2 等。对于 AZ。

我认为 if(x.charAt(i) == 'a'){ int z = 1; } 对于整个 A - Z，我认为这是一种非常实用的方法。有什么方法可以用更短的代码做同样的事情吗？

```
public static void computeCheckDigit(String x){
char [] arr = new char[x.length()];

for(int i=0; i<x.length();i++){
    arr[i] = x.charAt(i);
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T04:47:07.627

尝试这个：

```
arr[i] = Character.toLowerCase(x.charAt(i)) - 'a' + 1; 
```

您必须使用 int Array 而不是 char Array。

```
public static void main(String[] args) {
    String x = "AbC";
    int[] arr = new int[x.length()];

    for (int i = 0; i < x.length(); i++) {
        arr[i] = Character.toLowerCase(x.charAt(i)) - 'a' + 1;
    }
    System.out.println(Arrays.toString(arr));

} 
```

输出：

```
[1, 2, 3] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T05:05:03.257

由于您似乎不区分大小写，因此您可能希望先将字符串大写或小写，但您希望了解区域设置：

```
// If you don't state a locale, and you are in Turkey,
// weird things can happen. Turkish has the İ character.
// Using lower case instead could lead to the ı character instead.
final String xu = x.toUpperCase(Locale.US);
for (int i = 0; i < xu.length(); ++i) {
    arr[i] = xu.charAt(i) - 'A' + 1;
} 
```

另一个循环将使用：

```
// Casing not necessary.
for (int i = 0; i < x.length(); ++i) {
    // One character
    String letter = x.substr(i, i+1);
    // A is 10 in base 11 and higher.  Z is 35 in base 36.
    // Subtract 9 to have A-Z be 1-26.
    arr[i] = Integer.valueOf(letter, 36) - 9;
} 
```

# google-apps-script - Google 应用脚本创建身份验证

> ID：16007815
> 
> 赞同：1
> 
> 时间：2013-04-15T04:45:51.120
> 
> 标签：google-apps-script

我有一个应用程序谷歌应用程序脚本，我在这个应用程序中有超过 3 个用户我想为此应用程序创建一个用于身份验证的界面，并且根据任何用户，我将打开适合每个用户的界面。有些人可以帮助我写一篇文章或一些代码。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T21:27:44.623

我使用的方法是：

1.  设置一个“authed”组，其中包含允许使用脚本的用户，该脚本允许通过现有的 cpanel 界面轻松更改授权人员，并节省创建单独的授权人员存储

2.  将脚本设置为以所有者身份运行

3.  在剧本中，

    一个。获取活跃用户

    湾。获取该用户的组

    C。如果该组数组包含“已验证”组，则继续，否则正常失败

# grails - Grails 2.2 是否值得用于严肃和复杂的 Web 应用程序开发？

> ID：16007816
> 
> 赞同：2
> 
> 时间：2013-04-15T04:45:52.450
> 
> 标签：grails

我们正在考虑在下一个项目中使用 grails。但是我们不确定它是否足够成熟可以使用。

我们在谷歌上搜索过，甚至在 SO 上看到的现有帖子很少，人们说好话和坏话，但我猜它们是旧帖子和文章。

截至 2013 年和 grails 2.2 版本，在迁移到 grails 之前我们应该考虑哪些问题？

# php - Apache 和 URL 重写

> ID：16007820
> 
> 赞同：1
> 
> 时间：2013-04-15T04:46:13.700
> 
> 标签：php, apache, .htaccess

我有 2 个主页。它是这样工作的，

```
<html>
  <body>
    <div id='menu'></div>
    <div id='content'><?PHP require("content.php"); ?></div>
  </body>
</html> 
```

然后，content.php 从 url 中拉出“页面”，并通过“好页面”的 url 进行检查。如果没有，则有默认值。无论如何，典型的 url 看起来像这样

*   /index.php?page=user&id=1
*   /?page=group&id=3

我试图让它看起来像这样

*   /用户/1
*   /组/3

这就是我的 .htaccess 文件，它不能 100% 工作。它拉出正确的页面，但似乎没有上传 css 文件。它在主目录的 /css/ 中作为索引和内容。

***编辑***

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule ^(.*)/(.*)$ /index.php?page=$1&id=$2 [L] 
```

如果可能的话，我希望应用程序具有可扩展性。
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:13:04.257

您将希望使用 CSS 的绝对路径，或者使用 a ，或者如果路径从根域开始，则`base href`可以在 CSS 的路径前加上 a 前缀。`/`

您的 .htaccess 很好，但可能需要一些细微的调整：

```
RewriteEngine On
RewriteRule ^(\w)/([0-9]+)/$ /index.php?page=$1&id=$2 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:58:20.813

请在 .htaccess 中尝试以下代码

```
RewriteEngine On
RewriteRule ^user/([0-9]+)/$ /index.php?page=user&id=$2 [L,QSA]
RewriteRule ^group/([0-9]+)/$ /index.php?page=group&id=$2 [L,QSA] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:58:27.100

请尝试使用以下代码，您可以获得`$_GET['page']`. 然后您可以拆分值`/`，然后可以获取您的用户名、ID 等

```
RewriteEngine On
RewriteBase /project/
RewriteRule ^([A-Za-z0-9]+){0,1}$ index.php?page=%{REQUEST_URI} [L,NC,QSA] 
```

在上面的代码中，您可能希望将 替换`/project/`为`/`。它将完美地工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T04:58:28.810

试试这个*.htaccess*代码

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^(.*)/(.*)$ /index.php?page=$1&id=$2 [L] 
```

您现在可以通过..直接访问您的网页

```
www.yourdomain.com/user/1
www.yourdomain.com/group/3 
```

# javascript - 如何通过 Sencha Touch 使用 Google Endpoints？

> ID：16007829
> 
> 赞同：0
> 
> 时间：2013-04-15T04:47:29.427
> 
> 标签：javascript, google-app-engine, sencha-touch-2, google-cloud-endpoints

我已经使用 Google Cloud Endpoints 为我的后端开发了一个原型。一旦在 Sencha Touch 上开发，我现在正在努力寻找一种方法来创建我的客户端。
我对 Sencha 没有深入的了解，但是在这方面工作的团队表示不可能拥有本机代码。因此，我们的客户端必须使用 JavaScript 开发。
例如，js 客户端在 appengine 应用程序中完美运行，但我在 Sencha 方面没有进展。
有人知道我该如何处理吗？有什么建议或更好的方法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:27:09.570

我假设您正在使用此处描述的回调方法 [https://developers.google.com/appengine/docs/java/endpoints/consume_js](https://developers.google.com/appengine/docs/java/endpoints/consume_js)

```
<script src="https://apis.google.com/js/client.js?onload=init">
</script> 
```

只需在 Sencha Touch 项目中包含您用于后端的 google api js。

这里有一个推荐的使用外部js的方法： [What is the proper way to load an external javascript in Sencha Touch 2](https://stackoverflow.com/questions/10334893/what-is-the-proper-way-to-load-an-external-javascript-in-sencha-touch-2)

如果您无法让 init 函数工作，或者事实证明您需要立即加载它，我想您可以将它放在 index.html 中，但由于加载时间原因，警告不要这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T07:20:59.697

这是我所做的：

*   将所需的 JS 文件（正如 user1258245 指出的那样，关键是包含 JS 文件（在我的情况下为 Client JS 和 Base JS））到项目文件夹

*   将它们链接到我的 index.html

*   添加了一种方法来初始化我对 OnLaunch() 函数的 API 调用。因此，它在应用程序加载/启动时被初始化。

*   只是为了确保收到响应，我创建了一个带有显示响应方法的按钮。在方法内部，我必须调用带有参数的“执行”方法来从后端获取响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:55:04.417

如果我理解正确，您的问题是“如何将 google MAPS API 与 Sencha 应用程序一起使用”。目前您的应用程序无法识别 google apps API。

我在应用程序文件中进行了以下更改。

**索引.html**

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 
```

**应用程序.js**

// 如下设置命名空间，并在 touch/src/lib/plugin 下添加 google 库

```
Ext.Loader.setPath({
    'Ext' : 'touch/src',
    'WU' : 'app',
    'Ext.plugin': 'lib/plugin'
}); 
```

// 在 requires 配置中添加所需的类

需要：['Ext.MessageBox','Ext.plugin.google.Traffic','Ext.plugin.google.Tracker'],

启动：函数（）{

```
 //Tracking Marker Image
   var image = new google.maps.MarkerImage(
        'resources/images/point.png',
        new google.maps.Size(32, 31),
        new google.maps.Point(0, 0),
        new google.maps.Point(16, 31)
    );

  var shadow = new google.maps.MarkerImage(
        'resources/images/shadow.png',
        new google.maps.Size(64, 52),
        new google.maps.Point(0, 0),
        new google.maps.Point(-5, 42)
    ); 
```

希望能帮助到你。

# c++ - 如何命名类、结构、枚举和联合

> ID：16007835
> 
> 赞同：-1
> 
> 时间：2013-04-15T04:48:04.320
> 
> 标签：c++, class, struct, enums, naming

两个例子：

我想定义时间：

```
class Time
{
    month(){...} 

    year(){...}

    private:

    time_t a;
}

struct Time    
{int year; int month;} 
```

但是 c++ 不能允许定义相同的名称。那么如何定义`struct`名称呢？添加前缀或后缀，例如`STime`或`TimeStruct`

同样，我想定义颜色：

```
class Color
{
  int color;

  red(){...}
}

enum Color
{
    e_red,

    e_green
} 
```

还有名字冲突。那么如何定义`enum`名称呢？添加前缀或后缀，例如`EColor`or `ColorEnum`。

使用也存在名称冲突`union`。那么如何避免`struct`,`enum`和`union`name 与类名冲突呢？添加前缀或后缀？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T04:52:21.787

您可以使用[命名空间](http://www.cplusplus.com/doc/tutorial/namespaces/)来限制范围

```
namespace MyClass
{
   class Time { ... };
}

namespace MyStruct
{
  struct Time { ... };
}

...
MyClass::Time c;
MyStruct::Time s;
... 
```

# c++ - 二维数组的简单问题

> ID：16007837
> 
> 赞同：-1
> 
> 时间：2013-04-15T04:48:13.757
> 
> 标签：c++, multidimensional-array, segmentation-fault

所以这是我正在为课堂工作的程序中的一个函数。在函数中，我想将 8 个字符的手组合为 3、4、5、6、7 和 8 个字母的单词，这些单词通过 checkDictionary 函数进行验证。一切正常，但当我想将这些创建的单词存储到一个二维字符数组（基本上是一个一维字符串数组）中时，我得到一个分段错误错误。显然导致这些问题的行是以下行：

strcpy(arrWords[count],letters8); strcpy(arrWords[count],letters7); ...

^ 直到字母3 ^

我只想知道我用诸如那些代码行存储到二维数组中到底有什么问题。此外，如果您能给我任何有关如何将这些创建的单词准确存储到二维数组（arrWords）中的建议，我们将不胜感激。非常感谢您的参与！:D

各种各样的：

*   这个程序基本上是拼字游戏

*   递增 i 和 j 的循环用于通过 10x10 的 2d 阵列板递增，其中填充有“。” 并由用户放置单词。

-字典有40438个实际单词

```
void computerMove(char dictionary[][45], char arrBoard[11][11], char computer[9])
{
  char let1, let2, let3, let4, let5, let6, let7, let8;

//      char letters3[4];
//      char letters4[5];
//      char letters5[6];
//      char letters6[7];
//      char letters7[8];
//      char letters8[9];
  int count = 0;

  char arrWords[40438][10];

    for (int i=0; i<10; i++)
    {
        for (int j=0; j<10; j++)
        {
         //   if (arrBoard[i][j]!='*')
            let1=arrBoard[i][j];

                for (int a=0; a<8; a++)
                {
                    let2=computer[a];

                        for (int b=0; b<8; b++)
                        {
                            let3=computer[b];
                            char letters3[4]={let1,let2,let3};
                            cout<<letters3<<endl;
                            if (searchDictionary(dictionary,letters3,40438)==true)
                           strcpy(arrWords[count],letters3);
                            count++;

                                for (int c=0; c<8; c++)
                                {
                                    let4=computer[c];
                                    char letters4[5]={let1,let2,let3,let4};
                                    if (searchDictionary(dictionary,letters4,40438)==true)
                                    strcpy(arrWords[count],letters4);
                                    count++;

                                        for (int d=0; d<8; d++)
                                        {
                                            let5=computer[d];
                                            char letters5[6]={let1,let2,let3,let4,let5};
                                            if (searchDictionary(dictionary,letters5,40438)==true)
                                            strcpy(arrWords[count],letters5);
                                            count++;

                                                for (int e=0; e<8; e++)
                                                {
                                                    let6=computer[e];
                                                    char letters6[7]={let1,let2,let3,let4,let5,let6};
                                                    if (searchDictionary(dictionary,letters6,40438)==true)
                                                    strcpy(arrWords[count],letters6);
                                                    count++;

                                                        for (int f=0; f<8; f++)
                                                        {
                                                            let7=computer[f];
                                                            char letters7[8]={let1,let2,let3,let4,let5,let6,let7};
                                                            if (searchDictionary(dictionary,letters7,40438)==true)
                                                            strcpy(arrWords[count],letters7);
                                                            count++;

                                                                for (int g=0; g<8; g++)
                                                                {
                                                                    let8=computer[g];
                                                                    char letters8[9]={let1,let2,let3,let4,let5,let6,let7,let8};
                                                                    if      (searchDictionary(dictionary,letters8,40438)==true)
                                                                         strcpy(arrWords[count],letters8);
                                                                    count++;
                                                                }
                                                        }
                                                }
                                        }
                                }
                        }
                }
        }
//            cout<<"YOURE OVER HERE PAL!"<<endl;
 //    for (int z=0; z<50; z++)
//    cout<<arrWords[z]<<endl;
 }

} 
```

非常感谢您提供帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:18:17.070

`strcpy` is used for copying C-strings, not arrays.

This function looks for string ending null character `'\0'` for the source and destination inputs so that it knows where to stop copy operation. But in the case of array, it may not find this character for a long memory sequence and you get segmentation error.

Instead, you can use `std::copy()` like this:

```
std::copy(std::begin(letters3),std::end(letters3), arrWords[count] ); 
```

# android - 如何使用 onChildClickListener 在可扩展列表视图中提取子项的值？

> ID：16007844
> 
> 赞同：1
> 
> 时间：2013-04-15T04:49:23.623
> 
> 标签：android, dynamic, android-intent, expandablelistview

我有一个动态生成的可扩展列表视图，并且子列表包含另一组值，我需要在子列表上设置一个 onChildClickListener，以便通过每个子列表的数据中保存的特定 URL 传递 Web 意图. 因此，我需要在每个 OnChildClickListener 事件上访问子列表的值。

请帮忙！！PS：如果需要任何进一步的解释或代码，请发表评论。

```
 @Override
    protected void onPostExecute(JSONObject result)
    {
        dialog.dismiss();

        onPostCreate(new Bundle());
        List<Map<String, String>> groupData = new ArrayList<Map<String, String>>();
        List<List<Map<String, String>>> childData = new ArrayList<List<Map<String, String>>>();

        try
        {   
            JSONObject data = result.getJSONObject("data");

            else
            {
                JSONArray jarray = data.getJSONArray("data");   

                for (int i = 0; i < jarray.length(); i++)
                {
                    JSONObject obj = (JSONObject) jarray.get(i);

                    String taskId = obj.getString("taskId");    
                    String taskSub = obj.getString("taskSubject");

                    String v1= "Task Subject :"+taskSub;

                    Map<String, String> curGroupMap = new HashMap<String, String>();   
                    groupData.add(curGroupMap);   
                    curGroupMap.put(TAG,v1); 

                    List<Map<String, String>> children = new ArrayList<Map<String, String>>();      

                        Map<String, String> curChildMap = new HashMap<String, String>();   
                        children.add(curChildMap);  
                        curChildMap.put(TAG,"               "+taskId);
                        childData.add(children); 

        }
                //ADAPTER SETTINGS
                  mAdapter = new SimpleExpandableListAdapter(           
                            Search.this,               
                            groupData,       
                            android.R.layout.simple_expandable_list_item_1,       
                            new String[] { TAG },     
                            new int[] { android.R.id.text1},   

                            childData,            
                            android.R.layout.simple_expandable_list_item_2,    
                            new String[] { TAG },     
                            new int[] { android.R.id.text1 }  
                            );      
                    setListAdapter(mAdapter); 
                    getExpandableListView().setOnChildClickListener(Search.this);           
        }
        } 
        catch (JSONException je)
        {
            je.printStackTrace();
            Log.d(TAG, "Error: " + je.getMessage());
        }       
    }
}

        @Override
        public boolean onChildClick(ExpandableListView parent, View v, int groupPosition,
                int childPosition, long id) 
        {               
            Uri webpage = Uri.parse("URL"+taskId);

              //I want to add the taskId i am extracting in my dynamic expandable list in the URL, therefore each URL will be unique according to the taskId.

            Intent webIntent = new Intent(Intent.ACTION_VIEW, webpage);
            PackageManager packageManager = getPackageManager();
            List<ResolveInfo> activities = packageManager.queryIntentActivities(webIntent, 0);
            boolean isIntentSafe = activities.size() > 0;
                if (isIntentSafe) 
                {
                 startActivity(webIntent);
                }

            return true;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T04:58:00.003

为子点击监听器添加监听器

```
getExpandableListView().setOnChildClickListener(this); 
```

添加点击监听器的代码。

```
@Override
public boolean onChildClick(ExpandableListView parent, View v, int groupPos, int childPos, long id) {
   // use groupPosition and childPosition to get the item data from adapter.
   return true;
} 
```

在适配器中添加此代码

```
@Override
//gets the name of each item
public Object getChild(int i, int i1) {         
   return dataList.get(i).getArrayChildren().get(i1);
} 
```

# ios - 裁剪从相机或库中选择的图像时出现问题

> ID：16007847
> 
> 赞同：0
> 
> 时间：2013-04-15T04:49:42.233
> 
> 标签：ios, image

以下是我用于从源获取图像然后裁剪它的代码

这就是我选择源目的地的方式

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    //Get the name of the current pressed button
    NSString *buttonTitle = [actionSheet buttonTitleAtIndex:buttonIndex];

    if ([buttonTitle isEqualToString:@"Camera Library"]) {
        [self performSelector:@selector(pickImage:) ];
    }
    if ([buttonTitle isEqualToString:@"Camera"]) {
        [self performSelector:@selector(startcamera:) ];
    }
    if ([buttonTitle isEqualToString:@"Cancel"]) {
        NSLog(@"Cancel pressed --> Cancel ActionSheet");
    }

}

- (IBAction) pickImage:(id)sender
{

    if([UIImagePickerController isSourceTypeAvailable:
        UIImagePickerControllerSourceTypePhotoLibrary])
    {
        UIImagePickerController *picker= [[UIImagePickerController alloc]init];
        picker.delegate = self;
        picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        [self presentModalViewController:picker animated:YES];
        [picker release];
    }

}
- (void)imagePickerController:(UIImagePickerController *)picker 
didFinishPickingMediaWithInfo:(NSDictionary *)info {
    self.lastChosenMediaType = [info objectForKey:UIImagePickerControllerMediaType];
    if ([lastChosenMediaType isEqual:(NSString *)kUTTypeImage]) {
        UIImage *chosenImage = [info objectForKey:UIImagePickerControllerEditedImage];
        UIImage *shrunkenImage = shrinkImage(chosenImage, imageFrame.size);
        self.imagee = shrunkenImage;
        selectImage.image = imagee;
    }     
    [picker dismissModalViewControllerAnimated:YES];
}

-(void)imagePickerControllerDidCancel:(UIImagePickerController *) picker
{
    [picker dismissModalViewControllerAnimated:YES];
}

#pragma mark  -
static UIImage *shrinkImage(UIImage *original, CGSize size) {
    CGFloat scale = [UIScreen mainScreen].scale;
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    CGContextRef context = CGBitmapContextCreate(NULL, size.width * scale,
                                                 size.height * scale, 8, 0, colorSpace, kCGImageAlphaPremultipliedFirst);
    CGContextDrawImage(context,
                       CGRectMake(0, 0, size.width * scale, size.height * scale),
                       original.CGImage);
    CGImageRef shrunken = CGBitmapContextCreateImage(context);
    UIImage *final = [UIImage imageWithCGImage:shrunken];

    CGContextRelease(context);
    CGImageRelease(shrunken);   

    return final;
}

- (void)updateDisplay {
    if ([lastChosenMediaType isEqual:(NSString *)kUTTypeImage]) {
        imageView.image = imagee;
        imageView.hidden = NO;

    } 
}

- (IBAction) startcamera:(id)sender
{

    if([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])
    {

        UIImagePickerController *picker = [[[UIImagePickerController alloc]init]autorelease];
        picker.delegate = self;
        picker.sourceType =  UIImagePickerControllerSourceTypeCamera;

        picker.allowsEditing=NO;

        [self presentModalViewController: picker animated:YES];

    }else {
        UIAlertView *alt = [[UIAlertView alloc] 
                            initWithTitle:@"Error" 
                            message:@"Camera Image Source Not Available" 
                            delegate:nil cancelButtonTitle:@"OK" 
                            otherButtonTitles:nil];
        [alt show];
        [alt release];
    }
} 
```

updateDisplay 这个方法是在viewDidAppear 中调用的。

now my problem is image picker view gets open i see the library images but when select then it get dismiss its not going in crop image screen yes i have used mobileCoreService framework

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T06:52:46.387

用这个

```
-(void)imagePickerController:(UIImagePickerController *)picker 
        didFinishPickingImage:(UIImage *)image
                  editingInfo:(NSDictionary *)editingInfo 
{
 UIImage *shrunkenImage = shrinkImage(image, imageFrame.size);
        self.imagee = shrunkenImage;
        selectImage.image = imagee;
    }     
    [picker dismissModalViewControllerAnimated:YES];
} 
```

# ios - iPad 抛出 NSUnknownKeyException，但在 iOS 模拟器中，该应用程序工作正常吗？

> ID：16007850
> 
> 赞同：1
> 
> 时间：2013-04-15T04:49:58.917
> 
> 标签：ios, ipad, ios-simulator

在 iOS 模拟器中，几乎没有什么东西可以在模拟器中正常工作，但是当我在设备中测试相同的东西时，它会抛出一些错误。

例如：我有表格视图控制器，它在模拟器中加载良好。我正在使用 iOS 6 模拟器。

相同的表视图控制器显示错误为：

```
Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<EventsTableViewController 0x1fda25e0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key indTableView. 
```

请澄清一下。

# c++ - 在 lambda 表达式中使用模板类方法时出现 GCC 编译错误

> ID：16007855
> 
> 赞同：3
> 
> 时间：2013-04-15T04:50:48.377
> 
> 标签：c++, templates, gcc, c++11, clang

以下代码在 gcc 4.6.3 中编译失败，而在 clang 3.1 中编译完美（我提供了 DummyMath 类的两个版本，都表现出相同的问题）：

```
#include <iostream>
using namespace std;

//* // To swap versions, comment the first slash.

// ===============================================
// V1
// ===============================================
template <typename T>
class DummyMath
{
public:
    T sum(T a1, T a2);
    T mult(T a1, int n);
};

template <typename T>
T DummyMath<T>::sum(T a1, T a2)
{
    return a1 + a2;
}

template <typename T>
T DummyMath<T>::mult(T a1, int n)
{
    auto x2 = [this](T a1) -> T
    {
        return sum(a1, a1); // <------- gcc will say that "sum" was not declared in this scope! 
    };

    T result = 0;
    n = n/2;
    for(int i = 0; i < n; ++i)
        result += x2(a1);
    return result;
}
/*/
// ===============================================
// V2
// ===============================================
template <typename T>
class DummyMath
{
public:
    T sum(T a1, T a2)
    {
        return a1 + a2;
    }

    T mult(T a1, int n)
    {
        auto x2 = [this](T a1) -> T {
            return sum(a1, a1);
        };

        T result = 0;
        n = n/2;
        for(int i = 0; i < n; ++i)
            result += x2(a1);
        return result;
    }
};
//*/

int main()
{
    DummyMath<float> math;
    cout << math.mult(2.f, 4) << endl;

    return 0;
} 
```

错误是：

```
main.cpp:25:20: error: ‘sum’ was not declared in this scope 
```

DummyMath 类的两个版本（V1 和 V2）在 gcc 中都失败了，并且在 clang 中都成功了。这是 GCC 中的错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T07:21:25.890

这是来自 gcc 4.7.2 的已知错误（请参阅此[问题](https://stackoverflow.com/q/14414933/819272)）。编译器识别 this 指针将被捕获，并且生成的闭包确实包含一个指向它的指针，但该指针没有在闭包的构造函数中初始化。

您可以使用`return this->sum(a1, a2);`它来使其工作。[在LiveWorkSpace](http://liveworkspace.org/code/1kV453$5)上运行您的示例，表明这对于 gcc >= 4.7.3 以及 Clang 3.2 和 Intel 13.0.1（即打印 8 作为输出）是固定的。

C++11 支持变化很大，最好尽快升级到您喜欢的编译器的最新版本。不幸的是，大多数 Linux 发行版都提供了 gcc 4.7.2 的打包版本，而 gcc 4.8.0 还没有。您可能需要从源代码编译它们。

# android - 内容提供者与多个帐户同步

> ID：16007861
> 
> 赞同：2
> 
> 时间：2013-04-15T04:51:02.737
> 
> 标签：android, android-contentprovider, android-syncadapter

我有内容提供者，它使用同步适配器与休息服务器同步。

我希望可以选择将多个帐户附加到内容提供商，每个帐户都提供单独的数据。

运行我的程序时，它会询问用户使用哪个帐户并从该帐户获取数据。

但是，设置内容提供程序以允许在内容提供程序中分离数据的推荐方法是什么？

我一直在考虑以“content://authority/{account}/{table}”的形式使用 uris，是提供这种分离的更好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-08T14:04:58.370

您可以在数据库中存储一个**Accounts 表**，然后正确加载所需的帐户数据。这喜欢 ContactsProvider 的实现。

# java - 使用 google oAuth2 从 java 应用程序收集 gmail 电子邮件

> ID：16007862
> 
> 赞同：0
> 
> 时间：2013-04-15T04:51:04.940
> 
> 标签：java, gmail, google-oauth

我有一个基于网络的电子邮件客户端，它使用 Java 应用程序连接到 IMAP 和 POP3 服务器以下载电子邮件。有一个问题是，如果用户通常从美国登录，那么在该用户从运行 java 应用程序的同一县登录之前，java 应用程序将无权收集电子邮件。

我被告知要克服这个问题以使用 google oAuth 以便帐户用户授予我的应用程序收集电子邮件的权限。这个对吗？完成此操作后，我还想使用 API 导入联系人，但现在授权/身份验证就足够了。

我面临的问题是，在尝试对谷歌 oAuth api 文档进行正面或反面之后，我真的很困惑，还没有设法制作一个有效的例子。文档通常包含指向已弃用 API 的链接，并且没有示例包含指向所需 API 和示例源代码的下载链接，因此我认为我在示例中使用了不正确的库。

我也不清楚什么/如何完成需要什么我通过javascript使用客户端身份验证来创建一个用户授予访问权限的弹出窗口？

或者我是否使用带有令牌和秘密的已安装应用程序客户端，这是我尝试过的，但我尝试的“命令行”示例需要 Java EE，这是一个本机应用程序，所以我不明白为什么，我不想导入所有 Java EE库到我的小型电子邮件下载器应用程序。

我在哪里可以找到更直观的文档和工作示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T22:29:04.417

如果您远离 OpenID 2 和 OAuth 1，我认为这些天的文档非常有序。最好的起点是[https://developers.google.com/accounts/docs/OAuth2](https://developers.google.com/accounts/docs/OAuth2)

# android - 在 OpenGL ES 2.0 中拆分对象以另一个对象的形状打开

> ID：16007863
> 
> 赞同：1
> 
> 时间：2013-04-15T04:51:07.230
> 
> 标签：android, opengl-es, opengl-es-2.0

假设我有一个正方形'S'。我需要让一个圆圈“C”穿过它，这样 S 会裂开，C 会穿过它。虽然我需要给它一个 3D 效果，但 2D 也可以（至少我会抢先一步）。有没有办法使用一些内置功能来做到这一点，或者可以转换单个像素或对象的一部分？我不确定您如何在对象内映射一个孔，但是您可以使用背景颜色制作具有孔形状的对象，使其看起来像一个孔，对吗？但真正的问题是如何让正方形裂开？（两半会以某种方式分开然后重新加入）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T11:30:13.037

好的，因为*“您希望圆圈随着时间的推移（从一帧到另一帧）移动，而正方形在圆圈所在的地方和曾经的地方消失”*，它只是 2D 的，你可以为此使用模板缓冲区。

模板缓冲区基本上为每个像素存储一个整数值，并允许您更改此值并将其与新绘制的像素进行比较，以便从绘制中排除像素。所以我们要做的就是将圆形绘制到模板缓冲区中（在圆形像素所在的地方将其设置为 1），然后在没有绘制圆形像素的地方绘制正方形（在模板缓冲区为 0 的地方）。*与“通常”*的唯一区别*模板方法是，我们不会清除帧之间的模板缓冲区，因此无论圆曾经是什么，它都会保留圆的值。因此，当您随着时间的推移在屏幕上扫过圆圈时，将不会在圆圈像素曾经所在的任何地方绘制正方形（当然，与绘制像素相同的时间离散化错误，例如圆圈应该在的地方，但不是因为它在帧之间移动得太快）。*

 *因此，首先我们将圆圈绘制到模板缓冲区中（如果您只想将圆圈用于模板而不在屏幕上绘制实际的圆圈，您可以使用 禁用颜色写入`glColorMask(GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE);`，但不要忘记之后重新启用颜色写入）：

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);   //but don't clear stencil

glEnable(GL_STENCIL_TEST);    //use stenciling

glStencilFunc(GL_ALWAYS, 1, -1);    //draw everywhere, use 1 as ref value
glStencilOp(GL_REPLACE, GL_REPLACE, GL_REPLACE);   //set pixels to ref value (1)
//draw circle

glStencilFunc(GL_NOTEQUAL, 1, -1);    //draw wherever not 1 (no circle pixels)
glStencilOp(GL_KEEP, GL_KEEP, GL_KEEP);    //leave stencil values unchanged
//draw square 
```

这只是一个基本的例子。您也可以将模板缓冲区用于其他用途。目前，无论它是否位于另一个已绘制对象的后面，圆圈都会更改模板值，但这可以通过更改值来微调[`glStencilOp`](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glStencilOp.xml)（根据模板测试是否失败，配置如何更改模板值，成功和深度测试失败，或两者都成功），同时[`glStencilFunc`](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glStencilFunc.xml)控制要执行什么测试以及针对哪个参考值（新绘制对象的值）。但是这个例子和链接的文档应该让你开始处理这个问题。

但请记住，模板缓冲区实际上是用于*“即时”*图像空间模板操作。如果这变得更加复杂并且您需要对对象执行实际的几何操作，或者如果这需要在 3D 中完成（关键字：[*Constructive Solid Geometry (CSG)*](https://en.wikipedia.org/wiki/Constructive_solid_geometry)），那么 OpenGL 不是该工作的正确工具，并且在在这种情况下，一个实际的几何库将是最好的主意。OpenGL 所做的只是在屏幕上绘制简单的东西（如点、线或三角形），仅此而已。它既不是场景管理，也不是几何图形，也不是图像处理库（尽管对于后者来说它可能被*“误用”*并不那么困难）。*

# sublimetext2 - 尝试解析设置时出错：~/.config/sublime-text-2/Packages/User/CTags.sublime-settings:1:1 中没有数据

> ID：16007877
> 
> 赞同：1
> 
> 时间：2013-04-15T04:52:28.913
> 
> 标签：sublimetext2, sublimetext, ctags, sublimetext3

我正在使用 ubantu 并尝试在 sublime text 2 上为 rails 配置 ctags。我在打开我的崇高文本时收到上述错误消息。在重新构建 ctags 时，它会在 Flash 内完成，而不会在指定位置生成 .ctag 文件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T05:28:55.767

我的猜测是现在是一个空文件。打开文件（可能通过另一个编辑器）并插入`{}`. 设置文件是 JSON 对象。看起来它没有通过 JSON 解析。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-18T03:53:45.797

您可以运行`cat ~/.config/sublime-text-2/Packages/User/CTags.sublime-settings`以查看文件中是否有任何内容。如果没有，您可以自由删除它。

尽管此错误可能是由需要一些配置以查找其首选项文件并失败的插件引起的。

# c# - 转换为值类型“int32”失败，因为具体化值为 null

> ID：16007880
> 
> 赞同：2
> 
> 时间：2013-04-15T04:52:40.210
> 
> 标签：c#, wpf, asp.net-mvc, linq

以下是我从 GameByGameTypes 和 Categories 中获取值时的代码，但在名为 GameByGameTypes 的表中，CategoryId 列具有 NULL 值。所以我想要 0 代替 NULL

```
 Category objCategory;
                var query = (from gametypebygametype in db.GameByGameTypes.Where( x => x.GameTypeId == gametypeid)
                             join category in db.Categories
                             on gametypebygametype.CategoryId equals category.CategoryId into joined
                             from category in joined.DefaultIfEmpty()
                             select new 
                             {
                                 category.CategoryId ,
                                 category.CategoryName
                             }
                             ).Distinct();
                List<Category> objlistCategory = new List<Category>();
                foreach (var item_temp in query)
                {
                    objCategory = new Category();
                    objCategory.CategoryId = item_temp.CategoryId;
                    objCategory.CategoryName = item_temp.CategoryName;
                    objlistCategory.Add(objCategory);

                } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-29T22:46:42.710

Or you can replace

```
select new 
{
    category.CategoryId,
    category.CategoryName
} 
```

with

```
select new 
{
    CategoryId = category.CategoryId ?? 0,
    CategoryName = category.CategoryName ?? "",
} 
```

If you use ReSharper - it will 'complain' that `?? 0` part is not needed. Ignore it.

And Linq-code you use is translated to SQL. When you execute it - result is null, but strongly-typed compiler cannot believe in that, and awaits non-nullable value. (this is the process of 'materialization', that fails). So you just 'hint' compiler, that it could be null.

[Here is related question](https://stackoverflow.com/questions/4347266/why-would-this-linq-to-sql-query-break-when-i-do-tolist).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T22:56:14.063

尝试使用 GetValueOrDefault

```
Category objCategory;
                        var query = (from gametypebygametype in db.GameByGameTypes.Where( x => x.GameTypeId == gametypeid)
                                     join category in db.Categories
    on new {A = gametypebygametype.categoryID.GetValueOrDefault(0)}
                equals new {A = category.categoryID}
     into joined
                                     from category in joined.DefaultIfEmpty()
                                     select new 
                                     {
                                         category.CategoryId ,
                                         category.CategoryName
                                     }
                                     ).Distinct();
                        List<Category> objlistCategory = new List<Category>();
                        foreach (var item_temp in query)
                        {
                            objCategory = new Category();
                            objCategory.CategoryId = item_temp.CategoryId;
                            objCategory.CategoryName = item_temp.CategoryName;
                            objlistCategory.Add(objCategory);

                        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:10:36.930

你有三种方法来处理这个：

1.  您可以在数据库中设置列`not null`并将默认设置为第 0 列。

2.  您可以设置 Category 属性`int? CategoryId`。

3.  您可以更改查询以使用具有默认值的 DefaultIfEmpty

    ```
     var query = (from gametypebygametype in db.GameByGameTypes.Where( x => x.GameTypeId == gametypeid)
                         join category in db.Categories
                         on gametypebygametype.CategoryId equals category.CategoryId into joined
                         from category in joined.DefaultIfEmpty( new 
                                                                 {
                                                                    CategoryId=0, 
                                                                    Categoryname=""
                                                                 })
                         select new ... 
    ```

# java - 如何使用会话工厂从 Java Hibernate 执行 sql 存储过程？

> ID：16007881
> 
> 赞同：2
> 
> 时间：2013-04-15T04:52:44.750
> 
> 标签：java, sql, spring, hibernate, stored-procedures

我无法使用会话工厂从 java hibernate 调用我的存储过程

我编写了一个 sql 过程，它接受 5 个参数并返回一个在 MS SQL 工作室中运行良好的结果集

```
EXEC SlaGrid @appID=245,@fromYear=2012,@toYear=2013,@fromMon=1,@toMon=12   --- sql

EXEC SlaGrid @applID=:applID,@fromYear=:fromYear,@toYear=:toYear,@fromMon=:fromMon,@toMon=:toMon  --hibernate 
```

我正在为上述查询设置参数

```
String queryString = "EXEC SlaGrid @applID=:applID,@fromYear=:fromYear,@toYear=:toYear,@fromMon=:fromMon,@toMon=:toMon"

Query query = sessionFactory.getCurrentSession().createSQLQuery(queryString);

//set query parameters here

query.list()    --- giving sql grammer exception 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T06:36:19.550

您可以在休眠会话上使用[可调用语句。](http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/callablestatement.html)

```
Connection con = getSessionFactory().getCurrentSession().connection();  

/**
* Amend to include your parameters and proc
*/          
CallableStatement cs = con.prepareCall( "{ call myprocedure }");

cs.execute(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T06:54:56.393

创建一个 SessionFactory 然后打开一个会话

```
CallableStatement callableStatement = session.connection().prepareCall("call GetMarketDataCDS(?,?)");
callableStatement.setString(1,"JPM");
callableStatement.registerOutParameter(1, OracleTypes.CURSOR);
callableStatement.execute();
ResultSet resultSet=(ResultSet) callableStatement.getObject(1); 
```

这里我使用的是 oracle，我的第一个参数是 IN 参数，第二个是 OUT，它只是返回多行的结果集。然后在最后一行，我们得到所有行的 ResultSet，然后你可以遍历这些行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-20T11:28:35.240

我通过以下代码简单地解决了它......只需在CSV中传递参数。感谢您的帮助......

```
String queryString = "SlaGrid 245,2012,2013,1,12"

Query query = sessionFactory.getCurrentSession().createSQLQuery(queryString);

query.list(); 
```

完美工作:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T06:39:04.500

试试这个

```
Query query = sessionFactory.getCurrentSession().createSQLQuery(
    "CALL SlaGrid(:appID, :fromYear, :toYear, :fromMon, :toMon)")
    .setParameter("appID", 245)
    .setParameter("fromYear", 2012)
    .setParameter("toYear", 2013)
    .setParameter("fromMon", 1)
    .setParameter("toMon", 12); 
```

# c++ - std::cin 的 Valgrind 错误

> ID：16007884
> 
> 赞同：1
> 
> 时间：2013-04-15T04:52:54.480
> 
> 标签：c++, input, valgrind, cin

这是我的代码：

```
 std::string getword()
 {
  std::string temp;
  std::cin >> temp;
  return temp;
 } 
```

Valgrind 在 std::cin >> temp 行抛出错误。

以下是询问者的 valgrind 输出：

```
 HEAP SUMMARY:
==18490==     in use at exit: 33 bytes in 1 blocks
==18490==   total heap usage: 397 allocs, 396 frees, 12,986 bytes allocated
==18490== 
==18490== 33 bytes in 1 blocks are possibly lost in loss record 1 of 1
==18490==    at 0x4C2AF8E: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==18490==    by 0x4EEE3B8: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17)
==18490==    by 0x4EEF127: std::string::_Rep::_M_clone(std::allocator<char> const&, unsigned long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17)
==18490==    by 0x4EEF20F: std::string::reserve(unsigned long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17)
==18490==    by 0x4EA7D14: std::basic_istream<char, std::char_traits<char> >& std::operator>><char, std::char_traits<char>, std::allocator<char> >(std::basic_istream<char, std::char_traits<char> >&, std::basic_string<char,     std::char_traits<char>, std::allocator<char> >&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17)
==18490==    by 0x401681: getword() (netsim.cc:29)
==18490==    by 0x401F6E: main (netsim.cc:96)
==18490== 
==18490== LEAK SUMMARY:
==18490==    definitely lost: 0 bytes in 0 blocks
==18490==    indirectly lost: 0 bytes in 0 blocks
==18490==      possibly lost: 33 bytes in 1 blocks
==18490==    still reachable: 0 bytes in 0 blocks
==18490==         suppressed: 0 bytes in 0 blocks
==18490== 
==18490== For counts of detected and suppressed errors, rerun with: -v
==18490== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 2 from 2) 
```

netsim.cc:96 是程序中对 getword() 的第二次调用。该代码读取

```
std::string network = getword(); 
```

netsim.cc:29 是 getword() 本身的代码。29号线是线

```
std::cin >> temp 
```

我仍然不明白为什么会这样，但我设法解决了这个问题。我有代码

```
std::string s = getword(); 
```

就在上面

```
std::string network = getword(); 
```

我制作了 s 和 network 全局变量，不知何故问题得到了解决。

如果有人能解释为什么会这样，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:19:40.977

我不是`valgrind`专家，但我暂时说这是误报。事实上，它甚至可能是自身产生的误报`valgrind`。查看泄漏摘要并看到泄漏的核心来源，我开始怀疑：

```
// The one right below this, that's at the top of that valgrind error
==18490==    at 0x4C2AF8E: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==18490==    by 0x4EEE3B8: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17) 
```

现在为什么 valgrind 会报告*它自己的共享库*的内存泄漏？这里似乎有些不对劲。要么 valgrind 本身在分配内存方面不是很干净（而且 valgrind 有它自己的泄漏！哦，不！）或者它抛出了一个非常奇怪的误报。除非 GCC 的最新分支已经为 std::string 和`istream& operator<<`最近产生了内存泄漏，否则我无法想象这实际上会泄漏。`std::cin`并且`std::cout`已经被使用了很长时间，并且`valgrind`在它上面抛出错误是没有意义的，特别是当您的客户端代码没有进行单个 new/delete 调用时。

所以，简而言之，这里可能会发生一些事情：

1.  valgrind 正在泄漏。（也许？它源自 valgrind 函数）
2.  GCC 正在泄漏？（不敢说这个）
3.  `valgrind`醉***了***！:[

在任何一种情况下，忽略它并继续前进。我怀疑这会以`netsim`任何关键的方式粉碎你。

我希望它很快就会清除，很抱歉我的回答只能说这么多，但这些是我能给出的最好的镜头。

# android - 无法执行 dex：无法将新索引 66713 合并到非巨型指令中

> ID：16007891
> 
> 赞同：1
> 
> 时间：2013-04-15T04:53:55.467
> 
> 标签：android

当我尝试运行我的项目时，控制台会显示此类消息：无法执行 dex：无法将新索引 66713 合并到非巨型指令中

# java - 如何在 JUNG 中为节点的颜色变化设置动画

> ID：16007898
> 
> 赞同：1
> 
> 时间：2013-04-15T04:54:57.240
> 
> 标签：java, graphics, jung

我有一个通过 JUNG 库可视化的图表。

现在我想改变我的特定顶点（满足特定条件）的颜色一段时间，比如说 1 秒，然后将其改回原始颜色。我想一一为我的所有顶点做这件事。我怎么能做到这一点。

当前的代码我只是让所有顶点一次改变颜色，而不是一一改变。我怎样才能将颜色改回原来的颜色并一次取一个顶点。

```
Transformer<Integer, Paint> vertexPaint = new Transformer<Integer, Paint>() {
        private final Color palette =  Color.GREEN;

        public Paint transform(Integer i) {

                     for(int j =0;j<l2.size();j++){
                         if(i == Integer.valueOf(j)){
                             return Color.BLUE;

                         }

                     }  

                     return palette;
        }
    }; 
```

# java - 从另一个类的创建对象访问一个类的方法

> ID：16007902
> 
> 赞同：0
> 
> 时间：2013-04-15T04:55:17.173
> 
> 标签：java

我在这里需要一点帮助。我有三个班`Book`，，，`Member`。`Bean`

图书.java

```
public class Book
{
  public Member m=null;
  // various getter & setter methods
} 
```

成员.java

```
public class Member
{
  public Book b=null;
  // various getter & setter methods
} 
```

在`Bean.java`我创建一个`Book`类的对象时，通过这个对象我们必须访问 Book 的所有方法以及 Member 类。现在的问题是 Book 中创建的 Member 类的对象没有初始化&我们不能使用 new 运算符来初始化它&我们不能让它静态。如果我们使用 new 运算符，则结果不会出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:27:56.957

这种设计是不正确的。

存在循环依赖。

`Book`有一个`Member`并且`Member`有一个`Book`。

你需要仔细检查这个设计。

一旦解决了依赖关系，构造函数注入将是解决此问题的最简单方法。

更新：更正了我认为正确的设计。

```
//Book  
public class Book {
   private String bookName;
   private String authorName;
   //getters and setters
}

//Member will have a book (maybe multiple) associated with them  
public class Member {
     private Book[] bookArray;
     public Member (Book... books) {
         this.bookArray = books;
     }
} 
```

# android - 如何通过 url 使用三星 s3 内置音乐播放器播放歌曲？

> ID：16007903
> 
> 赞同：1
> 
> 时间：2013-04-15T04:55:18.283
> 
> 标签：android, android-intent, android-music-player

```
Intent intent = new Intent();
ComponentName comp = new ComponentName("com.android.music","com.android.music.MediaPlaybackActivity");
intent.setComponent(comp);
intent.setAction(android.content.Intent.ACTION_VIEW);
intent.setDataAndType(Uri.parse(url), "audio/*");
startActivity(intent); 
```

这是我用来在 Galaxy S3 以外的其他手机中打开三星播放器的代码。关于 Galaxy S3 这个包被替换为

```
ComponentName comp2 = new ComponentName("com.sec.android.app.music","com.sec.android.app.music.AudioPreview"); 
```

但在这种情况下，它仅用作音频预览，但在暂停时它会完成但我想像上面的音乐播放器一样播放。所以为此我用这个替换了 ComponentName 来打开音乐播放器

```
 ComponentName comp2 = new ComponentName("com.sec.android.app.music",
                    "com.sec.android.app.music.MusicActionTabActivity"); 
```

但在这种情况下，播放器不会播放我通过的网址。它只是打开了 S3 中的默认音乐播放器。我需要使用 android 默认音乐播放器播放文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T12:31:45.920

看看 Android 正在使用 AudioPlaybackPreview 或其他命名活动，来处理从 fileManager 或任何其他地方播放的歌曲。

实际上，您想使用默认的 Playing 活动，用于显示所有控件和所有内容。亲爱的，无法使用该活动，因为它已链接到具有所有歌曲和所有路径数据的其他服务。这个正在播放的 Activity 可以控制 next atnd previous 和 all ，这与一个播放服务相关联。

第三件事是，据我所知，**S3 几乎为从文件管理器播放歌曲或从任何其他活动播放提供了相同的布局**。但问题是当你从那里回去时，**它会停止播放歌曲**。

参考**android 音乐播放器源代码**，你会明白为什么无法启动该活动。

# ios - 类似于 iPad Chrome 应用程序的标签堆叠

> ID：16007907
> 
> 赞同：0
> 
> 时间：2013-04-15T04:56:03.243
> 
> 标签：ios, tabbar

我需要在 iPad 上开发类似于 Chrome 的标签栏功能的标签栏。如果用户打开超过 5 个选项卡，则会将额外的选项卡显示为堆栈：

[堆叠标签 http://uploads.hipchat.com/26718/169836/yfzwdgq80m4rzbw/Screen%20Shot%202013-04-10%20at%202.36.56%20PM.png](http://uploads.hipchat.com/26718/169836/yfzwdgq80m4rzbw/Screen%20Shot%202013-04-10%20at%202.36.56%20PM.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:57:47.557

您可以构建一个`UINavigationController`类似的控制器，具有自己的堆栈。如果您的目标是 iOS 5.0 及更高版本，您可以使用 childViewController。控制器将有一个标签栏和容器视图。您将视图控制器添加到控制器的堆栈中。从堆栈中，您可以形成选项卡栏项目视图，使用各个 vc 的标题和视图可以重叠。

当它们被选中时，将标签栏项目视图放在前面，并将相应的 viewController 作为 childViewController 添加到 CustomTabBarController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T05:07:42.840

iOS 中没有类似的东西，所以你必须自己实现它。我建议将窗口的选项卡栏部分实现为一个单独的视图，该视图知道如何绘制各个选项卡，包括当前选定的选项卡，并在点击其中一个选项卡时向其目标或委托对象发送适当的消息.

# mysql - 将复杂查询存储为命名查询

> ID：16007910
> 
> 赞同：2
> 
> 时间：2013-04-15T04:56:12.927
> 
> 标签：mysql, sql, named-query

我正在使用 JSF 2 做一个项目，并且我有一个特别复杂的查询来提供电影建议。我试图把它作为一个命名查询，编译器告诉我有一个错误，老实说我不知道​​在哪里看

```
SELECT M.*
FROM Account A,
     Movie M,
     Orders O,
     Rental R,
  (SELECT Acc.Id
   FROM Account Acc,
     (SELECT COUNT(*) AS c,
             Acc.Id
      FROM Account Acc,
        (SELECT M.*
         FROM Account A,
              Rental R,
              Orders O,
              Movie M
         WHERE A.Id=R.AccountId
           AND R.MovieId=M.Id
           AND R.OrderId=O.Id
           AND A.Id=:id) AS a
      INNER JOIN
        (SELECT M.*,
                A.Id AS AccountId
         FROM Account A,
              Rental R,
              Orders O,
              Movie M
         WHERE A.Id=R.AccountId
           AND R.MovieId=M.Id
           AND R.OrderId=O.Id
           AND A.Id<>:id) AS b USING (Id,Name,TYPE,Rating,DistrFee,NumCopies)
      WHERE Acc.Id = b.AccountId ) AS COUNT
   WHERE COUNT.c>0
     AND COUNT.Id = Acc.Id) AS SimilarAccount
WHERE A.Id=R.AccountId
  AND R.MovieId=M.Id
  AND R.OrderId=O.Id
  AND A.Id=:id
  AND M.Id NOT IN
    (SELECT M.Id
     FROM Account A,
          Rental R,
          Orders O,
          Movie M
     WHERE A.Id=R.AccountId
       AND R.MovieId=M.Id
       AND R.OrderId=O.Id
       AND A.Id=SimilarAccount.Id) 
```

除了性能问题（教授希望通过 MySQL 完成电影建议），我不确定存储此查询以供重复使用的过程。我会将查询存储为视图，但它有一个参数（它需要用户的参数 id）

您建议如何存储此查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:20:37.963

我建议创建一个带有键值对的 Java 属性文件，并在您的 DAO 类中创建一个属性类型的私有字段，并使用 Spring 配置将其注入，该配置将从文件中读取值，或者您可以考虑使用存储过程。如果我理解你是对的......

# axis2 - 了解壁垒引擎的工作原理

> ID：16007912
> 
> 赞同：2
> 
> 时间：2013-04-15T04:56:26.260
> 
> 标签：axis2, rampart

我知道 Apache Rampart 配置允许提供密码回调处理程序类，可用于提供 Rampart 引擎构建用户名令牌和在发送消息时创建签名所需的密码。它写道，每当 Rampart Engine 需要密码来创建用户名令牌时，它将创建一个 WSPasswordCallback 实例，设置它从 Rampart 配置的参数中提取的适当标识符，并通过 handle 方法将其传递给密码回调类。但正如你所见，我使用了基于策略的配置！

所以我有几个问题想看看我是否理解了所有这些：

1.  我是从这里壁垒引擎提取适当的用户名的地方吗？`wsse:Username>bob</wsse:Username>'+`

2.  在它提取它之后，它通过句柄方法将它传递给我们的 PWCBHandler 类。如果用户名正确，我们的 handle 方法会设置适当的密码。

3.  最重要的是——因为我必须在最后通过 javascript 使用我的 web 服务，所以我提供了我的 soap 请求。但是正如您所看到的，我同时提供了用户名和密码，但我看不到安全性在哪里，因为每个人都可以看到我的用户名和密码。这是正确的吗。我怎样才能使它更安全。

这是我的代码。

* * *

1.  这是我的 PassWordCallback.java 类的代码

    ublic void handle(Callback[] callbacks) throws IOException, UnsupportedCallbackException { for (int i = 0; i < callbacks.length; i++) {

    ```
     WSPasswordCallback pwcb = (WSPasswordCallback)callbacks[i];
            if(pwcb.getIdentifier().equals("test") &&pwcb.getPassword().equals("pass")) {
                return;
             } 

            else {
                throw new UnsupportedCallbackException(callbacks[i],"Incorrect login/password");
             }
         }
     } 
    ```

这是我来自javascript的soaprequest

```
 "<?xml version=\"1.0\" encoding=\"utf-8\"?>" +
                "<soapenv:Envelope " + 
                     "xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" " +
                     "xmlns:tan=\"http://tan\">"+
                    "<soapenv:Header>"+
                     '<wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" soapenv:mustUnderstand="1">'+
'<wsse:UsernameToken xmlns:wsu="http://docs.oasisopen.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="123">'+
'<wsse:Username>bob</wsse:Username>'+
'<wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">bobPW</wsse:Password>'+
'</wsse:UsernameToken>'+
'</wsse:Security>'+
"</soapenv:Header>"+
                    "<soapenv:Body>" +
                     "<tan:testws>" +
                     '<tan:x>ECHOO</tan:x>' +
                      ' </tan:testws>'+

                    '</soapenv:Body>' +
                '</soapenv:Envelope>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-21T10:07:21.157

我先回答你的第三个问题

您正在使用用户名令牌身份验证方法对服务进行身份验证。为了提供安全性，您需要使用 https 传输而不是 http。通过这种方式，您可以提供传输级别的安全性并隐藏您的密码。可以在这里找到一些不错的阅读[http://wso2.com/library/3190/](http://wso2.com/library/3190/)

如果您使用不安全的通道（比如 http），那么您可以加密密码。用户可以使用随机字节（nounce）创建密码摘要。为了验证请求，服务将使用绑定到接收到的用户名的密码计算摘要值，并将接收到的摘要值和计算的摘要值进行比较。安全标头将被更改。可以在此找到一些详细信息。[http://wso2.com/library/240/](http://wso2.com/library/240/)。为了提供更高的安全性，您可以加密消息（[http://wso2.com/library/3415/](http://wso2.com/library/3415/)）

对于问题 1，它没有从 wsse:Username 获取用户名。它从 Rampart 配置的参数中提取用户名。此配置可以从外部加载或使用 java

```
RampartConfig rc = new RampartConfig();
rc.setUser("admin");
rc.setPwCbClass(PWDCallBackHandler.class.getName()); 
```

有关回调处理程序[http://wso2.com/library/3733/的一些信息](http://wso2.com/library/3733/)

对于问题 2：是的

# python - Python - 检查字符串是否以“是”或“否”开头？

> ID：16007914
> 
> 赞同：-4
> 
> 时间：2013-04-15T04:56:39.510
> 
> 标签：python

我想创建一个函数来检查字符串是否以“是”或“否”开头，但我不确定如何。

```
If string begins with "Yes"
return "Yes" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-15T04:57:58.747

尝试[startswith函数](http://docs.python.org/2/library/stdtypes.html#str.startswith)：

```
if myStr.startswith("Yes"):
    return "Yes"
elif myStr.startswith("No"):
    return "No" 
```

请注意，还有一个[endswith 函数](http://docs.python.org/2/library/stdtypes.html#str.endswith)来检查您的字符串是否以预期的文本结尾。

如果您需要检查该字符串是否以以下开头：

```
if not myStr.lower().startswith("yes"):
    return "Not Yes"
elif not myStr.lower().startswith("no"):
    return "Not No" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-15T05:02:03.620

可能更灵活是好的

```
if s.lower().startswith("yes"):
    return "Yes"
elif s.lower().startswith("no"):
    return "No" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T04:58:27.613

你有没有尝试过：

```
yourString.startsWith("Yes") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T05:00:50.093

所有你需要的是

```
String.startswith("yes") 
```

如果字符串不是以yes 开头，它将返回false，如果是，则返回true。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T05:59:00.033

name = "是吗？测试"

如果 name.index('Yes') == 0:

```
print 'String find!!' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-27T20:31:43.837

这可能是最好的解决方案：

```
def yesOrNo(j):  
  if j[0].lower() == 'y':
    return True
  elif j[0].lower() == 'n':
    return False
  else:
    return None
def untilYN():
  yn = input('Yes or no: ')
  j = yesOrNo(yn)
  while j == None:
    yn = input('Please insert yes or no again; there may have been an error: ')
    j = yesOrNo(yn)
  return j
print(untilYN()) 
```

例如：

```
print(untilYN())
>> Yes or no: Maybe
>> Please insert yes or no again; there may have been an error: yeah then
True 
```

# javascript - perl cgi 与 javascript 对话

> ID：16007921
> 
> 赞同：0
> 
> 时间：2013-04-15T04:57:27.720
> 
> 标签：javascript, database, perl, cgi, xss

我想从一个在线数据库中检索一个 csv 文件。但是，由于一些 XSS 问题，我不能直接使用 ajax，而是需要在 perl-cgi 文件上进行中继。

我已经有一个可以工作的 perl-cgi 文件，它可以查询 csv 文件，并将文件的内容写入一个名为 $text 的 perl 变量。以下是一些代码片段：

```
#!/usr/bin/perl

use strict;
use CGI;
use HTTP::Request::Common qw(POST);
use LWP::UserAgent; 

# construct cgi object
my $q = CGI->new;

# create a post request
my $useragent = LWP::UserAgent->new();  
my $request = POST '.....', [ 
     #something goes here
];
my $response = $useragent->request($request);
my $text = $response->content; 

print $text; 
```

我对接下来要做什么有一些大致的想法，但对细节不太确定。我将把这个 perl-cgi 文件上传到托管我网站的服务器，到名为 cgi-bin 的文件夹中。我只是想知道如何从 javascript 调用该 perl-cgi 文件，并将 $text 的内容写回到 javascript 变量中。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:08:56.203

Javascript 是一种客户端语言，而 Perl 是一种服务器端语言。这意味着您将无法直接将 Perl 变量的值读入 Javascript。

您*可以*做的是让 Perl 脚本输出其操作的结果。然后您的 Javascript 通过 AJAX 调用这个 Perl 脚本并读取结果。

这是一些伪代码来说明我的意思：

**Perl 脚本：csv_worker.cgi**

```
// retrieve csv file into $text as per OP

print "Content-type: text/csv\n\n";
print $text; 
```

**Javascript**

```
function request() {
  var xmlhttp;
  if (window.XMLHttpRequest) {
    // Supports newer browsers
    xmlhttp=new XMLHttpRequest();
  } else {
    // Supports older IE versions (IE 5/IE 6)
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState==4 && xmlhttp.status==200) {
      document.getElementById("result").innerHTML = xmlhttp.responseText;
    }
  }
  xmlhttp.open("GET","csv_worker.cgi",true);
  xmlhttp.send();
} 
```

# wpf - WPF - 如何在父鼠标悬停时更改子样式

> ID：16007923
> 
> 赞同：13
> 
> 时间：2013-04-15T04:57:40.063
> 
> 标签：wpf, xaml

我有一个`StackPanel`（1），里面有另一个`StackPanel`（2）。

SP 2 应隐藏（不透明度：0），直到 SP 1 悬停。鼠标悬停应将 SP2 的样式更改为 Opacity:100。

![在此处输入图像描述](https://i.stack.imgur.com/AppXZ.jpg)

我已经尝试在 StackPanel 资源中定义样式，并在那里使用触发器来定位内部面板，但我不确定我应该如何从触发器内部定位孩子。

这样做的简单样式结构是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-15T05:31:52.017

我不完全了解您需要什么，所以我发布了 2 个示例。

样品颜色清晰：

1) 当我们将鼠标悬停在 sp1 sp2 上时变为绿色

```
<Window x:Class="Prognoz.GP.DataCollection.TestMarkupProject.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
<Window.Resources>
    <Style x:Key="test" TargetType="StackPanel">
        <Setter Property="Background" Value="Red" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=StackPanel,AncestorLevel=1}, Path=IsMouseOver}" Value="True" >
                <Setter Property="Background" Value="Green" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<Grid>
    <StackPanel Width="400" Height="400" Background="Yellow">

        <StackPanel Width="350" Height="350" Style="{StaticResource test}"/>
    </StackPanel>
</Grid>
</Window> 
```

2) 当我们将鼠标悬停在 sp2 sp2 上时，颜色变为绿色

```
<Style x:Key="test" TargetType="StackPanel">
        <Setter Property="Background" Value="Red" />
        <Style.Triggers>
            <Trigger Property="StackPanel.IsMouseOver" Value="True" >
                <Setter Property="Background" Value="Green" />
            </Trigger>
        </Style.Triggers>
</Style> 
```

# javascript - 解析 JSON 返回值

> ID：16007928
> 
> 赞同：0
> 
> 时间：2013-04-15T04:57:57.550
> 
> 标签：javascript, json, parsing

```
{
    "status":"success",
    "data":
        {
            "title":"Testing",
            "token":"77fl",
            "questions":
                [{
                    "title":"How are you?",
                    "token":"UHGXI",
                    "kind":"multiple-choice",
                    "options":
                        [{
                            "content":"Good",
                            "token":"tLAzWd",
                            "kind":"text"
                         },
                    {
                          "content":"bad",
                          "token":"8LRR3t",
                          "kind":"text"
                     }]}]}} 
```

我以前从未解析过 JSON 数据......解析这个的第一步是什么？我显然不需要所有这些，我需要“标题”、“种类”和“内容”的所有实例。

你这样做类似于解析字符串吗？

这是我抓住它的功能......

```
$(document).ready(function(){
  $("button").click(function(){
    $.getJSON("http://quicksurvey.herokuapp.com/api/surveys/77fl/ask.json",function(result){
      });
    });
  }); 
}); 
```

我返回的数据准确存储在哪里？是“结果”吗？

我对这一切都很陌生，所以如果我犯了一些明显的错误，我深表歉意。我一直在寻找我的问题的答案，但找不到简单的介绍。我想使用javascript进行解析。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T05:01:16.373

答案是肯定的，它存储在结果中。jQuery 函数获取返回的 JSON 字符串并将其转换回表示所述字符串的本机 javascript 对象。如果您没有返回带有名称的 json 字符串，那么`result`变量将是对象本身。但是在您的情况下，您命名了该对象`data`，因此您应该像这样访问它：

```
$(document).ready(function(){
  $("button").click(function(){
    $.getJSON("http://quicksurvey.herokuapp.com/api/surveys/77fl/ask.json",function(result){
         //result.data 
         //result.status
      });
    });
  }); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:05:40.487

是的，您可以，只需将其解析为 JSON 对象即可。您可以将属性和数组作为 javascript 对象或属性进行访问。[小提琴](http://jsfiddle.net/w84kE/)

JS版

```
for(var i =0; i<result.data.questions.length; i++)
{
    alert(result.data.questions[i].title + ' ' + result.data.questions[i].kind);
} 
```

jQuery：-

```
alert(result.data.title);
$.each(result.data.questions,function(i,o){
    alert(o.title + ' ' + o.kind);
}); 
```

# c++ - C++ 代码编译，但输出错误....初始化函数错误？

> ID：16007935
> 
> 赞同：1
> 
> 时间：2013-04-15T04:58:21.233
> 
> 标签：c++

我知道缺少声明，代码编译得很好，但是输出没有正确输出......而不是一个字母，我得到的是 ¿ 。我相信问题出在初始化函数中，我似乎无法弄清楚它是什么......

```
void printResult(ofstream& outFile, letterType letterList[], int listSize)
{
    int i;
    int sum = 0;
    double Percentage = 0;

    cout << "PRINT" << endl;

    for (i = 0; i < 52; i++)
    sum += letterList[i].count;

    outFile << fixed << showpoint << setprecision(2) << endl;

    outFile << "Letter  Count   Percentage of Occurrence" << endl;

    for (i = 0; i < 52; i++)
    {
    outFile << "  " << letterList[i].letter << "     "
    << setw(5) << letterList[i].count;

    if (sum > 0)
        Percentage = static_cast<double>(letterList[i].count) /
        static_cast<double>(sum) * 100;
    /*
     Calculates the number of Occurrence by dividing by the total number of
     Letters in the document.
     */
    outFile << setw(15) << Percentage << "%" << endl;
    }

    outFile << endl;
}

void openFile(ifstream& inFile, ofstream& outFile)
{
    string inFileName;
string outFileName;

cout << "Enter the path and name of the input file (with extension): ";
getline(cin, inFileName);

    inFile.open(inFileName);
cout << endl;

    cout << "Your input file is " << inFileName << endl;
    cout << endl;

cout << "Enter the path and name of the output file (with extension): ";
getline(cin, outFileName);

outFile.open(outFileName);
cout << endl;

    cout << "The name of your output file is " << outFileName << endl;
    cout << endl;

}

void initialize(letterType letterList[])
{

    //Loop to initialize the array of structs; set count to zero
    for(int i = 0; i < 26; i++)
    {
    //This segment sets the uppercase letters
    letterList[i].letter = static_cast<char>('A' + i);
    letterList[i].count = 0;

    //This segment sets the lowercase letters
    letterList[i + 26].letter = static_cast<char>('a' + i);
    letterList[i + 26].count = 0;
    }

}

void count(ifstream& inFile, letterType letterList[], int& totalBig, int& totalSmall)
{

cout << "COUNT WORKING" << endl;
char ch;
//read first character
inFile >> ch;

//Keep reading until end of file is reached
while( !inFile.eof() )
{
    //If uppercase letter or lowercase letter is found, update data
    if('A' <= ch && ch <= 'Z')
    {
        letterList[static_cast<int>(ch) - 65].count++;
    }
    else if('a' <= ch && ch <= 'z')
    {
        letterList[static_cast<int>(ch) - 97].count++;
    }

    //read the next character

    inFile >> ch;

} //end while
} //end function 
```

================

# 驱动程序代码

```
int main()
{
    struct letterType letterList[52]; //stores the 52 char we are going to track stats on

    int totalBig = 0; //variable to store the total number of uppercase
    int totalSmall = 0; //variable to store the total number of lowercase

    ifstream inFile;
    //defines the file pointer for the text document
    ofstream outFile;
    //the file pointer for the output file
    cout << "MAIN WORKING" << endl;

    openFile(inFile, outFile);
    //allow the user to specify a file for reading and outputting the stats

    /*if (!inFile || !outFile)
    {
        cout << "***ERROR*** /n No such file found" << endl;
        return 1;
    }
    else
        return 1;
    *///Check if the files are valid

    initialize(&letterList[52]);
    //initalizes the letter A-Z, and a-z */

    count(inFile, &letterList[52], totalBig, totalSmall);
    // counts the letters

    printResult(outFile, letterList, 52);
    //writes out the stats

    //Close files
    inFile.close();
    outFile.close();

    return 0;
} 
```

======================

# 整个计数功能

```
void count(ifstream& inFile, letterType letterList[], int& totalBig, int& totalSmall)
{

cout << "COUNT WORKING" << endl;
char ch;
//read first character
inFile >> ch;

//Keep reading until end of file is reached
while( !inFile.eof() )
{
    //If uppercase letter or lowercase letter is found, update data
    if('A' >= ch && ch <= 'Z')
    {
        letterList[ch - 'A'].count++;
    }
    else if('a' >= ch && ch <= 'z')
    {
        letterList[(ch - 'a') + 26].count++;
    }

    //read the next character

    inFile >> ch;

} //end while
} //end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:26:05.810

计数逻辑写得很混乱，这掩盖了一个错误（它折叠了案例）：

```
if('A' <= ch && ch <= 'Z')
{
    letterList[static_cast<int>(ch) - 65].count++;
}
else if('a' <= ch && ch <= 'z')
{
    letterList[static_cast<int>(ch) - 97].count++;  // <--- a bug here
} 
```

这会`'a'`通过增加第一个元素的计数来做出反应，这看起来像是打算作为`'A'`. 这很容易通过偏移小写来解决，也可以重写它，以便更清楚正在做什么：

```
if ('A' <= ch  &&  ch <= 'Z')
{
    letterList[static_cast<int>(ch - 'A')].count++;  // count uppercase
}
else if ('a' <= ch  &&  ch <= 'z')
{
    letterList[static_cast<int>(ch - 'a') + 26].count++;  // count lowercase
} 
```

~~至于主要的错误，`initialize()`没有在任何地方调用。~~

初始化被错误地调用，因为`initialize(&letterList[52]);` 这试图初始化条目 52、53、... 103。我很惊讶它没有段错误。

它应该被称为

```
initialize(letterList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T06:39:30.267

你的功能做得恰到好处。

在您的驱动程序代码中，您使用错误的参数调用这些函数

检查这些行，它们应该是这样的

```
initialize(&letterList[0]);
//initalizes the letter A-Z, and a-z */

count(inFile, &letterList[0], totalBig, totalSmall); 
```

在将`letterList`数组传递给函数时，您应该将指针传递给数组中的第一个元素。你应该通过`&letterList[0]`或干脆`letterList`

# spring - Spring 'application-context' XSD 模式读取问题

> ID：16007940
> 
> 赞同：0
> 
> 时间：2013-04-15T04:58:45.373
> 
> 标签：spring, xsd, jax-ws

我在我的 spring 项目中使用 JAXWS 与服务器通信，并且在我的应用程序上下文 xml 中读取 XSD 时出错。这是应用程序上下文 -

```
 <?xml version="1.0" encoding="UTF-8"?>
 <beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:ws="http://jax-ws.java.net/spring/core"
    xmlns:wss="http://jax-ws.java.net/spring/servlet"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

  //**error at this below line -**  **cvc-complex-type.2.4.c: The matching wildcard is   strict, but no declaration can be found for element 'wss:binding'.**
  <wss:binding url="/hello">
    <wss:service>
        <ws:service bean="#helloWs"/>
    </wss:service>
   </wss:binding>

  <!-- Web service methods -->
  <bean id="helloWs" class="com.mkyong.ws.HelloWorldWS">
    <property name="helloWorldBo" ref="HelloWorldBo" />
  </bean>

  <bean id="HelloWorldBo" class="com.mkyong.bo.impl.HelloWorldBoImpl" /> 
```

任何人都可以让我知道这个错误的原因和任何解决方案。谢谢你的帮助。！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T05:24:33.530

你为什么不试试下面的xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ws="http://jax-ws.dev.java.net/spring/core"
xmlns:wss="http://jax-ws.dev.java.net/spring/servlet"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
http://jax-ws.dev.java.net/spring/core http://jax-ws.java.net/spring/core.xsd
http://jax-ws.dev.java.net/spring/servlet http://jax-ws.java.net/spring/servlet.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<wss:binding url="/hello">
<wss:service>
    <ws:service bean="#helloWs"/>
</wss:service>
</wss:binding>

<!-- Web service methods -->
<bean id="helloWs" class="com.mkyong.ws.HelloWorldWS">
<property name="helloWorldBo" ref="HelloWorldBo" />
</bean>
<bean id="HelloWorldBo" class="com.mkyong.bo.impl.HelloWorldBoImpl" /> </beans> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-08T14:09:36.283

你在你的项目中使用 spring 吗？，我有同样的问题，但是当我在我的 maven 依赖项中包含 spring-jaxws 时，问题解决了，事实上，你可以在那个 jar 中看到 META-INF/spring.schemas 文件是重新定义 XSD 位置：

http\://jax-ws.java.net/spring/core.xsd=spring-jax-ws-core.xsd http\://jax-ws.java.net/spring/servlet.xsd=spring-jax -ws-servlet.xsd http\://jax-ws.java.net/spring/local-transport.xsd=spring-jax-ws-local-transport.xsd

我希望它有帮助！

# javascript - 使用 HTML5 websocket 检测本地设备

> ID：16007941
> 
> 赞同：2
> 
> 时间：2013-04-15T04:58:49.250
> 
> 标签：javascript, ios, html, websocket

我正在开发一个使用 HTML5 WebSockets 连接 iOS 应用程序的项目。我需要在网页内显示附近（在同一本地 WiFi 网络内）iPhone/iPad 的列表。

1.  是否可以使用任何像 Bonjour 这样的发现机制来实现这一点？
2.  有什么方法可以从网站（使用 Javascript 或服务器端脚本）检测本地 IP 地址，以便我可以扫描本地 IP 范围？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:09:21.003

如果您只想匹配同一网络上的设备，则只需检查公共 IP，因为连接到同一路由器的每个人都可能共享一个。也就是说，虽然原生 iOS 应用程序应该能够检测到本地 IP 地址，但我不知道使用 Javascript 有什么方法可以做到这一点。

一个例外是，如果您在本地网络中运行服务器（或在他们的机器上运行自定义二进制文件）。从您的描述中听起来这不是您的选择，但如果是这样，用户局域网中的服务器将看到他们的本地 IP*而*不是他们的公共 IP。如果需要，它可以将其中继到公共服务器。

不过，我很想被证明是错误的，因为如果可能的话，我可以想出一些非常酷的事情来做。

# php - PHP验证数据错误

> ID：16007942
> 
> 赞同：1
> 
> 时间：2013-04-15T04:59:01.180
> 
> 标签：php, mysql

我的 PHP 验证数据有问题。到目前为止，这是我的代码

```
$cek_saldo=mysql_query
("SELECT * FROM t_balance");

        while ($data_cek = mysql_fetch_array($cek_saldo));
        {
            $b_id = $data_cek['badge_id'];
            $mon = $data_cek['month'];
            $bal = $data_cek['balance_type'];
        }

        if ($b_id == '$badge_id' AND $mon == '$date_month' AND $b_type == '$jns_saldo')
        {
            echo "<div class='emp_err warn'>Balance for this month has been added before.</div>";
        }

        else
        {
            if($_POST)
            {
                $query = "INSERT INTO t_balance(badge_id, balance_amount, month, balance_type, date_transaction)
                        VALUES ('$badge_id', '$saldo', '$bulan', '$jns_saldo', '$date_transaction')
                ";
                $hasil = mysql_query($query);

                if($hasil)
                {

                    echo "<div class='emp_err success'>Balance transaction successfully added.</div>";
                }
                else
                {

                    echo "<div class='emp'>Gagal menambahkan saldo.</div>";
                }
            }
        } 
```

规则是：
Tabungan Wajib 可以每月提交 1 次。所以如果两次，就会报错：“本月余额之前已添加”。

Tabungan Tambahan 每月可以提交超过 1 次。所以如果提交超过1次，它将被保存。

有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:26:58.977

你不需要引用。我想`$badge_id` `$date_month` `$jns_saldo`来自你的表格，带有 $_POST

```
if ($b_id == $badge_id AND $mon == $date_month AND $b_type == $jns_saldo) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T05:48:15.777

用这个。

```
$cek_saldo= mysql_query("SELECT * FROM t_balance");

    while ($data_cek = mysql_fetch_array($cek_saldo));
    {
        $b_id = $data_cek['badge_id'];
        $mon = $data_cek['month'];
        $bal = $data_cek['balance_type'];

        if ($b_id == "$badge_id" && $mon == "$date_month" && $b_type == "$jns_saldo")
        {
            echo "<div class='emp_err warn'>Balance for this month has been added before.</div>";
        }
        else
        {
            if($_POST)
            {
                $query = "INSERT INTO t_balance(badge_id, balance_amount, month, balance_type, date_transaction)
                        VALUES ('".$badge_id."', '".$saldo."', '".$bulan."', '".$jns_saldo."', '".$date_transaction."')";
                $hasil = mysql_query($query);

                if($hasil)
                {

                    echo "<div class='emp_err success'>Balance transaction successfully added.</div>";
                }
                else
                {

                    echo "<div class='emp'>Gagal menambahkan saldo.</div>";
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:02:14.517

```
if ($b_id == "$badge_id" AND $mon == "$date_month" AND $b_type == "$jns_saldo")
        {
            echo "<div class='emp_err warn'>Balance for this month has been added before.</div>";
        } 
```

由于使用变量的比较中的单引号导致您的代码失败尝试了解 php 中单引号和双引号字符串之间的区别

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T05:08:24.643

此验证将不起作用，因为您从数据库中选择多行并仅将 e 上的最后一个分配给 `$b_id`..`$mon`等

你正在使用`single quotes`比较

**解析度**

1.  如果可以的话，根据一些 id 选择数据

    ```
    $cek_saldo=mysql_query("SELECT * FROM t_balance where id = 'someid'");

    while ($data_cek = mysql_fetch_array($cek_saldo));
    {
        $b_id = $data_cek['badge_id'];
        $mon = $data_cek['month'];
        $bal = $data_cek['balance_type'];
    } 
    ```

2.  设置错误标志

    ```
    $error = false;

    while ($data_cek = mysql_fetch_array($cek_saldo));
    {
        $b_id = $data_cek['badge_id'];
        $mon = $data_cek['month'];
        $bal = $data_cek['balance_type'];
        if($b_id == $badge_id AND $mon == $date_month AND $b_type == $jns_saldo)
       {
          $error = true;
          break
       }
    }
     if($error)
     {
        echo "<div class='emp_err warn'>Balance for this month has been added before.</div>";

     } 
    ```

希望能帮助到你

# ruby - 检查字符串是否等于'*'

> ID：16007944
> 
> 赞同：0
> 
> 时间：2013-04-15T04:59:17.857
> 
> 标签：ruby, calculator

我正在尝试制作一个基于控制台的计算器来练习一些 Ruby，我正在使用“case”语句来检查控制台参数，然后使用 Ruby 的算术来解释并返回结果。

我遇到的问题是我无法让 Ruby 执行与乘法关联的行。它只是转到“else”块并执行我的帮助方法。除了指数之外，我还有所有其他方法我认为 Ruby 将 STAR 字符视为“一切”（我不知道该怎么说）

```
case @args[1]
when '+'
  puts "#{@args[0].to_i + @args[2].to_i}"
when '-'
  puts "#{@args[0].to_i - @args[2].to_i}"
when '*'
  puts "#{@args[0].to_i * @args[2].to_i}"
when '/'
  puts "#{@args[0].to_i / @args[2].to_i}"
when '%'
  puts "#{@args[0].to_i % @args[2].to_i}"
when '**'
  puts "#{@args[0].to_i**@args[2].to_i}"
else
  help
end 
```

我知道它看起来很狡猾，我打算在一切正常后修复它。

我对 Ruby 还很陌生，所以我不能 100% 确定我需要做什么才能让 Ruby 将它们视为简单的星星而不是正则表达式......

我向你保证这不是家庭作业，我只是想学习一些 Ruby，因为我最近也开始学习 Rails。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T05:02:07.520

您是否尝试通过写“\*”来转义星号？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T05:05:48.210

还有其他事情发生。此 irb 会话确认 case 语句中的字符串按您期望的方式工作：

```
str = '*'
=> "*"
>> case str
>> when '*' then "foo"
>> end
=> "foo" 
```

仔细检查`@args[1]`实际上是您认为的那样。

# c++ - 这个 c++ gcc 特定运算符是什么？

> ID：16007955
> 
> 赞同：0
> 
> 时间：2013-04-15T05:01:11.953
> 
> 标签：c++, linux, gcc, operators

我有一个开源项目的代码，想知道这个运算符是什么意思。这个运算符是什么 |= ？在以下代码中使用：

```
uint32_t a = VALUE1 | VALUE2; 
a |= VALUE1; 
```

任何想法 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:06:29.333

`|=`不是 GCC 特定的运算符 - 它是标准的 C++ 复合赋值运算符。`a |= b`大致等价于`a = a | b`，其中`|`是位或运算符；除了`|=`具有`=`（非常低优先级）的优先级。

# ms-access - 如何使 Dlookup 文本框可写

> ID：16007956
> 
> 赞同：0
> 
> 时间：2013-04-15T05:01:14.987
> 
> 标签：ms-access, vba

我正在处理表单并为数据输入和搜索（数据提取）制作了一个表单，但问题是我在某些文本框上使用了 Dlookup 公式以便于数据输入但是当我尝试搜索访问时没有显示数据文本框并显示该对象是只读的错误。如何获取文本框显示数据以及 Dlookup 公式？请帮忙。多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:20:08.107

You can set the textbox value by code instead of putting the `DLookup` into the data source of the textbox.

Putting it into the data source means that you can't edit the textbox at runtime, as you experienced.
But you can set the value once in the `Form_Open` event, for example:

```
Private Sub Form_Open(Cancel As Integer)

    Me.TheTextBox = DLookup(...)

End Sub 
```

This will cause the textbox to be filled automatically when the form opens, but the textbox is editable and you can overwrite the value.

# python - Etree 可以处理这些类型的 XPath 查询吗

> ID：16007970
> 
> 赞同：0
> 
> 时间：2013-04-15T05:02:25.123
> 
> 标签：python, xml-parsing, elementtree

Pythons XML Parsing 库[Etree](http://docs.python.org/2/library/xml.etree.elementtree.html)可以接受如下复杂的 XPath 查询吗？

```
# Note the "[text()=\"USER_4D\"]"
assert root.find("Group/EnvConfig/Overrides/Override/Key[text()=\"USER_4D\"]") != None 
```

我`SyntaxError: invalid predicate`在上面的行中收到错误。如果我删除“谓词”，`[text()=\"USER_4D\"]`则不会引发预期/错误。

是什么导致了这个错误？我的 XPath 格式是否错误，或者 Etree 不能执行这些类型的 XPath 查询？你能就如何解决这个问题提供建议吗？

我希望我不需要使用自定义 XML Parsing 库，因为我只是想在内置的 XML Parsing 库中使用 Python 进行一些简单的单元测试。是否有其他本机 Python 库可以处理此 XPath 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T05:19:38.050

ElementTree 不支持问题中使用的那种 XPath 表达式。请参阅[http://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support](http://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support)。

`Key`要使用文本内容断言元素的存在`USER_4D`，您可以使用如下内容：

```
Key = root.find("Group/EnvConfig/Overrides/Override/Key")
assert Key != None             # Element exists
assert Key.text == "USER_4D"   # Element has specific content 
```

# java - 在 tomcat 上运行 Maven Struts2 应用程序

> ID：16007973
> 
> 赞同：2
> 
> 时间：2013-04-15T05:02:28.347
> 
> 标签：java, eclipse, tomcat, struts2, m2eclipse

我使用 Eclipse M2 Maven 插件创建了一个 Struts2 应用程序，但没有选项可以在我的 tomcat 服务器上运行该项目。我尝试在项目构建路径中包含服务器运行时库，但这不起作用。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T08:25:39.610

为了在 Eclipse 中在服务器上运行项目，项目必须是`Dynamic Web Module`启用的多面形式。要将项目转换为多面形式：右键单击项目 -> `Properties`-> `Project Facets`-> `Convert to faceted form...`-> 勾选`Java`和`Dynamic Web Module`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:07:41.710

当您构建项目时，它应该创建一个输出、一个war 文件或提取的war 文件。您需要在服务器上部署它，然后只有您可以看到应用程序。在eclipse中我相信你可以配置一个服务器。一旦你在 eclipse 中配置了一个服务器，你可以告诉它寻找你的项目构建输出并部署它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:11:52.763

右键单击项目，然后`Run As > Run on Server`.

如果您没有看到该选项，则表示您的项目未配置为 Web 应用程序。

# java - 在java中编程时，我得到这个错误，有没有人能告诉我到底是什么问题？

> ID：16007974
> 
> 赞同：0
> 
> 时间：2013-04-15T05:02:31.663
> 
> 标签：java, arraylist, nullpointerexception

我正在处理从文件中读取的任务，并检测哪个字母使用最多，哪个字母使用最少。这是我得到的输出。

```
Would you like to input a directory for a .dat file? Input Yes or No
Yes
Please input file location
G:\test.dat
Exception in thread "main" java.lang.NullPointerException
at Histogram.loadAndAnalyzeFile(Histogram.java:62)
at lab21c.main(newlab21c.java:15)

Process completed. 
```

这是我的直方图文件

```
//© A+ Computer Science  -  www.apluscompsci.com
//Name -
//Date -
//Lab  - 

import java.io.File;
import java.io.IOException;
import java.util.Scanner;
import java.util.ArrayList;
import java.util.Collections;
import static java.lang.System.*;

public class Histogram
{
    private ArrayList<Integer> count;
    int counter = 0;
    private String[] Letters =     {"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"};
    private String fileName;
    ArrayList<String> storageStr;
    String Yes = "Yes";
        String Decision = "";
    String Location = "";
    String add = "";
    Scanner Keyboard = new Scanner(System.in);

    public Histogram()
    {

    }

    public Histogram(char[] values, String fName)
    {

    }

     public void loadAndAnalyzeFile() throws IOException
     {
        System.out.println("Would you like to input a directory for a .dat     file? Input Yes or No");
        Decision = Keyboard.next();

        if (Decision.equals(Yes))
        {
            System.out.println("Please input file location");
            String location = Keyboard.next();
            Scanner file = new Scanner(new File(location));

            while (file.hasNext())
            {
                add = file.next();
                storageStr.add(add);
            }

        }
        String[]Holder = new String[storageStr.size()-1];

        for (int run = 0; run < storageStr.size(); run++)
        {
            Holder[run].equals(storageStr.get(run));

            for (int run1 = 0; run1 < Letters.length; run1++)
            {
               char Charletters = Letters[run1].charAt(0);

               for (int run2 = 0; run2 < Holder.length; run2++)
               {
                    if (Holder[run].charAt(run2) == Charletters)
                    {
                        counter++;
                    }
                }
                System.out.println(counter);
            }
        }

    }

    public char mostFrequent()
    {

        return '#';
    }

    public char leastFrequent()
    {

            return '#';
    }

    public String toString()
    {
       return fileName
       + "\n" + count + "\n\n\n";
    }
} 
```

我目前正在做的是尝试转换从文件中读取的字符串，并将其转换为字符以与字母进行比较。我正在显示计数器，所以我可以查看它是否正常工作，但我得到了那个错误。这是我的 newlab12c 文件。

```
import java.io.File;
import java.io.IOException;
import java.util.Scanner;
import java.util.ArrayList;
import java.util.Collections;
import static java.lang.System.*;
import java.io.FileNotFoundException;

class lab21c
{
    public static void main(String[] args)throws java.io.IOException
    {
        Histogram histogram = new Histogram();

        histogram.loadAndAnalyzeFile();
    }
} 
```

如果有人可以提供一些帮助，那将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T05:07:27.373

根据我的 IDE，`Line 62`包含对您的`storageStr`数据结构的操作。我注意到的是，您从不初始化任何数据结构，这意味着对它们的任何操作都会产生一个`NullPointerException`.

例如，将您的构造函数更改为：

```
public Histogram()
{
    storageStr = new ArrayList<String>();
    count = new ArrayList<Integer>();
} 
```

应该有助于解决问题。

# c# - 用于获取 API 特定数据的 C# XmlDocument？

> ID：16007979
> 
> 赞同：0
> 
> 时间：2013-04-15T05:03:09.223
> 
> 标签：c#, api, xpath, xmldocument, xmlnode

我试图在以下位置获取属性的特定值：

[http://data.alexa.com/data?cli=10&dat=snbamz&url=bing.com](http://data.alexa.com/data?cli=10&dat=snbamz&url=bing.com)

```
<SD>
<POPULARITY URL="bing.com/" TEXT="16" SOURCE="panel"/>
<REACH RANK="16"/>
<RANK DELTA="-7"/>
<COUNTRY CODE="US" NAME="United States" RANK="9"/>
</SD>
</ALEXA> 
```

我想抓住价值

我有当前的控制台代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string url = "http://data.alexa.com/data?cli=10&dat=snbamz&url=bing.com";
            XmlDocument xmldoc = new XmlDocument();
            xmldoc.Load(url);
            XmlNode root = xmldoc.SelectSingleNode("//@RANK");

            //XmlNamespaceManager xnm1 = new XmlNamespaceManager(xmldoc.NameTable);
            //XmlNodeList nList1 = xmldoc.SelectNodes("//@RANK", xnm1);

            Console.WriteLine(root.ToString());
            Console.ReadLine();

        }
    }
} 
```

但是当我运行它时，我收到以下消息作为回报：

```
System.Xml.XmlAttribute 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T05:24:57.620

尝试改变：

```
Console.WriteLine(root.ToString()); 
```

至：

```
Console.WriteLine(root.Value); 
```

希望有帮助。

# php - 查找多对多关系推进的查询

> ID：16007982
> 
> 赞同：1
> 
> 时间：2013-04-15T05:03:21.040
> 
> 标签：php, orm, schema, relationship, propel

我是新来的推进器。我面临一个问题，要从具有多对多关系的两个表中获取所有记录。

我有一个用户和组表。和一个连接表 user_group。

用户和组具有多对多关系

i 并使用 follow 方法在单个查询中查找所有相关数据。

schema.xml 文件

```
<table name="user" phpName="User" idMethod="native">
    <column name="id" type="INTEGER" primaryKey="true" autoIncrement="true" required="true" />
    <column name="name" type="VARCHAR" size="100" required="true" />
    <column name="email" type="VARCHAR" size="100" required="true" />
    <column name="age" type="INTEGER" required="true" />
    <column name="gender" type="VARCHAR" size="50" required="true" />
    <column name="company" type="VARCHAR" size="100" required="true" />
    <column name="address" type="VARCHAR" size="100" required="true" />
    <column name="country" type="VARCHAR" size="100" required="true" />
    <column name="mobileno" type="DOUBLE" required="true" />
    <column name="comment_about" type="VARCHAR" size="200" required="true" />
    <foreign-key foreignTable="post" name="post" phpName="postWriter">
        <reference local="id" foreign="user_id" />
    </foreign-key>
</table>

<table name="group">
    <column name="id" type="INTEGER" primaryKey="true" autoIncrement="true" />
    <column name="name" type="VARCHAR" size="32" />
</table>

<table name="user_group" isCrossRef="true">
    <column name="user_id" type="INTEGER" primaryKey="true" />
    <column name="group_id" type="INTEGER" primaryKey="true" />
    <foreign-key foreignTable="user">
        <reference local="user_id" foreign="id" />
    </foreign-key>
    <foreign-key foreignTable="group">
        <reference local="group_id" foreign="id" />
    </foreign-key>
</table> 
```

我试着找到这样的相关数据

```
$userObj = UserQuery::create()
       ->join('Group')
       ->find(); 
```

但上面的查询给了我一个致命的错误

```
Fatal error: Uncaught exception 'PropelException' with message 'Unable to execute SELECT statement [SELECT user.id, user.name, user.email, user.age, user.gender, user.company, user.address, user.country, user.mobileno, user.comment_about FROM `user` INNER JOIN `` ON () 
```

请帮助我，我们可以解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T14:58:54.047

您不能直接加入多对多关系，因为 MySQL 中没有这样的东西。你可以做两件事之一...

如果您已经有一个`User`对象，那么您可以通过这种方式简单地“获取”相关组：

```
$relatedGroups = $userObject->getGroups(); 
```

如果您还没有`User`对象，并且想要填充所有记录（用户和组），那么我认为您可以这样做：

```
$users = UserQuery::create()
           ->join('User.UserGroup')
           ->join('UserGroup.Group')
           ->with('Group')  // this line hydrates Group objects as well as Users
           ->find(); 
```

现在在您的代码中，您可以遍历`User`s 并获取每个`Group`s 而无需额外的数据库命中：

```
foreach ($users as $user) {
  $user->getGroups();
  // normally this would be an extra DB hit, but because we used "->with('Group')"
  // above in the query, the objects are already hydrated.
} 
```

希望这可以帮助。Propel 网站上有[关于使用“with()”最小化查询](http://propelorm.org/reference/model-criteria.html#minimizing-queries)的信息以及[关于多对多关系的信息](http://propelorm.org/documentation/04-relationships.html#many-to-many-relationships)（带有查询示例）。

# php - Symfony2 + Doctrine：生成实体之间关系的工具

> ID：16007985
> 
> 赞同：2
> 
> 时间：2013-04-15T05:03:26.367
> 
> 标签：php, symfony, orm, doctrine-orm

当我想创建一个新实体时，我使用以下命令：

> php 应用程序/控制台原则：生成实体

但这只会帮助我用它们的 setter 和 getter 生成属性

有没有一种方法可以帮助我生成实体之间的关系（例如 OneToMany 和 ManyToOne）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T13:42:21.340

你可以试试 ORM Designer。它并不便宜，但很有帮助：

[http://www.orm-designer.com](http://www.orm-designer.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-13T22:06:28.603

5年后我正在回答我自己的问题。我这样做是因为我刚刚使用了 symfony4 的工具来生成实体，而且它非常棒。社区制作了如此出色的工具。

在 symfony4 中，您只需要执行命令，`bin/console make:entity`然后按说选择您的字段名称`user`，然后选择类型`relation`，向导将处理该过程并为您生成所有需要的代码！

一个让我惊讶的例子：

```
New property name (press <return> to stop adding fields):
 > user

Field type (enter ? to see all types) [string]:
 > relation

 What class should this entity be related to?:
 > User

What type of relationship is this?
 ------------ ---------------------------------------------------------------- 
  Type         Description                                                     
 ------------ ---------------------------------------------------------------- 
  ManyToOne    Each Statement relates to (has) one User.                       
               Each User can relate/has to (have) many Statement objects       

  OneToMany    Each Statement relates can relate to (have) many User objects.  
               Each User relates to (has) one Statement                        

  ManyToMany   Each Statement relates can relate to (have) many User objects.  
               Each User can also relate to (have) many Statement objects      

  OneToOne     Each Statement relates to (has) exactly one User.               
               Each User also relates to (has) exactly one Statement.          
 ------------ ---------------------------------------------------------------- 

 Relation type? [ManyToOne, OneToMany, ManyToMany, OneToOne]:
 > ManyToOne

 Is the Statement.user property allowed to be null (nullable)? (yes/no) [yes]:
 > yes

 Do you want to add a new property to User so that you can access/update Statement objects from it - e.g. $user->getStatements()? (yes/no) [yes]:
 > yes

 A new property will also be added to the User class so that you can access the related Statement objects from it.

 New field name inside User [statements]:
 > 

 updated: src/Entity/Statement.php
 updated: src/Entity/User.php

 Add another property? Enter the property name (or press <return> to stop adding fields):
 > 

  Success! 

 Next: When you're ready, create a migration with make:migration 
```

# c# - 获取ftp服务器上传文件的上传时间

> ID：16007986
> 
> 赞同：1
> 
> 时间：2013-04-15T05:03:42.493
> 
> 标签：c#, ftp

谁能告诉我从哪里可以得到上传文件在 FTP 服务器上的时间？

```
class listFiles
{
    public static void Main(string[] args)
    {
        listFiles l = new listFiles();
        l.getFileList(ftpConnection,"test123","pass123"); //ftp url
    }
    private void getFileList(string FTPAddress, string username, string password)
    {
        List<string> files = new List<string>();

        try
        {
            //Create FTP request
            FtpWebRequest request = (FtpWebRequest)FtpWebRequest.Create(FTPAddress);

            request.Method = WebRequestMethods.Ftp.ListDirectory;
            request.Credentials = new NetworkCredential(username, password);
            request.UsePassive = true;
            request.UseBinary = true;
            request.KeepAlive = true;

            FtpWebResponse response = (FtpWebResponse)request.GetResponse();
            Stream responseStream = response.GetResponseStream();
            StreamReader reader = new StreamReader(responseStream);

            while (!reader.EndOfStream)
            {
                //Application.DoEvents();
               // string fileType = reader.ReadLine();
                files.Add(reader.ReadLine());
            }

            //Clean-up
            reader.Close();
            responseStream.Close(); //redundant
            response.Close();
        }
        catch (Exception)
        {
            Console.WriteLine("There was an error connecting to the FTP Server");
        }

        //If the list was successfully received, display it to the user
        //through a dialog
        if (files.Count != 0)
        {
            foreach (string file in files)
            {
                Console.WriteLine(file);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:35:33.843

尝试使用[`FtpWebResponse.LastModified`属性](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.lastmodified.aspx)

```
using (FtpWebResponse resp = (FtpWebResponse)request.GetResponse())
{
     var lastModified =   resp.LastModified ;
} 
```

您需要获取每个文件的响应，在您当前的代码中，您已经有一个文件列表，通过使用该文件名构建您需要找到创建日期的 ftp 文件的完整路径。之后创建对该完整 ftp 文件路径的 ftp 请求。然后您可以读取响应对象的最后修改日期。

# python - 如何获得多处理来改变我的原始对象的状态？

> ID：16007989
> 
> 赞同：0
> 
> 时间：2013-04-15T05:04:18.173
> 
> 标签：python, multiprocessing

我想我理解这个问题，当一个`multiprocessing.Pool.map`工人抓住它的下一个任务时，根据文档，参数作为一个挑选的对象传递。如果返回值是您要查找的值，这很好，但是如果我想调用一个*并行*更改对象状态的函数怎么办？例如，考虑一个简单的对象：

```
from multiprocessing import Pool

class state():
    def __init__(self):
        self.z = 0
    def __repr__(self): 
        return "%s"%self.z
    def compute(self):
        print "Computing"
        self.z += 1 
```

以及对这个对象的一些操作：

```
def compute_function(x): x.compute()

A = [state() for _ in xrange(3)]
print A
A[2].compute()
print A
map(compute_function, A)
print A
P = Pool()
P.map(compute_function, A)
print A 
```

输出是：

```
[0, 0, 0]
Computing
[0, 0, 1]
Computing
Computing
Computing
[1, 1, 2]
Computing
Computing
Computing
[1, 1, 2] 
```

但我希望能读到最后一行`[2, 2, 3]`。显然，`compute`被调用了，但是生成的对象被扔掉了。我如何“保持状态”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T07:57:40.487

你不能。酸洗不允许您将状态更改发送回酸洗对象。您可以做的最简单的事情是：

```
def compute_function(x):
    x.compute()
    return x

A = [state() for _ in xrange(3)]
A = P.map(compute_function, A) 
```

作为替代方案，您可以使用[`multiprocessing.Manager`](http://docs.python.org/2/library/multiprocessing.html#multiprocessing-managers)which 创建对象并将其放在单独的进程中并为其他进程提供代理。但是请注意，这意味着通过代理对对象进行的**任何**操作都将在进程之间进行*缓慢*的通信。

# c# - 如何在文本区域设置空值

> ID：16007990
> 
> 赞同：2
> 
> 时间：2013-04-15T05:04:28.730
> 
> 标签：c#, javascript, asp.net

我想在 textarea 的 onclick() 事件中设置空值，但是我的代码不能正常工作..

```
<textarea id="txtwishlistsong1" rows="5" cols="70" runat="server" onclick="return txtwishlistsong1_onclick()">Type Your Message Here...</textarea> 
```

后面的代码

```
function txtwishlistsong1_onclick()
{
   document.getElementById('txtwishlistsong1').focus();
   document.getElementById('txtwishlistsong1').value=null;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T05:07:41.130

您已将控件定义为`runat="server"`在 JavaScript 中访问它们，您需要指定 ClientID。

```
function txtwishlistsong1_onclick()
{
   document.getElementById('<%= txtwishlistsong1.ClientID %>').focus();
   document.getElementById('<%= txtwishlistsong1.ClientID %>').value='';
} 
```

或者，如果您使用的是 .Net 框架 4.0 或更高版本，那么您可以`ClientIDMode = "Static"`为控件指定查看更多关于[ClientIDMode的信息](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T05:06:16.943

设置空值：（`""`不是`null`）。

根据这个[来源](https://developer.mozilla.org/en-US/docs/DOM/HTMLInputElement)，价值是`DOMString`，而且必须总是有当前价值的`input`。由于`input`不能真正具有`null`价值（在这种情况下它相当抽象），因此空值是更好的选择（并且在浏览器中始终如一地工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T05:06:15.567

可能的原因是 asp.net ID 损坏。

尝试使用：

```
document.getElementById('<%=txtwishlistsong1.ClientID%>').focus();
document.getElementById('<%=txtwishlistsong1.ClientID%>').value=null; 
```

# javascript - 将对象数组重新排序为嵌套对象

> ID：16007991
> 
> 赞同：-2
> 
> 时间：2013-04-15T05:04:37.827
> 
> 标签：javascript, arrays, object

如何重新排序对象数组

```
[ {"2007": rank, "2008": rank, "Class": "label 1"}, 
  {"2007": rank, "2008": rank, "Class": "label 2"}, ... ] 
```

到嵌套对象中，例如：

```
 {"2007": 
      {"label 1": rank, "label 2": rank}, 
 "2008": 
      {"label 1": rank, "label 2": rank}, ...} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:59:39.187

看来您的要求是通过以下方式转置表和索引`Class`：

*   调用输入“表”
*   调用数组的每个元素“行”
*   `year`对于至少一行中的每一个键，除了键`Class`
    *   在 中创建`year`一个键`output`，映射到对象：
        *   每个键`output[year]`是某行中的值`class`，`Class`映射到该值：
            *   `output[year][class]`=`input.find("Class",class)[year]`

这是一种可能的实现：

```
 var input = [ {"2007": rank, "2008": rank, "Class": "label 1"}, 
               {"2007": rank, "2008": rank, "Class": "label 2"} ]
 //////////
 var yr, i;
 var output = {};
 for(i=0; i<input.length; i++){
   var row = input[i];
   for(yr in row){
     output[yr] = output[yr] || {};
     output[yr][row.Class] = row[yr];
   }
 }
 //////////////
 return output; 
```

测试：http: [//jsfiddle.net/aT5YG/1](http://jsfiddle.net/aT5YG/1)

如果多行具有相同`Class`的 ，则后面的行会覆盖前面的行。如果输入是锯齿状的，则输出将是锯齿状的。

# python - BeautifulSoup 和 urllib 不解析谷歌图像页面

> ID：16007995
> 
> 赞同：1
> 
> 时间：2013-04-15T05:05:21.567
> 
> 标签：python, beautifulsoup, urllib

我正在尝试使用 BeautifulSoup 从谷歌图像中查找随机图像。我的代码看起来像这样。

```
import urllib, bs4, random
from urllib import request
urlname = "https://www.google.com/search?hl=en&q=" + str(random.        randrange(999999))  + "&ion=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.  42553238,d.dmg&biw=1354&bih=622&um=1&ie=UTF-                            8&tbm=isch&source=og&sa=N&tab=wi&ei=sNEfUf-fHvLx0wG7uoG4DQ"

page = bs4.BeautifulSoup(urllib.request.urlopen(urlname) 
```

但是每当我尝试从页面对象中获取 HTML 时，我都会得到：

```
urllib.error.HTTPError: HTTP Error 403: Forbidden 
```

我测试通过将它们粘贴到我的网络浏览器中生成的 URL，并且浏览器不会返回此错误。这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T05:21:01.643

我很确定谷歌会告诉你：“请不要这样做”。请参阅[http 403 错误](http://www.checkupdown.com/status/E403.html)的说明。

发生的事情是您的 python 脚本，或者更具体地说是 urllib 正在发送标头，告诉谷歌这是某种普通的请求，它不是来自浏览器。

谷歌这样做是正确的，否则很多人会简单地抓取他们的网站并将谷歌结果显示为他们自己的。

**到目前为止，我可以看到**两种解决方案。****

 **1) 使用谷歌[自定义搜索 API](https://developers.google.com/custom-search/v1/overview)。它支持图像搜索，并且每天有 100 个查询的免费配额 - 对于更多查询，您必须付费。

2) 像[mechanize](http://wwwsearch.sourceforge.net/mechanize/)这样的工具会误导网站，告诉他们它们是浏览器，而不是实际上抓取机器人，例如通过发送操纵的标题。这里的常见问题是，如果您的爬虫过于贪婪（短时间内请求太多），谷歌将永久阻止您的 IP 地址...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-24T06:11:54.057

那是因为没有[`user-agent`](https://github.com/psf/requests/blob/589c4547338b592b1fb77c65663d8aa6fbb7e38b/requests/utils.py#L808-L814)指定。默认`requests` `user-agent`值为[python-requests](https://github.com/psf/requests/blob/589c4547338b592b1fb77c65663d8aa6fbb7e38b/requests/utils.py#L808-L814)，因此 Google 会阻止请求，因为它知道这是一个机器人而不是“真正的”用户访问并`user-agent`伪造它。

* * *

要抓取 Google 图片、缩略图和完整分辨率 URL，您需要从`<script>`标签内的页面源中解析日期：

```
# find all <script> tags:
soup.select('script') 
```

```
# match images data via regex:
matched_images_data = ''.join(re.findall(r"AF_initDataCallback\(([^<]+)\);", str(all_script_tags))) 
```

```
# match desired images (full res size) via regex:

# https://kodlogs.com/34776/json-decoder-jsondecodeerror-expecting-property-name-enclosed-in-double-quotes
# if you try to json.loads() without json.dumps() it will throw an error:
# "Expecting property name enclosed in double quotes"
matched_images_data_fix = json.dumps(matched_images_data)
matched_images_data_json = json.loads(matched_images_data_fix)

matched_google_full_resolution_images = re.findall(r"(?:'|,),\[\"(https:|http.*?)\",\d+,\d+\]",
                                                    matched_images_data_json) 
```

```
# Extract and decode them using bytes() and decode():
for fixed_full_res_image in matched_google_full_resolution_images:
    original_size_img_not_fixed = bytes(fixed_full_res_image, 'ascii').decode('unicode-escape')
    original_size_img = bytes(original_size_img_not_fixed, 'ascii').decode('unicode-escape') 
```

* * *

下载 Google 图片[的在线 IDE 中的](https://replit.com/@DimitryZub1/Scrape-and-Download-Google-Images-with-Python#bs4_original_images.py)代码和完整示例：

```
import requests, lxml, re, json, shutil, urllib.request
from bs4 import BeautifulSoup
from py_random_words import RandomWords

random_word = RandomWords().get_word()

headers = {
    "User-Agent":
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19582"
}

params = {
    "q": random_word,
    "tbm": "isch", 
    "hl": "en",
    "ijn": "0",
}

html = requests.get("https://www.google.com/search", params=params, headers=headers)
soup = BeautifulSoup(html.text, 'lxml')

def get_images_data():

    print('\nGoogle Images Metadata:')
    for google_image in soup.select('.isv-r.PNCib.MSM1fd.BUooTd'):
        title = google_image.select_one('.VFACy.kGQAp.sMi44c.lNHeqe.WGvvNb')['title']
        source = google_image.select_one('.fxgdke').text
        link = google_image.select_one('.VFACy.kGQAp.sMi44c.lNHeqe.WGvvNb')['href']
        print(f'{title}\n{source}\n{link}\n')

    # this steps could be refactored to a more compact
    all_script_tags = soup.select('script')

    # # https://regex101.com/r/48UZhY/4
    matched_images_data = ''.join(re.findall(r"AF_initDataCallback\(([^<]+)\);", str(all_script_tags)))

    # https://kodlogs.com/34776/json-decoder-jsondecodeerror-expecting-property-name-enclosed-in-double-quotes
    # if you try to json.loads() without json.dumps() it will throw an error:
    # "Expecting property name enclosed in double quotes"
    matched_images_data_fix = json.dumps(matched_images_data)
    matched_images_data_json = json.loads(matched_images_data_fix)

    # https://regex101.com/r/pdZOnW/3
    matched_google_image_data = re.findall(r'\[\"GRID_STATE0\",null,\[\[1,\[0,\".*?\",(.*),\"All\",', matched_images_data_json)

    # https://regex101.com/r/NnRg27/1
    matched_google_images_thumbnails = ', '.join(
        re.findall(r'\[\"(https\:\/\/encrypted-tbn0\.gstatic\.com\/images\?.*?)\",\d+,\d+\]',
                   str(matched_google_image_data))).split(', ')

    print('Google Image Thumbnails:')  # in order
    for fixed_google_image_thumbnail in matched_google_images_thumbnails:
        # https://stackoverflow.com/a/4004439/15164646 comment by Frédéric Hamidi
        google_image_thumbnail_not_fixed = bytes(fixed_google_image_thumbnail, 'ascii').decode('unicode-escape')

        # after first decoding, Unicode characters are still present. After the second iteration, they were decoded.
        google_image_thumbnail = bytes(google_image_thumbnail_not_fixed, 'ascii').decode('unicode-escape')
        print(google_image_thumbnail)

    # removing previously matched thumbnails for easier full resolution image matches.
    removed_matched_google_images_thumbnails = re.sub(
        r'\[\"(https\:\/\/encrypted-tbn0\.gstatic\.com\/images\?.*?)\",\d+,\d+\]', '', str(matched_google_image_data))

    # https://regex101.com/r/fXjfb1/4
    # https://stackoverflow.com/a/19821774/15164646
    matched_google_full_resolution_images = re.findall(r"(?:'|,),\[\"(https:|http.*?)\",\d+,\d+\]",
                                                       removed_matched_google_images_thumbnails)

    print('\nFull Resolution Images:')  # in order
    for index, fixed_full_res_image in enumerate(matched_google_full_resolution_images):
        # https://stackoverflow.com/a/4004439/15164646 comment by Frédéric Hamidi
        original_size_img_not_fixed = bytes(fixed_full_res_image, 'ascii').decode('unicode-escape')
        original_size_img = bytes(original_size_img_not_fixed, 'ascii').decode('unicode-escape')
        print(original_size_img)

        # ------------------------------------------------
        # Download original images

        print(f'Downloading {index} image...')

        opener=urllib.request.build_opener()
        opener.addheaders=[('User-Agent','Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19582')]
        urllib.request.install_opener(opener)

        urllib.request.urlretrieve(original_size_img, f'Bs4_Images/original_size_img_{index}.jpg')

get_images_data() 
```

* * *

或者，您可以使用来自 SerpApi的[Google 图片 API](https://serpapi.com/images-results)来实现相同的目的。这是一个带有免费计划的付费 API。

您的情况的不同之处在于，您不必处理`regex`从页面源匹配和提取所需数据，相反，您只需要迭代结构化 JSON 并快速获得您想要的，并且不需要随着时间的推移保持它。

要集成以实现您的目标的代码：

```
import os, urllib.request, json # json for pretty output
from serpapi import GoogleSearch
from py_random_words import RandomWords

random_word = RandomWords().get_word()

def get_google_images():
    params = {
      "api_key": os.getenv("API_KEY"),
      "engine": "google",
      "q": random_word,
      "tbm": "isch"
    }

    search = GoogleSearch(params)
    results = search.get_dict()

    print(json.dumps(results['images_results'], indent=2, ensure_ascii=False))

    # -----------------------
    # Downloading images

    for index, image in enumerate(results['images_results']):

        print(f'Downloading {index} image...')

        opener=urllib.request.build_opener()
        opener.addheaders=[('User-Agent','Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19582')]
        urllib.request.install_opener(opener)

        urllib.request.urlretrieve(image['original'], f'SerpApi_Images/original_size_img_{index}.jpg')

get_google_images() 
```

PS - 我写了一篇更深入的博客文章，关于如何抓取[谷歌图片](https://dev.to/dimitryzub/scrape-google-images-with-python-1ee2)，以及[如何减少在网络抓取搜索引擎时被阻止的机会](https://dev.to/dimitryzub/how-to-reduce-chance-being-blocked-while-web-scraping-search-engines-1o46)。

> 免责声明，我为 SerpApi 工作。**

# .net - IOrchardShellEvents 实现 ConfigurationManager

> ID：16007996
> 
> 赞同：0
> 
> 时间：2013-04-15T05:05:22.373
> 
> 标签：.net, orchardcms, orchardcms-1.6

当我尝试在 IOrchardShellEvents 实现中访问 AppSettings 和 ConnectionStrings 时，它不起作用。

它似乎是从根 web.config （不是我的自定义模块）访问值。

我怎样才能让它工作？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T07:37:46.953

模块中的 web.config 不能用于此目的。而是创建您自己的站点设置。[http://docs.orchardproject.net/Documentation/Adding-custom-settings](http://docs.orchardproject.net/Documentation/Adding-custom-settings)